<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Generative Reward Models</title>
<!--Generated on Wed Oct  2 18:01:27 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.12832v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S1" title="In Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2" title="In Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminaries</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS1" title="In 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Reinforcement Learning from Human Feedback</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS1.SSS1" title="In 2.1 Reinforcement Learning from Human Feedback ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.1 </span>Supervised Fine-Tuning (SFT)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS1.SSS2" title="In 2.1 Reinforcement Learning from Human Feedback ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.2 </span>Bradley-Terry Reward Modeling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS1.SSS3" title="In 2.1 Reinforcement Learning from Human Feedback ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.3 </span>Reinforcement Learning (RL)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS2" title="In 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Self-Taught Reasoner</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS2.SSS1" title="In 2.2 Self-Taught Reasoner ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>Rationale Generation Bootstrapping</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS2.SSS2" title="In 2.2 Self-Taught Reasoner ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.2 </span>Post-Rationalization</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS3" title="In 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>RLAIF and LLM-As-A-Judge</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S3" title="In Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Connections Between RLHF and Preference Modelling</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S4" title="In Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Generative Reward Models: A Unified RLHF-RLAIF Approach</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5" title="In Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.SS1" title="In 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Performance of Generative RMs on General Assistant Tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.SS2" title="In 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Performance on Reasoning Tasks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.SS3" title="In 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Bootstrapping Rationales</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.SS4" title="In 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Using Inference-Time Compute</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S6" title="In Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S7" title="In Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Conclusion and Future Directions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1" title="In Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Additional Experiment Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1.SS1" title="In Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Prompts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1.SS2" title="In Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Hyperparameters</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1.SS2.SSS1" title="In A.2 Hyperparameters ‣ Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.1 </span>Training Hyperparameters</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1.SS2.SSS2" title="In A.2 Hyperparameters ‣ Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.2 </span>Generation Hyperparmeters</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1.SS3" title="In Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>STaR Iterations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A2" title="In Generative Reward Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Results Across Iterations</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Generative Reward Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dakota Mahan<math alttext="{}^{*1}\," class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><msup id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi id="id1.1.m1.1.1a" xref="id1.1.m1.1.1.cmml"></mi><mrow id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml"><mi id="id1.1.m1.1.1.1.2" xref="id1.1.m1.1.1.1.2.cmml"></mi><mo id="id1.1.m1.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="id1.1.m1.1.1.1.1.cmml">∗</mo><mn id="id1.1.m1.1.1.1.3" xref="id1.1.m1.1.1.1.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><apply id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"><apply id="id1.1.m1.1.1.1.cmml" xref="id1.1.m1.1.1.1"><times id="id1.1.m1.1.1.1.1.cmml" xref="id1.1.m1.1.1.1.1"></times><csymbol cd="latexml" id="id1.1.m1.1.1.1.2.cmml" xref="id1.1.m1.1.1.1.2">absent</csymbol><cn id="id1.1.m1.1.1.1.3.cmml" type="integer" xref="id1.1.m1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">{}^{*1}\,</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">start_FLOATSUPERSCRIPT ∗ 1 end_FLOATSUPERSCRIPT</annotation></semantics></math> Duy Van Phung<math alttext="{}^{*1}\," class="ltx_Math" display="inline" id="id2.2.m2.1"><semantics id="id2.2.m2.1a"><msup id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml"><mi id="id2.2.m2.1.1a" xref="id2.2.m2.1.1.cmml"></mi><mrow id="id2.2.m2.1.1.1" xref="id2.2.m2.1.1.1.cmml"><mi id="id2.2.m2.1.1.1.2" xref="id2.2.m2.1.1.1.2.cmml"></mi><mo id="id2.2.m2.1.1.1.1" lspace="0.222em" rspace="0.222em" xref="id2.2.m2.1.1.1.1.cmml">∗</mo><mn id="id2.2.m2.1.1.1.3" xref="id2.2.m2.1.1.1.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id2.2.m2.1b"><apply id="id2.2.m2.1.1.cmml" xref="id2.2.m2.1.1"><apply id="id2.2.m2.1.1.1.cmml" xref="id2.2.m2.1.1.1"><times id="id2.2.m2.1.1.1.1.cmml" xref="id2.2.m2.1.1.1.1"></times><csymbol cd="latexml" id="id2.2.m2.1.1.1.2.cmml" xref="id2.2.m2.1.1.1.2">absent</csymbol><cn id="id2.2.m2.1.1.1.3.cmml" type="integer" xref="id2.2.m2.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="id2.2.m2.1c">{}^{*1}\,</annotation><annotation encoding="application/x-llamapun" id="id2.2.m2.1d">start_FLOATSUPERSCRIPT ∗ 1 end_FLOATSUPERSCRIPT</annotation></semantics></math> Rafael Rafailov<math alttext="{}^{*1,2}\," class="ltx_Math" display="inline" id="id3.3.m3.2"><semantics id="id3.3.m3.2a"><msup id="id3.3.m3.2.2" xref="id3.3.m3.2.2.cmml"><mi id="id3.3.m3.2.2a" xref="id3.3.m3.2.2.cmml"></mi><mrow id="id3.3.m3.2.2.2.2" xref="id3.3.m3.2.2.2.3.cmml"><mrow id="id3.3.m3.2.2.2.2.1" xref="id3.3.m3.2.2.2.2.1.cmml"><mi id="id3.3.m3.2.2.2.2.1.2" xref="id3.3.m3.2.2.2.2.1.2.cmml"></mi><mo id="id3.3.m3.2.2.2.2.1.1" lspace="0.222em" rspace="0.222em" xref="id3.3.m3.2.2.2.2.1.1.cmml">∗</mo><mn id="id3.3.m3.2.2.2.2.1.3" xref="id3.3.m3.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="id3.3.m3.2.2.2.2.2" xref="id3.3.m3.2.2.2.3.cmml">,</mo><mn id="id3.3.m3.1.1.1.1" xref="id3.3.m3.1.1.1.1.cmml">2</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="id3.3.m3.2b"><apply id="id3.3.m3.2.2.cmml" xref="id3.3.m3.2.2"><list id="id3.3.m3.2.2.2.3.cmml" xref="id3.3.m3.2.2.2.2"><apply id="id3.3.m3.2.2.2.2.1.cmml" xref="id3.3.m3.2.2.2.2.1"><times id="id3.3.m3.2.2.2.2.1.1.cmml" xref="id3.3.m3.2.2.2.2.1.1"></times><csymbol cd="latexml" id="id3.3.m3.2.2.2.2.1.2.cmml" xref="id3.3.m3.2.2.2.2.1.2">absent</csymbol><cn id="id3.3.m3.2.2.2.2.1.3.cmml" type="integer" xref="id3.3.m3.2.2.2.2.1.3">1</cn></apply><cn id="id3.3.m3.1.1.1.1.cmml" type="integer" xref="id3.3.m3.1.1.1.1">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="id3.3.m3.2c">{}^{*1,2}\,</annotation><annotation encoding="application/x-llamapun" id="id3.3.m3.2d">start_FLOATSUPERSCRIPT ∗ 1 , 2 end_FLOATSUPERSCRIPT</annotation></semantics></math>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id6.6.3">Chase Blagden<sup class="ltx_sup" id="id6.6.3.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id6.6.3.1.1">1</span></sup>
Nathan Lile<math alttext="{}^{1}\," class="ltx_Math" display="inline" id="id5.5.2.m2.1"><semantics id="id5.5.2.m2.1a"><msup id="id5.5.2.m2.1.1" xref="id5.5.2.m2.1.1.cmml"><mi id="id5.5.2.m2.1.1a" xref="id5.5.2.m2.1.1.cmml"></mi><mn id="id5.5.2.m2.1.1.1" xref="id5.5.2.m2.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id5.5.2.m2.1b"><apply id="id5.5.2.m2.1.1.cmml" xref="id5.5.2.m2.1.1"><cn id="id5.5.2.m2.1.1.1.cmml" type="integer" xref="id5.5.2.m2.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id5.5.2.m2.1c">{}^{1}\,</annotation><annotation encoding="application/x-llamapun" id="id5.5.2.m2.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math> Louis Castricato<math alttext="{}^{1}\," class="ltx_Math" display="inline" id="id6.6.3.m3.1"><semantics id="id6.6.3.m3.1a"><msup id="id6.6.3.m3.1.1" xref="id6.6.3.m3.1.1.cmml"><mi id="id6.6.3.m3.1.1a" xref="id6.6.3.m3.1.1.cmml"></mi><mn id="id6.6.3.m3.1.1.1" xref="id6.6.3.m3.1.1.1.cmml">1</mn></msup><annotation-xml encoding="MathML-Content" id="id6.6.3.m3.1b"><apply id="id6.6.3.m3.1.1.cmml" xref="id6.6.3.m3.1.1"><cn id="id6.6.3.m3.1.1.1.cmml" type="integer" xref="id6.6.3.m3.1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id6.6.3.m3.1c">{}^{1}\,</annotation><annotation encoding="application/x-llamapun" id="id6.6.3.m3.1d">start_FLOATSUPERSCRIPT 1 end_FLOATSUPERSCRIPT</annotation></semantics></math></span>
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id9.9.6">Jan-Philipp Fränken<math alttext="{}^{2}\," class="ltx_Math" display="inline" id="id7.7.4.m1.1"><semantics id="id7.7.4.m1.1a"><msup id="id7.7.4.m1.1.1" xref="id7.7.4.m1.1.1.cmml"><mi id="id7.7.4.m1.1.1a" xref="id7.7.4.m1.1.1.cmml"></mi><mn id="id7.7.4.m1.1.1.1" xref="id7.7.4.m1.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id7.7.4.m1.1b"><apply id="id7.7.4.m1.1.1.cmml" xref="id7.7.4.m1.1.1"><cn id="id7.7.4.m1.1.1.1.cmml" type="integer" xref="id7.7.4.m1.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id7.7.4.m1.1c">{}^{2}\,</annotation><annotation encoding="application/x-llamapun" id="id7.7.4.m1.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math> Chelsea Finn<math alttext="{}^{2}\," class="ltx_Math" display="inline" id="id8.8.5.m2.1"><semantics id="id8.8.5.m2.1a"><msup id="id8.8.5.m2.1.1" xref="id8.8.5.m2.1.1.cmml"><mi id="id8.8.5.m2.1.1a" xref="id8.8.5.m2.1.1.cmml"></mi><mn id="id8.8.5.m2.1.1.1" xref="id8.8.5.m2.1.1.1.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="id8.8.5.m2.1b"><apply id="id8.8.5.m2.1.1.cmml" xref="id8.8.5.m2.1.1"><cn id="id8.8.5.m2.1.1.1.cmml" type="integer" xref="id8.8.5.m2.1.1.1">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="id8.8.5.m2.1c">{}^{2}\,</annotation><annotation encoding="application/x-llamapun" id="id8.8.5.m2.1d">start_FLOATSUPERSCRIPT 2 end_FLOATSUPERSCRIPT</annotation></semantics></math> Alon Albalak<sup class="ltx_sup" id="id9.9.6.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id9.9.6.1.1">∗1</span></sup></span>
<br class="ltx_break"/>
<br class="ltx_break"/><sup class="ltx_sup" id="id12.12.id1">1</sup>SynthLabs, <sup class="ltx_sup" id="id13.13.id2">2</sup>Stanford University
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id14.id1">Reinforcement Learning from Human Feedback (RLHF) has greatly improved the performance of modern Large Language Models (LLMs). The RLHF process is resource-intensive and technically challenging, generally requiring a large collection of human preference labels over model-generated outputs. Reinforcement Learning from AI Feedback (RLAIF) addresses this data collection challenge by leveraging synthetic preferences generated by an LLM. However, recent work has shown that synthetic preferences labels may not align well with human preference judgments <cite class="ltx_cite ltx_citemacro_citep">(Zeng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib51" title="">2023</a>)</cite>.
To address this, we propose a hybrid approach that unifies RLHF and RLAIF methodologies. We introduce <span class="ltx_text ltx_font_bold" id="id14.id1.1">GenRM</span>, an iterative algorithm that trains an LLM on self-generated reasoning traces, leading to synthetic preference labels matching human preference judgments. Empirically, we show that zero-shot LLM-based judgments under-perform compared to Bradley-Terry reward models on in-distribution tasks (between 9-36%). In contrast, GenRM achieves in-distribution accuracy comparable to Bradley-Terry models, while significantly outperforming them on out-of-distribution tasks (between 10-45%). Moreover, GenRM surpasses the performance of using LLMs as judges on both in-distribution (by 9-31%) and out-of-distribution tasks (by 2-6%).
Our results show that combining the strengths of RLHF and RLAIF offers a promising approach for improving the quality of synthetic preference labels.</p>
</div>
<span class="ltx_note ltx_role_footnotetext" id="footnotex1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">footnotetext: </span>
<span class="ltx_p ltx_parbox ltx_align_middle" id="footnotex1.1" style="width:397.5pt;">* Equal contribution. Correspondence to <a class="ltx_ref ltx_href" href="mailto:team@synthlabs.ai" title="">team@synthlabs.ai</a></span></span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Reinforcement Learning from Human Feedback (RLHF) has significantly improved the performance of modern Large Language Models (LLMs) <cite class="ltx_cite ltx_citemacro_citep">(see e.g., Reid et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib33" title="">2024</a>; OpenAI, <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib28" title="">2023</a>)</cite>. Despite its effectiveness, the RLHF process presents several challenges. First, it requires a large amount of human preference data to train reward models that reflect human preferences <cite class="ltx_cite ltx_citemacro_citep">(Stiennon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib36" title="">2022</a>; Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib8" title="">2022a</a>)</cite>. Second, it necessitates additional architecture and infrastructure to handle reward model training <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib38" title="">2024a</a>; von Werra et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib37" title="">2020</a>; Havrilla et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib20" title="">2023</a>)</cite>. Third, it requires a sophisticated online optimization loop using algorithms, such as Proximal Policy Optimization [PPO; <cite class="ltx_cite ltx_citemacro_citet">Schulman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib34" title="">2017</a>)</cite>], to fine-tune an LLM-based policy to align with the reward model <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib56" title="">2023c</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To address the challenge of collecting large-scale human preference data, synthetic preference data has emerged as a promising alternative. For example, <cite class="ltx_cite ltx_citemacro_citet">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib9" title="">2022b</a>)</cite> introduced Reinforcement Learning from AI Feedback (RLAIF). Instead of relying on human users for feedback, their method utilizes an LLM guided by a predefined set of principles—referred to as a “constitution”—to generate and select model outputs that are helpful and harmless <cite class="ltx_cite ltx_citemacro_citep">(Askell et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib6" title="">2021</a>)</cite>. Employing AI-generated preference labels has demonstrated meaningful Pareto improvements in balancing helpfulness and harmlessness in assistant responses <cite class="ltx_cite ltx_citemacro_citep">(Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib9" title="">2022b</a>; Kundu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib24" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Direct alignment algorithms, such as Direct Preference Optimization (DPO) <cite class="ltx_cite ltx_citemacro_citep">(Rafailov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib31" title="">2023</a>)</cite> and Implicit Preference Optimization (IPO) <cite class="ltx_cite ltx_citemacro_citep">(Azar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib7" title="">2023</a>)</cite>, were developed to address the challenges of reward model training and online optimization. These works demonstrated that the reward model and the optimal policy can be mathematically interchanged, allowing the policy to be trained directly from preference data in an entirely offline manner, significantly simplifying the RLHF pipeline. Benchmark evaluations <cite class="ltx_cite ltx_citemacro_citep">(Lambert et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib25" title="">2024</a>)</cite> have shown that DPO-based approaches are competitive with traditional reward models based on the Bradley-Terry algorithm. However, recent empirical evidence suggests that purely offline methods may underperform compared to online approaches in both reward model-based reinforcement learning <cite class="ltx_cite ltx_citemacro_citep">(Xu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib46" title="">2024b</a>; <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib45" title="">a</a>)</cite> and in the RLAIF setting <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib19" title="">2024</a>)</cite>. As a result, state-of-the-art models such as the LLaMA-3 family <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib16" title="">2024</a>)</cite> have adopted hybrid strategies that combine online DPO optimization with separate reward models.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this work, we identify two key <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">limitations</span> in current alignment approaches: (1) Explicitly parameterized reward models, while effective and accurate for in-distribution tasks, struggle with robustness and generalization to out-of-distribution (OOD) data. (2) RLAIF approaches, such as utilizing an LLM-as-a-judge, offer a more robust alternative but may not always align well with actual user preferences when acting as the sole evaluator. To <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">address these limitations</span>, we propose a unified framework for RLHF and RLAIF. Our approach begins with a strong pre-trained LLM, which we employ as an evaluator. Using a dataset of user preferences, we adopt a STaR-like methodology <cite class="ltx_cite ltx_citemacro_citep">(Zelikman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib49" title="">2022</a>)</cite> to align the LLM with user choices, effectively training it to function as a reward model. We <span class="ltx_text ltx_font_bold" id="S1.p4.1.3">demonstrate empirically</span> that this fine-tuned judge model matches Bradley-Terry reward models for in-distribution prompts while significantly improving generalization on OOD prompts. Additionally, it outperforms the base LLM on both in-distribution and OOD scenarios.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="407" id="S1.F1.g1" src="x1.png" width="813"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text ltx_font_bold" id="S1.F1.13.1">Methods overview.</span> <span class="ltx_text ltx_font_italic" id="S1.F1.14.2">Bradley-Terry</span> methods directly output the probability of <math alttext="y_{1}" class="ltx_Math" display="inline" id="S1.F1.5.m1.1"><semantics id="S1.F1.5.m1.1b"><msub id="S1.F1.5.m1.1.1" xref="S1.F1.5.m1.1.1.cmml"><mi id="S1.F1.5.m1.1.1.2" xref="S1.F1.5.m1.1.1.2.cmml">y</mi><mn id="S1.F1.5.m1.1.1.3" xref="S1.F1.5.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.5.m1.1c"><apply id="S1.F1.5.m1.1.1.cmml" xref="S1.F1.5.m1.1.1"><csymbol cd="ambiguous" id="S1.F1.5.m1.1.1.1.cmml" xref="S1.F1.5.m1.1.1">subscript</csymbol><ci id="S1.F1.5.m1.1.1.2.cmml" xref="S1.F1.5.m1.1.1.2">𝑦</ci><cn id="S1.F1.5.m1.1.1.3.cmml" type="integer" xref="S1.F1.5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.5.m1.1d">y_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.5.m1.1e">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> being preferred over <math alttext="y_{2}" class="ltx_Math" display="inline" id="S1.F1.6.m2.1"><semantics id="S1.F1.6.m2.1b"><msub id="S1.F1.6.m2.1.1" xref="S1.F1.6.m2.1.1.cmml"><mi id="S1.F1.6.m2.1.1.2" xref="S1.F1.6.m2.1.1.2.cmml">y</mi><mn id="S1.F1.6.m2.1.1.3" xref="S1.F1.6.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.F1.6.m2.1c"><apply id="S1.F1.6.m2.1.1.cmml" xref="S1.F1.6.m2.1.1"><csymbol cd="ambiguous" id="S1.F1.6.m2.1.1.1.cmml" xref="S1.F1.6.m2.1.1">subscript</csymbol><ci id="S1.F1.6.m2.1.1.2.cmml" xref="S1.F1.6.m2.1.1.2">𝑦</ci><cn id="S1.F1.6.m2.1.1.3.cmml" type="integer" xref="S1.F1.6.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.6.m2.1d">y_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.6.m2.1e">italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, while <span class="ltx_text ltx_font_italic" id="S1.F1.15.3">GenRM</span> compares the LLMs next-token probabilities of answer indicator tokens (<math alttext="I_{1},I_{2}" class="ltx_Math" display="inline" id="S1.F1.7.m3.2"><semantics id="S1.F1.7.m3.2b"><mrow id="S1.F1.7.m3.2.2.2" xref="S1.F1.7.m3.2.2.3.cmml"><msub id="S1.F1.7.m3.1.1.1.1" xref="S1.F1.7.m3.1.1.1.1.cmml"><mi id="S1.F1.7.m3.1.1.1.1.2" xref="S1.F1.7.m3.1.1.1.1.2.cmml">I</mi><mn id="S1.F1.7.m3.1.1.1.1.3" xref="S1.F1.7.m3.1.1.1.1.3.cmml">1</mn></msub><mo id="S1.F1.7.m3.2.2.2.3" xref="S1.F1.7.m3.2.2.3.cmml">,</mo><msub id="S1.F1.7.m3.2.2.2.2" xref="S1.F1.7.m3.2.2.2.2.cmml"><mi id="S1.F1.7.m3.2.2.2.2.2" xref="S1.F1.7.m3.2.2.2.2.2.cmml">I</mi><mn id="S1.F1.7.m3.2.2.2.2.3" xref="S1.F1.7.m3.2.2.2.2.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S1.F1.7.m3.2c"><list id="S1.F1.7.m3.2.2.3.cmml" xref="S1.F1.7.m3.2.2.2"><apply id="S1.F1.7.m3.1.1.1.1.cmml" xref="S1.F1.7.m3.1.1.1.1"><csymbol cd="ambiguous" id="S1.F1.7.m3.1.1.1.1.1.cmml" xref="S1.F1.7.m3.1.1.1.1">subscript</csymbol><ci id="S1.F1.7.m3.1.1.1.1.2.cmml" xref="S1.F1.7.m3.1.1.1.1.2">𝐼</ci><cn id="S1.F1.7.m3.1.1.1.1.3.cmml" type="integer" xref="S1.F1.7.m3.1.1.1.1.3">1</cn></apply><apply id="S1.F1.7.m3.2.2.2.2.cmml" xref="S1.F1.7.m3.2.2.2.2"><csymbol cd="ambiguous" id="S1.F1.7.m3.2.2.2.2.1.cmml" xref="S1.F1.7.m3.2.2.2.2">subscript</csymbol><ci id="S1.F1.7.m3.2.2.2.2.2.cmml" xref="S1.F1.7.m3.2.2.2.2.2">𝐼</ci><cn id="S1.F1.7.m3.2.2.2.2.3.cmml" type="integer" xref="S1.F1.7.m3.2.2.2.2.3">2</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.7.m3.2d">I_{1},I_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.7.m3.2e">italic_I start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_I start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>). <span class="ltx_text ltx_font_italic" id="S1.F1.16.4">CoT-GenRM</span> samples reasoning traces (<math alttext="r" class="ltx_Math" display="inline" id="S1.F1.8.m4.1"><semantics id="S1.F1.8.m4.1b"><mi id="S1.F1.8.m4.1.1" xref="S1.F1.8.m4.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S1.F1.8.m4.1c"><ci id="S1.F1.8.m4.1.1.cmml" xref="S1.F1.8.m4.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.8.m4.1d">r</annotation><annotation encoding="application/x-llamapun" id="S1.F1.8.m4.1e">italic_r</annotation></semantics></math>) followed by the answer indicator token.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminaries</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we first outline the core components of the standard RLHF post-training pipeline <cite class="ltx_cite ltx_citemacro_citep">(Ziegler et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib58" title="">2020</a>; Stiennon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib36" title="">2022</a>; Bai et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib8" title="">2022a</a>; Ouyang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib29" title="">2022</a>)</cite>, then summarize the Self-Taught Reasoner (STaR) approach <cite class="ltx_cite ltx_citemacro_citep">(Zelikman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib49" title="">2022</a>)</cite>, and finally review LLM-as-a-judge <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib53" title="">2023a</a>)</cite>.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Reinforcement Learning from Human Feedback</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">The RLHF pipeline consists of three stages designed to align an LLM with human preferences: (1) Supervised finetuning (SFT); (2) Reward Modeling; and (3) Reinforcement Learning (RL).</p>
</div>
<section class="ltx_subsubsection" id="S2.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.1 </span>Supervised Fine-Tuning (SFT)</h4>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS1.p1">
<p class="ltx_p" id="S2.SS1.SSS1.p1.3">In the first stage, an LLM is trained to follow instructions using a dataset of prompts <math alttext="x" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.1.m1.1"><semantics id="S2.SS1.SSS1.p1.1.m1.1a"><mi id="S2.SS1.SSS1.p1.1.m1.1.1" xref="S2.SS1.SSS1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.1.m1.1b"><ci id="S2.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.1.m1.1d">italic_x</annotation></semantics></math> and responses <math alttext="y" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.2.m2.1"><semantics id="S2.SS1.SSS1.p1.2.m2.1a"><mi id="S2.SS1.SSS1.p1.2.m2.1.1" xref="S2.SS1.SSS1.p1.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.2.m2.1b"><ci id="S2.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.2.m2.1d">italic_y</annotation></semantics></math> using maximum likelihood estimation (MLE) over the next-token predictions. The resulting model is referred to as <math alttext="\pi_{\text{SFT}}(y\mid x)" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.3.m3.1"><semantics id="S2.SS1.SSS1.p1.3.m3.1a"><mrow id="S2.SS1.SSS1.p1.3.m3.1.1" xref="S2.SS1.SSS1.p1.3.m3.1.1.cmml"><msub id="S2.SS1.SSS1.p1.3.m3.1.1.3" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.cmml"><mi id="S2.SS1.SSS1.p1.3.m3.1.1.3.2" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.2.cmml">π</mi><mtext id="S2.SS1.SSS1.p1.3.m3.1.1.3.3" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.3a.cmml">SFT</mtext></msub><mo id="S2.SS1.SSS1.p1.3.m3.1.1.2" xref="S2.SS1.SSS1.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.SSS1.p1.3.m3.1.1.1.1" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.cmml"><mo id="S2.SS1.SSS1.p1.3.m3.1.1.1.1.2" stretchy="false" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.2" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.2.cmml">y</mi><mo id="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.1" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.3" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.SSS1.p1.3.m3.1.1.1.1.3" stretchy="false" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.3.m3.1b"><apply id="S2.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1"><times id="S2.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.2"></times><apply id="S2.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.2">𝜋</ci><ci id="S2.SS1.SSS1.p1.3.m3.1.1.3.3a.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.3"><mtext id="S2.SS1.SSS1.p1.3.m3.1.1.3.3.cmml" mathsize="70%" xref="S2.SS1.SSS1.p1.3.m3.1.1.3.3">SFT</mtext></ci></apply><apply id="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS1.p1.3.m3.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.3.m3.1c">\pi_{\text{SFT}}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.3.m3.1d">italic_π start_POSTSUBSCRIPT SFT end_POSTSUBSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math>, where both the prompt and response strings are treated as single variables. This model is used as a base for the next stages.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.2 </span>Bradley-Terry Reward Modeling</h4>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS2.p1">
<p class="ltx_p" id="S2.SS1.SSS2.p1.6">Next, the SFT model <math alttext="\pi_{\text{SFT}}(y\mid x)" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.1.m1.1"><semantics id="S2.SS1.SSS2.p1.1.m1.1a"><mrow id="S2.SS1.SSS2.p1.1.m1.1.1" xref="S2.SS1.SSS2.p1.1.m1.1.1.cmml"><msub id="S2.SS1.SSS2.p1.1.m1.1.1.3" xref="S2.SS1.SSS2.p1.1.m1.1.1.3.cmml"><mi id="S2.SS1.SSS2.p1.1.m1.1.1.3.2" xref="S2.SS1.SSS2.p1.1.m1.1.1.3.2.cmml">π</mi><mtext id="S2.SS1.SSS2.p1.1.m1.1.1.3.3" xref="S2.SS1.SSS2.p1.1.m1.1.1.3.3a.cmml">SFT</mtext></msub><mo id="S2.SS1.SSS2.p1.1.m1.1.1.2" xref="S2.SS1.SSS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.SSS2.p1.1.m1.1.1.1.1" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.2" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.2.cmml">y</mi><mo id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.1" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.3" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.1.m1.1b"><apply id="S2.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1"><times id="S2.SS1.SSS2.p1.1.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.2"></times><apply id="S2.SS1.SSS2.p1.1.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.3.2">𝜋</ci><ci id="S2.SS1.SSS2.p1.1.m1.1.1.3.3a.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.3.3"><mtext id="S2.SS1.SSS2.p1.1.m1.1.1.3.3.cmml" mathsize="70%" xref="S2.SS1.SSS2.p1.1.m1.1.1.3.3">SFT</mtext></ci></apply><apply id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.1.m1.1c">\pi_{\text{SFT}}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT SFT end_POSTSUBSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math> is leveraged to construct a reward model that captures human preferences. Specifically, the SFT model is sampled, generating pairs of responses <math alttext="(y_{1},y_{2})\sim\pi_{\text{SFT}}(y\mid x)" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.2.m2.3"><semantics id="S2.SS1.SSS2.p1.2.m2.3a"><mrow id="S2.SS1.SSS2.p1.2.m2.3.3" xref="S2.SS1.SSS2.p1.2.m2.3.3.cmml"><mrow id="S2.SS1.SSS2.p1.2.m2.2.2.2.2" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.3.cmml"><mo id="S2.SS1.SSS2.p1.2.m2.2.2.2.2.3" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.3.cmml">(</mo><msub id="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1" xref="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.2" xref="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.cmml">y</mi><mn id="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.3" xref="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.SSS2.p1.2.m2.2.2.2.2.4" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.cmml"><mi id="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.2" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.cmml">y</mi><mn id="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.3" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S2.SS1.SSS2.p1.2.m2.2.2.2.2.5" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.3.cmml">)</mo></mrow><mo id="S2.SS1.SSS2.p1.2.m2.3.3.4" xref="S2.SS1.SSS2.p1.2.m2.3.3.4.cmml">∼</mo><mrow id="S2.SS1.SSS2.p1.2.m2.3.3.3" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.cmml"><msub id="S2.SS1.SSS2.p1.2.m2.3.3.3.3" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p1.2.m2.3.3.3.3.2" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.3.2.cmml">π</mi><mtext id="S2.SS1.SSS2.p1.2.m2.3.3.3.3.3" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.3.3a.cmml">SFT</mtext></msub><mo id="S2.SS1.SSS2.p1.2.m2.3.3.3.2" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.2.cmml">⁢</mo><mrow id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.cmml"><mo id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.2" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.2" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.2.cmml">y</mi><mo id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.1" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.1.cmml">∣</mo><mi id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.3" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.3" stretchy="false" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.2.m2.3b"><apply id="S2.SS1.SSS2.p1.2.m2.3.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3"><csymbol cd="latexml" id="S2.SS1.SSS2.p1.2.m2.3.3.4.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.4">similar-to</csymbol><interval closure="open" id="S2.SS1.SSS2.p1.2.m2.2.2.2.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.2"><apply id="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.2">𝑦</ci><cn id="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.SSS2.p1.2.m2.1.1.1.1.1.3">1</cn></apply><apply id="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.2">𝑦</ci><cn id="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.3.cmml" type="integer" xref="S2.SS1.SSS2.p1.2.m2.2.2.2.2.2.3">2</cn></apply></interval><apply id="S2.SS1.SSS2.p1.2.m2.3.3.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.3"><times id="S2.SS1.SSS2.p1.2.m2.3.3.3.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.2"></times><apply id="S2.SS1.SSS2.p1.2.m2.3.3.3.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.2.m2.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p1.2.m2.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.3.2">𝜋</ci><ci id="S2.SS1.SSS2.p1.2.m2.3.3.3.3.3a.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.3.3"><mtext id="S2.SS1.SSS2.p1.2.m2.3.3.3.3.3.cmml" mathsize="70%" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.3.3">SFT</mtext></ci></apply><apply id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1"><csymbol cd="latexml" id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.1">conditional</csymbol><ci id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.2">𝑦</ci><ci id="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.2.m2.3.3.3.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.2.m2.3c">(y_{1},y_{2})\sim\pi_{\text{SFT}}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.2.m2.3d">( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∼ italic_π start_POSTSUBSCRIPT SFT end_POSTSUBSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math> for each prompt <math alttext="x" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.3.m3.1"><semantics id="S2.SS1.SSS2.p1.3.m3.1a"><mi id="S2.SS1.SSS2.p1.3.m3.1.1" xref="S2.SS1.SSS2.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.3.m3.1b"><ci id="S2.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS1.SSS2.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.3.m3.1d">italic_x</annotation></semantics></math> in the dataset. Human annotators then rank the responses, producing pairs of preferences <math alttext="y_{w}\succ y_{l}\mid x" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.4.m4.1"><semantics id="S2.SS1.SSS2.p1.4.m4.1a"><mrow id="S2.SS1.SSS2.p1.4.m4.1.1" xref="S2.SS1.SSS2.p1.4.m4.1.1.cmml"><msub id="S2.SS1.SSS2.p1.4.m4.1.1.2" xref="S2.SS1.SSS2.p1.4.m4.1.1.2.cmml"><mi id="S2.SS1.SSS2.p1.4.m4.1.1.2.2" xref="S2.SS1.SSS2.p1.4.m4.1.1.2.2.cmml">y</mi><mi id="S2.SS1.SSS2.p1.4.m4.1.1.2.3" xref="S2.SS1.SSS2.p1.4.m4.1.1.2.3.cmml">w</mi></msub><mo id="S2.SS1.SSS2.p1.4.m4.1.1.1" xref="S2.SS1.SSS2.p1.4.m4.1.1.1.cmml">≻</mo><mrow id="S2.SS1.SSS2.p1.4.m4.1.1.3" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.cmml"><msub id="S2.SS1.SSS2.p1.4.m4.1.1.3.2" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.2.cmml"><mi id="S2.SS1.SSS2.p1.4.m4.1.1.3.2.2" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.2.2.cmml">y</mi><mi id="S2.SS1.SSS2.p1.4.m4.1.1.3.2.3" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.2.3.cmml">l</mi></msub><mo id="S2.SS1.SSS2.p1.4.m4.1.1.3.1" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.1.cmml">∣</mo><mi id="S2.SS1.SSS2.p1.4.m4.1.1.3.3" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.3.cmml">x</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.4.m4.1b"><apply id="S2.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1"><csymbol cd="latexml" id="S2.SS1.SSS2.p1.4.m4.1.1.1.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.1">succeeds</csymbol><apply id="S2.SS1.SSS2.p1.4.m4.1.1.2.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.4.m4.1.1.2.1.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS1.SSS2.p1.4.m4.1.1.2.2.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.2.2">𝑦</ci><ci id="S2.SS1.SSS2.p1.4.m4.1.1.2.3.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.2.3">𝑤</ci></apply><apply id="S2.SS1.SSS2.p1.4.m4.1.1.3.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.3"><csymbol cd="latexml" id="S2.SS1.SSS2.p1.4.m4.1.1.3.1.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.1">conditional</csymbol><apply id="S2.SS1.SSS2.p1.4.m4.1.1.3.2.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.4.m4.1.1.3.2.1.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.2">subscript</csymbol><ci id="S2.SS1.SSS2.p1.4.m4.1.1.3.2.2.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.2.2">𝑦</ci><ci id="S2.SS1.SSS2.p1.4.m4.1.1.3.2.3.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.2.3">𝑙</ci></apply><ci id="S2.SS1.SSS2.p1.4.m4.1.1.3.3.cmml" xref="S2.SS1.SSS2.p1.4.m4.1.1.3.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.4.m4.1c">y_{w}\succ y_{l}\mid x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∣ italic_x</annotation></semantics></math>, where <math alttext="y_{w}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.5.m5.1"><semantics id="S2.SS1.SSS2.p1.5.m5.1a"><msub id="S2.SS1.SSS2.p1.5.m5.1.1" xref="S2.SS1.SSS2.p1.5.m5.1.1.cmml"><mi id="S2.SS1.SSS2.p1.5.m5.1.1.2" xref="S2.SS1.SSS2.p1.5.m5.1.1.2.cmml">y</mi><mi id="S2.SS1.SSS2.p1.5.m5.1.1.3" xref="S2.SS1.SSS2.p1.5.m5.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.5.m5.1b"><apply id="S2.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.5.m5.1.1.1.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p1.5.m5.1.1.2.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1.2">𝑦</ci><ci id="S2.SS1.SSS2.p1.5.m5.1.1.3.cmml" xref="S2.SS1.SSS2.p1.5.m5.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.5.m5.1c">y_{w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{l}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.6.m6.1"><semantics id="S2.SS1.SSS2.p1.6.m6.1a"><msub id="S2.SS1.SSS2.p1.6.m6.1.1" xref="S2.SS1.SSS2.p1.6.m6.1.1.cmml"><mi id="S2.SS1.SSS2.p1.6.m6.1.1.2" xref="S2.SS1.SSS2.p1.6.m6.1.1.2.cmml">y</mi><mi id="S2.SS1.SSS2.p1.6.m6.1.1.3" xref="S2.SS1.SSS2.p1.6.m6.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.6.m6.1b"><apply id="S2.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S2.SS1.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.6.m6.1.1.1.cmml" xref="S2.SS1.SSS2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.SSS2.p1.6.m6.1.1.2.cmml" xref="S2.SS1.SSS2.p1.6.m6.1.1.2">𝑦</ci><ci id="S2.SS1.SSS2.p1.6.m6.1.1.3.cmml" xref="S2.SS1.SSS2.p1.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.6.m6.1c">y_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.6.m6.1d">italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> represent the preferred and non-preferred responses, respectively. This ranking process is typically modeled using the Bradley-Terry (BT) preference model <cite class="ltx_cite ltx_citemacro_citep">(Bradley &amp; Terry, <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib10" title="">1952</a>)</cite>, which assumes the preference distribution:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{\text{BT}}(y_{1}\succ y_{2}\mid x)=\frac{\exp\left(r(x,y_{1})\right)}{\exp%
\left(r(x,y_{1})\right)+\exp\left(r(x,y_{2})\right)}=\sigma\left(r(x,y_{1})-r(%
x,y_{2})\right)," class="ltx_Math" display="block" id="S2.E1.m1.12"><semantics id="S2.E1.m1.12a"><mrow id="S2.E1.m1.12.12.1" xref="S2.E1.m1.12.12.1.1.cmml"><mrow id="S2.E1.m1.12.12.1.1" xref="S2.E1.m1.12.12.1.1.cmml"><mrow id="S2.E1.m1.12.12.1.1.1" xref="S2.E1.m1.12.12.1.1.1.cmml"><msub id="S2.E1.m1.12.12.1.1.1.3" xref="S2.E1.m1.12.12.1.1.1.3.cmml"><mi id="S2.E1.m1.12.12.1.1.1.3.2" xref="S2.E1.m1.12.12.1.1.1.3.2.cmml">p</mi><mtext id="S2.E1.m1.12.12.1.1.1.3.3" xref="S2.E1.m1.12.12.1.1.1.3.3a.cmml">BT</mtext></msub><mo id="S2.E1.m1.12.12.1.1.1.2" xref="S2.E1.m1.12.12.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.12.12.1.1.1.1.1" xref="S2.E1.m1.12.12.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.12.12.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.12.12.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.12.12.1.1.1.1.1.1" xref="S2.E1.m1.12.12.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.12.12.1.1.1.1.1.1.2" xref="S2.E1.m1.12.12.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.12.12.1.1.1.1.1.1.2.2" xref="S2.E1.m1.12.12.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="S2.E1.m1.12.12.1.1.1.1.1.1.2.3" xref="S2.E1.m1.12.12.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.E1.m1.12.12.1.1.1.1.1.1.1" xref="S2.E1.m1.12.12.1.1.1.1.1.1.1.cmml">≻</mo><mrow id="S2.E1.m1.12.12.1.1.1.1.1.1.3" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.cmml"><msub id="S2.E1.m1.12.12.1.1.1.1.1.1.3.2" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.2.cmml">y</mi><mn id="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo id="S2.E1.m1.12.12.1.1.1.1.1.1.3.1" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.1.cmml">∣</mo><mi id="S2.E1.m1.12.12.1.1.1.1.1.1.3.3" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S2.E1.m1.12.12.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.12.12.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.12.12.1.1.4" xref="S2.E1.m1.12.12.1.1.4.cmml">=</mo><mfrac id="S2.E1.m1.9.9" xref="S2.E1.m1.9.9.cmml"><mrow id="S2.E1.m1.3.3.3.3" xref="S2.E1.m1.3.3.3.4.cmml"><mi id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">exp</mi><mo id="S2.E1.m1.3.3.3.3a" xref="S2.E1.m1.3.3.3.4.cmml">⁡</mo><mrow id="S2.E1.m1.3.3.3.3.1" xref="S2.E1.m1.3.3.3.4.cmml"><mo id="S2.E1.m1.3.3.3.3.1.2" xref="S2.E1.m1.3.3.3.4.cmml">(</mo><mrow id="S2.E1.m1.3.3.3.3.1.1" xref="S2.E1.m1.3.3.3.3.1.1.cmml"><mi id="S2.E1.m1.3.3.3.3.1.1.3" xref="S2.E1.m1.3.3.3.3.1.1.3.cmml">r</mi><mo id="S2.E1.m1.3.3.3.3.1.1.2" xref="S2.E1.m1.3.3.3.3.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.3.3.1.1.1.1" xref="S2.E1.m1.3.3.3.3.1.1.1.2.cmml"><mo id="S2.E1.m1.3.3.3.3.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.3.3.3.3.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">x</mi><mo id="S2.E1.m1.3.3.3.3.1.1.1.1.3" xref="S2.E1.m1.3.3.3.3.1.1.1.2.cmml">,</mo><msub id="S2.E1.m1.3.3.3.3.1.1.1.1.1" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S2.E1.m1.3.3.3.3.1.1.1.1.1.2" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1.2.cmml">y</mi><mn id="S2.E1.m1.3.3.3.3.1.1.1.1.1.3" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E1.m1.3.3.3.3.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.3.3.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.3.3.1.3" xref="S2.E1.m1.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="S2.E1.m1.9.9.9" xref="S2.E1.m1.9.9.9.cmml"><mrow id="S2.E1.m1.8.8.8.5.1" xref="S2.E1.m1.8.8.8.5.2.cmml"><mi id="S2.E1.m1.5.5.5.2" xref="S2.E1.m1.5.5.5.2.cmml">exp</mi><mo id="S2.E1.m1.8.8.8.5.1a" xref="S2.E1.m1.8.8.8.5.2.cmml">⁡</mo><mrow id="S2.E1.m1.8.8.8.5.1.1" xref="S2.E1.m1.8.8.8.5.2.cmml"><mo id="S2.E1.m1.8.8.8.5.1.1.2" xref="S2.E1.m1.8.8.8.5.2.cmml">(</mo><mrow id="S2.E1.m1.8.8.8.5.1.1.1" xref="S2.E1.m1.8.8.8.5.1.1.1.cmml"><mi id="S2.E1.m1.8.8.8.5.1.1.1.3" xref="S2.E1.m1.8.8.8.5.1.1.1.3.cmml">r</mi><mo id="S2.E1.m1.8.8.8.5.1.1.1.2" xref="S2.E1.m1.8.8.8.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.8.8.8.5.1.1.1.1.1" xref="S2.E1.m1.8.8.8.5.1.1.1.1.2.cmml"><mo id="S2.E1.m1.8.8.8.5.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.8.8.8.5.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.4.4.4.1" xref="S2.E1.m1.4.4.4.1.cmml">x</mi><mo id="S2.E1.m1.8.8.8.5.1.1.1.1.1.3" xref="S2.E1.m1.8.8.8.5.1.1.1.1.2.cmml">,</mo><msub id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.2" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.2.cmml">y</mi><mn id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.3" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E1.m1.8.8.8.5.1.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.8.8.8.5.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.8.8.8.5.1.1.3" xref="S2.E1.m1.8.8.8.5.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.9.9.9.7" xref="S2.E1.m1.9.9.9.7.cmml">+</mo><mrow id="S2.E1.m1.9.9.9.6.1" xref="S2.E1.m1.9.9.9.6.2.cmml"><mi id="S2.E1.m1.7.7.7.4" xref="S2.E1.m1.7.7.7.4.cmml">exp</mi><mo id="S2.E1.m1.9.9.9.6.1a" xref="S2.E1.m1.9.9.9.6.2.cmml">⁡</mo><mrow id="S2.E1.m1.9.9.9.6.1.1" xref="S2.E1.m1.9.9.9.6.2.cmml"><mo id="S2.E1.m1.9.9.9.6.1.1.2" xref="S2.E1.m1.9.9.9.6.2.cmml">(</mo><mrow id="S2.E1.m1.9.9.9.6.1.1.1" xref="S2.E1.m1.9.9.9.6.1.1.1.cmml"><mi id="S2.E1.m1.9.9.9.6.1.1.1.3" xref="S2.E1.m1.9.9.9.6.1.1.1.3.cmml">r</mi><mo id="S2.E1.m1.9.9.9.6.1.1.1.2" xref="S2.E1.m1.9.9.9.6.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.9.9.9.6.1.1.1.1.1" xref="S2.E1.m1.9.9.9.6.1.1.1.1.2.cmml"><mo id="S2.E1.m1.9.9.9.6.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.9.9.9.6.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.6.6.6.3" xref="S2.E1.m1.6.6.6.3.cmml">x</mi><mo id="S2.E1.m1.9.9.9.6.1.1.1.1.1.3" xref="S2.E1.m1.9.9.9.6.1.1.1.1.2.cmml">,</mo><msub id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.2" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.2.cmml">y</mi><mn id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.3" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="S2.E1.m1.9.9.9.6.1.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.9.9.9.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.9.9.9.6.1.1.3" xref="S2.E1.m1.9.9.9.6.2.cmml">)</mo></mrow></mrow></mrow></mfrac><mo id="S2.E1.m1.12.12.1.1.5" xref="S2.E1.m1.12.12.1.1.5.cmml">=</mo><mrow id="S2.E1.m1.12.12.1.1.2" xref="S2.E1.m1.12.12.1.1.2.cmml"><mi id="S2.E1.m1.12.12.1.1.2.3" xref="S2.E1.m1.12.12.1.1.2.3.cmml">σ</mi><mo id="S2.E1.m1.12.12.1.1.2.2" xref="S2.E1.m1.12.12.1.1.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.12.12.1.1.2.1.1" xref="S2.E1.m1.12.12.1.1.2.1.1.1.cmml"><mo id="S2.E1.m1.12.12.1.1.2.1.1.2" xref="S2.E1.m1.12.12.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.12.12.1.1.2.1.1.1" xref="S2.E1.m1.12.12.1.1.2.1.1.1.cmml"><mrow id="S2.E1.m1.12.12.1.1.2.1.1.1.1" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.cmml"><mi id="S2.E1.m1.12.12.1.1.2.1.1.1.1.3" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.3.cmml">r</mi><mo id="S2.E1.m1.12.12.1.1.2.1.1.1.1.2" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.10.10" xref="S2.E1.m1.10.10.cmml">x</mi><mo id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.3" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.12.12.1.1.2.1.1.1.3" xref="S2.E1.m1.12.12.1.1.2.1.1.1.3.cmml">−</mo><mrow id="S2.E1.m1.12.12.1.1.2.1.1.1.2" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.cmml"><mi id="S2.E1.m1.12.12.1.1.2.1.1.1.2.3" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.3.cmml">r</mi><mo id="S2.E1.m1.12.12.1.1.2.1.1.1.2.2" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.2.cmml"><mo id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.2" stretchy="false" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.2.cmml">(</mo><mi id="S2.E1.m1.11.11" xref="S2.E1.m1.11.11.cmml">x</mi><mo id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.3" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.2.cmml">,</mo><msub id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.cmml"><mi id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.2" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.2.cmml">y</mi><mn id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.3" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.3.cmml">2</mn></msub><mo id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.4" stretchy="false" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.12.12.1.1.2.1.1.3" xref="S2.E1.m1.12.12.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.12.12.1.2" xref="S2.E1.m1.12.12.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.12b"><apply id="S2.E1.m1.12.12.1.1.cmml" xref="S2.E1.m1.12.12.1"><and id="S2.E1.m1.12.12.1.1a.cmml" xref="S2.E1.m1.12.12.1"></and><apply id="S2.E1.m1.12.12.1.1b.cmml" xref="S2.E1.m1.12.12.1"><eq id="S2.E1.m1.12.12.1.1.4.cmml" xref="S2.E1.m1.12.12.1.1.4"></eq><apply id="S2.E1.m1.12.12.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.1"><times id="S2.E1.m1.12.12.1.1.1.2.cmml" xref="S2.E1.m1.12.12.1.1.1.2"></times><apply id="S2.E1.m1.12.12.1.1.1.3.cmml" xref="S2.E1.m1.12.12.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.1.1.1.3.1.cmml" xref="S2.E1.m1.12.12.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.12.12.1.1.1.3.2.cmml" xref="S2.E1.m1.12.12.1.1.1.3.2">𝑝</ci><ci id="S2.E1.m1.12.12.1.1.1.3.3a.cmml" xref="S2.E1.m1.12.12.1.1.1.3.3"><mtext id="S2.E1.m1.12.12.1.1.1.3.3.cmml" mathsize="70%" xref="S2.E1.m1.12.12.1.1.1.3.3">BT</mtext></ci></apply><apply id="S2.E1.m1.12.12.1.1.1.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.12.12.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1.1.1">succeeds</csymbol><apply id="S2.E1.m1.12.12.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.12.12.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1.1.2.2">𝑦</ci><cn id="S2.E1.m1.12.12.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S2.E1.m1.12.12.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S2.E1.m1.12.12.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.E1.m1.12.12.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.1">conditional</csymbol><apply id="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.2">𝑦</ci><cn id="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.2.3">2</cn></apply><ci id="S2.E1.m1.12.12.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.12.12.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><apply id="S2.E1.m1.9.9.cmml" xref="S2.E1.m1.9.9"><divide id="S2.E1.m1.9.9.10.cmml" xref="S2.E1.m1.9.9"></divide><apply id="S2.E1.m1.3.3.3.4.cmml" xref="S2.E1.m1.3.3.3.3"><exp id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"></exp><apply id="S2.E1.m1.3.3.3.3.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1"><times id="S2.E1.m1.3.3.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.2"></times><ci id="S2.E1.m1.3.3.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.3.3.1.1.3">𝑟</ci><interval closure="open" id="S2.E1.m1.3.3.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1.1"><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑥</ci><apply id="S2.E1.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1.2">𝑦</ci><cn id="S2.E1.m1.3.3.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.3.3.3.3.1.1.1.1.1.3">1</cn></apply></interval></apply></apply><apply id="S2.E1.m1.9.9.9.cmml" xref="S2.E1.m1.9.9.9"><plus id="S2.E1.m1.9.9.9.7.cmml" xref="S2.E1.m1.9.9.9.7"></plus><apply id="S2.E1.m1.8.8.8.5.2.cmml" xref="S2.E1.m1.8.8.8.5.1"><exp id="S2.E1.m1.5.5.5.2.cmml" xref="S2.E1.m1.5.5.5.2"></exp><apply id="S2.E1.m1.8.8.8.5.1.1.1.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1"><times id="S2.E1.m1.8.8.8.5.1.1.1.2.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.2"></times><ci id="S2.E1.m1.8.8.8.5.1.1.1.3.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.3">𝑟</ci><interval closure="open" id="S2.E1.m1.8.8.8.5.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1"><ci id="S2.E1.m1.4.4.4.1.cmml" xref="S2.E1.m1.4.4.4.1">𝑥</ci><apply id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.2">𝑦</ci><cn id="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.8.8.8.5.1.1.1.1.1.1.3">1</cn></apply></interval></apply></apply><apply id="S2.E1.m1.9.9.9.6.2.cmml" xref="S2.E1.m1.9.9.9.6.1"><exp id="S2.E1.m1.7.7.7.4.cmml" xref="S2.E1.m1.7.7.7.4"></exp><apply id="S2.E1.m1.9.9.9.6.1.1.1.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1"><times id="S2.E1.m1.9.9.9.6.1.1.1.2.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.2"></times><ci id="S2.E1.m1.9.9.9.6.1.1.1.3.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.3">𝑟</ci><interval closure="open" id="S2.E1.m1.9.9.9.6.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1"><ci id="S2.E1.m1.6.6.6.3.cmml" xref="S2.E1.m1.6.6.6.3">𝑥</ci><apply id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.2">𝑦</ci><cn id="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.9.9.9.6.1.1.1.1.1.1.3">2</cn></apply></interval></apply></apply></apply></apply></apply><apply id="S2.E1.m1.12.12.1.1c.cmml" xref="S2.E1.m1.12.12.1"><eq id="S2.E1.m1.12.12.1.1.5.cmml" xref="S2.E1.m1.12.12.1.1.5"></eq><share href="https://arxiv.org/html/2410.12832v1#S2.E1.m1.9.9.cmml" id="S2.E1.m1.12.12.1.1d.cmml" xref="S2.E1.m1.12.12.1"></share><apply id="S2.E1.m1.12.12.1.1.2.cmml" xref="S2.E1.m1.12.12.1.1.2"><times id="S2.E1.m1.12.12.1.1.2.2.cmml" xref="S2.E1.m1.12.12.1.1.2.2"></times><ci id="S2.E1.m1.12.12.1.1.2.3.cmml" xref="S2.E1.m1.12.12.1.1.2.3">𝜎</ci><apply id="S2.E1.m1.12.12.1.1.2.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1"><minus id="S2.E1.m1.12.12.1.1.2.1.1.1.3.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.3"></minus><apply id="S2.E1.m1.12.12.1.1.2.1.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1"><times id="S2.E1.m1.12.12.1.1.2.1.1.1.1.2.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.2"></times><ci id="S2.E1.m1.12.12.1.1.2.1.1.1.1.3.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.3">𝑟</ci><interval closure="open" id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1"><ci id="S2.E1.m1.10.10.cmml" xref="S2.E1.m1.10.10">𝑥</ci><apply id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.2">𝑦</ci><cn id="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.12.12.1.1.2.1.1.1.1.1.1.1.3">1</cn></apply></interval></apply><apply id="S2.E1.m1.12.12.1.1.2.1.1.1.2.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2"><times id="S2.E1.m1.12.12.1.1.2.1.1.1.2.2.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.2"></times><ci id="S2.E1.m1.12.12.1.1.2.1.1.1.2.3.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.3">𝑟</ci><interval closure="open" id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.2.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1"><ci id="S2.E1.m1.11.11.cmml" xref="S2.E1.m1.11.11">𝑥</ci><apply id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.1.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1">subscript</csymbol><ci id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.2.cmml" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.2">𝑦</ci><cn id="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.12.12.1.1.2.1.1.1.2.1.1.1.3">2</cn></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.12c">p_{\text{BT}}(y_{1}\succ y_{2}\mid x)=\frac{\exp\left(r(x,y_{1})\right)}{\exp%
\left(r(x,y_{1})\right)+\exp\left(r(x,y_{2})\right)}=\sigma\left(r(x,y_{1})-r(%
x,y_{2})\right),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.12d">italic_p start_POSTSUBSCRIPT BT end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ∣ italic_x ) = divide start_ARG roman_exp ( italic_r ( italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ) end_ARG start_ARG roman_exp ( italic_r ( italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ) + roman_exp ( italic_r ( italic_x , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) end_ARG = italic_σ ( italic_r ( italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) - italic_r ( italic_x , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS2.p1.11">where the preference distribution <math alttext="p" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.7.m1.1"><semantics id="S2.SS1.SSS2.p1.7.m1.1a"><mi id="S2.SS1.SSS2.p1.7.m1.1.1" xref="S2.SS1.SSS2.p1.7.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.7.m1.1b"><ci id="S2.SS1.SSS2.p1.7.m1.1.1.cmml" xref="S2.SS1.SSS2.p1.7.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.7.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.7.m1.1d">italic_p</annotation></semantics></math> is driven by a latent reward function <math alttext="r(x,y)" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.8.m2.2"><semantics id="S2.SS1.SSS2.p1.8.m2.2a"><mrow id="S2.SS1.SSS2.p1.8.m2.2.3" xref="S2.SS1.SSS2.p1.8.m2.2.3.cmml"><mi id="S2.SS1.SSS2.p1.8.m2.2.3.2" xref="S2.SS1.SSS2.p1.8.m2.2.3.2.cmml">r</mi><mo id="S2.SS1.SSS2.p1.8.m2.2.3.1" xref="S2.SS1.SSS2.p1.8.m2.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.SSS2.p1.8.m2.2.3.3.2" xref="S2.SS1.SSS2.p1.8.m2.2.3.3.1.cmml"><mo id="S2.SS1.SSS2.p1.8.m2.2.3.3.2.1" stretchy="false" xref="S2.SS1.SSS2.p1.8.m2.2.3.3.1.cmml">(</mo><mi id="S2.SS1.SSS2.p1.8.m2.1.1" xref="S2.SS1.SSS2.p1.8.m2.1.1.cmml">x</mi><mo id="S2.SS1.SSS2.p1.8.m2.2.3.3.2.2" xref="S2.SS1.SSS2.p1.8.m2.2.3.3.1.cmml">,</mo><mi id="S2.SS1.SSS2.p1.8.m2.2.2" xref="S2.SS1.SSS2.p1.8.m2.2.2.cmml">y</mi><mo id="S2.SS1.SSS2.p1.8.m2.2.3.3.2.3" stretchy="false" xref="S2.SS1.SSS2.p1.8.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.8.m2.2b"><apply id="S2.SS1.SSS2.p1.8.m2.2.3.cmml" xref="S2.SS1.SSS2.p1.8.m2.2.3"><times id="S2.SS1.SSS2.p1.8.m2.2.3.1.cmml" xref="S2.SS1.SSS2.p1.8.m2.2.3.1"></times><ci id="S2.SS1.SSS2.p1.8.m2.2.3.2.cmml" xref="S2.SS1.SSS2.p1.8.m2.2.3.2">𝑟</ci><interval closure="open" id="S2.SS1.SSS2.p1.8.m2.2.3.3.1.cmml" xref="S2.SS1.SSS2.p1.8.m2.2.3.3.2"><ci id="S2.SS1.SSS2.p1.8.m2.1.1.cmml" xref="S2.SS1.SSS2.p1.8.m2.1.1">𝑥</ci><ci id="S2.SS1.SSS2.p1.8.m2.2.2.cmml" xref="S2.SS1.SSS2.p1.8.m2.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.8.m2.2c">r(x,y)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.8.m2.2d">italic_r ( italic_x , italic_y )</annotation></semantics></math>, and <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.9.m3.1"><semantics id="S2.SS1.SSS2.p1.9.m3.1a"><mi id="S2.SS1.SSS2.p1.9.m3.1.1" xref="S2.SS1.SSS2.p1.9.m3.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.9.m3.1b"><ci id="S2.SS1.SSS2.p1.9.m3.1.1.cmml" xref="S2.SS1.SSS2.p1.9.m3.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.9.m3.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.9.m3.1d">italic_σ</annotation></semantics></math> is the logistic function (although other objectives can be used). Using this framework and a dataset of rankings <math alttext="\mathcal{D}=\left\{x^{(i)},y_{w}^{(i)},y_{l}^{(i)}\right\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.10.m4.6"><semantics id="S2.SS1.SSS2.p1.10.m4.6a"><mrow id="S2.SS1.SSS2.p1.10.m4.6.6" xref="S2.SS1.SSS2.p1.10.m4.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.SSS2.p1.10.m4.6.6.5" xref="S2.SS1.SSS2.p1.10.m4.6.6.5.cmml">𝒟</mi><mo id="S2.SS1.SSS2.p1.10.m4.6.6.4" xref="S2.SS1.SSS2.p1.10.m4.6.6.4.cmml">=</mo><msubsup id="S2.SS1.SSS2.p1.10.m4.6.6.3" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.cmml"><mrow id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.4.cmml"><mo id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.4" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.4.cmml">{</mo><msup id="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1" xref="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1.2" xref="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1.2.cmml">x</mi><mrow id="S2.SS1.SSS2.p1.10.m4.1.1.1.3" xref="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1.cmml"><mo id="S2.SS1.SSS2.p1.10.m4.1.1.1.3.1" stretchy="false" xref="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1.cmml">(</mo><mi id="S2.SS1.SSS2.p1.10.m4.1.1.1.1" xref="S2.SS1.SSS2.p1.10.m4.1.1.1.1.cmml">i</mi><mo id="S2.SS1.SSS2.p1.10.m4.1.1.1.3.2" stretchy="false" xref="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.5" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.4.cmml">,</mo><msubsup id="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.cmml"><mi id="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.2.2" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.2.2.cmml">y</mi><mi id="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.2.3" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.2.3.cmml">w</mi><mrow id="S2.SS1.SSS2.p1.10.m4.2.2.1.3" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.cmml"><mo id="S2.SS1.SSS2.p1.10.m4.2.2.1.3.1" stretchy="false" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.cmml">(</mo><mi id="S2.SS1.SSS2.p1.10.m4.2.2.1.1" xref="S2.SS1.SSS2.p1.10.m4.2.2.1.1.cmml">i</mi><mo id="S2.SS1.SSS2.p1.10.m4.2.2.1.3.2" stretchy="false" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.6" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.4.cmml">,</mo><msubsup id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.cmml"><mi id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.2.2" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.2.2.cmml">y</mi><mi id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.2.3" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.2.3.cmml">l</mi><mrow id="S2.SS1.SSS2.p1.10.m4.3.3.1.3" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.cmml"><mo id="S2.SS1.SSS2.p1.10.m4.3.3.1.3.1" stretchy="false" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.cmml">(</mo><mi id="S2.SS1.SSS2.p1.10.m4.3.3.1.1" xref="S2.SS1.SSS2.p1.10.m4.3.3.1.1.cmml">i</mi><mo id="S2.SS1.SSS2.p1.10.m4.3.3.1.3.2" stretchy="false" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.7" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.4.cmml">}</mo></mrow><mrow id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.cmml"><mi id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.2" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.2.cmml">i</mi><mo id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.1" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.1.cmml">=</mo><mn id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.3" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.3.cmml">1</mn></mrow><mi id="S2.SS1.SSS2.p1.10.m4.6.6.3.5" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.5.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.10.m4.6b"><apply id="S2.SS1.SSS2.p1.10.m4.6.6.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6"><eq id="S2.SS1.SSS2.p1.10.m4.6.6.4.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.4"></eq><ci id="S2.SS1.SSS2.p1.10.m4.6.6.5.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.5">𝒟</ci><apply id="S2.SS1.SSS2.p1.10.m4.6.6.3.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.10.m4.6.6.3.4.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3">superscript</csymbol><apply id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.4.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3">subscript</csymbol><set id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.4.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3"><apply id="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1">superscript</csymbol><ci id="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.10.m4.4.4.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS1.SSS2.p1.10.m4.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.10.m4.1.1.1.1">𝑖</ci></apply><apply id="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.1.cmml" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2">superscript</csymbol><apply id="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.2.1.cmml" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.2.2.cmml" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.2.2">𝑦</ci><ci id="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.2.3.cmml" xref="S2.SS1.SSS2.p1.10.m4.5.5.2.2.2.2.2.2.3">𝑤</ci></apply><ci id="S2.SS1.SSS2.p1.10.m4.2.2.1.1.cmml" xref="S2.SS1.SSS2.p1.10.m4.2.2.1.1">𝑖</ci></apply><apply id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.1.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3">superscript</csymbol><apply id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.2.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.2.1.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3">subscript</csymbol><ci id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.2.2.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.2.2">𝑦</ci><ci id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.2.3.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.3.3.3.2.3">𝑙</ci></apply><ci id="S2.SS1.SSS2.p1.10.m4.3.3.1.1.cmml" xref="S2.SS1.SSS2.p1.10.m4.3.3.1.1">𝑖</ci></apply></set><apply id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5"><eq id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.1.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.1"></eq><ci id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.2.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.2">𝑖</ci><cn id="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.3.cmml" type="integer" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.3.5.3">1</cn></apply></apply><ci id="S2.SS1.SSS2.p1.10.m4.6.6.3.5.cmml" xref="S2.SS1.SSS2.p1.10.m4.6.6.3.5">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.10.m4.6c">\mathcal{D}=\left\{x^{(i)},y_{w}^{(i)},y_{l}^{(i)}\right\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.10.m4.6d">caligraphic_D = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, a parameterized reward model <math alttext="r_{\phi}(x,y)" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.11.m5.2"><semantics id="S2.SS1.SSS2.p1.11.m5.2a"><mrow id="S2.SS1.SSS2.p1.11.m5.2.3" xref="S2.SS1.SSS2.p1.11.m5.2.3.cmml"><msub id="S2.SS1.SSS2.p1.11.m5.2.3.2" xref="S2.SS1.SSS2.p1.11.m5.2.3.2.cmml"><mi id="S2.SS1.SSS2.p1.11.m5.2.3.2.2" xref="S2.SS1.SSS2.p1.11.m5.2.3.2.2.cmml">r</mi><mi id="S2.SS1.SSS2.p1.11.m5.2.3.2.3" xref="S2.SS1.SSS2.p1.11.m5.2.3.2.3.cmml">ϕ</mi></msub><mo id="S2.SS1.SSS2.p1.11.m5.2.3.1" xref="S2.SS1.SSS2.p1.11.m5.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.SSS2.p1.11.m5.2.3.3.2" xref="S2.SS1.SSS2.p1.11.m5.2.3.3.1.cmml"><mo id="S2.SS1.SSS2.p1.11.m5.2.3.3.2.1" stretchy="false" xref="S2.SS1.SSS2.p1.11.m5.2.3.3.1.cmml">(</mo><mi id="S2.SS1.SSS2.p1.11.m5.1.1" xref="S2.SS1.SSS2.p1.11.m5.1.1.cmml">x</mi><mo id="S2.SS1.SSS2.p1.11.m5.2.3.3.2.2" xref="S2.SS1.SSS2.p1.11.m5.2.3.3.1.cmml">,</mo><mi id="S2.SS1.SSS2.p1.11.m5.2.2" xref="S2.SS1.SSS2.p1.11.m5.2.2.cmml">y</mi><mo id="S2.SS1.SSS2.p1.11.m5.2.3.3.2.3" stretchy="false" xref="S2.SS1.SSS2.p1.11.m5.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.11.m5.2b"><apply id="S2.SS1.SSS2.p1.11.m5.2.3.cmml" xref="S2.SS1.SSS2.p1.11.m5.2.3"><times id="S2.SS1.SSS2.p1.11.m5.2.3.1.cmml" xref="S2.SS1.SSS2.p1.11.m5.2.3.1"></times><apply id="S2.SS1.SSS2.p1.11.m5.2.3.2.cmml" xref="S2.SS1.SSS2.p1.11.m5.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.11.m5.2.3.2.1.cmml" xref="S2.SS1.SSS2.p1.11.m5.2.3.2">subscript</csymbol><ci id="S2.SS1.SSS2.p1.11.m5.2.3.2.2.cmml" xref="S2.SS1.SSS2.p1.11.m5.2.3.2.2">𝑟</ci><ci id="S2.SS1.SSS2.p1.11.m5.2.3.2.3.cmml" xref="S2.SS1.SSS2.p1.11.m5.2.3.2.3">italic-ϕ</ci></apply><interval closure="open" id="S2.SS1.SSS2.p1.11.m5.2.3.3.1.cmml" xref="S2.SS1.SSS2.p1.11.m5.2.3.3.2"><ci id="S2.SS1.SSS2.p1.11.m5.1.1.cmml" xref="S2.SS1.SSS2.p1.11.m5.1.1">𝑥</ci><ci id="S2.SS1.SSS2.p1.11.m5.2.2.cmml" xref="S2.SS1.SSS2.p1.11.m5.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.11.m5.2c">r_{\phi}(x,y)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.11.m5.2d">italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y )</annotation></semantics></math> is trained via maximum likelihood estimation to predict the unobserved reward:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathrm{rew}}(r_{\phi})=-\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{%
D}}\left[\log\sigma\left(r_{\phi}(x,y_{w})-r_{\phi}(x,y_{l})\right)\right]." class="ltx_Math" display="block" id="S2.E2.m1.6"><semantics id="S2.E2.m1.6a"><mrow id="S2.E2.m1.6.6.1" xref="S2.E2.m1.6.6.1.1.cmml"><mrow id="S2.E2.m1.6.6.1.1" xref="S2.E2.m1.6.6.1.1.cmml"><mrow id="S2.E2.m1.6.6.1.1.1" xref="S2.E2.m1.6.6.1.1.1.cmml"><msub id="S2.E2.m1.6.6.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.6.6.1.1.1.3.2" xref="S2.E2.m1.6.6.1.1.1.3.2.cmml">ℒ</mi><mi id="S2.E2.m1.6.6.1.1.1.3.3" xref="S2.E2.m1.6.6.1.1.1.3.3.cmml">rew</mi></msub><mo id="S2.E2.m1.6.6.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.6.6.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.6.6.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.1.1.2.cmml">r</mi><mi id="S2.E2.m1.6.6.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.1.1.3.cmml">ϕ</mi></msub><mo id="S2.E2.m1.6.6.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.3" xref="S2.E2.m1.6.6.1.1.3.cmml">=</mo><mrow id="S2.E2.m1.6.6.1.1.2" xref="S2.E2.m1.6.6.1.1.2.cmml"><mo id="S2.E2.m1.6.6.1.1.2a" xref="S2.E2.m1.6.6.1.1.2.cmml">−</mo><mrow id="S2.E2.m1.6.6.1.1.2.1" xref="S2.E2.m1.6.6.1.1.2.1.cmml"><msub id="S2.E2.m1.6.6.1.1.2.1.3" xref="S2.E2.m1.6.6.1.1.2.1.3.cmml"><mi id="S2.E2.m1.6.6.1.1.2.1.3.2" xref="S2.E2.m1.6.6.1.1.2.1.3.2.cmml">𝔼</mi><mrow id="S2.E2.m1.3.3.3" xref="S2.E2.m1.3.3.3.cmml"><mrow id="S2.E2.m1.3.3.3.3.2" xref="S2.E2.m1.3.3.3.3.3.cmml"><mo id="S2.E2.m1.3.3.3.3.2.3" stretchy="false" xref="S2.E2.m1.3.3.3.3.3.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">x</mi><mo id="S2.E2.m1.3.3.3.3.2.4" xref="S2.E2.m1.3.3.3.3.3.cmml">,</mo><msub id="S2.E2.m1.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.1.1.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.2.cmml">y</mi><mi id="S2.E2.m1.2.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.3.cmml">w</mi></msub><mo id="S2.E2.m1.3.3.3.3.2.5" xref="S2.E2.m1.3.3.3.3.3.cmml">,</mo><msub id="S2.E2.m1.3.3.3.3.2.2" xref="S2.E2.m1.3.3.3.3.2.2.cmml"><mi id="S2.E2.m1.3.3.3.3.2.2.2" xref="S2.E2.m1.3.3.3.3.2.2.2.cmml">y</mi><mi id="S2.E2.m1.3.3.3.3.2.2.3" xref="S2.E2.m1.3.3.3.3.2.2.3.cmml">l</mi></msub><mo id="S2.E2.m1.3.3.3.3.2.6" stretchy="false" xref="S2.E2.m1.3.3.3.3.3.cmml">)</mo></mrow><mo id="S2.E2.m1.3.3.3.4" xref="S2.E2.m1.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.3.3.3.5" xref="S2.E2.m1.3.3.3.5.cmml">𝒟</mi></mrow></msub><mo id="S2.E2.m1.6.6.1.1.2.1.2" xref="S2.E2.m1.6.6.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.1.2.1.1.1" xref="S2.E2.m1.6.6.1.1.2.1.1.2.cmml"><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.2" xref="S2.E2.m1.6.6.1.1.2.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.6.6.1.1.2.1.1.1.1" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.cmml"><mrow id="S2.E2.m1.6.6.1.1.2.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.cmml"><mi id="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.1" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.3a" lspace="0.167em" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.2" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">x</mi><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">w</mi></msub><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.3.cmml">ϕ</mi></msub><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.2.cmml"><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.2.cmml">(</mo><mi id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml">x</mi><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.2.cmml">,</mo><msub id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.2" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml">y</mi><mi id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml">l</mi></msub><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.4" stretchy="false" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.6.6.1.1.2.1.1.1.3" xref="S2.E2.m1.6.6.1.1.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.6.6.1.2" lspace="0em" xref="S2.E2.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.6b"><apply id="S2.E2.m1.6.6.1.1.cmml" xref="S2.E2.m1.6.6.1"><eq id="S2.E2.m1.6.6.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.3"></eq><apply id="S2.E2.m1.6.6.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1"><times id="S2.E2.m1.6.6.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.2"></times><apply id="S2.E2.m1.6.6.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.1.3.2">ℒ</ci><ci id="S2.E2.m1.6.6.1.1.1.3.3.cmml" xref="S2.E2.m1.6.6.1.1.1.3.3">rew</ci></apply><apply id="S2.E2.m1.6.6.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.2">𝑟</ci><ci id="S2.E2.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.1.1.3">italic-ϕ</ci></apply></apply><apply id="S2.E2.m1.6.6.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2"><minus id="S2.E2.m1.6.6.1.1.2.2.cmml" xref="S2.E2.m1.6.6.1.1.2"></minus><apply id="S2.E2.m1.6.6.1.1.2.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1"><times id="S2.E2.m1.6.6.1.1.2.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.2"></times><apply id="S2.E2.m1.6.6.1.1.2.1.3.cmml" xref="S2.E2.m1.6.6.1.1.2.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.2.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.2.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.3.2">𝔼</ci><apply id="S2.E2.m1.3.3.3.cmml" xref="S2.E2.m1.3.3.3"><csymbol cd="latexml" id="S2.E2.m1.3.3.3.4.cmml" xref="S2.E2.m1.3.3.3.4">similar-to</csymbol><vector id="S2.E2.m1.3.3.3.3.3.cmml" xref="S2.E2.m1.3.3.3.3.2"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑥</ci><apply id="S2.E2.m1.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="S2.E2.m1.2.2.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3">𝑤</ci></apply><apply id="S2.E2.m1.3.3.3.3.2.2.cmml" xref="S2.E2.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.3.3.2.2.1.cmml" xref="S2.E2.m1.3.3.3.3.2.2">subscript</csymbol><ci id="S2.E2.m1.3.3.3.3.2.2.2.cmml" xref="S2.E2.m1.3.3.3.3.2.2.2">𝑦</ci><ci id="S2.E2.m1.3.3.3.3.2.2.3.cmml" xref="S2.E2.m1.3.3.3.3.2.2.3">𝑙</ci></apply></vector><ci id="S2.E2.m1.3.3.3.5.cmml" xref="S2.E2.m1.3.3.3.5">𝒟</ci></apply></apply><apply id="S2.E2.m1.6.6.1.1.2.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.6.6.1.1.2.1.1.2.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.6.6.1.1.2.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1"><times id="S2.E2.m1.6.6.1.1.2.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.2"></times><apply id="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.3"><log id="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.1"></log><ci id="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.3.2">𝜎</ci></apply><apply id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1"><minus id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.3"></minus><apply id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3">italic-ϕ</ci></apply><interval closure="open" id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">𝑥</ci><apply id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑤</ci></apply></interval></apply><apply id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2"><times id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.2"></times><apply id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.3.3">italic-ϕ</ci></apply><interval closure="open" id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1"><ci id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5">𝑥</ci><apply id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.2">𝑦</ci><ci id="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.2.1.1.1.1.1.1.1.2.1.1.1.3">𝑙</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.6c">\mathcal{L}_{\mathrm{rew}}(r_{\phi})=-\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{%
D}}\left[\log\sigma\left(r_{\phi}(x,y_{w})-r_{\phi}(x,y_{l})\right)\right].</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.6d">caligraphic_L start_POSTSUBSCRIPT roman_rew end_POSTSUBSCRIPT ( italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ) = - blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ roman_log italic_σ ( italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) - italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS2.p1.12">This reward model is based on <math alttext="\pi_{\text{SFT}}(y\mid x)" class="ltx_Math" display="inline" id="S2.SS1.SSS2.p1.12.m1.1"><semantics id="S2.SS1.SSS2.p1.12.m1.1a"><mrow id="S2.SS1.SSS2.p1.12.m1.1.1" xref="S2.SS1.SSS2.p1.12.m1.1.1.cmml"><msub id="S2.SS1.SSS2.p1.12.m1.1.1.3" xref="S2.SS1.SSS2.p1.12.m1.1.1.3.cmml"><mi id="S2.SS1.SSS2.p1.12.m1.1.1.3.2" xref="S2.SS1.SSS2.p1.12.m1.1.1.3.2.cmml">π</mi><mtext id="S2.SS1.SSS2.p1.12.m1.1.1.3.3" xref="S2.SS1.SSS2.p1.12.m1.1.1.3.3a.cmml">SFT</mtext></msub><mo id="S2.SS1.SSS2.p1.12.m1.1.1.2" xref="S2.SS1.SSS2.p1.12.m1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.SSS2.p1.12.m1.1.1.1.1" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.cmml"><mo id="S2.SS1.SSS2.p1.12.m1.1.1.1.1.2" stretchy="false" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.2" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.2.cmml">y</mi><mo id="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.1" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.3" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.SSS2.p1.12.m1.1.1.1.1.3" stretchy="false" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS2.p1.12.m1.1b"><apply id="S2.SS1.SSS2.p1.12.m1.1.1.cmml" xref="S2.SS1.SSS2.p1.12.m1.1.1"><times id="S2.SS1.SSS2.p1.12.m1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.12.m1.1.1.2"></times><apply id="S2.SS1.SSS2.p1.12.m1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.12.m1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS2.p1.12.m1.1.1.3.1.cmml" xref="S2.SS1.SSS2.p1.12.m1.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS2.p1.12.m1.1.1.3.2.cmml" xref="S2.SS1.SSS2.p1.12.m1.1.1.3.2">𝜋</ci><ci id="S2.SS1.SSS2.p1.12.m1.1.1.3.3a.cmml" xref="S2.SS1.SSS2.p1.12.m1.1.1.3.3"><mtext id="S2.SS1.SSS2.p1.12.m1.1.1.3.3.cmml" mathsize="70%" xref="S2.SS1.SSS2.p1.12.m1.1.1.3.3">SFT</mtext></ci></apply><apply id="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS2.p1.12.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS2.p1.12.m1.1c">\pi_{\text{SFT}}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS2.p1.12.m1.1d">italic_π start_POSTSUBSCRIPT SFT end_POSTSUBSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math> with an additional linear predictor on top of the final embedding layer of the model which produces the scalar reward estimate.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.3 </span>Reinforcement Learning (RL)</h4>
<div class="ltx_para ltx_noindent" id="S2.SS1.SSS3.p1">
<p class="ltx_p" id="S2.SS1.SSS3.p1.2">In the final stage, the learned reward model <math alttext="r_{\phi}(x,y)" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.1.m1.2"><semantics id="S2.SS1.SSS3.p1.1.m1.2a"><mrow id="S2.SS1.SSS3.p1.1.m1.2.3" xref="S2.SS1.SSS3.p1.1.m1.2.3.cmml"><msub id="S2.SS1.SSS3.p1.1.m1.2.3.2" xref="S2.SS1.SSS3.p1.1.m1.2.3.2.cmml"><mi id="S2.SS1.SSS3.p1.1.m1.2.3.2.2" xref="S2.SS1.SSS3.p1.1.m1.2.3.2.2.cmml">r</mi><mi id="S2.SS1.SSS3.p1.1.m1.2.3.2.3" xref="S2.SS1.SSS3.p1.1.m1.2.3.2.3.cmml">ϕ</mi></msub><mo id="S2.SS1.SSS3.p1.1.m1.2.3.1" xref="S2.SS1.SSS3.p1.1.m1.2.3.1.cmml">⁢</mo><mrow id="S2.SS1.SSS3.p1.1.m1.2.3.3.2" xref="S2.SS1.SSS3.p1.1.m1.2.3.3.1.cmml"><mo id="S2.SS1.SSS3.p1.1.m1.2.3.3.2.1" stretchy="false" xref="S2.SS1.SSS3.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S2.SS1.SSS3.p1.1.m1.1.1" xref="S2.SS1.SSS3.p1.1.m1.1.1.cmml">x</mi><mo id="S2.SS1.SSS3.p1.1.m1.2.3.3.2.2" xref="S2.SS1.SSS3.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S2.SS1.SSS3.p1.1.m1.2.2" xref="S2.SS1.SSS3.p1.1.m1.2.2.cmml">y</mi><mo id="S2.SS1.SSS3.p1.1.m1.2.3.3.2.3" stretchy="false" xref="S2.SS1.SSS3.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.1.m1.2b"><apply id="S2.SS1.SSS3.p1.1.m1.2.3.cmml" xref="S2.SS1.SSS3.p1.1.m1.2.3"><times id="S2.SS1.SSS3.p1.1.m1.2.3.1.cmml" xref="S2.SS1.SSS3.p1.1.m1.2.3.1"></times><apply id="S2.SS1.SSS3.p1.1.m1.2.3.2.cmml" xref="S2.SS1.SSS3.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.1.m1.2.3.2.1.cmml" xref="S2.SS1.SSS3.p1.1.m1.2.3.2">subscript</csymbol><ci id="S2.SS1.SSS3.p1.1.m1.2.3.2.2.cmml" xref="S2.SS1.SSS3.p1.1.m1.2.3.2.2">𝑟</ci><ci id="S2.SS1.SSS3.p1.1.m1.2.3.2.3.cmml" xref="S2.SS1.SSS3.p1.1.m1.2.3.2.3">italic-ϕ</ci></apply><interval closure="open" id="S2.SS1.SSS3.p1.1.m1.2.3.3.1.cmml" xref="S2.SS1.SSS3.p1.1.m1.2.3.3.2"><ci id="S2.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS3.p1.1.m1.1.1">𝑥</ci><ci id="S2.SS1.SSS3.p1.1.m1.2.2.cmml" xref="S2.SS1.SSS3.p1.1.m1.2.2">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.1.m1.2c">r_{\phi}(x,y)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.1.m1.2d">italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y )</annotation></semantics></math> is used to further optimize the LLM <math alttext="\pi_{\phi}" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.2.m2.1"><semantics id="S2.SS1.SSS3.p1.2.m2.1a"><msub id="S2.SS1.SSS3.p1.2.m2.1.1" xref="S2.SS1.SSS3.p1.2.m2.1.1.cmml"><mi id="S2.SS1.SSS3.p1.2.m2.1.1.2" xref="S2.SS1.SSS3.p1.2.m2.1.1.2.cmml">π</mi><mi id="S2.SS1.SSS3.p1.2.m2.1.1.3" xref="S2.SS1.SSS3.p1.2.m2.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.2.m2.1b"><apply id="S2.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.2.m2.1.1.1.cmml" xref="S2.SS1.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.SSS3.p1.2.m2.1.1.2.cmml" xref="S2.SS1.SSS3.p1.2.m2.1.1.2">𝜋</ci><ci id="S2.SS1.SSS3.p1.2.m2.1.1.3.cmml" xref="S2.SS1.SSS3.p1.2.m2.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.2.m2.1c">\pi_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> via an on-policy RL algorithm, such as Proximal Policy Optimization <cite class="ltx_cite ltx_citemacro_citep">(PPO; Schulman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib34" title="">2017</a>)</cite>. The goal is to refine the LLM’s behavior so that it produces responses preferred by human evaluators. The common optimization objective is:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\pi_{\theta}}\mathbb{E}_{x\sim\mathcal{D},y\sim\pi_{\phi}(.\mid x)}\Bigl%
{[}r_{\phi}(x,y)-\beta\mathbb{D}_{\textrm{KL}}\left[\pi_{\theta}(y\mid x)%
\parallel\pi_{\text{ref}}(y\mid x)\right]\Bigr{]}," class="ltx_math_unparsed" display="block" id="S2.E3.m1.2"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2b"><munder id="S2.E3.m1.2.3"><mi id="S2.E3.m1.2.3.2">max</mi><msub id="S2.E3.m1.2.3.3"><mi id="S2.E3.m1.2.3.3.2">π</mi><mi id="S2.E3.m1.2.3.3.3">θ</mi></msub></munder><msub id="S2.E3.m1.2.4"><mi id="S2.E3.m1.2.4.2">𝔼</mi><mrow id="S2.E3.m1.2.4.3"><mi id="S2.E3.m1.2.4.3.1">x</mi><mo id="S2.E3.m1.2.4.3.2">∼</mo><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.4.3.3">𝒟</mi><mo id="S2.E3.m1.2.4.3.4">,</mo><mi id="S2.E3.m1.2.4.3.5">y</mi><mo id="S2.E3.m1.2.4.3.6">∼</mo><msub id="S2.E3.m1.2.4.3.7"><mi id="S2.E3.m1.2.4.3.7.2">π</mi><mi id="S2.E3.m1.2.4.3.7.3">ϕ</mi></msub><mrow id="S2.E3.m1.2.4.3.8"><mo id="S2.E3.m1.2.4.3.8.1" stretchy="false">(</mo><mo id="S2.E3.m1.2.4.3.8.2" lspace="0em" rspace="0.0835em">.</mo><mo id="S2.E3.m1.2.4.3.8.3" lspace="0.0835em" rspace="0.167em">∣</mo><mi id="S2.E3.m1.2.4.3.8.4">x</mi><mo id="S2.E3.m1.2.4.3.8.5" stretchy="false">)</mo></mrow></mrow></msub><mrow id="S2.E3.m1.2.5"><mo id="S2.E3.m1.2.5.1" maxsize="160%" minsize="160%">[</mo><msub id="S2.E3.m1.2.5.2"><mi id="S2.E3.m1.2.5.2.2">r</mi><mi id="S2.E3.m1.2.5.2.3">ϕ</mi></msub><mrow id="S2.E3.m1.2.5.3"><mo id="S2.E3.m1.2.5.3.1" stretchy="false">(</mo><mi id="S2.E3.m1.1.1">x</mi><mo id="S2.E3.m1.2.5.3.2">,</mo><mi id="S2.E3.m1.2.2">y</mi><mo id="S2.E3.m1.2.5.3.3" stretchy="false">)</mo></mrow><mo id="S2.E3.m1.2.5.4">−</mo><mi id="S2.E3.m1.2.5.5">β</mi><msub id="S2.E3.m1.2.5.6"><mi id="S2.E3.m1.2.5.6.2">𝔻</mi><mtext id="S2.E3.m1.2.5.6.3">KL</mtext></msub><mrow id="S2.E3.m1.2.5.7"><mo id="S2.E3.m1.2.5.7.1">[</mo><msub id="S2.E3.m1.2.5.7.2"><mi id="S2.E3.m1.2.5.7.2.2">π</mi><mi id="S2.E3.m1.2.5.7.2.3">θ</mi></msub><mrow id="S2.E3.m1.2.5.7.3"><mo id="S2.E3.m1.2.5.7.3.1" stretchy="false">(</mo><mi id="S2.E3.m1.2.5.7.3.2">y</mi><mo id="S2.E3.m1.2.5.7.3.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S2.E3.m1.2.5.7.3.4">x</mi><mo id="S2.E3.m1.2.5.7.3.5" stretchy="false">)</mo></mrow><mo id="S2.E3.m1.2.5.7.4" lspace="0em" rspace="0.167em">∥</mo><msub id="S2.E3.m1.2.5.7.5"><mi id="S2.E3.m1.2.5.7.5.2">π</mi><mtext id="S2.E3.m1.2.5.7.5.3">ref</mtext></msub><mrow id="S2.E3.m1.2.5.7.6"><mo id="S2.E3.m1.2.5.7.6.1" stretchy="false">(</mo><mi id="S2.E3.m1.2.5.7.6.2">y</mi><mo id="S2.E3.m1.2.5.7.6.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S2.E3.m1.2.5.7.6.4">x</mi><mo id="S2.E3.m1.2.5.7.6.5" stretchy="false">)</mo></mrow><mo id="S2.E3.m1.2.5.7.7">]</mo></mrow><mo id="S2.E3.m1.2.5.8" maxsize="160%" minsize="160%">]</mo></mrow><mo id="S2.E3.m1.2.6">,</mo></mrow><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\max_{\pi_{\theta}}\mathbb{E}_{x\sim\mathcal{D},y\sim\pi_{\phi}(.\mid x)}\Bigl%
{[}r_{\phi}(x,y)-\beta\mathbb{D}_{\textrm{KL}}\left[\pi_{\theta}(y\mid x)%
\parallel\pi_{\text{ref}}(y\mid x)\right]\Bigr{]},</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.2d">roman_max start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D , italic_y ∼ italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( . ∣ italic_x ) end_POSTSUBSCRIPT [ italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y ) - italic_β blackboard_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT [ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) ∥ italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) ] ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.SSS3.p1.7">where <math alttext="\mathbb{D}_{\textrm{KL}}" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.3.m1.1"><semantics id="S2.SS1.SSS3.p1.3.m1.1a"><msub id="S2.SS1.SSS3.p1.3.m1.1.1" xref="S2.SS1.SSS3.p1.3.m1.1.1.cmml"><mi id="S2.SS1.SSS3.p1.3.m1.1.1.2" xref="S2.SS1.SSS3.p1.3.m1.1.1.2.cmml">𝔻</mi><mtext id="S2.SS1.SSS3.p1.3.m1.1.1.3" xref="S2.SS1.SSS3.p1.3.m1.1.1.3a.cmml">KL</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.3.m1.1b"><apply id="S2.SS1.SSS3.p1.3.m1.1.1.cmml" xref="S2.SS1.SSS3.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.3.m1.1.1.1.cmml" xref="S2.SS1.SSS3.p1.3.m1.1.1">subscript</csymbol><ci id="S2.SS1.SSS3.p1.3.m1.1.1.2.cmml" xref="S2.SS1.SSS3.p1.3.m1.1.1.2">𝔻</ci><ci id="S2.SS1.SSS3.p1.3.m1.1.1.3a.cmml" xref="S2.SS1.SSS3.p1.3.m1.1.1.3"><mtext id="S2.SS1.SSS3.p1.3.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS1.SSS3.p1.3.m1.1.1.3">KL</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.3.m1.1c">\mathbb{D}_{\textrm{KL}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.3.m1.1d">blackboard_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT</annotation></semantics></math> represents the Kullback-Leibler (KL) divergence, and <math alttext="\pi_{\text{ref}}(y\mid x)" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.4.m2.1"><semantics id="S2.SS1.SSS3.p1.4.m2.1a"><mrow id="S2.SS1.SSS3.p1.4.m2.1.1" xref="S2.SS1.SSS3.p1.4.m2.1.1.cmml"><msub id="S2.SS1.SSS3.p1.4.m2.1.1.3" xref="S2.SS1.SSS3.p1.4.m2.1.1.3.cmml"><mi id="S2.SS1.SSS3.p1.4.m2.1.1.3.2" xref="S2.SS1.SSS3.p1.4.m2.1.1.3.2.cmml">π</mi><mtext id="S2.SS1.SSS3.p1.4.m2.1.1.3.3" xref="S2.SS1.SSS3.p1.4.m2.1.1.3.3a.cmml">ref</mtext></msub><mo id="S2.SS1.SSS3.p1.4.m2.1.1.2" xref="S2.SS1.SSS3.p1.4.m2.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.SSS3.p1.4.m2.1.1.1.1" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.cmml"><mo id="S2.SS1.SSS3.p1.4.m2.1.1.1.1.2" stretchy="false" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.2" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.2.cmml">y</mi><mo id="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.1" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.3" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.SSS3.p1.4.m2.1.1.1.1.3" stretchy="false" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.4.m2.1b"><apply id="S2.SS1.SSS3.p1.4.m2.1.1.cmml" xref="S2.SS1.SSS3.p1.4.m2.1.1"><times id="S2.SS1.SSS3.p1.4.m2.1.1.2.cmml" xref="S2.SS1.SSS3.p1.4.m2.1.1.2"></times><apply id="S2.SS1.SSS3.p1.4.m2.1.1.3.cmml" xref="S2.SS1.SSS3.p1.4.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.4.m2.1.1.3.1.cmml" xref="S2.SS1.SSS3.p1.4.m2.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS3.p1.4.m2.1.1.3.2.cmml" xref="S2.SS1.SSS3.p1.4.m2.1.1.3.2">𝜋</ci><ci id="S2.SS1.SSS3.p1.4.m2.1.1.3.3a.cmml" xref="S2.SS1.SSS3.p1.4.m2.1.1.3.3"><mtext id="S2.SS1.SSS3.p1.4.m2.1.1.3.3.cmml" mathsize="70%" xref="S2.SS1.SSS3.p1.4.m2.1.1.3.3">ref</mtext></ci></apply><apply id="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.cmml" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS3.p1.4.m2.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.4.m2.1c">\pi_{\text{ref}}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.4.m2.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math> is typically the supervised fine-tuned model <math alttext="\pi_{\text{SFT}}(y\mid x)" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.5.m3.1"><semantics id="S2.SS1.SSS3.p1.5.m3.1a"><mrow id="S2.SS1.SSS3.p1.5.m3.1.1" xref="S2.SS1.SSS3.p1.5.m3.1.1.cmml"><msub id="S2.SS1.SSS3.p1.5.m3.1.1.3" xref="S2.SS1.SSS3.p1.5.m3.1.1.3.cmml"><mi id="S2.SS1.SSS3.p1.5.m3.1.1.3.2" xref="S2.SS1.SSS3.p1.5.m3.1.1.3.2.cmml">π</mi><mtext id="S2.SS1.SSS3.p1.5.m3.1.1.3.3" xref="S2.SS1.SSS3.p1.5.m3.1.1.3.3a.cmml">SFT</mtext></msub><mo id="S2.SS1.SSS3.p1.5.m3.1.1.2" xref="S2.SS1.SSS3.p1.5.m3.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.SSS3.p1.5.m3.1.1.1.1" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.cmml"><mo id="S2.SS1.SSS3.p1.5.m3.1.1.1.1.2" stretchy="false" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.cmml"><mi id="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.2" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.2.cmml">y</mi><mo id="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.1" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.1.cmml">∣</mo><mi id="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.3" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.SS1.SSS3.p1.5.m3.1.1.1.1.3" stretchy="false" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.5.m3.1b"><apply id="S2.SS1.SSS3.p1.5.m3.1.1.cmml" xref="S2.SS1.SSS3.p1.5.m3.1.1"><times id="S2.SS1.SSS3.p1.5.m3.1.1.2.cmml" xref="S2.SS1.SSS3.p1.5.m3.1.1.2"></times><apply id="S2.SS1.SSS3.p1.5.m3.1.1.3.cmml" xref="S2.SS1.SSS3.p1.5.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.5.m3.1.1.3.1.cmml" xref="S2.SS1.SSS3.p1.5.m3.1.1.3">subscript</csymbol><ci id="S2.SS1.SSS3.p1.5.m3.1.1.3.2.cmml" xref="S2.SS1.SSS3.p1.5.m3.1.1.3.2">𝜋</ci><ci id="S2.SS1.SSS3.p1.5.m3.1.1.3.3a.cmml" xref="S2.SS1.SSS3.p1.5.m3.1.1.3.3"><mtext id="S2.SS1.SSS3.p1.5.m3.1.1.3.3.cmml" mathsize="70%" xref="S2.SS1.SSS3.p1.5.m3.1.1.3.3">SFT</mtext></ci></apply><apply id="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.cmml" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.2">𝑦</ci><ci id="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.SSS3.p1.5.m3.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.5.m3.1c">\pi_{\text{SFT}}(y\mid x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.5.m3.1d">italic_π start_POSTSUBSCRIPT SFT end_POSTSUBSCRIPT ( italic_y ∣ italic_x )</annotation></semantics></math>. The KL divergence penalty prevents the LLM <math alttext="\pi_{\phi}" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.6.m4.1"><semantics id="S2.SS1.SSS3.p1.6.m4.1a"><msub id="S2.SS1.SSS3.p1.6.m4.1.1" xref="S2.SS1.SSS3.p1.6.m4.1.1.cmml"><mi id="S2.SS1.SSS3.p1.6.m4.1.1.2" xref="S2.SS1.SSS3.p1.6.m4.1.1.2.cmml">π</mi><mi id="S2.SS1.SSS3.p1.6.m4.1.1.3" xref="S2.SS1.SSS3.p1.6.m4.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.6.m4.1b"><apply id="S2.SS1.SSS3.p1.6.m4.1.1.cmml" xref="S2.SS1.SSS3.p1.6.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.SSS3.p1.6.m4.1.1.1.cmml" xref="S2.SS1.SSS3.p1.6.m4.1.1">subscript</csymbol><ci id="S2.SS1.SSS3.p1.6.m4.1.1.2.cmml" xref="S2.SS1.SSS3.p1.6.m4.1.1.2">𝜋</ci><ci id="S2.SS1.SSS3.p1.6.m4.1.1.3.cmml" xref="S2.SS1.SSS3.p1.6.m4.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.6.m4.1c">\pi_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.6.m4.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> from deviating too far from its initial behavior, with the hyperparameter <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p1.7.m5.1"><semantics id="S2.SS1.SSS3.p1.7.m5.1a"><mi id="S2.SS1.SSS3.p1.7.m5.1.1" xref="S2.SS1.SSS3.p1.7.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p1.7.m5.1b"><ci id="S2.SS1.SSS3.p1.7.m5.1.1.cmml" xref="S2.SS1.SSS3.p1.7.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p1.7.m5.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p1.7.m5.1d">italic_β</annotation></semantics></math> controlling the trade-off between exploiting the reward model and maintaining consistency with the reference model.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Self-Taught Reasoner</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The Self-Taught Reasoner (STaR) method introduces an iterative bootstrapping approach designed to improve the reasoning capabilities of LLMs <cite class="ltx_cite ltx_citemacro_citep">(Zelikman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib49" title="">2022</a>)</cite>. STaR focuses on training models to generate and refine rationales, particularly for tasks requiring complex reasoning in a reinforcement learning-based manner. We outline the main points of the approach below.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>Rationale Generation Bootstrapping</h4>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS1.p1">
<p class="ltx_p" id="S2.SS2.SSS1.p1.9">In our formulation we assume we have access to a dataset <math alttext="\mathcal{D}=\{x^{(i)},y^{(i)}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.1.m1.4"><semantics id="S2.SS2.SSS1.p1.1.m1.4a"><mrow id="S2.SS2.SSS1.p1.1.m1.4.4" xref="S2.SS2.SSS1.p1.1.m1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.1.m1.4.4.4" xref="S2.SS2.SSS1.p1.1.m1.4.4.4.cmml">𝒟</mi><mo id="S2.SS2.SSS1.p1.1.m1.4.4.3" xref="S2.SS2.SSS1.p1.1.m1.4.4.3.cmml">=</mo><msubsup id="S2.SS2.SSS1.p1.1.m1.4.4.2" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.cmml"><mrow id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.3.cmml"><mo id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.3" stretchy="false" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.3.cmml">{</mo><msup id="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1" xref="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1.2" xref="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1.2.cmml">x</mi><mrow id="S2.SS2.SSS1.p1.1.m1.1.1.1.3" xref="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mi id="S2.SS2.SSS1.p1.1.m1.1.1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.4" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.3.cmml">,</mo><msup id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2.cmml"><mi id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2.2" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2.2.cmml">y</mi><mrow id="S2.SS2.SSS1.p1.1.m1.2.2.1.3" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2.cmml"><mo id="S2.SS2.SSS1.p1.1.m1.2.2.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.1.m1.2.2.1.1" xref="S2.SS2.SSS1.p1.1.m1.2.2.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.1.m1.2.2.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2.cmml">)</mo></mrow></msup><mo id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.5" stretchy="false" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.3.cmml">}</mo></mrow><mrow id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.cmml"><mi id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.2" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.2.cmml">i</mi><mo id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.1" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.1.cmml">=</mo><mn id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.3" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.3.cmml">1</mn></mrow><mi id="S2.SS2.SSS1.p1.1.m1.4.4.2.4" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.4.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.4b"><apply id="S2.SS2.SSS1.p1.1.m1.4.4.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4"><eq id="S2.SS2.SSS1.p1.1.m1.4.4.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.3"></eq><ci id="S2.SS2.SSS1.p1.1.m1.4.4.4.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.4">𝒟</ci><apply id="S2.SS2.SSS1.p1.1.m1.4.4.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.1.m1.4.4.2.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2">superscript</csymbol><apply id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2">subscript</csymbol><set id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.3.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2"><apply id="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.3.3.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS2.SSS1.p1.1.m1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2">superscript</csymbol><ci id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.2.2.2.2">𝑦</ci><ci id="S2.SS2.SSS1.p1.1.m1.2.2.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.2.2.1.1">𝑖</ci></apply></set><apply id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4"><eq id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.1"></eq><ci id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.2.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.2">𝑖</ci><cn id="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.3.cmml" type="integer" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.2.4.3">1</cn></apply></apply><ci id="S2.SS2.SSS1.p1.1.m1.4.4.2.4.cmml" xref="S2.SS2.SSS1.p1.1.m1.4.4.2.4">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.4c">\mathcal{D}=\{x^{(i)},y^{(i)}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.1.m1.4d">caligraphic_D = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> of questions <math alttext="x" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.2.m2.1"><semantics id="S2.SS2.SSS1.p1.2.m2.1a"><mi id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.1b"><ci id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.2.m2.1d">italic_x</annotation></semantics></math> that require strong reasoning and the corresponding answers <math alttext="y" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.3.m3.1"><semantics id="S2.SS2.SSS1.p1.3.m3.1a"><mi id="S2.SS2.SSS1.p1.3.m3.1.1" xref="S2.SS2.SSS1.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.3.m3.1b"><ci id="S2.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS1.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.3.m3.1d">italic_y</annotation></semantics></math>. Notice that we do not require access to strong or ground-truth rationales for these problems. We begin by prompting a model <math alttext="\hat{y}^{(i)},\hat{r}^{(i)}\sim\pi(y,r|x^{(i)})" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.4.m4.7"><semantics id="S2.SS2.SSS1.p1.4.m4.7a"><mrow id="S2.SS2.SSS1.p1.4.m4.7.7" xref="S2.SS2.SSS1.p1.4.m4.7.7.cmml"><mrow id="S2.SS2.SSS1.p1.4.m4.6.6.2.2" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.3.cmml"><msup id="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2.2" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2.2.cmml">y</mi><mo id="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2.1" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.SS2.SSS1.p1.4.m4.1.1.1.3" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.cmml"><mo id="S2.SS2.SSS1.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.cmml">(</mo><mi id="S2.SS2.SSS1.p1.4.m4.1.1.1.1" xref="S2.SS2.SSS1.p1.4.m4.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.cmml">)</mo></mrow></msup><mo id="S2.SS2.SSS1.p1.4.m4.6.6.2.2.3" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.3.cmml">,</mo><msup id="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2.2" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2.2.cmml">r</mi><mo id="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2.1" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2.1.cmml">^</mo></mover><mrow id="S2.SS2.SSS1.p1.4.m4.2.2.1.3" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.cmml"><mo id="S2.SS2.SSS1.p1.4.m4.2.2.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.4.m4.2.2.1.1" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.4.m4.2.2.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.cmml">)</mo></mrow></msup></mrow><mo id="S2.SS2.SSS1.p1.4.m4.7.7.4" xref="S2.SS2.SSS1.p1.4.m4.7.7.4.cmml">∼</mo><mrow id="S2.SS2.SSS1.p1.4.m4.7.7.3" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.7.7.3.3" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.3.cmml">π</mi><mo id="S2.SS2.SSS1.p1.4.m4.7.7.3.2" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.2.cmml">⁢</mo><mrow id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.2.cmml"><mo id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.2" stretchy="false" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.4.m4.4.4" xref="S2.SS2.SSS1.p1.4.m4.4.4.cmml">y</mi><mo id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.3" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.2.cmml">,</mo><mrow id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.2" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.2.cmml">r</mi><mo fence="false" id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.1" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.1.cmml">|</mo><msup id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3.cmml"><mi id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3.2" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3.2.cmml">x</mi><mrow id="S2.SS2.SSS1.p1.4.m4.3.3.1.3" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3.cmml"><mo id="S2.SS2.SSS1.p1.4.m4.3.3.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3.cmml">(</mo><mi id="S2.SS2.SSS1.p1.4.m4.3.3.1.1" xref="S2.SS2.SSS1.p1.4.m4.3.3.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.4.m4.3.3.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.4" stretchy="false" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.4.m4.7b"><apply id="S2.SS2.SSS1.p1.4.m4.7.7.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7"><csymbol cd="latexml" id="S2.SS2.SSS1.p1.4.m4.7.7.4.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.4">similar-to</csymbol><list id="S2.SS2.SSS1.p1.4.m4.6.6.2.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2"><apply id="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1">superscript</csymbol><apply id="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2"><ci id="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2.1">^</ci><ci id="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.5.5.1.1.1.2.2">𝑦</ci></apply><ci id="S2.SS2.SSS1.p1.4.m4.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.1.1.1.1">𝑖</ci></apply><apply id="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2">superscript</csymbol><apply id="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2"><ci id="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2.1">^</ci><ci id="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.6.6.2.2.2.2.2">𝑟</ci></apply><ci id="S2.SS2.SSS1.p1.4.m4.2.2.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.2.2.1.1">𝑖</ci></apply></list><apply id="S2.SS2.SSS1.p1.4.m4.7.7.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.3"><times id="S2.SS2.SSS1.p1.4.m4.7.7.3.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.2"></times><ci id="S2.SS2.SSS1.p1.4.m4.7.7.3.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.3">𝜋</ci><interval closure="open" id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1"><ci id="S2.SS2.SSS1.p1.4.m4.4.4.cmml" xref="S2.SS2.SSS1.p1.4.m4.4.4">𝑦</ci><apply id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.1">conditional</csymbol><ci id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.2">𝑟</ci><apply id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3">superscript</csymbol><ci id="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3.2.cmml" xref="S2.SS2.SSS1.p1.4.m4.7.7.3.1.1.1.3.2">𝑥</ci><ci id="S2.SS2.SSS1.p1.4.m4.3.3.1.1.cmml" xref="S2.SS2.SSS1.p1.4.m4.3.3.1.1">𝑖</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.4.m4.7c">\hat{y}^{(i)},\hat{r}^{(i)}\sim\pi(y,r|x^{(i)})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.4.m4.7d">over^ start_ARG italic_y end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , over^ start_ARG italic_r end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∼ italic_π ( italic_y , italic_r | italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math> to provide CoT rationale <math alttext="\hat{r}^{(i)}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.5.m5.1"><semantics id="S2.SS2.SSS1.p1.5.m5.1a"><msup id="S2.SS2.SSS1.p1.5.m5.1.2" xref="S2.SS2.SSS1.p1.5.m5.1.2.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.5.m5.1.2.2" xref="S2.SS2.SSS1.p1.5.m5.1.2.2.cmml"><mi id="S2.SS2.SSS1.p1.5.m5.1.2.2.2" xref="S2.SS2.SSS1.p1.5.m5.1.2.2.2.cmml">r</mi><mo id="S2.SS2.SSS1.p1.5.m5.1.2.2.1" xref="S2.SS2.SSS1.p1.5.m5.1.2.2.1.cmml">^</mo></mover><mrow id="S2.SS2.SSS1.p1.5.m5.1.1.1.3" xref="S2.SS2.SSS1.p1.5.m5.1.2.cmml"><mo id="S2.SS2.SSS1.p1.5.m5.1.1.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.5.m5.1.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.5.m5.1.1.1.1" xref="S2.SS2.SSS1.p1.5.m5.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.5.m5.1.1.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.5.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.5.m5.1b"><apply id="S2.SS2.SSS1.p1.5.m5.1.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.5.m5.1.2.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.2">superscript</csymbol><apply id="S2.SS2.SSS1.p1.5.m5.1.2.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.2.2"><ci id="S2.SS2.SSS1.p1.5.m5.1.2.2.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.2.2.1">^</ci><ci id="S2.SS2.SSS1.p1.5.m5.1.2.2.2.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.2.2.2">𝑟</ci></apply><ci id="S2.SS2.SSS1.p1.5.m5.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.5.m5.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.5.m5.1c">\hat{r}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.5.m5.1d">over^ start_ARG italic_r end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> and final answer <math alttext="\hat{y}^{(i)}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.6.m6.1"><semantics id="S2.SS2.SSS1.p1.6.m6.1a"><msup id="S2.SS2.SSS1.p1.6.m6.1.2" xref="S2.SS2.SSS1.p1.6.m6.1.2.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.6.m6.1.2.2" xref="S2.SS2.SSS1.p1.6.m6.1.2.2.cmml"><mi id="S2.SS2.SSS1.p1.6.m6.1.2.2.2" xref="S2.SS2.SSS1.p1.6.m6.1.2.2.2.cmml">y</mi><mo id="S2.SS2.SSS1.p1.6.m6.1.2.2.1" xref="S2.SS2.SSS1.p1.6.m6.1.2.2.1.cmml">^</mo></mover><mrow id="S2.SS2.SSS1.p1.6.m6.1.1.1.3" xref="S2.SS2.SSS1.p1.6.m6.1.2.cmml"><mo id="S2.SS2.SSS1.p1.6.m6.1.1.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.6.m6.1.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.6.m6.1.1.1.1" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.6.m6.1.1.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.6.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.6.m6.1b"><apply id="S2.SS2.SSS1.p1.6.m6.1.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.6.m6.1.2.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.2">superscript</csymbol><apply id="S2.SS2.SSS1.p1.6.m6.1.2.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.2.2"><ci id="S2.SS2.SSS1.p1.6.m6.1.2.2.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.2.2.1">^</ci><ci id="S2.SS2.SSS1.p1.6.m6.1.2.2.2.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.2.2.2">𝑦</ci></apply><ci id="S2.SS2.SSS1.p1.6.m6.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.6.m6.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.6.m6.1c">\hat{y}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.6.m6.1d">over^ start_ARG italic_y end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>. We then filter the generated data, keeping only rationales leading to a correct final answer (i.e. <math alttext="\hat{y}^{(i)}=y^{(i)}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.7.m7.2"><semantics id="S2.SS2.SSS1.p1.7.m7.2a"><mrow id="S2.SS2.SSS1.p1.7.m7.2.3" xref="S2.SS2.SSS1.p1.7.m7.2.3.cmml"><msup id="S2.SS2.SSS1.p1.7.m7.2.3.2" xref="S2.SS2.SSS1.p1.7.m7.2.3.2.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.7.m7.2.3.2.2" xref="S2.SS2.SSS1.p1.7.m7.2.3.2.2.cmml"><mi id="S2.SS2.SSS1.p1.7.m7.2.3.2.2.2" xref="S2.SS2.SSS1.p1.7.m7.2.3.2.2.2.cmml">y</mi><mo id="S2.SS2.SSS1.p1.7.m7.2.3.2.2.1" xref="S2.SS2.SSS1.p1.7.m7.2.3.2.2.1.cmml">^</mo></mover><mrow id="S2.SS2.SSS1.p1.7.m7.1.1.1.3" xref="S2.SS2.SSS1.p1.7.m7.2.3.2.cmml"><mo id="S2.SS2.SSS1.p1.7.m7.1.1.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.7.m7.2.3.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.7.m7.1.1.1.1" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.7.m7.1.1.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.7.m7.2.3.2.cmml">)</mo></mrow></msup><mo id="S2.SS2.SSS1.p1.7.m7.2.3.1" xref="S2.SS2.SSS1.p1.7.m7.2.3.1.cmml">=</mo><msup id="S2.SS2.SSS1.p1.7.m7.2.3.3" xref="S2.SS2.SSS1.p1.7.m7.2.3.3.cmml"><mi id="S2.SS2.SSS1.p1.7.m7.2.3.3.2" xref="S2.SS2.SSS1.p1.7.m7.2.3.3.2.cmml">y</mi><mrow id="S2.SS2.SSS1.p1.7.m7.2.2.1.3" xref="S2.SS2.SSS1.p1.7.m7.2.3.3.cmml"><mo id="S2.SS2.SSS1.p1.7.m7.2.2.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.7.m7.2.3.3.cmml">(</mo><mi id="S2.SS2.SSS1.p1.7.m7.2.2.1.1" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.7.m7.2.2.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.7.m7.2.3.3.cmml">)</mo></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.7.m7.2b"><apply id="S2.SS2.SSS1.p1.7.m7.2.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.3"><eq id="S2.SS2.SSS1.p1.7.m7.2.3.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.3.1"></eq><apply id="S2.SS2.SSS1.p1.7.m7.2.3.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m7.2.3.2.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.3.2">superscript</csymbol><apply id="S2.SS2.SSS1.p1.7.m7.2.3.2.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.3.2.2"><ci id="S2.SS2.SSS1.p1.7.m7.2.3.2.2.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.3.2.2.1">^</ci><ci id="S2.SS2.SSS1.p1.7.m7.2.3.2.2.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.3.2.2.2">𝑦</ci></apply><ci id="S2.SS2.SSS1.p1.7.m7.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.1.1.1.1">𝑖</ci></apply><apply id="S2.SS2.SSS1.p1.7.m7.2.3.3.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.7.m7.2.3.3.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.3.3">superscript</csymbol><ci id="S2.SS2.SSS1.p1.7.m7.2.3.3.2.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.3.3.2">𝑦</ci><ci id="S2.SS2.SSS1.p1.7.m7.2.2.1.1.cmml" xref="S2.SS2.SSS1.p1.7.m7.2.2.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.7.m7.2c">\hat{y}^{(i)}=y^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.7.m7.2d">over^ start_ARG italic_y end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = italic_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>) to generate a dataset of questions, (bootstrapped) rationales and answers <math alttext="\mathcal{D}_{\text{STaR}}=\{x^{(i)},\hat{r}^{(i)},y^{(i)}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.8.m8.6"><semantics id="S2.SS2.SSS1.p1.8.m8.6a"><mrow id="S2.SS2.SSS1.p1.8.m8.6.6" xref="S2.SS2.SSS1.p1.8.m8.6.6.cmml"><msub id="S2.SS2.SSS1.p1.8.m8.6.6.5" xref="S2.SS2.SSS1.p1.8.m8.6.6.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.8.m8.6.6.5.2" xref="S2.SS2.SSS1.p1.8.m8.6.6.5.2.cmml">𝒟</mi><mtext id="S2.SS2.SSS1.p1.8.m8.6.6.5.3" xref="S2.SS2.SSS1.p1.8.m8.6.6.5.3a.cmml">STaR</mtext></msub><mo id="S2.SS2.SSS1.p1.8.m8.6.6.4" xref="S2.SS2.SSS1.p1.8.m8.6.6.4.cmml">=</mo><msubsup id="S2.SS2.SSS1.p1.8.m8.6.6.3" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.cmml"><mrow id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.4.cmml"><mo id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.4" stretchy="false" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.4.cmml">{</mo><msup id="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1" xref="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1.2" xref="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1.2.cmml">x</mi><mrow id="S2.SS2.SSS1.p1.8.m8.1.1.1.3" xref="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS1.p1.8.m8.1.1.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1.cmml">(</mo><mi id="S2.SS2.SSS1.p1.8.m8.1.1.1.1" xref="S2.SS2.SSS1.p1.8.m8.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.8.m8.1.1.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.5" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.4.cmml">,</mo><msup id="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.cmml"><mover accent="true" id="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2.cmml"><mi id="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2.2" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2.2.cmml">r</mi><mo id="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2.1" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S2.SS2.SSS1.p1.8.m8.2.2.1.3" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.cmml"><mo id="S2.SS2.SSS1.p1.8.m8.2.2.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.cmml">(</mo><mi id="S2.SS2.SSS1.p1.8.m8.2.2.1.1" xref="S2.SS2.SSS1.p1.8.m8.2.2.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.8.m8.2.2.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.cmml">)</mo></mrow></msup><mo id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.6" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.4.cmml">,</mo><msup id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3.cmml"><mi id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3.2" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3.2.cmml">y</mi><mrow id="S2.SS2.SSS1.p1.8.m8.3.3.1.3" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3.cmml"><mo id="S2.SS2.SSS1.p1.8.m8.3.3.1.3.1" stretchy="false" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3.cmml">(</mo><mi id="S2.SS2.SSS1.p1.8.m8.3.3.1.1" xref="S2.SS2.SSS1.p1.8.m8.3.3.1.1.cmml">i</mi><mo id="S2.SS2.SSS1.p1.8.m8.3.3.1.3.2" stretchy="false" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3.cmml">)</mo></mrow></msup><mo id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.7" stretchy="false" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.4.cmml">}</mo></mrow><mrow id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.cmml"><mi id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.2" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.2.cmml">i</mi><mo id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.1" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.1.cmml">=</mo><mn id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.3" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.3.cmml">1</mn></mrow><mi id="S2.SS2.SSS1.p1.8.m8.6.6.3.5" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.5.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.8.m8.6b"><apply id="S2.SS2.SSS1.p1.8.m8.6.6.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6"><eq id="S2.SS2.SSS1.p1.8.m8.6.6.4.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.4"></eq><apply id="S2.SS2.SSS1.p1.8.m8.6.6.5.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.5"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.8.m8.6.6.5.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.5">subscript</csymbol><ci id="S2.SS2.SSS1.p1.8.m8.6.6.5.2.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.5.2">𝒟</ci><ci id="S2.SS2.SSS1.p1.8.m8.6.6.5.3a.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.5.3"><mtext id="S2.SS2.SSS1.p1.8.m8.6.6.5.3.cmml" mathsize="70%" xref="S2.SS2.SSS1.p1.8.m8.6.6.5.3">STaR</mtext></ci></apply><apply id="S2.SS2.SSS1.p1.8.m8.6.6.3.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.8.m8.6.6.3.4.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3">superscript</csymbol><apply id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.4.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3">subscript</csymbol><set id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.4.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3"><apply id="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS1.p1.8.m8.4.4.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS2.SSS1.p1.8.m8.1.1.1.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.1.1.1.1">𝑖</ci></apply><apply id="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2">superscript</csymbol><apply id="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2"><ci id="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2.1">^</ci><ci id="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2.2.cmml" xref="S2.SS2.SSS1.p1.8.m8.5.5.2.2.2.2.2.2.2">𝑟</ci></apply><ci id="S2.SS2.SSS1.p1.8.m8.2.2.1.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.2.2.1.1">𝑖</ci></apply><apply id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3">superscript</csymbol><ci id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3.2.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.3.3.3.2">𝑦</ci><ci id="S2.SS2.SSS1.p1.8.m8.3.3.1.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.3.3.1.1">𝑖</ci></apply></set><apply id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5"><eq id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.1.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.1"></eq><ci id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.2.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.2">𝑖</ci><cn id="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.3.cmml" type="integer" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.3.5.3">1</cn></apply></apply><ci id="S2.SS2.SSS1.p1.8.m8.6.6.3.5.cmml" xref="S2.SS2.SSS1.p1.8.m8.6.6.3.5">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.8.m8.6c">\mathcal{D}_{\text{STaR}}=\{x^{(i)},\hat{r}^{(i)},y^{(i)}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.8.m8.6d">caligraphic_D start_POSTSUBSCRIPT STaR end_POSTSUBSCRIPT = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , over^ start_ARG italic_r end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>. <math alttext="\mathcal{D}_{\text{STaR}}" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.9.m9.1"><semantics id="S2.SS2.SSS1.p1.9.m9.1a"><msub id="S2.SS2.SSS1.p1.9.m9.1.1" xref="S2.SS2.SSS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.SSS1.p1.9.m9.1.1.2" xref="S2.SS2.SSS1.p1.9.m9.1.1.2.cmml">𝒟</mi><mtext id="S2.SS2.SSS1.p1.9.m9.1.1.3" xref="S2.SS2.SSS1.p1.9.m9.1.1.3a.cmml">STaR</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.9.m9.1b"><apply id="S2.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS1.p1.9.m9.1.1.1.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS2.SSS1.p1.9.m9.1.1.2.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1.2">𝒟</ci><ci id="S2.SS2.SSS1.p1.9.m9.1.1.3a.cmml" xref="S2.SS2.SSS1.p1.9.m9.1.1.3"><mtext id="S2.SS2.SSS1.p1.9.m9.1.1.3.cmml" mathsize="70%" xref="S2.SS2.SSS1.p1.9.m9.1.1.3">STaR</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.9.m9.1c">\mathcal{D}_{\text{STaR}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.9.m9.1d">caligraphic_D start_POSTSUBSCRIPT STaR end_POSTSUBSCRIPT</annotation></semantics></math> is then used to train a model with the standard supervised fine-tuning objective:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathrm{STaR}}(\pi_{\phi})=-\mathbb{E}_{(x,\hat{r},y)\sim\mathcal%
{D}_{\text{STaR}}}\left[-\log\pi_{\phi}(y,\hat{r}|x)\right]." class="ltx_Math" display="block" id="S2.E4.m1.5"><semantics id="S2.E4.m1.5a"><mrow id="S2.E4.m1.5.5.1" xref="S2.E4.m1.5.5.1.1.cmml"><mrow id="S2.E4.m1.5.5.1.1" xref="S2.E4.m1.5.5.1.1.cmml"><mrow id="S2.E4.m1.5.5.1.1.1" xref="S2.E4.m1.5.5.1.1.1.cmml"><msub id="S2.E4.m1.5.5.1.1.1.3" xref="S2.E4.m1.5.5.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.5.5.1.1.1.3.2" xref="S2.E4.m1.5.5.1.1.1.3.2.cmml">ℒ</mi><mi id="S2.E4.m1.5.5.1.1.1.3.3" xref="S2.E4.m1.5.5.1.1.1.3.3.cmml">STaR</mi></msub><mo id="S2.E4.m1.5.5.1.1.1.2" xref="S2.E4.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.5.5.1.1.1.1.1" xref="S2.E4.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E4.m1.5.5.1.1.1.1.1.1" xref="S2.E4.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.5.5.1.1.1.1.1.1.2" xref="S2.E4.m1.5.5.1.1.1.1.1.1.2.cmml">π</mi><mi id="S2.E4.m1.5.5.1.1.1.1.1.1.3" xref="S2.E4.m1.5.5.1.1.1.1.1.1.3.cmml">ϕ</mi></msub><mo id="S2.E4.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.5.5.1.1.3" xref="S2.E4.m1.5.5.1.1.3.cmml">=</mo><mrow id="S2.E4.m1.5.5.1.1.2" xref="S2.E4.m1.5.5.1.1.2.cmml"><mo id="S2.E4.m1.5.5.1.1.2a" xref="S2.E4.m1.5.5.1.1.2.cmml">−</mo><mrow id="S2.E4.m1.5.5.1.1.2.1" xref="S2.E4.m1.5.5.1.1.2.1.cmml"><msub id="S2.E4.m1.5.5.1.1.2.1.3" xref="S2.E4.m1.5.5.1.1.2.1.3.cmml"><mi id="S2.E4.m1.5.5.1.1.2.1.3.2" xref="S2.E4.m1.5.5.1.1.2.1.3.2.cmml">𝔼</mi><mrow id="S2.E4.m1.3.3.3" xref="S2.E4.m1.3.3.3.cmml"><mrow id="S2.E4.m1.3.3.3.5.2" xref="S2.E4.m1.3.3.3.5.1.cmml"><mo id="S2.E4.m1.3.3.3.5.2.1" stretchy="false" xref="S2.E4.m1.3.3.3.5.1.cmml">(</mo><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">x</mi><mo id="S2.E4.m1.3.3.3.5.2.2" xref="S2.E4.m1.3.3.3.5.1.cmml">,</mo><mover accent="true" id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml"><mi id="S2.E4.m1.2.2.2.2.2" xref="S2.E4.m1.2.2.2.2.2.cmml">r</mi><mo id="S2.E4.m1.2.2.2.2.1" xref="S2.E4.m1.2.2.2.2.1.cmml">^</mo></mover><mo id="S2.E4.m1.3.3.3.5.2.3" xref="S2.E4.m1.3.3.3.5.1.cmml">,</mo><mi id="S2.E4.m1.3.3.3.3" xref="S2.E4.m1.3.3.3.3.cmml">y</mi><mo id="S2.E4.m1.3.3.3.5.2.4" stretchy="false" xref="S2.E4.m1.3.3.3.5.1.cmml">)</mo></mrow><mo id="S2.E4.m1.3.3.3.4" xref="S2.E4.m1.3.3.3.4.cmml">∼</mo><msub id="S2.E4.m1.3.3.3.6" xref="S2.E4.m1.3.3.3.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.3.3.3.6.2" xref="S2.E4.m1.3.3.3.6.2.cmml">𝒟</mi><mtext id="S2.E4.m1.3.3.3.6.3" xref="S2.E4.m1.3.3.3.6.3a.cmml">STaR</mtext></msub></mrow></msub><mo id="S2.E4.m1.5.5.1.1.2.1.2" xref="S2.E4.m1.5.5.1.1.2.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.5.5.1.1.2.1.1.1" xref="S2.E4.m1.5.5.1.1.2.1.1.2.cmml"><mo id="S2.E4.m1.5.5.1.1.2.1.1.1.2" xref="S2.E4.m1.5.5.1.1.2.1.1.2.1.cmml">[</mo><mrow id="S2.E4.m1.5.5.1.1.2.1.1.1.1" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.cmml"><mo id="S2.E4.m1.5.5.1.1.2.1.1.1.1a" rspace="0.167em" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.cmml">−</mo><mrow id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.cmml"><mi id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.1" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.cmml"><mi id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.2" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.2.cmml">π</mi><mi id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.3" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.2" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml"><mo id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E4.m1.4.4" xref="S2.E4.m1.4.4.cmml">y</mi><mo id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.cmml">r</mi><mo id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.1" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo fence="false" id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.4" stretchy="false" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.5.5.1.1.2.1.1.1.3" xref="S2.E4.m1.5.5.1.1.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S2.E4.m1.5.5.1.2" lspace="0em" xref="S2.E4.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.5b"><apply id="S2.E4.m1.5.5.1.1.cmml" xref="S2.E4.m1.5.5.1"><eq id="S2.E4.m1.5.5.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.3"></eq><apply id="S2.E4.m1.5.5.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1"><times id="S2.E4.m1.5.5.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.1.2"></times><apply id="S2.E4.m1.5.5.1.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.3.1.cmml" xref="S2.E4.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.1.3.2.cmml" xref="S2.E4.m1.5.5.1.1.1.3.2">ℒ</ci><ci id="S2.E4.m1.5.5.1.1.1.3.3.cmml" xref="S2.E4.m1.5.5.1.1.1.3.3">STaR</ci></apply><apply id="S2.E4.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.1.2">𝜋</ci><ci id="S2.E4.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.1.1.1.1.3">italic-ϕ</ci></apply></apply><apply id="S2.E4.m1.5.5.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.2"><minus id="S2.E4.m1.5.5.1.1.2.2.cmml" xref="S2.E4.m1.5.5.1.1.2"></minus><apply id="S2.E4.m1.5.5.1.1.2.1.cmml" xref="S2.E4.m1.5.5.1.1.2.1"><times id="S2.E4.m1.5.5.1.1.2.1.2.cmml" xref="S2.E4.m1.5.5.1.1.2.1.2"></times><apply id="S2.E4.m1.5.5.1.1.2.1.3.cmml" xref="S2.E4.m1.5.5.1.1.2.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.2.1.3.1.cmml" xref="S2.E4.m1.5.5.1.1.2.1.3">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.2.1.3.2.cmml" xref="S2.E4.m1.5.5.1.1.2.1.3.2">𝔼</ci><apply id="S2.E4.m1.3.3.3.cmml" xref="S2.E4.m1.3.3.3"><csymbol cd="latexml" id="S2.E4.m1.3.3.3.4.cmml" xref="S2.E4.m1.3.3.3.4">similar-to</csymbol><vector id="S2.E4.m1.3.3.3.5.1.cmml" xref="S2.E4.m1.3.3.3.5.2"><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝑥</ci><apply id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2"><ci id="S2.E4.m1.2.2.2.2.1.cmml" xref="S2.E4.m1.2.2.2.2.1">^</ci><ci id="S2.E4.m1.2.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2.2">𝑟</ci></apply><ci id="S2.E4.m1.3.3.3.3.cmml" xref="S2.E4.m1.3.3.3.3">𝑦</ci></vector><apply id="S2.E4.m1.3.3.3.6.cmml" xref="S2.E4.m1.3.3.3.6"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.3.6.1.cmml" xref="S2.E4.m1.3.3.3.6">subscript</csymbol><ci id="S2.E4.m1.3.3.3.6.2.cmml" xref="S2.E4.m1.3.3.3.6.2">𝒟</ci><ci id="S2.E4.m1.3.3.3.6.3a.cmml" xref="S2.E4.m1.3.3.3.6.3"><mtext id="S2.E4.m1.3.3.3.6.3.cmml" mathsize="50%" xref="S2.E4.m1.3.3.3.6.3">STaR</mtext></ci></apply></apply></apply><apply id="S2.E4.m1.5.5.1.1.2.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.5.5.1.1.2.1.1.2.1.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E4.m1.5.5.1.1.2.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1"><minus id="S2.E4.m1.5.5.1.1.2.1.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1"></minus><apply id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1"><times id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.2"></times><apply id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3"><log id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.1"></log><apply id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.1.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.2">𝜋</ci><ci id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.3.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><interval closure="open" id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1"><ci id="S2.E4.m1.4.4.cmml" xref="S2.E4.m1.4.4">𝑦</ci><apply id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2"><ci id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.2.2">𝑟</ci></apply><ci id="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.5.5.1.1.2.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.5c">\mathcal{L}_{\mathrm{STaR}}(\pi_{\phi})=-\mathbb{E}_{(x,\hat{r},y)\sim\mathcal%
{D}_{\text{STaR}}}\left[-\log\pi_{\phi}(y,\hat{r}|x)\right].</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.5d">caligraphic_L start_POSTSUBSCRIPT roman_STaR end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ) = - blackboard_E start_POSTSUBSCRIPT ( italic_x , over^ start_ARG italic_r end_ARG , italic_y ) ∼ caligraphic_D start_POSTSUBSCRIPT STaR end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ - roman_log italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y , over^ start_ARG italic_r end_ARG | italic_x ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS1.p2">
<p class="ltx_p" id="S2.SS2.SSS1.p2.1">The above procedure is repeated over several iterations and has since been adopted in various related works <cite class="ltx_cite ltx_citemacro_citep">(e.g., Hosseini et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib21" title="">2024</a>; Andukuri et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib4" title="">2024</a>; Fränken et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib17" title="">2024</a>; Zelikman et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib50" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2 </span>Post-Rationalization</h4>
<div class="ltx_para ltx_noindent" id="S2.SS2.SSS2.p1">
<p class="ltx_p" id="S2.SS2.SSS2.p1.3">One limitation of bootstrapping rationale generation is that the model cannot improve on examples it initially fails to solve. To address this issue, STaR introduces <span class="ltx_text ltx_font_italic" id="S2.SS2.SSS2.p1.3.1">rationalization</span>, a backward reasoning process. For prompts where the model generates an incorrect rationale and answer, the correct answer is provided to the model as a hint. The model then generates a new rationale based on the correct answer, reasoning backward to generate a “post-rationale”. In technical terms there is a rationalization model <math alttext="q" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.1.m1.1"><semantics id="S2.SS2.SSS2.p1.1.m1.1a"><mi id="S2.SS2.SSS2.p1.1.m1.1.1" xref="S2.SS2.SSS2.p1.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.1.m1.1b"><ci id="S2.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS2.p1.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.1.m1.1d">italic_q</annotation></semantics></math> which generates rationales <math alttext="\hat{r}^{(i)}\sim q(r|x^{(i)},y^{(i)})" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.2.m2.4"><semantics id="S2.SS2.SSS2.p1.2.m2.4a"><mrow id="S2.SS2.SSS2.p1.2.m2.4.4" xref="S2.SS2.SSS2.p1.2.m2.4.4.cmml"><msup id="S2.SS2.SSS2.p1.2.m2.4.4.3" xref="S2.SS2.SSS2.p1.2.m2.4.4.3.cmml"><mover accent="true" id="S2.SS2.SSS2.p1.2.m2.4.4.3.2" xref="S2.SS2.SSS2.p1.2.m2.4.4.3.2.cmml"><mi id="S2.SS2.SSS2.p1.2.m2.4.4.3.2.2" xref="S2.SS2.SSS2.p1.2.m2.4.4.3.2.2.cmml">r</mi><mo id="S2.SS2.SSS2.p1.2.m2.4.4.3.2.1" xref="S2.SS2.SSS2.p1.2.m2.4.4.3.2.1.cmml">^</mo></mover><mrow id="S2.SS2.SSS2.p1.2.m2.1.1.1.3" xref="S2.SS2.SSS2.p1.2.m2.4.4.3.cmml"><mo id="S2.SS2.SSS2.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S2.SS2.SSS2.p1.2.m2.4.4.3.cmml">(</mo><mi id="S2.SS2.SSS2.p1.2.m2.1.1.1.1" xref="S2.SS2.SSS2.p1.2.m2.1.1.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S2.SS2.SSS2.p1.2.m2.4.4.3.cmml">)</mo></mrow></msup><mo id="S2.SS2.SSS2.p1.2.m2.4.4.2" xref="S2.SS2.SSS2.p1.2.m2.4.4.2.cmml">∼</mo><mrow id="S2.SS2.SSS2.p1.2.m2.4.4.1" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.cmml"><mi id="S2.SS2.SSS2.p1.2.m2.4.4.1.3" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.3.cmml">q</mi><mo id="S2.SS2.SSS2.p1.2.m2.4.4.1.2" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.2.cmml">⁢</mo><mrow id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.cmml"><mo id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.2" stretchy="false" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.cmml">(</mo><mrow id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.cmml"><mi id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.4" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.4.cmml">r</mi><mo fence="false" id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.3" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.3.cmml">|</mo><mrow id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.3.cmml"><msup id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1.cmml"><mi id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1.2" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S2.SS2.SSS2.p1.2.m2.2.2.1.3" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1.cmml"><mo id="S2.SS2.SSS2.p1.2.m2.2.2.1.3.1" stretchy="false" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.SS2.SSS2.p1.2.m2.2.2.1.1" xref="S2.SS2.SSS2.p1.2.m2.2.2.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p1.2.m2.2.2.1.3.2" stretchy="false" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.3" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.3.cmml">,</mo><msup id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2.cmml"><mi id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2.2" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2.2.cmml">y</mi><mrow id="S2.SS2.SSS2.p1.2.m2.3.3.1.3" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2.cmml"><mo id="S2.SS2.SSS2.p1.2.m2.3.3.1.3.1" stretchy="false" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2.cmml">(</mo><mi id="S2.SS2.SSS2.p1.2.m2.3.3.1.1" xref="S2.SS2.SSS2.p1.2.m2.3.3.1.1.cmml">i</mi><mo id="S2.SS2.SSS2.p1.2.m2.3.3.1.3.2" stretchy="false" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2.cmml">)</mo></mrow></msup></mrow></mrow><mo id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.3" stretchy="false" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.2.m2.4b"><apply id="S2.SS2.SSS2.p1.2.m2.4.4.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4"><csymbol cd="latexml" id="S2.SS2.SSS2.p1.2.m2.4.4.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.2">similar-to</csymbol><apply id="S2.SS2.SSS2.p1.2.m2.4.4.3.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.3"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.2.m2.4.4.3.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.3">superscript</csymbol><apply id="S2.SS2.SSS2.p1.2.m2.4.4.3.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.3.2"><ci id="S2.SS2.SSS2.p1.2.m2.4.4.3.2.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.3.2.1">^</ci><ci id="S2.SS2.SSS2.p1.2.m2.4.4.3.2.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.3.2.2">𝑟</ci></apply><ci id="S2.SS2.SSS2.p1.2.m2.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.1.1.1.1">𝑖</ci></apply><apply id="S2.SS2.SSS2.p1.2.m2.4.4.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1"><times id="S2.SS2.SSS2.p1.2.m2.4.4.1.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.2"></times><ci id="S2.SS2.SSS2.p1.2.m2.4.4.1.3.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.3">𝑞</ci><apply id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1"><csymbol cd="latexml" id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.3.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.3">conditional</csymbol><ci id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.4.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.4">𝑟</ci><list id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.3.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2"><apply id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.SS2.SSS2.p1.2.m2.2.2.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.2.2.1.1">𝑖</ci></apply><apply id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2">superscript</csymbol><ci id="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2.2.cmml" xref="S2.SS2.SSS2.p1.2.m2.4.4.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S2.SS2.SSS2.p1.2.m2.3.3.1.1.cmml" xref="S2.SS2.SSS2.p1.2.m2.3.3.1.1">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.2.m2.4c">\hat{r}^{(i)}\sim q(r|x^{(i)},y^{(i)})</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.2.m2.4d">over^ start_ARG italic_r end_ARG start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ∼ italic_q ( italic_r | italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math> to justify the final answer. This synthetic data is in turn used in the STaR objective in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.E4" title="In 2.2.1 Rationale Generation Bootstrapping ‣ 2.2 Self-Taught Reasoner ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">4</span></a>. We will also use this approach to evaluate the effect of the quality of the bootstrapped reasoning chains, using samples from rationalization models <math alttext="q" class="ltx_Math" display="inline" id="S2.SS2.SSS2.p1.3.m3.1"><semantics id="S2.SS2.SSS2.p1.3.m3.1a"><mi id="S2.SS2.SSS2.p1.3.m3.1.1" xref="S2.SS2.SSS2.p1.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS2.p1.3.m3.1b"><ci id="S2.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS2.p1.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS2.p1.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS2.p1.3.m3.1d">italic_q</annotation></semantics></math> with different capabilities.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>RLAIF and LLM-As-A-Judge</h3>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Reinforcement Learning from AI Feedback (RLAIF) presents an alternative approach to the standard RLHF pipeline. <cite class="ltx_cite ltx_citemacro_citet">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib9" title="">2022b</a>)</cite> demonstrate the efficacy of RLAIF in training helpful and harmless models without relying on human feedback labels for harmlessness assessment. Their work shows that as language model capabilities improve, AI identification of harms increases significantly, particularly when leveraging chain-of-thought reasoning.
Notably, they demonstrate that utilizing self-supervised preference labels for reinforcement learning can yield improvements in model behavior that are competitive with or surpass those achieved using human feedback for harmlessness evaluation. <cite class="ltx_cite ltx_citemacro_citet">Zheng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib53" title="">2023a</a>)</cite> introduce the LLM-as-a-Judge method, further extending the RLAIF paradigm. They demonstrate that strong language models, even without explicit training for evaluation tasks, can provide judgments that exhibit agreement with human preferences. Their study finds that LLMs can achieve over 80% agreement with human preferences, a level comparable to inter-expert agreement. This finding establishes a foundation for developing LLM-based evaluation frameworks.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Connections Between RLHF and Preference Modelling</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.2">We begin by pointing out a theoretical connection between the RLHF post-training approach outlined in the previous section and general preference modeling.
One of the key observations of the DPO approach <cite class="ltx_cite ltx_citemacro_citep">(Rafailov et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib31" title="">2023</a>)</cite> is that the reward modeling objective in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.E1" title="In 2.1.2 Bradley-Terry Reward Modeling ‣ 2.1 Reinforcement Learning from Human Feedback ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">1</span></a> is under-constrained, which can create significant optimization challenges for the RL problem in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.E3" title="In 2.1.3 Reinforcement Learning (RL) ‣ 2.1 Reinforcement Learning from Human Feedback ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">3</span></a> <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib42" title="">2023</a>; Ahmadian et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib1" title="">2024</a>)</cite> (in fact, theoretically, it can have arbitrarily low signal-to-noise ratio). To alleviate this issue, prior works <cite class="ltx_cite ltx_citemacro_citep">(Stiennon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib36" title="">2022</a>; Ouyang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib29" title="">2022</a>)</cite> use a baseline reward from on a fixed reference distribution:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\pi_{\theta}}\mathbb{E}_{x\sim\mathcal{D},y\sim\pi_{\phi}(.\mid x)}\Bigl%
{[}\left[r_{\phi}(x,y)-r_{\phi}(x,y_{\text{ref}})\right]-\beta\mathbb{D}_{%
\textrm{KL}}\left[\pi_{\theta}(y\mid x)\parallel\pi_{\text{ref}}(y\mid x)%
\right]\Bigr{]}." class="ltx_math_unparsed" display="block" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3b"><munder id="S3.E5.m1.3.4"><mi id="S3.E5.m1.3.4.2">max</mi><msub id="S3.E5.m1.3.4.3"><mi id="S3.E5.m1.3.4.3.2">π</mi><mi id="S3.E5.m1.3.4.3.3">θ</mi></msub></munder><msub id="S3.E5.m1.3.5"><mi id="S3.E5.m1.3.5.2">𝔼</mi><mrow id="S3.E5.m1.3.5.3"><mi id="S3.E5.m1.3.5.3.1">x</mi><mo id="S3.E5.m1.3.5.3.2">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.5.3.3">𝒟</mi><mo id="S3.E5.m1.3.5.3.4">,</mo><mi id="S3.E5.m1.3.5.3.5">y</mi><mo id="S3.E5.m1.3.5.3.6">∼</mo><msub id="S3.E5.m1.3.5.3.7"><mi id="S3.E5.m1.3.5.3.7.2">π</mi><mi id="S3.E5.m1.3.5.3.7.3">ϕ</mi></msub><mrow id="S3.E5.m1.3.5.3.8"><mo id="S3.E5.m1.3.5.3.8.1" stretchy="false">(</mo><mo id="S3.E5.m1.3.5.3.8.2" lspace="0em" rspace="0.0835em">.</mo><mo id="S3.E5.m1.3.5.3.8.3" lspace="0.0835em" rspace="0.167em">∣</mo><mi id="S3.E5.m1.3.5.3.8.4">x</mi><mo id="S3.E5.m1.3.5.3.8.5" stretchy="false">)</mo></mrow></mrow></msub><mrow id="S3.E5.m1.3.6"><mo id="S3.E5.m1.3.6.1" maxsize="160%" minsize="160%">[</mo><mrow id="S3.E5.m1.3.6.2"><mo id="S3.E5.m1.3.6.2.1">[</mo><msub id="S3.E5.m1.3.6.2.2"><mi id="S3.E5.m1.3.6.2.2.2">r</mi><mi id="S3.E5.m1.3.6.2.2.3">ϕ</mi></msub><mrow id="S3.E5.m1.3.6.2.3"><mo id="S3.E5.m1.3.6.2.3.1" stretchy="false">(</mo><mi id="S3.E5.m1.1.1">x</mi><mo id="S3.E5.m1.3.6.2.3.2">,</mo><mi id="S3.E5.m1.2.2">y</mi><mo id="S3.E5.m1.3.6.2.3.3" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.3.6.2.4">−</mo><msub id="S3.E5.m1.3.6.2.5"><mi id="S3.E5.m1.3.6.2.5.2">r</mi><mi id="S3.E5.m1.3.6.2.5.3">ϕ</mi></msub><mrow id="S3.E5.m1.3.6.2.6"><mo id="S3.E5.m1.3.6.2.6.1" stretchy="false">(</mo><mi id="S3.E5.m1.3.3">x</mi><mo id="S3.E5.m1.3.6.2.6.2">,</mo><msub id="S3.E5.m1.3.6.2.6.3"><mi id="S3.E5.m1.3.6.2.6.3.2">y</mi><mtext id="S3.E5.m1.3.6.2.6.3.3">ref</mtext></msub><mo id="S3.E5.m1.3.6.2.6.4" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.3.6.2.7">]</mo></mrow><mo id="S3.E5.m1.3.6.3">−</mo><mi id="S3.E5.m1.3.6.4">β</mi><msub id="S3.E5.m1.3.6.5"><mi id="S3.E5.m1.3.6.5.2">𝔻</mi><mtext id="S3.E5.m1.3.6.5.3">KL</mtext></msub><mrow id="S3.E5.m1.3.6.6"><mo id="S3.E5.m1.3.6.6.1">[</mo><msub id="S3.E5.m1.3.6.6.2"><mi id="S3.E5.m1.3.6.6.2.2">π</mi><mi id="S3.E5.m1.3.6.6.2.3">θ</mi></msub><mrow id="S3.E5.m1.3.6.6.3"><mo id="S3.E5.m1.3.6.6.3.1" stretchy="false">(</mo><mi id="S3.E5.m1.3.6.6.3.2">y</mi><mo id="S3.E5.m1.3.6.6.3.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S3.E5.m1.3.6.6.3.4">x</mi><mo id="S3.E5.m1.3.6.6.3.5" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.3.6.6.4" lspace="0em" rspace="0.167em">∥</mo><msub id="S3.E5.m1.3.6.6.5"><mi id="S3.E5.m1.3.6.6.5.2">π</mi><mtext id="S3.E5.m1.3.6.6.5.3">ref</mtext></msub><mrow id="S3.E5.m1.3.6.6.6"><mo id="S3.E5.m1.3.6.6.6.1" stretchy="false">(</mo><mi id="S3.E5.m1.3.6.6.6.2">y</mi><mo id="S3.E5.m1.3.6.6.6.3" lspace="0em" rspace="0.167em">∣</mo><mi id="S3.E5.m1.3.6.6.6.4">x</mi><mo id="S3.E5.m1.3.6.6.6.5" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.3.6.6.7">]</mo></mrow><mo id="S3.E5.m1.3.6.7" maxsize="160%" minsize="160%">]</mo></mrow><mo id="S3.E5.m1.3.7" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\max_{\pi_{\theta}}\mathbb{E}_{x\sim\mathcal{D},y\sim\pi_{\phi}(.\mid x)}\Bigl%
{[}\left[r_{\phi}(x,y)-r_{\phi}(x,y_{\text{ref}})\right]-\beta\mathbb{D}_{%
\textrm{KL}}\left[\pi_{\theta}(y\mid x)\parallel\pi_{\text{ref}}(y\mid x)%
\right]\Bigr{]}.</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">roman_max start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT blackboard_E start_POSTSUBSCRIPT italic_x ∼ caligraphic_D , italic_y ∼ italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( . ∣ italic_x ) end_POSTSUBSCRIPT [ [ italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y ) - italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ) ] - italic_β blackboard_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT [ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) ∥ italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y ∣ italic_x ) ] ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.1">Here the reference <math alttext="y_{\text{ref}}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><msub id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.2" xref="S3.p1.1.m1.1.1.2.cmml">y</mi><mtext id="S3.p1.1.m1.1.1.3" xref="S3.p1.1.m1.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.p1.1.m1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.2">𝑦</ci><ci id="S3.p1.1.m1.1.1.3a.cmml" xref="S3.p1.1.m1.1.1.3"><mtext id="S3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.p1.1.m1.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">y_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_y start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> is a human completion from an SFT dataset or a sample from the base SFT model. However, notice that by inverting Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.E1" title="In 2.1.2 Bradley-Terry Reward Modeling ‣ 2.1 Reinforcement Learning from Human Feedback ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">1</span></a> we have:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{\phi}(x,y)-r_{\phi}(x,y_{\text{ref}})=\log\left(\frac{p_{\text{BT}}(y\succ y%
_{\text{ref}}|x)}{1-p_{\text{BT}}(y\succ y_{\text{ref}}|x)}\right)." class="ltx_Math" display="block" id="S3.E6.m1.7"><semantics id="S3.E6.m1.7a"><mrow id="S3.E6.m1.7.7.1" xref="S3.E6.m1.7.7.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1" xref="S3.E6.m1.7.7.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1.1" xref="S3.E6.m1.7.7.1.1.1.cmml"><mrow id="S3.E6.m1.7.7.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.3.cmml"><msub id="S3.E6.m1.7.7.1.1.1.3.2" xref="S3.E6.m1.7.7.1.1.1.3.2.cmml"><mi id="S3.E6.m1.7.7.1.1.1.3.2.2" xref="S3.E6.m1.7.7.1.1.1.3.2.2.cmml">r</mi><mi id="S3.E6.m1.7.7.1.1.1.3.2.3" xref="S3.E6.m1.7.7.1.1.1.3.2.3.cmml">ϕ</mi></msub><mo id="S3.E6.m1.7.7.1.1.1.3.1" xref="S3.E6.m1.7.7.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.1.1.1.3.3.2" xref="S3.E6.m1.7.7.1.1.1.3.3.1.cmml"><mo id="S3.E6.m1.7.7.1.1.1.3.3.2.1" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">x</mi><mo id="S3.E6.m1.7.7.1.1.1.3.3.2.2" xref="S3.E6.m1.7.7.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">y</mi><mo id="S3.E6.m1.7.7.1.1.1.3.3.2.3" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.7.7.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.7.7.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.cmml"><msub id="S3.E6.m1.7.7.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.3.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.3.2" xref="S3.E6.m1.7.7.1.1.1.1.3.2.cmml">r</mi><mi id="S3.E6.m1.7.7.1.1.1.1.3.3" xref="S3.E6.m1.7.7.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.E6.m1.7.7.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.7.7.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml">x</mi><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E6.m1.7.7.1.1.1.1.1.1.1" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.2.cmml">y</mi><mtext id="S3.E6.m1.7.7.1.1.1.1.1.1.1.3" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.3a.cmml">ref</mtext></msub><mo id="S3.E6.m1.7.7.1.1.1.1.1.1.4" stretchy="false" xref="S3.E6.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.7.7.1.1.2" xref="S3.E6.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.7.7.1.1.3.2" xref="S3.E6.m1.7.7.1.1.3.1.cmml"><mi id="S3.E6.m1.6.6" xref="S3.E6.m1.6.6.cmml">log</mi><mo id="S3.E6.m1.7.7.1.1.3.2a" xref="S3.E6.m1.7.7.1.1.3.1.cmml">⁡</mo><mrow id="S3.E6.m1.7.7.1.1.3.2.1" xref="S3.E6.m1.7.7.1.1.3.1.cmml"><mo id="S3.E6.m1.7.7.1.1.3.2.1.1" xref="S3.E6.m1.7.7.1.1.3.1.cmml">(</mo><mfrac id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.3.2.cmml">p</mi><mtext id="S3.E6.m1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.3.3a.cmml">BT</mtext></msub><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">≻</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mtext id="S3.E6.m1.1.1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.1.1.3.2.3a.cmml">ref</mtext></msub><mo fence="false" id="S3.E6.m1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.E6.m1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><mn id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">1</mn><mo id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">−</mo><mrow id="S3.E6.m1.2.2.2.1" xref="S3.E6.m1.2.2.2.1.cmml"><msub id="S3.E6.m1.2.2.2.1.3" xref="S3.E6.m1.2.2.2.1.3.cmml"><mi id="S3.E6.m1.2.2.2.1.3.2" xref="S3.E6.m1.2.2.2.1.3.2.cmml">p</mi><mtext id="S3.E6.m1.2.2.2.1.3.3" xref="S3.E6.m1.2.2.2.1.3.3a.cmml">BT</mtext></msub><mo id="S3.E6.m1.2.2.2.1.2" xref="S3.E6.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.2.2.2.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.cmml"><mo id="S3.E6.m1.2.2.2.1.1.1.2" stretchy="false" xref="S3.E6.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.2.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.cmml"><mi id="S3.E6.m1.2.2.2.1.1.1.1.2" xref="S3.E6.m1.2.2.2.1.1.1.1.2.cmml">y</mi><mo id="S3.E6.m1.2.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.1.cmml">≻</mo><mrow id="S3.E6.m1.2.2.2.1.1.1.1.3" xref="S3.E6.m1.2.2.2.1.1.1.1.3.cmml"><msub id="S3.E6.m1.2.2.2.1.1.1.1.3.2" xref="S3.E6.m1.2.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.2.2.2.1.1.1.1.3.2.2" xref="S3.E6.m1.2.2.2.1.1.1.1.3.2.2.cmml">y</mi><mtext id="S3.E6.m1.2.2.2.1.1.1.1.3.2.3" xref="S3.E6.m1.2.2.2.1.1.1.1.3.2.3a.cmml">ref</mtext></msub><mo fence="false" id="S3.E6.m1.2.2.2.1.1.1.1.3.1" xref="S3.E6.m1.2.2.2.1.1.1.1.3.1.cmml">|</mo><mi id="S3.E6.m1.2.2.2.1.1.1.1.3.3" xref="S3.E6.m1.2.2.2.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S3.E6.m1.2.2.2.1.1.1.3" stretchy="false" xref="S3.E6.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac><mo id="S3.E6.m1.7.7.1.1.3.2.1.2" xref="S3.E6.m1.7.7.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.7.7.1.2" lspace="0em" xref="S3.E6.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.7b"><apply id="S3.E6.m1.7.7.1.1.cmml" xref="S3.E6.m1.7.7.1"><eq id="S3.E6.m1.7.7.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.2"></eq><apply id="S3.E6.m1.7.7.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1"><minus id="S3.E6.m1.7.7.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.2"></minus><apply id="S3.E6.m1.7.7.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.3"><times id="S3.E6.m1.7.7.1.1.1.3.1.cmml" xref="S3.E6.m1.7.7.1.1.1.3.1"></times><apply id="S3.E6.m1.7.7.1.1.1.3.2.cmml" xref="S3.E6.m1.7.7.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.3.2.1.cmml" xref="S3.E6.m1.7.7.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.3.2.2.cmml" xref="S3.E6.m1.7.7.1.1.1.3.2.2">𝑟</ci><ci id="S3.E6.m1.7.7.1.1.1.3.2.3.cmml" xref="S3.E6.m1.7.7.1.1.1.3.2.3">italic-ϕ</ci></apply><interval closure="open" id="S3.E6.m1.7.7.1.1.1.3.3.1.cmml" xref="S3.E6.m1.7.7.1.1.1.3.3.2"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝑥</ci><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝑦</ci></interval></apply><apply id="S3.E6.m1.7.7.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1"><times id="S3.E6.m1.7.7.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.2"></times><apply id="S3.E6.m1.7.7.1.1.1.1.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.3.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.3.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.3.2">𝑟</ci><ci id="S3.E6.m1.7.7.1.1.1.1.3.3.cmml" xref="S3.E6.m1.7.7.1.1.1.1.3.3">italic-ϕ</ci></apply><interval closure="open" id="S3.E6.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1"><ci id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5">𝑥</ci><apply id="S3.E6.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E6.m1.7.7.1.1.1.1.1.1.1.3a.cmml" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.3"><mtext id="S3.E6.m1.7.7.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E6.m1.7.7.1.1.1.1.1.1.1.3">ref</mtext></ci></apply></interval></apply></apply><apply id="S3.E6.m1.7.7.1.1.3.1.cmml" xref="S3.E6.m1.7.7.1.1.3.2"><log id="S3.E6.m1.6.6.cmml" xref="S3.E6.m1.6.6"></log><apply id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2"><divide id="S3.E6.m1.2.2.3.cmml" xref="S3.E6.m1.2.2"></divide><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><times id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.3.2">𝑝</ci><ci id="S3.E6.m1.1.1.1.3.3a.cmml" xref="S3.E6.m1.1.1.1.3.3"><mtext id="S3.E6.m1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.3.3">BT</mtext></ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1">succeeds</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">𝑦</ci><apply id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.1">conditional</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.E6.m1.1.1.1.1.1.1.3.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2.3"><mtext id="S3.E6.m1.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.1.1.3.2.3">ref</mtext></ci></apply><ci id="S3.E6.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><minus id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2"></minus><cn id="S3.E6.m1.2.2.2.3.cmml" type="integer" xref="S3.E6.m1.2.2.2.3">1</cn><apply id="S3.E6.m1.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.1"><times id="S3.E6.m1.2.2.2.1.2.cmml" xref="S3.E6.m1.2.2.2.1.2"></times><apply id="S3.E6.m1.2.2.2.1.3.cmml" xref="S3.E6.m1.2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.1.3.1.cmml" xref="S3.E6.m1.2.2.2.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.2.1.3.2.cmml" xref="S3.E6.m1.2.2.2.1.3.2">𝑝</ci><ci id="S3.E6.m1.2.2.2.1.3.3a.cmml" xref="S3.E6.m1.2.2.2.1.3.3"><mtext id="S3.E6.m1.2.2.2.1.3.3.cmml" mathsize="70%" xref="S3.E6.m1.2.2.2.1.3.3">BT</mtext></ci></apply><apply id="S3.E6.m1.2.2.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1">succeeds</csymbol><ci id="S3.E6.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.2">𝑦</ci><apply id="S3.E6.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.3"><csymbol cd="latexml" id="S3.E6.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.3.1">conditional</csymbol><apply id="S3.E6.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.2.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.E6.m1.2.2.2.1.1.1.1.3.2.3a.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.3.2.3"><mtext id="S3.E6.m1.2.2.2.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E6.m1.2.2.2.1.1.1.1.3.2.3">ref</mtext></ci></apply><ci id="S3.E6.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.7c">r_{\phi}(x,y)-r_{\phi}(x,y_{\text{ref}})=\log\left(\frac{p_{\text{BT}}(y\succ y%
_{\text{ref}}|x)}{1-p_{\text{BT}}(y\succ y_{\text{ref}}|x)}\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.7d">italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y ) - italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ) = roman_log ( divide start_ARG italic_p start_POSTSUBSCRIPT BT end_POSTSUBSCRIPT ( italic_y ≻ italic_y start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG 1 - italic_p start_POSTSUBSCRIPT BT end_POSTSUBSCRIPT ( italic_y ≻ italic_y start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT | italic_x ) end_ARG ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.3">That is, under the Bradley-Terry formulation the standard RLHF optimization procedure is actually optimizing a preference likelihood objective.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.2">The <span class="ltx_text ltx_font_bold" id="S3.p2.2.1">core contribution</span> of our work is that we replace the Bradley-Terry reward modelling approach with a strictly more general preference modelling objective <math alttext="p(y_{w}\succ y_{l}|x)" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">p</mi><mo id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.p2.1.m1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p2.1.m1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.cmml"><msub id="S3.p2.1.m1.1.1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.p2.1.m1.1.1.1.1.1.2.2" xref="S3.p2.1.m1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.p2.1.m1.1.1.1.1.1.2.3" xref="S3.p2.1.m1.1.1.1.1.1.2.3.cmml">w</mi></msub><mo id="S3.p2.1.m1.1.1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.1.1.cmml">≻</mo><mrow id="S3.p2.1.m1.1.1.1.1.1.3" xref="S3.p2.1.m1.1.1.1.1.1.3.cmml"><msub id="S3.p2.1.m1.1.1.1.1.1.3.2" xref="S3.p2.1.m1.1.1.1.1.1.3.2.cmml"><mi id="S3.p2.1.m1.1.1.1.1.1.3.2.2" xref="S3.p2.1.m1.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="S3.p2.1.m1.1.1.1.1.1.3.2.3" xref="S3.p2.1.m1.1.1.1.1.1.3.2.3.cmml">l</mi></msub><mo fence="false" id="S3.p2.1.m1.1.1.1.1.1.3.1" xref="S3.p2.1.m1.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.p2.1.m1.1.1.1.1.1.3.3" xref="S3.p2.1.m1.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S3.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><times id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2"></times><ci id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3">𝑝</ci><apply id="S3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.1">succeeds</csymbol><apply id="S3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p2.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.p2.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.2.3">𝑤</ci></apply><apply id="S3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3.1">conditional</csymbol><apply id="S3.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.1.1.1.3.2.1.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.p2.1.m1.1.1.1.1.1.3.2.2.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.p2.1.m1.1.1.1.1.1.3.2.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S3.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.p2.1.m1.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">p(y_{w}\succ y_{l}|x)</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_p ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math> that does not assume a point-wise reward estimate, a special model architecture, or a specific preference distribution parameterization as in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.E1" title="In 2.1.2 Bradley-Terry Reward Modeling ‣ 2.1 Reinforcement Learning from Human Feedback ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">1</span></a>. That is, we assume a standard preference dataset and model the preference distribution <math alttext="p_{\phi}(y_{w}\succ y_{l}|x)" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><msub id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml"><mi id="S3.p2.2.m2.1.1.3.2" xref="S3.p2.2.m2.1.1.3.2.cmml">p</mi><mi id="S3.p2.2.m2.1.1.3.3" xref="S3.p2.2.m2.1.1.3.3.cmml">ϕ</mi></msub><mo id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.p2.2.m2.1.1.1.1" xref="S3.p2.2.m2.1.1.1.1.1.cmml"><mo id="S3.p2.2.m2.1.1.1.1.2" stretchy="false" xref="S3.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.p2.2.m2.1.1.1.1.1" xref="S3.p2.2.m2.1.1.1.1.1.cmml"><msub id="S3.p2.2.m2.1.1.1.1.1.2" xref="S3.p2.2.m2.1.1.1.1.1.2.cmml"><mi id="S3.p2.2.m2.1.1.1.1.1.2.2" xref="S3.p2.2.m2.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.p2.2.m2.1.1.1.1.1.2.3" xref="S3.p2.2.m2.1.1.1.1.1.2.3.cmml">w</mi></msub><mo id="S3.p2.2.m2.1.1.1.1.1.1" xref="S3.p2.2.m2.1.1.1.1.1.1.cmml">≻</mo><mrow id="S3.p2.2.m2.1.1.1.1.1.3" xref="S3.p2.2.m2.1.1.1.1.1.3.cmml"><msub id="S3.p2.2.m2.1.1.1.1.1.3.2" xref="S3.p2.2.m2.1.1.1.1.1.3.2.cmml"><mi id="S3.p2.2.m2.1.1.1.1.1.3.2.2" xref="S3.p2.2.m2.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="S3.p2.2.m2.1.1.1.1.1.3.2.3" xref="S3.p2.2.m2.1.1.1.1.1.3.2.3.cmml">l</mi></msub><mo fence="false" id="S3.p2.2.m2.1.1.1.1.1.3.1" xref="S3.p2.2.m2.1.1.1.1.1.3.1.cmml">|</mo><mi id="S3.p2.2.m2.1.1.1.1.1.3.3" xref="S3.p2.2.m2.1.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S3.p2.2.m2.1.1.1.1.3" stretchy="false" xref="S3.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><times id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2"></times><apply id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.3.1.cmml" xref="S3.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.p2.2.m2.1.1.3.2.cmml" xref="S3.p2.2.m2.1.1.3.2">𝑝</ci><ci id="S3.p2.2.m2.1.1.3.3.cmml" xref="S3.p2.2.m2.1.1.3.3">italic-ϕ</ci></apply><apply id="S3.p2.2.m2.1.1.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1.1.1.1">succeeds</csymbol><apply id="S3.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.p2.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.p2.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.p2.2.m2.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.p2.2.m2.1.1.1.1.1.2.3">𝑤</ci></apply><apply id="S3.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.p2.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3.1">conditional</csymbol><apply id="S3.p2.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.1.1.3.2.1.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.p2.2.m2.1.1.1.1.1.3.2.2.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S3.p2.2.m2.1.1.1.1.1.3.2.3.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S3.p2.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">p_{\phi}(y_{w}\succ y_{l}|x)</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_p start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math> using an LLM, without any additional assumptions. Notice that this formulation is fully general as we can extract preference probabilities either from the likelihoods of the LLM output or from majority voting counts. This can be used in the standard pipeline with PPO <cite class="ltx_cite ltx_citemacro_citep">(Stiennon et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib36" title="">2022</a>; Ouyang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib29" title="">2022</a>)</cite> in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S3.E5" title="In 3 Connections Between RLHF and Preference Modelling ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">5</span></a> using the reward formulation in Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S3.E6" title="In 3 Connections Between RLHF and Preference Modelling ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">6</span></a>. Alternatively, if we sample preferences from the above model, we can also utilize an iterative or online *PO optimization manner following <cite class="ltx_cite ltx_citemacro_citet">Munos et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib27" title="">2024</a>)</cite> or <cite class="ltx_cite ltx_citemacro_citet">Calandriello et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib11" title="">2024</a>)</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Generative Reward Models: A Unified RLHF-RLAIF Approach</h2>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.6">In our proposed framework we begin with an LLM <math alttext="\pi_{\phi}" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><msub id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml"><mi id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">π</mi><mi id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">𝜋</ci><ci id="S4.p1.1.m1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\pi_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> acting as a zero-shot judge in an RLAIF setting, as outlined in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS3" title="2.3 RLAIF and LLM-As-A-Judge ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">2.3</span></a>. That is, given a task <math alttext="x" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">italic_x</annotation></semantics></math> and two responses <math alttext="y_{1}" class="ltx_Math" display="inline" id="S4.p1.3.m3.1"><semantics id="S4.p1.3.m3.1a"><msub id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml"><mi id="S4.p1.3.m3.1.1.2" xref="S4.p1.3.m3.1.1.2.cmml">y</mi><mn id="S4.p1.3.m3.1.1.3" xref="S4.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.cmml" xref="S4.p1.3.m3.1.1">subscript</csymbol><ci id="S4.p1.3.m3.1.1.2.cmml" xref="S4.p1.3.m3.1.1.2">𝑦</ci><cn id="S4.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">y_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.m3.1d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{2}" class="ltx_Math" display="inline" id="S4.p1.4.m4.1"><semantics id="S4.p1.4.m4.1a"><msub id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml"><mi id="S4.p1.4.m4.1.1.2" xref="S4.p1.4.m4.1.1.2.cmml">y</mi><mn id="S4.p1.4.m4.1.1.3" xref="S4.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><apply id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p1.4.m4.1.1.1.cmml" xref="S4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.p1.4.m4.1.1.2.cmml" xref="S4.p1.4.m4.1.1.2">𝑦</ci><cn id="S4.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">y_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, we directly prompt the model <math alttext="\pi_{\phi}" class="ltx_Math" display="inline" id="S4.p1.5.m5.1"><semantics id="S4.p1.5.m5.1a"><msub id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml"><mi id="S4.p1.5.m5.1.1.2" xref="S4.p1.5.m5.1.1.2.cmml">π</mi><mi id="S4.p1.5.m5.1.1.3" xref="S4.p1.5.m5.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><apply id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.1.cmml" xref="S4.p1.5.m5.1.1">subscript</csymbol><ci id="S4.p1.5.m5.1.1.2.cmml" xref="S4.p1.5.m5.1.1.2">𝜋</ci><ci id="S4.p1.5.m5.1.1.3.cmml" xref="S4.p1.5.m5.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">\pi_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.5.m5.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> to provide an answer indicator token <math alttext="I" class="ltx_Math" display="inline" id="S4.p1.6.m6.1"><semantics id="S4.p1.6.m6.1a"><mi id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.1b"><ci id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.p1.6.m6.1d">italic_I</annotation></semantics></math> indicating a preference over the answers. We consider two variants of our approach:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">The Generative Reward Model (GenRM) approach prompts the model to act as a classifier directly providing the answer token probabilities for each response <math alttext="\hat{I}\sim\pi_{\phi}(I,|x,y_{1},y_{2})" class="ltx_math_unparsed" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><mrow id="S4.I1.i1.p1.1.m1.1b"><mover accent="true" id="S4.I1.i1.p1.1.m1.1.2"><mi id="S4.I1.i1.p1.1.m1.1.2.2">I</mi><mo id="S4.I1.i1.p1.1.m1.1.2.1">^</mo></mover><mo id="S4.I1.i1.p1.1.m1.1.3">∼</mo><msub id="S4.I1.i1.p1.1.m1.1.4"><mi id="S4.I1.i1.p1.1.m1.1.4.2">π</mi><mi id="S4.I1.i1.p1.1.m1.1.4.3">ϕ</mi></msub><mrow id="S4.I1.i1.p1.1.m1.1.5"><mo id="S4.I1.i1.p1.1.m1.1.5.1" stretchy="false">(</mo><mi id="S4.I1.i1.p1.1.m1.1.5.2">I</mi><mo id="S4.I1.i1.p1.1.m1.1.5.3">,</mo><mo fence="false" id="S4.I1.i1.p1.1.m1.1.5.4" rspace="0.167em" stretchy="false">|</mo><mi id="S4.I1.i1.p1.1.m1.1.1">x</mi><mo id="S4.I1.i1.p1.1.m1.1.5.5">,</mo><msub id="S4.I1.i1.p1.1.m1.1.5.6"><mi id="S4.I1.i1.p1.1.m1.1.5.6.2">y</mi><mn id="S4.I1.i1.p1.1.m1.1.5.6.3">1</mn></msub><mo id="S4.I1.i1.p1.1.m1.1.5.7">,</mo><msub id="S4.I1.i1.p1.1.m1.1.5.8"><mi id="S4.I1.i1.p1.1.m1.1.5.8.2">y</mi><mn id="S4.I1.i1.p1.1.m1.1.5.8.3">2</mn></msub><mo id="S4.I1.i1.p1.1.m1.1.5.9" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">\hat{I}\sim\pi_{\phi}(I,|x,y_{1},y_{2})</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">over^ start_ARG italic_I end_ARG ∼ italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_I , | italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para ltx_noindent" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">The CoT-GenRM approach additionally prompts the model to provide intermediate Chain-of-Thought reasoning <math alttext="\hat{I},\hat{r}\sim\pi_{\phi}(I,r|x,y_{1},y_{2})" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.5"><semantics id="S4.I1.i2.p1.1.m1.5a"><mrow id="S4.I1.i2.p1.1.m1.5.5" xref="S4.I1.i2.p1.1.m1.5.5.cmml"><mrow id="S4.I1.i2.p1.1.m1.5.5.3.2" xref="S4.I1.i2.p1.1.m1.5.5.3.1.cmml"><mover accent="true" id="S4.I1.i2.p1.1.m1.3.3" xref="S4.I1.i2.p1.1.m1.3.3.cmml"><mi id="S4.I1.i2.p1.1.m1.3.3.2" xref="S4.I1.i2.p1.1.m1.3.3.2.cmml">I</mi><mo id="S4.I1.i2.p1.1.m1.3.3.1" xref="S4.I1.i2.p1.1.m1.3.3.1.cmml">^</mo></mover><mo id="S4.I1.i2.p1.1.m1.5.5.3.2.1" xref="S4.I1.i2.p1.1.m1.5.5.3.1.cmml">,</mo><mover accent="true" id="S4.I1.i2.p1.1.m1.4.4" xref="S4.I1.i2.p1.1.m1.4.4.cmml"><mi id="S4.I1.i2.p1.1.m1.4.4.2" xref="S4.I1.i2.p1.1.m1.4.4.2.cmml">r</mi><mo id="S4.I1.i2.p1.1.m1.4.4.1" xref="S4.I1.i2.p1.1.m1.4.4.1.cmml">^</mo></mover></mrow><mo id="S4.I1.i2.p1.1.m1.5.5.2" xref="S4.I1.i2.p1.1.m1.5.5.2.cmml">∼</mo><mrow id="S4.I1.i2.p1.1.m1.5.5.1" xref="S4.I1.i2.p1.1.m1.5.5.1.cmml"><msub id="S4.I1.i2.p1.1.m1.5.5.1.3" xref="S4.I1.i2.p1.1.m1.5.5.1.3.cmml"><mi id="S4.I1.i2.p1.1.m1.5.5.1.3.2" xref="S4.I1.i2.p1.1.m1.5.5.1.3.2.cmml">π</mi><mi id="S4.I1.i2.p1.1.m1.5.5.1.3.3" xref="S4.I1.i2.p1.1.m1.5.5.1.3.3.cmml">ϕ</mi></msub><mo id="S4.I1.i2.p1.1.m1.5.5.1.2" xref="S4.I1.i2.p1.1.m1.5.5.1.2.cmml">⁢</mo><mrow id="S4.I1.i2.p1.1.m1.5.5.1.1.1" xref="S4.I1.i2.p1.1.m1.5.5.1.1.2.cmml"><mo id="S4.I1.i2.p1.1.m1.5.5.1.1.1.2" stretchy="false" xref="S4.I1.i2.p1.1.m1.5.5.1.1.2.cmml">(</mo><mi id="S4.I1.i2.p1.1.m1.2.2" xref="S4.I1.i2.p1.1.m1.2.2.cmml">I</mi><mo id="S4.I1.i2.p1.1.m1.5.5.1.1.1.3" xref="S4.I1.i2.p1.1.m1.5.5.1.1.2.cmml">,</mo><mrow id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.4" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.4.cmml">r</mi><mo fence="false" id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.3" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.3.cmml">|</mo><mrow id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.3.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">x</mi><mo id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.3" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.3.cmml">,</mo><msub id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.2" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.4" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.3.cmml">,</mo><msub id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.cmml"><mi id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.2" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.2.cmml">y</mi><mn id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.3" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.3.cmml">2</mn></msub></mrow></mrow><mo id="S4.I1.i2.p1.1.m1.5.5.1.1.1.4" stretchy="false" xref="S4.I1.i2.p1.1.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.5b"><apply id="S4.I1.i2.p1.1.m1.5.5.cmml" xref="S4.I1.i2.p1.1.m1.5.5"><csymbol cd="latexml" id="S4.I1.i2.p1.1.m1.5.5.2.cmml" xref="S4.I1.i2.p1.1.m1.5.5.2">similar-to</csymbol><list id="S4.I1.i2.p1.1.m1.5.5.3.1.cmml" xref="S4.I1.i2.p1.1.m1.5.5.3.2"><apply id="S4.I1.i2.p1.1.m1.3.3.cmml" xref="S4.I1.i2.p1.1.m1.3.3"><ci id="S4.I1.i2.p1.1.m1.3.3.1.cmml" xref="S4.I1.i2.p1.1.m1.3.3.1">^</ci><ci id="S4.I1.i2.p1.1.m1.3.3.2.cmml" xref="S4.I1.i2.p1.1.m1.3.3.2">𝐼</ci></apply><apply id="S4.I1.i2.p1.1.m1.4.4.cmml" xref="S4.I1.i2.p1.1.m1.4.4"><ci id="S4.I1.i2.p1.1.m1.4.4.1.cmml" xref="S4.I1.i2.p1.1.m1.4.4.1">^</ci><ci id="S4.I1.i2.p1.1.m1.4.4.2.cmml" xref="S4.I1.i2.p1.1.m1.4.4.2">𝑟</ci></apply></list><apply id="S4.I1.i2.p1.1.m1.5.5.1.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1"><times id="S4.I1.i2.p1.1.m1.5.5.1.2.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.2"></times><apply id="S4.I1.i2.p1.1.m1.5.5.1.3.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.3"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.5.5.1.3.1.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.3">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.5.5.1.3.2.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.3.2">𝜋</ci><ci id="S4.I1.i2.p1.1.m1.5.5.1.3.3.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.3.3">italic-ϕ</ci></apply><interval closure="open" id="S4.I1.i2.p1.1.m1.5.5.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1"><ci id="S4.I1.i2.p1.1.m1.2.2.cmml" xref="S4.I1.i2.p1.1.m1.2.2">𝐼</ci><apply id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1"><csymbol cd="latexml" id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.3">conditional</csymbol><ci id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.4.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.4">𝑟</ci><list id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.3.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2"><ci id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">𝑥</ci><apply id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.2">𝑦</ci><cn id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.1.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.2.cmml" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.2">𝑦</ci><cn id="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S4.I1.i2.p1.1.m1.5.5.1.1.1.1.2.2.2.3">2</cn></apply></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.5c">\hat{I},\hat{r}\sim\pi_{\phi}(I,r|x,y_{1},y_{2})</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.5d">over^ start_ARG italic_I end_ARG , over^ start_ARG italic_r end_ARG ∼ italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_I , italic_r | italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math> before providing the final answer indicator token.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.4">Our prompts are based on the standard MT-Bench prompt <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib54" title="">2023b</a>)</cite>, and can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1" title="Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">A</span></a>. We use the LLM judge as a prior and further train it to align with the ground-truth dataset judgements. We begin with the preference dataset <math alttext="\mathcal{D}=\left\{x^{(i)},y_{1}^{(i)},y_{2}^{(i)},I^{(i)}\right\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S4.p3.1.m1.8"><semantics id="S4.p3.1.m1.8a"><mrow id="S4.p3.1.m1.8.8" xref="S4.p3.1.m1.8.8.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p3.1.m1.8.8.6" xref="S4.p3.1.m1.8.8.6.cmml">𝒟</mi><mo id="S4.p3.1.m1.8.8.5" xref="S4.p3.1.m1.8.8.5.cmml">=</mo><msubsup id="S4.p3.1.m1.8.8.4" xref="S4.p3.1.m1.8.8.4.cmml"><mrow id="S4.p3.1.m1.8.8.4.4.4.4" xref="S4.p3.1.m1.8.8.4.4.4.5.cmml"><mo id="S4.p3.1.m1.8.8.4.4.4.4.5" xref="S4.p3.1.m1.8.8.4.4.4.5.cmml">{</mo><msup id="S4.p3.1.m1.5.5.1.1.1.1.1" xref="S4.p3.1.m1.5.5.1.1.1.1.1.cmml"><mi id="S4.p3.1.m1.5.5.1.1.1.1.1.2" xref="S4.p3.1.m1.5.5.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.p3.1.m1.1.1.1.3" xref="S4.p3.1.m1.5.5.1.1.1.1.1.cmml"><mo id="S4.p3.1.m1.1.1.1.3.1" stretchy="false" xref="S4.p3.1.m1.5.5.1.1.1.1.1.cmml">(</mo><mi id="S4.p3.1.m1.1.1.1.1" xref="S4.p3.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.p3.1.m1.1.1.1.3.2" stretchy="false" xref="S4.p3.1.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.p3.1.m1.8.8.4.4.4.4.6" xref="S4.p3.1.m1.8.8.4.4.4.5.cmml">,</mo><msubsup id="S4.p3.1.m1.6.6.2.2.2.2.2" xref="S4.p3.1.m1.6.6.2.2.2.2.2.cmml"><mi id="S4.p3.1.m1.6.6.2.2.2.2.2.2.2" xref="S4.p3.1.m1.6.6.2.2.2.2.2.2.2.cmml">y</mi><mn id="S4.p3.1.m1.6.6.2.2.2.2.2.2.3" xref="S4.p3.1.m1.6.6.2.2.2.2.2.2.3.cmml">1</mn><mrow id="S4.p3.1.m1.2.2.1.3" xref="S4.p3.1.m1.6.6.2.2.2.2.2.cmml"><mo id="S4.p3.1.m1.2.2.1.3.1" stretchy="false" xref="S4.p3.1.m1.6.6.2.2.2.2.2.cmml">(</mo><mi id="S4.p3.1.m1.2.2.1.1" xref="S4.p3.1.m1.2.2.1.1.cmml">i</mi><mo id="S4.p3.1.m1.2.2.1.3.2" stretchy="false" xref="S4.p3.1.m1.6.6.2.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.p3.1.m1.8.8.4.4.4.4.7" xref="S4.p3.1.m1.8.8.4.4.4.5.cmml">,</mo><msubsup id="S4.p3.1.m1.7.7.3.3.3.3.3" xref="S4.p3.1.m1.7.7.3.3.3.3.3.cmml"><mi id="S4.p3.1.m1.7.7.3.3.3.3.3.2.2" xref="S4.p3.1.m1.7.7.3.3.3.3.3.2.2.cmml">y</mi><mn id="S4.p3.1.m1.7.7.3.3.3.3.3.2.3" xref="S4.p3.1.m1.7.7.3.3.3.3.3.2.3.cmml">2</mn><mrow id="S4.p3.1.m1.3.3.1.3" xref="S4.p3.1.m1.7.7.3.3.3.3.3.cmml"><mo id="S4.p3.1.m1.3.3.1.3.1" stretchy="false" xref="S4.p3.1.m1.7.7.3.3.3.3.3.cmml">(</mo><mi id="S4.p3.1.m1.3.3.1.1" xref="S4.p3.1.m1.3.3.1.1.cmml">i</mi><mo id="S4.p3.1.m1.3.3.1.3.2" stretchy="false" xref="S4.p3.1.m1.7.7.3.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S4.p3.1.m1.8.8.4.4.4.4.8" xref="S4.p3.1.m1.8.8.4.4.4.5.cmml">,</mo><msup id="S4.p3.1.m1.8.8.4.4.4.4.4" xref="S4.p3.1.m1.8.8.4.4.4.4.4.cmml"><mi id="S4.p3.1.m1.8.8.4.4.4.4.4.2" xref="S4.p3.1.m1.8.8.4.4.4.4.4.2.cmml">I</mi><mrow id="S4.p3.1.m1.4.4.1.3" xref="S4.p3.1.m1.8.8.4.4.4.4.4.cmml"><mo id="S4.p3.1.m1.4.4.1.3.1" stretchy="false" xref="S4.p3.1.m1.8.8.4.4.4.4.4.cmml">(</mo><mi id="S4.p3.1.m1.4.4.1.1" xref="S4.p3.1.m1.4.4.1.1.cmml">i</mi><mo id="S4.p3.1.m1.4.4.1.3.2" stretchy="false" xref="S4.p3.1.m1.8.8.4.4.4.4.4.cmml">)</mo></mrow></msup><mo id="S4.p3.1.m1.8.8.4.4.4.4.9" xref="S4.p3.1.m1.8.8.4.4.4.5.cmml">}</mo></mrow><mrow id="S4.p3.1.m1.8.8.4.4.6" xref="S4.p3.1.m1.8.8.4.4.6.cmml"><mi id="S4.p3.1.m1.8.8.4.4.6.2" xref="S4.p3.1.m1.8.8.4.4.6.2.cmml">i</mi><mo id="S4.p3.1.m1.8.8.4.4.6.1" xref="S4.p3.1.m1.8.8.4.4.6.1.cmml">=</mo><mn id="S4.p3.1.m1.8.8.4.4.6.3" xref="S4.p3.1.m1.8.8.4.4.6.3.cmml">1</mn></mrow><mi id="S4.p3.1.m1.8.8.4.6" xref="S4.p3.1.m1.8.8.4.6.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.8b"><apply id="S4.p3.1.m1.8.8.cmml" xref="S4.p3.1.m1.8.8"><eq id="S4.p3.1.m1.8.8.5.cmml" xref="S4.p3.1.m1.8.8.5"></eq><ci id="S4.p3.1.m1.8.8.6.cmml" xref="S4.p3.1.m1.8.8.6">𝒟</ci><apply id="S4.p3.1.m1.8.8.4.cmml" xref="S4.p3.1.m1.8.8.4"><csymbol cd="ambiguous" id="S4.p3.1.m1.8.8.4.5.cmml" xref="S4.p3.1.m1.8.8.4">superscript</csymbol><apply id="S4.p3.1.m1.8.8.4.4.cmml" xref="S4.p3.1.m1.8.8.4"><csymbol cd="ambiguous" id="S4.p3.1.m1.8.8.4.4.5.cmml" xref="S4.p3.1.m1.8.8.4">subscript</csymbol><set id="S4.p3.1.m1.8.8.4.4.4.5.cmml" xref="S4.p3.1.m1.8.8.4.4.4.4"><apply id="S4.p3.1.m1.5.5.1.1.1.1.1.cmml" xref="S4.p3.1.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.5.5.1.1.1.1.1.1.cmml" xref="S4.p3.1.m1.5.5.1.1.1.1.1">superscript</csymbol><ci id="S4.p3.1.m1.5.5.1.1.1.1.1.2.cmml" xref="S4.p3.1.m1.5.5.1.1.1.1.1.2">𝑥</ci><ci id="S4.p3.1.m1.1.1.1.1.cmml" xref="S4.p3.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.p3.1.m1.6.6.2.2.2.2.2.cmml" xref="S4.p3.1.m1.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.p3.1.m1.6.6.2.2.2.2.2.1.cmml" xref="S4.p3.1.m1.6.6.2.2.2.2.2">superscript</csymbol><apply id="S4.p3.1.m1.6.6.2.2.2.2.2.2.cmml" xref="S4.p3.1.m1.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.p3.1.m1.6.6.2.2.2.2.2.2.1.cmml" xref="S4.p3.1.m1.6.6.2.2.2.2.2">subscript</csymbol><ci id="S4.p3.1.m1.6.6.2.2.2.2.2.2.2.cmml" xref="S4.p3.1.m1.6.6.2.2.2.2.2.2.2">𝑦</ci><cn id="S4.p3.1.m1.6.6.2.2.2.2.2.2.3.cmml" type="integer" xref="S4.p3.1.m1.6.6.2.2.2.2.2.2.3">1</cn></apply><ci id="S4.p3.1.m1.2.2.1.1.cmml" xref="S4.p3.1.m1.2.2.1.1">𝑖</ci></apply><apply id="S4.p3.1.m1.7.7.3.3.3.3.3.cmml" xref="S4.p3.1.m1.7.7.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.p3.1.m1.7.7.3.3.3.3.3.1.cmml" xref="S4.p3.1.m1.7.7.3.3.3.3.3">superscript</csymbol><apply id="S4.p3.1.m1.7.7.3.3.3.3.3.2.cmml" xref="S4.p3.1.m1.7.7.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.p3.1.m1.7.7.3.3.3.3.3.2.1.cmml" xref="S4.p3.1.m1.7.7.3.3.3.3.3">subscript</csymbol><ci id="S4.p3.1.m1.7.7.3.3.3.3.3.2.2.cmml" xref="S4.p3.1.m1.7.7.3.3.3.3.3.2.2">𝑦</ci><cn id="S4.p3.1.m1.7.7.3.3.3.3.3.2.3.cmml" type="integer" xref="S4.p3.1.m1.7.7.3.3.3.3.3.2.3">2</cn></apply><ci id="S4.p3.1.m1.3.3.1.1.cmml" xref="S4.p3.1.m1.3.3.1.1">𝑖</ci></apply><apply id="S4.p3.1.m1.8.8.4.4.4.4.4.cmml" xref="S4.p3.1.m1.8.8.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.p3.1.m1.8.8.4.4.4.4.4.1.cmml" xref="S4.p3.1.m1.8.8.4.4.4.4.4">superscript</csymbol><ci id="S4.p3.1.m1.8.8.4.4.4.4.4.2.cmml" xref="S4.p3.1.m1.8.8.4.4.4.4.4.2">𝐼</ci><ci id="S4.p3.1.m1.4.4.1.1.cmml" xref="S4.p3.1.m1.4.4.1.1">𝑖</ci></apply></set><apply id="S4.p3.1.m1.8.8.4.4.6.cmml" xref="S4.p3.1.m1.8.8.4.4.6"><eq id="S4.p3.1.m1.8.8.4.4.6.1.cmml" xref="S4.p3.1.m1.8.8.4.4.6.1"></eq><ci id="S4.p3.1.m1.8.8.4.4.6.2.cmml" xref="S4.p3.1.m1.8.8.4.4.6.2">𝑖</ci><cn id="S4.p3.1.m1.8.8.4.4.6.3.cmml" type="integer" xref="S4.p3.1.m1.8.8.4.4.6.3">1</cn></apply></apply><ci id="S4.p3.1.m1.8.8.4.6.cmml" xref="S4.p3.1.m1.8.8.4.6">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.8c">\mathcal{D}=\left\{x^{(i)},y_{1}^{(i)},y_{2}^{(i)},I^{(i)}\right\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.1.m1.8d">caligraphic_D = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_I start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math> as outlined in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS1.SSS2" title="2.1.2 Bradley-Terry Reward Modeling ‣ 2.1 Reinforcement Learning from Human Feedback ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">2.1.2</span></a>, however we consider unranked answers <math alttext="y_{1}^{(i)},y_{2}^{(i)}" class="ltx_Math" display="inline" id="S4.p3.2.m2.4"><semantics id="S4.p3.2.m2.4a"><mrow id="S4.p3.2.m2.4.4.2" xref="S4.p3.2.m2.4.4.3.cmml"><msubsup id="S4.p3.2.m2.3.3.1.1" xref="S4.p3.2.m2.3.3.1.1.cmml"><mi id="S4.p3.2.m2.3.3.1.1.2.2" xref="S4.p3.2.m2.3.3.1.1.2.2.cmml">y</mi><mn id="S4.p3.2.m2.3.3.1.1.2.3" xref="S4.p3.2.m2.3.3.1.1.2.3.cmml">1</mn><mrow id="S4.p3.2.m2.1.1.1.3" xref="S4.p3.2.m2.3.3.1.1.cmml"><mo id="S4.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S4.p3.2.m2.3.3.1.1.cmml">(</mo><mi id="S4.p3.2.m2.1.1.1.1" xref="S4.p3.2.m2.1.1.1.1.cmml">i</mi><mo id="S4.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S4.p3.2.m2.3.3.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.p3.2.m2.4.4.2.3" xref="S4.p3.2.m2.4.4.3.cmml">,</mo><msubsup id="S4.p3.2.m2.4.4.2.2" xref="S4.p3.2.m2.4.4.2.2.cmml"><mi id="S4.p3.2.m2.4.4.2.2.2.2" xref="S4.p3.2.m2.4.4.2.2.2.2.cmml">y</mi><mn id="S4.p3.2.m2.4.4.2.2.2.3" xref="S4.p3.2.m2.4.4.2.2.2.3.cmml">2</mn><mrow id="S4.p3.2.m2.2.2.1.3" xref="S4.p3.2.m2.4.4.2.2.cmml"><mo id="S4.p3.2.m2.2.2.1.3.1" stretchy="false" xref="S4.p3.2.m2.4.4.2.2.cmml">(</mo><mi id="S4.p3.2.m2.2.2.1.1" xref="S4.p3.2.m2.2.2.1.1.cmml">i</mi><mo id="S4.p3.2.m2.2.2.1.3.2" stretchy="false" xref="S4.p3.2.m2.4.4.2.2.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.4b"><list id="S4.p3.2.m2.4.4.3.cmml" xref="S4.p3.2.m2.4.4.2"><apply id="S4.p3.2.m2.3.3.1.1.cmml" xref="S4.p3.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S4.p3.2.m2.3.3.1.1.1.cmml" xref="S4.p3.2.m2.3.3.1.1">superscript</csymbol><apply id="S4.p3.2.m2.3.3.1.1.2.cmml" xref="S4.p3.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S4.p3.2.m2.3.3.1.1.2.1.cmml" xref="S4.p3.2.m2.3.3.1.1">subscript</csymbol><ci id="S4.p3.2.m2.3.3.1.1.2.2.cmml" xref="S4.p3.2.m2.3.3.1.1.2.2">𝑦</ci><cn id="S4.p3.2.m2.3.3.1.1.2.3.cmml" type="integer" xref="S4.p3.2.m2.3.3.1.1.2.3">1</cn></apply><ci id="S4.p3.2.m2.1.1.1.1.cmml" xref="S4.p3.2.m2.1.1.1.1">𝑖</ci></apply><apply id="S4.p3.2.m2.4.4.2.2.cmml" xref="S4.p3.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="S4.p3.2.m2.4.4.2.2.1.cmml" xref="S4.p3.2.m2.4.4.2.2">superscript</csymbol><apply id="S4.p3.2.m2.4.4.2.2.2.cmml" xref="S4.p3.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="S4.p3.2.m2.4.4.2.2.2.1.cmml" xref="S4.p3.2.m2.4.4.2.2">subscript</csymbol><ci id="S4.p3.2.m2.4.4.2.2.2.2.cmml" xref="S4.p3.2.m2.4.4.2.2.2.2">𝑦</ci><cn id="S4.p3.2.m2.4.4.2.2.2.3.cmml" type="integer" xref="S4.p3.2.m2.4.4.2.2.2.3">2</cn></apply><ci id="S4.p3.2.m2.2.2.1.1.cmml" xref="S4.p3.2.m2.2.2.1.1">𝑖</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.4c">y_{1}^{(i)},y_{2}^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.2.m2.4d">italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math> and the corresponding winning choice <math alttext="I^{(i)}" class="ltx_Math" display="inline" id="S4.p3.3.m3.1"><semantics id="S4.p3.3.m3.1a"><msup id="S4.p3.3.m3.1.2" xref="S4.p3.3.m3.1.2.cmml"><mi id="S4.p3.3.m3.1.2.2" xref="S4.p3.3.m3.1.2.2.cmml">I</mi><mrow id="S4.p3.3.m3.1.1.1.3" xref="S4.p3.3.m3.1.2.cmml"><mo id="S4.p3.3.m3.1.1.1.3.1" stretchy="false" xref="S4.p3.3.m3.1.2.cmml">(</mo><mi id="S4.p3.3.m3.1.1.1.1" xref="S4.p3.3.m3.1.1.1.1.cmml">i</mi><mo id="S4.p3.3.m3.1.1.1.3.2" stretchy="false" xref="S4.p3.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.2.cmml" xref="S4.p3.3.m3.1.2"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.2.1.cmml" xref="S4.p3.3.m3.1.2">superscript</csymbol><ci id="S4.p3.3.m3.1.2.2.cmml" xref="S4.p3.3.m3.1.2.2">𝐼</ci><ci id="S4.p3.3.m3.1.1.1.1.cmml" xref="S4.p3.3.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">I^{(i)}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.3.m3.1d">italic_I start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT</annotation></semantics></math>.
We design several training techniques for the generative reward model<math alttext="\pi_{\phi}" class="ltx_Math" display="inline" id="S4.p3.4.m4.1"><semantics id="S4.p3.4.m4.1a"><msub id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml"><mi id="S4.p3.4.m4.1.1.2" xref="S4.p3.4.m4.1.1.2.cmml">π</mi><mi id="S4.p3.4.m4.1.1.3" xref="S4.p3.4.m4.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><apply id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p3.4.m4.1.1.1.cmml" xref="S4.p3.4.m4.1.1">subscript</csymbol><ci id="S4.p3.4.m4.1.1.2.cmml" xref="S4.p3.4.m4.1.1.2">𝜋</ci><ci id="S4.p3.4.m4.1.1.3.cmml" xref="S4.p3.4.m4.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">\pi_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.p3.4.m4.1d">italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p4">
<p class="ltx_p" id="S4.p4.1"><span class="ltx_text ltx_font_bold" id="S4.p4.1.1">GenRM (no CoT):</span> To train the GenRM model, we use the standard supervised fine tuning objective</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{GenRM}}(\pi_{\phi})=\mathbb{E}_{(x,y_{1},y_{2},I)\sim%
\mathcal{D}}[-\log\pi_{\phi}(I|x,y_{1},y_{2})]" class="ltx_Math" display="block" id="S4.E7.m1.7"><semantics id="S4.E7.m1.7a"><mrow id="S4.E7.m1.7.7" xref="S4.E7.m1.7.7.cmml"><mrow id="S4.E7.m1.6.6.1" xref="S4.E7.m1.6.6.1.cmml"><msub id="S4.E7.m1.6.6.1.3" xref="S4.E7.m1.6.6.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.6.6.1.3.2" xref="S4.E7.m1.6.6.1.3.2.cmml">ℒ</mi><mtext id="S4.E7.m1.6.6.1.3.3" xref="S4.E7.m1.6.6.1.3.3a.cmml">GenRM</mtext></msub><mo id="S4.E7.m1.6.6.1.2" xref="S4.E7.m1.6.6.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.6.6.1.1.1" xref="S4.E7.m1.6.6.1.1.1.1.cmml"><mo id="S4.E7.m1.6.6.1.1.1.2" stretchy="false" xref="S4.E7.m1.6.6.1.1.1.1.cmml">(</mo><msub id="S4.E7.m1.6.6.1.1.1.1" xref="S4.E7.m1.6.6.1.1.1.1.cmml"><mi id="S4.E7.m1.6.6.1.1.1.1.2" xref="S4.E7.m1.6.6.1.1.1.1.2.cmml">π</mi><mi id="S4.E7.m1.6.6.1.1.1.1.3" xref="S4.E7.m1.6.6.1.1.1.1.3.cmml">ϕ</mi></msub><mo id="S4.E7.m1.6.6.1.1.1.3" stretchy="false" xref="S4.E7.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.7.7.3" xref="S4.E7.m1.7.7.3.cmml">=</mo><mrow id="S4.E7.m1.7.7.2" xref="S4.E7.m1.7.7.2.cmml"><msub id="S4.E7.m1.7.7.2.3" xref="S4.E7.m1.7.7.2.3.cmml"><mi id="S4.E7.m1.7.7.2.3.2" xref="S4.E7.m1.7.7.2.3.2.cmml">𝔼</mi><mrow id="S4.E7.m1.4.4.4" xref="S4.E7.m1.4.4.4.cmml"><mrow id="S4.E7.m1.4.4.4.4.2" xref="S4.E7.m1.4.4.4.4.3.cmml"><mo id="S4.E7.m1.4.4.4.4.2.3" stretchy="false" xref="S4.E7.m1.4.4.4.4.3.cmml">(</mo><mi id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml">x</mi><mo id="S4.E7.m1.4.4.4.4.2.4" xref="S4.E7.m1.4.4.4.4.3.cmml">,</mo><msub id="S4.E7.m1.3.3.3.3.1.1" xref="S4.E7.m1.3.3.3.3.1.1.cmml"><mi id="S4.E7.m1.3.3.3.3.1.1.2" xref="S4.E7.m1.3.3.3.3.1.1.2.cmml">y</mi><mn id="S4.E7.m1.3.3.3.3.1.1.3" xref="S4.E7.m1.3.3.3.3.1.1.3.cmml">1</mn></msub><mo id="S4.E7.m1.4.4.4.4.2.5" xref="S4.E7.m1.4.4.4.4.3.cmml">,</mo><msub id="S4.E7.m1.4.4.4.4.2.2" xref="S4.E7.m1.4.4.4.4.2.2.cmml"><mi id="S4.E7.m1.4.4.4.4.2.2.2" xref="S4.E7.m1.4.4.4.4.2.2.2.cmml">y</mi><mn id="S4.E7.m1.4.4.4.4.2.2.3" xref="S4.E7.m1.4.4.4.4.2.2.3.cmml">2</mn></msub><mo id="S4.E7.m1.4.4.4.4.2.6" xref="S4.E7.m1.4.4.4.4.3.cmml">,</mo><mi id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.2.cmml">I</mi><mo id="S4.E7.m1.4.4.4.4.2.7" stretchy="false" xref="S4.E7.m1.4.4.4.4.3.cmml">)</mo></mrow><mo id="S4.E7.m1.4.4.4.5" xref="S4.E7.m1.4.4.4.5.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.4.4.4.6" xref="S4.E7.m1.4.4.4.6.cmml">𝒟</mi></mrow></msub><mo id="S4.E7.m1.7.7.2.2" xref="S4.E7.m1.7.7.2.2.cmml">⁢</mo><mrow id="S4.E7.m1.7.7.2.1.1" xref="S4.E7.m1.7.7.2.1.2.cmml"><mo id="S4.E7.m1.7.7.2.1.1.2" stretchy="false" xref="S4.E7.m1.7.7.2.1.2.1.cmml">[</mo><mrow id="S4.E7.m1.7.7.2.1.1.1" xref="S4.E7.m1.7.7.2.1.1.1.cmml"><mo id="S4.E7.m1.7.7.2.1.1.1a" rspace="0.167em" xref="S4.E7.m1.7.7.2.1.1.1.cmml">−</mo><mrow id="S4.E7.m1.7.7.2.1.1.1.1" xref="S4.E7.m1.7.7.2.1.1.1.1.cmml"><mrow id="S4.E7.m1.7.7.2.1.1.1.1.3" xref="S4.E7.m1.7.7.2.1.1.1.1.3.cmml"><mi id="S4.E7.m1.7.7.2.1.1.1.1.3.1" xref="S4.E7.m1.7.7.2.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E7.m1.7.7.2.1.1.1.1.3a" lspace="0.167em" xref="S4.E7.m1.7.7.2.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E7.m1.7.7.2.1.1.1.1.3.2" xref="S4.E7.m1.7.7.2.1.1.1.1.3.2.cmml"><mi id="S4.E7.m1.7.7.2.1.1.1.1.3.2.2" xref="S4.E7.m1.7.7.2.1.1.1.1.3.2.2.cmml">π</mi><mi id="S4.E7.m1.7.7.2.1.1.1.1.3.2.3" xref="S4.E7.m1.7.7.2.1.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S4.E7.m1.7.7.2.1.1.1.1.2" xref="S4.E7.m1.7.7.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.7.7.2.1.1.1.1.1.1" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.cmml"><mo id="S4.E7.m1.7.7.2.1.1.1.1.1.1.2" stretchy="false" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.4" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.4.cmml">I</mi><mo fence="false" id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.3" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E7.m1.5.5" xref="S4.E7.m1.5.5.cmml">x</mi><mo id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.3" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.4" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mn id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msub></mrow></mrow><mo id="S4.E7.m1.7.7.2.1.1.1.1.1.1.3" stretchy="false" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.7.7.2.1.1.3" stretchy="false" xref="S4.E7.m1.7.7.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.7b"><apply id="S4.E7.m1.7.7.cmml" xref="S4.E7.m1.7.7"><eq id="S4.E7.m1.7.7.3.cmml" xref="S4.E7.m1.7.7.3"></eq><apply id="S4.E7.m1.6.6.1.cmml" xref="S4.E7.m1.6.6.1"><times id="S4.E7.m1.6.6.1.2.cmml" xref="S4.E7.m1.6.6.1.2"></times><apply id="S4.E7.m1.6.6.1.3.cmml" xref="S4.E7.m1.6.6.1.3"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.1.3.1.cmml" xref="S4.E7.m1.6.6.1.3">subscript</csymbol><ci id="S4.E7.m1.6.6.1.3.2.cmml" xref="S4.E7.m1.6.6.1.3.2">ℒ</ci><ci id="S4.E7.m1.6.6.1.3.3a.cmml" xref="S4.E7.m1.6.6.1.3.3"><mtext id="S4.E7.m1.6.6.1.3.3.cmml" mathsize="70%" xref="S4.E7.m1.6.6.1.3.3">GenRM</mtext></ci></apply><apply id="S4.E7.m1.6.6.1.1.1.1.cmml" xref="S4.E7.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.1.1.1.1.1.cmml" xref="S4.E7.m1.6.6.1.1.1">subscript</csymbol><ci id="S4.E7.m1.6.6.1.1.1.1.2.cmml" xref="S4.E7.m1.6.6.1.1.1.1.2">𝜋</ci><ci id="S4.E7.m1.6.6.1.1.1.1.3.cmml" xref="S4.E7.m1.6.6.1.1.1.1.3">italic-ϕ</ci></apply></apply><apply id="S4.E7.m1.7.7.2.cmml" xref="S4.E7.m1.7.7.2"><times id="S4.E7.m1.7.7.2.2.cmml" xref="S4.E7.m1.7.7.2.2"></times><apply id="S4.E7.m1.7.7.2.3.cmml" xref="S4.E7.m1.7.7.2.3"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.2.3.1.cmml" xref="S4.E7.m1.7.7.2.3">subscript</csymbol><ci id="S4.E7.m1.7.7.2.3.2.cmml" xref="S4.E7.m1.7.7.2.3.2">𝔼</ci><apply id="S4.E7.m1.4.4.4.cmml" xref="S4.E7.m1.4.4.4"><csymbol cd="latexml" id="S4.E7.m1.4.4.4.5.cmml" xref="S4.E7.m1.4.4.4.5">similar-to</csymbol><vector id="S4.E7.m1.4.4.4.4.3.cmml" xref="S4.E7.m1.4.4.4.4.2"><ci id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1">𝑥</ci><apply id="S4.E7.m1.3.3.3.3.1.1.cmml" xref="S4.E7.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.3.3.1.1.1.cmml" xref="S4.E7.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S4.E7.m1.3.3.3.3.1.1.2.cmml" xref="S4.E7.m1.3.3.3.3.1.1.2">𝑦</ci><cn id="S4.E7.m1.3.3.3.3.1.1.3.cmml" type="integer" xref="S4.E7.m1.3.3.3.3.1.1.3">1</cn></apply><apply id="S4.E7.m1.4.4.4.4.2.2.cmml" xref="S4.E7.m1.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.4.4.4.4.2.2.1.cmml" xref="S4.E7.m1.4.4.4.4.2.2">subscript</csymbol><ci id="S4.E7.m1.4.4.4.4.2.2.2.cmml" xref="S4.E7.m1.4.4.4.4.2.2.2">𝑦</ci><cn id="S4.E7.m1.4.4.4.4.2.2.3.cmml" type="integer" xref="S4.E7.m1.4.4.4.4.2.2.3">2</cn></apply><ci id="S4.E7.m1.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2">𝐼</ci></vector><ci id="S4.E7.m1.4.4.4.6.cmml" xref="S4.E7.m1.4.4.4.6">𝒟</ci></apply></apply><apply id="S4.E7.m1.7.7.2.1.2.cmml" xref="S4.E7.m1.7.7.2.1.1"><csymbol cd="latexml" id="S4.E7.m1.7.7.2.1.2.1.cmml" xref="S4.E7.m1.7.7.2.1.1.2">delimited-[]</csymbol><apply id="S4.E7.m1.7.7.2.1.1.1.cmml" xref="S4.E7.m1.7.7.2.1.1.1"><minus id="S4.E7.m1.7.7.2.1.1.1.2.cmml" xref="S4.E7.m1.7.7.2.1.1.1"></minus><apply id="S4.E7.m1.7.7.2.1.1.1.1.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1"><times id="S4.E7.m1.7.7.2.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.2"></times><apply id="S4.E7.m1.7.7.2.1.1.1.1.3.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.3"><log id="S4.E7.m1.7.7.2.1.1.1.1.3.1.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.3.1"></log><apply id="S4.E7.m1.7.7.2.1.1.1.1.3.2.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.2.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E7.m1.7.7.2.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.3.2.2">𝜋</ci><ci id="S4.E7.m1.7.7.2.1.1.1.1.3.2.3.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.3">conditional</csymbol><ci id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.4.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.4">𝐼</ci><list id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2"><ci id="S4.E7.m1.5.5.cmml" xref="S4.E7.m1.5.5">𝑥</ci><apply id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><cn id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><cn id="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S4.E7.m1.7.7.2.1.1.1.1.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.7c">\mathcal{L}_{\text{GenRM}}(\pi_{\phi})=\mathbb{E}_{(x,y_{1},y_{2},I)\sim%
\mathcal{D}}[-\log\pi_{\phi}(I|x,y_{1},y_{2})]</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.7d">caligraphic_L start_POSTSUBSCRIPT GenRM end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ) = blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_I ) ∼ caligraphic_D end_POSTSUBSCRIPT [ - roman_log italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_I | italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p4.2">essentially using the LLM as a classifier trained with next-token prediction.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p5">
<p class="ltx_p" id="S4.p5.1"><span class="ltx_text ltx_font_bold" id="S4.p5.1.1">CoT-GenRM with Rationalization:</span> To train the CoT-GenRM we will also consider two settings—bootstrapping intermediate reasoning from ground-truth or, potentially, a stronger rationalization model <math alttext="r\sim q_{\phi}(r|x^{(i)},y_{1}^{(i)},y_{2}^{(i)})" class="ltx_Math" display="inline" id="S4.p5.1.m1.4"><semantics id="S4.p5.1.m1.4a"><mrow id="S4.p5.1.m1.4.4" xref="S4.p5.1.m1.4.4.cmml"><mi id="S4.p5.1.m1.4.4.3" xref="S4.p5.1.m1.4.4.3.cmml">r</mi><mo id="S4.p5.1.m1.4.4.2" xref="S4.p5.1.m1.4.4.2.cmml">∼</mo><mrow id="S4.p5.1.m1.4.4.1" xref="S4.p5.1.m1.4.4.1.cmml"><msub id="S4.p5.1.m1.4.4.1.3" xref="S4.p5.1.m1.4.4.1.3.cmml"><mi id="S4.p5.1.m1.4.4.1.3.2" xref="S4.p5.1.m1.4.4.1.3.2.cmml">q</mi><mi id="S4.p5.1.m1.4.4.1.3.3" xref="S4.p5.1.m1.4.4.1.3.3.cmml">ϕ</mi></msub><mo id="S4.p5.1.m1.4.4.1.2" xref="S4.p5.1.m1.4.4.1.2.cmml">⁢</mo><mrow id="S4.p5.1.m1.4.4.1.1.1" xref="S4.p5.1.m1.4.4.1.1.1.1.cmml"><mo id="S4.p5.1.m1.4.4.1.1.1.2" stretchy="false" xref="S4.p5.1.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S4.p5.1.m1.4.4.1.1.1.1" xref="S4.p5.1.m1.4.4.1.1.1.1.cmml"><mi id="S4.p5.1.m1.4.4.1.1.1.1.5" xref="S4.p5.1.m1.4.4.1.1.1.1.5.cmml">r</mi><mo fence="false" id="S4.p5.1.m1.4.4.1.1.1.1.4" xref="S4.p5.1.m1.4.4.1.1.1.1.4.cmml">|</mo><mrow id="S4.p5.1.m1.4.4.1.1.1.1.3.3" xref="S4.p5.1.m1.4.4.1.1.1.1.3.4.cmml"><msup id="S4.p5.1.m1.4.4.1.1.1.1.1.1.1" xref="S4.p5.1.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.p5.1.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.p5.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S4.p5.1.m1.1.1.1.3" xref="S4.p5.1.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S4.p5.1.m1.1.1.1.3.1" stretchy="false" xref="S4.p5.1.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.p5.1.m1.1.1.1.1" xref="S4.p5.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.p5.1.m1.1.1.1.3.2" stretchy="false" xref="S4.p5.1.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.p5.1.m1.4.4.1.1.1.1.3.3.4" xref="S4.p5.1.m1.4.4.1.1.1.1.3.4.cmml">,</mo><msubsup id="S4.p5.1.m1.4.4.1.1.1.1.2.2.2" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.cmml"><mi id="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.2.2" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.2.2.cmml">y</mi><mn id="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.2.3" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.2.3.cmml">1</mn><mrow id="S4.p5.1.m1.2.2.1.3" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.cmml"><mo id="S4.p5.1.m1.2.2.1.3.1" stretchy="false" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.cmml">(</mo><mi id="S4.p5.1.m1.2.2.1.1" xref="S4.p5.1.m1.2.2.1.1.cmml">i</mi><mo id="S4.p5.1.m1.2.2.1.3.2" stretchy="false" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.p5.1.m1.4.4.1.1.1.1.3.3.5" xref="S4.p5.1.m1.4.4.1.1.1.1.3.4.cmml">,</mo><msubsup id="S4.p5.1.m1.4.4.1.1.1.1.3.3.3" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.cmml"><mi id="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.2.2" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.2.2.cmml">y</mi><mn id="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.2.3" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.2.3.cmml">2</mn><mrow id="S4.p5.1.m1.3.3.1.3" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.cmml"><mo id="S4.p5.1.m1.3.3.1.3.1" stretchy="false" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.cmml">(</mo><mi id="S4.p5.1.m1.3.3.1.1" xref="S4.p5.1.m1.3.3.1.1.cmml">i</mi><mo id="S4.p5.1.m1.3.3.1.3.2" stretchy="false" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><mo id="S4.p5.1.m1.4.4.1.1.1.3" stretchy="false" xref="S4.p5.1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.4b"><apply id="S4.p5.1.m1.4.4.cmml" xref="S4.p5.1.m1.4.4"><csymbol cd="latexml" id="S4.p5.1.m1.4.4.2.cmml" xref="S4.p5.1.m1.4.4.2">similar-to</csymbol><ci id="S4.p5.1.m1.4.4.3.cmml" xref="S4.p5.1.m1.4.4.3">𝑟</ci><apply id="S4.p5.1.m1.4.4.1.cmml" xref="S4.p5.1.m1.4.4.1"><times id="S4.p5.1.m1.4.4.1.2.cmml" xref="S4.p5.1.m1.4.4.1.2"></times><apply id="S4.p5.1.m1.4.4.1.3.cmml" xref="S4.p5.1.m1.4.4.1.3"><csymbol cd="ambiguous" id="S4.p5.1.m1.4.4.1.3.1.cmml" xref="S4.p5.1.m1.4.4.1.3">subscript</csymbol><ci id="S4.p5.1.m1.4.4.1.3.2.cmml" xref="S4.p5.1.m1.4.4.1.3.2">𝑞</ci><ci id="S4.p5.1.m1.4.4.1.3.3.cmml" xref="S4.p5.1.m1.4.4.1.3.3">italic-ϕ</ci></apply><apply id="S4.p5.1.m1.4.4.1.1.1.1.cmml" xref="S4.p5.1.m1.4.4.1.1.1"><csymbol cd="latexml" id="S4.p5.1.m1.4.4.1.1.1.1.4.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.4">conditional</csymbol><ci id="S4.p5.1.m1.4.4.1.1.1.1.5.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.5">𝑟</ci><list id="S4.p5.1.m1.4.4.1.1.1.1.3.4.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3"><apply id="S4.p5.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p5.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.p5.1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.p5.1.m1.1.1.1.1.cmml" xref="S4.p5.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.1.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2">superscript</csymbol><apply id="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.2.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.2.1.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.2.2.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.2.2">𝑦</ci><cn id="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.2.3.cmml" type="integer" xref="S4.p5.1.m1.4.4.1.1.1.1.2.2.2.2.3">1</cn></apply><ci id="S4.p5.1.m1.2.2.1.1.cmml" xref="S4.p5.1.m1.2.2.1.1">𝑖</ci></apply><apply id="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.1.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3">superscript</csymbol><apply id="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.2.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.2.1.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3">subscript</csymbol><ci id="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.2.2.cmml" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.2.2">𝑦</ci><cn id="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.2.3.cmml" type="integer" xref="S4.p5.1.m1.4.4.1.1.1.1.3.3.3.2.3">2</cn></apply><ci id="S4.p5.1.m1.3.3.1.1.cmml" xref="S4.p5.1.m1.3.3.1.1">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.4c">r\sim q_{\phi}(r|x^{(i)},y_{1}^{(i)},y_{2}^{(i)})</annotation><annotation encoding="application/x-llamapun" id="S4.p5.1.m1.4d">italic_r ∼ italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_r | italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT )</annotation></semantics></math>. We can then train the model with maximum likelihood over both the reasoning chain and ranking:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{GenRM-Rationalization}}(\pi_{\phi})=\mathbb{E}_{(x,y_{1},y_%
{2},r,I)\sim\mathcal{D}}[-\log\pi_{\phi}(I|x,y_{1},y_{2},r)-\log\pi_{\phi}(r|x%
,y_{1},y_{2})]" class="ltx_Math" display="block" id="S4.E8.m1.10"><semantics id="S4.E8.m1.10a"><mrow id="S4.E8.m1.10.10" xref="S4.E8.m1.10.10.cmml"><mrow id="S4.E8.m1.9.9.1" xref="S4.E8.m1.9.9.1.cmml"><msub id="S4.E8.m1.9.9.1.3" xref="S4.E8.m1.9.9.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.9.9.1.3.2" xref="S4.E8.m1.9.9.1.3.2.cmml">ℒ</mi><mtext id="S4.E8.m1.9.9.1.3.3" xref="S4.E8.m1.9.9.1.3.3a.cmml">GenRM-Rationalization</mtext></msub><mo id="S4.E8.m1.9.9.1.2" xref="S4.E8.m1.9.9.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.9.9.1.1.1" xref="S4.E8.m1.9.9.1.1.1.1.cmml"><mo id="S4.E8.m1.9.9.1.1.1.2" stretchy="false" xref="S4.E8.m1.9.9.1.1.1.1.cmml">(</mo><msub id="S4.E8.m1.9.9.1.1.1.1" xref="S4.E8.m1.9.9.1.1.1.1.cmml"><mi id="S4.E8.m1.9.9.1.1.1.1.2" xref="S4.E8.m1.9.9.1.1.1.1.2.cmml">π</mi><mi id="S4.E8.m1.9.9.1.1.1.1.3" xref="S4.E8.m1.9.9.1.1.1.1.3.cmml">ϕ</mi></msub><mo id="S4.E8.m1.9.9.1.1.1.3" stretchy="false" xref="S4.E8.m1.9.9.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.10.10.3" xref="S4.E8.m1.10.10.3.cmml">=</mo><mrow id="S4.E8.m1.10.10.2" xref="S4.E8.m1.10.10.2.cmml"><msub id="S4.E8.m1.10.10.2.3" xref="S4.E8.m1.10.10.2.3.cmml"><mi id="S4.E8.m1.10.10.2.3.2" xref="S4.E8.m1.10.10.2.3.2.cmml">𝔼</mi><mrow id="S4.E8.m1.5.5.5" xref="S4.E8.m1.5.5.5.cmml"><mrow id="S4.E8.m1.5.5.5.5.2" xref="S4.E8.m1.5.5.5.5.3.cmml"><mo id="S4.E8.m1.5.5.5.5.2.3" stretchy="false" xref="S4.E8.m1.5.5.5.5.3.cmml">(</mo><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">x</mi><mo id="S4.E8.m1.5.5.5.5.2.4" xref="S4.E8.m1.5.5.5.5.3.cmml">,</mo><msub id="S4.E8.m1.4.4.4.4.1.1" xref="S4.E8.m1.4.4.4.4.1.1.cmml"><mi id="S4.E8.m1.4.4.4.4.1.1.2" xref="S4.E8.m1.4.4.4.4.1.1.2.cmml">y</mi><mn id="S4.E8.m1.4.4.4.4.1.1.3" xref="S4.E8.m1.4.4.4.4.1.1.3.cmml">1</mn></msub><mo id="S4.E8.m1.5.5.5.5.2.5" xref="S4.E8.m1.5.5.5.5.3.cmml">,</mo><msub id="S4.E8.m1.5.5.5.5.2.2" xref="S4.E8.m1.5.5.5.5.2.2.cmml"><mi id="S4.E8.m1.5.5.5.5.2.2.2" xref="S4.E8.m1.5.5.5.5.2.2.2.cmml">y</mi><mn id="S4.E8.m1.5.5.5.5.2.2.3" xref="S4.E8.m1.5.5.5.5.2.2.3.cmml">2</mn></msub><mo id="S4.E8.m1.5.5.5.5.2.6" xref="S4.E8.m1.5.5.5.5.3.cmml">,</mo><mi id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.cmml">r</mi><mo id="S4.E8.m1.5.5.5.5.2.7" xref="S4.E8.m1.5.5.5.5.3.cmml">,</mo><mi id="S4.E8.m1.3.3.3.3" xref="S4.E8.m1.3.3.3.3.cmml">I</mi><mo id="S4.E8.m1.5.5.5.5.2.8" stretchy="false" xref="S4.E8.m1.5.5.5.5.3.cmml">)</mo></mrow><mo id="S4.E8.m1.5.5.5.6" xref="S4.E8.m1.5.5.5.6.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.5.5.5.7" xref="S4.E8.m1.5.5.5.7.cmml">𝒟</mi></mrow></msub><mo id="S4.E8.m1.10.10.2.2" xref="S4.E8.m1.10.10.2.2.cmml">⁢</mo><mrow id="S4.E8.m1.10.10.2.1.1" xref="S4.E8.m1.10.10.2.1.2.cmml"><mo id="S4.E8.m1.10.10.2.1.1.2" stretchy="false" xref="S4.E8.m1.10.10.2.1.2.1.cmml">[</mo><mrow id="S4.E8.m1.10.10.2.1.1.1" xref="S4.E8.m1.10.10.2.1.1.1.cmml"><mrow id="S4.E8.m1.10.10.2.1.1.1.1" xref="S4.E8.m1.10.10.2.1.1.1.1.cmml"><mo id="S4.E8.m1.10.10.2.1.1.1.1a" rspace="0.167em" xref="S4.E8.m1.10.10.2.1.1.1.1.cmml">−</mo><mrow id="S4.E8.m1.10.10.2.1.1.1.1.1" xref="S4.E8.m1.10.10.2.1.1.1.1.1.cmml"><mrow id="S4.E8.m1.10.10.2.1.1.1.1.1.3" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.cmml"><mi id="S4.E8.m1.10.10.2.1.1.1.1.1.3.1" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S4.E8.m1.10.10.2.1.1.1.1.1.3a" lspace="0.167em" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E8.m1.10.10.2.1.1.1.1.1.3.2" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.cmml"><mi id="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.2" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.2.cmml">π</mi><mi id="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.3" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S4.E8.m1.10.10.2.1.1.1.1.1.2" xref="S4.E8.m1.10.10.2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.4" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.4.cmml">I</mi><mo fence="false" id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E8.m1.6.6" xref="S4.E8.m1.6.6.cmml">x</mi><mo id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.4" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mn id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.5" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S4.E8.m1.7.7" xref="S4.E8.m1.7.7.cmml">r</mi></mrow></mrow><mo id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.10.10.2.1.1.1.3" xref="S4.E8.m1.10.10.2.1.1.1.3.cmml">−</mo><mrow id="S4.E8.m1.10.10.2.1.1.1.2" xref="S4.E8.m1.10.10.2.1.1.1.2.cmml"><mrow id="S4.E8.m1.10.10.2.1.1.1.2.3" xref="S4.E8.m1.10.10.2.1.1.1.2.3.cmml"><mi id="S4.E8.m1.10.10.2.1.1.1.2.3.1" xref="S4.E8.m1.10.10.2.1.1.1.2.3.1.cmml">log</mi><mo id="S4.E8.m1.10.10.2.1.1.1.2.3a" lspace="0.167em" xref="S4.E8.m1.10.10.2.1.1.1.2.3.cmml">⁡</mo><msub id="S4.E8.m1.10.10.2.1.1.1.2.3.2" xref="S4.E8.m1.10.10.2.1.1.1.2.3.2.cmml"><mi id="S4.E8.m1.10.10.2.1.1.1.2.3.2.2" xref="S4.E8.m1.10.10.2.1.1.1.2.3.2.2.cmml">π</mi><mi id="S4.E8.m1.10.10.2.1.1.1.2.3.2.3" xref="S4.E8.m1.10.10.2.1.1.1.2.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S4.E8.m1.10.10.2.1.1.1.2.2" xref="S4.E8.m1.10.10.2.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.E8.m1.10.10.2.1.1.1.2.1.1" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.cmml"><mo id="S4.E8.m1.10.10.2.1.1.1.2.1.1.2" stretchy="false" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.cmml"><mi id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.4" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.4.cmml">r</mi><mo fence="false" id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.3" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.3.cmml">|</mo><mrow id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.3.cmml"><mi id="S4.E8.m1.8.8" xref="S4.E8.m1.8.8.cmml">x</mi><mo id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.3" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.3.cmml">,</mo><msub id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.2" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.2.cmml">y</mi><mn id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.3" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.4" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.3.cmml">,</mo><msub id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.cmml"><mi id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.2" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.2.cmml">y</mi><mn id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.3" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.3.cmml">2</mn></msub></mrow></mrow><mo id="S4.E8.m1.10.10.2.1.1.1.2.1.1.3" stretchy="false" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E8.m1.10.10.2.1.1.3" stretchy="false" xref="S4.E8.m1.10.10.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.10b"><apply id="S4.E8.m1.10.10.cmml" xref="S4.E8.m1.10.10"><eq id="S4.E8.m1.10.10.3.cmml" xref="S4.E8.m1.10.10.3"></eq><apply id="S4.E8.m1.9.9.1.cmml" xref="S4.E8.m1.9.9.1"><times id="S4.E8.m1.9.9.1.2.cmml" xref="S4.E8.m1.9.9.1.2"></times><apply id="S4.E8.m1.9.9.1.3.cmml" xref="S4.E8.m1.9.9.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.9.9.1.3.1.cmml" xref="S4.E8.m1.9.9.1.3">subscript</csymbol><ci id="S4.E8.m1.9.9.1.3.2.cmml" xref="S4.E8.m1.9.9.1.3.2">ℒ</ci><ci id="S4.E8.m1.9.9.1.3.3a.cmml" xref="S4.E8.m1.9.9.1.3.3"><mtext id="S4.E8.m1.9.9.1.3.3.cmml" mathsize="70%" xref="S4.E8.m1.9.9.1.3.3">GenRM-Rationalization</mtext></ci></apply><apply id="S4.E8.m1.9.9.1.1.1.1.cmml" xref="S4.E8.m1.9.9.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.9.9.1.1.1.1.1.cmml" xref="S4.E8.m1.9.9.1.1.1">subscript</csymbol><ci id="S4.E8.m1.9.9.1.1.1.1.2.cmml" xref="S4.E8.m1.9.9.1.1.1.1.2">𝜋</ci><ci id="S4.E8.m1.9.9.1.1.1.1.3.cmml" xref="S4.E8.m1.9.9.1.1.1.1.3">italic-ϕ</ci></apply></apply><apply id="S4.E8.m1.10.10.2.cmml" xref="S4.E8.m1.10.10.2"><times id="S4.E8.m1.10.10.2.2.cmml" xref="S4.E8.m1.10.10.2.2"></times><apply id="S4.E8.m1.10.10.2.3.cmml" xref="S4.E8.m1.10.10.2.3"><csymbol cd="ambiguous" id="S4.E8.m1.10.10.2.3.1.cmml" xref="S4.E8.m1.10.10.2.3">subscript</csymbol><ci id="S4.E8.m1.10.10.2.3.2.cmml" xref="S4.E8.m1.10.10.2.3.2">𝔼</ci><apply id="S4.E8.m1.5.5.5.cmml" xref="S4.E8.m1.5.5.5"><csymbol cd="latexml" id="S4.E8.m1.5.5.5.6.cmml" xref="S4.E8.m1.5.5.5.6">similar-to</csymbol><vector id="S4.E8.m1.5.5.5.5.3.cmml" xref="S4.E8.m1.5.5.5.5.2"><ci id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">𝑥</ci><apply id="S4.E8.m1.4.4.4.4.1.1.cmml" xref="S4.E8.m1.4.4.4.4.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.4.4.1.1.1.cmml" xref="S4.E8.m1.4.4.4.4.1.1">subscript</csymbol><ci id="S4.E8.m1.4.4.4.4.1.1.2.cmml" xref="S4.E8.m1.4.4.4.4.1.1.2">𝑦</ci><cn id="S4.E8.m1.4.4.4.4.1.1.3.cmml" type="integer" xref="S4.E8.m1.4.4.4.4.1.1.3">1</cn></apply><apply id="S4.E8.m1.5.5.5.5.2.2.cmml" xref="S4.E8.m1.5.5.5.5.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.5.5.2.2.1.cmml" xref="S4.E8.m1.5.5.5.5.2.2">subscript</csymbol><ci id="S4.E8.m1.5.5.5.5.2.2.2.cmml" xref="S4.E8.m1.5.5.5.5.2.2.2">𝑦</ci><cn id="S4.E8.m1.5.5.5.5.2.2.3.cmml" type="integer" xref="S4.E8.m1.5.5.5.5.2.2.3">2</cn></apply><ci id="S4.E8.m1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2">𝑟</ci><ci id="S4.E8.m1.3.3.3.3.cmml" xref="S4.E8.m1.3.3.3.3">𝐼</ci></vector><ci id="S4.E8.m1.5.5.5.7.cmml" xref="S4.E8.m1.5.5.5.7">𝒟</ci></apply></apply><apply id="S4.E8.m1.10.10.2.1.2.cmml" xref="S4.E8.m1.10.10.2.1.1"><csymbol cd="latexml" id="S4.E8.m1.10.10.2.1.2.1.cmml" xref="S4.E8.m1.10.10.2.1.1.2">delimited-[]</csymbol><apply id="S4.E8.m1.10.10.2.1.1.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1"><minus id="S4.E8.m1.10.10.2.1.1.1.3.cmml" xref="S4.E8.m1.10.10.2.1.1.1.3"></minus><apply id="S4.E8.m1.10.10.2.1.1.1.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1"><minus id="S4.E8.m1.10.10.2.1.1.1.1.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1"></minus><apply id="S4.E8.m1.10.10.2.1.1.1.1.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1"><times id="S4.E8.m1.10.10.2.1.1.1.1.1.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.2"></times><apply id="S4.E8.m1.10.10.2.1.1.1.1.1.3.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3"><log id="S4.E8.m1.10.10.2.1.1.1.1.1.3.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.1"></log><apply id="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.2">𝜋</ci><ci id="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.3.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.3.2.3">italic-ϕ</ci></apply></apply><apply id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.3">conditional</csymbol><ci id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.4">𝐼</ci><list id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2"><ci id="S4.E8.m1.6.6.cmml" xref="S4.E8.m1.6.6">𝑥</ci><apply id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><cn id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><cn id="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S4.E8.m1.10.10.2.1.1.1.1.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S4.E8.m1.7.7.cmml" xref="S4.E8.m1.7.7">𝑟</ci></list></apply></apply></apply><apply id="S4.E8.m1.10.10.2.1.1.1.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2"><times id="S4.E8.m1.10.10.2.1.1.1.2.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.2"></times><apply id="S4.E8.m1.10.10.2.1.1.1.2.3.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.3"><log id="S4.E8.m1.10.10.2.1.1.1.2.3.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.3.1"></log><apply id="S4.E8.m1.10.10.2.1.1.1.2.3.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E8.m1.10.10.2.1.1.1.2.3.2.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.3.2">subscript</csymbol><ci id="S4.E8.m1.10.10.2.1.1.1.2.3.2.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.3.2.2">𝜋</ci><ci id="S4.E8.m1.10.10.2.1.1.1.2.3.2.3.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.3.2.3">italic-ϕ</ci></apply></apply><apply id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1"><csymbol cd="latexml" id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.3.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.3">conditional</csymbol><ci id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.4.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.4">𝑟</ci><list id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.3.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2"><ci id="S4.E8.m1.8.8.cmml" xref="S4.E8.m1.8.8">𝑥</ci><apply id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.2">𝑦</ci><cn id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.1.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.2">𝑦</ci><cn id="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.3.cmml" type="integer" xref="S4.E8.m1.10.10.2.1.1.1.2.1.1.1.2.2.2.3">2</cn></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.10c">\mathcal{L}_{\text{GenRM-Rationalization}}(\pi_{\phi})=\mathbb{E}_{(x,y_{1},y_%
{2},r,I)\sim\mathcal{D}}[-\log\pi_{\phi}(I|x,y_{1},y_{2},r)-\log\pi_{\phi}(r|x%
,y_{1},y_{2})]</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.10d">caligraphic_L start_POSTSUBSCRIPT GenRM-Rationalization end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ) = blackboard_E start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_r , italic_I ) ∼ caligraphic_D end_POSTSUBSCRIPT [ - roman_log italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_I | italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_r ) - roman_log italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_r | italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p5.2">we refer to this as a post-rationalization approach, similar to the approach described in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS2.SSS2" title="2.2.2 Post-Rationalization ‣ 2.2 Self-Taught Reasoner ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">2.2.2</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p6">
<p class="ltx_p" id="S4.p6.1"><span class="ltx_text ltx_font_bold" id="S4.p6.1.1">CoT-GenRM-STaR:</span> Finally we consider an approach where the model self-bootstraps intermediate reasoning using a STaR approach as outlined in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S2.SS2.SSS1" title="2.2.1 Rationale Generation Bootstrapping ‣ 2.2 Self-Taught Reasoner ‣ 2 Preliminaries ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">2.2.1</span></a>. We will also consider two loss objectives here—following the filtering strategy described in the above section, we use the standard SFT loss similar to Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S4.E8" title="In 4 Generative Reward Models: A Unified RLHF-RLAIF Approach ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">8</span></a> on reasoning chains that yield the correct judgement. We denote models trained with this objective as STaR-SFT.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p7">
<p class="ltx_p" id="S4.p7.5">Alternatively, we would like to utilize all the sampled data, including reasoning chains that yield wrong judgments. Similar to the reasoning approach in <cite class="ltx_cite ltx_citemacro_cite">Pang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib30" title="">2024</a>)</cite> we create a dataset of preference pairs <math alttext="\mathcal{D}=\{x^{(i)},y_{1}^{(i)},y_{2}^{(i)},r_{w}^{(i)},I_{w}^{(i)},r_{l}^{(%
i)},I_{l}^{(i)}\}" class="ltx_Math" display="inline" id="S4.p7.1.m1.14"><semantics id="S4.p7.1.m1.14a"><mrow id="S4.p7.1.m1.14.14" xref="S4.p7.1.m1.14.14.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p7.1.m1.14.14.9" xref="S4.p7.1.m1.14.14.9.cmml">𝒟</mi><mo id="S4.p7.1.m1.14.14.8" xref="S4.p7.1.m1.14.14.8.cmml">=</mo><mrow id="S4.p7.1.m1.14.14.7.7" xref="S4.p7.1.m1.14.14.7.8.cmml"><mo id="S4.p7.1.m1.14.14.7.7.8" stretchy="false" xref="S4.p7.1.m1.14.14.7.8.cmml">{</mo><msup id="S4.p7.1.m1.8.8.1.1.1" xref="S4.p7.1.m1.8.8.1.1.1.cmml"><mi id="S4.p7.1.m1.8.8.1.1.1.2" xref="S4.p7.1.m1.8.8.1.1.1.2.cmml">x</mi><mrow id="S4.p7.1.m1.1.1.1.3" xref="S4.p7.1.m1.8.8.1.1.1.cmml"><mo id="S4.p7.1.m1.1.1.1.3.1" stretchy="false" xref="S4.p7.1.m1.8.8.1.1.1.cmml">(</mo><mi id="S4.p7.1.m1.1.1.1.1" xref="S4.p7.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.p7.1.m1.1.1.1.3.2" stretchy="false" xref="S4.p7.1.m1.8.8.1.1.1.cmml">)</mo></mrow></msup><mo id="S4.p7.1.m1.14.14.7.7.9" xref="S4.p7.1.m1.14.14.7.8.cmml">,</mo><msubsup id="S4.p7.1.m1.9.9.2.2.2" xref="S4.p7.1.m1.9.9.2.2.2.cmml"><mi id="S4.p7.1.m1.9.9.2.2.2.2.2" xref="S4.p7.1.m1.9.9.2.2.2.2.2.cmml">y</mi><mn id="S4.p7.1.m1.9.9.2.2.2.2.3" xref="S4.p7.1.m1.9.9.2.2.2.2.3.cmml">1</mn><mrow id="S4.p7.1.m1.2.2.1.3" xref="S4.p7.1.m1.9.9.2.2.2.cmml"><mo id="S4.p7.1.m1.2.2.1.3.1" stretchy="false" xref="S4.p7.1.m1.9.9.2.2.2.cmml">(</mo><mi id="S4.p7.1.m1.2.2.1.1" xref="S4.p7.1.m1.2.2.1.1.cmml">i</mi><mo id="S4.p7.1.m1.2.2.1.3.2" stretchy="false" xref="S4.p7.1.m1.9.9.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.p7.1.m1.14.14.7.7.10" xref="S4.p7.1.m1.14.14.7.8.cmml">,</mo><msubsup id="S4.p7.1.m1.10.10.3.3.3" xref="S4.p7.1.m1.10.10.3.3.3.cmml"><mi id="S4.p7.1.m1.10.10.3.3.3.2.2" xref="S4.p7.1.m1.10.10.3.3.3.2.2.cmml">y</mi><mn id="S4.p7.1.m1.10.10.3.3.3.2.3" xref="S4.p7.1.m1.10.10.3.3.3.2.3.cmml">2</mn><mrow id="S4.p7.1.m1.3.3.1.3" xref="S4.p7.1.m1.10.10.3.3.3.cmml"><mo id="S4.p7.1.m1.3.3.1.3.1" stretchy="false" xref="S4.p7.1.m1.10.10.3.3.3.cmml">(</mo><mi id="S4.p7.1.m1.3.3.1.1" xref="S4.p7.1.m1.3.3.1.1.cmml">i</mi><mo id="S4.p7.1.m1.3.3.1.3.2" stretchy="false" xref="S4.p7.1.m1.10.10.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S4.p7.1.m1.14.14.7.7.11" xref="S4.p7.1.m1.14.14.7.8.cmml">,</mo><msubsup id="S4.p7.1.m1.11.11.4.4.4" xref="S4.p7.1.m1.11.11.4.4.4.cmml"><mi id="S4.p7.1.m1.11.11.4.4.4.2.2" xref="S4.p7.1.m1.11.11.4.4.4.2.2.cmml">r</mi><mi id="S4.p7.1.m1.11.11.4.4.4.2.3" xref="S4.p7.1.m1.11.11.4.4.4.2.3.cmml">w</mi><mrow id="S4.p7.1.m1.4.4.1.3" xref="S4.p7.1.m1.11.11.4.4.4.cmml"><mo id="S4.p7.1.m1.4.4.1.3.1" stretchy="false" xref="S4.p7.1.m1.11.11.4.4.4.cmml">(</mo><mi id="S4.p7.1.m1.4.4.1.1" xref="S4.p7.1.m1.4.4.1.1.cmml">i</mi><mo id="S4.p7.1.m1.4.4.1.3.2" stretchy="false" xref="S4.p7.1.m1.11.11.4.4.4.cmml">)</mo></mrow></msubsup><mo id="S4.p7.1.m1.14.14.7.7.12" xref="S4.p7.1.m1.14.14.7.8.cmml">,</mo><msubsup id="S4.p7.1.m1.12.12.5.5.5" xref="S4.p7.1.m1.12.12.5.5.5.cmml"><mi id="S4.p7.1.m1.12.12.5.5.5.2.2" xref="S4.p7.1.m1.12.12.5.5.5.2.2.cmml">I</mi><mi id="S4.p7.1.m1.12.12.5.5.5.2.3" xref="S4.p7.1.m1.12.12.5.5.5.2.3.cmml">w</mi><mrow id="S4.p7.1.m1.5.5.1.3" xref="S4.p7.1.m1.12.12.5.5.5.cmml"><mo id="S4.p7.1.m1.5.5.1.3.1" stretchy="false" xref="S4.p7.1.m1.12.12.5.5.5.cmml">(</mo><mi id="S4.p7.1.m1.5.5.1.1" xref="S4.p7.1.m1.5.5.1.1.cmml">i</mi><mo id="S4.p7.1.m1.5.5.1.3.2" stretchy="false" xref="S4.p7.1.m1.12.12.5.5.5.cmml">)</mo></mrow></msubsup><mo id="S4.p7.1.m1.14.14.7.7.13" xref="S4.p7.1.m1.14.14.7.8.cmml">,</mo><msubsup id="S4.p7.1.m1.13.13.6.6.6" xref="S4.p7.1.m1.13.13.6.6.6.cmml"><mi id="S4.p7.1.m1.13.13.6.6.6.2.2" xref="S4.p7.1.m1.13.13.6.6.6.2.2.cmml">r</mi><mi id="S4.p7.1.m1.13.13.6.6.6.2.3" xref="S4.p7.1.m1.13.13.6.6.6.2.3.cmml">l</mi><mrow id="S4.p7.1.m1.6.6.1.3" xref="S4.p7.1.m1.13.13.6.6.6.cmml"><mo id="S4.p7.1.m1.6.6.1.3.1" stretchy="false" xref="S4.p7.1.m1.13.13.6.6.6.cmml">(</mo><mi id="S4.p7.1.m1.6.6.1.1" xref="S4.p7.1.m1.6.6.1.1.cmml">i</mi><mo id="S4.p7.1.m1.6.6.1.3.2" stretchy="false" xref="S4.p7.1.m1.13.13.6.6.6.cmml">)</mo></mrow></msubsup><mo id="S4.p7.1.m1.14.14.7.7.14" xref="S4.p7.1.m1.14.14.7.8.cmml">,</mo><msubsup id="S4.p7.1.m1.14.14.7.7.7" xref="S4.p7.1.m1.14.14.7.7.7.cmml"><mi id="S4.p7.1.m1.14.14.7.7.7.2.2" xref="S4.p7.1.m1.14.14.7.7.7.2.2.cmml">I</mi><mi id="S4.p7.1.m1.14.14.7.7.7.2.3" xref="S4.p7.1.m1.14.14.7.7.7.2.3.cmml">l</mi><mrow id="S4.p7.1.m1.7.7.1.3" xref="S4.p7.1.m1.14.14.7.7.7.cmml"><mo id="S4.p7.1.m1.7.7.1.3.1" stretchy="false" xref="S4.p7.1.m1.14.14.7.7.7.cmml">(</mo><mi id="S4.p7.1.m1.7.7.1.1" xref="S4.p7.1.m1.7.7.1.1.cmml">i</mi><mo id="S4.p7.1.m1.7.7.1.3.2" stretchy="false" xref="S4.p7.1.m1.14.14.7.7.7.cmml">)</mo></mrow></msubsup><mo id="S4.p7.1.m1.14.14.7.7.15" stretchy="false" xref="S4.p7.1.m1.14.14.7.8.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p7.1.m1.14b"><apply id="S4.p7.1.m1.14.14.cmml" xref="S4.p7.1.m1.14.14"><eq id="S4.p7.1.m1.14.14.8.cmml" xref="S4.p7.1.m1.14.14.8"></eq><ci id="S4.p7.1.m1.14.14.9.cmml" xref="S4.p7.1.m1.14.14.9">𝒟</ci><set id="S4.p7.1.m1.14.14.7.8.cmml" xref="S4.p7.1.m1.14.14.7.7"><apply id="S4.p7.1.m1.8.8.1.1.1.cmml" xref="S4.p7.1.m1.8.8.1.1.1"><csymbol cd="ambiguous" id="S4.p7.1.m1.8.8.1.1.1.1.cmml" xref="S4.p7.1.m1.8.8.1.1.1">superscript</csymbol><ci id="S4.p7.1.m1.8.8.1.1.1.2.cmml" xref="S4.p7.1.m1.8.8.1.1.1.2">𝑥</ci><ci id="S4.p7.1.m1.1.1.1.1.cmml" xref="S4.p7.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S4.p7.1.m1.9.9.2.2.2.cmml" xref="S4.p7.1.m1.9.9.2.2.2"><csymbol cd="ambiguous" id="S4.p7.1.m1.9.9.2.2.2.1.cmml" xref="S4.p7.1.m1.9.9.2.2.2">superscript</csymbol><apply id="S4.p7.1.m1.9.9.2.2.2.2.cmml" xref="S4.p7.1.m1.9.9.2.2.2"><csymbol cd="ambiguous" id="S4.p7.1.m1.9.9.2.2.2.2.1.cmml" xref="S4.p7.1.m1.9.9.2.2.2">subscript</csymbol><ci id="S4.p7.1.m1.9.9.2.2.2.2.2.cmml" xref="S4.p7.1.m1.9.9.2.2.2.2.2">𝑦</ci><cn id="S4.p7.1.m1.9.9.2.2.2.2.3.cmml" type="integer" xref="S4.p7.1.m1.9.9.2.2.2.2.3">1</cn></apply><ci id="S4.p7.1.m1.2.2.1.1.cmml" xref="S4.p7.1.m1.2.2.1.1">𝑖</ci></apply><apply id="S4.p7.1.m1.10.10.3.3.3.cmml" xref="S4.p7.1.m1.10.10.3.3.3"><csymbol cd="ambiguous" id="S4.p7.1.m1.10.10.3.3.3.1.cmml" xref="S4.p7.1.m1.10.10.3.3.3">superscript</csymbol><apply id="S4.p7.1.m1.10.10.3.3.3.2.cmml" xref="S4.p7.1.m1.10.10.3.3.3"><csymbol cd="ambiguous" id="S4.p7.1.m1.10.10.3.3.3.2.1.cmml" xref="S4.p7.1.m1.10.10.3.3.3">subscript</csymbol><ci id="S4.p7.1.m1.10.10.3.3.3.2.2.cmml" xref="S4.p7.1.m1.10.10.3.3.3.2.2">𝑦</ci><cn id="S4.p7.1.m1.10.10.3.3.3.2.3.cmml" type="integer" xref="S4.p7.1.m1.10.10.3.3.3.2.3">2</cn></apply><ci id="S4.p7.1.m1.3.3.1.1.cmml" xref="S4.p7.1.m1.3.3.1.1">𝑖</ci></apply><apply id="S4.p7.1.m1.11.11.4.4.4.cmml" xref="S4.p7.1.m1.11.11.4.4.4"><csymbol cd="ambiguous" id="S4.p7.1.m1.11.11.4.4.4.1.cmml" xref="S4.p7.1.m1.11.11.4.4.4">superscript</csymbol><apply id="S4.p7.1.m1.11.11.4.4.4.2.cmml" xref="S4.p7.1.m1.11.11.4.4.4"><csymbol cd="ambiguous" id="S4.p7.1.m1.11.11.4.4.4.2.1.cmml" xref="S4.p7.1.m1.11.11.4.4.4">subscript</csymbol><ci id="S4.p7.1.m1.11.11.4.4.4.2.2.cmml" xref="S4.p7.1.m1.11.11.4.4.4.2.2">𝑟</ci><ci id="S4.p7.1.m1.11.11.4.4.4.2.3.cmml" xref="S4.p7.1.m1.11.11.4.4.4.2.3">𝑤</ci></apply><ci id="S4.p7.1.m1.4.4.1.1.cmml" xref="S4.p7.1.m1.4.4.1.1">𝑖</ci></apply><apply id="S4.p7.1.m1.12.12.5.5.5.cmml" xref="S4.p7.1.m1.12.12.5.5.5"><csymbol cd="ambiguous" id="S4.p7.1.m1.12.12.5.5.5.1.cmml" xref="S4.p7.1.m1.12.12.5.5.5">superscript</csymbol><apply id="S4.p7.1.m1.12.12.5.5.5.2.cmml" xref="S4.p7.1.m1.12.12.5.5.5"><csymbol cd="ambiguous" id="S4.p7.1.m1.12.12.5.5.5.2.1.cmml" xref="S4.p7.1.m1.12.12.5.5.5">subscript</csymbol><ci id="S4.p7.1.m1.12.12.5.5.5.2.2.cmml" xref="S4.p7.1.m1.12.12.5.5.5.2.2">𝐼</ci><ci id="S4.p7.1.m1.12.12.5.5.5.2.3.cmml" xref="S4.p7.1.m1.12.12.5.5.5.2.3">𝑤</ci></apply><ci id="S4.p7.1.m1.5.5.1.1.cmml" xref="S4.p7.1.m1.5.5.1.1">𝑖</ci></apply><apply id="S4.p7.1.m1.13.13.6.6.6.cmml" xref="S4.p7.1.m1.13.13.6.6.6"><csymbol cd="ambiguous" id="S4.p7.1.m1.13.13.6.6.6.1.cmml" xref="S4.p7.1.m1.13.13.6.6.6">superscript</csymbol><apply id="S4.p7.1.m1.13.13.6.6.6.2.cmml" xref="S4.p7.1.m1.13.13.6.6.6"><csymbol cd="ambiguous" id="S4.p7.1.m1.13.13.6.6.6.2.1.cmml" xref="S4.p7.1.m1.13.13.6.6.6">subscript</csymbol><ci id="S4.p7.1.m1.13.13.6.6.6.2.2.cmml" xref="S4.p7.1.m1.13.13.6.6.6.2.2">𝑟</ci><ci id="S4.p7.1.m1.13.13.6.6.6.2.3.cmml" xref="S4.p7.1.m1.13.13.6.6.6.2.3">𝑙</ci></apply><ci id="S4.p7.1.m1.6.6.1.1.cmml" xref="S4.p7.1.m1.6.6.1.1">𝑖</ci></apply><apply id="S4.p7.1.m1.14.14.7.7.7.cmml" xref="S4.p7.1.m1.14.14.7.7.7"><csymbol cd="ambiguous" id="S4.p7.1.m1.14.14.7.7.7.1.cmml" xref="S4.p7.1.m1.14.14.7.7.7">superscript</csymbol><apply id="S4.p7.1.m1.14.14.7.7.7.2.cmml" xref="S4.p7.1.m1.14.14.7.7.7"><csymbol cd="ambiguous" id="S4.p7.1.m1.14.14.7.7.7.2.1.cmml" xref="S4.p7.1.m1.14.14.7.7.7">subscript</csymbol><ci id="S4.p7.1.m1.14.14.7.7.7.2.2.cmml" xref="S4.p7.1.m1.14.14.7.7.7.2.2">𝐼</ci><ci id="S4.p7.1.m1.14.14.7.7.7.2.3.cmml" xref="S4.p7.1.m1.14.14.7.7.7.2.3">𝑙</ci></apply><ci id="S4.p7.1.m1.7.7.1.1.cmml" xref="S4.p7.1.m1.7.7.1.1">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.1.m1.14c">\mathcal{D}=\{x^{(i)},y_{1}^{(i)},y_{2}^{(i)},r_{w}^{(i)},I_{w}^{(i)},r_{l}^{(%
i)},I_{l}^{(i)}\}</annotation><annotation encoding="application/x-llamapun" id="S4.p7.1.m1.14d">caligraphic_D = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_I start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_I start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT }</annotation></semantics></math>, where <math alttext="r_{w}" class="ltx_Math" display="inline" id="S4.p7.2.m2.1"><semantics id="S4.p7.2.m2.1a"><msub id="S4.p7.2.m2.1.1" xref="S4.p7.2.m2.1.1.cmml"><mi id="S4.p7.2.m2.1.1.2" xref="S4.p7.2.m2.1.1.2.cmml">r</mi><mi id="S4.p7.2.m2.1.1.3" xref="S4.p7.2.m2.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p7.2.m2.1b"><apply id="S4.p7.2.m2.1.1.cmml" xref="S4.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p7.2.m2.1.1.1.cmml" xref="S4.p7.2.m2.1.1">subscript</csymbol><ci id="S4.p7.2.m2.1.1.2.cmml" xref="S4.p7.2.m2.1.1.2">𝑟</ci><ci id="S4.p7.2.m2.1.1.3.cmml" xref="S4.p7.2.m2.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.2.m2.1c">r_{w}</annotation><annotation encoding="application/x-llamapun" id="S4.p7.2.m2.1d">italic_r start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> are rationales that lead to correct rankings <math alttext="I_{w}" class="ltx_Math" display="inline" id="S4.p7.3.m3.1"><semantics id="S4.p7.3.m3.1a"><msub id="S4.p7.3.m3.1.1" xref="S4.p7.3.m3.1.1.cmml"><mi id="S4.p7.3.m3.1.1.2" xref="S4.p7.3.m3.1.1.2.cmml">I</mi><mi id="S4.p7.3.m3.1.1.3" xref="S4.p7.3.m3.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p7.3.m3.1b"><apply id="S4.p7.3.m3.1.1.cmml" xref="S4.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p7.3.m3.1.1.1.cmml" xref="S4.p7.3.m3.1.1">subscript</csymbol><ci id="S4.p7.3.m3.1.1.2.cmml" xref="S4.p7.3.m3.1.1.2">𝐼</ci><ci id="S4.p7.3.m3.1.1.3.cmml" xref="S4.p7.3.m3.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.3.m3.1c">I_{w}</annotation><annotation encoding="application/x-llamapun" id="S4.p7.3.m3.1d">italic_I start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="r_{l}" class="ltx_Math" display="inline" id="S4.p7.4.m4.1"><semantics id="S4.p7.4.m4.1a"><msub id="S4.p7.4.m4.1.1" xref="S4.p7.4.m4.1.1.cmml"><mi id="S4.p7.4.m4.1.1.2" xref="S4.p7.4.m4.1.1.2.cmml">r</mi><mi id="S4.p7.4.m4.1.1.3" xref="S4.p7.4.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p7.4.m4.1b"><apply id="S4.p7.4.m4.1.1.cmml" xref="S4.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p7.4.m4.1.1.1.cmml" xref="S4.p7.4.m4.1.1">subscript</csymbol><ci id="S4.p7.4.m4.1.1.2.cmml" xref="S4.p7.4.m4.1.1.2">𝑟</ci><ci id="S4.p7.4.m4.1.1.3.cmml" xref="S4.p7.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.4.m4.1c">r_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.p7.4.m4.1d">italic_r start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> are rationales that lead to incorrect rankings <math alttext="I_{l}" class="ltx_Math" display="inline" id="S4.p7.5.m5.1"><semantics id="S4.p7.5.m5.1a"><msub id="S4.p7.5.m5.1.1" xref="S4.p7.5.m5.1.1.cmml"><mi id="S4.p7.5.m5.1.1.2" xref="S4.p7.5.m5.1.1.2.cmml">I</mi><mi id="S4.p7.5.m5.1.1.3" xref="S4.p7.5.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p7.5.m5.1b"><apply id="S4.p7.5.m5.1.1.cmml" xref="S4.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p7.5.m5.1.1.1.cmml" xref="S4.p7.5.m5.1.1">subscript</csymbol><ci id="S4.p7.5.m5.1.1.2.cmml" xref="S4.p7.5.m5.1.1.2">𝐼</ci><ci id="S4.p7.5.m5.1.1.3.cmml" xref="S4.p7.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.5.m5.1c">I_{l}</annotation><annotation encoding="application/x-llamapun" id="S4.p7.5.m5.1d">italic_I start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>. We then use a DPO optimization objective of the form:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{GenRM-DPO}}(\pi_{\phi})=\mathbb{E}_{\mathcal{D}}\left[\log%
\sigma\left(\beta\log\frac{\pi_{\phi}(I_{w},r_{w}|x,y_{1},y_{2})}{\pi_{\text{%
ref}}(I_{w},r_{w}|x,y_{1},y_{2})}-\beta\log\frac{\pi_{\phi}(I_{l},r_{l}|x,y_{1%
},y_{2})}{\pi_{\text{ref}}(I_{l},r_{l}|x,y_{1},y_{2})}\right)\right]." class="ltx_Math" display="block" id="S4.E9.m1.13"><semantics id="S4.E9.m1.13a"><mrow id="S4.E9.m1.13.13.1" xref="S4.E9.m1.13.13.1.1.cmml"><mrow id="S4.E9.m1.13.13.1.1" xref="S4.E9.m1.13.13.1.1.cmml"><mrow id="S4.E9.m1.13.13.1.1.1" xref="S4.E9.m1.13.13.1.1.1.cmml"><msub id="S4.E9.m1.13.13.1.1.1.3" xref="S4.E9.m1.13.13.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.13.13.1.1.1.3.2" xref="S4.E9.m1.13.13.1.1.1.3.2.cmml">ℒ</mi><mtext id="S4.E9.m1.13.13.1.1.1.3.3" xref="S4.E9.m1.13.13.1.1.1.3.3a.cmml">GenRM-DPO</mtext></msub><mo id="S4.E9.m1.13.13.1.1.1.2" xref="S4.E9.m1.13.13.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.13.13.1.1.1.1.1" xref="S4.E9.m1.13.13.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.13.13.1.1.1.1.1.2" stretchy="false" xref="S4.E9.m1.13.13.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E9.m1.13.13.1.1.1.1.1.1" xref="S4.E9.m1.13.13.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.13.13.1.1.1.1.1.1.2" xref="S4.E9.m1.13.13.1.1.1.1.1.1.2.cmml">π</mi><mi id="S4.E9.m1.13.13.1.1.1.1.1.1.3" xref="S4.E9.m1.13.13.1.1.1.1.1.1.3.cmml">ϕ</mi></msub><mo id="S4.E9.m1.13.13.1.1.1.1.1.3" stretchy="false" xref="S4.E9.m1.13.13.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.13.13.1.1.3" xref="S4.E9.m1.13.13.1.1.3.cmml">=</mo><mrow id="S4.E9.m1.13.13.1.1.2" xref="S4.E9.m1.13.13.1.1.2.cmml"><msub id="S4.E9.m1.13.13.1.1.2.3" xref="S4.E9.m1.13.13.1.1.2.3.cmml"><mi id="S4.E9.m1.13.13.1.1.2.3.2" xref="S4.E9.m1.13.13.1.1.2.3.2.cmml">𝔼</mi><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.13.13.1.1.2.3.3" xref="S4.E9.m1.13.13.1.1.2.3.3.cmml">𝒟</mi></msub><mo id="S4.E9.m1.13.13.1.1.2.2" xref="S4.E9.m1.13.13.1.1.2.2.cmml">⁢</mo><mrow id="S4.E9.m1.13.13.1.1.2.1.1" xref="S4.E9.m1.13.13.1.1.2.1.2.cmml"><mo id="S4.E9.m1.13.13.1.1.2.1.1.2" xref="S4.E9.m1.13.13.1.1.2.1.2.1.cmml">[</mo><mrow id="S4.E9.m1.13.13.1.1.2.1.1.1" xref="S4.E9.m1.13.13.1.1.2.1.1.1.cmml"><mrow id="S4.E9.m1.13.13.1.1.2.1.1.1.3" xref="S4.E9.m1.13.13.1.1.2.1.1.1.3.cmml"><mi id="S4.E9.m1.13.13.1.1.2.1.1.1.3.1" xref="S4.E9.m1.13.13.1.1.2.1.1.1.3.1.cmml">log</mi><mo id="S4.E9.m1.13.13.1.1.2.1.1.1.3a" lspace="0.167em" xref="S4.E9.m1.13.13.1.1.2.1.1.1.3.cmml">⁡</mo><mi id="S4.E9.m1.13.13.1.1.2.1.1.1.3.2" xref="S4.E9.m1.13.13.1.1.2.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S4.E9.m1.13.13.1.1.2.1.1.1.2" xref="S4.E9.m1.13.13.1.1.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.cmml"><mo id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.2" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.cmml"><mi id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.2" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.2.cmml">β</mi><mo id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.1" lspace="0.167em" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.1.cmml">⁢</mo><mrow id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.3" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.3.1" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.3a" lspace="0.167em" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.3.cmml">⁡</mo><mfrac id="S4.E9.m1.6.6" xref="S4.E9.m1.6.6.cmml"><mrow id="S4.E9.m1.3.3.3" xref="S4.E9.m1.3.3.3.cmml"><msub id="S4.E9.m1.3.3.3.5" xref="S4.E9.m1.3.3.3.5.cmml"><mi id="S4.E9.m1.3.3.3.5.2" xref="S4.E9.m1.3.3.3.5.2.cmml">π</mi><mi id="S4.E9.m1.3.3.3.5.3" xref="S4.E9.m1.3.3.3.5.3.cmml">ϕ</mi></msub><mo id="S4.E9.m1.3.3.3.4" xref="S4.E9.m1.3.3.3.4.cmml">⁢</mo><mrow id="S4.E9.m1.3.3.3.3.2" xref="S4.E9.m1.3.3.3.3.3.cmml"><mo id="S4.E9.m1.3.3.3.3.2.3" stretchy="false" xref="S4.E9.m1.3.3.3.3.3.cmml">(</mo><msub id="S4.E9.m1.2.2.2.2.1.1" xref="S4.E9.m1.2.2.2.2.1.1.cmml"><mi id="S4.E9.m1.2.2.2.2.1.1.2" xref="S4.E9.m1.2.2.2.2.1.1.2.cmml">I</mi><mi id="S4.E9.m1.2.2.2.2.1.1.3" xref="S4.E9.m1.2.2.2.2.1.1.3.cmml">w</mi></msub><mo id="S4.E9.m1.3.3.3.3.2.4" xref="S4.E9.m1.3.3.3.3.3.cmml">,</mo><mrow id="S4.E9.m1.3.3.3.3.2.2" xref="S4.E9.m1.3.3.3.3.2.2.cmml"><msub id="S4.E9.m1.3.3.3.3.2.2.4" xref="S4.E9.m1.3.3.3.3.2.2.4.cmml"><mi id="S4.E9.m1.3.3.3.3.2.2.4.2" xref="S4.E9.m1.3.3.3.3.2.2.4.2.cmml">r</mi><mi id="S4.E9.m1.3.3.3.3.2.2.4.3" xref="S4.E9.m1.3.3.3.3.2.2.4.3.cmml">w</mi></msub><mo fence="false" id="S4.E9.m1.3.3.3.3.2.2.3" xref="S4.E9.m1.3.3.3.3.2.2.3.cmml">|</mo><mrow id="S4.E9.m1.3.3.3.3.2.2.2.2" xref="S4.E9.m1.3.3.3.3.2.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">x</mi><mo id="S4.E9.m1.3.3.3.3.2.2.2.2.3" xref="S4.E9.m1.3.3.3.3.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.3.3.3.3.2.2.1.1.1" xref="S4.E9.m1.3.3.3.3.2.2.1.1.1.cmml"><mi id="S4.E9.m1.3.3.3.3.2.2.1.1.1.2" xref="S4.E9.m1.3.3.3.3.2.2.1.1.1.2.cmml">y</mi><mn id="S4.E9.m1.3.3.3.3.2.2.1.1.1.3" xref="S4.E9.m1.3.3.3.3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.E9.m1.3.3.3.3.2.2.2.2.4" xref="S4.E9.m1.3.3.3.3.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.3.3.3.3.2.2.2.2.2" xref="S4.E9.m1.3.3.3.3.2.2.2.2.2.cmml"><mi id="S4.E9.m1.3.3.3.3.2.2.2.2.2.2" xref="S4.E9.m1.3.3.3.3.2.2.2.2.2.2.cmml">y</mi><mn id="S4.E9.m1.3.3.3.3.2.2.2.2.2.3" xref="S4.E9.m1.3.3.3.3.2.2.2.2.2.3.cmml">2</mn></msub></mrow></mrow><mo id="S4.E9.m1.3.3.3.3.2.5" stretchy="false" xref="S4.E9.m1.3.3.3.3.3.cmml">)</mo></mrow></mrow><mrow id="S4.E9.m1.6.6.6" xref="S4.E9.m1.6.6.6.cmml"><msub id="S4.E9.m1.6.6.6.5" xref="S4.E9.m1.6.6.6.5.cmml"><mi id="S4.E9.m1.6.6.6.5.2" xref="S4.E9.m1.6.6.6.5.2.cmml">π</mi><mtext id="S4.E9.m1.6.6.6.5.3" xref="S4.E9.m1.6.6.6.5.3a.cmml">ref</mtext></msub><mo id="S4.E9.m1.6.6.6.4" xref="S4.E9.m1.6.6.6.4.cmml">⁢</mo><mrow id="S4.E9.m1.6.6.6.3.2" xref="S4.E9.m1.6.6.6.3.3.cmml"><mo id="S4.E9.m1.6.6.6.3.2.3" stretchy="false" xref="S4.E9.m1.6.6.6.3.3.cmml">(</mo><msub id="S4.E9.m1.5.5.5.2.1.1" xref="S4.E9.m1.5.5.5.2.1.1.cmml"><mi id="S4.E9.m1.5.5.5.2.1.1.2" xref="S4.E9.m1.5.5.5.2.1.1.2.cmml">I</mi><mi id="S4.E9.m1.5.5.5.2.1.1.3" xref="S4.E9.m1.5.5.5.2.1.1.3.cmml">w</mi></msub><mo id="S4.E9.m1.6.6.6.3.2.4" xref="S4.E9.m1.6.6.6.3.3.cmml">,</mo><mrow id="S4.E9.m1.6.6.6.3.2.2" xref="S4.E9.m1.6.6.6.3.2.2.cmml"><msub id="S4.E9.m1.6.6.6.3.2.2.4" xref="S4.E9.m1.6.6.6.3.2.2.4.cmml"><mi id="S4.E9.m1.6.6.6.3.2.2.4.2" xref="S4.E9.m1.6.6.6.3.2.2.4.2.cmml">r</mi><mi id="S4.E9.m1.6.6.6.3.2.2.4.3" xref="S4.E9.m1.6.6.6.3.2.2.4.3.cmml">w</mi></msub><mo fence="false" id="S4.E9.m1.6.6.6.3.2.2.3" xref="S4.E9.m1.6.6.6.3.2.2.3.cmml">|</mo><mrow id="S4.E9.m1.6.6.6.3.2.2.2.2" xref="S4.E9.m1.6.6.6.3.2.2.2.3.cmml"><mi id="S4.E9.m1.4.4.4.1" xref="S4.E9.m1.4.4.4.1.cmml">x</mi><mo id="S4.E9.m1.6.6.6.3.2.2.2.2.3" xref="S4.E9.m1.6.6.6.3.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.6.6.6.3.2.2.1.1.1" xref="S4.E9.m1.6.6.6.3.2.2.1.1.1.cmml"><mi id="S4.E9.m1.6.6.6.3.2.2.1.1.1.2" xref="S4.E9.m1.6.6.6.3.2.2.1.1.1.2.cmml">y</mi><mn id="S4.E9.m1.6.6.6.3.2.2.1.1.1.3" xref="S4.E9.m1.6.6.6.3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.E9.m1.6.6.6.3.2.2.2.2.4" xref="S4.E9.m1.6.6.6.3.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.6.6.6.3.2.2.2.2.2" xref="S4.E9.m1.6.6.6.3.2.2.2.2.2.cmml"><mi id="S4.E9.m1.6.6.6.3.2.2.2.2.2.2" xref="S4.E9.m1.6.6.6.3.2.2.2.2.2.2.cmml">y</mi><mn id="S4.E9.m1.6.6.6.3.2.2.2.2.2.3" xref="S4.E9.m1.6.6.6.3.2.2.2.2.2.3.cmml">2</mn></msub></mrow></mrow><mo id="S4.E9.m1.6.6.6.3.2.5" stretchy="false" xref="S4.E9.m1.6.6.6.3.3.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.1" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.2" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.2.cmml">β</mi><mo id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.1" lspace="0.167em" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.3" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.3.1" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.3.1.cmml">log</mi><mo id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.3a" lspace="0.167em" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.3.cmml">⁡</mo><mfrac id="S4.E9.m1.12.12" xref="S4.E9.m1.12.12.cmml"><mrow id="S4.E9.m1.9.9.3" xref="S4.E9.m1.9.9.3.cmml"><msub id="S4.E9.m1.9.9.3.5" xref="S4.E9.m1.9.9.3.5.cmml"><mi id="S4.E9.m1.9.9.3.5.2" xref="S4.E9.m1.9.9.3.5.2.cmml">π</mi><mi id="S4.E9.m1.9.9.3.5.3" xref="S4.E9.m1.9.9.3.5.3.cmml">ϕ</mi></msub><mo id="S4.E9.m1.9.9.3.4" xref="S4.E9.m1.9.9.3.4.cmml">⁢</mo><mrow id="S4.E9.m1.9.9.3.3.2" xref="S4.E9.m1.9.9.3.3.3.cmml"><mo id="S4.E9.m1.9.9.3.3.2.3" stretchy="false" xref="S4.E9.m1.9.9.3.3.3.cmml">(</mo><msub id="S4.E9.m1.8.8.2.2.1.1" xref="S4.E9.m1.8.8.2.2.1.1.cmml"><mi id="S4.E9.m1.8.8.2.2.1.1.2" xref="S4.E9.m1.8.8.2.2.1.1.2.cmml">I</mi><mi id="S4.E9.m1.8.8.2.2.1.1.3" xref="S4.E9.m1.8.8.2.2.1.1.3.cmml">l</mi></msub><mo id="S4.E9.m1.9.9.3.3.2.4" xref="S4.E9.m1.9.9.3.3.3.cmml">,</mo><mrow id="S4.E9.m1.9.9.3.3.2.2" xref="S4.E9.m1.9.9.3.3.2.2.cmml"><msub id="S4.E9.m1.9.9.3.3.2.2.4" xref="S4.E9.m1.9.9.3.3.2.2.4.cmml"><mi id="S4.E9.m1.9.9.3.3.2.2.4.2" xref="S4.E9.m1.9.9.3.3.2.2.4.2.cmml">r</mi><mi id="S4.E9.m1.9.9.3.3.2.2.4.3" xref="S4.E9.m1.9.9.3.3.2.2.4.3.cmml">l</mi></msub><mo fence="false" id="S4.E9.m1.9.9.3.3.2.2.3" xref="S4.E9.m1.9.9.3.3.2.2.3.cmml">|</mo><mrow id="S4.E9.m1.9.9.3.3.2.2.2.2" xref="S4.E9.m1.9.9.3.3.2.2.2.3.cmml"><mi id="S4.E9.m1.7.7.1.1" xref="S4.E9.m1.7.7.1.1.cmml">x</mi><mo id="S4.E9.m1.9.9.3.3.2.2.2.2.3" xref="S4.E9.m1.9.9.3.3.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.9.9.3.3.2.2.1.1.1" xref="S4.E9.m1.9.9.3.3.2.2.1.1.1.cmml"><mi id="S4.E9.m1.9.9.3.3.2.2.1.1.1.2" xref="S4.E9.m1.9.9.3.3.2.2.1.1.1.2.cmml">y</mi><mn id="S4.E9.m1.9.9.3.3.2.2.1.1.1.3" xref="S4.E9.m1.9.9.3.3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.E9.m1.9.9.3.3.2.2.2.2.4" xref="S4.E9.m1.9.9.3.3.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.9.9.3.3.2.2.2.2.2" xref="S4.E9.m1.9.9.3.3.2.2.2.2.2.cmml"><mi id="S4.E9.m1.9.9.3.3.2.2.2.2.2.2" xref="S4.E9.m1.9.9.3.3.2.2.2.2.2.2.cmml">y</mi><mn id="S4.E9.m1.9.9.3.3.2.2.2.2.2.3" xref="S4.E9.m1.9.9.3.3.2.2.2.2.2.3.cmml">2</mn></msub></mrow></mrow><mo id="S4.E9.m1.9.9.3.3.2.5" stretchy="false" xref="S4.E9.m1.9.9.3.3.3.cmml">)</mo></mrow></mrow><mrow id="S4.E9.m1.12.12.6" xref="S4.E9.m1.12.12.6.cmml"><msub id="S4.E9.m1.12.12.6.5" xref="S4.E9.m1.12.12.6.5.cmml"><mi id="S4.E9.m1.12.12.6.5.2" xref="S4.E9.m1.12.12.6.5.2.cmml">π</mi><mtext id="S4.E9.m1.12.12.6.5.3" xref="S4.E9.m1.12.12.6.5.3a.cmml">ref</mtext></msub><mo id="S4.E9.m1.12.12.6.4" xref="S4.E9.m1.12.12.6.4.cmml">⁢</mo><mrow id="S4.E9.m1.12.12.6.3.2" xref="S4.E9.m1.12.12.6.3.3.cmml"><mo id="S4.E9.m1.12.12.6.3.2.3" stretchy="false" xref="S4.E9.m1.12.12.6.3.3.cmml">(</mo><msub id="S4.E9.m1.11.11.5.2.1.1" xref="S4.E9.m1.11.11.5.2.1.1.cmml"><mi id="S4.E9.m1.11.11.5.2.1.1.2" xref="S4.E9.m1.11.11.5.2.1.1.2.cmml">I</mi><mi id="S4.E9.m1.11.11.5.2.1.1.3" xref="S4.E9.m1.11.11.5.2.1.1.3.cmml">l</mi></msub><mo id="S4.E9.m1.12.12.6.3.2.4" xref="S4.E9.m1.12.12.6.3.3.cmml">,</mo><mrow id="S4.E9.m1.12.12.6.3.2.2" xref="S4.E9.m1.12.12.6.3.2.2.cmml"><msub id="S4.E9.m1.12.12.6.3.2.2.4" xref="S4.E9.m1.12.12.6.3.2.2.4.cmml"><mi id="S4.E9.m1.12.12.6.3.2.2.4.2" xref="S4.E9.m1.12.12.6.3.2.2.4.2.cmml">r</mi><mi id="S4.E9.m1.12.12.6.3.2.2.4.3" xref="S4.E9.m1.12.12.6.3.2.2.4.3.cmml">l</mi></msub><mo fence="false" id="S4.E9.m1.12.12.6.3.2.2.3" xref="S4.E9.m1.12.12.6.3.2.2.3.cmml">|</mo><mrow id="S4.E9.m1.12.12.6.3.2.2.2.2" xref="S4.E9.m1.12.12.6.3.2.2.2.3.cmml"><mi id="S4.E9.m1.10.10.4.1" xref="S4.E9.m1.10.10.4.1.cmml">x</mi><mo id="S4.E9.m1.12.12.6.3.2.2.2.2.3" xref="S4.E9.m1.12.12.6.3.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.12.12.6.3.2.2.1.1.1" xref="S4.E9.m1.12.12.6.3.2.2.1.1.1.cmml"><mi id="S4.E9.m1.12.12.6.3.2.2.1.1.1.2" xref="S4.E9.m1.12.12.6.3.2.2.1.1.1.2.cmml">y</mi><mn id="S4.E9.m1.12.12.6.3.2.2.1.1.1.3" xref="S4.E9.m1.12.12.6.3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.E9.m1.12.12.6.3.2.2.2.2.4" xref="S4.E9.m1.12.12.6.3.2.2.2.3.cmml">,</mo><msub id="S4.E9.m1.12.12.6.3.2.2.2.2.2" xref="S4.E9.m1.12.12.6.3.2.2.2.2.2.cmml"><mi id="S4.E9.m1.12.12.6.3.2.2.2.2.2.2" xref="S4.E9.m1.12.12.6.3.2.2.2.2.2.2.cmml">y</mi><mn id="S4.E9.m1.12.12.6.3.2.2.2.2.2.3" xref="S4.E9.m1.12.12.6.3.2.2.2.2.2.3.cmml">2</mn></msub></mrow></mrow><mo id="S4.E9.m1.12.12.6.3.2.5" stretchy="false" xref="S4.E9.m1.12.12.6.3.3.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.3" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.13.13.1.1.2.1.1.3" xref="S4.E9.m1.13.13.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S4.E9.m1.13.13.1.2" lspace="0em" xref="S4.E9.m1.13.13.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.13b"><apply id="S4.E9.m1.13.13.1.1.cmml" xref="S4.E9.m1.13.13.1"><eq id="S4.E9.m1.13.13.1.1.3.cmml" xref="S4.E9.m1.13.13.1.1.3"></eq><apply id="S4.E9.m1.13.13.1.1.1.cmml" xref="S4.E9.m1.13.13.1.1.1"><times id="S4.E9.m1.13.13.1.1.1.2.cmml" xref="S4.E9.m1.13.13.1.1.1.2"></times><apply id="S4.E9.m1.13.13.1.1.1.3.cmml" xref="S4.E9.m1.13.13.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.3.1.cmml" xref="S4.E9.m1.13.13.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.13.13.1.1.1.3.2.cmml" xref="S4.E9.m1.13.13.1.1.1.3.2">ℒ</ci><ci id="S4.E9.m1.13.13.1.1.1.3.3a.cmml" xref="S4.E9.m1.13.13.1.1.1.3.3"><mtext id="S4.E9.m1.13.13.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E9.m1.13.13.1.1.1.3.3">GenRM-DPO</mtext></ci></apply><apply id="S4.E9.m1.13.13.1.1.1.1.1.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.13.13.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.13.13.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.13.13.1.1.1.1.1.1.2">𝜋</ci><ci id="S4.E9.m1.13.13.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.13.13.1.1.1.1.1.1.3">italic-ϕ</ci></apply></apply><apply id="S4.E9.m1.13.13.1.1.2.cmml" xref="S4.E9.m1.13.13.1.1.2"><times id="S4.E9.m1.13.13.1.1.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.2"></times><apply id="S4.E9.m1.13.13.1.1.2.3.cmml" xref="S4.E9.m1.13.13.1.1.2.3"><csymbol cd="ambiguous" id="S4.E9.m1.13.13.1.1.2.3.1.cmml" xref="S4.E9.m1.13.13.1.1.2.3">subscript</csymbol><ci id="S4.E9.m1.13.13.1.1.2.3.2.cmml" xref="S4.E9.m1.13.13.1.1.2.3.2">𝔼</ci><ci id="S4.E9.m1.13.13.1.1.2.3.3.cmml" xref="S4.E9.m1.13.13.1.1.2.3.3">𝒟</ci></apply><apply id="S4.E9.m1.13.13.1.1.2.1.2.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1"><csymbol cd="latexml" id="S4.E9.m1.13.13.1.1.2.1.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S4.E9.m1.13.13.1.1.2.1.1.1.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1"><times id="S4.E9.m1.13.13.1.1.2.1.1.1.2.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.2"></times><apply id="S4.E9.m1.13.13.1.1.2.1.1.1.3.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.3"><log id="S4.E9.m1.13.13.1.1.2.1.1.1.3.1.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.3.1"></log><ci id="S4.E9.m1.13.13.1.1.2.1.1.1.3.2.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.3.2">𝜎</ci></apply><apply id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1"><minus id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.1"></minus><apply id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2"><times id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.1"></times><ci id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.2">𝛽</ci><apply id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.3"><log id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.2.3.1"></log><apply id="S4.E9.m1.6.6.cmml" xref="S4.E9.m1.6.6"><divide id="S4.E9.m1.6.6.7.cmml" xref="S4.E9.m1.6.6"></divide><apply id="S4.E9.m1.3.3.3.cmml" xref="S4.E9.m1.3.3.3"><times id="S4.E9.m1.3.3.3.4.cmml" xref="S4.E9.m1.3.3.3.4"></times><apply id="S4.E9.m1.3.3.3.5.cmml" xref="S4.E9.m1.3.3.3.5"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.5.1.cmml" xref="S4.E9.m1.3.3.3.5">subscript</csymbol><ci id="S4.E9.m1.3.3.3.5.2.cmml" xref="S4.E9.m1.3.3.3.5.2">𝜋</ci><ci id="S4.E9.m1.3.3.3.5.3.cmml" xref="S4.E9.m1.3.3.3.5.3">italic-ϕ</ci></apply><interval closure="open" id="S4.E9.m1.3.3.3.3.3.cmml" xref="S4.E9.m1.3.3.3.3.2"><apply id="S4.E9.m1.2.2.2.2.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.1.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E9.m1.2.2.2.2.1.1.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2">𝐼</ci><ci id="S4.E9.m1.2.2.2.2.1.1.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3">𝑤</ci></apply><apply id="S4.E9.m1.3.3.3.3.2.2.cmml" xref="S4.E9.m1.3.3.3.3.2.2"><csymbol cd="latexml" id="S4.E9.m1.3.3.3.3.2.2.3.cmml" xref="S4.E9.m1.3.3.3.3.2.2.3">conditional</csymbol><apply id="S4.E9.m1.3.3.3.3.2.2.4.cmml" xref="S4.E9.m1.3.3.3.3.2.2.4"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.3.2.2.4.1.cmml" xref="S4.E9.m1.3.3.3.3.2.2.4">subscript</csymbol><ci id="S4.E9.m1.3.3.3.3.2.2.4.2.cmml" xref="S4.E9.m1.3.3.3.3.2.2.4.2">𝑟</ci><ci id="S4.E9.m1.3.3.3.3.2.2.4.3.cmml" xref="S4.E9.m1.3.3.3.3.2.2.4.3">𝑤</ci></apply><list id="S4.E9.m1.3.3.3.3.2.2.2.3.cmml" xref="S4.E9.m1.3.3.3.3.2.2.2.2"><ci id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1">𝑥</ci><apply id="S4.E9.m1.3.3.3.3.2.2.1.1.1.cmml" xref="S4.E9.m1.3.3.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.3.2.2.1.1.1.1.cmml" xref="S4.E9.m1.3.3.3.3.2.2.1.1.1">subscript</csymbol><ci id="S4.E9.m1.3.3.3.3.2.2.1.1.1.2.cmml" xref="S4.E9.m1.3.3.3.3.2.2.1.1.1.2">𝑦</ci><cn id="S4.E9.m1.3.3.3.3.2.2.1.1.1.3.cmml" type="integer" xref="S4.E9.m1.3.3.3.3.2.2.1.1.1.3">1</cn></apply><apply id="S4.E9.m1.3.3.3.3.2.2.2.2.2.cmml" xref="S4.E9.m1.3.3.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.3.2.2.2.2.2.1.cmml" xref="S4.E9.m1.3.3.3.3.2.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.3.3.3.3.2.2.2.2.2.2.cmml" xref="S4.E9.m1.3.3.3.3.2.2.2.2.2.2">𝑦</ci><cn id="S4.E9.m1.3.3.3.3.2.2.2.2.2.3.cmml" type="integer" xref="S4.E9.m1.3.3.3.3.2.2.2.2.2.3">2</cn></apply></list></apply></interval></apply><apply id="S4.E9.m1.6.6.6.cmml" xref="S4.E9.m1.6.6.6"><times id="S4.E9.m1.6.6.6.4.cmml" xref="S4.E9.m1.6.6.6.4"></times><apply id="S4.E9.m1.6.6.6.5.cmml" xref="S4.E9.m1.6.6.6.5"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.5.1.cmml" xref="S4.E9.m1.6.6.6.5">subscript</csymbol><ci id="S4.E9.m1.6.6.6.5.2.cmml" xref="S4.E9.m1.6.6.6.5.2">𝜋</ci><ci id="S4.E9.m1.6.6.6.5.3a.cmml" xref="S4.E9.m1.6.6.6.5.3"><mtext id="S4.E9.m1.6.6.6.5.3.cmml" mathsize="70%" xref="S4.E9.m1.6.6.6.5.3">ref</mtext></ci></apply><interval closure="open" id="S4.E9.m1.6.6.6.3.3.cmml" xref="S4.E9.m1.6.6.6.3.2"><apply id="S4.E9.m1.5.5.5.2.1.1.cmml" xref="S4.E9.m1.5.5.5.2.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.5.2.1.1.1.cmml" xref="S4.E9.m1.5.5.5.2.1.1">subscript</csymbol><ci id="S4.E9.m1.5.5.5.2.1.1.2.cmml" xref="S4.E9.m1.5.5.5.2.1.1.2">𝐼</ci><ci id="S4.E9.m1.5.5.5.2.1.1.3.cmml" xref="S4.E9.m1.5.5.5.2.1.1.3">𝑤</ci></apply><apply id="S4.E9.m1.6.6.6.3.2.2.cmml" xref="S4.E9.m1.6.6.6.3.2.2"><csymbol cd="latexml" id="S4.E9.m1.6.6.6.3.2.2.3.cmml" xref="S4.E9.m1.6.6.6.3.2.2.3">conditional</csymbol><apply id="S4.E9.m1.6.6.6.3.2.2.4.cmml" xref="S4.E9.m1.6.6.6.3.2.2.4"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.3.2.2.4.1.cmml" xref="S4.E9.m1.6.6.6.3.2.2.4">subscript</csymbol><ci id="S4.E9.m1.6.6.6.3.2.2.4.2.cmml" xref="S4.E9.m1.6.6.6.3.2.2.4.2">𝑟</ci><ci id="S4.E9.m1.6.6.6.3.2.2.4.3.cmml" xref="S4.E9.m1.6.6.6.3.2.2.4.3">𝑤</ci></apply><list id="S4.E9.m1.6.6.6.3.2.2.2.3.cmml" xref="S4.E9.m1.6.6.6.3.2.2.2.2"><ci id="S4.E9.m1.4.4.4.1.cmml" xref="S4.E9.m1.4.4.4.1">𝑥</ci><apply id="S4.E9.m1.6.6.6.3.2.2.1.1.1.cmml" xref="S4.E9.m1.6.6.6.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.3.2.2.1.1.1.1.cmml" xref="S4.E9.m1.6.6.6.3.2.2.1.1.1">subscript</csymbol><ci id="S4.E9.m1.6.6.6.3.2.2.1.1.1.2.cmml" xref="S4.E9.m1.6.6.6.3.2.2.1.1.1.2">𝑦</ci><cn id="S4.E9.m1.6.6.6.3.2.2.1.1.1.3.cmml" type="integer" xref="S4.E9.m1.6.6.6.3.2.2.1.1.1.3">1</cn></apply><apply id="S4.E9.m1.6.6.6.3.2.2.2.2.2.cmml" xref="S4.E9.m1.6.6.6.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.6.6.6.3.2.2.2.2.2.1.cmml" xref="S4.E9.m1.6.6.6.3.2.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.6.6.6.3.2.2.2.2.2.2.cmml" xref="S4.E9.m1.6.6.6.3.2.2.2.2.2.2">𝑦</ci><cn id="S4.E9.m1.6.6.6.3.2.2.2.2.2.3.cmml" type="integer" xref="S4.E9.m1.6.6.6.3.2.2.2.2.2.3">2</cn></apply></list></apply></interval></apply></apply></apply></apply><apply id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3"><times id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.1"></times><ci id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.2">𝛽</ci><apply id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.3"><log id="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E9.m1.13.13.1.1.2.1.1.1.1.1.1.3.3.1"></log><apply id="S4.E9.m1.12.12.cmml" xref="S4.E9.m1.12.12"><divide id="S4.E9.m1.12.12.7.cmml" xref="S4.E9.m1.12.12"></divide><apply id="S4.E9.m1.9.9.3.cmml" xref="S4.E9.m1.9.9.3"><times id="S4.E9.m1.9.9.3.4.cmml" xref="S4.E9.m1.9.9.3.4"></times><apply id="S4.E9.m1.9.9.3.5.cmml" xref="S4.E9.m1.9.9.3.5"><csymbol cd="ambiguous" id="S4.E9.m1.9.9.3.5.1.cmml" xref="S4.E9.m1.9.9.3.5">subscript</csymbol><ci id="S4.E9.m1.9.9.3.5.2.cmml" xref="S4.E9.m1.9.9.3.5.2">𝜋</ci><ci id="S4.E9.m1.9.9.3.5.3.cmml" xref="S4.E9.m1.9.9.3.5.3">italic-ϕ</ci></apply><interval closure="open" id="S4.E9.m1.9.9.3.3.3.cmml" xref="S4.E9.m1.9.9.3.3.2"><apply id="S4.E9.m1.8.8.2.2.1.1.cmml" xref="S4.E9.m1.8.8.2.2.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.8.8.2.2.1.1.1.cmml" xref="S4.E9.m1.8.8.2.2.1.1">subscript</csymbol><ci id="S4.E9.m1.8.8.2.2.1.1.2.cmml" xref="S4.E9.m1.8.8.2.2.1.1.2">𝐼</ci><ci id="S4.E9.m1.8.8.2.2.1.1.3.cmml" xref="S4.E9.m1.8.8.2.2.1.1.3">𝑙</ci></apply><apply id="S4.E9.m1.9.9.3.3.2.2.cmml" xref="S4.E9.m1.9.9.3.3.2.2"><csymbol cd="latexml" id="S4.E9.m1.9.9.3.3.2.2.3.cmml" xref="S4.E9.m1.9.9.3.3.2.2.3">conditional</csymbol><apply id="S4.E9.m1.9.9.3.3.2.2.4.cmml" xref="S4.E9.m1.9.9.3.3.2.2.4"><csymbol cd="ambiguous" id="S4.E9.m1.9.9.3.3.2.2.4.1.cmml" xref="S4.E9.m1.9.9.3.3.2.2.4">subscript</csymbol><ci id="S4.E9.m1.9.9.3.3.2.2.4.2.cmml" xref="S4.E9.m1.9.9.3.3.2.2.4.2">𝑟</ci><ci id="S4.E9.m1.9.9.3.3.2.2.4.3.cmml" xref="S4.E9.m1.9.9.3.3.2.2.4.3">𝑙</ci></apply><list id="S4.E9.m1.9.9.3.3.2.2.2.3.cmml" xref="S4.E9.m1.9.9.3.3.2.2.2.2"><ci id="S4.E9.m1.7.7.1.1.cmml" xref="S4.E9.m1.7.7.1.1">𝑥</ci><apply id="S4.E9.m1.9.9.3.3.2.2.1.1.1.cmml" xref="S4.E9.m1.9.9.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.9.9.3.3.2.2.1.1.1.1.cmml" xref="S4.E9.m1.9.9.3.3.2.2.1.1.1">subscript</csymbol><ci id="S4.E9.m1.9.9.3.3.2.2.1.1.1.2.cmml" xref="S4.E9.m1.9.9.3.3.2.2.1.1.1.2">𝑦</ci><cn id="S4.E9.m1.9.9.3.3.2.2.1.1.1.3.cmml" type="integer" xref="S4.E9.m1.9.9.3.3.2.2.1.1.1.3">1</cn></apply><apply id="S4.E9.m1.9.9.3.3.2.2.2.2.2.cmml" xref="S4.E9.m1.9.9.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.9.9.3.3.2.2.2.2.2.1.cmml" xref="S4.E9.m1.9.9.3.3.2.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.9.9.3.3.2.2.2.2.2.2.cmml" xref="S4.E9.m1.9.9.3.3.2.2.2.2.2.2">𝑦</ci><cn id="S4.E9.m1.9.9.3.3.2.2.2.2.2.3.cmml" type="integer" xref="S4.E9.m1.9.9.3.3.2.2.2.2.2.3">2</cn></apply></list></apply></interval></apply><apply id="S4.E9.m1.12.12.6.cmml" xref="S4.E9.m1.12.12.6"><times id="S4.E9.m1.12.12.6.4.cmml" xref="S4.E9.m1.12.12.6.4"></times><apply id="S4.E9.m1.12.12.6.5.cmml" xref="S4.E9.m1.12.12.6.5"><csymbol cd="ambiguous" id="S4.E9.m1.12.12.6.5.1.cmml" xref="S4.E9.m1.12.12.6.5">subscript</csymbol><ci id="S4.E9.m1.12.12.6.5.2.cmml" xref="S4.E9.m1.12.12.6.5.2">𝜋</ci><ci id="S4.E9.m1.12.12.6.5.3a.cmml" xref="S4.E9.m1.12.12.6.5.3"><mtext id="S4.E9.m1.12.12.6.5.3.cmml" mathsize="70%" xref="S4.E9.m1.12.12.6.5.3">ref</mtext></ci></apply><interval closure="open" id="S4.E9.m1.12.12.6.3.3.cmml" xref="S4.E9.m1.12.12.6.3.2"><apply id="S4.E9.m1.11.11.5.2.1.1.cmml" xref="S4.E9.m1.11.11.5.2.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.11.11.5.2.1.1.1.cmml" xref="S4.E9.m1.11.11.5.2.1.1">subscript</csymbol><ci id="S4.E9.m1.11.11.5.2.1.1.2.cmml" xref="S4.E9.m1.11.11.5.2.1.1.2">𝐼</ci><ci id="S4.E9.m1.11.11.5.2.1.1.3.cmml" xref="S4.E9.m1.11.11.5.2.1.1.3">𝑙</ci></apply><apply id="S4.E9.m1.12.12.6.3.2.2.cmml" xref="S4.E9.m1.12.12.6.3.2.2"><csymbol cd="latexml" id="S4.E9.m1.12.12.6.3.2.2.3.cmml" xref="S4.E9.m1.12.12.6.3.2.2.3">conditional</csymbol><apply id="S4.E9.m1.12.12.6.3.2.2.4.cmml" xref="S4.E9.m1.12.12.6.3.2.2.4"><csymbol cd="ambiguous" id="S4.E9.m1.12.12.6.3.2.2.4.1.cmml" xref="S4.E9.m1.12.12.6.3.2.2.4">subscript</csymbol><ci id="S4.E9.m1.12.12.6.3.2.2.4.2.cmml" xref="S4.E9.m1.12.12.6.3.2.2.4.2">𝑟</ci><ci id="S4.E9.m1.12.12.6.3.2.2.4.3.cmml" xref="S4.E9.m1.12.12.6.3.2.2.4.3">𝑙</ci></apply><list id="S4.E9.m1.12.12.6.3.2.2.2.3.cmml" xref="S4.E9.m1.12.12.6.3.2.2.2.2"><ci id="S4.E9.m1.10.10.4.1.cmml" xref="S4.E9.m1.10.10.4.1">𝑥</ci><apply id="S4.E9.m1.12.12.6.3.2.2.1.1.1.cmml" xref="S4.E9.m1.12.12.6.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.12.12.6.3.2.2.1.1.1.1.cmml" xref="S4.E9.m1.12.12.6.3.2.2.1.1.1">subscript</csymbol><ci id="S4.E9.m1.12.12.6.3.2.2.1.1.1.2.cmml" xref="S4.E9.m1.12.12.6.3.2.2.1.1.1.2">𝑦</ci><cn id="S4.E9.m1.12.12.6.3.2.2.1.1.1.3.cmml" type="integer" xref="S4.E9.m1.12.12.6.3.2.2.1.1.1.3">1</cn></apply><apply id="S4.E9.m1.12.12.6.3.2.2.2.2.2.cmml" xref="S4.E9.m1.12.12.6.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.12.12.6.3.2.2.2.2.2.1.cmml" xref="S4.E9.m1.12.12.6.3.2.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.12.12.6.3.2.2.2.2.2.2.cmml" xref="S4.E9.m1.12.12.6.3.2.2.2.2.2.2">𝑦</ci><cn id="S4.E9.m1.12.12.6.3.2.2.2.2.2.3.cmml" type="integer" xref="S4.E9.m1.12.12.6.3.2.2.2.2.2.3">2</cn></apply></list></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.13c">\mathcal{L}_{\text{GenRM-DPO}}(\pi_{\phi})=\mathbb{E}_{\mathcal{D}}\left[\log%
\sigma\left(\beta\log\frac{\pi_{\phi}(I_{w},r_{w}|x,y_{1},y_{2})}{\pi_{\text{%
ref}}(I_{w},r_{w}|x,y_{1},y_{2})}-\beta\log\frac{\pi_{\phi}(I_{l},r_{l}|x,y_{1%
},y_{2})}{\pi_{\text{ref}}(I_{l},r_{l}|x,y_{1},y_{2})}\right)\right].</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.13d">caligraphic_L start_POSTSUBSCRIPT GenRM-DPO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ) = blackboard_E start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT [ roman_log italic_σ ( italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_I start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_I start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_ARG - italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_I start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_I start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) end_ARG ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.p7.6">We denote models trained with this objective as STaR-DPO.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section we evaluate the performance of our proposed Generative Reward Modelling approaches as compared to classical Bradley-Terry reward models <cite class="ltx_cite ltx_citemacro_citep">(Bradley &amp; Terry, <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib10" title="">1952</a>)</cite>, a more recent reward variant called PairRM <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib22" title="">2023</a>)</cite>, as well as zero-shot RLAIF evaluation. All models are based on the LLaMa-3.1-8B-Instruct model <cite class="ltx_cite ltx_citemacro_citep">(Dubey et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib16" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">We consider two separate training datasets: UltraFeedback <cite class="ltx_cite ltx_citemacro_citep">(Cui et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib14" title="">2023</a>)</cite>, a large-scale feedback dataset of 61k pairs focusing on general instruction following, and UltraInteract <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib48" title="">2024b</a>)</cite>, a dataset consisting of multi-turn reasoning trees focusing on math, code and logic, including advanced capabilities such as tool use and environment interaction. We evaluate models on each training dataset as well as on RewardBench <cite class="ltx_cite ltx_citemacro_citep">(Lambert et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib25" title="">2024</a>)</cite>, a general reward modeling benchmark which consists of four subsets—Chat, Chat (Hard), Reasoning, and Safety.
Full training details can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1" title="Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">In our experiments we evaluate the following questions:</p>
<ol class="ltx_enumerate" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1">Do generative reward models match the performance of classical reward models?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1">How robust are reward models and how well do they generalize to OOD data?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1">Does reasoning improve reward modelling and can we use inference time compute to improve results?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para ltx_noindent" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1">Do we need strong reasoning data to train generative RMs or can we bootstrap the reasoning from the model itself?</p>
</div>
</li>
</ol>
</div>
<figure class="ltx_figure" id="S5.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="326" id="S5.F2.g1" src="x2.png" width="723"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text ltx_font_bold" id="S5.F2.2.1">Comparing generative reward models with prior reward modeling methods</span> on in-domain (UltraFeedback) data and out-of-domain data (RewardBench). All generative model scores are the result of a majority vote over 32 samples.</figcaption>
</figure>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Performance of Generative RMs on General Assistant Tasks</h3>
<figure class="ltx_figure" id="S5.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_centering ltx_figure_panel ltx_role_start_2_columns"></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><svg class="ltx_picture ltx_centering ltx_figure_panel" height="180.47" id="S5.F3.pic1" overflow="visible" version="1.1" width="261.25"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,180.47) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 174.57 C 0 177.83 2.64 180.47 5.91 180.47 L 255.35 180.47 C 258.61 180.47 261.25 177.83 261.25 174.57 L 261.25 5.91 C 261.25 2.64 258.61 0 255.35 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 164.39 L 259.28 164.39 L 259.28 5.91 C 259.28 3.73 257.52 1.97 255.35 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 9.84 166.36)"><foreignobject color="#FFFFFF" height="12.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="241.57">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S5.F3.pic1.1.1.1.1.1" style="width:174.6pt;">
<span class="ltx_p" id="S5.F3.pic1.1.1.1.1.1.1">Prompt</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 9.84 9.84)"><foreignobject color="#000000" height="146.67" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="241.57">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S5.F3.pic1.2.2.2.1.1" style="width:174.6pt;">
<span class="ltx_p" id="S5.F3.pic1.2.2.2.1.1.1">User: Name two animal species that live in the ocean.</span>
<span class="ltx_p" id="S5.F3.pic1.2.2.2.1.1.2">[The Start of Assistant A’s Answer]</span>
<span class="ltx_p" id="S5.F3.pic1.2.2.2.1.1.3">Dolphin and shark.</span>
<span class="ltx_p" id="S5.F3.pic1.2.2.2.1.1.4">[The End of Assistant A’s Answer]</span>
<span class="ltx_p" id="S5.F3.pic1.2.2.2.1.1.5">[The Start of Assistant B’s Answer]</span>
<span class="ltx_p" id="S5.F3.pic1.2.2.2.1.1.6">Common ocean animals include sharks, whales, and dolphins.</span>
<span class="ltx_p" id="S5.F3.pic1.2.2.2.1.1.7">[The End of Assistant B’s Answer]</span>
</span></foreignobject></g></g></svg></div>
<div class="ltx_flex_cell ltx_flex_size_2"><svg class="ltx_picture ltx_centering ltx_figure_panel" height="426.85" id="S5.F3.pic2" overflow="visible" version="1.1" width="261.25"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,426.85) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 420.94 C 0 424.2 2.64 426.85 5.91 426.85 L 255.35 426.85 C 258.61 426.85 261.25 424.2 261.25 420.94 L 261.25 5.91 C 261.25 2.64 258.61 0 255.35 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 413.45 L 259.28 413.45 L 259.28 5.91 C 259.28 3.73 257.52 1.97 255.35 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 9.84 415.42)"><foreignobject color="#FFFFFF" height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="241.57">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S5.F3.pic2.1.1.1.1.1" style="width:174.6pt;">
<span class="ltx_p" id="S5.F3.pic2.1.1.1.1.1.1">STaR-DPO</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 9.84 9.84)"><foreignobject color="#000000" height="395.74" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="241.57">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S5.F3.pic2.2.2.2.1.1" style="width:174.6pt;">
<span class="ltx_p" id="S5.F3.pic2.2.2.2.1.1.1">For the user’s question, which is to name two animal species that live in the ocean, we have responses from two assistants.</span>
<span class="ltx_p" id="S5.F3.pic2.2.2.2.1.1.2">Assistant A’s response is ”Dolphin and shark.” Although it names two species that live in the ocean, it lacks depth and detail. The response does not provide further information about the species, and it only mentions two examples.</span>
<span class="ltx_p" id="S5.F3.pic2.2.2.2.1.1.3">Assistant B’s response is ”Common ocean animals include sharks, whales, and dolphins.” This response is more detailed and provides additional information about the types of ocean animals. However, the question specifically asks for two species, and Assistant B’s response names three species.</span>
<span class="ltx_p" id="S5.F3.pic2.2.2.2.1.1.4">Considering the user’s question, I would say that <span class="ltx_text ltx_font_bold" id="S5.F3.pic2.2.2.2.1.1.4.1">Assistant A’s response is more suitable because it directly answers the question by naming two animal species</span> that live in the ocean.</span>
<span class="ltx_p" id="S5.F3.pic2.2.2.2.1.1.5">[[A]]</span>
</span></foreignobject></g></g></svg></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><svg class="ltx_picture ltx_centering ltx_figure_panel" height="579.13" id="S5.F3.pic3" overflow="visible" version="1.1" width="261.25"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,579.13) matrix(1 0 0 -1 0 0)"><g fill="#404040" fill-opacity="1.0"><path d="M 0 5.91 L 0 573.23 C 0 576.49 2.64 579.13 5.91 579.13 L 255.35 579.13 C 258.61 579.13 261.25 576.49 261.25 573.23 L 261.25 5.91 C 261.25 2.64 258.61 0 255.35 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#F2F2F2" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 562.89 L 259.28 562.89 L 259.28 5.91 C 259.28 3.73 257.52 1.97 255.35 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 9.84 564.86)"><foreignobject color="#FFFFFF" height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="241.57">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S5.F3.pic3.1.1.1.1.1" style="width:174.6pt;">
<span class="ltx_p" id="S5.F3.pic3.1.1.1.1.1.1">LLM-as-a-judge</span>
</span></foreignobject></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 9.84 9.84)"><foreignobject color="#000000" height="545.18" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="241.57">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="S5.F3.pic3.2.2.2.1.1" style="width:174.6pt;">
<span class="ltx_p" id="S5.F3.pic3.2.2.2.1.1.1">To compare the two responses, let’s consider the factors mentioned earlier.</span>
<span class="ltx_p" id="S5.F3.pic3.2.2.2.1.1.2">Helpfulness: Both responses provide the user with two (in the case of Assistant A) or more (in the case of Assistant B) ocean-dwelling animal species. However, Assistant B provides a <span class="ltx_text ltx_font_bold" id="S5.F3.pic3.2.2.2.1.1.2.1">more comprehensive list of common ocean animals</span>, which could be more helpful to the user.</span>
<span class="ltx_p" id="S5.F3.pic3.2.2.2.1.1.3">Relevance: Both responses are directly related to the user’s question about ocean-dwelling animal species.</span>
<span class="ltx_p" id="S5.F3.pic3.2.2.2.1.1.4">Accuracy: Both responses are accurate in providing examples of ocean-dwelling animals. However, Assistant B provides a more specific list of common ocean animals.</span>
<span class="ltx_p" id="S5.F3.pic3.2.2.2.1.1.5">Depth: Assistant B’s response is more detailed, providing a list of common ocean animals, while Assistant A’s response is more concise but less detailed.</span>
<span class="ltx_p" id="S5.F3.pic3.2.2.2.1.1.6">Creativity: Both responses are straightforward and do not show much creativity.</span>
<span class="ltx_p" id="S5.F3.pic3.2.2.2.1.1.7">Level of detail: Assistant B’s response provides more detail by listing specific ocean animals, while Assistant A’s response is more general.</span>
<span class="ltx_p" id="S5.F3.pic3.2.2.2.1.1.8">Overall, considering the factors above, <span class="ltx_text ltx_font_bold" id="S5.F3.pic3.2.2.2.1.1.8.1">Assistant B’s response provides more helpful and detailed information</span>, making it a better choice for the user’s question.</span>
<span class="ltx_p" id="S5.F3.pic3.2.2.2.1.1.9">[[B]]</span>
</span></foreignobject></g></g></svg></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_pagination ltx_centering ltx_figure_panel ltx_role_end_2_columns"></div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>An example where LLM-as-a-judge fails to provide an accurate judgement, but STaR-DPO succeeds. Sentences where critical reasoning takes place are bolded for emphasis.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">We show our first main set of results in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.F2" title="Figure 2 ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">2</span></a>. All models are trained on the UltraFeedback dataset and evaluated on a held-out split of in-domain data as well as on RewardBench.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">We first evaluate the zero-shot performance of the LLaMa 3.1 8B Instruct model as an evaluator using both CoT prompting with self-consistency (LLM-as-a-judge in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.F2" title="Figure 2 ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">2</span></a>) and acting as a classifier directly outputting the response ranking (GenRM (base) in <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.F2" title="Figure 2 ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">2</span></a>). We see that using that prompting the model to reason over the answers significantly boosts performance from 52.25% to 67.75% on the UltraFeedback evaluation dataset and
from 60.60% to 75.18% accuracy on RewardBench.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">However, when we compare the zero-shot methods with trained models, we find that both approaches substantially under-perform the Bradley-Terry RM, PairRM and trained GenRM models which all have comparable accuracies, around 73-74%. We see that the STaR-DPO model also matches these accuracies in-distribution at 73.9%. On the other hand, the STaR-SFT model achieves in-distribution accuracy of only 67.4%, which essentially shows no change of performance compared to the base LLM.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1">When we evaluate these models on out-of-distribution tasks (RewardBench) we see that STaR-DPO achieves the strongest result, over both the base model prior (81.9% versus 77.8%) and trained RM with the GenRM having the stronger performance at 78.9%. The STaR-DPO model outperforms or matches baselines across all RewardBench categories. On the other hand, the STaR-SFT model still does not substantially differ from the base model. The GenRM model outperforms the Bradley-Terry RM and PairRM with performance comparable to STaR-DPO across Chat, Chat (Hard) and Reasoning. However, one notable observation is that reasoning-based approaches show significantly stronger performance on the Safety category with the STaR-DPO model achieving 91.0% accuracy versus the best performing PairRM model, which achieves accuracy of 81.8%.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.F3" title="Figure 3 ‣ 5.1 Performance of Generative RMs on General Assistant Tasks ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">3</span></a> demonstrates an interesting case where LLM-as-a-judge fails to accurately judge a general assistant task but the STaR-DPO model suceeds. The STaR-DPO model response recognizes that Assistant A’s response “lacks depth and detail”, but correctly recognizes that Assistant B’s response does not follow the instruction and prefers Assistant A’s response. To the contrary, the LLM-as-a-judge response repeatedly emphasizes how Assistant B’s response is more helpful and detailed, even though the user requests a short list of 2 animals, incorrectly preferring Assistant B’s response.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p5">
<p class="ltx_p" id="S5.SS1.p5.1">Overall, we see that the STaR-DPO reasoning model matches the best performance on the in-distribution dataset and has the strongest out-of-domain generalization across evaluation categories on RewardBench.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Performance on Reasoning Tasks</h3>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="326" id="S5.F4.g1" src="x3.png" width="723"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="ltx_text ltx_font_bold" id="S5.F4.2.1">Comparing generative reward models with prior reward modeling methods</span> on in-domain (UltraInteract) data and out-of-domain data (RewardBench) split into reasoning and non-reasoning subsets. All generative model scores are the result of a majority vote over 32 samples.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We also evaluate performance specifically on reasoning tasks by training models on the UltraInteract dataset, which specifically focuses on challenging evaluations of reasoning chains. The experiments in this section focus on <span class="ltx_text ltx_font_italic" id="S5.SS2.p1.1.1">meta</span>-reasoning, i.e. the capability to reason about reasoning steps. Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.F4" title="Figure 4 ‣ 5.2 Performance on Reasoning Tasks ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">4</span></a> shows that the STaR-DPO model outperforms STaR-SFT on the UltraInteract evaluation dataset and achieves a significant improvement of 90.2% versus 68.8% for the base model. This is slightly lower than the explicit RM models, which all achieve comparable performance around 94%.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">However, we see an interesting divergence on the RewardBench evaluation. For this experiment we show performance on the Reasoning category in RewardBench versus all other categories.
We see that the Bradley-Terry RM, PairRM, and GenRM struggle to generalize to the RewardBench data, with the Bradley-Terry model scoring worse than random and the best performing GenRM model achieving 70.8% accuracy, which is worse than the LLM-as-a-judge performance at 76.6%. On the other hand the STaR-DPO significantly outperforms both baselines with 87.2%. This shows that the model successfully generalizes the meta-reasoning capabilities from the training dataset to a different distribution of reasoning prompts and answers. Additionally, on the non-reasoning evaluations in RewardBench, unsurprisingly the LLM-as-a-judge achieves the strongest result with 78.0% accuracy, while all explicit reward models struggle to generalize to these tasks and distributions. At the same time STaR-DPO only suffers a small loss of accuracy on these domains at 75.0%.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">Based on the prior experiments we observe that the STaR-DPO model significantly outperforms the base LLM-as-a-judge, but also the GenRM model which does not use reasoning on held out tasks in RewardBench. One major variable is how to generate the reasoning chains used for training. In the experiments described so far rationales were sampled following a STaR-based approach using the same base model. We also evaluate an approach sampling rationales from a post-rationalization model <math alttext="r\sim q_{\phi}(r|x,y_{1},y_{2},I)" class="ltx_Math" display="inline" id="S5.SS2.p3.1.m1.3"><semantics id="S5.SS2.p3.1.m1.3a"><mrow id="S5.SS2.p3.1.m1.3.3" xref="S5.SS2.p3.1.m1.3.3.cmml"><mi id="S5.SS2.p3.1.m1.3.3.3" xref="S5.SS2.p3.1.m1.3.3.3.cmml">r</mi><mo id="S5.SS2.p3.1.m1.3.3.2" xref="S5.SS2.p3.1.m1.3.3.2.cmml">∼</mo><mrow id="S5.SS2.p3.1.m1.3.3.1" xref="S5.SS2.p3.1.m1.3.3.1.cmml"><msub id="S5.SS2.p3.1.m1.3.3.1.3" xref="S5.SS2.p3.1.m1.3.3.1.3.cmml"><mi id="S5.SS2.p3.1.m1.3.3.1.3.2" xref="S5.SS2.p3.1.m1.3.3.1.3.2.cmml">q</mi><mi id="S5.SS2.p3.1.m1.3.3.1.3.3" xref="S5.SS2.p3.1.m1.3.3.1.3.3.cmml">ϕ</mi></msub><mo id="S5.SS2.p3.1.m1.3.3.1.2" xref="S5.SS2.p3.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="S5.SS2.p3.1.m1.3.3.1.1.1" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.cmml"><mo id="S5.SS2.p3.1.m1.3.3.1.1.1.2" stretchy="false" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S5.SS2.p3.1.m1.3.3.1.1.1.1" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.cmml"><mi id="S5.SS2.p3.1.m1.3.3.1.1.1.1.4" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.4.cmml">r</mi><mo fence="false" id="S5.SS2.p3.1.m1.3.3.1.1.1.1.3" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.3.cmml">|</mo><mrow id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml">x</mi><mo id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.3" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">y</mi><mn id="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.4" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.3.cmml">,</mo><msub id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.cmml"><mi id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.2" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.2.cmml">y</mi><mn id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.3" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.5" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.3.cmml">,</mo><mi id="S5.SS2.p3.1.m1.2.2" xref="S5.SS2.p3.1.m1.2.2.cmml">I</mi></mrow></mrow><mo id="S5.SS2.p3.1.m1.3.3.1.1.1.3" stretchy="false" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.3b"><apply id="S5.SS2.p3.1.m1.3.3.cmml" xref="S5.SS2.p3.1.m1.3.3"><csymbol cd="latexml" id="S5.SS2.p3.1.m1.3.3.2.cmml" xref="S5.SS2.p3.1.m1.3.3.2">similar-to</csymbol><ci id="S5.SS2.p3.1.m1.3.3.3.cmml" xref="S5.SS2.p3.1.m1.3.3.3">𝑟</ci><apply id="S5.SS2.p3.1.m1.3.3.1.cmml" xref="S5.SS2.p3.1.m1.3.3.1"><times id="S5.SS2.p3.1.m1.3.3.1.2.cmml" xref="S5.SS2.p3.1.m1.3.3.1.2"></times><apply id="S5.SS2.p3.1.m1.3.3.1.3.cmml" xref="S5.SS2.p3.1.m1.3.3.1.3"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.3.3.1.3.1.cmml" xref="S5.SS2.p3.1.m1.3.3.1.3">subscript</csymbol><ci id="S5.SS2.p3.1.m1.3.3.1.3.2.cmml" xref="S5.SS2.p3.1.m1.3.3.1.3.2">𝑞</ci><ci id="S5.SS2.p3.1.m1.3.3.1.3.3.cmml" xref="S5.SS2.p3.1.m1.3.3.1.3.3">italic-ϕ</ci></apply><apply id="S5.SS2.p3.1.m1.3.3.1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S5.SS2.p3.1.m1.3.3.1.1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.3">conditional</csymbol><ci id="S5.SS2.p3.1.m1.3.3.1.1.1.1.4.cmml" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.4">𝑟</ci><list id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.3.cmml" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2"><ci id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">𝑥</ci><apply id="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.2">𝑦</ci><cn id="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.2">𝑦</ci><cn id="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S5.SS2.p3.1.m1.3.3.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S5.SS2.p3.1.m1.2.2.cmml" xref="S5.SS2.p3.1.m1.2.2">𝐼</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.3c">r\sim q_{\phi}(r|x,y_{1},y_{2},I)</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p3.1.m1.3d">italic_r ∼ italic_q start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_r | italic_x , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_I )</annotation></semantics></math>, which are then used for SFT training using Eq. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S4.E8" title="In 4 Generative Reward Models: A Unified RLHF-RLAIF Approach ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">8</span></a>, we refer to this as STaR-Rationalizer. Results from this approach on UltraFeedback are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.F2" title="Figure 2 ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">2</span></a> and for UltraInteract in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.F4" title="Figure 4 ‣ 5.2 Performance on Reasoning Tasks ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">4</span></a>. Interestingly we observe that the STaR-Rationalizer model matches the performance of the STaR-DPO model on both datasets, significantly out-performing the STaR-SFT approach, which uses the same training objective. However, we see that this model struggles to generalize to the RewardBench tasks, under-performing not only the STaR-DPO model, but the base LLM as well on both datasets. This is an interesting empirical phenomenon that warrants further study, but we hypothesize that the core issue is that the training rationales from the post-rationalization model are off-policy for the base model, creating a distribution mismatch during training. While the model is able to learn those rationales on the training distribution it fails on more novel tasks where it generates rationales different from those seen during training.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Bootstrapping Rationales</h3>
<figure class="ltx_table ltx_align_floatright" id="S5.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.1.1">Bootstrap Source</span></th>
<td class="ltx_td ltx_align_center" id="S5.T1.1.1.1.2">UltraFeedback</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.1.1.3">RewardBench</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.1.2.2.1" rowspan="3"><span class="ltx_text" id="S5.T1.1.2.2.1.1">Llama3.1 8B</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.2.2">68.63</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.1.2.2.3">77.34</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.3.3">
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.3.1">67.68</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.3.3.2">77.61</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.4.4">
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.4.1">67.38</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.4.4.2">77.05</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.1.5.5.1" rowspan="3"><span class="ltx_text" id="S5.T1.1.5.5.1.1">Llama3.1 70B</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.5.5.2">70.50</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.1.5.5.3">77.09</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.6.6">
<td class="ltx_td ltx_align_center" id="S5.T1.1.6.6.1">70.13</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.6.6.2">68.78</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.7.7">
<td class="ltx_td ltx_align_center" id="S5.T1.1.7.7.1">69.58</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.7.7.2">63.43</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.1.8.8.1" rowspan="3"><span class="ltx_text" id="S5.T1.1.8.8.1.1">GPT-4</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.8.8.2">62.85</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.1.8.8.3">69.58</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.9.9">
<td class="ltx_td ltx_align_center" id="S5.T1.1.9.9.1">68.55</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.9.9.2">75.63</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.10.10">
<td class="ltx_td ltx_align_center" id="S5.T1.1.10.10.1">71.73</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T1.1.10.10.2">78.29</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T1.1.11.11.1">GPT-4 (full)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.11.11.2">62.60</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S5.T1.1.11.11.3">70.52</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_bold" id="S5.T1.3.1">Bootstrapping STaR-SFT with models of different capabilities.</span>
All methods train a Llama3.1 8B model using rejection sampling from the bootstrap source. Only the first iteration of data comes from the bootstrap source. GPT-4 (full) is trained entirely on the reasoning from GPT-4. Scores are majority vote over 32 samples.
</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">We show additional evaluations in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.T1" title="Table 1 ‣ 5.3 Bootstrapping Rationales ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">1</span></a> using different models to bootstrap reasoning on the UltraFeedback domain. We see similar results to the above when using rationales generated by a a strong GPT-4 model, which significantly under-performs the standard STaR methods, however this is alleviated with additional on-policy training. Finally we see that bootstrapping reasoning with samples from the stronger LLaMa 3.1 70B Instruct model from the same family slightly improves performance on UltraFeedback, but leads to somewhat worse generalization to RewardBench. Our results indicate that on-policy training of the critic models can meaningfully impact performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Using Inference-Time Compute</h3>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="580" id="S5.F5.g1" src="x4.png" width="788"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text ltx_font_bold" id="S5.F5.2.1">Comparing generative reward models with prior reward modeling methods</span> with majority vote evaluation. Top row models are trained on UltraFeedback <cite class="ltx_cite ltx_citemacro_citep">(Cui et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib15" title="">2024</a>)</cite>, and bottom row models are trained on UltraInteract <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib47" title="">2024a</a>)</cite>. Left column models are evaluated on either UltraFeedback or UltraInteract, and right column models are evaluated on RewardBench <cite class="ltx_cite ltx_citemacro_citep">(Lambert et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib25" title="">2024</a>)</cite>.
Solid line methods are sampled to produce final answers and shading reflects a 95% confidence interval.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">In addition to the previously discussed benefits, using LLMs as reward models also allows us to utilize additional inference time compute to improve performance. Indeed our results from the previous sections show that using COT prompting to induce reasoning in the evaluator model can significantly improve performance on new prompts and tasks over the base GenRM approach (which does not use CoT). In this section we show further results on accuracy using self-consistency and majority voting. Our results are shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.F5" title="Figure 5 ‣ 5.4 Using Inference-Time Compute ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">5</span></a>. We see that majority voting at 32 improves performance consistently and adds 1.6% accuracy on the UltraFeedback Dataset and 3.8% on RewardBench in that case. On UltraInteract majority voting improves performance by 4.6% and 4.9% on RewardBench. This indicates that ”System 2” types of reasoning approaches can significantly improve the accuracy of the critic model. We believe using models with strong reasoning to provide feedback and evaluation to other models is a promising direction.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">The concept of using language models for providing feedback, also known as constitutional AI or RLAIF <cite class="ltx_cite ltx_citemacro_cite">Bai et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib9" title="">2022b</a>)</cite> has gained significant traction in recent years. <cite class="ltx_cite ltx_citemacro_citet">Zheng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib54" title="">2023b</a>)</cite> further popularized the paradigm of LLM evaluation (”LLM-as-a-judge”), demonstrating that strong language models can effectively perform judgments with chain-of-thought (CoT) reasoning that approximate human evaluation. Building on this, <cite class="ltx_cite ltx_citemacro_citet">Kim et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib23" title="">2024</a>)</cite> proposed Prometheus, employing supervised fine-tuning from a powerful model to provide CoT reasoning and scoring, demonstrating strong evaluation performance from a smaller open model. In the current work we show that zero-shot LLM evaluations may not fully align with human feedback and significant improvements in accuracy can be gained from additional fine-tuning. Moreover, in our proposed approach of combining RLAIF with STaR-based tuning we do not require ground-truth reasoning or supervision from a stronger model. Concurrently with this work, <cite class="ltx_cite ltx_citemacro_citet">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib52" title="">2024</a>)</cite> presented Generative Verifiers, training CoT-GenRM with an SFT objective to act as a verifier for mathematical reasoning. They find similiar observations to our experiments in Sections <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.SS2" title="5.2 Performance on Reasoning Tasks ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">5.2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.SS4" title="5.4 Using Inference-Time Compute ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">5.4</span></a>. However, one notable exception is that unlike our approach they rely on access to full reference solutions at training time. Another concurrent work in this direction is <cite class="ltx_cite ltx_citemacro_citet">Ankner et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib5" title="">2024</a>)</cite>, which combines CoT reasoning generation with Bradley-Terry reward modelling. They present empirical findings on the benefits of reasoning, similar to the ones we show in Section <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#S5.SS1" title="5.1 Performance of Generative RMs on General Assistant Tasks ‣ 5 Experiments ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">5.1</span></a>, although crucially, they rely on a separate strong model to provide rationales and require the Bradley-Terry reward model hybrid architecture, while we use fully self-bootstrapped rationales in a full language modelling setup without the need for any additional architecture overhang.</p>
</div>
<div class="ltx_para ltx_noindent" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">A number of concurrent works have also proposed approaches for self-bootstrapping generative critics. In <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib41" title="">2024c</a>)</cite>, the authors present an approach similar to our STaR-SFT method using data augmentation to create synthetic preference pairs. On the other hand <cite class="ltx_cite ltx_citemacro_citet">Wu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib43" title="">2024</a>)</cite> instead uses DPO for optimizing the evaluator, but the feedback is based on additional meta-judge evaluator. Similarly, <cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib39" title="">2024b</a>)</cite> also generates data using a number of augmentation techniques and deploys DPO training. We note that these data generation techniques are complementary to our approach which focuses on using STaR-based methods to allign LLM generative reward models and replace explicit reward models.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion and Future Directions</h2>
<div class="ltx_para ltx_noindent" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">To conclude, this work introduces Generative Reward Models (GenRM) as a novel framework that combines the strengths of Reinforcement Learning from Human Feedback (RLHF) and Reinforcement Learning from AI Feedback (RLAIF) to improve preference modeling for large language models (LLMs). By leveraging self-generated reasoning traces and iterative training loops, GenRM can fine-tune LLMs to better align with human preferences, addressing some of the key limitations associated with both human and AI feedback mechanisms.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">The GenRM approach demonstrates that integrating chain-of-thought reasoning within preference modeling can significantly improve both in-distribution and out-of-distribution performance. In particular, the model surpasses traditional Bradley-Terry reward models on out-of-distribution tasks, showcasing a promising avenue for scaling reinforcement learning systems beyond their training data.
We proposed a Chain-of-Thought (CoT) GenRM variant, which augments preference judgment tasks with intermediate reasoning traces. This addition boosted model performance by encouraging more logical, step-wise decision-making, leading to better generalization on complex tasks such as reasoning and safety-related scenarios.
Empirical results show that GenRM and its variants maintain competitive in-distribution accuracy while outperforming traditional methods on out-of-distribution tasks. Notably, STaR-DPO models, which rely on reasoning-based preference optimization, demonstrated superior robustness and performance across different benchmarks.
Implications of the Proposed Approach
The implications of the GenRM framework are multifaceted and offer significant contributions to both theoretical and practical advancements in AI alignment, reward modeling, and scalable preference optimization:</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p3">
<p class="ltx_p" id="S7.p3.1"><span class="ltx_text ltx_font_bold" id="S7.p3.1.1">Scalability and Efficiency</span>: By utilizing AI-generated feedback in the form of synthetic preferences, GenRM reduces the need for resource-intensive human annotation, making it a more scalable solution for improving LLM behavior in real-world applications.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p4">
<p class="ltx_p" id="S7.p4.1"><span class="ltx_text ltx_font_bold" id="S7.p4.1.1">Generalization to Out-of-Distribution Tasks</span>: One of the persistent challenges in reinforcement learning and reward modeling is ensuring robust performance across a wide range of tasks, especially those not represented in training data. The proposed model shows improved generalization to out-of-distribution tasks, which is essential for deploying LLMs in diverse, dynamic environments.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p5">
<p class="ltx_p" id="S7.p5.1"><span class="ltx_text ltx_font_bold" id="S7.p5.1.1">Alignment with Human Values</span>: While the method still incorporates human feedback in initial stages, the reliance on AI feedback allows for more rapid iterations and refinement. This hybrid approach ensures that the model remains aligned with human values while benefiting from the flexibility and speed of AI-driven optimization. The nature of the generative reward model also holds promise for the problem of pluralistic alignment <cite class="ltx_cite ltx_citemacro_cite">Sorensen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib35" title="">2024</a>); Castricato et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib12" title="">2024</a>)</cite> - i.e. aligning a model with diverse and potentially conflicting views, since they can model the underlying rational driving those preferences. This is something which classical Bradley-Terry reward model formulation, which uses a single point estimate, is not able to accommodate.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p6">
<p class="ltx_p" id="S7.p6.1">While this study has shown the promise of Generative Reward Models, several areas remain open for further exploration.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p7">
<p class="ltx_p" id="S7.p7.1"><span class="ltx_text ltx_font_bold" id="S7.p7.1.1">Refining Post-Rationalization Techniques</span>: One limitation observed in the current CoT-GenRM approach is the potential misalignment when incorrect rationales are generated. Developing more sophisticated post-rationalization techniques, such as leveraging stronger models for intermediate reasoning or implementing novel correction mechanisms, could further enhance performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p8">
<p class="ltx_p" id="S7.p8.1"><span class="ltx_text ltx_font_bold" id="S7.p8.1.1">Exploring Iterative Online Optimization</span>: Although GenRM benefits from the offline fine-tuning approach, the integration of iterative online optimization techniques could enhance its ability to adapt to new environments and feedback in real-time. Online preference optimization could reduce the lag between model deployment and alignment improvements, making it more responsive in dynamic settings.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p9">
<p class="ltx_p" id="S7.p9.1"><span class="ltx_text ltx_font_bold" id="S7.p9.1.1">Adapting to Multimodal Feedback</span>: Future research could explore the extension of GenRM beyond textual preferences to multi-modal tasks. Integrating visual, auditory, and even environmental feedback could broaden the application of this approach to more complex real-world problems and VLMs have already proven to provide reasonable feedback in a zero-shot setting <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib13" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p10">
<p class="ltx_p" id="S7.p10.1"><span class="ltx_text ltx_font_bold" id="S7.p10.1.1">Addressing Robustness in Adversarial Settings</span>: An interesting direction for further work is the robustness of the model in adversarial settings. A particular pertinent direction si evaluation the ”reward hacking” <cite class="ltx_cite ltx_citemacro_cite">Gao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib18" title="">2023</a>); Rafailov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib32" title="">2024</a>)</cite> issues with Generative RMs Our results on out-of-distribution generalization of GenRMs make this a promising direction.</p>
</div>
<div class="ltx_para ltx_noindent" id="S7.p11">
<p class="ltx_p" id="S7.p11.1"><span class="ltx_text ltx_font_bold" id="S7.p11.1.1">Improving Data Selection for Iterative Methods</span>: Data selection has proven to be critical for model performance in pretraining and task-specific fine-tuning <cite class="ltx_cite ltx_citemacro_citep">(Xie et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib44" title="">2023</a>; Albalak et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib3" title="">2024</a>; Li et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib26" title="">2024</a>; Albalak et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib2" title="">2023</a>)</cite>. However, selecting optimal samples for both SFT and pairwise versions of iterative training methods in RLAIF remains an understudied issue, with large potential for progress <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib40" title="">2023</a>; Zhu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib57" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S7.p12">
<p class="ltx_p" id="S7.p12.1">In summary, Generative Reward Models (GenRM) present a significant advancement in combining human and AI feedback to enhance preference modeling and alignment in LLMs. The hybrid approach improves scalability, out-of-distribution generalization, and model performance, making it a compelling framework for developing more reliable, aligned, and efficient AI systems. Moving forward, further exploration into online optimization, robust reasoning, and adaptation to multimodal tasks will be key to realizing the full potential of this framework in practical deployments.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ahmadian et al. (2024)</span>
<span class="ltx_bibblock">
Arash Ahmadian, Chris Cremer, Matthias Gallé, Marzieh Fadaee, Julia Kreutzer, Olivier Pietquin, Ahmet Üstün, and Sara Hooker.

</span>
<span class="ltx_bibblock">Back to basics: Revisiting reinforce style optimization for learning from human feedback in llms, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.14740" title="">https://arxiv.org/abs/2402.14740</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Albalak et al. (2023)</span>
<span class="ltx_bibblock">
Alon Albalak, Colin A Raffel, and William Yang Wang.

</span>
<span class="ltx_bibblock">Improving few-shot generalization by exploring and exploiting auxiliary data.

</span>
<span class="ltx_bibblock">In A. Oh, T. Naumann, A. Globerson, K. Saenko, M. Hardt, and S. Levine (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Advances in Neural Information Processing Systems</em>, volume 36, pp.  24754–24780. Curran Associates, Inc., 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2023/file/4e3c5399729e06d2f0c22d04416904ab-Paper-Conference.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2023/file/4e3c5399729e06d2f0c22d04416904ab-Paper-Conference.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Albalak et al. (2024)</span>
<span class="ltx_bibblock">
Alon Albalak, Yanai Elazar, Sang Michael Xie, Shayne Longpre, Nathan Lambert, Xinyi Wang, Niklas Muennighoff, Bairu Hou, Liangming Pan, Haewon Jeong, Colin Raffel, Shiyu Chang, Tatsunori Hashimoto, and William Yang Wang.

</span>
<span class="ltx_bibblock">A survey on data selection for language models, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.16827" title="">https://arxiv.org/abs/2402.16827</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Andukuri et al. (2024)</span>
<span class="ltx_bibblock">
Chinmaya Andukuri, Jan-Philipp Fränken, Tobias Gerstenberg, and Noah D. Goodman.

</span>
<span class="ltx_bibblock">Star-gate: Teaching language models to ask clarifying questions, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ankner et al. (2024)</span>
<span class="ltx_bibblock">
Zachary Ankner, Mansheej Paul, Brandon Cui, Jonathan D. Chang, and Prithviraj Ammanabrolu.

</span>
<span class="ltx_bibblock">Critique-out-loud reward models, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2408.11791" title="">https://arxiv.org/abs/2408.11791</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Askell et al. (2021)</span>
<span class="ltx_bibblock">
Amanda Askell, Yuntao Bai, Anna Chen, Dawn Drain, Deep Ganguli, Tom Henighan, Andy Jones, Nicholas Joseph, Ben Mann, Nova DasSarma, et al.

</span>
<span class="ltx_bibblock">A general language assistant as a laboratory for alignment.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2112.00861</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Azar et al. (2023)</span>
<span class="ltx_bibblock">
Mohammad Gheshlaghi Azar, Mark Rowland, Bilal Piot, Daniel Guo, Daniele Calandriello, Michal Valko, and Rémi Munos.

</span>
<span class="ltx_bibblock">A general theoretical paradigm to understand learning from human preferences, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2022a)</span>
<span class="ltx_bibblock">
Yuntao Bai, Andy Jones, Kamal Ndousse, Amanda Askell, Anna Chen, Nova DasSarma, Dawn Drain, Stanislav Fort, Deep Ganguli, Tom Henighan, Nicholas Joseph, Saurav Kadavath, Jackson Kernion, Tom Conerly, Sheer El-Showk, Nelson Elhage, Zac Hatfield-Dodds, Danny Hernandez, Tristan Hume, Scott Johnston, Shauna Kravec, Liane Lovitt, Neel Nanda, Catherine Olsson, Dario Amodei, Tom Brown, Jack Clark, Sam McCandlish, Chris Olah, Ben Mann, and Jared Kaplan.

</span>
<span class="ltx_bibblock">Training a helpful and harmless assistant with reinforcement learning from human feedback, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. (2022b)</span>
<span class="ltx_bibblock">
Yuntao Bai, Saurav Kadavath, Sandipan Kundu, Amanda Askell, Jackson Kernion, Andy Jones, Anna Chen, Anna Goldie, Azalia Mirhoseini, Cameron McKinnon, Carol Chen, Catherine Olsson, Christopher Olah, Danny Hernandez, Dawn Drain, Deep Ganguli, Dustin Li, Eli Tran-Johnson, Ethan Perez, Jamie Kerr, Jared Mueller, Jeffrey Ladish, Joshua Landau, Kamal Ndousse, Kamile Lukosuite, Liane Lovitt, Michael Sellitto, Nelson Elhage, Nicholas Schiefer, Noemi Mercado, Nova DasSarma, Robert Lasenby, Robin Larson, Sam Ringer, Scott Johnston, Shauna Kravec, Sheer El Showk, Stanislav Fort, Tamera Lanham, Timothy Telleen-Lawton, Tom Conerly, Tom Henighan, Tristan Hume, Samuel R. Bowman, Zac Hatfield-Dodds, Ben Mann, Dario Amodei, Nicholas Joseph, Sam McCandlish, Tom Brown, and Jared Kaplan.

</span>
<span class="ltx_bibblock">Constitutional ai: Harmlessness from ai feedback, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bradley &amp; Terry (1952)</span>
<span class="ltx_bibblock">
Ralph Allan Bradley and Milton E. Terry.

</span>
<span class="ltx_bibblock">Rank analysis of incomplete block designs: I. the method of paired comparisons.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Biometrika</em>, 39(3/4):324–345, 1952.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">https://doi.org/10.2307/2334029</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Calandriello et al. (2024)</span>
<span class="ltx_bibblock">
Daniele Calandriello, Daniel Guo, Remi Munos, Mark Rowland, Yunhao Tang, Bernardo Avila Pires, Pierre Harvey Richemond, Charline Le Lan, Michal Valko, Tianqi Liu, Rishabh Joshi, Zeyu Zheng, and Bilal Piot.

</span>
<span class="ltx_bibblock">Human alignment of large language models through online preference optimisation, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2403.08635" title="">https://arxiv.org/abs/2403.08635</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Castricato et al. (2024)</span>
<span class="ltx_bibblock">
Louis Castricato, Nathan Lile, Rafael Rafailov, Jan-Philipp Fränken, and Chelsea Finn.

</span>
<span class="ltx_bibblock">Persona: A reproducible testbed for pluralistic alignment, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2407.17387" title="">https://arxiv.org/abs/2407.17387</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2024)</span>
<span class="ltx_bibblock">
Zhaorun Chen, Yichao Du, Zichen Wen, Yiyang Zhou, Chenhang Cui, Zhenzhen Weng, Haoqin Tu, Chaoqi Wang, Zhengwei Tong, Qinglan Huang, Canyu Chen, Qinghao Ye, Zhihong Zhu, Yuqing Zhang, Jiawei Zhou, Zhuokai Zhao, Rafael Rafailov, Chelsea Finn, and Huaxiu Yao.

</span>
<span class="ltx_bibblock">Mj-bench: Is your multimodal reward model really a good judge for text-to-image generation?, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2407.04842" title="">https://arxiv.org/abs/2407.04842</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al. (2023)</span>
<span class="ltx_bibblock">
Ganqu Cui, Lifan Yuan, Ning Ding, Guanming Yao, Wei Zhu, Yuan Ni, Guotong Xie, Zhiyuan Liu, and Maosong Sun.

</span>
<span class="ltx_bibblock">Ultrafeedback: Boosting language models with high-quality feedback, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al. (2024)</span>
<span class="ltx_bibblock">
Ganqu Cui, Lifan Yuan, Ning Ding, Guanming Yao, Bingxiang He, Wei Zhu, Yuan Ni, Guotong Xie, Ruobing Xie, Yankai Lin, Zhiyuan Liu, and Maosong Sun.

</span>
<span class="ltx_bibblock">Ultrafeedback: Boosting language models with scaled ai feedback, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2310.01377" title="">https://arxiv.org/abs/2310.01377</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dubey et al. (2024)</span>
<span class="ltx_bibblock">
Abhimanyu Dubey, Abhinav Jauhri, Abhinav Pandey, Abhishek Kadian, Ahmad Al-Dahle, Aiesha Letman, Akhil Mathur, Alan Schelten, Amy Yang, Angela Fan, Anirudh Goyal, Anthony Hartshorn, Aobo Yang, Archi Mitra, Archie Sravankumar, Artem Korenev, Arthur Hinsvark, Arun Rao, Aston Zhang, Aurelien Rodriguez, Austen Gregerson, Ava Spataru, Baptiste Roziere, Bethany Biron, Binh Tang, Bobbie Chern, Charlotte Caucheteux, Chaya Nayak, Chloe Bi, Chris Marra, Chris McConnell, Christian Keller, Christophe Touret, Chunyang Wu, Corinne Wong, Cristian Canton Ferrer, Cyrus Nikolaidis, Damien Allonsius, Daniel Song, Danielle Pintz, Danny Livshits, David Esiobu, Dhruv Choudhary, Dhruv Mahajan, Diego Garcia-Olano, Diego Perino, Dieuwke Hupkes, Egor Lakomkin, Ehab AlBadawy, Elina Lobanova, Emily Dinan, Eric Michael Smith, Filip Radenovic, Frank Zhang, Gabriel Synnaeve, Gabrielle Lee, Georgia Lewis Anderson, Graeme Nail, Gregoire Mialon, Guan Pang, Guillem Cucurell, Hailey Nguyen, Hannah Korevaar, Hu Xu, Hugo Touvron, Iliyan Zarov,
Imanol Arrieta Ibarra, Isabel Kloumann, Ishan Misra, Ivan Evtimov, Jade Copet, Jaewon Lee, Jan Geffert, Jana Vranes, Jason Park, Jay Mahadeokar, Jeet Shah, Jelmer van der Linde, Jennifer Billock, Jenny Hong, Jenya Lee, Jeremy Fu, Jianfeng Chi, Jianyu Huang, Jiawen Liu, Jie Wang, Jiecao Yu, Joanna Bitton, Joe Spisak, Jongsoo Park, Joseph Rocca, Joshua Johnstun, Joshua Saxe, Junteng Jia, Kalyan Vasuden Alwala, Kartikeya Upasani, Kate Plawiak, Ke Li, Kenneth Heafield, Kevin Stone, Khalid El-Arini, Krithika Iyer, Kshitiz Malik, Kuenley Chiu, Kunal Bhalla, Lauren Rantala-Yeary, Laurens van der Maaten, Lawrence Chen, Liang Tan, Liz Jenkins, Louis Martin, Lovish Madaan, Lubo Malo, Lukas Blecher, Lukas Landzaat, Luke de Oliveira, Madeline Muzzi, Mahesh Pasupuleti, Mannat Singh, Manohar Paluri, Marcin Kardas, Mathew Oldham, Mathieu Rita, Maya Pavlova, Melanie Kambadur, Mike Lewis, Min Si, Mitesh Kumar Singh, Mona Hassan, Naman Goyal, Narjes Torabi, Nikolay Bashlykov, Nikolay Bogoychev, Niladri Chatterji, Olivier
Duchenne, Onur Çelebi, Patrick Alrassy, Pengchuan Zhang, Pengwei Li, Petar Vasic, Peter Weng, Prajjwal Bhargava, Pratik Dubal, Praveen Krishnan, Punit Singh Koura, Puxin Xu, Qing He, Qingxiao Dong, Ragavan Srinivasan, Raj Ganapathy, Ramon Calderer, Ricardo Silveira Cabral, Robert Stojnic, Roberta Raileanu, Rohit Girdhar, Rohit Patel, Romain Sauvestre, Ronnie Polidoro, Roshan Sumbaly, Ross Taylor, Ruan Silva, Rui Hou, Rui Wang, Saghar Hosseini, Sahana Chennabasappa, Sanjay Singh, Sean Bell, Seohyun Sonia Kim, Sergey Edunov, Shaoliang Nie, Sharan Narang, Sharath Raparthy, Sheng Shen, Shengye Wan, Shruti Bhosale, Shun Zhang, Simon Vandenhende, Soumya Batra, Spencer Whitman, Sten Sootla, Stephane Collot, Suchin Gururangan, Sydney Borodinsky, Tamar Herman, Tara Fowler, Tarek Sheasha, Thomas Georgiou, Thomas Scialom, Tobias Speckbacher, Todor Mihaylov, Tong Xiao, Ujjwal Karn, Vedanuj Goswami, Vibhor Gupta, Vignesh Ramanathan, Viktor Kerkez, Vincent Gonguet, Virginie Do, Vish Vogeti, Vladan Petrovic, Weiwei Chu,
Wenhan Xiong, Wenyin Fu, Whitney Meers, Xavier Martinet, Xiaodong Wang, Xiaoqing Ellen Tan, Xinfeng Xie, Xuchao Jia, Xuewei Wang, Yaelle Goldschlag, Yashesh Gaur, Yasmine Babaei, Yi Wen, Yiwen Song, Yuchen Zhang, Yue Li, Yuning Mao, Zacharie Delpierre Coudert, Zheng Yan, Zhengxing Chen, Zoe Papakipos, Aaditya Singh, Aaron Grattafiori, Abha Jain, Adam Kelsey, Adam Shajnfeld, Adithya Gangidi, Adolfo Victoria, Ahuva Goldstand, Ajay Menon, Ajay Sharma, Alex Boesenberg, Alex Vaughan, Alexei Baevski, Allie Feinstein, Amanda Kallet, Amit Sangani, Anam Yunus, Andrei Lupu, Andres Alvarado, Andrew Caples, Andrew Gu, Andrew Ho, Andrew Poulton, Andrew Ryan, Ankit Ramchandani, Annie Franco, Aparajita Saraf, Arkabandhu Chowdhury, Ashley Gabriel, Ashwin Bharambe, Assaf Eisenman, Azadeh Yazdan, Beau James, Ben Maurer, Benjamin Leonhardi, Bernie Huang, Beth Loyd, Beto De Paola, Bhargavi Paranjape, Bing Liu, Bo Wu, Boyu Ni, Braden Hancock, Bram Wasti, Brandon Spence, Brani Stojkovic, Brian Gamido, Britt Montalvo, Carl
Parker, Carly Burton, Catalina Mejia, Changhan Wang, Changkyu Kim, Chao Zhou, Chester Hu, Ching-Hsiang Chu, Chris Cai, Chris Tindal, Christoph Feichtenhofer, Damon Civin, Dana Beaty, Daniel Kreymer, Daniel Li, Danny Wyatt, David Adkins, David Xu, Davide Testuggine, Delia David, Devi Parikh, Diana Liskovich, Didem Foss, Dingkang Wang, Duc Le, Dustin Holland, Edward Dowling, Eissa Jamil, Elaine Montgomery, Eleonora Presani, Emily Hahn, Emily Wood, Erik Brinkman, Esteban Arcaute, Evan Dunbar, Evan Smothers, Fei Sun, Felix Kreuk, Feng Tian, Firat Ozgenel, Francesco Caggioni, Francisco Guzmán, Frank Kanayet, Frank Seide, Gabriela Medina Florez, Gabriella Schwarz, Gada Badeer, Georgia Swee, Gil Halpern, Govind Thattai, Grant Herman, Grigory Sizov, Guangyi, Zhang, Guna Lakshminarayanan, Hamid Shojanazeri, Han Zou, Hannah Wang, Hanwen Zha, Haroun Habeeb, Harrison Rudolph, Helen Suk, Henry Aspegren, Hunter Goldman, Ibrahim Damlaj, Igor Molybog, Igor Tufanov, Irina-Elena Veliche, Itai Gat, Jake Weissman, James
Geboski, James Kohli, Japhet Asher, Jean-Baptiste Gaya, Jeff Marcus, Jeff Tang, Jennifer Chan, Jenny Zhen, Jeremy Reizenstein, Jeremy Teboul, Jessica Zhong, Jian Jin, Jingyi Yang, Joe Cummings, Jon Carvill, Jon Shepard, Jonathan McPhie, Jonathan Torres, Josh Ginsburg, Junjie Wang, Kai Wu, Kam Hou U, Karan Saxena, Karthik Prasad, Kartikay Khandelwal, Katayoun Zand, Kathy Matosich, Kaushik Veeraraghavan, Kelly Michelena, Keqian Li, Kun Huang, Kunal Chawla, Kushal Lakhotia, Kyle Huang, Lailin Chen, Lakshya Garg, Lavender A, Leandro Silva, Lee Bell, Lei Zhang, Liangpeng Guo, Licheng Yu, Liron Moshkovich, Luca Wehrstedt, Madian Khabsa, Manav Avalani, Manish Bhatt, Maria Tsimpoukelli, Martynas Mankus, Matan Hasson, Matthew Lennie, Matthias Reso, Maxim Groshev, Maxim Naumov, Maya Lathi, Meghan Keneally, Michael L. Seltzer, Michal Valko, Michelle Restrepo, Mihir Patel, Mik Vyatskov, Mikayel Samvelyan, Mike Clark, Mike Macey, Mike Wang, Miquel Jubert Hermoso, Mo Metanat, Mohammad Rastegari, Munish Bansal, Nandhini
Santhanam, Natascha Parks, Natasha White, Navyata Bawa, Nayan Singhal, Nick Egebo, Nicolas Usunier, Nikolay Pavlovich Laptev, Ning Dong, Ning Zhang, Norman Cheng, Oleg Chernoguz, Olivia Hart, Omkar Salpekar, Ozlem Kalinli, Parkin Kent, Parth Parekh, Paul Saab, Pavan Balaji, Pedro Rittner, Philip Bontrager, Pierre Roux, Piotr Dollar, Polina Zvyagina, Prashant Ratanchandani, Pritish Yuvraj, Qian Liang, Rachad Alao, Rachel Rodriguez, Rafi Ayub, Raghotham Murthy, Raghu Nayani, Rahul Mitra, Raymond Li, Rebekkah Hogan, Robin Battey, Rocky Wang, Rohan Maheswari, Russ Howes, Ruty Rinott, Sai Jayesh Bondu, Samyak Datta, Sara Chugh, Sara Hunt, Sargun Dhillon, Sasha Sidorov, Satadru Pan, Saurabh Verma, Seiji Yamamoto, Sharadh Ramaswamy, Shaun Lindsay, Shaun Lindsay, Sheng Feng, Shenghao Lin, Shengxin Cindy Zha, Shiva Shankar, Shuqiang Zhang, Shuqiang Zhang, Sinong Wang, Sneha Agarwal, Soji Sajuyigbe, Soumith Chintala, Stephanie Max, Stephen Chen, Steve Kehoe, Steve Satterfield, Sudarshan Govindaprasad, Sumit Gupta,
Sungmin Cho, Sunny Virk, Suraj Subramanian, Sy Choudhury, Sydney Goldman, Tal Remez, Tamar Glaser, Tamara Best, Thilo Kohler, Thomas Robinson, Tianhe Li, Tianjun Zhang, Tim Matthews, Timothy Chou, Tzook Shaked, Varun Vontimitta, Victoria Ajayi, Victoria Montanez, Vijai Mohan, Vinay Satish Kumar, Vishal Mangla, Vítor Albiero, Vlad Ionescu, Vlad Poenaru, Vlad Tiberiu Mihailescu, Vladimir Ivanov, Wei Li, Wenchen Wang, Wenwen Jiang, Wes Bouaziz, Will Constable, Xiaocheng Tang, Xiaofang Wang, Xiaojian Wu, Xiaolan Wang, Xide Xia, Xilun Wu, Xinbo Gao, Yanjun Chen, Ye Hu, Ye Jia, Ye Qi, Yenda Li, Yilin Zhang, Ying Zhang, Yossi Adi, Youngjin Nam, Yu, Wang, Yuchen Hao, Yundi Qian, Yuzi He, Zach Rait, Zachary DeVito, Zef Rosnbrick, Zhaoduo Wen, Zhenyu Yang, and Zhiwei Zhao.

</span>
<span class="ltx_bibblock">The llama 3 herd of models, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2407.21783" title="">https://arxiv.org/abs/2407.21783</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fränken et al. (2024)</span>
<span class="ltx_bibblock">
Jan-Philipp Fränken, Eric Zelikman, Rafael Rafailov, Kanishk Gandhi, Tobias Gerstenberg, and Noah D Goodman.

</span>
<span class="ltx_bibblock">Self-supervised alignment with mutual information: Learning to follow principles without preference labels.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2404.14313</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. (2023)</span>
<span class="ltx_bibblock">
Leo Gao, John Schulman, and Jacob Hilton.

</span>
<span class="ltx_bibblock">Scaling laws for reward model overoptimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">International Conference on machine Learning</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2024)</span>
<span class="ltx_bibblock">
Shangmin Guo, Biao Zhang, Tianlin Liu, Tianqi Liu, Misha Khalman, Felipe Llinares, Alexandre Rame, Thomas Mesnard, Yao Zhao, Bilal Piot, Johan Ferret, and Mathieu Blondel.

</span>
<span class="ltx_bibblock">Direct language model alignment from online ai feedback, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.04792" title="">https://arxiv.org/abs/2402.04792</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Havrilla et al. (2023)</span>
<span class="ltx_bibblock">
Alexander Havrilla, Maksym Zhuravinskyi, Duy Phung, Aman Tiwari, Jonathan Tow, Stella Biderman, Quentin Anthony, and Louis Castricato.

</span>
<span class="ltx_bibblock">trlX: A framework for large scale reinforcement learning from human feedback.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pp.  8578–8595, Singapore, December 2023. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.18653/v1/2023.emnlp-main.530</span>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/2023.emnlp-main.530" title="">https://aclanthology.org/2023.emnlp-main.530</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hosseini et al. (2024)</span>
<span class="ltx_bibblock">
Arian Hosseini, Xingdi Yuan, Nikolay Malkin, Aaron Courville, Alessandro Sordoni, and Rishabh Agarwal.

</span>
<span class="ltx_bibblock">V-star: Training verifiers for self-taught reasoners, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023)</span>
<span class="ltx_bibblock">
Dongfu Jiang, Xiang Ren, and Bill Yuchen Lin.

</span>
<span class="ltx_bibblock">Llm-blender: Ensembling large language models with pairwise ranking and generative fusion, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2306.02561" title="">https://arxiv.org/abs/2306.02561</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2024)</span>
<span class="ltx_bibblock">
Seungone Kim, Jamin Shin, Yejin Cho, Joel Jang, Shayne Longpre, Hwaran Lee, Sangdoo Yun, Seongjin Shin, Sungdong Kim, James Thorne, and Minjoon Seo.

</span>
<span class="ltx_bibblock">Prometheus: Inducing fine-grained evaluation capability in language models, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2310.08491" title="">https://arxiv.org/abs/2310.08491</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kundu et al. (2023)</span>
<span class="ltx_bibblock">
Sandipan Kundu, Yuntao Bai, Saurav Kadavath, Amanda Askell, Andrew Callahan, Anna Chen, Anna Goldie, Avital Balwit, Azalia Mirhoseini, Brayden McLean, et al.

</span>
<span class="ltx_bibblock">Specific versus general principles for constitutional ai.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2310.13798</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lambert et al. (2024)</span>
<span class="ltx_bibblock">
Nathan Lambert, Valentina Pyatkin, Jacob Morrison, LJ Miranda, Bill Yuchen Lin, Khyathi Chandu, Nouha Dziri, Sachin Kumar, Tom Zick, Yejin Choi, Noah A. Smith, and Hannaneh Hajishirzi.

</span>
<span class="ltx_bibblock">Rewardbench: Evaluating reward models for language modeling, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024)</span>
<span class="ltx_bibblock">
Jeffrey Li, Alex Fang, Georgios Smyrnis, Maor Ivgi, Matt Jordan, Samir Gadre, Hritik Bansal, Etash Guha, Sedrick Keh, Kushal Arora, Saurabh Garg, Rui Xin, Niklas Muennighoff, Reinhard Heckel, Jean Mercat, Mayee Chen, Suchin Gururangan, Mitchell Wortsman, Alon Albalak, Yonatan Bitton, Marianna Nezhurina, Amro Abbas, Cheng-Yu Hsieh, Dhruba Ghosh, Josh Gardner, Maciej Kilian, Hanlin Zhang, Rulin Shao, Sarah Pratt, Sunny Sanyal, Gabriel Ilharco, Giannis Daras, Kalyani Marathe, Aaron Gokaslan, Jieyu Zhang, Khyathi Chandu, Thao Nguyen, Igor Vasiljevic, Sham Kakade, Shuran Song, Sujay Sanghavi, Fartash Faghri, Sewoong Oh, Luke Zettlemoyer, Kyle Lo, Alaaeldin El-Nouby, Hadi Pouransari, Alexander Toshev, Stephanie Wang, Dirk Groeneveld, Luca Soldaini, Pang Wei Koh, Jenia Jitsev, Thomas Kollar, Alexandros G. Dimakis, Yair Carmon, Achal Dave, Ludwig Schmidt, and Vaishaal Shankar.

</span>
<span class="ltx_bibblock">Datacomp-lm: In search of the next generation of training sets for language models, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2406.11794" title="">https://arxiv.org/abs/2406.11794</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Munos et al. (2024)</span>
<span class="ltx_bibblock">
Rémi Munos, Michal Valko, Daniele Calandriello, Mohammad Gheshlaghi Azar, Mark Rowland, Zhaohan Daniel Guo, Yunhao Tang, Matthieu Geist, Thomas Mesnard, Andrea Michi, Marco Selvi, Sertan Girgin, Nikola Momchev, Olivier Bachem, Daniel J. Mankowitz, Doina Precup, and Bilal Piot.

</span>
<span class="ltx_bibblock">Nash learning from human feedback, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint</em>, 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2303.08774" title="">https://arxiv.org/abs/2303.08774</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al. (2022)</span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, John Schulman, Jacob Hilton, Fraser Kelton, Luke Miller, Maddie Simens, Amanda Askell, Peter Welinder, Paul F Christiano, Jan Leike, and Ryan Lowe.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock">In S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, and A. Oh (eds.), <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Advances in Neural Information Processing Systems</em>, volume 35, pp.  27730–27744. Curran Associates, Inc., 2022.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2022/file/b1efde53be364a73914f58805a001731-Paper-Conference.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2022/file/b1efde53be364a73914f58805a001731-Paper-Conference.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang et al. (2024)</span>
<span class="ltx_bibblock">
Richard Yuanzhe Pang, Weizhe Yuan, Kyunghyun Cho, He He, Sainbayar Sukhbaatar, and Jason Weston.

</span>
<span class="ltx_bibblock">Iterative reasoning preference optimization, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2404.19733" title="">https://arxiv.org/abs/2404.19733</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et al. (2023)</span>
<span class="ltx_bibblock">
Rafael Rafailov, Archit Sharma, Eric Mitchell, Christopher D Manning, Stefano Ermon, and Chelsea Finn.

</span>
<span class="ltx_bibblock">Direct preference optimization: Your language model is secretly a reward model.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Thirty-seventh Conference on Neural Information Processing Systems</em>, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2305.18290" title="">https://arxiv.org/abs/2305.18290</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et al. (2024)</span>
<span class="ltx_bibblock">
Rafael Rafailov, Yaswanth Chittepu, Ryan Park, Harshit Sikchi, Joey Hejna, Bradley Knox, Chelsea Finn, and Scott Niekum.

</span>
<span class="ltx_bibblock">Scaling laws for reward model overoptimization in direct alignment algorithms, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2406.02900" title="">https://arxiv.org/abs/2406.02900</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reid et al. (2024)</span>
<span class="ltx_bibblock">
Machel Reid, Nikolay Savinov, Denis Teplyashin, Dmitry Lepikhin, Timothy Lillicrap, Jean-baptiste Alayrac, Radu Soricut, Angeliki Lazaridou, Orhan Firat, Julian Schrittwieser, et al.

</span>
<span class="ltx_bibblock">Gemini 1.5: Unlocking multimodal understanding across millions of tokens of context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2403.05530</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al. (2017)</span>
<span class="ltx_bibblock">
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sorensen et al. (2024)</span>
<span class="ltx_bibblock">
Taylor Sorensen, Jared Moore, Jillian Fisher, Mitchell Gordon, Niloofar Mireshghallah, Christopher Michael Rytting, Andre Ye, Liwei Jiang, Ximing Lu, Nouha Dziri, Tim Althoff, and Yejin Choi.

</span>
<span class="ltx_bibblock">A roadmap to pluralistic alignment, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2402.05070" title="">https://arxiv.org/abs/2402.05070</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stiennon et al. (2022)</span>
<span class="ltx_bibblock">
Nisan Stiennon, Long Ouyang, Jeff Wu, Daniel M. Ziegler, Ryan Lowe, Chelsea Voss, Alec Radford, Dario Amodei, and Paul Christiano.

</span>
<span class="ltx_bibblock">Learning to summarize from human feedback, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">von Werra et al. (2020)</span>
<span class="ltx_bibblock">
Leandro von Werra, Younes Belkada, Lewis Tunstall, Edward Beeching, Tristan Thrush, Nathan Lambert, Shengyi Huang, Kashif Rasul, and Quentin Gallouédec.

</span>
<span class="ltx_bibblock">Trl: Transformer reinforcement learning.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/huggingface/trl" title="">https://github.com/huggingface/trl</a>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024a)</span>
<span class="ltx_bibblock">
Binghai Wang, Rui Zheng, Lu Chen, Yan Liu, Shihan Dou, Caishuang Huang, Wei Shen, Senjie Jin, Enyu Zhou, Chenyu Shi, Songyang Gao, Nuo Xu, Yuhao Zhou, Xiaoran Fan, Zhiheng Xi, Jun Zhao, Xiao Wang, Tao Ji, Hang Yan, Lixing Shen, Zhan Chen, Tao Gui, Qi Zhang, Xipeng Qiu, Xuanjing Huang, Zuxuan Wu, and Yu-Gang Jiang.

</span>
<span class="ltx_bibblock">Secrets of rlhf in large language models part ii: Reward modeling, 2024a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2401.06080" title="">https://arxiv.org/abs/2401.06080</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024b)</span>
<span class="ltx_bibblock">
Peifeng Wang, Austin Xu, Yilun Zhou, Caiming Xiong, and Shafiq Joty.

</span>
<span class="ltx_bibblock">Direct judgement preference optimization, 2024b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2409.14664" title="">https://arxiv.org/abs/2409.14664</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023)</span>
<span class="ltx_bibblock">
Tianlu Wang, Ping Yu, Xiaoqing Ellen Tan, Sean O’Brien, Ramakanth Pasunuru, Jane Dwivedi-Yu, Olga Golovneva, Luke Zettlemoyer, Maryam Fazel-Zarandi, and Asli Celikyilmaz.

</span>
<span class="ltx_bibblock">Shepherd: A critic for language model generation, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2308.04592" title="">https://arxiv.org/abs/2308.04592</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024c)</span>
<span class="ltx_bibblock">
Tianlu Wang, Ilia Kulikov, Olga Golovneva, Ping Yu, Weizhe Yuan, Jane Dwivedi-Yu, Richard Yuanzhe Pang, Maryam Fazel-Zarandi, Jason Weston, and Xian Li.

</span>
<span class="ltx_bibblock">Self-taught evaluators, 2024c.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2408.02666" title="">https://arxiv.org/abs/2408.02666</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2023)</span>
<span class="ltx_bibblock">
Tianhao Wu, Banghua Zhu, Ruoyu Zhang, Zhaojin Wen, Kannan Ramchandran, and Jiantao Jiao.

</span>
<span class="ltx_bibblock">Pairwise proximal policy optimization: Harnessing relative feedback for llm alignment, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2310.00212" title="">https://arxiv.org/abs/2310.00212</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2024)</span>
<span class="ltx_bibblock">
Tianhao Wu, Weizhe Yuan, Olga Golovneva, Jing Xu, Yuandong Tian, Jiantao Jiao, Jason Weston, and Sainbayar Sukhbaatar.

</span>
<span class="ltx_bibblock">Meta-rewarding language models: Self-improving alignment with llm-as-a-meta-judge, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2407.19594" title="">https://arxiv.org/abs/2407.19594</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2023)</span>
<span class="ltx_bibblock">
Sang Michael Xie, Shibani Santurkar, Tengyu Ma, and Percy Liang.

</span>
<span class="ltx_bibblock">Data selection for language models via importance resampling, 2023.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2302.03169" title="">https://arxiv.org/abs/2302.03169</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2024a)</span>
<span class="ltx_bibblock">
Jing Xu, Andrew Lee, Sainbayar Sukhbaatar, and Jason Weston.

</span>
<span class="ltx_bibblock">Some things are more cringe than others: Iterative preference optimization with the pairwise cringe loss, 2024a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2312.16682" title="">https://arxiv.org/abs/2312.16682</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2024b)</span>
<span class="ltx_bibblock">
Shusheng Xu, Wei Fu, Jiaxuan Gao, Wenjie Ye, Weilin Liu, Zhiyu Mei, Guangju Wang, Chao Yu, and Yi Wu.

</span>
<span class="ltx_bibblock">Is dpo superior to ppo for llm alignment? a comprehensive study, 2024b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2404.10719" title="">https://arxiv.org/abs/2404.10719</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al. (2024a)</span>
<span class="ltx_bibblock">
Lifan Yuan, Ganqu Cui, Hanbin Wang, Ning Ding, Xingyao Wang, Jia Deng, Boji Shan, Huimin Chen, Ruobing Xie, Yankai Lin, Zhenghao Liu, Bowen Zhou, Hao Peng, Zhiyuan Liu, and Maosong Sun.

</span>
<span class="ltx_bibblock">Advancing llm reasoning generalists with preference trees, 2024a.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2404.02078" title="">https://arxiv.org/abs/2404.02078</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al. (2024b)</span>
<span class="ltx_bibblock">
Lifan Yuan, Ganqu Cui, Hanbin Wang, Ning Ding, Xingyao Wang, Jia Deng, Boji Shan, Huimin Chen, Ruobing Xie, Yankai Lin, et al.

</span>
<span class="ltx_bibblock">Advancing llm reasoning generalists with preference trees.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">arXiv preprint arXiv:2404.02078</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zelikman et al. (2022)</span>
<span class="ltx_bibblock">
Eric Zelikman, Yuhuai Wu, Jesse Mu, and Noah Goodman.

</span>
<span class="ltx_bibblock">Star: Bootstrapping reasoning with reasoning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">Advances in Neural Information Processing Systems</em>, 35:15476–15488, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zelikman et al. (2024)</span>
<span class="ltx_bibblock">
Eric Zelikman, Georges Harik, Yijia Shao, Varuna Jayasiri, Nick Haber, and Noah D Goodman.

</span>
<span class="ltx_bibblock">Quiet-star: Language models can teach themselves to think before speaking.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">arXiv preprint arXiv:2403.09629</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeng et al. (2023)</span>
<span class="ltx_bibblock">
Zhiyuan Zeng, Jiatong Yu, Tianyu Gao, Yu Meng, Tanya Goyal, and Danqi Chen.

</span>
<span class="ltx_bibblock">Evaluating large language models at evaluating instruction following.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">arXiv preprint arXiv:2310.07641</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
Lunjun Zhang, Arian Hosseini, Hritik Bansal, Mehran Kazemi, Aviral Kumar, and Rishabh Agarwal.

</span>
<span class="ltx_bibblock">Generative verifiers: Reward modeling as next-token prediction, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2408.15240" title="">https://arxiv.org/abs/2408.15240</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2023a)</span>
<span class="ltx_bibblock">
Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric P. Xing, Hao Zhang, Joseph E. Gonzalez, and Ion Stoica.

</span>
<span class="ltx_bibblock">Judging llm-as-a-judge with mt-bench and chatbot arena.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Conference on Neural Information Processing Systems Track on Datasets and Benchmarks.</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2023b)</span>
<span class="ltx_bibblock">
Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric P. Xing, Hao Zhang, Joseph E. Gonzalez, and Ion Stoica.

</span>
<span class="ltx_bibblock">Judging llm-as-a-judge with mt-bench and chatbot arena, 2023b.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2306.05685" title="">https://arxiv.org/abs/2306.05685</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2024)</span>
<span class="ltx_bibblock">
Lianmin Zheng, Liangsheng Yin, Zhiqiang Xie, Chuyue Sun, Jeff Huang, Cody Hao Yu, Shiyi Cao, Christos Kozyrakis, Ion Stoica, Joseph E. Gonzalez, Clark Barrett, and Ying Sheng.

</span>
<span class="ltx_bibblock">Sglang: Efficient execution of structured language model programs, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2312.07104" title="">https://arxiv.org/abs/2312.07104</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. (2023c)</span>
<span class="ltx_bibblock">
Rui Zheng, Shihan Dou, Songyang Gao, Yuan Hua, Wei Shen, Binghai Wang, Yan Liu, Senjie Jin, Qin Liu, Yuhao Zhou, Limao Xiong, Lu Chen, Zhiheng Xi, Nuo Xu, Wenbin Lai, Minghao Zhu, Cheng Chang, Zhangyue Yin, Rongxiang Weng, Wensen Cheng, Haoran Huang, Tianxiang Sun, Hang Yan, Tao Gui, Qi Zhang, Xipeng Qiu, and Xuanjing Huang.

</span>
<span class="ltx_bibblock">Secrets of rlhf in large language models part i: Ppo, 2023c.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://arxiv.org/abs/2307.04964" title="">https://arxiv.org/abs/2307.04964</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2024)</span>
<span class="ltx_bibblock">
Banghua Zhu, Evan Frick, Tianhao Wu, Hanlin Zhu, Karthik Ganesan, Wei-Lin Chiang, Jian Zhang, and Jiantao Jiao.

</span>
<span class="ltx_bibblock">Starling-7b: Improving helpfulness and harmlessness with RLAIF.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">First Conference on Language Modeling</em>, 2024.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=GqDntYTTbk" title="">https://openreview.net/forum?id=GqDntYTTbk</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ziegler et al. (2020)</span>
<span class="ltx_bibblock">
Daniel M. Ziegler, Nisan Stiennon, Jeffrey Wu, Tom B. Brown, Alec Radford, Dario Amodei, Paul Christiano, and Geoffrey Irving.

</span>
<span class="ltx_bibblock">Fine-tuning language models from human preferences, 2020.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Additional Experiment Details</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Prompts</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">Our prompts follow <cite class="ltx_cite ltx_citemacro_citet">Zheng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib53" title="">2023a</a>)</cite> with the following differences.
For our LLM-as-a-judge and STaR (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1.F6" title="Figure 6 ‣ A.1 Prompts ‣ Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">6</span></a>), we remove the tie.
For GenRM (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1.F8" title="Figure 8 ‣ A.1 Prompts ‣ Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">8</span></a>), we remove the brackets, and remove the explanation request in the system prompt.
For Rationalizer (Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1.F7" title="Figure 7 ‣ A.1 Prompts ‣ Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">7</span></a>), we remove the output instructions from the system prompt, and add a prompt to explain why A or B is better.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1">All prompts are using llama 3.1 instruct chat templates to format the prompts</p>
</div>
<figure class="ltx_figure" id="A1.F6">
<p class="ltx_p" id="A1.F6.1">
<span class="ltx_inline-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" id="A1.F6.1.1" style="width:389.5pt;">
<span class="ltx_p" id="A1.F6.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.F6.1.1.1.1">System:</span></span>
<span class="ltx_p" id="A1.F6.1.1.2">Please act as an impartial judge and evaluate the quality of the responses provided by two AI assistants to the user question displayed below. You should choose the assistant that follows the user’s instructions and answers the user’s question better. Your evaluation should consider factors such as the helpfulness, relevance, accuracy, depth, creativity, and level of detail of their responses. Begin your evaluation by comparing the two responses and provide a short explanation. Avoid any position biases and ensure that the order in which the responses were presented does not influence your decision. Do not allow the length of the responses to influence your evaluation. Do not favor certain names of the assistants. Be as objective as possible. After providing your explanation, output your final verdict by strictly following this format: ”[[A]]” if assistant A is better, ”[[B]]” if assistant B is better</span>
<span class="ltx_p" id="A1.F6.1.1.3"><span class="ltx_text ltx_font_bold" id="A1.F6.1.1.3.1">User:</span></span>
<span class="ltx_p" id="A1.F6.1.1.4">[Chat Context]</span>
<span class="ltx_p" id="A1.F6.1.1.5"><span class="ltx_text" id="A1.F6.1.1.5.1" style="color:#0000FF;">{chat}
<br class="ltx_break"/>
<br class="ltx_break"/></span>[The Start of Assistant A’s Answer]</span>
<span class="ltx_p" id="A1.F6.1.1.6"><span class="ltx_text" id="A1.F6.1.1.6.1" style="color:#0000FF;">{answer_a}
<br class="ltx_break"/></span>[The End of Assistant A’s Answer]</span>
<span class="ltx_p" id="A1.F6.1.1.7">[The Start of Assistant B’s Answer]</span>
<span class="ltx_p" id="A1.F6.1.1.8"><span class="ltx_text" id="A1.F6.1.1.8.1" style="color:#0000FF;">{answer_b}
<br class="ltx_break"/></span>[The End of Assistant B’s Answer]</span>
</span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Prompt structure for LLM-as-a-Judge and STaR-SFT/DPO methods</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F7">
<p class="ltx_p" id="A1.F7.1">
<span class="ltx_inline-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" id="A1.F7.1.1" style="width:389.5pt;">
<span class="ltx_p" id="A1.F7.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.F7.1.1.1.1">System:</span></span>
<span class="ltx_p" id="A1.F7.1.1.2">Please act as an impartial judge and evaluate the quality of the responses provided by two AI assistants to the user question displayed below. You should choose the assistant that follows the user’s instructions and answers the user’s question better. Your evaluation should consider factors such as the helpfulness, relevance, accuracy, depth, creativity, and level of detail of their responses. Begin your evaluation by comparing the two responses and provide a short explanation. Avoid any position biases and ensure that the order in which the responses were presented does not influence your decision. Do not allow the length of the responses to influence your evaluation. Do not favor certain names of the assistants. Be as objective as possible.</span>
<span class="ltx_p" id="A1.F7.1.1.3"><span class="ltx_text ltx_font_bold" id="A1.F7.1.1.3.1">User:</span></span>
<span class="ltx_p" id="A1.F7.1.1.4">[Chat Context]</span>
<span class="ltx_p" id="A1.F7.1.1.5"><span class="ltx_text" id="A1.F7.1.1.5.1" style="color:#0000FF;">{chat}
<br class="ltx_break"/>
<br class="ltx_break"/></span>[The Start of Assistant A’s Answer]</span>
<span class="ltx_p" id="A1.F7.1.1.6"><span class="ltx_text" id="A1.F7.1.1.6.1" style="color:#0000FF;">{answer_a}
<br class="ltx_break"/></span>[The End of Assistant A’s Answer]</span>
<span class="ltx_p" id="A1.F7.1.1.7">[The Start of Assistant B’s Answer]</span>
<span class="ltx_p" id="A1.F7.1.1.8"><span class="ltx_text" id="A1.F7.1.1.8.1" style="color:#0000FF;">{answer_b}
<br class="ltx_break"/></span>[The End of Assistant B’s Answer]</span>
<span class="ltx_p" id="A1.F7.1.1.9">Explain why response (A/B) is better than response (B/A).</span>
</span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Prompt structure for generating rationals for rationalizer methods</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F8">
<p class="ltx_p" id="A1.F8.1">
<span class="ltx_inline-block ltx_minipage ltx_align_middle ltx_framed ltx_framed_rectangle" id="A1.F8.1.1" style="width:389.5pt;">
<span class="ltx_p" id="A1.F8.1.1.1"><span class="ltx_text ltx_font_bold" id="A1.F8.1.1.1.1">System:</span>
Please act as an impartial judge and evaluate the quality of the responses provided by two AI assistants to the user question displayed below. You should choose the assistant that follows the user’s instructions and answers the user’s question better. Your evaluation should consider factors such as the helpfulness, relevance, accuracy, depth, creativity, and level of detail of their responses. Avoid any position biases and ensure that the order in which the responses were presented does not influence your decision. Do not allow the length of the responses to influence your evaluation. Do not favor certain names of the assistants. Be as objective as possible. Output your verdict by strictly following this format: ”A” if assistant A is better, ”B” if assistant B is better</span>
<span class="ltx_p" id="A1.F8.1.1.2"><span class="ltx_text ltx_font_bold" id="A1.F8.1.1.2.1">User:</span></span>
<span class="ltx_p" id="A1.F8.1.1.3">[Chat Context]</span>
<span class="ltx_p" id="A1.F8.1.1.4"><span class="ltx_text" id="A1.F8.1.1.4.1" style="color:#0000FF;">{chat}
<br class="ltx_break"/>
<br class="ltx_break"/></span>[The Start of Assistant A’s Answer]</span>
<span class="ltx_p" id="A1.F8.1.1.5"><span class="ltx_text" id="A1.F8.1.1.5.1" style="color:#0000FF;">{answer_a}
<br class="ltx_break"/></span>[The End of Assistant A’s Answer]</span>
<span class="ltx_p" id="A1.F8.1.1.6">[The Start of Assistant B’s Answer]</span>
<span class="ltx_p" id="A1.F8.1.1.7"><span class="ltx_text" id="A1.F8.1.1.7.1" style="color:#0000FF;">{answer_b}
<br class="ltx_break"/></span>[The End of Assistant B’s Answer]</span>
</span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Prompt structure for GenRM methods</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Hyperparameters</h3>
<section class="ltx_subsubsection" id="A1.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.1 </span>Training Hyperparameters</h4>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS1.p1">
<p class="ltx_p" id="A1.SS2.SSS1.p1.1">Models use the same hyperparameters across each dataset. Table <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#A1.T2" title="Table 2 ‣ A.2.1 Training Hyperparameters ‣ A.2 Hyperparameters ‣ Appendix A Additional Experiment Details ‣ Generative Reward Models"><span class="ltx_text ltx_ref_tag">2</span></a> contains our hyperparameter choices for each training method.</p>
</div>
<figure class="ltx_table" id="A1.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A1.T2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A1.T2.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="A1.T2.2.2.3">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T2.2.2.4">AdamW LR</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T2.1.1.1">
<table class="ltx_tabular ltx_align_middle" id="A1.T2.1.1.1.1">
<tr class="ltx_tr" id="A1.T2.1.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.1.1.1.1.2.1">AdamW</td>
</tr>
<tr class="ltx_tr" id="A1.T2.1.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.1.1.1.1.1.1"><math alttext="(\beta_{1},\beta_{2})" class="ltx_Math" display="inline" id="A1.T2.1.1.1.1.1.1.m1.2"><semantics id="A1.T2.1.1.1.1.1.1.m1.2a"><mrow id="A1.T2.1.1.1.1.1.1.m1.2.2.2" xref="A1.T2.1.1.1.1.1.1.m1.2.2.3.cmml"><mo id="A1.T2.1.1.1.1.1.1.m1.2.2.2.3" stretchy="false" xref="A1.T2.1.1.1.1.1.1.m1.2.2.3.cmml">(</mo><msub id="A1.T2.1.1.1.1.1.1.m1.1.1.1.1" xref="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.cmml"><mi id="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.2" xref="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.2.cmml">β</mi><mn id="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.3" xref="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="A1.T2.1.1.1.1.1.1.m1.2.2.2.4" xref="A1.T2.1.1.1.1.1.1.m1.2.2.3.cmml">,</mo><msub id="A1.T2.1.1.1.1.1.1.m1.2.2.2.2" xref="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.cmml"><mi id="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.2" xref="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.2.cmml">β</mi><mn id="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.3" xref="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.3.cmml">2</mn></msub><mo id="A1.T2.1.1.1.1.1.1.m1.2.2.2.5" stretchy="false" xref="A1.T2.1.1.1.1.1.1.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.T2.1.1.1.1.1.1.m1.2b"><interval closure="open" id="A1.T2.1.1.1.1.1.1.m1.2.2.3.cmml" xref="A1.T2.1.1.1.1.1.1.m1.2.2.2"><apply id="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.cmml" xref="A1.T2.1.1.1.1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.1.cmml" xref="A1.T2.1.1.1.1.1.1.m1.1.1.1.1">subscript</csymbol><ci id="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.2.cmml" xref="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.2">𝛽</ci><cn id="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.3.cmml" type="integer" xref="A1.T2.1.1.1.1.1.1.m1.1.1.1.1.3">1</cn></apply><apply id="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.cmml" xref="A1.T2.1.1.1.1.1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.1.cmml" xref="A1.T2.1.1.1.1.1.1.m1.2.2.2.2">subscript</csymbol><ci id="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.2.cmml" xref="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.2">𝛽</ci><cn id="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.3.cmml" type="integer" xref="A1.T2.1.1.1.1.1.1.m1.2.2.2.2.3">2</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.1.1.1.1.1.1.m1.2c">(\beta_{1},\beta_{2})</annotation><annotation encoding="application/x-llamapun" id="A1.T2.1.1.1.1.1.1.m1.2d">( italic_β start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_β start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T2.2.2.5">
<table class="ltx_tabular ltx_align_middle" id="A1.T2.2.2.5.1">
<tr class="ltx_tr" id="A1.T2.2.2.5.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.2.2.5.1.1.1">Optimizer</td>
</tr>
<tr class="ltx_tr" id="A1.T2.2.2.5.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.2.2.5.1.2.1">Weight Decay</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T2.2.2.6">
<table class="ltx_tabular ltx_align_middle" id="A1.T2.2.2.6.1">
<tr class="ltx_tr" id="A1.T2.2.2.6.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.2.2.6.1.1.1">Optimizer</td>
</tr>
<tr class="ltx_tr" id="A1.T2.2.2.6.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.2.2.6.1.2.1">Schedule</td>
</tr>
</table>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T2.2.2.7">LR warmup</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="A1.T2.2.2.2"><math alttext="\beta" class="ltx_Math" display="inline" id="A1.T2.2.2.2.m1.1"><semantics id="A1.T2.2.2.2.m1.1a"><mi id="A1.T2.2.2.2.m1.1.1" xref="A1.T2.2.2.2.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.T2.2.2.2.m1.1b"><ci id="A1.T2.2.2.2.m1.1.1.cmml" xref="A1.T2.2.2.2.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T2.2.2.2.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.T2.2.2.2.m1.1d">italic_β</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T2.2.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A1.T2.2.3.1.1">STaR-SFT</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A1.T2.2.3.1.2">1.0e-6</td>
<td class="ltx_td ltx_border_t" id="A1.T2.2.3.1.3"></td>
<td class="ltx_td ltx_border_t" id="A1.T2.2.3.1.4"></td>
<td class="ltx_td ltx_border_t" id="A1.T2.2.3.1.5"></td>
<td class="ltx_td ltx_border_t" id="A1.T2.2.3.1.6"></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A1.T2.2.3.1.7">n/a</td>
</tr>
<tr class="ltx_tr" id="A1.T2.2.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T2.2.4.2.1">STaR-DPO</th>
<td class="ltx_td ltx_align_center" id="A1.T2.2.4.2.2">1.0e-6</td>
<td class="ltx_td" id="A1.T2.2.4.2.3"></td>
<td class="ltx_td" id="A1.T2.2.4.2.4"></td>
<td class="ltx_td" id="A1.T2.2.4.2.5"></td>
<td class="ltx_td" id="A1.T2.2.4.2.6"></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.2.4.2.7">1.0</td>
</tr>
<tr class="ltx_tr" id="A1.T2.2.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T2.2.5.3.1">STaR-SFT Rationalizer</th>
<td class="ltx_td ltx_align_center" id="A1.T2.2.5.3.2">2.0e-5</td>
<td class="ltx_td" id="A1.T2.2.5.3.3"></td>
<td class="ltx_td" id="A1.T2.2.5.3.4"></td>
<td class="ltx_td" id="A1.T2.2.5.3.5"></td>
<td class="ltx_td" id="A1.T2.2.5.3.6"></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.2.5.3.7">n/a</td>
</tr>
<tr class="ltx_tr" id="A1.T2.2.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T2.2.6.4.1">STaR-IPO Rationalizer</th>
<td class="ltx_td ltx_align_center" id="A1.T2.2.6.4.2">1.0e-6</td>
<td class="ltx_td ltx_align_center" id="A1.T2.2.6.4.3">(0.9, 0.95)</td>
<td class="ltx_td ltx_align_center" id="A1.T2.2.6.4.4">0.1</td>
<td class="ltx_td ltx_align_center" id="A1.T2.2.6.4.5">cosine</td>
<td class="ltx_td ltx_align_center" id="A1.T2.2.6.4.6">0.1</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.2.6.4.7">0.4</td>
</tr>
<tr class="ltx_tr" id="A1.T2.2.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T2.2.7.5.1">Bradley-Terry RM</th>
<td class="ltx_td ltx_align_center" id="A1.T2.2.7.5.2">1.0e-6</td>
<td class="ltx_td" id="A1.T2.2.7.5.3"></td>
<td class="ltx_td" id="A1.T2.2.7.5.4"></td>
<td class="ltx_td" id="A1.T2.2.7.5.5"></td>
<td class="ltx_td" id="A1.T2.2.7.5.6"></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.2.7.5.7">n/a</td>
</tr>
<tr class="ltx_tr" id="A1.T2.2.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A1.T2.2.8.6.1">GenRM</th>
<td class="ltx_td ltx_align_center" id="A1.T2.2.8.6.2">1.0e-6</td>
<td class="ltx_td" id="A1.T2.2.8.6.3"></td>
<td class="ltx_td" id="A1.T2.2.8.6.4"></td>
<td class="ltx_td" id="A1.T2.2.8.6.5"></td>
<td class="ltx_td" id="A1.T2.2.8.6.6"></td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A1.T2.2.8.6.7">n/a</td>
</tr>
<tr class="ltx_tr" id="A1.T2.2.9.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="A1.T2.2.9.7.1">PairRM</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="A1.T2.2.9.7.2">1.0e-6</td>
<td class="ltx_td ltx_border_bb" id="A1.T2.2.9.7.3"></td>
<td class="ltx_td ltx_border_bb" id="A1.T2.2.9.7.4"></td>
<td class="ltx_td ltx_border_bb" id="A1.T2.2.9.7.5"></td>
<td class="ltx_td ltx_border_bb" id="A1.T2.2.9.7.6"></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="A1.T2.2.9.7.7">n/a</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Hyperparameters for different models.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.2 </span>Generation Hyperparmeters</h4>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS2.p1">
<p class="ltx_p" id="A1.SS2.SSS2.p1.1">All models use the following settings for generation:</p>
<ul class="ltx_itemize" id="A1.I1">
<li class="ltx_item" id="A1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i1.p1">
<p class="ltx_p" id="A1.I1.i1.p1.1">SGLang version: 0.3.0 <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.12832v1#bib.bib55" title="">2024</a>)</cite></p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A1.I1.i2.p1">
<p class="ltx_p" id="A1.I1.i2.p1.1">Temperature: 1.0</p>
</div>
</li>
<li class="ltx_item" id="A1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="A1.I1.i3.p1">
<p class="ltx_p" id="A1.I1.i3.p1.1">Top-p: 0.95</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>STaR Iterations</h3>
<div class="ltx_para ltx_noindent" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">For each training run, we only sample from each pairwise data point one time. We split each dataset into three equal portions, and then apply the model to one of these splits without reusing any splits. We do not share any data between iterations, each iteration is fully sampled from the split, and does not include any of the previously generated data into the training. To generate the new data points, we sample from the latest model on the current split. From there, we train the latest model on that split in an online manner. In order to accomplish roughly the same number of training steps for each dataset, ultrafeedback uses 3 epochs from this generated data, while ultrainteract uses 1 epoch on this data.</p>
</div>
</section>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Results Across Iterations</h2>
<figure class="ltx_table" id="A2.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="A2.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="A2.T3.1.1.1">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row" id="A2.T3.1.1.1.1">Training Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="4" id="A2.T3.1.1.1.2"><span class="ltx_text ltx_font_bold" id="A2.T3.1.1.1.2.1">UltraFeedback</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="4" id="A2.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="A2.T3.1.1.1.3.1">UltraInteract</span></th>
</tr>
<tr class="ltx_tr" id="A2.T3.1.2.2">
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row" id="A2.T3.1.2.2.1">Evaluation Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="A2.T3.1.2.2.2">UltraFeedback</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="A2.T3.1.2.2.3">RewardBench</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="A2.T3.1.2.2.4">UltraInteract</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2" id="A2.T3.1.2.2.5">RewardBench</th>
</tr>
<tr class="ltx_tr" id="A2.T3.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" id="A2.T3.1.3.3.1">
<span class="ltx_text ltx_font_bold" id="A2.T3.1.3.3.1.1">Method</span> (iteration)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T3.1.3.3.2">Maj@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T3.1.3.3.3">Maj@32</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T3.1.3.3.4">Maj@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T3.1.3.3.5">Maj@32</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T3.1.3.3.6">Maj@1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T3.1.3.3.7">Maj@32</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T3.1.3.3.8">Maj@1</th>
<th class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column ltx_border_t" id="A2.T3.1.3.3.9">Maj@32</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A2.T3.1.4.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T3.1.4.1.1">STaR-SFT (1)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.4.1.2">67.42</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.4.1.3">68.62</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.4.1.4">76.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.4.1.5">77.34</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.4.1.6">72.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.4.1.7">75.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.4.1.8">72.33</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A2.T3.1.4.1.9">74.20</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.5.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.5.2.1">STaR-SFT (2)</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.5.2.2">67.05</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.5.2.3">67.67</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.5.2.4">75.71</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.5.2.5">77.60</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.5.2.6">76.26</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.5.2.7">79.18</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.5.2.8">72.95</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A2.T3.1.5.2.9">74.52</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.6.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.6.3.1">STaR-SFT (3)</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.6.3.2">66.10</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.6.3.3">67.38</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.6.3.4">75.48</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.6.3.5">77.05</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.6.3.6">78.10</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.6.3.7">80.10</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.6.3.8">70.45</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A2.T3.1.6.3.9">72.03</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.7.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T3.1.7.4.1">STaR-DPO (1)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.7.4.2">69.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.7.4.3">71.28</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.7.4.4">78.29</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.7.4.5">81.27</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.7.4.6">82.23</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.7.4.7">86.46</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.7.4.8">73.13</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A2.T3.1.7.4.9">78.04</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.8.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.8.5.1">STaR-DPO (2)</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.8.5.2">71.70</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.8.5.3">72.98</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.8.5.4">78.46</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.8.5.5">81.94</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.8.5.6">84.70</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.8.5.7">88.40</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.8.5.8">76.31</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A2.T3.1.8.5.9">79.92</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.9.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.9.6.1">STaR-DPO (3)</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.9.6.2">72.08</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.9.6.3">73.58</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.9.6.4">79.23</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.9.6.5">82.60</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.9.6.6">85.58</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.9.6.7">90.23</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.9.6.8">74.36</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A2.T3.1.9.6.9">79.20</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.10.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="A2.T3.1.10.7.1">Rationalizer (1)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.10.7.2">70.90</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.10.7.3">73.05</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.10.7.4">71.73</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.10.7.5">75.83</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.10.7.6">84.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.10.7.7">85.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="A2.T3.1.10.7.8">67.04</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="A2.T3.1.10.7.9">68.61</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.11.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.11.8.1">Rationalizer (2)</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.11.8.2">71.05</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.11.8.3">73.62</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.11.8.4">68.54</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.11.8.5">71.91</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.11.8.6">88.19</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.11.8.7">88.55</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.11.8.8">60.28</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A2.T3.1.11.8.9">61.37</td>
</tr>
<tr class="ltx_tr" id="A2.T3.1.12.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="A2.T3.1.12.9.1">Rationalizer (3)</th>
<td class="ltx_td ltx_align_center" id="A2.T3.1.12.9.2">71.23</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.12.9.3">73.22</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.12.9.4">67.62</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.12.9.5">69.48</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.12.9.6">90.39</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.12.9.7">90.77</td>
<td class="ltx_td ltx_align_center" id="A2.T3.1.12.9.8">58.19</td>
<td class="ltx_td ltx_nopad_r ltx_align_center" id="A2.T3.1.12.9.9">58.16</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>STaR method evaluation results throughout training iterations.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Oct  2 18:01:27 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
