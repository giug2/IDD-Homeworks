<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2309.06122] A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)</title><meta property="og:description" content="Machine learning techniques are attractive options for developing highly-accurate automated analysis tools for nanomaterials characterization, including high-resolution transmission electron microscopy (HRTEM). However…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2309.06122">

<!--Generated on Mon Feb 26 22:13:52 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Transmission Electron Microscopy,  Machine Learning,  Simulation,  Open Source">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\externaldocument</span>
<p id="p1.2" class="ltx_p">revision_supplementary_3










<span id="p1.2.1" class="ltx_ERROR undefined">\newtotcounter</span>citnum  























</p>
</div>
<h1 class="ltx_title ltx_title_document">A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Luis Rangel DaCosta
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:luisrd@berkeley.edu">luisrd@berkeley.edu</a>
</span>
<span class="ltx_contact ltx_role_affiliation">Department of Materials Science and Engineering, University of California Berkeley, Berkeley, CA 94720
</span>
<span class="ltx_contact ltx_role_affiliation">National Center for Electron Microscopy, Molecular Foundry, Lawrence Berkeley National Laboratory, 1 Cyclotron Road, Berkeley, CA, USA
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Katherine Sytwu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">National Center for Electron Microscopy, Molecular Foundry, Lawrence Berkeley National Laboratory, 1 Cyclotron Road, Berkeley, CA, USA
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">C.K. Groschner
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Department of Materials Science and Engineering, University of California Berkeley, Berkeley, CA 94720
</span>
<span class="ltx_contact ltx_role_affiliation">National Center for Electron Microscopy, Molecular Foundry, Lawrence Berkeley National Laboratory, 1 Cyclotron Road, Berkeley, CA, USA
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">M.C. Scott
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:mary.scott@berkeley.edu">mary.scott@berkeley.edu</a>
</span>
<span class="ltx_contact ltx_role_affiliation">Department of Materials Science and Engineering, University of California Berkeley, Berkeley, CA 94720
</span>
<span class="ltx_contact ltx_role_affiliation">National Center for Electron Microscopy, Molecular Foundry, Lawrence Berkeley National Laboratory, 1 Cyclotron Road, Berkeley, CA, USA
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Machine learning techniques are attractive options for developing highly-accurate automated analysis tools for nanomaterials characterization, including high-resolution transmission electron microscopy (HRTEM). However, successfully implementing such machine learning tools can be difficult due to the challenges in procuring sufficiently large, high-quality training datasets from experiments. In this work, we introduce Construction Zone, a Python package for rapidly generating complex nanoscale atomic structures, and develop an end-to-end workflow for creating large simulated databases for training neural networks. Construction Zone enables fast, systematic sampling of realistic nanomaterial structures, and can be used as a random structure generator for simulated databases, which is important for generating large, diverse synthetic datasets. Using HRTEM imaging as an example, we train a series of neural networks on various subsets of our simulated databases to segment nanoparticles and holistically study the data curation process to understand how various aspects of the curated simulated data—including simulation fidelity, the distribution of atomic structures, and the distribution of imaging conditions—affect model performance across several experimental benchmarks. Using our results, we are able to achieve state-of-the-art segmentation performance on experimental HRTEM images of nanoparticles from several experimental benchmarks and, further, we discuss robust strategies for consistently achieving high performance with machine learning in experimental settings using purely synthetic data.</p>
</div>
<div class="ltx_keywords">Transmission Electron Microscopy, Machine Learning, Simulation, Open Source
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:120%;">1   Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Machine learning (ML) methods promise to accurately and automatically analyze large datasets at high-speeds, revolutionizing our materials characterization workflows. Many state-of-the-art ML tools rely on supervised learning techniques, where models utilize large amounts of data annotated with features of interest for training. The performance of supervised ML models, like neural networks, directly depends on the contents and generating distribution of the dataset used for model training, and, importantly, such models have been shown to extrapolate poorly beyond their training datasets <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib1" title="" class="ltx_ref">1</a>)</cite> and have limited out-of-distribution generalization behavior <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>)</cite>. Developing robust ML models for automated analysis of transmission electron microscopy (TEM), a versatile technique for structural and functional materials characterization at the atomic-scale, thus requires large image datasets which fully cover experimental imaging conditions and the variety of samples one has imaged. However, manually producing sufficiently large and diverse sets of well-annotated experimental data in order to train robust, generalizable ML models can be extremely labor intensive and creates the possibility for both human and experimental biases to negatively impact model performance during deployment. With limited experimental data, it is also difficult to investigate any failures or biases of a ML workflow arising from the choice of data used.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">The prohibitive cost of producing high-quality, well-annotated experimental data for supervised learning tasks makes data simulation an attractive alternative for developing effective machine learning models. Synthetic datasets produced through materials simulations offer several distinct advantages over their experimental counterparts. In particular, high-throughput simulation can create arbitrarily large datasets covering the full range of experimental conditions with ground-truth, physics-based data annotation, avoiding human bias and error in selecting and annotating relevant data and at a lower cost. Synthetic data generation also enables consistently reproducible end-to-end model development workflows and the ability to precisely isolate data stream effects—both positive and negative—on trained models. The final challenge then becomes choosing suitable and sufficient datasets for developing ML models to achieve a scientific task of interest, making it important to understand how the data we use influences the accuracy and quality of the scientific inferences we make and how such data curation decisions induce practical compromises between ML model performance and model development costs.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">Recent advances in electron microscopy simulation methods have enabled large-scale, high-throughout TEM simulations for a wide range of experimental modalities <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>)</cite>. These simulation tools fully describe imaging with electron microscopy with detailed descriptions of the electron scattering process and have been used to train ML models to analyze crystalline scanning TEM (STEM) and STEM diffraction data <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>)</cite>, high-resolution TEM (HRTEM) analysis of 2D material structures and nanoparticles <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib11" title="" class="ltx_ref">11</a>)</cite>, and image denoising models <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib12" title="" class="ltx_ref">12</a>)</cite>. However, these prior achievements either have limited types of atomic structures <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>)</cite> or work only with crystalline diffraction data <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib9" title="" class="ltx_ref">9</a>)</cite>. In contrast, developing ML models general enough to analyze arbitrary real-space HRTEM data requires including all possible atomic structures that span the experimental range in the training datasets. Sampling many thousands of unique atomic structures and configurations with, for example, high-throughput molecular dynamics quickly becomes computationally expensive. At the expense of precise structural accuracy, we can instead cheaply generate thousands of atomic structures manually by specifying broad structural details of a nanoscale object and using idealized lattices and defect structures to place atoms. Generating such a set of structures for a bespoke problem or singular experiment is feasible, but, while several tools exist to design and analyze atomic structures in materials science <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>)</cite>, no such tools are designed to facilitate the precise description and generation of arbitrary distributions of complex, nanoscale atomic objects. Curating a sufficient dataset for training ML models to automatically and precisely analyze HRTEM characterization data, where one expects to encounter a vast diversity of highly numerous and variable atomic structures, becomes substantially more difficult in the general case without more flexible software tools.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">In this work, we develop an end-to-end workflow for training ML models to automatically analyze experimental HRTEM data of nanomaterials at the atomic-scale using only large, automatically generated, high-quality synthetic datasets. To achieve this, we develop Construction Zone (CZ) (Fig. <a href="#S2.F1" title="Figure 1 ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">1</span></span></a>), an open-source software package which enables algorithmic and high-throughput sampling of arbitrary atomic structures, which is then combined with HRTEM simulation to generate metadata rich databases with physics-based supervision labels. Given a general, all-purpose framework for producing high-quality synthetic data from a variety of prior distributions, we evaluate differing data curation strategies to reveal data-efficient training methods for achieving state-of-the-art neural network performance in analyzing experimental HRTEM data. Further, utilizing our data curation framework, which gives us complete control of the data generation process, we study statistically precise relationships between aspects of the training data—including simulation fidelity, structural composition, and diversity of imaging conditions—and ML model performance, aggregating the performance results of several hundreds of neural networks in order to provide statistical robustness. We provide analysis for image segmentation tasks, a benchmark characterization test which is crucial for identifying regions of interest in HRTEM data and guiding downstream automated analysis tasks, and present results on experimental HRTEM micrographs of clusters of Au and CdSe nanoparticles imaged at ultra-high magnification.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:120%;">2   Results</h2>

<figure id="S2.F1" class="ltx_figure"><img src="/html/2309.06122/assets/x1.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="262" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F1.11.1.1" class="ltx_text ltx_font_bold">Figure</span> <span id="S2.F1.12.2.2" class="ltx_text ltx_font_bold">1</span>: </span>Diagram of the modular structure of Construction Zone (a). Atoms are supplied by Generator objects; subtractively removed into convex objects by Volume objects; and combined together into Scenes, in which multiple objects interact. A Transformations module provides both standard symmetry operations and more complex modifications to Generators and Volumes. The rest of the package includes miscellaneous utilities for interfacing with other software, premade structural archetypes, and tools for surface analysis and modification. (b) Example structures generated in Construction Zone, including a multi-grain core-shell oxide nanoparticle with strain-mediated grain alignment <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib16" title="" class="ltx_ref">16</a>)</cite> (left), a heavily-faceted gold nanoparticle on a carbon substrate decorated with molecule ligands (center), and a series of gold nanoislands on a bilayer of MoS<sub id="S2.F1.13.3" class="ltx_sub">2</sub> forming Moiré heterostructures <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib17" title="" class="ltx_ref">17</a>)</cite> (right)</figcaption>
</figure>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Atomic Structure and HRTEM Image Database Generation</h3>

<div id="S2.SS1.p1" class="ltx_para ltx_noindent">
<p id="S2.SS1.p1.1" class="ltx_p">Models developed with ML methods for TEM analysis need to be adapted to the specific atomic structures one plans or expects to analyze in experiments; therefore, the training dataset should include examples of a wide number of likely atomic structures, so that any experimentally observed atomic structures lie close to the distribution of structures used for training. When curating a dataset to train robust HRTEM analysis models, one needs to be able to effectively and simultaneously capture both broad, high level aspects of atomic structures alongside the fine details that can be used to fully describe an individual structure. For example, an atomic structure may belong to a broader family of related structures, such as core-shell nanoparticles with similar sizes and chemistries. The same structure can also be described with unique and specific details, such as the placement of a defect plane or the orientation of its lattice with respect to the electron beam. To fully capture and utilize these complementary structural details, we have developed Construction Zone (CZ), an open-source Python package for building arbitrary atomic scenes at the nanoscale. CZ is designed to be robust to general use-cases, such that any complex nanostructure can be made, whilst also facilitating a flexible, programmatic workflow, such that large distributions of similar objects can be generated quickly and easily, and structure generating code is both easy to interpret and easy to reuse and repurpose.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para ltx_noindent">
<p id="S2.SS1.p2.1" class="ltx_p">CZ relies on a simple module structure (c.f. Fig. <a href="#S2.F1" title="Figure 1 ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">1</span></span></a>a) that combines atomic placement (Generators), nano-object creation (Volumes), and nano-object interaction (Scenes). Structures can be further manipulated or generated with the Transformation class, which contains methods like standard symmetry operations, or by using convenience routines and analytical tools from the auxiliary modules, including functionality for atomic surface analysis and modification. The package derives some of its core functionality from other open-source materials science software packages, namely, PyMatgen <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib13" title="" class="ltx_ref">13</a>)</cite>, the Atomic Simulation Environment <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib14" title="" class="ltx_ref">14</a>)</cite>, and WulffPack <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib15" title="" class="ltx_ref">15</a>)</cite>, and interfaces seamlessly into common simulation workflows. By allowing users to specify atomic features like defects and zone-axis orientations with a high-level, materials-focused interface, CZ enables easier generation of both specific and random nanoscale atomic structures. We showcase some example complex atomic structures ranging from nanoparticles to 2D heterostructures, generated entirely with CZ, in Fig. <a href="#S2.F1" title="Figure 1 ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">1</span></span></a>b. In our study, CZ allows us to sample and quickly generate a large number of random, similar nanoparticle structures with complex defects and varying zone-axis orientations, mimicking the collection of nanoparticles that might be imaged in a typical HRTEM experiment, whilst also tracking such metadata about each structure, enabling us to draw fully specified training data distributions for machine learning model development.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para ltx_noindent">
<p id="S2.SS1.p3.1" class="ltx_p">Here, we use CZ as a random structure generator alongside high-throughput TEM simulation to create large, synthetic datasets which we use to train neural networks to analyze experimental HRTEM data, utilizing supervised learning techniques. We demonstrate our framework on the benchmark task of image segmentation for micrographs of Au and CdSe nanoparticles on amorphous carbon substrates <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib18" title="" class="ltx_ref">18</a>)</cite>. For each image, the goal is to classify each pixel as either part of a nanoparticle or substrate. Due to the subtle, complex interplay of contrast effects under HRTEM imaging at atomic resolution, classical image analysis techniques like Fourier filtering fail to segment nanoparticles accurately, and are outperformed by neural networks trained on manually-labeled experimental micrographs <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib18" title="" class="ltx_ref">18</a>)</cite>. Unsupervised techniques, such as using K-means clustering for pixel classification based on intensity, have only been successfully deployed for TEM images of nanoparticles taken at lower magnification <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib19" title="" class="ltx_ref">19</a>)</cite>, where amplitude contrast dominates the signal, atomic lattice texture is not present, and data tend to be less noisy, thus further motivating high-accuracy supervised learning methods as a more successful route for image segmentation at atomic resolution.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/2309.06122/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="193" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F2.8.1.1" class="ltx_text ltx_font_bold">Figure</span> <span id="S2.F2.9.2.2" class="ltx_text ltx_font_bold">2</span>: </span>Data processing pipeline from generated structures to training-ready data. For each structure, we separate the structure into subsets for the training data and supervision label, simulate the HRTEM image formation for each structure with Prismatic <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib4" title="" class="ltx_ref">4</a>)</cite>, and use post-processing to sample imaging conditions, noise, and generate the segmentation mask. Metadata are accrued at each step, and the data are stored into a series of staged databases.</figcaption>
</figure>
<div id="S2.SS1.p4" class="ltx_para ltx_noindent">
<p id="S2.SS1.p4.1" class="ltx_p">To generate our synthetic dataset for training neural networks, we built a data generation pipeline, diagrammed in Fig. <a href="#S2.F1" title="Figure 1 ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">1</span></span></a> and detailed more thoroughly in Fig. <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:sfig:data_flow_schematic</span>, that begins with randomly generating several thousand spherical Au nanoparticles, placed atop unique amorphous C substrates, with random radii, orientations, locations, and with possible twin defects or stacking faults, to account for structural diversity in the target micrographs. We utilize Prismatic <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>)</cite> to simulate HRTEM images using the multislice algorithm <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib20" title="" class="ltx_ref">20</a>)</cite> and calculate their corresponding, ground-truth supervision labels, i.e., the sets of pixels in the images where nanoparticles are located. For each structure, we simulate HRTEM output waves at 300kV with a final resolution of 0.02 nm/pixel. From each simulation, multiple images of each nanoparticle structure are sampled under varying image conditions and noise. In order to facilitate targeted data curation when training neural networks, we extensively track and aggregate metadata at each phase, so that specific distributions of simulated data can be easily drawn from the full database.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Image Segmentation of Nanoparticles with Supervised Neural Networks</h3>

<div id="S2.SS2.p1" class="ltx_para ltx_noindent">
<p id="S2.SS2.p1.1" class="ltx_p">Utilizing our data generation pipeline, we examine how aspects of the training set of simulated HRTEM images, as induced via data curation, affect neural network segmentation performance on experimental HRTEM images. By evaluating both general trends and more granular effects of dataset characteristics on neural network performance, we identify data curation strategies for training high-performance ML models for experimental HRTEM image segmentation using only simulated data. To isolate the effects on model performance due to characteristics of the training dataset, we fix our neural network architecture and optimization hyperparameters and train multiple UNet networks <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib21" title="" class="ltx_ref">21</a>)</cite> for each data condition. For a given data condition, training data are drawn I.I.D. from the simulation database, such that each network has both unique random initializations of learnable weights and independent data streams. In order to understand our model performance in the context of the intrinsic variability of HRTEM data, we benchmark our neural network performance against three previously published atomic-resolution experimental datasets <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>)</cite>, taken on two different aberration-corrected TEMs by different operators at ultra-high magnification (about 0.02 nm/pixel), because contrast mechanisms in HRTEM are highly dependent on sample thickness, chemical composition, structure, and experimental conditions. The first dataset comprises images of large Au nanoparticles (5nm) and agglomerates <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib23" title="" class="ltx_ref">23</a>)</cite>; the second small Au nanoparticles (2.2nm)<cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib24" title="" class="ltx_ref">24</a>)</cite>; and the final small CdSe nanoparticles (2nm)<cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib23" title="" class="ltx_ref">23</a>)</cite>. Simultaneous benchmarking on several different experimental datasets provides an opportunity to analyze how robust our trained models are to distributional shift and to determine the generality of training data effects. Previous best results on these datasets, when analyzed with neural networks trained with experimental data, are F1 scores of 0.89, 0.75,and 0.59, for the large Au <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib18" title="" class="ltx_ref">18</a>)</cite>, small Au <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib22" title="" class="ltx_ref">22</a>)</cite>, and CdSe <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib18" title="" class="ltx_ref">18</a>)</cite> datasets, respectively.</p>
</div>
<figure id="S2.T1" class="ltx_table">
<table id="S2.T1.4" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S2.T1.1.1" class="ltx_tr">
<th id="S2.T1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-top:-1.2pt;padding-bottom:-1.2pt;" colspan="2"><span id="S2.T1.1.1.2.1" class="ltx_text" style="font-size:80%;">Training Dataset</span></th>
<th id="S2.T1.1.1.3" class="ltx_td ltx_align_center ltx_align_middle ltx_th ltx_th_column ltx_border_tt" style="padding-top:-1.2pt;padding-bottom:-1.2pt;" colspan="3"><span id="S2.T1.1.1.3.1" class="ltx_text" style="font-size:80%;">F1-score on Exp. Data</span></th>
<th id="S2.T1.1.1.1" class="ltx_td ltx_align_center ltx_align_middle ltx_th ltx_th_column ltx_border_tt" style="padding-top:-1.2pt;padding-bottom:-1.2pt;" colspan="2">
<math id="S2.T1.1.1.1.m1.1" class="ltx_Math" alttext="N_{\text{Epochs}}" display="inline"><semantics id="S2.T1.1.1.1.m1.1a"><msub id="S2.T1.1.1.1.m1.1.1" xref="S2.T1.1.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S2.T1.1.1.1.m1.1.1.2" xref="S2.T1.1.1.1.m1.1.1.2.cmml">N</mi><mtext mathsize="80%" id="S2.T1.1.1.1.m1.1.1.3" xref="S2.T1.1.1.1.m1.1.1.3a.cmml">Epochs</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.m1.1b"><apply id="S2.T1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.1.1.1.m1.1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.T1.1.1.1.m1.1.1.2.cmml" xref="S2.T1.1.1.1.m1.1.1.2">𝑁</ci><ci id="S2.T1.1.1.1.m1.1.1.3a.cmml" xref="S2.T1.1.1.1.m1.1.1.3"><mtext mathsize="56%" id="S2.T1.1.1.1.m1.1.1.3.cmml" xref="S2.T1.1.1.1.m1.1.1.3">Epochs</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.m1.1c">N_{\text{Epochs}}</annotation></semantics></math><span id="S2.T1.1.1.1.1" class="ltx_text" style="font-size:80%;"> to F1</span>
</th>
</tr>
<tr id="S2.T1.4.4" class="ltx_tr">
<th id="S2.T1.4.4.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-top:-1.2pt;padding-bottom:-1.2pt;"><span id="S2.T1.4.4.4.1" class="ltx_text" style="font-size:80%;">Dataset</span></th>
<th id="S2.T1.2.2.1" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_t" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.2.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.2.2.1.1.1" class="ltx_p"><math id="S2.T1.2.2.1.1.1.m1.1" class="ltx_Math" alttext="N_{\text{Images}}" display="inline"><semantics id="S2.T1.2.2.1.1.1.m1.1a"><msub id="S2.T1.2.2.1.1.1.m1.1.1" xref="S2.T1.2.2.1.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S2.T1.2.2.1.1.1.m1.1.1.2" xref="S2.T1.2.2.1.1.1.m1.1.1.2.cmml">N</mi><mtext mathsize="80%" id="S2.T1.2.2.1.1.1.m1.1.1.3" xref="S2.T1.2.2.1.1.1.m1.1.1.3a.cmml">Images</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.T1.2.2.1.1.1.m1.1b"><apply id="S2.T1.2.2.1.1.1.m1.1.1.cmml" xref="S2.T1.2.2.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.2.2.1.1.1.m1.1.1.1.cmml" xref="S2.T1.2.2.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.T1.2.2.1.1.1.m1.1.1.2.cmml" xref="S2.T1.2.2.1.1.1.m1.1.1.2">𝑁</ci><ci id="S2.T1.2.2.1.1.1.m1.1.1.3a.cmml" xref="S2.T1.2.2.1.1.1.m1.1.1.3"><mtext mathsize="56%" id="S2.T1.2.2.1.1.1.m1.1.1.3.cmml" xref="S2.T1.2.2.1.1.1.m1.1.1.3">Images</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.2.1.1.1.m1.1c">N_{\text{Images}}</annotation></semantics></math></span>
</span>
</th>
<th id="S2.T1.4.4.5" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_t" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.4.5.1.1" class="ltx_p"><span id="S2.T1.4.4.5.1.1.1" class="ltx_text" style="font-size:80%;">5nm Au</span></span>
</span>
</th>
<th id="S2.T1.4.4.6" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_t" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.4.6.1.1" class="ltx_p"><span id="S2.T1.4.4.6.1.1.1" class="ltx_text" style="font-size:80%;">2.2nm Au</span></span>
</span>
</th>
<th id="S2.T1.4.4.7" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_t" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.4.7.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.4.7.1.1" class="ltx_p"><span id="S2.T1.4.4.7.1.1.1" class="ltx_text" style="font-size:80%;">2nm CdSe</span></span>
</span>
</th>
<th id="S2.T1.3.3.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_t" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.3.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.3.3.2.1.1" class="ltx_p"><math id="S2.T1.3.3.2.1.1.m1.1" class="ltx_Math" alttext="V_{90}" display="inline"><semantics id="S2.T1.3.3.2.1.1.m1.1a"><msub id="S2.T1.3.3.2.1.1.m1.1.1" xref="S2.T1.3.3.2.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S2.T1.3.3.2.1.1.m1.1.1.2" xref="S2.T1.3.3.2.1.1.m1.1.1.2.cmml">V</mi><mn mathsize="80%" id="S2.T1.3.3.2.1.1.m1.1.1.3" xref="S2.T1.3.3.2.1.1.m1.1.1.3.cmml">90</mn></msub><annotation-xml encoding="MathML-Content" id="S2.T1.3.3.2.1.1.m1.1b"><apply id="S2.T1.3.3.2.1.1.m1.1.1.cmml" xref="S2.T1.3.3.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.3.3.2.1.1.m1.1.1.1.cmml" xref="S2.T1.3.3.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.T1.3.3.2.1.1.m1.1.1.2.cmml" xref="S2.T1.3.3.2.1.1.m1.1.1.2">𝑉</ci><cn type="integer" id="S2.T1.3.3.2.1.1.m1.1.1.3.cmml" xref="S2.T1.3.3.2.1.1.m1.1.1.3">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.3.2.1.1.m1.1c">V_{90}</annotation></semantics></math></span>
</span>
</th>
<th id="S2.T1.4.4.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_th ltx_th_column ltx_border_t" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.4.3.1.1" class="ltx_p"><math id="S2.T1.4.4.3.1.1.m1.1" class="ltx_Math" alttext="V_{95}" display="inline"><semantics id="S2.T1.4.4.3.1.1.m1.1a"><msub id="S2.T1.4.4.3.1.1.m1.1.1" xref="S2.T1.4.4.3.1.1.m1.1.1.cmml"><mi mathsize="80%" id="S2.T1.4.4.3.1.1.m1.1.1.2" xref="S2.T1.4.4.3.1.1.m1.1.1.2.cmml">V</mi><mn mathsize="80%" id="S2.T1.4.4.3.1.1.m1.1.1.3" xref="S2.T1.4.4.3.1.1.m1.1.1.3.cmml">95</mn></msub><annotation-xml encoding="MathML-Content" id="S2.T1.4.4.3.1.1.m1.1b"><apply id="S2.T1.4.4.3.1.1.m1.1.1.cmml" xref="S2.T1.4.4.3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.T1.4.4.3.1.1.m1.1.1.1.cmml" xref="S2.T1.4.4.3.1.1.m1.1.1">subscript</csymbol><ci id="S2.T1.4.4.3.1.1.m1.1.1.2.cmml" xref="S2.T1.4.4.3.1.1.m1.1.1.2">𝑉</ci><cn type="integer" id="S2.T1.4.4.3.1.1.m1.1.1.3.cmml" xref="S2.T1.4.4.3.1.1.m1.1.1.3">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.4.3.1.1.m1.1c">V_{95}</annotation></semantics></math></span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S2.T1.4.5.1" class="ltx_tr">
<th id="S2.T1.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:-1.2pt;padding-bottom:-1.2pt;"><span id="S2.T1.4.5.1.1.1" class="ltx_text" style="font-size:80%;">Baseline</span></th>
<td id="S2.T1.4.5.1.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.5.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.5.1.2.1.1" class="ltx_p"><span id="S2.T1.4.5.1.2.1.1.1" class="ltx_text" style="font-size:80%;">512</span></span>
</span>
</td>
<td id="S2.T1.4.5.1.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.5.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.5.1.3.1.1" class="ltx_p"><span id="S2.T1.4.5.1.3.1.1.1" class="ltx_text" style="font-size:80%;">0.710</span></span>
</span>
</td>
<td id="S2.T1.4.5.1.4" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.5.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.5.1.4.1.1" class="ltx_p"><span id="S2.T1.4.5.1.4.1.1.1" class="ltx_text" style="font-size:80%;">0.740</span></span>
</span>
</td>
<td id="S2.T1.4.5.1.5" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.5.1.5.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.5.1.5.1.1" class="ltx_p"><span id="S2.T1.4.5.1.5.1.1.1" class="ltx_text" style="font-size:80%;">0.681</span></span>
</span>
</td>
<td id="S2.T1.4.5.1.6" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.5.1.6.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.5.1.6.1.1" class="ltx_p"><span id="S2.T1.4.5.1.6.1.1.1" class="ltx_text" style="font-size:80%;">19</span></span>
</span>
</td>
<td id="S2.T1.4.5.1.7" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_t" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.5.1.7.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.5.1.7.1.1" class="ltx_p"><span id="S2.T1.4.5.1.7.1.1.1" class="ltx_text" style="font-size:80%;">21</span></span>
</span>
</td>
</tr>
<tr id="S2.T1.4.6.2" class="ltx_tr">
<th id="S2.T1.4.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.2pt;padding-bottom:-1.2pt;"><span id="S2.T1.4.6.2.1.1" class="ltx_text" style="font-size:80%;">Thermal</span></th>
<td id="S2.T1.4.6.2.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.6.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.6.2.2.1.1" class="ltx_p"><span id="S2.T1.4.6.2.2.1.1.1" class="ltx_text" style="font-size:80%;">512</span></span>
</span>
</td>
<td id="S2.T1.4.6.2.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.6.2.3.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.6.2.3.1.1" class="ltx_p"><span id="S2.T1.4.6.2.3.1.1.1" class="ltx_text" style="font-size:80%;">0.727</span></span>
</span>
</td>
<td id="S2.T1.4.6.2.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.6.2.4.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.6.2.4.1.1" class="ltx_p"><span id="S2.T1.4.6.2.4.1.1.1" class="ltx_text" style="font-size:80%;">0.767</span></span>
</span>
</td>
<td id="S2.T1.4.6.2.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.6.2.5.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.6.2.5.1.1" class="ltx_p"><span id="S2.T1.4.6.2.5.1.1.1" class="ltx_text" style="font-size:80%;">0.621</span></span>
</span>
</td>
<td id="S2.T1.4.6.2.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.6.2.6.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.6.2.6.1.1" class="ltx_p"><span id="S2.T1.4.6.2.6.1.1.1" class="ltx_text" style="font-size:80%;">20</span></span>
</span>
</td>
<td id="S2.T1.4.6.2.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.6.2.7.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.6.2.7.1.1" class="ltx_p"><span id="S2.T1.4.6.2.7.1.1.1" class="ltx_text" style="font-size:80%;">23</span></span>
</span>
</td>
</tr>
<tr id="S2.T1.4.7.3" class="ltx_tr">
<th id="S2.T1.4.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.2pt;padding-bottom:-1.2pt;"><span id="S2.T1.4.7.3.1.1" class="ltx_text" style="font-size:80%;">All simulation effects</span></th>
<td id="S2.T1.4.7.3.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.7.3.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.7.3.2.1.1" class="ltx_p"><span id="S2.T1.4.7.3.2.1.1.1" class="ltx_text" style="font-size:80%;">512</span></span>
</span>
</td>
<td id="S2.T1.4.7.3.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.7.3.3.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.7.3.3.1.1" class="ltx_p"><span id="S2.T1.4.7.3.3.1.1.1" class="ltx_text" style="font-size:80%;">0.822</span></span>
</span>
</td>
<td id="S2.T1.4.7.3.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.7.3.4.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.7.3.4.1.1" class="ltx_p"><span id="S2.T1.4.7.3.4.1.1.1" class="ltx_text" style="font-size:80%;">0.814</span></span>
</span>
</td>
<td id="S2.T1.4.7.3.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.7.3.5.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.7.3.5.1.1" class="ltx_p"><span id="S2.T1.4.7.3.5.1.1.1" class="ltx_text" style="font-size:80%;">0.647</span></span>
</span>
</td>
<td id="S2.T1.4.7.3.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.7.3.6.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.7.3.6.1.1" class="ltx_p"><span id="S2.T1.4.7.3.6.1.1.1" class="ltx_text" style="font-size:80%;">21</span></span>
</span>
</td>
<td id="S2.T1.4.7.3.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.7.3.7.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.7.3.7.1.1" class="ltx_p"><span id="S2.T1.4.7.3.7.1.1.1" class="ltx_text" style="font-size:80%;">24</span></span>
</span>
</td>
</tr>
<tr id="S2.T1.4.8.4" class="ltx_tr">
<th id="S2.T1.4.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.2pt;padding-bottom:-1.2pt;"><span id="S2.T1.4.8.4.1.1" class="ltx_text" style="font-size:80%;">Smaller NPs</span></th>
<td id="S2.T1.4.8.4.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.8.4.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.8.4.2.1.1" class="ltx_p"><span id="S2.T1.4.8.4.2.1.1.1" class="ltx_text" style="font-size:80%;">1024</span></span>
</span>
</td>
<td id="S2.T1.4.8.4.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.8.4.3.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.8.4.3.1.1" class="ltx_p"><span id="S2.T1.4.8.4.3.1.1.1" class="ltx_text" style="font-size:80%;">0.833</span></span>
</span>
</td>
<td id="S2.T1.4.8.4.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.8.4.4.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.8.4.4.1.1" class="ltx_p"><span id="S2.T1.4.8.4.4.1.1.1" class="ltx_text" style="font-size:80%;">0.809</span></span>
</span>
</td>
<td id="S2.T1.4.8.4.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.8.4.5.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.8.4.5.1.1" class="ltx_p"><span id="S2.T1.4.8.4.5.1.1.1" class="ltx_text" style="font-size:80%;">0.673</span></span>
</span>
</td>
<td id="S2.T1.4.8.4.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.8.4.6.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.8.4.6.1.1" class="ltx_p"><span id="S2.T1.4.8.4.6.1.1.1" class="ltx_text" style="font-size:80%;">11</span></span>
</span>
</td>
<td id="S2.T1.4.8.4.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.8.4.7.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.8.4.7.1.1" class="ltx_p"><span id="S2.T1.4.8.4.7.1.1.1" class="ltx_text" style="font-size:80%;">13</span></span>
</span>
</td>
</tr>
<tr id="S2.T1.4.9.5" class="ltx_tr">
<th id="S2.T1.4.9.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.2pt;padding-bottom:-1.2pt;"><span id="S2.T1.4.9.5.1.1" class="ltx_text" style="font-size:80%;">Varying Substrate</span></th>
<td id="S2.T1.4.9.5.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.9.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.9.5.2.1.1" class="ltx_p"><span id="S2.T1.4.9.5.2.1.1.1" class="ltx_text" style="font-size:80%;">1024</span></span>
</span>
</td>
<td id="S2.T1.4.9.5.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.9.5.3.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.9.5.3.1.1" class="ltx_p"><span id="S2.T1.4.9.5.3.1.1.1" class="ltx_text" style="font-size:80%;">0.885</span></span>
</span>
</td>
<td id="S2.T1.4.9.5.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.9.5.4.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.9.5.4.1.1" class="ltx_p"><span id="S2.T1.4.9.5.4.1.1.1" class="ltx_text" style="font-size:80%;">0.842</span></span>
</span>
</td>
<td id="S2.T1.4.9.5.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.9.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.9.5.5.1.1" class="ltx_p"><span id="S2.T1.4.9.5.5.1.1.1" class="ltx_text" style="font-size:80%;">0.620</span></span>
</span>
</td>
<td id="S2.T1.4.9.5.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.9.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.9.5.6.1.1" class="ltx_p"><span id="S2.T1.4.9.5.6.1.1.1" class="ltx_text" style="font-size:80%;">11</span></span>
</span>
</td>
<td id="S2.T1.4.9.5.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.9.5.7.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.9.5.7.1.1" class="ltx_p"><span id="S2.T1.4.9.5.7.1.1.1" class="ltx_text" style="font-size:80%;">12</span></span>
</span>
</td>
</tr>
<tr id="S2.T1.4.10.6" class="ltx_tr">
<th id="S2.T1.4.10.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.2pt;padding-bottom:-1.2pt;"><span id="S2.T1.4.10.6.1.1" class="ltx_text" style="font-size:80%;">Optimized Au</span></th>
<td id="S2.T1.4.10.6.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.10.6.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.10.6.2.1.1" class="ltx_p"><span id="S2.T1.4.10.6.2.1.1.1" class="ltx_text" style="font-size:80%;">8000</span></span>
</span>
</td>
<td id="S2.T1.4.10.6.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.10.6.3.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.10.6.3.1.1" class="ltx_p"><span id="S2.T1.4.10.6.3.1.1.1" class="ltx_text" style="font-size:80%;">0.915</span></span>
</span>
</td>
<td id="S2.T1.4.10.6.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.10.6.4.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.10.6.4.1.1" class="ltx_p"><span id="S2.T1.4.10.6.4.1.1.1" class="ltx_text" style="font-size:80%;">0.808</span></span>
</span>
</td>
<td id="S2.T1.4.10.6.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.10.6.5.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.10.6.5.1.1" class="ltx_p"><span id="S2.T1.4.10.6.5.1.1.1" class="ltx_text" style="font-size:80%;">0.648</span></span>
</span>
</td>
<td id="S2.T1.4.10.6.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.10.6.6.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.10.6.6.1.1" class="ltx_p"><span id="S2.T1.4.10.6.6.1.1.1" class="ltx_text" style="font-size:80%;">3</span></span>
</span>
</td>
<td id="S2.T1.4.10.6.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.10.6.7.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.10.6.7.1.1" class="ltx_p"><span id="S2.T1.4.10.6.7.1.1.1" class="ltx_text" style="font-size:80%;">3</span></span>
</span>
</td>
</tr>
<tr id="S2.T1.4.11.7" class="ltx_tr">
<th id="S2.T1.4.11.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:-1.2pt;padding-bottom:-1.2pt;"><span id="S2.T1.4.11.7.1.1" class="ltx_text" style="font-size:80%;">Optimized mixed Au/CdSe</span></th>
<td id="S2.T1.4.11.7.2" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.11.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.11.7.2.1.1" class="ltx_p"><span id="S2.T1.4.11.7.2.1.1.1" class="ltx_text" style="font-size:80%;">8000</span></span>
</span>
</td>
<td id="S2.T1.4.11.7.3" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.11.7.3.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.11.7.3.1.1" class="ltx_p"><span id="S2.T1.4.11.7.3.1.1.1" class="ltx_text" style="font-size:80%;">0.884</span></span>
</span>
</td>
<td id="S2.T1.4.11.7.4" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.11.7.4.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.11.7.4.1.1" class="ltx_p"><span id="S2.T1.4.11.7.4.1.1.1" class="ltx_text" style="font-size:80%;">0.863</span></span>
</span>
</td>
<td id="S2.T1.4.11.7.5" class="ltx_td ltx_align_justify ltx_align_middle" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.11.7.5.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.11.7.5.1.1" class="ltx_p"><span id="S2.T1.4.11.7.5.1.1.1" class="ltx_text" style="font-size:80%;">0.731</span></span>
</span>
</td>
<td id="S2.T1.4.11.7.6" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.11.7.6.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.11.7.6.1.1" class="ltx_p"><span id="S2.T1.4.11.7.6.1.1.1" class="ltx_text" style="font-size:80%;">1</span></span>
</span>
</td>
<td id="S2.T1.4.11.7.7" class="ltx_td ltx_align_justify ltx_align_middle" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.11.7.7.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.11.7.7.1.1" class="ltx_p"><span id="S2.T1.4.11.7.7.1.1.1" class="ltx_text" style="font-size:80%;">2</span></span>
</span>
</td>
</tr>
<tr id="S2.T1.4.12.8" class="ltx_tr">
<th id="S2.T1.4.12.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:-1.2pt;padding-bottom:-1.2pt;"><span id="S2.T1.4.12.8.1.1" class="ltx_text" style="font-size:80%;">Optimized CdSe</span></th>
<td id="S2.T1.4.12.8.2" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.12.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.12.8.2.1.1" class="ltx_p"><span id="S2.T1.4.12.8.2.1.1.1" class="ltx_text" style="font-size:80%;">8000</span></span>
</span>
</td>
<td id="S2.T1.4.12.8.3" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.12.8.3.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.12.8.3.1.1" class="ltx_p"><span id="S2.T1.4.12.8.3.1.1.1" class="ltx_text" style="font-size:80%;">0.799</span></span>
</span>
</td>
<td id="S2.T1.4.12.8.4" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.12.8.4.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.12.8.4.1.1" class="ltx_p"><span id="S2.T1.4.12.8.4.1.1.1" class="ltx_text" style="font-size:80%;">0.852</span></span>
</span>
</td>
<td id="S2.T1.4.12.8.5" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:49.8pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.12.8.5.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.12.8.5.1.1" class="ltx_p"><span id="S2.T1.4.12.8.5.1.1.1" class="ltx_text" style="font-size:80%;">0.752</span></span>
</span>
</td>
<td id="S2.T1.4.12.8.6" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.12.8.6.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.12.8.6.1.1" class="ltx_p"><span id="S2.T1.4.12.8.6.1.1.1" class="ltx_text" style="font-size:80%;">2</span></span>
</span>
</td>
<td id="S2.T1.4.12.8.7" class="ltx_td ltx_align_justify ltx_align_middle ltx_border_bb" style="width:28.5pt;padding-top:-1.2pt;padding-bottom:-1.2pt;">
<span id="S2.T1.4.12.8.7.1" class="ltx_inline-block ltx_align_top">
<span id="S2.T1.4.12.8.7.1.1" class="ltx_p"><span id="S2.T1.4.12.8.7.1.1.1" class="ltx_text" style="font-size:80%;">24</span></span>
</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S2.T1.12.1.1" class="ltx_text ltx_font_bold">Table</span> <span id="S2.T1.13.2.2" class="ltx_text ltx_font_bold">1</span>: </span>Best performance from neural networks on segmentation of nanoparticles in HRTEM images after training on various sets of simulated data, as measured on three experimental datasets. In the rightmost columns, we record the median number of epochs taken for networks to reach validation F1 scores of 0.90 and 0.95 on simulated data during training.</figcaption>
</figure>
<div id="S2.SS2.p2" class="ltx_para ltx_noindent">
<p id="S2.SS2.p2.1" class="ltx_p">Neural networks can be trained to segment experimental HRTEM datasets with moderate accuracy even with small simulated datasets containing only 512-1024 images, as indicated by our results in Table <a href="#S2.T1" title="Table 1 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">1</span></span></a>. Models trained on simulated data optimize performance on the simulated training data quickly and to an extremely high degree of accuracy—frequently achieving F1-scores above 0.90 on the (simulated) validation dataset in a small number of epochs (c.f. Table <a href="#S2.T1" title="Table 1 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">1</span></span></a>, rightmost column)—whereas their performance on experimental data increases more slowly, continually improving throughout training, even after performance on simulated data has apparently saturated (c.f. Fig. <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:sfig:gen_dynamics</span>). Thus, performance on simulated data is not a reliable signal for performance on experimental data and benchmarking is crucial for successful model deployment. Model performance on validation data can lag behind training performance, reducing with increasing dataset size, similar to delays observed for models trained on small, algorithmically generated datasets <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib25" title="" class="ltx_ref">25</a>)</cite>. In Fig. <a href="#S2.F3" title="Figure 3 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">3</span></span></a>, we visualize characteristic segmentation performance of four neural networks, across a range of accuracies, on the large Au dataset. Poorly performing segmentation models (Fig. <a href="#S2.F3" title="Figure 3 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">3</span></span></a>b, c), after training on just simulated data, can accurately predict segmentation regions on nanoparticles with clear lattice fringes, but might miss similar particles in other micrographs and/or lose significant performance when predicting segmentation regions for more complex structures textures and particles with many grains. Better networks have smoother, more consistent predictions (Fig. <a href="#S2.F3" title="Figure 3 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">3</span></span></a>d, e) but still might miss regions in particles with more complex structures or might have high-frequency spatial fluctuations in their predicted regions (Fig. <a href="#S2.F3" title="Figure 3 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">3</span></span></a>d, rightmost column), which are not physically consistent with nanoparticle structures, potentially indicating important noise features or aspects of the imaging conditions are not fully captured during data curation. Across the board, neural networks seem to segment nanoparticles more consistently when the particle (or particle grain) has visible lattice fringes, indicating that trained models can distinguish ordered lattice textures from other regions.</p>
</div>
<figure id="S2.F3" class="ltx_figure"><img src="/html/2309.06122/assets/x3.png" id="S2.F3.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="534" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F3.8.1.1" class="ltx_text ltx_font_bold">Figure</span> <span id="S2.F3.9.2.2" class="ltx_text ltx_font_bold">3</span>: </span>Characteristic performance of neural network models analyzing experimental images of Au nanoparticles after training on only simulated data. Models were selected trained on Baseline, Substrate, and Optimized Au datasets, from which these models represent median to strongly-performing examples. Scalebar is 2.5nm.</figcaption>
</figure>
<figure id="S2.F4" class="ltx_figure"><img src="/html/2309.06122/assets/x4.png" id="S2.F4.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="153" height="323" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F4.8.1.1" class="ltx_text ltx_font_bold">Figure</span> <span id="S2.F4.9.2.2" class="ltx_text ltx_font_bold">4</span>: </span>Effect of training dataset size (a) and noise from applied electron dose (b) on neural network performance, as measured on experimental data of large Au nanoparticles. Networks in top panel were trained on a uniformly random chosen subset of all simulated data in this study. The gold circle indicates the performance of the best neural network trained on a dataset containing only 1024 images, which were drawn from a simulated dataset comprising structures with varying substrate thicknesses. For each dataset condition, five randomly initialized neural networks were trained and measured.</figcaption>
</figure>
<div id="S2.SS2.p3" class="ltx_para ltx_noindent">
<p id="S2.SS2.p3.1" class="ltx_p">The overall cost of the model development process depends both on the cost of procuring effective training datasets and the cost of training the models themselves, and often, compromises must be made between acceptable costs and the end quality of obtained models. As is well known, neural networks trained with supervised learning methods can be greatly improved by using larger training datasets, which can cost much more to obtain and can cause model training time to increase substantially. In Fig. <a href="#S2.F4" title="Figure 4 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">4</span></span></a>a, we measure the performance of neural networks on the large Au experimental dataset after training on datasets of increasing size, where the training data are drawn uniformly randomly from all of the aggregated databases (see Supplemental section <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:si_data</span>). Segmentation performance saturates at an F1-score of about 0.9 after about 8000 images are included in the training dataset, after which there are only marginal improvements due to dataset size alone. With smaller datasets, model performance can be highly variable, and the gap between the worst and best model trained steadily decreases as the dataset size increases. By tuning the quality and composition of the simulated data, we can train comparably accurate models with more data-efficient curation strategies, as, for example, with the networks trained on structures with varying substrate thicknesses (c.f. Tables <a href="#S2.T1" title="Table 1 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">1</span></span></a> and <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:stab:all_perf</span>), indicated by the gold circle in Fig. <a href="#S2.F4" title="Figure 4 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">4</span></span></a>a.</p>
</div>
<div id="S2.SS2.p4" class="ltx_para ltx_noindent">
<p id="S2.SS2.p4.1" class="ltx_p">At a fixed dataset size, the model performance can be highly sensitive and dependent on the noise of the training dataset, as shown for models trained on datasets varying only in applied electron dose in Fig. <a href="#S2.F4" title="Figure 4 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">4</span></span></a>b. On other experimental datasets, we find that model performance maintains this sensitivity, but now peaks at lower doseage rates, with slow fall off of performance as noise decreases (c.f. Figs. <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:sfig:small_Au</span>b and <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:sfig:cdse</span>b), indicating that noisier data are important for models to learn. Differences in the qualitative performance trend across noise levels between the large Au data and the other experimental data might be a result of differing noise distributions in the images arising from differing camera statistics. Given the sensitivity of model performance to the noise level of the training dataset, we recommend to sample relevant noise from wider distributions, such that during training models see examples from a range of signal-to-noise conditions, which can improve the consistency of model training but still requires a careful choice of the noise distribution (c.f. Fig. <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:sfig:rng</span>). Our results appear to be consistent as to prior work for a similar nanoparticle segmentation task <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib26" title="" class="ltx_ref">26</a>)</cite> with a different experimental geometry in which nanoparticles are mounted on a crystalline substrate and are imaged over vacuum. Given that, in our task, the imaging beam passes through both the nanoparticle and the (amorphous) substrate and has higher effective electron dose (200–600e-/<math id="S2.SS2.p4.1.m1.1" class="ltx_Math" alttext="\text{\AA}^{2}" display="inline"><semantics id="S2.SS2.p4.1.m1.1a"><msup id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml"><mtext id="S2.SS2.p4.1.m1.1.1.2" xref="S2.SS2.p4.1.m1.1.1.2a.cmml">Å</mtext><mn id="S2.SS2.p4.1.m1.1.1.3" xref="S2.SS2.p4.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><apply id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">superscript</csymbol><ci id="S2.SS2.p4.1.m1.1.1.2a.cmml" xref="S2.SS2.p4.1.m1.1.1.2"><mtext id="S2.SS2.p4.1.m1.1.1.2.cmml" xref="S2.SS2.p4.1.m1.1.1.2">Å</mtext></ci><cn type="integer" id="S2.SS2.p4.1.m1.1.1.3.cmml" xref="S2.SS2.p4.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">\text{\AA}^{2}</annotation></semantics></math> across all datasets), it is likely that the relationship to noise could be more complex and that the minimal experimental dose that could be consistently segmented is larger, i.e., more signal-to-noise is required for our task.</p>
</div>
<figure id="S2.F5" class="ltx_figure"><img src="/html/2309.06122/assets/x5.png" id="S2.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="255" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F5.10.1.1" class="ltx_text ltx_font_bold">Figure</span> <span id="S2.F5.11.2.2" class="ltx_text ltx_font_bold">5</span>: </span>Baseline neural network performance with cheapest simulation methods (a) and effect of improving simulation fidelity on network performance, conditional on applied dosage, including effects from thermal averaging, residual aberrations, and plasmonic losses (b). Visual examples of baseline quality (c) and applied simulation effects (d) on simulated image of Au nanoparticles at 300kV with focal spread and 400<math id="S2.F5.2.m1.1" class="ltx_Math" alttext="e^{-}/\text{\AA}^{2}" display="inline"><semantics id="S2.F5.2.m1.1b"><mrow id="S2.F5.2.m1.1.1" xref="S2.F5.2.m1.1.1.cmml"><msup id="S2.F5.2.m1.1.1.2" xref="S2.F5.2.m1.1.1.2.cmml"><mi id="S2.F5.2.m1.1.1.2.2" xref="S2.F5.2.m1.1.1.2.2.cmml">e</mi><mo id="S2.F5.2.m1.1.1.2.3" xref="S2.F5.2.m1.1.1.2.3.cmml">−</mo></msup><mo id="S2.F5.2.m1.1.1.1" xref="S2.F5.2.m1.1.1.1.cmml">/</mo><msup id="S2.F5.2.m1.1.1.3" xref="S2.F5.2.m1.1.1.3.cmml"><mtext id="S2.F5.2.m1.1.1.3.2" xref="S2.F5.2.m1.1.1.3.2a.cmml">Å</mtext><mn id="S2.F5.2.m1.1.1.3.3" xref="S2.F5.2.m1.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.F5.2.m1.1c"><apply id="S2.F5.2.m1.1.1.cmml" xref="S2.F5.2.m1.1.1"><divide id="S2.F5.2.m1.1.1.1.cmml" xref="S2.F5.2.m1.1.1.1"></divide><apply id="S2.F5.2.m1.1.1.2.cmml" xref="S2.F5.2.m1.1.1.2"><csymbol cd="ambiguous" id="S2.F5.2.m1.1.1.2.1.cmml" xref="S2.F5.2.m1.1.1.2">superscript</csymbol><ci id="S2.F5.2.m1.1.1.2.2.cmml" xref="S2.F5.2.m1.1.1.2.2">𝑒</ci><minus id="S2.F5.2.m1.1.1.2.3.cmml" xref="S2.F5.2.m1.1.1.2.3"></minus></apply><apply id="S2.F5.2.m1.1.1.3.cmml" xref="S2.F5.2.m1.1.1.3"><csymbol cd="ambiguous" id="S2.F5.2.m1.1.1.3.1.cmml" xref="S2.F5.2.m1.1.1.3">superscript</csymbol><ci id="S2.F5.2.m1.1.1.3.2a.cmml" xref="S2.F5.2.m1.1.1.3.2"><mtext id="S2.F5.2.m1.1.1.3.2.cmml" xref="S2.F5.2.m1.1.1.3.2">Å</mtext></ci><cn type="integer" id="S2.F5.2.m1.1.1.3.3.cmml" xref="S2.F5.2.m1.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F5.2.m1.1d">e^{-}/\text{\AA}^{2}</annotation></semantics></math>.</figcaption>
</figure>
<div id="S2.SS2.p5" class="ltx_para ltx_noindent">
<p id="S2.SS2.p5.1" class="ltx_p">In high-throughput simulation settings, instead of producing many examples over varying noise conditions, individual examples in the training dataset could be made more informative by improving the quality of the TEM simulation, which can improve the robustness of the desired dataset and shift the source of development costs. In our case, improving the fidelity of HRTEM image formation by including the effects of inelastic scattering due to thermal vibrations, losses due to plasmonic excitations, and/or residual aberrations in the optical alignment of the microscope has a significant, positive effect on neural network performance. In Fig. <a href="#S2.F5" title="Figure 5 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">5</span></span></a>, we show the shift in performance of neural networks in the data scarce regime (N=512) when trained on data with combinations of applied thermal effects, residual aberrations, and plasmonic losses as compared to a baseline dataset with no such effects. Visually, the impact of these effects can be subtle on the simulated image (Fig. <a href="#S2.F5" title="Figure 5 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">5</span></span></a>c,d), yet, when added to the simulation data used for training, model performance can increase by as much as 0.1–0.15 in F1-score (Fig. <a href="#S2.F5" title="Figure 5 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">5</span></span></a>b). Importantly, in a regime of stable optimization, including simulation effects appears to be helpful across a wide range of applied dosage only when all additional effects are included. Of these effects, applying thermal effects is the most computationally expensive, as it requires averaging several HRTEM wavefunctions over a set of independent frozen phonon configurations, which linearly increases simulation costs, postprocessing time, and memory requirements, though, typically, only a small number of frozen phonons (O(10)) are needed to thermally converge TEM simulations of larger atomic structures. Applying the effects of residual aberrations and plasmonic losses are both relatively cheap in comparison, and thus, should be included in training datasets if possible.</p>
</div>
<figure id="S2.F6" class="ltx_figure"><img src="/html/2309.06122/assets/x6.png" id="S2.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="278" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F6.8.1.1" class="ltx_text ltx_font_bold">Figure</span> <span id="S2.F6.9.2.2" class="ltx_text ltx_font_bold">6</span>: </span>Effect of training dataset composition on neural network performance, at fixed noise levels and dataset size (N=1024 images), varying (a,b) the number of substrate thicknesses of the carbon substrate in the simulated structures, (c,d) the number of unique focal conditions in the training dataset, and (e,f) the number of unique structures in the dataset.</figcaption>
</figure>
<div id="S2.SS2.p6" class="ltx_para ltx_noindent">
<p id="S2.SS2.p6.1" class="ltx_p">The relationship between dataset composition—such as diversity of atomic structures or imaging conditions—to model performance is more nuanced, and in particular, aspects of dataset composition seem to be more important for controlling the variance of model performance than for boosting performance ceilings. That is, by including images of nanoparticles from a wide variety of structures or imaging conditions, we can much more likely guarantee that a randomly initialized model will optimize well and learn to segment experimental data effectively. In Fig. <a href="#S2.F6" title="Figure 6 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">6</span></span></a>, we measure the performance of models trained on simulated datasets of fixed size (N=1024) with varying atomic structural content and imaging conditions. Networks trained on datasets comprising images of samples with varying substrate thicknesses performed better and with lower variance than networks trained on a single, fixed substrate thickness (Fig. <a href="#S2.F6" title="Figure 6 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">6</span></span></a>a, b), indicating diversity in the atomic structures seen during training is important for image segmentation. Regarding imaging conditions, relative defocus is known to have a strong nonlinear effect on contrast features in HRTEM, which is reflected in a highly variable nonlinear relationship of model performance to the focal point of simulated data (c.f. Fig. <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:sfig:defous_sensitivity</span>). To address this, we can sample images from a larger variety of focal points (Fig <a href="#S2.F6" title="Figure 6 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">6</span></span></a> c,d), increasing the number of unique focal points (and by construction, focal range) seen during training while maintaining the total size of the dataset, which has a small positive effect on segmentation performance and a strong effect on reducing model variance. The number of unique atomic structures, however, does not significantly impact model performance (Fig. <a href="#S2.F6" title="Figure 6 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">6</span></span></a>e,f), as long as a wide variety of imaging conditions are indeed being sampled in the training dataset. In general, these data compositional effects are more significant when models are optimized more aggressively (Fig. <a href="#S2.F6" title="Figure 6 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">6</span></span></a>a,c,e) by using a larger initial learning rate and the extra data diversity can be interpreted as having a regularizing effect. Notably, regularization effects arising from an increase in data diversity might come into play only when the training dataset is already a suitable match to the experimental data being analyzed—i.e., that the distributions from which simulated training data and experimental data are drawn are similar. We find that these regularization effects are not noticeable when neural network performance is measured on the large Au or CdSe datasets (Figs. <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:sfig:large_Au</span> and <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:sfig:cdse</span>), where performance is worse overall, possibly due to the experiments measuring nanoparticle structures that are structurally dissimilar to the simulated data used to train the networks varying in focal conditions. Changing the nanoparticle size in the training data can have a strong effect on performance (c.f. Fig. <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:sfig:gen_structure</span>), but does not appear to be completely related to the size of the nanoparticles in experimental images.</p>
</div>
<div id="S2.SS2.p7" class="ltx_para ltx_noindent">
<p id="S2.SS2.p7.1" class="ltx_p">Incorporating these lessons on data effects altogether, we can design an optimized simulated dataset to target maximal absolute performance on our experimental benchmarks—ultimately, the balance of dataset size, fidelity, and composition will be dictated by the needs of a particular experiment or analytical task, which can include constraints on model size, data curation time, and model time-to-train. Here, we focused on improving performance on both the large Au dataset and the CdSe dataset by increasing the variety of atomic structures seen, including all simulation effects mentioned previously, sampling a wider range of imaging and noise conditions, and using a modestly large training dataset (8000 total images). On these benchmarks, with slight re-tuning of the training hyperparameters, we achieve a maximum F1 score of 0.9189 and 0.7516, for Au and CdSe, respectively, whilst also achieving relatively strong generalization performance (c.f. Fig. <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:sfig:gen_opt</span>). When using a random 50/50 mixture of the optimized datasets, networks have strong generalization performance across the three datasets, but better peak performance is achieved only on the small Au dataset (c.f. Table <a href="#S2.T1" title="Table 1 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">1</span></span></a>). For details regarding the composition of these datasets and the training strategy and performance measurements on other auxiliary datasets, please refer to supplemental sections <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:si_opt_au</span> and <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:si_opt_cdse</span>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:120%;">3   Discussion</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">Our results, taken altogether, indicate that high-accuracy supervised models for analyzing atomic-resolution HRTEM experiments can be trained with sufficient high-quality simulated databases. These synthetic datasets tend to need to be larger than what is typically curated experimentally (around 4000-8000 images), simulated with relatively high fidelity, and must contain appropriate dispersions of atomic structures, especially varying substrates, imaging conditions, particularly defocus, and applied noise to ensure consistent model performance. Critically, many observed effects of data curation strategies can be unnoticeable when networks perform poorly across the board or when the simulated dataset differs significantly from an experimental benchmark, as demonstrated by our tests varying the dataset composition at fixed dataset sizes (Fig. <a href="#S2.F6" title="Figure 6 ‣ 2.2 Image Segmentation of Nanoparticles with Supervised Neural Networks ‣ 2 Results ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag"><span class="ltx_text ltx_font_bold">6</span></span></a>. With precise control of the prior distributions from which training datasets were drawn, we were able to isolate these successful data curation strategies for machine learning model development, which otherwise can become almost intractable due to the large observed variance of model performances under certain training dataset conditions.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p">The advantages of simulated data primarily arise from access to arbitrarily large datasets, a broader and controlled distribution of training data, and physics-based ground-truth measurements on the dataset. Our results indicate that, even when dealing with experimental data that arises from a highly-complex measurement process, the use of simulated data during the development of ML models can compete and even provide distinct performance gains as compared to utilizing experimental data. Alternative approaches for bridging the gap between simulated data and experimental data could involve training a complementary sets of neural networks to specifically learn how to model and apply noise effects and features not captured by simulation models, e.g., with CycleGANs <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib27" title="" class="ltx_ref">27</a>)</cite>, though the extent to which such an approach could be as effective for HRTEM as for annular dark-field STEM is unclear. Well-curated experimental datasets are still immensely valuable—both as reference benchmarks, as used in this study, and as high quality training data. An important caveat of our results is that all performance metrics shown here ultimately compare physics-based ground-truth labels and expert manual labels. Given the inevitability of human measurement error, bias, and uncertainty, the two sets of labels never match perfectly, leading to a performance gap in our models and thus an artificial performance ceiling. Further work is needed to best understand measurement error in the face of such distribution gaps and to understand the best way to develop machine learning models that can make use of such mixed data given systematically different labels.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.1" class="ltx_p">Ideally, during training, a model would have access to a simulated dataset drawn from an identical distribution to the experimental prior and enough examples in this dataset to provide adequate coverage of the experimental distribution in which it will be deployed for analysis. In this setting, ML models only make in-distribution predictions, and never face extrapolation errors. In practice, it can be difficult to determine the exact experimental prior, suggesting instead a strategy of drawing training data from a distribution which the experimental distribution could be a feasible subset, thus, reducing adverse effects of distributional shifts during model deployment. General-purpose tools like Construction Zone, which enable fast sampling of realistic synthetic examples for ML problems and are not limited to any specific domain, are a crucial component of robust data workflows which would enable such sampling strategies. Further, such general purpose tools enable careful tuning of training datasets to best match experimental prior distributions, which can be performed manually or automatically, for example, as a component in an active learning training loop <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>)</cite>. Curating the best suitable dataset for a particular ML problem is a crucial component of reliable ML workflows, but should be pursued in conjunction with finding the best model framework, which can include developing bespoke model architectures <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>)</cite> or implementing custom loss functions <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib32" title="" class="ltx_ref">32</a>)</cite> with regularization <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib33" title="" class="ltx_ref">33</a>)</cite> specific to the problem of interest.</p>
</div>
<div id="S3.p4" class="ltx_para ltx_noindent">
<p id="S3.p4.1" class="ltx_p">In sum, we have developed Construction Zone, a new Python package that enables programmatic generation and sampling of atomic nanostructures, a general purpose tool designed primarily designed to help study and design ML workflows at scale for nanoscale materials science problems. In conjunction with HRTEM simulation, we systematically generate large structural and imaging databases for training ML models and have demonstrated their utility for automated atomic-scale characterization with HRTEM. By systematically generating large structural and imaging databases, we achieve state-of-the-art performance on such models, whilst also providing the ability to design and develop ML tools carefully through high levels of specific control on the data generation process.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:120%;">4   Detailed Methods</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Construction Zone</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">Nanoscale atomic structures can be designed in Construction Zone (CZ) using a combination of Generator, Volume, Transformation, and Scene objects. Generators, which supply atoms in space, specify atom positions and can generate atoms in both crystalline and non-crystalline arrangements. Volume objects define the convex regions in which atoms from Generators are accepted. Volumes can either be defined by sets of convex algebraic surfaces, convex hulls of point clouds, or intersections of supplied convex objects; non-convex geometries can be created as the union of multiple Volumes. The Transformation module manipulates objects with standard routines like symmetry operations and more complex routines like applying inhomogenous strain fields or modifying the local chemistry of a structure. Generators and Volumes can be manipulated jointly or individually for full construction flexibility. For example, a grain can be oriented either by rotating a Generator lattice relative to its boundary or by rotating the whole object in global coordinates. Finally, Scenes aggregate objects together. Given a set of atomic objects, a Scene will handle interactions through a generation precedence scheme and prepares data for interfacing with other simulation methods or for writing to file.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p">CZ also features a small set of auxiliary modules for more complex functionality and convenience. The Surface module provides fast routines for analyzing, querying, and modifying the surface of a generated object using derivatives of alpha-shape algorithms <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>)</cite>. The Utilities module provides several analysis routines, such as radial distribution function (RDF) analysis and orientation sampling. Lastly, the Prefab module contains routines that generate “pre-packaged” objects like Wulff constructions of nanoparticles (as implemented in <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib15" title="" class="ltx_ref">15</a>)</cite>) or grain structures with planar defects. For a full discussion of underlying routines, available features, and package usage, we refer the reader to the CZ documentation<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/lerandc/construction-zone, https://construction-zone.readthedocs.io/en/latest/</span></span></span>.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>TEM simulation</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p">High-resolution TEM image simulations in this study were performed using the multislice algorithm <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib20" title="" class="ltx_ref">20</a>)</cite>, as implemented in the Prismatic software package <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib4" title="" class="ltx_ref">4</a>)</cite>. In the multislice algorithm, we model the image created in an electron microscope through the interaction of an electron beam and a material sample as the evolution of a 2D complex wavefunction, <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\psi(\mathbf{r})" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.2.2" xref="S4.SS2.p1.1.m1.1.2.2.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.2.1" xref="S4.SS2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.1.m1.1.2.3.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.3.2.1" xref="S4.SS2.p1.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">𝐫</mi><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.3.2.2" xref="S4.SS2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.2"><times id="S4.SS2.p1.1.m1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.2.1"></times><ci id="S4.SS2.p1.1.m1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.2.2">𝜓</ci><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\psi(\mathbf{r})</annotation></semantics></math>. The evolution of the wavefunction is given by the Schrödinger equation for fast electrons <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib36" title="" class="ltx_ref">36</a>)</cite></p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.5" class="ltx_Math" alttext="\frac{\partial\psi(\mathbf{r})}{\partial z}=\frac{{i\mkern 1.0mu}\lambda}{4\pi}\nabla^{2}\psi(\mathbf{r})+{i\mkern 1.0mu}\sigma V(\mathbf{r})\psi(\mathbf{r})\,," display="block"><semantics id="S4.E1.m1.5a"><mrow id="S4.E1.m1.5.5.1" xref="S4.E1.m1.5.5.1.1.cmml"><mrow id="S4.E1.m1.5.5.1.1" xref="S4.E1.m1.5.5.1.1.cmml"><mfrac id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml"><mrow id="S4.E1.m1.1.1.1" xref="S4.E1.m1.1.1.1.cmml"><mo rspace="0em" id="S4.E1.m1.1.1.1.2" xref="S4.E1.m1.1.1.1.2.cmml">∂</mo><mrow id="S4.E1.m1.1.1.1.3" xref="S4.E1.m1.1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.3.2.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.1.1.1.3.1" xref="S4.E1.m1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E1.m1.1.1.1.3.3.2" xref="S4.E1.m1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E1.m1.1.1.1.3.3.2.1" xref="S4.E1.m1.1.1.1.3.cmml">(</mo><mi id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml">𝐫</mi><mo stretchy="false" id="S4.E1.m1.1.1.1.3.3.2.2" xref="S4.E1.m1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mrow id="S4.E1.m1.1.1.3" xref="S4.E1.m1.1.1.3.cmml"><mo rspace="0em" id="S4.E1.m1.1.1.3.1" xref="S4.E1.m1.1.1.3.1.cmml">∂</mo><mi id="S4.E1.m1.1.1.3.2" xref="S4.E1.m1.1.1.3.2.cmml">z</mi></mrow></mfrac><mo id="S4.E1.m1.5.5.1.1.1" xref="S4.E1.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E1.m1.5.5.1.1.2" xref="S4.E1.m1.5.5.1.1.2.cmml"><mrow id="S4.E1.m1.5.5.1.1.2.2" xref="S4.E1.m1.5.5.1.1.2.2.cmml"><mfrac id="S4.E1.m1.5.5.1.1.2.2.2" xref="S4.E1.m1.5.5.1.1.2.2.2.cmml"><mrow id="S4.E1.m1.5.5.1.1.2.2.2.2" xref="S4.E1.m1.5.5.1.1.2.2.2.2.cmml"><mi id="S4.E1.m1.5.5.1.1.2.2.2.2.2" xref="S4.E1.m1.5.5.1.1.2.2.2.2.2.cmml">i</mi><mo lspace="0.060em" rspace="0em" id="S4.E1.m1.5.5.1.1.2.2.2.2.1" xref="S4.E1.m1.5.5.1.1.2.2.2.2.1.cmml">​</mo><mi id="S4.E1.m1.5.5.1.1.2.2.2.2.3" xref="S4.E1.m1.5.5.1.1.2.2.2.2.3.cmml">λ</mi></mrow><mrow id="S4.E1.m1.5.5.1.1.2.2.2.3" xref="S4.E1.m1.5.5.1.1.2.2.2.3.cmml"><mn id="S4.E1.m1.5.5.1.1.2.2.2.3.2" xref="S4.E1.m1.5.5.1.1.2.2.2.3.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S4.E1.m1.5.5.1.1.2.2.2.3.1" xref="S4.E1.m1.5.5.1.1.2.2.2.3.1.cmml">​</mo><mi id="S4.E1.m1.5.5.1.1.2.2.2.3.3" xref="S4.E1.m1.5.5.1.1.2.2.2.3.3.cmml">π</mi></mrow></mfrac><mo lspace="0.167em" rspace="0em" id="S4.E1.m1.5.5.1.1.2.2.1" xref="S4.E1.m1.5.5.1.1.2.2.1.cmml">​</mo><mrow id="S4.E1.m1.5.5.1.1.2.2.3" xref="S4.E1.m1.5.5.1.1.2.2.3.cmml"><msup id="S4.E1.m1.5.5.1.1.2.2.3.1" xref="S4.E1.m1.5.5.1.1.2.2.3.1.cmml"><mo rspace="0.167em" id="S4.E1.m1.5.5.1.1.2.2.3.1.2" xref="S4.E1.m1.5.5.1.1.2.2.3.1.2.cmml">∇</mo><mn id="S4.E1.m1.5.5.1.1.2.2.3.1.3" xref="S4.E1.m1.5.5.1.1.2.2.3.1.3.cmml">2</mn></msup><mi id="S4.E1.m1.5.5.1.1.2.2.3.2" xref="S4.E1.m1.5.5.1.1.2.2.3.2.cmml">ψ</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E1.m1.5.5.1.1.2.2.1a" xref="S4.E1.m1.5.5.1.1.2.2.1.cmml">​</mo><mrow id="S4.E1.m1.5.5.1.1.2.2.4.2" xref="S4.E1.m1.5.5.1.1.2.2.cmml"><mo stretchy="false" id="S4.E1.m1.5.5.1.1.2.2.4.2.1" xref="S4.E1.m1.5.5.1.1.2.2.cmml">(</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">𝐫</mi><mo stretchy="false" id="S4.E1.m1.5.5.1.1.2.2.4.2.2" xref="S4.E1.m1.5.5.1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.5.5.1.1.2.1" xref="S4.E1.m1.5.5.1.1.2.1.cmml">+</mo><mrow id="S4.E1.m1.5.5.1.1.2.3" xref="S4.E1.m1.5.5.1.1.2.3.cmml"><mi id="S4.E1.m1.5.5.1.1.2.3.2" xref="S4.E1.m1.5.5.1.1.2.3.2.cmml">i</mi><mo lspace="0.060em" rspace="0em" id="S4.E1.m1.5.5.1.1.2.3.1" xref="S4.E1.m1.5.5.1.1.2.3.1.cmml">​</mo><mi id="S4.E1.m1.5.5.1.1.2.3.3" xref="S4.E1.m1.5.5.1.1.2.3.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.5.5.1.1.2.3.1a" xref="S4.E1.m1.5.5.1.1.2.3.1.cmml">​</mo><mi id="S4.E1.m1.5.5.1.1.2.3.4" xref="S4.E1.m1.5.5.1.1.2.3.4.cmml">V</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.5.5.1.1.2.3.1b" xref="S4.E1.m1.5.5.1.1.2.3.1.cmml">​</mo><mrow id="S4.E1.m1.5.5.1.1.2.3.5.2" xref="S4.E1.m1.5.5.1.1.2.3.cmml"><mo stretchy="false" id="S4.E1.m1.5.5.1.1.2.3.5.2.1" xref="S4.E1.m1.5.5.1.1.2.3.cmml">(</mo><mi id="S4.E1.m1.3.3" xref="S4.E1.m1.3.3.cmml">𝐫</mi><mo stretchy="false" id="S4.E1.m1.5.5.1.1.2.3.5.2.2" xref="S4.E1.m1.5.5.1.1.2.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E1.m1.5.5.1.1.2.3.1c" xref="S4.E1.m1.5.5.1.1.2.3.1.cmml">​</mo><mi id="S4.E1.m1.5.5.1.1.2.3.6" xref="S4.E1.m1.5.5.1.1.2.3.6.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S4.E1.m1.5.5.1.1.2.3.1d" xref="S4.E1.m1.5.5.1.1.2.3.1.cmml">​</mo><mrow id="S4.E1.m1.5.5.1.1.2.3.7.2" xref="S4.E1.m1.5.5.1.1.2.3.cmml"><mo stretchy="false" id="S4.E1.m1.5.5.1.1.2.3.7.2.1" xref="S4.E1.m1.5.5.1.1.2.3.cmml">(</mo><mi id="S4.E1.m1.4.4" xref="S4.E1.m1.4.4.cmml">𝐫</mi><mo rspace="0.170em" stretchy="false" id="S4.E1.m1.5.5.1.1.2.3.7.2.2" xref="S4.E1.m1.5.5.1.1.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E1.m1.5.5.1.2" xref="S4.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.5b"><apply id="S4.E1.m1.5.5.1.1.cmml" xref="S4.E1.m1.5.5.1"><eq id="S4.E1.m1.5.5.1.1.1.cmml" xref="S4.E1.m1.5.5.1.1.1"></eq><apply id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1"><divide id="S4.E1.m1.1.1.2.cmml" xref="S4.E1.m1.1.1"></divide><apply id="S4.E1.m1.1.1.1.cmml" xref="S4.E1.m1.1.1.1"><partialdiff id="S4.E1.m1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.2"></partialdiff><apply id="S4.E1.m1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.3"><times id="S4.E1.m1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.3.1"></times><ci id="S4.E1.m1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.3.2">𝜓</ci><ci id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1">𝐫</ci></apply></apply><apply id="S4.E1.m1.1.1.3.cmml" xref="S4.E1.m1.1.1.3"><partialdiff id="S4.E1.m1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.3.1"></partialdiff><ci id="S4.E1.m1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.3.2">𝑧</ci></apply></apply><apply id="S4.E1.m1.5.5.1.1.2.cmml" xref="S4.E1.m1.5.5.1.1.2"><plus id="S4.E1.m1.5.5.1.1.2.1.cmml" xref="S4.E1.m1.5.5.1.1.2.1"></plus><apply id="S4.E1.m1.5.5.1.1.2.2.cmml" xref="S4.E1.m1.5.5.1.1.2.2"><times id="S4.E1.m1.5.5.1.1.2.2.1.cmml" xref="S4.E1.m1.5.5.1.1.2.2.1"></times><apply id="S4.E1.m1.5.5.1.1.2.2.2.cmml" xref="S4.E1.m1.5.5.1.1.2.2.2"><divide id="S4.E1.m1.5.5.1.1.2.2.2.1.cmml" xref="S4.E1.m1.5.5.1.1.2.2.2"></divide><apply id="S4.E1.m1.5.5.1.1.2.2.2.2.cmml" xref="S4.E1.m1.5.5.1.1.2.2.2.2"><times id="S4.E1.m1.5.5.1.1.2.2.2.2.1.cmml" xref="S4.E1.m1.5.5.1.1.2.2.2.2.1"></times><ci id="S4.E1.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S4.E1.m1.5.5.1.1.2.2.2.2.2">𝑖</ci><ci id="S4.E1.m1.5.5.1.1.2.2.2.2.3.cmml" xref="S4.E1.m1.5.5.1.1.2.2.2.2.3">𝜆</ci></apply><apply id="S4.E1.m1.5.5.1.1.2.2.2.3.cmml" xref="S4.E1.m1.5.5.1.1.2.2.2.3"><times id="S4.E1.m1.5.5.1.1.2.2.2.3.1.cmml" xref="S4.E1.m1.5.5.1.1.2.2.2.3.1"></times><cn type="integer" id="S4.E1.m1.5.5.1.1.2.2.2.3.2.cmml" xref="S4.E1.m1.5.5.1.1.2.2.2.3.2">4</cn><ci id="S4.E1.m1.5.5.1.1.2.2.2.3.3.cmml" xref="S4.E1.m1.5.5.1.1.2.2.2.3.3">𝜋</ci></apply></apply><apply id="S4.E1.m1.5.5.1.1.2.2.3.cmml" xref="S4.E1.m1.5.5.1.1.2.2.3"><apply id="S4.E1.m1.5.5.1.1.2.2.3.1.cmml" xref="S4.E1.m1.5.5.1.1.2.2.3.1"><csymbol cd="ambiguous" id="S4.E1.m1.5.5.1.1.2.2.3.1.1.cmml" xref="S4.E1.m1.5.5.1.1.2.2.3.1">superscript</csymbol><ci id="S4.E1.m1.5.5.1.1.2.2.3.1.2.cmml" xref="S4.E1.m1.5.5.1.1.2.2.3.1.2">∇</ci><cn type="integer" id="S4.E1.m1.5.5.1.1.2.2.3.1.3.cmml" xref="S4.E1.m1.5.5.1.1.2.2.3.1.3">2</cn></apply><ci id="S4.E1.m1.5.5.1.1.2.2.3.2.cmml" xref="S4.E1.m1.5.5.1.1.2.2.3.2">𝜓</ci></apply><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝐫</ci></apply><apply id="S4.E1.m1.5.5.1.1.2.3.cmml" xref="S4.E1.m1.5.5.1.1.2.3"><times id="S4.E1.m1.5.5.1.1.2.3.1.cmml" xref="S4.E1.m1.5.5.1.1.2.3.1"></times><ci id="S4.E1.m1.5.5.1.1.2.3.2.cmml" xref="S4.E1.m1.5.5.1.1.2.3.2">𝑖</ci><ci id="S4.E1.m1.5.5.1.1.2.3.3.cmml" xref="S4.E1.m1.5.5.1.1.2.3.3">𝜎</ci><ci id="S4.E1.m1.5.5.1.1.2.3.4.cmml" xref="S4.E1.m1.5.5.1.1.2.3.4">𝑉</ci><ci id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">𝐫</ci><ci id="S4.E1.m1.5.5.1.1.2.3.6.cmml" xref="S4.E1.m1.5.5.1.1.2.3.6">𝜓</ci><ci id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4">𝐫</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.5c">\frac{\partial\psi(\mathbf{r})}{\partial z}=\frac{{i\mkern 1.0mu}\lambda}{4\pi}\nabla^{2}\psi(\mathbf{r})+{i\mkern 1.0mu}\sigma V(\mathbf{r})\psi(\mathbf{r})\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.3" class="ltx_p">where <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="V(\mathbf{r})" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.2" xref="S4.SS2.p3.1.m1.1.2.cmml"><mi id="S4.SS2.p3.1.m1.1.2.2" xref="S4.SS2.p3.1.m1.1.2.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.1.m1.1.2.1" xref="S4.SS2.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p3.1.m1.1.2.3.2" xref="S4.SS2.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m1.1.2.3.2.1" xref="S4.SS2.p3.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">𝐫</mi><mo stretchy="false" id="S4.SS2.p3.1.m1.1.2.3.2.2" xref="S4.SS2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.2"><times id="S4.SS2.p3.1.m1.1.2.1.cmml" xref="S4.SS2.p3.1.m1.1.2.1"></times><ci id="S4.SS2.p3.1.m1.1.2.2.cmml" xref="S4.SS2.p3.1.m1.1.2.2">𝑉</ci><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">V(\mathbf{r})</annotation></semantics></math> is the electrostatic potential of the sample and <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><ci id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\sigma</annotation></semantics></math> is an interaction constant. <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="V(\mathbf{r})" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.2" xref="S4.SS2.p3.3.m3.1.2.cmml"><mi id="S4.SS2.p3.3.m3.1.2.2" xref="S4.SS2.p3.3.m3.1.2.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p3.3.m3.1.2.1" xref="S4.SS2.p3.3.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.p3.3.m3.1.2.3.2" xref="S4.SS2.p3.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p3.3.m3.1.2.3.2.1" xref="S4.SS2.p3.3.m3.1.2.cmml">(</mo><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">𝐫</mi><mo stretchy="false" id="S4.SS2.p3.3.m3.1.2.3.2.2" xref="S4.SS2.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.2.cmml" xref="S4.SS2.p3.3.m3.1.2"><times id="S4.SS2.p3.3.m3.1.2.1.cmml" xref="S4.SS2.p3.3.m3.1.2.1"></times><ci id="S4.SS2.p3.3.m3.1.2.2.cmml" xref="S4.SS2.p3.3.m3.1.2.2">𝑉</ci><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">V(\mathbf{r})</annotation></semantics></math> is typically calculated with an isolated atom approach, where the total potential is the sum of independent atomic potentials</p>
</div>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.2" class="ltx_Math" alttext="V(\mathbf{r})=\sum_{i}V_{i}(\mathbf{r})" display="block"><semantics id="S4.E2.m1.2a"><mrow id="S4.E2.m1.2.3" xref="S4.E2.m1.2.3.cmml"><mrow id="S4.E2.m1.2.3.2" xref="S4.E2.m1.2.3.2.cmml"><mi id="S4.E2.m1.2.3.2.2" xref="S4.E2.m1.2.3.2.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.3.2.1" xref="S4.E2.m1.2.3.2.1.cmml">​</mo><mrow id="S4.E2.m1.2.3.2.3.2" xref="S4.E2.m1.2.3.2.cmml"><mo stretchy="false" id="S4.E2.m1.2.3.2.3.2.1" xref="S4.E2.m1.2.3.2.cmml">(</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">𝐫</mi><mo stretchy="false" id="S4.E2.m1.2.3.2.3.2.2" xref="S4.E2.m1.2.3.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S4.E2.m1.2.3.1" xref="S4.E2.m1.2.3.1.cmml">=</mo><mrow id="S4.E2.m1.2.3.3" xref="S4.E2.m1.2.3.3.cmml"><munder id="S4.E2.m1.2.3.3.1" xref="S4.E2.m1.2.3.3.1.cmml"><mo movablelimits="false" id="S4.E2.m1.2.3.3.1.2" xref="S4.E2.m1.2.3.3.1.2.cmml">∑</mo><mi id="S4.E2.m1.2.3.3.1.3" xref="S4.E2.m1.2.3.3.1.3.cmml">i</mi></munder><mrow id="S4.E2.m1.2.3.3.2" xref="S4.E2.m1.2.3.3.2.cmml"><msub id="S4.E2.m1.2.3.3.2.2" xref="S4.E2.m1.2.3.3.2.2.cmml"><mi id="S4.E2.m1.2.3.3.2.2.2" xref="S4.E2.m1.2.3.3.2.2.2.cmml">V</mi><mi id="S4.E2.m1.2.3.3.2.2.3" xref="S4.E2.m1.2.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.2.3.3.2.1" xref="S4.E2.m1.2.3.3.2.1.cmml">​</mo><mrow id="S4.E2.m1.2.3.3.2.3.2" xref="S4.E2.m1.2.3.3.2.cmml"><mo stretchy="false" id="S4.E2.m1.2.3.3.2.3.2.1" xref="S4.E2.m1.2.3.3.2.cmml">(</mo><mi id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml">𝐫</mi><mo stretchy="false" id="S4.E2.m1.2.3.3.2.3.2.2" xref="S4.E2.m1.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.2b"><apply id="S4.E2.m1.2.3.cmml" xref="S4.E2.m1.2.3"><eq id="S4.E2.m1.2.3.1.cmml" xref="S4.E2.m1.2.3.1"></eq><apply id="S4.E2.m1.2.3.2.cmml" xref="S4.E2.m1.2.3.2"><times id="S4.E2.m1.2.3.2.1.cmml" xref="S4.E2.m1.2.3.2.1"></times><ci id="S4.E2.m1.2.3.2.2.cmml" xref="S4.E2.m1.2.3.2.2">𝑉</ci><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝐫</ci></apply><apply id="S4.E2.m1.2.3.3.cmml" xref="S4.E2.m1.2.3.3"><apply id="S4.E2.m1.2.3.3.1.cmml" xref="S4.E2.m1.2.3.3.1"><csymbol cd="ambiguous" id="S4.E2.m1.2.3.3.1.1.cmml" xref="S4.E2.m1.2.3.3.1">subscript</csymbol><sum id="S4.E2.m1.2.3.3.1.2.cmml" xref="S4.E2.m1.2.3.3.1.2"></sum><ci id="S4.E2.m1.2.3.3.1.3.cmml" xref="S4.E2.m1.2.3.3.1.3">𝑖</ci></apply><apply id="S4.E2.m1.2.3.3.2.cmml" xref="S4.E2.m1.2.3.3.2"><times id="S4.E2.m1.2.3.3.2.1.cmml" xref="S4.E2.m1.2.3.3.2.1"></times><apply id="S4.E2.m1.2.3.3.2.2.cmml" xref="S4.E2.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.2.3.3.2.2.1.cmml" xref="S4.E2.m1.2.3.3.2.2">subscript</csymbol><ci id="S4.E2.m1.2.3.3.2.2.2.cmml" xref="S4.E2.m1.2.3.3.2.2.2">𝑉</ci><ci id="S4.E2.m1.2.3.3.2.2.3.cmml" xref="S4.E2.m1.2.3.3.2.2.3">𝑖</ci></apply><ci id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2">𝐫</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.2c">V(\mathbf{r})=\sum_{i}V_{i}(\mathbf{r})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p5" class="ltx_para ltx_noindent">
<p id="S4.SS2.p5.2" class="ltx_p">where the individual atomic potentials themselves calculated with a parameterized look-up table of electron scattering factors <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>)</cite>. Alternatively, the scattering potential can be determined for a sample through ab-initio techniques <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib7" title="" class="ltx_ref">7</a>)</cite>. Once <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="V(\mathbf{r})" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><mrow id="S4.SS2.p5.1.m1.1.2" xref="S4.SS2.p5.1.m1.1.2.cmml"><mi id="S4.SS2.p5.1.m1.1.2.2" xref="S4.SS2.p5.1.m1.1.2.2.cmml">V</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p5.1.m1.1.2.1" xref="S4.SS2.p5.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p5.1.m1.1.2.3.2" xref="S4.SS2.p5.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p5.1.m1.1.2.3.2.1" xref="S4.SS2.p5.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">𝐫</mi><mo stretchy="false" id="S4.SS2.p5.1.m1.1.2.3.2.2" xref="S4.SS2.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.2"><times id="S4.SS2.p5.1.m1.1.2.1.cmml" xref="S4.SS2.p5.1.m1.1.2.1"></times><ci id="S4.SS2.p5.1.m1.1.2.2.cmml" xref="S4.SS2.p5.1.m1.1.2.2">𝑉</ci><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">V(\mathbf{r})</annotation></semantics></math> is determined, it is split into a series of binned slices along the beam direction and then the wavefunction <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="\psi(\mathbf{r})" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><mrow id="S4.SS2.p5.2.m2.1.2" xref="S4.SS2.p5.2.m2.1.2.cmml"><mi id="S4.SS2.p5.2.m2.1.2.2" xref="S4.SS2.p5.2.m2.1.2.2.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p5.2.m2.1.2.1" xref="S4.SS2.p5.2.m2.1.2.1.cmml">​</mo><mrow id="S4.SS2.p5.2.m2.1.2.3.2" xref="S4.SS2.p5.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS2.p5.2.m2.1.2.3.2.1" xref="S4.SS2.p5.2.m2.1.2.cmml">(</mo><mi id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">𝐫</mi><mo stretchy="false" id="S4.SS2.p5.2.m2.1.2.3.2.2" xref="S4.SS2.p5.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.2.cmml" xref="S4.SS2.p5.2.m2.1.2"><times id="S4.SS2.p5.2.m2.1.2.1.cmml" xref="S4.SS2.p5.2.m2.1.2.1"></times><ci id="S4.SS2.p5.2.m2.1.2.2.cmml" xref="S4.SS2.p5.2.m2.1.2.2">𝜓</ci><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\psi(\mathbf{r})</annotation></semantics></math> is evolved through a split-step method, where the electron beam alternately interacts with the sample</p>
</div>
<div id="S4.SS2.p6" class="ltx_para ltx_noindent">
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.6" class="ltx_Math" alttext="\psi(\mathbf{r})=T(\mathbf{r})\psi_{0}(\mathbf{r})=e^{{i\mkern 1.0mu}\sigma V_{n}(\mathbf{r})}\psi_{0}(\mathbf{r})," display="block"><semantics id="S4.E3.m1.6a"><mrow id="S4.E3.m1.6.6.1" xref="S4.E3.m1.6.6.1.1.cmml"><mrow id="S4.E3.m1.6.6.1.1" xref="S4.E3.m1.6.6.1.1.cmml"><mrow id="S4.E3.m1.6.6.1.1.2" xref="S4.E3.m1.6.6.1.1.2.cmml"><mi id="S4.E3.m1.6.6.1.1.2.2" xref="S4.E3.m1.6.6.1.1.2.2.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.6.6.1.1.2.1" xref="S4.E3.m1.6.6.1.1.2.1.cmml">​</mo><mrow id="S4.E3.m1.6.6.1.1.2.3.2" xref="S4.E3.m1.6.6.1.1.2.cmml"><mo stretchy="false" id="S4.E3.m1.6.6.1.1.2.3.2.1" xref="S4.E3.m1.6.6.1.1.2.cmml">(</mo><mi id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml">𝐫</mi><mo stretchy="false" id="S4.E3.m1.6.6.1.1.2.3.2.2" xref="S4.E3.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.6.6.1.1.3" xref="S4.E3.m1.6.6.1.1.3.cmml">=</mo><mrow id="S4.E3.m1.6.6.1.1.4" xref="S4.E3.m1.6.6.1.1.4.cmml"><mi id="S4.E3.m1.6.6.1.1.4.2" xref="S4.E3.m1.6.6.1.1.4.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.6.6.1.1.4.1" xref="S4.E3.m1.6.6.1.1.4.1.cmml">​</mo><mrow id="S4.E3.m1.6.6.1.1.4.3.2" xref="S4.E3.m1.6.6.1.1.4.cmml"><mo stretchy="false" id="S4.E3.m1.6.6.1.1.4.3.2.1" xref="S4.E3.m1.6.6.1.1.4.cmml">(</mo><mi id="S4.E3.m1.3.3" xref="S4.E3.m1.3.3.cmml">𝐫</mi><mo stretchy="false" id="S4.E3.m1.6.6.1.1.4.3.2.2" xref="S4.E3.m1.6.6.1.1.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E3.m1.6.6.1.1.4.1a" xref="S4.E3.m1.6.6.1.1.4.1.cmml">​</mo><msub id="S4.E3.m1.6.6.1.1.4.4" xref="S4.E3.m1.6.6.1.1.4.4.cmml"><mi id="S4.E3.m1.6.6.1.1.4.4.2" xref="S4.E3.m1.6.6.1.1.4.4.2.cmml">ψ</mi><mn id="S4.E3.m1.6.6.1.1.4.4.3" xref="S4.E3.m1.6.6.1.1.4.4.3.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.6.6.1.1.4.1b" xref="S4.E3.m1.6.6.1.1.4.1.cmml">​</mo><mrow id="S4.E3.m1.6.6.1.1.4.5.2" xref="S4.E3.m1.6.6.1.1.4.cmml"><mo stretchy="false" id="S4.E3.m1.6.6.1.1.4.5.2.1" xref="S4.E3.m1.6.6.1.1.4.cmml">(</mo><mi id="S4.E3.m1.4.4" xref="S4.E3.m1.4.4.cmml">𝐫</mi><mo stretchy="false" id="S4.E3.m1.6.6.1.1.4.5.2.2" xref="S4.E3.m1.6.6.1.1.4.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.6.6.1.1.5" xref="S4.E3.m1.6.6.1.1.5.cmml">=</mo><mrow id="S4.E3.m1.6.6.1.1.6" xref="S4.E3.m1.6.6.1.1.6.cmml"><msup id="S4.E3.m1.6.6.1.1.6.2" xref="S4.E3.m1.6.6.1.1.6.2.cmml"><mi id="S4.E3.m1.6.6.1.1.6.2.2" xref="S4.E3.m1.6.6.1.1.6.2.2.cmml">e</mi><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.1.1.1.3.cmml">i</mi><mo lspace="0.060em" rspace="0em" id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.2.cmml">​</mo><mi id="S4.E3.m1.1.1.1.4" xref="S4.E3.m1.1.1.1.4.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.2a" xref="S4.E3.m1.1.1.1.2.cmml">​</mo><msub id="S4.E3.m1.1.1.1.5" xref="S4.E3.m1.1.1.1.5.cmml"><mi id="S4.E3.m1.1.1.1.5.2" xref="S4.E3.m1.1.1.1.5.2.cmml">V</mi><mi id="S4.E3.m1.1.1.1.5.3" xref="S4.E3.m1.1.1.1.5.3.cmml">n</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.2b" xref="S4.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.1.1.1.6.2" xref="S4.E3.m1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.6.2.1" xref="S4.E3.m1.1.1.1.cmml">(</mo><mi id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml">𝐫</mi><mo stretchy="false" id="S4.E3.m1.1.1.1.6.2.2" xref="S4.E3.m1.1.1.1.cmml">)</mo></mrow></mrow></msup><mo lspace="0em" rspace="0em" id="S4.E3.m1.6.6.1.1.6.1" xref="S4.E3.m1.6.6.1.1.6.1.cmml">​</mo><msub id="S4.E3.m1.6.6.1.1.6.3" xref="S4.E3.m1.6.6.1.1.6.3.cmml"><mi id="S4.E3.m1.6.6.1.1.6.3.2" xref="S4.E3.m1.6.6.1.1.6.3.2.cmml">ψ</mi><mn id="S4.E3.m1.6.6.1.1.6.3.3" xref="S4.E3.m1.6.6.1.1.6.3.3.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.6.6.1.1.6.1a" xref="S4.E3.m1.6.6.1.1.6.1.cmml">​</mo><mrow id="S4.E3.m1.6.6.1.1.6.4.2" xref="S4.E3.m1.6.6.1.1.6.cmml"><mo stretchy="false" id="S4.E3.m1.6.6.1.1.6.4.2.1" xref="S4.E3.m1.6.6.1.1.6.cmml">(</mo><mi id="S4.E3.m1.5.5" xref="S4.E3.m1.5.5.cmml">𝐫</mi><mo stretchy="false" id="S4.E3.m1.6.6.1.1.6.4.2.2" xref="S4.E3.m1.6.6.1.1.6.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.6.6.1.2" xref="S4.E3.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.6b"><apply id="S4.E3.m1.6.6.1.1.cmml" xref="S4.E3.m1.6.6.1"><and id="S4.E3.m1.6.6.1.1a.cmml" xref="S4.E3.m1.6.6.1"></and><apply id="S4.E3.m1.6.6.1.1b.cmml" xref="S4.E3.m1.6.6.1"><eq id="S4.E3.m1.6.6.1.1.3.cmml" xref="S4.E3.m1.6.6.1.1.3"></eq><apply id="S4.E3.m1.6.6.1.1.2.cmml" xref="S4.E3.m1.6.6.1.1.2"><times id="S4.E3.m1.6.6.1.1.2.1.cmml" xref="S4.E3.m1.6.6.1.1.2.1"></times><ci id="S4.E3.m1.6.6.1.1.2.2.cmml" xref="S4.E3.m1.6.6.1.1.2.2">𝜓</ci><ci id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2">𝐫</ci></apply><apply id="S4.E3.m1.6.6.1.1.4.cmml" xref="S4.E3.m1.6.6.1.1.4"><times id="S4.E3.m1.6.6.1.1.4.1.cmml" xref="S4.E3.m1.6.6.1.1.4.1"></times><ci id="S4.E3.m1.6.6.1.1.4.2.cmml" xref="S4.E3.m1.6.6.1.1.4.2">𝑇</ci><ci id="S4.E3.m1.3.3.cmml" xref="S4.E3.m1.3.3">𝐫</ci><apply id="S4.E3.m1.6.6.1.1.4.4.cmml" xref="S4.E3.m1.6.6.1.1.4.4"><csymbol cd="ambiguous" id="S4.E3.m1.6.6.1.1.4.4.1.cmml" xref="S4.E3.m1.6.6.1.1.4.4">subscript</csymbol><ci id="S4.E3.m1.6.6.1.1.4.4.2.cmml" xref="S4.E3.m1.6.6.1.1.4.4.2">𝜓</ci><cn type="integer" id="S4.E3.m1.6.6.1.1.4.4.3.cmml" xref="S4.E3.m1.6.6.1.1.4.4.3">0</cn></apply><ci id="S4.E3.m1.4.4.cmml" xref="S4.E3.m1.4.4">𝐫</ci></apply></apply><apply id="S4.E3.m1.6.6.1.1c.cmml" xref="S4.E3.m1.6.6.1"><eq id="S4.E3.m1.6.6.1.1.5.cmml" xref="S4.E3.m1.6.6.1.1.5"></eq><share href="#S4.E3.m1.6.6.1.1.4.cmml" id="S4.E3.m1.6.6.1.1d.cmml" xref="S4.E3.m1.6.6.1"></share><apply id="S4.E3.m1.6.6.1.1.6.cmml" xref="S4.E3.m1.6.6.1.1.6"><times id="S4.E3.m1.6.6.1.1.6.1.cmml" xref="S4.E3.m1.6.6.1.1.6.1"></times><apply id="S4.E3.m1.6.6.1.1.6.2.cmml" xref="S4.E3.m1.6.6.1.1.6.2"><csymbol cd="ambiguous" id="S4.E3.m1.6.6.1.1.6.2.1.cmml" xref="S4.E3.m1.6.6.1.1.6.2">superscript</csymbol><ci id="S4.E3.m1.6.6.1.1.6.2.2.cmml" xref="S4.E3.m1.6.6.1.1.6.2.2">𝑒</ci><apply id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><times id="S4.E3.m1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.2"></times><ci id="S4.E3.m1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.3">𝑖</ci><ci id="S4.E3.m1.1.1.1.4.cmml" xref="S4.E3.m1.1.1.1.4">𝜎</ci><apply id="S4.E3.m1.1.1.1.5.cmml" xref="S4.E3.m1.1.1.1.5"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.5.1.cmml" xref="S4.E3.m1.1.1.1.5">subscript</csymbol><ci id="S4.E3.m1.1.1.1.5.2.cmml" xref="S4.E3.m1.1.1.1.5.2">𝑉</ci><ci id="S4.E3.m1.1.1.1.5.3.cmml" xref="S4.E3.m1.1.1.1.5.3">𝑛</ci></apply><ci id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1">𝐫</ci></apply></apply><apply id="S4.E3.m1.6.6.1.1.6.3.cmml" xref="S4.E3.m1.6.6.1.1.6.3"><csymbol cd="ambiguous" id="S4.E3.m1.6.6.1.1.6.3.1.cmml" xref="S4.E3.m1.6.6.1.1.6.3">subscript</csymbol><ci id="S4.E3.m1.6.6.1.1.6.3.2.cmml" xref="S4.E3.m1.6.6.1.1.6.3.2">𝜓</ci><cn type="integer" id="S4.E3.m1.6.6.1.1.6.3.3.cmml" xref="S4.E3.m1.6.6.1.1.6.3.3">0</cn></apply><ci id="S4.E3.m1.5.5.cmml" xref="S4.E3.m1.5.5">𝐫</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.6c">\psi(\mathbf{r})=T(\mathbf{r})\psi_{0}(\mathbf{r})=e^{{i\mkern 1.0mu}\sigma V_{n}(\mathbf{r})}\psi_{0}(\mathbf{r}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p7" class="ltx_para ltx_noindent">
<p id="S4.SS2.p7.1" class="ltx_p">and then propagates in free space</p>
</div>
<div id="S4.SS2.p8" class="ltx_para ltx_noindent">
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.4" class="ltx_Math" alttext="\psi(\mathbf{r})=\hat{\mathcal{F}}^{-1}_{\mathbf{k}\to\mathbf{r}}\left\{e^{{i\mkern 1.0mu}\lambda\Delta z|\mathbf{k}|^{2}}\hat{\mathcal{F}}_{\mathbf{r}\to\mathbf{k}}\Big{[}\psi_{0}(\mathbf{r})\Big{]}\right\}." display="block"><semantics id="S4.E4.m1.4a"><mrow id="S4.E4.m1.4.4.1" xref="S4.E4.m1.4.4.1.1.cmml"><mrow id="S4.E4.m1.4.4.1.1" xref="S4.E4.m1.4.4.1.1.cmml"><mrow id="S4.E4.m1.4.4.1.1.3" xref="S4.E4.m1.4.4.1.1.3.cmml"><mi id="S4.E4.m1.4.4.1.1.3.2" xref="S4.E4.m1.4.4.1.1.3.2.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.1.1.3.1" xref="S4.E4.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="S4.E4.m1.4.4.1.1.3.3.2" xref="S4.E4.m1.4.4.1.1.3.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.1.1.3.3.2.1" xref="S4.E4.m1.4.4.1.1.3.cmml">(</mo><mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">𝐫</mi><mo stretchy="false" id="S4.E4.m1.4.4.1.1.3.3.2.2" xref="S4.E4.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.4.4.1.1.2" xref="S4.E4.m1.4.4.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.4.4.1.1.1" xref="S4.E4.m1.4.4.1.1.1.cmml"><msubsup id="S4.E4.m1.4.4.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.3.cmml"><mover accent="true" id="S4.E4.m1.4.4.1.1.1.3.2.2" xref="S4.E4.m1.4.4.1.1.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.4.4.1.1.1.3.2.2.2" xref="S4.E4.m1.4.4.1.1.1.3.2.2.2.cmml">ℱ</mi><mo id="S4.E4.m1.4.4.1.1.1.3.2.2.1" xref="S4.E4.m1.4.4.1.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S4.E4.m1.4.4.1.1.1.3.3" xref="S4.E4.m1.4.4.1.1.1.3.3.cmml"><mi id="S4.E4.m1.4.4.1.1.1.3.3.2" xref="S4.E4.m1.4.4.1.1.1.3.3.2.cmml">𝐤</mi><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.3.3.1" xref="S4.E4.m1.4.4.1.1.1.3.3.1.cmml">→</mo><mi id="S4.E4.m1.4.4.1.1.1.3.3.3" xref="S4.E4.m1.4.4.1.1.1.3.3.3.cmml">𝐫</mi></mrow><mrow id="S4.E4.m1.4.4.1.1.1.3.2.3" xref="S4.E4.m1.4.4.1.1.1.3.2.3.cmml"><mo id="S4.E4.m1.4.4.1.1.1.3.2.3a" xref="S4.E4.m1.4.4.1.1.1.3.2.3.cmml">−</mo><mn id="S4.E4.m1.4.4.1.1.1.3.2.3.2" xref="S4.E4.m1.4.4.1.1.1.3.2.3.2.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.2.cmml"><mo id="S4.E4.m1.4.4.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.2.cmml">{</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml"><msup id="S4.E4.m1.4.4.1.1.1.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.4.4.1.1.1.1.1.1.3.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.3.2.cmml">e</mi><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.cmml"><mi id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.1.1.1.3.cmml">i</mi><mo lspace="0.060em" rspace="0em" id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.2.cmml">​</mo><mi id="S4.E4.m1.1.1.1.4" xref="S4.E4.m1.1.1.1.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.2a" xref="S4.E4.m1.1.1.1.2.cmml">​</mo><mi mathvariant="normal" id="S4.E4.m1.1.1.1.5" xref="S4.E4.m1.1.1.1.5.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.2b" xref="S4.E4.m1.1.1.1.2.cmml">​</mo><mi id="S4.E4.m1.1.1.1.6" xref="S4.E4.m1.1.1.1.6.cmml">z</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.2c" xref="S4.E4.m1.1.1.1.2.cmml">​</mo><msup id="S4.E4.m1.1.1.1.7" xref="S4.E4.m1.1.1.1.7.cmml"><mrow id="S4.E4.m1.1.1.1.7.2.2" xref="S4.E4.m1.1.1.1.7.2.1.cmml"><mo stretchy="false" id="S4.E4.m1.1.1.1.7.2.2.1" xref="S4.E4.m1.1.1.1.7.2.1.1.cmml">|</mo><mi id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml">𝐤</mi><mo stretchy="false" id="S4.E4.m1.1.1.1.7.2.2.2" xref="S4.E4.m1.1.1.1.7.2.1.1.cmml">|</mo></mrow><mn id="S4.E4.m1.1.1.1.7.3" xref="S4.E4.m1.1.1.1.7.3.cmml">2</mn></msup></mrow></msup><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.1.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.2.cmml">​</mo><msub id="S4.E4.m1.4.4.1.1.1.1.1.1.4" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.cmml"><mover accent="true" id="S4.E4.m1.4.4.1.1.1.1.1.1.4.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.4.4.1.1.1.1.1.1.4.2.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.2.2.cmml">ℱ</mi><mo id="S4.E4.m1.4.4.1.1.1.1.1.1.4.2.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.2.1.cmml">^</mo></mover><mrow id="S4.E4.m1.4.4.1.1.1.1.1.1.4.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.cmml"><mi id="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.2.cmml">𝐫</mi><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.1.cmml">→</mo><mi id="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.3.cmml">𝐤</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.1.1.1.1.1.1.2a" xref="S4.E4.m1.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo maxsize="160%" minsize="160%" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml">ψ</mi><mn id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E4.m1.3.3" xref="S4.E4.m1.3.3.cmml">𝐫</mi><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo maxsize="160%" minsize="160%" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S4.E4.m1.4.4.1.1.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E4.m1.4.4.1.2" xref="S4.E4.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.4b"><apply id="S4.E4.m1.4.4.1.1.cmml" xref="S4.E4.m1.4.4.1"><eq id="S4.E4.m1.4.4.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.2"></eq><apply id="S4.E4.m1.4.4.1.1.3.cmml" xref="S4.E4.m1.4.4.1.1.3"><times id="S4.E4.m1.4.4.1.1.3.1.cmml" xref="S4.E4.m1.4.4.1.1.3.1"></times><ci id="S4.E4.m1.4.4.1.1.3.2.cmml" xref="S4.E4.m1.4.4.1.1.3.2">𝜓</ci><ci id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2">𝐫</ci></apply><apply id="S4.E4.m1.4.4.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1"><times id="S4.E4.m1.4.4.1.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.1.2"></times><apply id="S4.E4.m1.4.4.1.1.1.3.cmml" xref="S4.E4.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.1.3.1.cmml" xref="S4.E4.m1.4.4.1.1.1.3">subscript</csymbol><apply id="S4.E4.m1.4.4.1.1.1.3.2.cmml" xref="S4.E4.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.1.3.2.1.cmml" xref="S4.E4.m1.4.4.1.1.1.3">superscript</csymbol><apply id="S4.E4.m1.4.4.1.1.1.3.2.2.cmml" xref="S4.E4.m1.4.4.1.1.1.3.2.2"><ci id="S4.E4.m1.4.4.1.1.1.3.2.2.1.cmml" xref="S4.E4.m1.4.4.1.1.1.3.2.2.1">^</ci><ci id="S4.E4.m1.4.4.1.1.1.3.2.2.2.cmml" xref="S4.E4.m1.4.4.1.1.1.3.2.2.2">ℱ</ci></apply><apply id="S4.E4.m1.4.4.1.1.1.3.2.3.cmml" xref="S4.E4.m1.4.4.1.1.1.3.2.3"><minus id="S4.E4.m1.4.4.1.1.1.3.2.3.1.cmml" xref="S4.E4.m1.4.4.1.1.1.3.2.3"></minus><cn type="integer" id="S4.E4.m1.4.4.1.1.1.3.2.3.2.cmml" xref="S4.E4.m1.4.4.1.1.1.3.2.3.2">1</cn></apply></apply><apply id="S4.E4.m1.4.4.1.1.1.3.3.cmml" xref="S4.E4.m1.4.4.1.1.1.3.3"><ci id="S4.E4.m1.4.4.1.1.1.3.3.1.cmml" xref="S4.E4.m1.4.4.1.1.1.3.3.1">→</ci><ci id="S4.E4.m1.4.4.1.1.1.3.3.2.cmml" xref="S4.E4.m1.4.4.1.1.1.3.3.2">𝐤</ci><ci id="S4.E4.m1.4.4.1.1.1.3.3.3.cmml" xref="S4.E4.m1.4.4.1.1.1.3.3.3">𝐫</ci></apply></apply><set id="S4.E4.m1.4.4.1.1.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1"><apply id="S4.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1"><times id="S4.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.2"></times><apply id="S4.E4.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E4.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.3.2">𝑒</ci><apply id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><times id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.2"></times><ci id="S4.E4.m1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.3">𝑖</ci><ci id="S4.E4.m1.1.1.1.4.cmml" xref="S4.E4.m1.1.1.1.4">𝜆</ci><ci id="S4.E4.m1.1.1.1.5.cmml" xref="S4.E4.m1.1.1.1.5">Δ</ci><ci id="S4.E4.m1.1.1.1.6.cmml" xref="S4.E4.m1.1.1.1.6">𝑧</ci><apply id="S4.E4.m1.1.1.1.7.cmml" xref="S4.E4.m1.1.1.1.7"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.7.1.cmml" xref="S4.E4.m1.1.1.1.7">superscript</csymbol><apply id="S4.E4.m1.1.1.1.7.2.1.cmml" xref="S4.E4.m1.1.1.1.7.2.2"><abs id="S4.E4.m1.1.1.1.7.2.1.1.cmml" xref="S4.E4.m1.1.1.1.7.2.2.1"></abs><ci id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1">𝐤</ci></apply><cn type="integer" id="S4.E4.m1.1.1.1.7.3.cmml" xref="S4.E4.m1.1.1.1.7.3">2</cn></apply></apply></apply><apply id="S4.E4.m1.4.4.1.1.1.1.1.1.4.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.1.1.1.1.4.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4">subscript</csymbol><apply id="S4.E4.m1.4.4.1.1.1.1.1.1.4.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.2"><ci id="S4.E4.m1.4.4.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.2.1">^</ci><ci id="S4.E4.m1.4.4.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.2.2">ℱ</ci></apply><apply id="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.3"><ci id="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.1">→</ci><ci id="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.2">𝐫</ci><ci id="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.3.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.4.3.3">𝐤</ci></apply></apply><apply id="S4.E4.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1"><times id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1"></times><apply id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.2">𝜓</ci><cn type="integer" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E4.m1.3.3.cmml" xref="S4.E4.m1.3.3">𝐫</ci></apply></apply></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.4c">\psi(\mathbf{r})=\hat{\mathcal{F}}^{-1}_{\mathbf{k}\to\mathbf{r}}\left\{e^{{i\mkern 1.0mu}\lambda\Delta z|\mathbf{k}|^{2}}\hat{\mathcal{F}}_{\mathbf{r}\to\mathbf{k}}\Big{[}\psi_{0}(\mathbf{r})\Big{]}\right\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p9" class="ltx_para ltx_noindent">
<p id="S4.SS2.p9.1" class="ltx_p">After the wavefunction has propagated through the entire sample, we obtain the exit wavefunction, which can be further modified to apply defocus and other residual optical aberrations typically seen in HRTEM imaging by applying another transmission operation</p>
</div>
<div id="S4.SS2.p10" class="ltx_para ltx_noindent">
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.3" class="ltx_math_unparsed" alttext="\Psi(\mathbf{k})=\Psi_{0}((\mathbf{k})\exp[-i\chi((\mathbf{k})]" display="block"><semantics id="S4.E5.m1.3a"><mrow id="S4.E5.m1.3b"><mi mathvariant="normal" id="S4.E5.m1.3.4">Ψ</mi><mrow id="S4.E5.m1.3.5"><mo stretchy="false" id="S4.E5.m1.3.5.1">(</mo><mi id="S4.E5.m1.1.1">𝐤</mi><mo stretchy="false" id="S4.E5.m1.3.5.2">)</mo></mrow><mo id="S4.E5.m1.3.6">=</mo><msub id="S4.E5.m1.3.7"><mi mathvariant="normal" id="S4.E5.m1.3.7.2">Ψ</mi><mn id="S4.E5.m1.3.7.3">0</mn></msub><mrow id="S4.E5.m1.3.8"><mo stretchy="false" id="S4.E5.m1.3.8.1">(</mo><mrow id="S4.E5.m1.3.8.2"><mo stretchy="false" id="S4.E5.m1.3.8.2.1">(</mo><mi id="S4.E5.m1.2.2">𝐤</mi><mo rspace="0.167em" stretchy="false" id="S4.E5.m1.3.8.2.2">)</mo></mrow><mi id="S4.E5.m1.3.8.3">exp</mi><mrow id="S4.E5.m1.3.8.4"><mo stretchy="false" id="S4.E5.m1.3.8.4.1">[</mo><mo lspace="0em" id="S4.E5.m1.3.8.4.2">−</mo><mi id="S4.E5.m1.3.8.4.3">i</mi><mi id="S4.E5.m1.3.8.4.4">χ</mi><mrow id="S4.E5.m1.3.8.4.5"><mo stretchy="false" id="S4.E5.m1.3.8.4.5.1">(</mo><mrow id="S4.E5.m1.3.8.4.5.2"><mo stretchy="false" id="S4.E5.m1.3.8.4.5.2.1">(</mo><mi id="S4.E5.m1.3.3">𝐤</mi><mo stretchy="false" id="S4.E5.m1.3.8.4.5.2.2">)</mo></mrow><mo stretchy="false" id="S4.E5.m1.3.8.4.5.3">]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.E5.m1.3c">\Psi(\mathbf{k})=\Psi_{0}((\mathbf{k})\exp[-i\chi((\mathbf{k})]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS2.p11" class="ltx_para ltx_noindent">
<p id="S4.SS2.p11.2" class="ltx_p">where <math id="S4.SS2.p11.1.m1.1" class="ltx_math_unparsed" alttext="\Psi_{0}((\mathbf{k})" display="inline"><semantics id="S4.SS2.p11.1.m1.1a"><mrow id="S4.SS2.p11.1.m1.1b"><msub id="S4.SS2.p11.1.m1.1.2"><mi mathvariant="normal" id="S4.SS2.p11.1.m1.1.2.2">Ψ</mi><mn id="S4.SS2.p11.1.m1.1.2.3">0</mn></msub><mrow id="S4.SS2.p11.1.m1.1.3"><mo stretchy="false" id="S4.SS2.p11.1.m1.1.3.1">(</mo><mrow id="S4.SS2.p11.1.m1.1.3.2"><mo stretchy="false" id="S4.SS2.p11.1.m1.1.3.2.1">(</mo><mi id="S4.SS2.p11.1.m1.1.1">𝐤</mi><mo stretchy="false" id="S4.SS2.p11.1.m1.1.3.2.2">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS2.p11.1.m1.1c">\Psi_{0}((\mathbf{k})</annotation></semantics></math> is the unaberrated wavefunction in Fourier space and <math id="S4.SS2.p11.2.m2.1" class="ltx_Math" alttext="\chi" display="inline"><semantics id="S4.SS2.p11.2.m2.1a"><mi id="S4.SS2.p11.2.m2.1.1" xref="S4.SS2.p11.2.m2.1.1.cmml">χ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p11.2.m2.1b"><ci id="S4.SS2.p11.2.m2.1.1.cmml" xref="S4.SS2.p11.2.m2.1.1">𝜒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p11.2.m2.1c">\chi</annotation></semantics></math> is the aberration function.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Database Generation with CZ and HRTEM simulation</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.1" class="ltx_p">We simulate a HRTEM data stream by first generating a large database of semi-realistic structures and then simulating micrographs for those structures under suitable imaging conditions. We greatly approximate the variety of nanoparticles imaged in <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib18" title="" class="ltx_ref">18</a>)</cite> as a series of spherical Au nanoparticles of varying diameters with a small number of planar defects, which are equally likely to be twin defects or stacking faults. Each nanoparticle is placed upon a unique amorphous carbon substrate and at a random location on the substrate surface at a random orientation. We then perform plane-wave multislice simulations of the structures at an acceleration voltage of 300kV, focused to the center of the atomic model, at a resolution of 0.02nm/pixel. We simulate output wavefunctions for both the full structure and just the nanoparticle in vacuum. To create ground truth segmentation masks, we threshold the phase of the output wavefunctions from the nanoparticles in vacuum, averaged over frozen phonons. Threshold values were determined heuristically. We found phase-thresholding to be much more stable and physically consistent across focal conditions than analogous intensity thresholding techniques.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.1" class="ltx_p">With the output wavefunctions, we then apply relevant focal conditions, residual aberration effects, focal spread, thermal effects, plasmonic losses, and electron dosage effects. Focal point, focal spread, and residual aberrations are applied to output wavefunctions using Eq. <a href="#S4.E5" title="In 4.2 TEM simulation ‣ 4 Detailed Methods ‣ A robust synthetic data generation framework for machine learning in High-Resolution Transmission Electron Microscopy (HRTEM)" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> with the appropriate aberration function; the effect of focal spread is approximated by incoherently averaging the wavefunction over a series of focal points distributed about the intended focal point. Thermal effects are included via the frozen-phonon approximation, where we incoherently average several exit wavefunctions to approximate the effect of thermal motion, corresponding to unique, perturbed copies of the original atomic structure. The atomic positions are perturbed by I.I.D. Gaussian noise, with amplitudes given by atomic Debye-Waller factors; for all simulations including thermal effects, we used eight frozen phonons. We approximate plasmonic losses in HRTEM imaging by applying a contrast reduction to the wavefunction intensities before averaging over frozen phonons. The contrast reduction is applied by taking a weighted pixelwise mean of the original intensity and an intensity with a constant added background (renormalized to have its original mean value). Noise from applied electron dosage is modeled by sampling count intensities from scaled Poisson distributions. We note that we do not include potential artifacts from the camera, i.e. via the modulation transfer function, though all experimental datasets have been acquired by scintillator-based detectors, for which including effects from the modulation transfer function in the noise sampling process could further improve performance <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>)</cite>.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Neural Network Training</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p">For our neural network development, we used a standard UNet architecture <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>)</cite> with a ResNet 18 <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib40" title="" class="ltx_ref">40</a>)</cite> encoder/decoder architecture and three pooling/upsampling stages, resulting in about 14 million trainable parameters. Models were trained using a mixed categorical cross-entropy and F1-score loss function on the segmentation masks. We performed a brief manual hyperparameter search to determine initial learning rates and learning rate schedules which were suitable enough for stable optimization under a wide variety of the simulated datasets. For most networks whose performance is reported in this study, we used the Adam optimization algorithm <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib41" title="" class="ltx_ref">41</a>)</cite> with initial learning rates of 0.01 and 0.001, and a constant learning rate decay of 0.8. Unless explicitly indicated otherwise, results in the primary text reflect those of networks trained with an initial learning rate of 0.001. Models were trained for a fixed number of epochs (25) with no early stopping; the network parameters that achieved the lowest validation loss were saved via checkpointing. Input data were first normalized, per image, to a range of 0 to 1, and then augmented with orthogonal rotations and random left-right/up-down flips. For experimental data, images were processed with a 3x3 median filter and then normalized to a range of 0 to 1, per image, before evaluating neural network test performance. Experimental image patches containing only substrate regions were removed from the training dataset prior to preprocessing. Per simulated training data condition tested, at least five different networks were trained with different random weight initializations and training data subsets (drawn uniformly at random after appropriate filtering). For each network, relevant metadata were saved alongside the training history and model parameters. All training was performed using Tensorflow version 2 <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib42" title="" class="ltx_ref">42</a>)</cite>, with the Segmentation Models package <cite class="ltx_cite ltx_citemacro_cite">(<a href="#bib.bib43" title="" class="ltx_ref">43</a>)</cite>. Neural networks were benchmarked for performance on 3-5 experimental datasets using the F1-score</p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<table id="S4.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex1.m1.1" class="ltx_Math" alttext="F_{1}=\frac{TP}{TP+0.5(FN+FP)}" display="block"><semantics id="S4.Ex1.m1.1a"><mrow id="S4.Ex1.m1.1.2" xref="S4.Ex1.m1.1.2.cmml"><msub id="S4.Ex1.m1.1.2.2" xref="S4.Ex1.m1.1.2.2.cmml"><mi id="S4.Ex1.m1.1.2.2.2" xref="S4.Ex1.m1.1.2.2.2.cmml">F</mi><mn id="S4.Ex1.m1.1.2.2.3" xref="S4.Ex1.m1.1.2.2.3.cmml">1</mn></msub><mo id="S4.Ex1.m1.1.2.1" xref="S4.Ex1.m1.1.2.1.cmml">=</mo><mfrac id="S4.Ex1.m1.1.1" xref="S4.Ex1.m1.1.1.cmml"><mrow id="S4.Ex1.m1.1.1.3" xref="S4.Ex1.m1.1.1.3.cmml"><mi id="S4.Ex1.m1.1.1.3.2" xref="S4.Ex1.m1.1.1.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.3.1" xref="S4.Ex1.m1.1.1.3.1.cmml">​</mo><mi id="S4.Ex1.m1.1.1.3.3" xref="S4.Ex1.m1.1.1.3.3.cmml">P</mi></mrow><mrow id="S4.Ex1.m1.1.1.1" xref="S4.Ex1.m1.1.1.1.cmml"><mrow id="S4.Ex1.m1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.3.cmml"><mi id="S4.Ex1.m1.1.1.1.3.2" xref="S4.Ex1.m1.1.1.1.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.3.1" xref="S4.Ex1.m1.1.1.1.3.1.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.3.3" xref="S4.Ex1.m1.1.1.1.3.3.cmml">P</mi></mrow><mo id="S4.Ex1.m1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.2.cmml">+</mo><mrow id="S4.Ex1.m1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.cmml"><mn id="S4.Ex1.m1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.3.cmml">0.5</mn><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.1.2.cmml">​</mo><mrow id="S4.Ex1.m1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1.m1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex1.m1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.Ex1.m1.1.1.1.1.1.1.1.2" xref="S4.Ex1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.2.2" xref="S4.Ex1.m1.1.1.1.1.1.1.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.1.1.2.1" xref="S4.Ex1.m1.1.1.1.1.1.1.1.2.1.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.2.3" xref="S4.Ex1.m1.1.1.1.1.1.1.1.2.3.cmml">N</mi></mrow><mo id="S4.Ex1.m1.1.1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.Ex1.m1.1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.3.2" xref="S4.Ex1.m1.1.1.1.1.1.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.Ex1.m1.1.1.1.1.1.1.1.3.1" xref="S4.Ex1.m1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.3.3" xref="S4.Ex1.m1.1.1.1.1.1.1.1.3.3.cmml">P</mi></mrow></mrow><mo stretchy="false" id="S4.Ex1.m1.1.1.1.1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.1b"><apply id="S4.Ex1.m1.1.2.cmml" xref="S4.Ex1.m1.1.2"><eq id="S4.Ex1.m1.1.2.1.cmml" xref="S4.Ex1.m1.1.2.1"></eq><apply id="S4.Ex1.m1.1.2.2.cmml" xref="S4.Ex1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.1.2.2.1.cmml" xref="S4.Ex1.m1.1.2.2">subscript</csymbol><ci id="S4.Ex1.m1.1.2.2.2.cmml" xref="S4.Ex1.m1.1.2.2.2">𝐹</ci><cn type="integer" id="S4.Ex1.m1.1.2.2.3.cmml" xref="S4.Ex1.m1.1.2.2.3">1</cn></apply><apply id="S4.Ex1.m1.1.1.cmml" xref="S4.Ex1.m1.1.1"><divide id="S4.Ex1.m1.1.1.2.cmml" xref="S4.Ex1.m1.1.1"></divide><apply id="S4.Ex1.m1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.3"><times id="S4.Ex1.m1.1.1.3.1.cmml" xref="S4.Ex1.m1.1.1.3.1"></times><ci id="S4.Ex1.m1.1.1.3.2.cmml" xref="S4.Ex1.m1.1.1.3.2">𝑇</ci><ci id="S4.Ex1.m1.1.1.3.3.cmml" xref="S4.Ex1.m1.1.1.3.3">𝑃</ci></apply><apply id="S4.Ex1.m1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1"><plus id="S4.Ex1.m1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.2"></plus><apply id="S4.Ex1.m1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.3"><times id="S4.Ex1.m1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.1.1.1.3.1"></times><ci id="S4.Ex1.m1.1.1.1.3.2.cmml" xref="S4.Ex1.m1.1.1.1.3.2">𝑇</ci><ci id="S4.Ex1.m1.1.1.1.3.3.cmml" xref="S4.Ex1.m1.1.1.1.3.3">𝑃</ci></apply><apply id="S4.Ex1.m1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1"><times id="S4.Ex1.m1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1.2"></times><cn type="float" id="S4.Ex1.m1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.1.3">0.5</cn><apply id="S4.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1"><plus id="S4.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1"></plus><apply id="S4.Ex1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.2"><times id="S4.Ex1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.2.1"></times><ci id="S4.Ex1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.2.2">𝐹</ci><ci id="S4.Ex1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.Ex1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.3"><times id="S4.Ex1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.3.1"></times><ci id="S4.Ex1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.3.2">𝐹</ci><ci id="S4.Ex1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.3.3">𝑃</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.1c">F_{1}=\frac{TP}{TP+0.5(FN+FP)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS4.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.p3.1" class="ltx_p">which is a ratio of true positives (identifying nanoparticle region correctly) to true positives, false positives (identifying substrate as nanoparticle) and false negatives (identifying nanoparticle as substrate). The F1 score measures 0 when all nanoparticle pixels are misclassified and 1 only when there are zero misclassified pixels.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:120%;">5   Data Availability</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">Code used to generate atomic structures, HRTEM simulations, and fully processed images, as well as code used to train neural networks models, will be made fully available upon publication. Given the large amount of training data generated for this study, a small selection will be made fully available upon publication; other selections of training data will be available upon request.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:120%;">6   Author Contributions</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">LRD performed the simulated data generation, machine learning, and data analysis and prepared the manuscript. KS and CKG acquired and labeled the experimental data, provided assistance with the machine learning, and helped prepare the manuscript; CKG also developed initial workflows for the machine learning. MCS led and supervised the study and helped prepare the manuscript.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:120%;">7   Acknowledgements</h2>

<div id="S7.p1" class="ltx_para ltx_noindent">
<p id="S7.p1.1" class="ltx_p">The authors thank Dr. Colin Ophus and Dr. Philipp Pelz for helpful discussions. This material is based upon work supported by the U.S. Department of Energy, Office of Science, Office of Advanced Scientific Computing Research, Department of Energy Computational Science Graduate Fellowship under Award Number DE-SC0021110. K.S. was supported by an appointment to the Intelligence Community Postdoctoral Research Fellowship Program at Lawrence Berkeley National Laboratory administered by Oak Ridge Institute for Science and Education (ORISE) through an interagency agreement between the U.S. Department of Energy and the Office of the Director of National Intelligence (ODNI). Work at the Molecular Foundry was supported by the Office of Science, Office of Basic Energy Sciences, of the U.S. Department of Energy under Contract No. DE-AC02-05CH11231.</p>
</div>
<div id="S7.p2" class="ltx_para ltx_noindent">
<p id="S7.p2.1" class="ltx_p">This report was prepared as an account of work sponsored by an agency of the United States Government. Neither the United States Government nor any agency thereof, nor any of their employees, makes any warranty, express or implied, or assumes any legal liability or responsibility for the accuracy, completeness, or usefulness of any information, apparatus, product, or process disclosed, or represents that its use would not infringe privately owned rights. Reference herein to any specific commercial product, process, or service by trade name, trademark, manufacturer, or otherwise does not necessarily constitute or imply its endorsement, recommendation, or favoring by the United States Government or any agency thereof. The views and opinions of authors expressed herein do not necessarily state or reflect those of the United States Government or any agency thereof.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_font_bold ltx_title_section" style="font-size:120%;">8   References</h2>

</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
Xu, K. <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">How Neural Networks Extrapolate: From
Feedforward to Graph Neural Networks (2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2009.11848" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2009.11848</a>.

</span>
<span class="ltx_bibblock">ArXiv:2009.11848 [cs, stat].

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(2)</span>
<span class="ltx_bibblock">
Nagarajan, V., Andreassen, A. &amp;
Neyshabur, B.

</span>
<span class="ltx_bibblock">Understanding the Failure Modes of
Out-of-Distribution Generalization (2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2010.15775" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2010.15775</a>.

</span>
<span class="ltx_bibblock">ArXiv:2010.15775 [cs, stat].

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(3)</span>
<span class="ltx_bibblock">
Krueger, D. <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">Out-of-Distribution Generalization via Risk
Extrapolation (REx).

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.2.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th International
Conference on Machine Learning</em>, 5815–5826
(PMLR, 2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://proceedings.mlr.press/v139/krueger21a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlr.press/v139/krueger21a.html</a>.

</span>
<span class="ltx_bibblock">ISSN: 2640-3498.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(4)</span>
<span class="ltx_bibblock">
Rangel DaCosta, L. <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">Prismatic 2.0 – Simulation software for scanning
and high resolution transmission electron microscopy (STEM and HRTEM).

</span>
<span class="ltx_bibblock"><em id="bib.bib4.2.1" class="ltx_emph ltx_font_italic">Micron</em> <span id="bib.bib4.3.2" class="ltx_text ltx_font_bold">151</span>,
103141 (2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S0968432821001323" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S0968432821001323</a>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(5)</span>
<span class="ltx_bibblock">
Pryor, A., Ophus, C. &amp;
Miao, J.

</span>
<span class="ltx_bibblock">A streaming multi-gpu implementation of image
simulation algorithms for scanning transmission electron microscopy.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advanced structural and chemical imaging</em>
<span id="bib.bib5.2.2" class="ltx_text ltx_font_bold">3</span>, 15 (2017).

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(6)</span>
<span class="ltx_bibblock">
Ophus, C.

</span>
<span class="ltx_bibblock">A fast image simulation algorithm for scanning
transmission electron microscopy.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advanced Structural and Chemical Imaging</em>
<span id="bib.bib6.2.2" class="ltx_text ltx_font_bold">3</span>, 13 (2017).

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(7)</span>
<span class="ltx_bibblock">
Madsen, J. &amp; Susi, T.

</span>
<span class="ltx_bibblock">The abtem code: transmission electron microscopy from
first principles.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Open Research Europe</em>
<span id="bib.bib7.2.2" class="ltx_text ltx_font_bold">1</span>, 13015 (2021).

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(8)</span>
<span class="ltx_bibblock">
Lobato, I. &amp; Van Dyck, D.

</span>
<span class="ltx_bibblock">Multem: A new multislice program to perform accurate
and fast electron diffraction and imaging simulations using graphics
processing units with cuda.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Ultramicroscopy</em>
<span id="bib.bib8.2.2" class="ltx_text ltx_font_bold">156</span>, 9–17
(2015).

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(9)</span>
<span class="ltx_bibblock">
Munshi, J. <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">Disentangling multiple scattering with deep learning:
application to strain mapping from electron diffraction patterns.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.2.1" class="ltx_emph ltx_font_italic">npj Computational Materials</em>
<span id="bib.bib9.3.2" class="ltx_text ltx_font_bold">8</span>, 1–15 (2022).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.nature.com/articles/s41524-022-00939-9" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.nature.com/articles/s41524-022-00939-9</a>.

</span>
<span class="ltx_bibblock">Number: 1 Publisher: Nature Publishing Group.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(10)</span>
<span class="ltx_bibblock">
Zhang, C., Feng, J.,
DaCosta, L. R. &amp; Voyles, P. M.

</span>
<span class="ltx_bibblock">Atomic resolution convergent beam electron
diffraction analysis using convolutional neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Ultramicroscopy</em>
<span id="bib.bib10.2.2" class="ltx_text ltx_font_bold">210</span>, 112921
(2020).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S0304399119303511" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S0304399119303511</a>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(11)</span>
<span class="ltx_bibblock">
Madsen, J. <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">A Deep Learning Approach to Identify Local
Structures in Atomic-Resolution Transmission Electron Microscopy
Images.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.2.1" class="ltx_emph ltx_font_italic">Advanced Theory and Simulations</em>
<span id="bib.bib11.3.2" class="ltx_text ltx_font_bold">1</span>, 1800037
(2018).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/adts.201800037" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://onlinelibrary.wiley.com/doi/abs/10.1002/adts.201800037</a>.

</span>
<span class="ltx_bibblock">_eprint:
https://onlinelibrary.wiley.com/doi/pdf/10.1002/adts.201800037.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(12)</span>
<span class="ltx_bibblock">
Vincent, J. L. <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">Developing and Evaluating Deep Neural
Network-Based Denoising for Nanoparticle TEM Images with
Ultra-Low Signal-to-Noise.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.2.1" class="ltx_emph ltx_font_italic">Microscopy and Microanalysis</em>
<span id="bib.bib12.3.2" class="ltx_text ltx_font_bold">27</span>, 1431–1447
(2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1017/S1431927621012678" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1017/S1431927621012678</a>.

</span>
<span class="ltx_bibblock">Publisher: Cambridge University Press.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(13)</span>
<span class="ltx_bibblock">
Ong, S. P. <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">Python Materials Genomics (pymatgen): A robust,
open-source python library for materials analysis.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.2.1" class="ltx_emph ltx_font_italic">Computational Materials Science</em>
<span id="bib.bib13.3.2" class="ltx_text ltx_font_bold">68</span>, 314–319
(2013).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S0927025612006295" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S0927025612006295</a>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(14)</span>
<span class="ltx_bibblock">
Larsen, A. H. <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">The atomic simulation environment—a Python
library for working with atoms.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.2.1" class="ltx_emph ltx_font_italic">Journal of Physics: Condensed Matter</em>
<span id="bib.bib14.3.2" class="ltx_text ltx_font_bold">29</span>, 273002
(2017).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1088/1361-648x/aa680e" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1088/1361-648x/aa680e</a>.

</span>
<span class="ltx_bibblock">Publisher: IOP Publishing.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(15)</span>
<span class="ltx_bibblock">
Rahm, J. M. &amp; Erhart, P.

</span>
<span class="ltx_bibblock">WulffPack: A Python package for Wulff
constructions.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Journal of Open Source Software</em>
<span id="bib.bib15.2.2" class="ltx_text ltx_font_bold">5</span>, 1944 (2020).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://joss.theoj.org/papers/10.21105/joss.01944" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://joss.theoj.org/papers/10.21105/joss.01944</a>.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(16)</span>
<span class="ltx_bibblock">
Oh, M. H. <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">Design and synthesis of multigrain nanocrystals via
geometric misfit strain.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.2.1" class="ltx_emph ltx_font_italic">Nature</em> <span id="bib.bib16.3.2" class="ltx_text ltx_font_bold">577</span>,
359–363 (2020).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1038/s41586-019-1899-3" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1038/s41586-019-1899-3</a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(17)</span>
<span class="ltx_bibblock">
Reidy, K. <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">Direct imaging and electronic structure modulation of
moiré superlattices at the 2D/3D interface.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.2.1" class="ltx_emph ltx_font_italic">Nature Communications</em>
<span id="bib.bib17.3.2" class="ltx_text ltx_font_bold">12</span>, 1290 (2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://www.nature.com/articles/s41467-021-21363-5" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://www.nature.com/articles/s41467-021-21363-5</a>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(18)</span>
<span class="ltx_bibblock">
Groschner, C. K., Choi, C. &amp;
Scott, M. C.

</span>
<span class="ltx_bibblock">Machine Learning Pipeline for Segmentation and
Defect Identification from High-Resolution Transmission Electron
Microscopy Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Microscopy and Microanalysis</em>
<span id="bib.bib18.2.2" class="ltx_text ltx_font_bold">27</span>, 549–556
(2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.cambridge.org/core/product/identifier/S1431927621000386/type/journal_article" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.cambridge.org/core/product/identifier/S1431927621000386/type/journal_article</a>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(19)</span>
<span class="ltx_bibblock">
Wang, X. <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">AutoDetect-mNP: An Unsupervised Machine
Learning Algorithm for Automated Analysis of Transmission
Electron Microscope Images of Metal Nanoparticles.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.2.1" class="ltx_emph ltx_font_italic">JACS Au</em> <span id="bib.bib19.3.2" class="ltx_text ltx_font_bold">1</span>,
316–327 (2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1021/jacsau.0c00030" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1021/jacsau.0c00030</a>.

</span>
<span class="ltx_bibblock">Publisher: American Chemical Society.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(20)</span>
<span class="ltx_bibblock">
Cowley, J. M. &amp; Moodie, A. F.

</span>
<span class="ltx_bibblock">The scattering of electrons by atoms and crystals. i.
a new theoretical approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Acta Crystallographica</em>
<span id="bib.bib20.2.2" class="ltx_text ltx_font_bold">10</span>, 609–619
(1957).

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(21)</span>
<span class="ltx_bibblock">
Ronneberger, O., Fischer, P. &amp;
Brox, T.

</span>
<span class="ltx_bibblock">U-Net: Convolutional Networks for Biomedical
Image Segmentation (2015).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1505.04597" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1505.04597</a>.

</span>
<span class="ltx_bibblock">ArXiv:1505.04597 [cs].

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(22)</span>
<span class="ltx_bibblock">
Sytwu, K., Groschner, C. &amp;
Scott, M. C.

</span>
<span class="ltx_bibblock">Understanding the Influence of Receptive Field
and Network Complexity in Neural Network-Guided TEM Image
Analysis.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Microscopy and Microanalysis</em>
1–9 (2022).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1017/S1431927622012466" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1017/S1431927622012466</a>.

</span>
<span class="ltx_bibblock">Publisher: Cambridge University Press.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(23)</span>
<span class="ltx_bibblock">
Groschner, C., Choi, C. &amp;
Scott, M. C.

</span>
<span class="ltx_bibblock">High Throughput Pipeline for Segmentation and
Defect Identification (2020).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://zenodo.cern.ch/record/3755011" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://zenodo.cern.ch/record/3755011</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(24)</span>
<span class="ltx_bibblock">
Sytwu, K., Groschner, C. &amp;
Scott, M. C.

</span>
<span class="ltx_bibblock">Understanding the Influence of Receptive Field
and Network Complexity in Neural-Network-Guided TEM Image
Analysis (2022).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://zenodo.org/record/6419024" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://zenodo.org/record/6419024</a>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(25)</span>
<span class="ltx_bibblock">
Power, A., Burda, Y.,
Edwards, H., Babuschkin, I. &amp;
Misra, V.

</span>
<span class="ltx_bibblock">Grokking: Generalization Beyond Overfitting on
Small Algorithmic Datasets.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv:2201.02177 [cs]</em>
(2022).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/2201.02177" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/2201.02177</a>.

</span>
<span class="ltx_bibblock">ArXiv: 2201.02177.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(26)</span>
<span class="ltx_bibblock">
Leth Larsen, M. H., Lomholdt, W. B.,
Nuñez Valencia, C., Hansen, T. W. &amp;
Schiøtz, J.

</span>
<span class="ltx_bibblock">Quantifying noise limitations of neural network
segmentations in high-resolution transmission electron microscopy.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Ultramicroscopy</em>
<span id="bib.bib26.2.2" class="ltx_text ltx_font_bold">253</span>, 113803
(2023).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S0304399123001201" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S0304399123001201</a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(27)</span>
<span class="ltx_bibblock">
Khan, A., Lee, C.-H.,
Huang, P. Y. &amp; Clark, B. K.

</span>
<span class="ltx_bibblock">Leveraging generative adversarial networks to create
realistic scanning transmission electron microscopy images.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">npj Computational Materials</em>
<span id="bib.bib27.2.2" class="ltx_text ltx_font_bold">9</span>, 1–9 (2023).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.nature.com/articles/s41524-023-01042-3" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.nature.com/articles/s41524-023-01042-3</a>.

</span>
<span class="ltx_bibblock">Number: 1 Publisher: Nature Publishing Group.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(28)</span>
<span class="ltx_bibblock">
Ang, S. J., Wang, W.,
Schwalbe-Koda, D., Axelrod, S. &amp;
Gómez-Bombarelli, R.

</span>
<span class="ltx_bibblock">Active learning accelerates ab initio molecular
dynamics on reactive energy surfaces.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Chem</em> <span id="bib.bib28.2.2" class="ltx_text ltx_font_bold">7</span>,
738–751 (2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S2451929420306410" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S2451929420306410</a>.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(29)</span>
<span class="ltx_bibblock">
Vandermause, J. <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">On-the-fly active learning of interpretable
Bayesian force fields for atomistic rare events.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.2.1" class="ltx_emph ltx_font_italic">npj Computational Materials</em>
<span id="bib.bib29.3.2" class="ltx_text ltx_font_bold">6</span>, 1–11 (2020).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.nature.com/articles/s41524-020-0283-z" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.nature.com/articles/s41524-020-0283-z</a>.

</span>
<span class="ltx_bibblock">Number: 1 Publisher: Nature Publishing Group.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(30)</span>
<span class="ltx_bibblock">
Xie, T. &amp; Grossman, J. C.

</span>
<span class="ltx_bibblock">Crystal Graph Convolutional Neural Networks
for an Accurate and Interpretable Prediction of Material
Properties.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Physical Review Letters</em>
<span id="bib.bib30.2.2" class="ltx_text ltx_font_bold">120</span>, 145301
(2018).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://link.aps.org/doi/10.1103/PhysRevLett.120.145301" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://link.aps.org/doi/10.1103/PhysRevLett.120.145301</a>.

</span>
<span class="ltx_bibblock">Publisher: American Physical Society.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(31)</span>
<span class="ltx_bibblock">
Musaelian, A. <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">Learning local equivariant representations for
large-scale atomistic dynamics.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.2.1" class="ltx_emph ltx_font_italic">Nature Communications</em>
<span id="bib.bib31.3.2" class="ltx_text ltx_font_bold">14</span>, 579 (2023).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.nature.com/articles/s41467-023-36329-y" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.nature.com/articles/s41467-023-36329-y</a>.

</span>
<span class="ltx_bibblock">Number: 1 Publisher: Nature Publishing Group.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(32)</span>
<span class="ltx_bibblock">
Kervadec, H. <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">Boundary loss for highly unbalanced segmentation.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.2.1" class="ltx_emph ltx_font_italic">Medical Image Analysis</em>
<span id="bib.bib32.3.2" class="ltx_text ltx_font_bold">67</span>, 101851
(2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.sciencedirect.com/science/article/pii/S1361841520302152" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.sciencedirect.com/science/article/pii/S1361841520302152</a>.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(33)</span>
<span class="ltx_bibblock">
Kirkpatrick, J. <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">Pushing the frontiers of density functionals by
solving the fractional electron problem.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.2.1" class="ltx_emph ltx_font_italic">Science</em> <span id="bib.bib33.3.2" class="ltx_text ltx_font_bold">374</span>,
1385–1389 (2021).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://www.science.org/doi/10.1126/science.abj6511" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.science.org/doi/10.1126/science.abj6511</a>.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(34)</span>
<span class="ltx_bibblock">
Stukowski, A.

</span>
<span class="ltx_bibblock">Computational Analysis Methods in Atomistic
Modeling of Crystals.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">JOM</em> <span id="bib.bib34.2.2" class="ltx_text ltx_font_bold">66</span>,
399–407 (2014).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://link.springer.com/10.1007/s11837-013-0827-5" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://link.springer.com/10.1007/s11837-013-0827-5</a>.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(35)</span>
<span class="ltx_bibblock">
Edelsbrunner, H. &amp; Mücke, E. P.

</span>
<span class="ltx_bibblock">Three-dimensional alpha shapes.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Graphics</em>
<span id="bib.bib35.2.2" class="ltx_text ltx_font_bold">13</span>, 43–72
(1994).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1145/174462.156635" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1145/174462.156635</a>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(36)</span>
<span class="ltx_bibblock">
Van Dyck, D.

</span>
<span class="ltx_bibblock">Advances in electronics and electron physics.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">New York: Academic</em> 295
(1985).

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(37)</span>
<span class="ltx_bibblock">
Kirkland, E. J.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Advanced Computing in Electron
Microscopy</em> (Springer US, Boston,
MA, 2010).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://link.springer.com/10.1007/978-1-4419-6533-2" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://link.springer.com/10.1007/978-1-4419-6533-2</a>.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(38)</span>
<span class="ltx_bibblock">
Lobato, I. &amp; Van Dyck, D.

</span>
<span class="ltx_bibblock">An accurate parameterization for scattering factors,
electron densities and electrostatic potentials for neutral atoms that obey
all physical constraints.

</span>
<span class="ltx_bibblock"><em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Acta Crystallographica Section A</em>
<span id="bib.bib38.2.2" class="ltx_text ltx_font_bold">70</span>, 636–649
(2014).

</span>
<span class="ltx_bibblock">URL <a href="//scripts.iucr.org/cgi-bin/paper?mq5024" title="" class="ltx_ref ltx_url ltx_font_typewriter">//scripts.iucr.org/cgi-bin/paper?mq5024</a>.

</span>
<span class="ltx_bibblock">_eprint:
https://onlinelibrary.wiley.com/doi/pdf/10.1107/S205327331401643X.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(39)</span>
<span class="ltx_bibblock">
Zhou, Z., Siddiquee, M. M. R.,
Tajbakhsh, N. &amp; Liang, J.

</span>
<span class="ltx_bibblock">UNet++: Redesigning Skip Connections to
Exploit Multiscale Features in Image Segmentation.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">arXiv:1912.05074 [cs, eess]</em>
(2020).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1912.05074" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1912.05074</a>.

</span>
<span class="ltx_bibblock">ArXiv: 1912.05074.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(40)</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren,
S. &amp; Sun, J.

</span>
<span class="ltx_bibblock">Deep Residual Learning for Image
Recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">2016 IEEE Conference on Computer
Vision and Pattern Recognition (CVPR)</em>, 770–778
(2016).

</span>
<span class="ltx_bibblock">ISSN: 1063-6919.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(41)</span>
<span class="ltx_bibblock">
Kingma, D. P. &amp; Ba, J.

</span>
<span class="ltx_bibblock">Adam: A Method for Stochastic Optimization
(2017).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1412.6980" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1412.6980</a>.

</span>
<span class="ltx_bibblock">ArXiv:1412.6980 [cs].

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(42)</span>
<span class="ltx_bibblock">
Abadi, M. <em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">et al.</em>

</span>
<span class="ltx_bibblock">TensorFlow: A system for large-scale machine
learning (2016).

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1605.08695" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1605.08695</a>.

</span>
<span class="ltx_bibblock">ArXiv:1605.08695 [cs].

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(43)</span>
<span class="ltx_bibblock">
Iakubovskii, P.

</span>
<span class="ltx_bibblock">Segmentation models.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/qubvel/segmentation_models" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/qubvel/segmentation_models</a>
(2019).

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2309.06121" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2309.06122" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2309.06122">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2309.06122" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2309.06123" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Mon Feb 26 22:13:52 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
