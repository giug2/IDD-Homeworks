<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2011.06283] Fed-Focal Loss for imbalanced data classification in Federated Learning</title><meta property="og:description" content="The Federated Learning setting has a central server coordinating the training of a model on a network of devices. One of the challenges is variable training performance when the dataset has a class imbalance. In this p…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fed-Focal Loss for imbalanced data classification in Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Fed-Focal Loss for imbalanced data classification in Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2011.06283">

<!--Generated on Tue Mar 19 05:03:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Fed-Focal Loss for imbalanced data classification in Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Dipankar Sarkar<sup id="id6.2.id1" class="ltx_sup">1</sup>
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ankur Narang<sup id="id7.5.id1" class="ltx_sup">1</sup>&amp;Sumit Rai<sup id="id8.6.id2" class="ltx_sup">2</sup>
<br class="ltx_break"><sup id="id9.7.id3" class="ltx_sup">1</sup>Hike Ltd.
<br class="ltx_break"><sup id="id10.8.id4" class="ltx_sup">2</sup>IITM, Gwalior
<br class="ltx_break">dipankars@hike.in,
ankur@hike.in,
sumitrairkt@gmail.com
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id11.id1" class="ltx_p">The Federated Learning setting has a central server coordinating the training of a model on a network of devices. One of the challenges is variable training performance when the dataset has a class imbalance. In this paper, we address this by introducing a new loss function called Fed-Focal Loss. We propose to address the class imbalance by reshaping cross-entropy loss such that it down-weights the loss assigned to well-classified examples along the lines of focal loss. Additionally, by leveraging a tunable sampling framework, we take into account selective client model contributions on the central server to further focus the detector during training and hence improve its robustness. Using a detailed experimental analysis with the VIRTUAL (Variational Federated Multi-Task Learning) approach, we demonstrate consistently superior performance in both the balanced and unbalanced scenarios for MNIST, FEMNIST, VSN and HAR benchmarks. We obtain a more than 9% (absolute percentage) improvement in the unbalanced MNIST benchmark. We further show that our technique can be adopted across multiple Federated Learning algorithms to get improvements.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">We live in a decentralized era with large scale networks of remote devices [Lueth, 2018]. Combined with the rise of Deep Learning [Lecun <span id="S1.p1.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2015], these endpoints have become a significant source of data for exciting research and applications.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In the traditional cloud model, the data is collected in centralized servers. We can then provide insights or produce inference models with the data collected. However, we see challenges of securing data centrally and the emergence of data privacy legislation like GDPR [Clusters <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2019] and the Consumer Privacy Bill of Rights [Graff <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">et al.</span>, 2014].</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">These remote devices like mobiles and IoTs have limitations of computation and storage. That limits how complex or large the models can be. Also, we usually have a wireless network which connects them with the central server, making real-time decision systems (self-driving cars) not feasible due to propagation delays and unacceptable latency [Mao <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2017.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Collaborative paradigm [Chen <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2015] have been proposed for model training where data is sent to the edge servers to train lower DNN layers, while the server computes the resource-intensive parts. However, this approach has high communication costs, and continuous training is not feasible. Due to the data transfer from the client, there is a security concern as well. We see the usage of Differential Privacy [Abadi <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">et al.</span>, 2016] in some cases, but its adoption has challenges.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Federated learning [McMahan <span id="S1.p5.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2016] has become the leading paradigm to address how we can train models on private distributed data sources. A federation of devices called clients both collect data and carry out a local optimization routine. A server then coordinates the model training by receiving and sending updates to and from the clients. We have already seen its application in real-world use cases like mobile keyboard prediction [Hard <span id="S1.p5.1.2" class="ltx_text ltx_font_italic">et al.</span>, 2018].</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The Federated Averaging algorithm (<span id="S1.p6.1.1" class="ltx_text ltx_font_italic">FedAvg</span>) [McMahan <span id="S1.p6.1.2" class="ltx_text ltx_font_italic">et al.</span>, 2016] and VIRTUAL (variational federated multi-task learning) [Corinzia and Buhmann, 2019] are state of the art in federated learning with non-convex models. While FedAvg performs well in a range of real-world datasets, it has not done well with strongly skewed data distributions [McMahan <span id="S1.p6.1.3" class="ltx_text ltx_font_italic">et al.</span>, 2017]. VIRTUAL overcomes this issue, with the server and client forming a Bayesian network, while inference happens using variational methods.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">However, these frameworks do not tackle the global class imbalance problem as we will show in our experiments. We have seen the Astrea framework [Duan, 2019] proposed, where a rebalancing step has the clients augment their dataset in cases of imbalances. That has led to accuracy improvements. We are providing an alternative approach, where the client will not have to spend more computation to correct imbalances.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">We have identified focal loss [Lin <span id="S1.p8.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2018], which tackles the fore-background imbalance in image-based object detection as a starting point. In the aforementioned paper, one-stage detectors have achieved the same accuracy as two-stage detectors. The idea is to help the network focus on hard classified objects in case they are easily overwhelmed by a large number of easily classified objects.</p>
</div>
<div id="S1.p9" class="ltx_para">
<p id="S1.p9.1" class="ltx_p">In this paper, we establish the following contributions</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We introduce a new loss function called Fed-Focal Loss. By using a tunable sampling framework, our approach robustly handles unbalanced and non-IID data distribution simultaneously.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Detailed experimental analysis on MNIST, FEMNIST, VSN and HAR datasets with the VIRTUAL approach, demonstrates consistent superior performance of our framework for both balanced and unbalanced scenarios. Our technique leads to 9% (absolute percentage) gain in accuracy vs prior results for the MNIST classification problem in the unbalanced scenario.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Using ablation study, we demonstrate the robustness of our technique in various conditions. Further, instability during training with the default cross-entropy loss gets smoothened out using our technique.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">With the proliferation of networks and increased computing power, we have seen the emergence of distributed learning where model s optimization happens in a parallel computing environment given a dataset[McDonald <span id="S2.SS1.p1.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2010]. In recent years, Federated Learning [McMahan <span id="S2.SS1.p1.1.2" class="ltx_text ltx_font_italic">et al.</span>, 2016] has introduced a new class of algorithms that can be deployed on mobile networks. In the same work, FedAvg was introduced, which has been a popular heuristic, where at each step, a sample of the clients are selected and then updated locally using SGD. An average is subsequently obtained, which is transmitted back to the clients. As stated, this approach does not do well with skewed non-IID data [Zhao <span id="S2.SS1.p1.1.3" class="ltx_text ltx_font_italic">et al.</span>, 2018].</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">There has been work done in embedding FL using the MTL framework using MOCHA [Smith <span id="S2.SS1.p2.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2017], which builds on a few other early works. Further improvements were made by VIRTUAL [Corinzia and Buhmann, 2019], which tackles the skewed data challenges using an MTL approach.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Class Imbalance</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">In one-stage object detection methods like boosted detectors and SSD[Liu <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2016], there is a large class imbalance during training. Very few image locations contain objects. It leads to inadequate training, and easy negatives can lead to bad models. The most common solution is hard negative mining, which at times involves complex sampling schemes [Bulo <span id="S2.SS2.p1.1.2" class="ltx_text ltx_font_italic">et al.</span>, 2017]. However, Focal Loss [Lin <span id="S2.SS2.p1.1.3" class="ltx_text ltx_font_italic">et al.</span>, 2018] naturally handles this without sampling and the easy negatives overwhelming the loss and computed gradients.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">We also have robust loss functions (e.g. Huber Loss [Hastie <span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2008]) which reduce the contribution of outliers by down-weighting the loss of examples with large errors (hard examples). This is in contrast to Focal loss that focuses the training on a sparse set of hard examples, by down-weighing easy examples.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">In FL, we have the Astrea [Duan, 2019] framework that rebalances the clients by getting them to augment their data set. After retraining with the augmented data, a mediator is created to coordinated intermediate aggregation. It selects the participants with the best data distributions, which can make useful contributions using the KL Divergence [Joyce, 2011] between the local and uniform distribution.</p>
</div>
<figure id="S2.T1" class="ltx_table">
<table id="S2.T1.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S2.T1.2.1.1" class="ltx_tr">
<th id="S2.T1.2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S2.T1.2.1.1.1.1" class="ltx_text ltx_font_bold">Dataset</span></th>
<th id="S2.T1.2.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S2.T1.2.1.1.2.1" class="ltx_text ltx_font_bold">Number of Clients</span></th>
<th id="S2.T1.2.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S2.T1.2.1.1.3.1" class="ltx_text ltx_font_bold">Number of classes</span></th>
<th id="S2.T1.2.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S2.T1.2.1.1.4.1" class="ltx_text ltx_font_bold">Total Samples</span></th>
<th id="S2.T1.2.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S2.T1.2.1.1.5.1" class="ltx_text ltx_font_bold">Mean</span></th>
<th id="S2.T1.2.1.1.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S2.T1.2.1.1.6.1" class="ltx_text ltx_font_bold">Std</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S2.T1.2.2.1" class="ltx_tr">
<th id="S2.T1.2.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">MNIST</th>
<td id="S2.T1.2.2.1.2" class="ltx_td ltx_align_left ltx_border_t">10</td>
<td id="S2.T1.2.2.1.3" class="ltx_td ltx_align_left ltx_border_t">10</td>
<td id="S2.T1.2.2.1.4" class="ltx_td ltx_align_left ltx_border_t">60000</td>
<td id="S2.T1.2.2.1.5" class="ltx_td ltx_align_left ltx_border_t">6000</td>
<td id="S2.T1.2.2.1.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0</td>
</tr>
<tr id="S2.T1.2.3.2" class="ltx_tr">
<th id="S2.T1.2.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Sampled-FEMNIST</th>
<td id="S2.T1.2.3.2.2" class="ltx_td ltx_align_left">10</td>
<td id="S2.T1.2.3.2.3" class="ltx_td ltx_align_left">10</td>
<td id="S2.T1.2.3.2.4" class="ltx_td ltx_align_left">10000</td>
<td id="S2.T1.2.3.2.5" class="ltx_td ltx_align_left">600</td>
<td id="S2.T1.2.3.2.6" class="ltx_td ltx_nopad_r ltx_align_left">0</td>
</tr>
<tr id="S2.T1.2.4.3" class="ltx_tr">
<th id="S2.T1.2.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">VSN</th>
<td id="S2.T1.2.4.3.2" class="ltx_td ltx_align_left">23</td>
<td id="S2.T1.2.4.3.3" class="ltx_td ltx_align_left">2</td>
<td id="S2.T1.2.4.3.4" class="ltx_td ltx_align_left">68532</td>
<td id="S2.T1.2.4.3.5" class="ltx_td ltx_align_left">3115</td>
<td id="S2.T1.2.4.3.6" class="ltx_td ltx_nopad_r ltx_align_left">559</td>
</tr>
<tr id="S2.T1.2.5.4" class="ltx_tr">
<th id="S2.T1.2.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">HAR</th>
<td id="S2.T1.2.5.4.2" class="ltx_td ltx_align_left ltx_border_bb">30</td>
<td id="S2.T1.2.5.4.3" class="ltx_td ltx_align_left ltx_border_bb">6</td>
<td id="S2.T1.2.5.4.4" class="ltx_td ltx_align_left ltx_border_bb">15762</td>
<td id="S2.T1.2.5.4.5" class="ltx_td ltx_align_left ltx_border_bb">543</td>
<td id="S2.T1.2.5.4.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb">56</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S2.T1.3.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S2.T1.4.2" class="ltx_text" style="font-size:90%;">The datasets used in the experiments</span></figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Fed-Focal Loss</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The Fed-Focal Loss is designed to address an extreme imbalanced in classes during training. We introduce a crucial modification to the Focal Loss function based on the clients training performance.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Focal Loss</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.2" class="ltx_p">In this section, we will describe Focal Loss. Our experiments will show that large class imbalance will overwhelm the cross-entropy Loss. Here, we are reshaping the loss function to down weight easy examples and focus training on hard examples.
We define y <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mo id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><in id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\in</annotation></semantics></math> ±1 as the ground-truth class and p as the estimated probability for the class with y=1. We define the posterior probability <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="p_{t}" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">p</mi><mi id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑝</ci><ci id="S3.SS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">p_{t}</annotation></semantics></math> as</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="p=\begin{cases}1,&amp;\text{if }y=1\\
1-p,&amp;\text{if }y=-1\end{cases}" display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.5" xref="S3.E1.m1.4.5.cmml"><mi id="S3.E1.m1.4.5.2" xref="S3.E1.m1.4.5.2.cmml">p</mi><mo id="S3.E1.m1.4.5.1" xref="S3.E1.m1.4.5.1.cmml">=</mo><mrow id="S3.E1.m1.4.4" xref="S3.E1.m1.4.5.3.1.cmml"><mo id="S3.E1.m1.4.4.5" xref="S3.E1.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E1.m1.4.4.4" xref="S3.E1.m1.4.5.3.1.cmml"><mtr id="S3.E1.m1.4.4.4a" xref="S3.E1.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.4.4.4b" xref="S3.E1.m1.4.5.3.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.4.5.3.1.cmml"><mn id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">1</mn><mo id="S3.E1.m1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.4.5.3.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.4.4.4c" xref="S3.E1.m1.4.5.3.1.cmml"><mrow id="S3.E1.m1.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.1.cmml"><mrow id="S3.E1.m1.2.2.2.2.2.1.2" xref="S3.E1.m1.2.2.2.2.2.1.2.cmml"><mtext id="S3.E1.m1.2.2.2.2.2.1.2.2" xref="S3.E1.m1.2.2.2.2.2.1.2.2a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.2.1.2.1" xref="S3.E1.m1.2.2.2.2.2.1.2.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.2.1.2.3" xref="S3.E1.m1.2.2.2.2.2.1.2.3.cmml">y</mi></mrow><mo id="S3.E1.m1.2.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.2.1.1.cmml">=</mo><mn id="S3.E1.m1.2.2.2.2.2.1.3" xref="S3.E1.m1.2.2.2.2.2.1.3.cmml">1</mn></mrow></mtd></mtr><mtr id="S3.E1.m1.4.4.4d" xref="S3.E1.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.4.4.4e" xref="S3.E1.m1.4.5.3.1.cmml"><mrow id="S3.E1.m1.3.3.3.3.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.3.3.1.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.cmml"><mn id="S3.E1.m1.3.3.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.3.3.1.1.1.1.2.cmml">1</mn><mo id="S3.E1.m1.3.3.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1.cmml">−</mo><mi id="S3.E1.m1.3.3.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.3.3.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.E1.m1.3.3.3.3.1.1.1.2" xref="S3.E1.m1.3.3.3.3.1.1.1.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E1.m1.4.4.4f" xref="S3.E1.m1.4.5.3.1.cmml"><mrow id="S3.E1.m1.4.4.4.4.2.1" xref="S3.E1.m1.4.4.4.4.2.1.cmml"><mrow id="S3.E1.m1.4.4.4.4.2.1.2" xref="S3.E1.m1.4.4.4.4.2.1.2.cmml"><mtext id="S3.E1.m1.4.4.4.4.2.1.2.2" xref="S3.E1.m1.4.4.4.4.2.1.2.2a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.4.2.1.2.1" xref="S3.E1.m1.4.4.4.4.2.1.2.1.cmml">​</mo><mi id="S3.E1.m1.4.4.4.4.2.1.2.3" xref="S3.E1.m1.4.4.4.4.2.1.2.3.cmml">y</mi></mrow><mo id="S3.E1.m1.4.4.4.4.2.1.1" xref="S3.E1.m1.4.4.4.4.2.1.1.cmml">=</mo><mrow id="S3.E1.m1.4.4.4.4.2.1.3" xref="S3.E1.m1.4.4.4.4.2.1.3.cmml"><mo id="S3.E1.m1.4.4.4.4.2.1.3a" xref="S3.E1.m1.4.4.4.4.2.1.3.cmml">−</mo><mn id="S3.E1.m1.4.4.4.4.2.1.3.2" xref="S3.E1.m1.4.4.4.4.2.1.3.2.cmml">1</mn></mrow></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.5.cmml" xref="S3.E1.m1.4.5"><eq id="S3.E1.m1.4.5.1.cmml" xref="S3.E1.m1.4.5.1"></eq><ci id="S3.E1.m1.4.5.2.cmml" xref="S3.E1.m1.4.5.2">𝑝</ci><apply id="S3.E1.m1.4.5.3.1.cmml" xref="S3.E1.m1.4.4"><csymbol cd="latexml" id="S3.E1.m1.4.5.3.1.1.cmml" xref="S3.E1.m1.4.4.5">cases</csymbol><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">1</cn><apply id="S3.E1.m1.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.1"><eq id="S3.E1.m1.2.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.2.1.1"></eq><apply id="S3.E1.m1.2.2.2.2.2.1.2.cmml" xref="S3.E1.m1.2.2.2.2.2.1.2"><times id="S3.E1.m1.2.2.2.2.2.1.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.1.2.1"></times><ci id="S3.E1.m1.2.2.2.2.2.1.2.2a.cmml" xref="S3.E1.m1.2.2.2.2.2.1.2.2"><mtext id="S3.E1.m1.2.2.2.2.2.1.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.1.2.2">if </mtext></ci><ci id="S3.E1.m1.2.2.2.2.2.1.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.1.2.3">𝑦</ci></apply><cn type="integer" id="S3.E1.m1.2.2.2.2.2.1.3.cmml" xref="S3.E1.m1.2.2.2.2.2.1.3">1</cn></apply><apply id="S3.E1.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1"><minus id="S3.E1.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.1"></minus><cn type="integer" id="S3.E1.m1.3.3.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.2">1</cn><ci id="S3.E1.m1.3.3.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.3.1.1.1.1.3">𝑝</ci></apply><apply id="S3.E1.m1.4.4.4.4.2.1.cmml" xref="S3.E1.m1.4.4.4.4.2.1"><eq id="S3.E1.m1.4.4.4.4.2.1.1.cmml" xref="S3.E1.m1.4.4.4.4.2.1.1"></eq><apply id="S3.E1.m1.4.4.4.4.2.1.2.cmml" xref="S3.E1.m1.4.4.4.4.2.1.2"><times id="S3.E1.m1.4.4.4.4.2.1.2.1.cmml" xref="S3.E1.m1.4.4.4.4.2.1.2.1"></times><ci id="S3.E1.m1.4.4.4.4.2.1.2.2a.cmml" xref="S3.E1.m1.4.4.4.4.2.1.2.2"><mtext id="S3.E1.m1.4.4.4.4.2.1.2.2.cmml" xref="S3.E1.m1.4.4.4.4.2.1.2.2">if </mtext></ci><ci id="S3.E1.m1.4.4.4.4.2.1.2.3.cmml" xref="S3.E1.m1.4.4.4.4.2.1.2.3">𝑦</ci></apply><apply id="S3.E1.m1.4.4.4.4.2.1.3.cmml" xref="S3.E1.m1.4.4.4.4.2.1.3"><minus id="S3.E1.m1.4.4.4.4.2.1.3.1.cmml" xref="S3.E1.m1.4.4.4.4.2.1.3"></minus><cn type="integer" id="S3.E1.m1.4.4.4.4.2.1.3.2.cmml" xref="S3.E1.m1.4.4.4.4.2.1.3.2">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">p=\begin{cases}1,&amp;\text{if }y=1\\
1-p,&amp;\text{if }y=-1\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">where <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="p=sigmoid(x)" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mrow id="S3.SS1.p3.1.m1.1.2" xref="S3.SS1.p3.1.m1.1.2.cmml"><mi id="S3.SS1.p3.1.m1.1.2.2" xref="S3.SS1.p3.1.m1.1.2.2.cmml">p</mi><mo id="S3.SS1.p3.1.m1.1.2.1" xref="S3.SS1.p3.1.m1.1.2.1.cmml">=</mo><mrow id="S3.SS1.p3.1.m1.1.2.3" xref="S3.SS1.p3.1.m1.1.2.3.cmml"><mi id="S3.SS1.p3.1.m1.1.2.3.2" xref="S3.SS1.p3.1.m1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.2.3.1" xref="S3.SS1.p3.1.m1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.2.3.3" xref="S3.SS1.p3.1.m1.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.2.3.1a" xref="S3.SS1.p3.1.m1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.2.3.4" xref="S3.SS1.p3.1.m1.1.2.3.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.2.3.1b" xref="S3.SS1.p3.1.m1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.2.3.5" xref="S3.SS1.p3.1.m1.1.2.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.2.3.1c" xref="S3.SS1.p3.1.m1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.2.3.6" xref="S3.SS1.p3.1.m1.1.2.3.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.2.3.1d" xref="S3.SS1.p3.1.m1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.2.3.7" xref="S3.SS1.p3.1.m1.1.2.3.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.2.3.1e" xref="S3.SS1.p3.1.m1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.1.m1.1.2.3.8" xref="S3.SS1.p3.1.m1.1.2.3.8.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.1.m1.1.2.3.1f" xref="S3.SS1.p3.1.m1.1.2.3.1.cmml">​</mo><mrow id="S3.SS1.p3.1.m1.1.2.3.9.2" xref="S3.SS1.p3.1.m1.1.2.3.cmml"><mo stretchy="false" id="S3.SS1.p3.1.m1.1.2.3.9.2.1" xref="S3.SS1.p3.1.m1.1.2.3.cmml">(</mo><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS1.p3.1.m1.1.2.3.9.2.2" xref="S3.SS1.p3.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.2"><eq id="S3.SS1.p3.1.m1.1.2.1.cmml" xref="S3.SS1.p3.1.m1.1.2.1"></eq><ci id="S3.SS1.p3.1.m1.1.2.2.cmml" xref="S3.SS1.p3.1.m1.1.2.2">𝑝</ci><apply id="S3.SS1.p3.1.m1.1.2.3.cmml" xref="S3.SS1.p3.1.m1.1.2.3"><times id="S3.SS1.p3.1.m1.1.2.3.1.cmml" xref="S3.SS1.p3.1.m1.1.2.3.1"></times><ci id="S3.SS1.p3.1.m1.1.2.3.2.cmml" xref="S3.SS1.p3.1.m1.1.2.3.2">𝑠</ci><ci id="S3.SS1.p3.1.m1.1.2.3.3.cmml" xref="S3.SS1.p3.1.m1.1.2.3.3">𝑖</ci><ci id="S3.SS1.p3.1.m1.1.2.3.4.cmml" xref="S3.SS1.p3.1.m1.1.2.3.4">𝑔</ci><ci id="S3.SS1.p3.1.m1.1.2.3.5.cmml" xref="S3.SS1.p3.1.m1.1.2.3.5">𝑚</ci><ci id="S3.SS1.p3.1.m1.1.2.3.6.cmml" xref="S3.SS1.p3.1.m1.1.2.3.6">𝑜</ci><ci id="S3.SS1.p3.1.m1.1.2.3.7.cmml" xref="S3.SS1.p3.1.m1.1.2.3.7">𝑖</ci><ci id="S3.SS1.p3.1.m1.1.2.3.8.cmml" xref="S3.SS1.p3.1.m1.1.2.3.8">𝑑</ci><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">p=sigmoid(x)</annotation></semantics></math>. The binary cross-entropy loss and its deviation is</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<table id="Sx2.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.2" class="ltx_Math" alttext="\displaystyle\epsilon_{BCE}(p_{t})=-log(p_{t})" display="inline"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.3.2.cmml">ϵ</mi><mrow id="S3.E2.m1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.1.1.1.3.3.2" xref="S3.E2.m1.1.1.1.3.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.3.3.1" xref="S3.E2.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.3.3.3" xref="S3.E2.m1.1.1.1.3.3.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.3.3.1a" xref="S3.E2.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.1.1.1.3.3.4" xref="S3.E2.m1.1.1.1.3.3.4.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.3" xref="S3.E2.m1.2.2.3.cmml">=</mo><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mo id="S3.E2.m1.2.2.2a" xref="S3.E2.m1.2.2.2.cmml">−</mo><mrow id="S3.E2.m1.2.2.2.1" xref="S3.E2.m1.2.2.2.1.cmml"><mi id="S3.E2.m1.2.2.2.1.3" xref="S3.E2.m1.2.2.2.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.1.2" xref="S3.E2.m1.2.2.2.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.2.1.4" xref="S3.E2.m1.2.2.2.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.1.2a" xref="S3.E2.m1.2.2.2.1.2.cmml">​</mo><mi id="S3.E2.m1.2.2.2.1.5" xref="S3.E2.m1.2.2.2.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.1.2b" xref="S3.E2.m1.2.2.2.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.2.2.2.1.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.1.2.cmml">p</mi><mi id="S3.E2.m1.2.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E2.m1.2.2.2.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><eq id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2.3"></eq><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><times id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.3.2">italic-ϵ</ci><apply id="S3.E2.m1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3"><times id="S3.E2.m1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.1.1.1.3.3.1"></times><ci id="S3.E2.m1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.1.1.1.3.3.2">𝐵</ci><ci id="S3.E2.m1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.1.1.1.3.3.3">𝐶</ci><ci id="S3.E2.m1.1.1.1.3.3.4.cmml" xref="S3.E2.m1.1.1.1.3.3.4">𝐸</ci></apply></apply><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><minus id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2"></minus><apply id="S3.E2.m1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.1"><times id="S3.E2.m1.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.1.2"></times><ci id="S3.E2.m1.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.1.3">𝑙</ci><ci id="S3.E2.m1.2.2.2.1.4.cmml" xref="S3.E2.m1.2.2.2.1.4">𝑜</ci><ci id="S3.E2.m1.2.2.2.1.5.cmml" xref="S3.E2.m1.2.2.2.1.5">𝑔</ci><apply id="S3.E2.m1.2.2.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.2">𝑝</ci><ci id="S3.E2.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">\displaystyle\epsilon_{BCE}(p_{t})=-log(p_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\displaystyle\frac{d\epsilon_{BCE}(p_{t})}{dx}=y(p_{t}-1)" display="inline"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><mstyle displaystyle="true" id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mfrac id="S3.E3.m1.1.1a" xref="S3.E3.m1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">​</mo><msub id="S3.E3.m1.1.1.1.4" xref="S3.E3.m1.1.1.1.4.cmml"><mi id="S3.E3.m1.1.1.1.4.2" xref="S3.E3.m1.1.1.1.4.2.cmml">ϵ</mi><mrow id="S3.E3.m1.1.1.1.4.3" xref="S3.E3.m1.1.1.1.4.3.cmml"><mi id="S3.E3.m1.1.1.1.4.3.2" xref="S3.E3.m1.1.1.1.4.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.4.3.1" xref="S3.E3.m1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.4.3.3" xref="S3.E3.m1.1.1.1.4.3.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.4.3.1a" xref="S3.E3.m1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.4.3.4" xref="S3.E3.m1.1.1.1.4.3.4.cmml">E</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2a" xref="S3.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.1" xref="S3.E3.m1.1.1.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml">x</mi></mrow></mfrac></mstyle><mo id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml">=</mo><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.cmml"><mi id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.2.2.1.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><msub id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.2.2.cmml">p</mi><mi id="S3.E3.m1.2.2.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">−</mo><mn id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><eq id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"></eq><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><divide id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1"></divide><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><times id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3">𝑑</ci><apply id="S3.E3.m1.1.1.1.4.cmml" xref="S3.E3.m1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.4.1.cmml" xref="S3.E3.m1.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.1.1.1.4.2.cmml" xref="S3.E3.m1.1.1.1.4.2">italic-ϵ</ci><apply id="S3.E3.m1.1.1.1.4.3.cmml" xref="S3.E3.m1.1.1.1.4.3"><times id="S3.E3.m1.1.1.1.4.3.1.cmml" xref="S3.E3.m1.1.1.1.4.3.1"></times><ci id="S3.E3.m1.1.1.1.4.3.2.cmml" xref="S3.E3.m1.1.1.1.4.3.2">𝐵</ci><ci id="S3.E3.m1.1.1.1.4.3.3.cmml" xref="S3.E3.m1.1.1.1.4.3.3">𝐶</ci><ci id="S3.E3.m1.1.1.1.4.3.4.cmml" xref="S3.E3.m1.1.1.1.4.3.4">𝐸</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><times id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3.1"></times><ci id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2">𝑑</ci><ci id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3">𝑥</ci></apply></apply><apply id="S3.E3.m1.2.2.1.cmml" xref="S3.E3.m1.2.2.1"><times id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1.2"></times><ci id="S3.E3.m1.2.2.1.3.cmml" xref="S3.E3.m1.2.2.1.3">𝑦</ci><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><minus id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"></minus><apply id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2">𝑝</ci><ci id="S3.E3.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.E3.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\displaystyle\frac{d\epsilon_{BCE}(p_{t})}{dx}=y(p_{t}-1)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.1" class="ltx_p">If we train the network with BCE loss, the gradient will be dominated by vast easy classified negative samples, where there is a huge imbalance [2]. We can define Focal loss as a dynamically scaled cross-entropy loss.</p>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<table id="Sx2.EGx2" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.3" class="ltx_Math" alttext="\displaystyle\epsilon_{FL}(p_{t})=-(1-p_{t})^{\gamma}log(p_{t})" display="block"><semantics id="S3.E4.m1.3a"><mrow id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.3.2.cmml">ϵ</mi><mrow id="S3.E4.m1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.1.3.3.2" xref="S3.E4.m1.1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.3.3.1" xref="S3.E4.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E4.m1.1.1.1.3.3.3" xref="S3.E4.m1.1.1.1.3.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.3.3.4" xref="S3.E4.m1.3.3.4.cmml">=</mo><mrow id="S3.E4.m1.3.3.3" xref="S3.E4.m1.3.3.3.cmml"><mo id="S3.E4.m1.3.3.3a" xref="S3.E4.m1.3.3.3.cmml">−</mo><mrow id="S3.E4.m1.3.3.3.2" xref="S3.E4.m1.3.3.3.2.cmml"><msup id="S3.E4.m1.2.2.2.1.1" xref="S3.E4.m1.2.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.2.1.1.1.1" xref="S3.E4.m1.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.2.1.1.1.1.2" xref="S3.E4.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.2.1.1.1.1.1.cmml"><mn id="S3.E4.m1.2.2.2.1.1.1.1.1.2" xref="S3.E4.m1.2.2.2.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E4.m1.2.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E4.m1.2.2.2.1.1.1.1.1.3" xref="S3.E4.m1.2.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.2.1.1.1.1.1.3.2" xref="S3.E4.m1.2.2.2.1.1.1.1.1.3.2.cmml">p</mi><mi id="S3.E4.m1.2.2.2.1.1.1.1.1.3.3" xref="S3.E4.m1.2.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E4.m1.2.2.2.1.1.1.1.3" xref="S3.E4.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E4.m1.2.2.2.1.1.3" xref="S3.E4.m1.2.2.2.1.1.3.cmml">γ</mi></msup><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2.3" xref="S3.E4.m1.3.3.3.2.3.cmml">​</mo><mi id="S3.E4.m1.3.3.3.2.4" xref="S3.E4.m1.3.3.3.2.4.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2.3a" xref="S3.E4.m1.3.3.3.2.3.cmml">​</mo><mi id="S3.E4.m1.3.3.3.2.5" xref="S3.E4.m1.3.3.3.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2.3b" xref="S3.E4.m1.3.3.3.2.3.cmml">​</mo><mi id="S3.E4.m1.3.3.3.2.6" xref="S3.E4.m1.3.3.3.2.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.3.3.3.2.3c" xref="S3.E4.m1.3.3.3.2.3.cmml">​</mo><mrow id="S3.E4.m1.3.3.3.2.2.1" xref="S3.E4.m1.3.3.3.2.2.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.3.2.2.1.2" xref="S3.E4.m1.3.3.3.2.2.1.1.cmml">(</mo><msub id="S3.E4.m1.3.3.3.2.2.1.1" xref="S3.E4.m1.3.3.3.2.2.1.1.cmml"><mi id="S3.E4.m1.3.3.3.2.2.1.1.2" xref="S3.E4.m1.3.3.3.2.2.1.1.2.cmml">p</mi><mi id="S3.E4.m1.3.3.3.2.2.1.1.3" xref="S3.E4.m1.3.3.3.2.2.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E4.m1.3.3.3.2.2.1.3" xref="S3.E4.m1.3.3.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.3b"><apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"><eq id="S3.E4.m1.3.3.4.cmml" xref="S3.E4.m1.3.3.4"></eq><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><times id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></times><apply id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.3.2">italic-ϵ</ci><apply id="S3.E4.m1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3"><times id="S3.E4.m1.1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.1.3.3.1"></times><ci id="S3.E4.m1.1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.1.3.3.2">𝐹</ci><ci id="S3.E4.m1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3.3">𝐿</ci></apply></apply><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E4.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E4.m1.3.3.3.cmml" xref="S3.E4.m1.3.3.3"><minus id="S3.E4.m1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3"></minus><apply id="S3.E4.m1.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.2"><times id="S3.E4.m1.3.3.3.2.3.cmml" xref="S3.E4.m1.3.3.3.2.3"></times><apply id="S3.E4.m1.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.2.1.1">superscript</csymbol><apply id="S3.E4.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.1.1.1.1"><minus id="S3.E4.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.2.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E4.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.2.1.1.1.1.1.2">1</cn><apply id="S3.E4.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.2.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E4.m1.2.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S3.E4.m1.2.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.2.1.1.3">𝛾</ci></apply><ci id="S3.E4.m1.3.3.3.2.4.cmml" xref="S3.E4.m1.3.3.3.2.4">𝑙</ci><ci id="S3.E4.m1.3.3.3.2.5.cmml" xref="S3.E4.m1.3.3.3.2.5">𝑜</ci><ci id="S3.E4.m1.3.3.3.2.6.cmml" xref="S3.E4.m1.3.3.3.2.6">𝑔</ci><apply id="S3.E4.m1.3.3.3.2.2.1.1.cmml" xref="S3.E4.m1.3.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.2.2.1.1.1.cmml" xref="S3.E4.m1.3.3.3.2.2.1">subscript</csymbol><ci id="S3.E4.m1.3.3.3.2.2.1.1.2.cmml" xref="S3.E4.m1.3.3.3.2.2.1.1.2">𝑝</ci><ci id="S3.E4.m1.3.3.3.2.2.1.1.3.cmml" xref="S3.E4.m1.3.3.3.2.2.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.3c">\displaystyle\epsilon_{FL}(p_{t})=-(1-p_{t})^{\gamma}log(p_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.3" class="ltx_Math" alttext="\displaystyle\frac{d\epsilon_{FL}(p_{t})}{dx}=y(p_{t}-1)^{\gamma}(\gamma p_{t}log(p_{t})+p_{t}-1)" display="block"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml"><mfrac id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">​</mo><msub id="S3.E5.m1.1.1.1.4" xref="S3.E5.m1.1.1.1.4.cmml"><mi id="S3.E5.m1.1.1.1.4.2" xref="S3.E5.m1.1.1.1.4.2.cmml">ϵ</mi><mrow id="S3.E5.m1.1.1.1.4.3" xref="S3.E5.m1.1.1.1.4.3.cmml"><mi id="S3.E5.m1.1.1.1.4.3.2" xref="S3.E5.m1.1.1.1.4.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.4.3.1" xref="S3.E5.m1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.4.3.3" xref="S3.E5.m1.1.1.1.4.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.2a" xref="S3.E5.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E5.m1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.3.1" xref="S3.E5.m1.1.1.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml">x</mi></mrow></mfrac><mo id="S3.E5.m1.3.3.3" xref="S3.E5.m1.3.3.3.cmml">=</mo><mrow id="S3.E5.m1.3.3.2" xref="S3.E5.m1.3.3.2.cmml"><mi id="S3.E5.m1.3.3.2.4" xref="S3.E5.m1.3.3.2.4.cmml">y</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.2.3" xref="S3.E5.m1.3.3.2.3.cmml">​</mo><msup id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.2.cmml">p</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml">−</mo><mn id="S3.E5.m1.2.2.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.3.cmml">γ</mi></msup><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.2.3a" xref="S3.E5.m1.3.3.2.3.cmml">​</mo><mrow id="S3.E5.m1.3.3.2.2.1" xref="S3.E5.m1.3.3.2.2.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.2.2.1.2" xref="S3.E5.m1.3.3.2.2.1.1.cmml">(</mo><mrow id="S3.E5.m1.3.3.2.2.1.1" xref="S3.E5.m1.3.3.2.2.1.1.cmml"><mrow id="S3.E5.m1.3.3.2.2.1.1.1" xref="S3.E5.m1.3.3.2.2.1.1.1.cmml"><mrow id="S3.E5.m1.3.3.2.2.1.1.1.1" xref="S3.E5.m1.3.3.2.2.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.2.2.1.1.1.1.3" xref="S3.E5.m1.3.3.2.2.1.1.1.1.3.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.2.2.1.1.1.1.2" xref="S3.E5.m1.3.3.2.2.1.1.1.1.2.cmml">​</mo><msub id="S3.E5.m1.3.3.2.2.1.1.1.1.4" xref="S3.E5.m1.3.3.2.2.1.1.1.1.4.cmml"><mi id="S3.E5.m1.3.3.2.2.1.1.1.1.4.2" xref="S3.E5.m1.3.3.2.2.1.1.1.1.4.2.cmml">p</mi><mi id="S3.E5.m1.3.3.2.2.1.1.1.1.4.3" xref="S3.E5.m1.3.3.2.2.1.1.1.1.4.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.2.2.1.1.1.1.2a" xref="S3.E5.m1.3.3.2.2.1.1.1.1.2.cmml">​</mo><mi id="S3.E5.m1.3.3.2.2.1.1.1.1.5" xref="S3.E5.m1.3.3.2.2.1.1.1.1.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.2.2.1.1.1.1.2b" xref="S3.E5.m1.3.3.2.2.1.1.1.1.2.cmml">​</mo><mi id="S3.E5.m1.3.3.2.2.1.1.1.1.6" xref="S3.E5.m1.3.3.2.2.1.1.1.1.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.2.2.1.1.1.1.2c" xref="S3.E5.m1.3.3.2.2.1.1.1.1.2.cmml">​</mo><mi id="S3.E5.m1.3.3.2.2.1.1.1.1.7" xref="S3.E5.m1.3.3.2.2.1.1.1.1.7.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.3.3.2.2.1.1.1.1.2d" xref="S3.E5.m1.3.3.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.3.3.2.2.1.1.1.1.1.1" xref="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.3.3.2.2.1.1.1.2" xref="S3.E5.m1.3.3.2.2.1.1.1.2.cmml">+</mo><msub id="S3.E5.m1.3.3.2.2.1.1.1.3" xref="S3.E5.m1.3.3.2.2.1.1.1.3.cmml"><mi id="S3.E5.m1.3.3.2.2.1.1.1.3.2" xref="S3.E5.m1.3.3.2.2.1.1.1.3.2.cmml">p</mi><mi id="S3.E5.m1.3.3.2.2.1.1.1.3.3" xref="S3.E5.m1.3.3.2.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.E5.m1.3.3.2.2.1.1.2" xref="S3.E5.m1.3.3.2.2.1.1.2.cmml">−</mo><mn id="S3.E5.m1.3.3.2.2.1.1.3" xref="S3.E5.m1.3.3.2.2.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E5.m1.3.3.2.2.1.3" xref="S3.E5.m1.3.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"><eq id="S3.E5.m1.3.3.3.cmml" xref="S3.E5.m1.3.3.3"></eq><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><divide id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1"></divide><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><times id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></times><ci id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3">𝑑</ci><apply id="S3.E5.m1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.4.1.cmml" xref="S3.E5.m1.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.1.1.1.4.2.cmml" xref="S3.E5.m1.1.1.1.4.2">italic-ϵ</ci><apply id="S3.E5.m1.1.1.1.4.3.cmml" xref="S3.E5.m1.1.1.1.4.3"><times id="S3.E5.m1.1.1.1.4.3.1.cmml" xref="S3.E5.m1.1.1.1.4.3.1"></times><ci id="S3.E5.m1.1.1.1.4.3.2.cmml" xref="S3.E5.m1.1.1.1.4.3.2">𝐹</ci><ci id="S3.E5.m1.1.1.1.4.3.3.cmml" xref="S3.E5.m1.1.1.1.4.3.3">𝐿</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E5.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><times id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3.1"></times><ci id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2">𝑑</ci><ci id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3">𝑥</ci></apply></apply><apply id="S3.E5.m1.3.3.2.cmml" xref="S3.E5.m1.3.3.2"><times id="S3.E5.m1.3.3.2.3.cmml" xref="S3.E5.m1.3.3.2.3"></times><ci id="S3.E5.m1.3.3.2.4.cmml" xref="S3.E5.m1.3.3.2.4">𝑦</ci><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1">superscript</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><minus id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"></minus><apply id="S3.E5.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.2">𝑝</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S3.E5.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3">1</cn></apply><ci id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3">𝛾</ci></apply><apply id="S3.E5.m1.3.3.2.2.1.1.cmml" xref="S3.E5.m1.3.3.2.2.1"><minus id="S3.E5.m1.3.3.2.2.1.1.2.cmml" xref="S3.E5.m1.3.3.2.2.1.1.2"></minus><apply id="S3.E5.m1.3.3.2.2.1.1.1.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1"><plus id="S3.E5.m1.3.3.2.2.1.1.1.2.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.2"></plus><apply id="S3.E5.m1.3.3.2.2.1.1.1.1.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1"><times id="S3.E5.m1.3.3.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.2"></times><ci id="S3.E5.m1.3.3.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.3">𝛾</ci><apply id="S3.E5.m1.3.3.2.2.1.1.1.1.4.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.2.2.1.1.1.1.4.1.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.3.3.2.2.1.1.1.1.4.2.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.4.2">𝑝</ci><ci id="S3.E5.m1.3.3.2.2.1.1.1.1.4.3.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.4.3">𝑡</ci></apply><ci id="S3.E5.m1.3.3.2.2.1.1.1.1.5.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.5">𝑙</ci><ci id="S3.E5.m1.3.3.2.2.1.1.1.1.6.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.6">𝑜</ci><ci id="S3.E5.m1.3.3.2.2.1.1.1.1.7.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.7">𝑔</ci><apply id="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E5.m1.3.3.2.2.1.1.1.3.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.2.2.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.3.3.2.2.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.3.2">𝑝</ci><ci id="S3.E5.m1.3.3.2.2.1.1.1.3.3.cmml" xref="S3.E5.m1.3.3.2.2.1.1.1.3.3">𝑡</ci></apply></apply><cn type="integer" id="S3.E5.m1.3.3.2.2.1.1.3.cmml" xref="S3.E5.m1.3.3.2.2.1.1.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\displaystyle\frac{d\epsilon_{FL}(p_{t})}{dx}=y(p_{t}-1)^{\gamma}(\gamma p_{t}log(p_{t})+p_{t}-1)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p7" class="ltx_para">
<p id="S3.SS1.p7.4" class="ltx_p">The contribution from the well-classified samples (pt <math id="S3.SS1.p7.1.m1.1" class="ltx_Math" alttext="\gg" display="inline"><semantics id="S3.SS1.p7.1.m1.1a"><mo id="S3.SS1.p7.1.m1.1.1" xref="S3.SS1.p7.1.m1.1.1.cmml">≫</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.1.m1.1b"><csymbol cd="latexml" id="S3.SS1.p7.1.m1.1.1.cmml" xref="S3.SS1.p7.1.m1.1.1">much-greater-than</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.1.m1.1c">\gg</annotation></semantics></math> 0.5)to the loss is down-weighted. The hyperparameter of the focal loss can be used to tune the weight of different samples. As <math id="S3.SS1.p7.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS1.p7.2.m2.1a"><mi id="S3.SS1.p7.2.m2.1.1" xref="S3.SS1.p7.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.2.m2.1b"><ci id="S3.SS1.p7.2.m2.1.1.cmml" xref="S3.SS1.p7.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.2.m2.1c">\gamma</annotation></semantics></math> increases, fewer easily classified samples contribute to the training loss. When <math id="S3.SS1.p7.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS1.p7.3.m3.1a"><mi id="S3.SS1.p7.3.m3.1.1" xref="S3.SS1.p7.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.3.m3.1b"><ci id="S3.SS1.p7.3.m3.1.1.cmml" xref="S3.SS1.p7.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.3.m3.1c">\gamma</annotation></semantics></math> reaches 0, the focal loss degrades to become same as the BCE loss. In the following sections, all the cases with <math id="S3.SS1.p7.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S3.SS1.p7.4.m4.1a"><mi id="S3.SS1.p7.4.m4.1.1" xref="S3.SS1.p7.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p7.4.m4.1b"><ci id="S3.SS1.p7.4.m4.1.1.cmml" xref="S3.SS1.p7.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p7.4.m4.1c">\gamma</annotation></semantics></math> = 0 represent BCE loss cases.</p>
</div>
<div id="S3.SS1.p8" class="ltx_para">
<p id="S3.SS1.p8.1" class="ltx_p">In previous works, techniques have balanced the losses calculated from positive and negative anchors. Alternatively, normalized positive and negative losses by the frequency of corresponding anchors are used as well.</p>
</div>
<div id="S3.SS1.p9" class="ltx_para">
<p id="S3.SS1.p9.3" class="ltx_p">However, one fundamental problem that these two previous methods cannot handle is the gradient salience of hard negative samples. A large number of easy negative anchors (pt <math id="S3.SS1.p9.1.m1.1" class="ltx_Math" alttext="\gg" display="inline"><semantics id="S3.SS1.p9.1.m1.1a"><mo id="S3.SS1.p9.1.m1.1.1" xref="S3.SS1.p9.1.m1.1.1.cmml">≫</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.1.m1.1b"><csymbol cd="latexml" id="S3.SS1.p9.1.m1.1.1.cmml" xref="S3.SS1.p9.1.m1.1.1">much-greater-than</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.1.m1.1c">\gg</annotation></semantics></math>0.5) will overwhelm the gradients of hard negative anchors (pt <math id="S3.SS1.p9.2.m2.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.SS1.p9.2.m2.1a"><mo id="S3.SS1.p9.2.m2.1.1" xref="S3.SS1.p9.2.m2.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.2.m2.1b"><lt id="S3.SS1.p9.2.m2.1.1.cmml" xref="S3.SS1.p9.2.m2.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.2.m2.1c">&lt;</annotation></semantics></math> 0.5). Due to the dynamic scaling with the posterior probability <math id="S3.SS1.p9.3.m3.1" class="ltx_Math" alttext="p_{t}" display="inline"><semantics id="S3.SS1.p9.3.m3.1a"><msub id="S3.SS1.p9.3.m3.1.1" xref="S3.SS1.p9.3.m3.1.1.cmml"><mi id="S3.SS1.p9.3.m3.1.1.2" xref="S3.SS1.p9.3.m3.1.1.2.cmml">p</mi><mi id="S3.SS1.p9.3.m3.1.1.3" xref="S3.SS1.p9.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p9.3.m3.1b"><apply id="S3.SS1.p9.3.m3.1.1.cmml" xref="S3.SS1.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p9.3.m3.1.1.1.cmml" xref="S3.SS1.p9.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p9.3.m3.1.1.2.cmml" xref="S3.SS1.p9.3.m3.1.1.2">𝑝</ci><ci id="S3.SS1.p9.3.m3.1.1.3.cmml" xref="S3.SS1.p9.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p9.3.m3.1c">p_{t}</annotation></semantics></math>, a weighted focal loss can be used to handle both the fore-background imbalance and the gradient salience of hard negative samples with the following form.</p>
</div>
<div id="S3.SS1.p10" class="ltx_para">
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.3" class="ltx_Math" alttext="\epsilon_{FL}(p_{t})=-\alpha(1-p_{t})^{\gamma}log(p_{t})" display="block"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.3.2.cmml">ϵ</mi><mrow id="S3.E6.m1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.1.1.1.3.3.2" xref="S3.E6.m1.1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.3.3.1" xref="S3.E6.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.1.3.3.3" xref="S3.E6.m1.1.1.1.3.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.3.3.4" xref="S3.E6.m1.3.3.4.cmml">=</mo><mrow id="S3.E6.m1.3.3.3" xref="S3.E6.m1.3.3.3.cmml"><mo id="S3.E6.m1.3.3.3a" xref="S3.E6.m1.3.3.3.cmml">−</mo><mrow id="S3.E6.m1.3.3.3.2" xref="S3.E6.m1.3.3.3.2.cmml"><mi id="S3.E6.m1.3.3.3.2.4" xref="S3.E6.m1.3.3.3.2.4.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.2.3" xref="S3.E6.m1.3.3.3.2.3.cmml">​</mo><msup id="S3.E6.m1.2.2.2.1.1" xref="S3.E6.m1.2.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.2.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.2.1.1.1.1.2" xref="S3.E6.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.1.cmml"><mn id="S3.E6.m1.2.2.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.2.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E6.m1.2.2.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E6.m1.2.2.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.2.2.2.1.1.1.1.1.3.2" xref="S3.E6.m1.2.2.2.1.1.1.1.1.3.2.cmml">p</mi><mi id="S3.E6.m1.2.2.2.1.1.1.1.1.3.3" xref="S3.E6.m1.2.2.2.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E6.m1.2.2.2.1.1.1.1.3" xref="S3.E6.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E6.m1.2.2.2.1.1.3" xref="S3.E6.m1.2.2.2.1.1.3.cmml">γ</mi></msup><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.2.3a" xref="S3.E6.m1.3.3.3.2.3.cmml">​</mo><mi id="S3.E6.m1.3.3.3.2.5" xref="S3.E6.m1.3.3.3.2.5.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.2.3b" xref="S3.E6.m1.3.3.3.2.3.cmml">​</mo><mi id="S3.E6.m1.3.3.3.2.6" xref="S3.E6.m1.3.3.3.2.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.2.3c" xref="S3.E6.m1.3.3.3.2.3.cmml">​</mo><mi id="S3.E6.m1.3.3.3.2.7" xref="S3.E6.m1.3.3.3.2.7.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.2.3d" xref="S3.E6.m1.3.3.3.2.3.cmml">​</mo><mrow id="S3.E6.m1.3.3.3.2.2.1" xref="S3.E6.m1.3.3.3.2.2.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.3.2.2.1.2" xref="S3.E6.m1.3.3.3.2.2.1.1.cmml">(</mo><msub id="S3.E6.m1.3.3.3.2.2.1.1" xref="S3.E6.m1.3.3.3.2.2.1.1.cmml"><mi id="S3.E6.m1.3.3.3.2.2.1.1.2" xref="S3.E6.m1.3.3.3.2.2.1.1.2.cmml">p</mi><mi id="S3.E6.m1.3.3.3.2.2.1.1.3" xref="S3.E6.m1.3.3.3.2.2.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E6.m1.3.3.3.2.2.1.3" xref="S3.E6.m1.3.3.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3"><eq id="S3.E6.m1.3.3.4.cmml" xref="S3.E6.m1.3.3.4"></eq><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><times id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.3.2">italic-ϵ</ci><apply id="S3.E6.m1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.3.3"><times id="S3.E6.m1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.1.1.1.3.3.1"></times><ci id="S3.E6.m1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.1.1.1.3.3.2">𝐹</ci><ci id="S3.E6.m1.1.1.1.3.3.3.cmml" xref="S3.E6.m1.1.1.1.3.3.3">𝐿</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.3"><minus id="S3.E6.m1.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3"></minus><apply id="S3.E6.m1.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3.2"><times id="S3.E6.m1.3.3.3.2.3.cmml" xref="S3.E6.m1.3.3.3.2.3"></times><ci id="S3.E6.m1.3.3.3.2.4.cmml" xref="S3.E6.m1.3.3.3.2.4">𝛼</ci><apply id="S3.E6.m1.2.2.2.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.2.1.1">superscript</csymbol><apply id="S3.E6.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1"><minus id="S3.E6.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E6.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.2">1</cn><apply id="S3.E6.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.E6.m1.2.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S3.E6.m1.2.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.2.1.1.3">𝛾</ci></apply><ci id="S3.E6.m1.3.3.3.2.5.cmml" xref="S3.E6.m1.3.3.3.2.5">𝑙</ci><ci id="S3.E6.m1.3.3.3.2.6.cmml" xref="S3.E6.m1.3.3.3.2.6">𝑜</ci><ci id="S3.E6.m1.3.3.3.2.7.cmml" xref="S3.E6.m1.3.3.3.2.7">𝑔</ci><apply id="S3.E6.m1.3.3.3.2.2.1.1.cmml" xref="S3.E6.m1.3.3.3.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.2.2.1.1.1.cmml" xref="S3.E6.m1.3.3.3.2.2.1">subscript</csymbol><ci id="S3.E6.m1.3.3.3.2.2.1.1.2.cmml" xref="S3.E6.m1.3.3.3.2.2.1.1.2">𝑝</ci><ci id="S3.E6.m1.3.3.3.2.2.1.1.3.cmml" xref="S3.E6.m1.3.3.3.2.2.1.1.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\epsilon_{FL}(p_{t})=-\alpha(1-p_{t})^{\gamma}log(p_{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p10.1" class="ltx_p">where <math id="S3.SS1.p10.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS1.p10.1.m1.1a"><mi id="S3.SS1.p10.1.m1.1.1" xref="S3.SS1.p10.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p10.1.m1.1b"><ci id="S3.SS1.p10.1.m1.1.1.cmml" xref="S3.SS1.p10.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p10.1.m1.1c">\alpha</annotation></semantics></math> can be used to scale the distinct classes separately.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Definition</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">As we have seen, Focal loss leverages the dynamically changing class probability <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="(p_{t})" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.2.cmml">p</mi><mi id="S3.SS2.p1.1.m1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.2">𝑝</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">(p_{t})</annotation></semantics></math> values to down-weight the well-classified samples and thereby focuses more on the challenging class samples that are significantly less in number.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">In general, we rely on the validation loss during training to infer about the performance of the model. A model with lower validation loss is considered to perform better as compared to a model with higher validation loss. Once identified, the server performing the aggregation can focus on using the best-performing clients for global training.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.2" class="ltx_p">In Federated Learning, <span id="S3.SS2.p3.2.1" class="ltx_text ltx_font_italic">N</span> clients are associated with <span id="S3.SS2.p3.2.2" class="ltx_text ltx_font_italic">N</span> datasets <math id="S3.SS2.p3.1.m1.3" class="ltx_Math" alttext="D_{1},\dots,D_{N}" display="inline"><semantics id="S3.SS2.p3.1.m1.3a"><mrow id="S3.SS2.p3.1.m1.3.3.2" xref="S3.SS2.p3.1.m1.3.3.3.cmml"><msub id="S3.SS2.p3.1.m1.2.2.1.1" xref="S3.SS2.p3.1.m1.2.2.1.1.cmml"><mi id="S3.SS2.p3.1.m1.2.2.1.1.2" xref="S3.SS2.p3.1.m1.2.2.1.1.2.cmml">D</mi><mn id="S3.SS2.p3.1.m1.2.2.1.1.3" xref="S3.SS2.p3.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p3.1.m1.3.3.2.3" xref="S3.SS2.p3.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p3.1.m1.3.3.2.4" xref="S3.SS2.p3.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS2.p3.1.m1.3.3.2.2" xref="S3.SS2.p3.1.m1.3.3.2.2.cmml"><mi id="S3.SS2.p3.1.m1.3.3.2.2.2" xref="S3.SS2.p3.1.m1.3.3.2.2.2.cmml">D</mi><mi id="S3.SS2.p3.1.m1.3.3.2.2.3" xref="S3.SS2.p3.1.m1.3.3.2.2.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.3b"><list id="S3.SS2.p3.1.m1.3.3.3.cmml" xref="S3.SS2.p3.1.m1.3.3.2"><apply id="S3.SS2.p3.1.m1.2.2.1.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.2">𝐷</ci><cn type="integer" id="S3.SS2.p3.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">…</ci><apply id="S3.SS2.p3.1.m1.3.3.2.2.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.3.3.2.2.1.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS2.p3.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.2">𝐷</ci><ci id="S3.SS2.p3.1.m1.3.3.2.2.3.cmml" xref="S3.SS2.p3.1.m1.3.3.2.2.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.3c">D_{1},\dots,D_{N}</annotation></semantics></math>, where <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">D</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝐷</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">D_{i}</annotation></semantics></math> denotes the dataset of client id <span id="S3.SS2.p3.2.3" class="ltx_text ltx_font_italic">i</span> is in general generated by a client dependent probability distribution function and only accessible by the respective client.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">In each round of training with VIRTUAL, we sample a fixed number of <span id="S3.SS2.p4.1.1" class="ltx_text ltx_font_italic">K</span> clients from a pool of <span id="S3.SS2.p4.1.2" class="ltx_text ltx_font_italic">N</span> clients. The aggregation of weights in training thus is highly dependent on which clients were sampled in each round. These clients will refine the server model in each round.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">Fed-Focal loss function takes into input the validation losses of sampled clients from the last round. As training starts, we randomly pick up <span id="S3.SS2.p5.1.1" class="ltx_text ltx_font_italic">K</span> clients from a pool of <span id="S3.SS2.p5.1.2" class="ltx_text ltx_font_italic">N</span> clients. During subsequent training rounds, we look at the validation loss from the last training round to see if some of them have improved. We expect these clients to perform better and contribute to the overall accuracy.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.1" class="ltx_p">There can be a case of sampling bias with respect to clients. We introduce a tuning parameter called <math id="S3.SS2.p6.1.m1.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S3.SS2.p6.1.m1.1a"><mi id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.1b"><ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.1c">\psi</annotation></semantics></math>, which ensures appropriate sampling of clients.</p>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<table id="Sx2.EGx3" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="S3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.1" class="ltx_Math" alttext="\displaystyle 0&lt;\psi&lt;1.0" display="block"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><mn id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">0</mn><mo id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml">&lt;</mo><mi id="S3.E7.m1.1.1.4" xref="S3.E7.m1.1.1.4.cmml">ψ</mi><mo id="S3.E7.m1.1.1.5" xref="S3.E7.m1.1.1.5.cmml">&lt;</mo><mn id="S3.E7.m1.1.1.6" xref="S3.E7.m1.1.1.6.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><and id="S3.E7.m1.1.1a.cmml" xref="S3.E7.m1.1.1"></and><apply id="S3.E7.m1.1.1b.cmml" xref="S3.E7.m1.1.1"><lt id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"></lt><cn type="integer" id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2">0</cn><ci id="S3.E7.m1.1.1.4.cmml" xref="S3.E7.m1.1.1.4">𝜓</ci></apply><apply id="S3.E7.m1.1.1c.cmml" xref="S3.E7.m1.1.1"><lt id="S3.E7.m1.1.1.5.cmml" xref="S3.E7.m1.1.1.5"></lt><share href="#S3.E7.m1.1.1.4.cmml" id="S3.E7.m1.1.1d.cmml" xref="S3.E7.m1.1.1"></share><cn type="float" id="S3.E7.m1.1.1.6.cmml" xref="S3.E7.m1.1.1.6">1.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\displaystyle 0&lt;\psi&lt;1.0</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\displaystyle c=\left\lfloor{\psi K}\right\rfloor" display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><mi id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml">c</mi><mo id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.2.cmml"><mo id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.2.1.cmml">⌊</mo><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3.cmml">K</mi></mrow><mo id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.2.1.cmml">⌋</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><eq id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"></eq><ci id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3">𝑐</ci><apply id="S3.E8.m1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1"><floor id="S3.E8.m1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.2"></floor><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"></times><ci id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2">𝜓</ci><ci id="S3.E8.m1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\displaystyle c=\left\lfloor{\psi K}\right\rfloor</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p8" class="ltx_para">
<p id="S3.SS2.p8.5" class="ltx_p">Let <math id="S3.SS2.p8.1.m1.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.SS2.p8.1.m1.1a"><msub id="S3.SS2.p8.1.m1.1.1" xref="S3.SS2.p8.1.m1.1.1.cmml"><mi id="S3.SS2.p8.1.m1.1.1.2" xref="S3.SS2.p8.1.m1.1.1.2.cmml">C</mi><mi id="S3.SS2.p8.1.m1.1.1.3" xref="S3.SS2.p8.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.1.m1.1b"><apply id="S3.SS2.p8.1.m1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.1.m1.1.1.1.cmml" xref="S3.SS2.p8.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p8.1.m1.1.1.2.cmml" xref="S3.SS2.p8.1.m1.1.1.2">𝐶</ci><ci id="S3.SS2.p8.1.m1.1.1.3.cmml" xref="S3.SS2.p8.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.1.m1.1c">C_{i}</annotation></semantics></math> be the set of <math id="S3.SS2.p8.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p8.2.m2.1a"><mi id="S3.SS2.p8.2.m2.1.1" xref="S3.SS2.p8.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.2.m2.1b"><ci id="S3.SS2.p8.2.m2.1.1.cmml" xref="S3.SS2.p8.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.2.m2.1c">K</annotation></semantics></math> clients that were selected the last training round numbered <math id="S3.SS2.p8.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p8.3.m3.1a"><mi id="S3.SS2.p8.3.m3.1.1" xref="S3.SS2.p8.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.3.m3.1b"><ci id="S3.SS2.p8.3.m3.1.1.cmml" xref="S3.SS2.p8.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.3.m3.1c">i</annotation></semantics></math>. There will be a subset <math id="S3.SS2.p8.4.m4.1" class="ltx_Math" alttext="V_{i}" display="inline"><semantics id="S3.SS2.p8.4.m4.1a"><msub id="S3.SS2.p8.4.m4.1.1" xref="S3.SS2.p8.4.m4.1.1.cmml"><mi id="S3.SS2.p8.4.m4.1.1.2" xref="S3.SS2.p8.4.m4.1.1.2.cmml">V</mi><mi id="S3.SS2.p8.4.m4.1.1.3" xref="S3.SS2.p8.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.4.m4.1b"><apply id="S3.SS2.p8.4.m4.1.1.cmml" xref="S3.SS2.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p8.4.m4.1.1.1.cmml" xref="S3.SS2.p8.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p8.4.m4.1.1.2.cmml" xref="S3.SS2.p8.4.m4.1.1.2">𝑉</ci><ci id="S3.SS2.p8.4.m4.1.1.3.cmml" xref="S3.SS2.p8.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.4.m4.1c">V_{i}</annotation></semantics></math> which will represent the clients where validation loss went down the last round. We further randomly select a subset which will contain at most <math id="S3.SS2.p8.5.m5.1" class="ltx_Math" alttext="\psi K" display="inline"><semantics id="S3.SS2.p8.5.m5.1a"><mrow id="S3.SS2.p8.5.m5.1.1" xref="S3.SS2.p8.5.m5.1.1.cmml"><mi id="S3.SS2.p8.5.m5.1.1.2" xref="S3.SS2.p8.5.m5.1.1.2.cmml">ψ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p8.5.m5.1.1.1" xref="S3.SS2.p8.5.m5.1.1.1.cmml">​</mo><mi id="S3.SS2.p8.5.m5.1.1.3" xref="S3.SS2.p8.5.m5.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p8.5.m5.1b"><apply id="S3.SS2.p8.5.m5.1.1.cmml" xref="S3.SS2.p8.5.m5.1.1"><times id="S3.SS2.p8.5.m5.1.1.1.cmml" xref="S3.SS2.p8.5.m5.1.1.1"></times><ci id="S3.SS2.p8.5.m5.1.1.2.cmml" xref="S3.SS2.p8.5.m5.1.1.2">𝜓</ci><ci id="S3.SS2.p8.5.m5.1.1.3.cmml" xref="S3.SS2.p8.5.m5.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p8.5.m5.1c">\psi K</annotation></semantics></math> clients.</p>
</div>
<div id="S3.SS2.p9" class="ltx_para">
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.14" class="ltx_Math" alttext="V_{i}=\{j\in C_{i}:\text{Where in client j}\\
\text{validation loss has decreased}\}" display="block"><semantics id="S3.E9.m1.14a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E9.m1.12.12" xref="S3.E9.m1.14.14.2.cmml"><mtr id="S3.E9.m1.12.12a" xref="S3.E9.m1.14.14.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.12.12b" xref="S3.E9.m1.14.14.2.cmml"><mrow id="S3.E9.m1.10.10.10.10.10" xref="S3.E9.m1.14.14.2.cmml"><msub id="S3.E9.m1.10.10.10.10.10.11" xref="S3.E9.m1.14.14.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml">V</mi><mi id="S3.E9.m1.2.2.2.2.2.2.1" xref="S3.E9.m1.2.2.2.2.2.2.1.cmml">i</mi></msub><mo id="S3.E9.m1.3.3.3.3.3.3" xref="S3.E9.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E9.m1.10.10.10.10.10.12" xref="S3.E9.m1.14.14.2.cmml"><mo stretchy="false" id="S3.E9.m1.4.4.4.4.4.4" xref="S3.E9.m1.14.14.2.cmml">{</mo><mi id="S3.E9.m1.5.5.5.5.5.5" xref="S3.E9.m1.5.5.5.5.5.5.cmml">j</mi><mo id="S3.E9.m1.6.6.6.6.6.6" xref="S3.E9.m1.6.6.6.6.6.6.cmml">∈</mo><msub id="S3.E9.m1.10.10.10.10.10.12.1" xref="S3.E9.m1.14.14.2.cmml"><mi id="S3.E9.m1.7.7.7.7.7.7" xref="S3.E9.m1.7.7.7.7.7.7.cmml">C</mi><mi id="S3.E9.m1.8.8.8.8.8.8.1" xref="S3.E9.m1.8.8.8.8.8.8.1.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.E9.m1.9.9.9.9.9.9" xref="S3.E9.m1.14.14.2.cmml">:</mo><mtext id="S3.E9.m1.10.10.10.10.10.10" xref="S3.E9.m1.10.10.10.10.10.10a.cmml">Where in client j</mtext></mrow></mrow></mtd></mtr><mtr id="S3.E9.m1.12.12c" xref="S3.E9.m1.14.14.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E9.m1.12.12d" xref="S3.E9.m1.14.14.2.cmml"><mrow id="S3.E9.m1.12.12.12.2.2" xref="S3.E9.m1.14.14.2.cmml"><mtext id="S3.E9.m1.11.11.11.1.1.1" xref="S3.E9.m1.11.11.11.1.1.1a.cmml">validation loss has decreased</mtext><mo stretchy="false" id="S3.E9.m1.12.12.12.2.2.2" xref="S3.E9.m1.14.14.2.cmml">}</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E9.m1.14b"><apply id="S3.E9.m1.14.14.2.cmml" xref="S3.E9.m1.12.12"><eq id="S3.E9.m1.3.3.3.3.3.3.cmml" xref="S3.E9.m1.3.3.3.3.3.3"></eq><apply id="S3.E9.m1.14.14.2.4.cmml" xref="S3.E9.m1.12.12"><csymbol cd="ambiguous" id="S3.E9.m1.14.14.2.4.1.cmml" xref="S3.E9.m1.12.12">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1">𝑉</ci><ci id="S3.E9.m1.2.2.2.2.2.2.1.cmml" xref="S3.E9.m1.2.2.2.2.2.2.1">𝑖</ci></apply><apply id="S3.E9.m1.14.14.2.2.3.cmml" xref="S3.E9.m1.12.12"><csymbol cd="latexml" id="S3.E9.m1.14.14.2.2.3.1.cmml" xref="S3.E9.m1.12.12">conditional-set</csymbol><apply id="S3.E9.m1.13.13.1.1.1.1.cmml" xref="S3.E9.m1.12.12"><in id="S3.E9.m1.6.6.6.6.6.6.cmml" xref="S3.E9.m1.6.6.6.6.6.6"></in><ci id="S3.E9.m1.5.5.5.5.5.5.cmml" xref="S3.E9.m1.5.5.5.5.5.5">𝑗</ci><apply id="S3.E9.m1.13.13.1.1.1.1.3.cmml" xref="S3.E9.m1.12.12"><csymbol cd="ambiguous" id="S3.E9.m1.13.13.1.1.1.1.3.1.cmml" xref="S3.E9.m1.12.12">subscript</csymbol><ci id="S3.E9.m1.7.7.7.7.7.7.cmml" xref="S3.E9.m1.7.7.7.7.7.7">𝐶</ci><ci id="S3.E9.m1.8.8.8.8.8.8.1.cmml" xref="S3.E9.m1.8.8.8.8.8.8.1">𝑖</ci></apply></apply><apply id="S3.E9.m1.14.14.2.2.2.2.cmml" xref="S3.E9.m1.12.12"><times id="S3.E9.m1.14.14.2.2.2.2.1.cmml" xref="S3.E9.m1.12.12"></times><ci id="S3.E9.m1.10.10.10.10.10.10a.cmml" xref="S3.E9.m1.10.10.10.10.10.10"><mtext id="S3.E9.m1.10.10.10.10.10.10.cmml" xref="S3.E9.m1.10.10.10.10.10.10">Where in client j</mtext></ci><ci id="S3.E9.m1.11.11.11.1.1.1a.cmml" xref="S3.E9.m1.11.11.11.1.1.1"><mtext id="S3.E9.m1.11.11.11.1.1.1.cmml" xref="S3.E9.m1.11.11.11.1.1.1">validation loss has decreased</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.14c">V_{i}=\{j\in C_{i}:\text{Where in client j}\\
\text{validation loss has decreased}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.15" class="ltx_Math" alttext="V^{c}_{i}=\{l\in V_{i}:\text{Where client l is a}\\
\text{random selection}\}" display="block"><semantics id="S3.E10.m1.15a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E10.m1.13.13" xref="S3.E10.m1.15.15.2.cmml"><mtr id="S3.E10.m1.13.13a" xref="S3.E10.m1.15.15.2.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E10.m1.13.13b" xref="S3.E10.m1.15.15.2.cmml"><mrow id="S3.E10.m1.11.11.11.11.11" xref="S3.E10.m1.15.15.2.cmml"><msubsup id="S3.E10.m1.11.11.11.11.11.12" xref="S3.E10.m1.15.15.2.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml">V</mi><mi id="S3.E10.m1.3.3.3.3.3.3.1" xref="S3.E10.m1.3.3.3.3.3.3.1.cmml">i</mi><mi id="S3.E10.m1.2.2.2.2.2.2.1" xref="S3.E10.m1.2.2.2.2.2.2.1.cmml">c</mi></msubsup><mo id="S3.E10.m1.4.4.4.4.4.4" xref="S3.E10.m1.4.4.4.4.4.4.cmml">=</mo><mrow id="S3.E10.m1.11.11.11.11.11.13" xref="S3.E10.m1.15.15.2.cmml"><mo stretchy="false" id="S3.E10.m1.5.5.5.5.5.5" xref="S3.E10.m1.15.15.2.cmml">{</mo><mi id="S3.E10.m1.6.6.6.6.6.6" xref="S3.E10.m1.6.6.6.6.6.6.cmml">l</mi><mo id="S3.E10.m1.7.7.7.7.7.7" xref="S3.E10.m1.7.7.7.7.7.7.cmml">∈</mo><msub id="S3.E10.m1.11.11.11.11.11.13.1" xref="S3.E10.m1.15.15.2.cmml"><mi id="S3.E10.m1.8.8.8.8.8.8" xref="S3.E10.m1.8.8.8.8.8.8.cmml">V</mi><mi id="S3.E10.m1.9.9.9.9.9.9.1" xref="S3.E10.m1.9.9.9.9.9.9.1.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.E10.m1.10.10.10.10.10.10" xref="S3.E10.m1.15.15.2.cmml">:</mo><mtext id="S3.E10.m1.11.11.11.11.11.11" xref="S3.E10.m1.11.11.11.11.11.11a.cmml">Where client l is a</mtext></mrow></mrow></mtd></mtr><mtr id="S3.E10.m1.13.13c" xref="S3.E10.m1.15.15.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E10.m1.13.13d" xref="S3.E10.m1.15.15.2.cmml"><mrow id="S3.E10.m1.13.13.13.2.2" xref="S3.E10.m1.15.15.2.cmml"><mtext id="S3.E10.m1.12.12.12.1.1.1" xref="S3.E10.m1.12.12.12.1.1.1a.cmml">random selection</mtext><mo stretchy="false" id="S3.E10.m1.13.13.13.2.2.2" xref="S3.E10.m1.15.15.2.cmml">}</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E10.m1.15b"><apply id="S3.E10.m1.15.15.2.cmml" xref="S3.E10.m1.13.13"><eq id="S3.E10.m1.4.4.4.4.4.4.cmml" xref="S3.E10.m1.4.4.4.4.4.4"></eq><apply id="S3.E10.m1.15.15.2.4.cmml" xref="S3.E10.m1.13.13"><csymbol cd="ambiguous" id="S3.E10.m1.15.15.2.4.1.cmml" xref="S3.E10.m1.13.13">subscript</csymbol><apply id="S3.E10.m1.15.15.2.4.2.cmml" xref="S3.E10.m1.13.13"><csymbol cd="ambiguous" id="S3.E10.m1.15.15.2.4.2.1.cmml" xref="S3.E10.m1.13.13">superscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1">𝑉</ci><ci id="S3.E10.m1.2.2.2.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2.2.2.2.1">𝑐</ci></apply><ci id="S3.E10.m1.3.3.3.3.3.3.1.cmml" xref="S3.E10.m1.3.3.3.3.3.3.1">𝑖</ci></apply><apply id="S3.E10.m1.15.15.2.2.3.cmml" xref="S3.E10.m1.13.13"><csymbol cd="latexml" id="S3.E10.m1.15.15.2.2.3.1.cmml" xref="S3.E10.m1.13.13">conditional-set</csymbol><apply id="S3.E10.m1.14.14.1.1.1.1.cmml" xref="S3.E10.m1.13.13"><in id="S3.E10.m1.7.7.7.7.7.7.cmml" xref="S3.E10.m1.7.7.7.7.7.7"></in><ci id="S3.E10.m1.6.6.6.6.6.6.cmml" xref="S3.E10.m1.6.6.6.6.6.6">𝑙</ci><apply id="S3.E10.m1.14.14.1.1.1.1.3.cmml" xref="S3.E10.m1.13.13"><csymbol cd="ambiguous" id="S3.E10.m1.14.14.1.1.1.1.3.1.cmml" xref="S3.E10.m1.13.13">subscript</csymbol><ci id="S3.E10.m1.8.8.8.8.8.8.cmml" xref="S3.E10.m1.8.8.8.8.8.8">𝑉</ci><ci id="S3.E10.m1.9.9.9.9.9.9.1.cmml" xref="S3.E10.m1.9.9.9.9.9.9.1">𝑖</ci></apply></apply><apply id="S3.E10.m1.15.15.2.2.2.2.cmml" xref="S3.E10.m1.13.13"><times id="S3.E10.m1.15.15.2.2.2.2.1.cmml" xref="S3.E10.m1.13.13"></times><ci id="S3.E10.m1.11.11.11.11.11.11a.cmml" xref="S3.E10.m1.11.11.11.11.11.11"><mtext id="S3.E10.m1.11.11.11.11.11.11.cmml" xref="S3.E10.m1.11.11.11.11.11.11">Where client l is a</mtext></ci><ci id="S3.E10.m1.12.12.12.1.1.1a.cmml" xref="S3.E10.m1.12.12.12.1.1.1"><mtext id="S3.E10.m1.12.12.12.1.1.1.cmml" xref="S3.E10.m1.12.12.12.1.1.1">random selection</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.15c">V^{c}_{i}=\{l\in V_{i}:\text{Where client l is a}\\
\text{random selection}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p10" class="ltx_para">
<p id="S3.SS2.p10.3" class="ltx_p">We will now have to select the right clients <math id="S3.SS2.p10.1.m1.1" class="ltx_Math" alttext="C_{i+1}" display="inline"><semantics id="S3.SS2.p10.1.m1.1a"><msub id="S3.SS2.p10.1.m1.1.1" xref="S3.SS2.p10.1.m1.1.1.cmml"><mi id="S3.SS2.p10.1.m1.1.1.2" xref="S3.SS2.p10.1.m1.1.1.2.cmml">C</mi><mrow id="S3.SS2.p10.1.m1.1.1.3" xref="S3.SS2.p10.1.m1.1.1.3.cmml"><mi id="S3.SS2.p10.1.m1.1.1.3.2" xref="S3.SS2.p10.1.m1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p10.1.m1.1.1.3.1" xref="S3.SS2.p10.1.m1.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p10.1.m1.1.1.3.3" xref="S3.SS2.p10.1.m1.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.1.m1.1b"><apply id="S3.SS2.p10.1.m1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.1.m1.1.1.1.cmml" xref="S3.SS2.p10.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p10.1.m1.1.1.2.cmml" xref="S3.SS2.p10.1.m1.1.1.2">𝐶</ci><apply id="S3.SS2.p10.1.m1.1.1.3.cmml" xref="S3.SS2.p10.1.m1.1.1.3"><plus id="S3.SS2.p10.1.m1.1.1.3.1.cmml" xref="S3.SS2.p10.1.m1.1.1.3.1"></plus><ci id="S3.SS2.p10.1.m1.1.1.3.2.cmml" xref="S3.SS2.p10.1.m1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p10.1.m1.1.1.3.3.cmml" xref="S3.SS2.p10.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.1.m1.1c">C_{i+1}</annotation></semantics></math> for the next round, and correspondingly compute the losses using Focal Loss. When <math id="S3.SS2.p10.2.m2.1" class="ltx_Math" alttext="i=0" display="inline"><semantics id="S3.SS2.p10.2.m2.1a"><mrow id="S3.SS2.p10.2.m2.1.1" xref="S3.SS2.p10.2.m2.1.1.cmml"><mi id="S3.SS2.p10.2.m2.1.1.2" xref="S3.SS2.p10.2.m2.1.1.2.cmml">i</mi><mo id="S3.SS2.p10.2.m2.1.1.1" xref="S3.SS2.p10.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p10.2.m2.1.1.3" xref="S3.SS2.p10.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.2.m2.1b"><apply id="S3.SS2.p10.2.m2.1.1.cmml" xref="S3.SS2.p10.2.m2.1.1"><eq id="S3.SS2.p10.2.m2.1.1.1.cmml" xref="S3.SS2.p10.2.m2.1.1.1"></eq><ci id="S3.SS2.p10.2.m2.1.1.2.cmml" xref="S3.SS2.p10.2.m2.1.1.2">𝑖</ci><cn type="integer" id="S3.SS2.p10.2.m2.1.1.3.cmml" xref="S3.SS2.p10.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.2.m2.1c">i=0</annotation></semantics></math>, which is the first training cycle <math id="S3.SS2.p10.3.m3.1" class="ltx_Math" alttext="C_{0}" display="inline"><semantics id="S3.SS2.p10.3.m3.1a"><msub id="S3.SS2.p10.3.m3.1.1" xref="S3.SS2.p10.3.m3.1.1.cmml"><mi id="S3.SS2.p10.3.m3.1.1.2" xref="S3.SS2.p10.3.m3.1.1.2.cmml">C</mi><mn id="S3.SS2.p10.3.m3.1.1.3" xref="S3.SS2.p10.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p10.3.m3.1b"><apply id="S3.SS2.p10.3.m3.1.1.cmml" xref="S3.SS2.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p10.3.m3.1.1.1.cmml" xref="S3.SS2.p10.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p10.3.m3.1.1.2.cmml" xref="S3.SS2.p10.3.m3.1.1.2">𝐶</ci><cn type="integer" id="S3.SS2.p10.3.m3.1.1.3.cmml" xref="S3.SS2.p10.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p10.3.m3.1c">C_{0}</annotation></semantics></math> will be randomly selected.</p>
</div>
<div id="S3.SS2.p11" class="ltx_para">
<table id="Sx2.EGx4" class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table">

<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1.1" class="ltx_math_unparsed" alttext="\displaystyle k=|V^{c}_{i}" display="block"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1b"><mi id="S3.E11.m1.1.1">k</mi><mo rspace="0em" id="S3.E11.m1.1.2">=</mo><mo fence="false" rspace="0.167em" stretchy="false" id="S3.E11.m1.1.3">|</mo><msubsup id="S3.E11.m1.1.4"><mi id="S3.E11.m1.1.4.2.2">V</mi><mi id="S3.E11.m1.1.4.3">i</mi><mi id="S3.E11.m1.1.4.2.3">c</mi></msubsup></mrow><annotation encoding="application/x-tex" id="S3.E11.m1.1c">\displaystyle k=|V^{c}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1.1" class="ltx_Math" alttext="\displaystyle R_{i+1}=\text{Random selection of any}(K-k)\text{clients}" display="block"><semantics id="S3.E12.m1.1a"><mrow id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml"><msub id="S3.E12.m1.1.1.3" xref="S3.E12.m1.1.1.3.cmml"><mi id="S3.E12.m1.1.1.3.2" xref="S3.E12.m1.1.1.3.2.cmml">R</mi><mrow id="S3.E12.m1.1.1.3.3" xref="S3.E12.m1.1.1.3.3.cmml"><mi id="S3.E12.m1.1.1.3.3.2" xref="S3.E12.m1.1.1.3.3.2.cmml">i</mi><mo id="S3.E12.m1.1.1.3.3.1" xref="S3.E12.m1.1.1.3.3.1.cmml">+</mo><mn id="S3.E12.m1.1.1.3.3.3" xref="S3.E12.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.E12.m1.1.1.2" xref="S3.E12.m1.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.1.1.1" xref="S3.E12.m1.1.1.1.cmml"><mtext id="S3.E12.m1.1.1.1.3" xref="S3.E12.m1.1.1.1.3a.cmml">Random selection of any</mtext><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.2" xref="S3.E12.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E12.m1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.2.cmml">K</mi><mo id="S3.E12.m1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E12.m1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="S3.E12.m1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E12.m1.1.1.1.2a" xref="S3.E12.m1.1.1.1.2.cmml">​</mo><mtext id="S3.E12.m1.1.1.1.4" xref="S3.E12.m1.1.1.1.4a.cmml">clients</mtext></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1"><eq id="S3.E12.m1.1.1.2.cmml" xref="S3.E12.m1.1.1.2"></eq><apply id="S3.E12.m1.1.1.3.cmml" xref="S3.E12.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.3.1.cmml" xref="S3.E12.m1.1.1.3">subscript</csymbol><ci id="S3.E12.m1.1.1.3.2.cmml" xref="S3.E12.m1.1.1.3.2">𝑅</ci><apply id="S3.E12.m1.1.1.3.3.cmml" xref="S3.E12.m1.1.1.3.3"><plus id="S3.E12.m1.1.1.3.3.1.cmml" xref="S3.E12.m1.1.1.3.3.1"></plus><ci id="S3.E12.m1.1.1.3.3.2.cmml" xref="S3.E12.m1.1.1.3.3.2">𝑖</ci><cn type="integer" id="S3.E12.m1.1.1.3.3.3.cmml" xref="S3.E12.m1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E12.m1.1.1.1.cmml" xref="S3.E12.m1.1.1.1"><times id="S3.E12.m1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.2"></times><ci id="S3.E12.m1.1.1.1.3a.cmml" xref="S3.E12.m1.1.1.1.3"><mtext id="S3.E12.m1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.3">Random selection of any</mtext></ci><apply id="S3.E12.m1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1"><minus id="S3.E12.m1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1"></minus><ci id="S3.E12.m1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.2">𝐾</ci><ci id="S3.E12.m1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.3">𝑘</ci></apply><ci id="S3.E12.m1.1.1.1.4a.cmml" xref="S3.E12.m1.1.1.1.4"><mtext id="S3.E12.m1.1.1.1.4.cmml" xref="S3.E12.m1.1.1.1.4">clients</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\displaystyle R_{i+1}=\text{Random selection of any}(K-k)\text{clients}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1.1" class="ltx_Math" alttext="\displaystyle C_{i+1}=V^{c}_{i}\cup R_{i+1}" display="block"><semantics id="S3.E13.m1.1a"><mrow id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml"><msub id="S3.E13.m1.1.1.2" xref="S3.E13.m1.1.1.2.cmml"><mi id="S3.E13.m1.1.1.2.2" xref="S3.E13.m1.1.1.2.2.cmml">C</mi><mrow id="S3.E13.m1.1.1.2.3" xref="S3.E13.m1.1.1.2.3.cmml"><mi id="S3.E13.m1.1.1.2.3.2" xref="S3.E13.m1.1.1.2.3.2.cmml">i</mi><mo id="S3.E13.m1.1.1.2.3.1" xref="S3.E13.m1.1.1.2.3.1.cmml">+</mo><mn id="S3.E13.m1.1.1.2.3.3" xref="S3.E13.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S3.E13.m1.1.1.1" xref="S3.E13.m1.1.1.1.cmml">=</mo><mrow id="S3.E13.m1.1.1.3" xref="S3.E13.m1.1.1.3.cmml"><msubsup id="S3.E13.m1.1.1.3.2" xref="S3.E13.m1.1.1.3.2.cmml"><mi id="S3.E13.m1.1.1.3.2.2.2" xref="S3.E13.m1.1.1.3.2.2.2.cmml">V</mi><mi id="S3.E13.m1.1.1.3.2.3" xref="S3.E13.m1.1.1.3.2.3.cmml">i</mi><mi id="S3.E13.m1.1.1.3.2.2.3" xref="S3.E13.m1.1.1.3.2.2.3.cmml">c</mi></msubsup><mo id="S3.E13.m1.1.1.3.1" xref="S3.E13.m1.1.1.3.1.cmml">∪</mo><msub id="S3.E13.m1.1.1.3.3" xref="S3.E13.m1.1.1.3.3.cmml"><mi id="S3.E13.m1.1.1.3.3.2" xref="S3.E13.m1.1.1.3.3.2.cmml">R</mi><mrow id="S3.E13.m1.1.1.3.3.3" xref="S3.E13.m1.1.1.3.3.3.cmml"><mi id="S3.E13.m1.1.1.3.3.3.2" xref="S3.E13.m1.1.1.3.3.3.2.cmml">i</mi><mo id="S3.E13.m1.1.1.3.3.3.1" xref="S3.E13.m1.1.1.3.3.3.1.cmml">+</mo><mn id="S3.E13.m1.1.1.3.3.3.3" xref="S3.E13.m1.1.1.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.1b"><apply id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1"><eq id="S3.E13.m1.1.1.1.cmml" xref="S3.E13.m1.1.1.1"></eq><apply id="S3.E13.m1.1.1.2.cmml" xref="S3.E13.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.2.1.cmml" xref="S3.E13.m1.1.1.2">subscript</csymbol><ci id="S3.E13.m1.1.1.2.2.cmml" xref="S3.E13.m1.1.1.2.2">𝐶</ci><apply id="S3.E13.m1.1.1.2.3.cmml" xref="S3.E13.m1.1.1.2.3"><plus id="S3.E13.m1.1.1.2.3.1.cmml" xref="S3.E13.m1.1.1.2.3.1"></plus><ci id="S3.E13.m1.1.1.2.3.2.cmml" xref="S3.E13.m1.1.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E13.m1.1.1.2.3.3.cmml" xref="S3.E13.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E13.m1.1.1.3.cmml" xref="S3.E13.m1.1.1.3"><union id="S3.E13.m1.1.1.3.1.cmml" xref="S3.E13.m1.1.1.3.1"></union><apply id="S3.E13.m1.1.1.3.2.cmml" xref="S3.E13.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.3.2.1.cmml" xref="S3.E13.m1.1.1.3.2">subscript</csymbol><apply id="S3.E13.m1.1.1.3.2.2.cmml" xref="S3.E13.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.3.2.2.1.cmml" xref="S3.E13.m1.1.1.3.2">superscript</csymbol><ci id="S3.E13.m1.1.1.3.2.2.2.cmml" xref="S3.E13.m1.1.1.3.2.2.2">𝑉</ci><ci id="S3.E13.m1.1.1.3.2.2.3.cmml" xref="S3.E13.m1.1.1.3.2.2.3">𝑐</ci></apply><ci id="S3.E13.m1.1.1.3.2.3.cmml" xref="S3.E13.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E13.m1.1.1.3.3.cmml" xref="S3.E13.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.3.3.1.cmml" xref="S3.E13.m1.1.1.3.3">subscript</csymbol><ci id="S3.E13.m1.1.1.3.3.2.cmml" xref="S3.E13.m1.1.1.3.3.2">𝑅</ci><apply id="S3.E13.m1.1.1.3.3.3.cmml" xref="S3.E13.m1.1.1.3.3.3"><plus id="S3.E13.m1.1.1.3.3.3.1.cmml" xref="S3.E13.m1.1.1.3.3.3.1"></plus><ci id="S3.E13.m1.1.1.3.3.3.2.cmml" xref="S3.E13.m1.1.1.3.3.3.2">𝑖</ci><cn type="integer" id="S3.E13.m1.1.1.3.3.3.3.cmml" xref="S3.E13.m1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.1c">\displaystyle C_{i+1}=V^{c}_{i}\cup R_{i+1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p12" class="ltx_para">
<p id="S3.SS2.p12.1" class="ltx_p">The server now has its focus on clients that are performing well. If <math id="S3.SS2.p12.1.m1.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S3.SS2.p12.1.m1.1a"><mi id="S3.SS2.p12.1.m1.1.1" xref="S3.SS2.p12.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p12.1.m1.1b"><ci id="S3.SS2.p12.1.m1.1.1.cmml" xref="S3.SS2.p12.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p12.1.m1.1c">\psi</annotation></semantics></math> is tuned appropriately, as shown in the experiments, it will smoothen the training and improve accuracy.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<table id="S3.T2.20" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.20.21.1" class="ltx_tr">
<th id="S3.T2.20.21.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S3.T2.20.21.1.1.1" class="ltx_text ltx_font_bold">Method</span></th>
<th id="S3.T2.20.21.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.20.21.1.2.1" class="ltx_text ltx_font_bold">MNIST</span></th>
<th id="S3.T2.20.21.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.20.21.1.3.1" class="ltx_text ltx_font_bold">Sampled-FEMNIST</span></th>
<th id="S3.T2.20.21.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.20.21.1.4.1" class="ltx_text ltx_font_bold">VSN</span></th>
<th id="S3.T2.20.21.1.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.20.21.1.5.1" class="ltx_text ltx_font_bold">HAR</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.4.4" class="ltx_tr">
<th id="S3.T2.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Global</th>
<td id="S3.T2.1.1.1" class="ltx_td ltx_align_left ltx_border_t">0.9678<math id="S3.T2.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.1.1.1.m1.1a"><mo id="S3.T2.1.1.1.m1.1.1" xref="S3.T2.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.m1.1c">\pm</annotation></semantics></math>0.0007</td>
<td id="S3.T2.2.2.2" class="ltx_td ltx_align_left ltx_border_t">0.8326<math id="S3.T2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.2.2.2.m1.1a"><mo id="S3.T2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.m1.1b"><csymbol cd="latexml" id="S3.T2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.m1.1c">\pm</annotation></semantics></math>0.008</td>
<td id="S3.T2.3.3.3" class="ltx_td ltx_align_left ltx_border_t">0.926<math id="S3.T2.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.3.3.3.m1.1a"><mo id="S3.T2.3.3.3.m1.1.1" xref="S3.T2.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.3.3.3.m1.1b"><csymbol cd="latexml" id="S3.T2.3.3.3.m1.1.1.cmml" xref="S3.T2.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.3.3.3.m1.1c">\pm</annotation></semantics></math>0.004</td>
<td id="S3.T2.4.4.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0.797<math id="S3.T2.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.4.4.4.m1.1a"><mo id="S3.T2.4.4.4.m1.1.1" xref="S3.T2.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.4.4.4.m1.1b"><csymbol cd="latexml" id="S3.T2.4.4.4.m1.1.1.cmml" xref="S3.T2.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.4.4.4.m1.1c">\pm</annotation></semantics></math>0.006</td>
</tr>
<tr id="S3.T2.8.8" class="ltx_tr">
<th id="S3.T2.8.8.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Local</th>
<td id="S3.T2.5.5.1" class="ltx_td ltx_align_left">0.9511<math id="S3.T2.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.5.5.1.m1.1a"><mo id="S3.T2.5.5.1.m1.1.1" xref="S3.T2.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.5.5.1.m1.1b"><csymbol cd="latexml" id="S3.T2.5.5.1.m1.1.1.cmml" xref="S3.T2.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.5.5.1.m1.1c">\pm</annotation></semantics></math>0.0020</td>
<td id="S3.T2.6.6.2" class="ltx_td ltx_align_left">0.8299<math id="S3.T2.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.6.6.2.m1.1a"><mo id="S3.T2.6.6.2.m1.1.1" xref="S3.T2.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.6.6.2.m1.1b"><csymbol cd="latexml" id="S3.T2.6.6.2.m1.1.1.cmml" xref="S3.T2.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.6.6.2.m1.1c">\pm</annotation></semantics></math>0.005</td>
<td id="S3.T2.7.7.3" class="ltx_td ltx_align_left">0.960<math id="S3.T2.7.7.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.7.7.3.m1.1a"><mo id="S3.T2.7.7.3.m1.1.1" xref="S3.T2.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.7.7.3.m1.1b"><csymbol cd="latexml" id="S3.T2.7.7.3.m1.1.1.cmml" xref="S3.T2.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.7.7.3.m1.1c">\pm</annotation></semantics></math>0.003</td>
<td id="S3.T2.8.8.4" class="ltx_td ltx_nopad_r ltx_align_left">0.940<math id="S3.T2.8.8.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.8.8.4.m1.1a"><mo id="S3.T2.8.8.4.m1.1.1" xref="S3.T2.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.8.8.4.m1.1b"><csymbol cd="latexml" id="S3.T2.8.8.4.m1.1.1.cmml" xref="S3.T2.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.8.8.4.m1.1c">\pm</annotation></semantics></math>0.001</td>
</tr>
<tr id="S3.T2.12.12" class="ltx_tr">
<th id="S3.T2.12.12.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedAvg</th>
<td id="S3.T2.9.9.1" class="ltx_td ltx_align_left">0.9675<math id="S3.T2.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.9.9.1.m1.1a"><mo id="S3.T2.9.9.1.m1.1.1" xref="S3.T2.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.9.9.1.m1.1b"><csymbol cd="latexml" id="S3.T2.9.9.1.m1.1.1.cmml" xref="S3.T2.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.9.9.1.m1.1c">\pm</annotation></semantics></math>0.0004</td>
<td id="S3.T2.10.10.2" class="ltx_td ltx_align_left">0.8319<math id="S3.T2.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.10.10.2.m1.1a"><mo id="S3.T2.10.10.2.m1.1.1" xref="S3.T2.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.10.10.2.m1.1b"><csymbol cd="latexml" id="S3.T2.10.10.2.m1.1.1.cmml" xref="S3.T2.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.10.10.2.m1.1c">\pm</annotation></semantics></math>0.003</td>
<td id="S3.T2.11.11.3" class="ltx_td ltx_align_left">0.916<math id="S3.T2.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.11.11.3.m1.1a"><mo id="S3.T2.11.11.3.m1.1.1" xref="S3.T2.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.11.11.3.m1.1b"><csymbol cd="latexml" id="S3.T2.11.11.3.m1.1.1.cmml" xref="S3.T2.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.11.11.3.m1.1c">\pm</annotation></semantics></math>0.007</td>
<td id="S3.T2.12.12.4" class="ltx_td ltx_nopad_r ltx_align_left">0.944<math id="S3.T2.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.12.12.4.m1.1a"><mo id="S3.T2.12.12.4.m1.1.1" xref="S3.T2.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.12.12.4.m1.1b"><csymbol cd="latexml" id="S3.T2.12.12.4.m1.1.1.cmml" xref="S3.T2.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.12.12.4.m1.1c">\pm</annotation></semantics></math>0.004</td>
</tr>
<tr id="S3.T2.16.16" class="ltx_tr">
<th id="S3.T2.16.16.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Virtual(CE)</th>
<td id="S3.T2.13.13.1" class="ltx_td ltx_align_left">0.9666<math id="S3.T2.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.13.13.1.m1.1a"><mo id="S3.T2.13.13.1.m1.1.1" xref="S3.T2.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.13.13.1.m1.1b"><csymbol cd="latexml" id="S3.T2.13.13.1.m1.1.1.cmml" xref="S3.T2.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.13.13.1.m1.1c">\pm</annotation></semantics></math>0.0017</td>
<td id="S3.T2.14.14.2" class="ltx_td ltx_align_left">0.8147<math id="S3.T2.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.14.14.2.m1.1a"><mo id="S3.T2.14.14.2.m1.1.1" xref="S3.T2.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.14.14.2.m1.1b"><csymbol cd="latexml" id="S3.T2.14.14.2.m1.1.1.cmml" xref="S3.T2.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.14.14.2.m1.1c">\pm</annotation></semantics></math>0.01</td>
<td id="S3.T2.15.15.3" class="ltx_td ltx_align_left">0.9340<math id="S3.T2.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.15.15.3.m1.1a"><mo id="S3.T2.15.15.3.m1.1.1" xref="S3.T2.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.15.15.3.m1.1b"><csymbol cd="latexml" id="S3.T2.15.15.3.m1.1.1.cmml" xref="S3.T2.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.15.15.3.m1.1c">\pm</annotation></semantics></math>0.002</td>
<td id="S3.T2.16.16.4" class="ltx_td ltx_nopad_r ltx_align_left">0.9680<math id="S3.T2.16.16.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.16.16.4.m1.1a"><mo id="S3.T2.16.16.4.m1.1.1" xref="S3.T2.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.16.16.4.m1.1b"><csymbol cd="latexml" id="S3.T2.16.16.4.m1.1.1.cmml" xref="S3.T2.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.16.16.4.m1.1c">\pm</annotation></semantics></math>0.001</td>
</tr>
<tr id="S3.T2.20.20" class="ltx_tr">
<th id="S3.T2.20.20.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Virtual(FFL)</th>
<td id="S3.T2.17.17.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S3.T2.17.17.1.1" class="ltx_text ltx_font_bold">0.9690<math id="S3.T2.17.17.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.17.17.1.1.m1.1a"><mo id="S3.T2.17.17.1.1.m1.1.1" xref="S3.T2.17.17.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.17.17.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.17.17.1.1.m1.1.1.cmml" xref="S3.T2.17.17.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.17.17.1.1.m1.1c">\pm</annotation></semantics></math>0.0010</span></td>
<td id="S3.T2.18.18.2" class="ltx_td ltx_align_left ltx_border_bb"><span id="S3.T2.18.18.2.1" class="ltx_text ltx_font_bold">0.8315<math id="S3.T2.18.18.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.18.18.2.1.m1.1a"><mo id="S3.T2.18.18.2.1.m1.1.1" xref="S3.T2.18.18.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.18.18.2.1.m1.1b"><csymbol cd="latexml" id="S3.T2.18.18.2.1.m1.1.1.cmml" xref="S3.T2.18.18.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.18.18.2.1.m1.1c">\pm</annotation></semantics></math>0.01</span></td>
<td id="S3.T2.19.19.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S3.T2.19.19.3.1" class="ltx_text ltx_font_bold">0.9412<math id="S3.T2.19.19.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.19.19.3.1.m1.1a"><mo id="S3.T2.19.19.3.1.m1.1.1" xref="S3.T2.19.19.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.19.19.3.1.m1.1b"><csymbol cd="latexml" id="S3.T2.19.19.3.1.m1.1.1.cmml" xref="S3.T2.19.19.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.19.19.3.1.m1.1c">\pm</annotation></semantics></math>0.002</span></td>
<td id="S3.T2.20.20.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb"><span id="S3.T2.20.20.4.1" class="ltx_text ltx_font_bold">0.9692<math id="S3.T2.20.20.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T2.20.20.4.1.m1.1a"><mo id="S3.T2.20.20.4.1.m1.1.1" xref="S3.T2.20.20.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T2.20.20.4.1.m1.1b"><csymbol cd="latexml" id="S3.T2.20.20.4.1.m1.1.1.cmml" xref="S3.T2.20.20.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.20.20.4.1.m1.1c">\pm</annotation></semantics></math>0.002</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T2.22.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S3.T2.23.2" class="ltx_text" style="font-size:90%;">Multi-task average test accuracy on balanced dataset</span></figcaption>
</figure>
<figure id="S3.T3" class="ltx_table">
<table id="S3.T3.8" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.8.9.1" class="ltx_tr">
<th id="S3.T3.8.9.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S3.T3.8.9.1.1.1" class="ltx_text ltx_font_bold">Loss function</span></th>
<th id="S3.T3.8.9.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.8.9.1.2.1" class="ltx_text ltx_font_bold">MNIST</span></th>
<th id="S3.T3.8.9.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.8.9.1.3.1" class="ltx_text ltx_font_bold">FEMNIST</span></th>
<th id="S3.T3.8.9.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.8.9.1.4.1" class="ltx_text ltx_font_bold">VSN</span></th>
<th id="S3.T3.8.9.1.5" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S3.T3.8.9.1.5.1" class="ltx_text ltx_font_bold">HAR</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.4.4" class="ltx_tr">
<th id="S3.T3.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Cross-entropy</th>
<td id="S3.T3.1.1.1" class="ltx_td ltx_align_left ltx_border_t">0.6660<math id="S3.T3.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.1.1.1.m1.1a"><mo id="S3.T3.1.1.1.m1.1.1" xref="S3.T3.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T3.1.1.1.m1.1.1.cmml" xref="S3.T3.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.1.1.1.m1.1c">\pm</annotation></semantics></math>0.0015</td>
<td id="S3.T3.2.2.2" class="ltx_td ltx_align_left ltx_border_t">0.6750<math id="S3.T3.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.2.2.2.m1.1a"><mo id="S3.T3.2.2.2.m1.1.1" xref="S3.T3.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.2.2.2.m1.1b"><csymbol cd="latexml" id="S3.T3.2.2.2.m1.1.1.cmml" xref="S3.T3.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.2.2.2.m1.1c">\pm</annotation></semantics></math>0.01</td>
<td id="S3.T3.3.3.3" class="ltx_td ltx_align_left ltx_border_t">0.7981<math id="S3.T3.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.3.3.3.m1.1a"><mo id="S3.T3.3.3.3.m1.1.1" xref="S3.T3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.3.3.3.m1.1b"><csymbol cd="latexml" id="S3.T3.3.3.3.m1.1.1.cmml" xref="S3.T3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.3.3.3.m1.1c">\pm</annotation></semantics></math>0.002</td>
<td id="S3.T3.4.4.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0.8205<math id="S3.T3.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.4.4.4.m1.1a"><mo id="S3.T3.4.4.4.m1.1.1" xref="S3.T3.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.4.4.4.m1.1b"><csymbol cd="latexml" id="S3.T3.4.4.4.m1.1.1.cmml" xref="S3.T3.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.4.4.4.m1.1c">\pm</annotation></semantics></math>0.001</td>
</tr>
<tr id="S3.T3.8.8" class="ltx_tr">
<th id="S3.T3.8.8.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Fed-Focal</th>
<td id="S3.T3.5.5.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S3.T3.5.5.1.1" class="ltx_text ltx_font_bold">0.7591<math id="S3.T3.5.5.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.5.5.1.1.m1.1a"><mo id="S3.T3.5.5.1.1.m1.1.1" xref="S3.T3.5.5.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.5.5.1.1.m1.1b"><csymbol cd="latexml" id="S3.T3.5.5.1.1.m1.1.1.cmml" xref="S3.T3.5.5.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.5.5.1.1.m1.1c">\pm</annotation></semantics></math>0.0012</span></td>
<td id="S3.T3.6.6.2" class="ltx_td ltx_align_left ltx_border_bb"><span id="S3.T3.6.6.2.1" class="ltx_text ltx_font_bold">0.7555<math id="S3.T3.6.6.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.6.6.2.1.m1.1a"><mo id="S3.T3.6.6.2.1.m1.1.1" xref="S3.T3.6.6.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.6.6.2.1.m1.1b"><csymbol cd="latexml" id="S3.T3.6.6.2.1.m1.1.1.cmml" xref="S3.T3.6.6.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.6.6.2.1.m1.1c">\pm</annotation></semantics></math>0.01</span></td>
<td id="S3.T3.7.7.3" class="ltx_td ltx_align_left ltx_border_bb"><span id="S3.T3.7.7.3.1" class="ltx_text ltx_font_bold">0.8249<math id="S3.T3.7.7.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.7.7.3.1.m1.1a"><mo id="S3.T3.7.7.3.1.m1.1.1" xref="S3.T3.7.7.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.7.7.3.1.m1.1b"><csymbol cd="latexml" id="S3.T3.7.7.3.1.m1.1.1.cmml" xref="S3.T3.7.7.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.7.7.3.1.m1.1c">\pm</annotation></semantics></math>0.002</span></td>
<td id="S3.T3.8.8.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb"><span id="S3.T3.8.8.4.1" class="ltx_text ltx_font_bold">0.8501<math id="S3.T3.8.8.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S3.T3.8.8.4.1.m1.1a"><mo id="S3.T3.8.8.4.1.m1.1.1" xref="S3.T3.8.8.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T3.8.8.4.1.m1.1b"><csymbol cd="latexml" id="S3.T3.8.8.4.1.m1.1.1.cmml" xref="S3.T3.8.8.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T3.8.8.4.1.m1.1c">\pm</annotation></semantics></math>0.004</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S3.T3.10.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S3.T3.11.2" class="ltx_text" style="font-size:90%;">Test accuracy using VIRTUAL on unbalanced dataset</span></figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we present the empirical evaluation of the performance of Fed-Focal Loss on various standard federated datasets. We have used the VIRTUAL codebase, as it is a state of the art FL algorithm and extended it with our loss function.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We have listed the nature of the datasets in Table 1.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p"><span id="S4.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">MNIST:</span> The dataset contains a total of 70,000 small square 28x28 pixels grayscale images of handwritten single digits between 0 and 9. The subdivision of dataset is 60,000 training samples and 10,000 testing samples. We federated the dataset amongst the clients to simulate the real world MTL.</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p"><span id="S4.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Sampled-FEMNIST:</span> This dataset consists of a federated version of the EMNIST dataset, maintained by the LEAF project. We sampled 10,000 training and 1000 testing samples to simulate the real world MTL. We selected this dataset with the specified sampling volume to simulate the MTL in a real-world environment where the dataset is scarce.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><span id="S4.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Vehicle Sensors Network (VSN):</span> A network of 23 different sensors (including seismic, acoustic and passive infra-red sensors) are placed around a road segment in order to classify vehicles driving by them [Duarte and Hu, 2004]. The raw signal is processed in the original paper into 50 acoustic and 50 seismic features. We consider every sensor as a client and perform binary classification of amphibious assault vehicles and dragon wagon vehicles.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p"><span id="S4.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">Human Activity Recognition (HAR):</span> Recordings of 30 subjects performing daily activities are collected using a waist-mounted smartphone with inertial sensors. The raw signal is divided into windows and processed into a 561-length vector [D Anguita <span id="S4.I1.i4.p1.1.2" class="ltx_text ltx_font_italic">et al.</span>, 2013]. Every individual corresponds to a different client, and we perform a classification of 6 different activities (e.g. sitting, walking).</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Settings</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">All networks employed are multilayer perceptrons (MLP) with two hidden dense Flipout layers with 100 units, and ReLU activation functions and final layer is of 10 units and softmax activation function. The Monte Carlo estimate of the gradient is performed in all experiments using a ratio of 0.10 clients in each round (unless specified otherwise).</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">We use the VIRTUAL as a testbed for comparing the loss function, due to its ability to handle skewed data by design. Given that it has outperformed FedAvg, we see it as a useful framework for our work.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.5" class="ltx_p">In all the experiments, we evaluate Fed-Focal Loss (FFL) while incrementally training the clients in a fixed order of the sampled clients with one refinement per client. We used <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">α</mi><mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><eq id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></eq><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">\alpha=1.0</annotation></semantics></math> and <math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="\gamma=2.0" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">γ</mi><mo id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">2.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><eq id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></eq><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝛾</ci><cn type="float" id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">2.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">\gamma=2.0</annotation></semantics></math> for all experiments (unless specified) and varied the value of <math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><mi id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><ci id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">\psi</annotation></semantics></math>.We used <math id="S4.SS2.p3.4.m4.1" class="ltx_Math" alttext="\psi=0.8" display="inline"><semantics id="S4.SS2.p3.4.m4.1a"><mrow id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml">ψ</mi><mo id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml">0.8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><eq id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1"></eq><ci id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2">𝜓</ci><cn type="float" id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3">0.8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">\psi=0.8</annotation></semantics></math> for Sampled FEMNIST and MNIST dataset and <math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="\psi=0.6" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><mrow id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml"><mi id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml">ψ</mi><mo id="S4.SS2.p3.5.m5.1.1.1" xref="S4.SS2.p3.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1"><eq id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1"></eq><ci id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2">𝜓</ci><cn type="float" id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">\psi=0.6</annotation></semantics></math> for VSN and HAR dataset. We performed the experiments with balanced and unbalanced sets of the mentioned datasets. This is to compare the usage of Cross-Entropy Loss and our Fed-Focal Loss.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<ul id="S4.I2" class="ltx_itemize">
<li id="S4.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i1.p1" class="ltx_para">
<p id="S4.I2.i1.p1.1" class="ltx_p"><span id="S4.I2.i1.p1.1.1" class="ltx_text ltx_font_bold">Balanced Dataset:</span> The balanced dataset consists of all the images of the corresponding dataset where all classes have the same class ratio.</p>
</div>
</li>
<li id="S4.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i2.p1" class="ltx_para">
<p id="S4.I2.i2.p1.1" class="ltx_p"><span id="S4.I2.i2.p1.1.1" class="ltx_text ltx_font_bold">Unbalanced Dataset:</span> The unbalanced dataset consists of four classes, namely the digits 0,1,2,9 being unbalanced in the ratio of 1:100 in case of MNIST and 1:10 in case of Sampled-FEMNIST. We unbalance single class in VSN and HAR dataset in the ratio of <math id="S4.I2.i2.p1.1.m1.1" class="ltx_Math" alttext="1:20" display="inline"><semantics id="S4.I2.i2.p1.1.m1.1a"><mrow id="S4.I2.i2.p1.1.m1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.cmml"><mn id="S4.I2.i2.p1.1.m1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.I2.i2.p1.1.m1.1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.1.cmml">:</mo><mn id="S4.I2.i2.p1.1.m1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.I2.i2.p1.1.m1.1b"><apply id="S4.I2.i2.p1.1.m1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1"><ci id="S4.I2.i2.p1.1.m1.1.1.1.cmml" xref="S4.I2.i2.p1.1.m1.1.1.1">:</ci><cn type="integer" id="S4.I2.i2.p1.1.m1.1.1.2.cmml" xref="S4.I2.i2.p1.1.m1.1.1.2">1</cn><cn type="integer" id="S4.I2.i2.p1.1.m1.1.1.3.cmml" xref="S4.I2.i2.p1.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I2.i2.p1.1.m1.1c">1:20</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results</h3>

<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Balanced</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">We used the balanced version of the datasets to get a baseline of the performance. In Table 2, we see that VIRTUAL with FFL does consistently better than the CE version. Here we measure the average accuracy over all classes on the test set and report the mean and standard deviations over the runs.</p>
</div>
<div id="S4.SS3.SSS1.p2" class="ltx_para">
<p id="S4.SS3.SSS1.p2.1" class="ltx_p">We can see that the performance depends strongly on the volume distribution and heterogeneity of the dataset under consideration. In particular, the Global baseline is among the top-performing methods only on the MNIST dataset, that has been generated in the IID fashion.</p>
</div>
<div id="S4.SS3.SSS1.p3" class="ltx_para">
<p id="S4.SS3.SSS1.p3.1" class="ltx_p">The VSN dataset depicts strongly non-IID scenarios that have significantly dissimilar feature spaces among clients. VSN encompasses a broad spectrum of different sensors. The Sampled-FMNIST dataset depicts the problem of few datapoints with clients (70-100 samples per client).</p>
</div>
<div id="S4.SS3.SSS1.p4" class="ltx_para">
<p id="S4.SS3.SSS1.p4.1" class="ltx_p">In these scenarios, the performance of both Global and FedAvg degrades while Local models enjoy high performances, being tuned to the specific data distribution. We can see that VIRTUAL, when used with Fed-Focal Loss, maintains the top performance in the whole spectrum of federated scenarios, being on par with Global and FedAvg on IID datasets, and with Local models on strongly non-IID settings.</p>
</div>
<div id="S4.SS3.SSS1.p5" class="ltx_para">
<p id="S4.SS3.SSS1.p5.1" class="ltx_p">It also outperforms other methods on Sampled FEMNIST and HAR, that are datasets that best represent the multi-task learning setting, as they encompass different users gathering data in very similar but distinct conditions.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<table id="S4.T4.24" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.24.25.1" class="ltx_tr">
<th id="S4.T4.24.25.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S4.T4.24.25.1.1.1" class="ltx_text ltx_font_bold">Loss</span></th>
<th id="S4.T4.24.25.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S4.T4.24.25.1.2.1" class="ltx_text ltx_font_bold">Clients (ratio)</span></th>
<th id="S4.T4.24.25.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T4.24.25.1.3.1" class="ltx_text ltx_font_bold">Balanced MNIST</span></th>
<th id="S4.T4.24.25.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T4.24.25.1.4.1" class="ltx_text ltx_font_bold">Unbalanced MNIST</span></th>
<th id="S4.T4.24.25.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T4.24.25.1.5.1" class="ltx_text ltx_font_bold">Balanced FEMNIST</span></th>
<th id="S4.T4.24.25.1.6" class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T4.24.25.1.6.1" class="ltx_text ltx_font_bold">Unbalanced FEMNIST</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.4.4" class="ltx_tr">
<th id="S4.T4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Cross-entropy</th>
<th id="S4.T4.4.4.6" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">0.05</th>
<td id="S4.T4.1.1.1" class="ltx_td ltx_align_left ltx_border_t">0.9507<math id="S4.T4.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.1.1.1.m1.1a"><mo id="S4.T4.1.1.1.m1.1.1" xref="S4.T4.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T4.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.m1.1c">\pm</annotation></semantics></math>0.0010</td>
<td id="S4.T4.2.2.2" class="ltx_td ltx_align_left ltx_border_t">0.5574<math id="S4.T4.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.2.2.2.m1.1a"><mo id="S4.T4.2.2.2.m1.1.1" xref="S4.T4.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.m1.1b"><csymbol cd="latexml" id="S4.T4.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.m1.1c">\pm</annotation></semantics></math>0.0015</td>
<td id="S4.T4.3.3.3" class="ltx_td ltx_align_left ltx_border_t">0.7614<math id="S4.T4.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.3.3.3.m1.1a"><mo id="S4.T4.3.3.3.m1.1.1" xref="S4.T4.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.m1.1b"><csymbol cd="latexml" id="S4.T4.3.3.3.m1.1.1.cmml" xref="S4.T4.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.m1.1c">\pm</annotation></semantics></math>0.015</td>
<td id="S4.T4.4.4.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t">0.5159<math id="S4.T4.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.4.4.4.m1.1a"><mo id="S4.T4.4.4.4.m1.1.1" xref="S4.T4.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.m1.1b"><csymbol cd="latexml" id="S4.T4.4.4.4.m1.1.1.cmml" xref="S4.T4.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.m1.1c">\pm</annotation></semantics></math>0.010</td>
</tr>
<tr id="S4.T4.8.8" class="ltx_tr">
<th id="S4.T4.8.8.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Fed-Focal</th>
<th id="S4.T4.8.8.6" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.05</th>
<td id="S4.T4.5.5.1" class="ltx_td ltx_align_left">0.9590<math id="S4.T4.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.5.5.1.m1.1a"><mo id="S4.T4.5.5.1.m1.1.1" xref="S4.T4.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.1.m1.1b"><csymbol cd="latexml" id="S4.T4.5.5.1.m1.1.1.cmml" xref="S4.T4.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.1.m1.1c">\pm</annotation></semantics></math>0.0009</td>
<td id="S4.T4.6.6.2" class="ltx_td ltx_align_left">0.5635<math id="S4.T4.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.6.6.2.m1.1a"><mo id="S4.T4.6.6.2.m1.1.1" xref="S4.T4.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.2.m1.1b"><csymbol cd="latexml" id="S4.T4.6.6.2.m1.1.1.cmml" xref="S4.T4.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.2.m1.1c">\pm</annotation></semantics></math>0.0012</td>
<td id="S4.T4.7.7.3" class="ltx_td ltx_align_left">0.7814<math id="S4.T4.7.7.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.7.7.3.m1.1a"><mo id="S4.T4.7.7.3.m1.1.1" xref="S4.T4.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.7.7.3.m1.1b"><csymbol cd="latexml" id="S4.T4.7.7.3.m1.1.1.cmml" xref="S4.T4.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.7.3.m1.1c">\pm</annotation></semantics></math>0.015</td>
<td id="S4.T4.8.8.4" class="ltx_td ltx_nopad_r ltx_align_left">0.5448<math id="S4.T4.8.8.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.8.8.4.m1.1a"><mo id="S4.T4.8.8.4.m1.1.1" xref="S4.T4.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.8.8.4.m1.1b"><csymbol cd="latexml" id="S4.T4.8.8.4.m1.1.1.cmml" xref="S4.T4.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.8.4.m1.1c">\pm</annotation></semantics></math>0.012</td>
</tr>
<tr id="S4.T4.12.12" class="ltx_tr">
<th id="S4.T4.12.12.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Cross-entropy</th>
<th id="S4.T4.12.12.6" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.10</th>
<td id="S4.T4.9.9.1" class="ltx_td ltx_align_left">0.9687<math id="S4.T4.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.9.9.1.m1.1a"><mo id="S4.T4.9.9.1.m1.1.1" xref="S4.T4.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.9.9.1.m1.1b"><csymbol cd="latexml" id="S4.T4.9.9.1.m1.1.1.cmml" xref="S4.T4.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.9.1.m1.1c">\pm</annotation></semantics></math>0.0011</td>
<td id="S4.T4.10.10.2" class="ltx_td ltx_align_left">0.6660<math id="S4.T4.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.10.10.2.m1.1a"><mo id="S4.T4.10.10.2.m1.1.1" xref="S4.T4.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.10.10.2.m1.1b"><csymbol cd="latexml" id="S4.T4.10.10.2.m1.1.1.cmml" xref="S4.T4.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.10.10.2.m1.1c">\pm</annotation></semantics></math>0.0014</td>
<td id="S4.T4.11.11.3" class="ltx_td ltx_align_left">0.8147<math id="S4.T4.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.11.11.3.m1.1a"><mo id="S4.T4.11.11.3.m1.1.1" xref="S4.T4.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.11.11.3.m1.1b"><csymbol cd="latexml" id="S4.T4.11.11.3.m1.1.1.cmml" xref="S4.T4.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.11.11.3.m1.1c">\pm</annotation></semantics></math>0.010</td>
<td id="S4.T4.12.12.4" class="ltx_td ltx_nopad_r ltx_align_left">0.6750<math id="S4.T4.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.12.12.4.m1.1a"><mo id="S4.T4.12.12.4.m1.1.1" xref="S4.T4.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.12.12.4.m1.1b"><csymbol cd="latexml" id="S4.T4.12.12.4.m1.1.1.cmml" xref="S4.T4.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.12.12.4.m1.1c">\pm</annotation></semantics></math>0.010</td>
</tr>
<tr id="S4.T4.16.16" class="ltx_tr">
<th id="S4.T4.16.16.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Fed-Focal</th>
<th id="S4.T4.16.16.6" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.10</th>
<td id="S4.T4.13.13.1" class="ltx_td ltx_align_left">0.9707<math id="S4.T4.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.13.13.1.m1.1a"><mo id="S4.T4.13.13.1.m1.1.1" xref="S4.T4.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.13.13.1.m1.1b"><csymbol cd="latexml" id="S4.T4.13.13.1.m1.1.1.cmml" xref="S4.T4.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.13.13.1.m1.1c">\pm</annotation></semantics></math>0.0070</td>
<td id="S4.T4.14.14.2" class="ltx_td ltx_align_left">0.7571<math id="S4.T4.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.14.14.2.m1.1a"><mo id="S4.T4.14.14.2.m1.1.1" xref="S4.T4.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.14.14.2.m1.1b"><csymbol cd="latexml" id="S4.T4.14.14.2.m1.1.1.cmml" xref="S4.T4.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.14.14.2.m1.1c">\pm</annotation></semantics></math>0.0015</td>
<td id="S4.T4.15.15.3" class="ltx_td ltx_align_left">0.8315<math id="S4.T4.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.15.15.3.m1.1a"><mo id="S4.T4.15.15.3.m1.1.1" xref="S4.T4.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.15.15.3.m1.1b"><csymbol cd="latexml" id="S4.T4.15.15.3.m1.1.1.cmml" xref="S4.T4.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.15.15.3.m1.1c">\pm</annotation></semantics></math>0.010</td>
<td id="S4.T4.16.16.4" class="ltx_td ltx_nopad_r ltx_align_left">0.7555<math id="S4.T4.16.16.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.16.16.4.m1.1a"><mo id="S4.T4.16.16.4.m1.1.1" xref="S4.T4.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.16.16.4.m1.1b"><csymbol cd="latexml" id="S4.T4.16.16.4.m1.1.1.cmml" xref="S4.T4.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.16.16.4.m1.1c">\pm</annotation></semantics></math>0.010</td>
</tr>
<tr id="S4.T4.20.20" class="ltx_tr">
<th id="S4.T4.20.20.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Cross-entropy</th>
<th id="S4.T4.20.20.6" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.15</th>
<td id="S4.T4.17.17.1" class="ltx_td ltx_align_left">0.9631<math id="S4.T4.17.17.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.17.17.1.m1.1a"><mo id="S4.T4.17.17.1.m1.1.1" xref="S4.T4.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.17.17.1.m1.1b"><csymbol cd="latexml" id="S4.T4.17.17.1.m1.1.1.cmml" xref="S4.T4.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.17.17.1.m1.1c">\pm</annotation></semantics></math>0.0017</td>
<td id="S4.T4.18.18.2" class="ltx_td ltx_align_left">0.7570<math id="S4.T4.18.18.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.18.18.2.m1.1a"><mo id="S4.T4.18.18.2.m1.1.1" xref="S4.T4.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.18.18.2.m1.1b"><csymbol cd="latexml" id="S4.T4.18.18.2.m1.1.1.cmml" xref="S4.T4.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.18.18.2.m1.1c">\pm</annotation></semantics></math>0.0019</td>
<td id="S4.T4.19.19.3" class="ltx_td ltx_align_left">0.7751<math id="S4.T4.19.19.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.19.19.3.m1.1a"><mo id="S4.T4.19.19.3.m1.1.1" xref="S4.T4.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.19.19.3.m1.1b"><csymbol cd="latexml" id="S4.T4.19.19.3.m1.1.1.cmml" xref="S4.T4.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.19.19.3.m1.1c">\pm</annotation></semantics></math>0.013</td>
<td id="S4.T4.20.20.4" class="ltx_td ltx_nopad_r ltx_align_left">0.7321<math id="S4.T4.20.20.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.20.20.4.m1.1a"><mo id="S4.T4.20.20.4.m1.1.1" xref="S4.T4.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.20.20.4.m1.1b"><csymbol cd="latexml" id="S4.T4.20.20.4.m1.1.1.cmml" xref="S4.T4.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.20.20.4.m1.1c">\pm</annotation></semantics></math>0.012</td>
</tr>
<tr id="S4.T4.24.24" class="ltx_tr">
<th id="S4.T4.24.24.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Fed-Focal</th>
<th id="S4.T4.24.24.6" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">0.15</th>
<td id="S4.T4.21.21.1" class="ltx_td ltx_align_left ltx_border_bb">0.9666<math id="S4.T4.21.21.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.21.21.1.m1.1a"><mo id="S4.T4.21.21.1.m1.1.1" xref="S4.T4.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.21.21.1.m1.1b"><csymbol cd="latexml" id="S4.T4.21.21.1.m1.1.1.cmml" xref="S4.T4.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.21.21.1.m1.1c">\pm</annotation></semantics></math>0.0030</td>
<td id="S4.T4.22.22.2" class="ltx_td ltx_align_left ltx_border_bb">0.7710<math id="S4.T4.22.22.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.22.22.2.m1.1a"><mo id="S4.T4.22.22.2.m1.1.1" xref="S4.T4.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.22.22.2.m1.1b"><csymbol cd="latexml" id="S4.T4.22.22.2.m1.1.1.cmml" xref="S4.T4.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.22.22.2.m1.1c">\pm</annotation></semantics></math>0.0032</td>
<td id="S4.T4.23.23.3" class="ltx_td ltx_align_left ltx_border_bb">0.7911<math id="S4.T4.23.23.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.23.23.3.m1.1a"><mo id="S4.T4.23.23.3.m1.1.1" xref="S4.T4.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.23.23.3.m1.1b"><csymbol cd="latexml" id="S4.T4.23.23.3.m1.1.1.cmml" xref="S4.T4.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.23.23.3.m1.1c">\pm</annotation></semantics></math>0.015</td>
<td id="S4.T4.24.24.4" class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb">0.7458<math id="S4.T4.24.24.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T4.24.24.4.m1.1a"><mo id="S4.T4.24.24.4.m1.1.1" xref="S4.T4.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T4.24.24.4.m1.1b"><csymbol cd="latexml" id="S4.T4.24.24.4.m1.1.1.cmml" xref="S4.T4.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.24.24.4.m1.1c">\pm</annotation></semantics></math>0.014</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.26.1.1" class="ltx_text" style="font-size:90%;">Table 4</span>: </span><span id="S4.T4.27.2" class="ltx_text" style="font-size:90%;">Varying the number of clients sampled</span></figcaption>
</figure>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Unbalanced</h4>

<div id="S4.SS3.SSS2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.p1.1" class="ltx_p">Given the baselines we have set in the balanced scenario, we have done experiments with unbalanced MNIST. In Table 3, we observe the performance of FFL to classify hard samples (<math id="S4.SS3.SSS2.p1.1.m1.1" class="ltx_Math" alttext="p_{t}\ll" display="inline"><semantics id="S4.SS3.SSS2.p1.1.m1.1a"><mrow id="S4.SS3.SSS2.p1.1.m1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.cmml"><msub id="S4.SS3.SSS2.p1.1.m1.1.1.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS3.SSS2.p1.1.m1.1.1.2.2" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.2.cmml">p</mi><mi id="S4.SS3.SSS2.p1.1.m1.1.1.2.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="S4.SS3.SSS2.p1.1.m1.1.1.1" xref="S4.SS3.SSS2.p1.1.m1.1.1.1.cmml">≪</mo><mi id="S4.SS3.SSS2.p1.1.m1.1.1.3" xref="S4.SS3.SSS2.p1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p1.1.m1.1b"><apply id="S4.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.1">much-less-than</csymbol><apply id="S4.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.SSS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS3.SSS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.2">𝑝</ci><ci id="S4.SS3.SSS2.p1.1.m1.1.1.2.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="S4.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S4.SS3.SSS2.p1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p1.1.m1.1c">p_{t}\ll</annotation></semantics></math> 0.5) under single class and multi-class imbalance when compared with the cross-entropy.</p>
</div>
<figure id="S4.T5" class="ltx_table">
<table id="S4.T5.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.1.1" class="ltx_tr">
<th id="S4.T5.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><math id="S4.T5.1.1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.T5.1.1.1.m1.1a"><mi id="S4.T5.1.1.1.m1.1.1" xref="S4.T5.1.1.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.T5.1.1.1.m1.1b"><ci id="S4.T5.1.1.1.m1.1.1.cmml" xref="S4.T5.1.1.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.1.1.1.m1.1c">\gamma</annotation></semantics></math></th>
<th id="S4.T5.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.2.2" class="ltx_tr">
<th id="S4.T5.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">1.0</th>
<td id="S4.T5.2.2.1" class="ltx_td ltx_align_left ltx_border_t">0.7486<math id="S4.T5.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.2.2.1.m1.1a"><mo id="S4.T5.2.2.1.m1.1.1" xref="S4.T5.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.T5.2.2.1.m1.1.1.cmml" xref="S4.T5.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.2.2.1.m1.1c">\pm</annotation></semantics></math>0.0001</td>
</tr>
<tr id="S4.T5.3.3" class="ltx_tr">
<th id="S4.T5.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">2.0</th>
<td id="S4.T5.3.3.1" class="ltx_td ltx_align_left">0.7840<math id="S4.T5.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.3.3.1.m1.1a"><mo id="S4.T5.3.3.1.m1.1.1" xref="S4.T5.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.3.3.1.m1.1b"><csymbol cd="latexml" id="S4.T5.3.3.1.m1.1.1.cmml" xref="S4.T5.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.3.3.1.m1.1c">\pm</annotation></semantics></math>0.0015</td>
</tr>
<tr id="S4.T5.4.4" class="ltx_tr">
<th id="S4.T5.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">3.0</th>
<td id="S4.T5.4.4.1" class="ltx_td ltx_align_left">0.6786<math id="S4.T5.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.4.4.1.m1.1a"><mo id="S4.T5.4.4.1.m1.1.1" xref="S4.T5.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.T5.4.4.1.m1.1.1.cmml" xref="S4.T5.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.4.4.1.m1.1c">\pm</annotation></semantics></math>0.0040</td>
</tr>
<tr id="S4.T5.5.5" class="ltx_tr">
<th id="S4.T5.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">4.0</th>
<td id="S4.T5.5.5.1" class="ltx_td ltx_align_left">0.6736<math id="S4.T5.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.5.5.1.m1.1a"><mo id="S4.T5.5.5.1.m1.1.1" xref="S4.T5.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.5.5.1.m1.1b"><csymbol cd="latexml" id="S4.T5.5.5.1.m1.1.1.cmml" xref="S4.T5.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.5.5.1.m1.1c">\pm</annotation></semantics></math>0.0043</td>
</tr>
<tr id="S4.T5.6.6" class="ltx_tr">
<th id="S4.T5.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">5.0</th>
<td id="S4.T5.6.6.1" class="ltx_td ltx_align_left ltx_border_bb">0.6220<math id="S4.T5.6.6.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T5.6.6.1.m1.1a"><mo id="S4.T5.6.6.1.m1.1.1" xref="S4.T5.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T5.6.6.1.m1.1b"><csymbol cd="latexml" id="S4.T5.6.6.1.m1.1.1.cmml" xref="S4.T5.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.6.6.1.m1.1c">\pm</annotation></semantics></math>0.0052</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T5.12.3.1" class="ltx_text" style="font-size:90%;">Table 5</span>: </span><span id="S4.T5.10.2" class="ltx_text" style="font-size:90%;">Test Accuracy on Unbalanced MNIST at <math id="S4.T5.9.1.m1.1" class="ltx_Math" alttext="\psi=0.0" display="inline"><semantics id="S4.T5.9.1.m1.1b"><mrow id="S4.T5.9.1.m1.1.1" xref="S4.T5.9.1.m1.1.1.cmml"><mi id="S4.T5.9.1.m1.1.1.2" xref="S4.T5.9.1.m1.1.1.2.cmml">ψ</mi><mo id="S4.T5.9.1.m1.1.1.1" xref="S4.T5.9.1.m1.1.1.1.cmml">=</mo><mn id="S4.T5.9.1.m1.1.1.3" xref="S4.T5.9.1.m1.1.1.3.cmml">0.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.9.1.m1.1c"><apply id="S4.T5.9.1.m1.1.1.cmml" xref="S4.T5.9.1.m1.1.1"><eq id="S4.T5.9.1.m1.1.1.1.cmml" xref="S4.T5.9.1.m1.1.1.1"></eq><ci id="S4.T5.9.1.m1.1.1.2.cmml" xref="S4.T5.9.1.m1.1.1.2">𝜓</ci><cn type="float" id="S4.T5.9.1.m1.1.1.3.cmml" xref="S4.T5.9.1.m1.1.1.3">0.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.9.1.m1.1d">\psi=0.0</annotation></semantics></math> and <math id="S4.T5.10.2.m2.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S4.T5.10.2.m2.1b"><mrow id="S4.T5.10.2.m2.1.1" xref="S4.T5.10.2.m2.1.1.cmml"><mi id="S4.T5.10.2.m2.1.1.2" xref="S4.T5.10.2.m2.1.1.2.cmml">α</mi><mo id="S4.T5.10.2.m2.1.1.1" xref="S4.T5.10.2.m2.1.1.1.cmml">=</mo><mn id="S4.T5.10.2.m2.1.1.3" xref="S4.T5.10.2.m2.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T5.10.2.m2.1c"><apply id="S4.T5.10.2.m2.1.1.cmml" xref="S4.T5.10.2.m2.1.1"><eq id="S4.T5.10.2.m2.1.1.1.cmml" xref="S4.T5.10.2.m2.1.1.1"></eq><ci id="S4.T5.10.2.m2.1.1.2.cmml" xref="S4.T5.10.2.m2.1.1.2">𝛼</ci><cn type="float" id="S4.T5.10.2.m2.1.1.3.cmml" xref="S4.T5.10.2.m2.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T5.10.2.m2.1d">\alpha=1.0</annotation></semantics></math></span></figcaption>
</figure>
<div id="S4.SS3.SSS2.p2" class="ltx_para">
<p id="S4.SS3.SSS2.p2.5" class="ltx_p">We study the variation of test accuracy with the tuning parameter <math id="S4.SS3.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS2.p2.1.m1.1a"><mi id="S4.SS3.SSS2.p2.1.m1.1.1" xref="S4.SS3.SSS2.p2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.1.m1.1b"><ci id="S4.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.1.m1.1c">\gamma</annotation></semantics></math> of Fed Focal Loss. We can observe in Table 5 that smaller values of <math id="S4.SS3.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS2.p2.2.m2.1a"><mi id="S4.SS3.SSS2.p2.2.m2.1.1" xref="S4.SS3.SSS2.p2.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.2.m2.1b"><ci id="S4.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p2.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.2.m2.1c">\gamma</annotation></semantics></math> are suitable while larger values of <math id="S4.SS3.SSS2.p2.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS2.p2.3.m3.1a"><mi id="S4.SS3.SSS2.p2.3.m3.1.1" xref="S4.SS3.SSS2.p2.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.3.m3.1b"><ci id="S4.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p2.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.3.m3.1c">\gamma</annotation></semantics></math> lead to worse performance. <math id="S4.SS3.SSS2.p2.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS2.p2.4.m4.1a"><mi id="S4.SS3.SSS2.p2.4.m4.1.1" xref="S4.SS3.SSS2.p2.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.4.m4.1b"><ci id="S4.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p2.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.4.m4.1c">\gamma</annotation></semantics></math> = 1.0 and 2.0 deliver very good test set accuracies as compared to <math id="S4.SS3.SSS2.p2.5.m5.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.SSS2.p2.5.m5.1a"><mi id="S4.SS3.SSS2.p2.5.m5.1.1" xref="S4.SS3.SSS2.p2.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p2.5.m5.1b"><ci id="S4.SS3.SSS2.p2.5.m5.1.1.cmml" xref="S4.SS3.SSS2.p2.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p2.5.m5.1c">\gamma</annotation></semantics></math> = 3.0, 4.0 and 5.0.</p>
</div>
<figure id="S4.T6" class="ltx_table">
<table id="S4.T6.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T6.1.1" class="ltx_tr">
<th id="S4.T6.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><math id="S4.T6.1.1.1.m1.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.T6.1.1.1.m1.1a"><mi id="S4.T6.1.1.1.m1.1.1" xref="S4.T6.1.1.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.T6.1.1.1.m1.1b"><ci id="S4.T6.1.1.1.m1.1.1.cmml" xref="S4.T6.1.1.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.1.1.1.m1.1c">\psi</annotation></semantics></math></th>
<th id="S4.T6.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Accuracy</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T6.2.2" class="ltx_tr">
<th id="S4.T6.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">0.0</th>
<td id="S4.T6.2.2.1" class="ltx_td ltx_align_left ltx_border_t">0.7486<math id="S4.T6.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T6.2.2.1.m1.1a"><mo id="S4.T6.2.2.1.m1.1.1" xref="S4.T6.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T6.2.2.1.m1.1b"><csymbol cd="latexml" id="S4.T6.2.2.1.m1.1.1.cmml" xref="S4.T6.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.2.2.1.m1.1c">\pm</annotation></semantics></math>0.0001</td>
</tr>
<tr id="S4.T6.3.3" class="ltx_tr">
<th id="S4.T6.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.2</th>
<td id="S4.T6.3.3.1" class="ltx_td ltx_align_left">0.7497<math id="S4.T6.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T6.3.3.1.m1.1a"><mo id="S4.T6.3.3.1.m1.1.1" xref="S4.T6.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T6.3.3.1.m1.1b"><csymbol cd="latexml" id="S4.T6.3.3.1.m1.1.1.cmml" xref="S4.T6.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.3.3.1.m1.1c">\pm</annotation></semantics></math>0.0001</td>
</tr>
<tr id="S4.T6.4.4" class="ltx_tr">
<th id="S4.T6.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.6</th>
<td id="S4.T6.4.4.1" class="ltx_td ltx_align_left">0.7504<math id="S4.T6.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T6.4.4.1.m1.1a"><mo id="S4.T6.4.4.1.m1.1.1" xref="S4.T6.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T6.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.T6.4.4.1.m1.1.1.cmml" xref="S4.T6.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.4.4.1.m1.1c">\pm</annotation></semantics></math>0.0002</td>
</tr>
<tr id="S4.T6.5.5" class="ltx_tr">
<th id="S4.T6.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">0.8</th>
<td id="S4.T6.5.5.1" class="ltx_td ltx_align_left">0.7591<math id="S4.T6.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T6.5.5.1.m1.1a"><mo id="S4.T6.5.5.1.m1.1.1" xref="S4.T6.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T6.5.5.1.m1.1b"><csymbol cd="latexml" id="S4.T6.5.5.1.m1.1.1.cmml" xref="S4.T6.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.5.5.1.m1.1c">\pm</annotation></semantics></math>0.0010</td>
</tr>
<tr id="S4.T6.6.6" class="ltx_tr">
<th id="S4.T6.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">1.0</th>
<td id="S4.T6.6.6.1" class="ltx_td ltx_align_left ltx_border_bb">0.7473<math id="S4.T6.6.6.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T6.6.6.1.m1.1a"><mo id="S4.T6.6.6.1.m1.1.1" xref="S4.T6.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T6.6.6.1.m1.1b"><csymbol cd="latexml" id="S4.T6.6.6.1.m1.1.1.cmml" xref="S4.T6.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.6.6.1.m1.1c">\pm</annotation></semantics></math>0.0030</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T6.12.3.1" class="ltx_text" style="font-size:90%;">Table 6</span>: </span><span id="S4.T6.10.2" class="ltx_text" style="font-size:90%;">Test Accuracy on Unbalanced MNIST at <math id="S4.T6.9.1.m1.1" class="ltx_Math" alttext="\gamma=2.0" display="inline"><semantics id="S4.T6.9.1.m1.1b"><mrow id="S4.T6.9.1.m1.1.1" xref="S4.T6.9.1.m1.1.1.cmml"><mi id="S4.T6.9.1.m1.1.1.2" xref="S4.T6.9.1.m1.1.1.2.cmml">γ</mi><mo id="S4.T6.9.1.m1.1.1.1" xref="S4.T6.9.1.m1.1.1.1.cmml">=</mo><mn id="S4.T6.9.1.m1.1.1.3" xref="S4.T6.9.1.m1.1.1.3.cmml">2.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.9.1.m1.1c"><apply id="S4.T6.9.1.m1.1.1.cmml" xref="S4.T6.9.1.m1.1.1"><eq id="S4.T6.9.1.m1.1.1.1.cmml" xref="S4.T6.9.1.m1.1.1.1"></eq><ci id="S4.T6.9.1.m1.1.1.2.cmml" xref="S4.T6.9.1.m1.1.1.2">𝛾</ci><cn type="float" id="S4.T6.9.1.m1.1.1.3.cmml" xref="S4.T6.9.1.m1.1.1.3">2.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.9.1.m1.1d">\gamma=2.0</annotation></semantics></math> and <math id="S4.T6.10.2.m2.1" class="ltx_Math" alttext="\alpha=1.0" display="inline"><semantics id="S4.T6.10.2.m2.1b"><mrow id="S4.T6.10.2.m2.1.1" xref="S4.T6.10.2.m2.1.1.cmml"><mi id="S4.T6.10.2.m2.1.1.2" xref="S4.T6.10.2.m2.1.1.2.cmml">α</mi><mo id="S4.T6.10.2.m2.1.1.1" xref="S4.T6.10.2.m2.1.1.1.cmml">=</mo><mn id="S4.T6.10.2.m2.1.1.3" xref="S4.T6.10.2.m2.1.1.3.cmml">1.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T6.10.2.m2.1c"><apply id="S4.T6.10.2.m2.1.1.cmml" xref="S4.T6.10.2.m2.1.1"><eq id="S4.T6.10.2.m2.1.1.1.cmml" xref="S4.T6.10.2.m2.1.1.1"></eq><ci id="S4.T6.10.2.m2.1.1.2.cmml" xref="S4.T6.10.2.m2.1.1.2">𝛼</ci><cn type="float" id="S4.T6.10.2.m2.1.1.3.cmml" xref="S4.T6.10.2.m2.1.1.3">1.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T6.10.2.m2.1d">\alpha=1.0</annotation></semantics></math></span></figcaption>
</figure>
<div id="S4.SS3.SSS2.p3" class="ltx_para">
<p id="S4.SS3.SSS2.p3.5" class="ltx_p">We also study the variation of test accuracy with the tuning parameter <math id="S4.SS3.SSS2.p3.1.m1.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS3.SSS2.p3.1.m1.1a"><mi id="S4.SS3.SSS2.p3.1.m1.1.1" xref="S4.SS3.SSS2.p3.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.1.m1.1b"><ci id="S4.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS3.SSS2.p3.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.1.m1.1c">\psi</annotation></semantics></math> of Fed Focal Loss. <math id="S4.SS3.SSS2.p3.2.m2.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS3.SSS2.p3.2.m2.1a"><mi id="S4.SS3.SSS2.p3.2.m2.1.1" xref="S4.SS3.SSS2.p3.2.m2.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.2.m2.1b"><ci id="S4.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS3.SSS2.p3.2.m2.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.2.m2.1c">\psi</annotation></semantics></math> = 0.0 is when no particular focus is given to the client, while <math id="S4.SS3.SSS2.p3.3.m3.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS3.SSS2.p3.3.m3.1a"><mi id="S4.SS3.SSS2.p3.3.m3.1.1" xref="S4.SS3.SSS2.p3.3.m3.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.3.m3.1b"><ci id="S4.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS3.SSS2.p3.3.m3.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.3.m3.1c">\psi</annotation></semantics></math> = 1.0 is when we focus only on all clients that have improved their performance in the previous round. In Table 6, we can observe that <math id="S4.SS3.SSS2.p3.4.m4.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS3.SSS2.p3.4.m4.1a"><mi id="S4.SS3.SSS2.p3.4.m4.1.1" xref="S4.SS3.SSS2.p3.4.m4.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.4.m4.1b"><ci id="S4.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS3.SSS2.p3.4.m4.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.4.m4.1c">\psi</annotation></semantics></math> = 0.6 and 0.8 shows a significant improvement in the performance. Although we cannot generalize a specific tuned value as it strongly depends on the distribution of validation dataset, we found the best performance with <math id="S4.SS3.SSS2.p3.5.m5.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S4.SS3.SSS2.p3.5.m5.1a"><mi id="S4.SS3.SSS2.p3.5.m5.1.1" xref="S4.SS3.SSS2.p3.5.m5.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.p3.5.m5.1b"><ci id="S4.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S4.SS3.SSS2.p3.5.m5.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.p3.5.m5.1c">\psi</annotation></semantics></math> = 0.8 and 0.6.</p>
</div>
<div id="S4.SS3.SSS2.p4" class="ltx_para">
<p id="S4.SS3.SSS2.p4.1" class="ltx_p">We can observe that in the class imbalance situation, the performance of FFL based VIRTUAL surpasses the benchmark accuracy of unbalanced MNIST, Sampled-FEMNIST, VSN and HAR. It is observed than the performance strongly depends on the distribution of a dataset. In the class imbalance situation, few clients may have zero samples of unbalanced class.</p>
</div>
<div id="S4.SS3.SSS2.p5" class="ltx_para">
<p id="S4.SS3.SSS2.p5.1" class="ltx_p">This condition is depicted strongly by the Sampled FEMNIST. The classic MNIST dataset depicts the IID scenario, and non-IID scenario is depicted by VSN dataset. Despite the highly skewed dataset distribution, the Fed Focal Loss performs better than cross-entropy.</p>
</div>
</section>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation study</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">We perform an ablation study to validate the efficacy of our Fed-Focal Loss. These experiments are conducted on MNIST and Sampled-FEMNIST.</p>
</div>
<section id="S4.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1 </span>Client sampling</h4>

<div id="S4.SS4.SSS1.p1" class="ltx_para">
<p id="S4.SS4.SSS1.p1.1" class="ltx_p">This study focused on how changing the number of clients to sample each round impacted the performance. We can see that in Table 4, the performance of both methods decreases at the sampling ratio of 0.05 or 0.15 clients, and the best results are obtained with a ratio of 0.10 clients.</p>
</div>
<div id="S4.SS4.SSS1.p2" class="ltx_para">
<p id="S4.SS4.SSS1.p2.1" class="ltx_p">Moreover, class accuracy of unbalanced class decreases drastically in case of the sampling ratio 0.05 as compared to 0.10 and 0.15. Despite varying the sampling frequency, FFL maintains the top performance under both the balanced and unbalanced case.</p>
</div>
</section>
<section id="S4.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.2 </span>Noisy MNIST</h4>

<div id="S4.SS4.SSS2.p1" class="ltx_para">
<p id="S4.SS4.SSS2.p1.1" class="ltx_p">The Classic MNIST dataset consists of black and white images with pixel values nearer to 0 depicting a black shade and pixel values nearer to 255 means a lighter shade. Real-world datasets are affected with noise and hence to simulate the real-world scenario, we introduce some noise in MNIST dataset.</p>
</div>
<div id="S4.SS4.SSS2.p2" class="ltx_para">
<p id="S4.SS4.SSS2.p2.4" class="ltx_p">We choose additive Gaussian noise to manipulate the pixel values from their default values. This manipulation can be controlled by two parameters of Gaussian distribution, mean ( <math id="S4.SS4.SSS2.p2.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS4.SSS2.p2.1.m1.1a"><mi id="S4.SS4.SSS2.p2.1.m1.1.1" xref="S4.SS4.SSS2.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.1.m1.1b"><ci id="S4.SS4.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.1.m1.1c">\mu</annotation></semantics></math> ) and standard deviation ( <math id="S4.SS4.SSS2.p2.2.m2.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S4.SS4.SSS2.p2.2.m2.1a"><mi id="S4.SS4.SSS2.p2.2.m2.1.1" xref="S4.SS4.SSS2.p2.2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.2.m2.1b"><ci id="S4.SS4.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p2.2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.2.m2.1c">\sigma</annotation></semantics></math> ). We select <math id="S4.SS4.SSS2.p2.3.m3.1" class="ltx_Math" alttext="\mu=10" display="inline"><semantics id="S4.SS4.SSS2.p2.3.m3.1a"><mrow id="S4.SS4.SSS2.p2.3.m3.1.1" xref="S4.SS4.SSS2.p2.3.m3.1.1.cmml"><mi id="S4.SS4.SSS2.p2.3.m3.1.1.2" xref="S4.SS4.SSS2.p2.3.m3.1.1.2.cmml">μ</mi><mo id="S4.SS4.SSS2.p2.3.m3.1.1.1" xref="S4.SS4.SSS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.SSS2.p2.3.m3.1.1.3" xref="S4.SS4.SSS2.p2.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.3.m3.1b"><apply id="S4.SS4.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1"><eq id="S4.SS4.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1.1"></eq><ci id="S4.SS4.SSS2.p2.3.m3.1.1.2.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1.2">𝜇</ci><cn type="integer" id="S4.SS4.SSS2.p2.3.m3.1.1.3.cmml" xref="S4.SS4.SSS2.p2.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.3.m3.1c">\mu=10</annotation></semantics></math> and <math id="S4.SS4.SSS2.p2.4.m4.1" class="ltx_Math" alttext="\sigma=5" display="inline"><semantics id="S4.SS4.SSS2.p2.4.m4.1a"><mrow id="S4.SS4.SSS2.p2.4.m4.1.1" xref="S4.SS4.SSS2.p2.4.m4.1.1.cmml"><mi id="S4.SS4.SSS2.p2.4.m4.1.1.2" xref="S4.SS4.SSS2.p2.4.m4.1.1.2.cmml">σ</mi><mo id="S4.SS4.SSS2.p2.4.m4.1.1.1" xref="S4.SS4.SSS2.p2.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS4.SSS2.p2.4.m4.1.1.3" xref="S4.SS4.SSS2.p2.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p2.4.m4.1b"><apply id="S4.SS4.SSS2.p2.4.m4.1.1.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1"><eq id="S4.SS4.SSS2.p2.4.m4.1.1.1.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.1"></eq><ci id="S4.SS4.SSS2.p2.4.m4.1.1.2.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.2">𝜎</ci><cn type="integer" id="S4.SS4.SSS2.p2.4.m4.1.1.3.cmml" xref="S4.SS4.SSS2.p2.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p2.4.m4.1c">\sigma=5</annotation></semantics></math> to generate a Gaussian noise to manipulate each pixel value and perform the addition operation to achieve a Noisy MNIST dataset.</p>
</div>
<figure id="S4.T7" class="ltx_table">
<table id="S4.T7.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T7.4.5.1" class="ltx_tr">
<th id="S4.T7.4.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t"><span id="S4.T7.4.5.1.1.1" class="ltx_text ltx_font_bold">Loss</span></th>
<th id="S4.T7.4.5.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T7.4.5.1.2.1" class="ltx_text ltx_font_bold">Balanced</span></th>
<th id="S4.T7.4.5.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T7.4.5.1.3.1" class="ltx_text ltx_font_bold">Unbalanced</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T7.2.2" class="ltx_tr">
<th id="S4.T7.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Cross-entropy</th>
<td id="S4.T7.1.1.1" class="ltx_td ltx_align_left ltx_border_t">0.9381<math id="S4.T7.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T7.1.1.1.m1.1a"><mo id="S4.T7.1.1.1.m1.1.1" xref="S4.T7.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T7.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T7.1.1.1.m1.1.1.cmml" xref="S4.T7.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.1.1.1.m1.1c">\pm</annotation></semantics></math>0.0010</td>
<td id="S4.T7.2.2.2" class="ltx_td ltx_align_left ltx_border_t">0.6202<math id="S4.T7.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T7.2.2.2.m1.1a"><mo id="S4.T7.2.2.2.m1.1.1" xref="S4.T7.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T7.2.2.2.m1.1b"><csymbol cd="latexml" id="S4.T7.2.2.2.m1.1.1.cmml" xref="S4.T7.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.2.2.2.m1.1c">\pm</annotation></semantics></math>0.0017</td>
</tr>
<tr id="S4.T7.4.4" class="ltx_tr">
<th id="S4.T7.4.4.3" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Fed-Focal</th>
<td id="S4.T7.3.3.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T7.3.3.1.1" class="ltx_text ltx_font_bold">0.9552<math id="S4.T7.3.3.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T7.3.3.1.1.m1.1a"><mo id="S4.T7.3.3.1.1.m1.1.1" xref="S4.T7.3.3.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T7.3.3.1.1.m1.1b"><csymbol cd="latexml" id="S4.T7.3.3.1.1.m1.1.1.cmml" xref="S4.T7.3.3.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.3.3.1.1.m1.1c">\pm</annotation></semantics></math>0.0010</span></td>
<td id="S4.T7.4.4.2" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T7.4.4.2.1" class="ltx_text ltx_font_bold">0.6692<math id="S4.T7.4.4.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T7.4.4.2.1.m1.1a"><mo id="S4.T7.4.4.2.1.m1.1.1" xref="S4.T7.4.4.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T7.4.4.2.1.m1.1b"><csymbol cd="latexml" id="S4.T7.4.4.2.1.m1.1.1.cmml" xref="S4.T7.4.4.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T7.4.4.2.1.m1.1c">\pm</annotation></semantics></math>0.0017</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T7.6.1.1" class="ltx_text" style="font-size:90%;">Table 7</span>: </span><span id="S4.T7.7.2" class="ltx_text" style="font-size:90%;">Using Noisy MNIST with 0.10 ratio of clients</span></figcaption>
</figure>
<div id="S4.SS4.SSS2.p3" class="ltx_para">
<p id="S4.SS4.SSS2.p3.1" class="ltx_p">The comparisons are shown in Table 7, where the proposed Fed-Focal Loss gets the best estimation.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Observations</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Extreme imbalance</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">When the class imbalance is more than 1:50 in VSN and HAR dataset, it becomes difficult for both the loss functions to correctly classify the unbalanced classes. Although in some cases it was observed that 2-5 samples were correctly classified by Fed-Focal Loss and none of the samples was classified correctly by Cross-entropy Loss. Similar behaviour was seen with MNIST at 1:500 imbalance and Sampled FEMNIST at 1:100 and 1:200 class imbalance ratios.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Smoother convergence</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.6" class="ltx_p">During training on the classic MNIST balanced dataset, Figure 1 depicts the accuracy comparison of Cross-entropy with Fed-Focal Loss. We observe that without using Fed Focal Loss ( <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">\psi</annotation></semantics></math> = 0.0, <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">\gamma</annotation></semantics></math> = 0.0, <math id="S5.SS2.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p1.3.m3.1a"><mi id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><ci id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">\alpha</annotation></semantics></math> = 1.0 ) the graph is unstable as compared to using Fed-Focal Loss with ( <math id="S5.SS2.p1.4.m4.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S5.SS2.p1.4.m4.1a"><mi id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><ci id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">\psi</annotation></semantics></math> = 0.8, <math id="S5.SS2.p1.5.m5.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS2.p1.5.m5.1a"><mi id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><ci id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">\gamma</annotation></semantics></math> = 2.0, <math id="S5.SS2.p1.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p1.6.m6.1a"><mi id="S5.SS2.p1.6.m6.1.1" xref="S5.SS2.p1.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m6.1b"><ci id="S5.SS2.p1.6.m6.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m6.1c">\alpha</annotation></semantics></math> = 1.0 ).</p>
</div>
<figure id="S5.F1" class="ltx_figure"><img src="/html/2011.06283/assets/Figure1.png" id="S5.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="193" height="139" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S5.F1.3.2" class="ltx_text" style="font-size:90%;">MNIST training comparison - Accuracy</span></figcaption>
</figure>
<figure id="S5.F2" class="ltx_figure"><img src="/html/2011.06283/assets/Figure2.png" id="S5.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="197" height="139" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S5.F2.3.2" class="ltx_text" style="font-size:90%;">FEMNIST training comparison - Accuracy</span></figcaption>
</figure>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">In Figure 2, we see that Fed-Focal Loss and cross-entropy follow a similar accuracy curve until 800 rounds after which Fed-Focal Loss seems to perform better.</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/2011.06283/assets/Figure3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="193" height="139" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.3.2" class="ltx_text" style="font-size:90%;">FEMNIST training comparison - Loss</span></figcaption>
</figure>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">Similarly, when we train on unbalanced Sampled-FEMNIST dataset, we observe smoother convergence in Figure 3.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusions &amp; Future Work</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we extended the Focal Loss function used in image detectors to Federated Learning along with tunable sampling framework for solving the class imbalance problem. By getting the loss to focus on hard-examples and better-performing clients feedback, we have shown significant improvements inaccuracy.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">Experimental analysis with VIRTUAL approach on MNIST, FEMNIST, VSN and HAR benchmarks, demonstrates clear accuracy improvements over cross-entropy based loss function. The ablation study further shows the robustness of FFL in various conditions of clients behaviour and dataset noise.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p">We further observe training stability using FFL during the experiments. We believe the function will help smoother convergence in cases where the data has challenges. In extreme cases of class imbalance in data, it does better than Cross- entropy.</p>
</div>
<div id="S6.p4" class="ltx_para">
<p id="S6.p4.1" class="ltx_p">We clearly see the application of this loss function in popular FedAvg-based frameworks like <span id="S6.p4.1.1" class="ltx_text ltx_font_italic">PySft</span> [Ryffel <span id="S6.p4.1.2" class="ltx_text ltx_font_italic">et al.</span>, 2018] to gain similar improvements in more complex network types as well. The Federated Learning paradigm has the additional benefits of monitoring client behaviour, and it will be incorporated into the various aspects to gain training stability and accuracy going forward.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">We would like to thank the VIRTUAL paper authors who shared their current codebase with us and answered our questions about their results.</p>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">References</h2>

<div id="Sx2.p1" class="ltx_para ltx_noindent">
<p id="Sx2.p1.1" class="ltx_p">[Lueth, 2018] K. L. Lueth. State of the IoT 2018: Number of IoT devices now at 7 Billion market accelerating. <span id="Sx2.p1.1.1" class="ltx_text ltx_font_italic">IOT Analytics</span>, 2018.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p2" class="ltx_para ltx_noindent">
<p id="Sx2.p2.1" class="ltx_p">[LeCun <span id="Sx2.p2.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2018] LeCun, Y. Bengio, and G. Hinton. Deep learning. <span id="Sx2.p2.1.2" class="ltx_text ltx_font_italic">Nature</span>, vol. 521,no. 7553, p. 436, 2015. 
<br class="ltx_break"></p>
</div>
<div id="Sx2.p3" class="ltx_para ltx_noindent">
<p id="Sx2.p3.1" class="ltx_p">[Clusters <span id="Sx2.p3.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2019] B. Custers, A. Sears, F. Dechesne, I. Georgieva, T. Tani, and S. van derHof. EU Personal Data Protection in Policy and Practice.<span id="Sx2.p3.1.2" class="ltx_text ltx_font_italic">Springer</span>,2019. 
<br class="ltx_break"></p>
</div>
<div id="Sx2.p4" class="ltx_para ltx_noindent">
<p id="Sx2.p4.1" class="ltx_p">[Graff <span id="Sx2.p4.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2014] B. M.Gaff, H.E.Sussman, and J.Geetter.Privacy and big data. <span id="Sx2.p4.1.2" class="ltx_text ltx_font_italic">Computer</span>, vol. 47, no. 6, pp. 7–9, 2014.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p5" class="ltx_para ltx_noindent">
<p id="Sx2.p5.1" class="ltx_p">[Mao <span id="Sx2.p5.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2017] Y. Mao, C. You, J.Zhang, K.Huang, and K. B. Letaief. A survey on mobile edge computing: The communication perspective.<span id="Sx2.p5.1.2" class="ltx_text ltx_font_italic">IEEECommunications Surveys &amp; Tutorials</span>, vol.19, no. 4, pp. 2322–2358,2017.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p6" class="ltx_para ltx_noindent">
<p id="Sx2.p6.1" class="ltx_p">[Chen <span id="Sx2.p6.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2015] X. Chen, L. Jiao, W. Li, and X. Fu. Efficient multi-user computation offloading for mobile-edge cloud computing. <span id="Sx2.p6.1.2" class="ltx_text ltx_font_italic">IEEE/ACM Transactions on Networking</span>, vol. 24, no. 5, pp. 2795–2808, 2015.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p7" class="ltx_para ltx_noindent">
<p id="Sx2.p7.1" class="ltx_p">[Abadi <span id="Sx2.p7.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2016] M. Abadi, A. Chu, I. Goodfellow, H. B. McMahan, I. Mironov, K. Talwar, and L. Zhang. Deep learning with differential privacy. In <span id="Sx2.p7.1.2" class="ltx_text ltx_font_italic">Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security.</span>, ACM pp. 308–318, 2016.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p8" class="ltx_para ltx_noindent">
<p id="Sx2.p8.1" class="ltx_p">[McMahan <span id="Sx2.p8.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2016] H. B. McMahan, E. Moore, D. Ramage, and B. A. y Arcas. ”Federated learning of deep networks using model averaging”, 2016.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p9" class="ltx_para ltx_noindent">
<p id="Sx2.p9.1" class="ltx_p">[Hard <span id="Sx2.p9.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2018] A. Hard, K. Rao, R. Mathews, F. Beaufays, S. Augenstein, H. Eichner, C. Kiddon, and D. Ramage. Federated learning for mobile keyboard prediction. <span id="Sx2.p9.1.2" class="ltx_text ltx_font_italic">arXiv preprint</span> arXiv:1811.03604, 2018.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p10" class="ltx_para ltx_noindent">
<p id="Sx2.p10.1" class="ltx_p">[Corinzia and Buhmann, 2019] Luca Corinzia, Joachim M. Buhmann. Variational Federated Multi-Task Learning.<span id="Sx2.p10.1.1" class="ltx_text ltx_font_italic">arXiv preprint</span> arXiv:1906.06268, 2019.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p11" class="ltx_para ltx_noindent">
<p id="Sx2.p11.1" class="ltx_p">[McMahan <span id="Sx2.p11.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2017] Brendan McMahan et al. Communication-Efficient Learning of Deep Networks from Decentralized Data. In <span id="Sx2.p11.1.2" class="ltx_text ltx_font_italic">Artificial Intelligence and Statistics</span> pp. 1273–1282, 2017.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p12" class="ltx_para ltx_noindent">
<p id="Sx2.p12.1" class="ltx_p">[Duan, 2019] M. Duan. Astraea: Self-balancing federated learning for improving classification accuracy of mobile deep learning applications. <span id="Sx2.p12.1.1" class="ltx_text ltx_font_italic">arXiv preprint</span> arXiv:1907.01132, 2019.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p13" class="ltx_para ltx_noindent">
<p id="Sx2.p13.1" class="ltx_p">[Lin <span id="Sx2.p13.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2018] T. Lin, P. Goyal, R. Girshick, K. He, and P. Dollar. Focal loss for dense object detection.<span id="Sx2.p13.1.2" class="ltx_text ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine Intelligence</span>, pp. 1–1, 2018.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p14" class="ltx_para ltx_noindent">
<p id="Sx2.p14.1" class="ltx_p">[McDonald <span id="Sx2.p14.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2010] Ryan McDonald, Keith Hall, and Gideon Mann.Distributed training strategies for the structured perceptron. In <span id="Sx2.p14.1.2" class="ltx_text ltx_font_italic">Human Language Technologies: The 2010 Annual Conference of the North American Chapter of the Association for Computational Linguistics. Association for Computational Linguistics</span>, pp. 456–464, 2010.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p15" class="ltx_para ltx_noindent">
<p id="Sx2.p15.1" class="ltx_p">[Zhao <span id="Sx2.p15.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2018] Yue Zhao et al. Federated learning with non-iid data. <span id="Sx2.p15.1.2" class="ltx_text ltx_font_italic">arXiv preprint</span> arXiv:1806.00582, 2018.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p16" class="ltx_para ltx_noindent">
<p id="Sx2.p16.1" class="ltx_p">[Smith <span id="Sx2.p16.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2017] Virginia Smith et al. Federated multi-task learning. <span id="Sx2.p16.1.2" class="ltx_text ltx_font_italic"> Advances in Neural Information Processing Systems</span>, pp. 4424–4434, 2017.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p17" class="ltx_para ltx_noindent">
<p id="Sx2.p17.1" class="ltx_p">[Liu <span id="Sx2.p17.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2016] W. Liu, D. Anguelov, D. Erhan, C. Szegedy, and S. Reed. SSD: Single shot multibox detector. In <span id="Sx2.p17.1.2" class="ltx_text ltx_font_italic">ECCV</span>, 2016.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p18" class="ltx_para ltx_noindent">
<p id="Sx2.p18.1" class="ltx_p">[Bulo <span id="Sx2.p18.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2017] S. R. Bulo, G. Neuhold, and P. Kontschieder. Loss max-pooling for semantic image segmentation. In <span id="Sx2.p18.1.2" class="ltx_text ltx_font_italic">CVPR</span>, 2017.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p19" class="ltx_para ltx_noindent">
<p id="Sx2.p19.1" class="ltx_p">[Hastie <span id="Sx2.p19.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2008] T. Hastie, R. Tibshirani, and J. Friedman. The elements of statistical learning. <span id="Sx2.p19.1.2" class="ltx_text ltx_font_italic">Springer series in statistics Springer, Berlin</span>, 2008.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p20" class="ltx_para ltx_noindent">
<p id="Sx2.p20.1" class="ltx_p">[Joyce, 2011] J. M. Joyce. Kullback-leibler divergence. <span id="Sx2.p20.1.1" class="ltx_text ltx_font_italic">International encyclopedia of statistical science</span>, pp. 720–722, 2011.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p21" class="ltx_para ltx_noindent">
<p id="Sx2.p21.1" class="ltx_p">[Duarte and Hu, 2004] Marco F Duarte and Yu Hen Hu.Vehicle classification in distributed sensor networks. <span id="Sx2.p21.1.1" class="ltx_text ltx_font_italic">Journal of Parallel and Distributed Computing</span> 64.7, pp. 826–838, 2004.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p22" class="ltx_para ltx_noindent">
<p id="Sx2.p22.1" class="ltx_p">[D Anguita <span id="Sx2.p22.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2013] D Anguita et al. A Public Domain Dataset for Human Activity Recognition using Smartphones .<span id="Sx2.p22.1.2" class="ltx_text ltx_font_italic">21th European Symposium on Artificial Neural Networks, Computational Intelligence and Machine Learning (ESANN)</span>, CIACO, pp. 437–442, 2013.
<br class="ltx_break"></p>
</div>
<div id="Sx2.p23" class="ltx_para ltx_noindent">
<p id="Sx2.p23.1" class="ltx_p">[Ryffel <span id="Sx2.p23.1.1" class="ltx_text ltx_font_italic">et al.</span>, 2018] T. Ryffel, A. Trask, M. Dahl, B. Wagner, J. Mancuso, D. Rueckert, and J. Passerat-Palmbach. A generic framework for privacy-preserving deep learning.<span id="Sx2.p23.1.2" class="ltx_text ltx_font_italic">arXiv preprint</span> arXiv:1811.04017, 2018</p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2011.06282" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2011.06283" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2011.06283">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2011.06283" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2011.06284" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar 19 05:03:41 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
