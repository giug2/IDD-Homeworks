<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision</title>
<!--Generated on Mon Sep 30 13:47:59 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Large Vision Models Segmentation Medical Prompt." lang="en" name="keywords"/>
<base href="/html/2409.20293v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S1" title="In Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2" title="In Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.SS1" title="In 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Preliminaries: MedSAM architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.SS2" title="In 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Lightweight prompt module</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.SS3" title="In 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Learning with tight box annotations</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S3" title="In Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S3.SS1" title="In 3 Results ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S3.SS2" title="In 3 Results ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Implementation details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S3.SS3" title="In 3 Results ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Validation on multiple medical segmentation tasks</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S4" title="In Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Conclusion</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S4.SS0.SSS1" title="In 4 Conclusion ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.0.1 </span><span class="ltx_ERROR undefined">\discintname</span></span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Automating MedSAM by Learning Prompts
<br class="ltx_break"/>with Weak Few-Shot Supervision</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Mélanie Gaillochet
</span><span class="ltx_author_notes">1ÉTS Montréal, Canada
12Polytechnique Montréal, Canada
23Mila - Quebec AI Institute, Université de Montréal, Canada3</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Christian Desrosiers
</span><span class="ltx_author_notes">1ÉTS Montréal, Canada
1</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hervé Lombaert
</span><span class="ltx_author_notes">112233</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Foundation models such as the recently introduced Segment Anything Model (SAM) have achieved remarkable results in image segmentation tasks. However, these models typically require user interaction through handcrafted prompts such as bounding boxes, which limits their deployment to downstream tasks. Adapting these models to a specific task with fully labeled data also demands expensive prior user interaction to obtain ground-truth annotations. This work proposes to replace conditioning on input prompts with a lightweight module that directly learns a prompt embedding from the image embedding, both of which are subsequently used by the foundation model to output a segmentation mask. Our foundation models with learnable prompts can automatically segment any specific region by 1) modifying the input through a prompt embedding predicted by a simple module, and 2) using weak labels (tight bounding boxes) and few-shot supervision (10 samples). Our approach is validated on MedSAM, a version of SAM fine-tuned for medical images, with results on three medical datasets in MR and ultrasound imaging. Our code is available on <a class="ltx_ref ltx_href" href="https://github.com/Minimel/MedSAMWeakFewShotPromptAutomation" title="">https://github.com/Minimel/MedSAMWeakFewShotPromptAutomation</a>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Large Vision Models Segmentation Medical Prompt.
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Annotation is a well-known labour-intensive and time-consuming task in medical imaging. Supervised segmentation models trained to identify specific regions of interest do not generalize well to new domains or classes and require more data and retraining when considering a new task. This increases the cost of developing segmentation models to solve multiple tasks. The need for universal models that can be applied to various tasks after training has hence been growing in medical image analysis. The introduction of foundation models for image segmentation such as the recent Segment Anything Model (SAM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib10" title="">10</a>]</cite>, as well as its versions adapted for medical imaging <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib21" title="">21</a>]</cite>, notably MedSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib12" title="">12</a>]</cite>, have appeared as a game-changer in the field of computer vision and medical image analysis. These models have shown remarkable performance on a variety of segmentation tasks. However, they remain promptable models that require user interaction to obtain the segmentation mask of a target object. Furthermore, their zero-shot performance depends on the quality of the user prompt. This reliance on user interaction hinders their integration into automatic pipelines and limits their usability at a large scale.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Recent attempts have been made to automate the prompt generation of SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib22" title="">22</a>]</cite>. However, these methods typically require samples with ground-truth segmentation masks, which are costly to obtain in the medical domain.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">This paper proposes a lightweight add-on prompt module which learns to generate prompt embeddings directly from SAM’s image embedding. Our end-to-end approach enables SAM models to specialize on the segmentation of a specific region and only requires few weakly-annotated samples. This reduces the interaction cost of developing specialized segmentation models. Our validation shows that, given only few training samples weakly annotated with tight boxes, promptable foundation model can effectively generate segmentation masks of target regions without requiring manual prompt inputs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1"><span class="ltx_text ltx_font_bold" id="S1.p4.1.1">Foundation models for medical image segmentation.</span>  Vision foundation models have achieved tremendous success in computer vision tasks thanks to large-scale pre-training. In particular, the Segment Anything Model (SAM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib10" title="">10</a>]</cite>, based on vision transformers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib5" title="">5</a>]</cite> and trained on 1B masks and 11M images, was recently introduced as a prompt-driven foundation model for segmentation. Trained on natural images, SAM obtains uneven performances on medical data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib18" title="">18</a>]</cite>, inducing its adaptation to the medical domain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib17" title="">17</a>]</cite>. In particular, MedSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib12" title="">12</a>]</cite>, a foundation model for universal medical image segmentation was trained on 1.5 million image-mask pairs over 10 imaging modalities. These models provide impressive zero-shot performance, but remain promptable models that require user interaction at inference.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_bold" id="S1.p5.1.1">Prompt automation for SAM.</span> 
Motivated by its performance in Natural Language Processing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib2" title="">2</a>]</cite>, prompt-tuning has successfully been applied to large vision models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib8" title="">8</a>]</cite>. Hence, methods that have focused on specializing SAM, a promptable model, have naturally explored prompt generation.
Given few fully labeled samples, the self-prompting unit of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib20" title="">20</a>]</cite> automatically generates a real point and bounding box from SAM’s image embedding. AutoSAM replaces SAM’s prompt encoder with a Harmonic Dense Net to adapt segmentation to medical images <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib17" title="">17</a>]</cite>.
A recent training-free approach, PerSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib22" title="">22</a>]</cite>, encodes positive-negative location priors as prompt tokens to produces automatic segmentations of a specific object from a single reference image and mask.
As opposed to our approach, all of these methods require samples with full segmentation masks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><span class="ltx_text ltx_font_bold" id="S1.p6.1.1">Segmentation with bounding box annotations.</span>  Bounding boxes have emerged as an alternative to onerous annotation masks. Most methods use bounding boxes as an initial pseudo-label of the target region. A classic iterative graph-cut-based algorithm, GrabCut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib16" title="">16</a>]</cite>, separates the foreground from its background given a bounding box. DeepCut <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib14" title="">14</a>]</cite> extends GrabCut to neural networks using existing heuristics. More recently, the bounding box tightness prior was adapted to deep learning-based models by imposing a set of constraints on the predictions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib9" title="">9</a>]</cite>, and was combined with multiple instance learning and smooth maximum approximation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib19" title="">19</a>]</cite>.
<br class="ltx_break"/></p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p7">
<p class="ltx_p" id="S1.p7.1"><span class="ltx_text ltx_font_bold" id="S1.p7.1.1">Our contribution.</span>  This work aims to efficiently automate MedSAM, a variant of SAM for the medical domain, to segment any target region through the use of few, weakly-labeled samples. Our approach introduces an innovative improvement by substituting the original prompt encoder, which requires user input, with an enhanced lightweight adaptable prompt-learning module that:</p>
<ol class="ltx_enumerate" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">Automatically <span class="ltx_text ltx_font_bold" id="S1.I1.i1.p1.1.1">generates a prompt embedding</span> from the input image</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Trains with only <span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.1">weak labels</span> (tight bounding boxes) and <span class="ltx_text ltx_font_bold" id="S1.I1.i2.p1.1.2">few-shot</span> learning</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;padding-top:2.5pt;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Is easily added on top of MedSAM (no fine-tuning)</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">The next sections present our proposed prompt module for MedSAM and demonstrate its usefulness on various medical image segmentation tasks.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methodology</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Preliminaries: MedSAM architecture</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.3">Our approach builds upon on MedSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib12" title="">12</a>]</cite>, a variant of SAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib10" title="">10</a>]</cite> fine-tuned on medical data. The model has three main components: a large image encoder <math alttext="\mathit{E}_{img}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><msub id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">E</mi><mrow id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.cmml">i</mi><mo id="S2.SS1.p1.1.m1.1.1.3.1" xref="S2.SS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.1.m1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.cmml">m</mi><mo id="S2.SS1.p1.1.m1.1.1.3.1a" xref="S2.SS1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.1.m1.1.1.3.4" xref="S2.SS1.p1.1.m1.1.1.3.4.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝐸</ci><apply id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><times id="S2.SS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.1"></times><ci id="S2.SS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2">𝑖</ci><ci id="S2.SS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3">𝑚</ci><ci id="S2.SS1.p1.1.m1.1.1.3.4.cmml" xref="S2.SS1.p1.1.m1.1.1.3.4">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathit{E}_{img}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_E start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, a prompt encoder <math alttext="\mathit{E}_{pr}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><msub id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">E</mi><mrow id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml"><mi id="S2.SS1.p1.2.m2.1.1.3.2" xref="S2.SS1.p1.2.m2.1.1.3.2.cmml">p</mi><mo id="S2.SS1.p1.2.m2.1.1.3.1" xref="S2.SS1.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.2.m2.1.1.3.3" xref="S2.SS1.p1.2.m2.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝐸</ci><apply id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3"><times id="S2.SS1.p1.2.m2.1.1.3.1.cmml" xref="S2.SS1.p1.2.m2.1.1.3.1"></times><ci id="S2.SS1.p1.2.m2.1.1.3.2.cmml" xref="S2.SS1.p1.2.m2.1.1.3.2">𝑝</ci><ci id="S2.SS1.p1.2.m2.1.1.3.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\mathit{E}_{pr}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_E start_POSTSUBSCRIPT italic_p italic_r end_POSTSUBSCRIPT</annotation></semantics></math> and a lightweight mask decoder <math alttext="\mathit{D}_{mask}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">D</mi><mrow id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml"><mi id="S2.SS1.p1.3.m3.1.1.3.2" xref="S2.SS1.p1.3.m3.1.1.3.2.cmml">m</mi><mo id="S2.SS1.p1.3.m3.1.1.3.1" xref="S2.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.3.m3.1.1.3.3" xref="S2.SS1.p1.3.m3.1.1.3.3.cmml">a</mi><mo id="S2.SS1.p1.3.m3.1.1.3.1a" xref="S2.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.3.m3.1.1.3.4" xref="S2.SS1.p1.3.m3.1.1.3.4.cmml">s</mi><mo id="S2.SS1.p1.3.m3.1.1.3.1b" xref="S2.SS1.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S2.SS1.p1.3.m3.1.1.3.5" xref="S2.SS1.p1.3.m3.1.1.3.5.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝐷</ci><apply id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3"><times id="S2.SS1.p1.3.m3.1.1.3.1.cmml" xref="S2.SS1.p1.3.m3.1.1.3.1"></times><ci id="S2.SS1.p1.3.m3.1.1.3.2.cmml" xref="S2.SS1.p1.3.m3.1.1.3.2">𝑚</ci><ci id="S2.SS1.p1.3.m3.1.1.3.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3.3">𝑎</ci><ci id="S2.SS1.p1.3.m3.1.1.3.4.cmml" xref="S2.SS1.p1.3.m3.1.1.3.4">𝑠</ci><ci id="S2.SS1.p1.3.m3.1.1.3.5.cmml" xref="S2.SS1.p1.3.m3.1.1.3.5">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\mathit{D}_{mask}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_D start_POSTSUBSCRIPT italic_m italic_a italic_s italic_k end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.5">While the image encoder computes an embedding of the input image <math alttext="x" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_x</annotation></semantics></math>, the prompt encoder outputs two sparse and dense embeddings from the provided set of prompts <math alttext="[pr]" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.1"><semantics id="S2.SS1.p2.2.m2.1a"><mrow id="S2.SS1.p2.2.m2.1.1.1" xref="S2.SS1.p2.2.m2.1.1.2.cmml"><mo id="S2.SS1.p2.2.m2.1.1.1.2" stretchy="false" xref="S2.SS1.p2.2.m2.1.1.2.1.cmml">[</mo><mrow id="S2.SS1.p2.2.m2.1.1.1.1" xref="S2.SS1.p2.2.m2.1.1.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.1.1.2" xref="S2.SS1.p2.2.m2.1.1.1.1.2.cmml">p</mi><mo id="S2.SS1.p2.2.m2.1.1.1.1.1" xref="S2.SS1.p2.2.m2.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p2.2.m2.1.1.1.1.3" xref="S2.SS1.p2.2.m2.1.1.1.1.3.cmml">r</mi></mrow><mo id="S2.SS1.p2.2.m2.1.1.1.3" stretchy="false" xref="S2.SS1.p2.2.m2.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.2.m2.1.1.2.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p2.2.m2.1.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1.1"><times id="S2.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1.1.1.1"></times><ci id="S2.SS1.p2.2.m2.1.1.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1.1.1.2">𝑝</ci><ci id="S2.SS1.p2.2.m2.1.1.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.1.1.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">[pr]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.1d">[ italic_p italic_r ]</annotation></semantics></math>, respectively points or bounding boxes (BB), and a mask. The network produces a probability map <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><msub id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><mi id="S2.SS1.p2.3.m3.1.1.2" xref="S2.SS1.p2.3.m3.1.1.2.cmml">f</mi><mi id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2">𝑓</ci><ci id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> by taking <math alttext="x" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><mi id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><ci id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">italic_x</annotation></semantics></math> and a prompt embedding <math alttext="Z_{pr}=\mathit{E}_{pr}([pr])" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><mrow id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml"><msub id="S2.SS1.p2.5.m5.1.1.3" xref="S2.SS1.p2.5.m5.1.1.3.cmml"><mi id="S2.SS1.p2.5.m5.1.1.3.2" xref="S2.SS1.p2.5.m5.1.1.3.2.cmml">Z</mi><mrow id="S2.SS1.p2.5.m5.1.1.3.3" xref="S2.SS1.p2.5.m5.1.1.3.3.cmml"><mi id="S2.SS1.p2.5.m5.1.1.3.3.2" xref="S2.SS1.p2.5.m5.1.1.3.3.2.cmml">p</mi><mo id="S2.SS1.p2.5.m5.1.1.3.3.1" xref="S2.SS1.p2.5.m5.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.5.m5.1.1.3.3.3" xref="S2.SS1.p2.5.m5.1.1.3.3.3.cmml">r</mi></mrow></msub><mo id="S2.SS1.p2.5.m5.1.1.2" xref="S2.SS1.p2.5.m5.1.1.2.cmml">=</mo><mrow id="S2.SS1.p2.5.m5.1.1.1" xref="S2.SS1.p2.5.m5.1.1.1.cmml"><msub id="S2.SS1.p2.5.m5.1.1.1.3" xref="S2.SS1.p2.5.m5.1.1.1.3.cmml"><mi id="S2.SS1.p2.5.m5.1.1.1.3.2" xref="S2.SS1.p2.5.m5.1.1.1.3.2.cmml">E</mi><mrow id="S2.SS1.p2.5.m5.1.1.1.3.3" xref="S2.SS1.p2.5.m5.1.1.1.3.3.cmml"><mi id="S2.SS1.p2.5.m5.1.1.1.3.3.2" xref="S2.SS1.p2.5.m5.1.1.1.3.3.2.cmml">p</mi><mo id="S2.SS1.p2.5.m5.1.1.1.3.3.1" xref="S2.SS1.p2.5.m5.1.1.1.3.3.1.cmml">⁢</mo><mi id="S2.SS1.p2.5.m5.1.1.1.3.3.3" xref="S2.SS1.p2.5.m5.1.1.1.3.3.3.cmml">r</mi></mrow></msub><mo id="S2.SS1.p2.5.m5.1.1.1.2" xref="S2.SS1.p2.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p2.5.m5.1.1.1.1.1" xref="S2.SS1.p2.5.m5.1.1.1.cmml"><mo id="S2.SS1.p2.5.m5.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.5.m5.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.2.cmml"><mo id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.2.cmml">p</mi><mo id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.3.cmml">r</mi></mrow><mo id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.2.1.cmml">]</mo></mrow><mo id="S2.SS1.p2.5.m5.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.5.m5.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><apply id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1"><eq id="S2.SS1.p2.5.m5.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.2"></eq><apply id="S2.SS1.p2.5.m5.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.1.1.3.1.cmml" xref="S2.SS1.p2.5.m5.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.5.m5.1.1.3.2.cmml" xref="S2.SS1.p2.5.m5.1.1.3.2">𝑍</ci><apply id="S2.SS1.p2.5.m5.1.1.3.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3.3"><times id="S2.SS1.p2.5.m5.1.1.3.3.1.cmml" xref="S2.SS1.p2.5.m5.1.1.3.3.1"></times><ci id="S2.SS1.p2.5.m5.1.1.3.3.2.cmml" xref="S2.SS1.p2.5.m5.1.1.3.3.2">𝑝</ci><ci id="S2.SS1.p2.5.m5.1.1.3.3.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3.3.3">𝑟</ci></apply></apply><apply id="S2.SS1.p2.5.m5.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1"><times id="S2.SS1.p2.5.m5.1.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.1.2"></times><apply id="S2.SS1.p2.5.m5.1.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.1.1.1.3.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.5.m5.1.1.1.3.2.cmml" xref="S2.SS1.p2.5.m5.1.1.1.3.2">𝐸</ci><apply id="S2.SS1.p2.5.m5.1.1.1.3.3.cmml" xref="S2.SS1.p2.5.m5.1.1.1.3.3"><times id="S2.SS1.p2.5.m5.1.1.1.3.3.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1.3.3.1"></times><ci id="S2.SS1.p2.5.m5.1.1.1.3.3.2.cmml" xref="S2.SS1.p2.5.m5.1.1.1.3.3.2">𝑝</ci><ci id="S2.SS1.p2.5.m5.1.1.1.3.3.3.cmml" xref="S2.SS1.p2.5.m5.1.1.1.3.3.3">𝑟</ci></apply></apply><apply id="S2.SS1.p2.5.m5.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1"><times id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.1"></times><ci id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.1.1.1.1.1.1.3">𝑟</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">Z_{pr}=\mathit{E}_{pr}([pr])</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">italic_Z start_POSTSUBSCRIPT italic_p italic_r end_POSTSUBSCRIPT = italic_E start_POSTSUBSCRIPT italic_p italic_r end_POSTSUBSCRIPT ( [ italic_p italic_r ] )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f_{\theta}=\sigma\big{(}\mathit{D}_{mask}(\mathit{E}_{img}(x),\,Z_{pr})\big{)}," class="ltx_Math" display="block" id="S2.Ex1.m1.2"><semantics id="S2.Ex1.m1.2a"><mrow id="S2.Ex1.m1.2.2.1" xref="S2.Ex1.m1.2.2.1.1.cmml"><mrow id="S2.Ex1.m1.2.2.1.1" xref="S2.Ex1.m1.2.2.1.1.cmml"><msub id="S2.Ex1.m1.2.2.1.1.3" xref="S2.Ex1.m1.2.2.1.1.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.3.2" xref="S2.Ex1.m1.2.2.1.1.3.2.cmml">f</mi><mi id="S2.Ex1.m1.2.2.1.1.3.3" xref="S2.Ex1.m1.2.2.1.1.3.3.cmml">θ</mi></msub><mo id="S2.Ex1.m1.2.2.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.Ex1.m1.2.2.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.3.cmml">σ</mi><mo id="S2.Ex1.m1.2.2.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.2.cmml">D</mi><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.2.cmml">m</mi><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.3.cmml">a</mi><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.1a" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.4" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.4.cmml">s</mi><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.1b" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.5" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.5.cmml">k</mi></mrow></msub><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">E</mi><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3.cmml">m</mi><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1a" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.4" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.4.cmml">g</mi></mrow></msub><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">x</mi><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.4" rspace="0.337em" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml">Z</mi><mrow id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml">p</mi><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml">r</mi></mrow></msub><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex1.m1.2.2.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex1.m1.2.2.1.2" xref="S2.Ex1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.2b"><apply id="S2.Ex1.m1.2.2.1.1.cmml" xref="S2.Ex1.m1.2.2.1"><eq id="S2.Ex1.m1.2.2.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2"></eq><apply id="S2.Ex1.m1.2.2.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.3.2">𝑓</ci><ci id="S2.Ex1.m1.2.2.1.1.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.3.3">𝜃</ci></apply><apply id="S2.Ex1.m1.2.2.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1"><times id="S2.Ex1.m1.2.2.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.2"></times><ci id="S2.Ex1.m1.2.2.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.3">𝜎</ci><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1"><times id="S2.Ex1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.3"></times><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.2">𝐷</ci><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3"><times id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.1"></times><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.2">𝑚</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.3">𝑎</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.4.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.4">𝑠</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.5.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.4.3.5">𝑘</ci></apply></apply><interval closure="open" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2"><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1"><times id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.1"></times><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝐸</ci><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3"><times id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2">𝑖</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3">𝑚</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.4">𝑔</ci></apply></apply><ci id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">𝑥</ci></apply><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.2">𝑍</ci><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3"><times id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.1"></times><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.2">𝑝</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.2.2.3.3">𝑟</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.2c">f_{\theta}=\sigma\big{(}\mathit{D}_{mask}(\mathit{E}_{img}(x),\,Z_{pr})\big{)},</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.2d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT = italic_σ ( italic_D start_POSTSUBSCRIPT italic_m italic_a italic_s italic_k end_POSTSUBSCRIPT ( italic_E start_POSTSUBSCRIPT italic_i italic_m italic_g end_POSTSUBSCRIPT ( italic_x ) , italic_Z start_POSTSUBSCRIPT italic_p italic_r end_POSTSUBSCRIPT ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.6">where <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m1.1"><semantics id="S2.SS1.p2.6.m1.1a"><mi id="S2.SS1.p2.6.m1.1.1" xref="S2.SS1.p2.6.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m1.1b"><ci id="S2.SS1.p2.6.m1.1.1.cmml" xref="S2.SS1.p2.6.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m1.1d">italic_σ</annotation></semantics></math> is the sigmoid function.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">We present an end-to-end approach to remove the typical dependence on user-defined prompts <math alttext="[pr]" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1"><semantics id="S2.SS1.p3.1.m1.1a"><mrow id="S2.SS1.p3.1.m1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.2.cmml"><mo id="S2.SS1.p3.1.m1.1.1.1.2" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.2.1.cmml">[</mo><mrow id="S2.SS1.p3.1.m1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.cmml"><mi id="S2.SS1.p3.1.m1.1.1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.1.1.2.cmml">p</mi><mo id="S2.SS1.p3.1.m1.1.1.1.1.1" xref="S2.SS1.p3.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS1.p3.1.m1.1.1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.1.1.3.cmml">r</mi></mrow><mo id="S2.SS1.p3.1.m1.1.1.1.3" stretchy="false" xref="S2.SS1.p3.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p3.1.m1.1.1.2.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS1.p3.1.m1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1"><times id="S2.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.1"></times><ci id="S2.SS1.p3.1.m1.1.1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.2">𝑝</ci><ci id="S2.SS1.p3.1.m1.1.1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.1.1.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">[pr]</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">[ italic_p italic_r ]</annotation></semantics></math>, without modifying the pretrained MedSAM network.</p>
</div>
<figure class="ltx_figure" id="S2.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="191" id="S2.F1.sf1.g1" src="extracted/5890050/figures/SAM.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S2.F1.sf1.3.2" style="font-size:90%;">Promptable MedSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib12" title="">12</a>]</cite></span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="261" id="S2.F1.sf2.g1" src="extracted/5890050/figures/Ours.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S2.F1.sf2.3.2" style="font-size:90%;">Automatic MedSAM (ours)</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S2.F1.3.2" style="font-size:90%;">Comparison between (<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.F1.sf1" title="In Figure 1 ‣ 2.1 Preliminaries: MedSAM architecture ‣ 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">1(a)</span></a>) MedSAM and (<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.F1.sf2" title="In Figure 1 ‣ 2.1 Preliminaries: MedSAM architecture ‣ 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">1(b)</span></a>) our automation of MedSAM via a learnt prompt module. Our prompt module replaces MedSAM’s prompt encoder and learns to generate a relevant prompt embedding from the image embedding. Training employs losses that utilize only tight box labels.
</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Lightweight prompt module</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Our approach consists of a prompt module trained to compute directly <math alttext="Z_{pr}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1"><semantics id="S2.SS2.p1.1.m1.1a"><msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml"><mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">Z</mi><mrow id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml"><mi id="S2.SS2.p1.1.m1.1.1.3.2" xref="S2.SS2.p1.1.m1.1.1.3.2.cmml">p</mi><mo id="S2.SS2.p1.1.m1.1.1.3.1" xref="S2.SS2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S2.SS2.p1.1.m1.1.1.3.3" xref="S2.SS2.p1.1.m1.1.1.3.3.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b"><apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">𝑍</ci><apply id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3"><times id="S2.SS2.p1.1.m1.1.1.3.1.cmml" xref="S2.SS2.p1.1.m1.1.1.3.1"></times><ci id="S2.SS2.p1.1.m1.1.1.3.2.cmml" xref="S2.SS2.p1.1.m1.1.1.3.2">𝑝</ci><ci id="S2.SS2.p1.1.m1.1.1.3.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">Z_{pr}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p1.1.m1.1d">italic_Z start_POSTSUBSCRIPT italic_p italic_r end_POSTSUBSCRIPT</annotation></semantics></math> from the image embedding provided by MedSAM (see Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.F1.sf2" title="In Figure 1 ‣ 2.1 Preliminaries: MedSAM architecture ‣ 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">1(b)</span></a>). The module outputs two embeddings of the same shape as those generated by MedSAM (Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.F1.sf1" title="In Figure 1 ‣ 2.1 Preliminaries: MedSAM architecture ‣ 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">1(a)</span></a>). Originally, the dense prompt embedding has a spatial correspondence with the image and can be considered as a low-quality segmentation map, while the sparse embeddings are spatial encodings of coordinates. Therefore, our prompt module generates a dense embedding through a convolutional layer and a sparse embedding through a fully connected (FC) layer.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Learning with tight box annotations</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.11">Denote as <math alttext="X:\Upomega\subset\mathbb{R}^{3\times H\times W}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1"><semantics id="S2.SS3.p1.1.m1.1a"><mrow id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml"><mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">X</mi><mo id="S2.SS3.p1.1.m1.1.1.1" lspace="0.278em" rspace="0.278em" xref="S2.SS3.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml"><mi id="S2.SS3.p1.1.m1.1.1.3.2" mathvariant="normal" xref="S2.SS3.p1.1.m1.1.1.3.2.cmml">Ω</mi><mo id="S2.SS3.p1.1.m1.1.1.3.3" xref="S2.SS3.p1.1.m1.1.1.3.3.cmml">⊂</mo><msup id="S2.SS3.p1.1.m1.1.1.3.4" xref="S2.SS3.p1.1.m1.1.1.3.4.cmml"><mi id="S2.SS3.p1.1.m1.1.1.3.4.2" xref="S2.SS3.p1.1.m1.1.1.3.4.2.cmml">ℝ</mi><mrow id="S2.SS3.p1.1.m1.1.1.3.4.3" xref="S2.SS3.p1.1.m1.1.1.3.4.3.cmml"><mn id="S2.SS3.p1.1.m1.1.1.3.4.3.2" xref="S2.SS3.p1.1.m1.1.1.3.4.3.2.cmml">3</mn><mo id="S2.SS3.p1.1.m1.1.1.3.4.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p1.1.m1.1.1.3.4.3.1.cmml">×</mo><mi id="S2.SS3.p1.1.m1.1.1.3.4.3.3" xref="S2.SS3.p1.1.m1.1.1.3.4.3.3.cmml">H</mi><mo id="S2.SS3.p1.1.m1.1.1.3.4.3.1a" lspace="0.222em" rspace="0.222em" xref="S2.SS3.p1.1.m1.1.1.3.4.3.1.cmml">×</mo><mi id="S2.SS3.p1.1.m1.1.1.3.4.3.4" xref="S2.SS3.p1.1.m1.1.1.3.4.3.4.cmml">W</mi></mrow></msup><mo id="S2.SS3.p1.1.m1.1.1.3.5" stretchy="false" xref="S2.SS3.p1.1.m1.1.1.3.5.cmml">→</mo><mi id="S2.SS3.p1.1.m1.1.1.3.6" xref="S2.SS3.p1.1.m1.1.1.3.6.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b"><apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1"><ci id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1.1">:</ci><ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">𝑋</ci><apply id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3"><and id="S2.SS3.p1.1.m1.1.1.3a.cmml" xref="S2.SS3.p1.1.m1.1.1.3"></and><apply id="S2.SS3.p1.1.m1.1.1.3b.cmml" xref="S2.SS3.p1.1.m1.1.1.3"><subset id="S2.SS3.p1.1.m1.1.1.3.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3.3"></subset><ci id="S2.SS3.p1.1.m1.1.1.3.2.cmml" xref="S2.SS3.p1.1.m1.1.1.3.2">Ω</ci><apply id="S2.SS3.p1.1.m1.1.1.3.4.cmml" xref="S2.SS3.p1.1.m1.1.1.3.4"><csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.3.4.1.cmml" xref="S2.SS3.p1.1.m1.1.1.3.4">superscript</csymbol><ci id="S2.SS3.p1.1.m1.1.1.3.4.2.cmml" xref="S2.SS3.p1.1.m1.1.1.3.4.2">ℝ</ci><apply id="S2.SS3.p1.1.m1.1.1.3.4.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3.4.3"><times id="S2.SS3.p1.1.m1.1.1.3.4.3.1.cmml" xref="S2.SS3.p1.1.m1.1.1.3.4.3.1"></times><cn id="S2.SS3.p1.1.m1.1.1.3.4.3.2.cmml" type="integer" xref="S2.SS3.p1.1.m1.1.1.3.4.3.2">3</cn><ci id="S2.SS3.p1.1.m1.1.1.3.4.3.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3.4.3.3">𝐻</ci><ci id="S2.SS3.p1.1.m1.1.1.3.4.3.4.cmml" xref="S2.SS3.p1.1.m1.1.1.3.4.3.4">𝑊</ci></apply></apply></apply><apply id="S2.SS3.p1.1.m1.1.1.3c.cmml" xref="S2.SS3.p1.1.m1.1.1.3"><ci id="S2.SS3.p1.1.m1.1.1.3.5.cmml" xref="S2.SS3.p1.1.m1.1.1.3.5">→</ci><share href="https://arxiv.org/html/2409.20293v1#S2.SS3.p1.1.m1.1.1.3.4.cmml" id="S2.SS3.p1.1.m1.1.1.3d.cmml" xref="S2.SS3.p1.1.m1.1.1.3"></share><ci id="S2.SS3.p1.1.m1.1.1.3.6.cmml" xref="S2.SS3.p1.1.m1.1.1.3.6">ℝ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">X:\Upomega\subset\mathbb{R}^{3\times H\times W}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.1.m1.1d">italic_X : roman_Ω ⊂ blackboard_R start_POSTSUPERSCRIPT 3 × italic_H × italic_W end_POSTSUPERSCRIPT → blackboard_R</annotation></semantics></math> a 3-channel input image of height <math alttext="H" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1"><semantics id="S2.SS3.p1.2.m2.1a"><mi id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b"><ci id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">H</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.2.m2.1d">italic_H</annotation></semantics></math> and width <math alttext="W" class="ltx_Math" display="inline" id="S2.SS3.p1.3.m3.1"><semantics id="S2.SS3.p1.3.m3.1a"><mi id="S2.SS3.p1.3.m3.1.1" xref="S2.SS3.p1.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m3.1b"><ci id="S2.SS3.p1.3.m3.1.1.cmml" xref="S2.SS3.p1.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.3.m3.1c">W</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.3.m3.1d">italic_W</annotation></semantics></math>, where <math alttext="\Upomega" class="ltx_Math" display="inline" id="S2.SS3.p1.4.m4.1"><semantics id="S2.SS3.p1.4.m4.1a"><mi id="S2.SS3.p1.4.m4.1.1" mathvariant="normal" xref="S2.SS3.p1.4.m4.1.1.cmml">Ω</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m4.1b"><ci id="S2.SS3.p1.4.m4.1.1.cmml" xref="S2.SS3.p1.4.m4.1.1">Ω</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.4.m4.1c">\Upomega</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.4.m4.1d">roman_Ω</annotation></semantics></math> is the spatial domain corresponding to each channel of the image. Moreover, let <math alttext="Y\in\{0,1\}^{\Upomega}" class="ltx_Math" display="inline" id="S2.SS3.p1.5.m5.2"><semantics id="S2.SS3.p1.5.m5.2a"><mrow id="S2.SS3.p1.5.m5.2.3" xref="S2.SS3.p1.5.m5.2.3.cmml"><mi id="S2.SS3.p1.5.m5.2.3.2" xref="S2.SS3.p1.5.m5.2.3.2.cmml">Y</mi><mo id="S2.SS3.p1.5.m5.2.3.1" xref="S2.SS3.p1.5.m5.2.3.1.cmml">∈</mo><msup id="S2.SS3.p1.5.m5.2.3.3" xref="S2.SS3.p1.5.m5.2.3.3.cmml"><mrow id="S2.SS3.p1.5.m5.2.3.3.2.2" xref="S2.SS3.p1.5.m5.2.3.3.2.1.cmml"><mo id="S2.SS3.p1.5.m5.2.3.3.2.2.1" stretchy="false" xref="S2.SS3.p1.5.m5.2.3.3.2.1.cmml">{</mo><mn id="S2.SS3.p1.5.m5.1.1" xref="S2.SS3.p1.5.m5.1.1.cmml">0</mn><mo id="S2.SS3.p1.5.m5.2.3.3.2.2.2" xref="S2.SS3.p1.5.m5.2.3.3.2.1.cmml">,</mo><mn id="S2.SS3.p1.5.m5.2.2" xref="S2.SS3.p1.5.m5.2.2.cmml">1</mn><mo id="S2.SS3.p1.5.m5.2.3.3.2.2.3" stretchy="false" xref="S2.SS3.p1.5.m5.2.3.3.2.1.cmml">}</mo></mrow><mi id="S2.SS3.p1.5.m5.2.3.3.3" mathvariant="normal" xref="S2.SS3.p1.5.m5.2.3.3.3.cmml">Ω</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m5.2b"><apply id="S2.SS3.p1.5.m5.2.3.cmml" xref="S2.SS3.p1.5.m5.2.3"><in id="S2.SS3.p1.5.m5.2.3.1.cmml" xref="S2.SS3.p1.5.m5.2.3.1"></in><ci id="S2.SS3.p1.5.m5.2.3.2.cmml" xref="S2.SS3.p1.5.m5.2.3.2">𝑌</ci><apply id="S2.SS3.p1.5.m5.2.3.3.cmml" xref="S2.SS3.p1.5.m5.2.3.3"><csymbol cd="ambiguous" id="S2.SS3.p1.5.m5.2.3.3.1.cmml" xref="S2.SS3.p1.5.m5.2.3.3">superscript</csymbol><set id="S2.SS3.p1.5.m5.2.3.3.2.1.cmml" xref="S2.SS3.p1.5.m5.2.3.3.2.2"><cn id="S2.SS3.p1.5.m5.1.1.cmml" type="integer" xref="S2.SS3.p1.5.m5.1.1">0</cn><cn id="S2.SS3.p1.5.m5.2.2.cmml" type="integer" xref="S2.SS3.p1.5.m5.2.2">1</cn></set><ci id="S2.SS3.p1.5.m5.2.3.3.3.cmml" xref="S2.SS3.p1.5.m5.2.3.3.3">Ω</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.5.m5.2c">Y\in\{0,1\}^{\Upomega}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.5.m5.2d">italic_Y ∈ { 0 , 1 } start_POSTSUPERSCRIPT roman_Ω end_POSTSUPERSCRIPT</annotation></semantics></math> be the ground-truth binary segmentation mask of <math alttext="X" class="ltx_Math" display="inline" id="S2.SS3.p1.6.m6.1"><semantics id="S2.SS3.p1.6.m6.1a"><mi id="S2.SS3.p1.6.m6.1.1" xref="S2.SS3.p1.6.m6.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m6.1b"><ci id="S2.SS3.p1.6.m6.1.1.cmml" xref="S2.SS3.p1.6.m6.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.6.m6.1c">X</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.6.m6.1d">italic_X</annotation></semantics></math>. Suppose we only have access to a tight bounding box <math alttext="\tilde{Y}" class="ltx_Math" display="inline" id="S2.SS3.p1.7.m7.1"><semantics id="S2.SS3.p1.7.m7.1a"><mover accent="true" id="S2.SS3.p1.7.m7.1.1" xref="S2.SS3.p1.7.m7.1.1.cmml"><mi id="S2.SS3.p1.7.m7.1.1.2" xref="S2.SS3.p1.7.m7.1.1.2.cmml">Y</mi><mo id="S2.SS3.p1.7.m7.1.1.1" xref="S2.SS3.p1.7.m7.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.7.m7.1b"><apply id="S2.SS3.p1.7.m7.1.1.cmml" xref="S2.SS3.p1.7.m7.1.1"><ci id="S2.SS3.p1.7.m7.1.1.1.cmml" xref="S2.SS3.p1.7.m7.1.1.1">~</ci><ci id="S2.SS3.p1.7.m7.1.1.2.cmml" xref="S2.SS3.p1.7.m7.1.1.2">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.7.m7.1c">\tilde{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.7.m7.1d">over~ start_ARG italic_Y end_ARG</annotation></semantics></math> of the target. <math alttext="\Upomega_{I}" class="ltx_Math" display="inline" id="S2.SS3.p1.8.m8.1"><semantics id="S2.SS3.p1.8.m8.1a"><msub id="S2.SS3.p1.8.m8.1.1" xref="S2.SS3.p1.8.m8.1.1.cmml"><mi id="S2.SS3.p1.8.m8.1.1.2" mathvariant="normal" xref="S2.SS3.p1.8.m8.1.1.2.cmml">Ω</mi><mi id="S2.SS3.p1.8.m8.1.1.3" xref="S2.SS3.p1.8.m8.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.8.m8.1b"><apply id="S2.SS3.p1.8.m8.1.1.cmml" xref="S2.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.8.m8.1.1.1.cmml" xref="S2.SS3.p1.8.m8.1.1">subscript</csymbol><ci id="S2.SS3.p1.8.m8.1.1.2.cmml" xref="S2.SS3.p1.8.m8.1.1.2">Ω</ci><ci id="S2.SS3.p1.8.m8.1.1.3.cmml" xref="S2.SS3.p1.8.m8.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.8.m8.1c">\Upomega_{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.8.m8.1d">roman_Ω start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\Upomega_{O}" class="ltx_Math" display="inline" id="S2.SS3.p1.9.m9.1"><semantics id="S2.SS3.p1.9.m9.1a"><msub id="S2.SS3.p1.9.m9.1.1" xref="S2.SS3.p1.9.m9.1.1.cmml"><mi id="S2.SS3.p1.9.m9.1.1.2" mathvariant="normal" xref="S2.SS3.p1.9.m9.1.1.2.cmml">Ω</mi><mi id="S2.SS3.p1.9.m9.1.1.3" xref="S2.SS3.p1.9.m9.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.9.m9.1b"><apply id="S2.SS3.p1.9.m9.1.1.cmml" xref="S2.SS3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS3.p1.9.m9.1.1.1.cmml" xref="S2.SS3.p1.9.m9.1.1">subscript</csymbol><ci id="S2.SS3.p1.9.m9.1.1.2.cmml" xref="S2.SS3.p1.9.m9.1.1.2">Ω</ci><ci id="S2.SS3.p1.9.m9.1.1.3.cmml" xref="S2.SS3.p1.9.m9.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.9.m9.1c">\Upomega_{O}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.9.m9.1d">roman_Ω start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math> define the regions respectively inside and outside the bounding box such that <math alttext="\Upomega_{I}+\Upomega_{O}=\Upomega" class="ltx_Math" display="inline" id="S2.SS3.p1.10.m10.1"><semantics id="S2.SS3.p1.10.m10.1a"><mrow id="S2.SS3.p1.10.m10.1.1" xref="S2.SS3.p1.10.m10.1.1.cmml"><mrow id="S2.SS3.p1.10.m10.1.1.2" xref="S2.SS3.p1.10.m10.1.1.2.cmml"><msub id="S2.SS3.p1.10.m10.1.1.2.2" xref="S2.SS3.p1.10.m10.1.1.2.2.cmml"><mi id="S2.SS3.p1.10.m10.1.1.2.2.2" mathvariant="normal" xref="S2.SS3.p1.10.m10.1.1.2.2.2.cmml">Ω</mi><mi id="S2.SS3.p1.10.m10.1.1.2.2.3" xref="S2.SS3.p1.10.m10.1.1.2.2.3.cmml">I</mi></msub><mo id="S2.SS3.p1.10.m10.1.1.2.1" xref="S2.SS3.p1.10.m10.1.1.2.1.cmml">+</mo><msub id="S2.SS3.p1.10.m10.1.1.2.3" xref="S2.SS3.p1.10.m10.1.1.2.3.cmml"><mi id="S2.SS3.p1.10.m10.1.1.2.3.2" mathvariant="normal" xref="S2.SS3.p1.10.m10.1.1.2.3.2.cmml">Ω</mi><mi id="S2.SS3.p1.10.m10.1.1.2.3.3" xref="S2.SS3.p1.10.m10.1.1.2.3.3.cmml">O</mi></msub></mrow><mo id="S2.SS3.p1.10.m10.1.1.1" xref="S2.SS3.p1.10.m10.1.1.1.cmml">=</mo><mi id="S2.SS3.p1.10.m10.1.1.3" mathvariant="normal" xref="S2.SS3.p1.10.m10.1.1.3.cmml">Ω</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.10.m10.1b"><apply id="S2.SS3.p1.10.m10.1.1.cmml" xref="S2.SS3.p1.10.m10.1.1"><eq id="S2.SS3.p1.10.m10.1.1.1.cmml" xref="S2.SS3.p1.10.m10.1.1.1"></eq><apply id="S2.SS3.p1.10.m10.1.1.2.cmml" xref="S2.SS3.p1.10.m10.1.1.2"><plus id="S2.SS3.p1.10.m10.1.1.2.1.cmml" xref="S2.SS3.p1.10.m10.1.1.2.1"></plus><apply id="S2.SS3.p1.10.m10.1.1.2.2.cmml" xref="S2.SS3.p1.10.m10.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p1.10.m10.1.1.2.2.1.cmml" xref="S2.SS3.p1.10.m10.1.1.2.2">subscript</csymbol><ci id="S2.SS3.p1.10.m10.1.1.2.2.2.cmml" xref="S2.SS3.p1.10.m10.1.1.2.2.2">Ω</ci><ci id="S2.SS3.p1.10.m10.1.1.2.2.3.cmml" xref="S2.SS3.p1.10.m10.1.1.2.2.3">𝐼</ci></apply><apply id="S2.SS3.p1.10.m10.1.1.2.3.cmml" xref="S2.SS3.p1.10.m10.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS3.p1.10.m10.1.1.2.3.1.cmml" xref="S2.SS3.p1.10.m10.1.1.2.3">subscript</csymbol><ci id="S2.SS3.p1.10.m10.1.1.2.3.2.cmml" xref="S2.SS3.p1.10.m10.1.1.2.3.2">Ω</ci><ci id="S2.SS3.p1.10.m10.1.1.2.3.3.cmml" xref="S2.SS3.p1.10.m10.1.1.2.3.3">𝑂</ci></apply></apply><ci id="S2.SS3.p1.10.m10.1.1.3.cmml" xref="S2.SS3.p1.10.m10.1.1.3">Ω</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.10.m10.1c">\Upomega_{I}+\Upomega_{O}=\Upomega</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.10.m10.1d">roman_Ω start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT + roman_Ω start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT = roman_Ω</annotation></semantics></math>. This leads to a constrained optimization problem <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib9" title="">9</a>]</cite> from the bounding box annotations <math alttext="\tilde{Y}" class="ltx_Math" display="inline" id="S2.SS3.p1.11.m11.1"><semantics id="S2.SS3.p1.11.m11.1a"><mover accent="true" id="S2.SS3.p1.11.m11.1.1" xref="S2.SS3.p1.11.m11.1.1.cmml"><mi id="S2.SS3.p1.11.m11.1.1.2" xref="S2.SS3.p1.11.m11.1.1.2.cmml">Y</mi><mo id="S2.SS3.p1.11.m11.1.1.1" xref="S2.SS3.p1.11.m11.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.p1.11.m11.1b"><apply id="S2.SS3.p1.11.m11.1.1.cmml" xref="S2.SS3.p1.11.m11.1.1"><ci id="S2.SS3.p1.11.m11.1.1.1.cmml" xref="S2.SS3.p1.11.m11.1.1.1">~</ci><ci id="S2.SS3.p1.11.m11.1.1.2.cmml" xref="S2.SS3.p1.11.m11.1.1.2">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p1.11.m11.1c">\tilde{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p1.11.m11.1d">over~ start_ARG italic_Y end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.4"><span class="ltx_text ltx_font_bold" id="S2.SS3.p2.1.1">Emptiness of <math alttext="\Upomega_{O}" class="ltx_Math" display="inline" id="S2.SS3.p2.1.1.m1.1"><semantics id="S2.SS3.p2.1.1.m1.1a"><msub id="S2.SS3.p2.1.1.m1.1.1" xref="S2.SS3.p2.1.1.m1.1.1.cmml"><mi id="S2.SS3.p2.1.1.m1.1.1.2" mathvariant="normal" xref="S2.SS3.p2.1.1.m1.1.1.2.cmml">Ω</mi><mi id="S2.SS3.p2.1.1.m1.1.1.3" xref="S2.SS3.p2.1.1.m1.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.1.m1.1b"><apply id="S2.SS3.p2.1.1.m1.1.1.cmml" xref="S2.SS3.p2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.1.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.1.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.1.m1.1.1.2">Ω</ci><ci id="S2.SS3.p2.1.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.1.m1.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.1.m1.1c">\Upomega_{O}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.1.1.m1.1d">roman_Ω start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math>.</span>  Since the region in <math alttext="\Upomega_{I}" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m1.1"><semantics id="S2.SS3.p2.2.m1.1a"><msub id="S2.SS3.p2.2.m1.1.1" xref="S2.SS3.p2.2.m1.1.1.cmml"><mi id="S2.SS3.p2.2.m1.1.1.2" mathvariant="normal" xref="S2.SS3.p2.2.m1.1.1.2.cmml">Ω</mi><mi id="S2.SS3.p2.2.m1.1.1.3" xref="S2.SS3.p2.2.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m1.1b"><apply id="S2.SS3.p2.2.m1.1.1.cmml" xref="S2.SS3.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.2.m1.1.1.1.cmml" xref="S2.SS3.p2.2.m1.1.1">subscript</csymbol><ci id="S2.SS3.p2.2.m1.1.1.2.cmml" xref="S2.SS3.p2.2.m1.1.1.2">Ω</ci><ci id="S2.SS3.p2.2.m1.1.1.3.cmml" xref="S2.SS3.p2.2.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m1.1c">\Upomega_{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.2.m1.1d">roman_Ω start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> defined by the bounding box must contain the target object, <math alttext="\Upomega_{O}" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m2.1"><semantics id="S2.SS3.p2.3.m2.1a"><msub id="S2.SS3.p2.3.m2.1.1" xref="S2.SS3.p2.3.m2.1.1.cmml"><mi id="S2.SS3.p2.3.m2.1.1.2" mathvariant="normal" xref="S2.SS3.p2.3.m2.1.1.2.cmml">Ω</mi><mi id="S2.SS3.p2.3.m2.1.1.3" xref="S2.SS3.p2.3.m2.1.1.3.cmml">O</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m2.1b"><apply id="S2.SS3.p2.3.m2.1.1.cmml" xref="S2.SS3.p2.3.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p2.3.m2.1.1.1.cmml" xref="S2.SS3.p2.3.m2.1.1">subscript</csymbol><ci id="S2.SS3.p2.3.m2.1.1.2.cmml" xref="S2.SS3.p2.3.m2.1.1.2">Ω</ci><ci id="S2.SS3.p2.3.m2.1.1.3.cmml" xref="S2.SS3.p2.3.m2.1.1.3">𝑂</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m2.1c">\Upomega_{O}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.3.m2.1d">roman_Ω start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math> must contain only foreground. Hence, we can apply a Cross-entropy loss for all pixels <math alttext="p\in\Upomega_{O}" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m3.1"><semantics id="S2.SS3.p2.4.m3.1a"><mrow id="S2.SS3.p2.4.m3.1.1" xref="S2.SS3.p2.4.m3.1.1.cmml"><mi id="S2.SS3.p2.4.m3.1.1.2" xref="S2.SS3.p2.4.m3.1.1.2.cmml">p</mi><mo id="S2.SS3.p2.4.m3.1.1.1" xref="S2.SS3.p2.4.m3.1.1.1.cmml">∈</mo><msub id="S2.SS3.p2.4.m3.1.1.3" xref="S2.SS3.p2.4.m3.1.1.3.cmml"><mi id="S2.SS3.p2.4.m3.1.1.3.2" mathvariant="normal" xref="S2.SS3.p2.4.m3.1.1.3.2.cmml">Ω</mi><mi id="S2.SS3.p2.4.m3.1.1.3.3" xref="S2.SS3.p2.4.m3.1.1.3.3.cmml">O</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m3.1b"><apply id="S2.SS3.p2.4.m3.1.1.cmml" xref="S2.SS3.p2.4.m3.1.1"><in id="S2.SS3.p2.4.m3.1.1.1.cmml" xref="S2.SS3.p2.4.m3.1.1.1"></in><ci id="S2.SS3.p2.4.m3.1.1.2.cmml" xref="S2.SS3.p2.4.m3.1.1.2">𝑝</ci><apply id="S2.SS3.p2.4.m3.1.1.3.cmml" xref="S2.SS3.p2.4.m3.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m3.1.1.3.1.cmml" xref="S2.SS3.p2.4.m3.1.1.3">subscript</csymbol><ci id="S2.SS3.p2.4.m3.1.1.3.2.cmml" xref="S2.SS3.p2.4.m3.1.1.3.2">Ω</ci><ci id="S2.SS3.p2.4.m3.1.1.3.3.cmml" xref="S2.SS3.p2.4.m3.1.1.3.3">𝑂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m3.1c">p\in\Upomega_{O}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p2.4.m3.1d">italic_p ∈ roman_Ω start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathit{empty}}\,=\,-\sum_{p\in\Upomega_{O}}\!\log(1-f_{\theta}(p%
))." class="ltx_Math" display="block" id="S2.E1.m1.3"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml"><msub id="S2.E1.m1.3.3.1.1.3" xref="S2.E1.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.3.2" xref="S2.E1.m1.3.3.1.1.3.2.cmml">ℒ</mi><mi id="S2.E1.m1.3.3.1.1.3.3" xref="S2.E1.m1.3.3.1.1.3.3.cmml">𝑒𝑚𝑝𝑡𝑦</mi></msub><mo id="S2.E1.m1.3.3.1.1.2" lspace="0.448em" rspace="0.448em" xref="S2.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1a" xref="S2.E1.m1.3.3.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.3.3.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.cmml"><munder id="S2.E1.m1.3.3.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.2.2" movablelimits="false" xref="S2.E1.m1.3.3.1.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.2.3" xref="S2.E1.m1.3.3.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.2.3.2" xref="S2.E1.m1.3.3.1.1.1.1.2.3.2.cmml">p</mi><mo id="S2.E1.m1.3.3.1.1.1.1.2.3.1" xref="S2.E1.m1.3.3.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S2.E1.m1.3.3.1.1.1.1.2.3.3" xref="S2.E1.m1.3.3.1.1.1.1.2.3.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.2.3.3.2" mathvariant="normal" xref="S2.E1.m1.3.3.1.1.1.1.2.3.3.2.cmml">Ω</mi><mi id="S2.E1.m1.3.3.1.1.1.1.2.3.3.3" xref="S2.E1.m1.3.3.1.1.1.1.2.3.3.3.cmml">O</mi></msub></mrow></munder><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">log</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1a" xref="S2.E1.m1.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mn id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><msub id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml">f</mi><mi id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml">θ</mi></msub><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">p</mi><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.3.3.1.2" lspace="0em" xref="S2.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1"><eq id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.2"></eq><apply id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.3.2">ℒ</ci><ci id="S2.E1.m1.3.3.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.3.3">𝑒𝑚𝑝𝑡𝑦</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"><minus id="S2.E1.m1.3.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1"></minus><apply id="S2.E1.m1.3.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1"><apply id="S2.E1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2"></sum><apply id="S2.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.3"><in id="S2.E1.m1.3.3.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.3.1"></in><ci id="S2.E1.m1.3.3.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.3.2">𝑝</ci><apply id="S2.E1.m1.3.3.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.2.3.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.3.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.2.3.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.3.3.2">Ω</ci><ci id="S2.E1.m1.3.3.1.1.1.1.2.3.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.3.3.3">𝑂</ci></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1"><log id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"></log><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1"><minus id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.1"></minus><cn id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.2">1</cn><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3"><times id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.1"></times><apply id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.2">𝑓</ci><ci id="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.3">𝜃</ci></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑝</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\mathcal{L}_{\mathit{empty}}\,=\,-\sum_{p\in\Upomega_{O}}\!\log(1-f_{\theta}(p%
)).</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.3d">caligraphic_L start_POSTSUBSCRIPT italic_empty end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_p ∈ roman_Ω start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT end_POSTSUBSCRIPT roman_log ( 1 - italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_p ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.3"><span class="ltx_text ltx_font_bold" id="S2.SS3.p3.1.1">Tight box constraint in <math alttext="\Upomega_{I}" class="ltx_Math" display="inline" id="S2.SS3.p3.1.1.m1.1"><semantics id="S2.SS3.p3.1.1.m1.1a"><msub id="S2.SS3.p3.1.1.m1.1.1" xref="S2.SS3.p3.1.1.m1.1.1.cmml"><mi id="S2.SS3.p3.1.1.m1.1.1.2" mathvariant="normal" xref="S2.SS3.p3.1.1.m1.1.1.2.cmml">Ω</mi><mi id="S2.SS3.p3.1.1.m1.1.1.3" xref="S2.SS3.p3.1.1.m1.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.1.1.m1.1b"><apply id="S2.SS3.p3.1.1.m1.1.1.cmml" xref="S2.SS3.p3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.1.1.m1.1.1.1.cmml" xref="S2.SS3.p3.1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p3.1.1.m1.1.1.2.cmml" xref="S2.SS3.p3.1.1.m1.1.1.2">Ω</ci><ci id="S2.SS3.p3.1.1.m1.1.1.3.cmml" xref="S2.SS3.p3.1.1.m1.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.1.1.m1.1c">\Upomega_{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.1.1.m1.1d">roman_Ω start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math>.</span>  The tightness of the bounding box indicates that at least one foreground pixel must cross every horizontal and vertical line of weak label <math alttext="\tilde{Y}" class="ltx_Math" display="inline" id="S2.SS3.p3.2.m1.1"><semantics id="S2.SS3.p3.2.m1.1a"><mover accent="true" id="S2.SS3.p3.2.m1.1.1" xref="S2.SS3.p3.2.m1.1.1.cmml"><mi id="S2.SS3.p3.2.m1.1.1.2" xref="S2.SS3.p3.2.m1.1.1.2.cmml">Y</mi><mo id="S2.SS3.p3.2.m1.1.1.1" xref="S2.SS3.p3.2.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.2.m1.1b"><apply id="S2.SS3.p3.2.m1.1.1.cmml" xref="S2.SS3.p3.2.m1.1.1"><ci id="S2.SS3.p3.2.m1.1.1.1.cmml" xref="S2.SS3.p3.2.m1.1.1.1">~</ci><ci id="S2.SS3.p3.2.m1.1.1.2.cmml" xref="S2.SS3.p3.2.m1.1.1.2">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.2.m1.1c">\tilde{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.2.m1.1d">over~ start_ARG italic_Y end_ARG</annotation></semantics></math>. As in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib9" title="">9</a>]</cite>, we soften this condition by considering segments of width <math alttext="w" class="ltx_Math" display="inline" id="S2.SS3.p3.3.m2.1"><semantics id="S2.SS3.p3.3.m2.1a"><mi id="S2.SS3.p3.3.m2.1.1" xref="S2.SS3.p3.3.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.3.m2.1b"><ci id="S2.SS3.p3.3.m2.1.1.cmml" xref="S2.SS3.p3.3.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.3.m2.1c">w</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.3.m2.1d">italic_w</annotation></semantics></math> instead of individual lines and ensure differentiability by considering output probabilities instead of the prediction mask. The condition formalizes as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\sum_{p\in s_{l}}f_{\theta}(p)\geq w,\ \ \forall s_{l}\in S_{L}," class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2.1"><mrow id="S2.E2.m1.2.2.1.1.2" xref="S2.E2.m1.2.2.1.1.3.cmml"><mrow id="S2.E2.m1.2.2.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.cmml"><mrow id="S2.E2.m1.2.2.1.1.1.1.2" xref="S2.E2.m1.2.2.1.1.1.1.2.cmml"><munder id="S2.E2.m1.2.2.1.1.1.1.2.1" xref="S2.E2.m1.2.2.1.1.1.1.2.1.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.2.1.2" movablelimits="false" xref="S2.E2.m1.2.2.1.1.1.1.2.1.2.cmml">∑</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.2.1.3" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.2.1.3.2" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.2.cmml">p</mi><mo id="S2.E2.m1.2.2.1.1.1.1.2.1.3.1" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.1.cmml">∈</mo><msub id="S2.E2.m1.2.2.1.1.1.1.2.1.3.3" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.2" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.2.cmml">s</mi><mi id="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.3" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.3.cmml">l</mi></msub></mrow></munder><mrow id="S2.E2.m1.2.2.1.1.1.1.2.2" xref="S2.E2.m1.2.2.1.1.1.1.2.2.cmml"><msub id="S2.E2.m1.2.2.1.1.1.1.2.2.2" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S2.E2.m1.2.2.1.1.1.1.2.2.2.2" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2.2.cmml">f</mi><mi id="S2.E2.m1.2.2.1.1.1.1.2.2.2.3" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2.3.cmml">θ</mi></msub><mo id="S2.E2.m1.2.2.1.1.1.1.2.2.1" xref="S2.E2.m1.2.2.1.1.1.1.2.2.1.cmml">⁢</mo><mrow id="S2.E2.m1.2.2.1.1.1.1.2.2.3.2" xref="S2.E2.m1.2.2.1.1.1.1.2.2.cmml"><mo id="S2.E2.m1.2.2.1.1.1.1.2.2.3.2.1" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.2.2.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">p</mi><mo id="S2.E2.m1.2.2.1.1.1.1.2.2.3.2.2" stretchy="false" xref="S2.E2.m1.2.2.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.1.1.1.1.1.cmml">≥</mo><mi id="S2.E2.m1.2.2.1.1.1.1.3" xref="S2.E2.m1.2.2.1.1.1.1.3.cmml">w</mi></mrow><mo id="S2.E2.m1.2.2.1.1.2.3" rspace="1.167em" xref="S2.E2.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S2.E2.m1.2.2.1.1.2.2" xref="S2.E2.m1.2.2.1.1.2.2.cmml"><mrow id="S2.E2.m1.2.2.1.1.2.2.2" xref="S2.E2.m1.2.2.1.1.2.2.2.cmml"><mo id="S2.E2.m1.2.2.1.1.2.2.2.1" rspace="0.167em" xref="S2.E2.m1.2.2.1.1.2.2.2.1.cmml">∀</mo><msub id="S2.E2.m1.2.2.1.1.2.2.2.2" xref="S2.E2.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S2.E2.m1.2.2.1.1.2.2.2.2.2" xref="S2.E2.m1.2.2.1.1.2.2.2.2.2.cmml">s</mi><mi id="S2.E2.m1.2.2.1.1.2.2.2.2.3" xref="S2.E2.m1.2.2.1.1.2.2.2.2.3.cmml">l</mi></msub></mrow><mo id="S2.E2.m1.2.2.1.1.2.2.1" xref="S2.E2.m1.2.2.1.1.2.2.1.cmml">∈</mo><msub id="S2.E2.m1.2.2.1.1.2.2.3" xref="S2.E2.m1.2.2.1.1.2.2.3.cmml"><mi id="S2.E2.m1.2.2.1.1.2.2.3.2" xref="S2.E2.m1.2.2.1.1.2.2.3.2.cmml">S</mi><mi id="S2.E2.m1.2.2.1.1.2.2.3.3" xref="S2.E2.m1.2.2.1.1.2.2.3.3.cmml">L</mi></msub></mrow></mrow><mo id="S2.E2.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.3a.cmml" xref="S2.E2.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E2.m1.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1"><geq id="S2.E2.m1.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.1"></geq><apply id="S2.E2.m1.2.2.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2"><apply id="S2.E2.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.2.1.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.1">subscript</csymbol><sum id="S2.E2.m1.2.2.1.1.1.1.2.1.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.1.2"></sum><apply id="S2.E2.m1.2.2.1.1.1.1.2.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3"><in id="S2.E2.m1.2.2.1.1.1.1.2.1.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.1"></in><ci id="S2.E2.m1.2.2.1.1.1.1.2.1.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.2">𝑝</ci><apply id="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.3">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.2">𝑠</ci><ci id="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.1.3.3.3">𝑙</ci></apply></apply></apply><apply id="S2.E2.m1.2.2.1.1.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2"><times id="S2.E2.m1.2.2.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2.1"></times><apply id="S2.E2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2.2">𝑓</ci><ci id="S2.E2.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.2.2.2.3">𝜃</ci></apply><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝑝</ci></apply></apply><ci id="S2.E2.m1.2.2.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.1.1.1.1.3">𝑤</ci></apply><apply id="S2.E2.m1.2.2.1.1.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2"><in id="S2.E2.m1.2.2.1.1.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2.2.1"></in><apply id="S2.E2.m1.2.2.1.1.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2.2"><csymbol cd="latexml" id="S2.E2.m1.2.2.1.1.2.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2.2.2.1">for-all</csymbol><apply id="S2.E2.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2.2.2.2">𝑠</ci><ci id="S2.E2.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.2.2.2.3">𝑙</ci></apply></apply><apply id="S2.E2.m1.2.2.1.1.2.2.3.cmml" xref="S2.E2.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.1.1.2.2.3.1.cmml" xref="S2.E2.m1.2.2.1.1.2.2.3">subscript</csymbol><ci id="S2.E2.m1.2.2.1.1.2.2.3.2.cmml" xref="S2.E2.m1.2.2.1.1.2.2.3.2">𝑆</ci><ci id="S2.E2.m1.2.2.1.1.2.2.3.3.cmml" xref="S2.E2.m1.2.2.1.1.2.2.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\sum_{p\in s_{l}}f_{\theta}(p)\geq w,\ \ \forall s_{l}\in S_{L},</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">∑ start_POSTSUBSCRIPT italic_p ∈ italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_p ) ≥ italic_w , ∀ italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ italic_S start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p3.7">where <math alttext="S_{L}" class="ltx_Math" display="inline" id="S2.SS3.p3.4.m1.1"><semantics id="S2.SS3.p3.4.m1.1a"><msub id="S2.SS3.p3.4.m1.1.1" xref="S2.SS3.p3.4.m1.1.1.cmml"><mi id="S2.SS3.p3.4.m1.1.1.2" xref="S2.SS3.p3.4.m1.1.1.2.cmml">S</mi><mi id="S2.SS3.p3.4.m1.1.1.3" xref="S2.SS3.p3.4.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.4.m1.1b"><apply id="S2.SS3.p3.4.m1.1.1.cmml" xref="S2.SS3.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.4.m1.1.1.1.cmml" xref="S2.SS3.p3.4.m1.1.1">subscript</csymbol><ci id="S2.SS3.p3.4.m1.1.1.2.cmml" xref="S2.SS3.p3.4.m1.1.1.2">𝑆</ci><ci id="S2.SS3.p3.4.m1.1.1.3.cmml" xref="S2.SS3.p3.4.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.4.m1.1c">S_{L}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.4.m1.1d">italic_S start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT</annotation></semantics></math> is the set of all vertical and horizontal segments of width <math alttext="w" class="ltx_Math" display="inline" id="S2.SS3.p3.5.m2.1"><semantics id="S2.SS3.p3.5.m2.1a"><mi id="S2.SS3.p3.5.m2.1.1" xref="S2.SS3.p3.5.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.5.m2.1b"><ci id="S2.SS3.p3.5.m2.1.1.cmml" xref="S2.SS3.p3.5.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.5.m2.1c">w</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.5.m2.1d">italic_w</annotation></semantics></math> that make the bounding box <math alttext="\tilde{Y}" class="ltx_Math" display="inline" id="S2.SS3.p3.6.m3.1"><semantics id="S2.SS3.p3.6.m3.1a"><mover accent="true" id="S2.SS3.p3.6.m3.1.1" xref="S2.SS3.p3.6.m3.1.1.cmml"><mi id="S2.SS3.p3.6.m3.1.1.2" xref="S2.SS3.p3.6.m3.1.1.2.cmml">Y</mi><mo id="S2.SS3.p3.6.m3.1.1.1" xref="S2.SS3.p3.6.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.6.m3.1b"><apply id="S2.SS3.p3.6.m3.1.1.cmml" xref="S2.SS3.p3.6.m3.1.1"><ci id="S2.SS3.p3.6.m3.1.1.1.cmml" xref="S2.SS3.p3.6.m3.1.1.1">~</ci><ci id="S2.SS3.p3.6.m3.1.1.2.cmml" xref="S2.SS3.p3.6.m3.1.1.2">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.6.m3.1c">\tilde{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.6.m3.1d">over~ start_ARG italic_Y end_ARG</annotation></semantics></math>. We convert the inequality constraints of (<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.E2" title="In 2.3 Learning with tight box annotations ‣ 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">2</span></a>) to a loss using a penalty function <math alttext="\psi_{t}" class="ltx_Math" display="inline" id="S2.SS3.p3.7.m4.1"><semantics id="S2.SS3.p3.7.m4.1a"><msub id="S2.SS3.p3.7.m4.1.1" xref="S2.SS3.p3.7.m4.1.1.cmml"><mi id="S2.SS3.p3.7.m4.1.1.2" xref="S2.SS3.p3.7.m4.1.1.2.cmml">ψ</mi><mi id="S2.SS3.p3.7.m4.1.1.3" xref="S2.SS3.p3.7.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.7.m4.1b"><apply id="S2.SS3.p3.7.m4.1.1.cmml" xref="S2.SS3.p3.7.m4.1.1"><csymbol cd="ambiguous" id="S2.SS3.p3.7.m4.1.1.1.cmml" xref="S2.SS3.p3.7.m4.1.1">subscript</csymbol><ci id="S2.SS3.p3.7.m4.1.1.2.cmml" xref="S2.SS3.p3.7.m4.1.1.2">𝜓</ci><ci id="S2.SS3.p3.7.m4.1.1.3.cmml" xref="S2.SS3.p3.7.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.7.m4.1c">\psi_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.7.m4.1d">italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, and obtain:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathit{tightbox}}\,=\,\sum_{s_{l}\in S_{L}}\psi_{t}\bigg{(}w-%
\sum_{p\in s_{l}}f_{\theta}(p)\bigg{)}." class="ltx_Math" display="block" id="S2.E3.m1.2"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2.1" xref="S2.E3.m1.2.2.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1" xref="S2.E3.m1.2.2.1.1.cmml"><msub id="S2.E3.m1.2.2.1.1.3" xref="S2.E3.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.1.1.3.2" xref="S2.E3.m1.2.2.1.1.3.2.cmml">ℒ</mi><mi id="S2.E3.m1.2.2.1.1.3.3" xref="S2.E3.m1.2.2.1.1.3.3.cmml">𝑡𝑖𝑔ℎ𝑡𝑏𝑜𝑥</mi></msub><mo id="S2.E3.m1.2.2.1.1.2" lspace="0.448em" xref="S2.E3.m1.2.2.1.1.2.cmml">=</mo><mrow id="S2.E3.m1.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.1.cmml"><munder id="S2.E3.m1.2.2.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.2.cmml"><mo id="S2.E3.m1.2.2.1.1.1.2.2" movablelimits="false" xref="S2.E3.m1.2.2.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.1.2.3.cmml"><msub id="S2.E3.m1.2.2.1.1.1.2.3.2" xref="S2.E3.m1.2.2.1.1.1.2.3.2.cmml"><mi id="S2.E3.m1.2.2.1.1.1.2.3.2.2" xref="S2.E3.m1.2.2.1.1.1.2.3.2.2.cmml">s</mi><mi id="S2.E3.m1.2.2.1.1.1.2.3.2.3" xref="S2.E3.m1.2.2.1.1.1.2.3.2.3.cmml">l</mi></msub><mo id="S2.E3.m1.2.2.1.1.1.2.3.1" xref="S2.E3.m1.2.2.1.1.1.2.3.1.cmml">∈</mo><msub id="S2.E3.m1.2.2.1.1.1.2.3.3" xref="S2.E3.m1.2.2.1.1.1.2.3.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.2.3.3.2" xref="S2.E3.m1.2.2.1.1.1.2.3.3.2.cmml">S</mi><mi id="S2.E3.m1.2.2.1.1.1.2.3.3.3" xref="S2.E3.m1.2.2.1.1.1.2.3.3.3.cmml">L</mi></msub></mrow></munder><mrow id="S2.E3.m1.2.2.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.cmml"><msub id="S2.E3.m1.2.2.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.1.3.2.cmml">ψ</mi><mi id="S2.E3.m1.2.2.1.1.1.1.3.3" xref="S2.E3.m1.2.2.1.1.1.1.3.3.cmml">t</mi></msub><mo id="S2.E3.m1.2.2.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.2" maxsize="210%" minsize="210%" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml">w</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1" rspace="0.055em" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml"><munder id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.2" movablelimits="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.2.cmml">p</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.1.cmml">∈</mo><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.2.cmml">s</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.3.cmml">l</mi></msub></mrow></munder><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml"><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.cmml">f</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.3.cmml">θ</mi></msub><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml">⁢</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.2.1" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">(</mo><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">p</mi><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.3.2.2" stretchy="false" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.1.1.3" maxsize="210%" minsize="210%" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.2" lspace="0em" xref="S2.E3.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1"><eq id="S2.E3.m1.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2"></eq><apply id="S2.E3.m1.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.3.2">ℒ</ci><ci id="S2.E3.m1.2.2.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.3.3">𝑡𝑖𝑔ℎ𝑡𝑏𝑜𝑥</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1"><apply id="S2.E3.m1.2.2.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S2.E3.m1.2.2.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2.2"></sum><apply id="S2.E3.m1.2.2.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3"><in id="S2.E3.m1.2.2.1.1.1.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3.1"></in><apply id="S2.E3.m1.2.2.1.1.1.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.2.3.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.2.3.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3.2.2">𝑠</ci><ci id="S2.E3.m1.2.2.1.1.1.2.3.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3.2.3">𝑙</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.2.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.2.3.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.2.3.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3.3.2">𝑆</ci><ci id="S2.E3.m1.2.2.1.1.1.2.3.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.2.3.3.3">𝐿</ci></apply></apply></apply><apply id="S2.E3.m1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1"><times id="S2.E3.m1.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2"></times><apply id="S2.E3.m1.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2">𝜓</ci><ci id="S2.E3.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.3">𝑡</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1"><minus id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1"></minus><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.2">𝑤</ci><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3"><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.2"></sum><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3"><in id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.1"></in><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.2">𝑝</ci><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.2">𝑠</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.1.3.3.3">𝑙</ci></apply></apply></apply><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2"><times id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.1"></times><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.2">𝑓</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.3.2.2.3">𝜃</ci></apply><ci id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1">𝑝</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\mathcal{L}_{\mathit{tightbox}}\,=\,\sum_{s_{l}\in S_{L}}\psi_{t}\bigg{(}w-%
\sum_{p\in s_{l}}f_{\theta}(p)\bigg{)}.</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.2d">caligraphic_L start_POSTSUBSCRIPT italic_tightbox end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ∈ italic_S start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_w - ∑ start_POSTSUBSCRIPT italic_p ∈ italic_s start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_p ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p3.14">The penalty function can be modeled as a simple scaled ReLU function, i.e. <math alttext="\psi_{t}(x)=t\!\cdot\!\max(0,x)" class="ltx_Math" display="inline" id="S2.SS3.p3.8.m1.4"><semantics id="S2.SS3.p3.8.m1.4a"><mrow id="S2.SS3.p3.8.m1.4.5" xref="S2.SS3.p3.8.m1.4.5.cmml"><mrow id="S2.SS3.p3.8.m1.4.5.2" xref="S2.SS3.p3.8.m1.4.5.2.cmml"><msub id="S2.SS3.p3.8.m1.4.5.2.2" xref="S2.SS3.p3.8.m1.4.5.2.2.cmml"><mi id="S2.SS3.p3.8.m1.4.5.2.2.2" xref="S2.SS3.p3.8.m1.4.5.2.2.2.cmml">ψ</mi><mi id="S2.SS3.p3.8.m1.4.5.2.2.3" xref="S2.SS3.p3.8.m1.4.5.2.2.3.cmml">t</mi></msub><mo id="S2.SS3.p3.8.m1.4.5.2.1" xref="S2.SS3.p3.8.m1.4.5.2.1.cmml">⁢</mo><mrow id="S2.SS3.p3.8.m1.4.5.2.3.2" xref="S2.SS3.p3.8.m1.4.5.2.cmml"><mo id="S2.SS3.p3.8.m1.4.5.2.3.2.1" stretchy="false" xref="S2.SS3.p3.8.m1.4.5.2.cmml">(</mo><mi id="S2.SS3.p3.8.m1.1.1" xref="S2.SS3.p3.8.m1.1.1.cmml">x</mi><mo id="S2.SS3.p3.8.m1.4.5.2.3.2.2" stretchy="false" xref="S2.SS3.p3.8.m1.4.5.2.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p3.8.m1.4.5.1" xref="S2.SS3.p3.8.m1.4.5.1.cmml">=</mo><mrow id="S2.SS3.p3.8.m1.4.5.3" xref="S2.SS3.p3.8.m1.4.5.3.cmml"><mi id="S2.SS3.p3.8.m1.4.5.3.2" xref="S2.SS3.p3.8.m1.4.5.3.2.cmml">t</mi><mo id="S2.SS3.p3.8.m1.4.5.3.1" lspace="0.052em" rspace="0.052em" xref="S2.SS3.p3.8.m1.4.5.3.1.cmml">⋅</mo><mrow id="S2.SS3.p3.8.m1.4.5.3.3.2" xref="S2.SS3.p3.8.m1.4.5.3.3.1.cmml"><mi id="S2.SS3.p3.8.m1.2.2" xref="S2.SS3.p3.8.m1.2.2.cmml">max</mi><mo id="S2.SS3.p3.8.m1.4.5.3.3.2a" xref="S2.SS3.p3.8.m1.4.5.3.3.1.cmml">⁡</mo><mrow id="S2.SS3.p3.8.m1.4.5.3.3.2.1" xref="S2.SS3.p3.8.m1.4.5.3.3.1.cmml"><mo id="S2.SS3.p3.8.m1.4.5.3.3.2.1.1" stretchy="false" xref="S2.SS3.p3.8.m1.4.5.3.3.1.cmml">(</mo><mn id="S2.SS3.p3.8.m1.3.3" xref="S2.SS3.p3.8.m1.3.3.cmml">0</mn><mo id="S2.SS3.p3.8.m1.4.5.3.3.2.1.2" xref="S2.SS3.p3.8.m1.4.5.3.3.1.cmml">,</mo><mi id="S2.SS3.p3.8.m1.4.4" xref="S2.SS3.p3.8.m1.4.4.cmml">x</mi><mo id="S2.SS3.p3.8.m1.4.5.3.3.2.1.3" stretchy="false" xref="S2.SS3.p3.8.m1.4.5.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.8.m1.4b"><apply id="S2.SS3.p3.8.m1.4.5.cmml" xref="S2.SS3.p3.8.m1.4.5"><eq id="S2.SS3.p3.8.m1.4.5.1.cmml" xref="S2.SS3.p3.8.m1.4.5.1"></eq><apply id="S2.SS3.p3.8.m1.4.5.2.cmml" xref="S2.SS3.p3.8.m1.4.5.2"><times id="S2.SS3.p3.8.m1.4.5.2.1.cmml" xref="S2.SS3.p3.8.m1.4.5.2.1"></times><apply id="S2.SS3.p3.8.m1.4.5.2.2.cmml" xref="S2.SS3.p3.8.m1.4.5.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.8.m1.4.5.2.2.1.cmml" xref="S2.SS3.p3.8.m1.4.5.2.2">subscript</csymbol><ci id="S2.SS3.p3.8.m1.4.5.2.2.2.cmml" xref="S2.SS3.p3.8.m1.4.5.2.2.2">𝜓</ci><ci id="S2.SS3.p3.8.m1.4.5.2.2.3.cmml" xref="S2.SS3.p3.8.m1.4.5.2.2.3">𝑡</ci></apply><ci id="S2.SS3.p3.8.m1.1.1.cmml" xref="S2.SS3.p3.8.m1.1.1">𝑥</ci></apply><apply id="S2.SS3.p3.8.m1.4.5.3.cmml" xref="S2.SS3.p3.8.m1.4.5.3"><ci id="S2.SS3.p3.8.m1.4.5.3.1.cmml" xref="S2.SS3.p3.8.m1.4.5.3.1">⋅</ci><ci id="S2.SS3.p3.8.m1.4.5.3.2.cmml" xref="S2.SS3.p3.8.m1.4.5.3.2">𝑡</ci><apply id="S2.SS3.p3.8.m1.4.5.3.3.1.cmml" xref="S2.SS3.p3.8.m1.4.5.3.3.2"><max id="S2.SS3.p3.8.m1.2.2.cmml" xref="S2.SS3.p3.8.m1.2.2"></max><cn id="S2.SS3.p3.8.m1.3.3.cmml" type="integer" xref="S2.SS3.p3.8.m1.3.3">0</cn><ci id="S2.SS3.p3.8.m1.4.4.cmml" xref="S2.SS3.p3.8.m1.4.4">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.8.m1.4c">\psi_{t}(x)=t\!\cdot\!\max(0,x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.8.m1.4d">italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_x ) = italic_t ⋅ roman_max ( 0 , italic_x )</annotation></semantics></math>. In this work, we instead resort to a pseudo log-barrier function, which provides a more stable optimization under multiple competing constraints. As <math alttext="t\!\to\!\infty" class="ltx_Math" display="inline" id="S2.SS3.p3.9.m2.1"><semantics id="S2.SS3.p3.9.m2.1a"><mrow id="S2.SS3.p3.9.m2.1.1" xref="S2.SS3.p3.9.m2.1.1.cmml"><mi id="S2.SS3.p3.9.m2.1.1.2" xref="S2.SS3.p3.9.m2.1.1.2.cmml">t</mi><mo id="S2.SS3.p3.9.m2.1.1.1" lspace="0.108em" rspace="0.108em" stretchy="false" xref="S2.SS3.p3.9.m2.1.1.1.cmml">→</mo><mi id="S2.SS3.p3.9.m2.1.1.3" mathvariant="normal" xref="S2.SS3.p3.9.m2.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.9.m2.1b"><apply id="S2.SS3.p3.9.m2.1.1.cmml" xref="S2.SS3.p3.9.m2.1.1"><ci id="S2.SS3.p3.9.m2.1.1.1.cmml" xref="S2.SS3.p3.9.m2.1.1.1">→</ci><ci id="S2.SS3.p3.9.m2.1.1.2.cmml" xref="S2.SS3.p3.9.m2.1.1.2">𝑡</ci><infinity id="S2.SS3.p3.9.m2.1.1.3.cmml" xref="S2.SS3.p3.9.m2.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.9.m2.1c">t\!\to\!\infty</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.9.m2.1d">italic_t → ∞</annotation></semantics></math>, function <math alttext="\psi_{t}(x)" class="ltx_Math" display="inline" id="S2.SS3.p3.10.m3.1"><semantics id="S2.SS3.p3.10.m3.1a"><mrow id="S2.SS3.p3.10.m3.1.2" xref="S2.SS3.p3.10.m3.1.2.cmml"><msub id="S2.SS3.p3.10.m3.1.2.2" xref="S2.SS3.p3.10.m3.1.2.2.cmml"><mi id="S2.SS3.p3.10.m3.1.2.2.2" xref="S2.SS3.p3.10.m3.1.2.2.2.cmml">ψ</mi><mi id="S2.SS3.p3.10.m3.1.2.2.3" xref="S2.SS3.p3.10.m3.1.2.2.3.cmml">t</mi></msub><mo id="S2.SS3.p3.10.m3.1.2.1" xref="S2.SS3.p3.10.m3.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.p3.10.m3.1.2.3.2" xref="S2.SS3.p3.10.m3.1.2.cmml"><mo id="S2.SS3.p3.10.m3.1.2.3.2.1" stretchy="false" xref="S2.SS3.p3.10.m3.1.2.cmml">(</mo><mi id="S2.SS3.p3.10.m3.1.1" xref="S2.SS3.p3.10.m3.1.1.cmml">x</mi><mo id="S2.SS3.p3.10.m3.1.2.3.2.2" stretchy="false" xref="S2.SS3.p3.10.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.10.m3.1b"><apply id="S2.SS3.p3.10.m3.1.2.cmml" xref="S2.SS3.p3.10.m3.1.2"><times id="S2.SS3.p3.10.m3.1.2.1.cmml" xref="S2.SS3.p3.10.m3.1.2.1"></times><apply id="S2.SS3.p3.10.m3.1.2.2.cmml" xref="S2.SS3.p3.10.m3.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.10.m3.1.2.2.1.cmml" xref="S2.SS3.p3.10.m3.1.2.2">subscript</csymbol><ci id="S2.SS3.p3.10.m3.1.2.2.2.cmml" xref="S2.SS3.p3.10.m3.1.2.2.2">𝜓</ci><ci id="S2.SS3.p3.10.m3.1.2.2.3.cmml" xref="S2.SS3.p3.10.m3.1.2.2.3">𝑡</ci></apply><ci id="S2.SS3.p3.10.m3.1.1.cmml" xref="S2.SS3.p3.10.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.10.m3.1c">\psi_{t}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.10.m3.1d">italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> behaves as a hard barrier where <math alttext="\psi_{t}(x)=\infty" class="ltx_Math" display="inline" id="S2.SS3.p3.11.m4.1"><semantics id="S2.SS3.p3.11.m4.1a"><mrow id="S2.SS3.p3.11.m4.1.2" xref="S2.SS3.p3.11.m4.1.2.cmml"><mrow id="S2.SS3.p3.11.m4.1.2.2" xref="S2.SS3.p3.11.m4.1.2.2.cmml"><msub id="S2.SS3.p3.11.m4.1.2.2.2" xref="S2.SS3.p3.11.m4.1.2.2.2.cmml"><mi id="S2.SS3.p3.11.m4.1.2.2.2.2" xref="S2.SS3.p3.11.m4.1.2.2.2.2.cmml">ψ</mi><mi id="S2.SS3.p3.11.m4.1.2.2.2.3" xref="S2.SS3.p3.11.m4.1.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS3.p3.11.m4.1.2.2.1" xref="S2.SS3.p3.11.m4.1.2.2.1.cmml">⁢</mo><mrow id="S2.SS3.p3.11.m4.1.2.2.3.2" xref="S2.SS3.p3.11.m4.1.2.2.cmml"><mo id="S2.SS3.p3.11.m4.1.2.2.3.2.1" stretchy="false" xref="S2.SS3.p3.11.m4.1.2.2.cmml">(</mo><mi id="S2.SS3.p3.11.m4.1.1" xref="S2.SS3.p3.11.m4.1.1.cmml">x</mi><mo id="S2.SS3.p3.11.m4.1.2.2.3.2.2" stretchy="false" xref="S2.SS3.p3.11.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p3.11.m4.1.2.1" xref="S2.SS3.p3.11.m4.1.2.1.cmml">=</mo><mi id="S2.SS3.p3.11.m4.1.2.3" mathvariant="normal" xref="S2.SS3.p3.11.m4.1.2.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.11.m4.1b"><apply id="S2.SS3.p3.11.m4.1.2.cmml" xref="S2.SS3.p3.11.m4.1.2"><eq id="S2.SS3.p3.11.m4.1.2.1.cmml" xref="S2.SS3.p3.11.m4.1.2.1"></eq><apply id="S2.SS3.p3.11.m4.1.2.2.cmml" xref="S2.SS3.p3.11.m4.1.2.2"><times id="S2.SS3.p3.11.m4.1.2.2.1.cmml" xref="S2.SS3.p3.11.m4.1.2.2.1"></times><apply id="S2.SS3.p3.11.m4.1.2.2.2.cmml" xref="S2.SS3.p3.11.m4.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.11.m4.1.2.2.2.1.cmml" xref="S2.SS3.p3.11.m4.1.2.2.2">subscript</csymbol><ci id="S2.SS3.p3.11.m4.1.2.2.2.2.cmml" xref="S2.SS3.p3.11.m4.1.2.2.2.2">𝜓</ci><ci id="S2.SS3.p3.11.m4.1.2.2.2.3.cmml" xref="S2.SS3.p3.11.m4.1.2.2.2.3">𝑡</ci></apply><ci id="S2.SS3.p3.11.m4.1.1.cmml" xref="S2.SS3.p3.11.m4.1.1">𝑥</ci></apply><infinity id="S2.SS3.p3.11.m4.1.2.3.cmml" xref="S2.SS3.p3.11.m4.1.2.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.11.m4.1c">\psi_{t}(x)=\infty</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.11.m4.1d">italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_x ) = ∞</annotation></semantics></math> if <math alttext="x&gt;0" class="ltx_Math" display="inline" id="S2.SS3.p3.12.m5.1"><semantics id="S2.SS3.p3.12.m5.1a"><mrow id="S2.SS3.p3.12.m5.1.1" xref="S2.SS3.p3.12.m5.1.1.cmml"><mi id="S2.SS3.p3.12.m5.1.1.2" xref="S2.SS3.p3.12.m5.1.1.2.cmml">x</mi><mo id="S2.SS3.p3.12.m5.1.1.1" xref="S2.SS3.p3.12.m5.1.1.1.cmml">&gt;</mo><mn id="S2.SS3.p3.12.m5.1.1.3" xref="S2.SS3.p3.12.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.12.m5.1b"><apply id="S2.SS3.p3.12.m5.1.1.cmml" xref="S2.SS3.p3.12.m5.1.1"><gt id="S2.SS3.p3.12.m5.1.1.1.cmml" xref="S2.SS3.p3.12.m5.1.1.1"></gt><ci id="S2.SS3.p3.12.m5.1.1.2.cmml" xref="S2.SS3.p3.12.m5.1.1.2">𝑥</ci><cn id="S2.SS3.p3.12.m5.1.1.3.cmml" type="integer" xref="S2.SS3.p3.12.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.12.m5.1c">x&gt;0</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.12.m5.1d">italic_x &gt; 0</annotation></semantics></math>, else <math alttext="\psi_{t}(x)=0" class="ltx_Math" display="inline" id="S2.SS3.p3.13.m6.1"><semantics id="S2.SS3.p3.13.m6.1a"><mrow id="S2.SS3.p3.13.m6.1.2" xref="S2.SS3.p3.13.m6.1.2.cmml"><mrow id="S2.SS3.p3.13.m6.1.2.2" xref="S2.SS3.p3.13.m6.1.2.2.cmml"><msub id="S2.SS3.p3.13.m6.1.2.2.2" xref="S2.SS3.p3.13.m6.1.2.2.2.cmml"><mi id="S2.SS3.p3.13.m6.1.2.2.2.2" xref="S2.SS3.p3.13.m6.1.2.2.2.2.cmml">ψ</mi><mi id="S2.SS3.p3.13.m6.1.2.2.2.3" xref="S2.SS3.p3.13.m6.1.2.2.2.3.cmml">t</mi></msub><mo id="S2.SS3.p3.13.m6.1.2.2.1" xref="S2.SS3.p3.13.m6.1.2.2.1.cmml">⁢</mo><mrow id="S2.SS3.p3.13.m6.1.2.2.3.2" xref="S2.SS3.p3.13.m6.1.2.2.cmml"><mo id="S2.SS3.p3.13.m6.1.2.2.3.2.1" stretchy="false" xref="S2.SS3.p3.13.m6.1.2.2.cmml">(</mo><mi id="S2.SS3.p3.13.m6.1.1" xref="S2.SS3.p3.13.m6.1.1.cmml">x</mi><mo id="S2.SS3.p3.13.m6.1.2.2.3.2.2" stretchy="false" xref="S2.SS3.p3.13.m6.1.2.2.cmml">)</mo></mrow></mrow><mo id="S2.SS3.p3.13.m6.1.2.1" xref="S2.SS3.p3.13.m6.1.2.1.cmml">=</mo><mn id="S2.SS3.p3.13.m6.1.2.3" xref="S2.SS3.p3.13.m6.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.13.m6.1b"><apply id="S2.SS3.p3.13.m6.1.2.cmml" xref="S2.SS3.p3.13.m6.1.2"><eq id="S2.SS3.p3.13.m6.1.2.1.cmml" xref="S2.SS3.p3.13.m6.1.2.1"></eq><apply id="S2.SS3.p3.13.m6.1.2.2.cmml" xref="S2.SS3.p3.13.m6.1.2.2"><times id="S2.SS3.p3.13.m6.1.2.2.1.cmml" xref="S2.SS3.p3.13.m6.1.2.2.1"></times><apply id="S2.SS3.p3.13.m6.1.2.2.2.cmml" xref="S2.SS3.p3.13.m6.1.2.2.2"><csymbol cd="ambiguous" id="S2.SS3.p3.13.m6.1.2.2.2.1.cmml" xref="S2.SS3.p3.13.m6.1.2.2.2">subscript</csymbol><ci id="S2.SS3.p3.13.m6.1.2.2.2.2.cmml" xref="S2.SS3.p3.13.m6.1.2.2.2.2">𝜓</ci><ci id="S2.SS3.p3.13.m6.1.2.2.2.3.cmml" xref="S2.SS3.p3.13.m6.1.2.2.2.3">𝑡</ci></apply><ci id="S2.SS3.p3.13.m6.1.1.cmml" xref="S2.SS3.p3.13.m6.1.1">𝑥</ci></apply><cn id="S2.SS3.p3.13.m6.1.2.3.cmml" type="integer" xref="S2.SS3.p3.13.m6.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.13.m6.1c">\psi_{t}(x)=0</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.13.m6.1d">italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_x ) = 0</annotation></semantics></math>. In our method, we found that using a fixed value of <math alttext="t=5" class="ltx_Math" display="inline" id="S2.SS3.p3.14.m7.1"><semantics id="S2.SS3.p3.14.m7.1a"><mrow id="S2.SS3.p3.14.m7.1.1" xref="S2.SS3.p3.14.m7.1.1.cmml"><mi id="S2.SS3.p3.14.m7.1.1.2" xref="S2.SS3.p3.14.m7.1.1.2.cmml">t</mi><mo id="S2.SS3.p3.14.m7.1.1.1" xref="S2.SS3.p3.14.m7.1.1.1.cmml">=</mo><mn id="S2.SS3.p3.14.m7.1.1.3" xref="S2.SS3.p3.14.m7.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p3.14.m7.1b"><apply id="S2.SS3.p3.14.m7.1.1.cmml" xref="S2.SS3.p3.14.m7.1.1"><eq id="S2.SS3.p3.14.m7.1.1.1.cmml" xref="S2.SS3.p3.14.m7.1.1.1"></eq><ci id="S2.SS3.p3.14.m7.1.1.2.cmml" xref="S2.SS3.p3.14.m7.1.1.2">𝑡</ci><cn id="S2.SS3.p3.14.m7.1.1.3.cmml" type="integer" xref="S2.SS3.p3.14.m7.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p3.14.m7.1c">t=5</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p3.14.m7.1d">italic_t = 5</annotation></semantics></math> worked best.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS3.p4">
<p class="ltx_p" id="S2.SS3.p4.3"><span class="ltx_text ltx_font_bold" id="S2.SS3.p4.3.1">Foreground size constraint.</span>  The bounding box <math alttext="\tilde{Y}" class="ltx_Math" display="inline" id="S2.SS3.p4.1.m1.1"><semantics id="S2.SS3.p4.1.m1.1a"><mover accent="true" id="S2.SS3.p4.1.m1.1.1" xref="S2.SS3.p4.1.m1.1.1.cmml"><mi id="S2.SS3.p4.1.m1.1.1.2" xref="S2.SS3.p4.1.m1.1.1.2.cmml">Y</mi><mo id="S2.SS3.p4.1.m1.1.1.1" xref="S2.SS3.p4.1.m1.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.1.m1.1b"><apply id="S2.SS3.p4.1.m1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1"><ci id="S2.SS3.p4.1.m1.1.1.1.cmml" xref="S2.SS3.p4.1.m1.1.1.1">~</ci><ci id="S2.SS3.p4.1.m1.1.1.2.cmml" xref="S2.SS3.p4.1.m1.1.1.2">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.1.m1.1c">\tilde{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.1.m1.1d">over~ start_ARG italic_Y end_ARG</annotation></semantics></math> also sets a limit on the target size of the prediction mask. Again, we consider output probabilities rather than individual predictions to ensure differentiability. By applying priors on the fraction <math alttext="\epsilon\in[0,1]" class="ltx_Math" display="inline" id="S2.SS3.p4.2.m2.2"><semantics id="S2.SS3.p4.2.m2.2a"><mrow id="S2.SS3.p4.2.m2.2.3" xref="S2.SS3.p4.2.m2.2.3.cmml"><mi id="S2.SS3.p4.2.m2.2.3.2" xref="S2.SS3.p4.2.m2.2.3.2.cmml">ϵ</mi><mo id="S2.SS3.p4.2.m2.2.3.1" xref="S2.SS3.p4.2.m2.2.3.1.cmml">∈</mo><mrow id="S2.SS3.p4.2.m2.2.3.3.2" xref="S2.SS3.p4.2.m2.2.3.3.1.cmml"><mo id="S2.SS3.p4.2.m2.2.3.3.2.1" stretchy="false" xref="S2.SS3.p4.2.m2.2.3.3.1.cmml">[</mo><mn id="S2.SS3.p4.2.m2.1.1" xref="S2.SS3.p4.2.m2.1.1.cmml">0</mn><mo id="S2.SS3.p4.2.m2.2.3.3.2.2" xref="S2.SS3.p4.2.m2.2.3.3.1.cmml">,</mo><mn id="S2.SS3.p4.2.m2.2.2" xref="S2.SS3.p4.2.m2.2.2.cmml">1</mn><mo id="S2.SS3.p4.2.m2.2.3.3.2.3" stretchy="false" xref="S2.SS3.p4.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.2.m2.2b"><apply id="S2.SS3.p4.2.m2.2.3.cmml" xref="S2.SS3.p4.2.m2.2.3"><in id="S2.SS3.p4.2.m2.2.3.1.cmml" xref="S2.SS3.p4.2.m2.2.3.1"></in><ci id="S2.SS3.p4.2.m2.2.3.2.cmml" xref="S2.SS3.p4.2.m2.2.3.2">italic-ϵ</ci><interval closure="closed" id="S2.SS3.p4.2.m2.2.3.3.1.cmml" xref="S2.SS3.p4.2.m2.2.3.3.2"><cn id="S2.SS3.p4.2.m2.1.1.cmml" type="integer" xref="S2.SS3.p4.2.m2.1.1">0</cn><cn id="S2.SS3.p4.2.m2.2.2.cmml" type="integer" xref="S2.SS3.p4.2.m2.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.2.m2.2c">\epsilon\in[0,1]</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.2.m2.2d">italic_ϵ ∈ [ 0 , 1 ]</annotation></semantics></math> of pixels from <math alttext="\Upomega_{I}" class="ltx_Math" display="inline" id="S2.SS3.p4.3.m3.1"><semantics id="S2.SS3.p4.3.m3.1a"><msub id="S2.SS3.p4.3.m3.1.1" xref="S2.SS3.p4.3.m3.1.1.cmml"><mi id="S2.SS3.p4.3.m3.1.1.2" mathvariant="normal" xref="S2.SS3.p4.3.m3.1.1.2.cmml">Ω</mi><mi id="S2.SS3.p4.3.m3.1.1.3" xref="S2.SS3.p4.3.m3.1.1.3.cmml">I</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.3.m3.1b"><apply id="S2.SS3.p4.3.m3.1.1.cmml" xref="S2.SS3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.p4.3.m3.1.1.1.cmml" xref="S2.SS3.p4.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.p4.3.m3.1.1.2.cmml" xref="S2.SS3.p4.3.m3.1.1.2">Ω</ci><ci id="S2.SS3.p4.3.m3.1.1.3.cmml" xref="S2.SS3.p4.3.m3.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.3.m3.1c">\Upomega_{I}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.3.m3.1d">roman_Ω start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT</annotation></semantics></math> that belong to the background, we get:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\epsilon_{1}|\Upomega_{I}|\leq\sum_{p\in\Upomega}f_{\theta}(p)\leq\epsilon_{2}%
|\Upomega_{I}|." class="ltx_Math" display="block" id="S2.E4.m1.2"><semantics id="S2.E4.m1.2a"><mrow id="S2.E4.m1.2.2.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1" xref="S2.E4.m1.2.2.1.1.cmml"><mrow id="S2.E4.m1.2.2.1.1.1" xref="S2.E4.m1.2.2.1.1.1.cmml"><msub id="S2.E4.m1.2.2.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.1.3.2" xref="S2.E4.m1.2.2.1.1.1.3.2.cmml">ϵ</mi><mn id="S2.E4.m1.2.2.1.1.1.3.3" xref="S2.E4.m1.2.2.1.1.1.3.3.cmml">1</mn></msub><mo id="S2.E4.m1.2.2.1.1.1.2" xref="S2.E4.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.2.2.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.2.cmml"><mo id="S2.E4.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.1.1.2.1.cmml">|</mo><msub id="S2.E4.m1.2.2.1.1.1.1.1.1" xref="S2.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.2" mathvariant="normal" xref="S2.E4.m1.2.2.1.1.1.1.1.1.2.cmml">Ω</mi><mi id="S2.E4.m1.2.2.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3.cmml">I</mi></msub><mo id="S2.E4.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.2.2.1.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.4" rspace="0.111em" xref="S2.E4.m1.2.2.1.1.4.cmml">≤</mo><mrow id="S2.E4.m1.2.2.1.1.5" xref="S2.E4.m1.2.2.1.1.5.cmml"><munder id="S2.E4.m1.2.2.1.1.5.1" xref="S2.E4.m1.2.2.1.1.5.1.cmml"><mo id="S2.E4.m1.2.2.1.1.5.1.2" movablelimits="false" xref="S2.E4.m1.2.2.1.1.5.1.2.cmml">∑</mo><mrow id="S2.E4.m1.2.2.1.1.5.1.3" xref="S2.E4.m1.2.2.1.1.5.1.3.cmml"><mi id="S2.E4.m1.2.2.1.1.5.1.3.2" xref="S2.E4.m1.2.2.1.1.5.1.3.2.cmml">p</mi><mo id="S2.E4.m1.2.2.1.1.5.1.3.1" xref="S2.E4.m1.2.2.1.1.5.1.3.1.cmml">∈</mo><mi id="S2.E4.m1.2.2.1.1.5.1.3.3" mathvariant="normal" xref="S2.E4.m1.2.2.1.1.5.1.3.3.cmml">Ω</mi></mrow></munder><mrow id="S2.E4.m1.2.2.1.1.5.2" xref="S2.E4.m1.2.2.1.1.5.2.cmml"><msub id="S2.E4.m1.2.2.1.1.5.2.2" xref="S2.E4.m1.2.2.1.1.5.2.2.cmml"><mi id="S2.E4.m1.2.2.1.1.5.2.2.2" xref="S2.E4.m1.2.2.1.1.5.2.2.2.cmml">f</mi><mi id="S2.E4.m1.2.2.1.1.5.2.2.3" xref="S2.E4.m1.2.2.1.1.5.2.2.3.cmml">θ</mi></msub><mo id="S2.E4.m1.2.2.1.1.5.2.1" xref="S2.E4.m1.2.2.1.1.5.2.1.cmml">⁢</mo><mrow id="S2.E4.m1.2.2.1.1.5.2.3.2" xref="S2.E4.m1.2.2.1.1.5.2.cmml"><mo id="S2.E4.m1.2.2.1.1.5.2.3.2.1" stretchy="false" xref="S2.E4.m1.2.2.1.1.5.2.cmml">(</mo><mi id="S2.E4.m1.1.1" xref="S2.E4.m1.1.1.cmml">p</mi><mo id="S2.E4.m1.2.2.1.1.5.2.3.2.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.5.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.2.2.1.1.6" xref="S2.E4.m1.2.2.1.1.6.cmml">≤</mo><mrow id="S2.E4.m1.2.2.1.1.2" xref="S2.E4.m1.2.2.1.1.2.cmml"><msub id="S2.E4.m1.2.2.1.1.2.3" xref="S2.E4.m1.2.2.1.1.2.3.cmml"><mi id="S2.E4.m1.2.2.1.1.2.3.2" xref="S2.E4.m1.2.2.1.1.2.3.2.cmml">ϵ</mi><mn id="S2.E4.m1.2.2.1.1.2.3.3" xref="S2.E4.m1.2.2.1.1.2.3.3.cmml">2</mn></msub><mo id="S2.E4.m1.2.2.1.1.2.2" xref="S2.E4.m1.2.2.1.1.2.2.cmml">⁢</mo><mrow id="S2.E4.m1.2.2.1.1.2.1.1" xref="S2.E4.m1.2.2.1.1.2.1.2.cmml"><mo id="S2.E4.m1.2.2.1.1.2.1.1.2" stretchy="false" xref="S2.E4.m1.2.2.1.1.2.1.2.1.cmml">|</mo><msub id="S2.E4.m1.2.2.1.1.2.1.1.1" xref="S2.E4.m1.2.2.1.1.2.1.1.1.cmml"><mi id="S2.E4.m1.2.2.1.1.2.1.1.1.2" mathvariant="normal" xref="S2.E4.m1.2.2.1.1.2.1.1.1.2.cmml">Ω</mi><mi id="S2.E4.m1.2.2.1.1.2.1.1.1.3" xref="S2.E4.m1.2.2.1.1.2.1.1.1.3.cmml">I</mi></msub><mo id="S2.E4.m1.2.2.1.1.2.1.1.3" stretchy="false" xref="S2.E4.m1.2.2.1.1.2.1.2.1.cmml">|</mo></mrow></mrow></mrow><mo id="S2.E4.m1.2.2.1.2" lspace="0em" xref="S2.E4.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.2.1.1.cmml" xref="S2.E4.m1.2.2.1"><and id="S2.E4.m1.2.2.1.1a.cmml" xref="S2.E4.m1.2.2.1"></and><apply id="S2.E4.m1.2.2.1.1b.cmml" xref="S2.E4.m1.2.2.1"><leq id="S2.E4.m1.2.2.1.1.4.cmml" xref="S2.E4.m1.2.2.1.1.4"></leq><apply id="S2.E4.m1.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1"><times id="S2.E4.m1.2.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.2"></times><apply id="S2.E4.m1.2.2.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.1.3.2">italic-ϵ</ci><cn id="S2.E4.m1.2.2.1.1.1.3.3.cmml" type="integer" xref="S2.E4.m1.2.2.1.1.1.3.3">1</cn></apply><apply id="S2.E4.m1.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1"><abs id="S2.E4.m1.2.2.1.1.1.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.2"></abs><apply id="S2.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.2">Ω</ci><ci id="S2.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.1.1.1.1.3">𝐼</ci></apply></apply></apply><apply id="S2.E4.m1.2.2.1.1.5.cmml" xref="S2.E4.m1.2.2.1.1.5"><apply id="S2.E4.m1.2.2.1.1.5.1.cmml" xref="S2.E4.m1.2.2.1.1.5.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.1.1.cmml" xref="S2.E4.m1.2.2.1.1.5.1">subscript</csymbol><sum id="S2.E4.m1.2.2.1.1.5.1.2.cmml" xref="S2.E4.m1.2.2.1.1.5.1.2"></sum><apply id="S2.E4.m1.2.2.1.1.5.1.3.cmml" xref="S2.E4.m1.2.2.1.1.5.1.3"><in id="S2.E4.m1.2.2.1.1.5.1.3.1.cmml" xref="S2.E4.m1.2.2.1.1.5.1.3.1"></in><ci id="S2.E4.m1.2.2.1.1.5.1.3.2.cmml" xref="S2.E4.m1.2.2.1.1.5.1.3.2">𝑝</ci><ci id="S2.E4.m1.2.2.1.1.5.1.3.3.cmml" xref="S2.E4.m1.2.2.1.1.5.1.3.3">Ω</ci></apply></apply><apply id="S2.E4.m1.2.2.1.1.5.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2"><times id="S2.E4.m1.2.2.1.1.5.2.1.cmml" xref="S2.E4.m1.2.2.1.1.5.2.1"></times><apply id="S2.E4.m1.2.2.1.1.5.2.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.5.2.2.1.cmml" xref="S2.E4.m1.2.2.1.1.5.2.2">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.5.2.2.2.cmml" xref="S2.E4.m1.2.2.1.1.5.2.2.2">𝑓</ci><ci id="S2.E4.m1.2.2.1.1.5.2.2.3.cmml" xref="S2.E4.m1.2.2.1.1.5.2.2.3">𝜃</ci></apply><ci id="S2.E4.m1.1.1.cmml" xref="S2.E4.m1.1.1">𝑝</ci></apply></apply></apply><apply id="S2.E4.m1.2.2.1.1c.cmml" xref="S2.E4.m1.2.2.1"><leq id="S2.E4.m1.2.2.1.1.6.cmml" xref="S2.E4.m1.2.2.1.1.6"></leq><share href="https://arxiv.org/html/2409.20293v1#S2.E4.m1.2.2.1.1.5.cmml" id="S2.E4.m1.2.2.1.1d.cmml" xref="S2.E4.m1.2.2.1"></share><apply id="S2.E4.m1.2.2.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2"><times id="S2.E4.m1.2.2.1.1.2.2.cmml" xref="S2.E4.m1.2.2.1.1.2.2"></times><apply id="S2.E4.m1.2.2.1.1.2.3.cmml" xref="S2.E4.m1.2.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.2.3.1.cmml" xref="S2.E4.m1.2.2.1.1.2.3">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.2.3.2.cmml" xref="S2.E4.m1.2.2.1.1.2.3.2">italic-ϵ</ci><cn id="S2.E4.m1.2.2.1.1.2.3.3.cmml" type="integer" xref="S2.E4.m1.2.2.1.1.2.3.3">2</cn></apply><apply id="S2.E4.m1.2.2.1.1.2.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1"><abs id="S2.E4.m1.2.2.1.1.2.1.2.1.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.2"></abs><apply id="S2.E4.m1.2.2.1.1.2.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1.2">Ω</ci><ci id="S2.E4.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S2.E4.m1.2.2.1.1.2.1.1.1.3">𝐼</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\epsilon_{1}|\Upomega_{I}|\leq\sum_{p\in\Upomega}f_{\theta}(p)\leq\epsilon_{2}%
|\Upomega_{I}|.</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.2d">italic_ϵ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | roman_Ω start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT | ≤ ∑ start_POSTSUBSCRIPT italic_p ∈ roman_Ω end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_p ) ≤ italic_ϵ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | roman_Ω start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT | .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS3.p4.4">As before, we employ <math alttext="\psi_{t}(x)" class="ltx_Math" display="inline" id="S2.SS3.p4.4.m1.1"><semantics id="S2.SS3.p4.4.m1.1a"><mrow id="S2.SS3.p4.4.m1.1.2" xref="S2.SS3.p4.4.m1.1.2.cmml"><msub id="S2.SS3.p4.4.m1.1.2.2" xref="S2.SS3.p4.4.m1.1.2.2.cmml"><mi id="S2.SS3.p4.4.m1.1.2.2.2" xref="S2.SS3.p4.4.m1.1.2.2.2.cmml">ψ</mi><mi id="S2.SS3.p4.4.m1.1.2.2.3" xref="S2.SS3.p4.4.m1.1.2.2.3.cmml">t</mi></msub><mo id="S2.SS3.p4.4.m1.1.2.1" xref="S2.SS3.p4.4.m1.1.2.1.cmml">⁢</mo><mrow id="S2.SS3.p4.4.m1.1.2.3.2" xref="S2.SS3.p4.4.m1.1.2.cmml"><mo id="S2.SS3.p4.4.m1.1.2.3.2.1" stretchy="false" xref="S2.SS3.p4.4.m1.1.2.cmml">(</mo><mi id="S2.SS3.p4.4.m1.1.1" xref="S2.SS3.p4.4.m1.1.1.cmml">x</mi><mo id="S2.SS3.p4.4.m1.1.2.3.2.2" stretchy="false" xref="S2.SS3.p4.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p4.4.m1.1b"><apply id="S2.SS3.p4.4.m1.1.2.cmml" xref="S2.SS3.p4.4.m1.1.2"><times id="S2.SS3.p4.4.m1.1.2.1.cmml" xref="S2.SS3.p4.4.m1.1.2.1"></times><apply id="S2.SS3.p4.4.m1.1.2.2.cmml" xref="S2.SS3.p4.4.m1.1.2.2"><csymbol cd="ambiguous" id="S2.SS3.p4.4.m1.1.2.2.1.cmml" xref="S2.SS3.p4.4.m1.1.2.2">subscript</csymbol><ci id="S2.SS3.p4.4.m1.1.2.2.2.cmml" xref="S2.SS3.p4.4.m1.1.2.2.2">𝜓</ci><ci id="S2.SS3.p4.4.m1.1.2.2.3.cmml" xref="S2.SS3.p4.4.m1.1.2.2.3">𝑡</ci></apply><ci id="S2.SS3.p4.4.m1.1.1.cmml" xref="S2.SS3.p4.4.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p4.4.m1.1c">\psi_{t}(x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p4.4.m1.1d">italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> to convert these inequality constraints into the following loss:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathit{size}}\,=\,\psi_{t}\bigg{(}\epsilon_{1}|\Upomega_{I}|-%
\sum_{p\in\Upomega}f_{\theta}(p))\bigg{)}+\psi_{t}\bigg{(}\sum_{p\in\Upomega}f%
_{\theta}(p)-\epsilon_{2}|\Upomega_{I}|\bigg{)}." class="ltx_math_unparsed" display="block" id="S2.E5.m1.1"><semantics id="S2.E5.m1.1a"><mrow id="S2.E5.m1.1b"><msub id="S2.E5.m1.1.2"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.2.2">ℒ</mi><mi id="S2.E5.m1.1.2.3">𝑠𝑖𝑧𝑒</mi></msub><mo id="S2.E5.m1.1.3" lspace="0.448em" rspace="0.448em">=</mo><msub id="S2.E5.m1.1.4"><mi id="S2.E5.m1.1.4.2">ψ</mi><mi id="S2.E5.m1.1.4.3">t</mi></msub><mrow id="S2.E5.m1.1.5"><mo id="S2.E5.m1.1.5.1" maxsize="210%" minsize="210%">(</mo><msub id="S2.E5.m1.1.5.2"><mi id="S2.E5.m1.1.5.2.2">ϵ</mi><mn id="S2.E5.m1.1.5.2.3">1</mn></msub><mo fence="false" id="S2.E5.m1.1.5.3" rspace="0.167em" stretchy="false">|</mo><msub id="S2.E5.m1.1.5.4"><mi id="S2.E5.m1.1.5.4.2" mathvariant="normal">Ω</mi><mi id="S2.E5.m1.1.5.4.3">I</mi></msub><mo fence="false" id="S2.E5.m1.1.5.5" stretchy="false">|</mo><mo id="S2.E5.m1.1.5.6" lspace="0em" rspace="0.055em">−</mo><munder id="S2.E5.m1.1.5.7"><mo id="S2.E5.m1.1.5.7.2" movablelimits="false">∑</mo><mrow id="S2.E5.m1.1.5.7.3"><mi id="S2.E5.m1.1.5.7.3.2">p</mi><mo id="S2.E5.m1.1.5.7.3.1">∈</mo><mi id="S2.E5.m1.1.5.7.3.3" mathvariant="normal">Ω</mi></mrow></munder><msub id="S2.E5.m1.1.5.8"><mi id="S2.E5.m1.1.5.8.2">f</mi><mi id="S2.E5.m1.1.5.8.3">θ</mi></msub><mrow id="S2.E5.m1.1.5.9"><mo id="S2.E5.m1.1.5.9.1" stretchy="false">(</mo><mi id="S2.E5.m1.1.1">p</mi><mo id="S2.E5.m1.1.5.9.2" stretchy="false">)</mo></mrow><mo id="S2.E5.m1.1.5.10" stretchy="false">)</mo></mrow><mo id="S2.E5.m1.1.6" maxsize="210%" minsize="210%">)</mo><mo id="S2.E5.m1.1.7">+</mo><mi id="S2.E5.m1.1.8">ψ</mi><msub id="S2.E5.m1.1.9"><mi id="S2.E5.m1.1.9a"></mi><mi id="S2.E5.m1.1.9.1">t</mi></msub><mo id="S2.E5.m1.1.10" maxsize="210%" minsize="210%">(</mo><munder id="S2.E5.m1.1.11"><mo id="S2.E5.m1.1.11.2" lspace="0em" movablelimits="false">∑</mo><mrow id="S2.E5.m1.1.11.3"><mi id="S2.E5.m1.1.11.3.2">p</mi><mo id="S2.E5.m1.1.11.3.1">∈</mo><mi id="S2.E5.m1.1.11.3.3" mathvariant="normal">Ω</mi></mrow></munder><msub id="S2.E5.m1.1.12"><mi id="S2.E5.m1.1.12.2">f</mi><mi id="S2.E5.m1.1.12.3">θ</mi></msub><mrow id="S2.E5.m1.1.13"><mo id="S2.E5.m1.1.13.1" stretchy="false">(</mo><mi id="S2.E5.m1.1.13.2">p</mi><mo id="S2.E5.m1.1.13.3" stretchy="false">)</mo></mrow><mo id="S2.E5.m1.1.14">−</mo><msub id="S2.E5.m1.1.15"><mi id="S2.E5.m1.1.15.2">ϵ</mi><mn id="S2.E5.m1.1.15.3">2</mn></msub><mo fence="false" id="S2.E5.m1.1.16" rspace="0.167em" stretchy="false">|</mo><msub id="S2.E5.m1.1.17"><mi id="S2.E5.m1.1.17.2" mathvariant="normal">Ω</mi><mi id="S2.E5.m1.1.17.3">I</mi></msub><mo fence="false" id="S2.E5.m1.1.18" rspace="0.167em" stretchy="false">|</mo><mo id="S2.E5.m1.1.19" maxsize="210%" minsize="210%">)</mo><mo id="S2.E5.m1.1.20" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S2.E5.m1.1c">\mathcal{L}_{\mathit{size}}\,=\,\psi_{t}\bigg{(}\epsilon_{1}|\Upomega_{I}|-%
\sum_{p\in\Upomega}f_{\theta}(p))\bigg{)}+\psi_{t}\bigg{(}\sum_{p\in\Upomega}f%
_{\theta}(p)-\epsilon_{2}|\Upomega_{I}|\bigg{)}.</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_size end_POSTSUBSCRIPT = italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( italic_ϵ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | roman_Ω start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT | - ∑ start_POSTSUBSCRIPT italic_p ∈ roman_Ω end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_p ) ) ) + italic_ψ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ( ∑ start_POSTSUBSCRIPT italic_p ∈ roman_Ω end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_p ) - italic_ϵ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | roman_Ω start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT | ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS3.p5">
<p class="ltx_p" id="S2.SS3.p5.2">Given (<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.E1" title="In 2.3 Learning with tight box annotations ‣ 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">1</span></a>), (<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.E3" title="In 2.3 Learning with tight box annotations ‣ 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">3</span></a>) and (<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S2.E5" title="In 2.3 Learning with tight box annotations ‣ 2 Methodology ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">5</span></a>), and weights <math alttext="\lambda_{1}" class="ltx_Math" display="inline" id="S2.SS3.p5.1.m1.1"><semantics id="S2.SS3.p5.1.m1.1a"><msub id="S2.SS3.p5.1.m1.1.1" xref="S2.SS3.p5.1.m1.1.1.cmml"><mi id="S2.SS3.p5.1.m1.1.1.2" xref="S2.SS3.p5.1.m1.1.1.2.cmml">λ</mi><mn id="S2.SS3.p5.1.m1.1.1.3" xref="S2.SS3.p5.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.1.m1.1b"><apply id="S2.SS3.p5.1.m1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.p5.1.m1.1.1.1.cmml" xref="S2.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.p5.1.m1.1.1.2.cmml" xref="S2.SS3.p5.1.m1.1.1.2">𝜆</ci><cn id="S2.SS3.p5.1.m1.1.1.3.cmml" type="integer" xref="S2.SS3.p5.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.1.m1.1c">\lambda_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.1.m1.1d">italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\lambda_{2}" class="ltx_Math" display="inline" id="S2.SS3.p5.2.m2.1"><semantics id="S2.SS3.p5.2.m2.1a"><msub id="S2.SS3.p5.2.m2.1.1" xref="S2.SS3.p5.2.m2.1.1.cmml"><mi id="S2.SS3.p5.2.m2.1.1.2" xref="S2.SS3.p5.2.m2.1.1.2.cmml">λ</mi><mn id="S2.SS3.p5.2.m2.1.1.3" xref="S2.SS3.p5.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.p5.2.m2.1b"><apply id="S2.SS3.p5.2.m2.1.1.cmml" xref="S2.SS3.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.p5.2.m2.1.1.1.cmml" xref="S2.SS3.p5.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.p5.2.m2.1.1.2.cmml" xref="S2.SS3.p5.2.m2.1.1.2">𝜆</ci><cn id="S2.SS3.p5.2.m2.1.1.3.cmml" type="integer" xref="S2.SS3.p5.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p5.2.m2.1c">\lambda_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.SS3.p5.2.m2.1d">italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, the final loss becomes:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\mathit{total}}\,=\,\mathcal{L}_{\mathit{empty}}\,+\,\lambda_{1}%
\,\mathcal{L}_{\mathit{tightbox}}\,+\,\lambda_{2}\,\mathcal{L}_{\mathit{size}}." class="ltx_Math" display="block" id="S2.E6.m1.1"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.cmml"><msub id="S2.E6.m1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.1.1.1.1.2.2" xref="S2.E6.m1.1.1.1.1.2.2.cmml">ℒ</mi><mi id="S2.E6.m1.1.1.1.1.2.3" xref="S2.E6.m1.1.1.1.1.2.3.cmml">𝑡𝑜𝑡𝑎𝑙</mi></msub><mo id="S2.E6.m1.1.1.1.1.1" lspace="0.448em" rspace="0.448em" xref="S2.E6.m1.1.1.1.1.1.cmml">=</mo><mrow id="S2.E6.m1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.3.cmml"><msub id="S2.E6.m1.1.1.1.1.3.2" xref="S2.E6.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.1.1.1.1.3.2.2" xref="S2.E6.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S2.E6.m1.1.1.1.1.3.2.3" xref="S2.E6.m1.1.1.1.1.3.2.3.cmml">𝑒𝑚𝑝𝑡𝑦</mi></msub><mo id="S2.E6.m1.1.1.1.1.3.1" rspace="0.392em" xref="S2.E6.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E6.m1.1.1.1.1.3.3" xref="S2.E6.m1.1.1.1.1.3.3.cmml"><msub id="S2.E6.m1.1.1.1.1.3.3.2" xref="S2.E6.m1.1.1.1.1.3.3.2.cmml"><mi id="S2.E6.m1.1.1.1.1.3.3.2.2" xref="S2.E6.m1.1.1.1.1.3.3.2.2.cmml">λ</mi><mn id="S2.E6.m1.1.1.1.1.3.3.2.3" xref="S2.E6.m1.1.1.1.1.3.3.2.3.cmml">1</mn></msub><mo id="S2.E6.m1.1.1.1.1.3.3.1" xref="S2.E6.m1.1.1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.E6.m1.1.1.1.1.3.3.3" xref="S2.E6.m1.1.1.1.1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.1.1.1.1.3.3.3.2" xref="S2.E6.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi><mi id="S2.E6.m1.1.1.1.1.3.3.3.3" xref="S2.E6.m1.1.1.1.1.3.3.3.3.cmml">𝑡𝑖𝑔ℎ𝑡𝑏𝑜𝑥</mi></msub></mrow><mo id="S2.E6.m1.1.1.1.1.3.1a" rspace="0.392em" xref="S2.E6.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S2.E6.m1.1.1.1.1.3.4" xref="S2.E6.m1.1.1.1.1.3.4.cmml"><msub id="S2.E6.m1.1.1.1.1.3.4.2" xref="S2.E6.m1.1.1.1.1.3.4.2.cmml"><mi id="S2.E6.m1.1.1.1.1.3.4.2.2" xref="S2.E6.m1.1.1.1.1.3.4.2.2.cmml">λ</mi><mn id="S2.E6.m1.1.1.1.1.3.4.2.3" xref="S2.E6.m1.1.1.1.1.3.4.2.3.cmml">2</mn></msub><mo id="S2.E6.m1.1.1.1.1.3.4.1" xref="S2.E6.m1.1.1.1.1.3.4.1.cmml">⁢</mo><msub id="S2.E6.m1.1.1.1.1.3.4.3" xref="S2.E6.m1.1.1.1.1.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.1.1.1.1.3.4.3.2" xref="S2.E6.m1.1.1.1.1.3.4.3.2.cmml">ℒ</mi><mi id="S2.E6.m1.1.1.1.1.3.4.3.3" xref="S2.E6.m1.1.1.1.1.3.4.3.3.cmml">𝑠𝑖𝑧𝑒</mi></msub></mrow></mrow></mrow><mo id="S2.E6.m1.1.1.1.2" lspace="0em" xref="S2.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"><eq id="S2.E6.m1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1"></eq><apply id="S2.E6.m1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.1.1.2">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.1.1.2.2">ℒ</ci><ci id="S2.E6.m1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.2.3">𝑡𝑜𝑡𝑎𝑙</ci></apply><apply id="S2.E6.m1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.3"><plus id="S2.E6.m1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.1.1.3.1"></plus><apply id="S2.E6.m1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.2.1.cmml" xref="S2.E6.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.3.2.2.cmml" xref="S2.E6.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S2.E6.m1.1.1.1.1.3.2.3.cmml" xref="S2.E6.m1.1.1.1.1.3.2.3">𝑒𝑚𝑝𝑡𝑦</ci></apply><apply id="S2.E6.m1.1.1.1.1.3.3.cmml" xref="S2.E6.m1.1.1.1.1.3.3"><times id="S2.E6.m1.1.1.1.1.3.3.1.cmml" xref="S2.E6.m1.1.1.1.1.3.3.1"></times><apply id="S2.E6.m1.1.1.1.1.3.3.2.cmml" xref="S2.E6.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.3.2.1.cmml" xref="S2.E6.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.3.3.2.2.cmml" xref="S2.E6.m1.1.1.1.1.3.3.2.2">𝜆</ci><cn id="S2.E6.m1.1.1.1.1.3.3.2.3.cmml" type="integer" xref="S2.E6.m1.1.1.1.1.3.3.2.3">1</cn></apply><apply id="S2.E6.m1.1.1.1.1.3.3.3.cmml" xref="S2.E6.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.3.3.1.cmml" xref="S2.E6.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.3.3.3.2.cmml" xref="S2.E6.m1.1.1.1.1.3.3.3.2">ℒ</ci><ci id="S2.E6.m1.1.1.1.1.3.3.3.3.cmml" xref="S2.E6.m1.1.1.1.1.3.3.3.3">𝑡𝑖𝑔ℎ𝑡𝑏𝑜𝑥</ci></apply></apply><apply id="S2.E6.m1.1.1.1.1.3.4.cmml" xref="S2.E6.m1.1.1.1.1.3.4"><times id="S2.E6.m1.1.1.1.1.3.4.1.cmml" xref="S2.E6.m1.1.1.1.1.3.4.1"></times><apply id="S2.E6.m1.1.1.1.1.3.4.2.cmml" xref="S2.E6.m1.1.1.1.1.3.4.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.4.2.1.cmml" xref="S2.E6.m1.1.1.1.1.3.4.2">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.3.4.2.2.cmml" xref="S2.E6.m1.1.1.1.1.3.4.2.2">𝜆</ci><cn id="S2.E6.m1.1.1.1.1.3.4.2.3.cmml" type="integer" xref="S2.E6.m1.1.1.1.1.3.4.2.3">2</cn></apply><apply id="S2.E6.m1.1.1.1.1.3.4.3.cmml" xref="S2.E6.m1.1.1.1.1.3.4.3"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.3.4.3.1.cmml" xref="S2.E6.m1.1.1.1.1.3.4.3">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.3.4.3.2.cmml" xref="S2.E6.m1.1.1.1.1.3.4.3.2">ℒ</ci><ci id="S2.E6.m1.1.1.1.1.3.4.3.3.cmml" xref="S2.E6.m1.1.1.1.1.3.4.3.3">𝑠𝑖𝑧𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\mathcal{L}_{\mathit{total}}\,=\,\mathcal{L}_{\mathit{empty}}\,+\,\lambda_{1}%
\,\mathcal{L}_{\mathit{tightbox}}\,+\,\lambda_{2}\,\mathcal{L}_{\mathit{size}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_total end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT italic_empty end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_tightbox end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_size end_POSTSUBSCRIPT .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Results</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Datasets</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Our experiments validate our method on three public datasets: the Head Circumference dataset<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://hc18.grand-challenge.org/</span></span></span> (HC18) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib6" title="">6</a>]</cite>, the Cardiac Acquisitions for Multi-structure Ultrasound Segmentation<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://www.creatis.insa-lyon.fr/Challenge/camus/</span></span></span> (CAMUS) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib11" title="">11</a>]</cite> and the Automated Cardiac Diagnosis Challenge<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://humanheart-project.creatis.insa-lyon.fr/database/</span></span></span> (ACDC) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib1" title="">1</a>]</cite>. For both cardiac datasets, the end diastole images are used.
For HC18, we filter out samples with ground-truth masks that could not be automatically generated by OpenCV from the circumference annotations, and split the ultrasound dataset into 507 training, 77 validation and 148 test images.
For CAMUS, we focus on the left ventricle (LV) and left atrium (LA) segmentation and use 50 images for validation, 100 images for testing and the remaining 350 images for training.
For ACDC, we focus on the right ventricle (RV) and LV segmentation and use 10 patients for validation (78 images), 50 for testing (470 images)and the remaining 90 patients (765 images) for training. Each sample has a minimum foreground size for all experiments.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.8">Following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib12" title="">12</a>]</cite>, our preprocessing includes clipping the intensity values of each 2D image (HC18, CAMUS) or each 3D volume (ACDC) between the <math alttext="0.5^{th}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><msup id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mn id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">0.5</mn><mrow id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p2.1.m1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">superscript</csymbol><cn id="S3.SS1.p2.1.m1.1.1.2.cmml" type="float" xref="S3.SS1.p2.1.m1.1.1.2">0.5</cn><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><times id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.1"></times><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">𝑡</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">0.5^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">0.5 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="99.5^{th}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><msup id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mn id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">99.5</mn><mrow id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS1.p2.2.m2.1.1.3.1" xref="S3.SS1.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">superscript</csymbol><cn id="S3.SS1.p2.2.m2.1.1.2.cmml" type="float" xref="S3.SS1.p2.2.m2.1.1.2">99.5</cn><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><times id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3.1"></times><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">𝑡</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">99.5^{th}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">99.5 start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> percentiles and rescaling them to the range [0, 255]. We also partition each 3D volume of ACDC into 2D image which we resample to a fixed 1mm <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mo id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><times id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">×</annotation></semantics></math> 1mm resolution. We center crop and pad each sample to size 640 <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mo id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><times id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">×</annotation></semantics></math> 640 (HC), 512 <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mo id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><times id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">×</annotation></semantics></math> 512 (CAMUS) or 256 <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mo id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><times id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">×</annotation></semantics></math> 256 (ACDC). To meet MedSAM’s requirements, we resize all images to a fixed 3 <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mo id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><times id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">×</annotation></semantics></math> 1024 <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><mo id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><times id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">×</annotation></semantics></math> 1024 size before inputting them in the model.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Implementation details</h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.3"><span class="ltx_text ltx_font_bold" id="S3.SS2.p1.3.1">Model.</span>  Our backbone model is MedSAM based on ViT-B, the smallest version of SAM. The backbone remains frozen during training. We keep our prompt module lightweight by using few layers. A 1 <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mo id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><times id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">×</annotation></semantics></math> 1 convolution first reduces the number of channels. Then, the dense embedding is obtained through a 3 <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mo id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><times id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">×</annotation></semantics></math> 3 convolution, while the sparse embedding is obtained through a 1 <math alttext="\times" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mo id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><times id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">×</annotation></semantics></math> 1 convolution followed by max pooling and a fully connected layer. All convolutional layers are followed by ReLU activation. Our prompt module has thus 2.4M trainable parameters.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.5"><span class="ltx_text ltx_font_bold" id="S3.SS2.p2.5.1">Loss parameters.</span>  We train our prompt module using <math alttext="\mathcal{L}_{\mathit{total}}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">𝑡𝑜𝑡𝑎𝑙</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">ℒ</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑡𝑜𝑡𝑎𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\mathcal{L}_{\mathit{total}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_total end_POSTSUBSCRIPT</annotation></semantics></math>, with <math alttext="\lambda_{1}=0.0001" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><msub id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">λ</mi><mn id="S3.SS2.p2.2.m2.1.1.2.3" xref="S3.SS2.p2.2.m2.1.1.2.3.cmml">1</mn></msub><mo id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">0.0001</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><eq id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"></eq><apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">𝜆</ci><cn id="S3.SS2.p2.2.m2.1.1.2.3.cmml" type="integer" xref="S3.SS2.p2.2.m2.1.1.2.3">1</cn></apply><cn id="S3.SS2.p2.2.m2.1.1.3.cmml" type="float" xref="S3.SS2.p2.2.m2.1.1.3">0.0001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\lambda_{1}=0.0001</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = 0.0001</annotation></semantics></math>, <math alttext="\lambda_{2}=0.01" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mrow id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><msub id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2.2" xref="S3.SS2.p2.3.m3.1.1.2.2.cmml">λ</mi><mn id="S3.SS2.p2.3.m3.1.1.2.3" xref="S3.SS2.p2.3.m3.1.1.2.3.cmml">2</mn></msub><mo id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><eq id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1"></eq><apply id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.2.1.cmml" xref="S3.SS2.p2.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2.2">𝜆</ci><cn id="S3.SS2.p2.3.m3.1.1.2.3.cmml" type="integer" xref="S3.SS2.p2.3.m3.1.1.2.3">2</cn></apply><cn id="S3.SS2.p2.3.m3.1.1.3.cmml" type="float" xref="S3.SS2.p2.3.m3.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">\lambda_{2}=0.01</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.01</annotation></semantics></math>. For our tight box constraint, we follow <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib9" title="">9</a>]</cite> and use segments of <math alttext="w=5" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">w</mi><mo id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><eq id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"></eq><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑤</ci><cn id="S3.SS2.p2.4.m4.1.1.3.cmml" type="integer" xref="S3.SS2.p2.4.m4.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">w=5</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_w = 5</annotation></semantics></math>. We hypothesize that the foreground region is at least half the size its tight bounding box and set <math alttext="[\epsilon_{1},\epsilon_{2}]=[0.5,0.9]" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.4"><semantics id="S3.SS2.p2.5.m5.4a"><mrow id="S3.SS2.p2.5.m5.4.4" xref="S3.SS2.p2.5.m5.4.4.cmml"><mrow id="S3.SS2.p2.5.m5.4.4.2.2" xref="S3.SS2.p2.5.m5.4.4.2.3.cmml"><mo id="S3.SS2.p2.5.m5.4.4.2.2.3" stretchy="false" xref="S3.SS2.p2.5.m5.4.4.2.3.cmml">[</mo><msub id="S3.SS2.p2.5.m5.3.3.1.1.1" xref="S3.SS2.p2.5.m5.3.3.1.1.1.cmml"><mi id="S3.SS2.p2.5.m5.3.3.1.1.1.2" xref="S3.SS2.p2.5.m5.3.3.1.1.1.2.cmml">ϵ</mi><mn id="S3.SS2.p2.5.m5.3.3.1.1.1.3" xref="S3.SS2.p2.5.m5.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.5.m5.4.4.2.2.4" xref="S3.SS2.p2.5.m5.4.4.2.3.cmml">,</mo><msub id="S3.SS2.p2.5.m5.4.4.2.2.2" xref="S3.SS2.p2.5.m5.4.4.2.2.2.cmml"><mi id="S3.SS2.p2.5.m5.4.4.2.2.2.2" xref="S3.SS2.p2.5.m5.4.4.2.2.2.2.cmml">ϵ</mi><mn id="S3.SS2.p2.5.m5.4.4.2.2.2.3" xref="S3.SS2.p2.5.m5.4.4.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p2.5.m5.4.4.2.2.5" stretchy="false" xref="S3.SS2.p2.5.m5.4.4.2.3.cmml">]</mo></mrow><mo id="S3.SS2.p2.5.m5.4.4.3" xref="S3.SS2.p2.5.m5.4.4.3.cmml">=</mo><mrow id="S3.SS2.p2.5.m5.4.4.4.2" xref="S3.SS2.p2.5.m5.4.4.4.1.cmml"><mo id="S3.SS2.p2.5.m5.4.4.4.2.1" stretchy="false" xref="S3.SS2.p2.5.m5.4.4.4.1.cmml">[</mo><mn id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">0.5</mn><mo id="S3.SS2.p2.5.m5.4.4.4.2.2" xref="S3.SS2.p2.5.m5.4.4.4.1.cmml">,</mo><mn id="S3.SS2.p2.5.m5.2.2" xref="S3.SS2.p2.5.m5.2.2.cmml">0.9</mn><mo id="S3.SS2.p2.5.m5.4.4.4.2.3" stretchy="false" xref="S3.SS2.p2.5.m5.4.4.4.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.4b"><apply id="S3.SS2.p2.5.m5.4.4.cmml" xref="S3.SS2.p2.5.m5.4.4"><eq id="S3.SS2.p2.5.m5.4.4.3.cmml" xref="S3.SS2.p2.5.m5.4.4.3"></eq><interval closure="closed" id="S3.SS2.p2.5.m5.4.4.2.3.cmml" xref="S3.SS2.p2.5.m5.4.4.2.2"><apply id="S3.SS2.p2.5.m5.3.3.1.1.1.cmml" xref="S3.SS2.p2.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS2.p2.5.m5.3.3.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS2.p2.5.m5.3.3.1.1.1.2">italic-ϵ</ci><cn id="S3.SS2.p2.5.m5.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS2.p2.5.m5.3.3.1.1.1.3">1</cn></apply><apply id="S3.SS2.p2.5.m5.4.4.2.2.2.cmml" xref="S3.SS2.p2.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.4.4.2.2.2.1.cmml" xref="S3.SS2.p2.5.m5.4.4.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.5.m5.4.4.2.2.2.2.cmml" xref="S3.SS2.p2.5.m5.4.4.2.2.2.2">italic-ϵ</ci><cn id="S3.SS2.p2.5.m5.4.4.2.2.2.3.cmml" type="integer" xref="S3.SS2.p2.5.m5.4.4.2.2.2.3">2</cn></apply></interval><interval closure="closed" id="S3.SS2.p2.5.m5.4.4.4.1.cmml" xref="S3.SS2.p2.5.m5.4.4.4.2"><cn id="S3.SS2.p2.5.m5.1.1.cmml" type="float" xref="S3.SS2.p2.5.m5.1.1">0.5</cn><cn id="S3.SS2.p2.5.m5.2.2.cmml" type="float" xref="S3.SS2.p2.5.m5.2.2">0.9</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.4c">[\epsilon_{1},\epsilon_{2}]=[0.5,0.9]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.4d">[ italic_ϵ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_ϵ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ] = [ 0.5 , 0.9 ]</annotation></semantics></math>. Comparative training with full segmentation masks uses a Binary Cross-entropy Dice loss, each term having the same weight.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p3.1.1">Training.</span> 
We use a batch size of 4 and a learning rate (LR) of <math alttext="0.001" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mn id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">0.001</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><cn id="S3.SS2.p3.1.m1.1.1.cmml" type="float" xref="S3.SS2.p3.1.m1.1.1">0.001</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">0.001</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">0.001</annotation></semantics></math> with a multi-step scheduler decreasing LR by 0.1 after half the epochs and a weight decay of 0.0001. To minimize computational complexity, we do not use data augmentation. This allows us to discard MedSAM’s image and prompt encoders after saving the image embeddings during an initial iteration, reducing the number of total parameters from 96.1M to only 6.5M (2.4M trainable). In the 10-shot setting, we repeat the experiments 9 times, with 3 initialization seeds and 3 training subsets selected uniformly at random. The results are averaged over these experiments. All experiments are implemented in Python 3.8.10 with Pytorch on NVIDIA RTX-A6000 GPUs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.p4.1.1">Baselines.</span> 
For each class, we compare our method with two specialized single-task models: a standard UNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib15" title="">15</a>]</cite> and a TransUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib3" title="">3</a>]</cite>. We also validate our method against PerSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib22" title="">22</a>]</cite> which automates SAM with 1-shot supervision, and AutoSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib17" title="">17</a>]</cite> which uses a Harmonic Dense Net (41.6M parameters) to learn the prompt embedding. We train the UNet, TransUNet and AutoSAM on full segmentation masks with a standard Cross-entropy Dice loss. To improve the performance of the baseline models, longer training is used (200 epochs) with a larger batch size of 24 for TransUNet (following <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib3" title="">3</a>]</cite>). Similarly, the best results for PerSAM are obtained with the ViT-H backbone.
Results for MedSAM are also included when prompted with the tightest bounding boxes (no noise).</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Validation on multiple medical segmentation tasks</h3>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.49.2.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S3.T1.2.1" style="font-size:90%;">Model performance on test sets in terms of mean (std) 2D Dice similarity score (<math alttext="\uparrow" class="ltx_Math" display="inline" id="S3.T1.2.1.m1.1"><semantics id="S3.T1.2.1.m1.1b"><mo id="S3.T1.2.1.m1.1.1" stretchy="false" xref="S3.T1.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S3.T1.2.1.m1.1c"><ci id="S3.T1.2.1.m1.1.1.cmml" xref="S3.T1.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.1.m1.1d">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.1.m1.1e">↑</annotation></semantics></math>). Best results in few-shot settings are highlighted in bold.
</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.T1.47" style="width:433.6pt;height:160.1pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-108.7pt,40.0pt) scale(0.666024666123664,0.666024666123664) ;">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.47.45">
<tr class="ltx_tr" id="S3.T1.47.45.46">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T1.47.45.46.1" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.47.45.46.1.1">Type</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T1.47.45.46.2" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.47.45.46.2.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.47.45.46.3" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.47.45.46.3.1"><span class="ltx_text" id="S3.T1.47.45.46.3.1.1"></span> <span class="ltx_text" id="S3.T1.47.45.46.3.1.2">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.47.45.46.3.1.2.1">
<span class="ltx_tr" id="S3.T1.47.45.46.3.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.47.45.46.3.1.2.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">#</span></span>
<span class="ltx_tr" id="S3.T1.47.45.46.3.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.47.45.46.3.1.2.1.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">Samples</span></span>
</span></span> <span class="ltx_text" id="S3.T1.47.45.46.3.1.3"></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.47.45.46.4" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.47.45.46.4.1"><span class="ltx_text" id="S3.T1.47.45.46.4.1.1"></span> <span class="ltx_text" id="S3.T1.47.45.46.4.1.2">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.47.45.46.4.1.2.1">
<span class="ltx_tr" id="S3.T1.47.45.46.4.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.47.45.46.4.1.2.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">Mask</span></span>
<span class="ltx_tr" id="S3.T1.47.45.46.4.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.47.45.46.4.1.2.1.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">labels</span></span>
</span></span> <span class="ltx_text" id="S3.T1.47.45.46.4.1.3"></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.47.45.46.5" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.47.45.46.5.1"><span class="ltx_text" id="S3.T1.47.45.46.5.1.1"></span> <span class="ltx_text" id="S3.T1.47.45.46.5.1.2">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.47.45.46.5.1.2.1">
<span class="ltx_tr" id="S3.T1.47.45.46.5.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.47.45.46.5.1.2.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">BB</span></span>
<span class="ltx_tr" id="S3.T1.47.45.46.5.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T1.47.45.46.5.1.2.1.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">labels</span></span>
</span></span> <span class="ltx_text" id="S3.T1.47.45.46.5.1.3"></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.47.45.46.6" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.47.45.46.6.1">HC</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="2" id="S3.T1.47.45.46.7" style="padding-left:4.0pt;padding-right:4.0pt;">CAMUS</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S3.T1.47.45.46.8" style="padding-left:4.0pt;padding-right:4.0pt;">ACDC</td>
</tr>
<tr class="ltx_tr" id="S3.T1.47.45.47">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.47.45.47.1" style="padding-left:4.0pt;padding-right:4.0pt;">LV</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.47.45.47.2" style="padding-left:4.0pt;padding-right:4.0pt;">LA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.47.45.47.3" style="padding-left:4.0pt;padding-right:4.0pt;">RV</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.47.45.47.4" style="padding-left:4.0pt;padding-right:4.0pt;">LV</td>
</tr>
<tr class="ltx_tr" id="S3.T1.47.45.48">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T1.47.45.48.1" style="padding-left:4.0pt;padding-right:4.0pt;">Promptable</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S3.T1.47.45.48.2" style="padding-left:4.0pt;padding-right:4.0pt;">
<span class="ltx_text" id="S3.T1.47.45.48.2.1"></span><span class="ltx_text" id="S3.T1.47.45.48.2.2">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.47.45.48.2.2.1">
<span class="ltx_tr" id="S3.T1.47.45.48.2.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.47.45.48.2.2.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">MedSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib12" title="">12</a>]</cite></span></span>
<span class="ltx_tr" id="S3.T1.47.45.48.2.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.47.45.48.2.2.1.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">(w/ tight box)</span></span>
</span></span><span class="ltx_text" id="S3.T1.47.45.48.2.3"></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.47.45.48.3" style="padding-left:4.0pt;padding-right:4.0pt;">–</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.47.45.48.4" style="padding-left:4.0pt;padding-right:4.0pt;">–</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.47.45.48.5" style="padding-left:4.0pt;padding-right:4.0pt;">–</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.47.45.48.6" style="padding-left:4.0pt;padding-right:4.0pt;">95.19</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.47.45.48.7" style="padding-left:4.0pt;padding-right:4.0pt;">94.50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.47.45.48.8" style="padding-left:4.0pt;padding-right:4.0pt;">89.23</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.47.45.48.9" style="padding-left:4.0pt;padding-right:4.0pt;">93.78</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.47.45.48.10" style="padding-left:4.0pt;padding-right:4.0pt;">95.45</td>
</tr>
<tr class="ltx_tr" id="S3.T1.7.5.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.7.5.5.6" rowspan="4" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.7.5.5.6.1"><span class="ltx_text" id="S3.T1.7.5.5.6.1.1"></span><span class="ltx_text" id="S3.T1.7.5.5.6.1.2">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.7.5.5.6.1.2.1">
<span class="ltx_tr" id="S3.T1.7.5.5.6.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.7.5.5.6.1.2.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">Automatic</span></span>
<span class="ltx_tr" id="S3.T1.7.5.5.6.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.7.5.5.6.1.2.1.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">(fully trained)</span></span>
</span></span> <span class="ltx_text" id="S3.T1.7.5.5.6.1.3"></span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.7.5.5.7" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.7.5.5.7.1">UNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib15" title="">15</a>]</cite></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.7.5.5.8" style="padding-left:4.0pt;padding-right:4.0pt;">All</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.5.5.9" style="padding-left:4.0pt;padding-right:4.0pt;">✓</td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.T1.7.5.5.10" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.3.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">86.53 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.3.1.1.1.m1.1"><semantics id="S3.T1.3.1.1.1.m1.1a"><mo id="S3.T1.3.1.1.1.m1.1.1" mathsize="50%" xref="S3.T1.3.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.3.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T1.3.1.1.1.m1.1.1.cmml" xref="S3.T1.3.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.1.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.1.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.3.1.1.1.1" style="font-size:50%;">0.55</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.4.2.2.2" style="padding-left:4.0pt;padding-right:4.0pt;">89.93 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.4.2.2.2.m1.1"><semantics id="S3.T1.4.2.2.2.m1.1a"><mo id="S3.T1.4.2.2.2.m1.1.1" mathsize="50%" xref="S3.T1.4.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.4.2.2.2.m1.1b"><csymbol cd="latexml" id="S3.T1.4.2.2.2.m1.1.1.cmml" xref="S3.T1.4.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.2.2.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.2.2.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.4.2.2.2.1" style="font-size:50%;">0.01</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.5.3.3.3" style="padding-left:4.0pt;padding-right:4.0pt;">74.77 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.5.3.3.3.m1.1"><semantics id="S3.T1.5.3.3.3.m1.1a"><mo id="S3.T1.5.3.3.3.m1.1.1" mathsize="50%" xref="S3.T1.5.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.5.3.3.3.m1.1b"><csymbol cd="latexml" id="S3.T1.5.3.3.3.m1.1.1.cmml" xref="S3.T1.5.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.3.3.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.3.3.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.5.3.3.3.1" style="font-size:50%;">0.78</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.6.4.4.4" style="padding-left:4.0pt;padding-right:4.0pt;">89.55 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.6.4.4.4.m1.1"><semantics id="S3.T1.6.4.4.4.m1.1a"><mo id="S3.T1.6.4.4.4.m1.1.1" mathsize="50%" xref="S3.T1.6.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.6.4.4.4.m1.1b"><csymbol cd="latexml" id="S3.T1.6.4.4.4.m1.1.1.cmml" xref="S3.T1.6.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.4.4.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.4.4.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.6.4.4.4.1" style="font-size:50%;">0.23</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.7.5.5.5" style="padding-left:4.0pt;padding-right:4.0pt;">94.83 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.7.5.5.5.m1.1"><semantics id="S3.T1.7.5.5.5.m1.1a"><mo id="S3.T1.7.5.5.5.m1.1.1" mathsize="50%" xref="S3.T1.7.5.5.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.7.5.5.5.m1.1b"><csymbol cd="latexml" id="S3.T1.7.5.5.5.m1.1.1.cmml" xref="S3.T1.7.5.5.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.5.5.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.5.5.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.7.5.5.5.1" style="font-size:50%;">0.13</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.12.10.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.12.10.10.6" style="padding-left:4.0pt;padding-right:4.0pt;">10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.10.10.7" style="padding-left:4.0pt;padding-right:4.0pt;">✓</td>
<td class="ltx_td ltx_border_r" id="S3.T1.12.10.10.8" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.8.6.6.1" style="padding-left:4.0pt;padding-right:4.0pt;">61.79 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.8.6.6.1.m1.1"><semantics id="S3.T1.8.6.6.1.m1.1a"><mo id="S3.T1.8.6.6.1.m1.1.1" mathsize="50%" xref="S3.T1.8.6.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.8.6.6.1.m1.1b"><csymbol cd="latexml" id="S3.T1.8.6.6.1.m1.1.1.cmml" xref="S3.T1.8.6.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.6.6.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.6.6.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.8.6.6.1.1" style="font-size:50%;">3.10</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.9.7.7.2" style="padding-left:4.0pt;padding-right:4.0pt;">75.09 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.9.7.7.2.m1.1"><semantics id="S3.T1.9.7.7.2.m1.1a"><mo id="S3.T1.9.7.7.2.m1.1.1" mathsize="50%" xref="S3.T1.9.7.7.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.9.7.7.2.m1.1b"><csymbol cd="latexml" id="S3.T1.9.7.7.2.m1.1.1.cmml" xref="S3.T1.9.7.7.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.7.7.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.7.7.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.9.7.7.2.1" style="font-size:50%;">3.69</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.10.8.8.3" style="padding-left:4.0pt;padding-right:4.0pt;">46.29 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.10.8.8.3.m1.1"><semantics id="S3.T1.10.8.8.3.m1.1a"><mo id="S3.T1.10.8.8.3.m1.1.1" mathsize="50%" xref="S3.T1.10.8.8.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.10.8.8.3.m1.1b"><csymbol cd="latexml" id="S3.T1.10.8.8.3.m1.1.1.cmml" xref="S3.T1.10.8.8.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.8.8.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.8.8.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.10.8.8.3.1" style="font-size:50%;">3.64</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.11.9.9.4" style="padding-left:4.0pt;padding-right:4.0pt;">40.85 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.11.9.9.4.m1.1"><semantics id="S3.T1.11.9.9.4.m1.1a"><mo id="S3.T1.11.9.9.4.m1.1.1" mathsize="50%" xref="S3.T1.11.9.9.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.11.9.9.4.m1.1b"><csymbol cd="latexml" id="S3.T1.11.9.9.4.m1.1.1.cmml" xref="S3.T1.11.9.9.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.9.9.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.11.9.9.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.11.9.9.4.1" style="font-size:50%;">1.66</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.12.10.10.5" style="padding-left:4.0pt;padding-right:4.0pt;">59.96 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.12.10.10.5.m1.1"><semantics id="S3.T1.12.10.10.5.m1.1a"><mo id="S3.T1.12.10.10.5.m1.1.1" mathsize="50%" xref="S3.T1.12.10.10.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.12.10.10.5.m1.1b"><csymbol cd="latexml" id="S3.T1.12.10.10.5.m1.1.1.cmml" xref="S3.T1.12.10.10.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.10.10.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.10.10.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.12.10.10.5.1" style="font-size:50%;">0.91</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.17.15.15">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.17.15.15.6" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.17.15.15.6.1">TransUNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib3" title="">3</a>]</cite></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.17.15.15.7" style="padding-left:4.0pt;padding-right:4.0pt;">All</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.15.15.8" style="padding-left:4.0pt;padding-right:4.0pt;">✓</td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.T1.17.15.15.9" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.13.11.11.1" style="padding-left:4.0pt;padding-right:4.0pt;">96.32 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.13.11.11.1.m1.1"><semantics id="S3.T1.13.11.11.1.m1.1a"><mo id="S3.T1.13.11.11.1.m1.1.1" mathsize="50%" xref="S3.T1.13.11.11.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.13.11.11.1.m1.1b"><csymbol cd="latexml" id="S3.T1.13.11.11.1.m1.1.1.cmml" xref="S3.T1.13.11.11.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.13.11.11.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.13.11.11.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.13.11.11.1.1" style="font-size:50%;">0.19</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.14.12.12.2" style="padding-left:4.0pt;padding-right:4.0pt;">92.92 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.14.12.12.2.m1.1"><semantics id="S3.T1.14.12.12.2.m1.1a"><mo id="S3.T1.14.12.12.2.m1.1.1" mathsize="50%" xref="S3.T1.14.12.12.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.14.12.12.2.m1.1b"><csymbol cd="latexml" id="S3.T1.14.12.12.2.m1.1.1.cmml" xref="S3.T1.14.12.12.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.14.12.12.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.14.12.12.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.14.12.12.2.1" style="font-size:50%;">0.29</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.15.13.13.3" style="padding-left:4.0pt;padding-right:4.0pt;">85.04 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.15.13.13.3.m1.1"><semantics id="S3.T1.15.13.13.3.m1.1a"><mo id="S3.T1.15.13.13.3.m1.1.1" mathsize="50%" xref="S3.T1.15.13.13.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.15.13.13.3.m1.1b"><csymbol cd="latexml" id="S3.T1.15.13.13.3.m1.1.1.cmml" xref="S3.T1.15.13.13.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.15.13.13.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.15.13.13.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.15.13.13.3.1" style="font-size:50%;">0.15</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.16.14.14.4" style="padding-left:4.0pt;padding-right:4.0pt;">90.79 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.16.14.14.4.m1.1"><semantics id="S3.T1.16.14.14.4.m1.1a"><mo id="S3.T1.16.14.14.4.m1.1.1" mathsize="50%" xref="S3.T1.16.14.14.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.16.14.14.4.m1.1b"><csymbol cd="latexml" id="S3.T1.16.14.14.4.m1.1.1.cmml" xref="S3.T1.16.14.14.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.16.14.14.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.16.14.14.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.16.14.14.4.1" style="font-size:50%;">0.07</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.17.15.15.5" style="padding-left:4.0pt;padding-right:4.0pt;">94.08 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.17.15.15.5.m1.1"><semantics id="S3.T1.17.15.15.5.m1.1a"><mo id="S3.T1.17.15.15.5.m1.1.1" mathsize="50%" xref="S3.T1.17.15.15.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.17.15.15.5.m1.1b"><csymbol cd="latexml" id="S3.T1.17.15.15.5.m1.1.1.cmml" xref="S3.T1.17.15.15.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.17.15.15.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.17.15.15.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.17.15.15.5.1" style="font-size:50%;">0.07</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.22.20.20">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.22.20.20.6" style="padding-left:4.0pt;padding-right:4.0pt;">10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.20.20.7" style="padding-left:4.0pt;padding-right:4.0pt;">✓</td>
<td class="ltx_td ltx_border_r" id="S3.T1.22.20.20.8" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.18.16.16.1" style="padding-left:4.0pt;padding-right:4.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.18.16.16.1.1">92.15</span> <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.18.16.16.1.m1.1"><semantics id="S3.T1.18.16.16.1.m1.1a"><mo id="S3.T1.18.16.16.1.m1.1.1" mathsize="50%" xref="S3.T1.18.16.16.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.18.16.16.1.m1.1b"><csymbol cd="latexml" id="S3.T1.18.16.16.1.m1.1.1.cmml" xref="S3.T1.18.16.16.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.18.16.16.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.18.16.16.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.18.16.16.1.2" style="font-size:50%;">0.40</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.17.17.2" style="padding-left:4.0pt;padding-right:4.0pt;">87.32 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.19.17.17.2.m1.1"><semantics id="S3.T1.19.17.17.2.m1.1a"><mo id="S3.T1.19.17.17.2.m1.1.1" mathsize="50%" xref="S3.T1.19.17.17.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.19.17.17.2.m1.1b"><csymbol cd="latexml" id="S3.T1.19.17.17.2.m1.1.1.cmml" xref="S3.T1.19.17.17.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.19.17.17.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.19.17.17.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.19.17.17.2.1" style="font-size:50%;">0.45</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.20.18.18.3" style="padding-left:4.0pt;padding-right:4.0pt;">66.51 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.20.18.18.3.m1.1"><semantics id="S3.T1.20.18.18.3.m1.1a"><mo id="S3.T1.20.18.18.3.m1.1.1" mathsize="50%" xref="S3.T1.20.18.18.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.20.18.18.3.m1.1b"><csymbol cd="latexml" id="S3.T1.20.18.18.3.m1.1.1.cmml" xref="S3.T1.20.18.18.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.20.18.18.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.20.18.18.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.20.18.18.3.1" style="font-size:50%;">2.28</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.21.19.19.4" style="padding-left:4.0pt;padding-right:4.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.21.19.19.4.1">68.69</span> <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.21.19.19.4.m1.1"><semantics id="S3.T1.21.19.19.4.m1.1a"><mo id="S3.T1.21.19.19.4.m1.1.1" mathsize="50%" xref="S3.T1.21.19.19.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.21.19.19.4.m1.1b"><csymbol cd="latexml" id="S3.T1.21.19.19.4.m1.1.1.cmml" xref="S3.T1.21.19.19.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.21.19.19.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.21.19.19.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.21.19.19.4.2" style="font-size:50%;">0.58</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.22.20.20.5" style="padding-left:4.0pt;padding-right:4.0pt;">78.98 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.22.20.20.5.m1.1"><semantics id="S3.T1.22.20.20.5.m1.1a"><mo id="S3.T1.22.20.20.5.m1.1.1" mathsize="50%" xref="S3.T1.22.20.20.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.22.20.20.5.m1.1b"><csymbol cd="latexml" id="S3.T1.22.20.20.5.m1.1.1.cmml" xref="S3.T1.22.20.20.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.22.20.20.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.22.20.20.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.22.20.20.5.1" style="font-size:50%;">1.36</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.27.25.25">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S3.T1.27.25.25.6" rowspan="5" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.27.25.25.6.1"><span class="ltx_text" id="S3.T1.27.25.25.6.1.1"></span><span class="ltx_text" id="S3.T1.27.25.25.6.1.2">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.27.25.25.6.1.2.1">
<span class="ltx_tr" id="S3.T1.27.25.25.6.1.2.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.27.25.25.6.1.2.1.1.1" style="padding-left:4.0pt;padding-right:4.0pt;">Automatic</span></span>
<span class="ltx_tr" id="S3.T1.27.25.25.6.1.2.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.27.25.25.6.1.2.1.2.1" style="padding-left:4.0pt;padding-right:4.0pt;">(adapted)</span></span>
</span></span> <span class="ltx_text" id="S3.T1.27.25.25.6.1.3"></span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.27.25.25.7" rowspan="2" style="padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.27.25.25.7.1">AutoSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib17" title="">17</a>]</cite></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.27.25.25.8" style="padding-left:4.0pt;padding-right:4.0pt;">All</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.27.25.25.9" style="padding-left:4.0pt;padding-right:4.0pt;">✓</td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.T1.27.25.25.10" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.23.21.21.1" style="padding-left:4.0pt;padding-right:4.0pt;">97.42 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.23.21.21.1.m1.1"><semantics id="S3.T1.23.21.21.1.m1.1a"><mo id="S3.T1.23.21.21.1.m1.1.1" mathsize="50%" xref="S3.T1.23.21.21.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.23.21.21.1.m1.1b"><csymbol cd="latexml" id="S3.T1.23.21.21.1.m1.1.1.cmml" xref="S3.T1.23.21.21.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.23.21.21.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.23.21.21.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.23.21.21.1.1" style="font-size:50%;">0.04</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.24.22.22.2" style="padding-left:4.0pt;padding-right:4.0pt;">93.59 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.24.22.22.2.m1.1"><semantics id="S3.T1.24.22.22.2.m1.1a"><mo id="S3.T1.24.22.22.2.m1.1.1" mathsize="50%" xref="S3.T1.24.22.22.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.24.22.22.2.m1.1b"><csymbol cd="latexml" id="S3.T1.24.22.22.2.m1.1.1.cmml" xref="S3.T1.24.22.22.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.24.22.22.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.24.22.22.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.24.22.22.2.1" style="font-size:50%;">0.03</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.25.23.23.3" style="padding-left:4.0pt;padding-right:4.0pt;">85.60 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.25.23.23.3.m1.1"><semantics id="S3.T1.25.23.23.3.m1.1a"><mo id="S3.T1.25.23.23.3.m1.1.1" mathsize="50%" xref="S3.T1.25.23.23.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.25.23.23.3.m1.1b"><csymbol cd="latexml" id="S3.T1.25.23.23.3.m1.1.1.cmml" xref="S3.T1.25.23.23.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.25.23.23.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.25.23.23.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.25.23.23.3.1" style="font-size:50%;">0.89</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.26.24.24.4" style="padding-left:4.0pt;padding-right:4.0pt;">89.57 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.26.24.24.4.m1.1"><semantics id="S3.T1.26.24.24.4.m1.1a"><mo id="S3.T1.26.24.24.4.m1.1.1" mathsize="50%" xref="S3.T1.26.24.24.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.26.24.24.4.m1.1b"><csymbol cd="latexml" id="S3.T1.26.24.24.4.m1.1.1.cmml" xref="S3.T1.26.24.24.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.26.24.24.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.26.24.24.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.26.24.24.4.1" style="font-size:50%;">0.54</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.27.25.25.5" style="padding-left:4.0pt;padding-right:4.0pt;">95.18 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.27.25.25.5.m1.1"><semantics id="S3.T1.27.25.25.5.m1.1a"><mo id="S3.T1.27.25.25.5.m1.1.1" mathsize="50%" xref="S3.T1.27.25.25.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.27.25.25.5.m1.1b"><csymbol cd="latexml" id="S3.T1.27.25.25.5.m1.1.1.cmml" xref="S3.T1.27.25.25.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.27.25.25.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.27.25.25.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.27.25.25.5.1" style="font-size:50%;">0.11</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.32.30.30">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.32.30.30.6" style="padding-left:4.0pt;padding-right:4.0pt;">10</td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.30.30.7" style="padding-left:4.0pt;padding-right:4.0pt;">✓</td>
<td class="ltx_td ltx_border_r" id="S3.T1.32.30.30.8" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.28.26.26.1" style="padding-left:4.0pt;padding-right:4.0pt;">90.64 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.28.26.26.1.m1.1"><semantics id="S3.T1.28.26.26.1.m1.1a"><mo id="S3.T1.28.26.26.1.m1.1.1" mathsize="50%" xref="S3.T1.28.26.26.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.28.26.26.1.m1.1b"><csymbol cd="latexml" id="S3.T1.28.26.26.1.m1.1.1.cmml" xref="S3.T1.28.26.26.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.28.26.26.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.28.26.26.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.28.26.26.1.1" style="font-size:50%;">1.84</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.29.27.27.2" style="padding-left:4.0pt;padding-right:4.0pt;">86.98 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.29.27.27.2.m1.1"><semantics id="S3.T1.29.27.27.2.m1.1a"><mo id="S3.T1.29.27.27.2.m1.1.1" mathsize="50%" xref="S3.T1.29.27.27.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.29.27.27.2.m1.1b"><csymbol cd="latexml" id="S3.T1.29.27.27.2.m1.1.1.cmml" xref="S3.T1.29.27.27.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.29.27.27.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.29.27.27.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.29.27.27.2.1" style="font-size:50%;">0.67</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.30.28.28.3" style="padding-left:4.0pt;padding-right:4.0pt;">67.09 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.30.28.28.3.m1.1"><semantics id="S3.T1.30.28.28.3.m1.1a"><mo id="S3.T1.30.28.28.3.m1.1.1" mathsize="50%" xref="S3.T1.30.28.28.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.30.28.28.3.m1.1b"><csymbol cd="latexml" id="S3.T1.30.28.28.3.m1.1.1.cmml" xref="S3.T1.30.28.28.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.30.28.28.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.30.28.28.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.30.28.28.3.1" style="font-size:50%;">4.82</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.31.29.29.4" style="padding-left:4.0pt;padding-right:4.0pt;">68.33 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.31.29.29.4.m1.1"><semantics id="S3.T1.31.29.29.4.m1.1a"><mo id="S3.T1.31.29.29.4.m1.1.1" mathsize="50%" xref="S3.T1.31.29.29.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.31.29.29.4.m1.1b"><csymbol cd="latexml" id="S3.T1.31.29.29.4.m1.1.1.cmml" xref="S3.T1.31.29.29.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.31.29.29.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.31.29.29.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.31.29.29.4.1" style="font-size:50%;">3.21</span>
</td>
<td class="ltx_td ltx_align_center" id="S3.T1.32.30.30.5" style="padding-left:4.0pt;padding-right:4.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T1.32.30.30.5.1">84.17</span> <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.32.30.30.5.m1.1"><semantics id="S3.T1.32.30.30.5.m1.1a"><mo id="S3.T1.32.30.30.5.m1.1.1" mathsize="50%" xref="S3.T1.32.30.30.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.32.30.30.5.m1.1b"><csymbol cd="latexml" id="S3.T1.32.30.30.5.m1.1.1.cmml" xref="S3.T1.32.30.30.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.32.30.30.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.32.30.30.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.32.30.30.5.2" style="font-size:50%;">2.05</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.37.35.35">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S3.T1.37.35.35.6" style="padding-left:4.0pt;padding-right:4.0pt;">PerSAM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib22" title="">22</a>]</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.37.35.35.7" style="padding-left:4.0pt;padding-right:4.0pt;">1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.37.35.35.8" style="padding-left:4.0pt;padding-right:4.0pt;">✓</td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.T1.37.35.35.9" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.33.31.31.1" style="padding-left:4.0pt;padding-right:4.0pt;">58.98 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.33.31.31.1.m1.1"><semantics id="S3.T1.33.31.31.1.m1.1a"><mo id="S3.T1.33.31.31.1.m1.1.1" mathsize="50%" xref="S3.T1.33.31.31.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.33.31.31.1.m1.1b"><csymbol cd="latexml" id="S3.T1.33.31.31.1.m1.1.1.cmml" xref="S3.T1.33.31.31.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.33.31.31.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.33.31.31.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.33.31.31.1.1" style="font-size:50%;">0.19</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.34.32.32.2" style="padding-left:4.0pt;padding-right:4.0pt;">36.13 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.34.32.32.2.m1.1"><semantics id="S3.T1.34.32.32.2.m1.1a"><mo id="S3.T1.34.32.32.2.m1.1.1" mathsize="50%" xref="S3.T1.34.32.32.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.34.32.32.2.m1.1b"><csymbol cd="latexml" id="S3.T1.34.32.32.2.m1.1.1.cmml" xref="S3.T1.34.32.32.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.34.32.32.2.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.34.32.32.2.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.34.32.32.2.1" style="font-size:50%;">0.00</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.35.33.33.3" style="padding-left:4.0pt;padding-right:4.0pt;">14.19 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.35.33.33.3.m1.1"><semantics id="S3.T1.35.33.33.3.m1.1a"><mo id="S3.T1.35.33.33.3.m1.1.1" mathsize="50%" xref="S3.T1.35.33.33.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.35.33.33.3.m1.1b"><csymbol cd="latexml" id="S3.T1.35.33.33.3.m1.1.1.cmml" xref="S3.T1.35.33.33.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.35.33.33.3.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.35.33.33.3.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.35.33.33.3.1" style="font-size:50%;">0.02</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.36.34.34.4" style="padding-left:4.0pt;padding-right:4.0pt;">27.64 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.36.34.34.4.m1.1"><semantics id="S3.T1.36.34.34.4.m1.1a"><mo id="S3.T1.36.34.34.4.m1.1.1" mathsize="50%" xref="S3.T1.36.34.34.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.36.34.34.4.m1.1b"><csymbol cd="latexml" id="S3.T1.36.34.34.4.m1.1.1.cmml" xref="S3.T1.36.34.34.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.36.34.34.4.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.36.34.34.4.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.36.34.34.4.1" style="font-size:50%;">9.48</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.37.35.35.5" style="padding-left:4.0pt;padding-right:4.0pt;">45.43 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.37.35.35.5.m1.1"><semantics id="S3.T1.37.35.35.5.m1.1a"><mo id="S3.T1.37.35.35.5.m1.1.1" mathsize="50%" xref="S3.T1.37.35.35.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.37.35.35.5.m1.1b"><csymbol cd="latexml" id="S3.T1.37.35.35.5.m1.1.1.cmml" xref="S3.T1.37.35.35.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.37.35.35.5.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.37.35.35.5.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.37.35.35.5.1" style="font-size:50%;">5.47</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T1.42.40.40">
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.T1.42.40.40.6" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.42.40.40.7" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.42.40.40.7.1" style="background-color:#ECECEC;">All</span></td>
<td class="ltx_td ltx_border_t" id="S3.T1.42.40.40.8" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.42.40.40.9" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.42.40.40.9.1" style="background-color:#ECECEC;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.38.36.36.1" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.38.36.36.1.1" style="background-color:#ECECEC;">92.88 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.38.36.36.1.1.m1.1"><semantics id="S3.T1.38.36.36.1.1.m1.1a"><mo id="S3.T1.38.36.36.1.1.m1.1.1" mathbackground="#ECECEC" mathsize="50%" xref="S3.T1.38.36.36.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.38.36.36.1.1.m1.1b"><csymbol cd="latexml" id="S3.T1.38.36.36.1.1.m1.1.1.cmml" xref="S3.T1.38.36.36.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.38.36.36.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.38.36.36.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.38.36.36.1.1.1" style="font-size:50%;">1.27</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.39.37.37.2" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.39.37.37.2.1" style="background-color:#ECECEC;">88.86 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.39.37.37.2.1.m1.1"><semantics id="S3.T1.39.37.37.2.1.m1.1a"><mo id="S3.T1.39.37.37.2.1.m1.1.1" mathbackground="#ECECEC" mathsize="50%" xref="S3.T1.39.37.37.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.39.37.37.2.1.m1.1b"><csymbol cd="latexml" id="S3.T1.39.37.37.2.1.m1.1.1.cmml" xref="S3.T1.39.37.37.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.39.37.37.2.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.39.37.37.2.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.39.37.37.2.1.1" style="font-size:50%;">1.42</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.40.38.38.3" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.40.38.38.3.1" style="background-color:#ECECEC;">79.82 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.40.38.38.3.1.m1.1"><semantics id="S3.T1.40.38.38.3.1.m1.1a"><mo id="S3.T1.40.38.38.3.1.m1.1.1" mathbackground="#ECECEC" mathsize="50%" xref="S3.T1.40.38.38.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.40.38.38.3.1.m1.1b"><csymbol cd="latexml" id="S3.T1.40.38.38.3.1.m1.1.1.cmml" xref="S3.T1.40.38.38.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.40.38.38.3.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.40.38.38.3.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.40.38.38.3.1.1" style="font-size:50%;">0.74</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.41.39.39.4" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.41.39.39.4.1" style="background-color:#ECECEC;">76.97 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.41.39.39.4.1.m1.1"><semantics id="S3.T1.41.39.39.4.1.m1.1a"><mo id="S3.T1.41.39.39.4.1.m1.1.1" mathbackground="#ECECEC" mathsize="50%" xref="S3.T1.41.39.39.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.41.39.39.4.1.m1.1b"><csymbol cd="latexml" id="S3.T1.41.39.39.4.1.m1.1.1.cmml" xref="S3.T1.41.39.39.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.41.39.39.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.41.39.39.4.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.41.39.39.4.1.1" style="font-size:50%;">1.02</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.42.40.40.5" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.42.40.40.5.1" style="background-color:#ECECEC;">86.91 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.42.40.40.5.1.m1.1"><semantics id="S3.T1.42.40.40.5.1.m1.1a"><mo id="S3.T1.42.40.40.5.1.m1.1.1" mathbackground="#ECECEC" mathsize="50%" xref="S3.T1.42.40.40.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.42.40.40.5.1.m1.1b"><csymbol cd="latexml" id="S3.T1.42.40.40.5.1.m1.1.1.cmml" xref="S3.T1.42.40.40.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.42.40.40.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.42.40.40.5.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.42.40.40.5.1.1" style="font-size:50%;">2.08</span></span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.47.45.45">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S3.T1.47.45.45.6" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.47.45.45.6.1" style="background-color:#ECECEC;">Ours</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.47.45.45.7" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.47.45.45.7.1" style="background-color:#ECECEC;">10</span></td>
<td class="ltx_td ltx_border_bb" id="S3.T1.47.45.45.8" style="padding-left:4.0pt;padding-right:4.0pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.47.45.45.9" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.47.45.45.9.1" style="background-color:#ECECEC;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.43.41.41.1" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.43.41.41.1.1" style="background-color:#ECECEC;">85.23 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.43.41.41.1.1.m1.1"><semantics id="S3.T1.43.41.41.1.1.m1.1a"><mo id="S3.T1.43.41.41.1.1.m1.1.1" mathbackground="#ECECEC" mathsize="50%" xref="S3.T1.43.41.41.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.43.41.41.1.1.m1.1b"><csymbol cd="latexml" id="S3.T1.43.41.41.1.1.m1.1.1.cmml" xref="S3.T1.43.41.41.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.43.41.41.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.43.41.41.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.43.41.41.1.1.1" style="font-size:50%;">0.55</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.44.42.42.2" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.44.42.42.2.1" style="background-color:#ECECEC;">88.38<span class="ltx_text ltx_font_medium" id="S3.T1.44.42.42.2.1.1" style="background-color:#ECECEC;"> <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.44.42.42.2.1.1.m1.1"><semantics id="S3.T1.44.42.42.2.1.1.m1.1a"><mo id="S3.T1.44.42.42.2.1.1.m1.1.1" mathbackground="#ECECEC" mathsize="50%" xref="S3.T1.44.42.42.2.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.44.42.42.2.1.1.m1.1b"><csymbol cd="latexml" id="S3.T1.44.42.42.2.1.1.m1.1.1.cmml" xref="S3.T1.44.42.42.2.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.44.42.42.2.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.44.42.42.2.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.44.42.42.2.1.1.1" style="font-size:50%;">0.83</span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.45.43.43.3" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T1.45.43.43.3.1" style="background-color:#ECECEC;">73.56<span class="ltx_text ltx_font_medium" id="S3.T1.45.43.43.3.1.1" style="background-color:#ECECEC;"> <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.45.43.43.3.1.1.m1.1"><semantics id="S3.T1.45.43.43.3.1.1.m1.1a"><mo id="S3.T1.45.43.43.3.1.1.m1.1.1" mathbackground="#ECECEC" mathsize="50%" xref="S3.T1.45.43.43.3.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.45.43.43.3.1.1.m1.1b"><csymbol cd="latexml" id="S3.T1.45.43.43.3.1.1.m1.1.1.cmml" xref="S3.T1.45.43.43.3.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.45.43.43.3.1.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.45.43.43.3.1.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.45.43.43.3.1.1.1" style="font-size:50%;">0.57</span></span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.46.44.44.4" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.46.44.44.4.1" style="background-color:#ECECEC;">58.96 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.46.44.44.4.1.m1.1"><semantics id="S3.T1.46.44.44.4.1.m1.1a"><mo id="S3.T1.46.44.44.4.1.m1.1.1" mathbackground="#ECECEC" mathsize="50%" xref="S3.T1.46.44.44.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.46.44.44.4.1.m1.1b"><csymbol cd="latexml" id="S3.T1.46.44.44.4.1.m1.1.1.cmml" xref="S3.T1.46.44.44.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.46.44.44.4.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.46.44.44.4.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.46.44.44.4.1.1" style="font-size:50%;">2.28</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.47.45.45.5" style="background-color:#ECECEC;padding-left:4.0pt;padding-right:4.0pt;"><span class="ltx_text" id="S3.T1.47.45.45.5.1" style="background-color:#ECECEC;">80.37 <math alttext="\pm" class="ltx_Math" display="inline" id="S3.T1.47.45.45.5.1.m1.1"><semantics id="S3.T1.47.45.45.5.1.m1.1a"><mo id="S3.T1.47.45.45.5.1.m1.1.1" mathbackground="#ECECEC" mathsize="50%" xref="S3.T1.47.45.45.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S3.T1.47.45.45.5.1.m1.1b"><csymbol cd="latexml" id="S3.T1.47.45.45.5.1.m1.1.1.cmml" xref="S3.T1.47.45.45.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.47.45.45.5.1.m1.1c">\pm</annotation><annotation encoding="application/x-llamapun" id="S3.T1.47.45.45.5.1.m1.1d">±</annotation></semantics></math><span class="ltx_text" id="S3.T1.47.45.45.5.1.1" style="font-size:50%;">1.59</span></span></td>
</tr>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S3.F2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.F2.12">
<tr class="ltx_tr" id="S3.F2.6.6">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.1.1.1" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="97" id="S3.F2.1.1.1.g1" src="extracted/5890050/figures/HC18_test_vol243-200_MedSAM_DSC91-12.png" width="96"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.2.2.2" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.2.2.2.g1" src="extracted/5890050/figures/niigz_HC18_test__vol243-200_UNet_10_207_seed0_DSC77-39.png" width="96"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.3.3.3" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.3.3.3.g1" src="extracted/5890050/figures/niigz_HC18_test__vol243-200_TransUNet_10_207_seed0_DSC92-11.png" width="96"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.4.4.4" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.4.4.4.g1" src="extracted/5890050/figures/niigz_HC18_test__vol243-200_AutoSAM_10_207_seed0_DSC91-89.png" width="96"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.5.5.5" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.5.5.5.g1" src="extracted/5890050/figures/niigz_HC18_test__vol243-200_PerSAM_1_seed0_ref_555_HC_DSC55-79.png" width="96"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.6.6.6" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.6.6.6.g1" src="extracted/5890050/figures/niigz_HC18_test__vol243-200_Ours_10_207_seed0_DSC89-12.png" width="96"/></td>
<td class="ltx_td" id="S3.F2.6.6.7" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.F2.12.12">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.7.7.1" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.7.7.1.g1" src="extracted/5890050/figures/niigz_ACDC1_test__volpatient129_frame01_slice10_MedSAM_seed0_DSC95-43.png" width="96"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.8.8.2" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.8.8.2.g1" src="extracted/5890050/figures/niigz_ACDC1_test__volpatient129_frame01_slice10_UNet_10_287_seed0_DSC66-71.png" width="96"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.9.9.3" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.9.9.3.g1" src="extracted/5890050/figures/niigz_ACDC1_test__volpatient129_frame01_slice10_TransUNet_10_287_seed0_DSC85-44.png" width="96"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.10.10.4" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.10.10.4.g1" src="extracted/5890050/figures/niigz_ACDC1_test__volpatient129_frame01_slice10_AutoSAM_10_287_seed0_DSC83-70.png" width="96"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.11.11.5" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.11.11.5.g1" src="extracted/5890050/figures/niigz_ACDC1_test__volpatient129_frame01_slice10_PerSAM_1_seed0_ref_patient067_frame01_slice1_DSC0.png" width="96"/></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.12.6" style="padding-left:1.0pt;padding-right:1.0pt;"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="96" id="S3.F2.12.12.6.g1" src="extracted/5890050/figures/niigz_ACDC1_test__volpatient129_frame01_slice10_Ours_10_287_seed0_DSC92-60.png" width="96"/></td>
<td class="ltx_td" id="S3.F2.12.12.7" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
</tr>
<tr class="ltx_tr" id="S3.F2.12.13">
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.1" style="padding-left:1.0pt;padding-right:1.0pt;">
<span class="ltx_text" id="S3.F2.12.13.1.1"></span> <span class="ltx_text" id="S3.F2.12.13.1.2">
<span class="ltx_tabular ltx_align_middle" id="S3.F2.12.13.1.2.1">
<span class="ltx_tr" id="S3.F2.12.13.1.2.1.1">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.1.2.1.1.1" style="padding-left:1.0pt;padding-right:1.0pt;">(a) MedSAM</span></span>
<span class="ltx_tr" id="S3.F2.12.13.1.2.1.2">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.1.2.1.2.1" style="padding-left:1.0pt;padding-right:1.0pt;">(Prompted)</span></span>
</span></span><span class="ltx_text" id="S3.F2.12.13.1.3"></span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.2" style="padding-left:1.0pt;padding-right:1.0pt;">
<span class="ltx_text" id="S3.F2.12.13.2.1"></span> <span class="ltx_text" id="S3.F2.12.13.2.2">
<span class="ltx_tabular ltx_align_middle" id="S3.F2.12.13.2.2.1">
<span class="ltx_tr" id="S3.F2.12.13.2.2.1.1">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.2.2.1.1.1" style="padding-left:1.0pt;padding-right:1.0pt;">(b) UNet</span></span>
<span class="ltx_tr" id="S3.F2.12.13.2.2.1.2">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.2.2.1.2.1" style="padding-left:1.0pt;padding-right:1.0pt;">(10 masks)</span></span>
</span></span><span class="ltx_text" id="S3.F2.12.13.2.3"></span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.3" style="padding-left:1.0pt;padding-right:1.0pt;">
<span class="ltx_text" id="S3.F2.12.13.3.1"></span> <span class="ltx_text" id="S3.F2.12.13.3.2">
<span class="ltx_tabular ltx_align_middle" id="S3.F2.12.13.3.2.1">
<span class="ltx_tr" id="S3.F2.12.13.3.2.1.1">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.3.2.1.1.1" style="padding-left:1.0pt;padding-right:1.0pt;">(c) TransUNet</span></span>
<span class="ltx_tr" id="S3.F2.12.13.3.2.1.2">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.3.2.1.2.1" style="padding-left:1.0pt;padding-right:1.0pt;">(10 masks)</span></span>
</span></span><span class="ltx_text" id="S3.F2.12.13.3.3"></span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.4" style="padding-left:1.0pt;padding-right:1.0pt;">
<span class="ltx_text" id="S3.F2.12.13.4.1"></span> <span class="ltx_text" id="S3.F2.12.13.4.2">
<span class="ltx_tabular ltx_align_middle" id="S3.F2.12.13.4.2.1">
<span class="ltx_tr" id="S3.F2.12.13.4.2.1.1">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.4.2.1.1.1" style="padding-left:1.0pt;padding-right:1.0pt;">(d) AutoSAM</span></span>
<span class="ltx_tr" id="S3.F2.12.13.4.2.1.2">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.4.2.1.2.1" style="padding-left:1.0pt;padding-right:1.0pt;">(10 masks)</span></span>
</span></span><span class="ltx_text" id="S3.F2.12.13.4.3"></span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.5" style="padding-left:1.0pt;padding-right:1.0pt;">
<span class="ltx_text" id="S3.F2.12.13.5.1"></span> <span class="ltx_text" id="S3.F2.12.13.5.2">
<span class="ltx_tabular ltx_align_middle" id="S3.F2.12.13.5.2.1">
<span class="ltx_tr" id="S3.F2.12.13.5.2.1.1">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.5.2.1.1.1" style="padding-left:1.0pt;padding-right:1.0pt;">(e) PerSAM</span></span>
<span class="ltx_tr" id="S3.F2.12.13.5.2.1.2">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.5.2.1.2.1" style="padding-left:1.0pt;padding-right:1.0pt;">(1 mask)</span></span>
</span></span><span class="ltx_text" id="S3.F2.12.13.5.3"></span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.6" style="padding-left:1.0pt;padding-right:1.0pt;">
<span class="ltx_text" id="S3.F2.12.13.6.1"></span> <span class="ltx_text" id="S3.F2.12.13.6.2">
<span class="ltx_tabular ltx_align_middle" id="S3.F2.12.13.6.2.1">
<span class="ltx_tr" id="S3.F2.12.13.6.2.1.1">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.6.2.1.1.1" style="padding-left:1.0pt;padding-right:1.0pt;">(f) Ours</span></span>
<span class="ltx_tr" id="S3.F2.12.13.6.2.1.2">
<span class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" id="S3.F2.12.13.6.2.1.2.1" style="padding-left:1.0pt;padding-right:1.0pt;">(10 BB)</span></span>
</span></span><span class="ltx_text" id="S3.F2.12.13.6.3"></span></td>
<td class="ltx_td ltx_nopad_l ltx_nopad_r" id="S3.F2.12.13.7" style="padding-left:1.0pt;padding-right:1.0pt;"></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.14.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S3.F2.15.2" style="font-size:90%;">Predicted segmentations on test samples of HC18 (row 1) and the right ventricle in ACDC (row 2). From left to right, (a) MedSAM prompted with a tight box, (b-d) UNet, TransUNet and AutoSAM, trained with ground-truth masks, (e) PerSAM using one reference image with its ground-truth mask, and (f) our method trained on tight bounding boxes. All automatic methods are given for the 10-shot setting, except PerSAM, a 1-shot approach. Ground-truth annotation is drawn in red, with predicted segmentation mask overlayed in yellow. </span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The Dice similarity score (DSC) is used as our evaluation criteria. We evaluate our approach on three datasets: CAMUS, an internal validation set of MedSAM, and HC18 and ACDC, two datasets never seen by MedSAM during training. This allows us to verify the ability of the prompt module to effectively learn which region to segment in both in-domain and out-of-domain data. Training is performed on both the entire training set and the difficult 10-shot regime.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.3">Our results are given in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S3.T1" title="Table 1 ‣ 3.3 Validation on multiple medical segmentation tasks ‣ 3 Results ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">1</span></a> and Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S3.F2" title="Figure 2 ‣ 3.3 Validation on multiple medical segmentation tasks ‣ 3 Results ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">2</span></a>. First, with only tight bounding box (BB) annotations, our approach trained on all samples is able to outperform a UNet trained on ground-truth segmentation masks for 2 different tasks (HC and LA).
The most significant results are observed in the 10-shot setting. With only <math alttext="1.3\%" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mn id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">1.3</mn><mo id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="latexml" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1">percent</csymbol><cn id="S3.SS3.p2.1.m1.1.1.2.cmml" type="float" xref="S3.SS3.p2.1.m1.1.1.2">1.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">1.3\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">1.3 %</annotation></semantics></math> (ACDC), <math alttext="2\%" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mn id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">2</mn><mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="latexml" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1">percent</csymbol><cn id="S3.SS3.p2.2.m2.1.1.2.cmml" type="integer" xref="S3.SS3.p2.2.m2.1.1.2">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">2\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">2 %</annotation></semantics></math> (HC18) and <math alttext="2.9\%" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mn id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">2.9</mn><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="latexml" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1">percent</csymbol><cn id="S3.SS3.p2.3.m3.1.1.2.cmml" type="float" xref="S3.SS3.p2.3.m3.1.1.2">2.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">2.9\%</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">2.9 %</annotation></semantics></math> (CAMUS) of the total training samples, our approach sees only a slight decrease in performance (except for RV segmentation) compared to the full-data setting. This contrasts with the considerable performance drop observed with UNet and TransUNet in multiple segmentation tasks, even when both methods are trained with ground-truth mask labels. Therefore, our prompt module-based approach is not only more computationally efficient to train than specialized models, but it also requires only weak labels and appears more robust in the few-shot setting.
AutoSAM displays slightly better test dice scores than our approach, but AutoSAM requires full ground-truth masks and uses a much heavier model to learn the prompt, yielding a 3-fold increase in the training time.
Additionally, PerSAM, which uses only one reference image, fails to generate convincing segmentations. Its poor performance on medical datasets may be due to the fact that PerSAM generates point prompts used by SAM, which are more likely to introduce ambiguity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#bib.bib12" title="">12</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">The benefits of our proposed methods are visually supported by Fig.<a class="ltx_ref" href="https://arxiv.org/html/2409.20293v1#S3.F2" title="Figure 2 ‣ 3.3 Validation on multiple medical segmentation tasks ‣ 3 Results ‣ Automating MedSAM by Learning Prompts with Weak Few-Shot Supervision"><span class="ltx_text ltx_ref_tag">2</span></a>. Our module trained on 10 training samples and tight bounding boxes yields segmentations much more convincing than those produced by a UNet trained on ground-truth masks. Given little training data, the UNet hallucinates large regions in the background. Our approach is also able to generate segmentation masks more faithful to the ground-truth than AutoSAM and PerSAM, two existing prompt-based adaptation methods for SAM.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">This work proposes to automate a prompt-based universal model, such as MedSAM, by generating task-specific prompt embeddings directly from the image embedding of the foundation model. Our add-on module that can be integrated directly into MedSAM removes its dependence on user inputs. More importantly, by applying tightness and size constraints, our module can be trained effectively with only bounding box annotations while keeping MedSAM frozen. Furthermore, our 10-shot experiments has demonstrated that the number of samples required to train the model could be considerably reduced without a substantial degradation of the model performance. By adding a lightweight prompt module that can be trained with only few weak labels, MedSAM can efficiently be automated for specific tasks with minimal annotation hurdles.</p>
</div>
<div class="ltx_para" id="S4.p2">
<span class="ltx_ERROR undefined" id="S4.p2.1">{credits}</span>
</div>
<section class="ltx_subsubsection" id="S4.SS0.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.0.1 </span><span class="ltx_ERROR undefined" id="S4.SS0.SSS1.1.1">\discintname</span>
</h4>
<div class="ltx_para" id="S4.SS0.SSS1.p1">
<p class="ltx_p" id="S4.SS0.SSS1.p1.1">This work is supported by the Canada Research Chair on Shape Analysis in Medical Imaging, the Research Council of Canada (NSERC) and the Fonds de Recherche du Québec – Nature et Technologies (FRQNT).</p>
</div>
</section>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Bernard, O., Lalande, A., Zotti, C., Cervenansky, F., Yang, X., Heng, P.A., Cetin, I., Lekadir, K., Camara, O., Ballester, M.A.G., Sanroma, G., Napel, S., Petersen, S., Tziritas, G., Grinias, E., Khened, M., Kollerathu, V.A., Krishnamurthi, G., Rohé, M.M., Pennec, X., Sermesant, M., Isensee, F., Jäger, P., Maier-Hein, K.H., Full, P.M., Wolf, I., Engelhardt, S., Baumgartner, C.F., Koch, L.M., Wolterink, J.M., Išgum, I., Jang, Y., Hong, Y., Patravali, J., Jain, S., Humbert, O., Jodoin, P.M.: Deep Learning Techniques for Automatic MRI Cardiac Multi-Structures Segmentation and Diagnosis: Is the Problem Solved? IEEE Transactions on Medical Imaging <span class="ltx_text ltx_font_bold" id="bib.bib1.1.1">37</span>(11), 2514–2525 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Brown, T., Mann, B., Ryder, N., Subbiah, M., Kaplan, J.D., Dhariwal, P., Neelakantan, A., Shyam, P., Sastry, G., Askell, A., Agarwal, S., Herbert-Voss, A., Krueger, G., Henighan, T., Child, R., Ramesh, A., Ziegler, D., Wu, J., Winter, C., Hesse, C., Chen, M., Sigler, E., Litwin, M., Gray, S., Chess, B., Clark, J., Berner, C., McCandlish, S., Radford, A., Sutskever, I., Amodei, D.: Language Models are Few-Shot Learners. In: Advances in Neural Information Processing Systems (NeurIPS). vol. 33, pp. 1877–1901 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Chen, J., Lu, Y., Yu, Q., Luo, X., Adeli, E., Wang, Y., Lu, L., Yuille, A.L., Zhou, Y.: TransUNet: Transformers Make Strong Encoders for Medical Image Segmentation (2021), <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/2102.04306" title="">http://arxiv.org/abs/2102.04306</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Cheng, J., Ye, J., Deng, Z., Chen, J., Li, T., Wang, H., Su, Y., Huang, Z., Chen, J., Jiang, L., Sun, H., He, J., Zhang, S., Zhu, M., Qiao, Y.: SAM-Med2D (2023), <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://arxiv.org/abs/2308.16184" title="">http://arxiv.org/abs/2308.16184</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Beyer, L., Kolesnikov, A., Weissenborn, D., Zhai, X., Unterthiner, T., Dehghani, M., Minderer, M., Heigold, G., Gelly, S., Uszkoreit, J., Houlsby, N.: An Image is Worth 16x16 Words: Transformers for Image Recognition at Scale. In: International Conference on Learning Representations (ICLR) (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Heuvel, T.L.A.v.d., Bruijn, D.d., Korte, C.L.d., Ginneken, B.v.: Automated measurement of fetal head circumference using 2D ultrasound images. Plos One <span class="ltx_text ltx_font_bold" id="bib.bib6.1.1">13</span>(8), e0200412 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Huang, Y., Yang, X., Liu, L., Zhou, H., Chang, A., Zhou, X., Chen, R., Yu, J., Chen, J., Chen, C., Liu, S., Chi, H., Hu, X., Yue, K., Li, L., Grau, V., Fan, D.P., Dong, F., Ni, D.: Segment anything model for medical images? Medical Image Analysis <span class="ltx_text ltx_font_bold" id="bib.bib7.1.1">92</span>, 103061 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Jia, M., Tang, L., Chen, B.C., Cardie, C., Belongie, S., Hariharan, B., Lim, S.N.: Visual Prompt Tuning. In: European Conference on Computer Vision (ECCV). vol. 13693, pp. 709–727 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Kervadec, H., Dolz, J., Wang, S., Granger, E., Ayed, I.B.: Bounding boxes for weakly supervised segmentation: Global constraints get close to full supervision. In: Conference on Medical Imaging with Deep Learning (MIDL). pp. 365–381 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Kirillov, A., Mintun, E., Ravi, N., Mao, H., Rolland, C., Gustafson, L., Xiao, T., Whitehead, S., Berg, A.C., Lo, W.Y., Dollár, P., Girshick, R.: Segment Anything. In: International Conference on Computer Vision (ICCV). pp. 3992–4003 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Leclerc, S., Smistad, E., Pedrosa, J., Østvik, A., Cervenansky, F., Espinosa, F., Espeland, T., Berg, E.A.R., Jodoin, P.M., Grenier, T., Lartizien, C., D’hooge, J., Lovstakken, L., Bernard, O.: Deep Learning for Segmentation Using an Open Large-Scale Dataset in 2D Echocardiography. IEEE Transactions on Medical Imaging <span class="ltx_text ltx_font_bold" id="bib.bib11.1.1">38</span>(9), 2198–2210 (2019)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Ma, J., He, Y., Li, F., Han, L., You, C., Wang, B.: Segment anything in medical images. Nature Communications <span class="ltx_text ltx_font_bold" id="bib.bib12.1.1">15</span>(1),  654 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Mazurowski, M.A., Dong, H., Gu, H., Yang, J., Konz, N., Zhang, Y.: Segment anything model for medical image analysis: An experimental study. Medical Image Analysis <span class="ltx_text ltx_font_bold" id="bib.bib13.1.1">89</span>, 102918 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Rajchl, M., Lee, M.C.H., Oktay, O., Kamnitsas, K., Passerat-Palmbach, J., Bai, W., Damodaram, M., Rutherford, M.A., Hajnal, J.V., Kainz, B., Rueckert, D.: DeepCut: Object Segmentation From Bounding Box Annotations Using Convolutional Neural Networks. IEEE Transactions on Medical Imaging <span class="ltx_text ltx_font_bold" id="bib.bib14.1.1">36</span>(2), 674–683 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Ronneberger, O., Fischer, P., Brox, T.: U-Net: Convolutional Networks for Biomedical Image Segmentation. In: Medical Image Computing and Computer-Assisted Intervention (MICCAI). pp. 234–241 (2015)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Rother, C., Kolmogorov, V., Blake, A.: "GrabCut": interactive foreground extraction using iterated graph cuts. ACM Trans. Graph. <span class="ltx_text ltx_font_bold" id="bib.bib16.1.1">23</span>(3), 309–314 (2004)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Shaharabany, T.: AutoSAM: Adapting SAM to Medical Images by Overloading the Prompt Encoder. In: 34th British Machine Vision Conference (BMVC) (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Wald, T., Roy, S., Koehler, G., Disch, N., Rokuss, M.R., Holzschuh, J., Zimmerer, D., Maier-Hein, K.: SAM.MD: Zero-shot medical image segmentation capabilities of the Segment Anything Model. In: Medical Imaging with Deep Learning (MIDL), short paper track (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Wang, J., Xia, B.: Bounding Box Tightness Prior for Weakly Supervised Image Segmentation. In: Medical Image Computing and Computer Assisted Intervention (MICCAI). pp. 526–536 (2021)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Wu, Q., Zhang, Y., Elbatel, M.: Self-prompting Large Vision Models for Few-Shot Medical Image Segmentation. In: Domain Adaptation and Representation Transfer (MICCAI-DART) (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Zhang, L., Deng, X., Lu, Y.: Segment Anything Model (SAM) for Medical Image Segmentation: A Preliminary Review. In: IEEE International Conference on Bioinformatics and Biomedicine (BIBM). pp. 4187–4194 (2023)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Zhang, R., Jiang, Z., Guo, Z., Yan, S., Pan, J., Ma, X., Dong, H., Gao, P., Li, H.: Personalize Segment Anything Model with One Shot. In: International Conference on Learning Representations (ICLR) (2024)

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep 30 13:47:59 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
