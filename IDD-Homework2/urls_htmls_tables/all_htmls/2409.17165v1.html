<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Mamba for Scalable and Efficient Personalized Recommendations</title>
<!--Generated on Wed Sep 11 14:24:39 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
Personalized Recommendation Systems, 
Feature Tokenization, 
Mamba, 
Transformer, 
Two-Tower Models
" lang="en" name="keywords"/>
<base href="/html/2409.17165v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S1" title="In Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S2" title="In Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Methodology</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S2.SS1" title="In II Methodology ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-A</span> </span><span class="ltx_text ltx_font_italic">Background on Mamba</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S2.SS2" title="In II Methodology ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-B</span> </span><span class="ltx_text ltx_font_italic">Tokenizer and FT-Mamba</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S2.SS3" title="In II Methodology ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-C</span> </span><span class="ltx_text ltx_font_italic">Two-Tower Models</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3" title="In Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Experiments</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.SS1" title="In III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Spotify Music Recommendation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.SS2" title="In III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">H&amp;M Fashion Recommendation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.SS3" title="In III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">Vaccine Messaging Recommendation</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S4" title="In Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">Related Works</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S5" title="In Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">Conclusion</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Mamba for Scalable and Efficient Personalized Recommendations</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Andrew Starnes
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Lirio AI Research 
<br class="ltx_break"/>Lirio, Inc.
<br class="ltx_break"/>Knoxville, TN, USA 
<br class="ltx_break"/>astarnes@lirio.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Clayton Webster
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Lirio AI Research 
<br class="ltx_break"/>Lirio, Inc.
<br class="ltx_break"/>Knoxville, TN, USA 
<br class="ltx_break"/>cwebster@lirio.com
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.1">In this effort, we propose using the Mamba for handling tabular data in personalized recommendation systems.
We present the <span class="ltx_text ltx_font_italic" id="id1.1.1">FT-Mamba</span> (Feature Tokenizer <math alttext="+" class="ltx_Math" display="inline" id="id1.1.m1.1"><semantics id="id1.1.m1.1a"><mo id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="id1.1.m1.1b"><plus id="id1.1.m1.1.1.cmml" xref="id1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="id1.1.m1.1c">+</annotation><annotation encoding="application/x-llamapun" id="id1.1.m1.1d">+</annotation></semantics></math> Mamba), a novel hybrid model that replaces Transformer layers with Mamba layers within the FT-Transformer architecture, for handling tabular data in personalized recommendation systems. The <span class="ltx_text ltx_font_italic" id="id1.1.2">Mamba model</span> offers an efficient alternative to Transformers, reducing computational complexity from quadratic to linear by enhancing the capabilities of State Space Models (SSMs). FT-Mamba is designed to improve the scalability and efficiency of recommendation systems while maintaining performance.
We evaluate FT-Mamba in comparison to a traditional Transformer-based model within a Two-Tower architecture on three datasets: Spotify music recommendation, H&amp;M fashion recommendation, and vaccine messaging recommendation. Each model is trained on 160,000 user-action pairs, and performance is measured using precision (P), recall (R), Mean Reciprocal Rank (MRR), and Hit Ratio (HR) at several truncation values. Our results demonstrate that FT-Mamba outperforms the Transformer-based model in terms of computational efficiency while maintaining or exceeding performance across key recommendation metrics.
By leveraging Mamba layers, FT-Mamba provides a scalable and effective solution for large-scale personalized recommendation systems, showcasing the potential of the Mamba architecture to enhance both efficiency and accuracy.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Personalized Recommendation Systems,
Feature Tokenization,
Mamba,
Transformer,
Two-Tower Models

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Personalized recommendation systems have revolutionized industries by delivering tailored content and product suggestions based on user preferences and behaviors. However, efficiently processing large-scale data poses significant challenges. Transformers, which have gained popularity for sequential data tasks such as natural language processing (NLP) and computer vision, excel at capturing long-range dependencies between inputs. Yet, they come with a notable drawback—their quadratic complexity with respect to sequence length, which limits scalability for larger datasets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib2" title="">2</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.3">The <span class="ltx_text ltx_font_italic" id="S1.p2.3.1">Mamba model</span> was introduced to address these scalability concerns by reducing the computational complexity to that of State Space Models (SSMs) such as the Structured State Space Sequence Model (S4) while maintaining the performance benefits of Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib14" title="">14</a>]</cite>. The Mamba architecture processes sequential data similarly to Transformers but with several innovations that allow it to achieve linear complexity <math alttext="\mathcal{O}(L)" class="ltx_Math" display="inline" id="S1.p2.1.m1.1"><semantics id="S1.p2.1.m1.1a"><mrow id="S1.p2.1.m1.1.2" xref="S1.p2.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p2.1.m1.1.2.2" xref="S1.p2.1.m1.1.2.2.cmml">𝒪</mi><mo id="S1.p2.1.m1.1.2.1" xref="S1.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S1.p2.1.m1.1.2.3.2" xref="S1.p2.1.m1.1.2.cmml"><mo id="S1.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S1.p2.1.m1.1.2.cmml">(</mo><mi id="S1.p2.1.m1.1.1" xref="S1.p2.1.m1.1.1.cmml">L</mi><mo id="S1.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.1.m1.1b"><apply id="S1.p2.1.m1.1.2.cmml" xref="S1.p2.1.m1.1.2"><times id="S1.p2.1.m1.1.2.1.cmml" xref="S1.p2.1.m1.1.2.1"></times><ci id="S1.p2.1.m1.1.2.2.cmml" xref="S1.p2.1.m1.1.2.2">𝒪</ci><ci id="S1.p2.1.m1.1.1.cmml" xref="S1.p2.1.m1.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.1.m1.1c">\mathcal{O}(L)</annotation><annotation encoding="application/x-llamapun" id="S1.p2.1.m1.1d">caligraphic_O ( italic_L )</annotation></semantics></math> for a sequence length of <math alttext="L" class="ltx_Math" display="inline" id="S1.p2.2.m2.1"><semantics id="S1.p2.2.m2.1a"><mi id="S1.p2.2.m2.1.1" xref="S1.p2.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S1.p2.2.m2.1b"><ci id="S1.p2.2.m2.1.1.cmml" xref="S1.p2.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S1.p2.2.m2.1d">italic_L</annotation></semantics></math>, as opposed to the quadratic complexity <math alttext="\mathcal{O}(L^{2})" class="ltx_Math" display="inline" id="S1.p2.3.m3.1"><semantics id="S1.p2.3.m3.1a"><mrow id="S1.p2.3.m3.1.1" xref="S1.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S1.p2.3.m3.1.1.3" xref="S1.p2.3.m3.1.1.3.cmml">𝒪</mi><mo id="S1.p2.3.m3.1.1.2" xref="S1.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S1.p2.3.m3.1.1.1.1" xref="S1.p2.3.m3.1.1.1.1.1.cmml"><mo id="S1.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S1.p2.3.m3.1.1.1.1.1.cmml">(</mo><msup id="S1.p2.3.m3.1.1.1.1.1" xref="S1.p2.3.m3.1.1.1.1.1.cmml"><mi id="S1.p2.3.m3.1.1.1.1.1.2" xref="S1.p2.3.m3.1.1.1.1.1.2.cmml">L</mi><mn id="S1.p2.3.m3.1.1.1.1.1.3" xref="S1.p2.3.m3.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S1.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S1.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.p2.3.m3.1b"><apply id="S1.p2.3.m3.1.1.cmml" xref="S1.p2.3.m3.1.1"><times id="S1.p2.3.m3.1.1.2.cmml" xref="S1.p2.3.m3.1.1.2"></times><ci id="S1.p2.3.m3.1.1.3.cmml" xref="S1.p2.3.m3.1.1.3">𝒪</ci><apply id="S1.p2.3.m3.1.1.1.1.1.cmml" xref="S1.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S1.p2.3.m3.1.1.1.1.1.1.cmml" xref="S1.p2.3.m3.1.1.1.1">superscript</csymbol><ci id="S1.p2.3.m3.1.1.1.1.1.2.cmml" xref="S1.p2.3.m3.1.1.1.1.1.2">𝐿</ci><cn id="S1.p2.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S1.p2.3.m3.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p2.3.m3.1c">\mathcal{O}(L^{2})</annotation><annotation encoding="application/x-llamapun" id="S1.p2.3.m3.1d">caligraphic_O ( italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math> of standard Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib26" title="">26</a>]</cite>. The architecture comprises two linear projection layers, a convolutional layer, a State Space Model (SSM), and a nonlinear activation function. A key feature of Mamba is its selective SSM, which dynamically adjusts parameters based on input, thus overcoming the SSM’s limitation of being unable to forget previous inputs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib8" title="">8</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">While this dynamic adjustment improves model performance, it introduces a trade-off, slightly reducing the computational efficiency of the underlying linear recurrent neural network (RNN). To mitigate this, Mamba employs a scanning technique that maintains linear time complexity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib8" title="">8</a>]</cite>. In our implementation, we include an optional normalization layer after the final linear projection, which ensures stable embeddings and prevents divergence in experiments <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib15" title="">15</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Our research focuses on leveraging the Mamba model for <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">personalized recommendations</span> based on tabular user data, such as demographic information. Unlike traditional systems, which typically use sequential data such as purchase histories, we handle user data in tabular form. One common approach for handling tabular data in neural networks is the <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">FT-Transformer</span>, which uses a feature tokenizer (FT) to convert tabular data into sequences <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib33" title="">33</a>]</cite>. However, FT-Transformers face scalability challenges, particularly when dealing with datasets containing a large number of features, a limitation largely attributed to the quadratic complexity of Transformers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib28" title="">28</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To address this, we propose the <span class="ltx_text ltx_font_italic" id="S1.p5.1.1">FT-Mamba</span>, a hybrid model that replaces the Transformer layers in FT-Transformers with Mamba layers, thus improving scalability while retaining the ability to process tokenized tabular data. The feature tokenizer in FT-Mamba converts both categorical and numerical tabular data into sequences, which are passed through Mamba layers for efficient sequential processing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib33" title="">33</a>]</cite>. We slightly modify the FT-Transformer by appending the <math alttext="[CLS]" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><mrow id="S1.p5.1.m1.1.1.1" xref="S1.p5.1.m1.1.1.2.cmml"><mo id="S1.p5.1.m1.1.1.1.2" stretchy="false" xref="S1.p5.1.m1.1.1.2.1.cmml">[</mo><mrow id="S1.p5.1.m1.1.1.1.1" xref="S1.p5.1.m1.1.1.1.1.cmml"><mi id="S1.p5.1.m1.1.1.1.1.2" xref="S1.p5.1.m1.1.1.1.1.2.cmml">C</mi><mo id="S1.p5.1.m1.1.1.1.1.1" xref="S1.p5.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S1.p5.1.m1.1.1.1.1.3" xref="S1.p5.1.m1.1.1.1.1.3.cmml">L</mi><mo id="S1.p5.1.m1.1.1.1.1.1a" xref="S1.p5.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S1.p5.1.m1.1.1.1.1.4" xref="S1.p5.1.m1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S1.p5.1.m1.1.1.1.3" stretchy="false" xref="S1.p5.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><apply id="S1.p5.1.m1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.1"><csymbol cd="latexml" id="S1.p5.1.m1.1.1.2.1.cmml" xref="S1.p5.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S1.p5.1.m1.1.1.1.1.cmml" xref="S1.p5.1.m1.1.1.1.1"><times id="S1.p5.1.m1.1.1.1.1.1.cmml" xref="S1.p5.1.m1.1.1.1.1.1"></times><ci id="S1.p5.1.m1.1.1.1.1.2.cmml" xref="S1.p5.1.m1.1.1.1.1.2">𝐶</ci><ci id="S1.p5.1.m1.1.1.1.1.3.cmml" xref="S1.p5.1.m1.1.1.1.1.3">𝐿</ci><ci id="S1.p5.1.m1.1.1.1.1.4.cmml" xref="S1.p5.1.m1.1.1.1.1.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">[CLS]</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">[ italic_C italic_L italic_S ]</annotation></semantics></math> token at the end of the token sequence rather than at the beginning, aligning with the Mamba architecture where the last token aggregates information from all preceding tokens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib33" title="">33</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib28" title="">28</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">To assess the effectiveness of the FT-Mamba, we conduct experiments using three datasets: Spotify music recommendation, H&amp;M fashion recommendation, and vaccine messaging recommendation datasets. The models are trained and evaluated, and a range of performance metrics, including precision (P), recall (R), mean reciprocal rank (MRR), and hit ratio (HR), are computed. We compare the FT-Mamba against a traditional Transformer-based model to determine the advantages of Mamba’s architecture in real-world recommendation tasks.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Additionally, we incorporate a <span class="ltx_text ltx_font_italic" id="S1.p7.1.1">Two-Tower Model</span> architecture, a common framework for recommendation systems. In this model, one tower encodes user information, and the other encodes content information, with both towers using either FT-Transformer or FT-Mamba layers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib3" title="">3</a>]</cite>. The model’s predictions are based on the inner product of the user and content embeddings, providing a robust and efficient solution for personalized recommendations. Our results demonstrate that the FT-Mamba consistently outperforms the Transformer-based model in terms of computational efficiency while achieving comparable or superior performance in key recommendation metrics <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib3" title="">3</a>]</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Methodology</span>
</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS1.5.1.1">II-A</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS1.6.2">Background on Mamba</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.8">The Mamba model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib4" title="">4</a>]</cite> was introduced to reduce the computational complexity of Transformers while enhancing the performance of State Space Models (SSM), such as the Structured State Space Sequence Model (S4) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib14" title="">14</a>]</cite>.
Similar to Transformers and SSMs, the Mamba processes sequential data, such as tokenized sentences.
The Mamba architecture includes two linear projection layers, a convolutional layer, an SSM, and a nonlinear activation function (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S2.F1.sf1" title="In Figure 1 ‣ II-A Background on Mamba ‣ II Methodology ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">1(a)</span></a>).
The SSM component of the Mamba essentially functions as a linear recurrent neural network (RNN), where <math alttext="h_{t}=\overline{A}h_{t-1}+\overline{B}x_{t}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><mrow id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><msub id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2.2" xref="S2.SS1.p1.1.m1.1.1.2.2.cmml">h</mi><mi id="S2.SS1.p1.1.m1.1.1.2.3" xref="S2.SS1.p1.1.m1.1.1.2.3.cmml">t</mi></msub><mo id="S2.SS1.p1.1.m1.1.1.1" xref="S2.SS1.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml"><mrow id="S2.SS1.p1.1.m1.1.1.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.cmml"><mover accent="true" id="S2.SS1.p1.1.m1.1.1.3.2.2" xref="S2.SS1.p1.1.m1.1.1.3.2.2.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.2.2.2" xref="S2.SS1.p1.1.m1.1.1.3.2.2.2.cmml">A</mi><mo id="S2.SS1.p1.1.m1.1.1.3.2.2.1" xref="S2.SS1.p1.1.m1.1.1.3.2.2.1.cmml">¯</mo></mover><mo id="S2.SS1.p1.1.m1.1.1.3.2.1" xref="S2.SS1.p1.1.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S2.SS1.p1.1.m1.1.1.3.2.3" xref="S2.SS1.p1.1.m1.1.1.3.2.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.2.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.3.2.cmml">h</mi><mrow id="S2.SS1.p1.1.m1.1.1.3.2.3.3" xref="S2.SS1.p1.1.m1.1.1.3.2.3.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.2.3.3.2" xref="S2.SS1.p1.1.m1.1.1.3.2.3.3.2.cmml">t</mi><mo id="S2.SS1.p1.1.m1.1.1.3.2.3.3.1" xref="S2.SS1.p1.1.m1.1.1.3.2.3.3.1.cmml">−</mo><mn id="S2.SS1.p1.1.m1.1.1.3.2.3.3.3" xref="S2.SS1.p1.1.m1.1.1.3.2.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S2.SS1.p1.1.m1.1.1.3.1" xref="S2.SS1.p1.1.m1.1.1.3.1.cmml">+</mo><mrow id="S2.SS1.p1.1.m1.1.1.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.cmml"><mover accent="true" id="S2.SS1.p1.1.m1.1.1.3.3.2" xref="S2.SS1.p1.1.m1.1.1.3.3.2.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.3.2.2" xref="S2.SS1.p1.1.m1.1.1.3.3.2.2.cmml">B</mi><mo id="S2.SS1.p1.1.m1.1.1.3.3.2.1" xref="S2.SS1.p1.1.m1.1.1.3.3.2.1.cmml">¯</mo></mover><mo id="S2.SS1.p1.1.m1.1.1.3.3.1" xref="S2.SS1.p1.1.m1.1.1.3.3.1.cmml">⁢</mo><msub id="S2.SS1.p1.1.m1.1.1.3.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.3.cmml"><mi id="S2.SS1.p1.1.m1.1.1.3.3.3.2" xref="S2.SS1.p1.1.m1.1.1.3.3.3.2.cmml">x</mi><mi id="S2.SS1.p1.1.m1.1.1.3.3.3.3" xref="S2.SS1.p1.1.m1.1.1.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><eq id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1.1"></eq><apply id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.2.1.cmml" xref="S2.SS1.p1.1.m1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2.2">ℎ</ci><ci id="S2.SS1.p1.1.m1.1.1.2.3.cmml" xref="S2.SS1.p1.1.m1.1.1.2.3">𝑡</ci></apply><apply id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3"><plus id="S2.SS1.p1.1.m1.1.1.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.1"></plus><apply id="S2.SS1.p1.1.m1.1.1.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2"><times id="S2.SS1.p1.1.m1.1.1.3.2.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2.1"></times><apply id="S2.SS1.p1.1.m1.1.1.3.2.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2.2"><ci id="S2.SS1.p1.1.m1.1.1.3.2.2.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2.2.1">¯</ci><ci id="S2.SS1.p1.1.m1.1.1.3.2.2.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2.2.2">𝐴</ci></apply><apply id="S2.SS1.p1.1.m1.1.1.3.2.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.3.2.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2.3">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.3.2.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2.3.2">ℎ</ci><apply id="S2.SS1.p1.1.m1.1.1.3.2.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2.3.3"><minus id="S2.SS1.p1.1.m1.1.1.3.2.3.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2.3.3.1"></minus><ci id="S2.SS1.p1.1.m1.1.1.3.2.3.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.2.3.3.2">𝑡</ci><cn id="S2.SS1.p1.1.m1.1.1.3.2.3.3.3.cmml" type="integer" xref="S2.SS1.p1.1.m1.1.1.3.2.3.3.3">1</cn></apply></apply></apply><apply id="S2.SS1.p1.1.m1.1.1.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3"><times id="S2.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.1"></times><apply id="S2.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.2"><ci id="S2.SS1.p1.1.m1.1.1.3.3.2.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.2.1">¯</ci><ci id="S2.SS1.p1.1.m1.1.1.3.3.2.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.2.2">𝐵</ci></apply><apply id="S2.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.3.3.3.1.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.3.3.3.2.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.3.2">𝑥</ci><ci id="S2.SS1.p1.1.m1.1.1.3.3.3.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">h_{t}=\overline{A}h_{t-1}+\overline{B}x_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = over¯ start_ARG italic_A end_ARG italic_h start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT + over¯ start_ARG italic_B end_ARG italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, with <math alttext="h" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_h</annotation></semantics></math> representing the hidden state and <math alttext="x" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_x</annotation></semantics></math> the input. However, <math alttext="\overline{A}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><mover accent="true" id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">A</mi><mo id="S2.SS1.p1.4.m4.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><ci id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1">¯</ci><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\overline{A}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">over¯ start_ARG italic_A end_ARG</annotation></semantics></math> and <math alttext="\overline{B}" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mover accent="true" id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">B</mi><mo id="S2.SS1.p1.5.m5.1.1.1" xref="S2.SS1.p1.5.m5.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><ci id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1.1">¯</ci><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\overline{B}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">over¯ start_ARG italic_B end_ARG</annotation></semantics></math> are not directly optimized.
A key limitation of SSMs is their inability to learn to forget inputs. To address this, Mamba incorporates a selective SSM, where the parameters are dynamically adjusted based on the inputs.
However, this introduces a trade-off, reducing the computational efficiency of the linear RNN. To mitigate this, a scanning technique is applied, which maintains the computation in linear time.
Specifically, for a sequence length of <math alttext="L" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1"><semantics id="S2.SS1.p1.6.m6.1a"><mi id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.6.m6.1d">italic_L</annotation></semantics></math>, the computational complexity of both Mamba and SSM is linear (<math alttext="\mathcal{O}(L)" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1"><semantics id="S2.SS1.p1.7.m7.1a"><mrow id="S2.SS1.p1.7.m7.1.2" xref="S2.SS1.p1.7.m7.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.1.2.2" xref="S2.SS1.p1.7.m7.1.2.2.cmml">𝒪</mi><mo id="S2.SS1.p1.7.m7.1.2.1" xref="S2.SS1.p1.7.m7.1.2.1.cmml">⁢</mo><mrow id="S2.SS1.p1.7.m7.1.2.3.2" xref="S2.SS1.p1.7.m7.1.2.cmml"><mo id="S2.SS1.p1.7.m7.1.2.3.2.1" stretchy="false" xref="S2.SS1.p1.7.m7.1.2.cmml">(</mo><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">L</mi><mo id="S2.SS1.p1.7.m7.1.2.3.2.2" stretchy="false" xref="S2.SS1.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.2.cmml" xref="S2.SS1.p1.7.m7.1.2"><times id="S2.SS1.p1.7.m7.1.2.1.cmml" xref="S2.SS1.p1.7.m7.1.2.1"></times><ci id="S2.SS1.p1.7.m7.1.2.2.cmml" xref="S2.SS1.p1.7.m7.1.2.2">𝒪</ci><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">\mathcal{O}(L)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.7.m7.1d">caligraphic_O ( italic_L )</annotation></semantics></math>), whereas the standard Transformer exhibits quadratic complexity (<math alttext="\mathcal{O}(L^{2})" class="ltx_Math" display="inline" id="S2.SS1.p1.8.m8.1"><semantics id="S2.SS1.p1.8.m8.1a"><mrow id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.8.m8.1.1.3" xref="S2.SS1.p1.8.m8.1.1.3.cmml">𝒪</mi><mo id="S2.SS1.p1.8.m8.1.1.2" xref="S2.SS1.p1.8.m8.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p1.8.m8.1.1.1.1" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml"><mo id="S2.SS1.p1.8.m8.1.1.1.1.2" stretchy="false" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml">(</mo><msup id="S2.SS1.p1.8.m8.1.1.1.1.1" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.8.m8.1.1.1.1.1.2" xref="S2.SS1.p1.8.m8.1.1.1.1.1.2.cmml">L</mi><mn id="S2.SS1.p1.8.m8.1.1.1.1.1.3" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.SS1.p1.8.m8.1.1.1.1.3" stretchy="false" xref="S2.SS1.p1.8.m8.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><apply id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1"><times id="S2.SS1.p1.8.m8.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.2"></times><ci id="S2.SS1.p1.8.m8.1.1.3.cmml" xref="S2.SS1.p1.8.m8.1.1.3">𝒪</ci><apply id="S2.SS1.p1.8.m8.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1">superscript</csymbol><ci id="S2.SS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.8.m8.1.1.1.1.1.2">𝐿</ci><cn id="S2.SS1.p1.8.m8.1.1.1.1.1.3.cmml" type="integer" xref="S2.SS1.p1.8.m8.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">\mathcal{O}(L^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.8.m8.1d">caligraphic_O ( italic_L start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>).
Our specific implementation of the Mamba is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S2.F1.sf1" title="In Figure 1 ‣ II-A Background on Mamba ‣ II Methodology ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">1(a)</span></a>.
We include an optional normalization layer. However, instead of placing it before the final linear projection, as in the original Mamba architecture, we place it afterward to maintain consistency with the original implementation<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/state-spaces/mamba/blob/main/mamba_ssm/modules/mamba_simple.py" title="">https://github.com/state-spaces/mamba/blob/main/mamba_ssm/modules/mamba_simple.py</a></span></span></span>. Omitting it caused the embeddings to grow too large in our experiments.</p>
</div>
<figure class="ltx_figure" id="S2.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F1.sf1"><svg class="ltx_picture ltx_centering" height="224.38" id="S2.F1.sf1.pic1" overflow="visible" version="1.1" width="210.33"><g fill="#000000" stroke="#000000" transform="translate(0,224.38) matrix(1 0 0 -1 0 0) translate(105.17,0) translate(0,200.48)"><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -81.53 -186.9 h 163.05 v 174.11 h -163.05 Z" style="fill:none"></path></g><g stroke-width="0.4pt"><g fill="#C9D4D7"><path d="M 15.05 -110.05 C 15.05 -101.74 8.31 -95 0 -95 C -8.31 -95 -15.05 -101.74 -15.05 -110.05 C -15.05 -118.36 -8.31 -125.1 0 -125.1 C 8.31 -125.1 15.05 -118.36 15.05 -110.05 Z M 0 -110.05"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.7 0.0 0.0 0.7 -3.77 -120.17)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 24.3)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 27.76)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="\times" class="ltx_Math" display="inline" id="S2.F1.sf1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F1.sf1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F1.sf1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.F1.sf1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><times id="S2.F1.sf1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.F1.sf1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">×</annotation></semantics></math></foreignobject></g></g></g></g><g fill="#F59105" stroke-width="0.8pt"><path d="M -25.24 -161.04 L -46.49 -124.22 L 46.49 -124.22 L 25.24 -161.04 Z"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 -22.01 -157.81)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 31.525)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 43.38)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="23.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="62.88">
<span class="ltx_inline-block" id="S2.F1.sf1.pic1.4.4.4.4.1.1.1.1.1">
<span class="ltx_p" id="S2.F1.sf1.pic1.4.4.4.4.1.1.1.1.1.1">Projection</span>
<span class="ltx_p" id="S2.F1.sf1.pic1.4.4.4.4.1.1.1.1.1.2"><span class="ltx_text" id="S2.F1.sf1.pic1.4.4.4.4.1.1.1.1.1.2.1" style="font-size:80%;">contraction</span></span>
</span></foreignobject></g></g></g></g><g fill="#FEC010" stroke-width="0.8pt"><path d="M 27 -163.68 L -27 -163.68 L -27 -178.64 L 27 -178.64 Z M -27 -178.64"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 -23.77 -173.53)"><foreignobject height="12.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="68.3"><span class="ltx_text" id="S2.F1.sf1.pic1.5.5.5.5.1.1">LayerNorm</span></foreignobject></g><g fill="#F59105" stroke-width="0.8pt"><path d="M -21.94 -50.14 L 16.1 15.74 L 66.58 15.74 L 104.61 -50.14 Z"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 19.33 -46.92)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 71.98)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 84.9)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="25.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="62.88">
<span class="ltx_inline-block" id="S2.F1.sf1.pic1.6.6.6.6.1.1.1.1.1">
<span class="ltx_p" id="S2.F1.sf1.pic1.6.6.6.6.1.1.1.1.1.1">Projection</span>
<span class="ltx_p" id="S2.F1.sf1.pic1.6.6.6.6.1.1.1.1.1.2"><span class="ltx_text" id="S2.F1.sf1.pic1.6.6.6.6.1.1.1.1.1.2.1" style="font-size:80%;">expansion</span></span>
</span></foreignobject></g></g></g></g><g fill="#0A4150" stroke-width="0.8pt"><path d="M 78 -24.34 L 4.68 -24.34 L 4.68 -78.86 L 78 -78.86 Z M 4.68 -78.86"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 7.91 -75.64)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 63.855)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 68.67)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="95.9"><span class="ltx_text" id="S2.F1.sf1.pic1.7.7.7.7.1.1.1.1.1" style="color:#FFFFFF;">1D Convolution</span></foreignobject></g></g></g></g><g fill="#C9D4D7"><path d="M 67.94 -72.23 C 67.94 -57.53 56.03 -45.62 41.34 -45.62 C 26.64 -45.62 14.73 -57.53 14.73 -72.23 C 14.73 -86.92 26.64 -98.83 41.34 -98.83 C 56.03 -98.83 67.94 -86.92 67.94 -72.23 Z M 41.34 -72.23"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.7 0.0 0.0 0.7 38.57 -94.98)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 62.03)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 65.02)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math alttext="\sigma" class="ltx_Math" display="inline" id="S2.F1.sf1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F1.sf1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S2.F1.sf1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.F1.sf1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.F1.sf1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.F1.sf1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_σ</annotation></semantics></math></foreignobject></g></g></g></g><g fill="#0A4150" stroke-width="0.8pt"><path d="M 56 -65.64 L 26.68 -65.64 L 26.68 -120.06 L 56 -120.06 Z M 26.68 -120.06"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 29.9 -116.83)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 63.78)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 68.52)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="28.06"><span class="ltx_text" id="S2.F1.sf1.pic1.8.8.8.8.1.1.1.1.1" style="color:#FFFFFF;">SSM</span></foreignobject></g></g></g></g><g fill="#F59105" stroke-width="0.8pt"><path d="M -104.61 -50.14 L -66.58 15.74 L -16.1 15.74 L 21.94 -50.14 Z"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 -63.35 -46.92)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 71.98)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 84.9)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="25.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="62.88">
<span class="ltx_inline-block" id="S2.F1.sf1.pic1.9.9.9.9.1.1.1.1.1">
<span class="ltx_p" id="S2.F1.sf1.pic1.9.9.9.9.1.1.1.1.1.1">Projection</span>
<span class="ltx_p" id="S2.F1.sf1.pic1.9.9.9.9.1.1.1.1.1.2"><span class="ltx_text" id="S2.F1.sf1.pic1.9.9.9.9.1.1.1.1.1.2.1" style="font-size:80%;">expansion</span></span>
</span></foreignobject></g></g></g></g><g fill="#C9D4D7"><path d="M -14.73 -72.23 C -14.73 -57.53 -26.64 -45.62 -41.34 -45.62 C -56.03 -45.62 -67.94 -57.53 -67.94 -72.23 C -67.94 -86.92 -56.03 -98.83 -41.34 -98.83 C -26.64 -98.83 -14.73 -86.92 -14.73 -72.23 Z M -41.34 -72.23"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.7 0.0 0.0 0.7 -44.11 -94.98)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 62.03)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 65.02)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="5.96" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.91"><math alttext="\sigma" class="ltx_Math" display="inline" id="S2.F1.sf1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F1.sf1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S2.F1.sf1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.F1.sf1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S2.F1.sf1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.F1.sf1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_σ</annotation></semantics></math></foreignobject></g></g></g></g></g><g stroke-width="1.2pt"><path d="M 0 17.2 L 0 0" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 0 L 41.34 0" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 0 L -41.34 0" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M -41.34 0 L -41.34 16.13" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M -41.34 -50.53 L -41.34 -45.43" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M -41.34 -99.03 L -41.34 -110.05" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M -41.34 -110.05 L -16.57 -110.05" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(1.0 0.0 0.0 1.0 -16.57 -110.05)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 41.34 0 L 41.34 16.13" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 41.34 -50.53 L 41.34 -23.96" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 41.34 -23.96 L 41.34 -45.43" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 41.34 -45.43 L 41.34 -65.26" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 41.34 -120.44 L 41.34 -110.05" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 41.34 -110.05 L 16.57 -110.05" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(-1.0 0.0 0.0 -1.0 16.57 -110.05)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -125.3 L 0 -123.83" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -161.42 L 0 -163.3" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -179.03 L 0 -198.32" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(0.0 -1.0 1.0 0.0 0 -198.32)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S2.F1.sf1.3.2" style="font-size:90%;">Mamba Layer</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S2.F1.sf2"><svg class="ltx_picture ltx_centering" height="222.94" id="S2.F1.sf2.pic1" overflow="visible" version="1.1" width="106.38"><g fill="#000000" stroke="#000000" transform="translate(0,222.94) matrix(1 0 0 -1 0 0) translate(53.19,0) translate(0,219.71)"><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -81.53 -186.9 h 163.05 v 174.11 h -163.05 Z" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -52.63 -206.13 h 105.27 v 193.38 h -105.27 Z" style="fill:none"></path></g><g fill="#0A4150" stroke-width="0.8pt"><path d="M 26.5 -27.19 L -26.5 -27.19 L -26.5 -49.75 L 26.5 -49.75 Z M -26.5 -49.75"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 -23.27 -46.52)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 18.27)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 13.55)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 8.745)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 13.55)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="66.49"><span class="ltx_text" id="S2.F1.sf2.pic1.3.3.3.1.1.1.1.1.1.1.1" style="color:#FFFFFF;">Multi-head</span></foreignobject></g></g></g></g></g><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 23.01)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 4.23 0)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="58.42"><span class="ltx_text" id="S2.F1.sf2.pic1.4.4.4.2.2.1.1.1" style="color:#FFFFFF;">Attention</span></foreignobject></g></g></g></g><g fill="#C9D4D7" stroke-width="0.8pt"><path d="M 11.56 -67.59 C 11.56 -61.21 6.39 -56.03 0 -56.03 C -6.39 -56.03 -11.56 -61.21 -11.56 -67.59 C -11.56 -73.98 -6.39 -79.15 0 -79.15 C 6.39 -79.15 11.56 -73.98 11.56 -67.59 Z M 0 -67.59"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 -3.77 -73.58)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 12.49)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 15.94)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="+" class="ltx_Math" display="inline" id="S2.F1.sf2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F1.sf2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F1.sf2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><plus id="S2.F1.sf2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">+</annotation><annotation encoding="application/x-llamapun" id="S2.F1.sf2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">+</annotation></semantics></math></foreignobject></g></g></g></g><g fill="#FEC010" stroke-width="0.8pt"><path d="M 27 -85.44 L -27 -85.44 L -27 -105.91 L 27 -105.91 Z M -27 -105.91"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 -23.77 -102.68)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 13.945)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 17.33)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">LayerNorm</text></g></g></g></g><g fill="#F59105" stroke-width="0.8pt"><path d="M 32.04 -119.04 L -32.04 -119.04 L -32.04 -141.71 L 32.04 -141.71 Z M -32.04 -141.71"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 -28.82 -138.48)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 18.355)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 13.55)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 8.745)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 13.55)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Feed-Forward</text></g></g></g></g></g><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 23.16)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 15.78 0)"><text transform="matrix(1 0 0 -1 0 0)">Network</text></g></g></g></g><g fill="#C9D4D7" stroke-width="0.8pt"><path d="M 11.56 -159.55 C 11.56 -153.17 6.39 -147.99 0 -147.99 C -6.39 -147.99 -11.56 -153.17 -11.56 -159.55 C -11.56 -165.94 -6.39 -171.11 0 -171.11 C 6.39 -171.11 11.56 -165.94 11.56 -159.55 Z M 0 -159.55"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 -3.77 -165.54)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 12.49)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 15.94)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="+" class="ltx_Math" display="inline" id="S2.F1.sf2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F1.sf2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F1.sf2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F1.sf2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S2.F1.sf2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><plus id="S2.F1.sf2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F1.sf2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S2.F1.sf2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">+</annotation><annotation encoding="application/x-llamapun" id="S2.F1.sf2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">+</annotation></semantics></math></foreignobject></g></g></g></g><g fill="#FEC010" stroke-width="0.8pt"><path d="M 27 -177.4 L -27 -177.4 L -27 -197.87 L 27 -197.87 Z M -27 -197.87"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.7 0.0 0.0 0.7 -23.77 -194.64)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 13.945)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 17.33)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">LayerNorm</text></g></g></g></g><g stroke-width="1.2pt"><path d="M 0 -3.42 L 0 -20.62" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -20.62 L 0 -26.8" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -50.13 L 0 -55.65" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -79.54 L 0 -85.05" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -106.3 L 0 -112.48" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -112.48 L 0 -118.65" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -142.09 L 0 -147.6" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -171.5 L 0 -177.01" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -198.26 L 0 -215.46" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -20.62 L 44.76 -20.62" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 44.76 -20.62 L 44.76 -67.59" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 44.76 -67.59 L 13.28 -67.59" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(-1.0 0.0 0.0 -1.0 13.28 -67.59)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -112.48 L -44.76 -112.48" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M -44.76 -112.48 L -44.76 -159.55" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M -44.76 -159.55 L -13.28 -159.55" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(1.0 -0.00002 0.00002 1.0 -13.28 -159.55)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 0 -198.26 L 0 -217.55" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(0.0 -1.0 1.0 0.0 0 -217.55)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S2.F1.sf2.3.2" style="font-size:90%;">Transformer Layer</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S2.F1.3.2" style="font-size:90%;">Embedding layers</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS2.5.1.1">II-B</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS2.6.2">Tokenizer and FT-Mamba</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Our goal is to create personalized recommendations using user information.
Specifically, the user data in our case is tabular (e.g., demographic information) rather than sequential (e.g., purchase history).
The FT-Transformer, introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib12" title="">12</a>]</cite>, utilizes a feature tokenizer (FT) combined with Transformer layers.
The feature tokenizer converts tabular data into sequence-like data that can be processed by the Transformer.
A notable drawback of the FT-Transformer is its limited scalability when handling datasets with a large number of features.
Although this limitation is not solely due to the Transformer component (as discussed in the following footnote), replacing the Transformer with a model that scales more efficiently would be beneficial.
As previously mentioned, the Mamba was proposed as a more scalable alternative to the Transformer.
Therefore, we replace the Transformer layers (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S2.F1.sf2" title="In Figure 1 ‣ II-A Background on Mamba ‣ II Methodology ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">1(b)</span></a>) with Mamba layers (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S2.F1.sf1" title="In Figure 1 ‣ II-A Background on Mamba ‣ II Methodology ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">1(a)</span></a>).
This model, which combines the feature tokenizer with Mamba layers, is referred to as the FT-Mamba. Below, we detail the feature tokenizer based on <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib12" title="">12</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.18">The feature tokenizer converts tabular data into a sequence of tokens, handling categorical and numerical values separately (see Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S2.F2" title="Figure 2 ‣ II-B Tokenizer and FT-Mamba ‣ II Methodology ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">2</span></a> for an overview).
Let <math alttext="d" class="ltx_Math" display="inline" id="S2.SS2.p2.1.m1.1"><semantics id="S2.SS2.p2.1.m1.1a"><mi id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><ci id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.1.m1.1d">italic_d</annotation></semantics></math> denote the dimension of the token space, <math alttext="\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS2.p2.2.m2.1"><semantics id="S2.SS2.p2.2.m2.1a"><msup id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">ℝ</mi><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">ℝ</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.2.m2.1d">blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.
For numeric input, the real values are linearly scaled into <math alttext="\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS2.p2.3.m3.1"><semantics id="S2.SS2.p2.3.m3.1a"><msup id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml">ℝ</mi><mi id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">d</mi></msup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">superscript</csymbol><ci id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2">ℝ</ci><ci id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.3.m3.1d">blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> as follows: <math alttext="x_{j}\mapsto x_{j}w_{j}+b_{j}" class="ltx_Math" display="inline" id="S2.SS2.p2.4.m4.1"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><msub id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml"><mi id="S2.SS2.p2.4.m4.1.1.2.2" xref="S2.SS2.p2.4.m4.1.1.2.2.cmml">x</mi><mi id="S2.SS2.p2.4.m4.1.1.2.3" xref="S2.SS2.p2.4.m4.1.1.2.3.cmml">j</mi></msub><mo id="S2.SS2.p2.4.m4.1.1.1" stretchy="false" xref="S2.SS2.p2.4.m4.1.1.1.cmml">↦</mo><mrow id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml"><mrow id="S2.SS2.p2.4.m4.1.1.3.2" xref="S2.SS2.p2.4.m4.1.1.3.2.cmml"><msub id="S2.SS2.p2.4.m4.1.1.3.2.2" xref="S2.SS2.p2.4.m4.1.1.3.2.2.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3.2.2.2" xref="S2.SS2.p2.4.m4.1.1.3.2.2.2.cmml">x</mi><mi id="S2.SS2.p2.4.m4.1.1.3.2.2.3" xref="S2.SS2.p2.4.m4.1.1.3.2.2.3.cmml">j</mi></msub><mo id="S2.SS2.p2.4.m4.1.1.3.2.1" xref="S2.SS2.p2.4.m4.1.1.3.2.1.cmml">⁢</mo><msub id="S2.SS2.p2.4.m4.1.1.3.2.3" xref="S2.SS2.p2.4.m4.1.1.3.2.3.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3.2.3.2" xref="S2.SS2.p2.4.m4.1.1.3.2.3.2.cmml">w</mi><mi id="S2.SS2.p2.4.m4.1.1.3.2.3.3" xref="S2.SS2.p2.4.m4.1.1.3.2.3.3.cmml">j</mi></msub></mrow><mo id="S2.SS2.p2.4.m4.1.1.3.1" xref="S2.SS2.p2.4.m4.1.1.3.1.cmml">+</mo><msub id="S2.SS2.p2.4.m4.1.1.3.3" xref="S2.SS2.p2.4.m4.1.1.3.3.cmml"><mi id="S2.SS2.p2.4.m4.1.1.3.3.2" xref="S2.SS2.p2.4.m4.1.1.3.3.2.cmml">b</mi><mi id="S2.SS2.p2.4.m4.1.1.3.3.3" xref="S2.SS2.p2.4.m4.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><csymbol cd="latexml" id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1">maps-to</csymbol><apply id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.2.1.cmml" xref="S2.SS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2.2">𝑥</ci><ci id="S2.SS2.p2.4.m4.1.1.2.3.cmml" xref="S2.SS2.p2.4.m4.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3"><plus id="S2.SS2.p2.4.m4.1.1.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.1"></plus><apply id="S2.SS2.p2.4.m4.1.1.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2"><times id="S2.SS2.p2.4.m4.1.1.3.2.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.1"></times><apply id="S2.SS2.p2.4.m4.1.1.3.2.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.3.2.2.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.2">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.3.2.2.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.2.2">𝑥</ci><ci id="S2.SS2.p2.4.m4.1.1.3.2.2.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.2.3">𝑗</ci></apply><apply id="S2.SS2.p2.4.m4.1.1.3.2.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.3.2.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.3">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.3.2.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.3.2">𝑤</ci><ci id="S2.SS2.p2.4.m4.1.1.3.2.3.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS2.p2.4.m4.1.1.3.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.3.3.1.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.3.3.2.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3.2">𝑏</ci><ci id="S2.SS2.p2.4.m4.1.1.3.3.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">x_{j}\mapsto x_{j}w_{j}+b_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ↦ italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="w_{j},b_{j}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS2.p2.5.m5.2"><semantics id="S2.SS2.p2.5.m5.2a"><mrow id="S2.SS2.p2.5.m5.2.2" xref="S2.SS2.p2.5.m5.2.2.cmml"><mrow id="S2.SS2.p2.5.m5.2.2.2.2" xref="S2.SS2.p2.5.m5.2.2.2.3.cmml"><msub id="S2.SS2.p2.5.m5.1.1.1.1.1" xref="S2.SS2.p2.5.m5.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.1.1.1.2" xref="S2.SS2.p2.5.m5.1.1.1.1.1.2.cmml">w</mi><mi id="S2.SS2.p2.5.m5.1.1.1.1.1.3" xref="S2.SS2.p2.5.m5.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S2.SS2.p2.5.m5.2.2.2.2.3" xref="S2.SS2.p2.5.m5.2.2.2.3.cmml">,</mo><msub id="S2.SS2.p2.5.m5.2.2.2.2.2" xref="S2.SS2.p2.5.m5.2.2.2.2.2.cmml"><mi id="S2.SS2.p2.5.m5.2.2.2.2.2.2" xref="S2.SS2.p2.5.m5.2.2.2.2.2.2.cmml">b</mi><mi id="S2.SS2.p2.5.m5.2.2.2.2.2.3" xref="S2.SS2.p2.5.m5.2.2.2.2.2.3.cmml">j</mi></msub></mrow><mo id="S2.SS2.p2.5.m5.2.2.3" xref="S2.SS2.p2.5.m5.2.2.3.cmml">∈</mo><msup id="S2.SS2.p2.5.m5.2.2.4" xref="S2.SS2.p2.5.m5.2.2.4.cmml"><mi id="S2.SS2.p2.5.m5.2.2.4.2" xref="S2.SS2.p2.5.m5.2.2.4.2.cmml">ℝ</mi><mi id="S2.SS2.p2.5.m5.2.2.4.3" xref="S2.SS2.p2.5.m5.2.2.4.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.2b"><apply id="S2.SS2.p2.5.m5.2.2.cmml" xref="S2.SS2.p2.5.m5.2.2"><in id="S2.SS2.p2.5.m5.2.2.3.cmml" xref="S2.SS2.p2.5.m5.2.2.3"></in><list id="S2.SS2.p2.5.m5.2.2.2.3.cmml" xref="S2.SS2.p2.5.m5.2.2.2.2"><apply id="S2.SS2.p2.5.m5.1.1.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.2">𝑤</ci><ci id="S2.SS2.p2.5.m5.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.1.1.1.3">𝑗</ci></apply><apply id="S2.SS2.p2.5.m5.2.2.2.2.2.cmml" xref="S2.SS2.p2.5.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.2.2.2.2.2.1.cmml" xref="S2.SS2.p2.5.m5.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.5.m5.2.2.2.2.2.2.cmml" xref="S2.SS2.p2.5.m5.2.2.2.2.2.2">𝑏</ci><ci id="S2.SS2.p2.5.m5.2.2.2.2.2.3.cmml" xref="S2.SS2.p2.5.m5.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S2.SS2.p2.5.m5.2.2.4.cmml" xref="S2.SS2.p2.5.m5.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.2.2.4.1.cmml" xref="S2.SS2.p2.5.m5.2.2.4">superscript</csymbol><ci id="S2.SS2.p2.5.m5.2.2.4.2.cmml" xref="S2.SS2.p2.5.m5.2.2.4.2">ℝ</ci><ci id="S2.SS2.p2.5.m5.2.2.4.3.cmml" xref="S2.SS2.p2.5.m5.2.2.4.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.2c">w_{j},b_{j}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.5.m5.2d">italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are trainable parameters.
For categorical input, the categories of each feature are enumerated, and the feature’s index is used instead of the actual value.
Specifically, if <math alttext="x_{j}" class="ltx_Math" display="inline" id="S2.SS2.p2.6.m6.1"><semantics id="S2.SS2.p2.6.m6.1a"><msub id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml"><mi id="S2.SS2.p2.6.m6.1.1.2" xref="S2.SS2.p2.6.m6.1.1.2.cmml">x</mi><mi id="S2.SS2.p2.6.m6.1.1.3" xref="S2.SS2.p2.6.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><apply id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p2.6.m6.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1.2">𝑥</ci><ci id="S2.SS2.p2.6.m6.1.1.3.cmml" xref="S2.SS2.p2.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">x_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.6.m6.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is categorical and feature <math alttext="j" class="ltx_Math" display="inline" id="S2.SS2.p2.7.m7.1"><semantics id="S2.SS2.p2.7.m7.1a"><mi id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.1b"><ci id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.7.m7.1d">italic_j</annotation></semantics></math> has <math alttext="K_{j}" class="ltx_Math" display="inline" id="S2.SS2.p2.8.m8.1"><semantics id="S2.SS2.p2.8.m8.1a"><msub id="S2.SS2.p2.8.m8.1.1" xref="S2.SS2.p2.8.m8.1.1.cmml"><mi id="S2.SS2.p2.8.m8.1.1.2" xref="S2.SS2.p2.8.m8.1.1.2.cmml">K</mi><mi id="S2.SS2.p2.8.m8.1.1.3" xref="S2.SS2.p2.8.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.1b"><apply id="S2.SS2.p2.8.m8.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S2.SS2.p2.8.m8.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1.2">𝐾</ci><ci id="S2.SS2.p2.8.m8.1.1.3.cmml" xref="S2.SS2.p2.8.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.1c">K_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.8.m8.1d">italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> categories, then <math alttext="x_{j}\in{0,1,\dots,K_{j}}" class="ltx_Math" display="inline" id="S2.SS2.p2.9.m9.4"><semantics id="S2.SS2.p2.9.m9.4a"><mrow id="S2.SS2.p2.9.m9.4.4" xref="S2.SS2.p2.9.m9.4.4.cmml"><msub id="S2.SS2.p2.9.m9.4.4.3" xref="S2.SS2.p2.9.m9.4.4.3.cmml"><mi id="S2.SS2.p2.9.m9.4.4.3.2" xref="S2.SS2.p2.9.m9.4.4.3.2.cmml">x</mi><mi id="S2.SS2.p2.9.m9.4.4.3.3" xref="S2.SS2.p2.9.m9.4.4.3.3.cmml">j</mi></msub><mo id="S2.SS2.p2.9.m9.4.4.2" xref="S2.SS2.p2.9.m9.4.4.2.cmml">∈</mo><mrow id="S2.SS2.p2.9.m9.4.4.1.1" xref="S2.SS2.p2.9.m9.4.4.1.2.cmml"><mn id="S2.SS2.p2.9.m9.1.1" xref="S2.SS2.p2.9.m9.1.1.cmml">0</mn><mo id="S2.SS2.p2.9.m9.4.4.1.1.2" xref="S2.SS2.p2.9.m9.4.4.1.2.cmml">,</mo><mn id="S2.SS2.p2.9.m9.2.2" xref="S2.SS2.p2.9.m9.2.2.cmml">1</mn><mo id="S2.SS2.p2.9.m9.4.4.1.1.3" xref="S2.SS2.p2.9.m9.4.4.1.2.cmml">,</mo><mi id="S2.SS2.p2.9.m9.3.3" mathvariant="normal" xref="S2.SS2.p2.9.m9.3.3.cmml">…</mi><mo id="S2.SS2.p2.9.m9.4.4.1.1.4" xref="S2.SS2.p2.9.m9.4.4.1.2.cmml">,</mo><msub id="S2.SS2.p2.9.m9.4.4.1.1.1" xref="S2.SS2.p2.9.m9.4.4.1.1.1.cmml"><mi id="S2.SS2.p2.9.m9.4.4.1.1.1.2" xref="S2.SS2.p2.9.m9.4.4.1.1.1.2.cmml">K</mi><mi id="S2.SS2.p2.9.m9.4.4.1.1.1.3" xref="S2.SS2.p2.9.m9.4.4.1.1.1.3.cmml">j</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m9.4b"><apply id="S2.SS2.p2.9.m9.4.4.cmml" xref="S2.SS2.p2.9.m9.4.4"><in id="S2.SS2.p2.9.m9.4.4.2.cmml" xref="S2.SS2.p2.9.m9.4.4.2"></in><apply id="S2.SS2.p2.9.m9.4.4.3.cmml" xref="S2.SS2.p2.9.m9.4.4.3"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.4.4.3.1.cmml" xref="S2.SS2.p2.9.m9.4.4.3">subscript</csymbol><ci id="S2.SS2.p2.9.m9.4.4.3.2.cmml" xref="S2.SS2.p2.9.m9.4.4.3.2">𝑥</ci><ci id="S2.SS2.p2.9.m9.4.4.3.3.cmml" xref="S2.SS2.p2.9.m9.4.4.3.3">𝑗</ci></apply><list id="S2.SS2.p2.9.m9.4.4.1.2.cmml" xref="S2.SS2.p2.9.m9.4.4.1.1"><cn id="S2.SS2.p2.9.m9.1.1.cmml" type="integer" xref="S2.SS2.p2.9.m9.1.1">0</cn><cn id="S2.SS2.p2.9.m9.2.2.cmml" type="integer" xref="S2.SS2.p2.9.m9.2.2">1</cn><ci id="S2.SS2.p2.9.m9.3.3.cmml" xref="S2.SS2.p2.9.m9.3.3">…</ci><apply id="S2.SS2.p2.9.m9.4.4.1.1.1.cmml" xref="S2.SS2.p2.9.m9.4.4.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.4.4.1.1.1.1.cmml" xref="S2.SS2.p2.9.m9.4.4.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.9.m9.4.4.1.1.1.2.cmml" xref="S2.SS2.p2.9.m9.4.4.1.1.1.2">𝐾</ci><ci id="S2.SS2.p2.9.m9.4.4.1.1.1.3.cmml" xref="S2.SS2.p2.9.m9.4.4.1.1.1.3">𝑗</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m9.4c">x_{j}\in{0,1,\dots,K_{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.9.m9.4d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ 0 , 1 , … , italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>.
For each categorical feature, a lookup table is created where each feature value corresponds to a specific row. We denote the lookup table for feature <math alttext="j" class="ltx_Math" display="inline" id="S2.SS2.p2.10.m10.1"><semantics id="S2.SS2.p2.10.m10.1a"><mi id="S2.SS2.p2.10.m10.1.1" xref="S2.SS2.p2.10.m10.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m10.1b"><ci id="S2.SS2.p2.10.m10.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m10.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.10.m10.1d">italic_j</annotation></semantics></math> as <math alttext="W_{j}\in\mathbb{R}^{K_{j}\times d}" class="ltx_Math" display="inline" id="S2.SS2.p2.11.m11.1"><semantics id="S2.SS2.p2.11.m11.1a"><mrow id="S2.SS2.p2.11.m11.1.1" xref="S2.SS2.p2.11.m11.1.1.cmml"><msub id="S2.SS2.p2.11.m11.1.1.2" xref="S2.SS2.p2.11.m11.1.1.2.cmml"><mi id="S2.SS2.p2.11.m11.1.1.2.2" xref="S2.SS2.p2.11.m11.1.1.2.2.cmml">W</mi><mi id="S2.SS2.p2.11.m11.1.1.2.3" xref="S2.SS2.p2.11.m11.1.1.2.3.cmml">j</mi></msub><mo id="S2.SS2.p2.11.m11.1.1.1" xref="S2.SS2.p2.11.m11.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.11.m11.1.1.3" xref="S2.SS2.p2.11.m11.1.1.3.cmml"><mi id="S2.SS2.p2.11.m11.1.1.3.2" xref="S2.SS2.p2.11.m11.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.11.m11.1.1.3.3" xref="S2.SS2.p2.11.m11.1.1.3.3.cmml"><msub id="S2.SS2.p2.11.m11.1.1.3.3.2" xref="S2.SS2.p2.11.m11.1.1.3.3.2.cmml"><mi id="S2.SS2.p2.11.m11.1.1.3.3.2.2" xref="S2.SS2.p2.11.m11.1.1.3.3.2.2.cmml">K</mi><mi id="S2.SS2.p2.11.m11.1.1.3.3.2.3" xref="S2.SS2.p2.11.m11.1.1.3.3.2.3.cmml">j</mi></msub><mo id="S2.SS2.p2.11.m11.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.11.m11.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p2.11.m11.1.1.3.3.3" xref="S2.SS2.p2.11.m11.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.11.m11.1b"><apply id="S2.SS2.p2.11.m11.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1"><in id="S2.SS2.p2.11.m11.1.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1.1"></in><apply id="S2.SS2.p2.11.m11.1.1.2.cmml" xref="S2.SS2.p2.11.m11.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.2.1.cmml" xref="S2.SS2.p2.11.m11.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.11.m11.1.1.2.2.cmml" xref="S2.SS2.p2.11.m11.1.1.2.2">𝑊</ci><ci id="S2.SS2.p2.11.m11.1.1.2.3.cmml" xref="S2.SS2.p2.11.m11.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p2.11.m11.1.1.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.3.1.cmml" xref="S2.SS2.p2.11.m11.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.11.m11.1.1.3.2.cmml" xref="S2.SS2.p2.11.m11.1.1.3.2">ℝ</ci><apply id="S2.SS2.p2.11.m11.1.1.3.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3.3"><times id="S2.SS2.p2.11.m11.1.1.3.3.1.cmml" xref="S2.SS2.p2.11.m11.1.1.3.3.1"></times><apply id="S2.SS2.p2.11.m11.1.1.3.3.2.cmml" xref="S2.SS2.p2.11.m11.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.3.3.2.1.cmml" xref="S2.SS2.p2.11.m11.1.1.3.3.2">subscript</csymbol><ci id="S2.SS2.p2.11.m11.1.1.3.3.2.2.cmml" xref="S2.SS2.p2.11.m11.1.1.3.3.2.2">𝐾</ci><ci id="S2.SS2.p2.11.m11.1.1.3.3.2.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3.3.2.3">𝑗</ci></apply><ci id="S2.SS2.p2.11.m11.1.1.3.3.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.11.m11.1c">W_{j}\in\mathbb{R}^{K_{j}\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.11.m11.1d">italic_W start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>.<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>This highlights a scaling issue with the feature tokenizer: memory requirements increase with both the number of features and the number of categories per feature.</span></span></span>
The token for <math alttext="x_{j}" class="ltx_Math" display="inline" id="S2.SS2.p2.12.m12.1"><semantics id="S2.SS2.p2.12.m12.1a"><msub id="S2.SS2.p2.12.m12.1.1" xref="S2.SS2.p2.12.m12.1.1.cmml"><mi id="S2.SS2.p2.12.m12.1.1.2" xref="S2.SS2.p2.12.m12.1.1.2.cmml">x</mi><mi id="S2.SS2.p2.12.m12.1.1.3" xref="S2.SS2.p2.12.m12.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.12.m12.1b"><apply id="S2.SS2.p2.12.m12.1.1.cmml" xref="S2.SS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.12.m12.1.1.1.cmml" xref="S2.SS2.p2.12.m12.1.1">subscript</csymbol><ci id="S2.SS2.p2.12.m12.1.1.2.cmml" xref="S2.SS2.p2.12.m12.1.1.2">𝑥</ci><ci id="S2.SS2.p2.12.m12.1.1.3.cmml" xref="S2.SS2.p2.12.m12.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.12.m12.1c">x_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.12.m12.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is the value in row <math alttext="x_{j}" class="ltx_Math" display="inline" id="S2.SS2.p2.13.m13.1"><semantics id="S2.SS2.p2.13.m13.1a"><msub id="S2.SS2.p2.13.m13.1.1" xref="S2.SS2.p2.13.m13.1.1.cmml"><mi id="S2.SS2.p2.13.m13.1.1.2" xref="S2.SS2.p2.13.m13.1.1.2.cmml">x</mi><mi id="S2.SS2.p2.13.m13.1.1.3" xref="S2.SS2.p2.13.m13.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.13.m13.1b"><apply id="S2.SS2.p2.13.m13.1.1.cmml" xref="S2.SS2.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.13.m13.1.1.1.cmml" xref="S2.SS2.p2.13.m13.1.1">subscript</csymbol><ci id="S2.SS2.p2.13.m13.1.1.2.cmml" xref="S2.SS2.p2.13.m13.1.1.2">𝑥</ci><ci id="S2.SS2.p2.13.m13.1.1.3.cmml" xref="S2.SS2.p2.13.m13.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.13.m13.1c">x_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.13.m13.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> of the <math alttext="j" class="ltx_Math" display="inline" id="S2.SS2.p2.14.m14.1"><semantics id="S2.SS2.p2.14.m14.1a"><mi id="S2.SS2.p2.14.m14.1.1" xref="S2.SS2.p2.14.m14.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.14.m14.1b"><ci id="S2.SS2.p2.14.m14.1.1.cmml" xref="S2.SS2.p2.14.m14.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.14.m14.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.14.m14.1d">italic_j</annotation></semantics></math>-th lookup table, plus a bias term (i.e., <math alttext="e_{x_{j}}^{T}W_{j}+b_{j}" class="ltx_Math" display="inline" id="S2.SS2.p2.15.m15.1"><semantics id="S2.SS2.p2.15.m15.1a"><mrow id="S2.SS2.p2.15.m15.1.1" xref="S2.SS2.p2.15.m15.1.1.cmml"><mrow id="S2.SS2.p2.15.m15.1.1.2" xref="S2.SS2.p2.15.m15.1.1.2.cmml"><msubsup id="S2.SS2.p2.15.m15.1.1.2.2" xref="S2.SS2.p2.15.m15.1.1.2.2.cmml"><mi id="S2.SS2.p2.15.m15.1.1.2.2.2.2" xref="S2.SS2.p2.15.m15.1.1.2.2.2.2.cmml">e</mi><msub id="S2.SS2.p2.15.m15.1.1.2.2.2.3" xref="S2.SS2.p2.15.m15.1.1.2.2.2.3.cmml"><mi id="S2.SS2.p2.15.m15.1.1.2.2.2.3.2" xref="S2.SS2.p2.15.m15.1.1.2.2.2.3.2.cmml">x</mi><mi id="S2.SS2.p2.15.m15.1.1.2.2.2.3.3" xref="S2.SS2.p2.15.m15.1.1.2.2.2.3.3.cmml">j</mi></msub><mi id="S2.SS2.p2.15.m15.1.1.2.2.3" xref="S2.SS2.p2.15.m15.1.1.2.2.3.cmml">T</mi></msubsup><mo id="S2.SS2.p2.15.m15.1.1.2.1" xref="S2.SS2.p2.15.m15.1.1.2.1.cmml">⁢</mo><msub id="S2.SS2.p2.15.m15.1.1.2.3" xref="S2.SS2.p2.15.m15.1.1.2.3.cmml"><mi id="S2.SS2.p2.15.m15.1.1.2.3.2" xref="S2.SS2.p2.15.m15.1.1.2.3.2.cmml">W</mi><mi id="S2.SS2.p2.15.m15.1.1.2.3.3" xref="S2.SS2.p2.15.m15.1.1.2.3.3.cmml">j</mi></msub></mrow><mo id="S2.SS2.p2.15.m15.1.1.1" xref="S2.SS2.p2.15.m15.1.1.1.cmml">+</mo><msub id="S2.SS2.p2.15.m15.1.1.3" xref="S2.SS2.p2.15.m15.1.1.3.cmml"><mi id="S2.SS2.p2.15.m15.1.1.3.2" xref="S2.SS2.p2.15.m15.1.1.3.2.cmml">b</mi><mi id="S2.SS2.p2.15.m15.1.1.3.3" xref="S2.SS2.p2.15.m15.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.15.m15.1b"><apply id="S2.SS2.p2.15.m15.1.1.cmml" xref="S2.SS2.p2.15.m15.1.1"><plus id="S2.SS2.p2.15.m15.1.1.1.cmml" xref="S2.SS2.p2.15.m15.1.1.1"></plus><apply id="S2.SS2.p2.15.m15.1.1.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2"><times id="S2.SS2.p2.15.m15.1.1.2.1.cmml" xref="S2.SS2.p2.15.m15.1.1.2.1"></times><apply id="S2.SS2.p2.15.m15.1.1.2.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.1.1.2.2.1.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2">superscript</csymbol><apply id="S2.SS2.p2.15.m15.1.1.2.2.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.1.1.2.2.2.1.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2">subscript</csymbol><ci id="S2.SS2.p2.15.m15.1.1.2.2.2.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2.2.2">𝑒</ci><apply id="S2.SS2.p2.15.m15.1.1.2.2.2.3.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.1.1.2.2.2.3.1.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2.2.3">subscript</csymbol><ci id="S2.SS2.p2.15.m15.1.1.2.2.2.3.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2.2.3.2">𝑥</ci><ci id="S2.SS2.p2.15.m15.1.1.2.2.2.3.3.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.SS2.p2.15.m15.1.1.2.2.3.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2.3">𝑇</ci></apply><apply id="S2.SS2.p2.15.m15.1.1.2.3.cmml" xref="S2.SS2.p2.15.m15.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.1.1.2.3.1.cmml" xref="S2.SS2.p2.15.m15.1.1.2.3">subscript</csymbol><ci id="S2.SS2.p2.15.m15.1.1.2.3.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2.3.2">𝑊</ci><ci id="S2.SS2.p2.15.m15.1.1.2.3.3.cmml" xref="S2.SS2.p2.15.m15.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS2.p2.15.m15.1.1.3.cmml" xref="S2.SS2.p2.15.m15.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.1.1.3.1.cmml" xref="S2.SS2.p2.15.m15.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.15.m15.1.1.3.2.cmml" xref="S2.SS2.p2.15.m15.1.1.3.2">𝑏</ci><ci id="S2.SS2.p2.15.m15.1.1.3.3.cmml" xref="S2.SS2.p2.15.m15.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.15.m15.1c">e_{x_{j}}^{T}W_{j}+b_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.15.m15.1d">italic_e start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="e_{x_{j}}\in\mathbb{R}^{K_{j}}" class="ltx_Math" display="inline" id="S2.SS2.p2.16.m16.1"><semantics id="S2.SS2.p2.16.m16.1a"><mrow id="S2.SS2.p2.16.m16.1.1" xref="S2.SS2.p2.16.m16.1.1.cmml"><msub id="S2.SS2.p2.16.m16.1.1.2" xref="S2.SS2.p2.16.m16.1.1.2.cmml"><mi id="S2.SS2.p2.16.m16.1.1.2.2" xref="S2.SS2.p2.16.m16.1.1.2.2.cmml">e</mi><msub id="S2.SS2.p2.16.m16.1.1.2.3" xref="S2.SS2.p2.16.m16.1.1.2.3.cmml"><mi id="S2.SS2.p2.16.m16.1.1.2.3.2" xref="S2.SS2.p2.16.m16.1.1.2.3.2.cmml">x</mi><mi id="S2.SS2.p2.16.m16.1.1.2.3.3" xref="S2.SS2.p2.16.m16.1.1.2.3.3.cmml">j</mi></msub></msub><mo id="S2.SS2.p2.16.m16.1.1.1" xref="S2.SS2.p2.16.m16.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.16.m16.1.1.3" xref="S2.SS2.p2.16.m16.1.1.3.cmml"><mi id="S2.SS2.p2.16.m16.1.1.3.2" xref="S2.SS2.p2.16.m16.1.1.3.2.cmml">ℝ</mi><msub id="S2.SS2.p2.16.m16.1.1.3.3" xref="S2.SS2.p2.16.m16.1.1.3.3.cmml"><mi id="S2.SS2.p2.16.m16.1.1.3.3.2" xref="S2.SS2.p2.16.m16.1.1.3.3.2.cmml">K</mi><mi id="S2.SS2.p2.16.m16.1.1.3.3.3" xref="S2.SS2.p2.16.m16.1.1.3.3.3.cmml">j</mi></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.16.m16.1b"><apply id="S2.SS2.p2.16.m16.1.1.cmml" xref="S2.SS2.p2.16.m16.1.1"><in id="S2.SS2.p2.16.m16.1.1.1.cmml" xref="S2.SS2.p2.16.m16.1.1.1"></in><apply id="S2.SS2.p2.16.m16.1.1.2.cmml" xref="S2.SS2.p2.16.m16.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.16.m16.1.1.2.1.cmml" xref="S2.SS2.p2.16.m16.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.16.m16.1.1.2.2.cmml" xref="S2.SS2.p2.16.m16.1.1.2.2">𝑒</ci><apply id="S2.SS2.p2.16.m16.1.1.2.3.cmml" xref="S2.SS2.p2.16.m16.1.1.2.3"><csymbol cd="ambiguous" id="S2.SS2.p2.16.m16.1.1.2.3.1.cmml" xref="S2.SS2.p2.16.m16.1.1.2.3">subscript</csymbol><ci id="S2.SS2.p2.16.m16.1.1.2.3.2.cmml" xref="S2.SS2.p2.16.m16.1.1.2.3.2">𝑥</ci><ci id="S2.SS2.p2.16.m16.1.1.2.3.3.cmml" xref="S2.SS2.p2.16.m16.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.SS2.p2.16.m16.1.1.3.cmml" xref="S2.SS2.p2.16.m16.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.16.m16.1.1.3.1.cmml" xref="S2.SS2.p2.16.m16.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.16.m16.1.1.3.2.cmml" xref="S2.SS2.p2.16.m16.1.1.3.2">ℝ</ci><apply id="S2.SS2.p2.16.m16.1.1.3.3.cmml" xref="S2.SS2.p2.16.m16.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.16.m16.1.1.3.3.1.cmml" xref="S2.SS2.p2.16.m16.1.1.3.3">subscript</csymbol><ci id="S2.SS2.p2.16.m16.1.1.3.3.2.cmml" xref="S2.SS2.p2.16.m16.1.1.3.3.2">𝐾</ci><ci id="S2.SS2.p2.16.m16.1.1.3.3.3.cmml" xref="S2.SS2.p2.16.m16.1.1.3.3.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.16.m16.1c">e_{x_{j}}\in\mathbb{R}^{K_{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.16.m16.1d">italic_e start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is 1 at the <math alttext="x_{j}" class="ltx_Math" display="inline" id="S2.SS2.p2.17.m17.1"><semantics id="S2.SS2.p2.17.m17.1a"><msub id="S2.SS2.p2.17.m17.1.1" xref="S2.SS2.p2.17.m17.1.1.cmml"><mi id="S2.SS2.p2.17.m17.1.1.2" xref="S2.SS2.p2.17.m17.1.1.2.cmml">x</mi><mi id="S2.SS2.p2.17.m17.1.1.3" xref="S2.SS2.p2.17.m17.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.17.m17.1b"><apply id="S2.SS2.p2.17.m17.1.1.cmml" xref="S2.SS2.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.17.m17.1.1.1.cmml" xref="S2.SS2.p2.17.m17.1.1">subscript</csymbol><ci id="S2.SS2.p2.17.m17.1.1.2.cmml" xref="S2.SS2.p2.17.m17.1.1.2">𝑥</ci><ci id="S2.SS2.p2.17.m17.1.1.3.cmml" xref="S2.SS2.p2.17.m17.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.17.m17.1c">x_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.17.m17.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> coordinate and 0 elsewhere).
In summary, the token for <math alttext="x_{j}" class="ltx_Math" display="inline" id="S2.SS2.p2.18.m18.1"><semantics id="S2.SS2.p2.18.m18.1a"><msub id="S2.SS2.p2.18.m18.1.1" xref="S2.SS2.p2.18.m18.1.1.cmml"><mi id="S2.SS2.p2.18.m18.1.1.2" xref="S2.SS2.p2.18.m18.1.1.2.cmml">x</mi><mi id="S2.SS2.p2.18.m18.1.1.3" xref="S2.SS2.p2.18.m18.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.18.m18.1b"><apply id="S2.SS2.p2.18.m18.1.1.cmml" xref="S2.SS2.p2.18.m18.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.18.m18.1.1.1.cmml" xref="S2.SS2.p2.18.m18.1.1">subscript</csymbol><ci id="S2.SS2.p2.18.m18.1.1.2.cmml" xref="S2.SS2.p2.18.m18.1.1.2">𝑥</ci><ci id="S2.SS2.p2.18.m18.1.1.3.cmml" xref="S2.SS2.p2.18.m18.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.18.m18.1c">x_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.18.m18.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is given by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="T_{j}=\left\{\begin{array}[]{ll}x_{j}w_{j}+b_{j}&amp;\text{if }x_{j}\text{%
numerical}\\
e_{x_{j}}^{T}W_{j}+b_{j}&amp;\text{if }x_{j}\text{categorical}\end{array}\right.%
\in\mathbb{R}^{d}" class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.2" xref="S2.E1.m1.1.2.cmml"><msub id="S2.E1.m1.1.2.2" xref="S2.E1.m1.1.2.2.cmml"><mi id="S2.E1.m1.1.2.2.2" xref="S2.E1.m1.1.2.2.2.cmml">T</mi><mi id="S2.E1.m1.1.2.2.3" xref="S2.E1.m1.1.2.2.3.cmml">j</mi></msub><mo id="S2.E1.m1.1.2.3" xref="S2.E1.m1.1.2.3.cmml">=</mo><mrow id="S2.E1.m1.1.2.4.2" xref="S2.E1.m1.1.2.4.1.cmml"><mo id="S2.E1.m1.1.2.4.2.1" xref="S2.E1.m1.1.2.4.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S2.E1.m1.1.1" rowspacing="0pt" xref="S2.E1.m1.1.1.cmml"><mtr id="S2.E1.m1.1.1a" xref="S2.E1.m1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.1.1b" xref="S2.E1.m1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml"><msub id="S2.E1.m1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.2.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.1.1.1.1.1.2.2.2.cmml">x</mi><mi id="S2.E1.m1.1.1.1.1.1.2.2.3" xref="S2.E1.m1.1.1.1.1.1.2.2.3.cmml">j</mi></msub><mo id="S2.E1.m1.1.1.1.1.1.2.1" xref="S2.E1.m1.1.1.1.1.1.2.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.2.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.2.3.2" xref="S2.E1.m1.1.1.1.1.1.2.3.2.cmml">w</mi><mi id="S2.E1.m1.1.1.1.1.1.2.3.3" xref="S2.E1.m1.1.1.1.1.1.2.3.3.cmml">j</mi></msub></mrow><mo id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml">+</mo><msub id="S2.E1.m1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S2.E1.m1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.1.1c" xref="S2.E1.m1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.2.1" xref="S2.E1.m1.1.1.1.2.1.cmml"><mtext id="S2.E1.m1.1.1.1.2.1.2" xref="S2.E1.m1.1.1.1.2.1.2a.cmml">if </mtext><mo id="S2.E1.m1.1.1.1.2.1.1" xref="S2.E1.m1.1.1.1.2.1.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.1.2.1.3" xref="S2.E1.m1.1.1.1.2.1.3.cmml"><mi id="S2.E1.m1.1.1.1.2.1.3.2" xref="S2.E1.m1.1.1.1.2.1.3.2.cmml">x</mi><mi id="S2.E1.m1.1.1.1.2.1.3.3" xref="S2.E1.m1.1.1.1.2.1.3.3.cmml">j</mi></msub><mo id="S2.E1.m1.1.1.1.2.1.1a" xref="S2.E1.m1.1.1.1.2.1.1.cmml">⁢</mo><mtext id="S2.E1.m1.1.1.1.2.1.4" xref="S2.E1.m1.1.1.1.2.1.4a.cmml">numerical</mtext></mrow></mtd></mtr><mtr id="S2.E1.m1.1.1d" xref="S2.E1.m1.1.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.1.1e" xref="S2.E1.m1.1.1.cmml"><mrow id="S2.E1.m1.1.1.2.1.1" xref="S2.E1.m1.1.1.2.1.1.cmml"><mrow id="S2.E1.m1.1.1.2.1.1.2" xref="S2.E1.m1.1.1.2.1.1.2.cmml"><msubsup id="S2.E1.m1.1.1.2.1.1.2.2" xref="S2.E1.m1.1.1.2.1.1.2.2.cmml"><mi id="S2.E1.m1.1.1.2.1.1.2.2.2.2" xref="S2.E1.m1.1.1.2.1.1.2.2.2.2.cmml">e</mi><msub id="S2.E1.m1.1.1.2.1.1.2.2.2.3" xref="S2.E1.m1.1.1.2.1.1.2.2.2.3.cmml"><mi id="S2.E1.m1.1.1.2.1.1.2.2.2.3.2" xref="S2.E1.m1.1.1.2.1.1.2.2.2.3.2.cmml">x</mi><mi id="S2.E1.m1.1.1.2.1.1.2.2.2.3.3" xref="S2.E1.m1.1.1.2.1.1.2.2.2.3.3.cmml">j</mi></msub><mi id="S2.E1.m1.1.1.2.1.1.2.2.3" xref="S2.E1.m1.1.1.2.1.1.2.2.3.cmml">T</mi></msubsup><mo id="S2.E1.m1.1.1.2.1.1.2.1" xref="S2.E1.m1.1.1.2.1.1.2.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.2.1.1.2.3" xref="S2.E1.m1.1.1.2.1.1.2.3.cmml"><mi id="S2.E1.m1.1.1.2.1.1.2.3.2" xref="S2.E1.m1.1.1.2.1.1.2.3.2.cmml">W</mi><mi id="S2.E1.m1.1.1.2.1.1.2.3.3" xref="S2.E1.m1.1.1.2.1.1.2.3.3.cmml">j</mi></msub></mrow><mo id="S2.E1.m1.1.1.2.1.1.1" xref="S2.E1.m1.1.1.2.1.1.1.cmml">+</mo><msub id="S2.E1.m1.1.1.2.1.1.3" xref="S2.E1.m1.1.1.2.1.1.3.cmml"><mi id="S2.E1.m1.1.1.2.1.1.3.2" xref="S2.E1.m1.1.1.2.1.1.3.2.cmml">b</mi><mi id="S2.E1.m1.1.1.2.1.1.3.3" xref="S2.E1.m1.1.1.2.1.1.3.3.cmml">j</mi></msub></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.E1.m1.1.1f" xref="S2.E1.m1.1.1.cmml"><mrow id="S2.E1.m1.1.1.2.2.1" xref="S2.E1.m1.1.1.2.2.1.cmml"><mtext id="S2.E1.m1.1.1.2.2.1.2" xref="S2.E1.m1.1.1.2.2.1.2a.cmml">if </mtext><mo id="S2.E1.m1.1.1.2.2.1.1" xref="S2.E1.m1.1.1.2.2.1.1.cmml">⁢</mo><msub id="S2.E1.m1.1.1.2.2.1.3" xref="S2.E1.m1.1.1.2.2.1.3.cmml"><mi id="S2.E1.m1.1.1.2.2.1.3.2" xref="S2.E1.m1.1.1.2.2.1.3.2.cmml">x</mi><mi id="S2.E1.m1.1.1.2.2.1.3.3" xref="S2.E1.m1.1.1.2.2.1.3.3.cmml">j</mi></msub><mo id="S2.E1.m1.1.1.2.2.1.1a" xref="S2.E1.m1.1.1.2.2.1.1.cmml">⁢</mo><mtext id="S2.E1.m1.1.1.2.2.1.4" xref="S2.E1.m1.1.1.2.2.1.4a.cmml">categorical</mtext></mrow></mtd></mtr></mtable><mi id="S2.E1.m1.1.2.4.2.2" xref="S2.E1.m1.1.2.4.1.1.cmml"></mi></mrow><mo id="S2.E1.m1.1.2.5" xref="S2.E1.m1.1.2.5.cmml">∈</mo><msup id="S2.E1.m1.1.2.6" xref="S2.E1.m1.1.2.6.cmml"><mi id="S2.E1.m1.1.2.6.2" xref="S2.E1.m1.1.2.6.2.cmml">ℝ</mi><mi id="S2.E1.m1.1.2.6.3" xref="S2.E1.m1.1.2.6.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.2.cmml" xref="S2.E1.m1.1.2"><and id="S2.E1.m1.1.2a.cmml" xref="S2.E1.m1.1.2"></and><apply id="S2.E1.m1.1.2b.cmml" xref="S2.E1.m1.1.2"><eq id="S2.E1.m1.1.2.3.cmml" xref="S2.E1.m1.1.2.3"></eq><apply id="S2.E1.m1.1.2.2.cmml" xref="S2.E1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.2.2.1.cmml" xref="S2.E1.m1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.1.2.2.2.cmml" xref="S2.E1.m1.1.2.2.2">𝑇</ci><ci id="S2.E1.m1.1.2.2.3.cmml" xref="S2.E1.m1.1.2.2.3">𝑗</ci></apply><apply id="S2.E1.m1.1.2.4.1.cmml" xref="S2.E1.m1.1.2.4.2"><csymbol cd="latexml" id="S2.E1.m1.1.2.4.1.1.cmml" xref="S2.E1.m1.1.2.4.2.1">cases</csymbol><matrix id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1"><matrixrow id="S2.E1.m1.1.1a.cmml" xref="S2.E1.m1.1.1"><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><plus id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"></plus><apply id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2"><times id="S2.E1.m1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2.1"></times><apply id="S2.E1.m1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2.2">𝑥</ci><ci id="S2.E1.m1.1.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2.3">𝑗</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.2">𝑤</ci><ci id="S2.E1.m1.1.1.1.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.3.2">𝑏</ci><ci id="S2.E1.m1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.2.1"><times id="S2.E1.m1.1.1.1.2.1.1.cmml" xref="S2.E1.m1.1.1.1.2.1.1"></times><ci id="S2.E1.m1.1.1.1.2.1.2a.cmml" xref="S2.E1.m1.1.1.1.2.1.2"><mtext id="S2.E1.m1.1.1.1.2.1.2.cmml" xref="S2.E1.m1.1.1.1.2.1.2">if </mtext></ci><apply id="S2.E1.m1.1.1.1.2.1.3.cmml" xref="S2.E1.m1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.2.1.3.1.cmml" xref="S2.E1.m1.1.1.1.2.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.2.1.3.2.cmml" xref="S2.E1.m1.1.1.1.2.1.3.2">𝑥</ci><ci id="S2.E1.m1.1.1.1.2.1.3.3.cmml" xref="S2.E1.m1.1.1.1.2.1.3.3">𝑗</ci></apply><ci id="S2.E1.m1.1.1.1.2.1.4a.cmml" xref="S2.E1.m1.1.1.1.2.1.4"><mtext id="S2.E1.m1.1.1.1.2.1.4.cmml" xref="S2.E1.m1.1.1.1.2.1.4">numerical</mtext></ci></apply></matrixrow><matrixrow id="S2.E1.m1.1.1b.cmml" xref="S2.E1.m1.1.1"><apply id="S2.E1.m1.1.1.2.1.1.cmml" xref="S2.E1.m1.1.1.2.1.1"><plus id="S2.E1.m1.1.1.2.1.1.1.cmml" xref="S2.E1.m1.1.1.2.1.1.1"></plus><apply id="S2.E1.m1.1.1.2.1.1.2.cmml" xref="S2.E1.m1.1.1.2.1.1.2"><times id="S2.E1.m1.1.1.2.1.1.2.1.cmml" xref="S2.E1.m1.1.1.2.1.1.2.1"></times><apply id="S2.E1.m1.1.1.2.1.1.2.2.cmml" xref="S2.E1.m1.1.1.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.1.1.2.2.1.cmml" xref="S2.E1.m1.1.1.2.1.1.2.2">superscript</csymbol><apply id="S2.E1.m1.1.1.2.1.1.2.2.2.cmml" xref="S2.E1.m1.1.1.2.1.1.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.1.1.2.2.2.1.cmml" xref="S2.E1.m1.1.1.2.1.1.2.2">subscript</csymbol><ci id="S2.E1.m1.1.1.2.1.1.2.2.2.2.cmml" xref="S2.E1.m1.1.1.2.1.1.2.2.2.2">𝑒</ci><apply id="S2.E1.m1.1.1.2.1.1.2.2.2.3.cmml" xref="S2.E1.m1.1.1.2.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.1.1.2.2.2.3.1.cmml" xref="S2.E1.m1.1.1.2.1.1.2.2.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.2.1.1.2.2.2.3.2.cmml" xref="S2.E1.m1.1.1.2.1.1.2.2.2.3.2">𝑥</ci><ci id="S2.E1.m1.1.1.2.1.1.2.2.2.3.3.cmml" xref="S2.E1.m1.1.1.2.1.1.2.2.2.3.3">𝑗</ci></apply></apply><ci id="S2.E1.m1.1.1.2.1.1.2.2.3.cmml" xref="S2.E1.m1.1.1.2.1.1.2.2.3">𝑇</ci></apply><apply id="S2.E1.m1.1.1.2.1.1.2.3.cmml" xref="S2.E1.m1.1.1.2.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.1.1.2.3.1.cmml" xref="S2.E1.m1.1.1.2.1.1.2.3">subscript</csymbol><ci id="S2.E1.m1.1.1.2.1.1.2.3.2.cmml" xref="S2.E1.m1.1.1.2.1.1.2.3.2">𝑊</ci><ci id="S2.E1.m1.1.1.2.1.1.2.3.3.cmml" xref="S2.E1.m1.1.1.2.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.1.1.2.1.1.3.cmml" xref="S2.E1.m1.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.1.1.3.1.cmml" xref="S2.E1.m1.1.1.2.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.2.1.1.3.2.cmml" xref="S2.E1.m1.1.1.2.1.1.3.2">𝑏</ci><ci id="S2.E1.m1.1.1.2.1.1.3.3.cmml" xref="S2.E1.m1.1.1.2.1.1.3.3">𝑗</ci></apply></apply><apply id="S2.E1.m1.1.1.2.2.1.cmml" xref="S2.E1.m1.1.1.2.2.1"><times id="S2.E1.m1.1.1.2.2.1.1.cmml" xref="S2.E1.m1.1.1.2.2.1.1"></times><ci id="S2.E1.m1.1.1.2.2.1.2a.cmml" xref="S2.E1.m1.1.1.2.2.1.2"><mtext id="S2.E1.m1.1.1.2.2.1.2.cmml" xref="S2.E1.m1.1.1.2.2.1.2">if </mtext></ci><apply id="S2.E1.m1.1.1.2.2.1.3.cmml" xref="S2.E1.m1.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.2.2.1.3.1.cmml" xref="S2.E1.m1.1.1.2.2.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.2.2.1.3.2.cmml" xref="S2.E1.m1.1.1.2.2.1.3.2">𝑥</ci><ci id="S2.E1.m1.1.1.2.2.1.3.3.cmml" xref="S2.E1.m1.1.1.2.2.1.3.3">𝑗</ci></apply><ci id="S2.E1.m1.1.1.2.2.1.4a.cmml" xref="S2.E1.m1.1.1.2.2.1.4"><mtext id="S2.E1.m1.1.1.2.2.1.4.cmml" xref="S2.E1.m1.1.1.2.2.1.4">categorical</mtext></ci></apply></matrixrow></matrix></apply></apply><apply id="S2.E1.m1.1.2c.cmml" xref="S2.E1.m1.1.2"><in id="S2.E1.m1.1.2.5.cmml" xref="S2.E1.m1.1.2.5"></in><share href="https://arxiv.org/html/2409.17165v1#S2.E1.m1.1.2.4.cmml" id="S2.E1.m1.1.2d.cmml" xref="S2.E1.m1.1.2"></share><apply id="S2.E1.m1.1.2.6.cmml" xref="S2.E1.m1.1.2.6"><csymbol cd="ambiguous" id="S2.E1.m1.1.2.6.1.cmml" xref="S2.E1.m1.1.2.6">superscript</csymbol><ci id="S2.E1.m1.1.2.6.2.cmml" xref="S2.E1.m1.1.2.6.2">ℝ</ci><ci id="S2.E1.m1.1.2.6.3.cmml" xref="S2.E1.m1.1.2.6.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">T_{j}=\left\{\begin{array}[]{ll}x_{j}w_{j}+b_{j}&amp;\text{if }x_{j}\text{%
numerical}\\
e_{x_{j}}^{T}W_{j}+b_{j}&amp;\text{if }x_{j}\text{categorical}\end{array}\right.%
\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">italic_T start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = { start_ARRAY start_ROW start_CELL italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_CELL start_CELL if italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT numerical end_CELL end_ROW start_ROW start_CELL italic_e start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_W start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_CELL start_CELL if italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT categorical end_CELL end_ROW end_ARRAY ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p2.24">where <math alttext="w_{j},b_{j}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S2.SS2.p2.19.m1.2"><semantics id="S2.SS2.p2.19.m1.2a"><mrow id="S2.SS2.p2.19.m1.2.2" xref="S2.SS2.p2.19.m1.2.2.cmml"><mrow id="S2.SS2.p2.19.m1.2.2.2.2" xref="S2.SS2.p2.19.m1.2.2.2.3.cmml"><msub id="S2.SS2.p2.19.m1.1.1.1.1.1" xref="S2.SS2.p2.19.m1.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.19.m1.1.1.1.1.1.2" xref="S2.SS2.p2.19.m1.1.1.1.1.1.2.cmml">w</mi><mi id="S2.SS2.p2.19.m1.1.1.1.1.1.3" xref="S2.SS2.p2.19.m1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S2.SS2.p2.19.m1.2.2.2.2.3" xref="S2.SS2.p2.19.m1.2.2.2.3.cmml">,</mo><msub id="S2.SS2.p2.19.m1.2.2.2.2.2" xref="S2.SS2.p2.19.m1.2.2.2.2.2.cmml"><mi id="S2.SS2.p2.19.m1.2.2.2.2.2.2" xref="S2.SS2.p2.19.m1.2.2.2.2.2.2.cmml">b</mi><mi id="S2.SS2.p2.19.m1.2.2.2.2.2.3" xref="S2.SS2.p2.19.m1.2.2.2.2.2.3.cmml">j</mi></msub></mrow><mo id="S2.SS2.p2.19.m1.2.2.3" xref="S2.SS2.p2.19.m1.2.2.3.cmml">∈</mo><msup id="S2.SS2.p2.19.m1.2.2.4" xref="S2.SS2.p2.19.m1.2.2.4.cmml"><mi id="S2.SS2.p2.19.m1.2.2.4.2" xref="S2.SS2.p2.19.m1.2.2.4.2.cmml">ℝ</mi><mi id="S2.SS2.p2.19.m1.2.2.4.3" xref="S2.SS2.p2.19.m1.2.2.4.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.19.m1.2b"><apply id="S2.SS2.p2.19.m1.2.2.cmml" xref="S2.SS2.p2.19.m1.2.2"><in id="S2.SS2.p2.19.m1.2.2.3.cmml" xref="S2.SS2.p2.19.m1.2.2.3"></in><list id="S2.SS2.p2.19.m1.2.2.2.3.cmml" xref="S2.SS2.p2.19.m1.2.2.2.2"><apply id="S2.SS2.p2.19.m1.1.1.1.1.1.cmml" xref="S2.SS2.p2.19.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.19.m1.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.19.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS2.p2.19.m1.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.19.m1.1.1.1.1.1.2">𝑤</ci><ci id="S2.SS2.p2.19.m1.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.19.m1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S2.SS2.p2.19.m1.2.2.2.2.2.cmml" xref="S2.SS2.p2.19.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.19.m1.2.2.2.2.2.1.cmml" xref="S2.SS2.p2.19.m1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS2.p2.19.m1.2.2.2.2.2.2.cmml" xref="S2.SS2.p2.19.m1.2.2.2.2.2.2">𝑏</ci><ci id="S2.SS2.p2.19.m1.2.2.2.2.2.3.cmml" xref="S2.SS2.p2.19.m1.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="S2.SS2.p2.19.m1.2.2.4.cmml" xref="S2.SS2.p2.19.m1.2.2.4"><csymbol cd="ambiguous" id="S2.SS2.p2.19.m1.2.2.4.1.cmml" xref="S2.SS2.p2.19.m1.2.2.4">superscript</csymbol><ci id="S2.SS2.p2.19.m1.2.2.4.2.cmml" xref="S2.SS2.p2.19.m1.2.2.4.2">ℝ</ci><ci id="S2.SS2.p2.19.m1.2.2.4.3.cmml" xref="S2.SS2.p2.19.m1.2.2.4.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.19.m1.2c">w_{j},b_{j}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.19.m1.2d">italic_w start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_b start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="W_{j}\in\mathbb{R}^{K_{j}\times d}" class="ltx_Math" display="inline" id="S2.SS2.p2.20.m2.1"><semantics id="S2.SS2.p2.20.m2.1a"><mrow id="S2.SS2.p2.20.m2.1.1" xref="S2.SS2.p2.20.m2.1.1.cmml"><msub id="S2.SS2.p2.20.m2.1.1.2" xref="S2.SS2.p2.20.m2.1.1.2.cmml"><mi id="S2.SS2.p2.20.m2.1.1.2.2" xref="S2.SS2.p2.20.m2.1.1.2.2.cmml">W</mi><mi id="S2.SS2.p2.20.m2.1.1.2.3" xref="S2.SS2.p2.20.m2.1.1.2.3.cmml">j</mi></msub><mo id="S2.SS2.p2.20.m2.1.1.1" xref="S2.SS2.p2.20.m2.1.1.1.cmml">∈</mo><msup id="S2.SS2.p2.20.m2.1.1.3" xref="S2.SS2.p2.20.m2.1.1.3.cmml"><mi id="S2.SS2.p2.20.m2.1.1.3.2" xref="S2.SS2.p2.20.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.SS2.p2.20.m2.1.1.3.3" xref="S2.SS2.p2.20.m2.1.1.3.3.cmml"><msub id="S2.SS2.p2.20.m2.1.1.3.3.2" xref="S2.SS2.p2.20.m2.1.1.3.3.2.cmml"><mi id="S2.SS2.p2.20.m2.1.1.3.3.2.2" xref="S2.SS2.p2.20.m2.1.1.3.3.2.2.cmml">K</mi><mi id="S2.SS2.p2.20.m2.1.1.3.3.2.3" xref="S2.SS2.p2.20.m2.1.1.3.3.2.3.cmml">j</mi></msub><mo id="S2.SS2.p2.20.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.SS2.p2.20.m2.1.1.3.3.1.cmml">×</mo><mi id="S2.SS2.p2.20.m2.1.1.3.3.3" xref="S2.SS2.p2.20.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.20.m2.1b"><apply id="S2.SS2.p2.20.m2.1.1.cmml" xref="S2.SS2.p2.20.m2.1.1"><in id="S2.SS2.p2.20.m2.1.1.1.cmml" xref="S2.SS2.p2.20.m2.1.1.1"></in><apply id="S2.SS2.p2.20.m2.1.1.2.cmml" xref="S2.SS2.p2.20.m2.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.20.m2.1.1.2.1.cmml" xref="S2.SS2.p2.20.m2.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.20.m2.1.1.2.2.cmml" xref="S2.SS2.p2.20.m2.1.1.2.2">𝑊</ci><ci id="S2.SS2.p2.20.m2.1.1.2.3.cmml" xref="S2.SS2.p2.20.m2.1.1.2.3">𝑗</ci></apply><apply id="S2.SS2.p2.20.m2.1.1.3.cmml" xref="S2.SS2.p2.20.m2.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.20.m2.1.1.3.1.cmml" xref="S2.SS2.p2.20.m2.1.1.3">superscript</csymbol><ci id="S2.SS2.p2.20.m2.1.1.3.2.cmml" xref="S2.SS2.p2.20.m2.1.1.3.2">ℝ</ci><apply id="S2.SS2.p2.20.m2.1.1.3.3.cmml" xref="S2.SS2.p2.20.m2.1.1.3.3"><times id="S2.SS2.p2.20.m2.1.1.3.3.1.cmml" xref="S2.SS2.p2.20.m2.1.1.3.3.1"></times><apply id="S2.SS2.p2.20.m2.1.1.3.3.2.cmml" xref="S2.SS2.p2.20.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.20.m2.1.1.3.3.2.1.cmml" xref="S2.SS2.p2.20.m2.1.1.3.3.2">subscript</csymbol><ci id="S2.SS2.p2.20.m2.1.1.3.3.2.2.cmml" xref="S2.SS2.p2.20.m2.1.1.3.3.2.2">𝐾</ci><ci id="S2.SS2.p2.20.m2.1.1.3.3.2.3.cmml" xref="S2.SS2.p2.20.m2.1.1.3.3.2.3">𝑗</ci></apply><ci id="S2.SS2.p2.20.m2.1.1.3.3.3.cmml" xref="S2.SS2.p2.20.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.20.m2.1c">W_{j}\in\mathbb{R}^{K_{j}\times d}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.20.m2.1d">italic_W start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_K start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> are all trainable parameters.
Since the tokenizer produces a single embedding vector to represent all of <math alttext="x" class="ltx_Math" display="inline" id="S2.SS2.p2.21.m3.1"><semantics id="S2.SS2.p2.21.m3.1a"><mi id="S2.SS2.p2.21.m3.1.1" xref="S2.SS2.p2.21.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.21.m3.1b"><ci id="S2.SS2.p2.21.m3.1.1.cmml" xref="S2.SS2.p2.21.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.21.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.21.m3.1d">italic_x</annotation></semantics></math> after passing through the embedding layers (either Mamba or Transformer layers), we introduce a final numeric value of 1 and obtain its token (acting as the <math alttext="[CLS]" class="ltx_Math" display="inline" id="S2.SS2.p2.22.m4.1"><semantics id="S2.SS2.p2.22.m4.1a"><mrow id="S2.SS2.p2.22.m4.1.1.1" xref="S2.SS2.p2.22.m4.1.1.2.cmml"><mo id="S2.SS2.p2.22.m4.1.1.1.2" stretchy="false" xref="S2.SS2.p2.22.m4.1.1.2.1.cmml">[</mo><mrow id="S2.SS2.p2.22.m4.1.1.1.1" xref="S2.SS2.p2.22.m4.1.1.1.1.cmml"><mi id="S2.SS2.p2.22.m4.1.1.1.1.2" xref="S2.SS2.p2.22.m4.1.1.1.1.2.cmml">C</mi><mo id="S2.SS2.p2.22.m4.1.1.1.1.1" xref="S2.SS2.p2.22.m4.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p2.22.m4.1.1.1.1.3" xref="S2.SS2.p2.22.m4.1.1.1.1.3.cmml">L</mi><mo id="S2.SS2.p2.22.m4.1.1.1.1.1a" xref="S2.SS2.p2.22.m4.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p2.22.m4.1.1.1.1.4" xref="S2.SS2.p2.22.m4.1.1.1.1.4.cmml">S</mi></mrow><mo id="S2.SS2.p2.22.m4.1.1.1.3" stretchy="false" xref="S2.SS2.p2.22.m4.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.22.m4.1b"><apply id="S2.SS2.p2.22.m4.1.1.2.cmml" xref="S2.SS2.p2.22.m4.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.22.m4.1.1.2.1.cmml" xref="S2.SS2.p2.22.m4.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p2.22.m4.1.1.1.1.cmml" xref="S2.SS2.p2.22.m4.1.1.1.1"><times id="S2.SS2.p2.22.m4.1.1.1.1.1.cmml" xref="S2.SS2.p2.22.m4.1.1.1.1.1"></times><ci id="S2.SS2.p2.22.m4.1.1.1.1.2.cmml" xref="S2.SS2.p2.22.m4.1.1.1.1.2">𝐶</ci><ci id="S2.SS2.p2.22.m4.1.1.1.1.3.cmml" xref="S2.SS2.p2.22.m4.1.1.1.1.3">𝐿</ci><ci id="S2.SS2.p2.22.m4.1.1.1.1.4.cmml" xref="S2.SS2.p2.22.m4.1.1.1.1.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.22.m4.1c">[CLS]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.22.m4.1d">[ italic_C italic_L italic_S ]</annotation></semantics></math> token <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib17" title="">17</a>]</cite>), denoted by <math alttext="T_{[CLS]}=w_{k+1}+b_{k+1}" class="ltx_Math" display="inline" id="S2.SS2.p2.23.m5.1"><semantics id="S2.SS2.p2.23.m5.1a"><mrow id="S2.SS2.p2.23.m5.1.2" xref="S2.SS2.p2.23.m5.1.2.cmml"><msub id="S2.SS2.p2.23.m5.1.2.2" xref="S2.SS2.p2.23.m5.1.2.2.cmml"><mi id="S2.SS2.p2.23.m5.1.2.2.2" xref="S2.SS2.p2.23.m5.1.2.2.2.cmml">T</mi><mrow id="S2.SS2.p2.23.m5.1.1.1.1" xref="S2.SS2.p2.23.m5.1.1.1.2.cmml"><mo id="S2.SS2.p2.23.m5.1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.23.m5.1.1.1.2.1.cmml">[</mo><mrow id="S2.SS2.p2.23.m5.1.1.1.1.1" xref="S2.SS2.p2.23.m5.1.1.1.1.1.cmml"><mi id="S2.SS2.p2.23.m5.1.1.1.1.1.2" xref="S2.SS2.p2.23.m5.1.1.1.1.1.2.cmml">C</mi><mo id="S2.SS2.p2.23.m5.1.1.1.1.1.1" xref="S2.SS2.p2.23.m5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p2.23.m5.1.1.1.1.1.3" xref="S2.SS2.p2.23.m5.1.1.1.1.1.3.cmml">L</mi><mo id="S2.SS2.p2.23.m5.1.1.1.1.1.1a" xref="S2.SS2.p2.23.m5.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p2.23.m5.1.1.1.1.1.4" xref="S2.SS2.p2.23.m5.1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S2.SS2.p2.23.m5.1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.23.m5.1.1.1.2.1.cmml">]</mo></mrow></msub><mo id="S2.SS2.p2.23.m5.1.2.1" xref="S2.SS2.p2.23.m5.1.2.1.cmml">=</mo><mrow id="S2.SS2.p2.23.m5.1.2.3" xref="S2.SS2.p2.23.m5.1.2.3.cmml"><msub id="S2.SS2.p2.23.m5.1.2.3.2" xref="S2.SS2.p2.23.m5.1.2.3.2.cmml"><mi id="S2.SS2.p2.23.m5.1.2.3.2.2" xref="S2.SS2.p2.23.m5.1.2.3.2.2.cmml">w</mi><mrow id="S2.SS2.p2.23.m5.1.2.3.2.3" xref="S2.SS2.p2.23.m5.1.2.3.2.3.cmml"><mi id="S2.SS2.p2.23.m5.1.2.3.2.3.2" xref="S2.SS2.p2.23.m5.1.2.3.2.3.2.cmml">k</mi><mo id="S2.SS2.p2.23.m5.1.2.3.2.3.1" xref="S2.SS2.p2.23.m5.1.2.3.2.3.1.cmml">+</mo><mn id="S2.SS2.p2.23.m5.1.2.3.2.3.3" xref="S2.SS2.p2.23.m5.1.2.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S2.SS2.p2.23.m5.1.2.3.1" xref="S2.SS2.p2.23.m5.1.2.3.1.cmml">+</mo><msub id="S2.SS2.p2.23.m5.1.2.3.3" xref="S2.SS2.p2.23.m5.1.2.3.3.cmml"><mi id="S2.SS2.p2.23.m5.1.2.3.3.2" xref="S2.SS2.p2.23.m5.1.2.3.3.2.cmml">b</mi><mrow id="S2.SS2.p2.23.m5.1.2.3.3.3" xref="S2.SS2.p2.23.m5.1.2.3.3.3.cmml"><mi id="S2.SS2.p2.23.m5.1.2.3.3.3.2" xref="S2.SS2.p2.23.m5.1.2.3.3.3.2.cmml">k</mi><mo id="S2.SS2.p2.23.m5.1.2.3.3.3.1" xref="S2.SS2.p2.23.m5.1.2.3.3.3.1.cmml">+</mo><mn id="S2.SS2.p2.23.m5.1.2.3.3.3.3" xref="S2.SS2.p2.23.m5.1.2.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.23.m5.1b"><apply id="S2.SS2.p2.23.m5.1.2.cmml" xref="S2.SS2.p2.23.m5.1.2"><eq id="S2.SS2.p2.23.m5.1.2.1.cmml" xref="S2.SS2.p2.23.m5.1.2.1"></eq><apply id="S2.SS2.p2.23.m5.1.2.2.cmml" xref="S2.SS2.p2.23.m5.1.2.2"><csymbol cd="ambiguous" id="S2.SS2.p2.23.m5.1.2.2.1.cmml" xref="S2.SS2.p2.23.m5.1.2.2">subscript</csymbol><ci id="S2.SS2.p2.23.m5.1.2.2.2.cmml" xref="S2.SS2.p2.23.m5.1.2.2.2">𝑇</ci><apply id="S2.SS2.p2.23.m5.1.1.1.2.cmml" xref="S2.SS2.p2.23.m5.1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.23.m5.1.1.1.2.1.cmml" xref="S2.SS2.p2.23.m5.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p2.23.m5.1.1.1.1.1.cmml" xref="S2.SS2.p2.23.m5.1.1.1.1.1"><times id="S2.SS2.p2.23.m5.1.1.1.1.1.1.cmml" xref="S2.SS2.p2.23.m5.1.1.1.1.1.1"></times><ci id="S2.SS2.p2.23.m5.1.1.1.1.1.2.cmml" xref="S2.SS2.p2.23.m5.1.1.1.1.1.2">𝐶</ci><ci id="S2.SS2.p2.23.m5.1.1.1.1.1.3.cmml" xref="S2.SS2.p2.23.m5.1.1.1.1.1.3">𝐿</ci><ci id="S2.SS2.p2.23.m5.1.1.1.1.1.4.cmml" xref="S2.SS2.p2.23.m5.1.1.1.1.1.4">𝑆</ci></apply></apply></apply><apply id="S2.SS2.p2.23.m5.1.2.3.cmml" xref="S2.SS2.p2.23.m5.1.2.3"><plus id="S2.SS2.p2.23.m5.1.2.3.1.cmml" xref="S2.SS2.p2.23.m5.1.2.3.1"></plus><apply id="S2.SS2.p2.23.m5.1.2.3.2.cmml" xref="S2.SS2.p2.23.m5.1.2.3.2"><csymbol cd="ambiguous" id="S2.SS2.p2.23.m5.1.2.3.2.1.cmml" xref="S2.SS2.p2.23.m5.1.2.3.2">subscript</csymbol><ci id="S2.SS2.p2.23.m5.1.2.3.2.2.cmml" xref="S2.SS2.p2.23.m5.1.2.3.2.2">𝑤</ci><apply id="S2.SS2.p2.23.m5.1.2.3.2.3.cmml" xref="S2.SS2.p2.23.m5.1.2.3.2.3"><plus id="S2.SS2.p2.23.m5.1.2.3.2.3.1.cmml" xref="S2.SS2.p2.23.m5.1.2.3.2.3.1"></plus><ci id="S2.SS2.p2.23.m5.1.2.3.2.3.2.cmml" xref="S2.SS2.p2.23.m5.1.2.3.2.3.2">𝑘</ci><cn id="S2.SS2.p2.23.m5.1.2.3.2.3.3.cmml" type="integer" xref="S2.SS2.p2.23.m5.1.2.3.2.3.3">1</cn></apply></apply><apply id="S2.SS2.p2.23.m5.1.2.3.3.cmml" xref="S2.SS2.p2.23.m5.1.2.3.3"><csymbol cd="ambiguous" id="S2.SS2.p2.23.m5.1.2.3.3.1.cmml" xref="S2.SS2.p2.23.m5.1.2.3.3">subscript</csymbol><ci id="S2.SS2.p2.23.m5.1.2.3.3.2.cmml" xref="S2.SS2.p2.23.m5.1.2.3.3.2">𝑏</ci><apply id="S2.SS2.p2.23.m5.1.2.3.3.3.cmml" xref="S2.SS2.p2.23.m5.1.2.3.3.3"><plus id="S2.SS2.p2.23.m5.1.2.3.3.3.1.cmml" xref="S2.SS2.p2.23.m5.1.2.3.3.3.1"></plus><ci id="S2.SS2.p2.23.m5.1.2.3.3.3.2.cmml" xref="S2.SS2.p2.23.m5.1.2.3.3.3.2">𝑘</ci><cn id="S2.SS2.p2.23.m5.1.2.3.3.3.3.cmml" type="integer" xref="S2.SS2.p2.23.m5.1.2.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.23.m5.1c">T_{[CLS]}=w_{k+1}+b_{k+1}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.23.m5.1d">italic_T start_POSTSUBSCRIPT [ italic_C italic_L italic_S ] end_POSTSUBSCRIPT = italic_w start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT + italic_b start_POSTSUBSCRIPT italic_k + 1 end_POSTSUBSCRIPT</annotation></semantics></math>.
Finally, the representation of <math alttext="x" class="ltx_Math" display="inline" id="S2.SS2.p2.24.m6.1"><semantics id="S2.SS2.p2.24.m6.1a"><mi id="S2.SS2.p2.24.m6.1.1" xref="S2.SS2.p2.24.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.24.m6.1b"><ci id="S2.SS2.p2.24.m6.1.1.cmml" xref="S2.SS2.p2.24.m6.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.24.m6.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.24.m6.1d">italic_x</annotation></semantics></math> in tokens is given by</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="T=\text{stack}\Big{[}T_{1},...,T_{k},T_{[CLS]}\Big{]}." class="ltx_Math" display="block" id="S2.E2.m1.3"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.5" xref="S2.E2.m1.3.3.1.1.5.cmml">T</mi><mo id="S2.E2.m1.3.3.1.1.4" xref="S2.E2.m1.3.3.1.1.4.cmml">=</mo><mrow id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml"><mtext id="S2.E2.m1.3.3.1.1.3.5" xref="S2.E2.m1.3.3.1.1.3.5a.cmml">stack</mtext><mo id="S2.E2.m1.3.3.1.1.3.4" xref="S2.E2.m1.3.3.1.1.3.4.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.1.1.3.3.3" xref="S2.E2.m1.3.3.1.1.3.3.4.cmml"><mo id="S2.E2.m1.3.3.1.1.3.3.3.4" maxsize="160%" minsize="160%" xref="S2.E2.m1.3.3.1.1.3.3.4.cmml">[</mo><msub id="S2.E2.m1.3.3.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml">T</mi><mn id="S2.E2.m1.3.3.1.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S2.E2.m1.3.3.1.1.3.3.3.5" xref="S2.E2.m1.3.3.1.1.3.3.4.cmml">,</mo><mi id="S2.E2.m1.2.2" mathvariant="normal" xref="S2.E2.m1.2.2.cmml">…</mi><mo id="S2.E2.m1.3.3.1.1.3.3.3.6" xref="S2.E2.m1.3.3.1.1.3.3.4.cmml">,</mo><msub id="S2.E2.m1.3.3.1.1.2.2.2.2" xref="S2.E2.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S2.E2.m1.3.3.1.1.2.2.2.2.2" xref="S2.E2.m1.3.3.1.1.2.2.2.2.2.cmml">T</mi><mi id="S2.E2.m1.3.3.1.1.2.2.2.2.3" xref="S2.E2.m1.3.3.1.1.2.2.2.2.3.cmml">k</mi></msub><mo id="S2.E2.m1.3.3.1.1.3.3.3.7" xref="S2.E2.m1.3.3.1.1.3.3.4.cmml">,</mo><msub id="S2.E2.m1.3.3.1.1.3.3.3.3" xref="S2.E2.m1.3.3.1.1.3.3.3.3.cmml"><mi id="S2.E2.m1.3.3.1.1.3.3.3.3.2" xref="S2.E2.m1.3.3.1.1.3.3.3.3.2.cmml">T</mi><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.2.cmml"><mo id="S2.E2.m1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.3.cmml">L</mi><mo id="S2.E2.m1.1.1.1.1.1.1a" xref="S2.E2.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.1.1.4" xref="S2.E2.m1.1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S2.E2.m1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.1.1.1.2.1.cmml">]</mo></mrow></msub><mo id="S2.E2.m1.3.3.1.1.3.3.3.8" maxsize="160%" minsize="160%" xref="S2.E2.m1.3.3.1.1.3.3.4.cmml">]</mo></mrow></mrow></mrow><mo id="S2.E2.m1.3.3.1.2" lspace="0em" xref="S2.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><eq id="S2.E2.m1.3.3.1.1.4.cmml" xref="S2.E2.m1.3.3.1.1.4"></eq><ci id="S2.E2.m1.3.3.1.1.5.cmml" xref="S2.E2.m1.3.3.1.1.5">𝑇</ci><apply id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"><times id="S2.E2.m1.3.3.1.1.3.4.cmml" xref="S2.E2.m1.3.3.1.1.3.4"></times><ci id="S2.E2.m1.3.3.1.1.3.5a.cmml" xref="S2.E2.m1.3.3.1.1.3.5"><mtext id="S2.E2.m1.3.3.1.1.3.5.cmml" xref="S2.E2.m1.3.3.1.1.3.5">stack</mtext></ci><list id="S2.E2.m1.3.3.1.1.3.3.4.cmml" xref="S2.E2.m1.3.3.1.1.3.3.3"><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2">𝑇</ci><cn id="S2.E2.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E2.m1.3.3.1.1.1.1.1.1.3">1</cn></apply><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">…</ci><apply id="S2.E2.m1.3.3.1.1.2.2.2.2.cmml" xref="S2.E2.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S2.E2.m1.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S2.E2.m1.3.3.1.1.2.2.2.2.2">𝑇</ci><ci id="S2.E2.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S2.E2.m1.3.3.1.1.2.2.2.2.3">𝑘</ci></apply><apply id="S2.E2.m1.3.3.1.1.3.3.3.3.cmml" xref="S2.E2.m1.3.3.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.3.3.3.3.1.cmml" xref="S2.E2.m1.3.3.1.1.3.3.3.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.3.3.3.3.2.cmml" xref="S2.E2.m1.3.3.1.1.3.3.3.3.2">𝑇</ci><apply id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"></times><ci id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2">𝐶</ci><ci id="S2.E2.m1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3">𝐿</ci><ci id="S2.E2.m1.1.1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.1.1.4">𝑆</ci></apply></apply></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">T=\text{stack}\Big{[}T_{1},...,T_{k},T_{[CLS]}\Big{]}.</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.3d">italic_T = stack [ italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_T start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_T start_POSTSUBSCRIPT [ italic_C italic_L italic_S ] end_POSTSUBSCRIPT ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS2.p2.27">Once the tokens pass through the Mamba or Transformer layers, the resulting embedding from the <math alttext="[CLS]" class="ltx_Math" display="inline" id="S2.SS2.p2.25.m1.1"><semantics id="S2.SS2.p2.25.m1.1a"><mrow id="S2.SS2.p2.25.m1.1.1.1" xref="S2.SS2.p2.25.m1.1.1.2.cmml"><mo id="S2.SS2.p2.25.m1.1.1.1.2" stretchy="false" xref="S2.SS2.p2.25.m1.1.1.2.1.cmml">[</mo><mrow id="S2.SS2.p2.25.m1.1.1.1.1" xref="S2.SS2.p2.25.m1.1.1.1.1.cmml"><mi id="S2.SS2.p2.25.m1.1.1.1.1.2" xref="S2.SS2.p2.25.m1.1.1.1.1.2.cmml">C</mi><mo id="S2.SS2.p2.25.m1.1.1.1.1.1" xref="S2.SS2.p2.25.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p2.25.m1.1.1.1.1.3" xref="S2.SS2.p2.25.m1.1.1.1.1.3.cmml">L</mi><mo id="S2.SS2.p2.25.m1.1.1.1.1.1a" xref="S2.SS2.p2.25.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p2.25.m1.1.1.1.1.4" xref="S2.SS2.p2.25.m1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S2.SS2.p2.25.m1.1.1.1.3" stretchy="false" xref="S2.SS2.p2.25.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.25.m1.1b"><apply id="S2.SS2.p2.25.m1.1.1.2.cmml" xref="S2.SS2.p2.25.m1.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.25.m1.1.1.2.1.cmml" xref="S2.SS2.p2.25.m1.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p2.25.m1.1.1.1.1.cmml" xref="S2.SS2.p2.25.m1.1.1.1.1"><times id="S2.SS2.p2.25.m1.1.1.1.1.1.cmml" xref="S2.SS2.p2.25.m1.1.1.1.1.1"></times><ci id="S2.SS2.p2.25.m1.1.1.1.1.2.cmml" xref="S2.SS2.p2.25.m1.1.1.1.1.2">𝐶</ci><ci id="S2.SS2.p2.25.m1.1.1.1.1.3.cmml" xref="S2.SS2.p2.25.m1.1.1.1.1.3">𝐿</ci><ci id="S2.SS2.p2.25.m1.1.1.1.1.4.cmml" xref="S2.SS2.p2.25.m1.1.1.1.1.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.25.m1.1c">[CLS]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.25.m1.1d">[ italic_C italic_L italic_S ]</annotation></semantics></math> token is used to represent <math alttext="x" class="ltx_Math" display="inline" id="S2.SS2.p2.26.m2.1"><semantics id="S2.SS2.p2.26.m2.1a"><mi id="S2.SS2.p2.26.m2.1.1" xref="S2.SS2.p2.26.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.26.m2.1b"><ci id="S2.SS2.p2.26.m2.1.1.cmml" xref="S2.SS2.p2.26.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.26.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.26.m2.1d">italic_x</annotation></semantics></math>.
A minor deviation from the original FT-Transformer is that we append the <math alttext="[CLS]" class="ltx_Math" display="inline" id="S2.SS2.p2.27.m3.1"><semantics id="S2.SS2.p2.27.m3.1a"><mrow id="S2.SS2.p2.27.m3.1.1.1" xref="S2.SS2.p2.27.m3.1.1.2.cmml"><mo id="S2.SS2.p2.27.m3.1.1.1.2" stretchy="false" xref="S2.SS2.p2.27.m3.1.1.2.1.cmml">[</mo><mrow id="S2.SS2.p2.27.m3.1.1.1.1" xref="S2.SS2.p2.27.m3.1.1.1.1.cmml"><mi id="S2.SS2.p2.27.m3.1.1.1.1.2" xref="S2.SS2.p2.27.m3.1.1.1.1.2.cmml">C</mi><mo id="S2.SS2.p2.27.m3.1.1.1.1.1" xref="S2.SS2.p2.27.m3.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p2.27.m3.1.1.1.1.3" xref="S2.SS2.p2.27.m3.1.1.1.1.3.cmml">L</mi><mo id="S2.SS2.p2.27.m3.1.1.1.1.1a" xref="S2.SS2.p2.27.m3.1.1.1.1.1.cmml">⁢</mo><mi id="S2.SS2.p2.27.m3.1.1.1.1.4" xref="S2.SS2.p2.27.m3.1.1.1.1.4.cmml">S</mi></mrow><mo id="S2.SS2.p2.27.m3.1.1.1.3" stretchy="false" xref="S2.SS2.p2.27.m3.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.27.m3.1b"><apply id="S2.SS2.p2.27.m3.1.1.2.cmml" xref="S2.SS2.p2.27.m3.1.1.1"><csymbol cd="latexml" id="S2.SS2.p2.27.m3.1.1.2.1.cmml" xref="S2.SS2.p2.27.m3.1.1.1.2">delimited-[]</csymbol><apply id="S2.SS2.p2.27.m3.1.1.1.1.cmml" xref="S2.SS2.p2.27.m3.1.1.1.1"><times id="S2.SS2.p2.27.m3.1.1.1.1.1.cmml" xref="S2.SS2.p2.27.m3.1.1.1.1.1"></times><ci id="S2.SS2.p2.27.m3.1.1.1.1.2.cmml" xref="S2.SS2.p2.27.m3.1.1.1.1.2">𝐶</ci><ci id="S2.SS2.p2.27.m3.1.1.1.1.3.cmml" xref="S2.SS2.p2.27.m3.1.1.1.1.3">𝐿</ci><ci id="S2.SS2.p2.27.m3.1.1.1.1.4.cmml" xref="S2.SS2.p2.27.m3.1.1.1.1.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.27.m3.1c">[CLS]</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p2.27.m3.1d">[ italic_C italic_L italic_S ]</annotation></semantics></math> token at the end of the token sequence instead of at the beginning. In the Mamba, the first token’s output contains only information about the first token, while in both the Transformer and Mamba, the last token contains information from all previous tokens.</p>
</div>
<figure class="ltx_figure" id="S2.F2"><svg class="ltx_picture" height="197.74" id="S2.F2.pic1" overflow="visible" version="1.1" width="347.44"><g stroke="#000000" transform="translate(0,197.74) matrix(1 0 0 -1 0 0) translate(45.49,0) translate(0,183.29)"><g fill="#FBD39B" stroke-width="1.2pt"><path d="M 11.56 11.56 L -11.56 11.56 L -11.56 -11.56 L 11.56 -11.56 Z M -11.56 -11.56"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 -7.87 -7.87)"><foreignobject height="19.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.69">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" style="width:14.2pt;">
<span class="ltx_p" id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="x_{1}" class="ltx_Math" display="inline" id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">x</mi><mn id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑥</ci><cn id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">x_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#F8B250" stroke-width="1.2pt"><path d="M 11.56 -12.89 L -11.56 -12.89 L -11.56 -36.02 L 11.56 -36.02 Z M -11.56 -36.02"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 -7.87 -32.33)"><foreignobject height="19.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.69">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1" style="width:14.2pt;">
<span class="ltx_p" id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="x_{2}" class="ltx_Math" display="inline" id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">x</mi><mn id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑥</ci><cn id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">x_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#F59105" stroke-width="1.2pt"><path d="M 11.56 -37.35 L -11.56 -37.35 L -11.56 -60.47 L 11.56 -60.47 Z M -11.56 -60.47"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 -7.87 -56.79)"><foreignobject height="19.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.69">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1" style="width:14.2pt;">
<span class="ltx_p" id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="x_{3}" class="ltx_Math" display="inline" id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">x</mi><mn id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑥</ci><cn id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">x_{3}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_x start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#B5C6CA" stroke-width="1.2pt"><path d="M 11.56 -77.55 L -11.56 -77.55 L -11.56 -101.48 L 11.56 -101.48 Z M -11.56 -101.48"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 -7.87 -96.99)"><foreignobject height="20.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.69">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1" style="width:14.2pt;">
<span class="ltx_p" id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="e_{x_{4}}^{T}" class="ltx_Math" display="inline" id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msubsup id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml">e</mi><msub id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml"><mi id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2.cmml">x</mi><mn id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3.cmml">4</mn></msub><mi id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">superscript</csymbol><apply id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2">𝑒</ci><apply id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3">subscript</csymbol><ci id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2.cmml" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2">𝑥</ci><cn id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3.cmml" type="integer" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3">4</cn></apply></apply><ci id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">e_{x_{4}}^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#537A84" stroke-width="1.2pt"><path d="M 11.56 -102.81 L -11.56 -102.81 L -11.56 -126.75 L 11.56 -126.75 Z M -11.56 -126.75"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 -7.87 -122.25)"><foreignobject height="20.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.69">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1" style="width:14.2pt;">
<span class="ltx_p" id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="e_{x_{5}}^{T}" class="ltx_Math" display="inline" id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msubsup id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml">e</mi><msub id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml"><mi id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2.cmml">x</mi><mn id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3.cmml">5</mn></msub><mi id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">superscript</csymbol><apply id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.2">𝑒</ci><apply id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3"><csymbol cd="ambiguous" id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.1.cmml" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3">subscript</csymbol><ci id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2.cmml" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.2">𝑥</ci><cn id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3.cmml" type="integer" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.3.3">5</cn></apply></apply><ci id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">e_{x_{5}}^{T}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#FEC010" stroke-width="1.2pt"><path d="M 11.56 -143.82 L -11.56 -143.82 L -11.56 -166.95 L 11.56 -166.95 Z M -11.56 -166.95"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 -7.87 -163.26)"><foreignobject height="19.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="19.69">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.37.37.37.1.1" style="width:14.2pt;">
<span class="ltx_p" id="S2.F2.pic1.37.37.37.1.1.1">1</span>
</span></foreignobject></g><g fill="#000000" stroke-width="0.4pt"><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 16.14 -2.77)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="\times" class="ltx_Math" display="inline" id="S2.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1b"><times id="S2.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1d">×</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 16.14 -27.22)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="\times" class="ltx_Math" display="inline" id="S2.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1b"><times id="S2.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.7.7.7.7.7.7.7.7.7.7.7.7.1.1.1.1.1.1.1.1.1.m1.1d">×</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 16.14 -51.68)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="\times" class="ltx_Math" display="inline" id="S2.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1b"><times id="S2.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.8.8.8.8.8.8.8.8.8.8.8.8.1.1.1.1.1.1.1.1.1.m1.1d">×</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 16.14 -92.29)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="\times" class="ltx_Math" display="inline" id="S2.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1b"><times id="S2.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.9.9.9.9.9.9.9.9.9.9.9.9.1.1.1.1.1.1.1.1.1.m1.1d">×</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 16.14 -117.55)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="\times" class="ltx_Math" display="inline" id="S2.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1b"><times id="S2.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.10.10.10.10.10.10.10.10.10.10.10.10.1.1.1.1.1.1.1.1.1.m1.1d">×</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 16.14 -158.15)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="\times" class="ltx_Math" display="inline" id="S2.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1b"><times id="S2.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.11.11.11.11.11.11.11.11.11.11.11.11.1.1.1.1.1.1.1.1.1.m1.1d">×</annotation></semantics></math></foreignobject></g><g fill="#FBD39B" stroke-width="1.2pt"><path d="M 68.2 11.56 L 29.32 11.56 L 29.32 -11.56 L 68.2 -11.56 Z M 29.32 -11.56"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 33.01 -7.87)"><foreignobject height="19.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="w_{1}" class="ltx_Math" display="inline" id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">w</mi><mn id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑤</ci><cn id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">w_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.12.12.12.12.12.12.12.12.12.12.12.12.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_w start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#F8B250" stroke-width="1.2pt"><path d="M 68.2 -12.89 L 29.32 -12.89 L 29.32 -36.02 L 68.2 -36.02 Z M 29.32 -36.02"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 33.01 -32.33)"><foreignobject height="19.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="w_{2}" class="ltx_Math" display="inline" id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">w</mi><mn id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑤</ci><cn id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">w_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.13.13.13.13.13.13.13.13.13.13.13.13.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_w start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#F59105" stroke-width="1.2pt"><path d="M 68.2 -37.35 L 29.32 -37.35 L 29.32 -60.47 L 68.2 -60.47 Z M 29.32 -60.47"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 33.01 -56.79)"><foreignobject height="19.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="w_{3}" class="ltx_Math" display="inline" id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">w</mi><mn id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑤</ci><cn id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">w_{3}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.14.14.14.14.14.14.14.14.14.14.14.14.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_w start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#B5C6CA" stroke-width="1.2pt"><path d="M 68.2 -77.5 L 29.32 -77.5 L 29.32 -101.54 L 68.2 -101.54 Z M 29.32 -101.54"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 33.01 -96.94)"><foreignobject height="20.82" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="W_{4}" class="ltx_Math" display="inline" id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">W</mi><mn id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑊</ci><cn id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">W_{4}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.15.15.15.15.15.15.15.15.15.15.15.15.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_W start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#537A84" stroke-width="1.2pt"><path d="M 68.2 -102.76 L 29.32 -102.76 L 29.32 -126.8 L 68.2 -126.8 Z M 29.32 -126.8"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 33.01 -122.2)"><foreignobject height="20.82" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="W_{5}" class="ltx_Math" display="inline" id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">W</mi><mn id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑊</ci><cn id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">W_{5}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.16.16.16.16.16.16.16.16.16.16.16.16.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_W start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#FEC010" stroke-width="1.2pt"><path d="M 68.2 -143.82 L 29.32 -143.82 L 29.32 -166.95 L 68.2 -166.95 Z M 29.32 -166.95"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 33.01 -163.26)"><foreignobject height="19.69" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="w_{6}" class="ltx_Math" display="inline" id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">w</mi><mn id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑤</ci><cn id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">w_{6}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.17.17.17.17.17.17.17.17.17.17.17.17.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_w start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 72.77 -2.77)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="+" class="ltx_Math" display="inline" id="S2.F2.pic1.18.18.18.18.18.18.18.18.18.18.18.18.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.18.18.18.18.18.18.18.18.18.18.18.18.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.18.18.18.18.18.18.18.18.18.18.18.18.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.18.18.18.18.18.18.18.18.18.18.18.18.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.18.18.18.18.18.18.18.18.18.18.18.18.1.1.1.1.1.1.1.1.1.m1.1b"><plus id="S2.F2.pic1.18.18.18.18.18.18.18.18.18.18.18.18.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.18.18.18.18.18.18.18.18.18.18.18.18.1.1.1.1.1.1.1.1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.18.18.18.18.18.18.18.18.18.18.18.18.1.1.1.1.1.1.1.1.1.m1.1c">+</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.18.18.18.18.18.18.18.18.18.18.18.18.1.1.1.1.1.1.1.1.1.m1.1d">+</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 72.77 -27.22)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="+" class="ltx_Math" display="inline" id="S2.F2.pic1.19.19.19.19.19.19.19.19.19.19.19.19.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.19.19.19.19.19.19.19.19.19.19.19.19.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.19.19.19.19.19.19.19.19.19.19.19.19.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.19.19.19.19.19.19.19.19.19.19.19.19.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.19.19.19.19.19.19.19.19.19.19.19.19.1.1.1.1.1.1.1.1.1.m1.1b"><plus id="S2.F2.pic1.19.19.19.19.19.19.19.19.19.19.19.19.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.19.19.19.19.19.19.19.19.19.19.19.19.1.1.1.1.1.1.1.1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.19.19.19.19.19.19.19.19.19.19.19.19.1.1.1.1.1.1.1.1.1.m1.1c">+</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.19.19.19.19.19.19.19.19.19.19.19.19.1.1.1.1.1.1.1.1.1.m1.1d">+</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 72.77 -51.68)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="+" class="ltx_Math" display="inline" id="S2.F2.pic1.20.20.20.20.20.20.20.20.20.20.20.20.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.20.20.20.20.20.20.20.20.20.20.20.20.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.20.20.20.20.20.20.20.20.20.20.20.20.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.20.20.20.20.20.20.20.20.20.20.20.20.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.20.20.20.20.20.20.20.20.20.20.20.20.1.1.1.1.1.1.1.1.1.m1.1b"><plus id="S2.F2.pic1.20.20.20.20.20.20.20.20.20.20.20.20.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.20.20.20.20.20.20.20.20.20.20.20.20.1.1.1.1.1.1.1.1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.20.20.20.20.20.20.20.20.20.20.20.20.1.1.1.1.1.1.1.1.1.m1.1c">+</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.20.20.20.20.20.20.20.20.20.20.20.20.1.1.1.1.1.1.1.1.1.m1.1d">+</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 72.77 -92.29)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="+" class="ltx_Math" display="inline" id="S2.F2.pic1.21.21.21.21.21.21.21.21.21.21.21.21.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.21.21.21.21.21.21.21.21.21.21.21.21.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.21.21.21.21.21.21.21.21.21.21.21.21.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.21.21.21.21.21.21.21.21.21.21.21.21.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.21.21.21.21.21.21.21.21.21.21.21.21.1.1.1.1.1.1.1.1.1.m1.1b"><plus id="S2.F2.pic1.21.21.21.21.21.21.21.21.21.21.21.21.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.21.21.21.21.21.21.21.21.21.21.21.21.1.1.1.1.1.1.1.1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.21.21.21.21.21.21.21.21.21.21.21.21.1.1.1.1.1.1.1.1.1.m1.1c">+</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.21.21.21.21.21.21.21.21.21.21.21.21.1.1.1.1.1.1.1.1.1.m1.1d">+</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 72.77 -117.55)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="+" class="ltx_Math" display="inline" id="S2.F2.pic1.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.m1.1b"><plus id="S2.F2.pic1.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.m1.1c">+</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.22.22.22.22.22.22.22.22.22.22.22.22.1.1.1.1.1.1.1.1.1.m1.1d">+</annotation></semantics></math></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 72.77 -158.16)"><foreignobject height="9.22" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="10.76"><math alttext="+" class="ltx_Math" display="inline" id="S2.F2.pic1.23.23.23.23.23.23.23.23.23.23.23.23.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.23.23.23.23.23.23.23.23.23.23.23.23.1.1.1.1.1.1.1.1.1.m1.1a"><mo id="S2.F2.pic1.23.23.23.23.23.23.23.23.23.23.23.23.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.23.23.23.23.23.23.23.23.23.23.23.23.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.23.23.23.23.23.23.23.23.23.23.23.23.1.1.1.1.1.1.1.1.1.m1.1b"><plus id="S2.F2.pic1.23.23.23.23.23.23.23.23.23.23.23.23.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.23.23.23.23.23.23.23.23.23.23.23.23.1.1.1.1.1.1.1.1.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.23.23.23.23.23.23.23.23.23.23.23.23.1.1.1.1.1.1.1.1.1.m1.1c">+</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.23.23.23.23.23.23.23.23.23.23.23.23.1.1.1.1.1.1.1.1.1.m1.1d">+</annotation></semantics></math></foreignobject></g><g fill="#FBD39B" stroke-width="1.2pt"><path d="M 124.83 12.05 L 85.96 12.05 L 85.96 -12.05 L 124.83 -12.05 Z M 85.96 -12.05"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 89.65 -7.39)"><foreignobject height="20.89" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="b_{1}" class="ltx_Math" display="inline" id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">b</mi><mn id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑏</ci><cn id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">b_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.24.24.24.24.24.24.24.24.24.24.24.24.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_b start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#F8B250" stroke-width="1.2pt"><path d="M 124.83 -12.41 L 85.96 -12.41 L 85.96 -36.5 L 124.83 -36.5 Z M 85.96 -36.5"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 89.65 -31.85)"><foreignobject height="20.89" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="b_{2}" class="ltx_Math" display="inline" id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">b</mi><mn id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑏</ci><cn id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">b_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.25.25.25.25.25.25.25.25.25.25.25.25.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_b start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#F59105" stroke-width="1.2pt"><path d="M 124.83 -36.86 L 85.96 -36.86 L 85.96 -60.96 L 124.83 -60.96 Z M 85.96 -60.96"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 89.65 -56.3)"><foreignobject height="20.89" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="b_{3}" class="ltx_Math" display="inline" id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">b</mi><mn id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑏</ci><cn id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">b_{3}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.26.26.26.26.26.26.26.26.26.26.26.26.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_b start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#B5C6CA" stroke-width="1.2pt"><path d="M 124.83 -77.47 L 85.96 -77.47 L 85.96 -101.57 L 124.83 -101.57 Z M 85.96 -101.57"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 89.65 -96.91)"><foreignobject height="20.89" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="b_{4}" class="ltx_Math" display="inline" id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">b</mi><mn id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑏</ci><cn id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">b_{4}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.27.27.27.27.27.27.27.27.27.27.27.27.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_b start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#537A84" stroke-width="1.2pt"><path d="M 124.83 -102.73 L 85.96 -102.73 L 85.96 -126.83 L 124.83 -126.83 Z M 85.96 -126.83"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 89.65 -122.17)"><foreignobject height="20.89" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="b_{5}" class="ltx_Math" display="inline" id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">b</mi><mn id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑏</ci><cn id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">b_{5}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.28.28.28.28.28.28.28.28.28.28.28.28.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_b start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#FEC010" stroke-width="1.2pt"><path d="M 124.83 -143.34 L 85.96 -143.34 L 85.96 -167.44 L 124.83 -167.44 Z M 85.96 -167.44"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 89.65 -162.78)"><foreignobject height="20.89" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="b_{6}" class="ltx_Math" display="inline" id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">b</mi><mn id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑏</ci><cn id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">b_{6}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.29.29.29.29.29.29.29.29.29.29.29.29.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_b start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g stroke-width="1.2pt"><path d="M 125.5 12.71 M 129.44 12.71 C 132.76 11.05 134.97 7.18 134.97 1.64 L 134.97 -13.39 C 134.97 -18.92 137.18 -22.8 140.51 -24.46 C 137.18 -26.12 134.97 -29.99 134.97 -35.53 L 134.97 -50.55 C 134.97 -56.09 132.76 -59.96 129.44 -61.62" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 125.5 -76.81 M 129.44 -76.81 C 132.76 -78.47 134.97 -82.34 134.97 -87.88 L 134.97 -91.08 C 134.97 -96.62 137.18 -100.49 140.51 -102.15 C 137.18 -103.81 134.97 -107.68 134.97 -113.22 L 134.97 -116.42 C 134.97 -121.96 132.76 -125.83 129.44 -127.49" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 125.5 -142.68 M 129.44 -142.68 C 132.76 -143.63 134.97 -145.85 134.97 -149.03 L 134.97 -149.03 C 134.97 -152.21 137.18 -154.44 140.51 -155.39 C 137.18 -156.34 134.97 -158.57 134.97 -161.74 L 134.97 -161.74 C 134.97 -164.92 132.76 -167.15 129.44 -168.1" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M -12.23 12.23 M -16.16 12.23 C -19.49 10.57 -21.7 6.69 -21.7 1.16 L -21.7 -13.39 C -21.7 -18.92 -23.91 -22.8 -27.23 -24.46 C -23.91 -26.12 -21.7 -29.99 -21.7 -35.53 L -21.7 -50.07 C -21.7 -55.6 -19.49 -59.48 -16.16 -61.14" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M -12.23 -76.89 M -16.16 -76.89 C -19.49 -78.55 -21.7 -82.42 -21.7 -87.96 L -21.7 -91.08 C -21.7 -96.61 -23.91 -100.49 -27.23 -102.15 C -23.91 -103.81 -21.7 -107.68 -21.7 -113.22 L -21.7 -116.34 C -21.7 -121.88 -19.49 -125.75 -16.16 -127.41" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M -12.23 -143.16 M -16.16 -143.16 C -19.49 -144.08 -21.7 -146.22 -21.7 -149.27 L -21.7 -149.27 C -21.7 -152.33 -23.91 -154.47 -27.23 -155.39 C -23.91 -156.3 -21.7 -158.44 -21.7 -161.5 L -21.7 -161.5 C -21.7 -164.56 -19.49 -166.7 -16.16 -167.61" style="fill:none"></path></g><g fill="#F59105" stroke-width="1.2pt"><path d="M 259.53 -52.11 L 220.65 -52.11 L 220.65 -76.14 L 259.53 -76.14 Z M 220.65 -76.14"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 224.34 -71.55)"><foreignobject height="20.82" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="T_{3}" class="ltx_Math" display="inline" id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">T</mi><mn id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑇</ci><cn id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">T_{3}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.30.30.30.30.30.30.30.30.30.30.30.30.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_T start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#FBD39B" stroke-width="1.2pt"><path d="M 259.53 -26.75 L 220.65 -26.75 L 220.65 -50.78 L 259.53 -50.78 Z M 220.65 -50.78"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 224.34 -46.19)"><foreignobject height="20.82" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="T_{2}" class="ltx_Math" display="inline" id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">T</mi><mn id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑇</ci><cn id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">T_{2}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.31.31.31.31.31.31.31.31.31.31.31.31.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_T start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#F8B250" stroke-width="1.2pt"><path d="M 259.53 -1.39 L 220.65 -1.39 L 220.65 -25.42 L 259.53 -25.42 Z M 220.65 -25.42"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 224.34 -20.82)"><foreignobject height="20.82" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="T_{1}" class="ltx_Math" display="inline" id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">T</mi><mn id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑇</ci><cn id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">T_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.32.32.32.32.32.32.32.32.32.32.32.32.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_T start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#B5C6CA" stroke-width="1.2pt"><path d="M 259.53 -77.47 L 220.65 -77.47 L 220.65 -101.51 L 259.53 -101.51 Z M 220.65 -101.51"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 224.34 -96.91)"><foreignobject height="20.82" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="T_{4}" class="ltx_Math" display="inline" id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">T</mi><mn id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑇</ci><cn id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">T_{4}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.33.33.33.33.33.33.33.33.33.33.33.33.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_T start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#537A84" stroke-width="1.2pt"><path d="M 259.53 -102.83 L 220.65 -102.83 L 220.65 -126.87 L 259.53 -126.87 Z M 220.65 -126.87"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 224.34 -122.27)"><foreignobject height="20.82" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="T_{5}" class="ltx_Math" display="inline" id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">T</mi><mn id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝑇</ci><cn id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">T_{5}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.34.34.34.34.34.34.34.34.34.34.34.34.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_T start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g fill="#FEC010" stroke-width="1.2pt"><path d="M 259.53 -128.2 L 220.65 -128.2 L 220.65 -153.17 L 259.53 -153.17 Z M 220.65 -153.17"></path></g><g fill="#000000" stroke="#000000" stroke-width="1.2pt" transform="matrix(0.8 0.0 0.0 0.8 224.34 -147.63)"><foreignobject height="21.99" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.37">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1" style="width:28.5pt;">
<span class="ltx_p" id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1"><math alttext="T_{[CLS]}" class="ltx_Math" display="inline" id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml"><mi id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml">T</mi><mrow id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.cmml"><mo id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.2" stretchy="false" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.cmml"><mi id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3.cmml">L</mi><mo id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1a" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.4" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.3" stretchy="false" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.1.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.cmml" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2"><csymbol cd="ambiguous" id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.1.cmml" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2">subscript</csymbol><ci id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2.cmml" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.2.2">𝑇</ci><apply id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.cmml" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.2.1.cmml" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.cmml" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1"><times id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.1"></times><ci id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.2">𝐶</ci><ci id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3.cmml" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.3">𝐿</ci><ci id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.4.cmml" xref="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.4">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">T_{[CLS]}</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.35.35.35.35.35.35.35.35.35.35.35.35.1.1.1.1.1.1.1.1.1.1.1.1.m1.1d">italic_T start_POSTSUBSCRIPT [ italic_C italic_L italic_S ] end_POSTSUBSCRIPT</annotation></semantics></math></span>
</span></foreignobject></g><g stroke-width="1.2pt"><path d="M 219.99 -0.72 M 216.05 -0.72 C 212.73 -2.38 210.52 -6.26 210.52 -11.79 L 210.52 -27.7 C 210.52 -33.23 208.3 -37.1 204.98 -38.77 C 208.3 -40.43 210.52 -44.3 210.52 -49.83 L 210.52 -65.74 C 210.52 -71.27 212.73 -75.15 216.05 -76.81" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 219.99 -76.81 M 216.05 -76.81 C 212.73 -78.47 210.52 -82.34 210.52 -87.88 L 210.52 -91.1 C 210.52 -96.64 208.3 -100.51 204.98 -102.17 C 208.3 -103.83 210.52 -107.71 210.52 -113.24 L 210.52 -116.46 C 210.52 -122 212.73 -125.87 216.05 -127.53" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 219.99 -127.53 M 216.05 -127.53 C 212.73 -128.52 210.52 -130.82 210.52 -134.11 L 210.52 -134.11 C 210.52 -137.4 208.31 -139.7 204.98 -140.68 C 208.31 -141.67 210.52 -143.97 210.52 -147.26 L 210.52 -147.26 C 210.52 -150.55 212.73 -152.85 216.05 -153.83" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 141.38 -24.46 L 202.82 -38.47" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(0.97496 -0.2224 0.2224 0.97496 202.82 -38.47)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 141.38 -102.07 L 202.78 -102.17" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(1.0 -0.00162 0.00162 1.0 202.78 -102.17)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 141.38 -155.39 L 202.82 -140.99" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(0.97362 0.22823 -0.22823 0.97362 202.82 -140.99)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 260.19 -0.72 M 264.13 -0.72 C 267.45 -2.38 269.67 -6.26 269.67 -11.79 L 269.67 -66.21 C 269.67 -71.74 271.88 -75.62 275.2 -77.28 C 271.88 -78.94 269.67 -82.81 269.67 -88.35 L 269.67 -142.76 C 269.67 -148.3 267.45 -152.17 264.13 -153.83" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 278.28 -80.19)"><foreignobject height="10.76" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="24.98"><span class="ltx_text" id="S2.F2.pic1.38.38.38.37.1.1">k+1</span></foreignobject></g><g stroke-width="1.2pt"><path d="M 219.99 -153.83 M 219.99 -157.77 C 221.5 -161.09 225.02 -163.31 230.04 -163.31 L 230.04 -163.31 C 235.07 -163.31 238.59 -165.52 240.09 -168.84 C 241.6 -165.52 245.12 -163.31 250.14 -163.31 L 250.14 -163.31 C 255.17 -163.31 258.69 -161.09 260.19 -157.77" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 237.02 -179.6)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="7.69"><span class="ltx_text" id="S2.F2.pic1.39.39.39.38.1.1">d</span></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 236.09 3.19)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="9.99"><span class="ltx_text" id="S2.F2.pic1.40.40.40.39.1.1">T</span></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.0 0.8 -0.8 0.0 -31.83 -49.22)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="61.92"><span class="ltx_text" id="S2.F2.pic1.41.41.41.40.1.1">Numerical</span></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.0 0.8 -0.8 0.0 -33.99 -129.53)"><foreignobject height="12.3" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="68.45"><span class="ltx_text" id="S2.F2.pic1.42.42.42.41.1.1">Categorical</span></foreignobject></g><g fill="#000000" stroke="#000000" transform="matrix(0.0 0.8 -0.8 0.0 -34.33 -168.8)"><foreignobject height="12.45" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="33.54"><math alttext="[CLS]" class="ltx_Math" display="inline" id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1"><semantics id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1a"><mrow id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml"><mo id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.2" maxsize="90%" minsize="90%" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml">[</mo><mrow id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml"><mi id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.2" mathsize="90%" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.2.cmml">C</mi><mo id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.3" mathsize="90%" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.3.cmml">L</mi><mo id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1a" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.4" mathsize="90%" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.3" maxsize="90%" minsize="90%" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1"><csymbol cd="latexml" id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.cmml" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1"><times id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1.cmml" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.1"></times><ci id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.2.cmml" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.2">𝐶</ci><ci id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.3.cmml" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.3">𝐿</ci><ci id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.4.cmml" xref="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1.1.1.1.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1c">[CLS]</annotation><annotation encoding="application/x-llamapun" id="S2.F2.pic1.36.36.36.36.36.36.36.36.36.36.36.36.1.1.1.1.1.1.1.1.1.m1.1d">[ italic_C italic_L italic_S ]</annotation></semantics></math></foreignobject></g></g></g></svg>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.4.2.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S2.F2.2.1" style="font-size:90%;">Image derived from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib12" title="">12</a>]</cite> that visually explains the tokenizer that includes <math alttext="[CLS]" class="ltx_Math" display="inline" id="S2.F2.2.1.m1.1"><semantics id="S2.F2.2.1.m1.1b"><mrow id="S2.F2.2.1.m1.1.1.1" xref="S2.F2.2.1.m1.1.1.2.cmml"><mo id="S2.F2.2.1.m1.1.1.1.2" stretchy="false" xref="S2.F2.2.1.m1.1.1.2.1.cmml">[</mo><mrow id="S2.F2.2.1.m1.1.1.1.1" xref="S2.F2.2.1.m1.1.1.1.1.cmml"><mi id="S2.F2.2.1.m1.1.1.1.1.2" xref="S2.F2.2.1.m1.1.1.1.1.2.cmml">C</mi><mo id="S2.F2.2.1.m1.1.1.1.1.1" xref="S2.F2.2.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.F2.2.1.m1.1.1.1.1.3" xref="S2.F2.2.1.m1.1.1.1.1.3.cmml">L</mi><mo id="S2.F2.2.1.m1.1.1.1.1.1b" xref="S2.F2.2.1.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.F2.2.1.m1.1.1.1.1.4" xref="S2.F2.2.1.m1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S2.F2.2.1.m1.1.1.1.3" stretchy="false" xref="S2.F2.2.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.2.1.m1.1c"><apply id="S2.F2.2.1.m1.1.1.2.cmml" xref="S2.F2.2.1.m1.1.1.1"><csymbol cd="latexml" id="S2.F2.2.1.m1.1.1.2.1.cmml" xref="S2.F2.2.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S2.F2.2.1.m1.1.1.1.1.cmml" xref="S2.F2.2.1.m1.1.1.1.1"><times id="S2.F2.2.1.m1.1.1.1.1.1.cmml" xref="S2.F2.2.1.m1.1.1.1.1.1"></times><ci id="S2.F2.2.1.m1.1.1.1.1.2.cmml" xref="S2.F2.2.1.m1.1.1.1.1.2">𝐶</ci><ci id="S2.F2.2.1.m1.1.1.1.1.3.cmml" xref="S2.F2.2.1.m1.1.1.1.1.3">𝐿</ci><ci id="S2.F2.2.1.m1.1.1.1.1.4.cmml" xref="S2.F2.2.1.m1.1.1.1.1.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.2.1.m1.1d">[CLS]</annotation><annotation encoding="application/x-llamapun" id="S2.F2.2.1.m1.1e">[ italic_C italic_L italic_S ]</annotation></semantics></math> token.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS3.5.1.1">II-C</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS3.6.2">Two-Tower Models</span>
</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">A Two-Tower Model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib31" title="">31</a>]</cite> consists of two independent models (the two towers) that combine to produce the model’s output, and is commonly used in recommendation systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib30" title="">30</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib32" title="">32</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib18" title="">18</a>]</cite>.
In our case, one tower encodes user information, while the other encodes content information, making this a more specific use of a dual encoder model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib9" title="">9</a>]</cite>.
Since both the user and content data are in tabular formats, we use either FT-Transformers or FT-Mamba for the two towers.
The inner product of the user and content embeddings serves as the model’s prediction, though this is not the only possible approach for comparing embedding similarity (e.g., cosine similarity or another feed-forward network could be used).
The architectures of the Two-Tower Transformer and the Two-Tower Mamba are illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S2.F3" title="Figure 3 ‣ II-C Two-Tower Models ‣ II Methodology ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S2.F3"><svg class="ltx_picture ltx_centering" height="309.31" id="S2.F3.pic1" overflow="visible" version="1.1" width="338.16"><g fill="#000000" stroke="#000000" transform="translate(0,309.31) matrix(1 0 0 -1 0 0) translate(169.08,0) translate(0,250.16)"><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -81.53 -186.9 h 163.05 v 174.11 h -163.05 Z" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -52.63 -206.13 h 105.27 v 193.38 h -105.27 Z" style="fill:none"></path></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -166.26 -131.53 h 151.08 v 174.96 h -151.08 Z" style="fill:none"></path></g><g stroke-width="0.4pt"><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 -109.96 47.89)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="48.47"><span class="ltx_text" id="S2.F3.pic1.1.1.1.1.1.1">Tower 1</span></foreignobject></g><g stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M 15.19 -131.53 h 151.08 v 174.96 h -151.08 Z" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.8 0.0 0.0 0.8 71.49 47.89)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="48.47"><span class="ltx_text" id="S2.F3.pic1.2.2.2.2.1.1">Tower 2</span></foreignobject></g><g color="#F06923" fill="#F06923" stroke="#F06923" stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M 28.21 -76.4 h 125.02 v 92.25 h -125.02 Z" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.0 -0.8 0.8 0.0 157.7 -5.58)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="62.11"><span class="ltx_text" id="S2.F3.pic1.3.3.3.3.1.1" style="color:#F06923;">Embedder</span></foreignobject></g><g color="#F06923" fill="#F06923" stroke="#F06923" stroke-dasharray="3.0pt,3.0pt" stroke-dashoffset="0.0pt" stroke-width="0.8pt"><path d="M -153.24 -76.4 h 125.02 v 92.25 h -125.02 Z" style="fill:none"></path></g><g fill="#000000" stroke="#000000" transform="matrix(0.0 0.8 -0.8 0.0 -157.7 -54.97)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="62.11"><span class="ltx_text" id="S2.F3.pic1.4.4.4.4.1.1" style="color:#F06923;">Embedder</span></foreignobject></g></g><g fill="#0A4150" stroke-width="0.8pt"><path d="M -43.72 7.53 L -137.72 7.53 L -137.72 -7.53 L -43.72 -7.53 Z M -137.72 -7.53"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.8 0.0 0.0 0.8 -134.03 -3.84)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="109.81"><span class="ltx_text" id="S2.F3.pic1.5.5.5.1.1" style="color:#FFFFFF;">Feature Tokenizer</span></foreignobject></g><g fill="#FEC010" stroke-width="0.8pt"><path d="M -45.4 39.11 L -136.05 39.11 L -136.05 24.17 L -45.4 24.17 Z M -136.05 24.17"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.8 0.0 0.0 0.8 -132.36 27.86)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="104.47"><span class="ltx_text" id="S2.F3.pic1.6.6.6.1.1">Content Features</span></foreignobject></g><g fill="#0A4150" stroke-width="0.8pt"><path d="M -36.53 -24.17 L -144.92 -24.17 L -144.92 -68.08 L -36.53 -68.08 Z M -144.92 -68.08"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.8 0.0 0.0 0.8 -141.23 -64.39)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 39.595)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 33.52)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 26.6)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 30.07)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="127.8"><span class="ltx_text" id="S2.F3.pic1.7.7.7.1.1.1.1.1.1.1.1" style="color:#FFFFFF;">Mamba/Transformer</span></foreignobject></g></g></g></g></g><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 42.98)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 43.57 0)"><foreignobject height="12.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.51"><span class="ltx_text" id="S2.F3.pic1.8.8.8.2.2.1.1.1" style="color:#FFFFFF;">Layers</span></foreignobject></g></g></g></g><g fill="#F59105" stroke-width="0.8pt"><path d="M -54.1 -84.71 L -127.35 -84.71 L -127.35 -123.22 L -54.1 -123.22 Z M -127.35 -123.22"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.8 0.0 0.0 0.8 -123.66 -119.53)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 34.095)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 29.29)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 24.485)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 29.3)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Feed-Forward</text></g></g></g></g></g><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 38.9)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 15.78 0)"><text transform="matrix(1 0 0 -1 0 0)">Network</text></g></g></g></g><g stroke-width="1.2pt"><path d="M -90.72 23.72 L -90.72 7.98" style="fill:none"></path></g><g color="#F06923" fill="#F06923" stroke="#F06923" stroke-width="1.2pt"><path d="M -90.72 -7.98 L -90.72 -23.72" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M -90.72 -68.52 L -90.72 -84.27" style="fill:none"></path></g><g fill="#0A4150" stroke-width="0.8pt"><path d="M 137.72 7.53 L 43.72 7.53 L 43.72 -7.53 L 137.72 -7.53 Z M 43.72 -7.53"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.8 0.0 0.0 0.8 47.41 -3.84)"><foreignobject height="9.61" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="109.81"><span class="ltx_text" id="S2.F3.pic1.9.9.9.1.1" style="color:#FFFFFF;">Feature Tokenizer</span></foreignobject></g><g fill="#FEC010" stroke-width="0.8pt"><path d="M 127.64 39.11 L 53.81 39.11 L 53.81 24.17 L 127.64 24.17 Z M 53.81 24.17"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.8 0.0 0.0 0.8 57.5 27.86)"><foreignobject height="9.46" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="83.06"><span class="ltx_text" id="S2.F3.pic1.10.10.10.1.1">User Features</span></foreignobject></g><g fill="#0A4150" stroke-width="0.8pt"><path d="M 144.92 -24.17 L 36.53 -24.17 L 36.53 -68.08 L 144.92 -68.08 Z M 36.53 -68.08"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.8 0.0 0.0 0.8 40.22 -64.39)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 39.595)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 33.52)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 26.6)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 30.07)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><foreignobject height="13.84" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="127.8"><span class="ltx_text" id="S2.F3.pic1.11.11.11.1.1.1.1.1.1.1.1" style="color:#FFFFFF;">Mamba/Transformer</span></foreignobject></g></g></g></g></g><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 42.98)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 43.57 0)"><foreignobject height="12.15" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="39.51"><span class="ltx_text" id="S2.F3.pic1.12.12.12.2.2.1.1.1" style="color:#FFFFFF;">Layers</span></foreignobject></g></g></g></g><g fill="#F59105" stroke-width="0.8pt"><path d="M 127.35 -84.71 L 54.1 -84.71 L 54.1 -123.22 L 127.35 -123.22 Z M 54.1 -123.22"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.8 0.0 0.0 0.8 57.79 -119.53)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 34.095)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 29.29)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 24.485)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 29.3)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Feed-Forward</text></g></g></g></g></g><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 38.9)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 15.78 0)"><text transform="matrix(1 0 0 -1 0 0)">Network</text></g></g></g></g><g stroke-width="1.2pt"><path d="M 90.72 23.72 L 90.72 7.98" style="fill:none"></path></g><g color="#0A4150" fill="#0A4150" stroke="#0A4150" stroke-width="1.2pt"><path d="M 90.72 -7.98 L 90.72 -23.72" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 90.72 -68.52 L 90.72 -84.27" style="fill:none"></path></g><g fill="#C9D4D7" stroke-width="0.8pt"><path d="M 27.38 -114.59 L -27.38 -114.59 L -27.38 -249.61 L 27.38 -249.61 Z M -27.38 -249.61"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.8pt" transform="matrix(0.8 0.0 0.0 0.8 -23.69 -245.92)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 154.82)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 150.09)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><g class="ltx_tikzmatrix" transform="matrix(1 0 0 -1 0 143.94)"><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 147.41)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 0 0)"><text transform="matrix(1 0 0 -1 0 0)">Similarity</text></g></g></g></g></g><g class="ltx_tikzmatrix_row" transform="matrix(1 0 0 1 0 159.55)"><g class="ltx_tikzmatrix_col ltx_nopad_l ltx_nopad_r" transform="matrix(1 0 0 -1 13.45 0)"><text transform="matrix(1 0 0 -1 0 0)">Score</text></g></g></g></g><g stroke-width="1.2pt"><path d="M -90.72 -123.66 L -28.8 -181.2" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(0.73259 -0.68066 0.68066 0.73259 -28.8 -181.2)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g><g stroke-width="1.2pt"><path d="M 90.72 -123.66 L 28.8 -181.2" style="fill:none"></path></g><g stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.96pt" transform="matrix(-0.73259 -0.68066 0.68066 -0.73259 28.8 -181.2)"><path d="M -2.66 3.54 C -2.44 2.21 0 0.22 0.66 0 C 0 -0.22 -2.44 -2.21 -2.66 -3.54" style="fill:none"></path></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S2.F3.3.2" style="font-size:90%;">Two-Tower Model</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Experiments</span>
</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">The experiments compare two Two-Tower Models: one using a Transformer as the embedder and the other using a Mamba. The three datasets utilized are the Spotify music recommendation, H&amp;M fashion recommendation, and vaccine messaging recommendation datasets. Each training dataset contains 160,000 user-action pairs with a target to predict, while the test datasets consist of 100 users. Models are trained using mean squared error (MSE) with a batch size of 32, resulting in one epoch with 5,000 steps.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">Each of the feed-forward networks in the Two-Tower Models consists of a hidden layer with 64 nodes and an output layer with 32 nodes, both utilizing ReLU activation. The tokenizer uses tokens of size 192. A hyperparameter search was conducted using the Spotify music recommendation dataset to tune the embedders, with 100 seeds and 1,000 validation points. These tuned hyperparameters were then used in the H&amp;M and vaccine messaging experiments, with only the learning rates varied, which again were chosen through validation using a few seeds. The Transformer and Mamba towers were configured to use identical hyperparameters between the user and content towers. The Transformer was configured with 2 heads, 0% head dropout, and 2 layers. The Mamba was set with a convolution width of 16, a linear expansion factor of 2, and 4 layers. Any other hyperparameters used are their default values. This results in the Transformer embedder having 1,186,048 trainable parameters in each tower, compared to the 479,232 trainable parameters in the Mamba embedders. As we will see, despite having only around 40% of the trainable parameters of the Transformer embedding, the Two-Tower Mamba is often able to outperform the Two-Tower Transformer.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.5">To compute test set metrics, we use 100 different seeds to estimate statistical significance. The metrics computed include precision (P), recall (R), mean reciprocal rank (MRR), and hit ratio (HR), which we evaluate at truncatation values <math alttext="k=1" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><mrow id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">k</mi><mo id="S3.p3.1.m1.1.1.1" xref="S3.p3.1.m1.1.1.1.cmml">=</mo><mn id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><eq id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1.1"></eq><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝑘</ci><cn id="S3.p3.1.m1.1.1.3.cmml" type="integer" xref="S3.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">k=1</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_k = 1</annotation></semantics></math>, 5, and 10, denoted as P@<math alttext="k" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mi id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_k</annotation></semantics></math>, R@<math alttext="k" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><mi id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><ci id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_k</annotation></semantics></math>, MRR@<math alttext="k" class="ltx_Math" display="inline" id="S3.p3.4.m4.1"><semantics id="S3.p3.4.m4.1a"><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">italic_k</annotation></semantics></math>, and HR@<math alttext="k" class="ltx_Math" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><mi id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><ci id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">italic_k</annotation></semantics></math>, respectively.
Since P@1, MRR@1, and HR@1 are all equal, we only present HR@1.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1">All experiments were conducted using Google Colab <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib10" title="">10</a>]</cite> with a T4 runtime type. The code is available at
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/" title="">https://github.com/</a> (truncated for anonymity), where a link to run the code on Google Colab can be found.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.5.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.6.2">Spotify Music Recommendation</span>
</h3>
<figure class="ltx_figure" id="S3.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="339" id="S3.F4.sf1.g1" src="extracted/5848363/images/spotify_hit_ratio_single.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S3.F4.sf1.3.2" style="font-size:90%;">Spotify Music Recommendation</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="339" id="S3.F4.sf2.g1" src="extracted/5848363/images/hm_fashion_hit_ratio_single.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S3.F4.sf2.3.2" style="font-size:90%;">H&amp;M Fashion Recommendation</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">Hit Ratios Through Training</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.3">We use the music recommendation dataset from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib6" title="">6</a>]</cite>. Users are represented by a 20-dimensional binary vector, with each element indicating a preference for one of 20 different genres. These vectors are treated as numeric features in the tokenizer. The content is represented by the song’s rank on the “Top 50-Global” playlist, which is treated as a categorical feature. The task is to predict a value of <math alttext="-1" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mo id="S3.SS1.p1.1.m1.1.1a" xref="S3.SS1.p1.1.m1.1.1.cmml">−</mo><mn id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><minus id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"></minus><cn id="S3.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">- 1</annotation></semantics></math>, <math alttext="0" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mn id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><cn id="S3.SS1.p1.2.m2.1.1.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1">0</cn></annotation-xml></semantics></math>, or <math alttext="1" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mn id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><cn id="S3.SS1.p1.3.m3.1.1.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">1</annotation></semantics></math>, representing negative, neutral, or positive user sentiment towards the song. For analysis, we focus on how well the models recommended songs the user liked, consolidating the neutral and dislike categories.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.8">In this dataset, each of the 20 genres and 50 songs is represented by a 10-dimensional vector, with coordinates corresponding to the following 10 attributes: Acoustic, Dance, Energy, Instruments, Liveness, Loudness, Mode, Speech, Tempo, and Valence. Thus, genres form a matrix <math alttext="G\in\mathbb{R}^{20\times 10}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">G</mi><mo id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml"><mn id="S3.SS1.p2.1.m1.1.1.3.3.2" xref="S3.SS1.p2.1.m1.1.1.3.3.2.cmml">20</mn><mo id="S3.SS1.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.1.m1.1.1.3.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.3.cmml">10</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><in id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"></in><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝐺</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3"><times id="S3.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3.1"></times><cn id="S3.SS1.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1.3.3.2">20</cn><cn id="S3.SS1.p2.1.m1.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p2.1.m1.1.1.3.3.3">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">G\in\mathbb{R}^{20\times 10}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_G ∈ blackboard_R start_POSTSUPERSCRIPT 20 × 10 end_POSTSUPERSCRIPT</annotation></semantics></math>, and songs form a matrix <math alttext="S\in\mathbb{R}^{50\times 10}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">S</mi><mo id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml"><mn id="S3.SS1.p2.2.m2.1.1.3.3.2" xref="S3.SS1.p2.2.m2.1.1.3.3.2.cmml">50</mn><mo id="S3.SS1.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p2.2.m2.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p2.2.m2.1.1.3.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.3.cmml">10</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><in id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1"></in><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑆</ci><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3"><times id="S3.SS1.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3.1"></times><cn id="S3.SS1.p2.2.m2.1.1.3.3.2.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.3.3.2">50</cn><cn id="S3.SS1.p2.2.m2.1.1.3.3.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.1.1.3.3.3">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">S\in\mathbb{R}^{50\times 10}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.1d">italic_S ∈ blackboard_R start_POSTSUPERSCRIPT 50 × 10 end_POSTSUPERSCRIPT</annotation></semantics></math>. A user’s preference for a song is calculated as <math alttext="p(u)=uGS^{T}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.2" xref="S3.SS1.p2.3.m3.1.2.cmml"><mrow id="S3.SS1.p2.3.m3.1.2.2" xref="S3.SS1.p2.3.m3.1.2.2.cmml"><mi id="S3.SS1.p2.3.m3.1.2.2.2" xref="S3.SS1.p2.3.m3.1.2.2.2.cmml">p</mi><mo id="S3.SS1.p2.3.m3.1.2.2.1" xref="S3.SS1.p2.3.m3.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.3.m3.1.2.2.3.2" xref="S3.SS1.p2.3.m3.1.2.2.cmml"><mo id="S3.SS1.p2.3.m3.1.2.2.3.2.1" stretchy="false" xref="S3.SS1.p2.3.m3.1.2.2.cmml">(</mo><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">u</mi><mo id="S3.SS1.p2.3.m3.1.2.2.3.2.2" stretchy="false" xref="S3.SS1.p2.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.3.m3.1.2.1" xref="S3.SS1.p2.3.m3.1.2.1.cmml">=</mo><mrow id="S3.SS1.p2.3.m3.1.2.3" xref="S3.SS1.p2.3.m3.1.2.3.cmml"><mi id="S3.SS1.p2.3.m3.1.2.3.2" xref="S3.SS1.p2.3.m3.1.2.3.2.cmml">u</mi><mo id="S3.SS1.p2.3.m3.1.2.3.1" xref="S3.SS1.p2.3.m3.1.2.3.1.cmml">⁢</mo><mi id="S3.SS1.p2.3.m3.1.2.3.3" xref="S3.SS1.p2.3.m3.1.2.3.3.cmml">G</mi><mo id="S3.SS1.p2.3.m3.1.2.3.1a" xref="S3.SS1.p2.3.m3.1.2.3.1.cmml">⁢</mo><msup id="S3.SS1.p2.3.m3.1.2.3.4" xref="S3.SS1.p2.3.m3.1.2.3.4.cmml"><mi id="S3.SS1.p2.3.m3.1.2.3.4.2" xref="S3.SS1.p2.3.m3.1.2.3.4.2.cmml">S</mi><mi id="S3.SS1.p2.3.m3.1.2.3.4.3" xref="S3.SS1.p2.3.m3.1.2.3.4.3.cmml">T</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.2.cmml" xref="S3.SS1.p2.3.m3.1.2"><eq id="S3.SS1.p2.3.m3.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.2.1"></eq><apply id="S3.SS1.p2.3.m3.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.2.2"><times id="S3.SS1.p2.3.m3.1.2.2.1.cmml" xref="S3.SS1.p2.3.m3.1.2.2.1"></times><ci id="S3.SS1.p2.3.m3.1.2.2.2.cmml" xref="S3.SS1.p2.3.m3.1.2.2.2">𝑝</ci><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑢</ci></apply><apply id="S3.SS1.p2.3.m3.1.2.3.cmml" xref="S3.SS1.p2.3.m3.1.2.3"><times id="S3.SS1.p2.3.m3.1.2.3.1.cmml" xref="S3.SS1.p2.3.m3.1.2.3.1"></times><ci id="S3.SS1.p2.3.m3.1.2.3.2.cmml" xref="S3.SS1.p2.3.m3.1.2.3.2">𝑢</ci><ci id="S3.SS1.p2.3.m3.1.2.3.3.cmml" xref="S3.SS1.p2.3.m3.1.2.3.3">𝐺</ci><apply id="S3.SS1.p2.3.m3.1.2.3.4.cmml" xref="S3.SS1.p2.3.m3.1.2.3.4"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.2.3.4.1.cmml" xref="S3.SS1.p2.3.m3.1.2.3.4">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.2.3.4.2.cmml" xref="S3.SS1.p2.3.m3.1.2.3.4.2">𝑆</ci><ci id="S3.SS1.p2.3.m3.1.2.3.4.3.cmml" xref="S3.SS1.p2.3.m3.1.2.3.4.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">p(u)=uGS^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_p ( italic_u ) = italic_u italic_G italic_S start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="(p(u))_{i}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.2"><semantics id="S3.SS1.p2.4.m4.2a"><msub id="S3.SS1.p2.4.m4.2.2" xref="S3.SS1.p2.4.m4.2.2.cmml"><mrow id="S3.SS1.p2.4.m4.2.2.1.1" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml"><mo id="S3.SS1.p2.4.m4.2.2.1.1.2" stretchy="false" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.4.m4.2.2.1.1.1" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.2.2.1.1.1.2" xref="S3.SS1.p2.4.m4.2.2.1.1.1.2.cmml">p</mi><mo id="S3.SS1.p2.4.m4.2.2.1.1.1.1" xref="S3.SS1.p2.4.m4.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS1.p2.4.m4.2.2.1.1.1.3.2" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml"><mo id="S3.SS1.p2.4.m4.2.2.1.1.1.3.2.1" stretchy="false" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml">(</mo><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">u</mi><mo id="S3.SS1.p2.4.m4.2.2.1.1.1.3.2.2" stretchy="false" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.4.m4.2.2.1.1.3" stretchy="false" xref="S3.SS1.p2.4.m4.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.SS1.p2.4.m4.2.2.3" xref="S3.SS1.p2.4.m4.2.2.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.2b"><apply id="S3.SS1.p2.4.m4.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.2.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2">subscript</csymbol><apply id="S3.SS1.p2.4.m4.2.2.1.1.1.cmml" xref="S3.SS1.p2.4.m4.2.2.1.1"><times id="S3.SS1.p2.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.2.2.1.1.1.1"></times><ci id="S3.SS1.p2.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.2.2.1.1.1.2">𝑝</ci><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑢</ci></apply><ci id="S3.SS1.p2.4.m4.2.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.2c">(p(u))_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.2d">( italic_p ( italic_u ) ) start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents the preference for the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.1d">italic_i</annotation></semantics></math>-th song in the “Top 50-Global” playlist. A threshold is then applied to convert these preferences into <math alttext="-1" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mrow id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mo id="S3.SS1.p2.6.m6.1.1a" xref="S3.SS1.p2.6.m6.1.1.cmml">−</mo><mn id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><minus id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"></minus><cn id="S3.SS1.p2.6.m6.1.1.2.cmml" type="integer" xref="S3.SS1.p2.6.m6.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">- 1</annotation></semantics></math>, <math alttext="0" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mn id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><cn id="S3.SS1.p2.7.m7.1.1.cmml" type="integer" xref="S3.SS1.p2.7.m7.1.1">0</cn></annotation-xml></semantics></math>, or <math alttext="1" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><mn id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><cn id="S3.SS1.p2.8.m8.1.1.cmml" type="integer" xref="S3.SS1.p2.8.m8.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">1</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">Initially, this dataset was designed for reinforcement learning, but we adapt it for a supervised learning setting. To generate the training and validation sets, we randomly sample users and songs, then compute the users’ sentiments about the selected songs. For the test set, we randomly sample users and evaluate their sentiments toward all songs on the playlist.
We conducted a hyperparameter search to optimize both the Two-Tower Transformer and Two-Tower Mamba models, and both of the models use a learning rate of <math alttext="10^{-4}" class="ltx_Math" display="inline" id="S3.SS1.p3.1.m1.1"><semantics id="S3.SS1.p3.1.m1.1a"><msup id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mn id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">10</mn><mrow id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml"><mo id="S3.SS1.p3.1.m1.1.1.3a" xref="S3.SS1.p3.1.m1.1.1.3.cmml">−</mo><mn id="S3.SS1.p3.1.m1.1.1.3.2" xref="S3.SS1.p3.1.m1.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">superscript</csymbol><cn id="S3.SS1.p3.1.m1.1.1.2.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.2">10</cn><apply id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3"><minus id="S3.SS1.p3.1.m1.1.1.3.1.cmml" xref="S3.SS1.p3.1.m1.1.1.3"></minus><cn id="S3.SS1.p3.1.m1.1.1.3.2.cmml" type="integer" xref="S3.SS1.p3.1.m1.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p3.1.m1.1d">10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">The metrics for this experiment are presented in the top rows of Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.T1" title="TABLE I ‣ III-A Spotify Music Recommendation ‣ III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">I</span></a>, with Hit Ratios (HR@) throughout training displayed in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.F4.sf1" title="In Figure 4 ‣ III-A Spotify Music Recommendation ‣ III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">4(a)</span></a>.
Both models perform exceptionally well, even when recommending just one song.
Notably, the top Two-Tower Mamba recommendation was liked by users an impressive 97.7% of the time, compared to 84.11% for the Two-Tower Transformer.
After only 2,000 training steps, both models achieved over 90% HR@5.
However, across all metrics, Two-Tower Mamba consistently outperformed the Two-Tower Transformer.
Particularly, based on the MRR, we expect the Two-Tower Mamba to recommend songs that the user enjoys quicker than the Two-Tower Transformer.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.1">Regarding the diversity of song recommendations, Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.F5.sf1" title="In Figure 5 ‣ III-A Spotify Music Recommendation ‣ III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">5(a)</span></a> highlights the difference between the number of times each song was predicted versus how often users liked those songs.
The number of recommendations for a user is tied to the number of songs that the user liked, which relates to recall, where truncation depends on the individual user.
A value below 0 means the song was liked more often than it was recommended, values above 0 indicate the song was predicted more than it was liked, and values near 0 suggest the recommendation and like counts were similar.
To standardize across seeds, songs were ranked based on the number of user likes rather than playlist order, meaning as rank increases from 1 to 50, the number of likes decreases.</p>
</div>
<div class="ltx_para" id="S3.SS1.p6">
<p class="ltx_p" id="S3.SS1.p6.1">Given the performance metrics already discussed, we anticipate the Two-Tower Transformer’s recommendations to deviate further from 0 compared to those of the Two-Tower Mamba.
Nevertheless, a trend emerges in which both models tend to recommend top-rated songs less frequently than they were actually liked.
The Two-Tower Transformer shows a slight tendency to over-recommend certain songs (e.g., ranks 21 and 32).
Importantly, neither model exhibits the issue of only recommending a small subset of songs, a problem previously observed with reinforcement learning approaches on this dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib6" title="">6</a>]</cite>.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T1.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.2.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T1.2.1.1.1" rowspan="2"><span class="ltx_text" id="S3.T1.2.1.1.1.1">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S3.T1.2.1.1.1.1.1" style="width:30.4pt;">
<span class="ltx_p" id="S3.T1.2.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.2.1.1.1.1.1.1.1">Dataset</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T1.2.1.1.2" rowspan="2"><span class="ltx_text" id="S3.T1.2.1.1.2.1">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S3.T1.2.1.1.2.1.1" style="width:30.4pt;">
<span class="ltx_p" id="S3.T1.2.1.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.2.1.1.2.1.1.1.1">Embedder
<br class="ltx_break"/>Model</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="2" id="S3.T1.2.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T1.2.1.1.3.1">Precision</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="2" id="S3.T1.2.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T1.2.1.1.4.1">Recall</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="2" id="S3.T1.2.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T1.2.1.1.5.1">Mean Reciprocal Rank</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="3" id="S3.T1.2.1.1.6"><span class="ltx_text ltx_font_bold" id="S3.T1.2.1.1.6.1">Hit Ratio</span></th>
</tr>
<tr class="ltx_tr" id="S3.T1.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.2.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.1.1">P@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.2.1">P@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.2.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.3.1">R@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.2.2.2.4"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.4.1">R@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.2.2.2.5"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.5.1">MRR@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.2.2.2.6"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.6.1">MRR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.2.2.2.7"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.7.1">HR@1</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.2.2.2.8"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.8.1">HR@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.2.2.2.9"><span class="ltx_text ltx_font_bold" id="S3.T1.2.2.2.9.1">HR@10</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.2.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.3.1.1">Spotify</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.3.1.2">Mamba</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.3.1.3">0.952</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.3.1.4">0.906</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.3.1.5">0.374</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.3.1.6">0.671</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.3.1.7">0.985</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.3.1.8">0.985</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.3.1.9">0.977</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.3.1.10">0.996</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.3.1.11">0.998</td>
</tr>
<tr class="ltx_tr" id="S3.T1.2.4.2">
<td class="ltx_td ltx_align_center" id="S3.T1.2.4.2.1">Spotify</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.4.2.2">Transformer</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.4.2.3">0.803</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.4.2.4">0.759</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.4.2.5">0.303</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.4.2.6">0.551</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.4.2.7">0.882</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.4.2.8">0.887</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.4.2.9">0.841</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.4.2.10">0.949</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.4.2.11">0.983</td>
</tr>
<tr class="ltx_tr" id="S3.T1.2.5.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.5.3.1">H&amp;M</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.5.3.2">Mamba</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.5.3.3">0.1566</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.5.3.4">0.1283</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.5.3.5">0.1207</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.5.3.6">0.1979</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.5.3.7">0.3335</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.2.5.3.8">0.3569</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.5.3.9">0.2155</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.5.3.10">0.5567</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.2.5.3.11">0.7326</td>
</tr>
<tr class="ltx_tr" id="S3.T1.2.6.4">
<td class="ltx_td ltx_align_center" id="S3.T1.2.6.4.1">H&amp;M</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.6.4.2">Transformer</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.6.4.3">0.1584</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.6.4.4">0.1279</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.6.4.5">0.1223</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.6.4.6">0.1974</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.6.4.7">0.3416</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.2.6.4.8">0.3646</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.6.4.9">0.226</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.6.4.10">0.5609</td>
<td class="ltx_td ltx_align_center" id="S3.T1.2.6.4.11">0.7341</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.3.1.1" style="font-size:90%;">TABLE I</span>: </span><span class="ltx_text" id="S3.T1.4.2" style="font-size:90%;">Spotify Music and H&amp;M Fashion Performance Metrics</span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="132" id="S3.F5.sf1.g1" src="extracted/5848363/images/spotify_barplot_diff.png" width="592"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S3.F5.sf1.3.2" style="font-size:90%;">Spotify Music Recommendation</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S3.F5.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="131" id="S3.F5.sf2.g1" src="extracted/5848363/images/messaging_barplot_diff_50a_25c.png" width="586"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S3.F5.sf2.3.2" style="font-size:90%;">Messaging Recommendation</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S3.F5.3.2" style="font-size:90%;">Differences between predicted and actual likes, ranked by number of likes per item per seed. Positive values indicate over-recommendations and negative values indicate under-recommendation.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.5.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.6.2">H&amp;M Fashion Recommendation</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Our next recommendation environment is based on the H&amp;M Personalized Fashion dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib19" title="">19</a>]</cite>. Users are represented by one numerical feature (age) and four categorical features: fashion news subscription status, communication activity, club membership status, and frequency of reading fashion news. The content consists of articles of clothing, described by 11 categorical features related to their type and appearance. The original dataset contains over 100,000 items which consumed the memory. Instead, we reduce to the 100 most popular and only use the article name as the sole content categorical feature.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.1">The H&amp;M Personalized Fashion dataset contains only transaction data, meaning it lacks information on items users never purchased. To address this, we sample one item each user did not purchase and label it as a non-transaction. For transactions, the target label is 1, while for non-transactions, it is 0. Additionally, we limit our test set to users with at least 5 purchases.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">The training set consists of 160,000 user-content-response triplets, with roughly half representing transactions and the other half non-transactions. The test set includes 100 users and a list of items each user actually purchased. The objective is to recommend these items to the users. We use a learning rate of <math alttext="10^{-4}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msup id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mn id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">10</mn><mrow id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><mo id="S3.SS2.p3.1.m1.1.1.3a" xref="S3.SS2.p3.1.m1.1.1.3.cmml">−</mo><mn id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml">4</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">superscript</csymbol><cn id="S3.SS2.p3.1.m1.1.1.2.cmml" type="integer" xref="S3.SS2.p3.1.m1.1.1.2">10</cn><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><minus id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3"></minus><cn id="S3.SS2.p3.1.m1.1.1.3.2.cmml" type="integer" xref="S3.SS2.p3.1.m1.1.1.3.2">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">10^{-4}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">10 start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> for both models.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.F4.sf2" title="In Figure 4 ‣ III-A Spotify Music Recommendation ‣ III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">4(b)</span></a>, the precision, Mean Reciprocal Rank (MRR), and Hit Ratios during training demonstrate an initial improvement in both models, but minimal or no progress after 1,000 training steps. Additional performance metrics are provided in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.T1" title="TABLE I ‣ III-A Spotify Music Recommendation ‣ III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">I</span></a>. While the performance of both models leaves room for improvement, the Two-Tower Transformer slightly outperformed the Two-Tower Mamba when focusing on single recommendations (i.e., P@1, MRR@1, and HR@1). Performance could be enhanced by more intelligently selecting non-transactions rather than doing so randomly. Moreover, including additional training data or recommending broader clothing categories instead of specific items may yield better results. The H&amp;M Personalized Fashion Kaggle leaderboard<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_href" href="https://www.kaggle.com/competitions/h-and-m-personalized-fashion-recommendations/leaderboard" title="">https://www.kaggle.com/competitions/h-and-m-personalized-fashion-recommendations/leaderboard</a></span></span></span> ranks submissions based on Mean Average Precision @ 12 (MAP@12). The Two-Tower Transformer and Two-Tower Mamba achieved MAP@12 scores of 0.0335 and 0.0342, respectively, which would place these models within the top 20, assuming the results extend to the full dataset.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.5.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.6.2">Vaccine Messaging Recommendation</span>
</h3>
<figure class="ltx_figure" id="S3.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="167" id="S3.F6.g1" src="extracted/5848363/images/messaging_hit_ratio_at10.png" width="586"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F6.2.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S3.F6.3.2" style="font-size:90%;">Vaccine Messaging Hit Ratio (HR@10) for varying numbers of clusters and messages</span></figcaption>
</figure>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The final personalization environment is a synthetic setting where user information is available, and the model’s task is to select content to encourage vaccination.
Users are characterized by one numerical feature (age) and seven categorical features: gender, progression, education, insurance, race, language, and religion. These features are randomly sampled.
The content comprises 100 messages generated by ChatGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib23" title="">23</a>]</cite> using the prompt: “You are responsible for creating messages to encourage people to take a COVID-19 vaccine. Please provide 100 unique messages.”
These messages are processed through an Instructor-based LLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib25" title="">25</a>]</cite>, producing 768 numerical features for each message.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.7">K-means clustering, with <math alttext="k=25,50,100" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.3"><semantics id="S3.SS3.p2.1.m1.3a"><mrow id="S3.SS3.p2.1.m1.3.4" xref="S3.SS3.p2.1.m1.3.4.cmml"><mi id="S3.SS3.p2.1.m1.3.4.2" xref="S3.SS3.p2.1.m1.3.4.2.cmml">k</mi><mo id="S3.SS3.p2.1.m1.3.4.1" xref="S3.SS3.p2.1.m1.3.4.1.cmml">=</mo><mrow id="S3.SS3.p2.1.m1.3.4.3.2" xref="S3.SS3.p2.1.m1.3.4.3.1.cmml"><mn id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">25</mn><mo id="S3.SS3.p2.1.m1.3.4.3.2.1" xref="S3.SS3.p2.1.m1.3.4.3.1.cmml">,</mo><mn id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">50</mn><mo id="S3.SS3.p2.1.m1.3.4.3.2.2" xref="S3.SS3.p2.1.m1.3.4.3.1.cmml">,</mo><mn id="S3.SS3.p2.1.m1.3.3" xref="S3.SS3.p2.1.m1.3.3.cmml">100</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.3b"><apply id="S3.SS3.p2.1.m1.3.4.cmml" xref="S3.SS3.p2.1.m1.3.4"><eq id="S3.SS3.p2.1.m1.3.4.1.cmml" xref="S3.SS3.p2.1.m1.3.4.1"></eq><ci id="S3.SS3.p2.1.m1.3.4.2.cmml" xref="S3.SS3.p2.1.m1.3.4.2">𝑘</ci><list id="S3.SS3.p2.1.m1.3.4.3.1.cmml" xref="S3.SS3.p2.1.m1.3.4.3.2"><cn id="S3.SS3.p2.1.m1.1.1.cmml" type="integer" xref="S3.SS3.p2.1.m1.1.1">25</cn><cn id="S3.SS3.p2.1.m1.2.2.cmml" type="integer" xref="S3.SS3.p2.1.m1.2.2">50</cn><cn id="S3.SS3.p2.1.m1.3.3.cmml" type="integer" xref="S3.SS3.p2.1.m1.3.3">100</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.3c">k=25,50,100</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.3d">italic_k = 25 , 50 , 100</annotation></semantics></math>, is applied separately to both user and content features, creating (at most) <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_k</annotation></semantics></math> distinct clusters for each.
We also experiment with varying the number of messages, so that we look at <math alttext="k=25" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">k</mi><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">25</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><eq id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></eq><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑘</ci><cn id="S3.SS3.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS3.p2.3.m3.1.1.3">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">k=25</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">italic_k = 25</annotation></semantics></math> with 25, 50, and 100 messages, <math alttext="k=50" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.1"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">k</mi><mo id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><eq id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1"></eq><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝑘</ci><cn id="S3.SS3.p2.4.m4.1.1.3.cmml" type="integer" xref="S3.SS3.p2.4.m4.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">k=50</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.1d">italic_k = 50</annotation></semantics></math> with 50 and 100 messages, and <math alttext="k=100" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><mrow id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">k</mi><mo id="S3.SS3.p2.5.m5.1.1.1" xref="S3.SS3.p2.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><eq id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1"></eq><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑘</ci><cn id="S3.SS3.p2.5.m5.1.1.3.cmml" type="integer" xref="S3.SS3.p2.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">k=100</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_k = 100</annotation></semantics></math> with 100 messages, where the messages are randomly sampled each seed.
Users who receive content from the same cluster are more likely to take the vaccine (target = 1), while those receiving content from different clusters are less likely (target = 0).
The training dataset includes 160,000 messages from 50,000 users, with random sampling that may result in duplicates.
The test set consists of 100 users and a list of the content most likely to prompt vaccination.
During validation, we found that representing the index of the messages performed better than using the Instructor embedding numerical features.
This is likely due to the fact that the number of messages is substantially less that the Instructor embeddings (i.e., 100 <math alttext="&lt;" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><mo id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><lt id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">&lt;</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">&lt;</annotation></semantics></math> 768).
We also found a learning rate of <math alttext="10^{-5}" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><msup id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mn id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">10</mn><mrow id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml"><mo id="S3.SS3.p2.7.m7.1.1.3a" xref="S3.SS3.p2.7.m7.1.1.3.cmml">−</mo><mn id="S3.SS3.p2.7.m7.1.1.3.2" xref="S3.SS3.p2.7.m7.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">superscript</csymbol><cn id="S3.SS3.p2.7.m7.1.1.2.cmml" type="integer" xref="S3.SS3.p2.7.m7.1.1.2">10</cn><apply id="S3.SS3.p2.7.m7.1.1.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3"><minus id="S3.SS3.p2.7.m7.1.1.3.1.cmml" xref="S3.SS3.p2.7.m7.1.1.3"></minus><cn id="S3.SS3.p2.7.m7.1.1.3.2.cmml" type="integer" xref="S3.SS3.p2.7.m7.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">10^{-5}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">10 start_POSTSUPERSCRIPT - 5 end_POSTSUPERSCRIPT</annotation></semantics></math> worked best on the validations sets.</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<p class="ltx_p" id="S3.SS3.p3.1">The performance metrics are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.T2" title="TABLE II ‣ III-C Vaccine Messaging Recommendation ‣ III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">II</span></a>, and additional details on the Hit Ratio during training are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.F6" title="Figure 6 ‣ III-C Vaccine Messaging Recommendation ‣ III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">6</span></a>. Once again, the Two-Tower Mamba outperforms the Two-Tower Transformer across all metrics. Notably, the HR@1 for the Two-Tower Mamba is almost twice that of the Two-Tower Transformer for most cluster-message combinations. In practical terms, this suggests that the Two-Tower Mamba would result in nearly double the number of vaccinations after the first message compared to the Two-Tower Transformer.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">As the number of clusters increases, the models’ performance declines, and the same trend occurs if the number of messages increases while keeping clusters fixed. This behavior is somewhat expected, as additional clusters or messages introduce more complexity, requiring more training data to capture the user-message relationship accurately. Furthermore, with more clusters, there are fewer positive user-message interactions in each batch, suggesting that increasing the batch size could be beneficial.</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.1">Similar to the Spotify music recommendation experiment, Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#S3.F5.sf2" title="In Figure 5 ‣ III-A Spotify Music Recommendation ‣ III Experiments ‣ Mamba for Scalable and Efficient Personalized Recommendations"><span class="ltx_text ltx_ref_tag">5(b)</span></a> shows the difference between predicted and actual likes (i.e., the message had a target of 1), with messages ordered by their actual number of likes to allow comparison across seeds. Although the plot shows only 50 actions and 25 clusters, the observed trends apply to other combinations of actions and clusters. First, we see a tendency to underpredict messages with ranks close to 1 and 50. Second, neither model significantly over- nor under-recommends any particular message. Therefore, if deployed in a production setting, this model would generate a diverse set of recommendations, covering a broad range of user-message pairs.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T2.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.2.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.2.1.1.1" rowspan="2"><span class="ltx_text" id="S3.T2.2.1.1.1.1">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S3.T2.2.1.1.1.1.1" style="width:34.7pt;">
<span class="ltx_p" id="S3.T2.2.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.2.1.1.1.1.1.1.1">Number of
<br class="ltx_break"/>Clusters</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.2.1.1.2" rowspan="2"><span class="ltx_text" id="S3.T2.2.1.1.2.1">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S3.T2.2.1.1.2.1.1" style="width:34.7pt;">
<span class="ltx_p" id="S3.T2.2.1.1.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.2.1.1.2.1.1.1.1">Number of
<br class="ltx_break"/>Messages</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" id="S3.T2.2.1.1.3" rowspan="2"><span class="ltx_text" id="S3.T2.2.1.1.3.1">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S3.T2.2.1.1.3.1.1" style="width:30.4pt;">
<span class="ltx_p" id="S3.T2.2.1.1.3.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.2.1.1.3.1.1.1.1">Embedder
<br class="ltx_break"/>Model</span></span>
</span></span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="2" id="S3.T2.2.1.1.4"><span class="ltx_text ltx_font_bold" id="S3.T2.2.1.1.4.1">Precision</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="2" id="S3.T2.2.1.1.5"><span class="ltx_text ltx_font_bold" id="S3.T2.2.1.1.5.1">Recall</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="2" id="S3.T2.2.1.1.6"><span class="ltx_text ltx_font_bold" id="S3.T2.2.1.1.6.1">Mean Reciprocal Rank</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column" colspan="3" id="S3.T2.2.1.1.7"><span class="ltx_text ltx_font_bold" id="S3.T2.2.1.1.7.1">Hit Ratio</span></th>
</tr>
<tr class="ltx_tr" id="S3.T2.2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.2.2.2.1"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.1.1">P@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T2.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.2.1">P@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.2.2.2.3"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.3.1">R@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T2.2.2.2.4"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.4.1">R@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.2.2.2.5"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.5.1">MRR@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T2.2.2.2.6"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.6.1">MRR@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.2.2.2.7"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.7.1">HR@1</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.2.2.2.8"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.8.1">HR@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T2.2.2.2.9"><span class="ltx_text ltx_font_bold" id="S3.T2.2.2.2.9.1">HR@10</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.2.3.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.3.1.1" rowspan="6"><span class="ltx_text" id="S3.T2.2.3.1.1.1">25</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.3.1.2" rowspan="2"><span class="ltx_text" id="S3.T2.2.3.1.2.1">25</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.3.1.3">Mamba</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.3.1.4">0.1794</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.3.1.5">0.0977</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.3.1.6">0.897</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.3.1.7">0.977</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.3.1.8">0.6738</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.3.1.9">0.6848</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.3.1.10">0.5351</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.3.1.11">0.897</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.3.1.12">0.977</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.4.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.4.2.1">Transformer</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.4.2.2">0.1362</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.4.2.3">0.0912</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.4.2.4">0.681</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.4.2.5">0.9119</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.4.2.6">0.3925</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.4.2.7">0.4236</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.4.2.8">0.2355</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.4.2.9">0.681</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.4.2.10">0.9119</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.5.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.5.3.1" rowspan="2"><span class="ltx_text" id="S3.T2.2.5.3.1.1">50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.5.3.2">Mamba</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.5.3.3">0.2597</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.5.3.4">0.1718</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.5.3.5">0.6269</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.5.3.6">0.8219</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.5.3.7">0.4823</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.5.3.8">0.5033</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.5.3.9">0.3719</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.5.3.10">0.6939</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.5.3.11">0.8498</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.6.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.6.4.1">Transformer</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.6.4.2">0.1733</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.6.4.3">0.1366</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.6.4.4">0.4212</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.6.4.5">0.6558</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.6.4.6">0.3167</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.6.4.7">0.3448</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.6.4.8">0.2159</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.6.4.9">0.5129</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.6.4.10">0.7241</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.7.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.7.5.1" rowspan="2"><span class="ltx_text" id="S3.T2.2.7.5.1.1">100</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.7.5.2">Mamba</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.7.5.3">0.2592</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.7.5.4">0.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.7.5.5">0.2939</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.7.5.6">0.4822</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.7.5.7">0.3779</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.7.5.8">0.3985</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.7.5.9">0.2945</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.7.5.10">0.5296</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.7.5.11">0.6856</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.8.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.8.6.1">Transformer</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.8.6.2">0.1536</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.8.6.3">0.14</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.8.6.4">0.1896</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.8.6.5">0.3286</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.8.6.6">0.2519</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.8.6.7">0.2733</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.8.6.8">0.1725</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.8.6.9">0.4042</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.8.6.10">0.5664</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.9.7">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.9.7.1" rowspan="4"><span class="ltx_text" id="S3.T2.2.9.7.1.1">50</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.9.7.2" rowspan="2"><span class="ltx_text" id="S3.T2.2.9.7.2.1">50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.9.7.3">Mamba</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.9.7.4">0.1046</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.9.7.5">0.0729</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.9.7.6">0.523</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.9.7.7">0.7288</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.9.7.8">0.2986</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.9.7.9">0.3262</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.9.7.10">0.1801</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.9.7.11">0.523</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.9.7.12">0.7288</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.10.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.10.8.1">Transformer</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.10.8.2">0.0508</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.10.8.3">0.0463</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.10.8.4">0.254</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.10.8.5">0.4629</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.10.8.6">0.121</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.10.8.7">0.1481</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.10.8.8">0.0568</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.10.8.9">0.254</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.10.8.10">0.4629</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.11.9">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.11.9.1" rowspan="2"><span class="ltx_text" id="S3.T2.2.11.9.1.1">100</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.11.9.2">Mamba</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.11.9.3">0.0884</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.11.9.4">0.076</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.11.9.5">0.1843</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.11.9.6">0.3187</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.11.9.7">0.1705</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.11.9.8">0.189</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.11.9.9">0.1106</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.11.9.10">0.2863</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.11.9.11">0.4272</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.12.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.12.10.1">Transformer</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.12.10.2">0.0498</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.12.10.3">0.0471</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.12.10.4">0.1187</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.12.10.5">0.2275</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.12.10.6">0.0997</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.12.10.7">0.1179</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.12.10.8">0.0512</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.12.10.9">0.1957</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.12.10.10">0.3354</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.13.11">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.13.11.1" rowspan="2"><span class="ltx_text" id="S3.T2.2.13.11.1.1">100</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.13.11.2" rowspan="2"><span class="ltx_text" id="S3.T2.2.13.11.2.1">100</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.13.11.3">Mamba</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.13.11.4">0.0256</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.13.11.5">0.0224</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.13.11.6">0.1281</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.13.11.7">0.2245</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.13.11.8">0.0638</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.2.13.11.9">0.0763</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.13.11.10">0.0323</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.13.11.11">0.1281</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.2.13.11.12">0.2245</td>
</tr>
<tr class="ltx_tr" id="S3.T2.2.14.12">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.14.12.1">Transformer</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.14.12.2">0.0176</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.14.12.3">0.016</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.14.12.4">0.0878</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.14.12.5">0.1595</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.14.12.6">0.0425</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T2.2.14.12.7">0.0517</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.14.12.8">0.0204</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.14.12.9">0.0878</td>
<td class="ltx_td ltx_align_center" id="S3.T2.2.14.12.10">0.1595</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T2.3.1.1" style="font-size:90%;">TABLE II</span>: </span><span class="ltx_text" id="S3.T2.4.2" style="font-size:90%;">Vaccine Messaging Performance Metrics</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Related Works</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Two recent models also handle passing tabular data into the Mamba, but neither focuses on recommendations as we do here.
First, MambaTab <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib1" title="">1</a>]</cite> processes tabular data by encoding the features and then applying a feed-forward neural network to embed the values.
Categorical features are encoded by enumerating the categories and using the index of each category as its feature value.
The categorical features are then combined with the numeric features and passed through a normalization layer, which serves as input to the embedding neural network.
Although this method imposes an arbitrary ordering on the categories, the authors found that it does not negatively affect performance.
Their experiments focus on supervised, self-supervised, and feature-incremental learning tasks.
Second, Mambular <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib27" title="">27</a>]</cite> was developed concurrently with our work.
Similar to FT-Mamba, Mambular combines the FT-Transformer with the Mamba but utilizes periodic encodings (from <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib11" title="">11</a>]</cite>, co-authored by some of the original FT-Transformer contributors) for their numeric features.
n both classification and regression tasks, Mambular achieves similar or improved performance compared to the FT-Transformer and consistently outperforms MambaTab.
However, in classification tasks, XGBoost often delivered the best performance.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">Since Transformers are commonly used in recommendation systems (see <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib24" title="">24</a>]</cite> for a survey), replacing them with the Mamba, similiar to what we have done here, is a natural next step.
While no other papers focus on the specific type of recommendations we explore here, three have used the Mamba for sequential recommendations.
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib20" title="">20</a>]</cite> employs the selective SSM for sequential recommendations, demonstrating state-of-the-art performance compared to other systems.
However, they include a feed-forward neural network after what we call the Mamba layer here, making their Mamba layer quite similar to a Transformer layer.
<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib34" title="">34</a>]</cite>, proposed a few months later, combines the Mamba and Transformer for recommendations, giving rise to the MaTrRec moniker.
Specifically, the MaTrRec block consists of a Mamba block followed by a Transformer block.
Their experiments found that the Mamba has lower recall rates on short sequences.
They hypothesized that the Mamba excels at capturing long-sequence dependencies, while the Transformer is better suited for short sequences.
In the experiments, MaTrRec outperformed other recommendation systems, with Mamba4Rec often being the runner-up.
Finally, the most recent approach is introduced by <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17165v1#bib.bib21" title="">21</a>]</cite>.
They introduce the Partially Flipped Mamba (PF-Mamba), which introduces bidirectional flow into the Mamba by partially flipping the first several terms of the interaction sequence.
The PF-Mamba consists of two Mamba blocks: one standard Mamba block and one that incorporates flipping.
Additionally, to improve modeling of short-term patterns in interaction sequences, they introduce the Feature Extract Gated Recurrent Unit (FE-GRU), which integrates a convolutional layer with a GRU.
These components combine to form their SelectIve Gated MAmba (SIGMA).
In their experiments, SIGMA consistently delivered the best performance, always outperforming Mamba4Rec.
Notably, MaTrRec was not included in the experiments.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Conclusion</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this work we replaced Transformer layers with Mamba layers, and demonstrating how the linear computational complexity of Mamba improves the overall scalability of recommendation models, particularly when dealing with large-scale tabular data.
In addition, we exploited the <span class="ltx_text ltx_font_italic" id="S5.p1.1.1">FT-Mamba</span>, a hybrid model that integrates the Mamba architecture with the FT-Transformer to address scalability and efficiency challenges in personalized recommendation systems.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">Our experiments, conducted on three diverse datasets-Spotify music recommendation, H&amp;M fashion recommendation and vaccine messaging recommendation—show that FT-Mamba consistently outperforms a traditional Transformer-based model in terms of computational efficiency, while maintaining or exceeding performance across several key metrics, including precision, recall, Mean Reciprocal Rank, and Hit Ratio. These results highlight the effectiveness of Mamba’s architecture in reducing computational overhead without sacrificing accuracy.</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">The findings from this study suggest that Mamba offers a promising direction for future developments in scalable machine learning models, particularly for real-time applications requiring personalized recommendations. As recommendation systems continue to evolve with increasingly larger datasets, the FT-Mamba model presents a viable solution for improving both model efficiency and user experience. Future work may focus on exploring additional optimizations to the Mamba architecture and testing its application across broader datasets and real-world recommendation tasks.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Md Atik Ahamed and Qiang Cheng.

</span>
<span class="ltx_bibblock">Mambatab: A simple yet effective approach for handling tabular data.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2401.08867</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Krzysztof Choromanski, Valerii Likhosherstov, David Dohan, Xingyou Song, Andreea Gane, Tamas Sarlos, Peter Hawkins, Jared Davis, Afroz Mohiuddin, Lukasz Kaiser, et al.

</span>
<span class="ltx_bibblock">Rethinking attention with performers.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">International Conference on Learning Representations</span>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Paul Covington, Jay Adams, and Emre Sargin.

</span>
<span class="ltx_bibblock">Deep neural networks for youtube recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 10th ACM conference on recommender systems</span>, pages 191–198, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Tri Dao and Albert Gu.

</span>
<span class="ltx_bibblock">Transformers are ssms: Generalized models and efficient algorithms through structured state space duality.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2405.21060</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Marco De Nadai, Francesco Fabbri, Paul Gigioli, Alice Wang, Ang Li, Fabrizio Silvestri, Laura Kim, Shawn Lin, Vladan Radosavljevic, Sandeep Ghael, et al.

</span>
<span class="ltx_bibblock">Personalized audiobook recommendations at spotify through graph neural networks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">Companion Proceedings of the ACM on Web Conference 2024</span>, pages 403–412, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Anton Dereventsov, Andrew Starnes, and Clayton G Webster.

</span>
<span class="ltx_bibblock">Examining policy entropy of reinforcement learning agents for personalization tasks.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">arXiv preprint arXiv:2211.11869</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Dhruva Dixith Kurra, Bo Ling, Chun Zh, and Seyedshahin Ashrafzadeh.

</span>
<span class="ltx_bibblock">Handling large-scale cardinality in building recommendation systems.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">arXiv e-prints</span>, pages arXiv–2401, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Alaaeldin El-Nouby et al.

</span>
<span class="ltx_bibblock">Training state space models with scanning techniques for faster convergence.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Advances in Neural Information Processing Systems</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Daniel Gillick, Alessandro Presta, and Gaurav Singh Tomar.

</span>
<span class="ltx_bibblock">End-to-end retrieval in continuous space.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">arXiv preprint arXiv:1811.08008</span>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Google.

</span>
<span class="ltx_bibblock">Google colaboratory, 2024.

</span>
<span class="ltx_bibblock">Accessed: 2024-08-19.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Yury Gorishniy, Ivan Rubachev, and Artem Babenko.

</span>
<span class="ltx_bibblock">On embeddings for numerical features in tabular deep learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">Advances in Neural Information Processing Systems</span>, 35:24991–25004, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Yury Gorishniy, Ivan Rubachev, Valentin Khrulkov, and Artem Babenko.

</span>
<span class="ltx_bibblock">Revisiting deep learning models for tabular data.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Advances in Neural Information Processing Systems</span>, 34:18932–18943, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Albert Gu and Tri Dao.

</span>
<span class="ltx_bibblock">Mamba: Linear-time sequence modeling with selective state spaces.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2312.00752</span>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Albert Gu, Karan Goel, and Christopher Ré.

</span>
<span class="ltx_bibblock">Efficiently modeling long sequences with structured state spaces.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2111.00396</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Albert Gu and Christopher Re.

</span>
<span class="ltx_bibblock">State space models for efficient sequence modeling.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">Advances in Neural Information Processing Systems</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Po-Sen Huang, Xiaodong He, Jianfeng Gao, Li Deng, Alex Acero, and Larry Heck.

</span>
<span class="ltx_bibblock">Learning deep structured semantic models for web search using clickthrough data.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 22nd ACM international conference on Information &amp; Knowledge Management</span>, pages 2333–2338, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jacob Devlin Ming-Wei Chang Kenton and Lee Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Proceedings of naacL-HLT</span>, volume 1, page 2, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Xiangyang Li, Bo Chen, HuiFeng Guo, Jingjie Li, Chenxu Zhu, Xiang Long, Sujian Li, Yichao Wang, Wei Guo, Longxia Mao, et al.

</span>
<span class="ltx_bibblock">Inttower: the next generation of two-tower model for pre-ranking system.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management</span>, pages 3292–3301, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Carlos García Ling, ElizabethHMGroup, FridaRim, inversion, Jaime Ferrando, Maggie, neuraloverflow, and xlsrln.

</span>
<span class="ltx_bibblock">H&amp;m personalized fashion recommendations, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Chengkai Liu, Jianghao Lin, Jianling Wang, Hanzhou Liu, and James Caverlee.

</span>
<span class="ltx_bibblock">Mamba4rec: Towards efficient sequential recommendation with selective state space models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2403.03900</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Ziwei Liu, Qidong Liu, Yejing Wang, Wanyu Wang, Pengyue Jia, Maolin Wang, Zitao Liu, Yi Chang, and Xiangyu Zhao.

</span>
<span class="ltx_bibblock">Bidirectional gated mamba for sequential recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2408.11451</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Paul Neculoiu, Maarten Versteegh, and Mihai Rotaru.

</span>
<span class="ltx_bibblock">Learning text similarity with siamese recurrent networks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 1st Workshop on Representation Learning for NLP</span>, pages 148–157, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
OpenAI.

</span>
<span class="ltx_bibblock">Chatgpt: Language model, 2023.

</span>
<span class="ltx_bibblock">Accessed: 2024-08-29.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Husni Iskandar Pohan, Harco Leslie Hendric Spits Warnars, Benfano Soewito, and Ford Lumban Gaol.

</span>
<span class="ltx_bibblock">Recommender system using transformer model: A systematic literature review.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">2022 1st International Conference on Information System &amp; Information Technology (ICISIT)</span>, pages 376–381. IEEE, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Hongjin Su, Weijia Shi, Jungo Kasai, Yizhong Wang, Yushi Hu, Mari Ostendorf, Wen-tau Yih, Noah A Smith, Luke Zettlemoyer, and Tao Yu.

</span>
<span class="ltx_bibblock">One embedder, any task: Instruction-finetuned text embeddings.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">arXiv preprint arXiv:2212.09741</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Yi Tay et al.

</span>
<span class="ltx_bibblock">Long range arena: A benchmark for efficient transformers.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">Advances in Neural Information Processing Systems</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Anton Frederik Thielmann, Manish Kumar, Christoph Weisser, Arik Reuter, Benjamin Säfken, and Soheila Samiee.

</span>
<span class="ltx_bibblock">Mambular: A sequential model for tabular deep learning.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2408.06291</span>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Shikhar Vashishth et al.

</span>
<span class="ltx_bibblock">Scaling transformer models for tabular data using efficient feature tokenization.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">ICLR Workshop on Deep Learning for Tabular Data</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">Advances in neural information processing systems</span>, pages 5998–6008, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Ji Yang, Xinyang Yi, Derek Zhiyuan Cheng, Lichan Hong, Yang Li, Simon Xiaoming Wang, Taibai Xu, and Ed H Chi.

</span>
<span class="ltx_bibblock">Mixed negative sampling for learning two-tower neural networks in recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Companion proceedings of the web conference 2020</span>, pages 441–447, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Xinyang Yi, Ji Yang, Lichan Hong, Derek Zhiyuan Cheng, Lukasz Heldt, Aditee Kumthekar, Zhe Zhao, Li Wei, and Ed Chi.

</span>
<span class="ltx_bibblock">Sampling-bias-corrected neural modeling for large corpus item recommendations.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 13th ACM conference on recommender systems</span>, pages 269–277, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Yantao Yu, Weipeng Wang, Zhoutian Feng, and Daiyue Xue.

</span>
<span class="ltx_bibblock">A dual augmented two-tower model for online large-scale recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">DLP-KDD</span>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Han Zhang, Hongxu Xu, et al.

</span>
<span class="ltx_bibblock">Tabtransformer: A feature tokenizer for tabular data.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib33.1.1">Proceedings of NeurIPS</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Shun Zhang, Runsen Zhang, and Zhirong Yang.

</span>
<span class="ltx_bibblock">Matrrec: Uniting mamba and transformer for sequential recommendation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2407.19239</span>, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 11 14:24:39 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
