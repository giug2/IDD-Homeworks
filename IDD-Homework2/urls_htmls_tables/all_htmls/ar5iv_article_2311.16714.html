<article class="ltx_document ltx_authors_1line">
 <div class="ltx_para" id="p1">
  <span class="ltx_ERROR undefined" id="p1.1">
   \newfloatcommand
  </span>
  <p class="ltx_p" id="p1.2">
   capbtabboxtable[][
   <span class="ltx_ERROR undefined" id="p1.2.1">
    \FBwidth
   </span>
   ]
   <span class="ltx_ERROR undefined" id="p1.2.2">
    \newfloatcommand
   </span>
   capbfigboxfigure[][
   <span class="ltx_ERROR undefined" id="p1.2.3">
    \FBwidth
   </span>
   ]
  </p>
 </div>
 <h1 class="ltx_title ltx_title_document">
  Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Yijun Yang
    <sup class="ltx_sup" id="id15.15.id1">
     <span class="ltx_text ltx_font_italic" id="id15.15.id1.1">
      1,5,4
     </span>
    </sup>
    Tianyi Zhou
    <sup class="ltx_sup" id="id16.16.id2">
     <span class="ltx_text ltx_font_italic" id="id16.16.id2.1">
      2
     </span>
    </sup>
    Kanxue Li
    <sup class="ltx_sup" id="id17.17.id3">
     <span class="ltx_text ltx_font_italic" id="id17.17.id3.1">
      3
     </span>
    </sup>
    Dapeng Tao
    <sup class="ltx_sup" id="id18.18.id4">
     <span class="ltx_text ltx_font_italic" id="id18.18.id4.1">
      3
     </span>
    </sup>
    Lusong Li
    <sup class="ltx_sup" id="id19.19.id5">
     <span class="ltx_text ltx_font_italic" id="id19.19.id5.1">
      4
     </span>
    </sup>
    <br class="ltx_break"/>
    Li Shen
    <sup class="ltx_sup" id="id20.20.id6">
     <span class="ltx_text ltx_font_italic" id="id20.20.id6.1">
      4,∗
     </span>
    </sup>
    Xiaodong He
    <sup class="ltx_sup" id="id21.21.id7">
     <span class="ltx_text ltx_font_italic" id="id21.21.id7.1">
      4
     </span>
    </sup>
    Jing Jiang
    <sup class="ltx_sup" id="id22.22.id8">
     <span class="ltx_text ltx_font_italic" id="id22.22.id8.1">
      5
     </span>
    </sup>
    Yuhui Shi
    <sup class="ltx_sup" id="id23.23.id9">
     <span class="ltx_text ltx_font_italic" id="id23.23.id9.1">
      1,
     </span>
    </sup>
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id24.24.id10">
     <span class="ltx_text ltx_font_italic" id="id24.24.id10.1">
      1
     </span>
    </sup>
    Southern University of Science and Technology
    <sup class="ltx_sup" id="id25.25.id11">
     <span class="ltx_text ltx_font_italic" id="id25.25.id11.1">
      2
     </span>
    </sup>
    University of Maryland, College Park
    <br class="ltx_break"/>
    <sup class="ltx_sup" id="id26.26.id12">
     <span class="ltx_text ltx_font_italic" id="id26.26.id12.1">
      3
     </span>
    </sup>
    Yunnan University
    <sup class="ltx_sup" id="id27.27.id13">
     <span class="ltx_text ltx_font_italic" id="id27.27.id13.1">
      4
     </span>
    </sup>
    JD Explore Academy
    <sup class="ltx_sup" id="id28.28.id14">
     <span class="ltx_text ltx_font_italic" id="id28.28.id14.1">
      5
     </span>
    </sup>
    University of Technology Sydney
    <br class="ltx_break"/>
    <span class="ltx_text ltx_font_typewriter" id="id29.29.id15" style="font-size:90%;">
     yijun.yang-1@student.uts.edu.au, tianyi@umd.edu, mathshenli@gmail.com, shiyh@sustech.edu.cn
    </span>
   </span>
   <span class="ltx_author_notes">
    Corresponding author
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id30.id1">
   While large language models (LLMs) excel in a simulated world of texts, they struggle to interact with the more realistic world without perceptions of other modalities such as visual or audio signals. Although vision-language models (VLMs) integrate LLM modules (1) aligned with static image features, and (2) may possess prior knowledge of world dynamics (as demonstrated in the text world), they have not been trained in an embodied visual world and thus
   <span class="ltx_text ltx_font_bold" id="id30.id1.1">
    cannot align with its dynamics
   </span>
   . On the other hand, training an embodied agent in a noisy visual world without expert guidance is often challenging and inefficient.
In this paper, we train a VLM agent living in a visual world using an LLM agent excelling in a parallel text world (but inapplicable to the visual world).
Specifically, we distill LLM’s reflection outcomes (improved actions by analyzing mistakes) in a text world’s tasks to finetune the VLM on the same tasks of the visual world, resulting in an
   <span class="ltx_text ltx_font_bold" id="id30.id1.2">
    E
   </span>
   mbodied
   <span class="ltx_text ltx_font_bold" id="id30.id1.3">
    M
   </span>
   ulti-
   <span class="ltx_text ltx_font_bold" id="id30.id1.4">
    M
   </span>
   odal
   <span class="ltx_text ltx_font_bold" id="id30.id1.5">
    A
   </span>
   gent (
   <span class="ltx_text ltx_font_bold" id="id30.id1.6">
    EMMA
   </span>
   ) quickly adapting to the visual world dynamics. Such
   <span class="ltx_text ltx_font_bold" id="id30.id1.7">
    cross-modality imitation learning between the two parallel worlds
   </span>
   enables EMMA to generalize to a broad scope of new tasks without any further guidance from the LLM expert. Extensive evaluations on the ALFWorld benchmark highlight EMMA’s superior performance to SOTA VLM-based agents across diverse tasks, e.g., 20%-70% improvement in the success rate.
  </p>
 </div>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    Embodied multi-modal agents have been acknowledged as a pivotal stride towards achieving Artificial General Intelligence (AGI), as they encompass the potential for a broadened range of intelligent activities
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib57" title="">
      <span class="ltx_text" style="font-size:90%;">
       57
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib23" title="">
      <span class="ltx_text" style="font-size:90%;">
       23
      </span>
     </a>
     ]
    </cite>
    . The rise of foundation models brings a glimmer of hope for constructing such agents
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib28" title="">
      <span class="ltx_text" style="font-size:90%;">
       28
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib30" title="">
      <span class="ltx_text" style="font-size:90%;">
       30
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib8" title="">
      <span class="ltx_text" style="font-size:90%;">
       8
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib67" title="">
      <span class="ltx_text" style="font-size:90%;">
       67
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib33" title="">
      <span class="ltx_text" style="font-size:90%;">
       33
      </span>
     </a>
     ]
    </cite>
    , and notable efforts from the community have tried to harness them in many decision-making scenarios, e.g., autonomous driving
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib12" title="">
      <span class="ltx_text" style="font-size:90%;">
       12
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib60" title="">
      <span class="ltx_text" style="font-size:90%;">
       60
      </span>
     </a>
     ]
    </cite>
    , daily household robots
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib11" title="">
      <span class="ltx_text" style="font-size:90%;">
       11
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib3" title="">
      <span class="ltx_text" style="font-size:90%;">
       3
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib68" title="">
      <span class="ltx_text" style="font-size:90%;">
       68
      </span>
     </a>
     ]
    </cite>
    , and complex manipulation tasks
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib21" title="">
      <span class="ltx_text" style="font-size:90%;">
       21
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib37" title="">
      <span class="ltx_text" style="font-size:90%;">
       37
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib52" title="">
      <span class="ltx_text" style="font-size:90%;">
       52
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib25" title="">
      <span class="ltx_text" style="font-size:90%;">
       25
      </span>
     </a>
     ]
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    LLMs can perform as reflex agents interacting with a text world via textual descriptions (observations) of the world states and textual actions. In addition, LLMs exhibit great potential in planning, reflection, and reward shaping. This is mainly due to their reasoning capability and semantic abstraction of the world. However, LLM-based agents cannot be directly applied in a visual world.
On the contrary, it is still challenging to train an agent in a visual world due to its complexity, the lack of semantic structures in the perceived pixels, and the noises of the visual signals, which cannot be fully handled by the current vision models such as ViT
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib10" title="">
      <span class="ltx_text" style="font-size:90%;">
       10
      </span>
     </a>
     ]
    </cite>
    .
Although SOTA large VLMs align LLMs with vision models, their pretraining only focuses on static alignment between image-text pairs so the resulting agents have not been aligned well with the dynamics of the visual world.
As shown in Fig.
    <span class="ltx_ref ltx_missing_label ltx_ref_self">
     LABEL:fig:teaser
    </span>
    (a), even the SOTA VLM, e.g., GPT-4V(ision)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib39" title="">
      <span class="ltx_text" style="font-size:90%;">
       39
      </span>
     </a>
     ]
    </cite>
    , fails to accomplish tasks in the embodied ALFWorld environment
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib51" title="">
      <span class="ltx_text" style="font-size:90%;">
       51
      </span>
     </a>
     ]
    </cite>
    . In such a zero-shot setting, GPT-4V tends to mainly rely on its language prior about the objects (laptop) detected in the current step, rather than the alignment between the visual input and the environment dynamics conditioned on the task instruction.
    <span class="ltx_text ltx_font_italic" id="S1.p2.1.1">
     How can we finetune a VLM to be an embodied agent with
     <span class="ltx_text ltx_font_bold" id="S1.p2.1.1.1">
      dynamic alignment to the visual world?
     </span>
    </span>
    Moreover, LLMs’ capability is weakened in VLMs since their (partial) inputs are replaced by noisy and inaccurate representations from the vision modules. Furthermore, various VLMs cannot use the most powerful LLMs as their language modules since they are close-sourced.
    <span class="ltx_text ltx_font_italic" id="S1.p2.1.2">
     Can we transfer the skills of API LLM reflex agents in a text world to a VLM agent in a visual world?
    </span>
   </p>
  </div>
  <div class="ltx_para" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    In this paper, we study how to train a VLM towards an embodied reflex agent in a visual world by aligning it with the visual world dynamics and distilling the skills of an API LLM agent in a parallel text world. Our overarching goal is to build such an
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.1">
     E
    </span>
    mbodied
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.2">
     M
    </span>
    ulti-
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.3">
     M
    </span>
    odal
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.4">
     A
    </span>
    gent (
    <span class="ltx_text ltx_font_bold" id="S1.p3.1.5">
     EMMA
    </span>
    ) that can take a textual task description (e.g., from human users) and pixel observations of the state per step to produce a sequence of actions leading to the efficient completion of the task. This is a challenging problem due to (1) the sparsity of the task reward, (2) the noisy visual representations, (3) the hallucinations of the VLM, and (4) the misalignment of VLM’s static representations to the visual world dynamics. While static distillation and imitation of a powerful LLM agent in a parallel text world can potentially address the former two challenges, the latter two can be mitigated by finetuning the VLM as an interactive agent in the embodied visual environment.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="298" id="S1.F1.g1" src="/html/2311.16714/assets/x1.png" width="461"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S1.F1.3.1.1" style="font-size:90%;">
      Figure 1
     </span>
     :
    </span>
    <span class="ltx_text ltx_font_bold" id="S1.F1.4.2" style="font-size:90%;">
     An example of tasks generated for the two parallel worlds.
     <span class="ltx_text ltx_font_medium" id="S1.F1.4.2.1">
      A VLM agent in the visual world and an LLM agent in the text world as household robots instructed to clean an apple and then put it into the fridge.
     </span>
    </span>
   </figcaption>
  </figure>
  <div class="ltx_para" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    To this end, we finetune a VLM agent in an embodied visual world by imitation learning from an API LLM expert (e.g., built on ChatGPT) launched in a parallel text world on the same tasks.
Specifically, in each step of EMMA interacting with the visual world,
we convert its visual observation into an equivalent textual description sent to the LLM agent, which produces an action for EMMA to imitate. Our
    <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">
     cross-modality interactive imitation learning
    </span>
    is based on DAgger
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib46" title="">
      <span class="ltx_text" style="font-size:90%;">
       46
      </span>
     </a>
     ]
    </cite>
    , which overcomes the cumulative errors and distribution shifts of behavior cloning (BC). As depicted in Fig.
    <span class="ltx_ref ltx_missing_label ltx_ref_self">
     LABEL:fig:teaser
    </span>
    (b), an InstructBLIP
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib8" title="">
      <span class="ltx_text" style="font-size:90%;">
       8
      </span>
     </a>
     ]
    </cite>
    agent finetuned by BC on 170K expert demonstrations produced by a rule-based expert in the visual world still fails to take correct actions based on visual observations. We further improve the DAgger’s objective to be the direct preference optimization (DPO)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib43" title="">
      <span class="ltx_text" style="font-size:90%;">
       43
      </span>
     </a>
     ]
    </cite>
    , which maximizes the preference of LLM actions over VLM actions.
To collect better teaching signals retrospective to the VLM student’s actions, the LLM expert is composed of an LLM actor prompted to output expert actions, and an LLM critic prompted for reflection feedback on the VLM agent’s historical trajectories. We maintain a long-term memory storing the LLM feedback, which is then used to induce the actor to improve actions for imitation in future episodes.
   </p>
  </div>
  <div class="ltx_para" id="S1.p5">
   <p class="ltx_p" id="S1.p5.1">
    We evaluate EMMA and compare it with vision-only agents, LLM agents, and VLM agents deployed to the ALFWorld benchmark, which includes hundreds of tasks in both visual and textual environments. Extensive experiments highlight that EMMA substantially outperforms SOTA VLM agents in visual-only environments by 20%-70% in terms of success rate. In addition, EMMA is the only VLM agent that can generalize to open-vocabulary and free-form test tasks, shedding novel insights on using LLM feedback to train more versatile and generalizable embodied agents in multi-modality environments.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F2">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="192" id="S1.F2.g1" src="/html/2311.16714/assets/x2.png" width="502"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S1.F2.3.1.1" style="font-size:90%;">
      Figure 2
     </span>
     :
    </span>
    <span class="ltx_text ltx_font_bold" id="S1.F2.4.2" style="font-size:90%;">
     Embodied Multi-Modal Agent (EMMA) trained by an LLM expert via cross-modality imitation learning.
     <span class="ltx_text ltx_font_medium" id="S1.F2.4.2.1">
      EMMA takes a textual task description and pixel observations as its input state per step to generate a sequence of actions using a VLM. Then, we convert each pixel observation into a textual equivalent as the context of an LLM expert to produce imporved actions for EMMA to imitate.
     </span>
    </span>
   </figcaption>
  </figure>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Embodied Multi-Modal Agent
  </h2>
  <div class="ltx_para" id="S2.p1">
   <p class="ltx_p" id="S2.p1.1">
    Fig.
    <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    illustrates the main idea of “Embodied Multi-Modal Agent (EMMA)”, whose detailed training procedures are given in Alg.
    <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    . EMMA is built upon a modularized VLM that can follow instructions and interact with the environment through pixel observations and textual actions. To overcome the training challenges associated with EMMA, such as sparse rewards and distribution shifts, we explore the construction of an LLM expert based on a parallel TextWorld, which can provide EMMA with step-by-step guidance. Hence, in Sec.
    <a class="ltx_ref" href="#S2.SS3" title="2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
     <span class="ltx_text ltx_ref_tag">
      2.3
     </span>
    </a>
    , we further discuss how to harness the LLM expert to train EMMA via cross-modality interactive imitation learning. Code is available at
    <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/stevenyangyj/Emma-Alfworld" target="_blank" title="">
     https://github.com/stevenyangyj/Emma-Alfworld
    </a>
   </p>
  </div>
  <section class="ltx_subsection" id="S2.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.1
    </span>
    EMMA in the Visual World
   </h3>
   <div class="ltx_para" id="S2.SS1.p1">
    <p class="ltx_p" id="S2.SS1.p1.7">
     In visual environments, the Embodied Multi-Modal Agent (EMMA), denoted as
     <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1">
      <semantics id="S2.SS1.p1.1.m1.1a">
       <msub id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">
        <mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">
         π
        </mi>
        <mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b">
        <apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">
         <csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">
          𝜋
         </ci>
         <ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">
        \pi_{\theta}
       </annotation>
      </semantics>
     </math>
     , is designed to process a task description
     <math alttext="x_{\text{task}}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1">
      <semantics id="S2.SS1.p1.2.m2.1a">
       <msub id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">
        <mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">
         x
        </mi>
        <mtext id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3a.cmml">
         task
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b">
        <apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">
         <csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">
          𝑥
         </ci>
         <ci id="S2.SS1.p1.2.m2.1.1.3a.cmml" xref="S2.SS1.p1.2.m2.1.1.3">
          <mtext id="S2.SS1.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p1.2.m2.1.1.3">
           task
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">
        x_{\text{task}}
       </annotation>
      </semantics>
     </math>
     (e.g., instructions from human users) and pixel observations
     <math alttext="s_{v}^{t}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1">
      <semantics id="S2.SS1.p1.3.m3.1a">
       <msubsup id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">
        <mi id="S2.SS1.p1.3.m3.1.1.2.2" xref="S2.SS1.p1.3.m3.1.1.2.2.cmml">
         s
        </mi>
        <mi id="S2.SS1.p1.3.m3.1.1.2.3" xref="S2.SS1.p1.3.m3.1.1.2.3.cmml">
         v
        </mi>
        <mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">
         t
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b">
        <apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">
         <csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">
          superscript
         </csymbol>
         <apply id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1">
          <csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.1">
           subscript
          </csymbol>
          <ci id="S2.SS1.p1.3.m3.1.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2.2">
           𝑠
          </ci>
          <ci id="S2.SS1.p1.3.m3.1.1.2.3.cmml" xref="S2.SS1.p1.3.m3.1.1.2.3">
           𝑣
          </ci>
         </apply>
         <ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">
        s_{v}^{t}
       </annotation>
      </semantics>
     </math>
     at each step
     <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1">
      <semantics id="S2.SS1.p1.4.m4.1a">
       <mi id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b">
        <ci id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">
        t
       </annotation>
      </semantics>
     </math>
     . Its objective is to generate a sequence of high-level textual actions
     <math alttext="\{x_{a}^{t}\sim\pi_{\theta}(\cdot|x_{\text{task}},s_{v}^{t})\}_{t=0}^{T}" class="ltx_math_unparsed" display="inline" id="S2.SS1.p1.5.m5.1">
      <semantics id="S2.SS1.p1.5.m5.1a">
       <msubsup id="S2.SS1.p1.5.m5.1.1">
        <mrow id="S2.SS1.p1.5.m5.1.1.2.2">
         <mo id="S2.SS1.p1.5.m5.1.1.2.2.1" stretchy="false">
          {
         </mo>
         <msubsup id="S2.SS1.p1.5.m5.1.1.2.2.2">
          <mi id="S2.SS1.p1.5.m5.1.1.2.2.2.2.2">
           x
          </mi>
          <mi id="S2.SS1.p1.5.m5.1.1.2.2.2.2.3">
           a
          </mi>
          <mi id="S2.SS1.p1.5.m5.1.1.2.2.2.3">
           t
          </mi>
         </msubsup>
         <mo id="S2.SS1.p1.5.m5.1.1.2.2.3">
          ∼
         </mo>
         <msub id="S2.SS1.p1.5.m5.1.1.2.2.4">
          <mi id="S2.SS1.p1.5.m5.1.1.2.2.4.2">
           π
          </mi>
          <mi id="S2.SS1.p1.5.m5.1.1.2.2.4.3">
           θ
          </mi>
         </msub>
         <mrow id="S2.SS1.p1.5.m5.1.1.2.2.5">
          <mo id="S2.SS1.p1.5.m5.1.1.2.2.5.1" stretchy="false">
           (
          </mo>
          <mo id="S2.SS1.p1.5.m5.1.1.2.2.5.2" lspace="0em" rspace="0em">
           ⋅
          </mo>
          <mo fence="false" id="S2.SS1.p1.5.m5.1.1.2.2.5.3" rspace="0.167em" stretchy="false">
           |
          </mo>
          <msub id="S2.SS1.p1.5.m5.1.1.2.2.5.4">
           <mi id="S2.SS1.p1.5.m5.1.1.2.2.5.4.2">
            x
           </mi>
           <mtext id="S2.SS1.p1.5.m5.1.1.2.2.5.4.3">
            task
           </mtext>
          </msub>
          <mo id="S2.SS1.p1.5.m5.1.1.2.2.5.5">
           ,
          </mo>
          <msubsup id="S2.SS1.p1.5.m5.1.1.2.2.5.6">
           <mi id="S2.SS1.p1.5.m5.1.1.2.2.5.6.2.2">
            s
           </mi>
           <mi id="S2.SS1.p1.5.m5.1.1.2.2.5.6.2.3">
            v
           </mi>
           <mi id="S2.SS1.p1.5.m5.1.1.2.2.5.6.3">
            t
           </mi>
          </msubsup>
          <mo id="S2.SS1.p1.5.m5.1.1.2.2.5.7" stretchy="false">
           )
          </mo>
         </mrow>
         <mo id="S2.SS1.p1.5.m5.1.1.2.2.6" stretchy="false">
          }
         </mo>
        </mrow>
        <mrow id="S2.SS1.p1.5.m5.1.1.2.3">
         <mi id="S2.SS1.p1.5.m5.1.1.2.3.2">
          t
         </mi>
         <mo id="S2.SS1.p1.5.m5.1.1.2.3.1">
          =
         </mo>
         <mn id="S2.SS1.p1.5.m5.1.1.2.3.3">
          0
         </mn>
        </mrow>
        <mi id="S2.SS1.p1.5.m5.1.1.3">
         T
        </mi>
       </msubsup>
       <annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1b">
        \{x_{a}^{t}\sim\pi_{\theta}(\cdot|x_{\text{task}},s_{v}^{t})\}_{t=0}^{T}
       </annotation>
      </semantics>
     </math>
     <span class="ltx_note ltx_role_footnote" id="footnote1">
      <sup class="ltx_note_mark">
       1
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         1
        </sup>
        <span class="ltx_tag ltx_tag_note">
         1
        </span>
        For brevity, we omit
        <math alttext="x_{\text{task}}" class="ltx_Math" display="inline" id="footnote1.m1.1">
         <semantics id="footnote1.m1.1b">
          <msub id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">
           <mi id="footnote1.m1.1.1.2" xref="footnote1.m1.1.1.2.cmml">
            x
           </mi>
           <mtext id="footnote1.m1.1.1.3" xref="footnote1.m1.1.1.3a.cmml">
            task
           </mtext>
          </msub>
          <annotation-xml encoding="MathML-Content" id="footnote1.m1.1c">
           <apply id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">
            <csymbol cd="ambiguous" id="footnote1.m1.1.1.1.cmml" xref="footnote1.m1.1.1">
             subscript
            </csymbol>
            <ci id="footnote1.m1.1.1.2.cmml" xref="footnote1.m1.1.1.2">
             𝑥
            </ci>
            <ci id="footnote1.m1.1.1.3a.cmml" xref="footnote1.m1.1.1.3">
             <mtext id="footnote1.m1.1.1.3.cmml" mathsize="70%" xref="footnote1.m1.1.1.3">
              task
             </mtext>
            </ci>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="footnote1.m1.1d">
           x_{\text{task}}
          </annotation>
         </semantics>
        </math>
        in the rest of this paper.
       </span>
      </span>
     </span>
     towards efficient completion of the task.
To achieve this, we draw inspiration from recent advances of large pretrained VLMs
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib8" title="">
       <span class="ltx_text" style="font-size:90%;">
        8
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib30" title="">
       <span class="ltx_text" style="font-size:90%;">
        30
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib67" title="">
       <span class="ltx_text" style="font-size:90%;">
        67
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib33" title="">
       <span class="ltx_text" style="font-size:90%;">
        33
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib28" title="">
       <span class="ltx_text" style="font-size:90%;">
        28
       </span>
      </a>
      ]
     </cite>
     , and modularize EMMA’s architecture into three components: (1) a pretrained ViT as the vision encoder that encodes
     <math alttext="s_{v}" class="ltx_Math" display="inline" id="S2.SS1.p1.6.m6.1">
      <semantics id="S2.SS1.p1.6.m6.1a">
       <msub id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">
        <mi id="S2.SS1.p1.6.m6.1.1.2" xref="S2.SS1.p1.6.m6.1.1.2.cmml">
         s
        </mi>
        <mi id="S2.SS1.p1.6.m6.1.1.3" xref="S2.SS1.p1.6.m6.1.1.3.cmml">
         v
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b">
        <apply id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">
         <csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS1.p1.6.m6.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.2">
          𝑠
         </ci>
         <ci id="S2.SS1.p1.6.m6.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.3">
          𝑣
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">
        s_{v}
       </annotation>
      </semantics>
     </math>
     into visual embeddings; (2) a querying transformer (Q-Former) that is tailored to extract the most relevant visual features via the cross-attention between the visual embeddings and query tokens, and then feeds them into an LLM through a linear projection layer; (3) a pretrained LLM as the language decoder that takes the concatenation of the instruction tokens and the output of the linear projection layer to autoregressively generate the textual action
     <math alttext="x_{a}" class="ltx_Math" display="inline" id="S2.SS1.p1.7.m7.1">
      <semantics id="S2.SS1.p1.7.m7.1a">
       <msub id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">
        <mi id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml">
         x
        </mi>
        <mi id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">
         a
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b">
        <apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">
         <csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2">
          𝑥
         </ci>
         <ci id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3">
          𝑎
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">
        x_{a}
       </annotation>
      </semantics>
     </math>
     .
To reduce computational overhead and prevent catastrophic forgetting
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib32" title="">
       <span class="ltx_text" style="font-size:90%;">
        32
       </span>
      </a>
      ]
     </cite>
     , we directly use the pretrained ViT, Q-Former, and LLM from InstructBLIP
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib8" title="">
       <span class="ltx_text" style="font-size:90%;">
        8
       </span>
      </a>
      ]
     </cite>
     and keep them frozen during finetuning, while updating only the parameters of the linear projection layer, as illustrated in Fig.
     <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     . Such a modularized architecture enables EMMA to integrate any existing pretrained vision models and LLMs in a flexible and computationally-efficient way.
    </p>
   </div>
   <div class="ltx_para" id="S2.SS1.p2">
    <p class="ltx_p" id="S2.SS1.p2.1">
     However, deploying EMMA into complex visual environments remains challenging. One of the main obstacles is that the direct use of any pretrained VLM as EMMA’s backbone, without additional finetuning, is suboptimal. This suboptimality arises because existing pretraining only focuses on static alignment between image-text pairs
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib30" title="">
       <span class="ltx_text" style="font-size:90%;">
        30
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib8" title="">
       <span class="ltx_text" style="font-size:90%;">
        8
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib28" title="">
       <span class="ltx_text" style="font-size:90%;">
        28
       </span>
      </a>
      ]
     </cite>
     , so the resulting agent may struggle to reason about the dynamics of the environment.
As discussed in Sec.
     <a class="ltx_ref" href="#S1" title="1 Introduction ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , even the SOTA VLM, i.e., GPT-4V, fails to accomplish tasks in the embodied ALFWorld environment
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib51" title="">
       <span class="ltx_text" style="font-size:90%;">
        51
       </span>
      </a>
      ]
     </cite>
     . In such a zero-shot setting, GPT-4V tends to rely on the linguistic prior of the currently detected objects, rather than the given task instruction and the underlying dynamics of the environment, to guide the interactions.
Moreover, finetuning a pretrained VLM using a pre-collected demonstration dataset is also suboptimal due to the diversity of environments and tasks
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib68" title="">
       <span class="ltx_text" style="font-size:90%;">
        68
       </span>
      </a>
      ]
     </cite>
     , the scarcity of large-scale expert annotations
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib40" title="">
       <span class="ltx_text" style="font-size:90%;">
        40
       </span>
      </a>
      ]
     </cite>
     as well as the challenges posed by distribution shifts
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib27" title="">
       <span class="ltx_text" style="font-size:90%;">
        27
       </span>
      </a>
      ]
     </cite>
     .
A seemingly natural solution to align EMMA with the environment dynamics is reinforcement learning from environmental feedback (RLEF)
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib62" title="">
       <span class="ltx_text" style="font-size:90%;">
        62
       </span>
      </a>
      ]
     </cite>
     , in which reward signals rely on decomposing a task into a sequence of reasonable sub-goals and checking their completion. However, in real-world scenarios, most sub-goals cannot be defined or described precisely, so the reward is sparse; hence, we do not expect RLEF to be effective.
    </p>
   </div>
   <div class="ltx_para" id="S2.SS1.p3">
    <p class="ltx_p" id="S2.SS1.p3.1">
     To this end, we propose to leverage an interactive imitation learning (IL) to align EMMA with dynamics of any environment, which however introduces two critical algorithmic challenges: (1) How to obtain a high-quality, accessible, and scalable expert that EMMA can query during IL (Sec.
     <a class="ltx_ref" href="#S2.SS2" title="2.2 LLM Expert from a Parallel TextWorld ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       2.2
      </span>
     </a>
     )? (2) Designing an effective strategy to train EMMA using this expert in complex, diverse, and potentially open-ended environments (Sec.
     <a class="ltx_ref" href="#S2.SS3" title="2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       2.3
      </span>
     </a>
     ).
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S2.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.2
    </span>
    LLM Expert from a Parallel TextWorld
   </h3>
   <div class="ltx_para" id="S2.SS2.p1">
    <p class="ltx_p" id="S2.SS2.p1.2">
     Thanks to a series of prompting techniques in the realm of in-context learning, such as chain-of-thought
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib56" title="">
       <span class="ltx_text" style="font-size:90%;">
        56
       </span>
      </a>
      ]
     </cite>
     , tree-of-thought
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib64" title="">
       <span class="ltx_text" style="font-size:90%;">
        64
       </span>
      </a>
      ]
     </cite>
     , ReAct
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib65" title="">
       <span class="ltx_text" style="font-size:90%;">
        65
       </span>
      </a>
      ]
     </cite>
     , and Reflexion
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib49" title="">
       <span class="ltx_text" style="font-size:90%;">
        49
       </span>
      </a>
      ]
     </cite>
     , pretrained LLMs have demonstrated impressive zero-shot performance across many decision-making scenarios
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib12" title="">
       <span class="ltx_text" style="font-size:90%;">
        12
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib60" title="">
       <span class="ltx_text" style="font-size:90%;">
        60
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib11" title="">
       <span class="ltx_text" style="font-size:90%;">
        11
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib3" title="">
       <span class="ltx_text" style="font-size:90%;">
        3
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib68" title="">
       <span class="ltx_text" style="font-size:90%;">
        68
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib21" title="">
       <span class="ltx_text" style="font-size:90%;">
        21
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib37" title="">
       <span class="ltx_text" style="font-size:90%;">
        37
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib52" title="">
       <span class="ltx_text" style="font-size:90%;">
        52
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib25" title="">
       <span class="ltx_text" style="font-size:90%;">
        25
       </span>
      </a>
      ]
     </cite>
     . Despite the great potential of serving as high-quality and scalable experts, they are only able to interact with the environment via textual descriptions of the states, rather than using raw pixel observations like EMMA.
To bridge this gap, we convert each pixel observation
     <math alttext="s_{v}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1">
      <semantics id="S2.SS2.p1.1.m1.1a">
       <msub id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">
        <mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">
         s
        </mi>
        <mi id="S2.SS2.p1.1.m1.1.1.3" xref="S2.SS2.p1.1.m1.1.1.3.cmml">
         v
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b">
        <apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">
         <csymbol cd="ambiguous" id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">
          𝑠
         </ci>
         <ci id="S2.SS2.p1.1.m1.1.1.3.cmml" xref="S2.SS2.p1.1.m1.1.1.3">
          𝑣
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">
        s_{v}
       </annotation>
      </semantics>
     </math>
     into a textual equivalent by extracting its metadata from the simulator
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib26" title="">
       <span class="ltx_text" style="font-size:90%;">
        26
       </span>
      </a>
      ]
     </cite>
     , which encompasses attributes such as
     <span class="ltx_text ltx_font_typewriter" id="S2.SS2.p1.2.1">
      Observed Objects
     </span>
     ,
     <span class="ltx_text ltx_font_typewriter" id="S2.SS2.p1.2.2">
      Observed Relations
     </span>
     ,
     <span class="ltx_text ltx_font_typewriter" id="S2.SS2.p1.2.3">
      Inventory
     </span>
     , and
     <span class="ltx_text ltx_font_typewriter" id="S2.SS2.p1.2.4">
      Location
     </span>
     . We then employ the Planning Domain Definition Language (PDDL)
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib1" title="">
       <span class="ltx_text" style="font-size:90%;">
        1
       </span>
      </a>
      ]
     </cite>
     to describe this metadata and create an equivalent textual description/state
     <math alttext="s_{l}" class="ltx_Math" display="inline" id="S2.SS2.p1.2.m2.1">
      <semantics id="S2.SS2.p1.2.m2.1a">
       <msub id="S2.SS2.p1.2.m2.1.1" xref="S2.SS2.p1.2.m2.1.1.cmml">
        <mi id="S2.SS2.p1.2.m2.1.1.2" xref="S2.SS2.p1.2.m2.1.1.2.cmml">
         s
        </mi>
        <mi id="S2.SS2.p1.2.m2.1.1.3" xref="S2.SS2.p1.2.m2.1.1.3.cmml">
         l
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.2.m2.1b">
        <apply id="S2.SS2.p1.2.m2.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">
         <csymbol cd="ambiguous" id="S2.SS2.p1.2.m2.1.1.1.cmml" xref="S2.SS2.p1.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS2.p1.2.m2.1.1.2.cmml" xref="S2.SS2.p1.2.m2.1.1.2">
          𝑠
         </ci>
         <ci id="S2.SS2.p1.2.m2.1.1.3.cmml" xref="S2.SS2.p1.2.m2.1.1.3">
          𝑙
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.2.m2.1c">
        s_{l}
       </annotation>
      </semantics>
     </math>
     using the TextWorld engine
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib7" title="">
       <span class="ltx_text" style="font-size:90%;">
        7
       </span>
      </a>
      ]
     </cite>
     . Additional details are available in Appendix
     <a class="ltx_ref" href="#S7" title="7 Parallel TextWorld ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     and an example of this process is illustrated in Fig.
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     . This methodology enables the utilization of any pretrained LLM agent (e.g., based on ChatGPT) from the parallel TextWorld, generating a sequence of actions that facilitates the training of EMMA through cross-modality IL between the two agents.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S2.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.3
    </span>
    Training EMMA via Cross-Modality Imitation
   </h3>
   <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg1.2.1.1">
       Algorithm 1
      </span>
     </span>
     Training EMMA with a single task instruction
    </figcaption>
    <div class="ltx_listing ltx_listing" id="alg1.3">
     <div class="ltx_listingline" id="alg1.l1">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l1.2.1.1" style="font-size:80%;">
        1:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l1.1">
       initialize:
       <math alttext="i=0" class="ltx_Math" display="inline" id="alg1.l1.1.m1.1">
        <semantics id="alg1.l1.1.m1.1a">
         <mrow id="alg1.l1.1.m1.1.1" xref="alg1.l1.1.m1.1.1.cmml">
          <mi id="alg1.l1.1.m1.1.1.2" xref="alg1.l1.1.m1.1.1.2.cmml">
           i
          </mi>
          <mo id="alg1.l1.1.m1.1.1.1" xref="alg1.l1.1.m1.1.1.1.cmml">
           =
          </mo>
          <mn id="alg1.l1.1.m1.1.1.3" xref="alg1.l1.1.m1.1.1.3.cmml">
           0
          </mn>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="alg1.l1.1.m1.1b">
          <apply id="alg1.l1.1.m1.1.1.cmml" xref="alg1.l1.1.m1.1.1">
           <eq id="alg1.l1.1.m1.1.1.1.cmml" xref="alg1.l1.1.m1.1.1.1">
           </eq>
           <ci id="alg1.l1.1.m1.1.1.2.cmml" xref="alg1.l1.1.m1.1.1.2">
            𝑖
           </ci>
           <cn id="alg1.l1.1.m1.1.1.3.cmml" type="integer" xref="alg1.l1.1.m1.1.1.3">
            0
           </cn>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l1.1.m1.1c">
          i=0
         </annotation>
        </semantics>
       </math>
      </span>
      ,
      <math alttext="\mathcal{D}\leftarrow\varnothing" class="ltx_Math" display="inline" id="alg1.l1.m1.1">
       <semantics id="alg1.l1.m1.1a">
        <mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">
          𝒟
         </mi>
         <mo id="alg1.l1.m1.1.1.1" stretchy="false" xref="alg1.l1.m1.1.1.1.cmml">
          ←
         </mo>
         <mi id="alg1.l1.m1.1.1.3" mathvariant="normal" xref="alg1.l1.m1.1.1.3.cmml">
          ∅
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b">
         <apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">
          <ci id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1">
           ←
          </ci>
          <ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">
           𝒟
          </ci>
          <emptyset id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">
          </emptyset>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m1.1c">
         \mathcal{D}\leftarrow\varnothing
        </annotation>
       </semantics>
      </math>
      , EMMA
      <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.l1.m2.1">
       <semantics id="alg1.l1.m2.1a">
        <msub id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">
         <mi id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">
          π
         </mi>
         <mi id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">
          θ
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b">
         <apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1.2">
           𝜋
          </ci>
          <ci id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">
           𝜃
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m2.1c">
         \pi_{\theta}
        </annotation>
       </semantics>
      </math>
      , LLM actor
      <math alttext="M_{a}" class="ltx_Math" display="inline" id="alg1.l1.m3.1">
       <semantics id="alg1.l1.m3.1a">
        <msub id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">
         <mi id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">
          M
         </mi>
         <mi id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">
          a
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b">
         <apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">
          <csymbol cd="ambiguous" id="alg1.l1.m3.1.1.1.cmml" xref="alg1.l1.m3.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l1.m3.1.1.2.cmml" xref="alg1.l1.m3.1.1.2">
           𝑀
          </ci>
          <ci id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3">
           𝑎
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m3.1c">
         M_{a}
        </annotation>
       </semantics>
      </math>
      with a FIFO memory pool
      <math alttext="\mathcal{P}\leftarrow\varnothing" class="ltx_Math" display="inline" id="alg1.l1.m4.1">
       <semantics id="alg1.l1.m4.1a">
        <mrow id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">
          𝒫
         </mi>
         <mo id="alg1.l1.m4.1.1.1" stretchy="false" xref="alg1.l1.m4.1.1.1.cmml">
          ←
         </mo>
         <mi id="alg1.l1.m4.1.1.3" mathvariant="normal" xref="alg1.l1.m4.1.1.3.cmml">
          ∅
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b">
         <apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">
          <ci id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1.1">
           ←
          </ci>
          <ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">
           𝒫
          </ci>
          <emptyset id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3">
          </emptyset>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m4.1c">
         \mathcal{P}\leftarrow\varnothing
        </annotation>
       </semantics>
      </math>
      , LLM critic
      <math alttext="M_{c}" class="ltx_Math" display="inline" id="alg1.l1.m5.1">
       <semantics id="alg1.l1.m5.1a">
        <msub id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml">
         <mi id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">
          M
         </mi>
         <mi id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml">
          c
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b">
         <apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1">
          <csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">
           𝑀
          </ci>
          <ci id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3">
           𝑐
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m5.1c">
         M_{c}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l2">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">
        2:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l2.2">
       input:
      </span>
      max trials
      <math alttext="I" class="ltx_Math" display="inline" id="alg1.l2.m1.1">
       <semantics id="alg1.l2.m1.1a">
        <mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">
         I
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b">
         <ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">
          𝐼
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m1.1c">
         I
        </annotation>
       </semantics>
      </math>
      , training epochs
      <math alttext="I_{e}" class="ltx_Math" display="inline" id="alg1.l2.m2.1">
       <semantics id="alg1.l2.m2.1a">
        <msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">
         <mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">
          I
         </mi>
         <mi id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">
          e
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b">
         <apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">
           𝐼
          </ci>
          <ci id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">
           𝑒
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m2.1c">
         I_{e}
        </annotation>
       </semantics>
      </math>
      , visual and textual envs
      <math alttext="E_{v}" class="ltx_Math" display="inline" id="alg1.l2.m3.1">
       <semantics id="alg1.l2.m3.1a">
        <msub id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml">
         <mi id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml">
          E
         </mi>
         <mi id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml">
          v
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b">
         <apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1">
          <csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2">
           𝐸
          </ci>
          <ci id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3">
           𝑣
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m3.1c">
         E_{v}
        </annotation>
       </semantics>
      </math>
      ,
      <math alttext="E_{l}" class="ltx_Math" display="inline" id="alg1.l2.m4.1">
       <semantics id="alg1.l2.m4.1a">
        <msub id="alg1.l2.m4.1.1" xref="alg1.l2.m4.1.1.cmml">
         <mi id="alg1.l2.m4.1.1.2" xref="alg1.l2.m4.1.1.2.cmml">
          E
         </mi>
         <mi id="alg1.l2.m4.1.1.3" xref="alg1.l2.m4.1.1.3.cmml">
          l
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m4.1b">
         <apply id="alg1.l2.m4.1.1.cmml" xref="alg1.l2.m4.1.1">
          <csymbol cd="ambiguous" id="alg1.l2.m4.1.1.1.cmml" xref="alg1.l2.m4.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l2.m4.1.1.2.cmml" xref="alg1.l2.m4.1.1.2">
           𝐸
          </ci>
          <ci id="alg1.l2.m4.1.1.3.cmml" xref="alg1.l2.m4.1.1.3">
           𝑙
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m4.1c">
         E_{l}
        </annotation>
       </semantics>
      </math>
      , instruction
      <math alttext="x_{\text{task}}" class="ltx_Math" display="inline" id="alg1.l2.m5.1">
       <semantics id="alg1.l2.m5.1a">
        <msub id="alg1.l2.m5.1.1" xref="alg1.l2.m5.1.1.cmml">
         <mi id="alg1.l2.m5.1.1.2" xref="alg1.l2.m5.1.1.2.cmml">
          x
         </mi>
         <mtext id="alg1.l2.m5.1.1.3" xref="alg1.l2.m5.1.1.3a.cmml">
          task
         </mtext>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m5.1b">
         <apply id="alg1.l2.m5.1.1.cmml" xref="alg1.l2.m5.1.1">
          <csymbol cd="ambiguous" id="alg1.l2.m5.1.1.1.cmml" xref="alg1.l2.m5.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l2.m5.1.1.2.cmml" xref="alg1.l2.m5.1.1.2">
           𝑥
          </ci>
          <ci id="alg1.l2.m5.1.1.3a.cmml" xref="alg1.l2.m5.1.1.3">
           <mtext id="alg1.l2.m5.1.1.3.cmml" mathsize="70%" xref="alg1.l2.m5.1.1.3">
            task
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m5.1c">
         x_{\text{task}}
        </annotation>
       </semantics>
      </math>
      , reference agent
      <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="alg1.l2.m6.1">
       <semantics id="alg1.l2.m6.1a">
        <msub id="alg1.l2.m6.1.1" xref="alg1.l2.m6.1.1.cmml">
         <mi id="alg1.l2.m6.1.1.2" xref="alg1.l2.m6.1.1.2.cmml">
          π
         </mi>
         <mtext id="alg1.l2.m6.1.1.3" xref="alg1.l2.m6.1.1.3a.cmml">
          ref
         </mtext>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m6.1b">
         <apply id="alg1.l2.m6.1.1.cmml" xref="alg1.l2.m6.1.1">
          <csymbol cd="ambiguous" id="alg1.l2.m6.1.1.1.cmml" xref="alg1.l2.m6.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l2.m6.1.1.2.cmml" xref="alg1.l2.m6.1.1.2">
           𝜋
          </ci>
          <ci id="alg1.l2.m6.1.1.3a.cmml" xref="alg1.l2.m6.1.1.3">
           <mtext id="alg1.l2.m6.1.1.3.cmml" mathsize="70%" xref="alg1.l2.m6.1.1.3">
            ref
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m6.1c">
         \pi_{\text{ref}}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l3">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l3.2.1.1" style="font-size:80%;">
        3:
       </span>
      </span>
      Initialize
      <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.l3.m1.1">
       <semantics id="alg1.l3.m1.1a">
        <msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">
         <mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">
          π
         </mi>
         <mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">
          θ
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b">
         <apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">
           𝜋
          </ci>
          <ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">
           𝜃
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l3.m1.1c">
         \pi_{\theta}
        </annotation>
       </semantics>
      </math>
      to
      <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="alg1.l3.m2.1">
       <semantics id="alg1.l3.m2.1a">
        <msub id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">
         <mi id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml">
          π
         </mi>
         <mtext id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3a.cmml">
          ref
         </mtext>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b">
         <apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2">
           𝜋
          </ci>
          <ci id="alg1.l3.m2.1.1.3a.cmml" xref="alg1.l3.m2.1.1.3">
           <mtext id="alg1.l3.m2.1.1.3.cmml" mathsize="70%" xref="alg1.l3.m2.1.1.3">
            ref
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l3.m2.1c">
         \pi_{\text{ref}}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text" id="alg1.l3.1" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l3.1.m1.1">
        <semantics id="alg1.l3.1.m1.1a">
         <mo id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">
          ▷
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b">
          <ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">
           ▷
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text" id="alg1.l3.1.1" style="color:#8B0000;">
        Behavior Cloning Initialization
       </span>
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l4">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">
        4:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l4.2">
       while
      </span>
      task not completed or
      <math alttext="i&lt;I" class="ltx_Math" display="inline" id="alg1.l4.m1.1">
       <semantics id="alg1.l4.m1.1a">
        <mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">
         <mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">
          i
         </mi>
         <mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">
          &lt;
         </mo>
         <mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">
          I
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b">
         <apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">
          <lt id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">
          </lt>
          <ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">
           𝑖
          </ci>
          <ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">
           𝐼
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l4.m1.1c">
         i&lt;I
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l4.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l5">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">
        5:
       </span>
      </span>
      Get
      <math alttext="\tau^{i}_{v}=[x_{\text{task}},s_{v}^{0},x_{a}^{0},\dots,s_{v}^{T},x_{a}^{T}]" class="ltx_Math" display="inline" id="alg1.l5.m1.6">
       <semantics id="alg1.l5.m1.6a">
        <mrow id="alg1.l5.m1.6.6" xref="alg1.l5.m1.6.6.cmml">
         <msubsup id="alg1.l5.m1.6.6.7" xref="alg1.l5.m1.6.6.7.cmml">
          <mi id="alg1.l5.m1.6.6.7.2.2" xref="alg1.l5.m1.6.6.7.2.2.cmml">
           τ
          </mi>
          <mi id="alg1.l5.m1.6.6.7.3" xref="alg1.l5.m1.6.6.7.3.cmml">
           v
          </mi>
          <mi id="alg1.l5.m1.6.6.7.2.3" xref="alg1.l5.m1.6.6.7.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="alg1.l5.m1.6.6.6" xref="alg1.l5.m1.6.6.6.cmml">
          =
         </mo>
         <mrow id="alg1.l5.m1.6.6.5.5" xref="alg1.l5.m1.6.6.5.6.cmml">
          <mo id="alg1.l5.m1.6.6.5.5.6" stretchy="false" xref="alg1.l5.m1.6.6.5.6.cmml">
           [
          </mo>
          <msub id="alg1.l5.m1.2.2.1.1.1" xref="alg1.l5.m1.2.2.1.1.1.cmml">
           <mi id="alg1.l5.m1.2.2.1.1.1.2" xref="alg1.l5.m1.2.2.1.1.1.2.cmml">
            x
           </mi>
           <mtext id="alg1.l5.m1.2.2.1.1.1.3" xref="alg1.l5.m1.2.2.1.1.1.3a.cmml">
            task
           </mtext>
          </msub>
          <mo id="alg1.l5.m1.6.6.5.5.7" xref="alg1.l5.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msubsup id="alg1.l5.m1.3.3.2.2.2" xref="alg1.l5.m1.3.3.2.2.2.cmml">
           <mi id="alg1.l5.m1.3.3.2.2.2.2.2" xref="alg1.l5.m1.3.3.2.2.2.2.2.cmml">
            s
           </mi>
           <mi id="alg1.l5.m1.3.3.2.2.2.2.3" xref="alg1.l5.m1.3.3.2.2.2.2.3.cmml">
            v
           </mi>
           <mn id="alg1.l5.m1.3.3.2.2.2.3" xref="alg1.l5.m1.3.3.2.2.2.3.cmml">
            0
           </mn>
          </msubsup>
          <mo id="alg1.l5.m1.6.6.5.5.8" xref="alg1.l5.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msubsup id="alg1.l5.m1.4.4.3.3.3" xref="alg1.l5.m1.4.4.3.3.3.cmml">
           <mi id="alg1.l5.m1.4.4.3.3.3.2.2" xref="alg1.l5.m1.4.4.3.3.3.2.2.cmml">
            x
           </mi>
           <mi id="alg1.l5.m1.4.4.3.3.3.2.3" xref="alg1.l5.m1.4.4.3.3.3.2.3.cmml">
            a
           </mi>
           <mn id="alg1.l5.m1.4.4.3.3.3.3" xref="alg1.l5.m1.4.4.3.3.3.3.cmml">
            0
           </mn>
          </msubsup>
          <mo id="alg1.l5.m1.6.6.5.5.9" xref="alg1.l5.m1.6.6.5.6.cmml">
           ,
          </mo>
          <mi id="alg1.l5.m1.1.1" mathvariant="normal" xref="alg1.l5.m1.1.1.cmml">
           …
          </mi>
          <mo id="alg1.l5.m1.6.6.5.5.10" xref="alg1.l5.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msubsup id="alg1.l5.m1.5.5.4.4.4" xref="alg1.l5.m1.5.5.4.4.4.cmml">
           <mi id="alg1.l5.m1.5.5.4.4.4.2.2" xref="alg1.l5.m1.5.5.4.4.4.2.2.cmml">
            s
           </mi>
           <mi id="alg1.l5.m1.5.5.4.4.4.2.3" xref="alg1.l5.m1.5.5.4.4.4.2.3.cmml">
            v
           </mi>
           <mi id="alg1.l5.m1.5.5.4.4.4.3" xref="alg1.l5.m1.5.5.4.4.4.3.cmml">
            T
           </mi>
          </msubsup>
          <mo id="alg1.l5.m1.6.6.5.5.11" xref="alg1.l5.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msubsup id="alg1.l5.m1.6.6.5.5.5" xref="alg1.l5.m1.6.6.5.5.5.cmml">
           <mi id="alg1.l5.m1.6.6.5.5.5.2.2" xref="alg1.l5.m1.6.6.5.5.5.2.2.cmml">
            x
           </mi>
           <mi id="alg1.l5.m1.6.6.5.5.5.2.3" xref="alg1.l5.m1.6.6.5.5.5.2.3.cmml">
            a
           </mi>
           <mi id="alg1.l5.m1.6.6.5.5.5.3" xref="alg1.l5.m1.6.6.5.5.5.3.cmml">
            T
           </mi>
          </msubsup>
          <mo id="alg1.l5.m1.6.6.5.5.12" stretchy="false" xref="alg1.l5.m1.6.6.5.6.cmml">
           ]
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l5.m1.6b">
         <apply id="alg1.l5.m1.6.6.cmml" xref="alg1.l5.m1.6.6">
          <eq id="alg1.l5.m1.6.6.6.cmml" xref="alg1.l5.m1.6.6.6">
          </eq>
          <apply id="alg1.l5.m1.6.6.7.cmml" xref="alg1.l5.m1.6.6.7">
           <csymbol cd="ambiguous" id="alg1.l5.m1.6.6.7.1.cmml" xref="alg1.l5.m1.6.6.7">
            subscript
           </csymbol>
           <apply id="alg1.l5.m1.6.6.7.2.cmml" xref="alg1.l5.m1.6.6.7">
            <csymbol cd="ambiguous" id="alg1.l5.m1.6.6.7.2.1.cmml" xref="alg1.l5.m1.6.6.7">
             superscript
            </csymbol>
            <ci id="alg1.l5.m1.6.6.7.2.2.cmml" xref="alg1.l5.m1.6.6.7.2.2">
             𝜏
            </ci>
            <ci id="alg1.l5.m1.6.6.7.2.3.cmml" xref="alg1.l5.m1.6.6.7.2.3">
             𝑖
            </ci>
           </apply>
           <ci id="alg1.l5.m1.6.6.7.3.cmml" xref="alg1.l5.m1.6.6.7.3">
            𝑣
           </ci>
          </apply>
          <list id="alg1.l5.m1.6.6.5.6.cmml" xref="alg1.l5.m1.6.6.5.5">
           <apply id="alg1.l5.m1.2.2.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1.1">
            <csymbol cd="ambiguous" id="alg1.l5.m1.2.2.1.1.1.1.cmml" xref="alg1.l5.m1.2.2.1.1.1">
             subscript
            </csymbol>
            <ci id="alg1.l5.m1.2.2.1.1.1.2.cmml" xref="alg1.l5.m1.2.2.1.1.1.2">
             𝑥
            </ci>
            <ci id="alg1.l5.m1.2.2.1.1.1.3a.cmml" xref="alg1.l5.m1.2.2.1.1.1.3">
             <mtext id="alg1.l5.m1.2.2.1.1.1.3.cmml" mathsize="70%" xref="alg1.l5.m1.2.2.1.1.1.3">
              task
             </mtext>
            </ci>
           </apply>
           <apply id="alg1.l5.m1.3.3.2.2.2.cmml" xref="alg1.l5.m1.3.3.2.2.2">
            <csymbol cd="ambiguous" id="alg1.l5.m1.3.3.2.2.2.1.cmml" xref="alg1.l5.m1.3.3.2.2.2">
             superscript
            </csymbol>
            <apply id="alg1.l5.m1.3.3.2.2.2.2.cmml" xref="alg1.l5.m1.3.3.2.2.2">
             <csymbol cd="ambiguous" id="alg1.l5.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l5.m1.3.3.2.2.2">
              subscript
             </csymbol>
             <ci id="alg1.l5.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l5.m1.3.3.2.2.2.2.2">
              𝑠
             </ci>
             <ci id="alg1.l5.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l5.m1.3.3.2.2.2.2.3">
              𝑣
             </ci>
            </apply>
            <cn id="alg1.l5.m1.3.3.2.2.2.3.cmml" type="integer" xref="alg1.l5.m1.3.3.2.2.2.3">
             0
            </cn>
           </apply>
           <apply id="alg1.l5.m1.4.4.3.3.3.cmml" xref="alg1.l5.m1.4.4.3.3.3">
            <csymbol cd="ambiguous" id="alg1.l5.m1.4.4.3.3.3.1.cmml" xref="alg1.l5.m1.4.4.3.3.3">
             superscript
            </csymbol>
            <apply id="alg1.l5.m1.4.4.3.3.3.2.cmml" xref="alg1.l5.m1.4.4.3.3.3">
             <csymbol cd="ambiguous" id="alg1.l5.m1.4.4.3.3.3.2.1.cmml" xref="alg1.l5.m1.4.4.3.3.3">
              subscript
             </csymbol>
             <ci id="alg1.l5.m1.4.4.3.3.3.2.2.cmml" xref="alg1.l5.m1.4.4.3.3.3.2.2">
              𝑥
             </ci>
             <ci id="alg1.l5.m1.4.4.3.3.3.2.3.cmml" xref="alg1.l5.m1.4.4.3.3.3.2.3">
              𝑎
             </ci>
            </apply>
            <cn id="alg1.l5.m1.4.4.3.3.3.3.cmml" type="integer" xref="alg1.l5.m1.4.4.3.3.3.3">
             0
            </cn>
           </apply>
           <ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">
            …
           </ci>
           <apply id="alg1.l5.m1.5.5.4.4.4.cmml" xref="alg1.l5.m1.5.5.4.4.4">
            <csymbol cd="ambiguous" id="alg1.l5.m1.5.5.4.4.4.1.cmml" xref="alg1.l5.m1.5.5.4.4.4">
             superscript
            </csymbol>
            <apply id="alg1.l5.m1.5.5.4.4.4.2.cmml" xref="alg1.l5.m1.5.5.4.4.4">
             <csymbol cd="ambiguous" id="alg1.l5.m1.5.5.4.4.4.2.1.cmml" xref="alg1.l5.m1.5.5.4.4.4">
              subscript
             </csymbol>
             <ci id="alg1.l5.m1.5.5.4.4.4.2.2.cmml" xref="alg1.l5.m1.5.5.4.4.4.2.2">
              𝑠
             </ci>
             <ci id="alg1.l5.m1.5.5.4.4.4.2.3.cmml" xref="alg1.l5.m1.5.5.4.4.4.2.3">
              𝑣
             </ci>
            </apply>
            <ci id="alg1.l5.m1.5.5.4.4.4.3.cmml" xref="alg1.l5.m1.5.5.4.4.4.3">
             𝑇
            </ci>
           </apply>
           <apply id="alg1.l5.m1.6.6.5.5.5.cmml" xref="alg1.l5.m1.6.6.5.5.5">
            <csymbol cd="ambiguous" id="alg1.l5.m1.6.6.5.5.5.1.cmml" xref="alg1.l5.m1.6.6.5.5.5">
             superscript
            </csymbol>
            <apply id="alg1.l5.m1.6.6.5.5.5.2.cmml" xref="alg1.l5.m1.6.6.5.5.5">
             <csymbol cd="ambiguous" id="alg1.l5.m1.6.6.5.5.5.2.1.cmml" xref="alg1.l5.m1.6.6.5.5.5">
              subscript
             </csymbol>
             <ci id="alg1.l5.m1.6.6.5.5.5.2.2.cmml" xref="alg1.l5.m1.6.6.5.5.5.2.2">
              𝑥
             </ci>
             <ci id="alg1.l5.m1.6.6.5.5.5.2.3.cmml" xref="alg1.l5.m1.6.6.5.5.5.2.3">
              𝑎
             </ci>
            </apply>
            <ci id="alg1.l5.m1.6.6.5.5.5.3.cmml" xref="alg1.l5.m1.6.6.5.5.5.3">
             𝑇
            </ci>
           </apply>
          </list>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l5.m1.6c">
         \tau^{i}_{v}=[x_{\text{task}},s_{v}^{0},x_{a}^{0},\dots,s_{v}^{T},x_{a}^{T}]
        </annotation>
       </semantics>
      </math>
      via
      <math alttext="E_{v}" class="ltx_Math" display="inline" id="alg1.l5.m2.1">
       <semantics id="alg1.l5.m2.1a">
        <msub id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">
         <mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">
          E
         </mi>
         <mi id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">
          v
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b">
         <apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">
           𝐸
          </ci>
          <ci id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3">
           𝑣
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l5.m2.1c">
         E_{v}
        </annotation>
       </semantics>
      </math>
      with
      <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="alg1.l5.m3.1">
       <semantics id="alg1.l5.m3.1a">
        <msub id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml">
         <mi id="alg1.l5.m3.1.1.2" xref="alg1.l5.m3.1.1.2.cmml">
          π
         </mi>
         <mi id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml">
          θ
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b">
         <apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1">
          <csymbol cd="ambiguous" id="alg1.l5.m3.1.1.1.cmml" xref="alg1.l5.m3.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1.2">
           𝜋
          </ci>
          <ci id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3">
           𝜃
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l5.m3.1c">
         \pi_{\theta}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l6">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">
        6:
       </span>
      </span>
      Get
      <math alttext="\tau^{i}_{l}=[x_{\text{task}},s_{l}^{0},x_{a}^{0},\dots,s_{l}^{T},x_{a}^{T}]" class="ltx_Math" display="inline" id="alg1.l6.m1.6">
       <semantics id="alg1.l6.m1.6a">
        <mrow id="alg1.l6.m1.6.6" xref="alg1.l6.m1.6.6.cmml">
         <msubsup id="alg1.l6.m1.6.6.7" xref="alg1.l6.m1.6.6.7.cmml">
          <mi id="alg1.l6.m1.6.6.7.2.2" xref="alg1.l6.m1.6.6.7.2.2.cmml">
           τ
          </mi>
          <mi id="alg1.l6.m1.6.6.7.3" xref="alg1.l6.m1.6.6.7.3.cmml">
           l
          </mi>
          <mi id="alg1.l6.m1.6.6.7.2.3" xref="alg1.l6.m1.6.6.7.2.3.cmml">
           i
          </mi>
         </msubsup>
         <mo id="alg1.l6.m1.6.6.6" xref="alg1.l6.m1.6.6.6.cmml">
          =
         </mo>
         <mrow id="alg1.l6.m1.6.6.5.5" xref="alg1.l6.m1.6.6.5.6.cmml">
          <mo id="alg1.l6.m1.6.6.5.5.6" stretchy="false" xref="alg1.l6.m1.6.6.5.6.cmml">
           [
          </mo>
          <msub id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.cmml">
           <mi id="alg1.l6.m1.2.2.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.2.cmml">
            x
           </mi>
           <mtext id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.3a.cmml">
            task
           </mtext>
          </msub>
          <mo id="alg1.l6.m1.6.6.5.5.7" xref="alg1.l6.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msubsup id="alg1.l6.m1.3.3.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.cmml">
           <mi id="alg1.l6.m1.3.3.2.2.2.2.2" xref="alg1.l6.m1.3.3.2.2.2.2.2.cmml">
            s
           </mi>
           <mi id="alg1.l6.m1.3.3.2.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.2.3.cmml">
            l
           </mi>
           <mn id="alg1.l6.m1.3.3.2.2.2.3" xref="alg1.l6.m1.3.3.2.2.2.3.cmml">
            0
           </mn>
          </msubsup>
          <mo id="alg1.l6.m1.6.6.5.5.8" xref="alg1.l6.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msubsup id="alg1.l6.m1.4.4.3.3.3" xref="alg1.l6.m1.4.4.3.3.3.cmml">
           <mi id="alg1.l6.m1.4.4.3.3.3.2.2" xref="alg1.l6.m1.4.4.3.3.3.2.2.cmml">
            x
           </mi>
           <mi id="alg1.l6.m1.4.4.3.3.3.2.3" xref="alg1.l6.m1.4.4.3.3.3.2.3.cmml">
            a
           </mi>
           <mn id="alg1.l6.m1.4.4.3.3.3.3" xref="alg1.l6.m1.4.4.3.3.3.3.cmml">
            0
           </mn>
          </msubsup>
          <mo id="alg1.l6.m1.6.6.5.5.9" xref="alg1.l6.m1.6.6.5.6.cmml">
           ,
          </mo>
          <mi id="alg1.l6.m1.1.1" mathvariant="normal" xref="alg1.l6.m1.1.1.cmml">
           …
          </mi>
          <mo id="alg1.l6.m1.6.6.5.5.10" xref="alg1.l6.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msubsup id="alg1.l6.m1.5.5.4.4.4" xref="alg1.l6.m1.5.5.4.4.4.cmml">
           <mi id="alg1.l6.m1.5.5.4.4.4.2.2" xref="alg1.l6.m1.5.5.4.4.4.2.2.cmml">
            s
           </mi>
           <mi id="alg1.l6.m1.5.5.4.4.4.2.3" xref="alg1.l6.m1.5.5.4.4.4.2.3.cmml">
            l
           </mi>
           <mi id="alg1.l6.m1.5.5.4.4.4.3" xref="alg1.l6.m1.5.5.4.4.4.3.cmml">
            T
           </mi>
          </msubsup>
          <mo id="alg1.l6.m1.6.6.5.5.11" xref="alg1.l6.m1.6.6.5.6.cmml">
           ,
          </mo>
          <msubsup id="alg1.l6.m1.6.6.5.5.5" xref="alg1.l6.m1.6.6.5.5.5.cmml">
           <mi id="alg1.l6.m1.6.6.5.5.5.2.2" xref="alg1.l6.m1.6.6.5.5.5.2.2.cmml">
            x
           </mi>
           <mi id="alg1.l6.m1.6.6.5.5.5.2.3" xref="alg1.l6.m1.6.6.5.5.5.2.3.cmml">
            a
           </mi>
           <mi id="alg1.l6.m1.6.6.5.5.5.3" xref="alg1.l6.m1.6.6.5.5.5.3.cmml">
            T
           </mi>
          </msubsup>
          <mo id="alg1.l6.m1.6.6.5.5.12" stretchy="false" xref="alg1.l6.m1.6.6.5.6.cmml">
           ]
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m1.6b">
         <apply id="alg1.l6.m1.6.6.cmml" xref="alg1.l6.m1.6.6">
          <eq id="alg1.l6.m1.6.6.6.cmml" xref="alg1.l6.m1.6.6.6">
          </eq>
          <apply id="alg1.l6.m1.6.6.7.cmml" xref="alg1.l6.m1.6.6.7">
           <csymbol cd="ambiguous" id="alg1.l6.m1.6.6.7.1.cmml" xref="alg1.l6.m1.6.6.7">
            subscript
           </csymbol>
           <apply id="alg1.l6.m1.6.6.7.2.cmml" xref="alg1.l6.m1.6.6.7">
            <csymbol cd="ambiguous" id="alg1.l6.m1.6.6.7.2.1.cmml" xref="alg1.l6.m1.6.6.7">
             superscript
            </csymbol>
            <ci id="alg1.l6.m1.6.6.7.2.2.cmml" xref="alg1.l6.m1.6.6.7.2.2">
             𝜏
            </ci>
            <ci id="alg1.l6.m1.6.6.7.2.3.cmml" xref="alg1.l6.m1.6.6.7.2.3">
             𝑖
            </ci>
           </apply>
           <ci id="alg1.l6.m1.6.6.7.3.cmml" xref="alg1.l6.m1.6.6.7.3">
            𝑙
           </ci>
          </apply>
          <list id="alg1.l6.m1.6.6.5.6.cmml" xref="alg1.l6.m1.6.6.5.5">
           <apply id="alg1.l6.m1.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1">
            <csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1">
             subscript
            </csymbol>
            <ci id="alg1.l6.m1.2.2.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.2">
             𝑥
            </ci>
            <ci id="alg1.l6.m1.2.2.1.1.1.3a.cmml" xref="alg1.l6.m1.2.2.1.1.1.3">
             <mtext id="alg1.l6.m1.2.2.1.1.1.3.cmml" mathsize="70%" xref="alg1.l6.m1.2.2.1.1.1.3">
              task
             </mtext>
            </ci>
           </apply>
           <apply id="alg1.l6.m1.3.3.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2">
            <csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2">
             superscript
            </csymbol>
            <apply id="alg1.l6.m1.3.3.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2">
             <csymbol cd="ambiguous" id="alg1.l6.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l6.m1.3.3.2.2.2">
              subscript
             </csymbol>
             <ci id="alg1.l6.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.2">
              𝑠
             </ci>
             <ci id="alg1.l6.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l6.m1.3.3.2.2.2.2.3">
              𝑙
             </ci>
            </apply>
            <cn id="alg1.l6.m1.3.3.2.2.2.3.cmml" type="integer" xref="alg1.l6.m1.3.3.2.2.2.3">
             0
            </cn>
           </apply>
           <apply id="alg1.l6.m1.4.4.3.3.3.cmml" xref="alg1.l6.m1.4.4.3.3.3">
            <csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.3.3.1.cmml" xref="alg1.l6.m1.4.4.3.3.3">
             superscript
            </csymbol>
            <apply id="alg1.l6.m1.4.4.3.3.3.2.cmml" xref="alg1.l6.m1.4.4.3.3.3">
             <csymbol cd="ambiguous" id="alg1.l6.m1.4.4.3.3.3.2.1.cmml" xref="alg1.l6.m1.4.4.3.3.3">
              subscript
             </csymbol>
             <ci id="alg1.l6.m1.4.4.3.3.3.2.2.cmml" xref="alg1.l6.m1.4.4.3.3.3.2.2">
              𝑥
             </ci>
             <ci id="alg1.l6.m1.4.4.3.3.3.2.3.cmml" xref="alg1.l6.m1.4.4.3.3.3.2.3">
              𝑎
             </ci>
            </apply>
            <cn id="alg1.l6.m1.4.4.3.3.3.3.cmml" type="integer" xref="alg1.l6.m1.4.4.3.3.3.3">
             0
            </cn>
           </apply>
           <ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">
            …
           </ci>
           <apply id="alg1.l6.m1.5.5.4.4.4.cmml" xref="alg1.l6.m1.5.5.4.4.4">
            <csymbol cd="ambiguous" id="alg1.l6.m1.5.5.4.4.4.1.cmml" xref="alg1.l6.m1.5.5.4.4.4">
             superscript
            </csymbol>
            <apply id="alg1.l6.m1.5.5.4.4.4.2.cmml" xref="alg1.l6.m1.5.5.4.4.4">
             <csymbol cd="ambiguous" id="alg1.l6.m1.5.5.4.4.4.2.1.cmml" xref="alg1.l6.m1.5.5.4.4.4">
              subscript
             </csymbol>
             <ci id="alg1.l6.m1.5.5.4.4.4.2.2.cmml" xref="alg1.l6.m1.5.5.4.4.4.2.2">
              𝑠
             </ci>
             <ci id="alg1.l6.m1.5.5.4.4.4.2.3.cmml" xref="alg1.l6.m1.5.5.4.4.4.2.3">
              𝑙
             </ci>
            </apply>
            <ci id="alg1.l6.m1.5.5.4.4.4.3.cmml" xref="alg1.l6.m1.5.5.4.4.4.3">
             𝑇
            </ci>
           </apply>
           <apply id="alg1.l6.m1.6.6.5.5.5.cmml" xref="alg1.l6.m1.6.6.5.5.5">
            <csymbol cd="ambiguous" id="alg1.l6.m1.6.6.5.5.5.1.cmml" xref="alg1.l6.m1.6.6.5.5.5">
             superscript
            </csymbol>
            <apply id="alg1.l6.m1.6.6.5.5.5.2.cmml" xref="alg1.l6.m1.6.6.5.5.5">
             <csymbol cd="ambiguous" id="alg1.l6.m1.6.6.5.5.5.2.1.cmml" xref="alg1.l6.m1.6.6.5.5.5">
              subscript
             </csymbol>
             <ci id="alg1.l6.m1.6.6.5.5.5.2.2.cmml" xref="alg1.l6.m1.6.6.5.5.5.2.2">
              𝑥
             </ci>
             <ci id="alg1.l6.m1.6.6.5.5.5.2.3.cmml" xref="alg1.l6.m1.6.6.5.5.5.2.3">
              𝑎
             </ci>
            </apply>
            <ci id="alg1.l6.m1.6.6.5.5.5.3.cmml" xref="alg1.l6.m1.6.6.5.5.5.3">
             𝑇
            </ci>
           </apply>
          </list>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m1.6c">
         \tau^{i}_{l}=[x_{\text{task}},s_{l}^{0},x_{a}^{0},\dots,s_{l}^{T},x_{a}^{T}]
        </annotation>
       </semantics>
      </math>
      via
      <math alttext="E_{l}" class="ltx_Math" display="inline" id="alg1.l6.m2.1">
       <semantics id="alg1.l6.m2.1a">
        <msub id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">
         <mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">
          E
         </mi>
         <mi id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">
          l
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b">
         <apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">
           𝐸
          </ci>
          <ci id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3">
           𝑙
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m2.1c">
         E_{l}
        </annotation>
       </semantics>
      </math>
      with
      <math alttext="\tau^{i}_{v}" class="ltx_Math" display="inline" id="alg1.l6.m3.1">
       <semantics id="alg1.l6.m3.1a">
        <msubsup id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml">
         <mi id="alg1.l6.m3.1.1.2.2" xref="alg1.l6.m3.1.1.2.2.cmml">
          τ
         </mi>
         <mi id="alg1.l6.m3.1.1.3" xref="alg1.l6.m3.1.1.3.cmml">
          v
         </mi>
         <mi id="alg1.l6.m3.1.1.2.3" xref="alg1.l6.m3.1.1.2.3.cmml">
          i
         </mi>
        </msubsup>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b">
         <apply id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1">
          <csymbol cd="ambiguous" id="alg1.l6.m3.1.1.1.cmml" xref="alg1.l6.m3.1.1">
           subscript
          </csymbol>
          <apply id="alg1.l6.m3.1.1.2.cmml" xref="alg1.l6.m3.1.1">
           <csymbol cd="ambiguous" id="alg1.l6.m3.1.1.2.1.cmml" xref="alg1.l6.m3.1.1">
            superscript
           </csymbol>
           <ci id="alg1.l6.m3.1.1.2.2.cmml" xref="alg1.l6.m3.1.1.2.2">
            𝜏
           </ci>
           <ci id="alg1.l6.m3.1.1.2.3.cmml" xref="alg1.l6.m3.1.1.2.3">
            𝑖
           </ci>
          </apply>
          <ci id="alg1.l6.m3.1.1.3.cmml" xref="alg1.l6.m3.1.1.3">
           𝑣
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m3.1c">
         \tau^{i}_{v}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l7">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">
        7:
       </span>
      </span>
      Generate retrospective feedback
      <math alttext="\mathcal{P}_{i}=M_{c}(\tau^{i}_{l})" class="ltx_Math" display="inline" id="alg1.l7.m1.1">
       <semantics id="alg1.l7.m1.1a">
        <mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">
         <msub id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">
          <mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">
           𝒫
          </mi>
          <mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">
           i
          </mi>
         </msub>
         <mo id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">
          =
         </mo>
         <mrow id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">
          <msub id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.1.1.1.3.cmml">
           <mi id="alg1.l7.m1.1.1.1.3.2" xref="alg1.l7.m1.1.1.1.3.2.cmml">
            M
           </mi>
           <mi id="alg1.l7.m1.1.1.1.3.3" xref="alg1.l7.m1.1.1.1.3.3.cmml">
            c
           </mi>
          </msub>
          <mo id="alg1.l7.m1.1.1.1.2" lspace="0em" rspace="0em" xref="alg1.l7.m1.1.1.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">
           <mo id="alg1.l7.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">
            (
           </mo>
           <msubsup id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">
            <mi id="alg1.l7.m1.1.1.1.1.1.1.2.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml">
             τ
            </mi>
            <mi id="alg1.l7.m1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">
             l
            </mi>
            <mi id="alg1.l7.m1.1.1.1.1.1.1.2.3" xref="alg1.l7.m1.1.1.1.1.1.1.2.3.cmml">
             i
            </mi>
           </msubsup>
           <mo id="alg1.l7.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b">
         <apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">
          <eq id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">
          </eq>
          <apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">
            subscript
           </csymbol>
           <ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">
            𝒫
           </ci>
           <ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">
            𝑖
           </ci>
          </apply>
          <apply id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">
           <times id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.2">
           </times>
           <apply id="alg1.l7.m1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.3">
            <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.1.3">
             subscript
            </csymbol>
            <ci id="alg1.l7.m1.1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.1.3.2">
             𝑀
            </ci>
            <ci id="alg1.l7.m1.1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.1.3.3">
             𝑐
            </ci>
           </apply>
           <apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">
             subscript
            </csymbol>
            <apply id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">
              superscript
             </csymbol>
             <ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2">
              𝜏
             </ci>
             <ci id="alg1.l7.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.3">
              𝑖
             </ci>
            </apply>
            <ci id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">
             𝑙
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l7.m1.1c">
         \mathcal{P}_{i}=M_{c}(\tau^{i}_{l})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l8">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">
        8:
       </span>
      </span>
      Update
      <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="alg1.l8.m1.1">
       <semantics id="alg1.l8.m1.1a">
        <mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">
         𝒫
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b">
         <ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">
          𝒫
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l8.m1.1c">
         \mathcal{P}
        </annotation>
       </semantics>
      </math>
      with
      <math alttext="\mathcal{P}_{i}" class="ltx_Math" display="inline" id="alg1.l8.m2.1">
       <semantics id="alg1.l8.m2.1a">
        <msub id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="alg1.l8.m2.1.1.2" xref="alg1.l8.m2.1.1.2.cmml">
          𝒫
         </mi>
         <mi id="alg1.l8.m2.1.1.3" xref="alg1.l8.m2.1.1.3.cmml">
          i
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b">
         <apply id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l8.m2.1.1.1.cmml" xref="alg1.l8.m2.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l8.m2.1.1.2.cmml" xref="alg1.l8.m2.1.1.2">
           𝒫
          </ci>
          <ci id="alg1.l8.m2.1.1.3.cmml" xref="alg1.l8.m2.1.1.3">
           𝑖
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l8.m2.1c">
         \mathcal{P}_{i}
        </annotation>
       </semantics>
      </math>
      (i.e.,
      <math alttext="\mathcal{P}\leftarrow\mathcal{P}\cup\mathcal{P}_{i}" class="ltx_Math" display="inline" id="alg1.l8.m3.1">
       <semantics id="alg1.l8.m3.1a">
        <mrow id="alg1.l8.m3.1.1" xref="alg1.l8.m3.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="alg1.l8.m3.1.1.2" xref="alg1.l8.m3.1.1.2.cmml">
          𝒫
         </mi>
         <mo id="alg1.l8.m3.1.1.1" stretchy="false" xref="alg1.l8.m3.1.1.1.cmml">
          ←
         </mo>
         <mrow id="alg1.l8.m3.1.1.3" xref="alg1.l8.m3.1.1.3.cmml">
          <mi class="ltx_font_mathcaligraphic" id="alg1.l8.m3.1.1.3.2" xref="alg1.l8.m3.1.1.3.2.cmml">
           𝒫
          </mi>
          <mo id="alg1.l8.m3.1.1.3.1" xref="alg1.l8.m3.1.1.3.1.cmml">
           ∪
          </mo>
          <msub id="alg1.l8.m3.1.1.3.3" xref="alg1.l8.m3.1.1.3.3.cmml">
           <mi class="ltx_font_mathcaligraphic" id="alg1.l8.m3.1.1.3.3.2" xref="alg1.l8.m3.1.1.3.3.2.cmml">
            𝒫
           </mi>
           <mi id="alg1.l8.m3.1.1.3.3.3" xref="alg1.l8.m3.1.1.3.3.3.cmml">
            i
           </mi>
          </msub>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l8.m3.1b">
         <apply id="alg1.l8.m3.1.1.cmml" xref="alg1.l8.m3.1.1">
          <ci id="alg1.l8.m3.1.1.1.cmml" xref="alg1.l8.m3.1.1.1">
           ←
          </ci>
          <ci id="alg1.l8.m3.1.1.2.cmml" xref="alg1.l8.m3.1.1.2">
           𝒫
          </ci>
          <apply id="alg1.l8.m3.1.1.3.cmml" xref="alg1.l8.m3.1.1.3">
           <union id="alg1.l8.m3.1.1.3.1.cmml" xref="alg1.l8.m3.1.1.3.1">
           </union>
           <ci id="alg1.l8.m3.1.1.3.2.cmml" xref="alg1.l8.m3.1.1.3.2">
            𝒫
           </ci>
           <apply id="alg1.l8.m3.1.1.3.3.cmml" xref="alg1.l8.m3.1.1.3.3">
            <csymbol cd="ambiguous" id="alg1.l8.m3.1.1.3.3.1.cmml" xref="alg1.l8.m3.1.1.3.3">
             subscript
            </csymbol>
            <ci id="alg1.l8.m3.1.1.3.3.2.cmml" xref="alg1.l8.m3.1.1.3.3.2">
             𝒫
            </ci>
            <ci id="alg1.l8.m3.1.1.3.3.3.cmml" xref="alg1.l8.m3.1.1.3.3.3">
             𝑖
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l8.m3.1c">
         \mathcal{P}\leftarrow\mathcal{P}\cup\mathcal{P}_{i}
        </annotation>
       </semantics>
      </math>
      )
     </div>
     <div class="ltx_listingline" id="alg1.l9">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l9.2.1.1" style="font-size:80%;">
        9:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l9.3">
       for
      </span>
      <math alttext="t=0" class="ltx_Math" display="inline" id="alg1.l9.m1.1">
       <semantics id="alg1.l9.m1.1a">
        <mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">
         <mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">
          t
         </mi>
         <mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">
          =
         </mo>
         <mn id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">
          0
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b">
         <apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">
          <eq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">
          </eq>
          <ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">
           𝑡
          </ci>
          <cn id="alg1.l9.m1.1.1.3.cmml" type="integer" xref="alg1.l9.m1.1.1.3">
           0
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l9.m1.1c">
         t=0
        </annotation>
       </semantics>
      </math>
      to
      <math alttext="T" class="ltx_Math" display="inline" id="alg1.l9.m2.1">
       <semantics id="alg1.l9.m2.1a">
        <mi id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml">
         T
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b">
         <ci id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">
          𝑇
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l9.m2.1c">
         T
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l9.4">
       do
      </span>
      <span class="ltx_text" id="alg1.l9.1" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l9.1.m1.1">
        <semantics id="alg1.l9.1.m1.1a">
         <mo id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml">
          ▷
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b">
          <ci id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1">
           ▷
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text" id="alg1.l9.1.1" style="color:#8B0000;">
        Dataset Aggregation
       </span>
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l10">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">
        10:
       </span>
      </span>
      <math alttext="x^{*}_{a}=M_{a}(\mathcal{P},x_{\text{task}},\dots,x_{a}^{t-1},s_{l}^{t})" class="ltx_Math" display="inline" id="alg1.l10.m1.5">
       <semantics id="alg1.l10.m1.5a">
        <mrow id="alg1.l10.m1.5.5" xref="alg1.l10.m1.5.5.cmml">
         <msubsup id="alg1.l10.m1.5.5.5" xref="alg1.l10.m1.5.5.5.cmml">
          <mi id="alg1.l10.m1.5.5.5.2.2" xref="alg1.l10.m1.5.5.5.2.2.cmml">
           x
          </mi>
          <mi id="alg1.l10.m1.5.5.5.3" xref="alg1.l10.m1.5.5.5.3.cmml">
           a
          </mi>
          <mo id="alg1.l10.m1.5.5.5.2.3" xref="alg1.l10.m1.5.5.5.2.3.cmml">
           ∗
          </mo>
         </msubsup>
         <mo id="alg1.l10.m1.5.5.4" xref="alg1.l10.m1.5.5.4.cmml">
          =
         </mo>
         <mrow id="alg1.l10.m1.5.5.3" xref="alg1.l10.m1.5.5.3.cmml">
          <msub id="alg1.l10.m1.5.5.3.5" xref="alg1.l10.m1.5.5.3.5.cmml">
           <mi id="alg1.l10.m1.5.5.3.5.2" xref="alg1.l10.m1.5.5.3.5.2.cmml">
            M
           </mi>
           <mi id="alg1.l10.m1.5.5.3.5.3" xref="alg1.l10.m1.5.5.3.5.3.cmml">
            a
           </mi>
          </msub>
          <mo id="alg1.l10.m1.5.5.3.4" lspace="0em" rspace="0em" xref="alg1.l10.m1.5.5.3.4.cmml">
           ​
          </mo>
          <mrow id="alg1.l10.m1.5.5.3.3.3" xref="alg1.l10.m1.5.5.3.3.4.cmml">
           <mo id="alg1.l10.m1.5.5.3.3.3.4" stretchy="false" xref="alg1.l10.m1.5.5.3.3.4.cmml">
            (
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">
            𝒫
           </mi>
           <mo id="alg1.l10.m1.5.5.3.3.3.5" xref="alg1.l10.m1.5.5.3.3.4.cmml">
            ,
           </mo>
           <msub id="alg1.l10.m1.3.3.1.1.1.1" xref="alg1.l10.m1.3.3.1.1.1.1.cmml">
            <mi id="alg1.l10.m1.3.3.1.1.1.1.2" xref="alg1.l10.m1.3.3.1.1.1.1.2.cmml">
             x
            </mi>
            <mtext id="alg1.l10.m1.3.3.1.1.1.1.3" xref="alg1.l10.m1.3.3.1.1.1.1.3a.cmml">
             task
            </mtext>
           </msub>
           <mo id="alg1.l10.m1.5.5.3.3.3.6" xref="alg1.l10.m1.5.5.3.3.4.cmml">
            ,
           </mo>
           <mi id="alg1.l10.m1.2.2" mathvariant="normal" xref="alg1.l10.m1.2.2.cmml">
            …
           </mi>
           <mo id="alg1.l10.m1.5.5.3.3.3.7" xref="alg1.l10.m1.5.5.3.3.4.cmml">
            ,
           </mo>
           <msubsup id="alg1.l10.m1.4.4.2.2.2.2" xref="alg1.l10.m1.4.4.2.2.2.2.cmml">
            <mi id="alg1.l10.m1.4.4.2.2.2.2.2.2" xref="alg1.l10.m1.4.4.2.2.2.2.2.2.cmml">
             x
            </mi>
            <mi id="alg1.l10.m1.4.4.2.2.2.2.2.3" xref="alg1.l10.m1.4.4.2.2.2.2.2.3.cmml">
             a
            </mi>
            <mrow id="alg1.l10.m1.4.4.2.2.2.2.3" xref="alg1.l10.m1.4.4.2.2.2.2.3.cmml">
             <mi id="alg1.l10.m1.4.4.2.2.2.2.3.2" xref="alg1.l10.m1.4.4.2.2.2.2.3.2.cmml">
              t
             </mi>
             <mo id="alg1.l10.m1.4.4.2.2.2.2.3.1" xref="alg1.l10.m1.4.4.2.2.2.2.3.1.cmml">
              −
             </mo>
             <mn id="alg1.l10.m1.4.4.2.2.2.2.3.3" xref="alg1.l10.m1.4.4.2.2.2.2.3.3.cmml">
              1
             </mn>
            </mrow>
           </msubsup>
           <mo id="alg1.l10.m1.5.5.3.3.3.8" xref="alg1.l10.m1.5.5.3.3.4.cmml">
            ,
           </mo>
           <msubsup id="alg1.l10.m1.5.5.3.3.3.3" xref="alg1.l10.m1.5.5.3.3.3.3.cmml">
            <mi id="alg1.l10.m1.5.5.3.3.3.3.2.2" xref="alg1.l10.m1.5.5.3.3.3.3.2.2.cmml">
             s
            </mi>
            <mi id="alg1.l10.m1.5.5.3.3.3.3.2.3" xref="alg1.l10.m1.5.5.3.3.3.3.2.3.cmml">
             l
            </mi>
            <mi id="alg1.l10.m1.5.5.3.3.3.3.3" xref="alg1.l10.m1.5.5.3.3.3.3.3.cmml">
             t
            </mi>
           </msubsup>
           <mo id="alg1.l10.m1.5.5.3.3.3.9" stretchy="false" xref="alg1.l10.m1.5.5.3.3.4.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l10.m1.5b">
         <apply id="alg1.l10.m1.5.5.cmml" xref="alg1.l10.m1.5.5">
          <eq id="alg1.l10.m1.5.5.4.cmml" xref="alg1.l10.m1.5.5.4">
          </eq>
          <apply id="alg1.l10.m1.5.5.5.cmml" xref="alg1.l10.m1.5.5.5">
           <csymbol cd="ambiguous" id="alg1.l10.m1.5.5.5.1.cmml" xref="alg1.l10.m1.5.5.5">
            subscript
           </csymbol>
           <apply id="alg1.l10.m1.5.5.5.2.cmml" xref="alg1.l10.m1.5.5.5">
            <csymbol cd="ambiguous" id="alg1.l10.m1.5.5.5.2.1.cmml" xref="alg1.l10.m1.5.5.5">
             superscript
            </csymbol>
            <ci id="alg1.l10.m1.5.5.5.2.2.cmml" xref="alg1.l10.m1.5.5.5.2.2">
             𝑥
            </ci>
            <times id="alg1.l10.m1.5.5.5.2.3.cmml" xref="alg1.l10.m1.5.5.5.2.3">
            </times>
           </apply>
           <ci id="alg1.l10.m1.5.5.5.3.cmml" xref="alg1.l10.m1.5.5.5.3">
            𝑎
           </ci>
          </apply>
          <apply id="alg1.l10.m1.5.5.3.cmml" xref="alg1.l10.m1.5.5.3">
           <times id="alg1.l10.m1.5.5.3.4.cmml" xref="alg1.l10.m1.5.5.3.4">
           </times>
           <apply id="alg1.l10.m1.5.5.3.5.cmml" xref="alg1.l10.m1.5.5.3.5">
            <csymbol cd="ambiguous" id="alg1.l10.m1.5.5.3.5.1.cmml" xref="alg1.l10.m1.5.5.3.5">
             subscript
            </csymbol>
            <ci id="alg1.l10.m1.5.5.3.5.2.cmml" xref="alg1.l10.m1.5.5.3.5.2">
             𝑀
            </ci>
            <ci id="alg1.l10.m1.5.5.3.5.3.cmml" xref="alg1.l10.m1.5.5.3.5.3">
             𝑎
            </ci>
           </apply>
           <vector id="alg1.l10.m1.5.5.3.3.4.cmml" xref="alg1.l10.m1.5.5.3.3.3">
            <ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">
             𝒫
            </ci>
            <apply id="alg1.l10.m1.3.3.1.1.1.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l10.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l10.m1.3.3.1.1.1.1">
              subscript
             </csymbol>
             <ci id="alg1.l10.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.2">
              𝑥
             </ci>
             <ci id="alg1.l10.m1.3.3.1.1.1.1.3a.cmml" xref="alg1.l10.m1.3.3.1.1.1.1.3">
              <mtext id="alg1.l10.m1.3.3.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l10.m1.3.3.1.1.1.1.3">
               task
              </mtext>
             </ci>
            </apply>
            <ci id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2">
             …
            </ci>
            <apply id="alg1.l10.m1.4.4.2.2.2.2.cmml" xref="alg1.l10.m1.4.4.2.2.2.2">
             <csymbol cd="ambiguous" id="alg1.l10.m1.4.4.2.2.2.2.1.cmml" xref="alg1.l10.m1.4.4.2.2.2.2">
              superscript
             </csymbol>
             <apply id="alg1.l10.m1.4.4.2.2.2.2.2.cmml" xref="alg1.l10.m1.4.4.2.2.2.2">
              <csymbol cd="ambiguous" id="alg1.l10.m1.4.4.2.2.2.2.2.1.cmml" xref="alg1.l10.m1.4.4.2.2.2.2">
               subscript
              </csymbol>
              <ci id="alg1.l10.m1.4.4.2.2.2.2.2.2.cmml" xref="alg1.l10.m1.4.4.2.2.2.2.2.2">
               𝑥
              </ci>
              <ci id="alg1.l10.m1.4.4.2.2.2.2.2.3.cmml" xref="alg1.l10.m1.4.4.2.2.2.2.2.3">
               𝑎
              </ci>
             </apply>
             <apply id="alg1.l10.m1.4.4.2.2.2.2.3.cmml" xref="alg1.l10.m1.4.4.2.2.2.2.3">
              <minus id="alg1.l10.m1.4.4.2.2.2.2.3.1.cmml" xref="alg1.l10.m1.4.4.2.2.2.2.3.1">
              </minus>
              <ci id="alg1.l10.m1.4.4.2.2.2.2.3.2.cmml" xref="alg1.l10.m1.4.4.2.2.2.2.3.2">
               𝑡
              </ci>
              <cn id="alg1.l10.m1.4.4.2.2.2.2.3.3.cmml" type="integer" xref="alg1.l10.m1.4.4.2.2.2.2.3.3">
               1
              </cn>
             </apply>
            </apply>
            <apply id="alg1.l10.m1.5.5.3.3.3.3.cmml" xref="alg1.l10.m1.5.5.3.3.3.3">
             <csymbol cd="ambiguous" id="alg1.l10.m1.5.5.3.3.3.3.1.cmml" xref="alg1.l10.m1.5.5.3.3.3.3">
              superscript
             </csymbol>
             <apply id="alg1.l10.m1.5.5.3.3.3.3.2.cmml" xref="alg1.l10.m1.5.5.3.3.3.3">
              <csymbol cd="ambiguous" id="alg1.l10.m1.5.5.3.3.3.3.2.1.cmml" xref="alg1.l10.m1.5.5.3.3.3.3">
               subscript
              </csymbol>
              <ci id="alg1.l10.m1.5.5.3.3.3.3.2.2.cmml" xref="alg1.l10.m1.5.5.3.3.3.3.2.2">
               𝑠
              </ci>
              <ci id="alg1.l10.m1.5.5.3.3.3.3.2.3.cmml" xref="alg1.l10.m1.5.5.3.3.3.3.2.3">
               𝑙
              </ci>
             </apply>
             <ci id="alg1.l10.m1.5.5.3.3.3.3.3.cmml" xref="alg1.l10.m1.5.5.3.3.3.3.3">
              𝑡
             </ci>
            </apply>
           </vector>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l10.m1.5c">
         x^{*}_{a}=M_{a}(\mathcal{P},x_{\text{task}},\dots,x_{a}^{t-1},s_{l}^{t})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l11">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">
        11:
       </span>
      </span>
      <math alttext="\mathcal{D}\leftarrow\mathcal{D}\cup\{(x_{\text{task}},s_{v}^{t},x_{a}^{t},x^{*}_{a})\}" class="ltx_Math" display="inline" id="alg1.l11.m1.1">
       <semantics id="alg1.l11.m1.1a">
        <mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">
          𝒟
         </mi>
         <mo id="alg1.l11.m1.1.1.2" stretchy="false" xref="alg1.l11.m1.1.1.2.cmml">
          ←
         </mo>
         <mrow id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">
          <mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.1.3" xref="alg1.l11.m1.1.1.1.3.cmml">
           𝒟
          </mi>
          <mo id="alg1.l11.m1.1.1.1.2" xref="alg1.l11.m1.1.1.1.2.cmml">
           ∪
          </mo>
          <mrow id="alg1.l11.m1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.2.cmml">
           <mo id="alg1.l11.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l11.m1.1.1.1.1.2.cmml">
            {
           </mo>
           <mrow id="alg1.l11.m1.1.1.1.1.1.1.4" xref="alg1.l11.m1.1.1.1.1.1.1.5.cmml">
            <mo id="alg1.l11.m1.1.1.1.1.1.1.4.5" stretchy="false" xref="alg1.l11.m1.1.1.1.1.1.1.5.cmml">
             (
            </mo>
            <msub id="alg1.l11.m1.1.1.1.1.1.1.1.1" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml">
             <mi id="alg1.l11.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.2.cmml">
              x
             </mi>
             <mtext id="alg1.l11.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.3a.cmml">
              task
             </mtext>
            </msub>
            <mo id="alg1.l11.m1.1.1.1.1.1.1.4.6" xref="alg1.l11.m1.1.1.1.1.1.1.5.cmml">
             ,
            </mo>
            <msubsup id="alg1.l11.m1.1.1.1.1.1.1.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.cmml">
             <mi id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2.2.cmml">
              s
             </mi>
             <mi id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2.3.cmml">
              v
             </mi>
             <mi id="alg1.l11.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.3.cmml">
              t
             </mi>
            </msubsup>
            <mo id="alg1.l11.m1.1.1.1.1.1.1.4.7" xref="alg1.l11.m1.1.1.1.1.1.1.5.cmml">
             ,
            </mo>
            <msubsup id="alg1.l11.m1.1.1.1.1.1.1.3.3" xref="alg1.l11.m1.1.1.1.1.1.1.3.3.cmml">
             <mi id="alg1.l11.m1.1.1.1.1.1.1.3.3.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.3.3.2.2.cmml">
              x
             </mi>
             <mi id="alg1.l11.m1.1.1.1.1.1.1.3.3.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.3.3.2.3.cmml">
              a
             </mi>
             <mi id="alg1.l11.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l11.m1.1.1.1.1.1.1.3.3.3.cmml">
              t
             </mi>
            </msubsup>
            <mo id="alg1.l11.m1.1.1.1.1.1.1.4.8" xref="alg1.l11.m1.1.1.1.1.1.1.5.cmml">
             ,
            </mo>
            <msubsup id="alg1.l11.m1.1.1.1.1.1.1.4.4" xref="alg1.l11.m1.1.1.1.1.1.1.4.4.cmml">
             <mi id="alg1.l11.m1.1.1.1.1.1.1.4.4.2.2" xref="alg1.l11.m1.1.1.1.1.1.1.4.4.2.2.cmml">
              x
             </mi>
             <mi id="alg1.l11.m1.1.1.1.1.1.1.4.4.3" xref="alg1.l11.m1.1.1.1.1.1.1.4.4.3.cmml">
              a
             </mi>
             <mo id="alg1.l11.m1.1.1.1.1.1.1.4.4.2.3" xref="alg1.l11.m1.1.1.1.1.1.1.4.4.2.3.cmml">
              ∗
             </mo>
            </msubsup>
            <mo id="alg1.l11.m1.1.1.1.1.1.1.4.9" stretchy="false" xref="alg1.l11.m1.1.1.1.1.1.1.5.cmml">
             )
            </mo>
           </mrow>
           <mo id="alg1.l11.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l11.m1.1.1.1.1.2.cmml">
            }
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b">
         <apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">
          <ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">
           ←
          </ci>
          <ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">
           𝒟
          </ci>
          <apply id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1">
           <union id="alg1.l11.m1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.2">
           </union>
           <ci id="alg1.l11.m1.1.1.1.3.cmml" xref="alg1.l11.m1.1.1.1.3">
            𝒟
           </ci>
           <set id="alg1.l11.m1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1">
            <vector id="alg1.l11.m1.1.1.1.1.1.1.5.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.4">
             <apply id="alg1.l11.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="alg1.l11.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.2">
               𝑥
              </ci>
              <ci id="alg1.l11.m1.1.1.1.1.1.1.1.1.3a.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.3">
               <mtext id="alg1.l11.m1.1.1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="alg1.l11.m1.1.1.1.1.1.1.1.1.3">
                task
               </mtext>
              </ci>
             </apply>
             <apply id="alg1.l11.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2">
              <csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2">
               superscript
              </csymbol>
              <apply id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2">
               <csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2">
                subscript
               </csymbol>
               <ci id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2.2">
                𝑠
               </ci>
               <ci id="alg1.l11.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.2.3">
                𝑣
               </ci>
              </apply>
              <ci id="alg1.l11.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.2.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="alg1.l11.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3.3">
              <csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3.3">
               superscript
              </csymbol>
              <apply id="alg1.l11.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3.3">
               <csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.3.3.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3.3">
                subscript
               </csymbol>
               <ci id="alg1.l11.m1.1.1.1.1.1.1.3.3.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3.3.2.2">
                𝑥
               </ci>
               <ci id="alg1.l11.m1.1.1.1.1.1.1.3.3.2.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3.3.2.3">
                𝑎
               </ci>
              </apply>
              <ci id="alg1.l11.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.3.3.3">
               𝑡
              </ci>
             </apply>
             <apply id="alg1.l11.m1.1.1.1.1.1.1.4.4.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.4.4">
              <csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.4.4.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.4.4">
               subscript
              </csymbol>
              <apply id="alg1.l11.m1.1.1.1.1.1.1.4.4.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.4.4">
               <csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.1.1.1.4.4.2.1.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.4.4">
                superscript
               </csymbol>
               <ci id="alg1.l11.m1.1.1.1.1.1.1.4.4.2.2.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.4.4.2.2">
                𝑥
               </ci>
               <times id="alg1.l11.m1.1.1.1.1.1.1.4.4.2.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.4.4.2.3">
               </times>
              </apply>
              <ci id="alg1.l11.m1.1.1.1.1.1.1.4.4.3.cmml" xref="alg1.l11.m1.1.1.1.1.1.1.4.4.3">
               𝑎
              </ci>
             </apply>
            </vector>
           </set>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l11.m1.1c">
         \mathcal{D}\leftarrow\mathcal{D}\cup\{(x_{\text{task}},s_{v}^{t},x_{a}^{t},x^{*}_{a})\}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l12">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l12.3.1.1" style="font-size:80%;">
        12:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l12.4">
       for
      </span>
      <math alttext="j=0" class="ltx_Math" display="inline" id="alg1.l12.m1.1">
       <semantics id="alg1.l12.m1.1a">
        <mrow id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">
         <mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">
          j
         </mi>
         <mo id="alg1.l12.m1.1.1.1" xref="alg1.l12.m1.1.1.1.cmml">
          =
         </mo>
         <mn id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">
          0
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b">
         <apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">
          <eq id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1">
          </eq>
          <ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">
           𝑗
          </ci>
          <cn id="alg1.l12.m1.1.1.3.cmml" type="integer" xref="alg1.l12.m1.1.1.3">
           0
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l12.m1.1c">
         j=0
        </annotation>
       </semantics>
      </math>
      to
      <math alttext="I_{e}-1" class="ltx_Math" display="inline" id="alg1.l12.m2.1">
       <semantics id="alg1.l12.m2.1a">
        <mrow id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml">
         <msub id="alg1.l12.m2.1.1.2" xref="alg1.l12.m2.1.1.2.cmml">
          <mi id="alg1.l12.m2.1.1.2.2" xref="alg1.l12.m2.1.1.2.2.cmml">
           I
          </mi>
          <mi id="alg1.l12.m2.1.1.2.3" xref="alg1.l12.m2.1.1.2.3.cmml">
           e
          </mi>
         </msub>
         <mo id="alg1.l12.m2.1.1.1" xref="alg1.l12.m2.1.1.1.cmml">
          −
         </mo>
         <mn id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml">
          1
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b">
         <apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">
          <minus id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1.1">
          </minus>
          <apply id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1.2">
           <csymbol cd="ambiguous" id="alg1.l12.m2.1.1.2.1.cmml" xref="alg1.l12.m2.1.1.2">
            subscript
           </csymbol>
           <ci id="alg1.l12.m2.1.1.2.2.cmml" xref="alg1.l12.m2.1.1.2.2">
            𝐼
           </ci>
           <ci id="alg1.l12.m2.1.1.2.3.cmml" xref="alg1.l12.m2.1.1.2.3">
            𝑒
           </ci>
          </apply>
          <cn id="alg1.l12.m2.1.1.3.cmml" type="integer" xref="alg1.l12.m2.1.1.3">
           1
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l12.m2.1c">
         I_{e}-1
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l12.5">
       do
      </span>
      <span class="ltx_text" id="alg1.l12.2" style="float:right;">
       <math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l12.1.m1.1">
        <semantics id="alg1.l12.1.m1.1a">
         <mo id="alg1.l12.1.m1.1.1" xref="alg1.l12.1.m1.1.1.cmml">
          ▷
         </mo>
         <annotation-xml encoding="MathML-Content" id="alg1.l12.1.m1.1b">
          <ci id="alg1.l12.1.m1.1.1.cmml" xref="alg1.l12.1.m1.1.1">
           ▷
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l12.1.m1.1c">
          \triangleright
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text" id="alg1.l12.2.1" style="color:#8B0000;">
        Gradient Descent on
        <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l12.2.1.m1.1">
         <semantics id="alg1.l12.2.1.m1.1a">
          <mi id="alg1.l12.2.1.m1.1.1" mathcolor="#8B0000" xref="alg1.l12.2.1.m1.1.1.cmml">
           θ
          </mi>
          <annotation-xml encoding="MathML-Content" id="alg1.l12.2.1.m1.1b">
           <ci id="alg1.l12.2.1.m1.1.1.cmml" xref="alg1.l12.2.1.m1.1.1">
            𝜃
           </ci>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="alg1.l12.2.1.m1.1c">
           \theta
          </annotation>
         </semantics>
        </math>
       </span>
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l13">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">
        13:
       </span>
      </span>
      Sample a mini-batch
      <math alttext="\tau" class="ltx_Math" display="inline" id="alg1.l13.m1.1">
       <semantics id="alg1.l13.m1.1a">
        <mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">
         τ
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b">
         <ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">
          𝜏
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l13.m1.1c">
         \tau
        </annotation>
       </semantics>
      </math>
      from
      <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l13.m2.1">
       <semantics id="alg1.l13.m2.1a">
        <mi class="ltx_font_mathcaligraphic" id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml">
         𝒟
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b">
         <ci id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1">
          𝒟
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l13.m2.1c">
         \mathcal{D}
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l14">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">
        14:
       </span>
      </span>
      Update
      <math alttext="\theta" class="ltx_Math" display="inline" id="alg1.l14.m1.1">
       <semantics id="alg1.l14.m1.1a">
        <mi id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">
         θ
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b">
         <ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">
          𝜃
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l14.m1.1c">
         \theta
        </annotation>
       </semantics>
      </math>
      by minimizing Eq. (
      <a class="ltx_ref" href="#S2.E2" title="Equation 2 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
       <span class="ltx_text ltx_ref_tag">
        2
       </span>
      </a>
      ) with
      <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="alg1.l14.m2.1">
       <semantics id="alg1.l14.m2.1a">
        <msub id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml">
         <mi id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2.cmml">
          π
         </mi>
         <mtext id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3a.cmml">
          ref
         </mtext>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b">
         <apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l14.m2.1.1.1.cmml" xref="alg1.l14.m2.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2">
           𝜋
          </ci>
          <ci id="alg1.l14.m2.1.1.3a.cmml" xref="alg1.l14.m2.1.1.3">
           <mtext id="alg1.l14.m2.1.1.3.cmml" mathsize="70%" xref="alg1.l14.m2.1.1.3">
            ref
           </mtext>
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l14.m2.1c">
         \pi_{\text{ref}}
        </annotation>
       </semantics>
      </math>
      and
      <math alttext="\tau" class="ltx_Math" display="inline" id="alg1.l14.m3.1">
       <semantics id="alg1.l14.m3.1a">
        <mi id="alg1.l14.m3.1.1" xref="alg1.l14.m3.1.1.cmml">
         τ
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l14.m3.1b">
         <ci id="alg1.l14.m3.1.1.cmml" xref="alg1.l14.m3.1.1">
          𝜏
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l14.m3.1c">
         \tau
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l15">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">
        15:
       </span>
      </span>
      <math alttext="i\leftarrow i+1" class="ltx_Math" display="inline" id="alg1.l15.m1.1">
       <semantics id="alg1.l15.m1.1a">
        <mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">
         <mi id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">
          i
         </mi>
         <mo id="alg1.l15.m1.1.1.1" stretchy="false" xref="alg1.l15.m1.1.1.1.cmml">
          ←
         </mo>
         <mrow id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">
          <mi id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml">
           i
          </mi>
          <mo id="alg1.l15.m1.1.1.3.1" xref="alg1.l15.m1.1.1.3.1.cmml">
           +
          </mo>
          <mn id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml">
           1
          </mn>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b">
         <apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">
          <ci id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1">
           ←
          </ci>
          <ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">
           𝑖
          </ci>
          <apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">
           <plus id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3.1">
           </plus>
           <ci id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2">
            𝑖
           </ci>
           <cn id="alg1.l15.m1.1.1.3.3.cmml" type="integer" xref="alg1.l15.m1.1.1.3.3">
            1
           </cn>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l15.m1.1c">
         i\leftarrow i+1
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l16">
      <span class="ltx_tag ltx_tag_listingline">
       <span class="ltx_text" id="alg1.l16.2.1.1" style="font-size:80%;">
        16:
       </span>
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l16.1">
       output:
       <math alttext="\pi_{\theta^{*}}" class="ltx_Math" display="inline" id="alg1.l16.1.m1.1">
        <semantics id="alg1.l16.1.m1.1a">
         <msub id="alg1.l16.1.m1.1.1" xref="alg1.l16.1.m1.1.1.cmml">
          <mi id="alg1.l16.1.m1.1.1.2" xref="alg1.l16.1.m1.1.1.2.cmml">
           π
          </mi>
          <msup id="alg1.l16.1.m1.1.1.3" xref="alg1.l16.1.m1.1.1.3.cmml">
           <mi id="alg1.l16.1.m1.1.1.3.2" xref="alg1.l16.1.m1.1.1.3.2.cmml">
            θ
           </mi>
           <mo id="alg1.l16.1.m1.1.1.3.3" xref="alg1.l16.1.m1.1.1.3.3.cmml">
            ∗
           </mo>
          </msup>
         </msub>
         <annotation-xml encoding="MathML-Content" id="alg1.l16.1.m1.1b">
          <apply id="alg1.l16.1.m1.1.1.cmml" xref="alg1.l16.1.m1.1.1">
           <csymbol cd="ambiguous" id="alg1.l16.1.m1.1.1.1.cmml" xref="alg1.l16.1.m1.1.1">
            subscript
           </csymbol>
           <ci id="alg1.l16.1.m1.1.1.2.cmml" xref="alg1.l16.1.m1.1.1.2">
            𝜋
           </ci>
           <apply id="alg1.l16.1.m1.1.1.3.cmml" xref="alg1.l16.1.m1.1.1.3">
            <csymbol cd="ambiguous" id="alg1.l16.1.m1.1.1.3.1.cmml" xref="alg1.l16.1.m1.1.1.3">
             superscript
            </csymbol>
            <ci id="alg1.l16.1.m1.1.1.3.2.cmml" xref="alg1.l16.1.m1.1.1.3.2">
             𝜃
            </ci>
            <times id="alg1.l16.1.m1.1.1.3.3.cmml" xref="alg1.l16.1.m1.1.1.3.3">
            </times>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="alg1.l16.1.m1.1c">
          \pi_{\theta^{*}}
         </annotation>
        </semantics>
       </math>
      </span>
     </div>
    </div>
   </figure>
   <div class="ltx_para" id="S2.SS3.p1">
    <p class="ltx_p" id="S2.SS3.p1.2">
     Given an LLM expert from the parallel TextWorld, our goal is to train a VLM agent
     <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS3.p1.1.m1.1">
      <semantics id="S2.SS3.p1.1.m1.1a">
       <msub id="S2.SS3.p1.1.m1.1.1" xref="S2.SS3.p1.1.m1.1.1.cmml">
        <mi id="S2.SS3.p1.1.m1.1.1.2" xref="S2.SS3.p1.1.m1.1.1.2.cmml">
         π
        </mi>
        <mi id="S2.SS3.p1.1.m1.1.1.3" xref="S2.SS3.p1.1.m1.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.1.m1.1b">
        <apply id="S2.SS3.p1.1.m1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.1.m1.1.1.1.cmml" xref="S2.SS3.p1.1.m1.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.1.m1.1.1.2.cmml" xref="S2.SS3.p1.1.m1.1.1.2">
          𝜋
         </ci>
         <ci id="S2.SS3.p1.1.m1.1.1.3.cmml" xref="S2.SS3.p1.1.m1.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.1.m1.1c">
        \pi_{\theta}
       </annotation>
      </semantics>
     </math>
     in the visual world to closely imitate the the LLM expert’s behaviors. This is equal to minimizing the following objective under the distribution of states induced by
     <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS3.p1.2.m2.1">
      <semantics id="S2.SS3.p1.2.m2.1a">
       <msub id="S2.SS3.p1.2.m2.1.1" xref="S2.SS3.p1.2.m2.1.1.cmml">
        <mi id="S2.SS3.p1.2.m2.1.1.2" xref="S2.SS3.p1.2.m2.1.1.2.cmml">
         π
        </mi>
        <mi id="S2.SS3.p1.2.m2.1.1.3" xref="S2.SS3.p1.2.m2.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.2.m2.1b">
        <apply id="S2.SS3.p1.2.m2.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.2.m2.1.1.1.cmml" xref="S2.SS3.p1.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.2.m2.1.1.2.cmml" xref="S2.SS3.p1.2.m2.1.1.2">
          𝜋
         </ci>
         <ci id="S2.SS3.p1.2.m2.1.1.3.cmml" xref="S2.SS3.p1.2.m2.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.2.m2.1c">
        \pi_{\theta}
       </annotation>
      </semantics>
     </math>
     .
    </p>
    <table class="ltx_equation ltx_eqn_table" id="S2.E1">
     <tbody>
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_eqn_cell ltx_align_center">
        <math alttext="\theta^{*}=\mathop{\arg\min}\limits_{\theta\in\Theta}\mathbb{E}_{\pi_{\theta}}\mathopen{}\left[\mathcal{L}_{\text{imit}}\mathopen{}\left(\pi_{\theta}(x_{a}|s_{v}),x^{*}_{a})\mathclose{}\right)\mathclose{}\right]," class="ltx_math_unparsed" display="block" id="S2.E1.m1.1">
         <semantics id="S2.E1.m1.1a">
          <mrow id="S2.E1.m1.1b">
           <msup id="S2.E1.m1.1.1">
            <mi id="S2.E1.m1.1.1.2">
             θ
            </mi>
            <mo id="S2.E1.m1.1.1.3">
             ∗
            </mo>
           </msup>
           <mo id="S2.E1.m1.1.2">
            =
           </mo>
           <munder id="S2.E1.m1.1.3">
            <mrow id="S2.E1.m1.1.3.2">
             <mi id="S2.E1.m1.1.3.2.1">
              arg
             </mi>
             <mo id="S2.E1.m1.1.3.2a" lspace="0.167em">
              ⁡
             </mo>
             <mi id="S2.E1.m1.1.3.2.2">
              min
             </mi>
            </mrow>
            <mrow id="S2.E1.m1.1.3.3">
             <mi id="S2.E1.m1.1.3.3.2">
              θ
             </mi>
             <mo id="S2.E1.m1.1.3.3.1">
              ∈
             </mo>
             <mi id="S2.E1.m1.1.3.3.3" mathvariant="normal">
              Θ
             </mi>
            </mrow>
           </munder>
           <msub id="S2.E1.m1.1.4">
            <mi id="S2.E1.m1.1.4.2">
             𝔼
            </mi>
            <msub id="S2.E1.m1.1.4.3">
             <mi id="S2.E1.m1.1.4.3.2">
              π
             </mi>
             <mi id="S2.E1.m1.1.4.3.3">
              θ
             </mi>
            </msub>
           </msub>
           <mrow id="S2.E1.m1.1.5">
            <mo id="S2.E1.m1.1.5.1">
             [
            </mo>
            <msub id="S2.E1.m1.1.5.2">
             <mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.5.2.2">
              ℒ
             </mi>
             <mtext id="S2.E1.m1.1.5.2.3">
              imit
             </mtext>
            </msub>
            <mrow id="S2.E1.m1.1.5.3">
             <mo id="S2.E1.m1.1.5.3.1">
              (
             </mo>
             <msub id="S2.E1.m1.1.5.3.2">
              <mi id="S2.E1.m1.1.5.3.2.2">
               π
              </mi>
              <mi id="S2.E1.m1.1.5.3.2.3">
               θ
              </mi>
             </msub>
             <mrow id="S2.E1.m1.1.5.3.3">
              <mo id="S2.E1.m1.1.5.3.3.1" stretchy="false">
               (
              </mo>
              <msub id="S2.E1.m1.1.5.3.3.2">
               <mi id="S2.E1.m1.1.5.3.3.2.2">
                x
               </mi>
               <mi id="S2.E1.m1.1.5.3.3.2.3">
                a
               </mi>
              </msub>
              <mo fence="false" id="S2.E1.m1.1.5.3.3.3" rspace="0.167em" stretchy="false">
               |
              </mo>
              <msub id="S2.E1.m1.1.5.3.3.4">
               <mi id="S2.E1.m1.1.5.3.3.4.2">
                s
               </mi>
               <mi id="S2.E1.m1.1.5.3.3.4.3">
                v
               </mi>
              </msub>
              <mo id="S2.E1.m1.1.5.3.3.5" stretchy="false">
               )
              </mo>
             </mrow>
             <mo id="S2.E1.m1.1.5.3.4">
              ,
             </mo>
             <msubsup id="S2.E1.m1.1.5.3.5">
              <mi id="S2.E1.m1.1.5.3.5.2.2">
               x
              </mi>
              <mi id="S2.E1.m1.1.5.3.5.3">
               a
              </mi>
              <mo id="S2.E1.m1.1.5.3.5.2.3">
               ∗
              </mo>
             </msubsup>
             <mo id="S2.E1.m1.1.5.3.6" stretchy="false">
              )
             </mo>
            </mrow>
            <mo id="S2.E1.m1.1.5.4">
             )
            </mo>
           </mrow>
           <mo id="S2.E1.m1.1.6">
            ]
           </mo>
           <mo id="S2.E1.m1.1.7">
            ,
           </mo>
          </mrow>
          <annotation encoding="application/x-tex" id="S2.E1.m1.1c">
           \theta^{*}=\mathop{\arg\min}\limits_{\theta\in\Theta}\mathbb{E}_{\pi_{\theta}}\mathopen{}\left[\mathcal{L}_{\text{imit}}\mathopen{}\left(\pi_{\theta}(x_{a}|s_{v}),x^{*}_{a})\mathclose{}\right)\mathclose{}\right],
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S2.SS3.p1.3">
     in which the choice of loss function
     <math alttext="\mathcal{L}_{\text{imit}}" class="ltx_Math" display="inline" id="S2.SS3.p1.3.m1.1">
      <semantics id="S2.SS3.p1.3.m1.1a">
       <msub id="S2.SS3.p1.3.m1.1.1" xref="S2.SS3.p1.3.m1.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S2.SS3.p1.3.m1.1.1.2" xref="S2.SS3.p1.3.m1.1.1.2.cmml">
         ℒ
        </mi>
        <mtext id="S2.SS3.p1.3.m1.1.1.3" xref="S2.SS3.p1.3.m1.1.1.3a.cmml">
         imit
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.3.m1.1b">
        <apply id="S2.SS3.p1.3.m1.1.1.cmml" xref="S2.SS3.p1.3.m1.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.3.m1.1.1.1.cmml" xref="S2.SS3.p1.3.m1.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.3.m1.1.1.2.cmml" xref="S2.SS3.p1.3.m1.1.1.2">
          ℒ
         </ci>
         <ci id="S2.SS3.p1.3.m1.1.1.3a.cmml" xref="S2.SS3.p1.3.m1.1.1.3">
          <mtext id="S2.SS3.p1.3.m1.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p1.3.m1.1.1.3">
           imit
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.3.m1.1c">
        \mathcal{L}_{\text{imit}}
       </annotation>
      </semantics>
     </math>
     is dependent on specific scenarios. For instance, it may be the expected cross-entropy loss for the discrete action space, or the expected MSE loss for the continuous action space. In our case, we select DPO
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib43" title="">
       <span class="ltx_text" style="font-size:90%;">
        43
       </span>
      </a>
      ]
     </cite>
     loss due to its proven superior performance to the cross-entropy on aligning models with expert preferences within the discrete language space. Hence, Eq. (
     <a class="ltx_ref" href="#S2.E1" title="Equation 1 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     ) can be extended to the formulation below.
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S9.EGx1">
     <tbody id="S2.E2">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\theta^{*}=\mathop{\arg\min}\limits_{\theta\in\Theta}-\mathbb{E}_{\pi_{\theta}}\mathopen{}\left[\mathcal{L}_{\text{imit}}\mathopen{}\left(\pi_{\theta},\pi_{\text{ref}},s_{v},x_{a},x^{*}_{a}\mathclose{}\right)\mathclose{}\right]," class="ltx_Math" display="inline" id="S2.E2.m1.1">
         <semantics id="S2.E2.m1.1a">
          <mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">
           <mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">
            <msup id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml">
             <mi id="S2.E2.m1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.3.2.cmml">
              θ
             </mi>
             <mo id="S2.E2.m1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.3.3.cmml">
              ∗
             </mo>
            </msup>
            <mo id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml">
             =
            </mo>
            <mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml">
             <munder id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.3.cmml">
              <mrow id="S2.E2.m1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.3.2.cmml">
               <mi id="S2.E2.m1.1.1.1.1.1.3.2.1" xref="S2.E2.m1.1.1.1.1.1.3.2.1.cmml">
                arg
               </mi>
               <mo id="S2.E2.m1.1.1.1.1.1.3.2a" lspace="0.167em" xref="S2.E2.m1.1.1.1.1.1.3.2.cmml">
                ⁡
               </mo>
               <mi id="S2.E2.m1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.1.3.2.2.cmml">
                min
               </mi>
              </mrow>
              <mrow id="S2.E2.m1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.3.3.cmml">
               <mi id="S2.E2.m1.1.1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.1.1.3.3.2.cmml">
                θ
               </mi>
               <mo id="S2.E2.m1.1.1.1.1.1.3.3.1" xref="S2.E2.m1.1.1.1.1.1.3.3.1.cmml">
                ∈
               </mo>
               <mi id="S2.E2.m1.1.1.1.1.1.3.3.3" mathvariant="normal" xref="S2.E2.m1.1.1.1.1.1.3.3.3.cmml">
                Θ
               </mi>
              </mrow>
             </munder>
             <mo id="S2.E2.m1.1.1.1.1.1.2" lspace="0em" xref="S2.E2.m1.1.1.1.1.1.2.cmml">
              −
             </mo>
             <mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml">
              <msub id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">
               <mi id="S2.E2.m1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.3.2.cmml">
                𝔼
               </mi>
               <msub id="S2.E2.m1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.3.3.cmml">
                <mi id="S2.E2.m1.1.1.1.1.1.1.3.3.2" xref="S2.E2.m1.1.1.1.1.1.1.3.3.2.cmml">
                 π
                </mi>
                <mi id="S2.E2.m1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.1.1.3.3.3.cmml">
                 θ
                </mi>
               </msub>
              </msub>
              <mo id="S2.E2.m1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="S2.E2.m1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.2.cmml">
               <mo id="S2.E2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.2.1.cmml">
                [
               </mo>
               <mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml">
                <msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.7" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.cmml">
                 <mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.2.cmml">
                  ℒ
                 </mi>
                 <mtext id="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.3a.cmml">
                  imit
                 </mtext>
                </msub>
                <mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.6" lspace="0em" rspace="0em" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.6.cmml">
                 ​
                </mo>
                <mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.6.cmml">
                 <mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.6" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.6.cmml">
                  (
                 </mo>
                 <msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  <mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                   π
                  </mi>
                  <mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                   θ
                  </mi>
                 </msub>
                 <mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.7" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.6.cmml">
                  ,
                 </mo>
                 <msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">
                  <mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">
                   π
                  </mi>
                  <mtext id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3a.cmml">
                   ref
                  </mtext>
                 </msub>
                 <mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.8" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.6.cmml">
                  ,
                 </mo>
                 <msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">
                  <mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">
                   s
                  </mi>
                  <mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">
                   v
                  </mi>
                 </msub>
                 <mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.9" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.6.cmml">
                  ,
                 </mo>
                 <msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.cmml">
                  <mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.2.cmml">
                   x
                  </mi>
                  <mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.3.cmml">
                   a
                  </mi>
                 </msub>
                 <mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.10" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.6.cmml">
                  ,
                 </mo>
                 <msubsup id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.cmml">
                  <mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.2.2.cmml">
                   x
                  </mi>
                  <mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.3.cmml">
                   a
                  </mi>
                  <mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.2.3.cmml">
                   ∗
                  </mo>
                 </msubsup>
                 <mo id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.11" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.6.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="S2.E2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.2.1.cmml">
                ]
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">
            ,
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b">
           <apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1">
            <eq id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2">
            </eq>
            <apply id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3">
              superscript
             </csymbol>
             <ci id="S2.E2.m1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2">
              𝜃
             </ci>
             <times id="S2.E2.m1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3">
             </times>
            </apply>
            <apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1">
             <minus id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2">
             </minus>
             <apply id="S2.E2.m1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3">
              <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.3">
               subscript
              </csymbol>
              <apply id="S2.E2.m1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.3.2">
               <arg id="S2.E2.m1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.3.2.1">
               </arg>
               <min id="S2.E2.m1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.3.2.2">
               </min>
              </apply>
              <apply id="S2.E2.m1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3.3">
               <in id="S2.E2.m1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.3.3.1">
               </in>
               <ci id="S2.E2.m1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.3.3.2">
                𝜃
               </ci>
               <ci id="S2.E2.m1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.3.3.3">
                Θ
               </ci>
              </apply>
             </apply>
             <apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">
              <times id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">
              </times>
              <apply id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">
               <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="S2.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.2">
                𝔼
               </ci>
               <apply id="S2.E2.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3">
                <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3">
                 subscript
                </csymbol>
                <ci id="S2.E2.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3.2">
                 𝜋
                </ci>
                <ci id="S2.E2.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3.3">
                 𝜃
                </ci>
               </apply>
              </apply>
              <apply id="S2.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1">
               <csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.2">
                delimited-[]
               </csymbol>
               <apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1">
                <times id="S2.E2.m1.1.1.1.1.1.1.1.1.1.6.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.6">
                </times>
                <apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.7">
                 <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.7">
                  subscript
                 </csymbol>
                 <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.2">
                  ℒ
                 </ci>
                 <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.3a.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.3">
                  <mtext id="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.3.cmml" mathsize="70%" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.7.3">
                   imit
                  </mtext>
                 </ci>
                </apply>
                <vector id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.6.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5">
                 <apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                   𝜋
                  </ci>
                  <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                   𝜃
                  </ci>
                 </apply>
                 <apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2">
                  <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2">
                   subscript
                  </csymbol>
                  <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.2">
                   𝜋
                  </ci>
                  <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3a.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3">
                   <mtext id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" mathsize="70%" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.2.3">
                    ref
                   </mtext>
                  </ci>
                 </apply>
                 <apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3">
                  <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3">
                   subscript
                  </csymbol>
                  <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.2">
                   𝑠
                  </ci>
                  <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.3.3.3">
                   𝑣
                  </ci>
                 </apply>
                 <apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4">
                  <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4">
                   subscript
                  </csymbol>
                  <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.2">
                   𝑥
                  </ci>
                  <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.4.4.4.3">
                   𝑎
                  </ci>
                 </apply>
                 <apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5">
                  <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5">
                   subscript
                  </csymbol>
                  <apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5">
                   <csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5">
                    superscript
                   </csymbol>
                   <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.2.2">
                    𝑥
                   </ci>
                   <times id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.2.3">
                   </times>
                  </apply>
                  <ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.5.5.5.3">
                   𝑎
                  </ci>
                 </apply>
                </vector>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.E2.m1.1c">
           \displaystyle\theta^{*}=\mathop{\arg\min}\limits_{\theta\in\Theta}-\mathbb{E}_{\pi_{\theta}}\mathopen{}\left[\mathcal{L}_{\text{imit}}\mathopen{}\left(\pi_{\theta},\pi_{\text{ref}},s_{v},x_{a},x^{*}_{a}\mathclose{}\right)\mathclose{}\right],
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (2)
        </span>
       </td>
      </tr>
     </tbody>
     <tbody id="S2.Ex1">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{L}_{\text{imit}}(\cdot)\triangleq\log\sigma\mathopen{}\left(\beta\log\frac{\pi_{\theta}(x^{*}_{a}|s_{v})}{\pi_{\text{ref}}(x^{*}_{a}|s_{v})}-\beta\log\frac{\pi_{\theta}(x_{a}|s_{v})}{\pi_{\text{ref}}(x_{a}|s_{v})}\mathclose{}\right)" class="ltx_Math" display="inline" id="S2.Ex1.m1.6">
         <semantics id="S2.Ex1.m1.6a">
          <mrow id="S2.Ex1.m1.6.6" xref="S2.Ex1.m1.6.6.cmml">
           <mrow id="S2.Ex1.m1.6.6.3" xref="S2.Ex1.m1.6.6.3.cmml">
            <msub id="S2.Ex1.m1.6.6.3.2" xref="S2.Ex1.m1.6.6.3.2.cmml">
             <mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.6.6.3.2.2" xref="S2.Ex1.m1.6.6.3.2.2.cmml">
              ℒ
             </mi>
             <mtext id="S2.Ex1.m1.6.6.3.2.3" xref="S2.Ex1.m1.6.6.3.2.3a.cmml">
              imit
             </mtext>
            </msub>
            <mo id="S2.Ex1.m1.6.6.3.1" lspace="0em" rspace="0em" xref="S2.Ex1.m1.6.6.3.1.cmml">
             ​
            </mo>
            <mrow id="S2.Ex1.m1.6.6.3.3.2" xref="S2.Ex1.m1.6.6.3.cmml">
             <mo id="S2.Ex1.m1.6.6.3.3.2.1" stretchy="false" xref="S2.Ex1.m1.6.6.3.cmml">
              (
             </mo>
             <mo id="S2.Ex1.m1.5.5" lspace="0em" rspace="0em" xref="S2.Ex1.m1.5.5.cmml">
              ⋅
             </mo>
             <mo id="S2.Ex1.m1.6.6.3.3.2.2" stretchy="false" xref="S2.Ex1.m1.6.6.3.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S2.Ex1.m1.6.6.2" xref="S2.Ex1.m1.6.6.2.cmml">
            ≜
           </mo>
           <mrow id="S2.Ex1.m1.6.6.1" xref="S2.Ex1.m1.6.6.1.cmml">
            <mrow id="S2.Ex1.m1.6.6.1.3" xref="S2.Ex1.m1.6.6.1.3.cmml">
             <mi id="S2.Ex1.m1.6.6.1.3.1" xref="S2.Ex1.m1.6.6.1.3.1.cmml">
              log
             </mi>
             <mo id="S2.Ex1.m1.6.6.1.3a" lspace="0.167em" xref="S2.Ex1.m1.6.6.1.3.cmml">
              ⁡
             </mo>
             <mi id="S2.Ex1.m1.6.6.1.3.2" xref="S2.Ex1.m1.6.6.1.3.2.cmml">
              σ
             </mi>
            </mrow>
            <mo id="S2.Ex1.m1.6.6.1.2" lspace="0em" rspace="0em" xref="S2.Ex1.m1.6.6.1.2.cmml">
             ​
            </mo>
            <mrow id="S2.Ex1.m1.6.6.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.cmml">
             <mo id="S2.Ex1.m1.6.6.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.cmml">
              (
             </mo>
             <mrow id="S2.Ex1.m1.6.6.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.cmml">
              <mrow id="S2.Ex1.m1.6.6.1.1.1.1.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.cmml">
               <mi id="S2.Ex1.m1.6.6.1.1.1.1.2.2" xref="S2.Ex1.m1.6.6.1.1.1.1.2.2.cmml">
                β
               </mi>
               <mo id="S2.Ex1.m1.6.6.1.1.1.1.2.1" lspace="0.167em" rspace="0em" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1.cmml">
                ​
               </mo>
               <mrow id="S2.Ex1.m1.6.6.1.1.1.1.2.3" xref="S2.Ex1.m1.6.6.1.1.1.1.2.3.cmml">
                <mi id="S2.Ex1.m1.6.6.1.1.1.1.2.3.1" xref="S2.Ex1.m1.6.6.1.1.1.1.2.3.1.cmml">
                 log
                </mi>
                <mo id="S2.Ex1.m1.6.6.1.1.1.1.2.3a" lspace="0.167em" xref="S2.Ex1.m1.6.6.1.1.1.1.2.3.cmml">
                 ⁡
                </mo>
                <mstyle displaystyle="true" id="S2.Ex1.m1.2.2" xref="S2.Ex1.m1.2.2.cmml">
                 <mfrac id="S2.Ex1.m1.2.2a" xref="S2.Ex1.m1.2.2.cmml">
                  <mrow id="S2.Ex1.m1.1.1.1" xref="S2.Ex1.m1.1.1.1.cmml">
                   <msub id="S2.Ex1.m1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.3.cmml">
                    <mi id="S2.Ex1.m1.1.1.1.3.2" xref="S2.Ex1.m1.1.1.1.3.2.cmml">
                     π
                    </mi>
                    <mi id="S2.Ex1.m1.1.1.1.3.3" xref="S2.Ex1.m1.1.1.1.3.3.cmml">
                     θ
                    </mi>
                   </msub>
                   <mo id="S2.Ex1.m1.1.1.1.2" lspace="0em" rspace="0em" xref="S2.Ex1.m1.1.1.1.2.cmml">
                    ​
                   </mo>
                   <mrow id="S2.Ex1.m1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.cmml">
                    <mo id="S2.Ex1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.1.1.cmml">
                     (
                    </mo>
                    <mrow id="S2.Ex1.m1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.cmml">
                     <msubsup id="S2.Ex1.m1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.1.2.cmml">
                      <mi id="S2.Ex1.m1.1.1.1.1.1.1.2.2.2" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.2.cmml">
                       x
                      </mi>
                      <mi id="S2.Ex1.m1.1.1.1.1.1.1.2.3" xref="S2.Ex1.m1.1.1.1.1.1.1.2.3.cmml">
                       a
                      </mi>
                      <mo id="S2.Ex1.m1.1.1.1.1.1.1.2.2.3" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.cmml">
                       ∗
                      </mo>
                     </msubsup>
                     <mo fence="false" id="S2.Ex1.m1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.1.cmml">
                      |
                     </mo>
                     <msub id="S2.Ex1.m1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.1.3.cmml">
                      <mi id="S2.Ex1.m1.1.1.1.1.1.1.3.2" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.cmml">
                       s
                      </mi>
                      <mi id="S2.Ex1.m1.1.1.1.1.1.1.3.3" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3.cmml">
                       v
                      </mi>
                     </msub>
                    </mrow>
                    <mo id="S2.Ex1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.1.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                  <mrow id="S2.Ex1.m1.2.2.2" xref="S2.Ex1.m1.2.2.2.cmml">
                   <msub id="S2.Ex1.m1.2.2.2.3" xref="S2.Ex1.m1.2.2.2.3.cmml">
                    <mi id="S2.Ex1.m1.2.2.2.3.2" xref="S2.Ex1.m1.2.2.2.3.2.cmml">
                     π
                    </mi>
                    <mtext id="S2.Ex1.m1.2.2.2.3.3" xref="S2.Ex1.m1.2.2.2.3.3a.cmml">
                     ref
                    </mtext>
                   </msub>
                   <mo id="S2.Ex1.m1.2.2.2.2" lspace="0em" rspace="0em" xref="S2.Ex1.m1.2.2.2.2.cmml">
                    ​
                   </mo>
                   <mrow id="S2.Ex1.m1.2.2.2.1.1" xref="S2.Ex1.m1.2.2.2.1.1.1.cmml">
                    <mo id="S2.Ex1.m1.2.2.2.1.1.2" stretchy="false" xref="S2.Ex1.m1.2.2.2.1.1.1.cmml">
                     (
                    </mo>
                    <mrow id="S2.Ex1.m1.2.2.2.1.1.1" xref="S2.Ex1.m1.2.2.2.1.1.1.cmml">
                     <msubsup id="S2.Ex1.m1.2.2.2.1.1.1.2" xref="S2.Ex1.m1.2.2.2.1.1.1.2.cmml">
                      <mi id="S2.Ex1.m1.2.2.2.1.1.1.2.2.2" xref="S2.Ex1.m1.2.2.2.1.1.1.2.2.2.cmml">
                       x
                      </mi>
                      <mi id="S2.Ex1.m1.2.2.2.1.1.1.2.3" xref="S2.Ex1.m1.2.2.2.1.1.1.2.3.cmml">
                       a
                      </mi>
                      <mo id="S2.Ex1.m1.2.2.2.1.1.1.2.2.3" xref="S2.Ex1.m1.2.2.2.1.1.1.2.2.3.cmml">
                       ∗
                      </mo>
                     </msubsup>
                     <mo fence="false" id="S2.Ex1.m1.2.2.2.1.1.1.1" xref="S2.Ex1.m1.2.2.2.1.1.1.1.cmml">
                      |
                     </mo>
                     <msub id="S2.Ex1.m1.2.2.2.1.1.1.3" xref="S2.Ex1.m1.2.2.2.1.1.1.3.cmml">
                      <mi id="S2.Ex1.m1.2.2.2.1.1.1.3.2" xref="S2.Ex1.m1.2.2.2.1.1.1.3.2.cmml">
                       s
                      </mi>
                      <mi id="S2.Ex1.m1.2.2.2.1.1.1.3.3" xref="S2.Ex1.m1.2.2.2.1.1.1.3.3.cmml">
                       v
                      </mi>
                     </msub>
                    </mrow>
                    <mo id="S2.Ex1.m1.2.2.2.1.1.3" stretchy="false" xref="S2.Ex1.m1.2.2.2.1.1.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mfrac>
                </mstyle>
               </mrow>
              </mrow>
              <mo id="S2.Ex1.m1.6.6.1.1.1.1.1" xref="S2.Ex1.m1.6.6.1.1.1.1.1.cmml">
               −
              </mo>
              <mrow id="S2.Ex1.m1.6.6.1.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.3.cmml">
               <mi id="S2.Ex1.m1.6.6.1.1.1.1.3.2" xref="S2.Ex1.m1.6.6.1.1.1.1.3.2.cmml">
                β
               </mi>
               <mo id="S2.Ex1.m1.6.6.1.1.1.1.3.1" lspace="0.167em" rspace="0em" xref="S2.Ex1.m1.6.6.1.1.1.1.3.1.cmml">
                ​
               </mo>
               <mrow id="S2.Ex1.m1.6.6.1.1.1.1.3.3" xref="S2.Ex1.m1.6.6.1.1.1.1.3.3.cmml">
                <mi id="S2.Ex1.m1.6.6.1.1.1.1.3.3.1" xref="S2.Ex1.m1.6.6.1.1.1.1.3.3.1.cmml">
                 log
                </mi>
                <mo id="S2.Ex1.m1.6.6.1.1.1.1.3.3a" lspace="0.167em" xref="S2.Ex1.m1.6.6.1.1.1.1.3.3.cmml">
                 ⁡
                </mo>
                <mstyle displaystyle="true" id="S2.Ex1.m1.4.4" xref="S2.Ex1.m1.4.4.cmml">
                 <mfrac id="S2.Ex1.m1.4.4a" xref="S2.Ex1.m1.4.4.cmml">
                  <mrow id="S2.Ex1.m1.3.3.1" xref="S2.Ex1.m1.3.3.1.cmml">
                   <msub id="S2.Ex1.m1.3.3.1.3" xref="S2.Ex1.m1.3.3.1.3.cmml">
                    <mi id="S2.Ex1.m1.3.3.1.3.2" xref="S2.Ex1.m1.3.3.1.3.2.cmml">
                     π
                    </mi>
                    <mi id="S2.Ex1.m1.3.3.1.3.3" xref="S2.Ex1.m1.3.3.1.3.3.cmml">
                     θ
                    </mi>
                   </msub>
                   <mo id="S2.Ex1.m1.3.3.1.2" lspace="0em" rspace="0em" xref="S2.Ex1.m1.3.3.1.2.cmml">
                    ​
                   </mo>
                   <mrow id="S2.Ex1.m1.3.3.1.1.1" xref="S2.Ex1.m1.3.3.1.1.1.1.cmml">
                    <mo id="S2.Ex1.m1.3.3.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.3.3.1.1.1.1.cmml">
                     (
                    </mo>
                    <mrow id="S2.Ex1.m1.3.3.1.1.1.1" xref="S2.Ex1.m1.3.3.1.1.1.1.cmml">
                     <msub id="S2.Ex1.m1.3.3.1.1.1.1.2" xref="S2.Ex1.m1.3.3.1.1.1.1.2.cmml">
                      <mi id="S2.Ex1.m1.3.3.1.1.1.1.2.2" xref="S2.Ex1.m1.3.3.1.1.1.1.2.2.cmml">
                       x
                      </mi>
                      <mi id="S2.Ex1.m1.3.3.1.1.1.1.2.3" xref="S2.Ex1.m1.3.3.1.1.1.1.2.3.cmml">
                       a
                      </mi>
                     </msub>
                     <mo fence="false" id="S2.Ex1.m1.3.3.1.1.1.1.1" xref="S2.Ex1.m1.3.3.1.1.1.1.1.cmml">
                      |
                     </mo>
                     <msub id="S2.Ex1.m1.3.3.1.1.1.1.3" xref="S2.Ex1.m1.3.3.1.1.1.1.3.cmml">
                      <mi id="S2.Ex1.m1.3.3.1.1.1.1.3.2" xref="S2.Ex1.m1.3.3.1.1.1.1.3.2.cmml">
                       s
                      </mi>
                      <mi id="S2.Ex1.m1.3.3.1.1.1.1.3.3" xref="S2.Ex1.m1.3.3.1.1.1.1.3.3.cmml">
                       v
                      </mi>
                     </msub>
                    </mrow>
                    <mo id="S2.Ex1.m1.3.3.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.3.3.1.1.1.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                  <mrow id="S2.Ex1.m1.4.4.2" xref="S2.Ex1.m1.4.4.2.cmml">
                   <msub id="S2.Ex1.m1.4.4.2.3" xref="S2.Ex1.m1.4.4.2.3.cmml">
                    <mi id="S2.Ex1.m1.4.4.2.3.2" xref="S2.Ex1.m1.4.4.2.3.2.cmml">
                     π
                    </mi>
                    <mtext id="S2.Ex1.m1.4.4.2.3.3" xref="S2.Ex1.m1.4.4.2.3.3a.cmml">
                     ref
                    </mtext>
                   </msub>
                   <mo id="S2.Ex1.m1.4.4.2.2" lspace="0em" rspace="0em" xref="S2.Ex1.m1.4.4.2.2.cmml">
                    ​
                   </mo>
                   <mrow id="S2.Ex1.m1.4.4.2.1.1" xref="S2.Ex1.m1.4.4.2.1.1.1.cmml">
                    <mo id="S2.Ex1.m1.4.4.2.1.1.2" stretchy="false" xref="S2.Ex1.m1.4.4.2.1.1.1.cmml">
                     (
                    </mo>
                    <mrow id="S2.Ex1.m1.4.4.2.1.1.1" xref="S2.Ex1.m1.4.4.2.1.1.1.cmml">
                     <msub id="S2.Ex1.m1.4.4.2.1.1.1.2" xref="S2.Ex1.m1.4.4.2.1.1.1.2.cmml">
                      <mi id="S2.Ex1.m1.4.4.2.1.1.1.2.2" xref="S2.Ex1.m1.4.4.2.1.1.1.2.2.cmml">
                       x
                      </mi>
                      <mi id="S2.Ex1.m1.4.4.2.1.1.1.2.3" xref="S2.Ex1.m1.4.4.2.1.1.1.2.3.cmml">
                       a
                      </mi>
                     </msub>
                     <mo fence="false" id="S2.Ex1.m1.4.4.2.1.1.1.1" xref="S2.Ex1.m1.4.4.2.1.1.1.1.cmml">
                      |
                     </mo>
                     <msub id="S2.Ex1.m1.4.4.2.1.1.1.3" xref="S2.Ex1.m1.4.4.2.1.1.1.3.cmml">
                      <mi id="S2.Ex1.m1.4.4.2.1.1.1.3.2" xref="S2.Ex1.m1.4.4.2.1.1.1.3.2.cmml">
                       s
                      </mi>
                      <mi id="S2.Ex1.m1.4.4.2.1.1.1.3.3" xref="S2.Ex1.m1.4.4.2.1.1.1.3.3.cmml">
                       v
                      </mi>
                     </msub>
                    </mrow>
                    <mo id="S2.Ex1.m1.4.4.2.1.1.3" stretchy="false" xref="S2.Ex1.m1.4.4.2.1.1.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mfrac>
                </mstyle>
               </mrow>
              </mrow>
             </mrow>
             <mo id="S2.Ex1.m1.6.6.1.1.1.3" xref="S2.Ex1.m1.6.6.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.6b">
           <apply id="S2.Ex1.m1.6.6.cmml" xref="S2.Ex1.m1.6.6">
            <ci id="S2.Ex1.m1.6.6.2.cmml" xref="S2.Ex1.m1.6.6.2">
             ≜
            </ci>
            <apply id="S2.Ex1.m1.6.6.3.cmml" xref="S2.Ex1.m1.6.6.3">
             <times id="S2.Ex1.m1.6.6.3.1.cmml" xref="S2.Ex1.m1.6.6.3.1">
             </times>
             <apply id="S2.Ex1.m1.6.6.3.2.cmml" xref="S2.Ex1.m1.6.6.3.2">
              <csymbol cd="ambiguous" id="S2.Ex1.m1.6.6.3.2.1.cmml" xref="S2.Ex1.m1.6.6.3.2">
               subscript
              </csymbol>
              <ci id="S2.Ex1.m1.6.6.3.2.2.cmml" xref="S2.Ex1.m1.6.6.3.2.2">
               ℒ
              </ci>
              <ci id="S2.Ex1.m1.6.6.3.2.3a.cmml" xref="S2.Ex1.m1.6.6.3.2.3">
               <mtext id="S2.Ex1.m1.6.6.3.2.3.cmml" mathsize="70%" xref="S2.Ex1.m1.6.6.3.2.3">
                imit
               </mtext>
              </ci>
             </apply>
             <ci id="S2.Ex1.m1.5.5.cmml" xref="S2.Ex1.m1.5.5">
              ⋅
             </ci>
            </apply>
            <apply id="S2.Ex1.m1.6.6.1.cmml" xref="S2.Ex1.m1.6.6.1">
             <times id="S2.Ex1.m1.6.6.1.2.cmml" xref="S2.Ex1.m1.6.6.1.2">
             </times>
             <apply id="S2.Ex1.m1.6.6.1.3.cmml" xref="S2.Ex1.m1.6.6.1.3">
              <log id="S2.Ex1.m1.6.6.1.3.1.cmml" xref="S2.Ex1.m1.6.6.1.3.1">
              </log>
              <ci id="S2.Ex1.m1.6.6.1.3.2.cmml" xref="S2.Ex1.m1.6.6.1.3.2">
               𝜎
              </ci>
             </apply>
             <apply id="S2.Ex1.m1.6.6.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1">
              <minus id="S2.Ex1.m1.6.6.1.1.1.1.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.1">
              </minus>
              <apply id="S2.Ex1.m1.6.6.1.1.1.1.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2">
               <times id="S2.Ex1.m1.6.6.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.1">
               </times>
               <ci id="S2.Ex1.m1.6.6.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.2">
                𝛽
               </ci>
               <apply id="S2.Ex1.m1.6.6.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.3">
                <log id="S2.Ex1.m1.6.6.1.1.1.1.2.3.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.2.3.1">
                </log>
                <apply id="S2.Ex1.m1.2.2.cmml" xref="S2.Ex1.m1.2.2">
                 <divide id="S2.Ex1.m1.2.2.3.cmml" xref="S2.Ex1.m1.2.2">
                 </divide>
                 <apply id="S2.Ex1.m1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1">
                  <times id="S2.Ex1.m1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.2">
                  </times>
                  <apply id="S2.Ex1.m1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.3">
                   <csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.3">
                    subscript
                   </csymbol>
                   <ci id="S2.Ex1.m1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.1.1.1.3.2">
                    𝜋
                   </ci>
                   <ci id="S2.Ex1.m1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.1.3.3">
                    𝜃
                   </ci>
                  </apply>
                  <apply id="S2.Ex1.m1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1">
                   <csymbol cd="latexml" id="S2.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1">
                    conditional
                   </csymbol>
                   <apply id="S2.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2">
                    <csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2">
                     subscript
                    </csymbol>
                    <apply id="S2.Ex1.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2">
                     <csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2">
                      superscript
                     </csymbol>
                     <ci id="S2.Ex1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.2">
                      𝑥
                     </ci>
                     <times id="S2.Ex1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.2.3">
                     </times>
                    </apply>
                    <ci id="S2.Ex1.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.2.3">
                     𝑎
                    </ci>
                   </apply>
                   <apply id="S2.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3">
                    <csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3">
                     subscript
                    </csymbol>
                    <ci id="S2.Ex1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2">
                     𝑠
                    </ci>
                    <ci id="S2.Ex1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3">
                     𝑣
                    </ci>
                   </apply>
                  </apply>
                 </apply>
                 <apply id="S2.Ex1.m1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2">
                  <times id="S2.Ex1.m1.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.2">
                  </times>
                  <apply id="S2.Ex1.m1.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2.3">
                   <csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.3.1.cmml" xref="S2.Ex1.m1.2.2.2.3">
                    subscript
                   </csymbol>
                   <ci id="S2.Ex1.m1.2.2.2.3.2.cmml" xref="S2.Ex1.m1.2.2.2.3.2">
                    𝜋
                   </ci>
                   <ci id="S2.Ex1.m1.2.2.2.3.3a.cmml" xref="S2.Ex1.m1.2.2.2.3.3">
                    <mtext id="S2.Ex1.m1.2.2.2.3.3.cmml" mathsize="70%" xref="S2.Ex1.m1.2.2.2.3.3">
                     ref
                    </mtext>
                   </ci>
                  </apply>
                  <apply id="S2.Ex1.m1.2.2.2.1.1.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1">
                   <csymbol cd="latexml" id="S2.Ex1.m1.2.2.2.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.1">
                    conditional
                   </csymbol>
                   <apply id="S2.Ex1.m1.2.2.2.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.2">
                    <csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.1.1.1.2.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.2">
                     subscript
                    </csymbol>
                    <apply id="S2.Ex1.m1.2.2.2.1.1.1.2.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.2">
                     <csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.1.1.1.2.2.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.2">
                      superscript
                     </csymbol>
                     <ci id="S2.Ex1.m1.2.2.2.1.1.1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.2.2.2">
                      𝑥
                     </ci>
                     <times id="S2.Ex1.m1.2.2.2.1.1.1.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.2.2.3">
                     </times>
                    </apply>
                    <ci id="S2.Ex1.m1.2.2.2.1.1.1.2.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.2.3">
                     𝑎
                    </ci>
                   </apply>
                   <apply id="S2.Ex1.m1.2.2.2.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3">
                    <csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.1.1.1.3.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3">
                     subscript
                    </csymbol>
                    <ci id="S2.Ex1.m1.2.2.2.1.1.1.3.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3.2">
                     𝑠
                    </ci>
                    <ci id="S2.Ex1.m1.2.2.2.1.1.1.3.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3.3">
                     𝑣
                    </ci>
                   </apply>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
              <apply id="S2.Ex1.m1.6.6.1.1.1.1.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.3">
               <times id="S2.Ex1.m1.6.6.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.3.1">
               </times>
               <ci id="S2.Ex1.m1.6.6.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.3.2">
                𝛽
               </ci>
               <apply id="S2.Ex1.m1.6.6.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.3.3">
                <log id="S2.Ex1.m1.6.6.1.1.1.1.3.3.1.cmml" xref="S2.Ex1.m1.6.6.1.1.1.1.3.3.1">
                </log>
                <apply id="S2.Ex1.m1.4.4.cmml" xref="S2.Ex1.m1.4.4">
                 <divide id="S2.Ex1.m1.4.4.3.cmml" xref="S2.Ex1.m1.4.4">
                 </divide>
                 <apply id="S2.Ex1.m1.3.3.1.cmml" xref="S2.Ex1.m1.3.3.1">
                  <times id="S2.Ex1.m1.3.3.1.2.cmml" xref="S2.Ex1.m1.3.3.1.2">
                  </times>
                  <apply id="S2.Ex1.m1.3.3.1.3.cmml" xref="S2.Ex1.m1.3.3.1.3">
                   <csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.3.1.cmml" xref="S2.Ex1.m1.3.3.1.3">
                    subscript
                   </csymbol>
                   <ci id="S2.Ex1.m1.3.3.1.3.2.cmml" xref="S2.Ex1.m1.3.3.1.3.2">
                    𝜋
                   </ci>
                   <ci id="S2.Ex1.m1.3.3.1.3.3.cmml" xref="S2.Ex1.m1.3.3.1.3.3">
                    𝜃
                   </ci>
                  </apply>
                  <apply id="S2.Ex1.m1.3.3.1.1.1.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1">
                   <csymbol cd="latexml" id="S2.Ex1.m1.3.3.1.1.1.1.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.1">
                    conditional
                   </csymbol>
                   <apply id="S2.Ex1.m1.3.3.1.1.1.1.2.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.2">
                    <csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.2">
                     subscript
                    </csymbol>
                    <ci id="S2.Ex1.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.2.2">
                     𝑥
                    </ci>
                    <ci id="S2.Ex1.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.2.3">
                     𝑎
                    </ci>
                   </apply>
                   <apply id="S2.Ex1.m1.3.3.1.1.1.1.3.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.3">
                    <csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.3">
                     subscript
                    </csymbol>
                    <ci id="S2.Ex1.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.3.2">
                     𝑠
                    </ci>
                    <ci id="S2.Ex1.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.3.3.1.1.1.1.3.3">
                     𝑣
                    </ci>
                   </apply>
                  </apply>
                 </apply>
                 <apply id="S2.Ex1.m1.4.4.2.cmml" xref="S2.Ex1.m1.4.4.2">
                  <times id="S2.Ex1.m1.4.4.2.2.cmml" xref="S2.Ex1.m1.4.4.2.2">
                  </times>
                  <apply id="S2.Ex1.m1.4.4.2.3.cmml" xref="S2.Ex1.m1.4.4.2.3">
                   <csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.2.3.1.cmml" xref="S2.Ex1.m1.4.4.2.3">
                    subscript
                   </csymbol>
                   <ci id="S2.Ex1.m1.4.4.2.3.2.cmml" xref="S2.Ex1.m1.4.4.2.3.2">
                    𝜋
                   </ci>
                   <ci id="S2.Ex1.m1.4.4.2.3.3a.cmml" xref="S2.Ex1.m1.4.4.2.3.3">
                    <mtext id="S2.Ex1.m1.4.4.2.3.3.cmml" mathsize="70%" xref="S2.Ex1.m1.4.4.2.3.3">
                     ref
                    </mtext>
                   </ci>
                  </apply>
                  <apply id="S2.Ex1.m1.4.4.2.1.1.1.cmml" xref="S2.Ex1.m1.4.4.2.1.1">
                   <csymbol cd="latexml" id="S2.Ex1.m1.4.4.2.1.1.1.1.cmml" xref="S2.Ex1.m1.4.4.2.1.1.1.1">
                    conditional
                   </csymbol>
                   <apply id="S2.Ex1.m1.4.4.2.1.1.1.2.cmml" xref="S2.Ex1.m1.4.4.2.1.1.1.2">
                    <csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.2.1.1.1.2.1.cmml" xref="S2.Ex1.m1.4.4.2.1.1.1.2">
                     subscript
                    </csymbol>
                    <ci id="S2.Ex1.m1.4.4.2.1.1.1.2.2.cmml" xref="S2.Ex1.m1.4.4.2.1.1.1.2.2">
                     𝑥
                    </ci>
                    <ci id="S2.Ex1.m1.4.4.2.1.1.1.2.3.cmml" xref="S2.Ex1.m1.4.4.2.1.1.1.2.3">
                     𝑎
                    </ci>
                   </apply>
                   <apply id="S2.Ex1.m1.4.4.2.1.1.1.3.cmml" xref="S2.Ex1.m1.4.4.2.1.1.1.3">
                    <csymbol cd="ambiguous" id="S2.Ex1.m1.4.4.2.1.1.1.3.1.cmml" xref="S2.Ex1.m1.4.4.2.1.1.1.3">
                     subscript
                    </csymbol>
                    <ci id="S2.Ex1.m1.4.4.2.1.1.1.3.2.cmml" xref="S2.Ex1.m1.4.4.2.1.1.1.3.2">
                     𝑠
                    </ci>
                    <ci id="S2.Ex1.m1.4.4.2.1.1.1.3.3.cmml" xref="S2.Ex1.m1.4.4.2.1.1.1.3.3">
                     𝑣
                    </ci>
                   </apply>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S2.Ex1.m1.6c">
           \displaystyle\mathcal{L}_{\text{imit}}(\cdot)\triangleq\log\sigma\mathopen{}\left(\beta\log\frac{\pi_{\theta}(x^{*}_{a}|s_{v})}{\pi_{\text{ref}}(x^{*}_{a}|s_{v})}-\beta\log\frac{\pi_{\theta}(x_{a}|s_{v})}{\pi_{\text{ref}}(x_{a}|s_{v})}\mathclose{}\right)
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S2.SS3.p1.14">
     where
     <math alttext="x^{*}_{a}" class="ltx_Math" display="inline" id="S2.SS3.p1.4.m1.1">
      <semantics id="S2.SS3.p1.4.m1.1a">
       <msubsup id="S2.SS3.p1.4.m1.1.1" xref="S2.SS3.p1.4.m1.1.1.cmml">
        <mi id="S2.SS3.p1.4.m1.1.1.2.2" xref="S2.SS3.p1.4.m1.1.1.2.2.cmml">
         x
        </mi>
        <mi id="S2.SS3.p1.4.m1.1.1.3" xref="S2.SS3.p1.4.m1.1.1.3.cmml">
         a
        </mi>
        <mo id="S2.SS3.p1.4.m1.1.1.2.3" xref="S2.SS3.p1.4.m1.1.1.2.3.cmml">
         ∗
        </mo>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.4.m1.1b">
        <apply id="S2.SS3.p1.4.m1.1.1.cmml" xref="S2.SS3.p1.4.m1.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.4.m1.1.1.1.cmml" xref="S2.SS3.p1.4.m1.1.1">
          subscript
         </csymbol>
         <apply id="S2.SS3.p1.4.m1.1.1.2.cmml" xref="S2.SS3.p1.4.m1.1.1">
          <csymbol cd="ambiguous" id="S2.SS3.p1.4.m1.1.1.2.1.cmml" xref="S2.SS3.p1.4.m1.1.1">
           superscript
          </csymbol>
          <ci id="S2.SS3.p1.4.m1.1.1.2.2.cmml" xref="S2.SS3.p1.4.m1.1.1.2.2">
           𝑥
          </ci>
          <times id="S2.SS3.p1.4.m1.1.1.2.3.cmml" xref="S2.SS3.p1.4.m1.1.1.2.3">
          </times>
         </apply>
         <ci id="S2.SS3.p1.4.m1.1.1.3.cmml" xref="S2.SS3.p1.4.m1.1.1.3">
          𝑎
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.4.m1.1c">
        x^{*}_{a}
       </annotation>
      </semantics>
     </math>
     is the action given by the LLM expert while
     <math alttext="x_{a}" class="ltx_Math" display="inline" id="S2.SS3.p1.5.m2.1">
      <semantics id="S2.SS3.p1.5.m2.1a">
       <msub id="S2.SS3.p1.5.m2.1.1" xref="S2.SS3.p1.5.m2.1.1.cmml">
        <mi id="S2.SS3.p1.5.m2.1.1.2" xref="S2.SS3.p1.5.m2.1.1.2.cmml">
         x
        </mi>
        <mi id="S2.SS3.p1.5.m2.1.1.3" xref="S2.SS3.p1.5.m2.1.1.3.cmml">
         a
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.5.m2.1b">
        <apply id="S2.SS3.p1.5.m2.1.1.cmml" xref="S2.SS3.p1.5.m2.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.5.m2.1.1.1.cmml" xref="S2.SS3.p1.5.m2.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.5.m2.1.1.2.cmml" xref="S2.SS3.p1.5.m2.1.1.2">
          𝑥
         </ci>
         <ci id="S2.SS3.p1.5.m2.1.1.3.cmml" xref="S2.SS3.p1.5.m2.1.1.3">
          𝑎
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.5.m2.1c">
        x_{a}
       </annotation>
      </semantics>
     </math>
     is the action given by
     <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS3.p1.6.m3.1">
      <semantics id="S2.SS3.p1.6.m3.1a">
       <msub id="S2.SS3.p1.6.m3.1.1" xref="S2.SS3.p1.6.m3.1.1.cmml">
        <mi id="S2.SS3.p1.6.m3.1.1.2" xref="S2.SS3.p1.6.m3.1.1.2.cmml">
         π
        </mi>
        <mi id="S2.SS3.p1.6.m3.1.1.3" xref="S2.SS3.p1.6.m3.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.6.m3.1b">
        <apply id="S2.SS3.p1.6.m3.1.1.cmml" xref="S2.SS3.p1.6.m3.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.6.m3.1.1.1.cmml" xref="S2.SS3.p1.6.m3.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.6.m3.1.1.2.cmml" xref="S2.SS3.p1.6.m3.1.1.2">
          𝜋
         </ci>
         <ci id="S2.SS3.p1.6.m3.1.1.3.cmml" xref="S2.SS3.p1.6.m3.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.6.m3.1c">
        \pi_{\theta}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.SS3.p1.7.m4.1">
      <semantics id="S2.SS3.p1.7.m4.1a">
       <mi id="S2.SS3.p1.7.m4.1.1" xref="S2.SS3.p1.7.m4.1.1.cmml">
        σ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.7.m4.1b">
        <ci id="S2.SS3.p1.7.m4.1.1.cmml" xref="S2.SS3.p1.7.m4.1.1">
         𝜎
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.7.m4.1c">
        \sigma
       </annotation>
      </semantics>
     </math>
     is the logistic function, and
     <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS3.p1.8.m5.1">
      <semantics id="S2.SS3.p1.8.m5.1a">
       <mi id="S2.SS3.p1.8.m5.1.1" xref="S2.SS3.p1.8.m5.1.1.cmml">
        β
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.8.m5.1b">
        <ci id="S2.SS3.p1.8.m5.1.1.cmml" xref="S2.SS3.p1.8.m5.1.1">
         𝛽
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.8.m5.1c">
        \beta
       </annotation>
      </semantics>
     </math>
     is a hyperparameter controlling the deviation from
     <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.SS3.p1.9.m6.1">
      <semantics id="S2.SS3.p1.9.m6.1a">
       <msub id="S2.SS3.p1.9.m6.1.1" xref="S2.SS3.p1.9.m6.1.1.cmml">
        <mi id="S2.SS3.p1.9.m6.1.1.2" xref="S2.SS3.p1.9.m6.1.1.2.cmml">
         π
        </mi>
        <mtext id="S2.SS3.p1.9.m6.1.1.3" xref="S2.SS3.p1.9.m6.1.1.3a.cmml">
         ref
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.9.m6.1b">
        <apply id="S2.SS3.p1.9.m6.1.1.cmml" xref="S2.SS3.p1.9.m6.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.9.m6.1.1.1.cmml" xref="S2.SS3.p1.9.m6.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.9.m6.1.1.2.cmml" xref="S2.SS3.p1.9.m6.1.1.2">
          𝜋
         </ci>
         <ci id="S2.SS3.p1.9.m6.1.1.3a.cmml" xref="S2.SS3.p1.9.m6.1.1.3">
          <mtext id="S2.SS3.p1.9.m6.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p1.9.m6.1.1.3">
           ref
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.9.m6.1c">
        \pi_{\text{ref}}
       </annotation>
      </semantics>
     </math>
     , i.e. the reference agent obtained by behavior cloning on a demonstration dataset produced by a rule-based expert in the visual world (see Appendix
     <a class="ltx_ref" href="#S9" title="9 Collection of Demonstration Dataset ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     for complete details). The added regularization is essential, as it prevents the agent from deviating too far from the distribution on which the expert is accurate, as well as maintaining the generation diversity and avoiding premature convergence to some easy tasks. In practice, the VLM agent
     <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS3.p1.10.m7.1">
      <semantics id="S2.SS3.p1.10.m7.1a">
       <msub id="S2.SS3.p1.10.m7.1.1" xref="S2.SS3.p1.10.m7.1.1.cmml">
        <mi id="S2.SS3.p1.10.m7.1.1.2" xref="S2.SS3.p1.10.m7.1.1.2.cmml">
         π
        </mi>
        <mi id="S2.SS3.p1.10.m7.1.1.3" xref="S2.SS3.p1.10.m7.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.10.m7.1b">
        <apply id="S2.SS3.p1.10.m7.1.1.cmml" xref="S2.SS3.p1.10.m7.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.10.m7.1.1.1.cmml" xref="S2.SS3.p1.10.m7.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.10.m7.1.1.2.cmml" xref="S2.SS3.p1.10.m7.1.1.2">
          𝜋
         </ci>
         <ci id="S2.SS3.p1.10.m7.1.1.3.cmml" xref="S2.SS3.p1.10.m7.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.10.m7.1c">
        \pi_{\theta}
       </annotation>
      </semantics>
     </math>
     is also initialized to
     <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.SS3.p1.11.m8.1">
      <semantics id="S2.SS3.p1.11.m8.1a">
       <msub id="S2.SS3.p1.11.m8.1.1" xref="S2.SS3.p1.11.m8.1.1.cmml">
        <mi id="S2.SS3.p1.11.m8.1.1.2" xref="S2.SS3.p1.11.m8.1.1.2.cmml">
         π
        </mi>
        <mtext id="S2.SS3.p1.11.m8.1.1.3" xref="S2.SS3.p1.11.m8.1.1.3a.cmml">
         ref
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.11.m8.1b">
        <apply id="S2.SS3.p1.11.m8.1.1.cmml" xref="S2.SS3.p1.11.m8.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.11.m8.1.1.1.cmml" xref="S2.SS3.p1.11.m8.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.11.m8.1.1.2.cmml" xref="S2.SS3.p1.11.m8.1.1.2">
          𝜋
         </ci>
         <ci id="S2.SS3.p1.11.m8.1.1.3a.cmml" xref="S2.SS3.p1.11.m8.1.1.3">
          <mtext id="S2.SS3.p1.11.m8.1.1.3.cmml" mathsize="70%" xref="S2.SS3.p1.11.m8.1.1.3">
           ref
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.11.m8.1c">
        \pi_{\text{ref}}
       </annotation>
      </semantics>
     </math>
     for stabilizing the training process. Since environmental dynamics is both unknown and complex, we cannot compute the distribution of states visited by
     <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS3.p1.12.m9.1">
      <semantics id="S2.SS3.p1.12.m9.1a">
       <msub id="S2.SS3.p1.12.m9.1.1" xref="S2.SS3.p1.12.m9.1.1.cmml">
        <mi id="S2.SS3.p1.12.m9.1.1.2" xref="S2.SS3.p1.12.m9.1.1.2.cmml">
         π
        </mi>
        <mi id="S2.SS3.p1.12.m9.1.1.3" xref="S2.SS3.p1.12.m9.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.12.m9.1b">
        <apply id="S2.SS3.p1.12.m9.1.1.cmml" xref="S2.SS3.p1.12.m9.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.12.m9.1.1.1.cmml" xref="S2.SS3.p1.12.m9.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.12.m9.1.1.2.cmml" xref="S2.SS3.p1.12.m9.1.1.2">
          𝜋
         </ci>
         <ci id="S2.SS3.p1.12.m9.1.1.3.cmml" xref="S2.SS3.p1.12.m9.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.12.m9.1c">
        \pi_{\theta}
       </annotation>
      </semantics>
     </math>
     and can only sample it by rolling out the agent. Hence, Eq. (
     <a class="ltx_ref" href="#S2.E2" title="Equation 2 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     ) is a non-i.i.d. supervised learning problem due to the dependence of the state distribution on
     <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS3.p1.13.m10.1">
      <semantics id="S2.SS3.p1.13.m10.1a">
       <msub id="S2.SS3.p1.13.m10.1.1" xref="S2.SS3.p1.13.m10.1.1.cmml">
        <mi id="S2.SS3.p1.13.m10.1.1.2" xref="S2.SS3.p1.13.m10.1.1.2.cmml">
         π
        </mi>
        <mi id="S2.SS3.p1.13.m10.1.1.3" xref="S2.SS3.p1.13.m10.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.13.m10.1b">
        <apply id="S2.SS3.p1.13.m10.1.1.cmml" xref="S2.SS3.p1.13.m10.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.13.m10.1.1.1.cmml" xref="S2.SS3.p1.13.m10.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.13.m10.1.1.2.cmml" xref="S2.SS3.p1.13.m10.1.1.2">
          𝜋
         </ci>
         <ci id="S2.SS3.p1.13.m10.1.1.3.cmml" xref="S2.SS3.p1.13.m10.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.13.m10.1c">
        \pi_{\theta}
       </annotation>
      </semantics>
     </math>
     itself, in which naïve behavior cloning faces issues like cumulative error and distribution shift
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib22" title="">
       <span class="ltx_text" style="font-size:90%;">
        22
       </span>
      </a>
      ]
     </cite>
     . To address this, we employ an interactive IL algorithm, DAgger
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib46" title="">
       <span class="ltx_text" style="font-size:90%;">
        46
       </span>
      </a>
      ]
     </cite>
     , which provably converges to the optimal agent
     <math alttext="\pi_{\theta^{*}}" class="ltx_Math" display="inline" id="S2.SS3.p1.14.m11.1">
      <semantics id="S2.SS3.p1.14.m11.1a">
       <msub id="S2.SS3.p1.14.m11.1.1" xref="S2.SS3.p1.14.m11.1.1.cmml">
        <mi id="S2.SS3.p1.14.m11.1.1.2" xref="S2.SS3.p1.14.m11.1.1.2.cmml">
         π
        </mi>
        <msup id="S2.SS3.p1.14.m11.1.1.3" xref="S2.SS3.p1.14.m11.1.1.3.cmml">
         <mi id="S2.SS3.p1.14.m11.1.1.3.2" xref="S2.SS3.p1.14.m11.1.1.3.2.cmml">
          θ
         </mi>
         <mo id="S2.SS3.p1.14.m11.1.1.3.3" xref="S2.SS3.p1.14.m11.1.1.3.3.cmml">
          ∗
         </mo>
        </msup>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p1.14.m11.1b">
        <apply id="S2.SS3.p1.14.m11.1.1.cmml" xref="S2.SS3.p1.14.m11.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p1.14.m11.1.1.1.cmml" xref="S2.SS3.p1.14.m11.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p1.14.m11.1.1.2.cmml" xref="S2.SS3.p1.14.m11.1.1.2">
          𝜋
         </ci>
         <apply id="S2.SS3.p1.14.m11.1.1.3.cmml" xref="S2.SS3.p1.14.m11.1.1.3">
          <csymbol cd="ambiguous" id="S2.SS3.p1.14.m11.1.1.3.1.cmml" xref="S2.SS3.p1.14.m11.1.1.3">
           superscript
          </csymbol>
          <ci id="S2.SS3.p1.14.m11.1.1.3.2.cmml" xref="S2.SS3.p1.14.m11.1.1.3.2">
           𝜃
          </ci>
          <times id="S2.SS3.p1.14.m11.1.1.3.3.cmml" xref="S2.SS3.p1.14.m11.1.1.3.3">
          </times>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p1.14.m11.1c">
        \pi_{\theta^{*}}
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
   <div class="ltx_para" id="S2.SS3.p2">
    <p class="ltx_p" id="S2.SS3.p2.6">
     As discussed in Sec.
     <a class="ltx_ref" href="#S2.SS2" title="2.2 LLM Expert from a Parallel TextWorld ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       2.2
      </span>
     </a>
     and Sec.
     <a class="ltx_ref" href="#S2.SS3" title="2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       2.3
      </span>
     </a>
     , we can harness an API LLM, e.g., GPT-4
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib38" title="">
       <span class="ltx_text" style="font-size:90%;">
        38
       </span>
      </a>
      ]
     </cite>
     , to generate a sequence of actions, serving as
     <math alttext="x^{*}_{a}" class="ltx_Math" display="inline" id="S2.SS3.p2.1.m1.1">
      <semantics id="S2.SS3.p2.1.m1.1a">
       <msubsup id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml">
        <mi id="S2.SS3.p2.1.m1.1.1.2.2" xref="S2.SS3.p2.1.m1.1.1.2.2.cmml">
         x
        </mi>
        <mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">
         a
        </mi>
        <mo id="S2.SS3.p2.1.m1.1.1.2.3" xref="S2.SS3.p2.1.m1.1.1.2.3.cmml">
         ∗
        </mo>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b">
        <apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1">
          subscript
         </csymbol>
         <apply id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1">
          <csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.2.1.cmml" xref="S2.SS3.p2.1.m1.1.1">
           superscript
          </csymbol>
          <ci id="S2.SS3.p2.1.m1.1.1.2.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2.2">
           𝑥
          </ci>
          <times id="S2.SS3.p2.1.m1.1.1.2.3.cmml" xref="S2.SS3.p2.1.m1.1.1.2.3">
          </times>
         </apply>
         <ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">
          𝑎
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">
        x^{*}_{a}
       </annotation>
      </semantics>
     </math>
     in Eq. (
     <a class="ltx_ref" href="#S2.E2" title="Equation 2 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     ). However, these actions may be suboptimal due to sparse environmental feedback
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib49" title="">
       <span class="ltx_text" style="font-size:90%;">
        49
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib62" title="">
       <span class="ltx_text" style="font-size:90%;">
        62
       </span>
      </a>
      ]
     </cite>
     or defective in-context instructions
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib6" title="">
       <span class="ltx_text" style="font-size:90%;">
        6
       </span>
      </a>
      ]
     </cite>
     . To collect better teaching signals, we introduce a “retrospective LLM expert” that is composed of two specialized models: an actor (
     <math alttext="M_{a}" class="ltx_Math" display="inline" id="S2.SS3.p2.2.m2.1">
      <semantics id="S2.SS3.p2.2.m2.1a">
       <msub id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">
        <mi id="S2.SS3.p2.2.m2.1.1.2" xref="S2.SS3.p2.2.m2.1.1.2.cmml">
         M
        </mi>
        <mi id="S2.SS3.p2.2.m2.1.1.3" xref="S2.SS3.p2.2.m2.1.1.3.cmml">
         a
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b">
        <apply id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p2.2.m2.1.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p2.2.m2.1.1.2.cmml" xref="S2.SS3.p2.2.m2.1.1.2">
          𝑀
         </ci>
         <ci id="S2.SS3.p2.2.m2.1.1.3.cmml" xref="S2.SS3.p2.2.m2.1.1.3">
          𝑎
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">
        M_{a}
       </annotation>
      </semantics>
     </math>
     ), built upon an API LLM and prompted to generate actions based on the task instruction and textual state observations; and a critic (
     <math alttext="M_{c}" class="ltx_Math" display="inline" id="S2.SS3.p2.3.m3.1">
      <semantics id="S2.SS3.p2.3.m3.1a">
       <msub id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml">
        <mi id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml">
         M
        </mi>
        <mi id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml">
         c
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b">
        <apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2">
          𝑀
         </ci>
         <ci id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3">
          𝑐
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">
        M_{c}
       </annotation>
      </semantics>
     </math>
     ), also based on the same LLM, but designed to analyze EMMA’s historical trajectories and provide reflective feedback. A long-term memory
     <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S2.SS3.p2.4.m4.1">
      <semantics id="S2.SS3.p2.4.m4.1a">
       <mi class="ltx_font_mathcaligraphic" id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml">
        𝒫
       </mi>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b">
        <ci id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1">
         𝒫
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">
        \mathcal{P}
       </annotation>
      </semantics>
     </math>
     is maintained to store the feedback generated by
     <math alttext="M_{c}" class="ltx_Math" display="inline" id="S2.SS3.p2.5.m5.1">
      <semantics id="S2.SS3.p2.5.m5.1a">
       <msub id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml">
        <mi id="S2.SS3.p2.5.m5.1.1.2" xref="S2.SS3.p2.5.m5.1.1.2.cmml">
         M
        </mi>
        <mi id="S2.SS3.p2.5.m5.1.1.3" xref="S2.SS3.p2.5.m5.1.1.3.cmml">
         c
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b">
        <apply id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p2.5.m5.1.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p2.5.m5.1.1.2.cmml" xref="S2.SS3.p2.5.m5.1.1.2">
          𝑀
         </ci>
         <ci id="S2.SS3.p2.5.m5.1.1.3.cmml" xref="S2.SS3.p2.5.m5.1.1.3">
          𝑐
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">
        M_{c}
       </annotation>
      </semantics>
     </math>
     , which is then used to prompt
     <math alttext="M_{a}" class="ltx_Math" display="inline" id="S2.SS3.p2.6.m6.1">
      <semantics id="S2.SS3.p2.6.m6.1a">
       <msub id="S2.SS3.p2.6.m6.1.1" xref="S2.SS3.p2.6.m6.1.1.cmml">
        <mi id="S2.SS3.p2.6.m6.1.1.2" xref="S2.SS3.p2.6.m6.1.1.2.cmml">
         M
        </mi>
        <mi id="S2.SS3.p2.6.m6.1.1.3" xref="S2.SS3.p2.6.m6.1.1.3.cmml">
         a
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S2.SS3.p2.6.m6.1b">
        <apply id="S2.SS3.p2.6.m6.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1">
         <csymbol cd="ambiguous" id="S2.SS3.p2.6.m6.1.1.1.cmml" xref="S2.SS3.p2.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S2.SS3.p2.6.m6.1.1.2.cmml" xref="S2.SS3.p2.6.m6.1.1.2">
          𝑀
         </ci>
         <ci id="S2.SS3.p2.6.m6.1.1.3.cmml" xref="S2.SS3.p2.6.m6.1.1.3">
          𝑎
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS3.p2.6.m6.1c">
        M_{a}
       </annotation>
      </semantics>
     </math>
     for improved actions. The complete procedure is detailed in Line 7-10 of Alg.
     <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , and all prompts are provided in Sec.
     <a class="ltx_ref" href="#S6" title="6 Full Prompts for LLM Expert ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     of the Appendix.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Experiments
  </h2>
  <figure class="ltx_figure" id="S3.F4">
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_1">
     <div class="ltx_block ltx_figure_panel" id="S3.F4.5">
      <span class="ltx_ERROR undefined" id="S3.F4.5.1">
       {floatrow}
      </span>
      <span class="ltx_ERROR undefined" id="S3.F4.5.2">
       \ffigbox
      </span>
     </div>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_2">
     <p class="ltx_p ltx_figure_panel" id="S3.F4.1">
      [0.33]
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="351" id="S3.F4.1.g1" src="/html/2311.16714/assets/x3.png" width="438"/>
     </p>
    </div>
   </div>
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S3.F4.7.1.1" style="font-size:90%;">
      Figure 3
     </span>
     :
    </span>
    <span class="ltx_text ltx_font_bold" id="S3.F4.8.2" style="font-size:90%;">
     Comparison of success rate between EMMA and the retrospective LLM expert.
     <span class="ltx_text ltx_font_medium" id="S3.F4.8.2.1">
      As the number of trials increases, the LLM expert progressively improves its performance through retrospective processes, and also the gap between the two agents decreases, indicating the effectiveness of cross-modality imitation. We separately plot the curve per task type in Fig.
      <a class="ltx_ref" href="#S8.F9" title="Figure 9 ‣ 8 Training Details ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
       <span class="ltx_text ltx_ref_tag">
        9
       </span>
      </a>
      of Appendix.
     </span>
    </span>
   </figcaption>
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_2">
     <span class="ltx_ERROR ltx_figure_panel undefined" id="S3.F4.9">
      \capbtabbox
     </span>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <p class="ltx_p ltx_figure_panel" id="S3.F4.10">
      [0.63]
      <span class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S3.F4.10.1" style="width:433.6pt;height:10790.3pt;vertical-align:-10790.3pt;">
       <span class="ltx_transformed_inner" style="transform:translate(87.0pt,0.0pt) scale(1.67073104698394,1.67073104698394) ;">
        <span class="ltx_tabular ltx_align_middle" id="S3.F4.10.1.1">
         <span class="ltx_tbody">
          <span class="ltx_tr" id="S3.F4.10.1.1.1.1">
           <span class="ltx_td ltx_align_left ltx_border_tt ltx_rowspan ltx_rowspan_2 ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.1.1.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.1.1.1.1">
             Agent
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_tt" id="S3.F4.10.1.1.1.1.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.1.1.2.1">
             Visual
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center ltx_border_tt" id="S3.F4.10.1.1.1.1.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.1.1.3.1">
             Textual
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_tt ltx_colspan ltx_colspan_14" id="S3.F4.10.1.1.1.1.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.1.1.4.1">
             Success Rate with Template Task Instruction
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.2.2">
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.2.2.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.2.2.1.1">
             Env.
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.2.2.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.2.2.2.1">
             Env.
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.2.2.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            Avg.
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.2.2.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            Pick
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.2.2.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            Clean
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.2.2.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            Heat
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.2.2.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            Cool
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.2.2.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            Look
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.2.2.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            Pick2
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.3.3">
           <span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_2" id="S3.F4.10.1.1.3.3.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.3.3.1.1">
             <span class="ltx_inline-block ltx_transformed_outer" id="S3.F4.10.1.1.3.3.1.1.1" style="width:24.0pt;height:9.200000000000001pt;vertical-align:7.4pt;">
              <span class="ltx_transformed_inner" style="width:9.2pt;transform:translate(7.4pt,0pt) rotate(-90deg) ;">
               <span class="ltx_inline-block" id="S3.F4.10.1.1.3.3.1.1.1.1">
                <span class="ltx_p" id="S3.F4.10.1.1.3.3.1.1.1.1.1">
                 VMs
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="ltx_td ltx_align_left ltx_border_t" id="S3.F4.10.1.1.3.3.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            ResNet-18*
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib51" title="">
              <span class="ltx_text" style="font-size:90%;">
               51
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t" id="S3.F4.10.1.1.3.3.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.3.3.3.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S3.F4.10.1.1.3.3.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.3.3.4.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.3.3.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.06
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.3.3.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.3.3.6.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.3.3.7" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.3.3.7.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.3.3.8" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.3.3.8.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.3.3.9" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.3.3.9.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.3.3.10" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.3.3.10.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.3.3.11" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.3.3.11.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.3.3.12" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.3.3.12.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.4.4">
           <span class="ltx_td ltx_align_left" id="S3.F4.10.1.1.4.4.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            MCNN-FPN*
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib51" title="">
              <span class="ltx_text" style="font-size:90%;">
               51
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.4.4.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.4.4.2.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.4.4.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.4.4.3.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.4.4.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.05
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.4.4.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.4.4.5.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.4.4.6" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.4.4.6.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.4.4.7" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.4.4.7.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.4.4.8" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.4.4.8.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.4.4.9" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.4.4.9.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.4.4.10" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.4.4.10.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.4.4.11" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.4.4.11.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.5.5">
           <span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_6" id="S3.F4.10.1.1.5.5.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.5.5.1.1">
             <span class="ltx_inline-block ltx_transformed_outer" id="S3.F4.10.1.1.5.5.1.1.1" style="width:24.0pt;height:9.200000000000001pt;vertical-align:7.4pt;">
              <span class="ltx_transformed_inner" style="width:9.2pt;transform:translate(7.4pt,0pt) rotate(-90deg) ;">
               <span class="ltx_inline-block" id="S3.F4.10.1.1.5.5.1.1.1.1">
                <span class="ltx_p" id="S3.F4.10.1.1.5.5.1.1.1.1.1">
                 LMs
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="ltx_td ltx_align_left ltx_border_t" id="S3.F4.10.1.1.5.5.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            BUTLER*
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib51" title="">
              <span class="ltx_text" style="font-size:90%;">
               51
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t" id="S3.F4.10.1.1.5.5.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.5.5.3.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S3.F4.10.1.1.5.5.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.5.5.4.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.5.5.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.26
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.5.5.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.5.5.6.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.5.5.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.31
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.5.5.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.5.5.8.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.5.5.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.41
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.5.5.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.5.5.10.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.5.5.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.60
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.5.5.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.5.5.12.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.5.5.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.27
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.5.5.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.5.5.14.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.5.5.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.12
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.5.5.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.5.5.16.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.5.5.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.29
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.5.5.18" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.5.5.18.1" style="color:#525252;">
             (-)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.6.6">
           <span class="ltx_td ltx_align_left" id="S3.F4.10.1.1.6.6.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            GPT-BUTLER
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib36" title="">
              <span class="ltx_text" style="font-size:90%;">
               36
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.6.6.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.6.6.2.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.6.6.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.6.6.3.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.6.6.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.69
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.6.6.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.6.6.5.1" style="color:#525252;">
             (18.8)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.6.6.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.62
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.6.6.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.6.6.7.1" style="color:#525252;">
             (18.4)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.6.6.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.81
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.6.6.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.6.6.9.1" style="color:#525252;">
             (18.4)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.6.6.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.6.6.10.1">
             0.85
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.6.6.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.6.6.11.1" style="color:#525252;">
             (12.7)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.6.6.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.78
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.6.6.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.6.6.13.1" style="color:#525252;">
             (15.6)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.6.6.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.50
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.6.6.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.6.6.15.1" style="color:#525252;">
             (24.4)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.6.6.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.47
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.6.6.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.6.6.17.1" style="color:#525252;">
             (26.6)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.7.7">
           <span class="ltx_td ltx_align_left" id="S3.F4.10.1.1.7.7.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            ReAct
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib65" title="">
              <span class="ltx_text" style="font-size:90%;">
               65
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.7.7.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.7.7.2.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.7.7.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.7.7.3.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.7.7.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.54
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.7.7.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.7.7.5.1" style="color:#525252;">
             (20.6)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.7.7.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.71
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.7.7.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.7.7.7.1" style="color:#525252;">
             (18.1)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.7.7.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.65
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.7.7.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.7.7.9.1" style="color:#525252;">
             (18.8)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.7.7.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.62
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.7.7.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.7.7.11.1" style="color:#525252;">
             (18.2)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.7.7.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.44
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.7.7.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.7.7.13.1" style="color:#525252;">
             (23.2)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.7.7.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.28
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.7.7.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.7.7.15.1" style="color:#525252;">
             (23.7)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.7.7.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.35
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.7.7.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.7.7.17.1" style="color:#525252;">
             (25.5)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.8.8">
           <span class="ltx_td ltx_align_left" id="S3.F4.10.1.1.8.8.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            Reflexion
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib49" title="">
              <span class="ltx_text" style="font-size:90%;">
               49
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.8.8.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.8.8.2.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.8.8.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.8.8.3.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.8.8.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.8.8.4.1">
             0.91
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.8.8.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.8.8.5.1" style="color:#525252;">
             (18.7)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.8.8.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.8.8.6.1">
             0.96
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.8.8.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.8.8.7.1" style="color:#525252;">
             (17.4)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.8.8.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.8.8.8.1">
             1.00
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.8.8.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.8.8.9.1" style="color:#525252;">
             (17.0)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.8.8.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.81
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.8.8.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.8.8.11.1" style="color:#525252;">
             (19.4)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.8.8.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.83
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.8.8.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.8.8.13.1" style="color:#525252;">
             (21.6)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.8.8.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.94
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.8.8.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.8.8.15.1" style="color:#525252;">
             (16.9)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.8.8.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.8.8.16.1">
             0.88
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.8.8.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.8.8.17.1" style="color:#525252;">
             (21.6)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.9.9">
           <span class="ltx_td ltx_align_left" id="S3.F4.10.1.1.9.9.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            DEPS*
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib55" title="">
              <span class="ltx_text" style="font-size:90%;">
               55
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.9.9.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.9.9.2.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.9.9.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.9.9.3.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.9.9.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.76
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.9.9.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.9.9.5.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.9.9.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.93
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.9.9.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.9.9.7.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.9.9.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.50
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.9.9.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.9.9.9.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.9.9.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.80
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.9.9.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.9.9.11.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.9.9.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.9.9.12.1">
             1.00
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.9.9.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.9.9.13.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.9.9.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.9.9.14.1">
             1.00
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.9.9.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.9.9.15.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.9.9.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.00
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.9.9.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.9.9.17.1" style="color:#525252;">
             (-)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.10.10">
           <span class="ltx_td ltx_align_left" id="S3.F4.10.1.1.10.10.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            AutoGen*
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib58" title="">
              <span class="ltx_text" style="font-size:90%;">
               58
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.10.10.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.10.10.2.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.10.10.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.10.10.3.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.10.10.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.77
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.10.10.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.10.10.5.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.10.10.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.92
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.10.10.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.10.10.7.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.10.10.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.74
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.10.10.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.10.10.9.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.10.10.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.78
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.10.10.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.10.10.11.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.10.10.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.86
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.10.10.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.10.10.13.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.10.10.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.83
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.10.10.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.10.10.15.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.10.10.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.41
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.10.10.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.10.10.17.1" style="color:#525252;">
             (-)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.11.11">
           <span class="ltx_td ltx_align_center ltx_border_t ltx_rowspan ltx_rowspan_5" id="S3.F4.10.1.1.11.11.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.11.11.1.1">
             <span class="ltx_inline-block ltx_transformed_outer" id="S3.F4.10.1.1.11.11.1.1.1" style="width:33.8pt;height:9.199999999999999pt;vertical-align:12.3pt;">
              <span class="ltx_transformed_inner" style="width:9.2pt;transform:translate(12.32pt,0pt) rotate(-90deg) ;">
               <span class="ltx_inline-block" id="S3.F4.10.1.1.11.11.1.1.1.1">
                <span class="ltx_p" id="S3.F4.10.1.1.11.11.1.1.1.1.1">
                 VLMs
                </span>
               </span>
              </span>
             </span>
            </span>
           </span>
           <span class="ltx_td ltx_align_left ltx_border_t" id="S3.F4.10.1.1.11.11.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            MiniGPT-4
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib67" title="">
              <span class="ltx_text" style="font-size:90%;">
               67
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_t" id="S3.F4.10.1.1.11.11.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.11.11.3.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S3.F4.10.1.1.11.11.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.11.11.4.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.11.11.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.16
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.11.11.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.11.11.6.1" style="color:#525252;">
             (26.9)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.11.11.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.04
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.11.11.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.11.11.8.1" style="color:#525252;">
             (29.0)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.11.11.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.00
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.11.11.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.11.11.10.1" style="color:#525252;">
             (30.0)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.11.11.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.19
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.11.11.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.11.11.12.1" style="color:#525252;">
             (26.3)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.11.11.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.17
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.11.11.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.11.11.14.1" style="color:#525252;">
             (26.7)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.11.11.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.67
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.11.11.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.11.11.16.1" style="color:#525252;">
             (17.7)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F4.10.1.1.11.11.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.06
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F4.10.1.1.11.11.18" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.11.11.18.1" style="color:#525252;">
             (28.9)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.12.12">
           <span class="ltx_td ltx_align_left" id="S3.F4.10.1.1.12.12.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            BLIP-2
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib30" title="">
              <span class="ltx_text" style="font-size:90%;">
               30
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.12.12.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.12.12.2.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.12.12.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.12.12.3.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.12.12.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.04
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.12.12.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.12.12.5.1" style="color:#525252;">
             (29.5)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.12.12.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.00
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.12.12.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.12.12.7.1" style="color:#525252;">
             (30.0)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.12.12.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.06
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.12.12.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.12.12.9.1" style="color:#525252;">
             (29.3)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.12.12.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.04
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.12.12.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.12.12.11.1" style="color:#525252;">
             (29.9)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.12.12.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.11
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.12.12.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.12.12.13.1" style="color:#525252;">
             (28.2)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.12.12.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.06
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.12.12.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.12.12.15.1" style="color:#525252;">
             (29.2)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.12.12.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.00
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.12.12.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.12.12.17.1" style="color:#525252;">
             (30.0)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.13.13">
           <span class="ltx_td ltx_align_left" id="S3.F4.10.1.1.13.13.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            LLaMA-Adapter
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib14" title="">
              <span class="ltx_text" style="font-size:90%;">
               14
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.13.13.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.13.13.2.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.13.13.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.13.13.3.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.13.13.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.13
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.13.13.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.13.13.5.1" style="color:#525252;">
             (27.5)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.13.13.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.17
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.13.13.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.13.13.7.1" style="color:#525252;">
             (26.4)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.13.13.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.10
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.13.13.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.13.13.9.1" style="color:#525252;">
             (28.6)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.13.13.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.27
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.13.13.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.13.13.11.1" style="color:#525252;">
             (24.2)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.13.13.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.22
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.13.13.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.13.13.13.1" style="color:#525252;">
             (26.7)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.13.13.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.00
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.13.13.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.13.13.15.1" style="color:#525252;">
             (30.0)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.13.13.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.00
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.13.13.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.13.13.17.1" style="color:#525252;">
             (30.0)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.14.14">
           <span class="ltx_td ltx_align_left" id="S3.F4.10.1.1.14.14.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            InstructBLIP
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib8" title="">
              <span class="ltx_text" style="font-size:90%;">
               8
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.14.14.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.14.14.2.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.14.14.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.14.14.3.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.14.14.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.22
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.14.14.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.14.14.5.1" style="color:#525252;">
             (26.2)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.14.14.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.50
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.14.14.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.14.14.7.1" style="color:#525252;">
             (21.5)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.14.14.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.26
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.14.14.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.14.14.9.1" style="color:#525252;">
             (25.0)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.14.14.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.23
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.14.14.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.14.14.11.1" style="color:#525252;">
             (27.2)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.14.14.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.06
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.14.14.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.14.14.13.1" style="color:#525252;">
             (28.9)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.14.14.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.17
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.14.14.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.14.14.15.1" style="color:#525252;">
             (26.8)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.14.14.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.00
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.14.14.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.14.14.17.1" style="color:#525252;">
             (30.0)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.15.15">
           <span class="ltx_td ltx_align_left" id="S3.F4.10.1.1.15.15.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.15.15.1.1">
             EMMA
            </span>
            (Ours)
           </span>
           <span class="ltx_td ltx_align_center" id="S3.F4.10.1.1.15.15.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.15.15.2.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F4.10.1.1.15.15.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.15.15.3.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.15.15.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            0.82
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.15.15.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.15.15.5.1" style="color:#525252;">
             (19.5)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.15.15.6" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.15.15.6.1">
             0.71
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.15.15.7" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.15.15.7.1" style="color:#525252;">
             (19.3)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.15.15.8" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.15.15.8.1">
             0.94
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.15.15.9" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.15.15.9.1" style="color:#525252;">
             (17.5)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.15.15.10" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.15.15.10.1">
             0.85
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.15.15.11" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.15.15.11.1" style="color:#525252;">
             (19.6)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.15.15.12" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.15.15.12.1">
             0.83
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.15.15.13" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.15.15.13.1" style="color:#525252;">
             (19.9)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.15.15.14" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.15.15.14.1">
             0.88
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.15.15.15" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.15.15.15.1" style="color:#525252;">
             (19.6)
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F4.10.1.1.15.15.16" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.15.15.16.1">
             0.67
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F4.10.1.1.15.15.17" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.15.15.17.1" style="color:#525252;">
             (22.4)
            </span>
           </span>
          </span>
          <span class="ltx_tr" id="S3.F4.10.1.1.16.16">
           <span class="ltx_td ltx_align_left ltx_border_bb ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.16.16.1" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.16.16.1.1">
             Human Performance*
            </span>
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib50" title="">
              <span class="ltx_text" style="font-size:90%;">
               50
              </span>
             </a>
             ]
            </cite>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.F4.10.1.1.16.16.2" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.16.16.2.1" style="color:#0000FF;">
             ✓
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb ltx_border_t" id="S3.F4.10.1.1.16.16.3" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.16.16.3.1" style="color:#FF0000;">
             ✗
            </span>
           </span>
           <span class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb ltx_border_t" id="S3.F4.10.1.1.16.16.4" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F4.10.1.1.16.16.4.1">
             0.91
            </span>
           </span>
           <span class="ltx_td ltx_nopad_l ltx_align_left ltx_border_bb ltx_border_t" id="S3.F4.10.1.1.16.16.5" style="padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.16.16.5.1" style="color:#525252;">
             (-)
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.16.16.6" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.16.16.6.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.16.16.7" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.16.16.7.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.16.16.8" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.16.16.8.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.16.16.9" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.16.16.9.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.16.16.10" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.16.16.10.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
           <span class="ltx_td ltx_align_center ltx_border_bb ltx_border_t ltx_colspan ltx_colspan_2" id="S3.F4.10.1.1.16.16.11" style="background-color:#E6E6E6;padding-top:0.5pt;padding-bottom:0.5pt;">
            <span class="ltx_text" id="S3.F4.10.1.1.16.16.11.1" style="background-color:#E6E6E6;">
             -
            </span>
           </span>
          </span>
         </span>
        </span>
       </span>
      </span>
     </p>
    </div>
   </div>
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S3.F4.11.2.1" style="font-size:90%;">
      Figure 4
     </span>
     :
    </span>
    <span class="ltx_text ltx_font_bold" id="S3.F4.3.1" style="font-size:90%;">
     Comparison with the state of the arts.
     <span class="ltx_text ltx_font_medium" id="S3.F4.3.1.1">
      <math alttext="*" class="ltx_Math" display="inline" id="S3.F4.3.1.1.m1.1">
       <semantics id="S3.F4.3.1.1.m1.1a">
        <mo id="S3.F4.3.1.1.m1.1.1" xref="S3.F4.3.1.1.m1.1.1.cmml">
         ∗
        </mo>
        <annotation-xml encoding="MathML-Content" id="S3.F4.3.1.1.m1.1b">
         <times id="S3.F4.3.1.1.m1.1.1.cmml" xref="S3.F4.3.1.1.m1.1.1">
         </times>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="S3.F4.3.1.1.m1.1c">
         *
        </annotation>
       </semantics>
      </math>
      -reported in previous work. VMs = vision models, LMs = language models, VLMs = vision-language models. “Visual Env.” and “Textual Env.” refer to the visual and the parallel textual environments from ALFWorld
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib51" title="">
        <span class="ltx_text" style="font-size:90%;">
         51
        </span>
       </a>
       ]
      </cite>
      , respectively.
      <span class="ltx_text" id="S3.F4.3.1.1.1" style="color:#0000FF;">
       ✓/
       <span class="ltx_text" id="S3.F4.3.1.1.1.1" style="color:#FF0000;">
        ✗
       </span>
      </span>
      denotes the corresponding environment used/not used to deploy the agent. The highest scores for each task in the same type of environment are highlighted in
     </span>
     bold
     <span class="ltx_text ltx_font_medium" id="S3.F4.3.1.2">
      . The average interaction steps is given in the
      <span class="ltx_text" id="S3.F4.3.1.2.1" style="color:#525252;">
       (parentheses)
      </span>
      .
     </span>
     EMMA substantially outperforms other SOTA VLM agents in the visual environments, and its success also directs a promising way to achieve human-level performance in ALFWorld.
    </span>
   </figcaption>
  </figure>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    Experimental Setup
   </h3>
   <div class="ltx_para" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS1.p1.1.1">
      Environments.
     </span>
     We base our experiments on the ALFWorld benchmark
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib51" title="">
       <span class="ltx_text" style="font-size:90%;">
        51
       </span>
      </a>
      ]
     </cite>
     , a cross-modality simulation platform that encompasses a wide range of embodied household tasks. For each task, ALFWorld integrates a visual environment, rendered by the Ai2Thor simulator
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib26" title="">
       <span class="ltx_text" style="font-size:90%;">
        26
       </span>
      </a>
      ]
     </cite>
     , with a corresponding textual environment. This textual aspect employs the Planning Domain Definition Language (PDDL)
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib1" title="">
       <span class="ltx_text" style="font-size:90%;">
        1
       </span>
      </a>
      ]
     </cite>
     to translate each pixel observation from the simulator into an equivalent text-based observation, and then constructs an interactive environment using the TextWorld engine
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib7" title="">
       <span class="ltx_text" style="font-size:90%;">
        7
       </span>
      </a>
      ]
     </cite>
     . Fig.
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     provides an illustrative example of the tasks featured in ALFWorld.
The tasks within the ALFWorld benchmark are categorized into 6 types: Pick &amp; Place, Clean &amp; Place, Heat &amp; Place, Cool &amp; Place, Look in Light, and Pick Two Objects &amp; Place. Each task requires an agent to execute a series of text-based actions, such as “go to safe 1”, “open safe 1”, or “heat egg 1 with microwave 1”, following a predefined instruction. These actions involve navigating and interacting with the environment. To provide a comprehensive understanding, we have visualized an example of each task type in Fig.
     <a class="ltx_ref" href="#Sx1.F8" title="Figure 8 ‣ Appendix ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       8
      </span>
     </a>
     of the Appendix.
A task in this benchmark may involve interactions with over 10 objects and require more than 30 steps for a human expert to solve, thus challenging an agent’s capabilities in long-horizon planning, instruction following, and the utilization of commonsense knowledge.
For a fair comparison, we follow the same setting as prior work
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib50" title="">
       <span class="ltx_text" style="font-size:90%;">
        50
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib51" title="">
       <span class="ltx_text" style="font-size:90%;">
        51
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib36" title="">
       <span class="ltx_text" style="font-size:90%;">
        36
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib65" title="">
       <span class="ltx_text" style="font-size:90%;">
        65
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib49" title="">
       <span class="ltx_text" style="font-size:90%;">
        49
       </span>
      </a>
      ]
     </cite>
     and evaluate all baselines using 134 out-of-distribution (OOD) tasks.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">
      Baselines.
     </span>
     To verify the effectiveness of cross-modality imitation learning, we compare our EMMA with several baselines and state-of-the-art (SOTA) agents using the ALFWorld benchmark with both visual and textual environments.
The compared agents can be divided into three categories: vision models, language models, and vision-language models.
Concretely, vision models, including ResNet-18
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib16" title="">
       <span class="ltx_text" style="font-size:90%;">
        16
       </span>
      </a>
      ]
     </cite>
     and MCNN-FPN
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib17" title="">
       <span class="ltx_text" style="font-size:90%;">
        17
       </span>
      </a>
      ]
     </cite>
     , utilize pretrained vision encoders to extract salient features from each pixel observation. The extracted features then serve as input for a Multi-Layer Perceptron (MLP) policy, which is trained by behavior cloning on a pre-collected demonstration dataset.
Unlike vision models performing in the visual environment, language models complete exactly the same tasks but in a parallel, text-based environment. BUTLER
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib51" title="">
       <span class="ltx_text" style="font-size:90%;">
        51
       </span>
      </a>
      ]
     </cite>
     employs a transformer seq2seq model enhanced with a pointer softmax mechanism
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib15" title="">
       <span class="ltx_text" style="font-size:90%;">
        15
       </span>
      </a>
      ]
     </cite>
     . This architecture aggregates previous observations as input to generate text-based actions token-by-token. GPT-BUTLER
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib36" title="">
       <span class="ltx_text" style="font-size:90%;">
        36
       </span>
      </a>
      ]
     </cite>
     , a variant of the GPT-2 model
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib41" title="">
       <span class="ltx_text" style="font-size:90%;">
        41
       </span>
      </a>
      ]
     </cite>
     , is initially pretrained on a static demonstration dataset and further finetuned using data collected online. ReAct
     <cite class="ltx_cite ltx_citemacro_cite">
      [
      <a class="ltx_ref" href="#bib.bib65" title="">
       <span class="ltx_text" style="font-size:90%;">
        65
       </span>
      </a>
      ]
     </cite>
     takes a novel approach by utilizing LLMs to generate reasoning traces and task-specific actions in an interleaved manner. This method aids the agent in developing, tracking, and updating its action plans interactively. Reflexion
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib49" title="">
       <span class="ltx_text" style="font-size:90%;">
        49
       </span>
      </a>
      ]
     </cite>
     similarly employs an LLM, but it focuses on reflecting upon environmental feedback. It maintains this reflective text in an episodic memory buffer, enhancing the agent’s ability to improve actions in subsequent trials. Similar to Reflexion, a concurrent work, DEPS
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib55" title="">
       <span class="ltx_text" style="font-size:90%;">
        55
       </span>
      </a>
      ]
     </cite>
     , also corrects errors in previous LLM-generated actions by integrating descriptions of the action execution process and providing self-explanations for the feedback. Moreover, beyond the single-agent framework, AutoGen
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib58" title="">
       <span class="ltx_text" style="font-size:90%;">
        58
       </span>
      </a>
      ]
     </cite>
     exhibits the potential of accomplishing a broad spectrum of tasks through the cooperation of multiple LLM agents.
Finally, we consider a range of vision-language models, such as MiniGPT-4
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib67" title="">
       <span class="ltx_text" style="font-size:90%;">
        67
       </span>
      </a>
      ]
     </cite>
     , BLIP-2
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib30" title="">
       <span class="ltx_text" style="font-size:90%;">
        30
       </span>
      </a>
      ]
     </cite>
     , LLaMA-Adaptor
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib14" title="">
       <span class="ltx_text" style="font-size:90%;">
        14
       </span>
      </a>
      ]
     </cite>
     , and InstructBLIP
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib8" title="">
       <span class="ltx_text" style="font-size:90%;">
        8
       </span>
      </a>
      ]
     </cite>
     , as agents to interact with the visual environment. Unlike pure vision or language models, VLMs are designed to process and integrate both visual and textual data, offering a more holistic understanding of the environment. To align these agents with the specific requirements of the ALFWorld benchmark, they are finetuned on a pre-collected demonstration dataset. This finetuning process is crucial as it enables the agents to comprehend and adhere to ALFWorld’s unique grammar and to develop a basic “gamesense”.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    Training Details
   </h3>
   <div class="ltx_para" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.1">
     The architectural design of EMMA is depicted in Fig.
     <a class="ltx_ref" href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     . At its core, EMMA employs a Query Transformer (Q-Former) to process visual data. This Q-Former extracts features using a frozen ViT encoder. Its output consists of 32 visual tokens, which are then passed through a linear projection layer before fed to a frozen LLM decoder. Similar to other VLM agents, EMMA is also finetuned on a pre-collected demonstration dataset, aligning its basic ability with the ALFWorld benchmark.
In order to align EMMA with the dynamics of ALFWorld, we train it by imitating an LLM expert (see Alg.
     <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     ). We choose
     <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.1.1">
      text-davinci-003
     </span>
     developed by OpenAI as our LLM expert because of its established capabilities in reasoning and planning
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib49" title="">
       <span class="ltx_text" style="font-size:90%;">
        49
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib65" title="">
       <span class="ltx_text" style="font-size:90%;">
        65
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib58" title="">
       <span class="ltx_text" style="font-size:90%;">
        58
       </span>
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib55" title="">
       <span class="ltx_text" style="font-size:90%;">
        55
       </span>
      </a>
      ]
     </cite>
     . In this setup,
     <span class="ltx_text ltx_font_italic" id="S3.SS2.p1.1.2">
      text-davinci-003
     </span>
     serves dual roles: it serves as an actor, providing EMMA with expert actions, and as a critic, analyzing EMMA’s historical trajectories. This analysis generates retrospective feedback, which is then incorporated into the actor’s long-term memory, leading to improved actions in future trials. Further details about the hyperparameters and prompts used in our training procedure are available in Table
     <a class="ltx_ref" href="#S8.T1" title="Table 1 ‣ 8 Training Details ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     of the Appendix.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.3
    </span>
    Comparison with State of the Art
   </h3>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p1">
    <p class="ltx_p" id="S3.SS3.p1.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p1.1.1">
      EMMA sets new SOTA performance in visual ALFWorld.
     </span>
     In this section, we compare EMMA with 12 other representative agents on the ALFWorld benchmark, spanning both visual and textual environments (refer to Table
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     ). We assess two key metrics: the success rate, which is the percentage of trials completed successfully, and the average number of interaction steps required for task completion, with a lower number indicating higher efficiency. EMMA demonstrates superior performance in both metrics, significantly outperforming all VLM agents in visual environments. This achievement underscores the effectiveness of our cross-modality imitation learning approach, as depicted in the learning curve shown in Fig.
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     .
Furthermore, EMMA’s performance markedly exceeds that of VM agents, highlighting the crucial role of the prior knowledge embedded in VLMs.
Intriguingly, EMMA’s performance is comparable with LLM agents that operate using perfectly semantic descriptions of visual observations. This is largely attributed to EMMA’s training strategy of imitating an expert LLM agent, proving to be more efficient than learning from scratch in a purely visual setting. As a result, EMMA stands out as the only VLM agent that substantially surpasses SOTA LLM agents, such as AutoGen
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib58" title="">
       <span class="ltx_text" style="font-size:90%;">
        58
       </span>
      </a>
      ]
     </cite>
     and DEPS
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib55" title="">
       <span class="ltx_text" style="font-size:90%;">
        55
       </span>
      </a>
      ]
     </cite>
     , in these environments. And its success also directs a potential way to achieve human-level performance in the visual environments of ALFWorld.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS3.p2">
    <p class="ltx_p" id="S3.SS3.p2.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS3.p2.1.1">
      EMMA is more robust to noisy observations than LLM agents.
     </span>
     While LLM agents exhibit a higher success rate with fewer interaction steps in textual environments, as indicated in Table
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , we hypothesize that this superior performance largely relies on their precise semantic abstraction of the environment. However, such an abstraction might not be feasible in real-world applications. To verify this assumption, we set up a more practical scenario where observations are deliberately perturbed at a specific noise rate. We then compare the robustness of EMMA and a SOTA LLM agent, Reflexion, under these noisy observations.
To generate noisy observations, a random portion of the visual observation is cropped, resized, and then used to replace the original observation. Similarly, in the textual observation, random tokens are substituted with arbitrary ones.
As illustrated in Fig.
     <a class="ltx_ref" href="#S3.F5" title="Figure 5 ‣ 3.3 Comparison with State of the Art ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     , with the noise rate increases, EMMA’s performance remains significantly more robust compared to Reflexion. This could be attributed to the vision encoder in the VLM, which is adept at filtering out visual noises. On the other hand, textual noises are directly processed by the LLM, which can substantially impair the performance of LLM-based agents. This finding highlights the potential advantages of VLM agents like EMMA in practical scenarios, in which data is often imperfect and noisy.
    </p>
   </div>
   <figure class="ltx_figure" id="S3.F5">
    <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="295" id="S3.F5.g1" src="/html/2311.16714/assets/x4.png" width="368"/>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S3.F5.3.1.1" style="font-size:90%;">
       Figure 5
      </span>
      :
     </span>
     <span class="ltx_text ltx_font_bold" id="S3.F5.4.2" style="font-size:90%;">
      Comparison of robustness between VLM and LLM agents.
      <span class="ltx_text ltx_font_medium" id="S3.F5.4.2.1">
       Given a specific noise rate, we crop a random portion of the pixel observation and resize it to a given size as the new observation. Similarly, we randomly replace some tokens in the textual observation with arbitrary ones.
      </span>
     </span>
    </figcaption>
   </figure>
  </section>
  <section class="ltx_subsection" id="S3.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.4
    </span>
    Ablation Study
   </h3>
   <figure class="ltx_figure" id="S3.F6">
    <div class="ltx_flex_figure">
     <div class="ltx_flex_cell ltx_flex_size_3">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="128" id="S3.F6.g1" src="/html/2311.16714/assets/x5.png" width="169"/>
     </div>
     <div class="ltx_flex_cell ltx_flex_size_3">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="128" id="S3.F6.g2" src="/html/2311.16714/assets/x6.png" width="169"/>
     </div>
     <div class="ltx_flex_cell ltx_flex_size_3">
      <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="128" id="S3.F6.g3" src="/html/2311.16714/assets/x7.png" width="169"/>
     </div>
    </div>
    <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_figure">
      Figure 6:
     </span>
     <span class="ltx_text ltx_font_bold" id="S3.F6.18.1">
      Ablation study.
     </span>
     <span class="ltx_text ltx_font_italic" id="S3.F6.19.2">
      left
     </span>
     :
     <span class="ltx_text ltx_font_bold" id="S3.F6.20.3">
      The ability of LLM expert to reflect on and learn from past actions appears to be a key factor in achieving the impressive results we observed.
     </span>
     <span class="ltx_text ltx_font_italic" id="S3.F6.21.4">
      middle
     </span>
     : The “w/o BC initialization” variant uses a pretrained VLM instead of the reference agent
     <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S3.F6.2.m1.1">
      <semantics id="S3.F6.2.m1.1b">
       <msub id="S3.F6.2.m1.1.1" xref="S3.F6.2.m1.1.1.cmml">
        <mi id="S3.F6.2.m1.1.1.2" xref="S3.F6.2.m1.1.1.2.cmml">
         π
        </mi>
        <mtext id="S3.F6.2.m1.1.1.3" xref="S3.F6.2.m1.1.1.3a.cmml">
         ref
        </mtext>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.F6.2.m1.1c">
        <apply id="S3.F6.2.m1.1.1.cmml" xref="S3.F6.2.m1.1.1">
         <csymbol cd="ambiguous" id="S3.F6.2.m1.1.1.1.cmml" xref="S3.F6.2.m1.1.1">
          subscript
         </csymbol>
         <ci id="S3.F6.2.m1.1.1.2.cmml" xref="S3.F6.2.m1.1.1.2">
          𝜋
         </ci>
         <ci id="S3.F6.2.m1.1.1.3a.cmml" xref="S3.F6.2.m1.1.1.3">
          <mtext id="S3.F6.2.m1.1.1.3.cmml" mathsize="70%" xref="S3.F6.2.m1.1.1.3">
           ref
          </mtext>
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.F6.2.m1.1d">
        \pi_{\text{ref}}
       </annotation>
      </semantics>
     </math>
     to initialize EMMA.
     <span class="ltx_text ltx_font_italic" id="S3.F6.22.5">
      right
     </span>
     : The ’w/ CE Loss’ variant replaces the DPO loss (described in Eq.
     <a class="ltx_ref" href="#S2.E2" title="Equation 2 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     ) with a token-level cross-entropy (CE) loss. Please refer to Sec.
     <a class="ltx_ref" href="#S3.SS4" title="3.4 Ablation Study ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       3.4
      </span>
     </a>
     for a thorough discussion.
    </figcaption>
   </figure>
   <div class="ltx_para" id="S3.SS4.p1">
    <p class="ltx_p" id="S3.SS4.p1.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS4.p1.1.1">
      Retrospection improves EMMA over time.
     </span>
     To assess the importance of the retrospective LLM expert, we present the average success rate of EMMA after each trial, as shown in Fig.
     <a class="ltx_ref" href="#S3.F6" title="Figure 6 ‣ 3.4 Ablation Study ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     (left), and evaluate a key variation: EMMA w/o Retrospection. This variant of EMMA is trained using the same procedure as the original EMMA but removes the retrospective process. Instead, it relies solely on a plain LLM actor to provide relabeled actions.
The results show that EMMA with the retrospective mechanism significantly outperforms its counterpart. This finding is crucial as it indicates that the retrospective process is not just a supplementary feature but a fundamental component of EMMA’s architecture that contributes substantially to its enhanced performance.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p2">
    <p class="ltx_p" id="S3.SS4.p2.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS4.p2.1.1">
      EMMA benefits from BC initialization.
     </span>
     We evaluate the impact of behavior cloning (BC) initialization, a process described in line 3 of Alg.
     <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     , through an ablation study.
Fig.
     <a class="ltx_ref" href="#S3.F6" title="Figure 6 ‣ 3.4 Ablation Study ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     (middle) demonstrates that EMMA, when deprived of BC initialization, experiences a slight reduction in the average success rate across 134 unseen tasks compared to its original setup. Despite this decrease, EMMA without BC initialization still outperforms other VLM agents, as clearly shown when compared with the results in Table
     <a class="ltx_ref" href="#S3.F4" title="Figure 4 ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     .
Furthermore, Fig.
     <a class="ltx_ref" href="#S8.F10" title="Figure 10 ‣ 8 Training Details ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       10
      </span>
     </a>
     in the Appendix breaks down the result by task type. It reveals a consistent but slight drop in performance across 5 out of the 6 task types. These results reflect that while BC initialization contributes positively to EMMA’s overall performance, it is not critical for achieving the notable results we have reported.
    </p>
   </div>
   <div class="ltx_para ltx_noindent" id="S3.SS4.p3">
    <p class="ltx_p" id="S3.SS4.p3.1">
     <span class="ltx_text ltx_font_bold" id="S3.SS4.p3.1.1">
      DPO enables more effective imitation learning.
     </span>
     To evaluate the effectiveness of using DPO loss in Eq. (
     <a class="ltx_ref" href="#S2.E1" title="Equation 1 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     ), we conducted an ablation study with an alternative version of EMMA, referred to EMMA w/ Cross Entropy (CE) Loss. In this variant, EMMA is optimized using the token-level CE loss, a common objective for finetuning VLMs.
The results, as depicted in Fig.
     <a class="ltx_ref" href="#S3.F6" title="Figure 6 ‣ 3.4 Ablation Study ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     (right), reveal that EMMA w/ CE Loss does not achieve the same high success rate as the original EMMA with DPO loss, suggesting that DPO loss contributes to enhancing the upper performance bound of EMMA.
In addition, we noted that EMMA w/ CE Loss exhibits faster convergence in the initial stages of training compared to the original EMMA. This premature convergence leads to the agent paying attention to the expert actions from easier tasks, usually addressed in the first few training epochs, which can suppress EMMA’s exploration and learning on more complex tasks.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS5">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.5
    </span>
    Generalization to Free-form Task Instructions
   </h3>
   <figure class="ltx_figure" id="S3.F7">
    <div class="ltx_flex_figure">
     <div class="ltx_flex_cell ltx_flex_size_1">
      <div class="ltx_inline-block ltx_figure_panel ltx_minipage ltx_align_middle ltx_transformed_outer" id="S3.F7.3" style="width:347.8pt;height:137.3pt;vertical-align:-0.7pt;">
       <span class="ltx_transformed_inner" style="transform:translate(-111.7pt,30.7pt) scale(0.689882995214375,0.689882995214375) ;">
        <table class="ltx_tabular ltx_align_middle" id="S3.F7.3.1">
         <tbody class="ltx_tbody">
          <tr class="ltx_tr" id="S3.F7.3.1.1.1">
           <td class="ltx_td ltx_align_left ltx_border_tt" colspan="2" id="S3.F7.3.1.1.1.1" rowspan="2" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.1.1.1.1">
             Agent
            </span>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_tt" id="S3.F7.3.1.1.1.2" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.1.1.2.1">
             Visual
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_tt" id="S3.F7.3.1.1.1.3" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.1.1.3.1">
             Textual
            </span>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_tt" colspan="14" id="S3.F7.3.1.1.1.4" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.1.1.4.1">
             Success Rate with Free-form Task Instruction
            </span>
           </td>
          </tr>
          <tr class="ltx_tr" id="S3.F7.3.1.2.2">
           <td class="ltx_td ltx_align_center" id="S3.F7.3.1.2.2.1" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.2.2.1.1">
             Env.
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F7.3.1.2.2.2" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.2.2.2.1">
             Env.
            </span>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.F7.3.1.2.2.3" style="padding:0.5pt 5.5pt;">
            Avg.
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.F7.3.1.2.2.4" style="padding:0.5pt 5.5pt;">
            Pick
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.F7.3.1.2.2.5" style="padding:0.5pt 5.5pt;">
            Clean
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.F7.3.1.2.2.6" style="padding:0.5pt 5.5pt;">
            Heat
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.F7.3.1.2.2.7" style="padding:0.5pt 5.5pt;">
            Cool
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.F7.3.1.2.2.8" style="padding:0.5pt 5.5pt;">
            Look
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S3.F7.3.1.2.2.9" style="padding:0.5pt 5.5pt;">
            Pick2
           </td>
          </tr>
          <tr class="ltx_tr" id="S3.F7.3.1.3.3">
           <td class="ltx_td ltx_align_center ltx_border_t" id="S3.F7.3.1.3.3.1" rowspan="4" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.3.3.1.1">
             <span class="ltx_inline-block ltx_transformed_outer" id="S3.F7.3.1.3.3.1.1.1" style="width:6.8pt;height:19.4pt;vertical-align:-6.3pt;">
              <span class="ltx_transformed_inner" style="width:19.4pt;transform:translate(-6.26pt,0pt) rotate(-90deg) ;">
               <span class="ltx_inline-block" id="S3.F7.3.1.3.3.1.1.1.1">
                <span class="ltx_p" id="S3.F7.3.1.3.3.1.1.1.1.1">
                 LMs
                </span>
               </span>
              </span>
             </span>
            </span>
           </td>
           <td class="ltx_td ltx_align_left ltx_border_t" id="S3.F7.3.1.3.3.2" style="padding:0.5pt 5.5pt;">
            BUTLER*
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib51" title="">
              <span class="ltx_text" style="font-size:90%;">
               51
              </span>
             </a>
             ]
            </cite>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S3.F7.3.1.3.3.3" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.3.3.3.1" style="color:#FF0000;">
             ✗
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S3.F7.3.1.3.3.4" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.3.3.4.1" style="color:#0000FF;">
             ✓
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.3.3.5" style="padding:0.5pt 5.5pt;">
            0.03
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.3.3.6" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.3.3.6.1" style="color:#525252;">
             (-)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.3.3.7" style="padding:0.5pt 5.5pt;">
            0.10
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.3.3.8" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.3.3.8.1" style="color:#525252;">
             (-)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.3.3.9" style="padding:0.5pt 5.5pt;">
            0.22
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.3.3.10" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.3.3.10.1" style="color:#525252;">
             (-)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.3.3.11" style="padding:0.5pt 5.5pt;">
            0.05
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.3.3.12" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.3.3.12.1" style="color:#525252;">
             (-)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.3.3.13" style="padding:0.5pt 5.5pt;">
            0.17
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.3.3.14" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.3.3.14.1" style="color:#525252;">
             (-)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.3.3.15" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.3.3.16" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.3.3.16.1" style="color:#525252;">
             (-)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.3.3.17" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.3.3.18" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.3.3.18.1" style="color:#525252;">
             (-)
            </span>
           </td>
          </tr>
          <tr class="ltx_tr" id="S3.F7.3.1.4.4">
           <td class="ltx_td ltx_align_left" id="S3.F7.3.1.4.4.1" style="padding:0.5pt 5.5pt;">
            GPT-BUTLER
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib36" title="">
              <span class="ltx_text" style="font-size:90%;">
               36
              </span>
             </a>
             ]
            </cite>
           </td>
           <td class="ltx_td ltx_align_center" id="S3.F7.3.1.4.4.2" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.4.4.2.1" style="color:#FF0000;">
             ✗
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F7.3.1.4.4.3" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.4.4.3.1" style="color:#0000FF;">
             ✓
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.4.4.4" style="padding:0.5pt 5.5pt;">
            0.31
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.4.4.5" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.4.4.5.1" style="color:#525252;">
             (24.7)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.4.4.6" style="padding:0.5pt 5.5pt;">
            0.25
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.4.4.7" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.4.4.7.1" style="color:#525252;">
             (25.4)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.4.4.8" style="padding:0.5pt 5.5pt;">
            0.42
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.4.4.9" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.4.4.9.1" style="color:#525252;">
             (23.5)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.4.4.10" style="padding:0.5pt 5.5pt;">
            0.46
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.4.4.11" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.4.4.11.1" style="color:#525252;">
             (20.9)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.4.4.12" style="padding:0.5pt 5.5pt;">
            0.44
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.4.4.13" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.4.4.13.1" style="color:#525252;">
             (21.8)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.4.4.14" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.4.4.15" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.4.4.15.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.4.4.16" style="padding:0.5pt 5.5pt;">
            0.12
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.4.4.17" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.4.4.17.1" style="color:#525252;">
             (28.9)
            </span>
           </td>
          </tr>
          <tr class="ltx_tr" id="S3.F7.3.1.5.5">
           <td class="ltx_td ltx_align_left" id="S3.F7.3.1.5.5.1" style="padding:0.5pt 5.5pt;">
            ReAct
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib65" title="">
              <span class="ltx_text" style="font-size:90%;">
               65
              </span>
             </a>
             ]
            </cite>
           </td>
           <td class="ltx_td ltx_align_center" id="S3.F7.3.1.5.5.2" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.5.5.2.1" style="color:#FF0000;">
             ✗
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F7.3.1.5.5.3" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.5.5.3.1" style="color:#0000FF;">
             ✓
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.5.5.4" style="padding:0.5pt 5.5pt;">
            0.37
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.5.5.5" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.5.5.5.1" style="color:#525252;">
             (23.6)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.5.5.6" style="padding:0.5pt 5.5pt;">
            0.46
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.5.5.7" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.5.5.7.1" style="color:#525252;">
             (22.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.5.5.8" style="padding:0.5pt 5.5pt;">
            0.39
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.5.5.9" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.5.5.9.1" style="color:#525252;">
             (23.8)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.5.5.10" style="padding:0.5pt 5.5pt;">
            0.50
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.5.5.11" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.5.5.11.1" style="color:#525252;">
             (20.5)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.5.5.12" style="padding:0.5pt 5.5pt;">
            0.28
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.5.5.13" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.5.5.13.1" style="color:#525252;">
             (24.6)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.5.5.14" style="padding:0.5pt 5.5pt;">
            0.22
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.5.5.15" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.5.5.15.1" style="color:#525252;">
             (26.4)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.5.5.16" style="padding:0.5pt 5.5pt;">
            0.29
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.5.5.17" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.5.5.17.1" style="color:#525252;">
             (25.9)
            </span>
           </td>
          </tr>
          <tr class="ltx_tr" id="S3.F7.3.1.6.6">
           <td class="ltx_td ltx_align_left" id="S3.F7.3.1.6.6.1" style="padding:0.5pt 5.5pt;">
            Reflexion
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib49" title="">
              <span class="ltx_text" style="font-size:90%;">
               49
              </span>
             </a>
             ]
            </cite>
           </td>
           <td class="ltx_td ltx_align_center" id="S3.F7.3.1.6.6.2" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.6.6.2.1" style="color:#FF0000;">
             ✗
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F7.3.1.6.6.3" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.6.6.3.1" style="color:#0000FF;">
             ✓
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.6.6.4" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.6.6.4.1">
             0.78
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.6.6.5" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.6.6.5.1" style="color:#525252;">
             (17.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.6.6.6" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.6.6.6.1">
             0.84
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.6.6.7" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.6.6.7.1" style="color:#525252;">
             (15.8)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.6.6.8" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.6.6.8.1">
             0.74
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.6.6.9" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.6.6.9.1" style="color:#525252;">
             (18.4)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.6.6.10" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.6.6.10.1">
             0.77
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.6.6.11" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.6.6.11.1" style="color:#525252;">
             (17.2)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.6.6.12" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.6.6.12.1">
             0.61
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.6.6.13" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.6.6.13.1" style="color:#525252;">
             (19.4)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.6.6.14" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.6.6.14.1">
             0.94
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.6.6.15" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.6.6.15.1" style="color:#525252;">
             (13.8)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.6.6.16" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.6.6.16.1">
             0.82
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.6.6.17" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.6.6.17.1" style="color:#525252;">
             (16.7)
            </span>
           </td>
          </tr>
          <tr class="ltx_tr" id="S3.F7.3.1.7.7">
           <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.F7.3.1.7.7.1" rowspan="5" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.7.7.1.1">
             <span class="ltx_inline-block ltx_transformed_outer" id="S3.F7.3.1.7.7.1.1.1" style="width:6.8pt;height:26.8pt;vertical-align:-10.0pt;">
              <span class="ltx_transformed_inner" style="width:26.9pt;transform:translate(-10.01pt,0pt) rotate(-90deg) ;">
               <span class="ltx_inline-block" id="S3.F7.3.1.7.7.1.1.1.1">
                <span class="ltx_p" id="S3.F7.3.1.7.7.1.1.1.1.1">
                 VLMs
                </span>
               </span>
              </span>
             </span>
            </span>
           </td>
           <td class="ltx_td ltx_align_left ltx_border_t" id="S3.F7.3.1.7.7.2" style="padding:0.5pt 5.5pt;">
            MiniGPT-4
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib67" title="">
              <span class="ltx_text" style="font-size:90%;">
               67
              </span>
             </a>
             ]
            </cite>
           </td>
           <td class="ltx_td ltx_align_center ltx_border_t" id="S3.F7.3.1.7.7.3" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.7.7.3.1" style="color:#0000FF;">
             ✓
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" id="S3.F7.3.1.7.7.4" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.7.7.4.1" style="color:#FF0000;">
             ✗
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.7.7.5" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.7.7.6" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.7.7.6.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.7.7.7" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.7.7.8" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.7.7.8.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.7.7.9" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.7.7.10" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.7.7.10.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.7.7.11" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.7.7.12" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.7.7.12.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.7.7.13" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.7.7.14" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.7.7.14.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.7.7.15" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.7.7.16" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.7.7.16.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_t" id="S3.F7.3.1.7.7.17" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_t" id="S3.F7.3.1.7.7.18" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.7.7.18.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
          </tr>
          <tr class="ltx_tr" id="S3.F7.3.1.8.8">
           <td class="ltx_td ltx_align_left" id="S3.F7.3.1.8.8.1" style="padding:0.5pt 5.5pt;">
            BLIP-2
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib30" title="">
              <span class="ltx_text" style="font-size:90%;">
               30
              </span>
             </a>
             ]
            </cite>
           </td>
           <td class="ltx_td ltx_align_center" id="S3.F7.3.1.8.8.2" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.8.8.2.1" style="color:#0000FF;">
             ✓
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F7.3.1.8.8.3" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.8.8.3.1" style="color:#FF0000;">
             ✗
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.8.8.4" style="padding:0.5pt 5.5pt;">
            0.01
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.8.8.5" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.8.8.5.1" style="color:#525252;">
             (29.7)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.8.8.6" style="padding:0.5pt 5.5pt;">
            0.04
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.8.8.7" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.8.8.7.1" style="color:#525252;">
             (29.1)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.8.8.8" style="padding:0.5pt 5.5pt;">
            0.03
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.8.8.9" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.8.8.9.1" style="color:#525252;">
             (29.5)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.8.8.10" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.8.8.11" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.8.8.11.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.8.8.12" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.8.8.13" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.8.8.13.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.8.8.14" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.8.8.15" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.8.8.15.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.8.8.16" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.8.8.17" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.8.8.17.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
          </tr>
          <tr class="ltx_tr" id="S3.F7.3.1.9.9">
           <td class="ltx_td ltx_align_left" id="S3.F7.3.1.9.9.1" style="padding:0.5pt 5.5pt;">
            LLaMA-Adapter
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib14" title="">
              <span class="ltx_text" style="font-size:90%;">
               14
              </span>
             </a>
             ]
            </cite>
           </td>
           <td class="ltx_td ltx_align_center" id="S3.F7.3.1.9.9.2" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.9.9.2.1" style="color:#0000FF;">
             ✓
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F7.3.1.9.9.3" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.9.9.3.1" style="color:#FF0000;">
             ✗
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.9.9.4" style="padding:0.5pt 5.5pt;">
            0.02
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.9.9.5" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.9.9.5.1" style="color:#525252;">
             (29.6)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.9.9.6" style="padding:0.5pt 5.5pt;">
            0.04
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.9.9.7" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.9.9.7.1" style="color:#525252;">
             (29.3)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.9.9.8" style="padding:0.5pt 5.5pt;">
            0.03
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.9.9.9" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.9.9.9.1" style="color:#525252;">
             (29.4)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.9.9.10" style="padding:0.5pt 5.5pt;">
            0.04
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.9.9.11" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.9.9.11.1" style="color:#525252;">
             (29.3)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.9.9.12" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.9.9.13" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.9.9.13.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.9.9.14" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.9.9.15" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.9.9.15.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.9.9.16" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.9.9.17" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.9.9.17.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
          </tr>
          <tr class="ltx_tr" id="S3.F7.3.1.10.10">
           <td class="ltx_td ltx_align_left" id="S3.F7.3.1.10.10.1" style="padding:0.5pt 5.5pt;">
            InstructBLIP
            <cite class="ltx_cite ltx_citemacro_citep">
             [
             <a class="ltx_ref" href="#bib.bib8" title="">
              <span class="ltx_text" style="font-size:90%;">
               8
              </span>
             </a>
             ]
            </cite>
           </td>
           <td class="ltx_td ltx_align_center" id="S3.F7.3.1.10.10.2" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.10.10.2.1" style="color:#0000FF;">
             ✓
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center" id="S3.F7.3.1.10.10.3" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.10.10.3.1" style="color:#FF0000;">
             ✗
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.10.10.4" style="padding:0.5pt 5.5pt;">
            0.01
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.10.10.5" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.10.10.5.1" style="color:#525252;">
             (29.8)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.10.10.6" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.10.10.7" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.10.10.7.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.10.10.8" style="padding:0.5pt 5.5pt;">
            0.03
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.10.10.9" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.10.10.9.1" style="color:#525252;">
             (29.3)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.10.10.10" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.10.10.11" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.10.10.11.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.10.10.12" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.10.10.13" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.10.10.13.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.10.10.14" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.10.10.15" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.10.10.15.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right" id="S3.F7.3.1.10.10.16" style="padding:0.5pt 5.5pt;">
            0.00
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left" id="S3.F7.3.1.10.10.17" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.10.10.17.1" style="color:#525252;">
             (30.0)
            </span>
           </td>
          </tr>
          <tr class="ltx_tr" id="S3.F7.3.1.11.11">
           <td class="ltx_td ltx_align_left ltx_border_bb" id="S3.F7.3.1.11.11.1" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.11.11.1.1">
             EMMA
            </span>
            (Ours)
           </td>
           <td class="ltx_td ltx_align_center ltx_border_bb" id="S3.F7.3.1.11.11.2" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.11.11.2.1" style="color:#0000FF;">
             ✓
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_center ltx_border_bb" id="S3.F7.3.1.11.11.3" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.11.11.3.1" style="color:#FF0000;">
             ✗
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S3.F7.3.1.11.11.4" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.11.11.4.1">
             0.68
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_bb" id="S3.F7.3.1.11.11.5" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.11.11.5.1" style="color:#525252;">
             (22.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S3.F7.3.1.11.11.6" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.11.11.6.1">
             0.72
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_bb" id="S3.F7.3.1.11.11.7" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.11.11.7.1" style="color:#525252;">
             (21.7)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S3.F7.3.1.11.11.8" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.11.11.8.1">
             0.65
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_bb" id="S3.F7.3.1.11.11.9" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.11.11.9.1" style="color:#525252;">
             (22.7)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S3.F7.3.1.11.11.10" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.11.11.10.1">
             0.72
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_bb" id="S3.F7.3.1.11.11.11" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.11.11.11.1" style="color:#525252;">
             (22.0)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S3.F7.3.1.11.11.12" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.11.11.12.1">
             0.56
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_bb" id="S3.F7.3.1.11.11.13" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.11.11.13.1" style="color:#525252;">
             (23.9)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S3.F7.3.1.11.11.14" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.11.11.14.1">
             0.67
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_bb" id="S3.F7.3.1.11.11.15" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.11.11.15.1" style="color:#525252;">
             (23.3)
            </span>
           </td>
           <td class="ltx_td ltx_nopad_r ltx_align_right ltx_border_bb" id="S3.F7.3.1.11.11.16" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text ltx_font_bold" id="S3.F7.3.1.11.11.16.1">
             0.76
            </span>
           </td>
           <td class="ltx_td ltx_nopad_l ltx_align_left ltx_border_bb" id="S3.F7.3.1.11.11.17" style="padding:0.5pt 5.5pt;">
            <span class="ltx_text" id="S3.F7.3.1.11.11.17.1" style="color:#525252;">
             (18.1)
            </span>
           </td>
          </tr>
         </tbody>
        </table>
       </span>
      </div>
     </div>
     <div class="ltx_flex_break">
     </div>
     <div class="ltx_flex_cell ltx_flex_size_1">
      <div class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" id="S3.F7.1" style="width:139.1pt;">
       <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="388" id="S3.F7.1.g1" src="/html/2311.16714/assets/x8.png" width="528"/>
      </div>
     </div>
    </div>
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_figure">
      <span class="ltx_text" id="S3.F7.5.1.1" style="font-size:90%;">
       Figure 7
      </span>
      :
     </span>
     <span class="ltx_text ltx_font_bold" id="S3.F7.6.2" style="font-size:90%;">
      Generalization to open-vocabulary, free-form task instructions.
      <span class="ltx_text ltx_font_medium" id="S3.F7.6.2.1">
       <span class="ltx_text ltx_font_italic" id="S3.F7.6.2.1.1">
        Left
       </span>
       : These instructions are provided by different human annotators using Amazon Mechanical Turk
       <cite class="ltx_cite ltx_citemacro_citep">
        [
        <a class="ltx_ref" href="#bib.bib50" title="">
         <span class="ltx_text" style="font-size:90%;">
          50
         </span>
        </a>
        ]
       </cite>
       .
       <span class="ltx_text ltx_font_italic" id="S3.F7.6.2.1.2">
        Right
       </span>
       : Frequency distribution of verbs for human-annotated and templated task instructions.
      </span>
     </span>
    </figcaption>
   </figure>
   <div class="ltx_para" id="S3.SS5.p1">
    <p class="ltx_p" id="S3.SS5.p1.1">
     The ability of AI agents to accurately follow task instructions given in open-vocabulary and free-form text is crucial for their real-world applicability. To assess this, we conducted an additional experiment focusing on the generalization capabilities of EMMA, an agent trained with templated task instructions.
In this experiment, we re-evaluated the performance of EMMA and other baseline agents on 134 unseen tasks, using human-annotated instructions instead of the templated ones. These human-annotated instructions include a large amount of OOD verbs and objects, presenting a more realistic and challenging scenario for the agents. To underscore this challenge, we compared the vocabulary distribution between the templated and human-annotated instructions, as shown in Fig.
     <a class="ltx_ref" href="#S3.F7" title="Figure 7 ‣ 3.5 Generalization to Free-form Task Instructions ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     (right). Moreover, we provide a comprehensive analysis of the vocabulary used across both instruction types in Fig.
     <a class="ltx_ref" href="#S8.F11" title="Figure 11 ‣ 8 Training Details ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       11
      </span>
     </a>
     of the Appendix.
In Fig.
     <a class="ltx_ref" href="#S3.F7" title="Figure 7 ‣ 3.5 Generalization to Free-form Task Instructions ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     (left), EMMA demonstrates a slight performance decline, while a significant degradation is observed in other baselines. We also note that Reflexion, a SOTA LLM agent, exhibits exceptional generalization to those OOD instructions.
     <span class="ltx_text ltx_font_bold" id="S3.SS5.p1.1.1">
      According to these empirical results in Fig.
      <a class="ltx_ref" href="#S3.F7" title="Figure 7 ‣ 3.5 Generalization to Free-form Task Instructions ‣ 3 Experiments ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
       <span class="ltx_text ltx_ref_tag">
        7
       </span>
      </a>
      , we have the following conclusions:
     </span>
     (1) EMMA obtains and benefits from the generalization capabilities inherent in the SOTA LLM agent through cross-modality imitation learning; (2) Our work sheds novel insights on using LLM feedback to train more versatile and generalizable embodied agents.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Related Work
  </h2>
  <div class="ltx_para" id="S4.p1">
   <p class="ltx_p" id="S4.p1.1">
    <span class="ltx_text ltx_font_bold" id="S4.p1.1.1">
     Agents based on Foundation Models.
    </span>
    Recent research has increasingly focused on harnessing the capabilities of large pre-trained foundation models to build AI agents
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib59" title="">
      <span class="ltx_text" style="font-size:90%;">
       59
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib63" title="">
      <span class="ltx_text" style="font-size:90%;">
       63
      </span>
     </a>
     ]
    </cite>
    . These models (e.g., LLMs), benefiting from their commonsense knowledge inherited from Internet-scale pretraining, are able to reason actions according to descriptions of the external environments. For example, given a set of task instructions, LLMs can be elaborately prompted to perform as agents generating high-level step-by-step plans
    <cite class="ltx_cite ltx_citemacro_cite">
     [
     <a class="ltx_ref" href="#bib.bib20" title="">
      <span class="ltx_text" style="font-size:90%;">
       20
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib4" title="">
      <span class="ltx_text" style="font-size:90%;">
       4
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib49" title="">
      <span class="ltx_text" style="font-size:90%;">
       49
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib65" title="">
      <span class="ltx_text" style="font-size:90%;">
       65
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib58" title="">
      <span class="ltx_text" style="font-size:90%;">
       58
      </span>
     </a>
     ]
    </cite>
    , and each step can be parsed into a sequence of robotic actions that are executed via pretrained policies or available APIs
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib3" title="">
      <span class="ltx_text" style="font-size:90%;">
       3
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib31" title="">
      <span class="ltx_text" style="font-size:90%;">
       31
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib54" title="">
      <span class="ltx_text" style="font-size:90%;">
       54
      </span>
     </a>
     ]
    </cite>
    . Furthermore, by using VLMs
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib28" title="">
      <span class="ltx_text" style="font-size:90%;">
       28
      </span>
     </a>
     ]
    </cite>
    , plans can also be conditioned on visual inputs that are transformed into language descriptions
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib21" title="">
      <span class="ltx_text" style="font-size:90%;">
       21
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib52" title="">
      <span class="ltx_text" style="font-size:90%;">
       52
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib4" title="">
      <span class="ltx_text" style="font-size:90%;">
       4
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib13" title="">
      <span class="ltx_text" style="font-size:90%;">
       13
      </span>
     </a>
     ]
    </cite>
    or token embeddings aligned with LLMs
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib11" title="">
      <span class="ltx_text" style="font-size:90%;">
       11
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib37" title="">
      <span class="ltx_text" style="font-size:90%;">
       37
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib68" title="">
      <span class="ltx_text" style="font-size:90%;">
       68
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib62" title="">
      <span class="ltx_text" style="font-size:90%;">
       62
      </span>
     </a>
     ]
    </cite>
    .
However, existing foundation models are usually pretrained on static text or text-image datasets and thus may struggle to align with the dynamics of the world.
To bridge this gap, we study how to finetune a VLM to be an embodied agent that is dynamically aligned with the world by distilling the cross-modality knowledge from an LLM expert. The work most closely related to ours is EUREKA
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib35" title="">
      <span class="ltx_text" style="font-size:90%;">
       35
      </span>
     </a>
     ]
    </cite>
    , which also explores using source information provided by the simulator as the context of an LLM to aid agent training. Instead of directly mimicking the output of the LLM as we did, EUREKA harnesses the coding LLM to generate a desired reward function for a given task and optimizes a policy against the reward function using RL, leading to a more complex and unstable training procedure
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib47" title="">
      <span class="ltx_text" style="font-size:90%;">
       47
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib48" title="">
      <span class="ltx_text" style="font-size:90%;">
       48
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib43" title="">
      <span class="ltx_text" style="font-size:90%;">
       43
      </span>
     </a>
     ]
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para ltx_noindent" id="S4.p2">
   <p class="ltx_p" id="S4.p2.1">
    <span class="ltx_text ltx_font_bold" id="S4.p2.1.1">
     Imitation Learning.
    </span>
    Imitation learning is the study of algorithms that improve performance by mimicking an expert’s decisions and behaviors. We summarize three main categories of existing methods in the following: (1) behavior cloning (BC), (2) inverse reinforcement learning (IRL), and (3) the combination of imitation and reinforcement learning.
The naïve BC
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib2" title="">
      <span class="ltx_text" style="font-size:90%;">
       2
      </span>
     </a>
     ]
    </cite>
    ignores the change in distribution and simply trains a policy that only performs well under the distribution of states visited by the expert. Following works, such as dataset aggregation
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib46" title="">
      <span class="ltx_text" style="font-size:90%;">
       46
      </span>
     </a>
     ]
    </cite>
    or policy aggregation
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib24" title="">
      <span class="ltx_text" style="font-size:90%;">
       24
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib44" title="">
      <span class="ltx_text" style="font-size:90%;">
       44
      </span>
     </a>
     ]
    </cite>
    , have been proposed to address the limitations of BC. Another line of work, IRL, is a more complicated algorithm framework that learns the reward function from expert demonstrations and then improves the policy using RL with the learned reward. A representative method in this category is generative adversarial imitation learning (GAIL)
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib19" title="">
      <span class="ltx_text" style="font-size:90%;">
       19
      </span>
     </a>
     ]
    </cite>
    , in which a policy and a discriminator compete with each other in order to maximize the likelihood of the policy’s behavior matching the expert.
The third category of methods usually leverages an IL policy to initialize RL and continues to boost its performance via online collected data from RL
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib5" title="">
      <span class="ltx_text" style="font-size:90%;">
       5
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib45" title="">
      <span class="ltx_text" style="font-size:90%;">
       45
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib53" title="">
      <span class="ltx_text" style="font-size:90%;">
       53
      </span>
     </a>
     ]
    </cite>
    . This simple combination significantly improves RL’s sample efficiency and IL’s upper performance bound constrained by the expert.
Nevertheless, all of the above methods assume that the expert and the imitator understand the world in the same modality, and thus overlook the fact that the complementary knowledge from other modalities often boosts the model’s accuracy and generalization dramatically
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib42" title="">
      <span class="ltx_text" style="font-size:90%;">
       42
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib61" title="">
      <span class="ltx_text" style="font-size:90%;">
       61
      </span>
     </a>
     ]
    </cite>
    .
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Conclusion
  </h2>
  <div class="ltx_para" id="S5.p1">
   <p class="ltx_p" id="S5.p1.1">
    We create
    <span class="ltx_text ltx_font_bold" id="S5.p1.1.1">
     EMMA
    </span>
    , an
    <span class="ltx_text ltx_font_bold" id="S5.p1.1.2">
     E
    </span>
    mbodied
    <span class="ltx_text ltx_font_bold" id="S5.p1.1.3">
     M
    </span>
    ulti-
    <span class="ltx_text ltx_font_bold" id="S5.p1.1.4">
     M
    </span>
    odal
    <span class="ltx_text ltx_font_bold" id="S5.p1.1.5">
     A
    </span>
    gent, by finetuning a VLM in an embodied visual world with interactive imitation learning from an LLM expert in a parallel text world, who produces better actions and retrospective feedback to VLM’s trajectories. Such imitation learning exhibits substantial advantages over vision or VLM policies directly finetuned in the visual world or finetuned by behavior cloning of a rule-based expert, and SOTA API VLMs such as GPT-4V(ision). As a result, EMMA achieves a comparable success rate and much better robustness in the noisy visual world than its LLM teacher in the easier text world. Furthermore, EMMA shows powerful generalization to open-vocabulary and free-form task instructions, highlighting its potential in real-world scenarios.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib1.5.5.1" style="font-size:90%;">
      Aeronautiques et al. [1998]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib1.7.1" style="font-size:90%;">
      Constructions Aeronautiques, Adele Howe, Craig Knoblock, ISI Drew McDermott,
Ashwin Ram, Manuela Veloso, Daniel Weld, David Wilkins SRI, Anthony Barrett,
Dave Christianson, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib1.8.1" style="font-size:90%;">
      Pddl: the planning domain definition language.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib1.9.1" style="font-size:90%;">
      Technical Report, Tech. Rep.
     </em>
     <span class="ltx_text" id="bib.bib1.10.2" style="font-size:90%;">
      , 1998.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib2.4.4.1" style="font-size:90%;">
      Bain and Sammut [1995]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib2.6.1" style="font-size:90%;">
      Michael Bain and Claude Sammut.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib2.7.1" style="font-size:90%;">
      A framework for behavioural cloning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib2.8.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib2.9.2" style="font-size:90%;">
      Machine Intelligence
     </em>
     <span class="ltx_text" id="bib.bib2.10.3" style="font-size:90%;">
      , 1995.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib3.5.5.1" style="font-size:90%;">
      Brohan et al. [2022]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib3.7.1" style="font-size:90%;">
      Anthony Brohan, Noah Brown, Justice Carbajal, Yevgen Chebotar, Joseph Dabis,
Chelsea Finn, Keerthana Gopalakrishnan, Karol Hausman, Alex Herzog, Jasmine
Hsu, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib3.8.1" style="font-size:90%;">
      Rt-1: Robotics transformer for real-world control at scale.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2212.06817
     </em>
     <span class="ltx_text" id="bib.bib3.10.2" style="font-size:90%;">
      , 2022.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib4.5.5.1" style="font-size:90%;">
      Brohan et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib4.7.1" style="font-size:90%;">
      Anthony Brohan, Yevgen Chebotar, Chelsea Finn, Karol Hausman, Alexander Herzog,
Daniel Ho, Julian Ibarz, Alex Irpan, Eric Jang, Ryan Julian, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib4.8.1" style="font-size:90%;">
      Do as i can, not as i say: Grounding language in robotic affordances.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib4.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.10.2" style="font-size:90%;">
      CoRL
     </em>
     <span class="ltx_text" id="bib.bib4.11.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib5.5.5.1" style="font-size:90%;">
      Chang et al. [2015]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib5.7.1" style="font-size:90%;">
      Kai-Wei Chang, Akshay Krishnamurthy, Alekh Agarwal, Hal Daumé III, and
John Langford.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib5.8.1" style="font-size:90%;">
      Learning to search better than your teacher.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib5.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib5.10.2" style="font-size:90%;">
      ICML
     </em>
     <span class="ltx_text" id="bib.bib5.11.3" style="font-size:90%;">
      , 2015.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib6.5.5.1" style="font-size:90%;">
      Chen et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib6.7.1" style="font-size:90%;">
      Lichang Chen, Jiuhai Chen, Tom Goldstein, Heng Huang, and Tianyi Zhou.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib6.8.1" style="font-size:90%;">
      Instructzero: Efficient instruction optimization for black-box large
language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib6.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2306.03082
     </em>
     <span class="ltx_text" id="bib.bib6.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib7.5.5.1" style="font-size:90%;">
      Côté et al. [2019]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib7.7.1" style="font-size:90%;">
      Marc-Alexandre Côté, Akos Kádár, Xingdi Yuan, Ben Kybartas,
Tavian Barnes, Emery Fine, James Moore, Matthew Hausknecht, Layla El Asri,
Mahmoud Adada, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib7.8.1" style="font-size:90%;">
      Textworld: A learning environment for text-based games.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib7.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib7.10.2" style="font-size:90%;">
      Computer Games Workshop, IJCAI
     </em>
     <span class="ltx_text" id="bib.bib7.11.3" style="font-size:90%;">
      , 2019.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib8.5.5.1" style="font-size:90%;">
      Dai et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib8.7.1" style="font-size:90%;">
      Wenliang Dai, Junnan Li, Dongxu Li, Anthony Tiong, Junqi Zhao, Weisheng Wang,
Boyang Li, Pascale Fung, and Steven Hoi.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib8.8.1" style="font-size:90%;">
      InstructBLIP: Towards general-purpose vision-language models with
instruction tuning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib8.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib8.10.2" style="font-size:90%;">
      NeurIPS
     </em>
     <span class="ltx_text" id="bib.bib8.11.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib9.5.5.1" style="font-size:90%;">
      Devlin et al. [2019]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib9.7.1" style="font-size:90%;">
      Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib9.8.1" style="font-size:90%;">
      BERT: pre-training of deep bidirectional transformers for language
understanding.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib9.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib9.10.2" style="font-size:90%;">
      NAACL-HLT
     </em>
     <span class="ltx_text" id="bib.bib9.11.3" style="font-size:90%;">
      , 2019.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib10.5.5.1" style="font-size:90%;">
      Dosovitskiy et al. [2021]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib10.7.1" style="font-size:90%;">
      Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib10.8.1" style="font-size:90%;">
      An image is worth 16x16 words: Transformers for image recognition at
scale.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib10.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib10.10.2" style="font-size:90%;">
      ICLR
     </em>
     <span class="ltx_text" id="bib.bib10.11.3" style="font-size:90%;">
      , 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib11.5.5.1" style="font-size:90%;">
      Driess et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib11.7.1" style="font-size:90%;">
      Danny Driess, Fei Xia, Mehdi SM Sajjadi, Corey Lynch, Aakanksha Chowdhery,
Brian Ichter, Ayzaan Wahid, Jonathan Tompson, Quan Vuong, Tianhe Yu, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib11.8.1" style="font-size:90%;">
      Palm-e: An embodied multimodal language model.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib11.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2303.03378
     </em>
     <span class="ltx_text" id="bib.bib11.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib12.5.5.1" style="font-size:90%;">
      Fu et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib12.7.1" style="font-size:90%;">
      Daocheng Fu, Xin Li, Licheng Wen, Min Dou, Pinlong Cai, Botian Shi, and Yu
Qiao.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib12.8.1" style="font-size:90%;">
      Drive like a human: Rethinking autonomous driving with large language
models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2307.07162
     </em>
     <span class="ltx_text" id="bib.bib12.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib13.5.5.1" style="font-size:90%;">
      Gao et al. [2023a]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib13.7.1" style="font-size:90%;">
      Jensen Gao, Bidipta Sarkar, Fei Xia, Ted Xiao, Jiajun Wu, Brian Ichter,
Anirudha Majumdar, and Dorsa Sadigh.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib13.8.1" style="font-size:90%;">
      Physically grounded vision-language models for robotic manipulation.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2309.02561
     </em>
     <span class="ltx_text" id="bib.bib13.10.2" style="font-size:90%;">
      , 2023a.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib14.5.5.1" style="font-size:90%;">
      Gao et al. [2023b]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib14.7.1" style="font-size:90%;">
      Peng Gao, Jiaming Han, Renrui Zhang, Ziyi Lin, Shijie Geng, Aojun Zhou, Wei
Zhang, Pan Lu, Conghui He, Xiangyu Yue, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib14.8.1" style="font-size:90%;">
      Llama-adapter v2: Parameter-efficient visual instruction model.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib14.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2304.15010
     </em>
     <span class="ltx_text" id="bib.bib14.10.2" style="font-size:90%;">
      , 2023b.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib15.5.5.1" style="font-size:90%;">
      Gülçehre et al. [2016]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib15.7.1" style="font-size:90%;">
      Çaglar Gülçehre, Sungjin Ahn, Ramesh Nallapati, Bowen Zhou,
and Yoshua Bengio.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib15.8.1" style="font-size:90%;">
      Pointing the unknown words.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib15.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.10.2" style="font-size:90%;">
      ACL
     </em>
     <span class="ltx_text" id="bib.bib15.11.3" style="font-size:90%;">
      , 2016.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib16.5.5.1" style="font-size:90%;">
      He et al. [2016]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib16.7.1" style="font-size:90%;">
      Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib16.8.1" style="font-size:90%;">
      Deep residual learning for image recognition.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib16.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib16.10.2" style="font-size:90%;">
      CVPR
     </em>
     <span class="ltx_text" id="bib.bib16.11.3" style="font-size:90%;">
      , 2016.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib17.5.5.1" style="font-size:90%;">
      He et al. [2017]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib17.7.1" style="font-size:90%;">
      Kaiming He, Georgia Gkioxari, Piotr Dollár, and Ross B. Girshick.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib17.8.1" style="font-size:90%;">
      Mask R-CNN.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib17.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.10.2" style="font-size:90%;">
      ICCV
     </em>
     <span class="ltx_text" id="bib.bib17.11.3" style="font-size:90%;">
      , 2017.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib18.4.4.1" style="font-size:90%;">
      Helmert [2006]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib18.6.1" style="font-size:90%;">
      Malte Helmert.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib18.7.1" style="font-size:90%;">
      The fast downward planning system.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib18.8.1" style="font-size:90%;">
      Journal of Artificial Intelligence Research
     </em>
     <span class="ltx_text" id="bib.bib18.9.2" style="font-size:90%;">
      , 2006.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib19.4.4.1" style="font-size:90%;">
      Ho and Ermon [2016]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib19.6.1" style="font-size:90%;">
      Jonathan Ho and Stefano Ermon.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib19.7.1" style="font-size:90%;">
      Generative adversarial imitation learning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib19.8.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib19.9.2" style="font-size:90%;">
      NeurIPS
     </em>
     <span class="ltx_text" id="bib.bib19.10.3" style="font-size:90%;">
      , 2016.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib20.5.5.1" style="font-size:90%;">
      Huang et al. [2022]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib20.7.1" style="font-size:90%;">
      Wenlong Huang, Pieter Abbeel, Deepak Pathak, and Igor Mordatch.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib20.8.1" style="font-size:90%;">
      Language models as zero-shot planners: Extracting actionable
knowledge for embodied agents.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib20.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib20.10.2" style="font-size:90%;">
      ICML
     </em>
     <span class="ltx_text" id="bib.bib20.11.3" style="font-size:90%;">
      , 2022.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib21.5.5.1" style="font-size:90%;">
      Huang et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib21.7.1" style="font-size:90%;">
      Wenlong Huang, Chen Wang, Ruohan Zhang, Yunzhu Li, Jiajun Wu, and Li Fei-Fei.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib21.8.1" style="font-size:90%;">
      Voxposer: Composable 3d value maps for robotic manipulation with
language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib21.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2307.05973
     </em>
     <span class="ltx_text" id="bib.bib21.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib22.5.5.1" style="font-size:90%;">
      Hussein et al. [2017]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib22.7.1" style="font-size:90%;">
      Ahmed Hussein, Mohamed Medhat Gaber, Eyad Elyan, and Chrisina Jayne.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib22.8.1" style="font-size:90%;">
      Imitation learning: A survey of learning methods.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib22.9.1" style="font-size:90%;">
      ACM Computing Surveys (CSUR)
     </em>
     <span class="ltx_text" id="bib.bib22.10.2" style="font-size:90%;">
      , 50(2):1–35,
2017.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib23.4.4.1" style="font-size:90%;">
      Hutter [2004]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib23.6.1" style="font-size:90%;">
      Marcus Hutter.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib23.7.1" style="font-size:90%;">
      Universal artificial intelligence: Sequential decisions based
on algorithmic probability
     </em>
     <span class="ltx_text" id="bib.bib23.8.2" style="font-size:90%;">
      .
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib23.9.1" style="font-size:90%;">
      Springer Science &amp; Business Media, 2004.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib24.5.5.1" style="font-size:90%;">
      III et al. [2009]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib24.7.1" style="font-size:90%;">
      Hal Daumé III, John Langford, and Daniel Marcu.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib24.8.1" style="font-size:90%;">
      Search-based structured prediction.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib24.9.1" style="font-size:90%;">
      Mach. Learn.
     </em>
     <span class="ltx_text" id="bib.bib24.10.2" style="font-size:90%;">
      , 2009.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib25.5.5.1" style="font-size:90%;">
      Jiang et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib25.7.1" style="font-size:90%;">
      Yunfan Jiang, Agrim Gupta, Zichen Zhang, Guanzhi Wang, Yongqiang Dou, Yanjun
Chen, Li Fei-Fei, Anima Anandkumar, Yuke Zhu, and Linxi Fan.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib25.8.1" style="font-size:90%;">
      VIMA: robot manipulation with multimodal prompts.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib25.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib25.10.2" style="font-size:90%;">
      ICML
     </em>
     <span class="ltx_text" id="bib.bib25.11.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib26.5.5.1" style="font-size:90%;">
      Kolve et al. [2017]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib26.7.1" style="font-size:90%;">
      Eric Kolve, Roozbeh Mottaghi, Winson Han, Eli VanderBilt, Luca Weihs, Alvaro
Herrasti, Matt Deitke, Kiana Ehsani, Daniel Gordon, Yuke Zhu, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib26.8.1" style="font-size:90%;">
      Ai2-thor: An interactive 3d environment for visual ai.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib26.9.1" style="font-size:90%;">
      arXiv preprint arXiv:1712.05474
     </em>
     <span class="ltx_text" id="bib.bib26.10.2" style="font-size:90%;">
      , 2017.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib27.5.5.1" style="font-size:90%;">
      Levine et al. [2020]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib27.7.1" style="font-size:90%;">
      Sergey Levine, Aviral Kumar, George Tucker, and Justin Fu.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib27.8.1" style="font-size:90%;">
      Offline reinforcement learning: Tutorial, review, and perspectives on
open problems.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib27.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2005.01643
     </em>
     <span class="ltx_text" id="bib.bib27.10.2" style="font-size:90%;">
      , 2020.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib28.5.5.1" style="font-size:90%;">
      Li et al. [2023a]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib28.7.1" style="font-size:90%;">
      Chunyuan Li, Zhe Gan, Zhengyuan Yang, Jianwei Yang, Linjie Li, Lijuan Wang, and
Jianfeng Gao.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib28.8.1" style="font-size:90%;">
      Multimodal foundation models: From specialists to general-purpose
assistants.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib28.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2309.10020
     </em>
     <span class="ltx_text" id="bib.bib28.10.2" style="font-size:90%;">
      , 2023a.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib29.5.5.1" style="font-size:90%;">
      Li et al. [2023b]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib29.7.1" style="font-size:90%;">
      Dongxu Li, Junnan Li, Hung Le, Guangsen Wang, Silvio Savarese, and Steven C.H.
Hoi.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib29.8.1" style="font-size:90%;">
      LAVIS: A one-stop library for language-vision intelligence.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib29.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.10.2" style="font-size:90%;">
      Proceedings of the 61st Annual Meeting of the Association
for Computational Linguistics (Volume 3: System Demonstrations)
     </em>
     <span class="ltx_text" id="bib.bib29.11.3" style="font-size:90%;">
      ,
2023b.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib30.5.5.1" style="font-size:90%;">
      Li et al. [2023c]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib30.7.1" style="font-size:90%;">
      Junnan Li, Dongxu Li, Silvio Savarese, and Steven C. H. Hoi.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib30.8.1" style="font-size:90%;">
      BLIP-2: bootstrapping language-image pre-training with frozen image
encoders and large language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib30.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.10.2" style="font-size:90%;">
      ICML
     </em>
     <span class="ltx_text" id="bib.bib30.11.3" style="font-size:90%;">
      , 2023c.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib31.5.5.1" style="font-size:90%;">
      Liang et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib31.7.1" style="font-size:90%;">
      Jacky Liang, Wenlong Huang, Fei Xia, Peng Xu, Karol Hausman, Brian Ichter, Pete
Florence, and Andy Zeng.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib31.8.1" style="font-size:90%;">
      Code as policies: Language model programs for embodied control.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib31.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib31.10.2" style="font-size:90%;">
      ICRA
     </em>
     <span class="ltx_text" id="bib.bib31.11.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib32.5.5.1" style="font-size:90%;">
      Lin et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib32.7.1" style="font-size:90%;">
      Yong Lin, Lu Tan, Hangyu Lin, Zeming Zheng, Renjie Pi, Jipeng Zhang, Shizhe
Diao, Haoxiang Wang, Han Zhao, Yuan Yao, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib32.8.1" style="font-size:90%;">
      Speciality vs generality: An empirical study on catastrophic
forgetting in fine-tuning foundation models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib32.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2309.06256
     </em>
     <span class="ltx_text" id="bib.bib32.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib33.5.5.1" style="font-size:90%;">
      Liu et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib33.7.1" style="font-size:90%;">
      Haotian Liu, Chunyuan Li, Qingyang Wu, and Yong Jae Lee.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib33.8.1" style="font-size:90%;">
      Visual instruction tuning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib33.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2304.08485
     </em>
     <span class="ltx_text" id="bib.bib33.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib34.4.4.1" style="font-size:90%;">
      Loshchilov and Hutter [2017]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib34.6.1" style="font-size:90%;">
      Ilya Loshchilov and Frank Hutter.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib34.7.1" style="font-size:90%;">
      Decoupled weight decay regularization.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib34.8.1" style="font-size:90%;">
      arXiv preprint arXiv:1711.05101
     </em>
     <span class="ltx_text" id="bib.bib34.9.2" style="font-size:90%;">
      , 2017.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib35.5.5.1" style="font-size:90%;">
      Ma et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib35.7.1" style="font-size:90%;">
      Yecheng Jason Ma, William Liang, Guanzhi Wang, De-An Huang, Osbert Bastani,
Dinesh Jayaraman, Yuke Zhu, Linxi Fan, and Anima Anandkumar.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib35.8.1" style="font-size:90%;">
      Eureka: Human-level reward design via coding large language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib35.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2310.12931
     </em>
     <span class="ltx_text" id="bib.bib35.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib36.4.4.1" style="font-size:90%;">
      Micheli and Fleuret [2021]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib36.6.1" style="font-size:90%;">
      Vincent Micheli and François Fleuret.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib36.7.1" style="font-size:90%;">
      Language models are few-shot butlers.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib36.8.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib36.9.2" style="font-size:90%;">
      EMNLP
     </em>
     <span class="ltx_text" id="bib.bib36.10.3" style="font-size:90%;">
      , 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib37.5.5.1" style="font-size:90%;">
      Mu et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib37.7.1" style="font-size:90%;">
      Yao Mu, Qinglong Zhang, Mengkang Hu, Wenhai Wang, Mingyu Ding, Jun Jin, Bin
Wang, Jifeng Dai, Yu Qiao, and Ping Luo.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib37.8.1" style="font-size:90%;">
      Embodiedgpt: Vision-language pre-training via embodied chain of
thought.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib37.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2305.15021
     </em>
     <span class="ltx_text" id="bib.bib37.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib38.4.4.1" style="font-size:90%;">
      OpenAI [2023a]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib38.6.1" style="font-size:90%;">
      OpenAI.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib38.7.1" style="font-size:90%;">
      GPT-4 technical report.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib38.8.1" style="font-size:90%;">
      arXiv preprint arXiv.2303.08774
     </em>
     <span class="ltx_text" id="bib.bib38.9.2" style="font-size:90%;">
      , 2023a.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib39.4.4.1" style="font-size:90%;">
      OpenAI [2023b]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib39.6.1" style="font-size:90%;">
      OpenAI.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib39.7.1" style="font-size:90%;">
      GPT-4V(ision) system card.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib39.8.1" style="font-size:90%;">
      <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://cdn.openai.com/papers/GPTV_System_Card.pdf" target="_blank" title="">
       https://cdn.openai.com/papers/GPTV_System_Card.pdf
      </a>
     </em>
     <span class="ltx_text" id="bib.bib39.9.2" style="font-size:90%;">
      ,
2023b.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib40.5.5.1" style="font-size:90%;">
      Padalkar et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib40.7.1" style="font-size:90%;">
      Abhishek Padalkar, Acorn Pooley, Ajinkya Jain, Alex Bewley, Alex Herzog, Alex
Irpan, Alexander Khazatsky, Anant Rai, Anikait Singh, Anthony Brohan, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib40.8.1" style="font-size:90%;">
      Open x-embodiment: Robotic learning datasets and rt-x models, 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib41.5.5.1" style="font-size:90%;">
      Radford et al. [2019]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib41.7.1" style="font-size:90%;">
      Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya
Sutskever, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib41.8.1" style="font-size:90%;">
      Language models are unsupervised multitask learners.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib41.9.1" style="font-size:90%;">
      OpenAI blog
     </em>
     <span class="ltx_text" id="bib.bib41.10.2" style="font-size:90%;">
      , 2019.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib42.5.5.1" style="font-size:90%;">
      Radford et al. [2021]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib42.7.1" style="font-size:90%;">
      Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib42.8.1" style="font-size:90%;">
      Learning transferable visual models from natural language
supervision.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib42.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib42.10.2" style="font-size:90%;">
      ICML
     </em>
     <span class="ltx_text" id="bib.bib42.11.3" style="font-size:90%;">
      , 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib43.5.5.1" style="font-size:90%;">
      Rafailov et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib43.7.1" style="font-size:90%;">
      Rafael Rafailov, Archit Sharma, Eric Mitchell, Stefano Ermon, Christopher D
Manning, and Chelsea Finn.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib43.8.1" style="font-size:90%;">
      Direct preference optimization: Your language model is secretly a
reward model.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib43.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2305.18290
     </em>
     <span class="ltx_text" id="bib.bib43.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib44.4.4.1" style="font-size:90%;">
      Ross and Bagnell [2010]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib44.6.1" style="font-size:90%;">
      Stéphane Ross and Drew Bagnell.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib44.7.1" style="font-size:90%;">
      Efficient reductions for imitation learning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib44.8.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib44.9.2" style="font-size:90%;">
      AISTATS
     </em>
     <span class="ltx_text" id="bib.bib44.10.3" style="font-size:90%;">
      , 2010.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib45.4.4.1" style="font-size:90%;">
      Ross and Bagnell [2014]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib45.6.1" style="font-size:90%;">
      Stephane Ross and J Andrew Bagnell.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib45.7.1" style="font-size:90%;">
      Reinforcement and imitation learning via interactive no-regret
learning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib45.8.1" style="font-size:90%;">
      arXiv preprint arXiv:1406.5979
     </em>
     <span class="ltx_text" id="bib.bib45.9.2" style="font-size:90%;">
      , 2014.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib46.5.5.1" style="font-size:90%;">
      Ross et al. [2011]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib46.7.1" style="font-size:90%;">
      Stéphane Ross, Geoffrey J. Gordon, and Drew Bagnell.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib46.8.1" style="font-size:90%;">
      A reduction of imitation learning and structured prediction to
no-regret online learning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib46.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib46.10.2" style="font-size:90%;">
      AISTATS
     </em>
     <span class="ltx_text" id="bib.bib46.11.3" style="font-size:90%;">
      , 2011.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib47.5.5.1" style="font-size:90%;">
      Schulman et al. [2015]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib47.7.1" style="font-size:90%;">
      John Schulman, Sergey Levine, Pieter Abbeel, Michael I. Jordan, and Philipp
Moritz.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib47.8.1" style="font-size:90%;">
      Trust region policy optimization.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib47.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib47.10.2" style="font-size:90%;">
      ICML
     </em>
     <span class="ltx_text" id="bib.bib47.11.3" style="font-size:90%;">
      , 2015.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib48.5.5.1" style="font-size:90%;">
      Schulman et al. [2017]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib48.7.1" style="font-size:90%;">
      John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib48.8.1" style="font-size:90%;">
      Proximal policy optimization algorithms.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib48.9.1" style="font-size:90%;">
      arXiv preprint arXiv:1707.06347
     </em>
     <span class="ltx_text" id="bib.bib48.10.2" style="font-size:90%;">
      , 2017.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib49.5.5.1" style="font-size:90%;">
      Shinn et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib49.7.1" style="font-size:90%;">
      Noah Shinn, Federico Cassano, Ashwin Gopinath, Karthik R Narasimhan, and Shunyu
Yao.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib49.8.1" style="font-size:90%;">
      Reflexion: Language agents with verbal reinforcement learning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib49.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib49.10.2" style="font-size:90%;">
      NeurIPS
     </em>
     <span class="ltx_text" id="bib.bib49.11.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib50.5.5.1" style="font-size:90%;">
      Shridhar et al. [2020]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib50.7.1" style="font-size:90%;">
      Mohit Shridhar, Jesse Thomason, Daniel Gordon, Yonatan Bisk, Winson Han,
Roozbeh Mottaghi, Luke Zettlemoyer, and Dieter Fox.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib50.8.1" style="font-size:90%;">
      ALFRED: A benchmark for interpreting grounded instructions for
everyday tasks.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib50.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib50.10.2" style="font-size:90%;">
      CVPR
     </em>
     <span class="ltx_text" id="bib.bib50.11.3" style="font-size:90%;">
      , 2020.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib51.5.5.1" style="font-size:90%;">
      Shridhar et al. [2021]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib51.7.1" style="font-size:90%;">
      Mohit Shridhar, Xingdi Yuan, Marc-Alexandre Côté, Yonatan Bisk,
Adam Trischler, and Matthew J. Hausknecht.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib51.8.1" style="font-size:90%;">
      Alfworld: Aligning text and embodied environments for interactive
learning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib51.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib51.10.2" style="font-size:90%;">
      ICLR
     </em>
     <span class="ltx_text" id="bib.bib51.11.3" style="font-size:90%;">
      , 2021.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib52">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib52.5.5.1" style="font-size:90%;">
      Sumers et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib52.7.1" style="font-size:90%;">
      Theodore Sumers, Kenneth Marino, Arun Ahuja, Rob Fergus, and Ishita Dasgupta.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib52.8.1" style="font-size:90%;">
      Distilling internet-scale vision-language models into embodied
agents.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib52.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib52.10.2" style="font-size:90%;">
      ICML
     </em>
     <span class="ltx_text" id="bib.bib52.11.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib53">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib53.5.5.1" style="font-size:90%;">
      Sun et al. [2018]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib53.7.1" style="font-size:90%;">
      Wen Sun, J. Andrew Bagnell, and Byron Boots.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib53.8.1" style="font-size:90%;">
      Truncated horizon policy search: Combining reinforcement learning
&amp; imitation learning.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib53.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib53.10.2" style="font-size:90%;">
      ICLR
     </em>
     <span class="ltx_text" id="bib.bib53.11.3" style="font-size:90%;">
      , 2018.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib54">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib54.5.5.1" style="font-size:90%;">
      Wang et al. [2023a]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib54.7.1" style="font-size:90%;">
      Guanzhi Wang, Yuqi Xie, Yunfan Jiang, Ajay Mandlekar, Chaowei Xiao, Yuke Zhu,
Linxi Fan, and Anima Anandkumar.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib54.8.1" style="font-size:90%;">
      Voyager: An open-ended embodied agent with large language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib54.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2305.16291
     </em>
     <span class="ltx_text" id="bib.bib54.10.2" style="font-size:90%;">
      , 2023a.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib55">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib55.5.5.1" style="font-size:90%;">
      Wang et al. [2023b]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib55.7.1" style="font-size:90%;">
      Zihao Wang, Shaofei Cai, Anji Liu, Xiaojian Ma, and Yitao Liang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib55.8.1" style="font-size:90%;">
      Describe, explain, plan and select: Interactive planning with large
language models enables open-world multi-task agents.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib55.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2302.01560
     </em>
     <span class="ltx_text" id="bib.bib55.10.2" style="font-size:90%;">
      , 2023b.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib56">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib56.5.5.1" style="font-size:90%;">
      Wei et al. [2022]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib56.7.1" style="font-size:90%;">
      Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Brian Ichter, Fei Xia,
Ed H. Chi, Quoc V. Le, and Denny Zhou.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib56.8.1" style="font-size:90%;">
      Chain-of-thought prompting elicits reasoning in large language
models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib56.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib56.10.2" style="font-size:90%;">
      NeurIPS
     </em>
     <span class="ltx_text" id="bib.bib56.11.3" style="font-size:90%;">
      , 2022.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib57">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib57.4.4.1" style="font-size:90%;">
      Wooldridge and Jennings [1995]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib57.6.1" style="font-size:90%;">
      Michael Wooldridge and Nicholas R Jennings.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib57.7.1" style="font-size:90%;">
      Intelligent agents: Theory and practice.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib57.8.1" style="font-size:90%;">
      The knowledge engineering review
     </em>
     <span class="ltx_text" id="bib.bib57.9.2" style="font-size:90%;">
      , 10(2):115–152, 1995.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib58">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib58.5.5.1" style="font-size:90%;">
      Wu et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib58.7.1" style="font-size:90%;">
      Qingyun Wu, Gagan Bansal, Jieyu Zhang, Yiran Wu, Shaokun Zhang, Erkang Zhu,
Beibin Li, Li Jiang, Xiaoyun Zhang, and Chi Wang.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib58.8.1" style="font-size:90%;">
      Autogen: Enabling next-gen llm applications via multi-agent
conversation framework.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib58.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2308.08155
     </em>
     <span class="ltx_text" id="bib.bib58.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib59">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib59.5.5.1" style="font-size:90%;">
      Xi et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib59.7.1" style="font-size:90%;">
      Zhiheng Xi, Wenxiang Chen, Xin Guo, Wei He, Yiwen Ding, Boyang Hong, Ming
Zhang, Junzhe Wang, Senjie Jin, Enyu Zhou, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib59.8.1" style="font-size:90%;">
      The rise and potential of large language model based agents: A
survey.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib59.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2309.07864
     </em>
     <span class="ltx_text" id="bib.bib59.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib60">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib60.5.5.1" style="font-size:90%;">
      Xu et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib60.7.1" style="font-size:90%;">
      Zhenhua Xu, Yujia Zhang, Enze Xie, Zhen Zhao, Yong Guo, Kenneth KY Wong,
Zhenguo Li, and Hengshuang Zhao.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib60.8.1" style="font-size:90%;">
      Drivegpt4: Interpretable end-to-end autonomous driving via large
language model.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib60.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2310.01412
     </em>
     <span class="ltx_text" id="bib.bib60.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib61">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib61.5.5.1" style="font-size:90%;">
      Xue et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib61.7.1" style="font-size:90%;">
      Zihui Xue, Zhengqi Gao, Sucheng Ren, and Hang Zhao.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib61.8.1" style="font-size:90%;">
      The modality focusing hypothesis: Towards understanding crossmodal
knowledge distillation.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib61.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib61.10.2" style="font-size:90%;">
      ICLR
     </em>
     <span class="ltx_text" id="bib.bib61.11.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib62">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib62.5.5.1" style="font-size:90%;">
      Yang et al. [2023a]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib62.7.1" style="font-size:90%;">
      Jingkang Yang, Yuhao Dong, Shuai Liu, Bo Li, Ziyue Wang, Chencheng Jiang,
Haoran Tan, Jiamu Kang, Yuanhan Zhang, Kaiyang Zhou, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib62.8.1" style="font-size:90%;">
      Octopus: Embodied vision-language programmer from environmental
feedback.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib62.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2310.08588
     </em>
     <span class="ltx_text" id="bib.bib62.10.2" style="font-size:90%;">
      , 2023a.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib63">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib63.5.5.1" style="font-size:90%;">
      Yang et al. [2023b]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib63.7.1" style="font-size:90%;">
      Sherry Yang, Ofir Nachum, Yilun Du, Jason Wei, Pieter Abbeel, and Dale
Schuurmans.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib63.8.1" style="font-size:90%;">
      Foundation models for decision making: Problems, methods, and
opportunities.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib63.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2303.04129
     </em>
     <span class="ltx_text" id="bib.bib63.10.2" style="font-size:90%;">
      , 2023b.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib64">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib64.5.5.1" style="font-size:90%;">
      Yao et al. [2023a]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib64.7.1" style="font-size:90%;">
      Shunyu Yao, Dian Yu, Jeffrey Zhao, Izhak Shafran, Thomas L Griffiths, Yuan Cao,
and Karthik Narasimhan.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib64.8.1" style="font-size:90%;">
      Tree of thoughts: Deliberate problem solving with large language
models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib64.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2305.10601
     </em>
     <span class="ltx_text" id="bib.bib64.10.2" style="font-size:90%;">
      , 2023a.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib65">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib65.5.5.1" style="font-size:90%;">
      Yao et al. [2023b]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib65.7.1" style="font-size:90%;">
      Shunyu Yao, Jeffrey Zhao, Dian Yu, Nan Du, Izhak Shafran, Karthik R.
Narasimhan, and Yuan Cao.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib65.8.1" style="font-size:90%;">
      React: Synergizing reasoning and acting in language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib65.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib65.10.2" style="font-size:90%;">
      ICLR
     </em>
     <span class="ltx_text" id="bib.bib65.11.3" style="font-size:90%;">
      , 2023b.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib66">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib66.5.5.1" style="font-size:90%;">
      Zheng et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib66.7.1" style="font-size:90%;">
      Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao
Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric Xing, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib66.8.1" style="font-size:90%;">
      Judging llm-as-a-judge with mt-bench and chatbot arena.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib66.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2306.05685
     </em>
     <span class="ltx_text" id="bib.bib66.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib67">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib67.5.5.1" style="font-size:90%;">
      Zhu et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib67.7.1" style="font-size:90%;">
      Deyao Zhu, Jun Chen, Xiaoqian Shen, Xiang Li, and Mohamed Elhoseiny.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib67.8.1" style="font-size:90%;">
      Minigpt-4: Enhancing vision-language understanding with advanced
large language models.
     </span>
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib67.9.1" style="font-size:90%;">
      arXiv preprint arXiv:2304.10592
     </em>
     <span class="ltx_text" id="bib.bib67.10.2" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib68">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     <span class="ltx_text" id="bib.bib68.5.5.1" style="font-size:90%;">
      Zitkovich et al. [2023]
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib68.7.1" style="font-size:90%;">
      Brianna Zitkovich, Tianhe Yu, Sichun Xu, Peng Xu, Ted Xiao, Fei Xia, Jialin Wu,
Paul Wohlhart, Stefan Welker, Ayzaan Wahid, et al.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib68.8.1" style="font-size:90%;">
      Rt-2: Vision-language-action models transfer web knowledge to robotic
control.
     </span>
    </span>
    <span class="ltx_bibblock">
     <span class="ltx_text" id="bib.bib68.9.1" style="font-size:90%;">
      In
     </span>
     <em class="ltx_emph ltx_font_italic" id="bib.bib68.10.2" style="font-size:90%;">
      CoRL
     </em>
     <span class="ltx_text" id="bib.bib68.11.3" style="font-size:90%;">
      , 2023.
     </span>
    </span>
   </li>
  </ul>
 </section>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <section class="ltx_section" id="Sx1">
  <h2 class="ltx_title ltx_title_section">
   Appendix
  </h2>
  <figure class="ltx_figure" id="Sx1.F8">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_portrait" height="566" id="Sx1.F8.g1" src="/html/2311.16714/assets/x9.png" width="449"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="Sx1.F8.3.1.1" style="font-size:90%;">
      Figure 8
     </span>
     :
    </span>
    <span class="ltx_text ltx_font_bold" id="Sx1.F8.4.2" style="font-size:90%;">
     Visualized task examples of ALFWorld
     <cite class="ltx_cite ltx_citemacro_citep">
      [
      <a class="ltx_ref" href="#bib.bib51" title="">
       <span class="ltx_text" style="font-size:90%;">
        51
       </span>
      </a>
      ]
     </cite>
     .
     <span class="ltx_text ltx_font_medium" id="Sx1.F8.4.2.1">
      This benchmark adopts diverse household scenes developed by the Ai2Thor
      <cite class="ltx_cite ltx_citemacro_citep">
       [
       <a class="ltx_ref" href="#bib.bib26" title="">
        <span class="ltx_text" style="font-size:90%;">
         26
        </span>
       </a>
       ]
      </cite>
      environment, in which all objects can be relocated to different positions based on placeable surface areas and class constraints, enabling the procedural generation of a large pool of new tasks via recombining different objects and goal positions.
     </span>
    </span>
   </figcaption>
  </figure>
 </section>
 <section class="ltx_section" id="S6">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6
   </span>
   Full Prompts for LLM Expert
  </h2>
  <div class="ltx_para" id="S6.p1">
   <p class="ltx_p" id="S6.p1.4">
    In this section, we provide all LLM prompts for the training procedure (Alg.
    <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ 2.3 Training EMMA via Cross-Modality Imitation ‣ 2 Embodied Multi-Modal Agent ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    ) of EMMA. We adopt the prompting technique developed by ReAct
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib65" title="">
      <span class="ltx_text" style="font-size:90%;">
       65
      </span>
     </a>
     ]
    </cite>
    but ignore the reasoning traces, i.e., “think” steps, when executing imitation learning between EMMA and the LLM actor. After each trial
    <math alttext="i" class="ltx_Math" display="inline" id="S6.p1.1.m1.1">
     <semantics id="S6.p1.1.m1.1a">
      <mi id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">
       i
      </mi>
      <annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b">
       <ci id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">
        𝑖
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">
       i
      </annotation>
     </semantics>
    </math>
    , the retrospective feedback
    <math alttext="\mathcal{P}_{i}" class="ltx_Math" display="inline" id="S6.p1.2.m2.1">
     <semantics id="S6.p1.2.m2.1a">
      <msub id="S6.p1.2.m2.1.1" xref="S6.p1.2.m2.1.1.cmml">
       <mi class="ltx_font_mathcaligraphic" id="S6.p1.2.m2.1.1.2" xref="S6.p1.2.m2.1.1.2.cmml">
        𝒫
       </mi>
       <mi id="S6.p1.2.m2.1.1.3" xref="S6.p1.2.m2.1.1.3.cmml">
        i
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="S6.p1.2.m2.1b">
       <apply id="S6.p1.2.m2.1.1.cmml" xref="S6.p1.2.m2.1.1">
        <csymbol cd="ambiguous" id="S6.p1.2.m2.1.1.1.cmml" xref="S6.p1.2.m2.1.1">
         subscript
        </csymbol>
        <ci id="S6.p1.2.m2.1.1.2.cmml" xref="S6.p1.2.m2.1.1.2">
         𝒫
        </ci>
        <ci id="S6.p1.2.m2.1.1.3.cmml" xref="S6.p1.2.m2.1.1.3">
         𝑖
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">
       \mathcal{P}_{i}
      </annotation>
     </semantics>
    </math>
    generated by the LLM critic will be appended to long-term memory
    <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S6.p1.3.m3.1">
     <semantics id="S6.p1.3.m3.1a">
      <mi class="ltx_font_mathcaligraphic" id="S6.p1.3.m3.1.1" xref="S6.p1.3.m3.1.1.cmml">
       𝒫
      </mi>
      <annotation-xml encoding="MathML-Content" id="S6.p1.3.m3.1b">
       <ci id="S6.p1.3.m3.1.1.cmml" xref="S6.p1.3.m3.1.1">
        𝒫
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S6.p1.3.m3.1c">
       \mathcal{P}
      </annotation>
     </semantics>
    </math>
    . In practice, we bound
    <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S6.p1.4.m4.1">
     <semantics id="S6.p1.4.m4.1a">
      <mi class="ltx_font_mathcaligraphic" id="S6.p1.4.m4.1.1" xref="S6.p1.4.m4.1.1.cmml">
       𝒫
      </mi>
      <annotation-xml encoding="MathML-Content" id="S6.p1.4.m4.1b">
       <ci id="S6.p1.4.m4.1.1.cmml" xref="S6.p1.4.m4.1.1">
        𝒫
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S6.p1.4.m4.1c">
       \mathcal{P}
      </annotation>
     </semantics>
    </math>
    by a maximum number of stored feedback (usually set to 1-3) to adhere to the max context length of the LLM.
   </p>
  </div>
  <figure class="ltx_table" id="S6.3">
   <p class="ltx_p ltx_minipage ltx_align_middle" id="S6.3.3.3" style="width:390.3pt;">
    <span class="ltx_text" id="S6.3.3.3.4" style="font-size:70%;">
     An example of the prompt adopted by LLM actor for generating actions
    </span>
    <span class="ltx_tabular ltx_centering ltx_align_middle" id="S6.3.3.3.3">
     <span class="ltx_tbody">
      <span class="ltx_tr" id="S6.3.3.3.3.4.1">
       <span class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.3.3.3.3.4.1.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.4.1.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.4.1.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.3.3.3.3.4.1.1.1.1.1" style="font-size:70%;">
           {environment:
          </span>
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.4.1.1.1.1.2" style="font-size:70%;">
           You are in the middle of a room. Looking quickly around you, you see a cabinet 4, a cabinet 3, a cabinet 2, a cabinet 1, a countertop 1, a garbagecan 1, a handtowelholder 2, a handtowelholder 1, a sinkbasin 2, a sinkbasin 1, a toilet 1, a toiletpaperhanger 1, and a towelholder 1.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.5.2">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.5.2.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.5.2.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.5.2.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.3.3.3.3.5.2.1.1.1.1" style="font-size:70%;">
           task instruction:
          </span>
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.5.2.1.1.1.2" style="font-size:70%;">
           Your task is to: put some spraybottle on toilet.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.6.3">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.6.3.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.6.3.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.6.3.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.6.3.1.1.1.1" style="font-size:70%;">
           &gt; think: To solve the task, I need to find and take a sparybottle, then put it on toilet.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.7.4">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.7.4.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.7.4.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.7.4.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.7.4.1.1.1.1" style="font-size:70%;">
           &gt; think: First I need to find a spraybottle. A spraybottle is more likely to appear in cabinet (1-4), countertop (1), toilet (1), sinkbasin (1-2), garbagecan (1). I can check one by one, starting with cabinet 1.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.8.5">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.8.5.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.8.5.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.8.5.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.8.5.1.1.1.1" style="font-size:70%;">
           &gt; go to cabinet 1
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.9.6">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.9.6.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.9.6.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.9.6.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.9.6.1.1.1.1" style="font-size:70%;">
           On the cabinet 1, you see a cloth 1, a soapbar 1, a soapbottle 1.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.10.7">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.10.7.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.10.7.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.10.7.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.10.7.1.1.1.1" style="font-size:70%;">
           &gt; go to cabinet 2
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.11.8">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.11.8.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.11.8.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.11.8.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.11.8.1.1.1.1" style="font-size:70%;">
           The cabinet 2 is closed.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.12.9">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.12.9.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.12.9.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.12.9.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.12.9.1.1.1.1" style="font-size:70%;">
           &gt; open cabinet 2
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.13.10">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.13.10.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.13.10.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.13.10.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.13.10.1.1.1.1" style="font-size:70%;">
           You open the cabinet 2. The cabinet 2 is open. In it, you see a candle 1, and a spraybottle 2.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.14.11">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.14.11.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.14.11.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.14.11.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.14.11.1.1.1.1" style="font-size:70%;">
           &gt; think: Now I find a spraybottle (2). Next, I need to take it.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.15.12">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.15.12.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.15.12.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.15.12.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.15.12.1.1.1.1" style="font-size:70%;">
           &gt; take spraybottle 2 from cabinet 2
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.16.13">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.16.13.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.16.13.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.16.13.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.16.13.1.1.1.1" style="font-size:70%;">
           You pick up the spraybottle 2 from the cabinet 2.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.17.14">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.17.14.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.17.14.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.17.14.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.17.14.1.1.1.1" style="font-size:70%;">
           &gt; think: Now I take a spraybottle (2). Next, I need to put it in/on toilet 1.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.18.15">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.18.15.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.18.15.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.18.15.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.18.15.1.1.1.1" style="font-size:70%;">
           &gt; go to toilet 1
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.19.16">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.19.16.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.19.16.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.19.16.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.19.16.1.1.1.1" style="font-size:70%;">
           On the toilet 1, you see a soapbottle 2.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.20.17">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.20.17.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.20.17.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.20.17.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.20.17.1.1.1.1" style="font-size:70%;">
           &gt; put spraybottle 2 in/on toilet 1
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.2.2.2.2.2">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.2.2.2.2.2.2">
        <span class="ltx_inline-block ltx_align_top" id="S6.2.2.2.2.2.2.2">
         <span class="ltx_p" id="S6.2.2.2.2.2.2.2.2" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.2.2.2.2.2.2.2.2.3" style="font-size:70%;">
           You put the spraybottle 2 in/on the toilet 1.
          </span>
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.2.2.2.2.2.2.2.2.2" style="font-size:70%;">
           } few-shot examples
           <math alttext="\mathbf{\times}" class="ltx_Math" display="inline" id="S6.1.1.1.1.1.1.1.1.1.m1.1">
            <semantics id="S6.1.1.1.1.1.1.1.1.1.m1.1a">
             <mo id="S6.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S6.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">
              ×
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.1.1.1.1.1.1.1.1.1.m1.1b">
              <times id="S6.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S6.1.1.1.1.1.1.1.1.1.m1.1.1">
              </times>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.1.1.1.1.1.1.1.1.1.m1.1c">
              \mathbf{\times}
             </annotation>
            </semantics>
           </math>
           <math alttext="\mathbf{n}" class="ltx_Math" display="inline" id="S6.2.2.2.2.2.2.2.2.2.m2.1">
            <semantics id="S6.2.2.2.2.2.2.2.2.2.m2.1a">
             <mi id="S6.2.2.2.2.2.2.2.2.2.m2.1.1" mathvariant="normal" xref="S6.2.2.2.2.2.2.2.2.2.m2.1.1.cmml">
              n
             </mi>
             <annotation-xml encoding="MathML-Content" id="S6.2.2.2.2.2.2.2.2.2.m2.1b">
              <ci id="S6.2.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="S6.2.2.2.2.2.2.2.2.2.m2.1.1">
               n
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.2.2.2.2.2.2.2.2.2.m2.1c">
              \mathbf{n}
             </annotation>
            </semantics>
           </math>
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.3">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.3.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.3.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.3.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.3.3.3.3.3.1.1.1.1" style="font-size:70%;">
           long-term memory
           <math alttext="\mathcal{P}" class="ltx_Math" display="inline" id="S6.3.3.3.3.3.1.1.1.1.m1.1">
            <semantics id="S6.3.3.3.3.3.1.1.1.1.m1.1a">
             <mi class="ltx_font_mathcaligraphic" id="S6.3.3.3.3.3.1.1.1.1.m1.1.1" xref="S6.3.3.3.3.3.1.1.1.1.m1.1.1.cmml">
              𝒫
             </mi>
             <annotation-xml encoding="MathML-Content" id="S6.3.3.3.3.3.1.1.1.1.m1.1b">
              <ci id="S6.3.3.3.3.3.1.1.1.1.m1.1.1.cmml" xref="S6.3.3.3.3.3.1.1.1.1.m1.1.1">
               𝒫
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.3.3.3.3.3.1.1.1.1.m1.1c">
              \mathcal{P}
             </annotation>
            </semantics>
           </math>
           :
          </span>
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.3.1.1.1.2" style="font-size:70%;">
           [...]
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.21.18">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.21.18.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.21.18.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.21.18.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.3.3.3.3.21.18.1.1.1.1" style="font-size:70%;">
           target environment:
          </span>
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.21.18.1.1.1.2" style="font-size:70%;">
           ...
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.22.19">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.3.3.3.3.22.19.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.22.19.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.22.19.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.3.3.3.3.22.19.1.1.1.1" style="font-size:70%;">
           task instruction:
          </span>
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.22.19.1.1.1.2" style="font-size:70%;">
           ...
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.3.3.3.3.23.20">
       <span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" id="S6.3.3.3.3.23.20.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.3.3.3.3.23.20.1.1">
         <span class="ltx_p" id="S6.3.3.3.3.23.20.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.3.3.3.3.23.20.1.1.1.1" style="font-size:70%;">
           &gt;
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </span>
    <span class="ltx_text ltx_font_typewriter ltx_align_center" id="S6.3.3.3.5" style="font-size:70%;">
    </span>
   </p>
  </figure>
  <figure class="ltx_table" id="S6.5">
   <p class="ltx_p ltx_minipage ltx_align_middle" id="S6.5.2.2" style="width:390.3pt;">
    <span class="ltx_text" id="S6.5.2.2.3" style="font-size:70%;">
     An example of the prompt adopted by LLM critic for generating retrospection
    </span>
    <span class="ltx_tabular ltx_centering ltx_align_middle" id="S6.5.2.2.2">
     <span class="ltx_tbody">
      <span class="ltx_tr" id="S6.5.2.2.2.3.1">
       <span class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S6.5.2.2.2.3.1.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.3.1.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.3.1.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.5.2.2.2.3.1.1.1.1.1" style="font-size:70%;">
           {previous trial:
          </span>
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.3.1.1.1.1.2" style="font-size:70%;">
           You are in the middle of a room. Looking quickly around you, you see a cabinet 10, a cabinet 9, a cabinet 8, a cabinet 7, a cabinet 6, a cabinet 5, a cabinet 4, a cabinet 3, a cabinet 2, a cabinet 1, a coffeemachine 1, a countertop 2, a countertop 1, a diningtable 2, a diningtable 1, a drawer 3, a drawer 2, a drawer 1, a fridge 1, a garbagecan 1, a microwave 1, a sinkbasin 1, a stoveburner 4, a stoveburner 3, a stoveburner 2, a stoveburner 1, and a toaster 1.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.4.2">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.4.2.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.4.2.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.4.2.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.4.2.1.1.1.1" style="font-size:70%;">
           Your task is to: heat some mug and put it in coffeemachine.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.5.3">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.5.3.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.5.3.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.5.3.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.5.3.1.1.1.1" style="font-size:70%;">
           &gt; go to countertop 1
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.6.4">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.6.4.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.6.4.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.6.4.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.6.4.1.1.1.1" style="font-size:70%;">
           On the countertop 1, you see a butterknife 1, a cup 1, a fork 2, and a mug 1.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.7.5">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.7.5.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.7.5.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.7.5.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.7.5.1.1.1.1" style="font-size:70%;">
           &gt; take mug 1 from countertop 1
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.8.6">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.8.6.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.8.6.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.8.6.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.8.6.1.1.1.1" style="font-size:70%;">
           You pick up the mug 1 from the countertop 1.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.9.7">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.9.7.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.9.7.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.9.7.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.9.7.1.1.1.1" style="font-size:70%;">
           &gt; go to stoveburner 1
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.10.8">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.10.8.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.10.8.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.10.8.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.10.8.1.1.1.1" style="font-size:70%;">
           On the stoveburner 1, you see a pan 2.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.11.9">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.11.9.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.11.9.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.11.9.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.11.9.1.1.1.1" style="font-size:70%;">
           &gt; examine stoveburner 1
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.12.10">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.12.10.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.12.10.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.12.10.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.12.10.1.1.1.1" style="font-size:70%;">
           On the stoveburner 1, you see a pan 2.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.13.11">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.13.11.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.13.11.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.13.11.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.13.11.1.1.1.1" style="font-size:70%;">
           &gt; examine stoveburner 1
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.14.12">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.14.12.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.14.12.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.14.12.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.14.12.1.1.1.1" style="font-size:70%;">
           On the stoveburner 1, you see a pan 2.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.15.13">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.15.13.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.15.13.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.15.13.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.15.13.1.1.1.1" style="font-size:70%;">
           &gt; examine stoveburner 1
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.16.14">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.16.14.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.16.14.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.16.14.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.16.14.1.1.1.1" style="font-size:70%;">
           On the stoveburner 1, you see a pan 2.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.17.15">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.17.15.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.17.15.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.17.15.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.17.15.1.1.1.1" style="font-size:70%;">
           &gt; examine stoveburner 1
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.18.16">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.18.16.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.18.16.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.18.16.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.18.16.1.1.1.1" style="font-size:70%;">
           On the stoveburner 1, you see a pan 2.
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.19.17">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.19.17.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.19.17.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.19.17.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.19.17.1.1.1.1" style="font-size:70%;">
           STATUS: FAIL
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.2">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.2.2">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.2.2.2">
         <span class="ltx_p" id="S6.5.2.2.2.2.2.2.2" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.5.2.2.2.2.2.2.2.3" style="font-size:70%;">
           retrospection
          </span>
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.2.2.2.2.4" style="font-size:70%;">
           : You were stuck in a loop in which you continually examined stoveburner 1 instead of heating mug 1 with stoveburner 1. You should have taken mug 1 from countertop 1, then heated it with stoveburner 1, then put it in coffeemachine 1. It did not help to execute two identical actions in a row. You will try to execute a different action if You am stuck in a loop again.
          </span>
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.5.2.2.2.2.2.2.2.2" style="font-size:70%;">
           } few-shot examples
           <math alttext="\times" class="ltx_Math" display="inline" id="S6.4.1.1.1.1.1.1.1.1.m1.1">
            <semantics id="S6.4.1.1.1.1.1.1.1.1.m1.1a">
             <mo id="S6.4.1.1.1.1.1.1.1.1.m1.1.1" xref="S6.4.1.1.1.1.1.1.1.1.m1.1.1.cmml">
              ×
             </mo>
             <annotation-xml encoding="MathML-Content" id="S6.4.1.1.1.1.1.1.1.1.m1.1b">
              <times id="S6.4.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S6.4.1.1.1.1.1.1.1.1.m1.1.1">
              </times>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.4.1.1.1.1.1.1.1.1.m1.1c">
              \times
             </annotation>
            </semantics>
           </math>
           <math alttext="\mathbf{n}" class="ltx_Math" display="inline" id="S6.5.2.2.2.2.2.2.2.2.m2.1">
            <semantics id="S6.5.2.2.2.2.2.2.2.2.m2.1a">
             <mi id="S6.5.2.2.2.2.2.2.2.2.m2.1.1" mathvariant="normal" xref="S6.5.2.2.2.2.2.2.2.2.m2.1.1.cmml">
              n
             </mi>
             <annotation-xml encoding="MathML-Content" id="S6.5.2.2.2.2.2.2.2.2.m2.1b">
              <ci id="S6.5.2.2.2.2.2.2.2.2.m2.1.1.cmml" xref="S6.5.2.2.2.2.2.2.2.2.m2.1.1">
               n
              </ci>
             </annotation-xml>
             <annotation encoding="application/x-tex" id="S6.5.2.2.2.2.2.2.2.2.m2.1c">
              \mathbf{n}
             </annotation>
            </semantics>
           </math>
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.20.18">
       <span class="ltx_td ltx_align_justify ltx_align_top" id="S6.5.2.2.2.20.18.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.20.18.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.20.18.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.5.2.2.2.20.18.1.1.1.1" style="font-size:70%;">
           current trial:
          </span>
          <span class="ltx_text ltx_font_typewriter" id="S6.5.2.2.2.20.18.1.1.1.2" style="font-size:70%;">
           ...
          </span>
         </span>
        </span>
       </span>
      </span>
      <span class="ltx_tr" id="S6.5.2.2.2.21.19">
       <span class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" id="S6.5.2.2.2.21.19.1">
        <span class="ltx_inline-block ltx_align_top" id="S6.5.2.2.2.21.19.1.1">
         <span class="ltx_p" id="S6.5.2.2.2.21.19.1.1.1" style="width:433.6pt;">
          <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S6.5.2.2.2.21.19.1.1.1.1" style="font-size:70%;">
           retrospection:
          </span>
         </span>
        </span>
       </span>
      </span>
     </span>
    </span>
    <span class="ltx_text ltx_font_typewriter ltx_align_center" id="S6.5.2.2.4" style="font-size:70%;">
    </span>
   </p>
  </figure>
 </section>
 <section class="ltx_section" id="S7">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    7
   </span>
   Parallel TextWorld
  </h2>
  <div class="ltx_para" id="S7.p1">
   <p class="ltx_p" id="S7.p1.1">
    While the idea of parallel TextWorld is heavily inspired by previous work
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib50" title="">
      <span class="ltx_text" style="font-size:90%;">
       50
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib51" title="">
      <span class="ltx_text" style="font-size:90%;">
       51
      </span>
     </a>
     ]
    </cite>
    , we have enhanced the TextWorld engine to create text-based equivalents of each visual environment for training and evaluating language-based agents. This enhancement involves utilizing a combination of the PDDL
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib1" title="">
      <span class="ltx_text" style="font-size:90%;">
       1
      </span>
     </a>
     ]
    </cite>
    and Fast Downward
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib18" title="">
      <span class="ltx_text" style="font-size:90%;">
       18
      </span>
     </a>
     ]
    </cite>
    to maintain and update the textual state of the simulated environments. Based on the metadata provided by the simulator, we represent a visual state as a list of attributes. These attributes detail the relationships among various entities in the environment, such as positions, goals, and objects. Note that all these attributes, variables, and rules are defined within the framework of PDDL.
   </p>
  </div>
 </section>
 <section class="ltx_section" id="S8">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    8
   </span>
   Training Details
  </h2>
  <div class="ltx_para" id="S8.p1">
   <p class="ltx_p" id="S8.p1.1">
    We provide hyperparameters used for training EMMA in Table
    <a class="ltx_ref" href="#S8.T1" title="Table 1 ‣ 8 Training Details ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
     <span class="ltx_text ltx_ref_tag">
      1
     </span>
    </a>
    . These hyperparameters are largely derived from those proposed for finetuning InstructBLIP model
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib8" title="">
      <span class="ltx_text" style="font-size:90%;">
       8
      </span>
     </a>
     ]
    </cite>
    . When training, we only update the parameters of linear projection layer while keeping other components frozen, as done during instruction tuning for many existing work
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib67" title="">
      <span class="ltx_text" style="font-size:90%;">
       67
      </span>
     </a>
     ,
     <a class="ltx_ref" href="#bib.bib14" title="">
      <span class="ltx_text" style="font-size:90%;">
       14
      </span>
     </a>
     ]
    </cite>
    . We use the AdamW optimizer
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib34" title="">
      <span class="ltx_text" style="font-size:90%;">
       34
      </span>
     </a>
     ]
    </cite>
    with a linear warmup of the learning rate, followed by a linear decay with a minimum learning rate of 0. Moreover, we remove the instruction input of Q-Former, which is used in InstructBLIP, and find this improves performance cross all experiments. Our implementation is heavily inspired by the LAVIS library
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib29" title="">
      <span class="ltx_text" style="font-size:90%;">
       29
      </span>
     </a>
     ]
    </cite>
    so the training and evaluation processes use the standard procedure provided by LAVIS.
   </p>
  </div>
  <figure class="ltx_table" id="S8.T1">
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_table">
     <span class="ltx_text" id="S8.T1.22.1.1" style="font-size:90%;">
      Table 1
     </span>
     :
    </span>
    <span class="ltx_text" id="S8.T1.23.2" style="font-size:90%;">
     Hyperparameters of EMMA for ALFWorld experiments
    </span>
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_align_middle" id="S8.T1.20.20">
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="S8.T1.20.20.21.1">
      <td class="ltx_td ltx_align_left ltx_border_tt" id="S8.T1.20.20.21.1.1">
       <span class="ltx_text ltx_font_bold" id="S8.T1.20.20.21.1.1.1" style="font-size:90%;">
        Hyperparameter
       </span>
      </td>
      <td class="ltx_td ltx_border_tt" id="S8.T1.20.20.21.1.2">
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="S8.T1.20.20.21.1.3">
       <span class="ltx_text ltx_font_bold" id="S8.T1.20.20.21.1.3.1" style="font-size:90%;">
        Value
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.22.2">
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S8.T1.20.20.22.2.1">
       <span class="ltx_text ltx_font_bold" id="S8.T1.20.20.22.2.1.1" style="font-size:90%;">
        EMMA’s Architecture
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.23.3">
      <td class="ltx_td ltx_align_left" id="S8.T1.20.20.23.3.1">
       <span class="ltx_text" id="S8.T1.20.20.23.3.1.1" style="font-size:90%;">
        LLM decoder
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.20.20.23.3.2">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.20.20.23.3.3">
       <span class="ltx_text" id="S8.T1.20.20.23.3.3.1" style="font-size:90%;">
        Vicuna-7b-v1.1
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S8.T1.20.20.23.3.3.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib66" title="">
         <span class="ltx_text" style="font-size:90%;">
          66
         </span>
        </a>
        <span class="ltx_text" id="S8.T1.20.20.23.3.3.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.24.4">
      <td class="ltx_td ltx_align_left" id="S8.T1.20.20.24.4.1">
       <span class="ltx_text" id="S8.T1.20.20.24.4.1.1" style="font-size:90%;">
        Image encoder
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.20.20.24.4.2">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.20.20.24.4.3">
       <span class="ltx_text" id="S8.T1.20.20.24.4.3.1" style="font-size:90%;">
        ViT-L
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S8.T1.20.20.24.4.3.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib42" title="">
         <span class="ltx_text" style="font-size:90%;">
          42
         </span>
        </a>
        <span class="ltx_text" id="S8.T1.20.20.24.4.3.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.1.1.1">
      <td class="ltx_td ltx_align_left" id="S8.T1.1.1.1.2">
       <span class="ltx_text" id="S8.T1.1.1.1.2.1" style="font-size:90%;">
        Q-Former
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.1.1.1.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.1.1.1.1">
       <math alttext="\text{BERT}_{\text{base}}" class="ltx_Math" display="inline" id="S8.T1.1.1.1.1.m1.1">
        <semantics id="S8.T1.1.1.1.1.m1.1a">
         <msub id="S8.T1.1.1.1.1.m1.1.1" xref="S8.T1.1.1.1.1.m1.1.1.cmml">
          <mtext id="S8.T1.1.1.1.1.m1.1.1.2" mathsize="90%" xref="S8.T1.1.1.1.1.m1.1.1.2a.cmml">
           BERT
          </mtext>
          <mtext id="S8.T1.1.1.1.1.m1.1.1.3" mathsize="90%" xref="S8.T1.1.1.1.1.m1.1.1.3a.cmml">
           base
          </mtext>
         </msub>
         <annotation-xml encoding="MathML-Content" id="S8.T1.1.1.1.1.m1.1b">
          <apply id="S8.T1.1.1.1.1.m1.1.1.cmml" xref="S8.T1.1.1.1.1.m1.1.1">
           <csymbol cd="ambiguous" id="S8.T1.1.1.1.1.m1.1.1.1.cmml" xref="S8.T1.1.1.1.1.m1.1.1">
            subscript
           </csymbol>
           <ci id="S8.T1.1.1.1.1.m1.1.1.2a.cmml" xref="S8.T1.1.1.1.1.m1.1.1.2">
            <mtext id="S8.T1.1.1.1.1.m1.1.1.2.cmml" mathsize="90%" xref="S8.T1.1.1.1.1.m1.1.1.2">
             BERT
            </mtext>
           </ci>
           <ci id="S8.T1.1.1.1.1.m1.1.1.3a.cmml" xref="S8.T1.1.1.1.1.m1.1.1.3">
            <mtext id="S8.T1.1.1.1.1.m1.1.1.3.cmml" mathsize="63%" xref="S8.T1.1.1.1.1.m1.1.1.3">
             base
            </mtext>
           </ci>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.1.1.1.1.m1.1c">
          \text{BERT}_{\text{base}}
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text" id="S8.T1.1.1.1.1.1" style="font-size:90%;">
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S8.T1.1.1.1.1.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib9" title="">
         <span class="ltx_text" style="font-size:90%;">
          9
         </span>
        </a>
        <span class="ltx_text" id="S8.T1.1.1.1.1.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.25.5">
      <td class="ltx_td ltx_align_left" id="S8.T1.20.20.25.5.1">
       <span class="ltx_text" id="S8.T1.20.20.25.5.1.1" style="font-size:90%;">
        Pretrained weights
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.20.20.25.5.2">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.20.20.25.5.3">
       <span class="ltx_text" id="S8.T1.20.20.25.5.3.1" style="font-size:90%;">
        InstructBLIP
       </span>
       <cite class="ltx_cite ltx_citemacro_citep">
        <span class="ltx_text" id="S8.T1.20.20.25.5.3.2.1" style="font-size:90%;">
         [
        </span>
        <a class="ltx_ref" href="#bib.bib8" title="">
         <span class="ltx_text" style="font-size:90%;">
          8
         </span>
        </a>
        <span class="ltx_text" id="S8.T1.20.20.25.5.3.3.2" style="font-size:90%;">
         ]
        </span>
       </cite>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.2.2.2">
      <td class="ltx_td ltx_align_left" id="S8.T1.2.2.2.2">
       <span class="ltx_text" id="S8.T1.2.2.2.2.1" style="font-size:90%;">
        Number of query tokens
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.2.2.2.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.2.2.2.1">
       <math alttext="32" class="ltx_Math" display="inline" id="S8.T1.2.2.2.1.m1.1">
        <semantics id="S8.T1.2.2.2.1.m1.1a">
         <mn id="S8.T1.2.2.2.1.m1.1.1" mathsize="90%" xref="S8.T1.2.2.2.1.m1.1.1.cmml">
          32
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.2.2.2.1.m1.1b">
          <cn id="S8.T1.2.2.2.1.m1.1.1.cmml" type="integer" xref="S8.T1.2.2.2.1.m1.1.1">
           32
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.2.2.2.1.m1.1c">
          32
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.26.6">
      <td class="ltx_td ltx_align_left" id="S8.T1.20.20.26.6.1">
       <span class="ltx_text" id="S8.T1.20.20.26.6.1.1" style="font-size:90%;">
        Q-Former text input
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.20.20.26.6.2">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.20.20.26.6.3">
       <span class="ltx_text" id="S8.T1.20.20.26.6.3.1" style="font-size:90%;">
        False
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.27.7">
      <td class="ltx_td ltx_align_left" id="S8.T1.20.20.27.7.1">
       <span class="ltx_text" id="S8.T1.20.20.27.7.1.1" style="font-size:90%;">
        Max text length
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.20.20.27.7.2">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.20.20.27.7.3">
       <span class="ltx_text" id="S8.T1.20.20.27.7.3.1" style="font-size:90%;">
        1024
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.28.8">
      <td class="ltx_td ltx_align_left" id="S8.T1.20.20.28.8.1">
       <span class="ltx_text" id="S8.T1.20.20.28.8.1.1" style="font-size:90%;">
        Image resolution
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.20.20.28.8.2">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.20.20.28.8.3">
       <span class="ltx_text" id="S8.T1.20.20.28.8.3.1" style="font-size:90%;">
        224
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.29.9">
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S8.T1.20.20.29.9.1">
       <span class="ltx_text ltx_font_bold" id="S8.T1.20.20.29.9.1.1" style="font-size:90%;">
        Behavior Cloning
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.3.3.3">
      <td class="ltx_td ltx_align_left" id="S8.T1.3.3.3.2">
       <span class="ltx_text" id="S8.T1.3.3.3.2.1" style="font-size:90%;">
        Finetuning epochs
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.3.3.3.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.3.3.3.1">
       <math alttext="6" class="ltx_Math" display="inline" id="S8.T1.3.3.3.1.m1.1">
        <semantics id="S8.T1.3.3.3.1.m1.1a">
         <mn id="S8.T1.3.3.3.1.m1.1.1" mathsize="90%" xref="S8.T1.3.3.3.1.m1.1.1.cmml">
          6
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.3.3.3.1.m1.1b">
          <cn id="S8.T1.3.3.3.1.m1.1.1.cmml" type="integer" xref="S8.T1.3.3.3.1.m1.1.1">
           6
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.3.3.3.1.m1.1c">
          6
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.4.4.4">
      <td class="ltx_td ltx_align_left" id="S8.T1.4.4.4.2">
       <span class="ltx_text" id="S8.T1.4.4.4.2.1" style="font-size:90%;">
        Warmup steps
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.4.4.4.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.4.4.4.1">
       <math alttext="1000" class="ltx_Math" display="inline" id="S8.T1.4.4.4.1.m1.1">
        <semantics id="S8.T1.4.4.4.1.m1.1a">
         <mn id="S8.T1.4.4.4.1.m1.1.1" mathsize="90%" xref="S8.T1.4.4.4.1.m1.1.1.cmml">
          1000
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.4.4.4.1.m1.1b">
          <cn id="S8.T1.4.4.4.1.m1.1.1.cmml" type="integer" xref="S8.T1.4.4.4.1.m1.1.1">
           1000
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.4.4.4.1.m1.1c">
          1000
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.5.5.5">
      <td class="ltx_td ltx_align_left" id="S8.T1.5.5.5.2">
       <span class="ltx_text" id="S8.T1.5.5.5.2.1" style="font-size:90%;">
        Learning rate
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.5.5.5.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.5.5.5.1">
       <math alttext="10^{-5}" class="ltx_Math" display="inline" id="S8.T1.5.5.5.1.m1.1">
        <semantics id="S8.T1.5.5.5.1.m1.1a">
         <msup id="S8.T1.5.5.5.1.m1.1.1" xref="S8.T1.5.5.5.1.m1.1.1.cmml">
          <mn id="S8.T1.5.5.5.1.m1.1.1.2" mathsize="90%" xref="S8.T1.5.5.5.1.m1.1.1.2.cmml">
           10
          </mn>
          <mrow id="S8.T1.5.5.5.1.m1.1.1.3" xref="S8.T1.5.5.5.1.m1.1.1.3.cmml">
           <mo id="S8.T1.5.5.5.1.m1.1.1.3a" mathsize="90%" xref="S8.T1.5.5.5.1.m1.1.1.3.cmml">
            −
           </mo>
           <mn id="S8.T1.5.5.5.1.m1.1.1.3.2" mathsize="90%" xref="S8.T1.5.5.5.1.m1.1.1.3.2.cmml">
            5
           </mn>
          </mrow>
         </msup>
         <annotation-xml encoding="MathML-Content" id="S8.T1.5.5.5.1.m1.1b">
          <apply id="S8.T1.5.5.5.1.m1.1.1.cmml" xref="S8.T1.5.5.5.1.m1.1.1">
           <csymbol cd="ambiguous" id="S8.T1.5.5.5.1.m1.1.1.1.cmml" xref="S8.T1.5.5.5.1.m1.1.1">
            superscript
           </csymbol>
           <cn id="S8.T1.5.5.5.1.m1.1.1.2.cmml" type="integer" xref="S8.T1.5.5.5.1.m1.1.1.2">
            10
           </cn>
           <apply id="S8.T1.5.5.5.1.m1.1.1.3.cmml" xref="S8.T1.5.5.5.1.m1.1.1.3">
            <minus id="S8.T1.5.5.5.1.m1.1.1.3.1.cmml" xref="S8.T1.5.5.5.1.m1.1.1.3">
            </minus>
            <cn id="S8.T1.5.5.5.1.m1.1.1.3.2.cmml" type="integer" xref="S8.T1.5.5.5.1.m1.1.1.3.2">
             5
            </cn>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.5.5.5.1.m1.1c">
          10^{-5}
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.6.6.6">
      <td class="ltx_td ltx_align_left" id="S8.T1.6.6.6.2">
       <span class="ltx_text" id="S8.T1.6.6.6.2.1" style="font-size:90%;">
        Batch size
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.6.6.6.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.6.6.6.1">
       <math alttext="128" class="ltx_Math" display="inline" id="S8.T1.6.6.6.1.m1.1">
        <semantics id="S8.T1.6.6.6.1.m1.1a">
         <mn id="S8.T1.6.6.6.1.m1.1.1" mathsize="90%" xref="S8.T1.6.6.6.1.m1.1.1.cmml">
          128
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.6.6.6.1.m1.1b">
          <cn id="S8.T1.6.6.6.1.m1.1.1.cmml" type="integer" xref="S8.T1.6.6.6.1.m1.1.1">
           128
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.6.6.6.1.m1.1c">
          128
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.8.8.8">
      <td class="ltx_td ltx_align_left" id="S8.T1.7.7.7.1">
       <span class="ltx_text" id="S8.T1.7.7.7.1.1" style="font-size:90%;">
        AdamW
       </span>
       <math alttext="\beta" class="ltx_Math" display="inline" id="S8.T1.7.7.7.1.m1.1">
        <semantics id="S8.T1.7.7.7.1.m1.1a">
         <mi id="S8.T1.7.7.7.1.m1.1.1" mathsize="90%" xref="S8.T1.7.7.7.1.m1.1.1.cmml">
          β
         </mi>
         <annotation-xml encoding="MathML-Content" id="S8.T1.7.7.7.1.m1.1b">
          <ci id="S8.T1.7.7.7.1.m1.1.1.cmml" xref="S8.T1.7.7.7.1.m1.1.1">
           𝛽
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.7.7.7.1.m1.1c">
          \beta
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td" id="S8.T1.8.8.8.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.8.8.8.2">
       <math alttext="(0.9,0.999)" class="ltx_Math" display="inline" id="S8.T1.8.8.8.2.m1.2">
        <semantics id="S8.T1.8.8.8.2.m1.2a">
         <mrow id="S8.T1.8.8.8.2.m1.2.3.2" xref="S8.T1.8.8.8.2.m1.2.3.1.cmml">
          <mo id="S8.T1.8.8.8.2.m1.2.3.2.1" maxsize="90%" minsize="90%" xref="S8.T1.8.8.8.2.m1.2.3.1.cmml">
           (
          </mo>
          <mn id="S8.T1.8.8.8.2.m1.1.1" mathsize="90%" xref="S8.T1.8.8.8.2.m1.1.1.cmml">
           0.9
          </mn>
          <mo id="S8.T1.8.8.8.2.m1.2.3.2.2" mathsize="90%" xref="S8.T1.8.8.8.2.m1.2.3.1.cmml">
           ,
          </mo>
          <mn id="S8.T1.8.8.8.2.m1.2.2" mathsize="90%" xref="S8.T1.8.8.8.2.m1.2.2.cmml">
           0.999
          </mn>
          <mo id="S8.T1.8.8.8.2.m1.2.3.2.3" maxsize="90%" minsize="90%" xref="S8.T1.8.8.8.2.m1.2.3.1.cmml">
           )
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S8.T1.8.8.8.2.m1.2b">
          <interval closure="open" id="S8.T1.8.8.8.2.m1.2.3.1.cmml" xref="S8.T1.8.8.8.2.m1.2.3.2">
           <cn id="S8.T1.8.8.8.2.m1.1.1.cmml" type="float" xref="S8.T1.8.8.8.2.m1.1.1">
            0.9
           </cn>
           <cn id="S8.T1.8.8.8.2.m1.2.2.cmml" type="float" xref="S8.T1.8.8.8.2.m1.2.2">
            0.999
           </cn>
          </interval>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.8.8.8.2.m1.2c">
          (0.9,0.999)
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.9.9.9">
      <td class="ltx_td ltx_align_left" id="S8.T1.9.9.9.2">
       <span class="ltx_text" id="S8.T1.9.9.9.2.1" style="font-size:90%;">
        Weight decay
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.9.9.9.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.9.9.9.1">
       <math alttext="0.05" class="ltx_Math" display="inline" id="S8.T1.9.9.9.1.m1.1">
        <semantics id="S8.T1.9.9.9.1.m1.1a">
         <mn id="S8.T1.9.9.9.1.m1.1.1" mathsize="90%" xref="S8.T1.9.9.9.1.m1.1.1.cmml">
          0.05
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.9.9.9.1.m1.1b">
          <cn id="S8.T1.9.9.9.1.m1.1.1.cmml" type="float" xref="S8.T1.9.9.9.1.m1.1.1">
           0.05
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.9.9.9.1.m1.1c">
          0.05
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.10.10.10">
      <td class="ltx_td ltx_align_left" id="S8.T1.10.10.10.2">
       <span class="ltx_text" id="S8.T1.10.10.10.2.1" style="font-size:90%;">
        Drop path
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.10.10.10.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.10.10.10.1">
       <math alttext="0" class="ltx_Math" display="inline" id="S8.T1.10.10.10.1.m1.1">
        <semantics id="S8.T1.10.10.10.1.m1.1a">
         <mn id="S8.T1.10.10.10.1.m1.1.1" mathsize="90%" xref="S8.T1.10.10.10.1.m1.1.1.cmml">
          0
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.10.10.10.1.m1.1b">
          <cn id="S8.T1.10.10.10.1.m1.1.1.cmml" type="integer" xref="S8.T1.10.10.10.1.m1.1.1">
           0
          </cn>
         </annotation-xml>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.11.11.11">
      <td class="ltx_td ltx_align_left" id="S8.T1.11.11.11.2">
       <span class="ltx_text" id="S8.T1.11.11.11.2.1" style="font-size:90%;">
        Inference beam size
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.11.11.11.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.11.11.11.1">
       <math alttext="5" class="ltx_Math" display="inline" id="S8.T1.11.11.11.1.m1.1">
        <semantics id="S8.T1.11.11.11.1.m1.1a">
         <mn id="S8.T1.11.11.11.1.m1.1.1" mathsize="90%" xref="S8.T1.11.11.11.1.m1.1.1.cmml">
          5
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.11.11.11.1.m1.1b">
          <cn id="S8.T1.11.11.11.1.m1.1.1.cmml" type="integer" xref="S8.T1.11.11.11.1.m1.1.1">
           5
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.11.11.11.1.m1.1c">
          5
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.30.10">
      <td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S8.T1.20.20.30.10.1">
       <span class="ltx_text ltx_font_bold" id="S8.T1.20.20.30.10.1.1" style="font-size:90%;">
        Imitation Learning
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.31.11">
      <td class="ltx_td ltx_align_left" id="S8.T1.20.20.31.11.1">
       <span class="ltx_text" id="S8.T1.20.20.31.11.1.1" style="font-size:90%;">
        Base model for LLM expert
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.20.20.31.11.2">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.20.20.31.11.3">
       <span class="ltx_text" id="S8.T1.20.20.31.11.3.1" style="font-size:90%;">
        text-davinci-003
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.32.12">
      <td class="ltx_td ltx_align_left" id="S8.T1.20.20.32.12.1">
       <span class="ltx_text" id="S8.T1.20.20.32.12.1.1" style="font-size:90%;">
        Prompts for LLM expert
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.20.20.32.12.2">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.20.20.32.12.3">
       <span class="ltx_text" id="S8.T1.20.20.32.12.3.1" style="font-size:90%;">
        refer to Sec.
       </span>
       <a class="ltx_ref" href="#S6" style="font-size:90%;" title="6 Full Prompts for LLM Expert ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
        <span class="ltx_text ltx_ref_tag">
         6
        </span>
       </a>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.12.12.12">
      <td class="ltx_td ltx_align_left" id="S8.T1.12.12.12.2">
       <span class="ltx_text" id="S8.T1.12.12.12.2.1" style="font-size:90%;">
        Number of trials
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.12.12.12.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.12.12.12.1">
       <math alttext="12" class="ltx_Math" display="inline" id="S8.T1.12.12.12.1.m1.1">
        <semantics id="S8.T1.12.12.12.1.m1.1a">
         <mn id="S8.T1.12.12.12.1.m1.1.1" mathsize="90%" xref="S8.T1.12.12.12.1.m1.1.1.cmml">
          12
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.12.12.12.1.m1.1b">
          <cn id="S8.T1.12.12.12.1.m1.1.1.cmml" type="integer" xref="S8.T1.12.12.12.1.m1.1.1">
           12
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.12.12.12.1.m1.1c">
          12
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.13.13.13">
      <td class="ltx_td ltx_align_left" id="S8.T1.13.13.13.2">
       <span class="ltx_text" id="S8.T1.13.13.13.2.1" style="font-size:90%;">
        Episode length
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.13.13.13.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.13.13.13.1">
       <math alttext="30" class="ltx_Math" display="inline" id="S8.T1.13.13.13.1.m1.1">
        <semantics id="S8.T1.13.13.13.1.m1.1a">
         <mn id="S8.T1.13.13.13.1.m1.1.1" mathsize="90%" xref="S8.T1.13.13.13.1.m1.1.1.cmml">
          30
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.13.13.13.1.m1.1b">
          <cn id="S8.T1.13.13.13.1.m1.1.1.cmml" type="integer" xref="S8.T1.13.13.13.1.m1.1.1">
           30
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.13.13.13.1.m1.1c">
          30
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.14.14.14">
      <td class="ltx_td ltx_align_left" id="S8.T1.14.14.14.2">
       <span class="ltx_text" id="S8.T1.14.14.14.2.1" style="font-size:90%;">
        Size of long-term memory
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.14.14.14.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.14.14.14.1">
       <math alttext="3" class="ltx_Math" display="inline" id="S8.T1.14.14.14.1.m1.1">
        <semantics id="S8.T1.14.14.14.1.m1.1a">
         <mn id="S8.T1.14.14.14.1.m1.1.1" mathsize="90%" xref="S8.T1.14.14.14.1.m1.1.1.cmml">
          3
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.14.14.14.1.m1.1b">
          <cn id="S8.T1.14.14.14.1.m1.1.1.cmml" type="integer" xref="S8.T1.14.14.14.1.m1.1.1">
           3
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.14.14.14.1.m1.1c">
          3
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.15.15.15">
      <td class="ltx_td ltx_align_left" id="S8.T1.15.15.15.2">
       <span class="ltx_text" id="S8.T1.15.15.15.2.1" style="font-size:90%;">
        Learning rate
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.15.15.15.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.15.15.15.1">
       <math alttext="5\times 10^{-6}" class="ltx_Math" display="inline" id="S8.T1.15.15.15.1.m1.1">
        <semantics id="S8.T1.15.15.15.1.m1.1a">
         <mrow id="S8.T1.15.15.15.1.m1.1.1" xref="S8.T1.15.15.15.1.m1.1.1.cmml">
          <mn id="S8.T1.15.15.15.1.m1.1.1.2" mathsize="90%" xref="S8.T1.15.15.15.1.m1.1.1.2.cmml">
           5
          </mn>
          <mo id="S8.T1.15.15.15.1.m1.1.1.1" lspace="0.222em" mathsize="90%" rspace="0.222em" xref="S8.T1.15.15.15.1.m1.1.1.1.cmml">
           ×
          </mo>
          <msup id="S8.T1.15.15.15.1.m1.1.1.3" xref="S8.T1.15.15.15.1.m1.1.1.3.cmml">
           <mn id="S8.T1.15.15.15.1.m1.1.1.3.2" mathsize="90%" xref="S8.T1.15.15.15.1.m1.1.1.3.2.cmml">
            10
           </mn>
           <mrow id="S8.T1.15.15.15.1.m1.1.1.3.3" xref="S8.T1.15.15.15.1.m1.1.1.3.3.cmml">
            <mo id="S8.T1.15.15.15.1.m1.1.1.3.3a" mathsize="90%" xref="S8.T1.15.15.15.1.m1.1.1.3.3.cmml">
             −
            </mo>
            <mn id="S8.T1.15.15.15.1.m1.1.1.3.3.2" mathsize="90%" xref="S8.T1.15.15.15.1.m1.1.1.3.3.2.cmml">
             6
            </mn>
           </mrow>
          </msup>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="S8.T1.15.15.15.1.m1.1b">
          <apply id="S8.T1.15.15.15.1.m1.1.1.cmml" xref="S8.T1.15.15.15.1.m1.1.1">
           <times id="S8.T1.15.15.15.1.m1.1.1.1.cmml" xref="S8.T1.15.15.15.1.m1.1.1.1">
           </times>
           <cn id="S8.T1.15.15.15.1.m1.1.1.2.cmml" type="integer" xref="S8.T1.15.15.15.1.m1.1.1.2">
            5
           </cn>
           <apply id="S8.T1.15.15.15.1.m1.1.1.3.cmml" xref="S8.T1.15.15.15.1.m1.1.1.3">
            <csymbol cd="ambiguous" id="S8.T1.15.15.15.1.m1.1.1.3.1.cmml" xref="S8.T1.15.15.15.1.m1.1.1.3">
             superscript
            </csymbol>
            <cn id="S8.T1.15.15.15.1.m1.1.1.3.2.cmml" type="integer" xref="S8.T1.15.15.15.1.m1.1.1.3.2">
             10
            </cn>
            <apply id="S8.T1.15.15.15.1.m1.1.1.3.3.cmml" xref="S8.T1.15.15.15.1.m1.1.1.3.3">
             <minus id="S8.T1.15.15.15.1.m1.1.1.3.3.1.cmml" xref="S8.T1.15.15.15.1.m1.1.1.3.3">
             </minus>
             <cn id="S8.T1.15.15.15.1.m1.1.1.3.3.2.cmml" type="integer" xref="S8.T1.15.15.15.1.m1.1.1.3.3.2">
              6
             </cn>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.15.15.15.1.m1.1c">
          5\times 10^{-6}
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.16.16.16">
      <td class="ltx_td ltx_align_left" id="S8.T1.16.16.16.2">
       <span class="ltx_text" id="S8.T1.16.16.16.2.1" style="font-size:90%;">
        Warmup steps
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.16.16.16.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.16.16.16.1">
       <math alttext="300" class="ltx_Math" display="inline" id="S8.T1.16.16.16.1.m1.1">
        <semantics id="S8.T1.16.16.16.1.m1.1a">
         <mn id="S8.T1.16.16.16.1.m1.1.1" mathsize="90%" xref="S8.T1.16.16.16.1.m1.1.1.cmml">
          300
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.16.16.16.1.m1.1b">
          <cn id="S8.T1.16.16.16.1.m1.1.1.cmml" type="integer" xref="S8.T1.16.16.16.1.m1.1.1">
           300
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.16.16.16.1.m1.1c">
          300
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.17.17.17">
      <td class="ltx_td ltx_align_left" id="S8.T1.17.17.17.2">
       <span class="ltx_text" id="S8.T1.17.17.17.2.1" style="font-size:90%;">
        Batch size
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.17.17.17.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.17.17.17.1">
       <math alttext="16" class="ltx_Math" display="inline" id="S8.T1.17.17.17.1.m1.1">
        <semantics id="S8.T1.17.17.17.1.m1.1a">
         <mn id="S8.T1.17.17.17.1.m1.1.1" mathsize="90%" xref="S8.T1.17.17.17.1.m1.1.1.cmml">
          16
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.17.17.17.1.m1.1b">
          <cn id="S8.T1.17.17.17.1.m1.1.1.cmml" type="integer" xref="S8.T1.17.17.17.1.m1.1.1">
           16
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.17.17.17.1.m1.1c">
          16
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.18.18.18">
      <td class="ltx_td ltx_align_left" id="S8.T1.18.18.18.2">
       <span class="ltx_text" id="S8.T1.18.18.18.2.1" style="font-size:90%;">
        Training epochs per trial
       </span>
      </td>
      <td class="ltx_td" id="S8.T1.18.18.18.3">
      </td>
      <td class="ltx_td ltx_align_center" id="S8.T1.18.18.18.1">
       <math alttext="5" class="ltx_Math" display="inline" id="S8.T1.18.18.18.1.m1.1">
        <semantics id="S8.T1.18.18.18.1.m1.1a">
         <mn id="S8.T1.18.18.18.1.m1.1.1" mathsize="90%" xref="S8.T1.18.18.18.1.m1.1.1.cmml">
          5
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.18.18.18.1.m1.1b">
          <cn id="S8.T1.18.18.18.1.m1.1.1.cmml" type="integer" xref="S8.T1.18.18.18.1.m1.1.1">
           5
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.18.18.18.1.m1.1c">
          5
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
     <tr class="ltx_tr" id="S8.T1.20.20.20">
      <td class="ltx_td ltx_align_left ltx_border_bb" id="S8.T1.19.19.19.1">
       <span class="ltx_text" id="S8.T1.19.19.19.1.1" style="font-size:90%;">
        DPO
       </span>
       <math alttext="\beta" class="ltx_Math" display="inline" id="S8.T1.19.19.19.1.m1.1">
        <semantics id="S8.T1.19.19.19.1.m1.1a">
         <mi id="S8.T1.19.19.19.1.m1.1.1" mathsize="90%" xref="S8.T1.19.19.19.1.m1.1.1.cmml">
          β
         </mi>
         <annotation-xml encoding="MathML-Content" id="S8.T1.19.19.19.1.m1.1b">
          <ci id="S8.T1.19.19.19.1.m1.1.1.cmml" xref="S8.T1.19.19.19.1.m1.1.1">
           𝛽
          </ci>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.19.19.19.1.m1.1c">
          \beta
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_border_bb" id="S8.T1.20.20.20.3">
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T1.20.20.20.2">
       <math alttext="0.1" class="ltx_Math" display="inline" id="S8.T1.20.20.20.2.m1.1">
        <semantics id="S8.T1.20.20.20.2.m1.1a">
         <mn id="S8.T1.20.20.20.2.m1.1.1" mathsize="90%" xref="S8.T1.20.20.20.2.m1.1.1.cmml">
          0.1
         </mn>
         <annotation-xml encoding="MathML-Content" id="S8.T1.20.20.20.2.m1.1b">
          <cn id="S8.T1.20.20.20.2.m1.1.1.cmml" type="float" xref="S8.T1.20.20.20.2.m1.1.1">
           0.1
          </cn>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="S8.T1.20.20.20.2.m1.1c">
          0.1
         </annotation>
        </semantics>
       </math>
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <figure class="ltx_figure" id="S8.F9">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="243" id="S8.F9.g1" src="/html/2311.16714/assets/x10.png" width="476"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S8.F9.3.1.1" style="font-size:90%;">
      Figure 9
     </span>
     :
    </span>
    <span class="ltx_text ltx_font_bold" id="S8.F9.4.2" style="font-size:90%;">
     Comparison of success rate between EMMA and the LLM expert.
     <span class="ltx_text ltx_font_medium" id="S8.F9.4.2.1">
      As the number of trials increases, the gap between the two agents decreases, and EMMA even outperforms or matches the expert in some tasks (e.g., “Heat and Place” and “Cool and Place”), indicating the effectiveness of cross-modality imitation learning.
     </span>
    </span>
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="S8.F10">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="243" id="S8.F10.g1" src="/html/2311.16714/assets/x11.png" width="476"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S8.F10.3.1.1" style="font-size:90%;">
      Figure 10
     </span>
     :
    </span>
    <span class="ltx_text ltx_font_bold" id="S8.F10.4.2" style="font-size:90%;">
     Ablation study.
     <span class="ltx_text ltx_font_medium" id="S8.F10.4.2.1">
      The performance of “EMMA w/o BC initialization” is consistently worse than the original EMMA.
     </span>
    </span>
   </figcaption>
  </figure>
  <figure class="ltx_figure" id="S8.F11">
   <img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="156" id="S8.F11.g1" src="/html/2311.16714/assets/x12.png" width="528"/>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     <span class="ltx_text" id="S8.F11.3.1.1" style="font-size:90%;">
      Figure 11
     </span>
     :
    </span>
    <span class="ltx_text ltx_font_bold" id="S8.F11.4.2" style="font-size:90%;">
     Vocabulary Distributions.
     <span class="ltx_text ltx_font_medium" id="S8.F11.4.2.1">
      Frequency distribution of all words for human-annotated and templated task instructions. The diversity of human-annotated instructions presents a significant challenge for the generalization abilities of agents.
     </span>
    </span>
   </figcaption>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_section" id="S9">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    9
   </span>
   Collection of Demonstration Dataset
  </h2>
  <div class="ltx_para" id="S9.p1">
   <p class="ltx_p" id="S9.p1.1">
    Fine-tuning pretrained VLMs on a pre-collected demonstration dataset via behavior cloning is a critical step, enabling these models to comprehend and follow the unique grammar of ALFWorld as well as to develop a basic “gamesense”.
However, the number of task instructions in the original ALFWorld
    <cite class="ltx_cite ltx_citemacro_citep">
     [
     <a class="ltx_ref" href="#bib.bib50" title="">
      <span class="ltx_text" style="font-size:90%;">
       50
      </span>
     </a>
     ]
    </cite>
    is too limited to yield sufficient data for fine-tuning these large pretrained VLMs effectively.
Hence, we propose an automated pipeline, which leverages
    <span class="ltx_text ltx_font_italic" id="S9.p1.1.1">
     text-davinci-003
    </span>
    and a rule-based planner to generate a large amount of new instructions and their resulting expert demonstrations, respectively.
   </p>
  </div>
  <div class="ltx_para" id="S9.p2">
   <p class="ltx_p" id="S9.p2.1">
    To generate a diverse set of new task instructions, we harness the in-context learning capabilities of LLM. Our procedure begins with extracting detailed descriptions from the ALFWorld benchmark for each environment, providing comprehensive information on the number and functional attributes of all items. Then, based on the types of room in these environments, we design different prompts that aim at inducing the LLM to generate task instructions aligned with the features of the target environment. An example of these prompts is detailed in Table
    <a class="ltx_ref" href="#S9.T2" title="Table 2 ‣ 9 Collection of Demonstration Dataset ‣ Embodied Multi-Modal Agent trained by an LLM from a Parallel TextWorld">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    .
For each generated task instruction, we gather demonstrations
    <math alttext="\{x_{\text{task}},s^{t}_{v},x^{t}_{a}\}_{t=0}^{T}" class="ltx_Math" display="inline" id="S9.p2.1.m1.3">
     <semantics id="S9.p2.1.m1.3a">
      <msubsup id="S9.p2.1.m1.3.3" xref="S9.p2.1.m1.3.3.cmml">
       <mrow id="S9.p2.1.m1.3.3.3.3.3" xref="S9.p2.1.m1.3.3.3.3.4.cmml">
        <mo id="S9.p2.1.m1.3.3.3.3.3.4" stretchy="false" xref="S9.p2.1.m1.3.3.3.3.4.cmml">
         {
        </mo>
        <msub id="S9.p2.1.m1.1.1.1.1.1.1" xref="S9.p2.1.m1.1.1.1.1.1.1.cmml">
         <mi id="S9.p2.1.m1.1.1.1.1.1.1.2" xref="S9.p2.1.m1.1.1.1.1.1.1.2.cmml">
          x
         </mi>
         <mtext id="S9.p2.1.m1.1.1.1.1.1.1.3" xref="S9.p2.1.m1.1.1.1.1.1.1.3a.cmml">
          task
         </mtext>
        </msub>
        <mo id="S9.p2.1.m1.3.3.3.3.3.5" xref="S9.p2.1.m1.3.3.3.3.4.cmml">
         ,
        </mo>
        <msubsup id="S9.p2.1.m1.2.2.2.2.2.2" xref="S9.p2.1.m1.2.2.2.2.2.2.cmml">
         <mi id="S9.p2.1.m1.2.2.2.2.2.2.2.2" xref="S9.p2.1.m1.2.2.2.2.2.2.2.2.cmml">
          s
         </mi>
         <mi id="S9.p2.1.m1.2.2.2.2.2.2.3" xref="S9.p2.1.m1.2.2.2.2.2.2.3.cmml">
          v
         </mi>
         <mi id="S9.p2.1.m1.2.2.2.2.2.2.2.3" xref="S9.p2.1.m1.2.2.2.2.2.2.2.3.cmml">
          t
         </mi>
        </msubsup>
        <mo id="S9.p2.1.m1.3.3.3.3.3.6" xref="S9.p2.1.m1.3.3.3.3.4.cmml">
         ,
        </mo>
        <msubsup id="S9.p2.1.m1.3.3.3.3.3.3" xref="S9.p2.1.m1.3.3.3.3.3.3.cmml">
         <mi id="S9.p2.1.m1.3.3.3.3.3.3.2.2" xref="S9.p2.1.m1.3.3.3.3.3.3.2.2.cmml">
          x
         </mi>
         <mi id="S9.p2.1.m1.3.3.3.3.3.3.3" xref="S9.p2.1.m1.3.3.3.3.3.3.3.cmml">
          a
         </mi>
         <mi id="S9.p2.1.m1.3.3.3.3.3.3.2.3" xref="S9.p2.1.m1.3.3.3.3.3.3.2.3.cmml">
          t
         </mi>
        </msubsup>
        <mo id="S9.p2.1.m1.3.3.3.3.3.7" stretchy="false" xref="S9.p2.1.m1.3.3.3.3.4.cmml">
         }
        </mo>
       </mrow>
       <mrow id="S9.p2.1.m1.3.3.3.5" xref="S9.p2.1.m1.3.3.3.5.cmml">
        <mi id="S9.p2.1.m1.3.3.3.5.2" xref="S9.p2.1.m1.3.3.3.5.2.cmml">
         t
        </mi>
        <mo id="S9.p2.1.m1.3.3.3.5.1" xref="S9.p2.1.m1.3.3.3.5.1.cmml">
         =
        </mo>
        <mn id="S9.p2.1.m1.3.3.3.5.3" xref="S9.p2.1.m1.3.3.3.5.3.cmml">
         0
        </mn>
       </mrow>
       <mi id="S9.p2.1.m1.3.3.5" xref="S9.p2.1.m1.3.3.5.cmml">
        T
       </mi>
      </msubsup>
      <annotation-xml encoding="MathML-Content" id="S9.p2.1.m1.3b">
       <apply id="S9.p2.1.m1.3.3.cmml" xref="S9.p2.1.m1.3.3">
        <csymbol cd="ambiguous" id="S9.p2.1.m1.3.3.4.cmml" xref="S9.p2.1.m1.3.3">
         superscript
        </csymbol>
        <apply id="S9.p2.1.m1.3.3.3.cmml" xref="S9.p2.1.m1.3.3">
         <csymbol cd="ambiguous" id="S9.p2.1.m1.3.3.3.4.cmml" xref="S9.p2.1.m1.3.3">
          subscript
         </csymbol>
         <set id="S9.p2.1.m1.3.3.3.3.4.cmml" xref="S9.p2.1.m1.3.3.3.3.3">
          <apply id="S9.p2.1.m1.1.1.1.1.1.1.cmml" xref="S9.p2.1.m1.1.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S9.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S9.p2.1.m1.1.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S9.p2.1.m1.1.1.1.1.1.1.2.cmml" xref="S9.p2.1.m1.1.1.1.1.1.1.2">
            𝑥
           </ci>
           <ci id="S9.p2.1.m1.1.1.1.1.1.1.3a.cmml" xref="S9.p2.1.m1.1.1.1.1.1.1.3">
            <mtext id="S9.p2.1.m1.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S9.p2.1.m1.1.1.1.1.1.1.3">
             task
            </mtext>
           </ci>
          </apply>
          <apply id="S9.p2.1.m1.2.2.2.2.2.2.cmml" xref="S9.p2.1.m1.2.2.2.2.2.2">
           <csymbol cd="ambiguous" id="S9.p2.1.m1.2.2.2.2.2.2.1.cmml" xref="S9.p2.1.m1.2.2.2.2.2.2">
            subscript
           </csymbol>
           <apply id="S9.p2.1.m1.2.2.2.2.2.2.2.cmml" xref="S9.p2.1.m1.2.2.2.2.2.2">
            <csymbol cd="ambiguous" id="S9.p2.1.m1.2.2.2.2.2.2.2.1.cmml" xref="S9.p2.1.m1.2.2.2.2.2.2">
             superscript
            </csymbol>
            <ci id="S9.p2.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S9.p2.1.m1.2.2.2.2.2.2.2.2">
             𝑠
            </ci>
            <ci id="S9.p2.1.m1.2.2.2.2.2.2.2.3.cmml" xref="S9.p2.1.m1.2.2.2.2.2.2.2.3">
             𝑡
            </ci>
           </apply>
           <ci id="S9.p2.1.m1.2.2.2.2.2.2.3.cmml" xref="S9.p2.1.m1.2.2.2.2.2.2.3">
            𝑣
           </ci>
          </apply>
          <apply id="S9.p2.1.m1.3.3.3.3.3.3.cmml" xref="S9.p2.1.m1.3.3.3.3.3.3">
           <csymbol cd="ambiguous" id="S9.p2.1.m1.3.3.3.3.3.3.1.cmml" xref="S9.p2.1.m1.3.3.3.3.3.3">
            subscript
           </csymbol>
           <apply id="S9.p2.1.m1.3.3.3.3.3.3.2.cmml" xref="S9.p2.1.m1.3.3.3.3.3.3">
            <csymbol cd="ambiguous" id="S9.p2.1.m1.3.3.3.3.3.3.2.1.cmml" xref="S9.p2.1.m1.3.3.3.3.3.3">
             superscript
            </csymbol>
            <ci id="S9.p2.1.m1.3.3.3.3.3.3.2.2.cmml" xref="S9.p2.1.m1.3.3.3.3.3.3.2.2">
             𝑥
            </ci>
            <ci id="S9.p2.1.m1.3.3.3.3.3.3.2.3.cmml" xref="S9.p2.1.m1.3.3.3.3.3.3.2.3">
             𝑡
            </ci>
           </apply>
           <ci id="S9.p2.1.m1.3.3.3.3.3.3.3.cmml" xref="S9.p2.1.m1.3.3.3.3.3.3.3">
            𝑎
           </ci>
          </apply>
         </set>
         <apply id="S9.p2.1.m1.3.3.3.5.cmml" xref="S9.p2.1.m1.3.3.3.5">
          <eq id="S9.p2.1.m1.3.3.3.5.1.cmml" xref="S9.p2.1.m1.3.3.3.5.1">
          </eq>
          <ci id="S9.p2.1.m1.3.3.3.5.2.cmml" xref="S9.p2.1.m1.3.3.3.5.2">
           𝑡
          </ci>
          <cn id="S9.p2.1.m1.3.3.3.5.3.cmml" type="integer" xref="S9.p2.1.m1.3.3.3.5.3">
           0
          </cn>
         </apply>
        </apply>
        <ci id="S9.p2.1.m1.3.3.5.cmml" xref="S9.p2.1.m1.3.3.5">
         𝑇
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S9.p2.1.m1.3c">
       \{x_{\text{task}},s^{t}_{v},x^{t}_{a}\}_{t=0}^{T}
      </annotation>
     </semantics>
    </math>
    using a rule-based planner devised by ALFWorld. It’s important to note that this planner operates with an unfair advantage: it considers the environment as fully observable and has complete information of world dynamics, relying on metadata that is not accessible to the agent during training. In summary, our dataset comprises 15247 expert demonstration episodes, amounting to 178585 image-text pairs.
   </p>
  </div>
  <figure class="ltx_table" id="S9.T2">
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_table">
     <span class="ltx_text" id="S9.T2.2.1.1" style="font-size:90%;">
      Table 2
     </span>
     :
    </span>
    <span class="ltx_text" id="S9.T2.3.2" style="font-size:90%;">
     An example of the prompt for generating new task instructions in the kitchen
    </span>
   </figcaption>
   <div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S9.T2.4" style="width:368.6pt;height:723.9pt;vertical-align:-0.0pt;">
    <span class="ltx_transformed_inner" style="transform:translate(-40.9pt,80.2pt) scale(0.818544441193568,0.818544441193568) ;">
     <table class="ltx_tabular ltx_align_middle" id="S9.T2.4.1">
      <tbody class="ltx_tbody">
       <tr class="ltx_tr" id="S9.T2.4.1.1.1">
        <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="S9.T2.4.1.1.1.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.1.1.1.1">
          <span class="ltx_p" id="S9.T2.4.1.1.1.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.1.1.1.1.1.1" style="font-size:70%;">
            Q:
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.2.2">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.2.2.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.2.2.1.1">
          <span class="ltx_p" id="S9.T2.4.1.2.2.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S9.T2.4.1.2.2.1.1.1.1" style="font-size:70%;">
            environment:
           </span>
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.2.2.1.1.1.2" style="font-size:70%;">
            You are in the middle of a room. Looking quickly around you, you see a cabinet, a countertop, a cabinet, a countertop, a drawer, a drawer, a drawer, a stoveburner, a stoveburner, a drawer, a stoveburner, a stoveburner, a cabinet, a cabinet, a microwave, a cabinet, a cabinet, a cabinet, a sink, a sinkbasin, a fridge, a toaster, a coffeemachine, a cabinet, a drawer, a drawer, a drawer, a drawer, a shelf, a shelf, a countertop, a shelf, a drawer, and a garbagecan.
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.3.3">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.3.3.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.3.3.1.1">
          <span class="ltx_p" id="S9.T2.4.1.3.3.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S9.T2.4.1.3.3.1.1.1.1" style="font-size:70%;">
            object dictionary:
           </span>
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.3.3.1.1.1.2" style="font-size:70%;">
            all of operable objects are listed in the following dictionary with a consistent format {type of operation: {object name: number of objects}}: {’pickupable’: {’dishsponge’: 3, ’apple’: 2, ’butterknife’: 3, ’peppershaker’: 2, ’saltshaker’: 3, ’bowl’: 2, ’spatula’: 2, ’pot’: 3, ’winebottle’: 3, ’statue’: 2, ’creditcard’: 3, ’plate’: 2, ’pan’: 2, ’kettle’: 3, ’soapbottle’: 3, ’potato’: 3, ’fork’: 2, ’bread’: 2, ’knife’: 3, ’glassbottle’: 3, ’book’: 1, ’tomato’: 1, ’vase’: 2, ’egg’: 1, ’papertowelroll’: 1, ’cup’: 1, ’lettuce’: 1, ’spoon’: 1, ’mug’: 1}, ’sliceable’: {’apple’: 2, ’potato’: 3, ’bread’: 2, ’tomato’: 1, ’egg’: 1, ’lettuce’: 1}, ’receptacle’: {’bowl’: 2, ’pot’: 3, ’plate’: 2, ’pan’: 2, ’stoveburner’: 4, ’drawer’: 9, ’countertop’: 3, ’cabinet’: 9, ’microwave’: 1, ’shelf’: 3, ’toaster’: 1, ’garbagecan’: 1, ’cup’: 1, ’fridge’: 1, ’coffeemachine’: 1, ’sinkbasin’: 1, ’mug’: 1}, ’canFillWithLiquid’: {’bowl’: 2, ’pot’: 3, ’winebottle’: 3, ’kettle’: 3, ’glassbottle’: 3, ’houseplant’: 1, ’cup’: 1, ’mug’: 1}, ’breakable’: {’bowl’: 2, ’winebottle’: 3, ’statue’: 2, ’plate’: 2, ’glassbottle’: 3, ’window’: 1, ’vase’: 2, ’egg’: 1, ’cup’: 1, ’mug’: 1}, ’dirtyable’: {’bowl’: 2, ’pot’: 3, ’plate’: 2, ’pan’: 2, ’cup’: 1, ’mug’: 1}, ’openable’: {’kettle’: 3, ’drawer’: 9, ’cabinet’: 9, ’book’: 1, ’microwave’: 1, ’fridge’: 1}, ’cookable’: {’potato’: 3}, ’toggleable’: {’stoveknob’: 4, ’microwave’: 1, ’toaster’: 1, ’coffeemachine’: 1, ’lightswitch’: 1, ’faucet’: 1}}
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.4.4">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.4.4.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.4.4.1.1">
          <span class="ltx_p" id="S9.T2.4.1.4.4.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S9.T2.4.1.4.4.1.1.1.1" style="font-size:70%;">
            generate 30 diverse tasks based on the environment description and object dictionary.
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.5.5">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.5.5.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.5.5.1.1">
          <span class="ltx_p" id="S9.T2.4.1.5.5.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.5.5.1.1.1.1" style="font-size:70%;">
            A:
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.6.6">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.6.6.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.6.6.1.1">
          <span class="ltx_p" id="S9.T2.4.1.6.6.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.6.6.1.1.1.1" style="font-size:70%;">
            Task 1: pick_clean_then_place_in_recep, put a clean pan in fridge
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.7.7">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.7.7.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.7.7.1.1">
          <span class="ltx_p" id="S9.T2.4.1.7.7.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.7.7.1.1.1.1" style="font-size:70%;">
            Task 2: pick_and_place_simple, put a apple in countertop
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.8.8">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.8.8.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.8.8.1.1">
          <span class="ltx_p" id="S9.T2.4.1.8.8.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.8.8.1.1.1.1" style="font-size:70%;">
            Task 3: pick_two_obj_and_place, put two apple in garbagecan
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.9.9">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.9.9.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.9.9.1.1">
          <span class="ltx_p" id="S9.T2.4.1.9.9.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.9.9.1.1.1.1" style="font-size:70%;">
            Task 4: pick_heat_then_place_in_recep, put a hot apple on plate
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.10.10">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.10.10.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.10.10.1.1">
          <span class="ltx_p" id="S9.T2.4.1.10.10.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.10.10.1.1.1.1" style="font-size:70%;">
            Task 5: pick_cool_then_place_in_recep, put a cool apple in countertop
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.11.11">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.11.11.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.11.11.1.1">
          <span class="ltx_p" id="S9.T2.4.1.11.11.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.11.11.1.1.1.1" style="font-size:70%;">
            Task 6: pick_and_place_simple, put a mug in coffeemachine
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.12.12">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.12.12.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.12.12.1.1">
          <span class="ltx_p" id="S9.T2.4.1.12.12.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.12.12.1.1.1.1" style="font-size:70%;">
            Task 7: pick_two_obj_and_place, put two creditcard in plate
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.13.13">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.13.13.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.13.13.1.1">
          <span class="ltx_p" id="S9.T2.4.1.13.13.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.13.13.1.1.1.1" style="font-size:70%;">
            Task 8: pick_clean_then_place_in_recep, put a clean mug in coffeemachine
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.14.14">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.14.14.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.14.14.1.1">
          <span class="ltx_p" id="S9.T2.4.1.14.14.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.14.14.1.1.1.1" style="font-size:70%;">
            Task 9: pick_heat_then_place_in_recep, put a hot mug on plate
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.15.15">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.15.15.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.15.15.1.1">
          <span class="ltx_p" id="S9.T2.4.1.15.15.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.15.15.1.1.1.1" style="font-size:70%;">
            Task 10: pick_cool_then_place_in_recep, put a cool mug in plate
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.16.16">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.16.16.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.16.16.1.1">
          <span class="ltx_p" id="S9.T2.4.1.16.16.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.16.16.1.1.1.1" style="font-size:70%;">
            Task 11: pick_and_place_simple, put a peppershaker in cabinet
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.17.17">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.17.17.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.17.17.1.1">
          <span class="ltx_p" id="S9.T2.4.1.17.17.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.17.17.1.1.1.1" style="font-size:70%;">
            Task 12: pick_two_obj_and_place, put two peppershaker in shelf
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.18.18">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.18.18.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.18.18.1.1">
          <span class="ltx_p" id="S9.T2.4.1.18.18.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.18.18.1.1.1.1" style="font-size:70%;">
            Task 13: pick_clean_then_place_in_recep, put a clean fork in pot
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.19.19">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.19.19.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.19.19.1.1">
          <span class="ltx_p" id="S9.T2.4.1.19.19.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.19.19.1.1.1.1" style="font-size:70%;">
            Task 14: pick_heat_then_place_in_recep, put a hot fork on bowl
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.20.20">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.20.20.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.20.20.1.1">
          <span class="ltx_p" id="S9.T2.4.1.20.20.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.20.20.1.1.1.1" style="font-size:70%;">
            Task 15: pick_cool_then_place_in_recep, put a cool fork in plate
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.21.21">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.21.21.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.21.21.1.1">
          <span class="ltx_p" id="S9.T2.4.1.21.21.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.21.21.1.1.1.1" style="font-size:70%;">
            Task 16: pick_and_place_simple, put a statue in countertop
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.22.22">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.22.22.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.22.22.1.1">
          <span class="ltx_p" id="S9.T2.4.1.22.22.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.22.22.1.1.1.1" style="font-size:70%;">
            Task 17: pick_two_obj_and_place, put two bowl in microwave
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.23.23">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.23.23.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.23.23.1.1">
          <span class="ltx_p" id="S9.T2.4.1.23.23.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.23.23.1.1.1.1" style="font-size:70%;">
            Task 18: pick_clean_then_place_in_recep, put a clean potato in fridge
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.24.24">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.24.24.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.24.24.1.1">
          <span class="ltx_p" id="S9.T2.4.1.24.24.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.24.24.1.1.1.1" style="font-size:70%;">
            Task 19: pick_heat_then_place_in_recep, put a hot potato on plate
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.25.25">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.25.25.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.25.25.1.1">
          <span class="ltx_p" id="S9.T2.4.1.25.25.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.25.25.1.1.1.1" style="font-size:70%;">
            Task 20: pick_cool_then_place_in_recep, put a cool potato in pot
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.26.26">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.26.26.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.26.26.1.1">
          <span class="ltx_p" id="S9.T2.4.1.26.26.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.26.26.1.1.1.1" style="font-size:70%;">
            Task 21: pick_and_place_simple, put a egg in countertop
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.27.27">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.27.27.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.27.27.1.1">
          <span class="ltx_p" id="S9.T2.4.1.27.27.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.27.27.1.1.1.1" style="font-size:70%;">
            Task 22: pick_two_obj_and_place, put two bread in microwave
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.28.28">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.28.28.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.28.28.1.1">
          <span class="ltx_p" id="S9.T2.4.1.28.28.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.28.28.1.1.1.1" style="font-size:70%;">
            Task 23: pick_clean_then_place_in_recep, put a clean egg in garbagecan
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.29.29">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.29.29.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.29.29.1.1">
          <span class="ltx_p" id="S9.T2.4.1.29.29.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.29.29.1.1.1.1" style="font-size:70%;">
            Task 24: pick_heat_then_place_in_recep, put a hot egg on bowl
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.30.30">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.30.30.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.30.30.1.1">
          <span class="ltx_p" id="S9.T2.4.1.30.30.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.30.30.1.1.1.1" style="font-size:70%;">
            Task 25: pick_cool_then_place_in_recep, put a cool egg in pan
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.31.31">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.31.31.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.31.31.1.1">
          <span class="ltx_p" id="S9.T2.4.1.31.31.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.31.31.1.1.1.1" style="font-size:70%;">
            Task 26: pick_and_place_simple, put a pan in stoveburner
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.32.32">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.32.32.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.32.32.1.1">
          <span class="ltx_p" id="S9.T2.4.1.32.32.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.32.32.1.1.1.1" style="font-size:70%;">
            Task 27: pick_two_obj_and_place, put two pot in stoveburner
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.33.33">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.33.33.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.33.33.1.1">
          <span class="ltx_p" id="S9.T2.4.1.33.33.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.33.33.1.1.1.1" style="font-size:70%;">
            Task 28: pick_clean_then_place_in_recep, put a clean tomato in coffeemachine
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.34.34">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.34.34.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.34.34.1.1">
          <span class="ltx_p" id="S9.T2.4.1.34.34.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.34.34.1.1.1.1" style="font-size:70%;">
            Task 29: pick_heat_then_place_in_recep, put a hot tomato on plate
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.35.35">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.35.35.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.35.35.1.1">
          <span class="ltx_p" id="S9.T2.4.1.35.35.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.35.35.1.1.1.1" style="font-size:70%;">
            Task 30: pick_cool_then_place_in_recep, put a cool tomato in plate
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.36.36">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.36.36.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.36.36.1.1">
          <span class="ltx_p" id="S9.T2.4.1.36.36.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.36.36.1.1.1.1" style="font-size:70%;">
            Q:
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.37.37">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.37.37.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.37.37.1.1">
          <span class="ltx_p" id="S9.T2.4.1.37.37.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S9.T2.4.1.37.37.1.1.1.1" style="font-size:70%;">
            environment:
           </span>
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.37.37.1.1.1.2" style="font-size:70%;">
            ...
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.38.38">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.38.38.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.38.38.1.1">
          <span class="ltx_p" id="S9.T2.4.1.38.38.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S9.T2.4.1.38.38.1.1.1.1" style="font-size:70%;">
            object dictionary:
           </span>
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.38.38.1.1.1.2" style="font-size:70%;">
            ...
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.39.39">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.39.39.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.39.39.1.1">
          <span class="ltx_p" id="S9.T2.4.1.39.39.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.39.39.1.1.1.1" style="font-size:70%;">
            generate 30 diverse tasks based on the environment description and object dictionary.
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.40.40">
        <td class="ltx_td ltx_align_justify ltx_align_top" id="S9.T2.4.1.40.40.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.40.40.1.1">
          <span class="ltx_p" id="S9.T2.4.1.40.40.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter" id="S9.T2.4.1.40.40.1.1.1.1" style="font-size:70%;">
            A:
           </span>
          </span>
         </span>
        </td>
       </tr>
       <tr class="ltx_tr" id="S9.T2.4.1.41.41">
        <td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" id="S9.T2.4.1.41.41.1">
         <span class="ltx_inline-block ltx_align_top" id="S9.T2.4.1.41.41.1.1">
          <span class="ltx_p" id="S9.T2.4.1.41.41.1.1.1" style="width:433.6pt;">
           <span class="ltx_text ltx_font_typewriter ltx_font_bold" id="S9.T2.4.1.41.41.1.1.1.1" style="font-size:70%;">
            ...LLM-generated task instructions...
           </span>
          </span>
         </span>
        </td>
       </tr>
      </tbody>
     </table>
    </span>
   </div>
  </figure>
 </section>
</article>
