<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2312.06454] Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images</title><meta property="og:description" content="Directly predicting human epidermal growth factor receptor 2 (HER2) status from widely available hematoxylin and eosin (HE)-stained whole slide images (WSIs) can reduce technical costs and expedite treatment selection.…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2312.06454">

<!--Generated on Tue Feb 27 14:10:37 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Bao Li<sup id="id1.1.id1" class="ltx_sup">1, 2</sup><span id="id2.2.id2" class="ltx_ERROR undefined">\equalcontrib</span>,
Zhenyu Liu<sup id="id3.3.id3" class="ltx_sup">2</sup><span id="id4.4.id4" class="ltx_ERROR undefined">\equalcontrib</span>,
Lizhi Shao<sup id="id5.5.id5" class="ltx_sup">2</sup>,
Bensheng Qiu<sup id="id6.6.id6" class="ltx_sup">1</sup>,
Hong Bu<sup id="id7.7.id7" class="ltx_sup">3</sup> ,
Jie Tian<sup id="id8.8.id8" class="ltx_sup">1, 2, 4</sup><span id="footnotex1" class="ltx_note ltx_role_footnotemark"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note">2</span></span></span></span>
<br class="ltx_break">
</span><span class="ltx_author_notes">Corresponding author.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id9.id1" class="ltx_p">Directly predicting human epidermal growth factor receptor 2 (HER2) status from widely available hematoxylin and eosin (HE)-stained whole slide images (WSIs) can reduce technical costs and expedite treatment selection. Accurately predicting HER2 requires large collections of multi-site WSIs. Federated learning enables collaborative training of these WSIs without gigabyte-size WSIs transportation and data privacy concerns. However, federated learning encounters challenges in addressing label imbalance in multi-site WSIs from the real world. Moreover, existing WSI classification methods cannot simultaneously exploit local context information and long-range dependencies in the site-end feature representation of federated learning. To address these issues, we present a point transformer with federated learning for multi-site HER2 status prediction from HE-stained WSIs. Our approach incorporates two novel designs. We propose a dynamic label distribution strategy and an auxiliary classifier, which helps to establish a well-initialized model and mitigate label distribution variations across sites. Additionally, we propose a farthest cosine sampling based on cosine distance. It can sample the most distinctive features and capture the long-range dependencies. Extensive experiments and analysis show that our method achieves state-of-the-art performance at four sites with a total of 2687 WSIs. Furthermore, we demonstrate that our model can generalize to two unseen sites with 229 WSIs. Code is available at: <span id="id9.id1.1" class="ltx_text">https://github.com/boyden/PointTransformerFL</span></p>
</div>
<figure id="S0.F1" class="ltx_figure"><img src="/html/2312.06454/assets/problem_illustrate.png" id="S0.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="1894" height="1107" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Local context information and long-range dependencies are
both essential for WSI analysis</figcaption>
</figure>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Introduction</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Hematoxylin and eosin (HE)-stained whole slide images (WSIs) are now being used beyond visible tasks by applying deep learning methods <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib28" title="" class="ltx_ref">2021</a>; Shao et al. <a href="#bib.bib37" title="" class="ltx_ref">2021</a>; Li et al. <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>. These images contain subtle molecular characteristics that can be inferred using deep learning <cite class="ltx_cite ltx_citemacro_citep">(Kather et al. <a href="#bib.bib18" title="" class="ltx_ref">2020</a>; Farahmand et al. <a href="#bib.bib6" title="" class="ltx_ref">2022</a>; Lu et al. <a href="#bib.bib29" title="" class="ltx_ref">2022c</a>)</cite>. In breast cancer, accurately predicting human epidermal growth factor receptor 2 (HER2) status is crucial for guiding anti-HER2 treatment decisions  <cite class="ltx_cite ltx_citemacro_citep">(Oh and Bang <a href="#bib.bib33" title="" class="ltx_ref">2019</a>)</cite>. Routinely, pathologists rely on HE-stained WSIs for breast cancer diagnosis, followed by specialized immunohistochemistry (IHC) and/or costly in-situ hybridization (ISH) techniques <cite class="ltx_cite ltx_citemacro_citep">(Wolff et al. <a href="#bib.bib43" title="" class="ltx_ref">2018</a>)</cite> to determine HER2 status. By utilizing deep learning, we can predict HER2 status from broadly accessible HE-stained WSIs without requiring IHC and/or ISH.</p>
</div>
<div id="Sx1.p2" class="ltx_para">
<p id="Sx1.p2.1" class="ltx_p">Achieving better WSI-level prediction requires large amounts of WSIs. Federated learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib30" title="" class="ltx_ref">2017</a>)</cite> has already exhibited promising progress in WSI analysis <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib27" title="" class="ltx_ref">2022b</a>; Jiang, Wang, and Dou <a href="#bib.bib16" title="" class="ltx_ref">2022</a>; Ogier du Terrail et al. <a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite>. It can incorporate a large amount of multi-site WSIs without actual transportation of gigabyte-size WSIs and reduce the risk of data leakage. However, real-world WSIs exist non-independent and identically distributed (non-i.i.d.) scenarios. For HER2 classification, labeling imbalance and varying histological specimen preparation at different sites can adversely affect the overall performance. Although many studies have addressed the non-i.i.d. challenges <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib14" title="" class="ltx_ref">2022</a>; Guan and Liu <a href="#bib.bib9" title="" class="ltx_ref">2023</a>; Zhuang and Lyu <a href="#bib.bib47" title="" class="ltx_ref">2023</a>)</cite> in natural scenes, these methods remain a major gap in real-world WSIs compared to centralized learning.</p>
</div>
<div id="Sx1.p3" class="ltx_para">
<p id="Sx1.p3.1" class="ltx_p">In the site-end feature representation, WSIs are cut into patches, and these patches’ local context information and long-range dependencies (as shown in Figure <a href="#S0.F1" title="Figure 1 ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) are essential for WSI-level prediction, such as HER2 prediction  <cite class="ltx_cite ltx_citemacro_citep">(Kather et al. <a href="#bib.bib18" title="" class="ltx_ref">2020</a>; Lu et al. <a href="#bib.bib29" title="" class="ltx_ref">2022c</a>)</cite> and survival analysis <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib3" title="" class="ltx_ref">2021b</a>; Shen et al. <a href="#bib.bib39" title="" class="ltx_ref">2022</a>; Shao et al. <a href="#bib.bib38" title="" class="ltx_ref">2023</a>)</cite>. For HER2 prediction, HER2-positive patches may cluster in many separate regions of WSIs. Existing deep learning methods either treat these patches as instances using multi-instance learning (MIL) methods  <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib28" title="" class="ltx_ref">2021</a>; Shao et al. <a href="#bib.bib37" title="" class="ltx_ref">2021</a>, <a href="#bib.bib38" title="" class="ltx_ref">2023</a>)</cite>, or structure the patches into a graph using graph neural networks (GNNs) <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib1" title="" class="ltx_ref">2021a</a>; Lu et al. <a href="#bib.bib29" title="" class="ltx_ref">2022c</a>; Hou et al. <a href="#bib.bib12" title="" class="ltx_ref">2022</a>)</cite>. However, the MIL-based methods lack the ability to model the local contextual information while the graph-based methods may struggle to capture long-distance dependence <cite class="ltx_cite ltx_citemacro_citep">(Xu et al. <a href="#bib.bib45" title="" class="ltx_ref">2018</a>)</cite> and need extra edge representation. Alternatively, the point neural network <cite class="ltx_cite ltx_citemacro_citep">(Qi et al. <a href="#bib.bib35" title="" class="ltx_ref">2017a</a>, <a href="#bib.bib36" title="" class="ltx_ref">b</a>)</cite> can treat each patch as a point with inherent position information in the Euclidean space, and hence effectively model the local context by considering the position information. Moreover, it is permutation invariant and has demonstrated proficiency in aggregating features and representing long-range dependencies <cite class="ltx_cite ltx_citemacro_citep">(Guo et al. <a href="#bib.bib10" title="" class="ltx_ref">2021</a>; Lu et al. <a href="#bib.bib26" title="" class="ltx_ref">2022a</a>)</cite>, making it well-suited for WSI analysis.</p>
</div>
<figure id="Sx1.F2" class="ltx_figure"><img src="/html/2312.06454/assets/point_transformer.png" id="Sx1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="628" height="418" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Overview of the point transformer for predicting HER2 status from whole slide images in a federated learning framework. 4<math id="Sx1.F2.5.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="Sx1.F2.5.m1.1b"><mo id="Sx1.F2.5.m1.1.1" xref="Sx1.F2.5.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx1.F2.5.m1.1c"><times id="Sx1.F2.5.m1.1.1.cmml" xref="Sx1.F2.5.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx1.F2.5.m1.1d">\times</annotation></semantics></math> represents that the corresponding blocks are repeated 4 times. In the <math id="Sx1.F2.6.m2.1" class="ltx_Math" alttext="i_{th}" display="inline"><semantics id="Sx1.F2.6.m2.1b"><msub id="Sx1.F2.6.m2.1.1" xref="Sx1.F2.6.m2.1.1.cmml"><mi id="Sx1.F2.6.m2.1.1.2" xref="Sx1.F2.6.m2.1.1.2.cmml">i</mi><mrow id="Sx1.F2.6.m2.1.1.3" xref="Sx1.F2.6.m2.1.1.3.cmml"><mi id="Sx1.F2.6.m2.1.1.3.2" xref="Sx1.F2.6.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx1.F2.6.m2.1.1.3.1" xref="Sx1.F2.6.m2.1.1.3.1.cmml">​</mo><mi id="Sx1.F2.6.m2.1.1.3.3" xref="Sx1.F2.6.m2.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx1.F2.6.m2.1c"><apply id="Sx1.F2.6.m2.1.1.cmml" xref="Sx1.F2.6.m2.1.1"><csymbol cd="ambiguous" id="Sx1.F2.6.m2.1.1.1.cmml" xref="Sx1.F2.6.m2.1.1">subscript</csymbol><ci id="Sx1.F2.6.m2.1.1.2.cmml" xref="Sx1.F2.6.m2.1.1.2">𝑖</ci><apply id="Sx1.F2.6.m2.1.1.3.cmml" xref="Sx1.F2.6.m2.1.1.3"><times id="Sx1.F2.6.m2.1.1.3.1.cmml" xref="Sx1.F2.6.m2.1.1.3.1"></times><ci id="Sx1.F2.6.m2.1.1.3.2.cmml" xref="Sx1.F2.6.m2.1.1.3.2">𝑡</ci><ci id="Sx1.F2.6.m2.1.1.3.3.cmml" xref="Sx1.F2.6.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx1.F2.6.m2.1d">i_{th}</annotation></semantics></math> block, the output shape of point features is <math id="Sx1.F2.7.m3.2" class="ltx_Math" alttext="(N/4^{i},32\times 2^{i})" display="inline"><semantics id="Sx1.F2.7.m3.2b"><mrow id="Sx1.F2.7.m3.2.2.2" xref="Sx1.F2.7.m3.2.2.3.cmml"><mo stretchy="false" id="Sx1.F2.7.m3.2.2.2.3" xref="Sx1.F2.7.m3.2.2.3.cmml">(</mo><mrow id="Sx1.F2.7.m3.1.1.1.1" xref="Sx1.F2.7.m3.1.1.1.1.cmml"><mi id="Sx1.F2.7.m3.1.1.1.1.2" xref="Sx1.F2.7.m3.1.1.1.1.2.cmml">N</mi><mo id="Sx1.F2.7.m3.1.1.1.1.1" xref="Sx1.F2.7.m3.1.1.1.1.1.cmml">/</mo><msup id="Sx1.F2.7.m3.1.1.1.1.3" xref="Sx1.F2.7.m3.1.1.1.1.3.cmml"><mn id="Sx1.F2.7.m3.1.1.1.1.3.2" xref="Sx1.F2.7.m3.1.1.1.1.3.2.cmml">4</mn><mi id="Sx1.F2.7.m3.1.1.1.1.3.3" xref="Sx1.F2.7.m3.1.1.1.1.3.3.cmml">i</mi></msup></mrow><mo id="Sx1.F2.7.m3.2.2.2.4" xref="Sx1.F2.7.m3.2.2.3.cmml">,</mo><mrow id="Sx1.F2.7.m3.2.2.2.2" xref="Sx1.F2.7.m3.2.2.2.2.cmml"><mn id="Sx1.F2.7.m3.2.2.2.2.2" xref="Sx1.F2.7.m3.2.2.2.2.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="Sx1.F2.7.m3.2.2.2.2.1" xref="Sx1.F2.7.m3.2.2.2.2.1.cmml">×</mo><msup id="Sx1.F2.7.m3.2.2.2.2.3" xref="Sx1.F2.7.m3.2.2.2.2.3.cmml"><mn id="Sx1.F2.7.m3.2.2.2.2.3.2" xref="Sx1.F2.7.m3.2.2.2.2.3.2.cmml">2</mn><mi id="Sx1.F2.7.m3.2.2.2.2.3.3" xref="Sx1.F2.7.m3.2.2.2.2.3.3.cmml">i</mi></msup></mrow><mo stretchy="false" id="Sx1.F2.7.m3.2.2.2.5" xref="Sx1.F2.7.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx1.F2.7.m3.2c"><interval closure="open" id="Sx1.F2.7.m3.2.2.3.cmml" xref="Sx1.F2.7.m3.2.2.2"><apply id="Sx1.F2.7.m3.1.1.1.1.cmml" xref="Sx1.F2.7.m3.1.1.1.1"><divide id="Sx1.F2.7.m3.1.1.1.1.1.cmml" xref="Sx1.F2.7.m3.1.1.1.1.1"></divide><ci id="Sx1.F2.7.m3.1.1.1.1.2.cmml" xref="Sx1.F2.7.m3.1.1.1.1.2">𝑁</ci><apply id="Sx1.F2.7.m3.1.1.1.1.3.cmml" xref="Sx1.F2.7.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx1.F2.7.m3.1.1.1.1.3.1.cmml" xref="Sx1.F2.7.m3.1.1.1.1.3">superscript</csymbol><cn type="integer" id="Sx1.F2.7.m3.1.1.1.1.3.2.cmml" xref="Sx1.F2.7.m3.1.1.1.1.3.2">4</cn><ci id="Sx1.F2.7.m3.1.1.1.1.3.3.cmml" xref="Sx1.F2.7.m3.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="Sx1.F2.7.m3.2.2.2.2.cmml" xref="Sx1.F2.7.m3.2.2.2.2"><times id="Sx1.F2.7.m3.2.2.2.2.1.cmml" xref="Sx1.F2.7.m3.2.2.2.2.1"></times><cn type="integer" id="Sx1.F2.7.m3.2.2.2.2.2.cmml" xref="Sx1.F2.7.m3.2.2.2.2.2">32</cn><apply id="Sx1.F2.7.m3.2.2.2.2.3.cmml" xref="Sx1.F2.7.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="Sx1.F2.7.m3.2.2.2.2.3.1.cmml" xref="Sx1.F2.7.m3.2.2.2.2.3">superscript</csymbol><cn type="integer" id="Sx1.F2.7.m3.2.2.2.2.3.2.cmml" xref="Sx1.F2.7.m3.2.2.2.2.3.2">2</cn><ci id="Sx1.F2.7.m3.2.2.2.2.3.3.cmml" xref="Sx1.F2.7.m3.2.2.2.2.3.3">𝑖</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="Sx1.F2.7.m3.2d">(N/4^{i},32\times 2^{i})</annotation></semantics></math> and <math id="Sx1.F2.8.m4.1" class="ltx_Math" alttext="N" display="inline"><semantics id="Sx1.F2.8.m4.1b"><mi id="Sx1.F2.8.m4.1.1" xref="Sx1.F2.8.m4.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="Sx1.F2.8.m4.1c"><ci id="Sx1.F2.8.m4.1.1.cmml" xref="Sx1.F2.8.m4.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx1.F2.8.m4.1d">N</annotation></semantics></math> represents the total point numbers and is set to 1024. FPN: feature pyramid network, GAP: global average pooling, MLP: multilayer perceptron.</figcaption>
</figure>
<div id="Sx1.p4" class="ltx_para">
<p id="Sx1.p4.1" class="ltx_p">In this paper, we introduce a PointTransformerDDA+ to represent both the local context and the long-range dependencies. Through the point transformer block, it can capture and aggregate the local information by employing attention mechanisms enriched with position information. We also propose a novel Farthest Cosine Sampling (FCS) to capture the long-range dependencies and gather the most distinctive features based on their cosine distance. To mitigate federated learning’s label-imbalance of multi-site, we present a dynamic distribution adjustment (DDA) method for a well-initialized model. It includes a distribution adjustment strategy and an auxiliary classifier. The DDA allows the resampling of labels to the same imbalance ratio initially and then dynamically adjust to the real imbalance ratio for each site without degrading the feature representation.</p>
</div>
<div id="Sx1.p5" class="ltx_para">
<p id="Sx1.p5.1" class="ltx_p">Our main contributions can be summarized as follows:</p>
<ul id="Sx1.I1" class="ltx_itemize">
<li id="Sx1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i1.p1" class="ltx_para">
<p id="Sx1.I1.i1.p1.1" class="ltx_p">Unlike MIL models or graph models, we pioneer the use of point transformer for WSI analysis, which effectively captures both local context and long-range dependencies.</p>
</div>
</li>
<li id="Sx1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i2.p1" class="ltx_para">
<p id="Sx1.I1.i2.p1.1" class="ltx_p">Our proposed FCS can capture the long-range dependencies, leading to the most distinct feature aggregation.</p>
</div>
</li>
<li id="Sx1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i3.p1" class="ltx_para">
<p id="Sx1.I1.i3.p1.1" class="ltx_p">The proposed DDA mitigates the multi-site class imbalance issue, thereby enhancing model generalization.</p>
</div>
</li>
<li id="Sx1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="Sx1.I1.i4.p1" class="ltx_para">
<p id="Sx1.I1.i4.p1.1" class="ltx_p">Extensive experiments on the largest WSI dataset to date for HER2 prediction in breast cancer demonstrate that our method achieves state-of-the-art performance in four sites (2687 WSIs) and two unseen sites (229 WSIs).</p>
</div>
</li>
</ul>
</div>
</section>
<section id="Sx2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Related Work</h2>

<div id="Sx2.p1" class="ltx_para">
<p id="Sx2.p1.1" class="ltx_p">In this section, we briefly review relevant works on WSI classification and federated learning in WSI analysis.</p>
</div>
<section id="Sx2.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Whole Slide Image Classification</h3>

<div id="Sx2.SSx1.p1" class="ltx_para">
<p id="Sx2.SSx1.p1.1" class="ltx_p">Recent works have used either MIL-based or graph-based methods for WSI classification, including molecular biomarkers such as HER2 status prediction <cite class="ltx_cite ltx_citemacro_citep">(Farahmand et al. <a href="#bib.bib6" title="" class="ltx_ref">2022</a>; Lu et al. <a href="#bib.bib29" title="" class="ltx_ref">2022c</a>)</cite>. The MIL-based methods commonly leverage attention mechanisms <cite class="ltx_cite ltx_citemacro_citep">(Ilse, Tomczak, and Welling <a href="#bib.bib15" title="" class="ltx_ref">2018</a>; Chen et al. <a href="#bib.bib2" title="" class="ltx_ref">2020</a>; Lu et al. <a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite> or transformers <cite class="ltx_cite ltx_citemacro_citep">(Shao et al. <a href="#bib.bib37" title="" class="ltx_ref">2021</a>; Shen et al. <a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite> to capture the long-distance dependence among instances. Regarding the local spatial relationship, DSMIL <cite class="ltx_cite ltx_citemacro_citep">(Li, Li, and Eliceiri <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite> simply extracts feature from different scales and concatenate them among scales, which do not consider the local information in a specific scale. TransMIL <cite class="ltx_cite ltx_citemacro_citep">(Shao et al. <a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite> models the spatial relationship among patches via transformers with conditional position encoding; however, the positions used are not based on the actual Euclidean space. Graph-based models <cite class="ltx_cite ltx_citemacro_citep">(Hamilton, Ying, and Leskovec <a href="#bib.bib11" title="" class="ltx_ref">2017</a>; Xu et al. <a href="#bib.bib44" title="" class="ltx_ref">2019</a>; Lee et al. <a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite> are intrinsically designed to capture local information by a graph structure. In WSI analysis, Patch-GCN <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib1" title="" class="ltx_ref">2021a</a>)</cite> regards patches as 2D point clouds while still employing GNN to analyze WSIs. SlideGraph+ <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib29" title="" class="ltx_ref">2022c</a>)</cite> also constructs a graph based on position information and uses edge convolution <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib42" title="" class="ltx_ref">2019</a>)</cite> to model local neighbor features, leading to a SOTA HER2 prediction performance. However, the long-term dependency may limit the further improvement of GNNs in WSI analysis. While the permutation-invariant point neural network <cite class="ltx_cite ltx_citemacro_citep">(Qi et al. <a href="#bib.bib36" title="" class="ltx_ref">2017b</a>; Zhao et al. <a href="#bib.bib46" title="" class="ltx_ref">2021</a>; Lu et al. <a href="#bib.bib26" title="" class="ltx_ref">2022a</a>)</cite> can capture both the local context and long-range dependencies, few studies have focused on WSI classification.</p>
</div>
</section>
<section id="Sx2.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Federated Learning in WSI Analysis</h3>

<div id="Sx2.SSx2.p1" class="ltx_para">
<p id="Sx2.SSx2.p1.1" class="ltx_p">Federated learning <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib30" title="" class="ltx_ref">2017</a>; Guan and Liu <a href="#bib.bib9" title="" class="ltx_ref">2023</a>)</cite> can facilitate the training of data-driven models using multi-site WSIs. HistFL <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib27" title="" class="ltx_ref">2022b</a>)</cite> collaborates multi-sites WSI with attention MIL model and differential privacy for cancer subtype and survival prediction. Also, TNBC-FL <cite class="ltx_cite ltx_citemacro_citep">(Ogier du Terrail et al. <a href="#bib.bib32" title="" class="ltx_ref">2023</a>)</cite> employs federated learning for predicting treatment outcomes in the rare subtype of breast cancer. However, general non-i.i.d. issues like skewed label distribution impedes the performance of federated learning. In natural scenes, several works replace batch normalization with group normalization <cite class="ltx_cite ltx_citemacro_citep">(Hsieh et al. <a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite>, layer normalization <cite class="ltx_cite ltx_citemacro_citep">(Du et al. <a href="#bib.bib5" title="" class="ltx_ref">2022</a>)</cite> or even remove the normalization layer <cite class="ltx_cite ltx_citemacro_citep">(Zhuang and Lyu <a href="#bib.bib47" title="" class="ltx_ref">2023</a>)</cite> to address the problems by reducing the external covariate shift. FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite> introduces a regularization function to guarantee robust convergence of model in non-i.i.d. data. Additionally, FedMGDA <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite> regards multi-site federated learning as a multi-objective optimization problem, aiming to converge to Pareto stationary solutions. With gradient normalization named FedMGDA+ <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite>, it can increase the model’s robustness. Despite the progress made in federated learning, there still remains a gap between federated learning and centralized learning in real WSIs and further improvements are still needed.</p>
</div>
</section>
</section>
<section id="Sx3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Methodology</h2>

<div id="Sx3.p1" class="ltx_para">
<p id="Sx3.p1.1" class="ltx_p">In this section, we start by introducing the problem definition of HER2 status prediction using a point transformer with federated learning. Then we describe the main components of the framework, including point feature extraction, point transformer block, point abstraction block, and federated learning with dynamic distribution adjustment. Figure <a href="#Sx1.F2" title="Figure 2 ‣ Introduction ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> illustrates the overall pipeline of our proposed framework.</p>
</div>
<section id="Sx3.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Preliminaries</h3>

<div id="Sx3.SSx1.p1" class="ltx_para">
<p id="Sx3.SSx1.p1.9" class="ltx_p">Suppose that we have <math id="Sx3.SSx1.p1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="Sx3.SSx1.p1.1.m1.1a"><mi id="Sx3.SSx1.p1.1.m1.1.1" xref="Sx3.SSx1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.1.m1.1b"><ci id="Sx3.SSx1.p1.1.m1.1.1.cmml" xref="Sx3.SSx1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.1.m1.1c">M</annotation></semantics></math> sites for HER2 status prediction, our goal is to accurately determine whether a given Whole Slide Image (WSI) is HER2-positive (HER2+) or HER2-negative (HER2-). For the <math id="Sx3.SSx1.p1.2.m2.1" class="ltx_Math" alttext="i_{th}" display="inline"><semantics id="Sx3.SSx1.p1.2.m2.1a"><msub id="Sx3.SSx1.p1.2.m2.1.1" xref="Sx3.SSx1.p1.2.m2.1.1.cmml"><mi id="Sx3.SSx1.p1.2.m2.1.1.2" xref="Sx3.SSx1.p1.2.m2.1.1.2.cmml">i</mi><mrow id="Sx3.SSx1.p1.2.m2.1.1.3" xref="Sx3.SSx1.p1.2.m2.1.1.3.cmml"><mi id="Sx3.SSx1.p1.2.m2.1.1.3.2" xref="Sx3.SSx1.p1.2.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.2.m2.1.1.3.1" xref="Sx3.SSx1.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.2.m2.1.1.3.3" xref="Sx3.SSx1.p1.2.m2.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.2.m2.1b"><apply id="Sx3.SSx1.p1.2.m2.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.2">𝑖</ci><apply id="Sx3.SSx1.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.3"><times id="Sx3.SSx1.p1.2.m2.1.1.3.1.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.3.1"></times><ci id="Sx3.SSx1.p1.2.m2.1.1.3.2.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.3.2">𝑡</ci><ci id="Sx3.SSx1.p1.2.m2.1.1.3.3.cmml" xref="Sx3.SSx1.p1.2.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.2.m2.1c">i_{th}</annotation></semantics></math> site, it contains a labeled point dataset <math id="Sx3.SSx1.p1.3.m3.4" class="ltx_Math" alttext="\mathcal{P}_{i}=\{(\mathcal{X}_{n},y_{n})\mid n\in(1,...,|\mathcal{P}_{i}|)\}" display="inline"><semantics id="Sx3.SSx1.p1.3.m3.4a"><mrow id="Sx3.SSx1.p1.3.m3.4.4" xref="Sx3.SSx1.p1.3.m3.4.4.cmml"><msub id="Sx3.SSx1.p1.3.m3.4.4.4" xref="Sx3.SSx1.p1.3.m3.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.3.m3.4.4.4.2" xref="Sx3.SSx1.p1.3.m3.4.4.4.2.cmml">𝒫</mi><mi id="Sx3.SSx1.p1.3.m3.4.4.4.3" xref="Sx3.SSx1.p1.3.m3.4.4.4.3.cmml">i</mi></msub><mo id="Sx3.SSx1.p1.3.m3.4.4.3" xref="Sx3.SSx1.p1.3.m3.4.4.3.cmml">=</mo><mrow id="Sx3.SSx1.p1.3.m3.4.4.2.2" xref="Sx3.SSx1.p1.3.m3.4.4.2.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.3.m3.4.4.2.2.3" xref="Sx3.SSx1.p1.3.m3.4.4.2.3.1.cmml">{</mo><mrow id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.3.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.3" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.3.cmml">(</mo><msub id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.2" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.2.cmml">𝒳</mi><mi id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.3" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.3.cmml">n</mi></msub><mo id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.4" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.3.cmml">,</mo><msub id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.cmml"><mi id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.2" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.2.cmml">y</mi><mi id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.3" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.5" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.3.cmml">)</mo></mrow><mo fence="true" lspace="0em" rspace="0em" id="Sx3.SSx1.p1.3.m3.4.4.2.2.4" xref="Sx3.SSx1.p1.3.m3.4.4.2.3.1.cmml">∣</mo><mrow id="Sx3.SSx1.p1.3.m3.4.4.2.2.2" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.cmml"><mi id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.3" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.3.cmml">n</mi><mo id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.2" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.2.cmml">∈</mo><mrow id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.2" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.2.cmml">(</mo><mn id="Sx3.SSx1.p1.3.m3.1.1" xref="Sx3.SSx1.p1.3.m3.1.1.cmml">1</mn><mo id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.3" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.2.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx1.p1.3.m3.2.2" xref="Sx3.SSx1.p1.3.m3.2.2.cmml">…</mi><mo id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.4" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.2.cmml">,</mo><mrow id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.2" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.2.1.cmml">|</mo><msub id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.2" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.2.cmml">𝒫</mi><mi id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.3" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.3" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.2.1.cmml">|</mo></mrow><mo stretchy="false" id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.5" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.SSx1.p1.3.m3.4.4.2.2.5" xref="Sx3.SSx1.p1.3.m3.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.3.m3.4b"><apply id="Sx3.SSx1.p1.3.m3.4.4.cmml" xref="Sx3.SSx1.p1.3.m3.4.4"><eq id="Sx3.SSx1.p1.3.m3.4.4.3.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.3"></eq><apply id="Sx3.SSx1.p1.3.m3.4.4.4.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.4"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.4.4.4.1.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.4">subscript</csymbol><ci id="Sx3.SSx1.p1.3.m3.4.4.4.2.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.4.2">𝒫</ci><ci id="Sx3.SSx1.p1.3.m3.4.4.4.3.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.4.3">𝑖</ci></apply><apply id="Sx3.SSx1.p1.3.m3.4.4.2.3.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2"><csymbol cd="latexml" id="Sx3.SSx1.p1.3.m3.4.4.2.3.1.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.3">conditional-set</csymbol><interval closure="open" id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.3.cmml" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2"><apply id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.2">𝒳</ci><ci id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.1.1.3">𝑛</ci></apply><apply id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.1.cmml" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.2">𝑦</ci><ci id="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.3.cmml" xref="Sx3.SSx1.p1.3.m3.3.3.1.1.1.2.2.3">𝑛</ci></apply></interval><apply id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2"><in id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.2"></in><ci id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.3.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.3">𝑛</ci><vector id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.2.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1"><cn type="integer" id="Sx3.SSx1.p1.3.m3.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.1.1">1</cn><ci id="Sx3.SSx1.p1.3.m3.2.2.cmml" xref="Sx3.SSx1.p1.3.m3.2.2">…</ci><apply id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.2.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1"><abs id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.2"></abs><apply id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.2">𝒫</ci><ci id="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.3.m3.4.4.2.2.2.1.1.1.1.1.3">𝑖</ci></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.3.m3.4c">\mathcal{P}_{i}=\{(\mathcal{X}_{n},y_{n})\mid n\in(1,...,|\mathcal{P}_{i}|)\}</annotation></semantics></math>, where <math id="Sx3.SSx1.p1.4.m4.2" class="ltx_Math" alttext="y_{n}\in\{0,1\}" display="inline"><semantics id="Sx3.SSx1.p1.4.m4.2a"><mrow id="Sx3.SSx1.p1.4.m4.2.3" xref="Sx3.SSx1.p1.4.m4.2.3.cmml"><msub id="Sx3.SSx1.p1.4.m4.2.3.2" xref="Sx3.SSx1.p1.4.m4.2.3.2.cmml"><mi id="Sx3.SSx1.p1.4.m4.2.3.2.2" xref="Sx3.SSx1.p1.4.m4.2.3.2.2.cmml">y</mi><mi id="Sx3.SSx1.p1.4.m4.2.3.2.3" xref="Sx3.SSx1.p1.4.m4.2.3.2.3.cmml">n</mi></msub><mo id="Sx3.SSx1.p1.4.m4.2.3.1" xref="Sx3.SSx1.p1.4.m4.2.3.1.cmml">∈</mo><mrow id="Sx3.SSx1.p1.4.m4.2.3.3.2" xref="Sx3.SSx1.p1.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.4.m4.2.3.3.2.1" xref="Sx3.SSx1.p1.4.m4.2.3.3.1.cmml">{</mo><mn id="Sx3.SSx1.p1.4.m4.1.1" xref="Sx3.SSx1.p1.4.m4.1.1.cmml">0</mn><mo id="Sx3.SSx1.p1.4.m4.2.3.3.2.2" xref="Sx3.SSx1.p1.4.m4.2.3.3.1.cmml">,</mo><mn id="Sx3.SSx1.p1.4.m4.2.2" xref="Sx3.SSx1.p1.4.m4.2.2.cmml">1</mn><mo stretchy="false" id="Sx3.SSx1.p1.4.m4.2.3.3.2.3" xref="Sx3.SSx1.p1.4.m4.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.4.m4.2b"><apply id="Sx3.SSx1.p1.4.m4.2.3.cmml" xref="Sx3.SSx1.p1.4.m4.2.3"><in id="Sx3.SSx1.p1.4.m4.2.3.1.cmml" xref="Sx3.SSx1.p1.4.m4.2.3.1"></in><apply id="Sx3.SSx1.p1.4.m4.2.3.2.cmml" xref="Sx3.SSx1.p1.4.m4.2.3.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.4.m4.2.3.2.1.cmml" xref="Sx3.SSx1.p1.4.m4.2.3.2">subscript</csymbol><ci id="Sx3.SSx1.p1.4.m4.2.3.2.2.cmml" xref="Sx3.SSx1.p1.4.m4.2.3.2.2">𝑦</ci><ci id="Sx3.SSx1.p1.4.m4.2.3.2.3.cmml" xref="Sx3.SSx1.p1.4.m4.2.3.2.3">𝑛</ci></apply><set id="Sx3.SSx1.p1.4.m4.2.3.3.1.cmml" xref="Sx3.SSx1.p1.4.m4.2.3.3.2"><cn type="integer" id="Sx3.SSx1.p1.4.m4.1.1.cmml" xref="Sx3.SSx1.p1.4.m4.1.1">0</cn><cn type="integer" id="Sx3.SSx1.p1.4.m4.2.2.cmml" xref="Sx3.SSx1.p1.4.m4.2.2">1</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.4.m4.2c">y_{n}\in\{0,1\}</annotation></semantics></math> is the corresponding HER2- and HER2+ status. Within this dataset, <math id="Sx3.SSx1.p1.5.m5.10" class="ltx_Math" alttext="\mathcal{X}_{n}=\{x_{n,1},x_{n,2},...,x_{n,|\mathcal{X}_{n}|}\}" display="inline"><semantics id="Sx3.SSx1.p1.5.m5.10a"><mrow id="Sx3.SSx1.p1.5.m5.10.10" xref="Sx3.SSx1.p1.5.m5.10.10.cmml"><msub id="Sx3.SSx1.p1.5.m5.10.10.5" xref="Sx3.SSx1.p1.5.m5.10.10.5.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.5.m5.10.10.5.2" xref="Sx3.SSx1.p1.5.m5.10.10.5.2.cmml">𝒳</mi><mi id="Sx3.SSx1.p1.5.m5.10.10.5.3" xref="Sx3.SSx1.p1.5.m5.10.10.5.3.cmml">n</mi></msub><mo id="Sx3.SSx1.p1.5.m5.10.10.4" xref="Sx3.SSx1.p1.5.m5.10.10.4.cmml">=</mo><mrow id="Sx3.SSx1.p1.5.m5.10.10.3.3" xref="Sx3.SSx1.p1.5.m5.10.10.3.4.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.5.m5.10.10.3.3.4" xref="Sx3.SSx1.p1.5.m5.10.10.3.4.cmml">{</mo><msub id="Sx3.SSx1.p1.5.m5.8.8.1.1.1" xref="Sx3.SSx1.p1.5.m5.8.8.1.1.1.cmml"><mi id="Sx3.SSx1.p1.5.m5.8.8.1.1.1.2" xref="Sx3.SSx1.p1.5.m5.8.8.1.1.1.2.cmml">x</mi><mrow id="Sx3.SSx1.p1.5.m5.2.2.2.4" xref="Sx3.SSx1.p1.5.m5.2.2.2.3.cmml"><mi id="Sx3.SSx1.p1.5.m5.1.1.1.1" xref="Sx3.SSx1.p1.5.m5.1.1.1.1.cmml">n</mi><mo id="Sx3.SSx1.p1.5.m5.2.2.2.4.1" xref="Sx3.SSx1.p1.5.m5.2.2.2.3.cmml">,</mo><mn id="Sx3.SSx1.p1.5.m5.2.2.2.2" xref="Sx3.SSx1.p1.5.m5.2.2.2.2.cmml">1</mn></mrow></msub><mo id="Sx3.SSx1.p1.5.m5.10.10.3.3.5" xref="Sx3.SSx1.p1.5.m5.10.10.3.4.cmml">,</mo><msub id="Sx3.SSx1.p1.5.m5.9.9.2.2.2" xref="Sx3.SSx1.p1.5.m5.9.9.2.2.2.cmml"><mi id="Sx3.SSx1.p1.5.m5.9.9.2.2.2.2" xref="Sx3.SSx1.p1.5.m5.9.9.2.2.2.2.cmml">x</mi><mrow id="Sx3.SSx1.p1.5.m5.4.4.2.4" xref="Sx3.SSx1.p1.5.m5.4.4.2.3.cmml"><mi id="Sx3.SSx1.p1.5.m5.3.3.1.1" xref="Sx3.SSx1.p1.5.m5.3.3.1.1.cmml">n</mi><mo id="Sx3.SSx1.p1.5.m5.4.4.2.4.1" xref="Sx3.SSx1.p1.5.m5.4.4.2.3.cmml">,</mo><mn id="Sx3.SSx1.p1.5.m5.4.4.2.2" xref="Sx3.SSx1.p1.5.m5.4.4.2.2.cmml">2</mn></mrow></msub><mo id="Sx3.SSx1.p1.5.m5.10.10.3.3.6" xref="Sx3.SSx1.p1.5.m5.10.10.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx1.p1.5.m5.7.7" xref="Sx3.SSx1.p1.5.m5.7.7.cmml">…</mi><mo id="Sx3.SSx1.p1.5.m5.10.10.3.3.7" xref="Sx3.SSx1.p1.5.m5.10.10.3.4.cmml">,</mo><msub id="Sx3.SSx1.p1.5.m5.10.10.3.3.3" xref="Sx3.SSx1.p1.5.m5.10.10.3.3.3.cmml"><mi id="Sx3.SSx1.p1.5.m5.10.10.3.3.3.2" xref="Sx3.SSx1.p1.5.m5.10.10.3.3.3.2.cmml">x</mi><mrow id="Sx3.SSx1.p1.5.m5.6.6.2.2" xref="Sx3.SSx1.p1.5.m5.6.6.2.3.cmml"><mi id="Sx3.SSx1.p1.5.m5.5.5.1.1" xref="Sx3.SSx1.p1.5.m5.5.5.1.1.cmml">n</mi><mo id="Sx3.SSx1.p1.5.m5.6.6.2.2.2" xref="Sx3.SSx1.p1.5.m5.6.6.2.3.cmml">,</mo><mrow id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.2" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.2.1.cmml">|</mo><msub id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.2" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.2.cmml">𝒳</mi><mi id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.3" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.3.cmml">n</mi></msub><mo stretchy="false" id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.3" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.2.1.cmml">|</mo></mrow></mrow></msub><mo stretchy="false" id="Sx3.SSx1.p1.5.m5.10.10.3.3.8" xref="Sx3.SSx1.p1.5.m5.10.10.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.5.m5.10b"><apply id="Sx3.SSx1.p1.5.m5.10.10.cmml" xref="Sx3.SSx1.p1.5.m5.10.10"><eq id="Sx3.SSx1.p1.5.m5.10.10.4.cmml" xref="Sx3.SSx1.p1.5.m5.10.10.4"></eq><apply id="Sx3.SSx1.p1.5.m5.10.10.5.cmml" xref="Sx3.SSx1.p1.5.m5.10.10.5"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.5.m5.10.10.5.1.cmml" xref="Sx3.SSx1.p1.5.m5.10.10.5">subscript</csymbol><ci id="Sx3.SSx1.p1.5.m5.10.10.5.2.cmml" xref="Sx3.SSx1.p1.5.m5.10.10.5.2">𝒳</ci><ci id="Sx3.SSx1.p1.5.m5.10.10.5.3.cmml" xref="Sx3.SSx1.p1.5.m5.10.10.5.3">𝑛</ci></apply><set id="Sx3.SSx1.p1.5.m5.10.10.3.4.cmml" xref="Sx3.SSx1.p1.5.m5.10.10.3.3"><apply id="Sx3.SSx1.p1.5.m5.8.8.1.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.8.8.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.5.m5.8.8.1.1.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.8.8.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.5.m5.8.8.1.1.1.2.cmml" xref="Sx3.SSx1.p1.5.m5.8.8.1.1.1.2">𝑥</ci><list id="Sx3.SSx1.p1.5.m5.2.2.2.3.cmml" xref="Sx3.SSx1.p1.5.m5.2.2.2.4"><ci id="Sx3.SSx1.p1.5.m5.1.1.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.1.1.1.1">𝑛</ci><cn type="integer" id="Sx3.SSx1.p1.5.m5.2.2.2.2.cmml" xref="Sx3.SSx1.p1.5.m5.2.2.2.2">1</cn></list></apply><apply id="Sx3.SSx1.p1.5.m5.9.9.2.2.2.cmml" xref="Sx3.SSx1.p1.5.m5.9.9.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.5.m5.9.9.2.2.2.1.cmml" xref="Sx3.SSx1.p1.5.m5.9.9.2.2.2">subscript</csymbol><ci id="Sx3.SSx1.p1.5.m5.9.9.2.2.2.2.cmml" xref="Sx3.SSx1.p1.5.m5.9.9.2.2.2.2">𝑥</ci><list id="Sx3.SSx1.p1.5.m5.4.4.2.3.cmml" xref="Sx3.SSx1.p1.5.m5.4.4.2.4"><ci id="Sx3.SSx1.p1.5.m5.3.3.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.3.3.1.1">𝑛</ci><cn type="integer" id="Sx3.SSx1.p1.5.m5.4.4.2.2.cmml" xref="Sx3.SSx1.p1.5.m5.4.4.2.2">2</cn></list></apply><ci id="Sx3.SSx1.p1.5.m5.7.7.cmml" xref="Sx3.SSx1.p1.5.m5.7.7">…</ci><apply id="Sx3.SSx1.p1.5.m5.10.10.3.3.3.cmml" xref="Sx3.SSx1.p1.5.m5.10.10.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.5.m5.10.10.3.3.3.1.cmml" xref="Sx3.SSx1.p1.5.m5.10.10.3.3.3">subscript</csymbol><ci id="Sx3.SSx1.p1.5.m5.10.10.3.3.3.2.cmml" xref="Sx3.SSx1.p1.5.m5.10.10.3.3.3.2">𝑥</ci><list id="Sx3.SSx1.p1.5.m5.6.6.2.3.cmml" xref="Sx3.SSx1.p1.5.m5.6.6.2.2"><ci id="Sx3.SSx1.p1.5.m5.5.5.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.5.5.1.1">𝑛</ci><apply id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.2.cmml" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1"><abs id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.2.1.cmml" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.2"></abs><apply id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.1.cmml" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.2.cmml" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.2">𝒳</ci><ci id="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.3.cmml" xref="Sx3.SSx1.p1.5.m5.6.6.2.2.1.1.1.3">𝑛</ci></apply></apply></list></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.5.m5.10c">\mathcal{X}_{n}=\{x_{n,1},x_{n,2},...,x_{n,|\mathcal{X}_{n}|}\}</annotation></semantics></math> represents a point set in the <math id="Sx3.SSx1.p1.6.m6.1" class="ltx_Math" alttext="n_{th}" display="inline"><semantics id="Sx3.SSx1.p1.6.m6.1a"><msub id="Sx3.SSx1.p1.6.m6.1.1" xref="Sx3.SSx1.p1.6.m6.1.1.cmml"><mi id="Sx3.SSx1.p1.6.m6.1.1.2" xref="Sx3.SSx1.p1.6.m6.1.1.2.cmml">n</mi><mrow id="Sx3.SSx1.p1.6.m6.1.1.3" xref="Sx3.SSx1.p1.6.m6.1.1.3.cmml"><mi id="Sx3.SSx1.p1.6.m6.1.1.3.2" xref="Sx3.SSx1.p1.6.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.6.m6.1.1.3.1" xref="Sx3.SSx1.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.6.m6.1.1.3.3" xref="Sx3.SSx1.p1.6.m6.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.6.m6.1b"><apply id="Sx3.SSx1.p1.6.m6.1.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.6.m6.1.1.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.6.m6.1.1.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.2">𝑛</ci><apply id="Sx3.SSx1.p1.6.m6.1.1.3.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.3"><times id="Sx3.SSx1.p1.6.m6.1.1.3.1.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.3.1"></times><ci id="Sx3.SSx1.p1.6.m6.1.1.3.2.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.3.2">𝑡</ci><ci id="Sx3.SSx1.p1.6.m6.1.1.3.3.cmml" xref="Sx3.SSx1.p1.6.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.6.m6.1c">n_{th}</annotation></semantics></math> whole slide images, where a point <math id="Sx3.SSx1.p1.7.m7.2" class="ltx_Math" alttext="x_{n,k}\in\mathbb{R}^{3+d}" display="inline"><semantics id="Sx3.SSx1.p1.7.m7.2a"><mrow id="Sx3.SSx1.p1.7.m7.2.3" xref="Sx3.SSx1.p1.7.m7.2.3.cmml"><msub id="Sx3.SSx1.p1.7.m7.2.3.2" xref="Sx3.SSx1.p1.7.m7.2.3.2.cmml"><mi id="Sx3.SSx1.p1.7.m7.2.3.2.2" xref="Sx3.SSx1.p1.7.m7.2.3.2.2.cmml">x</mi><mrow id="Sx3.SSx1.p1.7.m7.2.2.2.4" xref="Sx3.SSx1.p1.7.m7.2.2.2.3.cmml"><mi id="Sx3.SSx1.p1.7.m7.1.1.1.1" xref="Sx3.SSx1.p1.7.m7.1.1.1.1.cmml">n</mi><mo id="Sx3.SSx1.p1.7.m7.2.2.2.4.1" xref="Sx3.SSx1.p1.7.m7.2.2.2.3.cmml">,</mo><mi id="Sx3.SSx1.p1.7.m7.2.2.2.2" xref="Sx3.SSx1.p1.7.m7.2.2.2.2.cmml">k</mi></mrow></msub><mo id="Sx3.SSx1.p1.7.m7.2.3.1" xref="Sx3.SSx1.p1.7.m7.2.3.1.cmml">∈</mo><msup id="Sx3.SSx1.p1.7.m7.2.3.3" xref="Sx3.SSx1.p1.7.m7.2.3.3.cmml"><mi id="Sx3.SSx1.p1.7.m7.2.3.3.2" xref="Sx3.SSx1.p1.7.m7.2.3.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx1.p1.7.m7.2.3.3.3" xref="Sx3.SSx1.p1.7.m7.2.3.3.3.cmml"><mn id="Sx3.SSx1.p1.7.m7.2.3.3.3.2" xref="Sx3.SSx1.p1.7.m7.2.3.3.3.2.cmml">3</mn><mo id="Sx3.SSx1.p1.7.m7.2.3.3.3.1" xref="Sx3.SSx1.p1.7.m7.2.3.3.3.1.cmml">+</mo><mi id="Sx3.SSx1.p1.7.m7.2.3.3.3.3" xref="Sx3.SSx1.p1.7.m7.2.3.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.7.m7.2b"><apply id="Sx3.SSx1.p1.7.m7.2.3.cmml" xref="Sx3.SSx1.p1.7.m7.2.3"><in id="Sx3.SSx1.p1.7.m7.2.3.1.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.1"></in><apply id="Sx3.SSx1.p1.7.m7.2.3.2.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.7.m7.2.3.2.1.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.2">subscript</csymbol><ci id="Sx3.SSx1.p1.7.m7.2.3.2.2.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.2.2">𝑥</ci><list id="Sx3.SSx1.p1.7.m7.2.2.2.3.cmml" xref="Sx3.SSx1.p1.7.m7.2.2.2.4"><ci id="Sx3.SSx1.p1.7.m7.1.1.1.1.cmml" xref="Sx3.SSx1.p1.7.m7.1.1.1.1">𝑛</ci><ci id="Sx3.SSx1.p1.7.m7.2.2.2.2.cmml" xref="Sx3.SSx1.p1.7.m7.2.2.2.2">𝑘</ci></list></apply><apply id="Sx3.SSx1.p1.7.m7.2.3.3.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.7.m7.2.3.3.1.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.3">superscript</csymbol><ci id="Sx3.SSx1.p1.7.m7.2.3.3.2.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.3.2">ℝ</ci><apply id="Sx3.SSx1.p1.7.m7.2.3.3.3.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.3.3"><plus id="Sx3.SSx1.p1.7.m7.2.3.3.3.1.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.3.3.1"></plus><cn type="integer" id="Sx3.SSx1.p1.7.m7.2.3.3.3.2.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.3.3.2">3</cn><ci id="Sx3.SSx1.p1.7.m7.2.3.3.3.3.cmml" xref="Sx3.SSx1.p1.7.m7.2.3.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.7.m7.2c">x_{n,k}\in\mathbb{R}^{3+d}</annotation></semantics></math> is a feature vector with 3-dim coordinates and <math id="Sx3.SSx1.p1.8.m8.1" class="ltx_Math" alttext="d" display="inline"><semantics id="Sx3.SSx1.p1.8.m8.1a"><mi id="Sx3.SSx1.p1.8.m8.1.1" xref="Sx3.SSx1.p1.8.m8.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.8.m8.1b"><ci id="Sx3.SSx1.p1.8.m8.1.1.cmml" xref="Sx3.SSx1.p1.8.m8.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.8.m8.1c">d</annotation></semantics></math>-dim point features. To determine HER2+ status from a point set <math id="Sx3.SSx1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="Sx3.SSx1.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.9.m9.1.1" xref="Sx3.SSx1.p1.9.m9.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.9.m9.1b"><ci id="Sx3.SSx1.p1.9.m9.1.1.cmml" xref="Sx3.SSx1.p1.9.m9.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.9.m9.1c">\mathcal{X}</annotation></semantics></math> while considering data privacy, we employ federated learning to minimize the global cost over all sites:</p>
<table id="A5.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E1.m1.1" class="ltx_Math" alttext="\displaystyle\mathop{\arg\min}_{\mathbf{W}}\mathcal{L}(\mathbf{W})" display="inline"><semantics id="Sx3.E1.m1.1a"><mrow id="Sx3.E1.m1.1.2" xref="Sx3.E1.m1.1.2.cmml"><munder id="Sx3.E1.m1.1.2.1" xref="Sx3.E1.m1.1.2.1.cmml"><mrow id="Sx3.E1.m1.1.2.1.2" xref="Sx3.E1.m1.1.2.1.2.cmml"><mi id="Sx3.E1.m1.1.2.1.2.1" xref="Sx3.E1.m1.1.2.1.2.1.cmml">arg</mi><mo lspace="0.167em" id="Sx3.E1.m1.1.2.1.2a" xref="Sx3.E1.m1.1.2.1.2.cmml">⁡</mo><mi id="Sx3.E1.m1.1.2.1.2.2" xref="Sx3.E1.m1.1.2.1.2.2.cmml">min</mi></mrow><mi id="Sx3.E1.m1.1.2.1.3" xref="Sx3.E1.m1.1.2.1.3.cmml">𝐖</mi></munder><mrow id="Sx3.E1.m1.1.2.2" xref="Sx3.E1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E1.m1.1.2.2.2" xref="Sx3.E1.m1.1.2.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="Sx3.E1.m1.1.2.2.1" xref="Sx3.E1.m1.1.2.2.1.cmml">​</mo><mrow id="Sx3.E1.m1.1.2.2.3.2" xref="Sx3.E1.m1.1.2.2.cmml"><mo stretchy="false" id="Sx3.E1.m1.1.2.2.3.2.1" xref="Sx3.E1.m1.1.2.2.cmml">(</mo><mi id="Sx3.E1.m1.1.1" xref="Sx3.E1.m1.1.1.cmml">𝐖</mi><mo stretchy="false" id="Sx3.E1.m1.1.2.2.3.2.2" xref="Sx3.E1.m1.1.2.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E1.m1.1b"><apply id="Sx3.E1.m1.1.2.cmml" xref="Sx3.E1.m1.1.2"><apply id="Sx3.E1.m1.1.2.1.cmml" xref="Sx3.E1.m1.1.2.1"><csymbol cd="ambiguous" id="Sx3.E1.m1.1.2.1.1.cmml" xref="Sx3.E1.m1.1.2.1">subscript</csymbol><apply id="Sx3.E1.m1.1.2.1.2.cmml" xref="Sx3.E1.m1.1.2.1.2"><arg id="Sx3.E1.m1.1.2.1.2.1.cmml" xref="Sx3.E1.m1.1.2.1.2.1"></arg><min id="Sx3.E1.m1.1.2.1.2.2.cmml" xref="Sx3.E1.m1.1.2.1.2.2"></min></apply><ci id="Sx3.E1.m1.1.2.1.3.cmml" xref="Sx3.E1.m1.1.2.1.3">𝐖</ci></apply><apply id="Sx3.E1.m1.1.2.2.cmml" xref="Sx3.E1.m1.1.2.2"><times id="Sx3.E1.m1.1.2.2.1.cmml" xref="Sx3.E1.m1.1.2.2.1"></times><ci id="Sx3.E1.m1.1.2.2.2.cmml" xref="Sx3.E1.m1.1.2.2.2">ℒ</ci><ci id="Sx3.E1.m1.1.1.cmml" xref="Sx3.E1.m1.1.1">𝐖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1.m1.1c">\displaystyle\mathop{\arg\min}_{\mathbf{W}}\mathcal{L}(\mathbf{W})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E1.m2.4" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{M}\frac{|\mathcal{P}_{i}|}{|\mathcal{P}|}\mathcal{L}_{i}(\mathcal{P}_{i};\mathbf{W})," display="inline"><semantics id="Sx3.E1.m2.4a"><mrow id="Sx3.E1.m2.4.4.1" xref="Sx3.E1.m2.4.4.1.1.cmml"><mrow id="Sx3.E1.m2.4.4.1.1" xref="Sx3.E1.m2.4.4.1.1.cmml"><mi id="Sx3.E1.m2.4.4.1.1.3" xref="Sx3.E1.m2.4.4.1.1.3.cmml"></mi><mo id="Sx3.E1.m2.4.4.1.1.2" xref="Sx3.E1.m2.4.4.1.1.2.cmml">=</mo><mrow id="Sx3.E1.m2.4.4.1.1.1" xref="Sx3.E1.m2.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.E1.m2.4.4.1.1.1.2" xref="Sx3.E1.m2.4.4.1.1.1.2.cmml"><munderover id="Sx3.E1.m2.4.4.1.1.1.2a" xref="Sx3.E1.m2.4.4.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.E1.m2.4.4.1.1.1.2.2.2" xref="Sx3.E1.m2.4.4.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.E1.m2.4.4.1.1.1.2.2.3" xref="Sx3.E1.m2.4.4.1.1.1.2.2.3.cmml"><mi id="Sx3.E1.m2.4.4.1.1.1.2.2.3.2" xref="Sx3.E1.m2.4.4.1.1.1.2.2.3.2.cmml">i</mi><mo id="Sx3.E1.m2.4.4.1.1.1.2.2.3.1" xref="Sx3.E1.m2.4.4.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx3.E1.m2.4.4.1.1.1.2.2.3.3" xref="Sx3.E1.m2.4.4.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx3.E1.m2.4.4.1.1.1.2.3" xref="Sx3.E1.m2.4.4.1.1.1.2.3.cmml">M</mi></munderover></mstyle><mrow id="Sx3.E1.m2.4.4.1.1.1.1" xref="Sx3.E1.m2.4.4.1.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.E1.m2.2.2" xref="Sx3.E1.m2.2.2.cmml"><mfrac id="Sx3.E1.m2.2.2a" xref="Sx3.E1.m2.2.2.cmml"><mrow id="Sx3.E1.m2.1.1.1.1" xref="Sx3.E1.m2.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E1.m2.1.1.1.1.2" xref="Sx3.E1.m2.1.1.1.2.1.cmml">|</mo><msub id="Sx3.E1.m2.1.1.1.1.1" xref="Sx3.E1.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E1.m2.1.1.1.1.1.2" xref="Sx3.E1.m2.1.1.1.1.1.2.cmml">𝒫</mi><mi id="Sx3.E1.m2.1.1.1.1.1.3" xref="Sx3.E1.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E1.m2.1.1.1.1.3" xref="Sx3.E1.m2.1.1.1.2.1.cmml">|</mo></mrow><mrow id="Sx3.E1.m2.2.2.2.3" xref="Sx3.E1.m2.2.2.2.2.cmml"><mo stretchy="false" id="Sx3.E1.m2.2.2.2.3.1" xref="Sx3.E1.m2.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.E1.m2.2.2.2.1" xref="Sx3.E1.m2.2.2.2.1.cmml">𝒫</mi><mo stretchy="false" id="Sx3.E1.m2.2.2.2.3.2" xref="Sx3.E1.m2.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="Sx3.E1.m2.4.4.1.1.1.1.2" xref="Sx3.E1.m2.4.4.1.1.1.1.2.cmml">​</mo><msub id="Sx3.E1.m2.4.4.1.1.1.1.3" xref="Sx3.E1.m2.4.4.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E1.m2.4.4.1.1.1.1.3.2" xref="Sx3.E1.m2.4.4.1.1.1.1.3.2.cmml">ℒ</mi><mi id="Sx3.E1.m2.4.4.1.1.1.1.3.3" xref="Sx3.E1.m2.4.4.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E1.m2.4.4.1.1.1.1.2a" xref="Sx3.E1.m2.4.4.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E1.m2.4.4.1.1.1.1.1.1" xref="Sx3.E1.m2.4.4.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E1.m2.4.4.1.1.1.1.1.1.2" xref="Sx3.E1.m2.4.4.1.1.1.1.1.2.cmml">(</mo><msub id="Sx3.E1.m2.4.4.1.1.1.1.1.1.1" xref="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.2" xref="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.2.cmml">𝒫</mi><mi id="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.3" xref="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.E1.m2.4.4.1.1.1.1.1.1.3" xref="Sx3.E1.m2.4.4.1.1.1.1.1.2.cmml">;</mo><mi id="Sx3.E1.m2.3.3" xref="Sx3.E1.m2.3.3.cmml">𝐖</mi><mo stretchy="false" id="Sx3.E1.m2.4.4.1.1.1.1.1.1.4" xref="Sx3.E1.m2.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx3.E1.m2.4.4.1.2" xref="Sx3.E1.m2.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E1.m2.4b"><apply id="Sx3.E1.m2.4.4.1.1.cmml" xref="Sx3.E1.m2.4.4.1"><eq id="Sx3.E1.m2.4.4.1.1.2.cmml" xref="Sx3.E1.m2.4.4.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E1.m2.4.4.1.1.3.cmml" xref="Sx3.E1.m2.4.4.1.1.3">absent</csymbol><apply id="Sx3.E1.m2.4.4.1.1.1.cmml" xref="Sx3.E1.m2.4.4.1.1.1"><apply id="Sx3.E1.m2.4.4.1.1.1.2.cmml" xref="Sx3.E1.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E1.m2.4.4.1.1.1.2.1.cmml" xref="Sx3.E1.m2.4.4.1.1.1.2">superscript</csymbol><apply id="Sx3.E1.m2.4.4.1.1.1.2.2.cmml" xref="Sx3.E1.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E1.m2.4.4.1.1.1.2.2.1.cmml" xref="Sx3.E1.m2.4.4.1.1.1.2">subscript</csymbol><sum id="Sx3.E1.m2.4.4.1.1.1.2.2.2.cmml" xref="Sx3.E1.m2.4.4.1.1.1.2.2.2"></sum><apply id="Sx3.E1.m2.4.4.1.1.1.2.2.3.cmml" xref="Sx3.E1.m2.4.4.1.1.1.2.2.3"><eq id="Sx3.E1.m2.4.4.1.1.1.2.2.3.1.cmml" xref="Sx3.E1.m2.4.4.1.1.1.2.2.3.1"></eq><ci id="Sx3.E1.m2.4.4.1.1.1.2.2.3.2.cmml" xref="Sx3.E1.m2.4.4.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="Sx3.E1.m2.4.4.1.1.1.2.2.3.3.cmml" xref="Sx3.E1.m2.4.4.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="Sx3.E1.m2.4.4.1.1.1.2.3.cmml" xref="Sx3.E1.m2.4.4.1.1.1.2.3">𝑀</ci></apply><apply id="Sx3.E1.m2.4.4.1.1.1.1.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1"><times id="Sx3.E1.m2.4.4.1.1.1.1.2.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1.2"></times><apply id="Sx3.E1.m2.2.2.cmml" xref="Sx3.E1.m2.2.2"><divide id="Sx3.E1.m2.2.2.3.cmml" xref="Sx3.E1.m2.2.2"></divide><apply id="Sx3.E1.m2.1.1.1.2.cmml" xref="Sx3.E1.m2.1.1.1.1"><abs id="Sx3.E1.m2.1.1.1.2.1.cmml" xref="Sx3.E1.m2.1.1.1.1.2"></abs><apply id="Sx3.E1.m2.1.1.1.1.1.cmml" xref="Sx3.E1.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E1.m2.1.1.1.1.1.1.cmml" xref="Sx3.E1.m2.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E1.m2.1.1.1.1.1.2.cmml" xref="Sx3.E1.m2.1.1.1.1.1.2">𝒫</ci><ci id="Sx3.E1.m2.1.1.1.1.1.3.cmml" xref="Sx3.E1.m2.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="Sx3.E1.m2.2.2.2.2.cmml" xref="Sx3.E1.m2.2.2.2.3"><abs id="Sx3.E1.m2.2.2.2.2.1.cmml" xref="Sx3.E1.m2.2.2.2.3.1"></abs><ci id="Sx3.E1.m2.2.2.2.1.cmml" xref="Sx3.E1.m2.2.2.2.1">𝒫</ci></apply></apply><apply id="Sx3.E1.m2.4.4.1.1.1.1.3.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E1.m2.4.4.1.1.1.1.3.1.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E1.m2.4.4.1.1.1.1.3.2.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1.3.2">ℒ</ci><ci id="Sx3.E1.m2.4.4.1.1.1.1.3.3.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1.3.3">𝑖</ci></apply><list id="Sx3.E1.m2.4.4.1.1.1.1.1.2.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1.1.1"><apply id="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.2">𝒫</ci><ci id="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E1.m2.4.4.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="Sx3.E1.m2.3.3.cmml" xref="Sx3.E1.m2.3.3">𝐖</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E1.m2.4c">\displaystyle=\sum_{i=1}^{M}\frac{|\mathcal{P}_{i}|}{|\mathcal{P}|}\mathcal{L}_{i}(\mathcal{P}_{i};\mathbf{W}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx1.p1.11" class="ltx_p">where <math id="Sx3.SSx1.p1.10.m1.2" class="ltx_Math" alttext="|\mathcal{P}|=\sum_{i=1}^{M}|\mathcal{P}_{i}|" display="inline"><semantics id="Sx3.SSx1.p1.10.m1.2a"><mrow id="Sx3.SSx1.p1.10.m1.2.2" xref="Sx3.SSx1.p1.10.m1.2.2.cmml"><mrow id="Sx3.SSx1.p1.10.m1.2.2.3.2" xref="Sx3.SSx1.p1.10.m1.2.2.3.1.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.10.m1.2.2.3.2.1" xref="Sx3.SSx1.p1.10.m1.2.2.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.10.m1.1.1" xref="Sx3.SSx1.p1.10.m1.1.1.cmml">𝒫</mi><mo stretchy="false" id="Sx3.SSx1.p1.10.m1.2.2.3.2.2" xref="Sx3.SSx1.p1.10.m1.2.2.3.1.1.cmml">|</mo></mrow><mo rspace="0.111em" id="Sx3.SSx1.p1.10.m1.2.2.2" xref="Sx3.SSx1.p1.10.m1.2.2.2.cmml">=</mo><mrow id="Sx3.SSx1.p1.10.m1.2.2.1" xref="Sx3.SSx1.p1.10.m1.2.2.1.cmml"><msubsup id="Sx3.SSx1.p1.10.m1.2.2.1.2" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.cmml"><mo rspace="0em" id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.2" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.2.2.cmml">∑</mo><mrow id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.cmml"><mi id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.2" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.2.cmml">i</mi><mo id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.1" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.1.cmml">=</mo><mn id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.3" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="Sx3.SSx1.p1.10.m1.2.2.1.2.3" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.3.cmml">M</mi></msubsup><mrow id="Sx3.SSx1.p1.10.m1.2.2.1.1.1" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.10.m1.2.2.1.1.1.2" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.2.1.cmml">|</mo><msub id="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.2" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.2.cmml">𝒫</mi><mi id="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.3" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.SSx1.p1.10.m1.2.2.1.1.1.3" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.10.m1.2b"><apply id="Sx3.SSx1.p1.10.m1.2.2.cmml" xref="Sx3.SSx1.p1.10.m1.2.2"><eq id="Sx3.SSx1.p1.10.m1.2.2.2.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.2"></eq><apply id="Sx3.SSx1.p1.10.m1.2.2.3.1.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.3.2"><abs id="Sx3.SSx1.p1.10.m1.2.2.3.1.1.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.3.2.1"></abs><ci id="Sx3.SSx1.p1.10.m1.1.1.cmml" xref="Sx3.SSx1.p1.10.m1.1.1">𝒫</ci></apply><apply id="Sx3.SSx1.p1.10.m1.2.2.1.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1"><apply id="Sx3.SSx1.p1.10.m1.2.2.1.2.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.10.m1.2.2.1.2.1.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.2">superscript</csymbol><apply id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.1.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.2">subscript</csymbol><sum id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.2.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.2.2"></sum><apply id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3"><eq id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.1.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.1"></eq><ci id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.2.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.3.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.2.3.3">1</cn></apply></apply><ci id="Sx3.SSx1.p1.10.m1.2.2.1.2.3.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.2.3">𝑀</ci></apply><apply id="Sx3.SSx1.p1.10.m1.2.2.1.1.2.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.1"><abs id="Sx3.SSx1.p1.10.m1.2.2.1.1.2.1.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.1.2"></abs><apply id="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.2">𝒫</ci><ci id="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.10.m1.2.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.10.m1.2c">|\mathcal{P}|=\sum_{i=1}^{M}|\mathcal{P}_{i}|</annotation></semantics></math> is the total number of WSIs across all sites. For the <math id="Sx3.SSx1.p1.11.m2.1" class="ltx_Math" alttext="i_{th}" display="inline"><semantics id="Sx3.SSx1.p1.11.m2.1a"><msub id="Sx3.SSx1.p1.11.m2.1.1" xref="Sx3.SSx1.p1.11.m2.1.1.cmml"><mi id="Sx3.SSx1.p1.11.m2.1.1.2" xref="Sx3.SSx1.p1.11.m2.1.1.2.cmml">i</mi><mrow id="Sx3.SSx1.p1.11.m2.1.1.3" xref="Sx3.SSx1.p1.11.m2.1.1.3.cmml"><mi id="Sx3.SSx1.p1.11.m2.1.1.3.2" xref="Sx3.SSx1.p1.11.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.11.m2.1.1.3.1" xref="Sx3.SSx1.p1.11.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.11.m2.1.1.3.3" xref="Sx3.SSx1.p1.11.m2.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.11.m2.1b"><apply id="Sx3.SSx1.p1.11.m2.1.1.cmml" xref="Sx3.SSx1.p1.11.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.11.m2.1.1.1.cmml" xref="Sx3.SSx1.p1.11.m2.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.11.m2.1.1.2.cmml" xref="Sx3.SSx1.p1.11.m2.1.1.2">𝑖</ci><apply id="Sx3.SSx1.p1.11.m2.1.1.3.cmml" xref="Sx3.SSx1.p1.11.m2.1.1.3"><times id="Sx3.SSx1.p1.11.m2.1.1.3.1.cmml" xref="Sx3.SSx1.p1.11.m2.1.1.3.1"></times><ci id="Sx3.SSx1.p1.11.m2.1.1.3.2.cmml" xref="Sx3.SSx1.p1.11.m2.1.1.3.2">𝑡</ci><ci id="Sx3.SSx1.p1.11.m2.1.1.3.3.cmml" xref="Sx3.SSx1.p1.11.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.11.m2.1c">i_{th}</annotation></semantics></math> site, the cost can be calculated by:</p>
<table id="A5.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E2.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{i}(\mathcal{P}_{i};\mathbf{W})" display="inline"><semantics id="Sx3.E2.m1.2a"><mrow id="Sx3.E2.m1.2.2" xref="Sx3.E2.m1.2.2.cmml"><msub id="Sx3.E2.m1.2.2.3" xref="Sx3.E2.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E2.m1.2.2.3.2" xref="Sx3.E2.m1.2.2.3.2.cmml">ℒ</mi><mi id="Sx3.E2.m1.2.2.3.3" xref="Sx3.E2.m1.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E2.m1.2.2.2" xref="Sx3.E2.m1.2.2.2.cmml">​</mo><mrow id="Sx3.E2.m1.2.2.1.1" xref="Sx3.E2.m1.2.2.1.2.cmml"><mo stretchy="false" id="Sx3.E2.m1.2.2.1.1.2" xref="Sx3.E2.m1.2.2.1.2.cmml">(</mo><msub id="Sx3.E2.m1.2.2.1.1.1" xref="Sx3.E2.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E2.m1.2.2.1.1.1.2" xref="Sx3.E2.m1.2.2.1.1.1.2.cmml">𝒫</mi><mi id="Sx3.E2.m1.2.2.1.1.1.3" xref="Sx3.E2.m1.2.2.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.E2.m1.2.2.1.1.3" xref="Sx3.E2.m1.2.2.1.2.cmml">;</mo><mi id="Sx3.E2.m1.1.1" xref="Sx3.E2.m1.1.1.cmml">𝐖</mi><mo stretchy="false" id="Sx3.E2.m1.2.2.1.1.4" xref="Sx3.E2.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2.m1.2b"><apply id="Sx3.E2.m1.2.2.cmml" xref="Sx3.E2.m1.2.2"><times id="Sx3.E2.m1.2.2.2.cmml" xref="Sx3.E2.m1.2.2.2"></times><apply id="Sx3.E2.m1.2.2.3.cmml" xref="Sx3.E2.m1.2.2.3"><csymbol cd="ambiguous" id="Sx3.E2.m1.2.2.3.1.cmml" xref="Sx3.E2.m1.2.2.3">subscript</csymbol><ci id="Sx3.E2.m1.2.2.3.2.cmml" xref="Sx3.E2.m1.2.2.3.2">ℒ</ci><ci id="Sx3.E2.m1.2.2.3.3.cmml" xref="Sx3.E2.m1.2.2.3.3">𝑖</ci></apply><list id="Sx3.E2.m1.2.2.1.2.cmml" xref="Sx3.E2.m1.2.2.1.1"><apply id="Sx3.E2.m1.2.2.1.1.1.cmml" xref="Sx3.E2.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2.m1.2.2.1.1.1.1.cmml" xref="Sx3.E2.m1.2.2.1.1.1">subscript</csymbol><ci id="Sx3.E2.m1.2.2.1.1.1.2.cmml" xref="Sx3.E2.m1.2.2.1.1.1.2">𝒫</ci><ci id="Sx3.E2.m1.2.2.1.1.1.3.cmml" xref="Sx3.E2.m1.2.2.1.1.1.3">𝑖</ci></apply><ci id="Sx3.E2.m1.1.1.cmml" xref="Sx3.E2.m1.1.1">𝐖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2.m1.2c">\displaystyle\mathcal{L}_{i}(\mathcal{P}_{i};\mathbf{W})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E2.m2.5" class="ltx_Math" alttext="\displaystyle=\frac{1}{|\mathcal{P}_{i}|}\sum_{(\mathcal{X}_{k},y_{k})\in\mathcal{P}_{i}}\ell(f_{c}(f_{h}(\mathcal{X}_{k})),y_{k};\mathbf{W})," display="inline"><semantics id="Sx3.E2.m2.5a"><mrow id="Sx3.E2.m2.5.5.1" xref="Sx3.E2.m2.5.5.1.1.cmml"><mrow id="Sx3.E2.m2.5.5.1.1" xref="Sx3.E2.m2.5.5.1.1.cmml"><mi id="Sx3.E2.m2.5.5.1.1.4" xref="Sx3.E2.m2.5.5.1.1.4.cmml"></mi><mo id="Sx3.E2.m2.5.5.1.1.3" xref="Sx3.E2.m2.5.5.1.1.3.cmml">=</mo><mrow id="Sx3.E2.m2.5.5.1.1.2" xref="Sx3.E2.m2.5.5.1.1.2.cmml"><mstyle displaystyle="true" id="Sx3.E2.m2.1.1" xref="Sx3.E2.m2.1.1.cmml"><mfrac id="Sx3.E2.m2.1.1a" xref="Sx3.E2.m2.1.1.cmml"><mn id="Sx3.E2.m2.1.1.3" xref="Sx3.E2.m2.1.1.3.cmml">1</mn><mrow id="Sx3.E2.m2.1.1.1.1" xref="Sx3.E2.m2.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E2.m2.1.1.1.1.2" xref="Sx3.E2.m2.1.1.1.2.1.cmml">|</mo><msub id="Sx3.E2.m2.1.1.1.1.1" xref="Sx3.E2.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E2.m2.1.1.1.1.1.2" xref="Sx3.E2.m2.1.1.1.1.1.2.cmml">𝒫</mi><mi id="Sx3.E2.m2.1.1.1.1.1.3" xref="Sx3.E2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E2.m2.1.1.1.1.3" xref="Sx3.E2.m2.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="Sx3.E2.m2.5.5.1.1.2.3" xref="Sx3.E2.m2.5.5.1.1.2.3.cmml">​</mo><mrow id="Sx3.E2.m2.5.5.1.1.2.2" xref="Sx3.E2.m2.5.5.1.1.2.2.cmml"><mstyle displaystyle="true" id="Sx3.E2.m2.5.5.1.1.2.2.3" xref="Sx3.E2.m2.5.5.1.1.2.2.3.cmml"><munder id="Sx3.E2.m2.5.5.1.1.2.2.3a" xref="Sx3.E2.m2.5.5.1.1.2.2.3.cmml"><mo movablelimits="false" id="Sx3.E2.m2.5.5.1.1.2.2.3.2" xref="Sx3.E2.m2.5.5.1.1.2.2.3.2.cmml">∑</mo><mrow id="Sx3.E2.m2.3.3.2" xref="Sx3.E2.m2.3.3.2.cmml"><mrow id="Sx3.E2.m2.3.3.2.2.2" xref="Sx3.E2.m2.3.3.2.2.3.cmml"><mo stretchy="false" id="Sx3.E2.m2.3.3.2.2.2.3" xref="Sx3.E2.m2.3.3.2.2.3.cmml">(</mo><msub id="Sx3.E2.m2.2.2.1.1.1.1" xref="Sx3.E2.m2.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E2.m2.2.2.1.1.1.1.2" xref="Sx3.E2.m2.2.2.1.1.1.1.2.cmml">𝒳</mi><mi id="Sx3.E2.m2.2.2.1.1.1.1.3" xref="Sx3.E2.m2.2.2.1.1.1.1.3.cmml">k</mi></msub><mo id="Sx3.E2.m2.3.3.2.2.2.4" xref="Sx3.E2.m2.3.3.2.2.3.cmml">,</mo><msub id="Sx3.E2.m2.3.3.2.2.2.2" xref="Sx3.E2.m2.3.3.2.2.2.2.cmml"><mi id="Sx3.E2.m2.3.3.2.2.2.2.2" xref="Sx3.E2.m2.3.3.2.2.2.2.2.cmml">y</mi><mi id="Sx3.E2.m2.3.3.2.2.2.2.3" xref="Sx3.E2.m2.3.3.2.2.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="Sx3.E2.m2.3.3.2.2.2.5" xref="Sx3.E2.m2.3.3.2.2.3.cmml">)</mo></mrow><mo id="Sx3.E2.m2.3.3.2.3" xref="Sx3.E2.m2.3.3.2.3.cmml">∈</mo><msub id="Sx3.E2.m2.3.3.2.4" xref="Sx3.E2.m2.3.3.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E2.m2.3.3.2.4.2" xref="Sx3.E2.m2.3.3.2.4.2.cmml">𝒫</mi><mi id="Sx3.E2.m2.3.3.2.4.3" xref="Sx3.E2.m2.3.3.2.4.3.cmml">i</mi></msub></mrow></munder></mstyle><mrow id="Sx3.E2.m2.5.5.1.1.2.2.2" xref="Sx3.E2.m2.5.5.1.1.2.2.2.cmml"><mi mathvariant="normal" id="Sx3.E2.m2.5.5.1.1.2.2.2.4" xref="Sx3.E2.m2.5.5.1.1.2.2.2.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="Sx3.E2.m2.5.5.1.1.2.2.2.3" xref="Sx3.E2.m2.5.5.1.1.2.2.2.3.cmml">​</mo><mrow id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.3" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.3.cmml">(</mo><mrow id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.2" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒳</mi><mi id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.4" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.3.cmml">,</mo><msub id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.cmml"><mi id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.2" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.3" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.3.cmml">k</mi></msub><mo id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.5" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.3.cmml">;</mo><mi id="Sx3.E2.m2.4.4" xref="Sx3.E2.m2.4.4.cmml">𝐖</mi><mo stretchy="false" id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.6" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="Sx3.E2.m2.5.5.1.2" xref="Sx3.E2.m2.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E2.m2.5b"><apply id="Sx3.E2.m2.5.5.1.1.cmml" xref="Sx3.E2.m2.5.5.1"><eq id="Sx3.E2.m2.5.5.1.1.3.cmml" xref="Sx3.E2.m2.5.5.1.1.3"></eq><csymbol cd="latexml" id="Sx3.E2.m2.5.5.1.1.4.cmml" xref="Sx3.E2.m2.5.5.1.1.4">absent</csymbol><apply id="Sx3.E2.m2.5.5.1.1.2.cmml" xref="Sx3.E2.m2.5.5.1.1.2"><times id="Sx3.E2.m2.5.5.1.1.2.3.cmml" xref="Sx3.E2.m2.5.5.1.1.2.3"></times><apply id="Sx3.E2.m2.1.1.cmml" xref="Sx3.E2.m2.1.1"><divide id="Sx3.E2.m2.1.1.2.cmml" xref="Sx3.E2.m2.1.1"></divide><cn type="integer" id="Sx3.E2.m2.1.1.3.cmml" xref="Sx3.E2.m2.1.1.3">1</cn><apply id="Sx3.E2.m2.1.1.1.2.cmml" xref="Sx3.E2.m2.1.1.1.1"><abs id="Sx3.E2.m2.1.1.1.2.1.cmml" xref="Sx3.E2.m2.1.1.1.1.2"></abs><apply id="Sx3.E2.m2.1.1.1.1.1.cmml" xref="Sx3.E2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2.m2.1.1.1.1.1.1.cmml" xref="Sx3.E2.m2.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E2.m2.1.1.1.1.1.2.cmml" xref="Sx3.E2.m2.1.1.1.1.1.2">𝒫</ci><ci id="Sx3.E2.m2.1.1.1.1.1.3.cmml" xref="Sx3.E2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="Sx3.E2.m2.5.5.1.1.2.2.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2"><apply id="Sx3.E2.m2.5.5.1.1.2.2.3.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.3"><csymbol cd="ambiguous" id="Sx3.E2.m2.5.5.1.1.2.2.3.1.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.3">subscript</csymbol><sum id="Sx3.E2.m2.5.5.1.1.2.2.3.2.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.3.2"></sum><apply id="Sx3.E2.m2.3.3.2.cmml" xref="Sx3.E2.m2.3.3.2"><in id="Sx3.E2.m2.3.3.2.3.cmml" xref="Sx3.E2.m2.3.3.2.3"></in><interval closure="open" id="Sx3.E2.m2.3.3.2.2.3.cmml" xref="Sx3.E2.m2.3.3.2.2.2"><apply id="Sx3.E2.m2.2.2.1.1.1.1.cmml" xref="Sx3.E2.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2.m2.2.2.1.1.1.1.1.cmml" xref="Sx3.E2.m2.2.2.1.1.1.1">subscript</csymbol><ci id="Sx3.E2.m2.2.2.1.1.1.1.2.cmml" xref="Sx3.E2.m2.2.2.1.1.1.1.2">𝒳</ci><ci id="Sx3.E2.m2.2.2.1.1.1.1.3.cmml" xref="Sx3.E2.m2.2.2.1.1.1.1.3">𝑘</ci></apply><apply id="Sx3.E2.m2.3.3.2.2.2.2.cmml" xref="Sx3.E2.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E2.m2.3.3.2.2.2.2.1.cmml" xref="Sx3.E2.m2.3.3.2.2.2.2">subscript</csymbol><ci id="Sx3.E2.m2.3.3.2.2.2.2.2.cmml" xref="Sx3.E2.m2.3.3.2.2.2.2.2">𝑦</ci><ci id="Sx3.E2.m2.3.3.2.2.2.2.3.cmml" xref="Sx3.E2.m2.3.3.2.2.2.2.3">𝑘</ci></apply></interval><apply id="Sx3.E2.m2.3.3.2.4.cmml" xref="Sx3.E2.m2.3.3.2.4"><csymbol cd="ambiguous" id="Sx3.E2.m2.3.3.2.4.1.cmml" xref="Sx3.E2.m2.3.3.2.4">subscript</csymbol><ci id="Sx3.E2.m2.3.3.2.4.2.cmml" xref="Sx3.E2.m2.3.3.2.4.2">𝒫</ci><ci id="Sx3.E2.m2.3.3.2.4.3.cmml" xref="Sx3.E2.m2.3.3.2.4.3">𝑖</ci></apply></apply></apply><apply id="Sx3.E2.m2.5.5.1.1.2.2.2.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.2"><times id="Sx3.E2.m2.5.5.1.1.2.2.2.3.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.2.3"></times><ci id="Sx3.E2.m2.5.5.1.1.2.2.2.4.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.2.4">ℓ</ci><vector id="Sx3.E2.m2.5.5.1.1.2.2.2.2.3.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.2"><apply id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1"><times id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.2"></times><apply id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.3.3">𝑐</ci></apply><apply id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1"><times id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3">ℎ</ci></apply><apply id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝒳</ci><ci id="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E2.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply><apply id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.1.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.2.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.3.cmml" xref="Sx3.E2.m2.5.5.1.1.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="Sx3.E2.m2.4.4.cmml" xref="Sx3.E2.m2.4.4">𝐖</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E2.m2.5c">\displaystyle=\frac{1}{|\mathcal{P}_{i}|}\sum_{(\mathcal{X}_{k},y_{k})\in\mathcal{P}_{i}}\ell(f_{c}(f_{h}(\mathcal{X}_{k})),y_{k};\mathbf{W}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx1.p1.19" class="ltx_p">where <math id="Sx3.SSx1.p1.12.m1.1" class="ltx_Math" alttext="\ell" display="inline"><semantics id="Sx3.SSx1.p1.12.m1.1a"><mi mathvariant="normal" id="Sx3.SSx1.p1.12.m1.1.1" xref="Sx3.SSx1.p1.12.m1.1.1.cmml">ℓ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.12.m1.1b"><ci id="Sx3.SSx1.p1.12.m1.1.1.cmml" xref="Sx3.SSx1.p1.12.m1.1.1">ℓ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.12.m1.1c">\ell</annotation></semantics></math> is the loss function, <math id="Sx3.SSx1.p1.13.m2.1" class="ltx_Math" alttext="f_{h}:\mathcal{X}\mapsto\mathbb{R}^{d}" display="inline"><semantics id="Sx3.SSx1.p1.13.m2.1a"><mrow id="Sx3.SSx1.p1.13.m2.1.1" xref="Sx3.SSx1.p1.13.m2.1.1.cmml"><msub id="Sx3.SSx1.p1.13.m2.1.1.2" xref="Sx3.SSx1.p1.13.m2.1.1.2.cmml"><mi id="Sx3.SSx1.p1.13.m2.1.1.2.2" xref="Sx3.SSx1.p1.13.m2.1.1.2.2.cmml">f</mi><mi id="Sx3.SSx1.p1.13.m2.1.1.2.3" xref="Sx3.SSx1.p1.13.m2.1.1.2.3.cmml">h</mi></msub><mo lspace="0.278em" rspace="0.278em" id="Sx3.SSx1.p1.13.m2.1.1.1" xref="Sx3.SSx1.p1.13.m2.1.1.1.cmml">:</mo><mrow id="Sx3.SSx1.p1.13.m2.1.1.3" xref="Sx3.SSx1.p1.13.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.13.m2.1.1.3.2" xref="Sx3.SSx1.p1.13.m2.1.1.3.2.cmml">𝒳</mi><mo stretchy="false" id="Sx3.SSx1.p1.13.m2.1.1.3.1" xref="Sx3.SSx1.p1.13.m2.1.1.3.1.cmml">↦</mo><msup id="Sx3.SSx1.p1.13.m2.1.1.3.3" xref="Sx3.SSx1.p1.13.m2.1.1.3.3.cmml"><mi id="Sx3.SSx1.p1.13.m2.1.1.3.3.2" xref="Sx3.SSx1.p1.13.m2.1.1.3.3.2.cmml">ℝ</mi><mi id="Sx3.SSx1.p1.13.m2.1.1.3.3.3" xref="Sx3.SSx1.p1.13.m2.1.1.3.3.3.cmml">d</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.13.m2.1b"><apply id="Sx3.SSx1.p1.13.m2.1.1.cmml" xref="Sx3.SSx1.p1.13.m2.1.1"><ci id="Sx3.SSx1.p1.13.m2.1.1.1.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.1">:</ci><apply id="Sx3.SSx1.p1.13.m2.1.1.2.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.13.m2.1.1.2.1.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.2">subscript</csymbol><ci id="Sx3.SSx1.p1.13.m2.1.1.2.2.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.2.2">𝑓</ci><ci id="Sx3.SSx1.p1.13.m2.1.1.2.3.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.2.3">ℎ</ci></apply><apply id="Sx3.SSx1.p1.13.m2.1.1.3.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.3"><csymbol cd="latexml" id="Sx3.SSx1.p1.13.m2.1.1.3.1.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.3.1">maps-to</csymbol><ci id="Sx3.SSx1.p1.13.m2.1.1.3.2.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.3.2">𝒳</ci><apply id="Sx3.SSx1.p1.13.m2.1.1.3.3.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.13.m2.1.1.3.3.1.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.3.3">superscript</csymbol><ci id="Sx3.SSx1.p1.13.m2.1.1.3.3.2.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.3.3.2">ℝ</ci><ci id="Sx3.SSx1.p1.13.m2.1.1.3.3.3.cmml" xref="Sx3.SSx1.p1.13.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.13.m2.1c">f_{h}:\mathcal{X}\mapsto\mathbb{R}^{d}</annotation></semantics></math> is a point set embedding function, and <math id="Sx3.SSx1.p1.14.m3.1" class="ltx_Math" alttext="f_{c}:\mathcal{R}^{d}\mapsto\mathbb{R}" display="inline"><semantics id="Sx3.SSx1.p1.14.m3.1a"><mrow id="Sx3.SSx1.p1.14.m3.1.1" xref="Sx3.SSx1.p1.14.m3.1.1.cmml"><msub id="Sx3.SSx1.p1.14.m3.1.1.2" xref="Sx3.SSx1.p1.14.m3.1.1.2.cmml"><mi id="Sx3.SSx1.p1.14.m3.1.1.2.2" xref="Sx3.SSx1.p1.14.m3.1.1.2.2.cmml">f</mi><mi id="Sx3.SSx1.p1.14.m3.1.1.2.3" xref="Sx3.SSx1.p1.14.m3.1.1.2.3.cmml">c</mi></msub><mo lspace="0.278em" rspace="0.278em" id="Sx3.SSx1.p1.14.m3.1.1.1" xref="Sx3.SSx1.p1.14.m3.1.1.1.cmml">:</mo><mrow id="Sx3.SSx1.p1.14.m3.1.1.3" xref="Sx3.SSx1.p1.14.m3.1.1.3.cmml"><msup id="Sx3.SSx1.p1.14.m3.1.1.3.2" xref="Sx3.SSx1.p1.14.m3.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.14.m3.1.1.3.2.2" xref="Sx3.SSx1.p1.14.m3.1.1.3.2.2.cmml">ℛ</mi><mi id="Sx3.SSx1.p1.14.m3.1.1.3.2.3" xref="Sx3.SSx1.p1.14.m3.1.1.3.2.3.cmml">d</mi></msup><mo stretchy="false" id="Sx3.SSx1.p1.14.m3.1.1.3.1" xref="Sx3.SSx1.p1.14.m3.1.1.3.1.cmml">↦</mo><mi id="Sx3.SSx1.p1.14.m3.1.1.3.3" xref="Sx3.SSx1.p1.14.m3.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.14.m3.1b"><apply id="Sx3.SSx1.p1.14.m3.1.1.cmml" xref="Sx3.SSx1.p1.14.m3.1.1"><ci id="Sx3.SSx1.p1.14.m3.1.1.1.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.1">:</ci><apply id="Sx3.SSx1.p1.14.m3.1.1.2.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.14.m3.1.1.2.1.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.2">subscript</csymbol><ci id="Sx3.SSx1.p1.14.m3.1.1.2.2.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.2.2">𝑓</ci><ci id="Sx3.SSx1.p1.14.m3.1.1.2.3.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.2.3">𝑐</ci></apply><apply id="Sx3.SSx1.p1.14.m3.1.1.3.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.3"><csymbol cd="latexml" id="Sx3.SSx1.p1.14.m3.1.1.3.1.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.3.1">maps-to</csymbol><apply id="Sx3.SSx1.p1.14.m3.1.1.3.2.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.14.m3.1.1.3.2.1.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.3.2">superscript</csymbol><ci id="Sx3.SSx1.p1.14.m3.1.1.3.2.2.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.3.2.2">ℛ</ci><ci id="Sx3.SSx1.p1.14.m3.1.1.3.2.3.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.3.2.3">𝑑</ci></apply><ci id="Sx3.SSx1.p1.14.m3.1.1.3.3.cmml" xref="Sx3.SSx1.p1.14.m3.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.14.m3.1c">f_{c}:\mathcal{R}^{d}\mapsto\mathbb{R}</annotation></semantics></math> is the final classifier function. WSIs from real sites have a general non-independent and identically distributed (non-i.i.d. ) scenario where each site has different HER2 status distributions. For the <math id="Sx3.SSx1.p1.15.m4.1" class="ltx_Math" alttext="i_{th}" display="inline"><semantics id="Sx3.SSx1.p1.15.m4.1a"><msub id="Sx3.SSx1.p1.15.m4.1.1" xref="Sx3.SSx1.p1.15.m4.1.1.cmml"><mi id="Sx3.SSx1.p1.15.m4.1.1.2" xref="Sx3.SSx1.p1.15.m4.1.1.2.cmml">i</mi><mrow id="Sx3.SSx1.p1.15.m4.1.1.3" xref="Sx3.SSx1.p1.15.m4.1.1.3.cmml"><mi id="Sx3.SSx1.p1.15.m4.1.1.3.2" xref="Sx3.SSx1.p1.15.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.15.m4.1.1.3.1" xref="Sx3.SSx1.p1.15.m4.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.15.m4.1.1.3.3" xref="Sx3.SSx1.p1.15.m4.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.15.m4.1b"><apply id="Sx3.SSx1.p1.15.m4.1.1.cmml" xref="Sx3.SSx1.p1.15.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.15.m4.1.1.1.cmml" xref="Sx3.SSx1.p1.15.m4.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.15.m4.1.1.2.cmml" xref="Sx3.SSx1.p1.15.m4.1.1.2">𝑖</ci><apply id="Sx3.SSx1.p1.15.m4.1.1.3.cmml" xref="Sx3.SSx1.p1.15.m4.1.1.3"><times id="Sx3.SSx1.p1.15.m4.1.1.3.1.cmml" xref="Sx3.SSx1.p1.15.m4.1.1.3.1"></times><ci id="Sx3.SSx1.p1.15.m4.1.1.3.2.cmml" xref="Sx3.SSx1.p1.15.m4.1.1.3.2">𝑡</ci><ci id="Sx3.SSx1.p1.15.m4.1.1.3.3.cmml" xref="Sx3.SSx1.p1.15.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.15.m4.1c">i_{th}</annotation></semantics></math> site, we denote the class imbalance ratio as <math id="Sx3.SSx1.p1.16.m5.2" class="ltx_Math" alttext="\gamma_{i}=\frac{|\mathcal{P}_{i}^{-}|}{|\mathcal{P}_{i}^{+}|}" display="inline"><semantics id="Sx3.SSx1.p1.16.m5.2a"><mrow id="Sx3.SSx1.p1.16.m5.2.3" xref="Sx3.SSx1.p1.16.m5.2.3.cmml"><msub id="Sx3.SSx1.p1.16.m5.2.3.2" xref="Sx3.SSx1.p1.16.m5.2.3.2.cmml"><mi id="Sx3.SSx1.p1.16.m5.2.3.2.2" xref="Sx3.SSx1.p1.16.m5.2.3.2.2.cmml">γ</mi><mi id="Sx3.SSx1.p1.16.m5.2.3.2.3" xref="Sx3.SSx1.p1.16.m5.2.3.2.3.cmml">i</mi></msub><mo id="Sx3.SSx1.p1.16.m5.2.3.1" xref="Sx3.SSx1.p1.16.m5.2.3.1.cmml">=</mo><mfrac id="Sx3.SSx1.p1.16.m5.2.2" xref="Sx3.SSx1.p1.16.m5.2.2.cmml"><mrow id="Sx3.SSx1.p1.16.m5.1.1.1.1" xref="Sx3.SSx1.p1.16.m5.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.16.m5.1.1.1.1.2" xref="Sx3.SSx1.p1.16.m5.1.1.1.2.1.cmml">|</mo><msubsup id="Sx3.SSx1.p1.16.m5.1.1.1.1.1" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.16.m5.1.1.1.1.1.2.2" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1.2.2.cmml">𝒫</mi><mi id="Sx3.SSx1.p1.16.m5.1.1.1.1.1.2.3" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1.2.3.cmml">i</mi><mo id="Sx3.SSx1.p1.16.m5.1.1.1.1.1.3" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1.3.cmml">−</mo></msubsup><mo stretchy="false" id="Sx3.SSx1.p1.16.m5.1.1.1.1.3" xref="Sx3.SSx1.p1.16.m5.1.1.1.2.1.cmml">|</mo></mrow><mrow id="Sx3.SSx1.p1.16.m5.2.2.2.1" xref="Sx3.SSx1.p1.16.m5.2.2.2.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.16.m5.2.2.2.1.2" xref="Sx3.SSx1.p1.16.m5.2.2.2.2.1.cmml">|</mo><msubsup id="Sx3.SSx1.p1.16.m5.2.2.2.1.1" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.16.m5.2.2.2.1.1.2.2" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1.2.2.cmml">𝒫</mi><mi id="Sx3.SSx1.p1.16.m5.2.2.2.1.1.2.3" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1.2.3.cmml">i</mi><mo id="Sx3.SSx1.p1.16.m5.2.2.2.1.1.3" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1.3.cmml">+</mo></msubsup><mo stretchy="false" id="Sx3.SSx1.p1.16.m5.2.2.2.1.3" xref="Sx3.SSx1.p1.16.m5.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.16.m5.2b"><apply id="Sx3.SSx1.p1.16.m5.2.3.cmml" xref="Sx3.SSx1.p1.16.m5.2.3"><eq id="Sx3.SSx1.p1.16.m5.2.3.1.cmml" xref="Sx3.SSx1.p1.16.m5.2.3.1"></eq><apply id="Sx3.SSx1.p1.16.m5.2.3.2.cmml" xref="Sx3.SSx1.p1.16.m5.2.3.2"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.16.m5.2.3.2.1.cmml" xref="Sx3.SSx1.p1.16.m5.2.3.2">subscript</csymbol><ci id="Sx3.SSx1.p1.16.m5.2.3.2.2.cmml" xref="Sx3.SSx1.p1.16.m5.2.3.2.2">𝛾</ci><ci id="Sx3.SSx1.p1.16.m5.2.3.2.3.cmml" xref="Sx3.SSx1.p1.16.m5.2.3.2.3">𝑖</ci></apply><apply id="Sx3.SSx1.p1.16.m5.2.2.cmml" xref="Sx3.SSx1.p1.16.m5.2.2"><divide id="Sx3.SSx1.p1.16.m5.2.2.3.cmml" xref="Sx3.SSx1.p1.16.m5.2.2"></divide><apply id="Sx3.SSx1.p1.16.m5.1.1.1.2.cmml" xref="Sx3.SSx1.p1.16.m5.1.1.1.1"><abs id="Sx3.SSx1.p1.16.m5.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.2"></abs><apply id="Sx3.SSx1.p1.16.m5.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.16.m5.1.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.16.m5.1.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.16.m5.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.16.m5.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1.2.2">𝒫</ci><ci id="Sx3.SSx1.p1.16.m5.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1.2.3">𝑖</ci></apply><minus id="Sx3.SSx1.p1.16.m5.1.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.16.m5.1.1.1.1.1.3"></minus></apply></apply><apply id="Sx3.SSx1.p1.16.m5.2.2.2.2.cmml" xref="Sx3.SSx1.p1.16.m5.2.2.2.1"><abs id="Sx3.SSx1.p1.16.m5.2.2.2.2.1.cmml" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.2"></abs><apply id="Sx3.SSx1.p1.16.m5.2.2.2.1.1.cmml" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.16.m5.2.2.2.1.1.1.cmml" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.16.m5.2.2.2.1.1.2.cmml" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.16.m5.2.2.2.1.1.2.1.cmml" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.16.m5.2.2.2.1.1.2.2.cmml" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1.2.2">𝒫</ci><ci id="Sx3.SSx1.p1.16.m5.2.2.2.1.1.2.3.cmml" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1.2.3">𝑖</ci></apply><plus id="Sx3.SSx1.p1.16.m5.2.2.2.1.1.3.cmml" xref="Sx3.SSx1.p1.16.m5.2.2.2.1.1.3"></plus></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.16.m5.2c">\gamma_{i}=\frac{|\mathcal{P}_{i}^{-}|}{|\mathcal{P}_{i}^{+}|}</annotation></semantics></math>, where <math id="Sx3.SSx1.p1.17.m6.1" class="ltx_Math" alttext="|\mathcal{P}_{i}^{-}|" display="inline"><semantics id="Sx3.SSx1.p1.17.m6.1a"><mrow id="Sx3.SSx1.p1.17.m6.1.1.1" xref="Sx3.SSx1.p1.17.m6.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.17.m6.1.1.1.2" xref="Sx3.SSx1.p1.17.m6.1.1.2.1.cmml">|</mo><msubsup id="Sx3.SSx1.p1.17.m6.1.1.1.1" xref="Sx3.SSx1.p1.17.m6.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.17.m6.1.1.1.1.2.2" xref="Sx3.SSx1.p1.17.m6.1.1.1.1.2.2.cmml">𝒫</mi><mi id="Sx3.SSx1.p1.17.m6.1.1.1.1.2.3" xref="Sx3.SSx1.p1.17.m6.1.1.1.1.2.3.cmml">i</mi><mo id="Sx3.SSx1.p1.17.m6.1.1.1.1.3" xref="Sx3.SSx1.p1.17.m6.1.1.1.1.3.cmml">−</mo></msubsup><mo stretchy="false" id="Sx3.SSx1.p1.17.m6.1.1.1.3" xref="Sx3.SSx1.p1.17.m6.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.17.m6.1b"><apply id="Sx3.SSx1.p1.17.m6.1.1.2.cmml" xref="Sx3.SSx1.p1.17.m6.1.1.1"><abs id="Sx3.SSx1.p1.17.m6.1.1.2.1.cmml" xref="Sx3.SSx1.p1.17.m6.1.1.1.2"></abs><apply id="Sx3.SSx1.p1.17.m6.1.1.1.1.cmml" xref="Sx3.SSx1.p1.17.m6.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.17.m6.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.17.m6.1.1.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.17.m6.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.17.m6.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.17.m6.1.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.17.m6.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.17.m6.1.1.1.1.2.2.cmml" xref="Sx3.SSx1.p1.17.m6.1.1.1.1.2.2">𝒫</ci><ci id="Sx3.SSx1.p1.17.m6.1.1.1.1.2.3.cmml" xref="Sx3.SSx1.p1.17.m6.1.1.1.1.2.3">𝑖</ci></apply><minus id="Sx3.SSx1.p1.17.m6.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.17.m6.1.1.1.1.3"></minus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.17.m6.1c">|\mathcal{P}_{i}^{-}|</annotation></semantics></math> and <math id="Sx3.SSx1.p1.18.m7.1" class="ltx_Math" alttext="|\mathcal{P}_{i}^{+}|" display="inline"><semantics id="Sx3.SSx1.p1.18.m7.1a"><mrow id="Sx3.SSx1.p1.18.m7.1.1.1" xref="Sx3.SSx1.p1.18.m7.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx1.p1.18.m7.1.1.1.2" xref="Sx3.SSx1.p1.18.m7.1.1.2.1.cmml">|</mo><msubsup id="Sx3.SSx1.p1.18.m7.1.1.1.1" xref="Sx3.SSx1.p1.18.m7.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx1.p1.18.m7.1.1.1.1.2.2" xref="Sx3.SSx1.p1.18.m7.1.1.1.1.2.2.cmml">𝒫</mi><mi id="Sx3.SSx1.p1.18.m7.1.1.1.1.2.3" xref="Sx3.SSx1.p1.18.m7.1.1.1.1.2.3.cmml">i</mi><mo id="Sx3.SSx1.p1.18.m7.1.1.1.1.3" xref="Sx3.SSx1.p1.18.m7.1.1.1.1.3.cmml">+</mo></msubsup><mo stretchy="false" id="Sx3.SSx1.p1.18.m7.1.1.1.3" xref="Sx3.SSx1.p1.18.m7.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.18.m7.1b"><apply id="Sx3.SSx1.p1.18.m7.1.1.2.cmml" xref="Sx3.SSx1.p1.18.m7.1.1.1"><abs id="Sx3.SSx1.p1.18.m7.1.1.2.1.cmml" xref="Sx3.SSx1.p1.18.m7.1.1.1.2"></abs><apply id="Sx3.SSx1.p1.18.m7.1.1.1.1.cmml" xref="Sx3.SSx1.p1.18.m7.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.18.m7.1.1.1.1.1.cmml" xref="Sx3.SSx1.p1.18.m7.1.1.1.1">superscript</csymbol><apply id="Sx3.SSx1.p1.18.m7.1.1.1.1.2.cmml" xref="Sx3.SSx1.p1.18.m7.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.18.m7.1.1.1.1.2.1.cmml" xref="Sx3.SSx1.p1.18.m7.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.18.m7.1.1.1.1.2.2.cmml" xref="Sx3.SSx1.p1.18.m7.1.1.1.1.2.2">𝒫</ci><ci id="Sx3.SSx1.p1.18.m7.1.1.1.1.2.3.cmml" xref="Sx3.SSx1.p1.18.m7.1.1.1.1.2.3">𝑖</ci></apply><plus id="Sx3.SSx1.p1.18.m7.1.1.1.1.3.cmml" xref="Sx3.SSx1.p1.18.m7.1.1.1.1.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.18.m7.1c">|\mathcal{P}_{i}^{+}|</annotation></semantics></math> represent to the number of HER2- and HER2+ WSIs within the <math id="Sx3.SSx1.p1.19.m8.1" class="ltx_Math" alttext="i_{th}" display="inline"><semantics id="Sx3.SSx1.p1.19.m8.1a"><msub id="Sx3.SSx1.p1.19.m8.1.1" xref="Sx3.SSx1.p1.19.m8.1.1.cmml"><mi id="Sx3.SSx1.p1.19.m8.1.1.2" xref="Sx3.SSx1.p1.19.m8.1.1.2.cmml">i</mi><mrow id="Sx3.SSx1.p1.19.m8.1.1.3" xref="Sx3.SSx1.p1.19.m8.1.1.3.cmml"><mi id="Sx3.SSx1.p1.19.m8.1.1.3.2" xref="Sx3.SSx1.p1.19.m8.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx1.p1.19.m8.1.1.3.1" xref="Sx3.SSx1.p1.19.m8.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx1.p1.19.m8.1.1.3.3" xref="Sx3.SSx1.p1.19.m8.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx1.p1.19.m8.1b"><apply id="Sx3.SSx1.p1.19.m8.1.1.cmml" xref="Sx3.SSx1.p1.19.m8.1.1"><csymbol cd="ambiguous" id="Sx3.SSx1.p1.19.m8.1.1.1.cmml" xref="Sx3.SSx1.p1.19.m8.1.1">subscript</csymbol><ci id="Sx3.SSx1.p1.19.m8.1.1.2.cmml" xref="Sx3.SSx1.p1.19.m8.1.1.2">𝑖</ci><apply id="Sx3.SSx1.p1.19.m8.1.1.3.cmml" xref="Sx3.SSx1.p1.19.m8.1.1.3"><times id="Sx3.SSx1.p1.19.m8.1.1.3.1.cmml" xref="Sx3.SSx1.p1.19.m8.1.1.3.1"></times><ci id="Sx3.SSx1.p1.19.m8.1.1.3.2.cmml" xref="Sx3.SSx1.p1.19.m8.1.1.3.2">𝑡</ci><ci id="Sx3.SSx1.p1.19.m8.1.1.3.3.cmml" xref="Sx3.SSx1.p1.19.m8.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx1.p1.19.m8.1c">i_{th}</annotation></semantics></math> site.</p>
</div>
</section>
<section id="Sx3.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Point Feature Extraction</h3>

<div id="Sx3.SSx2.p1" class="ltx_para">
<p id="Sx3.SSx2.p1.7" class="ltx_p">To extract point features from a WSI, we follow the CLAM <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite> to preprocess and patch the WSIs with details in Appendix A. Each patch is treated as a point. The corresponding coordinates for each patch are also traced and represented as a tuple<math id="Sx3.SSx2.p1.1.m1.3" class="ltx_Math" alttext="(p_{x},p_{y},1)" display="inline"><semantics id="Sx3.SSx2.p1.1.m1.3a"><mrow id="Sx3.SSx2.p1.1.m1.3.3.2" xref="Sx3.SSx2.p1.1.m1.3.3.3.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.1.m1.3.3.2.3" xref="Sx3.SSx2.p1.1.m1.3.3.3.cmml">(</mo><msub id="Sx3.SSx2.p1.1.m1.2.2.1.1" xref="Sx3.SSx2.p1.1.m1.2.2.1.1.cmml"><mi id="Sx3.SSx2.p1.1.m1.2.2.1.1.2" xref="Sx3.SSx2.p1.1.m1.2.2.1.1.2.cmml">p</mi><mi id="Sx3.SSx2.p1.1.m1.2.2.1.1.3" xref="Sx3.SSx2.p1.1.m1.2.2.1.1.3.cmml">x</mi></msub><mo id="Sx3.SSx2.p1.1.m1.3.3.2.4" xref="Sx3.SSx2.p1.1.m1.3.3.3.cmml">,</mo><msub id="Sx3.SSx2.p1.1.m1.3.3.2.2" xref="Sx3.SSx2.p1.1.m1.3.3.2.2.cmml"><mi id="Sx3.SSx2.p1.1.m1.3.3.2.2.2" xref="Sx3.SSx2.p1.1.m1.3.3.2.2.2.cmml">p</mi><mi id="Sx3.SSx2.p1.1.m1.3.3.2.2.3" xref="Sx3.SSx2.p1.1.m1.3.3.2.2.3.cmml">y</mi></msub><mo id="Sx3.SSx2.p1.1.m1.3.3.2.5" xref="Sx3.SSx2.p1.1.m1.3.3.3.cmml">,</mo><mn id="Sx3.SSx2.p1.1.m1.1.1" xref="Sx3.SSx2.p1.1.m1.1.1.cmml">1</mn><mo stretchy="false" id="Sx3.SSx2.p1.1.m1.3.3.2.6" xref="Sx3.SSx2.p1.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.1.m1.3b"><vector id="Sx3.SSx2.p1.1.m1.3.3.3.cmml" xref="Sx3.SSx2.p1.1.m1.3.3.2"><apply id="Sx3.SSx2.p1.1.m1.2.2.1.1.cmml" xref="Sx3.SSx2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.1.m1.2.2.1.1.1.cmml" xref="Sx3.SSx2.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="Sx3.SSx2.p1.1.m1.2.2.1.1.2.cmml" xref="Sx3.SSx2.p1.1.m1.2.2.1.1.2">𝑝</ci><ci id="Sx3.SSx2.p1.1.m1.2.2.1.1.3.cmml" xref="Sx3.SSx2.p1.1.m1.2.2.1.1.3">𝑥</ci></apply><apply id="Sx3.SSx2.p1.1.m1.3.3.2.2.cmml" xref="Sx3.SSx2.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.1.m1.3.3.2.2.1.cmml" xref="Sx3.SSx2.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="Sx3.SSx2.p1.1.m1.3.3.2.2.2.cmml" xref="Sx3.SSx2.p1.1.m1.3.3.2.2.2">𝑝</ci><ci id="Sx3.SSx2.p1.1.m1.3.3.2.2.3.cmml" xref="Sx3.SSx2.p1.1.m1.3.3.2.2.3">𝑦</ci></apply><cn type="integer" id="Sx3.SSx2.p1.1.m1.1.1.cmml" xref="Sx3.SSx2.p1.1.m1.1.1">1</cn></vector></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.1.m1.3c">(p_{x},p_{y},1)</annotation></semantics></math>, where 1 represents all WSIs having the same z-coordinate. Then we input the patches into a nuclei segmentation network that is pretrained using Swin-Transformer <cite class="ltx_cite ltx_citemacro_citep">(Liu et al. <a href="#bib.bib25" title="" class="ltx_ref">2021</a>)</cite> with FPN <cite class="ltx_cite ltx_citemacro_citep">(Lin et al. <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite> with four levels, represented by <math id="Sx3.SSx2.p1.2.m2.4" class="ltx_Math" alttext="{P_{2},P_{3},P_{4},P_{5}}" display="inline"><semantics id="Sx3.SSx2.p1.2.m2.4a"><mrow id="Sx3.SSx2.p1.2.m2.4.4.4" xref="Sx3.SSx2.p1.2.m2.4.4.5.cmml"><msub id="Sx3.SSx2.p1.2.m2.1.1.1.1" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.cmml"><mi id="Sx3.SSx2.p1.2.m2.1.1.1.1.2" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.2.cmml">P</mi><mn id="Sx3.SSx2.p1.2.m2.1.1.1.1.3" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.3.cmml">2</mn></msub><mo id="Sx3.SSx2.p1.2.m2.4.4.4.5" xref="Sx3.SSx2.p1.2.m2.4.4.5.cmml">,</mo><msub id="Sx3.SSx2.p1.2.m2.2.2.2.2" xref="Sx3.SSx2.p1.2.m2.2.2.2.2.cmml"><mi id="Sx3.SSx2.p1.2.m2.2.2.2.2.2" xref="Sx3.SSx2.p1.2.m2.2.2.2.2.2.cmml">P</mi><mn id="Sx3.SSx2.p1.2.m2.2.2.2.2.3" xref="Sx3.SSx2.p1.2.m2.2.2.2.2.3.cmml">3</mn></msub><mo id="Sx3.SSx2.p1.2.m2.4.4.4.6" xref="Sx3.SSx2.p1.2.m2.4.4.5.cmml">,</mo><msub id="Sx3.SSx2.p1.2.m2.3.3.3.3" xref="Sx3.SSx2.p1.2.m2.3.3.3.3.cmml"><mi id="Sx3.SSx2.p1.2.m2.3.3.3.3.2" xref="Sx3.SSx2.p1.2.m2.3.3.3.3.2.cmml">P</mi><mn id="Sx3.SSx2.p1.2.m2.3.3.3.3.3" xref="Sx3.SSx2.p1.2.m2.3.3.3.3.3.cmml">4</mn></msub><mo id="Sx3.SSx2.p1.2.m2.4.4.4.7" xref="Sx3.SSx2.p1.2.m2.4.4.5.cmml">,</mo><msub id="Sx3.SSx2.p1.2.m2.4.4.4.4" xref="Sx3.SSx2.p1.2.m2.4.4.4.4.cmml"><mi id="Sx3.SSx2.p1.2.m2.4.4.4.4.2" xref="Sx3.SSx2.p1.2.m2.4.4.4.4.2.cmml">P</mi><mn id="Sx3.SSx2.p1.2.m2.4.4.4.4.3" xref="Sx3.SSx2.p1.2.m2.4.4.4.4.3.cmml">5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.2.m2.4b"><list id="Sx3.SSx2.p1.2.m2.4.4.5.cmml" xref="Sx3.SSx2.p1.2.m2.4.4.4"><apply id="Sx3.SSx2.p1.2.m2.1.1.1.1.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.2.m2.1.1.1.1.1.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.p1.2.m2.1.1.1.1.2.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.2">𝑃</ci><cn type="integer" id="Sx3.SSx2.p1.2.m2.1.1.1.1.3.cmml" xref="Sx3.SSx2.p1.2.m2.1.1.1.1.3">2</cn></apply><apply id="Sx3.SSx2.p1.2.m2.2.2.2.2.cmml" xref="Sx3.SSx2.p1.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.2.m2.2.2.2.2.1.cmml" xref="Sx3.SSx2.p1.2.m2.2.2.2.2">subscript</csymbol><ci id="Sx3.SSx2.p1.2.m2.2.2.2.2.2.cmml" xref="Sx3.SSx2.p1.2.m2.2.2.2.2.2">𝑃</ci><cn type="integer" id="Sx3.SSx2.p1.2.m2.2.2.2.2.3.cmml" xref="Sx3.SSx2.p1.2.m2.2.2.2.2.3">3</cn></apply><apply id="Sx3.SSx2.p1.2.m2.3.3.3.3.cmml" xref="Sx3.SSx2.p1.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.2.m2.3.3.3.3.1.cmml" xref="Sx3.SSx2.p1.2.m2.3.3.3.3">subscript</csymbol><ci id="Sx3.SSx2.p1.2.m2.3.3.3.3.2.cmml" xref="Sx3.SSx2.p1.2.m2.3.3.3.3.2">𝑃</ci><cn type="integer" id="Sx3.SSx2.p1.2.m2.3.3.3.3.3.cmml" xref="Sx3.SSx2.p1.2.m2.3.3.3.3.3">4</cn></apply><apply id="Sx3.SSx2.p1.2.m2.4.4.4.4.cmml" xref="Sx3.SSx2.p1.2.m2.4.4.4.4"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.2.m2.4.4.4.4.1.cmml" xref="Sx3.SSx2.p1.2.m2.4.4.4.4">subscript</csymbol><ci id="Sx3.SSx2.p1.2.m2.4.4.4.4.2.cmml" xref="Sx3.SSx2.p1.2.m2.4.4.4.4.2">𝑃</ci><cn type="integer" id="Sx3.SSx2.p1.2.m2.4.4.4.4.3.cmml" xref="Sx3.SSx2.p1.2.m2.4.4.4.4.3">5</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.2.m2.4c">{P_{2},P_{3},P_{4},P_{5}}</annotation></semantics></math> in Figure <a href="#Sx1.F2" title="Figure 2 ‣ Introduction ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. The channel of FPN is set to 64 and the outputs from all four layers of FPN are averaged and concatenated with the point coordinates as the patch-level feature <math id="Sx3.SSx2.p1.3.m3.1" class="ltx_Math" alttext="x_{n}\in\mathbb{R}^{3+d}" display="inline"><semantics id="Sx3.SSx2.p1.3.m3.1a"><mrow id="Sx3.SSx2.p1.3.m3.1.1" xref="Sx3.SSx2.p1.3.m3.1.1.cmml"><msub id="Sx3.SSx2.p1.3.m3.1.1.2" xref="Sx3.SSx2.p1.3.m3.1.1.2.cmml"><mi id="Sx3.SSx2.p1.3.m3.1.1.2.2" xref="Sx3.SSx2.p1.3.m3.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx2.p1.3.m3.1.1.2.3" xref="Sx3.SSx2.p1.3.m3.1.1.2.3.cmml">n</mi></msub><mo id="Sx3.SSx2.p1.3.m3.1.1.1" xref="Sx3.SSx2.p1.3.m3.1.1.1.cmml">∈</mo><msup id="Sx3.SSx2.p1.3.m3.1.1.3" xref="Sx3.SSx2.p1.3.m3.1.1.3.cmml"><mi id="Sx3.SSx2.p1.3.m3.1.1.3.2" xref="Sx3.SSx2.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx2.p1.3.m3.1.1.3.3" xref="Sx3.SSx2.p1.3.m3.1.1.3.3.cmml"><mn id="Sx3.SSx2.p1.3.m3.1.1.3.3.2" xref="Sx3.SSx2.p1.3.m3.1.1.3.3.2.cmml">3</mn><mo id="Sx3.SSx2.p1.3.m3.1.1.3.3.1" xref="Sx3.SSx2.p1.3.m3.1.1.3.3.1.cmml">+</mo><mi id="Sx3.SSx2.p1.3.m3.1.1.3.3.3" xref="Sx3.SSx2.p1.3.m3.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.3.m3.1b"><apply id="Sx3.SSx2.p1.3.m3.1.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1"><in id="Sx3.SSx2.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.1"></in><apply id="Sx3.SSx2.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.3.m3.1.1.2.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.2">subscript</csymbol><ci id="Sx3.SSx2.p1.3.m3.1.1.2.2.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.2.2">𝑥</ci><ci id="Sx3.SSx2.p1.3.m3.1.1.2.3.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.2.3">𝑛</ci></apply><apply id="Sx3.SSx2.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.3.m3.1.1.3.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.3">superscript</csymbol><ci id="Sx3.SSx2.p1.3.m3.1.1.3.2.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.3.2">ℝ</ci><apply id="Sx3.SSx2.p1.3.m3.1.1.3.3.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.3.3"><plus id="Sx3.SSx2.p1.3.m3.1.1.3.3.1.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.3.3.1"></plus><cn type="integer" id="Sx3.SSx2.p1.3.m3.1.1.3.3.2.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.3.3.2">3</cn><ci id="Sx3.SSx2.p1.3.m3.1.1.3.3.3.cmml" xref="Sx3.SSx2.p1.3.m3.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.3.m3.1c">x_{n}\in\mathbb{R}^{3+d}</annotation></semantics></math>, where 3 represents the coordinates and <math id="Sx3.SSx2.p1.4.m4.1" class="ltx_Math" alttext="d=256" display="inline"><semantics id="Sx3.SSx2.p1.4.m4.1a"><mrow id="Sx3.SSx2.p1.4.m4.1.1" xref="Sx3.SSx2.p1.4.m4.1.1.cmml"><mi id="Sx3.SSx2.p1.4.m4.1.1.2" xref="Sx3.SSx2.p1.4.m4.1.1.2.cmml">d</mi><mo id="Sx3.SSx2.p1.4.m4.1.1.1" xref="Sx3.SSx2.p1.4.m4.1.1.1.cmml">=</mo><mn id="Sx3.SSx2.p1.4.m4.1.1.3" xref="Sx3.SSx2.p1.4.m4.1.1.3.cmml">256</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.4.m4.1b"><apply id="Sx3.SSx2.p1.4.m4.1.1.cmml" xref="Sx3.SSx2.p1.4.m4.1.1"><eq id="Sx3.SSx2.p1.4.m4.1.1.1.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.1"></eq><ci id="Sx3.SSx2.p1.4.m4.1.1.2.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.2">𝑑</ci><cn type="integer" id="Sx3.SSx2.p1.4.m4.1.1.3.cmml" xref="Sx3.SSx2.p1.4.m4.1.1.3">256</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.4.m4.1c">d=256</annotation></semantics></math> represents the point feature. Thus for a WSI with a label <math id="Sx3.SSx2.p1.5.m5.1" class="ltx_Math" alttext="y" display="inline"><semantics id="Sx3.SSx2.p1.5.m5.1a"><mi id="Sx3.SSx2.p1.5.m5.1.1" xref="Sx3.SSx2.p1.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.5.m5.1b"><ci id="Sx3.SSx2.p1.5.m5.1.1.cmml" xref="Sx3.SSx2.p1.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.5.m5.1c">y</annotation></semantics></math>, we can obtain a point set <math id="Sx3.SSx2.p1.6.m6.5" class="ltx_Math" alttext="\mathcal{X}={x_{1},x_{2},...,x_{|\mathcal{X}|}}" display="inline"><semantics id="Sx3.SSx2.p1.6.m6.5a"><mrow id="Sx3.SSx2.p1.6.m6.5.5" xref="Sx3.SSx2.p1.6.m6.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx2.p1.6.m6.5.5.5" xref="Sx3.SSx2.p1.6.m6.5.5.5.cmml">𝒳</mi><mo id="Sx3.SSx2.p1.6.m6.5.5.4" xref="Sx3.SSx2.p1.6.m6.5.5.4.cmml">=</mo><mrow id="Sx3.SSx2.p1.6.m6.5.5.3.3" xref="Sx3.SSx2.p1.6.m6.5.5.3.4.cmml"><msub id="Sx3.SSx2.p1.6.m6.3.3.1.1.1" xref="Sx3.SSx2.p1.6.m6.3.3.1.1.1.cmml"><mi id="Sx3.SSx2.p1.6.m6.3.3.1.1.1.2" xref="Sx3.SSx2.p1.6.m6.3.3.1.1.1.2.cmml">x</mi><mn id="Sx3.SSx2.p1.6.m6.3.3.1.1.1.3" xref="Sx3.SSx2.p1.6.m6.3.3.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx2.p1.6.m6.5.5.3.3.4" xref="Sx3.SSx2.p1.6.m6.5.5.3.4.cmml">,</mo><msub id="Sx3.SSx2.p1.6.m6.4.4.2.2.2" xref="Sx3.SSx2.p1.6.m6.4.4.2.2.2.cmml"><mi id="Sx3.SSx2.p1.6.m6.4.4.2.2.2.2" xref="Sx3.SSx2.p1.6.m6.4.4.2.2.2.2.cmml">x</mi><mn id="Sx3.SSx2.p1.6.m6.4.4.2.2.2.3" xref="Sx3.SSx2.p1.6.m6.4.4.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.SSx2.p1.6.m6.5.5.3.3.5" xref="Sx3.SSx2.p1.6.m6.5.5.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx2.p1.6.m6.2.2" xref="Sx3.SSx2.p1.6.m6.2.2.cmml">…</mi><mo id="Sx3.SSx2.p1.6.m6.5.5.3.3.6" xref="Sx3.SSx2.p1.6.m6.5.5.3.4.cmml">,</mo><msub id="Sx3.SSx2.p1.6.m6.5.5.3.3.3" xref="Sx3.SSx2.p1.6.m6.5.5.3.3.3.cmml"><mi id="Sx3.SSx2.p1.6.m6.5.5.3.3.3.2" xref="Sx3.SSx2.p1.6.m6.5.5.3.3.3.2.cmml">x</mi><mrow id="Sx3.SSx2.p1.6.m6.1.1.1.3" xref="Sx3.SSx2.p1.6.m6.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.6.m6.1.1.1.3.1" xref="Sx3.SSx2.p1.6.m6.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx2.p1.6.m6.1.1.1.1" xref="Sx3.SSx2.p1.6.m6.1.1.1.1.cmml">𝒳</mi><mo stretchy="false" id="Sx3.SSx2.p1.6.m6.1.1.1.3.2" xref="Sx3.SSx2.p1.6.m6.1.1.1.2.1.cmml">|</mo></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.6.m6.5b"><apply id="Sx3.SSx2.p1.6.m6.5.5.cmml" xref="Sx3.SSx2.p1.6.m6.5.5"><eq id="Sx3.SSx2.p1.6.m6.5.5.4.cmml" xref="Sx3.SSx2.p1.6.m6.5.5.4"></eq><ci id="Sx3.SSx2.p1.6.m6.5.5.5.cmml" xref="Sx3.SSx2.p1.6.m6.5.5.5">𝒳</ci><list id="Sx3.SSx2.p1.6.m6.5.5.3.4.cmml" xref="Sx3.SSx2.p1.6.m6.5.5.3.3"><apply id="Sx3.SSx2.p1.6.m6.3.3.1.1.1.cmml" xref="Sx3.SSx2.p1.6.m6.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.6.m6.3.3.1.1.1.1.cmml" xref="Sx3.SSx2.p1.6.m6.3.3.1.1.1">subscript</csymbol><ci id="Sx3.SSx2.p1.6.m6.3.3.1.1.1.2.cmml" xref="Sx3.SSx2.p1.6.m6.3.3.1.1.1.2">𝑥</ci><cn type="integer" id="Sx3.SSx2.p1.6.m6.3.3.1.1.1.3.cmml" xref="Sx3.SSx2.p1.6.m6.3.3.1.1.1.3">1</cn></apply><apply id="Sx3.SSx2.p1.6.m6.4.4.2.2.2.cmml" xref="Sx3.SSx2.p1.6.m6.4.4.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.6.m6.4.4.2.2.2.1.cmml" xref="Sx3.SSx2.p1.6.m6.4.4.2.2.2">subscript</csymbol><ci id="Sx3.SSx2.p1.6.m6.4.4.2.2.2.2.cmml" xref="Sx3.SSx2.p1.6.m6.4.4.2.2.2.2">𝑥</ci><cn type="integer" id="Sx3.SSx2.p1.6.m6.4.4.2.2.2.3.cmml" xref="Sx3.SSx2.p1.6.m6.4.4.2.2.2.3">2</cn></apply><ci id="Sx3.SSx2.p1.6.m6.2.2.cmml" xref="Sx3.SSx2.p1.6.m6.2.2">…</ci><apply id="Sx3.SSx2.p1.6.m6.5.5.3.3.3.cmml" xref="Sx3.SSx2.p1.6.m6.5.5.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx2.p1.6.m6.5.5.3.3.3.1.cmml" xref="Sx3.SSx2.p1.6.m6.5.5.3.3.3">subscript</csymbol><ci id="Sx3.SSx2.p1.6.m6.5.5.3.3.3.2.cmml" xref="Sx3.SSx2.p1.6.m6.5.5.3.3.3.2">𝑥</ci><apply id="Sx3.SSx2.p1.6.m6.1.1.1.2.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.1.3"><abs id="Sx3.SSx2.p1.6.m6.1.1.1.2.1.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.1.3.1"></abs><ci id="Sx3.SSx2.p1.6.m6.1.1.1.1.cmml" xref="Sx3.SSx2.p1.6.m6.1.1.1.1">𝒳</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.6.m6.5c">\mathcal{X}={x_{1},x_{2},...,x_{|\mathcal{X}|}}</annotation></semantics></math>, where <math id="Sx3.SSx2.p1.7.m7.1" class="ltx_Math" alttext="|\mathcal{X}|" display="inline"><semantics id="Sx3.SSx2.p1.7.m7.1a"><mrow id="Sx3.SSx2.p1.7.m7.1.2.2" xref="Sx3.SSx2.p1.7.m7.1.2.1.cmml"><mo stretchy="false" id="Sx3.SSx2.p1.7.m7.1.2.2.1" xref="Sx3.SSx2.p1.7.m7.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx2.p1.7.m7.1.1" xref="Sx3.SSx2.p1.7.m7.1.1.cmml">𝒳</mi><mo stretchy="false" id="Sx3.SSx2.p1.7.m7.1.2.2.2" xref="Sx3.SSx2.p1.7.m7.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx2.p1.7.m7.1b"><apply id="Sx3.SSx2.p1.7.m7.1.2.1.cmml" xref="Sx3.SSx2.p1.7.m7.1.2.2"><abs id="Sx3.SSx2.p1.7.m7.1.2.1.1.cmml" xref="Sx3.SSx2.p1.7.m7.1.2.2.1"></abs><ci id="Sx3.SSx2.p1.7.m7.1.1.cmml" xref="Sx3.SSx2.p1.7.m7.1.1">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx2.p1.7.m7.1c">|\mathcal{X}|</annotation></semantics></math> is the number of patches in a WSI. 1024 patches or points are randomly selected with uniform distribution to reduce the memory usage and improve computational efficiency.</p>
</div>
</section>
<section id="Sx3.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Point Transformer Block</h3>

<div id="Sx3.SSx3.p1" class="ltx_para">
<p id="Sx3.SSx3.p1.7" class="ltx_p">In our approach, we adopt the original point transformer block <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al. <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite> to capture and aggregate the local context information of each point with an effective attention mechanism. For the <math id="Sx3.SSx3.p1.1.m1.1" class="ltx_Math" alttext="i_{th}" display="inline"><semantics id="Sx3.SSx3.p1.1.m1.1a"><msub id="Sx3.SSx3.p1.1.m1.1.1" xref="Sx3.SSx3.p1.1.m1.1.1.cmml"><mi id="Sx3.SSx3.p1.1.m1.1.1.2" xref="Sx3.SSx3.p1.1.m1.1.1.2.cmml">i</mi><mrow id="Sx3.SSx3.p1.1.m1.1.1.3" xref="Sx3.SSx3.p1.1.m1.1.1.3.cmml"><mi id="Sx3.SSx3.p1.1.m1.1.1.3.2" xref="Sx3.SSx3.p1.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.1.m1.1.1.3.1" xref="Sx3.SSx3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx3.p1.1.m1.1.1.3.3" xref="Sx3.SSx3.p1.1.m1.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.1.m1.1b"><apply id="Sx3.SSx3.p1.1.m1.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.1.m1.1.1.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx3.p1.1.m1.1.1.2.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.2">𝑖</ci><apply id="Sx3.SSx3.p1.1.m1.1.1.3.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.3"><times id="Sx3.SSx3.p1.1.m1.1.1.3.1.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.3.1"></times><ci id="Sx3.SSx3.p1.1.m1.1.1.3.2.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.3.2">𝑡</ci><ci id="Sx3.SSx3.p1.1.m1.1.1.3.3.cmml" xref="Sx3.SSx3.p1.1.m1.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.1.m1.1c">i_{th}</annotation></semantics></math> point with its corresponding point feature <math id="Sx3.SSx3.p1.2.m2.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="Sx3.SSx3.p1.2.m2.1a"><msub id="Sx3.SSx3.p1.2.m2.1.1" xref="Sx3.SSx3.p1.2.m2.1.1.cmml"><mi id="Sx3.SSx3.p1.2.m2.1.1.2" xref="Sx3.SSx3.p1.2.m2.1.1.2.cmml">x</mi><mi id="Sx3.SSx3.p1.2.m2.1.1.3" xref="Sx3.SSx3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.2.m2.1b"><apply id="Sx3.SSx3.p1.2.m2.1.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx3.p1.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx3.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.2">𝑥</ci><ci id="Sx3.SSx3.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.2.m2.1c">x_{i}</annotation></semantics></math>, position <math id="Sx3.SSx3.p1.3.m3.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="Sx3.SSx3.p1.3.m3.1a"><msub id="Sx3.SSx3.p1.3.m3.1.1" xref="Sx3.SSx3.p1.3.m3.1.1.cmml"><mi id="Sx3.SSx3.p1.3.m3.1.1.2" xref="Sx3.SSx3.p1.3.m3.1.1.2.cmml">p</mi><mi id="Sx3.SSx3.p1.3.m3.1.1.3" xref="Sx3.SSx3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.3.m3.1b"><apply id="Sx3.SSx3.p1.3.m3.1.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx3.p1.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx3.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.2">𝑝</ci><ci id="Sx3.SSx3.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.3.m3.1c">p_{i}</annotation></semantics></math>. We represent its <span id="Sx3.SSx3.p1.7.1" class="ltx_text ltx_font_italic">k</span>-nearest neighborhood points (k=16) as a subset <math id="Sx3.SSx3.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{X}(i)\subset\mathcal{X}" display="inline"><semantics id="Sx3.SSx3.p1.4.m4.1a"><mrow id="Sx3.SSx3.p1.4.m4.1.2" xref="Sx3.SSx3.p1.4.m4.1.2.cmml"><mrow id="Sx3.SSx3.p1.4.m4.1.2.2" xref="Sx3.SSx3.p1.4.m4.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p1.4.m4.1.2.2.2" xref="Sx3.SSx3.p1.4.m4.1.2.2.2.cmml">𝒳</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.4.m4.1.2.2.1" xref="Sx3.SSx3.p1.4.m4.1.2.2.1.cmml">​</mo><mrow id="Sx3.SSx3.p1.4.m4.1.2.2.3.2" xref="Sx3.SSx3.p1.4.m4.1.2.2.cmml"><mo stretchy="false" id="Sx3.SSx3.p1.4.m4.1.2.2.3.2.1" xref="Sx3.SSx3.p1.4.m4.1.2.2.cmml">(</mo><mi id="Sx3.SSx3.p1.4.m4.1.1" xref="Sx3.SSx3.p1.4.m4.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.SSx3.p1.4.m4.1.2.2.3.2.2" xref="Sx3.SSx3.p1.4.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx3.p1.4.m4.1.2.1" xref="Sx3.SSx3.p1.4.m4.1.2.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p1.4.m4.1.2.3" xref="Sx3.SSx3.p1.4.m4.1.2.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.4.m4.1b"><apply id="Sx3.SSx3.p1.4.m4.1.2.cmml" xref="Sx3.SSx3.p1.4.m4.1.2"><subset id="Sx3.SSx3.p1.4.m4.1.2.1.cmml" xref="Sx3.SSx3.p1.4.m4.1.2.1"></subset><apply id="Sx3.SSx3.p1.4.m4.1.2.2.cmml" xref="Sx3.SSx3.p1.4.m4.1.2.2"><times id="Sx3.SSx3.p1.4.m4.1.2.2.1.cmml" xref="Sx3.SSx3.p1.4.m4.1.2.2.1"></times><ci id="Sx3.SSx3.p1.4.m4.1.2.2.2.cmml" xref="Sx3.SSx3.p1.4.m4.1.2.2.2">𝒳</ci><ci id="Sx3.SSx3.p1.4.m4.1.1.cmml" xref="Sx3.SSx3.p1.4.m4.1.1">𝑖</ci></apply><ci id="Sx3.SSx3.p1.4.m4.1.2.3.cmml" xref="Sx3.SSx3.p1.4.m4.1.2.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.4.m4.1c">\mathcal{X}(i)\subset\mathcal{X}</annotation></semantics></math>. Then we compute the attention score between point <math id="Sx3.SSx3.p1.5.m5.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="Sx3.SSx3.p1.5.m5.1a"><msub id="Sx3.SSx3.p1.5.m5.1.1" xref="Sx3.SSx3.p1.5.m5.1.1.cmml"><mi id="Sx3.SSx3.p1.5.m5.1.1.2" xref="Sx3.SSx3.p1.5.m5.1.1.2.cmml">x</mi><mi id="Sx3.SSx3.p1.5.m5.1.1.3" xref="Sx3.SSx3.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.5.m5.1b"><apply id="Sx3.SSx3.p1.5.m5.1.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.5.m5.1.1.1.cmml" xref="Sx3.SSx3.p1.5.m5.1.1">subscript</csymbol><ci id="Sx3.SSx3.p1.5.m5.1.1.2.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.2">𝑥</ci><ci id="Sx3.SSx3.p1.5.m5.1.1.3.cmml" xref="Sx3.SSx3.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.5.m5.1c">x_{i}</annotation></semantics></math> and point subset <math id="Sx3.SSx3.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{X}(i)" display="inline"><semantics id="Sx3.SSx3.p1.6.m6.1a"><mrow id="Sx3.SSx3.p1.6.m6.1.2" xref="Sx3.SSx3.p1.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p1.6.m6.1.2.2" xref="Sx3.SSx3.p1.6.m6.1.2.2.cmml">𝒳</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.6.m6.1.2.1" xref="Sx3.SSx3.p1.6.m6.1.2.1.cmml">​</mo><mrow id="Sx3.SSx3.p1.6.m6.1.2.3.2" xref="Sx3.SSx3.p1.6.m6.1.2.cmml"><mo stretchy="false" id="Sx3.SSx3.p1.6.m6.1.2.3.2.1" xref="Sx3.SSx3.p1.6.m6.1.2.cmml">(</mo><mi id="Sx3.SSx3.p1.6.m6.1.1" xref="Sx3.SSx3.p1.6.m6.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.SSx3.p1.6.m6.1.2.3.2.2" xref="Sx3.SSx3.p1.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.6.m6.1b"><apply id="Sx3.SSx3.p1.6.m6.1.2.cmml" xref="Sx3.SSx3.p1.6.m6.1.2"><times id="Sx3.SSx3.p1.6.m6.1.2.1.cmml" xref="Sx3.SSx3.p1.6.m6.1.2.1"></times><ci id="Sx3.SSx3.p1.6.m6.1.2.2.cmml" xref="Sx3.SSx3.p1.6.m6.1.2.2">𝒳</ci><ci id="Sx3.SSx3.p1.6.m6.1.1.cmml" xref="Sx3.SSx3.p1.6.m6.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.6.m6.1c">\mathcal{X}(i)</annotation></semantics></math> by the attention score function <math id="Sx3.SSx3.p1.7.m7.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="Sx3.SSx3.p1.7.m7.1a"><mi id="Sx3.SSx3.p1.7.m7.1.1" xref="Sx3.SSx3.p1.7.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.7.m7.1b"><ci id="Sx3.SSx3.p1.7.m7.1.1.cmml" xref="Sx3.SSx3.p1.7.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.7.m7.1c">\alpha</annotation></semantics></math>:</p>
<table id="A5.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E3.m1.1" class="ltx_Math" alttext="\displaystyle\alpha(x_{i},x_{j})=W_{q}(W_{i}x_{i}-W_{j}x_{j})+PE(p_{i},p_{j})," display="inline"><semantics id="Sx3.E3.m1.1a"><mrow id="Sx3.E3.m1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.cmml"><mrow id="Sx3.E3.m1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.cmml"><mrow id="Sx3.E3.m1.1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.2.cmml"><mi id="Sx3.E3.m1.1.1.1.1.2.4" xref="Sx3.E3.m1.1.1.1.1.2.4.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.2.3" xref="Sx3.E3.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx3.E3.m1.1.1.1.1.2.2.2" xref="Sx3.E3.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.2.2.2.3" xref="Sx3.E3.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="Sx3.E3.m1.1.1.1.1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E3.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="Sx3.E3.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.E3.m1.1.1.1.1.2.2.2.4" xref="Sx3.E3.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="Sx3.E3.m1.1.1.1.1.2.2.2.2" xref="Sx3.E3.m1.1.1.1.1.2.2.2.2.cmml"><mi id="Sx3.E3.m1.1.1.1.1.2.2.2.2.2" xref="Sx3.E3.m1.1.1.1.1.2.2.2.2.2.cmml">x</mi><mi id="Sx3.E3.m1.1.1.1.1.2.2.2.2.3" xref="Sx3.E3.m1.1.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.2.2.2.5" xref="Sx3.E3.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx3.E3.m1.1.1.1.1.6" xref="Sx3.E3.m1.1.1.1.1.6.cmml">=</mo><mrow id="Sx3.E3.m1.1.1.1.1.5" xref="Sx3.E3.m1.1.1.1.1.5.cmml"><mrow id="Sx3.E3.m1.1.1.1.1.3.1" xref="Sx3.E3.m1.1.1.1.1.3.1.cmml"><msub id="Sx3.E3.m1.1.1.1.1.3.1.3" xref="Sx3.E3.m1.1.1.1.1.3.1.3.cmml"><mi id="Sx3.E3.m1.1.1.1.1.3.1.3.2" xref="Sx3.E3.m1.1.1.1.1.3.1.3.2.cmml">W</mi><mi id="Sx3.E3.m1.1.1.1.1.3.1.3.3" xref="Sx3.E3.m1.1.1.1.1.3.1.3.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.3.1.2" xref="Sx3.E3.m1.1.1.1.1.3.1.2.cmml">​</mo><mrow id="Sx3.E3.m1.1.1.1.1.3.1.1.1" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.3.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.cmml">(</mo><mrow id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.cmml"><mrow id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.cmml"><msub id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.cmml"><mi id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.2" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.2.cmml">W</mi><mi id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.3" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.1" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.1.cmml">​</mo><msub id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.cmml"><mi id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.2" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.2.cmml">x</mi><mi id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.3" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.1" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.1.cmml">−</mo><mrow id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.cmml"><msub id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.cmml"><mi id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.2" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.2.cmml">W</mi><mi id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.3" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.1" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.1.cmml">​</mo><msub id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.cmml"><mi id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.2" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.2.cmml">x</mi><mi id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.3" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.3.cmml">j</mi></msub></mrow></mrow><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.3.1.1.1.3" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E3.m1.1.1.1.1.5.4" xref="Sx3.E3.m1.1.1.1.1.5.4.cmml">+</mo><mrow id="Sx3.E3.m1.1.1.1.1.5.3" xref="Sx3.E3.m1.1.1.1.1.5.3.cmml"><mi id="Sx3.E3.m1.1.1.1.1.5.3.4" xref="Sx3.E3.m1.1.1.1.1.5.3.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.5.3.3" xref="Sx3.E3.m1.1.1.1.1.5.3.3.cmml">​</mo><mi id="Sx3.E3.m1.1.1.1.1.5.3.5" xref="Sx3.E3.m1.1.1.1.1.5.3.5.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.E3.m1.1.1.1.1.5.3.3a" xref="Sx3.E3.m1.1.1.1.1.5.3.3.cmml">​</mo><mrow id="Sx3.E3.m1.1.1.1.1.5.3.2.2" xref="Sx3.E3.m1.1.1.1.1.5.3.2.3.cmml"><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.5.3.2.2.3" xref="Sx3.E3.m1.1.1.1.1.5.3.2.3.cmml">(</mo><msub id="Sx3.E3.m1.1.1.1.1.4.2.1.1.1" xref="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.cmml"><mi id="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.2.cmml">p</mi><mi id="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.3" xref="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.E3.m1.1.1.1.1.5.3.2.2.4" xref="Sx3.E3.m1.1.1.1.1.5.3.2.3.cmml">,</mo><msub id="Sx3.E3.m1.1.1.1.1.5.3.2.2.2" xref="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.cmml"><mi id="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.2" xref="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.2.cmml">p</mi><mi id="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.3" xref="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx3.E3.m1.1.1.1.1.5.3.2.2.5" xref="Sx3.E3.m1.1.1.1.1.5.3.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx3.E3.m1.1.1.1.2" xref="Sx3.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E3.m1.1b"><apply id="Sx3.E3.m1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1"><eq id="Sx3.E3.m1.1.1.1.1.6.cmml" xref="Sx3.E3.m1.1.1.1.1.6"></eq><apply id="Sx3.E3.m1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.2"><times id="Sx3.E3.m1.1.1.1.1.2.3.cmml" xref="Sx3.E3.m1.1.1.1.1.2.3"></times><ci id="Sx3.E3.m1.1.1.1.1.2.4.cmml" xref="Sx3.E3.m1.1.1.1.1.2.4">𝛼</ci><interval closure="open" id="Sx3.E3.m1.1.1.1.1.2.2.3.cmml" xref="Sx3.E3.m1.1.1.1.1.2.2.2"><apply id="Sx3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="Sx3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E3.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx3.E3.m1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E3.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx3.E3.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="Sx3.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx3.E3.m1.1.1.1.1.2.2.2.2.2">𝑥</ci><ci id="Sx3.E3.m1.1.1.1.1.2.2.2.2.3.cmml" xref="Sx3.E3.m1.1.1.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="Sx3.E3.m1.1.1.1.1.5.cmml" xref="Sx3.E3.m1.1.1.1.1.5"><plus id="Sx3.E3.m1.1.1.1.1.5.4.cmml" xref="Sx3.E3.m1.1.1.1.1.5.4"></plus><apply id="Sx3.E3.m1.1.1.1.1.3.1.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1"><times id="Sx3.E3.m1.1.1.1.1.3.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.2"></times><apply id="Sx3.E3.m1.1.1.1.1.3.1.3.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.1.3.1.3.1.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.3">subscript</csymbol><ci id="Sx3.E3.m1.1.1.1.1.3.1.3.2.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.3.2">𝑊</ci><ci id="Sx3.E3.m1.1.1.1.1.3.1.3.3.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.3.3">𝑞</ci></apply><apply id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1"><minus id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.1"></minus><apply id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2"><times id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.1.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.1"></times><apply id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.1.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2">subscript</csymbol><ci id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.2.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.2">𝑊</ci><ci id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.3.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.1.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3">subscript</csymbol><ci id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.2.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.2">𝑥</ci><ci id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.3.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3"><times id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.1.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.1"></times><apply id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.1.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2">subscript</csymbol><ci id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.2.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.2">𝑊</ci><ci id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.3.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.2.3">𝑗</ci></apply><apply id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.1.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3">subscript</csymbol><ci id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.2.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.2">𝑥</ci><ci id="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.3.cmml" xref="Sx3.E3.m1.1.1.1.1.3.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply></apply><apply id="Sx3.E3.m1.1.1.1.1.5.3.cmml" xref="Sx3.E3.m1.1.1.1.1.5.3"><times id="Sx3.E3.m1.1.1.1.1.5.3.3.cmml" xref="Sx3.E3.m1.1.1.1.1.5.3.3"></times><ci id="Sx3.E3.m1.1.1.1.1.5.3.4.cmml" xref="Sx3.E3.m1.1.1.1.1.5.3.4">𝑃</ci><ci id="Sx3.E3.m1.1.1.1.1.5.3.5.cmml" xref="Sx3.E3.m1.1.1.1.1.5.3.5">𝐸</ci><interval closure="open" id="Sx3.E3.m1.1.1.1.1.5.3.2.3.cmml" xref="Sx3.E3.m1.1.1.1.1.5.3.2.2"><apply id="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.4.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.1.cmml" xref="Sx3.E3.m1.1.1.1.1.4.2.1.1.1">subscript</csymbol><ci id="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.2.cmml" xref="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.2">𝑝</ci><ci id="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.3.cmml" xref="Sx3.E3.m1.1.1.1.1.4.2.1.1.1.3">𝑖</ci></apply><apply id="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.cmml" xref="Sx3.E3.m1.1.1.1.1.5.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.1.cmml" xref="Sx3.E3.m1.1.1.1.1.5.3.2.2.2">subscript</csymbol><ci id="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.2.cmml" xref="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.2">𝑝</ci><ci id="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.3.cmml" xref="Sx3.E3.m1.1.1.1.1.5.3.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E3.m1.1c">\displaystyle\alpha(x_{i},x_{j})=W_{q}(W_{i}x_{i}-W_{j}x_{j})+PE(p_{i},p_{j}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p1.9" class="ltx_p">where <math id="Sx3.SSx3.p1.8.m1.1" class="ltx_Math" alttext="x_{j}\in\mathcal{X}(i)" display="inline"><semantics id="Sx3.SSx3.p1.8.m1.1a"><mrow id="Sx3.SSx3.p1.8.m1.1.2" xref="Sx3.SSx3.p1.8.m1.1.2.cmml"><msub id="Sx3.SSx3.p1.8.m1.1.2.2" xref="Sx3.SSx3.p1.8.m1.1.2.2.cmml"><mi id="Sx3.SSx3.p1.8.m1.1.2.2.2" xref="Sx3.SSx3.p1.8.m1.1.2.2.2.cmml">x</mi><mi id="Sx3.SSx3.p1.8.m1.1.2.2.3" xref="Sx3.SSx3.p1.8.m1.1.2.2.3.cmml">j</mi></msub><mo id="Sx3.SSx3.p1.8.m1.1.2.1" xref="Sx3.SSx3.p1.8.m1.1.2.1.cmml">∈</mo><mrow id="Sx3.SSx3.p1.8.m1.1.2.3" xref="Sx3.SSx3.p1.8.m1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx3.p1.8.m1.1.2.3.2" xref="Sx3.SSx3.p1.8.m1.1.2.3.2.cmml">𝒳</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.8.m1.1.2.3.1" xref="Sx3.SSx3.p1.8.m1.1.2.3.1.cmml">​</mo><mrow id="Sx3.SSx3.p1.8.m1.1.2.3.3.2" xref="Sx3.SSx3.p1.8.m1.1.2.3.cmml"><mo stretchy="false" id="Sx3.SSx3.p1.8.m1.1.2.3.3.2.1" xref="Sx3.SSx3.p1.8.m1.1.2.3.cmml">(</mo><mi id="Sx3.SSx3.p1.8.m1.1.1" xref="Sx3.SSx3.p1.8.m1.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.SSx3.p1.8.m1.1.2.3.3.2.2" xref="Sx3.SSx3.p1.8.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.8.m1.1b"><apply id="Sx3.SSx3.p1.8.m1.1.2.cmml" xref="Sx3.SSx3.p1.8.m1.1.2"><in id="Sx3.SSx3.p1.8.m1.1.2.1.cmml" xref="Sx3.SSx3.p1.8.m1.1.2.1"></in><apply id="Sx3.SSx3.p1.8.m1.1.2.2.cmml" xref="Sx3.SSx3.p1.8.m1.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx3.p1.8.m1.1.2.2.1.cmml" xref="Sx3.SSx3.p1.8.m1.1.2.2">subscript</csymbol><ci id="Sx3.SSx3.p1.8.m1.1.2.2.2.cmml" xref="Sx3.SSx3.p1.8.m1.1.2.2.2">𝑥</ci><ci id="Sx3.SSx3.p1.8.m1.1.2.2.3.cmml" xref="Sx3.SSx3.p1.8.m1.1.2.2.3">𝑗</ci></apply><apply id="Sx3.SSx3.p1.8.m1.1.2.3.cmml" xref="Sx3.SSx3.p1.8.m1.1.2.3"><times id="Sx3.SSx3.p1.8.m1.1.2.3.1.cmml" xref="Sx3.SSx3.p1.8.m1.1.2.3.1"></times><ci id="Sx3.SSx3.p1.8.m1.1.2.3.2.cmml" xref="Sx3.SSx3.p1.8.m1.1.2.3.2">𝒳</ci><ci id="Sx3.SSx3.p1.8.m1.1.1.cmml" xref="Sx3.SSx3.p1.8.m1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.8.m1.1c">x_{j}\in\mathcal{X}(i)</annotation></semantics></math> and <math id="Sx3.SSx3.p1.9.m2.1" class="ltx_Math" alttext="PE" display="inline"><semantics id="Sx3.SSx3.p1.9.m2.1a"><mrow id="Sx3.SSx3.p1.9.m2.1.1" xref="Sx3.SSx3.p1.9.m2.1.1.cmml"><mi id="Sx3.SSx3.p1.9.m2.1.1.2" xref="Sx3.SSx3.p1.9.m2.1.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx3.p1.9.m2.1.1.1" xref="Sx3.SSx3.p1.9.m2.1.1.1.cmml">​</mo><mi id="Sx3.SSx3.p1.9.m2.1.1.3" xref="Sx3.SSx3.p1.9.m2.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p1.9.m2.1b"><apply id="Sx3.SSx3.p1.9.m2.1.1.cmml" xref="Sx3.SSx3.p1.9.m2.1.1"><times id="Sx3.SSx3.p1.9.m2.1.1.1.cmml" xref="Sx3.SSx3.p1.9.m2.1.1.1"></times><ci id="Sx3.SSx3.p1.9.m2.1.1.2.cmml" xref="Sx3.SSx3.p1.9.m2.1.1.2">𝑃</ci><ci id="Sx3.SSx3.p1.9.m2.1.1.3.cmml" xref="Sx3.SSx3.p1.9.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p1.9.m2.1c">PE</annotation></semantics></math> is a relative position encoding function defined as:</p>
<table id="A5.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E4.m1.1" class="ltx_Math" alttext="\displaystyle PE(p_{i},p_{j})=MLP(p_{i}-p_{j})." display="inline"><semantics id="Sx3.E4.m1.1a"><mrow id="Sx3.E4.m1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.cmml"><mrow id="Sx3.E4.m1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.cmml"><mrow id="Sx3.E4.m1.1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.2.cmml"><mi id="Sx3.E4.m1.1.1.1.1.2.4" xref="Sx3.E4.m1.1.1.1.1.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.2.3" xref="Sx3.E4.m1.1.1.1.1.2.3.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.2.5" xref="Sx3.E4.m1.1.1.1.1.2.5.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.2.3a" xref="Sx3.E4.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx3.E4.m1.1.1.1.1.2.2.2" xref="Sx3.E4.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.2.2.2.3" xref="Sx3.E4.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="Sx3.E4.m1.1.1.1.1.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="Sx3.E4.m1.1.1.1.1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.E4.m1.1.1.1.1.2.2.2.4" xref="Sx3.E4.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="Sx3.E4.m1.1.1.1.1.2.2.2.2" xref="Sx3.E4.m1.1.1.1.1.2.2.2.2.cmml"><mi id="Sx3.E4.m1.1.1.1.1.2.2.2.2.2" xref="Sx3.E4.m1.1.1.1.1.2.2.2.2.2.cmml">p</mi><mi id="Sx3.E4.m1.1.1.1.1.2.2.2.2.3" xref="Sx3.E4.m1.1.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.2.2.2.5" xref="Sx3.E4.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx3.E4.m1.1.1.1.1.4" xref="Sx3.E4.m1.1.1.1.1.4.cmml">=</mo><mrow id="Sx3.E4.m1.1.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.3.3" xref="Sx3.E4.m1.1.1.1.1.3.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.3.2" xref="Sx3.E4.m1.1.1.1.1.3.2.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.3.4" xref="Sx3.E4.m1.1.1.1.1.3.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.3.2a" xref="Sx3.E4.m1.1.1.1.1.3.2.cmml">​</mo><mi id="Sx3.E4.m1.1.1.1.1.3.5" xref="Sx3.E4.m1.1.1.1.1.3.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.E4.m1.1.1.1.1.3.2b" xref="Sx3.E4.m1.1.1.1.1.3.2.cmml">​</mo><mrow id="Sx3.E4.m1.1.1.1.1.3.1.1" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.cmml"><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.3.1.1.2" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.cmml">(</mo><mrow id="Sx3.E4.m1.1.1.1.1.3.1.1.1" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.cmml"><msub id="Sx3.E4.m1.1.1.1.1.3.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.cmml"><mi id="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.2" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.2.cmml">p</mi><mi id="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.3" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.3.cmml">i</mi></msub><mo id="Sx3.E4.m1.1.1.1.1.3.1.1.1.1" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.1.cmml">−</mo><msub id="Sx3.E4.m1.1.1.1.1.3.1.1.1.3" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.cmml"><mi id="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.2" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.2.cmml">p</mi><mi id="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.3" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="Sx3.E4.m1.1.1.1.1.3.1.1.3" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="Sx3.E4.m1.1.1.1.2" xref="Sx3.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E4.m1.1b"><apply id="Sx3.E4.m1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1"><eq id="Sx3.E4.m1.1.1.1.1.4.cmml" xref="Sx3.E4.m1.1.1.1.1.4"></eq><apply id="Sx3.E4.m1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2"><times id="Sx3.E4.m1.1.1.1.1.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.3"></times><ci id="Sx3.E4.m1.1.1.1.1.2.4.cmml" xref="Sx3.E4.m1.1.1.1.1.2.4">𝑃</ci><ci id="Sx3.E4.m1.1.1.1.1.2.5.cmml" xref="Sx3.E4.m1.1.1.1.1.2.5">𝐸</ci><interval closure="open" id="Sx3.E4.m1.1.1.1.1.2.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.2"><apply id="Sx3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="Sx3.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx3.E4.m1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.2.2.2">𝑝</ci><ci id="Sx3.E4.m1.1.1.1.1.2.2.2.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="Sx3.E4.m1.1.1.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.3"><times id="Sx3.E4.m1.1.1.1.1.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.3.2"></times><ci id="Sx3.E4.m1.1.1.1.1.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.3.3">𝑀</ci><ci id="Sx3.E4.m1.1.1.1.1.3.4.cmml" xref="Sx3.E4.m1.1.1.1.1.3.4">𝐿</ci><ci id="Sx3.E4.m1.1.1.1.1.3.5.cmml" xref="Sx3.E4.m1.1.1.1.1.3.5">𝑃</ci><apply id="Sx3.E4.m1.1.1.1.1.3.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.3.1.1"><minus id="Sx3.E4.m1.1.1.1.1.3.1.1.1.1.cmml" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.1"></minus><apply id="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.cmml" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.1.cmml" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.2">subscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.2.cmml" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.2">𝑝</ci><ci id="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.3.cmml" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.2.3">𝑖</ci></apply><apply id="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.cmml" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.1.cmml" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.3">subscript</csymbol><ci id="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.2.cmml" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.2">𝑝</ci><ci id="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.3.cmml" xref="Sx3.E4.m1.1.1.1.1.3.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E4.m1.1c">\displaystyle PE(p_{i},p_{j})=MLP(p_{i}-p_{j}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx3.p1.10" class="ltx_p">MLP in the formula represents two linear layers with a ReLU activation function.</p>
</div>
<div id="Sx3.SSx3.p2" class="ltx_para">
<p id="Sx3.SSx3.p2.6" class="ltx_p">Afterward, we aggregate the localized feature around of point <math id="Sx3.SSx3.p2.1.m1.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="Sx3.SSx3.p2.1.m1.1a"><msub id="Sx3.SSx3.p2.1.m1.1.1" xref="Sx3.SSx3.p2.1.m1.1.1.cmml"><mi id="Sx3.SSx3.p2.1.m1.1.1.2" xref="Sx3.SSx3.p2.1.m1.1.1.2.cmml">x</mi><mi id="Sx3.SSx3.p2.1.m1.1.1.3" xref="Sx3.SSx3.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.1.m1.1b"><apply id="Sx3.SSx3.p2.1.m1.1.1.cmml" xref="Sx3.SSx3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.1.m1.1.1.1.cmml" xref="Sx3.SSx3.p2.1.m1.1.1">subscript</csymbol><ci id="Sx3.SSx3.p2.1.m1.1.1.2.cmml" xref="Sx3.SSx3.p2.1.m1.1.1.2">𝑥</ci><ci id="Sx3.SSx3.p2.1.m1.1.1.3.cmml" xref="Sx3.SSx3.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.1.m1.1c">x_{i}</annotation></semantics></math> and obtain the aggregated feature <math id="Sx3.SSx3.p2.2.m2.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="Sx3.SSx3.p2.2.m2.1a"><msub id="Sx3.SSx3.p2.2.m2.1.1" xref="Sx3.SSx3.p2.2.m2.1.1.cmml"><mi id="Sx3.SSx3.p2.2.m2.1.1.2" xref="Sx3.SSx3.p2.2.m2.1.1.2.cmml">z</mi><mi id="Sx3.SSx3.p2.2.m2.1.1.3" xref="Sx3.SSx3.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.2.m2.1b"><apply id="Sx3.SSx3.p2.2.m2.1.1.cmml" xref="Sx3.SSx3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.2.m2.1.1.1.cmml" xref="Sx3.SSx3.p2.2.m2.1.1">subscript</csymbol><ci id="Sx3.SSx3.p2.2.m2.1.1.2.cmml" xref="Sx3.SSx3.p2.2.m2.1.1.2">𝑧</ci><ci id="Sx3.SSx3.p2.2.m2.1.1.3.cmml" xref="Sx3.SSx3.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.2.m2.1c">z_{i}</annotation></semantics></math> with a softmax function <math id="Sx3.SSx3.p2.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="Sx3.SSx3.p2.3.m3.1a"><mi id="Sx3.SSx3.p2.3.m3.1.1" xref="Sx3.SSx3.p2.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.3.m3.1b"><ci id="Sx3.SSx3.p2.3.m3.1.1.cmml" xref="Sx3.SSx3.p2.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.3.m3.1c">S</annotation></semantics></math>. Then the output <math id="Sx3.SSx3.p2.4.m4.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="Sx3.SSx3.p2.4.m4.1a"><msub id="Sx3.SSx3.p2.4.m4.1.1" xref="Sx3.SSx3.p2.4.m4.1.1.cmml"><mi id="Sx3.SSx3.p2.4.m4.1.1.2" xref="Sx3.SSx3.p2.4.m4.1.1.2.cmml">y</mi><mi id="Sx3.SSx3.p2.4.m4.1.1.3" xref="Sx3.SSx3.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.4.m4.1b"><apply id="Sx3.SSx3.p2.4.m4.1.1.cmml" xref="Sx3.SSx3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.4.m4.1.1.1.cmml" xref="Sx3.SSx3.p2.4.m4.1.1">subscript</csymbol><ci id="Sx3.SSx3.p2.4.m4.1.1.2.cmml" xref="Sx3.SSx3.p2.4.m4.1.1.2">𝑦</ci><ci id="Sx3.SSx3.p2.4.m4.1.1.3.cmml" xref="Sx3.SSx3.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.4.m4.1c">y_{i}</annotation></semantics></math> is computed by applying a residual connection between <math id="Sx3.SSx3.p2.5.m5.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="Sx3.SSx3.p2.5.m5.1a"><msub id="Sx3.SSx3.p2.5.m5.1.1" xref="Sx3.SSx3.p2.5.m5.1.1.cmml"><mi id="Sx3.SSx3.p2.5.m5.1.1.2" xref="Sx3.SSx3.p2.5.m5.1.1.2.cmml">x</mi><mi id="Sx3.SSx3.p2.5.m5.1.1.3" xref="Sx3.SSx3.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.5.m5.1b"><apply id="Sx3.SSx3.p2.5.m5.1.1.cmml" xref="Sx3.SSx3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.5.m5.1.1.1.cmml" xref="Sx3.SSx3.p2.5.m5.1.1">subscript</csymbol><ci id="Sx3.SSx3.p2.5.m5.1.1.2.cmml" xref="Sx3.SSx3.p2.5.m5.1.1.2">𝑥</ci><ci id="Sx3.SSx3.p2.5.m5.1.1.3.cmml" xref="Sx3.SSx3.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.5.m5.1c">x_{i}</annotation></semantics></math> and <math id="Sx3.SSx3.p2.6.m6.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="Sx3.SSx3.p2.6.m6.1a"><msub id="Sx3.SSx3.p2.6.m6.1.1" xref="Sx3.SSx3.p2.6.m6.1.1.cmml"><mi id="Sx3.SSx3.p2.6.m6.1.1.2" xref="Sx3.SSx3.p2.6.m6.1.1.2.cmml">z</mi><mi id="Sx3.SSx3.p2.6.m6.1.1.3" xref="Sx3.SSx3.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx3.p2.6.m6.1b"><apply id="Sx3.SSx3.p2.6.m6.1.1.cmml" xref="Sx3.SSx3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx3.p2.6.m6.1.1.1.cmml" xref="Sx3.SSx3.p2.6.m6.1.1">subscript</csymbol><ci id="Sx3.SSx3.p2.6.m6.1.1.2.cmml" xref="Sx3.SSx3.p2.6.m6.1.1.2">𝑧</ci><ci id="Sx3.SSx3.p2.6.m6.1.1.3.cmml" xref="Sx3.SSx3.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx3.p2.6.m6.1c">z_{i}</annotation></semantics></math>:</p>
<table id="A5.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E5.m1.2" class="ltx_Math" alttext="\displaystyle z_{i}=\sum_{x_{j}\in\mathcal{X}(i)}S(\alpha(x_{i},x_{j}))" display="inline"><semantics id="Sx3.E5.m1.2a"><mrow id="Sx3.E5.m1.2.2" xref="Sx3.E5.m1.2.2.cmml"><msub id="Sx3.E5.m1.2.2.3" xref="Sx3.E5.m1.2.2.3.cmml"><mi id="Sx3.E5.m1.2.2.3.2" xref="Sx3.E5.m1.2.2.3.2.cmml">z</mi><mi id="Sx3.E5.m1.2.2.3.3" xref="Sx3.E5.m1.2.2.3.3.cmml">i</mi></msub><mo id="Sx3.E5.m1.2.2.2" xref="Sx3.E5.m1.2.2.2.cmml">=</mo><mrow id="Sx3.E5.m1.2.2.1" xref="Sx3.E5.m1.2.2.1.cmml"><mstyle displaystyle="true" id="Sx3.E5.m1.2.2.1.2" xref="Sx3.E5.m1.2.2.1.2.cmml"><munder id="Sx3.E5.m1.2.2.1.2a" xref="Sx3.E5.m1.2.2.1.2.cmml"><mo movablelimits="false" id="Sx3.E5.m1.2.2.1.2.2" xref="Sx3.E5.m1.2.2.1.2.2.cmml">∑</mo><mrow id="Sx3.E5.m1.1.1.1" xref="Sx3.E5.m1.1.1.1.cmml"><msub id="Sx3.E5.m1.1.1.1.3" xref="Sx3.E5.m1.1.1.1.3.cmml"><mi id="Sx3.E5.m1.1.1.1.3.2" xref="Sx3.E5.m1.1.1.1.3.2.cmml">x</mi><mi id="Sx3.E5.m1.1.1.1.3.3" xref="Sx3.E5.m1.1.1.1.3.3.cmml">j</mi></msub><mo id="Sx3.E5.m1.1.1.1.2" xref="Sx3.E5.m1.1.1.1.2.cmml">∈</mo><mrow id="Sx3.E5.m1.1.1.1.4" xref="Sx3.E5.m1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E5.m1.1.1.1.4.2" xref="Sx3.E5.m1.1.1.1.4.2.cmml">𝒳</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.1.1.1.4.1" xref="Sx3.E5.m1.1.1.1.4.1.cmml">​</mo><mrow id="Sx3.E5.m1.1.1.1.4.3.2" xref="Sx3.E5.m1.1.1.1.4.cmml"><mo stretchy="false" id="Sx3.E5.m1.1.1.1.4.3.2.1" xref="Sx3.E5.m1.1.1.1.4.cmml">(</mo><mi id="Sx3.E5.m1.1.1.1.1" xref="Sx3.E5.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.E5.m1.1.1.1.4.3.2.2" xref="Sx3.E5.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></munder></mstyle><mrow id="Sx3.E5.m1.2.2.1.1" xref="Sx3.E5.m1.2.2.1.1.cmml"><mi id="Sx3.E5.m1.2.2.1.1.3" xref="Sx3.E5.m1.2.2.1.1.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.2.2.1.1.2" xref="Sx3.E5.m1.2.2.1.1.2.cmml">​</mo><mrow id="Sx3.E5.m1.2.2.1.1.1.1" xref="Sx3.E5.m1.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m1.2.2.1.1.1.1.2" xref="Sx3.E5.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E5.m1.2.2.1.1.1.1.1" xref="Sx3.E5.m1.2.2.1.1.1.1.1.cmml"><mi id="Sx3.E5.m1.2.2.1.1.1.1.1.4" xref="Sx3.E5.m1.2.2.1.1.1.1.1.4.cmml">α</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m1.2.2.1.1.1.1.1.3" xref="Sx3.E5.m1.2.2.1.1.1.1.1.3.cmml">​</mo><mrow id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.3" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.3.cmml">(</mo><msub id="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1" xref="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.2" xref="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.3" xref="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.4" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.3.cmml">,</mo><msub id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.cmml"><mi id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.2" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.2.cmml">x</mi><mi id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.3" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.5" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E5.m1.2.2.1.1.1.1.3" xref="Sx3.E5.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E5.m1.2b"><apply id="Sx3.E5.m1.2.2.cmml" xref="Sx3.E5.m1.2.2"><eq id="Sx3.E5.m1.2.2.2.cmml" xref="Sx3.E5.m1.2.2.2"></eq><apply id="Sx3.E5.m1.2.2.3.cmml" xref="Sx3.E5.m1.2.2.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.2.2.3.1.cmml" xref="Sx3.E5.m1.2.2.3">subscript</csymbol><ci id="Sx3.E5.m1.2.2.3.2.cmml" xref="Sx3.E5.m1.2.2.3.2">𝑧</ci><ci id="Sx3.E5.m1.2.2.3.3.cmml" xref="Sx3.E5.m1.2.2.3.3">𝑖</ci></apply><apply id="Sx3.E5.m1.2.2.1.cmml" xref="Sx3.E5.m1.2.2.1"><apply id="Sx3.E5.m1.2.2.1.2.cmml" xref="Sx3.E5.m1.2.2.1.2"><csymbol cd="ambiguous" id="Sx3.E5.m1.2.2.1.2.1.cmml" xref="Sx3.E5.m1.2.2.1.2">subscript</csymbol><sum id="Sx3.E5.m1.2.2.1.2.2.cmml" xref="Sx3.E5.m1.2.2.1.2.2"></sum><apply id="Sx3.E5.m1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1"><in id="Sx3.E5.m1.1.1.1.2.cmml" xref="Sx3.E5.m1.1.1.1.2"></in><apply id="Sx3.E5.m1.1.1.1.3.cmml" xref="Sx3.E5.m1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E5.m1.1.1.1.3.1.cmml" xref="Sx3.E5.m1.1.1.1.3">subscript</csymbol><ci id="Sx3.E5.m1.1.1.1.3.2.cmml" xref="Sx3.E5.m1.1.1.1.3.2">𝑥</ci><ci id="Sx3.E5.m1.1.1.1.3.3.cmml" xref="Sx3.E5.m1.1.1.1.3.3">𝑗</ci></apply><apply id="Sx3.E5.m1.1.1.1.4.cmml" xref="Sx3.E5.m1.1.1.1.4"><times id="Sx3.E5.m1.1.1.1.4.1.cmml" xref="Sx3.E5.m1.1.1.1.4.1"></times><ci id="Sx3.E5.m1.1.1.1.4.2.cmml" xref="Sx3.E5.m1.1.1.1.4.2">𝒳</ci><ci id="Sx3.E5.m1.1.1.1.1.cmml" xref="Sx3.E5.m1.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="Sx3.E5.m1.2.2.1.1.cmml" xref="Sx3.E5.m1.2.2.1.1"><times id="Sx3.E5.m1.2.2.1.1.2.cmml" xref="Sx3.E5.m1.2.2.1.1.2"></times><ci id="Sx3.E5.m1.2.2.1.1.3.cmml" xref="Sx3.E5.m1.2.2.1.1.3">𝑆</ci><apply id="Sx3.E5.m1.2.2.1.1.1.1.1.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1"><times id="Sx3.E5.m1.2.2.1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.3"></times><ci id="Sx3.E5.m1.2.2.1.1.1.1.1.4.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.4">𝛼</ci><interval closure="open" id="Sx3.E5.m1.2.2.1.1.1.1.1.2.3.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.2"><apply id="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.2">𝑥</ci><ci id="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.E5.m1.2.2.1.1.1.1.1.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E5.m1.2c">\displaystyle z_{i}=\sum_{x_{j}\in\mathcal{X}(i)}S(\alpha(x_{i},x_{j}))</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E5.m2.1" class="ltx_Math" alttext="\displaystyle\cdot(W_{v}x_{j}+PE(p_{i},p_{j}))," display="inline"><semantics id="Sx3.E5.m2.1a"><mrow id="Sx3.E5.m2.1.1.1" xref="Sx3.E5.m2.1.1.1.1.cmml"><mrow id="Sx3.E5.m2.1.1.1.1" xref="Sx3.E5.m2.1.1.1.1.cmml"><mi id="Sx3.E5.m2.1.1.1.1.3" xref="Sx3.E5.m2.1.1.1.1.3.cmml"></mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.E5.m2.1.1.1.1.2" xref="Sx3.E5.m2.1.1.1.1.2.cmml">⋅</mo><mrow id="Sx3.E5.m2.1.1.1.1.1.1" xref="Sx3.E5.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E5.m2.1.1.1.1.1.1.2" xref="Sx3.E5.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E5.m2.1.1.1.1.1.1.1" xref="Sx3.E5.m2.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E5.m2.1.1.1.1.1.1.1.4" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.cmml"><msub id="Sx3.E5.m2.1.1.1.1.1.1.1.4.2" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.cmml"><mi id="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.2" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.2.cmml">W</mi><mi id="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.3" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E5.m2.1.1.1.1.1.1.1.4.1" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.1.cmml">​</mo><msub id="Sx3.E5.m2.1.1.1.1.1.1.1.4.3" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.cmml"><mi id="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.2" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.2.cmml">x</mi><mi id="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.3" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.3.cmml">j</mi></msub></mrow><mo id="Sx3.E5.m2.1.1.1.1.1.1.1.3" xref="Sx3.E5.m2.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="Sx3.E5.m2.1.1.1.1.1.1.1.2" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E5.m2.1.1.1.1.1.1.1.2.4" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m2.1.1.1.1.1.1.1.2.3" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.3.cmml">​</mo><mi id="Sx3.E5.m2.1.1.1.1.1.1.1.2.5" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.5.cmml">E</mi><mo lspace="0em" rspace="0em" id="Sx3.E5.m2.1.1.1.1.1.1.1.2.3a" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.3" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.4" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.2" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.2.cmml">p</mi><mi id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.3" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.5" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E5.m2.1.1.1.1.1.1.3" xref="Sx3.E5.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E5.m2.1.1.1.2" xref="Sx3.E5.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E5.m2.1b"><apply id="Sx3.E5.m2.1.1.1.1.cmml" xref="Sx3.E5.m2.1.1.1"><ci id="Sx3.E5.m2.1.1.1.1.2.cmml" xref="Sx3.E5.m2.1.1.1.1.2">⋅</ci><csymbol cd="latexml" id="Sx3.E5.m2.1.1.1.1.3.cmml" xref="Sx3.E5.m2.1.1.1.1.3">absent</csymbol><apply id="Sx3.E5.m2.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1"><plus id="Sx3.E5.m2.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.3"></plus><apply id="Sx3.E5.m2.1.1.1.1.1.1.1.4.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4"><times id="Sx3.E5.m2.1.1.1.1.1.1.1.4.1.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.1"></times><apply id="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.1.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.2.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.2">𝑊</ci><ci id="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.3.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.2.3">𝑣</ci></apply><apply id="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.3"><csymbol cd="ambiguous" id="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.1.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.3">subscript</csymbol><ci id="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.2.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.2">𝑥</ci><ci id="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.3.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.4.3.3">𝑗</ci></apply></apply><apply id="Sx3.E5.m2.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2"><times id="Sx3.E5.m2.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.3"></times><ci id="Sx3.E5.m2.1.1.1.1.1.1.1.2.4.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.4">𝑃</ci><ci id="Sx3.E5.m2.1.1.1.1.1.1.1.2.5.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.5">𝐸</ci><interval closure="open" id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2"><apply id="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.2">𝑝</ci><ci id="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="Sx3.E5.m2.1.1.1.1.1.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E5.m2.1c">\displaystyle\cdot(W_{v}x_{j}+PE(p_{i},p_{j})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
<tbody id="Sx3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E6.m1.1" class="ltx_Math" alttext="\displaystyle y_{i}=x_{i}" display="inline"><semantics id="Sx3.E6.m1.1a"><mrow id="Sx3.E6.m1.1.1" xref="Sx3.E6.m1.1.1.cmml"><msub id="Sx3.E6.m1.1.1.2" xref="Sx3.E6.m1.1.1.2.cmml"><mi id="Sx3.E6.m1.1.1.2.2" xref="Sx3.E6.m1.1.1.2.2.cmml">y</mi><mi id="Sx3.E6.m1.1.1.2.3" xref="Sx3.E6.m1.1.1.2.3.cmml">i</mi></msub><mo id="Sx3.E6.m1.1.1.1" xref="Sx3.E6.m1.1.1.1.cmml">=</mo><msub id="Sx3.E6.m1.1.1.3" xref="Sx3.E6.m1.1.1.3.cmml"><mi id="Sx3.E6.m1.1.1.3.2" xref="Sx3.E6.m1.1.1.3.2.cmml">x</mi><mi id="Sx3.E6.m1.1.1.3.3" xref="Sx3.E6.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E6.m1.1b"><apply id="Sx3.E6.m1.1.1.cmml" xref="Sx3.E6.m1.1.1"><eq id="Sx3.E6.m1.1.1.1.cmml" xref="Sx3.E6.m1.1.1.1"></eq><apply id="Sx3.E6.m1.1.1.2.cmml" xref="Sx3.E6.m1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E6.m1.1.1.2.1.cmml" xref="Sx3.E6.m1.1.1.2">subscript</csymbol><ci id="Sx3.E6.m1.1.1.2.2.cmml" xref="Sx3.E6.m1.1.1.2.2">𝑦</ci><ci id="Sx3.E6.m1.1.1.2.3.cmml" xref="Sx3.E6.m1.1.1.2.3">𝑖</ci></apply><apply id="Sx3.E6.m1.1.1.3.cmml" xref="Sx3.E6.m1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E6.m1.1.1.3.1.cmml" xref="Sx3.E6.m1.1.1.3">subscript</csymbol><ci id="Sx3.E6.m1.1.1.3.2.cmml" xref="Sx3.E6.m1.1.1.3.2">𝑥</ci><ci id="Sx3.E6.m1.1.1.3.3.cmml" xref="Sx3.E6.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E6.m1.1c">\displaystyle y_{i}=x_{i}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E6.m2.1" class="ltx_Math" alttext="\displaystyle+W_{z}z_{i}." display="inline"><semantics id="Sx3.E6.m2.1a"><mrow id="Sx3.E6.m2.1.1.1" xref="Sx3.E6.m2.1.1.1.1.cmml"><mrow id="Sx3.E6.m2.1.1.1.1" xref="Sx3.E6.m2.1.1.1.1.cmml"><mo id="Sx3.E6.m2.1.1.1.1a" xref="Sx3.E6.m2.1.1.1.1.cmml">+</mo><mrow id="Sx3.E6.m2.1.1.1.1.2" xref="Sx3.E6.m2.1.1.1.1.2.cmml"><msub id="Sx3.E6.m2.1.1.1.1.2.2" xref="Sx3.E6.m2.1.1.1.1.2.2.cmml"><mi id="Sx3.E6.m2.1.1.1.1.2.2.2" xref="Sx3.E6.m2.1.1.1.1.2.2.2.cmml">W</mi><mi id="Sx3.E6.m2.1.1.1.1.2.2.3" xref="Sx3.E6.m2.1.1.1.1.2.2.3.cmml">z</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E6.m2.1.1.1.1.2.1" xref="Sx3.E6.m2.1.1.1.1.2.1.cmml">​</mo><msub id="Sx3.E6.m2.1.1.1.1.2.3" xref="Sx3.E6.m2.1.1.1.1.2.3.cmml"><mi id="Sx3.E6.m2.1.1.1.1.2.3.2" xref="Sx3.E6.m2.1.1.1.1.2.3.2.cmml">z</mi><mi id="Sx3.E6.m2.1.1.1.1.2.3.3" xref="Sx3.E6.m2.1.1.1.1.2.3.3.cmml">i</mi></msub></mrow></mrow><mo lspace="0em" id="Sx3.E6.m2.1.1.1.2" xref="Sx3.E6.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E6.m2.1b"><apply id="Sx3.E6.m2.1.1.1.1.cmml" xref="Sx3.E6.m2.1.1.1"><plus id="Sx3.E6.m2.1.1.1.1.1.cmml" xref="Sx3.E6.m2.1.1.1"></plus><apply id="Sx3.E6.m2.1.1.1.1.2.cmml" xref="Sx3.E6.m2.1.1.1.1.2"><times id="Sx3.E6.m2.1.1.1.1.2.1.cmml" xref="Sx3.E6.m2.1.1.1.1.2.1"></times><apply id="Sx3.E6.m2.1.1.1.1.2.2.cmml" xref="Sx3.E6.m2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E6.m2.1.1.1.1.2.2.1.cmml" xref="Sx3.E6.m2.1.1.1.1.2.2">subscript</csymbol><ci id="Sx3.E6.m2.1.1.1.1.2.2.2.cmml" xref="Sx3.E6.m2.1.1.1.1.2.2.2">𝑊</ci><ci id="Sx3.E6.m2.1.1.1.1.2.2.3.cmml" xref="Sx3.E6.m2.1.1.1.1.2.2.3">𝑧</ci></apply><apply id="Sx3.E6.m2.1.1.1.1.2.3.cmml" xref="Sx3.E6.m2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.E6.m2.1.1.1.1.2.3.1.cmml" xref="Sx3.E6.m2.1.1.1.1.2.3">subscript</csymbol><ci id="Sx3.E6.m2.1.1.1.1.2.3.2.cmml" xref="Sx3.E6.m2.1.1.1.1.2.3.2">𝑧</ci><ci id="Sx3.E6.m2.1.1.1.1.2.3.3.cmml" xref="Sx3.E6.m2.1.1.1.1.2.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E6.m2.1c">\displaystyle+W_{z}z_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="Sx3.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Point Abstraction Block</h3>

<div id="Sx3.SSx4.p1" class="ltx_para">
<p id="Sx3.SSx4.p1.1" class="ltx_p">To effectively reduce the cardinality of a point set and capture the long-range dependencies without missing important points, we propose a novel sampling strategy named farthest cosine sampling (FCS), as an alternative to the farthest point sampling (FPS)  <cite class="ltx_cite ltx_citemacro_citep">(Qi et al. <a href="#bib.bib36" title="" class="ltx_ref">2017b</a>)</cite>.</p>
</div>
<div id="Sx3.SSx4.p2" class="ltx_para">
<p id="Sx3.SSx4.p2.2" class="ltx_p">In scenarios where a WSI exhibits a majority of negative patches with only a few positive patches clustered together in a specific region, FPS may miss these positive patches, as depicted in Figure <a href="#Sx3.F3" title="Figure 3 ‣ Point Abstraction Block ‣ Methodology ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Consequently, it can lead to false negative predictions of HER2 status. Contrary to FPS, we perform sampling in the feature space, not in the position space. For a point set <math id="Sx3.SSx4.p2.1.m1.4" class="ltx_Math" alttext="\mathcal{X}_{1}=\{x_{1},x_{2},...,x_{M}\}" display="inline"><semantics id="Sx3.SSx4.p2.1.m1.4a"><mrow id="Sx3.SSx4.p2.1.m1.4.4" xref="Sx3.SSx4.p2.1.m1.4.4.cmml"><msub id="Sx3.SSx4.p2.1.m1.4.4.5" xref="Sx3.SSx4.p2.1.m1.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.p2.1.m1.4.4.5.2" xref="Sx3.SSx4.p2.1.m1.4.4.5.2.cmml">𝒳</mi><mn id="Sx3.SSx4.p2.1.m1.4.4.5.3" xref="Sx3.SSx4.p2.1.m1.4.4.5.3.cmml">1</mn></msub><mo id="Sx3.SSx4.p2.1.m1.4.4.4" xref="Sx3.SSx4.p2.1.m1.4.4.4.cmml">=</mo><mrow id="Sx3.SSx4.p2.1.m1.4.4.3.3" xref="Sx3.SSx4.p2.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="Sx3.SSx4.p2.1.m1.4.4.3.3.4" xref="Sx3.SSx4.p2.1.m1.4.4.3.4.cmml">{</mo><msub id="Sx3.SSx4.p2.1.m1.2.2.1.1.1" xref="Sx3.SSx4.p2.1.m1.2.2.1.1.1.cmml"><mi id="Sx3.SSx4.p2.1.m1.2.2.1.1.1.2" xref="Sx3.SSx4.p2.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="Sx3.SSx4.p2.1.m1.2.2.1.1.1.3" xref="Sx3.SSx4.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="Sx3.SSx4.p2.1.m1.4.4.3.3.5" xref="Sx3.SSx4.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="Sx3.SSx4.p2.1.m1.3.3.2.2.2" xref="Sx3.SSx4.p2.1.m1.3.3.2.2.2.cmml"><mi id="Sx3.SSx4.p2.1.m1.3.3.2.2.2.2" xref="Sx3.SSx4.p2.1.m1.3.3.2.2.2.2.cmml">x</mi><mn id="Sx3.SSx4.p2.1.m1.3.3.2.2.2.3" xref="Sx3.SSx4.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="Sx3.SSx4.p2.1.m1.4.4.3.3.6" xref="Sx3.SSx4.p2.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx4.p2.1.m1.1.1" xref="Sx3.SSx4.p2.1.m1.1.1.cmml">…</mi><mo id="Sx3.SSx4.p2.1.m1.4.4.3.3.7" xref="Sx3.SSx4.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="Sx3.SSx4.p2.1.m1.4.4.3.3.3" xref="Sx3.SSx4.p2.1.m1.4.4.3.3.3.cmml"><mi id="Sx3.SSx4.p2.1.m1.4.4.3.3.3.2" xref="Sx3.SSx4.p2.1.m1.4.4.3.3.3.2.cmml">x</mi><mi id="Sx3.SSx4.p2.1.m1.4.4.3.3.3.3" xref="Sx3.SSx4.p2.1.m1.4.4.3.3.3.3.cmml">M</mi></msub><mo stretchy="false" id="Sx3.SSx4.p2.1.m1.4.4.3.3.8" xref="Sx3.SSx4.p2.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p2.1.m1.4b"><apply id="Sx3.SSx4.p2.1.m1.4.4.cmml" xref="Sx3.SSx4.p2.1.m1.4.4"><eq id="Sx3.SSx4.p2.1.m1.4.4.4.cmml" xref="Sx3.SSx4.p2.1.m1.4.4.4"></eq><apply id="Sx3.SSx4.p2.1.m1.4.4.5.cmml" xref="Sx3.SSx4.p2.1.m1.4.4.5"><csymbol cd="ambiguous" id="Sx3.SSx4.p2.1.m1.4.4.5.1.cmml" xref="Sx3.SSx4.p2.1.m1.4.4.5">subscript</csymbol><ci id="Sx3.SSx4.p2.1.m1.4.4.5.2.cmml" xref="Sx3.SSx4.p2.1.m1.4.4.5.2">𝒳</ci><cn type="integer" id="Sx3.SSx4.p2.1.m1.4.4.5.3.cmml" xref="Sx3.SSx4.p2.1.m1.4.4.5.3">1</cn></apply><set id="Sx3.SSx4.p2.1.m1.4.4.3.4.cmml" xref="Sx3.SSx4.p2.1.m1.4.4.3.3"><apply id="Sx3.SSx4.p2.1.m1.2.2.1.1.1.cmml" xref="Sx3.SSx4.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.p2.1.m1.2.2.1.1.1.1.cmml" xref="Sx3.SSx4.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="Sx3.SSx4.p2.1.m1.2.2.1.1.1.2.cmml" xref="Sx3.SSx4.p2.1.m1.2.2.1.1.1.2">𝑥</ci><cn type="integer" id="Sx3.SSx4.p2.1.m1.2.2.1.1.1.3.cmml" xref="Sx3.SSx4.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="Sx3.SSx4.p2.1.m1.3.3.2.2.2.cmml" xref="Sx3.SSx4.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx4.p2.1.m1.3.3.2.2.2.1.cmml" xref="Sx3.SSx4.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="Sx3.SSx4.p2.1.m1.3.3.2.2.2.2.cmml" xref="Sx3.SSx4.p2.1.m1.3.3.2.2.2.2">𝑥</ci><cn type="integer" id="Sx3.SSx4.p2.1.m1.3.3.2.2.2.3.cmml" xref="Sx3.SSx4.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="Sx3.SSx4.p2.1.m1.1.1.cmml" xref="Sx3.SSx4.p2.1.m1.1.1">…</ci><apply id="Sx3.SSx4.p2.1.m1.4.4.3.3.3.cmml" xref="Sx3.SSx4.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx4.p2.1.m1.4.4.3.3.3.1.cmml" xref="Sx3.SSx4.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="Sx3.SSx4.p2.1.m1.4.4.3.3.3.2.cmml" xref="Sx3.SSx4.p2.1.m1.4.4.3.3.3.2">𝑥</ci><ci id="Sx3.SSx4.p2.1.m1.4.4.3.3.3.3.cmml" xref="Sx3.SSx4.p2.1.m1.4.4.3.3.3.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p2.1.m1.4c">\mathcal{X}_{1}=\{x_{1},x_{2},...,x_{M}\}</annotation></semantics></math> with M points, we define the cosine distance as the distance metric between two points <math id="Sx3.SSx4.p2.2.m2.2" class="ltx_Math" alttext="x_{i},x_{j}\in\mathcal{X}_{1}" display="inline"><semantics id="Sx3.SSx4.p2.2.m2.2a"><mrow id="Sx3.SSx4.p2.2.m2.2.2" xref="Sx3.SSx4.p2.2.m2.2.2.cmml"><mrow id="Sx3.SSx4.p2.2.m2.2.2.2.2" xref="Sx3.SSx4.p2.2.m2.2.2.2.3.cmml"><msub id="Sx3.SSx4.p2.2.m2.1.1.1.1.1" xref="Sx3.SSx4.p2.2.m2.1.1.1.1.1.cmml"><mi id="Sx3.SSx4.p2.2.m2.1.1.1.1.1.2" xref="Sx3.SSx4.p2.2.m2.1.1.1.1.1.2.cmml">x</mi><mi id="Sx3.SSx4.p2.2.m2.1.1.1.1.1.3" xref="Sx3.SSx4.p2.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.SSx4.p2.2.m2.2.2.2.2.3" xref="Sx3.SSx4.p2.2.m2.2.2.2.3.cmml">,</mo><msub id="Sx3.SSx4.p2.2.m2.2.2.2.2.2" xref="Sx3.SSx4.p2.2.m2.2.2.2.2.2.cmml"><mi id="Sx3.SSx4.p2.2.m2.2.2.2.2.2.2" xref="Sx3.SSx4.p2.2.m2.2.2.2.2.2.2.cmml">x</mi><mi id="Sx3.SSx4.p2.2.m2.2.2.2.2.2.3" xref="Sx3.SSx4.p2.2.m2.2.2.2.2.2.3.cmml">j</mi></msub></mrow><mo id="Sx3.SSx4.p2.2.m2.2.2.3" xref="Sx3.SSx4.p2.2.m2.2.2.3.cmml">∈</mo><msub id="Sx3.SSx4.p2.2.m2.2.2.4" xref="Sx3.SSx4.p2.2.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.p2.2.m2.2.2.4.2" xref="Sx3.SSx4.p2.2.m2.2.2.4.2.cmml">𝒳</mi><mn id="Sx3.SSx4.p2.2.m2.2.2.4.3" xref="Sx3.SSx4.p2.2.m2.2.2.4.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p2.2.m2.2b"><apply id="Sx3.SSx4.p2.2.m2.2.2.cmml" xref="Sx3.SSx4.p2.2.m2.2.2"><in id="Sx3.SSx4.p2.2.m2.2.2.3.cmml" xref="Sx3.SSx4.p2.2.m2.2.2.3"></in><list id="Sx3.SSx4.p2.2.m2.2.2.2.3.cmml" xref="Sx3.SSx4.p2.2.m2.2.2.2.2"><apply id="Sx3.SSx4.p2.2.m2.1.1.1.1.1.cmml" xref="Sx3.SSx4.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.p2.2.m2.1.1.1.1.1.1.cmml" xref="Sx3.SSx4.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx4.p2.2.m2.1.1.1.1.1.2.cmml" xref="Sx3.SSx4.p2.2.m2.1.1.1.1.1.2">𝑥</ci><ci id="Sx3.SSx4.p2.2.m2.1.1.1.1.1.3.cmml" xref="Sx3.SSx4.p2.2.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx3.SSx4.p2.2.m2.2.2.2.2.2.cmml" xref="Sx3.SSx4.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx4.p2.2.m2.2.2.2.2.2.1.cmml" xref="Sx3.SSx4.p2.2.m2.2.2.2.2.2">subscript</csymbol><ci id="Sx3.SSx4.p2.2.m2.2.2.2.2.2.2.cmml" xref="Sx3.SSx4.p2.2.m2.2.2.2.2.2.2">𝑥</ci><ci id="Sx3.SSx4.p2.2.m2.2.2.2.2.2.3.cmml" xref="Sx3.SSx4.p2.2.m2.2.2.2.2.2.3">𝑗</ci></apply></list><apply id="Sx3.SSx4.p2.2.m2.2.2.4.cmml" xref="Sx3.SSx4.p2.2.m2.2.2.4"><csymbol cd="ambiguous" id="Sx3.SSx4.p2.2.m2.2.2.4.1.cmml" xref="Sx3.SSx4.p2.2.m2.2.2.4">subscript</csymbol><ci id="Sx3.SSx4.p2.2.m2.2.2.4.2.cmml" xref="Sx3.SSx4.p2.2.m2.2.2.4.2">𝒳</ci><cn type="integer" id="Sx3.SSx4.p2.2.m2.2.2.4.3.cmml" xref="Sx3.SSx4.p2.2.m2.2.2.4.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p2.2.m2.2c">x_{i},x_{j}\in\mathcal{X}_{1}</annotation></semantics></math>:</p>
<table id="A5.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E7.m1.4" class="ltx_Math" alttext="\displaystyle Dist(x_{i},x_{j})=1-\frac{x_{i}\cdot x_{j}}{\max(||x_{i}||_{2}\cdot||x_{j}||_{2},1e-8)}." display="inline"><semantics id="Sx3.E7.m1.4a"><mrow id="Sx3.E7.m1.4.4.1" xref="Sx3.E7.m1.4.4.1.1.cmml"><mrow id="Sx3.E7.m1.4.4.1.1" xref="Sx3.E7.m1.4.4.1.1.cmml"><mrow id="Sx3.E7.m1.4.4.1.1.2" xref="Sx3.E7.m1.4.4.1.1.2.cmml"><mi id="Sx3.E7.m1.4.4.1.1.2.4" xref="Sx3.E7.m1.4.4.1.1.2.4.cmml">D</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.4.4.1.1.2.3" xref="Sx3.E7.m1.4.4.1.1.2.3.cmml">​</mo><mi id="Sx3.E7.m1.4.4.1.1.2.5" xref="Sx3.E7.m1.4.4.1.1.2.5.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.4.4.1.1.2.3a" xref="Sx3.E7.m1.4.4.1.1.2.3.cmml">​</mo><mi id="Sx3.E7.m1.4.4.1.1.2.6" xref="Sx3.E7.m1.4.4.1.1.2.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.4.4.1.1.2.3b" xref="Sx3.E7.m1.4.4.1.1.2.3.cmml">​</mo><mi id="Sx3.E7.m1.4.4.1.1.2.7" xref="Sx3.E7.m1.4.4.1.1.2.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.4.4.1.1.2.3c" xref="Sx3.E7.m1.4.4.1.1.2.3.cmml">​</mo><mrow id="Sx3.E7.m1.4.4.1.1.2.2.2" xref="Sx3.E7.m1.4.4.1.1.2.2.3.cmml"><mo stretchy="false" id="Sx3.E7.m1.4.4.1.1.2.2.2.3" xref="Sx3.E7.m1.4.4.1.1.2.2.3.cmml">(</mo><msub id="Sx3.E7.m1.4.4.1.1.1.1.1.1" xref="Sx3.E7.m1.4.4.1.1.1.1.1.1.cmml"><mi id="Sx3.E7.m1.4.4.1.1.1.1.1.1.2" xref="Sx3.E7.m1.4.4.1.1.1.1.1.1.2.cmml">x</mi><mi id="Sx3.E7.m1.4.4.1.1.1.1.1.1.3" xref="Sx3.E7.m1.4.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="Sx3.E7.m1.4.4.1.1.2.2.2.4" xref="Sx3.E7.m1.4.4.1.1.2.2.3.cmml">,</mo><msub id="Sx3.E7.m1.4.4.1.1.2.2.2.2" xref="Sx3.E7.m1.4.4.1.1.2.2.2.2.cmml"><mi id="Sx3.E7.m1.4.4.1.1.2.2.2.2.2" xref="Sx3.E7.m1.4.4.1.1.2.2.2.2.2.cmml">x</mi><mi id="Sx3.E7.m1.4.4.1.1.2.2.2.2.3" xref="Sx3.E7.m1.4.4.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="Sx3.E7.m1.4.4.1.1.2.2.2.5" xref="Sx3.E7.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="Sx3.E7.m1.4.4.1.1.3" xref="Sx3.E7.m1.4.4.1.1.3.cmml">=</mo><mrow id="Sx3.E7.m1.4.4.1.1.4" xref="Sx3.E7.m1.4.4.1.1.4.cmml"><mn id="Sx3.E7.m1.4.4.1.1.4.2" xref="Sx3.E7.m1.4.4.1.1.4.2.cmml">1</mn><mo id="Sx3.E7.m1.4.4.1.1.4.1" xref="Sx3.E7.m1.4.4.1.1.4.1.cmml">−</mo><mstyle displaystyle="true" id="Sx3.E7.m1.3.3" xref="Sx3.E7.m1.3.3.cmml"><mfrac id="Sx3.E7.m1.3.3a" xref="Sx3.E7.m1.3.3.cmml"><mrow id="Sx3.E7.m1.3.3.5" xref="Sx3.E7.m1.3.3.5.cmml"><msub id="Sx3.E7.m1.3.3.5.2" xref="Sx3.E7.m1.3.3.5.2.cmml"><mi id="Sx3.E7.m1.3.3.5.2.2" xref="Sx3.E7.m1.3.3.5.2.2.cmml">x</mi><mi id="Sx3.E7.m1.3.3.5.2.3" xref="Sx3.E7.m1.3.3.5.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="Sx3.E7.m1.3.3.5.1" xref="Sx3.E7.m1.3.3.5.1.cmml">⋅</mo><msub id="Sx3.E7.m1.3.3.5.3" xref="Sx3.E7.m1.3.3.5.3.cmml"><mi id="Sx3.E7.m1.3.3.5.3.2" xref="Sx3.E7.m1.3.3.5.3.2.cmml">x</mi><mi id="Sx3.E7.m1.3.3.5.3.3" xref="Sx3.E7.m1.3.3.5.3.3.cmml">j</mi></msub></mrow><mrow id="Sx3.E7.m1.3.3.3.3" xref="Sx3.E7.m1.3.3.3.4.cmml"><mi id="Sx3.E7.m1.1.1.1.1" xref="Sx3.E7.m1.1.1.1.1.cmml">max</mi><mo id="Sx3.E7.m1.3.3.3.3a" xref="Sx3.E7.m1.3.3.3.4.cmml">⁡</mo><mrow id="Sx3.E7.m1.3.3.3.3.2" xref="Sx3.E7.m1.3.3.3.4.cmml"><mo stretchy="false" id="Sx3.E7.m1.3.3.3.3.2.3" xref="Sx3.E7.m1.3.3.3.4.cmml">(</mo><mrow id="Sx3.E7.m1.2.2.2.2.1.1" xref="Sx3.E7.m1.2.2.2.2.1.1.cmml"><msub id="Sx3.E7.m1.2.2.2.2.1.1.1" xref="Sx3.E7.m1.2.2.2.2.1.1.1.cmml"><mrow id="Sx3.E7.m1.2.2.2.2.1.1.1.1.1" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.2" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.2.1.cmml">‖</mo><msub id="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.2" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.3" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0.055em" stretchy="false" id="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.3" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="Sx3.E7.m1.2.2.2.2.1.1.1.3" xref="Sx3.E7.m1.2.2.2.2.1.1.1.3.cmml">2</mn></msub><mo rspace="0.222em" id="Sx3.E7.m1.2.2.2.2.1.1.3" xref="Sx3.E7.m1.2.2.2.2.1.1.3.cmml">⋅</mo><msub id="Sx3.E7.m1.2.2.2.2.1.1.2" xref="Sx3.E7.m1.2.2.2.2.1.1.2.cmml"><mrow id="Sx3.E7.m1.2.2.2.2.1.1.2.1.1" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.2.cmml"><mo stretchy="false" id="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.2" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.2.1.cmml">‖</mo><msub id="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.cmml"><mi id="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.2" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.2.cmml">x</mi><mi id="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.3" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.3" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.2.1.cmml">‖</mo></mrow><mn id="Sx3.E7.m1.2.2.2.2.1.1.2.3" xref="Sx3.E7.m1.2.2.2.2.1.1.2.3.cmml">2</mn></msub></mrow><mo id="Sx3.E7.m1.3.3.3.3.2.4" xref="Sx3.E7.m1.3.3.3.4.cmml">,</mo><mrow id="Sx3.E7.m1.3.3.3.3.2.2" xref="Sx3.E7.m1.3.3.3.3.2.2.cmml"><mrow id="Sx3.E7.m1.3.3.3.3.2.2.2" xref="Sx3.E7.m1.3.3.3.3.2.2.2.cmml"><mn id="Sx3.E7.m1.3.3.3.3.2.2.2.2" xref="Sx3.E7.m1.3.3.3.3.2.2.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="Sx3.E7.m1.3.3.3.3.2.2.2.1" xref="Sx3.E7.m1.3.3.3.3.2.2.2.1.cmml">​</mo><mi id="Sx3.E7.m1.3.3.3.3.2.2.2.3" xref="Sx3.E7.m1.3.3.3.3.2.2.2.3.cmml">e</mi></mrow><mo id="Sx3.E7.m1.3.3.3.3.2.2.1" xref="Sx3.E7.m1.3.3.3.3.2.2.1.cmml">−</mo><mn id="Sx3.E7.m1.3.3.3.3.2.2.3" xref="Sx3.E7.m1.3.3.3.3.2.2.3.cmml">8</mn></mrow><mo stretchy="false" id="Sx3.E7.m1.3.3.3.3.2.5" xref="Sx3.E7.m1.3.3.3.4.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><mo lspace="0em" id="Sx3.E7.m1.4.4.1.2" xref="Sx3.E7.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E7.m1.4b"><apply id="Sx3.E7.m1.4.4.1.1.cmml" xref="Sx3.E7.m1.4.4.1"><eq id="Sx3.E7.m1.4.4.1.1.3.cmml" xref="Sx3.E7.m1.4.4.1.1.3"></eq><apply id="Sx3.E7.m1.4.4.1.1.2.cmml" xref="Sx3.E7.m1.4.4.1.1.2"><times id="Sx3.E7.m1.4.4.1.1.2.3.cmml" xref="Sx3.E7.m1.4.4.1.1.2.3"></times><ci id="Sx3.E7.m1.4.4.1.1.2.4.cmml" xref="Sx3.E7.m1.4.4.1.1.2.4">𝐷</ci><ci id="Sx3.E7.m1.4.4.1.1.2.5.cmml" xref="Sx3.E7.m1.4.4.1.1.2.5">𝑖</ci><ci id="Sx3.E7.m1.4.4.1.1.2.6.cmml" xref="Sx3.E7.m1.4.4.1.1.2.6">𝑠</ci><ci id="Sx3.E7.m1.4.4.1.1.2.7.cmml" xref="Sx3.E7.m1.4.4.1.1.2.7">𝑡</ci><interval closure="open" id="Sx3.E7.m1.4.4.1.1.2.2.3.cmml" xref="Sx3.E7.m1.4.4.1.1.2.2.2"><apply id="Sx3.E7.m1.4.4.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.4.4.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E7.m1.4.4.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.4.4.1.1.1.1.1.1.2">𝑥</ci><ci id="Sx3.E7.m1.4.4.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.4.4.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="Sx3.E7.m1.4.4.1.1.2.2.2.2.cmml" xref="Sx3.E7.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="Sx3.E7.m1.4.4.1.1.2.2.2.2.1.cmml" xref="Sx3.E7.m1.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="Sx3.E7.m1.4.4.1.1.2.2.2.2.2.cmml" xref="Sx3.E7.m1.4.4.1.1.2.2.2.2.2">𝑥</ci><ci id="Sx3.E7.m1.4.4.1.1.2.2.2.2.3.cmml" xref="Sx3.E7.m1.4.4.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="Sx3.E7.m1.4.4.1.1.4.cmml" xref="Sx3.E7.m1.4.4.1.1.4"><minus id="Sx3.E7.m1.4.4.1.1.4.1.cmml" xref="Sx3.E7.m1.4.4.1.1.4.1"></minus><cn type="integer" id="Sx3.E7.m1.4.4.1.1.4.2.cmml" xref="Sx3.E7.m1.4.4.1.1.4.2">1</cn><apply id="Sx3.E7.m1.3.3.cmml" xref="Sx3.E7.m1.3.3"><divide id="Sx3.E7.m1.3.3.4.cmml" xref="Sx3.E7.m1.3.3"></divide><apply id="Sx3.E7.m1.3.3.5.cmml" xref="Sx3.E7.m1.3.3.5"><ci id="Sx3.E7.m1.3.3.5.1.cmml" xref="Sx3.E7.m1.3.3.5.1">⋅</ci><apply id="Sx3.E7.m1.3.3.5.2.cmml" xref="Sx3.E7.m1.3.3.5.2"><csymbol cd="ambiguous" id="Sx3.E7.m1.3.3.5.2.1.cmml" xref="Sx3.E7.m1.3.3.5.2">subscript</csymbol><ci id="Sx3.E7.m1.3.3.5.2.2.cmml" xref="Sx3.E7.m1.3.3.5.2.2">𝑥</ci><ci id="Sx3.E7.m1.3.3.5.2.3.cmml" xref="Sx3.E7.m1.3.3.5.2.3">𝑖</ci></apply><apply id="Sx3.E7.m1.3.3.5.3.cmml" xref="Sx3.E7.m1.3.3.5.3"><csymbol cd="ambiguous" id="Sx3.E7.m1.3.3.5.3.1.cmml" xref="Sx3.E7.m1.3.3.5.3">subscript</csymbol><ci id="Sx3.E7.m1.3.3.5.3.2.cmml" xref="Sx3.E7.m1.3.3.5.3.2">𝑥</ci><ci id="Sx3.E7.m1.3.3.5.3.3.cmml" xref="Sx3.E7.m1.3.3.5.3.3">𝑗</ci></apply></apply><apply id="Sx3.E7.m1.3.3.3.4.cmml" xref="Sx3.E7.m1.3.3.3.3"><max id="Sx3.E7.m1.1.1.1.1.cmml" xref="Sx3.E7.m1.1.1.1.1"></max><apply id="Sx3.E7.m1.2.2.2.2.1.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1"><ci id="Sx3.E7.m1.2.2.2.2.1.1.3.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.3">⋅</ci><apply id="Sx3.E7.m1.2.2.2.2.1.1.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.2.2.1.1.1.2.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1">subscript</csymbol><apply id="Sx3.E7.m1.2.2.2.2.1.1.1.1.2.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E7.m1.2.2.2.2.1.1.1.1.2.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.2">norm</csymbol><apply id="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="Sx3.E7.m1.2.2.2.2.1.1.1.3.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.1.3">2</cn></apply><apply id="Sx3.E7.m1.2.2.2.2.1.1.2.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.2.2.1.1.2.2.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.2">subscript</csymbol><apply id="Sx3.E7.m1.2.2.2.2.1.1.2.1.2.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.1"><csymbol cd="latexml" id="Sx3.E7.m1.2.2.2.2.1.1.2.1.2.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.2">norm</csymbol><apply id="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.1.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.2.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.2">𝑥</ci><ci id="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.3.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.2.1.1.1.3">𝑗</ci></apply></apply><cn type="integer" id="Sx3.E7.m1.2.2.2.2.1.1.2.3.cmml" xref="Sx3.E7.m1.2.2.2.2.1.1.2.3">2</cn></apply></apply><apply id="Sx3.E7.m1.3.3.3.3.2.2.cmml" xref="Sx3.E7.m1.3.3.3.3.2.2"><minus id="Sx3.E7.m1.3.3.3.3.2.2.1.cmml" xref="Sx3.E7.m1.3.3.3.3.2.2.1"></minus><apply id="Sx3.E7.m1.3.3.3.3.2.2.2.cmml" xref="Sx3.E7.m1.3.3.3.3.2.2.2"><times id="Sx3.E7.m1.3.3.3.3.2.2.2.1.cmml" xref="Sx3.E7.m1.3.3.3.3.2.2.2.1"></times><cn type="integer" id="Sx3.E7.m1.3.3.3.3.2.2.2.2.cmml" xref="Sx3.E7.m1.3.3.3.3.2.2.2.2">1</cn><ci id="Sx3.E7.m1.3.3.3.3.2.2.2.3.cmml" xref="Sx3.E7.m1.3.3.3.3.2.2.2.3">𝑒</ci></apply><cn type="integer" id="Sx3.E7.m1.3.3.3.3.2.2.3.cmml" xref="Sx3.E7.m1.3.3.3.3.2.2.3">8</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E7.m1.4c">\displaystyle Dist(x_{i},x_{j})=1-\frac{x_{i}\cdot x_{j}}{\max(||x_{i}||_{2}\cdot||x_{j}||_{2},1e-8)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Farthest cosine sampling</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.2" class="ltx_p ltx_figure_panel"><span id="alg1.2.1" class="ltx_text ltx_font_bold">Input</span>: M points with feature <math id="alg1.1.m1.4" class="ltx_Math" alttext="\mathcal{X}_{1}=\{x_{1},x_{2},...,x_{M}\}" display="inline"><semantics id="alg1.1.m1.4a"><mrow id="alg1.1.m1.4.4" xref="alg1.1.m1.4.4.cmml"><msub id="alg1.1.m1.4.4.5" xref="alg1.1.m1.4.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.1.m1.4.4.5.2" xref="alg1.1.m1.4.4.5.2.cmml">𝒳</mi><mn id="alg1.1.m1.4.4.5.3" xref="alg1.1.m1.4.4.5.3.cmml">1</mn></msub><mo id="alg1.1.m1.4.4.4" xref="alg1.1.m1.4.4.4.cmml">=</mo><mrow id="alg1.1.m1.4.4.3.3" xref="alg1.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="alg1.1.m1.4.4.3.3.4" xref="alg1.1.m1.4.4.3.4.cmml">{</mo><msub id="alg1.1.m1.2.2.1.1.1" xref="alg1.1.m1.2.2.1.1.1.cmml"><mi id="alg1.1.m1.2.2.1.1.1.2" xref="alg1.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="alg1.1.m1.2.2.1.1.1.3" xref="alg1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="alg1.1.m1.4.4.3.3.5" xref="alg1.1.m1.4.4.3.4.cmml">,</mo><msub id="alg1.1.m1.3.3.2.2.2" xref="alg1.1.m1.3.3.2.2.2.cmml"><mi id="alg1.1.m1.3.3.2.2.2.2" xref="alg1.1.m1.3.3.2.2.2.2.cmml">x</mi><mn id="alg1.1.m1.3.3.2.2.2.3" xref="alg1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="alg1.1.m1.4.4.3.3.6" xref="alg1.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml">…</mi><mo id="alg1.1.m1.4.4.3.3.7" xref="alg1.1.m1.4.4.3.4.cmml">,</mo><msub id="alg1.1.m1.4.4.3.3.3" xref="alg1.1.m1.4.4.3.3.3.cmml"><mi id="alg1.1.m1.4.4.3.3.3.2" xref="alg1.1.m1.4.4.3.3.3.2.cmml">x</mi><mi id="alg1.1.m1.4.4.3.3.3.3" xref="alg1.1.m1.4.4.3.3.3.3.cmml">M</mi></msub><mo stretchy="false" id="alg1.1.m1.4.4.3.3.8" xref="alg1.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.m1.4b"><apply id="alg1.1.m1.4.4.cmml" xref="alg1.1.m1.4.4"><eq id="alg1.1.m1.4.4.4.cmml" xref="alg1.1.m1.4.4.4"></eq><apply id="alg1.1.m1.4.4.5.cmml" xref="alg1.1.m1.4.4.5"><csymbol cd="ambiguous" id="alg1.1.m1.4.4.5.1.cmml" xref="alg1.1.m1.4.4.5">subscript</csymbol><ci id="alg1.1.m1.4.4.5.2.cmml" xref="alg1.1.m1.4.4.5.2">𝒳</ci><cn type="integer" id="alg1.1.m1.4.4.5.3.cmml" xref="alg1.1.m1.4.4.5.3">1</cn></apply><set id="alg1.1.m1.4.4.3.4.cmml" xref="alg1.1.m1.4.4.3.3"><apply id="alg1.1.m1.2.2.1.1.1.cmml" xref="alg1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.1.m1.2.2.1.1.1.1.cmml" xref="alg1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="alg1.1.m1.2.2.1.1.1.2.cmml" xref="alg1.1.m1.2.2.1.1.1.2">𝑥</ci><cn type="integer" id="alg1.1.m1.2.2.1.1.1.3.cmml" xref="alg1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="alg1.1.m1.3.3.2.2.2.cmml" xref="alg1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.1.m1.3.3.2.2.2.1.cmml" xref="alg1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="alg1.1.m1.3.3.2.2.2.2.cmml" xref="alg1.1.m1.3.3.2.2.2.2">𝑥</ci><cn type="integer" id="alg1.1.m1.3.3.2.2.2.3.cmml" xref="alg1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1">…</ci><apply id="alg1.1.m1.4.4.3.3.3.cmml" xref="alg1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg1.1.m1.4.4.3.3.3.1.cmml" xref="alg1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="alg1.1.m1.4.4.3.3.3.2.cmml" xref="alg1.1.m1.4.4.3.3.3.2">𝑥</ci><ci id="alg1.1.m1.4.4.3.3.3.3.cmml" xref="alg1.1.m1.4.4.3.3.3.3">𝑀</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.4c">\mathcal{X}_{1}=\{x_{1},x_{2},...,x_{M}\}</annotation></semantics></math>.
<br class="ltx_break"><span id="alg1.2.2" class="ltx_text ltx_font_bold">Output</span>: Sampled M/4 points <math id="alg1.2.m2.1" class="ltx_Math" alttext="\mathcal{X}_{2}" display="inline"><semantics id="alg1.2.m2.1a"><msub id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.2.m2.1.1.2" xref="alg1.2.m2.1.1.2.cmml">𝒳</mi><mn id="alg1.2.m2.1.1.3" xref="alg1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><apply id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.2.m2.1.1.1.cmml" xref="alg1.2.m2.1.1">subscript</csymbol><ci id="alg1.2.m2.1.1.2.cmml" xref="alg1.2.m2.1.1.2">𝒳</ci><cn type="integer" id="alg1.2.m2.1.1.3.cmml" xref="alg1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">\mathcal{X}_{2}</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.5" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  initialize an empty sampling point set <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathcal{X}_{2}=\{\}" display="inline"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><msub id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1.2.2" xref="alg1.l1.m1.1.1.2.2.cmml">𝒳</mi><mn id="alg1.l1.m1.1.1.2.3" xref="alg1.l1.m1.1.1.2.3.cmml">2</mn></msub><mo id="alg1.l1.m1.1.1.1" xref="alg1.l1.m1.1.1.1.cmml">=</mo><mrow id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.cmml"><mo stretchy="false" id="alg1.l1.m1.1.1.3.2.1" xref="alg1.l1.m1.1.1.3.1.cmml">{</mo><mo stretchy="false" id="alg1.l1.m1.1.1.3.2.2" xref="alg1.l1.m1.1.1.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><eq id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1.1"></eq><apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1.2">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2.2">𝒳</ci><cn type="integer" id="alg1.l1.m1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.2.3">2</cn></apply><list id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{X}_{2}=\{\}</annotation></semantics></math>;

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  <math id="alg1.l2.m1.2" class="ltx_Math" alttext="x_{s,1}" display="inline"><semantics id="alg1.l2.m1.2a"><msub id="alg1.l2.m1.2.3" xref="alg1.l2.m1.2.3.cmml"><mi id="alg1.l2.m1.2.3.2" xref="alg1.l2.m1.2.3.2.cmml">x</mi><mrow id="alg1.l2.m1.2.2.2.4" xref="alg1.l2.m1.2.2.2.3.cmml"><mi id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml">s</mi><mo id="alg1.l2.m1.2.2.2.4.1" xref="alg1.l2.m1.2.2.2.3.cmml">,</mo><mn id="alg1.l2.m1.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b"><apply id="alg1.l2.m1.2.3.cmml" xref="alg1.l2.m1.2.3"><csymbol cd="ambiguous" id="alg1.l2.m1.2.3.1.cmml" xref="alg1.l2.m1.2.3">subscript</csymbol><ci id="alg1.l2.m1.2.3.2.cmml" xref="alg1.l2.m1.2.3.2">𝑥</ci><list id="alg1.l2.m1.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.4"><ci id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1">𝑠</ci><cn type="integer" id="alg1.l2.m1.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.2c">x_{s,1}</annotation></semantics></math> = RandomChoiceOne(<math id="alg1.l2.m2.1" class="ltx_Math" alttext="\mathcal{X}_{1}" display="inline"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">𝒳</mi><mn id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝒳</ci><cn type="integer" id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\mathcal{X}_{1}</annotation></semantics></math>);

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <math id="alg1.l3.m1.6" class="ltx_Math" alttext="\mathcal{X}_{1}\leftarrow\mathcal{X}_{1}\setminus\{x_{s,1}\};\mathcal{X}_{2}\leftarrow\{x_{s,1}\}" display="inline"><semantics id="alg1.l3.m1.6a"><mrow id="alg1.l3.m1.6.6.2" xref="alg1.l3.m1.6.6.3.cmml"><mrow id="alg1.l3.m1.5.5.1.1" xref="alg1.l3.m1.5.5.1.1.cmml"><msub id="alg1.l3.m1.5.5.1.1.3" xref="alg1.l3.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.5.5.1.1.3.2" xref="alg1.l3.m1.5.5.1.1.3.2.cmml">𝒳</mi><mn id="alg1.l3.m1.5.5.1.1.3.3" xref="alg1.l3.m1.5.5.1.1.3.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l3.m1.5.5.1.1.2" xref="alg1.l3.m1.5.5.1.1.2.cmml">←</mo><mrow id="alg1.l3.m1.5.5.1.1.1" xref="alg1.l3.m1.5.5.1.1.1.cmml"><msub id="alg1.l3.m1.5.5.1.1.1.3" xref="alg1.l3.m1.5.5.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.5.5.1.1.1.3.2" xref="alg1.l3.m1.5.5.1.1.1.3.2.cmml">𝒳</mi><mn id="alg1.l3.m1.5.5.1.1.1.3.3" xref="alg1.l3.m1.5.5.1.1.1.3.3.cmml">1</mn></msub><mo id="alg1.l3.m1.5.5.1.1.1.2" xref="alg1.l3.m1.5.5.1.1.1.2.cmml">∖</mo><mrow id="alg1.l3.m1.5.5.1.1.1.1.1" xref="alg1.l3.m1.5.5.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l3.m1.5.5.1.1.1.1.1.2" xref="alg1.l3.m1.5.5.1.1.1.1.2.cmml">{</mo><msub id="alg1.l3.m1.5.5.1.1.1.1.1.1" xref="alg1.l3.m1.5.5.1.1.1.1.1.1.cmml"><mi id="alg1.l3.m1.5.5.1.1.1.1.1.1.2" xref="alg1.l3.m1.5.5.1.1.1.1.1.1.2.cmml">x</mi><mrow id="alg1.l3.m1.2.2.2.4" xref="alg1.l3.m1.2.2.2.3.cmml"><mi id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.cmml">s</mi><mo id="alg1.l3.m1.2.2.2.4.1" xref="alg1.l3.m1.2.2.2.3.cmml">,</mo><mn id="alg1.l3.m1.2.2.2.2" xref="alg1.l3.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l3.m1.5.5.1.1.1.1.1.3" xref="alg1.l3.m1.5.5.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><mo id="alg1.l3.m1.6.6.2.3" xref="alg1.l3.m1.6.6.3a.cmml">;</mo><mrow id="alg1.l3.m1.6.6.2.2" xref="alg1.l3.m1.6.6.2.2.cmml"><msub id="alg1.l3.m1.6.6.2.2.3" xref="alg1.l3.m1.6.6.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.6.6.2.2.3.2" xref="alg1.l3.m1.6.6.2.2.3.2.cmml">𝒳</mi><mn id="alg1.l3.m1.6.6.2.2.3.3" xref="alg1.l3.m1.6.6.2.2.3.3.cmml">2</mn></msub><mo stretchy="false" id="alg1.l3.m1.6.6.2.2.2" xref="alg1.l3.m1.6.6.2.2.2.cmml">←</mo><mrow id="alg1.l3.m1.6.6.2.2.1.1" xref="alg1.l3.m1.6.6.2.2.1.2.cmml"><mo stretchy="false" id="alg1.l3.m1.6.6.2.2.1.1.2" xref="alg1.l3.m1.6.6.2.2.1.2.cmml">{</mo><msub id="alg1.l3.m1.6.6.2.2.1.1.1" xref="alg1.l3.m1.6.6.2.2.1.1.1.cmml"><mi id="alg1.l3.m1.6.6.2.2.1.1.1.2" xref="alg1.l3.m1.6.6.2.2.1.1.1.2.cmml">x</mi><mrow id="alg1.l3.m1.4.4.2.4" xref="alg1.l3.m1.4.4.2.3.cmml"><mi id="alg1.l3.m1.3.3.1.1" xref="alg1.l3.m1.3.3.1.1.cmml">s</mi><mo id="alg1.l3.m1.4.4.2.4.1" xref="alg1.l3.m1.4.4.2.3.cmml">,</mo><mn id="alg1.l3.m1.4.4.2.2" xref="alg1.l3.m1.4.4.2.2.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l3.m1.6.6.2.2.1.1.3" xref="alg1.l3.m1.6.6.2.2.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.6b"><apply id="alg1.l3.m1.6.6.3.cmml" xref="alg1.l3.m1.6.6.2"><csymbol cd="ambiguous" id="alg1.l3.m1.6.6.3a.cmml" xref="alg1.l3.m1.6.6.2.3">formulae-sequence</csymbol><apply id="alg1.l3.m1.5.5.1.1.cmml" xref="alg1.l3.m1.5.5.1.1"><ci id="alg1.l3.m1.5.5.1.1.2.cmml" xref="alg1.l3.m1.5.5.1.1.2">←</ci><apply id="alg1.l3.m1.5.5.1.1.3.cmml" xref="alg1.l3.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m1.5.5.1.1.3.1.cmml" xref="alg1.l3.m1.5.5.1.1.3">subscript</csymbol><ci id="alg1.l3.m1.5.5.1.1.3.2.cmml" xref="alg1.l3.m1.5.5.1.1.3.2">𝒳</ci><cn type="integer" id="alg1.l3.m1.5.5.1.1.3.3.cmml" xref="alg1.l3.m1.5.5.1.1.3.3">1</cn></apply><apply id="alg1.l3.m1.5.5.1.1.1.cmml" xref="alg1.l3.m1.5.5.1.1.1"><setdiff id="alg1.l3.m1.5.5.1.1.1.2.cmml" xref="alg1.l3.m1.5.5.1.1.1.2"></setdiff><apply id="alg1.l3.m1.5.5.1.1.1.3.cmml" xref="alg1.l3.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m1.5.5.1.1.1.3.1.cmml" xref="alg1.l3.m1.5.5.1.1.1.3">subscript</csymbol><ci id="alg1.l3.m1.5.5.1.1.1.3.2.cmml" xref="alg1.l3.m1.5.5.1.1.1.3.2">𝒳</ci><cn type="integer" id="alg1.l3.m1.5.5.1.1.1.3.3.cmml" xref="alg1.l3.m1.5.5.1.1.1.3.3">1</cn></apply><set id="alg1.l3.m1.5.5.1.1.1.1.2.cmml" xref="alg1.l3.m1.5.5.1.1.1.1.1"><apply id="alg1.l3.m1.5.5.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.5.5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.5.5.1.1.1.1.1.1.1.cmml" xref="alg1.l3.m1.5.5.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.5.5.1.1.1.1.1.1.2.cmml" xref="alg1.l3.m1.5.5.1.1.1.1.1.1.2">𝑥</ci><list id="alg1.l3.m1.2.2.2.3.cmml" xref="alg1.l3.m1.2.2.2.4"><ci id="alg1.l3.m1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1">𝑠</ci><cn type="integer" id="alg1.l3.m1.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.2">1</cn></list></apply></set></apply></apply><apply id="alg1.l3.m1.6.6.2.2.cmml" xref="alg1.l3.m1.6.6.2.2"><ci id="alg1.l3.m1.6.6.2.2.2.cmml" xref="alg1.l3.m1.6.6.2.2.2">←</ci><apply id="alg1.l3.m1.6.6.2.2.3.cmml" xref="alg1.l3.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="alg1.l3.m1.6.6.2.2.3.1.cmml" xref="alg1.l3.m1.6.6.2.2.3">subscript</csymbol><ci id="alg1.l3.m1.6.6.2.2.3.2.cmml" xref="alg1.l3.m1.6.6.2.2.3.2">𝒳</ci><cn type="integer" id="alg1.l3.m1.6.6.2.2.3.3.cmml" xref="alg1.l3.m1.6.6.2.2.3.3">2</cn></apply><set id="alg1.l3.m1.6.6.2.2.1.2.cmml" xref="alg1.l3.m1.6.6.2.2.1.1"><apply id="alg1.l3.m1.6.6.2.2.1.1.1.cmml" xref="alg1.l3.m1.6.6.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.6.6.2.2.1.1.1.1.cmml" xref="alg1.l3.m1.6.6.2.2.1.1.1">subscript</csymbol><ci id="alg1.l3.m1.6.6.2.2.1.1.1.2.cmml" xref="alg1.l3.m1.6.6.2.2.1.1.1.2">𝑥</ci><list id="alg1.l3.m1.4.4.2.3.cmml" xref="alg1.l3.m1.4.4.2.4"><ci id="alg1.l3.m1.3.3.1.1.cmml" xref="alg1.l3.m1.3.3.1.1">𝑠</ci><cn type="integer" id="alg1.l3.m1.4.4.2.2.cmml" xref="alg1.l3.m1.4.4.2.2">1</cn></list></apply></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.6c">\mathcal{X}_{1}\leftarrow\mathcal{X}_{1}\setminus\{x_{s,1}\};\mathcal{X}_{2}\leftarrow\{x_{s,1}\}</annotation></semantics></math>;

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>  <span id="alg1.l4.1" class="ltx_text ltx_font_bold">while</span> <math id="alg1.l4.m1.1" class="ltx_Math" alttext="|\mathcal{X}_{2}|&lt;M/4" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l4.m1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.2.1.cmml">|</mo><msub id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.2.cmml">𝒳</mi><mn id="alg1.l4.m1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.3.cmml">2</mn></msub><mo stretchy="false" id="alg1.l4.m1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.2.1.cmml">|</mo></mrow><mo id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">&lt;</mo><mrow id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">M</mi><mo id="alg1.l4.m1.1.1.3.1" xref="alg1.l4.m1.1.1.3.1.cmml">/</mo><mn id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><lt id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"></lt><apply id="alg1.l4.m1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1"><abs id="alg1.l4.m1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.2"></abs><apply id="alg1.l4.m1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.2">𝒳</ci><cn type="integer" id="alg1.l4.m1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.3">2</cn></apply></apply><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><divide id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3.1"></divide><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">𝑀</ci><cn type="integer" id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">|\mathcal{X}_{2}|&lt;M/4</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>     // Using cosine similarity for distance metric

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>     <math id="alg1.l6.m1.2" class="ltx_Math" alttext="Dist(i,j)" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.3" xref="alg1.l6.m1.2.3.cmml"><mi id="alg1.l6.m1.2.3.2" xref="alg1.l6.m1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.3.1" xref="alg1.l6.m1.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.3.3" xref="alg1.l6.m1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.3.1a" xref="alg1.l6.m1.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.3.4" xref="alg1.l6.m1.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.3.1b" xref="alg1.l6.m1.2.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.3.5" xref="alg1.l6.m1.2.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.3.1c" xref="alg1.l6.m1.2.3.1.cmml">​</mo><mrow id="alg1.l6.m1.2.3.6.2" xref="alg1.l6.m1.2.3.6.1.cmml"><mo stretchy="false" id="alg1.l6.m1.2.3.6.2.1" xref="alg1.l6.m1.2.3.6.1.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">i</mi><mo id="alg1.l6.m1.2.3.6.2.2" xref="alg1.l6.m1.2.3.6.1.cmml">,</mo><mi id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">j</mi><mo stretchy="false" id="alg1.l6.m1.2.3.6.2.3" xref="alg1.l6.m1.2.3.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.3.cmml" xref="alg1.l6.m1.2.3"><times id="alg1.l6.m1.2.3.1.cmml" xref="alg1.l6.m1.2.3.1"></times><ci id="alg1.l6.m1.2.3.2.cmml" xref="alg1.l6.m1.2.3.2">𝐷</ci><ci id="alg1.l6.m1.2.3.3.cmml" xref="alg1.l6.m1.2.3.3">𝑖</ci><ci id="alg1.l6.m1.2.3.4.cmml" xref="alg1.l6.m1.2.3.4">𝑠</ci><ci id="alg1.l6.m1.2.3.5.cmml" xref="alg1.l6.m1.2.3.5">𝑡</ci><interval closure="open" id="alg1.l6.m1.2.3.6.1.cmml" xref="alg1.l6.m1.2.3.6.2"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑖</ci><ci id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">𝑗</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">Dist(i,j)</annotation></semantics></math> = <math id="alg1.l6.m2.7" class="ltx_Math" alttext="1-\frac{x_{i}\cdot x_{s,j}}{\max(||x_{i}||_{2}\cdot||x_{s,j}||_{2},1e-8)}" display="inline"><semantics id="alg1.l6.m2.7a"><mrow id="alg1.l6.m2.7.8" xref="alg1.l6.m2.7.8.cmml"><mn id="alg1.l6.m2.7.8.2" xref="alg1.l6.m2.7.8.2.cmml">1</mn><mo id="alg1.l6.m2.7.8.1" xref="alg1.l6.m2.7.8.1.cmml">−</mo><mfrac id="alg1.l6.m2.7.7" xref="alg1.l6.m2.7.7.cmml"><mrow id="alg1.l6.m2.2.2.2" xref="alg1.l6.m2.2.2.2.cmml"><msub id="alg1.l6.m2.2.2.2.4" xref="alg1.l6.m2.2.2.2.4.cmml"><mi id="alg1.l6.m2.2.2.2.4.2" xref="alg1.l6.m2.2.2.2.4.2.cmml">x</mi><mi id="alg1.l6.m2.2.2.2.4.3" xref="alg1.l6.m2.2.2.2.4.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l6.m2.2.2.2.3" xref="alg1.l6.m2.2.2.2.3.cmml">⋅</mo><msub id="alg1.l6.m2.2.2.2.5" xref="alg1.l6.m2.2.2.2.5.cmml"><mi id="alg1.l6.m2.2.2.2.5.2" xref="alg1.l6.m2.2.2.2.5.2.cmml">x</mi><mrow id="alg1.l6.m2.2.2.2.2.2.4" xref="alg1.l6.m2.2.2.2.2.2.3.cmml"><mi id="alg1.l6.m2.1.1.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.1.1.cmml">s</mi><mo id="alg1.l6.m2.2.2.2.2.2.4.1" xref="alg1.l6.m2.2.2.2.2.2.3.cmml">,</mo><mi id="alg1.l6.m2.2.2.2.2.2.2" xref="alg1.l6.m2.2.2.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mrow id="alg1.l6.m2.7.7.7.5" xref="alg1.l6.m2.7.7.7.6.cmml"><mi id="alg1.l6.m2.5.5.5.3" xref="alg1.l6.m2.5.5.5.3.cmml">max</mi><mo id="alg1.l6.m2.7.7.7.5a" xref="alg1.l6.m2.7.7.7.6.cmml">⁡</mo><mrow id="alg1.l6.m2.7.7.7.5.2" xref="alg1.l6.m2.7.7.7.6.cmml"><mo stretchy="false" id="alg1.l6.m2.7.7.7.5.2.3" xref="alg1.l6.m2.7.7.7.6.cmml">(</mo><mrow id="alg1.l6.m2.6.6.6.4.1.1" xref="alg1.l6.m2.6.6.6.4.1.1.cmml"><msub id="alg1.l6.m2.6.6.6.4.1.1.1" xref="alg1.l6.m2.6.6.6.4.1.1.1.cmml"><mrow id="alg1.l6.m2.6.6.6.4.1.1.1.1.1" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.2.cmml"><mo maxsize="142%" minsize="142%" id="alg1.l6.m2.6.6.6.4.1.1.1.1.1.2" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.2.1.cmml">‖</mo><msub id="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.cmml"><mi id="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.2" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.3" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo maxsize="142%" minsize="142%" rspace="0.055em" id="alg1.l6.m2.6.6.6.4.1.1.1.1.1.3" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="alg1.l6.m2.6.6.6.4.1.1.1.3" xref="alg1.l6.m2.6.6.6.4.1.1.1.3.cmml">2</mn></msub><mo rspace="0.222em" id="alg1.l6.m2.6.6.6.4.1.1.3" xref="alg1.l6.m2.6.6.6.4.1.1.3.cmml">⋅</mo><msub id="alg1.l6.m2.6.6.6.4.1.1.2" xref="alg1.l6.m2.6.6.6.4.1.1.2.cmml"><mrow id="alg1.l6.m2.6.6.6.4.1.1.2.1.1" xref="alg1.l6.m2.6.6.6.4.1.1.2.1.2.cmml"><mo maxsize="142%" minsize="142%" id="alg1.l6.m2.6.6.6.4.1.1.2.1.1.2" xref="alg1.l6.m2.6.6.6.4.1.1.2.1.2.1.cmml">‖</mo><msub id="alg1.l6.m2.6.6.6.4.1.1.2.1.1.1" xref="alg1.l6.m2.6.6.6.4.1.1.2.1.1.1.cmml"><mi id="alg1.l6.m2.6.6.6.4.1.1.2.1.1.1.2" xref="alg1.l6.m2.6.6.6.4.1.1.2.1.1.1.2.cmml">x</mi><mrow id="alg1.l6.m2.4.4.4.2.2.4" xref="alg1.l6.m2.4.4.4.2.2.3.cmml"><mi id="alg1.l6.m2.3.3.3.1.1.1" xref="alg1.l6.m2.3.3.3.1.1.1.cmml">s</mi><mo id="alg1.l6.m2.4.4.4.2.2.4.1" xref="alg1.l6.m2.4.4.4.2.2.3.cmml">,</mo><mi id="alg1.l6.m2.4.4.4.2.2.2" xref="alg1.l6.m2.4.4.4.2.2.2.cmml">j</mi></mrow></msub><mo maxsize="142%" minsize="142%" id="alg1.l6.m2.6.6.6.4.1.1.2.1.1.3" xref="alg1.l6.m2.6.6.6.4.1.1.2.1.2.1.cmml">‖</mo></mrow><mn id="alg1.l6.m2.6.6.6.4.1.1.2.3" xref="alg1.l6.m2.6.6.6.4.1.1.2.3.cmml">2</mn></msub></mrow><mo id="alg1.l6.m2.7.7.7.5.2.4" xref="alg1.l6.m2.7.7.7.6.cmml">,</mo><mrow id="alg1.l6.m2.7.7.7.5.2.2" xref="alg1.l6.m2.7.7.7.5.2.2.cmml"><mrow id="alg1.l6.m2.7.7.7.5.2.2.2" xref="alg1.l6.m2.7.7.7.5.2.2.2.cmml"><mn id="alg1.l6.m2.7.7.7.5.2.2.2.2" xref="alg1.l6.m2.7.7.7.5.2.2.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="alg1.l6.m2.7.7.7.5.2.2.2.1" xref="alg1.l6.m2.7.7.7.5.2.2.2.1.cmml">​</mo><mi id="alg1.l6.m2.7.7.7.5.2.2.2.3" xref="alg1.l6.m2.7.7.7.5.2.2.2.3.cmml">e</mi></mrow><mo id="alg1.l6.m2.7.7.7.5.2.2.1" xref="alg1.l6.m2.7.7.7.5.2.2.1.cmml">−</mo><mn id="alg1.l6.m2.7.7.7.5.2.2.3" xref="alg1.l6.m2.7.7.7.5.2.2.3.cmml">8</mn></mrow><mo stretchy="false" id="alg1.l6.m2.7.7.7.5.2.5" xref="alg1.l6.m2.7.7.7.6.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.7b"><apply id="alg1.l6.m2.7.8.cmml" xref="alg1.l6.m2.7.8"><minus id="alg1.l6.m2.7.8.1.cmml" xref="alg1.l6.m2.7.8.1"></minus><cn type="integer" id="alg1.l6.m2.7.8.2.cmml" xref="alg1.l6.m2.7.8.2">1</cn><apply id="alg1.l6.m2.7.7.cmml" xref="alg1.l6.m2.7.7"><divide id="alg1.l6.m2.7.7.8.cmml" xref="alg1.l6.m2.7.7"></divide><apply id="alg1.l6.m2.2.2.2.cmml" xref="alg1.l6.m2.2.2.2"><ci id="alg1.l6.m2.2.2.2.3.cmml" xref="alg1.l6.m2.2.2.2.3">⋅</ci><apply id="alg1.l6.m2.2.2.2.4.cmml" xref="alg1.l6.m2.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l6.m2.2.2.2.4.1.cmml" xref="alg1.l6.m2.2.2.2.4">subscript</csymbol><ci id="alg1.l6.m2.2.2.2.4.2.cmml" xref="alg1.l6.m2.2.2.2.4.2">𝑥</ci><ci id="alg1.l6.m2.2.2.2.4.3.cmml" xref="alg1.l6.m2.2.2.2.4.3">𝑖</ci></apply><apply id="alg1.l6.m2.2.2.2.5.cmml" xref="alg1.l6.m2.2.2.2.5"><csymbol cd="ambiguous" id="alg1.l6.m2.2.2.2.5.1.cmml" xref="alg1.l6.m2.2.2.2.5">subscript</csymbol><ci id="alg1.l6.m2.2.2.2.5.2.cmml" xref="alg1.l6.m2.2.2.2.5.2">𝑥</ci><list id="alg1.l6.m2.2.2.2.2.2.3.cmml" xref="alg1.l6.m2.2.2.2.2.2.4"><ci id="alg1.l6.m2.1.1.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1.1.1">𝑠</ci><ci id="alg1.l6.m2.2.2.2.2.2.2.cmml" xref="alg1.l6.m2.2.2.2.2.2.2">𝑗</ci></list></apply></apply><apply id="alg1.l6.m2.7.7.7.6.cmml" xref="alg1.l6.m2.7.7.7.5"><max id="alg1.l6.m2.5.5.5.3.cmml" xref="alg1.l6.m2.5.5.5.3"></max><apply id="alg1.l6.m2.6.6.6.4.1.1.cmml" xref="alg1.l6.m2.6.6.6.4.1.1"><ci id="alg1.l6.m2.6.6.6.4.1.1.3.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.3">⋅</ci><apply id="alg1.l6.m2.6.6.6.4.1.1.1.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.6.6.6.4.1.1.1.2.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.1">subscript</csymbol><apply id="alg1.l6.m2.6.6.6.4.1.1.1.1.2.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l6.m2.6.6.6.4.1.1.1.1.2.1.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.1.2">norm</csymbol><apply id="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.1.1.1.1.3">𝑖</ci></apply></apply><cn type="integer" id="alg1.l6.m2.6.6.6.4.1.1.1.3.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.1.3">2</cn></apply><apply id="alg1.l6.m2.6.6.6.4.1.1.2.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m2.6.6.6.4.1.1.2.2.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.2">subscript</csymbol><apply id="alg1.l6.m2.6.6.6.4.1.1.2.1.2.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.2.1.1"><csymbol cd="latexml" id="alg1.l6.m2.6.6.6.4.1.1.2.1.2.1.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.2.1.1.2">norm</csymbol><apply id="alg1.l6.m2.6.6.6.4.1.1.2.1.1.1.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.6.6.6.4.1.1.2.1.1.1.1.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.2.1.1.1">subscript</csymbol><ci id="alg1.l6.m2.6.6.6.4.1.1.2.1.1.1.2.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.2.1.1.1.2">𝑥</ci><list id="alg1.l6.m2.4.4.4.2.2.3.cmml" xref="alg1.l6.m2.4.4.4.2.2.4"><ci id="alg1.l6.m2.3.3.3.1.1.1.cmml" xref="alg1.l6.m2.3.3.3.1.1.1">𝑠</ci><ci id="alg1.l6.m2.4.4.4.2.2.2.cmml" xref="alg1.l6.m2.4.4.4.2.2.2">𝑗</ci></list></apply></apply><cn type="integer" id="alg1.l6.m2.6.6.6.4.1.1.2.3.cmml" xref="alg1.l6.m2.6.6.6.4.1.1.2.3">2</cn></apply></apply><apply id="alg1.l6.m2.7.7.7.5.2.2.cmml" xref="alg1.l6.m2.7.7.7.5.2.2"><minus id="alg1.l6.m2.7.7.7.5.2.2.1.cmml" xref="alg1.l6.m2.7.7.7.5.2.2.1"></minus><apply id="alg1.l6.m2.7.7.7.5.2.2.2.cmml" xref="alg1.l6.m2.7.7.7.5.2.2.2"><times id="alg1.l6.m2.7.7.7.5.2.2.2.1.cmml" xref="alg1.l6.m2.7.7.7.5.2.2.2.1"></times><cn type="integer" id="alg1.l6.m2.7.7.7.5.2.2.2.2.cmml" xref="alg1.l6.m2.7.7.7.5.2.2.2.2">1</cn><ci id="alg1.l6.m2.7.7.7.5.2.2.2.3.cmml" xref="alg1.l6.m2.7.7.7.5.2.2.2.3">𝑒</ci></apply><cn type="integer" id="alg1.l6.m2.7.7.7.5.2.2.3.cmml" xref="alg1.l6.m2.7.7.7.5.2.2.3">8</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.7c">1-\frac{x_{i}\cdot x_{s,j}}{\max(||x_{i}||_{2}\cdot||x_{s,j}||_{2},1e-8)}</annotation></semantics></math>;

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>     <math id="alg1.l7.m1.4" class="ltx_math_unparsed" alttext="\mathcal{D}=\{Dist(i,j);x_{i}\in\mathcal{X}_{1},x_{s,j}\in\mathcal{X}_{2}\}" display="inline"><semantics id="alg1.l7.m1.4a"><mrow id="alg1.l7.m1.4b"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.4.5">𝒟</mi><mo id="alg1.l7.m1.4.6">=</mo><mrow id="alg1.l7.m1.4.7"><mo stretchy="false" id="alg1.l7.m1.4.7.1">{</mo><mi id="alg1.l7.m1.4.7.2">D</mi><mi id="alg1.l7.m1.4.7.3">i</mi><mi id="alg1.l7.m1.4.7.4">s</mi><mi id="alg1.l7.m1.4.7.5">t</mi><mrow id="alg1.l7.m1.4.7.6"><mo stretchy="false" id="alg1.l7.m1.4.7.6.1">(</mo><mi id="alg1.l7.m1.3.3">i</mi><mo id="alg1.l7.m1.4.7.6.2">,</mo><mi id="alg1.l7.m1.4.4">j</mi><mo stretchy="false" id="alg1.l7.m1.4.7.6.3">)</mo></mrow><mo id="alg1.l7.m1.4.7.7">;</mo><msub id="alg1.l7.m1.4.7.8"><mi id="alg1.l7.m1.4.7.8.2">x</mi><mi id="alg1.l7.m1.4.7.8.3">i</mi></msub><mo id="alg1.l7.m1.4.7.9">∈</mo><msub id="alg1.l7.m1.4.7.10"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.4.7.10.2">𝒳</mi><mn id="alg1.l7.m1.4.7.10.3">1</mn></msub><mo id="alg1.l7.m1.4.7.11">,</mo><msub id="alg1.l7.m1.4.7.12"><mi id="alg1.l7.m1.4.7.12.2">x</mi><mrow id="alg1.l7.m1.2.2.2.4"><mi id="alg1.l7.m1.1.1.1.1">s</mi><mo id="alg1.l7.m1.2.2.2.4.1">,</mo><mi id="alg1.l7.m1.2.2.2.2">j</mi></mrow></msub><mo id="alg1.l7.m1.4.7.13">∈</mo><msub id="alg1.l7.m1.4.7.14"><mi class="ltx_font_mathcaligraphic" id="alg1.l7.m1.4.7.14.2">𝒳</mi><mn id="alg1.l7.m1.4.7.14.3">2</mn></msub><mo stretchy="false" id="alg1.l7.m1.4.7.15">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="alg1.l7.m1.4c">\mathcal{D}=\{Dist(i,j);x_{i}\in\mathcal{X}_{1},x_{s,j}\in\mathcal{X}_{2}\}</annotation></semantics></math>;

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>     <math id="alg1.l8.m1.1" class="ltx_Math" alttext="x_{s}\leftarrow\mathop{\arg\max}_{x_{i}\in\mathcal{X}_{1}}(\mathcal{D})" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.2" xref="alg1.l8.m1.1.2.cmml"><msub id="alg1.l8.m1.1.2.2" xref="alg1.l8.m1.1.2.2.cmml"><mi id="alg1.l8.m1.1.2.2.2" xref="alg1.l8.m1.1.2.2.2.cmml">x</mi><mi id="alg1.l8.m1.1.2.2.3" xref="alg1.l8.m1.1.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg1.l8.m1.1.2.1" xref="alg1.l8.m1.1.2.1.cmml">←</mo><mrow id="alg1.l8.m1.1.2.3" xref="alg1.l8.m1.1.2.3.cmml"><msub id="alg1.l8.m1.1.2.3.1" xref="alg1.l8.m1.1.2.3.1.cmml"><mrow id="alg1.l8.m1.1.2.3.1.2" xref="alg1.l8.m1.1.2.3.1.2.cmml"><mi id="alg1.l8.m1.1.2.3.1.2.1" xref="alg1.l8.m1.1.2.3.1.2.1.cmml">arg</mi><mo lspace="0.167em" id="alg1.l8.m1.1.2.3.1.2a" xref="alg1.l8.m1.1.2.3.1.2.cmml">⁡</mo><mi id="alg1.l8.m1.1.2.3.1.2.2" xref="alg1.l8.m1.1.2.3.1.2.2.cmml">max</mi></mrow><mrow id="alg1.l8.m1.1.2.3.1.3" xref="alg1.l8.m1.1.2.3.1.3.cmml"><msub id="alg1.l8.m1.1.2.3.1.3.2" xref="alg1.l8.m1.1.2.3.1.3.2.cmml"><mi id="alg1.l8.m1.1.2.3.1.3.2.2" xref="alg1.l8.m1.1.2.3.1.3.2.2.cmml">x</mi><mi id="alg1.l8.m1.1.2.3.1.3.2.3" xref="alg1.l8.m1.1.2.3.1.3.2.3.cmml">i</mi></msub><mo id="alg1.l8.m1.1.2.3.1.3.1" xref="alg1.l8.m1.1.2.3.1.3.1.cmml">∈</mo><msub id="alg1.l8.m1.1.2.3.1.3.3" xref="alg1.l8.m1.1.2.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.2.3.1.3.3.2" xref="alg1.l8.m1.1.2.3.1.3.3.2.cmml">𝒳</mi><mn id="alg1.l8.m1.1.2.3.1.3.3.3" xref="alg1.l8.m1.1.2.3.1.3.3.3.cmml">1</mn></msub></mrow></msub><mrow id="alg1.l8.m1.1.2.3.2.2" xref="alg1.l8.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l8.m1.1.2.3.2.2.1" xref="alg1.l8.m1.1.2.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">𝒟</mi><mo stretchy="false" id="alg1.l8.m1.1.2.3.2.2.2" xref="alg1.l8.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.2.cmml" xref="alg1.l8.m1.1.2"><ci id="alg1.l8.m1.1.2.1.cmml" xref="alg1.l8.m1.1.2.1">←</ci><apply id="alg1.l8.m1.1.2.2.cmml" xref="alg1.l8.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.2.1.cmml" xref="alg1.l8.m1.1.2.2">subscript</csymbol><ci id="alg1.l8.m1.1.2.2.2.cmml" xref="alg1.l8.m1.1.2.2.2">𝑥</ci><ci id="alg1.l8.m1.1.2.2.3.cmml" xref="alg1.l8.m1.1.2.2.3">𝑠</ci></apply><apply id="alg1.l8.m1.1.2.3.cmml" xref="alg1.l8.m1.1.2.3"><apply id="alg1.l8.m1.1.2.3.1.cmml" xref="alg1.l8.m1.1.2.3.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.3.1.1.cmml" xref="alg1.l8.m1.1.2.3.1">subscript</csymbol><apply id="alg1.l8.m1.1.2.3.1.2.cmml" xref="alg1.l8.m1.1.2.3.1.2"><arg id="alg1.l8.m1.1.2.3.1.2.1.cmml" xref="alg1.l8.m1.1.2.3.1.2.1"></arg><max id="alg1.l8.m1.1.2.3.1.2.2.cmml" xref="alg1.l8.m1.1.2.3.1.2.2"></max></apply><apply id="alg1.l8.m1.1.2.3.1.3.cmml" xref="alg1.l8.m1.1.2.3.1.3"><in id="alg1.l8.m1.1.2.3.1.3.1.cmml" xref="alg1.l8.m1.1.2.3.1.3.1"></in><apply id="alg1.l8.m1.1.2.3.1.3.2.cmml" xref="alg1.l8.m1.1.2.3.1.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.3.1.3.2.1.cmml" xref="alg1.l8.m1.1.2.3.1.3.2">subscript</csymbol><ci id="alg1.l8.m1.1.2.3.1.3.2.2.cmml" xref="alg1.l8.m1.1.2.3.1.3.2.2">𝑥</ci><ci id="alg1.l8.m1.1.2.3.1.3.2.3.cmml" xref="alg1.l8.m1.1.2.3.1.3.2.3">𝑖</ci></apply><apply id="alg1.l8.m1.1.2.3.1.3.3.cmml" xref="alg1.l8.m1.1.2.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.2.3.1.3.3.1.cmml" xref="alg1.l8.m1.1.2.3.1.3.3">subscript</csymbol><ci id="alg1.l8.m1.1.2.3.1.3.3.2.cmml" xref="alg1.l8.m1.1.2.3.1.3.3.2">𝒳</ci><cn type="integer" id="alg1.l8.m1.1.2.3.1.3.3.3.cmml" xref="alg1.l8.m1.1.2.3.1.3.3.3">1</cn></apply></apply></apply><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝒟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">x_{s}\leftarrow\mathop{\arg\max}_{x_{i}\in\mathcal{X}_{1}}(\mathcal{D})</annotation></semantics></math>;

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>     <math id="alg1.l9.m1.2" class="ltx_Math" alttext="\mathcal{X}_{1}\leftarrow\mathcal{X}_{1}\setminus\{x_{s}\};\mathcal{X}_{2}\leftarrow\mathcal{X}_{2}\cup\{x_{s}\}" display="inline"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2.2" xref="alg1.l9.m1.2.2.3.cmml"><mrow id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml"><msub id="alg1.l9.m1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.1.3.2.cmml">𝒳</mi><mn id="alg1.l9.m1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.3.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.2.cmml">←</mo><mrow id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><msub id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.1.1.3.2.cmml">𝒳</mi><mn id="alg1.l9.m1.1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.1.3.3.cmml">1</mn></msub><mo id="alg1.l9.m1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.2.cmml">∖</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.cmml">{</mo><msub id="alg1.l9.m1.1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow></mrow><mo id="alg1.l9.m1.2.2.2.3" xref="alg1.l9.m1.2.2.3a.cmml">;</mo><mrow id="alg1.l9.m1.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.cmml"><msub id="alg1.l9.m1.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.2.2.2.2.3.2" xref="alg1.l9.m1.2.2.2.2.3.2.cmml">𝒳</mi><mn id="alg1.l9.m1.2.2.2.2.3.3" xref="alg1.l9.m1.2.2.2.2.3.3.cmml">2</mn></msub><mo stretchy="false" id="alg1.l9.m1.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.cmml">←</mo><mrow id="alg1.l9.m1.2.2.2.2.1" xref="alg1.l9.m1.2.2.2.2.1.cmml"><msub id="alg1.l9.m1.2.2.2.2.1.3" xref="alg1.l9.m1.2.2.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.2.2.2.2.1.3.2" xref="alg1.l9.m1.2.2.2.2.1.3.2.cmml">𝒳</mi><mn id="alg1.l9.m1.2.2.2.2.1.3.3" xref="alg1.l9.m1.2.2.2.2.1.3.3.cmml">2</mn></msub><mo id="alg1.l9.m1.2.2.2.2.1.2" xref="alg1.l9.m1.2.2.2.2.1.2.cmml">∪</mo><mrow id="alg1.l9.m1.2.2.2.2.1.1.1" xref="alg1.l9.m1.2.2.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l9.m1.2.2.2.2.1.1.1.2" xref="alg1.l9.m1.2.2.2.2.1.1.2.cmml">{</mo><msub id="alg1.l9.m1.2.2.2.2.1.1.1.1" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.cmml"><mi id="alg1.l9.m1.2.2.2.2.1.1.1.1.2" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.2.cmml">x</mi><mi id="alg1.l9.m1.2.2.2.2.1.1.1.1.3" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="alg1.l9.m1.2.2.2.2.1.1.1.3" xref="alg1.l9.m1.2.2.2.2.1.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.3a.cmml" xref="alg1.l9.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1"><ci id="alg1.l9.m1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.2">←</ci><apply id="alg1.l9.m1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.3.2">𝒳</ci><cn type="integer" id="alg1.l9.m1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.3.3">1</cn></apply><apply id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1"><setdiff id="alg1.l9.m1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.2"></setdiff><apply id="alg1.l9.m1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.2">𝒳</ci><cn type="integer" id="alg1.l9.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3.3">1</cn></apply><set id="alg1.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1"><apply id="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></set></apply></apply><apply id="alg1.l9.m1.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2"><ci id="alg1.l9.m1.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2">←</ci><apply id="alg1.l9.m1.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.3.1.cmml" xref="alg1.l9.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.3.2.cmml" xref="alg1.l9.m1.2.2.2.2.3.2">𝒳</ci><cn type="integer" id="alg1.l9.m1.2.2.2.2.3.3.cmml" xref="alg1.l9.m1.2.2.2.2.3.3">2</cn></apply><apply id="alg1.l9.m1.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.1"><union id="alg1.l9.m1.2.2.2.2.1.2.cmml" xref="alg1.l9.m1.2.2.2.2.1.2"></union><apply id="alg1.l9.m1.2.2.2.2.1.3.cmml" xref="alg1.l9.m1.2.2.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.1.3.1.cmml" xref="alg1.l9.m1.2.2.2.2.1.3">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.1.3.2.cmml" xref="alg1.l9.m1.2.2.2.2.1.3.2">𝒳</ci><cn type="integer" id="alg1.l9.m1.2.2.2.2.1.3.3.cmml" xref="alg1.l9.m1.2.2.2.2.1.3.3">2</cn></apply><set id="alg1.l9.m1.2.2.2.2.1.1.2.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1"><apply id="alg1.l9.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.1.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.1.1.1.1.2.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.2">𝑥</ci><ci id="alg1.l9.m1.2.2.2.2.1.1.1.1.3.cmml" xref="alg1.l9.m1.2.2.2.2.1.1.1.1.3">𝑠</ci></apply></set></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">\mathcal{X}_{1}\leftarrow\mathcal{X}_{1}\setminus\{x_{s}\};\mathcal{X}_{2}\leftarrow\mathcal{X}_{2}\cup\{x_{s}\}</annotation></semantics></math>;

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>  <span id="alg1.l10.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.2" class="ltx_text ltx_font_bold">while</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>  <span id="alg1.l11.1" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l11.m1.1" class="ltx_Math" alttext="\mathcal{X}_{2}" display="inline"><semantics id="alg1.l11.m1.1a"><msub id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">𝒳</mi><mn id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1">subscript</csymbol><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝒳</ci><cn type="integer" id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">\mathcal{X}_{2}</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
<div id="Sx3.SSx4.p3" class="ltx_para">
<p id="Sx3.SSx4.p3.1" class="ltx_p">Using this distance metric, we iteratively select the <math id="Sx3.SSx4.p3.1.m1.1" class="ltx_Math" alttext="M/4" display="inline"><semantics id="Sx3.SSx4.p3.1.m1.1a"><mrow id="Sx3.SSx4.p3.1.m1.1.1" xref="Sx3.SSx4.p3.1.m1.1.1.cmml"><mi id="Sx3.SSx4.p3.1.m1.1.1.2" xref="Sx3.SSx4.p3.1.m1.1.1.2.cmml">M</mi><mo id="Sx3.SSx4.p3.1.m1.1.1.1" xref="Sx3.SSx4.p3.1.m1.1.1.1.cmml">/</mo><mn id="Sx3.SSx4.p3.1.m1.1.1.3" xref="Sx3.SSx4.p3.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p3.1.m1.1b"><apply id="Sx3.SSx4.p3.1.m1.1.1.cmml" xref="Sx3.SSx4.p3.1.m1.1.1"><divide id="Sx3.SSx4.p3.1.m1.1.1.1.cmml" xref="Sx3.SSx4.p3.1.m1.1.1.1"></divide><ci id="Sx3.SSx4.p3.1.m1.1.1.2.cmml" xref="Sx3.SSx4.p3.1.m1.1.1.2">𝑀</ci><cn type="integer" id="Sx3.SSx4.p3.1.m1.1.1.3.cmml" xref="Sx3.SSx4.p3.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p3.1.m1.1c">M/4</annotation></semantics></math> farthest points based on Algorithm <a href="#alg1" title="Algorithm 1 ‣ Point Abstraction Block ‣ Methodology ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Consequently, the FCS can effectively cover the most requisite patches
and capture the long-range dependencies in the feature space for better prediction of HER2 status.</p>
</div>
<div id="Sx3.SSx4.p4" class="ltx_para">
<p id="Sx3.SSx4.p4.8" class="ltx_p">After FCS, we obtain a sampled point subset <math id="Sx3.SSx4.p4.1.m1.10" class="ltx_Math" alttext="\mathcal{X}_{2}=\{x_{s,1},x_{s,2},...,x_{s,M/4}\}" display="inline"><semantics id="Sx3.SSx4.p4.1.m1.10a"><mrow id="Sx3.SSx4.p4.1.m1.10.10" xref="Sx3.SSx4.p4.1.m1.10.10.cmml"><msub id="Sx3.SSx4.p4.1.m1.10.10.5" xref="Sx3.SSx4.p4.1.m1.10.10.5.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.p4.1.m1.10.10.5.2" xref="Sx3.SSx4.p4.1.m1.10.10.5.2.cmml">𝒳</mi><mn id="Sx3.SSx4.p4.1.m1.10.10.5.3" xref="Sx3.SSx4.p4.1.m1.10.10.5.3.cmml">2</mn></msub><mo id="Sx3.SSx4.p4.1.m1.10.10.4" xref="Sx3.SSx4.p4.1.m1.10.10.4.cmml">=</mo><mrow id="Sx3.SSx4.p4.1.m1.10.10.3.3" xref="Sx3.SSx4.p4.1.m1.10.10.3.4.cmml"><mo stretchy="false" id="Sx3.SSx4.p4.1.m1.10.10.3.3.4" xref="Sx3.SSx4.p4.1.m1.10.10.3.4.cmml">{</mo><msub id="Sx3.SSx4.p4.1.m1.8.8.1.1.1" xref="Sx3.SSx4.p4.1.m1.8.8.1.1.1.cmml"><mi id="Sx3.SSx4.p4.1.m1.8.8.1.1.1.2" xref="Sx3.SSx4.p4.1.m1.8.8.1.1.1.2.cmml">x</mi><mrow id="Sx3.SSx4.p4.1.m1.2.2.2.4" xref="Sx3.SSx4.p4.1.m1.2.2.2.3.cmml"><mi id="Sx3.SSx4.p4.1.m1.1.1.1.1" xref="Sx3.SSx4.p4.1.m1.1.1.1.1.cmml">s</mi><mo id="Sx3.SSx4.p4.1.m1.2.2.2.4.1" xref="Sx3.SSx4.p4.1.m1.2.2.2.3.cmml">,</mo><mn id="Sx3.SSx4.p4.1.m1.2.2.2.2" xref="Sx3.SSx4.p4.1.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo id="Sx3.SSx4.p4.1.m1.10.10.3.3.5" xref="Sx3.SSx4.p4.1.m1.10.10.3.4.cmml">,</mo><msub id="Sx3.SSx4.p4.1.m1.9.9.2.2.2" xref="Sx3.SSx4.p4.1.m1.9.9.2.2.2.cmml"><mi id="Sx3.SSx4.p4.1.m1.9.9.2.2.2.2" xref="Sx3.SSx4.p4.1.m1.9.9.2.2.2.2.cmml">x</mi><mrow id="Sx3.SSx4.p4.1.m1.4.4.2.4" xref="Sx3.SSx4.p4.1.m1.4.4.2.3.cmml"><mi id="Sx3.SSx4.p4.1.m1.3.3.1.1" xref="Sx3.SSx4.p4.1.m1.3.3.1.1.cmml">s</mi><mo id="Sx3.SSx4.p4.1.m1.4.4.2.4.1" xref="Sx3.SSx4.p4.1.m1.4.4.2.3.cmml">,</mo><mn id="Sx3.SSx4.p4.1.m1.4.4.2.2" xref="Sx3.SSx4.p4.1.m1.4.4.2.2.cmml">2</mn></mrow></msub><mo id="Sx3.SSx4.p4.1.m1.10.10.3.3.6" xref="Sx3.SSx4.p4.1.m1.10.10.3.4.cmml">,</mo><mi mathvariant="normal" id="Sx3.SSx4.p4.1.m1.7.7" xref="Sx3.SSx4.p4.1.m1.7.7.cmml">…</mi><mo id="Sx3.SSx4.p4.1.m1.10.10.3.3.7" xref="Sx3.SSx4.p4.1.m1.10.10.3.4.cmml">,</mo><msub id="Sx3.SSx4.p4.1.m1.10.10.3.3.3" xref="Sx3.SSx4.p4.1.m1.10.10.3.3.3.cmml"><mi id="Sx3.SSx4.p4.1.m1.10.10.3.3.3.2" xref="Sx3.SSx4.p4.1.m1.10.10.3.3.3.2.cmml">x</mi><mrow id="Sx3.SSx4.p4.1.m1.6.6.2.2" xref="Sx3.SSx4.p4.1.m1.6.6.2.3.cmml"><mi id="Sx3.SSx4.p4.1.m1.5.5.1.1" xref="Sx3.SSx4.p4.1.m1.5.5.1.1.cmml">s</mi><mo id="Sx3.SSx4.p4.1.m1.6.6.2.2.2" xref="Sx3.SSx4.p4.1.m1.6.6.2.3.cmml">,</mo><mrow id="Sx3.SSx4.p4.1.m1.6.6.2.2.1" xref="Sx3.SSx4.p4.1.m1.6.6.2.2.1.cmml"><mi id="Sx3.SSx4.p4.1.m1.6.6.2.2.1.2" xref="Sx3.SSx4.p4.1.m1.6.6.2.2.1.2.cmml">M</mi><mo id="Sx3.SSx4.p4.1.m1.6.6.2.2.1.1" xref="Sx3.SSx4.p4.1.m1.6.6.2.2.1.1.cmml">/</mo><mn id="Sx3.SSx4.p4.1.m1.6.6.2.2.1.3" xref="Sx3.SSx4.p4.1.m1.6.6.2.2.1.3.cmml">4</mn></mrow></mrow></msub><mo stretchy="false" id="Sx3.SSx4.p4.1.m1.10.10.3.3.8" xref="Sx3.SSx4.p4.1.m1.10.10.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p4.1.m1.10b"><apply id="Sx3.SSx4.p4.1.m1.10.10.cmml" xref="Sx3.SSx4.p4.1.m1.10.10"><eq id="Sx3.SSx4.p4.1.m1.10.10.4.cmml" xref="Sx3.SSx4.p4.1.m1.10.10.4"></eq><apply id="Sx3.SSx4.p4.1.m1.10.10.5.cmml" xref="Sx3.SSx4.p4.1.m1.10.10.5"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.1.m1.10.10.5.1.cmml" xref="Sx3.SSx4.p4.1.m1.10.10.5">subscript</csymbol><ci id="Sx3.SSx4.p4.1.m1.10.10.5.2.cmml" xref="Sx3.SSx4.p4.1.m1.10.10.5.2">𝒳</ci><cn type="integer" id="Sx3.SSx4.p4.1.m1.10.10.5.3.cmml" xref="Sx3.SSx4.p4.1.m1.10.10.5.3">2</cn></apply><set id="Sx3.SSx4.p4.1.m1.10.10.3.4.cmml" xref="Sx3.SSx4.p4.1.m1.10.10.3.3"><apply id="Sx3.SSx4.p4.1.m1.8.8.1.1.1.cmml" xref="Sx3.SSx4.p4.1.m1.8.8.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.1.m1.8.8.1.1.1.1.cmml" xref="Sx3.SSx4.p4.1.m1.8.8.1.1.1">subscript</csymbol><ci id="Sx3.SSx4.p4.1.m1.8.8.1.1.1.2.cmml" xref="Sx3.SSx4.p4.1.m1.8.8.1.1.1.2">𝑥</ci><list id="Sx3.SSx4.p4.1.m1.2.2.2.3.cmml" xref="Sx3.SSx4.p4.1.m1.2.2.2.4"><ci id="Sx3.SSx4.p4.1.m1.1.1.1.1.cmml" xref="Sx3.SSx4.p4.1.m1.1.1.1.1">𝑠</ci><cn type="integer" id="Sx3.SSx4.p4.1.m1.2.2.2.2.cmml" xref="Sx3.SSx4.p4.1.m1.2.2.2.2">1</cn></list></apply><apply id="Sx3.SSx4.p4.1.m1.9.9.2.2.2.cmml" xref="Sx3.SSx4.p4.1.m1.9.9.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.1.m1.9.9.2.2.2.1.cmml" xref="Sx3.SSx4.p4.1.m1.9.9.2.2.2">subscript</csymbol><ci id="Sx3.SSx4.p4.1.m1.9.9.2.2.2.2.cmml" xref="Sx3.SSx4.p4.1.m1.9.9.2.2.2.2">𝑥</ci><list id="Sx3.SSx4.p4.1.m1.4.4.2.3.cmml" xref="Sx3.SSx4.p4.1.m1.4.4.2.4"><ci id="Sx3.SSx4.p4.1.m1.3.3.1.1.cmml" xref="Sx3.SSx4.p4.1.m1.3.3.1.1">𝑠</ci><cn type="integer" id="Sx3.SSx4.p4.1.m1.4.4.2.2.cmml" xref="Sx3.SSx4.p4.1.m1.4.4.2.2">2</cn></list></apply><ci id="Sx3.SSx4.p4.1.m1.7.7.cmml" xref="Sx3.SSx4.p4.1.m1.7.7">…</ci><apply id="Sx3.SSx4.p4.1.m1.10.10.3.3.3.cmml" xref="Sx3.SSx4.p4.1.m1.10.10.3.3.3"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.1.m1.10.10.3.3.3.1.cmml" xref="Sx3.SSx4.p4.1.m1.10.10.3.3.3">subscript</csymbol><ci id="Sx3.SSx4.p4.1.m1.10.10.3.3.3.2.cmml" xref="Sx3.SSx4.p4.1.m1.10.10.3.3.3.2">𝑥</ci><list id="Sx3.SSx4.p4.1.m1.6.6.2.3.cmml" xref="Sx3.SSx4.p4.1.m1.6.6.2.2"><ci id="Sx3.SSx4.p4.1.m1.5.5.1.1.cmml" xref="Sx3.SSx4.p4.1.m1.5.5.1.1">𝑠</ci><apply id="Sx3.SSx4.p4.1.m1.6.6.2.2.1.cmml" xref="Sx3.SSx4.p4.1.m1.6.6.2.2.1"><divide id="Sx3.SSx4.p4.1.m1.6.6.2.2.1.1.cmml" xref="Sx3.SSx4.p4.1.m1.6.6.2.2.1.1"></divide><ci id="Sx3.SSx4.p4.1.m1.6.6.2.2.1.2.cmml" xref="Sx3.SSx4.p4.1.m1.6.6.2.2.1.2">𝑀</ci><cn type="integer" id="Sx3.SSx4.p4.1.m1.6.6.2.2.1.3.cmml" xref="Sx3.SSx4.p4.1.m1.6.6.2.2.1.3">4</cn></apply></list></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p4.1.m1.10c">\mathcal{X}_{2}=\{x_{s,1},x_{s,2},...,x_{s,M/4}\}</annotation></semantics></math>. For each sampled point <math id="Sx3.SSx4.p4.2.m2.1" class="ltx_Math" alttext="x_{i}\in\mathcal{X}_{2}" display="inline"><semantics id="Sx3.SSx4.p4.2.m2.1a"><mrow id="Sx3.SSx4.p4.2.m2.1.1" xref="Sx3.SSx4.p4.2.m2.1.1.cmml"><msub id="Sx3.SSx4.p4.2.m2.1.1.2" xref="Sx3.SSx4.p4.2.m2.1.1.2.cmml"><mi id="Sx3.SSx4.p4.2.m2.1.1.2.2" xref="Sx3.SSx4.p4.2.m2.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx4.p4.2.m2.1.1.2.3" xref="Sx3.SSx4.p4.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="Sx3.SSx4.p4.2.m2.1.1.1" xref="Sx3.SSx4.p4.2.m2.1.1.1.cmml">∈</mo><msub id="Sx3.SSx4.p4.2.m2.1.1.3" xref="Sx3.SSx4.p4.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.p4.2.m2.1.1.3.2" xref="Sx3.SSx4.p4.2.m2.1.1.3.2.cmml">𝒳</mi><mn id="Sx3.SSx4.p4.2.m2.1.1.3.3" xref="Sx3.SSx4.p4.2.m2.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p4.2.m2.1b"><apply id="Sx3.SSx4.p4.2.m2.1.1.cmml" xref="Sx3.SSx4.p4.2.m2.1.1"><in id="Sx3.SSx4.p4.2.m2.1.1.1.cmml" xref="Sx3.SSx4.p4.2.m2.1.1.1"></in><apply id="Sx3.SSx4.p4.2.m2.1.1.2.cmml" xref="Sx3.SSx4.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.2.m2.1.1.2.1.cmml" xref="Sx3.SSx4.p4.2.m2.1.1.2">subscript</csymbol><ci id="Sx3.SSx4.p4.2.m2.1.1.2.2.cmml" xref="Sx3.SSx4.p4.2.m2.1.1.2.2">𝑥</ci><ci id="Sx3.SSx4.p4.2.m2.1.1.2.3.cmml" xref="Sx3.SSx4.p4.2.m2.1.1.2.3">𝑖</ci></apply><apply id="Sx3.SSx4.p4.2.m2.1.1.3.cmml" xref="Sx3.SSx4.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.2.m2.1.1.3.1.cmml" xref="Sx3.SSx4.p4.2.m2.1.1.3">subscript</csymbol><ci id="Sx3.SSx4.p4.2.m2.1.1.3.2.cmml" xref="Sx3.SSx4.p4.2.m2.1.1.3.2">𝒳</ci><cn type="integer" id="Sx3.SSx4.p4.2.m2.1.1.3.3.cmml" xref="Sx3.SSx4.p4.2.m2.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p4.2.m2.1c">x_{i}\in\mathcal{X}_{2}</annotation></semantics></math>, we define its <span id="Sx3.SSx4.p4.8.1" class="ltx_text ltx_font_italic">k</span>-nearest neighborhood points (k=16) on <math id="Sx3.SSx4.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{X}_{1}" display="inline"><semantics id="Sx3.SSx4.p4.3.m3.1a"><msub id="Sx3.SSx4.p4.3.m3.1.1" xref="Sx3.SSx4.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.p4.3.m3.1.1.2" xref="Sx3.SSx4.p4.3.m3.1.1.2.cmml">𝒳</mi><mn id="Sx3.SSx4.p4.3.m3.1.1.3" xref="Sx3.SSx4.p4.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p4.3.m3.1b"><apply id="Sx3.SSx4.p4.3.m3.1.1.cmml" xref="Sx3.SSx4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.3.m3.1.1.1.cmml" xref="Sx3.SSx4.p4.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx4.p4.3.m3.1.1.2.cmml" xref="Sx3.SSx4.p4.3.m3.1.1.2">𝒳</ci><cn type="integer" id="Sx3.SSx4.p4.3.m3.1.1.3.cmml" xref="Sx3.SSx4.p4.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p4.3.m3.1c">\mathcal{X}_{1}</annotation></semantics></math> as a point subset: <math id="Sx3.SSx4.p4.4.m4.1" class="ltx_Math" alttext="\mathcal{X}_{2}(i)\subset\mathcal{X}_{1}" display="inline"><semantics id="Sx3.SSx4.p4.4.m4.1a"><mrow id="Sx3.SSx4.p4.4.m4.1.2" xref="Sx3.SSx4.p4.4.m4.1.2.cmml"><mrow id="Sx3.SSx4.p4.4.m4.1.2.2" xref="Sx3.SSx4.p4.4.m4.1.2.2.cmml"><msub id="Sx3.SSx4.p4.4.m4.1.2.2.2" xref="Sx3.SSx4.p4.4.m4.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.p4.4.m4.1.2.2.2.2" xref="Sx3.SSx4.p4.4.m4.1.2.2.2.2.cmml">𝒳</mi><mn id="Sx3.SSx4.p4.4.m4.1.2.2.2.3" xref="Sx3.SSx4.p4.4.m4.1.2.2.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.SSx4.p4.4.m4.1.2.2.1" xref="Sx3.SSx4.p4.4.m4.1.2.2.1.cmml">​</mo><mrow id="Sx3.SSx4.p4.4.m4.1.2.2.3.2" xref="Sx3.SSx4.p4.4.m4.1.2.2.cmml"><mo stretchy="false" id="Sx3.SSx4.p4.4.m4.1.2.2.3.2.1" xref="Sx3.SSx4.p4.4.m4.1.2.2.cmml">(</mo><mi id="Sx3.SSx4.p4.4.m4.1.1" xref="Sx3.SSx4.p4.4.m4.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.SSx4.p4.4.m4.1.2.2.3.2.2" xref="Sx3.SSx4.p4.4.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="Sx3.SSx4.p4.4.m4.1.2.1" xref="Sx3.SSx4.p4.4.m4.1.2.1.cmml">⊂</mo><msub id="Sx3.SSx4.p4.4.m4.1.2.3" xref="Sx3.SSx4.p4.4.m4.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.p4.4.m4.1.2.3.2" xref="Sx3.SSx4.p4.4.m4.1.2.3.2.cmml">𝒳</mi><mn id="Sx3.SSx4.p4.4.m4.1.2.3.3" xref="Sx3.SSx4.p4.4.m4.1.2.3.3.cmml">1</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p4.4.m4.1b"><apply id="Sx3.SSx4.p4.4.m4.1.2.cmml" xref="Sx3.SSx4.p4.4.m4.1.2"><subset id="Sx3.SSx4.p4.4.m4.1.2.1.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.1"></subset><apply id="Sx3.SSx4.p4.4.m4.1.2.2.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.2"><times id="Sx3.SSx4.p4.4.m4.1.2.2.1.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.2.1"></times><apply id="Sx3.SSx4.p4.4.m4.1.2.2.2.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.2.2"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.4.m4.1.2.2.2.1.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.2.2">subscript</csymbol><ci id="Sx3.SSx4.p4.4.m4.1.2.2.2.2.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.2.2.2">𝒳</ci><cn type="integer" id="Sx3.SSx4.p4.4.m4.1.2.2.2.3.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.2.2.3">2</cn></apply><ci id="Sx3.SSx4.p4.4.m4.1.1.cmml" xref="Sx3.SSx4.p4.4.m4.1.1">𝑖</ci></apply><apply id="Sx3.SSx4.p4.4.m4.1.2.3.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.4.m4.1.2.3.1.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.3">subscript</csymbol><ci id="Sx3.SSx4.p4.4.m4.1.2.3.2.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.3.2">𝒳</ci><cn type="integer" id="Sx3.SSx4.p4.4.m4.1.2.3.3.cmml" xref="Sx3.SSx4.p4.4.m4.1.2.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p4.4.m4.1c">\mathcal{X}_{2}(i)\subset\mathcal{X}_{1}</annotation></semantics></math>. Subsequently, we group the feature from <math id="Sx3.SSx4.p4.5.m5.1" class="ltx_Math" alttext="\mathcal{X}_{1}" display="inline"><semantics id="Sx3.SSx4.p4.5.m5.1a"><msub id="Sx3.SSx4.p4.5.m5.1.1" xref="Sx3.SSx4.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.p4.5.m5.1.1.2" xref="Sx3.SSx4.p4.5.m5.1.1.2.cmml">𝒳</mi><mn id="Sx3.SSx4.p4.5.m5.1.1.3" xref="Sx3.SSx4.p4.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p4.5.m5.1b"><apply id="Sx3.SSx4.p4.5.m5.1.1.cmml" xref="Sx3.SSx4.p4.5.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.5.m5.1.1.1.cmml" xref="Sx3.SSx4.p4.5.m5.1.1">subscript</csymbol><ci id="Sx3.SSx4.p4.5.m5.1.1.2.cmml" xref="Sx3.SSx4.p4.5.m5.1.1.2">𝒳</ci><cn type="integer" id="Sx3.SSx4.p4.5.m5.1.1.3.cmml" xref="Sx3.SSx4.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p4.5.m5.1c">\mathcal{X}_{1}</annotation></semantics></math> onto <math id="Sx3.SSx4.p4.6.m6.1" class="ltx_Math" alttext="\mathcal{X}_{2}" display="inline"><semantics id="Sx3.SSx4.p4.6.m6.1a"><msub id="Sx3.SSx4.p4.6.m6.1.1" xref="Sx3.SSx4.p4.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.p4.6.m6.1.1.2" xref="Sx3.SSx4.p4.6.m6.1.1.2.cmml">𝒳</mi><mn id="Sx3.SSx4.p4.6.m6.1.1.3" xref="Sx3.SSx4.p4.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p4.6.m6.1b"><apply id="Sx3.SSx4.p4.6.m6.1.1.cmml" xref="Sx3.SSx4.p4.6.m6.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.6.m6.1.1.1.cmml" xref="Sx3.SSx4.p4.6.m6.1.1">subscript</csymbol><ci id="Sx3.SSx4.p4.6.m6.1.1.2.cmml" xref="Sx3.SSx4.p4.6.m6.1.1.2">𝒳</ci><cn type="integer" id="Sx3.SSx4.p4.6.m6.1.1.3.cmml" xref="Sx3.SSx4.p4.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p4.6.m6.1c">\mathcal{X}_{2}</annotation></semantics></math> as <math id="Sx3.SSx4.p4.7.m7.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="Sx3.SSx4.p4.7.m7.1a"><msub id="Sx3.SSx4.p4.7.m7.1.1" xref="Sx3.SSx4.p4.7.m7.1.1.cmml"><mi id="Sx3.SSx4.p4.7.m7.1.1.2" xref="Sx3.SSx4.p4.7.m7.1.1.2.cmml">y</mi><mi id="Sx3.SSx4.p4.7.m7.1.1.3" xref="Sx3.SSx4.p4.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p4.7.m7.1b"><apply id="Sx3.SSx4.p4.7.m7.1.1.cmml" xref="Sx3.SSx4.p4.7.m7.1.1"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.7.m7.1.1.1.cmml" xref="Sx3.SSx4.p4.7.m7.1.1">subscript</csymbol><ci id="Sx3.SSx4.p4.7.m7.1.1.2.cmml" xref="Sx3.SSx4.p4.7.m7.1.1.2">𝑦</ci><ci id="Sx3.SSx4.p4.7.m7.1.1.3.cmml" xref="Sx3.SSx4.p4.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p4.7.m7.1c">y_{i}</annotation></semantics></math> for each point <math id="Sx3.SSx4.p4.8.m8.1" class="ltx_Math" alttext="x_{i}\in\mathcal{X}_{2}" display="inline"><semantics id="Sx3.SSx4.p4.8.m8.1a"><mrow id="Sx3.SSx4.p4.8.m8.1.1" xref="Sx3.SSx4.p4.8.m8.1.1.cmml"><msub id="Sx3.SSx4.p4.8.m8.1.1.2" xref="Sx3.SSx4.p4.8.m8.1.1.2.cmml"><mi id="Sx3.SSx4.p4.8.m8.1.1.2.2" xref="Sx3.SSx4.p4.8.m8.1.1.2.2.cmml">x</mi><mi id="Sx3.SSx4.p4.8.m8.1.1.2.3" xref="Sx3.SSx4.p4.8.m8.1.1.2.3.cmml">i</mi></msub><mo id="Sx3.SSx4.p4.8.m8.1.1.1" xref="Sx3.SSx4.p4.8.m8.1.1.1.cmml">∈</mo><msub id="Sx3.SSx4.p4.8.m8.1.1.3" xref="Sx3.SSx4.p4.8.m8.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx4.p4.8.m8.1.1.3.2" xref="Sx3.SSx4.p4.8.m8.1.1.3.2.cmml">𝒳</mi><mn id="Sx3.SSx4.p4.8.m8.1.1.3.3" xref="Sx3.SSx4.p4.8.m8.1.1.3.3.cmml">2</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx4.p4.8.m8.1b"><apply id="Sx3.SSx4.p4.8.m8.1.1.cmml" xref="Sx3.SSx4.p4.8.m8.1.1"><in id="Sx3.SSx4.p4.8.m8.1.1.1.cmml" xref="Sx3.SSx4.p4.8.m8.1.1.1"></in><apply id="Sx3.SSx4.p4.8.m8.1.1.2.cmml" xref="Sx3.SSx4.p4.8.m8.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.8.m8.1.1.2.1.cmml" xref="Sx3.SSx4.p4.8.m8.1.1.2">subscript</csymbol><ci id="Sx3.SSx4.p4.8.m8.1.1.2.2.cmml" xref="Sx3.SSx4.p4.8.m8.1.1.2.2">𝑥</ci><ci id="Sx3.SSx4.p4.8.m8.1.1.2.3.cmml" xref="Sx3.SSx4.p4.8.m8.1.1.2.3">𝑖</ci></apply><apply id="Sx3.SSx4.p4.8.m8.1.1.3.cmml" xref="Sx3.SSx4.p4.8.m8.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx4.p4.8.m8.1.1.3.1.cmml" xref="Sx3.SSx4.p4.8.m8.1.1.3">subscript</csymbol><ci id="Sx3.SSx4.p4.8.m8.1.1.3.2.cmml" xref="Sx3.SSx4.p4.8.m8.1.1.3.2">𝒳</ci><cn type="integer" id="Sx3.SSx4.p4.8.m8.1.1.3.3.cmml" xref="Sx3.SSx4.p4.8.m8.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx4.p4.8.m8.1c">x_{i}\in\mathcal{X}_{2}</annotation></semantics></math> using the following equation:</p>
<table id="A5.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E8.m1.2" class="ltx_Math" alttext="\displaystyle y_{i}=MaxPooling_{x_{j}\in\mathcal{X}_{2}(i)}(MLP(x_{j}))." display="inline"><semantics id="Sx3.E8.m1.2a"><mrow id="Sx3.E8.m1.2.2.1" xref="Sx3.E8.m1.2.2.1.1.cmml"><mrow id="Sx3.E8.m1.2.2.1.1" xref="Sx3.E8.m1.2.2.1.1.cmml"><msub id="Sx3.E8.m1.2.2.1.1.3" xref="Sx3.E8.m1.2.2.1.1.3.cmml"><mi id="Sx3.E8.m1.2.2.1.1.3.2" xref="Sx3.E8.m1.2.2.1.1.3.2.cmml">y</mi><mi id="Sx3.E8.m1.2.2.1.1.3.3" xref="Sx3.E8.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo id="Sx3.E8.m1.2.2.1.1.2" xref="Sx3.E8.m1.2.2.1.1.2.cmml">=</mo><mrow id="Sx3.E8.m1.2.2.1.1.1" xref="Sx3.E8.m1.2.2.1.1.1.cmml"><mi id="Sx3.E8.m1.2.2.1.1.1.3" xref="Sx3.E8.m1.2.2.1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.2" xref="Sx3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.2.2.1.1.1.4" xref="Sx3.E8.m1.2.2.1.1.1.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.2a" xref="Sx3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.2.2.1.1.1.5" xref="Sx3.E8.m1.2.2.1.1.1.5.cmml">x</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.2b" xref="Sx3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.2.2.1.1.1.6" xref="Sx3.E8.m1.2.2.1.1.1.6.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.2c" xref="Sx3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.2.2.1.1.1.7" xref="Sx3.E8.m1.2.2.1.1.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.2d" xref="Sx3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.2.2.1.1.1.8" xref="Sx3.E8.m1.2.2.1.1.1.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.2e" xref="Sx3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.2.2.1.1.1.9" xref="Sx3.E8.m1.2.2.1.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.2f" xref="Sx3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.2.2.1.1.1.10" xref="Sx3.E8.m1.2.2.1.1.1.10.cmml">i</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.2g" xref="Sx3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.2.2.1.1.1.11" xref="Sx3.E8.m1.2.2.1.1.1.11.cmml">n</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.2h" xref="Sx3.E8.m1.2.2.1.1.1.2.cmml">​</mo><msub id="Sx3.E8.m1.2.2.1.1.1.12" xref="Sx3.E8.m1.2.2.1.1.1.12.cmml"><mi id="Sx3.E8.m1.2.2.1.1.1.12.2" xref="Sx3.E8.m1.2.2.1.1.1.12.2.cmml">g</mi><mrow id="Sx3.E8.m1.1.1.1" xref="Sx3.E8.m1.1.1.1.cmml"><msub id="Sx3.E8.m1.1.1.1.3" xref="Sx3.E8.m1.1.1.1.3.cmml"><mi id="Sx3.E8.m1.1.1.1.3.2" xref="Sx3.E8.m1.1.1.1.3.2.cmml">x</mi><mi id="Sx3.E8.m1.1.1.1.3.3" xref="Sx3.E8.m1.1.1.1.3.3.cmml">j</mi></msub><mo id="Sx3.E8.m1.1.1.1.2" xref="Sx3.E8.m1.1.1.1.2.cmml">∈</mo><mrow id="Sx3.E8.m1.1.1.1.4" xref="Sx3.E8.m1.1.1.1.4.cmml"><msub id="Sx3.E8.m1.1.1.1.4.2" xref="Sx3.E8.m1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E8.m1.1.1.1.4.2.2" xref="Sx3.E8.m1.1.1.1.4.2.2.cmml">𝒳</mi><mn id="Sx3.E8.m1.1.1.1.4.2.3" xref="Sx3.E8.m1.1.1.1.4.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.1.1.1.4.1" xref="Sx3.E8.m1.1.1.1.4.1.cmml">​</mo><mrow id="Sx3.E8.m1.1.1.1.4.3.2" xref="Sx3.E8.m1.1.1.1.4.cmml"><mo stretchy="false" id="Sx3.E8.m1.1.1.1.4.3.2.1" xref="Sx3.E8.m1.1.1.1.4.cmml">(</mo><mi id="Sx3.E8.m1.1.1.1.1" xref="Sx3.E8.m1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="Sx3.E8.m1.1.1.1.4.3.2.2" xref="Sx3.E8.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.2i" xref="Sx3.E8.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="Sx3.E8.m1.2.2.1.1.1.1.1" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E8.m1.2.2.1.1.1.1.1.2" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E8.m1.2.2.1.1.1.1.1.1" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.cmml"><mi id="Sx3.E8.m1.2.2.1.1.1.1.1.1.3" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.1.1.1.2" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.2.2.1.1.1.1.1.1.4" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.1.1.1.2a" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E8.m1.2.2.1.1.1.1.1.1.5" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.E8.m1.2.2.1.1.1.1.1.1.2b" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.2" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.3" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E8.m1.2.2.1.1.1.1.1.3" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="Sx3.E8.m1.2.2.1.2" xref="Sx3.E8.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E8.m1.2b"><apply id="Sx3.E8.m1.2.2.1.1.cmml" xref="Sx3.E8.m1.2.2.1"><eq id="Sx3.E8.m1.2.2.1.1.2.cmml" xref="Sx3.E8.m1.2.2.1.1.2"></eq><apply id="Sx3.E8.m1.2.2.1.1.3.cmml" xref="Sx3.E8.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="Sx3.E8.m1.2.2.1.1.3.1.cmml" xref="Sx3.E8.m1.2.2.1.1.3">subscript</csymbol><ci id="Sx3.E8.m1.2.2.1.1.3.2.cmml" xref="Sx3.E8.m1.2.2.1.1.3.2">𝑦</ci><ci id="Sx3.E8.m1.2.2.1.1.3.3.cmml" xref="Sx3.E8.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="Sx3.E8.m1.2.2.1.1.1.cmml" xref="Sx3.E8.m1.2.2.1.1.1"><times id="Sx3.E8.m1.2.2.1.1.1.2.cmml" xref="Sx3.E8.m1.2.2.1.1.1.2"></times><ci id="Sx3.E8.m1.2.2.1.1.1.3.cmml" xref="Sx3.E8.m1.2.2.1.1.1.3">𝑀</ci><ci id="Sx3.E8.m1.2.2.1.1.1.4.cmml" xref="Sx3.E8.m1.2.2.1.1.1.4">𝑎</ci><ci id="Sx3.E8.m1.2.2.1.1.1.5.cmml" xref="Sx3.E8.m1.2.2.1.1.1.5">𝑥</ci><ci id="Sx3.E8.m1.2.2.1.1.1.6.cmml" xref="Sx3.E8.m1.2.2.1.1.1.6">𝑃</ci><ci id="Sx3.E8.m1.2.2.1.1.1.7.cmml" xref="Sx3.E8.m1.2.2.1.1.1.7">𝑜</ci><ci id="Sx3.E8.m1.2.2.1.1.1.8.cmml" xref="Sx3.E8.m1.2.2.1.1.1.8">𝑜</ci><ci id="Sx3.E8.m1.2.2.1.1.1.9.cmml" xref="Sx3.E8.m1.2.2.1.1.1.9">𝑙</ci><ci id="Sx3.E8.m1.2.2.1.1.1.10.cmml" xref="Sx3.E8.m1.2.2.1.1.1.10">𝑖</ci><ci id="Sx3.E8.m1.2.2.1.1.1.11.cmml" xref="Sx3.E8.m1.2.2.1.1.1.11">𝑛</ci><apply id="Sx3.E8.m1.2.2.1.1.1.12.cmml" xref="Sx3.E8.m1.2.2.1.1.1.12"><csymbol cd="ambiguous" id="Sx3.E8.m1.2.2.1.1.1.12.1.cmml" xref="Sx3.E8.m1.2.2.1.1.1.12">subscript</csymbol><ci id="Sx3.E8.m1.2.2.1.1.1.12.2.cmml" xref="Sx3.E8.m1.2.2.1.1.1.12.2">𝑔</ci><apply id="Sx3.E8.m1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1"><in id="Sx3.E8.m1.1.1.1.2.cmml" xref="Sx3.E8.m1.1.1.1.2"></in><apply id="Sx3.E8.m1.1.1.1.3.cmml" xref="Sx3.E8.m1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.3.1.cmml" xref="Sx3.E8.m1.1.1.1.3">subscript</csymbol><ci id="Sx3.E8.m1.1.1.1.3.2.cmml" xref="Sx3.E8.m1.1.1.1.3.2">𝑥</ci><ci id="Sx3.E8.m1.1.1.1.3.3.cmml" xref="Sx3.E8.m1.1.1.1.3.3">𝑗</ci></apply><apply id="Sx3.E8.m1.1.1.1.4.cmml" xref="Sx3.E8.m1.1.1.1.4"><times id="Sx3.E8.m1.1.1.1.4.1.cmml" xref="Sx3.E8.m1.1.1.1.4.1"></times><apply id="Sx3.E8.m1.1.1.1.4.2.cmml" xref="Sx3.E8.m1.1.1.1.4.2"><csymbol cd="ambiguous" id="Sx3.E8.m1.1.1.1.4.2.1.cmml" xref="Sx3.E8.m1.1.1.1.4.2">subscript</csymbol><ci id="Sx3.E8.m1.1.1.1.4.2.2.cmml" xref="Sx3.E8.m1.1.1.1.4.2.2">𝒳</ci><cn type="integer" id="Sx3.E8.m1.1.1.1.4.2.3.cmml" xref="Sx3.E8.m1.1.1.1.4.2.3">2</cn></apply><ci id="Sx3.E8.m1.1.1.1.1.cmml" xref="Sx3.E8.m1.1.1.1.1">𝑖</ci></apply></apply></apply><apply id="Sx3.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.2.2.1.1.1.1.1"><times id="Sx3.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.2"></times><ci id="Sx3.E8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.3">𝑀</ci><ci id="Sx3.E8.m1.2.2.1.1.1.1.1.1.4.cmml" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.4">𝐿</ci><ci id="Sx3.E8.m1.2.2.1.1.1.1.1.1.5.cmml" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.5">𝑃</ci><apply id="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E8.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E8.m1.2c">\displaystyle y_{i}=MaxPooling_{x_{j}\in\mathcal{X}_{2}(i)}(MLP(x_{j})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx4.p4.9" class="ltx_p">The MLP has two layers with each layer containing a linear transformation, batch normalization, and a ReLU activate function.</p>
</div>
<figure id="Sx3.F3" class="ltx_figure"><img src="/html/2312.06454/assets/farthest_cos_sample.png" id="Sx3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="279" height="175" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Difference between farthest point sampling and farthest cosine sampling. Light red: HER2+ points, light green: HER2- points.</figcaption>
</figure>
</section>
<section id="Sx3.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Point Classifier Block</h3>

<div id="Sx3.SSx5.p1" class="ltx_para">
<p id="Sx3.SSx5.p1.3" class="ltx_p">After performing <math id="Sx3.SSx5.p1.1.m1.1" class="ltx_math_unparsed" alttext="4\times" display="inline"><semantics id="Sx3.SSx5.p1.1.m1.1a"><mrow id="Sx3.SSx5.p1.1.m1.1b"><mn id="Sx3.SSx5.p1.1.m1.1.1">4</mn><mo lspace="0.222em" id="Sx3.SSx5.p1.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.1.m1.1c">4\times</annotation></semantics></math> attention and abstraction operations, we obtain 4 abstract points with a grouped feature representation denoted as <math id="Sx3.SSx5.p1.2.m2.1" class="ltx_Math" alttext="F_{g}\in\mathbb{R}^{4\times 512}" display="inline"><semantics id="Sx3.SSx5.p1.2.m2.1a"><mrow id="Sx3.SSx5.p1.2.m2.1.1" xref="Sx3.SSx5.p1.2.m2.1.1.cmml"><msub id="Sx3.SSx5.p1.2.m2.1.1.2" xref="Sx3.SSx5.p1.2.m2.1.1.2.cmml"><mi id="Sx3.SSx5.p1.2.m2.1.1.2.2" xref="Sx3.SSx5.p1.2.m2.1.1.2.2.cmml">F</mi><mi id="Sx3.SSx5.p1.2.m2.1.1.2.3" xref="Sx3.SSx5.p1.2.m2.1.1.2.3.cmml">g</mi></msub><mo id="Sx3.SSx5.p1.2.m2.1.1.1" xref="Sx3.SSx5.p1.2.m2.1.1.1.cmml">∈</mo><msup id="Sx3.SSx5.p1.2.m2.1.1.3" xref="Sx3.SSx5.p1.2.m2.1.1.3.cmml"><mi id="Sx3.SSx5.p1.2.m2.1.1.3.2" xref="Sx3.SSx5.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="Sx3.SSx5.p1.2.m2.1.1.3.3" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.cmml"><mn id="Sx3.SSx5.p1.2.m2.1.1.3.3.2" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.2.cmml">4</mn><mo lspace="0.222em" rspace="0.222em" id="Sx3.SSx5.p1.2.m2.1.1.3.3.1" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.1.cmml">×</mo><mn id="Sx3.SSx5.p1.2.m2.1.1.3.3.3" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.3.cmml">512</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.2.m2.1b"><apply id="Sx3.SSx5.p1.2.m2.1.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1"><in id="Sx3.SSx5.p1.2.m2.1.1.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.1"></in><apply id="Sx3.SSx5.p1.2.m2.1.1.2.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.2.m2.1.1.2.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.2">subscript</csymbol><ci id="Sx3.SSx5.p1.2.m2.1.1.2.2.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.2.2">𝐹</ci><ci id="Sx3.SSx5.p1.2.m2.1.1.2.3.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.2.3">𝑔</ci></apply><apply id="Sx3.SSx5.p1.2.m2.1.1.3.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.2.m2.1.1.3.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3">superscript</csymbol><ci id="Sx3.SSx5.p1.2.m2.1.1.3.2.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.2">ℝ</ci><apply id="Sx3.SSx5.p1.2.m2.1.1.3.3.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.3"><times id="Sx3.SSx5.p1.2.m2.1.1.3.3.1.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.1"></times><cn type="integer" id="Sx3.SSx5.p1.2.m2.1.1.3.3.2.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.2">4</cn><cn type="integer" id="Sx3.SSx5.p1.2.m2.1.1.3.3.3.cmml" xref="Sx3.SSx5.p1.2.m2.1.1.3.3.3">512</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.2.m2.1c">F_{g}\in\mathbb{R}^{4\times 512}</annotation></semantics></math>. By averaging the grouped feature, we derive the final WSI-level feature represented as <math id="Sx3.SSx5.p1.3.m3.1" class="ltx_Math" alttext="F_{h}\in\mathbb{R}^{64}" display="inline"><semantics id="Sx3.SSx5.p1.3.m3.1a"><mrow id="Sx3.SSx5.p1.3.m3.1.1" xref="Sx3.SSx5.p1.3.m3.1.1.cmml"><msub id="Sx3.SSx5.p1.3.m3.1.1.2" xref="Sx3.SSx5.p1.3.m3.1.1.2.cmml"><mi id="Sx3.SSx5.p1.3.m3.1.1.2.2" xref="Sx3.SSx5.p1.3.m3.1.1.2.2.cmml">F</mi><mi id="Sx3.SSx5.p1.3.m3.1.1.2.3" xref="Sx3.SSx5.p1.3.m3.1.1.2.3.cmml">h</mi></msub><mo id="Sx3.SSx5.p1.3.m3.1.1.1" xref="Sx3.SSx5.p1.3.m3.1.1.1.cmml">∈</mo><msup id="Sx3.SSx5.p1.3.m3.1.1.3" xref="Sx3.SSx5.p1.3.m3.1.1.3.cmml"><mi id="Sx3.SSx5.p1.3.m3.1.1.3.2" xref="Sx3.SSx5.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mn id="Sx3.SSx5.p1.3.m3.1.1.3.3" xref="Sx3.SSx5.p1.3.m3.1.1.3.3.cmml">64</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.3.m3.1b"><apply id="Sx3.SSx5.p1.3.m3.1.1.cmml" xref="Sx3.SSx5.p1.3.m3.1.1"><in id="Sx3.SSx5.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.1"></in><apply id="Sx3.SSx5.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.3.m3.1.1.2.1.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.2">subscript</csymbol><ci id="Sx3.SSx5.p1.3.m3.1.1.2.2.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.2.2">𝐹</ci><ci id="Sx3.SSx5.p1.3.m3.1.1.2.3.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.2.3">ℎ</ci></apply><apply id="Sx3.SSx5.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.3.m3.1.1.3.1.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3">superscript</csymbol><ci id="Sx3.SSx5.p1.3.m3.1.1.3.2.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3.2">ℝ</ci><cn type="integer" id="Sx3.SSx5.p1.3.m3.1.1.3.3.cmml" xref="Sx3.SSx5.p1.3.m3.1.1.3.3">64</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.3.m3.1c">F_{h}\in\mathbb{R}^{64}</annotation></semantics></math>:</p>
<table id="A5.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E9.m1.2" class="ltx_Math" alttext="\displaystyle F_{h}=MLP(GAP(F_{g}))=f_{h}(\mathcal{X})," display="inline"><semantics id="Sx3.E9.m1.2a"><mrow id="Sx3.E9.m1.2.2.1" xref="Sx3.E9.m1.2.2.1.1.cmml"><mrow id="Sx3.E9.m1.2.2.1.1" xref="Sx3.E9.m1.2.2.1.1.cmml"><msub id="Sx3.E9.m1.2.2.1.1.3" xref="Sx3.E9.m1.2.2.1.1.3.cmml"><mi id="Sx3.E9.m1.2.2.1.1.3.2" xref="Sx3.E9.m1.2.2.1.1.3.2.cmml">F</mi><mi id="Sx3.E9.m1.2.2.1.1.3.3" xref="Sx3.E9.m1.2.2.1.1.3.3.cmml">h</mi></msub><mo id="Sx3.E9.m1.2.2.1.1.4" xref="Sx3.E9.m1.2.2.1.1.4.cmml">=</mo><mrow id="Sx3.E9.m1.2.2.1.1.1" xref="Sx3.E9.m1.2.2.1.1.1.cmml"><mi id="Sx3.E9.m1.2.2.1.1.1.3" xref="Sx3.E9.m1.2.2.1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.2.2.1.1.1.2" xref="Sx3.E9.m1.2.2.1.1.1.2.cmml">​</mo><mi id="Sx3.E9.m1.2.2.1.1.1.4" xref="Sx3.E9.m1.2.2.1.1.1.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.2.2.1.1.1.2a" xref="Sx3.E9.m1.2.2.1.1.1.2.cmml">​</mo><mi id="Sx3.E9.m1.2.2.1.1.1.5" xref="Sx3.E9.m1.2.2.1.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.2.2.1.1.1.2b" xref="Sx3.E9.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="Sx3.E9.m1.2.2.1.1.1.1.1" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E9.m1.2.2.1.1.1.1.1.2" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E9.m1.2.2.1.1.1.1.1.1" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.cmml"><mi id="Sx3.E9.m1.2.2.1.1.1.1.1.1.3" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.2.2.1.1.1.1.1.1.2" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E9.m1.2.2.1.1.1.1.1.1.4" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.4.cmml">A</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.2.2.1.1.1.1.1.1.2a" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mi id="Sx3.E9.m1.2.2.1.1.1.1.1.1.5" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.2.2.1.1.1.1.1.1.2b" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.2" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">F</mi><mi id="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.3" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="Sx3.E9.m1.2.2.1.1.1.1.1.3" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E9.m1.2.2.1.1.5" xref="Sx3.E9.m1.2.2.1.1.5.cmml">=</mo><mrow id="Sx3.E9.m1.2.2.1.1.6" xref="Sx3.E9.m1.2.2.1.1.6.cmml"><msub id="Sx3.E9.m1.2.2.1.1.6.2" xref="Sx3.E9.m1.2.2.1.1.6.2.cmml"><mi id="Sx3.E9.m1.2.2.1.1.6.2.2" xref="Sx3.E9.m1.2.2.1.1.6.2.2.cmml">f</mi><mi id="Sx3.E9.m1.2.2.1.1.6.2.3" xref="Sx3.E9.m1.2.2.1.1.6.2.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E9.m1.2.2.1.1.6.1" xref="Sx3.E9.m1.2.2.1.1.6.1.cmml">​</mo><mrow id="Sx3.E9.m1.2.2.1.1.6.3.2" xref="Sx3.E9.m1.2.2.1.1.6.cmml"><mo stretchy="false" id="Sx3.E9.m1.2.2.1.1.6.3.2.1" xref="Sx3.E9.m1.2.2.1.1.6.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.E9.m1.1.1" xref="Sx3.E9.m1.1.1.cmml">𝒳</mi><mo stretchy="false" id="Sx3.E9.m1.2.2.1.1.6.3.2.2" xref="Sx3.E9.m1.2.2.1.1.6.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E9.m1.2.2.1.2" xref="Sx3.E9.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E9.m1.2b"><apply id="Sx3.E9.m1.2.2.1.1.cmml" xref="Sx3.E9.m1.2.2.1"><and id="Sx3.E9.m1.2.2.1.1a.cmml" xref="Sx3.E9.m1.2.2.1"></and><apply id="Sx3.E9.m1.2.2.1.1b.cmml" xref="Sx3.E9.m1.2.2.1"><eq id="Sx3.E9.m1.2.2.1.1.4.cmml" xref="Sx3.E9.m1.2.2.1.1.4"></eq><apply id="Sx3.E9.m1.2.2.1.1.3.cmml" xref="Sx3.E9.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="Sx3.E9.m1.2.2.1.1.3.1.cmml" xref="Sx3.E9.m1.2.2.1.1.3">subscript</csymbol><ci id="Sx3.E9.m1.2.2.1.1.3.2.cmml" xref="Sx3.E9.m1.2.2.1.1.3.2">𝐹</ci><ci id="Sx3.E9.m1.2.2.1.1.3.3.cmml" xref="Sx3.E9.m1.2.2.1.1.3.3">ℎ</ci></apply><apply id="Sx3.E9.m1.2.2.1.1.1.cmml" xref="Sx3.E9.m1.2.2.1.1.1"><times id="Sx3.E9.m1.2.2.1.1.1.2.cmml" xref="Sx3.E9.m1.2.2.1.1.1.2"></times><ci id="Sx3.E9.m1.2.2.1.1.1.3.cmml" xref="Sx3.E9.m1.2.2.1.1.1.3">𝑀</ci><ci id="Sx3.E9.m1.2.2.1.1.1.4.cmml" xref="Sx3.E9.m1.2.2.1.1.1.4">𝐿</ci><ci id="Sx3.E9.m1.2.2.1.1.1.5.cmml" xref="Sx3.E9.m1.2.2.1.1.1.5">𝑃</ci><apply id="Sx3.E9.m1.2.2.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.2.2.1.1.1.1.1"><times id="Sx3.E9.m1.2.2.1.1.1.1.1.1.2.cmml" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.2"></times><ci id="Sx3.E9.m1.2.2.1.1.1.1.1.1.3.cmml" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.3">𝐺</ci><ci id="Sx3.E9.m1.2.2.1.1.1.1.1.1.4.cmml" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.4">𝐴</ci><ci id="Sx3.E9.m1.2.2.1.1.1.1.1.1.5.cmml" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.5">𝑃</ci><apply id="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝐹</ci><ci id="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E9.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑔</ci></apply></apply></apply></apply><apply id="Sx3.E9.m1.2.2.1.1c.cmml" xref="Sx3.E9.m1.2.2.1"><eq id="Sx3.E9.m1.2.2.1.1.5.cmml" xref="Sx3.E9.m1.2.2.1.1.5"></eq><share href="#Sx3.E9.m1.2.2.1.1.1.cmml" id="Sx3.E9.m1.2.2.1.1d.cmml" xref="Sx3.E9.m1.2.2.1"></share><apply id="Sx3.E9.m1.2.2.1.1.6.cmml" xref="Sx3.E9.m1.2.2.1.1.6"><times id="Sx3.E9.m1.2.2.1.1.6.1.cmml" xref="Sx3.E9.m1.2.2.1.1.6.1"></times><apply id="Sx3.E9.m1.2.2.1.1.6.2.cmml" xref="Sx3.E9.m1.2.2.1.1.6.2"><csymbol cd="ambiguous" id="Sx3.E9.m1.2.2.1.1.6.2.1.cmml" xref="Sx3.E9.m1.2.2.1.1.6.2">subscript</csymbol><ci id="Sx3.E9.m1.2.2.1.1.6.2.2.cmml" xref="Sx3.E9.m1.2.2.1.1.6.2.2">𝑓</ci><ci id="Sx3.E9.m1.2.2.1.1.6.2.3.cmml" xref="Sx3.E9.m1.2.2.1.1.6.2.3">ℎ</ci></apply><ci id="Sx3.E9.m1.1.1.cmml" xref="Sx3.E9.m1.1.1">𝒳</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E9.m1.2c">\displaystyle F_{h}=MLP(GAP(F_{g}))=f_{h}(\mathcal{X}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx5.p1.5" class="ltx_p">where MLP has two layers with each layer containing a linear transformation and a ReLU activation function. Following the MLP, a linear layer with a softmax function named <math id="Sx3.SSx5.p1.4.m1.1" class="ltx_Math" alttext="f_{c}" display="inline"><semantics id="Sx3.SSx5.p1.4.m1.1a"><msub id="Sx3.SSx5.p1.4.m1.1.1" xref="Sx3.SSx5.p1.4.m1.1.1.cmml"><mi id="Sx3.SSx5.p1.4.m1.1.1.2" xref="Sx3.SSx5.p1.4.m1.1.1.2.cmml">f</mi><mi id="Sx3.SSx5.p1.4.m1.1.1.3" xref="Sx3.SSx5.p1.4.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.4.m1.1b"><apply id="Sx3.SSx5.p1.4.m1.1.1.cmml" xref="Sx3.SSx5.p1.4.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx5.p1.4.m1.1.1.1.cmml" xref="Sx3.SSx5.p1.4.m1.1.1">subscript</csymbol><ci id="Sx3.SSx5.p1.4.m1.1.1.2.cmml" xref="Sx3.SSx5.p1.4.m1.1.1.2">𝑓</ci><ci id="Sx3.SSx5.p1.4.m1.1.1.3.cmml" xref="Sx3.SSx5.p1.4.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.4.m1.1c">f_{c}</annotation></semantics></math> outputs the final HER2 status probabilities <math id="Sx3.SSx5.p1.5.m2.1" class="ltx_Math" alttext="p" display="inline"><semantics id="Sx3.SSx5.p1.5.m2.1a"><mi id="Sx3.SSx5.p1.5.m2.1.1" xref="Sx3.SSx5.p1.5.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx5.p1.5.m2.1b"><ci id="Sx3.SSx5.p1.5.m2.1.1.cmml" xref="Sx3.SSx5.p1.5.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx5.p1.5.m2.1c">p</annotation></semantics></math>. The loss is calculated using cross entropy (CE) loss function, which is formulated as:</p>
<table id="A5.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E10.m1.6" class="ltx_Math" alttext="\displaystyle\ell(p,y)=-\frac{1}{|\mathcal{P}|}\sum_{i}^{|\mathcal{P}|}\sum_{c=0}^{1}y_{c}^{i}\log(p_{c}^{i})." display="inline"><semantics id="Sx3.E10.m1.6a"><mrow id="Sx3.E10.m1.6.6.1" xref="Sx3.E10.m1.6.6.1.1.cmml"><mrow id="Sx3.E10.m1.6.6.1.1" xref="Sx3.E10.m1.6.6.1.1.cmml"><mrow id="Sx3.E10.m1.6.6.1.1.3" xref="Sx3.E10.m1.6.6.1.1.3.cmml"><mi mathvariant="normal" id="Sx3.E10.m1.6.6.1.1.3.2" xref="Sx3.E10.m1.6.6.1.1.3.2.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.6.6.1.1.3.1" xref="Sx3.E10.m1.6.6.1.1.3.1.cmml">​</mo><mrow id="Sx3.E10.m1.6.6.1.1.3.3.2" xref="Sx3.E10.m1.6.6.1.1.3.3.1.cmml"><mo stretchy="false" id="Sx3.E10.m1.6.6.1.1.3.3.2.1" xref="Sx3.E10.m1.6.6.1.1.3.3.1.cmml">(</mo><mi id="Sx3.E10.m1.3.3" xref="Sx3.E10.m1.3.3.cmml">p</mi><mo id="Sx3.E10.m1.6.6.1.1.3.3.2.2" xref="Sx3.E10.m1.6.6.1.1.3.3.1.cmml">,</mo><mi id="Sx3.E10.m1.4.4" xref="Sx3.E10.m1.4.4.cmml">y</mi><mo stretchy="false" id="Sx3.E10.m1.6.6.1.1.3.3.2.3" xref="Sx3.E10.m1.6.6.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E10.m1.6.6.1.1.2" xref="Sx3.E10.m1.6.6.1.1.2.cmml">=</mo><mrow id="Sx3.E10.m1.6.6.1.1.1" xref="Sx3.E10.m1.6.6.1.1.1.cmml"><mo id="Sx3.E10.m1.6.6.1.1.1a" xref="Sx3.E10.m1.6.6.1.1.1.cmml">−</mo><mrow id="Sx3.E10.m1.6.6.1.1.1.1" xref="Sx3.E10.m1.6.6.1.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.E10.m1.1.1" xref="Sx3.E10.m1.1.1.cmml"><mfrac id="Sx3.E10.m1.1.1a" xref="Sx3.E10.m1.1.1.cmml"><mn id="Sx3.E10.m1.1.1.3" xref="Sx3.E10.m1.1.1.3.cmml">1</mn><mrow id="Sx3.E10.m1.1.1.1.3" xref="Sx3.E10.m1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E10.m1.1.1.1.3.1" xref="Sx3.E10.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.E10.m1.1.1.1.1" xref="Sx3.E10.m1.1.1.1.1.cmml">𝒫</mi><mo stretchy="false" id="Sx3.E10.m1.1.1.1.3.2" xref="Sx3.E10.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="Sx3.E10.m1.6.6.1.1.1.1.2" xref="Sx3.E10.m1.6.6.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E10.m1.6.6.1.1.1.1.1" xref="Sx3.E10.m1.6.6.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.E10.m1.6.6.1.1.1.1.1.2" xref="Sx3.E10.m1.6.6.1.1.1.1.1.2.cmml"><munderover id="Sx3.E10.m1.6.6.1.1.1.1.1.2a" xref="Sx3.E10.m1.6.6.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.E10.m1.6.6.1.1.1.1.1.2.2.2" xref="Sx3.E10.m1.6.6.1.1.1.1.1.2.2.2.cmml">∑</mo><mi id="Sx3.E10.m1.6.6.1.1.1.1.1.2.2.3" xref="Sx3.E10.m1.6.6.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="Sx3.E10.m1.2.2.1.3" xref="Sx3.E10.m1.2.2.1.2.cmml"><mo stretchy="false" id="Sx3.E10.m1.2.2.1.3.1" xref="Sx3.E10.m1.2.2.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="Sx3.E10.m1.2.2.1.1" xref="Sx3.E10.m1.2.2.1.1.cmml">𝒫</mi><mo stretchy="false" id="Sx3.E10.m1.2.2.1.3.2" xref="Sx3.E10.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="Sx3.E10.m1.6.6.1.1.1.1.1.1" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.cmml"><munderover id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2a" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.2" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.cmml"><mi id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.2" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.2.cmml">c</mi><mo id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.1" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.3" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.3.cmml">0</mn></mrow><mn id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.3" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.3.cmml">1</mn></munderover></mstyle><mrow id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.cmml"><msubsup id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.2.2" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.2.3" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.2.3.cmml">c</mi><mi id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.3" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.3.cmml">i</mi></msubsup><mo lspace="0.167em" rspace="0em" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.2" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E10.m1.5.5" xref="Sx3.E10.m1.5.5.cmml">log</mi><mo id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1a" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">c</mi><mi id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="Sx3.E10.m1.6.6.1.2" xref="Sx3.E10.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E10.m1.6b"><apply id="Sx3.E10.m1.6.6.1.1.cmml" xref="Sx3.E10.m1.6.6.1"><eq id="Sx3.E10.m1.6.6.1.1.2.cmml" xref="Sx3.E10.m1.6.6.1.1.2"></eq><apply id="Sx3.E10.m1.6.6.1.1.3.cmml" xref="Sx3.E10.m1.6.6.1.1.3"><times id="Sx3.E10.m1.6.6.1.1.3.1.cmml" xref="Sx3.E10.m1.6.6.1.1.3.1"></times><ci id="Sx3.E10.m1.6.6.1.1.3.2.cmml" xref="Sx3.E10.m1.6.6.1.1.3.2">ℓ</ci><interval closure="open" id="Sx3.E10.m1.6.6.1.1.3.3.1.cmml" xref="Sx3.E10.m1.6.6.1.1.3.3.2"><ci id="Sx3.E10.m1.3.3.cmml" xref="Sx3.E10.m1.3.3">𝑝</ci><ci id="Sx3.E10.m1.4.4.cmml" xref="Sx3.E10.m1.4.4">𝑦</ci></interval></apply><apply id="Sx3.E10.m1.6.6.1.1.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1"><minus id="Sx3.E10.m1.6.6.1.1.1.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1"></minus><apply id="Sx3.E10.m1.6.6.1.1.1.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1"><times id="Sx3.E10.m1.6.6.1.1.1.1.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.2"></times><apply id="Sx3.E10.m1.1.1.cmml" xref="Sx3.E10.m1.1.1"><divide id="Sx3.E10.m1.1.1.2.cmml" xref="Sx3.E10.m1.1.1"></divide><cn type="integer" id="Sx3.E10.m1.1.1.3.cmml" xref="Sx3.E10.m1.1.1.3">1</cn><apply id="Sx3.E10.m1.1.1.1.2.cmml" xref="Sx3.E10.m1.1.1.1.3"><abs id="Sx3.E10.m1.1.1.1.2.1.cmml" xref="Sx3.E10.m1.1.1.1.3.1"></abs><ci id="Sx3.E10.m1.1.1.1.1.cmml" xref="Sx3.E10.m1.1.1.1.1">𝒫</ci></apply></apply><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1"><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E10.m1.6.6.1.1.1.1.1.2.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.2">superscript</csymbol><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.2.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E10.m1.6.6.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.2">subscript</csymbol><sum id="Sx3.E10.m1.6.6.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.2.2.2"></sum><ci id="Sx3.E10.m1.6.6.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="Sx3.E10.m1.2.2.1.2.cmml" xref="Sx3.E10.m1.2.2.1.3"><abs id="Sx3.E10.m1.2.2.1.2.1.cmml" xref="Sx3.E10.m1.2.2.1.3.1"></abs><ci id="Sx3.E10.m1.2.2.1.1.cmml" xref="Sx3.E10.m1.2.2.1.1">𝒫</ci></apply></apply><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1"><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2">superscript</csymbol><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2">subscript</csymbol><sum id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.2"></sum><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3"><eq id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.1"></eq><ci id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.2">𝑐</ci><cn type="integer" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.3.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.2.3.3">0</cn></apply></apply><cn type="integer" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.2.3">1</cn></apply><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1"><times id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.2"></times><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.2.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.2.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.2.3.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.2.3">𝑐</ci></apply><ci id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1"><log id="Sx3.E10.m1.5.5.cmml" xref="Sx3.E10.m1.5.5"></log><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑝</ci><ci id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑐</ci></apply><ci id="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E10.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E10.m1.6c">\displaystyle\ell(p,y)=-\frac{1}{|\mathcal{P}|}\sum_{i}^{|\mathcal{P}|}\sum_{c=0}^{1}y_{c}^{i}\log(p_{c}^{i}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<figure id="Sx3.F4" class="ltx_figure"><img src="/html/2312.06454/assets/fed_aux.png" id="Sx3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="279" height="138" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Dynamic distribution adjustment and auxiliary classifier for federated learning.</figcaption>
</figure>
</section>
<section id="Sx3.SSx6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Federated Learning with Dynamic Distribution Adjustment</h3>

<div id="Sx3.SSx6.p1" class="ltx_para">
<p id="Sx3.SSx6.p1.4" class="ltx_p">The WSIs from real sites exhibit a general non-independent and identically distributed (non-i.i.d.) scenario in which each site has different label distribution, which can impact the performance of federated learning <cite class="ltx_cite ltx_citemacro_citep">(Guan and Liu <a href="#bib.bib9" title="" class="ltx_ref">2023</a>)</cite>. To mitigate this issue, we introduce a novel dynamic distribution adjustment strategy. It subsampling the majority of HER2- WSIs to the same label distribution in the initial training stage of federated learning. Then the balanced label distribution dynamically adjusts to the real distribution after progressive training. Specifically, we keep all the HER2+ WSIs and generated a 0/1 mask <math id="Sx3.SSx6.p1.1.m1.1" class="ltx_Math" alttext="M(k)" display="inline"><semantics id="Sx3.SSx6.p1.1.m1.1a"><mrow id="Sx3.SSx6.p1.1.m1.1.2" xref="Sx3.SSx6.p1.1.m1.1.2.cmml"><mi id="Sx3.SSx6.p1.1.m1.1.2.2" xref="Sx3.SSx6.p1.1.m1.1.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx6.p1.1.m1.1.2.1" xref="Sx3.SSx6.p1.1.m1.1.2.1.cmml">​</mo><mrow id="Sx3.SSx6.p1.1.m1.1.2.3.2" xref="Sx3.SSx6.p1.1.m1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx6.p1.1.m1.1.2.3.2.1" xref="Sx3.SSx6.p1.1.m1.1.2.cmml">(</mo><mi id="Sx3.SSx6.p1.1.m1.1.1" xref="Sx3.SSx6.p1.1.m1.1.1.cmml">k</mi><mo stretchy="false" id="Sx3.SSx6.p1.1.m1.1.2.3.2.2" xref="Sx3.SSx6.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.1.m1.1b"><apply id="Sx3.SSx6.p1.1.m1.1.2.cmml" xref="Sx3.SSx6.p1.1.m1.1.2"><times id="Sx3.SSx6.p1.1.m1.1.2.1.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.1"></times><ci id="Sx3.SSx6.p1.1.m1.1.2.2.cmml" xref="Sx3.SSx6.p1.1.m1.1.2.2">𝑀</ci><ci id="Sx3.SSx6.p1.1.m1.1.1.cmml" xref="Sx3.SSx6.p1.1.m1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.1.m1.1c">M(k)</annotation></semantics></math> for the HER2- WSIs. This mask is created using a Bernoulli distribution <math id="Sx3.SSx6.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="Sx3.SSx6.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="Sx3.SSx6.p1.2.m2.1.1" xref="Sx3.SSx6.p1.2.m2.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.2.m2.1b"><ci id="Sx3.SSx6.p1.2.m2.1.1.cmml" xref="Sx3.SSx6.p1.2.m2.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.2.m2.1c">\mathcal{B}</annotation></semantics></math> with a probability of <math id="Sx3.SSx6.p1.3.m3.1" class="ltx_Math" alttext="b_{k}" display="inline"><semantics id="Sx3.SSx6.p1.3.m3.1a"><msub id="Sx3.SSx6.p1.3.m3.1.1" xref="Sx3.SSx6.p1.3.m3.1.1.cmml"><mi id="Sx3.SSx6.p1.3.m3.1.1.2" xref="Sx3.SSx6.p1.3.m3.1.1.2.cmml">b</mi><mi id="Sx3.SSx6.p1.3.m3.1.1.3" xref="Sx3.SSx6.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.3.m3.1b"><apply id="Sx3.SSx6.p1.3.m3.1.1.cmml" xref="Sx3.SSx6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.3.m3.1.1.1.cmml" xref="Sx3.SSx6.p1.3.m3.1.1">subscript</csymbol><ci id="Sx3.SSx6.p1.3.m3.1.1.2.cmml" xref="Sx3.SSx6.p1.3.m3.1.1.2">𝑏</ci><ci id="Sx3.SSx6.p1.3.m3.1.1.3.cmml" xref="Sx3.SSx6.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.3.m3.1c">b_{k}</annotation></semantics></math> at <math id="Sx3.SSx6.p1.4.m4.1" class="ltx_Math" alttext="k_{th}" display="inline"><semantics id="Sx3.SSx6.p1.4.m4.1a"><msub id="Sx3.SSx6.p1.4.m4.1.1" xref="Sx3.SSx6.p1.4.m4.1.1.cmml"><mi id="Sx3.SSx6.p1.4.m4.1.1.2" xref="Sx3.SSx6.p1.4.m4.1.1.2.cmml">k</mi><mrow id="Sx3.SSx6.p1.4.m4.1.1.3" xref="Sx3.SSx6.p1.4.m4.1.1.3.cmml"><mi id="Sx3.SSx6.p1.4.m4.1.1.3.2" xref="Sx3.SSx6.p1.4.m4.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx6.p1.4.m4.1.1.3.1" xref="Sx3.SSx6.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx6.p1.4.m4.1.1.3.3" xref="Sx3.SSx6.p1.4.m4.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.4.m4.1b"><apply id="Sx3.SSx6.p1.4.m4.1.1.cmml" xref="Sx3.SSx6.p1.4.m4.1.1"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.4.m4.1.1.1.cmml" xref="Sx3.SSx6.p1.4.m4.1.1">subscript</csymbol><ci id="Sx3.SSx6.p1.4.m4.1.1.2.cmml" xref="Sx3.SSx6.p1.4.m4.1.1.2">𝑘</ci><apply id="Sx3.SSx6.p1.4.m4.1.1.3.cmml" xref="Sx3.SSx6.p1.4.m4.1.1.3"><times id="Sx3.SSx6.p1.4.m4.1.1.3.1.cmml" xref="Sx3.SSx6.p1.4.m4.1.1.3.1"></times><ci id="Sx3.SSx6.p1.4.m4.1.1.3.2.cmml" xref="Sx3.SSx6.p1.4.m4.1.1.3.2">𝑡</ci><ci id="Sx3.SSx6.p1.4.m4.1.1.3.3.cmml" xref="Sx3.SSx6.p1.4.m4.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.4.m4.1c">k_{th}</annotation></semantics></math> iteration.</p>
<table id="A5.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E11.m1.1" class="ltx_Math" alttext="\displaystyle M_{i}(k)" display="inline"><semantics id="Sx3.E11.m1.1a"><mrow id="Sx3.E11.m1.1.2" xref="Sx3.E11.m1.1.2.cmml"><msub id="Sx3.E11.m1.1.2.2" xref="Sx3.E11.m1.1.2.2.cmml"><mi id="Sx3.E11.m1.1.2.2.2" xref="Sx3.E11.m1.1.2.2.2.cmml">M</mi><mi id="Sx3.E11.m1.1.2.2.3" xref="Sx3.E11.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E11.m1.1.2.1" xref="Sx3.E11.m1.1.2.1.cmml">​</mo><mrow id="Sx3.E11.m1.1.2.3.2" xref="Sx3.E11.m1.1.2.cmml"><mo stretchy="false" id="Sx3.E11.m1.1.2.3.2.1" xref="Sx3.E11.m1.1.2.cmml">(</mo><mi id="Sx3.E11.m1.1.1" xref="Sx3.E11.m1.1.1.cmml">k</mi><mo stretchy="false" id="Sx3.E11.m1.1.2.3.2.2" xref="Sx3.E11.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E11.m1.1b"><apply id="Sx3.E11.m1.1.2.cmml" xref="Sx3.E11.m1.1.2"><times id="Sx3.E11.m1.1.2.1.cmml" xref="Sx3.E11.m1.1.2.1"></times><apply id="Sx3.E11.m1.1.2.2.cmml" xref="Sx3.E11.m1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E11.m1.1.2.2.1.cmml" xref="Sx3.E11.m1.1.2.2">subscript</csymbol><ci id="Sx3.E11.m1.1.2.2.2.cmml" xref="Sx3.E11.m1.1.2.2.2">𝑀</ci><ci id="Sx3.E11.m1.1.2.2.3.cmml" xref="Sx3.E11.m1.1.2.2.3">𝑖</ci></apply><ci id="Sx3.E11.m1.1.1.cmml" xref="Sx3.E11.m1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E11.m1.1c">\displaystyle M_{i}(k)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E11.m2.1" class="ltx_Math" alttext="\displaystyle=\mathcal{B}(b_{i}^{k})," display="inline"><semantics id="Sx3.E11.m2.1a"><mrow id="Sx3.E11.m2.1.1.1" xref="Sx3.E11.m2.1.1.1.1.cmml"><mrow id="Sx3.E11.m2.1.1.1.1" xref="Sx3.E11.m2.1.1.1.1.cmml"><mi id="Sx3.E11.m2.1.1.1.1.3" xref="Sx3.E11.m2.1.1.1.1.3.cmml"></mi><mo id="Sx3.E11.m2.1.1.1.1.2" xref="Sx3.E11.m2.1.1.1.1.2.cmml">=</mo><mrow id="Sx3.E11.m2.1.1.1.1.1" xref="Sx3.E11.m2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E11.m2.1.1.1.1.1.3" xref="Sx3.E11.m2.1.1.1.1.1.3.cmml">ℬ</mi><mo lspace="0em" rspace="0em" id="Sx3.E11.m2.1.1.1.1.1.2" xref="Sx3.E11.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E11.m2.1.1.1.1.1.1.1" xref="Sx3.E11.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E11.m2.1.1.1.1.1.1.1.2" xref="Sx3.E11.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="Sx3.E11.m2.1.1.1.1.1.1.1.1" xref="Sx3.E11.m2.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E11.m2.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E11.m2.1.1.1.1.1.1.1.1.2.2.cmml">b</mi><mi id="Sx3.E11.m2.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E11.m2.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="Sx3.E11.m2.1.1.1.1.1.1.1.1.3" xref="Sx3.E11.m2.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="Sx3.E11.m2.1.1.1.1.1.1.1.3" xref="Sx3.E11.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="Sx3.E11.m2.1.1.1.2" xref="Sx3.E11.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E11.m2.1b"><apply id="Sx3.E11.m2.1.1.1.1.cmml" xref="Sx3.E11.m2.1.1.1"><eq id="Sx3.E11.m2.1.1.1.1.2.cmml" xref="Sx3.E11.m2.1.1.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E11.m2.1.1.1.1.3.cmml" xref="Sx3.E11.m2.1.1.1.1.3">absent</csymbol><apply id="Sx3.E11.m2.1.1.1.1.1.cmml" xref="Sx3.E11.m2.1.1.1.1.1"><times id="Sx3.E11.m2.1.1.1.1.1.2.cmml" xref="Sx3.E11.m2.1.1.1.1.1.2"></times><ci id="Sx3.E11.m2.1.1.1.1.1.3.cmml" xref="Sx3.E11.m2.1.1.1.1.1.3">ℬ</ci><apply id="Sx3.E11.m2.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E11.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E11.m2.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E11.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E11.m2.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E11.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E11.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E11.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E11.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E11.m2.1.1.1.1.1.1.1.1.2.2">𝑏</ci><ci id="Sx3.E11.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E11.m2.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="Sx3.E11.m2.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E11.m2.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E11.m2.1c">\displaystyle=\mathcal{B}(b_{i}^{k}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<table id="A5.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E12.m1.1" class="ltx_Math" alttext="\displaystyle b_{i}^{k}" display="inline"><semantics id="Sx3.E12.m1.1a"><msubsup id="Sx3.E12.m1.1.1" xref="Sx3.E12.m1.1.1.cmml"><mi id="Sx3.E12.m1.1.1.2.2" xref="Sx3.E12.m1.1.1.2.2.cmml">b</mi><mi id="Sx3.E12.m1.1.1.2.3" xref="Sx3.E12.m1.1.1.2.3.cmml">i</mi><mi id="Sx3.E12.m1.1.1.3" xref="Sx3.E12.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="Sx3.E12.m1.1b"><apply id="Sx3.E12.m1.1.1.cmml" xref="Sx3.E12.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E12.m1.1.1.1.cmml" xref="Sx3.E12.m1.1.1">superscript</csymbol><apply id="Sx3.E12.m1.1.1.2.cmml" xref="Sx3.E12.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E12.m1.1.1.2.1.cmml" xref="Sx3.E12.m1.1.1">subscript</csymbol><ci id="Sx3.E12.m1.1.1.2.2.cmml" xref="Sx3.E12.m1.1.1.2.2">𝑏</ci><ci id="Sx3.E12.m1.1.1.2.3.cmml" xref="Sx3.E12.m1.1.1.2.3">𝑖</ci></apply><ci id="Sx3.E12.m1.1.1.3.cmml" xref="Sx3.E12.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E12.m1.1c">\displaystyle b_{i}^{k}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E12.m2.3" class="ltx_Math" alttext="\displaystyle=\frac{1}{\gamma_{i}}+(1-\frac{1}{\gamma_{i}})\cdot\frac{e^{k/K}-1}{e-1}\in[\frac{1}{\gamma_{i}},1]," display="inline"><semantics id="Sx3.E12.m2.3a"><mrow id="Sx3.E12.m2.3.3.1" xref="Sx3.E12.m2.3.3.1.1.cmml"><mrow id="Sx3.E12.m2.3.3.1.1" xref="Sx3.E12.m2.3.3.1.1.cmml"><mi id="Sx3.E12.m2.3.3.1.1.3" xref="Sx3.E12.m2.3.3.1.1.3.cmml"></mi><mo id="Sx3.E12.m2.3.3.1.1.4" xref="Sx3.E12.m2.3.3.1.1.4.cmml">=</mo><mrow id="Sx3.E12.m2.3.3.1.1.1" xref="Sx3.E12.m2.3.3.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.E12.m2.3.3.1.1.1.3" xref="Sx3.E12.m2.3.3.1.1.1.3.cmml"><mfrac id="Sx3.E12.m2.3.3.1.1.1.3a" xref="Sx3.E12.m2.3.3.1.1.1.3.cmml"><mn id="Sx3.E12.m2.3.3.1.1.1.3.2" xref="Sx3.E12.m2.3.3.1.1.1.3.2.cmml">1</mn><msub id="Sx3.E12.m2.3.3.1.1.1.3.3" xref="Sx3.E12.m2.3.3.1.1.1.3.3.cmml"><mi id="Sx3.E12.m2.3.3.1.1.1.3.3.2" xref="Sx3.E12.m2.3.3.1.1.1.3.3.2.cmml">γ</mi><mi id="Sx3.E12.m2.3.3.1.1.1.3.3.3" xref="Sx3.E12.m2.3.3.1.1.1.3.3.3.cmml">i</mi></msub></mfrac></mstyle><mo id="Sx3.E12.m2.3.3.1.1.1.2" xref="Sx3.E12.m2.3.3.1.1.1.2.cmml">+</mo><mrow id="Sx3.E12.m2.3.3.1.1.1.1" xref="Sx3.E12.m2.3.3.1.1.1.1.cmml"><mrow id="Sx3.E12.m2.3.3.1.1.1.1.1.1" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E12.m2.3.3.1.1.1.1.1.1.2" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.cmml"><mn id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.2" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.1" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.cmml"><mfrac id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3a" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.cmml"><mn id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.2" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.2.cmml">1</mn><msub id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.cmml"><mi id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.2" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.2.cmml">γ</mi><mi id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.3" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mfrac></mstyle></mrow><mo rspace="0.055em" stretchy="false" id="Sx3.E12.m2.3.3.1.1.1.1.1.1.3" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="Sx3.E12.m2.3.3.1.1.1.1.2" xref="Sx3.E12.m2.3.3.1.1.1.1.2.cmml">⋅</mo><mstyle displaystyle="true" id="Sx3.E12.m2.3.3.1.1.1.1.3" xref="Sx3.E12.m2.3.3.1.1.1.1.3.cmml"><mfrac id="Sx3.E12.m2.3.3.1.1.1.1.3a" xref="Sx3.E12.m2.3.3.1.1.1.1.3.cmml"><mrow id="Sx3.E12.m2.3.3.1.1.1.1.3.2" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.cmml"><msup id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.cmml"><mi id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.2" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.2.cmml">e</mi><mrow id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.cmml"><mi id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.2" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.2.cmml">k</mi><mo id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.1" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.1.cmml">/</mo><mi id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.3" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.3.cmml">K</mi></mrow></msup><mo id="Sx3.E12.m2.3.3.1.1.1.1.3.2.1" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.1.cmml">−</mo><mn id="Sx3.E12.m2.3.3.1.1.1.1.3.2.3" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.3.cmml">1</mn></mrow><mrow id="Sx3.E12.m2.3.3.1.1.1.1.3.3" xref="Sx3.E12.m2.3.3.1.1.1.1.3.3.cmml"><mi id="Sx3.E12.m2.3.3.1.1.1.1.3.3.2" xref="Sx3.E12.m2.3.3.1.1.1.1.3.3.2.cmml">e</mi><mo id="Sx3.E12.m2.3.3.1.1.1.1.3.3.1" xref="Sx3.E12.m2.3.3.1.1.1.1.3.3.1.cmml">−</mo><mn id="Sx3.E12.m2.3.3.1.1.1.1.3.3.3" xref="Sx3.E12.m2.3.3.1.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mstyle></mrow></mrow><mo id="Sx3.E12.m2.3.3.1.1.5" xref="Sx3.E12.m2.3.3.1.1.5.cmml">∈</mo><mrow id="Sx3.E12.m2.3.3.1.1.6.2" xref="Sx3.E12.m2.3.3.1.1.6.1.cmml"><mo stretchy="false" id="Sx3.E12.m2.3.3.1.1.6.2.1" xref="Sx3.E12.m2.3.3.1.1.6.1.cmml">[</mo><mstyle displaystyle="true" id="Sx3.E12.m2.1.1" xref="Sx3.E12.m2.1.1.cmml"><mfrac id="Sx3.E12.m2.1.1a" xref="Sx3.E12.m2.1.1.cmml"><mn id="Sx3.E12.m2.1.1.2" xref="Sx3.E12.m2.1.1.2.cmml">1</mn><msub id="Sx3.E12.m2.1.1.3" xref="Sx3.E12.m2.1.1.3.cmml"><mi id="Sx3.E12.m2.1.1.3.2" xref="Sx3.E12.m2.1.1.3.2.cmml">γ</mi><mi id="Sx3.E12.m2.1.1.3.3" xref="Sx3.E12.m2.1.1.3.3.cmml">i</mi></msub></mfrac></mstyle><mo id="Sx3.E12.m2.3.3.1.1.6.2.2" xref="Sx3.E12.m2.3.3.1.1.6.1.cmml">,</mo><mn id="Sx3.E12.m2.2.2" xref="Sx3.E12.m2.2.2.cmml">1</mn><mo stretchy="false" id="Sx3.E12.m2.3.3.1.1.6.2.3" xref="Sx3.E12.m2.3.3.1.1.6.1.cmml">]</mo></mrow></mrow><mo id="Sx3.E12.m2.3.3.1.2" xref="Sx3.E12.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E12.m2.3b"><apply id="Sx3.E12.m2.3.3.1.1.cmml" xref="Sx3.E12.m2.3.3.1"><and id="Sx3.E12.m2.3.3.1.1a.cmml" xref="Sx3.E12.m2.3.3.1"></and><apply id="Sx3.E12.m2.3.3.1.1b.cmml" xref="Sx3.E12.m2.3.3.1"><eq id="Sx3.E12.m2.3.3.1.1.4.cmml" xref="Sx3.E12.m2.3.3.1.1.4"></eq><csymbol cd="latexml" id="Sx3.E12.m2.3.3.1.1.3.cmml" xref="Sx3.E12.m2.3.3.1.1.3">absent</csymbol><apply id="Sx3.E12.m2.3.3.1.1.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1"><plus id="Sx3.E12.m2.3.3.1.1.1.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.2"></plus><apply id="Sx3.E12.m2.3.3.1.1.1.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.3"><divide id="Sx3.E12.m2.3.3.1.1.1.3.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.3"></divide><cn type="integer" id="Sx3.E12.m2.3.3.1.1.1.3.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.3.2">1</cn><apply id="Sx3.E12.m2.3.3.1.1.1.3.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.E12.m2.3.3.1.1.1.3.3.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.3.3">subscript</csymbol><ci id="Sx3.E12.m2.3.3.1.1.1.3.3.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.3.3.2">𝛾</ci><ci id="Sx3.E12.m2.3.3.1.1.1.3.3.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="Sx3.E12.m2.3.3.1.1.1.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1"><ci id="Sx3.E12.m2.3.3.1.1.1.1.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.2">⋅</ci><apply id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1"><minus id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.2">1</cn><apply id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3"><divide id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3"></divide><cn type="integer" id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.2">1</cn><apply id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.2">𝛾</ci><ci id="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="Sx3.E12.m2.3.3.1.1.1.1.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3"><divide id="Sx3.E12.m2.3.3.1.1.1.1.3.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3"></divide><apply id="Sx3.E12.m2.3.3.1.1.1.1.3.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2"><minus id="Sx3.E12.m2.3.3.1.1.1.1.3.2.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.1"></minus><apply id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2">superscript</csymbol><ci id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.2">𝑒</ci><apply id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3"><divide id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.1"></divide><ci id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.2">𝑘</ci><ci id="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.2.3.3">𝐾</ci></apply></apply><cn type="integer" id="Sx3.E12.m2.3.3.1.1.1.1.3.2.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.2.3">1</cn></apply><apply id="Sx3.E12.m2.3.3.1.1.1.1.3.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.3"><minus id="Sx3.E12.m2.3.3.1.1.1.1.3.3.1.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.3.1"></minus><ci id="Sx3.E12.m2.3.3.1.1.1.1.3.3.2.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.3.2">𝑒</ci><cn type="integer" id="Sx3.E12.m2.3.3.1.1.1.1.3.3.3.cmml" xref="Sx3.E12.m2.3.3.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply><apply id="Sx3.E12.m2.3.3.1.1c.cmml" xref="Sx3.E12.m2.3.3.1"><in id="Sx3.E12.m2.3.3.1.1.5.cmml" xref="Sx3.E12.m2.3.3.1.1.5"></in><share href="#Sx3.E12.m2.3.3.1.1.1.cmml" id="Sx3.E12.m2.3.3.1.1d.cmml" xref="Sx3.E12.m2.3.3.1"></share><interval closure="closed" id="Sx3.E12.m2.3.3.1.1.6.1.cmml" xref="Sx3.E12.m2.3.3.1.1.6.2"><apply id="Sx3.E12.m2.1.1.cmml" xref="Sx3.E12.m2.1.1"><divide id="Sx3.E12.m2.1.1.1.cmml" xref="Sx3.E12.m2.1.1"></divide><cn type="integer" id="Sx3.E12.m2.1.1.2.cmml" xref="Sx3.E12.m2.1.1.2">1</cn><apply id="Sx3.E12.m2.1.1.3.cmml" xref="Sx3.E12.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.E12.m2.1.1.3.1.cmml" xref="Sx3.E12.m2.1.1.3">subscript</csymbol><ci id="Sx3.E12.m2.1.1.3.2.cmml" xref="Sx3.E12.m2.1.1.3.2">𝛾</ci><ci id="Sx3.E12.m2.1.1.3.3.cmml" xref="Sx3.E12.m2.1.1.3.3">𝑖</ci></apply></apply><cn type="integer" id="Sx3.E12.m2.2.2.cmml" xref="Sx3.E12.m2.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E12.m2.3c">\displaystyle=\frac{1}{\gamma_{i}}+(1-\frac{1}{\gamma_{i}})\cdot\frac{e^{k/K}-1}{e-1}\in[\frac{1}{\gamma_{i}},1],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx6.p1.7" class="ltx_p">where <math id="Sx3.SSx6.p1.5.m1.1" class="ltx_Math" alttext="\gamma_{i}" display="inline"><semantics id="Sx3.SSx6.p1.5.m1.1a"><msub id="Sx3.SSx6.p1.5.m1.1.1" xref="Sx3.SSx6.p1.5.m1.1.1.cmml"><mi id="Sx3.SSx6.p1.5.m1.1.1.2" xref="Sx3.SSx6.p1.5.m1.1.1.2.cmml">γ</mi><mi id="Sx3.SSx6.p1.5.m1.1.1.3" xref="Sx3.SSx6.p1.5.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.5.m1.1b"><apply id="Sx3.SSx6.p1.5.m1.1.1.cmml" xref="Sx3.SSx6.p1.5.m1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.5.m1.1.1.1.cmml" xref="Sx3.SSx6.p1.5.m1.1.1">subscript</csymbol><ci id="Sx3.SSx6.p1.5.m1.1.1.2.cmml" xref="Sx3.SSx6.p1.5.m1.1.1.2">𝛾</ci><ci id="Sx3.SSx6.p1.5.m1.1.1.3.cmml" xref="Sx3.SSx6.p1.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.5.m1.1c">\gamma_{i}</annotation></semantics></math> is the <math id="Sx3.SSx6.p1.6.m2.1" class="ltx_Math" alttext="i_{th}" display="inline"><semantics id="Sx3.SSx6.p1.6.m2.1a"><msub id="Sx3.SSx6.p1.6.m2.1.1" xref="Sx3.SSx6.p1.6.m2.1.1.cmml"><mi id="Sx3.SSx6.p1.6.m2.1.1.2" xref="Sx3.SSx6.p1.6.m2.1.1.2.cmml">i</mi><mrow id="Sx3.SSx6.p1.6.m2.1.1.3" xref="Sx3.SSx6.p1.6.m2.1.1.3.cmml"><mi id="Sx3.SSx6.p1.6.m2.1.1.3.2" xref="Sx3.SSx6.p1.6.m2.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.SSx6.p1.6.m2.1.1.3.1" xref="Sx3.SSx6.p1.6.m2.1.1.3.1.cmml">​</mo><mi id="Sx3.SSx6.p1.6.m2.1.1.3.3" xref="Sx3.SSx6.p1.6.m2.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.6.m2.1b"><apply id="Sx3.SSx6.p1.6.m2.1.1.cmml" xref="Sx3.SSx6.p1.6.m2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.6.m2.1.1.1.cmml" xref="Sx3.SSx6.p1.6.m2.1.1">subscript</csymbol><ci id="Sx3.SSx6.p1.6.m2.1.1.2.cmml" xref="Sx3.SSx6.p1.6.m2.1.1.2">𝑖</ci><apply id="Sx3.SSx6.p1.6.m2.1.1.3.cmml" xref="Sx3.SSx6.p1.6.m2.1.1.3"><times id="Sx3.SSx6.p1.6.m2.1.1.3.1.cmml" xref="Sx3.SSx6.p1.6.m2.1.1.3.1"></times><ci id="Sx3.SSx6.p1.6.m2.1.1.3.2.cmml" xref="Sx3.SSx6.p1.6.m2.1.1.3.2">𝑡</ci><ci id="Sx3.SSx6.p1.6.m2.1.1.3.3.cmml" xref="Sx3.SSx6.p1.6.m2.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.6.m2.1c">i_{th}</annotation></semantics></math> site’s imbalanced ratio and <math id="Sx3.SSx6.p1.7.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="Sx3.SSx6.p1.7.m3.1a"><mi id="Sx3.SSx6.p1.7.m3.1.1" xref="Sx3.SSx6.p1.7.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.7.m3.1b"><ci id="Sx3.SSx6.p1.7.m3.1.1.cmml" xref="Sx3.SSx6.p1.7.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.7.m3.1c">K</annotation></semantics></math> is the total optimization steps.
The loss function can be formulated as:</p>
<table id="A5.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E13.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{cls}" display="inline"><semantics id="Sx3.E13.m1.1a"><msub id="Sx3.E13.m1.1.1" xref="Sx3.E13.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E13.m1.1.1.2" xref="Sx3.E13.m1.1.1.2.cmml">ℒ</mi><mrow id="Sx3.E13.m1.1.1.3" xref="Sx3.E13.m1.1.1.3.cmml"><mi id="Sx3.E13.m1.1.1.3.2" xref="Sx3.E13.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E13.m1.1.1.3.1" xref="Sx3.E13.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.E13.m1.1.1.3.3" xref="Sx3.E13.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E13.m1.1.1.3.1a" xref="Sx3.E13.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.E13.m1.1.1.3.4" xref="Sx3.E13.m1.1.1.3.4.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.E13.m1.1b"><apply id="Sx3.E13.m1.1.1.cmml" xref="Sx3.E13.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E13.m1.1.1.1.cmml" xref="Sx3.E13.m1.1.1">subscript</csymbol><ci id="Sx3.E13.m1.1.1.2.cmml" xref="Sx3.E13.m1.1.1.2">ℒ</ci><apply id="Sx3.E13.m1.1.1.3.cmml" xref="Sx3.E13.m1.1.1.3"><times id="Sx3.E13.m1.1.1.3.1.cmml" xref="Sx3.E13.m1.1.1.3.1"></times><ci id="Sx3.E13.m1.1.1.3.2.cmml" xref="Sx3.E13.m1.1.1.3.2">𝑐</ci><ci id="Sx3.E13.m1.1.1.3.3.cmml" xref="Sx3.E13.m1.1.1.3.3">𝑙</ci><ci id="Sx3.E13.m1.1.1.3.4.cmml" xref="Sx3.E13.m1.1.1.3.4">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E13.m1.1c">\displaystyle\mathcal{L}_{cls}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E13.m2.2" class="ltx_Math" alttext="\displaystyle=M\cdot\ell(f_{c}(F_{h}),y)" display="inline"><semantics id="Sx3.E13.m2.2a"><mrow id="Sx3.E13.m2.2.2" xref="Sx3.E13.m2.2.2.cmml"><mi id="Sx3.E13.m2.2.2.3" xref="Sx3.E13.m2.2.2.3.cmml"></mi><mo id="Sx3.E13.m2.2.2.2" xref="Sx3.E13.m2.2.2.2.cmml">=</mo><mrow id="Sx3.E13.m2.2.2.1" xref="Sx3.E13.m2.2.2.1.cmml"><mrow id="Sx3.E13.m2.2.2.1.3" xref="Sx3.E13.m2.2.2.1.3.cmml"><mi id="Sx3.E13.m2.2.2.1.3.2" xref="Sx3.E13.m2.2.2.1.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="Sx3.E13.m2.2.2.1.3.1" xref="Sx3.E13.m2.2.2.1.3.1.cmml">⋅</mo><mi mathvariant="normal" id="Sx3.E13.m2.2.2.1.3.3" xref="Sx3.E13.m2.2.2.1.3.3.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="Sx3.E13.m2.2.2.1.2" xref="Sx3.E13.m2.2.2.1.2.cmml">​</mo><mrow id="Sx3.E13.m2.2.2.1.1.1" xref="Sx3.E13.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="Sx3.E13.m2.2.2.1.1.1.2" xref="Sx3.E13.m2.2.2.1.1.2.cmml">(</mo><mrow id="Sx3.E13.m2.2.2.1.1.1.1" xref="Sx3.E13.m2.2.2.1.1.1.1.cmml"><msub id="Sx3.E13.m2.2.2.1.1.1.1.3" xref="Sx3.E13.m2.2.2.1.1.1.1.3.cmml"><mi id="Sx3.E13.m2.2.2.1.1.1.1.3.2" xref="Sx3.E13.m2.2.2.1.1.1.1.3.2.cmml">f</mi><mi id="Sx3.E13.m2.2.2.1.1.1.1.3.3" xref="Sx3.E13.m2.2.2.1.1.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E13.m2.2.2.1.1.1.1.2" xref="Sx3.E13.m2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E13.m2.2.2.1.1.1.1.1.1" xref="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E13.m2.2.2.1.1.1.1.1.1.2" xref="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="Sx3.E13.m2.2.2.1.1.1.1.1.1.1" xref="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.2" xref="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.2.cmml">F</mi><mi id="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.3" xref="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.3.cmml">h</mi></msub><mo stretchy="false" id="Sx3.E13.m2.2.2.1.1.1.1.1.1.3" xref="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="Sx3.E13.m2.2.2.1.1.1.3" xref="Sx3.E13.m2.2.2.1.1.2.cmml">,</mo><mi id="Sx3.E13.m2.1.1" xref="Sx3.E13.m2.1.1.cmml">y</mi><mo stretchy="false" id="Sx3.E13.m2.2.2.1.1.1.4" xref="Sx3.E13.m2.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E13.m2.2b"><apply id="Sx3.E13.m2.2.2.cmml" xref="Sx3.E13.m2.2.2"><eq id="Sx3.E13.m2.2.2.2.cmml" xref="Sx3.E13.m2.2.2.2"></eq><csymbol cd="latexml" id="Sx3.E13.m2.2.2.3.cmml" xref="Sx3.E13.m2.2.2.3">absent</csymbol><apply id="Sx3.E13.m2.2.2.1.cmml" xref="Sx3.E13.m2.2.2.1"><times id="Sx3.E13.m2.2.2.1.2.cmml" xref="Sx3.E13.m2.2.2.1.2"></times><apply id="Sx3.E13.m2.2.2.1.3.cmml" xref="Sx3.E13.m2.2.2.1.3"><ci id="Sx3.E13.m2.2.2.1.3.1.cmml" xref="Sx3.E13.m2.2.2.1.3.1">⋅</ci><ci id="Sx3.E13.m2.2.2.1.3.2.cmml" xref="Sx3.E13.m2.2.2.1.3.2">𝑀</ci><ci id="Sx3.E13.m2.2.2.1.3.3.cmml" xref="Sx3.E13.m2.2.2.1.3.3">ℓ</ci></apply><interval closure="open" id="Sx3.E13.m2.2.2.1.1.2.cmml" xref="Sx3.E13.m2.2.2.1.1.1"><apply id="Sx3.E13.m2.2.2.1.1.1.1.cmml" xref="Sx3.E13.m2.2.2.1.1.1.1"><times id="Sx3.E13.m2.2.2.1.1.1.1.2.cmml" xref="Sx3.E13.m2.2.2.1.1.1.1.2"></times><apply id="Sx3.E13.m2.2.2.1.1.1.1.3.cmml" xref="Sx3.E13.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E13.m2.2.2.1.1.1.1.3.1.cmml" xref="Sx3.E13.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E13.m2.2.2.1.1.1.1.3.2.cmml" xref="Sx3.E13.m2.2.2.1.1.1.1.3.2">𝑓</ci><ci id="Sx3.E13.m2.2.2.1.1.1.1.3.3.cmml" xref="Sx3.E13.m2.2.2.1.1.1.1.3.3">𝑐</ci></apply><apply id="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.cmml" xref="Sx3.E13.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E13.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.2">𝐹</ci><ci id="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E13.m2.2.2.1.1.1.1.1.1.1.3">ℎ</ci></apply></apply><ci id="Sx3.E13.m2.1.1.cmml" xref="Sx3.E13.m2.1.1">𝑦</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E13.m2.2c">\displaystyle=M\cdot\ell(f_{c}(F_{h}),y)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="Sx3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E14.m1.7" class="ltx_Math" alttext="\displaystyle=-\frac{1}{|\mathcal{P}_{i}|}[\sum_{i}^{|\mathcal{P}_{i}^{-}|}M_{i}(k)\log(p_{0}^{i})+\sum_{i}^{|\mathcal{P}_{i}^{+}|}\log(p_{1}^{i})]," display="inline"><semantics id="Sx3.E14.m1.7a"><mrow id="Sx3.E14.m1.7.7.1" xref="Sx3.E14.m1.7.7.1.1.cmml"><mrow id="Sx3.E14.m1.7.7.1.1" xref="Sx3.E14.m1.7.7.1.1.cmml"><mi id="Sx3.E14.m1.7.7.1.1.3" xref="Sx3.E14.m1.7.7.1.1.3.cmml"></mi><mo id="Sx3.E14.m1.7.7.1.1.2" xref="Sx3.E14.m1.7.7.1.1.2.cmml">=</mo><mrow id="Sx3.E14.m1.7.7.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.cmml"><mo id="Sx3.E14.m1.7.7.1.1.1a" xref="Sx3.E14.m1.7.7.1.1.1.cmml">−</mo><mrow id="Sx3.E14.m1.7.7.1.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.E14.m1.1.1" xref="Sx3.E14.m1.1.1.cmml"><mfrac id="Sx3.E14.m1.1.1a" xref="Sx3.E14.m1.1.1.cmml"><mn id="Sx3.E14.m1.1.1.3" xref="Sx3.E14.m1.1.1.3.cmml">1</mn><mrow id="Sx3.E14.m1.1.1.1.1" xref="Sx3.E14.m1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E14.m1.1.1.1.1.2" xref="Sx3.E14.m1.1.1.1.2.1.cmml">|</mo><msub id="Sx3.E14.m1.1.1.1.1.1" xref="Sx3.E14.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E14.m1.1.1.1.1.1.2" xref="Sx3.E14.m1.1.1.1.1.1.2.cmml">𝒫</mi><mi id="Sx3.E14.m1.1.1.1.1.1.3" xref="Sx3.E14.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="Sx3.E14.m1.1.1.1.1.3" xref="Sx3.E14.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="Sx3.E14.m1.7.7.1.1.1.1.2" xref="Sx3.E14.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E14.m1.7.7.1.1.1.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.2.1.cmml">[</mo><mrow id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.cmml"><mrow id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><munderover id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2a" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.2.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mi id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.2.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="Sx3.E14.m1.2.2.1.1" xref="Sx3.E14.m1.2.2.1.2.cmml"><mo stretchy="false" id="Sx3.E14.m1.2.2.1.1.2" xref="Sx3.E14.m1.2.2.1.2.1.cmml">|</mo><msubsup id="Sx3.E14.m1.2.2.1.1.1" xref="Sx3.E14.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E14.m1.2.2.1.1.1.2.2" xref="Sx3.E14.m1.2.2.1.1.1.2.2.cmml">𝒫</mi><mi id="Sx3.E14.m1.2.2.1.1.1.2.3" xref="Sx3.E14.m1.2.2.1.1.1.2.3.cmml">i</mi><mo id="Sx3.E14.m1.2.2.1.1.1.3" xref="Sx3.E14.m1.2.2.1.1.1.3.cmml">−</mo></msubsup><mo stretchy="false" id="Sx3.E14.m1.2.2.1.1.3" xref="Sx3.E14.m1.2.2.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><msub id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.cmml">M</mi><mi id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.4.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.4.2.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="Sx3.E14.m1.4.4" xref="Sx3.E14.m1.4.4.cmml">k</mi><mo stretchy="false" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.4.2.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.2a" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="Sx3.E14.m1.5.5" xref="Sx3.E14.m1.5.5.cmml">log</mi><mo id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1a" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><msubsup id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">p</mi><mn id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">0</mn><mi id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.cmml"><munderover id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2a" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.cmml"><mo movablelimits="false" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.2.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.2.2.cmml">∑</mo><mi id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.2.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi><mrow id="Sx3.E14.m1.3.3.1.1" xref="Sx3.E14.m1.3.3.1.2.cmml"><mo stretchy="false" id="Sx3.E14.m1.3.3.1.1.2" xref="Sx3.E14.m1.3.3.1.2.1.cmml">|</mo><msubsup id="Sx3.E14.m1.3.3.1.1.1" xref="Sx3.E14.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E14.m1.3.3.1.1.1.2.2" xref="Sx3.E14.m1.3.3.1.1.1.2.2.cmml">𝒫</mi><mi id="Sx3.E14.m1.3.3.1.1.1.2.3" xref="Sx3.E14.m1.3.3.1.1.1.2.3.cmml">i</mi><mo id="Sx3.E14.m1.3.3.1.1.1.3" xref="Sx3.E14.m1.3.3.1.1.1.3.cmml">+</mo></msubsup><mo stretchy="false" id="Sx3.E14.m1.3.3.1.1.3" xref="Sx3.E14.m1.3.3.1.2.1.cmml">|</mo></mrow></munderover></mstyle><mrow id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.2.cmml"><mi id="Sx3.E14.m1.6.6" xref="Sx3.E14.m1.6.6.cmml">log</mi><mo id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1a" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.2.cmml">⁡</mo><mrow id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.2.cmml"><mo stretchy="false" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.2.cmml">(</mo><msubsup id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.2.2" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml">p</mi><mn id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.2.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml">1</mn><mi id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.3" xref="Sx3.E14.m1.7.7.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="Sx3.E14.m1.7.7.1.2" xref="Sx3.E14.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E14.m1.7b"><apply id="Sx3.E14.m1.7.7.1.1.cmml" xref="Sx3.E14.m1.7.7.1"><eq id="Sx3.E14.m1.7.7.1.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.2"></eq><csymbol cd="latexml" id="Sx3.E14.m1.7.7.1.1.3.cmml" xref="Sx3.E14.m1.7.7.1.1.3">absent</csymbol><apply id="Sx3.E14.m1.7.7.1.1.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1"><minus id="Sx3.E14.m1.7.7.1.1.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1"></minus><apply id="Sx3.E14.m1.7.7.1.1.1.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1"><times id="Sx3.E14.m1.7.7.1.1.1.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.2"></times><apply id="Sx3.E14.m1.1.1.cmml" xref="Sx3.E14.m1.1.1"><divide id="Sx3.E14.m1.1.1.2.cmml" xref="Sx3.E14.m1.1.1"></divide><cn type="integer" id="Sx3.E14.m1.1.1.3.cmml" xref="Sx3.E14.m1.1.1.3">1</cn><apply id="Sx3.E14.m1.1.1.1.2.cmml" xref="Sx3.E14.m1.1.1.1.1"><abs id="Sx3.E14.m1.1.1.1.2.1.cmml" xref="Sx3.E14.m1.1.1.1.1.2"></abs><apply id="Sx3.E14.m1.1.1.1.1.1.cmml" xref="Sx3.E14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E14.m1.1.1.1.1.1.1.cmml" xref="Sx3.E14.m1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E14.m1.1.1.1.1.1.2.cmml" xref="Sx3.E14.m1.1.1.1.1.1.2">𝒫</ci><ci id="Sx3.E14.m1.1.1.1.1.1.3.cmml" xref="Sx3.E14.m1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1"><csymbol cd="latexml" id="Sx3.E14.m1.7.7.1.1.1.1.1.2.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1"><plus id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.3"></plus><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1"><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.2.2"></sum><ci id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="Sx3.E14.m1.2.2.1.2.cmml" xref="Sx3.E14.m1.2.2.1.1"><abs id="Sx3.E14.m1.2.2.1.2.1.cmml" xref="Sx3.E14.m1.2.2.1.1.2"></abs><apply id="Sx3.E14.m1.2.2.1.1.1.cmml" xref="Sx3.E14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E14.m1.2.2.1.1.1.1.cmml" xref="Sx3.E14.m1.2.2.1.1.1">superscript</csymbol><apply id="Sx3.E14.m1.2.2.1.1.1.2.cmml" xref="Sx3.E14.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="Sx3.E14.m1.2.2.1.1.1.2.1.cmml" xref="Sx3.E14.m1.2.2.1.1.1">subscript</csymbol><ci id="Sx3.E14.m1.2.2.1.1.1.2.2.cmml" xref="Sx3.E14.m1.2.2.1.1.1.2.2">𝒫</ci><ci id="Sx3.E14.m1.2.2.1.1.1.2.3.cmml" xref="Sx3.E14.m1.2.2.1.1.1.2.3">𝑖</ci></apply><minus id="Sx3.E14.m1.2.2.1.1.1.3.cmml" xref="Sx3.E14.m1.2.2.1.1.1.3"></minus></apply></apply></apply><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1"><times id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.2"></times><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.2">𝑀</ci><ci id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><ci id="Sx3.E14.m1.4.4.cmml" xref="Sx3.E14.m1.4.4">𝑘</ci><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"><log id="Sx3.E14.m1.5.5.cmml" xref="Sx3.E14.m1.5.5"></log><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑝</ci><cn type="integer" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2"><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2">subscript</csymbol><sum id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.2.2"></sum><ci id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="Sx3.E14.m1.3.3.1.2.cmml" xref="Sx3.E14.m1.3.3.1.1"><abs id="Sx3.E14.m1.3.3.1.2.1.cmml" xref="Sx3.E14.m1.3.3.1.1.2"></abs><apply id="Sx3.E14.m1.3.3.1.1.1.cmml" xref="Sx3.E14.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx3.E14.m1.3.3.1.1.1.1.cmml" xref="Sx3.E14.m1.3.3.1.1.1">superscript</csymbol><apply id="Sx3.E14.m1.3.3.1.1.1.2.cmml" xref="Sx3.E14.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="Sx3.E14.m1.3.3.1.1.1.2.1.cmml" xref="Sx3.E14.m1.3.3.1.1.1">subscript</csymbol><ci id="Sx3.E14.m1.3.3.1.1.1.2.2.cmml" xref="Sx3.E14.m1.3.3.1.1.1.2.2">𝒫</ci><ci id="Sx3.E14.m1.3.3.1.1.1.2.3.cmml" xref="Sx3.E14.m1.3.3.1.1.1.2.3">𝑖</ci></apply><plus id="Sx3.E14.m1.3.3.1.1.1.3.cmml" xref="Sx3.E14.m1.3.3.1.1.1.3"></plus></apply></apply></apply><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1"><log id="Sx3.E14.m1.6.6.cmml" xref="Sx3.E14.m1.6.6"></log><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1">superscript</csymbol><apply id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.2.2">𝑝</ci><cn type="integer" id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.2.3">1</cn></apply><ci id="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="Sx3.E14.m1.7.7.1.1.1.1.1.1.1.2.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E14.m1.7c">\displaystyle=-\frac{1}{|\mathcal{P}_{i}|}[\sum_{i}^{|\mathcal{P}_{i}^{-}|}M_{i}(k)\log(p_{0}^{i})+\sum_{i}^{|\mathcal{P}_{i}^{+}|}\log(p_{1}^{i})],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx6.p1.8" class="ltx_p">where <math id="Sx3.SSx6.p1.8.m1.2" class="ltx_Math" alttext="|P_{i}^{-}|,|P_{i}^{+}|" display="inline"><semantics id="Sx3.SSx6.p1.8.m1.2a"><mrow id="Sx3.SSx6.p1.8.m1.2.2.2" xref="Sx3.SSx6.p1.8.m1.2.2.3.cmml"><mrow id="Sx3.SSx6.p1.8.m1.1.1.1.1.1" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.2" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.2.1.cmml">|</mo><msubsup id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.cmml"><mi id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.2.2" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.2.2.cmml">P</mi><mi id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.2.3" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mo id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.3" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.3.cmml">−</mo></msubsup><mo stretchy="false" id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.3" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="Sx3.SSx6.p1.8.m1.2.2.2.3" xref="Sx3.SSx6.p1.8.m1.2.2.3.cmml">,</mo><mrow id="Sx3.SSx6.p1.8.m1.2.2.2.2.1" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.2" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.2.1.cmml">|</mo><msubsup id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.cmml"><mi id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.2.2" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.2.2.cmml">P</mi><mi id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.2.3" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.2.3.cmml">i</mi><mo id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.3" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.3.cmml">+</mo></msubsup><mo stretchy="false" id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.3" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p1.8.m1.2b"><list id="Sx3.SSx6.p1.8.m1.2.2.3.cmml" xref="Sx3.SSx6.p1.8.m1.2.2.2"><apply id="Sx3.SSx6.p1.8.m1.1.1.1.1.2.cmml" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1"><abs id="Sx3.SSx6.p1.8.m1.1.1.1.1.2.1.cmml" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.2"></abs><apply id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.cmml" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.1.cmml" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1">superscript</csymbol><apply id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.2.cmml" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.2.1.cmml" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1">subscript</csymbol><ci id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.2.2.cmml" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.2.2">𝑃</ci><ci id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.2.3.cmml" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><minus id="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.3.cmml" xref="Sx3.SSx6.p1.8.m1.1.1.1.1.1.1.3"></minus></apply></apply><apply id="Sx3.SSx6.p1.8.m1.2.2.2.2.2.cmml" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1"><abs id="Sx3.SSx6.p1.8.m1.2.2.2.2.2.1.cmml" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.2"></abs><apply id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.cmml" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.1.cmml" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1">superscript</csymbol><apply id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.2.cmml" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.2.1.cmml" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1">subscript</csymbol><ci id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.2.2.cmml" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.2.2">𝑃</ci><ci id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.2.3.cmml" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.2.3">𝑖</ci></apply><plus id="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.3.cmml" xref="Sx3.SSx6.p1.8.m1.2.2.2.2.1.1.3"></plus></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p1.8.m1.2c">|P_{i}^{-}|,|P_{i}^{+}|</annotation></semantics></math> represent the number of HER2- and HER2+ WSIs.</p>
</div>
<div id="Sx3.SSx6.p2" class="ltx_para">
<p id="Sx3.SSx6.p2.5" class="ltx_p">In every iteration <math id="Sx3.SSx6.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="Sx3.SSx6.p2.1.m1.1a"><mi id="Sx3.SSx6.p2.1.m1.1.1" xref="Sx3.SSx6.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p2.1.m1.1b"><ci id="Sx3.SSx6.p2.1.m1.1.1.cmml" xref="Sx3.SSx6.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p2.1.m1.1c">k</annotation></semantics></math>, we note <math id="Sx3.SSx6.p2.2.m2.1" class="ltx_Math" alttext="b_{i}^{k}\gamma_{i}" display="inline"><semantics id="Sx3.SSx6.p2.2.m2.1a"><mrow id="Sx3.SSx6.p2.2.m2.1.1" xref="Sx3.SSx6.p2.2.m2.1.1.cmml"><msubsup id="Sx3.SSx6.p2.2.m2.1.1.2" xref="Sx3.SSx6.p2.2.m2.1.1.2.cmml"><mi id="Sx3.SSx6.p2.2.m2.1.1.2.2.2" xref="Sx3.SSx6.p2.2.m2.1.1.2.2.2.cmml">b</mi><mi id="Sx3.SSx6.p2.2.m2.1.1.2.2.3" xref="Sx3.SSx6.p2.2.m2.1.1.2.2.3.cmml">i</mi><mi id="Sx3.SSx6.p2.2.m2.1.1.2.3" xref="Sx3.SSx6.p2.2.m2.1.1.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.SSx6.p2.2.m2.1.1.1" xref="Sx3.SSx6.p2.2.m2.1.1.1.cmml">​</mo><msub id="Sx3.SSx6.p2.2.m2.1.1.3" xref="Sx3.SSx6.p2.2.m2.1.1.3.cmml"><mi id="Sx3.SSx6.p2.2.m2.1.1.3.2" xref="Sx3.SSx6.p2.2.m2.1.1.3.2.cmml">γ</mi><mi id="Sx3.SSx6.p2.2.m2.1.1.3.3" xref="Sx3.SSx6.p2.2.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p2.2.m2.1b"><apply id="Sx3.SSx6.p2.2.m2.1.1.cmml" xref="Sx3.SSx6.p2.2.m2.1.1"><times id="Sx3.SSx6.p2.2.m2.1.1.1.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.1"></times><apply id="Sx3.SSx6.p2.2.m2.1.1.2.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx6.p2.2.m2.1.1.2.1.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.2">superscript</csymbol><apply id="Sx3.SSx6.p2.2.m2.1.1.2.2.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="Sx3.SSx6.p2.2.m2.1.1.2.2.1.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.2">subscript</csymbol><ci id="Sx3.SSx6.p2.2.m2.1.1.2.2.2.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.2.2.2">𝑏</ci><ci id="Sx3.SSx6.p2.2.m2.1.1.2.2.3.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx6.p2.2.m2.1.1.2.3.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.2.3">𝑘</ci></apply><apply id="Sx3.SSx6.p2.2.m2.1.1.3.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="Sx3.SSx6.p2.2.m2.1.1.3.1.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.3">subscript</csymbol><ci id="Sx3.SSx6.p2.2.m2.1.1.3.2.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.3.2">𝛾</ci><ci id="Sx3.SSx6.p2.2.m2.1.1.3.3.cmml" xref="Sx3.SSx6.p2.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p2.2.m2.1c">b_{i}^{k}\gamma_{i}</annotation></semantics></math> as the imbalance ratio involved in loss computation. Figure <a href="#Sx3.F4" title="Figure 4 ‣ Point Classifier Block ‣ Methodology ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows that at iteration <math id="Sx3.SSx6.p2.3.m3.1" class="ltx_Math" alttext="k=0" display="inline"><semantics id="Sx3.SSx6.p2.3.m3.1a"><mrow id="Sx3.SSx6.p2.3.m3.1.1" xref="Sx3.SSx6.p2.3.m3.1.1.cmml"><mi id="Sx3.SSx6.p2.3.m3.1.1.2" xref="Sx3.SSx6.p2.3.m3.1.1.2.cmml">k</mi><mo id="Sx3.SSx6.p2.3.m3.1.1.1" xref="Sx3.SSx6.p2.3.m3.1.1.1.cmml">=</mo><mn id="Sx3.SSx6.p2.3.m3.1.1.3" xref="Sx3.SSx6.p2.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p2.3.m3.1b"><apply id="Sx3.SSx6.p2.3.m3.1.1.cmml" xref="Sx3.SSx6.p2.3.m3.1.1"><eq id="Sx3.SSx6.p2.3.m3.1.1.1.cmml" xref="Sx3.SSx6.p2.3.m3.1.1.1"></eq><ci id="Sx3.SSx6.p2.3.m3.1.1.2.cmml" xref="Sx3.SSx6.p2.3.m3.1.1.2">𝑘</ci><cn type="integer" id="Sx3.SSx6.p2.3.m3.1.1.3.cmml" xref="Sx3.SSx6.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p2.3.m3.1c">k=0</annotation></semantics></math>, all sites have <math id="Sx3.SSx6.p2.4.m4.1" class="ltx_Math" alttext="b_{i}^{k}\gamma_{i}=1" display="inline"><semantics id="Sx3.SSx6.p2.4.m4.1a"><mrow id="Sx3.SSx6.p2.4.m4.1.1" xref="Sx3.SSx6.p2.4.m4.1.1.cmml"><mrow id="Sx3.SSx6.p2.4.m4.1.1.2" xref="Sx3.SSx6.p2.4.m4.1.1.2.cmml"><msubsup id="Sx3.SSx6.p2.4.m4.1.1.2.2" xref="Sx3.SSx6.p2.4.m4.1.1.2.2.cmml"><mi id="Sx3.SSx6.p2.4.m4.1.1.2.2.2.2" xref="Sx3.SSx6.p2.4.m4.1.1.2.2.2.2.cmml">b</mi><mi id="Sx3.SSx6.p2.4.m4.1.1.2.2.2.3" xref="Sx3.SSx6.p2.4.m4.1.1.2.2.2.3.cmml">i</mi><mi id="Sx3.SSx6.p2.4.m4.1.1.2.2.3" xref="Sx3.SSx6.p2.4.m4.1.1.2.2.3.cmml">k</mi></msubsup><mo lspace="0em" rspace="0em" id="Sx3.SSx6.p2.4.m4.1.1.2.1" xref="Sx3.SSx6.p2.4.m4.1.1.2.1.cmml">​</mo><msub id="Sx3.SSx6.p2.4.m4.1.1.2.3" xref="Sx3.SSx6.p2.4.m4.1.1.2.3.cmml"><mi id="Sx3.SSx6.p2.4.m4.1.1.2.3.2" xref="Sx3.SSx6.p2.4.m4.1.1.2.3.2.cmml">γ</mi><mi id="Sx3.SSx6.p2.4.m4.1.1.2.3.3" xref="Sx3.SSx6.p2.4.m4.1.1.2.3.3.cmml">i</mi></msub></mrow><mo id="Sx3.SSx6.p2.4.m4.1.1.1" xref="Sx3.SSx6.p2.4.m4.1.1.1.cmml">=</mo><mn id="Sx3.SSx6.p2.4.m4.1.1.3" xref="Sx3.SSx6.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p2.4.m4.1b"><apply id="Sx3.SSx6.p2.4.m4.1.1.cmml" xref="Sx3.SSx6.p2.4.m4.1.1"><eq id="Sx3.SSx6.p2.4.m4.1.1.1.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.1"></eq><apply id="Sx3.SSx6.p2.4.m4.1.1.2.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2"><times id="Sx3.SSx6.p2.4.m4.1.1.2.1.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.1"></times><apply id="Sx3.SSx6.p2.4.m4.1.1.2.2.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx6.p2.4.m4.1.1.2.2.1.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.2">superscript</csymbol><apply id="Sx3.SSx6.p2.4.m4.1.1.2.2.2.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.2"><csymbol cd="ambiguous" id="Sx3.SSx6.p2.4.m4.1.1.2.2.2.1.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.2">subscript</csymbol><ci id="Sx3.SSx6.p2.4.m4.1.1.2.2.2.2.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.2.2.2">𝑏</ci><ci id="Sx3.SSx6.p2.4.m4.1.1.2.2.2.3.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.2.2.3">𝑖</ci></apply><ci id="Sx3.SSx6.p2.4.m4.1.1.2.2.3.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.2.3">𝑘</ci></apply><apply id="Sx3.SSx6.p2.4.m4.1.1.2.3.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.3"><csymbol cd="ambiguous" id="Sx3.SSx6.p2.4.m4.1.1.2.3.1.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.3">subscript</csymbol><ci id="Sx3.SSx6.p2.4.m4.1.1.2.3.2.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.3.2">𝛾</ci><ci id="Sx3.SSx6.p2.4.m4.1.1.2.3.3.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.2.3.3">𝑖</ci></apply></apply><cn type="integer" id="Sx3.SSx6.p2.4.m4.1.1.3.cmml" xref="Sx3.SSx6.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p2.4.m4.1c">b_{i}^{k}\gamma_{i}=1</annotation></semantics></math> indicating that they share the same label distribution with an equal ratio between HER2- and HER2+. As the training progresses, the distribution gradually shifts towards each site’s real distribution <math id="Sx3.SSx6.p2.5.m5.1" class="ltx_Math" alttext="\gamma_{i}" display="inline"><semantics id="Sx3.SSx6.p2.5.m5.1a"><msub id="Sx3.SSx6.p2.5.m5.1.1" xref="Sx3.SSx6.p2.5.m5.1.1.cmml"><mi id="Sx3.SSx6.p2.5.m5.1.1.2" xref="Sx3.SSx6.p2.5.m5.1.1.2.cmml">γ</mi><mi id="Sx3.SSx6.p2.5.m5.1.1.3" xref="Sx3.SSx6.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="Sx3.SSx6.p2.5.m5.1b"><apply id="Sx3.SSx6.p2.5.m5.1.1.cmml" xref="Sx3.SSx6.p2.5.m5.1.1"><csymbol cd="ambiguous" id="Sx3.SSx6.p2.5.m5.1.1.1.cmml" xref="Sx3.SSx6.p2.5.m5.1.1">subscript</csymbol><ci id="Sx3.SSx6.p2.5.m5.1.1.2.cmml" xref="Sx3.SSx6.p2.5.m5.1.1.2">𝛾</ci><ci id="Sx3.SSx6.p2.5.m5.1.1.3.cmml" xref="Sx3.SSx6.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.SSx6.p2.5.m5.1c">\gamma_{i}</annotation></semantics></math>. By this strategy, the models are initially trained within a similar distribution, leading to a well-initialized model for accurately predicting HER2 status.</p>
</div>
<div id="Sx3.SSx6.p3" class="ltx_para">
<p id="Sx3.SSx6.p3.1" class="ltx_p">The above subsampling may arise a potential information loss problem, leading to insufficient feature representation. To address this concern, we add an auxiliary classifier that incorporates each site’s real label distribution:</p>
</div>
<div id="Sx3.SSx6.p4" class="ltx_para">
<table id="A5.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E15.m1.4" class="ltx_math_unparsed" alttext="\displaystyle\mathcal{L}_{aux}(p,y)=-\frac{1}{|\mathcal{P}_{i}|}[\sum_{i}^{|\mathcal{P}_{i}^{-}|}" display="inline"><semantics id="Sx3.E15.m1.4a"><mrow id="Sx3.E15.m1.4b"><msub id="Sx3.E15.m1.4.5"><mi class="ltx_font_mathcaligraphic" id="Sx3.E15.m1.4.5.2">ℒ</mi><mrow id="Sx3.E15.m1.4.5.3"><mi id="Sx3.E15.m1.4.5.3.2">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E15.m1.4.5.3.1">​</mo><mi id="Sx3.E15.m1.4.5.3.3">u</mi><mo lspace="0em" rspace="0em" id="Sx3.E15.m1.4.5.3.1a">​</mo><mi id="Sx3.E15.m1.4.5.3.4">x</mi></mrow></msub><mrow id="Sx3.E15.m1.4.6"><mo stretchy="false" id="Sx3.E15.m1.4.6.1">(</mo><mi id="Sx3.E15.m1.3.3">p</mi><mo id="Sx3.E15.m1.4.6.2">,</mo><mi id="Sx3.E15.m1.4.4">y</mi><mo stretchy="false" id="Sx3.E15.m1.4.6.3">)</mo></mrow><mo rspace="0em" id="Sx3.E15.m1.4.7">=</mo><mo lspace="0em" id="Sx3.E15.m1.4.8">−</mo><mstyle displaystyle="true" id="Sx3.E15.m1.1.1"><mfrac id="Sx3.E15.m1.1.1a"><mn id="Sx3.E15.m1.1.1.3">1</mn><mrow id="Sx3.E15.m1.1.1.1.1"><mo stretchy="false" id="Sx3.E15.m1.1.1.1.1.2">|</mo><msub id="Sx3.E15.m1.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="Sx3.E15.m1.1.1.1.1.1.2">𝒫</mi><mi id="Sx3.E15.m1.1.1.1.1.1.3">i</mi></msub><mo stretchy="false" id="Sx3.E15.m1.1.1.1.1.3">|</mo></mrow></mfrac></mstyle><mrow id="Sx3.E15.m1.4.9"><mo stretchy="false" id="Sx3.E15.m1.4.9.1">[</mo><mstyle displaystyle="true" id="Sx3.E15.m1.4.9.2"><munderover id="Sx3.E15.m1.4.9.2a"><mo movablelimits="false" id="Sx3.E15.m1.4.9.2.2.2">∑</mo><mi id="Sx3.E15.m1.4.9.2.2.3">i</mi><mrow id="Sx3.E15.m1.2.2.1.1"><mo stretchy="false" id="Sx3.E15.m1.2.2.1.1.2">|</mo><msubsup id="Sx3.E15.m1.2.2.1.1.1"><mi class="ltx_font_mathcaligraphic" id="Sx3.E15.m1.2.2.1.1.1.2.2">𝒫</mi><mi id="Sx3.E15.m1.2.2.1.1.1.2.3">i</mi><mo id="Sx3.E15.m1.2.2.1.1.1.3">−</mo></msubsup><mo stretchy="false" id="Sx3.E15.m1.2.2.1.1.3">|</mo></mrow></munderover></mstyle></mrow></mrow><annotation encoding="application/x-tex" id="Sx3.E15.m1.4c">\displaystyle\mathcal{L}_{aux}(p,y)=-\frac{1}{|\mathcal{P}_{i}|}[\sum_{i}^{|\mathcal{P}_{i}^{-}|}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E15.m2.3" class="ltx_math_unparsed" alttext="\displaystyle\log(p_{0}^{i})+\sum_{i}^{|\mathcal{P}_{i}^{+}|}\log(p_{1}^{i})]," display="inline"><semantics id="Sx3.E15.m2.3a"><mrow id="Sx3.E15.m2.3b"><mi id="Sx3.E15.m2.2.2">log</mi><mrow id="Sx3.E15.m2.3.4"><mo stretchy="false" id="Sx3.E15.m2.3.4.1">(</mo><msubsup id="Sx3.E15.m2.3.4.2"><mi id="Sx3.E15.m2.3.4.2.2.2">p</mi><mn id="Sx3.E15.m2.3.4.2.2.3">0</mn><mi id="Sx3.E15.m2.3.4.2.3">i</mi></msubsup><mo stretchy="false" id="Sx3.E15.m2.3.4.3">)</mo></mrow><mo id="Sx3.E15.m2.3.5">+</mo><mstyle displaystyle="true" id="Sx3.E15.m2.3.6"><munderover id="Sx3.E15.m2.3.6a"><mo movablelimits="false" id="Sx3.E15.m2.3.6.2.2">∑</mo><mi id="Sx3.E15.m2.3.6.2.3">i</mi><mrow id="Sx3.E15.m2.1.1.1.1"><mo stretchy="false" id="Sx3.E15.m2.1.1.1.1.2">|</mo><msubsup id="Sx3.E15.m2.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="Sx3.E15.m2.1.1.1.1.1.2.2">𝒫</mi><mi id="Sx3.E15.m2.1.1.1.1.1.2.3">i</mi><mo id="Sx3.E15.m2.1.1.1.1.1.3">+</mo></msubsup><mo stretchy="false" id="Sx3.E15.m2.1.1.1.1.3">|</mo></mrow></munderover></mstyle><mi id="Sx3.E15.m2.3.3">log</mi><mrow id="Sx3.E15.m2.3.7"><mo stretchy="false" id="Sx3.E15.m2.3.7.1">(</mo><msubsup id="Sx3.E15.m2.3.7.2"><mi id="Sx3.E15.m2.3.7.2.2.2">p</mi><mn id="Sx3.E15.m2.3.7.2.2.3">1</mn><mi id="Sx3.E15.m2.3.7.2.3">i</mi></msubsup><mo stretchy="false" id="Sx3.E15.m2.3.7.3">)</mo></mrow><mo stretchy="false" id="Sx3.E15.m2.3.8">]</mo><mo id="Sx3.E15.m2.3.9">,</mo></mrow><annotation encoding="application/x-tex" id="Sx3.E15.m2.3c">\displaystyle\log(p_{0}^{i})+\sum_{i}^{|\mathcal{P}_{i}^{+}|}\log(p_{1}^{i})],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<table id="A5.EGx14" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Sx3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Sx3.E16.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{total}" display="inline"><semantics id="Sx3.E16.m1.1a"><msub id="Sx3.E16.m1.1.1" xref="Sx3.E16.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E16.m1.1.1.2" xref="Sx3.E16.m1.1.1.2.cmml">ℒ</mi><mrow id="Sx3.E16.m1.1.1.3" xref="Sx3.E16.m1.1.1.3.cmml"><mi id="Sx3.E16.m1.1.1.3.2" xref="Sx3.E16.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E16.m1.1.1.3.1" xref="Sx3.E16.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.E16.m1.1.1.3.3" xref="Sx3.E16.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="Sx3.E16.m1.1.1.3.1a" xref="Sx3.E16.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.E16.m1.1.1.3.4" xref="Sx3.E16.m1.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="Sx3.E16.m1.1.1.3.1b" xref="Sx3.E16.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.E16.m1.1.1.3.5" xref="Sx3.E16.m1.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E16.m1.1.1.3.1c" xref="Sx3.E16.m1.1.1.3.1.cmml">​</mo><mi id="Sx3.E16.m1.1.1.3.6" xref="Sx3.E16.m1.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="Sx3.E16.m1.1b"><apply id="Sx3.E16.m1.1.1.cmml" xref="Sx3.E16.m1.1.1"><csymbol cd="ambiguous" id="Sx3.E16.m1.1.1.1.cmml" xref="Sx3.E16.m1.1.1">subscript</csymbol><ci id="Sx3.E16.m1.1.1.2.cmml" xref="Sx3.E16.m1.1.1.2">ℒ</ci><apply id="Sx3.E16.m1.1.1.3.cmml" xref="Sx3.E16.m1.1.1.3"><times id="Sx3.E16.m1.1.1.3.1.cmml" xref="Sx3.E16.m1.1.1.3.1"></times><ci id="Sx3.E16.m1.1.1.3.2.cmml" xref="Sx3.E16.m1.1.1.3.2">𝑡</ci><ci id="Sx3.E16.m1.1.1.3.3.cmml" xref="Sx3.E16.m1.1.1.3.3">𝑜</ci><ci id="Sx3.E16.m1.1.1.3.4.cmml" xref="Sx3.E16.m1.1.1.3.4">𝑡</ci><ci id="Sx3.E16.m1.1.1.3.5.cmml" xref="Sx3.E16.m1.1.1.3.5">𝑎</ci><ci id="Sx3.E16.m1.1.1.3.6.cmml" xref="Sx3.E16.m1.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E16.m1.1c">\displaystyle\mathcal{L}_{total}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Sx3.E16.m2.1" class="ltx_Math" alttext="\displaystyle=\mathcal{L}_{cls}+\mathcal{L}_{aux}." display="inline"><semantics id="Sx3.E16.m2.1a"><mrow id="Sx3.E16.m2.1.1.1" xref="Sx3.E16.m2.1.1.1.1.cmml"><mrow id="Sx3.E16.m2.1.1.1.1" xref="Sx3.E16.m2.1.1.1.1.cmml"><mi id="Sx3.E16.m2.1.1.1.1.2" xref="Sx3.E16.m2.1.1.1.1.2.cmml"></mi><mo id="Sx3.E16.m2.1.1.1.1.1" xref="Sx3.E16.m2.1.1.1.1.1.cmml">=</mo><mrow id="Sx3.E16.m2.1.1.1.1.3" xref="Sx3.E16.m2.1.1.1.1.3.cmml"><msub id="Sx3.E16.m2.1.1.1.1.3.2" xref="Sx3.E16.m2.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E16.m2.1.1.1.1.3.2.2" xref="Sx3.E16.m2.1.1.1.1.3.2.2.cmml">ℒ</mi><mrow id="Sx3.E16.m2.1.1.1.1.3.2.3" xref="Sx3.E16.m2.1.1.1.1.3.2.3.cmml"><mi id="Sx3.E16.m2.1.1.1.1.3.2.3.2" xref="Sx3.E16.m2.1.1.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="Sx3.E16.m2.1.1.1.1.3.2.3.1" xref="Sx3.E16.m2.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E16.m2.1.1.1.1.3.2.3.3" xref="Sx3.E16.m2.1.1.1.1.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="Sx3.E16.m2.1.1.1.1.3.2.3.1a" xref="Sx3.E16.m2.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="Sx3.E16.m2.1.1.1.1.3.2.3.4" xref="Sx3.E16.m2.1.1.1.1.3.2.3.4.cmml">s</mi></mrow></msub><mo id="Sx3.E16.m2.1.1.1.1.3.1" xref="Sx3.E16.m2.1.1.1.1.3.1.cmml">+</mo><msub id="Sx3.E16.m2.1.1.1.1.3.3" xref="Sx3.E16.m2.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx3.E16.m2.1.1.1.1.3.3.2" xref="Sx3.E16.m2.1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="Sx3.E16.m2.1.1.1.1.3.3.3" xref="Sx3.E16.m2.1.1.1.1.3.3.3.cmml"><mi id="Sx3.E16.m2.1.1.1.1.3.3.3.2" xref="Sx3.E16.m2.1.1.1.1.3.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="Sx3.E16.m2.1.1.1.1.3.3.3.1" xref="Sx3.E16.m2.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="Sx3.E16.m2.1.1.1.1.3.3.3.3" xref="Sx3.E16.m2.1.1.1.1.3.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="Sx3.E16.m2.1.1.1.1.3.3.3.1a" xref="Sx3.E16.m2.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="Sx3.E16.m2.1.1.1.1.3.3.3.4" xref="Sx3.E16.m2.1.1.1.1.3.3.3.4.cmml">x</mi></mrow></msub></mrow></mrow><mo lspace="0em" id="Sx3.E16.m2.1.1.1.2" xref="Sx3.E16.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="Sx3.E16.m2.1b"><apply id="Sx3.E16.m2.1.1.1.1.cmml" xref="Sx3.E16.m2.1.1.1"><eq id="Sx3.E16.m2.1.1.1.1.1.cmml" xref="Sx3.E16.m2.1.1.1.1.1"></eq><csymbol cd="latexml" id="Sx3.E16.m2.1.1.1.1.2.cmml" xref="Sx3.E16.m2.1.1.1.1.2">absent</csymbol><apply id="Sx3.E16.m2.1.1.1.1.3.cmml" xref="Sx3.E16.m2.1.1.1.1.3"><plus id="Sx3.E16.m2.1.1.1.1.3.1.cmml" xref="Sx3.E16.m2.1.1.1.1.3.1"></plus><apply id="Sx3.E16.m2.1.1.1.1.3.2.cmml" xref="Sx3.E16.m2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="Sx3.E16.m2.1.1.1.1.3.2.1.cmml" xref="Sx3.E16.m2.1.1.1.1.3.2">subscript</csymbol><ci id="Sx3.E16.m2.1.1.1.1.3.2.2.cmml" xref="Sx3.E16.m2.1.1.1.1.3.2.2">ℒ</ci><apply id="Sx3.E16.m2.1.1.1.1.3.2.3.cmml" xref="Sx3.E16.m2.1.1.1.1.3.2.3"><times id="Sx3.E16.m2.1.1.1.1.3.2.3.1.cmml" xref="Sx3.E16.m2.1.1.1.1.3.2.3.1"></times><ci id="Sx3.E16.m2.1.1.1.1.3.2.3.2.cmml" xref="Sx3.E16.m2.1.1.1.1.3.2.3.2">𝑐</ci><ci id="Sx3.E16.m2.1.1.1.1.3.2.3.3.cmml" xref="Sx3.E16.m2.1.1.1.1.3.2.3.3">𝑙</ci><ci id="Sx3.E16.m2.1.1.1.1.3.2.3.4.cmml" xref="Sx3.E16.m2.1.1.1.1.3.2.3.4">𝑠</ci></apply></apply><apply id="Sx3.E16.m2.1.1.1.1.3.3.cmml" xref="Sx3.E16.m2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="Sx3.E16.m2.1.1.1.1.3.3.1.cmml" xref="Sx3.E16.m2.1.1.1.1.3.3">subscript</csymbol><ci id="Sx3.E16.m2.1.1.1.1.3.3.2.cmml" xref="Sx3.E16.m2.1.1.1.1.3.3.2">ℒ</ci><apply id="Sx3.E16.m2.1.1.1.1.3.3.3.cmml" xref="Sx3.E16.m2.1.1.1.1.3.3.3"><times id="Sx3.E16.m2.1.1.1.1.3.3.3.1.cmml" xref="Sx3.E16.m2.1.1.1.1.3.3.3.1"></times><ci id="Sx3.E16.m2.1.1.1.1.3.3.3.2.cmml" xref="Sx3.E16.m2.1.1.1.1.3.3.3.2">𝑎</ci><ci id="Sx3.E16.m2.1.1.1.1.3.3.3.3.cmml" xref="Sx3.E16.m2.1.1.1.1.3.3.3.3">𝑢</ci><ci id="Sx3.E16.m2.1.1.1.1.3.3.3.4.cmml" xref="Sx3.E16.m2.1.1.1.1.3.3.3.4">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx3.E16.m2.1c">\displaystyle=\mathcal{L}_{cls}+\mathcal{L}_{aux}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="Sx3.SSx6.p4.1" class="ltx_p">This auxiliary classifier does not involved in the weights synchronization with the server model during the training of federated learning. Instead, it serves to guarantee the quality of feature representation as previous studies have demonstrated that models trained on imbalanced data can still learn high-quality feature representations <cite class="ltx_cite ltx_citemacro_citep">(Kang et al. <a href="#bib.bib17" title="" class="ltx_ref">2020</a>; Lee, Shin, and Kim <a href="#bib.bib19" title="" class="ltx_ref">2021</a>)</cite>.
Detailed pseudo codes are shown in algorithm <a href="#alg2" title="Algorithm 2 ‣ Dataset and Experimental Settings ‣ Experiments ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
</section>
<section id="Sx4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Experiments</h2>

<section id="Sx4.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Dataset and Experimental Settings</h3>

<div id="Sx4.SSx1.p1" class="ltx_para">
<p id="Sx4.SSx1.p1.1" class="ltx_p">We evaluate our point transformer model for breast cancer HER2 status prediction using the largest WSI from six sites with a total of 2,916 WSIs. The sites are denoted as follows: Site A (TCGA-BRCA) <cite class="ltx_cite ltx_citemacro_citep">(Network <a href="#bib.bib31" title="" class="ltx_ref">2012</a>)</cite>, Sites B and C (internal hospitals with ethics committee approval), Site D <cite class="ltx_cite ltx_citemacro_citep">(Conde-Sousa et al. <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite>, and Sites E and F <cite class="ltx_cite ltx_citemacro_citep">(Farahmand et al. <a href="#bib.bib6" title="" class="ltx_ref">2022</a>; Qaiser et al. <a href="#bib.bib34" title="" class="ltx_ref">2017</a>)</cite>. Four sites participate in federated learning, while the remaining two sites serve as unseen data for external tests. Sites A, B, C, and D are split into training, validation, and test sets with a ratio of 6:1:3, as shown in Table <a href="#Sx4.T1" title="Table 1 ‣ Dataset and Experimental Settings ‣ Experiments ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The splits are repeated five times, and the best model is selected based on the validation set in each split. The mean area under the ROC curve (AUC) is reported for the test set.</p>
</div>
<div id="Sx4.SSx1.p2" class="ltx_para">
<p id="Sx4.SSx1.p2.1" class="ltx_p">We refer to the point transformer with FCS as PointTransformer+, the variant with DDA as PointTransformerDDA, and the combined variant as PointTransformerDDA+.</p>
</div>
<figure id="Sx4.T1" class="ltx_table">
<table id="Sx4.T1.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx4.T1.3.4.1" class="ltx_tr">
<td id="Sx4.T1.3.4.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="2"><span id="Sx4.T1.3.4.1.1.1" class="ltx_text">WSIs</span></td>
<td id="Sx4.T1.3.4.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="5">Federated Sites</td>
<td id="Sx4.T1.3.4.1.3" class="ltx_td ltx_align_center ltx_border_t" colspan="2">Unseen Sites</td>
</tr>
<tr id="Sx4.T1.3.5.2" class="ltx_tr">
<td id="Sx4.T1.3.5.2.1" class="ltx_td ltx_nopad_l ltx_align_center">Site A</td>
<td id="Sx4.T1.3.5.2.2" class="ltx_td ltx_nopad_l ltx_align_center">Site B</td>
<td id="Sx4.T1.3.5.2.3" class="ltx_td ltx_nopad_l ltx_align_center">Site C</td>
<td id="Sx4.T1.3.5.2.4" class="ltx_td ltx_nopad_l ltx_align_center">Site D</td>
<td id="Sx4.T1.3.5.2.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_r">Total</td>
<td id="Sx4.T1.3.5.2.6" class="ltx_td ltx_nopad_l ltx_align_center">Site E</td>
<td id="Sx4.T1.3.5.2.7" class="ltx_td ltx_nopad_l ltx_align_center">Site F</td>
</tr>
<tr id="Sx4.T1.1.1" class="ltx_tr">
<td id="Sx4.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">HER2<math id="Sx4.T1.1.1.1.m1.1" class="ltx_Math" alttext="-" display="inline"><semantics id="Sx4.T1.1.1.1.m1.1a"><mo id="Sx4.T1.1.1.1.m1.1.1" xref="Sx4.T1.1.1.1.m1.1.1.cmml">−</mo><annotation-xml encoding="MathML-Content" id="Sx4.T1.1.1.1.m1.1b"><minus id="Sx4.T1.1.1.1.m1.1.1.cmml" xref="Sx4.T1.1.1.1.m1.1.1"></minus></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.1.1.1.m1.1c">-</annotation></semantics></math>
</td>
<td id="Sx4.T1.1.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">669</td>
<td id="Sx4.T1.1.1.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">672</td>
<td id="Sx4.T1.1.1.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">332</td>
<td id="Sx4.T1.1.1.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">306</td>
<td id="Sx4.T1.1.1.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_r ltx_border_t">1979</td>
<td id="Sx4.T1.1.1.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">98</td>
<td id="Sx4.T1.1.1.8" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">26</td>
</tr>
<tr id="Sx4.T1.2.2" class="ltx_tr">
<td id="Sx4.T1.2.2.1" class="ltx_td ltx_align_center ltx_border_r">HER2<math id="Sx4.T1.2.2.1.m1.1" class="ltx_Math" alttext="+" display="inline"><semantics id="Sx4.T1.2.2.1.m1.1a"><mo id="Sx4.T1.2.2.1.m1.1.1" xref="Sx4.T1.2.2.1.m1.1.1.cmml">+</mo><annotation-xml encoding="MathML-Content" id="Sx4.T1.2.2.1.m1.1b"><plus id="Sx4.T1.2.2.1.m1.1.1.cmml" xref="Sx4.T1.2.2.1.m1.1.1"></plus></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.2.2.1.m1.1c">+</annotation></semantics></math>
</td>
<td id="Sx4.T1.2.2.2" class="ltx_td ltx_nopad_l ltx_align_center">118</td>
<td id="Sx4.T1.2.2.3" class="ltx_td ltx_nopad_l ltx_align_center">214</td>
<td id="Sx4.T1.2.2.4" class="ltx_td ltx_nopad_l ltx_align_center">172</td>
<td id="Sx4.T1.2.2.5" class="ltx_td ltx_nopad_l ltx_align_center">204</td>
<td id="Sx4.T1.2.2.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_r">708</td>
<td id="Sx4.T1.2.2.7" class="ltx_td ltx_nopad_l ltx_align_center">93</td>
<td id="Sx4.T1.2.2.8" class="ltx_td ltx_nopad_l ltx_align_center">12</td>
</tr>
<tr id="Sx4.T1.3.6.3" class="ltx_tr">
<td id="Sx4.T1.3.6.3.1" class="ltx_td ltx_align_center ltx_border_r">Total</td>
<td id="Sx4.T1.3.6.3.2" class="ltx_td ltx_nopad_l ltx_align_center">787</td>
<td id="Sx4.T1.3.6.3.3" class="ltx_td ltx_nopad_l ltx_align_center">886</td>
<td id="Sx4.T1.3.6.3.4" class="ltx_td ltx_nopad_l ltx_align_center">504</td>
<td id="Sx4.T1.3.6.3.5" class="ltx_td ltx_nopad_l ltx_align_center">510</td>
<td id="Sx4.T1.3.6.3.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_r">2687</td>
<td id="Sx4.T1.3.6.3.7" class="ltx_td ltx_nopad_l ltx_align_center">191</td>
<td id="Sx4.T1.3.6.3.8" class="ltx_td ltx_nopad_l ltx_align_center">38</td>
</tr>
<tr id="Sx4.T1.3.3" class="ltx_tr">
<td id="Sx4.T1.3.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="Sx4.T1.3.3.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="Sx4.T1.3.3.1.m1.1a"><mi id="Sx4.T1.3.3.1.m1.1.1" xref="Sx4.T1.3.3.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="Sx4.T1.3.3.1.m1.1b"><ci id="Sx4.T1.3.3.1.m1.1.1.cmml" xref="Sx4.T1.3.3.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.3.3.1.m1.1c">\gamma</annotation></semantics></math></td>
<td id="Sx4.T1.3.3.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">5.7</td>
<td id="Sx4.T1.3.3.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">3.1</td>
<td id="Sx4.T1.3.3.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">1.9</td>
<td id="Sx4.T1.3.3.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">1.5</td>
<td id="Sx4.T1.3.3.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_r ltx_border_t">2.8</td>
<td id="Sx4.T1.3.3.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">1.1</td>
<td id="Sx4.T1.3.3.8" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">2.2</td>
</tr>
<tr id="Sx4.T1.3.7.4" class="ltx_tr">
<td id="Sx4.T1.3.7.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Train</td>
<td id="Sx4.T1.3.7.4.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">472</td>
<td id="Sx4.T1.3.7.4.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">532</td>
<td id="Sx4.T1.3.7.4.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">302</td>
<td id="Sx4.T1.3.7.4.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">306</td>
<td id="Sx4.T1.3.7.4.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_r ltx_border_t">1612</td>
<td id="Sx4.T1.3.7.4.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">-</td>
<td id="Sx4.T1.3.7.4.8" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="Sx4.T1.3.8.5" class="ltx_tr">
<td id="Sx4.T1.3.8.5.1" class="ltx_td ltx_align_center ltx_border_r">Val</td>
<td id="Sx4.T1.3.8.5.2" class="ltx_td ltx_nopad_l ltx_align_center">79</td>
<td id="Sx4.T1.3.8.5.3" class="ltx_td ltx_nopad_l ltx_align_center">88</td>
<td id="Sx4.T1.3.8.5.4" class="ltx_td ltx_nopad_l ltx_align_center">50</td>
<td id="Sx4.T1.3.8.5.5" class="ltx_td ltx_nopad_l ltx_align_center">51</td>
<td id="Sx4.T1.3.8.5.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_r">268</td>
<td id="Sx4.T1.3.8.5.7" class="ltx_td ltx_nopad_l ltx_align_center">-</td>
<td id="Sx4.T1.3.8.5.8" class="ltx_td ltx_nopad_l ltx_align_center">-</td>
</tr>
<tr id="Sx4.T1.3.9.6" class="ltx_tr">
<td id="Sx4.T1.3.9.6.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">Test</td>
<td id="Sx4.T1.3.9.6.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">236</td>
<td id="Sx4.T1.3.9.6.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">266</td>
<td id="Sx4.T1.3.9.6.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">152</td>
<td id="Sx4.T1.3.9.6.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">153</td>
<td id="Sx4.T1.3.9.6.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b ltx_border_r">807</td>
<td id="Sx4.T1.3.9.6.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">191</td>
<td id="Sx4.T1.3.9.6.8" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">38</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>WSIs and their HER2 status number in each site. <math id="Sx4.T1.5.m1.2" class="ltx_Math" alttext="\gamma_{i}=\frac{|\mathcal{P}_{i}^{-}|}{|\mathcal{P}_{i}^{+}|}" display="inline"><semantics id="Sx4.T1.5.m1.2b"><mrow id="Sx4.T1.5.m1.2.3" xref="Sx4.T1.5.m1.2.3.cmml"><msub id="Sx4.T1.5.m1.2.3.2" xref="Sx4.T1.5.m1.2.3.2.cmml"><mi id="Sx4.T1.5.m1.2.3.2.2" xref="Sx4.T1.5.m1.2.3.2.2.cmml">γ</mi><mi id="Sx4.T1.5.m1.2.3.2.3" xref="Sx4.T1.5.m1.2.3.2.3.cmml">i</mi></msub><mo id="Sx4.T1.5.m1.2.3.1" xref="Sx4.T1.5.m1.2.3.1.cmml">=</mo><mfrac id="Sx4.T1.5.m1.2.2" xref="Sx4.T1.5.m1.2.2.cmml"><mrow id="Sx4.T1.5.m1.1.1.1.1" xref="Sx4.T1.5.m1.1.1.1.2.cmml"><mo stretchy="false" id="Sx4.T1.5.m1.1.1.1.1.2" xref="Sx4.T1.5.m1.1.1.1.2.1.cmml">|</mo><msubsup id="Sx4.T1.5.m1.1.1.1.1.1" xref="Sx4.T1.5.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.T1.5.m1.1.1.1.1.1.2.2" xref="Sx4.T1.5.m1.1.1.1.1.1.2.2.cmml">𝒫</mi><mi id="Sx4.T1.5.m1.1.1.1.1.1.2.3" xref="Sx4.T1.5.m1.1.1.1.1.1.2.3.cmml">i</mi><mo id="Sx4.T1.5.m1.1.1.1.1.1.3" xref="Sx4.T1.5.m1.1.1.1.1.1.3.cmml">−</mo></msubsup><mo stretchy="false" id="Sx4.T1.5.m1.1.1.1.1.3" xref="Sx4.T1.5.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="Sx4.T1.5.m1.2.2.2.1" xref="Sx4.T1.5.m1.2.2.2.2.cmml"><mo stretchy="false" id="Sx4.T1.5.m1.2.2.2.1.2" xref="Sx4.T1.5.m1.2.2.2.2.1.cmml">|</mo><msubsup id="Sx4.T1.5.m1.2.2.2.1.1" xref="Sx4.T1.5.m1.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Sx4.T1.5.m1.2.2.2.1.1.2.2" xref="Sx4.T1.5.m1.2.2.2.1.1.2.2.cmml">𝒫</mi><mi id="Sx4.T1.5.m1.2.2.2.1.1.2.3" xref="Sx4.T1.5.m1.2.2.2.1.1.2.3.cmml">i</mi><mo id="Sx4.T1.5.m1.2.2.2.1.1.3" xref="Sx4.T1.5.m1.2.2.2.1.1.3.cmml">+</mo></msubsup><mo stretchy="false" id="Sx4.T1.5.m1.2.2.2.1.3" xref="Sx4.T1.5.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="Sx4.T1.5.m1.2c"><apply id="Sx4.T1.5.m1.2.3.cmml" xref="Sx4.T1.5.m1.2.3"><eq id="Sx4.T1.5.m1.2.3.1.cmml" xref="Sx4.T1.5.m1.2.3.1"></eq><apply id="Sx4.T1.5.m1.2.3.2.cmml" xref="Sx4.T1.5.m1.2.3.2"><csymbol cd="ambiguous" id="Sx4.T1.5.m1.2.3.2.1.cmml" xref="Sx4.T1.5.m1.2.3.2">subscript</csymbol><ci id="Sx4.T1.5.m1.2.3.2.2.cmml" xref="Sx4.T1.5.m1.2.3.2.2">𝛾</ci><ci id="Sx4.T1.5.m1.2.3.2.3.cmml" xref="Sx4.T1.5.m1.2.3.2.3">𝑖</ci></apply><apply id="Sx4.T1.5.m1.2.2.cmml" xref="Sx4.T1.5.m1.2.2"><divide id="Sx4.T1.5.m1.2.2.3.cmml" xref="Sx4.T1.5.m1.2.2"></divide><apply id="Sx4.T1.5.m1.1.1.1.2.cmml" xref="Sx4.T1.5.m1.1.1.1.1"><abs id="Sx4.T1.5.m1.1.1.1.2.1.cmml" xref="Sx4.T1.5.m1.1.1.1.1.2"></abs><apply id="Sx4.T1.5.m1.1.1.1.1.1.cmml" xref="Sx4.T1.5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.T1.5.m1.1.1.1.1.1.1.cmml" xref="Sx4.T1.5.m1.1.1.1.1.1">superscript</csymbol><apply id="Sx4.T1.5.m1.1.1.1.1.1.2.cmml" xref="Sx4.T1.5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="Sx4.T1.5.m1.1.1.1.1.1.2.1.cmml" xref="Sx4.T1.5.m1.1.1.1.1.1">subscript</csymbol><ci id="Sx4.T1.5.m1.1.1.1.1.1.2.2.cmml" xref="Sx4.T1.5.m1.1.1.1.1.1.2.2">𝒫</ci><ci id="Sx4.T1.5.m1.1.1.1.1.1.2.3.cmml" xref="Sx4.T1.5.m1.1.1.1.1.1.2.3">𝑖</ci></apply><minus id="Sx4.T1.5.m1.1.1.1.1.1.3.cmml" xref="Sx4.T1.5.m1.1.1.1.1.1.3"></minus></apply></apply><apply id="Sx4.T1.5.m1.2.2.2.2.cmml" xref="Sx4.T1.5.m1.2.2.2.1"><abs id="Sx4.T1.5.m1.2.2.2.2.1.cmml" xref="Sx4.T1.5.m1.2.2.2.1.2"></abs><apply id="Sx4.T1.5.m1.2.2.2.1.1.cmml" xref="Sx4.T1.5.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx4.T1.5.m1.2.2.2.1.1.1.cmml" xref="Sx4.T1.5.m1.2.2.2.1.1">superscript</csymbol><apply id="Sx4.T1.5.m1.2.2.2.1.1.2.cmml" xref="Sx4.T1.5.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="Sx4.T1.5.m1.2.2.2.1.1.2.1.cmml" xref="Sx4.T1.5.m1.2.2.2.1.1">subscript</csymbol><ci id="Sx4.T1.5.m1.2.2.2.1.1.2.2.cmml" xref="Sx4.T1.5.m1.2.2.2.1.1.2.2">𝒫</ci><ci id="Sx4.T1.5.m1.2.2.2.1.1.2.3.cmml" xref="Sx4.T1.5.m1.2.2.2.1.1.2.3">𝑖</ci></apply><plus id="Sx4.T1.5.m1.2.2.2.1.1.3.cmml" xref="Sx4.T1.5.m1.2.2.2.1.1.3"></plus></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T1.5.m1.2d">\gamma_{i}=\frac{|\mathcal{P}_{i}^{-}|}{|\mathcal{P}_{i}^{+}|}</annotation></semantics></math> represents the imbalance ratio. WSIs are split into training (60%), validation (10%), and test (30%) set.</figcaption>
</figure>
<figure id="Sx4.T2" class="ltx_table">
<table id="Sx4.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx4.T2.1.1.1" class="ltx_tr">
<th id="Sx4.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Experiment</th>
<td id="Sx4.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t">Method</td>
<td id="Sx4.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">Average</td>
<td id="Sx4.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">Site A</td>
<td id="Sx4.T2.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">Site B</td>
<td id="Sx4.T2.1.1.1.6" class="ltx_td ltx_align_center ltx_border_t">Site C</td>
<td id="Sx4.T2.1.1.1.7" class="ltx_td ltx_align_center ltx_border_t">Site D</td>
</tr>
<tr id="Sx4.T2.1.2.2" class="ltx_tr">
<th id="Sx4.T2.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="Sx4.T2.1.2.2.1.1" class="ltx_text">Ours</span></th>
<td id="Sx4.T2.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">PointTransformerDDA+</td>
<td id="Sx4.T2.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">
<span id="Sx4.T2.1.2.2.3.1" class="ltx_text ltx_font_bold">0.816</span> ± 0.019</td>
<td id="Sx4.T2.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">
<span id="Sx4.T2.1.2.2.4.1" class="ltx_text ltx_font_bold">0.766</span> ± 0.025</td>
<td id="Sx4.T2.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">
<span id="Sx4.T2.1.2.2.5.1" class="ltx_text ltx_font_bold">0.866</span> ± 0.021</td>
<td id="Sx4.T2.1.2.2.6" class="ltx_td ltx_align_center ltx_border_t">
<span id="Sx4.T2.1.2.2.6.1" class="ltx_text ltx_font_bold">0.837</span> ± 0.036</td>
<td id="Sx4.T2.1.2.2.7" class="ltx_td ltx_align_center ltx_border_t">
<span id="Sx4.T2.1.2.2.7.1" class="ltx_text ltx_font_bold">0.760</span> ± 0.046</td>
</tr>
<tr id="Sx4.T2.1.3.3" class="ltx_tr">
<td id="Sx4.T2.1.3.3.1" class="ltx_td ltx_align_center">PointTransformerDDA</td>
<td id="Sx4.T2.1.3.3.2" class="ltx_td ltx_align_center">0.793 ± 0.013</td>
<td id="Sx4.T2.1.3.3.3" class="ltx_td ltx_align_center">0.730 ± 0.029</td>
<td id="Sx4.T2.1.3.3.4" class="ltx_td ltx_align_center">0.855 ± 0.013</td>
<td id="Sx4.T2.1.3.3.5" class="ltx_td ltx_align_center">0.804 ± 0.024</td>
<td id="Sx4.T2.1.3.3.6" class="ltx_td ltx_align_center">0.758 ± 0.022</td>
</tr>
<tr id="Sx4.T2.1.4.4" class="ltx_tr">
<td id="Sx4.T2.1.4.4.1" class="ltx_td ltx_align_center">PointTransformer+</td>
<td id="Sx4.T2.1.4.4.2" class="ltx_td ltx_align_center">0.806 ± 0.015</td>
<td id="Sx4.T2.1.4.4.3" class="ltx_td ltx_align_center">0.752 ± 0.018</td>
<td id="Sx4.T2.1.4.4.4" class="ltx_td ltx_align_center">0.844 ± 0.008</td>
<td id="Sx4.T2.1.4.4.5" class="ltx_td ltx_align_center">0.823 ± 0.024</td>
<td id="Sx4.T2.1.4.4.6" class="ltx_td ltx_align_center">0.757 ± 0.043</td>
</tr>
<tr id="Sx4.T2.1.5.5" class="ltx_tr">
<th id="Sx4.T2.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="Sx4.T2.1.5.5.1.1" class="ltx_text">Point-based</span></th>
<td id="Sx4.T2.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t">PointTransformer [1]</td>
<td id="Sx4.T2.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t">0.771 ± 0.012</td>
<td id="Sx4.T2.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t">0.717 ± 0.037</td>
<td id="Sx4.T2.1.5.5.5" class="ltx_td ltx_align_center ltx_border_t">0.834 ± 0.026</td>
<td id="Sx4.T2.1.5.5.6" class="ltx_td ltx_align_center ltx_border_t">0.776 ± 0.037</td>
<td id="Sx4.T2.1.5.5.7" class="ltx_td ltx_align_center ltx_border_t">0.721 ± 0.035</td>
</tr>
<tr id="Sx4.T2.1.6.6" class="ltx_tr">
<td id="Sx4.T2.1.6.6.1" class="ltx_td ltx_align_center">PointNet++ [2]</td>
<td id="Sx4.T2.1.6.6.2" class="ltx_td ltx_align_center">0.763 ± 0.017</td>
<td id="Sx4.T2.1.6.6.3" class="ltx_td ltx_align_center">0.696 ± 0.039</td>
<td id="Sx4.T2.1.6.6.4" class="ltx_td ltx_align_center">0.830 ± 0.033</td>
<td id="Sx4.T2.1.6.6.5" class="ltx_td ltx_align_center">0.746 ± 0.045</td>
<td id="Sx4.T2.1.6.6.6" class="ltx_td ltx_align_center">0.730 ± 0.042</td>
</tr>
<tr id="Sx4.T2.1.7.7" class="ltx_tr">
<th id="Sx4.T2.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="4"><span id="Sx4.T2.1.7.7.1.1" class="ltx_text">MIL-based</span></th>
<td id="Sx4.T2.1.7.7.2" class="ltx_td ltx_align_center ltx_border_t">CLAM-SB [3]</td>
<td id="Sx4.T2.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t">0.767 ± 0.032</td>
<td id="Sx4.T2.1.7.7.4" class="ltx_td ltx_align_center ltx_border_t">0.712 ± 0.044</td>
<td id="Sx4.T2.1.7.7.5" class="ltx_td ltx_align_center ltx_border_t">0.793 ± 0.037</td>
<td id="Sx4.T2.1.7.7.6" class="ltx_td ltx_align_center ltx_border_t">0.766 ± 0.072</td>
<td id="Sx4.T2.1.7.7.7" class="ltx_td ltx_align_center ltx_border_t">0.748 ± 0.022</td>
</tr>
<tr id="Sx4.T2.1.8.8" class="ltx_tr">
<td id="Sx4.T2.1.8.8.1" class="ltx_td ltx_align_center">DSMIL [4]</td>
<td id="Sx4.T2.1.8.8.2" class="ltx_td ltx_align_center">0.693 ± 0.096</td>
<td id="Sx4.T2.1.8.8.3" class="ltx_td ltx_align_center">0.647 ± 0.065</td>
<td id="Sx4.T2.1.8.8.4" class="ltx_td ltx_align_center">0.738 ± 0.103</td>
<td id="Sx4.T2.1.8.8.5" class="ltx_td ltx_align_center">0.706 ± 0.080</td>
<td id="Sx4.T2.1.8.8.6" class="ltx_td ltx_align_center">0.675 ± 0.111</td>
</tr>
<tr id="Sx4.T2.1.9.9" class="ltx_tr">
<td id="Sx4.T2.1.9.9.1" class="ltx_td ltx_align_center">TransMIL [5]</td>
<td id="Sx4.T2.1.9.9.2" class="ltx_td ltx_align_center">0.790 ± 0.019</td>
<td id="Sx4.T2.1.9.9.3" class="ltx_td ltx_align_center">0.739 ± 0.038</td>
<td id="Sx4.T2.1.9.9.4" class="ltx_td ltx_align_center">0.824 ± 0.021</td>
<td id="Sx4.T2.1.9.9.5" class="ltx_td ltx_align_center">0.805 ± 0.036</td>
<td id="Sx4.T2.1.9.9.6" class="ltx_td ltx_align_center">0.759 ± 0.040</td>
</tr>
<tr id="Sx4.T2.1.10.10" class="ltx_tr">
<td id="Sx4.T2.1.10.10.1" class="ltx_td ltx_align_center">HistoFL [6]</td>
<td id="Sx4.T2.1.10.10.2" class="ltx_td ltx_align_center">0.757 ± 0.039</td>
<td id="Sx4.T2.1.10.10.3" class="ltx_td ltx_align_center">0.729 ± 0.048</td>
<td id="Sx4.T2.1.10.10.4" class="ltx_td ltx_align_center">0.776 ± 0.050</td>
<td id="Sx4.T2.1.10.10.5" class="ltx_td ltx_align_center">0.759 ± 0.076</td>
<td id="Sx4.T2.1.10.10.6" class="ltx_td ltx_align_center">0.733 ± 0.012</td>
</tr>
<tr id="Sx4.T2.1.11.11" class="ltx_tr">
<th id="Sx4.T2.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" rowspan="3"><span id="Sx4.T2.1.11.11.1.1" class="ltx_text">Graph-based</span></th>
<td id="Sx4.T2.1.11.11.2" class="ltx_td ltx_align_center ltx_border_t">GraphSAGE [7]</td>
<td id="Sx4.T2.1.11.11.3" class="ltx_td ltx_align_center ltx_border_t">0.711 ± 0.026</td>
<td id="Sx4.T2.1.11.11.4" class="ltx_td ltx_align_center ltx_border_t">0.656 ± 0.053</td>
<td id="Sx4.T2.1.11.11.5" class="ltx_td ltx_align_center ltx_border_t">0.735 ± 0.027</td>
<td id="Sx4.T2.1.11.11.6" class="ltx_td ltx_align_center ltx_border_t">0.692 ± 0.044</td>
<td id="Sx4.T2.1.11.11.7" class="ltx_td ltx_align_center ltx_border_t">0.685 ± 0.021</td>
</tr>
<tr id="Sx4.T2.1.12.12" class="ltx_tr">
<td id="Sx4.T2.1.12.12.1" class="ltx_td ltx_align_center">Patch-GCN [8]</td>
<td id="Sx4.T2.1.12.12.2" class="ltx_td ltx_align_center">0.750 ± 0.037</td>
<td id="Sx4.T2.1.12.12.3" class="ltx_td ltx_align_center">0.700 ± 0.035</td>
<td id="Sx4.T2.1.12.12.4" class="ltx_td ltx_align_center">0.768 ± 0.062</td>
<td id="Sx4.T2.1.12.12.5" class="ltx_td ltx_align_center">0.766 ± 0.030</td>
<td id="Sx4.T2.1.12.12.6" class="ltx_td ltx_align_center">0.727 ± 0.047</td>
</tr>
<tr id="Sx4.T2.1.13.13" class="ltx_tr">
<td id="Sx4.T2.1.13.13.1" class="ltx_td ltx_align_center ltx_border_b">SlideGraph+ [9]</td>
<td id="Sx4.T2.1.13.13.2" class="ltx_td ltx_align_center ltx_border_b">0.783 ± 0.019</td>
<td id="Sx4.T2.1.13.13.3" class="ltx_td ltx_align_center ltx_border_b">0.736 ± 0.029</td>
<td id="Sx4.T2.1.13.13.4" class="ltx_td ltx_align_center ltx_border_b">0.828 ± 0.012</td>
<td id="Sx4.T2.1.13.13.5" class="ltx_td ltx_align_center ltx_border_b">0.804 ± 0.037</td>
<td id="Sx4.T2.1.13.13.6" class="ltx_td ltx_align_center ltx_border_b">
<span id="Sx4.T2.1.13.13.6.1" class="ltx_text ltx_font_bold">0.785</span> ± 0.013</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Comparison of our model with other point, multi-instance, and graph-based models. [1] <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al. <a href="#bib.bib46" title="" class="ltx_ref">2021</a>)</cite>, [2] <cite class="ltx_cite ltx_citemacro_citep">(Qi et al. <a href="#bib.bib36" title="" class="ltx_ref">2017b</a>)</cite>, [3] <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite>, [4] <cite class="ltx_cite ltx_citemacro_citep">(Li, Li, and Eliceiri <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite>, [5] <cite class="ltx_cite ltx_citemacro_citep">(Shao et al. <a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite>, [6] <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib27" title="" class="ltx_ref">2022b</a>)</cite>, [7] <cite class="ltx_cite ltx_citemacro_citep">(Hamilton, Ying, and Leskovec <a href="#bib.bib11" title="" class="ltx_ref">2017</a>)</cite>, [8] <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib1" title="" class="ltx_ref">2021a</a>)</cite>, [9] <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib29" title="" class="ltx_ref">2022c</a>)</cite>.</figcaption>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.6.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Point transformer with federated learning</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg2.4" class="ltx_p ltx_figure_panel"><span id="alg2.4.1" class="ltx_text ltx_font_bold">Input</span>: M participating sites with point set <math id="alg2.1.m1.2" class="ltx_Math" alttext="\mathcal{P}_{m}=(\mathcal{X}_{m},y_{m})" display="inline"><semantics id="alg2.1.m1.2a"><mrow id="alg2.1.m1.2.2" xref="alg2.1.m1.2.2.cmml"><msub id="alg2.1.m1.2.2.4" xref="alg2.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.1.m1.2.2.4.2" xref="alg2.1.m1.2.2.4.2.cmml">𝒫</mi><mi id="alg2.1.m1.2.2.4.3" xref="alg2.1.m1.2.2.4.3.cmml">m</mi></msub><mo id="alg2.1.m1.2.2.3" xref="alg2.1.m1.2.2.3.cmml">=</mo><mrow id="alg2.1.m1.2.2.2.2" xref="alg2.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg2.1.m1.2.2.2.2.3" xref="alg2.1.m1.2.2.2.3.cmml">(</mo><msub id="alg2.1.m1.1.1.1.1.1" xref="alg2.1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.1.m1.1.1.1.1.1.2" xref="alg2.1.m1.1.1.1.1.1.2.cmml">𝒳</mi><mi id="alg2.1.m1.1.1.1.1.1.3" xref="alg2.1.m1.1.1.1.1.1.3.cmml">m</mi></msub><mo id="alg2.1.m1.2.2.2.2.4" xref="alg2.1.m1.2.2.2.3.cmml">,</mo><msub id="alg2.1.m1.2.2.2.2.2" xref="alg2.1.m1.2.2.2.2.2.cmml"><mi id="alg2.1.m1.2.2.2.2.2.2" xref="alg2.1.m1.2.2.2.2.2.2.cmml">y</mi><mi id="alg2.1.m1.2.2.2.2.2.3" xref="alg2.1.m1.2.2.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="alg2.1.m1.2.2.2.2.5" xref="alg2.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.1.m1.2b"><apply id="alg2.1.m1.2.2.cmml" xref="alg2.1.m1.2.2"><eq id="alg2.1.m1.2.2.3.cmml" xref="alg2.1.m1.2.2.3"></eq><apply id="alg2.1.m1.2.2.4.cmml" xref="alg2.1.m1.2.2.4"><csymbol cd="ambiguous" id="alg2.1.m1.2.2.4.1.cmml" xref="alg2.1.m1.2.2.4">subscript</csymbol><ci id="alg2.1.m1.2.2.4.2.cmml" xref="alg2.1.m1.2.2.4.2">𝒫</ci><ci id="alg2.1.m1.2.2.4.3.cmml" xref="alg2.1.m1.2.2.4.3">𝑚</ci></apply><interval closure="open" id="alg2.1.m1.2.2.2.3.cmml" xref="alg2.1.m1.2.2.2.2"><apply id="alg2.1.m1.1.1.1.1.1.cmml" xref="alg2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.1.m1.1.1.1.1.1.1.cmml" xref="alg2.1.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.1.m1.1.1.1.1.1.2.cmml" xref="alg2.1.m1.1.1.1.1.1.2">𝒳</ci><ci id="alg2.1.m1.1.1.1.1.1.3.cmml" xref="alg2.1.m1.1.1.1.1.1.3">𝑚</ci></apply><apply id="alg2.1.m1.2.2.2.2.2.cmml" xref="alg2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.1.m1.2.2.2.2.2.1.cmml" xref="alg2.1.m1.2.2.2.2.2">subscript</csymbol><ci id="alg2.1.m1.2.2.2.2.2.2.cmml" xref="alg2.1.m1.2.2.2.2.2.2">𝑦</ci><ci id="alg2.1.m1.2.2.2.2.2.3.cmml" xref="alg2.1.m1.2.2.2.2.2.3">𝑚</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.1.m1.2c">\mathcal{P}_{m}=(\mathcal{X}_{m},y_{m})</annotation></semantics></math>
<br class="ltx_break">and label imbalanced ratio <math id="alg2.2.m2.1" class="ltx_Math" alttext="\gamma_{m}" display="inline"><semantics id="alg2.2.m2.1a"><msub id="alg2.2.m2.1.1" xref="alg2.2.m2.1.1.cmml"><mi id="alg2.2.m2.1.1.2" xref="alg2.2.m2.1.1.2.cmml">γ</mi><mi id="alg2.2.m2.1.1.3" xref="alg2.2.m2.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.2.m2.1b"><apply id="alg2.2.m2.1.1.cmml" xref="alg2.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.2.m2.1.1.1.cmml" xref="alg2.2.m2.1.1">subscript</csymbol><ci id="alg2.2.m2.1.1.2.cmml" xref="alg2.2.m2.1.1.2">𝛾</ci><ci id="alg2.2.m2.1.1.3.cmml" xref="alg2.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m2.1c">\gamma_{m}</annotation></semantics></math> where <math id="alg2.3.m3.3" class="ltx_Math" alttext="m\in\{1,...,M\}" display="inline"><semantics id="alg2.3.m3.3a"><mrow id="alg2.3.m3.3.4" xref="alg2.3.m3.3.4.cmml"><mi id="alg2.3.m3.3.4.2" xref="alg2.3.m3.3.4.2.cmml">m</mi><mo id="alg2.3.m3.3.4.1" xref="alg2.3.m3.3.4.1.cmml">∈</mo><mrow id="alg2.3.m3.3.4.3.2" xref="alg2.3.m3.3.4.3.1.cmml"><mo stretchy="false" id="alg2.3.m3.3.4.3.2.1" xref="alg2.3.m3.3.4.3.1.cmml">{</mo><mn id="alg2.3.m3.1.1" xref="alg2.3.m3.1.1.cmml">1</mn><mo id="alg2.3.m3.3.4.3.2.2" xref="alg2.3.m3.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.3.m3.2.2" xref="alg2.3.m3.2.2.cmml">…</mi><mo id="alg2.3.m3.3.4.3.2.3" xref="alg2.3.m3.3.4.3.1.cmml">,</mo><mi id="alg2.3.m3.3.3" xref="alg2.3.m3.3.3.cmml">M</mi><mo stretchy="false" id="alg2.3.m3.3.4.3.2.4" xref="alg2.3.m3.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.3.m3.3b"><apply id="alg2.3.m3.3.4.cmml" xref="alg2.3.m3.3.4"><in id="alg2.3.m3.3.4.1.cmml" xref="alg2.3.m3.3.4.1"></in><ci id="alg2.3.m3.3.4.2.cmml" xref="alg2.3.m3.3.4.2">𝑚</ci><set id="alg2.3.m3.3.4.3.1.cmml" xref="alg2.3.m3.3.4.3.2"><cn type="integer" id="alg2.3.m3.1.1.cmml" xref="alg2.3.m3.1.1">1</cn><ci id="alg2.3.m3.2.2.cmml" xref="alg2.3.m3.2.2">…</ci><ci id="alg2.3.m3.3.3.cmml" xref="alg2.3.m3.3.3">𝑀</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.3.m3.3c">m\in\{1,...,M\}</annotation></semantics></math>. Optimization epochs: K, communication pace: E.
<br class="ltx_break"><span id="alg2.4.2" class="ltx_text ltx_font_bold">Output</span>: Model’s weights <math id="alg2.4.m4.1" class="ltx_Math" alttext="W_{s}" display="inline"><semantics id="alg2.4.m4.1a"><msub id="alg2.4.m4.1.1" xref="alg2.4.m4.1.1.cmml"><mi id="alg2.4.m4.1.1.2" xref="alg2.4.m4.1.1.2.cmml">W</mi><mi id="alg2.4.m4.1.1.3" xref="alg2.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.4.m4.1b"><apply id="alg2.4.m4.1.1.cmml" xref="alg2.4.m4.1.1"><csymbol cd="ambiguous" id="alg2.4.m4.1.1.1.cmml" xref="alg2.4.m4.1.1">subscript</csymbol><ci id="alg2.4.m4.1.1.2.cmml" xref="alg2.4.m4.1.1.2">𝑊</ci><ci id="alg2.4.m4.1.1.3.cmml" xref="alg2.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.4.m4.1c">W_{s}</annotation></semantics></math>.</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg2.7" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1:</span>  initialize the point transformer’s function: <math id="alg2.l1.m1.3" class="ltx_Math" alttext="f_{h},f_{c},f_{aux}" display="inline"><semantics id="alg2.l1.m1.3a"><mrow id="alg2.l1.m1.3.3.3" xref="alg2.l1.m1.3.3.4.cmml"><msub id="alg2.l1.m1.1.1.1.1" xref="alg2.l1.m1.1.1.1.1.cmml"><mi id="alg2.l1.m1.1.1.1.1.2" xref="alg2.l1.m1.1.1.1.1.2.cmml">f</mi><mi id="alg2.l1.m1.1.1.1.1.3" xref="alg2.l1.m1.1.1.1.1.3.cmml">h</mi></msub><mo id="alg2.l1.m1.3.3.3.4" xref="alg2.l1.m1.3.3.4.cmml">,</mo><msub id="alg2.l1.m1.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.cmml"><mi id="alg2.l1.m1.2.2.2.2.2" xref="alg2.l1.m1.2.2.2.2.2.cmml">f</mi><mi id="alg2.l1.m1.2.2.2.2.3" xref="alg2.l1.m1.2.2.2.2.3.cmml">c</mi></msub><mo id="alg2.l1.m1.3.3.3.5" xref="alg2.l1.m1.3.3.4.cmml">,</mo><msub id="alg2.l1.m1.3.3.3.3" xref="alg2.l1.m1.3.3.3.3.cmml"><mi id="alg2.l1.m1.3.3.3.3.2" xref="alg2.l1.m1.3.3.3.3.2.cmml">f</mi><mrow id="alg2.l1.m1.3.3.3.3.3" xref="alg2.l1.m1.3.3.3.3.3.cmml"><mi id="alg2.l1.m1.3.3.3.3.3.2" xref="alg2.l1.m1.3.3.3.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m1.3.3.3.3.3.1" xref="alg2.l1.m1.3.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m1.3.3.3.3.3.3" xref="alg2.l1.m1.3.3.3.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg2.l1.m1.3.3.3.3.3.1a" xref="alg2.l1.m1.3.3.3.3.3.1.cmml">​</mo><mi id="alg2.l1.m1.3.3.3.3.3.4" xref="alg2.l1.m1.3.3.3.3.3.4.cmml">x</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.3b"><list id="alg2.l1.m1.3.3.4.cmml" xref="alg2.l1.m1.3.3.3"><apply id="alg2.l1.m1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.1.1.cmml" xref="alg2.l1.m1.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m1.1.1.1.1.2.cmml" xref="alg2.l1.m1.1.1.1.1.2">𝑓</ci><ci id="alg2.l1.m1.1.1.1.1.3.cmml" xref="alg2.l1.m1.1.1.1.1.3">ℎ</ci></apply><apply id="alg2.l1.m1.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.2.2.2.2.1.cmml" xref="alg2.l1.m1.2.2.2.2">subscript</csymbol><ci id="alg2.l1.m1.2.2.2.2.2.cmml" xref="alg2.l1.m1.2.2.2.2.2">𝑓</ci><ci id="alg2.l1.m1.2.2.2.2.3.cmml" xref="alg2.l1.m1.2.2.2.2.3">𝑐</ci></apply><apply id="alg2.l1.m1.3.3.3.3.cmml" xref="alg2.l1.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l1.m1.3.3.3.3.1.cmml" xref="alg2.l1.m1.3.3.3.3">subscript</csymbol><ci id="alg2.l1.m1.3.3.3.3.2.cmml" xref="alg2.l1.m1.3.3.3.3.2">𝑓</ci><apply id="alg2.l1.m1.3.3.3.3.3.cmml" xref="alg2.l1.m1.3.3.3.3.3"><times id="alg2.l1.m1.3.3.3.3.3.1.cmml" xref="alg2.l1.m1.3.3.3.3.3.1"></times><ci id="alg2.l1.m1.3.3.3.3.3.2.cmml" xref="alg2.l1.m1.3.3.3.3.3.2">𝑎</ci><ci id="alg2.l1.m1.3.3.3.3.3.3.cmml" xref="alg2.l1.m1.3.3.3.3.3.3">𝑢</ci><ci id="alg2.l1.m1.3.3.3.3.3.4.cmml" xref="alg2.l1.m1.3.3.3.3.3.4">𝑥</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.3c">f_{h},f_{c},f_{aux}</annotation></semantics></math>;

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2:</span>  initialize the same weights for the server and sites: <math id="alg2.l2.m1.8" class="ltx_Math" alttext="W_{s}^{0},W_{s,1}^{0},...,W_{s,M}^{0}" display="inline"><semantics id="alg2.l2.m1.8a"><mrow id="alg2.l2.m1.8.8.3" xref="alg2.l2.m1.8.8.4.cmml"><msubsup id="alg2.l2.m1.6.6.1.1" xref="alg2.l2.m1.6.6.1.1.cmml"><mi id="alg2.l2.m1.6.6.1.1.2.2" xref="alg2.l2.m1.6.6.1.1.2.2.cmml">W</mi><mi id="alg2.l2.m1.6.6.1.1.2.3" xref="alg2.l2.m1.6.6.1.1.2.3.cmml">s</mi><mn id="alg2.l2.m1.6.6.1.1.3" xref="alg2.l2.m1.6.6.1.1.3.cmml">0</mn></msubsup><mo id="alg2.l2.m1.8.8.3.4" xref="alg2.l2.m1.8.8.4.cmml">,</mo><msubsup id="alg2.l2.m1.7.7.2.2" xref="alg2.l2.m1.7.7.2.2.cmml"><mi id="alg2.l2.m1.7.7.2.2.2.2" xref="alg2.l2.m1.7.7.2.2.2.2.cmml">W</mi><mrow id="alg2.l2.m1.2.2.2.4" xref="alg2.l2.m1.2.2.2.3.cmml"><mi id="alg2.l2.m1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.cmml">s</mi><mo id="alg2.l2.m1.2.2.2.4.1" xref="alg2.l2.m1.2.2.2.3.cmml">,</mo><mn id="alg2.l2.m1.2.2.2.2" xref="alg2.l2.m1.2.2.2.2.cmml">1</mn></mrow><mn id="alg2.l2.m1.7.7.2.2.3" xref="alg2.l2.m1.7.7.2.2.3.cmml">0</mn></msubsup><mo id="alg2.l2.m1.8.8.3.5" xref="alg2.l2.m1.8.8.4.cmml">,</mo><mi mathvariant="normal" id="alg2.l2.m1.5.5" xref="alg2.l2.m1.5.5.cmml">…</mi><mo id="alg2.l2.m1.8.8.3.6" xref="alg2.l2.m1.8.8.4.cmml">,</mo><msubsup id="alg2.l2.m1.8.8.3.3" xref="alg2.l2.m1.8.8.3.3.cmml"><mi id="alg2.l2.m1.8.8.3.3.2.2" xref="alg2.l2.m1.8.8.3.3.2.2.cmml">W</mi><mrow id="alg2.l2.m1.4.4.2.4" xref="alg2.l2.m1.4.4.2.3.cmml"><mi id="alg2.l2.m1.3.3.1.1" xref="alg2.l2.m1.3.3.1.1.cmml">s</mi><mo id="alg2.l2.m1.4.4.2.4.1" xref="alg2.l2.m1.4.4.2.3.cmml">,</mo><mi id="alg2.l2.m1.4.4.2.2" xref="alg2.l2.m1.4.4.2.2.cmml">M</mi></mrow><mn id="alg2.l2.m1.8.8.3.3.3" xref="alg2.l2.m1.8.8.3.3.3.cmml">0</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.8b"><list id="alg2.l2.m1.8.8.4.cmml" xref="alg2.l2.m1.8.8.3"><apply id="alg2.l2.m1.6.6.1.1.cmml" xref="alg2.l2.m1.6.6.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.6.6.1.1.1.cmml" xref="alg2.l2.m1.6.6.1.1">superscript</csymbol><apply id="alg2.l2.m1.6.6.1.1.2.cmml" xref="alg2.l2.m1.6.6.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.6.6.1.1.2.1.cmml" xref="alg2.l2.m1.6.6.1.1">subscript</csymbol><ci id="alg2.l2.m1.6.6.1.1.2.2.cmml" xref="alg2.l2.m1.6.6.1.1.2.2">𝑊</ci><ci id="alg2.l2.m1.6.6.1.1.2.3.cmml" xref="alg2.l2.m1.6.6.1.1.2.3">𝑠</ci></apply><cn type="integer" id="alg2.l2.m1.6.6.1.1.3.cmml" xref="alg2.l2.m1.6.6.1.1.3">0</cn></apply><apply id="alg2.l2.m1.7.7.2.2.cmml" xref="alg2.l2.m1.7.7.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.7.7.2.2.1.cmml" xref="alg2.l2.m1.7.7.2.2">superscript</csymbol><apply id="alg2.l2.m1.7.7.2.2.2.cmml" xref="alg2.l2.m1.7.7.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.7.7.2.2.2.1.cmml" xref="alg2.l2.m1.7.7.2.2">subscript</csymbol><ci id="alg2.l2.m1.7.7.2.2.2.2.cmml" xref="alg2.l2.m1.7.7.2.2.2.2">𝑊</ci><list id="alg2.l2.m1.2.2.2.3.cmml" xref="alg2.l2.m1.2.2.2.4"><ci id="alg2.l2.m1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1">𝑠</ci><cn type="integer" id="alg2.l2.m1.2.2.2.2.cmml" xref="alg2.l2.m1.2.2.2.2">1</cn></list></apply><cn type="integer" id="alg2.l2.m1.7.7.2.2.3.cmml" xref="alg2.l2.m1.7.7.2.2.3">0</cn></apply><ci id="alg2.l2.m1.5.5.cmml" xref="alg2.l2.m1.5.5">…</ci><apply id="alg2.l2.m1.8.8.3.3.cmml" xref="alg2.l2.m1.8.8.3.3"><csymbol cd="ambiguous" id="alg2.l2.m1.8.8.3.3.1.cmml" xref="alg2.l2.m1.8.8.3.3">superscript</csymbol><apply id="alg2.l2.m1.8.8.3.3.2.cmml" xref="alg2.l2.m1.8.8.3.3"><csymbol cd="ambiguous" id="alg2.l2.m1.8.8.3.3.2.1.cmml" xref="alg2.l2.m1.8.8.3.3">subscript</csymbol><ci id="alg2.l2.m1.8.8.3.3.2.2.cmml" xref="alg2.l2.m1.8.8.3.3.2.2">𝑊</ci><list id="alg2.l2.m1.4.4.2.3.cmml" xref="alg2.l2.m1.4.4.2.4"><ci id="alg2.l2.m1.3.3.1.1.cmml" xref="alg2.l2.m1.3.3.1.1">𝑠</ci><ci id="alg2.l2.m1.4.4.2.2.cmml" xref="alg2.l2.m1.4.4.2.2">𝑀</ci></list></apply><cn type="integer" id="alg2.l2.m1.8.8.3.3.3.cmml" xref="alg2.l2.m1.8.8.3.3.3">0</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.8c">W_{s}^{0},W_{s,1}^{0},...,W_{s,M}^{0}</annotation></semantics></math>;

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3:</span>  <span id="alg2.l3.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l3.m1.1" class="ltx_Math" alttext="k=0" display="inline"><semantics id="alg2.l3.m1.1a"><mrow id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">k</mi><mo id="alg2.l3.m1.1.1.1" xref="alg2.l3.m1.1.1.1.cmml">=</mo><mn id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><eq id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1"></eq><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝑘</ci><cn type="integer" id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">k=0</annotation></semantics></math> <span id="alg2.l3.2" class="ltx_text ltx_font_bold">to</span> <math id="alg2.l3.m2.1" class="ltx_Math" alttext="K-1" display="inline"><semantics id="alg2.l3.m2.1a"><mrow id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml"><mi id="alg2.l3.m2.1.1.2" xref="alg2.l3.m2.1.1.2.cmml">K</mi><mo id="alg2.l3.m2.1.1.1" xref="alg2.l3.m2.1.1.1.cmml">−</mo><mn id="alg2.l3.m2.1.1.3" xref="alg2.l3.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><apply id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1"><minus id="alg2.l3.m2.1.1.1.cmml" xref="alg2.l3.m2.1.1.1"></minus><ci id="alg2.l3.m2.1.1.2.cmml" xref="alg2.l3.m2.1.1.2">𝐾</ci><cn type="integer" id="alg2.l3.m2.1.1.3.cmml" xref="alg2.l3.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">K-1</annotation></semantics></math> <span id="alg2.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4:</span>     <span id="alg2.l4.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l4.m1.1" class="ltx_Math" alttext="m=1" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">m</mi><mo id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">=</mo><mn id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><eq id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"></eq><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝑚</ci><cn type="integer" id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">m=1</annotation></semantics></math> <span id="alg2.l4.2" class="ltx_text ltx_font_bold">to</span> <math id="alg2.l4.m2.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg2.l4.m2.1a"><mi id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><ci id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">M</annotation></semantics></math> <span id="alg2.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5:</span>        <math id="alg2.l5.m1.1" class="ltx_Math" alttext="F_{h}=f_{h}(\mathcal{X}_{m})" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><msub id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"><mi id="alg2.l5.m1.1.1.3.2" xref="alg2.l5.m1.1.1.3.2.cmml">F</mi><mi id="alg2.l5.m1.1.1.3.3" xref="alg2.l5.m1.1.1.3.3.cmml">h</mi></msub><mo id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">=</mo><mrow id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml"><msub id="alg2.l5.m1.1.1.1.3" xref="alg2.l5.m1.1.1.1.3.cmml"><mi id="alg2.l5.m1.1.1.1.3.2" xref="alg2.l5.m1.1.1.1.3.2.cmml">f</mi><mi id="alg2.l5.m1.1.1.1.3.3" xref="alg2.l5.m1.1.1.1.3.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.1.2" xref="alg2.l5.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l5.m1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l5.m1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l5.m1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.1.2.cmml">𝒳</mi><mi id="alg2.l5.m1.1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.1.3.cmml">m</mi></msub><mo stretchy="false" id="alg2.l5.m1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><eq id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"></eq><apply id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.3">subscript</csymbol><ci id="alg2.l5.m1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.3.2">𝐹</ci><ci id="alg2.l5.m1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.3.3">ℎ</ci></apply><apply id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"><times id="alg2.l5.m1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.2"></times><apply id="alg2.l5.m1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.1.3.2">𝑓</ci><ci id="alg2.l5.m1.1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.1.3.3">ℎ</ci></apply><apply id="alg2.l5.m1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.2">𝒳</ci><ci id="alg2.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.3">𝑚</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">F_{h}=f_{h}(\mathcal{X}_{m})</annotation></semantics></math>;
</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6:</span>        // Dynamic distribution adjustment

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7:</span>        <math id="alg2.l7.m1.1" class="ltx_Math" alttext="M_{m}=\mathcal{B}(\frac{1}{\gamma_{m}}+(1-\frac{1}{\gamma_{m}})\cdot\frac{e^{k/K}-1}{e-1})" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><msub id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml"><mi id="alg2.l7.m1.1.1.3.2" xref="alg2.l7.m1.1.1.3.2.cmml">M</mi><mi id="alg2.l7.m1.1.1.3.3" xref="alg2.l7.m1.1.1.3.3.cmml">m</mi></msub><mo id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">=</mo><mrow id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.1.1.1.3" xref="alg2.l7.m1.1.1.1.3.cmml">ℬ</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.1.2" xref="alg2.l7.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l7.m1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l7.m1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.cmml"><mfrac id="alg2.l7.m1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.3.cmml"><mn id="alg2.l7.m1.1.1.1.1.1.1.3.2" xref="alg2.l7.m1.1.1.1.1.1.1.3.2.cmml">1</mn><msub id="alg2.l7.m1.1.1.1.1.1.1.3.3" xref="alg2.l7.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.1.3.3.2" xref="alg2.l7.m1.1.1.1.1.1.1.3.3.2.cmml">γ</mi><mi id="alg2.l7.m1.1.1.1.1.1.1.3.3.3" xref="alg2.l7.m1.1.1.1.1.1.1.3.3.3.cmml">m</mi></msub></mfrac><mo id="alg2.l7.m1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.2.cmml">+</mo><mrow id="alg2.l7.m1.1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.cmml"><mrow id="alg2.l7.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mn id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">1</mn><msub id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">γ</mi><mi id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">m</mi></msub></mfrac></mrow><mo rspace="0.055em" stretchy="false" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="alg2.l7.m1.1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.2.cmml">⋅</mo><mfrac id="alg2.l7.m1.1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.cmml"><mrow id="alg2.l7.m1.1.1.1.1.1.1.1.3.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.cmml"><msup id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.2.cmml">e</mi><mrow id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.2.cmml">k</mi><mo id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.1.cmml">/</mo><mi id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.3.cmml">K</mi></mrow></msup><mo id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.1.cmml">−</mo><mn id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.3.cmml">1</mn></mrow><mrow id="alg2.l7.m1.1.1.1.1.1.1.1.3.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.1.1.3.3.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.3.2.cmml">e</mi><mo id="alg2.l7.m1.1.1.1.1.1.1.1.3.3.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="alg2.l7.m1.1.1.1.1.1.1.1.3.3.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mrow></mrow><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><eq id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2"></eq><apply id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.3">subscript</csymbol><ci id="alg2.l7.m1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.3.2">𝑀</ci><ci id="alg2.l7.m1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.3.3">𝑚</ci></apply><apply id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"><times id="alg2.l7.m1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.2"></times><ci id="alg2.l7.m1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.3">ℬ</ci><apply id="alg2.l7.m1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1"><plus id="alg2.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.2"></plus><apply id="alg2.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3"><divide id="alg2.l7.m1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3"></divide><cn type="integer" id="alg2.l7.m1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.2">1</cn><apply id="alg2.l7.m1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.3.2">𝛾</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3.3.3">𝑚</ci></apply></apply><apply id="alg2.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1"><ci id="alg2.l7.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.2">⋅</ci><apply id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1"><minus id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3"><divide id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3"></divide><cn type="integer" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.2">1</cn><apply id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝛾</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑚</ci></apply></apply></apply><apply id="alg2.l7.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3"><divide id="alg2.l7.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3"></divide><apply id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2"><minus id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.1"></minus><apply id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2">superscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.2">𝑒</ci><apply id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3"><divide id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.1"></divide><ci id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.2">𝑘</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.2.3.3">𝐾</ci></apply></apply><cn type="integer" id="alg2.l7.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="alg2.l7.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.3"><minus id="alg2.l7.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.3.1"></minus><ci id="alg2.l7.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.3.2">𝑒</ci><cn type="integer" id="alg2.l7.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">M_{m}=\mathcal{B}(\frac{1}{\gamma_{m}}+(1-\frac{1}{\gamma_{m}})\cdot\frac{e^{k/K}-1}{e-1})</annotation></semantics></math>;

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8:</span>        <math id="alg2.l8.m1.4" class="ltx_Math" alttext="\mathcal{L}_{m}=M_{m}\cdot\ell(f_{c}(F_{h}),y_{m})+\ell(f_{aux}(F_{h}),y_{m})" display="inline"><semantics id="alg2.l8.m1.4a"><mrow id="alg2.l8.m1.4.4" xref="alg2.l8.m1.4.4.cmml"><msub id="alg2.l8.m1.4.4.6" xref="alg2.l8.m1.4.4.6.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.4.4.6.2" xref="alg2.l8.m1.4.4.6.2.cmml">ℒ</mi><mi id="alg2.l8.m1.4.4.6.3" xref="alg2.l8.m1.4.4.6.3.cmml">m</mi></msub><mo id="alg2.l8.m1.4.4.5" xref="alg2.l8.m1.4.4.5.cmml">=</mo><mrow id="alg2.l8.m1.4.4.4" xref="alg2.l8.m1.4.4.4.cmml"><mrow id="alg2.l8.m1.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.cmml"><mrow id="alg2.l8.m1.2.2.2.2.4" xref="alg2.l8.m1.2.2.2.2.4.cmml"><msub id="alg2.l8.m1.2.2.2.2.4.2" xref="alg2.l8.m1.2.2.2.2.4.2.cmml"><mi id="alg2.l8.m1.2.2.2.2.4.2.2" xref="alg2.l8.m1.2.2.2.2.4.2.2.cmml">M</mi><mi id="alg2.l8.m1.2.2.2.2.4.2.3" xref="alg2.l8.m1.2.2.2.2.4.2.3.cmml">m</mi></msub><mo lspace="0.222em" rspace="0.222em" id="alg2.l8.m1.2.2.2.2.4.1" xref="alg2.l8.m1.2.2.2.2.4.1.cmml">⋅</mo><mi mathvariant="normal" id="alg2.l8.m1.2.2.2.2.4.3" xref="alg2.l8.m1.2.2.2.2.4.3.cmml">ℓ</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.2.2.2.3" xref="alg2.l8.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg2.l8.m1.2.2.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l8.m1.2.2.2.2.2.2.3" xref="alg2.l8.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="alg2.l8.m1.1.1.1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.1.1.1.cmml"><msub id="alg2.l8.m1.1.1.1.1.1.1.1.3" xref="alg2.l8.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l8.m1.1.1.1.1.1.1.1.3.2" xref="alg2.l8.m1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="alg2.l8.m1.1.1.1.1.1.1.1.3.3" xref="alg2.l8.m1.1.1.1.1.1.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.1.1.1.1.1.2" xref="alg2.l8.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l8.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l8.m1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">F</mi><mi id="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">h</mi></msub><mo stretchy="false" id="alg2.l8.m1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l8.m1.2.2.2.2.2.2.4" xref="alg2.l8.m1.2.2.2.2.2.3.cmml">,</mo><msub id="alg2.l8.m1.2.2.2.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.2.2.2.cmml"><mi id="alg2.l8.m1.2.2.2.2.2.2.2.2" xref="alg2.l8.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg2.l8.m1.2.2.2.2.2.2.2.3" xref="alg2.l8.m1.2.2.2.2.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="alg2.l8.m1.2.2.2.2.2.2.5" xref="alg2.l8.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="alg2.l8.m1.4.4.4.5" xref="alg2.l8.m1.4.4.4.5.cmml">+</mo><mrow id="alg2.l8.m1.4.4.4.4" xref="alg2.l8.m1.4.4.4.4.cmml"><mi mathvariant="normal" id="alg2.l8.m1.4.4.4.4.4" xref="alg2.l8.m1.4.4.4.4.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.4.4.4.4.3" xref="alg2.l8.m1.4.4.4.4.3.cmml">​</mo><mrow id="alg2.l8.m1.4.4.4.4.2.2" xref="alg2.l8.m1.4.4.4.4.2.3.cmml"><mo stretchy="false" id="alg2.l8.m1.4.4.4.4.2.2.3" xref="alg2.l8.m1.4.4.4.4.2.3.cmml">(</mo><mrow id="alg2.l8.m1.3.3.3.3.1.1.1" xref="alg2.l8.m1.3.3.3.3.1.1.1.cmml"><msub id="alg2.l8.m1.3.3.3.3.1.1.1.3" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.cmml"><mi id="alg2.l8.m1.3.3.3.3.1.1.1.3.2" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.2.cmml">f</mi><mrow id="alg2.l8.m1.3.3.3.3.1.1.1.3.3" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3.cmml"><mi id="alg2.l8.m1.3.3.3.3.1.1.1.3.3.2" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.3.3.3.3.1.1.1.3.3.1" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3.1.cmml">​</mo><mi id="alg2.l8.m1.3.3.3.3.1.1.1.3.3.3" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.3.3.3.3.1.1.1.3.3.1a" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3.1.cmml">​</mo><mi id="alg2.l8.m1.3.3.3.3.1.1.1.3.3.4" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3.4.cmml">x</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg2.l8.m1.3.3.3.3.1.1.1.2" xref="alg2.l8.m1.3.3.3.3.1.1.1.2.cmml">​</mo><mrow id="alg2.l8.m1.3.3.3.3.1.1.1.1.1" xref="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l8.m1.3.3.3.3.1.1.1.1.1.2" xref="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1" xref="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.2" xref="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.2.cmml">F</mi><mi id="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.3" xref="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.3.cmml">h</mi></msub><mo stretchy="false" id="alg2.l8.m1.3.3.3.3.1.1.1.1.1.3" xref="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l8.m1.4.4.4.4.2.2.4" xref="alg2.l8.m1.4.4.4.4.2.3.cmml">,</mo><msub id="alg2.l8.m1.4.4.4.4.2.2.2" xref="alg2.l8.m1.4.4.4.4.2.2.2.cmml"><mi id="alg2.l8.m1.4.4.4.4.2.2.2.2" xref="alg2.l8.m1.4.4.4.4.2.2.2.2.cmml">y</mi><mi id="alg2.l8.m1.4.4.4.4.2.2.2.3" xref="alg2.l8.m1.4.4.4.4.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="alg2.l8.m1.4.4.4.4.2.2.5" xref="alg2.l8.m1.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.4b"><apply id="alg2.l8.m1.4.4.cmml" xref="alg2.l8.m1.4.4"><eq id="alg2.l8.m1.4.4.5.cmml" xref="alg2.l8.m1.4.4.5"></eq><apply id="alg2.l8.m1.4.4.6.cmml" xref="alg2.l8.m1.4.4.6"><csymbol cd="ambiguous" id="alg2.l8.m1.4.4.6.1.cmml" xref="alg2.l8.m1.4.4.6">subscript</csymbol><ci id="alg2.l8.m1.4.4.6.2.cmml" xref="alg2.l8.m1.4.4.6.2">ℒ</ci><ci id="alg2.l8.m1.4.4.6.3.cmml" xref="alg2.l8.m1.4.4.6.3">𝑚</ci></apply><apply id="alg2.l8.m1.4.4.4.cmml" xref="alg2.l8.m1.4.4.4"><plus id="alg2.l8.m1.4.4.4.5.cmml" xref="alg2.l8.m1.4.4.4.5"></plus><apply id="alg2.l8.m1.2.2.2.2.cmml" xref="alg2.l8.m1.2.2.2.2"><times id="alg2.l8.m1.2.2.2.2.3.cmml" xref="alg2.l8.m1.2.2.2.2.3"></times><apply id="alg2.l8.m1.2.2.2.2.4.cmml" xref="alg2.l8.m1.2.2.2.2.4"><ci id="alg2.l8.m1.2.2.2.2.4.1.cmml" xref="alg2.l8.m1.2.2.2.2.4.1">⋅</ci><apply id="alg2.l8.m1.2.2.2.2.4.2.cmml" xref="alg2.l8.m1.2.2.2.2.4.2"><csymbol cd="ambiguous" id="alg2.l8.m1.2.2.2.2.4.2.1.cmml" xref="alg2.l8.m1.2.2.2.2.4.2">subscript</csymbol><ci id="alg2.l8.m1.2.2.2.2.4.2.2.cmml" xref="alg2.l8.m1.2.2.2.2.4.2.2">𝑀</ci><ci id="alg2.l8.m1.2.2.2.2.4.2.3.cmml" xref="alg2.l8.m1.2.2.2.2.4.2.3">𝑚</ci></apply><ci id="alg2.l8.m1.2.2.2.2.4.3.cmml" xref="alg2.l8.m1.2.2.2.2.4.3">ℓ</ci></apply><interval closure="open" id="alg2.l8.m1.2.2.2.2.2.3.cmml" xref="alg2.l8.m1.2.2.2.2.2.2"><apply id="alg2.l8.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1"><times id="alg2.l8.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1.2"></times><apply id="alg2.l8.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l8.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="alg2.l8.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1.3.3">𝑐</ci></apply><apply id="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.2">𝐹</ci><ci id="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l8.m1.1.1.1.1.1.1.1.1.1.1.3">ℎ</ci></apply></apply><apply id="alg2.l8.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l8.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.2.2.2.2.2.2.2.1.cmml" xref="alg2.l8.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg2.l8.m1.2.2.2.2.2.2.2.2.cmml" xref="alg2.l8.m1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="alg2.l8.m1.2.2.2.2.2.2.2.3.cmml" xref="alg2.l8.m1.2.2.2.2.2.2.2.3">𝑚</ci></apply></interval></apply><apply id="alg2.l8.m1.4.4.4.4.cmml" xref="alg2.l8.m1.4.4.4.4"><times id="alg2.l8.m1.4.4.4.4.3.cmml" xref="alg2.l8.m1.4.4.4.4.3"></times><ci id="alg2.l8.m1.4.4.4.4.4.cmml" xref="alg2.l8.m1.4.4.4.4.4">ℓ</ci><interval closure="open" id="alg2.l8.m1.4.4.4.4.2.3.cmml" xref="alg2.l8.m1.4.4.4.4.2.2"><apply id="alg2.l8.m1.3.3.3.3.1.1.1.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1"><times id="alg2.l8.m1.3.3.3.3.1.1.1.2.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.2"></times><apply id="alg2.l8.m1.3.3.3.3.1.1.1.3.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l8.m1.3.3.3.3.1.1.1.3.1.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.3">subscript</csymbol><ci id="alg2.l8.m1.3.3.3.3.1.1.1.3.2.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.2">𝑓</ci><apply id="alg2.l8.m1.3.3.3.3.1.1.1.3.3.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3"><times id="alg2.l8.m1.3.3.3.3.1.1.1.3.3.1.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3.1"></times><ci id="alg2.l8.m1.3.3.3.3.1.1.1.3.3.2.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3.2">𝑎</ci><ci id="alg2.l8.m1.3.3.3.3.1.1.1.3.3.3.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3.3">𝑢</ci><ci id="alg2.l8.m1.3.3.3.3.1.1.1.3.3.4.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.3.3.4">𝑥</ci></apply></apply><apply id="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.2">𝐹</ci><ci id="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="alg2.l8.m1.3.3.3.3.1.1.1.1.1.1.3">ℎ</ci></apply></apply><apply id="alg2.l8.m1.4.4.4.4.2.2.2.cmml" xref="alg2.l8.m1.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.4.4.4.4.2.2.2.1.cmml" xref="alg2.l8.m1.4.4.4.4.2.2.2">subscript</csymbol><ci id="alg2.l8.m1.4.4.4.4.2.2.2.2.cmml" xref="alg2.l8.m1.4.4.4.4.2.2.2.2">𝑦</ci><ci id="alg2.l8.m1.4.4.4.4.2.2.2.3.cmml" xref="alg2.l8.m1.4.4.4.4.2.2.2.3">𝑚</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.4c">\mathcal{L}_{m}=M_{m}\cdot\ell(f_{c}(F_{h}),y_{m})+\ell(f_{aux}(F_{h}),y_{m})</annotation></semantics></math>;
</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9:</span>        // Local site update

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10:</span>        <math id="alg2.l10.m1.6" class="ltx_Math" alttext="W_{s,m}^{k+1}\leftarrow W_{s,m}^{k}-lr\cdot\nabla_{W_{s,m}^{k}}\mathcal{L}_{m}" display="inline"><semantics id="alg2.l10.m1.6a"><mrow id="alg2.l10.m1.6.7" xref="alg2.l10.m1.6.7.cmml"><msubsup id="alg2.l10.m1.6.7.2" xref="alg2.l10.m1.6.7.2.cmml"><mi id="alg2.l10.m1.6.7.2.2.2" xref="alg2.l10.m1.6.7.2.2.2.cmml">W</mi><mrow id="alg2.l10.m1.2.2.2.4" xref="alg2.l10.m1.2.2.2.3.cmml"><mi id="alg2.l10.m1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.cmml">s</mi><mo id="alg2.l10.m1.2.2.2.4.1" xref="alg2.l10.m1.2.2.2.3.cmml">,</mo><mi id="alg2.l10.m1.2.2.2.2" xref="alg2.l10.m1.2.2.2.2.cmml">m</mi></mrow><mrow id="alg2.l10.m1.6.7.2.3" xref="alg2.l10.m1.6.7.2.3.cmml"><mi id="alg2.l10.m1.6.7.2.3.2" xref="alg2.l10.m1.6.7.2.3.2.cmml">k</mi><mo id="alg2.l10.m1.6.7.2.3.1" xref="alg2.l10.m1.6.7.2.3.1.cmml">+</mo><mn id="alg2.l10.m1.6.7.2.3.3" xref="alg2.l10.m1.6.7.2.3.3.cmml">1</mn></mrow></msubsup><mo stretchy="false" id="alg2.l10.m1.6.7.1" xref="alg2.l10.m1.6.7.1.cmml">←</mo><mrow id="alg2.l10.m1.6.7.3" xref="alg2.l10.m1.6.7.3.cmml"><msubsup id="alg2.l10.m1.6.7.3.2" xref="alg2.l10.m1.6.7.3.2.cmml"><mi id="alg2.l10.m1.6.7.3.2.2.2" xref="alg2.l10.m1.6.7.3.2.2.2.cmml">W</mi><mrow id="alg2.l10.m1.4.4.2.4" xref="alg2.l10.m1.4.4.2.3.cmml"><mi id="alg2.l10.m1.3.3.1.1" xref="alg2.l10.m1.3.3.1.1.cmml">s</mi><mo id="alg2.l10.m1.4.4.2.4.1" xref="alg2.l10.m1.4.4.2.3.cmml">,</mo><mi id="alg2.l10.m1.4.4.2.2" xref="alg2.l10.m1.4.4.2.2.cmml">m</mi></mrow><mi id="alg2.l10.m1.6.7.3.2.3" xref="alg2.l10.m1.6.7.3.2.3.cmml">k</mi></msubsup><mo id="alg2.l10.m1.6.7.3.1" xref="alg2.l10.m1.6.7.3.1.cmml">−</mo><mrow id="alg2.l10.m1.6.7.3.3" xref="alg2.l10.m1.6.7.3.3.cmml"><mrow id="alg2.l10.m1.6.7.3.3.2" xref="alg2.l10.m1.6.7.3.3.2.cmml"><mi id="alg2.l10.m1.6.7.3.3.2.2" xref="alg2.l10.m1.6.7.3.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l10.m1.6.7.3.3.2.1" xref="alg2.l10.m1.6.7.3.3.2.1.cmml">​</mo><mi id="alg2.l10.m1.6.7.3.3.2.3" xref="alg2.l10.m1.6.7.3.3.2.3.cmml">r</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="alg2.l10.m1.6.7.3.3.1" xref="alg2.l10.m1.6.7.3.3.1.cmml">⋅</mo><mrow id="alg2.l10.m1.6.7.3.3.3" xref="alg2.l10.m1.6.7.3.3.3.cmml"><msub id="alg2.l10.m1.6.7.3.3.3.1" xref="alg2.l10.m1.6.7.3.3.3.1.cmml"><mo rspace="0.167em" id="alg2.l10.m1.6.7.3.3.3.1.2" xref="alg2.l10.m1.6.7.3.3.3.1.2.cmml">∇</mo><msubsup id="alg2.l10.m1.6.6.2" xref="alg2.l10.m1.6.6.2.cmml"><mi id="alg2.l10.m1.6.6.2.4.2" xref="alg2.l10.m1.6.6.2.4.2.cmml">W</mi><mrow id="alg2.l10.m1.6.6.2.2.2.4" xref="alg2.l10.m1.6.6.2.2.2.3.cmml"><mi id="alg2.l10.m1.5.5.1.1.1.1" xref="alg2.l10.m1.5.5.1.1.1.1.cmml">s</mi><mo id="alg2.l10.m1.6.6.2.2.2.4.1" xref="alg2.l10.m1.6.6.2.2.2.3.cmml">,</mo><mi id="alg2.l10.m1.6.6.2.2.2.2" xref="alg2.l10.m1.6.6.2.2.2.2.cmml">m</mi></mrow><mi id="alg2.l10.m1.6.6.2.5" xref="alg2.l10.m1.6.6.2.5.cmml">k</mi></msubsup></msub><msub id="alg2.l10.m1.6.7.3.3.3.2" xref="alg2.l10.m1.6.7.3.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l10.m1.6.7.3.3.3.2.2" xref="alg2.l10.m1.6.7.3.3.3.2.2.cmml">ℒ</mi><mi id="alg2.l10.m1.6.7.3.3.3.2.3" xref="alg2.l10.m1.6.7.3.3.3.2.3.cmml">m</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.6b"><apply id="alg2.l10.m1.6.7.cmml" xref="alg2.l10.m1.6.7"><ci id="alg2.l10.m1.6.7.1.cmml" xref="alg2.l10.m1.6.7.1">←</ci><apply id="alg2.l10.m1.6.7.2.cmml" xref="alg2.l10.m1.6.7.2"><csymbol cd="ambiguous" id="alg2.l10.m1.6.7.2.1.cmml" xref="alg2.l10.m1.6.7.2">superscript</csymbol><apply id="alg2.l10.m1.6.7.2.2.cmml" xref="alg2.l10.m1.6.7.2"><csymbol cd="ambiguous" id="alg2.l10.m1.6.7.2.2.1.cmml" xref="alg2.l10.m1.6.7.2">subscript</csymbol><ci id="alg2.l10.m1.6.7.2.2.2.cmml" xref="alg2.l10.m1.6.7.2.2.2">𝑊</ci><list id="alg2.l10.m1.2.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.4"><ci id="alg2.l10.m1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1">𝑠</ci><ci id="alg2.l10.m1.2.2.2.2.cmml" xref="alg2.l10.m1.2.2.2.2">𝑚</ci></list></apply><apply id="alg2.l10.m1.6.7.2.3.cmml" xref="alg2.l10.m1.6.7.2.3"><plus id="alg2.l10.m1.6.7.2.3.1.cmml" xref="alg2.l10.m1.6.7.2.3.1"></plus><ci id="alg2.l10.m1.6.7.2.3.2.cmml" xref="alg2.l10.m1.6.7.2.3.2">𝑘</ci><cn type="integer" id="alg2.l10.m1.6.7.2.3.3.cmml" xref="alg2.l10.m1.6.7.2.3.3">1</cn></apply></apply><apply id="alg2.l10.m1.6.7.3.cmml" xref="alg2.l10.m1.6.7.3"><minus id="alg2.l10.m1.6.7.3.1.cmml" xref="alg2.l10.m1.6.7.3.1"></minus><apply id="alg2.l10.m1.6.7.3.2.cmml" xref="alg2.l10.m1.6.7.3.2"><csymbol cd="ambiguous" id="alg2.l10.m1.6.7.3.2.1.cmml" xref="alg2.l10.m1.6.7.3.2">superscript</csymbol><apply id="alg2.l10.m1.6.7.3.2.2.cmml" xref="alg2.l10.m1.6.7.3.2"><csymbol cd="ambiguous" id="alg2.l10.m1.6.7.3.2.2.1.cmml" xref="alg2.l10.m1.6.7.3.2">subscript</csymbol><ci id="alg2.l10.m1.6.7.3.2.2.2.cmml" xref="alg2.l10.m1.6.7.3.2.2.2">𝑊</ci><list id="alg2.l10.m1.4.4.2.3.cmml" xref="alg2.l10.m1.4.4.2.4"><ci id="alg2.l10.m1.3.3.1.1.cmml" xref="alg2.l10.m1.3.3.1.1">𝑠</ci><ci id="alg2.l10.m1.4.4.2.2.cmml" xref="alg2.l10.m1.4.4.2.2">𝑚</ci></list></apply><ci id="alg2.l10.m1.6.7.3.2.3.cmml" xref="alg2.l10.m1.6.7.3.2.3">𝑘</ci></apply><apply id="alg2.l10.m1.6.7.3.3.cmml" xref="alg2.l10.m1.6.7.3.3"><ci id="alg2.l10.m1.6.7.3.3.1.cmml" xref="alg2.l10.m1.6.7.3.3.1">⋅</ci><apply id="alg2.l10.m1.6.7.3.3.2.cmml" xref="alg2.l10.m1.6.7.3.3.2"><times id="alg2.l10.m1.6.7.3.3.2.1.cmml" xref="alg2.l10.m1.6.7.3.3.2.1"></times><ci id="alg2.l10.m1.6.7.3.3.2.2.cmml" xref="alg2.l10.m1.6.7.3.3.2.2">𝑙</ci><ci id="alg2.l10.m1.6.7.3.3.2.3.cmml" xref="alg2.l10.m1.6.7.3.3.2.3">𝑟</ci></apply><apply id="alg2.l10.m1.6.7.3.3.3.cmml" xref="alg2.l10.m1.6.7.3.3.3"><apply id="alg2.l10.m1.6.7.3.3.3.1.cmml" xref="alg2.l10.m1.6.7.3.3.3.1"><csymbol cd="ambiguous" id="alg2.l10.m1.6.7.3.3.3.1.1.cmml" xref="alg2.l10.m1.6.7.3.3.3.1">subscript</csymbol><ci id="alg2.l10.m1.6.7.3.3.3.1.2.cmml" xref="alg2.l10.m1.6.7.3.3.3.1.2">∇</ci><apply id="alg2.l10.m1.6.6.2.cmml" xref="alg2.l10.m1.6.6.2"><csymbol cd="ambiguous" id="alg2.l10.m1.6.6.2.3.cmml" xref="alg2.l10.m1.6.6.2">superscript</csymbol><apply id="alg2.l10.m1.6.6.2.4.cmml" xref="alg2.l10.m1.6.6.2"><csymbol cd="ambiguous" id="alg2.l10.m1.6.6.2.4.1.cmml" xref="alg2.l10.m1.6.6.2">subscript</csymbol><ci id="alg2.l10.m1.6.6.2.4.2.cmml" xref="alg2.l10.m1.6.6.2.4.2">𝑊</ci><list id="alg2.l10.m1.6.6.2.2.2.3.cmml" xref="alg2.l10.m1.6.6.2.2.2.4"><ci id="alg2.l10.m1.5.5.1.1.1.1.cmml" xref="alg2.l10.m1.5.5.1.1.1.1">𝑠</ci><ci id="alg2.l10.m1.6.6.2.2.2.2.cmml" xref="alg2.l10.m1.6.6.2.2.2.2">𝑚</ci></list></apply><ci id="alg2.l10.m1.6.6.2.5.cmml" xref="alg2.l10.m1.6.6.2.5">𝑘</ci></apply></apply><apply id="alg2.l10.m1.6.7.3.3.3.2.cmml" xref="alg2.l10.m1.6.7.3.3.3.2"><csymbol cd="ambiguous" id="alg2.l10.m1.6.7.3.3.3.2.1.cmml" xref="alg2.l10.m1.6.7.3.3.3.2">subscript</csymbol><ci id="alg2.l10.m1.6.7.3.3.3.2.2.cmml" xref="alg2.l10.m1.6.7.3.3.3.2.2">ℒ</ci><ci id="alg2.l10.m1.6.7.3.3.3.2.3.cmml" xref="alg2.l10.m1.6.7.3.3.3.2.3">𝑚</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.6c">W_{s,m}^{k+1}\leftarrow W_{s,m}^{k}-lr\cdot\nabla_{W_{s,m}^{k}}\mathcal{L}_{m}</annotation></semantics></math>;

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11:</span>     <span id="alg2.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12:</span>     <span id="alg2.l12.1" class="ltx_text ltx_font_bold">if</span> <math id="alg2.l12.m1.1" class="ltx_Math" alttext="(k+1)\mod E=0" display="inline"><semantics id="alg2.l12.m1.1a"><mrow id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mrow id="alg2.l12.m1.1.1.1" xref="alg2.l12.m1.1.1.1.cmml"><mrow id="alg2.l12.m1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l12.m1.1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l12.m1.1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l12.m1.1.1.1.1.1.1.2" xref="alg2.l12.m1.1.1.1.1.1.1.2.cmml">k</mi><mo id="alg2.l12.m1.1.1.1.1.1.1.1" xref="alg2.l12.m1.1.1.1.1.1.1.1.cmml">+</mo><mn id="alg2.l12.m1.1.1.1.1.1.1.3" xref="alg2.l12.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg2.l12.m1.1.1.1.1.1.3" xref="alg2.l12.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.l12.m1.1.1.1.2" xref="alg2.l12.m1.1.1.1.2.cmml">mod</mo><mi id="alg2.l12.m1.1.1.1.3" xref="alg2.l12.m1.1.1.1.3.cmml">E</mi></mrow><mo id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml">=</mo><mn id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><eq id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2"></eq><apply id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1"><csymbol cd="latexml" id="alg2.l12.m1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.2">modulo</csymbol><apply id="alg2.l12.m1.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1.1"><plus id="alg2.l12.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.1"></plus><ci id="alg2.l12.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.2">𝑘</ci><cn type="integer" id="alg2.l12.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l12.m1.1.1.1.1.1.1.3">1</cn></apply><ci id="alg2.l12.m1.1.1.1.3.cmml" xref="alg2.l12.m1.1.1.1.3">𝐸</ci></apply><cn type="integer" id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">(k+1)\mod E=0</annotation></semantics></math> <span id="alg2.l12.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13:</span>        // Server site update 
</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14:</span>        <span id="alg2.l14.1" class="ltx_text ltx_font_bold">for</span> each layer <math id="alg2.l14.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="alg2.l14.m1.1a"><mi id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><ci id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">l</annotation></semantics></math> in point transformer <span id="alg2.l14.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15:</span>           <span id="alg2.l15.1" class="ltx_text ltx_font_bold">if</span> <math id="alg2.l15.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="alg2.l15.m1.1a"><mi id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><ci id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">l</annotation></semantics></math> is not the auxiliary classifier’s layer <span id="alg2.l15.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16:</span>              <math id="alg2.l16.m1.8" class="ltx_Math" alttext="W_{s}^{k+1,l}\leftarrow\sum_{m=1}^{M}{\frac{|\mathcal{P}_{i}|}{|\mathcal{P}|}W_{s,m}^{k+1,l}}" display="inline"><semantics id="alg2.l16.m1.8a"><mrow id="alg2.l16.m1.8.9" xref="alg2.l16.m1.8.9.cmml"><msubsup id="alg2.l16.m1.8.9.2" xref="alg2.l16.m1.8.9.2.cmml"><mi id="alg2.l16.m1.8.9.2.2.2" xref="alg2.l16.m1.8.9.2.2.2.cmml">W</mi><mi id="alg2.l16.m1.8.9.2.2.3" xref="alg2.l16.m1.8.9.2.2.3.cmml">s</mi><mrow id="alg2.l16.m1.2.2.2.2" xref="alg2.l16.m1.2.2.2.3.cmml"><mrow id="alg2.l16.m1.2.2.2.2.1" xref="alg2.l16.m1.2.2.2.2.1.cmml"><mi id="alg2.l16.m1.2.2.2.2.1.2" xref="alg2.l16.m1.2.2.2.2.1.2.cmml">k</mi><mo id="alg2.l16.m1.2.2.2.2.1.1" xref="alg2.l16.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg2.l16.m1.2.2.2.2.1.3" xref="alg2.l16.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="alg2.l16.m1.2.2.2.2.2" xref="alg2.l16.m1.2.2.2.3.cmml">,</mo><mi id="alg2.l16.m1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.cmml">l</mi></mrow></msubsup><mo rspace="0.111em" stretchy="false" id="alg2.l16.m1.8.9.1" xref="alg2.l16.m1.8.9.1.cmml">←</mo><mrow id="alg2.l16.m1.8.9.3" xref="alg2.l16.m1.8.9.3.cmml"><msubsup id="alg2.l16.m1.8.9.3.1" xref="alg2.l16.m1.8.9.3.1.cmml"><mo id="alg2.l16.m1.8.9.3.1.2.2" xref="alg2.l16.m1.8.9.3.1.2.2.cmml">∑</mo><mrow id="alg2.l16.m1.8.9.3.1.2.3" xref="alg2.l16.m1.8.9.3.1.2.3.cmml"><mi id="alg2.l16.m1.8.9.3.1.2.3.2" xref="alg2.l16.m1.8.9.3.1.2.3.2.cmml">m</mi><mo id="alg2.l16.m1.8.9.3.1.2.3.1" xref="alg2.l16.m1.8.9.3.1.2.3.1.cmml">=</mo><mn id="alg2.l16.m1.8.9.3.1.2.3.3" xref="alg2.l16.m1.8.9.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg2.l16.m1.8.9.3.1.3" xref="alg2.l16.m1.8.9.3.1.3.cmml">M</mi></msubsup><mrow id="alg2.l16.m1.8.9.3.2" xref="alg2.l16.m1.8.9.3.2.cmml"><mfrac id="alg2.l16.m1.4.4" xref="alg2.l16.m1.4.4.cmml"><mrow id="alg2.l16.m1.3.3.1.1" xref="alg2.l16.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg2.l16.m1.3.3.1.1.2" xref="alg2.l16.m1.3.3.1.2.1.cmml">|</mo><msub id="alg2.l16.m1.3.3.1.1.1" xref="alg2.l16.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l16.m1.3.3.1.1.1.2" xref="alg2.l16.m1.3.3.1.1.1.2.cmml">𝒫</mi><mi id="alg2.l16.m1.3.3.1.1.1.3" xref="alg2.l16.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="alg2.l16.m1.3.3.1.1.3" xref="alg2.l16.m1.3.3.1.2.1.cmml">|</mo></mrow><mrow id="alg2.l16.m1.4.4.2.3" xref="alg2.l16.m1.4.4.2.2.cmml"><mo stretchy="false" id="alg2.l16.m1.4.4.2.3.1" xref="alg2.l16.m1.4.4.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l16.m1.4.4.2.1" xref="alg2.l16.m1.4.4.2.1.cmml">𝒫</mi><mo stretchy="false" id="alg2.l16.m1.4.4.2.3.2" xref="alg2.l16.m1.4.4.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg2.l16.m1.8.9.3.2.1" xref="alg2.l16.m1.8.9.3.2.1.cmml">​</mo><msubsup id="alg2.l16.m1.8.9.3.2.2" xref="alg2.l16.m1.8.9.3.2.2.cmml"><mi id="alg2.l16.m1.8.9.3.2.2.2.2" xref="alg2.l16.m1.8.9.3.2.2.2.2.cmml">W</mi><mrow id="alg2.l16.m1.6.6.2.4" xref="alg2.l16.m1.6.6.2.3.cmml"><mi id="alg2.l16.m1.5.5.1.1" xref="alg2.l16.m1.5.5.1.1.cmml">s</mi><mo id="alg2.l16.m1.6.6.2.4.1" xref="alg2.l16.m1.6.6.2.3.cmml">,</mo><mi id="alg2.l16.m1.6.6.2.2" xref="alg2.l16.m1.6.6.2.2.cmml">m</mi></mrow><mrow id="alg2.l16.m1.8.8.2.2" xref="alg2.l16.m1.8.8.2.3.cmml"><mrow id="alg2.l16.m1.8.8.2.2.1" xref="alg2.l16.m1.8.8.2.2.1.cmml"><mi id="alg2.l16.m1.8.8.2.2.1.2" xref="alg2.l16.m1.8.8.2.2.1.2.cmml">k</mi><mo id="alg2.l16.m1.8.8.2.2.1.1" xref="alg2.l16.m1.8.8.2.2.1.1.cmml">+</mo><mn id="alg2.l16.m1.8.8.2.2.1.3" xref="alg2.l16.m1.8.8.2.2.1.3.cmml">1</mn></mrow><mo id="alg2.l16.m1.8.8.2.2.2" xref="alg2.l16.m1.8.8.2.3.cmml">,</mo><mi id="alg2.l16.m1.7.7.1.1" xref="alg2.l16.m1.7.7.1.1.cmml">l</mi></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.8b"><apply id="alg2.l16.m1.8.9.cmml" xref="alg2.l16.m1.8.9"><ci id="alg2.l16.m1.8.9.1.cmml" xref="alg2.l16.m1.8.9.1">←</ci><apply id="alg2.l16.m1.8.9.2.cmml" xref="alg2.l16.m1.8.9.2"><csymbol cd="ambiguous" id="alg2.l16.m1.8.9.2.1.cmml" xref="alg2.l16.m1.8.9.2">superscript</csymbol><apply id="alg2.l16.m1.8.9.2.2.cmml" xref="alg2.l16.m1.8.9.2"><csymbol cd="ambiguous" id="alg2.l16.m1.8.9.2.2.1.cmml" xref="alg2.l16.m1.8.9.2">subscript</csymbol><ci id="alg2.l16.m1.8.9.2.2.2.cmml" xref="alg2.l16.m1.8.9.2.2.2">𝑊</ci><ci id="alg2.l16.m1.8.9.2.2.3.cmml" xref="alg2.l16.m1.8.9.2.2.3">𝑠</ci></apply><list id="alg2.l16.m1.2.2.2.3.cmml" xref="alg2.l16.m1.2.2.2.2"><apply id="alg2.l16.m1.2.2.2.2.1.cmml" xref="alg2.l16.m1.2.2.2.2.1"><plus id="alg2.l16.m1.2.2.2.2.1.1.cmml" xref="alg2.l16.m1.2.2.2.2.1.1"></plus><ci id="alg2.l16.m1.2.2.2.2.1.2.cmml" xref="alg2.l16.m1.2.2.2.2.1.2">𝑘</ci><cn type="integer" id="alg2.l16.m1.2.2.2.2.1.3.cmml" xref="alg2.l16.m1.2.2.2.2.1.3">1</cn></apply><ci id="alg2.l16.m1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1">𝑙</ci></list></apply><apply id="alg2.l16.m1.8.9.3.cmml" xref="alg2.l16.m1.8.9.3"><apply id="alg2.l16.m1.8.9.3.1.cmml" xref="alg2.l16.m1.8.9.3.1"><csymbol cd="ambiguous" id="alg2.l16.m1.8.9.3.1.1.cmml" xref="alg2.l16.m1.8.9.3.1">superscript</csymbol><apply id="alg2.l16.m1.8.9.3.1.2.cmml" xref="alg2.l16.m1.8.9.3.1"><csymbol cd="ambiguous" id="alg2.l16.m1.8.9.3.1.2.1.cmml" xref="alg2.l16.m1.8.9.3.1">subscript</csymbol><sum id="alg2.l16.m1.8.9.3.1.2.2.cmml" xref="alg2.l16.m1.8.9.3.1.2.2"></sum><apply id="alg2.l16.m1.8.9.3.1.2.3.cmml" xref="alg2.l16.m1.8.9.3.1.2.3"><eq id="alg2.l16.m1.8.9.3.1.2.3.1.cmml" xref="alg2.l16.m1.8.9.3.1.2.3.1"></eq><ci id="alg2.l16.m1.8.9.3.1.2.3.2.cmml" xref="alg2.l16.m1.8.9.3.1.2.3.2">𝑚</ci><cn type="integer" id="alg2.l16.m1.8.9.3.1.2.3.3.cmml" xref="alg2.l16.m1.8.9.3.1.2.3.3">1</cn></apply></apply><ci id="alg2.l16.m1.8.9.3.1.3.cmml" xref="alg2.l16.m1.8.9.3.1.3">𝑀</ci></apply><apply id="alg2.l16.m1.8.9.3.2.cmml" xref="alg2.l16.m1.8.9.3.2"><times id="alg2.l16.m1.8.9.3.2.1.cmml" xref="alg2.l16.m1.8.9.3.2.1"></times><apply id="alg2.l16.m1.4.4.cmml" xref="alg2.l16.m1.4.4"><divide id="alg2.l16.m1.4.4.3.cmml" xref="alg2.l16.m1.4.4"></divide><apply id="alg2.l16.m1.3.3.1.2.cmml" xref="alg2.l16.m1.3.3.1.1"><abs id="alg2.l16.m1.3.3.1.2.1.cmml" xref="alg2.l16.m1.3.3.1.1.2"></abs><apply id="alg2.l16.m1.3.3.1.1.1.cmml" xref="alg2.l16.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.3.3.1.1.1.1.cmml" xref="alg2.l16.m1.3.3.1.1.1">subscript</csymbol><ci id="alg2.l16.m1.3.3.1.1.1.2.cmml" xref="alg2.l16.m1.3.3.1.1.1.2">𝒫</ci><ci id="alg2.l16.m1.3.3.1.1.1.3.cmml" xref="alg2.l16.m1.3.3.1.1.1.3">𝑖</ci></apply></apply><apply id="alg2.l16.m1.4.4.2.2.cmml" xref="alg2.l16.m1.4.4.2.3"><abs id="alg2.l16.m1.4.4.2.2.1.cmml" xref="alg2.l16.m1.4.4.2.3.1"></abs><ci id="alg2.l16.m1.4.4.2.1.cmml" xref="alg2.l16.m1.4.4.2.1">𝒫</ci></apply></apply><apply id="alg2.l16.m1.8.9.3.2.2.cmml" xref="alg2.l16.m1.8.9.3.2.2"><csymbol cd="ambiguous" id="alg2.l16.m1.8.9.3.2.2.1.cmml" xref="alg2.l16.m1.8.9.3.2.2">superscript</csymbol><apply id="alg2.l16.m1.8.9.3.2.2.2.cmml" xref="alg2.l16.m1.8.9.3.2.2"><csymbol cd="ambiguous" id="alg2.l16.m1.8.9.3.2.2.2.1.cmml" xref="alg2.l16.m1.8.9.3.2.2">subscript</csymbol><ci id="alg2.l16.m1.8.9.3.2.2.2.2.cmml" xref="alg2.l16.m1.8.9.3.2.2.2.2">𝑊</ci><list id="alg2.l16.m1.6.6.2.3.cmml" xref="alg2.l16.m1.6.6.2.4"><ci id="alg2.l16.m1.5.5.1.1.cmml" xref="alg2.l16.m1.5.5.1.1">𝑠</ci><ci id="alg2.l16.m1.6.6.2.2.cmml" xref="alg2.l16.m1.6.6.2.2">𝑚</ci></list></apply><list id="alg2.l16.m1.8.8.2.3.cmml" xref="alg2.l16.m1.8.8.2.2"><apply id="alg2.l16.m1.8.8.2.2.1.cmml" xref="alg2.l16.m1.8.8.2.2.1"><plus id="alg2.l16.m1.8.8.2.2.1.1.cmml" xref="alg2.l16.m1.8.8.2.2.1.1"></plus><ci id="alg2.l16.m1.8.8.2.2.1.2.cmml" xref="alg2.l16.m1.8.8.2.2.1.2">𝑘</ci><cn type="integer" id="alg2.l16.m1.8.8.2.2.1.3.cmml" xref="alg2.l16.m1.8.8.2.2.1.3">1</cn></apply><ci id="alg2.l16.m1.7.7.1.1.cmml" xref="alg2.l16.m1.7.7.1.1">𝑙</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.8c">W_{s}^{k+1,l}\leftarrow\sum_{m=1}^{M}{\frac{|\mathcal{P}_{i}|}{|\mathcal{P}|}W_{s,m}^{k+1,l}}</annotation></semantics></math>;
</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17:</span>              <math id="alg2.l17.m1.6" class="ltx_Math" alttext="W_{s,m}^{k+1,l}\leftarrow W_{s}^{k+1,l}" display="inline"><semantics id="alg2.l17.m1.6a"><mrow id="alg2.l17.m1.6.7" xref="alg2.l17.m1.6.7.cmml"><msubsup id="alg2.l17.m1.6.7.2" xref="alg2.l17.m1.6.7.2.cmml"><mi id="alg2.l17.m1.6.7.2.2.2" xref="alg2.l17.m1.6.7.2.2.2.cmml">W</mi><mrow id="alg2.l17.m1.2.2.2.4" xref="alg2.l17.m1.2.2.2.3.cmml"><mi id="alg2.l17.m1.1.1.1.1" xref="alg2.l17.m1.1.1.1.1.cmml">s</mi><mo id="alg2.l17.m1.2.2.2.4.1" xref="alg2.l17.m1.2.2.2.3.cmml">,</mo><mi id="alg2.l17.m1.2.2.2.2" xref="alg2.l17.m1.2.2.2.2.cmml">m</mi></mrow><mrow id="alg2.l17.m1.4.4.2.2" xref="alg2.l17.m1.4.4.2.3.cmml"><mrow id="alg2.l17.m1.4.4.2.2.1" xref="alg2.l17.m1.4.4.2.2.1.cmml"><mi id="alg2.l17.m1.4.4.2.2.1.2" xref="alg2.l17.m1.4.4.2.2.1.2.cmml">k</mi><mo id="alg2.l17.m1.4.4.2.2.1.1" xref="alg2.l17.m1.4.4.2.2.1.1.cmml">+</mo><mn id="alg2.l17.m1.4.4.2.2.1.3" xref="alg2.l17.m1.4.4.2.2.1.3.cmml">1</mn></mrow><mo id="alg2.l17.m1.4.4.2.2.2" xref="alg2.l17.m1.4.4.2.3.cmml">,</mo><mi id="alg2.l17.m1.3.3.1.1" xref="alg2.l17.m1.3.3.1.1.cmml">l</mi></mrow></msubsup><mo stretchy="false" id="alg2.l17.m1.6.7.1" xref="alg2.l17.m1.6.7.1.cmml">←</mo><msubsup id="alg2.l17.m1.6.7.3" xref="alg2.l17.m1.6.7.3.cmml"><mi id="alg2.l17.m1.6.7.3.2.2" xref="alg2.l17.m1.6.7.3.2.2.cmml">W</mi><mi id="alg2.l17.m1.6.7.3.2.3" xref="alg2.l17.m1.6.7.3.2.3.cmml">s</mi><mrow id="alg2.l17.m1.6.6.2.2" xref="alg2.l17.m1.6.6.2.3.cmml"><mrow id="alg2.l17.m1.6.6.2.2.1" xref="alg2.l17.m1.6.6.2.2.1.cmml"><mi id="alg2.l17.m1.6.6.2.2.1.2" xref="alg2.l17.m1.6.6.2.2.1.2.cmml">k</mi><mo id="alg2.l17.m1.6.6.2.2.1.1" xref="alg2.l17.m1.6.6.2.2.1.1.cmml">+</mo><mn id="alg2.l17.m1.6.6.2.2.1.3" xref="alg2.l17.m1.6.6.2.2.1.3.cmml">1</mn></mrow><mo id="alg2.l17.m1.6.6.2.2.2" xref="alg2.l17.m1.6.6.2.3.cmml">,</mo><mi id="alg2.l17.m1.5.5.1.1" xref="alg2.l17.m1.5.5.1.1.cmml">l</mi></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.6b"><apply id="alg2.l17.m1.6.7.cmml" xref="alg2.l17.m1.6.7"><ci id="alg2.l17.m1.6.7.1.cmml" xref="alg2.l17.m1.6.7.1">←</ci><apply id="alg2.l17.m1.6.7.2.cmml" xref="alg2.l17.m1.6.7.2"><csymbol cd="ambiguous" id="alg2.l17.m1.6.7.2.1.cmml" xref="alg2.l17.m1.6.7.2">superscript</csymbol><apply id="alg2.l17.m1.6.7.2.2.cmml" xref="alg2.l17.m1.6.7.2"><csymbol cd="ambiguous" id="alg2.l17.m1.6.7.2.2.1.cmml" xref="alg2.l17.m1.6.7.2">subscript</csymbol><ci id="alg2.l17.m1.6.7.2.2.2.cmml" xref="alg2.l17.m1.6.7.2.2.2">𝑊</ci><list id="alg2.l17.m1.2.2.2.3.cmml" xref="alg2.l17.m1.2.2.2.4"><ci id="alg2.l17.m1.1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1.1">𝑠</ci><ci id="alg2.l17.m1.2.2.2.2.cmml" xref="alg2.l17.m1.2.2.2.2">𝑚</ci></list></apply><list id="alg2.l17.m1.4.4.2.3.cmml" xref="alg2.l17.m1.4.4.2.2"><apply id="alg2.l17.m1.4.4.2.2.1.cmml" xref="alg2.l17.m1.4.4.2.2.1"><plus id="alg2.l17.m1.4.4.2.2.1.1.cmml" xref="alg2.l17.m1.4.4.2.2.1.1"></plus><ci id="alg2.l17.m1.4.4.2.2.1.2.cmml" xref="alg2.l17.m1.4.4.2.2.1.2">𝑘</ci><cn type="integer" id="alg2.l17.m1.4.4.2.2.1.3.cmml" xref="alg2.l17.m1.4.4.2.2.1.3">1</cn></apply><ci id="alg2.l17.m1.3.3.1.1.cmml" xref="alg2.l17.m1.3.3.1.1">𝑙</ci></list></apply><apply id="alg2.l17.m1.6.7.3.cmml" xref="alg2.l17.m1.6.7.3"><csymbol cd="ambiguous" id="alg2.l17.m1.6.7.3.1.cmml" xref="alg2.l17.m1.6.7.3">superscript</csymbol><apply id="alg2.l17.m1.6.7.3.2.cmml" xref="alg2.l17.m1.6.7.3"><csymbol cd="ambiguous" id="alg2.l17.m1.6.7.3.2.1.cmml" xref="alg2.l17.m1.6.7.3">subscript</csymbol><ci id="alg2.l17.m1.6.7.3.2.2.cmml" xref="alg2.l17.m1.6.7.3.2.2">𝑊</ci><ci id="alg2.l17.m1.6.7.3.2.3.cmml" xref="alg2.l17.m1.6.7.3.2.3">𝑠</ci></apply><list id="alg2.l17.m1.6.6.2.3.cmml" xref="alg2.l17.m1.6.6.2.2"><apply id="alg2.l17.m1.6.6.2.2.1.cmml" xref="alg2.l17.m1.6.6.2.2.1"><plus id="alg2.l17.m1.6.6.2.2.1.1.cmml" xref="alg2.l17.m1.6.6.2.2.1.1"></plus><ci id="alg2.l17.m1.6.6.2.2.1.2.cmml" xref="alg2.l17.m1.6.6.2.2.1.2">𝑘</ci><cn type="integer" id="alg2.l17.m1.6.6.2.2.1.3.cmml" xref="alg2.l17.m1.6.6.2.2.1.3">1</cn></apply><ci id="alg2.l17.m1.5.5.1.1.cmml" xref="alg2.l17.m1.5.5.1.1">𝑙</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.6c">W_{s,m}^{k+1,l}\leftarrow W_{s}^{k+1,l}</annotation></semantics></math>;
</div>
<div id="alg2.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18:</span>           <span id="alg2.l18.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l18.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19:</span>        <span id="alg2.l19.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l19.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20:</span>     <span id="alg2.l20.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l20.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21:</span>  <span id="alg2.l21.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l21.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22:</span>  <span id="alg2.l22.1" class="ltx_text ltx_font_bold">return</span> <math id="alg2.l22.m1.1" class="ltx_Math" alttext="W_{s}" display="inline"><semantics id="alg2.l22.m1.1a"><msub id="alg2.l22.m1.1.1" xref="alg2.l22.m1.1.1.cmml"><mi id="alg2.l22.m1.1.1.2" xref="alg2.l22.m1.1.1.2.cmml">W</mi><mi id="alg2.l22.m1.1.1.3" xref="alg2.l22.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l22.m1.1b"><apply id="alg2.l22.m1.1.1.cmml" xref="alg2.l22.m1.1.1"><csymbol cd="ambiguous" id="alg2.l22.m1.1.1.1.cmml" xref="alg2.l22.m1.1.1">subscript</csymbol><ci id="alg2.l22.m1.1.1.2.cmml" xref="alg2.l22.m1.1.1.2">𝑊</ci><ci id="alg2.l22.m1.1.1.3.cmml" xref="alg2.l22.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l22.m1.1c">W_{s}</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
</section>
<section id="Sx4.SSx2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Implementation Details</h3>

<div id="Sx4.SSx2.p1" class="ltx_para">
<p id="Sx4.SSx2.p1.1" class="ltx_p">Our models are implemented using PyTorch 1.12.0 on a workstation with an RTX 3090 GPU. The models are trained for 200 epochs with a learning rate of 1e-3 and L2 regularization of 1e-5. Point data augmentation is used with details in Appendix B. The learning rate warm-up is tuned for the first 10 epochs, followed by a cosine decay scheduler. The Adam optimizer is adopted for weight updates.</p>
</div>
</section>
<section id="Sx4.SSx3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Comparison with WSI Classification Methods</h3>

<div id="Sx4.SSx3.p1" class="ltx_para">
<p id="Sx4.SSx3.p1.1" class="ltx_p">We include PointNet++ <cite class="ltx_cite ltx_citemacro_citep">(Qi et al. <a href="#bib.bib36" title="" class="ltx_ref">2017b</a>)</cite>, MIL-based models: CLAM-SB <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite>, DSMIL <cite class="ltx_cite ltx_citemacro_citep">(Li, Li, and Eliceiri <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite>, TransMIL <cite class="ltx_cite ltx_citemacro_citep">(Shao et al. <a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite>, HistFL<cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib27" title="" class="ltx_ref">2022b</a>)</cite>, and graph-based models: GraphSAGE <cite class="ltx_cite ltx_citemacro_citep">(Hamilton, Ying, and Leskovec <a href="#bib.bib11" title="" class="ltx_ref">2017</a>)</cite>, Patch-GCN <cite class="ltx_cite ltx_citemacro_citep">(Chen et al. <a href="#bib.bib1" title="" class="ltx_ref">2021a</a>)</cite>, SlideGraph+ <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib29" title="" class="ltx_ref">2022c</a>)</cite> for comprehensive model comparison. All of the compared models are implemented with federated average settings.</p>
</div>
<div id="Sx4.SSx3.p2" class="ltx_para">
<p id="Sx4.SSx3.p2.1" class="ltx_p">Table <a href="#Sx4.T2" title="Table 2 ‣ Dataset and Experimental Settings ‣ Experiments ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows that point-based models offer a competitive performance compared to MIL-based and graph-based methods. The point-based models process a unique advantage by effectively integrating both the local neighborhood features, similar to graph-based methods, and capturing the long-range dependencies, similar to MIL-based models. By introducing the novel FCS or/and DDA strategy, the point transformer achieves better performance compared to other models and PointTransformerDDA+ achieve the start-of-the-art AUC in the test set and three federated sites. Of note that TransMIL <cite class="ltx_cite ltx_citemacro_citep">(Shao et al. <a href="#bib.bib37" title="" class="ltx_ref">2021</a>)</cite> also offers a high AUC compared to other related models. TransMIL also incorporates position encoding in the model, indicating that point position contributes to improved performance in predicting HER2 status. Further analysis of position information can be found in Appendix C.</p>
</div>
<figure id="Sx4.T3" class="ltx_table">
<table id="Sx4.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="Sx4.T3.1.1.1" class="ltx_tr">
<th id="Sx4.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Federated Setting</th>
<td id="Sx4.T3.1.1.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">Average</td>
<td id="Sx4.T3.1.1.1.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">Site A</td>
<td id="Sx4.T3.1.1.1.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">Site B</td>
<td id="Sx4.T3.1.1.1.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">Site C</td>
<td id="Sx4.T3.1.1.1.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">Site D</td>
</tr>
<tr id="Sx4.T3.1.2.2" class="ltx_tr">
<th id="Sx4.T3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Centralization</th>
<td id="Sx4.T3.1.2.2.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.823</td>
<td id="Sx4.T3.1.2.2.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.722</td>
<td id="Sx4.T3.1.2.2.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.839</td>
<td id="Sx4.T3.1.2.2.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.824</td>
<td id="Sx4.T3.1.2.2.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.819</td>
</tr>
<tr id="Sx4.T3.1.3.3" class="ltx_tr">
<th id="Sx4.T3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PointTransformerDDA+</th>
<td id="Sx4.T3.1.3.3.2" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T3.1.3.3.2.1" class="ltx_text ltx_font_bold">0.816</span></td>
<td id="Sx4.T3.1.3.3.3" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T3.1.3.3.3.1" class="ltx_text ltx_font_bold">0.766</span></td>
<td id="Sx4.T3.1.3.3.4" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T3.1.3.3.4.1" class="ltx_text ltx_font_bold">0.866</span></td>
<td id="Sx4.T3.1.3.3.5" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T3.1.3.3.5.1" class="ltx_text ltx_font_bold">0.837</span></td>
<td id="Sx4.T3.1.3.3.6" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T3.1.3.3.6.1" class="ltx_text ltx_font_bold">0.760</span></td>
</tr>
<tr id="Sx4.T3.1.4.4" class="ltx_tr">
<th id="Sx4.T3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PointTransformerDDA</th>
<td id="Sx4.T3.1.4.4.2" class="ltx_td ltx_nopad_l ltx_align_center">0.793</td>
<td id="Sx4.T3.1.4.4.3" class="ltx_td ltx_nopad_l ltx_align_center">0.730</td>
<td id="Sx4.T3.1.4.4.4" class="ltx_td ltx_nopad_l ltx_align_center">0.855</td>
<td id="Sx4.T3.1.4.4.5" class="ltx_td ltx_nopad_l ltx_align_center">0.804</td>
<td id="Sx4.T3.1.4.4.6" class="ltx_td ltx_nopad_l ltx_align_center">0.758</td>
</tr>
<tr id="Sx4.T3.1.5.5" class="ltx_tr">
<th id="Sx4.T3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PointTransformer+</th>
<td id="Sx4.T3.1.5.5.2" class="ltx_td ltx_nopad_l ltx_align_center">0.806</td>
<td id="Sx4.T3.1.5.5.3" class="ltx_td ltx_nopad_l ltx_align_center">0.752</td>
<td id="Sx4.T3.1.5.5.4" class="ltx_td ltx_nopad_l ltx_align_center">0.844</td>
<td id="Sx4.T3.1.5.5.5" class="ltx_td ltx_nopad_l ltx_align_center">0.823</td>
<td id="Sx4.T3.1.5.5.6" class="ltx_td ltx_nopad_l ltx_align_center">0.757</td>
</tr>
<tr id="Sx4.T3.1.6.6" class="ltx_tr">
<th id="Sx4.T3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">FedAVG [1]</th>
<td id="Sx4.T3.1.6.6.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.771</td>
<td id="Sx4.T3.1.6.6.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.717</td>
<td id="Sx4.T3.1.6.6.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.834</td>
<td id="Sx4.T3.1.6.6.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.776</td>
<td id="Sx4.T3.1.6.6.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.721</td>
</tr>
<tr id="Sx4.T3.1.7.7" class="ltx_tr">
<th id="Sx4.T3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedGroupNorm [2]</th>
<td id="Sx4.T3.1.7.7.2" class="ltx_td ltx_nopad_l ltx_align_center">0.783</td>
<td id="Sx4.T3.1.7.7.3" class="ltx_td ltx_nopad_l ltx_align_center">0.733</td>
<td id="Sx4.T3.1.7.7.4" class="ltx_td ltx_nopad_l ltx_align_center">0.832</td>
<td id="Sx4.T3.1.7.7.5" class="ltx_td ltx_nopad_l ltx_align_center">0.775</td>
<td id="Sx4.T3.1.7.7.6" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T3.1.7.7.6.1" class="ltx_text ltx_font_bold">0.768</span></td>
</tr>
<tr id="Sx4.T3.1.8.8" class="ltx_tr">
<th id="Sx4.T3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedProx [3]</th>
<td id="Sx4.T3.1.8.8.2" class="ltx_td ltx_nopad_l ltx_align_center">0.788</td>
<td id="Sx4.T3.1.8.8.3" class="ltx_td ltx_nopad_l ltx_align_center">0.759</td>
<td id="Sx4.T3.1.8.8.4" class="ltx_td ltx_nopad_l ltx_align_center">0.836</td>
<td id="Sx4.T3.1.8.8.5" class="ltx_td ltx_nopad_l ltx_align_center">0.800</td>
<td id="Sx4.T3.1.8.8.6" class="ltx_td ltx_nopad_l ltx_align_center">0.719</td>
</tr>
<tr id="Sx4.T3.1.9.9" class="ltx_tr">
<th id="Sx4.T3.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedMGDA [4]</th>
<td id="Sx4.T3.1.9.9.2" class="ltx_td ltx_nopad_l ltx_align_center">0.773</td>
<td id="Sx4.T3.1.9.9.3" class="ltx_td ltx_nopad_l ltx_align_center">0.723</td>
<td id="Sx4.T3.1.9.9.4" class="ltx_td ltx_nopad_l ltx_align_center">0.818</td>
<td id="Sx4.T3.1.9.9.5" class="ltx_td ltx_nopad_l ltx_align_center">0.773</td>
<td id="Sx4.T3.1.9.9.6" class="ltx_td ltx_nopad_l ltx_align_center">0.741</td>
</tr>
<tr id="Sx4.T3.1.10.10" class="ltx_tr">
<th id="Sx4.T3.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">FedMGDA+ [4]</th>
<td id="Sx4.T3.1.10.10.2" class="ltx_td ltx_nopad_l ltx_align_center">0.780</td>
<td id="Sx4.T3.1.10.10.3" class="ltx_td ltx_nopad_l ltx_align_center">0.734</td>
<td id="Sx4.T3.1.10.10.4" class="ltx_td ltx_nopad_l ltx_align_center">0.813</td>
<td id="Sx4.T3.1.10.10.5" class="ltx_td ltx_nopad_l ltx_align_center">0.804</td>
<td id="Sx4.T3.1.10.10.6" class="ltx_td ltx_nopad_l ltx_align_center">0.738</td>
</tr>
<tr id="Sx4.T3.1.11.11" class="ltx_tr">
<th id="Sx4.T3.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">FedWon [5]</th>
<td id="Sx4.T3.1.11.11.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">0.774</td>
<td id="Sx4.T3.1.11.11.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">0.716</td>
<td id="Sx4.T3.1.11.11.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">0.824</td>
<td id="Sx4.T3.1.11.11.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">0.777</td>
<td id="Sx4.T3.1.11.11.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">0.728</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Comparison of different federated learning settings. [1] <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al. <a href="#bib.bib30" title="" class="ltx_ref">2017</a>)</cite>, [2] <cite class="ltx_cite ltx_citemacro_citep">(Hsieh et al. <a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite>, [3] <cite class="ltx_cite ltx_citemacro_citep">(Li et al. <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>, [4] <cite class="ltx_cite ltx_citemacro_citep">(Hu et al. <a href="#bib.bib14" title="" class="ltx_ref">2022</a>)</cite>, [5] <cite class="ltx_cite ltx_citemacro_citep">(Zhuang and Lyu <a href="#bib.bib47" title="" class="ltx_ref">2023</a>)</cite>.</figcaption>
</figure>
<figure id="Sx4.T4" class="ltx_table">
<table id="Sx4.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T4.1.1.1" class="ltx_tr">
<th id="Sx4.T4.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Unseen Sites</th>
<th id="Sx4.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Site E</th>
<th id="Sx4.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Site F</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T4.1.2.1" class="ltx_tr">
<th id="Sx4.T4.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">PointTransformerDDA+</th>
<td id="Sx4.T4.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="Sx4.T4.1.2.1.2.1" class="ltx_text ltx_font_bold">0.816</span></td>
<td id="Sx4.T4.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="Sx4.T4.1.2.1.3.1" class="ltx_text ltx_font_bold">0.766</span></td>
</tr>
<tr id="Sx4.T4.1.3.2" class="ltx_tr">
<th id="Sx4.T4.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PointTransformerDDA</th>
<td id="Sx4.T4.1.3.2.2" class="ltx_td ltx_align_center">0.793</td>
<td id="Sx4.T4.1.3.2.3" class="ltx_td ltx_align_center">0.730</td>
</tr>
<tr id="Sx4.T4.1.4.3" class="ltx_tr">
<th id="Sx4.T4.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">PointTransformer+</th>
<td id="Sx4.T4.1.4.3.2" class="ltx_td ltx_align_center ltx_border_b">0.806</td>
<td id="Sx4.T4.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b">0.752</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Performance of the point transformer in the unseen sites.</figcaption>
</figure>
</section>
<section id="Sx4.SSx4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Comparison with Federated Learning Methods</h3>

<div id="Sx4.SSx4.p1" class="ltx_para">
<p id="Sx4.SSx4.p1.1" class="ltx_p">We also represent the point transformer’s performance with different federated learning methods. Table <a href="#Sx4.T3" title="Table 3 ‣ Comparison with WSI Classification Methods ‣ Experiments ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows that our proposed PointTransformerDDA+ achieves the best total AUC among other methods and is the closest to the centralized training. Among the two proposed strategies FCS and DDA, FCS can capture the most discriminative features and DDA can mitigate the issue of non-i.i.d scenario; both of them can lead to a better federated learning performance. While GroupNorm <cite class="ltx_cite ltx_citemacro_citep">(Hsieh et al. <a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite> reaches higher performance at Site D, we observe that GroupNorm is sensitive to our data and relies on careful fine-grained group number selection with details in Appendix D. Moreover, although our models are not specifically designed for unseen scenarios, they still achieve commendable performance (AUC <math id="Sx4.SSx4.p1.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="Sx4.SSx4.p1.1.m1.1a"><mo id="Sx4.SSx4.p1.1.m1.1.1" xref="Sx4.SSx4.p1.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="Sx4.SSx4.p1.1.m1.1b"><gt id="Sx4.SSx4.p1.1.m1.1.1.cmml" xref="Sx4.SSx4.p1.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx4.p1.1.m1.1c">&gt;</annotation></semantics></math> 0.73) for two unseen sites, as shown in Table <a href="#Sx4.T4" title="Table 4 ‣ Comparison with WSI Classification Methods ‣ Experiments ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="Sx4.T5" class="ltx_table">
<table id="Sx4.T5.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T5.3.4.1" class="ltx_tr">
<th id="Sx4.T5.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Method</th>
<th id="Sx4.T5.3.4.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t">FCS</th>
<th id="Sx4.T5.3.4.1.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t">Average</th>
<th id="Sx4.T5.3.4.1.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t">Site A</th>
<th id="Sx4.T5.3.4.1.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t">Site B</th>
<th id="Sx4.T5.3.4.1.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t">Site C</th>
<th id="Sx4.T5.3.4.1.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t">Site D</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T5.1.1" class="ltx_tr">
<th id="Sx4.T5.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="Sx4.T5.1.1.2.1" class="ltx_text">DDA</span></th>
<td id="Sx4.T5.1.1.1" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t"><math id="Sx4.T5.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="Sx4.T5.1.1.1.m1.1a"><mo id="Sx4.T5.1.1.1.m1.1.1" xref="Sx4.T5.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx4.T5.1.1.1.m1.1b"><times id="Sx4.T5.1.1.1.m1.1.1.cmml" xref="Sx4.T5.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T5.1.1.1.m1.1c">\times</annotation></semantics></math></td>
<td id="Sx4.T5.1.1.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.793</td>
<td id="Sx4.T5.1.1.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.730</td>
<td id="Sx4.T5.1.1.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.855</td>
<td id="Sx4.T5.1.1.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.804</td>
<td id="Sx4.T5.1.1.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.758</td>
</tr>
<tr id="Sx4.T5.3.5.1" class="ltx_tr">
<td id="Sx4.T5.3.5.1.1" class="ltx_td ltx_nopad_l ltx_align_center">✓</td>
<td id="Sx4.T5.3.5.1.2" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T5.3.5.1.2.1" class="ltx_text ltx_font_bold">0.816</span></td>
<td id="Sx4.T5.3.5.1.3" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T5.3.5.1.3.1" class="ltx_text ltx_font_bold">0.766</span></td>
<td id="Sx4.T5.3.5.1.4" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T5.3.5.1.4.1" class="ltx_text ltx_font_bold">0.866</span></td>
<td id="Sx4.T5.3.5.1.5" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T5.3.5.1.5.1" class="ltx_text ltx_font_bold">0.837</span></td>
<td id="Sx4.T5.3.5.1.6" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T5.3.5.1.6.1" class="ltx_text ltx_font_bold">0.760</span></td>
</tr>
<tr id="Sx4.T5.2.2" class="ltx_tr">
<th id="Sx4.T5.2.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" rowspan="2"><span id="Sx4.T5.2.2.2.1" class="ltx_text">Base</span></th>
<td id="Sx4.T5.2.2.1" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t"><math id="Sx4.T5.2.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="Sx4.T5.2.2.1.m1.1a"><mo id="Sx4.T5.2.2.1.m1.1.1" xref="Sx4.T5.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx4.T5.2.2.1.m1.1b"><times id="Sx4.T5.2.2.1.m1.1.1.cmml" xref="Sx4.T5.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T5.2.2.1.m1.1c">\times</annotation></semantics></math></td>
<td id="Sx4.T5.2.2.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.771</td>
<td id="Sx4.T5.2.2.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.717</td>
<td id="Sx4.T5.2.2.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.834</td>
<td id="Sx4.T5.2.2.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.776</td>
<td id="Sx4.T5.2.2.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.721</td>
</tr>
<tr id="Sx4.T5.3.6.2" class="ltx_tr">
<td id="Sx4.T5.3.6.2.1" class="ltx_td ltx_nopad_l ltx_align_center">✓</td>
<td id="Sx4.T5.3.6.2.2" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T5.3.6.2.2.1" class="ltx_text ltx_font_bold">0.806</span></td>
<td id="Sx4.T5.3.6.2.3" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T5.3.6.2.3.1" class="ltx_text ltx_font_bold">0.752</span></td>
<td id="Sx4.T5.3.6.2.4" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T5.3.6.2.4.1" class="ltx_text ltx_font_bold">0.844</span></td>
<td id="Sx4.T5.3.6.2.5" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T5.3.6.2.5.1" class="ltx_text ltx_font_bold">0.823</span></td>
<td id="Sx4.T5.3.6.2.6" class="ltx_td ltx_nopad_l ltx_align_center"><span id="Sx4.T5.3.6.2.6.1" class="ltx_text ltx_font_bold">0.757</span></td>
</tr>
<tr id="Sx4.T5.3.3" class="ltx_tr">
<th id="Sx4.T5.3.3.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" rowspan="2"><span id="Sx4.T5.3.3.2.1" class="ltx_text">NoFed</span></th>
<td id="Sx4.T5.3.3.1" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t"><math id="Sx4.T5.3.3.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="Sx4.T5.3.3.1.m1.1a"><mo id="Sx4.T5.3.3.1.m1.1.1" xref="Sx4.T5.3.3.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="Sx4.T5.3.3.1.m1.1b"><times id="Sx4.T5.3.3.1.m1.1.1.cmml" xref="Sx4.T5.3.3.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="Sx4.T5.3.3.1.m1.1c">\times</annotation></semantics></math></td>
<td id="Sx4.T5.3.3.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">-</td>
<td id="Sx4.T5.3.3.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.639</td>
<td id="Sx4.T5.3.3.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.799</td>
<td id="Sx4.T5.3.3.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.687</td>
<td id="Sx4.T5.3.3.7" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.728</td>
</tr>
<tr id="Sx4.T5.3.7.3" class="ltx_tr">
<td id="Sx4.T5.3.7.3.1" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">✓</td>
<td id="Sx4.T5.3.7.3.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">-</td>
<td id="Sx4.T5.3.7.3.3" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b"><span id="Sx4.T5.3.7.3.3.1" class="ltx_text ltx_font_bold">0.659</span></td>
<td id="Sx4.T5.3.7.3.4" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b"><span id="Sx4.T5.3.7.3.4.1" class="ltx_text ltx_font_bold">0.831</span></td>
<td id="Sx4.T5.3.7.3.5" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b"><span id="Sx4.T5.3.7.3.5.1" class="ltx_text ltx_font_bold">0.711</span></td>
<td id="Sx4.T5.3.7.3.6" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b"><span id="Sx4.T5.3.7.3.6.1" class="ltx_text ltx_font_bold">0.729</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Ablation experiments of farthest cosine sampling (FCS). NoFed: the model is trained at each site locally.</figcaption>
</figure>
<figure id="Sx4.T6" class="ltx_table">
<table id="Sx4.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="Sx4.T6.1.1.1" class="ltx_tr">
<th id="Sx4.T6.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">IHC Score 2+</th>
<th id="Sx4.T6.1.1.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_th ltx_th_column ltx_border_t">Average</th>
<th id="Sx4.T6.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Site A</th>
<th id="Sx4.T6.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Site B</th>
<th id="Sx4.T6.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Site D</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="Sx4.T6.1.2.1" class="ltx_tr">
<th id="Sx4.T6.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">PointTransformerDDA+</th>
<td id="Sx4.T6.1.2.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t">0.712</td>
<td id="Sx4.T6.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.688</td>
<td id="Sx4.T6.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">0.733</td>
<td id="Sx4.T6.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">0.723</td>
</tr>
<tr id="Sx4.T6.1.3.2" class="ltx_tr">
<th id="Sx4.T6.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">PointTransformerDDA</th>
<td id="Sx4.T6.1.3.2.2" class="ltx_td ltx_nopad_l ltx_align_center">0.703</td>
<td id="Sx4.T6.1.3.2.3" class="ltx_td ltx_align_center">0.668</td>
<td id="Sx4.T6.1.3.2.4" class="ltx_td ltx_align_center">0.710</td>
<td id="Sx4.T6.1.3.2.5" class="ltx_td ltx_align_center">0.735</td>
</tr>
<tr id="Sx4.T6.1.4.3" class="ltx_tr">
<th id="Sx4.T6.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">PointTransformer+</th>
<td id="Sx4.T6.1.4.3.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_b">0.747</td>
<td id="Sx4.T6.1.4.3.3" class="ltx_td ltx_align_center ltx_border_b">0.726</td>
<td id="Sx4.T6.1.4.3.4" class="ltx_td ltx_align_center ltx_border_b">0.748</td>
<td id="Sx4.T6.1.4.3.5" class="ltx_td ltx_align_center ltx_border_b">0.730</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>The AUC of our model in the IHC score 2+ subset. Site C is excluded due to no IHC 2+ WSIs .</figcaption>
</figure>
</section>
<section id="Sx4.SSx5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Ablation Studies</h3>

<section id="Sx4.SSx5.SSSx1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Farthest cosine sampling</h4>

<div id="Sx4.SSx5.SSSx1.p1" class="ltx_para">
<p id="Sx4.SSx5.SSSx1.p1.1" class="ltx_p">We first evaluate the effectiveness of FCS in the DDA and base federated average settings. We also assess FCS’s impact at each site by training locally rather than employing a federated learning scheme. Table <a href="#Sx4.T5" title="Table 5 ‣ Comparison with Federated Learning Methods ‣ Experiments ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows that FCS can consistently bring improved performance in all settings, including local training without federated learning. FCS can capture more discriminative features, leading to better performance. Of note, FCS only brings little benefit for HER2 status in Site D. This could be attributed to the fact that Site D primarily consists of biopsy WSIs with a lower number of total points compared to other sites. Consequently, the use of FPS sampling is sufficient to cover almost all the patches in Site D.</p>
</div>
</section>
<section id="Sx4.SSx5.SSSx2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Percentage of training WSIs</h4>

<div id="Sx4.SSx5.SSSx2.p1" class="ltx_para">
<p id="Sx4.SSx5.SSSx2.p1.1" class="ltx_p">Our model contains the largest number of WSIs to date for predicting HER2 status. However, real-world scenarios may lack sufficient WSIs. Therefore, we evaluate our model’s performance by reducing the training WSIs to 75% (1209 WSIs), 50% (806 WSIs), 25% (403 WSIs). We exclude the use of 10% of the training WSIs as it results in less than 10 positive WSIs at each site, making it unsuitable for this experiment. Figure <a href="#Sx4.F5" title="Figure 5 ‣ Percentage of training WSIs ‣ Ablation Studies ‣ Experiments ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows that our model outperforms the base PointTransformer in all settings. The PointTransformerDDA+ with 50% of training WSIs achieve an AUC that is merely 0.008 lower than the PointTransformer model (0.763 vs 0.771) trained with 100% of the training WSIs. Moreover, with only 25% of training WSIs, the performance of PointTransformerDDA+ still outperforms DSMIL <cite class="ltx_cite ltx_citemacro_citep">(Li, Li, and Eliceiri <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite> (0.708 vs 0.693).</p>
</div>
<figure id="Sx4.F5" class="ltx_figure"><img src="/html/2312.06454/assets/data_ratio.png" id="Sx4.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="279" height="215" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Performance compassion with different percentages of training WSIs.</figcaption>
</figure>
</section>
<section id="Sx4.SSx5.SSSx3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">IHC2+ Subset Analysis</h4>

<div id="Sx4.SSx5.SSSx3.p1" class="ltx_para">
<p id="Sx4.SSx5.SSSx3.p1.1" class="ltx_p">In real clinical scenarios IHC score 2+, pathologists cannot assess the HER2 status from IHC and require further expensive ISH tests. However, Table <a href="#Sx4.T6" title="Table 6 ‣ Comparison with Federated Learning Methods ‣ Experiments ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows that our model still achieves impressive performance with an average AUC <math id="Sx4.SSx5.SSSx3.p1.1.m1.1" class="ltx_Math" alttext="&gt;" display="inline"><semantics id="Sx4.SSx5.SSSx3.p1.1.m1.1a"><mo id="Sx4.SSx5.SSSx3.p1.1.m1.1.1" xref="Sx4.SSx5.SSSx3.p1.1.m1.1.1.cmml">&gt;</mo><annotation-xml encoding="MathML-Content" id="Sx4.SSx5.SSSx3.p1.1.m1.1b"><gt id="Sx4.SSx5.SSSx3.p1.1.m1.1.1.cmml" xref="Sx4.SSx5.SSSx3.p1.1.m1.1.1"></gt></annotation-xml><annotation encoding="application/x-tex" id="Sx4.SSx5.SSSx3.p1.1.m1.1c">&gt;</annotation></semantics></math> 0.7 in the test set. It can bring us an opportunity to reduce the reliance on ISH tests, thereby offering cost savings and faster HER2 status assessment.</p>
</div>
</section>
</section>
</section>
<section id="Sx5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Conclusion</h2>

<div id="Sx5.p1" class="ltx_para">
<p id="Sx5.p1.1" class="ltx_p">Unlike MIL-based or graph-based methods, we regard a WSI as a point cloud with position information to derive the HER2 status from HE-stained WSIs, highlighting the effectiveness of point neural networks for WSI analysis. Specifically, a farthest cosine sampling is proposed to capture the long-range dependencies and aggregate most discriminative point features. Additionally, when utilizing federated learning, we proposed a dynamic distribution adjustment to mitigate the non-i.i.d. scenario of label imbalance in real-world WSIs. Extensive experiments have demonstrated the efficacy of our two components. Our models further achieve impressive performance in both unseen sites and IHC score 2+ subsets.</p>
</div>
</section>
<section id="Sx6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgments</h2>

<div id="Sx6.p1" class="ltx_para">
<p id="Sx6.p1.1" class="ltx_p">This work was supported by the National Natural Science Foundation of China (No. 62333022) and the Beijing Natural Science Foundation (No. JQ23034).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021a)</span>
<span class="ltx_bibblock">
Chen, R. J.; Lu, M. Y.; Shaban, M.; Chen, C.; Chen, T. Y.; Williamson, D. F. K.; and Mahmood, F. 2021a.

</span>
<span class="ltx_bibblock">Whole slide images are 2D point clouds: Context-aware survival prediction using patch-based graph convolutional networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Medical Image Computing and Computer Assisted Intervention</em>, 339–349. Springer.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2020)</span>
<span class="ltx_bibblock">
Chen, R. J.; Lu, M. Y.; Wang, J.; Williamson, D. F.; Rodig, S. J.; Lindeman, N. I.; and Mahmood, F. 2020.

</span>
<span class="ltx_bibblock">Pathomic fusion: an integrated framework for fusing histopathology and genomic features for cancer diagnosis and prognosis.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Medical Imaging</em>, 41: 757–770.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021b)</span>
<span class="ltx_bibblock">
Chen, R. J.; Lu, M. Y.; Weng, W.-H.; Chen, T. Y.; Williamson, D. F.; Manz, T.; Shady, M.; and Mahmood, F. 2021b.

</span>
<span class="ltx_bibblock">Multimodal co-attention transformer for survival prediction in gigapixel whole slide images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 4015–4025.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Conde-Sousa et al. (2022)</span>
<span class="ltx_bibblock">
Conde-Sousa, E.; Vale, J.; Feng, M.; Xu, K.; Wang, Y.; Mea, V. D.; Barbera, D. L.; Montahaei, E.; Baghshah, M. S.; Turzynski, A.; Gildenblat, J.; Klaiman, E.; Hong, Y.; Aresta, G.; Araújo, T.; Aguiar, P.; Eloy, C.; and Polónia, A. 2022.

</span>
<span class="ltx_bibblock">HEROHE challenge: Predicting HER2 status in breast cancer from hematoxylin-eosin whole-slide imaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Journal of Imaging</em>, 8(8): 213.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al. (2022)</span>
<span class="ltx_bibblock">
Du, Z.; Sun, J.; Li, A.; Chen, P.-Y.; Zhang, J.; Li, H. H.; and Chen, Y. 2022.

</span>
<span class="ltx_bibblock">Rethinking normalization methods in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 3rd International Workshop on Distributed Machine Learning</em>, 16–22.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Farahmand et al. (2022)</span>
<span class="ltx_bibblock">
Farahmand, S.; Fernandez, A. I.; Ahmed, F. S.; Rimm, D. L.; Chuang, J. H.; Reisenbichler, E.; and Zarringhalam, K. 2022.

</span>
<span class="ltx_bibblock">Deep learning trained on hematoxylin and eosin tumor region of Interest predicts HER2 status and trastuzumab treatment response in HER2+ breast cancer.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Modern Pathology</em>, 35(1): 44–51.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gamper et al. (2019)</span>
<span class="ltx_bibblock">
Gamper, J.; Koohbanani, N. A.; Benes, K.; Khuram, A.; and Rajpoot, N. 2019.

</span>
<span class="ltx_bibblock">PanNuke: an open pan-cancer histology dataset for nuclei instance segmentation and classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">European Congress on Digital Pathology</em>, 11–19.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gamper et al. (2020)</span>
<span class="ltx_bibblock">
Gamper, J.; Koohbanani, N. A.; Graham, S.; Jahanifar, M.; Khurram, S. A.; Azam, A.; Hewitt, K.; and Rajpoot, N. 2020.

</span>
<span class="ltx_bibblock">PanNuke dataset extension, insights and baselines.

</span>
<span class="ltx_bibblock">arXiv:2003.10778.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guan and Liu (2023)</span>
<span class="ltx_bibblock">
Guan, H.; and Liu, M. 2023.

</span>
<span class="ltx_bibblock">Federated learning for medical image analysis: A survey.

</span>
<span class="ltx_bibblock">arXiv:2306.05980.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2021)</span>
<span class="ltx_bibblock">
Guo, M.; Cai, J.; Liu, Z.; Mu, T.; Martin, R. R.; and Hu, S. 2021.

</span>
<span class="ltx_bibblock">PCT: Point cloud transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Computational Visual Media</em>, 7: 187–199.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hamilton, Ying, and Leskovec (2017)</span>
<span class="ltx_bibblock">
Hamilton, W.; Ying, Z.; and Leskovec, J. 2017.

</span>
<span class="ltx_bibblock">Inductive representation learning on large graphs.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 1025–1035.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. (2022)</span>
<span class="ltx_bibblock">
Hou, W.; Yu, L.; Lin, C.; Huang, H.; Yu, R.; Qin, J.; and Wang, L. 2022.

</span>
<span class="ltx_bibblock">H^2-MIL: Exploring hierarchical representation with heterogeneous multiple instance learning for whole slide image analysis.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, 933–941.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsieh et al. (2020)</span>
<span class="ltx_bibblock">
Hsieh, K.; Phanishayee, A.; Mutlu, O.; and Gibbons, P. 2020.

</span>
<span class="ltx_bibblock">The non-iid data quagmire of decentralized machine learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 4387–4398. PMLR.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2022)</span>
<span class="ltx_bibblock">
Hu, Z.; Shaloudegi, K.; Zhang, G.; and Yu, Y. 2022.

</span>
<span class="ltx_bibblock">Federated learning meets multi-objective optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Network Science and Engineering</em>, 9(4): 2039–2051.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ilse, Tomczak, and Welling (2018)</span>
<span class="ltx_bibblock">
Ilse, M.; Tomczak, J.; and Welling, M. 2018.

</span>
<span class="ltx_bibblock">Attention-based deep multiple instance learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2127–2136. PMLR.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang, Wang, and Dou (2022)</span>
<span class="ltx_bibblock">
Jiang, M.; Wang, Z.; and Dou, Q. 2022.

</span>
<span class="ltx_bibblock">HarmoFL: Harmonizing local and global drifts in federated learning on heterogeneous medical images.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, 1087–1095.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang et al. (2020)</span>
<span class="ltx_bibblock">
Kang, B.; Xie, S.; Rohrbach, M.; Yan, Z.; Gordo, A.; Feng, J.; and Kalantidis, Y. 2020.

</span>
<span class="ltx_bibblock">Decoupling representation and classifier for long-tailed recognition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 1–16.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kather et al. (2020)</span>
<span class="ltx_bibblock">
Kather, J. N.; Heij, L. R.; Grabsch, H. I.; Loeffler, C.; Echle, A.; Muti, H. S.; Krause, J.; Niehues, J. M.; Sommer, K. A.; Bankhead, P.; et al. 2020.

</span>
<span class="ltx_bibblock">Pan-cancer image-based detection of clinically actionable genetic alterations.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Nature Cancer</em>, 1(8): 789–799.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee, Shin, and Kim (2021)</span>
<span class="ltx_bibblock">
Lee, H.; Shin, S.; and Kim, H. 2021.

</span>
<span class="ltx_bibblock">ABC: Auxiliary balanced classifier for class-imbalanced semi-supervised learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Neural Information Processing Systems</em>, 7082–7094.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2022)</span>
<span class="ltx_bibblock">
Lee, Y.; Park, J. H.; Oh, S.; Shin, K.; Sun, J.; Jung, M.; Lee, C.; Kim, H.; Chung, J.-H.; Moon, K. C.; et al. 2022.

</span>
<span class="ltx_bibblock">Derivation of prognostic contextual histopathological features from whole-slide images of tumours via graph deep learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Nature Biomedical Engineering</em>, 1–15.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Li, B.; Li, F.; Liu, Z.; Xu, F.; Ye, G.; Li, W.; Zhang, Y.; Zhu, T.; Shao, L.; Chen, C.; et al. 2022.

</span>
<span class="ltx_bibblock">Deep learning with biopsy whole slide images for pretreatment prediction of pathological complete response to neoadjuvant chemotherapy in breast cancer: A multicenter study.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">The Breast</em>, 66: 183–190.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li, Li, and Eliceiri (2020)</span>
<span class="ltx_bibblock">
Li, B.; Li, Y.; and Eliceiri, K. W. 2020.

</span>
<span class="ltx_bibblock">Dual-stream multiple instance learning network for whole slide image classification with self-supervised contrastive learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 14313–14323.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T.; Sahu, A. K.; Zaheer, M.; Sanjabi, M.; Talwalkar, A.; and Smith, V. 2020.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 429–450.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2017)</span>
<span class="ltx_bibblock">
Lin, T. Y.; Dollar, P.; Girshick, R.; He, K.; Hariharan, B.; and Belongie, S. 2017.

</span>
<span class="ltx_bibblock">Feature pyramid networks for object detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 936–944.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Liu, Z.; Lin, Y.; Cao, Y.; Hu, H.; Wei, Y.; Zhang, Z.; Lin, S.; and Guo, B. 2021.

</span>
<span class="ltx_bibblock">Swin transformer: Hierarchical vision transformer using shifted windows.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 9992–10002.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2022a)</span>
<span class="ltx_bibblock">
Lu, D.; Xie, Q.; Wei, M.; Gao, K.; Xu, L.; and Li, J. 2022a.

</span>
<span class="ltx_bibblock">Transformers in 3D point clouds: A survey.

</span>
<span class="ltx_bibblock">arXiv:2205.07417.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2022b)</span>
<span class="ltx_bibblock">
Lu, M. Y.; Chen, R. J.; Kong, D.; Lipkova, J.; Singh, R.; Williamson, D. F.; Chen, T. Y.; and Mahmood, F. 2022b.

</span>
<span class="ltx_bibblock">Federated learning for computational pathology on gigapixel whole slide images.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Medical Image Analysis</em>, 76: 102298.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2021)</span>
<span class="ltx_bibblock">
Lu, M. Y.; Williamson, D. F.; Chen, T. Y.; Chen, R. J.; Barbieri, M.; and Mahmood, F. 2021.

</span>
<span class="ltx_bibblock">Data-efficient and weakly supervised computational pathology on whole-slide images.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Nature Biomedical Engineering</em>, 5(6): 555–570.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2022c)</span>
<span class="ltx_bibblock">
Lu, W.; Toss, M.; Dawood, M.; Rakha, E.; Rajpoot, N.; and Minhas, F. 2022c.

</span>
<span class="ltx_bibblock">SlideGraph+: Whole slide image level graphs to predict HER2 status in breast cancer.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Medical Image Analysis</em>, 80: 102486.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B.; Moore, E.; Ramage, D.; Hampson, S.; and y Arcas, B. A. 2017.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, 1273–1282. PMLR.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Network (2012)</span>
<span class="ltx_bibblock">
Network, T. C. G. A. 2012.

</span>
<span class="ltx_bibblock">Comprehensive molecular portraits of human breast tumors.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">Nature</em>, 490: 61–70.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ogier du Terrail et al. (2023)</span>
<span class="ltx_bibblock">
Ogier du Terrail, J.; Leopold, A.; Joly, C.; Béguier, C.; Andreux, M.; Maussion, C.; Schmauch, B.; Tramel, E. W.; Bendjebbar, E.; Zaslavskiy, M.; et al. 2023.

</span>
<span class="ltx_bibblock">Federated learning for predicting histological response to neoadjuvant chemotherapy in triple-negative breast cancer.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Nature Medicine</em>, 29: 135–146.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh and Bang (2019)</span>
<span class="ltx_bibblock">
Oh, D. Y.; and Bang, Y. 2019.

</span>
<span class="ltx_bibblock">HER2-targeted therapies — a role beyond breast cancer.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Nature Reviews Clinical Oncology</em>, 17: 33–48.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qaiser et al. (2017)</span>
<span class="ltx_bibblock">
Qaiser, T.; Mukherjee, A.; Reddy Pb, C.; Munugoti, S. D.; Tallam, V.; Pitkäaho, T.; Lehtimäki, T.; Naughton, T.; Berseth, M.; Pedraza, A.; et al. 2017.

</span>
<span class="ltx_bibblock">HER2 challenge contest: a detailed assessment of automated HER2 scoring algorithms in whole slide images of breast cancer tissues.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Histopathology</em>, 72: 227–238.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al. (2017a)</span>
<span class="ltx_bibblock">
Qi, C. R.; Su, H.; Mo, K.; and Guibas, L. J. 2017a.

</span>
<span class="ltx_bibblock">PointNet: Deep learning on point sets for 3D classification and segmentation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 652–660.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al. (2017b)</span>
<span class="ltx_bibblock">
Qi, C. R.; Yi, L.; Su, H.; and Guibas, L. J. 2017b.

</span>
<span class="ltx_bibblock">PointNet++: Deep hierarchical feature learning on point sets in a metric space.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 5105–5114.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et al. (2021)</span>
<span class="ltx_bibblock">
Shao, Z.; Bian, H.; Chen, Y.; Wang, Y.; Zhang, J.; Ji, X.; and Zhang, Y. 2021.

</span>
<span class="ltx_bibblock">TransMIL: Transformer based correlated multiple instance learning for whole slide image classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2136–2147.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et al. (2023)</span>
<span class="ltx_bibblock">
Shao, Z.; Chen, Y.; Bian, H.; Zhang, J.; Liu, G.; and Zhang, Y. 2023.

</span>
<span class="ltx_bibblock">HVTSurv: Hierarchical vision transformer for patient-level survival prediction from whole slide image.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, 2209–2217.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2022)</span>
<span class="ltx_bibblock">
Shen, Y.; Liu, L.; Tang, Z.; Chen, Z.; Ma, G.; Dong, J.; Zhang, X.; Yang, L.; and Zheng, Q. 2022.

</span>
<span class="ltx_bibblock">Explainable survival analysis with convolution-involved vision transformer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, 2207–2215.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sundararajan, Taly, and Yan (2017)</span>
<span class="ltx_bibblock">
Sundararajan, M.; Taly, A.; and Yan, Q. 2017.

</span>
<span class="ltx_bibblock">Axiomatic attribution for deep networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 3319–3328. PMLR.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Wang, J.; Zhang, W.; Zang, Y.; Cao, Y.; Pang, J.; Gong, T.; Chen, K.; Liu, Z.; Loy, C. C.; and Lin, D. 2021.

</span>
<span class="ltx_bibblock">Seesaw loss for long-tailed instance segmentation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 9695–9704.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, Y.; Sun, Y.; Liu, Z.; Sarma, S. E.; Bronstein, M. M.; and Solomon, J. M. 2019.

</span>
<span class="ltx_bibblock">Dynamic graph cnn for learning on point clouds.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">ACM Transactions on Graphics (tog)</em>, 38(5): 1–12.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolff et al. (2018)</span>
<span class="ltx_bibblock">
Wolff, A. C.; Hammond, M. E. H.; Allison, K. H.; Harvey, B. E.; Mangu, P. B.; Bartlett, J. M.; Bilous, M.; Ellis, I. O.; Fitzgibbons, P.; Hanna, W.; et al. 2018.

</span>
<span class="ltx_bibblock">Human epidermal growth factor receptor 2 testing in breast cancer: American Society of Clinical Oncology/College of American Pathologists clinical practice guideline focused update.

</span>
<span class="ltx_bibblock"><em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Archives of Pathology &amp; Laboratory Medicine</em>, 142(11): 1364–1382.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2019)</span>
<span class="ltx_bibblock">
Xu, K.; Hu, W.; Leskovec, J.; and Jegelka, S. 2019.

</span>
<span class="ltx_bibblock">How powerful are graph neural networks?

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 1–17.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2018)</span>
<span class="ltx_bibblock">
Xu, K.; Li, C.; Tian, Y.; Sonobe, T.; Kawarabayashi, K.-i.; and Jegelka, S. 2018.

</span>
<span class="ltx_bibblock">Representation learning on graphs with jumping knowledge networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 5453–5462. PMLR.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2021)</span>
<span class="ltx_bibblock">
Zhao, H.; Jiang, L.; Jia, J.; Torr, P. H.; and Koltun, V. 2021.

</span>
<span class="ltx_bibblock">Point Transformer.

</span>
<span class="ltx_bibblock">In <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 16259–16268.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang and Lyu (2023)</span>
<span class="ltx_bibblock">
Zhuang, W.; and Lyu, L. 2023.

</span>
<span class="ltx_bibblock">Is normalization indispensable for multi-domain federated learning?

</span>
<span class="ltx_bibblock">arXiv:2306.05879.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A0.SSx5.SSSx3.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Roadmap of Appendix:</h5>

<div id="A0.SSx5.SSSx3.Px1.p1" class="ltx_para">
<p id="A0.SSx5.SSSx3.Px1.p1.1" class="ltx_p">The Appendix includes details of WSI prepossess, WSI dataset and further experimental analysis of point transformer, and federated learning in our model.</p>
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>WSI Prepossess and Feature Extraction</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.11" class="ltx_p">We follow CLAM <cite class="ltx_cite ltx_citemacro_citep">(Lu et al. <a href="#bib.bib28" title="" class="ltx_ref">2021</a>)</cite> to remove the white background region and then cut the tissue regions into patches with a fixed size of 256<math id="A1.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p1.1.m1.1a"><mo id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><times id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">\times</annotation></semantics></math>256 at 20<math id="A1.p1.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p1.2.m2.1a"><mo id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><times id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">\times</annotation></semantics></math> magnification ( 0.5<math id="A1.p1.3.m3.1" class="ltx_Math" alttext="\mu m" display="inline"><semantics id="A1.p1.3.m3.1a"><mrow id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml"><mi id="A1.p1.3.m3.1.1.2" xref="A1.p1.3.m3.1.1.2.cmml">μ</mi><mo lspace="0em" rspace="0em" id="A1.p1.3.m3.1.1.1" xref="A1.p1.3.m3.1.1.1.cmml">​</mo><mi id="A1.p1.3.m3.1.1.3" xref="A1.p1.3.m3.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><apply id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1"><times id="A1.p1.3.m3.1.1.1.cmml" xref="A1.p1.3.m3.1.1.1"></times><ci id="A1.p1.3.m3.1.1.2.cmml" xref="A1.p1.3.m3.1.1.2">𝜇</ci><ci id="A1.p1.3.m3.1.1.3.cmml" xref="A1.p1.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">\mu m</annotation></semantics></math>/pixel) without overlap. For some WSIs that may not contain 20<math id="A1.p1.4.m4.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p1.4.m4.1a"><mo id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><times id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">\times</annotation></semantics></math> magnification. For example, a WSI may only have 40<math id="A1.p1.5.m5.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p1.5.m5.1a"><mo id="A1.p1.5.m5.1.1" xref="A1.p1.5.m5.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.1b"><times id="A1.p1.5.m5.1.1.cmml" xref="A1.p1.5.m5.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m5.1c">\times</annotation></semantics></math>, 10<math id="A1.p1.6.m6.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p1.6.m6.1a"><mo id="A1.p1.6.m6.1.1" xref="A1.p1.6.m6.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p1.6.m6.1b"><times id="A1.p1.6.m6.1.1.cmml" xref="A1.p1.6.m6.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.6.m6.1c">\times</annotation></semantics></math> magnification, we crop a larger size (40<math id="A1.p1.7.m7.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p1.7.m7.1a"><mo id="A1.p1.7.m7.1.1" xref="A1.p1.7.m7.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p1.7.m7.1b"><times id="A1.p1.7.m7.1.1.cmml" xref="A1.p1.7.m7.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.7.m7.1c">\times</annotation></semantics></math>: 512<math id="A1.p1.8.m8.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p1.8.m8.1a"><mo id="A1.p1.8.m8.1.1" xref="A1.p1.8.m8.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p1.8.m8.1b"><times id="A1.p1.8.m8.1.1.cmml" xref="A1.p1.8.m8.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.8.m8.1c">\times</annotation></semantics></math>512) or smaller size (10<math id="A1.p1.9.m9.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p1.9.m9.1a"><mo id="A1.p1.9.m9.1.1" xref="A1.p1.9.m9.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p1.9.m9.1b"><times id="A1.p1.9.m9.1.1.cmml" xref="A1.p1.9.m9.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.9.m9.1c">\times</annotation></semantics></math>: 128<math id="A1.p1.10.m10.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p1.10.m10.1a"><mo id="A1.p1.10.m10.1.1" xref="A1.p1.10.m10.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p1.10.m10.1b"><times id="A1.p1.10.m10.1.1.cmml" xref="A1.p1.10.m10.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.10.m10.1c">\times</annotation></semantics></math>128) and then resized to 256<math id="A1.p1.11.m11.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.p1.11.m11.1a"><mo id="A1.p1.11.m11.1.1" xref="A1.p1.11.m11.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.p1.11.m11.1b"><times id="A1.p1.11.m11.1.1.cmml" xref="A1.p1.11.m11.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.11.m11.1c">\times</annotation></semantics></math>256 to guarantee the same field of view (FOV). The number of patches per WSI ranges from thousands to tens of thousands. The feature extraction in our study involved training of a nuclei segmentation model using the public nuclei dataset PanNuke <cite class="ltx_cite ltx_citemacro_citep">(Gamper et al. <a href="#bib.bib7" title="" class="ltx_ref">2019</a>, <a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>. The nuclei segmentation model is trained under an updated version of HTC-Lite from  <cite class="ltx_cite ltx_citemacro_citep">(Wang et al. <a href="#bib.bib41" title="" class="ltx_ref">2021</a>)</cite> and is implemented using an open-source MMdetection toolbox.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Details of WSI Dataset</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">The WSIs used in our study are involved with four publicly available datasets (Sites A, D, E, and F) and two internal datasets (Sites B and C) with the ethics committee’s approval. Site A is a well-known project TCGA-BRCA <cite class="ltx_cite ltx_citemacro_citep">(Network <a href="#bib.bib31" title="" class="ltx_ref">2012</a>)</cite>, and is widely used for WSI analysis. Site B’s WSIs are retrospectively collected from West China Hospital of Sichuan University. Site C’s WSIs are from out-of-hospital consultation cases of Sichuan University West China Hospital. Site D is the HEROHE Challenge <cite class="ltx_cite ltx_citemacro_citep">(Conde-Sousa et al. <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite> dataset, which mainly contains biopsy WSIs, and Sites E and F are the Yale HER2 <cite class="ltx_cite ltx_citemacro_citep">(Farahmand et al. <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite> dataset and the HER2C <cite class="ltx_cite ltx_citemacro_citep">(Qaiser et al. <a href="#bib.bib34" title="" class="ltx_ref">2017</a>)</cite> datasets, respectively. All of the public datasets can be obtained from the public website offered in each paper. Note that Site F or HER2C dataset only includes an IHC score for each WSI without corresponding ISH score for IHC 2+. Thus we filter out IHC 2+ in Site F and regard the IHC 0/1+ as HER2- and IHC 3+ as HER2+.</p>
</div>
<div id="A2.p2" class="ltx_para">
<p id="A2.p2.1" class="ltx_p">During the training process, various data augmentation techniques are employed to augment the point data. These include random point dropout, point jitter, scaling in [0.8, 1.25], and shifting with a range of 0.1.</p>
</div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Further Analysis of PointTransformer</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">The PointTransformer involves the random selection of 1024 points and the farthest cosine sampling, which can introduce a degree of randomness into the model’s results. Here we randomly repeat our model with 100 or even 1000 times to assess the stability of our model’s prediction. As shown in Table <a href="#A3.T7" title="Table 7 ‣ Appendix C Further Analysis of PointTransformer ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we observe a 0.37% standard deviation in the test AUC, and the difference between the maximum and minimum AUC is only 0.022. These results demonstrate the robustness of our model to random sampling and indicate its consistent and reliable performance.</p>
</div>
<figure id="A3.T7" class="ltx_table">
<table id="A3.T7.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T7.1.1.1" class="ltx_tr">
<th id="A3.T7.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-left:8.5pt;padding-right:8.5pt;">Repeat</th>
<th id="A3.T7.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:8.5pt;padding-right:8.5pt;">Mean</th>
<th id="A3.T7.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:8.5pt;padding-right:8.5pt;">Min</th>
<th id="A3.T7.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:8.5pt;padding-right:8.5pt;">Max</th>
<th id="A3.T7.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:8.5pt;padding-right:8.5pt;">Max-Min</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T7.1.2.1" class="ltx_tr">
<th id="A3.T7.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:8.5pt;padding-right:8.5pt;">100</th>
<td id="A3.T7.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.5pt;padding-right:8.5pt;">0.805±0.0037</td>
<td id="A3.T7.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.5pt;padding-right:8.5pt;">0.796</td>
<td id="A3.T7.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.5pt;padding-right:8.5pt;">0.817</td>
<td id="A3.T7.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:8.5pt;padding-right:8.5pt;">0.021</td>
</tr>
<tr id="A3.T7.1.3.2" class="ltx_tr">
<th id="A3.T7.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" style="padding-left:8.5pt;padding-right:8.5pt;">1000</th>
<td id="A3.T7.1.3.2.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:8.5pt;padding-right:8.5pt;">0.806±0.0036</td>
<td id="A3.T7.1.3.2.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:8.5pt;padding-right:8.5pt;">0.795</td>
<td id="A3.T7.1.3.2.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:8.5pt;padding-right:8.5pt;">0.817</td>
<td id="A3.T7.1.3.2.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:8.5pt;padding-right:8.5pt;">0.022</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 7: </span>Effects of randomness in PointTransformerDDA+.</figcaption>
</figure>
<figure id="A3.T8" class="ltx_table">
<table id="A3.T8.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T8.1.1.1" class="ltx_tr">
<th id="A3.T8.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Position</th>
<th id="A3.T8.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Average</th>
<th id="A3.T8.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Site A</th>
<th id="A3.T8.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Site B</th>
<th id="A3.T8.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Site C</th>
<th id="A3.T8.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">Site D</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T8.1.2.1" class="ltx_tr">
<th id="A3.T8.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">0</th>
<td id="A3.T8.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">0.700</td>
<td id="A3.T8.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">0.670</td>
<td id="A3.T8.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">0.721</td>
<td id="A3.T8.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">0.704</td>
<td id="A3.T8.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.7pt;padding-right:5.7pt;">0.676</td>
</tr>
<tr id="A3.T8.1.3.2" class="ltx_tr">
<th id="A3.T8.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:5.7pt;padding-right:5.7pt;">1</th>
<td id="A3.T8.1.3.2.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">0.709</td>
<td id="A3.T8.1.3.2.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">0.663</td>
<td id="A3.T8.1.3.2.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">0.733</td>
<td id="A3.T8.1.3.2.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">0.698</td>
<td id="A3.T8.1.3.2.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">0.714</td>
</tr>
<tr id="A3.T8.1.4.3" class="ltx_tr">
<th id="A3.T8.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:5.7pt;padding-right:5.7pt;">Pos</th>
<td id="A3.T8.1.4.3.2" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">0.765</td>
<td id="A3.T8.1.4.3.3" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">0.707</td>
<td id="A3.T8.1.4.3.4" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">0.805</td>
<td id="A3.T8.1.4.3.5" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;"><span id="A3.T8.1.4.3.5.1" class="ltx_text ltx_font_bold">0.787</span></td>
<td id="A3.T8.1.4.3.6" class="ltx_td ltx_align_center" style="padding-left:5.7pt;padding-right:5.7pt;">0.696</td>
</tr>
<tr id="A3.T8.1.5.4" class="ltx_tr">
<th id="A3.T8.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" style="padding-left:5.7pt;padding-right:5.7pt;">Pos + Aug</th>
<td id="A3.T8.1.5.4.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:5.7pt;padding-right:5.7pt;"><span id="A3.T8.1.5.4.2.1" class="ltx_text ltx_font_bold">0.771</span></td>
<td id="A3.T8.1.5.4.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:5.7pt;padding-right:5.7pt;"><span id="A3.T8.1.5.4.3.1" class="ltx_text ltx_font_bold">0.717</span></td>
<td id="A3.T8.1.5.4.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:5.7pt;padding-right:5.7pt;"><span id="A3.T8.1.5.4.4.1" class="ltx_text ltx_font_bold">0.834</span></td>
<td id="A3.T8.1.5.4.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:5.7pt;padding-right:5.7pt;">0.776</td>
<td id="A3.T8.1.5.4.6" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:5.7pt;padding-right:5.7pt;"><span id="A3.T8.1.5.4.6.1" class="ltx_text ltx_font_bold">0.721</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 8: </span>The effects of position information and point data augmentation in PointTransformer.</figcaption>
</figure>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.1" class="ltx_p">Table <a href="#A3.T8" title="Table 8 ‣ Appendix C Further Analysis of PointTransformer ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows that point data augmentation can increase HER2 prediction performance (AUC: 0.771 vs 0.765). Note that point augmentation is another feature that does not exist in the existing methods. We also evaluate the position effect by replacing the point position information with 0 or 1. In Table <a href="#A3.T8" title="Table 8 ‣ Appendix C Further Analysis of PointTransformer ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, we can observe that the model’s performance significantly decreases when position information is omitted. This highlights the importance of incorporating point position information for WSI analysis.</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Further Analysis of Federated Learning</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p">In this section, we first evaluate the effect of group normalization’s number selection. Table <a href="#A4.T9" title="Table 9 ‣ Appendix D Further Analysis of Federated Learning ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> shows that our data is very sensitive to the choice of group number. Extreme group numbers (1: Layer Normalization, Max: Instance Normalization) and small group numbers lead to poor performance. On the other hand, group numbers 8 or 32 exhibit improved performance. Therefore, while group normalization can yield favorable results, it requires careful selection of the group number for our real-world WSIs.</p>
</div>
<figure id="A4.T9" class="ltx_table">
<table id="A4.T9.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A4.T9.1.1.1" class="ltx_tr">
<th id="A4.T9.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">Group Number</th>
<th id="A4.T9.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">Average</th>
<th id="A4.T9.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">Site A</th>
<th id="A4.T9.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">Site B</th>
<th id="A4.T9.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">Site C</th>
<th id="A4.T9.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">Site D</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A4.T9.1.2.1" class="ltx_tr">
<th id="A4.T9.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">1 (Layer Norm)</th>
<td id="A4.T9.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">0.688</td>
<td id="A4.T9.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">0.638</td>
<td id="A4.T9.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">0.700</td>
<td id="A4.T9.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">0.694</td>
<td id="A4.T9.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">0.678</td>
</tr>
<tr id="A4.T9.1.3.2" class="ltx_tr">
<th id="A4.T9.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">2</th>
<td id="A4.T9.1.3.2.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.595</td>
<td id="A4.T9.1.3.2.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.528</td>
<td id="A4.T9.1.3.2.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.635</td>
<td id="A4.T9.1.3.2.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.579</td>
<td id="A4.T9.1.3.2.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.607</td>
</tr>
<tr id="A4.T9.1.4.3" class="ltx_tr">
<th id="A4.T9.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">4</th>
<td id="A4.T9.1.4.3.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.659</td>
<td id="A4.T9.1.4.3.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.586</td>
<td id="A4.T9.1.4.3.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.655</td>
<td id="A4.T9.1.4.3.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.626</td>
<td id="A4.T9.1.4.3.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.653</td>
</tr>
<tr id="A4.T9.1.5.4" class="ltx_tr">
<th id="A4.T9.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">8</th>
<td id="A4.T9.1.5.4.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="A4.T9.1.5.4.2.1" class="ltx_text ltx_font_bold">0.783</span></td>
<td id="A4.T9.1.5.4.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.733</td>
<td id="A4.T9.1.5.4.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.832</td>
<td id="A4.T9.1.5.4.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.775</td>
<td id="A4.T9.1.5.4.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.768</td>
</tr>
<tr id="A4.T9.1.6.5" class="ltx_tr">
<th id="A4.T9.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">16</th>
<td id="A4.T9.1.6.5.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.757</td>
<td id="A4.T9.1.6.5.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.720</td>
<td id="A4.T9.1.6.5.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.805</td>
<td id="A4.T9.1.6.5.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.738</td>
<td id="A4.T9.1.6.5.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.770</td>
</tr>
<tr id="A4.T9.1.7.6" class="ltx_tr">
<th id="A4.T9.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">32</th>
<td id="A4.T9.1.7.6.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.782</td>
<td id="A4.T9.1.7.6.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.755</td>
<td id="A4.T9.1.7.6.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.833</td>
<td id="A4.T9.1.7.6.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.778</td>
<td id="A4.T9.1.7.6.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.767</td>
</tr>
<tr id="A4.T9.1.8.7" class="ltx_tr">
<th id="A4.T9.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" style="padding-left:2.8pt;padding-right:2.8pt;">64</th>
<td id="A4.T9.1.8.7.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.771</td>
<td id="A4.T9.1.8.7.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.739</td>
<td id="A4.T9.1.8.7.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.828</td>
<td id="A4.T9.1.8.7.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.775</td>
<td id="A4.T9.1.8.7.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">0.754</td>
</tr>
<tr id="A4.T9.1.9.8" class="ltx_tr">
<th id="A4.T9.1.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b" style="padding-left:2.8pt;padding-right:2.8pt;">MAX (Instance Norm)</th>
<td id="A4.T9.1.9.8.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:2.8pt;padding-right:2.8pt;">0.532</td>
<td id="A4.T9.1.9.8.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:2.8pt;padding-right:2.8pt;">0.523</td>
<td id="A4.T9.1.9.8.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:2.8pt;padding-right:2.8pt;">0.538</td>
<td id="A4.T9.1.9.8.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:2.8pt;padding-right:2.8pt;">0.529</td>
<td id="A4.T9.1.9.8.6" class="ltx_td ltx_align_center ltx_border_b" style="padding-left:2.8pt;padding-right:2.8pt;">0.542</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 9: </span>Performance of the point transformer using group normalization with different group numbers.</figcaption>
</figure>
<div id="A4.p2" class="ltx_para">
<p id="A4.p2.1" class="ltx_p">Considering the variations in hardware and network quality, different sites may experience delays in communication frequency. We simulate a scene in which sites communicate with different paces ranging from 1 to 32. Figure <a href="#A4.F6" title="Figure 6 ‣ Appendix D Further Analysis of Federated Learning ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> represents that our proposed PointTransformerDDA+ is more robust compared to the base PointTransformer, which demonstrates the effectiveness of our proposed components. Even with a pace of 32, our model still yields an AUC of 0.738, while the base PointTransformer shows a large performance decrement.</p>
</div>
<figure id="A4.F6" class="ltx_figure"><img src="/html/2312.06454/assets/data_E.png" id="A4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="321" height="235" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Performance compassion with different communication paces E.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Model Visualization</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">We further try to visualize our model using integrated gradients <cite class="ltx_cite ltx_citemacro_citep">(Sundararajan, Taly, and Yan <a href="#bib.bib40" title="" class="ltx_ref">2017</a>)</cite>. Generally pathologists should access the HER2 status from IHC-stained WSI as shown in the right part of Figure <a href="#A5.F7" title="Figure 7 ‣ Appendix E Model Visualization ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. Deriving HER2 status from HE-stained WSI is challenging compared to IHC-stained WSI. However, our model can capture the deep IHC-stained area from HE-stained WSI as shown in the left part of Figure <a href="#A5.F7" title="Figure 7 ‣ Appendix E Model Visualization ‣ Point Transformer with Federated Learning for Predicting Breast Cancer HER2 Status from Hematoxylin and Eosin-Stained Whole Slide Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<figure id="A5.F7" class="ltx_figure"><img src="/html/2312.06454/assets/wsi_viz.png" id="A5.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="314" height="149" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Visualization of a representative HE-stained WSI and its corresponding IHC-stained WSI with IHC score 3+.</figcaption>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2312.06453" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2312.06454" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2312.06454">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2312.06454" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2312.06455" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 14:10:37 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
