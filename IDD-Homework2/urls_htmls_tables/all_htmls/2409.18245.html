<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2409.18245] PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models</title><meta property="og:description" content="We present PDFed, a decentralized, aggregator-free, and asynchronous federated learning protocol for training image diffusion models using a public blockchain. In general, diffusion models are prone to memorization of …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2409.18245">

<!--Generated on Sun Oct  6 01:46:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kar Balan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:k.balan@surrey.ac.uk">k.balan@surrey.ac.uk</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0009-0004-1296-9254" title="ORCID identifier" class="ltx_ref">0009-0004-1296-9254</a></span>

<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_affiliation_institution">University of Surrey</span><span id="id2.2.id2" class="ltx_text ltx_affiliation_city">Guildford</span><span id="id3.3.id3" class="ltx_text ltx_affiliation_country">United Kingdom</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Andrew Gilbert
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:a.gilbert@surrey.ac.uk">a.gilbert@surrey.ac.uk</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0003-3898-0596" title="ORCID identifier" class="ltx_ref">0000-0003-3898-0596</a></span>

<span class="ltx_contact ltx_role_affiliation"><span id="id4.1.id1" class="ltx_text ltx_affiliation_institution">University of Surrey</span><span id="id5.2.id2" class="ltx_text ltx_affiliation_streetaddress">Stag Hill, University Campus</span><span id="id6.3.id3" class="ltx_text ltx_affiliation_city">Guildford</span><span id="id7.4.id4" class="ltx_text ltx_affiliation_country">United Kingdom</span><span id="id8.5.id5" class="ltx_text ltx_affiliation_postcode">GU2 7XH</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">John Collomosse
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:collomos@adobe.com">collomos@adobe.com</a>
</span>
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0003-3580-4685" title="ORCID identifier" class="ltx_ref">0000-0003-3580-4685</a></span>

<span class="ltx_contact ltx_role_affiliation"><span id="id9.1.id1" class="ltx_text ltx_affiliation_institution">Adobe Research</span><span id="id10.2.id2" class="ltx_text ltx_affiliation_city">San Jose</span><span id="id11.3.id3" class="ltx_text ltx_affiliation_country">USA</span>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id12.id1" class="ltx_p">We present PDFed, a decentralized, aggregator-free, and asynchronous federated learning protocol for training image diffusion models using a public blockchain. In general, diffusion models are prone to memorization of training data, raising privacy and ethical concerns (e.g., regurgitation of private training data in generated images). Federated learning (FL) offers a partial solution via collaborative model training across distributed nodes that safeguard local data privacy. PDFed proposes a novel sample-based score that measures the novelty and quality of generated samples, incorporating these into a blockchain-based federated learning protocol that we show reduces private data memorization in the collaboratively trained model. In addition, PDFed enables asynchronous collaboration among participants with varying hardware capabilities, facilitating broader participation. The protocol records the provenance of AI models, improving transparency and auditability, while also considering automated incentive and reward mechanisms for participants. PDFed aims to empower artists and creators by protecting the privacy of creative works and enabling decentralized, peer-to-peer collaboration. The protocol positively impacts the creative economy by opening up novel revenue streams and fostering innovative ways for artists to benefit from their contributions to the AI space.</p>
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_journalyear"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span id="id2" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span id="id3" class="ltx_note ltx_note_frontmatter ltx_role_conference"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>European Conference on Visual Media Production; November 18–19, 2024; London, United Kingdom</span></span></span><span id="id4" class="ltx_note ltx_note_frontmatter ltx_role_booktitle"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">booktitle: </span>European Conference on Visual Media Production (CVMP ’24), November 18–19, 2024, London, United Kingdom</span></span></span><span id="id5" class="ltx_note ltx_note_frontmatter ltx_role_doi"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>10.1145/3697294.3697306</span></span></span><span id="id6" class="ltx_note ltx_note_frontmatter ltx_role_isbn"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>979-8-4007-1281-4/24/11</span></span></span><span id="id7" class="ltx_note ltx_note_frontmatter ltx_role_submissionid"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">submissionid: </span>12</span></span></span><span id="id8" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Cooperation and coordination</span></span></span><span id="id9" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Computer vision tasks</span></span></span><span id="id10" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Distributed artificial intelligence</span></span></span><span id="id11" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computer systems organization Peer-to-peer architectures</span></span></span><span id="id12" class="ltx_note ltx_note_frontmatter ltx_role_ccs"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Applied computing Media arts</span></span></span>
<figure id="S0.F1" class="ltx_figure ltx_teaserfigure"><img src="/html/2409.18245/assets/figs/teaser.png" id="S0.F1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="115" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>Data memorization presents a privacy challenge for the federated training of diffusion models, where private data can be regurgitated as training progresses. PDFed proposes a novel measure and mitigation of this behavior through an aggregator-free distributed training protocol using distributed ledger technology (DLT), or ‘blockchain’ that we later show reduces data memorization.</figcaption>
</figure>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Diffusion models are a powerful class of generative AI (GenAI) algorithms transforming creative practice by democratizing the ability to create realistic and readily customizable visual content. Diffusion models require training on vast datasets to achieve state-of-the-art performance. However, collecting and using such data poses significant challenges, including privacy, copyright, and creator consent. In particular, diffusion models are prone to <span id="S1.p1.1.1" class="ltx_text ltx_font_italic">training data memorization</span> and often regurgitate training data within generated content. This poses data privacy risks, particularly for copyrighted creative works or identifiable personal images. As a result, there is a growing demand for privacy-preserving methods that enable ethical diffusion model training while respecting data privacy.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Federated learning (FL) is a machine learning approach that enables model training across decentralized edge devices or servers, each holding local data samples without exchanging or exposing them. FL emerged as a solution to the pressing demand for individuals and organizations to maintain control over their data while still participating in the collective training of AI models. Integrating diffusion models with FL allows for collaborative training across distributed datasets while safeguarding data privacy and security, unlocking new opportunities for models to access and learn from diverse datasets that would otherwise be inaccessible. Existing FL <cite class="ltx_cite ltx_citemacro_citep">(Behera et al<span class="ltx_text">.</span>, <a href="#bib.bib6" title="" class="ltx_ref">2022</a>; Mugunthan et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2020</a>; Yun et al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2023</a>)</cite> approaches typically require a trusted, centralized node to orchestrate the training process, including aggregating model submissions and disseminating updates to participating nodes. This centralized node can become a single point of failure and a privacy risk if compromised, and its operations may lack transparency. Constant communication between the central and participating nodes also introduces a significant communication overhead. This overhead, coupled with a requirement for new participants to wait for the aggregation result until the current training round concludes, introduces latency.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p"><em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">PDFed</em> addresses these issues by leveraging federated learning principles while introducing a decentralized and asynchronous framework to enhance privacy preservation, model performance, and training efficiency. Reliance on a centralized server is eschewed in favor of orchestrating the training process via distributed ledger technology (DLT), namely the Ethereum public ‘blockchain’. To address the phenomenon of training data memorization in diffusion models, we propose and integrate a parametric sample-based score into our training framework, which measures sample novelty, fidelity, and quality. PDFed makes the following two technical contributions:</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">1. <span id="S1.p4.1.1" class="ltx_text ltx_font_bold">Asynchronous, aggregator-free and decentralized federated learning protocol.</span> PDFed is the first federated learning framework for training diffusion models that does not require a central coordinator or aggregator. Instead, we take advantage of the decentralized, leaderless nature of public blockchains, allowing participants to operate asynchronously and independently according to a local training strategy. We also permit validation-only participants, enabling agents who hold data but don’t have the hardware resources necessary for active model training to contribute by voting for the best scoring of the submitted models, facilitating broader participation.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">2. <span id="S1.p5.1.1" class="ltx_text ltx_font_bold">Quality-novelty (Q-N) objective.</span> To guide model training, a Q-N score is proposed. Generated samples undergo a visual fingerprinting step, followed by a KNN search to obtain a shortlist of samples close to the training data, implying local memorization. The pairs of generated images and training samples are then passed to a second model, which outputs a content similarity score for each pair. The proposed metric is based on this content similarity score and the FID score of all generated samples. The proposed metric acts as an objective function within the training framework, aiding in selecting models for further training, favoring those with lower memorization levels, and successfully driving a trend towards reduced memorization. Additionally, the score is leveraged at the data loader level, ensuring that previously identified memorized training images are excluded from further use in model training. This method effectively acts as a decentralized, privacy-preserving training data deduplication system in the distributed training scenario.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Diffusion models</span> have enabled recent advancements in Generative AI, producing realistic samples across various modalities such as images and video. Despite requiring datasets comprising millions of samples for training, they have been observed to exhibit training data memorization, particularly in content and style, attributed to duplicated data within the training dataset. Carlini et al. <cite class="ltx_cite ltx_citemacro_citep">(Carlini et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2023</a>)</cite> and Somepalli et al. <cite class="ltx_cite ltx_citemacro_citep">(Somepalli et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2023</a>)</cite> confirm memorization in diffusion models across datasets of varying scales and conditioning types and demonstrate that training data deduplication is effective in reducing training data memorization. In a distributed, privacy-preserving training scenario, participants cannot know whether they hold duplicate data as other participants without compromising their data privacy. There’s a research gap in privacy-preserving, distributed image data deduplication. Stein et al. <cite class="ltx_cite ltx_citemacro_citep">(Stein et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2023</a>)</cite> and Yoon et al. <cite class="ltx_cite ltx_citemacro_citep">(Yoon et al<span class="ltx_text">.</span>, <a href="#bib.bib27" title="" class="ltx_ref">2023</a>)</cite> further explore the conditions that contribute to memorization and identify several influential factors such as random, uninformative, or highly specific labels, model capacity, dataset size and complexity, distribution of rare-common images and concepts, and type of conditioning. EKILA <cite class="ltx_cite ltx_citemacro_citep">(Balan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2023a</a>)</cite> introduces a framework for identifying the training samples most influential for a specific generated image, enabling the authors of those training images to be rewarded for their contributions.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.3" class="ltx_p"><span id="S2.p2.3.1" class="ltx_text ltx_font_bold">Memorization metrics.</span> Several metrics have been proposed to assess the novelty, diversity, and fidelity of diffusion model-generated samples. AuthPct <cite class="ltx_cite ltx_citemacro_citep">(Alaa et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite> deems each generated sample either as authentic or inauthentic based on whether the distance to the nearest point in the training set is less than the distance between that training sample and its nearest neighbor in the training set. The <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S2.p2.1.m1.1a"><msub id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">C</mi><mi id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">𝐶</ci><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">C_{T}</annotation></semantics></math> score <cite class="ltx_cite ltx_citemacro_citep">(Meehan et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite> summarizes how often training samples are closer to generated samples than to samples in the test set through a Mann-Whitney hypothesis test<cite class="ltx_cite ltx_citemacro_citep">(Mann and Whitney, <a href="#bib.bib16" title="" class="ltx_ref">1947</a>)</cite>. Jiralerspong et al. <cite class="ltx_cite ltx_citemacro_citep">(Jiralerspong et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2023</a>)</cite> propose the FLD score, a parametric sample-based score that relies on density estimation in feature space to compute the perceptual likelihood of generated samples. <cite class="ltx_cite ltx_citemacro_citep">(Stein et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2023</a>)</cite> finds that AuthPct <cite class="ltx_cite ltx_citemacro_citep">(Alaa et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite>, <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S2.p2.2.m2.1a"><msub id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">C</mi><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝐶</ci><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">C_{T}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Meehan et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>, and FLD <cite class="ltx_cite ltx_citemacro_citep">(Jiralerspong et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2023</a>)</cite> scores are only sensitive to memorization in an ideal scenario where all samples become increasingly memorized and that AuthPct and <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S2.p2.3.m3.1a"><msub id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">C</mi><mi id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">𝐶</ci><ci id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">C_{T}</annotation></semantics></math> scores detect mode shrinking and image fidelity more than memorization.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Distributed Ledger Technology</span> (the most well known implementation is ’blockchain’) is a decentralized system that facilitates the secure and transparent recording of transactions across multiple nodes or participants. Unlike traditional centralized systems, DLT does not rely on a single point of control or trust. Instead, it enables consensus mechanisms that allow all participants to agree on the validity of transactions without the need for intermediaries or central authorities. While initially popularized by cryptocurrencies such as Bitcoin, the applications of DLT have evolved beyond finance, with many innovative applications for social good. DLT has been used in digital preservation, where it ensures the integrity and immutability of data over time<cite class="ltx_cite ltx_citemacro_citep">(Bui et al<span class="ltx_text">.</span>, <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite>, and in AI training, to determine author consent for specific data to be used<cite class="ltx_cite ltx_citemacro_citep">(Balan et al<span class="ltx_text">.</span>, <a href="#bib.bib4" title="" class="ltx_ref">2023b</a>)</cite>. Smart contracts are self-executing programs automatically enforced and executed on a blockchain network without intermediaries. The event log is a ledger of signals or exceptions emitted from smart contract code.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Federated Learning</span> addresses data privacy by collaboratively training models without pooling or exchanging the training data. <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al<span class="ltx_text">.</span>, <a href="#bib.bib29" title="" class="ltx_ref">2024</a>)</cite> propose one-shot FL frameworks in which workers train diffusion models using their privately held data, such that data can subsequently be generated conforming to the global class distribution to alleviate the non-IID data problem.
<cite class="ltx_cite ltx_citemacro_citep">(Tun et al<span class="ltx_text">.</span>, <a href="#bib.bib25" title="" class="ltx_ref">2023</a>)</cite> explores several FL scenarios for training diffusion models, investigating the effects of varying the data heterogeneity across clients, the number of clients, and the number of training rounds and epochs; they obtain comparable results to centralized training and find that distinct data distributions lead to local models being biased towards local data, which can challenge model aggregation and affect global model performance in early FL rounds. The inherent technical capabilities of DLT make it a natural choice for integrating with FL frameworks. <cite class="ltx_cite ltx_citemacro_citep">(Yun et al<span class="ltx_text">.</span>, <a href="#bib.bib28" title="" class="ltx_ref">2023</a>)</cite> proposes building a specialized blockchain with a bespoke consensus mechanism for a federated learning task. <cite class="ltx_cite ltx_citemacro_citep">(Tomiyama et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2023</a>)</cite> abolishes the concept of rounds, allowing workers to operate independently without the need for synchronization or a central aggregator. However, nodes’ participation is time-limited. <cite class="ltx_cite ltx_citemacro_citep">(Ramanan and Nakayama, <a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite> proposes an aggregator-free FL system, storing the global model as serialized chunks within a smart contract. Workers place bids to update specific chunks, and the highest-scoring one pushes the update to the smart contract. In Blockflow<cite class="ltx_cite ltx_citemacro_citep">(Mugunthan et al<span class="ltx_text">.</span>, <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>, all client nodes report evaluation scores for all submitted models, which the smart contract uses to calculate the weights for model aggregation conducted locally by all clients. Blockflow enforces strict deadlines during rounds, removing client nodes that are slower to submit. None of these solutions explore DLT for training diffusion models or seek to mitigate diffusion memorization specifically.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Measuring and Mitigating Memorization</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">PDFed is a privacy-preserving, decentralized, federated learning framework for training diffusion models while successfully reducing private data memorization and building an auditable model provenance chain, significantly contributing to transparently building ethical AI models. It is asynchronous and aggregator-free, each node employing a local training strategy. We now describe PDFed, first focusing on the proposed methodology for measuring memorization in the trained model, which is used within the FL process (Sec. <a href="#S4" title="4. Federated Learning Framework ‣ PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) to govern model validation and selection.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">We propose a method to identify memorized training samples and a parametric sample-based score that measures the novelty, fidelity, and quality of images generated by GenAI models. The score may be implemented as a loss function in GenAI training, allowing monitoring and measuring the memorization rate and optimizing training to minimize this behavior. The score is based on a content similarity score between training data and generated samples and the widely utilized FID score. Obtaining the content similarity score is a 3-step process: 1) establishing a distance threshold based on statistical properties of the training data to identify generated samples unusually close to the training data for further analysis, 2) partial matching based on image fingerprints extracted from generated and training data and 3) pairwise verification and scoring of retrievals from the previous step.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Model Architectures</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p"><span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_bold">Image fingerprinting.</span> Similar to <cite class="ltx_cite ltx_citemacro_citep">(Balan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2023a</a>)</cite>, we adapt the visual fingerprinting approach introduced by <cite class="ltx_cite ltx_citemacro_citep">(Black et al<span class="ltx_text">.</span>, <a href="#bib.bib7" title="" class="ltx_ref">2021</a>)</cite> to generate compact, 256-dimensional embeddings of the generated and training images, enabling retrieval of visually similar pairs at scale. The fingerprinting model is trained using a contrastive learning approach <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a href="#bib.bib10" title="" class="ltx_ref">2020</a>)</cite> to be discriminative of image content while robust to image degradations and manipulations.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.3" class="ltx_p">Given an image <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝑥</ci><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">x_{i}</annotation></semantics></math>, we denote its embedding obtained from a ResNet-50 model as <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\phi_{i}=E(x_{i})\in\mathbb{R}^{256}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><msub id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml"><mi id="S3.SS1.p2.2.m2.1.1.3.2" xref="S3.SS1.p2.2.m2.1.1.3.2.cmml">ϕ</mi><mi id="S3.SS1.p2.2.m2.1.1.3.3" xref="S3.SS1.p2.2.m2.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS1.p2.2.m2.1.1.4" xref="S3.SS1.p2.2.m2.1.1.4.cmml">=</mo><mrow id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.3.cmml">E</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.2.m2.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p2.2.m2.1.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p2.2.m2.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p2.2.m2.1.1.5" xref="S3.SS1.p2.2.m2.1.1.5.cmml">∈</mo><msup id="S3.SS1.p2.2.m2.1.1.6" xref="S3.SS1.p2.2.m2.1.1.6.cmml"><mi id="S3.SS1.p2.2.m2.1.1.6.2" xref="S3.SS1.p2.2.m2.1.1.6.2.cmml">ℝ</mi><mn id="S3.SS1.p2.2.m2.1.1.6.3" xref="S3.SS1.p2.2.m2.1.1.6.3.cmml">256</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><and id="S3.SS1.p2.2.m2.1.1a.cmml" xref="S3.SS1.p2.2.m2.1.1"></and><apply id="S3.SS1.p2.2.m2.1.1b.cmml" xref="S3.SS1.p2.2.m2.1.1"><eq id="S3.SS1.p2.2.m2.1.1.4.cmml" xref="S3.SS1.p2.2.m2.1.1.4"></eq><apply id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.3.1.cmml" xref="S3.SS1.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.3.2.cmml" xref="S3.SS1.p2.2.m2.1.1.3.2">italic-ϕ</ci><ci id="S3.SS1.p2.2.m2.1.1.3.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3.3">𝑖</ci></apply><apply id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1"><times id="S3.SS1.p2.2.m2.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.2"></times><ci id="S3.SS1.p2.2.m2.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.3">𝐸</ci><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.SS1.p2.2.m2.1.1c.cmml" xref="S3.SS1.p2.2.m2.1.1"><in id="S3.SS1.p2.2.m2.1.1.5.cmml" xref="S3.SS1.p2.2.m2.1.1.5"></in><share href="#S3.SS1.p2.2.m2.1.1.1.cmml" id="S3.SS1.p2.2.m2.1.1d.cmml" xref="S3.SS1.p2.2.m2.1.1"></share><apply id="S3.SS1.p2.2.m2.1.1.6.cmml" xref="S3.SS1.p2.2.m2.1.1.6"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.6.1.cmml" xref="S3.SS1.p2.2.m2.1.1.6">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.6.2.cmml" xref="S3.SS1.p2.2.m2.1.1.6.2">ℝ</ci><cn type="integer" id="S3.SS1.p2.2.m2.1.1.6.3.cmml" xref="S3.SS1.p2.2.m2.1.1.6.3">256</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\phi_{i}=E(x_{i})\in\mathbb{R}^{256}</annotation></semantics></math>, with <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="\hat{\phi}i" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mrow id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mover accent="true" id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2.2" xref="S3.SS1.p2.3.m3.1.1.2.2.cmml">ϕ</mi><mo id="S3.SS1.p2.3.m3.1.1.2.1" xref="S3.SS1.p2.3.m3.1.1.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S3.SS1.p2.3.m3.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.cmml">​</mo><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">i</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><times id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1"></times><apply id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2"><ci id="S3.SS1.p2.3.m3.1.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.1.2.1">^</ci><ci id="S3.SS1.p2.3.m3.1.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2.2">italic-ϕ</ci></apply><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\hat{\phi}i</annotation></semantics></math> representing an augmented version of the same image. The training objective is:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.8" class="ltx_Math" alttext="\mathcal{L}_{C}=-\sum_{i\in\mathcal{B}}\log\left(\frac{d\left(\phi_{i},\hat{\phi}_{i}\right)}{d\left(\phi_{i},\hat{\phi}_{i}\right)+\sum_{j\neq i\in\mathcal{B}}d\left(\phi_{i},\phi_{j}\right)}\right)," display="block"><semantics id="S3.E1.m1.8a"><mrow id="S3.E1.m1.8.8.1" xref="S3.E1.m1.8.8.1.1.cmml"><mrow id="S3.E1.m1.8.8.1.1" xref="S3.E1.m1.8.8.1.1.cmml"><msub id="S3.E1.m1.8.8.1.1.2" xref="S3.E1.m1.8.8.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.8.8.1.1.2.2" xref="S3.E1.m1.8.8.1.1.2.2.cmml">ℒ</mi><mi id="S3.E1.m1.8.8.1.1.2.3" xref="S3.E1.m1.8.8.1.1.2.3.cmml">C</mi></msub><mo id="S3.E1.m1.8.8.1.1.1" xref="S3.E1.m1.8.8.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.8.8.1.1.3" xref="S3.E1.m1.8.8.1.1.3.cmml"><mo id="S3.E1.m1.8.8.1.1.3a" xref="S3.E1.m1.8.8.1.1.3.cmml">−</mo><mrow id="S3.E1.m1.8.8.1.1.3.2" xref="S3.E1.m1.8.8.1.1.3.2.cmml"><munder id="S3.E1.m1.8.8.1.1.3.2.1" xref="S3.E1.m1.8.8.1.1.3.2.1.cmml"><mo movablelimits="false" id="S3.E1.m1.8.8.1.1.3.2.1.2" xref="S3.E1.m1.8.8.1.1.3.2.1.2.cmml">∑</mo><mrow id="S3.E1.m1.8.8.1.1.3.2.1.3" xref="S3.E1.m1.8.8.1.1.3.2.1.3.cmml"><mi id="S3.E1.m1.8.8.1.1.3.2.1.3.2" xref="S3.E1.m1.8.8.1.1.3.2.1.3.2.cmml">i</mi><mo id="S3.E1.m1.8.8.1.1.3.2.1.3.1" xref="S3.E1.m1.8.8.1.1.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.8.8.1.1.3.2.1.3.3" xref="S3.E1.m1.8.8.1.1.3.2.1.3.3.cmml">ℬ</mi></mrow></munder><mrow id="S3.E1.m1.8.8.1.1.3.2.2.2" xref="S3.E1.m1.8.8.1.1.3.2.2.1.cmml"><mi id="S3.E1.m1.7.7" xref="S3.E1.m1.7.7.cmml">log</mi><mo id="S3.E1.m1.8.8.1.1.3.2.2.2a" xref="S3.E1.m1.8.8.1.1.3.2.2.1.cmml">⁡</mo><mrow id="S3.E1.m1.8.8.1.1.3.2.2.2.1" xref="S3.E1.m1.8.8.1.1.3.2.2.1.cmml"><mo id="S3.E1.m1.8.8.1.1.3.2.2.2.1.1" xref="S3.E1.m1.8.8.1.1.3.2.2.1.cmml">(</mo><mfrac id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.2.2.2" xref="S3.E1.m1.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E1.m1.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.3.cmml"><mo id="S3.E1.m1.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.2.2.2.2.2.4" xref="S3.E1.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.E1.m1.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.cmml"><mover accent="true" id="S3.E1.m1.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.2.2.2.2.cmml">ϕ</mi><mo id="S3.E1.m1.2.2.2.2.2.2.2.1" xref="S3.E1.m1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E1.m1.2.2.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.2.2.2.2.2.5" xref="S3.E1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E1.m1.6.6.6" xref="S3.E1.m1.6.6.6.cmml"><mrow id="S3.E1.m1.4.4.4.2" xref="S3.E1.m1.4.4.4.2.cmml"><mi id="S3.E1.m1.4.4.4.2.4" xref="S3.E1.m1.4.4.4.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.4.2.3" xref="S3.E1.m1.4.4.4.2.3.cmml">​</mo><mrow id="S3.E1.m1.4.4.4.2.2.2" xref="S3.E1.m1.4.4.4.2.2.3.cmml"><mo id="S3.E1.m1.4.4.4.2.2.2.3" xref="S3.E1.m1.4.4.4.2.2.3.cmml">(</mo><msub id="S3.E1.m1.3.3.3.1.1.1.1" xref="S3.E1.m1.3.3.3.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.3.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.E1.m1.3.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.4.4.4.2.2.2.4" xref="S3.E1.m1.4.4.4.2.2.3.cmml">,</mo><msub id="S3.E1.m1.4.4.4.2.2.2.2" xref="S3.E1.m1.4.4.4.2.2.2.2.cmml"><mover accent="true" id="S3.E1.m1.4.4.4.2.2.2.2.2" xref="S3.E1.m1.4.4.4.2.2.2.2.2.cmml"><mi id="S3.E1.m1.4.4.4.2.2.2.2.2.2" xref="S3.E1.m1.4.4.4.2.2.2.2.2.2.cmml">ϕ</mi><mo id="S3.E1.m1.4.4.4.2.2.2.2.2.1" xref="S3.E1.m1.4.4.4.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.E1.m1.4.4.4.2.2.2.2.3" xref="S3.E1.m1.4.4.4.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.4.4.4.2.2.2.5" xref="S3.E1.m1.4.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo rspace="0.055em" id="S3.E1.m1.6.6.6.5" xref="S3.E1.m1.6.6.6.5.cmml">+</mo><mrow id="S3.E1.m1.6.6.6.4" xref="S3.E1.m1.6.6.6.4.cmml"><msub id="S3.E1.m1.6.6.6.4.3" xref="S3.E1.m1.6.6.6.4.3.cmml"><mo id="S3.E1.m1.6.6.6.4.3.2" xref="S3.E1.m1.6.6.6.4.3.2.cmml">∑</mo><mrow id="S3.E1.m1.6.6.6.4.3.3" xref="S3.E1.m1.6.6.6.4.3.3.cmml"><mi id="S3.E1.m1.6.6.6.4.3.3.2" xref="S3.E1.m1.6.6.6.4.3.3.2.cmml">j</mi><mo id="S3.E1.m1.6.6.6.4.3.3.3" xref="S3.E1.m1.6.6.6.4.3.3.3.cmml">≠</mo><mi id="S3.E1.m1.6.6.6.4.3.3.4" xref="S3.E1.m1.6.6.6.4.3.3.4.cmml">i</mi><mo id="S3.E1.m1.6.6.6.4.3.3.5" xref="S3.E1.m1.6.6.6.4.3.3.5.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.6.6.6.4.3.3.6" xref="S3.E1.m1.6.6.6.4.3.3.6.cmml">ℬ</mi></mrow></msub><mrow id="S3.E1.m1.6.6.6.4.2" xref="S3.E1.m1.6.6.6.4.2.cmml"><mi id="S3.E1.m1.6.6.6.4.2.4" xref="S3.E1.m1.6.6.6.4.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.6.4.2.3" xref="S3.E1.m1.6.6.6.4.2.3.cmml">​</mo><mrow id="S3.E1.m1.6.6.6.4.2.2.2" xref="S3.E1.m1.6.6.6.4.2.2.3.cmml"><mo id="S3.E1.m1.6.6.6.4.2.2.2.3" xref="S3.E1.m1.6.6.6.4.2.2.3.cmml">(</mo><msub id="S3.E1.m1.5.5.5.3.1.1.1.1" xref="S3.E1.m1.5.5.5.3.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.5.3.1.1.1.1.2" xref="S3.E1.m1.5.5.5.3.1.1.1.1.2.cmml">ϕ</mi><mi id="S3.E1.m1.5.5.5.3.1.1.1.1.3" xref="S3.E1.m1.5.5.5.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.6.6.6.4.2.2.2.4" xref="S3.E1.m1.6.6.6.4.2.2.3.cmml">,</mo><msub id="S3.E1.m1.6.6.6.4.2.2.2.2" xref="S3.E1.m1.6.6.6.4.2.2.2.2.cmml"><mi id="S3.E1.m1.6.6.6.4.2.2.2.2.2" xref="S3.E1.m1.6.6.6.4.2.2.2.2.2.cmml">ϕ</mi><mi id="S3.E1.m1.6.6.6.4.2.2.2.2.3" xref="S3.E1.m1.6.6.6.4.2.2.2.2.3.cmml">j</mi></msub><mo id="S3.E1.m1.6.6.6.4.2.2.2.5" xref="S3.E1.m1.6.6.6.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac><mo id="S3.E1.m1.8.8.1.1.3.2.2.2.1.2" xref="S3.E1.m1.8.8.1.1.3.2.2.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.8.8.1.2" xref="S3.E1.m1.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.8b"><apply id="S3.E1.m1.8.8.1.1.cmml" xref="S3.E1.m1.8.8.1"><eq id="S3.E1.m1.8.8.1.1.1.cmml" xref="S3.E1.m1.8.8.1.1.1"></eq><apply id="S3.E1.m1.8.8.1.1.2.cmml" xref="S3.E1.m1.8.8.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.1.1.2.1.cmml" xref="S3.E1.m1.8.8.1.1.2">subscript</csymbol><ci id="S3.E1.m1.8.8.1.1.2.2.cmml" xref="S3.E1.m1.8.8.1.1.2.2">ℒ</ci><ci id="S3.E1.m1.8.8.1.1.2.3.cmml" xref="S3.E1.m1.8.8.1.1.2.3">𝐶</ci></apply><apply id="S3.E1.m1.8.8.1.1.3.cmml" xref="S3.E1.m1.8.8.1.1.3"><minus id="S3.E1.m1.8.8.1.1.3.1.cmml" xref="S3.E1.m1.8.8.1.1.3"></minus><apply id="S3.E1.m1.8.8.1.1.3.2.cmml" xref="S3.E1.m1.8.8.1.1.3.2"><apply id="S3.E1.m1.8.8.1.1.3.2.1.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.1.1.3.2.1.1.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1">subscript</csymbol><sum id="S3.E1.m1.8.8.1.1.3.2.1.2.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.2"></sum><apply id="S3.E1.m1.8.8.1.1.3.2.1.3.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.3"><in id="S3.E1.m1.8.8.1.1.3.2.1.3.1.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.3.1"></in><ci id="S3.E1.m1.8.8.1.1.3.2.1.3.2.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.3.2">𝑖</ci><ci id="S3.E1.m1.8.8.1.1.3.2.1.3.3.cmml" xref="S3.E1.m1.8.8.1.1.3.2.1.3.3">ℬ</ci></apply></apply><apply id="S3.E1.m1.8.8.1.1.3.2.2.1.cmml" xref="S3.E1.m1.8.8.1.1.3.2.2.2"><log id="S3.E1.m1.7.7.cmml" xref="S3.E1.m1.7.7"></log><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><divide id="S3.E1.m1.6.6.7.cmml" xref="S3.E1.m1.6.6"></divide><apply id="S3.E1.m1.2.2.2.cmml" xref="S3.E1.m1.2.2.2"><times id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.3"></times><ci id="S3.E1.m1.2.2.2.4.cmml" xref="S3.E1.m1.2.2.2.4">𝑑</ci><interval closure="open" id="S3.E1.m1.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2"><apply id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.2">italic-ϕ</ci><ci id="S3.E1.m1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2"><ci id="S3.E1.m1.2.2.2.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2.1">^</ci><ci id="S3.E1.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.2.2.2.2">italic-ϕ</ci></apply><ci id="S3.E1.m1.2.2.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.E1.m1.6.6.6.cmml" xref="S3.E1.m1.6.6.6"><plus id="S3.E1.m1.6.6.6.5.cmml" xref="S3.E1.m1.6.6.6.5"></plus><apply id="S3.E1.m1.4.4.4.2.cmml" xref="S3.E1.m1.4.4.4.2"><times id="S3.E1.m1.4.4.4.2.3.cmml" xref="S3.E1.m1.4.4.4.2.3"></times><ci id="S3.E1.m1.4.4.4.2.4.cmml" xref="S3.E1.m1.4.4.4.2.4">𝑑</ci><interval closure="open" id="S3.E1.m1.4.4.4.2.2.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2"><apply id="S3.E1.m1.3.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.2">italic-ϕ</ci><ci id="S3.E1.m1.3.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.4.2.2.2.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.4.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2.2">subscript</csymbol><apply id="S3.E1.m1.4.4.4.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.2.2"><ci id="S3.E1.m1.4.4.4.2.2.2.2.2.1.cmml" xref="S3.E1.m1.4.4.4.2.2.2.2.2.1">^</ci><ci id="S3.E1.m1.4.4.4.2.2.2.2.2.2.cmml" xref="S3.E1.m1.4.4.4.2.2.2.2.2.2">italic-ϕ</ci></apply><ci id="S3.E1.m1.4.4.4.2.2.2.2.3.cmml" xref="S3.E1.m1.4.4.4.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.E1.m1.6.6.6.4.cmml" xref="S3.E1.m1.6.6.6.4"><apply id="S3.E1.m1.6.6.6.4.3.cmml" xref="S3.E1.m1.6.6.6.4.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.3.1.cmml" xref="S3.E1.m1.6.6.6.4.3">subscript</csymbol><sum id="S3.E1.m1.6.6.6.4.3.2.cmml" xref="S3.E1.m1.6.6.6.4.3.2"></sum><apply id="S3.E1.m1.6.6.6.4.3.3.cmml" xref="S3.E1.m1.6.6.6.4.3.3"><and id="S3.E1.m1.6.6.6.4.3.3a.cmml" xref="S3.E1.m1.6.6.6.4.3.3"></and><apply id="S3.E1.m1.6.6.6.4.3.3b.cmml" xref="S3.E1.m1.6.6.6.4.3.3"><neq id="S3.E1.m1.6.6.6.4.3.3.3.cmml" xref="S3.E1.m1.6.6.6.4.3.3.3"></neq><ci id="S3.E1.m1.6.6.6.4.3.3.2.cmml" xref="S3.E1.m1.6.6.6.4.3.3.2">𝑗</ci><ci id="S3.E1.m1.6.6.6.4.3.3.4.cmml" xref="S3.E1.m1.6.6.6.4.3.3.4">𝑖</ci></apply><apply id="S3.E1.m1.6.6.6.4.3.3c.cmml" xref="S3.E1.m1.6.6.6.4.3.3"><in id="S3.E1.m1.6.6.6.4.3.3.5.cmml" xref="S3.E1.m1.6.6.6.4.3.3.5"></in><share href="#S3.E1.m1.6.6.6.4.3.3.4.cmml" id="S3.E1.m1.6.6.6.4.3.3d.cmml" xref="S3.E1.m1.6.6.6.4.3.3"></share><ci id="S3.E1.m1.6.6.6.4.3.3.6.cmml" xref="S3.E1.m1.6.6.6.4.3.3.6">ℬ</ci></apply></apply></apply><apply id="S3.E1.m1.6.6.6.4.2.cmml" xref="S3.E1.m1.6.6.6.4.2"><times id="S3.E1.m1.6.6.6.4.2.3.cmml" xref="S3.E1.m1.6.6.6.4.2.3"></times><ci id="S3.E1.m1.6.6.6.4.2.4.cmml" xref="S3.E1.m1.6.6.6.4.2.4">𝑑</ci><interval closure="open" id="S3.E1.m1.6.6.6.4.2.2.3.cmml" xref="S3.E1.m1.6.6.6.4.2.2.2"><apply id="S3.E1.m1.5.5.5.3.1.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.5.3.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.5.5.5.3.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.2">italic-ϕ</ci><ci id="S3.E1.m1.5.5.5.3.1.1.1.1.3.cmml" xref="S3.E1.m1.5.5.5.3.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E1.m1.6.6.6.4.2.2.2.2.cmml" xref="S3.E1.m1.6.6.6.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.6.4.2.2.2.2.1.cmml" xref="S3.E1.m1.6.6.6.4.2.2.2.2">subscript</csymbol><ci id="S3.E1.m1.6.6.6.4.2.2.2.2.2.cmml" xref="S3.E1.m1.6.6.6.4.2.2.2.2.2">italic-ϕ</ci><ci id="S3.E1.m1.6.6.6.4.2.2.2.2.3.cmml" xref="S3.E1.m1.6.6.6.4.2.2.2.2.3">𝑗</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.8c">\mathcal{L}_{C}=-\sum_{i\in\mathcal{B}}\log\left(\frac{d\left(\phi_{i},\hat{\phi}_{i}\right)}{d\left(\phi_{i},\hat{\phi}_{i}\right)+\sum_{j\neq i\in\mathcal{B}}d\left(\phi_{i},\phi_{j}\right)}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.5" class="ltx_p">where <math id="S3.SS1.p2.4.m1.6" class="ltx_Math" alttext="d(a,b):=\exp\left(\frac{1}{\lambda}\frac{{a}^{\intercal}{b}}{\|{a}\|_{2}\|{b}\|_{2}}\right)" display="inline"><semantics id="S3.SS1.p2.4.m1.6a"><mrow id="S3.SS1.p2.4.m1.6.6" xref="S3.SS1.p2.4.m1.6.6.cmml"><mrow id="S3.SS1.p2.4.m1.6.6.3" xref="S3.SS1.p2.4.m1.6.6.3.cmml"><mi id="S3.SS1.p2.4.m1.6.6.3.2" xref="S3.SS1.p2.4.m1.6.6.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m1.6.6.3.1" xref="S3.SS1.p2.4.m1.6.6.3.1.cmml">​</mo><mrow id="S3.SS1.p2.4.m1.6.6.3.3.2" xref="S3.SS1.p2.4.m1.6.6.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m1.6.6.3.3.2.1" xref="S3.SS1.p2.4.m1.6.6.3.3.1.cmml">(</mo><mi id="S3.SS1.p2.4.m1.3.3" xref="S3.SS1.p2.4.m1.3.3.cmml">a</mi><mo id="S3.SS1.p2.4.m1.6.6.3.3.2.2" xref="S3.SS1.p2.4.m1.6.6.3.3.1.cmml">,</mo><mi id="S3.SS1.p2.4.m1.4.4" xref="S3.SS1.p2.4.m1.4.4.cmml">b</mi><mo rspace="0.278em" stretchy="false" id="S3.SS1.p2.4.m1.6.6.3.3.2.3" xref="S3.SS1.p2.4.m1.6.6.3.3.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.SS1.p2.4.m1.6.6.2" xref="S3.SS1.p2.4.m1.6.6.2.cmml">:=</mo><mrow id="S3.SS1.p2.4.m1.6.6.1.1" xref="S3.SS1.p2.4.m1.6.6.1.2.cmml"><mi id="S3.SS1.p2.4.m1.5.5" xref="S3.SS1.p2.4.m1.5.5.cmml">exp</mi><mo id="S3.SS1.p2.4.m1.6.6.1.1a" xref="S3.SS1.p2.4.m1.6.6.1.2.cmml">⁡</mo><mrow id="S3.SS1.p2.4.m1.6.6.1.1.1" xref="S3.SS1.p2.4.m1.6.6.1.2.cmml"><mo id="S3.SS1.p2.4.m1.6.6.1.1.1.2" xref="S3.SS1.p2.4.m1.6.6.1.2.cmml">(</mo><mrow id="S3.SS1.p2.4.m1.6.6.1.1.1.1" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1.cmml"><mfrac id="S3.SS1.p2.4.m1.6.6.1.1.1.1.2" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.cmml"><mn id="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.2" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.2.cmml">1</mn><mi id="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.3" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.3.cmml">λ</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m1.6.6.1.1.1.1.1" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1.1.cmml">​</mo><mfrac id="S3.SS1.p2.4.m1.2.2" xref="S3.SS1.p2.4.m1.2.2.cmml"><mrow id="S3.SS1.p2.4.m1.2.2.4" xref="S3.SS1.p2.4.m1.2.2.4.cmml"><msup id="S3.SS1.p2.4.m1.2.2.4.2" xref="S3.SS1.p2.4.m1.2.2.4.2.cmml"><mi id="S3.SS1.p2.4.m1.2.2.4.2.2" xref="S3.SS1.p2.4.m1.2.2.4.2.2.cmml">a</mi><mo id="S3.SS1.p2.4.m1.2.2.4.2.3" xref="S3.SS1.p2.4.m1.2.2.4.2.3.cmml">⊺</mo></msup><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m1.2.2.4.1" xref="S3.SS1.p2.4.m1.2.2.4.1.cmml">​</mo><mi id="S3.SS1.p2.4.m1.2.2.4.3" xref="S3.SS1.p2.4.m1.2.2.4.3.cmml">b</mi></mrow><mrow id="S3.SS1.p2.4.m1.2.2.2" xref="S3.SS1.p2.4.m1.2.2.2.cmml"><msub id="S3.SS1.p2.4.m1.2.2.2.4" xref="S3.SS1.p2.4.m1.2.2.2.4.cmml"><mrow id="S3.SS1.p2.4.m1.2.2.2.4.2.2" xref="S3.SS1.p2.4.m1.2.2.2.4.2.1.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m1.2.2.2.4.2.2.1" xref="S3.SS1.p2.4.m1.2.2.2.4.2.1.1.cmml">‖</mo><mi id="S3.SS1.p2.4.m1.1.1.1.1" xref="S3.SS1.p2.4.m1.1.1.1.1.cmml">a</mi><mo stretchy="false" id="S3.SS1.p2.4.m1.2.2.2.4.2.2.2" xref="S3.SS1.p2.4.m1.2.2.2.4.2.1.1.cmml">‖</mo></mrow><mn id="S3.SS1.p2.4.m1.2.2.2.4.3" xref="S3.SS1.p2.4.m1.2.2.2.4.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m1.2.2.2.3" xref="S3.SS1.p2.4.m1.2.2.2.3.cmml">​</mo><msub id="S3.SS1.p2.4.m1.2.2.2.5" xref="S3.SS1.p2.4.m1.2.2.2.5.cmml"><mrow id="S3.SS1.p2.4.m1.2.2.2.5.2.2" xref="S3.SS1.p2.4.m1.2.2.2.5.2.1.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m1.2.2.2.5.2.2.1" xref="S3.SS1.p2.4.m1.2.2.2.5.2.1.1.cmml">‖</mo><mi id="S3.SS1.p2.4.m1.2.2.2.2" xref="S3.SS1.p2.4.m1.2.2.2.2.cmml">b</mi><mo stretchy="false" id="S3.SS1.p2.4.m1.2.2.2.5.2.2.2" xref="S3.SS1.p2.4.m1.2.2.2.5.2.1.1.cmml">‖</mo></mrow><mn id="S3.SS1.p2.4.m1.2.2.2.5.3" xref="S3.SS1.p2.4.m1.2.2.2.5.3.cmml">2</mn></msub></mrow></mfrac></mrow><mo id="S3.SS1.p2.4.m1.6.6.1.1.1.3" xref="S3.SS1.p2.4.m1.6.6.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m1.6b"><apply id="S3.SS1.p2.4.m1.6.6.cmml" xref="S3.SS1.p2.4.m1.6.6"><csymbol cd="latexml" id="S3.SS1.p2.4.m1.6.6.2.cmml" xref="S3.SS1.p2.4.m1.6.6.2">assign</csymbol><apply id="S3.SS1.p2.4.m1.6.6.3.cmml" xref="S3.SS1.p2.4.m1.6.6.3"><times id="S3.SS1.p2.4.m1.6.6.3.1.cmml" xref="S3.SS1.p2.4.m1.6.6.3.1"></times><ci id="S3.SS1.p2.4.m1.6.6.3.2.cmml" xref="S3.SS1.p2.4.m1.6.6.3.2">𝑑</ci><interval closure="open" id="S3.SS1.p2.4.m1.6.6.3.3.1.cmml" xref="S3.SS1.p2.4.m1.6.6.3.3.2"><ci id="S3.SS1.p2.4.m1.3.3.cmml" xref="S3.SS1.p2.4.m1.3.3">𝑎</ci><ci id="S3.SS1.p2.4.m1.4.4.cmml" xref="S3.SS1.p2.4.m1.4.4">𝑏</ci></interval></apply><apply id="S3.SS1.p2.4.m1.6.6.1.2.cmml" xref="S3.SS1.p2.4.m1.6.6.1.1"><exp id="S3.SS1.p2.4.m1.5.5.cmml" xref="S3.SS1.p2.4.m1.5.5"></exp><apply id="S3.SS1.p2.4.m1.6.6.1.1.1.1.cmml" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1"><times id="S3.SS1.p2.4.m1.6.6.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1.1"></times><apply id="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1.2"><divide id="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1.2"></divide><cn type="integer" id="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.2">1</cn><ci id="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.4.m1.6.6.1.1.1.1.2.3">𝜆</ci></apply><apply id="S3.SS1.p2.4.m1.2.2.cmml" xref="S3.SS1.p2.4.m1.2.2"><divide id="S3.SS1.p2.4.m1.2.2.3.cmml" xref="S3.SS1.p2.4.m1.2.2"></divide><apply id="S3.SS1.p2.4.m1.2.2.4.cmml" xref="S3.SS1.p2.4.m1.2.2.4"><times id="S3.SS1.p2.4.m1.2.2.4.1.cmml" xref="S3.SS1.p2.4.m1.2.2.4.1"></times><apply id="S3.SS1.p2.4.m1.2.2.4.2.cmml" xref="S3.SS1.p2.4.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m1.2.2.4.2.1.cmml" xref="S3.SS1.p2.4.m1.2.2.4.2">superscript</csymbol><ci id="S3.SS1.p2.4.m1.2.2.4.2.2.cmml" xref="S3.SS1.p2.4.m1.2.2.4.2.2">𝑎</ci><ci id="S3.SS1.p2.4.m1.2.2.4.2.3.cmml" xref="S3.SS1.p2.4.m1.2.2.4.2.3">⊺</ci></apply><ci id="S3.SS1.p2.4.m1.2.2.4.3.cmml" xref="S3.SS1.p2.4.m1.2.2.4.3">𝑏</ci></apply><apply id="S3.SS1.p2.4.m1.2.2.2.cmml" xref="S3.SS1.p2.4.m1.2.2.2"><times id="S3.SS1.p2.4.m1.2.2.2.3.cmml" xref="S3.SS1.p2.4.m1.2.2.2.3"></times><apply id="S3.SS1.p2.4.m1.2.2.2.4.cmml" xref="S3.SS1.p2.4.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m1.2.2.2.4.1.cmml" xref="S3.SS1.p2.4.m1.2.2.2.4">subscript</csymbol><apply id="S3.SS1.p2.4.m1.2.2.2.4.2.1.cmml" xref="S3.SS1.p2.4.m1.2.2.2.4.2.2"><csymbol cd="latexml" id="S3.SS1.p2.4.m1.2.2.2.4.2.1.1.cmml" xref="S3.SS1.p2.4.m1.2.2.2.4.2.2.1">norm</csymbol><ci id="S3.SS1.p2.4.m1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m1.1.1.1.1">𝑎</ci></apply><cn type="integer" id="S3.SS1.p2.4.m1.2.2.2.4.3.cmml" xref="S3.SS1.p2.4.m1.2.2.2.4.3">2</cn></apply><apply id="S3.SS1.p2.4.m1.2.2.2.5.cmml" xref="S3.SS1.p2.4.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m1.2.2.2.5.1.cmml" xref="S3.SS1.p2.4.m1.2.2.2.5">subscript</csymbol><apply id="S3.SS1.p2.4.m1.2.2.2.5.2.1.cmml" xref="S3.SS1.p2.4.m1.2.2.2.5.2.2"><csymbol cd="latexml" id="S3.SS1.p2.4.m1.2.2.2.5.2.1.1.cmml" xref="S3.SS1.p2.4.m1.2.2.2.5.2.2.1">norm</csymbol><ci id="S3.SS1.p2.4.m1.2.2.2.2.cmml" xref="S3.SS1.p2.4.m1.2.2.2.2">𝑏</ci></apply><cn type="integer" id="S3.SS1.p2.4.m1.2.2.2.5.3.cmml" xref="S3.SS1.p2.4.m1.2.2.2.5.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m1.6c">d(a,b):=\exp\left(\frac{1}{\lambda}\frac{{a}^{\intercal}{b}}{\|{a}\|_{2}\|{b}\|_{2}}\right)</annotation></semantics></math> measures the similarity between embeddings, and <math id="S3.SS1.p2.5.m2.1" class="ltx_Math" alttext="\mathcal{B}" display="inline"><semantics id="S3.SS1.p2.5.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m2.1.1" xref="S3.SS1.p2.5.m2.1.1.cmml">ℬ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m2.1b"><ci id="S3.SS1.p2.5.m2.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1">ℬ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m2.1c">\mathcal{B}</annotation></semantics></math> represents a randomly sampled mini-batch during training <cite class="ltx_cite ltx_citemacro_citep">(Balan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2023a</a>)</cite>.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p"><span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_bold">Image match verification.</span> A shortlist of the top-K candidate image pair matches is obtained using the previously extracted image fingerprints. The generated query image and each candidate match retrieved from the training dataset are verified through an additional pairwise comparison. The spatial feature maps derived from the fingerprinter model are used to compare the image pairs as presented in <cite class="ltx_cite ltx_citemacro_citep">(Balan et al<span class="ltx_text">.</span>, <a href="#bib.bib3" title="" class="ltx_ref">2023a</a>)</cite>. During training for the match verification model, the backbone feature extractor model is frozen.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.10" class="ltx_p">Let <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="F_{q}\in\mathbb{R}^{H\times W\times D}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mrow id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><msub id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2.2" xref="S3.SS1.p4.1.m1.1.1.2.2.cmml">F</mi><mi id="S3.SS1.p4.1.m1.1.1.2.3" xref="S3.SS1.p4.1.m1.1.1.2.3.cmml">q</mi></msub><mo id="S3.SS1.p4.1.m1.1.1.1" xref="S3.SS1.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.3.2" xref="S3.SS1.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.1.m1.1.1.3.3" xref="S3.SS1.p4.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.3.3.2" xref="S3.SS1.p4.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p4.1.m1.1.1.3.3.1" xref="S3.SS1.p4.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p4.1.m1.1.1.3.3.3" xref="S3.SS1.p4.1.m1.1.1.3.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p4.1.m1.1.1.3.3.1a" xref="S3.SS1.p4.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p4.1.m1.1.1.3.3.4" xref="S3.SS1.p4.1.m1.1.1.3.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><in id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1.1"></in><apply id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.2.1.cmml" xref="S3.SS1.p4.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2.2">𝐹</ci><ci id="S3.SS1.p4.1.m1.1.1.2.3.cmml" xref="S3.SS1.p4.1.m1.1.1.2.3">𝑞</ci></apply><apply id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.1.m1.1.1.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3"><times id="S3.SS1.p4.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p4.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p4.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3.3">𝑊</ci><ci id="S3.SS1.p4.1.m1.1.1.3.3.4.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">F_{q}\in\mathbb{R}^{H\times W\times D}</annotation></semantics></math> be the feature map for a query image <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="x_{q}" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><msub id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml"><mi id="S3.SS1.p4.2.m2.1.1.2" xref="S3.SS1.p4.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS1.p4.2.m2.1.1.3" xref="S3.SS1.p4.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><apply id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.2.m2.1.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p4.2.m2.1.1.2.cmml" xref="S3.SS1.p4.2.m2.1.1.2">𝑥</ci><ci id="S3.SS1.p4.2.m2.1.1.3.cmml" xref="S3.SS1.p4.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">x_{q}</annotation></semantics></math> and let <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="\{F_{i}\}_{i=1}^{k}" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><msubsup id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml"><mrow id="S3.SS1.p4.3.m3.1.1.1.1.1" xref="S3.SS1.p4.3.m3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p4.3.m3.1.1.1.1.1.2" xref="S3.SS1.p4.3.m3.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p4.3.m3.1.1.1.1.1.1" xref="S3.SS1.p4.3.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p4.3.m3.1.1.1.1.1.1.2" xref="S3.SS1.p4.3.m3.1.1.1.1.1.1.2.cmml">F</mi><mi id="S3.SS1.p4.3.m3.1.1.1.1.1.1.3" xref="S3.SS1.p4.3.m3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p4.3.m3.1.1.1.1.1.3" xref="S3.SS1.p4.3.m3.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p4.3.m3.1.1.1.3" xref="S3.SS1.p4.3.m3.1.1.1.3.cmml"><mi id="S3.SS1.p4.3.m3.1.1.1.3.2" xref="S3.SS1.p4.3.m3.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.p4.3.m3.1.1.1.3.1" xref="S3.SS1.p4.3.m3.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p4.3.m3.1.1.1.3.3" xref="S3.SS1.p4.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p4.3.m3.1.1.3" xref="S3.SS1.p4.3.m3.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><apply id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.1.1.2.cmml" xref="S3.SS1.p4.3.m3.1.1">superscript</csymbol><apply id="S3.SS1.p4.3.m3.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.1.1.1.2.cmml" xref="S3.SS1.p4.3.m3.1.1">subscript</csymbol><set id="S3.SS1.p4.3.m3.1.1.1.1.2.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1.1"><apply id="S3.SS1.p4.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p4.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1.1.1.2">𝐹</ci><ci id="S3.SS1.p4.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p4.3.m3.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.p4.3.m3.1.1.1.3.cmml" xref="S3.SS1.p4.3.m3.1.1.1.3"><eq id="S3.SS1.p4.3.m3.1.1.1.3.1.cmml" xref="S3.SS1.p4.3.m3.1.1.1.3.1"></eq><ci id="S3.SS1.p4.3.m3.1.1.1.3.2.cmml" xref="S3.SS1.p4.3.m3.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p4.3.m3.1.1.1.3.3.cmml" xref="S3.SS1.p4.3.m3.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p4.3.m3.1.1.3.cmml" xref="S3.SS1.p4.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">\{F_{i}\}_{i=1}^{k}</annotation></semantics></math> be the <math id="S3.SS1.p4.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS1.p4.4.m4.1a"><mi id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.1b"><ci id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.1c">k</annotation></semantics></math> corresponding retrieval feature maps.
Each feature map is processed with a <math id="S3.SS1.p4.5.m5.1" class="ltx_Math" alttext="1\times 1" display="inline"><semantics id="S3.SS1.p4.5.m5.1a"><mrow id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml"><mn id="S3.SS1.p4.5.m5.1.1.2" xref="S3.SS1.p4.5.m5.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p4.5.m5.1.1.1" xref="S3.SS1.p4.5.m5.1.1.1.cmml">×</mo><mn id="S3.SS1.p4.5.m5.1.1.3" xref="S3.SS1.p4.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><apply id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1"><times id="S3.SS1.p4.5.m5.1.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1.1"></times><cn type="integer" id="S3.SS1.p4.5.m5.1.1.2.cmml" xref="S3.SS1.p4.5.m5.1.1.2">1</cn><cn type="integer" id="S3.SS1.p4.5.m5.1.1.3.cmml" xref="S3.SS1.p4.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">1\times 1</annotation></semantics></math> convolution to reduce the dimensionality to <math id="S3.SS1.p4.6.m6.1" class="ltx_Math" alttext="\frac{D}{4}" display="inline"><semantics id="S3.SS1.p4.6.m6.1a"><mfrac id="S3.SS1.p4.6.m6.1.1" xref="S3.SS1.p4.6.m6.1.1.cmml"><mi id="S3.SS1.p4.6.m6.1.1.2" xref="S3.SS1.p4.6.m6.1.1.2.cmml">D</mi><mn id="S3.SS1.p4.6.m6.1.1.3" xref="S3.SS1.p4.6.m6.1.1.3.cmml">4</mn></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m6.1b"><apply id="S3.SS1.p4.6.m6.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1"><divide id="S3.SS1.p4.6.m6.1.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1"></divide><ci id="S3.SS1.p4.6.m6.1.1.2.cmml" xref="S3.SS1.p4.6.m6.1.1.2">𝐷</ci><cn type="integer" id="S3.SS1.p4.6.m6.1.1.3.cmml" xref="S3.SS1.p4.6.m6.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m6.1c">\frac{D}{4}</annotation></semantics></math> and then numerous pooled descriptors from a set of 2D feature map windows <math id="S3.SS1.p4.7.m7.4" class="ltx_Math" alttext="\mathcal{W}\subset[1,H]\times[1,W]" display="inline"><semantics id="S3.SS1.p4.7.m7.4a"><mrow id="S3.SS1.p4.7.m7.4.5" xref="S3.SS1.p4.7.m7.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.7.m7.4.5.2" xref="S3.SS1.p4.7.m7.4.5.2.cmml">𝒲</mi><mo id="S3.SS1.p4.7.m7.4.5.1" xref="S3.SS1.p4.7.m7.4.5.1.cmml">⊂</mo><mrow id="S3.SS1.p4.7.m7.4.5.3" xref="S3.SS1.p4.7.m7.4.5.3.cmml"><mrow id="S3.SS1.p4.7.m7.4.5.3.2.2" xref="S3.SS1.p4.7.m7.4.5.3.2.1.cmml"><mo stretchy="false" id="S3.SS1.p4.7.m7.4.5.3.2.2.1" xref="S3.SS1.p4.7.m7.4.5.3.2.1.cmml">[</mo><mn id="S3.SS1.p4.7.m7.1.1" xref="S3.SS1.p4.7.m7.1.1.cmml">1</mn><mo id="S3.SS1.p4.7.m7.4.5.3.2.2.2" xref="S3.SS1.p4.7.m7.4.5.3.2.1.cmml">,</mo><mi id="S3.SS1.p4.7.m7.2.2" xref="S3.SS1.p4.7.m7.2.2.cmml">H</mi><mo rspace="0.055em" stretchy="false" id="S3.SS1.p4.7.m7.4.5.3.2.2.3" xref="S3.SS1.p4.7.m7.4.5.3.2.1.cmml">]</mo></mrow><mo rspace="0.222em" id="S3.SS1.p4.7.m7.4.5.3.1" xref="S3.SS1.p4.7.m7.4.5.3.1.cmml">×</mo><mrow id="S3.SS1.p4.7.m7.4.5.3.3.2" xref="S3.SS1.p4.7.m7.4.5.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p4.7.m7.4.5.3.3.2.1" xref="S3.SS1.p4.7.m7.4.5.3.3.1.cmml">[</mo><mn id="S3.SS1.p4.7.m7.3.3" xref="S3.SS1.p4.7.m7.3.3.cmml">1</mn><mo id="S3.SS1.p4.7.m7.4.5.3.3.2.2" xref="S3.SS1.p4.7.m7.4.5.3.3.1.cmml">,</mo><mi id="S3.SS1.p4.7.m7.4.4" xref="S3.SS1.p4.7.m7.4.4.cmml">W</mi><mo stretchy="false" id="S3.SS1.p4.7.m7.4.5.3.3.2.3" xref="S3.SS1.p4.7.m7.4.5.3.3.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m7.4b"><apply id="S3.SS1.p4.7.m7.4.5.cmml" xref="S3.SS1.p4.7.m7.4.5"><subset id="S3.SS1.p4.7.m7.4.5.1.cmml" xref="S3.SS1.p4.7.m7.4.5.1"></subset><ci id="S3.SS1.p4.7.m7.4.5.2.cmml" xref="S3.SS1.p4.7.m7.4.5.2">𝒲</ci><apply id="S3.SS1.p4.7.m7.4.5.3.cmml" xref="S3.SS1.p4.7.m7.4.5.3"><times id="S3.SS1.p4.7.m7.4.5.3.1.cmml" xref="S3.SS1.p4.7.m7.4.5.3.1"></times><interval closure="closed" id="S3.SS1.p4.7.m7.4.5.3.2.1.cmml" xref="S3.SS1.p4.7.m7.4.5.3.2.2"><cn type="integer" id="S3.SS1.p4.7.m7.1.1.cmml" xref="S3.SS1.p4.7.m7.1.1">1</cn><ci id="S3.SS1.p4.7.m7.2.2.cmml" xref="S3.SS1.p4.7.m7.2.2">𝐻</ci></interval><interval closure="closed" id="S3.SS1.p4.7.m7.4.5.3.3.1.cmml" xref="S3.SS1.p4.7.m7.4.5.3.3.2"><cn type="integer" id="S3.SS1.p4.7.m7.3.3.cmml" xref="S3.SS1.p4.7.m7.3.3">1</cn><ci id="S3.SS1.p4.7.m7.4.4.cmml" xref="S3.SS1.p4.7.m7.4.4">𝑊</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m7.4c">\mathcal{W}\subset[1,H]\times[1,W]</annotation></semantics></math> are extracted, similar to R-MAC <cite class="ltx_cite ltx_citemacro_citep">(Tolias et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2016</a>)</cite>.
Let <math id="S3.SS1.p4.8.m8.1" class="ltx_Math" alttext="f^{q}_{w}\in\mathbb{R}^{\frac{D}{4}}" display="inline"><semantics id="S3.SS1.p4.8.m8.1a"><mrow id="S3.SS1.p4.8.m8.1.1" xref="S3.SS1.p4.8.m8.1.1.cmml"><msubsup id="S3.SS1.p4.8.m8.1.1.2" xref="S3.SS1.p4.8.m8.1.1.2.cmml"><mi id="S3.SS1.p4.8.m8.1.1.2.2.2" xref="S3.SS1.p4.8.m8.1.1.2.2.2.cmml">f</mi><mi id="S3.SS1.p4.8.m8.1.1.2.3" xref="S3.SS1.p4.8.m8.1.1.2.3.cmml">w</mi><mi id="S3.SS1.p4.8.m8.1.1.2.2.3" xref="S3.SS1.p4.8.m8.1.1.2.2.3.cmml">q</mi></msubsup><mo id="S3.SS1.p4.8.m8.1.1.1" xref="S3.SS1.p4.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.8.m8.1.1.3" xref="S3.SS1.p4.8.m8.1.1.3.cmml"><mi id="S3.SS1.p4.8.m8.1.1.3.2" xref="S3.SS1.p4.8.m8.1.1.3.2.cmml">ℝ</mi><mfrac id="S3.SS1.p4.8.m8.1.1.3.3" xref="S3.SS1.p4.8.m8.1.1.3.3.cmml"><mi id="S3.SS1.p4.8.m8.1.1.3.3.2" xref="S3.SS1.p4.8.m8.1.1.3.3.2.cmml">D</mi><mn id="S3.SS1.p4.8.m8.1.1.3.3.3" xref="S3.SS1.p4.8.m8.1.1.3.3.3.cmml">4</mn></mfrac></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m8.1b"><apply id="S3.SS1.p4.8.m8.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1"><in id="S3.SS1.p4.8.m8.1.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1.1"></in><apply id="S3.SS1.p4.8.m8.1.1.2.cmml" xref="S3.SS1.p4.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m8.1.1.2.1.cmml" xref="S3.SS1.p4.8.m8.1.1.2">subscript</csymbol><apply id="S3.SS1.p4.8.m8.1.1.2.2.cmml" xref="S3.SS1.p4.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m8.1.1.2.2.1.cmml" xref="S3.SS1.p4.8.m8.1.1.2">superscript</csymbol><ci id="S3.SS1.p4.8.m8.1.1.2.2.2.cmml" xref="S3.SS1.p4.8.m8.1.1.2.2.2">𝑓</ci><ci id="S3.SS1.p4.8.m8.1.1.2.2.3.cmml" xref="S3.SS1.p4.8.m8.1.1.2.2.3">𝑞</ci></apply><ci id="S3.SS1.p4.8.m8.1.1.2.3.cmml" xref="S3.SS1.p4.8.m8.1.1.2.3">𝑤</ci></apply><apply id="S3.SS1.p4.8.m8.1.1.3.cmml" xref="S3.SS1.p4.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m8.1.1.3.1.cmml" xref="S3.SS1.p4.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.8.m8.1.1.3.2.cmml" xref="S3.SS1.p4.8.m8.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.8.m8.1.1.3.3.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3"><divide id="S3.SS1.p4.8.m8.1.1.3.3.1.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3"></divide><ci id="S3.SS1.p4.8.m8.1.1.3.3.2.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3.2">𝐷</ci><cn type="integer" id="S3.SS1.p4.8.m8.1.1.3.3.3.cmml" xref="S3.SS1.p4.8.m8.1.1.3.3.3">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m8.1c">f^{q}_{w}\in\mathbb{R}^{\frac{D}{4}}</annotation></semantics></math> denote the GeM-pooled <cite class="ltx_cite ltx_citemacro_citep">(Tolias et al<span class="ltx_text">.</span>, <a href="#bib.bib23" title="" class="ltx_ref">2016</a>)</cite> and unit-normalized feature vector for a window <math id="S3.SS1.p4.9.m9.1" class="ltx_Math" alttext="w\in\mathcal{W}" display="inline"><semantics id="S3.SS1.p4.9.m9.1a"><mrow id="S3.SS1.p4.9.m9.1.1" xref="S3.SS1.p4.9.m9.1.1.cmml"><mi id="S3.SS1.p4.9.m9.1.1.2" xref="S3.SS1.p4.9.m9.1.1.2.cmml">w</mi><mo id="S3.SS1.p4.9.m9.1.1.1" xref="S3.SS1.p4.9.m9.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.9.m9.1.1.3" xref="S3.SS1.p4.9.m9.1.1.3.cmml">𝒲</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.9.m9.1b"><apply id="S3.SS1.p4.9.m9.1.1.cmml" xref="S3.SS1.p4.9.m9.1.1"><in id="S3.SS1.p4.9.m9.1.1.1.cmml" xref="S3.SS1.p4.9.m9.1.1.1"></in><ci id="S3.SS1.p4.9.m9.1.1.2.cmml" xref="S3.SS1.p4.9.m9.1.1.2">𝑤</ci><ci id="S3.SS1.p4.9.m9.1.1.3.cmml" xref="S3.SS1.p4.9.m9.1.1.3">𝒲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.9.m9.1c">w\in\mathcal{W}</annotation></semantics></math> and feature map <math id="S3.SS1.p4.10.m10.1" class="ltx_Math" alttext="F_{q}" display="inline"><semantics id="S3.SS1.p4.10.m10.1a"><msub id="S3.SS1.p4.10.m10.1.1" xref="S3.SS1.p4.10.m10.1.1.cmml"><mi id="S3.SS1.p4.10.m10.1.1.2" xref="S3.SS1.p4.10.m10.1.1.2.cmml">F</mi><mi id="S3.SS1.p4.10.m10.1.1.3" xref="S3.SS1.p4.10.m10.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.10.m10.1b"><apply id="S3.SS1.p4.10.m10.1.1.cmml" xref="S3.SS1.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.10.m10.1.1.1.cmml" xref="S3.SS1.p4.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p4.10.m10.1.1.2.cmml" xref="S3.SS1.p4.10.m10.1.1.2">𝐹</ci><ci id="S3.SS1.p4.10.m10.1.1.3.cmml" xref="S3.SS1.p4.10.m10.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.10.m10.1c">F_{q}</annotation></semantics></math>. The window-pooled feature vectors are collected as follows:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\hat{F}_{q}=[f^{q}_{w_{1}},\ldots,f^{q}_{w_{|\mathcal{W}|}}]\in\mathbb{R}^{|\mathcal{W}|\times\frac{D}{4}}," display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.1" xref="S3.E2.m1.4.4.1.1.cmml"><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml"><msub id="S3.E2.m1.4.4.1.1.4" xref="S3.E2.m1.4.4.1.1.4.cmml"><mover accent="true" id="S3.E2.m1.4.4.1.1.4.2" xref="S3.E2.m1.4.4.1.1.4.2.cmml"><mi id="S3.E2.m1.4.4.1.1.4.2.2" xref="S3.E2.m1.4.4.1.1.4.2.2.cmml">F</mi><mo id="S3.E2.m1.4.4.1.1.4.2.1" xref="S3.E2.m1.4.4.1.1.4.2.1.cmml">^</mo></mover><mi id="S3.E2.m1.4.4.1.1.4.3" xref="S3.E2.m1.4.4.1.1.4.3.cmml">q</mi></msub><mo id="S3.E2.m1.4.4.1.1.5" xref="S3.E2.m1.4.4.1.1.5.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.2.2" xref="S3.E2.m1.4.4.1.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.2.2.3" xref="S3.E2.m1.4.4.1.1.2.3.cmml">[</mo><msubsup id="S3.E2.m1.4.4.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.2.2" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.cmml">f</mi><msub id="S3.E2.m1.4.4.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.3.2" xref="S3.E2.m1.4.4.1.1.1.1.1.3.2.cmml">w</mi><mn id="S3.E2.m1.4.4.1.1.1.1.1.3.3" xref="S3.E2.m1.4.4.1.1.1.1.1.3.3.cmml">1</mn></msub><mi id="S3.E2.m1.4.4.1.1.1.1.1.2.3" xref="S3.E2.m1.4.4.1.1.1.1.1.2.3.cmml">q</mi></msubsup><mo id="S3.E2.m1.4.4.1.1.2.2.4" xref="S3.E2.m1.4.4.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">…</mi><mo id="S3.E2.m1.4.4.1.1.2.2.5" xref="S3.E2.m1.4.4.1.1.2.3.cmml">,</mo><msubsup id="S3.E2.m1.4.4.1.1.2.2.2" xref="S3.E2.m1.4.4.1.1.2.2.2.cmml"><mi id="S3.E2.m1.4.4.1.1.2.2.2.2.2" xref="S3.E2.m1.4.4.1.1.2.2.2.2.2.cmml">f</mi><msub id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml">w</mi><mrow id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">𝒲</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow></msub><mi id="S3.E2.m1.4.4.1.1.2.2.2.2.3" xref="S3.E2.m1.4.4.1.1.2.2.2.2.3.cmml">q</mi></msubsup><mo stretchy="false" id="S3.E2.m1.4.4.1.1.2.2.6" xref="S3.E2.m1.4.4.1.1.2.3.cmml">]</mo></mrow><mo id="S3.E2.m1.4.4.1.1.6" xref="S3.E2.m1.4.4.1.1.6.cmml">∈</mo><msup id="S3.E2.m1.4.4.1.1.7" xref="S3.E2.m1.4.4.1.1.7.cmml"><mi id="S3.E2.m1.4.4.1.1.7.2" xref="S3.E2.m1.4.4.1.1.7.2.cmml">ℝ</mi><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.cmml"><mrow id="S3.E2.m1.2.2.1.3.2" xref="S3.E2.m1.2.2.1.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.3.2.1" xref="S3.E2.m1.2.2.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml">𝒲</mi><mo rspace="0.055em" stretchy="false" id="S3.E2.m1.2.2.1.3.2.2" xref="S3.E2.m1.2.2.1.3.1.1.cmml">|</mo></mrow><mo rspace="0.222em" id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.2.cmml">×</mo><mfrac id="S3.E2.m1.2.2.1.4" xref="S3.E2.m1.2.2.1.4.cmml"><mi id="S3.E2.m1.2.2.1.4.2" xref="S3.E2.m1.2.2.1.4.2.cmml">D</mi><mn id="S3.E2.m1.2.2.1.4.3" xref="S3.E2.m1.2.2.1.4.3.cmml">4</mn></mfrac></mrow></msup></mrow><mo id="S3.E2.m1.4.4.1.2" xref="S3.E2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1"><and id="S3.E2.m1.4.4.1.1a.cmml" xref="S3.E2.m1.4.4.1"></and><apply id="S3.E2.m1.4.4.1.1b.cmml" xref="S3.E2.m1.4.4.1"><eq id="S3.E2.m1.4.4.1.1.5.cmml" xref="S3.E2.m1.4.4.1.1.5"></eq><apply id="S3.E2.m1.4.4.1.1.4.cmml" xref="S3.E2.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.4.1.cmml" xref="S3.E2.m1.4.4.1.1.4">subscript</csymbol><apply id="S3.E2.m1.4.4.1.1.4.2.cmml" xref="S3.E2.m1.4.4.1.1.4.2"><ci id="S3.E2.m1.4.4.1.1.4.2.1.cmml" xref="S3.E2.m1.4.4.1.1.4.2.1">^</ci><ci id="S3.E2.m1.4.4.1.1.4.2.2.cmml" xref="S3.E2.m1.4.4.1.1.4.2.2">𝐹</ci></apply><ci id="S3.E2.m1.4.4.1.1.4.3.cmml" xref="S3.E2.m1.4.4.1.1.4.3">𝑞</ci></apply><list id="S3.E2.m1.4.4.1.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.2.2"><apply id="S3.E2.m1.4.4.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2">𝑓</ci><ci id="S3.E2.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.3">𝑞</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.3.2">𝑤</ci><cn type="integer" id="S3.E2.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">…</ci><apply id="S3.E2.m1.4.4.1.1.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.2.2.2.1.cmml" xref="S3.E2.m1.4.4.1.1.2.2.2">subscript</csymbol><apply id="S3.E2.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.1.1.2.2.2">superscript</csymbol><ci id="S3.E2.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.2.2.2.2.2">𝑓</ci><ci id="S3.E2.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.4.4.1.1.2.2.2.2.3">𝑞</ci></apply><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3">𝑤</ci><apply id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.3"><abs id="S3.E2.m1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3.1"></abs><ci id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">𝒲</ci></apply></apply></apply></list></apply><apply id="S3.E2.m1.4.4.1.1c.cmml" xref="S3.E2.m1.4.4.1"><in id="S3.E2.m1.4.4.1.1.6.cmml" xref="S3.E2.m1.4.4.1.1.6"></in><share href="#S3.E2.m1.4.4.1.1.2.cmml" id="S3.E2.m1.4.4.1.1d.cmml" xref="S3.E2.m1.4.4.1"></share><apply id="S3.E2.m1.4.4.1.1.7.cmml" xref="S3.E2.m1.4.4.1.1.7"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.7.1.cmml" xref="S3.E2.m1.4.4.1.1.7">superscript</csymbol><ci id="S3.E2.m1.4.4.1.1.7.2.cmml" xref="S3.E2.m1.4.4.1.1.7.2">ℝ</ci><apply id="S3.E2.m1.2.2.1.cmml" xref="S3.E2.m1.2.2.1"><times id="S3.E2.m1.2.2.1.2.cmml" xref="S3.E2.m1.2.2.1.2"></times><apply id="S3.E2.m1.2.2.1.3.1.cmml" xref="S3.E2.m1.2.2.1.3.2"><abs id="S3.E2.m1.2.2.1.3.1.1.cmml" xref="S3.E2.m1.2.2.1.3.2.1"></abs><ci id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1.1">𝒲</ci></apply><apply id="S3.E2.m1.2.2.1.4.cmml" xref="S3.E2.m1.2.2.1.4"><divide id="S3.E2.m1.2.2.1.4.1.cmml" xref="S3.E2.m1.2.2.1.4"></divide><ci id="S3.E2.m1.2.2.1.4.2.cmml" xref="S3.E2.m1.2.2.1.4.2">𝐷</ci><cn type="integer" id="S3.E2.m1.2.2.1.4.3.cmml" xref="S3.E2.m1.2.2.1.4.3">4</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\hat{F}_{q}=[f^{q}_{w_{1}},\ldots,f^{q}_{w_{|\mathcal{W}|}}]\in\mathbb{R}^{|\mathcal{W}|\times\frac{D}{4}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p4.12" class="ltx_p">with <math id="S3.SS1.p4.11.m1.1" class="ltx_Math" alttext="|\mathcal{W}|=55" display="inline"><semantics id="S3.SS1.p4.11.m1.1a"><mrow id="S3.SS1.p4.11.m1.1.2" xref="S3.SS1.p4.11.m1.1.2.cmml"><mrow id="S3.SS1.p4.11.m1.1.2.2.2" xref="S3.SS1.p4.11.m1.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS1.p4.11.m1.1.2.2.2.1" xref="S3.SS1.p4.11.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.11.m1.1.1" xref="S3.SS1.p4.11.m1.1.1.cmml">𝒲</mi><mo stretchy="false" id="S3.SS1.p4.11.m1.1.2.2.2.2" xref="S3.SS1.p4.11.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.SS1.p4.11.m1.1.2.1" xref="S3.SS1.p4.11.m1.1.2.1.cmml">=</mo><mn id="S3.SS1.p4.11.m1.1.2.3" xref="S3.SS1.p4.11.m1.1.2.3.cmml">55</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.11.m1.1b"><apply id="S3.SS1.p4.11.m1.1.2.cmml" xref="S3.SS1.p4.11.m1.1.2"><eq id="S3.SS1.p4.11.m1.1.2.1.cmml" xref="S3.SS1.p4.11.m1.1.2.1"></eq><apply id="S3.SS1.p4.11.m1.1.2.2.1.cmml" xref="S3.SS1.p4.11.m1.1.2.2.2"><abs id="S3.SS1.p4.11.m1.1.2.2.1.1.cmml" xref="S3.SS1.p4.11.m1.1.2.2.2.1"></abs><ci id="S3.SS1.p4.11.m1.1.1.cmml" xref="S3.SS1.p4.11.m1.1.1">𝒲</ci></apply><cn type="integer" id="S3.SS1.p4.11.m1.1.2.3.cmml" xref="S3.SS1.p4.11.m1.1.2.3">55</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.11.m1.1c">|\mathcal{W}|=55</annotation></semantics></math> windows in practice and <math id="S3.SS1.p4.12.m2.1" class="ltx_Math" alttext="w_{i}\in\mathcal{W}" display="inline"><semantics id="S3.SS1.p4.12.m2.1a"><mrow id="S3.SS1.p4.12.m2.1.1" xref="S3.SS1.p4.12.m2.1.1.cmml"><msub id="S3.SS1.p4.12.m2.1.1.2" xref="S3.SS1.p4.12.m2.1.1.2.cmml"><mi id="S3.SS1.p4.12.m2.1.1.2.2" xref="S3.SS1.p4.12.m2.1.1.2.2.cmml">w</mi><mi id="S3.SS1.p4.12.m2.1.1.2.3" xref="S3.SS1.p4.12.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p4.12.m2.1.1.1" xref="S3.SS1.p4.12.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.12.m2.1.1.3" xref="S3.SS1.p4.12.m2.1.1.3.cmml">𝒲</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.12.m2.1b"><apply id="S3.SS1.p4.12.m2.1.1.cmml" xref="S3.SS1.p4.12.m2.1.1"><in id="S3.SS1.p4.12.m2.1.1.1.cmml" xref="S3.SS1.p4.12.m2.1.1.1"></in><apply id="S3.SS1.p4.12.m2.1.1.2.cmml" xref="S3.SS1.p4.12.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.12.m2.1.1.2.1.cmml" xref="S3.SS1.p4.12.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.12.m2.1.1.2.2.cmml" xref="S3.SS1.p4.12.m2.1.1.2.2">𝑤</ci><ci id="S3.SS1.p4.12.m2.1.1.2.3.cmml" xref="S3.SS1.p4.12.m2.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.p4.12.m2.1.1.3.cmml" xref="S3.SS1.p4.12.m2.1.1.3">𝒲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.12.m2.1c">w_{i}\in\mathcal{W}</annotation></semantics></math>.
The correlation matrix between the features of the query and candidate matches is computed as:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.3" class="ltx_Math" alttext="C_{qi}=\hat{F}_{q}\hat{F}^{T}_{i}\in\mathbb{R}^{|\mathcal{W}|\times|\mathcal{W}|}." display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml"><mi id="S3.E3.m1.3.3.1.1.2.2" xref="S3.E3.m1.3.3.1.1.2.2.cmml">C</mi><mrow id="S3.E3.m1.3.3.1.1.2.3" xref="S3.E3.m1.3.3.1.1.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1.2.3.2" xref="S3.E3.m1.3.3.1.1.2.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.2.3.1" xref="S3.E3.m1.3.3.1.1.2.3.1.cmml">​</mo><mi id="S3.E3.m1.3.3.1.1.2.3.3" xref="S3.E3.m1.3.3.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.4" xref="S3.E3.m1.3.3.1.1.4.cmml"><msub id="S3.E3.m1.3.3.1.1.4.2" xref="S3.E3.m1.3.3.1.1.4.2.cmml"><mover accent="true" id="S3.E3.m1.3.3.1.1.4.2.2" xref="S3.E3.m1.3.3.1.1.4.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.4.2.2.2" xref="S3.E3.m1.3.3.1.1.4.2.2.2.cmml">F</mi><mo id="S3.E3.m1.3.3.1.1.4.2.2.1" xref="S3.E3.m1.3.3.1.1.4.2.2.1.cmml">^</mo></mover><mi id="S3.E3.m1.3.3.1.1.4.2.3" xref="S3.E3.m1.3.3.1.1.4.2.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.4.1" xref="S3.E3.m1.3.3.1.1.4.1.cmml">​</mo><msubsup id="S3.E3.m1.3.3.1.1.4.3" xref="S3.E3.m1.3.3.1.1.4.3.cmml"><mover accent="true" id="S3.E3.m1.3.3.1.1.4.3.2.2" xref="S3.E3.m1.3.3.1.1.4.3.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.4.3.2.2.2" xref="S3.E3.m1.3.3.1.1.4.3.2.2.2.cmml">F</mi><mo id="S3.E3.m1.3.3.1.1.4.3.2.2.1" xref="S3.E3.m1.3.3.1.1.4.3.2.2.1.cmml">^</mo></mover><mi id="S3.E3.m1.3.3.1.1.4.3.3" xref="S3.E3.m1.3.3.1.1.4.3.3.cmml">i</mi><mi id="S3.E3.m1.3.3.1.1.4.3.2.3" xref="S3.E3.m1.3.3.1.1.4.3.2.3.cmml">T</mi></msubsup></mrow><mo id="S3.E3.m1.3.3.1.1.5" xref="S3.E3.m1.3.3.1.1.5.cmml">∈</mo><msup id="S3.E3.m1.3.3.1.1.6" xref="S3.E3.m1.3.3.1.1.6.cmml"><mi id="S3.E3.m1.3.3.1.1.6.2" xref="S3.E3.m1.3.3.1.1.6.2.cmml">ℝ</mi><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><mrow id="S3.E3.m1.2.2.2.4.2" xref="S3.E3.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.4.2.1" xref="S3.E3.m1.2.2.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">𝒲</mi><mo rspace="0.055em" stretchy="false" id="S3.E3.m1.2.2.2.4.2.2" xref="S3.E3.m1.2.2.2.4.1.1.cmml">|</mo></mrow><mo rspace="0.222em" id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">×</mo><mrow id="S3.E3.m1.2.2.2.5.2" xref="S3.E3.m1.2.2.2.5.1.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.5.2.1" xref="S3.E3.m1.2.2.2.5.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">𝒲</mi><mo stretchy="false" id="S3.E3.m1.2.2.2.5.2.2" xref="S3.E3.m1.2.2.2.5.1.1.cmml">|</mo></mrow></mrow></msup></mrow><mo lspace="0em" id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><and id="S3.E3.m1.3.3.1.1a.cmml" xref="S3.E3.m1.3.3.1"></and><apply id="S3.E3.m1.3.3.1.1b.cmml" xref="S3.E3.m1.3.3.1"><eq id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"></eq><apply id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.2.2">𝐶</ci><apply id="S3.E3.m1.3.3.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.2.3"><times id="S3.E3.m1.3.3.1.1.2.3.1.cmml" xref="S3.E3.m1.3.3.1.1.2.3.1"></times><ci id="S3.E3.m1.3.3.1.1.2.3.2.cmml" xref="S3.E3.m1.3.3.1.1.2.3.2">𝑞</ci><ci id="S3.E3.m1.3.3.1.1.2.3.3.cmml" xref="S3.E3.m1.3.3.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E3.m1.3.3.1.1.4.cmml" xref="S3.E3.m1.3.3.1.1.4"><times id="S3.E3.m1.3.3.1.1.4.1.cmml" xref="S3.E3.m1.3.3.1.1.4.1"></times><apply id="S3.E3.m1.3.3.1.1.4.2.cmml" xref="S3.E3.m1.3.3.1.1.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.4.2.1.cmml" xref="S3.E3.m1.3.3.1.1.4.2">subscript</csymbol><apply id="S3.E3.m1.3.3.1.1.4.2.2.cmml" xref="S3.E3.m1.3.3.1.1.4.2.2"><ci id="S3.E3.m1.3.3.1.1.4.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.4.2.2.1">^</ci><ci id="S3.E3.m1.3.3.1.1.4.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.4.2.2.2">𝐹</ci></apply><ci id="S3.E3.m1.3.3.1.1.4.2.3.cmml" xref="S3.E3.m1.3.3.1.1.4.2.3">𝑞</ci></apply><apply id="S3.E3.m1.3.3.1.1.4.3.cmml" xref="S3.E3.m1.3.3.1.1.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.4.3.1.cmml" xref="S3.E3.m1.3.3.1.1.4.3">subscript</csymbol><apply id="S3.E3.m1.3.3.1.1.4.3.2.cmml" xref="S3.E3.m1.3.3.1.1.4.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.4.3.2.1.cmml" xref="S3.E3.m1.3.3.1.1.4.3">superscript</csymbol><apply id="S3.E3.m1.3.3.1.1.4.3.2.2.cmml" xref="S3.E3.m1.3.3.1.1.4.3.2.2"><ci id="S3.E3.m1.3.3.1.1.4.3.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.4.3.2.2.1">^</ci><ci id="S3.E3.m1.3.3.1.1.4.3.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.4.3.2.2.2">𝐹</ci></apply><ci id="S3.E3.m1.3.3.1.1.4.3.2.3.cmml" xref="S3.E3.m1.3.3.1.1.4.3.2.3">𝑇</ci></apply><ci id="S3.E3.m1.3.3.1.1.4.3.3.cmml" xref="S3.E3.m1.3.3.1.1.4.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E3.m1.3.3.1.1c.cmml" xref="S3.E3.m1.3.3.1"><in id="S3.E3.m1.3.3.1.1.5.cmml" xref="S3.E3.m1.3.3.1.1.5"></in><share href="#S3.E3.m1.3.3.1.1.4.cmml" id="S3.E3.m1.3.3.1.1d.cmml" xref="S3.E3.m1.3.3.1"></share><apply id="S3.E3.m1.3.3.1.1.6.cmml" xref="S3.E3.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.6.1.cmml" xref="S3.E3.m1.3.3.1.1.6">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.6.2.cmml" xref="S3.E3.m1.3.3.1.1.6.2">ℝ</ci><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><times id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"></times><apply id="S3.E3.m1.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.2.4.2"><abs id="S3.E3.m1.2.2.2.4.1.1.cmml" xref="S3.E3.m1.2.2.2.4.2.1"></abs><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝒲</ci></apply><apply id="S3.E3.m1.2.2.2.5.1.cmml" xref="S3.E3.m1.2.2.2.5.2"><abs id="S3.E3.m1.2.2.2.5.1.1.cmml" xref="S3.E3.m1.2.2.2.5.2.1"></abs><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝒲</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">C_{qi}=\hat{F}_{q}\hat{F}^{T}_{i}\in\mathbb{R}^{|\mathcal{W}|\times|\mathcal{W}|}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS1.p4.16" class="ltx_p">This is then flattened and fed to a 3-layer <math id="S3.SS1.p4.13.m1.1" class="ltx_Math" alttext="\operatorname{MLP}" display="inline"><semantics id="S3.SS1.p4.13.m1.1a"><mi id="S3.SS1.p4.13.m1.1.1" xref="S3.SS1.p4.13.m1.1.1.cmml">MLP</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.13.m1.1b"><ci id="S3.SS1.p4.13.m1.1.1.cmml" xref="S3.SS1.p4.13.m1.1.1">MLP</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.13.m1.1c">\operatorname{MLP}</annotation></semantics></math>, which outputs the similarity score between the query and retrieval images.
To make the model symmetric w.r.t. its inputs, the similarity score between images <math id="S3.SS1.p4.14.m2.1" class="ltx_Math" alttext="x_{q}" display="inline"><semantics id="S3.SS1.p4.14.m2.1a"><msub id="S3.SS1.p4.14.m2.1.1" xref="S3.SS1.p4.14.m2.1.1.cmml"><mi id="S3.SS1.p4.14.m2.1.1.2" xref="S3.SS1.p4.14.m2.1.1.2.cmml">x</mi><mi id="S3.SS1.p4.14.m2.1.1.3" xref="S3.SS1.p4.14.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.14.m2.1b"><apply id="S3.SS1.p4.14.m2.1.1.cmml" xref="S3.SS1.p4.14.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.14.m2.1.1.1.cmml" xref="S3.SS1.p4.14.m2.1.1">subscript</csymbol><ci id="S3.SS1.p4.14.m2.1.1.2.cmml" xref="S3.SS1.p4.14.m2.1.1.2">𝑥</ci><ci id="S3.SS1.p4.14.m2.1.1.3.cmml" xref="S3.SS1.p4.14.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.14.m2.1c">x_{q}</annotation></semantics></math> and <math id="S3.SS1.p4.15.m3.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S3.SS1.p4.15.m3.1a"><msub id="S3.SS1.p4.15.m3.1.1" xref="S3.SS1.p4.15.m3.1.1.cmml"><mi id="S3.SS1.p4.15.m3.1.1.2" xref="S3.SS1.p4.15.m3.1.1.2.cmml">x</mi><mi id="S3.SS1.p4.15.m3.1.1.3" xref="S3.SS1.p4.15.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.15.m3.1b"><apply id="S3.SS1.p4.15.m3.1.1.cmml" xref="S3.SS1.p4.15.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.15.m3.1.1.1.cmml" xref="S3.SS1.p4.15.m3.1.1">subscript</csymbol><ci id="S3.SS1.p4.15.m3.1.1.2.cmml" xref="S3.SS1.p4.15.m3.1.1.2">𝑥</ci><ci id="S3.SS1.p4.15.m3.1.1.3.cmml" xref="S3.SS1.p4.15.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.15.m3.1c">x_{i}</annotation></semantics></math> is defined as follows, where <math id="S3.SS1.p4.16.m4.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS1.p4.16.m4.1a"><mi id="S3.SS1.p4.16.m4.1.1" xref="S3.SS1.p4.16.m4.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.16.m4.1b"><ci id="S3.SS1.p4.16.m4.1.1.cmml" xref="S3.SS1.p4.16.m4.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.16.m4.1c">\sigma</annotation></semantics></math> is a sigmoid activation.</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.4" class="ltx_Math" alttext="\operatorname{score}(x_{q},x_{i})=\sigma\big{(}\operatorname{MLP}(C_{qi})+\operatorname{MLP}(C_{iq})\big{)}," display="block"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4.1" xref="S3.E4.m1.4.4.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.2.2" xref="S3.E4.m1.4.4.1.1.2.3.cmml"><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">score</mi><mo id="S3.E4.m1.4.4.1.1.2.2a" xref="S3.E4.m1.4.4.1.1.2.3.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.1.1.2.2.2" xref="S3.E4.m1.4.4.1.1.2.3.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.2.2.2.3" xref="S3.E4.m1.4.4.1.1.2.3.cmml">(</mo><msub id="S3.E4.m1.4.4.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml">q</mi></msub><mo id="S3.E4.m1.4.4.1.1.2.2.2.4" xref="S3.E4.m1.4.4.1.1.2.3.cmml">,</mo><msub id="S3.E4.m1.4.4.1.1.2.2.2.2" xref="S3.E4.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S3.E4.m1.4.4.1.1.2.2.2.2.2" xref="S3.E4.m1.4.4.1.1.2.2.2.2.2.cmml">x</mi><mi id="S3.E4.m1.4.4.1.1.2.2.2.2.3" xref="S3.E4.m1.4.4.1.1.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.4.4.1.1.2.2.2.5" xref="S3.E4.m1.4.4.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.4" xref="S3.E4.m1.4.4.1.1.4.cmml">=</mo><mrow id="S3.E4.m1.4.4.1.1.3" xref="S3.E4.m1.4.4.1.1.3.cmml"><mi id="S3.E4.m1.4.4.1.1.3.3" xref="S3.E4.m1.4.4.1.1.3.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.3.2" xref="S3.E4.m1.4.4.1.1.3.2.cmml">​</mo><mrow id="S3.E4.m1.4.4.1.1.3.1.1" xref="S3.E4.m1.4.4.1.1.3.1.1.1.cmml"><mo maxsize="120%" minsize="120%" id="S3.E4.m1.4.4.1.1.3.1.1.2" xref="S3.E4.m1.4.4.1.1.3.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.1.1.3.1.1.1" xref="S3.E4.m1.4.4.1.1.3.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.2.cmml"><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">MLP</mi><mo id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1a" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.2.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.2.cmml">(</mo><msub id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.2.cmml">C</mi><mrow id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.2.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.1" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo stretchy="false" id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.1.1.3.1.1.1.3" xref="S3.E4.m1.4.4.1.1.3.1.1.1.3.cmml">+</mo><mrow id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.2.cmml"><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">MLP</mi><mo id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1a" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.2.cmml">⁡</mo><mrow id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.2" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.2.cmml">(</mo><msub id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.2" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.2.cmml">C</mi><mrow id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.1" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.1.cmml">​</mo><mi id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.3" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.3.cmml">q</mi></mrow></msub><mo stretchy="false" id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.3" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo maxsize="120%" minsize="120%" id="S3.E4.m1.4.4.1.1.3.1.1.3" xref="S3.E4.m1.4.4.1.1.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.4.4.1.2" xref="S3.E4.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1"><eq id="S3.E4.m1.4.4.1.1.4.cmml" xref="S3.E4.m1.4.4.1.1.4"></eq><apply id="S3.E4.m1.4.4.1.1.2.3.cmml" xref="S3.E4.m1.4.4.1.1.2.2"><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">score</ci><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3">𝑞</ci></apply><apply id="S3.E4.m1.4.4.1.1.2.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S3.E4.m1.4.4.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S3.E4.m1.4.4.1.1.2.2.2.2.2">𝑥</ci><ci id="S3.E4.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S3.E4.m1.4.4.1.1.2.2.2.2.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.4.4.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.3"><times id="S3.E4.m1.4.4.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.3.2"></times><ci id="S3.E4.m1.4.4.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.3.3">𝜎</ci><apply id="S3.E4.m1.4.4.1.1.3.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1"><plus id="S3.E4.m1.4.4.1.1.3.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.3"></plus><apply id="S3.E4.m1.4.4.1.1.3.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1"><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">MLP</ci><apply id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.2">𝐶</ci><apply id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3"><times id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.2">𝑞</ci><ci id="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.4.4.1.1.3.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1"><ci id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3">MLP</ci><apply id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.2">𝐶</ci><apply id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3"><times id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.1"></times><ci id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.2">𝑖</ci><ci id="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.3.1.1.1.2.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\operatorname{score}(x_{q},x_{i})=\sigma\big{(}\operatorname{MLP}(C_{qi})+\operatorname{MLP}(C_{iq})\big{)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.1" class="ltx_p">Data augmentation, such as color jittering and random cropping, as well as minor, benign modifications, manipulations, and degradation of image content due to noise, format change, compression, and resolution change are applied to enhance robustness against benign image alterations <cite class="ltx_cite ltx_citemacro_citep">(Hendrycks and Dimanetterich, <a href="#bib.bib12" title="" class="ltx_ref">2019</a>)</cite>. This is to model artifacts commonly present in generated images during the initial and later phases of training GenAI models, such as blurred and distorted images. Despite the artifacts, this approach allows us to identify images with an unusually similar style or content as training data. Positive training pairs are created using augmented samples, while challenging negative pairs are generated via hard negative mining. Global average-pooled feature maps of query and queued examples are compared via cosine similarity for the sampling of negatives. The model is trained using binary cross-entropy loss on pairs of true and false matches.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Identifying memorized samples</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p"><span id="S3.SS2.p1.1.1" class="ltx_text ltx_font_bold">Intra-class threshold for retrieval distance.</span> Carlini et al. <cite class="ltx_cite ltx_citemacro_citep">(Carlini et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2023</a>)</cite> propose a method to identify memorized samples strictly based on L2 distance thresholding. The memorized image extraction method considers an image as memorized if its L2 distance to the nearest neighbor in the training set is significantly lower than that of all other training images.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">We draw inspiration from this approach and compute intra-class distance thresholds rather than individual image thresholds. We extract image fingerprints from all samples in the training set and calculate the L2 distance between each image and its closest intra-class neighbor. We compute the mean and standard deviation of this distance across each class to determine the threshold <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="T_{\text{L2}_{\text{class}}}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">T</mi><msub id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mtext id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2a.cmml">L2</mtext><mtext id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3a.cmml">class</mtext></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑇</ci><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2a.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2"><mtext mathsize="70%" id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">L2</mtext></ci><ci id="S3.SS2.p2.1.m1.1.1.3.3a.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3"><mtext mathsize="50%" id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">class</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">T_{\text{L2}_{\text{class}}}</annotation></semantics></math>. Any generated image whose L2 distance to a training sample falls below this threshold is deemed unusually close to the training data, prompting further analysis.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.1" class="ltx_Math" alttext="T_{\text{L2}_{\text{class}}}=\text{mean}-(0.5\times\text{stdev})" display="block"><semantics id="S3.E5.m1.1a"><mrow id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><msub id="S3.E5.m1.1.1.3" xref="S3.E5.m1.1.1.3.cmml"><mi id="S3.E5.m1.1.1.3.2" xref="S3.E5.m1.1.1.3.2.cmml">T</mi><msub id="S3.E5.m1.1.1.3.3" xref="S3.E5.m1.1.1.3.3.cmml"><mtext id="S3.E5.m1.1.1.3.3.2" xref="S3.E5.m1.1.1.3.3.2a.cmml">L2</mtext><mtext id="S3.E5.m1.1.1.3.3.3" xref="S3.E5.m1.1.1.3.3.3a.cmml">class</mtext></msub></msub><mo id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml"><mtext id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.1.1.1.3a.cmml">mean</mtext><mo id="S3.E5.m1.1.1.1.2" xref="S3.E5.m1.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml"><mn id="S3.E5.m1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.2.cmml">0.5</mn><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.cmml">×</mo><mtext id="S3.E5.m1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.3a.cmml">stdev</mtext></mrow><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.1b"><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1"><eq id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2"></eq><apply id="S3.E5.m1.1.1.3.cmml" xref="S3.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.3.2">𝑇</ci><apply id="S3.E5.m1.1.1.3.3.cmml" xref="S3.E5.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.3.3.1.cmml" xref="S3.E5.m1.1.1.3.3">subscript</csymbol><ci id="S3.E5.m1.1.1.3.3.2a.cmml" xref="S3.E5.m1.1.1.3.3.2"><mtext mathsize="70%" id="S3.E5.m1.1.1.3.3.2.cmml" xref="S3.E5.m1.1.1.3.3.2">L2</mtext></ci><ci id="S3.E5.m1.1.1.3.3.3a.cmml" xref="S3.E5.m1.1.1.3.3.3"><mtext mathsize="50%" id="S3.E5.m1.1.1.3.3.3.cmml" xref="S3.E5.m1.1.1.3.3.3">class</mtext></ci></apply></apply><apply id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1"><minus id="S3.E5.m1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.2"></minus><ci id="S3.E5.m1.1.1.1.3a.cmml" xref="S3.E5.m1.1.1.1.3"><mtext id="S3.E5.m1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.3">mean</mtext></ci><apply id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1"></times><cn type="float" id="S3.E5.m1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.2">0.5</cn><ci id="S3.E5.m1.1.1.1.1.1.1.3a.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3"><mtext id="S3.E5.m1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.3">stdev</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.1c">T_{\text{L2}_{\text{class}}}=\text{mean}-(0.5\times\text{stdev})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p"><span id="S3.SS2.p4.1.1" class="ltx_text ltx_font_bold">KNN search.</span> During this step, a KNN search is performed between each generated sample and local training samples to determine the pairs that fall under the intra-class threshold. The list of pairs is compiled and passed to the next step.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">Unlike Carlini et al. <cite class="ltx_cite ltx_citemacro_citep">(Carlini et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2023</a>)</cite>, our approach incorporates L2 search but does not solely rely on it. Instead, it leverages a bespoke feature extractor and integrates a secondary pairwise verification stage, as outlined below.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.1" class="ltx_p"><span id="S3.SS2.p6.1.1" class="ltx_text ltx_font_bold">Image match verification.</span> During this step, each pair consisting of a generated sample and a retrieved, unusually similar training sample is passed to the image match verification model, resulting in a similarity <math id="S3.SS2.p6.1.m1.5" class="ltx_Math" alttext="\operatorname{score}(x_{q},x_{i})\in[0,1]" display="inline"><semantics id="S3.SS2.p6.1.m1.5a"><mrow id="S3.SS2.p6.1.m1.5.5" xref="S3.SS2.p6.1.m1.5.5.cmml"><mrow id="S3.SS2.p6.1.m1.5.5.2.2" xref="S3.SS2.p6.1.m1.5.5.2.3.cmml"><mi id="S3.SS2.p6.1.m1.1.1" xref="S3.SS2.p6.1.m1.1.1.cmml">score</mi><mo id="S3.SS2.p6.1.m1.5.5.2.2a" xref="S3.SS2.p6.1.m1.5.5.2.3.cmml">⁡</mo><mrow id="S3.SS2.p6.1.m1.5.5.2.2.2" xref="S3.SS2.p6.1.m1.5.5.2.3.cmml"><mo stretchy="false" id="S3.SS2.p6.1.m1.5.5.2.2.2.3" xref="S3.SS2.p6.1.m1.5.5.2.3.cmml">(</mo><msub id="S3.SS2.p6.1.m1.4.4.1.1.1.1" xref="S3.SS2.p6.1.m1.4.4.1.1.1.1.cmml"><mi id="S3.SS2.p6.1.m1.4.4.1.1.1.1.2" xref="S3.SS2.p6.1.m1.4.4.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.p6.1.m1.4.4.1.1.1.1.3" xref="S3.SS2.p6.1.m1.4.4.1.1.1.1.3.cmml">q</mi></msub><mo id="S3.SS2.p6.1.m1.5.5.2.2.2.4" xref="S3.SS2.p6.1.m1.5.5.2.3.cmml">,</mo><msub id="S3.SS2.p6.1.m1.5.5.2.2.2.2" xref="S3.SS2.p6.1.m1.5.5.2.2.2.2.cmml"><mi id="S3.SS2.p6.1.m1.5.5.2.2.2.2.2" xref="S3.SS2.p6.1.m1.5.5.2.2.2.2.2.cmml">x</mi><mi id="S3.SS2.p6.1.m1.5.5.2.2.2.2.3" xref="S3.SS2.p6.1.m1.5.5.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS2.p6.1.m1.5.5.2.2.2.5" xref="S3.SS2.p6.1.m1.5.5.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p6.1.m1.5.5.3" xref="S3.SS2.p6.1.m1.5.5.3.cmml">∈</mo><mrow id="S3.SS2.p6.1.m1.5.5.4.2" xref="S3.SS2.p6.1.m1.5.5.4.1.cmml"><mo stretchy="false" id="S3.SS2.p6.1.m1.5.5.4.2.1" xref="S3.SS2.p6.1.m1.5.5.4.1.cmml">[</mo><mn id="S3.SS2.p6.1.m1.2.2" xref="S3.SS2.p6.1.m1.2.2.cmml">0</mn><mo id="S3.SS2.p6.1.m1.5.5.4.2.2" xref="S3.SS2.p6.1.m1.5.5.4.1.cmml">,</mo><mn id="S3.SS2.p6.1.m1.3.3" xref="S3.SS2.p6.1.m1.3.3.cmml">1</mn><mo stretchy="false" id="S3.SS2.p6.1.m1.5.5.4.2.3" xref="S3.SS2.p6.1.m1.5.5.4.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p6.1.m1.5b"><apply id="S3.SS2.p6.1.m1.5.5.cmml" xref="S3.SS2.p6.1.m1.5.5"><in id="S3.SS2.p6.1.m1.5.5.3.cmml" xref="S3.SS2.p6.1.m1.5.5.3"></in><apply id="S3.SS2.p6.1.m1.5.5.2.3.cmml" xref="S3.SS2.p6.1.m1.5.5.2.2"><ci id="S3.SS2.p6.1.m1.1.1.cmml" xref="S3.SS2.p6.1.m1.1.1">score</ci><apply id="S3.SS2.p6.1.m1.4.4.1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.SS2.p6.1.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p6.1.m1.4.4.1.1.1.1.2.cmml" xref="S3.SS2.p6.1.m1.4.4.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.p6.1.m1.4.4.1.1.1.1.3.cmml" xref="S3.SS2.p6.1.m1.4.4.1.1.1.1.3">𝑞</ci></apply><apply id="S3.SS2.p6.1.m1.5.5.2.2.2.2.cmml" xref="S3.SS2.p6.1.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p6.1.m1.5.5.2.2.2.2.1.cmml" xref="S3.SS2.p6.1.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p6.1.m1.5.5.2.2.2.2.2.cmml" xref="S3.SS2.p6.1.m1.5.5.2.2.2.2.2">𝑥</ci><ci id="S3.SS2.p6.1.m1.5.5.2.2.2.2.3.cmml" xref="S3.SS2.p6.1.m1.5.5.2.2.2.2.3">𝑖</ci></apply></apply><interval closure="closed" id="S3.SS2.p6.1.m1.5.5.4.1.cmml" xref="S3.SS2.p6.1.m1.5.5.4.2"><cn type="integer" id="S3.SS2.p6.1.m1.2.2.cmml" xref="S3.SS2.p6.1.m1.2.2">0</cn><cn type="integer" id="S3.SS2.p6.1.m1.3.3.cmml" xref="S3.SS2.p6.1.m1.3.3">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p6.1.m1.5c">\operatorname{score}(x_{q},x_{i})\in[0,1]</annotation></semantics></math>. We empirically set a 0.8 threshold for an image match confirmation. There are often duplicates within training data, and some samples are generated multiple times. Due to this, each generated sample and training sample may be counted as memorized only once. This step concludes with a final count of memorized samples.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Metric design</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Our metric balances sample quality and fidelity against novelty to robustly evaluate diffusion models.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p"><span id="S3.SS3.p2.1.1" class="ltx_text ltx_font_bold">Novelty.</span> We define novelty as the degree to which generated samples differ from the training samples. Memorized samples are simply reproductions of training samples. The three values that determine the novelty component of our proposed metric are calculated using similarity scores output by the match verification model as such:</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p"><span id="S3.SS3.p3.1.1" class="ltx_text ltx_font_bold">1) <math id="S3.SS3.p3.1.1.m1.1" class="ltx_Math" alttext="V_{A}" display="inline"><semantics id="S3.SS3.p3.1.1.m1.1a"><msub id="S3.SS3.p3.1.1.m1.1.1" xref="S3.SS3.p3.1.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.1.m1.1.1.2" xref="S3.SS3.p3.1.1.m1.1.1.2.cmml">V</mi><mi id="S3.SS3.p3.1.1.m1.1.1.3" xref="S3.SS3.p3.1.1.m1.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.1.m1.1b"><apply id="S3.SS3.p3.1.1.m1.1.1.cmml" xref="S3.SS3.p3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.1.m1.1.1.2">𝑉</ci><ci id="S3.SS3.p3.1.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.1.m1.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.1.m1.1c">V_{A}</annotation></semantics></math>: The mean similarity score of all checked pairs.</span> This value encompasses the mean similarity score of all pairs passed to the image match verification model, whether confirmed or unconfirmed matches. We consider that a novelty score shouldn’t be influenced solely by those samples that are unquestionably memorized. Instead, all pairs passed to the verification model exhibit unusual similarity to training samples and thus should be accounted for when designing a robust and multidimensional novelty score. Although unconfirmed, unusually similar samples to training data may indicate early signs of memorization.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.1" class="ltx_p"><span id="S3.SS3.p4.1.1" class="ltx_text ltx_font_bold">2) <math id="S3.SS3.p4.1.1.m1.1" class="ltx_Math" alttext="V_{C}" display="inline"><semantics id="S3.SS3.p4.1.1.m1.1a"><msub id="S3.SS3.p4.1.1.m1.1.1" xref="S3.SS3.p4.1.1.m1.1.1.cmml"><mi id="S3.SS3.p4.1.1.m1.1.1.2" xref="S3.SS3.p4.1.1.m1.1.1.2.cmml">V</mi><mi id="S3.SS3.p4.1.1.m1.1.1.3" xref="S3.SS3.p4.1.1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.1.m1.1b"><apply id="S3.SS3.p4.1.1.m1.1.1.cmml" xref="S3.SS3.p4.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.1.1.m1.1.1.1.cmml" xref="S3.SS3.p4.1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p4.1.1.m1.1.1.2.cmml" xref="S3.SS3.p4.1.1.m1.1.1.2">𝑉</ci><ci id="S3.SS3.p4.1.1.m1.1.1.3.cmml" xref="S3.SS3.p4.1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.1.m1.1c">V_{C}</annotation></semantics></math>: The mean similarity score of all confirmed matches.</span> This introduces a measure of the similarity between memorized and training samples, thereby enhancing accuracy compared to a binary true/false measure.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.1" class="ltx_p"><span id="S3.SS3.p5.1.1" class="ltx_text ltx_font_bold">3)<math id="S3.SS3.p5.1.1.m1.1" class="ltx_Math" alttext="R_{C}" display="inline"><semantics id="S3.SS3.p5.1.1.m1.1a"><msub id="S3.SS3.p5.1.1.m1.1.1" xref="S3.SS3.p5.1.1.m1.1.1.cmml"><mi id="S3.SS3.p5.1.1.m1.1.1.2" xref="S3.SS3.p5.1.1.m1.1.1.2.cmml">R</mi><mi id="S3.SS3.p5.1.1.m1.1.1.3" xref="S3.SS3.p5.1.1.m1.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.1.m1.1b"><apply id="S3.SS3.p5.1.1.m1.1.1.cmml" xref="S3.SS3.p5.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.1.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p5.1.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.1.m1.1.1.2">𝑅</ci><ci id="S3.SS3.p5.1.1.m1.1.1.3.cmml" xref="S3.SS3.p5.1.1.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.1.m1.1c">R_{C}</annotation></semantics></math>: The ratio of confirmed memorized samples to the total number of generated samples.</span></p>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.1" class="ltx_p"><span id="S3.SS3.p6.1.1" class="ltx_text ltx_font_bold">Quality and fidelity.</span> To account for the quality and fidelity of generated samples, our metric incorporates the FID score calculated between the generated samples and each node’s local test samples. The feature extractor utilized is DINOv2 ViT-L/14 <cite class="ltx_cite ltx_citemacro_citep">(Oquab et al<span class="ltx_text">.</span>, <a href="#bib.bib19" title="" class="ltx_ref">2024</a>)</cite>, replacing the traditional Inception-V3, as Stein et al. <cite class="ltx_cite ltx_citemacro_citep">(Stein et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2023</a>)</cite> found this replacement solves the discrepancy with human evaluators. Consequently, the FID value is notably higher than expected due to this change.</p>
</div>
<div id="S3.SS3.p7" class="ltx_para">
<p id="S3.SS3.p7.1" class="ltx_p">Our proposed quality-novelty score is computed as follows:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\text{Q-N score}=\frac{{\text{FID}+(V_{C}\times V_{A}\times R_{C}\times 1000)}}{2}" display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.2" xref="S3.E6.m1.1.2.cmml"><mtext id="S3.E6.m1.1.2.2" xref="S3.E6.m1.1.2.2a.cmml">Q-N score</mtext><mo id="S3.E6.m1.1.2.1" xref="S3.E6.m1.1.2.1.cmml">=</mo><mfrac id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mtext id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3a.cmml">FID</mtext><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.cmml">V</mi><mi id="S3.E6.m1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.3.cmml">C</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">×</mo><msub id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.3.2.cmml">V</mi><mi id="S3.E6.m1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.3.3.cmml">A</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.1.1.1.1.1.1.1a" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">×</mo><msub id="S3.E6.m1.1.1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.4.2" xref="S3.E6.m1.1.1.1.1.1.1.4.2.cmml">R</mi><mi id="S3.E6.m1.1.1.1.1.1.1.4.3" xref="S3.E6.m1.1.1.1.1.1.1.4.3.cmml">C</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.1.1.1.1.1.1.1b" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">×</mo><mn id="S3.E6.m1.1.1.1.1.1.1.5" xref="S3.E6.m1.1.1.1.1.1.1.5.cmml">1000</mn></mrow><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mn id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.2.cmml" xref="S3.E6.m1.1.2"><eq id="S3.E6.m1.1.2.1.cmml" xref="S3.E6.m1.1.2.1"></eq><ci id="S3.E6.m1.1.2.2a.cmml" xref="S3.E6.m1.1.2.2"><mtext id="S3.E6.m1.1.2.2.cmml" xref="S3.E6.m1.1.2.2">Q-N score</mtext></ci><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><divide id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1"></divide><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><plus id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></plus><ci id="S3.E6.m1.1.1.1.3a.cmml" xref="S3.E6.m1.1.1.1.3"><mtext id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3">FID</mtext></ci><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"></times><apply id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2">𝑉</ci><ci id="S3.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.3">𝐶</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.2">𝑉</ci><ci id="S3.E6.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.3.3">𝐴</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.4.2">𝑅</ci><ci id="S3.E6.m1.1.1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.4.3">𝐶</ci></apply><cn type="integer" id="S3.E6.m1.1.1.1.1.1.1.5.cmml" xref="S3.E6.m1.1.1.1.1.1.1.5">1000</cn></apply></apply><cn type="integer" id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\text{Q-N score}=\frac{{\text{FID}+(V_{C}\times V_{A}\times R_{C}\times 1000)}}{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p7.2" class="ltx_p">Our Q-N score is customizable - the user may adjust parameters such as the intra-class distance and match confirmation threshold. Unlike concurrent metrics such as FLD, which necessitates a minimum of 10,000 generated samples for an accurately reported score, the Q-N score can be computed irrespective of the train, test, or generated image set size. Our score also allows for the extraction of memorized sample pairs, unlike other metrics, which rely on the statistical properties of the data to identify and measure memorization rather than conducting pairwise comparisons. The computational overhead of calculating our score is minimal. Fingerprinting, searching for matches, and verifying an image pair typically take an average of 41 ms per image. The fingerprinter model requires a minimum of 1 GB of GPU memory, while the verifier model requires 2.6 GB of GPU memory.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Federated Learning Framework</h2>

<figure id="S4.F2" class="ltx_figure"><img src="/html/2409.18245/assets/figs/arch+manifest.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="261" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>System Architecture: client nodes, holding private training/validation data, interact with the federated learning task smart contract deployed on an Ethereum blockchain. The system design allows nodes to participate asynchronously, contributing to model evaluation and selection while retaining autonomy over training strategies and resource usage. The model weights are stored on peer-to-peer solution IPFS, accompanied by C2PA <cite class="ltx_cite ltx_citemacro_citep">(Coalition for Content Provenance and Authenticity, <a href="#bib.bib11" title="" class="ltx_ref">2021</a>)</cite> manifests. An example manifest is included on the left - a client node describes a model contribution within PDFed. Highlighted in yellow - C2PA supports specifying ingredient assets; in this case, the IPFS storage CID of the model chosen for further training is included. Green - this designation enables the client node to describe the submitted model’s training steps. Blue - using the crypto.addresses assertion, the client node specifies their blockchain wallet address, where payments may be sent as a reward for their contributions to model training.</figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We introduce an asynchronous, decentralized, and aggregator-free smart contract-based federated learning protocol explicitly tailored for diffusion models, aiming to tackle prevalent issues in GenAI and traditional FL. As depicted in Figure <a href="#S4.F2" title="Figure 2 ‣ 4. Federated Learning Framework ‣ PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, a smart contract is deployed on a a public blockchain (for experimental purposes we chose the Ethereum blockchain network), orchestrating the federated learning process. The smart contract facilitates the registration of new client nodes and the submission of new models and votes. It emits events to notify all listening nodes of these submissions. Events emitted by the smart contract are transparent and immutable, providing a record of all actions and decisions made during the FL process, effectively replacing the centralized server in traditional federated learning and enhancing the system’s overall resilience. Our protocol accommodates dynamic participation, enabling nodes to join or leave the training process at any point without disrupting the overall workflow.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Each client node holds local data samples and contributes to the training or validation of the diffusion models. They evaluate model submissions on their privately held data using our proposed Q-N metric and submit votes indicating the best-performing model updates. The other participants then consider these votes in conjunction with their evaluations when selecting models for further training. The chosen model is further trained using the client node’s private training set, which remains private and does not leave their instance.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">The latency incurred by on-chain operations is minimal, as most operations are read-only, resulting in near-instantaneous responses. The only essential transaction involving writing to the blockchain is the model submission, which is typically processed within seconds, depending on network congestion.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Local strategy</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Traditional federated learning frameworks struggle to accommodate hardware heterogeneity among client nodes, leading to sub-optimal performance and resource utilization. Time-limited training rounds lead to missed opportunities for valuable data contribution and participation. In contrast, our framework functions asynchronously, allowing client nodes to participate in training and validation activities according to a local strategy tailored to their resources.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">Our aggregator-free protocol decentralizes the model selection process, granting all nodes access to every model update. This protocol empowers participants to evaluate all available updates independently and determine which ones to aggregate and further train. It protects against malicious actors, as underperforming models will not be picked up for additional training. Clients can also customize their strategy by deciding which votes to consider, whether they prefer input from specific actors (training nodes or validation-only nodes) or a combination of both. Moreover, clients can adjust their training process according to their resource availability, training for as long or as little as necessary.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">Another novel feature of PDFed is the support for validation-only nodes, which evaluate model updates and submit votes based on their assessment. They may have limited hardware capabilities but possess valuable data that can contribute to the validation of model updates, providing an additional layer of scrutiny, enhancing the robustness of model evaluation and selection and overall effectiveness of the protocol. This inherent flexibility facilitates adoption and broader participation, ensuring optimal performance across diverse hardware configurations and training scenarios.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Model Auditability and Incentives</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">A key component of PDFed is the maintenance of an auditable chain of model provenance, facilitated by emerging open standard from the Coalition for Content Provenance and Authenticity <cite class="ltx_cite ltx_citemacro_citep">(Coalition for Content Provenance and Authenticity, <a href="#bib.bib11" title="" class="ltx_ref">2021</a>)</cite>) and the corresponding C2PA tool, which allows model authors to bind provenance information to model files via cryptographically signed asset ‘manifests.’ These manifests, alongside model files, are stored within a distributed file system (IPFS). C2PA manifests may bear information about ”ingredient” assets used in the training process, such as a summary or hash of the private training data and the base model that was further trained. The base model is accompanied by its unique manifest and all its previous training assertions, which are then included in the new model’s provenance manifest. For each subsequent model submission, the client node adds a new training assertion that contains authorship and training facts and the author’s blockchain wallet address. This effectively builds a unique model provenance graph, which grows with each new model submission, ensuring transparency within the training process. An example manifest is pictured in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4. Federated Learning Framework ‣ PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">In conjunction with each model’s C2PA manifest detailing its provenance, the smart contract enables comprehensive tracking of all model contributions. Rewards may be apportioned based on the contributions made by each client node, as detailed in the resulting model’s manifest. The smart contract can automatically distribute payments to participants’ blockchain wallets to incentivize and reward active participation and valuable contributions from client nodes.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2409.18245/assets/figs/basline_etc.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="218" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span><span id="S4.F3.11.1" class="ltx_text ltx_font_bold">Left:</span> All metrics reported on the baseline experiment evaluated along the training process on the entire CIFAR-10 dataset. <span id="S4.F3.12.2" class="ltx_text ltx_font_bold">Right:</span> a) were trained with the objective <math id="S4.F3.5.m1.1" class="ltx_Math" alttext="L_{FLD+FID}" display="inline"><semantics id="S4.F3.5.m1.1b"><msub id="S4.F3.5.m1.1.1" xref="S4.F3.5.m1.1.1.cmml"><mi id="S4.F3.5.m1.1.1.2" xref="S4.F3.5.m1.1.1.2.cmml">L</mi><mrow id="S4.F3.5.m1.1.1.3" xref="S4.F3.5.m1.1.1.3.cmml"><mrow id="S4.F3.5.m1.1.1.3.2" xref="S4.F3.5.m1.1.1.3.2.cmml"><mi id="S4.F3.5.m1.1.1.3.2.2" xref="S4.F3.5.m1.1.1.3.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.F3.5.m1.1.1.3.2.1" xref="S4.F3.5.m1.1.1.3.2.1.cmml">​</mo><mi id="S4.F3.5.m1.1.1.3.2.3" xref="S4.F3.5.m1.1.1.3.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.F3.5.m1.1.1.3.2.1b" xref="S4.F3.5.m1.1.1.3.2.1.cmml">​</mo><mi id="S4.F3.5.m1.1.1.3.2.4" xref="S4.F3.5.m1.1.1.3.2.4.cmml">D</mi></mrow><mo id="S4.F3.5.m1.1.1.3.1" xref="S4.F3.5.m1.1.1.3.1.cmml">+</mo><mrow id="S4.F3.5.m1.1.1.3.3" xref="S4.F3.5.m1.1.1.3.3.cmml"><mi id="S4.F3.5.m1.1.1.3.3.2" xref="S4.F3.5.m1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.F3.5.m1.1.1.3.3.1" xref="S4.F3.5.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.F3.5.m1.1.1.3.3.3" xref="S4.F3.5.m1.1.1.3.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.F3.5.m1.1.1.3.3.1b" xref="S4.F3.5.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.F3.5.m1.1.1.3.3.4" xref="S4.F3.5.m1.1.1.3.3.4.cmml">D</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F3.5.m1.1c"><apply id="S4.F3.5.m1.1.1.cmml" xref="S4.F3.5.m1.1.1"><csymbol cd="ambiguous" id="S4.F3.5.m1.1.1.1.cmml" xref="S4.F3.5.m1.1.1">subscript</csymbol><ci id="S4.F3.5.m1.1.1.2.cmml" xref="S4.F3.5.m1.1.1.2">𝐿</ci><apply id="S4.F3.5.m1.1.1.3.cmml" xref="S4.F3.5.m1.1.1.3"><plus id="S4.F3.5.m1.1.1.3.1.cmml" xref="S4.F3.5.m1.1.1.3.1"></plus><apply id="S4.F3.5.m1.1.1.3.2.cmml" xref="S4.F3.5.m1.1.1.3.2"><times id="S4.F3.5.m1.1.1.3.2.1.cmml" xref="S4.F3.5.m1.1.1.3.2.1"></times><ci id="S4.F3.5.m1.1.1.3.2.2.cmml" xref="S4.F3.5.m1.1.1.3.2.2">𝐹</ci><ci id="S4.F3.5.m1.1.1.3.2.3.cmml" xref="S4.F3.5.m1.1.1.3.2.3">𝐿</ci><ci id="S4.F3.5.m1.1.1.3.2.4.cmml" xref="S4.F3.5.m1.1.1.3.2.4">𝐷</ci></apply><apply id="S4.F3.5.m1.1.1.3.3.cmml" xref="S4.F3.5.m1.1.1.3.3"><times id="S4.F3.5.m1.1.1.3.3.1.cmml" xref="S4.F3.5.m1.1.1.3.3.1"></times><ci id="S4.F3.5.m1.1.1.3.3.2.cmml" xref="S4.F3.5.m1.1.1.3.3.2">𝐹</ci><ci id="S4.F3.5.m1.1.1.3.3.3.cmml" xref="S4.F3.5.m1.1.1.3.3.3">𝐼</ci><ci id="S4.F3.5.m1.1.1.3.3.4.cmml" xref="S4.F3.5.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.m1.1d">L_{FLD+FID}</annotation></semantics></math> and b) were trained with the objective <math id="S4.F3.6.m2.1" class="ltx_Math" alttext="L_{Q-N}" display="inline"><semantics id="S4.F3.6.m2.1b"><msub id="S4.F3.6.m2.1.1" xref="S4.F3.6.m2.1.1.cmml"><mi id="S4.F3.6.m2.1.1.2" xref="S4.F3.6.m2.1.1.2.cmml">L</mi><mrow id="S4.F3.6.m2.1.1.3" xref="S4.F3.6.m2.1.1.3.cmml"><mi id="S4.F3.6.m2.1.1.3.2" xref="S4.F3.6.m2.1.1.3.2.cmml">Q</mi><mo id="S4.F3.6.m2.1.1.3.1" xref="S4.F3.6.m2.1.1.3.1.cmml">−</mo><mi id="S4.F3.6.m2.1.1.3.3" xref="S4.F3.6.m2.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F3.6.m2.1c"><apply id="S4.F3.6.m2.1.1.cmml" xref="S4.F3.6.m2.1.1"><csymbol cd="ambiguous" id="S4.F3.6.m2.1.1.1.cmml" xref="S4.F3.6.m2.1.1">subscript</csymbol><ci id="S4.F3.6.m2.1.1.2.cmml" xref="S4.F3.6.m2.1.1.2">𝐿</ci><apply id="S4.F3.6.m2.1.1.3.cmml" xref="S4.F3.6.m2.1.1.3"><minus id="S4.F3.6.m2.1.1.3.1.cmml" xref="S4.F3.6.m2.1.1.3.1"></minus><ci id="S4.F3.6.m2.1.1.3.2.cmml" xref="S4.F3.6.m2.1.1.3.2">𝑄</ci><ci id="S4.F3.6.m2.1.1.3.3.cmml" xref="S4.F3.6.m2.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.6.m2.1d">L_{Q-N}</annotation></semantics></math>, for experiments with 2 and 6 client nodes. The scores represented are Q-N score (green), AuthPct (red), FLD (pink), and <math id="S4.F3.7.m3.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S4.F3.7.m3.1b"><msub id="S4.F3.7.m3.1.1" xref="S4.F3.7.m3.1.1.cmml"><mi id="S4.F3.7.m3.1.1.2" xref="S4.F3.7.m3.1.1.2.cmml">C</mi><mi id="S4.F3.7.m3.1.1.3" xref="S4.F3.7.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F3.7.m3.1c"><apply id="S4.F3.7.m3.1.1.cmml" xref="S4.F3.7.m3.1.1"><csymbol cd="ambiguous" id="S4.F3.7.m3.1.1.1.cmml" xref="S4.F3.7.m3.1.1">subscript</csymbol><ci id="S4.F3.7.m3.1.1.2.cmml" xref="S4.F3.7.m3.1.1.2">𝐶</ci><ci id="S4.F3.7.m3.1.1.3.cmml" xref="S4.F3.7.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.7.m3.1d">C_{T}</annotation></semantics></math> (blue). Our proposed training method using <math id="S4.F3.8.m4.1" class="ltx_Math" alttext="L_{Q-N}" display="inline"><semantics id="S4.F3.8.m4.1b"><msub id="S4.F3.8.m4.1.1" xref="S4.F3.8.m4.1.1.cmml"><mi id="S4.F3.8.m4.1.1.2" xref="S4.F3.8.m4.1.1.2.cmml">L</mi><mrow id="S4.F3.8.m4.1.1.3" xref="S4.F3.8.m4.1.1.3.cmml"><mi id="S4.F3.8.m4.1.1.3.2" xref="S4.F3.8.m4.1.1.3.2.cmml">Q</mi><mo id="S4.F3.8.m4.1.1.3.1" xref="S4.F3.8.m4.1.1.3.1.cmml">−</mo><mi id="S4.F3.8.m4.1.1.3.3" xref="S4.F3.8.m4.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F3.8.m4.1c"><apply id="S4.F3.8.m4.1.1.cmml" xref="S4.F3.8.m4.1.1"><csymbol cd="ambiguous" id="S4.F3.8.m4.1.1.1.cmml" xref="S4.F3.8.m4.1.1">subscript</csymbol><ci id="S4.F3.8.m4.1.1.2.cmml" xref="S4.F3.8.m4.1.1.2">𝐿</ci><apply id="S4.F3.8.m4.1.1.3.cmml" xref="S4.F3.8.m4.1.1.3"><minus id="S4.F3.8.m4.1.1.3.1.cmml" xref="S4.F3.8.m4.1.1.3.1"></minus><ci id="S4.F3.8.m4.1.1.3.2.cmml" xref="S4.F3.8.m4.1.1.3.2">𝑄</ci><ci id="S4.F3.8.m4.1.1.3.3.cmml" xref="S4.F3.8.m4.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.8.m4.1d">L_{Q-N}</annotation></semantics></math> decreases memorization and our proposed Q-N metric is more sensitive to recognizing memorization behavior than all other metrics.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Evaluation</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Experimental Setup</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We demonstrate PDFed as deployed through a smart contract on a public Ethereum blockchain and evaluate its performance across several experiments. The chosen task is to train class-conditional DDPM <cite class="ltx_cite ltx_citemacro_citep">(Ho et al<span class="ltx_text">.</span>, <a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite> diffusion models. For this task, we utilize the CIFAR-10 dataset <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky, <a href="#bib.bib15" title="" class="ltx_ref">2009</a>)</cite>, a commonly used benchmark dataset in concurrent works <cite class="ltx_cite ltx_citemacro_citep">(Carlini et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2023</a>; Somepalli et al<span class="ltx_text">.</span>, <a href="#bib.bib21" title="" class="ltx_ref">2023</a>; Jiralerspong et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2023</a>; Tomiyama et al<span class="ltx_text">.</span>, <a href="#bib.bib24" title="" class="ltx_ref">2023</a>)</cite> and widely used in many other computer vision tasks. The dataset is divided equally into training and test sets for each client node, with training setups involving cohorts of 1 (baseline), 2, 4, 6, and 8 client nodes. An equal number of images from each class are randomly distributed among the client nodes for the private data split. The participants train each model for an equal number of epochs as each other before model submission (2 nodes: 50 epochs; 4, 6 nodes: 75 epochs; 8 nodes: 100 epochs) to ensure the models have the same degree of exposure to the data across experiments. Each node generates 1,000 images spread equally across all classes for model evaluation. All model submissions are evaluated by each client node, reporting all metrics as calculated over their privately held, local dataset split. In addition, we compute all metrics for all model submissions as evaluated on the entire CIFAR-10 dataset.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.3" class="ltx_p">We design three training setups to evaluate the performance of our proposed training framework in reducing memorization behavior in GenAI models: 1) <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="L_{FLD+FID}" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><msub id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml"><mi id="S5.SS1.p2.1.m1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.2.cmml">L</mi><mrow id="S5.SS1.p2.1.m1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.3.cmml"><mrow id="S5.SS1.p2.1.m1.1.1.3.2" xref="S5.SS1.p2.1.m1.1.1.3.2.cmml"><mi id="S5.SS1.p2.1.m1.1.1.3.2.2" xref="S5.SS1.p2.1.m1.1.1.3.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.1.m1.1.1.3.2.1" xref="S5.SS1.p2.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p2.1.m1.1.1.3.2.3" xref="S5.SS1.p2.1.m1.1.1.3.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.1.m1.1.1.3.2.1a" xref="S5.SS1.p2.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p2.1.m1.1.1.3.2.4" xref="S5.SS1.p2.1.m1.1.1.3.2.4.cmml">D</mi></mrow><mo id="S5.SS1.p2.1.m1.1.1.3.1" xref="S5.SS1.p2.1.m1.1.1.3.1.cmml">+</mo><mrow id="S5.SS1.p2.1.m1.1.1.3.3" xref="S5.SS1.p2.1.m1.1.1.3.3.cmml"><mi id="S5.SS1.p2.1.m1.1.1.3.3.2" xref="S5.SS1.p2.1.m1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.1.m1.1.1.3.3.1" xref="S5.SS1.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p2.1.m1.1.1.3.3.3" xref="S5.SS1.p2.1.m1.1.1.3.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.1.m1.1.1.3.3.1a" xref="S5.SS1.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p2.1.m1.1.1.3.3.4" xref="S5.SS1.p2.1.m1.1.1.3.3.4.cmml">D</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><apply id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2">𝐿</ci><apply id="S5.SS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3"><plus id="S5.SS1.p2.1.m1.1.1.3.1.cmml" xref="S5.SS1.p2.1.m1.1.1.3.1"></plus><apply id="S5.SS1.p2.1.m1.1.1.3.2.cmml" xref="S5.SS1.p2.1.m1.1.1.3.2"><times id="S5.SS1.p2.1.m1.1.1.3.2.1.cmml" xref="S5.SS1.p2.1.m1.1.1.3.2.1"></times><ci id="S5.SS1.p2.1.m1.1.1.3.2.2.cmml" xref="S5.SS1.p2.1.m1.1.1.3.2.2">𝐹</ci><ci id="S5.SS1.p2.1.m1.1.1.3.2.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3.2.3">𝐿</ci><ci id="S5.SS1.p2.1.m1.1.1.3.2.4.cmml" xref="S5.SS1.p2.1.m1.1.1.3.2.4">𝐷</ci></apply><apply id="S5.SS1.p2.1.m1.1.1.3.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3.3"><times id="S5.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S5.SS1.p2.1.m1.1.1.3.3.1"></times><ci id="S5.SS1.p2.1.m1.1.1.3.3.2.cmml" xref="S5.SS1.p2.1.m1.1.1.3.3.2">𝐹</ci><ci id="S5.SS1.p2.1.m1.1.1.3.3.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3.3.3">𝐼</ci><ci id="S5.SS1.p2.1.m1.1.1.3.3.4.cmml" xref="S5.SS1.p2.1.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">L_{FLD+FID}</annotation></semantics></math>, 2) <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="L_{Q-N}" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><msub id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml"><mi id="S5.SS1.p2.2.m2.1.1.2" xref="S5.SS1.p2.2.m2.1.1.2.cmml">L</mi><mrow id="S5.SS1.p2.2.m2.1.1.3" xref="S5.SS1.p2.2.m2.1.1.3.cmml"><mi id="S5.SS1.p2.2.m2.1.1.3.2" xref="S5.SS1.p2.2.m2.1.1.3.2.cmml">Q</mi><mo id="S5.SS1.p2.2.m2.1.1.3.1" xref="S5.SS1.p2.2.m2.1.1.3.1.cmml">−</mo><mi id="S5.SS1.p2.2.m2.1.1.3.3" xref="S5.SS1.p2.2.m2.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><apply id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.2.m2.1.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p2.2.m2.1.1.2.cmml" xref="S5.SS1.p2.2.m2.1.1.2">𝐿</ci><apply id="S5.SS1.p2.2.m2.1.1.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3"><minus id="S5.SS1.p2.2.m2.1.1.3.1.cmml" xref="S5.SS1.p2.2.m2.1.1.3.1"></minus><ci id="S5.SS1.p2.2.m2.1.1.3.2.cmml" xref="S5.SS1.p2.2.m2.1.1.3.2">𝑄</ci><ci id="S5.SS1.p2.2.m2.1.1.3.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">L_{Q-N}</annotation></semantics></math> and 3) <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="L_{Q-N+dedup}" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><msub id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml"><mi id="S5.SS1.p2.3.m3.1.1.2" xref="S5.SS1.p2.3.m3.1.1.2.cmml">L</mi><mrow id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml"><mrow id="S5.SS1.p2.3.m3.1.1.3.2" xref="S5.SS1.p2.3.m3.1.1.3.2.cmml"><mi id="S5.SS1.p2.3.m3.1.1.3.2.2" xref="S5.SS1.p2.3.m3.1.1.3.2.2.cmml">Q</mi><mo id="S5.SS1.p2.3.m3.1.1.3.2.1" xref="S5.SS1.p2.3.m3.1.1.3.2.1.cmml">−</mo><mi id="S5.SS1.p2.3.m3.1.1.3.2.3" xref="S5.SS1.p2.3.m3.1.1.3.2.3.cmml">N</mi></mrow><mo id="S5.SS1.p2.3.m3.1.1.3.1" xref="S5.SS1.p2.3.m3.1.1.3.1.cmml">+</mo><mrow id="S5.SS1.p2.3.m3.1.1.3.3" xref="S5.SS1.p2.3.m3.1.1.3.3.cmml"><mi id="S5.SS1.p2.3.m3.1.1.3.3.2" xref="S5.SS1.p2.3.m3.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.3.m3.1.1.3.3.1" xref="S5.SS1.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p2.3.m3.1.1.3.3.3" xref="S5.SS1.p2.3.m3.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.3.m3.1.1.3.3.1a" xref="S5.SS1.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p2.3.m3.1.1.3.3.4" xref="S5.SS1.p2.3.m3.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.3.m3.1.1.3.3.1b" xref="S5.SS1.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p2.3.m3.1.1.3.3.5" xref="S5.SS1.p2.3.m3.1.1.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.3.m3.1.1.3.3.1c" xref="S5.SS1.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p2.3.m3.1.1.3.3.6" xref="S5.SS1.p2.3.m3.1.1.3.3.6.cmml">p</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2">𝐿</ci><apply id="S5.SS1.p2.3.m3.1.1.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3"><plus id="S5.SS1.p2.3.m3.1.1.3.1.cmml" xref="S5.SS1.p2.3.m3.1.1.3.1"></plus><apply id="S5.SS1.p2.3.m3.1.1.3.2.cmml" xref="S5.SS1.p2.3.m3.1.1.3.2"><minus id="S5.SS1.p2.3.m3.1.1.3.2.1.cmml" xref="S5.SS1.p2.3.m3.1.1.3.2.1"></minus><ci id="S5.SS1.p2.3.m3.1.1.3.2.2.cmml" xref="S5.SS1.p2.3.m3.1.1.3.2.2">𝑄</ci><ci id="S5.SS1.p2.3.m3.1.1.3.2.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3.2.3">𝑁</ci></apply><apply id="S5.SS1.p2.3.m3.1.1.3.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3.3"><times id="S5.SS1.p2.3.m3.1.1.3.3.1.cmml" xref="S5.SS1.p2.3.m3.1.1.3.3.1"></times><ci id="S5.SS1.p2.3.m3.1.1.3.3.2.cmml" xref="S5.SS1.p2.3.m3.1.1.3.3.2">𝑑</ci><ci id="S5.SS1.p2.3.m3.1.1.3.3.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3.3.3">𝑒</ci><ci id="S5.SS1.p2.3.m3.1.1.3.3.4.cmml" xref="S5.SS1.p2.3.m3.1.1.3.3.4">𝑑</ci><ci id="S5.SS1.p2.3.m3.1.1.3.3.5.cmml" xref="S5.SS1.p2.3.m3.1.1.3.3.5">𝑢</ci><ci id="S5.SS1.p2.3.m3.1.1.3.3.6.cmml" xref="S5.SS1.p2.3.m3.1.1.3.3.6">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">L_{Q-N+dedup}</annotation></semantics></math>.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">In the first training setup, referred to as <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="L_{FLD+FID}" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><msub id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml"><mi id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2.cmml">L</mi><mrow id="S5.SS1.p3.1.m1.1.1.3" xref="S5.SS1.p3.1.m1.1.1.3.cmml"><mrow id="S5.SS1.p3.1.m1.1.1.3.2" xref="S5.SS1.p3.1.m1.1.1.3.2.cmml"><mi id="S5.SS1.p3.1.m1.1.1.3.2.2" xref="S5.SS1.p3.1.m1.1.1.3.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.1.m1.1.1.3.2.1" xref="S5.SS1.p3.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.1.m1.1.1.3.2.3" xref="S5.SS1.p3.1.m1.1.1.3.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.1.m1.1.1.3.2.1a" xref="S5.SS1.p3.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S5.SS1.p3.1.m1.1.1.3.2.4" xref="S5.SS1.p3.1.m1.1.1.3.2.4.cmml">D</mi></mrow><mo id="S5.SS1.p3.1.m1.1.1.3.1" xref="S5.SS1.p3.1.m1.1.1.3.1.cmml">+</mo><mrow id="S5.SS1.p3.1.m1.1.1.3.3" xref="S5.SS1.p3.1.m1.1.1.3.3.cmml"><mi id="S5.SS1.p3.1.m1.1.1.3.3.2" xref="S5.SS1.p3.1.m1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.1.m1.1.1.3.3.1" xref="S5.SS1.p3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p3.1.m1.1.1.3.3.3" xref="S5.SS1.p3.1.m1.1.1.3.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p3.1.m1.1.1.3.3.1a" xref="S5.SS1.p3.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p3.1.m1.1.1.3.3.4" xref="S5.SS1.p3.1.m1.1.1.3.3.4.cmml">D</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p3.1.m1.1.1.2.cmml" xref="S5.SS1.p3.1.m1.1.1.2">𝐿</ci><apply id="S5.SS1.p3.1.m1.1.1.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3"><plus id="S5.SS1.p3.1.m1.1.1.3.1.cmml" xref="S5.SS1.p3.1.m1.1.1.3.1"></plus><apply id="S5.SS1.p3.1.m1.1.1.3.2.cmml" xref="S5.SS1.p3.1.m1.1.1.3.2"><times id="S5.SS1.p3.1.m1.1.1.3.2.1.cmml" xref="S5.SS1.p3.1.m1.1.1.3.2.1"></times><ci id="S5.SS1.p3.1.m1.1.1.3.2.2.cmml" xref="S5.SS1.p3.1.m1.1.1.3.2.2">𝐹</ci><ci id="S5.SS1.p3.1.m1.1.1.3.2.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3.2.3">𝐿</ci><ci id="S5.SS1.p3.1.m1.1.1.3.2.4.cmml" xref="S5.SS1.p3.1.m1.1.1.3.2.4">𝐷</ci></apply><apply id="S5.SS1.p3.1.m1.1.1.3.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3"><times id="S5.SS1.p3.1.m1.1.1.3.3.1.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.1"></times><ci id="S5.SS1.p3.1.m1.1.1.3.3.2.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.2">𝐹</ci><ci id="S5.SS1.p3.1.m1.1.1.3.3.3.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.3">𝐼</ci><ci id="S5.SS1.p3.1.m1.1.1.3.3.4.cmml" xref="S5.SS1.p3.1.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">L_{FLD+FID}</annotation></semantics></math>, the loss function used by the participants when evaluating and selecting the top-performing model for further training consists of a blended FID and FLD score<cite class="ltx_cite ltx_citemacro_citep">(Jiralerspong et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2023</a>)</cite>, as given by:</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<table id="S5.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E7.m1.2" class="ltx_Math" alttext="\text{$L_{FLD+FID}$}=\frac{{\text{FID}+(\text{FLD}\times 100)}}{2}" display="block"><semantics id="S5.E7.m1.2a"><mrow id="S5.E7.m1.2.3" xref="S5.E7.m1.2.3.cmml"><msub id="S5.E7.m1.1.1.1" xref="S5.E7.m1.1.1.1.cmml"><mi id="S5.E7.m1.1.1.1.3" xref="S5.E7.m1.1.1.1.3.cmml">L</mi><mrow id="S5.E7.m1.1.1.1.4" xref="S5.E7.m1.1.1.1.4.cmml"><mrow id="S5.E7.m1.1.1.1.4.2" xref="S5.E7.m1.1.1.1.4.2.cmml"><mi id="S5.E7.m1.1.1.1.4.2.2" xref="S5.E7.m1.1.1.1.4.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.1.1.1.4.2.1" xref="S5.E7.m1.1.1.1.4.2.1.cmml">​</mo><mi id="S5.E7.m1.1.1.1.4.2.3" xref="S5.E7.m1.1.1.1.4.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.1.1.1.4.2.1a" xref="S5.E7.m1.1.1.1.4.2.1.cmml">​</mo><mi id="S5.E7.m1.1.1.1.4.2.4" xref="S5.E7.m1.1.1.1.4.2.4.cmml">D</mi></mrow><mo id="S5.E7.m1.1.1.1.4.1" xref="S5.E7.m1.1.1.1.4.1.cmml">+</mo><mrow id="S5.E7.m1.1.1.1.4.3" xref="S5.E7.m1.1.1.1.4.3.cmml"><mi id="S5.E7.m1.1.1.1.4.3.2" xref="S5.E7.m1.1.1.1.4.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.1.1.1.4.3.1" xref="S5.E7.m1.1.1.1.4.3.1.cmml">​</mo><mi id="S5.E7.m1.1.1.1.4.3.3" xref="S5.E7.m1.1.1.1.4.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S5.E7.m1.1.1.1.4.3.1a" xref="S5.E7.m1.1.1.1.4.3.1.cmml">​</mo><mi id="S5.E7.m1.1.1.1.4.3.4" xref="S5.E7.m1.1.1.1.4.3.4.cmml">D</mi></mrow></mrow></msub><mo id="S5.E7.m1.2.3.1" xref="S5.E7.m1.2.3.1.cmml">=</mo><mfrac id="S5.E7.m1.2.2" xref="S5.E7.m1.2.2.cmml"><mrow id="S5.E7.m1.2.2.1" xref="S5.E7.m1.2.2.1.cmml"><mtext id="S5.E7.m1.2.2.1.3" xref="S5.E7.m1.2.2.1.3a.cmml">FID</mtext><mo id="S5.E7.m1.2.2.1.2" xref="S5.E7.m1.2.2.1.2.cmml">+</mo><mrow id="S5.E7.m1.2.2.1.1.1" xref="S5.E7.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S5.E7.m1.2.2.1.1.1.2" xref="S5.E7.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S5.E7.m1.2.2.1.1.1.1" xref="S5.E7.m1.2.2.1.1.1.1.cmml"><mtext id="S5.E7.m1.2.2.1.1.1.1.2" xref="S5.E7.m1.2.2.1.1.1.1.2a.cmml">FLD</mtext><mo lspace="0.222em" rspace="0.222em" id="S5.E7.m1.2.2.1.1.1.1.1" xref="S5.E7.m1.2.2.1.1.1.1.1.cmml">×</mo><mn id="S5.E7.m1.2.2.1.1.1.1.3" xref="S5.E7.m1.2.2.1.1.1.1.3.cmml">100</mn></mrow><mo stretchy="false" id="S5.E7.m1.2.2.1.1.1.3" xref="S5.E7.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mn id="S5.E7.m1.2.2.3" xref="S5.E7.m1.2.2.3.cmml">2</mn></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.E7.m1.2b"><apply id="S5.E7.m1.2.3.cmml" xref="S5.E7.m1.2.3"><eq id="S5.E7.m1.2.3.1.cmml" xref="S5.E7.m1.2.3.1"></eq><apply id="S5.E7.m1.1.1.1.cmml" xref="S5.E7.m1.1.1.1"><csymbol cd="ambiguous" id="S5.E7.m1.1.1.1.2.cmml" xref="S5.E7.m1.1.1.1">subscript</csymbol><ci id="S5.E7.m1.1.1.1.3.cmml" xref="S5.E7.m1.1.1.1.3">𝐿</ci><apply id="S5.E7.m1.1.1.1.4.cmml" xref="S5.E7.m1.1.1.1.4"><plus id="S5.E7.m1.1.1.1.4.1.cmml" xref="S5.E7.m1.1.1.1.4.1"></plus><apply id="S5.E7.m1.1.1.1.4.2.cmml" xref="S5.E7.m1.1.1.1.4.2"><times id="S5.E7.m1.1.1.1.4.2.1.cmml" xref="S5.E7.m1.1.1.1.4.2.1"></times><ci id="S5.E7.m1.1.1.1.4.2.2.cmml" xref="S5.E7.m1.1.1.1.4.2.2">𝐹</ci><ci id="S5.E7.m1.1.1.1.4.2.3.cmml" xref="S5.E7.m1.1.1.1.4.2.3">𝐿</ci><ci id="S5.E7.m1.1.1.1.4.2.4.cmml" xref="S5.E7.m1.1.1.1.4.2.4">𝐷</ci></apply><apply id="S5.E7.m1.1.1.1.4.3.cmml" xref="S5.E7.m1.1.1.1.4.3"><times id="S5.E7.m1.1.1.1.4.3.1.cmml" xref="S5.E7.m1.1.1.1.4.3.1"></times><ci id="S5.E7.m1.1.1.1.4.3.2.cmml" xref="S5.E7.m1.1.1.1.4.3.2">𝐹</ci><ci id="S5.E7.m1.1.1.1.4.3.3.cmml" xref="S5.E7.m1.1.1.1.4.3.3">𝐼</ci><ci id="S5.E7.m1.1.1.1.4.3.4.cmml" xref="S5.E7.m1.1.1.1.4.3.4">𝐷</ci></apply></apply></apply><apply id="S5.E7.m1.2.2.cmml" xref="S5.E7.m1.2.2"><divide id="S5.E7.m1.2.2.2.cmml" xref="S5.E7.m1.2.2"></divide><apply id="S5.E7.m1.2.2.1.cmml" xref="S5.E7.m1.2.2.1"><plus id="S5.E7.m1.2.2.1.2.cmml" xref="S5.E7.m1.2.2.1.2"></plus><ci id="S5.E7.m1.2.2.1.3a.cmml" xref="S5.E7.m1.2.2.1.3"><mtext id="S5.E7.m1.2.2.1.3.cmml" xref="S5.E7.m1.2.2.1.3">FID</mtext></ci><apply id="S5.E7.m1.2.2.1.1.1.1.cmml" xref="S5.E7.m1.2.2.1.1.1"><times id="S5.E7.m1.2.2.1.1.1.1.1.cmml" xref="S5.E7.m1.2.2.1.1.1.1.1"></times><ci id="S5.E7.m1.2.2.1.1.1.1.2a.cmml" xref="S5.E7.m1.2.2.1.1.1.1.2"><mtext id="S5.E7.m1.2.2.1.1.1.1.2.cmml" xref="S5.E7.m1.2.2.1.1.1.1.2">FLD</mtext></ci><cn type="integer" id="S5.E7.m1.2.2.1.1.1.1.3.cmml" xref="S5.E7.m1.2.2.1.1.1.1.3">100</cn></apply></apply><cn type="integer" id="S5.E7.m1.2.2.3.cmml" xref="S5.E7.m1.2.2.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E7.m1.2c">\text{$L_{FLD+FID}$}=\frac{{\text{FID}+(\text{FLD}\times 100)}}{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<figure id="S5.T1" class="ltx_table">
<div id="S5.T1.18" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:72.2pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-110.9pt,18.3pt) scale(0.661677346480518,0.661677346480518) ;">
<table id="S5.T1.18.18" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.3.3.3" class="ltx_tr">
<th id="S5.T1.3.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" rowspan="2"><span id="S5.T1.3.3.3.4.1" class="ltx_text ltx_font_bold">#</span></th>
<td id="S5.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="5">
<span id="S5.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Training run with</span> <math id="S5.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{L_{FLD+FID}}" display="inline"><semantics id="S5.T1.1.1.1.1.m1.1a"><msub id="S5.T1.1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.1.m1.1.1.cmml"><mi id="S5.T1.1.1.1.1.m1.1.1.2" xref="S5.T1.1.1.1.1.m1.1.1.2.cmml">𝐋</mi><mrow id="S5.T1.1.1.1.1.m1.1.1.3" xref="S5.T1.1.1.1.1.m1.1.1.3.cmml"><mi id="S5.T1.1.1.1.1.m1.1.1.3.2" xref="S5.T1.1.1.1.1.m1.1.1.3.2.cmml">𝐅𝐋𝐃</mi><mo id="S5.T1.1.1.1.1.m1.1.1.3.1" xref="S5.T1.1.1.1.1.m1.1.1.3.1.cmml">+</mo><mi id="S5.T1.1.1.1.1.m1.1.1.3.3" xref="S5.T1.1.1.1.1.m1.1.1.3.3.cmml">𝐅𝐈𝐃</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.1.m1.1b"><apply id="S5.T1.1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.1.1.1.1.m1.1.1.1.cmml" xref="S5.T1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S5.T1.1.1.1.1.m1.1.1.2.cmml" xref="S5.T1.1.1.1.1.m1.1.1.2">𝐋</ci><apply id="S5.T1.1.1.1.1.m1.1.1.3.cmml" xref="S5.T1.1.1.1.1.m1.1.1.3"><plus id="S5.T1.1.1.1.1.m1.1.1.3.1.cmml" xref="S5.T1.1.1.1.1.m1.1.1.3.1"></plus><ci id="S5.T1.1.1.1.1.m1.1.1.3.2.cmml" xref="S5.T1.1.1.1.1.m1.1.1.3.2">𝐅𝐋𝐃</ci><ci id="S5.T1.1.1.1.1.m1.1.1.3.3.cmml" xref="S5.T1.1.1.1.1.m1.1.1.3.3">𝐅𝐈𝐃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.1.m1.1c">\mathbf{L_{FLD+FID}}</annotation></semantics></math>
</td>
<td id="S5.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="5">
<span id="S5.T1.2.2.2.2.1" class="ltx_text ltx_font_bold">Training run with</span> <math id="S5.T1.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathbf{L_{Q-N}}" display="inline"><semantics id="S5.T1.2.2.2.2.m1.1a"><msub id="S5.T1.2.2.2.2.m1.1.1" xref="S5.T1.2.2.2.2.m1.1.1.cmml"><mi id="S5.T1.2.2.2.2.m1.1.1.2" xref="S5.T1.2.2.2.2.m1.1.1.2.cmml">𝐋</mi><mrow id="S5.T1.2.2.2.2.m1.1.1.3" xref="S5.T1.2.2.2.2.m1.1.1.3.cmml"><mi id="S5.T1.2.2.2.2.m1.1.1.3.2" xref="S5.T1.2.2.2.2.m1.1.1.3.2.cmml">𝐐</mi><mo id="S5.T1.2.2.2.2.m1.1.1.3.1" xref="S5.T1.2.2.2.2.m1.1.1.3.1.cmml">−</mo><mi id="S5.T1.2.2.2.2.m1.1.1.3.3" xref="S5.T1.2.2.2.2.m1.1.1.3.3.cmml">𝐍</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.2.m1.1b"><apply id="S5.T1.2.2.2.2.m1.1.1.cmml" xref="S5.T1.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.2.2.2.2.m1.1.1.1.cmml" xref="S5.T1.2.2.2.2.m1.1.1">subscript</csymbol><ci id="S5.T1.2.2.2.2.m1.1.1.2.cmml" xref="S5.T1.2.2.2.2.m1.1.1.2">𝐋</ci><apply id="S5.T1.2.2.2.2.m1.1.1.3.cmml" xref="S5.T1.2.2.2.2.m1.1.1.3"><minus id="S5.T1.2.2.2.2.m1.1.1.3.1.cmml" xref="S5.T1.2.2.2.2.m1.1.1.3.1"></minus><ci id="S5.T1.2.2.2.2.m1.1.1.3.2.cmml" xref="S5.T1.2.2.2.2.m1.1.1.3.2">𝐐</ci><ci id="S5.T1.2.2.2.2.m1.1.1.3.3.cmml" xref="S5.T1.2.2.2.2.m1.1.1.3.3">𝐍</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.2.m1.1c">\mathbf{L_{Q-N}}</annotation></semantics></math>
</td>
<td id="S5.T1.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="5">
<span id="S5.T1.3.3.3.3.1" class="ltx_text ltx_font_bold">Training run with</span> <math id="S5.T1.3.3.3.3.m1.1" class="ltx_Math" alttext="\mathbf{L_{Q-N+dedup}}" display="inline"><semantics id="S5.T1.3.3.3.3.m1.1a"><msub id="S5.T1.3.3.3.3.m1.1.1" xref="S5.T1.3.3.3.3.m1.1.1.cmml"><mi id="S5.T1.3.3.3.3.m1.1.1.2" xref="S5.T1.3.3.3.3.m1.1.1.2.cmml">𝐋</mi><mrow id="S5.T1.3.3.3.3.m1.1.1.3" xref="S5.T1.3.3.3.3.m1.1.1.3.cmml"><mrow id="S5.T1.3.3.3.3.m1.1.1.3.2" xref="S5.T1.3.3.3.3.m1.1.1.3.2.cmml"><mi id="S5.T1.3.3.3.3.m1.1.1.3.2.2" xref="S5.T1.3.3.3.3.m1.1.1.3.2.2.cmml">𝐐</mi><mo id="S5.T1.3.3.3.3.m1.1.1.3.2.1" xref="S5.T1.3.3.3.3.m1.1.1.3.2.1.cmml">−</mo><mi id="S5.T1.3.3.3.3.m1.1.1.3.2.3" xref="S5.T1.3.3.3.3.m1.1.1.3.2.3.cmml">𝐍</mi></mrow><mo id="S5.T1.3.3.3.3.m1.1.1.3.1" xref="S5.T1.3.3.3.3.m1.1.1.3.1.cmml">+</mo><mi id="S5.T1.3.3.3.3.m1.1.1.3.3" xref="S5.T1.3.3.3.3.m1.1.1.3.3.cmml">𝐝𝐞𝐝𝐮𝐩</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T1.3.3.3.3.m1.1b"><apply id="S5.T1.3.3.3.3.m1.1.1.cmml" xref="S5.T1.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T1.3.3.3.3.m1.1.1.1.cmml" xref="S5.T1.3.3.3.3.m1.1.1">subscript</csymbol><ci id="S5.T1.3.3.3.3.m1.1.1.2.cmml" xref="S5.T1.3.3.3.3.m1.1.1.2">𝐋</ci><apply id="S5.T1.3.3.3.3.m1.1.1.3.cmml" xref="S5.T1.3.3.3.3.m1.1.1.3"><plus id="S5.T1.3.3.3.3.m1.1.1.3.1.cmml" xref="S5.T1.3.3.3.3.m1.1.1.3.1"></plus><apply id="S5.T1.3.3.3.3.m1.1.1.3.2.cmml" xref="S5.T1.3.3.3.3.m1.1.1.3.2"><minus id="S5.T1.3.3.3.3.m1.1.1.3.2.1.cmml" xref="S5.T1.3.3.3.3.m1.1.1.3.2.1"></minus><ci id="S5.T1.3.3.3.3.m1.1.1.3.2.2.cmml" xref="S5.T1.3.3.3.3.m1.1.1.3.2.2">𝐐</ci><ci id="S5.T1.3.3.3.3.m1.1.1.3.2.3.cmml" xref="S5.T1.3.3.3.3.m1.1.1.3.2.3">𝐍</ci></apply><ci id="S5.T1.3.3.3.3.m1.1.1.3.3.cmml" xref="S5.T1.3.3.3.3.m1.1.1.3.3">𝐝𝐞𝐝𝐮𝐩</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.3.3.3.m1.1c">\mathbf{L_{Q-N+dedup}}</annotation></semantics></math>
</td>
</tr>
<tr id="S5.T1.18.18.18" class="ltx_tr">
<td id="S5.T1.4.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.4.4.4.1.1" class="ltx_text ltx_font_bold">AuthPct<math id="S5.T1.4.4.4.1.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.4.4.4.1.1.m1.1a"><mo stretchy="false" id="S5.T1.4.4.4.1.1.m1.1.1" xref="S5.T1.4.4.4.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.4.4.4.1.1.m1.1b"><ci id="S5.T1.4.4.4.1.1.m1.1.1.cmml" xref="S5.T1.4.4.4.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.4.4.1.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
<td id="S5.T1.5.5.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S5.T1.5.5.5.2.m1.1" class="ltx_Math" alttext="\mathbf{C_{T}}\uparrow" display="inline"><semantics id="S5.T1.5.5.5.2.m1.1a"><mrow id="S5.T1.5.5.5.2.m1.1.1" xref="S5.T1.5.5.5.2.m1.1.1.cmml"><msub id="S5.T1.5.5.5.2.m1.1.1.2" xref="S5.T1.5.5.5.2.m1.1.1.2.cmml"><mi id="S5.T1.5.5.5.2.m1.1.1.2.2" xref="S5.T1.5.5.5.2.m1.1.1.2.2.cmml">𝐂</mi><mi id="S5.T1.5.5.5.2.m1.1.1.2.3" xref="S5.T1.5.5.5.2.m1.1.1.2.3.cmml">𝐓</mi></msub><mo stretchy="false" id="S5.T1.5.5.5.2.m1.1.1.1" xref="S5.T1.5.5.5.2.m1.1.1.1.cmml">↑</mo><mi id="S5.T1.5.5.5.2.m1.1.1.3" xref="S5.T1.5.5.5.2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.5.5.5.2.m1.1b"><apply id="S5.T1.5.5.5.2.m1.1.1.cmml" xref="S5.T1.5.5.5.2.m1.1.1"><ci id="S5.T1.5.5.5.2.m1.1.1.1.cmml" xref="S5.T1.5.5.5.2.m1.1.1.1">↑</ci><apply id="S5.T1.5.5.5.2.m1.1.1.2.cmml" xref="S5.T1.5.5.5.2.m1.1.1.2"><csymbol cd="ambiguous" id="S5.T1.5.5.5.2.m1.1.1.2.1.cmml" xref="S5.T1.5.5.5.2.m1.1.1.2">subscript</csymbol><ci id="S5.T1.5.5.5.2.m1.1.1.2.2.cmml" xref="S5.T1.5.5.5.2.m1.1.1.2.2">𝐂</ci><ci id="S5.T1.5.5.5.2.m1.1.1.2.3.cmml" xref="S5.T1.5.5.5.2.m1.1.1.2.3">𝐓</ci></apply><csymbol cd="latexml" id="S5.T1.5.5.5.2.m1.1.1.3.cmml" xref="S5.T1.5.5.5.2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.5.5.2.m1.1c">\mathbf{C_{T}}\uparrow</annotation></semantics></math></td>
<td id="S5.T1.6.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.6.6.6.3.1" class="ltx_text ltx_font_bold">FLD<math id="S5.T1.6.6.6.3.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.6.6.6.3.1.m1.1a"><mo stretchy="false" id="S5.T1.6.6.6.3.1.m1.1.1" xref="S5.T1.6.6.6.3.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.6.6.6.3.1.m1.1b"><ci id="S5.T1.6.6.6.3.1.m1.1.1.cmml" xref="S5.T1.6.6.6.3.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.6.6.3.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S5.T1.7.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.7.7.7.4.1" class="ltx_text ltx_font_bold">FID<math id="S5.T1.7.7.7.4.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.7.7.7.4.1.m1.1a"><mo stretchy="false" id="S5.T1.7.7.7.4.1.m1.1.1" xref="S5.T1.7.7.7.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.7.7.7.4.1.m1.1b"><ci id="S5.T1.7.7.7.4.1.m1.1.1.cmml" xref="S5.T1.7.7.7.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.7.7.7.4.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S5.T1.8.8.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.8.8.8.5.1" class="ltx_text ltx_font_bold">Q-N* <math id="S5.T1.8.8.8.5.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.8.8.8.5.1.m1.1a"><mo stretchy="false" id="S5.T1.8.8.8.5.1.m1.1.1" xref="S5.T1.8.8.8.5.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.8.8.8.5.1.m1.1b"><ci id="S5.T1.8.8.8.5.1.m1.1.1.cmml" xref="S5.T1.8.8.8.5.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.8.8.8.5.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S5.T1.9.9.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.9.9.9.6.1" class="ltx_text ltx_font_bold">AuthPct<math id="S5.T1.9.9.9.6.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.9.9.9.6.1.m1.1a"><mo stretchy="false" id="S5.T1.9.9.9.6.1.m1.1.1" xref="S5.T1.9.9.9.6.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.9.9.9.6.1.m1.1b"><ci id="S5.T1.9.9.9.6.1.m1.1.1.cmml" xref="S5.T1.9.9.9.6.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.9.9.9.6.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
<td id="S5.T1.10.10.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S5.T1.10.10.10.7.m1.1" class="ltx_Math" alttext="\mathbf{C_{T}}\uparrow" display="inline"><semantics id="S5.T1.10.10.10.7.m1.1a"><mrow id="S5.T1.10.10.10.7.m1.1.1" xref="S5.T1.10.10.10.7.m1.1.1.cmml"><msub id="S5.T1.10.10.10.7.m1.1.1.2" xref="S5.T1.10.10.10.7.m1.1.1.2.cmml"><mi id="S5.T1.10.10.10.7.m1.1.1.2.2" xref="S5.T1.10.10.10.7.m1.1.1.2.2.cmml">𝐂</mi><mi id="S5.T1.10.10.10.7.m1.1.1.2.3" xref="S5.T1.10.10.10.7.m1.1.1.2.3.cmml">𝐓</mi></msub><mo stretchy="false" id="S5.T1.10.10.10.7.m1.1.1.1" xref="S5.T1.10.10.10.7.m1.1.1.1.cmml">↑</mo><mi id="S5.T1.10.10.10.7.m1.1.1.3" xref="S5.T1.10.10.10.7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.10.10.10.7.m1.1b"><apply id="S5.T1.10.10.10.7.m1.1.1.cmml" xref="S5.T1.10.10.10.7.m1.1.1"><ci id="S5.T1.10.10.10.7.m1.1.1.1.cmml" xref="S5.T1.10.10.10.7.m1.1.1.1">↑</ci><apply id="S5.T1.10.10.10.7.m1.1.1.2.cmml" xref="S5.T1.10.10.10.7.m1.1.1.2"><csymbol cd="ambiguous" id="S5.T1.10.10.10.7.m1.1.1.2.1.cmml" xref="S5.T1.10.10.10.7.m1.1.1.2">subscript</csymbol><ci id="S5.T1.10.10.10.7.m1.1.1.2.2.cmml" xref="S5.T1.10.10.10.7.m1.1.1.2.2">𝐂</ci><ci id="S5.T1.10.10.10.7.m1.1.1.2.3.cmml" xref="S5.T1.10.10.10.7.m1.1.1.2.3">𝐓</ci></apply><csymbol cd="latexml" id="S5.T1.10.10.10.7.m1.1.1.3.cmml" xref="S5.T1.10.10.10.7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.10.10.10.7.m1.1c">\mathbf{C_{T}}\uparrow</annotation></semantics></math></td>
<td id="S5.T1.11.11.11.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.11.11.11.8.1" class="ltx_text ltx_font_bold">FLD<math id="S5.T1.11.11.11.8.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.11.11.11.8.1.m1.1a"><mo stretchy="false" id="S5.T1.11.11.11.8.1.m1.1.1" xref="S5.T1.11.11.11.8.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.11.11.11.8.1.m1.1b"><ci id="S5.T1.11.11.11.8.1.m1.1.1.cmml" xref="S5.T1.11.11.11.8.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.11.11.11.8.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S5.T1.12.12.12.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.12.12.12.9.1" class="ltx_text ltx_font_bold">FID<math id="S5.T1.12.12.12.9.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.12.12.12.9.1.m1.1a"><mo stretchy="false" id="S5.T1.12.12.12.9.1.m1.1.1" xref="S5.T1.12.12.12.9.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.12.12.12.9.1.m1.1b"><ci id="S5.T1.12.12.12.9.1.m1.1.1.cmml" xref="S5.T1.12.12.12.9.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.12.12.12.9.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S5.T1.13.13.13.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.13.13.13.10.1" class="ltx_text ltx_font_bold">Q-N* <math id="S5.T1.13.13.13.10.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.13.13.13.10.1.m1.1a"><mo stretchy="false" id="S5.T1.13.13.13.10.1.m1.1.1" xref="S5.T1.13.13.13.10.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.13.13.13.10.1.m1.1b"><ci id="S5.T1.13.13.13.10.1.m1.1.1.cmml" xref="S5.T1.13.13.13.10.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.13.13.13.10.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S5.T1.14.14.14.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.14.14.14.11.1" class="ltx_text ltx_font_bold">AuthPct<math id="S5.T1.14.14.14.11.1.m1.1" class="ltx_Math" alttext="\uparrow" display="inline"><semantics id="S5.T1.14.14.14.11.1.m1.1a"><mo stretchy="false" id="S5.T1.14.14.14.11.1.m1.1.1" xref="S5.T1.14.14.14.11.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S5.T1.14.14.14.11.1.m1.1b"><ci id="S5.T1.14.14.14.11.1.m1.1.1.cmml" xref="S5.T1.14.14.14.11.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.14.14.14.11.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
<td id="S5.T1.15.15.15.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><math id="S5.T1.15.15.15.12.m1.1" class="ltx_Math" alttext="\mathbf{C_{T}}\uparrow" display="inline"><semantics id="S5.T1.15.15.15.12.m1.1a"><mrow id="S5.T1.15.15.15.12.m1.1.1" xref="S5.T1.15.15.15.12.m1.1.1.cmml"><msub id="S5.T1.15.15.15.12.m1.1.1.2" xref="S5.T1.15.15.15.12.m1.1.1.2.cmml"><mi id="S5.T1.15.15.15.12.m1.1.1.2.2" xref="S5.T1.15.15.15.12.m1.1.1.2.2.cmml">𝐂</mi><mi id="S5.T1.15.15.15.12.m1.1.1.2.3" xref="S5.T1.15.15.15.12.m1.1.1.2.3.cmml">𝐓</mi></msub><mo stretchy="false" id="S5.T1.15.15.15.12.m1.1.1.1" xref="S5.T1.15.15.15.12.m1.1.1.1.cmml">↑</mo><mi id="S5.T1.15.15.15.12.m1.1.1.3" xref="S5.T1.15.15.15.12.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.15.15.15.12.m1.1b"><apply id="S5.T1.15.15.15.12.m1.1.1.cmml" xref="S5.T1.15.15.15.12.m1.1.1"><ci id="S5.T1.15.15.15.12.m1.1.1.1.cmml" xref="S5.T1.15.15.15.12.m1.1.1.1">↑</ci><apply id="S5.T1.15.15.15.12.m1.1.1.2.cmml" xref="S5.T1.15.15.15.12.m1.1.1.2"><csymbol cd="ambiguous" id="S5.T1.15.15.15.12.m1.1.1.2.1.cmml" xref="S5.T1.15.15.15.12.m1.1.1.2">subscript</csymbol><ci id="S5.T1.15.15.15.12.m1.1.1.2.2.cmml" xref="S5.T1.15.15.15.12.m1.1.1.2.2">𝐂</ci><ci id="S5.T1.15.15.15.12.m1.1.1.2.3.cmml" xref="S5.T1.15.15.15.12.m1.1.1.2.3">𝐓</ci></apply><csymbol cd="latexml" id="S5.T1.15.15.15.12.m1.1.1.3.cmml" xref="S5.T1.15.15.15.12.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.15.15.15.12.m1.1c">\mathbf{C_{T}}\uparrow</annotation></semantics></math></td>
<td id="S5.T1.16.16.16.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.16.16.16.13.1" class="ltx_text ltx_font_bold">FLD<math id="S5.T1.16.16.16.13.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.16.16.16.13.1.m1.1a"><mo stretchy="false" id="S5.T1.16.16.16.13.1.m1.1.1" xref="S5.T1.16.16.16.13.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.16.16.16.13.1.m1.1b"><ci id="S5.T1.16.16.16.13.1.m1.1.1.cmml" xref="S5.T1.16.16.16.13.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.16.16.16.13.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S5.T1.17.17.17.14" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.17.17.17.14.1" class="ltx_text ltx_font_bold">FID<math id="S5.T1.17.17.17.14.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.17.17.17.14.1.m1.1a"><mo stretchy="false" id="S5.T1.17.17.17.14.1.m1.1.1" xref="S5.T1.17.17.17.14.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.17.17.17.14.1.m1.1b"><ci id="S5.T1.17.17.17.14.1.m1.1.1.cmml" xref="S5.T1.17.17.17.14.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.17.17.17.14.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S5.T1.18.18.18.15" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T1.18.18.18.15.1" class="ltx_text ltx_font_bold">Q-N* <math id="S5.T1.18.18.18.15.1.m1.1" class="ltx_Math" alttext="\downarrow" display="inline"><semantics id="S5.T1.18.18.18.15.1.m1.1a"><mo stretchy="false" id="S5.T1.18.18.18.15.1.m1.1.1" xref="S5.T1.18.18.18.15.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S5.T1.18.18.18.15.1.m1.1b"><ci id="S5.T1.18.18.18.15.1.m1.1.1.cmml" xref="S5.T1.18.18.18.15.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.18.18.18.15.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
</tr>
<tr id="S5.T1.18.18.19.1" class="ltx_tr">
<th id="S5.T1.18.18.19.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">2</th>
<td id="S5.T1.18.18.19.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">30.65</td>
<td id="S5.T1.18.18.19.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.75</td>
<td id="S5.T1.18.18.19.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6.26</td>
<td id="S5.T1.18.18.19.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">624.22</td>
<td id="S5.T1.18.18.19.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.721</td>
<td id="S5.T1.18.18.19.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">30.09</td>
<td id="S5.T1.18.18.19.1.8" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">12.19</td>
<td id="S5.T1.18.18.19.1.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">6.43</td>
<td id="S5.T1.18.18.19.1.10" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">640.68</td>
<td id="S5.T1.18.18.19.1.11" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.730</td>
<td id="S5.T1.18.18.19.1.12" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">30.76</td>
<td id="S5.T1.18.18.19.1.13" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">11.55</td>
<td id="S5.T1.18.18.19.1.14" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">7.13</td>
<td id="S5.T1.18.18.19.1.15" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">692.01</td>
<td id="S5.T1.18.18.19.1.16" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.643</td>
</tr>
<tr id="S5.T1.18.18.20.2" class="ltx_tr">
<th id="S5.T1.18.18.20.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">4</th>
<td id="S5.T1.18.18.20.2.2" class="ltx_td ltx_align_center ltx_border_r">29.07</td>
<td id="S5.T1.18.18.20.2.3" class="ltx_td ltx_align_center ltx_border_r">12.25</td>
<td id="S5.T1.18.18.20.2.4" class="ltx_td ltx_align_center ltx_border_r">8.47</td>
<td id="S5.T1.18.18.20.2.5" class="ltx_td ltx_align_center ltx_border_r">750.02</td>
<td id="S5.T1.18.18.20.2.6" class="ltx_td ltx_align_center ltx_border_r">2.364</td>
<td id="S5.T1.18.18.20.2.7" class="ltx_td ltx_align_center ltx_border_r">30.36</td>
<td id="S5.T1.18.18.20.2.8" class="ltx_td ltx_align_center ltx_border_r">11.48</td>
<td id="S5.T1.18.18.20.2.9" class="ltx_td ltx_align_center ltx_border_r">7.31</td>
<td id="S5.T1.18.18.20.2.10" class="ltx_td ltx_align_center ltx_border_r">676.68</td>
<td id="S5.T1.18.18.20.2.11" class="ltx_td ltx_align_center ltx_border_r">2.053</td>
<td id="S5.T1.18.18.20.2.12" class="ltx_td ltx_align_center ltx_border_r">31.5</td>
<td id="S5.T1.18.18.20.2.13" class="ltx_td ltx_align_center ltx_border_r">12.1</td>
<td id="S5.T1.18.18.20.2.14" class="ltx_td ltx_align_center ltx_border_r">7.46</td>
<td id="S5.T1.18.18.20.2.15" class="ltx_td ltx_align_center ltx_border_r">709.85</td>
<td id="S5.T1.18.18.20.2.16" class="ltx_td ltx_align_center ltx_border_r">1.607</td>
</tr>
<tr id="S5.T1.18.18.21.3" class="ltx_tr">
<th id="S5.T1.18.18.21.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r">6</th>
<td id="S5.T1.18.18.21.3.2" class="ltx_td ltx_align_center ltx_border_r">30.82</td>
<td id="S5.T1.18.18.21.3.3" class="ltx_td ltx_align_center ltx_border_r">11.99</td>
<td id="S5.T1.18.18.21.3.4" class="ltx_td ltx_align_center ltx_border_r">7.92</td>
<td id="S5.T1.18.18.21.3.5" class="ltx_td ltx_align_center ltx_border_r">738.6</td>
<td id="S5.T1.18.18.21.3.6" class="ltx_td ltx_align_center ltx_border_r">2.043</td>
<td id="S5.T1.18.18.21.3.7" class="ltx_td ltx_align_center ltx_border_r">30.04</td>
<td id="S5.T1.18.18.21.3.8" class="ltx_td ltx_align_center ltx_border_r">12.32</td>
<td id="S5.T1.18.18.21.3.9" class="ltx_td ltx_align_center ltx_border_r">8.07</td>
<td id="S5.T1.18.18.21.3.10" class="ltx_td ltx_align_center ltx_border_r">723.56</td>
<td id="S5.T1.18.18.21.3.11" class="ltx_td ltx_align_center ltx_border_r">1.840</td>
<td id="S5.T1.18.18.21.3.12" class="ltx_td ltx_align_center ltx_border_r">30.63</td>
<td id="S5.T1.18.18.21.3.13" class="ltx_td ltx_align_center ltx_border_r">12.58</td>
<td id="S5.T1.18.18.21.3.14" class="ltx_td ltx_align_center ltx_border_r">8.08</td>
<td id="S5.T1.18.18.21.3.15" class="ltx_td ltx_align_center ltx_border_r">741.31</td>
<td id="S5.T1.18.18.21.3.16" class="ltx_td ltx_align_center ltx_border_r">1.228</td>
</tr>
<tr id="S5.T1.18.18.22.4" class="ltx_tr">
<th id="S5.T1.18.18.22.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r">8</th>
<td id="S5.T1.18.18.22.4.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">27.71</td>
<td id="S5.T1.18.18.22.4.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">11.4</td>
<td id="S5.T1.18.18.22.4.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">8.17</td>
<td id="S5.T1.18.18.22.4.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">755.02</td>
<td id="S5.T1.18.18.22.4.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">1.705</td>
<td id="S5.T1.18.18.22.4.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">29.25</td>
<td id="S5.T1.18.18.22.4.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">11.48</td>
<td id="S5.T1.18.18.22.4.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">9.08</td>
<td id="S5.T1.18.18.22.4.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">800.07</td>
<td id="S5.T1.18.18.22.4.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">1.573</td>
<td id="S5.T1.18.18.22.4.12" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">29.98</td>
<td id="S5.T1.18.18.22.4.13" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">12.37</td>
<td id="S5.T1.18.18.22.4.14" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">8.04</td>
<td id="S5.T1.18.18.22.4.15" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">725.23</td>
<td id="S5.T1.18.18.22.4.16" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">1.103</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>Comparison of training framework performance evaluated on the entire CIFAR-10 dataset by averaging the scores obtained across the 10 latest model submissions. Column # represents number of clients and * shows that the Q-N score is reported as x10<sup id="S5.T1.20.1" class="ltx_sup">-3</sup>.</figcaption>
</figure>
<div id="S5.SS1.p5" class="ltx_para">
<p id="S5.SS1.p5.2" class="ltx_p">In the second training setup, referred to as <math id="S5.SS1.p5.1.m1.1" class="ltx_Math" alttext="L_{Q-N}" display="inline"><semantics id="S5.SS1.p5.1.m1.1a"><msub id="S5.SS1.p5.1.m1.1.1" xref="S5.SS1.p5.1.m1.1.1.cmml"><mi id="S5.SS1.p5.1.m1.1.1.2" xref="S5.SS1.p5.1.m1.1.1.2.cmml">L</mi><mrow id="S5.SS1.p5.1.m1.1.1.3" xref="S5.SS1.p5.1.m1.1.1.3.cmml"><mi id="S5.SS1.p5.1.m1.1.1.3.2" xref="S5.SS1.p5.1.m1.1.1.3.2.cmml">Q</mi><mo id="S5.SS1.p5.1.m1.1.1.3.1" xref="S5.SS1.p5.1.m1.1.1.3.1.cmml">−</mo><mi id="S5.SS1.p5.1.m1.1.1.3.3" xref="S5.SS1.p5.1.m1.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.1.m1.1b"><apply id="S5.SS1.p5.1.m1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.1.m1.1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p5.1.m1.1.1.2.cmml" xref="S5.SS1.p5.1.m1.1.1.2">𝐿</ci><apply id="S5.SS1.p5.1.m1.1.1.3.cmml" xref="S5.SS1.p5.1.m1.1.1.3"><minus id="S5.SS1.p5.1.m1.1.1.3.1.cmml" xref="S5.SS1.p5.1.m1.1.1.3.1"></minus><ci id="S5.SS1.p5.1.m1.1.1.3.2.cmml" xref="S5.SS1.p5.1.m1.1.1.3.2">𝑄</ci><ci id="S5.SS1.p5.1.m1.1.1.3.3.cmml" xref="S5.SS1.p5.1.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.1.m1.1c">L_{Q-N}</annotation></semantics></math>, the loss function used to evaluate and identify the top-performing model for further training is given by our quality-novelty score in equation <a href="#S3.E6" title="In 3.3. Metric design ‣ 3. Measuring and Mitigating Memorization ‣ PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, where <math id="S5.SS1.p5.2.m2.1" class="ltx_Math" alttext="L_{Q-N}" display="inline"><semantics id="S5.SS1.p5.2.m2.1a"><msub id="S5.SS1.p5.2.m2.1.1" xref="S5.SS1.p5.2.m2.1.1.cmml"><mi id="S5.SS1.p5.2.m2.1.1.2" xref="S5.SS1.p5.2.m2.1.1.2.cmml">L</mi><mrow id="S5.SS1.p5.2.m2.1.1.3" xref="S5.SS1.p5.2.m2.1.1.3.cmml"><mi id="S5.SS1.p5.2.m2.1.1.3.2" xref="S5.SS1.p5.2.m2.1.1.3.2.cmml">Q</mi><mo id="S5.SS1.p5.2.m2.1.1.3.1" xref="S5.SS1.p5.2.m2.1.1.3.1.cmml">−</mo><mi id="S5.SS1.p5.2.m2.1.1.3.3" xref="S5.SS1.p5.2.m2.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.2.m2.1b"><apply id="S5.SS1.p5.2.m2.1.1.cmml" xref="S5.SS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS1.p5.2.m2.1.1.1.cmml" xref="S5.SS1.p5.2.m2.1.1">subscript</csymbol><ci id="S5.SS1.p5.2.m2.1.1.2.cmml" xref="S5.SS1.p5.2.m2.1.1.2">𝐿</ci><apply id="S5.SS1.p5.2.m2.1.1.3.cmml" xref="S5.SS1.p5.2.m2.1.1.3"><minus id="S5.SS1.p5.2.m2.1.1.3.1.cmml" xref="S5.SS1.p5.2.m2.1.1.3.1"></minus><ci id="S5.SS1.p5.2.m2.1.1.3.2.cmml" xref="S5.SS1.p5.2.m2.1.1.3.2">𝑄</ci><ci id="S5.SS1.p5.2.m2.1.1.3.3.cmml" xref="S5.SS1.p5.2.m2.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.2.m2.1c">L_{Q-N}</annotation></semantics></math> = Q-N score.</p>
</div>
<div id="S5.SS1.p6" class="ltx_para">
<p id="S5.SS1.p6.1" class="ltx_p">The third setup, <math id="S5.SS1.p6.1.m1.1" class="ltx_Math" alttext="L_{Q-N+dedup}" display="inline"><semantics id="S5.SS1.p6.1.m1.1a"><msub id="S5.SS1.p6.1.m1.1.1" xref="S5.SS1.p6.1.m1.1.1.cmml"><mi id="S5.SS1.p6.1.m1.1.1.2" xref="S5.SS1.p6.1.m1.1.1.2.cmml">L</mi><mrow id="S5.SS1.p6.1.m1.1.1.3" xref="S5.SS1.p6.1.m1.1.1.3.cmml"><mrow id="S5.SS1.p6.1.m1.1.1.3.2" xref="S5.SS1.p6.1.m1.1.1.3.2.cmml"><mi id="S5.SS1.p6.1.m1.1.1.3.2.2" xref="S5.SS1.p6.1.m1.1.1.3.2.2.cmml">Q</mi><mo id="S5.SS1.p6.1.m1.1.1.3.2.1" xref="S5.SS1.p6.1.m1.1.1.3.2.1.cmml">−</mo><mi id="S5.SS1.p6.1.m1.1.1.3.2.3" xref="S5.SS1.p6.1.m1.1.1.3.2.3.cmml">N</mi></mrow><mo id="S5.SS1.p6.1.m1.1.1.3.1" xref="S5.SS1.p6.1.m1.1.1.3.1.cmml">+</mo><mrow id="S5.SS1.p6.1.m1.1.1.3.3" xref="S5.SS1.p6.1.m1.1.1.3.3.cmml"><mi id="S5.SS1.p6.1.m1.1.1.3.3.2" xref="S5.SS1.p6.1.m1.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p6.1.m1.1.1.3.3.1" xref="S5.SS1.p6.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p6.1.m1.1.1.3.3.3" xref="S5.SS1.p6.1.m1.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p6.1.m1.1.1.3.3.1a" xref="S5.SS1.p6.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p6.1.m1.1.1.3.3.4" xref="S5.SS1.p6.1.m1.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p6.1.m1.1.1.3.3.1b" xref="S5.SS1.p6.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p6.1.m1.1.1.3.3.5" xref="S5.SS1.p6.1.m1.1.1.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p6.1.m1.1.1.3.3.1c" xref="S5.SS1.p6.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS1.p6.1.m1.1.1.3.3.6" xref="S5.SS1.p6.1.m1.1.1.3.3.6.cmml">p</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.1.m1.1b"><apply id="S5.SS1.p6.1.m1.1.1.cmml" xref="S5.SS1.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p6.1.m1.1.1.1.cmml" xref="S5.SS1.p6.1.m1.1.1">subscript</csymbol><ci id="S5.SS1.p6.1.m1.1.1.2.cmml" xref="S5.SS1.p6.1.m1.1.1.2">𝐿</ci><apply id="S5.SS1.p6.1.m1.1.1.3.cmml" xref="S5.SS1.p6.1.m1.1.1.3"><plus id="S5.SS1.p6.1.m1.1.1.3.1.cmml" xref="S5.SS1.p6.1.m1.1.1.3.1"></plus><apply id="S5.SS1.p6.1.m1.1.1.3.2.cmml" xref="S5.SS1.p6.1.m1.1.1.3.2"><minus id="S5.SS1.p6.1.m1.1.1.3.2.1.cmml" xref="S5.SS1.p6.1.m1.1.1.3.2.1"></minus><ci id="S5.SS1.p6.1.m1.1.1.3.2.2.cmml" xref="S5.SS1.p6.1.m1.1.1.3.2.2">𝑄</ci><ci id="S5.SS1.p6.1.m1.1.1.3.2.3.cmml" xref="S5.SS1.p6.1.m1.1.1.3.2.3">𝑁</ci></apply><apply id="S5.SS1.p6.1.m1.1.1.3.3.cmml" xref="S5.SS1.p6.1.m1.1.1.3.3"><times id="S5.SS1.p6.1.m1.1.1.3.3.1.cmml" xref="S5.SS1.p6.1.m1.1.1.3.3.1"></times><ci id="S5.SS1.p6.1.m1.1.1.3.3.2.cmml" xref="S5.SS1.p6.1.m1.1.1.3.3.2">𝑑</ci><ci id="S5.SS1.p6.1.m1.1.1.3.3.3.cmml" xref="S5.SS1.p6.1.m1.1.1.3.3.3">𝑒</ci><ci id="S5.SS1.p6.1.m1.1.1.3.3.4.cmml" xref="S5.SS1.p6.1.m1.1.1.3.3.4">𝑑</ci><ci id="S5.SS1.p6.1.m1.1.1.3.3.5.cmml" xref="S5.SS1.p6.1.m1.1.1.3.3.5">𝑢</ci><ci id="S5.SS1.p6.1.m1.1.1.3.3.6.cmml" xref="S5.SS1.p6.1.m1.1.1.3.3.6">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.1.m1.1c">L_{Q-N+dedup}</annotation></semantics></math>, builds upon the previous one by incorporating an additional step at the data loader level to exclude previously identified memorized training images from further model training. Training data duplication has been shown to increase memorization, therefore excluding samples that have previously been identified as memorized effectively creates a decentralized, privacy-preserving training data deduplication system. An image-level count of all identified instances of memorization is kept, which is then normalized via min-max normalization. Subsequently, the top 95th percentile of the most memorized samples are excluded from further training. On average, this results in the exclusion of 1.7% of each node’s local training set, aligning with findings in <cite class="ltx_cite ltx_citemacro_citep">(Carlini et al<span class="ltx_text">.</span>, <a href="#bib.bib9" title="" class="ltx_ref">2023</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citep">(Stein et al<span class="ltx_text">.</span>, <a href="#bib.bib22" title="" class="ltx_ref">2023</a>)</cite>, which report a 2.5% rate of training data memorization at the end of model training. Our lower exclusion rate is attributed to the successful reduction of memorization and earlier intervention during training.
This approach incurs no additional computational overhead, as memorized samples are already identified during model evaluation for further model training choice. To the best of our knowledge, we are the first to implement this method and demonstrate that excluding previously memorized samples effectively reduces training data memorization in subsequent training iterations.</p>
</div>
<div id="S5.SS1.p7" class="ltx_para">
<p id="S5.SS1.p7.1" class="ltx_p">All other training parameters remain identical across experiments, including duration and number of training epochs.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Baseline memorization metrics</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">We baseline using three recent metrics to measure memorization in GenAI models.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">AuthPct</span> <cite class="ltx_cite ltx_citemacro_citep">(Alaa et al<span class="ltx_text">.</span>, <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite> deems each generated sample either authentic or inauthentic and returns the fraction of authentic samples. Inauthentic samples are those for which the distance to the nearest point in the training set is less than the distance between that training sample and its nearest neighbor in the training set.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p"><math id="S5.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{C_{T}}" display="inline"><semantics id="S5.SS2.p3.1.m1.1a"><msub id="S5.SS2.p3.1.m1.1.1" xref="S5.SS2.p3.1.m1.1.1.cmml"><mi id="S5.SS2.p3.1.m1.1.1.2" xref="S5.SS2.p3.1.m1.1.1.2.cmml">𝐂</mi><mi id="S5.SS2.p3.1.m1.1.1.3" xref="S5.SS2.p3.1.m1.1.1.3.cmml">𝐓</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.m1.1b"><apply id="S5.SS2.p3.1.m1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p3.1.m1.1.1.1.cmml" xref="S5.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p3.1.m1.1.1.2.cmml" xref="S5.SS2.p3.1.m1.1.1.2">𝐂</ci><ci id="S5.SS2.p3.1.m1.1.1.3.cmml" xref="S5.SS2.p3.1.m1.1.1.3">𝐓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.m1.1c">\mathbf{C_{T}}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Meehan et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite> analyzes the training, test, and generated sample sets and summarizes how often training samples are closer to generated samples than they are to test samples through a Mann-Whitney hypothesis test<cite class="ltx_cite ltx_citemacro_citep">(Mann and Whitney, <a href="#bib.bib16" title="" class="ltx_ref">1947</a>)</cite>. The data is partitioned into several cells using k-means clustering; the score is computed in each cell and averaged to obtain the final score.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p"><span id="S5.SS2.p4.1.1" class="ltx_text ltx_font_bold">FLD</span> <cite class="ltx_cite ltx_citemacro_citep">(Jiralerspong et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2023</a>)</cite> is defined as the percentage of overfit Gaussians identified. The difference between the log-likelihoods under the training and test sets is calculated for each generated sample. The metric reports the percentage of generated samples for which the log-likelihood was higher under the training set than the test set. We
use the default implementation from <a target="_blank" href="https://github.com/marcojira/fld" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/marcojira/fld</a>, which also incorporates the original implementations of AuthPct and <math id="S5.SS2.p4.1.m1.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S5.SS2.p4.1.m1.1a"><msub id="S5.SS2.p4.1.m1.1.1" xref="S5.SS2.p4.1.m1.1.1.cmml"><mi id="S5.SS2.p4.1.m1.1.1.2" xref="S5.SS2.p4.1.m1.1.1.2.cmml">C</mi><mi id="S5.SS2.p4.1.m1.1.1.3" xref="S5.SS2.p4.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.m1.1b"><apply id="S5.SS2.p4.1.m1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p4.1.m1.1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p4.1.m1.1.1.2.cmml" xref="S5.SS2.p4.1.m1.1.1.2">𝐶</ci><ci id="S5.SS2.p4.1.m1.1.1.3.cmml" xref="S5.SS2.p4.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.m1.1c">C_{T}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Evaluation compared to baseline scores</h3>

<figure id="S5.F4" class="ltx_figure"><img src="/html/2409.18245/assets/figs/blended_all2.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="120" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>The lines represent the moving average of our proposed Q-N score, measured across the three training tasks - <span id="S5.F4.10.1" class="ltx_text ltx_font_bold">Orange</span> used the loss function <math id="S5.F4.4.m1.1" class="ltx_Math" alttext="L_{FLD+FID}" display="inline"><semantics id="S5.F4.4.m1.1b"><msub id="S5.F4.4.m1.1.1" xref="S5.F4.4.m1.1.1.cmml"><mi id="S5.F4.4.m1.1.1.2" xref="S5.F4.4.m1.1.1.2.cmml">L</mi><mrow id="S5.F4.4.m1.1.1.3" xref="S5.F4.4.m1.1.1.3.cmml"><mrow id="S5.F4.4.m1.1.1.3.2" xref="S5.F4.4.m1.1.1.3.2.cmml"><mi id="S5.F4.4.m1.1.1.3.2.2" xref="S5.F4.4.m1.1.1.3.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.F4.4.m1.1.1.3.2.1" xref="S5.F4.4.m1.1.1.3.2.1.cmml">​</mo><mi id="S5.F4.4.m1.1.1.3.2.3" xref="S5.F4.4.m1.1.1.3.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.F4.4.m1.1.1.3.2.1b" xref="S5.F4.4.m1.1.1.3.2.1.cmml">​</mo><mi id="S5.F4.4.m1.1.1.3.2.4" xref="S5.F4.4.m1.1.1.3.2.4.cmml">D</mi></mrow><mo id="S5.F4.4.m1.1.1.3.1" xref="S5.F4.4.m1.1.1.3.1.cmml">+</mo><mrow id="S5.F4.4.m1.1.1.3.3" xref="S5.F4.4.m1.1.1.3.3.cmml"><mi id="S5.F4.4.m1.1.1.3.3.2" xref="S5.F4.4.m1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.F4.4.m1.1.1.3.3.1" xref="S5.F4.4.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.F4.4.m1.1.1.3.3.3" xref="S5.F4.4.m1.1.1.3.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S5.F4.4.m1.1.1.3.3.1b" xref="S5.F4.4.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.F4.4.m1.1.1.3.3.4" xref="S5.F4.4.m1.1.1.3.3.4.cmml">D</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.F4.4.m1.1c"><apply id="S5.F4.4.m1.1.1.cmml" xref="S5.F4.4.m1.1.1"><csymbol cd="ambiguous" id="S5.F4.4.m1.1.1.1.cmml" xref="S5.F4.4.m1.1.1">subscript</csymbol><ci id="S5.F4.4.m1.1.1.2.cmml" xref="S5.F4.4.m1.1.1.2">𝐿</ci><apply id="S5.F4.4.m1.1.1.3.cmml" xref="S5.F4.4.m1.1.1.3"><plus id="S5.F4.4.m1.1.1.3.1.cmml" xref="S5.F4.4.m1.1.1.3.1"></plus><apply id="S5.F4.4.m1.1.1.3.2.cmml" xref="S5.F4.4.m1.1.1.3.2"><times id="S5.F4.4.m1.1.1.3.2.1.cmml" xref="S5.F4.4.m1.1.1.3.2.1"></times><ci id="S5.F4.4.m1.1.1.3.2.2.cmml" xref="S5.F4.4.m1.1.1.3.2.2">𝐹</ci><ci id="S5.F4.4.m1.1.1.3.2.3.cmml" xref="S5.F4.4.m1.1.1.3.2.3">𝐿</ci><ci id="S5.F4.4.m1.1.1.3.2.4.cmml" xref="S5.F4.4.m1.1.1.3.2.4">𝐷</ci></apply><apply id="S5.F4.4.m1.1.1.3.3.cmml" xref="S5.F4.4.m1.1.1.3.3"><times id="S5.F4.4.m1.1.1.3.3.1.cmml" xref="S5.F4.4.m1.1.1.3.3.1"></times><ci id="S5.F4.4.m1.1.1.3.3.2.cmml" xref="S5.F4.4.m1.1.1.3.3.2">𝐹</ci><ci id="S5.F4.4.m1.1.1.3.3.3.cmml" xref="S5.F4.4.m1.1.1.3.3.3">𝐼</ci><ci id="S5.F4.4.m1.1.1.3.3.4.cmml" xref="S5.F4.4.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.4.m1.1d">L_{FLD+FID}</annotation></semantics></math>; <span id="S5.F4.11.2" class="ltx_text ltx_font_bold">Green</span> trained with the objective <math id="S5.F4.5.m2.1" class="ltx_Math" alttext="L_{Q-N}" display="inline"><semantics id="S5.F4.5.m2.1b"><msub id="S5.F4.5.m2.1.1" xref="S5.F4.5.m2.1.1.cmml"><mi id="S5.F4.5.m2.1.1.2" xref="S5.F4.5.m2.1.1.2.cmml">L</mi><mrow id="S5.F4.5.m2.1.1.3" xref="S5.F4.5.m2.1.1.3.cmml"><mi id="S5.F4.5.m2.1.1.3.2" xref="S5.F4.5.m2.1.1.3.2.cmml">Q</mi><mo id="S5.F4.5.m2.1.1.3.1" xref="S5.F4.5.m2.1.1.3.1.cmml">−</mo><mi id="S5.F4.5.m2.1.1.3.3" xref="S5.F4.5.m2.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.F4.5.m2.1c"><apply id="S5.F4.5.m2.1.1.cmml" xref="S5.F4.5.m2.1.1"><csymbol cd="ambiguous" id="S5.F4.5.m2.1.1.1.cmml" xref="S5.F4.5.m2.1.1">subscript</csymbol><ci id="S5.F4.5.m2.1.1.2.cmml" xref="S5.F4.5.m2.1.1.2">𝐿</ci><apply id="S5.F4.5.m2.1.1.3.cmml" xref="S5.F4.5.m2.1.1.3"><minus id="S5.F4.5.m2.1.1.3.1.cmml" xref="S5.F4.5.m2.1.1.3.1"></minus><ci id="S5.F4.5.m2.1.1.3.2.cmml" xref="S5.F4.5.m2.1.1.3.2">𝑄</ci><ci id="S5.F4.5.m2.1.1.3.3.cmml" xref="S5.F4.5.m2.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.5.m2.1d">L_{Q-N}</annotation></semantics></math>; <span id="S5.F4.12.3" class="ltx_text ltx_font_bold">Pink</span> trained with the objective <math id="S5.F4.6.m3.1" class="ltx_Math" alttext="L_{Q-N}" display="inline"><semantics id="S5.F4.6.m3.1b"><msub id="S5.F4.6.m3.1.1" xref="S5.F4.6.m3.1.1.cmml"><mi id="S5.F4.6.m3.1.1.2" xref="S5.F4.6.m3.1.1.2.cmml">L</mi><mrow id="S5.F4.6.m3.1.1.3" xref="S5.F4.6.m3.1.1.3.cmml"><mi id="S5.F4.6.m3.1.1.3.2" xref="S5.F4.6.m3.1.1.3.2.cmml">Q</mi><mo id="S5.F4.6.m3.1.1.3.1" xref="S5.F4.6.m3.1.1.3.1.cmml">−</mo><mi id="S5.F4.6.m3.1.1.3.3" xref="S5.F4.6.m3.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.F4.6.m3.1c"><apply id="S5.F4.6.m3.1.1.cmml" xref="S5.F4.6.m3.1.1"><csymbol cd="ambiguous" id="S5.F4.6.m3.1.1.1.cmml" xref="S5.F4.6.m3.1.1">subscript</csymbol><ci id="S5.F4.6.m3.1.1.2.cmml" xref="S5.F4.6.m3.1.1.2">𝐿</ci><apply id="S5.F4.6.m3.1.1.3.cmml" xref="S5.F4.6.m3.1.1.3"><minus id="S5.F4.6.m3.1.1.3.1.cmml" xref="S5.F4.6.m3.1.1.3.1"></minus><ci id="S5.F4.6.m3.1.1.3.2.cmml" xref="S5.F4.6.m3.1.1.3.2">𝑄</ci><ci id="S5.F4.6.m3.1.1.3.3.cmml" xref="S5.F4.6.m3.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.6.m3.1d">L_{Q-N}</annotation></semantics></math> and excluded memorized training samples from further training at the dataloader level. We observe that training using our proposed loss function significantly reduces the extent of memorization in diffusion models, regardless of the number of participants. In addition, excluding memorized samples from further training significantly reduces memorization and is the most effective of the three methods.</figcaption>
</figure>
<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">In the first experiment, a pool of 100,000 generated images is created. The generated images are gradually replaced by training images until, finally, the training data makes up 100% of the pool. Memorization between the training set and the image pool is measured using the Q-N, FLD, AuthPct, and <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><msub id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1.2" xref="S5.SS3.p1.1.m1.1.1.2.cmml">C</mi><mi id="S5.SS3.p1.1.m1.1.1.3" xref="S5.SS3.p1.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><apply id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p1.1.m1.1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p1.1.m1.1.1.2.cmml" xref="S5.SS3.p1.1.m1.1.1.2">𝐶</ci><ci id="S5.SS3.p1.1.m1.1.1.3.cmml" xref="S5.SS3.p1.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">C_{T}</annotation></semantics></math> scores. All scores trend in a direction indicating increased memorization. Our proposed Q-N score reaches an accuracy of 98.94% for identifying memorized samples. In contrast, the other scores each operate on their own respective scales and provide measures of memorization, but they do not directly support the extraction of memorized sample pairs as our Q-N score does, thus preventing the calculation of an accuracy rate.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.6" class="ltx_p">We run experiments training diffusion models according to the three previously outlined training setups:1) <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="L_{FLD+FID}" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><msub id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">L</mi><mrow id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml"><mrow id="S5.SS3.p2.1.m1.1.1.3.2" xref="S5.SS3.p2.1.m1.1.1.3.2.cmml"><mi id="S5.SS3.p2.1.m1.1.1.3.2.2" xref="S5.SS3.p2.1.m1.1.1.3.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.1.m1.1.1.3.2.1" xref="S5.SS3.p2.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S5.SS3.p2.1.m1.1.1.3.2.3" xref="S5.SS3.p2.1.m1.1.1.3.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.1.m1.1.1.3.2.1a" xref="S5.SS3.p2.1.m1.1.1.3.2.1.cmml">​</mo><mi id="S5.SS3.p2.1.m1.1.1.3.2.4" xref="S5.SS3.p2.1.m1.1.1.3.2.4.cmml">D</mi></mrow><mo id="S5.SS3.p2.1.m1.1.1.3.1" xref="S5.SS3.p2.1.m1.1.1.3.1.cmml">+</mo><mrow id="S5.SS3.p2.1.m1.1.1.3.3" xref="S5.SS3.p2.1.m1.1.1.3.3.cmml"><mi id="S5.SS3.p2.1.m1.1.1.3.3.2" xref="S5.SS3.p2.1.m1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.1.m1.1.1.3.3.1" xref="S5.SS3.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS3.p2.1.m1.1.1.3.3.3" xref="S5.SS3.p2.1.m1.1.1.3.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.1.m1.1.1.3.3.1a" xref="S5.SS3.p2.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S5.SS3.p2.1.m1.1.1.3.3.4" xref="S5.SS3.p2.1.m1.1.1.3.3.4.cmml">D</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">𝐿</ci><apply id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3"><plus id="S5.SS3.p2.1.m1.1.1.3.1.cmml" xref="S5.SS3.p2.1.m1.1.1.3.1"></plus><apply id="S5.SS3.p2.1.m1.1.1.3.2.cmml" xref="S5.SS3.p2.1.m1.1.1.3.2"><times id="S5.SS3.p2.1.m1.1.1.3.2.1.cmml" xref="S5.SS3.p2.1.m1.1.1.3.2.1"></times><ci id="S5.SS3.p2.1.m1.1.1.3.2.2.cmml" xref="S5.SS3.p2.1.m1.1.1.3.2.2">𝐹</ci><ci id="S5.SS3.p2.1.m1.1.1.3.2.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3.2.3">𝐿</ci><ci id="S5.SS3.p2.1.m1.1.1.3.2.4.cmml" xref="S5.SS3.p2.1.m1.1.1.3.2.4">𝐷</ci></apply><apply id="S5.SS3.p2.1.m1.1.1.3.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3"><times id="S5.SS3.p2.1.m1.1.1.3.3.1.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3.1"></times><ci id="S5.SS3.p2.1.m1.1.1.3.3.2.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3.2">𝐹</ci><ci id="S5.SS3.p2.1.m1.1.1.3.3.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3.3">𝐼</ci><ci id="S5.SS3.p2.1.m1.1.1.3.3.4.cmml" xref="S5.SS3.p2.1.m1.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">L_{FLD+FID}</annotation></semantics></math>, 2) <math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="L_{Q-N}" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><msub id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mi id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">L</mi><mrow id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml"><mi id="S5.SS3.p2.2.m2.1.1.3.2" xref="S5.SS3.p2.2.m2.1.1.3.2.cmml">Q</mi><mo id="S5.SS3.p2.2.m2.1.1.3.1" xref="S5.SS3.p2.2.m2.1.1.3.1.cmml">−</mo><mi id="S5.SS3.p2.2.m2.1.1.3.3" xref="S5.SS3.p2.2.m2.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">𝐿</ci><apply id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3"><minus id="S5.SS3.p2.2.m2.1.1.3.1.cmml" xref="S5.SS3.p2.2.m2.1.1.3.1"></minus><ci id="S5.SS3.p2.2.m2.1.1.3.2.cmml" xref="S5.SS3.p2.2.m2.1.1.3.2">𝑄</ci><ci id="S5.SS3.p2.2.m2.1.1.3.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">L_{Q-N}</annotation></semantics></math> and 3) <math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="L_{Q-N+dedup}" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><msub id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><mi id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml">L</mi><mrow id="S5.SS3.p2.3.m3.1.1.3" xref="S5.SS3.p2.3.m3.1.1.3.cmml"><mrow id="S5.SS3.p2.3.m3.1.1.3.2" xref="S5.SS3.p2.3.m3.1.1.3.2.cmml"><mi id="S5.SS3.p2.3.m3.1.1.3.2.2" xref="S5.SS3.p2.3.m3.1.1.3.2.2.cmml">Q</mi><mo id="S5.SS3.p2.3.m3.1.1.3.2.1" xref="S5.SS3.p2.3.m3.1.1.3.2.1.cmml">−</mo><mi id="S5.SS3.p2.3.m3.1.1.3.2.3" xref="S5.SS3.p2.3.m3.1.1.3.2.3.cmml">N</mi></mrow><mo id="S5.SS3.p2.3.m3.1.1.3.1" xref="S5.SS3.p2.3.m3.1.1.3.1.cmml">+</mo><mrow id="S5.SS3.p2.3.m3.1.1.3.3" xref="S5.SS3.p2.3.m3.1.1.3.3.cmml"><mi id="S5.SS3.p2.3.m3.1.1.3.3.2" xref="S5.SS3.p2.3.m3.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.3.m3.1.1.3.3.1" xref="S5.SS3.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS3.p2.3.m3.1.1.3.3.3" xref="S5.SS3.p2.3.m3.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.3.m3.1.1.3.3.1a" xref="S5.SS3.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS3.p2.3.m3.1.1.3.3.4" xref="S5.SS3.p2.3.m3.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.3.m3.1.1.3.3.1b" xref="S5.SS3.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS3.p2.3.m3.1.1.3.3.5" xref="S5.SS3.p2.3.m3.1.1.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p2.3.m3.1.1.3.3.1c" xref="S5.SS3.p2.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS3.p2.3.m3.1.1.3.3.6" xref="S5.SS3.p2.3.m3.1.1.3.3.6.cmml">p</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><apply id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.3.m3.1.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S5.SS3.p2.3.m3.1.1.2.cmml" xref="S5.SS3.p2.3.m3.1.1.2">𝐿</ci><apply id="S5.SS3.p2.3.m3.1.1.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3"><plus id="S5.SS3.p2.3.m3.1.1.3.1.cmml" xref="S5.SS3.p2.3.m3.1.1.3.1"></plus><apply id="S5.SS3.p2.3.m3.1.1.3.2.cmml" xref="S5.SS3.p2.3.m3.1.1.3.2"><minus id="S5.SS3.p2.3.m3.1.1.3.2.1.cmml" xref="S5.SS3.p2.3.m3.1.1.3.2.1"></minus><ci id="S5.SS3.p2.3.m3.1.1.3.2.2.cmml" xref="S5.SS3.p2.3.m3.1.1.3.2.2">𝑄</ci><ci id="S5.SS3.p2.3.m3.1.1.3.2.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3.2.3">𝑁</ci></apply><apply id="S5.SS3.p2.3.m3.1.1.3.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3.3"><times id="S5.SS3.p2.3.m3.1.1.3.3.1.cmml" xref="S5.SS3.p2.3.m3.1.1.3.3.1"></times><ci id="S5.SS3.p2.3.m3.1.1.3.3.2.cmml" xref="S5.SS3.p2.3.m3.1.1.3.3.2">𝑑</ci><ci id="S5.SS3.p2.3.m3.1.1.3.3.3.cmml" xref="S5.SS3.p2.3.m3.1.1.3.3.3">𝑒</ci><ci id="S5.SS3.p2.3.m3.1.1.3.3.4.cmml" xref="S5.SS3.p2.3.m3.1.1.3.3.4">𝑑</ci><ci id="S5.SS3.p2.3.m3.1.1.3.3.5.cmml" xref="S5.SS3.p2.3.m3.1.1.3.3.5">𝑢</ci><ci id="S5.SS3.p2.3.m3.1.1.3.3.6.cmml" xref="S5.SS3.p2.3.m3.1.1.3.3.6">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">L_{Q-N+dedup}</annotation></semantics></math>. We calculate the mean of the Q-N score reported by each client node for each model submission and plot the results from the first and second training setups for comparison in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2. Model Auditability and Incentives ‣ 4. Federated Learning Framework ‣ PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The right shows the mean Q-N, FLD, AuthPct, and <math id="S5.SS3.p2.4.m4.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S5.SS3.p2.4.m4.1a"><msub id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml"><mi id="S5.SS3.p2.4.m4.1.1.2" xref="S5.SS3.p2.4.m4.1.1.2.cmml">C</mi><mi id="S5.SS3.p2.4.m4.1.1.3" xref="S5.SS3.p2.4.m4.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><apply id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.4.m4.1.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S5.SS3.p2.4.m4.1.1.2.cmml" xref="S5.SS3.p2.4.m4.1.1.2">𝐶</ci><ci id="S5.SS3.p2.4.m4.1.1.3.cmml" xref="S5.SS3.p2.4.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">C_{T}</annotation></semantics></math> scores reported by each node for each model submission. Notably, while our proposed metric exhibits an upward trend, suggesting higher rates of memorization as model training progresses, the FLD, AuthPct, and <math id="S5.SS3.p2.5.m5.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S5.SS3.p2.5.m5.1a"><msub id="S5.SS3.p2.5.m5.1.1" xref="S5.SS3.p2.5.m5.1.1.cmml"><mi id="S5.SS3.p2.5.m5.1.1.2" xref="S5.SS3.p2.5.m5.1.1.2.cmml">C</mi><mi id="S5.SS3.p2.5.m5.1.1.3" xref="S5.SS3.p2.5.m5.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.1b"><apply id="S5.SS3.p2.5.m5.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.5.m5.1.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S5.SS3.p2.5.m5.1.1.2.cmml" xref="S5.SS3.p2.5.m5.1.1.2">𝐶</ci><ci id="S5.SS3.p2.5.m5.1.1.3.cmml" xref="S5.SS3.p2.5.m5.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.1c">C_{T}</annotation></semantics></math> scores tend to plateau or even trend in directions, indicating a decrease in memorization. Higher AuthPct and <math id="S5.SS3.p2.6.m6.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S5.SS3.p2.6.m6.1a"><msub id="S5.SS3.p2.6.m6.1.1" xref="S5.SS3.p2.6.m6.1.1.cmml"><mi id="S5.SS3.p2.6.m6.1.1.2" xref="S5.SS3.p2.6.m6.1.1.2.cmml">C</mi><mi id="S5.SS3.p2.6.m6.1.1.3" xref="S5.SS3.p2.6.m6.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.6.m6.1b"><apply id="S5.SS3.p2.6.m6.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS3.p2.6.m6.1.1.1.cmml" xref="S5.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S5.SS3.p2.6.m6.1.1.2.cmml" xref="S5.SS3.p2.6.m6.1.1.2">𝐶</ci><ci id="S5.SS3.p2.6.m6.1.1.3.cmml" xref="S5.SS3.p2.6.m6.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.6.m6.1c">C_{T}</annotation></semantics></math> scores indicate less memorization, whereas lower FLD indicates less memorization.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.3" class="ltx_p">One explanation for the observed behavior of FLD, AuthPct, and <math id="S5.SS3.p3.1.m1.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S5.SS3.p3.1.m1.1a"><msub id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml"><mi id="S5.SS3.p3.1.m1.1.1.2" xref="S5.SS3.p3.1.m1.1.1.2.cmml">C</mi><mi id="S5.SS3.p3.1.m1.1.1.3" xref="S5.SS3.p3.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><apply id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.1.m1.1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p3.1.m1.1.1.2.cmml" xref="S5.SS3.p3.1.m1.1.1.2">𝐶</ci><ci id="S5.SS3.p3.1.m1.1.1.3.cmml" xref="S5.SS3.p3.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">C_{T}</annotation></semantics></math> scores is their sensitivity to the test set size. FLD and AuthPct require a minimum of 10,000 samples for an accurate evaluation and recommend using the entire train and test sets to compute the metric <cite class="ltx_cite ltx_citemacro_citep">(Jiralerspong et al<span class="ltx_text">.</span>, <a href="#bib.bib14" title="" class="ltx_ref">2023</a>)</cite> — a method unsuitable for the federated learning scenario, where datasets are distributed across multiple nodes, and participants typically have varying amounts of data. Similarly, sample set size is a limitation for the <math id="S5.SS3.p3.2.m2.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S5.SS3.p3.2.m2.1a"><msub id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml"><mi id="S5.SS3.p3.2.m2.1.1.2" xref="S5.SS3.p3.2.m2.1.1.2.cmml">C</mi><mi id="S5.SS3.p3.2.m2.1.1.3" xref="S5.SS3.p3.2.m2.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><apply id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.2.m2.1.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1">subscript</csymbol><ci id="S5.SS3.p3.2.m2.1.1.2.cmml" xref="S5.SS3.p3.2.m2.1.1.2">𝐶</ci><ci id="S5.SS3.p3.2.m2.1.1.3.cmml" xref="S5.SS3.p3.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">C_{T}</annotation></semantics></math> score; without sufficient samples, the metric not only exhibits higher variance, but the ability to finely partition the instance space is reduced, which leads to mischaracterization and measurement errors <cite class="ltx_cite ltx_citemacro_citep">(Meehan et al<span class="ltx_text">.</span>, <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>. In contrast, our proposed Q-N metric maintains accuracy regardless of sample set size, making it more cost-effective, robust and adaptable to real-world scenarios with limited resources, particularly within the federated learning context. Another limitation of the FLD and <math id="S5.SS3.p3.3.m3.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S5.SS3.p3.3.m3.1a"><msub id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml"><mi id="S5.SS3.p3.3.m3.1.1.2" xref="S5.SS3.p3.3.m3.1.1.2.cmml">C</mi><mi id="S5.SS3.p3.3.m3.1.1.3" xref="S5.SS3.p3.3.m3.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><apply id="S5.SS3.p3.3.m3.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS3.p3.3.m3.1.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S5.SS3.p3.3.m3.1.1.2.cmml" xref="S5.SS3.p3.3.m3.1.1.2">𝐶</ci><ci id="S5.SS3.p3.3.m3.1.1.3.cmml" xref="S5.SS3.p3.3.m3.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">C_{T}</annotation></semantics></math> scores is that in addition to the training and generated sample set, they also utilize the test set for their calculation. This assumes that the training and test datasets are non-overlapping, which is often not the case in practice <cite class="ltx_cite ltx_citemacro_citep">(Barz and Denzler, <a href="#bib.bib5" title="" class="ltx_ref">2020</a>)</cite>. Our proposed Q-N metric doesn’t have this limitation, effectively measuring memorization without the need for the test set.</p>
</div>
<div id="S5.SS3.p4" class="ltx_para">
<p id="S5.SS3.p4.1" class="ltx_p">The graphs in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2. Model Auditability and Incentives ‣ 4. Federated Learning Framework ‣ PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> show that our training method using <math id="S5.SS3.p4.1.m1.1" class="ltx_Math" alttext="L_{Q-N}" display="inline"><semantics id="S5.SS3.p4.1.m1.1a"><msub id="S5.SS3.p4.1.m1.1.1" xref="S5.SS3.p4.1.m1.1.1.cmml"><mi id="S5.SS3.p4.1.m1.1.1.2" xref="S5.SS3.p4.1.m1.1.1.2.cmml">L</mi><mrow id="S5.SS3.p4.1.m1.1.1.3" xref="S5.SS3.p4.1.m1.1.1.3.cmml"><mi id="S5.SS3.p4.1.m1.1.1.3.2" xref="S5.SS3.p4.1.m1.1.1.3.2.cmml">Q</mi><mo id="S5.SS3.p4.1.m1.1.1.3.1" xref="S5.SS3.p4.1.m1.1.1.3.1.cmml">−</mo><mi id="S5.SS3.p4.1.m1.1.1.3.3" xref="S5.SS3.p4.1.m1.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p4.1.m1.1b"><apply id="S5.SS3.p4.1.m1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p4.1.m1.1.1.1.cmml" xref="S5.SS3.p4.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p4.1.m1.1.1.2.cmml" xref="S5.SS3.p4.1.m1.1.1.2">𝐿</ci><apply id="S5.SS3.p4.1.m1.1.1.3.cmml" xref="S5.SS3.p4.1.m1.1.1.3"><minus id="S5.SS3.p4.1.m1.1.1.3.1.cmml" xref="S5.SS3.p4.1.m1.1.1.3.1"></minus><ci id="S5.SS3.p4.1.m1.1.1.3.2.cmml" xref="S5.SS3.p4.1.m1.1.1.3.2">𝑄</ci><ci id="S5.SS3.p4.1.m1.1.1.3.3.cmml" xref="S5.SS3.p4.1.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p4.1.m1.1c">L_{Q-N}</annotation></semantics></math> decreases memorization and is more sensitive to recognizing memorization behavior than all other metrics.</p>
</div>
<div id="S5.SS3.p5" class="ltx_para">
<p id="S5.SS3.p5.1" class="ltx_p">On the left, all scores for the baseline experiment are shown and measured at various points in the training process. This model was trained traditionally, outside of a federated learning framework. As expected, memorization increases as training progresses. Unlike our proposed Q-N metric, the AuthPct, <math id="S5.SS3.p5.1.m1.1" class="ltx_Math" alttext="C_{T}" display="inline"><semantics id="S5.SS3.p5.1.m1.1a"><msub id="S5.SS3.p5.1.m1.1.1" xref="S5.SS3.p5.1.m1.1.1.cmml"><mi id="S5.SS3.p5.1.m1.1.1.2" xref="S5.SS3.p5.1.m1.1.1.2.cmml">C</mi><mi id="S5.SS3.p5.1.m1.1.1.3" xref="S5.SS3.p5.1.m1.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS3.p5.1.m1.1b"><apply id="S5.SS3.p5.1.m1.1.1.cmml" xref="S5.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS3.p5.1.m1.1.1.1.cmml" xref="S5.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S5.SS3.p5.1.m1.1.1.2.cmml" xref="S5.SS3.p5.1.m1.1.1.2">𝐶</ci><ci id="S5.SS3.p5.1.m1.1.1.3.cmml" xref="S5.SS3.p5.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p5.1.m1.1c">C_{T}</annotation></semantics></math>, and FLD scores level out after only 1,000 epochs, failing to detect the memorization behavior the Q-N metric is able to identify as training progresses.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Evaluating our objective function’s effect on memorization</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.3" class="ltx_p">Figure <a href="#S5.F4" title="Figure 4 ‣ 5.3. Evaluation compared to baseline scores ‣ 5. Evaluation ‣ PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows that for each experiment, training models using the proposed <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="L_{Q-N}" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><msub id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml"><mi id="S5.SS4.p1.1.m1.1.1.2" xref="S5.SS4.p1.1.m1.1.1.2.cmml">L</mi><mrow id="S5.SS4.p1.1.m1.1.1.3" xref="S5.SS4.p1.1.m1.1.1.3.cmml"><mi id="S5.SS4.p1.1.m1.1.1.3.2" xref="S5.SS4.p1.1.m1.1.1.3.2.cmml">Q</mi><mo id="S5.SS4.p1.1.m1.1.1.3.1" xref="S5.SS4.p1.1.m1.1.1.3.1.cmml">−</mo><mi id="S5.SS4.p1.1.m1.1.1.3.3" xref="S5.SS4.p1.1.m1.1.1.3.3.cmml">N</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.1.m1.1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS4.p1.1.m1.1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.1.2">𝐿</ci><apply id="S5.SS4.p1.1.m1.1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3"><minus id="S5.SS4.p1.1.m1.1.1.3.1.cmml" xref="S5.SS4.p1.1.m1.1.1.3.1"></minus><ci id="S5.SS4.p1.1.m1.1.1.3.2.cmml" xref="S5.SS4.p1.1.m1.1.1.3.2">𝑄</ci><ci id="S5.SS4.p1.1.m1.1.1.3.3.cmml" xref="S5.SS4.p1.1.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">L_{Q-N}</annotation></semantics></math> function based on our Q-N score succeeds in significantly reducing the extent of memorization in diffusion models, as compared to models trained using <math id="S5.SS4.p1.2.m2.1" class="ltx_Math" alttext="L_{FLD+FID}" display="inline"><semantics id="S5.SS4.p1.2.m2.1a"><msub id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml"><mi id="S5.SS4.p1.2.m2.1.1.2" xref="S5.SS4.p1.2.m2.1.1.2.cmml">L</mi><mrow id="S5.SS4.p1.2.m2.1.1.3" xref="S5.SS4.p1.2.m2.1.1.3.cmml"><mrow id="S5.SS4.p1.2.m2.1.1.3.2" xref="S5.SS4.p1.2.m2.1.1.3.2.cmml"><mi id="S5.SS4.p1.2.m2.1.1.3.2.2" xref="S5.SS4.p1.2.m2.1.1.3.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.SS4.p1.2.m2.1.1.3.2.1" xref="S5.SS4.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S5.SS4.p1.2.m2.1.1.3.2.3" xref="S5.SS4.p1.2.m2.1.1.3.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S5.SS4.p1.2.m2.1.1.3.2.1a" xref="S5.SS4.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S5.SS4.p1.2.m2.1.1.3.2.4" xref="S5.SS4.p1.2.m2.1.1.3.2.4.cmml">D</mi></mrow><mo id="S5.SS4.p1.2.m2.1.1.3.1" xref="S5.SS4.p1.2.m2.1.1.3.1.cmml">+</mo><mrow id="S5.SS4.p1.2.m2.1.1.3.3" xref="S5.SS4.p1.2.m2.1.1.3.3.cmml"><mi id="S5.SS4.p1.2.m2.1.1.3.3.2" xref="S5.SS4.p1.2.m2.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S5.SS4.p1.2.m2.1.1.3.3.1" xref="S5.SS4.p1.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S5.SS4.p1.2.m2.1.1.3.3.3" xref="S5.SS4.p1.2.m2.1.1.3.3.3.cmml">I</mi><mo lspace="0em" rspace="0em" id="S5.SS4.p1.2.m2.1.1.3.3.1a" xref="S5.SS4.p1.2.m2.1.1.3.3.1.cmml">​</mo><mi id="S5.SS4.p1.2.m2.1.1.3.3.4" xref="S5.SS4.p1.2.m2.1.1.3.3.4.cmml">D</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><apply id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.2.m2.1.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS4.p1.2.m2.1.1.2.cmml" xref="S5.SS4.p1.2.m2.1.1.2">𝐿</ci><apply id="S5.SS4.p1.2.m2.1.1.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3"><plus id="S5.SS4.p1.2.m2.1.1.3.1.cmml" xref="S5.SS4.p1.2.m2.1.1.3.1"></plus><apply id="S5.SS4.p1.2.m2.1.1.3.2.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2"><times id="S5.SS4.p1.2.m2.1.1.3.2.1.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2.1"></times><ci id="S5.SS4.p1.2.m2.1.1.3.2.2.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2.2">𝐹</ci><ci id="S5.SS4.p1.2.m2.1.1.3.2.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2.3">𝐿</ci><ci id="S5.SS4.p1.2.m2.1.1.3.2.4.cmml" xref="S5.SS4.p1.2.m2.1.1.3.2.4">𝐷</ci></apply><apply id="S5.SS4.p1.2.m2.1.1.3.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3.3"><times id="S5.SS4.p1.2.m2.1.1.3.3.1.cmml" xref="S5.SS4.p1.2.m2.1.1.3.3.1"></times><ci id="S5.SS4.p1.2.m2.1.1.3.3.2.cmml" xref="S5.SS4.p1.2.m2.1.1.3.3.2">𝐹</ci><ci id="S5.SS4.p1.2.m2.1.1.3.3.3.cmml" xref="S5.SS4.p1.2.m2.1.1.3.3.3">𝐼</ci><ci id="S5.SS4.p1.2.m2.1.1.3.3.4.cmml" xref="S5.SS4.p1.2.m2.1.1.3.3.4">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">L_{FLD+FID}</annotation></semantics></math>. In addition, the experiments show that excluding memorized samples from further training within the <math id="S5.SS4.p1.3.m3.1" class="ltx_Math" alttext="L_{Q-N+dedup}" display="inline"><semantics id="S5.SS4.p1.3.m3.1a"><msub id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml"><mi id="S5.SS4.p1.3.m3.1.1.2" xref="S5.SS4.p1.3.m3.1.1.2.cmml">L</mi><mrow id="S5.SS4.p1.3.m3.1.1.3" xref="S5.SS4.p1.3.m3.1.1.3.cmml"><mrow id="S5.SS4.p1.3.m3.1.1.3.2" xref="S5.SS4.p1.3.m3.1.1.3.2.cmml"><mi id="S5.SS4.p1.3.m3.1.1.3.2.2" xref="S5.SS4.p1.3.m3.1.1.3.2.2.cmml">Q</mi><mo id="S5.SS4.p1.3.m3.1.1.3.2.1" xref="S5.SS4.p1.3.m3.1.1.3.2.1.cmml">−</mo><mi id="S5.SS4.p1.3.m3.1.1.3.2.3" xref="S5.SS4.p1.3.m3.1.1.3.2.3.cmml">N</mi></mrow><mo id="S5.SS4.p1.3.m3.1.1.3.1" xref="S5.SS4.p1.3.m3.1.1.3.1.cmml">+</mo><mrow id="S5.SS4.p1.3.m3.1.1.3.3" xref="S5.SS4.p1.3.m3.1.1.3.3.cmml"><mi id="S5.SS4.p1.3.m3.1.1.3.3.2" xref="S5.SS4.p1.3.m3.1.1.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS4.p1.3.m3.1.1.3.3.1" xref="S5.SS4.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS4.p1.3.m3.1.1.3.3.3" xref="S5.SS4.p1.3.m3.1.1.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS4.p1.3.m3.1.1.3.3.1a" xref="S5.SS4.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS4.p1.3.m3.1.1.3.3.4" xref="S5.SS4.p1.3.m3.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.SS4.p1.3.m3.1.1.3.3.1b" xref="S5.SS4.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS4.p1.3.m3.1.1.3.3.5" xref="S5.SS4.p1.3.m3.1.1.3.3.5.cmml">u</mi><mo lspace="0em" rspace="0em" id="S5.SS4.p1.3.m3.1.1.3.3.1c" xref="S5.SS4.p1.3.m3.1.1.3.3.1.cmml">​</mo><mi id="S5.SS4.p1.3.m3.1.1.3.3.6" xref="S5.SS4.p1.3.m3.1.1.3.3.6.cmml">p</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.1b"><apply id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.p1.3.m3.1.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS4.p1.3.m3.1.1.2.cmml" xref="S5.SS4.p1.3.m3.1.1.2">𝐿</ci><apply id="S5.SS4.p1.3.m3.1.1.3.cmml" xref="S5.SS4.p1.3.m3.1.1.3"><plus id="S5.SS4.p1.3.m3.1.1.3.1.cmml" xref="S5.SS4.p1.3.m3.1.1.3.1"></plus><apply id="S5.SS4.p1.3.m3.1.1.3.2.cmml" xref="S5.SS4.p1.3.m3.1.1.3.2"><minus id="S5.SS4.p1.3.m3.1.1.3.2.1.cmml" xref="S5.SS4.p1.3.m3.1.1.3.2.1"></minus><ci id="S5.SS4.p1.3.m3.1.1.3.2.2.cmml" xref="S5.SS4.p1.3.m3.1.1.3.2.2">𝑄</ci><ci id="S5.SS4.p1.3.m3.1.1.3.2.3.cmml" xref="S5.SS4.p1.3.m3.1.1.3.2.3">𝑁</ci></apply><apply id="S5.SS4.p1.3.m3.1.1.3.3.cmml" xref="S5.SS4.p1.3.m3.1.1.3.3"><times id="S5.SS4.p1.3.m3.1.1.3.3.1.cmml" xref="S5.SS4.p1.3.m3.1.1.3.3.1"></times><ci id="S5.SS4.p1.3.m3.1.1.3.3.2.cmml" xref="S5.SS4.p1.3.m3.1.1.3.3.2">𝑑</ci><ci id="S5.SS4.p1.3.m3.1.1.3.3.3.cmml" xref="S5.SS4.p1.3.m3.1.1.3.3.3">𝑒</ci><ci id="S5.SS4.p1.3.m3.1.1.3.3.4.cmml" xref="S5.SS4.p1.3.m3.1.1.3.3.4">𝑑</ci><ci id="S5.SS4.p1.3.m3.1.1.3.3.5.cmml" xref="S5.SS4.p1.3.m3.1.1.3.3.5">𝑢</ci><ci id="S5.SS4.p1.3.m3.1.1.3.3.6.cmml" xref="S5.SS4.p1.3.m3.1.1.3.3.6">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.1c">L_{Q-N+dedup}</annotation></semantics></math> training setup significantly reduces memorization and is the most effective of the three methods.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">Table <a href="#S5.T1" title="Table 1 ‣ 5.1. Experimental Setup ‣ 5. Evaluation ‣ PDFed: Privacy-Preserving and Decentralized Asynchronous Federated Learning for Diffusion Models" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> presents the mean scores of the 10 latest model submissions across all training setups, evaluated using the entire CIFAR-10 dataset rather than individual node data splits. We draw three conclusions: 1) that training using our proposed methods is successful in decreasing the extent of memorization while all other metrics, including FID, remain roughly the same, 2) that the more nodes there are and the fewer data they each hold, the longer it takes for a model to reach the same image generation quality. However, the level of memorization exhibited is significantly lower. 3) the level of memorization decreases the more participants are involved in training, even when our proposed objective function isn’t used in training but our proposed federated learning framework is.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Our experiments demonstrate that the proposed decentralized, asynchronous federated learning framework (here experimentally implemented using a blockchain), in conjunction with the Q-N score, successfully reduces training data memorization in diffusion models. We leverage the decentralized, leaderless nature of public blockchains, enabling participants to operate asynchronously and independently with local training strategies, while also considering validation-only participants to foster broader participation. Our proposed metric shows greater sensitivity in detecting memorization behavior across various training setups, outperforming concurrent metrics. These findings underscore the importance of incorporating novel evaluation strategies, like our proposed Q-N score, to ensure training data privacy and enhance the generalization of GenAI models. Future efforts should focus on integrating our loss function within the training code of diffusion models and further exploring decentralised federated learning solutions to enhance privacy, transparency, and efficiency for ethical and collaborative AI training. PDFed has the potential to reshape the creative industry by fostering a more equitable AI ecosystem for artists and creators. Thus, future work should study the socio-economic drivers necessary to ensure the adoption and sustainability of truly decentralised, peer-to-peer GenAI training, especially considering input from the creative sector.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
PDFed was supported by DECaDE under EPSRC Grant EP/T022485/1.

</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">        




</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alaa et al<span id="bib.bib2.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Ahmed M. Alaa, Boris van Breugel, Evgeny S. Saveliev, and Mihaela van der Schaar. 2021.

</span>
<span class="ltx_bibblock">How Faithful is your Synthetic Data? Sample-level Metrics for Evaluating and Auditing Generative Models. In <em id="bib.bib2.3.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Balan et al<span id="bib.bib3.2.2.1" class="ltx_text">.</span> (2023a)</span>
<span class="ltx_bibblock">
Kar Balan, Shruti Agarwal, Simon Jenni, Andy Parsons, Andrew Gilbert, and John Collomosse. 2023a.

</span>
<span class="ltx_bibblock">EKILA: Synthetic Media Provenance and Attribution for Generative Art. In <em id="bib.bib3.3.1" class="ltx_emph ltx_font_italic">2023 IEEE/CVF Conference on Computer Vision and Pattern Recognition Workshops (CVPRW)</em>. IEEE Computer Society, Los Alamitos, CA, USA, 913–922.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Balan et al<span id="bib.bib4.2.2.1" class="ltx_text">.</span> (2023b)</span>
<span class="ltx_bibblock">
Kar Balan, Andrew Gilbert, Alexander Black, Simon Jenni, Andy Parsons, and John Collomosse. 2023b.

</span>
<span class="ltx_bibblock">DECORAIT - DECentralized Opt-in/out Registry for AI Training. In <em id="bib.bib4.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th ACM SIGGRAPH European Conference on Visual Media Production</em> <em id="bib.bib4.4.2" class="ltx_emph ltx_font_italic">(CVMP ’23)</em>. Association for Computing Machinery, New York, NY, USA, Article 4, 10 pages.

</span>
<span class="ltx_bibblock">

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Barz and Denzler (2020)</span>
<span class="ltx_bibblock">
Björn Barz and Joachim Denzler. 2020.

</span>
<span class="ltx_bibblock">Do We Train on Test Data? Purging CIFAR of Near-Duplicates.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Journal of Imaging</em> 6, 6 (June 2020), 41.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Behera et al<span id="bib.bib6.2.2.1" class="ltx_text">.</span> (2022)</span>
<span class="ltx_bibblock">
Monik Raj Behera, Sudhir Upadhyay, and Suresh Shetty. 2022.

</span>
<span class="ltx_bibblock">Federated Learning using Smart Contracts on Blockchains, based on Reward Driven Approach.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2107.10243 [cs.CR]

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Black et al<span id="bib.bib7.2.2.1" class="ltx_text">.</span> (2021)</span>
<span class="ltx_bibblock">
Alexander Black, Tu Bui, Hailin Jin, Vishy Swaminathan, and John Collomosse. 2021.

</span>
<span class="ltx_bibblock">Deep Image Comparator: Learning To Visualize Editorial Change. In <em id="bib.bib7.3.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR) Workshops</em>. 972–980.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bui et al<span id="bib.bib8.2.2.1" class="ltx_text">.</span> (2019)</span>
<span class="ltx_bibblock">
Tu Bui, Daniel Cooper, John Collomosse, Mark Bell, Alex Green, John Sheridan, Jez Higgins, Arindra Das, Jared Keller, Olivier Thereaux, and Alan Brown. 2019.

</span>
<span class="ltx_bibblock">ARCHANGEL: Tamper-Proofing Video Archives Using Temporal Content Hashes on the Blockchain. In <em id="bib.bib8.3.1" class="ltx_emph ltx_font_italic">2019 IEEE/CVF Conference on Computer Vision and Pattern Recognition Workshops (CVPRW)</em>. IEEE Computer Society, Los Alamitos, CA, USA, 2793–2801.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini et al<span id="bib.bib9.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Nicholas Carlini, Jamie Hayes, Milad Nasr, Matthew Jagielski, Vikash Sehwag, Florian Tramèr, Borja Balle, Daphne Ippolito, and Eric Wallace. 2023.

</span>
<span class="ltx_bibblock">Extracting training data from diffusion models. In <em id="bib.bib9.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 32nd USENIX Conference on Security Symposium</em> (Anaheim, CA, USA) <em id="bib.bib9.4.2" class="ltx_emph ltx_font_italic">(SEC ’23)</em>. USENIX Association, USA, Article 294, 18 pages.

</span>
<span class="ltx_bibblock">

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span id="bib.bib10.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton. 2020.

</span>
<span class="ltx_bibblock">A simple framework for contrastive learning of visual representations. In <em id="bib.bib10.3.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>. PMLR, 1597–1607.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Coalition for Content Provenance and Authenticity (2021)</span>
<span class="ltx_bibblock">
Coalition for Content Provenance and Authenticity. 2021.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Draft Technical Specification 0.7</em>.

</span>
<span class="ltx_bibblock">Technical Report. C2PA.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://c2pa.org/public-draft/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://c2pa.org/public-draft/</a>

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks and Dimanetterich (2019)</span>
<span class="ltx_bibblock">
Dan Hendrycks and Thomas Dimanetterich. 2019.

</span>
<span class="ltx_bibblock">Benchmarking Neural Network Robustness to Common Corruptions and Perturbations.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference on Learning Representations</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al<span id="bib.bib13.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel. 2020.

</span>
<span class="ltx_bibblock">Denoising Diffusion Probabilistic Models.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2006.11239 [cs.LG]

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiralerspong et al<span id="bib.bib14.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Marco Jiralerspong, Joey Bose, Ian Gemp, Chongli Qin, Yoram Bachrach, and Gauthier Gidel. 2023.

</span>
<span class="ltx_bibblock">Feature Likelihood Score: Evaluating the Generalization of Generative Models Using Samples. In <em id="bib.bib14.3.1" class="ltx_emph ltx_font_italic">Thirty-seventh Conference on Neural Information Processing Systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky (2009)</span>
<span class="ltx_bibblock">
Alex Krizhevsky. 2009.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Learning multiple layers of features from tiny images</em>.

</span>
<span class="ltx_bibblock">Technical Report.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mann and Whitney (1947)</span>
<span class="ltx_bibblock">
Henry Berthold Mann and Donald Ransom Whitney. 1947.

</span>
<span class="ltx_bibblock">On a Test of Whether one of Two Random Variables is Stochastically Larger than the Other.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">The Annals of Mathematical Statistics</em> 18, 1 (1947), 50 – 60.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://doi.org/10.1214/aoms/1177730491" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1214/aoms/1177730491</a>

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meehan et al<span id="bib.bib17.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Casey Meehan, Kamalika Chaudhuri, and Sanjoy Dasgupta. 2020.

</span>
<span class="ltx_bibblock">A non-parametric test to detect data-copying in generative models.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.3.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and Statistics</em> (Apr 2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mugunthan et al<span id="bib.bib18.2.2.1" class="ltx_text">.</span> (2020)</span>
<span class="ltx_bibblock">
Vaikkunth Mugunthan, Ravi Rahman, and Lalana Kagal. 2020.

</span>
<span class="ltx_bibblock">BlockFLow: An Accountable and Privacy-Preserving Solution for Federated Learning.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2007.03856 [cs.LG]

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oquab et al<span id="bib.bib19.2.2.1" class="ltx_text">.</span> (2024)</span>
<span class="ltx_bibblock">
Maxime Oquab, Timothée Darcet, Théo Moutakanni, Huy V. Vo, Marc Szafraniec, Vasil Khalidov, Pierre Fernandez, Daniel HAZIZA, Francisco Massa, Alaaeldin El-Nouby, Mido Assran, Nicolas Ballas, Wojciech Galuba, Russell Howes, Po-Yao Huang, Shang-Wen Li, Ishan Misra, Michael Rabbat, Vasu Sharma, Gabriel Synnaeve, Hu Xu, Herve Jegou, Julien Mairal, Patrick Labatut, Armand Joulin, and Piotr Bojanowski. 2024.

</span>
<span class="ltx_bibblock">DINOv2: Learning Robust Visual Features without Supervision.

</span>
<span class="ltx_bibblock"><em id="bib.bib19.3.1" class="ltx_emph ltx_font_italic">Transactions on Machine Learning Research</em> (2024).

</span>
<span class="ltx_bibblock">

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramanan and Nakayama (2020)</span>
<span class="ltx_bibblock">
Paritosh Ramanan and Kiyoshi Nakayama. 2020.

</span>
<span class="ltx_bibblock">BAFFLE : Blockchain Based Aggregator Free Federated Learning. In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">2020 IEEE International Conference on Blockchain (Blockchain)</em>. IEEE Computer Society, Los Alamitos, CA, USA, 72–81.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Somepalli et al<span id="bib.bib21.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Gowthami Somepalli, Vasu Singla, Micah Goldblum, Jonas Geiping, and Tom Goldstein. 2023.

</span>
<span class="ltx_bibblock">Diffusion Art or Digital Forgery? Investigating Data Replication in Diffusion Models. In <em id="bib.bib21.3.1" class="ltx_emph ltx_font_italic">2023 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>. IEEE Computer Society, Los Alamitos, CA, USA, 6048–6058.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stein et al<span id="bib.bib22.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
George Stein, Jesse C. Cresswell, Rasa Hosseinzadeh, Yi Sui, Brendan Leigh Ross, Valentin Villecroze, Zhaoyan Liu, Anthony L. Caterini, Eric Taylor, and Gabriel Loaiza-Ganem. 2023.

</span>
<span class="ltx_bibblock">Exposing flaws of generative model evaluation metrics and their unfair treatment of diffusion models. In <em id="bib.bib22.3.1" class="ltx_emph ltx_font_italic">Thirty-seventh Conference on Neural Information Processing Systems</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tolias et al<span id="bib.bib23.2.2.1" class="ltx_text">.</span> (2016)</span>
<span class="ltx_bibblock">
Giorgos Tolias, Ronan Sicre, and Hervé Jégou. 2016.

</span>
<span class="ltx_bibblock">Particular object retrieval with integral max-pooling of CNN activations. In <em id="bib.bib23.3.1" class="ltx_emph ltx_font_italic">4th International Conference on Learning Representations, ICLR 2016, San Juan, Puerto Rico, May 2-4, 2016, Conference Track Proceedings</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tomiyama et al<span id="bib.bib24.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Eisuke Tomiyama, Hiroshi Esaki, and Hideya Ochiai. 2023.

</span>
<span class="ltx_bibblock">Competitive and Asynchronous Decentralized Federated Learning with Blockchain Smart Contracts. In <em id="bib.bib24.3.1" class="ltx_emph ltx_font_italic">Proceedings of the 2023 ACM Conference on Information Technology for Social Good</em> <em id="bib.bib24.4.2" class="ltx_emph ltx_font_italic">(GoodIT ’23)</em>. 92–99.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tun et al<span id="bib.bib25.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Ye Lin Tun, Chu Myaet Thwal, Ji Su Yoon, Sun Moo Kang, Chaoning Zhang, and Choong Seon Hong. 2023.

</span>
<span class="ltx_bibblock">Federated Learning with Diffusion Models for Privacy-Sensitive Vision Tasks.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2311.16538 [cs.LG]

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span id="bib.bib26.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Mingzhao Yang, Shangchao Su, Bin Li, and Xiangyang Xue. 2023.

</span>
<span class="ltx_bibblock">Exploring One-shot Semi-supervised Federated Learning with A Pre-trained Diffusion Model.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">arXiv:2305.04063 [cs.CV]

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yoon et al<span id="bib.bib27.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
TaeHo Yoon, Joo Young Choi, Sehyun Kwon, and Ernest K. Ryu. 2023.

</span>
<span class="ltx_bibblock">Diffusion Probabilistic Models Generalize when They Fail to Memorize. In <em id="bib.bib27.3.1" class="ltx_emph ltx_font_italic">ICML 2023 Workshop on Structured Probabilistic Inference &amp; Generative Modeling</em>.

</span>
<span class="ltx_bibblock">
<a target="_blank" href="https://openreview.net/forum?id=shciCbSk9h" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=shciCbSk9h</a>

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yun et al<span id="bib.bib28.2.2.1" class="ltx_text">.</span> (2023)</span>
<span class="ltx_bibblock">
Jian Yun, Yusheng Lu, and Xinyu Liu. 2023.

</span>
<span class="ltx_bibblock">BCAFL: A Blockchain-Based Framework for Asynchronous Federated Learning Protection.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.3.1" class="ltx_emph ltx_font_italic">Electronics</em> 12, 20 (2023).

</span>
<span class="ltx_bibblock">

<a target="_blank" href="https://www.mdpi.com/2079-9292/12/20/4214" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.mdpi.com/2079-9292/12/20/4214</a>

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al<span id="bib.bib29.2.2.1" class="ltx_text">.</span> (2024)</span>
<span class="ltx_bibblock">
Zhuang Zhao, Feng Yang, and Guirong Liang. 2024.

</span>
<span class="ltx_bibblock">Federated Learning Based on Diffusion Model to Cope with Non-IID Data. In <em id="bib.bib29.3.1" class="ltx_emph ltx_font_italic">Pattern Recognition and Computer Vision</em>. Springer Nature Singapore, Singapore, 220–231.

</span>
<span class="ltx_bibblock">

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2409.18244" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2409.18245" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2409.18245">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2409.18245" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2409.18246" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Oct  6 01:46:13 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
