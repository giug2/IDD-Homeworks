<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.06314] Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout</title><meta property="og:description" content="The label distribution skew induced data heterogeniety has been shown to be a significant obstacle that limits the model performance in federated learning, which is particularly developed for collaborative model traini…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.06314">

<!--Generated on Thu Feb 29 20:19:11 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Federated Learning,  Data Heterogeneity,  Client Dropout,  Balanced-Softmax
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jian Xu,
Meilin Yang,
Wenbo Ding, 
and Shao-Lun Huang, 

</span><span class="ltx_author_notes">Manuscript received. The research of Shao-Lun Huang is supported in part by the Shenzhen Science and Technology Program under Grant KQTD20170810150821146, National Key R&amp;D Program of China under Grant 2021YFA0715202. <span id="id1.1.id1" class="ltx_text ltx_font_italic">(Corresponding author: Shao-Lun Huang.)</span>
Jian Xu, Meilin Yang, Wenbo Ding and Shao-Lun Huang are with the Tsinghua-Berkeley Shenzhen Institute, Tsinghua Shenzhen International Graduate School, Tsinghua University, Shenzhen, China. E-mail:{xujian20, yml21}@mails.tsinghua.edu.cn; {ding.wenbo, shaolun.huang}@sz.tsinghua.edu.cn.
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">The label distribution skew induced data heterogeniety has been shown to be a significant obstacle that limits the model performance in federated learning, which is particularly developed for collaborative model training over decentralized data sources while preserving user privacy. This challenge could be more serious when the participating clients are in unstable circumstances and dropout frequently. Previous work and our empirical observations demonstrate that the classifier head for classification task is more sensitive to label skew and the unstable performance of FedAvg mainly lies in the imbalanced training samples across different classes. The biased classifier head will also impact the learning of feature representations. Therefore, maintaining a balanced classifier head is of significant importance for building a better global model. To this end, we propose a simple yet effective framework by introducing a prior-calibrated softmax function for computing the cross-entropy loss and a prototype-based feature augmentation scheme to re-balance the local training, which are lightweight for edge devices and can facilitate the global model aggregation. The improved model performance over existing baselines in the presence of non-IID data and client dropout is demonstrated by conducting extensive experiments on benchmark classification tasks.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Federated Learning, Data Heterogeneity, Client Dropout, Balanced-Softmax

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">With the rapid development of Internet of Things (IoT) and machine learning techniques, significant amounts of data are generated in every day and can benefit intelligent applications in a wide variety of scenarios, such as speech recognition, healthcare systems and smart cities <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. However, collecting data from edge devices for centralized model training causes high communication cost and serious privacy concerns, i.e., some data may contain personal and sensitive information <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. As a result, training deep learning models centrally by gathering data from user devices might be prohibited and impractical. To alleviate the above issues, it is attractive to adopt federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> to collectively train models, which can take full advantages of the local data and edge computational resources in the IoT systems. FL is a distributed computing paradigm where multiple edge devices, i.e., clients, collaboratively train a global model without disclosing local sensitive data. Conventional FL systems usually consist of a central server and a number of clients, where each client updates the model based on local data and the server is responsible for synchronizing model parameters. The primary goal of FL is to efficiently train a global model with the highest possible accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Despite the merits, FL in IoT systems could also meet with plenty of challenges due to potentially heterogeneous device capabilities and data distributions, which are also known as system heterogeneity and non-IID data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. The non-IID data in FL means the underlying distributions of local data are not identical across clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. System heterogeneity could be caused by different resource constraints, including storage, computing capability, energy and network bandwidth <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. In synchronous FL, aggregation is conducted when all the selected clients fully complete their local training and return their model updates. However, the clients could have significantly different performances in real-world scenarios, which implies that some faster clients have to wait for the slower ones, i.e., stragglers, resulting in unnecessary time-consuming. Moreover, some clients might be unresponsive due to inactive devices and/or communication failures and thus induce unavailability of some local updates, i.e., dropout. In this work, we focus on cross-device federated learning, where the participants are mostly edge devices such as smart phones and IoTs. These devices generally have limited computing and communication resources, and also have different training data distributions. Considering that federated learning typically takes a relatively large number of communication rounds to converge, it is difficult to ensure that all devices will be available or return back their local updates on time during the entire training process, leading to severe straggler and dropout issues <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To alleviate the straggler issue, FL algorithms usually perform partial participation and intermittent model aggregation after multiple local epochs as proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. In such settings, however, the non-IID data brings new challenges for model aggregation due to the high diversity of local models. As a result, the resulting global model could have poor and unstable performance during the training process <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. Moreover, it also takes more communication rounds for convergence and thus prolongs the on-clock training time. Therefore, developing FL algorithms with resilience to non-IID data and client dropout is of significant importance for fully taking advantages of scattered data generated from edge devices. Although tremendous efforts have been devoted to combating the non-IID data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, the performance is still far from being satisfactory. While many factors can lead to the data heterogeneity among clients, the label skew is demonstrated to be the main reason of model performance deterioration as it could lead to inconsistency between local objectives and global objective <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. On the other hand, previous works on centralized learning with long-tailed data and FL with class imbalance have demonstrated that the final decision layer is most vulnerable to class imbalance and will result in significant bias of decision boundaries <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. To alleviate it, several methods including weight normalization of output layer and embedding augmentation of tail classes are investigated to rectify the model training for fair performance among all classes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Inspired by those observations, we aim to train balanced classifiers during the local training stage to facilitate the global aggregation.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we focus on mitigating the label skew and client dropout issues simultaneously, with especial interest in the case where each client only contains samples from a few categories. We emphases that the partial participation of clients is not a decision by algorithms and is uncontrollable due to unexpected client dropout in our settings. We propose a novel <span id="S1.p4.1.1" class="ltx_text ltx_framed ltx_framed_underline">FL</span> framework with <span id="S1.p4.1.2" class="ltx_text ltx_framed ltx_framed_underline">Re</span>-<span id="S1.p4.1.3" class="ltx_text ltx_framed ltx_framed_underline">Ba</span>lanced local classifier training (ReBaFL) that not only learns from the local data but also preserves the global knowledge. To be more specific, we propose a relaxed version of prior-calibrated softmax function and a prototype-based feature augmentation scheme in local training to reduce the bias of local models, thus benefiting the aggregated global model. The proposed framework is evaluated on benchmark datasets with extensive experiments and the effectiveness in stabilizing the federated learning process is verified. Numerical results demonstrate that non-trivial improvements in test accuracy could be achieved, despite highly skewed label distributions across clients and severe client dropout. To sum up, this work makes the following contributions:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">A novel FL framework with label prior calibrated local training is developed for alleviating catastrophic forgetting when clients only observe limited labels.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">A prototype-based feature augmentation scheme is employed to speed up the model convergence. Feature inverse attacks are also evaluated to indicate that using feature prototypes will not violate data privacy.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">The efficacy and superiority of our proposed method are verified on benchmark datasets with various levels of non-IID data and client dropout.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The rest of the paper is organized as follows. Section <a href="#S2" title="2 Related Work ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> reviews the related works. The background and motivation are introduced in Section <a href="#S3" title="3 Preliminary and Motivation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The design of our framework is elaborated and evaluated in Section <a href="#S4" title="4 Our Proposed Framework ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and Section <a href="#S5" title="5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, respectively. Finally, Section <a href="#S6" title="6 Conclusion ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> concludes this paper.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span><span id="S2.SS1.1.1" class="ltx_text ltx_font_italic">Federated Learning with Non-IID Data</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">The non-IID data issue has attained significant attentions since the emergence of FL. A number of studies focus on improving the optimization algorithms by designing various regularization terms <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and gradient correction schemes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. For instance, FedDP <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> leverages the augmented Lagrangian approach to seek consensus in local updates. FedCM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> introduces a client-side momentum to debias the local gradient direction. Data re-sampling and re-weighting techniques could also be applied to seek a class-balanced model training thus improve the global performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. However, this type of approaches are invalid when samples from certain classes are totally missing. Besides, data sharing and augmentation methods are also extensively investigated to mitigate the non-IID data challenges <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. From the perspective of client selection, sampling clients with high contributions to model performance is able to speed up the convergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. However, the server either needs prior knowledge about the clients or should record the statistical behaviors of each client to decide the selection strategy, which could be impractical or induce additional computation costs to the server. When auxiliary data is available at the server or generative model is trained, knowledge distillation approaches can be employed to obtain a more refined global model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. Another line of work attempts to overcome data heterogeneity by developing personalized FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> or clustered FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. Different from the previous works, this paper aims to improve the algorithm robustness in the presence of both data heterogeneity and device unavailability.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span><span id="S2.SS2.1.1" class="ltx_text ltx_font_italic">Tackling System Heterogeneity in FL</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Another performance bottleneck faced by FL is the heterogeneous computing capacity and network bandwidth of clients. The straggler issue is caused by the delayed or lost uploading due to system heterogeneity. Existing solutions choose to perform partial client participation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> or allow clients to upload their local models asynchronously to the server <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>. A straggler-resilient FL is proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite> that incorporates statistical characteristics of the local training data to actively select clients. An adaptive client sampling scheme is proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite> to simultaneously tackle the system and statistical heterogeneity. Another line of work aims at dynamically adjusting the local workload according to the device capabilities by changing local batch size and local epochs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>. Client dropout is a more serious problem than stragglers since dropped clients simply have nothing to upload in the current round and can remain unavailable for a relatively long period. Hence, existing solutions for stragglers do not work well for this special issue. Some studies propose re-weighting aggregation rules or variance reduction methods to compensate the missing updates <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Preliminary and Motivation</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span><span id="S3.SS1.1.1" class="ltx_text ltx_font_italic">Problem Formulation for Federated Learning</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">A typical implementation of FL system includes a cloud server that maintains a global model and multiple participating clients that communicate with the server through a network. We assume that there are <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">m</annotation></semantics></math> clients that collectively train a global model under the coordination of cloud server without uploading private data. Mathematically, the learning task could be formalized as the following optimization problem:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.7" class="ltx_Math" alttext="\min_{\bm{w}}{L({\bm{w}})}=\sum_{i=1}^{m}\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}\underbrace{\mathbb{E}_{\xi_{i}\sim\mathcal{D}_{i}}\left[L_{i}(\bm{w};\xi_{i})\right]}_{:=L_{i}(\bm{w})}," display="block"><semantics id="S3.E1.m1.7a"><mrow id="S3.E1.m1.7.7.1" xref="S3.E1.m1.7.7.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1" xref="S3.E1.m1.7.7.1.1.cmml"><mrow id="S3.E1.m1.7.7.1.1.2" xref="S3.E1.m1.7.7.1.1.2.cmml"><mrow id="S3.E1.m1.7.7.1.1.2.2" xref="S3.E1.m1.7.7.1.1.2.2.cmml"><munder id="S3.E1.m1.7.7.1.1.2.2.1" xref="S3.E1.m1.7.7.1.1.2.2.1.cmml"><mi id="S3.E1.m1.7.7.1.1.2.2.1.2" xref="S3.E1.m1.7.7.1.1.2.2.1.2.cmml">min</mi><mi id="S3.E1.m1.7.7.1.1.2.2.1.3" xref="S3.E1.m1.7.7.1.1.2.2.1.3.cmml">𝒘</mi></munder><mo lspace="0.167em" id="S3.E1.m1.7.7.1.1.2.2a" xref="S3.E1.m1.7.7.1.1.2.2.cmml">⁡</mo><mi id="S3.E1.m1.7.7.1.1.2.2.2" xref="S3.E1.m1.7.7.1.1.2.2.2.cmml">L</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.2.1" xref="S3.E1.m1.7.7.1.1.2.1.cmml">​</mo><mrow id="S3.E1.m1.7.7.1.1.2.3.2" xref="S3.E1.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.3.2.1" xref="S3.E1.m1.7.7.1.1.2.cmml">(</mo><mi id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml">𝒘</mi><mo stretchy="false" id="S3.E1.m1.7.7.1.1.2.3.2.2" xref="S3.E1.m1.7.7.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E1.m1.7.7.1.1.1" xref="S3.E1.m1.7.7.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.7.7.1.1.3" xref="S3.E1.m1.7.7.1.1.3.cmml"><munderover id="S3.E1.m1.7.7.1.1.3.1" xref="S3.E1.m1.7.7.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.7.7.1.1.3.1.2.2" xref="S3.E1.m1.7.7.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.7.7.1.1.3.1.2.3" xref="S3.E1.m1.7.7.1.1.3.1.2.3.cmml"><mi id="S3.E1.m1.7.7.1.1.3.1.2.3.2" xref="S3.E1.m1.7.7.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.7.7.1.1.3.1.2.3.1" xref="S3.E1.m1.7.7.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.7.7.1.1.3.1.2.3.3" xref="S3.E1.m1.7.7.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.7.7.1.1.3.1.3" xref="S3.E1.m1.7.7.1.1.3.1.3.cmml">m</mi></munderover><mrow id="S3.E1.m1.7.7.1.1.3.2" xref="S3.E1.m1.7.7.1.1.3.2.cmml"><mfrac id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo><msub id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.3.1" xref="S3.E1.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.1" xref="S3.E1.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E1.m1.2.2.2.3.2" xref="S3.E1.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.3.2.1" xref="S3.E1.m1.7.7.1.1.3.2.1.cmml">​</mo><munder id="S3.E1.m1.7.7.1.1.3.2.2" xref="S3.E1.m1.7.7.1.1.3.2.2.cmml"><munder accentunder="true" id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.4.4.2" xref="S3.E1.m1.4.4.2.cmml"><msub id="S3.E1.m1.4.4.2.4" xref="S3.E1.m1.4.4.2.4.cmml"><mi id="S3.E1.m1.4.4.2.4.2" xref="S3.E1.m1.4.4.2.4.2.cmml">𝔼</mi><mrow id="S3.E1.m1.4.4.2.4.3" xref="S3.E1.m1.4.4.2.4.3.cmml"><msub id="S3.E1.m1.4.4.2.4.3.2" xref="S3.E1.m1.4.4.2.4.3.2.cmml"><mi id="S3.E1.m1.4.4.2.4.3.2.2" xref="S3.E1.m1.4.4.2.4.3.2.2.cmml">ξ</mi><mi id="S3.E1.m1.4.4.2.4.3.2.3" xref="S3.E1.m1.4.4.2.4.3.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.4.4.2.4.3.1" xref="S3.E1.m1.4.4.2.4.3.1.cmml">∼</mo><msub id="S3.E1.m1.4.4.2.4.3.3" xref="S3.E1.m1.4.4.2.4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4.2.4.3.3.2" xref="S3.E1.m1.4.4.2.4.3.3.2.cmml">𝒟</mi><mi id="S3.E1.m1.4.4.2.4.3.3.3" xref="S3.E1.m1.4.4.2.4.3.3.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.2.3" xref="S3.E1.m1.4.4.2.3.cmml">​</mo><mrow id="S3.E1.m1.4.4.2.2.1" xref="S3.E1.m1.4.4.2.2.2.cmml"><mo id="S3.E1.m1.4.4.2.2.1.2" xref="S3.E1.m1.4.4.2.2.2.1.cmml">[</mo><mrow id="S3.E1.m1.4.4.2.2.1.1" xref="S3.E1.m1.4.4.2.2.1.1.cmml"><msub id="S3.E1.m1.4.4.2.2.1.1.3" xref="S3.E1.m1.4.4.2.2.1.1.3.cmml"><mi id="S3.E1.m1.4.4.2.2.1.1.3.2" xref="S3.E1.m1.4.4.2.2.1.1.3.2.cmml">L</mi><mi id="S3.E1.m1.4.4.2.2.1.1.3.3" xref="S3.E1.m1.4.4.2.2.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.2.2.1.1.2" xref="S3.E1.m1.4.4.2.2.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.4.4.2.2.1.1.1.1" xref="S3.E1.m1.4.4.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.2.2.1.1.1.1.2" xref="S3.E1.m1.4.4.2.2.1.1.1.2.cmml">(</mo><mi id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml">𝒘</mi><mo id="S3.E1.m1.4.4.2.2.1.1.1.1.3" xref="S3.E1.m1.4.4.2.2.1.1.1.2.cmml">;</mo><msub id="S3.E1.m1.4.4.2.2.1.1.1.1.1" xref="S3.E1.m1.4.4.2.2.1.1.1.1.1.cmml"><mi id="S3.E1.m1.4.4.2.2.1.1.1.1.1.2" xref="S3.E1.m1.4.4.2.2.1.1.1.1.1.2.cmml">ξ</mi><mi id="S3.E1.m1.4.4.2.2.1.1.1.1.1.3" xref="S3.E1.m1.4.4.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.4.4.2.2.1.1.1.1.4" xref="S3.E1.m1.4.4.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.2.2.1.3" xref="S3.E1.m1.4.4.2.2.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E1.m1.4.4.3" xref="S3.E1.m1.4.4.3.cmml">⏟</mo></munder><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.cmml"><mi id="S3.E1.m1.5.5.1.3" xref="S3.E1.m1.5.5.1.3.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.2.cmml">:=</mo><mrow id="S3.E1.m1.5.5.1.4" xref="S3.E1.m1.5.5.1.4.cmml"><msub id="S3.E1.m1.5.5.1.4.2" xref="S3.E1.m1.5.5.1.4.2.cmml"><mi id="S3.E1.m1.5.5.1.4.2.2" xref="S3.E1.m1.5.5.1.4.2.2.cmml">L</mi><mi id="S3.E1.m1.5.5.1.4.2.3" xref="S3.E1.m1.5.5.1.4.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.4.1" xref="S3.E1.m1.5.5.1.4.1.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.4.3.2" xref="S3.E1.m1.5.5.1.4.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.4.3.2.1" xref="S3.E1.m1.5.5.1.4.cmml">(</mo><mi id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml">𝒘</mi><mo stretchy="false" id="S3.E1.m1.5.5.1.4.3.2.2" xref="S3.E1.m1.5.5.1.4.cmml">)</mo></mrow></mrow></mrow></munder></mrow></mrow></mrow><mo id="S3.E1.m1.7.7.1.2" xref="S3.E1.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.7b"><apply id="S3.E1.m1.7.7.1.1.cmml" xref="S3.E1.m1.7.7.1"><eq id="S3.E1.m1.7.7.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1"></eq><apply id="S3.E1.m1.7.7.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2"><times id="S3.E1.m1.7.7.1.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.2.1"></times><apply id="S3.E1.m1.7.7.1.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2"><apply id="S3.E1.m1.7.7.1.1.2.2.1.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.2.2.1.1.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1">subscript</csymbol><min id="S3.E1.m1.7.7.1.1.2.2.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.2"></min><ci id="S3.E1.m1.7.7.1.1.2.2.1.3.cmml" xref="S3.E1.m1.7.7.1.1.2.2.1.3">𝒘</ci></apply><ci id="S3.E1.m1.7.7.1.1.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.2.2.2">𝐿</ci></apply><ci id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6">𝒘</ci></apply><apply id="S3.E1.m1.7.7.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.3"><apply id="S3.E1.m1.7.7.1.1.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.1.1.cmml" xref="S3.E1.m1.7.7.1.1.3.1">superscript</csymbol><apply id="S3.E1.m1.7.7.1.1.3.1.2.cmml" xref="S3.E1.m1.7.7.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.1">subscript</csymbol><sum id="S3.E1.m1.7.7.1.1.3.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.1.2.2"></sum><apply id="S3.E1.m1.7.7.1.1.3.1.2.3.cmml" xref="S3.E1.m1.7.7.1.1.3.1.2.3"><eq id="S3.E1.m1.7.7.1.1.3.1.2.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3.1.2.3.1"></eq><ci id="S3.E1.m1.7.7.1.1.3.1.2.3.2.cmml" xref="S3.E1.m1.7.7.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.7.7.1.1.3.1.2.3.3.cmml" xref="S3.E1.m1.7.7.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.7.7.1.1.3.1.3.cmml" xref="S3.E1.m1.7.7.1.1.3.1.3">𝑚</ci></apply><apply id="S3.E1.m1.7.7.1.1.3.2.cmml" xref="S3.E1.m1.7.7.1.1.3.2"><times id="S3.E1.m1.7.7.1.1.3.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.2.1"></times><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><divide id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2"></divide><apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1"><abs id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2"></abs><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.3"><abs id="S3.E1.m1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.3.1"></abs><ci id="S3.E1.m1.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="S3.E1.m1.7.7.1.1.3.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.2.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.2.2">subscript</csymbol><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><ci id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4.3">⏟</ci><apply id="S3.E1.m1.4.4.2.cmml" xref="S3.E1.m1.4.4.2"><times id="S3.E1.m1.4.4.2.3.cmml" xref="S3.E1.m1.4.4.2.3"></times><apply id="S3.E1.m1.4.4.2.4.cmml" xref="S3.E1.m1.4.4.2.4"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.4.1.cmml" xref="S3.E1.m1.4.4.2.4">subscript</csymbol><ci id="S3.E1.m1.4.4.2.4.2.cmml" xref="S3.E1.m1.4.4.2.4.2">𝔼</ci><apply id="S3.E1.m1.4.4.2.4.3.cmml" xref="S3.E1.m1.4.4.2.4.3"><csymbol cd="latexml" id="S3.E1.m1.4.4.2.4.3.1.cmml" xref="S3.E1.m1.4.4.2.4.3.1">similar-to</csymbol><apply id="S3.E1.m1.4.4.2.4.3.2.cmml" xref="S3.E1.m1.4.4.2.4.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.4.3.2.1.cmml" xref="S3.E1.m1.4.4.2.4.3.2">subscript</csymbol><ci id="S3.E1.m1.4.4.2.4.3.2.2.cmml" xref="S3.E1.m1.4.4.2.4.3.2.2">𝜉</ci><ci id="S3.E1.m1.4.4.2.4.3.2.3.cmml" xref="S3.E1.m1.4.4.2.4.3.2.3">𝑖</ci></apply><apply id="S3.E1.m1.4.4.2.4.3.3.cmml" xref="S3.E1.m1.4.4.2.4.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.4.3.3.1.cmml" xref="S3.E1.m1.4.4.2.4.3.3">subscript</csymbol><ci id="S3.E1.m1.4.4.2.4.3.3.2.cmml" xref="S3.E1.m1.4.4.2.4.3.3.2">𝒟</ci><ci id="S3.E1.m1.4.4.2.4.3.3.3.cmml" xref="S3.E1.m1.4.4.2.4.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E1.m1.4.4.2.2.2.cmml" xref="S3.E1.m1.4.4.2.2.1"><csymbol cd="latexml" id="S3.E1.m1.4.4.2.2.2.1.cmml" xref="S3.E1.m1.4.4.2.2.1.2">delimited-[]</csymbol><apply id="S3.E1.m1.4.4.2.2.1.1.cmml" xref="S3.E1.m1.4.4.2.2.1.1"><times id="S3.E1.m1.4.4.2.2.1.1.2.cmml" xref="S3.E1.m1.4.4.2.2.1.1.2"></times><apply id="S3.E1.m1.4.4.2.2.1.1.3.cmml" xref="S3.E1.m1.4.4.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.2.1.1.3.1.cmml" xref="S3.E1.m1.4.4.2.2.1.1.3">subscript</csymbol><ci id="S3.E1.m1.4.4.2.2.1.1.3.2.cmml" xref="S3.E1.m1.4.4.2.2.1.1.3.2">𝐿</ci><ci id="S3.E1.m1.4.4.2.2.1.1.3.3.cmml" xref="S3.E1.m1.4.4.2.2.1.1.3.3">𝑖</ci></apply><list id="S3.E1.m1.4.4.2.2.1.1.1.2.cmml" xref="S3.E1.m1.4.4.2.2.1.1.1.1"><ci id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1">𝒘</ci><apply id="S3.E1.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.2.2.1.1.1.1.1.2">𝜉</ci><ci id="S3.E1.m1.4.4.2.2.1.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.2.2.1.1.1.1.1.3">𝑖</ci></apply></list></apply></apply></apply></apply><apply id="S3.E1.m1.5.5.1.cmml" xref="S3.E1.m1.5.5.1"><csymbol cd="latexml" id="S3.E1.m1.5.5.1.2.cmml" xref="S3.E1.m1.5.5.1.2">assign</csymbol><csymbol cd="latexml" id="S3.E1.m1.5.5.1.3.cmml" xref="S3.E1.m1.5.5.1.3">absent</csymbol><apply id="S3.E1.m1.5.5.1.4.cmml" xref="S3.E1.m1.5.5.1.4"><times id="S3.E1.m1.5.5.1.4.1.cmml" xref="S3.E1.m1.5.5.1.4.1"></times><apply id="S3.E1.m1.5.5.1.4.2.cmml" xref="S3.E1.m1.5.5.1.4.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.4.2.1.cmml" xref="S3.E1.m1.5.5.1.4.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.4.2.2.cmml" xref="S3.E1.m1.5.5.1.4.2.2">𝐿</ci><ci id="S3.E1.m1.5.5.1.4.2.3.cmml" xref="S3.E1.m1.5.5.1.4.2.3">𝑖</ci></apply><ci id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1.1">𝒘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.7c">\min_{\bm{w}}{L({\bm{w}})}=\sum_{i=1}^{m}\frac{|\mathcal{D}_{i}|}{|\mathcal{D}|}\underbrace{\mathbb{E}_{\xi_{i}\sim\mathcal{D}_{i}}\left[L_{i}(\bm{w};\xi_{i})\right]}_{:=L_{i}(\bm{w})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.15" class="ltx_p">where <math id="S3.SS1.p1.2.m1.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p1.2.m1.1a"><msub id="S3.SS1.p1.2.m1.1.1" xref="S3.SS1.p1.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m1.1.1.2" xref="S3.SS1.p1.2.m1.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.2.m1.1.1.3" xref="S3.SS1.p1.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m1.1b"><apply id="S3.SS1.p1.2.m1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m1.1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m1.1.1.2.cmml" xref="S3.SS1.p1.2.m1.1.1.2">𝒟</ci><ci id="S3.SS1.p1.2.m1.1.1.3.cmml" xref="S3.SS1.p1.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m1.1c">\mathcal{D}_{i}</annotation></semantics></math> is the local data set following an underlying distribution <math id="S3.SS1.p1.3.m2.2" class="ltx_Math" alttext="\mathcal{P}_{i}(X,Y)" display="inline"><semantics id="S3.SS1.p1.3.m2.2a"><mrow id="S3.SS1.p1.3.m2.2.3" xref="S3.SS1.p1.3.m2.2.3.cmml"><msub id="S3.SS1.p1.3.m2.2.3.2" xref="S3.SS1.p1.3.m2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m2.2.3.2.2" xref="S3.SS1.p1.3.m2.2.3.2.2.cmml">𝒫</mi><mi id="S3.SS1.p1.3.m2.2.3.2.3" xref="S3.SS1.p1.3.m2.2.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.3.m2.2.3.1" xref="S3.SS1.p1.3.m2.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.3.m2.2.3.3.2" xref="S3.SS1.p1.3.m2.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m2.2.3.3.2.1" xref="S3.SS1.p1.3.m2.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.3.m2.1.1" xref="S3.SS1.p1.3.m2.1.1.cmml">X</mi><mo id="S3.SS1.p1.3.m2.2.3.3.2.2" xref="S3.SS1.p1.3.m2.2.3.3.1.cmml">,</mo><mi id="S3.SS1.p1.3.m2.2.2" xref="S3.SS1.p1.3.m2.2.2.cmml">Y</mi><mo stretchy="false" id="S3.SS1.p1.3.m2.2.3.3.2.3" xref="S3.SS1.p1.3.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m2.2b"><apply id="S3.SS1.p1.3.m2.2.3.cmml" xref="S3.SS1.p1.3.m2.2.3"><times id="S3.SS1.p1.3.m2.2.3.1.cmml" xref="S3.SS1.p1.3.m2.2.3.1"></times><apply id="S3.SS1.p1.3.m2.2.3.2.cmml" xref="S3.SS1.p1.3.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m2.2.3.2.1.cmml" xref="S3.SS1.p1.3.m2.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.3.m2.2.3.2.2.cmml" xref="S3.SS1.p1.3.m2.2.3.2.2">𝒫</ci><ci id="S3.SS1.p1.3.m2.2.3.2.3.cmml" xref="S3.SS1.p1.3.m2.2.3.2.3">𝑖</ci></apply><interval closure="open" id="S3.SS1.p1.3.m2.2.3.3.1.cmml" xref="S3.SS1.p1.3.m2.2.3.3.2"><ci id="S3.SS1.p1.3.m2.1.1.cmml" xref="S3.SS1.p1.3.m2.1.1">𝑋</ci><ci id="S3.SS1.p1.3.m2.2.2.cmml" xref="S3.SS1.p1.3.m2.2.2">𝑌</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m2.2c">\mathcal{P}_{i}(X,Y)</annotation></semantics></math> on <math id="S3.SS1.p1.4.m3.1" class="ltx_Math" alttext="\mathcal{X}\times\mathcal{Y}" display="inline"><semantics id="S3.SS1.p1.4.m3.1a"><mrow id="S3.SS1.p1.4.m3.1.1" xref="S3.SS1.p1.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m3.1.1.2" xref="S3.SS1.p1.4.m3.1.1.2.cmml">𝒳</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.4.m3.1.1.1" xref="S3.SS1.p1.4.m3.1.1.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m3.1.1.3" xref="S3.SS1.p1.4.m3.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m3.1b"><apply id="S3.SS1.p1.4.m3.1.1.cmml" xref="S3.SS1.p1.4.m3.1.1"><times id="S3.SS1.p1.4.m3.1.1.1.cmml" xref="S3.SS1.p1.4.m3.1.1.1"></times><ci id="S3.SS1.p1.4.m3.1.1.2.cmml" xref="S3.SS1.p1.4.m3.1.1.2">𝒳</ci><ci id="S3.SS1.p1.4.m3.1.1.3.cmml" xref="S3.SS1.p1.4.m3.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m3.1c">\mathcal{X}\times\mathcal{Y}</annotation></semantics></math>, where <math id="S3.SS1.p1.5.m4.1" class="ltx_Math" alttext="\mathcal{X}" display="inline"><semantics id="S3.SS1.p1.5.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m4.1.1" xref="S3.SS1.p1.5.m4.1.1.cmml">𝒳</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m4.1b"><ci id="S3.SS1.p1.5.m4.1.1.cmml" xref="S3.SS1.p1.5.m4.1.1">𝒳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m4.1c">\mathcal{X}</annotation></semantics></math> is the input space and <math id="S3.SS1.p1.6.m5.1" class="ltx_math_unparsed" alttext="\mathcal{Y}=\{1,..,C\}" display="inline"><semantics id="S3.SS1.p1.6.m5.1a"><mrow id="S3.SS1.p1.6.m5.1b"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m5.1.1">𝒴</mi><mo id="S3.SS1.p1.6.m5.1.2">=</mo><mrow id="S3.SS1.p1.6.m5.1.3"><mo stretchy="false" id="S3.SS1.p1.6.m5.1.3.1">{</mo><mn id="S3.SS1.p1.6.m5.1.3.2">1</mn><mo id="S3.SS1.p1.6.m5.1.3.3">,</mo><mo lspace="0em" rspace="0.0835em" id="S3.SS1.p1.6.m5.1.3.4">.</mo><mo lspace="0.0835em" rspace="0.167em" id="S3.SS1.p1.6.m5.1.3.5">.</mo><mo id="S3.SS1.p1.6.m5.1.3.6">,</mo><mi id="S3.SS1.p1.6.m5.1.3.7">C</mi><mo stretchy="false" id="S3.SS1.p1.6.m5.1.3.8">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m5.1c">\mathcal{Y}=\{1,..,C\}</annotation></semantics></math> is the label space. <math id="S3.SS1.p1.7.m6.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS1.p1.7.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m6.1.1" xref="S3.SS1.p1.7.m6.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m6.1b"><ci id="S3.SS1.p1.7.m6.1.1.cmml" xref="S3.SS1.p1.7.m6.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m6.1c">\mathcal{D}</annotation></semantics></math> denotes the collection of all local training data. It is worth noting that generally we have <math id="S3.SS1.p1.8.m7.1" class="ltx_Math" alttext="\mathcal{P}_{i}\neq\mathcal{P}_{j}" display="inline"><semantics id="S3.SS1.p1.8.m7.1a"><mrow id="S3.SS1.p1.8.m7.1.1" xref="S3.SS1.p1.8.m7.1.1.cmml"><msub id="S3.SS1.p1.8.m7.1.1.2" xref="S3.SS1.p1.8.m7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m7.1.1.2.2" xref="S3.SS1.p1.8.m7.1.1.2.2.cmml">𝒫</mi><mi id="S3.SS1.p1.8.m7.1.1.2.3" xref="S3.SS1.p1.8.m7.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.8.m7.1.1.1" xref="S3.SS1.p1.8.m7.1.1.1.cmml">≠</mo><msub id="S3.SS1.p1.8.m7.1.1.3" xref="S3.SS1.p1.8.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m7.1.1.3.2" xref="S3.SS1.p1.8.m7.1.1.3.2.cmml">𝒫</mi><mi id="S3.SS1.p1.8.m7.1.1.3.3" xref="S3.SS1.p1.8.m7.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m7.1b"><apply id="S3.SS1.p1.8.m7.1.1.cmml" xref="S3.SS1.p1.8.m7.1.1"><neq id="S3.SS1.p1.8.m7.1.1.1.cmml" xref="S3.SS1.p1.8.m7.1.1.1"></neq><apply id="S3.SS1.p1.8.m7.1.1.2.cmml" xref="S3.SS1.p1.8.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m7.1.1.2.1.cmml" xref="S3.SS1.p1.8.m7.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.8.m7.1.1.2.2.cmml" xref="S3.SS1.p1.8.m7.1.1.2.2">𝒫</ci><ci id="S3.SS1.p1.8.m7.1.1.2.3.cmml" xref="S3.SS1.p1.8.m7.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.8.m7.1.1.3.cmml" xref="S3.SS1.p1.8.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m7.1.1.3.1.cmml" xref="S3.SS1.p1.8.m7.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.8.m7.1.1.3.2.cmml" xref="S3.SS1.p1.8.m7.1.1.3.2">𝒫</ci><ci id="S3.SS1.p1.8.m7.1.1.3.3.cmml" xref="S3.SS1.p1.8.m7.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m7.1c">\mathcal{P}_{i}\neq\mathcal{P}_{j}</annotation></semantics></math> for different client <math id="S3.SS1.p1.9.m8.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.9.m8.1a"><mi id="S3.SS1.p1.9.m8.1.1" xref="S3.SS1.p1.9.m8.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m8.1b"><ci id="S3.SS1.p1.9.m8.1.1.cmml" xref="S3.SS1.p1.9.m8.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m8.1c">i</annotation></semantics></math> and <math id="S3.SS1.p1.10.m9.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.SS1.p1.10.m9.1a"><mi id="S3.SS1.p1.10.m9.1.1" xref="S3.SS1.p1.10.m9.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m9.1b"><ci id="S3.SS1.p1.10.m9.1.1.cmml" xref="S3.SS1.p1.10.m9.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m9.1c">j</annotation></semantics></math> in FL. <math id="S3.SS1.p1.11.m10.2" class="ltx_Math" alttext="L_{i}(\bm{w}_{i};\xi_{i})" display="inline"><semantics id="S3.SS1.p1.11.m10.2a"><mrow id="S3.SS1.p1.11.m10.2.2" xref="S3.SS1.p1.11.m10.2.2.cmml"><msub id="S3.SS1.p1.11.m10.2.2.4" xref="S3.SS1.p1.11.m10.2.2.4.cmml"><mi id="S3.SS1.p1.11.m10.2.2.4.2" xref="S3.SS1.p1.11.m10.2.2.4.2.cmml">L</mi><mi id="S3.SS1.p1.11.m10.2.2.4.3" xref="S3.SS1.p1.11.m10.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.11.m10.2.2.3" xref="S3.SS1.p1.11.m10.2.2.3.cmml">​</mo><mrow id="S3.SS1.p1.11.m10.2.2.2.2" xref="S3.SS1.p1.11.m10.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.11.m10.2.2.2.2.3" xref="S3.SS1.p1.11.m10.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p1.11.m10.1.1.1.1.1" xref="S3.SS1.p1.11.m10.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.11.m10.1.1.1.1.1.2" xref="S3.SS1.p1.11.m10.1.1.1.1.1.2.cmml">𝒘</mi><mi id="S3.SS1.p1.11.m10.1.1.1.1.1.3" xref="S3.SS1.p1.11.m10.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.11.m10.2.2.2.2.4" xref="S3.SS1.p1.11.m10.2.2.2.3.cmml">;</mo><msub id="S3.SS1.p1.11.m10.2.2.2.2.2" xref="S3.SS1.p1.11.m10.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.11.m10.2.2.2.2.2.2" xref="S3.SS1.p1.11.m10.2.2.2.2.2.2.cmml">ξ</mi><mi id="S3.SS1.p1.11.m10.2.2.2.2.2.3" xref="S3.SS1.p1.11.m10.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.11.m10.2.2.2.2.5" xref="S3.SS1.p1.11.m10.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m10.2b"><apply id="S3.SS1.p1.11.m10.2.2.cmml" xref="S3.SS1.p1.11.m10.2.2"><times id="S3.SS1.p1.11.m10.2.2.3.cmml" xref="S3.SS1.p1.11.m10.2.2.3"></times><apply id="S3.SS1.p1.11.m10.2.2.4.cmml" xref="S3.SS1.p1.11.m10.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m10.2.2.4.1.cmml" xref="S3.SS1.p1.11.m10.2.2.4">subscript</csymbol><ci id="S3.SS1.p1.11.m10.2.2.4.2.cmml" xref="S3.SS1.p1.11.m10.2.2.4.2">𝐿</ci><ci id="S3.SS1.p1.11.m10.2.2.4.3.cmml" xref="S3.SS1.p1.11.m10.2.2.4.3">𝑖</ci></apply><list id="S3.SS1.p1.11.m10.2.2.2.3.cmml" xref="S3.SS1.p1.11.m10.2.2.2.2"><apply id="S3.SS1.p1.11.m10.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m10.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.11.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m10.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.11.m10.1.1.1.1.1.2">𝒘</ci><ci id="S3.SS1.p1.11.m10.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.11.m10.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.11.m10.2.2.2.2.2.cmml" xref="S3.SS1.p1.11.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m10.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.11.m10.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.11.m10.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.11.m10.2.2.2.2.2.2">𝜉</ci><ci id="S3.SS1.p1.11.m10.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.11.m10.2.2.2.2.2.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m10.2c">L_{i}(\bm{w}_{i};\xi_{i})</annotation></semantics></math> denotes the local risk given model parameter <math id="S3.SS1.p1.12.m11.1" class="ltx_Math" alttext="\bm{w}" display="inline"><semantics id="S3.SS1.p1.12.m11.1a"><mi id="S3.SS1.p1.12.m11.1.1" xref="S3.SS1.p1.12.m11.1.1.cmml">𝒘</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m11.1b"><ci id="S3.SS1.p1.12.m11.1.1.cmml" xref="S3.SS1.p1.12.m11.1.1">𝒘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m11.1c">\bm{w}</annotation></semantics></math> and data point <math id="S3.SS1.p1.13.m12.2" class="ltx_Math" alttext="\xi_{i}=(x_{i},y_{i})" display="inline"><semantics id="S3.SS1.p1.13.m12.2a"><mrow id="S3.SS1.p1.13.m12.2.2" xref="S3.SS1.p1.13.m12.2.2.cmml"><msub id="S3.SS1.p1.13.m12.2.2.4" xref="S3.SS1.p1.13.m12.2.2.4.cmml"><mi id="S3.SS1.p1.13.m12.2.2.4.2" xref="S3.SS1.p1.13.m12.2.2.4.2.cmml">ξ</mi><mi id="S3.SS1.p1.13.m12.2.2.4.3" xref="S3.SS1.p1.13.m12.2.2.4.3.cmml">i</mi></msub><mo id="S3.SS1.p1.13.m12.2.2.3" xref="S3.SS1.p1.13.m12.2.2.3.cmml">=</mo><mrow id="S3.SS1.p1.13.m12.2.2.2.2" xref="S3.SS1.p1.13.m12.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.13.m12.2.2.2.2.3" xref="S3.SS1.p1.13.m12.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p1.13.m12.1.1.1.1.1" xref="S3.SS1.p1.13.m12.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.13.m12.1.1.1.1.1.2" xref="S3.SS1.p1.13.m12.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS1.p1.13.m12.1.1.1.1.1.3" xref="S3.SS1.p1.13.m12.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.13.m12.2.2.2.2.4" xref="S3.SS1.p1.13.m12.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.13.m12.2.2.2.2.2" xref="S3.SS1.p1.13.m12.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.13.m12.2.2.2.2.2.2" xref="S3.SS1.p1.13.m12.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p1.13.m12.2.2.2.2.2.3" xref="S3.SS1.p1.13.m12.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.13.m12.2.2.2.2.5" xref="S3.SS1.p1.13.m12.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m12.2b"><apply id="S3.SS1.p1.13.m12.2.2.cmml" xref="S3.SS1.p1.13.m12.2.2"><eq id="S3.SS1.p1.13.m12.2.2.3.cmml" xref="S3.SS1.p1.13.m12.2.2.3"></eq><apply id="S3.SS1.p1.13.m12.2.2.4.cmml" xref="S3.SS1.p1.13.m12.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m12.2.2.4.1.cmml" xref="S3.SS1.p1.13.m12.2.2.4">subscript</csymbol><ci id="S3.SS1.p1.13.m12.2.2.4.2.cmml" xref="S3.SS1.p1.13.m12.2.2.4.2">𝜉</ci><ci id="S3.SS1.p1.13.m12.2.2.4.3.cmml" xref="S3.SS1.p1.13.m12.2.2.4.3">𝑖</ci></apply><interval closure="open" id="S3.SS1.p1.13.m12.2.2.2.3.cmml" xref="S3.SS1.p1.13.m12.2.2.2.2"><apply id="S3.SS1.p1.13.m12.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m12.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.13.m12.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m12.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.13.m12.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p1.13.m12.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.13.m12.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.13.m12.2.2.2.2.2.cmml" xref="S3.SS1.p1.13.m12.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m12.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.13.m12.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.13.m12.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.13.m12.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.13.m12.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.13.m12.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m12.2c">\xi_{i}=(x_{i},y_{i})</annotation></semantics></math>, where <math id="S3.SS1.p1.14.m13.2" class="ltx_Math" alttext="L_{i}(\cdot;\cdot)" display="inline"><semantics id="S3.SS1.p1.14.m13.2a"><mrow id="S3.SS1.p1.14.m13.2.3" xref="S3.SS1.p1.14.m13.2.3.cmml"><msub id="S3.SS1.p1.14.m13.2.3.2" xref="S3.SS1.p1.14.m13.2.3.2.cmml"><mi id="S3.SS1.p1.14.m13.2.3.2.2" xref="S3.SS1.p1.14.m13.2.3.2.2.cmml">L</mi><mi id="S3.SS1.p1.14.m13.2.3.2.3" xref="S3.SS1.p1.14.m13.2.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m13.2.3.1" xref="S3.SS1.p1.14.m13.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.14.m13.2.3.3.2" xref="S3.SS1.p1.14.m13.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.14.m13.2.3.3.2.1" xref="S3.SS1.p1.14.m13.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m13.1.1" xref="S3.SS1.p1.14.m13.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS1.p1.14.m13.2.3.3.2.2" xref="S3.SS1.p1.14.m13.2.3.3.1.cmml">;</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.14.m13.2.2" xref="S3.SS1.p1.14.m13.2.2.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.14.m13.2.3.3.2.3" xref="S3.SS1.p1.14.m13.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m13.2b"><apply id="S3.SS1.p1.14.m13.2.3.cmml" xref="S3.SS1.p1.14.m13.2.3"><times id="S3.SS1.p1.14.m13.2.3.1.cmml" xref="S3.SS1.p1.14.m13.2.3.1"></times><apply id="S3.SS1.p1.14.m13.2.3.2.cmml" xref="S3.SS1.p1.14.m13.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m13.2.3.2.1.cmml" xref="S3.SS1.p1.14.m13.2.3.2">subscript</csymbol><ci id="S3.SS1.p1.14.m13.2.3.2.2.cmml" xref="S3.SS1.p1.14.m13.2.3.2.2">𝐿</ci><ci id="S3.SS1.p1.14.m13.2.3.2.3.cmml" xref="S3.SS1.p1.14.m13.2.3.2.3">𝑖</ci></apply><list id="S3.SS1.p1.14.m13.2.3.3.1.cmml" xref="S3.SS1.p1.14.m13.2.3.3.2"><ci id="S3.SS1.p1.14.m13.1.1.cmml" xref="S3.SS1.p1.14.m13.1.1">⋅</ci><ci id="S3.SS1.p1.14.m13.2.2.cmml" xref="S3.SS1.p1.14.m13.2.2">⋅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m13.2c">L_{i}(\cdot;\cdot)</annotation></semantics></math> could be a general objective function, e.g., cross-entropy loss for classification tasks. The global objective <math id="S3.SS1.p1.15.m14.1" class="ltx_Math" alttext="F(\bm{w})" display="inline"><semantics id="S3.SS1.p1.15.m14.1a"><mrow id="S3.SS1.p1.15.m14.1.2" xref="S3.SS1.p1.15.m14.1.2.cmml"><mi id="S3.SS1.p1.15.m14.1.2.2" xref="S3.SS1.p1.15.m14.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.15.m14.1.2.1" xref="S3.SS1.p1.15.m14.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.15.m14.1.2.3.2" xref="S3.SS1.p1.15.m14.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.15.m14.1.2.3.2.1" xref="S3.SS1.p1.15.m14.1.2.cmml">(</mo><mi id="S3.SS1.p1.15.m14.1.1" xref="S3.SS1.p1.15.m14.1.1.cmml">𝒘</mi><mo stretchy="false" id="S3.SS1.p1.15.m14.1.2.3.2.2" xref="S3.SS1.p1.15.m14.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m14.1b"><apply id="S3.SS1.p1.15.m14.1.2.cmml" xref="S3.SS1.p1.15.m14.1.2"><times id="S3.SS1.p1.15.m14.1.2.1.cmml" xref="S3.SS1.p1.15.m14.1.2.1"></times><ci id="S3.SS1.p1.15.m14.1.2.2.cmml" xref="S3.SS1.p1.15.m14.1.2.2">𝐹</ci><ci id="S3.SS1.p1.15.m14.1.1.cmml" xref="S3.SS1.p1.15.m14.1.1">𝒘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m14.1c">F(\bm{w})</annotation></semantics></math> can be regarded as a weighted average of local objectives and FL tries to minimize it in a distributed manner. For multi-class classification tasks, the local empirical risk is usually the cross-entropy between softmax outputs and ground-truth labels as in Eq. (<a href="#S3.E2" title="In 3.1 Problem Formulation for Federated Learning ‣ 3 Preliminary and Motivation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>)</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="L_{i}=-\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}\sum_{c=1}^{C}\mathbb{I}\{y_{j}=k\}\cdot\log{\left(\frac{e^{z_{j}[c]}}{\sum_{c^{\prime}=1}^{C}e^{z_{j}[c^{\prime}]}}\right)}," display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.1" xref="S3.E2.m1.4.4.1.1.cmml"><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml"><msub id="S3.E2.m1.4.4.1.1.3" xref="S3.E2.m1.4.4.1.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.3.2" xref="S3.E2.m1.4.4.1.1.3.2.cmml">L</mi><mi id="S3.E2.m1.4.4.1.1.3.3" xref="S3.E2.m1.4.4.1.1.3.3.cmml">i</mi></msub><mo id="S3.E2.m1.4.4.1.1.2" xref="S3.E2.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml"><mo id="S3.E2.m1.4.4.1.1.1a" xref="S3.E2.m1.4.4.1.1.1.cmml">−</mo><mrow id="S3.E2.m1.4.4.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml"><mfrac id="S3.E2.m1.4.4.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.3.cmml"><mn id="S3.E2.m1.4.4.1.1.1.1.3.2" xref="S3.E2.m1.4.4.1.1.1.1.3.2.cmml">1</mn><msub id="S3.E2.m1.4.4.1.1.1.1.3.3" xref="S3.E2.m1.4.4.1.1.1.1.3.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.3.3.2" xref="S3.E2.m1.4.4.1.1.1.1.3.3.2.cmml">n</mi><mi id="S3.E2.m1.4.4.1.1.1.1.3.3.3" xref="S3.E2.m1.4.4.1.1.1.1.3.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.cmml"><munderover id="S3.E2.m1.4.4.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.1.2.2.2" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.2.2.3" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.2" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.1" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.3" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E2.m1.4.4.1.1.1.1.1.2.3" xref="S3.E2.m1.4.4.1.1.1.1.1.2.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.2.3.2" xref="S3.E2.m1.4.4.1.1.1.1.1.2.3.2.cmml">n</mi><mi id="S3.E2.m1.4.4.1.1.1.1.1.2.3.3" xref="S3.E2.m1.4.4.1.1.1.1.1.2.3.3.cmml">i</mi></msub></munderover><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.cmml"><munderover id="S3.E2.m1.4.4.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml">c</mi><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.2.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.3.cmml">C</mi></munderover><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">𝕀</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow></mrow><mo rspace="0.222em" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml">⋅</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml"><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">log</mi><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.2a" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.2.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.2.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">(</mo><mfrac id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><msup id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml">e</mi><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.3.2.cmml">z</mi><mi id="S3.E2.m1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.4.2.1" xref="S3.E2.m1.1.1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.4.2.2" xref="S3.E2.m1.1.1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msup><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><msubsup id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml"><mo id="S3.E2.m1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.2.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.2.3.cmml"><msup id="S3.E2.m1.2.2.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.2.3.2.cmml"><mi id="S3.E2.m1.2.2.2.2.2.3.2.2" xref="S3.E2.m1.2.2.2.2.2.3.2.2.cmml">c</mi><mo id="S3.E2.m1.2.2.2.2.2.3.2.3" xref="S3.E2.m1.2.2.2.2.2.3.2.3.cmml">′</mo></msup><mo id="S3.E2.m1.2.2.2.2.2.3.1" xref="S3.E2.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.2.2.2.2.2.3.3" xref="S3.E2.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.2.2.2.2.3" xref="S3.E2.m1.2.2.2.2.3.cmml">C</mi></msubsup><msup id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.2.2.2.3.2" xref="S3.E2.m1.2.2.2.3.2.cmml">e</mi><mrow id="S3.E2.m1.2.2.2.1.1" xref="S3.E2.m1.2.2.2.1.1.cmml"><msub id="S3.E2.m1.2.2.2.1.1.3" xref="S3.E2.m1.2.2.2.1.1.3.cmml"><mi id="S3.E2.m1.2.2.2.1.1.3.2" xref="S3.E2.m1.2.2.2.1.1.3.2.cmml">z</mi><mi id="S3.E2.m1.2.2.2.1.1.3.3" xref="S3.E2.m1.2.2.2.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.2.1.1.2" xref="S3.E2.m1.2.2.2.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.2.2.2.1.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.1.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.2.1.cmml">[</mo><msup id="S3.E2.m1.2.2.2.1.1.1.1.1" xref="S3.E2.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.2.1.1.1.1.1.2" xref="S3.E2.m1.2.2.2.1.1.1.1.1.2.cmml">c</mi><mo id="S3.E2.m1.2.2.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S3.E2.m1.2.2.2.1.1.1.1.3" xref="S3.E2.m1.2.2.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></msup></mrow></mfrac><mo id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.2.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.4.4.1.2" xref="S3.E2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1"><eq id="S3.E2.m1.4.4.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2"></eq><apply id="S3.E2.m1.4.4.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2">𝐿</ci><ci id="S3.E2.m1.4.4.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.3.3">𝑖</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"><minus id="S3.E2.m1.4.4.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1"></minus><apply id="S3.E2.m1.4.4.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1"><times id="S3.E2.m1.4.4.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2"></times><apply id="S3.E2.m1.4.4.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3"><divide id="S3.E2.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3"></divide><cn type="integer" id="S3.E2.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3.2">1</cn><apply id="S3.E2.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.3.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.3.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3.3.2">𝑛</ci><ci id="S3.E2.m1.4.4.1.1.1.1.3.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1"><apply id="S3.E2.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.3"><eq id="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.2.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.1.2.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.3.2">𝑛</ci><ci id="S3.E2.m1.4.4.1.1.1.1.1.2.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1"><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3"><eq id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.2">𝑐</ci><cn type="integer" id="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.2.3">𝐶</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1"><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1"><times id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.3">𝕀</ci><set id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><eq id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></set></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.2"><log id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3"></log><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><divide id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2"></divide><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3">𝑒</ci><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.3.2">𝑧</ci><ci id="S3.E2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3">𝑗</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.1.1.4.2"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.4.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1">𝑐</ci></apply></apply></apply><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2">subscript</csymbol><sum id="S3.E2.m1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.2"></sum><apply id="S3.E2.m1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3"><eq id="S3.E2.m1.2.2.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.2.2.3.1"></eq><apply id="S3.E2.m1.2.2.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.2.2.3.2.1.cmml" xref="S3.E2.m1.2.2.2.2.2.3.2">superscript</csymbol><ci id="S3.E2.m1.2.2.2.2.2.3.2.2.cmml" xref="S3.E2.m1.2.2.2.2.2.3.2.2">𝑐</ci><ci id="S3.E2.m1.2.2.2.2.2.3.2.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3.2.3">′</ci></apply><cn type="integer" id="S3.E2.m1.2.2.2.2.2.3.3.cmml" xref="S3.E2.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2.3">𝐶</ci></apply><apply id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.3.1.cmml" xref="S3.E2.m1.2.2.2.3">superscript</csymbol><ci id="S3.E2.m1.2.2.2.3.2.cmml" xref="S3.E2.m1.2.2.2.3.2">𝑒</ci><apply id="S3.E2.m1.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1"><times id="S3.E2.m1.2.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.2"></times><apply id="S3.E2.m1.2.2.2.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.3.2.cmml" xref="S3.E2.m1.2.2.2.1.1.3.2">𝑧</ci><ci id="S3.E2.m1.2.2.2.1.1.3.3.cmml" xref="S3.E2.m1.2.2.2.1.1.3.3">𝑗</ci></apply><apply id="S3.E2.m1.2.2.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1.2">𝑐</ci><ci id="S3.E2.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.2.1.1.1.1.1.3">′</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">L_{i}=-\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}\sum_{c=1}^{C}\mathbb{I}\{y_{j}=k\}\cdot\log{\left(\frac{e^{z_{j}[c]}}{\sum_{c^{\prime}=1}^{C}e^{z_{j}[c^{\prime}]}}\right)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.18" class="ltx_p">where <math id="S3.SS1.p1.16.m1.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S3.SS1.p1.16.m1.1a"><msub id="S3.SS1.p1.16.m1.1.1" xref="S3.SS1.p1.16.m1.1.1.cmml"><mi id="S3.SS1.p1.16.m1.1.1.2" xref="S3.SS1.p1.16.m1.1.1.2.cmml">n</mi><mi id="S3.SS1.p1.16.m1.1.1.3" xref="S3.SS1.p1.16.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m1.1b"><apply id="S3.SS1.p1.16.m1.1.1.cmml" xref="S3.SS1.p1.16.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m1.1.1.1.cmml" xref="S3.SS1.p1.16.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.16.m1.1.1.2.cmml" xref="S3.SS1.p1.16.m1.1.1.2">𝑛</ci><ci id="S3.SS1.p1.16.m1.1.1.3.cmml" xref="S3.SS1.p1.16.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m1.1c">n_{i}</annotation></semantics></math> is the local data size, <math id="S3.SS1.p1.17.m2.1" class="ltx_Math" alttext="\mathbb{I}(\cdot)" display="inline"><semantics id="S3.SS1.p1.17.m2.1a"><mrow id="S3.SS1.p1.17.m2.1.2" xref="S3.SS1.p1.17.m2.1.2.cmml"><mi id="S3.SS1.p1.17.m2.1.2.2" xref="S3.SS1.p1.17.m2.1.2.2.cmml">𝕀</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.17.m2.1.2.1" xref="S3.SS1.p1.17.m2.1.2.1.cmml">​</mo><mrow id="S3.SS1.p1.17.m2.1.2.3.2" xref="S3.SS1.p1.17.m2.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.17.m2.1.2.3.2.1" xref="S3.SS1.p1.17.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p1.17.m2.1.1" xref="S3.SS1.p1.17.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p1.17.m2.1.2.3.2.2" xref="S3.SS1.p1.17.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m2.1b"><apply id="S3.SS1.p1.17.m2.1.2.cmml" xref="S3.SS1.p1.17.m2.1.2"><times id="S3.SS1.p1.17.m2.1.2.1.cmml" xref="S3.SS1.p1.17.m2.1.2.1"></times><ci id="S3.SS1.p1.17.m2.1.2.2.cmml" xref="S3.SS1.p1.17.m2.1.2.2">𝕀</ci><ci id="S3.SS1.p1.17.m2.1.1.cmml" xref="S3.SS1.p1.17.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m2.1c">\mathbb{I}(\cdot)</annotation></semantics></math> is the indication function and <math id="S3.SS1.p1.18.m3.1" class="ltx_Math" alttext="z_{j}" display="inline"><semantics id="S3.SS1.p1.18.m3.1a"><msub id="S3.SS1.p1.18.m3.1.1" xref="S3.SS1.p1.18.m3.1.1.cmml"><mi id="S3.SS1.p1.18.m3.1.1.2" xref="S3.SS1.p1.18.m3.1.1.2.cmml">z</mi><mi id="S3.SS1.p1.18.m3.1.1.3" xref="S3.SS1.p1.18.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m3.1b"><apply id="S3.SS1.p1.18.m3.1.1.cmml" xref="S3.SS1.p1.18.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m3.1.1.1.cmml" xref="S3.SS1.p1.18.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.18.m3.1.1.2.cmml" xref="S3.SS1.p1.18.m3.1.1.2">𝑧</ci><ci id="S3.SS1.p1.18.m3.1.1.3.cmml" xref="S3.SS1.p1.18.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m3.1c">z_{j}</annotation></semantics></math> is the output logit.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.6" class="ltx_p">The most popular learning method in FL is obviously the FedAvg algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, which is a strong baseline in many tasks and works as follows. At each communication round <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">t</annotation></semantics></math>, the server selects a random subset <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">S</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝑆</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">S_{t}</annotation></semantics></math> of clients to participate in this round of training. The server broadcasts the latest global model <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="{\bm{w}}^{(t)}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msup id="S3.SS1.p2.3.m3.1.2" xref="S3.SS1.p2.3.m3.1.2.cmml"><mi id="S3.SS1.p2.3.m3.1.2.2" xref="S3.SS1.p2.3.m3.1.2.2.cmml">𝒘</mi><mrow id="S3.SS1.p2.3.m3.1.1.1.3" xref="S3.SS1.p2.3.m3.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.3.m3.1.1.1.3.1" xref="S3.SS1.p2.3.m3.1.2.cmml">(</mo><mi id="S3.SS1.p2.3.m3.1.1.1.1" xref="S3.SS1.p2.3.m3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p2.3.m3.1.1.1.3.2" xref="S3.SS1.p2.3.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.2.cmml" xref="S3.SS1.p2.3.m3.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.2.1.cmml" xref="S3.SS1.p2.3.m3.1.2">superscript</csymbol><ci id="S3.SS1.p2.3.m3.1.2.2.cmml" xref="S3.SS1.p2.3.m3.1.2.2">𝒘</ci><ci id="S3.SS1.p2.3.m3.1.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">{\bm{w}}^{(t)}</annotation></semantics></math> to these clients for further local optimization. Then each participating client optimizes the local objective function based on the private data by its local solvers (e.g. SGD) with several local epochs <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">E</annotation></semantics></math> in parallel. Then, the locally-computed parameter updates <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="\Delta\bm{w}_{i}^{(t)}" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mrow id="S3.SS1.p2.5.m5.1.2" xref="S3.SS1.p2.5.m5.1.2.cmml"><mi mathvariant="normal" id="S3.SS1.p2.5.m5.1.2.2" xref="S3.SS1.p2.5.m5.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.5.m5.1.2.1" xref="S3.SS1.p2.5.m5.1.2.1.cmml">​</mo><msubsup id="S3.SS1.p2.5.m5.1.2.3" xref="S3.SS1.p2.5.m5.1.2.3.cmml"><mi id="S3.SS1.p2.5.m5.1.2.3.2.2" xref="S3.SS1.p2.5.m5.1.2.3.2.2.cmml">𝒘</mi><mi id="S3.SS1.p2.5.m5.1.2.3.2.3" xref="S3.SS1.p2.5.m5.1.2.3.2.3.cmml">i</mi><mrow id="S3.SS1.p2.5.m5.1.1.1.3" xref="S3.SS1.p2.5.m5.1.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.3.1" xref="S3.SS1.p2.5.m5.1.2.3.cmml">(</mo><mi id="S3.SS1.p2.5.m5.1.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S3.SS1.p2.5.m5.1.1.1.3.2" xref="S3.SS1.p2.5.m5.1.2.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><apply id="S3.SS1.p2.5.m5.1.2.cmml" xref="S3.SS1.p2.5.m5.1.2"><times id="S3.SS1.p2.5.m5.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.2.1"></times><ci id="S3.SS1.p2.5.m5.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.2.2">Δ</ci><apply id="S3.SS1.p2.5.m5.1.2.3.cmml" xref="S3.SS1.p2.5.m5.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.2.3.1.cmml" xref="S3.SS1.p2.5.m5.1.2.3">superscript</csymbol><apply id="S3.SS1.p2.5.m5.1.2.3.2.cmml" xref="S3.SS1.p2.5.m5.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.2.3.2.1.cmml" xref="S3.SS1.p2.5.m5.1.2.3">subscript</csymbol><ci id="S3.SS1.p2.5.m5.1.2.3.2.2.cmml" xref="S3.SS1.p2.5.m5.1.2.3.2.2">𝒘</ci><ci id="S3.SS1.p2.5.m5.1.2.3.2.3.cmml" xref="S3.SS1.p2.5.m5.1.2.3.2.3">𝑖</ci></apply><ci id="S3.SS1.p2.5.m5.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">\Delta\bm{w}_{i}^{(t)}</annotation></semantics></math> are collected and aggregated. Finally, the server updates the global model to <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="\bm{w}^{(t+1)}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msup id="S3.SS1.p2.6.m6.1.2" xref="S3.SS1.p2.6.m6.1.2.cmml"><mi id="S3.SS1.p2.6.m6.1.2.2" xref="S3.SS1.p2.6.m6.1.2.2.cmml">𝒘</mi><mrow id="S3.SS1.p2.6.m6.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.6.m6.1.1.1.1.2" xref="S3.SS1.p2.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p2.6.m6.1.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.1.1.1.2" xref="S3.SS1.p2.6.m6.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS1.p2.6.m6.1.1.1.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p2.6.m6.1.1.1.1.1.3" xref="S3.SS1.p2.6.m6.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.SS1.p2.6.m6.1.1.1.1.3" xref="S3.SS1.p2.6.m6.1.1.1.1.1.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.2.cmml" xref="S3.SS1.p2.6.m6.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.2">superscript</csymbol><ci id="S3.SS1.p2.6.m6.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.2.2">𝒘</ci><apply id="S3.SS1.p2.6.m6.1.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1"><plus id="S3.SS1.p2.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1.1.1"></plus><ci id="S3.SS1.p2.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.SS1.p2.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\bm{w}^{(t+1)}</annotation></semantics></math> as in eq. (<a href="#S3.E3" title="In 3.1 Problem Formulation for Federated Learning ‣ 3 Preliminary and Motivation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>) and finish the current round. In general, the FL task requires hundreds of rounds to reach the target accuracy.</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.3" class="ltx_Math" alttext="{\bm{w}}^{(t+1)}={\bm{w}}^{(t)}+\sum_{i\in S_{t}}\frac{n_{i}}{\sum_{i\in S_{t}}n_{i}}\Delta{\bm{w}}_{i}^{(t)}" display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.4" xref="S3.E3.m1.3.4.cmml"><msup id="S3.E3.m1.3.4.2" xref="S3.E3.m1.3.4.2.cmml"><mi id="S3.E3.m1.3.4.2.2" xref="S3.E3.m1.3.4.2.2.cmml">𝒘</mi><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.E3.m1.3.4.1" xref="S3.E3.m1.3.4.1.cmml">=</mo><mrow id="S3.E3.m1.3.4.3" xref="S3.E3.m1.3.4.3.cmml"><msup id="S3.E3.m1.3.4.3.2" xref="S3.E3.m1.3.4.3.2.cmml"><mi id="S3.E3.m1.3.4.3.2.2" xref="S3.E3.m1.3.4.3.2.2.cmml">𝒘</mi><mrow id="S3.E3.m1.2.2.1.3" xref="S3.E3.m1.3.4.3.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.3.1" xref="S3.E3.m1.3.4.3.2.cmml">(</mo><mi id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S3.E3.m1.2.2.1.3.2" xref="S3.E3.m1.3.4.3.2.cmml">)</mo></mrow></msup><mo rspace="0.055em" id="S3.E3.m1.3.4.3.1" xref="S3.E3.m1.3.4.3.1.cmml">+</mo><mrow id="S3.E3.m1.3.4.3.3" xref="S3.E3.m1.3.4.3.3.cmml"><munder id="S3.E3.m1.3.4.3.3.1" xref="S3.E3.m1.3.4.3.3.1.cmml"><mo movablelimits="false" id="S3.E3.m1.3.4.3.3.1.2" xref="S3.E3.m1.3.4.3.3.1.2.cmml">∑</mo><mrow id="S3.E3.m1.3.4.3.3.1.3" xref="S3.E3.m1.3.4.3.3.1.3.cmml"><mi id="S3.E3.m1.3.4.3.3.1.3.2" xref="S3.E3.m1.3.4.3.3.1.3.2.cmml">i</mi><mo id="S3.E3.m1.3.4.3.3.1.3.1" xref="S3.E3.m1.3.4.3.3.1.3.1.cmml">∈</mo><msub id="S3.E3.m1.3.4.3.3.1.3.3" xref="S3.E3.m1.3.4.3.3.1.3.3.cmml"><mi id="S3.E3.m1.3.4.3.3.1.3.3.2" xref="S3.E3.m1.3.4.3.3.1.3.3.2.cmml">S</mi><mi id="S3.E3.m1.3.4.3.3.1.3.3.3" xref="S3.E3.m1.3.4.3.3.1.3.3.3.cmml">t</mi></msub></mrow></munder><mrow id="S3.E3.m1.3.4.3.3.2" xref="S3.E3.m1.3.4.3.3.2.cmml"><mfrac id="S3.E3.m1.3.4.3.3.2.2" xref="S3.E3.m1.3.4.3.3.2.2.cmml"><msub id="S3.E3.m1.3.4.3.3.2.2.2" xref="S3.E3.m1.3.4.3.3.2.2.2.cmml"><mi id="S3.E3.m1.3.4.3.3.2.2.2.2" xref="S3.E3.m1.3.4.3.3.2.2.2.2.cmml">n</mi><mi id="S3.E3.m1.3.4.3.3.2.2.2.3" xref="S3.E3.m1.3.4.3.3.2.2.2.3.cmml">i</mi></msub><mrow id="S3.E3.m1.3.4.3.3.2.2.3" xref="S3.E3.m1.3.4.3.3.2.2.3.cmml"><msub id="S3.E3.m1.3.4.3.3.2.2.3.1" xref="S3.E3.m1.3.4.3.3.2.2.3.1.cmml"><mo id="S3.E3.m1.3.4.3.3.2.2.3.1.2" xref="S3.E3.m1.3.4.3.3.2.2.3.1.2.cmml">∑</mo><mrow id="S3.E3.m1.3.4.3.3.2.2.3.1.3" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.cmml"><mi id="S3.E3.m1.3.4.3.3.2.2.3.1.3.2" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.2.cmml">i</mi><mo id="S3.E3.m1.3.4.3.3.2.2.3.1.3.1" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.1.cmml">∈</mo><msub id="S3.E3.m1.3.4.3.3.2.2.3.1.3.3" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.cmml"><mi id="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.2" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.2.cmml">S</mi><mi id="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.3" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><msub id="S3.E3.m1.3.4.3.3.2.2.3.2" xref="S3.E3.m1.3.4.3.3.2.2.3.2.cmml"><mi id="S3.E3.m1.3.4.3.3.2.2.3.2.2" xref="S3.E3.m1.3.4.3.3.2.2.3.2.2.cmml">n</mi><mi id="S3.E3.m1.3.4.3.3.2.2.3.2.3" xref="S3.E3.m1.3.4.3.3.2.2.3.2.3.cmml">i</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.4.3.3.2.1" xref="S3.E3.m1.3.4.3.3.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.E3.m1.3.4.3.3.2.3" xref="S3.E3.m1.3.4.3.3.2.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.4.3.3.2.1a" xref="S3.E3.m1.3.4.3.3.2.1.cmml">​</mo><msubsup id="S3.E3.m1.3.4.3.3.2.4" xref="S3.E3.m1.3.4.3.3.2.4.cmml"><mi id="S3.E3.m1.3.4.3.3.2.4.2.2" xref="S3.E3.m1.3.4.3.3.2.4.2.2.cmml">𝒘</mi><mi id="S3.E3.m1.3.4.3.3.2.4.2.3" xref="S3.E3.m1.3.4.3.3.2.4.2.3.cmml">i</mi><mrow id="S3.E3.m1.3.3.1.3" xref="S3.E3.m1.3.4.3.3.2.4.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.3.1" xref="S3.E3.m1.3.4.3.3.2.4.cmml">(</mo><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="S3.E3.m1.3.3.1.3.2" xref="S3.E3.m1.3.4.3.3.2.4.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.4.cmml" xref="S3.E3.m1.3.4"><eq id="S3.E3.m1.3.4.1.cmml" xref="S3.E3.m1.3.4.1"></eq><apply id="S3.E3.m1.3.4.2.cmml" xref="S3.E3.m1.3.4.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.2.1.cmml" xref="S3.E3.m1.3.4.2">superscript</csymbol><ci id="S3.E3.m1.3.4.2.2.cmml" xref="S3.E3.m1.3.4.2.2">𝒘</ci><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1"><plus id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"></plus><ci id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.E3.m1.3.4.3.cmml" xref="S3.E3.m1.3.4.3"><plus id="S3.E3.m1.3.4.3.1.cmml" xref="S3.E3.m1.3.4.3.1"></plus><apply id="S3.E3.m1.3.4.3.2.cmml" xref="S3.E3.m1.3.4.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.3.2.1.cmml" xref="S3.E3.m1.3.4.3.2">superscript</csymbol><ci id="S3.E3.m1.3.4.3.2.2.cmml" xref="S3.E3.m1.3.4.3.2.2">𝒘</ci><ci id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1">𝑡</ci></apply><apply id="S3.E3.m1.3.4.3.3.cmml" xref="S3.E3.m1.3.4.3.3"><apply id="S3.E3.m1.3.4.3.3.1.cmml" xref="S3.E3.m1.3.4.3.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.3.3.1.1.cmml" xref="S3.E3.m1.3.4.3.3.1">subscript</csymbol><sum id="S3.E3.m1.3.4.3.3.1.2.cmml" xref="S3.E3.m1.3.4.3.3.1.2"></sum><apply id="S3.E3.m1.3.4.3.3.1.3.cmml" xref="S3.E3.m1.3.4.3.3.1.3"><in id="S3.E3.m1.3.4.3.3.1.3.1.cmml" xref="S3.E3.m1.3.4.3.3.1.3.1"></in><ci id="S3.E3.m1.3.4.3.3.1.3.2.cmml" xref="S3.E3.m1.3.4.3.3.1.3.2">𝑖</ci><apply id="S3.E3.m1.3.4.3.3.1.3.3.cmml" xref="S3.E3.m1.3.4.3.3.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.3.3.1.3.3.1.cmml" xref="S3.E3.m1.3.4.3.3.1.3.3">subscript</csymbol><ci id="S3.E3.m1.3.4.3.3.1.3.3.2.cmml" xref="S3.E3.m1.3.4.3.3.1.3.3.2">𝑆</ci><ci id="S3.E3.m1.3.4.3.3.1.3.3.3.cmml" xref="S3.E3.m1.3.4.3.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E3.m1.3.4.3.3.2.cmml" xref="S3.E3.m1.3.4.3.3.2"><times id="S3.E3.m1.3.4.3.3.2.1.cmml" xref="S3.E3.m1.3.4.3.3.2.1"></times><apply id="S3.E3.m1.3.4.3.3.2.2.cmml" xref="S3.E3.m1.3.4.3.3.2.2"><divide id="S3.E3.m1.3.4.3.3.2.2.1.cmml" xref="S3.E3.m1.3.4.3.3.2.2"></divide><apply id="S3.E3.m1.3.4.3.3.2.2.2.cmml" xref="S3.E3.m1.3.4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.3.3.2.2.2.1.cmml" xref="S3.E3.m1.3.4.3.3.2.2.2">subscript</csymbol><ci id="S3.E3.m1.3.4.3.3.2.2.2.2.cmml" xref="S3.E3.m1.3.4.3.3.2.2.2.2">𝑛</ci><ci id="S3.E3.m1.3.4.3.3.2.2.2.3.cmml" xref="S3.E3.m1.3.4.3.3.2.2.2.3">𝑖</ci></apply><apply id="S3.E3.m1.3.4.3.3.2.2.3.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3"><apply id="S3.E3.m1.3.4.3.3.2.2.3.1.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.3.3.2.2.3.1.1.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.1">subscript</csymbol><sum id="S3.E3.m1.3.4.3.3.2.2.3.1.2.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.1.2"></sum><apply id="S3.E3.m1.3.4.3.3.2.2.3.1.3.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3"><in id="S3.E3.m1.3.4.3.3.2.2.3.1.3.1.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.1"></in><ci id="S3.E3.m1.3.4.3.3.2.2.3.1.3.2.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.2">𝑖</ci><apply id="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.1.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.3">subscript</csymbol><ci id="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.2.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.2">𝑆</ci><ci id="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.3.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E3.m1.3.4.3.3.2.2.3.2.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.3.3.2.2.3.2.1.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.2">subscript</csymbol><ci id="S3.E3.m1.3.4.3.3.2.2.3.2.2.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.2.2">𝑛</ci><ci id="S3.E3.m1.3.4.3.3.2.2.3.2.3.cmml" xref="S3.E3.m1.3.4.3.3.2.2.3.2.3">𝑖</ci></apply></apply></apply><ci id="S3.E3.m1.3.4.3.3.2.3.cmml" xref="S3.E3.m1.3.4.3.3.2.3">Δ</ci><apply id="S3.E3.m1.3.4.3.3.2.4.cmml" xref="S3.E3.m1.3.4.3.3.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.3.3.2.4.1.cmml" xref="S3.E3.m1.3.4.3.3.2.4">superscript</csymbol><apply id="S3.E3.m1.3.4.3.3.2.4.2.cmml" xref="S3.E3.m1.3.4.3.3.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.3.4.3.3.2.4.2.1.cmml" xref="S3.E3.m1.3.4.3.3.2.4">subscript</csymbol><ci id="S3.E3.m1.3.4.3.3.2.4.2.2.cmml" xref="S3.E3.m1.3.4.3.3.2.4.2.2">𝒘</ci><ci id="S3.E3.m1.3.4.3.3.2.4.2.3.cmml" xref="S3.E3.m1.3.4.3.3.2.4.2.3">𝑖</ci></apply><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">{\bm{w}}^{(t+1)}={\bm{w}}^{(t)}+\sum_{i\in S_{t}}\frac{n_{i}}{\sum_{i\in S_{t}}n_{i}}\Delta{\bm{w}}_{i}^{(t)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span id="S3.SS2.1.1" class="ltx_text ltx_font_italic">Prior-Corrected Bayes Classifier</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">As introduced before, the <span id="S3.SS2.p1.2.1" class="ltx_text ltx_font_italic">Label shift</span> induced non-IID data in FL refers to the label distribution changing between local training data and target test set. And we focus on the case where local training distributions have significant discrepancy to the uniform test distribution. We start by focusing on the calibration of a single classifier trained on one specific client. Let <math id="S3.SS2.p1.1.m1.2" class="ltx_Math" alttext="{P}_{s}(X,Y)" display="inline"><semantics id="S3.SS2.p1.1.m1.2a"><mrow id="S3.SS2.p1.1.m1.2.3" xref="S3.SS2.p1.1.m1.2.3.cmml"><msub id="S3.SS2.p1.1.m1.2.3.2" xref="S3.SS2.p1.1.m1.2.3.2.cmml"><mi id="S3.SS2.p1.1.m1.2.3.2.2" xref="S3.SS2.p1.1.m1.2.3.2.2.cmml">P</mi><mi id="S3.SS2.p1.1.m1.2.3.2.3" xref="S3.SS2.p1.1.m1.2.3.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.2.3.1" xref="S3.SS2.p1.1.m1.2.3.1.cmml">​</mo><mrow id="S3.SS2.p1.1.m1.2.3.3.2" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.2.3.3.2.1" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">X</mi><mo id="S3.SS2.p1.1.m1.2.3.3.2.2" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.1.m1.2.2" xref="S3.SS2.p1.1.m1.2.2.cmml">Y</mi><mo stretchy="false" id="S3.SS2.p1.1.m1.2.3.3.2.3" xref="S3.SS2.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.2b"><apply id="S3.SS2.p1.1.m1.2.3.cmml" xref="S3.SS2.p1.1.m1.2.3"><times id="S3.SS2.p1.1.m1.2.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.1"></times><apply id="S3.SS2.p1.1.m1.2.3.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.3.2.1.cmml" xref="S3.SS2.p1.1.m1.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.3.2.2.cmml" xref="S3.SS2.p1.1.m1.2.3.2.2">𝑃</ci><ci id="S3.SS2.p1.1.m1.2.3.2.3.cmml" xref="S3.SS2.p1.1.m1.2.3.2.3">𝑠</ci></apply><interval closure="open" id="S3.SS2.p1.1.m1.2.3.3.1.cmml" xref="S3.SS2.p1.1.m1.2.3.3.2"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑋</ci><ci id="S3.SS2.p1.1.m1.2.2.cmml" xref="S3.SS2.p1.1.m1.2.2">𝑌</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.2c">{P}_{s}(X,Y)</annotation></semantics></math> and <math id="S3.SS2.p1.2.m2.2" class="ltx_Math" alttext="{P}_{t}(X,Y)" display="inline"><semantics id="S3.SS2.p1.2.m2.2a"><mrow id="S3.SS2.p1.2.m2.2.3" xref="S3.SS2.p1.2.m2.2.3.cmml"><msub id="S3.SS2.p1.2.m2.2.3.2" xref="S3.SS2.p1.2.m2.2.3.2.cmml"><mi id="S3.SS2.p1.2.m2.2.3.2.2" xref="S3.SS2.p1.2.m2.2.3.2.2.cmml">P</mi><mi id="S3.SS2.p1.2.m2.2.3.2.3" xref="S3.SS2.p1.2.m2.2.3.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.2.m2.2.3.1" xref="S3.SS2.p1.2.m2.2.3.1.cmml">​</mo><mrow id="S3.SS2.p1.2.m2.2.3.3.2" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.2.m2.2.3.3.2.1" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml">(</mo><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">X</mi><mo id="S3.SS2.p1.2.m2.2.3.3.2.2" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="S3.SS2.p1.2.m2.2.2" xref="S3.SS2.p1.2.m2.2.2.cmml">Y</mi><mo stretchy="false" id="S3.SS2.p1.2.m2.2.3.3.2.3" xref="S3.SS2.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.2b"><apply id="S3.SS2.p1.2.m2.2.3.cmml" xref="S3.SS2.p1.2.m2.2.3"><times id="S3.SS2.p1.2.m2.2.3.1.cmml" xref="S3.SS2.p1.2.m2.2.3.1"></times><apply id="S3.SS2.p1.2.m2.2.3.2.cmml" xref="S3.SS2.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.3.2.1.cmml" xref="S3.SS2.p1.2.m2.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.2.m2.2.3.2.2.cmml" xref="S3.SS2.p1.2.m2.2.3.2.2">𝑃</ci><ci id="S3.SS2.p1.2.m2.2.3.2.3.cmml" xref="S3.SS2.p1.2.m2.2.3.2.3">𝑡</ci></apply><interval closure="open" id="S3.SS2.p1.2.m2.2.3.3.1.cmml" xref="S3.SS2.p1.2.m2.2.3.3.2"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑋</ci><ci id="S3.SS2.p1.2.m2.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2">𝑌</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.2c">{P}_{t}(X,Y)</annotation></semantics></math> denote the training (source) and the test (target) distributions, respectively. In a multi-class classification task, the final decision on the target distribution is often made by following the Bayes decision rule:</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\displaystyle y^{*}=\arg\max_{y}P_{t}(y|x)" display="inline"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><msup id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.3.2" xref="S3.Ex1.m1.1.1.3.2.cmml">y</mi><mo id="S3.Ex1.m1.1.1.3.3" xref="S3.Ex1.m1.1.1.3.3.cmml">∗</mo></msup><mo id="S3.Ex1.m1.1.1.2" xref="S3.Ex1.m1.1.1.2.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.3.1" xref="S3.Ex1.m1.1.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.Ex1.m1.1.1.1.3a" xref="S3.Ex1.m1.1.1.1.3.cmml">⁡</mo><mrow id="S3.Ex1.m1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.3.2.cmml"><munder id="S3.Ex1.m1.1.1.1.3.2.1" xref="S3.Ex1.m1.1.1.1.3.2.1.cmml"><mi id="S3.Ex1.m1.1.1.1.3.2.1.2" xref="S3.Ex1.m1.1.1.1.3.2.1.2.cmml">max</mi><mi id="S3.Ex1.m1.1.1.1.3.2.1.3" xref="S3.Ex1.m1.1.1.1.3.2.1.3.cmml">y</mi></munder><mo lspace="0.167em" id="S3.Ex1.m1.1.1.1.3.2a" xref="S3.Ex1.m1.1.1.1.3.2.cmml">⁡</mo><msub id="S3.Ex1.m1.1.1.1.3.2.2" xref="S3.Ex1.m1.1.1.1.3.2.2.cmml"><mi id="S3.Ex1.m1.1.1.1.3.2.2.2" xref="S3.Ex1.m1.1.1.1.3.2.2.2.cmml">P</mi><mi id="S3.Ex1.m1.1.1.1.3.2.2.3" xref="S3.Ex1.m1.1.1.1.3.2.2.3.cmml">t</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1"><eq id="S3.Ex1.m1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.2"></eq><apply id="S3.Ex1.m1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.3">superscript</csymbol><ci id="S3.Ex1.m1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.3.2">𝑦</ci><times id="S3.Ex1.m1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.3.3"></times></apply><apply id="S3.Ex1.m1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><times id="S3.Ex1.m1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.2"></times><apply id="S3.Ex1.m1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.3"><arg id="S3.Ex1.m1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.3.1"></arg><apply id="S3.Ex1.m1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.3.2"><apply id="S3.Ex1.m1.1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.3.2.1.1.cmml" xref="S3.Ex1.m1.1.1.1.3.2.1">subscript</csymbol><max id="S3.Ex1.m1.1.1.1.3.2.1.2.cmml" xref="S3.Ex1.m1.1.1.1.3.2.1.2"></max><ci id="S3.Ex1.m1.1.1.1.3.2.1.3.cmml" xref="S3.Ex1.m1.1.1.1.3.2.1.3">𝑦</ci></apply><apply id="S3.Ex1.m1.1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.3.2.2.1.cmml" xref="S3.Ex1.m1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.3.2.2.2.cmml" xref="S3.Ex1.m1.1.1.1.3.2.2.2">𝑃</ci><ci id="S3.Ex1.m1.1.1.1.3.2.2.3.cmml" xref="S3.Ex1.m1.1.1.1.3.2.2.3">𝑡</ci></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\displaystyle y^{*}=\arg\max_{y}P_{t}(y|x)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.3" class="ltx_Math" alttext="\displaystyle=\arg\max_{y\in\mathcal{Y}}\frac{f_{t}(x|y)P_{t}(y)}{P_{t}(x)}" display="inline"><semantics id="S3.Ex1.m2.3a"><mrow id="S3.Ex1.m2.3.4" xref="S3.Ex1.m2.3.4.cmml"><mi id="S3.Ex1.m2.3.4.2" xref="S3.Ex1.m2.3.4.2.cmml"></mi><mo id="S3.Ex1.m2.3.4.1" xref="S3.Ex1.m2.3.4.1.cmml">=</mo><mrow id="S3.Ex1.m2.3.4.3" xref="S3.Ex1.m2.3.4.3.cmml"><mi id="S3.Ex1.m2.3.4.3.1" xref="S3.Ex1.m2.3.4.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.Ex1.m2.3.4.3a" xref="S3.Ex1.m2.3.4.3.cmml">⁡</mo><mrow id="S3.Ex1.m2.3.4.3.2" xref="S3.Ex1.m2.3.4.3.2.cmml"><munder id="S3.Ex1.m2.3.4.3.2.1" xref="S3.Ex1.m2.3.4.3.2.1.cmml"><mi id="S3.Ex1.m2.3.4.3.2.1.2" xref="S3.Ex1.m2.3.4.3.2.1.2.cmml">max</mi><mrow id="S3.Ex1.m2.3.4.3.2.1.3" xref="S3.Ex1.m2.3.4.3.2.1.3.cmml"><mi id="S3.Ex1.m2.3.4.3.2.1.3.2" xref="S3.Ex1.m2.3.4.3.2.1.3.2.cmml">y</mi><mo id="S3.Ex1.m2.3.4.3.2.1.3.1" xref="S3.Ex1.m2.3.4.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.3.4.3.2.1.3.3" xref="S3.Ex1.m2.3.4.3.2.1.3.3.cmml">𝒴</mi></mrow></munder><mo lspace="0.167em" id="S3.Ex1.m2.3.4.3.2a" xref="S3.Ex1.m2.3.4.3.2.cmml">⁡</mo><mstyle displaystyle="true" id="S3.Ex1.m2.3.3" xref="S3.Ex1.m2.3.3.cmml"><mfrac id="S3.Ex1.m2.3.3a" xref="S3.Ex1.m2.3.3.cmml"><mrow id="S3.Ex1.m2.2.2.2" xref="S3.Ex1.m2.2.2.2.cmml"><msub id="S3.Ex1.m2.2.2.2.4" xref="S3.Ex1.m2.2.2.2.4.cmml"><mi id="S3.Ex1.m2.2.2.2.4.2" xref="S3.Ex1.m2.2.2.2.4.2.cmml">f</mi><mi id="S3.Ex1.m2.2.2.2.4.3" xref="S3.Ex1.m2.2.2.2.4.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.2.2.2.3" xref="S3.Ex1.m2.2.2.2.3.cmml">​</mo><mrow id="S3.Ex1.m2.2.2.2.2.1" xref="S3.Ex1.m2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m2.2.2.2.2.1.2" xref="S3.Ex1.m2.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.Ex1.m2.2.2.2.2.1.1" xref="S3.Ex1.m2.2.2.2.2.1.1.cmml"><mi id="S3.Ex1.m2.2.2.2.2.1.1.2" xref="S3.Ex1.m2.2.2.2.2.1.1.2.cmml">x</mi><mo fence="false" id="S3.Ex1.m2.2.2.2.2.1.1.1" xref="S3.Ex1.m2.2.2.2.2.1.1.1.cmml">|</mo><mi id="S3.Ex1.m2.2.2.2.2.1.1.3" xref="S3.Ex1.m2.2.2.2.2.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S3.Ex1.m2.2.2.2.2.1.3" xref="S3.Ex1.m2.2.2.2.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.2.2.2.3a" xref="S3.Ex1.m2.2.2.2.3.cmml">​</mo><msub id="S3.Ex1.m2.2.2.2.5" xref="S3.Ex1.m2.2.2.2.5.cmml"><mi id="S3.Ex1.m2.2.2.2.5.2" xref="S3.Ex1.m2.2.2.2.5.2.cmml">P</mi><mi id="S3.Ex1.m2.2.2.2.5.3" xref="S3.Ex1.m2.2.2.2.5.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.2.2.2.3b" xref="S3.Ex1.m2.2.2.2.3.cmml">​</mo><mrow id="S3.Ex1.m2.2.2.2.6.2" xref="S3.Ex1.m2.2.2.2.cmml"><mo stretchy="false" id="S3.Ex1.m2.2.2.2.6.2.1" xref="S3.Ex1.m2.2.2.2.cmml">(</mo><mi id="S3.Ex1.m2.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.cmml">y</mi><mo stretchy="false" id="S3.Ex1.m2.2.2.2.6.2.2" xref="S3.Ex1.m2.2.2.2.cmml">)</mo></mrow></mrow><mrow id="S3.Ex1.m2.3.3.3" xref="S3.Ex1.m2.3.3.3.cmml"><msub id="S3.Ex1.m2.3.3.3.3" xref="S3.Ex1.m2.3.3.3.3.cmml"><mi id="S3.Ex1.m2.3.3.3.3.2" xref="S3.Ex1.m2.3.3.3.3.2.cmml">P</mi><mi id="S3.Ex1.m2.3.3.3.3.3" xref="S3.Ex1.m2.3.3.3.3.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.3.3.3.2" xref="S3.Ex1.m2.3.3.3.2.cmml">​</mo><mrow id="S3.Ex1.m2.3.3.3.4.2" xref="S3.Ex1.m2.3.3.3.cmml"><mo stretchy="false" id="S3.Ex1.m2.3.3.3.4.2.1" xref="S3.Ex1.m2.3.3.3.cmml">(</mo><mi id="S3.Ex1.m2.3.3.3.1" xref="S3.Ex1.m2.3.3.3.1.cmml">x</mi><mo stretchy="false" id="S3.Ex1.m2.3.3.3.4.2.2" xref="S3.Ex1.m2.3.3.3.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.3b"><apply id="S3.Ex1.m2.3.4.cmml" xref="S3.Ex1.m2.3.4"><eq id="S3.Ex1.m2.3.4.1.cmml" xref="S3.Ex1.m2.3.4.1"></eq><csymbol cd="latexml" id="S3.Ex1.m2.3.4.2.cmml" xref="S3.Ex1.m2.3.4.2">absent</csymbol><apply id="S3.Ex1.m2.3.4.3.cmml" xref="S3.Ex1.m2.3.4.3"><arg id="S3.Ex1.m2.3.4.3.1.cmml" xref="S3.Ex1.m2.3.4.3.1"></arg><apply id="S3.Ex1.m2.3.4.3.2.cmml" xref="S3.Ex1.m2.3.4.3.2"><apply id="S3.Ex1.m2.3.4.3.2.1.cmml" xref="S3.Ex1.m2.3.4.3.2.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.4.3.2.1.1.cmml" xref="S3.Ex1.m2.3.4.3.2.1">subscript</csymbol><max id="S3.Ex1.m2.3.4.3.2.1.2.cmml" xref="S3.Ex1.m2.3.4.3.2.1.2"></max><apply id="S3.Ex1.m2.3.4.3.2.1.3.cmml" xref="S3.Ex1.m2.3.4.3.2.1.3"><in id="S3.Ex1.m2.3.4.3.2.1.3.1.cmml" xref="S3.Ex1.m2.3.4.3.2.1.3.1"></in><ci id="S3.Ex1.m2.3.4.3.2.1.3.2.cmml" xref="S3.Ex1.m2.3.4.3.2.1.3.2">𝑦</ci><ci id="S3.Ex1.m2.3.4.3.2.1.3.3.cmml" xref="S3.Ex1.m2.3.4.3.2.1.3.3">𝒴</ci></apply></apply><apply id="S3.Ex1.m2.3.3.cmml" xref="S3.Ex1.m2.3.3"><divide id="S3.Ex1.m2.3.3.4.cmml" xref="S3.Ex1.m2.3.3"></divide><apply id="S3.Ex1.m2.2.2.2.cmml" xref="S3.Ex1.m2.2.2.2"><times id="S3.Ex1.m2.2.2.2.3.cmml" xref="S3.Ex1.m2.2.2.2.3"></times><apply id="S3.Ex1.m2.2.2.2.4.cmml" xref="S3.Ex1.m2.2.2.2.4"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.2.4.1.cmml" xref="S3.Ex1.m2.2.2.2.4">subscript</csymbol><ci id="S3.Ex1.m2.2.2.2.4.2.cmml" xref="S3.Ex1.m2.2.2.2.4.2">𝑓</ci><ci id="S3.Ex1.m2.2.2.2.4.3.cmml" xref="S3.Ex1.m2.2.2.2.4.3">𝑡</ci></apply><apply id="S3.Ex1.m2.2.2.2.2.1.1.cmml" xref="S3.Ex1.m2.2.2.2.2.1"><csymbol cd="latexml" id="S3.Ex1.m2.2.2.2.2.1.1.1.cmml" xref="S3.Ex1.m2.2.2.2.2.1.1.1">conditional</csymbol><ci id="S3.Ex1.m2.2.2.2.2.1.1.2.cmml" xref="S3.Ex1.m2.2.2.2.2.1.1.2">𝑥</ci><ci id="S3.Ex1.m2.2.2.2.2.1.1.3.cmml" xref="S3.Ex1.m2.2.2.2.2.1.1.3">𝑦</ci></apply><apply id="S3.Ex1.m2.2.2.2.5.cmml" xref="S3.Ex1.m2.2.2.2.5"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.2.5.1.cmml" xref="S3.Ex1.m2.2.2.2.5">subscript</csymbol><ci id="S3.Ex1.m2.2.2.2.5.2.cmml" xref="S3.Ex1.m2.2.2.2.5.2">𝑃</ci><ci id="S3.Ex1.m2.2.2.2.5.3.cmml" xref="S3.Ex1.m2.2.2.2.5.3">𝑡</ci></apply><ci id="S3.Ex1.m2.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1">𝑦</ci></apply><apply id="S3.Ex1.m2.3.3.3.cmml" xref="S3.Ex1.m2.3.3.3"><times id="S3.Ex1.m2.3.3.3.2.cmml" xref="S3.Ex1.m2.3.3.3.2"></times><apply id="S3.Ex1.m2.3.3.3.3.cmml" xref="S3.Ex1.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.3.3.1.cmml" xref="S3.Ex1.m2.3.3.3.3">subscript</csymbol><ci id="S3.Ex1.m2.3.3.3.3.2.cmml" xref="S3.Ex1.m2.3.3.3.3.2">𝑃</ci><ci id="S3.Ex1.m2.3.3.3.3.3.cmml" xref="S3.Ex1.m2.3.3.3.3.3">𝑡</ci></apply><ci id="S3.Ex1.m2.3.3.3.1.cmml" xref="S3.Ex1.m2.3.3.3.1">𝑥</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.3c">\displaystyle=\arg\max_{y\in\mathcal{Y}}\frac{f_{t}(x|y)P_{t}(y)}{P_{t}(x)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4.m1.2" class="ltx_Math" alttext="\displaystyle=\arg\max_{y\in\mathcal{Y}}f_{t}(x|y)P_{t}(y)," display="inline"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml"></mi><mo id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.3.1" xref="S3.E4.m1.2.2.1.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E4.m1.2.2.1.1.1.3a" xref="S3.E4.m1.2.2.1.1.1.3.cmml">⁡</mo><mrow id="S3.E4.m1.2.2.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.3.2.cmml"><munder id="S3.E4.m1.2.2.1.1.1.3.2.1" xref="S3.E4.m1.2.2.1.1.1.3.2.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.3.2.1.2" xref="S3.E4.m1.2.2.1.1.1.3.2.1.2.cmml">max</mi><mrow id="S3.E4.m1.2.2.1.1.1.3.2.1.3" xref="S3.E4.m1.2.2.1.1.1.3.2.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.3.2.1.3.2" xref="S3.E4.m1.2.2.1.1.1.3.2.1.3.2.cmml">y</mi><mo id="S3.E4.m1.2.2.1.1.1.3.2.1.3.1" xref="S3.E4.m1.2.2.1.1.1.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.1.1.1.3.2.1.3.3" xref="S3.E4.m1.2.2.1.1.1.3.2.1.3.3.cmml">𝒴</mi></mrow></munder><mo lspace="0.167em" id="S3.E4.m1.2.2.1.1.1.3.2a" xref="S3.E4.m1.2.2.1.1.1.3.2.cmml">⁡</mo><msub id="S3.E4.m1.2.2.1.1.1.3.2.2" xref="S3.E4.m1.2.2.1.1.1.3.2.2.cmml"><mi id="S3.E4.m1.2.2.1.1.1.3.2.2.2" xref="S3.E4.m1.2.2.1.1.1.3.2.2.2.cmml">f</mi><mi id="S3.E4.m1.2.2.1.1.1.3.2.2.3" xref="S3.E4.m1.2.2.1.1.1.3.2.2.3.cmml">t</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.E4.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.2a" xref="S3.E4.m1.2.2.1.1.1.2.cmml">​</mo><msub id="S3.E4.m1.2.2.1.1.1.4" xref="S3.E4.m1.2.2.1.1.1.4.cmml"><mi id="S3.E4.m1.2.2.1.1.1.4.2" xref="S3.E4.m1.2.2.1.1.1.4.2.cmml">P</mi><mi id="S3.E4.m1.2.2.1.1.1.4.3" xref="S3.E4.m1.2.2.1.1.1.4.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.2b" xref="S3.E4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1.5.2" xref="S3.E4.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.5.2.1" xref="S3.E4.m1.2.2.1.1.1.cmml">(</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">y</mi><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.5.2.2" xref="S3.E4.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><eq id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2"></eq><csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3">absent</csymbol><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><times id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2"></times><apply id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3"><arg id="S3.E4.m1.2.2.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.3.1"></arg><apply id="S3.E4.m1.2.2.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2"><apply id="S3.E4.m1.2.2.1.1.1.3.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.3.2.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.1">subscript</csymbol><max id="S3.E4.m1.2.2.1.1.1.3.2.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.1.2"></max><apply id="S3.E4.m1.2.2.1.1.1.3.2.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.1.3"><in id="S3.E4.m1.2.2.1.1.1.3.2.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.1.3.1"></in><ci id="S3.E4.m1.2.2.1.1.1.3.2.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.1.3.2">𝑦</ci><ci id="S3.E4.m1.2.2.1.1.1.3.2.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.1.3.3">𝒴</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.3.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.3.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.2.2">𝑓</ci><ci id="S3.E4.m1.2.2.1.1.1.3.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2.2.3">𝑡</ci></apply></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3">𝑦</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.4.1.cmml" xref="S3.E4.m1.2.2.1.1.1.4">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.4.2.cmml" xref="S3.E4.m1.2.2.1.1.1.4.2">𝑃</ci><ci id="S3.E4.m1.2.2.1.1.1.4.3.cmml" xref="S3.E4.m1.2.2.1.1.1.4.3">𝑡</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\displaystyle=\arg\max_{y\in\mathcal{Y}}f_{t}(x|y)P_{t}(y),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.5" class="ltx_p">where <math id="S3.SS2.p1.3.m1.1" class="ltx_Math" alttext="f_{t}(x|y)" display="inline"><semantics id="S3.SS2.p1.3.m1.1a"><mrow id="S3.SS2.p1.3.m1.1.1" xref="S3.SS2.p1.3.m1.1.1.cmml"><msub id="S3.SS2.p1.3.m1.1.1.3" xref="S3.SS2.p1.3.m1.1.1.3.cmml"><mi id="S3.SS2.p1.3.m1.1.1.3.2" xref="S3.SS2.p1.3.m1.1.1.3.2.cmml">f</mi><mi id="S3.SS2.p1.3.m1.1.1.3.3" xref="S3.SS2.p1.3.m1.1.1.3.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m1.1.1.2" xref="S3.SS2.p1.3.m1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.3.m1.1.1.1.1" xref="S3.SS2.p1.3.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.3.m1.1.1.1.1.2" xref="S3.SS2.p1.3.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.3.m1.1.1.1.1.1" xref="S3.SS2.p1.3.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.3.m1.1.1.1.1.1.2" xref="S3.SS2.p1.3.m1.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S3.SS2.p1.3.m1.1.1.1.1.1.1" xref="S3.SS2.p1.3.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p1.3.m1.1.1.1.1.1.3" xref="S3.SS2.p1.3.m1.1.1.1.1.1.3.cmml">y</mi></mrow><mo stretchy="false" id="S3.SS2.p1.3.m1.1.1.1.1.3" xref="S3.SS2.p1.3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m1.1b"><apply id="S3.SS2.p1.3.m1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1"><times id="S3.SS2.p1.3.m1.1.1.2.cmml" xref="S3.SS2.p1.3.m1.1.1.2"></times><apply id="S3.SS2.p1.3.m1.1.1.3.cmml" xref="S3.SS2.p1.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m1.1.1.3.1.cmml" xref="S3.SS2.p1.3.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.3.m1.1.1.3.2.cmml" xref="S3.SS2.p1.3.m1.1.1.3.2">𝑓</ci><ci id="S3.SS2.p1.3.m1.1.1.3.3.cmml" xref="S3.SS2.p1.3.m1.1.1.3.3">𝑡</ci></apply><apply id="S3.SS2.p1.3.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.3.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.3.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.3.m1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.p1.3.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.3.m1.1.1.1.1.1.3">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m1.1c">f_{t}(x|y)</annotation></semantics></math> is the learned class conditional probability (likelihood) and <math id="S3.SS2.p1.4.m2.1" class="ltx_Math" alttext="P_{t}(y)" display="inline"><semantics id="S3.SS2.p1.4.m2.1a"><mrow id="S3.SS2.p1.4.m2.1.2" xref="S3.SS2.p1.4.m2.1.2.cmml"><msub id="S3.SS2.p1.4.m2.1.2.2" xref="S3.SS2.p1.4.m2.1.2.2.cmml"><mi id="S3.SS2.p1.4.m2.1.2.2.2" xref="S3.SS2.p1.4.m2.1.2.2.2.cmml">P</mi><mi id="S3.SS2.p1.4.m2.1.2.2.3" xref="S3.SS2.p1.4.m2.1.2.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.4.m2.1.2.1" xref="S3.SS2.p1.4.m2.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.4.m2.1.2.3.2" xref="S3.SS2.p1.4.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.4.m2.1.2.3.2.1" xref="S3.SS2.p1.4.m2.1.2.cmml">(</mo><mi id="S3.SS2.p1.4.m2.1.1" xref="S3.SS2.p1.4.m2.1.1.cmml">y</mi><mo stretchy="false" id="S3.SS2.p1.4.m2.1.2.3.2.2" xref="S3.SS2.p1.4.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m2.1b"><apply id="S3.SS2.p1.4.m2.1.2.cmml" xref="S3.SS2.p1.4.m2.1.2"><times id="S3.SS2.p1.4.m2.1.2.1.cmml" xref="S3.SS2.p1.4.m2.1.2.1"></times><apply id="S3.SS2.p1.4.m2.1.2.2.cmml" xref="S3.SS2.p1.4.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m2.1.2.2.1.cmml" xref="S3.SS2.p1.4.m2.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.4.m2.1.2.2.2.cmml" xref="S3.SS2.p1.4.m2.1.2.2.2">𝑃</ci><ci id="S3.SS2.p1.4.m2.1.2.2.3.cmml" xref="S3.SS2.p1.4.m2.1.2.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.4.m2.1.1.cmml" xref="S3.SS2.p1.4.m2.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m2.1c">P_{t}(y)</annotation></semantics></math> is the marginal label distribution (prior). Suppose that a discriminative model (e.g., softmax classifier) can perfectly learn the posterior distribution <math id="S3.SS2.p1.5.m3.1" class="ltx_Math" alttext="P_{s}(Y|X)" display="inline"><semantics id="S3.SS2.p1.5.m3.1a"><mrow id="S3.SS2.p1.5.m3.1.1" xref="S3.SS2.p1.5.m3.1.1.cmml"><msub id="S3.SS2.p1.5.m3.1.1.3" xref="S3.SS2.p1.5.m3.1.1.3.cmml"><mi id="S3.SS2.p1.5.m3.1.1.3.2" xref="S3.SS2.p1.5.m3.1.1.3.2.cmml">P</mi><mi id="S3.SS2.p1.5.m3.1.1.3.3" xref="S3.SS2.p1.5.m3.1.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m3.1.1.2" xref="S3.SS2.p1.5.m3.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.5.m3.1.1.1.1" xref="S3.SS2.p1.5.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.5.m3.1.1.1.1.2" xref="S3.SS2.p1.5.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.5.m3.1.1.1.1.1" xref="S3.SS2.p1.5.m3.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.5.m3.1.1.1.1.1.2" xref="S3.SS2.p1.5.m3.1.1.1.1.1.2.cmml">Y</mi><mo fence="false" id="S3.SS2.p1.5.m3.1.1.1.1.1.1" xref="S3.SS2.p1.5.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p1.5.m3.1.1.1.1.1.3" xref="S3.SS2.p1.5.m3.1.1.1.1.1.3.cmml">X</mi></mrow><mo stretchy="false" id="S3.SS2.p1.5.m3.1.1.1.1.3" xref="S3.SS2.p1.5.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m3.1b"><apply id="S3.SS2.p1.5.m3.1.1.cmml" xref="S3.SS2.p1.5.m3.1.1"><times id="S3.SS2.p1.5.m3.1.1.2.cmml" xref="S3.SS2.p1.5.m3.1.1.2"></times><apply id="S3.SS2.p1.5.m3.1.1.3.cmml" xref="S3.SS2.p1.5.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m3.1.1.3.1.cmml" xref="S3.SS2.p1.5.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.5.m3.1.1.3.2.cmml" xref="S3.SS2.p1.5.m3.1.1.3.2">𝑃</ci><ci id="S3.SS2.p1.5.m3.1.1.3.3.cmml" xref="S3.SS2.p1.5.m3.1.1.3.3">𝑠</ci></apply><apply id="S3.SS2.p1.5.m3.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.5.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.5.m3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.5.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.5.m3.1.1.1.1.1.2">𝑌</ci><ci id="S3.SS2.p1.5.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.5.m3.1.1.1.1.1.3">𝑋</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m3.1c">P_{s}(Y|X)</annotation></semantics></math> of the source dataset, then the corresponding Bayes classifier is defined as the following:</p>
<table id="S6.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\displaystyle h_{s}(x)=\arg\max_{y\in\mathcal{Y}}P_{s}(Y=y|X=x)." display="inline"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.3.cmml"><msub id="S3.E5.m1.2.2.1.1.3.2" xref="S3.E5.m1.2.2.1.1.3.2.cmml"><mi id="S3.E5.m1.2.2.1.1.3.2.2" xref="S3.E5.m1.2.2.1.1.3.2.2.cmml">h</mi><mi id="S3.E5.m1.2.2.1.1.3.2.3" xref="S3.E5.m1.2.2.1.1.3.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.3.1" xref="S3.E5.m1.2.2.1.1.3.1.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.3.3.2" xref="S3.E5.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.3.3.2.1" xref="S3.E5.m1.2.2.1.1.3.cmml">(</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E5.m1.2.2.1.1.3.3.2.2" xref="S3.E5.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.3.1" xref="S3.E5.m1.2.2.1.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E5.m1.2.2.1.1.1.3a" xref="S3.E5.m1.2.2.1.1.1.3.cmml">⁡</mo><mrow id="S3.E5.m1.2.2.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.3.2.cmml"><munder id="S3.E5.m1.2.2.1.1.1.3.2.1" xref="S3.E5.m1.2.2.1.1.1.3.2.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.3.2.1.2" xref="S3.E5.m1.2.2.1.1.1.3.2.1.2.cmml">max</mi><mrow id="S3.E5.m1.2.2.1.1.1.3.2.1.3" xref="S3.E5.m1.2.2.1.1.1.3.2.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.3.2.1.3.2" xref="S3.E5.m1.2.2.1.1.1.3.2.1.3.2.cmml">y</mi><mo id="S3.E5.m1.2.2.1.1.1.3.2.1.3.1" xref="S3.E5.m1.2.2.1.1.1.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.1.1.3.2.1.3.3" xref="S3.E5.m1.2.2.1.1.1.3.2.1.3.3.cmml">𝒴</mi></mrow></munder><mo lspace="0.167em" id="S3.E5.m1.2.2.1.1.1.3.2a" xref="S3.E5.m1.2.2.1.1.1.3.2.cmml">⁡</mo><msub id="S3.E5.m1.2.2.1.1.1.3.2.2" xref="S3.E5.m1.2.2.1.1.1.3.2.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.3.2.2.2" xref="S3.E5.m1.2.2.1.1.1.3.2.2.2.cmml">P</mi><mi id="S3.E5.m1.2.2.1.1.1.3.2.2.3" xref="S3.E5.m1.2.2.1.1.1.3.2.2.3.cmml">s</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml">Y</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.cmml">y</mi><mo fence="false" id="S3.E5.m1.2.2.1.1.1.1.1.1.4.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.cmml">|</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.4.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.3.cmml">X</mi></mrow><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.5" xref="S3.E5.m1.2.2.1.1.1.1.1.1.5.cmml">=</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.6" xref="S3.E5.m1.2.2.1.1.1.1.1.1.6.cmml">x</mi></mrow><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1"><eq id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2"></eq><apply id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3"><times id="S3.E5.m1.2.2.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.3.1"></times><apply id="S3.E5.m1.2.2.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2.2">ℎ</ci><ci id="S3.E5.m1.2.2.1.1.3.2.3.cmml" xref="S3.E5.m1.2.2.1.1.3.2.3">𝑠</ci></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑥</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3"><arg id="S3.E5.m1.2.2.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.3.1"></arg><apply id="S3.E5.m1.2.2.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2"><apply id="S3.E5.m1.2.2.1.1.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.3.2.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.1">subscript</csymbol><max id="S3.E5.m1.2.2.1.1.1.3.2.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.1.2"></max><apply id="S3.E5.m1.2.2.1.1.1.3.2.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.1.3"><in id="S3.E5.m1.2.2.1.1.1.3.2.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.1.3.1"></in><ci id="S3.E5.m1.2.2.1.1.1.3.2.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.1.3.2">𝑦</ci><ci id="S3.E5.m1.2.2.1.1.1.3.2.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.1.3.3">𝒴</ci></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.2.2">𝑃</ci><ci id="S3.E5.m1.2.2.1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3.2.2.3">𝑠</ci></apply></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"><and id="S3.E5.m1.2.2.1.1.1.1.1.1a.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"></and><apply id="S3.E5.m1.2.2.1.1.1.1.1.1b.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"><eq id="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3"></eq><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2">𝑌</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4"><csymbol cd="latexml" id="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.1">conditional</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2">𝑦</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.3">𝑋</ci></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1c.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"><eq id="S3.E5.m1.2.2.1.1.1.1.1.1.5.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.5"></eq><share href="#S3.E5.m1.2.2.1.1.1.1.1.1.4.cmml" id="S3.E5.m1.2.2.1.1.1.1.1.1d.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"></share><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.6.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.6">𝑥</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\displaystyle h_{s}(x)=\arg\max_{y\in\mathcal{Y}}P_{s}(Y=y|X=x).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.8" class="ltx_p">The classifier <math id="S3.SS2.p1.6.m1.1" class="ltx_Math" alttext="h_{s}(x)" display="inline"><semantics id="S3.SS2.p1.6.m1.1a"><mrow id="S3.SS2.p1.6.m1.1.2" xref="S3.SS2.p1.6.m1.1.2.cmml"><msub id="S3.SS2.p1.6.m1.1.2.2" xref="S3.SS2.p1.6.m1.1.2.2.cmml"><mi id="S3.SS2.p1.6.m1.1.2.2.2" xref="S3.SS2.p1.6.m1.1.2.2.2.cmml">h</mi><mi id="S3.SS2.p1.6.m1.1.2.2.3" xref="S3.SS2.p1.6.m1.1.2.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m1.1.2.1" xref="S3.SS2.p1.6.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.6.m1.1.2.3.2" xref="S3.SS2.p1.6.m1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m1.1.2.3.2.1" xref="S3.SS2.p1.6.m1.1.2.cmml">(</mo><mi id="S3.SS2.p1.6.m1.1.1" xref="S3.SS2.p1.6.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS2.p1.6.m1.1.2.3.2.2" xref="S3.SS2.p1.6.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m1.1b"><apply id="S3.SS2.p1.6.m1.1.2.cmml" xref="S3.SS2.p1.6.m1.1.2"><times id="S3.SS2.p1.6.m1.1.2.1.cmml" xref="S3.SS2.p1.6.m1.1.2.1"></times><apply id="S3.SS2.p1.6.m1.1.2.2.cmml" xref="S3.SS2.p1.6.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m1.1.2.2.1.cmml" xref="S3.SS2.p1.6.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.6.m1.1.2.2.2.cmml" xref="S3.SS2.p1.6.m1.1.2.2.2">ℎ</ci><ci id="S3.SS2.p1.6.m1.1.2.2.3.cmml" xref="S3.SS2.p1.6.m1.1.2.2.3">𝑠</ci></apply><ci id="S3.SS2.p1.6.m1.1.1.cmml" xref="S3.SS2.p1.6.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m1.1c">h_{s}(x)</annotation></semantics></math> is the optimal classifier on the training distribution. By further assuming that the test distribution has the same class conditional likelihood as the training set, i.e. <math id="S3.SS2.p1.7.m2.2" class="ltx_Math" alttext="f_{t}(X|Y)=f_{s}(X|Y)" display="inline"><semantics id="S3.SS2.p1.7.m2.2a"><mrow id="S3.SS2.p1.7.m2.2.2" xref="S3.SS2.p1.7.m2.2.2.cmml"><mrow id="S3.SS2.p1.7.m2.1.1.1" xref="S3.SS2.p1.7.m2.1.1.1.cmml"><msub id="S3.SS2.p1.7.m2.1.1.1.3" xref="S3.SS2.p1.7.m2.1.1.1.3.cmml"><mi id="S3.SS2.p1.7.m2.1.1.1.3.2" xref="S3.SS2.p1.7.m2.1.1.1.3.2.cmml">f</mi><mi id="S3.SS2.p1.7.m2.1.1.1.3.3" xref="S3.SS2.p1.7.m2.1.1.1.3.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m2.1.1.1.2" xref="S3.SS2.p1.7.m2.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.7.m2.1.1.1.1.1" xref="S3.SS2.p1.7.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.7.m2.1.1.1.1.1.2" xref="S3.SS2.p1.7.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.7.m2.1.1.1.1.1.1" xref="S3.SS2.p1.7.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.7.m2.1.1.1.1.1.1.2" xref="S3.SS2.p1.7.m2.1.1.1.1.1.1.2.cmml">X</mi><mo fence="false" id="S3.SS2.p1.7.m2.1.1.1.1.1.1.1" xref="S3.SS2.p1.7.m2.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p1.7.m2.1.1.1.1.1.1.3" xref="S3.SS2.p1.7.m2.1.1.1.1.1.1.3.cmml">Y</mi></mrow><mo stretchy="false" id="S3.SS2.p1.7.m2.1.1.1.1.1.3" xref="S3.SS2.p1.7.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.7.m2.2.2.3" xref="S3.SS2.p1.7.m2.2.2.3.cmml">=</mo><mrow id="S3.SS2.p1.7.m2.2.2.2" xref="S3.SS2.p1.7.m2.2.2.2.cmml"><msub id="S3.SS2.p1.7.m2.2.2.2.3" xref="S3.SS2.p1.7.m2.2.2.2.3.cmml"><mi id="S3.SS2.p1.7.m2.2.2.2.3.2" xref="S3.SS2.p1.7.m2.2.2.2.3.2.cmml">f</mi><mi id="S3.SS2.p1.7.m2.2.2.2.3.3" xref="S3.SS2.p1.7.m2.2.2.2.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.7.m2.2.2.2.2" xref="S3.SS2.p1.7.m2.2.2.2.2.cmml">​</mo><mrow id="S3.SS2.p1.7.m2.2.2.2.1.1" xref="S3.SS2.p1.7.m2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.7.m2.2.2.2.1.1.2" xref="S3.SS2.p1.7.m2.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.7.m2.2.2.2.1.1.1" xref="S3.SS2.p1.7.m2.2.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.7.m2.2.2.2.1.1.1.2" xref="S3.SS2.p1.7.m2.2.2.2.1.1.1.2.cmml">X</mi><mo fence="false" id="S3.SS2.p1.7.m2.2.2.2.1.1.1.1" xref="S3.SS2.p1.7.m2.2.2.2.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p1.7.m2.2.2.2.1.1.1.3" xref="S3.SS2.p1.7.m2.2.2.2.1.1.1.3.cmml">Y</mi></mrow><mo stretchy="false" id="S3.SS2.p1.7.m2.2.2.2.1.1.3" xref="S3.SS2.p1.7.m2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m2.2b"><apply id="S3.SS2.p1.7.m2.2.2.cmml" xref="S3.SS2.p1.7.m2.2.2"><eq id="S3.SS2.p1.7.m2.2.2.3.cmml" xref="S3.SS2.p1.7.m2.2.2.3"></eq><apply id="S3.SS2.p1.7.m2.1.1.1.cmml" xref="S3.SS2.p1.7.m2.1.1.1"><times id="S3.SS2.p1.7.m2.1.1.1.2.cmml" xref="S3.SS2.p1.7.m2.1.1.1.2"></times><apply id="S3.SS2.p1.7.m2.1.1.1.3.cmml" xref="S3.SS2.p1.7.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m2.1.1.1.3.1.cmml" xref="S3.SS2.p1.7.m2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.7.m2.1.1.1.3.2.cmml" xref="S3.SS2.p1.7.m2.1.1.1.3.2">𝑓</ci><ci id="S3.SS2.p1.7.m2.1.1.1.3.3.cmml" xref="S3.SS2.p1.7.m2.1.1.1.3.3">𝑡</ci></apply><apply id="S3.SS2.p1.7.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m2.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.7.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.7.m2.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.7.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.7.m2.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS2.p1.7.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.7.m2.1.1.1.1.1.1.3">𝑌</ci></apply></apply><apply id="S3.SS2.p1.7.m2.2.2.2.cmml" xref="S3.SS2.p1.7.m2.2.2.2"><times id="S3.SS2.p1.7.m2.2.2.2.2.cmml" xref="S3.SS2.p1.7.m2.2.2.2.2"></times><apply id="S3.SS2.p1.7.m2.2.2.2.3.cmml" xref="S3.SS2.p1.7.m2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m2.2.2.2.3.1.cmml" xref="S3.SS2.p1.7.m2.2.2.2.3">subscript</csymbol><ci id="S3.SS2.p1.7.m2.2.2.2.3.2.cmml" xref="S3.SS2.p1.7.m2.2.2.2.3.2">𝑓</ci><ci id="S3.SS2.p1.7.m2.2.2.2.3.3.cmml" xref="S3.SS2.p1.7.m2.2.2.2.3.3">𝑠</ci></apply><apply id="S3.SS2.p1.7.m2.2.2.2.1.1.1.cmml" xref="S3.SS2.p1.7.m2.2.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.p1.7.m2.2.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.7.m2.2.2.2.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.7.m2.2.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.7.m2.2.2.2.1.1.1.2">𝑋</ci><ci id="S3.SS2.p1.7.m2.2.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.7.m2.2.2.2.1.1.1.3">𝑌</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m2.2c">f_{t}(X|Y)=f_{s}(X|Y)</annotation></semantics></math> and differs only on the class priors <math id="S3.SS2.p1.8.m3.2" class="ltx_Math" alttext="P_{t}(Y)\neq P_{s}(Y)" display="inline"><semantics id="S3.SS2.p1.8.m3.2a"><mrow id="S3.SS2.p1.8.m3.2.3" xref="S3.SS2.p1.8.m3.2.3.cmml"><mrow id="S3.SS2.p1.8.m3.2.3.2" xref="S3.SS2.p1.8.m3.2.3.2.cmml"><msub id="S3.SS2.p1.8.m3.2.3.2.2" xref="S3.SS2.p1.8.m3.2.3.2.2.cmml"><mi id="S3.SS2.p1.8.m3.2.3.2.2.2" xref="S3.SS2.p1.8.m3.2.3.2.2.2.cmml">P</mi><mi id="S3.SS2.p1.8.m3.2.3.2.2.3" xref="S3.SS2.p1.8.m3.2.3.2.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.8.m3.2.3.2.1" xref="S3.SS2.p1.8.m3.2.3.2.1.cmml">​</mo><mrow id="S3.SS2.p1.8.m3.2.3.2.3.2" xref="S3.SS2.p1.8.m3.2.3.2.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m3.2.3.2.3.2.1" xref="S3.SS2.p1.8.m3.2.3.2.cmml">(</mo><mi id="S3.SS2.p1.8.m3.1.1" xref="S3.SS2.p1.8.m3.1.1.cmml">Y</mi><mo stretchy="false" id="S3.SS2.p1.8.m3.2.3.2.3.2.2" xref="S3.SS2.p1.8.m3.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.8.m3.2.3.1" xref="S3.SS2.p1.8.m3.2.3.1.cmml">≠</mo><mrow id="S3.SS2.p1.8.m3.2.3.3" xref="S3.SS2.p1.8.m3.2.3.3.cmml"><msub id="S3.SS2.p1.8.m3.2.3.3.2" xref="S3.SS2.p1.8.m3.2.3.3.2.cmml"><mi id="S3.SS2.p1.8.m3.2.3.3.2.2" xref="S3.SS2.p1.8.m3.2.3.3.2.2.cmml">P</mi><mi id="S3.SS2.p1.8.m3.2.3.3.2.3" xref="S3.SS2.p1.8.m3.2.3.3.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.8.m3.2.3.3.1" xref="S3.SS2.p1.8.m3.2.3.3.1.cmml">​</mo><mrow id="S3.SS2.p1.8.m3.2.3.3.3.2" xref="S3.SS2.p1.8.m3.2.3.3.cmml"><mo stretchy="false" id="S3.SS2.p1.8.m3.2.3.3.3.2.1" xref="S3.SS2.p1.8.m3.2.3.3.cmml">(</mo><mi id="S3.SS2.p1.8.m3.2.2" xref="S3.SS2.p1.8.m3.2.2.cmml">Y</mi><mo stretchy="false" id="S3.SS2.p1.8.m3.2.3.3.3.2.2" xref="S3.SS2.p1.8.m3.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m3.2b"><apply id="S3.SS2.p1.8.m3.2.3.cmml" xref="S3.SS2.p1.8.m3.2.3"><neq id="S3.SS2.p1.8.m3.2.3.1.cmml" xref="S3.SS2.p1.8.m3.2.3.1"></neq><apply id="S3.SS2.p1.8.m3.2.3.2.cmml" xref="S3.SS2.p1.8.m3.2.3.2"><times id="S3.SS2.p1.8.m3.2.3.2.1.cmml" xref="S3.SS2.p1.8.m3.2.3.2.1"></times><apply id="S3.SS2.p1.8.m3.2.3.2.2.cmml" xref="S3.SS2.p1.8.m3.2.3.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m3.2.3.2.2.1.cmml" xref="S3.SS2.p1.8.m3.2.3.2.2">subscript</csymbol><ci id="S3.SS2.p1.8.m3.2.3.2.2.2.cmml" xref="S3.SS2.p1.8.m3.2.3.2.2.2">𝑃</ci><ci id="S3.SS2.p1.8.m3.2.3.2.2.3.cmml" xref="S3.SS2.p1.8.m3.2.3.2.2.3">𝑡</ci></apply><ci id="S3.SS2.p1.8.m3.1.1.cmml" xref="S3.SS2.p1.8.m3.1.1">𝑌</ci></apply><apply id="S3.SS2.p1.8.m3.2.3.3.cmml" xref="S3.SS2.p1.8.m3.2.3.3"><times id="S3.SS2.p1.8.m3.2.3.3.1.cmml" xref="S3.SS2.p1.8.m3.2.3.3.1"></times><apply id="S3.SS2.p1.8.m3.2.3.3.2.cmml" xref="S3.SS2.p1.8.m3.2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m3.2.3.3.2.1.cmml" xref="S3.SS2.p1.8.m3.2.3.3.2">subscript</csymbol><ci id="S3.SS2.p1.8.m3.2.3.3.2.2.cmml" xref="S3.SS2.p1.8.m3.2.3.3.2.2">𝑃</ci><ci id="S3.SS2.p1.8.m3.2.3.3.2.3.cmml" xref="S3.SS2.p1.8.m3.2.3.3.2.3">𝑠</ci></apply><ci id="S3.SS2.p1.8.m3.2.2.cmml" xref="S3.SS2.p1.8.m3.2.2">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m3.2c">P_{t}(Y)\neq P_{s}(Y)</annotation></semantics></math>. Then the optimal Bayes classifier on target distribution is given by the following expression:</p>
<table id="S6.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6.m1.5" class="ltx_Math" alttext="\displaystyle h_{t}(x)=\arg\max_{y\in\mathcal{Y}}\frac{P_{s}(y|x)P_{t}(y)}{P_{s}(y)}." display="inline"><semantics id="S3.E6.m1.5a"><mrow id="S3.E6.m1.5.5.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><mrow id="S3.E6.m1.5.5.1.1.2" xref="S3.E6.m1.5.5.1.1.2.cmml"><msub id="S3.E6.m1.5.5.1.1.2.2" xref="S3.E6.m1.5.5.1.1.2.2.cmml"><mi id="S3.E6.m1.5.5.1.1.2.2.2" xref="S3.E6.m1.5.5.1.1.2.2.2.cmml">h</mi><mi id="S3.E6.m1.5.5.1.1.2.2.3" xref="S3.E6.m1.5.5.1.1.2.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.1.1.2.1" xref="S3.E6.m1.5.5.1.1.2.1.cmml">​</mo><mrow id="S3.E6.m1.5.5.1.1.2.3.2" xref="S3.E6.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.5.5.1.1.2.3.2.1" xref="S3.E6.m1.5.5.1.1.2.cmml">(</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">x</mi><mo stretchy="false" id="S3.E6.m1.5.5.1.1.2.3.2.2" xref="S3.E6.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.5.5.1.1.1" xref="S3.E6.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.5.5.1.1.3" xref="S3.E6.m1.5.5.1.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.3.1" xref="S3.E6.m1.5.5.1.1.3.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E6.m1.5.5.1.1.3a" xref="S3.E6.m1.5.5.1.1.3.cmml">⁡</mo><mrow id="S3.E6.m1.5.5.1.1.3.2" xref="S3.E6.m1.5.5.1.1.3.2.cmml"><munder id="S3.E6.m1.5.5.1.1.3.2.1" xref="S3.E6.m1.5.5.1.1.3.2.1.cmml"><mi id="S3.E6.m1.5.5.1.1.3.2.1.2" xref="S3.E6.m1.5.5.1.1.3.2.1.2.cmml">max</mi><mrow id="S3.E6.m1.5.5.1.1.3.2.1.3" xref="S3.E6.m1.5.5.1.1.3.2.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.3.2.1.3.2" xref="S3.E6.m1.5.5.1.1.3.2.1.3.2.cmml">y</mi><mo id="S3.E6.m1.5.5.1.1.3.2.1.3.1" xref="S3.E6.m1.5.5.1.1.3.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.5.5.1.1.3.2.1.3.3" xref="S3.E6.m1.5.5.1.1.3.2.1.3.3.cmml">𝒴</mi></mrow></munder><mo lspace="0.167em" id="S3.E6.m1.5.5.1.1.3.2a" xref="S3.E6.m1.5.5.1.1.3.2.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml"><mfrac id="S3.E6.m1.3.3a" xref="S3.E6.m1.3.3.cmml"><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><msub id="S3.E6.m1.2.2.2.4" xref="S3.E6.m1.2.2.2.4.cmml"><mi id="S3.E6.m1.2.2.2.4.2" xref="S3.E6.m1.2.2.2.4.2.cmml">P</mi><mi id="S3.E6.m1.2.2.2.4.3" xref="S3.E6.m1.2.2.2.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.2.2.1" xref="S3.E6.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.2.2.1.2" xref="S3.E6.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.2.2.1.1" xref="S3.E6.m1.2.2.2.2.1.1.cmml"><mi id="S3.E6.m1.2.2.2.2.1.1.2" xref="S3.E6.m1.2.2.2.2.1.1.2.cmml">y</mi><mo fence="false" id="S3.E6.m1.2.2.2.2.1.1.1" xref="S3.E6.m1.2.2.2.2.1.1.1.cmml">|</mo><mi id="S3.E6.m1.2.2.2.2.1.1.3" xref="S3.E6.m1.2.2.2.2.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S3.E6.m1.2.2.2.2.1.3" xref="S3.E6.m1.2.2.2.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.3a" xref="S3.E6.m1.2.2.2.3.cmml">​</mo><msub id="S3.E6.m1.2.2.2.5" xref="S3.E6.m1.2.2.2.5.cmml"><mi id="S3.E6.m1.2.2.2.5.2" xref="S3.E6.m1.2.2.2.5.2.cmml">P</mi><mi id="S3.E6.m1.2.2.2.5.3" xref="S3.E6.m1.2.2.2.5.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.3b" xref="S3.E6.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.2.6.2" xref="S3.E6.m1.2.2.2.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.2.6.2.1" xref="S3.E6.m1.2.2.2.cmml">(</mo><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">y</mi><mo stretchy="false" id="S3.E6.m1.2.2.2.6.2.2" xref="S3.E6.m1.2.2.2.cmml">)</mo></mrow></mrow><mrow id="S3.E6.m1.3.3.3" xref="S3.E6.m1.3.3.3.cmml"><msub id="S3.E6.m1.3.3.3.3" xref="S3.E6.m1.3.3.3.3.cmml"><mi id="S3.E6.m1.3.3.3.3.2" xref="S3.E6.m1.3.3.3.3.2.cmml">P</mi><mi id="S3.E6.m1.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.2" xref="S3.E6.m1.3.3.3.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.3.4.2" xref="S3.E6.m1.3.3.3.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.3.4.2.1" xref="S3.E6.m1.3.3.3.cmml">(</mo><mi id="S3.E6.m1.3.3.3.1" xref="S3.E6.m1.3.3.3.1.cmml">y</mi><mo stretchy="false" id="S3.E6.m1.3.3.3.4.2.2" xref="S3.E6.m1.3.3.3.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.5.5.1.2" xref="S3.E6.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.5b"><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1"><eq id="S3.E6.m1.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1"></eq><apply id="S3.E6.m1.5.5.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.2"><times id="S3.E6.m1.5.5.1.1.2.1.cmml" xref="S3.E6.m1.5.5.1.1.2.1"></times><apply id="S3.E6.m1.5.5.1.1.2.2.cmml" xref="S3.E6.m1.5.5.1.1.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.2.2.1.cmml" xref="S3.E6.m1.5.5.1.1.2.2">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.2.2.2.cmml" xref="S3.E6.m1.5.5.1.1.2.2.2">ℎ</ci><ci id="S3.E6.m1.5.5.1.1.2.2.3.cmml" xref="S3.E6.m1.5.5.1.1.2.2.3">𝑡</ci></apply><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝑥</ci></apply><apply id="S3.E6.m1.5.5.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.3"><arg id="S3.E6.m1.5.5.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3.1"></arg><apply id="S3.E6.m1.5.5.1.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.3.2"><apply id="S3.E6.m1.5.5.1.1.3.2.1.cmml" xref="S3.E6.m1.5.5.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.3.2.1.1.cmml" xref="S3.E6.m1.5.5.1.1.3.2.1">subscript</csymbol><max id="S3.E6.m1.5.5.1.1.3.2.1.2.cmml" xref="S3.E6.m1.5.5.1.1.3.2.1.2"></max><apply id="S3.E6.m1.5.5.1.1.3.2.1.3.cmml" xref="S3.E6.m1.5.5.1.1.3.2.1.3"><in id="S3.E6.m1.5.5.1.1.3.2.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3.2.1.3.1"></in><ci id="S3.E6.m1.5.5.1.1.3.2.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.3.2.1.3.2">𝑦</ci><ci id="S3.E6.m1.5.5.1.1.3.2.1.3.3.cmml" xref="S3.E6.m1.5.5.1.1.3.2.1.3.3">𝒴</ci></apply></apply><apply id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3"><divide id="S3.E6.m1.3.3.4.cmml" xref="S3.E6.m1.3.3"></divide><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><times id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3"></times><apply id="S3.E6.m1.2.2.2.4.cmml" xref="S3.E6.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.4.1.cmml" xref="S3.E6.m1.2.2.2.4">subscript</csymbol><ci id="S3.E6.m1.2.2.2.4.2.cmml" xref="S3.E6.m1.2.2.2.4.2">𝑃</ci><ci id="S3.E6.m1.2.2.2.4.3.cmml" xref="S3.E6.m1.2.2.2.4.3">𝑠</ci></apply><apply id="S3.E6.m1.2.2.2.2.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E6.m1.2.2.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.2.2.1.1.1">conditional</csymbol><ci id="S3.E6.m1.2.2.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="S3.E6.m1.2.2.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.2.2.1.1.3">𝑥</ci></apply><apply id="S3.E6.m1.2.2.2.5.cmml" xref="S3.E6.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.5.1.cmml" xref="S3.E6.m1.2.2.2.5">subscript</csymbol><ci id="S3.E6.m1.2.2.2.5.2.cmml" xref="S3.E6.m1.2.2.2.5.2">𝑃</ci><ci id="S3.E6.m1.2.2.2.5.3.cmml" xref="S3.E6.m1.2.2.2.5.3">𝑡</ci></apply><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑦</ci></apply><apply id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.3"><times id="S3.E6.m1.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3.2"></times><apply id="S3.E6.m1.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.3">subscript</csymbol><ci id="S3.E6.m1.3.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3.3.2">𝑃</ci><ci id="S3.E6.m1.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3">𝑠</ci></apply><ci id="S3.E6.m1.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.1">𝑦</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.5c">\displaystyle h_{t}(x)=\arg\max_{y\in\mathcal{Y}}\frac{P_{s}(y|x)P_{t}(y)}{P_{s}(y)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.6" class="ltx_p">However, in the federated setting, samples on some labels might be totally missing for a local client, which would make the calibration ill-conditioned. One the other hand, notice that</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.10" class="ltx_Math" alttext="\small h_{t}(x)=\arg\max_{y\in\mathcal{Y}}\frac{P_{s}(x,y)P_{t}(y)}{P_{s}(x)P_{s}(y)}=\arg\max_{y\in\mathcal{Y}}\frac{P_{s}(x|y)P_{t}(y)}{P_{s}(x)}." display="block"><semantics id="S3.E7.m1.10a"><mrow id="S3.E7.m1.10.10.1" xref="S3.E7.m1.10.10.1.1.cmml"><mrow id="S3.E7.m1.10.10.1.1" xref="S3.E7.m1.10.10.1.1.cmml"><mrow id="S3.E7.m1.10.10.1.1.2" xref="S3.E7.m1.10.10.1.1.2.cmml"><msub id="S3.E7.m1.10.10.1.1.2.2" xref="S3.E7.m1.10.10.1.1.2.2.cmml"><mi mathsize="90%" id="S3.E7.m1.10.10.1.1.2.2.2" xref="S3.E7.m1.10.10.1.1.2.2.2.cmml">h</mi><mi mathsize="90%" id="S3.E7.m1.10.10.1.1.2.2.3" xref="S3.E7.m1.10.10.1.1.2.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.10.10.1.1.2.1" xref="S3.E7.m1.10.10.1.1.2.1.cmml">​</mo><mrow id="S3.E7.m1.10.10.1.1.2.3.2" xref="S3.E7.m1.10.10.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.10.10.1.1.2.3.2.1" xref="S3.E7.m1.10.10.1.1.2.cmml">(</mo><mi mathsize="90%" id="S3.E7.m1.9.9" xref="S3.E7.m1.9.9.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S3.E7.m1.10.10.1.1.2.3.2.2" xref="S3.E7.m1.10.10.1.1.2.cmml">)</mo></mrow></mrow><mo mathsize="90%" id="S3.E7.m1.10.10.1.1.3" xref="S3.E7.m1.10.10.1.1.3.cmml">=</mo><mrow id="S3.E7.m1.10.10.1.1.4" xref="S3.E7.m1.10.10.1.1.4.cmml"><mi mathsize="90%" id="S3.E7.m1.10.10.1.1.4.1" xref="S3.E7.m1.10.10.1.1.4.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E7.m1.10.10.1.1.4a" xref="S3.E7.m1.10.10.1.1.4.cmml">⁡</mo><mrow id="S3.E7.m1.10.10.1.1.4.2" xref="S3.E7.m1.10.10.1.1.4.2.cmml"><munder id="S3.E7.m1.10.10.1.1.4.2.1" xref="S3.E7.m1.10.10.1.1.4.2.1.cmml"><mi mathsize="90%" id="S3.E7.m1.10.10.1.1.4.2.1.2" xref="S3.E7.m1.10.10.1.1.4.2.1.2.cmml">max</mi><mrow id="S3.E7.m1.10.10.1.1.4.2.1.3" xref="S3.E7.m1.10.10.1.1.4.2.1.3.cmml"><mi mathsize="90%" id="S3.E7.m1.10.10.1.1.4.2.1.3.2" xref="S3.E7.m1.10.10.1.1.4.2.1.3.2.cmml">y</mi><mo mathsize="90%" id="S3.E7.m1.10.10.1.1.4.2.1.3.1" xref="S3.E7.m1.10.10.1.1.4.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E7.m1.10.10.1.1.4.2.1.3.3" xref="S3.E7.m1.10.10.1.1.4.2.1.3.3.cmml">𝒴</mi></mrow></munder><mo lspace="0.167em" id="S3.E7.m1.10.10.1.1.4.2a" xref="S3.E7.m1.10.10.1.1.4.2.cmml">⁡</mo><mfrac id="S3.E7.m1.5.5" xref="S3.E7.m1.5.5.cmml"><mrow id="S3.E7.m1.3.3.3" xref="S3.E7.m1.3.3.3.cmml"><msub id="S3.E7.m1.3.3.3.5" xref="S3.E7.m1.3.3.3.5.cmml"><mi mathsize="90%" id="S3.E7.m1.3.3.3.5.2" xref="S3.E7.m1.3.3.3.5.2.cmml">P</mi><mi mathsize="90%" id="S3.E7.m1.3.3.3.5.3" xref="S3.E7.m1.3.3.3.5.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.3.4" xref="S3.E7.m1.3.3.3.4.cmml">​</mo><mrow id="S3.E7.m1.3.3.3.6.2" xref="S3.E7.m1.3.3.3.6.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.3.3.3.6.2.1" xref="S3.E7.m1.3.3.3.6.1.cmml">(</mo><mi mathsize="90%" id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">x</mi><mo mathsize="90%" id="S3.E7.m1.3.3.3.6.2.2" xref="S3.E7.m1.3.3.3.6.1.cmml">,</mo><mi mathsize="90%" id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">y</mi><mo maxsize="90%" minsize="90%" id="S3.E7.m1.3.3.3.6.2.3" xref="S3.E7.m1.3.3.3.6.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.3.4a" xref="S3.E7.m1.3.3.3.4.cmml">​</mo><msub id="S3.E7.m1.3.3.3.7" xref="S3.E7.m1.3.3.3.7.cmml"><mi mathsize="90%" id="S3.E7.m1.3.3.3.7.2" xref="S3.E7.m1.3.3.3.7.2.cmml">P</mi><mi mathsize="90%" id="S3.E7.m1.3.3.3.7.3" xref="S3.E7.m1.3.3.3.7.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.3.4b" xref="S3.E7.m1.3.3.3.4.cmml">​</mo><mrow id="S3.E7.m1.3.3.3.8.2" xref="S3.E7.m1.3.3.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.3.3.3.8.2.1" xref="S3.E7.m1.3.3.3.cmml">(</mo><mi mathsize="90%" id="S3.E7.m1.3.3.3.3" xref="S3.E7.m1.3.3.3.3.cmml">y</mi><mo maxsize="90%" minsize="90%" id="S3.E7.m1.3.3.3.8.2.2" xref="S3.E7.m1.3.3.3.cmml">)</mo></mrow></mrow><mrow id="S3.E7.m1.5.5.5" xref="S3.E7.m1.5.5.5.cmml"><msub id="S3.E7.m1.5.5.5.4" xref="S3.E7.m1.5.5.5.4.cmml"><mi mathsize="90%" id="S3.E7.m1.5.5.5.4.2" xref="S3.E7.m1.5.5.5.4.2.cmml">P</mi><mi mathsize="90%" id="S3.E7.m1.5.5.5.4.3" xref="S3.E7.m1.5.5.5.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.5.3" xref="S3.E7.m1.5.5.5.3.cmml">​</mo><mrow id="S3.E7.m1.5.5.5.5.2" xref="S3.E7.m1.5.5.5.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.5.5.5.5.2.1" xref="S3.E7.m1.5.5.5.cmml">(</mo><mi mathsize="90%" id="S3.E7.m1.4.4.4.1" xref="S3.E7.m1.4.4.4.1.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S3.E7.m1.5.5.5.5.2.2" xref="S3.E7.m1.5.5.5.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.5.3a" xref="S3.E7.m1.5.5.5.3.cmml">​</mo><msub id="S3.E7.m1.5.5.5.6" xref="S3.E7.m1.5.5.5.6.cmml"><mi mathsize="90%" id="S3.E7.m1.5.5.5.6.2" xref="S3.E7.m1.5.5.5.6.2.cmml">P</mi><mi mathsize="90%" id="S3.E7.m1.5.5.5.6.3" xref="S3.E7.m1.5.5.5.6.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.5.3b" xref="S3.E7.m1.5.5.5.3.cmml">​</mo><mrow id="S3.E7.m1.5.5.5.7.2" xref="S3.E7.m1.5.5.5.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.5.5.5.7.2.1" xref="S3.E7.m1.5.5.5.cmml">(</mo><mi mathsize="90%" id="S3.E7.m1.5.5.5.2" xref="S3.E7.m1.5.5.5.2.cmml">y</mi><mo maxsize="90%" minsize="90%" id="S3.E7.m1.5.5.5.7.2.2" xref="S3.E7.m1.5.5.5.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo mathsize="90%" id="S3.E7.m1.10.10.1.1.5" xref="S3.E7.m1.10.10.1.1.5.cmml">=</mo><mrow id="S3.E7.m1.10.10.1.1.6" xref="S3.E7.m1.10.10.1.1.6.cmml"><mi mathsize="90%" id="S3.E7.m1.10.10.1.1.6.1" xref="S3.E7.m1.10.10.1.1.6.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E7.m1.10.10.1.1.6a" xref="S3.E7.m1.10.10.1.1.6.cmml">⁡</mo><mrow id="S3.E7.m1.10.10.1.1.6.2" xref="S3.E7.m1.10.10.1.1.6.2.cmml"><munder id="S3.E7.m1.10.10.1.1.6.2.1" xref="S3.E7.m1.10.10.1.1.6.2.1.cmml"><mi mathsize="90%" id="S3.E7.m1.10.10.1.1.6.2.1.2" xref="S3.E7.m1.10.10.1.1.6.2.1.2.cmml">max</mi><mrow id="S3.E7.m1.10.10.1.1.6.2.1.3" xref="S3.E7.m1.10.10.1.1.6.2.1.3.cmml"><mi mathsize="90%" id="S3.E7.m1.10.10.1.1.6.2.1.3.2" xref="S3.E7.m1.10.10.1.1.6.2.1.3.2.cmml">y</mi><mo mathsize="90%" id="S3.E7.m1.10.10.1.1.6.2.1.3.1" xref="S3.E7.m1.10.10.1.1.6.2.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.E7.m1.10.10.1.1.6.2.1.3.3" xref="S3.E7.m1.10.10.1.1.6.2.1.3.3.cmml">𝒴</mi></mrow></munder><mo lspace="0.167em" id="S3.E7.m1.10.10.1.1.6.2a" xref="S3.E7.m1.10.10.1.1.6.2.cmml">⁡</mo><mfrac id="S3.E7.m1.8.8" xref="S3.E7.m1.8.8.cmml"><mrow id="S3.E7.m1.7.7.2" xref="S3.E7.m1.7.7.2.cmml"><msub id="S3.E7.m1.7.7.2.4" xref="S3.E7.m1.7.7.2.4.cmml"><mi mathsize="90%" id="S3.E7.m1.7.7.2.4.2" xref="S3.E7.m1.7.7.2.4.2.cmml">P</mi><mi mathsize="90%" id="S3.E7.m1.7.7.2.4.3" xref="S3.E7.m1.7.7.2.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.7.7.2.3" xref="S3.E7.m1.7.7.2.3.cmml">​</mo><mrow id="S3.E7.m1.7.7.2.2.1" xref="S3.E7.m1.7.7.2.2.1.1.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.7.7.2.2.1.2" xref="S3.E7.m1.7.7.2.2.1.1.cmml">(</mo><mrow id="S3.E7.m1.7.7.2.2.1.1" xref="S3.E7.m1.7.7.2.2.1.1.cmml"><mi mathsize="90%" id="S3.E7.m1.7.7.2.2.1.1.2" xref="S3.E7.m1.7.7.2.2.1.1.2.cmml">x</mi><mo fence="false" mathsize="90%" id="S3.E7.m1.7.7.2.2.1.1.1" xref="S3.E7.m1.7.7.2.2.1.1.1.cmml">|</mo><mi mathsize="90%" id="S3.E7.m1.7.7.2.2.1.1.3" xref="S3.E7.m1.7.7.2.2.1.1.3.cmml">y</mi></mrow><mo maxsize="90%" minsize="90%" id="S3.E7.m1.7.7.2.2.1.3" xref="S3.E7.m1.7.7.2.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.7.7.2.3a" xref="S3.E7.m1.7.7.2.3.cmml">​</mo><msub id="S3.E7.m1.7.7.2.5" xref="S3.E7.m1.7.7.2.5.cmml"><mi mathsize="90%" id="S3.E7.m1.7.7.2.5.2" xref="S3.E7.m1.7.7.2.5.2.cmml">P</mi><mi mathsize="90%" id="S3.E7.m1.7.7.2.5.3" xref="S3.E7.m1.7.7.2.5.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.7.7.2.3b" xref="S3.E7.m1.7.7.2.3.cmml">​</mo><mrow id="S3.E7.m1.7.7.2.6.2" xref="S3.E7.m1.7.7.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.7.7.2.6.2.1" xref="S3.E7.m1.7.7.2.cmml">(</mo><mi mathsize="90%" id="S3.E7.m1.6.6.1.1" xref="S3.E7.m1.6.6.1.1.cmml">y</mi><mo maxsize="90%" minsize="90%" id="S3.E7.m1.7.7.2.6.2.2" xref="S3.E7.m1.7.7.2.cmml">)</mo></mrow></mrow><mrow id="S3.E7.m1.8.8.3" xref="S3.E7.m1.8.8.3.cmml"><msub id="S3.E7.m1.8.8.3.3" xref="S3.E7.m1.8.8.3.3.cmml"><mi mathsize="90%" id="S3.E7.m1.8.8.3.3.2" xref="S3.E7.m1.8.8.3.3.2.cmml">P</mi><mi mathsize="90%" id="S3.E7.m1.8.8.3.3.3" xref="S3.E7.m1.8.8.3.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.8.8.3.2" xref="S3.E7.m1.8.8.3.2.cmml">​</mo><mrow id="S3.E7.m1.8.8.3.4.2" xref="S3.E7.m1.8.8.3.cmml"><mo maxsize="90%" minsize="90%" id="S3.E7.m1.8.8.3.4.2.1" xref="S3.E7.m1.8.8.3.cmml">(</mo><mi mathsize="90%" id="S3.E7.m1.8.8.3.1" xref="S3.E7.m1.8.8.3.1.cmml">x</mi><mo maxsize="90%" minsize="90%" id="S3.E7.m1.8.8.3.4.2.2" xref="S3.E7.m1.8.8.3.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo lspace="0em" mathsize="90%" id="S3.E7.m1.10.10.1.2" xref="S3.E7.m1.10.10.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.10b"><apply id="S3.E7.m1.10.10.1.1.cmml" xref="S3.E7.m1.10.10.1"><and id="S3.E7.m1.10.10.1.1a.cmml" xref="S3.E7.m1.10.10.1"></and><apply id="S3.E7.m1.10.10.1.1b.cmml" xref="S3.E7.m1.10.10.1"><eq id="S3.E7.m1.10.10.1.1.3.cmml" xref="S3.E7.m1.10.10.1.1.3"></eq><apply id="S3.E7.m1.10.10.1.1.2.cmml" xref="S3.E7.m1.10.10.1.1.2"><times id="S3.E7.m1.10.10.1.1.2.1.cmml" xref="S3.E7.m1.10.10.1.1.2.1"></times><apply id="S3.E7.m1.10.10.1.1.2.2.cmml" xref="S3.E7.m1.10.10.1.1.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.10.10.1.1.2.2.1.cmml" xref="S3.E7.m1.10.10.1.1.2.2">subscript</csymbol><ci id="S3.E7.m1.10.10.1.1.2.2.2.cmml" xref="S3.E7.m1.10.10.1.1.2.2.2">ℎ</ci><ci id="S3.E7.m1.10.10.1.1.2.2.3.cmml" xref="S3.E7.m1.10.10.1.1.2.2.3">𝑡</ci></apply><ci id="S3.E7.m1.9.9.cmml" xref="S3.E7.m1.9.9">𝑥</ci></apply><apply id="S3.E7.m1.10.10.1.1.4.cmml" xref="S3.E7.m1.10.10.1.1.4"><arg id="S3.E7.m1.10.10.1.1.4.1.cmml" xref="S3.E7.m1.10.10.1.1.4.1"></arg><apply id="S3.E7.m1.10.10.1.1.4.2.cmml" xref="S3.E7.m1.10.10.1.1.4.2"><apply id="S3.E7.m1.10.10.1.1.4.2.1.cmml" xref="S3.E7.m1.10.10.1.1.4.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.10.10.1.1.4.2.1.1.cmml" xref="S3.E7.m1.10.10.1.1.4.2.1">subscript</csymbol><max id="S3.E7.m1.10.10.1.1.4.2.1.2.cmml" xref="S3.E7.m1.10.10.1.1.4.2.1.2"></max><apply id="S3.E7.m1.10.10.1.1.4.2.1.3.cmml" xref="S3.E7.m1.10.10.1.1.4.2.1.3"><in id="S3.E7.m1.10.10.1.1.4.2.1.3.1.cmml" xref="S3.E7.m1.10.10.1.1.4.2.1.3.1"></in><ci id="S3.E7.m1.10.10.1.1.4.2.1.3.2.cmml" xref="S3.E7.m1.10.10.1.1.4.2.1.3.2">𝑦</ci><ci id="S3.E7.m1.10.10.1.1.4.2.1.3.3.cmml" xref="S3.E7.m1.10.10.1.1.4.2.1.3.3">𝒴</ci></apply></apply><apply id="S3.E7.m1.5.5.cmml" xref="S3.E7.m1.5.5"><divide id="S3.E7.m1.5.5.6.cmml" xref="S3.E7.m1.5.5"></divide><apply id="S3.E7.m1.3.3.3.cmml" xref="S3.E7.m1.3.3.3"><times id="S3.E7.m1.3.3.3.4.cmml" xref="S3.E7.m1.3.3.3.4"></times><apply id="S3.E7.m1.3.3.3.5.cmml" xref="S3.E7.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.5.1.cmml" xref="S3.E7.m1.3.3.3.5">subscript</csymbol><ci id="S3.E7.m1.3.3.3.5.2.cmml" xref="S3.E7.m1.3.3.3.5.2">𝑃</ci><ci id="S3.E7.m1.3.3.3.5.3.cmml" xref="S3.E7.m1.3.3.3.5.3">𝑠</ci></apply><interval closure="open" id="S3.E7.m1.3.3.3.6.1.cmml" xref="S3.E7.m1.3.3.3.6.2"><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑥</ci><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E7.m1.3.3.3.7.cmml" xref="S3.E7.m1.3.3.3.7"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.3.7.1.cmml" xref="S3.E7.m1.3.3.3.7">subscript</csymbol><ci id="S3.E7.m1.3.3.3.7.2.cmml" xref="S3.E7.m1.3.3.3.7.2">𝑃</ci><ci id="S3.E7.m1.3.3.3.7.3.cmml" xref="S3.E7.m1.3.3.3.7.3">𝑡</ci></apply><ci id="S3.E7.m1.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3">𝑦</ci></apply><apply id="S3.E7.m1.5.5.5.cmml" xref="S3.E7.m1.5.5.5"><times id="S3.E7.m1.5.5.5.3.cmml" xref="S3.E7.m1.5.5.5.3"></times><apply id="S3.E7.m1.5.5.5.4.cmml" xref="S3.E7.m1.5.5.5.4"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.5.4.1.cmml" xref="S3.E7.m1.5.5.5.4">subscript</csymbol><ci id="S3.E7.m1.5.5.5.4.2.cmml" xref="S3.E7.m1.5.5.5.4.2">𝑃</ci><ci id="S3.E7.m1.5.5.5.4.3.cmml" xref="S3.E7.m1.5.5.5.4.3">𝑠</ci></apply><ci id="S3.E7.m1.4.4.4.1.cmml" xref="S3.E7.m1.4.4.4.1">𝑥</ci><apply id="S3.E7.m1.5.5.5.6.cmml" xref="S3.E7.m1.5.5.5.6"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.5.6.1.cmml" xref="S3.E7.m1.5.5.5.6">subscript</csymbol><ci id="S3.E7.m1.5.5.5.6.2.cmml" xref="S3.E7.m1.5.5.5.6.2">𝑃</ci><ci id="S3.E7.m1.5.5.5.6.3.cmml" xref="S3.E7.m1.5.5.5.6.3">𝑠</ci></apply><ci id="S3.E7.m1.5.5.5.2.cmml" xref="S3.E7.m1.5.5.5.2">𝑦</ci></apply></apply></apply></apply></apply><apply id="S3.E7.m1.10.10.1.1c.cmml" xref="S3.E7.m1.10.10.1"><eq id="S3.E7.m1.10.10.1.1.5.cmml" xref="S3.E7.m1.10.10.1.1.5"></eq><share href="#S3.E7.m1.10.10.1.1.4.cmml" id="S3.E7.m1.10.10.1.1d.cmml" xref="S3.E7.m1.10.10.1"></share><apply id="S3.E7.m1.10.10.1.1.6.cmml" xref="S3.E7.m1.10.10.1.1.6"><arg id="S3.E7.m1.10.10.1.1.6.1.cmml" xref="S3.E7.m1.10.10.1.1.6.1"></arg><apply id="S3.E7.m1.10.10.1.1.6.2.cmml" xref="S3.E7.m1.10.10.1.1.6.2"><apply id="S3.E7.m1.10.10.1.1.6.2.1.cmml" xref="S3.E7.m1.10.10.1.1.6.2.1"><csymbol cd="ambiguous" id="S3.E7.m1.10.10.1.1.6.2.1.1.cmml" xref="S3.E7.m1.10.10.1.1.6.2.1">subscript</csymbol><max id="S3.E7.m1.10.10.1.1.6.2.1.2.cmml" xref="S3.E7.m1.10.10.1.1.6.2.1.2"></max><apply id="S3.E7.m1.10.10.1.1.6.2.1.3.cmml" xref="S3.E7.m1.10.10.1.1.6.2.1.3"><in id="S3.E7.m1.10.10.1.1.6.2.1.3.1.cmml" xref="S3.E7.m1.10.10.1.1.6.2.1.3.1"></in><ci id="S3.E7.m1.10.10.1.1.6.2.1.3.2.cmml" xref="S3.E7.m1.10.10.1.1.6.2.1.3.2">𝑦</ci><ci id="S3.E7.m1.10.10.1.1.6.2.1.3.3.cmml" xref="S3.E7.m1.10.10.1.1.6.2.1.3.3">𝒴</ci></apply></apply><apply id="S3.E7.m1.8.8.cmml" xref="S3.E7.m1.8.8"><divide id="S3.E7.m1.8.8.4.cmml" xref="S3.E7.m1.8.8"></divide><apply id="S3.E7.m1.7.7.2.cmml" xref="S3.E7.m1.7.7.2"><times id="S3.E7.m1.7.7.2.3.cmml" xref="S3.E7.m1.7.7.2.3"></times><apply id="S3.E7.m1.7.7.2.4.cmml" xref="S3.E7.m1.7.7.2.4"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.2.4.1.cmml" xref="S3.E7.m1.7.7.2.4">subscript</csymbol><ci id="S3.E7.m1.7.7.2.4.2.cmml" xref="S3.E7.m1.7.7.2.4.2">𝑃</ci><ci id="S3.E7.m1.7.7.2.4.3.cmml" xref="S3.E7.m1.7.7.2.4.3">𝑠</ci></apply><apply id="S3.E7.m1.7.7.2.2.1.1.cmml" xref="S3.E7.m1.7.7.2.2.1"><csymbol cd="latexml" id="S3.E7.m1.7.7.2.2.1.1.1.cmml" xref="S3.E7.m1.7.7.2.2.1.1.1">conditional</csymbol><ci id="S3.E7.m1.7.7.2.2.1.1.2.cmml" xref="S3.E7.m1.7.7.2.2.1.1.2">𝑥</ci><ci id="S3.E7.m1.7.7.2.2.1.1.3.cmml" xref="S3.E7.m1.7.7.2.2.1.1.3">𝑦</ci></apply><apply id="S3.E7.m1.7.7.2.5.cmml" xref="S3.E7.m1.7.7.2.5"><csymbol cd="ambiguous" id="S3.E7.m1.7.7.2.5.1.cmml" xref="S3.E7.m1.7.7.2.5">subscript</csymbol><ci id="S3.E7.m1.7.7.2.5.2.cmml" xref="S3.E7.m1.7.7.2.5.2">𝑃</ci><ci id="S3.E7.m1.7.7.2.5.3.cmml" xref="S3.E7.m1.7.7.2.5.3">𝑡</ci></apply><ci id="S3.E7.m1.6.6.1.1.cmml" xref="S3.E7.m1.6.6.1.1">𝑦</ci></apply><apply id="S3.E7.m1.8.8.3.cmml" xref="S3.E7.m1.8.8.3"><times id="S3.E7.m1.8.8.3.2.cmml" xref="S3.E7.m1.8.8.3.2"></times><apply id="S3.E7.m1.8.8.3.3.cmml" xref="S3.E7.m1.8.8.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.8.8.3.3.1.cmml" xref="S3.E7.m1.8.8.3.3">subscript</csymbol><ci id="S3.E7.m1.8.8.3.3.2.cmml" xref="S3.E7.m1.8.8.3.3.2">𝑃</ci><ci id="S3.E7.m1.8.8.3.3.3.cmml" xref="S3.E7.m1.8.8.3.3.3">𝑠</ci></apply><ci id="S3.E7.m1.8.8.3.1.cmml" xref="S3.E7.m1.8.8.3.1">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.10c">\small h_{t}(x)=\arg\max_{y\in\mathcal{Y}}\frac{P_{s}(x,y)P_{t}(y)}{P_{s}(x)P_{s}(y)}=\arg\max_{y\in\mathcal{Y}}\frac{P_{s}(x|y)P_{t}(y)}{P_{s}(x)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.3" class="ltx_p">Therefore, we can alternatively learn the class conditional likelihood <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="f_{s}(X|Y)" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><msub id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml"><mi id="S3.SS2.p2.1.m1.1.1.3.2" xref="S3.SS2.p2.1.m1.1.1.3.2.cmml">f</mi><mi id="S3.SS2.p2.1.m1.1.1.3.3" xref="S3.SS2.p2.1.m1.1.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.1.m1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml">X</mi><mo fence="false" id="S3.SS2.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml">Y</mi></mrow><mo stretchy="false" id="S3.SS2.p2.1.m1.1.1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><times id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2"></times><apply id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.3.1.cmml" xref="S3.SS2.p2.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.3.2.cmml" xref="S3.SS2.p2.1.m1.1.1.3.2">𝑓</ci><ci id="S3.SS2.p2.1.m1.1.1.3.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3.3">𝑠</ci></apply><apply id="S3.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.1.1.1.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">f_{s}(X|Y)</annotation></semantics></math> on the training data by the technique of <span id="S3.SS2.p2.3.1" class="ltx_text ltx_font_italic">Balanced-SoftMax</span>, which has been widely applied on long-tailed classification tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>. Specifically, for a data point <math id="S3.SS2.p2.2.m2.2" class="ltx_Math" alttext="(x_{j},y_{j})" display="inline"><semantics id="S3.SS2.p2.2.m2.2a"><mrow id="S3.SS2.p2.2.m2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.2.m2.2.2.2.3" xref="S3.SS2.p2.2.m2.2.2.3.cmml">(</mo><msub id="S3.SS2.p2.2.m2.1.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.1.1.2" xref="S3.SS2.p2.2.m2.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.p2.2.m2.1.1.1.1.3" xref="S3.SS2.p2.2.m2.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS2.p2.2.m2.2.2.2.4" xref="S3.SS2.p2.2.m2.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.2.m2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.cmml"><mi id="S3.SS2.p2.2.m2.2.2.2.2.2" xref="S3.SS2.p2.2.m2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS2.p2.2.m2.2.2.2.2.3" xref="S3.SS2.p2.2.m2.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.p2.2.m2.2.2.2.5" xref="S3.SS2.p2.2.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.2b"><interval closure="open" id="S3.SS2.p2.2.m2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2"><apply id="S3.SS2.p2.2.m2.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.p2.2.m2.1.1.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS2.p2.2.m2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.2.2.2.2.1.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.2">𝑦</ci><ci id="S3.SS2.p2.2.m2.2.2.2.2.3.cmml" xref="S3.SS2.p2.2.m2.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.2c">(x_{j},y_{j})</annotation></semantics></math> at client <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">i</annotation></semantics></math>, the log-loss is calculated by</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.6" class="ltx_Math" alttext="\ell_{i}(x_{j},y_{j})=-\log{\left(\frac{p_{i}(y_{j})e^{z_{j}[y_{j}]}}{\sum_{c=1}^{C}p_{i}(c)e^{z_{j}[c]}}\right)}," display="block"><semantics id="S3.E8.m1.6a"><mrow id="S3.E8.m1.6.6.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1.2" xref="S3.E8.m1.6.6.1.1.2.cmml"><msub id="S3.E8.m1.6.6.1.1.2.4" xref="S3.E8.m1.6.6.1.1.2.4.cmml"><mi mathvariant="normal" id="S3.E8.m1.6.6.1.1.2.4.2" xref="S3.E8.m1.6.6.1.1.2.4.2.cmml">ℓ</mi><mi id="S3.E8.m1.6.6.1.1.2.4.3" xref="S3.E8.m1.6.6.1.1.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.6.6.1.1.2.3" xref="S3.E8.m1.6.6.1.1.2.3.cmml">​</mo><mrow id="S3.E8.m1.6.6.1.1.2.2.2" xref="S3.E8.m1.6.6.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E8.m1.6.6.1.1.2.2.2.3" xref="S3.E8.m1.6.6.1.1.2.2.3.cmml">(</mo><msub id="S3.E8.m1.6.6.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E8.m1.6.6.1.1.2.2.2.4" xref="S3.E8.m1.6.6.1.1.2.2.3.cmml">,</mo><msub id="S3.E8.m1.6.6.1.1.2.2.2.2" xref="S3.E8.m1.6.6.1.1.2.2.2.2.cmml"><mi id="S3.E8.m1.6.6.1.1.2.2.2.2.2" xref="S3.E8.m1.6.6.1.1.2.2.2.2.2.cmml">y</mi><mi id="S3.E8.m1.6.6.1.1.2.2.2.2.3" xref="S3.E8.m1.6.6.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E8.m1.6.6.1.1.2.2.2.5" xref="S3.E8.m1.6.6.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.6.6.1.1.3" xref="S3.E8.m1.6.6.1.1.3.cmml">=</mo><mrow id="S3.E8.m1.6.6.1.1.4" xref="S3.E8.m1.6.6.1.1.4.cmml"><mo rspace="0.167em" id="S3.E8.m1.6.6.1.1.4a" xref="S3.E8.m1.6.6.1.1.4.cmml">−</mo><mrow id="S3.E8.m1.6.6.1.1.4.2.2" xref="S3.E8.m1.6.6.1.1.4.2.1.cmml"><mi id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">log</mi><mo id="S3.E8.m1.6.6.1.1.4.2.2a" xref="S3.E8.m1.6.6.1.1.4.2.1.cmml">⁡</mo><mrow id="S3.E8.m1.6.6.1.1.4.2.2.1" xref="S3.E8.m1.6.6.1.1.4.2.1.cmml"><mo id="S3.E8.m1.6.6.1.1.4.2.2.1.1" xref="S3.E8.m1.6.6.1.1.4.2.1.cmml">(</mo><mfrac id="S3.E8.m1.4.4" xref="S3.E8.m1.4.4.cmml"><mrow id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml"><msub id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.4.cmml"><mi id="S3.E8.m1.2.2.2.4.2" xref="S3.E8.m1.2.2.2.4.2.cmml">p</mi><mi id="S3.E8.m1.2.2.2.4.3" xref="S3.E8.m1.2.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.3" xref="S3.E8.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E8.m1.2.2.2.2.1" xref="S3.E8.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.2.2.1.2" xref="S3.E8.m1.2.2.2.2.1.1.cmml">(</mo><msub id="S3.E8.m1.2.2.2.2.1.1" xref="S3.E8.m1.2.2.2.2.1.1.cmml"><mi id="S3.E8.m1.2.2.2.2.1.1.2" xref="S3.E8.m1.2.2.2.2.1.1.2.cmml">y</mi><mi id="S3.E8.m1.2.2.2.2.1.1.3" xref="S3.E8.m1.2.2.2.2.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E8.m1.2.2.2.2.1.3" xref="S3.E8.m1.2.2.2.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.2.3a" xref="S3.E8.m1.2.2.2.3.cmml">​</mo><msup id="S3.E8.m1.2.2.2.5" xref="S3.E8.m1.2.2.2.5.cmml"><mi id="S3.E8.m1.2.2.2.5.2" xref="S3.E8.m1.2.2.2.5.2.cmml">e</mi><mrow id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.1.3.2.cmml">z</mi><mi id="S3.E8.m1.1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.E8.m1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S3.E8.m1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.E8.m1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></msup></mrow><mrow id="S3.E8.m1.4.4.4" xref="S3.E8.m1.4.4.4.cmml"><msubsup id="S3.E8.m1.4.4.4.3" xref="S3.E8.m1.4.4.4.3.cmml"><mo id="S3.E8.m1.4.4.4.3.2.2" xref="S3.E8.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S3.E8.m1.4.4.4.3.2.3" xref="S3.E8.m1.4.4.4.3.2.3.cmml"><mi id="S3.E8.m1.4.4.4.3.2.3.2" xref="S3.E8.m1.4.4.4.3.2.3.2.cmml">c</mi><mo id="S3.E8.m1.4.4.4.3.2.3.1" xref="S3.E8.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S3.E8.m1.4.4.4.3.2.3.3" xref="S3.E8.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E8.m1.4.4.4.3.3" xref="S3.E8.m1.4.4.4.3.3.cmml">C</mi></msubsup><mrow id="S3.E8.m1.4.4.4.4" xref="S3.E8.m1.4.4.4.4.cmml"><msub id="S3.E8.m1.4.4.4.4.2" xref="S3.E8.m1.4.4.4.4.2.cmml"><mi id="S3.E8.m1.4.4.4.4.2.2" xref="S3.E8.m1.4.4.4.4.2.2.cmml">p</mi><mi id="S3.E8.m1.4.4.4.4.2.3" xref="S3.E8.m1.4.4.4.4.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.4.4.4.4.1" xref="S3.E8.m1.4.4.4.4.1.cmml">​</mo><mrow id="S3.E8.m1.4.4.4.4.3.2" xref="S3.E8.m1.4.4.4.4.cmml"><mo stretchy="false" id="S3.E8.m1.4.4.4.4.3.2.1" xref="S3.E8.m1.4.4.4.4.cmml">(</mo><mi id="S3.E8.m1.4.4.4.2" xref="S3.E8.m1.4.4.4.2.cmml">c</mi><mo stretchy="false" id="S3.E8.m1.4.4.4.4.3.2.2" xref="S3.E8.m1.4.4.4.4.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E8.m1.4.4.4.4.1a" xref="S3.E8.m1.4.4.4.4.1.cmml">​</mo><msup id="S3.E8.m1.4.4.4.4.4" xref="S3.E8.m1.4.4.4.4.4.cmml"><mi id="S3.E8.m1.4.4.4.4.4.2" xref="S3.E8.m1.4.4.4.4.4.2.cmml">e</mi><mrow id="S3.E8.m1.3.3.3.1.1" xref="S3.E8.m1.3.3.3.1.1.cmml"><msub id="S3.E8.m1.3.3.3.1.1.3" xref="S3.E8.m1.3.3.3.1.1.3.cmml"><mi id="S3.E8.m1.3.3.3.1.1.3.2" xref="S3.E8.m1.3.3.3.1.1.3.2.cmml">z</mi><mi id="S3.E8.m1.3.3.3.1.1.3.3" xref="S3.E8.m1.3.3.3.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S3.E8.m1.3.3.3.1.1.2" xref="S3.E8.m1.3.3.3.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.3.3.3.1.1.4.2" xref="S3.E8.m1.3.3.3.1.1.4.1.cmml"><mo stretchy="false" id="S3.E8.m1.3.3.3.1.1.4.2.1" xref="S3.E8.m1.3.3.3.1.1.4.1.1.cmml">[</mo><mi id="S3.E8.m1.3.3.3.1.1.1" xref="S3.E8.m1.3.3.3.1.1.1.cmml">c</mi><mo stretchy="false" id="S3.E8.m1.3.3.3.1.1.4.2.2" xref="S3.E8.m1.3.3.3.1.1.4.1.1.cmml">]</mo></mrow></mrow></msup></mrow></mrow></mfrac><mo id="S3.E8.m1.6.6.1.1.4.2.2.1.2" xref="S3.E8.m1.6.6.1.1.4.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.6.6.1.2" xref="S3.E8.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.6b"><apply id="S3.E8.m1.6.6.1.1.cmml" xref="S3.E8.m1.6.6.1"><eq id="S3.E8.m1.6.6.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.3"></eq><apply id="S3.E8.m1.6.6.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.2"><times id="S3.E8.m1.6.6.1.1.2.3.cmml" xref="S3.E8.m1.6.6.1.1.2.3"></times><apply id="S3.E8.m1.6.6.1.1.2.4.cmml" xref="S3.E8.m1.6.6.1.1.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.2.4.1.cmml" xref="S3.E8.m1.6.6.1.1.2.4">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.2.4.2.cmml" xref="S3.E8.m1.6.6.1.1.2.4.2">ℓ</ci><ci id="S3.E8.m1.6.6.1.1.2.4.3.cmml" xref="S3.E8.m1.6.6.1.1.2.4.3">𝑖</ci></apply><interval closure="open" id="S3.E8.m1.6.6.1.1.2.2.3.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2"><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E8.m1.6.6.1.1.2.2.2.2.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.2.2.2.2.1.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.2.2.2.2.2.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2.2.2">𝑦</ci><ci id="S3.E8.m1.6.6.1.1.2.2.2.2.3.cmml" xref="S3.E8.m1.6.6.1.1.2.2.2.2.3">𝑗</ci></apply></interval></apply><apply id="S3.E8.m1.6.6.1.1.4.cmml" xref="S3.E8.m1.6.6.1.1.4"><minus id="S3.E8.m1.6.6.1.1.4.1.cmml" xref="S3.E8.m1.6.6.1.1.4"></minus><apply id="S3.E8.m1.6.6.1.1.4.2.1.cmml" xref="S3.E8.m1.6.6.1.1.4.2.2"><log id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5"></log><apply id="S3.E8.m1.4.4.cmml" xref="S3.E8.m1.4.4"><divide id="S3.E8.m1.4.4.5.cmml" xref="S3.E8.m1.4.4"></divide><apply id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"><times id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.3"></times><apply id="S3.E8.m1.2.2.2.4.cmml" xref="S3.E8.m1.2.2.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.4.1.cmml" xref="S3.E8.m1.2.2.2.4">subscript</csymbol><ci id="S3.E8.m1.2.2.2.4.2.cmml" xref="S3.E8.m1.2.2.2.4.2">𝑝</ci><ci id="S3.E8.m1.2.2.2.4.3.cmml" xref="S3.E8.m1.2.2.2.4.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.2.2.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.1.1.1.cmml" xref="S3.E8.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E8.m1.2.2.2.2.1.1.2.cmml" xref="S3.E8.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="S3.E8.m1.2.2.2.2.1.1.3.cmml" xref="S3.E8.m1.2.2.2.2.1.1.3">𝑗</ci></apply><apply id="S3.E8.m1.2.2.2.5.cmml" xref="S3.E8.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.5.1.cmml" xref="S3.E8.m1.2.2.2.5">superscript</csymbol><ci id="S3.E8.m1.2.2.2.5.2.cmml" xref="S3.E8.m1.2.2.2.5.2">𝑒</ci><apply id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"><times id="S3.E8.m1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.2"></times><apply id="S3.E8.m1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.1.3.2">𝑧</ci><ci id="S3.E8.m1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.1.3.3">𝑗</ci></apply><apply id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S3.E8.m1.4.4.4.cmml" xref="S3.E8.m1.4.4.4"><apply id="S3.E8.m1.4.4.4.3.cmml" xref="S3.E8.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.4.3.1.cmml" xref="S3.E8.m1.4.4.4.3">superscript</csymbol><apply id="S3.E8.m1.4.4.4.3.2.cmml" xref="S3.E8.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.4.3.2.1.cmml" xref="S3.E8.m1.4.4.4.3">subscript</csymbol><sum id="S3.E8.m1.4.4.4.3.2.2.cmml" xref="S3.E8.m1.4.4.4.3.2.2"></sum><apply id="S3.E8.m1.4.4.4.3.2.3.cmml" xref="S3.E8.m1.4.4.4.3.2.3"><eq id="S3.E8.m1.4.4.4.3.2.3.1.cmml" xref="S3.E8.m1.4.4.4.3.2.3.1"></eq><ci id="S3.E8.m1.4.4.4.3.2.3.2.cmml" xref="S3.E8.m1.4.4.4.3.2.3.2">𝑐</ci><cn type="integer" id="S3.E8.m1.4.4.4.3.2.3.3.cmml" xref="S3.E8.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S3.E8.m1.4.4.4.3.3.cmml" xref="S3.E8.m1.4.4.4.3.3">𝐶</ci></apply><apply id="S3.E8.m1.4.4.4.4.cmml" xref="S3.E8.m1.4.4.4.4"><times id="S3.E8.m1.4.4.4.4.1.cmml" xref="S3.E8.m1.4.4.4.4.1"></times><apply id="S3.E8.m1.4.4.4.4.2.cmml" xref="S3.E8.m1.4.4.4.4.2"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.4.4.2.1.cmml" xref="S3.E8.m1.4.4.4.4.2">subscript</csymbol><ci id="S3.E8.m1.4.4.4.4.2.2.cmml" xref="S3.E8.m1.4.4.4.4.2.2">𝑝</ci><ci id="S3.E8.m1.4.4.4.4.2.3.cmml" xref="S3.E8.m1.4.4.4.4.2.3">𝑖</ci></apply><ci id="S3.E8.m1.4.4.4.2.cmml" xref="S3.E8.m1.4.4.4.2">𝑐</ci><apply id="S3.E8.m1.4.4.4.4.4.cmml" xref="S3.E8.m1.4.4.4.4.4"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.4.4.4.1.cmml" xref="S3.E8.m1.4.4.4.4.4">superscript</csymbol><ci id="S3.E8.m1.4.4.4.4.4.2.cmml" xref="S3.E8.m1.4.4.4.4.4.2">𝑒</ci><apply id="S3.E8.m1.3.3.3.1.1.cmml" xref="S3.E8.m1.3.3.3.1.1"><times id="S3.E8.m1.3.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.3.1.1.2"></times><apply id="S3.E8.m1.3.3.3.1.1.3.cmml" xref="S3.E8.m1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.3.1.1.3.1.cmml" xref="S3.E8.m1.3.3.3.1.1.3">subscript</csymbol><ci id="S3.E8.m1.3.3.3.1.1.3.2.cmml" xref="S3.E8.m1.3.3.3.1.1.3.2">𝑧</ci><ci id="S3.E8.m1.3.3.3.1.1.3.3.cmml" xref="S3.E8.m1.3.3.3.1.1.3.3">𝑗</ci></apply><apply id="S3.E8.m1.3.3.3.1.1.4.1.cmml" xref="S3.E8.m1.3.3.3.1.1.4.2"><csymbol cd="latexml" id="S3.E8.m1.3.3.3.1.1.4.1.1.cmml" xref="S3.E8.m1.3.3.3.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.E8.m1.3.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.3.1.1.1">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.6c">\ell_{i}(x_{j},y_{j})=-\log{\left(\frac{p_{i}(y_{j})e^{z_{j}[y_{j}]}}{\sum_{c=1}^{C}p_{i}(c)e^{z_{j}[c]}}\right)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.5" class="ltx_p">where <math id="S3.SS2.p2.4.m1.1" class="ltx_Math" alttext="p_{i}(y)" display="inline"><semantics id="S3.SS2.p2.4.m1.1a"><mrow id="S3.SS2.p2.4.m1.1.2" xref="S3.SS2.p2.4.m1.1.2.cmml"><msub id="S3.SS2.p2.4.m1.1.2.2" xref="S3.SS2.p2.4.m1.1.2.2.cmml"><mi id="S3.SS2.p2.4.m1.1.2.2.2" xref="S3.SS2.p2.4.m1.1.2.2.2.cmml">p</mi><mi id="S3.SS2.p2.4.m1.1.2.2.3" xref="S3.SS2.p2.4.m1.1.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m1.1.2.1" xref="S3.SS2.p2.4.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p2.4.m1.1.2.3.2" xref="S3.SS2.p2.4.m1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m1.1.2.3.2.1" xref="S3.SS2.p2.4.m1.1.2.cmml">(</mo><mi id="S3.SS2.p2.4.m1.1.1" xref="S3.SS2.p2.4.m1.1.1.cmml">y</mi><mo stretchy="false" id="S3.SS2.p2.4.m1.1.2.3.2.2" xref="S3.SS2.p2.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m1.1b"><apply id="S3.SS2.p2.4.m1.1.2.cmml" xref="S3.SS2.p2.4.m1.1.2"><times id="S3.SS2.p2.4.m1.1.2.1.cmml" xref="S3.SS2.p2.4.m1.1.2.1"></times><apply id="S3.SS2.p2.4.m1.1.2.2.cmml" xref="S3.SS2.p2.4.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m1.1.2.2.1.cmml" xref="S3.SS2.p2.4.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.4.m1.1.2.2.2.cmml" xref="S3.SS2.p2.4.m1.1.2.2.2">𝑝</ci><ci id="S3.SS2.p2.4.m1.1.2.2.3.cmml" xref="S3.SS2.p2.4.m1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.p2.4.m1.1.1.cmml" xref="S3.SS2.p2.4.m1.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m1.1c">p_{i}(y)</annotation></semantics></math> is the local prior of label <math id="S3.SS2.p2.5.m2.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S3.SS2.p2.5.m2.1a"><mi id="S3.SS2.p2.5.m2.1.1" xref="S3.SS2.p2.5.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m2.1b"><ci id="S3.SS2.p2.5.m2.1.1.cmml" xref="S3.SS2.p2.5.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m2.1c">y</annotation></semantics></math> that can be estimated from the training data. Slightly different from the long-tailed classification, local prior probabilities of some classes could be zero in non-IID FL. Then, the inference on uniform distribution could be performed as the ordinary softmax classifier.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2303.06314/assets/x1.png" id="S3.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="287" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Preliminary experimental results on CIFAR-10 dataset.</figcaption>
</figure>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2303.06314/assets/x2.png" id="S3.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="904" height="368" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Federated learning with a central server and a number of clients, where the clients may dropout during training. The local training consists of two key components, including relaxed balanced-softmax and feature-level augmentation by inter-class transfer.</figcaption>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span><span id="S3.SS3.1.1" class="ltx_text ltx_font_italic">Preliminary Results</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">We conduct some preliminary experiments on CIFAR-10 to show that the unstable performance of FedAvg on non-IID data is mainly caused by the biased classifier head and the learned representation layers are still effective. To validate this, we assume that a small balanced set of samples is available at the server side for fine-tuning the classifier head in each round. We consider a setup with 50 clients, where each client has samples from only 2 classes and the successful transmission probability is 0.2 in each round. Three methods including vanilla FedAvg, FedAvg with balanced-softmax (BSM-FedAvg) and FedAvg with server-side fine-tuning (FedAvg-FT) are compared with learning curves plotted in Fig <a href="#S3.F1" title="Figure 1 ‣ 3.2 Prior-Corrected Bayes Classifier ‣ 3 Preliminary and Motivation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, where we also provide the result of FedAvg with full participation as a reference. The experimental results show that FedAvg with non-IID data and client dropout can result in severe performance fluctuating, while re-training the classifier on a small balanced set can significantly improve the stability and accuracy. On the other hand, it is interesting to see that BSM-FedAvg without the fine-tuning can almost approach the effect of head re-training. This preliminary results motivate us to learn a balanced classifier head without severe forgetting during the local training.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Our Proposed Framework</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we present our framework for FL with non-IID data and client dropout as in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.2 Prior-Corrected Bayes Classifier ‣ 3 Preliminary and Motivation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> by introducing two bias-reduction methods in local training, including the modified cross-entropy computing and feature-level augmentation. It is worth noting that the central server is only responsible for message collection and aggregation without any extra model training or other complicated computation.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span><span id="S4.SS1.1.1" class="ltx_text ltx_font_italic">Relaxed Balanced-SoftMax Classifier</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Although the balanced-softmax is effective in tackling the non-IID data to an extent, we claim that a combination of balanced-softmax and vanilla softmax could exhibit better performance in the case of pathological data setting where each client can only observe a few number of classes. As a conceptual example, consider an extreme case where each client only has samples from one class, then the balanced-softmax will result in zero loss and the local training will get stuck, while vanilla FedAvg could still update the model. Moreover, the classifier parameters corresponding to the missing classes could be too stale under the scheme of balanced-softmax, which might be sub-optimal for global aggregation and reduce the overall model performance. Therefore, we propose to use a linear combination of vanilla softmax and balanced-softmax, which could be achieved by the following relaxed version of balanced-softmax (R-BSM):</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.7" class="ltx_Math" alttext="\ell_{i}(x_{j},y_{j};\epsilon_{i})=-\log{\left(\frac{[\hat{p}_{i}(y_{j})]e^{z_{j}[y_{j}]}}{\sum_{c=1}^{C}[\hat{p}_{i}(c)]e^{z_{j}[c]}}\right)}," display="block"><semantics id="S4.E9.m1.7a"><mrow id="S4.E9.m1.7.7.1" xref="S4.E9.m1.7.7.1.1.cmml"><mrow id="S4.E9.m1.7.7.1.1" xref="S4.E9.m1.7.7.1.1.cmml"><mrow id="S4.E9.m1.7.7.1.1.3" xref="S4.E9.m1.7.7.1.1.3.cmml"><msub id="S4.E9.m1.7.7.1.1.3.5" xref="S4.E9.m1.7.7.1.1.3.5.cmml"><mi mathvariant="normal" id="S4.E9.m1.7.7.1.1.3.5.2" xref="S4.E9.m1.7.7.1.1.3.5.2.cmml">ℓ</mi><mi id="S4.E9.m1.7.7.1.1.3.5.3" xref="S4.E9.m1.7.7.1.1.3.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.7.7.1.1.3.4" xref="S4.E9.m1.7.7.1.1.3.4.cmml">​</mo><mrow id="S4.E9.m1.7.7.1.1.3.3.3" xref="S4.E9.m1.7.7.1.1.3.3.4.cmml"><mo stretchy="false" id="S4.E9.m1.7.7.1.1.3.3.3.4" xref="S4.E9.m1.7.7.1.1.3.3.4.cmml">(</mo><msub id="S4.E9.m1.7.7.1.1.1.1.1.1" xref="S4.E9.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.7.7.1.1.1.1.1.1.2" xref="S4.E9.m1.7.7.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E9.m1.7.7.1.1.1.1.1.1.3" xref="S4.E9.m1.7.7.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.E9.m1.7.7.1.1.3.3.3.5" xref="S4.E9.m1.7.7.1.1.3.3.4.cmml">,</mo><msub id="S4.E9.m1.7.7.1.1.2.2.2.2" xref="S4.E9.m1.7.7.1.1.2.2.2.2.cmml"><mi id="S4.E9.m1.7.7.1.1.2.2.2.2.2" xref="S4.E9.m1.7.7.1.1.2.2.2.2.2.cmml">y</mi><mi id="S4.E9.m1.7.7.1.1.2.2.2.2.3" xref="S4.E9.m1.7.7.1.1.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E9.m1.7.7.1.1.3.3.3.6" xref="S4.E9.m1.7.7.1.1.3.3.4.cmml">;</mo><msub id="S4.E9.m1.7.7.1.1.3.3.3.3" xref="S4.E9.m1.7.7.1.1.3.3.3.3.cmml"><mi id="S4.E9.m1.7.7.1.1.3.3.3.3.2" xref="S4.E9.m1.7.7.1.1.3.3.3.3.2.cmml">ϵ</mi><mi id="S4.E9.m1.7.7.1.1.3.3.3.3.3" xref="S4.E9.m1.7.7.1.1.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E9.m1.7.7.1.1.3.3.3.7" xref="S4.E9.m1.7.7.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.7.7.1.1.4" xref="S4.E9.m1.7.7.1.1.4.cmml">=</mo><mrow id="S4.E9.m1.7.7.1.1.5" xref="S4.E9.m1.7.7.1.1.5.cmml"><mo rspace="0.167em" id="S4.E9.m1.7.7.1.1.5a" xref="S4.E9.m1.7.7.1.1.5.cmml">−</mo><mrow id="S4.E9.m1.7.7.1.1.5.2.2" xref="S4.E9.m1.7.7.1.1.5.2.1.cmml"><mi id="S4.E9.m1.6.6" xref="S4.E9.m1.6.6.cmml">log</mi><mo id="S4.E9.m1.7.7.1.1.5.2.2a" xref="S4.E9.m1.7.7.1.1.5.2.1.cmml">⁡</mo><mrow id="S4.E9.m1.7.7.1.1.5.2.2.1" xref="S4.E9.m1.7.7.1.1.5.2.1.cmml"><mo id="S4.E9.m1.7.7.1.1.5.2.2.1.1" xref="S4.E9.m1.7.7.1.1.5.2.1.cmml">(</mo><mfrac id="S4.E9.m1.5.5" xref="S4.E9.m1.5.5.cmml"><mrow id="S4.E9.m1.2.2.2" xref="S4.E9.m1.2.2.2.cmml"><mrow id="S4.E9.m1.2.2.2.2.1" xref="S4.E9.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="S4.E9.m1.2.2.2.2.1.2" xref="S4.E9.m1.2.2.2.2.2.1.cmml">[</mo><mrow id="S4.E9.m1.2.2.2.2.1.1" xref="S4.E9.m1.2.2.2.2.1.1.cmml"><msub id="S4.E9.m1.2.2.2.2.1.1.3" xref="S4.E9.m1.2.2.2.2.1.1.3.cmml"><mover accent="true" id="S4.E9.m1.2.2.2.2.1.1.3.2" xref="S4.E9.m1.2.2.2.2.1.1.3.2.cmml"><mi id="S4.E9.m1.2.2.2.2.1.1.3.2.2" xref="S4.E9.m1.2.2.2.2.1.1.3.2.2.cmml">p</mi><mo id="S4.E9.m1.2.2.2.2.1.1.3.2.1" xref="S4.E9.m1.2.2.2.2.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E9.m1.2.2.2.2.1.1.3.3" xref="S4.E9.m1.2.2.2.2.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.2.1.1.2" xref="S4.E9.m1.2.2.2.2.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.2.2.2.2.1.1.1.1" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.2.2.2.2.1.1.1.1.2" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.cmml">(</mo><msub id="S4.E9.m1.2.2.2.2.1.1.1.1.1" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S4.E9.m1.2.2.2.2.1.1.1.1.1.2" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.2.cmml">y</mi><mi id="S4.E9.m1.2.2.2.2.1.1.1.1.1.3" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S4.E9.m1.2.2.2.2.1.1.1.1.3" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E9.m1.2.2.2.2.1.3" xref="S4.E9.m1.2.2.2.2.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.2.2.2.3" xref="S4.E9.m1.2.2.2.3.cmml">​</mo><msup id="S4.E9.m1.2.2.2.4" xref="S4.E9.m1.2.2.2.4.cmml"><mi id="S4.E9.m1.2.2.2.4.2" xref="S4.E9.m1.2.2.2.4.2.cmml">e</mi><mrow id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.cmml"><msub id="S4.E9.m1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.1.3.2.cmml">z</mi><mi id="S4.E9.m1.1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E9.m1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="S4.E9.m1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S4.E9.m1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></msup></mrow><mrow id="S4.E9.m1.5.5.5" xref="S4.E9.m1.5.5.5.cmml"><msubsup id="S4.E9.m1.5.5.5.4" xref="S4.E9.m1.5.5.5.4.cmml"><mo id="S4.E9.m1.5.5.5.4.2.2" xref="S4.E9.m1.5.5.5.4.2.2.cmml">∑</mo><mrow id="S4.E9.m1.5.5.5.4.2.3" xref="S4.E9.m1.5.5.5.4.2.3.cmml"><mi id="S4.E9.m1.5.5.5.4.2.3.2" xref="S4.E9.m1.5.5.5.4.2.3.2.cmml">c</mi><mo id="S4.E9.m1.5.5.5.4.2.3.1" xref="S4.E9.m1.5.5.5.4.2.3.1.cmml">=</mo><mn id="S4.E9.m1.5.5.5.4.2.3.3" xref="S4.E9.m1.5.5.5.4.2.3.3.cmml">1</mn></mrow><mi id="S4.E9.m1.5.5.5.4.3" xref="S4.E9.m1.5.5.5.4.3.cmml">C</mi></msubsup><mrow id="S4.E9.m1.5.5.5.3" xref="S4.E9.m1.5.5.5.3.cmml"><mrow id="S4.E9.m1.5.5.5.3.1.1" xref="S4.E9.m1.5.5.5.3.1.2.cmml"><mo lspace="0em" stretchy="false" id="S4.E9.m1.5.5.5.3.1.1.2" xref="S4.E9.m1.5.5.5.3.1.2.1.cmml">[</mo><mrow id="S4.E9.m1.5.5.5.3.1.1.1" xref="S4.E9.m1.5.5.5.3.1.1.1.cmml"><msub id="S4.E9.m1.5.5.5.3.1.1.1.2" xref="S4.E9.m1.5.5.5.3.1.1.1.2.cmml"><mover accent="true" id="S4.E9.m1.5.5.5.3.1.1.1.2.2" xref="S4.E9.m1.5.5.5.3.1.1.1.2.2.cmml"><mi id="S4.E9.m1.5.5.5.3.1.1.1.2.2.2" xref="S4.E9.m1.5.5.5.3.1.1.1.2.2.2.cmml">p</mi><mo id="S4.E9.m1.5.5.5.3.1.1.1.2.2.1" xref="S4.E9.m1.5.5.5.3.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.E9.m1.5.5.5.3.1.1.1.2.3" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.5.5.5.3.1.1.1.1" xref="S4.E9.m1.5.5.5.3.1.1.1.1.cmml">​</mo><mrow id="S4.E9.m1.5.5.5.3.1.1.1.3.2" xref="S4.E9.m1.5.5.5.3.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.5.5.5.3.1.1.1.3.2.1" xref="S4.E9.m1.5.5.5.3.1.1.1.cmml">(</mo><mi id="S4.E9.m1.4.4.4.2" xref="S4.E9.m1.4.4.4.2.cmml">c</mi><mo stretchy="false" id="S4.E9.m1.5.5.5.3.1.1.1.3.2.2" xref="S4.E9.m1.5.5.5.3.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E9.m1.5.5.5.3.1.1.3" xref="S4.E9.m1.5.5.5.3.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.5.5.5.3.2" xref="S4.E9.m1.5.5.5.3.2.cmml">​</mo><msup id="S4.E9.m1.5.5.5.3.3" xref="S4.E9.m1.5.5.5.3.3.cmml"><mi id="S4.E9.m1.5.5.5.3.3.2" xref="S4.E9.m1.5.5.5.3.3.2.cmml">e</mi><mrow id="S4.E9.m1.3.3.3.1.1" xref="S4.E9.m1.3.3.3.1.1.cmml"><msub id="S4.E9.m1.3.3.3.1.1.3" xref="S4.E9.m1.3.3.3.1.1.3.cmml"><mi id="S4.E9.m1.3.3.3.1.1.3.2" xref="S4.E9.m1.3.3.3.1.1.3.2.cmml">z</mi><mi id="S4.E9.m1.3.3.3.1.1.3.3" xref="S4.E9.m1.3.3.3.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.3.3.3.1.1.2" xref="S4.E9.m1.3.3.3.1.1.2.cmml">​</mo><mrow id="S4.E9.m1.3.3.3.1.1.4.2" xref="S4.E9.m1.3.3.3.1.1.4.1.cmml"><mo stretchy="false" id="S4.E9.m1.3.3.3.1.1.4.2.1" xref="S4.E9.m1.3.3.3.1.1.4.1.1.cmml">[</mo><mi id="S4.E9.m1.3.3.3.1.1.1" xref="S4.E9.m1.3.3.3.1.1.1.cmml">c</mi><mo stretchy="false" id="S4.E9.m1.3.3.3.1.1.4.2.2" xref="S4.E9.m1.3.3.3.1.1.4.1.1.cmml">]</mo></mrow></mrow></msup></mrow></mrow></mfrac><mo id="S4.E9.m1.7.7.1.1.5.2.2.1.2" xref="S4.E9.m1.7.7.1.1.5.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E9.m1.7.7.1.2" xref="S4.E9.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.7b"><apply id="S4.E9.m1.7.7.1.1.cmml" xref="S4.E9.m1.7.7.1"><eq id="S4.E9.m1.7.7.1.1.4.cmml" xref="S4.E9.m1.7.7.1.1.4"></eq><apply id="S4.E9.m1.7.7.1.1.3.cmml" xref="S4.E9.m1.7.7.1.1.3"><times id="S4.E9.m1.7.7.1.1.3.4.cmml" xref="S4.E9.m1.7.7.1.1.3.4"></times><apply id="S4.E9.m1.7.7.1.1.3.5.cmml" xref="S4.E9.m1.7.7.1.1.3.5"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.3.5.1.cmml" xref="S4.E9.m1.7.7.1.1.3.5">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.3.5.2.cmml" xref="S4.E9.m1.7.7.1.1.3.5.2">ℓ</ci><ci id="S4.E9.m1.7.7.1.1.3.5.3.cmml" xref="S4.E9.m1.7.7.1.1.3.5.3">𝑖</ci></apply><vector id="S4.E9.m1.7.7.1.1.3.3.4.cmml" xref="S4.E9.m1.7.7.1.1.3.3.3"><apply id="S4.E9.m1.7.7.1.1.1.1.1.1.cmml" xref="S4.E9.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.7.7.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E9.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.7.7.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.E9.m1.7.7.1.1.2.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.2.2.2.2.1.cmml" xref="S4.E9.m1.7.7.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S4.E9.m1.7.7.1.1.2.2.2.2.2">𝑦</ci><ci id="S4.E9.m1.7.7.1.1.2.2.2.2.3.cmml" xref="S4.E9.m1.7.7.1.1.2.2.2.2.3">𝑗</ci></apply><apply id="S4.E9.m1.7.7.1.1.3.3.3.3.cmml" xref="S4.E9.m1.7.7.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.7.7.1.1.3.3.3.3.1.cmml" xref="S4.E9.m1.7.7.1.1.3.3.3.3">subscript</csymbol><ci id="S4.E9.m1.7.7.1.1.3.3.3.3.2.cmml" xref="S4.E9.m1.7.7.1.1.3.3.3.3.2">italic-ϵ</ci><ci id="S4.E9.m1.7.7.1.1.3.3.3.3.3.cmml" xref="S4.E9.m1.7.7.1.1.3.3.3.3.3">𝑖</ci></apply></vector></apply><apply id="S4.E9.m1.7.7.1.1.5.cmml" xref="S4.E9.m1.7.7.1.1.5"><minus id="S4.E9.m1.7.7.1.1.5.1.cmml" xref="S4.E9.m1.7.7.1.1.5"></minus><apply id="S4.E9.m1.7.7.1.1.5.2.1.cmml" xref="S4.E9.m1.7.7.1.1.5.2.2"><log id="S4.E9.m1.6.6.cmml" xref="S4.E9.m1.6.6"></log><apply id="S4.E9.m1.5.5.cmml" xref="S4.E9.m1.5.5"><divide id="S4.E9.m1.5.5.6.cmml" xref="S4.E9.m1.5.5"></divide><apply id="S4.E9.m1.2.2.2.cmml" xref="S4.E9.m1.2.2.2"><times id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.3"></times><apply id="S4.E9.m1.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.1"><csymbol cd="latexml" id="S4.E9.m1.2.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.2.1.2">delimited-[]</csymbol><apply id="S4.E9.m1.2.2.2.2.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1"><times id="S4.E9.m1.2.2.2.2.1.1.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2"></times><apply id="S4.E9.m1.2.2.2.2.1.1.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.1.1.3.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3">subscript</csymbol><apply id="S4.E9.m1.2.2.2.2.1.1.3.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3.2"><ci id="S4.E9.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3.2.1">^</ci><ci id="S4.E9.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3.2.2">𝑝</ci></apply><ci id="S4.E9.m1.2.2.2.2.1.1.3.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3.3">𝑖</ci></apply><apply id="S4.E9.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.2">𝑦</ci><ci id="S4.E9.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.3">𝑗</ci></apply></apply></apply><apply id="S4.E9.m1.2.2.2.4.cmml" xref="S4.E9.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.4.1.cmml" xref="S4.E9.m1.2.2.2.4">superscript</csymbol><ci id="S4.E9.m1.2.2.2.4.2.cmml" xref="S4.E9.m1.2.2.2.4.2">𝑒</ci><apply id="S4.E9.m1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"><times id="S4.E9.m1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.2"></times><apply id="S4.E9.m1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.3.2">𝑧</ci><ci id="S4.E9.m1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3">𝑗</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E9.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S4.E9.m1.5.5.5.cmml" xref="S4.E9.m1.5.5.5"><apply id="S4.E9.m1.5.5.5.4.cmml" xref="S4.E9.m1.5.5.5.4"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.5.4.1.cmml" xref="S4.E9.m1.5.5.5.4">superscript</csymbol><apply id="S4.E9.m1.5.5.5.4.2.cmml" xref="S4.E9.m1.5.5.5.4"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.5.4.2.1.cmml" xref="S4.E9.m1.5.5.5.4">subscript</csymbol><sum id="S4.E9.m1.5.5.5.4.2.2.cmml" xref="S4.E9.m1.5.5.5.4.2.2"></sum><apply id="S4.E9.m1.5.5.5.4.2.3.cmml" xref="S4.E9.m1.5.5.5.4.2.3"><eq id="S4.E9.m1.5.5.5.4.2.3.1.cmml" xref="S4.E9.m1.5.5.5.4.2.3.1"></eq><ci id="S4.E9.m1.5.5.5.4.2.3.2.cmml" xref="S4.E9.m1.5.5.5.4.2.3.2">𝑐</ci><cn type="integer" id="S4.E9.m1.5.5.5.4.2.3.3.cmml" xref="S4.E9.m1.5.5.5.4.2.3.3">1</cn></apply></apply><ci id="S4.E9.m1.5.5.5.4.3.cmml" xref="S4.E9.m1.5.5.5.4.3">𝐶</ci></apply><apply id="S4.E9.m1.5.5.5.3.cmml" xref="S4.E9.m1.5.5.5.3"><times id="S4.E9.m1.5.5.5.3.2.cmml" xref="S4.E9.m1.5.5.5.3.2"></times><apply id="S4.E9.m1.5.5.5.3.1.2.cmml" xref="S4.E9.m1.5.5.5.3.1.1"><csymbol cd="latexml" id="S4.E9.m1.5.5.5.3.1.2.1.cmml" xref="S4.E9.m1.5.5.5.3.1.1.2">delimited-[]</csymbol><apply id="S4.E9.m1.5.5.5.3.1.1.1.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1"><times id="S4.E9.m1.5.5.5.3.1.1.1.1.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.1"></times><apply id="S4.E9.m1.5.5.5.3.1.1.1.2.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.5.3.1.1.1.2.1.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2">subscript</csymbol><apply id="S4.E9.m1.5.5.5.3.1.1.1.2.2.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.2"><ci id="S4.E9.m1.5.5.5.3.1.1.1.2.2.1.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.2.1">^</ci><ci id="S4.E9.m1.5.5.5.3.1.1.1.2.2.2.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.2.2">𝑝</ci></apply><ci id="S4.E9.m1.5.5.5.3.1.1.1.2.3.cmml" xref="S4.E9.m1.5.5.5.3.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E9.m1.4.4.4.2.cmml" xref="S4.E9.m1.4.4.4.2">𝑐</ci></apply></apply><apply id="S4.E9.m1.5.5.5.3.3.cmml" xref="S4.E9.m1.5.5.5.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.5.3.3.1.cmml" xref="S4.E9.m1.5.5.5.3.3">superscript</csymbol><ci id="S4.E9.m1.5.5.5.3.3.2.cmml" xref="S4.E9.m1.5.5.5.3.3.2">𝑒</ci><apply id="S4.E9.m1.3.3.3.1.1.cmml" xref="S4.E9.m1.3.3.3.1.1"><times id="S4.E9.m1.3.3.3.1.1.2.cmml" xref="S4.E9.m1.3.3.3.1.1.2"></times><apply id="S4.E9.m1.3.3.3.1.1.3.cmml" xref="S4.E9.m1.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.3.3.3.1.1.3.1.cmml" xref="S4.E9.m1.3.3.3.1.1.3">subscript</csymbol><ci id="S4.E9.m1.3.3.3.1.1.3.2.cmml" xref="S4.E9.m1.3.3.3.1.1.3.2">𝑧</ci><ci id="S4.E9.m1.3.3.3.1.1.3.3.cmml" xref="S4.E9.m1.3.3.3.1.1.3.3">𝑗</ci></apply><apply id="S4.E9.m1.3.3.3.1.1.4.1.cmml" xref="S4.E9.m1.3.3.3.1.1.4.2"><csymbol cd="latexml" id="S4.E9.m1.3.3.3.1.1.4.1.1.cmml" xref="S4.E9.m1.3.3.3.1.1.4.2.1">delimited-[]</csymbol><ci id="S4.E9.m1.3.3.3.1.1.1.cmml" xref="S4.E9.m1.3.3.3.1.1.1">𝑐</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.7c">\ell_{i}(x_{j},y_{j};\epsilon_{i})=-\log{\left(\frac{[\hat{p}_{i}(y_{j})]e^{z_{j}[y_{j}]}}{\sum_{c=1}^{C}[\hat{p}_{i}(c)]e^{z_{j}[c]}}\right)},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.1" class="ltx_p">and the smoothed prior <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="{\hat{p}_{i}}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><msub id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mover accent="true" id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2.2" xref="S4.SS1.p2.1.m1.1.1.2.2.cmml">p</mi><mo id="S4.SS1.p2.1.m1.1.1.2.1" xref="S4.SS1.p2.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">subscript</csymbol><apply id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2"><ci id="S4.SS1.p2.1.m1.1.1.2.1.cmml" xref="S4.SS1.p2.1.m1.1.1.2.1">^</ci><ci id="S4.SS1.p2.1.m1.1.1.2.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2.2">𝑝</ci></apply><ci id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">{\hat{p}_{i}}</annotation></semantics></math> is obtained by</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.3" class="ltx_Math" alttext="\hat{p}_{i}(y_{j})=(1-\epsilon_{i})\cdot\frac{n_{i,j}}{n_{i}}+\epsilon_{i}\cdot\frac{1}{C}," display="block"><semantics id="S4.E10.m1.3a"><mrow id="S4.E10.m1.3.3.1" xref="S4.E10.m1.3.3.1.1.cmml"><mrow id="S4.E10.m1.3.3.1.1" xref="S4.E10.m1.3.3.1.1.cmml"><mrow id="S4.E10.m1.3.3.1.1.1" xref="S4.E10.m1.3.3.1.1.1.cmml"><msub id="S4.E10.m1.3.3.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.3.cmml"><mover accent="true" id="S4.E10.m1.3.3.1.1.1.3.2" xref="S4.E10.m1.3.3.1.1.1.3.2.cmml"><mi id="S4.E10.m1.3.3.1.1.1.3.2.2" xref="S4.E10.m1.3.3.1.1.1.3.2.2.cmml">p</mi><mo id="S4.E10.m1.3.3.1.1.1.3.2.1" xref="S4.E10.m1.3.3.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E10.m1.3.3.1.1.1.3.3" xref="S4.E10.m1.3.3.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.3.3.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S4.E10.m1.3.3.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.3.3.1.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E10.m1.3.3.1.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2.cmml">y</mi><mi id="S4.E10.m1.3.3.1.1.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S4.E10.m1.3.3.1.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.3.3.1.1.3" xref="S4.E10.m1.3.3.1.1.3.cmml">=</mo><mrow id="S4.E10.m1.3.3.1.1.2" xref="S4.E10.m1.3.3.1.1.2.cmml"><mrow id="S4.E10.m1.3.3.1.1.2.1" xref="S4.E10.m1.3.3.1.1.2.1.cmml"><mrow id="S4.E10.m1.3.3.1.1.2.1.1.1" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.3.3.1.1.2.1.1.1.2" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.3.3.1.1.2.1.1.1.1" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.cmml"><mn id="S4.E10.m1.3.3.1.1.2.1.1.1.1.2" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.cmml">−</mo><msub id="S4.E10.m1.3.3.1.1.2.1.1.1.1.3" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.2" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.2.cmml">ϵ</mi><mi id="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.3" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo rspace="0.055em" stretchy="false" id="S4.E10.m1.3.3.1.1.2.1.1.1.3" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.E10.m1.3.3.1.1.2.1.2" xref="S4.E10.m1.3.3.1.1.2.1.2.cmml">⋅</mo><mfrac id="S4.E10.m1.2.2" xref="S4.E10.m1.2.2.cmml"><msub id="S4.E10.m1.2.2.2" xref="S4.E10.m1.2.2.2.cmml"><mi id="S4.E10.m1.2.2.2.4" xref="S4.E10.m1.2.2.2.4.cmml">n</mi><mrow id="S4.E10.m1.2.2.2.2.2.4" xref="S4.E10.m1.2.2.2.2.2.3.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml">i</mi><mo id="S4.E10.m1.2.2.2.2.2.4.1" xref="S4.E10.m1.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E10.m1.2.2.2.2.2.2" xref="S4.E10.m1.2.2.2.2.2.2.cmml">j</mi></mrow></msub><msub id="S4.E10.m1.2.2.4" xref="S4.E10.m1.2.2.4.cmml"><mi id="S4.E10.m1.2.2.4.2" xref="S4.E10.m1.2.2.4.2.cmml">n</mi><mi id="S4.E10.m1.2.2.4.3" xref="S4.E10.m1.2.2.4.3.cmml">i</mi></msub></mfrac></mrow><mo id="S4.E10.m1.3.3.1.1.2.2" xref="S4.E10.m1.3.3.1.1.2.2.cmml">+</mo><mrow id="S4.E10.m1.3.3.1.1.2.3" xref="S4.E10.m1.3.3.1.1.2.3.cmml"><msub id="S4.E10.m1.3.3.1.1.2.3.2" xref="S4.E10.m1.3.3.1.1.2.3.2.cmml"><mi id="S4.E10.m1.3.3.1.1.2.3.2.2" xref="S4.E10.m1.3.3.1.1.2.3.2.2.cmml">ϵ</mi><mi id="S4.E10.m1.3.3.1.1.2.3.2.3" xref="S4.E10.m1.3.3.1.1.2.3.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E10.m1.3.3.1.1.2.3.1" xref="S4.E10.m1.3.3.1.1.2.3.1.cmml">⋅</mo><mfrac id="S4.E10.m1.3.3.1.1.2.3.3" xref="S4.E10.m1.3.3.1.1.2.3.3.cmml"><mn id="S4.E10.m1.3.3.1.1.2.3.3.2" xref="S4.E10.m1.3.3.1.1.2.3.3.2.cmml">1</mn><mi id="S4.E10.m1.3.3.1.1.2.3.3.3" xref="S4.E10.m1.3.3.1.1.2.3.3.3.cmml">C</mi></mfrac></mrow></mrow></mrow><mo id="S4.E10.m1.3.3.1.2" xref="S4.E10.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.3b"><apply id="S4.E10.m1.3.3.1.1.cmml" xref="S4.E10.m1.3.3.1"><eq id="S4.E10.m1.3.3.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.3"></eq><apply id="S4.E10.m1.3.3.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1"><times id="S4.E10.m1.3.3.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.2"></times><apply id="S4.E10.m1.3.3.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.3.1.cmml" xref="S4.E10.m1.3.3.1.1.1.3">subscript</csymbol><apply id="S4.E10.m1.3.3.1.1.1.3.2.cmml" xref="S4.E10.m1.3.3.1.1.1.3.2"><ci id="S4.E10.m1.3.3.1.1.1.3.2.1.cmml" xref="S4.E10.m1.3.3.1.1.1.3.2.1">^</ci><ci id="S4.E10.m1.3.3.1.1.1.3.2.2.cmml" xref="S4.E10.m1.3.3.1.1.1.3.2.2">𝑝</ci></apply><ci id="S4.E10.m1.3.3.1.1.1.3.3.cmml" xref="S4.E10.m1.3.3.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E10.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.2">𝑦</ci><ci id="S4.E10.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S4.E10.m1.3.3.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.2"><plus id="S4.E10.m1.3.3.1.1.2.2.cmml" xref="S4.E10.m1.3.3.1.1.2.2"></plus><apply id="S4.E10.m1.3.3.1.1.2.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1"><ci id="S4.E10.m1.3.3.1.1.2.1.2.cmml" xref="S4.E10.m1.3.3.1.1.2.1.2">⋅</ci><apply id="S4.E10.m1.3.3.1.1.2.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1"><minus id="S4.E10.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.1"></minus><cn type="integer" id="S4.E10.m1.3.3.1.1.2.1.1.1.1.2.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.2">1</cn><apply id="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.2">italic-ϵ</ci><ci id="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.3.cmml" xref="S4.E10.m1.3.3.1.1.2.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S4.E10.m1.2.2.cmml" xref="S4.E10.m1.2.2"><divide id="S4.E10.m1.2.2.3.cmml" xref="S4.E10.m1.2.2"></divide><apply id="S4.E10.m1.2.2.2.cmml" xref="S4.E10.m1.2.2.2"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2">subscript</csymbol><ci id="S4.E10.m1.2.2.2.4.cmml" xref="S4.E10.m1.2.2.2.4">𝑛</ci><list id="S4.E10.m1.2.2.2.2.2.3.cmml" xref="S4.E10.m1.2.2.2.2.2.4"><ci id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1">𝑖</ci><ci id="S4.E10.m1.2.2.2.2.2.2.cmml" xref="S4.E10.m1.2.2.2.2.2.2">𝑗</ci></list></apply><apply id="S4.E10.m1.2.2.4.cmml" xref="S4.E10.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E10.m1.2.2.4.1.cmml" xref="S4.E10.m1.2.2.4">subscript</csymbol><ci id="S4.E10.m1.2.2.4.2.cmml" xref="S4.E10.m1.2.2.4.2">𝑛</ci><ci id="S4.E10.m1.2.2.4.3.cmml" xref="S4.E10.m1.2.2.4.3">𝑖</ci></apply></apply></apply><apply id="S4.E10.m1.3.3.1.1.2.3.cmml" xref="S4.E10.m1.3.3.1.1.2.3"><ci id="S4.E10.m1.3.3.1.1.2.3.1.cmml" xref="S4.E10.m1.3.3.1.1.2.3.1">⋅</ci><apply id="S4.E10.m1.3.3.1.1.2.3.2.cmml" xref="S4.E10.m1.3.3.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.3.3.1.1.2.3.2.1.cmml" xref="S4.E10.m1.3.3.1.1.2.3.2">subscript</csymbol><ci id="S4.E10.m1.3.3.1.1.2.3.2.2.cmml" xref="S4.E10.m1.3.3.1.1.2.3.2.2">italic-ϵ</ci><ci id="S4.E10.m1.3.3.1.1.2.3.2.3.cmml" xref="S4.E10.m1.3.3.1.1.2.3.2.3">𝑖</ci></apply><apply id="S4.E10.m1.3.3.1.1.2.3.3.cmml" xref="S4.E10.m1.3.3.1.1.2.3.3"><divide id="S4.E10.m1.3.3.1.1.2.3.3.1.cmml" xref="S4.E10.m1.3.3.1.1.2.3.3"></divide><cn type="integer" id="S4.E10.m1.3.3.1.1.2.3.3.2.cmml" xref="S4.E10.m1.3.3.1.1.2.3.3.2">1</cn><ci id="S4.E10.m1.3.3.1.1.2.3.3.3.cmml" xref="S4.E10.m1.3.3.1.1.2.3.3.3">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.3c">\hat{p}_{i}(y_{j})=(1-\epsilon_{i})\cdot\frac{n_{i,j}}{n_{i}}+\epsilon_{i}\cdot\frac{1}{C},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.3" class="ltx_p">where <math id="S4.SS1.p2.2.m1.2" class="ltx_Math" alttext="\epsilon_{i}\in[0,1]" display="inline"><semantics id="S4.SS1.p2.2.m1.2a"><mrow id="S4.SS1.p2.2.m1.2.3" xref="S4.SS1.p2.2.m1.2.3.cmml"><msub id="S4.SS1.p2.2.m1.2.3.2" xref="S4.SS1.p2.2.m1.2.3.2.cmml"><mi id="S4.SS1.p2.2.m1.2.3.2.2" xref="S4.SS1.p2.2.m1.2.3.2.2.cmml">ϵ</mi><mi id="S4.SS1.p2.2.m1.2.3.2.3" xref="S4.SS1.p2.2.m1.2.3.2.3.cmml">i</mi></msub><mo id="S4.SS1.p2.2.m1.2.3.1" xref="S4.SS1.p2.2.m1.2.3.1.cmml">∈</mo><mrow id="S4.SS1.p2.2.m1.2.3.3.2" xref="S4.SS1.p2.2.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.2.m1.2.3.3.2.1" xref="S4.SS1.p2.2.m1.2.3.3.1.cmml">[</mo><mn id="S4.SS1.p2.2.m1.1.1" xref="S4.SS1.p2.2.m1.1.1.cmml">0</mn><mo id="S4.SS1.p2.2.m1.2.3.3.2.2" xref="S4.SS1.p2.2.m1.2.3.3.1.cmml">,</mo><mn id="S4.SS1.p2.2.m1.2.2" xref="S4.SS1.p2.2.m1.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS1.p2.2.m1.2.3.3.2.3" xref="S4.SS1.p2.2.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m1.2b"><apply id="S4.SS1.p2.2.m1.2.3.cmml" xref="S4.SS1.p2.2.m1.2.3"><in id="S4.SS1.p2.2.m1.2.3.1.cmml" xref="S4.SS1.p2.2.m1.2.3.1"></in><apply id="S4.SS1.p2.2.m1.2.3.2.cmml" xref="S4.SS1.p2.2.m1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m1.2.3.2.1.cmml" xref="S4.SS1.p2.2.m1.2.3.2">subscript</csymbol><ci id="S4.SS1.p2.2.m1.2.3.2.2.cmml" xref="S4.SS1.p2.2.m1.2.3.2.2">italic-ϵ</ci><ci id="S4.SS1.p2.2.m1.2.3.2.3.cmml" xref="S4.SS1.p2.2.m1.2.3.2.3">𝑖</ci></apply><interval closure="closed" id="S4.SS1.p2.2.m1.2.3.3.1.cmml" xref="S4.SS1.p2.2.m1.2.3.3.2"><cn type="integer" id="S4.SS1.p2.2.m1.1.1.cmml" xref="S4.SS1.p2.2.m1.1.1">0</cn><cn type="integer" id="S4.SS1.p2.2.m1.2.2.cmml" xref="S4.SS1.p2.2.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m1.2c">\epsilon_{i}\in[0,1]</annotation></semantics></math> is a positive and adjustable coefficient (usually small) added for client <math id="S4.SS1.p2.3.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p2.3.m2.1a"><mi id="S4.SS1.p2.3.m2.1.1" xref="S4.SS1.p2.3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m2.1b"><ci id="S4.SS1.p2.3.m2.1.1.cmml" xref="S4.SS1.p2.3.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m2.1c">i</annotation></semantics></math>. It is interesting to see that this form is very similar to the technique of label smoothing. However, employing label smoothing in local training of FL is not effective as we found in empirical evaluation.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.8" class="ltx_p">To further analyze the effect of relaxed balanced-softmax, we represent the classifier parameters <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\bm{\phi}_{i}" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><msub id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">ϕ</mi><mi id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\bm{\phi}_{i}</annotation></semantics></math> of the client <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">i</annotation></semantics></math> as the weight vectors <math id="S4.SS1.p3.3.m3.3" class="ltx_Math" alttext="\{\bm{\phi}_{i,c}\}_{c=1}^{C}" display="inline"><semantics id="S4.SS1.p3.3.m3.3a"><msubsup id="S4.SS1.p3.3.m3.3.3" xref="S4.SS1.p3.3.m3.3.3.cmml"><mrow id="S4.SS1.p3.3.m3.3.3.1.1.1" xref="S4.SS1.p3.3.m3.3.3.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p3.3.m3.3.3.1.1.1.2" xref="S4.SS1.p3.3.m3.3.3.1.1.2.cmml">{</mo><msub id="S4.SS1.p3.3.m3.3.3.1.1.1.1" xref="S4.SS1.p3.3.m3.3.3.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p3.3.m3.3.3.1.1.1.1.2" xref="S4.SS1.p3.3.m3.3.3.1.1.1.1.2.cmml">ϕ</mi><mrow id="S4.SS1.p3.3.m3.2.2.2.4" xref="S4.SS1.p3.3.m3.2.2.2.3.cmml"><mi id="S4.SS1.p3.3.m3.1.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p3.3.m3.2.2.2.4.1" xref="S4.SS1.p3.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p3.3.m3.2.2.2.2" xref="S4.SS1.p3.3.m3.2.2.2.2.cmml">c</mi></mrow></msub><mo stretchy="false" id="S4.SS1.p3.3.m3.3.3.1.1.1.3" xref="S4.SS1.p3.3.m3.3.3.1.1.2.cmml">}</mo></mrow><mrow id="S4.SS1.p3.3.m3.3.3.1.3" xref="S4.SS1.p3.3.m3.3.3.1.3.cmml"><mi id="S4.SS1.p3.3.m3.3.3.1.3.2" xref="S4.SS1.p3.3.m3.3.3.1.3.2.cmml">c</mi><mo id="S4.SS1.p3.3.m3.3.3.1.3.1" xref="S4.SS1.p3.3.m3.3.3.1.3.1.cmml">=</mo><mn id="S4.SS1.p3.3.m3.3.3.1.3.3" xref="S4.SS1.p3.3.m3.3.3.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p3.3.m3.3.3.3" xref="S4.SS1.p3.3.m3.3.3.3.cmml">C</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.3b"><apply id="S4.SS1.p3.3.m3.3.3.cmml" xref="S4.SS1.p3.3.m3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.3.3.2.cmml" xref="S4.SS1.p3.3.m3.3.3">superscript</csymbol><apply id="S4.SS1.p3.3.m3.3.3.1.cmml" xref="S4.SS1.p3.3.m3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.3.3.1.2.cmml" xref="S4.SS1.p3.3.m3.3.3">subscript</csymbol><set id="S4.SS1.p3.3.m3.3.3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.3.3.1.1.1"><apply id="S4.SS1.p3.3.m3.3.3.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.3.3.1.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.3.3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.3.m3.3.3.1.1.1.1.2.cmml" xref="S4.SS1.p3.3.m3.3.3.1.1.1.1.2">bold-italic-ϕ</ci><list id="S4.SS1.p3.3.m3.2.2.2.3.cmml" xref="S4.SS1.p3.3.m3.2.2.2.4"><ci id="S4.SS1.p3.3.m3.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1">𝑖</ci><ci id="S4.SS1.p3.3.m3.2.2.2.2.cmml" xref="S4.SS1.p3.3.m3.2.2.2.2">𝑐</ci></list></apply></set><apply id="S4.SS1.p3.3.m3.3.3.1.3.cmml" xref="S4.SS1.p3.3.m3.3.3.1.3"><eq id="S4.SS1.p3.3.m3.3.3.1.3.1.cmml" xref="S4.SS1.p3.3.m3.3.3.1.3.1"></eq><ci id="S4.SS1.p3.3.m3.3.3.1.3.2.cmml" xref="S4.SS1.p3.3.m3.3.3.1.3.2">𝑐</ci><cn type="integer" id="S4.SS1.p3.3.m3.3.3.1.3.3.cmml" xref="S4.SS1.p3.3.m3.3.3.1.3.3">1</cn></apply></apply><ci id="S4.SS1.p3.3.m3.3.3.3.cmml" xref="S4.SS1.p3.3.m3.3.3.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.3c">\{\bm{\phi}_{i,c}\}_{c=1}^{C}</annotation></semantics></math>, where <math id="S4.SS1.p3.4.m4.2" class="ltx_Math" alttext="\bm{\phi}_{i,c}" display="inline"><semantics id="S4.SS1.p3.4.m4.2a"><msub id="S4.SS1.p3.4.m4.2.3" xref="S4.SS1.p3.4.m4.2.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p3.4.m4.2.3.2" xref="S4.SS1.p3.4.m4.2.3.2.cmml">ϕ</mi><mrow id="S4.SS1.p3.4.m4.2.2.2.4" xref="S4.SS1.p3.4.m4.2.2.2.3.cmml"><mi id="S4.SS1.p3.4.m4.1.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p3.4.m4.2.2.2.4.1" xref="S4.SS1.p3.4.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p3.4.m4.2.2.2.2" xref="S4.SS1.p3.4.m4.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.2b"><apply id="S4.SS1.p3.4.m4.2.3.cmml" xref="S4.SS1.p3.4.m4.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.2.3.1.cmml" xref="S4.SS1.p3.4.m4.2.3">subscript</csymbol><ci id="S4.SS1.p3.4.m4.2.3.2.cmml" xref="S4.SS1.p3.4.m4.2.3.2">bold-italic-ϕ</ci><list id="S4.SS1.p3.4.m4.2.2.2.3.cmml" xref="S4.SS1.p3.4.m4.2.2.2.4"><ci id="S4.SS1.p3.4.m4.1.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1.1">𝑖</ci><ci id="S4.SS1.p3.4.m4.2.2.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.2c">\bm{\phi}_{i,c}</annotation></semantics></math> is named the <math id="S4.SS1.p3.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p3.5.m5.1a"><mi id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b"><ci id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">c</annotation></semantics></math>-th proxy as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>. For simplicity, we set all the bias vectors of the classifier as zeros and use the cross-entropy loss. Let <math id="S4.SS1.p3.6.m6.2" class="ltx_Math" alttext="q_{j,c}" display="inline"><semantics id="S4.SS1.p3.6.m6.2a"><msub id="S4.SS1.p3.6.m6.2.3" xref="S4.SS1.p3.6.m6.2.3.cmml"><mi id="S4.SS1.p3.6.m6.2.3.2" xref="S4.SS1.p3.6.m6.2.3.2.cmml">q</mi><mrow id="S4.SS1.p3.6.m6.2.2.2.4" xref="S4.SS1.p3.6.m6.2.2.2.3.cmml"><mi id="S4.SS1.p3.6.m6.1.1.1.1" xref="S4.SS1.p3.6.m6.1.1.1.1.cmml">j</mi><mo id="S4.SS1.p3.6.m6.2.2.2.4.1" xref="S4.SS1.p3.6.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p3.6.m6.2.2.2.2" xref="S4.SS1.p3.6.m6.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.6.m6.2b"><apply id="S4.SS1.p3.6.m6.2.3.cmml" xref="S4.SS1.p3.6.m6.2.3"><csymbol cd="ambiguous" id="S4.SS1.p3.6.m6.2.3.1.cmml" xref="S4.SS1.p3.6.m6.2.3">subscript</csymbol><ci id="S4.SS1.p3.6.m6.2.3.2.cmml" xref="S4.SS1.p3.6.m6.2.3.2">𝑞</ci><list id="S4.SS1.p3.6.m6.2.2.2.3.cmml" xref="S4.SS1.p3.6.m6.2.2.2.4"><ci id="S4.SS1.p3.6.m6.1.1.1.1.cmml" xref="S4.SS1.p3.6.m6.1.1.1.1">𝑗</ci><ci id="S4.SS1.p3.6.m6.2.2.2.2.cmml" xref="S4.SS1.p3.6.m6.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.6.m6.2c">q_{j,c}</annotation></semantics></math> denote the normalized score of class <math id="S4.SS1.p3.7.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p3.7.m7.1a"><mi id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.7.m7.1b"><ci id="S4.SS1.p3.7.m7.1.1.cmml" xref="S4.SS1.p3.7.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.7.m7.1c">c</annotation></semantics></math> for data point <math id="S4.SS1.p3.8.m8.2" class="ltx_Math" alttext="(\mathbf{x}_{j},y_{j})" display="inline"><semantics id="S4.SS1.p3.8.m8.2a"><mrow id="S4.SS1.p3.8.m8.2.2.2" xref="S4.SS1.p3.8.m8.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p3.8.m8.2.2.2.3" xref="S4.SS1.p3.8.m8.2.2.3.cmml">(</mo><msub id="S4.SS1.p3.8.m8.1.1.1.1" xref="S4.SS1.p3.8.m8.1.1.1.1.cmml"><mi id="S4.SS1.p3.8.m8.1.1.1.1.2" xref="S4.SS1.p3.8.m8.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.SS1.p3.8.m8.1.1.1.1.3" xref="S4.SS1.p3.8.m8.1.1.1.1.3.cmml">j</mi></msub><mo id="S4.SS1.p3.8.m8.2.2.2.4" xref="S4.SS1.p3.8.m8.2.2.3.cmml">,</mo><msub id="S4.SS1.p3.8.m8.2.2.2.2" xref="S4.SS1.p3.8.m8.2.2.2.2.cmml"><mi id="S4.SS1.p3.8.m8.2.2.2.2.2" xref="S4.SS1.p3.8.m8.2.2.2.2.2.cmml">y</mi><mi id="S4.SS1.p3.8.m8.2.2.2.2.3" xref="S4.SS1.p3.8.m8.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S4.SS1.p3.8.m8.2.2.2.5" xref="S4.SS1.p3.8.m8.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.8.m8.2b"><interval closure="open" id="S4.SS1.p3.8.m8.2.2.3.cmml" xref="S4.SS1.p3.8.m8.2.2.2"><apply id="S4.SS1.p3.8.m8.1.1.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.1.1.1.1.1.cmml" xref="S4.SS1.p3.8.m8.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.8.m8.1.1.1.1.2.cmml" xref="S4.SS1.p3.8.m8.1.1.1.1.2">𝐱</ci><ci id="S4.SS1.p3.8.m8.1.1.1.1.3.cmml" xref="S4.SS1.p3.8.m8.1.1.1.1.3">𝑗</ci></apply><apply id="S4.SS1.p3.8.m8.2.2.2.2.cmml" xref="S4.SS1.p3.8.m8.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p3.8.m8.2.2.2.2.1.cmml" xref="S4.SS1.p3.8.m8.2.2.2.2">subscript</csymbol><ci id="S4.SS1.p3.8.m8.2.2.2.2.2.cmml" xref="S4.SS1.p3.8.m8.2.2.2.2.2">𝑦</ci><ci id="S4.SS1.p3.8.m8.2.2.2.2.3.cmml" xref="S4.SS1.p3.8.m8.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.8.m8.2c">(\mathbf{x}_{j},y_{j})</annotation></semantics></math> by the relaxed balanced-softmax, which is written by</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.10" class="ltx_Math" alttext="q_{j,c}=\frac{\hat{p}_{i}(c)e^{\bm{\phi}_{i,c}^{\mathsf{T}}\mathbf{h}_{y_{j}}}}{\sum_{c^{\prime}=1}^{C}\hat{p}_{i}(c^{\prime})e^{\bm{\phi}_{i,c^{\prime}}^{\mathsf{T}}.\mathbf{h}_{y_{j}}}}" display="block"><semantics id="S4.E11.m1.10a"><mrow id="S4.E11.m1.10.11" xref="S4.E11.m1.10.11.cmml"><msub id="S4.E11.m1.10.11.2" xref="S4.E11.m1.10.11.2.cmml"><mi id="S4.E11.m1.10.11.2.2" xref="S4.E11.m1.10.11.2.2.cmml">q</mi><mrow id="S4.E11.m1.2.2.2.4" xref="S4.E11.m1.2.2.2.3.cmml"><mi id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml">j</mi><mo id="S4.E11.m1.2.2.2.4.1" xref="S4.E11.m1.2.2.2.3.cmml">,</mo><mi id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.2.cmml">c</mi></mrow></msub><mo id="S4.E11.m1.10.11.1" xref="S4.E11.m1.10.11.1.cmml">=</mo><mfrac id="S4.E11.m1.10.10" xref="S4.E11.m1.10.10.cmml"><mrow id="S4.E11.m1.5.5.3" xref="S4.E11.m1.5.5.3.cmml"><msub id="S4.E11.m1.5.5.3.5" xref="S4.E11.m1.5.5.3.5.cmml"><mover accent="true" id="S4.E11.m1.5.5.3.5.2" xref="S4.E11.m1.5.5.3.5.2.cmml"><mi id="S4.E11.m1.5.5.3.5.2.2" xref="S4.E11.m1.5.5.3.5.2.2.cmml">p</mi><mo id="S4.E11.m1.5.5.3.5.2.1" xref="S4.E11.m1.5.5.3.5.2.1.cmml">^</mo></mover><mi id="S4.E11.m1.5.5.3.5.3" xref="S4.E11.m1.5.5.3.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.5.5.3.4" xref="S4.E11.m1.5.5.3.4.cmml">​</mo><mrow id="S4.E11.m1.5.5.3.6.2" xref="S4.E11.m1.5.5.3.cmml"><mo stretchy="false" id="S4.E11.m1.5.5.3.6.2.1" xref="S4.E11.m1.5.5.3.cmml">(</mo><mi id="S4.E11.m1.5.5.3.3" xref="S4.E11.m1.5.5.3.3.cmml">c</mi><mo stretchy="false" id="S4.E11.m1.5.5.3.6.2.2" xref="S4.E11.m1.5.5.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E11.m1.5.5.3.4a" xref="S4.E11.m1.5.5.3.4.cmml">​</mo><msup id="S4.E11.m1.5.5.3.7" xref="S4.E11.m1.5.5.3.7.cmml"><mi id="S4.E11.m1.5.5.3.7.2" xref="S4.E11.m1.5.5.3.7.2.cmml">e</mi><mrow id="S4.E11.m1.4.4.2.2.2" xref="S4.E11.m1.4.4.2.2.2.cmml"><msubsup id="S4.E11.m1.4.4.2.2.2.4" xref="S4.E11.m1.4.4.2.2.2.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E11.m1.4.4.2.2.2.4.2.2" xref="S4.E11.m1.4.4.2.2.2.4.2.2.cmml">ϕ</mi><mrow id="S4.E11.m1.4.4.2.2.2.2.2.4" xref="S4.E11.m1.4.4.2.2.2.2.2.3.cmml"><mi id="S4.E11.m1.3.3.1.1.1.1.1.1" xref="S4.E11.m1.3.3.1.1.1.1.1.1.cmml">i</mi><mo id="S4.E11.m1.4.4.2.2.2.2.2.4.1" xref="S4.E11.m1.4.4.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E11.m1.4.4.2.2.2.2.2.2" xref="S4.E11.m1.4.4.2.2.2.2.2.2.cmml">c</mi></mrow><mi id="S4.E11.m1.4.4.2.2.2.4.3" xref="S4.E11.m1.4.4.2.2.2.4.3.cmml">𝖳</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.2.2.2.3" xref="S4.E11.m1.4.4.2.2.2.3.cmml">​</mo><msub id="S4.E11.m1.4.4.2.2.2.5" xref="S4.E11.m1.4.4.2.2.2.5.cmml"><mi id="S4.E11.m1.4.4.2.2.2.5.2" xref="S4.E11.m1.4.4.2.2.2.5.2.cmml">𝐡</mi><msub id="S4.E11.m1.4.4.2.2.2.5.3" xref="S4.E11.m1.4.4.2.2.2.5.3.cmml"><mi id="S4.E11.m1.4.4.2.2.2.5.3.2" xref="S4.E11.m1.4.4.2.2.2.5.3.2.cmml">y</mi><mi id="S4.E11.m1.4.4.2.2.2.5.3.3" xref="S4.E11.m1.4.4.2.2.2.5.3.3.cmml">j</mi></msub></msub></mrow></msup></mrow><mrow id="S4.E11.m1.10.10.8" xref="S4.E11.m1.10.10.8.cmml"><msubsup id="S4.E11.m1.10.10.8.6" xref="S4.E11.m1.10.10.8.6.cmml"><mo id="S4.E11.m1.10.10.8.6.2.2" xref="S4.E11.m1.10.10.8.6.2.2.cmml">∑</mo><mrow id="S4.E11.m1.10.10.8.6.2.3" xref="S4.E11.m1.10.10.8.6.2.3.cmml"><msup id="S4.E11.m1.10.10.8.6.2.3.2" xref="S4.E11.m1.10.10.8.6.2.3.2.cmml"><mi id="S4.E11.m1.10.10.8.6.2.3.2.2" xref="S4.E11.m1.10.10.8.6.2.3.2.2.cmml">c</mi><mo id="S4.E11.m1.10.10.8.6.2.3.2.3" xref="S4.E11.m1.10.10.8.6.2.3.2.3.cmml">′</mo></msup><mo id="S4.E11.m1.10.10.8.6.2.3.1" xref="S4.E11.m1.10.10.8.6.2.3.1.cmml">=</mo><mn id="S4.E11.m1.10.10.8.6.2.3.3" xref="S4.E11.m1.10.10.8.6.2.3.3.cmml">1</mn></mrow><mi id="S4.E11.m1.10.10.8.6.3" xref="S4.E11.m1.10.10.8.6.3.cmml">C</mi></msubsup><mrow id="S4.E11.m1.10.10.8.5" xref="S4.E11.m1.10.10.8.5.cmml"><msub id="S4.E11.m1.10.10.8.5.3" xref="S4.E11.m1.10.10.8.5.3.cmml"><mover accent="true" id="S4.E11.m1.10.10.8.5.3.2" xref="S4.E11.m1.10.10.8.5.3.2.cmml"><mi id="S4.E11.m1.10.10.8.5.3.2.2" xref="S4.E11.m1.10.10.8.5.3.2.2.cmml">p</mi><mo id="S4.E11.m1.10.10.8.5.3.2.1" xref="S4.E11.m1.10.10.8.5.3.2.1.cmml">^</mo></mover><mi id="S4.E11.m1.10.10.8.5.3.3" xref="S4.E11.m1.10.10.8.5.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.10.10.8.5.2" xref="S4.E11.m1.10.10.8.5.2.cmml">​</mo><mrow id="S4.E11.m1.10.10.8.5.1.1" xref="S4.E11.m1.10.10.8.5.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.10.10.8.5.1.1.2" xref="S4.E11.m1.10.10.8.5.1.1.1.cmml">(</mo><msup id="S4.E11.m1.10.10.8.5.1.1.1" xref="S4.E11.m1.10.10.8.5.1.1.1.cmml"><mi id="S4.E11.m1.10.10.8.5.1.1.1.2" xref="S4.E11.m1.10.10.8.5.1.1.1.2.cmml">c</mi><mo id="S4.E11.m1.10.10.8.5.1.1.1.3" xref="S4.E11.m1.10.10.8.5.1.1.1.3.cmml">′</mo></msup><mo stretchy="false" id="S4.E11.m1.10.10.8.5.1.1.3" xref="S4.E11.m1.10.10.8.5.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E11.m1.10.10.8.5.2a" xref="S4.E11.m1.10.10.8.5.2.cmml">​</mo><msup id="S4.E11.m1.10.10.8.5.4" xref="S4.E11.m1.10.10.8.5.4.cmml"><mi id="S4.E11.m1.10.10.8.5.4.2" xref="S4.E11.m1.10.10.8.5.4.2.cmml">e</mi><mrow id="S4.E11.m1.9.9.7.4.4.4" xref="S4.E11.m1.9.9.7.4.4.5.cmml"><msubsup id="S4.E11.m1.8.8.6.3.3.3.1" xref="S4.E11.m1.8.8.6.3.3.3.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E11.m1.8.8.6.3.3.3.1.2.2" xref="S4.E11.m1.8.8.6.3.3.3.1.2.2.cmml">ϕ</mi><mrow id="S4.E11.m1.7.7.5.2.2.2.2.2" xref="S4.E11.m1.7.7.5.2.2.2.2.3.cmml"><mi id="S4.E11.m1.6.6.4.1.1.1.1.1" xref="S4.E11.m1.6.6.4.1.1.1.1.1.cmml">i</mi><mo id="S4.E11.m1.7.7.5.2.2.2.2.2.2" xref="S4.E11.m1.7.7.5.2.2.2.2.3.cmml">,</mo><msup id="S4.E11.m1.7.7.5.2.2.2.2.2.1" xref="S4.E11.m1.7.7.5.2.2.2.2.2.1.cmml"><mi id="S4.E11.m1.7.7.5.2.2.2.2.2.1.2" xref="S4.E11.m1.7.7.5.2.2.2.2.2.1.2.cmml">c</mi><mo id="S4.E11.m1.7.7.5.2.2.2.2.2.1.3" xref="S4.E11.m1.7.7.5.2.2.2.2.2.1.3.cmml">′</mo></msup></mrow><mi id="S4.E11.m1.8.8.6.3.3.3.1.3" xref="S4.E11.m1.8.8.6.3.3.3.1.3.cmml">𝖳</mi></msubsup><mo lspace="0em" rspace="0.167em" id="S4.E11.m1.9.9.7.4.4.4.3" xref="S4.E11.m1.9.9.7.4.4.5a.cmml">.</mo><msub id="S4.E11.m1.9.9.7.4.4.4.2" xref="S4.E11.m1.9.9.7.4.4.4.2.cmml"><mi id="S4.E11.m1.9.9.7.4.4.4.2.2" xref="S4.E11.m1.9.9.7.4.4.4.2.2.cmml">𝐡</mi><msub id="S4.E11.m1.9.9.7.4.4.4.2.3" xref="S4.E11.m1.9.9.7.4.4.4.2.3.cmml"><mi id="S4.E11.m1.9.9.7.4.4.4.2.3.2" xref="S4.E11.m1.9.9.7.4.4.4.2.3.2.cmml">y</mi><mi id="S4.E11.m1.9.9.7.4.4.4.2.3.3" xref="S4.E11.m1.9.9.7.4.4.4.2.3.3.cmml">j</mi></msub></msub></mrow></msup></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.10b"><apply id="S4.E11.m1.10.11.cmml" xref="S4.E11.m1.10.11"><eq id="S4.E11.m1.10.11.1.cmml" xref="S4.E11.m1.10.11.1"></eq><apply id="S4.E11.m1.10.11.2.cmml" xref="S4.E11.m1.10.11.2"><csymbol cd="ambiguous" id="S4.E11.m1.10.11.2.1.cmml" xref="S4.E11.m1.10.11.2">subscript</csymbol><ci id="S4.E11.m1.10.11.2.2.cmml" xref="S4.E11.m1.10.11.2.2">𝑞</ci><list id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.4"><ci id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1">𝑗</ci><ci id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2">𝑐</ci></list></apply><apply id="S4.E11.m1.10.10.cmml" xref="S4.E11.m1.10.10"><divide id="S4.E11.m1.10.10.9.cmml" xref="S4.E11.m1.10.10"></divide><apply id="S4.E11.m1.5.5.3.cmml" xref="S4.E11.m1.5.5.3"><times id="S4.E11.m1.5.5.3.4.cmml" xref="S4.E11.m1.5.5.3.4"></times><apply id="S4.E11.m1.5.5.3.5.cmml" xref="S4.E11.m1.5.5.3.5"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.3.5.1.cmml" xref="S4.E11.m1.5.5.3.5">subscript</csymbol><apply id="S4.E11.m1.5.5.3.5.2.cmml" xref="S4.E11.m1.5.5.3.5.2"><ci id="S4.E11.m1.5.5.3.5.2.1.cmml" xref="S4.E11.m1.5.5.3.5.2.1">^</ci><ci id="S4.E11.m1.5.5.3.5.2.2.cmml" xref="S4.E11.m1.5.5.3.5.2.2">𝑝</ci></apply><ci id="S4.E11.m1.5.5.3.5.3.cmml" xref="S4.E11.m1.5.5.3.5.3">𝑖</ci></apply><ci id="S4.E11.m1.5.5.3.3.cmml" xref="S4.E11.m1.5.5.3.3">𝑐</ci><apply id="S4.E11.m1.5.5.3.7.cmml" xref="S4.E11.m1.5.5.3.7"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.3.7.1.cmml" xref="S4.E11.m1.5.5.3.7">superscript</csymbol><ci id="S4.E11.m1.5.5.3.7.2.cmml" xref="S4.E11.m1.5.5.3.7.2">𝑒</ci><apply id="S4.E11.m1.4.4.2.2.2.cmml" xref="S4.E11.m1.4.4.2.2.2"><times id="S4.E11.m1.4.4.2.2.2.3.cmml" xref="S4.E11.m1.4.4.2.2.2.3"></times><apply id="S4.E11.m1.4.4.2.2.2.4.cmml" xref="S4.E11.m1.4.4.2.2.2.4"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.2.2.4.1.cmml" xref="S4.E11.m1.4.4.2.2.2.4">superscript</csymbol><apply id="S4.E11.m1.4.4.2.2.2.4.2.cmml" xref="S4.E11.m1.4.4.2.2.2.4"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.2.2.4.2.1.cmml" xref="S4.E11.m1.4.4.2.2.2.4">subscript</csymbol><ci id="S4.E11.m1.4.4.2.2.2.4.2.2.cmml" xref="S4.E11.m1.4.4.2.2.2.4.2.2">bold-italic-ϕ</ci><list id="S4.E11.m1.4.4.2.2.2.2.2.3.cmml" xref="S4.E11.m1.4.4.2.2.2.2.2.4"><ci id="S4.E11.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1">𝑖</ci><ci id="S4.E11.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.E11.m1.4.4.2.2.2.2.2.2">𝑐</ci></list></apply><ci id="S4.E11.m1.4.4.2.2.2.4.3.cmml" xref="S4.E11.m1.4.4.2.2.2.4.3">𝖳</ci></apply><apply id="S4.E11.m1.4.4.2.2.2.5.cmml" xref="S4.E11.m1.4.4.2.2.2.5"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.2.2.5.1.cmml" xref="S4.E11.m1.4.4.2.2.2.5">subscript</csymbol><ci id="S4.E11.m1.4.4.2.2.2.5.2.cmml" xref="S4.E11.m1.4.4.2.2.2.5.2">𝐡</ci><apply id="S4.E11.m1.4.4.2.2.2.5.3.cmml" xref="S4.E11.m1.4.4.2.2.2.5.3"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.2.2.5.3.1.cmml" xref="S4.E11.m1.4.4.2.2.2.5.3">subscript</csymbol><ci id="S4.E11.m1.4.4.2.2.2.5.3.2.cmml" xref="S4.E11.m1.4.4.2.2.2.5.3.2">𝑦</ci><ci id="S4.E11.m1.4.4.2.2.2.5.3.3.cmml" xref="S4.E11.m1.4.4.2.2.2.5.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S4.E11.m1.10.10.8.cmml" xref="S4.E11.m1.10.10.8"><apply id="S4.E11.m1.10.10.8.6.cmml" xref="S4.E11.m1.10.10.8.6"><csymbol cd="ambiguous" id="S4.E11.m1.10.10.8.6.1.cmml" xref="S4.E11.m1.10.10.8.6">superscript</csymbol><apply id="S4.E11.m1.10.10.8.6.2.cmml" xref="S4.E11.m1.10.10.8.6"><csymbol cd="ambiguous" id="S4.E11.m1.10.10.8.6.2.1.cmml" xref="S4.E11.m1.10.10.8.6">subscript</csymbol><sum id="S4.E11.m1.10.10.8.6.2.2.cmml" xref="S4.E11.m1.10.10.8.6.2.2"></sum><apply id="S4.E11.m1.10.10.8.6.2.3.cmml" xref="S4.E11.m1.10.10.8.6.2.3"><eq id="S4.E11.m1.10.10.8.6.2.3.1.cmml" xref="S4.E11.m1.10.10.8.6.2.3.1"></eq><apply id="S4.E11.m1.10.10.8.6.2.3.2.cmml" xref="S4.E11.m1.10.10.8.6.2.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.10.10.8.6.2.3.2.1.cmml" xref="S4.E11.m1.10.10.8.6.2.3.2">superscript</csymbol><ci id="S4.E11.m1.10.10.8.6.2.3.2.2.cmml" xref="S4.E11.m1.10.10.8.6.2.3.2.2">𝑐</ci><ci id="S4.E11.m1.10.10.8.6.2.3.2.3.cmml" xref="S4.E11.m1.10.10.8.6.2.3.2.3">′</ci></apply><cn type="integer" id="S4.E11.m1.10.10.8.6.2.3.3.cmml" xref="S4.E11.m1.10.10.8.6.2.3.3">1</cn></apply></apply><ci id="S4.E11.m1.10.10.8.6.3.cmml" xref="S4.E11.m1.10.10.8.6.3">𝐶</ci></apply><apply id="S4.E11.m1.10.10.8.5.cmml" xref="S4.E11.m1.10.10.8.5"><times id="S4.E11.m1.10.10.8.5.2.cmml" xref="S4.E11.m1.10.10.8.5.2"></times><apply id="S4.E11.m1.10.10.8.5.3.cmml" xref="S4.E11.m1.10.10.8.5.3"><csymbol cd="ambiguous" id="S4.E11.m1.10.10.8.5.3.1.cmml" xref="S4.E11.m1.10.10.8.5.3">subscript</csymbol><apply id="S4.E11.m1.10.10.8.5.3.2.cmml" xref="S4.E11.m1.10.10.8.5.3.2"><ci id="S4.E11.m1.10.10.8.5.3.2.1.cmml" xref="S4.E11.m1.10.10.8.5.3.2.1">^</ci><ci id="S4.E11.m1.10.10.8.5.3.2.2.cmml" xref="S4.E11.m1.10.10.8.5.3.2.2">𝑝</ci></apply><ci id="S4.E11.m1.10.10.8.5.3.3.cmml" xref="S4.E11.m1.10.10.8.5.3.3">𝑖</ci></apply><apply id="S4.E11.m1.10.10.8.5.1.1.1.cmml" xref="S4.E11.m1.10.10.8.5.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.10.10.8.5.1.1.1.1.cmml" xref="S4.E11.m1.10.10.8.5.1.1">superscript</csymbol><ci id="S4.E11.m1.10.10.8.5.1.1.1.2.cmml" xref="S4.E11.m1.10.10.8.5.1.1.1.2">𝑐</ci><ci id="S4.E11.m1.10.10.8.5.1.1.1.3.cmml" xref="S4.E11.m1.10.10.8.5.1.1.1.3">′</ci></apply><apply id="S4.E11.m1.10.10.8.5.4.cmml" xref="S4.E11.m1.10.10.8.5.4"><csymbol cd="ambiguous" id="S4.E11.m1.10.10.8.5.4.1.cmml" xref="S4.E11.m1.10.10.8.5.4">superscript</csymbol><ci id="S4.E11.m1.10.10.8.5.4.2.cmml" xref="S4.E11.m1.10.10.8.5.4.2">𝑒</ci><apply id="S4.E11.m1.9.9.7.4.4.5.cmml" xref="S4.E11.m1.9.9.7.4.4.4"><csymbol cd="ambiguous" id="S4.E11.m1.9.9.7.4.4.5a.cmml" xref="S4.E11.m1.9.9.7.4.4.4.3">formulae-sequence</csymbol><apply id="S4.E11.m1.8.8.6.3.3.3.1.cmml" xref="S4.E11.m1.8.8.6.3.3.3.1"><csymbol cd="ambiguous" id="S4.E11.m1.8.8.6.3.3.3.1.1.cmml" xref="S4.E11.m1.8.8.6.3.3.3.1">superscript</csymbol><apply id="S4.E11.m1.8.8.6.3.3.3.1.2.cmml" xref="S4.E11.m1.8.8.6.3.3.3.1"><csymbol cd="ambiguous" id="S4.E11.m1.8.8.6.3.3.3.1.2.1.cmml" xref="S4.E11.m1.8.8.6.3.3.3.1">subscript</csymbol><ci id="S4.E11.m1.8.8.6.3.3.3.1.2.2.cmml" xref="S4.E11.m1.8.8.6.3.3.3.1.2.2">bold-italic-ϕ</ci><list id="S4.E11.m1.7.7.5.2.2.2.2.3.cmml" xref="S4.E11.m1.7.7.5.2.2.2.2.2"><ci id="S4.E11.m1.6.6.4.1.1.1.1.1.cmml" xref="S4.E11.m1.6.6.4.1.1.1.1.1">𝑖</ci><apply id="S4.E11.m1.7.7.5.2.2.2.2.2.1.cmml" xref="S4.E11.m1.7.7.5.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.E11.m1.7.7.5.2.2.2.2.2.1.1.cmml" xref="S4.E11.m1.7.7.5.2.2.2.2.2.1">superscript</csymbol><ci id="S4.E11.m1.7.7.5.2.2.2.2.2.1.2.cmml" xref="S4.E11.m1.7.7.5.2.2.2.2.2.1.2">𝑐</ci><ci id="S4.E11.m1.7.7.5.2.2.2.2.2.1.3.cmml" xref="S4.E11.m1.7.7.5.2.2.2.2.2.1.3">′</ci></apply></list></apply><ci id="S4.E11.m1.8.8.6.3.3.3.1.3.cmml" xref="S4.E11.m1.8.8.6.3.3.3.1.3">𝖳</ci></apply><apply id="S4.E11.m1.9.9.7.4.4.4.2.cmml" xref="S4.E11.m1.9.9.7.4.4.4.2"><csymbol cd="ambiguous" id="S4.E11.m1.9.9.7.4.4.4.2.1.cmml" xref="S4.E11.m1.9.9.7.4.4.4.2">subscript</csymbol><ci id="S4.E11.m1.9.9.7.4.4.4.2.2.cmml" xref="S4.E11.m1.9.9.7.4.4.4.2.2">𝐡</ci><apply id="S4.E11.m1.9.9.7.4.4.4.2.3.cmml" xref="S4.E11.m1.9.9.7.4.4.4.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.9.9.7.4.4.4.2.3.1.cmml" xref="S4.E11.m1.9.9.7.4.4.4.2.3">subscript</csymbol><ci id="S4.E11.m1.9.9.7.4.4.4.2.3.2.cmml" xref="S4.E11.m1.9.9.7.4.4.4.2.3.2">𝑦</ci><ci id="S4.E11.m1.9.9.7.4.4.4.2.3.3.cmml" xref="S4.E11.m1.9.9.7.4.4.4.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.10c">q_{j,c}=\frac{\hat{p}_{i}(c)e^{\bm{\phi}_{i,c}^{\mathsf{T}}\mathbf{h}_{y_{j}}}}{\sum_{c^{\prime}=1}^{C}\hat{p}_{i}(c^{\prime})e^{\bm{\phi}_{i,c^{\prime}}^{\mathsf{T}}.\mathbf{h}_{y_{j}}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p3.11" class="ltx_p">Then, the local objective function can be represented as:</p>
<table id="S4.E12" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E12X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E12X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{i}=-\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}\sum_{c=1}^{C}\mathbb{I}\left\{y_{j}=c\right\}\log\left(q_{j,c}\right)," display="inline"><semantics id="S4.E12X.2.1.1.m1.4a"><mrow id="S4.E12X.2.1.1.m1.4.4.1" xref="S4.E12X.2.1.1.m1.4.4.1.1.cmml"><mrow id="S4.E12X.2.1.1.m1.4.4.1.1" xref="S4.E12X.2.1.1.m1.4.4.1.1.cmml"><msub id="S4.E12X.2.1.1.m1.4.4.1.1.4" xref="S4.E12X.2.1.1.m1.4.4.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12X.2.1.1.m1.4.4.1.1.4.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.4.2.cmml">ℒ</mi><mi id="S4.E12X.2.1.1.m1.4.4.1.1.4.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.4.3.cmml">i</mi></msub><mo id="S4.E12X.2.1.1.m1.4.4.1.1.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.3.cmml">=</mo><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.cmml"><mo id="S4.E12X.2.1.1.m1.4.4.1.1.2a" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.cmml">−</mo><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.2.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.cmml"><mstyle displaystyle="true" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.cmml"><mfrac id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4a" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.cmml"><mn id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.2.cmml">1</mn><msub id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.cmml"><mi id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.2.cmml">n</mi><mi id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.3.cmml">i</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.3.cmml">​</mo><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml"><munderover id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3a" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml"><mo movablelimits="false" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.cmml"><mi id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.2.cmml">j</mi><mo id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.1" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.cmml"><mi id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.2.cmml">n</mi><mi id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.3.cmml">i</mi></msub></munderover></mstyle><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml"><munderover id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3a" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml"><mo movablelimits="false" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.cmml"><mi id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.2.cmml">c</mi><mo id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.1" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.3.cmml">C</mi></munderover></mstyle><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml"><mi id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.4" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.4.cmml">𝕀</mi><mo lspace="0em" rspace="0em" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.3.cmml">​</mo><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mo id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">{</mo><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi></msub><mo id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml">=</mo><mi id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.3a" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.3.cmml">​</mo><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml"><mi id="S4.E12X.2.1.1.m1.3.3" xref="S4.E12X.2.1.1.m1.3.3.cmml">log</mi><mo id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1a" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml">⁡</mo><mrow id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml"><mo id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml">(</mo><msub id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.1" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.2.cmml">q</mi><mrow id="S4.E12X.2.1.1.m1.2.2.2.4" xref="S4.E12X.2.1.1.m1.2.2.2.3.cmml"><mi id="S4.E12X.2.1.1.m1.1.1.1.1" xref="S4.E12X.2.1.1.m1.1.1.1.1.cmml">j</mi><mo id="S4.E12X.2.1.1.m1.2.2.2.4.1" xref="S4.E12X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.E12X.2.1.1.m1.2.2.2.2" xref="S4.E12X.2.1.1.m1.2.2.2.2.cmml">c</mi></mrow></msub><mo id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.3" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E12X.2.1.1.m1.4.4.1.2" xref="S4.E12X.2.1.1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12X.2.1.1.m1.4b"><apply id="S4.E12X.2.1.1.m1.4.4.1.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1"><eq id="S4.E12X.2.1.1.m1.4.4.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.3"></eq><apply id="S4.E12X.2.1.1.m1.4.4.1.1.4.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.4.4.1.1.4.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.4">subscript</csymbol><ci id="S4.E12X.2.1.1.m1.4.4.1.1.4.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.4.2">ℒ</ci><ci id="S4.E12X.2.1.1.m1.4.4.1.1.4.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.4.3">𝑖</ci></apply><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2"><minus id="S4.E12X.2.1.1.m1.4.4.1.1.2.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2"></minus><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2"><times id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.3"></times><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4"><divide id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4"></divide><cn type="integer" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.2">1</cn><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3">subscript</csymbol><ci id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.2">𝑛</ci><ci id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2"><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3">superscript</csymbol><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3">subscript</csymbol><sum id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.2"></sum><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3"><eq id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.1"></eq><ci id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.2">𝑗</ci><cn type="integer" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3">subscript</csymbol><ci id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.2">𝑛</ci><ci id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.3.3.3">𝑖</ci></apply></apply><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2"><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3">superscript</csymbol><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3">subscript</csymbol><sum id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.2"></sum><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3"><eq id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.1"></eq><ci id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.2">𝑐</ci><cn type="integer" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.3.3">𝐶</ci></apply><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2"><times id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.3"></times><ci id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.4.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.4">𝕀</ci><set id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1"><apply id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1"><eq id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"></eq><apply id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.1.1.1.1.1.1.1.1.3">𝑐</ci></apply></set><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1"><log id="S4.E12X.2.1.1.m1.3.3.cmml" xref="S4.E12X.2.1.1.m1.3.3"></log><apply id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E12X.2.1.1.m1.4.4.1.1.2.2.2.2.2.2.1.1.1.2">𝑞</ci><list id="S4.E12X.2.1.1.m1.2.2.2.3.cmml" xref="S4.E12X.2.1.1.m1.2.2.2.4"><ci id="S4.E12X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E12X.2.1.1.m1.1.1.1.1">𝑗</ci><ci id="S4.E12X.2.1.1.m1.2.2.2.2.cmml" xref="S4.E12X.2.1.1.m1.2.2.2.2">𝑐</ci></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12X.2.1.1.m1.4c">\displaystyle\mathcal{L}_{i}=-\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}\sum_{c=1}^{C}\mathbb{I}\left\{y_{j}=c\right\}\log\left(q_{j,c}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(12)</span></td>
</tr>
</tbody>
</table>
<p id="S4.SS1.p3.10" class="ltx_p">where <math id="S4.SS1.p3.9.m1.3" class="ltx_Math" alttext="\mathbf{h}_{i,y_{j}}=f_{\mathbf{\theta}}(\mathbf{x}_{j})" display="inline"><semantics id="S4.SS1.p3.9.m1.3a"><mrow id="S4.SS1.p3.9.m1.3.3" xref="S4.SS1.p3.9.m1.3.3.cmml"><msub id="S4.SS1.p3.9.m1.3.3.3" xref="S4.SS1.p3.9.m1.3.3.3.cmml"><mi id="S4.SS1.p3.9.m1.3.3.3.2" xref="S4.SS1.p3.9.m1.3.3.3.2.cmml">𝐡</mi><mrow id="S4.SS1.p3.9.m1.2.2.2.2" xref="S4.SS1.p3.9.m1.2.2.2.3.cmml"><mi id="S4.SS1.p3.9.m1.1.1.1.1" xref="S4.SS1.p3.9.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p3.9.m1.2.2.2.2.2" xref="S4.SS1.p3.9.m1.2.2.2.3.cmml">,</mo><msub id="S4.SS1.p3.9.m1.2.2.2.2.1" xref="S4.SS1.p3.9.m1.2.2.2.2.1.cmml"><mi id="S4.SS1.p3.9.m1.2.2.2.2.1.2" xref="S4.SS1.p3.9.m1.2.2.2.2.1.2.cmml">y</mi><mi id="S4.SS1.p3.9.m1.2.2.2.2.1.3" xref="S4.SS1.p3.9.m1.2.2.2.2.1.3.cmml">j</mi></msub></mrow></msub><mo id="S4.SS1.p3.9.m1.3.3.2" xref="S4.SS1.p3.9.m1.3.3.2.cmml">=</mo><mrow id="S4.SS1.p3.9.m1.3.3.1" xref="S4.SS1.p3.9.m1.3.3.1.cmml"><msub id="S4.SS1.p3.9.m1.3.3.1.3" xref="S4.SS1.p3.9.m1.3.3.1.3.cmml"><mi id="S4.SS1.p3.9.m1.3.3.1.3.2" xref="S4.SS1.p3.9.m1.3.3.1.3.2.cmml">f</mi><mi id="S4.SS1.p3.9.m1.3.3.1.3.3" xref="S4.SS1.p3.9.m1.3.3.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p3.9.m1.3.3.1.2" xref="S4.SS1.p3.9.m1.3.3.1.2.cmml">​</mo><mrow id="S4.SS1.p3.9.m1.3.3.1.1.1" xref="S4.SS1.p3.9.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.9.m1.3.3.1.1.1.2" xref="S4.SS1.p3.9.m1.3.3.1.1.1.1.cmml">(</mo><msub id="S4.SS1.p3.9.m1.3.3.1.1.1.1" xref="S4.SS1.p3.9.m1.3.3.1.1.1.1.cmml"><mi id="S4.SS1.p3.9.m1.3.3.1.1.1.1.2" xref="S4.SS1.p3.9.m1.3.3.1.1.1.1.2.cmml">𝐱</mi><mi id="S4.SS1.p3.9.m1.3.3.1.1.1.1.3" xref="S4.SS1.p3.9.m1.3.3.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S4.SS1.p3.9.m1.3.3.1.1.1.3" xref="S4.SS1.p3.9.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.9.m1.3b"><apply id="S4.SS1.p3.9.m1.3.3.cmml" xref="S4.SS1.p3.9.m1.3.3"><eq id="S4.SS1.p3.9.m1.3.3.2.cmml" xref="S4.SS1.p3.9.m1.3.3.2"></eq><apply id="S4.SS1.p3.9.m1.3.3.3.cmml" xref="S4.SS1.p3.9.m1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m1.3.3.3.1.cmml" xref="S4.SS1.p3.9.m1.3.3.3">subscript</csymbol><ci id="S4.SS1.p3.9.m1.3.3.3.2.cmml" xref="S4.SS1.p3.9.m1.3.3.3.2">𝐡</ci><list id="S4.SS1.p3.9.m1.2.2.2.3.cmml" xref="S4.SS1.p3.9.m1.2.2.2.2"><ci id="S4.SS1.p3.9.m1.1.1.1.1.cmml" xref="S4.SS1.p3.9.m1.1.1.1.1">𝑖</ci><apply id="S4.SS1.p3.9.m1.2.2.2.2.1.cmml" xref="S4.SS1.p3.9.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m1.2.2.2.2.1.1.cmml" xref="S4.SS1.p3.9.m1.2.2.2.2.1">subscript</csymbol><ci id="S4.SS1.p3.9.m1.2.2.2.2.1.2.cmml" xref="S4.SS1.p3.9.m1.2.2.2.2.1.2">𝑦</ci><ci id="S4.SS1.p3.9.m1.2.2.2.2.1.3.cmml" xref="S4.SS1.p3.9.m1.2.2.2.2.1.3">𝑗</ci></apply></list></apply><apply id="S4.SS1.p3.9.m1.3.3.1.cmml" xref="S4.SS1.p3.9.m1.3.3.1"><times id="S4.SS1.p3.9.m1.3.3.1.2.cmml" xref="S4.SS1.p3.9.m1.3.3.1.2"></times><apply id="S4.SS1.p3.9.m1.3.3.1.3.cmml" xref="S4.SS1.p3.9.m1.3.3.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m1.3.3.1.3.1.cmml" xref="S4.SS1.p3.9.m1.3.3.1.3">subscript</csymbol><ci id="S4.SS1.p3.9.m1.3.3.1.3.2.cmml" xref="S4.SS1.p3.9.m1.3.3.1.3.2">𝑓</ci><ci id="S4.SS1.p3.9.m1.3.3.1.3.3.cmml" xref="S4.SS1.p3.9.m1.3.3.1.3.3">𝜃</ci></apply><apply id="S4.SS1.p3.9.m1.3.3.1.1.1.1.cmml" xref="S4.SS1.p3.9.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.9.m1.3.3.1.1.1.1.1.cmml" xref="S4.SS1.p3.9.m1.3.3.1.1.1">subscript</csymbol><ci id="S4.SS1.p3.9.m1.3.3.1.1.1.1.2.cmml" xref="S4.SS1.p3.9.m1.3.3.1.1.1.1.2">𝐱</ci><ci id="S4.SS1.p3.9.m1.3.3.1.1.1.1.3.cmml" xref="S4.SS1.p3.9.m1.3.3.1.1.1.1.3">𝑗</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.9.m1.3c">\mathbf{h}_{i,y_{j}}=f_{\mathbf{\theta}}(\mathbf{x}_{j})</annotation></semantics></math> is the feature embedding and <math id="S4.SS1.p3.10.m2.1" class="ltx_Math" alttext="\mathbf{\theta}" display="inline"><semantics id="S4.SS1.p3.10.m2.1a"><mi id="S4.SS1.p3.10.m2.1.1" xref="S4.SS1.p3.10.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.10.m2.1b"><ci id="S4.SS1.p3.10.m2.1.1.cmml" xref="S4.SS1.p3.10.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.10.m2.1c">\mathbf{\theta}</annotation></semantics></math> denotes the feature extractor. The benefits of applying relaxed balanced-softmax are illustrated as follows.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.6" class="ltx_p">Firstly, the smoothed prior can mitigate the staleness of proxies. For the <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mi id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><ci id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">c</annotation></semantics></math>-th proxy <math id="S4.SS1.p4.2.m2.2" class="ltx_Math" alttext="\bm{\phi}_{i,c}" display="inline"><semantics id="S4.SS1.p4.2.m2.2a"><msub id="S4.SS1.p4.2.m2.2.3" xref="S4.SS1.p4.2.m2.2.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p4.2.m2.2.3.2" xref="S4.SS1.p4.2.m2.2.3.2.cmml">ϕ</mi><mrow id="S4.SS1.p4.2.m2.2.2.2.4" xref="S4.SS1.p4.2.m2.2.2.2.3.cmml"><mi id="S4.SS1.p4.2.m2.1.1.1.1" xref="S4.SS1.p4.2.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p4.2.m2.2.2.2.4.1" xref="S4.SS1.p4.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p4.2.m2.2.2.2.2" xref="S4.SS1.p4.2.m2.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.2b"><apply id="S4.SS1.p4.2.m2.2.3.cmml" xref="S4.SS1.p4.2.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p4.2.m2.2.3.1.cmml" xref="S4.SS1.p4.2.m2.2.3">subscript</csymbol><ci id="S4.SS1.p4.2.m2.2.3.2.cmml" xref="S4.SS1.p4.2.m2.2.3.2">bold-italic-ϕ</ci><list id="S4.SS1.p4.2.m2.2.2.2.3.cmml" xref="S4.SS1.p4.2.m2.2.2.2.4"><ci id="S4.SS1.p4.2.m2.1.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1.1">𝑖</ci><ci id="S4.SS1.p4.2.m2.2.2.2.2.cmml" xref="S4.SS1.p4.2.m2.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.2c">\bm{\phi}_{i,c}</annotation></semantics></math> of the <math id="S4.SS1.p4.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p4.3.m3.1a"><mi id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><ci id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">i</annotation></semantics></math>-th client, the
<span id="S4.SS1.p4.6.1" class="ltx_text ltx_font_italic">positive features</span> and <span id="S4.SS1.p4.6.2" class="ltx_text ltx_font_italic">negative features</span> denote the features from the <math id="S4.SS1.p4.4.m4.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p4.4.m4.1a"><mi id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><ci id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">c</annotation></semantics></math>-th class and other classes, respectively. The one-step update of <math id="S4.SS1.p4.5.m5.2" class="ltx_Math" alttext="\bm{\phi}_{i,c}" display="inline"><semantics id="S4.SS1.p4.5.m5.2a"><msub id="S4.SS1.p4.5.m5.2.3" xref="S4.SS1.p4.5.m5.2.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p4.5.m5.2.3.2" xref="S4.SS1.p4.5.m5.2.3.2.cmml">ϕ</mi><mrow id="S4.SS1.p4.5.m5.2.2.2.4" xref="S4.SS1.p4.5.m5.2.2.2.3.cmml"><mi id="S4.SS1.p4.5.m5.1.1.1.1" xref="S4.SS1.p4.5.m5.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p4.5.m5.2.2.2.4.1" xref="S4.SS1.p4.5.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p4.5.m5.2.2.2.2" xref="S4.SS1.p4.5.m5.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.2b"><apply id="S4.SS1.p4.5.m5.2.3.cmml" xref="S4.SS1.p4.5.m5.2.3"><csymbol cd="ambiguous" id="S4.SS1.p4.5.m5.2.3.1.cmml" xref="S4.SS1.p4.5.m5.2.3">subscript</csymbol><ci id="S4.SS1.p4.5.m5.2.3.2.cmml" xref="S4.SS1.p4.5.m5.2.3.2">bold-italic-ϕ</ci><list id="S4.SS1.p4.5.m5.2.2.2.3.cmml" xref="S4.SS1.p4.5.m5.2.2.2.4"><ci id="S4.SS1.p4.5.m5.1.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1.1">𝑖</ci><ci id="S4.SS1.p4.5.m5.2.2.2.2.cmml" xref="S4.SS1.p4.5.m5.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.2c">\bm{\phi}_{i,c}</annotation></semantics></math> with the learning rate <math id="S4.SS1.p4.6.m6.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.SS1.p4.6.m6.1a"><mi id="S4.SS1.p4.6.m6.1.1" xref="S4.SS1.p4.6.m6.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.6.m6.1b"><ci id="S4.SS1.p4.6.m6.1.1.cmml" xref="S4.SS1.p4.6.m6.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.6.m6.1c">\eta</annotation></semantics></math> can be computed as:</p>
<table id="S4.E13" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E13X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E13X.2.1.1.m1.12" class="ltx_Math" alttext="\displaystyle\Delta\bm{\phi}_{i,c}=\underbrace{\frac{\eta}{n_{i}}\sum_{j=1,y_{j}=c}^{n_{i}}\left(1-q_{j,c}\right)\mathbf{h}_{j}}_{\text{pulling by {positive features}}}-\underbrace{\frac{\eta}{n_{i}}\sum_{j=1,y_{j}\neq c}^{n_{i}}q_{j,c}\mathbf{h}_{j}}_{\text{pushing by {negative features}}}." display="inline"><semantics id="S4.E13X.2.1.1.m1.12a"><mrow id="S4.E13X.2.1.1.m1.12.12.1" xref="S4.E13X.2.1.1.m1.12.12.1.1.cmml"><mrow id="S4.E13X.2.1.1.m1.12.12.1.1" xref="S4.E13X.2.1.1.m1.12.12.1.1.cmml"><mrow id="S4.E13X.2.1.1.m1.12.12.1.1.2" xref="S4.E13X.2.1.1.m1.12.12.1.1.2.cmml"><mi mathvariant="normal" id="S4.E13X.2.1.1.m1.12.12.1.1.2.2" xref="S4.E13X.2.1.1.m1.12.12.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E13X.2.1.1.m1.12.12.1.1.2.1" xref="S4.E13X.2.1.1.m1.12.12.1.1.2.1.cmml">​</mo><msub id="S4.E13X.2.1.1.m1.12.12.1.1.2.3" xref="S4.E13X.2.1.1.m1.12.12.1.1.2.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E13X.2.1.1.m1.12.12.1.1.2.3.2" xref="S4.E13X.2.1.1.m1.12.12.1.1.2.3.2.cmml">ϕ</mi><mrow id="S4.E13X.2.1.1.m1.2.2.2.4" xref="S4.E13X.2.1.1.m1.2.2.2.3.cmml"><mi id="S4.E13X.2.1.1.m1.1.1.1.1" xref="S4.E13X.2.1.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.E13X.2.1.1.m1.2.2.2.4.1" xref="S4.E13X.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.E13X.2.1.1.m1.2.2.2.2" xref="S4.E13X.2.1.1.m1.2.2.2.2.cmml">c</mi></mrow></msub></mrow><mo id="S4.E13X.2.1.1.m1.12.12.1.1.1" xref="S4.E13X.2.1.1.m1.12.12.1.1.1.cmml">=</mo><mrow id="S4.E13X.2.1.1.m1.12.12.1.1.3" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.cmml"><munder id="S4.E13X.2.1.1.m1.12.12.1.1.3.2" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.2.cmml"><munder accentunder="true" id="S4.E13X.2.1.1.m1.7.7" xref="S4.E13X.2.1.1.m1.7.7.cmml"><mrow id="S4.E13X.2.1.1.m1.7.7.5" xref="S4.E13X.2.1.1.m1.7.7.5.cmml"><mstyle displaystyle="true" id="S4.E13X.2.1.1.m1.7.7.5.7" xref="S4.E13X.2.1.1.m1.7.7.5.7.cmml"><mfrac id="S4.E13X.2.1.1.m1.7.7.5.7a" xref="S4.E13X.2.1.1.m1.7.7.5.7.cmml"><mi id="S4.E13X.2.1.1.m1.7.7.5.7.2" xref="S4.E13X.2.1.1.m1.7.7.5.7.2.cmml">η</mi><msub id="S4.E13X.2.1.1.m1.7.7.5.7.3" xref="S4.E13X.2.1.1.m1.7.7.5.7.3.cmml"><mi id="S4.E13X.2.1.1.m1.7.7.5.7.3.2" xref="S4.E13X.2.1.1.m1.7.7.5.7.3.2.cmml">n</mi><mi id="S4.E13X.2.1.1.m1.7.7.5.7.3.3" xref="S4.E13X.2.1.1.m1.7.7.5.7.3.3.cmml">i</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E13X.2.1.1.m1.7.7.5.6" xref="S4.E13X.2.1.1.m1.7.7.5.6.cmml">​</mo><mrow id="S4.E13X.2.1.1.m1.7.7.5.5" xref="S4.E13X.2.1.1.m1.7.7.5.5.cmml"><mstyle displaystyle="true" id="S4.E13X.2.1.1.m1.7.7.5.5.2" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.cmml"><munderover id="S4.E13X.2.1.1.m1.7.7.5.5.2a" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.cmml"><mo movablelimits="false" id="S4.E13X.2.1.1.m1.7.7.5.5.2.2.2" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.2.2.cmml">∑</mo><mrow id="S4.E13X.2.1.1.m1.4.4.2.2.2.2" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.3.cmml"><mrow id="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1" xref="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.2" xref="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">j</mi><mo id="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.1.cmml">=</mo><mn id="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.3" xref="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.3" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.3a.cmml">,</mo><mrow id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.cmml"><msub id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.cmml"><mi id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.2" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.3" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.1" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.1.cmml">=</mo><mi id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.3" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.3.cmml">c</mi></mrow></mrow><msub id="S4.E13X.2.1.1.m1.7.7.5.5.2.3" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.3.cmml"><mi id="S4.E13X.2.1.1.m1.7.7.5.5.2.3.2" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.3.2.cmml">n</mi><mi id="S4.E13X.2.1.1.m1.7.7.5.5.2.3.3" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.3.3.cmml">i</mi></msub></munderover></mstyle><mrow id="S4.E13X.2.1.1.m1.7.7.5.5.1" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.cmml"><mrow id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.cmml"><mo id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.2" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.cmml">(</mo><mrow id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.cmml"><mn id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.2" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.2.cmml">1</mn><mo id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.1" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.1.cmml">−</mo><msub id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.3" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.3.cmml"><mi id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.3.2" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.3.2.cmml">q</mi><mrow id="S4.E13X.2.1.1.m1.6.6.4.4.2.4" xref="S4.E13X.2.1.1.m1.6.6.4.4.2.3.cmml"><mi id="S4.E13X.2.1.1.m1.5.5.3.3.1.1" xref="S4.E13X.2.1.1.m1.5.5.3.3.1.1.cmml">j</mi><mo id="S4.E13X.2.1.1.m1.6.6.4.4.2.4.1" xref="S4.E13X.2.1.1.m1.6.6.4.4.2.3.cmml">,</mo><mi id="S4.E13X.2.1.1.m1.6.6.4.4.2.2" xref="S4.E13X.2.1.1.m1.6.6.4.4.2.2.cmml">c</mi></mrow></msub></mrow><mo id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.3" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E13X.2.1.1.m1.7.7.5.5.1.2" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.2.cmml">​</mo><msub id="S4.E13X.2.1.1.m1.7.7.5.5.1.3" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.3.cmml"><mi id="S4.E13X.2.1.1.m1.7.7.5.5.1.3.2" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.3.2.cmml">𝐡</mi><mi id="S4.E13X.2.1.1.m1.7.7.5.5.1.3.3" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.3.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S4.E13X.2.1.1.m1.7.7.6" xref="S4.E13X.2.1.1.m1.7.7.6.cmml">⏟</mo></munder><mrow id="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2c.cmml"><mtext id="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2a" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2c.cmml">pulling by </mtext><mtext class="ltx_mathvariant_italic" id="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2b" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2c.cmml">positive features</mtext></mrow></munder><mo id="S4.E13X.2.1.1.m1.12.12.1.1.3.1" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.1.cmml">−</mo><munder id="S4.E13X.2.1.1.m1.12.12.1.1.3.3" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.3.cmml"><munder accentunder="true" id="S4.E13X.2.1.1.m1.11.11" xref="S4.E13X.2.1.1.m1.11.11.cmml"><mrow id="S4.E13X.2.1.1.m1.11.11.4" xref="S4.E13X.2.1.1.m1.11.11.4.cmml"><mstyle displaystyle="true" id="S4.E13X.2.1.1.m1.11.11.4.6" xref="S4.E13X.2.1.1.m1.11.11.4.6.cmml"><mfrac id="S4.E13X.2.1.1.m1.11.11.4.6a" xref="S4.E13X.2.1.1.m1.11.11.4.6.cmml"><mi id="S4.E13X.2.1.1.m1.11.11.4.6.2" xref="S4.E13X.2.1.1.m1.11.11.4.6.2.cmml">η</mi><msub id="S4.E13X.2.1.1.m1.11.11.4.6.3" xref="S4.E13X.2.1.1.m1.11.11.4.6.3.cmml"><mi id="S4.E13X.2.1.1.m1.11.11.4.6.3.2" xref="S4.E13X.2.1.1.m1.11.11.4.6.3.2.cmml">n</mi><mi id="S4.E13X.2.1.1.m1.11.11.4.6.3.3" xref="S4.E13X.2.1.1.m1.11.11.4.6.3.3.cmml">i</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E13X.2.1.1.m1.11.11.4.5" xref="S4.E13X.2.1.1.m1.11.11.4.5.cmml">​</mo><mrow id="S4.E13X.2.1.1.m1.11.11.4.7" xref="S4.E13X.2.1.1.m1.11.11.4.7.cmml"><mstyle displaystyle="true" id="S4.E13X.2.1.1.m1.11.11.4.7.1" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.cmml"><munderover id="S4.E13X.2.1.1.m1.11.11.4.7.1a" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.cmml"><mo movablelimits="false" id="S4.E13X.2.1.1.m1.11.11.4.7.1.2.2" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.2.2.cmml">∑</mo><mrow id="S4.E13X.2.1.1.m1.9.9.2.2.2.2" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.3.cmml"><mrow id="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1" xref="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.cmml"><mi id="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.2" xref="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.2.cmml">j</mi><mo id="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.1" xref="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.1.cmml">=</mo><mn id="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.3" xref="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.3" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.3a.cmml">,</mo><mrow id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.cmml"><msub id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.cmml"><mi id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.2" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.3" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.3.cmml">j</mi></msub><mo id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.1" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.1.cmml">≠</mo><mi id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.3" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.3.cmml">c</mi></mrow></mrow><msub id="S4.E13X.2.1.1.m1.11.11.4.7.1.3" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.3.cmml"><mi id="S4.E13X.2.1.1.m1.11.11.4.7.1.3.2" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.3.2.cmml">n</mi><mi id="S4.E13X.2.1.1.m1.11.11.4.7.1.3.3" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.3.3.cmml">i</mi></msub></munderover></mstyle><mrow id="S4.E13X.2.1.1.m1.11.11.4.7.2" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.cmml"><msub id="S4.E13X.2.1.1.m1.11.11.4.7.2.2" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.2.cmml"><mi id="S4.E13X.2.1.1.m1.11.11.4.7.2.2.2" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.2.2.cmml">q</mi><mrow id="S4.E13X.2.1.1.m1.11.11.4.4.2.4" xref="S4.E13X.2.1.1.m1.11.11.4.4.2.3.cmml"><mi id="S4.E13X.2.1.1.m1.10.10.3.3.1.1" xref="S4.E13X.2.1.1.m1.10.10.3.3.1.1.cmml">j</mi><mo id="S4.E13X.2.1.1.m1.11.11.4.4.2.4.1" xref="S4.E13X.2.1.1.m1.11.11.4.4.2.3.cmml">,</mo><mi id="S4.E13X.2.1.1.m1.11.11.4.4.2.2" xref="S4.E13X.2.1.1.m1.11.11.4.4.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E13X.2.1.1.m1.11.11.4.7.2.1" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.1.cmml">​</mo><msub id="S4.E13X.2.1.1.m1.11.11.4.7.2.3" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.3.cmml"><mi id="S4.E13X.2.1.1.m1.11.11.4.7.2.3.2" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.3.2.cmml">𝐡</mi><mi id="S4.E13X.2.1.1.m1.11.11.4.7.2.3.3" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.3.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S4.E13X.2.1.1.m1.11.11.5" xref="S4.E13X.2.1.1.m1.11.11.5.cmml">⏟</mo></munder><mrow id="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2c.cmml"><mtext id="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2a" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2c.cmml">pushing by </mtext><mtext class="ltx_mathvariant_italic" id="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2b" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2c.cmml">negative features</mtext></mrow></munder></mrow></mrow><mo lspace="0em" id="S4.E13X.2.1.1.m1.12.12.1.2" xref="S4.E13X.2.1.1.m1.12.12.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13X.2.1.1.m1.12b"><apply id="S4.E13X.2.1.1.m1.12.12.1.1.cmml" xref="S4.E13X.2.1.1.m1.12.12.1"><eq id="S4.E13X.2.1.1.m1.12.12.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.1"></eq><apply id="S4.E13X.2.1.1.m1.12.12.1.1.2.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.2"><times id="S4.E13X.2.1.1.m1.12.12.1.1.2.1.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.2.1"></times><ci id="S4.E13X.2.1.1.m1.12.12.1.1.2.2.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.2.2">Δ</ci><apply id="S4.E13X.2.1.1.m1.12.12.1.1.2.3.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.2.3"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.12.12.1.1.2.3.1.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.2.3">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.12.12.1.1.2.3.2.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.2.3.2">bold-italic-ϕ</ci><list id="S4.E13X.2.1.1.m1.2.2.2.3.cmml" xref="S4.E13X.2.1.1.m1.2.2.2.4"><ci id="S4.E13X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.1.1.1.1">𝑖</ci><ci id="S4.E13X.2.1.1.m1.2.2.2.2.cmml" xref="S4.E13X.2.1.1.m1.2.2.2.2">𝑐</ci></list></apply></apply><apply id="S4.E13X.2.1.1.m1.12.12.1.1.3.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3"><minus id="S4.E13X.2.1.1.m1.12.12.1.1.3.1.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.1"></minus><apply id="S4.E13X.2.1.1.m1.12.12.1.1.3.2.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.2"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.12.12.1.1.3.2.1.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.2">subscript</csymbol><apply id="S4.E13X.2.1.1.m1.7.7.cmml" xref="S4.E13X.2.1.1.m1.7.7"><ci id="S4.E13X.2.1.1.m1.7.7.6.cmml" xref="S4.E13X.2.1.1.m1.7.7.6">⏟</ci><apply id="S4.E13X.2.1.1.m1.7.7.5.cmml" xref="S4.E13X.2.1.1.m1.7.7.5"><times id="S4.E13X.2.1.1.m1.7.7.5.6.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.6"></times><apply id="S4.E13X.2.1.1.m1.7.7.5.7.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.7"><divide id="S4.E13X.2.1.1.m1.7.7.5.7.1.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.7"></divide><ci id="S4.E13X.2.1.1.m1.7.7.5.7.2.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.7.2">𝜂</ci><apply id="S4.E13X.2.1.1.m1.7.7.5.7.3.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.7.3"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.7.7.5.7.3.1.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.7.3">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.7.7.5.7.3.2.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.7.3.2">𝑛</ci><ci id="S4.E13X.2.1.1.m1.7.7.5.7.3.3.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.7.3.3">𝑖</ci></apply></apply><apply id="S4.E13X.2.1.1.m1.7.7.5.5.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5"><apply id="S4.E13X.2.1.1.m1.7.7.5.5.2.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.2"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.7.7.5.5.2.1.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.2">superscript</csymbol><apply id="S4.E13X.2.1.1.m1.7.7.5.5.2.2.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.2"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.7.7.5.5.2.2.1.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.2">subscript</csymbol><sum id="S4.E13X.2.1.1.m1.7.7.5.5.2.2.2.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.2.2"></sum><apply id="S4.E13X.2.1.1.m1.4.4.2.2.2.3.cmml" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.4.4.2.2.2.3a.cmml" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1"><eq id="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.1"></eq><ci id="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.2">𝑗</ci><cn type="integer" id="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E13X.2.1.1.m1.3.3.1.1.1.1.1.3">1</cn></apply><apply id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.cmml" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2"><eq id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.1.cmml" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.1"></eq><apply id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.cmml" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.1.cmml" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.3.cmml" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.3.cmml" xref="S4.E13X.2.1.1.m1.4.4.2.2.2.2.2.3">𝑐</ci></apply></apply></apply><apply id="S4.E13X.2.1.1.m1.7.7.5.5.2.3.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.3"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.7.7.5.5.2.3.1.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.3">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.7.7.5.5.2.3.2.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.3.2">𝑛</ci><ci id="S4.E13X.2.1.1.m1.7.7.5.5.2.3.3.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.2.3.3">𝑖</ci></apply></apply><apply id="S4.E13X.2.1.1.m1.7.7.5.5.1.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1"><times id="S4.E13X.2.1.1.m1.7.7.5.5.1.2.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.2"></times><apply id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1"><minus id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.1"></minus><cn type="integer" id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.2.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.2">1</cn><apply id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.3.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.3.1.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.3">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.3.2.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.1.1.1.3.2">𝑞</ci><list id="S4.E13X.2.1.1.m1.6.6.4.4.2.3.cmml" xref="S4.E13X.2.1.1.m1.6.6.4.4.2.4"><ci id="S4.E13X.2.1.1.m1.5.5.3.3.1.1.cmml" xref="S4.E13X.2.1.1.m1.5.5.3.3.1.1">𝑗</ci><ci id="S4.E13X.2.1.1.m1.6.6.4.4.2.2.cmml" xref="S4.E13X.2.1.1.m1.6.6.4.4.2.2">𝑐</ci></list></apply></apply><apply id="S4.E13X.2.1.1.m1.7.7.5.5.1.3.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.3"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.7.7.5.5.1.3.1.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.3">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.7.7.5.5.1.3.2.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.3.2">𝐡</ci><ci id="S4.E13X.2.1.1.m1.7.7.5.5.1.3.3.cmml" xref="S4.E13X.2.1.1.m1.7.7.5.5.1.3.3">𝑗</ci></apply></apply></apply></apply></apply><ci id="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2c.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2"><mrow id="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2"><mtext mathsize="70%" id="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2a.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2">pulling by </mtext><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2b.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.2.2">positive features</mtext></mrow></ci></apply><apply id="S4.E13X.2.1.1.m1.12.12.1.1.3.3.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.3"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.12.12.1.1.3.3.1.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.3">subscript</csymbol><apply id="S4.E13X.2.1.1.m1.11.11.cmml" xref="S4.E13X.2.1.1.m1.11.11"><ci id="S4.E13X.2.1.1.m1.11.11.5.cmml" xref="S4.E13X.2.1.1.m1.11.11.5">⏟</ci><apply id="S4.E13X.2.1.1.m1.11.11.4.cmml" xref="S4.E13X.2.1.1.m1.11.11.4"><times id="S4.E13X.2.1.1.m1.11.11.4.5.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.5"></times><apply id="S4.E13X.2.1.1.m1.11.11.4.6.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.6"><divide id="S4.E13X.2.1.1.m1.11.11.4.6.1.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.6"></divide><ci id="S4.E13X.2.1.1.m1.11.11.4.6.2.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.6.2">𝜂</ci><apply id="S4.E13X.2.1.1.m1.11.11.4.6.3.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.6.3"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.11.11.4.6.3.1.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.6.3">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.11.11.4.6.3.2.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.6.3.2">𝑛</ci><ci id="S4.E13X.2.1.1.m1.11.11.4.6.3.3.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.6.3.3">𝑖</ci></apply></apply><apply id="S4.E13X.2.1.1.m1.11.11.4.7.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7"><apply id="S4.E13X.2.1.1.m1.11.11.4.7.1.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.1"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.11.11.4.7.1.1.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.1">superscript</csymbol><apply id="S4.E13X.2.1.1.m1.11.11.4.7.1.2.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.1"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.11.11.4.7.1.2.1.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.1">subscript</csymbol><sum id="S4.E13X.2.1.1.m1.11.11.4.7.1.2.2.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.2.2"></sum><apply id="S4.E13X.2.1.1.m1.9.9.2.2.2.3.cmml" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.9.9.2.2.2.3a.cmml" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1"><eq id="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.1.cmml" xref="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.1"></eq><ci id="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.2.cmml" xref="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.2">𝑗</ci><cn type="integer" id="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.3.cmml" xref="S4.E13X.2.1.1.m1.8.8.1.1.1.1.1.3">1</cn></apply><apply id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.cmml" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2"><neq id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.1.cmml" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.1"></neq><apply id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.cmml" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.1.cmml" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.2.cmml" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.3.cmml" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.2.3">𝑗</ci></apply><ci id="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.3.cmml" xref="S4.E13X.2.1.1.m1.9.9.2.2.2.2.2.3">𝑐</ci></apply></apply></apply><apply id="S4.E13X.2.1.1.m1.11.11.4.7.1.3.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.3"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.11.11.4.7.1.3.1.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.3">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.11.11.4.7.1.3.2.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.3.2">𝑛</ci><ci id="S4.E13X.2.1.1.m1.11.11.4.7.1.3.3.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.1.3.3">𝑖</ci></apply></apply><apply id="S4.E13X.2.1.1.m1.11.11.4.7.2.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.2"><times id="S4.E13X.2.1.1.m1.11.11.4.7.2.1.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.1"></times><apply id="S4.E13X.2.1.1.m1.11.11.4.7.2.2.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.2"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.11.11.4.7.2.2.1.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.2">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.11.11.4.7.2.2.2.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.2.2">𝑞</ci><list id="S4.E13X.2.1.1.m1.11.11.4.4.2.3.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.4.2.4"><ci id="S4.E13X.2.1.1.m1.10.10.3.3.1.1.cmml" xref="S4.E13X.2.1.1.m1.10.10.3.3.1.1">𝑗</ci><ci id="S4.E13X.2.1.1.m1.11.11.4.4.2.2.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.4.2.2">𝑐</ci></list></apply><apply id="S4.E13X.2.1.1.m1.11.11.4.7.2.3.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.3"><csymbol cd="ambiguous" id="S4.E13X.2.1.1.m1.11.11.4.7.2.3.1.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.3">subscript</csymbol><ci id="S4.E13X.2.1.1.m1.11.11.4.7.2.3.2.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.3.2">𝐡</ci><ci id="S4.E13X.2.1.1.m1.11.11.4.7.2.3.3.cmml" xref="S4.E13X.2.1.1.m1.11.11.4.7.2.3.3">𝑗</ci></apply></apply></apply></apply></apply><ci id="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2c.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2"><mrow id="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2"><mtext mathsize="70%" id="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2a.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2">pushing by </mtext><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2b.cmml" xref="S4.E13X.2.1.1.m1.12.12.1.1.3.3.2">negative features</mtext></mrow></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13X.2.1.1.m1.12c">\displaystyle\Delta\bm{\phi}_{i,c}=\underbrace{\frac{\eta}{n_{i}}\sum_{j=1,y_{j}=c}^{n_{i}}\left(1-q_{j,c}\right)\mathbf{h}_{j}}_{\text{pulling by {positive features}}}-\underbrace{\frac{\eta}{n_{i}}\sum_{j=1,y_{j}\neq c}^{n_{i}}q_{j,c}\mathbf{h}_{j}}_{\text{pushing by {negative features}}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(13)</span></td>
</tr>
</tbody>
</table>
<p id="S4.SS1.p4.14" class="ltx_p">For class <math id="S4.SS1.p4.7.m1.1" class="ltx_Math" alttext="c\in\{\mathcal{Y}\setminus\mathcal{Y}_{i}\}" display="inline"><semantics id="S4.SS1.p4.7.m1.1a"><mrow id="S4.SS1.p4.7.m1.1.1" xref="S4.SS1.p4.7.m1.1.1.cmml"><mi id="S4.SS1.p4.7.m1.1.1.3" xref="S4.SS1.p4.7.m1.1.1.3.cmml">c</mi><mo id="S4.SS1.p4.7.m1.1.1.2" xref="S4.SS1.p4.7.m1.1.1.2.cmml">∈</mo><mrow id="S4.SS1.p4.7.m1.1.1.1.1" xref="S4.SS1.p4.7.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p4.7.m1.1.1.1.1.2" xref="S4.SS1.p4.7.m1.1.1.1.2.cmml">{</mo><mrow id="S4.SS1.p4.7.m1.1.1.1.1.1" xref="S4.SS1.p4.7.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.7.m1.1.1.1.1.1.2" xref="S4.SS1.p4.7.m1.1.1.1.1.1.2.cmml">𝒴</mi><mo id="S4.SS1.p4.7.m1.1.1.1.1.1.1" xref="S4.SS1.p4.7.m1.1.1.1.1.1.1.cmml">∖</mo><msub id="S4.SS1.p4.7.m1.1.1.1.1.1.3" xref="S4.SS1.p4.7.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.7.m1.1.1.1.1.1.3.2" xref="S4.SS1.p4.7.m1.1.1.1.1.1.3.2.cmml">𝒴</mi><mi id="S4.SS1.p4.7.m1.1.1.1.1.1.3.3" xref="S4.SS1.p4.7.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S4.SS1.p4.7.m1.1.1.1.1.3" xref="S4.SS1.p4.7.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.7.m1.1b"><apply id="S4.SS1.p4.7.m1.1.1.cmml" xref="S4.SS1.p4.7.m1.1.1"><in id="S4.SS1.p4.7.m1.1.1.2.cmml" xref="S4.SS1.p4.7.m1.1.1.2"></in><ci id="S4.SS1.p4.7.m1.1.1.3.cmml" xref="S4.SS1.p4.7.m1.1.1.3">𝑐</ci><set id="S4.SS1.p4.7.m1.1.1.1.2.cmml" xref="S4.SS1.p4.7.m1.1.1.1.1"><apply id="S4.SS1.p4.7.m1.1.1.1.1.1.cmml" xref="S4.SS1.p4.7.m1.1.1.1.1.1"><setdiff id="S4.SS1.p4.7.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.7.m1.1.1.1.1.1.1"></setdiff><ci id="S4.SS1.p4.7.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p4.7.m1.1.1.1.1.1.2">𝒴</ci><apply id="S4.SS1.p4.7.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.7.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p4.7.m1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p4.7.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p4.7.m1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p4.7.m1.1.1.1.1.1.3.2">𝒴</ci><ci id="S4.SS1.p4.7.m1.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p4.7.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.7.m1.1c">c\in\{\mathcal{Y}\setminus\mathcal{Y}_{i}\}</annotation></semantics></math>, there is no update of <math id="S4.SS1.p4.8.m2.2" class="ltx_Math" alttext="\bm{\phi}_{i,c}" display="inline"><semantics id="S4.SS1.p4.8.m2.2a"><msub id="S4.SS1.p4.8.m2.2.3" xref="S4.SS1.p4.8.m2.2.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p4.8.m2.2.3.2" xref="S4.SS1.p4.8.m2.2.3.2.cmml">ϕ</mi><mrow id="S4.SS1.p4.8.m2.2.2.2.4" xref="S4.SS1.p4.8.m2.2.2.2.3.cmml"><mi id="S4.SS1.p4.8.m2.1.1.1.1" xref="S4.SS1.p4.8.m2.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p4.8.m2.2.2.2.4.1" xref="S4.SS1.p4.8.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p4.8.m2.2.2.2.2" xref="S4.SS1.p4.8.m2.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.8.m2.2b"><apply id="S4.SS1.p4.8.m2.2.3.cmml" xref="S4.SS1.p4.8.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p4.8.m2.2.3.1.cmml" xref="S4.SS1.p4.8.m2.2.3">subscript</csymbol><ci id="S4.SS1.p4.8.m2.2.3.2.cmml" xref="S4.SS1.p4.8.m2.2.3.2">bold-italic-ϕ</ci><list id="S4.SS1.p4.8.m2.2.2.2.3.cmml" xref="S4.SS1.p4.8.m2.2.2.2.4"><ci id="S4.SS1.p4.8.m2.1.1.1.1.cmml" xref="S4.SS1.p4.8.m2.1.1.1.1">𝑖</ci><ci id="S4.SS1.p4.8.m2.2.2.2.2.cmml" xref="S4.SS1.p4.8.m2.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.8.m2.2c">\bm{\phi}_{i,c}</annotation></semantics></math> under the original balanced-softmax scheme since the client does not hold any sample of class <math id="S4.SS1.p4.9.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p4.9.m3.1a"><mi id="S4.SS1.p4.9.m3.1.1" xref="S4.SS1.p4.9.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.9.m3.1b"><ci id="S4.SS1.p4.9.m3.1.1.cmml" xref="S4.SS1.p4.9.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.9.m3.1c">c</annotation></semantics></math> and thus <math id="S4.SS1.p4.10.m4.1" class="ltx_Math" alttext="p_{i}(c)=0" display="inline"><semantics id="S4.SS1.p4.10.m4.1a"><mrow id="S4.SS1.p4.10.m4.1.2" xref="S4.SS1.p4.10.m4.1.2.cmml"><mrow id="S4.SS1.p4.10.m4.1.2.2" xref="S4.SS1.p4.10.m4.1.2.2.cmml"><msub id="S4.SS1.p4.10.m4.1.2.2.2" xref="S4.SS1.p4.10.m4.1.2.2.2.cmml"><mi id="S4.SS1.p4.10.m4.1.2.2.2.2" xref="S4.SS1.p4.10.m4.1.2.2.2.2.cmml">p</mi><mi id="S4.SS1.p4.10.m4.1.2.2.2.3" xref="S4.SS1.p4.10.m4.1.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p4.10.m4.1.2.2.1" xref="S4.SS1.p4.10.m4.1.2.2.1.cmml">​</mo><mrow id="S4.SS1.p4.10.m4.1.2.2.3.2" xref="S4.SS1.p4.10.m4.1.2.2.cmml"><mo stretchy="false" id="S4.SS1.p4.10.m4.1.2.2.3.2.1" xref="S4.SS1.p4.10.m4.1.2.2.cmml">(</mo><mi id="S4.SS1.p4.10.m4.1.1" xref="S4.SS1.p4.10.m4.1.1.cmml">c</mi><mo stretchy="false" id="S4.SS1.p4.10.m4.1.2.2.3.2.2" xref="S4.SS1.p4.10.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p4.10.m4.1.2.1" xref="S4.SS1.p4.10.m4.1.2.1.cmml">=</mo><mn id="S4.SS1.p4.10.m4.1.2.3" xref="S4.SS1.p4.10.m4.1.2.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.10.m4.1b"><apply id="S4.SS1.p4.10.m4.1.2.cmml" xref="S4.SS1.p4.10.m4.1.2"><eq id="S4.SS1.p4.10.m4.1.2.1.cmml" xref="S4.SS1.p4.10.m4.1.2.1"></eq><apply id="S4.SS1.p4.10.m4.1.2.2.cmml" xref="S4.SS1.p4.10.m4.1.2.2"><times id="S4.SS1.p4.10.m4.1.2.2.1.cmml" xref="S4.SS1.p4.10.m4.1.2.2.1"></times><apply id="S4.SS1.p4.10.m4.1.2.2.2.cmml" xref="S4.SS1.p4.10.m4.1.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p4.10.m4.1.2.2.2.1.cmml" xref="S4.SS1.p4.10.m4.1.2.2.2">subscript</csymbol><ci id="S4.SS1.p4.10.m4.1.2.2.2.2.cmml" xref="S4.SS1.p4.10.m4.1.2.2.2.2">𝑝</ci><ci id="S4.SS1.p4.10.m4.1.2.2.2.3.cmml" xref="S4.SS1.p4.10.m4.1.2.2.2.3">𝑖</ci></apply><ci id="S4.SS1.p4.10.m4.1.1.cmml" xref="S4.SS1.p4.10.m4.1.1">𝑐</ci></apply><cn type="integer" id="S4.SS1.p4.10.m4.1.2.3.cmml" xref="S4.SS1.p4.10.m4.1.2.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.10.m4.1c">p_{i}(c)=0</annotation></semantics></math>. Therefore, not only there is no pulling force from positive features but also no pushing force from negative features exists due to <math id="S4.SS1.p4.11.m5.3" class="ltx_Math" alttext="q_{j,c}\propto p_{i}(c)" display="inline"><semantics id="S4.SS1.p4.11.m5.3a"><mrow id="S4.SS1.p4.11.m5.3.4" xref="S4.SS1.p4.11.m5.3.4.cmml"><msub id="S4.SS1.p4.11.m5.3.4.2" xref="S4.SS1.p4.11.m5.3.4.2.cmml"><mi id="S4.SS1.p4.11.m5.3.4.2.2" xref="S4.SS1.p4.11.m5.3.4.2.2.cmml">q</mi><mrow id="S4.SS1.p4.11.m5.2.2.2.4" xref="S4.SS1.p4.11.m5.2.2.2.3.cmml"><mi id="S4.SS1.p4.11.m5.1.1.1.1" xref="S4.SS1.p4.11.m5.1.1.1.1.cmml">j</mi><mo id="S4.SS1.p4.11.m5.2.2.2.4.1" xref="S4.SS1.p4.11.m5.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p4.11.m5.2.2.2.2" xref="S4.SS1.p4.11.m5.2.2.2.2.cmml">c</mi></mrow></msub><mo id="S4.SS1.p4.11.m5.3.4.1" xref="S4.SS1.p4.11.m5.3.4.1.cmml">∝</mo><mrow id="S4.SS1.p4.11.m5.3.4.3" xref="S4.SS1.p4.11.m5.3.4.3.cmml"><msub id="S4.SS1.p4.11.m5.3.4.3.2" xref="S4.SS1.p4.11.m5.3.4.3.2.cmml"><mi id="S4.SS1.p4.11.m5.3.4.3.2.2" xref="S4.SS1.p4.11.m5.3.4.3.2.2.cmml">p</mi><mi id="S4.SS1.p4.11.m5.3.4.3.2.3" xref="S4.SS1.p4.11.m5.3.4.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p4.11.m5.3.4.3.1" xref="S4.SS1.p4.11.m5.3.4.3.1.cmml">​</mo><mrow id="S4.SS1.p4.11.m5.3.4.3.3.2" xref="S4.SS1.p4.11.m5.3.4.3.cmml"><mo stretchy="false" id="S4.SS1.p4.11.m5.3.4.3.3.2.1" xref="S4.SS1.p4.11.m5.3.4.3.cmml">(</mo><mi id="S4.SS1.p4.11.m5.3.3" xref="S4.SS1.p4.11.m5.3.3.cmml">c</mi><mo stretchy="false" id="S4.SS1.p4.11.m5.3.4.3.3.2.2" xref="S4.SS1.p4.11.m5.3.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.11.m5.3b"><apply id="S4.SS1.p4.11.m5.3.4.cmml" xref="S4.SS1.p4.11.m5.3.4"><csymbol cd="latexml" id="S4.SS1.p4.11.m5.3.4.1.cmml" xref="S4.SS1.p4.11.m5.3.4.1">proportional-to</csymbol><apply id="S4.SS1.p4.11.m5.3.4.2.cmml" xref="S4.SS1.p4.11.m5.3.4.2"><csymbol cd="ambiguous" id="S4.SS1.p4.11.m5.3.4.2.1.cmml" xref="S4.SS1.p4.11.m5.3.4.2">subscript</csymbol><ci id="S4.SS1.p4.11.m5.3.4.2.2.cmml" xref="S4.SS1.p4.11.m5.3.4.2.2">𝑞</ci><list id="S4.SS1.p4.11.m5.2.2.2.3.cmml" xref="S4.SS1.p4.11.m5.2.2.2.4"><ci id="S4.SS1.p4.11.m5.1.1.1.1.cmml" xref="S4.SS1.p4.11.m5.1.1.1.1">𝑗</ci><ci id="S4.SS1.p4.11.m5.2.2.2.2.cmml" xref="S4.SS1.p4.11.m5.2.2.2.2">𝑐</ci></list></apply><apply id="S4.SS1.p4.11.m5.3.4.3.cmml" xref="S4.SS1.p4.11.m5.3.4.3"><times id="S4.SS1.p4.11.m5.3.4.3.1.cmml" xref="S4.SS1.p4.11.m5.3.4.3.1"></times><apply id="S4.SS1.p4.11.m5.3.4.3.2.cmml" xref="S4.SS1.p4.11.m5.3.4.3.2"><csymbol cd="ambiguous" id="S4.SS1.p4.11.m5.3.4.3.2.1.cmml" xref="S4.SS1.p4.11.m5.3.4.3.2">subscript</csymbol><ci id="S4.SS1.p4.11.m5.3.4.3.2.2.cmml" xref="S4.SS1.p4.11.m5.3.4.3.2.2">𝑝</ci><ci id="S4.SS1.p4.11.m5.3.4.3.2.3.cmml" xref="S4.SS1.p4.11.m5.3.4.3.2.3">𝑖</ci></apply><ci id="S4.SS1.p4.11.m5.3.3.cmml" xref="S4.SS1.p4.11.m5.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.11.m5.3c">q_{j,c}\propto p_{i}(c)</annotation></semantics></math>. Under the scheme of vanilla softmax, the <math id="S4.SS1.p4.12.m6.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p4.12.m6.1a"><mi id="S4.SS1.p4.12.m6.1.1" xref="S4.SS1.p4.12.m6.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.12.m6.1b"><ci id="S4.SS1.p4.12.m6.1.1.cmml" xref="S4.SS1.p4.12.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.12.m6.1c">c</annotation></semantics></math>-th proxy is only pushed away from negative features without any restriction from positive features and will result in inaccurate updating (catastrophic forgetting). By contrast, our relaxed version of balanced-softmax sets the prior of any missing class <math id="S4.SS1.p4.13.m7.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p4.13.m7.1a"><mi id="S4.SS1.p4.13.m7.1.1" xref="S4.SS1.p4.13.m7.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.13.m7.1b"><ci id="S4.SS1.p4.13.m7.1.1.cmml" xref="S4.SS1.p4.13.m7.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.13.m7.1c">c</annotation></semantics></math> a small value and thus restricts the pushing force from negative features, striking a balance between the staleness and inaccurate updating of the <math id="S4.SS1.p4.14.m8.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p4.14.m8.1a"><mi id="S4.SS1.p4.14.m8.1.1" xref="S4.SS1.p4.14.m8.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.14.m8.1b"><ci id="S4.SS1.p4.14.m8.1.1.cmml" xref="S4.SS1.p4.14.m8.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.14.m8.1c">c</annotation></semantics></math>-th proxy.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.1" class="ltx_p">Secondly, the balanced classifier could mitigate inaccurate feature updating. Similarly, the update of <math id="S4.SS1.p5.1.m1.1" class="ltx_Math" alttext="\mathbf{h}_{j}" display="inline"><semantics id="S4.SS1.p5.1.m1.1a"><msub id="S4.SS1.p5.1.m1.1.1" xref="S4.SS1.p5.1.m1.1.1.cmml"><mi id="S4.SS1.p5.1.m1.1.1.2" xref="S4.SS1.p5.1.m1.1.1.2.cmml">𝐡</mi><mi id="S4.SS1.p5.1.m1.1.1.3" xref="S4.SS1.p5.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.1.m1.1b"><apply id="S4.SS1.p5.1.m1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p5.1.m1.1.1.1.cmml" xref="S4.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.p5.1.m1.1.1.2.cmml" xref="S4.SS1.p5.1.m1.1.1.2">𝐡</ci><ci id="S4.SS1.p5.1.m1.1.1.3.cmml" xref="S4.SS1.p5.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.1.m1.1c">\mathbf{h}_{j}</annotation></semantics></math> is represented by:</p>
<table id="S4.E14" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E14X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E14X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\Delta\mathbf{h}_{j}" display="inline"><semantics id="S4.E14X.2.1.1.m1.1a"><mrow id="S4.E14X.2.1.1.m1.1.1" xref="S4.E14X.2.1.1.m1.1.1.cmml"><mi mathvariant="normal" id="S4.E14X.2.1.1.m1.1.1.2" xref="S4.E14X.2.1.1.m1.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E14X.2.1.1.m1.1.1.1" xref="S4.E14X.2.1.1.m1.1.1.1.cmml">​</mo><msub id="S4.E14X.2.1.1.m1.1.1.3" xref="S4.E14X.2.1.1.m1.1.1.3.cmml"><mi id="S4.E14X.2.1.1.m1.1.1.3.2" xref="S4.E14X.2.1.1.m1.1.1.3.2.cmml">𝐡</mi><mi id="S4.E14X.2.1.1.m1.1.1.3.3" xref="S4.E14X.2.1.1.m1.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.E14X.2.1.1.m1.1b"><apply id="S4.E14X.2.1.1.m1.1.1.cmml" xref="S4.E14X.2.1.1.m1.1.1"><times id="S4.E14X.2.1.1.m1.1.1.1.cmml" xref="S4.E14X.2.1.1.m1.1.1.1"></times><ci id="S4.E14X.2.1.1.m1.1.1.2.cmml" xref="S4.E14X.2.1.1.m1.1.1.2">Δ</ci><apply id="S4.E14X.2.1.1.m1.1.1.3.cmml" xref="S4.E14X.2.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E14X.2.1.1.m1.1.1.3.1.cmml" xref="S4.E14X.2.1.1.m1.1.1.3">subscript</csymbol><ci id="S4.E14X.2.1.1.m1.1.1.3.2.cmml" xref="S4.E14X.2.1.1.m1.1.1.3.2">𝐡</ci><ci id="S4.E14X.2.1.1.m1.1.1.3.3.cmml" xref="S4.E14X.2.1.1.m1.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14X.2.1.1.m1.1c">\displaystyle\Delta\mathbf{h}_{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E14X.3.2.2.m1.11" class="ltx_Math" alttext="\displaystyle=\underbrace{\frac{\eta}{n_{i}}\left(1-q_{j,y_{j}}\right)\mathbf{\bm{\phi}}_{i,y_{j}}}_{\text{pulling by {positive proxy} }}-\frac{\eta}{n_{i}}\underbrace{\sum_{c\in\mathcal{Y}_{i},c\neq y_{j}}q_{j,c}\mathbf{\bm{\phi}}_{i,c}}_{\text{pushing by {negative proxies (I)}}}" display="inline"><semantics id="S4.E14X.3.2.2.m1.11a"><mrow id="S4.E14X.3.2.2.m1.11.12" xref="S4.E14X.3.2.2.m1.11.12.cmml"><mi id="S4.E14X.3.2.2.m1.11.12.2" xref="S4.E14X.3.2.2.m1.11.12.2.cmml"></mi><mo id="S4.E14X.3.2.2.m1.11.12.1" xref="S4.E14X.3.2.2.m1.11.12.1.cmml">=</mo><mrow id="S4.E14X.3.2.2.m1.11.12.3" xref="S4.E14X.3.2.2.m1.11.12.3.cmml"><munder id="S4.E14X.3.2.2.m1.11.12.3.2" xref="S4.E14X.3.2.2.m1.11.12.3.2.cmml"><munder accentunder="true" id="S4.E14X.3.2.2.m1.5.5" xref="S4.E14X.3.2.2.m1.5.5.cmml"><mrow id="S4.E14X.3.2.2.m1.5.5.5" xref="S4.E14X.3.2.2.m1.5.5.5.cmml"><mstyle displaystyle="true" id="S4.E14X.3.2.2.m1.5.5.5.7" xref="S4.E14X.3.2.2.m1.5.5.5.7.cmml"><mfrac id="S4.E14X.3.2.2.m1.5.5.5.7a" xref="S4.E14X.3.2.2.m1.5.5.5.7.cmml"><mi id="S4.E14X.3.2.2.m1.5.5.5.7.2" xref="S4.E14X.3.2.2.m1.5.5.5.7.2.cmml">η</mi><msub id="S4.E14X.3.2.2.m1.5.5.5.7.3" xref="S4.E14X.3.2.2.m1.5.5.5.7.3.cmml"><mi id="S4.E14X.3.2.2.m1.5.5.5.7.3.2" xref="S4.E14X.3.2.2.m1.5.5.5.7.3.2.cmml">n</mi><mi id="S4.E14X.3.2.2.m1.5.5.5.7.3.3" xref="S4.E14X.3.2.2.m1.5.5.5.7.3.3.cmml">i</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E14X.3.2.2.m1.5.5.5.6" xref="S4.E14X.3.2.2.m1.5.5.5.6.cmml">​</mo><mrow id="S4.E14X.3.2.2.m1.5.5.5.5.1" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.cmml"><mo id="S4.E14X.3.2.2.m1.5.5.5.5.1.2" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.cmml">(</mo><mrow id="S4.E14X.3.2.2.m1.5.5.5.5.1.1" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.cmml"><mn id="S4.E14X.3.2.2.m1.5.5.5.5.1.1.2" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.2.cmml">1</mn><mo id="S4.E14X.3.2.2.m1.5.5.5.5.1.1.1" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.1.cmml">−</mo><msub id="S4.E14X.3.2.2.m1.5.5.5.5.1.1.3" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.3.cmml"><mi id="S4.E14X.3.2.2.m1.5.5.5.5.1.1.3.2" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.3.2.cmml">q</mi><mrow id="S4.E14X.3.2.2.m1.2.2.2.2.2.2" xref="S4.E14X.3.2.2.m1.2.2.2.2.2.3.cmml"><mi id="S4.E14X.3.2.2.m1.1.1.1.1.1.1" xref="S4.E14X.3.2.2.m1.1.1.1.1.1.1.cmml">j</mi><mo id="S4.E14X.3.2.2.m1.2.2.2.2.2.2.2" xref="S4.E14X.3.2.2.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1" xref="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.cmml"><mi id="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.2" xref="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.2.cmml">y</mi><mi id="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.3" xref="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.3.cmml">j</mi></msub></mrow></msub></mrow><mo id="S4.E14X.3.2.2.m1.5.5.5.5.1.3" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E14X.3.2.2.m1.5.5.5.6a" xref="S4.E14X.3.2.2.m1.5.5.5.6.cmml">​</mo><msub id="S4.E14X.3.2.2.m1.5.5.5.8" xref="S4.E14X.3.2.2.m1.5.5.5.8.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E14X.3.2.2.m1.5.5.5.8.2" xref="S4.E14X.3.2.2.m1.5.5.5.8.2.cmml">ϕ</mi><mrow id="S4.E14X.3.2.2.m1.4.4.4.4.2.2" xref="S4.E14X.3.2.2.m1.4.4.4.4.2.3.cmml"><mi id="S4.E14X.3.2.2.m1.3.3.3.3.1.1" xref="S4.E14X.3.2.2.m1.3.3.3.3.1.1.cmml">i</mi><mo id="S4.E14X.3.2.2.m1.4.4.4.4.2.2.2" xref="S4.E14X.3.2.2.m1.4.4.4.4.2.3.cmml">,</mo><msub id="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1" xref="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.cmml"><mi id="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.2" xref="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.2.cmml">y</mi><mi id="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.3" xref="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.3.cmml">j</mi></msub></mrow></msub></mrow><mo id="S4.E14X.3.2.2.m1.5.5.6" xref="S4.E14X.3.2.2.m1.5.5.6.cmml">⏟</mo></munder><mrow id="S4.E14X.3.2.2.m1.11.12.3.2.2" xref="S4.E14X.3.2.2.m1.11.12.3.2.2d.cmml"><mtext id="S4.E14X.3.2.2.m1.11.12.3.2.2a" xref="S4.E14X.3.2.2.m1.11.12.3.2.2d.cmml">pulling by </mtext><mtext class="ltx_mathvariant_italic" id="S4.E14X.3.2.2.m1.11.12.3.2.2b" xref="S4.E14X.3.2.2.m1.11.12.3.2.2d.cmml">positive proxy</mtext><mtext id="S4.E14X.3.2.2.m1.11.12.3.2.2c" xref="S4.E14X.3.2.2.m1.11.12.3.2.2d.cmml"> </mtext></mrow></munder><mo id="S4.E14X.3.2.2.m1.11.12.3.1" xref="S4.E14X.3.2.2.m1.11.12.3.1.cmml">−</mo><mrow id="S4.E14X.3.2.2.m1.11.12.3.3" xref="S4.E14X.3.2.2.m1.11.12.3.3.cmml"><mstyle displaystyle="true" id="S4.E14X.3.2.2.m1.11.12.3.3.2" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.cmml"><mfrac id="S4.E14X.3.2.2.m1.11.12.3.3.2a" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.cmml"><mi id="S4.E14X.3.2.2.m1.11.12.3.3.2.2" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.2.cmml">η</mi><msub id="S4.E14X.3.2.2.m1.11.12.3.3.2.3" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.3.cmml"><mi id="S4.E14X.3.2.2.m1.11.12.3.3.2.3.2" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.3.2.cmml">n</mi><mi id="S4.E14X.3.2.2.m1.11.12.3.3.2.3.3" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.3.3.cmml">i</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E14X.3.2.2.m1.11.12.3.3.1" xref="S4.E14X.3.2.2.m1.11.12.3.3.1.cmml">​</mo><munder id="S4.E14X.3.2.2.m1.11.12.3.3.3" xref="S4.E14X.3.2.2.m1.11.12.3.3.3.cmml"><munder accentunder="true" id="S4.E14X.3.2.2.m1.11.11" xref="S4.E14X.3.2.2.m1.11.11.cmml"><mrow id="S4.E14X.3.2.2.m1.11.11.6" xref="S4.E14X.3.2.2.m1.11.11.6.cmml"><mstyle displaystyle="true" id="S4.E14X.3.2.2.m1.11.11.6.7" xref="S4.E14X.3.2.2.m1.11.11.6.7.cmml"><munder id="S4.E14X.3.2.2.m1.11.11.6.7a" xref="S4.E14X.3.2.2.m1.11.11.6.7.cmml"><mo movablelimits="false" id="S4.E14X.3.2.2.m1.11.11.6.7.2" xref="S4.E14X.3.2.2.m1.11.11.6.7.2.cmml">∑</mo><mrow id="S4.E14X.3.2.2.m1.7.7.2.2.2.2" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.3.cmml"><mrow id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.cmml"><mi id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.2" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.2.cmml">c</mi><mo id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.1" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.1.cmml">∈</mo><msub id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.2" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.2.cmml">𝒴</mi><mi id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.3" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.3" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.3a.cmml">,</mo><mrow id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.cmml"><mi id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.2" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.2.cmml">c</mi><mo id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.1" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.1.cmml">≠</mo><msub id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.cmml"><mi id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.2" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.2.cmml">y</mi><mi id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.3" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.3.cmml">j</mi></msub></mrow></mrow></munder></mstyle><mrow id="S4.E14X.3.2.2.m1.11.11.6.8" xref="S4.E14X.3.2.2.m1.11.11.6.8.cmml"><msub id="S4.E14X.3.2.2.m1.11.11.6.8.2" xref="S4.E14X.3.2.2.m1.11.11.6.8.2.cmml"><mi id="S4.E14X.3.2.2.m1.11.11.6.8.2.2" xref="S4.E14X.3.2.2.m1.11.11.6.8.2.2.cmml">q</mi><mrow id="S4.E14X.3.2.2.m1.9.9.4.4.2.4" xref="S4.E14X.3.2.2.m1.9.9.4.4.2.3.cmml"><mi id="S4.E14X.3.2.2.m1.8.8.3.3.1.1" xref="S4.E14X.3.2.2.m1.8.8.3.3.1.1.cmml">j</mi><mo id="S4.E14X.3.2.2.m1.9.9.4.4.2.4.1" xref="S4.E14X.3.2.2.m1.9.9.4.4.2.3.cmml">,</mo><mi id="S4.E14X.3.2.2.m1.9.9.4.4.2.2" xref="S4.E14X.3.2.2.m1.9.9.4.4.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E14X.3.2.2.m1.11.11.6.8.1" xref="S4.E14X.3.2.2.m1.11.11.6.8.1.cmml">​</mo><msub id="S4.E14X.3.2.2.m1.11.11.6.8.3" xref="S4.E14X.3.2.2.m1.11.11.6.8.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E14X.3.2.2.m1.11.11.6.8.3.2" xref="S4.E14X.3.2.2.m1.11.11.6.8.3.2.cmml">ϕ</mi><mrow id="S4.E14X.3.2.2.m1.11.11.6.6.2.4" xref="S4.E14X.3.2.2.m1.11.11.6.6.2.3.cmml"><mi id="S4.E14X.3.2.2.m1.10.10.5.5.1.1" xref="S4.E14X.3.2.2.m1.10.10.5.5.1.1.cmml">i</mi><mo id="S4.E14X.3.2.2.m1.11.11.6.6.2.4.1" xref="S4.E14X.3.2.2.m1.11.11.6.6.2.3.cmml">,</mo><mi id="S4.E14X.3.2.2.m1.11.11.6.6.2.2" xref="S4.E14X.3.2.2.m1.11.11.6.6.2.2.cmml">c</mi></mrow></msub></mrow></mrow><mo id="S4.E14X.3.2.2.m1.11.11.7" xref="S4.E14X.3.2.2.m1.11.11.7.cmml">⏟</mo></munder><mrow id="S4.E14X.3.2.2.m1.11.12.3.3.3.2" xref="S4.E14X.3.2.2.m1.11.12.3.3.3.2c.cmml"><mtext id="S4.E14X.3.2.2.m1.11.12.3.3.3.2a" xref="S4.E14X.3.2.2.m1.11.12.3.3.3.2c.cmml">pushing by </mtext><mtext class="ltx_mathvariant_italic" id="S4.E14X.3.2.2.m1.11.12.3.3.3.2b" xref="S4.E14X.3.2.2.m1.11.12.3.3.3.2c.cmml">negative proxies (I)</mtext></mrow></munder></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14X.3.2.2.m1.11b"><apply id="S4.E14X.3.2.2.m1.11.12.cmml" xref="S4.E14X.3.2.2.m1.11.12"><eq id="S4.E14X.3.2.2.m1.11.12.1.cmml" xref="S4.E14X.3.2.2.m1.11.12.1"></eq><csymbol cd="latexml" id="S4.E14X.3.2.2.m1.11.12.2.cmml" xref="S4.E14X.3.2.2.m1.11.12.2">absent</csymbol><apply id="S4.E14X.3.2.2.m1.11.12.3.cmml" xref="S4.E14X.3.2.2.m1.11.12.3"><minus id="S4.E14X.3.2.2.m1.11.12.3.1.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.1"></minus><apply id="S4.E14X.3.2.2.m1.11.12.3.2.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.2"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.11.12.3.2.1.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.2">subscript</csymbol><apply id="S4.E14X.3.2.2.m1.5.5.cmml" xref="S4.E14X.3.2.2.m1.5.5"><ci id="S4.E14X.3.2.2.m1.5.5.6.cmml" xref="S4.E14X.3.2.2.m1.5.5.6">⏟</ci><apply id="S4.E14X.3.2.2.m1.5.5.5.cmml" xref="S4.E14X.3.2.2.m1.5.5.5"><times id="S4.E14X.3.2.2.m1.5.5.5.6.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.6"></times><apply id="S4.E14X.3.2.2.m1.5.5.5.7.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.7"><divide id="S4.E14X.3.2.2.m1.5.5.5.7.1.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.7"></divide><ci id="S4.E14X.3.2.2.m1.5.5.5.7.2.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.7.2">𝜂</ci><apply id="S4.E14X.3.2.2.m1.5.5.5.7.3.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.7.3"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.5.5.5.7.3.1.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.7.3">subscript</csymbol><ci id="S4.E14X.3.2.2.m1.5.5.5.7.3.2.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.7.3.2">𝑛</ci><ci id="S4.E14X.3.2.2.m1.5.5.5.7.3.3.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.7.3.3">𝑖</ci></apply></apply><apply id="S4.E14X.3.2.2.m1.5.5.5.5.1.1.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.5.1"><minus id="S4.E14X.3.2.2.m1.5.5.5.5.1.1.1.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.1"></minus><cn type="integer" id="S4.E14X.3.2.2.m1.5.5.5.5.1.1.2.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.2">1</cn><apply id="S4.E14X.3.2.2.m1.5.5.5.5.1.1.3.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.5.5.5.5.1.1.3.1.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.3">subscript</csymbol><ci id="S4.E14X.3.2.2.m1.5.5.5.5.1.1.3.2.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.5.1.1.3.2">𝑞</ci><list id="S4.E14X.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S4.E14X.3.2.2.m1.2.2.2.2.2.2"><ci id="S4.E14X.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S4.E14X.3.2.2.m1.1.1.1.1.1.1">𝑗</ci><apply id="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.cmml" xref="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1">subscript</csymbol><ci id="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.2">𝑦</ci><ci id="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E14X.3.2.2.m1.2.2.2.2.2.2.1.3">𝑗</ci></apply></list></apply></apply><apply id="S4.E14X.3.2.2.m1.5.5.5.8.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.8"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.5.5.5.8.1.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.8">subscript</csymbol><ci id="S4.E14X.3.2.2.m1.5.5.5.8.2.cmml" xref="S4.E14X.3.2.2.m1.5.5.5.8.2">bold-italic-ϕ</ci><list id="S4.E14X.3.2.2.m1.4.4.4.4.2.3.cmml" xref="S4.E14X.3.2.2.m1.4.4.4.4.2.2"><ci id="S4.E14X.3.2.2.m1.3.3.3.3.1.1.cmml" xref="S4.E14X.3.2.2.m1.3.3.3.3.1.1">𝑖</ci><apply id="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.cmml" xref="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.1.cmml" xref="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1">subscript</csymbol><ci id="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.2.cmml" xref="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.2">𝑦</ci><ci id="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.3.cmml" xref="S4.E14X.3.2.2.m1.4.4.4.4.2.2.1.3">𝑗</ci></apply></list></apply></apply></apply><ci id="S4.E14X.3.2.2.m1.11.12.3.2.2d.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.2.2"><mrow id="S4.E14X.3.2.2.m1.11.12.3.2.2.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.2.2"><mtext mathsize="70%" id="S4.E14X.3.2.2.m1.11.12.3.2.2a.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.2.2">pulling by </mtext><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S4.E14X.3.2.2.m1.11.12.3.2.2b.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.2.2">positive proxy</mtext><mtext mathsize="70%" id="S4.E14X.3.2.2.m1.11.12.3.2.2c.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.2.2"> </mtext></mrow></ci></apply><apply id="S4.E14X.3.2.2.m1.11.12.3.3.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3"><times id="S4.E14X.3.2.2.m1.11.12.3.3.1.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.1"></times><apply id="S4.E14X.3.2.2.m1.11.12.3.3.2.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.2"><divide id="S4.E14X.3.2.2.m1.11.12.3.3.2.1.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.2"></divide><ci id="S4.E14X.3.2.2.m1.11.12.3.3.2.2.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.2">𝜂</ci><apply id="S4.E14X.3.2.2.m1.11.12.3.3.2.3.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.3"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.11.12.3.3.2.3.1.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.3">subscript</csymbol><ci id="S4.E14X.3.2.2.m1.11.12.3.3.2.3.2.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.3.2">𝑛</ci><ci id="S4.E14X.3.2.2.m1.11.12.3.3.2.3.3.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.2.3.3">𝑖</ci></apply></apply><apply id="S4.E14X.3.2.2.m1.11.12.3.3.3.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.3"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.11.12.3.3.3.1.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.3">subscript</csymbol><apply id="S4.E14X.3.2.2.m1.11.11.cmml" xref="S4.E14X.3.2.2.m1.11.11"><ci id="S4.E14X.3.2.2.m1.11.11.7.cmml" xref="S4.E14X.3.2.2.m1.11.11.7">⏟</ci><apply id="S4.E14X.3.2.2.m1.11.11.6.cmml" xref="S4.E14X.3.2.2.m1.11.11.6"><apply id="S4.E14X.3.2.2.m1.11.11.6.7.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.7"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.11.11.6.7.1.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.7">subscript</csymbol><sum id="S4.E14X.3.2.2.m1.11.11.6.7.2.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.7.2"></sum><apply id="S4.E14X.3.2.2.m1.7.7.2.2.2.3.cmml" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.7.7.2.2.2.3a.cmml" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.cmml" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1"><in id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.1.cmml" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.1"></in><ci id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.2.cmml" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.2">𝑐</ci><apply id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.cmml" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.2">𝒴</ci><ci id="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.3.cmml" xref="S4.E14X.3.2.2.m1.6.6.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.cmml" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2"><neq id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.1.cmml" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.1"></neq><ci id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.2.cmml" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.2">𝑐</ci><apply id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.cmml" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.1.cmml" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.2.cmml" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.2">𝑦</ci><ci id="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.3.cmml" xref="S4.E14X.3.2.2.m1.7.7.2.2.2.2.2.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.E14X.3.2.2.m1.11.11.6.8.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.8"><times id="S4.E14X.3.2.2.m1.11.11.6.8.1.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.8.1"></times><apply id="S4.E14X.3.2.2.m1.11.11.6.8.2.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.8.2"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.11.11.6.8.2.1.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.8.2">subscript</csymbol><ci id="S4.E14X.3.2.2.m1.11.11.6.8.2.2.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.8.2.2">𝑞</ci><list id="S4.E14X.3.2.2.m1.9.9.4.4.2.3.cmml" xref="S4.E14X.3.2.2.m1.9.9.4.4.2.4"><ci id="S4.E14X.3.2.2.m1.8.8.3.3.1.1.cmml" xref="S4.E14X.3.2.2.m1.8.8.3.3.1.1">𝑗</ci><ci id="S4.E14X.3.2.2.m1.9.9.4.4.2.2.cmml" xref="S4.E14X.3.2.2.m1.9.9.4.4.2.2">𝑐</ci></list></apply><apply id="S4.E14X.3.2.2.m1.11.11.6.8.3.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.8.3"><csymbol cd="ambiguous" id="S4.E14X.3.2.2.m1.11.11.6.8.3.1.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.8.3">subscript</csymbol><ci id="S4.E14X.3.2.2.m1.11.11.6.8.3.2.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.8.3.2">bold-italic-ϕ</ci><list id="S4.E14X.3.2.2.m1.11.11.6.6.2.3.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.6.2.4"><ci id="S4.E14X.3.2.2.m1.10.10.5.5.1.1.cmml" xref="S4.E14X.3.2.2.m1.10.10.5.5.1.1">𝑖</ci><ci id="S4.E14X.3.2.2.m1.11.11.6.6.2.2.cmml" xref="S4.E14X.3.2.2.m1.11.11.6.6.2.2">𝑐</ci></list></apply></apply></apply></apply><ci id="S4.E14X.3.2.2.m1.11.12.3.3.3.2c.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.3.2"><mrow id="S4.E14X.3.2.2.m1.11.12.3.3.3.2.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.3.2"><mtext mathsize="70%" id="S4.E14X.3.2.2.m1.11.12.3.3.3.2a.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.3.2">pushing by </mtext><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S4.E14X.3.2.2.m1.11.12.3.3.3.2b.cmml" xref="S4.E14X.3.2.2.m1.11.12.3.3.3.2">negative proxies (I)</mtext></mrow></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14X.3.2.2.m1.11c">\displaystyle=\underbrace{\frac{\eta}{n_{i}}\left(1-q_{j,y_{j}}\right)\mathbf{\bm{\phi}}_{i,y_{j}}}_{\text{pulling by {positive proxy} }}-\frac{\eta}{n_{i}}\underbrace{\sum_{c\in\mathcal{Y}_{i},c\neq y_{j}}q_{j,c}\mathbf{\bm{\phi}}_{i,c}}_{\text{pushing by {negative proxies (I)}}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(14)</span></td>
</tr>
<tr id="S4.E14Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E14Xa.2.1.1.m1.7" class="ltx_Math" alttext="\displaystyle-\frac{\eta}{n_{i}}\underbrace{\sum_{c\in{\mathcal{Y}\setminus\mathcal{Y}_{i}},c\neq y_{j}}q_{j,c}\mathbf{\bm{\phi}}_{i,c}}_{\text{pushing by {negative proxies (II)}}}." display="inline"><semantics id="S4.E14Xa.2.1.1.m1.7a"><mrow id="S4.E14Xa.2.1.1.m1.7.7.1" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.cmml"><mrow id="S4.E14Xa.2.1.1.m1.7.7.1.1" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.cmml"><mo id="S4.E14Xa.2.1.1.m1.7.7.1.1a" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.cmml">−</mo><mrow id="S4.E14Xa.2.1.1.m1.7.7.1.1.2" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.cmml"><mstyle displaystyle="true" id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.cmml"><mfrac id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2a" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.cmml"><mi id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.2" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.2.cmml">η</mi><msub id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.cmml"><mi id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.2" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.2.cmml">n</mi><mi id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.3" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.3.cmml">i</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.1" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.1.cmml">​</mo><munder id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.cmml"><munder accentunder="true" id="S4.E14Xa.2.1.1.m1.6.6" xref="S4.E14Xa.2.1.1.m1.6.6.cmml"><mrow id="S4.E14Xa.2.1.1.m1.6.6.6" xref="S4.E14Xa.2.1.1.m1.6.6.6.cmml"><mstyle displaystyle="true" id="S4.E14Xa.2.1.1.m1.6.6.6.7" xref="S4.E14Xa.2.1.1.m1.6.6.6.7.cmml"><munder id="S4.E14Xa.2.1.1.m1.6.6.6.7a" xref="S4.E14Xa.2.1.1.m1.6.6.6.7.cmml"><mo movablelimits="false" id="S4.E14Xa.2.1.1.m1.6.6.6.7.2" xref="S4.E14Xa.2.1.1.m1.6.6.6.7.2.cmml">∑</mo><mrow id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.3.cmml"><mrow id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml">c</mi><mo id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">∈</mo><mrow id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">𝒴</mi><mo id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml">∖</mo><msub id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.2" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml">𝒴</mi><mi id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.3" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.3a.cmml">,</mo><mrow id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.cmml"><mi id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.2" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.2.cmml">c</mi><mo id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.1" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.1.cmml">≠</mo><msub id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.2" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.2.cmml">y</mi><mi id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.3" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.3.cmml">j</mi></msub></mrow></mrow></munder></mstyle><mrow id="S4.E14Xa.2.1.1.m1.6.6.6.8" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.cmml"><msub id="S4.E14Xa.2.1.1.m1.6.6.6.8.2" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.2.cmml"><mi id="S4.E14Xa.2.1.1.m1.6.6.6.8.2.2" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.2.2.cmml">q</mi><mrow id="S4.E14Xa.2.1.1.m1.4.4.4.4.2.4" xref="S4.E14Xa.2.1.1.m1.4.4.4.4.2.3.cmml"><mi id="S4.E14Xa.2.1.1.m1.3.3.3.3.1.1" xref="S4.E14Xa.2.1.1.m1.3.3.3.3.1.1.cmml">j</mi><mo id="S4.E14Xa.2.1.1.m1.4.4.4.4.2.4.1" xref="S4.E14Xa.2.1.1.m1.4.4.4.4.2.3.cmml">,</mo><mi id="S4.E14Xa.2.1.1.m1.4.4.4.4.2.2" xref="S4.E14Xa.2.1.1.m1.4.4.4.4.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E14Xa.2.1.1.m1.6.6.6.8.1" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.1.cmml">​</mo><msub id="S4.E14Xa.2.1.1.m1.6.6.6.8.3" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E14Xa.2.1.1.m1.6.6.6.8.3.2" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.3.2.cmml">ϕ</mi><mrow id="S4.E14Xa.2.1.1.m1.6.6.6.6.2.4" xref="S4.E14Xa.2.1.1.m1.6.6.6.6.2.3.cmml"><mi id="S4.E14Xa.2.1.1.m1.5.5.5.5.1.1" xref="S4.E14Xa.2.1.1.m1.5.5.5.5.1.1.cmml">i</mi><mo id="S4.E14Xa.2.1.1.m1.6.6.6.6.2.4.1" xref="S4.E14Xa.2.1.1.m1.6.6.6.6.2.3.cmml">,</mo><mi id="S4.E14Xa.2.1.1.m1.6.6.6.6.2.2" xref="S4.E14Xa.2.1.1.m1.6.6.6.6.2.2.cmml">c</mi></mrow></msub></mrow></mrow><mo id="S4.E14Xa.2.1.1.m1.6.6.7" xref="S4.E14Xa.2.1.1.m1.6.6.7.cmml">⏟</mo></munder><mrow id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2c.cmml"><mtext id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2a" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2c.cmml">pushing by </mtext><mtext class="ltx_mathvariant_italic" id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2b" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2c.cmml">negative proxies (II)</mtext></mrow></munder></mrow></mrow><mo lspace="0em" id="S4.E14Xa.2.1.1.m1.7.7.1.2" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14Xa.2.1.1.m1.7b"><apply id="S4.E14Xa.2.1.1.m1.7.7.1.1.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1"><minus id="S4.E14Xa.2.1.1.m1.7.7.1.1.1.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1"></minus><apply id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2"><times id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.1.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.1"></times><apply id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2"><divide id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.1.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2"></divide><ci id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.2.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.2">𝜂</ci><apply id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.1.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3">subscript</csymbol><ci id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.2.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.2">𝑛</ci><ci id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.3.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3"><csymbol cd="ambiguous" id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.1.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3">subscript</csymbol><apply id="S4.E14Xa.2.1.1.m1.6.6.cmml" xref="S4.E14Xa.2.1.1.m1.6.6"><ci id="S4.E14Xa.2.1.1.m1.6.6.7.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.7">⏟</ci><apply id="S4.E14Xa.2.1.1.m1.6.6.6.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6"><apply id="S4.E14Xa.2.1.1.m1.6.6.6.7.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.7"><csymbol cd="ambiguous" id="S4.E14Xa.2.1.1.m1.6.6.6.7.1.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.7">subscript</csymbol><sum id="S4.E14Xa.2.1.1.m1.6.6.6.7.2.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.7.2"></sum><apply id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.3.cmml" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.3a.cmml" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1"><in id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.1"></in><ci id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.2">𝑐</ci><apply id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3"><setdiff id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.1"></setdiff><ci id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.2">𝒴</ci><apply id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.2">𝒴</ci><ci id="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E14Xa.2.1.1.m1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2"><neq id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.1"></neq><ci id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.2">𝑐</ci><apply id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.2">𝑦</ci><ci id="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S4.E14Xa.2.1.1.m1.2.2.2.2.2.2.2.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.E14Xa.2.1.1.m1.6.6.6.8.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.8"><times id="S4.E14Xa.2.1.1.m1.6.6.6.8.1.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.1"></times><apply id="S4.E14Xa.2.1.1.m1.6.6.6.8.2.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.2"><csymbol cd="ambiguous" id="S4.E14Xa.2.1.1.m1.6.6.6.8.2.1.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.2">subscript</csymbol><ci id="S4.E14Xa.2.1.1.m1.6.6.6.8.2.2.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.2.2">𝑞</ci><list id="S4.E14Xa.2.1.1.m1.4.4.4.4.2.3.cmml" xref="S4.E14Xa.2.1.1.m1.4.4.4.4.2.4"><ci id="S4.E14Xa.2.1.1.m1.3.3.3.3.1.1.cmml" xref="S4.E14Xa.2.1.1.m1.3.3.3.3.1.1">𝑗</ci><ci id="S4.E14Xa.2.1.1.m1.4.4.4.4.2.2.cmml" xref="S4.E14Xa.2.1.1.m1.4.4.4.4.2.2">𝑐</ci></list></apply><apply id="S4.E14Xa.2.1.1.m1.6.6.6.8.3.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.3"><csymbol cd="ambiguous" id="S4.E14Xa.2.1.1.m1.6.6.6.8.3.1.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.3">subscript</csymbol><ci id="S4.E14Xa.2.1.1.m1.6.6.6.8.3.2.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.8.3.2">bold-italic-ϕ</ci><list id="S4.E14Xa.2.1.1.m1.6.6.6.6.2.3.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.6.2.4"><ci id="S4.E14Xa.2.1.1.m1.5.5.5.5.1.1.cmml" xref="S4.E14Xa.2.1.1.m1.5.5.5.5.1.1">𝑖</ci><ci id="S4.E14Xa.2.1.1.m1.6.6.6.6.2.2.cmml" xref="S4.E14Xa.2.1.1.m1.6.6.6.6.2.2">𝑐</ci></list></apply></apply></apply></apply><ci id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2c.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2"><mrow id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2"><mtext mathsize="70%" id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2a.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2">pushing by </mtext><mtext class="ltx_mathvariant_italic" mathsize="70%" id="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2b.cmml" xref="S4.E14Xa.2.1.1.m1.7.7.1.1.2.3.2">negative proxies (II)</mtext></mrow></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14Xa.2.1.1.m1.7c">\displaystyle-\frac{\eta}{n_{i}}\underbrace{\sum_{c\in{\mathcal{Y}\setminus\mathcal{Y}_{i}},c\neq y_{j}}q_{j,c}\mathbf{\bm{\phi}}_{i,c}}_{\text{pushing by {negative proxies (II)}}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS1.p5.5" class="ltx_p">Similar to the above analysis of proxy updates, the pushing force from any missing class <math id="S4.SS1.p5.2.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS1.p5.2.m1.1a"><mi id="S4.SS1.p5.2.m1.1.1" xref="S4.SS1.p5.2.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.2.m1.1b"><ci id="S4.SS1.p5.2.m1.1.1.cmml" xref="S4.SS1.p5.2.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.2.m1.1c">c</annotation></semantics></math> for updating feature embedding, i.e., the third term in Eq. (<a href="#S4.E14" title="In 4.1 Relaxed Balanced-SoftMax Classifier ‣ 4 Our Proposed Framework ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">14</span></a>), would disappear under both the vanilla softmax and balanced-softmax schemes, leading to inaccurate updates. Specifically, the balanced-softmax directly sets <math id="S4.SS1.p5.3.m2.2" class="ltx_Math" alttext="q_{j,c}" display="inline"><semantics id="S4.SS1.p5.3.m2.2a"><msub id="S4.SS1.p5.3.m2.2.3" xref="S4.SS1.p5.3.m2.2.3.cmml"><mi id="S4.SS1.p5.3.m2.2.3.2" xref="S4.SS1.p5.3.m2.2.3.2.cmml">q</mi><mrow id="S4.SS1.p5.3.m2.2.2.2.4" xref="S4.SS1.p5.3.m2.2.2.2.3.cmml"><mi id="S4.SS1.p5.3.m2.1.1.1.1" xref="S4.SS1.p5.3.m2.1.1.1.1.cmml">j</mi><mo id="S4.SS1.p5.3.m2.2.2.2.4.1" xref="S4.SS1.p5.3.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p5.3.m2.2.2.2.2" xref="S4.SS1.p5.3.m2.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.3.m2.2b"><apply id="S4.SS1.p5.3.m2.2.3.cmml" xref="S4.SS1.p5.3.m2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p5.3.m2.2.3.1.cmml" xref="S4.SS1.p5.3.m2.2.3">subscript</csymbol><ci id="S4.SS1.p5.3.m2.2.3.2.cmml" xref="S4.SS1.p5.3.m2.2.3.2">𝑞</ci><list id="S4.SS1.p5.3.m2.2.2.2.3.cmml" xref="S4.SS1.p5.3.m2.2.2.2.4"><ci id="S4.SS1.p5.3.m2.1.1.1.1.cmml" xref="S4.SS1.p5.3.m2.1.1.1.1">𝑗</ci><ci id="S4.SS1.p5.3.m2.2.2.2.2.cmml" xref="S4.SS1.p5.3.m2.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.3.m2.2c">q_{j,c}</annotation></semantics></math> to zero while the vanilla softmax would result in significantly inaccurate proxy <math id="S4.SS1.p5.4.m3.2" class="ltx_Math" alttext="\mathbf{\bm{\phi}}_{i,c}" display="inline"><semantics id="S4.SS1.p5.4.m3.2a"><msub id="S4.SS1.p5.4.m3.2.3" xref="S4.SS1.p5.4.m3.2.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.SS1.p5.4.m3.2.3.2" xref="S4.SS1.p5.4.m3.2.3.2.cmml">ϕ</mi><mrow id="S4.SS1.p5.4.m3.2.2.2.4" xref="S4.SS1.p5.4.m3.2.2.2.3.cmml"><mi id="S4.SS1.p5.4.m3.1.1.1.1" xref="S4.SS1.p5.4.m3.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p5.4.m3.2.2.2.4.1" xref="S4.SS1.p5.4.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p5.4.m3.2.2.2.2" xref="S4.SS1.p5.4.m3.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.4.m3.2b"><apply id="S4.SS1.p5.4.m3.2.3.cmml" xref="S4.SS1.p5.4.m3.2.3"><csymbol cd="ambiguous" id="S4.SS1.p5.4.m3.2.3.1.cmml" xref="S4.SS1.p5.4.m3.2.3">subscript</csymbol><ci id="S4.SS1.p5.4.m3.2.3.2.cmml" xref="S4.SS1.p5.4.m3.2.3.2">bold-italic-ϕ</ci><list id="S4.SS1.p5.4.m3.2.2.2.3.cmml" xref="S4.SS1.p5.4.m3.2.2.2.4"><ci id="S4.SS1.p5.4.m3.1.1.1.1.cmml" xref="S4.SS1.p5.4.m3.1.1.1.1">𝑖</ci><ci id="S4.SS1.p5.4.m3.2.2.2.2.cmml" xref="S4.SS1.p5.4.m3.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.4.m3.2c">\mathbf{\bm{\phi}}_{i,c}</annotation></semantics></math> as local training going on and finally the <math id="S4.SS1.p5.5.m4.2" class="ltx_Math" alttext="q_{j,c}" display="inline"><semantics id="S4.SS1.p5.5.m4.2a"><msub id="S4.SS1.p5.5.m4.2.3" xref="S4.SS1.p5.5.m4.2.3.cmml"><mi id="S4.SS1.p5.5.m4.2.3.2" xref="S4.SS1.p5.5.m4.2.3.2.cmml">q</mi><mrow id="S4.SS1.p5.5.m4.2.2.2.4" xref="S4.SS1.p5.5.m4.2.2.2.3.cmml"><mi id="S4.SS1.p5.5.m4.1.1.1.1" xref="S4.SS1.p5.5.m4.1.1.1.1.cmml">j</mi><mo id="S4.SS1.p5.5.m4.2.2.2.4.1" xref="S4.SS1.p5.5.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p5.5.m4.2.2.2.2" xref="S4.SS1.p5.5.m4.2.2.2.2.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p5.5.m4.2b"><apply id="S4.SS1.p5.5.m4.2.3.cmml" xref="S4.SS1.p5.5.m4.2.3"><csymbol cd="ambiguous" id="S4.SS1.p5.5.m4.2.3.1.cmml" xref="S4.SS1.p5.5.m4.2.3">subscript</csymbol><ci id="S4.SS1.p5.5.m4.2.3.2.cmml" xref="S4.SS1.p5.5.m4.2.3.2">𝑞</ci><list id="S4.SS1.p5.5.m4.2.2.2.3.cmml" xref="S4.SS1.p5.5.m4.2.2.2.4"><ci id="S4.SS1.p5.5.m4.1.1.1.1.cmml" xref="S4.SS1.p5.5.m4.1.1.1.1">𝑗</ci><ci id="S4.SS1.p5.5.m4.2.2.2.2.cmml" xref="S4.SS1.p5.5.m4.2.2.2.2">𝑐</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p5.5.m4.2c">q_{j,c}</annotation></semantics></math> would also be extremely small.</p>
</div>
<div id="S4.SS1.p6" class="ltx_para">
<p id="S4.SS1.p6.1" class="ltx_p">Finally, as the feature and classifier learning are highly coupled during the local training, mitigating the inaccurate updating of them can benefit each other and thus alleviate the performance degradation of federated learning with label skew.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span><span id="S4.SS2.1.1" class="ltx_text ltx_font_italic">Feature Augmentation for Missing Classes</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">Although the balanced-softmax can mitigate the impact of missing classes to an extent, the absence of training samples from those classes is still an issue remaining unsolved. One possible way is to generate synthetic data as augmented training samples. However, generating high-quality samples might be not practical in the resource constrained IoT scenarios as the training of generative model will involve high computation and communication costs. To remedy this, we propose to use a lightweight inter-class feature transfer approach to perform the feature augmentation for missing classes, aiming at training a classifier with better generalization ability.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.8" class="ltx_p">Following the previous work in imbalanced learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>, we assume that the feature <math id="S4.SS2.p2.1.m1.2" class="ltx_Math" alttext="{\bf{h}}_{i,k}" display="inline"><semantics id="S4.SS2.p2.1.m1.2a"><msub id="S4.SS2.p2.1.m1.2.3" xref="S4.SS2.p2.1.m1.2.3.cmml"><mi id="S4.SS2.p2.1.m1.2.3.2" xref="S4.SS2.p2.1.m1.2.3.2.cmml">𝐡</mi><mrow id="S4.SS2.p2.1.m1.2.2.2.4" xref="S4.SS2.p2.1.m1.2.2.2.3.cmml"><mi id="S4.SS2.p2.1.m1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p2.1.m1.2.2.2.4.1" xref="S4.SS2.p2.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.1.m1.2.2.2.2" xref="S4.SS2.p2.1.m1.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.2b"><apply id="S4.SS2.p2.1.m1.2.3.cmml" xref="S4.SS2.p2.1.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.2.3.1.cmml" xref="S4.SS2.p2.1.m1.2.3">subscript</csymbol><ci id="S4.SS2.p2.1.m1.2.3.2.cmml" xref="S4.SS2.p2.1.m1.2.3.2">𝐡</ci><list id="S4.SS2.p2.1.m1.2.2.2.3.cmml" xref="S4.SS2.p2.1.m1.2.2.2.4"><ci id="S4.SS2.p2.1.m1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1">𝑖</ci><ci id="S4.SS2.p2.1.m1.2.2.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.2c">{\bf{h}}_{i,k}</annotation></semantics></math> from <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">i</annotation></semantics></math>-th class lies in a Gaussian distribution with a class feature center <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="{\bf{p}}_{i}" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><msub id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">𝐩</mi><mi id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">𝐩</ci><ci id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">{\bf{p}}_{i}</annotation></semantics></math>, a.k.a, prototype, and a covariance matrix <math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\bf{\Sigma}_{i}" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><msub id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml"><mi id="S4.SS2.p2.4.m4.1.1.2" xref="S4.SS2.p2.4.m4.1.1.2.cmml">𝚺</mi><mi id="S4.SS2.p2.4.m4.1.1.3" xref="S4.SS2.p2.4.m4.1.1.3.cmml">𝐢</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.1.2.cmml" xref="S4.SS2.p2.4.m4.1.1.2">𝚺</ci><ci id="S4.SS2.p2.4.m4.1.1.3.cmml" xref="S4.SS2.p2.4.m4.1.1.3">𝐢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\bf{\Sigma}_{i}</annotation></semantics></math>. The class-wise feature centers are estimated as an average over all feature vectors from the same class by a neural network as the feature extractor. To transfer the intra-class variance from local available classes to missing classes, we assume the covariance matrices are shared across all classes, i.e., <math id="S4.SS2.p2.5.m5.1" class="ltx_Math" alttext="{\bf{\Sigma}}_{i}\,{=}\,\bf{\Sigma}" display="inline"><semantics id="S4.SS2.p2.5.m5.1a"><mrow id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><msub id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2.2" xref="S4.SS2.p2.5.m5.1.1.2.2.cmml">𝚺</mi><mi id="S4.SS2.p2.5.m5.1.1.2.3" xref="S4.SS2.p2.5.m5.1.1.2.3.cmml">i</mi></msub><mo lspace="0.448em" rspace="0.448em" id="S4.SS2.p2.5.m5.1.1.1" xref="S4.SS2.p2.5.m5.1.1.1.cmml">=</mo><mi id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">𝚺</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><eq id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1.1"></eq><apply id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.2.1.cmml" xref="S4.SS2.p2.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2.2">𝚺</ci><ci id="S4.SS2.p2.5.m5.1.1.2.3.cmml" xref="S4.SS2.p2.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">𝚺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">{\bf{\Sigma}}_{i}\,{=}\,\bf{\Sigma}</annotation></semantics></math>. Theoretically, the augmented feature sample for <math id="S4.SS2.p2.6.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p2.6.m6.1a"><mi id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">i</annotation></semantics></math>-th class could be obtained by sampling a noise vector <math id="S4.SS2.p2.7.m7.2" class="ltx_Math" alttext="\bf{\epsilon}\,{\sim}\,\mathcal{N}({\bf{0}},\bf{\Sigma})" display="inline"><semantics id="S4.SS2.p2.7.m7.2a"><mrow id="S4.SS2.p2.7.m7.2.3" xref="S4.SS2.p2.7.m7.2.3.cmml"><mi id="S4.SS2.p2.7.m7.2.3.2" xref="S4.SS2.p2.7.m7.2.3.2.cmml">ϵ</mi><mo lspace="0.448em" rspace="0.448em" id="S4.SS2.p2.7.m7.2.3.1" xref="S4.SS2.p2.7.m7.2.3.1.cmml">∼</mo><mrow id="S4.SS2.p2.7.m7.2.3.3" xref="S4.SS2.p2.7.m7.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.7.m7.2.3.3.2" xref="S4.SS2.p2.7.m7.2.3.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p2.7.m7.2.3.3.1" xref="S4.SS2.p2.7.m7.2.3.3.1.cmml">​</mo><mrow id="S4.SS2.p2.7.m7.2.3.3.3.2" xref="S4.SS2.p2.7.m7.2.3.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.p2.7.m7.2.3.3.3.2.1" xref="S4.SS2.p2.7.m7.2.3.3.3.1.cmml">(</mo><mn id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">𝟎</mn><mo id="S4.SS2.p2.7.m7.2.3.3.3.2.2" xref="S4.SS2.p2.7.m7.2.3.3.3.1.cmml">,</mo><mi id="S4.SS2.p2.7.m7.2.2" xref="S4.SS2.p2.7.m7.2.2.cmml">𝚺</mi><mo stretchy="false" id="S4.SS2.p2.7.m7.2.3.3.3.2.3" xref="S4.SS2.p2.7.m7.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.2b"><apply id="S4.SS2.p2.7.m7.2.3.cmml" xref="S4.SS2.p2.7.m7.2.3"><csymbol cd="latexml" id="S4.SS2.p2.7.m7.2.3.1.cmml" xref="S4.SS2.p2.7.m7.2.3.1">similar-to</csymbol><ci id="S4.SS2.p2.7.m7.2.3.2.cmml" xref="S4.SS2.p2.7.m7.2.3.2">italic-ϵ</ci><apply id="S4.SS2.p2.7.m7.2.3.3.cmml" xref="S4.SS2.p2.7.m7.2.3.3"><times id="S4.SS2.p2.7.m7.2.3.3.1.cmml" xref="S4.SS2.p2.7.m7.2.3.3.1"></times><ci id="S4.SS2.p2.7.m7.2.3.3.2.cmml" xref="S4.SS2.p2.7.m7.2.3.3.2">𝒩</ci><interval closure="open" id="S4.SS2.p2.7.m7.2.3.3.3.1.cmml" xref="S4.SS2.p2.7.m7.2.3.3.3.2"><cn type="integer" id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">0</cn><ci id="S4.SS2.p2.7.m7.2.2.cmml" xref="S4.SS2.p2.7.m7.2.2">𝚺</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.2c">\bf{\epsilon}\,{\sim}\,\mathcal{N}({\bf{0}},\bf{\Sigma})</annotation></semantics></math> and adding to its center <math id="S4.SS2.p2.8.m8.1" class="ltx_Math" alttext="{\bf{p}}_{i}" display="inline"><semantics id="S4.SS2.p2.8.m8.1a"><msub id="S4.SS2.p2.8.m8.1.1" xref="S4.SS2.p2.8.m8.1.1.cmml"><mi id="S4.SS2.p2.8.m8.1.1.2" xref="S4.SS2.p2.8.m8.1.1.2.cmml">𝐩</mi><mi id="S4.SS2.p2.8.m8.1.1.3" xref="S4.SS2.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.8.m8.1b"><apply id="S4.SS2.p2.8.m8.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.8.m8.1.1.1.cmml" xref="S4.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p2.8.m8.1.1.2.cmml" xref="S4.SS2.p2.8.m8.1.1.2">𝐩</ci><ci id="S4.SS2.p2.8.m8.1.1.3.cmml" xref="S4.SS2.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.8.m8.1c">{\bf{p}}_{i}</annotation></semantics></math>. However, it is hard to accurately estimate the covariance matrix and the direction of noise vector might be too random. Therefore, we directly transfer the intra-class variance evaluated from the samples of available classes to the missing classes by linear translation and scaling.
Specifically, our center-based feature transfer is achieved via:
</p>
<table id="S4.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E15.m1.5" class="ltx_Math" alttext="\tilde{\bf{h}}_{j,k}={\bf{p}}_{j}+\lambda({\bf{h}}_{i,k}-{\bf{p}}_{i})," display="block"><semantics id="S4.E15.m1.5a"><mrow id="S4.E15.m1.5.5.1" xref="S4.E15.m1.5.5.1.1.cmml"><mrow id="S4.E15.m1.5.5.1.1" xref="S4.E15.m1.5.5.1.1.cmml"><msub id="S4.E15.m1.5.5.1.1.3" xref="S4.E15.m1.5.5.1.1.3.cmml"><mover accent="true" id="S4.E15.m1.5.5.1.1.3.2" xref="S4.E15.m1.5.5.1.1.3.2.cmml"><mi id="S4.E15.m1.5.5.1.1.3.2.2" xref="S4.E15.m1.5.5.1.1.3.2.2.cmml">𝐡</mi><mo id="S4.E15.m1.5.5.1.1.3.2.1" xref="S4.E15.m1.5.5.1.1.3.2.1.cmml">~</mo></mover><mrow id="S4.E15.m1.2.2.2.4" xref="S4.E15.m1.2.2.2.3.cmml"><mi id="S4.E15.m1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.cmml">j</mi><mo id="S4.E15.m1.2.2.2.4.1" xref="S4.E15.m1.2.2.2.3.cmml">,</mo><mi id="S4.E15.m1.2.2.2.2" xref="S4.E15.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S4.E15.m1.5.5.1.1.2" xref="S4.E15.m1.5.5.1.1.2.cmml">=</mo><mrow id="S4.E15.m1.5.5.1.1.1" xref="S4.E15.m1.5.5.1.1.1.cmml"><msub id="S4.E15.m1.5.5.1.1.1.3" xref="S4.E15.m1.5.5.1.1.1.3.cmml"><mi id="S4.E15.m1.5.5.1.1.1.3.2" xref="S4.E15.m1.5.5.1.1.1.3.2.cmml">𝐩</mi><mi id="S4.E15.m1.5.5.1.1.1.3.3" xref="S4.E15.m1.5.5.1.1.1.3.3.cmml">j</mi></msub><mo id="S4.E15.m1.5.5.1.1.1.2" xref="S4.E15.m1.5.5.1.1.1.2.cmml">+</mo><mrow id="S4.E15.m1.5.5.1.1.1.1" xref="S4.E15.m1.5.5.1.1.1.1.cmml"><mi id="S4.E15.m1.5.5.1.1.1.1.3" xref="S4.E15.m1.5.5.1.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S4.E15.m1.5.5.1.1.1.1.2" xref="S4.E15.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S4.E15.m1.5.5.1.1.1.1.1.1" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E15.m1.5.5.1.1.1.1.1.1.2" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.5.5.1.1.1.1.1.1.1" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.cmml"><msub id="S4.E15.m1.5.5.1.1.1.1.1.1.1.2" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E15.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.2.2.cmml">𝐡</mi><mrow id="S4.E15.m1.4.4.2.4" xref="S4.E15.m1.4.4.2.3.cmml"><mi id="S4.E15.m1.3.3.1.1" xref="S4.E15.m1.3.3.1.1.cmml">i</mi><mo id="S4.E15.m1.4.4.2.4.1" xref="S4.E15.m1.4.4.2.3.cmml">,</mo><mi id="S4.E15.m1.4.4.2.2" xref="S4.E15.m1.4.4.2.2.cmml">k</mi></mrow></msub><mo id="S4.E15.m1.5.5.1.1.1.1.1.1.1.1" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E15.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">𝐩</mi><mi id="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.3" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S4.E15.m1.5.5.1.1.1.1.1.1.3" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E15.m1.5.5.1.2" xref="S4.E15.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.5b"><apply id="S4.E15.m1.5.5.1.1.cmml" xref="S4.E15.m1.5.5.1"><eq id="S4.E15.m1.5.5.1.1.2.cmml" xref="S4.E15.m1.5.5.1.1.2"></eq><apply id="S4.E15.m1.5.5.1.1.3.cmml" xref="S4.E15.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.5.5.1.1.3.1.cmml" xref="S4.E15.m1.5.5.1.1.3">subscript</csymbol><apply id="S4.E15.m1.5.5.1.1.3.2.cmml" xref="S4.E15.m1.5.5.1.1.3.2"><ci id="S4.E15.m1.5.5.1.1.3.2.1.cmml" xref="S4.E15.m1.5.5.1.1.3.2.1">~</ci><ci id="S4.E15.m1.5.5.1.1.3.2.2.cmml" xref="S4.E15.m1.5.5.1.1.3.2.2">𝐡</ci></apply><list id="S4.E15.m1.2.2.2.3.cmml" xref="S4.E15.m1.2.2.2.4"><ci id="S4.E15.m1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1">𝑗</ci><ci id="S4.E15.m1.2.2.2.2.cmml" xref="S4.E15.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S4.E15.m1.5.5.1.1.1.cmml" xref="S4.E15.m1.5.5.1.1.1"><plus id="S4.E15.m1.5.5.1.1.1.2.cmml" xref="S4.E15.m1.5.5.1.1.1.2"></plus><apply id="S4.E15.m1.5.5.1.1.1.3.cmml" xref="S4.E15.m1.5.5.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.5.5.1.1.1.3.1.cmml" xref="S4.E15.m1.5.5.1.1.1.3">subscript</csymbol><ci id="S4.E15.m1.5.5.1.1.1.3.2.cmml" xref="S4.E15.m1.5.5.1.1.1.3.2">𝐩</ci><ci id="S4.E15.m1.5.5.1.1.1.3.3.cmml" xref="S4.E15.m1.5.5.1.1.1.3.3">𝑗</ci></apply><apply id="S4.E15.m1.5.5.1.1.1.1.cmml" xref="S4.E15.m1.5.5.1.1.1.1"><times id="S4.E15.m1.5.5.1.1.1.1.2.cmml" xref="S4.E15.m1.5.5.1.1.1.1.2"></times><ci id="S4.E15.m1.5.5.1.1.1.1.3.cmml" xref="S4.E15.m1.5.5.1.1.1.1.3">𝜆</ci><apply id="S4.E15.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.5.5.1.1.1.1.1.1"><minus id="S4.E15.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.1"></minus><apply id="S4.E15.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E15.m1.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.2.2">𝐡</ci><list id="S4.E15.m1.4.4.2.3.cmml" xref="S4.E15.m1.4.4.2.4"><ci id="S4.E15.m1.3.3.1.1.cmml" xref="S4.E15.m1.3.3.1.1">𝑖</ci><ci id="S4.E15.m1.4.4.2.2.cmml" xref="S4.E15.m1.4.4.2.2">𝑘</ci></list></apply><apply id="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.2">𝐩</ci><ci id="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E15.m1.5.5.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.5c">\tilde{\bf{h}}_{j,k}={\bf{p}}_{j}+\lambda({\bf{h}}_{i,k}-{\bf{p}}_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p2.20" class="ltx_p">where <math id="S4.SS2.p2.9.m1.2" class="ltx_Math" alttext="{\bf{h}}_{i,k}" display="inline"><semantics id="S4.SS2.p2.9.m1.2a"><msub id="S4.SS2.p2.9.m1.2.3" xref="S4.SS2.p2.9.m1.2.3.cmml"><mi id="S4.SS2.p2.9.m1.2.3.2" xref="S4.SS2.p2.9.m1.2.3.2.cmml">𝐡</mi><mrow id="S4.SS2.p2.9.m1.2.2.2.4" xref="S4.SS2.p2.9.m1.2.2.2.3.cmml"><mi id="S4.SS2.p2.9.m1.1.1.1.1" xref="S4.SS2.p2.9.m1.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p2.9.m1.2.2.2.4.1" xref="S4.SS2.p2.9.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.9.m1.2.2.2.2" xref="S4.SS2.p2.9.m1.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.9.m1.2b"><apply id="S4.SS2.p2.9.m1.2.3.cmml" xref="S4.SS2.p2.9.m1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.9.m1.2.3.1.cmml" xref="S4.SS2.p2.9.m1.2.3">subscript</csymbol><ci id="S4.SS2.p2.9.m1.2.3.2.cmml" xref="S4.SS2.p2.9.m1.2.3.2">𝐡</ci><list id="S4.SS2.p2.9.m1.2.2.2.3.cmml" xref="S4.SS2.p2.9.m1.2.2.2.4"><ci id="S4.SS2.p2.9.m1.1.1.1.1.cmml" xref="S4.SS2.p2.9.m1.1.1.1.1">𝑖</ci><ci id="S4.SS2.p2.9.m1.2.2.2.2.cmml" xref="S4.SS2.p2.9.m1.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.9.m1.2c">{\bf{h}}_{i,k}</annotation></semantics></math> and <math id="S4.SS2.p2.10.m2.1" class="ltx_Math" alttext="{\bf{p}}_{i}" display="inline"><semantics id="S4.SS2.p2.10.m2.1a"><msub id="S4.SS2.p2.10.m2.1.1" xref="S4.SS2.p2.10.m2.1.1.cmml"><mi id="S4.SS2.p2.10.m2.1.1.2" xref="S4.SS2.p2.10.m2.1.1.2.cmml">𝐩</mi><mi id="S4.SS2.p2.10.m2.1.1.3" xref="S4.SS2.p2.10.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.10.m2.1b"><apply id="S4.SS2.p2.10.m2.1.1.cmml" xref="S4.SS2.p2.10.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.10.m2.1.1.1.cmml" xref="S4.SS2.p2.10.m2.1.1">subscript</csymbol><ci id="S4.SS2.p2.10.m2.1.1.2.cmml" xref="S4.SS2.p2.10.m2.1.1.2">𝐩</ci><ci id="S4.SS2.p2.10.m2.1.1.3.cmml" xref="S4.SS2.p2.10.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.10.m2.1c">{\bf{p}}_{i}</annotation></semantics></math> are the feature-level sample and the center of class <math id="S4.SS2.p2.11.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p2.11.m3.1a"><mi id="S4.SS2.p2.11.m3.1.1" xref="S4.SS2.p2.11.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.11.m3.1b"><ci id="S4.SS2.p2.11.m3.1.1.cmml" xref="S4.SS2.p2.11.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.11.m3.1c">i</annotation></semantics></math>. <math id="S4.SS2.p2.12.m4.1" class="ltx_Math" alttext="{\bf{p}}_{j}" display="inline"><semantics id="S4.SS2.p2.12.m4.1a"><msub id="S4.SS2.p2.12.m4.1.1" xref="S4.SS2.p2.12.m4.1.1.cmml"><mi id="S4.SS2.p2.12.m4.1.1.2" xref="S4.SS2.p2.12.m4.1.1.2.cmml">𝐩</mi><mi id="S4.SS2.p2.12.m4.1.1.3" xref="S4.SS2.p2.12.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.12.m4.1b"><apply id="S4.SS2.p2.12.m4.1.1.cmml" xref="S4.SS2.p2.12.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.12.m4.1.1.1.cmml" xref="S4.SS2.p2.12.m4.1.1">subscript</csymbol><ci id="S4.SS2.p2.12.m4.1.1.2.cmml" xref="S4.SS2.p2.12.m4.1.1.2">𝐩</ci><ci id="S4.SS2.p2.12.m4.1.1.3.cmml" xref="S4.SS2.p2.12.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.12.m4.1c">{\bf{p}}_{j}</annotation></semantics></math> is the feature center of a missing class <math id="S4.SS2.p2.13.m5.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS2.p2.13.m5.1a"><mi id="S4.SS2.p2.13.m5.1.1" xref="S4.SS2.p2.13.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.13.m5.1b"><ci id="S4.SS2.p2.13.m5.1.1.cmml" xref="S4.SS2.p2.13.m5.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.13.m5.1c">j</annotation></semantics></math> and <math id="S4.SS2.p2.14.m6.2" class="ltx_Math" alttext="\tilde{\bf{h}}_{j,k}" display="inline"><semantics id="S4.SS2.p2.14.m6.2a"><msub id="S4.SS2.p2.14.m6.2.3" xref="S4.SS2.p2.14.m6.2.3.cmml"><mover accent="true" id="S4.SS2.p2.14.m6.2.3.2" xref="S4.SS2.p2.14.m6.2.3.2.cmml"><mi id="S4.SS2.p2.14.m6.2.3.2.2" xref="S4.SS2.p2.14.m6.2.3.2.2.cmml">𝐡</mi><mo id="S4.SS2.p2.14.m6.2.3.2.1" xref="S4.SS2.p2.14.m6.2.3.2.1.cmml">~</mo></mover><mrow id="S4.SS2.p2.14.m6.2.2.2.4" xref="S4.SS2.p2.14.m6.2.2.2.3.cmml"><mi id="S4.SS2.p2.14.m6.1.1.1.1" xref="S4.SS2.p2.14.m6.1.1.1.1.cmml">j</mi><mo id="S4.SS2.p2.14.m6.2.2.2.4.1" xref="S4.SS2.p2.14.m6.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.14.m6.2.2.2.2" xref="S4.SS2.p2.14.m6.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.14.m6.2b"><apply id="S4.SS2.p2.14.m6.2.3.cmml" xref="S4.SS2.p2.14.m6.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.14.m6.2.3.1.cmml" xref="S4.SS2.p2.14.m6.2.3">subscript</csymbol><apply id="S4.SS2.p2.14.m6.2.3.2.cmml" xref="S4.SS2.p2.14.m6.2.3.2"><ci id="S4.SS2.p2.14.m6.2.3.2.1.cmml" xref="S4.SS2.p2.14.m6.2.3.2.1">~</ci><ci id="S4.SS2.p2.14.m6.2.3.2.2.cmml" xref="S4.SS2.p2.14.m6.2.3.2.2">𝐡</ci></apply><list id="S4.SS2.p2.14.m6.2.2.2.3.cmml" xref="S4.SS2.p2.14.m6.2.2.2.4"><ci id="S4.SS2.p2.14.m6.1.1.1.1.cmml" xref="S4.SS2.p2.14.m6.1.1.1.1">𝑗</ci><ci id="S4.SS2.p2.14.m6.2.2.2.2.cmml" xref="S4.SS2.p2.14.m6.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.14.m6.2c">\tilde{\bf{h}}_{j,k}</annotation></semantics></math> is the transferred feature for class <math id="S4.SS2.p2.15.m7.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS2.p2.15.m7.1a"><mi id="S4.SS2.p2.15.m7.1.1" xref="S4.SS2.p2.15.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.15.m7.1b"><ci id="S4.SS2.p2.15.m7.1.1.cmml" xref="S4.SS2.p2.15.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.15.m7.1c">j</annotation></semantics></math>, preserving the same class identity as <math id="S4.SS2.p2.16.m8.1" class="ltx_Math" alttext="{\bf{p}}_{j}" display="inline"><semantics id="S4.SS2.p2.16.m8.1a"><msub id="S4.SS2.p2.16.m8.1.1" xref="S4.SS2.p2.16.m8.1.1.cmml"><mi id="S4.SS2.p2.16.m8.1.1.2" xref="S4.SS2.p2.16.m8.1.1.2.cmml">𝐩</mi><mi id="S4.SS2.p2.16.m8.1.1.3" xref="S4.SS2.p2.16.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.16.m8.1b"><apply id="S4.SS2.p2.16.m8.1.1.cmml" xref="S4.SS2.p2.16.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.16.m8.1.1.1.cmml" xref="S4.SS2.p2.16.m8.1.1">subscript</csymbol><ci id="S4.SS2.p2.16.m8.1.1.2.cmml" xref="S4.SS2.p2.16.m8.1.1.2">𝐩</ci><ci id="S4.SS2.p2.16.m8.1.1.3.cmml" xref="S4.SS2.p2.16.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.16.m8.1c">{\bf{p}}_{j}</annotation></semantics></math>. This strategy is advantageous as it can be implemented efficiently without repeatedly computing the covariance matrix. The <math id="S4.SS2.p2.17.m9.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS2.p2.17.m9.1a"><mi id="S4.SS2.p2.17.m9.1.1" xref="S4.SS2.p2.17.m9.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.17.m9.1b"><ci id="S4.SS2.p2.17.m9.1.1.cmml" xref="S4.SS2.p2.17.m9.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.17.m9.1c">\lambda</annotation></semantics></math> is an optional coefficient for scaling and we empirically find that set <math id="S4.SS2.p2.18.m10.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS2.p2.18.m10.1a"><mi id="S4.SS2.p2.18.m10.1.1" xref="S4.SS2.p2.18.m10.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.18.m10.1b"><ci id="S4.SS2.p2.18.m10.1.1.cmml" xref="S4.SS2.p2.18.m10.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.18.m10.1c">\lambda</annotation></semantics></math>=1 by default is generally good. By sufficiently sampling <math id="S4.SS2.p2.19.m11.2" class="ltx_Math" alttext="{\bf{h}}_{i,k}" display="inline"><semantics id="S4.SS2.p2.19.m11.2a"><msub id="S4.SS2.p2.19.m11.2.3" xref="S4.SS2.p2.19.m11.2.3.cmml"><mi id="S4.SS2.p2.19.m11.2.3.2" xref="S4.SS2.p2.19.m11.2.3.2.cmml">𝐡</mi><mrow id="S4.SS2.p2.19.m11.2.2.2.4" xref="S4.SS2.p2.19.m11.2.2.2.3.cmml"><mi id="S4.SS2.p2.19.m11.1.1.1.1" xref="S4.SS2.p2.19.m11.1.1.1.1.cmml">i</mi><mo id="S4.SS2.p2.19.m11.2.2.2.4.1" xref="S4.SS2.p2.19.m11.2.2.2.3.cmml">,</mo><mi id="S4.SS2.p2.19.m11.2.2.2.2" xref="S4.SS2.p2.19.m11.2.2.2.2.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.19.m11.2b"><apply id="S4.SS2.p2.19.m11.2.3.cmml" xref="S4.SS2.p2.19.m11.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.19.m11.2.3.1.cmml" xref="S4.SS2.p2.19.m11.2.3">subscript</csymbol><ci id="S4.SS2.p2.19.m11.2.3.2.cmml" xref="S4.SS2.p2.19.m11.2.3.2">𝐡</ci><list id="S4.SS2.p2.19.m11.2.2.2.3.cmml" xref="S4.SS2.p2.19.m11.2.2.2.4"><ci id="S4.SS2.p2.19.m11.1.1.1.1.cmml" xref="S4.SS2.p2.19.m11.1.1.1.1">𝑖</ci><ci id="S4.SS2.p2.19.m11.2.2.2.2.cmml" xref="S4.SS2.p2.19.m11.2.2.2.2">𝑘</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.19.m11.2c">{\bf{h}}_{i,k}</annotation></semantics></math> across different available classes, we expect to obtain an augmented distribution of missing class <math id="S4.SS2.p2.20.m12.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS2.p2.20.m12.1a"><mi id="S4.SS2.p2.20.m12.1.1" xref="S4.SS2.p2.20.m12.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.20.m12.1b"><ci id="S4.SS2.p2.20.m12.1.1.cmml" xref="S4.SS2.p2.20.m12.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.20.m12.1c">j</annotation></semantics></math> in the feature space. A more efficient and effective implementation is augmenting all classes by enumerating the label set in a cyclic way until the mini-batch features are all utilized in each gradient decent step.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.14.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <math id="alg1.2.m1.1" class="ltx_Math" alttext="\mathtt{ReBaFL}" display="inline"><semantics id="alg1.2.m1.1b"><mi id="alg1.2.m1.1.1" xref="alg1.2.m1.1.1.cmml">𝚁𝚎𝙱𝚊𝙵𝙻</mi><annotation-xml encoding="MathML-Content" id="alg1.2.m1.1c"><ci id="alg1.2.m1.1.1.cmml" xref="alg1.2.m1.1.1">𝚁𝚎𝙱𝚊𝙵𝙻</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m1.1d">\mathtt{ReBaFL}</annotation></semantics></math></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.9" class="ltx_p ltx_figure_panel"><span id="alg1.9.1" class="ltx_text ltx_font_bold">Input:</span> Learning rate <math id="alg1.3.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.3.m1.1a"><mi id="alg1.3.m1.1.1" xref="alg1.3.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.3.m1.1b"><ci id="alg1.3.m1.1.1.cmml" xref="alg1.3.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m1.1c">\eta</annotation></semantics></math>, communication rounds <math id="alg1.4.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.4.m2.1a"><mi id="alg1.4.m2.1.1" xref="alg1.4.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.4.m2.1b"><ci id="alg1.4.m2.1.1.cmml" xref="alg1.4.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m2.1c">T</annotation></semantics></math>, number of clients <math id="alg1.5.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.5.m3.1a"><mi id="alg1.5.m3.1.1" xref="alg1.5.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.5.m3.1b"><ci id="alg1.5.m3.1.1.cmml" xref="alg1.5.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m3.1c">m</annotation></semantics></math>, local epochs <math id="alg1.6.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.6.m4.1a"><mi id="alg1.6.m4.1.1" xref="alg1.6.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.6.m4.1b"><ci id="alg1.6.m4.1.1.cmml" xref="alg1.6.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m4.1c">E</annotation></semantics></math>, hyper-parameters <math id="alg1.7.m5.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="alg1.7.m5.1a"><mi id="alg1.7.m5.1.1" xref="alg1.7.m5.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="alg1.7.m5.1b"><ci id="alg1.7.m5.1.1.cmml" xref="alg1.7.m5.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m5.1c">\epsilon</annotation></semantics></math> and <math id="alg1.8.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="alg1.8.m6.1a"><mi id="alg1.8.m6.1.1" xref="alg1.8.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="alg1.8.m6.1b"><ci id="alg1.8.m6.1.1.cmml" xref="alg1.8.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m6.1c">\mu</annotation></semantics></math> 
<br class="ltx_break"><span id="alg1.9.2" class="ltx_text ltx_font_bold">Initialize:</span> Initial model <math id="alg1.9.m7.1" class="ltx_Math" alttext="\bm{w}_{0}\in R^{d}" display="inline"><semantics id="alg1.9.m7.1a"><mrow id="alg1.9.m7.1.1" xref="alg1.9.m7.1.1.cmml"><msub id="alg1.9.m7.1.1.2" xref="alg1.9.m7.1.1.2.cmml"><mi id="alg1.9.m7.1.1.2.2" xref="alg1.9.m7.1.1.2.2.cmml">𝒘</mi><mn id="alg1.9.m7.1.1.2.3" xref="alg1.9.m7.1.1.2.3.cmml">0</mn></msub><mo id="alg1.9.m7.1.1.1" xref="alg1.9.m7.1.1.1.cmml">∈</mo><msup id="alg1.9.m7.1.1.3" xref="alg1.9.m7.1.1.3.cmml"><mi id="alg1.9.m7.1.1.3.2" xref="alg1.9.m7.1.1.3.2.cmml">R</mi><mi id="alg1.9.m7.1.1.3.3" xref="alg1.9.m7.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.9.m7.1b"><apply id="alg1.9.m7.1.1.cmml" xref="alg1.9.m7.1.1"><in id="alg1.9.m7.1.1.1.cmml" xref="alg1.9.m7.1.1.1"></in><apply id="alg1.9.m7.1.1.2.cmml" xref="alg1.9.m7.1.1.2"><csymbol cd="ambiguous" id="alg1.9.m7.1.1.2.1.cmml" xref="alg1.9.m7.1.1.2">subscript</csymbol><ci id="alg1.9.m7.1.1.2.2.cmml" xref="alg1.9.m7.1.1.2.2">𝒘</ci><cn type="integer" id="alg1.9.m7.1.1.2.3.cmml" xref="alg1.9.m7.1.1.2.3">0</cn></apply><apply id="alg1.9.m7.1.1.3.cmml" xref="alg1.9.m7.1.1.3"><csymbol cd="ambiguous" id="alg1.9.m7.1.1.3.1.cmml" xref="alg1.9.m7.1.1.3">superscript</csymbol><ci id="alg1.9.m7.1.1.3.2.cmml" xref="alg1.9.m7.1.1.3.2">𝑅</ci><ci id="alg1.9.m7.1.1.3.3.cmml" xref="alg1.9.m7.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m7.1c">\bm{w}_{0}\in R^{d}</annotation></semantics></math> 
<br class="ltx_break"><span id="alg1.9.3" class="ltx_text ltx_font_bold">Server Executes:</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.15" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l1.m1.4" class="ltx_Math" alttext="t=0,1,...,T-1" display="inline"><semantics id="alg1.l1.m1.4a"><mrow id="alg1.l1.m1.4.4" xref="alg1.l1.m1.4.4.cmml"><mi id="alg1.l1.m1.4.4.3" xref="alg1.l1.m1.4.4.3.cmml">t</mi><mo id="alg1.l1.m1.4.4.2" xref="alg1.l1.m1.4.4.2.cmml">=</mo><mrow id="alg1.l1.m1.4.4.1.1" xref="alg1.l1.m1.4.4.1.2.cmml"><mn id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">0</mn><mo id="alg1.l1.m1.4.4.1.1.2" xref="alg1.l1.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">1</mn><mo id="alg1.l1.m1.4.4.1.1.3" xref="alg1.l1.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">…</mi><mo id="alg1.l1.m1.4.4.1.1.4" xref="alg1.l1.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l1.m1.4.4.1.1.1" xref="alg1.l1.m1.4.4.1.1.1.cmml"><mi id="alg1.l1.m1.4.4.1.1.1.2" xref="alg1.l1.m1.4.4.1.1.1.2.cmml">T</mi><mo id="alg1.l1.m1.4.4.1.1.1.1" xref="alg1.l1.m1.4.4.1.1.1.1.cmml">−</mo><mn id="alg1.l1.m1.4.4.1.1.1.3" xref="alg1.l1.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.4b"><apply id="alg1.l1.m1.4.4.cmml" xref="alg1.l1.m1.4.4"><eq id="alg1.l1.m1.4.4.2.cmml" xref="alg1.l1.m1.4.4.2"></eq><ci id="alg1.l1.m1.4.4.3.cmml" xref="alg1.l1.m1.4.4.3">𝑡</ci><list id="alg1.l1.m1.4.4.1.2.cmml" xref="alg1.l1.m1.4.4.1.1"><cn type="integer" id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">0</cn><cn type="integer" id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">1</cn><ci id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">…</ci><apply id="alg1.l1.m1.4.4.1.1.1.cmml" xref="alg1.l1.m1.4.4.1.1.1"><minus id="alg1.l1.m1.4.4.1.1.1.1.cmml" xref="alg1.l1.m1.4.4.1.1.1.1"></minus><ci id="alg1.l1.m1.4.4.1.1.1.2.cmml" xref="alg1.l1.m1.4.4.1.1.1.2">𝑇</ci><cn type="integer" id="alg1.l1.m1.4.4.1.1.1.3.cmml" xref="alg1.l1.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.4c">t=0,1,...,T-1</annotation></semantics></math> <span id="alg1.l1.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>     Broadcast <math id="alg1.l2.m1.1" class="ltx_Math" alttext="{\bm{w}}^{(t)}" display="inline"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.2" xref="alg1.l2.m1.1.2.cmml"><mi id="alg1.l2.m1.1.2.2" xref="alg1.l2.m1.1.2.2.cmml">𝒘</mi><mrow id="alg1.l2.m1.1.1.1.3" xref="alg1.l2.m1.1.2.cmml"><mo stretchy="false" id="alg1.l2.m1.1.1.1.3.1" xref="alg1.l2.m1.1.2.cmml">(</mo><mi id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l2.m1.1.1.1.3.2" xref="alg1.l2.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.2.cmml" xref="alg1.l2.m1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.2.1.cmml" xref="alg1.l2.m1.1.2">superscript</csymbol><ci id="alg1.l2.m1.1.2.2.cmml" xref="alg1.l2.m1.1.2.2">𝒘</ci><ci id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">{\bm{w}}^{(t)}</annotation></semantics></math> and <math id="alg1.l2.m2.1" class="ltx_Math" alttext="\bm{p}^{(t)}" display="inline"><semantics id="alg1.l2.m2.1a"><msup id="alg1.l2.m2.1.2" xref="alg1.l2.m2.1.2.cmml"><mi id="alg1.l2.m2.1.2.2" xref="alg1.l2.m2.1.2.2.cmml">𝒑</mi><mrow id="alg1.l2.m2.1.1.1.3" xref="alg1.l2.m2.1.2.cmml"><mo stretchy="false" id="alg1.l2.m2.1.1.1.3.1" xref="alg1.l2.m2.1.2.cmml">(</mo><mi id="alg1.l2.m2.1.1.1.1" xref="alg1.l2.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l2.m2.1.1.1.3.2" xref="alg1.l2.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.2.cmml" xref="alg1.l2.m2.1.2"><csymbol cd="ambiguous" id="alg1.l2.m2.1.2.1.cmml" xref="alg1.l2.m2.1.2">superscript</csymbol><ci id="alg1.l2.m2.1.2.2.cmml" xref="alg1.l2.m2.1.2.2">𝒑</ci><ci id="alg1.l2.m2.1.1.1.1.cmml" xref="alg1.l2.m2.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\bm{p}^{(t)}</annotation></semantics></math> to clients

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.3.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     <span id="alg1.l3.4" class="ltx_text ltx_font_bold">for</span> <span id="alg1.l3.2" class="ltx_text ltx_font_italic">each client <math id="alg1.l3.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l3.1.m1.1a"><mi id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">i</annotation></semantics></math> in active set <math id="alg1.l3.2.m2.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="alg1.l3.2.m2.1a"><msub id="alg1.l3.2.m2.1.1" xref="alg1.l3.2.m2.1.1.cmml"><mi id="alg1.l3.2.m2.1.1.2" xref="alg1.l3.2.m2.1.1.2.cmml">S</mi><mi id="alg1.l3.2.m2.1.1.3" xref="alg1.l3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.2.m2.1b"><apply id="alg1.l3.2.m2.1.1.cmml" xref="alg1.l3.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.2.m2.1.1.1.cmml" xref="alg1.l3.2.m2.1.1">subscript</csymbol><ci id="alg1.l3.2.m2.1.1.2.cmml" xref="alg1.l3.2.m2.1.1.2">𝑆</ci><ci id="alg1.l3.2.m2.1.1.3.cmml" xref="alg1.l3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.2.m2.1c">S_{t}</annotation></semantics></math> in parallel</span> <span id="alg1.l3.5" class="ltx_text ltx_font_bold">do</span>


</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>         <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\Delta{\bm{w}}_{i}^{(t)}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.2" xref="alg1.l4.m1.1.2.cmml"><mi mathvariant="normal" id="alg1.l4.m1.1.2.2" xref="alg1.l4.m1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.2.1" xref="alg1.l4.m1.1.2.1.cmml">​</mo><msubsup id="alg1.l4.m1.1.2.3" xref="alg1.l4.m1.1.2.3.cmml"><mi id="alg1.l4.m1.1.2.3.2.2" xref="alg1.l4.m1.1.2.3.2.2.cmml">𝒘</mi><mi id="alg1.l4.m1.1.2.3.2.3" xref="alg1.l4.m1.1.2.3.2.3.cmml">i</mi><mrow id="alg1.l4.m1.1.1.1.3" xref="alg1.l4.m1.1.2.3.cmml"><mo stretchy="false" id="alg1.l4.m1.1.1.1.3.1" xref="alg1.l4.m1.1.2.3.cmml">(</mo><mi id="alg1.l4.m1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l4.m1.1.1.1.3.2" xref="alg1.l4.m1.1.2.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.2.cmml" xref="alg1.l4.m1.1.2"><times id="alg1.l4.m1.1.2.1.cmml" xref="alg1.l4.m1.1.2.1"></times><ci id="alg1.l4.m1.1.2.2.cmml" xref="alg1.l4.m1.1.2.2">Δ</ci><apply id="alg1.l4.m1.1.2.3.cmml" xref="alg1.l4.m1.1.2.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.2.3.1.cmml" xref="alg1.l4.m1.1.2.3">superscript</csymbol><apply id="alg1.l4.m1.1.2.3.2.cmml" xref="alg1.l4.m1.1.2.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.2.3.2.1.cmml" xref="alg1.l4.m1.1.2.3">subscript</csymbol><ci id="alg1.l4.m1.1.2.3.2.2.cmml" xref="alg1.l4.m1.1.2.3.2.2">𝒘</ci><ci id="alg1.l4.m1.1.2.3.2.3.cmml" xref="alg1.l4.m1.1.2.3.2.3">𝑖</ci></apply><ci id="alg1.l4.m1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\Delta{\bm{w}}_{i}^{(t)}</annotation></semantics></math>, <math id="alg1.l4.m2.1" class="ltx_Math" alttext="\hat{\bm{p}}_{i}^{(t+1)}" display="inline"><semantics id="alg1.l4.m2.1a"><msubsup id="alg1.l4.m2.1.2" xref="alg1.l4.m2.1.2.cmml"><mover accent="true" id="alg1.l4.m2.1.2.2.2" xref="alg1.l4.m2.1.2.2.2.cmml"><mi id="alg1.l4.m2.1.2.2.2.2" xref="alg1.l4.m2.1.2.2.2.2.cmml">𝒑</mi><mo id="alg1.l4.m2.1.2.2.2.1" xref="alg1.l4.m2.1.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l4.m2.1.2.2.3" xref="alg1.l4.m2.1.2.2.3.cmml">i</mi><mrow id="alg1.l4.m2.1.1.1.1" xref="alg1.l4.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l4.m2.1.1.1.1.2" xref="alg1.l4.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m2.1.1.1.1.1" xref="alg1.l4.m2.1.1.1.1.1.cmml"><mi id="alg1.l4.m2.1.1.1.1.1.2" xref="alg1.l4.m2.1.1.1.1.1.2.cmml">t</mi><mo id="alg1.l4.m2.1.1.1.1.1.1" xref="alg1.l4.m2.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l4.m2.1.1.1.1.1.3" xref="alg1.l4.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l4.m2.1.1.1.1.3" xref="alg1.l4.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.2.cmml" xref="alg1.l4.m2.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.2.1.cmml" xref="alg1.l4.m2.1.2">superscript</csymbol><apply id="alg1.l4.m2.1.2.2.cmml" xref="alg1.l4.m2.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.2.2.1.cmml" xref="alg1.l4.m2.1.2">subscript</csymbol><apply id="alg1.l4.m2.1.2.2.2.cmml" xref="alg1.l4.m2.1.2.2.2"><ci id="alg1.l4.m2.1.2.2.2.1.cmml" xref="alg1.l4.m2.1.2.2.2.1">^</ci><ci id="alg1.l4.m2.1.2.2.2.2.cmml" xref="alg1.l4.m2.1.2.2.2.2">𝒑</ci></apply><ci id="alg1.l4.m2.1.2.2.3.cmml" xref="alg1.l4.m2.1.2.2.3">𝑖</ci></apply><apply id="alg1.l4.m2.1.1.1.1.1.cmml" xref="alg1.l4.m2.1.1.1.1"><plus id="alg1.l4.m2.1.1.1.1.1.1.cmml" xref="alg1.l4.m2.1.1.1.1.1.1"></plus><ci id="alg1.l4.m2.1.1.1.1.1.2.cmml" xref="alg1.l4.m2.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l4.m2.1.1.1.1.1.3.cmml" xref="alg1.l4.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\hat{\bm{p}}_{i}^{(t+1)}</annotation></semantics></math> <math id="alg1.l4.m3.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l4.m3.1a"><mo stretchy="false" id="alg1.l4.m3.1.1" xref="alg1.l4.m3.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.m3.1b"><ci id="alg1.l4.m3.1.1.cmml" xref="alg1.l4.m3.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m3.1c">\leftarrow</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">LocalTraining</span>(<math id="alg1.l4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l4.m4.1a"><mi id="alg1.l4.m4.1.1" xref="alg1.l4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m4.1b"><ci id="alg1.l4.m4.1.1.cmml" xref="alg1.l4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m4.1c">i</annotation></semantics></math>, <math id="alg1.l4.m5.1" class="ltx_Math" alttext="{\bm{w}}^{(t)}" display="inline"><semantics id="alg1.l4.m5.1a"><msup id="alg1.l4.m5.1.2" xref="alg1.l4.m5.1.2.cmml"><mi id="alg1.l4.m5.1.2.2" xref="alg1.l4.m5.1.2.2.cmml">𝒘</mi><mrow id="alg1.l4.m5.1.1.1.3" xref="alg1.l4.m5.1.2.cmml"><mo stretchy="false" id="alg1.l4.m5.1.1.1.3.1" xref="alg1.l4.m5.1.2.cmml">(</mo><mi id="alg1.l4.m5.1.1.1.1" xref="alg1.l4.m5.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l4.m5.1.1.1.3.2" xref="alg1.l4.m5.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l4.m5.1b"><apply id="alg1.l4.m5.1.2.cmml" xref="alg1.l4.m5.1.2"><csymbol cd="ambiguous" id="alg1.l4.m5.1.2.1.cmml" xref="alg1.l4.m5.1.2">superscript</csymbol><ci id="alg1.l4.m5.1.2.2.cmml" xref="alg1.l4.m5.1.2.2">𝒘</ci><ci id="alg1.l4.m5.1.1.1.1.cmml" xref="alg1.l4.m5.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m5.1c">{\bm{w}}^{(t)}</annotation></semantics></math>, <math id="alg1.l4.m6.1" class="ltx_Math" alttext="\bm{p}^{(t)}" display="inline"><semantics id="alg1.l4.m6.1a"><msup id="alg1.l4.m6.1.2" xref="alg1.l4.m6.1.2.cmml"><mi id="alg1.l4.m6.1.2.2" xref="alg1.l4.m6.1.2.2.cmml">𝒑</mi><mrow id="alg1.l4.m6.1.1.1.3" xref="alg1.l4.m6.1.2.cmml"><mo stretchy="false" id="alg1.l4.m6.1.1.1.3.1" xref="alg1.l4.m6.1.2.cmml">(</mo><mi id="alg1.l4.m6.1.1.1.1" xref="alg1.l4.m6.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l4.m6.1.1.1.3.2" xref="alg1.l4.m6.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l4.m6.1b"><apply id="alg1.l4.m6.1.2.cmml" xref="alg1.l4.m6.1.2"><csymbol cd="ambiguous" id="alg1.l4.m6.1.2.1.cmml" xref="alg1.l4.m6.1.2">superscript</csymbol><ci id="alg1.l4.m6.1.2.2.cmml" xref="alg1.l4.m6.1.2.2">𝒑</ci><ci id="alg1.l4.m6.1.1.1.1.cmml" xref="alg1.l4.m6.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m6.1c">\bm{p}^{(t)}</annotation></semantics></math>)


</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     Server aggregates <math id="alg1.l6.m1.2" class="ltx_Math" alttext="\{\Delta{\bm{w}}_{i}^{(t)}\}" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2.1" xref="alg1.l6.m1.2.2.2.cmml"><mo stretchy="false" id="alg1.l6.m1.2.2.1.2" xref="alg1.l6.m1.2.2.2.cmml">{</mo><mrow id="alg1.l6.m1.2.2.1.1" xref="alg1.l6.m1.2.2.1.1.cmml"><mi mathvariant="normal" id="alg1.l6.m1.2.2.1.1.2" xref="alg1.l6.m1.2.2.1.1.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.cmml">​</mo><msubsup id="alg1.l6.m1.2.2.1.1.3" xref="alg1.l6.m1.2.2.1.1.3.cmml"><mi id="alg1.l6.m1.2.2.1.1.3.2.2" xref="alg1.l6.m1.2.2.1.1.3.2.2.cmml">𝒘</mi><mi id="alg1.l6.m1.2.2.1.1.3.2.3" xref="alg1.l6.m1.2.2.1.1.3.2.3.cmml">i</mi><mrow id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.3.1" xref="alg1.l6.m1.2.2.1.1.3.cmml">(</mo><mi id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l6.m1.1.1.1.3.2" xref="alg1.l6.m1.2.2.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo stretchy="false" id="alg1.l6.m1.2.2.1.3" xref="alg1.l6.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><set id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.1"><apply id="alg1.l6.m1.2.2.1.1.cmml" xref="alg1.l6.m1.2.2.1.1"><times id="alg1.l6.m1.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1"></times><ci id="alg1.l6.m1.2.2.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.2">Δ</ci><apply id="alg1.l6.m1.2.2.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.3.1.cmml" xref="alg1.l6.m1.2.2.1.1.3">superscript</csymbol><apply id="alg1.l6.m1.2.2.1.1.3.2.cmml" xref="alg1.l6.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.3.2.1.cmml" xref="alg1.l6.m1.2.2.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.2.2.1.1.3.2.2.cmml" xref="alg1.l6.m1.2.2.1.1.3.2.2">𝒘</ci><ci id="alg1.l6.m1.2.2.1.1.3.2.3.cmml" xref="alg1.l6.m1.2.2.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1">𝑡</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\{\Delta{\bm{w}}_{i}^{(t)}\}</annotation></semantics></math> and updates model:


</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>       <math id="alg1.l7.m1.3" class="ltx_Math" alttext="{\bm{w}}^{(t+1)}={\bm{w}}^{(t)}+\sum_{i\in S_{t}}\frac{n_{i}}{\sum_{i\in S_{t}}n_{i}}\Delta{\bm{w}}_{i}^{(t)}" display="inline"><semantics id="alg1.l7.m1.3a"><mrow id="alg1.l7.m1.3.4" xref="alg1.l7.m1.3.4.cmml"><msup id="alg1.l7.m1.3.4.2" xref="alg1.l7.m1.3.4.2.cmml"><mi id="alg1.l7.m1.3.4.2.2" xref="alg1.l7.m1.3.4.2.2.cmml">𝒘</mi><mrow id="alg1.l7.m1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="alg1.l7.m1.3.4.1" xref="alg1.l7.m1.3.4.1.cmml">=</mo><mrow id="alg1.l7.m1.3.4.3" xref="alg1.l7.m1.3.4.3.cmml"><msup id="alg1.l7.m1.3.4.3.2" xref="alg1.l7.m1.3.4.3.2.cmml"><mi id="alg1.l7.m1.3.4.3.2.2" xref="alg1.l7.m1.3.4.3.2.2.cmml">𝒘</mi><mrow id="alg1.l7.m1.2.2.1.3" xref="alg1.l7.m1.3.4.3.2.cmml"><mo stretchy="false" id="alg1.l7.m1.2.2.1.3.1" xref="alg1.l7.m1.3.4.3.2.cmml">(</mo><mi id="alg1.l7.m1.2.2.1.1" xref="alg1.l7.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l7.m1.2.2.1.3.2" xref="alg1.l7.m1.3.4.3.2.cmml">)</mo></mrow></msup><mo rspace="0.055em" id="alg1.l7.m1.3.4.3.1" xref="alg1.l7.m1.3.4.3.1.cmml">+</mo><mrow id="alg1.l7.m1.3.4.3.3" xref="alg1.l7.m1.3.4.3.3.cmml"><msub id="alg1.l7.m1.3.4.3.3.1" xref="alg1.l7.m1.3.4.3.3.1.cmml"><mo id="alg1.l7.m1.3.4.3.3.1.2" xref="alg1.l7.m1.3.4.3.3.1.2.cmml">∑</mo><mrow id="alg1.l7.m1.3.4.3.3.1.3" xref="alg1.l7.m1.3.4.3.3.1.3.cmml"><mi id="alg1.l7.m1.3.4.3.3.1.3.2" xref="alg1.l7.m1.3.4.3.3.1.3.2.cmml">i</mi><mo id="alg1.l7.m1.3.4.3.3.1.3.1" xref="alg1.l7.m1.3.4.3.3.1.3.1.cmml">∈</mo><msub id="alg1.l7.m1.3.4.3.3.1.3.3" xref="alg1.l7.m1.3.4.3.3.1.3.3.cmml"><mi id="alg1.l7.m1.3.4.3.3.1.3.3.2" xref="alg1.l7.m1.3.4.3.3.1.3.3.2.cmml">S</mi><mi id="alg1.l7.m1.3.4.3.3.1.3.3.3" xref="alg1.l7.m1.3.4.3.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="alg1.l7.m1.3.4.3.3.2" xref="alg1.l7.m1.3.4.3.3.2.cmml"><mfrac id="alg1.l7.m1.3.4.3.3.2.2" xref="alg1.l7.m1.3.4.3.3.2.2.cmml"><msub id="alg1.l7.m1.3.4.3.3.2.2.2" xref="alg1.l7.m1.3.4.3.3.2.2.2.cmml"><mi id="alg1.l7.m1.3.4.3.3.2.2.2.2" xref="alg1.l7.m1.3.4.3.3.2.2.2.2.cmml">n</mi><mi id="alg1.l7.m1.3.4.3.3.2.2.2.3" xref="alg1.l7.m1.3.4.3.3.2.2.2.3.cmml">i</mi></msub><mrow id="alg1.l7.m1.3.4.3.3.2.2.3" xref="alg1.l7.m1.3.4.3.3.2.2.3.cmml"><mstyle displaystyle="false" id="alg1.l7.m1.3.4.3.3.2.2.3.1" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.cmml"><msub id="alg1.l7.m1.3.4.3.3.2.2.3.1a" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.cmml"><mo id="alg1.l7.m1.3.4.3.3.2.2.3.1.2" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.2.cmml">∑</mo><mrow id="alg1.l7.m1.3.4.3.3.2.2.3.1.3" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.cmml"><mi id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.2" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.2.cmml">i</mi><mo id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.1" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.1.cmml">∈</mo><msub id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.cmml"><mi id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.2" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.2.cmml">S</mi><mi id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.3" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.3.cmml">t</mi></msub></mrow></msub></mstyle><msub id="alg1.l7.m1.3.4.3.3.2.2.3.2" xref="alg1.l7.m1.3.4.3.3.2.2.3.2.cmml"><mi id="alg1.l7.m1.3.4.3.3.2.2.3.2.2" xref="alg1.l7.m1.3.4.3.3.2.2.3.2.2.cmml">n</mi><mi id="alg1.l7.m1.3.4.3.3.2.2.3.2.3" xref="alg1.l7.m1.3.4.3.3.2.2.3.2.3.cmml">i</mi></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l7.m1.3.4.3.3.2.1" xref="alg1.l7.m1.3.4.3.3.2.1.cmml">​</mo><mi mathvariant="normal" id="alg1.l7.m1.3.4.3.3.2.3" xref="alg1.l7.m1.3.4.3.3.2.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.3.4.3.3.2.1a" xref="alg1.l7.m1.3.4.3.3.2.1.cmml">​</mo><msubsup id="alg1.l7.m1.3.4.3.3.2.4" xref="alg1.l7.m1.3.4.3.3.2.4.cmml"><mi id="alg1.l7.m1.3.4.3.3.2.4.2.2" xref="alg1.l7.m1.3.4.3.3.2.4.2.2.cmml">𝒘</mi><mi id="alg1.l7.m1.3.4.3.3.2.4.2.3" xref="alg1.l7.m1.3.4.3.3.2.4.2.3.cmml">i</mi><mrow id="alg1.l7.m1.3.3.1.3" xref="alg1.l7.m1.3.4.3.3.2.4.cmml"><mo stretchy="false" id="alg1.l7.m1.3.3.1.3.1" xref="alg1.l7.m1.3.4.3.3.2.4.cmml">(</mo><mi id="alg1.l7.m1.3.3.1.1" xref="alg1.l7.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l7.m1.3.3.1.3.2" xref="alg1.l7.m1.3.4.3.3.2.4.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.3b"><apply id="alg1.l7.m1.3.4.cmml" xref="alg1.l7.m1.3.4"><eq id="alg1.l7.m1.3.4.1.cmml" xref="alg1.l7.m1.3.4.1"></eq><apply id="alg1.l7.m1.3.4.2.cmml" xref="alg1.l7.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l7.m1.3.4.2.1.cmml" xref="alg1.l7.m1.3.4.2">superscript</csymbol><ci id="alg1.l7.m1.3.4.2.2.cmml" xref="alg1.l7.m1.3.4.2.2">𝒘</ci><apply id="alg1.l7.m1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1"><plus id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1"></plus><ci id="alg1.l7.m1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l7.m1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l7.m1.3.4.3.cmml" xref="alg1.l7.m1.3.4.3"><plus id="alg1.l7.m1.3.4.3.1.cmml" xref="alg1.l7.m1.3.4.3.1"></plus><apply id="alg1.l7.m1.3.4.3.2.cmml" xref="alg1.l7.m1.3.4.3.2"><csymbol cd="ambiguous" id="alg1.l7.m1.3.4.3.2.1.cmml" xref="alg1.l7.m1.3.4.3.2">superscript</csymbol><ci id="alg1.l7.m1.3.4.3.2.2.cmml" xref="alg1.l7.m1.3.4.3.2.2">𝒘</ci><ci id="alg1.l7.m1.2.2.1.1.cmml" xref="alg1.l7.m1.2.2.1.1">𝑡</ci></apply><apply id="alg1.l7.m1.3.4.3.3.cmml" xref="alg1.l7.m1.3.4.3.3"><apply id="alg1.l7.m1.3.4.3.3.1.cmml" xref="alg1.l7.m1.3.4.3.3.1"><csymbol cd="ambiguous" id="alg1.l7.m1.3.4.3.3.1.1.cmml" xref="alg1.l7.m1.3.4.3.3.1">subscript</csymbol><sum id="alg1.l7.m1.3.4.3.3.1.2.cmml" xref="alg1.l7.m1.3.4.3.3.1.2"></sum><apply id="alg1.l7.m1.3.4.3.3.1.3.cmml" xref="alg1.l7.m1.3.4.3.3.1.3"><in id="alg1.l7.m1.3.4.3.3.1.3.1.cmml" xref="alg1.l7.m1.3.4.3.3.1.3.1"></in><ci id="alg1.l7.m1.3.4.3.3.1.3.2.cmml" xref="alg1.l7.m1.3.4.3.3.1.3.2">𝑖</ci><apply id="alg1.l7.m1.3.4.3.3.1.3.3.cmml" xref="alg1.l7.m1.3.4.3.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l7.m1.3.4.3.3.1.3.3.1.cmml" xref="alg1.l7.m1.3.4.3.3.1.3.3">subscript</csymbol><ci id="alg1.l7.m1.3.4.3.3.1.3.3.2.cmml" xref="alg1.l7.m1.3.4.3.3.1.3.3.2">𝑆</ci><ci id="alg1.l7.m1.3.4.3.3.1.3.3.3.cmml" xref="alg1.l7.m1.3.4.3.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l7.m1.3.4.3.3.2.cmml" xref="alg1.l7.m1.3.4.3.3.2"><times id="alg1.l7.m1.3.4.3.3.2.1.cmml" xref="alg1.l7.m1.3.4.3.3.2.1"></times><apply id="alg1.l7.m1.3.4.3.3.2.2.cmml" xref="alg1.l7.m1.3.4.3.3.2.2"><divide id="alg1.l7.m1.3.4.3.3.2.2.1.cmml" xref="alg1.l7.m1.3.4.3.3.2.2"></divide><apply id="alg1.l7.m1.3.4.3.3.2.2.2.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.3.4.3.3.2.2.2.1.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.2">subscript</csymbol><ci id="alg1.l7.m1.3.4.3.3.2.2.2.2.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.2.2">𝑛</ci><ci id="alg1.l7.m1.3.4.3.3.2.2.2.3.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.2.3">𝑖</ci></apply><apply id="alg1.l7.m1.3.4.3.3.2.2.3.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3"><apply id="alg1.l7.m1.3.4.3.3.2.2.3.1.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.1"><csymbol cd="ambiguous" id="alg1.l7.m1.3.4.3.3.2.2.3.1.1.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.1">subscript</csymbol><sum id="alg1.l7.m1.3.4.3.3.2.2.3.1.2.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.2"></sum><apply id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3"><in id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.1.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.1"></in><ci id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.2.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.2">𝑖</ci><apply id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.1.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3">subscript</csymbol><ci id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.2.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.2">𝑆</ci><ci id="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.3.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l7.m1.3.4.3.3.2.2.3.2.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l7.m1.3.4.3.3.2.2.3.2.1.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.2">subscript</csymbol><ci id="alg1.l7.m1.3.4.3.3.2.2.3.2.2.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.2.2">𝑛</ci><ci id="alg1.l7.m1.3.4.3.3.2.2.3.2.3.cmml" xref="alg1.l7.m1.3.4.3.3.2.2.3.2.3">𝑖</ci></apply></apply></apply><ci id="alg1.l7.m1.3.4.3.3.2.3.cmml" xref="alg1.l7.m1.3.4.3.3.2.3">Δ</ci><apply id="alg1.l7.m1.3.4.3.3.2.4.cmml" xref="alg1.l7.m1.3.4.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l7.m1.3.4.3.3.2.4.1.cmml" xref="alg1.l7.m1.3.4.3.3.2.4">superscript</csymbol><apply id="alg1.l7.m1.3.4.3.3.2.4.2.cmml" xref="alg1.l7.m1.3.4.3.3.2.4"><csymbol cd="ambiguous" id="alg1.l7.m1.3.4.3.3.2.4.2.1.cmml" xref="alg1.l7.m1.3.4.3.3.2.4">subscript</csymbol><ci id="alg1.l7.m1.3.4.3.3.2.4.2.2.cmml" xref="alg1.l7.m1.3.4.3.3.2.4.2.2">𝒘</ci><ci id="alg1.l7.m1.3.4.3.3.2.4.2.3.cmml" xref="alg1.l7.m1.3.4.3.3.2.4.2.3">𝑖</ci></apply><ci id="alg1.l7.m1.3.3.1.1.cmml" xref="alg1.l7.m1.3.3.1.1">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.3c">{\bm{w}}^{(t+1)}={\bm{w}}^{(t)}+\sum_{i\in S_{t}}\frac{n_{i}}{\sum_{i\in S_{t}}n_{i}}\Delta{\bm{w}}_{i}^{(t)}</annotation></semantics></math>


</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     Server aggregates prototypes, for <math id="alg1.l8.m1.1" class="ltx_Math" alttext="c\in\mathcal{Y}" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">c</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><in id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></in><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑐</ci><ci id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">c\in\mathcal{Y}</annotation></semantics></math>:


</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>       <math id="alg1.l9.m1.8" class="ltx_Math" alttext="\bm{p}^{(t+1)}[c]=\sum_{i\in S_{t}}\frac{n_{i,c}}{\sum_{i\in S_{t}}n_{i,c}}\hat{\bm{p}}_{i}^{(t+1)}[c]" display="inline"><semantics id="alg1.l9.m1.8a"><mrow id="alg1.l9.m1.8.9" xref="alg1.l9.m1.8.9.cmml"><mrow id="alg1.l9.m1.8.9.2" xref="alg1.l9.m1.8.9.2.cmml"><msup id="alg1.l9.m1.8.9.2.2" xref="alg1.l9.m1.8.9.2.2.cmml"><mi id="alg1.l9.m1.8.9.2.2.2" xref="alg1.l9.m1.8.9.2.2.2.cmml">𝒑</mi><mrow id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo lspace="0em" rspace="0em" id="alg1.l9.m1.8.9.2.1" xref="alg1.l9.m1.8.9.2.1.cmml">​</mo><mrow id="alg1.l9.m1.8.9.2.3.2" xref="alg1.l9.m1.8.9.2.3.1.cmml"><mo stretchy="false" id="alg1.l9.m1.8.9.2.3.2.1" xref="alg1.l9.m1.8.9.2.3.1.1.cmml">[</mo><mi id="alg1.l9.m1.7.7" xref="alg1.l9.m1.7.7.cmml">c</mi><mo stretchy="false" id="alg1.l9.m1.8.9.2.3.2.2" xref="alg1.l9.m1.8.9.2.3.1.1.cmml">]</mo></mrow></mrow><mo rspace="0.111em" id="alg1.l9.m1.8.9.1" xref="alg1.l9.m1.8.9.1.cmml">=</mo><mrow id="alg1.l9.m1.8.9.3" xref="alg1.l9.m1.8.9.3.cmml"><msub id="alg1.l9.m1.8.9.3.1" xref="alg1.l9.m1.8.9.3.1.cmml"><mo id="alg1.l9.m1.8.9.3.1.2" xref="alg1.l9.m1.8.9.3.1.2.cmml">∑</mo><mrow id="alg1.l9.m1.8.9.3.1.3" xref="alg1.l9.m1.8.9.3.1.3.cmml"><mi id="alg1.l9.m1.8.9.3.1.3.2" xref="alg1.l9.m1.8.9.3.1.3.2.cmml">i</mi><mo id="alg1.l9.m1.8.9.3.1.3.1" xref="alg1.l9.m1.8.9.3.1.3.1.cmml">∈</mo><msub id="alg1.l9.m1.8.9.3.1.3.3" xref="alg1.l9.m1.8.9.3.1.3.3.cmml"><mi id="alg1.l9.m1.8.9.3.1.3.3.2" xref="alg1.l9.m1.8.9.3.1.3.3.2.cmml">S</mi><mi id="alg1.l9.m1.8.9.3.1.3.3.3" xref="alg1.l9.m1.8.9.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="alg1.l9.m1.8.9.3.2" xref="alg1.l9.m1.8.9.3.2.cmml"><mfrac id="alg1.l9.m1.5.5" xref="alg1.l9.m1.5.5.cmml"><msub id="alg1.l9.m1.3.3.2" xref="alg1.l9.m1.3.3.2.cmml"><mi id="alg1.l9.m1.3.3.2.4" xref="alg1.l9.m1.3.3.2.4.cmml">n</mi><mrow id="alg1.l9.m1.3.3.2.2.2.4" xref="alg1.l9.m1.3.3.2.2.2.3.cmml"><mi id="alg1.l9.m1.2.2.1.1.1.1" xref="alg1.l9.m1.2.2.1.1.1.1.cmml">i</mi><mo id="alg1.l9.m1.3.3.2.2.2.4.1" xref="alg1.l9.m1.3.3.2.2.2.3.cmml">,</mo><mi id="alg1.l9.m1.3.3.2.2.2.2" xref="alg1.l9.m1.3.3.2.2.2.2.cmml">c</mi></mrow></msub><mrow id="alg1.l9.m1.5.5.4" xref="alg1.l9.m1.5.5.4.cmml"><mstyle displaystyle="false" id="alg1.l9.m1.5.5.4.3" xref="alg1.l9.m1.5.5.4.3.cmml"><msub id="alg1.l9.m1.5.5.4.3a" xref="alg1.l9.m1.5.5.4.3.cmml"><mo id="alg1.l9.m1.5.5.4.3.2" xref="alg1.l9.m1.5.5.4.3.2.cmml">∑</mo><mrow id="alg1.l9.m1.5.5.4.3.3" xref="alg1.l9.m1.5.5.4.3.3.cmml"><mi id="alg1.l9.m1.5.5.4.3.3.2" xref="alg1.l9.m1.5.5.4.3.3.2.cmml">i</mi><mo id="alg1.l9.m1.5.5.4.3.3.1" xref="alg1.l9.m1.5.5.4.3.3.1.cmml">∈</mo><msub id="alg1.l9.m1.5.5.4.3.3.3" xref="alg1.l9.m1.5.5.4.3.3.3.cmml"><mi id="alg1.l9.m1.5.5.4.3.3.3.2" xref="alg1.l9.m1.5.5.4.3.3.3.2.cmml">S</mi><mi id="alg1.l9.m1.5.5.4.3.3.3.3" xref="alg1.l9.m1.5.5.4.3.3.3.3.cmml">t</mi></msub></mrow></msub></mstyle><msub id="alg1.l9.m1.5.5.4.4" xref="alg1.l9.m1.5.5.4.4.cmml"><mi id="alg1.l9.m1.5.5.4.4.2" xref="alg1.l9.m1.5.5.4.4.2.cmml">n</mi><mrow id="alg1.l9.m1.5.5.4.2.2.4" xref="alg1.l9.m1.5.5.4.2.2.3.cmml"><mi id="alg1.l9.m1.4.4.3.1.1.1" xref="alg1.l9.m1.4.4.3.1.1.1.cmml">i</mi><mo id="alg1.l9.m1.5.5.4.2.2.4.1" xref="alg1.l9.m1.5.5.4.2.2.3.cmml">,</mo><mi id="alg1.l9.m1.5.5.4.2.2.2" xref="alg1.l9.m1.5.5.4.2.2.2.cmml">c</mi></mrow></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l9.m1.8.9.3.2.1" xref="alg1.l9.m1.8.9.3.2.1.cmml">​</mo><msubsup id="alg1.l9.m1.8.9.3.2.2" xref="alg1.l9.m1.8.9.3.2.2.cmml"><mover accent="true" id="alg1.l9.m1.8.9.3.2.2.2.2" xref="alg1.l9.m1.8.9.3.2.2.2.2.cmml"><mi id="alg1.l9.m1.8.9.3.2.2.2.2.2" xref="alg1.l9.m1.8.9.3.2.2.2.2.2.cmml">𝒑</mi><mo id="alg1.l9.m1.8.9.3.2.2.2.2.1" xref="alg1.l9.m1.8.9.3.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l9.m1.8.9.3.2.2.2.3" xref="alg1.l9.m1.8.9.3.2.2.2.3.cmml">i</mi><mrow id="alg1.l9.m1.6.6.1.1" xref="alg1.l9.m1.6.6.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m1.6.6.1.1.2" xref="alg1.l9.m1.6.6.1.1.1.cmml">(</mo><mrow id="alg1.l9.m1.6.6.1.1.1" xref="alg1.l9.m1.6.6.1.1.1.cmml"><mi id="alg1.l9.m1.6.6.1.1.1.2" xref="alg1.l9.m1.6.6.1.1.1.2.cmml">t</mi><mo id="alg1.l9.m1.6.6.1.1.1.1" xref="alg1.l9.m1.6.6.1.1.1.1.cmml">+</mo><mn id="alg1.l9.m1.6.6.1.1.1.3" xref="alg1.l9.m1.6.6.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l9.m1.6.6.1.1.3" xref="alg1.l9.m1.6.6.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l9.m1.8.9.3.2.1a" xref="alg1.l9.m1.8.9.3.2.1.cmml">​</mo><mrow id="alg1.l9.m1.8.9.3.2.3.2" xref="alg1.l9.m1.8.9.3.2.3.1.cmml"><mo stretchy="false" id="alg1.l9.m1.8.9.3.2.3.2.1" xref="alg1.l9.m1.8.9.3.2.3.1.1.cmml">[</mo><mi id="alg1.l9.m1.8.8" xref="alg1.l9.m1.8.8.cmml">c</mi><mo stretchy="false" id="alg1.l9.m1.8.9.3.2.3.2.2" xref="alg1.l9.m1.8.9.3.2.3.1.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.8b"><apply id="alg1.l9.m1.8.9.cmml" xref="alg1.l9.m1.8.9"><eq id="alg1.l9.m1.8.9.1.cmml" xref="alg1.l9.m1.8.9.1"></eq><apply id="alg1.l9.m1.8.9.2.cmml" xref="alg1.l9.m1.8.9.2"><times id="alg1.l9.m1.8.9.2.1.cmml" xref="alg1.l9.m1.8.9.2.1"></times><apply id="alg1.l9.m1.8.9.2.2.cmml" xref="alg1.l9.m1.8.9.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.8.9.2.2.1.cmml" xref="alg1.l9.m1.8.9.2.2">superscript</csymbol><ci id="alg1.l9.m1.8.9.2.2.2.cmml" xref="alg1.l9.m1.8.9.2.2.2">𝒑</ci><apply id="alg1.l9.m1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1"><plus id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1"></plus><ci id="alg1.l9.m1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l9.m1.8.9.2.3.1.cmml" xref="alg1.l9.m1.8.9.2.3.2"><csymbol cd="latexml" id="alg1.l9.m1.8.9.2.3.1.1.cmml" xref="alg1.l9.m1.8.9.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l9.m1.7.7.cmml" xref="alg1.l9.m1.7.7">𝑐</ci></apply></apply><apply id="alg1.l9.m1.8.9.3.cmml" xref="alg1.l9.m1.8.9.3"><apply id="alg1.l9.m1.8.9.3.1.cmml" xref="alg1.l9.m1.8.9.3.1"><csymbol cd="ambiguous" id="alg1.l9.m1.8.9.3.1.1.cmml" xref="alg1.l9.m1.8.9.3.1">subscript</csymbol><sum id="alg1.l9.m1.8.9.3.1.2.cmml" xref="alg1.l9.m1.8.9.3.1.2"></sum><apply id="alg1.l9.m1.8.9.3.1.3.cmml" xref="alg1.l9.m1.8.9.3.1.3"><in id="alg1.l9.m1.8.9.3.1.3.1.cmml" xref="alg1.l9.m1.8.9.3.1.3.1"></in><ci id="alg1.l9.m1.8.9.3.1.3.2.cmml" xref="alg1.l9.m1.8.9.3.1.3.2">𝑖</ci><apply id="alg1.l9.m1.8.9.3.1.3.3.cmml" xref="alg1.l9.m1.8.9.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.8.9.3.1.3.3.1.cmml" xref="alg1.l9.m1.8.9.3.1.3.3">subscript</csymbol><ci id="alg1.l9.m1.8.9.3.1.3.3.2.cmml" xref="alg1.l9.m1.8.9.3.1.3.3.2">𝑆</ci><ci id="alg1.l9.m1.8.9.3.1.3.3.3.cmml" xref="alg1.l9.m1.8.9.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l9.m1.8.9.3.2.cmml" xref="alg1.l9.m1.8.9.3.2"><times id="alg1.l9.m1.8.9.3.2.1.cmml" xref="alg1.l9.m1.8.9.3.2.1"></times><apply id="alg1.l9.m1.5.5.cmml" xref="alg1.l9.m1.5.5"><divide id="alg1.l9.m1.5.5.5.cmml" xref="alg1.l9.m1.5.5"></divide><apply id="alg1.l9.m1.3.3.2.cmml" xref="alg1.l9.m1.3.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.3.3.2.3.cmml" xref="alg1.l9.m1.3.3.2">subscript</csymbol><ci id="alg1.l9.m1.3.3.2.4.cmml" xref="alg1.l9.m1.3.3.2.4">𝑛</ci><list id="alg1.l9.m1.3.3.2.2.2.3.cmml" xref="alg1.l9.m1.3.3.2.2.2.4"><ci id="alg1.l9.m1.2.2.1.1.1.1.cmml" xref="alg1.l9.m1.2.2.1.1.1.1">𝑖</ci><ci id="alg1.l9.m1.3.3.2.2.2.2.cmml" xref="alg1.l9.m1.3.3.2.2.2.2">𝑐</ci></list></apply><apply id="alg1.l9.m1.5.5.4.cmml" xref="alg1.l9.m1.5.5.4"><apply id="alg1.l9.m1.5.5.4.3.cmml" xref="alg1.l9.m1.5.5.4.3"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.4.3.1.cmml" xref="alg1.l9.m1.5.5.4.3">subscript</csymbol><sum id="alg1.l9.m1.5.5.4.3.2.cmml" xref="alg1.l9.m1.5.5.4.3.2"></sum><apply id="alg1.l9.m1.5.5.4.3.3.cmml" xref="alg1.l9.m1.5.5.4.3.3"><in id="alg1.l9.m1.5.5.4.3.3.1.cmml" xref="alg1.l9.m1.5.5.4.3.3.1"></in><ci id="alg1.l9.m1.5.5.4.3.3.2.cmml" xref="alg1.l9.m1.5.5.4.3.3.2">𝑖</ci><apply id="alg1.l9.m1.5.5.4.3.3.3.cmml" xref="alg1.l9.m1.5.5.4.3.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.4.3.3.3.1.cmml" xref="alg1.l9.m1.5.5.4.3.3.3">subscript</csymbol><ci id="alg1.l9.m1.5.5.4.3.3.3.2.cmml" xref="alg1.l9.m1.5.5.4.3.3.3.2">𝑆</ci><ci id="alg1.l9.m1.5.5.4.3.3.3.3.cmml" xref="alg1.l9.m1.5.5.4.3.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l9.m1.5.5.4.4.cmml" xref="alg1.l9.m1.5.5.4.4"><csymbol cd="ambiguous" id="alg1.l9.m1.5.5.4.4.1.cmml" xref="alg1.l9.m1.5.5.4.4">subscript</csymbol><ci id="alg1.l9.m1.5.5.4.4.2.cmml" xref="alg1.l9.m1.5.5.4.4.2">𝑛</ci><list id="alg1.l9.m1.5.5.4.2.2.3.cmml" xref="alg1.l9.m1.5.5.4.2.2.4"><ci id="alg1.l9.m1.4.4.3.1.1.1.cmml" xref="alg1.l9.m1.4.4.3.1.1.1">𝑖</ci><ci id="alg1.l9.m1.5.5.4.2.2.2.cmml" xref="alg1.l9.m1.5.5.4.2.2.2">𝑐</ci></list></apply></apply></apply><apply id="alg1.l9.m1.8.9.3.2.2.cmml" xref="alg1.l9.m1.8.9.3.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.8.9.3.2.2.1.cmml" xref="alg1.l9.m1.8.9.3.2.2">superscript</csymbol><apply id="alg1.l9.m1.8.9.3.2.2.2.cmml" xref="alg1.l9.m1.8.9.3.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.8.9.3.2.2.2.1.cmml" xref="alg1.l9.m1.8.9.3.2.2">subscript</csymbol><apply id="alg1.l9.m1.8.9.3.2.2.2.2.cmml" xref="alg1.l9.m1.8.9.3.2.2.2.2"><ci id="alg1.l9.m1.8.9.3.2.2.2.2.1.cmml" xref="alg1.l9.m1.8.9.3.2.2.2.2.1">^</ci><ci id="alg1.l9.m1.8.9.3.2.2.2.2.2.cmml" xref="alg1.l9.m1.8.9.3.2.2.2.2.2">𝒑</ci></apply><ci id="alg1.l9.m1.8.9.3.2.2.2.3.cmml" xref="alg1.l9.m1.8.9.3.2.2.2.3">𝑖</ci></apply><apply id="alg1.l9.m1.6.6.1.1.1.cmml" xref="alg1.l9.m1.6.6.1.1"><plus id="alg1.l9.m1.6.6.1.1.1.1.cmml" xref="alg1.l9.m1.6.6.1.1.1.1"></plus><ci id="alg1.l9.m1.6.6.1.1.1.2.cmml" xref="alg1.l9.m1.6.6.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l9.m1.6.6.1.1.1.3.cmml" xref="alg1.l9.m1.6.6.1.1.1.3">1</cn></apply></apply><apply id="alg1.l9.m1.8.9.3.2.3.1.cmml" xref="alg1.l9.m1.8.9.3.2.3.2"><csymbol cd="latexml" id="alg1.l9.m1.8.9.3.2.3.1.1.cmml" xref="alg1.l9.m1.8.9.3.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l9.m1.8.8.cmml" xref="alg1.l9.m1.8.8">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.8c">\bm{p}^{(t+1)}[c]=\sum_{i\in S_{t}}\frac{n_{i,c}}{\sum_{i\in S_{t}}n_{i,c}}\hat{\bm{p}}_{i}^{(t+1)}[c]</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">for</span>

</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.12" class="ltx_p ltx_figure_panel"><span id="alg1.12.1" class="ltx_text ltx_font_bold">LocalTraining</span>(<math id="alg1.10.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.10.m1.1a"><mi id="alg1.10.m1.1.1" xref="alg1.10.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.10.m1.1b"><ci id="alg1.10.m1.1.1.cmml" xref="alg1.10.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m1.1c">i</annotation></semantics></math>, <math id="alg1.11.m2.1" class="ltx_Math" alttext="{\bm{w}}^{(t)}" display="inline"><semantics id="alg1.11.m2.1a"><msup id="alg1.11.m2.1.2" xref="alg1.11.m2.1.2.cmml"><mi id="alg1.11.m2.1.2.2" xref="alg1.11.m2.1.2.2.cmml">𝒘</mi><mrow id="alg1.11.m2.1.1.1.3" xref="alg1.11.m2.1.2.cmml"><mo stretchy="false" id="alg1.11.m2.1.1.1.3.1" xref="alg1.11.m2.1.2.cmml">(</mo><mi id="alg1.11.m2.1.1.1.1" xref="alg1.11.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.11.m2.1.1.1.3.2" xref="alg1.11.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.11.m2.1b"><apply id="alg1.11.m2.1.2.cmml" xref="alg1.11.m2.1.2"><csymbol cd="ambiguous" id="alg1.11.m2.1.2.1.cmml" xref="alg1.11.m2.1.2">superscript</csymbol><ci id="alg1.11.m2.1.2.2.cmml" xref="alg1.11.m2.1.2.2">𝒘</ci><ci id="alg1.11.m2.1.1.1.1.cmml" xref="alg1.11.m2.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m2.1c">{\bm{w}}^{(t)}</annotation></semantics></math>, <math id="alg1.12.m3.1" class="ltx_Math" alttext="\bm{p}^{(t)}" display="inline"><semantics id="alg1.12.m3.1a"><msup id="alg1.12.m3.1.2" xref="alg1.12.m3.1.2.cmml"><mi id="alg1.12.m3.1.2.2" xref="alg1.12.m3.1.2.2.cmml">𝒑</mi><mrow id="alg1.12.m3.1.1.1.3" xref="alg1.12.m3.1.2.cmml"><mo stretchy="false" id="alg1.12.m3.1.1.1.3.1" xref="alg1.12.m3.1.2.cmml">(</mo><mi id="alg1.12.m3.1.1.1.1" xref="alg1.12.m3.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.12.m3.1.1.1.3.2" xref="alg1.12.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.12.m3.1b"><apply id="alg1.12.m3.1.2.cmml" xref="alg1.12.m3.1.2"><csymbol cd="ambiguous" id="alg1.12.m3.1.2.1.cmml" xref="alg1.12.m3.1.2">superscript</csymbol><ci id="alg1.12.m3.1.2.2.cmml" xref="alg1.12.m3.1.2.2">𝒑</ci><ci id="alg1.12.m3.1.1.1.1.cmml" xref="alg1.12.m3.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.m3.1c">\bm{p}^{(t)}</annotation></semantics></math>):</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.16" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1a.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1a.2" class="ltx_text ltx_font_bold">for</span> <span id="alg1.l1a.3" class="ltx_text ltx_font_italic">local epoch</span> <math id="alg1.l1a.m1.4" class="ltx_Math" alttext="e=0,1,...,E-1" display="inline"><semantics id="alg1.l1a.m1.4a"><mrow id="alg1.l1a.m1.4.4" xref="alg1.l1a.m1.4.4.cmml"><mi id="alg1.l1a.m1.4.4.3" xref="alg1.l1a.m1.4.4.3.cmml">e</mi><mo id="alg1.l1a.m1.4.4.2" xref="alg1.l1a.m1.4.4.2.cmml">=</mo><mrow id="alg1.l1a.m1.4.4.1.1" xref="alg1.l1a.m1.4.4.1.2.cmml"><mn id="alg1.l1a.m1.1.1" xref="alg1.l1a.m1.1.1.cmml">0</mn><mo id="alg1.l1a.m1.4.4.1.1.2" xref="alg1.l1a.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l1a.m1.2.2" xref="alg1.l1a.m1.2.2.cmml">1</mn><mo id="alg1.l1a.m1.4.4.1.1.3" xref="alg1.l1a.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l1a.m1.3.3" xref="alg1.l1a.m1.3.3.cmml">…</mi><mo id="alg1.l1a.m1.4.4.1.1.4" xref="alg1.l1a.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l1a.m1.4.4.1.1.1" xref="alg1.l1a.m1.4.4.1.1.1.cmml"><mi id="alg1.l1a.m1.4.4.1.1.1.2" xref="alg1.l1a.m1.4.4.1.1.1.2.cmml">E</mi><mo id="alg1.l1a.m1.4.4.1.1.1.1" xref="alg1.l1a.m1.4.4.1.1.1.1.cmml">−</mo><mn id="alg1.l1a.m1.4.4.1.1.1.3" xref="alg1.l1a.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1a.m1.4b"><apply id="alg1.l1a.m1.4.4.cmml" xref="alg1.l1a.m1.4.4"><eq id="alg1.l1a.m1.4.4.2.cmml" xref="alg1.l1a.m1.4.4.2"></eq><ci id="alg1.l1a.m1.4.4.3.cmml" xref="alg1.l1a.m1.4.4.3">𝑒</ci><list id="alg1.l1a.m1.4.4.1.2.cmml" xref="alg1.l1a.m1.4.4.1.1"><cn type="integer" id="alg1.l1a.m1.1.1.cmml" xref="alg1.l1a.m1.1.1">0</cn><cn type="integer" id="alg1.l1a.m1.2.2.cmml" xref="alg1.l1a.m1.2.2">1</cn><ci id="alg1.l1a.m1.3.3.cmml" xref="alg1.l1a.m1.3.3">…</ci><apply id="alg1.l1a.m1.4.4.1.1.1.cmml" xref="alg1.l1a.m1.4.4.1.1.1"><minus id="alg1.l1a.m1.4.4.1.1.1.1.cmml" xref="alg1.l1a.m1.4.4.1.1.1.1"></minus><ci id="alg1.l1a.m1.4.4.1.1.1.2.cmml" xref="alg1.l1a.m1.4.4.1.1.1.2">𝐸</ci><cn type="integer" id="alg1.l1a.m1.4.4.1.1.1.3.cmml" xref="alg1.l1a.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1a.m1.4c">e=0,1,...,E-1</annotation></semantics></math> <span id="alg1.l1a.4" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l2a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2a.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>     <span id="alg1.l2a.2" class="ltx_text ltx_font_bold">for</span> <span id="alg1.l2a.3" class="ltx_text ltx_font_italic">mini-batch</span> <math id="alg1.l2a.m1.1" class="ltx_Math" alttext="\xi_{i}\in\mathcal{D}_{i}" display="inline"><semantics id="alg1.l2a.m1.1a"><mrow id="alg1.l2a.m1.1.1" xref="alg1.l2a.m1.1.1.cmml"><msub id="alg1.l2a.m1.1.1.2" xref="alg1.l2a.m1.1.1.2.cmml"><mi id="alg1.l2a.m1.1.1.2.2" xref="alg1.l2a.m1.1.1.2.2.cmml">ξ</mi><mi id="alg1.l2a.m1.1.1.2.3" xref="alg1.l2a.m1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l2a.m1.1.1.1" xref="alg1.l2a.m1.1.1.1.cmml">∈</mo><msub id="alg1.l2a.m1.1.1.3" xref="alg1.l2a.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l2a.m1.1.1.3.2" xref="alg1.l2a.m1.1.1.3.2.cmml">𝒟</mi><mi id="alg1.l2a.m1.1.1.3.3" xref="alg1.l2a.m1.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2a.m1.1b"><apply id="alg1.l2a.m1.1.1.cmml" xref="alg1.l2a.m1.1.1"><in id="alg1.l2a.m1.1.1.1.cmml" xref="alg1.l2a.m1.1.1.1"></in><apply id="alg1.l2a.m1.1.1.2.cmml" xref="alg1.l2a.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2a.m1.1.1.2.1.cmml" xref="alg1.l2a.m1.1.1.2">subscript</csymbol><ci id="alg1.l2a.m1.1.1.2.2.cmml" xref="alg1.l2a.m1.1.1.2.2">𝜉</ci><ci id="alg1.l2a.m1.1.1.2.3.cmml" xref="alg1.l2a.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l2a.m1.1.1.3.cmml" xref="alg1.l2a.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l2a.m1.1.1.3.1.cmml" xref="alg1.l2a.m1.1.1.3">subscript</csymbol><ci id="alg1.l2a.m1.1.1.3.2.cmml" xref="alg1.l2a.m1.1.1.3.2">𝒟</ci><ci id="alg1.l2a.m1.1.1.3.3.cmml" xref="alg1.l2a.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2a.m1.1c">\xi_{i}\in\mathcal{D}_{i}</annotation></semantics></math> <span id="alg1.l2a.4" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l3a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3a.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>         Local update: <math id="alg1.l3a.m1.4" class="ltx_Math" alttext="{\bm{w}}_{i}^{(t)}\leftarrow{\bm{w}}_{i}^{(t)}-\eta\nabla_{\bm{w}}L_{i}(\bm{w}_{i}^{(t)})" display="inline"><semantics id="alg1.l3a.m1.4a"><mrow id="alg1.l3a.m1.4.4" xref="alg1.l3a.m1.4.4.cmml"><msubsup id="alg1.l3a.m1.4.4.3" xref="alg1.l3a.m1.4.4.3.cmml"><mi id="alg1.l3a.m1.4.4.3.2.2" xref="alg1.l3a.m1.4.4.3.2.2.cmml">𝒘</mi><mi id="alg1.l3a.m1.4.4.3.2.3" xref="alg1.l3a.m1.4.4.3.2.3.cmml">i</mi><mrow id="alg1.l3a.m1.1.1.1.3" xref="alg1.l3a.m1.4.4.3.cmml"><mo stretchy="false" id="alg1.l3a.m1.1.1.1.3.1" xref="alg1.l3a.m1.4.4.3.cmml">(</mo><mi id="alg1.l3a.m1.1.1.1.1" xref="alg1.l3a.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l3a.m1.1.1.1.3.2" xref="alg1.l3a.m1.4.4.3.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l3a.m1.4.4.2" xref="alg1.l3a.m1.4.4.2.cmml">←</mo><mrow id="alg1.l3a.m1.4.4.1" xref="alg1.l3a.m1.4.4.1.cmml"><msubsup id="alg1.l3a.m1.4.4.1.3" xref="alg1.l3a.m1.4.4.1.3.cmml"><mi id="alg1.l3a.m1.4.4.1.3.2.2" xref="alg1.l3a.m1.4.4.1.3.2.2.cmml">𝒘</mi><mi id="alg1.l3a.m1.4.4.1.3.2.3" xref="alg1.l3a.m1.4.4.1.3.2.3.cmml">i</mi><mrow id="alg1.l3a.m1.2.2.1.3" xref="alg1.l3a.m1.4.4.1.3.cmml"><mo stretchy="false" id="alg1.l3a.m1.2.2.1.3.1" xref="alg1.l3a.m1.4.4.1.3.cmml">(</mo><mi id="alg1.l3a.m1.2.2.1.1" xref="alg1.l3a.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l3a.m1.2.2.1.3.2" xref="alg1.l3a.m1.4.4.1.3.cmml">)</mo></mrow></msubsup><mo id="alg1.l3a.m1.4.4.1.2" xref="alg1.l3a.m1.4.4.1.2.cmml">−</mo><mrow id="alg1.l3a.m1.4.4.1.1" xref="alg1.l3a.m1.4.4.1.1.cmml"><mi id="alg1.l3a.m1.4.4.1.1.3" xref="alg1.l3a.m1.4.4.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l3a.m1.4.4.1.1.2" xref="alg1.l3a.m1.4.4.1.1.2.cmml">​</mo><mrow id="alg1.l3a.m1.4.4.1.1.4" xref="alg1.l3a.m1.4.4.1.1.4.cmml"><msub id="alg1.l3a.m1.4.4.1.1.4.1" xref="alg1.l3a.m1.4.4.1.1.4.1.cmml"><mo rspace="0.167em" id="alg1.l3a.m1.4.4.1.1.4.1.2" xref="alg1.l3a.m1.4.4.1.1.4.1.2.cmml">∇</mo><mi id="alg1.l3a.m1.4.4.1.1.4.1.3" xref="alg1.l3a.m1.4.4.1.1.4.1.3.cmml">𝒘</mi></msub><msub id="alg1.l3a.m1.4.4.1.1.4.2" xref="alg1.l3a.m1.4.4.1.1.4.2.cmml"><mi id="alg1.l3a.m1.4.4.1.1.4.2.2" xref="alg1.l3a.m1.4.4.1.1.4.2.2.cmml">L</mi><mi id="alg1.l3a.m1.4.4.1.1.4.2.3" xref="alg1.l3a.m1.4.4.1.1.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l3a.m1.4.4.1.1.2a" xref="alg1.l3a.m1.4.4.1.1.2.cmml">​</mo><mrow id="alg1.l3a.m1.4.4.1.1.1.1" xref="alg1.l3a.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l3a.m1.4.4.1.1.1.1.2" xref="alg1.l3a.m1.4.4.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l3a.m1.4.4.1.1.1.1.1" xref="alg1.l3a.m1.4.4.1.1.1.1.1.cmml"><mi id="alg1.l3a.m1.4.4.1.1.1.1.1.2.2" xref="alg1.l3a.m1.4.4.1.1.1.1.1.2.2.cmml">𝒘</mi><mi id="alg1.l3a.m1.4.4.1.1.1.1.1.2.3" xref="alg1.l3a.m1.4.4.1.1.1.1.1.2.3.cmml">i</mi><mrow id="alg1.l3a.m1.3.3.1.3" xref="alg1.l3a.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l3a.m1.3.3.1.3.1" xref="alg1.l3a.m1.4.4.1.1.1.1.1.cmml">(</mo><mi id="alg1.l3a.m1.3.3.1.1" xref="alg1.l3a.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l3a.m1.3.3.1.3.2" xref="alg1.l3a.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="alg1.l3a.m1.4.4.1.1.1.1.3" xref="alg1.l3a.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3a.m1.4b"><apply id="alg1.l3a.m1.4.4.cmml" xref="alg1.l3a.m1.4.4"><ci id="alg1.l3a.m1.4.4.2.cmml" xref="alg1.l3a.m1.4.4.2">←</ci><apply id="alg1.l3a.m1.4.4.3.cmml" xref="alg1.l3a.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l3a.m1.4.4.3.1.cmml" xref="alg1.l3a.m1.4.4.3">superscript</csymbol><apply id="alg1.l3a.m1.4.4.3.2.cmml" xref="alg1.l3a.m1.4.4.3"><csymbol cd="ambiguous" id="alg1.l3a.m1.4.4.3.2.1.cmml" xref="alg1.l3a.m1.4.4.3">subscript</csymbol><ci id="alg1.l3a.m1.4.4.3.2.2.cmml" xref="alg1.l3a.m1.4.4.3.2.2">𝒘</ci><ci id="alg1.l3a.m1.4.4.3.2.3.cmml" xref="alg1.l3a.m1.4.4.3.2.3">𝑖</ci></apply><ci id="alg1.l3a.m1.1.1.1.1.cmml" xref="alg1.l3a.m1.1.1.1.1">𝑡</ci></apply><apply id="alg1.l3a.m1.4.4.1.cmml" xref="alg1.l3a.m1.4.4.1"><minus id="alg1.l3a.m1.4.4.1.2.cmml" xref="alg1.l3a.m1.4.4.1.2"></minus><apply id="alg1.l3a.m1.4.4.1.3.cmml" xref="alg1.l3a.m1.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l3a.m1.4.4.1.3.1.cmml" xref="alg1.l3a.m1.4.4.1.3">superscript</csymbol><apply id="alg1.l3a.m1.4.4.1.3.2.cmml" xref="alg1.l3a.m1.4.4.1.3"><csymbol cd="ambiguous" id="alg1.l3a.m1.4.4.1.3.2.1.cmml" xref="alg1.l3a.m1.4.4.1.3">subscript</csymbol><ci id="alg1.l3a.m1.4.4.1.3.2.2.cmml" xref="alg1.l3a.m1.4.4.1.3.2.2">𝒘</ci><ci id="alg1.l3a.m1.4.4.1.3.2.3.cmml" xref="alg1.l3a.m1.4.4.1.3.2.3">𝑖</ci></apply><ci id="alg1.l3a.m1.2.2.1.1.cmml" xref="alg1.l3a.m1.2.2.1.1">𝑡</ci></apply><apply id="alg1.l3a.m1.4.4.1.1.cmml" xref="alg1.l3a.m1.4.4.1.1"><times id="alg1.l3a.m1.4.4.1.1.2.cmml" xref="alg1.l3a.m1.4.4.1.1.2"></times><ci id="alg1.l3a.m1.4.4.1.1.3.cmml" xref="alg1.l3a.m1.4.4.1.1.3">𝜂</ci><apply id="alg1.l3a.m1.4.4.1.1.4.cmml" xref="alg1.l3a.m1.4.4.1.1.4"><apply id="alg1.l3a.m1.4.4.1.1.4.1.cmml" xref="alg1.l3a.m1.4.4.1.1.4.1"><csymbol cd="ambiguous" id="alg1.l3a.m1.4.4.1.1.4.1.1.cmml" xref="alg1.l3a.m1.4.4.1.1.4.1">subscript</csymbol><ci id="alg1.l3a.m1.4.4.1.1.4.1.2.cmml" xref="alg1.l3a.m1.4.4.1.1.4.1.2">∇</ci><ci id="alg1.l3a.m1.4.4.1.1.4.1.3.cmml" xref="alg1.l3a.m1.4.4.1.1.4.1.3">𝒘</ci></apply><apply id="alg1.l3a.m1.4.4.1.1.4.2.cmml" xref="alg1.l3a.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="alg1.l3a.m1.4.4.1.1.4.2.1.cmml" xref="alg1.l3a.m1.4.4.1.1.4.2">subscript</csymbol><ci id="alg1.l3a.m1.4.4.1.1.4.2.2.cmml" xref="alg1.l3a.m1.4.4.1.1.4.2.2">𝐿</ci><ci id="alg1.l3a.m1.4.4.1.1.4.2.3.cmml" xref="alg1.l3a.m1.4.4.1.1.4.2.3">𝑖</ci></apply></apply><apply id="alg1.l3a.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l3a.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3a.m1.4.4.1.1.1.1.1.1.cmml" xref="alg1.l3a.m1.4.4.1.1.1.1">superscript</csymbol><apply id="alg1.l3a.m1.4.4.1.1.1.1.1.2.cmml" xref="alg1.l3a.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l3a.m1.4.4.1.1.1.1.1.2.1.cmml" xref="alg1.l3a.m1.4.4.1.1.1.1">subscript</csymbol><ci id="alg1.l3a.m1.4.4.1.1.1.1.1.2.2.cmml" xref="alg1.l3a.m1.4.4.1.1.1.1.1.2.2">𝒘</ci><ci id="alg1.l3a.m1.4.4.1.1.1.1.1.2.3.cmml" xref="alg1.l3a.m1.4.4.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l3a.m1.3.3.1.1.cmml" xref="alg1.l3a.m1.3.3.1.1">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3a.m1.4c">{\bm{w}}_{i}^{(t)}\leftarrow{\bm{w}}_{i}^{(t)}-\eta\nabla_{\bm{w}}L_{i}(\bm{w}_{i}^{(t)})</annotation></semantics></math>

</div>
<div id="alg1.l4a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4a.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l4a.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l5a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5a.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg1.l5a.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l5a.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l6a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6a.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>Obtain local feature prototypes: <math id="alg1.l6a.m1.2" class="ltx_Math" alttext="\hat{\bm{p}}_{i}^{(t+1)}[c]" display="inline"><semantics id="alg1.l6a.m1.2a"><mrow id="alg1.l6a.m1.2.3" xref="alg1.l6a.m1.2.3.cmml"><msubsup id="alg1.l6a.m1.2.3.2" xref="alg1.l6a.m1.2.3.2.cmml"><mover accent="true" id="alg1.l6a.m1.2.3.2.2.2" xref="alg1.l6a.m1.2.3.2.2.2.cmml"><mi id="alg1.l6a.m1.2.3.2.2.2.2" xref="alg1.l6a.m1.2.3.2.2.2.2.cmml">𝒑</mi><mo id="alg1.l6a.m1.2.3.2.2.2.1" xref="alg1.l6a.m1.2.3.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l6a.m1.2.3.2.2.3" xref="alg1.l6a.m1.2.3.2.2.3.cmml">i</mi><mrow id="alg1.l6a.m1.1.1.1.1" xref="alg1.l6a.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6a.m1.1.1.1.1.2" xref="alg1.l6a.m1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6a.m1.1.1.1.1.1" xref="alg1.l6a.m1.1.1.1.1.1.cmml"><mi id="alg1.l6a.m1.1.1.1.1.1.2" xref="alg1.l6a.m1.1.1.1.1.1.2.cmml">t</mi><mo id="alg1.l6a.m1.1.1.1.1.1.1" xref="alg1.l6a.m1.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l6a.m1.1.1.1.1.1.3" xref="alg1.l6a.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l6a.m1.1.1.1.1.3" xref="alg1.l6a.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="alg1.l6a.m1.2.3.1" xref="alg1.l6a.m1.2.3.1.cmml">​</mo><mrow id="alg1.l6a.m1.2.3.3.2" xref="alg1.l6a.m1.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l6a.m1.2.3.3.2.1" xref="alg1.l6a.m1.2.3.3.1.1.cmml">[</mo><mi id="alg1.l6a.m1.2.2" xref="alg1.l6a.m1.2.2.cmml">c</mi><mo stretchy="false" id="alg1.l6a.m1.2.3.3.2.2" xref="alg1.l6a.m1.2.3.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6a.m1.2b"><apply id="alg1.l6a.m1.2.3.cmml" xref="alg1.l6a.m1.2.3"><times id="alg1.l6a.m1.2.3.1.cmml" xref="alg1.l6a.m1.2.3.1"></times><apply id="alg1.l6a.m1.2.3.2.cmml" xref="alg1.l6a.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l6a.m1.2.3.2.1.cmml" xref="alg1.l6a.m1.2.3.2">superscript</csymbol><apply id="alg1.l6a.m1.2.3.2.2.cmml" xref="alg1.l6a.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l6a.m1.2.3.2.2.1.cmml" xref="alg1.l6a.m1.2.3.2">subscript</csymbol><apply id="alg1.l6a.m1.2.3.2.2.2.cmml" xref="alg1.l6a.m1.2.3.2.2.2"><ci id="alg1.l6a.m1.2.3.2.2.2.1.cmml" xref="alg1.l6a.m1.2.3.2.2.2.1">^</ci><ci id="alg1.l6a.m1.2.3.2.2.2.2.cmml" xref="alg1.l6a.m1.2.3.2.2.2.2">𝒑</ci></apply><ci id="alg1.l6a.m1.2.3.2.2.3.cmml" xref="alg1.l6a.m1.2.3.2.2.3">𝑖</ci></apply><apply id="alg1.l6a.m1.1.1.1.1.1.cmml" xref="alg1.l6a.m1.1.1.1.1"><plus id="alg1.l6a.m1.1.1.1.1.1.1.cmml" xref="alg1.l6a.m1.1.1.1.1.1.1"></plus><ci id="alg1.l6a.m1.1.1.1.1.1.2.cmml" xref="alg1.l6a.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l6a.m1.1.1.1.1.1.3.cmml" xref="alg1.l6a.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="alg1.l6a.m1.2.3.3.1.cmml" xref="alg1.l6a.m1.2.3.3.2"><csymbol cd="latexml" id="alg1.l6a.m1.2.3.3.1.1.cmml" xref="alg1.l6a.m1.2.3.3.2.1">delimited-[]</csymbol><ci id="alg1.l6a.m1.2.2.cmml" xref="alg1.l6a.m1.2.2">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6a.m1.2c">\hat{\bm{p}}_{i}^{(t+1)}[c]</annotation></semantics></math>, <math id="alg1.l6a.m2.1" class="ltx_Math" alttext="c\in\mathcal{Y}_{i}" display="inline"><semantics id="alg1.l6a.m2.1a"><mrow id="alg1.l6a.m2.1.1" xref="alg1.l6a.m2.1.1.cmml"><mi id="alg1.l6a.m2.1.1.2" xref="alg1.l6a.m2.1.1.2.cmml">c</mi><mo id="alg1.l6a.m2.1.1.1" xref="alg1.l6a.m2.1.1.1.cmml">∈</mo><msub id="alg1.l6a.m2.1.1.3" xref="alg1.l6a.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6a.m2.1.1.3.2" xref="alg1.l6a.m2.1.1.3.2.cmml">𝒴</mi><mi id="alg1.l6a.m2.1.1.3.3" xref="alg1.l6a.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6a.m2.1b"><apply id="alg1.l6a.m2.1.1.cmml" xref="alg1.l6a.m2.1.1"><in id="alg1.l6a.m2.1.1.1.cmml" xref="alg1.l6a.m2.1.1.1"></in><ci id="alg1.l6a.m2.1.1.2.cmml" xref="alg1.l6a.m2.1.1.2">𝑐</ci><apply id="alg1.l6a.m2.1.1.3.cmml" xref="alg1.l6a.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l6a.m2.1.1.3.1.cmml" xref="alg1.l6a.m2.1.1.3">subscript</csymbol><ci id="alg1.l6a.m2.1.1.3.2.cmml" xref="alg1.l6a.m2.1.1.3.2">𝒴</ci><ci id="alg1.l6a.m2.1.1.3.3.cmml" xref="alg1.l6a.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6a.m2.1c">c\in\mathcal{Y}_{i}</annotation></semantics></math>


</div>
<div id="alg1.l7a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7a.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span><span id="alg1.l7a.2" class="ltx_text ltx_font_bold">return</span> <math id="alg1.l7a.m1.3" class="ltx_Math" alttext="\Delta{\bm{w}}_{i}^{(t)}:={\bm{w}}_{i}^{(t)}-{\bm{w}}^{(t)}" display="inline"><semantics id="alg1.l7a.m1.3a"><mrow id="alg1.l7a.m1.3.4" xref="alg1.l7a.m1.3.4.cmml"><mrow id="alg1.l7a.m1.3.4.2" xref="alg1.l7a.m1.3.4.2.cmml"><mi mathvariant="normal" id="alg1.l7a.m1.3.4.2.2" xref="alg1.l7a.m1.3.4.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="alg1.l7a.m1.3.4.2.1" xref="alg1.l7a.m1.3.4.2.1.cmml">​</mo><msubsup id="alg1.l7a.m1.3.4.2.3" xref="alg1.l7a.m1.3.4.2.3.cmml"><mi id="alg1.l7a.m1.3.4.2.3.2.2" xref="alg1.l7a.m1.3.4.2.3.2.2.cmml">𝒘</mi><mi id="alg1.l7a.m1.3.4.2.3.2.3" xref="alg1.l7a.m1.3.4.2.3.2.3.cmml">i</mi><mrow id="alg1.l7a.m1.1.1.1.3" xref="alg1.l7a.m1.3.4.2.3.cmml"><mo stretchy="false" id="alg1.l7a.m1.1.1.1.3.1" xref="alg1.l7a.m1.3.4.2.3.cmml">(</mo><mi id="alg1.l7a.m1.1.1.1.1" xref="alg1.l7a.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l7a.m1.1.1.1.3.2" xref="alg1.l7a.m1.3.4.2.3.cmml">)</mo></mrow></msubsup></mrow><mo lspace="0.278em" rspace="0.278em" id="alg1.l7a.m1.3.4.1" xref="alg1.l7a.m1.3.4.1.cmml">:=</mo><mrow id="alg1.l7a.m1.3.4.3" xref="alg1.l7a.m1.3.4.3.cmml"><msubsup id="alg1.l7a.m1.3.4.3.2" xref="alg1.l7a.m1.3.4.3.2.cmml"><mi id="alg1.l7a.m1.3.4.3.2.2.2" xref="alg1.l7a.m1.3.4.3.2.2.2.cmml">𝒘</mi><mi id="alg1.l7a.m1.3.4.3.2.2.3" xref="alg1.l7a.m1.3.4.3.2.2.3.cmml">i</mi><mrow id="alg1.l7a.m1.2.2.1.3" xref="alg1.l7a.m1.3.4.3.2.cmml"><mo stretchy="false" id="alg1.l7a.m1.2.2.1.3.1" xref="alg1.l7a.m1.3.4.3.2.cmml">(</mo><mi id="alg1.l7a.m1.2.2.1.1" xref="alg1.l7a.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l7a.m1.2.2.1.3.2" xref="alg1.l7a.m1.3.4.3.2.cmml">)</mo></mrow></msubsup><mo id="alg1.l7a.m1.3.4.3.1" xref="alg1.l7a.m1.3.4.3.1.cmml">−</mo><msup id="alg1.l7a.m1.3.4.3.3" xref="alg1.l7a.m1.3.4.3.3.cmml"><mi id="alg1.l7a.m1.3.4.3.3.2" xref="alg1.l7a.m1.3.4.3.3.2.cmml">𝒘</mi><mrow id="alg1.l7a.m1.3.3.1.3" xref="alg1.l7a.m1.3.4.3.3.cmml"><mo stretchy="false" id="alg1.l7a.m1.3.3.1.3.1" xref="alg1.l7a.m1.3.4.3.3.cmml">(</mo><mi id="alg1.l7a.m1.3.3.1.1" xref="alg1.l7a.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="alg1.l7a.m1.3.3.1.3.2" xref="alg1.l7a.m1.3.4.3.3.cmml">)</mo></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7a.m1.3b"><apply id="alg1.l7a.m1.3.4.cmml" xref="alg1.l7a.m1.3.4"><csymbol cd="latexml" id="alg1.l7a.m1.3.4.1.cmml" xref="alg1.l7a.m1.3.4.1">assign</csymbol><apply id="alg1.l7a.m1.3.4.2.cmml" xref="alg1.l7a.m1.3.4.2"><times id="alg1.l7a.m1.3.4.2.1.cmml" xref="alg1.l7a.m1.3.4.2.1"></times><ci id="alg1.l7a.m1.3.4.2.2.cmml" xref="alg1.l7a.m1.3.4.2.2">Δ</ci><apply id="alg1.l7a.m1.3.4.2.3.cmml" xref="alg1.l7a.m1.3.4.2.3"><csymbol cd="ambiguous" id="alg1.l7a.m1.3.4.2.3.1.cmml" xref="alg1.l7a.m1.3.4.2.3">superscript</csymbol><apply id="alg1.l7a.m1.3.4.2.3.2.cmml" xref="alg1.l7a.m1.3.4.2.3"><csymbol cd="ambiguous" id="alg1.l7a.m1.3.4.2.3.2.1.cmml" xref="alg1.l7a.m1.3.4.2.3">subscript</csymbol><ci id="alg1.l7a.m1.3.4.2.3.2.2.cmml" xref="alg1.l7a.m1.3.4.2.3.2.2">𝒘</ci><ci id="alg1.l7a.m1.3.4.2.3.2.3.cmml" xref="alg1.l7a.m1.3.4.2.3.2.3">𝑖</ci></apply><ci id="alg1.l7a.m1.1.1.1.1.cmml" xref="alg1.l7a.m1.1.1.1.1">𝑡</ci></apply></apply><apply id="alg1.l7a.m1.3.4.3.cmml" xref="alg1.l7a.m1.3.4.3"><minus id="alg1.l7a.m1.3.4.3.1.cmml" xref="alg1.l7a.m1.3.4.3.1"></minus><apply id="alg1.l7a.m1.3.4.3.2.cmml" xref="alg1.l7a.m1.3.4.3.2"><csymbol cd="ambiguous" id="alg1.l7a.m1.3.4.3.2.1.cmml" xref="alg1.l7a.m1.3.4.3.2">superscript</csymbol><apply id="alg1.l7a.m1.3.4.3.2.2.cmml" xref="alg1.l7a.m1.3.4.3.2"><csymbol cd="ambiguous" id="alg1.l7a.m1.3.4.3.2.2.1.cmml" xref="alg1.l7a.m1.3.4.3.2">subscript</csymbol><ci id="alg1.l7a.m1.3.4.3.2.2.2.cmml" xref="alg1.l7a.m1.3.4.3.2.2.2">𝒘</ci><ci id="alg1.l7a.m1.3.4.3.2.2.3.cmml" xref="alg1.l7a.m1.3.4.3.2.2.3">𝑖</ci></apply><ci id="alg1.l7a.m1.2.2.1.1.cmml" xref="alg1.l7a.m1.2.2.1.1">𝑡</ci></apply><apply id="alg1.l7a.m1.3.4.3.3.cmml" xref="alg1.l7a.m1.3.4.3.3"><csymbol cd="ambiguous" id="alg1.l7a.m1.3.4.3.3.1.cmml" xref="alg1.l7a.m1.3.4.3.3">superscript</csymbol><ci id="alg1.l7a.m1.3.4.3.3.2.cmml" xref="alg1.l7a.m1.3.4.3.3.2">𝒘</ci><ci id="alg1.l7a.m1.3.3.1.1.cmml" xref="alg1.l7a.m1.3.3.1.1">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7a.m1.3c">\Delta{\bm{w}}_{i}^{(t)}:={\bm{w}}_{i}^{(t)}-{\bm{w}}^{(t)}</annotation></semantics></math> and <math id="alg1.l7a.m2.1" class="ltx_Math" alttext="\hat{\bm{p}}_{i}^{(t+1)}" display="inline"><semantics id="alg1.l7a.m2.1a"><msubsup id="alg1.l7a.m2.1.2" xref="alg1.l7a.m2.1.2.cmml"><mover accent="true" id="alg1.l7a.m2.1.2.2.2" xref="alg1.l7a.m2.1.2.2.2.cmml"><mi id="alg1.l7a.m2.1.2.2.2.2" xref="alg1.l7a.m2.1.2.2.2.2.cmml">𝒑</mi><mo id="alg1.l7a.m2.1.2.2.2.1" xref="alg1.l7a.m2.1.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l7a.m2.1.2.2.3" xref="alg1.l7a.m2.1.2.2.3.cmml">i</mi><mrow id="alg1.l7a.m2.1.1.1.1" xref="alg1.l7a.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7a.m2.1.1.1.1.2" xref="alg1.l7a.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l7a.m2.1.1.1.1.1" xref="alg1.l7a.m2.1.1.1.1.1.cmml"><mi id="alg1.l7a.m2.1.1.1.1.1.2" xref="alg1.l7a.m2.1.1.1.1.1.2.cmml">t</mi><mo id="alg1.l7a.m2.1.1.1.1.1.1" xref="alg1.l7a.m2.1.1.1.1.1.1.cmml">+</mo><mn id="alg1.l7a.m2.1.1.1.1.1.3" xref="alg1.l7a.m2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="alg1.l7a.m2.1.1.1.1.3" xref="alg1.l7a.m2.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l7a.m2.1b"><apply id="alg1.l7a.m2.1.2.cmml" xref="alg1.l7a.m2.1.2"><csymbol cd="ambiguous" id="alg1.l7a.m2.1.2.1.cmml" xref="alg1.l7a.m2.1.2">superscript</csymbol><apply id="alg1.l7a.m2.1.2.2.cmml" xref="alg1.l7a.m2.1.2"><csymbol cd="ambiguous" id="alg1.l7a.m2.1.2.2.1.cmml" xref="alg1.l7a.m2.1.2">subscript</csymbol><apply id="alg1.l7a.m2.1.2.2.2.cmml" xref="alg1.l7a.m2.1.2.2.2"><ci id="alg1.l7a.m2.1.2.2.2.1.cmml" xref="alg1.l7a.m2.1.2.2.2.1">^</ci><ci id="alg1.l7a.m2.1.2.2.2.2.cmml" xref="alg1.l7a.m2.1.2.2.2.2">𝒑</ci></apply><ci id="alg1.l7a.m2.1.2.2.3.cmml" xref="alg1.l7a.m2.1.2.2.3">𝑖</ci></apply><apply id="alg1.l7a.m2.1.1.1.1.1.cmml" xref="alg1.l7a.m2.1.1.1.1"><plus id="alg1.l7a.m2.1.1.1.1.1.1.cmml" xref="alg1.l7a.m2.1.1.1.1.1.1"></plus><ci id="alg1.l7a.m2.1.1.1.1.1.2.cmml" xref="alg1.l7a.m2.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l7a.m2.1.1.1.1.1.3.cmml" xref="alg1.l7a.m2.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7a.m2.1c">\hat{\bm{p}}_{i}^{(t+1)}</annotation></semantics></math> back


</div>
</div>
</div>
</div>
</figure>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span><span id="S4.SS3.1.1" class="ltx_text ltx_font_italic">Algorithm Design</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.6" class="ltx_p"><span id="S4.SS3.p1.6.1" class="ltx_text ltx_font_bold">Local Optimization Objective.</span>
To strike a balance between exploring local knowledge and exploiting global knowledge, a client needs to update the local model by considering both local samples and global prototypes. To this end, we incorporate the designed relaxed softmax and feature-prototype based augmentation to learn a balanced classifier. Then, the local objective function can be written as follows:</p>
<table id="S4.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E16.m1.1" class="ltx_Math" alttext="\min L_{i}({\bm{w}}_{i}):=\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}\left[\ell_{i}({\bm{w}}_{i};\xi_{j})+{\mu}\cdot\ell_{i}(\bm{\phi}_{i};\tilde{{\bf{h}}}_{j})\right]," display="block"><semantics id="S4.E16.m1.1a"><mrow id="S4.E16.m1.1.1.1" xref="S4.E16.m1.1.1.1.1.cmml"><mrow id="S4.E16.m1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.cmml"><mrow id="S4.E16.m1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.cmml"><mrow id="S4.E16.m1.1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.1.3.cmml"><mi id="S4.E16.m1.1.1.1.1.1.3.1" xref="S4.E16.m1.1.1.1.1.1.3.1.cmml">min</mi><mo lspace="0.167em" id="S4.E16.m1.1.1.1.1.1.3a" xref="S4.E16.m1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E16.m1.1.1.1.1.1.3.2" xref="S4.E16.m1.1.1.1.1.1.3.2.cmml"><mi id="S4.E16.m1.1.1.1.1.1.3.2.2" xref="S4.E16.m1.1.1.1.1.1.3.2.2.cmml">L</mi><mi id="S4.E16.m1.1.1.1.1.1.3.2.3" xref="S4.E16.m1.1.1.1.1.1.3.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E16.m1.1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E16.m1.1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E16.m1.1.1.1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E16.m1.1.1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E16.m1.1.1.1.1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi id="S4.E16.m1.1.1.1.1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo rspace="0.278em" stretchy="false" id="S4.E16.m1.1.1.1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S4.E16.m1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.3.cmml">:=</mo><mrow id="S4.E16.m1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.2.cmml"><mfrac id="S4.E16.m1.1.1.1.1.2.3" xref="S4.E16.m1.1.1.1.1.2.3.cmml"><mn id="S4.E16.m1.1.1.1.1.2.3.2" xref="S4.E16.m1.1.1.1.1.2.3.2.cmml">1</mn><msub id="S4.E16.m1.1.1.1.1.2.3.3" xref="S4.E16.m1.1.1.1.1.2.3.3.cmml"><mi id="S4.E16.m1.1.1.1.1.2.3.3.2" xref="S4.E16.m1.1.1.1.1.2.3.3.2.cmml">n</mi><mi id="S4.E16.m1.1.1.1.1.2.3.3.3" xref="S4.E16.m1.1.1.1.1.2.3.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S4.E16.m1.1.1.1.1.2.2" xref="S4.E16.m1.1.1.1.1.2.2.cmml">​</mo><mrow id="S4.E16.m1.1.1.1.1.2.1" xref="S4.E16.m1.1.1.1.1.2.1.cmml"><munderover id="S4.E16.m1.1.1.1.1.2.1.2" xref="S4.E16.m1.1.1.1.1.2.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E16.m1.1.1.1.1.2.1.2.2.2" xref="S4.E16.m1.1.1.1.1.2.1.2.2.2.cmml">∑</mo><mrow id="S4.E16.m1.1.1.1.1.2.1.2.2.3" xref="S4.E16.m1.1.1.1.1.2.1.2.2.3.cmml"><mi id="S4.E16.m1.1.1.1.1.2.1.2.2.3.2" xref="S4.E16.m1.1.1.1.1.2.1.2.2.3.2.cmml">j</mi><mo id="S4.E16.m1.1.1.1.1.2.1.2.2.3.1" xref="S4.E16.m1.1.1.1.1.2.1.2.2.3.1.cmml">=</mo><mn id="S4.E16.m1.1.1.1.1.2.1.2.2.3.3" xref="S4.E16.m1.1.1.1.1.2.1.2.2.3.3.cmml">1</mn></mrow><msub id="S4.E16.m1.1.1.1.1.2.1.2.3" xref="S4.E16.m1.1.1.1.1.2.1.2.3.cmml"><mi id="S4.E16.m1.1.1.1.1.2.1.2.3.2" xref="S4.E16.m1.1.1.1.1.2.1.2.3.2.cmml">n</mi><mi id="S4.E16.m1.1.1.1.1.2.1.2.3.3" xref="S4.E16.m1.1.1.1.1.2.1.2.3.3.cmml">i</mi></msub></munderover><mrow id="S4.E16.m1.1.1.1.1.2.1.1.1" xref="S4.E16.m1.1.1.1.1.2.1.1.2.cmml"><mo id="S4.E16.m1.1.1.1.1.2.1.1.1.2" xref="S4.E16.m1.1.1.1.1.2.1.1.2.1.cmml">[</mo><mrow id="S4.E16.m1.1.1.1.1.2.1.1.1.1" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.cmml"><mrow id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.cmml"><msub id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.cmml"><mi mathvariant="normal" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.2.cmml">ℓ</mi><mi id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml">(</mo><msub id="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml">𝒘</mi><mi id="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.4" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml">;</mo><msub id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.2.cmml">ξ</mi><mi id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.5" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E16.m1.1.1.1.1.2.1.1.1.1.5" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.5.cmml">+</mo><mrow id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.cmml"><mrow id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.cmml"><mi id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.2.cmml">μ</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.1" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.1.cmml">⋅</mo><msub id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.cmml"><mi mathvariant="normal" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.2.cmml">ℓ</mi><mi id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.3.cmml">​</mo><mrow id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.3.cmml"><mo stretchy="false" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.3.cmml">(</mo><msub id="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.2.cmml">ϕ</mi><mi id="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.3.cmml">i</mi></msub><mo id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.4" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.3.cmml">;</mo><msub id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.cmml"><mover accent="true" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2.cmml"><mi id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2.2" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2.2.cmml">𝐡</mi><mo id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2.1" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2.1.cmml">~</mo></mover><mi id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.3" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.3.cmml">j</mi></msub><mo stretchy="false" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.5" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E16.m1.1.1.1.1.2.1.1.1.3" xref="S4.E16.m1.1.1.1.1.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S4.E16.m1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.1b"><apply id="S4.E16.m1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1"><csymbol cd="latexml" id="S4.E16.m1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.3">assign</csymbol><apply id="S4.E16.m1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1"><times id="S4.E16.m1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.1.2"></times><apply id="S4.E16.m1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.1.3"><min id="S4.E16.m1.1.1.1.1.1.3.1.cmml" xref="S4.E16.m1.1.1.1.1.1.3.1"></min><apply id="S4.E16.m1.1.1.1.1.1.3.2.cmml" xref="S4.E16.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E16.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E16.m1.1.1.1.1.1.3.2.2">𝐿</ci><ci id="S4.E16.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E16.m1.1.1.1.1.1.3.2.3">𝑖</ci></apply></apply><apply id="S4.E16.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S4.E16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S4.E16.m1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.2"><times id="S4.E16.m1.1.1.1.1.2.2.cmml" xref="S4.E16.m1.1.1.1.1.2.2"></times><apply id="S4.E16.m1.1.1.1.1.2.3.cmml" xref="S4.E16.m1.1.1.1.1.2.3"><divide id="S4.E16.m1.1.1.1.1.2.3.1.cmml" xref="S4.E16.m1.1.1.1.1.2.3"></divide><cn type="integer" id="S4.E16.m1.1.1.1.1.2.3.2.cmml" xref="S4.E16.m1.1.1.1.1.2.3.2">1</cn><apply id="S4.E16.m1.1.1.1.1.2.3.3.cmml" xref="S4.E16.m1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.3.3.1.cmml" xref="S4.E16.m1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.2.3.3.2.cmml" xref="S4.E16.m1.1.1.1.1.2.3.3.2">𝑛</ci><ci id="S4.E16.m1.1.1.1.1.2.3.3.3.cmml" xref="S4.E16.m1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply><apply id="S4.E16.m1.1.1.1.1.2.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1"><apply id="S4.E16.m1.1.1.1.1.2.1.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.1.2.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2">superscript</csymbol><apply id="S4.E16.m1.1.1.1.1.2.1.2.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.1.2.2.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2">subscript</csymbol><sum id="S4.E16.m1.1.1.1.1.2.1.2.2.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2.2.2"></sum><apply id="S4.E16.m1.1.1.1.1.2.1.2.2.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2.2.3"><eq id="S4.E16.m1.1.1.1.1.2.1.2.2.3.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2.2.3.1"></eq><ci id="S4.E16.m1.1.1.1.1.2.1.2.2.3.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2.2.3.2">𝑗</ci><cn type="integer" id="S4.E16.m1.1.1.1.1.2.1.2.2.3.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E16.m1.1.1.1.1.2.1.2.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2.3"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.1.2.3.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2.3">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.2.1.2.3.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2.3.2">𝑛</ci><ci id="S4.E16.m1.1.1.1.1.2.1.2.3.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.2.3.3">𝑖</ci></apply></apply><apply id="S4.E16.m1.1.1.1.1.2.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S4.E16.m1.1.1.1.1.2.1.1.2.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.2">delimited-[]</csymbol><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1"><plus id="S4.E16.m1.1.1.1.1.2.1.1.1.1.5.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.5"></plus><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2"><times id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.3"></times><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.2">ℓ</ci><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.4.3">𝑖</ci></apply><list id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2"><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.2">𝒘</ci><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.2">𝜉</ci><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.2.2.2.2.3">𝑗</ci></apply></list></apply><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4"><times id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.3"></times><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4"><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.1">⋅</ci><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.2">𝜇</ci><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.2">ℓ</ci><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.4.3.3">𝑖</ci></apply></apply><list id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2"><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.2">bold-italic-ϕ</ci><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.3.1.1.1.3">𝑖</ci></apply><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2">subscript</csymbol><apply id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2"><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2.1.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2.1">~</ci><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2.2.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.2.2">𝐡</ci></apply><ci id="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.3.cmml" xref="S4.E16.m1.1.1.1.1.2.1.1.1.1.4.2.2.2.3">𝑗</ci></apply></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.1c">\min L_{i}({\bm{w}}_{i}):=\frac{1}{n_{i}}\sum_{j=1}^{n_{i}}\left[\ell_{i}({\bm{w}}_{i};\xi_{j})+{\mu}\cdot\ell_{i}(\bm{\phi}_{i};\tilde{{\bf{h}}}_{j})\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.5" class="ltx_p">where <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\tilde{{\bf{h}}}_{j}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mover accent="true" id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2.2" xref="S4.SS3.p1.1.m1.1.1.2.2.cmml">𝐡</mi><mo id="S4.SS3.p1.1.m1.1.1.2.1" xref="S4.SS3.p1.1.m1.1.1.2.1.cmml">~</mo></mover><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2"><ci id="S4.SS3.p1.1.m1.1.1.2.1.cmml" xref="S4.SS3.p1.1.m1.1.1.2.1">~</ci><ci id="S4.SS3.p1.1.m1.1.1.2.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2.2">𝐡</ci></apply><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\tilde{{\bf{h}}}_{j}</annotation></semantics></math> is the augmented feature embedding based on the <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">j</annotation></semantics></math>-th data point and prototypes of class <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="y_{j}" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><msub id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">y</mi><mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">𝑦</ci><ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">y_{j}</annotation></semantics></math> and class <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="y_{j^{\prime}}:=[j\mod C]" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mrow id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><msub id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.2" xref="S4.SS3.p1.4.m4.1.1.3.2.cmml">y</mi><msup id="S4.SS3.p1.4.m4.1.1.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.3.2" xref="S4.SS3.p1.4.m4.1.1.3.3.2.cmml">j</mi><mo id="S4.SS3.p1.4.m4.1.1.3.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.3.cmml">′</mo></msup></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml">:=</mo><mrow id="S4.SS3.p1.4.m4.1.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.4.m4.1.1.1.1.2" xref="S4.SS3.p1.4.m4.1.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.p1.4.m4.1.1.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.4.m4.1.1.1.1.1.2" xref="S4.SS3.p1.4.m4.1.1.1.1.1.2.cmml">j</mi><mo id="S4.SS3.p1.4.m4.1.1.1.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.1.1.1.cmml">mod</mo><mi id="S4.SS3.p1.4.m4.1.1.1.1.1.3" xref="S4.SS3.p1.4.m4.1.1.1.1.1.3.cmml">C</mi></mrow><mo stretchy="false" id="S4.SS3.p1.4.m4.1.1.1.1.3" xref="S4.SS3.p1.4.m4.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="latexml" id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">assign</csymbol><apply id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.2">𝑦</ci><apply id="S4.SS3.p1.4.m4.1.1.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3">superscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.2">𝑗</ci><ci id="S4.SS3.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3.3.3">′</ci></apply></apply><apply id="S4.SS3.p1.4.m4.1.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.4.m4.1.1.1.2.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.p1.4.m4.1.1.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.4.m4.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1.1">modulo</csymbol><ci id="S4.SS3.p1.4.m4.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1.2">𝑗</ci><ci id="S4.SS3.p1.4.m4.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.1.1.1.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">y_{j^{\prime}}:=[j\mod C]</annotation></semantics></math>, <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mi id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><ci id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">\mu</annotation></semantics></math> is a hyper-parameter to balance the two terms of loss. It is worth noting that the global prototypes might not contain all classes, therefore we only augment those available classes and re-calculate the prior of augmented features for computing the cross-entropy loss. The main workflow of ReBaFL is presented in Algorithm <a href="#alg1" title="Algorithm 1 ‣ 4.2 Feature Augmentation for Missing Classes ‣ 4 Our Proposed Framework ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, where the optimization is implemented in an iterative manner with multiple client-server communication rounds.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.4" class="ltx_p"><span id="S4.SS3.p2.4.1" class="ltx_text ltx_font_bold">Local Training Procedure.</span>
After receiving the latest global model, the clients first update the model parameters:</p>
<table id="S4.E17" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E17.m1.3" class="ltx_Math" alttext="{\bm{w}}_{i}^{(t)}\leftarrow{\bm{w}}^{(t)}." display="block"><semantics id="S4.E17.m1.3a"><mrow id="S4.E17.m1.3.3.1" xref="S4.E17.m1.3.3.1.1.cmml"><mrow id="S4.E17.m1.3.3.1.1" xref="S4.E17.m1.3.3.1.1.cmml"><msubsup id="S4.E17.m1.3.3.1.1.2" xref="S4.E17.m1.3.3.1.1.2.cmml"><mi id="S4.E17.m1.3.3.1.1.2.2.2" xref="S4.E17.m1.3.3.1.1.2.2.2.cmml">𝒘</mi><mi id="S4.E17.m1.3.3.1.1.2.2.3" xref="S4.E17.m1.3.3.1.1.2.2.3.cmml">i</mi><mrow id="S4.E17.m1.1.1.1.3" xref="S4.E17.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S4.E17.m1.1.1.1.3.1" xref="S4.E17.m1.3.3.1.1.2.cmml">(</mo><mi id="S4.E17.m1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.E17.m1.1.1.1.3.2" xref="S4.E17.m1.3.3.1.1.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.E17.m1.3.3.1.1.1" xref="S4.E17.m1.3.3.1.1.1.cmml">←</mo><msup id="S4.E17.m1.3.3.1.1.3" xref="S4.E17.m1.3.3.1.1.3.cmml"><mi id="S4.E17.m1.3.3.1.1.3.2" xref="S4.E17.m1.3.3.1.1.3.2.cmml">𝒘</mi><mrow id="S4.E17.m1.2.2.1.3" xref="S4.E17.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S4.E17.m1.2.2.1.3.1" xref="S4.E17.m1.3.3.1.1.3.cmml">(</mo><mi id="S4.E17.m1.2.2.1.1" xref="S4.E17.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S4.E17.m1.2.2.1.3.2" xref="S4.E17.m1.3.3.1.1.3.cmml">)</mo></mrow></msup></mrow><mo lspace="0em" id="S4.E17.m1.3.3.1.2" xref="S4.E17.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E17.m1.3b"><apply id="S4.E17.m1.3.3.1.1.cmml" xref="S4.E17.m1.3.3.1"><ci id="S4.E17.m1.3.3.1.1.1.cmml" xref="S4.E17.m1.3.3.1.1.1">←</ci><apply id="S4.E17.m1.3.3.1.1.2.cmml" xref="S4.E17.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.2.1.cmml" xref="S4.E17.m1.3.3.1.1.2">superscript</csymbol><apply id="S4.E17.m1.3.3.1.1.2.2.cmml" xref="S4.E17.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.2.2.1.cmml" xref="S4.E17.m1.3.3.1.1.2">subscript</csymbol><ci id="S4.E17.m1.3.3.1.1.2.2.2.cmml" xref="S4.E17.m1.3.3.1.1.2.2.2">𝒘</ci><ci id="S4.E17.m1.3.3.1.1.2.2.3.cmml" xref="S4.E17.m1.3.3.1.1.2.2.3">𝑖</ci></apply><ci id="S4.E17.m1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1.1">𝑡</ci></apply><apply id="S4.E17.m1.3.3.1.1.3.cmml" xref="S4.E17.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E17.m1.3.3.1.1.3.1.cmml" xref="S4.E17.m1.3.3.1.1.3">superscript</csymbol><ci id="S4.E17.m1.3.3.1.1.3.2.cmml" xref="S4.E17.m1.3.3.1.1.3.2">𝒘</ci><ci id="S4.E17.m1.2.2.1.1.cmml" xref="S4.E17.m1.2.2.1.1">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E17.m1.3c">{\bm{w}}_{i}^{(t)}\leftarrow{\bm{w}}^{(t)}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.2" class="ltx_p">Then, the class-wise prototypes are obtained by combining the received global prototypes <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="{\bm{p}}^{(t)}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><msup id="S4.SS3.p2.1.m1.1.2" xref="S4.SS3.p2.1.m1.1.2.cmml"><mi id="S4.SS3.p2.1.m1.1.2.2" xref="S4.SS3.p2.1.m1.1.2.2.cmml">𝒑</mi><mrow id="S4.SS3.p2.1.m1.1.1.1.3" xref="S4.SS3.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.1.m1.1.1.1.3.1" xref="S4.SS3.p2.1.m1.1.2.cmml">(</mo><mi id="S4.SS3.p2.1.m1.1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS3.p2.1.m1.1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.2.1.cmml" xref="S4.SS3.p2.1.m1.1.2">superscript</csymbol><ci id="S4.SS3.p2.1.m1.1.2.2.cmml" xref="S4.SS3.p2.1.m1.1.2.2">𝒑</ci><ci id="S4.SS3.p2.1.m1.1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">{\bm{p}}^{(t)}</annotation></semantics></math> and the newly computed local prototypes <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="{\bm{p}}_{i}^{(t)}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><msubsup id="S4.SS3.p2.2.m2.1.2" xref="S4.SS3.p2.2.m2.1.2.cmml"><mi id="S4.SS3.p2.2.m2.1.2.2.2" xref="S4.SS3.p2.2.m2.1.2.2.2.cmml">𝒑</mi><mi id="S4.SS3.p2.2.m2.1.2.2.3" xref="S4.SS3.p2.2.m2.1.2.2.3.cmml">i</mi><mrow id="S4.SS3.p2.2.m2.1.1.1.3" xref="S4.SS3.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.2.m2.1.1.1.3.1" xref="S4.SS3.p2.2.m2.1.2.cmml">(</mo><mi id="S4.SS3.p2.2.m2.1.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.SS3.p2.2.m2.1.1.1.3.2" xref="S4.SS3.p2.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.2.cmml" xref="S4.SS3.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.2.1.cmml" xref="S4.SS3.p2.2.m2.1.2">superscript</csymbol><apply id="S4.SS3.p2.2.m2.1.2.2.cmml" xref="S4.SS3.p2.2.m2.1.2"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.2.2.1.cmml" xref="S4.SS3.p2.2.m2.1.2">subscript</csymbol><ci id="S4.SS3.p2.2.m2.1.2.2.2.cmml" xref="S4.SS3.p2.2.m2.1.2.2.2">𝒑</ci><ci id="S4.SS3.p2.2.m2.1.2.2.3.cmml" xref="S4.SS3.p2.2.m2.1.2.2.3">𝑖</ci></apply><ci id="S4.SS3.p2.2.m2.1.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">{\bm{p}}_{i}^{(t)}</annotation></semantics></math> by the received feature extractor:</p>
<table id="S4.E18" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E18.m1.4" class="ltx_Math" alttext="\bm{p}_{c}^{(t)}\leftarrow{\bm{p}}_{i}^{(t)}[c],\quad\forall c\in\mathcal{Y}_{i}." display="block"><semantics id="S4.E18.m1.4a"><mrow id="S4.E18.m1.4.4.1"><mrow id="S4.E18.m1.4.4.1.1.2" xref="S4.E18.m1.4.4.1.1.3.cmml"><mrow id="S4.E18.m1.4.4.1.1.1.1" xref="S4.E18.m1.4.4.1.1.1.1.cmml"><msubsup id="S4.E18.m1.4.4.1.1.1.1.2" xref="S4.E18.m1.4.4.1.1.1.1.2.cmml"><mi id="S4.E18.m1.4.4.1.1.1.1.2.2.2" xref="S4.E18.m1.4.4.1.1.1.1.2.2.2.cmml">𝒑</mi><mi id="S4.E18.m1.4.4.1.1.1.1.2.2.3" xref="S4.E18.m1.4.4.1.1.1.1.2.2.3.cmml">c</mi><mrow id="S4.E18.m1.1.1.1.3" xref="S4.E18.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E18.m1.1.1.1.3.1" xref="S4.E18.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="S4.E18.m1.1.1.1.1" xref="S4.E18.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.E18.m1.1.1.1.3.2" xref="S4.E18.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.E18.m1.4.4.1.1.1.1.1" xref="S4.E18.m1.4.4.1.1.1.1.1.cmml">←</mo><mrow id="S4.E18.m1.4.4.1.1.1.1.3" xref="S4.E18.m1.4.4.1.1.1.1.3.cmml"><msubsup id="S4.E18.m1.4.4.1.1.1.1.3.2" xref="S4.E18.m1.4.4.1.1.1.1.3.2.cmml"><mi id="S4.E18.m1.4.4.1.1.1.1.3.2.2.2" xref="S4.E18.m1.4.4.1.1.1.1.3.2.2.2.cmml">𝒑</mi><mi id="S4.E18.m1.4.4.1.1.1.1.3.2.2.3" xref="S4.E18.m1.4.4.1.1.1.1.3.2.2.3.cmml">i</mi><mrow id="S4.E18.m1.2.2.1.3" xref="S4.E18.m1.4.4.1.1.1.1.3.2.cmml"><mo stretchy="false" id="S4.E18.m1.2.2.1.3.1" xref="S4.E18.m1.4.4.1.1.1.1.3.2.cmml">(</mo><mi id="S4.E18.m1.2.2.1.1" xref="S4.E18.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S4.E18.m1.2.2.1.3.2" xref="S4.E18.m1.4.4.1.1.1.1.3.2.cmml">)</mo></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.E18.m1.4.4.1.1.1.1.3.1" xref="S4.E18.m1.4.4.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E18.m1.4.4.1.1.1.1.3.3.2" xref="S4.E18.m1.4.4.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S4.E18.m1.4.4.1.1.1.1.3.3.2.1" xref="S4.E18.m1.4.4.1.1.1.1.3.3.1.1.cmml">[</mo><mi id="S4.E18.m1.3.3" xref="S4.E18.m1.3.3.cmml">c</mi><mo stretchy="false" id="S4.E18.m1.4.4.1.1.1.1.3.3.2.2" xref="S4.E18.m1.4.4.1.1.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S4.E18.m1.4.4.1.1.2.3" xref="S4.E18.m1.4.4.1.1.3a.cmml">,</mo><mrow id="S4.E18.m1.4.4.1.1.2.2" xref="S4.E18.m1.4.4.1.1.2.2.cmml"><mrow id="S4.E18.m1.4.4.1.1.2.2.2" xref="S4.E18.m1.4.4.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S4.E18.m1.4.4.1.1.2.2.2.1" xref="S4.E18.m1.4.4.1.1.2.2.2.1.cmml">∀</mo><mi id="S4.E18.m1.4.4.1.1.2.2.2.2" xref="S4.E18.m1.4.4.1.1.2.2.2.2.cmml">c</mi></mrow><mo id="S4.E18.m1.4.4.1.1.2.2.1" xref="S4.E18.m1.4.4.1.1.2.2.1.cmml">∈</mo><msub id="S4.E18.m1.4.4.1.1.2.2.3" xref="S4.E18.m1.4.4.1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E18.m1.4.4.1.1.2.2.3.2" xref="S4.E18.m1.4.4.1.1.2.2.3.2.cmml">𝒴</mi><mi id="S4.E18.m1.4.4.1.1.2.2.3.3" xref="S4.E18.m1.4.4.1.1.2.2.3.3.cmml">i</mi></msub></mrow></mrow><mo lspace="0em" id="S4.E18.m1.4.4.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m1.4b"><apply id="S4.E18.m1.4.4.1.1.3.cmml" xref="S4.E18.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S4.E18.m1.4.4.1.1.3a.cmml" xref="S4.E18.m1.4.4.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E18.m1.4.4.1.1.1.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1"><ci id="S4.E18.m1.4.4.1.1.1.1.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.1">←</ci><apply id="S4.E18.m1.4.4.1.1.1.1.2.cmml" xref="S4.E18.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E18.m1.4.4.1.1.1.1.2.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.2">superscript</csymbol><apply id="S4.E18.m1.4.4.1.1.1.1.2.2.cmml" xref="S4.E18.m1.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E18.m1.4.4.1.1.1.1.2.2.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.2">subscript</csymbol><ci id="S4.E18.m1.4.4.1.1.1.1.2.2.2.cmml" xref="S4.E18.m1.4.4.1.1.1.1.2.2.2">𝒑</ci><ci id="S4.E18.m1.4.4.1.1.1.1.2.2.3.cmml" xref="S4.E18.m1.4.4.1.1.1.1.2.2.3">𝑐</ci></apply><ci id="S4.E18.m1.1.1.1.1.cmml" xref="S4.E18.m1.1.1.1.1">𝑡</ci></apply><apply id="S4.E18.m1.4.4.1.1.1.1.3.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3"><times id="S4.E18.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3.1"></times><apply id="S4.E18.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E18.m1.4.4.1.1.1.1.3.2.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3.2">superscript</csymbol><apply id="S4.E18.m1.4.4.1.1.1.1.3.2.2.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E18.m1.4.4.1.1.1.1.3.2.2.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E18.m1.4.4.1.1.1.1.3.2.2.2.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3.2.2.2">𝒑</ci><ci id="S4.E18.m1.4.4.1.1.1.1.3.2.2.3.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3.2.2.3">𝑖</ci></apply><ci id="S4.E18.m1.2.2.1.1.cmml" xref="S4.E18.m1.2.2.1.1">𝑡</ci></apply><apply id="S4.E18.m1.4.4.1.1.1.1.3.3.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3.3.2"><csymbol cd="latexml" id="S4.E18.m1.4.4.1.1.1.1.3.3.1.1.cmml" xref="S4.E18.m1.4.4.1.1.1.1.3.3.2.1">delimited-[]</csymbol><ci id="S4.E18.m1.3.3.cmml" xref="S4.E18.m1.3.3">𝑐</ci></apply></apply></apply><apply id="S4.E18.m1.4.4.1.1.2.2.cmml" xref="S4.E18.m1.4.4.1.1.2.2"><in id="S4.E18.m1.4.4.1.1.2.2.1.cmml" xref="S4.E18.m1.4.4.1.1.2.2.1"></in><apply id="S4.E18.m1.4.4.1.1.2.2.2.cmml" xref="S4.E18.m1.4.4.1.1.2.2.2"><csymbol cd="latexml" id="S4.E18.m1.4.4.1.1.2.2.2.1.cmml" xref="S4.E18.m1.4.4.1.1.2.2.2.1">for-all</csymbol><ci id="S4.E18.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E18.m1.4.4.1.1.2.2.2.2">𝑐</ci></apply><apply id="S4.E18.m1.4.4.1.1.2.2.3.cmml" xref="S4.E18.m1.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="S4.E18.m1.4.4.1.1.2.2.3.1.cmml" xref="S4.E18.m1.4.4.1.1.2.2.3">subscript</csymbol><ci id="S4.E18.m1.4.4.1.1.2.2.3.2.cmml" xref="S4.E18.m1.4.4.1.1.2.2.3.2">𝒴</ci><ci id="S4.E18.m1.4.4.1.1.2.2.3.3.cmml" xref="S4.E18.m1.4.4.1.1.2.2.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E18.m1.4c">\bm{p}_{c}^{(t)}\leftarrow{\bm{p}}_{i}^{(t)}[c],\quad\forall c\in\mathcal{Y}_{i}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.5" class="ltx_p">This step is designed mainly in consideration of the possible missing prototypes from previous round. Finally, the mini-batch stochastic gradient decent (SGD) method will be applied to update the whole model for multiple epochs:</p>
<table id="S4.E19" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E19.m1.4" class="ltx_Math" alttext="\nabla_{\bm{w}}L_{i}({\bm{w}}_{i}^{(t)})=\nabla_{\bm{w}}\ell_{i}({\bm{w}}_{i}^{(t)};\xi_{i})+{\mu}\nabla_{{\bm{\phi}}}\ell_{i}({\bm{\phi}}_{i}^{(t)};{\bf{h}}_{i})," display="block"><semantics id="S4.E19.m1.4a"><mrow id="S4.E19.m1.4.4.1" xref="S4.E19.m1.4.4.1.1.cmml"><mrow id="S4.E19.m1.4.4.1.1" xref="S4.E19.m1.4.4.1.1.cmml"><mrow id="S4.E19.m1.4.4.1.1.1" xref="S4.E19.m1.4.4.1.1.1.cmml"><mrow id="S4.E19.m1.4.4.1.1.1.3" xref="S4.E19.m1.4.4.1.1.1.3.cmml"><msub id="S4.E19.m1.4.4.1.1.1.3.1" xref="S4.E19.m1.4.4.1.1.1.3.1.cmml"><mo id="S4.E19.m1.4.4.1.1.1.3.1.2" xref="S4.E19.m1.4.4.1.1.1.3.1.2.cmml">∇</mo><mi id="S4.E19.m1.4.4.1.1.1.3.1.3" xref="S4.E19.m1.4.4.1.1.1.3.1.3.cmml">𝒘</mi></msub><msub id="S4.E19.m1.4.4.1.1.1.3.2" xref="S4.E19.m1.4.4.1.1.1.3.2.cmml"><mi id="S4.E19.m1.4.4.1.1.1.3.2.2" xref="S4.E19.m1.4.4.1.1.1.3.2.2.cmml">L</mi><mi id="S4.E19.m1.4.4.1.1.1.3.2.3" xref="S4.E19.m1.4.4.1.1.1.3.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E19.m1.4.4.1.1.1.2" xref="S4.E19.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="S4.E19.m1.4.4.1.1.1.1.1" xref="S4.E19.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E19.m1.4.4.1.1.1.1.1.2" xref="S4.E19.m1.4.4.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E19.m1.4.4.1.1.1.1.1.1" xref="S4.E19.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S4.E19.m1.4.4.1.1.1.1.1.1.2.2" xref="S4.E19.m1.4.4.1.1.1.1.1.1.2.2.cmml">𝒘</mi><mi id="S4.E19.m1.4.4.1.1.1.1.1.1.2.3" xref="S4.E19.m1.4.4.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S4.E19.m1.1.1.1.3" xref="S4.E19.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E19.m1.1.1.1.3.1" xref="S4.E19.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E19.m1.1.1.1.1" xref="S4.E19.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.E19.m1.1.1.1.3.2" xref="S4.E19.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.E19.m1.4.4.1.1.1.1.1.3" xref="S4.E19.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E19.m1.4.4.1.1.6" xref="S4.E19.m1.4.4.1.1.6.cmml">=</mo><mrow id="S4.E19.m1.4.4.1.1.5" xref="S4.E19.m1.4.4.1.1.5.cmml"><mrow id="S4.E19.m1.4.4.1.1.3.2" xref="S4.E19.m1.4.4.1.1.3.2.cmml"><mrow id="S4.E19.m1.4.4.1.1.3.2.4" xref="S4.E19.m1.4.4.1.1.3.2.4.cmml"><msub id="S4.E19.m1.4.4.1.1.3.2.4.1" xref="S4.E19.m1.4.4.1.1.3.2.4.1.cmml"><mo rspace="0.167em" id="S4.E19.m1.4.4.1.1.3.2.4.1.2" xref="S4.E19.m1.4.4.1.1.3.2.4.1.2.cmml">∇</mo><mi id="S4.E19.m1.4.4.1.1.3.2.4.1.3" xref="S4.E19.m1.4.4.1.1.3.2.4.1.3.cmml">𝒘</mi></msub><msub id="S4.E19.m1.4.4.1.1.3.2.4.2" xref="S4.E19.m1.4.4.1.1.3.2.4.2.cmml"><mi mathvariant="normal" id="S4.E19.m1.4.4.1.1.3.2.4.2.2" xref="S4.E19.m1.4.4.1.1.3.2.4.2.2.cmml">ℓ</mi><mi id="S4.E19.m1.4.4.1.1.3.2.4.2.3" xref="S4.E19.m1.4.4.1.1.3.2.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E19.m1.4.4.1.1.3.2.3" xref="S4.E19.m1.4.4.1.1.3.2.3.cmml">​</mo><mrow id="S4.E19.m1.4.4.1.1.3.2.2.2" xref="S4.E19.m1.4.4.1.1.3.2.2.3.cmml"><mo stretchy="false" id="S4.E19.m1.4.4.1.1.3.2.2.2.3" xref="S4.E19.m1.4.4.1.1.3.2.2.3.cmml">(</mo><msubsup id="S4.E19.m1.4.4.1.1.2.1.1.1.1" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1.cmml"><mi id="S4.E19.m1.4.4.1.1.2.1.1.1.1.2.2" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1.2.2.cmml">𝒘</mi><mi id="S4.E19.m1.4.4.1.1.2.1.1.1.1.2.3" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1.2.3.cmml">i</mi><mrow id="S4.E19.m1.2.2.1.3" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E19.m1.2.2.1.3.1" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1.cmml">(</mo><mi id="S4.E19.m1.2.2.1.1" xref="S4.E19.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S4.E19.m1.2.2.1.3.2" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E19.m1.4.4.1.1.3.2.2.2.4" xref="S4.E19.m1.4.4.1.1.3.2.2.3.cmml">;</mo><msub id="S4.E19.m1.4.4.1.1.3.2.2.2.2" xref="S4.E19.m1.4.4.1.1.3.2.2.2.2.cmml"><mi id="S4.E19.m1.4.4.1.1.3.2.2.2.2.2" xref="S4.E19.m1.4.4.1.1.3.2.2.2.2.2.cmml">ξ</mi><mi id="S4.E19.m1.4.4.1.1.3.2.2.2.2.3" xref="S4.E19.m1.4.4.1.1.3.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E19.m1.4.4.1.1.3.2.2.2.5" xref="S4.E19.m1.4.4.1.1.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E19.m1.4.4.1.1.5.5" xref="S4.E19.m1.4.4.1.1.5.5.cmml">+</mo><mrow id="S4.E19.m1.4.4.1.1.5.4" xref="S4.E19.m1.4.4.1.1.5.4.cmml"><mi id="S4.E19.m1.4.4.1.1.5.4.4" xref="S4.E19.m1.4.4.1.1.5.4.4.cmml">μ</mi><mo lspace="0.167em" rspace="0em" id="S4.E19.m1.4.4.1.1.5.4.3" xref="S4.E19.m1.4.4.1.1.5.4.3.cmml">​</mo><mrow id="S4.E19.m1.4.4.1.1.5.4.5" xref="S4.E19.m1.4.4.1.1.5.4.5.cmml"><msub id="S4.E19.m1.4.4.1.1.5.4.5.1" xref="S4.E19.m1.4.4.1.1.5.4.5.1.cmml"><mo rspace="0.167em" id="S4.E19.m1.4.4.1.1.5.4.5.1.2" xref="S4.E19.m1.4.4.1.1.5.4.5.1.2.cmml">∇</mo><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E19.m1.4.4.1.1.5.4.5.1.3" xref="S4.E19.m1.4.4.1.1.5.4.5.1.3.cmml">ϕ</mi></msub><msub id="S4.E19.m1.4.4.1.1.5.4.5.2" xref="S4.E19.m1.4.4.1.1.5.4.5.2.cmml"><mi mathvariant="normal" id="S4.E19.m1.4.4.1.1.5.4.5.2.2" xref="S4.E19.m1.4.4.1.1.5.4.5.2.2.cmml">ℓ</mi><mi id="S4.E19.m1.4.4.1.1.5.4.5.2.3" xref="S4.E19.m1.4.4.1.1.5.4.5.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E19.m1.4.4.1.1.5.4.3a" xref="S4.E19.m1.4.4.1.1.5.4.3.cmml">​</mo><mrow id="S4.E19.m1.4.4.1.1.5.4.2.2" xref="S4.E19.m1.4.4.1.1.5.4.2.3.cmml"><mo stretchy="false" id="S4.E19.m1.4.4.1.1.5.4.2.2.3" xref="S4.E19.m1.4.4.1.1.5.4.2.3.cmml">(</mo><msubsup id="S4.E19.m1.4.4.1.1.4.3.1.1.1" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S4.E19.m1.4.4.1.1.4.3.1.1.1.2.2" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1.2.2.cmml">ϕ</mi><mi id="S4.E19.m1.4.4.1.1.4.3.1.1.1.2.3" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1.2.3.cmml">i</mi><mrow id="S4.E19.m1.3.3.1.3" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1.cmml"><mo stretchy="false" id="S4.E19.m1.3.3.1.3.1" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1.cmml">(</mo><mi id="S4.E19.m1.3.3.1.1" xref="S4.E19.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="S4.E19.m1.3.3.1.3.2" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E19.m1.4.4.1.1.5.4.2.2.4" xref="S4.E19.m1.4.4.1.1.5.4.2.3.cmml">;</mo><msub id="S4.E19.m1.4.4.1.1.5.4.2.2.2" xref="S4.E19.m1.4.4.1.1.5.4.2.2.2.cmml"><mi id="S4.E19.m1.4.4.1.1.5.4.2.2.2.2" xref="S4.E19.m1.4.4.1.1.5.4.2.2.2.2.cmml">𝐡</mi><mi id="S4.E19.m1.4.4.1.1.5.4.2.2.2.3" xref="S4.E19.m1.4.4.1.1.5.4.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E19.m1.4.4.1.1.5.4.2.2.5" xref="S4.E19.m1.4.4.1.1.5.4.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E19.m1.4.4.1.2" xref="S4.E19.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E19.m1.4b"><apply id="S4.E19.m1.4.4.1.1.cmml" xref="S4.E19.m1.4.4.1"><eq id="S4.E19.m1.4.4.1.1.6.cmml" xref="S4.E19.m1.4.4.1.1.6"></eq><apply id="S4.E19.m1.4.4.1.1.1.cmml" xref="S4.E19.m1.4.4.1.1.1"><times id="S4.E19.m1.4.4.1.1.1.2.cmml" xref="S4.E19.m1.4.4.1.1.1.2"></times><apply id="S4.E19.m1.4.4.1.1.1.3.cmml" xref="S4.E19.m1.4.4.1.1.1.3"><apply id="S4.E19.m1.4.4.1.1.1.3.1.cmml" xref="S4.E19.m1.4.4.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.1.3.1.1.cmml" xref="S4.E19.m1.4.4.1.1.1.3.1">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.1.3.1.2.cmml" xref="S4.E19.m1.4.4.1.1.1.3.1.2">∇</ci><ci id="S4.E19.m1.4.4.1.1.1.3.1.3.cmml" xref="S4.E19.m1.4.4.1.1.1.3.1.3">𝒘</ci></apply><apply id="S4.E19.m1.4.4.1.1.1.3.2.cmml" xref="S4.E19.m1.4.4.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.1.3.2.1.cmml" xref="S4.E19.m1.4.4.1.1.1.3.2">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.1.3.2.2.cmml" xref="S4.E19.m1.4.4.1.1.1.3.2.2">𝐿</ci><ci id="S4.E19.m1.4.4.1.1.1.3.2.3.cmml" xref="S4.E19.m1.4.4.1.1.1.3.2.3">𝑖</ci></apply></apply><apply id="S4.E19.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E19.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E19.m1.4.4.1.1.1.1.1">superscript</csymbol><apply id="S4.E19.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E19.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S4.E19.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.1.1.1.1.2.2.cmml" xref="S4.E19.m1.4.4.1.1.1.1.1.1.2.2">𝒘</ci><ci id="S4.E19.m1.4.4.1.1.1.1.1.1.2.3.cmml" xref="S4.E19.m1.4.4.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E19.m1.1.1.1.1.cmml" xref="S4.E19.m1.1.1.1.1">𝑡</ci></apply></apply><apply id="S4.E19.m1.4.4.1.1.5.cmml" xref="S4.E19.m1.4.4.1.1.5"><plus id="S4.E19.m1.4.4.1.1.5.5.cmml" xref="S4.E19.m1.4.4.1.1.5.5"></plus><apply id="S4.E19.m1.4.4.1.1.3.2.cmml" xref="S4.E19.m1.4.4.1.1.3.2"><times id="S4.E19.m1.4.4.1.1.3.2.3.cmml" xref="S4.E19.m1.4.4.1.1.3.2.3"></times><apply id="S4.E19.m1.4.4.1.1.3.2.4.cmml" xref="S4.E19.m1.4.4.1.1.3.2.4"><apply id="S4.E19.m1.4.4.1.1.3.2.4.1.cmml" xref="S4.E19.m1.4.4.1.1.3.2.4.1"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.3.2.4.1.1.cmml" xref="S4.E19.m1.4.4.1.1.3.2.4.1">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.3.2.4.1.2.cmml" xref="S4.E19.m1.4.4.1.1.3.2.4.1.2">∇</ci><ci id="S4.E19.m1.4.4.1.1.3.2.4.1.3.cmml" xref="S4.E19.m1.4.4.1.1.3.2.4.1.3">𝒘</ci></apply><apply id="S4.E19.m1.4.4.1.1.3.2.4.2.cmml" xref="S4.E19.m1.4.4.1.1.3.2.4.2"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.3.2.4.2.1.cmml" xref="S4.E19.m1.4.4.1.1.3.2.4.2">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.3.2.4.2.2.cmml" xref="S4.E19.m1.4.4.1.1.3.2.4.2.2">ℓ</ci><ci id="S4.E19.m1.4.4.1.1.3.2.4.2.3.cmml" xref="S4.E19.m1.4.4.1.1.3.2.4.2.3">𝑖</ci></apply></apply><list id="S4.E19.m1.4.4.1.1.3.2.2.3.cmml" xref="S4.E19.m1.4.4.1.1.3.2.2.2"><apply id="S4.E19.m1.4.4.1.1.2.1.1.1.1.cmml" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.2.1.1.1.1.1.cmml" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1">superscript</csymbol><apply id="S4.E19.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.2.1.1.1.1.2.1.cmml" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.2.1.1.1.1.2.2.cmml" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1.2.2">𝒘</ci><ci id="S4.E19.m1.4.4.1.1.2.1.1.1.1.2.3.cmml" xref="S4.E19.m1.4.4.1.1.2.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E19.m1.2.2.1.1.cmml" xref="S4.E19.m1.2.2.1.1">𝑡</ci></apply><apply id="S4.E19.m1.4.4.1.1.3.2.2.2.2.cmml" xref="S4.E19.m1.4.4.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.3.2.2.2.2.1.cmml" xref="S4.E19.m1.4.4.1.1.3.2.2.2.2">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.3.2.2.2.2.2.cmml" xref="S4.E19.m1.4.4.1.1.3.2.2.2.2.2">𝜉</ci><ci id="S4.E19.m1.4.4.1.1.3.2.2.2.2.3.cmml" xref="S4.E19.m1.4.4.1.1.3.2.2.2.2.3">𝑖</ci></apply></list></apply><apply id="S4.E19.m1.4.4.1.1.5.4.cmml" xref="S4.E19.m1.4.4.1.1.5.4"><times id="S4.E19.m1.4.4.1.1.5.4.3.cmml" xref="S4.E19.m1.4.4.1.1.5.4.3"></times><ci id="S4.E19.m1.4.4.1.1.5.4.4.cmml" xref="S4.E19.m1.4.4.1.1.5.4.4">𝜇</ci><apply id="S4.E19.m1.4.4.1.1.5.4.5.cmml" xref="S4.E19.m1.4.4.1.1.5.4.5"><apply id="S4.E19.m1.4.4.1.1.5.4.5.1.cmml" xref="S4.E19.m1.4.4.1.1.5.4.5.1"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.5.4.5.1.1.cmml" xref="S4.E19.m1.4.4.1.1.5.4.5.1">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.5.4.5.1.2.cmml" xref="S4.E19.m1.4.4.1.1.5.4.5.1.2">∇</ci><ci id="S4.E19.m1.4.4.1.1.5.4.5.1.3.cmml" xref="S4.E19.m1.4.4.1.1.5.4.5.1.3">bold-italic-ϕ</ci></apply><apply id="S4.E19.m1.4.4.1.1.5.4.5.2.cmml" xref="S4.E19.m1.4.4.1.1.5.4.5.2"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.5.4.5.2.1.cmml" xref="S4.E19.m1.4.4.1.1.5.4.5.2">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.5.4.5.2.2.cmml" xref="S4.E19.m1.4.4.1.1.5.4.5.2.2">ℓ</ci><ci id="S4.E19.m1.4.4.1.1.5.4.5.2.3.cmml" xref="S4.E19.m1.4.4.1.1.5.4.5.2.3">𝑖</ci></apply></apply><list id="S4.E19.m1.4.4.1.1.5.4.2.3.cmml" xref="S4.E19.m1.4.4.1.1.5.4.2.2"><apply id="S4.E19.m1.4.4.1.1.4.3.1.1.1.cmml" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.4.3.1.1.1.1.cmml" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1">superscript</csymbol><apply id="S4.E19.m1.4.4.1.1.4.3.1.1.1.2.cmml" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.4.3.1.1.1.2.1.cmml" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.4.3.1.1.1.2.2.cmml" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S4.E19.m1.4.4.1.1.4.3.1.1.1.2.3.cmml" xref="S4.E19.m1.4.4.1.1.4.3.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E19.m1.3.3.1.1.cmml" xref="S4.E19.m1.3.3.1.1">𝑡</ci></apply><apply id="S4.E19.m1.4.4.1.1.5.4.2.2.2.cmml" xref="S4.E19.m1.4.4.1.1.5.4.2.2.2"><csymbol cd="ambiguous" id="S4.E19.m1.4.4.1.1.5.4.2.2.2.1.cmml" xref="S4.E19.m1.4.4.1.1.5.4.2.2.2">subscript</csymbol><ci id="S4.E19.m1.4.4.1.1.5.4.2.2.2.2.cmml" xref="S4.E19.m1.4.4.1.1.5.4.2.2.2.2">𝐡</ci><ci id="S4.E19.m1.4.4.1.1.5.4.2.2.2.3.cmml" xref="S4.E19.m1.4.4.1.1.5.4.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E19.m1.4c">\nabla_{\bm{w}}L_{i}({\bm{w}}_{i}^{(t)})=\nabla_{\bm{w}}\ell_{i}({\bm{w}}_{i}^{(t)};\xi_{i})+{\mu}\nabla_{{\bm{\phi}}}\ell_{i}({\bm{\phi}}_{i}^{(t)};{\bf{h}}_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<table id="S4.E20" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E20.m1.4" class="ltx_Math" alttext="{\bm{w}}_{i}^{(t)}={\bm{w}}_{i}^{(t)}-\eta\nabla_{\bm{w}}L_{i}({\bm{w}}_{i}^{(t)})," display="block"><semantics id="S4.E20.m1.4a"><mrow id="S4.E20.m1.4.4.1" xref="S4.E20.m1.4.4.1.1.cmml"><mrow id="S4.E20.m1.4.4.1.1" xref="S4.E20.m1.4.4.1.1.cmml"><msubsup id="S4.E20.m1.4.4.1.1.3" xref="S4.E20.m1.4.4.1.1.3.cmml"><mi id="S4.E20.m1.4.4.1.1.3.2.2" xref="S4.E20.m1.4.4.1.1.3.2.2.cmml">𝒘</mi><mi id="S4.E20.m1.4.4.1.1.3.2.3" xref="S4.E20.m1.4.4.1.1.3.2.3.cmml">i</mi><mrow id="S4.E20.m1.1.1.1.3" xref="S4.E20.m1.4.4.1.1.3.cmml"><mo stretchy="false" id="S4.E20.m1.1.1.1.3.1" xref="S4.E20.m1.4.4.1.1.3.cmml">(</mo><mi id="S4.E20.m1.1.1.1.1" xref="S4.E20.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S4.E20.m1.1.1.1.3.2" xref="S4.E20.m1.4.4.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S4.E20.m1.4.4.1.1.2" xref="S4.E20.m1.4.4.1.1.2.cmml">=</mo><mrow id="S4.E20.m1.4.4.1.1.1" xref="S4.E20.m1.4.4.1.1.1.cmml"><msubsup id="S4.E20.m1.4.4.1.1.1.3" xref="S4.E20.m1.4.4.1.1.1.3.cmml"><mi id="S4.E20.m1.4.4.1.1.1.3.2.2" xref="S4.E20.m1.4.4.1.1.1.3.2.2.cmml">𝒘</mi><mi id="S4.E20.m1.4.4.1.1.1.3.2.3" xref="S4.E20.m1.4.4.1.1.1.3.2.3.cmml">i</mi><mrow id="S4.E20.m1.2.2.1.3" xref="S4.E20.m1.4.4.1.1.1.3.cmml"><mo stretchy="false" id="S4.E20.m1.2.2.1.3.1" xref="S4.E20.m1.4.4.1.1.1.3.cmml">(</mo><mi id="S4.E20.m1.2.2.1.1" xref="S4.E20.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S4.E20.m1.2.2.1.3.2" xref="S4.E20.m1.4.4.1.1.1.3.cmml">)</mo></mrow></msubsup><mo id="S4.E20.m1.4.4.1.1.1.2" xref="S4.E20.m1.4.4.1.1.1.2.cmml">−</mo><mrow id="S4.E20.m1.4.4.1.1.1.1" xref="S4.E20.m1.4.4.1.1.1.1.cmml"><mi id="S4.E20.m1.4.4.1.1.1.1.3" xref="S4.E20.m1.4.4.1.1.1.1.3.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="S4.E20.m1.4.4.1.1.1.1.2" xref="S4.E20.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S4.E20.m1.4.4.1.1.1.1.4" xref="S4.E20.m1.4.4.1.1.1.1.4.cmml"><msub id="S4.E20.m1.4.4.1.1.1.1.4.1" xref="S4.E20.m1.4.4.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S4.E20.m1.4.4.1.1.1.1.4.1.2" xref="S4.E20.m1.4.4.1.1.1.1.4.1.2.cmml">∇</mo><mi id="S4.E20.m1.4.4.1.1.1.1.4.1.3" xref="S4.E20.m1.4.4.1.1.1.1.4.1.3.cmml">𝒘</mi></msub><msub id="S4.E20.m1.4.4.1.1.1.1.4.2" xref="S4.E20.m1.4.4.1.1.1.1.4.2.cmml"><mi id="S4.E20.m1.4.4.1.1.1.1.4.2.2" xref="S4.E20.m1.4.4.1.1.1.1.4.2.2.cmml">L</mi><mi id="S4.E20.m1.4.4.1.1.1.1.4.2.3" xref="S4.E20.m1.4.4.1.1.1.1.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E20.m1.4.4.1.1.1.1.2a" xref="S4.E20.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S4.E20.m1.4.4.1.1.1.1.1.1" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E20.m1.4.4.1.1.1.1.1.1.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E20.m1.4.4.1.1.1.1.1.1.1" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">𝒘</mi><mi id="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S4.E20.m1.3.3.1.3" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E20.m1.3.3.1.3.1" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E20.m1.3.3.1.1" xref="S4.E20.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="S4.E20.m1.3.3.1.3.2" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.E20.m1.4.4.1.1.1.1.1.1.3" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E20.m1.4.4.1.2" xref="S4.E20.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E20.m1.4b"><apply id="S4.E20.m1.4.4.1.1.cmml" xref="S4.E20.m1.4.4.1"><eq id="S4.E20.m1.4.4.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.2"></eq><apply id="S4.E20.m1.4.4.1.1.3.cmml" xref="S4.E20.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.3.1.cmml" xref="S4.E20.m1.4.4.1.1.3">superscript</csymbol><apply id="S4.E20.m1.4.4.1.1.3.2.cmml" xref="S4.E20.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.3.2.1.cmml" xref="S4.E20.m1.4.4.1.1.3">subscript</csymbol><ci id="S4.E20.m1.4.4.1.1.3.2.2.cmml" xref="S4.E20.m1.4.4.1.1.3.2.2">𝒘</ci><ci id="S4.E20.m1.4.4.1.1.3.2.3.cmml" xref="S4.E20.m1.4.4.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E20.m1.1.1.1.1.cmml" xref="S4.E20.m1.1.1.1.1">𝑡</ci></apply><apply id="S4.E20.m1.4.4.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1"><minus id="S4.E20.m1.4.4.1.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.1.2"></minus><apply id="S4.E20.m1.4.4.1.1.1.3.cmml" xref="S4.E20.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.1.3.1.cmml" xref="S4.E20.m1.4.4.1.1.1.3">superscript</csymbol><apply id="S4.E20.m1.4.4.1.1.1.3.2.cmml" xref="S4.E20.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.1.3.2.1.cmml" xref="S4.E20.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S4.E20.m1.4.4.1.1.1.3.2.2.cmml" xref="S4.E20.m1.4.4.1.1.1.3.2.2">𝒘</ci><ci id="S4.E20.m1.4.4.1.1.1.3.2.3.cmml" xref="S4.E20.m1.4.4.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E20.m1.2.2.1.1.cmml" xref="S4.E20.m1.2.2.1.1">𝑡</ci></apply><apply id="S4.E20.m1.4.4.1.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1"><times id="S4.E20.m1.4.4.1.1.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.2"></times><ci id="S4.E20.m1.4.4.1.1.1.1.3.cmml" xref="S4.E20.m1.4.4.1.1.1.1.3">𝜂</ci><apply id="S4.E20.m1.4.4.1.1.1.1.4.cmml" xref="S4.E20.m1.4.4.1.1.1.1.4"><apply id="S4.E20.m1.4.4.1.1.1.1.4.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.1.1.4.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.4.1">subscript</csymbol><ci id="S4.E20.m1.4.4.1.1.1.1.4.1.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.4.1.2">∇</ci><ci id="S4.E20.m1.4.4.1.1.1.1.4.1.3.cmml" xref="S4.E20.m1.4.4.1.1.1.1.4.1.3">𝒘</ci></apply><apply id="S4.E20.m1.4.4.1.1.1.1.4.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.1.1.4.2.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.4.2">subscript</csymbol><ci id="S4.E20.m1.4.4.1.1.1.1.4.2.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.4.2.2">𝐿</ci><ci id="S4.E20.m1.4.4.1.1.1.1.4.2.3.cmml" xref="S4.E20.m1.4.4.1.1.1.1.4.2.3">𝑖</ci></apply></apply><apply id="S4.E20.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.2">𝒘</ci><ci id="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E20.m1.4.4.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E20.m1.3.3.1.1.cmml" xref="S4.E20.m1.3.3.1.1">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E20.m1.4c">{\bm{w}}_{i}^{(t)}={\bm{w}}_{i}^{(t)}-\eta\nabla_{\bm{w}}L_{i}({\bm{w}}_{i}^{(t)}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.3" class="ltx_p">where the <math id="S4.SS3.p2.3.m1.1" class="ltx_Math" alttext="\xi_{i}" display="inline"><semantics id="S4.SS3.p2.3.m1.1a"><msub id="S4.SS3.p2.3.m1.1.1" xref="S4.SS3.p2.3.m1.1.1.cmml"><mi id="S4.SS3.p2.3.m1.1.1.2" xref="S4.SS3.p2.3.m1.1.1.2.cmml">ξ</mi><mi id="S4.SS3.p2.3.m1.1.1.3" xref="S4.SS3.p2.3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m1.1b"><apply id="S4.SS3.p2.3.m1.1.1.cmml" xref="S4.SS3.p2.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m1.1.1.1.cmml" xref="S4.SS3.p2.3.m1.1.1">subscript</csymbol><ci id="S4.SS3.p2.3.m1.1.1.2.cmml" xref="S4.SS3.p2.3.m1.1.1.2">𝜉</ci><ci id="S4.SS3.p2.3.m1.1.1.3.cmml" xref="S4.SS3.p2.3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m1.1c">\xi_{i}</annotation></semantics></math> denotes mini-batch data instead of a single data point in practical implementations. It can be easily found that the main differences between our method and FedAvg include employing the relaxed balanced-softmax in computing the local cross-entropy loss and class-ordered cyclic feature-level augmentation.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">Local Prototypes Extraction.</span> After the local model updating, the local feature prototypes for each class can be computed through a single pass on the local set as follows,</p>
<table id="S4.E21" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E21.m1.11" class="ltx_Math" alttext="\hat{\bm{p}}_{i,c}^{(t+1)}=\frac{\sum_{j=1}^{n_{i}}\bm{1}(y_{j}^{(i)}=c)\bm{f}_{\bm{\theta}_{i}^{(t+1)}}(x_{j}^{(i)})}{\sum_{j=1}^{n_{i}}.\bm{1}(y_{j}^{(i)}=c)},\quad\forall c\in\mathcal{Y}." display="block"><semantics id="S4.E21.m1.11a"><mrow id="S4.E21.m1.11.11.1"><mrow id="S4.E21.m1.11.11.1.1.2" xref="S4.E21.m1.11.11.1.1.3.cmml"><mrow id="S4.E21.m1.11.11.1.1.1.1" xref="S4.E21.m1.11.11.1.1.1.1.cmml"><msubsup id="S4.E21.m1.11.11.1.1.1.1.2" xref="S4.E21.m1.11.11.1.1.1.1.2.cmml"><mover accent="true" id="S4.E21.m1.11.11.1.1.1.1.2.2.2" xref="S4.E21.m1.11.11.1.1.1.1.2.2.2.cmml"><mi id="S4.E21.m1.11.11.1.1.1.1.2.2.2.2" xref="S4.E21.m1.11.11.1.1.1.1.2.2.2.2.cmml">𝒑</mi><mo id="S4.E21.m1.11.11.1.1.1.1.2.2.2.1" xref="S4.E21.m1.11.11.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mrow id="S4.E21.m1.2.2.2.4" xref="S4.E21.m1.2.2.2.3.cmml"><mi id="S4.E21.m1.1.1.1.1" xref="S4.E21.m1.1.1.1.1.cmml">i</mi><mo id="S4.E21.m1.2.2.2.4.1" xref="S4.E21.m1.2.2.2.3.cmml">,</mo><mi id="S4.E21.m1.2.2.2.2" xref="S4.E21.m1.2.2.2.2.cmml">c</mi></mrow><mrow id="S4.E21.m1.3.3.1.1" xref="S4.E21.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.E21.m1.3.3.1.1.2" xref="S4.E21.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.E21.m1.3.3.1.1.1" xref="S4.E21.m1.3.3.1.1.1.cmml"><mi id="S4.E21.m1.3.3.1.1.1.2" xref="S4.E21.m1.3.3.1.1.1.2.cmml">t</mi><mo id="S4.E21.m1.3.3.1.1.1.1" xref="S4.E21.m1.3.3.1.1.1.1.cmml">+</mo><mn id="S4.E21.m1.3.3.1.1.1.3" xref="S4.E21.m1.3.3.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E21.m1.3.3.1.1.3" xref="S4.E21.m1.3.3.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E21.m1.11.11.1.1.1.1.1" xref="S4.E21.m1.11.11.1.1.1.1.1.cmml">=</mo><mfrac id="S4.E21.m1.10.10" xref="S4.E21.m1.10.10.cmml"><mrow id="S4.E21.m1.8.8.5" xref="S4.E21.m1.8.8.5.cmml"><msubsup id="S4.E21.m1.8.8.5.6" xref="S4.E21.m1.8.8.5.6.cmml"><mo id="S4.E21.m1.8.8.5.6.2.2" xref="S4.E21.m1.8.8.5.6.2.2.cmml">∑</mo><mrow id="S4.E21.m1.8.8.5.6.2.3" xref="S4.E21.m1.8.8.5.6.2.3.cmml"><mi id="S4.E21.m1.8.8.5.6.2.3.2" xref="S4.E21.m1.8.8.5.6.2.3.2.cmml">j</mi><mo id="S4.E21.m1.8.8.5.6.2.3.1" xref="S4.E21.m1.8.8.5.6.2.3.1.cmml">=</mo><mn id="S4.E21.m1.8.8.5.6.2.3.3" xref="S4.E21.m1.8.8.5.6.2.3.3.cmml">1</mn></mrow><msub id="S4.E21.m1.8.8.5.6.3" xref="S4.E21.m1.8.8.5.6.3.cmml"><mi id="S4.E21.m1.8.8.5.6.3.2" xref="S4.E21.m1.8.8.5.6.3.2.cmml">n</mi><mi id="S4.E21.m1.8.8.5.6.3.3" xref="S4.E21.m1.8.8.5.6.3.3.cmml">i</mi></msub></msubsup><mrow id="S4.E21.m1.8.8.5.5" xref="S4.E21.m1.8.8.5.5.cmml"><mn id="S4.E21.m1.8.8.5.5.4" xref="S4.E21.m1.8.8.5.5.4.cmml">𝟏</mn><mo lspace="0em" rspace="0em" id="S4.E21.m1.8.8.5.5.3" xref="S4.E21.m1.8.8.5.5.3.cmml">​</mo><mrow id="S4.E21.m1.7.7.4.4.1.1" xref="S4.E21.m1.7.7.4.4.1.1.1.cmml"><mo stretchy="false" id="S4.E21.m1.7.7.4.4.1.1.2" xref="S4.E21.m1.7.7.4.4.1.1.1.cmml">(</mo><mrow id="S4.E21.m1.7.7.4.4.1.1.1" xref="S4.E21.m1.7.7.4.4.1.1.1.cmml"><msubsup id="S4.E21.m1.7.7.4.4.1.1.1.2" xref="S4.E21.m1.7.7.4.4.1.1.1.2.cmml"><mi id="S4.E21.m1.7.7.4.4.1.1.1.2.2.2" xref="S4.E21.m1.7.7.4.4.1.1.1.2.2.2.cmml">y</mi><mi id="S4.E21.m1.7.7.4.4.1.1.1.2.2.3" xref="S4.E21.m1.7.7.4.4.1.1.1.2.2.3.cmml">j</mi><mrow id="S4.E21.m1.4.4.1.1.1.3" xref="S4.E21.m1.7.7.4.4.1.1.1.2.cmml"><mo stretchy="false" id="S4.E21.m1.4.4.1.1.1.3.1" xref="S4.E21.m1.7.7.4.4.1.1.1.2.cmml">(</mo><mi id="S4.E21.m1.4.4.1.1.1.1" xref="S4.E21.m1.4.4.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.E21.m1.4.4.1.1.1.3.2" xref="S4.E21.m1.7.7.4.4.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.E21.m1.7.7.4.4.1.1.1.1" xref="S4.E21.m1.7.7.4.4.1.1.1.1.cmml">=</mo><mi id="S4.E21.m1.7.7.4.4.1.1.1.3" xref="S4.E21.m1.7.7.4.4.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S4.E21.m1.7.7.4.4.1.1.3" xref="S4.E21.m1.7.7.4.4.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E21.m1.8.8.5.5.3a" xref="S4.E21.m1.8.8.5.5.3.cmml">​</mo><msub id="S4.E21.m1.8.8.5.5.5" xref="S4.E21.m1.8.8.5.5.5.cmml"><mi id="S4.E21.m1.8.8.5.5.5.2" xref="S4.E21.m1.8.8.5.5.5.2.cmml">𝒇</mi><msubsup id="S4.E21.m1.5.5.2.2.1" xref="S4.E21.m1.5.5.2.2.1.cmml"><mi id="S4.E21.m1.5.5.2.2.1.3.2" xref="S4.E21.m1.5.5.2.2.1.3.2.cmml">𝜽</mi><mi id="S4.E21.m1.5.5.2.2.1.3.3" xref="S4.E21.m1.5.5.2.2.1.3.3.cmml">i</mi><mrow id="S4.E21.m1.5.5.2.2.1.1.1.1" xref="S4.E21.m1.5.5.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E21.m1.5.5.2.2.1.1.1.1.2" xref="S4.E21.m1.5.5.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.E21.m1.5.5.2.2.1.1.1.1.1" xref="S4.E21.m1.5.5.2.2.1.1.1.1.1.cmml"><mi id="S4.E21.m1.5.5.2.2.1.1.1.1.1.2" xref="S4.E21.m1.5.5.2.2.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E21.m1.5.5.2.2.1.1.1.1.1.1" xref="S4.E21.m1.5.5.2.2.1.1.1.1.1.1.cmml">+</mo><mn id="S4.E21.m1.5.5.2.2.1.1.1.1.1.3" xref="S4.E21.m1.5.5.2.2.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E21.m1.5.5.2.2.1.1.1.1.3" xref="S4.E21.m1.5.5.2.2.1.1.1.1.1.cmml">)</mo></mrow></msubsup></msub><mo lspace="0em" rspace="0em" id="S4.E21.m1.8.8.5.5.3b" xref="S4.E21.m1.8.8.5.5.3.cmml">​</mo><mrow id="S4.E21.m1.8.8.5.5.2.1" xref="S4.E21.m1.8.8.5.5.2.1.1.cmml"><mo stretchy="false" id="S4.E21.m1.8.8.5.5.2.1.2" xref="S4.E21.m1.8.8.5.5.2.1.1.cmml">(</mo><msubsup id="S4.E21.m1.8.8.5.5.2.1.1" xref="S4.E21.m1.8.8.5.5.2.1.1.cmml"><mi id="S4.E21.m1.8.8.5.5.2.1.1.2.2" xref="S4.E21.m1.8.8.5.5.2.1.1.2.2.cmml">x</mi><mi id="S4.E21.m1.8.8.5.5.2.1.1.2.3" xref="S4.E21.m1.8.8.5.5.2.1.1.2.3.cmml">j</mi><mrow id="S4.E21.m1.6.6.3.3.1.3" xref="S4.E21.m1.8.8.5.5.2.1.1.cmml"><mo stretchy="false" id="S4.E21.m1.6.6.3.3.1.3.1" xref="S4.E21.m1.8.8.5.5.2.1.1.cmml">(</mo><mi id="S4.E21.m1.6.6.3.3.1.1" xref="S4.E21.m1.6.6.3.3.1.1.cmml">i</mi><mo stretchy="false" id="S4.E21.m1.6.6.3.3.1.3.2" xref="S4.E21.m1.8.8.5.5.2.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.E21.m1.8.8.5.5.2.1.3" xref="S4.E21.m1.8.8.5.5.2.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S4.E21.m1.10.10.7" xref="S4.E21.m1.10.10.7.cmml"><msubsup id="S4.E21.m1.10.10.7.3" xref="S4.E21.m1.10.10.7.3.cmml"><mo id="S4.E21.m1.10.10.7.3.2.2" xref="S4.E21.m1.10.10.7.3.2.2.cmml">∑</mo><mrow id="S4.E21.m1.10.10.7.3.2.3" xref="S4.E21.m1.10.10.7.3.2.3.cmml"><mi id="S4.E21.m1.10.10.7.3.2.3.2" xref="S4.E21.m1.10.10.7.3.2.3.2.cmml">j</mi><mo id="S4.E21.m1.10.10.7.3.2.3.1" xref="S4.E21.m1.10.10.7.3.2.3.1.cmml">=</mo><mn id="S4.E21.m1.10.10.7.3.2.3.3" xref="S4.E21.m1.10.10.7.3.2.3.3.cmml">1</mn></mrow><msub id="S4.E21.m1.10.10.7.3.3" xref="S4.E21.m1.10.10.7.3.3.cmml"><mi id="S4.E21.m1.10.10.7.3.3.2" xref="S4.E21.m1.10.10.7.3.3.2.cmml">n</mi><mi id="S4.E21.m1.10.10.7.3.3.3" xref="S4.E21.m1.10.10.7.3.3.3.cmml">i</mi></msub></msubsup><mrow id="S4.E21.m1.10.10.7.2" xref="S4.E21.m1.10.10.7.2.cmml"><mn class="ltx_mathvariant_bold" mathvariant="bold" id="S4.E21.m1.10.10.7.2.3" xref="S4.E21.m1.10.10.7.2.3.cmml">.1</mn><mo lspace="0em" rspace="0em" id="S4.E21.m1.10.10.7.2.2" xref="S4.E21.m1.10.10.7.2.2.cmml">​</mo><mrow id="S4.E21.m1.10.10.7.2.1.1" xref="S4.E21.m1.10.10.7.2.1.1.1.cmml"><mo stretchy="false" id="S4.E21.m1.10.10.7.2.1.1.2" xref="S4.E21.m1.10.10.7.2.1.1.1.cmml">(</mo><mrow id="S4.E21.m1.10.10.7.2.1.1.1" xref="S4.E21.m1.10.10.7.2.1.1.1.cmml"><msubsup id="S4.E21.m1.10.10.7.2.1.1.1.2" xref="S4.E21.m1.10.10.7.2.1.1.1.2.cmml"><mi id="S4.E21.m1.10.10.7.2.1.1.1.2.2.2" xref="S4.E21.m1.10.10.7.2.1.1.1.2.2.2.cmml">y</mi><mi id="S4.E21.m1.10.10.7.2.1.1.1.2.2.3" xref="S4.E21.m1.10.10.7.2.1.1.1.2.2.3.cmml">j</mi><mrow id="S4.E21.m1.9.9.6.1.1.3" xref="S4.E21.m1.10.10.7.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.E21.m1.9.9.6.1.1.3.1" xref="S4.E21.m1.10.10.7.2.1.1.1.2.cmml">(</mo><mi id="S4.E21.m1.9.9.6.1.1.1" xref="S4.E21.m1.9.9.6.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.E21.m1.9.9.6.1.1.3.2" xref="S4.E21.m1.10.10.7.2.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S4.E21.m1.10.10.7.2.1.1.1.1" xref="S4.E21.m1.10.10.7.2.1.1.1.1.cmml">=</mo><mi id="S4.E21.m1.10.10.7.2.1.1.1.3" xref="S4.E21.m1.10.10.7.2.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="S4.E21.m1.10.10.7.2.1.1.3" xref="S4.E21.m1.10.10.7.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo rspace="1.167em" id="S4.E21.m1.11.11.1.1.2.3" xref="S4.E21.m1.11.11.1.1.3a.cmml">,</mo><mrow id="S4.E21.m1.11.11.1.1.2.2" xref="S4.E21.m1.11.11.1.1.2.2.cmml"><mrow id="S4.E21.m1.11.11.1.1.2.2.2" xref="S4.E21.m1.11.11.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S4.E21.m1.11.11.1.1.2.2.2.1" xref="S4.E21.m1.11.11.1.1.2.2.2.1.cmml">∀</mo><mi id="S4.E21.m1.11.11.1.1.2.2.2.2" xref="S4.E21.m1.11.11.1.1.2.2.2.2.cmml">c</mi></mrow><mo id="S4.E21.m1.11.11.1.1.2.2.1" xref="S4.E21.m1.11.11.1.1.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E21.m1.11.11.1.1.2.2.3" xref="S4.E21.m1.11.11.1.1.2.2.3.cmml">𝒴</mi></mrow></mrow><mo lspace="0em" id="S4.E21.m1.11.11.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E21.m1.11b"><apply id="S4.E21.m1.11.11.1.1.3.cmml" xref="S4.E21.m1.11.11.1.1.2"><csymbol cd="ambiguous" id="S4.E21.m1.11.11.1.1.3a.cmml" xref="S4.E21.m1.11.11.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E21.m1.11.11.1.1.1.1.cmml" xref="S4.E21.m1.11.11.1.1.1.1"><eq id="S4.E21.m1.11.11.1.1.1.1.1.cmml" xref="S4.E21.m1.11.11.1.1.1.1.1"></eq><apply id="S4.E21.m1.11.11.1.1.1.1.2.cmml" xref="S4.E21.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E21.m1.11.11.1.1.1.1.2.1.cmml" xref="S4.E21.m1.11.11.1.1.1.1.2">superscript</csymbol><apply id="S4.E21.m1.11.11.1.1.1.1.2.2.cmml" xref="S4.E21.m1.11.11.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E21.m1.11.11.1.1.1.1.2.2.1.cmml" xref="S4.E21.m1.11.11.1.1.1.1.2">subscript</csymbol><apply id="S4.E21.m1.11.11.1.1.1.1.2.2.2.cmml" xref="S4.E21.m1.11.11.1.1.1.1.2.2.2"><ci id="S4.E21.m1.11.11.1.1.1.1.2.2.2.1.cmml" xref="S4.E21.m1.11.11.1.1.1.1.2.2.2.1">^</ci><ci id="S4.E21.m1.11.11.1.1.1.1.2.2.2.2.cmml" xref="S4.E21.m1.11.11.1.1.1.1.2.2.2.2">𝒑</ci></apply><list id="S4.E21.m1.2.2.2.3.cmml" xref="S4.E21.m1.2.2.2.4"><ci id="S4.E21.m1.1.1.1.1.cmml" xref="S4.E21.m1.1.1.1.1">𝑖</ci><ci id="S4.E21.m1.2.2.2.2.cmml" xref="S4.E21.m1.2.2.2.2">𝑐</ci></list></apply><apply id="S4.E21.m1.3.3.1.1.1.cmml" xref="S4.E21.m1.3.3.1.1"><plus id="S4.E21.m1.3.3.1.1.1.1.cmml" xref="S4.E21.m1.3.3.1.1.1.1"></plus><ci id="S4.E21.m1.3.3.1.1.1.2.cmml" xref="S4.E21.m1.3.3.1.1.1.2">𝑡</ci><cn type="integer" id="S4.E21.m1.3.3.1.1.1.3.cmml" xref="S4.E21.m1.3.3.1.1.1.3">1</cn></apply></apply><apply id="S4.E21.m1.10.10.cmml" xref="S4.E21.m1.10.10"><divide id="S4.E21.m1.10.10.8.cmml" xref="S4.E21.m1.10.10"></divide><apply id="S4.E21.m1.8.8.5.cmml" xref="S4.E21.m1.8.8.5"><apply id="S4.E21.m1.8.8.5.6.cmml" xref="S4.E21.m1.8.8.5.6"><csymbol cd="ambiguous" id="S4.E21.m1.8.8.5.6.1.cmml" xref="S4.E21.m1.8.8.5.6">superscript</csymbol><apply id="S4.E21.m1.8.8.5.6.2.cmml" xref="S4.E21.m1.8.8.5.6"><csymbol cd="ambiguous" id="S4.E21.m1.8.8.5.6.2.1.cmml" xref="S4.E21.m1.8.8.5.6">subscript</csymbol><sum id="S4.E21.m1.8.8.5.6.2.2.cmml" xref="S4.E21.m1.8.8.5.6.2.2"></sum><apply id="S4.E21.m1.8.8.5.6.2.3.cmml" xref="S4.E21.m1.8.8.5.6.2.3"><eq id="S4.E21.m1.8.8.5.6.2.3.1.cmml" xref="S4.E21.m1.8.8.5.6.2.3.1"></eq><ci id="S4.E21.m1.8.8.5.6.2.3.2.cmml" xref="S4.E21.m1.8.8.5.6.2.3.2">𝑗</ci><cn type="integer" id="S4.E21.m1.8.8.5.6.2.3.3.cmml" xref="S4.E21.m1.8.8.5.6.2.3.3">1</cn></apply></apply><apply id="S4.E21.m1.8.8.5.6.3.cmml" xref="S4.E21.m1.8.8.5.6.3"><csymbol cd="ambiguous" id="S4.E21.m1.8.8.5.6.3.1.cmml" xref="S4.E21.m1.8.8.5.6.3">subscript</csymbol><ci id="S4.E21.m1.8.8.5.6.3.2.cmml" xref="S4.E21.m1.8.8.5.6.3.2">𝑛</ci><ci id="S4.E21.m1.8.8.5.6.3.3.cmml" xref="S4.E21.m1.8.8.5.6.3.3">𝑖</ci></apply></apply><apply id="S4.E21.m1.8.8.5.5.cmml" xref="S4.E21.m1.8.8.5.5"><times id="S4.E21.m1.8.8.5.5.3.cmml" xref="S4.E21.m1.8.8.5.5.3"></times><cn type="integer" id="S4.E21.m1.8.8.5.5.4.cmml" xref="S4.E21.m1.8.8.5.5.4">1</cn><apply id="S4.E21.m1.7.7.4.4.1.1.1.cmml" xref="S4.E21.m1.7.7.4.4.1.1"><eq id="S4.E21.m1.7.7.4.4.1.1.1.1.cmml" xref="S4.E21.m1.7.7.4.4.1.1.1.1"></eq><apply id="S4.E21.m1.7.7.4.4.1.1.1.2.cmml" xref="S4.E21.m1.7.7.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.E21.m1.7.7.4.4.1.1.1.2.1.cmml" xref="S4.E21.m1.7.7.4.4.1.1.1.2">superscript</csymbol><apply id="S4.E21.m1.7.7.4.4.1.1.1.2.2.cmml" xref="S4.E21.m1.7.7.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.E21.m1.7.7.4.4.1.1.1.2.2.1.cmml" xref="S4.E21.m1.7.7.4.4.1.1.1.2">subscript</csymbol><ci id="S4.E21.m1.7.7.4.4.1.1.1.2.2.2.cmml" xref="S4.E21.m1.7.7.4.4.1.1.1.2.2.2">𝑦</ci><ci id="S4.E21.m1.7.7.4.4.1.1.1.2.2.3.cmml" xref="S4.E21.m1.7.7.4.4.1.1.1.2.2.3">𝑗</ci></apply><ci id="S4.E21.m1.4.4.1.1.1.1.cmml" xref="S4.E21.m1.4.4.1.1.1.1">𝑖</ci></apply><ci id="S4.E21.m1.7.7.4.4.1.1.1.3.cmml" xref="S4.E21.m1.7.7.4.4.1.1.1.3">𝑐</ci></apply><apply id="S4.E21.m1.8.8.5.5.5.cmml" xref="S4.E21.m1.8.8.5.5.5"><csymbol cd="ambiguous" id="S4.E21.m1.8.8.5.5.5.1.cmml" xref="S4.E21.m1.8.8.5.5.5">subscript</csymbol><ci id="S4.E21.m1.8.8.5.5.5.2.cmml" xref="S4.E21.m1.8.8.5.5.5.2">𝒇</ci><apply id="S4.E21.m1.5.5.2.2.1.cmml" xref="S4.E21.m1.5.5.2.2.1"><csymbol cd="ambiguous" id="S4.E21.m1.5.5.2.2.1.2.cmml" xref="S4.E21.m1.5.5.2.2.1">superscript</csymbol><apply id="S4.E21.m1.5.5.2.2.1.3.cmml" xref="S4.E21.m1.5.5.2.2.1"><csymbol cd="ambiguous" id="S4.E21.m1.5.5.2.2.1.3.1.cmml" xref="S4.E21.m1.5.5.2.2.1">subscript</csymbol><ci id="S4.E21.m1.5.5.2.2.1.3.2.cmml" xref="S4.E21.m1.5.5.2.2.1.3.2">𝜽</ci><ci id="S4.E21.m1.5.5.2.2.1.3.3.cmml" xref="S4.E21.m1.5.5.2.2.1.3.3">𝑖</ci></apply><apply id="S4.E21.m1.5.5.2.2.1.1.1.1.1.cmml" xref="S4.E21.m1.5.5.2.2.1.1.1.1"><plus id="S4.E21.m1.5.5.2.2.1.1.1.1.1.1.cmml" xref="S4.E21.m1.5.5.2.2.1.1.1.1.1.1"></plus><ci id="S4.E21.m1.5.5.2.2.1.1.1.1.1.2.cmml" xref="S4.E21.m1.5.5.2.2.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S4.E21.m1.5.5.2.2.1.1.1.1.1.3.cmml" xref="S4.E21.m1.5.5.2.2.1.1.1.1.1.3">1</cn></apply></apply></apply><apply id="S4.E21.m1.8.8.5.5.2.1.1.cmml" xref="S4.E21.m1.8.8.5.5.2.1"><csymbol cd="ambiguous" id="S4.E21.m1.8.8.5.5.2.1.1.1.cmml" xref="S4.E21.m1.8.8.5.5.2.1">superscript</csymbol><apply id="S4.E21.m1.8.8.5.5.2.1.1.2.cmml" xref="S4.E21.m1.8.8.5.5.2.1"><csymbol cd="ambiguous" id="S4.E21.m1.8.8.5.5.2.1.1.2.1.cmml" xref="S4.E21.m1.8.8.5.5.2.1">subscript</csymbol><ci id="S4.E21.m1.8.8.5.5.2.1.1.2.2.cmml" xref="S4.E21.m1.8.8.5.5.2.1.1.2.2">𝑥</ci><ci id="S4.E21.m1.8.8.5.5.2.1.1.2.3.cmml" xref="S4.E21.m1.8.8.5.5.2.1.1.2.3">𝑗</ci></apply><ci id="S4.E21.m1.6.6.3.3.1.1.cmml" xref="S4.E21.m1.6.6.3.3.1.1">𝑖</ci></apply></apply></apply><apply id="S4.E21.m1.10.10.7.cmml" xref="S4.E21.m1.10.10.7"><apply id="S4.E21.m1.10.10.7.3.cmml" xref="S4.E21.m1.10.10.7.3"><csymbol cd="ambiguous" id="S4.E21.m1.10.10.7.3.1.cmml" xref="S4.E21.m1.10.10.7.3">superscript</csymbol><apply id="S4.E21.m1.10.10.7.3.2.cmml" xref="S4.E21.m1.10.10.7.3"><csymbol cd="ambiguous" id="S4.E21.m1.10.10.7.3.2.1.cmml" xref="S4.E21.m1.10.10.7.3">subscript</csymbol><sum id="S4.E21.m1.10.10.7.3.2.2.cmml" xref="S4.E21.m1.10.10.7.3.2.2"></sum><apply id="S4.E21.m1.10.10.7.3.2.3.cmml" xref="S4.E21.m1.10.10.7.3.2.3"><eq id="S4.E21.m1.10.10.7.3.2.3.1.cmml" xref="S4.E21.m1.10.10.7.3.2.3.1"></eq><ci id="S4.E21.m1.10.10.7.3.2.3.2.cmml" xref="S4.E21.m1.10.10.7.3.2.3.2">𝑗</ci><cn type="integer" id="S4.E21.m1.10.10.7.3.2.3.3.cmml" xref="S4.E21.m1.10.10.7.3.2.3.3">1</cn></apply></apply><apply id="S4.E21.m1.10.10.7.3.3.cmml" xref="S4.E21.m1.10.10.7.3.3"><csymbol cd="ambiguous" id="S4.E21.m1.10.10.7.3.3.1.cmml" xref="S4.E21.m1.10.10.7.3.3">subscript</csymbol><ci id="S4.E21.m1.10.10.7.3.3.2.cmml" xref="S4.E21.m1.10.10.7.3.3.2">𝑛</ci><ci id="S4.E21.m1.10.10.7.3.3.3.cmml" xref="S4.E21.m1.10.10.7.3.3.3">𝑖</ci></apply></apply><apply id="S4.E21.m1.10.10.7.2.cmml" xref="S4.E21.m1.10.10.7.2"><times id="S4.E21.m1.10.10.7.2.2.cmml" xref="S4.E21.m1.10.10.7.2.2"></times><cn type="float" id="S4.E21.m1.10.10.7.2.3.cmml" xref="S4.E21.m1.10.10.7.2.3">.1</cn><apply id="S4.E21.m1.10.10.7.2.1.1.1.cmml" xref="S4.E21.m1.10.10.7.2.1.1"><eq id="S4.E21.m1.10.10.7.2.1.1.1.1.cmml" xref="S4.E21.m1.10.10.7.2.1.1.1.1"></eq><apply id="S4.E21.m1.10.10.7.2.1.1.1.2.cmml" xref="S4.E21.m1.10.10.7.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E21.m1.10.10.7.2.1.1.1.2.1.cmml" xref="S4.E21.m1.10.10.7.2.1.1.1.2">superscript</csymbol><apply id="S4.E21.m1.10.10.7.2.1.1.1.2.2.cmml" xref="S4.E21.m1.10.10.7.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E21.m1.10.10.7.2.1.1.1.2.2.1.cmml" xref="S4.E21.m1.10.10.7.2.1.1.1.2">subscript</csymbol><ci id="S4.E21.m1.10.10.7.2.1.1.1.2.2.2.cmml" xref="S4.E21.m1.10.10.7.2.1.1.1.2.2.2">𝑦</ci><ci id="S4.E21.m1.10.10.7.2.1.1.1.2.2.3.cmml" xref="S4.E21.m1.10.10.7.2.1.1.1.2.2.3">𝑗</ci></apply><ci id="S4.E21.m1.9.9.6.1.1.1.cmml" xref="S4.E21.m1.9.9.6.1.1.1">𝑖</ci></apply><ci id="S4.E21.m1.10.10.7.2.1.1.1.3.cmml" xref="S4.E21.m1.10.10.7.2.1.1.1.3">𝑐</ci></apply></apply></apply></apply></apply><apply id="S4.E21.m1.11.11.1.1.2.2.cmml" xref="S4.E21.m1.11.11.1.1.2.2"><in id="S4.E21.m1.11.11.1.1.2.2.1.cmml" xref="S4.E21.m1.11.11.1.1.2.2.1"></in><apply id="S4.E21.m1.11.11.1.1.2.2.2.cmml" xref="S4.E21.m1.11.11.1.1.2.2.2"><csymbol cd="latexml" id="S4.E21.m1.11.11.1.1.2.2.2.1.cmml" xref="S4.E21.m1.11.11.1.1.2.2.2.1">for-all</csymbol><ci id="S4.E21.m1.11.11.1.1.2.2.2.2.cmml" xref="S4.E21.m1.11.11.1.1.2.2.2.2">𝑐</ci></apply><ci id="S4.E21.m1.11.11.1.1.2.2.3.cmml" xref="S4.E21.m1.11.11.1.1.2.2.3">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E21.m1.11c">\hat{\bm{p}}_{i,c}^{(t+1)}=\frac{\sum_{j=1}^{n_{i}}\bm{1}(y_{j}^{(i)}=c)\bm{f}_{\bm{\theta}_{i}^{(t+1)}}(x_{j}^{(i)})}{\sum_{j=1}^{n_{i}}.\bm{1}(y_{j}^{(i)}=c)},\quad\forall c\in\mathcal{Y}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p4" class="ltx_para ltx_noindent">
<p id="S4.SS3.p4.1" class="ltx_p"><span id="S4.SS3.p4.1.1" class="ltx_text ltx_font_bold">Global Model Aggregation.</span>
As mentioned before, the server is only responsible for information aggregation and broadcasting, therefore, we directly employ the sample size-based weighted average for global model updating as follows. Investigating more advanced and sophisticated aggregation methods can be a future direction.
</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<table id="S4.E22" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E22.m1.3" class="ltx_Math" alttext="{\bm{w}}^{(t+1)}=\sum_{i=1}^{m}{\alpha_{i}}{\bm{w}}^{(t)}_{i},\quad\alpha_{i}=\frac{n_{i}}{\sum_{i=1}^{m}n_{i}}." display="block"><semantics id="S4.E22.m1.3a"><mrow id="S4.E22.m1.3.3.1"><mrow id="S4.E22.m1.3.3.1.1.2" xref="S4.E22.m1.3.3.1.1.3.cmml"><mrow id="S4.E22.m1.3.3.1.1.1.1" xref="S4.E22.m1.3.3.1.1.1.1.cmml"><msup id="S4.E22.m1.3.3.1.1.1.1.2" xref="S4.E22.m1.3.3.1.1.1.1.2.cmml"><mi id="S4.E22.m1.3.3.1.1.1.1.2.2" xref="S4.E22.m1.3.3.1.1.1.1.2.2.cmml">𝒘</mi><mrow id="S4.E22.m1.1.1.1.1" xref="S4.E22.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E22.m1.1.1.1.1.2" xref="S4.E22.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E22.m1.1.1.1.1.1" xref="S4.E22.m1.1.1.1.1.1.cmml"><mi id="S4.E22.m1.1.1.1.1.1.2" xref="S4.E22.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E22.m1.1.1.1.1.1.1" xref="S4.E22.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.E22.m1.1.1.1.1.1.3" xref="S4.E22.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E22.m1.1.1.1.1.3" xref="S4.E22.m1.1.1.1.1.1.cmml">)</mo></mrow></msup><mo rspace="0.111em" id="S4.E22.m1.3.3.1.1.1.1.1" xref="S4.E22.m1.3.3.1.1.1.1.1.cmml">=</mo><mrow id="S4.E22.m1.3.3.1.1.1.1.3" xref="S4.E22.m1.3.3.1.1.1.1.3.cmml"><munderover id="S4.E22.m1.3.3.1.1.1.1.3.1" xref="S4.E22.m1.3.3.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S4.E22.m1.3.3.1.1.1.1.3.1.2.2" xref="S4.E22.m1.3.3.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E22.m1.3.3.1.1.1.1.3.1.2.3" xref="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.cmml"><mi id="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.2" xref="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.1" xref="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.3" xref="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E22.m1.3.3.1.1.1.1.3.1.3" xref="S4.E22.m1.3.3.1.1.1.1.3.1.3.cmml">m</mi></munderover><mrow id="S4.E22.m1.3.3.1.1.1.1.3.2" xref="S4.E22.m1.3.3.1.1.1.1.3.2.cmml"><msub id="S4.E22.m1.3.3.1.1.1.1.3.2.2" xref="S4.E22.m1.3.3.1.1.1.1.3.2.2.cmml"><mi id="S4.E22.m1.3.3.1.1.1.1.3.2.2.2" xref="S4.E22.m1.3.3.1.1.1.1.3.2.2.2.cmml">α</mi><mi id="S4.E22.m1.3.3.1.1.1.1.3.2.2.3" xref="S4.E22.m1.3.3.1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E22.m1.3.3.1.1.1.1.3.2.1" xref="S4.E22.m1.3.3.1.1.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E22.m1.3.3.1.1.1.1.3.2.3" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3.cmml"><mi id="S4.E22.m1.3.3.1.1.1.1.3.2.3.2.2" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3.2.2.cmml">𝒘</mi><mi id="S4.E22.m1.3.3.1.1.1.1.3.2.3.3" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3.3.cmml">i</mi><mrow id="S4.E22.m1.2.2.1.3" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3.cmml"><mo stretchy="false" id="S4.E22.m1.2.2.1.3.1" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3.cmml">(</mo><mi id="S4.E22.m1.2.2.1.1" xref="S4.E22.m1.2.2.1.1.cmml">t</mi><mo stretchy="false" id="S4.E22.m1.2.2.1.3.2" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow><mo rspace="1.167em" id="S4.E22.m1.3.3.1.1.2.3" xref="S4.E22.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S4.E22.m1.3.3.1.1.2.2" xref="S4.E22.m1.3.3.1.1.2.2.cmml"><msub id="S4.E22.m1.3.3.1.1.2.2.2" xref="S4.E22.m1.3.3.1.1.2.2.2.cmml"><mi id="S4.E22.m1.3.3.1.1.2.2.2.2" xref="S4.E22.m1.3.3.1.1.2.2.2.2.cmml">α</mi><mi id="S4.E22.m1.3.3.1.1.2.2.2.3" xref="S4.E22.m1.3.3.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S4.E22.m1.3.3.1.1.2.2.1" xref="S4.E22.m1.3.3.1.1.2.2.1.cmml">=</mo><mfrac id="S4.E22.m1.3.3.1.1.2.2.3" xref="S4.E22.m1.3.3.1.1.2.2.3.cmml"><msub id="S4.E22.m1.3.3.1.1.2.2.3.2" xref="S4.E22.m1.3.3.1.1.2.2.3.2.cmml"><mi id="S4.E22.m1.3.3.1.1.2.2.3.2.2" xref="S4.E22.m1.3.3.1.1.2.2.3.2.2.cmml">n</mi><mi id="S4.E22.m1.3.3.1.1.2.2.3.2.3" xref="S4.E22.m1.3.3.1.1.2.2.3.2.3.cmml">i</mi></msub><mrow id="S4.E22.m1.3.3.1.1.2.2.3.3" xref="S4.E22.m1.3.3.1.1.2.2.3.3.cmml"><msubsup id="S4.E22.m1.3.3.1.1.2.2.3.3.1" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.cmml"><mo id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.2" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.cmml"><mi id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.2" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.2.cmml">i</mi><mo id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.1" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.3" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E22.m1.3.3.1.1.2.2.3.3.1.3" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.3.cmml">m</mi></msubsup><msub id="S4.E22.m1.3.3.1.1.2.2.3.3.2" xref="S4.E22.m1.3.3.1.1.2.2.3.3.2.cmml"><mi id="S4.E22.m1.3.3.1.1.2.2.3.3.2.2" xref="S4.E22.m1.3.3.1.1.2.2.3.3.2.2.cmml">n</mi><mi id="S4.E22.m1.3.3.1.1.2.2.3.3.2.3" xref="S4.E22.m1.3.3.1.1.2.2.3.3.2.3.cmml">i</mi></msub></mrow></mfrac></mrow></mrow><mo lspace="0em" id="S4.E22.m1.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E22.m1.3b"><apply id="S4.E22.m1.3.3.1.1.3.cmml" xref="S4.E22.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.3a.cmml" xref="S4.E22.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E22.m1.3.3.1.1.1.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1"><eq id="S4.E22.m1.3.3.1.1.1.1.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1.1"></eq><apply id="S4.E22.m1.3.3.1.1.1.1.2.cmml" xref="S4.E22.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.1.1.2.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1.2">superscript</csymbol><ci id="S4.E22.m1.3.3.1.1.1.1.2.2.cmml" xref="S4.E22.m1.3.3.1.1.1.1.2.2">𝒘</ci><apply id="S4.E22.m1.1.1.1.1.1.cmml" xref="S4.E22.m1.1.1.1.1"><plus id="S4.E22.m1.1.1.1.1.1.1.cmml" xref="S4.E22.m1.1.1.1.1.1.1"></plus><ci id="S4.E22.m1.1.1.1.1.1.2.cmml" xref="S4.E22.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S4.E22.m1.1.1.1.1.1.3.cmml" xref="S4.E22.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.E22.m1.3.3.1.1.1.1.3.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3"><apply id="S4.E22.m1.3.3.1.1.1.1.3.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.1.1.3.1.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.1">superscript</csymbol><apply id="S4.E22.m1.3.3.1.1.1.1.3.1.2.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.1.1.3.1.2.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.1">subscript</csymbol><sum id="S4.E22.m1.3.3.1.1.1.1.3.1.2.2.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.1.2.2"></sum><apply id="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.1.2.3"><eq id="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.1"></eq><ci id="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.2.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.3.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E22.m1.3.3.1.1.1.1.3.1.3.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.1.3">𝑚</ci></apply><apply id="S4.E22.m1.3.3.1.1.1.1.3.2.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2"><times id="S4.E22.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.1"></times><apply id="S4.E22.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.1.1.3.2.2.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.2">subscript</csymbol><ci id="S4.E22.m1.3.3.1.1.1.1.3.2.2.2.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.2.2">𝛼</ci><ci id="S4.E22.m1.3.3.1.1.1.1.3.2.2.3.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S4.E22.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.1.1.3.2.3.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3">subscript</csymbol><apply id="S4.E22.m1.3.3.1.1.1.1.3.2.3.2.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.1.1.3.2.3.2.1.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3">superscript</csymbol><ci id="S4.E22.m1.3.3.1.1.1.1.3.2.3.2.2.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3.2.2">𝒘</ci><ci id="S4.E22.m1.2.2.1.1.cmml" xref="S4.E22.m1.2.2.1.1">𝑡</ci></apply><ci id="S4.E22.m1.3.3.1.1.1.1.3.2.3.3.cmml" xref="S4.E22.m1.3.3.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E22.m1.3.3.1.1.2.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2"><eq id="S4.E22.m1.3.3.1.1.2.2.1.cmml" xref="S4.E22.m1.3.3.1.1.2.2.1"></eq><apply id="S4.E22.m1.3.3.1.1.2.2.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.2.2.2.1.cmml" xref="S4.E22.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S4.E22.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2.2.2">𝛼</ci><ci id="S4.E22.m1.3.3.1.1.2.2.2.3.cmml" xref="S4.E22.m1.3.3.1.1.2.2.2.3">𝑖</ci></apply><apply id="S4.E22.m1.3.3.1.1.2.2.3.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3"><divide id="S4.E22.m1.3.3.1.1.2.2.3.1.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3"></divide><apply id="S4.E22.m1.3.3.1.1.2.2.3.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.2"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.2.2.3.2.1.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.2">subscript</csymbol><ci id="S4.E22.m1.3.3.1.1.2.2.3.2.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.2.2">𝑛</ci><ci id="S4.E22.m1.3.3.1.1.2.2.3.2.3.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.2.3">𝑖</ci></apply><apply id="S4.E22.m1.3.3.1.1.2.2.3.3.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3"><apply id="S4.E22.m1.3.3.1.1.2.2.3.3.1.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.2.2.3.3.1.1.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1">superscript</csymbol><apply id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.1.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1">subscript</csymbol><sum id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.2"></sum><apply id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3"><eq id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.1.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.1"></eq><ci id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.3.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E22.m1.3.3.1.1.2.2.3.3.1.3.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.1.3">𝑚</ci></apply><apply id="S4.E22.m1.3.3.1.1.2.2.3.3.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.E22.m1.3.3.1.1.2.2.3.3.2.1.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.2">subscript</csymbol><ci id="S4.E22.m1.3.3.1.1.2.2.3.3.2.2.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.2.2">𝑛</ci><ci id="S4.E22.m1.3.3.1.1.2.2.3.3.2.3.cmml" xref="S4.E22.m1.3.3.1.1.2.2.3.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E22.m1.3c">{\bm{w}}^{(t+1)}=\sum_{i=1}^{m}{\alpha_{i}}{\bm{w}}^{(t)}_{i},\quad\alpha_{i}=\frac{n_{i}}{\sum_{i=1}^{m}n_{i}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p6" class="ltx_para ltx_noindent">
<p id="S4.SS3.p6.2" class="ltx_p"><span id="S4.SS3.p6.2.1" class="ltx_text ltx_font_bold">Update Global Feature Prototypes.</span> The global prototype <math id="S4.SS3.p6.1.m1.1" class="ltx_Math" alttext="\bm{p}_{c}" display="inline"><semantics id="S4.SS3.p6.1.m1.1a"><msub id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml"><mi id="S4.SS3.p6.1.m1.1.1.2" xref="S4.SS3.p6.1.m1.1.1.2.cmml">𝒑</mi><mi id="S4.SS3.p6.1.m1.1.1.3" xref="S4.SS3.p6.1.m1.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><apply id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p6.1.m1.1.1.2.cmml" xref="S4.SS3.p6.1.m1.1.1.2">𝒑</ci><ci id="S4.SS3.p6.1.m1.1.1.3.cmml" xref="S4.SS3.p6.1.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">\bm{p}_{c}</annotation></semantics></math> for each class <math id="S4.SS3.p6.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS3.p6.2.m2.1a"><mi id="S4.SS3.p6.2.m2.1.1" xref="S4.SS3.p6.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m2.1b"><ci id="S4.SS3.p6.2.m2.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m2.1c">c</annotation></semantics></math> is estimated by aggregating the received local prototypes by the following equation:</p>
</div>
<div id="S4.SS3.p7" class="ltx_para">
<table id="S4.E23" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E23.m1.9" class="ltx_Math" alttext="\normalsize\bm{p}_{c}^{(t+1)}=\frac{1}{\sum_{i=1}^{m}n_{i,c}}\sum_{i=1}^{m}n_{i,c}\hat{\bm{p}}_{i,c}^{(t+1)},\quad\forall c\in\mathcal{Y}." display="block"><semantics id="S4.E23.m1.9a"><mrow id="S4.E23.m1.9.9.1"><mrow id="S4.E23.m1.9.9.1.1.2" xref="S4.E23.m1.9.9.1.1.3.cmml"><mrow id="S4.E23.m1.9.9.1.1.1.1" xref="S4.E23.m1.9.9.1.1.1.1.cmml"><msubsup id="S4.E23.m1.9.9.1.1.1.1.2" xref="S4.E23.m1.9.9.1.1.1.1.2.cmml"><mi id="S4.E23.m1.9.9.1.1.1.1.2.2.2" xref="S4.E23.m1.9.9.1.1.1.1.2.2.2.cmml">𝒑</mi><mi id="S4.E23.m1.9.9.1.1.1.1.2.2.3" xref="S4.E23.m1.9.9.1.1.1.1.2.2.3.cmml">c</mi><mrow id="S4.E23.m1.1.1.1.1" xref="S4.E23.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E23.m1.1.1.1.1.2" xref="S4.E23.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E23.m1.1.1.1.1.1" xref="S4.E23.m1.1.1.1.1.1.cmml"><mi id="S4.E23.m1.1.1.1.1.1.2" xref="S4.E23.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S4.E23.m1.1.1.1.1.1.1" xref="S4.E23.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.E23.m1.1.1.1.1.1.3" xref="S4.E23.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E23.m1.1.1.1.1.3" xref="S4.E23.m1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S4.E23.m1.9.9.1.1.1.1.1" xref="S4.E23.m1.9.9.1.1.1.1.1.cmml">=</mo><mrow id="S4.E23.m1.9.9.1.1.1.1.3" xref="S4.E23.m1.9.9.1.1.1.1.3.cmml"><mfrac id="S4.E23.m1.3.3" xref="S4.E23.m1.3.3.cmml"><mn id="S4.E23.m1.3.3.4" xref="S4.E23.m1.3.3.4.cmml">1</mn><mrow id="S4.E23.m1.3.3.2" xref="S4.E23.m1.3.3.2.cmml"><msubsup id="S4.E23.m1.3.3.2.3" xref="S4.E23.m1.3.3.2.3.cmml"><mo id="S4.E23.m1.3.3.2.3.2.2" xref="S4.E23.m1.3.3.2.3.2.2.cmml">∑</mo><mrow id="S4.E23.m1.3.3.2.3.2.3" xref="S4.E23.m1.3.3.2.3.2.3.cmml"><mi id="S4.E23.m1.3.3.2.3.2.3.2" xref="S4.E23.m1.3.3.2.3.2.3.2.cmml">i</mi><mo id="S4.E23.m1.3.3.2.3.2.3.1" xref="S4.E23.m1.3.3.2.3.2.3.1.cmml">=</mo><mn id="S4.E23.m1.3.3.2.3.2.3.3" xref="S4.E23.m1.3.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.E23.m1.3.3.2.3.3" xref="S4.E23.m1.3.3.2.3.3.cmml">m</mi></msubsup><msub id="S4.E23.m1.3.3.2.4" xref="S4.E23.m1.3.3.2.4.cmml"><mi id="S4.E23.m1.3.3.2.4.2" xref="S4.E23.m1.3.3.2.4.2.cmml">n</mi><mrow id="S4.E23.m1.3.3.2.2.2.4" xref="S4.E23.m1.3.3.2.2.2.3.cmml"><mi id="S4.E23.m1.2.2.1.1.1.1" xref="S4.E23.m1.2.2.1.1.1.1.cmml">i</mi><mo id="S4.E23.m1.3.3.2.2.2.4.1" xref="S4.E23.m1.3.3.2.2.2.3.cmml">,</mo><mi id="S4.E23.m1.3.3.2.2.2.2" xref="S4.E23.m1.3.3.2.2.2.2.cmml">c</mi></mrow></msub></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E23.m1.9.9.1.1.1.1.3.1" xref="S4.E23.m1.9.9.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E23.m1.9.9.1.1.1.1.3.2" xref="S4.E23.m1.9.9.1.1.1.1.3.2.cmml"><munderover id="S4.E23.m1.9.9.1.1.1.1.3.2.1" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.cmml"><mo movablelimits="false" id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.2" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.cmml"><mi id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.2" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.2.cmml">i</mi><mo id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.1" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.3" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E23.m1.9.9.1.1.1.1.3.2.1.3" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.3.cmml">m</mi></munderover><mrow id="S4.E23.m1.9.9.1.1.1.1.3.2.2" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.cmml"><msub id="S4.E23.m1.9.9.1.1.1.1.3.2.2.2" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.2.cmml"><mi id="S4.E23.m1.9.9.1.1.1.1.3.2.2.2.2" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.2.2.cmml">n</mi><mrow id="S4.E23.m1.5.5.2.4" xref="S4.E23.m1.5.5.2.3.cmml"><mi id="S4.E23.m1.4.4.1.1" xref="S4.E23.m1.4.4.1.1.cmml">i</mi><mo id="S4.E23.m1.5.5.2.4.1" xref="S4.E23.m1.5.5.2.3.cmml">,</mo><mi id="S4.E23.m1.5.5.2.2" xref="S4.E23.m1.5.5.2.2.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E23.m1.9.9.1.1.1.1.3.2.2.1" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.1.cmml">​</mo><msubsup id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.cmml"><mover accent="true" id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2.cmml"><mi id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2.2" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2.2.cmml">𝒑</mi><mo id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2.1" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2.1.cmml">^</mo></mover><mrow id="S4.E23.m1.7.7.2.4" xref="S4.E23.m1.7.7.2.3.cmml"><mi id="S4.E23.m1.6.6.1.1" xref="S4.E23.m1.6.6.1.1.cmml">i</mi><mo id="S4.E23.m1.7.7.2.4.1" xref="S4.E23.m1.7.7.2.3.cmml">,</mo><mi id="S4.E23.m1.7.7.2.2" xref="S4.E23.m1.7.7.2.2.cmml">c</mi></mrow><mrow id="S4.E23.m1.8.8.1.1" xref="S4.E23.m1.8.8.1.1.1.cmml"><mo stretchy="false" id="S4.E23.m1.8.8.1.1.2" xref="S4.E23.m1.8.8.1.1.1.cmml">(</mo><mrow id="S4.E23.m1.8.8.1.1.1" xref="S4.E23.m1.8.8.1.1.1.cmml"><mi id="S4.E23.m1.8.8.1.1.1.2" xref="S4.E23.m1.8.8.1.1.1.2.cmml">t</mi><mo id="S4.E23.m1.8.8.1.1.1.1" xref="S4.E23.m1.8.8.1.1.1.1.cmml">+</mo><mn id="S4.E23.m1.8.8.1.1.1.3" xref="S4.E23.m1.8.8.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E23.m1.8.8.1.1.3" xref="S4.E23.m1.8.8.1.1.1.cmml">)</mo></mrow></msubsup></mrow></mrow></mrow></mrow><mo rspace="1.167em" id="S4.E23.m1.9.9.1.1.2.3" xref="S4.E23.m1.9.9.1.1.3a.cmml">,</mo><mrow id="S4.E23.m1.9.9.1.1.2.2" xref="S4.E23.m1.9.9.1.1.2.2.cmml"><mrow id="S4.E23.m1.9.9.1.1.2.2.2" xref="S4.E23.m1.9.9.1.1.2.2.2.cmml"><mo rspace="0.167em" id="S4.E23.m1.9.9.1.1.2.2.2.1" xref="S4.E23.m1.9.9.1.1.2.2.2.1.cmml">∀</mo><mi id="S4.E23.m1.9.9.1.1.2.2.2.2" xref="S4.E23.m1.9.9.1.1.2.2.2.2.cmml">c</mi></mrow><mo id="S4.E23.m1.9.9.1.1.2.2.1" xref="S4.E23.m1.9.9.1.1.2.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E23.m1.9.9.1.1.2.2.3" xref="S4.E23.m1.9.9.1.1.2.2.3.cmml">𝒴</mi></mrow></mrow><mo lspace="0em" id="S4.E23.m1.9.9.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E23.m1.9b"><apply id="S4.E23.m1.9.9.1.1.3.cmml" xref="S4.E23.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S4.E23.m1.9.9.1.1.3a.cmml" xref="S4.E23.m1.9.9.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E23.m1.9.9.1.1.1.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1"><eq id="S4.E23.m1.9.9.1.1.1.1.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.1"></eq><apply id="S4.E23.m1.9.9.1.1.1.1.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E23.m1.9.9.1.1.1.1.2.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.2">superscript</csymbol><apply id="S4.E23.m1.9.9.1.1.1.1.2.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E23.m1.9.9.1.1.1.1.2.2.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.2">subscript</csymbol><ci id="S4.E23.m1.9.9.1.1.1.1.2.2.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.2.2.2">𝒑</ci><ci id="S4.E23.m1.9.9.1.1.1.1.2.2.3.cmml" xref="S4.E23.m1.9.9.1.1.1.1.2.2.3">𝑐</ci></apply><apply id="S4.E23.m1.1.1.1.1.1.cmml" xref="S4.E23.m1.1.1.1.1"><plus id="S4.E23.m1.1.1.1.1.1.1.cmml" xref="S4.E23.m1.1.1.1.1.1.1"></plus><ci id="S4.E23.m1.1.1.1.1.1.2.cmml" xref="S4.E23.m1.1.1.1.1.1.2">𝑡</ci><cn type="integer" id="S4.E23.m1.1.1.1.1.1.3.cmml" xref="S4.E23.m1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S4.E23.m1.9.9.1.1.1.1.3.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3"><times id="S4.E23.m1.9.9.1.1.1.1.3.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.1"></times><apply id="S4.E23.m1.3.3.cmml" xref="S4.E23.m1.3.3"><divide id="S4.E23.m1.3.3.3.cmml" xref="S4.E23.m1.3.3"></divide><cn type="integer" id="S4.E23.m1.3.3.4.cmml" xref="S4.E23.m1.3.3.4">1</cn><apply id="S4.E23.m1.3.3.2.cmml" xref="S4.E23.m1.3.3.2"><apply id="S4.E23.m1.3.3.2.3.cmml" xref="S4.E23.m1.3.3.2.3"><csymbol cd="ambiguous" id="S4.E23.m1.3.3.2.3.1.cmml" xref="S4.E23.m1.3.3.2.3">superscript</csymbol><apply id="S4.E23.m1.3.3.2.3.2.cmml" xref="S4.E23.m1.3.3.2.3"><csymbol cd="ambiguous" id="S4.E23.m1.3.3.2.3.2.1.cmml" xref="S4.E23.m1.3.3.2.3">subscript</csymbol><sum id="S4.E23.m1.3.3.2.3.2.2.cmml" xref="S4.E23.m1.3.3.2.3.2.2"></sum><apply id="S4.E23.m1.3.3.2.3.2.3.cmml" xref="S4.E23.m1.3.3.2.3.2.3"><eq id="S4.E23.m1.3.3.2.3.2.3.1.cmml" xref="S4.E23.m1.3.3.2.3.2.3.1"></eq><ci id="S4.E23.m1.3.3.2.3.2.3.2.cmml" xref="S4.E23.m1.3.3.2.3.2.3.2">𝑖</ci><cn type="integer" id="S4.E23.m1.3.3.2.3.2.3.3.cmml" xref="S4.E23.m1.3.3.2.3.2.3.3">1</cn></apply></apply><ci id="S4.E23.m1.3.3.2.3.3.cmml" xref="S4.E23.m1.3.3.2.3.3">𝑚</ci></apply><apply id="S4.E23.m1.3.3.2.4.cmml" xref="S4.E23.m1.3.3.2.4"><csymbol cd="ambiguous" id="S4.E23.m1.3.3.2.4.1.cmml" xref="S4.E23.m1.3.3.2.4">subscript</csymbol><ci id="S4.E23.m1.3.3.2.4.2.cmml" xref="S4.E23.m1.3.3.2.4.2">𝑛</ci><list id="S4.E23.m1.3.3.2.2.2.3.cmml" xref="S4.E23.m1.3.3.2.2.2.4"><ci id="S4.E23.m1.2.2.1.1.1.1.cmml" xref="S4.E23.m1.2.2.1.1.1.1">𝑖</ci><ci id="S4.E23.m1.3.3.2.2.2.2.cmml" xref="S4.E23.m1.3.3.2.2.2.2">𝑐</ci></list></apply></apply></apply><apply id="S4.E23.m1.9.9.1.1.1.1.3.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2"><apply id="S4.E23.m1.9.9.1.1.1.1.3.2.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E23.m1.9.9.1.1.1.1.3.2.1.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1">superscript</csymbol><apply id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1"><csymbol cd="ambiguous" id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1">subscript</csymbol><sum id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.2"></sum><apply id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3"><eq id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.1"></eq><ci id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.3.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="S4.E23.m1.9.9.1.1.1.1.3.2.1.3.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.1.3">𝑚</ci></apply><apply id="S4.E23.m1.9.9.1.1.1.1.3.2.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2"><times id="S4.E23.m1.9.9.1.1.1.1.3.2.2.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.1"></times><apply id="S4.E23.m1.9.9.1.1.1.1.3.2.2.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E23.m1.9.9.1.1.1.1.3.2.2.2.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S4.E23.m1.9.9.1.1.1.1.3.2.2.2.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.2.2">𝑛</ci><list id="S4.E23.m1.5.5.2.3.cmml" xref="S4.E23.m1.5.5.2.4"><ci id="S4.E23.m1.4.4.1.1.cmml" xref="S4.E23.m1.4.4.1.1">𝑖</ci><ci id="S4.E23.m1.5.5.2.2.cmml" xref="S4.E23.m1.5.5.2.2">𝑐</ci></list></apply><apply id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3">superscript</csymbol><apply id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3">subscript</csymbol><apply id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2"><ci id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2.1.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2.1">^</ci><ci id="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2.2.cmml" xref="S4.E23.m1.9.9.1.1.1.1.3.2.2.3.2.2.2">𝒑</ci></apply><list id="S4.E23.m1.7.7.2.3.cmml" xref="S4.E23.m1.7.7.2.4"><ci id="S4.E23.m1.6.6.1.1.cmml" xref="S4.E23.m1.6.6.1.1">𝑖</ci><ci id="S4.E23.m1.7.7.2.2.cmml" xref="S4.E23.m1.7.7.2.2">𝑐</ci></list></apply><apply id="S4.E23.m1.8.8.1.1.1.cmml" xref="S4.E23.m1.8.8.1.1"><plus id="S4.E23.m1.8.8.1.1.1.1.cmml" xref="S4.E23.m1.8.8.1.1.1.1"></plus><ci id="S4.E23.m1.8.8.1.1.1.2.cmml" xref="S4.E23.m1.8.8.1.1.1.2">𝑡</ci><cn type="integer" id="S4.E23.m1.8.8.1.1.1.3.cmml" xref="S4.E23.m1.8.8.1.1.1.3">1</cn></apply></apply></apply></apply></apply></apply><apply id="S4.E23.m1.9.9.1.1.2.2.cmml" xref="S4.E23.m1.9.9.1.1.2.2"><in id="S4.E23.m1.9.9.1.1.2.2.1.cmml" xref="S4.E23.m1.9.9.1.1.2.2.1"></in><apply id="S4.E23.m1.9.9.1.1.2.2.2.cmml" xref="S4.E23.m1.9.9.1.1.2.2.2"><csymbol cd="latexml" id="S4.E23.m1.9.9.1.1.2.2.2.1.cmml" xref="S4.E23.m1.9.9.1.1.2.2.2.1">for-all</csymbol><ci id="S4.E23.m1.9.9.1.1.2.2.2.2.cmml" xref="S4.E23.m1.9.9.1.1.2.2.2.2">𝑐</ci></apply><ci id="S4.E23.m1.9.9.1.1.2.2.3.cmml" xref="S4.E23.m1.9.9.1.1.2.2.3">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E23.m1.9c">\normalsize\bm{p}_{c}^{(t+1)}=\frac{1}{\sum_{i=1}^{m}n_{i,c}}\sum_{i=1}^{m}n_{i,c}\hat{\bm{p}}_{i,c}^{(t+1)},\quad\forall c\in\mathcal{Y}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p8" class="ltx_para">
<p id="S4.SS3.p8.1" class="ltx_p">When client dropout occurs, the server will not wait for all the <math id="S4.SS3.p8.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS3.p8.1.m1.1a"><mi id="S4.SS3.p8.1.m1.1.1" xref="S4.SS3.p8.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.1.m1.1b"><ci id="S4.SS3.p8.1.m1.1.1.cmml" xref="S4.SS3.p8.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.1.m1.1c">m</annotation></semantics></math> clients at each synchronization round but only collect messages from active clients within a pre-defined time to mitigate the impact of possible stragglers and improve the system efficiency.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span><span id="S4.SS4.1.1" class="ltx_text ltx_font_italic">Practical Consideration</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p"><span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_bold">Efficiency.</span>
During the local training, the main difference is the feature-space augmentation and is implemented by the linear inter-class transfer, which is computation-efficient. The computation of local class-wise feature prototypes would induce negligible overhead as only one pass of local data is needed. The transmission of prototypes is also communication-efficient as the number of bits is much smaller than the size of exchanged parameters. Therefore, the proposed framework is efficient and practical.</p>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.1" class="ltx_p"><span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_bold">Privacy.</span>
Similar to the FedAvg, a relatively large mini-batch size and multiple local epochs are applied for local training, which can offer some extent of privacy guarantee. Our empirical verification will also confirm that the feature prototypes will not raise high privacy risks. Before performing aggregation in the server, anonymization mechanism such as random shuffling <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> can also be equipped to hidden the statistical information of individual clients.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Evaluation</span>
</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span><span id="S5.SS1.1.1" class="ltx_text ltx_font_italic">Experimental Setup</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.p1.1" class="ltx_p"><span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets and Models.</span> Two commonly used benchmark image classification tasks are employed to access our proposed framework, including Fashion-MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite> and CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>. Both datasets contain 10-category objects and can be easily partitioned to simulate the non-IID distributions in FL. Two convolutional neural networks (CNNs) similar to LeNet-5 are constructed as the learning models for the above two datasets. The first CNN model has two convolution-pooling pairs and two fully-connected (FC) layers, where the convolutional layers have 16 and 32 channels, the FC layers have 128 and 10 neurons, respectively. An additional convolutional layer with 64 channels is used for the second CNN model to increase the model capacity, which will be trained on the CIFAR-10 dataset.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.8" class="ltx_p"><span id="S5.SS1.p2.8.1" class="ltx_text ltx_font_bold">Data Allocation.</span> Like previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, we select a small set of samples from only a few classes as the local training data for each client. We assume each client <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">i</annotation></semantics></math> only has samples from <math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">N</annotation></semantics></math> different classes. To be more precise, a subset <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{Y}_{i}\subseteq\mathcal{Y}" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><mrow id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml"><msub id="S5.SS1.p2.3.m3.1.1.2" xref="S5.SS1.p2.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.3.m3.1.1.2.2" xref="S5.SS1.p2.3.m3.1.1.2.2.cmml">𝒴</mi><mi id="S5.SS1.p2.3.m3.1.1.2.3" xref="S5.SS1.p2.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S5.SS1.p2.3.m3.1.1.1" xref="S5.SS1.p2.3.m3.1.1.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml">𝒴</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1"><subset id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1.1"></subset><apply id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m3.1.1.2.1.cmml" xref="S5.SS1.p2.3.m3.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.3.m3.1.1.2.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2.2">𝒴</ci><ci id="S5.SS1.p2.3.m3.1.1.2.3.cmml" xref="S5.SS1.p2.3.m3.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.3.m3.1.1.3.cmml" xref="S5.SS1.p2.3.m3.1.1.3">𝒴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">\mathcal{Y}_{i}\subseteq\mathcal{Y}</annotation></semantics></math> with <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="|\mathcal{Y}_{i}|=N" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mrow id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml"><mrow id="S5.SS1.p2.4.m4.1.1.1.1" xref="S5.SS1.p2.4.m4.1.1.1.2.cmml"><mo stretchy="false" id="S5.SS1.p2.4.m4.1.1.1.1.2" xref="S5.SS1.p2.4.m4.1.1.1.2.1.cmml">|</mo><msub id="S5.SS1.p2.4.m4.1.1.1.1.1" xref="S5.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.4.m4.1.1.1.1.1.2" xref="S5.SS1.p2.4.m4.1.1.1.1.1.2.cmml">𝒴</mi><mi id="S5.SS1.p2.4.m4.1.1.1.1.1.3" xref="S5.SS1.p2.4.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S5.SS1.p2.4.m4.1.1.1.1.3" xref="S5.SS1.p2.4.m4.1.1.1.2.1.cmml">|</mo></mrow><mo id="S5.SS1.p2.4.m4.1.1.2" xref="S5.SS1.p2.4.m4.1.1.2.cmml">=</mo><mi id="S5.SS1.p2.4.m4.1.1.3" xref="S5.SS1.p2.4.m4.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><apply id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1"><eq id="S5.SS1.p2.4.m4.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.2"></eq><apply id="S5.SS1.p2.4.m4.1.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1"><abs id="S5.SS1.p2.4.m4.1.1.1.2.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1.2"></abs><apply id="S5.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1.1.2">𝒴</ci><ci id="S5.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S5.SS1.p2.4.m4.1.1.3.cmml" xref="S5.SS1.p2.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">|\mathcal{Y}_{i}|=N</annotation></semantics></math> and <math id="S5.SS1.p2.5.m5.1" class="ltx_Math" alttext="n_{i}/N" display="inline"><semantics id="S5.SS1.p2.5.m5.1a"><mrow id="S5.SS1.p2.5.m5.1.1" xref="S5.SS1.p2.5.m5.1.1.cmml"><msub id="S5.SS1.p2.5.m5.1.1.2" xref="S5.SS1.p2.5.m5.1.1.2.cmml"><mi id="S5.SS1.p2.5.m5.1.1.2.2" xref="S5.SS1.p2.5.m5.1.1.2.2.cmml">n</mi><mi id="S5.SS1.p2.5.m5.1.1.2.3" xref="S5.SS1.p2.5.m5.1.1.2.3.cmml">i</mi></msub><mo id="S5.SS1.p2.5.m5.1.1.1" xref="S5.SS1.p2.5.m5.1.1.1.cmml">/</mo><mi id="S5.SS1.p2.5.m5.1.1.3" xref="S5.SS1.p2.5.m5.1.1.3.cmml">N</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m5.1b"><apply id="S5.SS1.p2.5.m5.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1"><divide id="S5.SS1.p2.5.m5.1.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1.1"></divide><apply id="S5.SS1.p2.5.m5.1.1.2.cmml" xref="S5.SS1.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.5.m5.1.1.2.1.cmml" xref="S5.SS1.p2.5.m5.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.5.m5.1.1.2.2.cmml" xref="S5.SS1.p2.5.m5.1.1.2.2">𝑛</ci><ci id="S5.SS1.p2.5.m5.1.1.2.3.cmml" xref="S5.SS1.p2.5.m5.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.5.m5.1.1.3.cmml" xref="S5.SS1.p2.5.m5.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.5.m5.1c">n_{i}/N</annotation></semantics></math> instances of each class in <math id="S5.SS1.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{Y}_{i}" display="inline"><semantics id="S5.SS1.p2.6.m6.1a"><msub id="S5.SS1.p2.6.m6.1.1" xref="S5.SS1.p2.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.6.m6.1.1.2" xref="S5.SS1.p2.6.m6.1.1.2.cmml">𝒴</mi><mi id="S5.SS1.p2.6.m6.1.1.3" xref="S5.SS1.p2.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m6.1b"><apply id="S5.SS1.p2.6.m6.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.6.m6.1.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S5.SS1.p2.6.m6.1.1.2.cmml" xref="S5.SS1.p2.6.m6.1.1.2">𝒴</ci><ci id="S5.SS1.p2.6.m6.1.1.3.cmml" xref="S5.SS1.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.6.m6.1c">\mathcal{Y}_{i}</annotation></semantics></math> will be randomly sampled and allocated to client <math id="S5.SS1.p2.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p2.7.m7.1a"><mi id="S5.SS1.p2.7.m7.1.1" xref="S5.SS1.p2.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.7.m7.1b"><ci id="S5.SS1.p2.7.m7.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.7.m7.1c">i</annotation></semantics></math>. In this paper, we set <math id="S5.SS1.p2.8.m8.1" class="ltx_Math" alttext="n_{i}=1000" display="inline"><semantics id="S5.SS1.p2.8.m8.1a"><mrow id="S5.SS1.p2.8.m8.1.1" xref="S5.SS1.p2.8.m8.1.1.cmml"><msub id="S5.SS1.p2.8.m8.1.1.2" xref="S5.SS1.p2.8.m8.1.1.2.cmml"><mi id="S5.SS1.p2.8.m8.1.1.2.2" xref="S5.SS1.p2.8.m8.1.1.2.2.cmml">n</mi><mi id="S5.SS1.p2.8.m8.1.1.2.3" xref="S5.SS1.p2.8.m8.1.1.2.3.cmml">i</mi></msub><mo id="S5.SS1.p2.8.m8.1.1.1" xref="S5.SS1.p2.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.8.m8.1.1.3" xref="S5.SS1.p2.8.m8.1.1.3.cmml">1000</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.8.m8.1b"><apply id="S5.SS1.p2.8.m8.1.1.cmml" xref="S5.SS1.p2.8.m8.1.1"><eq id="S5.SS1.p2.8.m8.1.1.1.cmml" xref="S5.SS1.p2.8.m8.1.1.1"></eq><apply id="S5.SS1.p2.8.m8.1.1.2.cmml" xref="S5.SS1.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.8.m8.1.1.2.1.cmml" xref="S5.SS1.p2.8.m8.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.8.m8.1.1.2.2.cmml" xref="S5.SS1.p2.8.m8.1.1.2.2">𝑛</ci><ci id="S5.SS1.p2.8.m8.1.1.2.3.cmml" xref="S5.SS1.p2.8.m8.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S5.SS1.p2.8.m8.1.1.3.cmml" xref="S5.SS1.p2.8.m8.1.1.3">1000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.8.m8.1c">n_{i}=1000</annotation></semantics></math> for all experiments. We focus on the pathological setting where each client only has samples from 2 classes, and also investigate another clustered setting where the clients are evenly divided into multiple groups and clients within the same group have the same number of available classes.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.p3.6" class="ltx_p"><span id="S5.SS1.p3.6.1" class="ltx_text ltx_font_bold">Compared Methods.</span> The following commonly used baselines and start-of-the-art methods are compared: vanilla FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, Scaffold <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, FedDyn <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, FedBABU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite> and FedRS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>, FedAvg with balanced-softmax (BSM-FedAvg) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> and FedAvg with logit calibration (FedLC) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>. For the baseline methods, we choose the recommended hyper-parameters as in the original papers. For our ReBaFL method, we tune <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><mi id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><ci id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">\epsilon</annotation></semantics></math> over <math id="S5.SS1.p3.2.m2.3" class="ltx_Math" alttext="\{0.001,0.01,0.1\}" display="inline"><semantics id="S5.SS1.p3.2.m2.3a"><mrow id="S5.SS1.p3.2.m2.3.4.2" xref="S5.SS1.p3.2.m2.3.4.1.cmml"><mo stretchy="false" id="S5.SS1.p3.2.m2.3.4.2.1" xref="S5.SS1.p3.2.m2.3.4.1.cmml">{</mo><mn id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml">0.001</mn><mo id="S5.SS1.p3.2.m2.3.4.2.2" xref="S5.SS1.p3.2.m2.3.4.1.cmml">,</mo><mn id="S5.SS1.p3.2.m2.2.2" xref="S5.SS1.p3.2.m2.2.2.cmml">0.01</mn><mo id="S5.SS1.p3.2.m2.3.4.2.3" xref="S5.SS1.p3.2.m2.3.4.1.cmml">,</mo><mn id="S5.SS1.p3.2.m2.3.3" xref="S5.SS1.p3.2.m2.3.3.cmml">0.1</mn><mo stretchy="false" id="S5.SS1.p3.2.m2.3.4.2.4" xref="S5.SS1.p3.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.3b"><set id="S5.SS1.p3.2.m2.3.4.1.cmml" xref="S5.SS1.p3.2.m2.3.4.2"><cn type="float" id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1">0.001</cn><cn type="float" id="S5.SS1.p3.2.m2.2.2.cmml" xref="S5.SS1.p3.2.m2.2.2">0.01</cn><cn type="float" id="S5.SS1.p3.2.m2.3.3.cmml" xref="S5.SS1.p3.2.m2.3.3">0.1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.3c">\{0.001,0.01,0.1\}</annotation></semantics></math> and <math id="S5.SS1.p3.3.m3.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS1.p3.3.m3.1a"><mi id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.1b"><ci id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.1c">\mu</annotation></semantics></math> over <math id="S5.SS1.p3.4.m4.4" class="ltx_Math" alttext="\{0.1,0.5,1,5\}" display="inline"><semantics id="S5.SS1.p3.4.m4.4a"><mrow id="S5.SS1.p3.4.m4.4.5.2" xref="S5.SS1.p3.4.m4.4.5.1.cmml"><mo stretchy="false" id="S5.SS1.p3.4.m4.4.5.2.1" xref="S5.SS1.p3.4.m4.4.5.1.cmml">{</mo><mn id="S5.SS1.p3.4.m4.1.1" xref="S5.SS1.p3.4.m4.1.1.cmml">0.1</mn><mo id="S5.SS1.p3.4.m4.4.5.2.2" xref="S5.SS1.p3.4.m4.4.5.1.cmml">,</mo><mn id="S5.SS1.p3.4.m4.2.2" xref="S5.SS1.p3.4.m4.2.2.cmml">0.5</mn><mo id="S5.SS1.p3.4.m4.4.5.2.3" xref="S5.SS1.p3.4.m4.4.5.1.cmml">,</mo><mn id="S5.SS1.p3.4.m4.3.3" xref="S5.SS1.p3.4.m4.3.3.cmml">1</mn><mo id="S5.SS1.p3.4.m4.4.5.2.4" xref="S5.SS1.p3.4.m4.4.5.1.cmml">,</mo><mn id="S5.SS1.p3.4.m4.4.4" xref="S5.SS1.p3.4.m4.4.4.cmml">5</mn><mo stretchy="false" id="S5.SS1.p3.4.m4.4.5.2.5" xref="S5.SS1.p3.4.m4.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.4.m4.4b"><set id="S5.SS1.p3.4.m4.4.5.1.cmml" xref="S5.SS1.p3.4.m4.4.5.2"><cn type="float" id="S5.SS1.p3.4.m4.1.1.cmml" xref="S5.SS1.p3.4.m4.1.1">0.1</cn><cn type="float" id="S5.SS1.p3.4.m4.2.2.cmml" xref="S5.SS1.p3.4.m4.2.2">0.5</cn><cn type="integer" id="S5.SS1.p3.4.m4.3.3.cmml" xref="S5.SS1.p3.4.m4.3.3">1</cn><cn type="integer" id="S5.SS1.p3.4.m4.4.4.cmml" xref="S5.SS1.p3.4.m4.4.4">5</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.4.m4.4c">\{0.1,0.5,1,5\}</annotation></semantics></math>, and find that choosing <math id="S5.SS1.p3.5.m5.1" class="ltx_Math" alttext="\epsilon=0.01" display="inline"><semantics id="S5.SS1.p3.5.m5.1a"><mrow id="S5.SS1.p3.5.m5.1.1" xref="S5.SS1.p3.5.m5.1.1.cmml"><mi id="S5.SS1.p3.5.m5.1.1.2" xref="S5.SS1.p3.5.m5.1.1.2.cmml">ϵ</mi><mo id="S5.SS1.p3.5.m5.1.1.1" xref="S5.SS1.p3.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.5.m5.1.1.3" xref="S5.SS1.p3.5.m5.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.5.m5.1b"><apply id="S5.SS1.p3.5.m5.1.1.cmml" xref="S5.SS1.p3.5.m5.1.1"><eq id="S5.SS1.p3.5.m5.1.1.1.cmml" xref="S5.SS1.p3.5.m5.1.1.1"></eq><ci id="S5.SS1.p3.5.m5.1.1.2.cmml" xref="S5.SS1.p3.5.m5.1.1.2">italic-ϵ</ci><cn type="float" id="S5.SS1.p3.5.m5.1.1.3.cmml" xref="S5.SS1.p3.5.m5.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.5.m5.1c">\epsilon=0.01</annotation></semantics></math> and <math id="S5.SS1.p3.6.m6.1" class="ltx_Math" alttext="\mu=0.1" display="inline"><semantics id="S5.SS1.p3.6.m6.1a"><mrow id="S5.SS1.p3.6.m6.1.1" xref="S5.SS1.p3.6.m6.1.1.cmml"><mi id="S5.SS1.p3.6.m6.1.1.2" xref="S5.SS1.p3.6.m6.1.1.2.cmml">μ</mi><mo id="S5.SS1.p3.6.m6.1.1.1" xref="S5.SS1.p3.6.m6.1.1.1.cmml">=</mo><mn id="S5.SS1.p3.6.m6.1.1.3" xref="S5.SS1.p3.6.m6.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.6.m6.1b"><apply id="S5.SS1.p3.6.m6.1.1.cmml" xref="S5.SS1.p3.6.m6.1.1"><eq id="S5.SS1.p3.6.m6.1.1.1.cmml" xref="S5.SS1.p3.6.m6.1.1.1"></eq><ci id="S5.SS1.p3.6.m6.1.1.2.cmml" xref="S5.SS1.p3.6.m6.1.1.2">𝜇</ci><cn type="float" id="S5.SS1.p3.6.m6.1.1.3.cmml" xref="S5.SS1.p3.6.m6.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.6.m6.1c">\mu=0.1</annotation></semantics></math> by default performs generally well for all experiments. Notice that we do not focus on tuning the best combination of hyper-parameters in our framework.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para ltx_noindent">
<p id="S5.SS1.p4.3" class="ltx_p"><span id="S5.SS1.p4.3.1" class="ltx_text ltx_font_bold">Training Settings.</span> We consider a moderate-sized FL setup with <math id="S5.SS1.p4.1.m1.1" class="ltx_Math" alttext="m=20/50" display="inline"><semantics id="S5.SS1.p4.1.m1.1a"><mrow id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml"><mi id="S5.SS1.p4.1.m1.1.1.2" xref="S5.SS1.p4.1.m1.1.1.2.cmml">m</mi><mo id="S5.SS1.p4.1.m1.1.1.1" xref="S5.SS1.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S5.SS1.p4.1.m1.1.1.3" xref="S5.SS1.p4.1.m1.1.1.3.cmml"><mn id="S5.SS1.p4.1.m1.1.1.3.2" xref="S5.SS1.p4.1.m1.1.1.3.2.cmml">20</mn><mo id="S5.SS1.p4.1.m1.1.1.3.1" xref="S5.SS1.p4.1.m1.1.1.3.1.cmml">/</mo><mn id="S5.SS1.p4.1.m1.1.1.3.3" xref="S5.SS1.p4.1.m1.1.1.3.3.cmml">50</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><apply id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1"><eq id="S5.SS1.p4.1.m1.1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1.1"></eq><ci id="S5.SS1.p4.1.m1.1.1.2.cmml" xref="S5.SS1.p4.1.m1.1.1.2">𝑚</ci><apply id="S5.SS1.p4.1.m1.1.1.3.cmml" xref="S5.SS1.p4.1.m1.1.1.3"><divide id="S5.SS1.p4.1.m1.1.1.3.1.cmml" xref="S5.SS1.p4.1.m1.1.1.3.1"></divide><cn type="integer" id="S5.SS1.p4.1.m1.1.1.3.2.cmml" xref="S5.SS1.p4.1.m1.1.1.3.2">20</cn><cn type="integer" id="S5.SS1.p4.1.m1.1.1.3.3.cmml" xref="S5.SS1.p4.1.m1.1.1.3.3">50</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">m=20/50</annotation></semantics></math> clients and employ the SGD as the optimizer with mini-batch size <math id="S5.SS1.p4.2.m2.1" class="ltx_Math" alttext="B=50" display="inline"><semantics id="S5.SS1.p4.2.m2.1a"><mrow id="S5.SS1.p4.2.m2.1.1" xref="S5.SS1.p4.2.m2.1.1.cmml"><mi id="S5.SS1.p4.2.m2.1.1.2" xref="S5.SS1.p4.2.m2.1.1.2.cmml">B</mi><mo id="S5.SS1.p4.2.m2.1.1.1" xref="S5.SS1.p4.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.p4.2.m2.1.1.3" xref="S5.SS1.p4.2.m2.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.2.m2.1b"><apply id="S5.SS1.p4.2.m2.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1"><eq id="S5.SS1.p4.2.m2.1.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1.1"></eq><ci id="S5.SS1.p4.2.m2.1.1.2.cmml" xref="S5.SS1.p4.2.m2.1.1.2">𝐵</ci><cn type="integer" id="S5.SS1.p4.2.m2.1.1.3.cmml" xref="S5.SS1.p4.2.m2.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.2.m2.1c">B=50</annotation></semantics></math> and weight decay 5e-4. The local learning rate is fixed to 0.01/0.02 for the Fashion-MNIST and CIFAR-10 datasets, respectively. For all experiments, the number of local training epochs is set as <math id="S5.SS1.p4.3.m3.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S5.SS1.p4.3.m3.1a"><mrow id="S5.SS1.p4.3.m3.1.1" xref="S5.SS1.p4.3.m3.1.1.cmml"><mi id="S5.SS1.p4.3.m3.1.1.2" xref="S5.SS1.p4.3.m3.1.1.2.cmml">E</mi><mo id="S5.SS1.p4.3.m3.1.1.1" xref="S5.SS1.p4.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.p4.3.m3.1.1.3" xref="S5.SS1.p4.3.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.3.m3.1b"><apply id="S5.SS1.p4.3.m3.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1"><eq id="S5.SS1.p4.3.m3.1.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1.1"></eq><ci id="S5.SS1.p4.3.m3.1.1.2.cmml" xref="S5.SS1.p4.3.m3.1.1.2">𝐸</ci><cn type="integer" id="S5.SS1.p4.3.m3.1.1.3.cmml" xref="S5.SS1.p4.3.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.3.m3.1c">E=5</annotation></semantics></math> to reduce the communication overhead. The total number of communication rounds is set to 200, which is enough for convergence in our experiments. At each round, we record the test accuracy of the global model on the balanced test set that has an uniform label distribution.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE I: </span>The comparison of test accuracy (%) with system sizes m=20/50 and successful transmission probability <math id="S5.T1.2.m1.1" class="ltx_Math" alttext="p=0.5" display="inline"><semantics id="S5.T1.2.m1.1b"><mrow id="S5.T1.2.m1.1.1" xref="S5.T1.2.m1.1.1.cmml"><mi id="S5.T1.2.m1.1.1.2" xref="S5.T1.2.m1.1.1.2.cmml">p</mi><mo id="S5.T1.2.m1.1.1.1" xref="S5.T1.2.m1.1.1.1.cmml">=</mo><mn id="S5.T1.2.m1.1.1.3" xref="S5.T1.2.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.2.m1.1c"><apply id="S5.T1.2.m1.1.1.cmml" xref="S5.T1.2.m1.1.1"><eq id="S5.T1.2.m1.1.1.1.cmml" xref="S5.T1.2.m1.1.1.1"></eq><ci id="S5.T1.2.m1.1.1.2.cmml" xref="S5.T1.2.m1.1.1.2">𝑝</ci><cn type="float" id="S5.T1.2.m1.1.1.3.cmml" xref="S5.T1.2.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.m1.1d">p=0.5</annotation></semantics></math>. </figcaption>
<table id="S5.T1.6" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.6.5.1" class="ltx_tr">
<th id="S5.T1.6.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" style="padding-top:0.9pt;padding-bottom:0.9pt;" rowspan="2"><span id="S5.T1.6.5.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Method</span></th>
<td id="S5.T1.6.5.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.9pt;padding-bottom:0.9pt;" colspan="2"><span id="S5.T1.6.5.1.2.1" class="ltx_text" style="font-size:90%;">Fashion-MNIST</span></td>
<td id="S5.T1.6.5.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.9pt;padding-bottom:0.9pt;" colspan="2"><span id="S5.T1.6.5.1.3.1" class="ltx_text" style="font-size:90%;">CIFAR-10</span></td>
</tr>
<tr id="S5.T1.6.4" class="ltx_tr">
<td id="S5.T1.3.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><math id="S5.T1.3.1.1.m1.1" class="ltx_Math" alttext="m=20" display="inline"><semantics id="S5.T1.3.1.1.m1.1a"><mrow id="S5.T1.3.1.1.m1.1.1" xref="S5.T1.3.1.1.m1.1.1.cmml"><mi mathsize="90%" id="S5.T1.3.1.1.m1.1.1.2" xref="S5.T1.3.1.1.m1.1.1.2.cmml">m</mi><mo mathsize="90%" id="S5.T1.3.1.1.m1.1.1.1" xref="S5.T1.3.1.1.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.T1.3.1.1.m1.1.1.3" xref="S5.T1.3.1.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.3.1.1.m1.1b"><apply id="S5.T1.3.1.1.m1.1.1.cmml" xref="S5.T1.3.1.1.m1.1.1"><eq id="S5.T1.3.1.1.m1.1.1.1.cmml" xref="S5.T1.3.1.1.m1.1.1.1"></eq><ci id="S5.T1.3.1.1.m1.1.1.2.cmml" xref="S5.T1.3.1.1.m1.1.1.2">𝑚</ci><cn type="integer" id="S5.T1.3.1.1.m1.1.1.3.cmml" xref="S5.T1.3.1.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.3.1.1.m1.1c">m=20</annotation></semantics></math></td>
<td id="S5.T1.4.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><math id="S5.T1.4.2.2.m1.1" class="ltx_Math" alttext="m=50" display="inline"><semantics id="S5.T1.4.2.2.m1.1a"><mrow id="S5.T1.4.2.2.m1.1.1" xref="S5.T1.4.2.2.m1.1.1.cmml"><mi mathsize="90%" id="S5.T1.4.2.2.m1.1.1.2" xref="S5.T1.4.2.2.m1.1.1.2.cmml">m</mi><mo mathsize="90%" id="S5.T1.4.2.2.m1.1.1.1" xref="S5.T1.4.2.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.T1.4.2.2.m1.1.1.3" xref="S5.T1.4.2.2.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.4.2.2.m1.1b"><apply id="S5.T1.4.2.2.m1.1.1.cmml" xref="S5.T1.4.2.2.m1.1.1"><eq id="S5.T1.4.2.2.m1.1.1.1.cmml" xref="S5.T1.4.2.2.m1.1.1.1"></eq><ci id="S5.T1.4.2.2.m1.1.1.2.cmml" xref="S5.T1.4.2.2.m1.1.1.2">𝑚</ci><cn type="integer" id="S5.T1.4.2.2.m1.1.1.3.cmml" xref="S5.T1.4.2.2.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.4.2.2.m1.1c">m=50</annotation></semantics></math></td>
<td id="S5.T1.5.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><math id="S5.T1.5.3.3.m1.1" class="ltx_Math" alttext="m=20" display="inline"><semantics id="S5.T1.5.3.3.m1.1a"><mrow id="S5.T1.5.3.3.m1.1.1" xref="S5.T1.5.3.3.m1.1.1.cmml"><mi mathsize="90%" id="S5.T1.5.3.3.m1.1.1.2" xref="S5.T1.5.3.3.m1.1.1.2.cmml">m</mi><mo mathsize="90%" id="S5.T1.5.3.3.m1.1.1.1" xref="S5.T1.5.3.3.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.T1.5.3.3.m1.1.1.3" xref="S5.T1.5.3.3.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.5.3.3.m1.1b"><apply id="S5.T1.5.3.3.m1.1.1.cmml" xref="S5.T1.5.3.3.m1.1.1"><eq id="S5.T1.5.3.3.m1.1.1.1.cmml" xref="S5.T1.5.3.3.m1.1.1.1"></eq><ci id="S5.T1.5.3.3.m1.1.1.2.cmml" xref="S5.T1.5.3.3.m1.1.1.2">𝑚</ci><cn type="integer" id="S5.T1.5.3.3.m1.1.1.3.cmml" xref="S5.T1.5.3.3.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.5.3.3.m1.1c">m=20</annotation></semantics></math></td>
<td id="S5.T1.6.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><math id="S5.T1.6.4.4.m1.1" class="ltx_Math" alttext="m=50" display="inline"><semantics id="S5.T1.6.4.4.m1.1a"><mrow id="S5.T1.6.4.4.m1.1.1" xref="S5.T1.6.4.4.m1.1.1.cmml"><mi mathsize="90%" id="S5.T1.6.4.4.m1.1.1.2" xref="S5.T1.6.4.4.m1.1.1.2.cmml">m</mi><mo mathsize="90%" id="S5.T1.6.4.4.m1.1.1.1" xref="S5.T1.6.4.4.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.T1.6.4.4.m1.1.1.3" xref="S5.T1.6.4.4.m1.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T1.6.4.4.m1.1b"><apply id="S5.T1.6.4.4.m1.1.1.cmml" xref="S5.T1.6.4.4.m1.1.1"><eq id="S5.T1.6.4.4.m1.1.1.1.cmml" xref="S5.T1.6.4.4.m1.1.1.1"></eq><ci id="S5.T1.6.4.4.m1.1.1.2.cmml" xref="S5.T1.6.4.4.m1.1.1.2">𝑚</ci><cn type="integer" id="S5.T1.6.4.4.m1.1.1.3.cmml" xref="S5.T1.6.4.4.m1.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.6.4.4.m1.1c">m=50</annotation></semantics></math></td>
</tr>
<tr id="S5.T1.6.6.2" class="ltx_tr">
<th id="S5.T1.6.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.6.2.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span></th>
<td id="S5.T1.6.6.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.6.2.2.1" class="ltx_text" style="font-size:90%;">75.27</span></td>
<td id="S5.T1.6.6.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.6.2.3.1" class="ltx_text" style="font-size:90%;">83.60</span></td>
<td id="S5.T1.6.6.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.6.2.4.1" class="ltx_text" style="font-size:90%;">54.82</span></td>
<td id="S5.T1.6.6.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.6.2.5.1" class="ltx_text" style="font-size:90%;">64.37</span></td>
</tr>
<tr id="S5.T1.6.7.3" class="ltx_tr">
<th id="S5.T1.6.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.7.3.1.1" class="ltx_text" style="font-size:90%;">FedProx</span></th>
<td id="S5.T1.6.7.3.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.7.3.2.1" class="ltx_text" style="font-size:90%;">75.36</span></td>
<td id="S5.T1.6.7.3.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.7.3.3.1" class="ltx_text" style="font-size:90%;">83.55</span></td>
<td id="S5.T1.6.7.3.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.7.3.4.1" class="ltx_text" style="font-size:90%;">54.66</span></td>
<td id="S5.T1.6.7.3.5" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.7.3.5.1" class="ltx_text" style="font-size:90%;">64.14</span></td>
</tr>
<tr id="S5.T1.6.8.4" class="ltx_tr">
<th id="S5.T1.6.8.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.8.4.1.1" class="ltx_text" style="font-size:90%;">Scaffold</span></th>
<td id="S5.T1.6.8.4.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.8.4.2.1" class="ltx_text" style="font-size:90%;">63.48</span></td>
<td id="S5.T1.6.8.4.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.8.4.3.1" class="ltx_text" style="font-size:90%;">65.62</span></td>
<td id="S5.T1.6.8.4.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.8.4.4.1" class="ltx_text" style="font-size:90%;">20.57</span></td>
<td id="S5.T1.6.8.4.5" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.8.4.5.1" class="ltx_text" style="font-size:90%;">44.56</span></td>
</tr>
<tr id="S5.T1.6.9.5" class="ltx_tr">
<th id="S5.T1.6.9.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.9.5.1.1" class="ltx_text" style="font-size:90%;">FedDyn</span></th>
<td id="S5.T1.6.9.5.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.9.5.2.1" class="ltx_text" style="font-size:90%;">77.98</span></td>
<td id="S5.T1.6.9.5.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.9.5.3.1" class="ltx_text" style="font-size:90%;">85.26</span></td>
<td id="S5.T1.6.9.5.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.9.5.4.1" class="ltx_text" style="font-size:90%;">56.41</span></td>
<td id="S5.T1.6.9.5.5" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.9.5.5.1" class="ltx_text" style="font-size:90%;">68.51</span></td>
</tr>
<tr id="S5.T1.6.10.6" class="ltx_tr">
<th id="S5.T1.6.10.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.10.6.1.1" class="ltx_text" style="font-size:90%;">MOON</span></th>
<td id="S5.T1.6.10.6.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.10.6.2.1" class="ltx_text" style="font-size:90%;">65.35</span></td>
<td id="S5.T1.6.10.6.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.10.6.3.1" class="ltx_text" style="font-size:90%;">80.35</span></td>
<td id="S5.T1.6.10.6.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.10.6.4.1" class="ltx_text" style="font-size:90%;">47.28</span></td>
<td id="S5.T1.6.10.6.5" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.10.6.5.1" class="ltx_text" style="font-size:90%;">59.08</span></td>
</tr>
<tr id="S5.T1.6.11.7" class="ltx_tr">
<th id="S5.T1.6.11.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.11.7.1.1" class="ltx_text" style="font-size:90%;">FedRS</span></th>
<td id="S5.T1.6.11.7.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.11.7.2.1" class="ltx_text" style="font-size:90%;">72.46</span></td>
<td id="S5.T1.6.11.7.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.11.7.3.1" class="ltx_text" style="font-size:90%;">79.83</span></td>
<td id="S5.T1.6.11.7.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.11.7.4.1" class="ltx_text" style="font-size:90%;">54.39</span></td>
<td id="S5.T1.6.11.7.5" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.11.7.5.1" class="ltx_text" style="font-size:90%;">64.05</span></td>
</tr>
<tr id="S5.T1.6.12.8" class="ltx_tr">
<th id="S5.T1.6.12.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.12.8.1.1" class="ltx_text" style="font-size:90%;">FedBABU</span></th>
<td id="S5.T1.6.12.8.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.12.8.2.1" class="ltx_text" style="font-size:90%;">74.20</span></td>
<td id="S5.T1.6.12.8.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.12.8.3.1" class="ltx_text" style="font-size:90%;">82.34</span></td>
<td id="S5.T1.6.12.8.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.12.8.4.1" class="ltx_text" style="font-size:90%;">52.73</span></td>
<td id="S5.T1.6.12.8.5" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.12.8.5.1" class="ltx_text" style="font-size:90%;">62.19</span></td>
</tr>
<tr id="S5.T1.6.13.9" class="ltx_tr">
<th id="S5.T1.6.13.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.13.9.1.1" class="ltx_text" style="font-size:90%;">FedLC</span></th>
<td id="S5.T1.6.13.9.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.13.9.2.1" class="ltx_text" style="font-size:90%;">68.75</span></td>
<td id="S5.T1.6.13.9.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.13.9.3.1" class="ltx_text" style="font-size:90%;">76.98</span></td>
<td id="S5.T1.6.13.9.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.13.9.4.1" class="ltx_text" style="font-size:90%;">53.56</span></td>
<td id="S5.T1.6.13.9.5" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.13.9.5.1" class="ltx_text" style="font-size:90%;">65.70</span></td>
</tr>
<tr id="S5.T1.6.14.10" class="ltx_tr">
<th id="S5.T1.6.14.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.14.10.1.1" class="ltx_text" style="font-size:90%;">BSM-FedAvg</span></th>
<td id="S5.T1.6.14.10.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.14.10.2.1" class="ltx_text" style="font-size:90%;">68.64</span></td>
<td id="S5.T1.6.14.10.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.14.10.3.1" class="ltx_text" style="font-size:90%;">76.99</span></td>
<td id="S5.T1.6.14.10.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.14.10.4.1" class="ltx_text" style="font-size:90%;">53.25</span></td>
<td id="S5.T1.6.14.10.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.14.10.5.1" class="ltx_text" style="font-size:90%;">65.52</span></td>
</tr>
<tr id="S5.T1.6.15.11" class="ltx_tr">
<th id="S5.T1.6.15.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S5.T1.6.15.11.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">ReBaFL</span><span id="S5.T1.6.15.11.1.2" class="ltx_text" style="font-size:90%;"> (ours)</span>
</th>
<td id="S5.T1.6.15.11.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.15.11.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">78.81</span></td>
<td id="S5.T1.6.15.11.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.15.11.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">85.44</span></td>
<td id="S5.T1.6.15.11.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.15.11.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">58.49</span></td>
<td id="S5.T1.6.15.11.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T1.6.15.11.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">68.59</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F3.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x3.png" id="S5.F3.1.g1" class="ltx_graphics ltx_img_landscape" width="290" height="226" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F3.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x4.png" id="S5.F3.2.g1" class="ltx_graphics ltx_img_landscape" width="290" height="226" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F3.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x5.png" id="S5.F3.3.g1" class="ltx_graphics ltx_img_landscape" width="290" height="226" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F3.4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x6.png" id="S5.F3.4.g1" class="ltx_graphics ltx_img_landscape" width="290" height="226" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F3.5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x7.png" id="S5.F3.5.g1" class="ltx_graphics ltx_img_landscape" width="290" height="226" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F3.6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x8.png" id="S5.F3.6.g1" class="ltx_graphics ltx_img_landscape" width="290" height="226" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Test accuracy over communication rounds under different levels of client dropout. Each client only has two randomly allocated labels.</figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span><span id="S5.SS2.1.1" class="ltx_text ltx_font_italic">Main Results in Pathological Setting</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.1" class="ltx_p"><span id="S5.SS2.p1.1.1" class="ltx_text ltx_font_bold">Performance Comparison.</span> We first study the random and independent straggler scenarios, which can be simulated by applying an unified successful transmission probability <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mi id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><ci id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">p</annotation></semantics></math> for all clients. All compared methods are evaluated under the same experimental conditions by using the same random seed. From the numerical results in Table <span class="ltx_ref ltx_missing_label ltx_ref_self">LABEL:tab:result_main</span>, it can be seen that our ReBaFL can consistently outperform other methods in various cases and achieve the highest global test accuracy. The results of FedAvg, FedProx and Scaffold also show that learning on non-IID data with client dropout is particularly difficult due to the unstable training induced by missing classes. In addition, it is also interesting to see that FedAvg is indeed a strong baseline, resulting in comparable or even better performance compared to various advanced algorithms.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.2" class="ltx_p"><span id="S5.SS2.p2.2.1" class="ltx_text ltx_font_bold">Resilience to Client Dropout.</span> To investigate the impact of client dropout, we also vary the <math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><mi id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><ci id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">p</annotation></semantics></math> over <math id="S5.SS2.p2.2.m2.3" class="ltx_Math" alttext="\{0.1,0.3,0.5\}" display="inline"><semantics id="S5.SS2.p2.2.m2.3a"><mrow id="S5.SS2.p2.2.m2.3.4.2" xref="S5.SS2.p2.2.m2.3.4.1.cmml"><mo stretchy="false" id="S5.SS2.p2.2.m2.3.4.2.1" xref="S5.SS2.p2.2.m2.3.4.1.cmml">{</mo><mn id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">0.1</mn><mo id="S5.SS2.p2.2.m2.3.4.2.2" xref="S5.SS2.p2.2.m2.3.4.1.cmml">,</mo><mn id="S5.SS2.p2.2.m2.2.2" xref="S5.SS2.p2.2.m2.2.2.cmml">0.3</mn><mo id="S5.SS2.p2.2.m2.3.4.2.3" xref="S5.SS2.p2.2.m2.3.4.1.cmml">,</mo><mn id="S5.SS2.p2.2.m2.3.3" xref="S5.SS2.p2.2.m2.3.3.cmml">0.5</mn><mo stretchy="false" id="S5.SS2.p2.2.m2.3.4.2.4" xref="S5.SS2.p2.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.3b"><set id="S5.SS2.p2.2.m2.3.4.1.cmml" xref="S5.SS2.p2.2.m2.3.4.2"><cn type="float" id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">0.1</cn><cn type="float" id="S5.SS2.p2.2.m2.2.2.cmml" xref="S5.SS2.p2.2.m2.2.2">0.3</cn><cn type="float" id="S5.SS2.p2.2.m2.3.3.cmml" xref="S5.SS2.p2.2.m2.3.3">0.5</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.3c">\{0.1,0.3,0.5\}</annotation></semantics></math> in the setup of 50 clients. The results in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.1 Experimental Setup ‣ 5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> show that the high dropout rate would significantly degrade the performance of FedAvg and other methods that based on the vanilla softmax normalization during local training. Since the low participation rate cannot ensure that samples from all classes are available at each round, the global aggregation would not be able to correct the highly biased local classifier heads. In contrast, our method can stabilize the training performance and exhibit high robustness to various levels of client dropout. Besides, it can also be found that both FedRS and BSM-FedAvg that leverage the restricted softmax can already combat the label skew and client dropout with good training stability.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p">The above results indicate that the conventional softmax-based training is vulnerable to the highly-skewed label distribution in FL and the high client dropout rate (i.e., low successful transmission probability) will further worsen the model performance. Instead, applying the balanced-softmax mechanism is usually beneficial and robust to label distribution skew. And our proposed relaxed version of balanced-softmax equipped with feature augmentation can overcome such label skew and client dropout to a larger extent and achieve better model performance.</p>
</div>
<figure id="S5.F4" class="ltx_figure"><img src="/html/2303.06314/assets/x9.png" id="S5.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="243" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance comparison in clustered setting. Objective calibration-based methods outperform regularization-based methods with large margins.</figcaption>
</figure>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F5.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x10.png" id="S5.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="219" height="171" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F5.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x11.png" id="S5.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="219" height="171" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Test accuracy over communication rounds in clustered setting. ReBaFL can present fast convergence and better model accuracy.</figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span><span id="S5.SS3.1.1" class="ltx_text ltx_font_italic">Main Results in Clustered Setting</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.4" class="ltx_p">In this setting, we assume that the clients have clustered structures and consider a setup with 20 clients which are grouped into 5 clusters. In each cluster, the clients share the same number of available classes and the same successful transmission probability, while those quantities could vary across different clusters. In such cases, it is of significant importance to ensure the stability of FL training. We set the number of class <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mi id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><ci id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">N</annotation></semantics></math> by <math id="S5.SS3.p1.2.m2.5" class="ltx_Math" alttext="\{2,2,3,3,5\}" display="inline"><semantics id="S5.SS3.p1.2.m2.5a"><mrow id="S5.SS3.p1.2.m2.5.6.2" xref="S5.SS3.p1.2.m2.5.6.1.cmml"><mo stretchy="false" id="S5.SS3.p1.2.m2.5.6.2.1" xref="S5.SS3.p1.2.m2.5.6.1.cmml">{</mo><mn id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">2</mn><mo id="S5.SS3.p1.2.m2.5.6.2.2" xref="S5.SS3.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS3.p1.2.m2.2.2" xref="S5.SS3.p1.2.m2.2.2.cmml">2</mn><mo id="S5.SS3.p1.2.m2.5.6.2.3" xref="S5.SS3.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS3.p1.2.m2.3.3" xref="S5.SS3.p1.2.m2.3.3.cmml">3</mn><mo id="S5.SS3.p1.2.m2.5.6.2.4" xref="S5.SS3.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS3.p1.2.m2.4.4" xref="S5.SS3.p1.2.m2.4.4.cmml">3</mn><mo id="S5.SS3.p1.2.m2.5.6.2.5" xref="S5.SS3.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS3.p1.2.m2.5.5" xref="S5.SS3.p1.2.m2.5.5.cmml">5</mn><mo stretchy="false" id="S5.SS3.p1.2.m2.5.6.2.6" xref="S5.SS3.p1.2.m2.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.5b"><set id="S5.SS3.p1.2.m2.5.6.1.cmml" xref="S5.SS3.p1.2.m2.5.6.2"><cn type="integer" id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">2</cn><cn type="integer" id="S5.SS3.p1.2.m2.2.2.cmml" xref="S5.SS3.p1.2.m2.2.2">2</cn><cn type="integer" id="S5.SS3.p1.2.m2.3.3.cmml" xref="S5.SS3.p1.2.m2.3.3">3</cn><cn type="integer" id="S5.SS3.p1.2.m2.4.4.cmml" xref="S5.SS3.p1.2.m2.4.4">3</cn><cn type="integer" id="S5.SS3.p1.2.m2.5.5.cmml" xref="S5.SS3.p1.2.m2.5.5">5</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.5c">\{2,2,3,3,5\}</annotation></semantics></math> and the <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mi id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><ci id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">p</annotation></semantics></math> by <math id="S5.SS3.p1.4.m4.5" class="ltx_Math" alttext="\{0.5,0.5,0.3,0.3,0.2\}" display="inline"><semantics id="S5.SS3.p1.4.m4.5a"><mrow id="S5.SS3.p1.4.m4.5.6.2" xref="S5.SS3.p1.4.m4.5.6.1.cmml"><mo stretchy="false" id="S5.SS3.p1.4.m4.5.6.2.1" xref="S5.SS3.p1.4.m4.5.6.1.cmml">{</mo><mn id="S5.SS3.p1.4.m4.1.1" xref="S5.SS3.p1.4.m4.1.1.cmml">0.5</mn><mo id="S5.SS3.p1.4.m4.5.6.2.2" xref="S5.SS3.p1.4.m4.5.6.1.cmml">,</mo><mn id="S5.SS3.p1.4.m4.2.2" xref="S5.SS3.p1.4.m4.2.2.cmml">0.5</mn><mo id="S5.SS3.p1.4.m4.5.6.2.3" xref="S5.SS3.p1.4.m4.5.6.1.cmml">,</mo><mn id="S5.SS3.p1.4.m4.3.3" xref="S5.SS3.p1.4.m4.3.3.cmml">0.3</mn><mo id="S5.SS3.p1.4.m4.5.6.2.4" xref="S5.SS3.p1.4.m4.5.6.1.cmml">,</mo><mn id="S5.SS3.p1.4.m4.4.4" xref="S5.SS3.p1.4.m4.4.4.cmml">0.3</mn><mo id="S5.SS3.p1.4.m4.5.6.2.5" xref="S5.SS3.p1.4.m4.5.6.1.cmml">,</mo><mn id="S5.SS3.p1.4.m4.5.5" xref="S5.SS3.p1.4.m4.5.5.cmml">0.2</mn><mo stretchy="false" id="S5.SS3.p1.4.m4.5.6.2.6" xref="S5.SS3.p1.4.m4.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.4.m4.5b"><set id="S5.SS3.p1.4.m4.5.6.1.cmml" xref="S5.SS3.p1.4.m4.5.6.2"><cn type="float" id="S5.SS3.p1.4.m4.1.1.cmml" xref="S5.SS3.p1.4.m4.1.1">0.5</cn><cn type="float" id="S5.SS3.p1.4.m4.2.2.cmml" xref="S5.SS3.p1.4.m4.2.2">0.5</cn><cn type="float" id="S5.SS3.p1.4.m4.3.3.cmml" xref="S5.SS3.p1.4.m4.3.3">0.3</cn><cn type="float" id="S5.SS3.p1.4.m4.4.4.cmml" xref="S5.SS3.p1.4.m4.4.4">0.3</cn><cn type="float" id="S5.SS3.p1.4.m4.5.5.cmml" xref="S5.SS3.p1.4.m4.5.5">0.2</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.4.m4.5c">\{0.5,0.5,0.3,0.3,0.2\}</annotation></semantics></math> for each cluster, respectively. Notice that even the clients within the same cluster may have substantially distinct subsets of labels. The main results are presented in Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.2 Main Results in Pathological Setting ‣ 5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.2 Main Results in Pathological Setting ‣ 5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, from which we can see that, overall, the ReBaFL still achieves the best model performance and training stability during the federation procedure with client dropout. In this setting, the FedDyn tends to be as unstable as FedAvg due to label distribution skewness and unexpected client dropout. It can also be found that BSM-FedAvg and FedRS also present good performance since the data heterogeneity is relatively mild compared to the pathological setting.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span><span id="S5.SS4.1.1" class="ltx_text ltx_font_italic">Ablation Studies</span>
</h3>

<section id="S5.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.1 </span>Effect of Individual Component</h4>

<div id="S5.SS4.SSS1.p1" class="ltx_para">
<p id="S5.SS4.SSS1.p1.1" class="ltx_p">There are two important components in ReBaFL, i.e., relaxed balanced-softmax (R-BSM) and feature augmentation (F-Aug). Here we provide some ablation studies to investigate the individual effects of them. The experiments are conducted on CIFAR-10 dataset under both Pathological and Clustered settings. The resulted model accuracy is reported in Table <a href="#S5.T2" title="TABLE II ‣ 5.4.1 Effect of Individual Component ‣ 5.4 Ablation Studies ‣ 5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, from which we can find that the relaxed-softmax alone can already provide a significant improvement of the model accuracy and the combination of those two components can lead to the best performance and exceed the baseline with a large margin. One thing interesting we can see is that the inter-class feature transfer based augmentation can even worsen the model performance when the balanced softmax is not applied.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Model Accuracy (%) with Different Design Components</figcaption>
<table id="S5.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.3.1.1" class="ltx_tr">
<th id="S5.T2.3.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1.35pt;padding-bottom:1.35pt;" rowspan="2"><span id="S5.T2.3.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">R-BSM</span></th>
<th id="S5.T2.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1.35pt;padding-bottom:1.35pt;" rowspan="2"><span id="S5.T2.3.1.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">F-Aug</span></th>
<th id="S5.T2.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-top:1.35pt;padding-bottom:1.35pt;" colspan="2"><span id="S5.T2.3.1.1.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Data Settings</span></th>
</tr>
<tr id="S5.T2.3.2.2" class="ltx_tr">
<th id="S5.T2.3.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.2.2.1.1" class="ltx_text" style="font-size:90%;">Pathological</span></th>
<th id="S5.T2.3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.2.2.2.1" class="ltx_text" style="font-size:90%;">Clustered</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.3.3.1" class="ltx_tr">
<td id="S5.T2.3.3.1.1" class="ltx_td ltx_border_t" style="padding-top:1.35pt;padding-bottom:1.35pt;"></td>
<td id="S5.T2.3.3.1.2" class="ltx_td ltx_border_t" style="padding-top:1.35pt;padding-bottom:1.35pt;"></td>
<td id="S5.T2.3.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.3.1.3.1" class="ltx_text" style="font-size:90%;">54.82</span></td>
<td id="S5.T2.3.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.3.1.4.1" class="ltx_text" style="font-size:90%;">59.71</span></td>
</tr>
<tr id="S5.T2.3.4.2" class="ltx_tr">
<td id="S5.T2.3.4.2.1" class="ltx_td ltx_align_center" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.4.2.1.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S5.T2.3.4.2.2" class="ltx_td" style="padding-top:1.35pt;padding-bottom:1.35pt;"></td>
<td id="S5.T2.3.4.2.3" class="ltx_td ltx_align_center" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.4.2.3.1" class="ltx_text" style="font-size:90%;">56.71</span></td>
<td id="S5.T2.3.4.2.4" class="ltx_td ltx_align_center" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.4.2.4.1" class="ltx_text" style="font-size:90%;">65.75</span></td>
</tr>
<tr id="S5.T2.3.5.3" class="ltx_tr">
<td id="S5.T2.3.5.3.1" class="ltx_td" style="padding-top:1.35pt;padding-bottom:1.35pt;"></td>
<td id="S5.T2.3.5.3.2" class="ltx_td ltx_align_center" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.5.3.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S5.T2.3.5.3.3" class="ltx_td ltx_align_center" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.5.3.3.1" class="ltx_text" style="font-size:90%;">54.01</span></td>
<td id="S5.T2.3.5.3.4" class="ltx_td ltx_align_center" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.5.3.4.1" class="ltx_text" style="font-size:90%;">58.85</span></td>
</tr>
<tr id="S5.T2.3.6.4" class="ltx_tr">
<td id="S5.T2.3.6.4.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.6.4.1.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S5.T2.3.6.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.6.4.2.1" class="ltx_text" style="font-size:90%;">✓</span></td>
<td id="S5.T2.3.6.4.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.6.4.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">58.49</span></td>
<td id="S5.T2.3.6.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" style="padding-top:1.35pt;padding-bottom:1.35pt;"><span id="S5.T2.3.6.4.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">67.12</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x12.png" id="S5.F6.1.g1" class="ltx_graphics ltx_img_landscape" width="212" height="168" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x13.png" id="S5.F6.2.g1" class="ltx_graphics ltx_img_landscape" width="212" height="165" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x14.png" id="S5.F6.3.g1" class="ltx_graphics ltx_img_landscape" width="212" height="165" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F6.4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x15.png" id="S5.F6.4.g1" class="ltx_graphics ltx_img_landscape" width="212" height="165" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Learning curves for ablation studies. (a)(c) are in pathological setting on two datasets while (b)(d) are in clustered setting.</figcaption>
</figure>
</section>
<section id="S5.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.2 </span>Diversity of Local Models</h4>

<div id="S5.SS4.SSS2.p1" class="ltx_para">
<p id="S5.SS4.SSS2.p1.2" class="ltx_p">We also record the model weight diversity among collected clients across the training process, where the weight diversity is defined as follows.</p>
<table id="S5.E24" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E24.m1.5" class="ltx_Math" alttext="\Lambda^{(t)}:=\frac{1}{|S_{t}|}\sum_{i\in S_{t}}\|{\bm{w}}_{i}^{(t)}-\bar{\bm{w}}^{(t)}\|_{2}^{2}," display="block"><semantics id="S5.E24.m1.5a"><mrow id="S5.E24.m1.5.5.1" xref="S5.E24.m1.5.5.1.1.cmml"><mrow id="S5.E24.m1.5.5.1.1" xref="S5.E24.m1.5.5.1.1.cmml"><msup id="S5.E24.m1.5.5.1.1.3" xref="S5.E24.m1.5.5.1.1.3.cmml"><mi mathvariant="normal" id="S5.E24.m1.5.5.1.1.3.2" xref="S5.E24.m1.5.5.1.1.3.2.cmml">Λ</mi><mrow id="S5.E24.m1.1.1.1.3" xref="S5.E24.m1.5.5.1.1.3.cmml"><mo stretchy="false" id="S5.E24.m1.1.1.1.3.1" xref="S5.E24.m1.5.5.1.1.3.cmml">(</mo><mi id="S5.E24.m1.1.1.1.1" xref="S5.E24.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S5.E24.m1.1.1.1.3.2" xref="S5.E24.m1.5.5.1.1.3.cmml">)</mo></mrow></msup><mo lspace="0.278em" rspace="0.278em" id="S5.E24.m1.5.5.1.1.2" xref="S5.E24.m1.5.5.1.1.2.cmml">:=</mo><mrow id="S5.E24.m1.5.5.1.1.1" xref="S5.E24.m1.5.5.1.1.1.cmml"><mfrac id="S5.E24.m1.2.2" xref="S5.E24.m1.2.2.cmml"><mn id="S5.E24.m1.2.2.3" xref="S5.E24.m1.2.2.3.cmml">1</mn><mrow id="S5.E24.m1.2.2.1.1" xref="S5.E24.m1.2.2.1.2.cmml"><mo stretchy="false" id="S5.E24.m1.2.2.1.1.2" xref="S5.E24.m1.2.2.1.2.1.cmml">|</mo><msub id="S5.E24.m1.2.2.1.1.1" xref="S5.E24.m1.2.2.1.1.1.cmml"><mi id="S5.E24.m1.2.2.1.1.1.2" xref="S5.E24.m1.2.2.1.1.1.2.cmml">S</mi><mi id="S5.E24.m1.2.2.1.1.1.3" xref="S5.E24.m1.2.2.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S5.E24.m1.2.2.1.1.3" xref="S5.E24.m1.2.2.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S5.E24.m1.5.5.1.1.1.2" xref="S5.E24.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S5.E24.m1.5.5.1.1.1.1" xref="S5.E24.m1.5.5.1.1.1.1.cmml"><munder id="S5.E24.m1.5.5.1.1.1.1.2" xref="S5.E24.m1.5.5.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S5.E24.m1.5.5.1.1.1.1.2.2" xref="S5.E24.m1.5.5.1.1.1.1.2.2.cmml">∑</mo><mrow id="S5.E24.m1.5.5.1.1.1.1.2.3" xref="S5.E24.m1.5.5.1.1.1.1.2.3.cmml"><mi id="S5.E24.m1.5.5.1.1.1.1.2.3.2" xref="S5.E24.m1.5.5.1.1.1.1.2.3.2.cmml">i</mi><mo id="S5.E24.m1.5.5.1.1.1.1.2.3.1" xref="S5.E24.m1.5.5.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S5.E24.m1.5.5.1.1.1.1.2.3.3" xref="S5.E24.m1.5.5.1.1.1.1.2.3.3.cmml"><mi id="S5.E24.m1.5.5.1.1.1.1.2.3.3.2" xref="S5.E24.m1.5.5.1.1.1.1.2.3.3.2.cmml">S</mi><mi id="S5.E24.m1.5.5.1.1.1.1.2.3.3.3" xref="S5.E24.m1.5.5.1.1.1.1.2.3.3.3.cmml">t</mi></msub></mrow></munder><msubsup id="S5.E24.m1.5.5.1.1.1.1.1" xref="S5.E24.m1.5.5.1.1.1.1.1.cmml"><mrow id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒘</mi><mi id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="S5.E24.m1.3.3.1.3" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S5.E24.m1.3.3.1.3.1" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S5.E24.m1.3.3.1.1" xref="S5.E24.m1.3.3.1.1.cmml">t</mi><mo stretchy="false" id="S5.E24.m1.3.3.1.3.2" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒘</mi><mo id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="S5.E24.m1.4.4.1.3" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S5.E24.m1.4.4.1.3.1" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S5.E24.m1.4.4.1.1" xref="S5.E24.m1.4.4.1.1.cmml">t</mi><mo stretchy="false" id="S5.E24.m1.4.4.1.3.2" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo stretchy="false" id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S5.E24.m1.5.5.1.1.1.1.1.1.3" xref="S5.E24.m1.5.5.1.1.1.1.1.1.3.cmml">2</mn><mn id="S5.E24.m1.5.5.1.1.1.1.1.3" xref="S5.E24.m1.5.5.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="S5.E24.m1.5.5.1.2" xref="S5.E24.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E24.m1.5b"><apply id="S5.E24.m1.5.5.1.1.cmml" xref="S5.E24.m1.5.5.1"><csymbol cd="latexml" id="S5.E24.m1.5.5.1.1.2.cmml" xref="S5.E24.m1.5.5.1.1.2">assign</csymbol><apply id="S5.E24.m1.5.5.1.1.3.cmml" xref="S5.E24.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S5.E24.m1.5.5.1.1.3.1.cmml" xref="S5.E24.m1.5.5.1.1.3">superscript</csymbol><ci id="S5.E24.m1.5.5.1.1.3.2.cmml" xref="S5.E24.m1.5.5.1.1.3.2">Λ</ci><ci id="S5.E24.m1.1.1.1.1.cmml" xref="S5.E24.m1.1.1.1.1">𝑡</ci></apply><apply id="S5.E24.m1.5.5.1.1.1.cmml" xref="S5.E24.m1.5.5.1.1.1"><times id="S5.E24.m1.5.5.1.1.1.2.cmml" xref="S5.E24.m1.5.5.1.1.1.2"></times><apply id="S5.E24.m1.2.2.cmml" xref="S5.E24.m1.2.2"><divide id="S5.E24.m1.2.2.2.cmml" xref="S5.E24.m1.2.2"></divide><cn type="integer" id="S5.E24.m1.2.2.3.cmml" xref="S5.E24.m1.2.2.3">1</cn><apply id="S5.E24.m1.2.2.1.2.cmml" xref="S5.E24.m1.2.2.1.1"><abs id="S5.E24.m1.2.2.1.2.1.cmml" xref="S5.E24.m1.2.2.1.1.2"></abs><apply id="S5.E24.m1.2.2.1.1.1.cmml" xref="S5.E24.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S5.E24.m1.2.2.1.1.1.1.cmml" xref="S5.E24.m1.2.2.1.1.1">subscript</csymbol><ci id="S5.E24.m1.2.2.1.1.1.2.cmml" xref="S5.E24.m1.2.2.1.1.1.2">𝑆</ci><ci id="S5.E24.m1.2.2.1.1.1.3.cmml" xref="S5.E24.m1.2.2.1.1.1.3">𝑡</ci></apply></apply></apply><apply id="S5.E24.m1.5.5.1.1.1.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1"><apply id="S5.E24.m1.5.5.1.1.1.1.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E24.m1.5.5.1.1.1.1.2.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="S5.E24.m1.5.5.1.1.1.1.2.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.2.2"></sum><apply id="S5.E24.m1.5.5.1.1.1.1.2.3.cmml" xref="S5.E24.m1.5.5.1.1.1.1.2.3"><in id="S5.E24.m1.5.5.1.1.1.1.2.3.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.2.3.1"></in><ci id="S5.E24.m1.5.5.1.1.1.1.2.3.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.2.3.2">𝑖</ci><apply id="S5.E24.m1.5.5.1.1.1.1.2.3.3.cmml" xref="S5.E24.m1.5.5.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S5.E24.m1.5.5.1.1.1.1.2.3.3.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.2.3.3">subscript</csymbol><ci id="S5.E24.m1.5.5.1.1.1.1.2.3.3.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.2.3.3.2">𝑆</ci><ci id="S5.E24.m1.5.5.1.1.1.1.2.3.3.3.cmml" xref="S5.E24.m1.5.5.1.1.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S5.E24.m1.5.5.1.1.1.1.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E24.m1.5.5.1.1.1.1.1.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1">superscript</csymbol><apply id="S5.E24.m1.5.5.1.1.1.1.1.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E24.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1">subscript</csymbol><apply id="S5.E24.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E24.m1.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1"><minus id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.2">𝒘</ci><ci id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S5.E24.m1.3.3.1.1.cmml" xref="S5.E24.m1.3.3.1.1">𝑡</ci></apply><apply id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2"><ci id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.1">¯</ci><ci id="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.1.1.1.3.2.2">𝒘</ci></apply><ci id="S5.E24.m1.4.4.1.1.cmml" xref="S5.E24.m1.4.4.1.1">𝑡</ci></apply></apply></apply><cn type="integer" id="S5.E24.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="S5.E24.m1.5.5.1.1.1.1.1.3.cmml" xref="S5.E24.m1.5.5.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E24.m1.5c">\Lambda^{(t)}:=\frac{1}{|S_{t}|}\sum_{i\in S_{t}}\|{\bm{w}}_{i}^{(t)}-\bar{\bm{w}}^{(t)}\|_{2}^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
<p id="S5.SS4.SSS2.p1.1" class="ltx_p">where <math id="S5.SS4.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\bar{\bm{w}}^{(t)}" display="inline"><semantics id="S5.SS4.SSS2.p1.1.m1.1a"><msup id="S5.SS4.SSS2.p1.1.m1.1.2" xref="S5.SS4.SSS2.p1.1.m1.1.2.cmml"><mover accent="true" id="S5.SS4.SSS2.p1.1.m1.1.2.2" xref="S5.SS4.SSS2.p1.1.m1.1.2.2.cmml"><mi id="S5.SS4.SSS2.p1.1.m1.1.2.2.2" xref="S5.SS4.SSS2.p1.1.m1.1.2.2.2.cmml">𝒘</mi><mo id="S5.SS4.SSS2.p1.1.m1.1.2.2.1" xref="S5.SS4.SSS2.p1.1.m1.1.2.2.1.cmml">¯</mo></mover><mrow id="S5.SS4.SSS2.p1.1.m1.1.1.1.3" xref="S5.SS4.SSS2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S5.SS4.SSS2.p1.1.m1.1.1.1.3.1" xref="S5.SS4.SSS2.p1.1.m1.1.2.cmml">(</mo><mi id="S5.SS4.SSS2.p1.1.m1.1.1.1.1" xref="S5.SS4.SSS2.p1.1.m1.1.1.1.1.cmml">t</mi><mo stretchy="false" id="S5.SS4.SSS2.p1.1.m1.1.1.1.3.2" xref="S5.SS4.SSS2.p1.1.m1.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS2.p1.1.m1.1b"><apply id="S5.SS4.SSS2.p1.1.m1.1.2.cmml" xref="S5.SS4.SSS2.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S5.SS4.SSS2.p1.1.m1.1.2.1.cmml" xref="S5.SS4.SSS2.p1.1.m1.1.2">superscript</csymbol><apply id="S5.SS4.SSS2.p1.1.m1.1.2.2.cmml" xref="S5.SS4.SSS2.p1.1.m1.1.2.2"><ci id="S5.SS4.SSS2.p1.1.m1.1.2.2.1.cmml" xref="S5.SS4.SSS2.p1.1.m1.1.2.2.1">¯</ci><ci id="S5.SS4.SSS2.p1.1.m1.1.2.2.2.cmml" xref="S5.SS4.SSS2.p1.1.m1.1.2.2.2">𝒘</ci></apply><ci id="S5.SS4.SSS2.p1.1.m1.1.1.1.1.cmml" xref="S5.SS4.SSS2.p1.1.m1.1.1.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS2.p1.1.m1.1c">\bar{\bm{w}}^{(t)}</annotation></semantics></math> is the average of local models. The results in Fig. <a href="#S5.F7" title="Figure 7 ‣ 5.4.2 Diversity of Local Models ‣ 5.4 Ablation Studies ‣ 5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> indicate that our proposed balanced softmax can effectively reduce the weight diversity and thus facilitate the model aggregation, resulting in a better global model. Interestingly, we can find that when the feature augmentation is applied, the weight diversity will slightly increase as different clients may have various kinds of training samples and the calibration of local classifier also has some non-zero diversity across clients. However, the empirical results in the main evaluation clearly shows that the feature augmentation could benefit the federated learning by accelerating the model convergence and improving the final model accuracy. Possible explanation towards this phenomenon might be that slight noise in stochastic gradients can enhance the generalization of the trained model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>.</p>
</div>
<figure id="S5.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F7.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x16.png" id="S5.F7.1.g1" class="ltx_graphics ltx_img_landscape" width="216" height="168" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F7.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x17.png" id="S5.F7.2.g1" class="ltx_graphics ltx_img_landscape" width="216" height="168" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Local model parameter diversity over training rounds.</figcaption>
</figure>
</section>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5 </span><span id="S5.SS5.1.1" class="ltx_text ltx_font_italic">Further Discussions</span>
</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p">As there are many variable factors in algorithm assessment, we present further analyses and discussions on some important aspects, including the choice of hyper-parameters, local training epochs, straggling behavior transition periods and system sizes.</p>
</div>
<section id="S5.SS5.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.5.1 </span>Impact of Hyper-parameters</h4>

<div id="S5.SS5.SSS1.p1" class="ltx_para">
<p id="S5.SS5.SSS1.p1.14" class="ltx_p">There are mainly two hyper-parameters (<math id="S5.SS5.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS5.SSS1.p1.1.m1.1a"><mi id="S5.SS5.SSS1.p1.1.m1.1.1" xref="S5.SS5.SSS1.p1.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.1.m1.1b"><ci id="S5.SS5.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS5.SSS1.p1.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.1.m1.1c">\epsilon</annotation></semantics></math> and <math id="S5.SS5.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS5.SSS1.p1.2.m2.1a"><mi id="S5.SS5.SSS1.p1.2.m2.1.1" xref="S5.SS5.SSS1.p1.2.m2.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.2.m2.1b"><ci id="S5.SS5.SSS1.p1.2.m2.1.1.cmml" xref="S5.SS5.SSS1.p1.2.m2.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.2.m2.1c">\mu</annotation></semantics></math>) in our framework, however, simultaneously tuning them is still time-consuming. Here we choose to incrementally add those two components by first investigating the <math id="S5.SS5.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS5.SSS1.p1.3.m3.1a"><mi id="S5.SS5.SSS1.p1.3.m3.1.1" xref="S5.SS5.SSS1.p1.3.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.3.m3.1b"><ci id="S5.SS5.SSS1.p1.3.m3.1.1.cmml" xref="S5.SS5.SSS1.p1.3.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.3.m3.1c">\epsilon</annotation></semantics></math> to find a suitable value, then and tuning the <math id="S5.SS5.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS5.SSS1.p1.4.m4.1a"><mi id="S5.SS5.SSS1.p1.4.m4.1.1" xref="S5.SS5.SSS1.p1.4.m4.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.4.m4.1b"><ci id="S5.SS5.SSS1.p1.4.m4.1.1.cmml" xref="S5.SS5.SSS1.p1.4.m4.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.4.m4.1c">\mu</annotation></semantics></math> with the selected <math id="S5.SS5.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\epsilon^{*}" display="inline"><semantics id="S5.SS5.SSS1.p1.5.m5.1a"><msup id="S5.SS5.SSS1.p1.5.m5.1.1" xref="S5.SS5.SSS1.p1.5.m5.1.1.cmml"><mi id="S5.SS5.SSS1.p1.5.m5.1.1.2" xref="S5.SS5.SSS1.p1.5.m5.1.1.2.cmml">ϵ</mi><mo id="S5.SS5.SSS1.p1.5.m5.1.1.3" xref="S5.SS5.SSS1.p1.5.m5.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.5.m5.1b"><apply id="S5.SS5.SSS1.p1.5.m5.1.1.cmml" xref="S5.SS5.SSS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS5.SSS1.p1.5.m5.1.1.1.cmml" xref="S5.SS5.SSS1.p1.5.m5.1.1">superscript</csymbol><ci id="S5.SS5.SSS1.p1.5.m5.1.1.2.cmml" xref="S5.SS5.SSS1.p1.5.m5.1.1.2">italic-ϵ</ci><times id="S5.SS5.SSS1.p1.5.m5.1.1.3.cmml" xref="S5.SS5.SSS1.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.5.m5.1c">\epsilon^{*}</annotation></semantics></math> fixed. Specifically, we vary the value of <math id="S5.SS5.SSS1.p1.6.m6.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS5.SSS1.p1.6.m6.1a"><mi id="S5.SS5.SSS1.p1.6.m6.1.1" xref="S5.SS5.SSS1.p1.6.m6.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.6.m6.1b"><ci id="S5.SS5.SSS1.p1.6.m6.1.1.cmml" xref="S5.SS5.SSS1.p1.6.m6.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.6.m6.1c">\epsilon</annotation></semantics></math> over <math id="S5.SS5.SSS1.p1.7.m7.5" class="ltx_Math" alttext="\{1e-4,1e-3,{1e-2},1e-1,2e-1\}" display="inline"><semantics id="S5.SS5.SSS1.p1.7.m7.5a"><mrow id="S5.SS5.SSS1.p1.7.m7.5.5.5" xref="S5.SS5.SSS1.p1.7.m7.5.5.6.cmml"><mo stretchy="false" id="S5.SS5.SSS1.p1.7.m7.5.5.5.6" xref="S5.SS5.SSS1.p1.7.m7.5.5.6.cmml">{</mo><mrow id="S5.SS5.SSS1.p1.7.m7.1.1.1.1" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.cmml"><mrow id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.cmml"><mn id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.2" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.1" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.1.cmml">​</mo><mi id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.3" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.1" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.1.cmml">−</mo><mn id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.3" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.3.cmml">4</mn></mrow><mo id="S5.SS5.SSS1.p1.7.m7.5.5.5.7" xref="S5.SS5.SSS1.p1.7.m7.5.5.6.cmml">,</mo><mrow id="S5.SS5.SSS1.p1.7.m7.2.2.2.2" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.cmml"><mrow id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.cmml"><mn id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.2" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.1" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.1.cmml">​</mo><mi id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.3" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.3.cmml">e</mi></mrow><mo id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.1" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.1.cmml">−</mo><mn id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.3" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.3.cmml">3</mn></mrow><mo id="S5.SS5.SSS1.p1.7.m7.5.5.5.8" xref="S5.SS5.SSS1.p1.7.m7.5.5.6.cmml">,</mo><mrow id="S5.SS5.SSS1.p1.7.m7.3.3.3.3" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.cmml"><mrow id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.cmml"><mn id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.2" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.1" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.1.cmml">​</mo><mi id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.3" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.3.cmml">e</mi></mrow><mo id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.1" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.1.cmml">−</mo><mn id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.3" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.3.cmml">2</mn></mrow><mo id="S5.SS5.SSS1.p1.7.m7.5.5.5.9" xref="S5.SS5.SSS1.p1.7.m7.5.5.6.cmml">,</mo><mrow id="S5.SS5.SSS1.p1.7.m7.4.4.4.4" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.cmml"><mrow id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.cmml"><mn id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.2" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.1" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.1.cmml">​</mo><mi id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.3" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.3.cmml">e</mi></mrow><mo id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.1" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.1.cmml">−</mo><mn id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.3" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.3.cmml">1</mn></mrow><mo id="S5.SS5.SSS1.p1.7.m7.5.5.5.10" xref="S5.SS5.SSS1.p1.7.m7.5.5.6.cmml">,</mo><mrow id="S5.SS5.SSS1.p1.7.m7.5.5.5.5" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.cmml"><mrow id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.cmml"><mn id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.2" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.1" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.1.cmml">​</mo><mi id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.3" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.3.cmml">e</mi></mrow><mo id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.1" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.1.cmml">−</mo><mn id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.3" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.3.cmml">1</mn></mrow><mo stretchy="false" id="S5.SS5.SSS1.p1.7.m7.5.5.5.11" xref="S5.SS5.SSS1.p1.7.m7.5.5.6.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.7.m7.5b"><set id="S5.SS5.SSS1.p1.7.m7.5.5.6.cmml" xref="S5.SS5.SSS1.p1.7.m7.5.5.5"><apply id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1"><minus id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.1"></minus><apply id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2"><times id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.1"></times><cn type="integer" id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.2">1</cn><ci id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S5.SS5.SSS1.p1.7.m7.1.1.1.1.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.1.1.1.1.3">4</cn></apply><apply id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2"><minus id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.1"></minus><apply id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2"><times id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.1"></times><cn type="integer" id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.2">1</cn><ci id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.2.3">𝑒</ci></apply><cn type="integer" id="S5.SS5.SSS1.p1.7.m7.2.2.2.2.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.2.2.2.2.3">3</cn></apply><apply id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3"><minus id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.1"></minus><apply id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2"><times id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.1"></times><cn type="integer" id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.2">1</cn><ci id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.2.3">𝑒</ci></apply><cn type="integer" id="S5.SS5.SSS1.p1.7.m7.3.3.3.3.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.3.3.3.3.3">2</cn></apply><apply id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.cmml" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4"><minus id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.1"></minus><apply id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2"><times id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.1"></times><cn type="integer" id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.2">1</cn><ci id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.2.3">𝑒</ci></apply><cn type="integer" id="S5.SS5.SSS1.p1.7.m7.4.4.4.4.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.4.4.4.4.3">1</cn></apply><apply id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.cmml" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5"><minus id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.1"></minus><apply id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2"><times id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.1.cmml" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.1"></times><cn type="integer" id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.2.cmml" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.2">2</cn><ci id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.2.3">𝑒</ci></apply><cn type="integer" id="S5.SS5.SSS1.p1.7.m7.5.5.5.5.3.cmml" xref="S5.SS5.SSS1.p1.7.m7.5.5.5.5.3">1</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.7.m7.5c">\{1e-4,1e-3,{1e-2},1e-1,2e-1\}</annotation></semantics></math> with <math id="S5.SS5.SSS1.p1.8.m8.1" class="ltx_math_unparsed" alttext="\mu*=0" display="inline"><semantics id="S5.SS5.SSS1.p1.8.m8.1a"><mrow id="S5.SS5.SSS1.p1.8.m8.1b"><mi id="S5.SS5.SSS1.p1.8.m8.1.1">μ</mi><mo lspace="0.222em" rspace="0em" id="S5.SS5.SSS1.p1.8.m8.1.2">∗</mo><mo lspace="0em" id="S5.SS5.SSS1.p1.8.m8.1.3">=</mo><mn id="S5.SS5.SSS1.p1.8.m8.1.4">0</mn></mrow><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.8.m8.1c">\mu*=0</annotation></semantics></math> and vary the value of <math id="S5.SS5.SSS1.p1.9.m9.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS5.SSS1.p1.9.m9.1a"><mi id="S5.SS5.SSS1.p1.9.m9.1.1" xref="S5.SS5.SSS1.p1.9.m9.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.9.m9.1b"><ci id="S5.SS5.SSS1.p1.9.m9.1.1.cmml" xref="S5.SS5.SSS1.p1.9.m9.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.9.m9.1c">\mu</annotation></semantics></math> over <math id="S5.SS5.SSS1.p1.10.m10.5" class="ltx_Math" alttext="\{0,0.1,0.5,1.0,5.0\}" display="inline"><semantics id="S5.SS5.SSS1.p1.10.m10.5a"><mrow id="S5.SS5.SSS1.p1.10.m10.5.6.2" xref="S5.SS5.SSS1.p1.10.m10.5.6.1.cmml"><mo stretchy="false" id="S5.SS5.SSS1.p1.10.m10.5.6.2.1" xref="S5.SS5.SSS1.p1.10.m10.5.6.1.cmml">{</mo><mn id="S5.SS5.SSS1.p1.10.m10.1.1" xref="S5.SS5.SSS1.p1.10.m10.1.1.cmml">0</mn><mo id="S5.SS5.SSS1.p1.10.m10.5.6.2.2" xref="S5.SS5.SSS1.p1.10.m10.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS1.p1.10.m10.2.2" xref="S5.SS5.SSS1.p1.10.m10.2.2.cmml">0.1</mn><mo id="S5.SS5.SSS1.p1.10.m10.5.6.2.3" xref="S5.SS5.SSS1.p1.10.m10.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS1.p1.10.m10.3.3" xref="S5.SS5.SSS1.p1.10.m10.3.3.cmml">0.5</mn><mo id="S5.SS5.SSS1.p1.10.m10.5.6.2.4" xref="S5.SS5.SSS1.p1.10.m10.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS1.p1.10.m10.4.4" xref="S5.SS5.SSS1.p1.10.m10.4.4.cmml">1.0</mn><mo id="S5.SS5.SSS1.p1.10.m10.5.6.2.5" xref="S5.SS5.SSS1.p1.10.m10.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS1.p1.10.m10.5.5" xref="S5.SS5.SSS1.p1.10.m10.5.5.cmml">5.0</mn><mo stretchy="false" id="S5.SS5.SSS1.p1.10.m10.5.6.2.6" xref="S5.SS5.SSS1.p1.10.m10.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.10.m10.5b"><set id="S5.SS5.SSS1.p1.10.m10.5.6.1.cmml" xref="S5.SS5.SSS1.p1.10.m10.5.6.2"><cn type="integer" id="S5.SS5.SSS1.p1.10.m10.1.1.cmml" xref="S5.SS5.SSS1.p1.10.m10.1.1">0</cn><cn type="float" id="S5.SS5.SSS1.p1.10.m10.2.2.cmml" xref="S5.SS5.SSS1.p1.10.m10.2.2">0.1</cn><cn type="float" id="S5.SS5.SSS1.p1.10.m10.3.3.cmml" xref="S5.SS5.SSS1.p1.10.m10.3.3">0.5</cn><cn type="float" id="S5.SS5.SSS1.p1.10.m10.4.4.cmml" xref="S5.SS5.SSS1.p1.10.m10.4.4">1.0</cn><cn type="float" id="S5.SS5.SSS1.p1.10.m10.5.5.cmml" xref="S5.SS5.SSS1.p1.10.m10.5.5">5.0</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.10.m10.5c">\{0,0.1,0.5,1.0,5.0\}</annotation></semantics></math> with <math id="S5.SS5.SSS1.p1.11.m11.1" class="ltx_Math" alttext="\epsilon^{*}=0.01" display="inline"><semantics id="S5.SS5.SSS1.p1.11.m11.1a"><mrow id="S5.SS5.SSS1.p1.11.m11.1.1" xref="S5.SS5.SSS1.p1.11.m11.1.1.cmml"><msup id="S5.SS5.SSS1.p1.11.m11.1.1.2" xref="S5.SS5.SSS1.p1.11.m11.1.1.2.cmml"><mi id="S5.SS5.SSS1.p1.11.m11.1.1.2.2" xref="S5.SS5.SSS1.p1.11.m11.1.1.2.2.cmml">ϵ</mi><mo id="S5.SS5.SSS1.p1.11.m11.1.1.2.3" xref="S5.SS5.SSS1.p1.11.m11.1.1.2.3.cmml">∗</mo></msup><mo id="S5.SS5.SSS1.p1.11.m11.1.1.1" xref="S5.SS5.SSS1.p1.11.m11.1.1.1.cmml">=</mo><mn id="S5.SS5.SSS1.p1.11.m11.1.1.3" xref="S5.SS5.SSS1.p1.11.m11.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.11.m11.1b"><apply id="S5.SS5.SSS1.p1.11.m11.1.1.cmml" xref="S5.SS5.SSS1.p1.11.m11.1.1"><eq id="S5.SS5.SSS1.p1.11.m11.1.1.1.cmml" xref="S5.SS5.SSS1.p1.11.m11.1.1.1"></eq><apply id="S5.SS5.SSS1.p1.11.m11.1.1.2.cmml" xref="S5.SS5.SSS1.p1.11.m11.1.1.2"><csymbol cd="ambiguous" id="S5.SS5.SSS1.p1.11.m11.1.1.2.1.cmml" xref="S5.SS5.SSS1.p1.11.m11.1.1.2">superscript</csymbol><ci id="S5.SS5.SSS1.p1.11.m11.1.1.2.2.cmml" xref="S5.SS5.SSS1.p1.11.m11.1.1.2.2">italic-ϵ</ci><times id="S5.SS5.SSS1.p1.11.m11.1.1.2.3.cmml" xref="S5.SS5.SSS1.p1.11.m11.1.1.2.3"></times></apply><cn type="float" id="S5.SS5.SSS1.p1.11.m11.1.1.3.cmml" xref="S5.SS5.SSS1.p1.11.m11.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.11.m11.1c">\epsilon^{*}=0.01</annotation></semantics></math>. The results are presented in Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.5.1 Impact of Hyper-parameters ‣ 5.5 Further Discussions ‣ 5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>, from which we can find that a relative large <math id="S5.SS5.SSS1.p1.12.m12.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS5.SSS1.p1.12.m12.1a"><mi id="S5.SS5.SSS1.p1.12.m12.1.1" xref="S5.SS5.SSS1.p1.12.m12.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.12.m12.1b"><ci id="S5.SS5.SSS1.p1.12.m12.1.1.cmml" xref="S5.SS5.SSS1.p1.12.m12.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.12.m12.1c">\epsilon</annotation></semantics></math> will cause the training unstable but a too small value will reduce the model performance, indicating the importance of a suitable value of <math id="S5.SS5.SSS1.p1.13.m13.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S5.SS5.SSS1.p1.13.m13.1a"><mi id="S5.SS5.SSS1.p1.13.m13.1.1" xref="S5.SS5.SSS1.p1.13.m13.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.13.m13.1b"><ci id="S5.SS5.SSS1.p1.13.m13.1.1.cmml" xref="S5.SS5.SSS1.p1.13.m13.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.13.m13.1c">\epsilon</annotation></semantics></math>. Similarly, a proper selection of <math id="S5.SS5.SSS1.p1.14.m14.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS5.SSS1.p1.14.m14.1a"><mi id="S5.SS5.SSS1.p1.14.m14.1.1" xref="S5.SS5.SSS1.p1.14.m14.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS1.p1.14.m14.1b"><ci id="S5.SS5.SSS1.p1.14.m14.1.1.cmml" xref="S5.SS5.SSS1.p1.14.m14.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS1.p1.14.m14.1c">\mu</annotation></semantics></math> is also needed. However, the best values of hyper-parameters may vary among specific learning tasks. As mentioned before, we do not aim at finding the best combination of hyper-parameters and the empirical studies demonstrate that relatively small values are preferred.</p>
</div>
<figure id="S5.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F8.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x18.png" id="S5.F8.1.g1" class="ltx_graphics ltx_img_landscape" width="212" height="165" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F8.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x19.png" id="S5.F8.2.g1" class="ltx_graphics ltx_img_landscape" width="212" height="165" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F8.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x20.png" id="S5.F8.3.g1" class="ltx_graphics ltx_img_landscape" width="212" height="165" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F8.4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x21.png" id="S5.F8.4.g1" class="ltx_graphics ltx_img_landscape" width="212" height="165" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Performance comparison with varying hyper-parameters.</figcaption>
</figure>
</section>
<section id="S5.SS5.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.5.2 </span>Impact of Local Epochs</h4>

<div id="S5.SS5.SSS2.p1" class="ltx_para">
<p id="S5.SS5.SSS2.p1.5" class="ltx_p">In this part, we add more computation per client on each round by increasing the local epochs <math id="S5.SS5.SSS2.p1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS5.SSS2.p1.1.m1.1a"><mi id="S5.SS5.SSS2.p1.1.m1.1.1" xref="S5.SS5.SSS2.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p1.1.m1.1b"><ci id="S5.SS5.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS5.SSS2.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p1.1.m1.1c">E</annotation></semantics></math>. To reduce the communication overhead, the clients tend to have more local training steps for less frequent communication. To study the impact of local epochs, we conduct experiments on CIFAR-10 dataset with 20 clients by varying the epochs over <math id="S5.SS5.SSS2.p1.2.m2.5" class="ltx_Math" alttext="\{1,2,5,10,20\}" display="inline"><semantics id="S5.SS5.SSS2.p1.2.m2.5a"><mrow id="S5.SS5.SSS2.p1.2.m2.5.6.2" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml"><mo stretchy="false" id="S5.SS5.SSS2.p1.2.m2.5.6.2.1" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">{</mo><mn id="S5.SS5.SSS2.p1.2.m2.1.1" xref="S5.SS5.SSS2.p1.2.m2.1.1.cmml">1</mn><mo id="S5.SS5.SSS2.p1.2.m2.5.6.2.2" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS2.p1.2.m2.2.2" xref="S5.SS5.SSS2.p1.2.m2.2.2.cmml">2</mn><mo id="S5.SS5.SSS2.p1.2.m2.5.6.2.3" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS2.p1.2.m2.3.3" xref="S5.SS5.SSS2.p1.2.m2.3.3.cmml">5</mn><mo id="S5.SS5.SSS2.p1.2.m2.5.6.2.4" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS2.p1.2.m2.4.4" xref="S5.SS5.SSS2.p1.2.m2.4.4.cmml">10</mn><mo id="S5.SS5.SSS2.p1.2.m2.5.6.2.5" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS5.SSS2.p1.2.m2.5.5" xref="S5.SS5.SSS2.p1.2.m2.5.5.cmml">20</mn><mo stretchy="false" id="S5.SS5.SSS2.p1.2.m2.5.6.2.6" xref="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p1.2.m2.5b"><set id="S5.SS5.SSS2.p1.2.m2.5.6.1.cmml" xref="S5.SS5.SSS2.p1.2.m2.5.6.2"><cn type="integer" id="S5.SS5.SSS2.p1.2.m2.1.1.cmml" xref="S5.SS5.SSS2.p1.2.m2.1.1">1</cn><cn type="integer" id="S5.SS5.SSS2.p1.2.m2.2.2.cmml" xref="S5.SS5.SSS2.p1.2.m2.2.2">2</cn><cn type="integer" id="S5.SS5.SSS2.p1.2.m2.3.3.cmml" xref="S5.SS5.SSS2.p1.2.m2.3.3">5</cn><cn type="integer" id="S5.SS5.SSS2.p1.2.m2.4.4.cmml" xref="S5.SS5.SSS2.p1.2.m2.4.4">10</cn><cn type="integer" id="S5.SS5.SSS2.p1.2.m2.5.5.cmml" xref="S5.SS5.SSS2.p1.2.m2.5.5">20</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p1.2.m2.5c">\{1,2,5,10,20\}</annotation></semantics></math>. As shown in Tab. <a href="#S5.F9" title="Figure 9 ‣ 5.5.2 Impact of Local Epochs ‣ 5.5 Further Discussions ‣ 5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, our method is superior to other baselines by a large margin. Given limited communication rounds, the model is not well trained for all methods when the number of local updates is too small. For a large value of <math id="S5.SS5.SSS2.p1.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS5.SSS2.p1.3.m3.1a"><mi id="S5.SS5.SSS2.p1.3.m3.1.1" xref="S5.SS5.SSS2.p1.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p1.3.m3.1b"><ci id="S5.SS5.SSS2.p1.3.m3.1.1.cmml" xref="S5.SS5.SSS2.p1.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p1.3.m3.1c">E</annotation></semantics></math>, while the performance gap of these baselines is relatively small, our approach still consistently outperforms other methods. The results also show that larger values of <math id="S5.SS5.SSS2.p1.4.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS5.SSS2.p1.4.m4.1a"><mi id="S5.SS5.SSS2.p1.4.m4.1.1" xref="S5.SS5.SSS2.p1.4.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p1.4.m4.1b"><ci id="S5.SS5.SSS2.p1.4.m4.1.1.cmml" xref="S5.SS5.SSS2.p1.4.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p1.4.m4.1c">E</annotation></semantics></math> will only slightly hurt the model accuracy under our framework, while FedAvg results in more obvious accuracy degradation. It should also be pointed that the choice of <math id="S5.SS5.SSS2.p1.5.m5.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S5.SS5.SSS2.p1.5.m5.1a"><mi id="S5.SS5.SSS2.p1.5.m5.1.1" xref="S5.SS5.SSS2.p1.5.m5.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS2.p1.5.m5.1b"><ci id="S5.SS5.SSS2.p1.5.m5.1.1.cmml" xref="S5.SS5.SSS2.p1.5.m5.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS2.p1.5.m5.1c">E</annotation></semantics></math> is associated to the trade-off among computation, communication and model performance.</p>
</div>
<figure id="S5.F9" class="ltx_figure"><img src="/html/2303.06314/assets/x22.png" id="S5.F9.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="323" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Performance comparison on CIFAR-10 dataset with varying local epochs. The number of communication rounds is fixed.</figcaption>
</figure>
<figure id="S5.F10" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F10.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x23.png" id="S5.F10.1.g1" class="ltx_graphics ltx_img_landscape" width="217" height="172" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F10.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x24.png" id="S5.F10.2.g1" class="ltx_graphics ltx_img_landscape" width="217" height="172" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F10.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x25.png" id="S5.F10.3.g1" class="ltx_graphics ltx_img_landscape" width="217" height="172" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.F10.4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.06314/assets/x26.png" id="S5.F10.4.g1" class="ltx_graphics ltx_img_landscape" width="217" height="172" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Performance comparison on CIFAR-10 dataset with varying straggling periods. The active status of each client is changed with probability <math id="S5.F10.7.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S5.F10.7.m1.1b"><mi id="S5.F10.7.m1.1.1" xref="S5.F10.7.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S5.F10.7.m1.1c"><ci id="S5.F10.7.m1.1.1.cmml" xref="S5.F10.7.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.7.m1.1d">p</annotation></semantics></math> at a interval of <math id="S5.F10.8.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S5.F10.8.m2.1b"><mi id="S5.F10.8.m2.1.1" xref="S5.F10.8.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S5.F10.8.m2.1c"><ci id="S5.F10.8.m2.1.1.cmml" xref="S5.F10.8.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F10.8.m2.1d">s</annotation></semantics></math> rounds.</figcaption>
</figure>
</section>
<section id="S5.SS5.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.5.3 </span>Impact of Straggling Behaviors</h4>

<div id="S5.SS5.SSS3.p1" class="ltx_para">
<p id="S5.SS5.SSS3.p1.2" class="ltx_p">In the above experiments, we always assume that the client dropout is occurred with a given probability and is independent across communication rounds, which however could only cover a limited scenario as a straggling or inactive client might persist for a long period so as for a active client. Therefore, we investigate the impact of persistent straggling behaviors by adjusting the active states with a varying period <math id="S5.SS5.SSS3.p1.1.m1.4" class="ltx_Math" alttext="s\in\{2,5,10,20\}" display="inline"><semantics id="S5.SS5.SSS3.p1.1.m1.4a"><mrow id="S5.SS5.SSS3.p1.1.m1.4.5" xref="S5.SS5.SSS3.p1.1.m1.4.5.cmml"><mi id="S5.SS5.SSS3.p1.1.m1.4.5.2" xref="S5.SS5.SSS3.p1.1.m1.4.5.2.cmml">s</mi><mo id="S5.SS5.SSS3.p1.1.m1.4.5.1" xref="S5.SS5.SSS3.p1.1.m1.4.5.1.cmml">∈</mo><mrow id="S5.SS5.SSS3.p1.1.m1.4.5.3.2" xref="S5.SS5.SSS3.p1.1.m1.4.5.3.1.cmml"><mo stretchy="false" id="S5.SS5.SSS3.p1.1.m1.4.5.3.2.1" xref="S5.SS5.SSS3.p1.1.m1.4.5.3.1.cmml">{</mo><mn id="S5.SS5.SSS3.p1.1.m1.1.1" xref="S5.SS5.SSS3.p1.1.m1.1.1.cmml">2</mn><mo id="S5.SS5.SSS3.p1.1.m1.4.5.3.2.2" xref="S5.SS5.SSS3.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS5.SSS3.p1.1.m1.2.2" xref="S5.SS5.SSS3.p1.1.m1.2.2.cmml">5</mn><mo id="S5.SS5.SSS3.p1.1.m1.4.5.3.2.3" xref="S5.SS5.SSS3.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS5.SSS3.p1.1.m1.3.3" xref="S5.SS5.SSS3.p1.1.m1.3.3.cmml">10</mn><mo id="S5.SS5.SSS3.p1.1.m1.4.5.3.2.4" xref="S5.SS5.SSS3.p1.1.m1.4.5.3.1.cmml">,</mo><mn id="S5.SS5.SSS3.p1.1.m1.4.4" xref="S5.SS5.SSS3.p1.1.m1.4.4.cmml">20</mn><mo stretchy="false" id="S5.SS5.SSS3.p1.1.m1.4.5.3.2.5" xref="S5.SS5.SSS3.p1.1.m1.4.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS3.p1.1.m1.4b"><apply id="S5.SS5.SSS3.p1.1.m1.4.5.cmml" xref="S5.SS5.SSS3.p1.1.m1.4.5"><in id="S5.SS5.SSS3.p1.1.m1.4.5.1.cmml" xref="S5.SS5.SSS3.p1.1.m1.4.5.1"></in><ci id="S5.SS5.SSS3.p1.1.m1.4.5.2.cmml" xref="S5.SS5.SSS3.p1.1.m1.4.5.2">𝑠</ci><set id="S5.SS5.SSS3.p1.1.m1.4.5.3.1.cmml" xref="S5.SS5.SSS3.p1.1.m1.4.5.3.2"><cn type="integer" id="S5.SS5.SSS3.p1.1.m1.1.1.cmml" xref="S5.SS5.SSS3.p1.1.m1.1.1">2</cn><cn type="integer" id="S5.SS5.SSS3.p1.1.m1.2.2.cmml" xref="S5.SS5.SSS3.p1.1.m1.2.2">5</cn><cn type="integer" id="S5.SS5.SSS3.p1.1.m1.3.3.cmml" xref="S5.SS5.SSS3.p1.1.m1.3.3">10</cn><cn type="integer" id="S5.SS5.SSS3.p1.1.m1.4.4.cmml" xref="S5.SS5.SSS3.p1.1.m1.4.4">20</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS3.p1.1.m1.4c">s\in\{2,5,10,20\}</annotation></semantics></math>, where we conduct a random selection of dropout clients at intervals of every <math id="S5.SS5.SSS3.p1.2.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S5.SS5.SSS3.p1.2.m2.1a"><mi id="S5.SS5.SSS3.p1.2.m2.1.1" xref="S5.SS5.SSS3.p1.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS3.p1.2.m2.1b"><ci id="S5.SS5.SSS3.p1.2.m2.1.1.cmml" xref="S5.SS5.SSS3.p1.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS3.p1.2.m2.1c">s</annotation></semantics></math> rounds. From the curves in Fig. <a href="#S5.F10" title="Figure 10 ‣ 5.5.2 Impact of Local Epochs ‣ 5.5 Further Discussions ‣ 5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, it can be found that the straggling period has a non-negligible impact on the federated learning as in each period some classes may be missing among the active clients and the learned global model is biased such that the test accuracy might decrease in a extent. Nevertheless, our method still exhibits the best performance across different straggling behaviors, demonstrating its robustness and stability against the client dropout in cross-device FL scenarios.</p>
</div>
</section>
<section id="S5.SS5.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.5.4 </span>System Scalability</h4>

<div id="S5.SS5.SSS4.p1" class="ltx_para">
<p id="S5.SS5.SSS4.p1.3" class="ltx_p">In realistic IoT systems, the number of clients could be large, therefore it is important to evaluate the adaptability and scalability of FL algorithms. To this end, we launch three systems with <math id="S5.SS5.SSS4.p1.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS5.SSS4.p1.1.m1.1a"><mi id="S5.SS5.SSS4.p1.1.m1.1.1" xref="S5.SS5.SSS4.p1.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS4.p1.1.m1.1b"><ci id="S5.SS5.SSS4.p1.1.m1.1.1.cmml" xref="S5.SS5.SSS4.p1.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS4.p1.1.m1.1c">m</annotation></semantics></math>=100, 200 and 500 clients, respectively. We evenly partition the whole CIFAR-10 dataset into <math id="S5.SS5.SSS4.p1.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS5.SSS4.p1.2.m2.1a"><mi id="S5.SS5.SSS4.p1.2.m2.1.1" xref="S5.SS5.SSS4.p1.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS4.p1.2.m2.1b"><ci id="S5.SS5.SSS4.p1.2.m2.1.1.cmml" xref="S5.SS5.SSS4.p1.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS4.p1.2.m2.1c">m</annotation></semantics></math> clients and ensure that each client only contains samples from 2 classes. For simplicity, we select 10% clients in each communication round at random to simulate the independent stragglers. The results presented in Table <a href="#S5.T3" title="TABLE III ‣ 5.5.4 System Scalability ‣ 5.5 Further Discussions ‣ 5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> demonstrate that our proposed ReBaFL still outperforms other baselines under different system sizes. It can also be observed that the performance of all methods decreases with <math id="S5.SS5.SSS4.p1.3.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS5.SSS4.p1.3.m3.1a"><mi id="S5.SS5.SSS4.p1.3.m3.1.1" xref="S5.SS5.SSS4.p1.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.SSS4.p1.3.m3.1b"><ci id="S5.SS5.SSS4.p1.3.m3.1.1.cmml" xref="S5.SS5.SSS4.p1.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.SSS4.p1.3.m3.1c">m</annotation></semantics></math> increasing. We conjecture that the reason is that more clients will make the local models more diverse and hurt the global aggregation. However, our method can still achieve 46.67% accuracy when there are 500 clients.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">TABLE III: </span>The test accuracy (%) with varying number of clients (<math id="S5.T3.3.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.T3.3.m1.1b"><mi id="S5.T3.3.m1.1.1" xref="S5.T3.3.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.T3.3.m1.1c"><ci id="S5.T3.3.m1.1.1.cmml" xref="S5.T3.3.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.m1.1d">m</annotation></semantics></math>) on CIFAR-<math id="S5.T3.4.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S5.T3.4.m2.1b"><mn id="S5.T3.4.m2.1.1" xref="S5.T3.4.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.T3.4.m2.1c"><cn type="integer" id="S5.T3.4.m2.1.1.cmml" xref="S5.T3.4.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.m2.1d">10</annotation></semantics></math>. Client sampling rate is 0.1 for all settings.</figcaption>
<table id="S5.T3.7" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T3.7.4.1" class="ltx_tr">
<th id="S5.T3.7.4.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_tt" style="padding-top:0.9pt;padding-bottom:0.9pt;" rowspan="2">
<span id="S5.T3.7.4.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.7.4.1.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S5.T3.7.4.1.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Method</span></span>
</span>
</th>
<td id="S5.T3.7.4.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:0.9pt;padding-bottom:0.9pt;" colspan="3"><span id="S5.T3.7.4.1.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">System Size</span></td>
</tr>
<tr id="S5.T3.7.3" class="ltx_tr">
<td id="S5.T3.5.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><math id="S5.T3.5.1.1.m1.1" class="ltx_Math" alttext="m=100" display="inline"><semantics id="S5.T3.5.1.1.m1.1a"><mrow id="S5.T3.5.1.1.m1.1.1" xref="S5.T3.5.1.1.m1.1.1.cmml"><mi mathsize="90%" id="S5.T3.5.1.1.m1.1.1.2" xref="S5.T3.5.1.1.m1.1.1.2.cmml">m</mi><mo mathsize="90%" id="S5.T3.5.1.1.m1.1.1.1" xref="S5.T3.5.1.1.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.T3.5.1.1.m1.1.1.3" xref="S5.T3.5.1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.5.1.1.m1.1b"><apply id="S5.T3.5.1.1.m1.1.1.cmml" xref="S5.T3.5.1.1.m1.1.1"><eq id="S5.T3.5.1.1.m1.1.1.1.cmml" xref="S5.T3.5.1.1.m1.1.1.1"></eq><ci id="S5.T3.5.1.1.m1.1.1.2.cmml" xref="S5.T3.5.1.1.m1.1.1.2">𝑚</ci><cn type="integer" id="S5.T3.5.1.1.m1.1.1.3.cmml" xref="S5.T3.5.1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.1.1.m1.1c">m=100</annotation></semantics></math></td>
<td id="S5.T3.6.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><math id="S5.T3.6.2.2.m1.1" class="ltx_Math" alttext="m=200" display="inline"><semantics id="S5.T3.6.2.2.m1.1a"><mrow id="S5.T3.6.2.2.m1.1.1" xref="S5.T3.6.2.2.m1.1.1.cmml"><mi mathsize="90%" id="S5.T3.6.2.2.m1.1.1.2" xref="S5.T3.6.2.2.m1.1.1.2.cmml">m</mi><mo mathsize="90%" id="S5.T3.6.2.2.m1.1.1.1" xref="S5.T3.6.2.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.T3.6.2.2.m1.1.1.3" xref="S5.T3.6.2.2.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.6.2.2.m1.1b"><apply id="S5.T3.6.2.2.m1.1.1.cmml" xref="S5.T3.6.2.2.m1.1.1"><eq id="S5.T3.6.2.2.m1.1.1.1.cmml" xref="S5.T3.6.2.2.m1.1.1.1"></eq><ci id="S5.T3.6.2.2.m1.1.1.2.cmml" xref="S5.T3.6.2.2.m1.1.1.2">𝑚</ci><cn type="integer" id="S5.T3.6.2.2.m1.1.1.3.cmml" xref="S5.T3.6.2.2.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.2.2.m1.1c">m=200</annotation></semantics></math></td>
<td id="S5.T3.7.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><math id="S5.T3.7.3.3.m1.1" class="ltx_Math" alttext="m=500" display="inline"><semantics id="S5.T3.7.3.3.m1.1a"><mrow id="S5.T3.7.3.3.m1.1.1" xref="S5.T3.7.3.3.m1.1.1.cmml"><mi mathsize="90%" id="S5.T3.7.3.3.m1.1.1.2" xref="S5.T3.7.3.3.m1.1.1.2.cmml">m</mi><mo mathsize="90%" id="S5.T3.7.3.3.m1.1.1.1" xref="S5.T3.7.3.3.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S5.T3.7.3.3.m1.1.1.3" xref="S5.T3.7.3.3.m1.1.1.3.cmml">500</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.7.3.3.m1.1b"><apply id="S5.T3.7.3.3.m1.1.1.cmml" xref="S5.T3.7.3.3.m1.1.1"><eq id="S5.T3.7.3.3.m1.1.1.1.cmml" xref="S5.T3.7.3.3.m1.1.1.1"></eq><ci id="S5.T3.7.3.3.m1.1.1.2.cmml" xref="S5.T3.7.3.3.m1.1.1.2">𝑚</ci><cn type="integer" id="S5.T3.7.3.3.m1.1.1.3.cmml" xref="S5.T3.7.3.3.m1.1.1.3">500</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.3.3.m1.1c">m=500</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.7.5.2" class="ltx_tr">
<th id="S5.T3.7.5.2.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S5.T3.7.5.2.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.7.5.2.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S5.T3.7.5.2.1.1.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span></span>
</span>
</th>
<td id="S5.T3.7.5.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.5.2.2.1" class="ltx_text" style="font-size:90%;">55.78</span></td>
<td id="S5.T3.7.5.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.5.2.3.1" class="ltx_text" style="font-size:90%;">47.53</span></td>
<td id="S5.T3.7.5.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.5.2.4.1" class="ltx_text" style="font-size:90%;">33.78</span></td>
</tr>
<tr id="S5.T3.7.6.3" class="ltx_tr">
<th id="S5.T3.7.6.3.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S5.T3.7.6.3.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.7.6.3.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S5.T3.7.6.3.1.1.1.1" class="ltx_text" style="font-size:90%;">FedProx</span></span>
</span>
</th>
<td id="S5.T3.7.6.3.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.6.3.2.1" class="ltx_text" style="font-size:90%;">56.81</span></td>
<td id="S5.T3.7.6.3.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.6.3.3.1" class="ltx_text" style="font-size:90%;">47.49</span></td>
<td id="S5.T3.7.6.3.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.6.3.4.1" class="ltx_text" style="font-size:90%;">33.81</span></td>
</tr>
<tr id="S5.T3.7.7.4" class="ltx_tr">
<th id="S5.T3.7.7.4.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S5.T3.7.7.4.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.7.7.4.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S5.T3.7.7.4.1.1.1.1" class="ltx_text" style="font-size:90%;">Scaffold</span></span>
</span>
</th>
<td id="S5.T3.7.7.4.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.7.4.2.1" class="ltx_text" style="font-size:90%;">63.36</span></td>
<td id="S5.T3.7.7.4.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.7.4.3.1" class="ltx_text" style="font-size:90%;">47.66</span></td>
<td id="S5.T3.7.7.4.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.7.4.4.1" class="ltx_text" style="font-size:90%;">16.12</span></td>
</tr>
<tr id="S5.T3.7.8.5" class="ltx_tr">
<th id="S5.T3.7.8.5.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S5.T3.7.8.5.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.7.8.5.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S5.T3.7.8.5.1.1.1.1" class="ltx_text" style="font-size:90%;">FedDyn</span></span>
</span>
</th>
<td id="S5.T3.7.8.5.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.8.5.2.1" class="ltx_text" style="font-size:90%;">63.35</span></td>
<td id="S5.T3.7.8.5.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.8.5.3.1" class="ltx_text" style="font-size:90%;">53.58</span></td>
<td id="S5.T3.7.8.5.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.8.5.4.1" class="ltx_text" style="font-size:90%;">37.74</span></td>
</tr>
<tr id="S5.T3.7.9.6" class="ltx_tr">
<th id="S5.T3.7.9.6.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S5.T3.7.9.6.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.7.9.6.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S5.T3.7.9.6.1.1.1.1" class="ltx_text" style="font-size:90%;">MOON</span></span>
</span>
</th>
<td id="S5.T3.7.9.6.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.9.6.2.1" class="ltx_text" style="font-size:90%;">50.53</span></td>
<td id="S5.T3.7.9.6.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.9.6.3.1" class="ltx_text" style="font-size:90%;">42.47</span></td>
<td id="S5.T3.7.9.6.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.9.6.4.1" class="ltx_text" style="font-size:90%;">26.89</span></td>
</tr>
<tr id="S5.T3.7.10.7" class="ltx_tr">
<th id="S5.T3.7.10.7.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S5.T3.7.10.7.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.7.10.7.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S5.T3.7.10.7.1.1.1.1" class="ltx_text" style="font-size:90%;">FedRS</span></span>
</span>
</th>
<td id="S5.T3.7.10.7.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.10.7.2.1" class="ltx_text" style="font-size:90%;">60.85</span></td>
<td id="S5.T3.7.10.7.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.10.7.3.1" class="ltx_text" style="font-size:90%;">51.86</span></td>
<td id="S5.T3.7.10.7.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.10.7.4.1" class="ltx_text" style="font-size:90%;">42.12</span></td>
</tr>
<tr id="S5.T3.7.11.8" class="ltx_tr">
<th id="S5.T3.7.11.8.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S5.T3.7.11.8.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.7.11.8.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S5.T3.7.11.8.1.1.1.1" class="ltx_text" style="font-size:90%;">FedBABU</span></span>
</span>
</th>
<td id="S5.T3.7.11.8.2" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.11.8.2.1" class="ltx_text" style="font-size:90%;">52.65</span></td>
<td id="S5.T3.7.11.8.3" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.11.8.3.1" class="ltx_text" style="font-size:90%;">43.62</span></td>
<td id="S5.T3.7.11.8.4" class="ltx_td ltx_align_center" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.11.8.4.1" class="ltx_text" style="font-size:90%;">33.41</span></td>
</tr>
<tr id="S5.T3.7.12.9" class="ltx_tr">
<th id="S5.T3.7.12.9.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S5.T3.7.12.9.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.7.12.9.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S5.T3.7.12.9.1.1.1.1" class="ltx_text" style="font-size:90%;">BSM-FedAvg</span></span>
</span>
</th>
<td id="S5.T3.7.12.9.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.12.9.2.1" class="ltx_text" style="font-size:90%;">60.32</span></td>
<td id="S5.T3.7.12.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.12.9.3.1" class="ltx_text" style="font-size:90%;">51.75</span></td>
<td id="S5.T3.7.12.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.12.9.4.1" class="ltx_text" style="font-size:90%;">43.36</span></td>
</tr>
<tr id="S5.T3.7.13.10" class="ltx_tr">
<th id="S5.T3.7.13.10.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_row ltx_border_bb" style="padding-top:0.9pt;padding-bottom:0.9pt;">
<span id="S5.T3.7.13.10.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T3.7.13.10.1.1.1" class="ltx_p" style="width:71.1pt;"><span id="S5.T3.7.13.10.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">ReBaFL</span><span id="S5.T3.7.13.10.1.1.1.2" class="ltx_text" style="font-size:90%;"> (ours)</span></span>
</span>
</th>
<td id="S5.T3.7.13.10.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.13.10.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">63.89</span></td>
<td id="S5.T3.7.13.10.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.13.10.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">57.23</span></td>
<td id="S5.T3.7.13.10.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-top:0.9pt;padding-bottom:0.9pt;"><span id="S5.T3.7.13.10.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">46.67</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.F11" class="ltx_figure"><img src="/html/2303.06314/assets/x27.png" id="S5.F11.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="903" height="508" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Reconstruction results of invert attacks on the feature prototypes. No semantically meaningful information can be extracted by the attacks.</figcaption>
</figure>
</section>
</section>
<section id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6 </span><span id="S5.SS6.1.1" class="ltx_text ltx_font_italic">Testing Data Leakage from Prototypes</span>
</h3>

<div id="S5.SS6.p1" class="ltx_para">
<p id="S5.SS6.p1.1" class="ltx_p">Finally, we study the potential privacy leakage risk during the training of ReBaFL. Since our training process is involved with the sharing of feature prototypes for each class, we consider the honest-but-curious setting where both server and clients follow the system protocol exactly as specified, but may try to infer other parties’ private information based on the received feature prototypes. We simulate the scenarios with possible information leakage risks by presenting several data leakage attacks on CIFAR-10 dataset, including up-convolutional neural network (UpCNN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> and variational autoencoder (VAE) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite> that try to recover the input images from the feature representations. And we also adopt the approach from the state-of-the-art gradient attack generative regression neural network (GRNN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite> to inverse the feature prototypes. From the reconstructed results in Fig. <a href="#S5.F11" title="Figure 11 ‣ 5.5.4 System Scalability ‣ 5.5 Further Discussions ‣ 5 Evaluation ‣ Stabilizing and Improving Federated Learning with Non-IID Data and Client Dropout" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>, we can conclude that sharing feature prototypes will neither leak considerable information about the raw data, nor will they reveal any relationship between different image categories. The reasons why feature prototypes are difficult to invert may be in three-fold. First, the private information contained by the low-dimensional feature representation is much less than the high-dimensional gradient, thus even the successful gradient attack might fail to infer raw data from feature prototypes. Second, the feature prototype is an average of per-image feature vectors and the characteristics of individual images could be concealed. Third, the numerous non-linear transformations in the hidden layers of complex neural networks make it hard to invert images by only aligning the feature representations. This is also consistent with the phenomenon that reconstruction from the shallow representations is easier than from the representations generated by the deep fully-connected layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we introduce the relaxed balanced-softmax and the cross-class transfer-based feature augmentation for stabilizing and enhancing the federated learning with non-IID data and client dropout. We provide extensive evaluations to demonstrate the non-trivial improvement achieved by of our framework. We also evaluate image invert attacks on the feature prototypes to verify that the sharing of prototypes will not induce high privacy leakage risks. Promising future directions include extending our framework to the asynchronous/decentralized systems and incorporating more advanced global aggregation strategies to integrate heterogeneous local models.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
G. Hinton, L. Deng, D. Yu, G. E. Dahl, A. Mohamed, N. Jaitly,
A. Senior, V. Vanhoucke, P. Nguyen, T. N. Sainath, and
B. Kingsbury, “Deep neural networks for acoustic modeling in speech
recognition,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>, vol. 29, no. 6, pp.
82–97, 2012.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
V. Hayyolalam, M. Aloqaily, Ö. Özkasap, and M. Guizani,
“Edge-assisted solutions for iot-based connected healthcare systems: A
literature review,” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE Internet Things J.</em>, vol. 9, no. 12, pp.
9419–9443, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Z. Ullah, F. Al-Turjman, L. Mostarda, and R. Gagliardi, “Applications of
artificial intelligence and machine learning in smart cities,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Comput.
Commun.</em>, vol. 154, pp. 313–323, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
S. Sharma, <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Data privacy and GDPR handbook</em>.   John Wiley &amp; Sons, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and
Statistics, AISTATS</em>, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Q. Yang, Y. Liu, T. Chen, and Y. Tong, “Federated machine learning: Concept
and applications,” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ACM Trans. Intell. Syst. Technol.</em>, vol. 10, no. 2,
Jan. 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, A. Talwalkar, and V. Smith, “Federated learning:
Challenges, methods, and future directions,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Process.
Mag.</em>, vol. 37, no. 3, pp. 50–60, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V. Smith,
“Federated optimization in heterogeneous networks,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of
Machine Learning and Systems 2020, MLSys</em>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
O. A. Wahab, A. Mourad, H. Otrok, and T. Taleb, “Federated machine learning:
Survey, multi-level classification, desirable criteria and future directions
in communication and networking systems,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">IEEE Commun. Surv.
Tutorials</em>, vol. 23, no. 2, pp. 1342–1397, 2021.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
P. Kairouz, H. B. McMahan, B. Avent, A. Bellet, M. Bennis, and et al,
“Advances and open problems in federated learning,” <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Found. Trends
Mach. Learn.</em>, vol. 14, no. 1-2, pp. 1–210, 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
S. Wang, T. Tuor, T. Salonidis, K. K. Leung, C. Makaya, T. He, and K. Chan,
“Adaptive federated learning in resource constrained edge computing
systems,” <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">IEEE J. Sel. Areas Commun.</em>, vol. 37, no. 6, pp.
1205–1221, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
S. P. Karimireddy, S. Kale, M. Mohri, S. J. Reddi, S. U. Stich, and A. T.
Suresh, “SCAFFOLD: stochastic controlled averaging for federated
learning,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th International Conference on
Machine Learning, ICML</em>, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
D. A. E. Acar, Y. Zhao, R. M. Navarro, M. Mattina, P. N. Whatmough, and
V. Saligrama, “Federated learning based on dynamic regularization,” in
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">9th International Conference on Learning Representations, ICLR</em>,
2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Q. Li, B. He, and D. Song, “Model-contrastive federated learning,” in
<em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">IEEE Conference on Computer Vision and Pattern Recognition, CVPR</em>,
2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Q. Li, Y. Diao, Q. Chen, and B. He, “Federated learning on non-iid data silos:
An experimental study,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2102.02079, 2021. [Online].
Available: <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://arxiv.org/abs/2102.02079</span>

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
J. Ren, C. Yu, S. Sheng, X. Ma, H. Zhao, S. Yi, and H. Li, “Balanced
meta-softmax for long-tailed visual recognition,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Annual Conference
on Neural Information Processing Systems, NeurIPS</em>, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
M. Luo, F. Chen, D. Hu, Y. Zhang, J. Liang, and J. Feng, “No fear of
heterogeneity: Classifier calibration for federated learning with non-iid
data,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2106.05001, 2021. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://arxiv.org/abs/2106.05001</span>

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Z. Zhu, J. Hong, and J. Zhou, “Data-free knowledge distillation for
heterogeneous federated learning,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th
International Conference on Machine Learning, ICML</em>, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
X. Zhang, M. Hong, S. Dhople, W. Yin, and Y. Liu, “Fedpd: A federated learning
framework with adaptivity to non-iid data,” <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on
Signal Processing</em>, vol. 69, pp. 6055–6070, 2021.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
E. Ozfatura, K. Ozfatura, and D. Gündüz, “Fedadc: Accelerated
federated learning with drift control,” in <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">IEEE International
Symposium on Information Theory, ISIT</em>, 2021.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
J. Xu, S. Wang, L. Wang, and A. C.-C. Yao, “Fedcm: Federated learning with
client-level momentum,” <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.10874</em>, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
T. H. Hsu, H. Qi, and M. Brown, “Federated visual classification with
real-world data distribution,” in <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Computer Vision - ECCV 2020 - 16th
European Conference</em>, 2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
L. Wang, S. Xu, X. Wang, and Q. Zhu, “Addressing class imbalance in federated
learning,” in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Thirty-Fifth AAAI Conference on Artificial
Intelligence, AAAI</em>, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
T. Yoon, S. Shin, S. J. Hwang, and E. Yang, “Fedmix: Approximation of mixup
under mean augmented federated learning,” in <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">9th International
Conference on Learning Representations, ICLR</em>, 2021.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
H. Wang, Z. Kaplan, D. Niu, and B. Li, “Optimizing federated learning on
non-iid data with reinforcement learning,” in <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">IEEE Conference on
Computer Communications, INFOCOM</em>, 2020.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
M. Tang, X. Ning, Y. Wang, Y. Wang, and Y. Chen, “Fedgp: Correlation-based
active client selection for heterogeneous federated learning,” <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">CoRR</em>,
vol. abs/2103.13822, 2021. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://arxiv.org/abs/2103.13822</span>

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Y. Fraboni, R. Vidal, L. Kameni, and M. Lorenzi, “Clustered sampling:
Low-variance and improved representativity for clients selection in federated
learning,” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 38th International Conference on
Machine Learning, ICML</em>, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
H. Chen and W. Chao, “Fedbe: Making bayesian model ensemble applicable to
federated learning,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning
Representations, ICLR</em>, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
T. Lin, L. Kong, S. U. Stich, and M. Jaggi, “Ensemble distillation for robust
model fusion in federated learning,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information
Processing Systems 33: Annual Conference on Neural Information Processing
Systems, NeurIPS</em>, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
L. Zhang, L. Shen, L. Ding, D. Tao, and L. Duan, “Fine-tuning global model via
data-free knowledge distillation for non-iid federated learning,” in
<em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">IEEE/CVF Conference on Computer Vision and Pattern Recognition,
CVPR</em>.   IEEE, 2022, pp.
10 164–10 173.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
V. Kulkarni, M. Kulkarni, and A. Pant, “Survey of personalization techniques
for federated learning,” in <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Fourth World Conference on Smart Trends in
Systems, Security and Sustainability (WorldS4)</em>, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
C. T. Dinh, N. H. Tran, and T. D. Nguyen, “Personalized federated learning
with moreau envelopes,” in <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Conference on Neural Information Processing
Systems, NeurIPS</em>, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
A. Fallah, A. Mokhtari, and A. E. Ozdaglar, “Personalized federated learning
with theoretical guarantees: A model-agnostic meta-learning approach,” in
<em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems, NeurIPS</em>, 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
L. Collins, H. Hassani, A. Mokhtari, and S. Shakkottai, “Exploiting shared
representations for personalized federated learning,” in <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Proceedings
of the 38th International Conference on Machine Learning, ICML</em>, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
A. Ghosh, J. Chung, D. Yin, and K. Ramchandran, “An efficient framework for
clustered federated learning,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.04088</em>, 2020.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Y. Mansour, M. Mohri, J. Ro, and A. T. Suresh, “Three approaches for
personalization with applications to federated learning,” <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2002.10619</em>, 2020.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
F. Sattler, K. Müller, and W. Samek, “Clustered federated learning:
Model-agnostic distributed multitask optimization under privacy
constraints,” <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Neural Networks Learn. Syst.</em>, vol. 32,
no. 8, pp. 3710–3722, 2021.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Y. Chen, Y. Ning, M. Slawski, and H. Rangwala, “Asynchronous online federated
learning for edge devices with non-iid data,” in <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">IEEE International
Conference on Big Data (BigData)</em>, 2020.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
W. Wu, L. He, W. Lin, R. Mao, C. Maple, and S. A. Jarvis, “SAFA: A
semi-asynchronous protocol for fast federated learning with low overhead,”
<em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">IEEE Trans. Computers</em>, vol. 70, no. 5, pp. 655–668, 2021.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
X. Gu, K. Huang, J. Zhang, and L. Huang, “Fast federated learning in the
presence of arbitrary device unavailability,” in <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Annual Conference on
Neural Information Processing Systems, NeurIPS</em>, 2021.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
L. Zhu, H. Lin, Y. Lu, Y. Lin, and S. Han, “Delayed gradient averaging:
Tolerate the communication latency for federated learning,” in
<em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 34: Annual Conference
on Neural Information Processing Systems, NeurIPS</em>, 2021.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
A. Reisizadeh, I. Tziotis, H. Hassani, A. Mokhtari, and R. Pedarsani,
“Straggler-resilient federated learning: Leveraging the interplay between
statistical accuracy and system heterogeneity,” <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">IEEE J. Sel. Areas
Inf. Theory</em>, vol. 3, no. 2, pp. 197–205, 2022.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
B. Luo, W. Xiao, S. Wang, J. Huang, and L. Tassiulas, “Tackling system and
statistical heterogeneity for federated learning with adaptive client
sampling,” in <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">IEEE INFOCOM 2022 - IEEE Conference on Computer
Communications</em>, 2022.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Z. Ma, Y. Xu, H. Xu, Z. Meng, L. Huang, and Y. Xue, “Adaptive batch size for
federated learning in resource-constrained edge computing,” <em id="bib.bib45.1.1" class="ltx_emph ltx_font_italic">IEEE
Transactions on Mobile Computing</em>, pp. 1–1, 2021.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
L. Li, M. Duan, D. Liu, Y. Zhang, A. Ren, X. Chen, Y. Tan, and C. Wang,
“Fedsae: A novel self-adaptive federated learning framework in
heterogeneous systems,” in <em id="bib.bib46.1.1" class="ltx_emph ltx_font_italic">International Joint Conference on Neural
Networks, IJCNN</em>, 2021.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
D. Jhunjhunwala, P. Sharma, A. Nagarkatti, and G. Joshi, “Fedvarp: Tackling
the variance due to partial client participation in federated learning,” in
<em id="bib.bib47.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Thirty-Eighth Conference on Uncertainty in
Artificial Intelligence, UAI</em>, 2022.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
H. Wang and J. Xu, “Friends to help: Saving federated learning from client
dropout,” <em id="bib.bib48.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/2205.13222, 2022. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://doi.org/10.48550/arXiv.2205.13222</span>

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
J. Tian, Y. Liu, N. Glaser, Y. Hsu, and Z. Kira, “Posterior re-calibration for
imbalanced datasets,” in <em id="bib.bib49.1.1" class="ltx_emph ltx_font_italic">Annual Conference on Neural Information
Processing System, NeurIPS</em>, 2020.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
X. Li and D. Zhan, “Fedrs: Federated learning with restricted softmax for
label distribution non-iid data,” in <em id="bib.bib50.1.1" class="ltx_emph ltx_font_italic">KDD ’21: The 27th ACM
SIGKDD Conference on Knowledge Discovery and Data Mining</em>.   ACM, 2021.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
X. Yin, X. Yu, K. Sohn, X. Liu, and M. Chandraker, “Feature transfer learning
for face recognition with under-represented data,” in <em id="bib.bib51.1.1" class="ltx_emph ltx_font_italic">IEEE
Conference on Computer Vision and Pattern Recognition, CVPR</em>, 2019.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
R. Liu, Y. Cao, H. Chen, R. Guo, and M. Yoshikawa, “FLAME: differentially
private federated learning in the shuffle model,” in <em id="bib.bib52.1.1" class="ltx_emph ltx_font_italic">Thirty-Fifth
AAAI Conference on Artificial Intelligence, AAAI</em>, 2021.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
A. M. Girgis, D. Data, S. N. Diggavi, P. Kairouz, and A. T. Suresh, “Shuffled
model of differential privacy in federated learning,” in <em id="bib.bib53.1.1" class="ltx_emph ltx_font_italic">The 24th
International Conference on Artificial Intelligence and Statistics,
AISTATS</em>, 2021.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
H. Xiao, K. Rasul, and R. Vollgraf, “Fashion-mnist: a novel image dataset for
benchmarking machine learning algorithms,” <em id="bib.bib54.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, vol. abs/1708.07747,
2017.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
A. Krizhevsky and G. Hinton, “Learning multiple layers of features from tiny
images,” <em id="bib.bib55.1.1" class="ltx_emph ltx_font_italic">University of Toronto</em>, 2009.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
J. Oh, S. Kim, and S. Yun, “Fedbabu: Toward enhanced representation for
federated image classification,” in <em id="bib.bib56.1.1" class="ltx_emph ltx_font_italic">The Tenth International Conference
on Learning Representations, ICLR</em>, 2022.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
H. Chen and W. Chao, “On bridging generic and personalized federated learning
for image classification,” in <em id="bib.bib57.1.1" class="ltx_emph ltx_font_italic">The Tenth International Conference on
Learning Representations, ICLR</em>, 2022.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
J. Zhang, Z. Li, B. Li, J. Xu, S. Wu, S. Ding, and C. Wu, “Federated learning
with label distribution skew via logits calibration,” in <em id="bib.bib58.1.1" class="ltx_emph ltx_font_italic">International
Conference on Machine Learning, ICML</em>, 2022.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
S. L. Smith, E. Elsen, and S. De, “On the generalization benefit of noise in
stochastic gradient descent,” in <em id="bib.bib59.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th International
Conference on Machine Learning, ICML</em>, 2020.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
A. Dosovitskiy and T. Brox, “Inverting visual representations with
convolutional networks,” in <em id="bib.bib60.1.1" class="ltx_emph ltx_font_italic">IEEE Conference on Computer Vision and
Pattern Recognition, CVPR</em>, 2016.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
D. P. Kingma and M. Welling, “Auto-encoding variational bayes,” in <em id="bib.bib61.1.1" class="ltx_emph ltx_font_italic">2nd
International Conference on Learning Representations, ICLR</em>, 2014.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
H. Ren, J. Deng, and X. Xie, “GRNN: generative regression neural network -
A data leakage attack for federated learning,” <em id="bib.bib62.1.1" class="ltx_emph ltx_font_italic">ACM Trans. Intell.
Syst. Technol.</em>, vol. 13, no. 4, pp. 65:1–65:24, 2022.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.06312" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.06314" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.06314">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.06314" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.06315" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 20:19:11 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
