<!DOCTYPE html><html lang="en-GB">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1606.00061] Hierarchical Question-Image Co-Attention for Visual Question Answering</title><meta property="og:description" content="A number of recent works have proposed attention models for Visual Question Answering (VQA) that generate spatial maps highlighting image regions relevant to answering the question. In this paper, we argue that in addi…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hierarchical Question-Image Co-Attention for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Hierarchical Question-Image Co-Attention for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1606.00061">

<!--Generated on Sun Mar  3 23:12:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line" lang="en-GB">
<h1 class="ltx_title ltx_title_document">Hierarchical Question-Image Co-Attention 
<br class="ltx_break">for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiasen Lu<sup id="id7.7.id1" class="ltx_sup">∗</sup>, Jianwei Yang<sup id="id8.8.id2" class="ltx_sup">∗</sup>, Dhruv Batra<sup id="id9.9.id3" class="ltx_sup"><span id="id9.9.id3.1" class="ltx_text ltx_font_italic">∗†</span></sup> , Devi Parikh<sup id="id10.10.id4" class="ltx_sup"><span id="id10.10.id4.1" class="ltx_text ltx_font_italic">∗†</span></sup>
<br class="ltx_break"><math id="id5.5.m5.1" class="ltx_Math" alttext="*" display="inline"><semantics id="id5.5.m5.1a"><mo id="id5.5.m5.1.1" xref="id5.5.m5.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="id5.5.m5.1b"><times id="id5.5.m5.1.1.cmml" xref="id5.5.m5.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="id5.5.m5.1c">*</annotation></semantics></math> Virginia Tech, <math id="id6.6.m6.1" class="ltx_Math" alttext="\dagger" display="inline"><semantics id="id6.6.m6.1a"><mo id="id6.6.m6.1.1" xref="id6.6.m6.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id6.6.m6.1b"><ci id="id6.6.m6.1.1.cmml" xref="id6.6.m6.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id6.6.m6.1c">\dagger</annotation></semantics></math> Georgia Institute of Technology 
<br class="ltx_break"><span id="id11.11.id5" class="ltx_text ltx_font_typewriter">{jiasenlu, jw2yang, dbatra, parikh}@vt.edu</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id12.id1" class="ltx_p"><span id="id12.id1.1" class="ltx_text">A number of recent works have proposed attention models for Visual Question Answering (VQA) that generate spatial maps highlighting image regions relevant to answering the question. In this paper, we argue that in addition to modeling “where to look” or visual attention, it is equally important to model “what words to listen to” or <em id="id12.id1.1.1" class="ltx_emph ltx_font_italic">question attention</em>. We present a novel <em id="id12.id1.1.2" class="ltx_emph ltx_font_italic">co-attention</em> model for VQA that jointly reasons about image and question attention. In addition, our model reasons about the question (and consequently the image via the co-attention mechanism) in a hierarchical fashion via a novel 1-dimensional convolution neural networks (CNN). Our model improves the state-of-the-art on the VQA dataset from 60.3% to 60.5%, and from 61.6% to 63.3% on the COCO-QA dataset. By using ResNet, the performance is further improved to 62.1% for VQA and 65.4% for COCO-QA.<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>The source code can be downloaded from <span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/jiasenlu/HieCoAttenVQA</span></span></span></span>.</span></p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Visual Question Answering (VQA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> has emerged as a prominent multi-discipline research problem in both academia and industry. To correctly answer visual questions about an image, the machine needs to understand both the image and question.
Recently, visual attention based models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> have been explored for VQA, where the attention mechanism typically produces a spatial map highlighting image regions relevant to answering the question.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">So far, all attention models for VQA in literature have focused on the problem of identifying “where to look” or visual attention. In this paper, we argue that the problem of identifying “which words to listen to” or <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">question attention</em> is equally important. Consider the questions “how many horses are in this image?” and “how many horses can you see in this image?". They have the same meaning, essentially captured by the first three words. A machine that attends to the first three words would arguably be more robust to linguistic variations irrelevant to the meaning and answer of the question. Motivated by this observation, in addition to reasoning about visual attention, we also address the problem of question attention. Specifically, we present a novel multi-modal attention model for VQA with the following two unique features:</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p"><span id="S1.p3.1.1" class="ltx_text ltx_font_bold">Co-Attention</span>: We propose a novel mechanism that jointly reasons about visual attention and question attention, which we refer to as <em id="S1.p3.1.2" class="ltx_emph ltx_font_italic">co-attention</em>. Unlike previous works, which only focus on visual attention, our model has a natural symmetry between the image and question, in the sense that the image representation is used to guide the question attention and the question representation(s) are used to guide image attention.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text ltx_font_bold">Question Hierarchy</span>: We build a hierarchical architecture that co-attends to the image and question at three levels: (a) word level, (b) phrase level and (c) question level. At the word level, we embed the words to a vector space through an embedding matrix. At the phrase level, 1-dimensional convolution neural networks are used to capture the information contained in unigrams, bigrams and trigrams. Specifically, we convolve word representations with temporal filters of varying support, and then combine the various n-gram responses by pooling them into a single phrase level representation. At the question level, we use recurrent neural networks to encode the entire question. For each level of the question representation in this hierarchy, we construct joint question and image co-attention maps, which are then combined recursively to ultimately predict a distribution over the answers.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Overall, the main contributions of our work are:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a novel co-attention mechanism for VQA that jointly performs question-guided visual attention and image-guided question attention. We explore this mechanism with two strategies, parallel and alternating co-attention, which are described in Sec. <a href="#S3.SS3" title="3.3 Co-Attention ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>;</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a hierarchical architecture to represent the question, and consequently construct image-question co-attention maps at 3 different levels: word level, phrase level and question level. These co-attended features are then recursively combined from word level to question level for the final answer prediction;</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">At the phrase level, we propose a novel convolution-pooling strategy to adaptively select the phrase sizes whose representations are passed to the question level representation;</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para ltx_noindent">
<p id="S1.I1.i4.p1.1" class="ltx_p">Finally, we evaluate our proposed model on two large datasets, VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and COCO-QA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. We also perform ablation studies to quantify the roles of different components in our model.</p>
</div>
</li>
</ul>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1606.00061/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="396" height="198" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Flowchart of our proposed hierarchical co-attention model. Given a question, we extract its word level, phrase level and question level embeddings. At each level, we apply co-attention on both the image and question. The final answer prediction is based on all the co-attended image and question features.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p">Many recent works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> have proposed models for VQA. We compare and relate our proposed co-attention mechanism to other vision and language attention mechanisms in literature.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Image attention</span>. Instead of directly using the holistic entire-image embedding from the fully connected layer of a deep CNN (as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>), a number of recent works have explored image attention models for VQA. Zhu <em id="S2.p2.1.2" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.3" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> add spatial attention to the standard LSTM model for pointing and grounded QA. Andreas <em id="S2.p2.1.4" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.5" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> propose a compositional scheme that consists of a language parser and a number of neural modules networks. The language parser predicts which neural module network should be instantiated to answer the question.
Some other works perform image attention multiple times in a stacked manner. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, the authors propose a stacked attention network, which runs multiple hops to infer the answer progressively. To capture fine-grained information from the question, Xu <em id="S2.p2.1.6" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.7" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> propose a multi-hop image attention scheme. It aligns words to image patches in the first hop, and then refers to the entire question for obtaining image attention maps in the second hop. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, the authors generate image regions with object proposals and then select the regions relevant to the question and answer choice. Xiong <em id="S2.p2.1.8" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.9" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> augments dynamic memory network with a new input fusion module and retrieves an answer from an attention based GRU. In concurrent work, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> collected ‘human attention maps’ that are used to evaluate the attention maps generated by attention models for VQA. Note that all of these approaches model visual attention alone, and do not model question attention. Moreover, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> model attention sequentially, i.e., later attention is based on earlier attention, which is prone to error propagation. In contrast, we conduct co-attention at three levels independently.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Language Attention</span>. Though no prior work has explored question attention in VQA, there are some related works in natural language processing (NLP) in general that have modeled language attention. In order to overcome difficulty in translation of long sentences, Bahdanau <em id="S2.p3.1.2" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p3.1.3" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> propose RNNSearch to learn an alignment over the input sentences. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, the authors propose an attention model to circumvent the bottleneck caused by fixed width hidden vector in text reading and comprehension. A more fine-grained attention mechanism is proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. The authors employ a word-by-word neural attention mechanism to reason about the entailment in two sentences. Also focused on modeling sentence pairs, the authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> propose an attention-based bigram CNN for jointly performing attention between two CNN hierarchies. In their work, three attention schemes are proposed and evaluated. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, the authors propose a two-way attention mechanism to project the paired inputs into a common representation space.

</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Method</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">We begin by introducing the notation used in this paper. To ease understanding, our full model is described in parts. First, our hierarchical question representation is described in Sec. <a href="#S3.SS2" title="3.2 Question Hierarchy ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> and the proposed co-attention mechanism is then described in Sec. <a href="#S3.SS3" title="3.3 Co-Attention ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>. Finally, Sec. <a href="#S3.SS4" title="3.4 Encoding for Predicting Answers ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a> shows how to recursively combine the attended question and image features to output answers.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Notation</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.16" class="ltx_p">Given a question with <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">T</annotation></semantics></math> words, its representation is denoted by <math id="S3.SS1.p1.2.m2.2" class="ltx_Math" alttext="\bm{Q}=\left\{\bm{q}_{1},\ldots\bm{q}_{T}\right\}" display="inline"><semantics id="S3.SS1.p1.2.m2.2a"><mrow id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.2.2.4" xref="S3.SS1.p1.2.m2.2.2.4.cmml">𝑸</mi><mo id="S3.SS1.p1.2.m2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.3.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml"><mo id="S3.SS1.p1.2.m2.2.2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">{</mo><msub id="S3.SS1.p1.2.m2.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.cmml">𝒒</mi><mn id="S3.SS1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.2.2.2.2.4" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">,</mo><mrow id="S3.SS1.p1.2.m2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS1.p1.2.m2.2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.2.m2.2.2.2.2.2.1" xref="S3.SS1.p1.2.m2.2.2.2.2.2.1.cmml">​</mo><msub id="S3.SS1.p1.2.m2.2.2.2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3.cmml"><mi id="S3.SS1.p1.2.m2.2.2.2.2.2.3.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3.2.cmml">𝒒</mi><mi id="S3.SS1.p1.2.m2.2.2.2.2.2.3.3" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3.3.cmml">T</mi></msub></mrow><mo id="S3.SS1.p1.2.m2.2.2.2.2.5" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><apply id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2"><eq id="S3.SS1.p1.2.m2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.3"></eq><ci id="S3.SS1.p1.2.m2.2.2.4.cmml" xref="S3.SS1.p1.2.m2.2.2.4">𝑸</ci><set id="S3.SS1.p1.2.m2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2"><apply id="S3.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2">𝒒</ci><cn type="integer" id="S3.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2"><times id="S3.SS1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.1"></times><ci id="S3.SS1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.2">…</ci><apply id="S3.SS1.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.2.2.2.3.1.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.2.2.2.3.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3.2">𝒒</ci><ci id="S3.SS1.p1.2.m2.2.2.2.2.2.3.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3.3">𝑇</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">\bm{Q}=\left\{\bm{q}_{1},\ldots\bm{q}_{T}\right\}</annotation></semantics></math>, where <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="\bm{q}_{t}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">𝒒</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝒒</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\bm{q}_{t}</annotation></semantics></math> is the feature vector for the <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">t</annotation></semantics></math>-th word. We denote <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\bm{q}^{w}_{t}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msubsup id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2.2" xref="S3.SS1.p1.5.m5.1.1.2.2.cmml">𝒒</mi><mi id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">t</mi><mi id="S3.SS1.p1.5.m5.1.1.2.3" xref="S3.SS1.p1.5.m5.1.1.2.3.cmml">w</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><apply id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS1.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2.2">𝒒</ci><ci id="S3.SS1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS1.p1.5.m5.1.1.2.3">𝑤</ci></apply><ci id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\bm{q}^{w}_{t}</annotation></semantics></math>, <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\bm{q}^{p}_{t}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msubsup id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2.2" xref="S3.SS1.p1.6.m6.1.1.2.2.cmml">𝒒</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">t</mi><mi id="S3.SS1.p1.6.m6.1.1.2.3" xref="S3.SS1.p1.6.m6.1.1.2.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><apply id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2.2">𝒒</ci><ci id="S3.SS1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.2.3">𝑝</ci></apply><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\bm{q}^{p}_{t}</annotation></semantics></math> and <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="\bm{q}^{s}_{t}" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><msubsup id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2.2" xref="S3.SS1.p1.7.m7.1.1.2.2.cmml">𝒒</mi><mi id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">t</mi><mi id="S3.SS1.p1.7.m7.1.1.2.3" xref="S3.SS1.p1.7.m7.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><apply id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2.2">𝒒</ci><ci id="S3.SS1.p1.7.m7.1.1.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.2.3">𝑠</ci></apply><ci id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">\bm{q}^{s}_{t}</annotation></semantics></math> as word embedding, phrase embedding and question embedding at position <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">t</annotation></semantics></math>, respectively.
The image feature is denoted by <math id="S3.SS1.p1.9.m9.3" class="ltx_Math" alttext="\bm{{V}}=\{\bm{v}_{1},...,\bm{v}_{N}\}" display="inline"><semantics id="S3.SS1.p1.9.m9.3a"><mrow id="S3.SS1.p1.9.m9.3.3" xref="S3.SS1.p1.9.m9.3.3.cmml"><mi id="S3.SS1.p1.9.m9.3.3.4" xref="S3.SS1.p1.9.m9.3.3.4.cmml">𝑽</mi><mo id="S3.SS1.p1.9.m9.3.3.3" xref="S3.SS1.p1.9.m9.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.9.m9.3.3.2.2" xref="S3.SS1.p1.9.m9.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.9.m9.3.3.2.2.3" xref="S3.SS1.p1.9.m9.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.9.m9.2.2.1.1.1" xref="S3.SS1.p1.9.m9.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.9.m9.2.2.1.1.1.2" xref="S3.SS1.p1.9.m9.2.2.1.1.1.2.cmml">𝒗</mi><mn id="S3.SS1.p1.9.m9.2.2.1.1.1.3" xref="S3.SS1.p1.9.m9.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.9.m9.3.3.2.2.4" xref="S3.SS1.p1.9.m9.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">…</mi><mo id="S3.SS1.p1.9.m9.3.3.2.2.5" xref="S3.SS1.p1.9.m9.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.9.m9.3.3.2.2.2" xref="S3.SS1.p1.9.m9.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.9.m9.3.3.2.2.2.2" xref="S3.SS1.p1.9.m9.3.3.2.2.2.2.cmml">𝒗</mi><mi id="S3.SS1.p1.9.m9.3.3.2.2.2.3" xref="S3.SS1.p1.9.m9.3.3.2.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="S3.SS1.p1.9.m9.3.3.2.2.6" xref="S3.SS1.p1.9.m9.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.3b"><apply id="S3.SS1.p1.9.m9.3.3.cmml" xref="S3.SS1.p1.9.m9.3.3"><eq id="S3.SS1.p1.9.m9.3.3.3.cmml" xref="S3.SS1.p1.9.m9.3.3.3"></eq><ci id="S3.SS1.p1.9.m9.3.3.4.cmml" xref="S3.SS1.p1.9.m9.3.3.4">𝑽</ci><set id="S3.SS1.p1.9.m9.3.3.2.3.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2"><apply id="S3.SS1.p1.9.m9.2.2.1.1.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.2">𝒗</ci><cn type="integer" id="S3.SS1.p1.9.m9.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.9.m9.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">…</ci><apply id="S3.SS1.p1.9.m9.3.3.2.2.2.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.9.m9.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2.2">𝒗</ci><ci id="S3.SS1.p1.9.m9.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.9.m9.3.3.2.2.2.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.3c">\bm{{V}}=\{\bm{v}_{1},...,\bm{v}_{N}\}</annotation></semantics></math>, where <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="\bm{v}_{n}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">𝒗</mi><mi id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝒗</ci><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">\bm{v}_{n}</annotation></semantics></math> is the feature vector at the spatial location <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">n</annotation></semantics></math>. The co-attention features of image and question at each level in the hierarchy are denoted as <math id="S3.SS1.p1.12.m12.1" class="ltx_Math" alttext="\hat{\bm{v}}^{r}" display="inline"><semantics id="S3.SS1.p1.12.m12.1a"><msup id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mover accent="true" id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2.2" xref="S3.SS1.p1.12.m12.1.1.2.2.cmml">𝒗</mi><mo id="S3.SS1.p1.12.m12.1.1.2.1" xref="S3.SS1.p1.12.m12.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">superscript</csymbol><apply id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2"><ci id="S3.SS1.p1.12.m12.1.1.2.1.cmml" xref="S3.SS1.p1.12.m12.1.1.2.1">^</ci><ci id="S3.SS1.p1.12.m12.1.1.2.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2.2">𝒗</ci></apply><ci id="S3.SS1.p1.12.m12.1.1.3.cmml" xref="S3.SS1.p1.12.m12.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\hat{\bm{v}}^{r}</annotation></semantics></math> and <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="\hat{\bm{q}}^{r}" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><msup id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mover accent="true" id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2.2" xref="S3.SS1.p1.13.m13.1.1.2.2.cmml">𝒒</mi><mo id="S3.SS1.p1.13.m13.1.1.2.1" xref="S3.SS1.p1.13.m13.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">superscript</csymbol><apply id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2"><ci id="S3.SS1.p1.13.m13.1.1.2.1.cmml" xref="S3.SS1.p1.13.m13.1.1.2.1">^</ci><ci id="S3.SS1.p1.13.m13.1.1.2.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2.2">𝒒</ci></apply><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">\hat{\bm{q}}^{r}</annotation></semantics></math> where <math id="S3.SS1.p1.14.m14.3" class="ltx_Math" alttext="r\in\left\{w,p,s\right\}" display="inline"><semantics id="S3.SS1.p1.14.m14.3a"><mrow id="S3.SS1.p1.14.m14.3.4" xref="S3.SS1.p1.14.m14.3.4.cmml"><mi id="S3.SS1.p1.14.m14.3.4.2" xref="S3.SS1.p1.14.m14.3.4.2.cmml">r</mi><mo id="S3.SS1.p1.14.m14.3.4.1" xref="S3.SS1.p1.14.m14.3.4.1.cmml">∈</mo><mrow id="S3.SS1.p1.14.m14.3.4.3.2" xref="S3.SS1.p1.14.m14.3.4.3.1.cmml"><mo id="S3.SS1.p1.14.m14.3.4.3.2.1" xref="S3.SS1.p1.14.m14.3.4.3.1.cmml">{</mo><mi id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml">w</mi><mo id="S3.SS1.p1.14.m14.3.4.3.2.2" xref="S3.SS1.p1.14.m14.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p1.14.m14.2.2" xref="S3.SS1.p1.14.m14.2.2.cmml">p</mi><mo id="S3.SS1.p1.14.m14.3.4.3.2.3" xref="S3.SS1.p1.14.m14.3.4.3.1.cmml">,</mo><mi id="S3.SS1.p1.14.m14.3.3" xref="S3.SS1.p1.14.m14.3.3.cmml">s</mi><mo id="S3.SS1.p1.14.m14.3.4.3.2.4" xref="S3.SS1.p1.14.m14.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.3b"><apply id="S3.SS1.p1.14.m14.3.4.cmml" xref="S3.SS1.p1.14.m14.3.4"><in id="S3.SS1.p1.14.m14.3.4.1.cmml" xref="S3.SS1.p1.14.m14.3.4.1"></in><ci id="S3.SS1.p1.14.m14.3.4.2.cmml" xref="S3.SS1.p1.14.m14.3.4.2">𝑟</ci><set id="S3.SS1.p1.14.m14.3.4.3.1.cmml" xref="S3.SS1.p1.14.m14.3.4.3.2"><ci id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">𝑤</ci><ci id="S3.SS1.p1.14.m14.2.2.cmml" xref="S3.SS1.p1.14.m14.2.2">𝑝</ci><ci id="S3.SS1.p1.14.m14.3.3.cmml" xref="S3.SS1.p1.14.m14.3.3">𝑠</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.3c">r\in\left\{w,p,s\right\}</annotation></semantics></math>. The weights in different modules/layers are denoted with <math id="S3.SS1.p1.15.m15.1" class="ltx_Math" alttext="\bm{W}" display="inline"><semantics id="S3.SS1.p1.15.m15.1a"><mi id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml">𝑾</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><ci id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">𝑾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">\bm{W}</annotation></semantics></math>, with appropriate sub/super-scripts as necessary. In the exposition that follows, we omit the bias term <math id="S3.SS1.p1.16.m16.1" class="ltx_Math" alttext="\bm{b}" display="inline"><semantics id="S3.SS1.p1.16.m16.1a"><mi id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml">𝒃</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><ci id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">𝒃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">\bm{b}</annotation></semantics></math> to avoid notational clutter.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Question Hierarchy</h3>

<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.4" class="ltx_p">Given the 1-hot encoding of the question words <math id="S3.SS2.p1.1.m1.3" class="ltx_Math" alttext="\bm{Q}=\left\{\bm{q}_{1},\ldots,\bm{q}_{T}\right\}" display="inline"><semantics id="S3.SS2.p1.1.m1.3a"><mrow id="S3.SS2.p1.1.m1.3.3" xref="S3.SS2.p1.1.m1.3.3.cmml"><mi id="S3.SS2.p1.1.m1.3.3.4" xref="S3.SS2.p1.1.m1.3.3.4.cmml">𝑸</mi><mo id="S3.SS2.p1.1.m1.3.3.3" xref="S3.SS2.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.3.3.2.2" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml"><mo id="S3.SS2.p1.1.m1.3.3.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">{</mo><msub id="S3.SS2.p1.1.m1.2.2.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml">𝒒</mi><mn id="S3.SS2.p1.1.m1.2.2.1.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.1.m1.3.3.2.2.4" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p1.1.m1.3.3.2.2.5" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p1.1.m1.3.3.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml">𝒒</mi><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml">T</mi></msub><mo id="S3.SS2.p1.1.m1.3.3.2.2.6" xref="S3.SS2.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.3b"><apply id="S3.SS2.p1.1.m1.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3"><eq id="S3.SS2.p1.1.m1.3.3.3.cmml" xref="S3.SS2.p1.1.m1.3.3.3"></eq><ci id="S3.SS2.p1.1.m1.3.3.4.cmml" xref="S3.SS2.p1.1.m1.3.3.4">𝑸</ci><set id="S3.SS2.p1.1.m1.3.3.2.3.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2"><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2">𝒒</ci><cn type="integer" id="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">…</ci><apply id="S3.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2">𝒒</ci><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3">𝑇</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.3c">\bm{Q}=\left\{\bm{q}_{1},\ldots,\bm{q}_{T}\right\}</annotation></semantics></math>, we first embed the words to a vector space (learnt end-to-end) to get <math id="S3.SS2.p1.2.m2.3" class="ltx_Math" alttext="\bm{Q}^{w}=\left\{\bm{q}^{w}_{1},\ldots,\bm{q}^{w}_{T}\right\}" display="inline"><semantics id="S3.SS2.p1.2.m2.3a"><mrow id="S3.SS2.p1.2.m2.3.3" xref="S3.SS2.p1.2.m2.3.3.cmml"><msup id="S3.SS2.p1.2.m2.3.3.4" xref="S3.SS2.p1.2.m2.3.3.4.cmml"><mi id="S3.SS2.p1.2.m2.3.3.4.2" xref="S3.SS2.p1.2.m2.3.3.4.2.cmml">𝑸</mi><mi id="S3.SS2.p1.2.m2.3.3.4.3" xref="S3.SS2.p1.2.m2.3.3.4.3.cmml">w</mi></msup><mo id="S3.SS2.p1.2.m2.3.3.3" xref="S3.SS2.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S3.SS2.p1.2.m2.3.3.2.2" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml"><mo id="S3.SS2.p1.2.m2.3.3.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">{</mo><msubsup id="S3.SS2.p1.2.m2.2.2.1.1.1" xref="S3.SS2.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.2.2.1.1.1.2.2" xref="S3.SS2.p1.2.m2.2.2.1.1.1.2.2.cmml">𝒒</mi><mn id="S3.SS2.p1.2.m2.2.2.1.1.1.3" xref="S3.SS2.p1.2.m2.2.2.1.1.1.3.cmml">1</mn><mi id="S3.SS2.p1.2.m2.2.2.1.1.1.2.3" xref="S3.SS2.p1.2.m2.2.2.1.1.1.2.3.cmml">w</mi></msubsup><mo id="S3.SS2.p1.2.m2.3.3.2.2.4" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS2.p1.2.m2.3.3.2.2.5" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">,</mo><msubsup id="S3.SS2.p1.2.m2.3.3.2.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.2.m2.3.3.2.2.2.2.2" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2.2.cmml">𝒒</mi><mi id="S3.SS2.p1.2.m2.3.3.2.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.2.2.3.cmml">T</mi><mi id="S3.SS2.p1.2.m2.3.3.2.2.2.2.3" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2.3.cmml">w</mi></msubsup><mo id="S3.SS2.p1.2.m2.3.3.2.2.6" xref="S3.SS2.p1.2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.3b"><apply id="S3.SS2.p1.2.m2.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3"><eq id="S3.SS2.p1.2.m2.3.3.3.cmml" xref="S3.SS2.p1.2.m2.3.3.3"></eq><apply id="S3.SS2.p1.2.m2.3.3.4.cmml" xref="S3.SS2.p1.2.m2.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.4.1.cmml" xref="S3.SS2.p1.2.m2.3.3.4">superscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.4.2.cmml" xref="S3.SS2.p1.2.m2.3.3.4.2">𝑸</ci><ci id="S3.SS2.p1.2.m2.3.3.4.3.cmml" xref="S3.SS2.p1.2.m2.3.3.4.3">𝑤</ci></apply><set id="S3.SS2.p1.2.m2.3.3.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2"><apply id="S3.SS2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1">subscript</csymbol><apply id="S3.SS2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.2.m2.2.2.1.1.1.2.2.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1.2.2">𝒒</ci><ci id="S3.SS2.p1.2.m2.2.2.1.1.1.2.3.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1.2.3">𝑤</ci></apply><cn type="integer" id="S3.SS2.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">…</ci><apply id="S3.SS2.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2">subscript</csymbol><apply id="S3.SS2.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2">superscript</csymbol><ci id="S3.SS2.p1.2.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2.2">𝒒</ci><ci id="S3.SS2.p1.2.m2.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2.2.3">𝑤</ci></apply><ci id="S3.SS2.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS2.p1.2.m2.3.3.2.2.2.3">𝑇</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.3c">\bm{Q}^{w}=\left\{\bm{q}^{w}_{1},\ldots,\bm{q}^{w}_{T}\right\}</annotation></semantics></math>. To compute the phrase features, we apply 1-D convolution on the word embedding vectors. Concretely, at each word location, we compute the inner product of the word vectors with filters of three window sizes: unigram, bigram and trigram. For the <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">t</annotation></semantics></math>-th word, the convolution output with window size <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">s</annotation></semantics></math> is given by</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.8" class="ltx_Math" alttext="\hat{\bm{q}}^{p}_{s,t}=\tanh(\bm{W}_{c}^{s}\bm{q}^{w}_{t:t+s-1}),\quad s\in\{1,2,3\}" display="block"><semantics id="S3.E1.m1.8a"><mrow id="S3.E1.m1.8.8.2" xref="S3.E1.m1.8.8.3.cmml"><mrow id="S3.E1.m1.7.7.1.1" xref="S3.E1.m1.7.7.1.1.cmml"><msubsup id="S3.E1.m1.7.7.1.1.3" xref="S3.E1.m1.7.7.1.1.3.cmml"><mover accent="true" id="S3.E1.m1.7.7.1.1.3.2.2" xref="S3.E1.m1.7.7.1.1.3.2.2.cmml"><mi id="S3.E1.m1.7.7.1.1.3.2.2.2" xref="S3.E1.m1.7.7.1.1.3.2.2.2.cmml">𝒒</mi><mo id="S3.E1.m1.7.7.1.1.3.2.2.1" xref="S3.E1.m1.7.7.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S3.E1.m1.2.2.2.4" xref="S3.E1.m1.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">s</mi><mo id="S3.E1.m1.2.2.2.4.1" xref="S3.E1.m1.2.2.2.3.cmml">,</mo><mi id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.cmml">t</mi></mrow><mi id="S3.E1.m1.7.7.1.1.3.2.3" xref="S3.E1.m1.7.7.1.1.3.2.3.cmml">p</mi></msubsup><mo id="S3.E1.m1.7.7.1.1.2" xref="S3.E1.m1.7.7.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.7.7.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.2.cmml"><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">tanh</mi><mo id="S3.E1.m1.7.7.1.1.1.1a" xref="S3.E1.m1.7.7.1.1.1.2.cmml">⁡</mo><mrow id="S3.E1.m1.7.7.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.7.7.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.2.cmml">(</mo><mrow id="S3.E1.m1.7.7.1.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.cmml"><msubsup id="S3.E1.m1.7.7.1.1.1.1.1.1.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.2.cmml">𝑾</mi><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.3.cmml">c</mi><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.2.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.3.cmml">s</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.7.7.1.1.1.1.1.1.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml">​</mo><msubsup id="S3.E1.m1.7.7.1.1.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.2.cmml">𝒒</mi><mrow id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo lspace="0.278em" rspace="0.278em" id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.1.cmml">:</mo><mrow id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.cmml"><mrow id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.cmml"><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.2" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.2.cmml">t</mi><mo id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.1.cmml">+</mo><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.3.cmml">s</mi></mrow><mo id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.1" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></mrow><mi id="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.3" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.3.cmml">w</mi></msubsup></mrow><mo stretchy="false" id="S3.E1.m1.7.7.1.1.1.1.1.3" xref="S3.E1.m1.7.7.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E1.m1.8.8.2.3" xref="S3.E1.m1.8.8.3a.cmml">,</mo><mrow id="S3.E1.m1.8.8.2.2" xref="S3.E1.m1.8.8.2.2.cmml"><mi id="S3.E1.m1.8.8.2.2.2" xref="S3.E1.m1.8.8.2.2.2.cmml">s</mi><mo id="S3.E1.m1.8.8.2.2.1" xref="S3.E1.m1.8.8.2.2.1.cmml">∈</mo><mrow id="S3.E1.m1.8.8.2.2.3.2" xref="S3.E1.m1.8.8.2.2.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.8.8.2.2.3.2.1" xref="S3.E1.m1.8.8.2.2.3.1.cmml">{</mo><mn id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">1</mn><mo id="S3.E1.m1.8.8.2.2.3.2.2" xref="S3.E1.m1.8.8.2.2.3.1.cmml">,</mo><mn id="S3.E1.m1.5.5" xref="S3.E1.m1.5.5.cmml">2</mn><mo id="S3.E1.m1.8.8.2.2.3.2.3" xref="S3.E1.m1.8.8.2.2.3.1.cmml">,</mo><mn id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml">3</mn><mo stretchy="false" id="S3.E1.m1.8.8.2.2.3.2.4" xref="S3.E1.m1.8.8.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.8b"><apply id="S3.E1.m1.8.8.3.cmml" xref="S3.E1.m1.8.8.2"><csymbol cd="ambiguous" id="S3.E1.m1.8.8.3a.cmml" xref="S3.E1.m1.8.8.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.7.7.1.1.cmml" xref="S3.E1.m1.7.7.1.1"><eq id="S3.E1.m1.7.7.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.2"></eq><apply id="S3.E1.m1.7.7.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.1.cmml" xref="S3.E1.m1.7.7.1.1.3">subscript</csymbol><apply id="S3.E1.m1.7.7.1.1.3.2.cmml" xref="S3.E1.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.3.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3">superscript</csymbol><apply id="S3.E1.m1.7.7.1.1.3.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.2.2"><ci id="S3.E1.m1.7.7.1.1.3.2.2.1.cmml" xref="S3.E1.m1.7.7.1.1.3.2.2.1">^</ci><ci id="S3.E1.m1.7.7.1.1.3.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.3.2.2.2">𝒒</ci></apply><ci id="S3.E1.m1.7.7.1.1.3.2.3.cmml" xref="S3.E1.m1.7.7.1.1.3.2.3">𝑝</ci></apply><list id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.4"><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑠</ci><ci id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E1.m1.7.7.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1"><tanh id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"></tanh><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1"><times id="S3.E1.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.1"></times><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.2">𝑾</ci><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.2.3">𝑐</ci></apply><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3">subscript</csymbol><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.2">𝒒</ci><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.2.3">𝑤</ci></apply><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3"><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.1">:</ci><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.2">𝑡</ci><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3"><minus id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.1"></minus><apply id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2"><plus id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.1.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.1"></plus><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.2.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.2">𝑡</ci><ci id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.2.3">𝑠</ci></apply><cn type="integer" id="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E1.m1.7.7.1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></apply></apply><apply id="S3.E1.m1.8.8.2.2.cmml" xref="S3.E1.m1.8.8.2.2"><in id="S3.E1.m1.8.8.2.2.1.cmml" xref="S3.E1.m1.8.8.2.2.1"></in><ci id="S3.E1.m1.8.8.2.2.2.cmml" xref="S3.E1.m1.8.8.2.2.2">𝑠</ci><set id="S3.E1.m1.8.8.2.2.3.1.cmml" xref="S3.E1.m1.8.8.2.2.3.2"><cn type="integer" id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">1</cn><cn type="integer" id="S3.E1.m1.5.5.cmml" xref="S3.E1.m1.5.5">2</cn><cn type="integer" id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6">3</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.8c">\hat{\bm{q}}^{p}_{s,t}=\tanh(\bm{W}_{c}^{s}\bm{q}^{w}_{t:t+s-1}),\quad s\in\{1,2,3\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.6" class="ltx_p">where <math id="S3.SS2.p1.5.m1.1" class="ltx_Math" alttext="\bm{W}_{c}^{s}" display="inline"><semantics id="S3.SS2.p1.5.m1.1a"><msubsup id="S3.SS2.p1.5.m1.1.1" xref="S3.SS2.p1.5.m1.1.1.cmml"><mi id="S3.SS2.p1.5.m1.1.1.2.2" xref="S3.SS2.p1.5.m1.1.1.2.2.cmml">𝑾</mi><mi id="S3.SS2.p1.5.m1.1.1.2.3" xref="S3.SS2.p1.5.m1.1.1.2.3.cmml">c</mi><mi id="S3.SS2.p1.5.m1.1.1.3" xref="S3.SS2.p1.5.m1.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m1.1b"><apply id="S3.SS2.p1.5.m1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.1.1.1.cmml" xref="S3.SS2.p1.5.m1.1.1">superscript</csymbol><apply id="S3.SS2.p1.5.m1.1.1.2.cmml" xref="S3.SS2.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m1.1.1.2.1.cmml" xref="S3.SS2.p1.5.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m1.1.1.2.2.cmml" xref="S3.SS2.p1.5.m1.1.1.2.2">𝑾</ci><ci id="S3.SS2.p1.5.m1.1.1.2.3.cmml" xref="S3.SS2.p1.5.m1.1.1.2.3">𝑐</ci></apply><ci id="S3.SS2.p1.5.m1.1.1.3.cmml" xref="S3.SS2.p1.5.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m1.1c">\bm{W}_{c}^{s}</annotation></semantics></math> is the weight parameters. The word-level features <math id="S3.SS2.p1.6.m2.1" class="ltx_Math" alttext="\bm{Q}^{w}" display="inline"><semantics id="S3.SS2.p1.6.m2.1a"><msup id="S3.SS2.p1.6.m2.1.1" xref="S3.SS2.p1.6.m2.1.1.cmml"><mi id="S3.SS2.p1.6.m2.1.1.2" xref="S3.SS2.p1.6.m2.1.1.2.cmml">𝑸</mi><mi id="S3.SS2.p1.6.m2.1.1.3" xref="S3.SS2.p1.6.m2.1.1.3.cmml">w</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m2.1b"><apply id="S3.SS2.p1.6.m2.1.1.cmml" xref="S3.SS2.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m2.1.1.1.cmml" xref="S3.SS2.p1.6.m2.1.1">superscript</csymbol><ci id="S3.SS2.p1.6.m2.1.1.2.cmml" xref="S3.SS2.p1.6.m2.1.1.2">𝑸</ci><ci id="S3.SS2.p1.6.m2.1.1.3.cmml" xref="S3.SS2.p1.6.m2.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m2.1c">\bm{Q}^{w}</annotation></semantics></math> are appropriately 0-padded before feeding into bigram and trigram convolutions to maintain the length of the sequence after convolution. Given the convolution result, we then apply max-pooling across different n-grams at each word location to obtain phrase-level features</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.13" class="ltx_Math" alttext="\bm{q}^{p}_{t}=\max(\hat{\bm{q}}^{p}_{1,t},\hat{\bm{q}}^{p}_{2,t},\hat{\bm{q}}^{p}_{3,t}),\quad t\in\{1,2,\ldots,T\}" display="block"><semantics id="S3.E2.m1.13a"><mrow id="S3.E2.m1.13.13.2" xref="S3.E2.m1.13.13.3.cmml"><mrow id="S3.E2.m1.12.12.1.1" xref="S3.E2.m1.12.12.1.1.cmml"><msubsup id="S3.E2.m1.12.12.1.1.5" xref="S3.E2.m1.12.12.1.1.5.cmml"><mi id="S3.E2.m1.12.12.1.1.5.2.2" xref="S3.E2.m1.12.12.1.1.5.2.2.cmml">𝒒</mi><mi id="S3.E2.m1.12.12.1.1.5.3" xref="S3.E2.m1.12.12.1.1.5.3.cmml">t</mi><mi id="S3.E2.m1.12.12.1.1.5.2.3" xref="S3.E2.m1.12.12.1.1.5.2.3.cmml">p</mi></msubsup><mo id="S3.E2.m1.12.12.1.1.4" xref="S3.E2.m1.12.12.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.12.12.1.1.3.3" xref="S3.E2.m1.12.12.1.1.3.4.cmml"><mi id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml">max</mi><mo id="S3.E2.m1.12.12.1.1.3.3a" xref="S3.E2.m1.12.12.1.1.3.4.cmml">⁡</mo><mrow id="S3.E2.m1.12.12.1.1.3.3.3" xref="S3.E2.m1.12.12.1.1.3.4.cmml"><mo stretchy="false" id="S3.E2.m1.12.12.1.1.3.3.3.4" xref="S3.E2.m1.12.12.1.1.3.4.cmml">(</mo><msubsup id="S3.E2.m1.12.12.1.1.1.1.1.1" xref="S3.E2.m1.12.12.1.1.1.1.1.1.cmml"><mover accent="true" id="S3.E2.m1.12.12.1.1.1.1.1.1.2.2" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E2.m1.12.12.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.2.2.cmml">𝒒</mi><mo id="S3.E2.m1.12.12.1.1.1.1.1.1.2.2.1" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mn id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">1</mn><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">t</mi></mrow><mi id="S3.E2.m1.12.12.1.1.1.1.1.1.2.3" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.3.cmml">p</mi></msubsup><mo id="S3.E2.m1.12.12.1.1.3.3.3.5" xref="S3.E2.m1.12.12.1.1.3.4.cmml">,</mo><msubsup id="S3.E2.m1.12.12.1.1.2.2.2.2" xref="S3.E2.m1.12.12.1.1.2.2.2.2.cmml"><mover accent="true" id="S3.E2.m1.12.12.1.1.2.2.2.2.2.2" xref="S3.E2.m1.12.12.1.1.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.12.12.1.1.2.2.2.2.2.2.2" xref="S3.E2.m1.12.12.1.1.2.2.2.2.2.2.2.cmml">𝒒</mi><mo id="S3.E2.m1.12.12.1.1.2.2.2.2.2.2.1" xref="S3.E2.m1.12.12.1.1.2.2.2.2.2.2.1.cmml">^</mo></mover><mrow id="S3.E2.m1.4.4.2.4" xref="S3.E2.m1.4.4.2.3.cmml"><mn id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">2</mn><mo id="S3.E2.m1.4.4.2.4.1" xref="S3.E2.m1.4.4.2.3.cmml">,</mo><mi id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml">t</mi></mrow><mi id="S3.E2.m1.12.12.1.1.2.2.2.2.2.3" xref="S3.E2.m1.12.12.1.1.2.2.2.2.2.3.cmml">p</mi></msubsup><mo id="S3.E2.m1.12.12.1.1.3.3.3.6" xref="S3.E2.m1.12.12.1.1.3.4.cmml">,</mo><msubsup id="S3.E2.m1.12.12.1.1.3.3.3.3" xref="S3.E2.m1.12.12.1.1.3.3.3.3.cmml"><mover accent="true" id="S3.E2.m1.12.12.1.1.3.3.3.3.2.2" xref="S3.E2.m1.12.12.1.1.3.3.3.3.2.2.cmml"><mi id="S3.E2.m1.12.12.1.1.3.3.3.3.2.2.2" xref="S3.E2.m1.12.12.1.1.3.3.3.3.2.2.2.cmml">𝒒</mi><mo id="S3.E2.m1.12.12.1.1.3.3.3.3.2.2.1" xref="S3.E2.m1.12.12.1.1.3.3.3.3.2.2.1.cmml">^</mo></mover><mrow id="S3.E2.m1.6.6.2.4" xref="S3.E2.m1.6.6.2.3.cmml"><mn id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml">3</mn><mo id="S3.E2.m1.6.6.2.4.1" xref="S3.E2.m1.6.6.2.3.cmml">,</mo><mi id="S3.E2.m1.6.6.2.2" xref="S3.E2.m1.6.6.2.2.cmml">t</mi></mrow><mi id="S3.E2.m1.12.12.1.1.3.3.3.3.2.3" xref="S3.E2.m1.12.12.1.1.3.3.3.3.2.3.cmml">p</mi></msubsup><mo stretchy="false" id="S3.E2.m1.12.12.1.1.3.3.3.7" xref="S3.E2.m1.12.12.1.1.3.4.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E2.m1.13.13.2.3" xref="S3.E2.m1.13.13.3a.cmml">,</mo><mrow id="S3.E2.m1.13.13.2.2" xref="S3.E2.m1.13.13.2.2.cmml"><mi id="S3.E2.m1.13.13.2.2.2" xref="S3.E2.m1.13.13.2.2.2.cmml">t</mi><mo id="S3.E2.m1.13.13.2.2.1" xref="S3.E2.m1.13.13.2.2.1.cmml">∈</mo><mrow id="S3.E2.m1.13.13.2.2.3.2" xref="S3.E2.m1.13.13.2.2.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.13.13.2.2.3.2.1" xref="S3.E2.m1.13.13.2.2.3.1.cmml">{</mo><mn id="S3.E2.m1.8.8" xref="S3.E2.m1.8.8.cmml">1</mn><mo id="S3.E2.m1.13.13.2.2.3.2.2" xref="S3.E2.m1.13.13.2.2.3.1.cmml">,</mo><mn id="S3.E2.m1.9.9" xref="S3.E2.m1.9.9.cmml">2</mn><mo id="S3.E2.m1.13.13.2.2.3.2.3" xref="S3.E2.m1.13.13.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.10.10" xref="S3.E2.m1.10.10.cmml">…</mi><mo id="S3.E2.m1.13.13.2.2.3.2.4" xref="S3.E2.m1.13.13.2.2.3.1.cmml">,</mo><mi id="S3.E2.m1.11.11" xref="S3.E2.m1.11.11.cmml">T</mi><mo stretchy="false" id="S3.E2.m1.13.13.2.2.3.2.5" xref="S3.E2.m1.13.13.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.13b"><apply id="S3.E2.m1.13.13.3.cmml" xref="S3.E2.m1.13.13.2"><csymbol cd="ambiguous" id="S3.E2.m1.13.13.3a.cmml" xref="S3.E2.m1.13.13.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.12.12.1.1.cmml" xref="S3.E2.m1.12.12.1.1"><eq id="S3.E2.m1.12.12.1.1.4.cmml" xref="S3.E2.m1.12.12.1.1.4"></eq><apply id="S3.E2.m1.12.12.1.1.5.cmml" xref="S3.E2.m1.12.12.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.5.1.cmml" xref="S3.E2.m1.12.12.1.1.5">subscript</csymbol><apply id="S3.E2.m1.12.12.1.1.5.2.cmml" xref="S3.E2.m1.12.12.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.5.2.1.cmml" xref="S3.E2.m1.12.12.1.1.5">superscript</csymbol><ci id="S3.E2.m1.12.12.1.1.5.2.2.cmml" xref="S3.E2.m1.12.12.1.1.5.2.2">𝒒</ci><ci id="S3.E2.m1.12.12.1.1.5.2.3.cmml" xref="S3.E2.m1.12.12.1.1.5.2.3">𝑝</ci></apply><ci id="S3.E2.m1.12.12.1.1.5.3.cmml" xref="S3.E2.m1.12.12.1.1.5.3">𝑡</ci></apply><apply id="S3.E2.m1.12.12.1.1.3.4.cmml" xref="S3.E2.m1.12.12.1.1.3.3"><max id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7"></max><apply id="S3.E2.m1.12.12.1.1.1.1.1.1.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.12.12.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.12.12.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.2"><ci id="S3.E2.m1.12.12.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.2.1">^</ci><ci id="S3.E2.m1.12.12.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.2.2">𝒒</ci></apply><ci id="S3.E2.m1.12.12.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.12.12.1.1.1.1.1.1.2.3">𝑝</ci></apply><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><cn type="integer" id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">1</cn><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑡</ci></list></apply><apply id="S3.E2.m1.12.12.1.1.2.2.2.2.cmml" xref="S3.E2.m1.12.12.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.12.12.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E2.m1.12.12.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.12.12.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.12.12.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.12.12.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.12.12.1.1.2.2.2.2.2.2"><ci id="S3.E2.m1.12.12.1.1.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.12.12.1.1.2.2.2.2.2.2.1">^</ci><ci id="S3.E2.m1.12.12.1.1.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.12.12.1.1.2.2.2.2.2.2.2">𝒒</ci></apply><ci id="S3.E2.m1.12.12.1.1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.12.12.1.1.2.2.2.2.2.3">𝑝</ci></apply><list id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.4"><cn type="integer" id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">2</cn><ci id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2">𝑡</ci></list></apply><apply id="S3.E2.m1.12.12.1.1.3.3.3.3.cmml" xref="S3.E2.m1.12.12.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.3.3.3.3.1.cmml" xref="S3.E2.m1.12.12.1.1.3.3.3.3">subscript</csymbol><apply id="S3.E2.m1.12.12.1.1.3.3.3.3.2.cmml" xref="S3.E2.m1.12.12.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.12.12.1.1.3.3.3.3.2.1.cmml" xref="S3.E2.m1.12.12.1.1.3.3.3.3">superscript</csymbol><apply id="S3.E2.m1.12.12.1.1.3.3.3.3.2.2.cmml" xref="S3.E2.m1.12.12.1.1.3.3.3.3.2.2"><ci id="S3.E2.m1.12.12.1.1.3.3.3.3.2.2.1.cmml" xref="S3.E2.m1.12.12.1.1.3.3.3.3.2.2.1">^</ci><ci id="S3.E2.m1.12.12.1.1.3.3.3.3.2.2.2.cmml" xref="S3.E2.m1.12.12.1.1.3.3.3.3.2.2.2">𝒒</ci></apply><ci id="S3.E2.m1.12.12.1.1.3.3.3.3.2.3.cmml" xref="S3.E2.m1.12.12.1.1.3.3.3.3.2.3">𝑝</ci></apply><list id="S3.E2.m1.6.6.2.3.cmml" xref="S3.E2.m1.6.6.2.4"><cn type="integer" id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1.1">3</cn><ci id="S3.E2.m1.6.6.2.2.cmml" xref="S3.E2.m1.6.6.2.2">𝑡</ci></list></apply></apply></apply><apply id="S3.E2.m1.13.13.2.2.cmml" xref="S3.E2.m1.13.13.2.2"><in id="S3.E2.m1.13.13.2.2.1.cmml" xref="S3.E2.m1.13.13.2.2.1"></in><ci id="S3.E2.m1.13.13.2.2.2.cmml" xref="S3.E2.m1.13.13.2.2.2">𝑡</ci><set id="S3.E2.m1.13.13.2.2.3.1.cmml" xref="S3.E2.m1.13.13.2.2.3.2"><cn type="integer" id="S3.E2.m1.8.8.cmml" xref="S3.E2.m1.8.8">1</cn><cn type="integer" id="S3.E2.m1.9.9.cmml" xref="S3.E2.m1.9.9">2</cn><ci id="S3.E2.m1.10.10.cmml" xref="S3.E2.m1.10.10">…</ci><ci id="S3.E2.m1.11.11.cmml" xref="S3.E2.m1.11.11">𝑇</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.13c">\bm{q}^{p}_{t}=\max(\hat{\bm{q}}^{p}_{1,t},\hat{\bm{q}}^{p}_{2,t},\hat{\bm{q}}^{p}_{3,t}),\quad t\in\{1,2,\ldots,T\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.3" class="ltx_p">Our pooling method differs from those used in previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> in that it adaptively selects different gram features at each time step, while preserving the original sequence length and order.
We use a LSTM to encode the sequence <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\bm{q}^{p}_{t}" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><msubsup id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2.2" xref="S3.SS2.p2.1.m1.1.1.2.2.cmml">𝒒</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">t</mi><mi id="S3.SS2.p2.1.m1.1.1.2.3" xref="S3.SS2.p2.1.m1.1.1.2.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><apply id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2.2">𝒒</ci><ci id="S3.SS2.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.p2.1.m1.1.1.2.3">𝑝</ci></apply><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\bm{q}^{p}_{t}</annotation></semantics></math> after max-pooling. The corresponding question-level feature <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="\bm{q}^{s}_{t}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><msubsup id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">𝒒</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">t</mi><mi id="S3.SS2.p2.2.m2.1.1.2.3" xref="S3.SS2.p2.2.m2.1.1.2.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">𝒒</ci><ci id="S3.SS2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.1.1.2.3">𝑠</ci></apply><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">\bm{q}^{s}_{t}</annotation></semantics></math> is the LSTM hidden vector at time <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">t</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para ltx_noindent">
<p id="S3.SS2.p3.1" class="ltx_p">Our hierarchical representation of the question is depicted in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.4 Encoding for Predicting Answers ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(a).</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Co-Attention</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">We propose two co-attention mechanisms that differ in the order in which image and question attention maps are generated. The first mechanism, which we call parallel co-attention, generates image and question attention simultaneously. The second mechanism, which we call alternating co-attention, sequentially alternates between generating image and question attentions. See Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.3 Co-Attention ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. These co-attention mechanisms are executed at all three levels of the question hierarchy.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/1606.00061/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="401" height="160" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>(a) Parallel co-attention mechanism; (b) Alternating co-attention mechanism.</figcaption>
</figure>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.3" class="ltx_p"><span id="S3.SS3.p2.3.1" class="ltx_text ltx_font_bold">Parallel Co-Attention</span>. Parallel co-attention attends to the image and question simultaneously. Similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, we connect the image and question by calculating the similarity between image and question features at all pairs of image-locations and question-locations. Specifically, given an image feature map <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\bm{{V}}\in\mathcal{R}^{d\times N}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">𝑽</mi><mo id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.1.3.2" xref="S3.SS3.p2.1.m1.1.1.3.2.cmml">ℛ</mi><mrow id="S3.SS3.p2.1.m1.1.1.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.cmml"><mi id="S3.SS3.p2.1.m1.1.1.3.3.2" xref="S3.SS3.p2.1.m1.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.1.m1.1.1.3.3.1" xref="S3.SS3.p2.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p2.1.m1.1.1.3.3.3" xref="S3.SS3.p2.1.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><in id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"></in><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝑽</ci><apply id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.2">ℛ</ci><apply id="S3.SS3.p2.1.m1.1.1.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3"><times id="S3.SS3.p2.1.m1.1.1.3.3.1.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3.1"></times><ci id="S3.SS3.p2.1.m1.1.1.3.3.2.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS3.p2.1.m1.1.1.3.3.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\bm{{V}}\in\mathcal{R}^{d\times N}</annotation></semantics></math>, and the question representation <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\bm{{Q}}\in\mathcal{R}^{d\times T}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">𝑸</mi><mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.3.2.cmml">ℛ</mi><mrow id="S3.SS3.p2.2.m2.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.3.3.2" xref="S3.SS3.p2.2.m2.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.2.m2.1.1.3.3.1" xref="S3.SS3.p2.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p2.2.m2.1.1.3.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.3.cmml">T</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><in id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"></in><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝑸</ci><apply id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.2">ℛ</ci><apply id="S3.SS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3"><times id="S3.SS3.p2.2.m2.1.1.3.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3.1"></times><ci id="S3.SS3.p2.2.m2.1.1.3.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3.2">𝑑</ci><ci id="S3.SS3.p2.2.m2.1.1.3.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\bm{{Q}}\in\mathcal{R}^{d\times T}</annotation></semantics></math>, the affinity matrix <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\bm{C}\in\mathcal{R}^{T\times N}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">𝑪</mi><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">ℛ</mi><mrow id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.3.2" xref="S3.SS3.p2.3.m3.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.3.m3.1.1.3.3.1" xref="S3.SS3.p2.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p2.3.m3.1.1.3.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><in id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></in><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑪</ci><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">ℛ</ci><apply id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3"><times id="S3.SS3.p2.3.m3.1.1.3.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.1"></times><ci id="S3.SS3.p2.3.m3.1.1.3.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.2">𝑇</ci><ci id="S3.SS3.p2.3.m3.1.1.3.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\bm{C}\in\mathcal{R}^{T\times N}</annotation></semantics></math> is calculated by</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\bm{C}=\tanh(\bm{Q}^{T}\bm{W}_{b}\bm{V})" display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><mi id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml">𝑪</mi><mo id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.2.cmml"><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">tanh</mi><mo id="S3.E3.m1.2.2.1.1a" xref="S3.E3.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.2.cmml">(</mo><mrow id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><msup id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2.2" xref="S3.E3.m1.2.2.1.1.1.1.2.2.cmml">𝑸</mi><mi id="S3.E3.m1.2.2.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.2.3.cmml">T</mi></msup><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">​</mo><msub id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S3.E3.m1.2.2.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.3.3.cmml">b</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.1.1.1a" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">​</mo><mi id="S3.E3.m1.2.2.1.1.1.1.4" xref="S3.E3.m1.2.2.1.1.1.1.4.cmml">𝑽</mi></mrow><mo stretchy="false" id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><eq id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"></eq><ci id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3">𝑪</ci><apply id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1.1"><tanh id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"></tanh><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><times id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"></times><apply id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">superscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.2">𝑸</ci><ci id="S3.E3.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2.3">𝑇</ci></apply><apply id="S3.E3.m1.2.2.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.2">𝑾</ci><ci id="S3.E3.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.3.3">𝑏</ci></apply><ci id="S3.E3.m1.2.2.1.1.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.1.1.4">𝑽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\bm{C}=\tanh(\bm{Q}^{T}\bm{W}_{b}\bm{V})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.6" class="ltx_p">where <math id="S3.SS3.p2.4.m1.1" class="ltx_Math" alttext="\bm{W}_{b}\in\mathcal{R}^{d\times d}" display="inline"><semantics id="S3.SS3.p2.4.m1.1a"><mrow id="S3.SS3.p2.4.m1.1.1" xref="S3.SS3.p2.4.m1.1.1.cmml"><msub id="S3.SS3.p2.4.m1.1.1.2" xref="S3.SS3.p2.4.m1.1.1.2.cmml"><mi id="S3.SS3.p2.4.m1.1.1.2.2" xref="S3.SS3.p2.4.m1.1.1.2.2.cmml">𝑾</mi><mi id="S3.SS3.p2.4.m1.1.1.2.3" xref="S3.SS3.p2.4.m1.1.1.2.3.cmml">b</mi></msub><mo id="S3.SS3.p2.4.m1.1.1.1" xref="S3.SS3.p2.4.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.p2.4.m1.1.1.3" xref="S3.SS3.p2.4.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.4.m1.1.1.3.2" xref="S3.SS3.p2.4.m1.1.1.3.2.cmml">ℛ</mi><mrow id="S3.SS3.p2.4.m1.1.1.3.3" xref="S3.SS3.p2.4.m1.1.1.3.3.cmml"><mi id="S3.SS3.p2.4.m1.1.1.3.3.2" xref="S3.SS3.p2.4.m1.1.1.3.3.2.cmml">d</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p2.4.m1.1.1.3.3.1" xref="S3.SS3.p2.4.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS3.p2.4.m1.1.1.3.3.3" xref="S3.SS3.p2.4.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m1.1b"><apply id="S3.SS3.p2.4.m1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1"><in id="S3.SS3.p2.4.m1.1.1.1.cmml" xref="S3.SS3.p2.4.m1.1.1.1"></in><apply id="S3.SS3.p2.4.m1.1.1.2.cmml" xref="S3.SS3.p2.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.1.1.2.1.cmml" xref="S3.SS3.p2.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.4.m1.1.1.2.2.cmml" xref="S3.SS3.p2.4.m1.1.1.2.2">𝑾</ci><ci id="S3.SS3.p2.4.m1.1.1.2.3.cmml" xref="S3.SS3.p2.4.m1.1.1.2.3">𝑏</ci></apply><apply id="S3.SS3.p2.4.m1.1.1.3.cmml" xref="S3.SS3.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m1.1.1.3.1.cmml" xref="S3.SS3.p2.4.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.4.m1.1.1.3.2.cmml" xref="S3.SS3.p2.4.m1.1.1.3.2">ℛ</ci><apply id="S3.SS3.p2.4.m1.1.1.3.3.cmml" xref="S3.SS3.p2.4.m1.1.1.3.3"><times id="S3.SS3.p2.4.m1.1.1.3.3.1.cmml" xref="S3.SS3.p2.4.m1.1.1.3.3.1"></times><ci id="S3.SS3.p2.4.m1.1.1.3.3.2.cmml" xref="S3.SS3.p2.4.m1.1.1.3.3.2">𝑑</ci><ci id="S3.SS3.p2.4.m1.1.1.3.3.3.cmml" xref="S3.SS3.p2.4.m1.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m1.1c">\bm{W}_{b}\in\mathcal{R}^{d\times d}</annotation></semantics></math> contains the weights. After computing this affinity matrix, one possible way of computing the image (or question) attention is to simply maximize out the affinity over the locations of other modality, <em id="S3.SS3.p2.6.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.SS3.p2.6.2" class="ltx_text"></span> <math id="S3.SS3.p2.5.m2.5" class="ltx_Math" alttext="\bm{a}^{v}[n]=\max_{i}(\bm{C}_{i,n})" display="inline"><semantics id="S3.SS3.p2.5.m2.5a"><mrow id="S3.SS3.p2.5.m2.5.5" xref="S3.SS3.p2.5.m2.5.5.cmml"><mrow id="S3.SS3.p2.5.m2.5.5.4" xref="S3.SS3.p2.5.m2.5.5.4.cmml"><msup id="S3.SS3.p2.5.m2.5.5.4.2" xref="S3.SS3.p2.5.m2.5.5.4.2.cmml"><mi id="S3.SS3.p2.5.m2.5.5.4.2.2" xref="S3.SS3.p2.5.m2.5.5.4.2.2.cmml">𝒂</mi><mi id="S3.SS3.p2.5.m2.5.5.4.2.3" xref="S3.SS3.p2.5.m2.5.5.4.2.3.cmml">v</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p2.5.m2.5.5.4.1" xref="S3.SS3.p2.5.m2.5.5.4.1.cmml">​</mo><mrow id="S3.SS3.p2.5.m2.5.5.4.3.2" xref="S3.SS3.p2.5.m2.5.5.4.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.5.m2.5.5.4.3.2.1" xref="S3.SS3.p2.5.m2.5.5.4.3.1.1.cmml">[</mo><mi id="S3.SS3.p2.5.m2.3.3" xref="S3.SS3.p2.5.m2.3.3.cmml">n</mi><mo stretchy="false" id="S3.SS3.p2.5.m2.5.5.4.3.2.2" xref="S3.SS3.p2.5.m2.5.5.4.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.SS3.p2.5.m2.5.5.3" xref="S3.SS3.p2.5.m2.5.5.3.cmml">=</mo><mrow id="S3.SS3.p2.5.m2.5.5.2.2" xref="S3.SS3.p2.5.m2.5.5.2.3.cmml"><msub id="S3.SS3.p2.5.m2.4.4.1.1.1" xref="S3.SS3.p2.5.m2.4.4.1.1.1.cmml"><mi id="S3.SS3.p2.5.m2.4.4.1.1.1.2" xref="S3.SS3.p2.5.m2.4.4.1.1.1.2.cmml">max</mi><mi id="S3.SS3.p2.5.m2.4.4.1.1.1.3" xref="S3.SS3.p2.5.m2.4.4.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p2.5.m2.5.5.2.2a" xref="S3.SS3.p2.5.m2.5.5.2.3.cmml">⁡</mo><mrow id="S3.SS3.p2.5.m2.5.5.2.2.2" xref="S3.SS3.p2.5.m2.5.5.2.3.cmml"><mo stretchy="false" id="S3.SS3.p2.5.m2.5.5.2.2.2.2" xref="S3.SS3.p2.5.m2.5.5.2.3.cmml">(</mo><msub id="S3.SS3.p2.5.m2.5.5.2.2.2.1" xref="S3.SS3.p2.5.m2.5.5.2.2.2.1.cmml"><mi id="S3.SS3.p2.5.m2.5.5.2.2.2.1.2" xref="S3.SS3.p2.5.m2.5.5.2.2.2.1.2.cmml">𝑪</mi><mrow id="S3.SS3.p2.5.m2.2.2.2.4" xref="S3.SS3.p2.5.m2.2.2.2.3.cmml"><mi id="S3.SS3.p2.5.m2.1.1.1.1" xref="S3.SS3.p2.5.m2.1.1.1.1.cmml">i</mi><mo id="S3.SS3.p2.5.m2.2.2.2.4.1" xref="S3.SS3.p2.5.m2.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.5.m2.2.2.2.2" xref="S3.SS3.p2.5.m2.2.2.2.2.cmml">n</mi></mrow></msub><mo stretchy="false" id="S3.SS3.p2.5.m2.5.5.2.2.2.3" xref="S3.SS3.p2.5.m2.5.5.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m2.5b"><apply id="S3.SS3.p2.5.m2.5.5.cmml" xref="S3.SS3.p2.5.m2.5.5"><eq id="S3.SS3.p2.5.m2.5.5.3.cmml" xref="S3.SS3.p2.5.m2.5.5.3"></eq><apply id="S3.SS3.p2.5.m2.5.5.4.cmml" xref="S3.SS3.p2.5.m2.5.5.4"><times id="S3.SS3.p2.5.m2.5.5.4.1.cmml" xref="S3.SS3.p2.5.m2.5.5.4.1"></times><apply id="S3.SS3.p2.5.m2.5.5.4.2.cmml" xref="S3.SS3.p2.5.m2.5.5.4.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.5.5.4.2.1.cmml" xref="S3.SS3.p2.5.m2.5.5.4.2">superscript</csymbol><ci id="S3.SS3.p2.5.m2.5.5.4.2.2.cmml" xref="S3.SS3.p2.5.m2.5.5.4.2.2">𝒂</ci><ci id="S3.SS3.p2.5.m2.5.5.4.2.3.cmml" xref="S3.SS3.p2.5.m2.5.5.4.2.3">𝑣</ci></apply><apply id="S3.SS3.p2.5.m2.5.5.4.3.1.cmml" xref="S3.SS3.p2.5.m2.5.5.4.3.2"><csymbol cd="latexml" id="S3.SS3.p2.5.m2.5.5.4.3.1.1.cmml" xref="S3.SS3.p2.5.m2.5.5.4.3.2.1">delimited-[]</csymbol><ci id="S3.SS3.p2.5.m2.3.3.cmml" xref="S3.SS3.p2.5.m2.3.3">𝑛</ci></apply></apply><apply id="S3.SS3.p2.5.m2.5.5.2.3.cmml" xref="S3.SS3.p2.5.m2.5.5.2.2"><apply id="S3.SS3.p2.5.m2.4.4.1.1.1.cmml" xref="S3.SS3.p2.5.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.4.4.1.1.1.1.cmml" xref="S3.SS3.p2.5.m2.4.4.1.1.1">subscript</csymbol><max id="S3.SS3.p2.5.m2.4.4.1.1.1.2.cmml" xref="S3.SS3.p2.5.m2.4.4.1.1.1.2"></max><ci id="S3.SS3.p2.5.m2.4.4.1.1.1.3.cmml" xref="S3.SS3.p2.5.m2.4.4.1.1.1.3">𝑖</ci></apply><apply id="S3.SS3.p2.5.m2.5.5.2.2.2.1.cmml" xref="S3.SS3.p2.5.m2.5.5.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m2.5.5.2.2.2.1.1.cmml" xref="S3.SS3.p2.5.m2.5.5.2.2.2.1">subscript</csymbol><ci id="S3.SS3.p2.5.m2.5.5.2.2.2.1.2.cmml" xref="S3.SS3.p2.5.m2.5.5.2.2.2.1.2">𝑪</ci><list id="S3.SS3.p2.5.m2.2.2.2.3.cmml" xref="S3.SS3.p2.5.m2.2.2.2.4"><ci id="S3.SS3.p2.5.m2.1.1.1.1.cmml" xref="S3.SS3.p2.5.m2.1.1.1.1">𝑖</ci><ci id="S3.SS3.p2.5.m2.2.2.2.2.cmml" xref="S3.SS3.p2.5.m2.2.2.2.2">𝑛</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m2.5c">\bm{a}^{v}[n]=\max_{i}(\bm{C}_{i,n})</annotation></semantics></math> and <math id="S3.SS3.p2.6.m3.5" class="ltx_Math" alttext="\bm{a}^{q}[t]=\max_{j}(\bm{C}_{t,j})" display="inline"><semantics id="S3.SS3.p2.6.m3.5a"><mrow id="S3.SS3.p2.6.m3.5.5" xref="S3.SS3.p2.6.m3.5.5.cmml"><mrow id="S3.SS3.p2.6.m3.5.5.4" xref="S3.SS3.p2.6.m3.5.5.4.cmml"><msup id="S3.SS3.p2.6.m3.5.5.4.2" xref="S3.SS3.p2.6.m3.5.5.4.2.cmml"><mi id="S3.SS3.p2.6.m3.5.5.4.2.2" xref="S3.SS3.p2.6.m3.5.5.4.2.2.cmml">𝒂</mi><mi id="S3.SS3.p2.6.m3.5.5.4.2.3" xref="S3.SS3.p2.6.m3.5.5.4.2.3.cmml">q</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m3.5.5.4.1" xref="S3.SS3.p2.6.m3.5.5.4.1.cmml">​</mo><mrow id="S3.SS3.p2.6.m3.5.5.4.3.2" xref="S3.SS3.p2.6.m3.5.5.4.3.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m3.5.5.4.3.2.1" xref="S3.SS3.p2.6.m3.5.5.4.3.1.1.cmml">[</mo><mi id="S3.SS3.p2.6.m3.3.3" xref="S3.SS3.p2.6.m3.3.3.cmml">t</mi><mo stretchy="false" id="S3.SS3.p2.6.m3.5.5.4.3.2.2" xref="S3.SS3.p2.6.m3.5.5.4.3.1.1.cmml">]</mo></mrow></mrow><mo id="S3.SS3.p2.6.m3.5.5.3" xref="S3.SS3.p2.6.m3.5.5.3.cmml">=</mo><mrow id="S3.SS3.p2.6.m3.5.5.2.2" xref="S3.SS3.p2.6.m3.5.5.2.3.cmml"><msub id="S3.SS3.p2.6.m3.4.4.1.1.1" xref="S3.SS3.p2.6.m3.4.4.1.1.1.cmml"><mi id="S3.SS3.p2.6.m3.4.4.1.1.1.2" xref="S3.SS3.p2.6.m3.4.4.1.1.1.2.cmml">max</mi><mi id="S3.SS3.p2.6.m3.4.4.1.1.1.3" xref="S3.SS3.p2.6.m3.4.4.1.1.1.3.cmml">j</mi></msub><mo id="S3.SS3.p2.6.m3.5.5.2.2a" xref="S3.SS3.p2.6.m3.5.5.2.3.cmml">⁡</mo><mrow id="S3.SS3.p2.6.m3.5.5.2.2.2" xref="S3.SS3.p2.6.m3.5.5.2.3.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m3.5.5.2.2.2.2" xref="S3.SS3.p2.6.m3.5.5.2.3.cmml">(</mo><msub id="S3.SS3.p2.6.m3.5.5.2.2.2.1" xref="S3.SS3.p2.6.m3.5.5.2.2.2.1.cmml"><mi id="S3.SS3.p2.6.m3.5.5.2.2.2.1.2" xref="S3.SS3.p2.6.m3.5.5.2.2.2.1.2.cmml">𝑪</mi><mrow id="S3.SS3.p2.6.m3.2.2.2.4" xref="S3.SS3.p2.6.m3.2.2.2.3.cmml"><mi id="S3.SS3.p2.6.m3.1.1.1.1" xref="S3.SS3.p2.6.m3.1.1.1.1.cmml">t</mi><mo id="S3.SS3.p2.6.m3.2.2.2.4.1" xref="S3.SS3.p2.6.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.6.m3.2.2.2.2" xref="S3.SS3.p2.6.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS3.p2.6.m3.5.5.2.2.2.3" xref="S3.SS3.p2.6.m3.5.5.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m3.5b"><apply id="S3.SS3.p2.6.m3.5.5.cmml" xref="S3.SS3.p2.6.m3.5.5"><eq id="S3.SS3.p2.6.m3.5.5.3.cmml" xref="S3.SS3.p2.6.m3.5.5.3"></eq><apply id="S3.SS3.p2.6.m3.5.5.4.cmml" xref="S3.SS3.p2.6.m3.5.5.4"><times id="S3.SS3.p2.6.m3.5.5.4.1.cmml" xref="S3.SS3.p2.6.m3.5.5.4.1"></times><apply id="S3.SS3.p2.6.m3.5.5.4.2.cmml" xref="S3.SS3.p2.6.m3.5.5.4.2"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m3.5.5.4.2.1.cmml" xref="S3.SS3.p2.6.m3.5.5.4.2">superscript</csymbol><ci id="S3.SS3.p2.6.m3.5.5.4.2.2.cmml" xref="S3.SS3.p2.6.m3.5.5.4.2.2">𝒂</ci><ci id="S3.SS3.p2.6.m3.5.5.4.2.3.cmml" xref="S3.SS3.p2.6.m3.5.5.4.2.3">𝑞</ci></apply><apply id="S3.SS3.p2.6.m3.5.5.4.3.1.cmml" xref="S3.SS3.p2.6.m3.5.5.4.3.2"><csymbol cd="latexml" id="S3.SS3.p2.6.m3.5.5.4.3.1.1.cmml" xref="S3.SS3.p2.6.m3.5.5.4.3.2.1">delimited-[]</csymbol><ci id="S3.SS3.p2.6.m3.3.3.cmml" xref="S3.SS3.p2.6.m3.3.3">𝑡</ci></apply></apply><apply id="S3.SS3.p2.6.m3.5.5.2.3.cmml" xref="S3.SS3.p2.6.m3.5.5.2.2"><apply id="S3.SS3.p2.6.m3.4.4.1.1.1.cmml" xref="S3.SS3.p2.6.m3.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m3.4.4.1.1.1.1.cmml" xref="S3.SS3.p2.6.m3.4.4.1.1.1">subscript</csymbol><max id="S3.SS3.p2.6.m3.4.4.1.1.1.2.cmml" xref="S3.SS3.p2.6.m3.4.4.1.1.1.2"></max><ci id="S3.SS3.p2.6.m3.4.4.1.1.1.3.cmml" xref="S3.SS3.p2.6.m3.4.4.1.1.1.3">𝑗</ci></apply><apply id="S3.SS3.p2.6.m3.5.5.2.2.2.1.cmml" xref="S3.SS3.p2.6.m3.5.5.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m3.5.5.2.2.2.1.1.cmml" xref="S3.SS3.p2.6.m3.5.5.2.2.2.1">subscript</csymbol><ci id="S3.SS3.p2.6.m3.5.5.2.2.2.1.2.cmml" xref="S3.SS3.p2.6.m3.5.5.2.2.2.1.2">𝑪</ci><list id="S3.SS3.p2.6.m3.2.2.2.3.cmml" xref="S3.SS3.p2.6.m3.2.2.2.4"><ci id="S3.SS3.p2.6.m3.1.1.1.1.cmml" xref="S3.SS3.p2.6.m3.1.1.1.1">𝑡</ci><ci id="S3.SS3.p2.6.m3.2.2.2.2.cmml" xref="S3.SS3.p2.6.m3.2.2.2.2">𝑗</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m3.5c">\bm{a}^{q}[t]=\max_{j}(\bm{C}_{t,j})</annotation></semantics></math>.
Instead of choosing the max activation, we find that performance is improved if we consider this affinity matrix as a feature and learn to predict image and question attention maps via the following</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<table id="S3.E4" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E4X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\bm{H}^{v}=\tanh(\bm{W}_{v}\bm{V}+(\bm{W}_{q}\bm{Q})\bm{C})," display="inline"><semantics id="S3.E4X.2.1.1.m1.2a"><mrow id="S3.E4X.2.1.1.m1.2.2.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.cmml"><mrow id="S3.E4X.2.1.1.m1.2.2.1.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.cmml"><msup id="S3.E4X.2.1.1.m1.2.2.1.1.3" xref="S3.E4X.2.1.1.m1.2.2.1.1.3.cmml"><mi id="S3.E4X.2.1.1.m1.2.2.1.1.3.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.3.2.cmml">𝑯</mi><mi id="S3.E4X.2.1.1.m1.2.2.1.1.3.3" xref="S3.E4X.2.1.1.m1.2.2.1.1.3.3.cmml">v</mi></msup><mo id="S3.E4X.2.1.1.m1.2.2.1.1.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E4X.2.1.1.m1.2.2.1.1.1.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.2.cmml"><mi id="S3.E4X.2.1.1.m1.1.1" xref="S3.E4X.2.1.1.m1.1.1.cmml">tanh</mi><mo id="S3.E4X.2.1.1.m1.2.2.1.1.1.1a" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.2.cmml">(</mo><mrow id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml"><msub id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.2.cmml">𝑾</mi><mi id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml">𝑽</mi></mrow><mo id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝑾</mi><mi id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">𝑸</mi></mrow><mo stretchy="false" id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml">𝑪</mi></mrow></mrow><mo stretchy="false" id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.3" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4X.2.1.1.m1.2.2.1.2" xref="S3.E4X.2.1.1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.2.1.1.m1.2b"><apply id="S3.E4X.2.1.1.m1.2.2.1.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.1"><eq id="S3.E4X.2.1.1.m1.2.2.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.2"></eq><apply id="S3.E4X.2.1.1.m1.2.2.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.2.2.1.1.3.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.3">superscript</csymbol><ci id="S3.E4X.2.1.1.m1.2.2.1.1.3.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.3.2">𝑯</ci><ci id="S3.E4X.2.1.1.m1.2.2.1.1.3.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.3.3">𝑣</ci></apply><apply id="S3.E4X.2.1.1.m1.2.2.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1"><tanh id="S3.E4X.2.1.1.m1.1.1.cmml" xref="S3.E4X.2.1.1.m1.1.1"></tanh><apply id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1"><plus id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.2"></plus><apply id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3"><times id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.1"></times><apply id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.2">𝑾</ci><ci id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.2.3">𝑣</ci></apply><ci id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.3.3">𝑽</ci></apply><apply id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1"><times id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.2"></times><apply id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1"><times id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.2">𝑾</ci><ci id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.3">𝑞</ci></apply><ci id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑸</ci></apply><ci id="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.2.1.1.m1.2.2.1.1.1.1.1.1.1.3">𝑪</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.2.1.1.m1.2c">\displaystyle\bm{H}^{v}=\tanh(\bm{W}_{v}\bm{V}+(\bm{W}_{q}\bm{Q})\bm{C}),</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle\quad\bm{H}^{q}=\tanh(\bm{W}_{q}\bm{Q}+(\bm{W}_{v}\bm{V})\bm{C}^{T})" display="inline"><semantics id="S3.E4X.3.2.2.m1.2a"><mrow id="S3.E4X.3.2.2.m1.2.2" xref="S3.E4X.3.2.2.m1.2.2.cmml"><msup id="S3.E4X.3.2.2.m1.2.2.3" xref="S3.E4X.3.2.2.m1.2.2.3.cmml"><mi id="S3.E4X.3.2.2.m1.2.2.3.2" xref="S3.E4X.3.2.2.m1.2.2.3.2.cmml">𝑯</mi><mi id="S3.E4X.3.2.2.m1.2.2.3.3" xref="S3.E4X.3.2.2.m1.2.2.3.3.cmml">q</mi></msup><mo id="S3.E4X.3.2.2.m1.2.2.2" xref="S3.E4X.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="S3.E4X.3.2.2.m1.2.2.1.1" xref="S3.E4X.3.2.2.m1.2.2.1.2.cmml"><mi id="S3.E4X.3.2.2.m1.1.1" xref="S3.E4X.3.2.2.m1.1.1.cmml">tanh</mi><mo id="S3.E4X.3.2.2.m1.2.2.1.1a" xref="S3.E4X.3.2.2.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.E4X.3.2.2.m1.2.2.1.1.1" xref="S3.E4X.3.2.2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E4X.3.2.2.m1.2.2.1.1.1.2" xref="S3.E4X.3.2.2.m1.2.2.1.2.cmml">(</mo><mrow id="S3.E4X.3.2.2.m1.2.2.1.1.1.1" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.cmml"><msub id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.2.cmml">𝑾</mi><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.3.cmml">q</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.1" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.3.cmml">𝑸</mi></mrow><mo id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.cmml">+</mo><mrow id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝑾</mi><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">v</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">𝑽</mi></mrow><mo stretchy="false" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml">​</mo><msup id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.2" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.2.cmml">𝑪</mi><mi id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.3" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.3.cmml">T</mi></msup></mrow></mrow><mo stretchy="false" id="S3.E4X.3.2.2.m1.2.2.1.1.1.3" xref="S3.E4X.3.2.2.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4X.3.2.2.m1.2b"><apply id="S3.E4X.3.2.2.m1.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.2"><eq id="S3.E4X.3.2.2.m1.2.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.2"></eq><apply id="S3.E4X.3.2.2.m1.2.2.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.2.3.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.3">superscript</csymbol><ci id="S3.E4X.3.2.2.m1.2.2.3.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.3.2">𝑯</ci><ci id="S3.E4X.3.2.2.m1.2.2.3.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.3.3">𝑞</ci></apply><apply id="S3.E4X.3.2.2.m1.2.2.1.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1"><tanh id="S3.E4X.3.2.2.m1.1.1.cmml" xref="S3.E4X.3.2.2.m1.1.1"></tanh><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1"><plus id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.2"></plus><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3"><times id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.1"></times><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.2">𝑾</ci><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.2.3">𝑞</ci></apply><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.3.3">𝑸</ci></apply><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1"><times id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.2"></times><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1"><times id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑾</ci><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑣</ci></apply><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">𝑽</ci></apply><apply id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.2">𝑪</ci><ci id="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E4X.3.2.2.m1.2.2.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4X.3.2.2.m1.2c">\displaystyle\quad\bm{H}^{q}=\tanh(\bm{W}_{q}\bm{Q}+(\bm{W}_{v}\bm{V})\bm{C}^{T})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr id="S3.E4Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E4Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{a}^{v}=\textrm{softmax}(\bm{w}_{hv}^{T}\bm{H}^{v})," display="inline"><semantics id="S3.E4Xa.2.1.1.m1.1a"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml"><msup id="S3.E4Xa.2.1.1.m1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.3.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3.2.cmml">𝒂</mi><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.3.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3.3.cmml">v</mi></msup><mo id="S3.E4Xa.2.1.1.m1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.cmml"><mtext id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒘</mi><mrow id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">v</mi></mrow><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝑯</mi><mi id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">v</mi></msup></mrow><mo stretchy="false" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.3" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4Xa.2.1.1.m1.1.1.1.2" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4Xa.2.1.1.m1.1b"><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1"><eq id="S3.E4Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.2"></eq><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3.2">𝒂</ci><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.3.3">𝑣</ci></apply><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1"><times id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.2"></times><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3a.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3"><mtext id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.3">softmax</mtext></ci><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1"><times id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.2">𝒘</ci><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3"><times id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.2">ℎ</ci><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.2.3.3">𝑣</ci></apply></apply><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.2">𝑯</ci><ci id="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.3">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4Xa.2.1.1.m1.1c">\displaystyle\bm{a}^{v}=\textrm{softmax}(\bm{w}_{hv}^{T}\bm{H}^{v}),</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E4Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle\quad\bm{a}^{q}=\textrm{softmax}(\bm{w}_{hq}^{T}\bm{H}^{q})" display="inline"><semantics id="S3.E4Xa.3.2.2.m1.1a"><mrow id="S3.E4Xa.3.2.2.m1.1.1" xref="S3.E4Xa.3.2.2.m1.1.1.cmml"><msup id="S3.E4Xa.3.2.2.m1.1.1.3" xref="S3.E4Xa.3.2.2.m1.1.1.3.cmml"><mi id="S3.E4Xa.3.2.2.m1.1.1.3.2" xref="S3.E4Xa.3.2.2.m1.1.1.3.2.cmml">𝒂</mi><mi id="S3.E4Xa.3.2.2.m1.1.1.3.3" xref="S3.E4Xa.3.2.2.m1.1.1.3.3.cmml">q</mi></msup><mo id="S3.E4Xa.3.2.2.m1.1.1.2" xref="S3.E4Xa.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E4Xa.3.2.2.m1.1.1.1" xref="S3.E4Xa.3.2.2.m1.1.1.1.cmml"><mtext id="S3.E4Xa.3.2.2.m1.1.1.1.3" xref="S3.E4Xa.3.2.2.m1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E4Xa.3.2.2.m1.1.1.1.2" xref="S3.E4Xa.3.2.2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E4Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.2" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml">𝒘</mi><mrow id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.3.cmml">q</mi></mrow><mi id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.3" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">𝑯</mi><mi id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">q</mi></msup></mrow><mo stretchy="false" id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4Xa.3.2.2.m1.1b"><apply id="S3.E4Xa.3.2.2.m1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1"><eq id="S3.E4Xa.3.2.2.m1.1.1.2.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.2"></eq><apply id="S3.E4Xa.3.2.2.m1.1.1.3.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.1.1.3.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.3">superscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.1.1.3.2.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.3.2">𝒂</ci><ci id="S3.E4Xa.3.2.2.m1.1.1.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.3.3">𝑞</ci></apply><apply id="S3.E4Xa.3.2.2.m1.1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1"><times id="S3.E4Xa.3.2.2.m1.1.1.1.2.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.2"></times><ci id="S3.E4Xa.3.2.2.m1.1.1.1.3a.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.3"><mtext id="S3.E4Xa.3.2.2.m1.1.1.1.3.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.3">softmax</mtext></ci><apply id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1"><times id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.1"></times><apply id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2">𝒘</ci><apply id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3"><times id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.2">ℎ</ci><ci id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.3">𝑞</ci></apply></apply><ci id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.2">𝑯</ci><ci id="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E4Xa.3.2.2.m1.1.1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4Xa.3.2.2.m1.1c">\displaystyle\quad\bm{a}^{q}=\textrm{softmax}(\bm{w}_{hq}^{T}\bm{H}^{q})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.p3.8" class="ltx_p">where <math id="S3.SS3.p3.1.m1.2" class="ltx_Math" alttext="\bm{W}_{v},\bm{W}_{q}\in\mathcal{R}^{k\times d}" display="inline"><semantics id="S3.SS3.p3.1.m1.2a"><mrow id="S3.SS3.p3.1.m1.2.2" xref="S3.SS3.p3.1.m1.2.2.cmml"><mrow id="S3.SS3.p3.1.m1.2.2.2.2" xref="S3.SS3.p3.1.m1.2.2.2.3.cmml"><msub id="S3.SS3.p3.1.m1.1.1.1.1.1" xref="S3.SS3.p3.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2.cmml">𝑾</mi><mi id="S3.SS3.p3.1.m1.1.1.1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3.cmml">v</mi></msub><mo id="S3.SS3.p3.1.m1.2.2.2.2.3" xref="S3.SS3.p3.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p3.1.m1.2.2.2.2.2" xref="S3.SS3.p3.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS3.p3.1.m1.2.2.2.2.2.2" xref="S3.SS3.p3.1.m1.2.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.SS3.p3.1.m1.2.2.2.2.2.3" xref="S3.SS3.p3.1.m1.2.2.2.2.2.3.cmml">q</mi></msub></mrow><mo id="S3.SS3.p3.1.m1.2.2.3" xref="S3.SS3.p3.1.m1.2.2.3.cmml">∈</mo><msup id="S3.SS3.p3.1.m1.2.2.4" xref="S3.SS3.p3.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.2.2.4.2" xref="S3.SS3.p3.1.m1.2.2.4.2.cmml">ℛ</mi><mrow id="S3.SS3.p3.1.m1.2.2.4.3" xref="S3.SS3.p3.1.m1.2.2.4.3.cmml"><mi id="S3.SS3.p3.1.m1.2.2.4.3.2" xref="S3.SS3.p3.1.m1.2.2.4.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p3.1.m1.2.2.4.3.1" xref="S3.SS3.p3.1.m1.2.2.4.3.1.cmml">×</mo><mi id="S3.SS3.p3.1.m1.2.2.4.3.3" xref="S3.SS3.p3.1.m1.2.2.4.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.2b"><apply id="S3.SS3.p3.1.m1.2.2.cmml" xref="S3.SS3.p3.1.m1.2.2"><in id="S3.SS3.p3.1.m1.2.2.3.cmml" xref="S3.SS3.p3.1.m1.2.2.3"></in><list id="S3.SS3.p3.1.m1.2.2.2.3.cmml" xref="S3.SS3.p3.1.m1.2.2.2.2"><apply id="S3.SS3.p3.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.2">𝑾</ci><ci id="S3.SS3.p3.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.1.1.1.3">𝑣</ci></apply><apply id="S3.SS3.p3.1.m1.2.2.2.2.2.cmml" xref="S3.SS3.p3.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.1.m1.2.2.2.2.2.2">𝑾</ci><ci id="S3.SS3.p3.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.1.m1.2.2.2.2.2.3">𝑞</ci></apply></list><apply id="S3.SS3.p3.1.m1.2.2.4.cmml" xref="S3.SS3.p3.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.2.2.4.1.cmml" xref="S3.SS3.p3.1.m1.2.2.4">superscript</csymbol><ci id="S3.SS3.p3.1.m1.2.2.4.2.cmml" xref="S3.SS3.p3.1.m1.2.2.4.2">ℛ</ci><apply id="S3.SS3.p3.1.m1.2.2.4.3.cmml" xref="S3.SS3.p3.1.m1.2.2.4.3"><times id="S3.SS3.p3.1.m1.2.2.4.3.1.cmml" xref="S3.SS3.p3.1.m1.2.2.4.3.1"></times><ci id="S3.SS3.p3.1.m1.2.2.4.3.2.cmml" xref="S3.SS3.p3.1.m1.2.2.4.3.2">𝑘</ci><ci id="S3.SS3.p3.1.m1.2.2.4.3.3.cmml" xref="S3.SS3.p3.1.m1.2.2.4.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.2c">\bm{W}_{v},\bm{W}_{q}\in\mathcal{R}^{k\times d}</annotation></semantics></math>, <math id="S3.SS3.p3.2.m2.2" class="ltx_Math" alttext="\bm{w}_{hv},\bm{w}_{hq}\in\mathcal{R}^{k}" display="inline"><semantics id="S3.SS3.p3.2.m2.2a"><mrow id="S3.SS3.p3.2.m2.2.2" xref="S3.SS3.p3.2.m2.2.2.cmml"><mrow id="S3.SS3.p3.2.m2.2.2.2.2" xref="S3.SS3.p3.2.m2.2.2.2.3.cmml"><msub id="S3.SS3.p3.2.m2.1.1.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.2.cmml">𝒘</mi><mrow id="S3.SS3.p3.2.m2.1.1.1.1.1.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.1.1.1.1.1.3.1" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p3.2.m2.1.1.1.1.1.3.3" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3.3.cmml">v</mi></mrow></msub><mo id="S3.SS3.p3.2.m2.2.2.2.2.3" xref="S3.SS3.p3.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p3.2.m2.2.2.2.2.2" xref="S3.SS3.p3.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS3.p3.2.m2.2.2.2.2.2.2" xref="S3.SS3.p3.2.m2.2.2.2.2.2.2.cmml">𝒘</mi><mrow id="S3.SS3.p3.2.m2.2.2.2.2.2.3" xref="S3.SS3.p3.2.m2.2.2.2.2.2.3.cmml"><mi id="S3.SS3.p3.2.m2.2.2.2.2.2.3.2" xref="S3.SS3.p3.2.m2.2.2.2.2.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.2.2.2.2.2.3.1" xref="S3.SS3.p3.2.m2.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p3.2.m2.2.2.2.2.2.3.3" xref="S3.SS3.p3.2.m2.2.2.2.2.2.3.3.cmml">q</mi></mrow></msub></mrow><mo id="S3.SS3.p3.2.m2.2.2.3" xref="S3.SS3.p3.2.m2.2.2.3.cmml">∈</mo><msup id="S3.SS3.p3.2.m2.2.2.4" xref="S3.SS3.p3.2.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.2.m2.2.2.4.2" xref="S3.SS3.p3.2.m2.2.2.4.2.cmml">ℛ</mi><mi id="S3.SS3.p3.2.m2.2.2.4.3" xref="S3.SS3.p3.2.m2.2.2.4.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.2b"><apply id="S3.SS3.p3.2.m2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2"><in id="S3.SS3.p3.2.m2.2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.2.3"></in><list id="S3.SS3.p3.2.m2.2.2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2"><apply id="S3.SS3.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.2">𝒘</ci><apply id="S3.SS3.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3"><times id="S3.SS3.p3.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3.1"></times><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3.2">ℎ</ci><ci id="S3.SS3.p3.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.1.1.1.3.3">𝑣</ci></apply></apply><apply id="S3.SS3.p3.2.m2.2.2.2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2.2">𝒘</ci><apply id="S3.SS3.p3.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2.3"><times id="S3.SS3.p3.2.m2.2.2.2.2.2.3.1.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2.3.1"></times><ci id="S3.SS3.p3.2.m2.2.2.2.2.2.3.2.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2.3.2">ℎ</ci><ci id="S3.SS3.p3.2.m2.2.2.2.2.2.3.3.cmml" xref="S3.SS3.p3.2.m2.2.2.2.2.2.3.3">𝑞</ci></apply></apply></list><apply id="S3.SS3.p3.2.m2.2.2.4.cmml" xref="S3.SS3.p3.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.4.1.cmml" xref="S3.SS3.p3.2.m2.2.2.4">superscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.4.2.cmml" xref="S3.SS3.p3.2.m2.2.2.4.2">ℛ</ci><ci id="S3.SS3.p3.2.m2.2.2.4.3.cmml" xref="S3.SS3.p3.2.m2.2.2.4.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.2c">\bm{w}_{hv},\bm{w}_{hq}\in\mathcal{R}^{k}</annotation></semantics></math> are the weight parameters. <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="\bm{a}^{v}\in\mathcal{R}^{N}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mrow id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><msup id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.2" xref="S3.SS3.p3.3.m3.1.1.2.2.cmml">𝒂</mi><mi id="S3.SS3.p3.3.m3.1.1.2.3" xref="S3.SS3.p3.3.m3.1.1.2.3.cmml">v</mi></msup><mo id="S3.SS3.p3.3.m3.1.1.1" xref="S3.SS3.p3.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.3.m3.1.1.3.2" xref="S3.SS3.p3.3.m3.1.1.3.2.cmml">ℛ</mi><mi id="S3.SS3.p3.3.m3.1.1.3.3" xref="S3.SS3.p3.3.m3.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><in id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1.1"></in><apply id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.1.2">superscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2">𝒂</ci><ci id="S3.SS3.p3.3.m3.1.1.2.3.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3">𝑣</ci></apply><apply id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.3.1.cmml" xref="S3.SS3.p3.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.3.2.cmml" xref="S3.SS3.p3.3.m3.1.1.3.2">ℛ</ci><ci id="S3.SS3.p3.3.m3.1.1.3.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">\bm{a}^{v}\in\mathcal{R}^{N}</annotation></semantics></math> and <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="\bm{a}^{q}\in\mathcal{R}^{T}" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mrow id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><msup id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2.2" xref="S3.SS3.p3.4.m4.1.1.2.2.cmml">𝒂</mi><mi id="S3.SS3.p3.4.m4.1.1.2.3" xref="S3.SS3.p3.4.m4.1.1.2.3.cmml">q</mi></msup><mo id="S3.SS3.p3.4.m4.1.1.1" xref="S3.SS3.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.4.m4.1.1.3.2" xref="S3.SS3.p3.4.m4.1.1.3.2.cmml">ℛ</mi><mi id="S3.SS3.p3.4.m4.1.1.3.3" xref="S3.SS3.p3.4.m4.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><in id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1.1"></in><apply id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.2.1.cmml" xref="S3.SS3.p3.4.m4.1.1.2">superscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2.2">𝒂</ci><ci id="S3.SS3.p3.4.m4.1.1.2.3.cmml" xref="S3.SS3.p3.4.m4.1.1.2.3">𝑞</ci></apply><apply id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.3.1.cmml" xref="S3.SS3.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.3.2.cmml" xref="S3.SS3.p3.4.m4.1.1.3.2">ℛ</ci><ci id="S3.SS3.p3.4.m4.1.1.3.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">\bm{a}^{q}\in\mathcal{R}^{T}</annotation></semantics></math> are the attention probabilities of each image region <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="\bm{v}_{n}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><msub id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml">𝒗</mi><mi id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">𝒗</ci><ci id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\bm{v}_{n}</annotation></semantics></math> and word <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="\bm{q}_{t}" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><msub id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml">𝒒</mi><mi id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2">𝒒</ci><ci id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">\bm{q}_{t}</annotation></semantics></math> respectively. The affinity matrix <math id="S3.SS3.p3.7.m7.1" class="ltx_Math" alttext="\bm{C}" display="inline"><semantics id="S3.SS3.p3.7.m7.1a"><mi id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml">𝑪</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><ci id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">𝑪</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">\bm{C}</annotation></semantics></math> transforms question attention space to image attention space (vice versa for <math id="S3.SS3.p3.8.m8.1" class="ltx_Math" alttext="\bm{C}^{T}" display="inline"><semantics id="S3.SS3.p3.8.m8.1a"><msup id="S3.SS3.p3.8.m8.1.1" xref="S3.SS3.p3.8.m8.1.1.cmml"><mi id="S3.SS3.p3.8.m8.1.1.2" xref="S3.SS3.p3.8.m8.1.1.2.cmml">𝑪</mi><mi id="S3.SS3.p3.8.m8.1.1.3" xref="S3.SS3.p3.8.m8.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m8.1b"><apply id="S3.SS3.p3.8.m8.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m8.1.1.1.cmml" xref="S3.SS3.p3.8.m8.1.1">superscript</csymbol><ci id="S3.SS3.p3.8.m8.1.1.2.cmml" xref="S3.SS3.p3.8.m8.1.1.2">𝑪</ci><ci id="S3.SS3.p3.8.m8.1.1.3.cmml" xref="S3.SS3.p3.8.m8.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m8.1c">\bm{C}^{T}</annotation></semantics></math>).
Based on the above attention weights, the image and question attention vectors are calculated as the weighted sum of the image features and question features, i.e.,</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\hat{\bm{v}}=\sum_{n=1}^{N}a^{v}_{n}\bm{v}_{n},\quad\hat{\bm{q}}=\sum_{t=1}^{T}a^{q}_{t}\bm{q}_{t}" display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.3.cmml"><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><mover accent="true" id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2" xref="S3.E5.m1.1.1.1.1.2.2.cmml">𝒗</mi><mo id="S3.E5.m1.1.1.1.1.2.1" xref="S3.E5.m1.1.1.1.1.2.1.cmml">^</mo></mover><mo rspace="0.111em" id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml"><munderover id="S3.E5.m1.1.1.1.1.3.1" xref="S3.E5.m1.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E5.m1.1.1.1.1.3.1.2.2" xref="S3.E5.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.1.1.1.1.3.1.2.3" xref="S3.E5.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.1.2.3.2" xref="S3.E5.m1.1.1.1.1.3.1.2.3.2.cmml">n</mi><mo id="S3.E5.m1.1.1.1.1.3.1.2.3.1" xref="S3.E5.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.1.1.1.1.3.1.2.3.3" xref="S3.E5.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.1.1.1.1.3.1.3" xref="S3.E5.m1.1.1.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E5.m1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.1.1.3.2.cmml"><msubsup id="S3.E5.m1.1.1.1.1.3.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.2.2.2" xref="S3.E5.m1.1.1.1.1.3.2.2.2.2.cmml">a</mi><mi id="S3.E5.m1.1.1.1.1.3.2.2.3" xref="S3.E5.m1.1.1.1.1.3.2.2.3.cmml">n</mi><mi id="S3.E5.m1.1.1.1.1.3.2.2.2.3" xref="S3.E5.m1.1.1.1.1.3.2.2.2.3.cmml">v</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.3.2.1" xref="S3.E5.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E5.m1.1.1.1.1.3.2.3" xref="S3.E5.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E5.m1.1.1.1.1.3.2.3.2" xref="S3.E5.m1.1.1.1.1.3.2.3.2.cmml">𝒗</mi><mi id="S3.E5.m1.1.1.1.1.3.2.3.3" xref="S3.E5.m1.1.1.1.1.3.2.3.3.cmml">n</mi></msub></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.3a.cmml">,</mo><mrow id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml"><mover accent="true" id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.cmml"><mi id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml">𝒒</mi><mo id="S3.E5.m1.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.1.cmml">^</mo></mover><mo rspace="0.111em" id="S3.E5.m1.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.1.cmml">=</mo><mrow id="S3.E5.m1.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.3.cmml"><munderover id="S3.E5.m1.2.2.2.2.3.1" xref="S3.E5.m1.2.2.2.2.3.1.cmml"><mo movablelimits="false" id="S3.E5.m1.2.2.2.2.3.1.2.2" xref="S3.E5.m1.2.2.2.2.3.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.2.2.2.2.3.1.2.3" xref="S3.E5.m1.2.2.2.2.3.1.2.3.cmml"><mi id="S3.E5.m1.2.2.2.2.3.1.2.3.2" xref="S3.E5.m1.2.2.2.2.3.1.2.3.2.cmml">t</mi><mo id="S3.E5.m1.2.2.2.2.3.1.2.3.1" xref="S3.E5.m1.2.2.2.2.3.1.2.3.1.cmml">=</mo><mn id="S3.E5.m1.2.2.2.2.3.1.2.3.3" xref="S3.E5.m1.2.2.2.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.2.2.2.2.3.1.3" xref="S3.E5.m1.2.2.2.2.3.1.3.cmml">T</mi></munderover><mrow id="S3.E5.m1.2.2.2.2.3.2" xref="S3.E5.m1.2.2.2.2.3.2.cmml"><msubsup id="S3.E5.m1.2.2.2.2.3.2.2" xref="S3.E5.m1.2.2.2.2.3.2.2.cmml"><mi id="S3.E5.m1.2.2.2.2.3.2.2.2.2" xref="S3.E5.m1.2.2.2.2.3.2.2.2.2.cmml">a</mi><mi id="S3.E5.m1.2.2.2.2.3.2.2.3" xref="S3.E5.m1.2.2.2.2.3.2.2.3.cmml">t</mi><mi id="S3.E5.m1.2.2.2.2.3.2.2.2.3" xref="S3.E5.m1.2.2.2.2.3.2.2.2.3.cmml">q</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.2.3.2.1" xref="S3.E5.m1.2.2.2.2.3.2.1.cmml">​</mo><msub id="S3.E5.m1.2.2.2.2.3.2.3" xref="S3.E5.m1.2.2.2.2.3.2.3.cmml"><mi id="S3.E5.m1.2.2.2.2.3.2.3.2" xref="S3.E5.m1.2.2.2.2.3.2.3.2.cmml">𝒒</mi><mi id="S3.E5.m1.2.2.2.2.3.2.3.3" xref="S3.E5.m1.2.2.2.2.3.2.3.3.cmml">t</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3a.cmml" xref="S3.E5.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><eq id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"></eq><apply id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"><ci id="S3.E5.m1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2.1">^</ci><ci id="S3.E5.m1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2">𝒗</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3"><apply id="S3.E5.m1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.1.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E5.m1.1.1.1.1.3.1.2.cmml" xref="S3.E5.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.1.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E5.m1.1.1.1.1.3.1.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E5.m1.1.1.1.1.3.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.1.2.3"><eq id="S3.E5.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E5.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.1.2.3.2">𝑛</ci><cn type="integer" id="S3.E5.m1.1.1.1.1.3.1.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.1.1.1.1.3.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2"><times id="S3.E5.m1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.1"></times><apply id="S3.E5.m1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2">subscript</csymbol><apply id="S3.E5.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2.2.2">𝑎</ci><ci id="S3.E5.m1.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2.2.3">𝑣</ci></apply><ci id="S3.E5.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.2.3">𝑛</ci></apply><apply id="S3.E5.m1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.2">𝒗</ci><ci id="S3.E5.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E5.m1.1.1.1.1.3.2.3.3">𝑛</ci></apply></apply></apply></apply><apply id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2"><eq id="S3.E5.m1.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.1"></eq><apply id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2"><ci id="S3.E5.m1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1">^</ci><ci id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2">𝒒</ci></apply><apply id="S3.E5.m1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.3"><apply id="S3.E5.m1.2.2.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.3.1.1.cmml" xref="S3.E5.m1.2.2.2.2.3.1">superscript</csymbol><apply id="S3.E5.m1.2.2.2.2.3.1.2.cmml" xref="S3.E5.m1.2.2.2.2.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.3.1.2.1.cmml" xref="S3.E5.m1.2.2.2.2.3.1">subscript</csymbol><sum id="S3.E5.m1.2.2.2.2.3.1.2.2.cmml" xref="S3.E5.m1.2.2.2.2.3.1.2.2"></sum><apply id="S3.E5.m1.2.2.2.2.3.1.2.3.cmml" xref="S3.E5.m1.2.2.2.2.3.1.2.3"><eq id="S3.E5.m1.2.2.2.2.3.1.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.3.1.2.3.1"></eq><ci id="S3.E5.m1.2.2.2.2.3.1.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.3.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E5.m1.2.2.2.2.3.1.2.3.3.cmml" xref="S3.E5.m1.2.2.2.2.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.2.2.2.2.3.1.3.cmml" xref="S3.E5.m1.2.2.2.2.3.1.3">𝑇</ci></apply><apply id="S3.E5.m1.2.2.2.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.3.2"><times id="S3.E5.m1.2.2.2.2.3.2.1.cmml" xref="S3.E5.m1.2.2.2.2.3.2.1"></times><apply id="S3.E5.m1.2.2.2.2.3.2.2.cmml" xref="S3.E5.m1.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.3.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.3.2.2">subscript</csymbol><apply id="S3.E5.m1.2.2.2.2.3.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.3.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.3.2.2">superscript</csymbol><ci id="S3.E5.m1.2.2.2.2.3.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.3.2.2.2.2">𝑎</ci><ci id="S3.E5.m1.2.2.2.2.3.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.3.2.2.2.3">𝑞</ci></apply><ci id="S3.E5.m1.2.2.2.2.3.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.3.2.2.3">𝑡</ci></apply><apply id="S3.E5.m1.2.2.2.2.3.2.3.cmml" xref="S3.E5.m1.2.2.2.2.3.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.3.2.3.1.cmml" xref="S3.E5.m1.2.2.2.2.3.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.3.2.3.2.cmml" xref="S3.E5.m1.2.2.2.2.3.2.3.2">𝒒</ci><ci id="S3.E5.m1.2.2.2.2.3.2.3.3.cmml" xref="S3.E5.m1.2.2.2.2.3.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\hat{\bm{v}}=\sum_{n=1}^{N}a^{v}_{n}\bm{v}_{n},\quad\hat{\bm{q}}=\sum_{t=1}^{T}a^{q}_{t}\bm{q}_{t}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.11" class="ltx_p">The parallel co-attention is done at each level in the hierarchy, leading to <math id="S3.SS3.p3.9.m1.1" class="ltx_Math" alttext="\hat{\bm{v}}^{r}" display="inline"><semantics id="S3.SS3.p3.9.m1.1a"><msup id="S3.SS3.p3.9.m1.1.1" xref="S3.SS3.p3.9.m1.1.1.cmml"><mover accent="true" id="S3.SS3.p3.9.m1.1.1.2" xref="S3.SS3.p3.9.m1.1.1.2.cmml"><mi id="S3.SS3.p3.9.m1.1.1.2.2" xref="S3.SS3.p3.9.m1.1.1.2.2.cmml">𝒗</mi><mo id="S3.SS3.p3.9.m1.1.1.2.1" xref="S3.SS3.p3.9.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.9.m1.1.1.3" xref="S3.SS3.p3.9.m1.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m1.1b"><apply id="S3.SS3.p3.9.m1.1.1.cmml" xref="S3.SS3.p3.9.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m1.1.1.1.cmml" xref="S3.SS3.p3.9.m1.1.1">superscript</csymbol><apply id="S3.SS3.p3.9.m1.1.1.2.cmml" xref="S3.SS3.p3.9.m1.1.1.2"><ci id="S3.SS3.p3.9.m1.1.1.2.1.cmml" xref="S3.SS3.p3.9.m1.1.1.2.1">^</ci><ci id="S3.SS3.p3.9.m1.1.1.2.2.cmml" xref="S3.SS3.p3.9.m1.1.1.2.2">𝒗</ci></apply><ci id="S3.SS3.p3.9.m1.1.1.3.cmml" xref="S3.SS3.p3.9.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m1.1c">\hat{\bm{v}}^{r}</annotation></semantics></math> and <math id="S3.SS3.p3.10.m2.1" class="ltx_Math" alttext="\hat{\bm{q}}^{r}" display="inline"><semantics id="S3.SS3.p3.10.m2.1a"><msup id="S3.SS3.p3.10.m2.1.1" xref="S3.SS3.p3.10.m2.1.1.cmml"><mover accent="true" id="S3.SS3.p3.10.m2.1.1.2" xref="S3.SS3.p3.10.m2.1.1.2.cmml"><mi id="S3.SS3.p3.10.m2.1.1.2.2" xref="S3.SS3.p3.10.m2.1.1.2.2.cmml">𝒒</mi><mo id="S3.SS3.p3.10.m2.1.1.2.1" xref="S3.SS3.p3.10.m2.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.10.m2.1.1.3" xref="S3.SS3.p3.10.m2.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.10.m2.1b"><apply id="S3.SS3.p3.10.m2.1.1.cmml" xref="S3.SS3.p3.10.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.10.m2.1.1.1.cmml" xref="S3.SS3.p3.10.m2.1.1">superscript</csymbol><apply id="S3.SS3.p3.10.m2.1.1.2.cmml" xref="S3.SS3.p3.10.m2.1.1.2"><ci id="S3.SS3.p3.10.m2.1.1.2.1.cmml" xref="S3.SS3.p3.10.m2.1.1.2.1">^</ci><ci id="S3.SS3.p3.10.m2.1.1.2.2.cmml" xref="S3.SS3.p3.10.m2.1.1.2.2">𝒒</ci></apply><ci id="S3.SS3.p3.10.m2.1.1.3.cmml" xref="S3.SS3.p3.10.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.10.m2.1c">\hat{\bm{q}}^{r}</annotation></semantics></math> where <math id="S3.SS3.p3.11.m3.3" class="ltx_Math" alttext="r\in\left\{w,p,s\right\}" display="inline"><semantics id="S3.SS3.p3.11.m3.3a"><mrow id="S3.SS3.p3.11.m3.3.4" xref="S3.SS3.p3.11.m3.3.4.cmml"><mi id="S3.SS3.p3.11.m3.3.4.2" xref="S3.SS3.p3.11.m3.3.4.2.cmml">r</mi><mo id="S3.SS3.p3.11.m3.3.4.1" xref="S3.SS3.p3.11.m3.3.4.1.cmml">∈</mo><mrow id="S3.SS3.p3.11.m3.3.4.3.2" xref="S3.SS3.p3.11.m3.3.4.3.1.cmml"><mo id="S3.SS3.p3.11.m3.3.4.3.2.1" xref="S3.SS3.p3.11.m3.3.4.3.1.cmml">{</mo><mi id="S3.SS3.p3.11.m3.1.1" xref="S3.SS3.p3.11.m3.1.1.cmml">w</mi><mo id="S3.SS3.p3.11.m3.3.4.3.2.2" xref="S3.SS3.p3.11.m3.3.4.3.1.cmml">,</mo><mi id="S3.SS3.p3.11.m3.2.2" xref="S3.SS3.p3.11.m3.2.2.cmml">p</mi><mo id="S3.SS3.p3.11.m3.3.4.3.2.3" xref="S3.SS3.p3.11.m3.3.4.3.1.cmml">,</mo><mi id="S3.SS3.p3.11.m3.3.3" xref="S3.SS3.p3.11.m3.3.3.cmml">s</mi><mo id="S3.SS3.p3.11.m3.3.4.3.2.4" xref="S3.SS3.p3.11.m3.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.11.m3.3b"><apply id="S3.SS3.p3.11.m3.3.4.cmml" xref="S3.SS3.p3.11.m3.3.4"><in id="S3.SS3.p3.11.m3.3.4.1.cmml" xref="S3.SS3.p3.11.m3.3.4.1"></in><ci id="S3.SS3.p3.11.m3.3.4.2.cmml" xref="S3.SS3.p3.11.m3.3.4.2">𝑟</ci><set id="S3.SS3.p3.11.m3.3.4.3.1.cmml" xref="S3.SS3.p3.11.m3.3.4.3.2"><ci id="S3.SS3.p3.11.m3.1.1.cmml" xref="S3.SS3.p3.11.m3.1.1">𝑤</ci><ci id="S3.SS3.p3.11.m3.2.2.cmml" xref="S3.SS3.p3.11.m3.2.2">𝑝</ci><ci id="S3.SS3.p3.11.m3.3.3.cmml" xref="S3.SS3.p3.11.m3.3.3">𝑠</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.11.m3.3c">r\in\left\{w,p,s\right\}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.2" class="ltx_p"><span id="S3.SS3.p4.2.1" class="ltx_text ltx_font_bold">Alternating Co-Attention.</span> In this attention mechanism, we sequentially alternate between generating image and question attention. Briefly, this consists of three steps (marked in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.3 Co-Attention ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>b): 1) summarize the question into a single vector <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\bm{q}" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\bm{q}</annotation></semantics></math>; 2) attend to the image based on the question summary <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="\bm{q}" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">\bm{q}</annotation></semantics></math>; 3) attend to the question based on the attended image feature.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para ltx_noindent">
<p id="S3.SS3.p5.3" class="ltx_p">Concretely, we define an attention operation <math id="S3.SS3.p5.1.m1.2" class="ltx_Math" alttext="\hat{\bm{x}}=\mathcal{A}({\bm{X}};\bm{g})" display="inline"><semantics id="S3.SS3.p5.1.m1.2a"><mrow id="S3.SS3.p5.1.m1.2.3" xref="S3.SS3.p5.1.m1.2.3.cmml"><mover accent="true" id="S3.SS3.p5.1.m1.2.3.2" xref="S3.SS3.p5.1.m1.2.3.2.cmml"><mi id="S3.SS3.p5.1.m1.2.3.2.2" xref="S3.SS3.p5.1.m1.2.3.2.2.cmml">𝒙</mi><mo id="S3.SS3.p5.1.m1.2.3.2.1" xref="S3.SS3.p5.1.m1.2.3.2.1.cmml">^</mo></mover><mo id="S3.SS3.p5.1.m1.2.3.1" xref="S3.SS3.p5.1.m1.2.3.1.cmml">=</mo><mrow id="S3.SS3.p5.1.m1.2.3.3" xref="S3.SS3.p5.1.m1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p5.1.m1.2.3.3.2" xref="S3.SS3.p5.1.m1.2.3.3.2.cmml">𝒜</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.1.m1.2.3.3.1" xref="S3.SS3.p5.1.m1.2.3.3.1.cmml">​</mo><mrow id="S3.SS3.p5.1.m1.2.3.3.3.2" xref="S3.SS3.p5.1.m1.2.3.3.3.1.cmml"><mo stretchy="false" id="S3.SS3.p5.1.m1.2.3.3.3.2.1" xref="S3.SS3.p5.1.m1.2.3.3.3.1.cmml">(</mo><mi id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">𝑿</mi><mo id="S3.SS3.p5.1.m1.2.3.3.3.2.2" xref="S3.SS3.p5.1.m1.2.3.3.3.1.cmml">;</mo><mi id="S3.SS3.p5.1.m1.2.2" xref="S3.SS3.p5.1.m1.2.2.cmml">𝒈</mi><mo stretchy="false" id="S3.SS3.p5.1.m1.2.3.3.3.2.3" xref="S3.SS3.p5.1.m1.2.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.2b"><apply id="S3.SS3.p5.1.m1.2.3.cmml" xref="S3.SS3.p5.1.m1.2.3"><eq id="S3.SS3.p5.1.m1.2.3.1.cmml" xref="S3.SS3.p5.1.m1.2.3.1"></eq><apply id="S3.SS3.p5.1.m1.2.3.2.cmml" xref="S3.SS3.p5.1.m1.2.3.2"><ci id="S3.SS3.p5.1.m1.2.3.2.1.cmml" xref="S3.SS3.p5.1.m1.2.3.2.1">^</ci><ci id="S3.SS3.p5.1.m1.2.3.2.2.cmml" xref="S3.SS3.p5.1.m1.2.3.2.2">𝒙</ci></apply><apply id="S3.SS3.p5.1.m1.2.3.3.cmml" xref="S3.SS3.p5.1.m1.2.3.3"><times id="S3.SS3.p5.1.m1.2.3.3.1.cmml" xref="S3.SS3.p5.1.m1.2.3.3.1"></times><ci id="S3.SS3.p5.1.m1.2.3.3.2.cmml" xref="S3.SS3.p5.1.m1.2.3.3.2">𝒜</ci><list id="S3.SS3.p5.1.m1.2.3.3.3.1.cmml" xref="S3.SS3.p5.1.m1.2.3.3.3.2"><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">𝑿</ci><ci id="S3.SS3.p5.1.m1.2.2.cmml" xref="S3.SS3.p5.1.m1.2.2">𝒈</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.2c">\hat{\bm{x}}=\mathcal{A}({\bm{X}};\bm{g})</annotation></semantics></math>, which takes the image (or question) features <math id="S3.SS3.p5.2.m2.1" class="ltx_Math" alttext="\bm{X}" display="inline"><semantics id="S3.SS3.p5.2.m2.1a"><mi id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><ci id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">\bm{X}</annotation></semantics></math> and attention guidance <math id="S3.SS3.p5.3.m3.1" class="ltx_Math" alttext="\bm{g}" display="inline"><semantics id="S3.SS3.p5.3.m3.1a"><mi id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><ci id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">\bm{g}</annotation></semantics></math> derived from question (or image) as inputs, and outputs the attended image (or question) vector. The operation can be expressed in the following steps</p>
<table id="S3.E6" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E6X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{H}" display="inline"><semantics id="S3.E6X.2.1.1.m1.1a"><mi id="S3.E6X.2.1.1.m1.1.1" xref="S3.E6X.2.1.1.m1.1.1.cmml">𝑯</mi><annotation-xml encoding="MathML-Content" id="S3.E6X.2.1.1.m1.1b"><ci id="S3.E6X.2.1.1.m1.1.1.cmml" xref="S3.E6X.2.1.1.m1.1.1">𝑯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.2.1.1.m1.1c">\displaystyle\bm{H}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\tanh(\bm{W}_{x}\bm{X}+(\bm{W}_{g}\bm{g})\bm{\mathds{1}}^{T})" display="inline"><semantics id="S3.E6X.3.2.2.m1.2a"><mrow id="S3.E6X.3.2.2.m1.2.2" xref="S3.E6X.3.2.2.m1.2.2.cmml"><mi id="S3.E6X.3.2.2.m1.2.2.3" xref="S3.E6X.3.2.2.m1.2.2.3.cmml"></mi><mo id="S3.E6X.3.2.2.m1.2.2.2" xref="S3.E6X.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="S3.E6X.3.2.2.m1.2.2.1.1" xref="S3.E6X.3.2.2.m1.2.2.1.2.cmml"><mi id="S3.E6X.3.2.2.m1.1.1" xref="S3.E6X.3.2.2.m1.1.1.cmml">tanh</mi><mo id="S3.E6X.3.2.2.m1.2.2.1.1a" xref="S3.E6X.3.2.2.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.E6X.3.2.2.m1.2.2.1.1.1" xref="S3.E6X.3.2.2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E6X.3.2.2.m1.2.2.1.1.1.2" xref="S3.E6X.3.2.2.m1.2.2.1.2.cmml">(</mo><mrow id="S3.E6X.3.2.2.m1.2.2.1.1.1.1" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.cmml"><msub id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.2" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.2.cmml">𝑾</mi><mi id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.3" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.3.cmml">x</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.1" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.3" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.3.cmml">𝑿</mi></mrow><mo id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.2.cmml">+</mo><mrow id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝑾</mi><mi id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">𝒈</mi></mrow><mo stretchy="false" id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.2" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml">​</mo><msup id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml"><mn id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.2" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.2.cmml">𝟙</mn><mi id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.3" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.3.cmml">T</mi></msup></mrow></mrow><mo stretchy="false" id="S3.E6X.3.2.2.m1.2.2.1.1.1.3" xref="S3.E6X.3.2.2.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6X.3.2.2.m1.2b"><apply id="S3.E6X.3.2.2.m1.2.2.cmml" xref="S3.E6X.3.2.2.m1.2.2"><eq id="S3.E6X.3.2.2.m1.2.2.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="S3.E6X.3.2.2.m1.2.2.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.3">absent</csymbol><apply id="S3.E6X.3.2.2.m1.2.2.1.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1"><tanh id="S3.E6X.3.2.2.m1.1.1.cmml" xref="S3.E6X.3.2.2.m1.1.1"></tanh><apply id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1"><plus id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.2"></plus><apply id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3"><times id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.1"></times><apply id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.2">𝑾</ci><ci id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.2.3">𝑥</ci></apply><ci id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.3.3">𝑿</ci></apply><apply id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1"><times id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.2"></times><apply id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1"><times id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑾</ci><ci id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑔</ci></apply><ci id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3">𝒈</ci></apply><apply id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3">superscript</csymbol><cn type="integer" id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.2">1</cn><ci id="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E6X.3.2.2.m1.2.2.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6X.3.2.2.m1.2c">\displaystyle=\tanh(\bm{W}_{x}\bm{X}+(\bm{W}_{g}\bm{g})\bm{\mathds{1}}^{T})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(6)</span></td>
</tr>
<tr id="S3.E6Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{a}^{x}" display="inline"><semantics id="S3.E6Xa.2.1.1.m1.1a"><msup id="S3.E6Xa.2.1.1.m1.1.1" xref="S3.E6Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E6Xa.2.1.1.m1.1.1.2" xref="S3.E6Xa.2.1.1.m1.1.1.2.cmml">𝒂</mi><mi id="S3.E6Xa.2.1.1.m1.1.1.3" xref="S3.E6Xa.2.1.1.m1.1.1.3.cmml">x</mi></msup><annotation-xml encoding="MathML-Content" id="S3.E6Xa.2.1.1.m1.1b"><apply id="S3.E6Xa.2.1.1.m1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E6Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E6Xa.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E6Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E6Xa.2.1.1.m1.1.1.2">𝒂</ci><ci id="S3.E6Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E6Xa.2.1.1.m1.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6Xa.2.1.1.m1.1c">\displaystyle\bm{a}^{x}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\textrm{softmax}(\bm{w}_{hx}^{T}\bm{H})" display="inline"><semantics id="S3.E6Xa.3.2.2.m1.1a"><mrow id="S3.E6Xa.3.2.2.m1.1.1" xref="S3.E6Xa.3.2.2.m1.1.1.cmml"><mi id="S3.E6Xa.3.2.2.m1.1.1.3" xref="S3.E6Xa.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E6Xa.3.2.2.m1.1.1.2" xref="S3.E6Xa.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E6Xa.3.2.2.m1.1.1.1" xref="S3.E6Xa.3.2.2.m1.1.1.1.cmml"><mtext id="S3.E6Xa.3.2.2.m1.1.1.1.3" xref="S3.E6Xa.3.2.2.m1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E6Xa.3.2.2.m1.1.1.1.2" xref="S3.E6Xa.3.2.2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E6Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.2" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.cmml"><msubsup id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml">𝒘</mi><mrow id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.3.cmml">x</mi></mrow><mi id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.3" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml">𝑯</mi></mrow><mo stretchy="false" id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6Xa.3.2.2.m1.1b"><apply id="S3.E6Xa.3.2.2.m1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1"><eq id="S3.E6Xa.3.2.2.m1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E6Xa.3.2.2.m1.1.1.3.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E6Xa.3.2.2.m1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1"><times id="S3.E6Xa.3.2.2.m1.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.2"></times><ci id="S3.E6Xa.3.2.2.m1.1.1.1.3a.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.3"><mtext id="S3.E6Xa.3.2.2.m1.1.1.1.3.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.3">softmax</mtext></ci><apply id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1"><times id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.1"></times><apply id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.2">𝒘</ci><apply id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3"><times id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.2">ℎ</ci><ci id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.2.3.3">𝑥</ci></apply></apply><ci id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E6Xa.3.2.2.m1.1.1.1.1.1.1.3">𝑯</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6Xa.3.2.2.m1.1c">\displaystyle=\textrm{softmax}(\bm{w}_{hx}^{T}\bm{H})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E6Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E6Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\hat{\bm{x}}" display="inline"><semantics id="S3.E6Xb.2.1.1.m1.1a"><mover accent="true" id="S3.E6Xb.2.1.1.m1.1.1" xref="S3.E6Xb.2.1.1.m1.1.1.cmml"><mi id="S3.E6Xb.2.1.1.m1.1.1.2" xref="S3.E6Xb.2.1.1.m1.1.1.2.cmml">𝒙</mi><mo id="S3.E6Xb.2.1.1.m1.1.1.1" xref="S3.E6Xb.2.1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.E6Xb.2.1.1.m1.1b"><apply id="S3.E6Xb.2.1.1.m1.1.1.cmml" xref="S3.E6Xb.2.1.1.m1.1.1"><ci id="S3.E6Xb.2.1.1.m1.1.1.1.cmml" xref="S3.E6Xb.2.1.1.m1.1.1.1">^</ci><ci id="S3.E6Xb.2.1.1.m1.1.1.2.cmml" xref="S3.E6Xb.2.1.1.m1.1.1.2">𝒙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6Xb.2.1.1.m1.1c">\displaystyle\hat{\bm{x}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6Xb.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\sum a^{x}_{i}\bm{x}_{i}" display="inline"><semantics id="S3.E6Xb.3.2.2.m1.1a"><mrow id="S3.E6Xb.3.2.2.m1.1.1" xref="S3.E6Xb.3.2.2.m1.1.1.cmml"><mi id="S3.E6Xb.3.2.2.m1.1.1.2" xref="S3.E6Xb.3.2.2.m1.1.1.2.cmml"></mi><mo id="S3.E6Xb.3.2.2.m1.1.1.1" xref="S3.E6Xb.3.2.2.m1.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S3.E6Xb.3.2.2.m1.1.1.3" xref="S3.E6Xb.3.2.2.m1.1.1.3.cmml"><mrow id="S3.E6Xb.3.2.2.m1.1.1.3a" xref="S3.E6Xb.3.2.2.m1.1.1.3.cmml"><mo movablelimits="false" id="S3.E6Xb.3.2.2.m1.1.1.3.1" xref="S3.E6Xb.3.2.2.m1.1.1.3.1.cmml">∑</mo><mrow id="S3.E6Xb.3.2.2.m1.1.1.3.2" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.cmml"><msubsup id="S3.E6Xb.3.2.2.m1.1.1.3.2.2" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2.cmml"><mi id="S3.E6Xb.3.2.2.m1.1.1.3.2.2.2.2" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2.2.2.cmml">a</mi><mi id="S3.E6Xb.3.2.2.m1.1.1.3.2.2.3" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2.3.cmml">i</mi><mi id="S3.E6Xb.3.2.2.m1.1.1.3.2.2.2.3" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2.2.3.cmml">x</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E6Xb.3.2.2.m1.1.1.3.2.1" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.1.cmml">​</mo><msub id="S3.E6Xb.3.2.2.m1.1.1.3.2.3" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.3.cmml"><mi id="S3.E6Xb.3.2.2.m1.1.1.3.2.3.2" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.3.2.cmml">𝒙</mi><mi id="S3.E6Xb.3.2.2.m1.1.1.3.2.3.3" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S3.E6Xb.3.2.2.m1.1b"><apply id="S3.E6Xb.3.2.2.m1.1.1.cmml" xref="S3.E6Xb.3.2.2.m1.1.1"><eq id="S3.E6Xb.3.2.2.m1.1.1.1.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E6Xb.3.2.2.m1.1.1.2.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.2">absent</csymbol><apply id="S3.E6Xb.3.2.2.m1.1.1.3.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3"><sum id="S3.E6Xb.3.2.2.m1.1.1.3.1.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.1"></sum><apply id="S3.E6Xb.3.2.2.m1.1.1.3.2.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2"><times id="S3.E6Xb.3.2.2.m1.1.1.3.2.1.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.1"></times><apply id="S3.E6Xb.3.2.2.m1.1.1.3.2.2.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E6Xb.3.2.2.m1.1.1.3.2.2.1.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2">subscript</csymbol><apply id="S3.E6Xb.3.2.2.m1.1.1.3.2.2.2.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E6Xb.3.2.2.m1.1.1.3.2.2.2.1.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2">superscript</csymbol><ci id="S3.E6Xb.3.2.2.m1.1.1.3.2.2.2.2.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2.2.2">𝑎</ci><ci id="S3.E6Xb.3.2.2.m1.1.1.3.2.2.2.3.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2.2.3">𝑥</ci></apply><ci id="S3.E6Xb.3.2.2.m1.1.1.3.2.2.3.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E6Xb.3.2.2.m1.1.1.3.2.3.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E6Xb.3.2.2.m1.1.1.3.2.3.1.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E6Xb.3.2.2.m1.1.1.3.2.3.2.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.3.2">𝒙</ci><ci id="S3.E6Xb.3.2.2.m1.1.1.3.2.3.3.cmml" xref="S3.E6Xb.3.2.2.m1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6Xb.3.2.2.m1.1c">\displaystyle=\sum a^{x}_{i}\bm{x}_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS3.p5.8" class="ltx_p">where <math id="S3.SS3.p5.4.m1.1" class="ltx_Math" alttext="\bm{\mathds{1}}" display="inline"><semantics id="S3.SS3.p5.4.m1.1a"><mn id="S3.SS3.p5.4.m1.1.1" xref="S3.SS3.p5.4.m1.1.1.cmml">𝟙</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m1.1b"><cn type="integer" id="S3.SS3.p5.4.m1.1.1.cmml" xref="S3.SS3.p5.4.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m1.1c">\bm{\mathds{1}}</annotation></semantics></math> is a vector with all elements to be 1. <math id="S3.SS3.p5.5.m2.2" class="ltx_Math" alttext="\bm{W}_{x},\bm{W}_{g}\in\mathcal{R}^{k\times d}" display="inline"><semantics id="S3.SS3.p5.5.m2.2a"><mrow id="S3.SS3.p5.5.m2.2.2" xref="S3.SS3.p5.5.m2.2.2.cmml"><mrow id="S3.SS3.p5.5.m2.2.2.2.2" xref="S3.SS3.p5.5.m2.2.2.2.3.cmml"><msub id="S3.SS3.p5.5.m2.1.1.1.1.1" xref="S3.SS3.p5.5.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p5.5.m2.1.1.1.1.1.2" xref="S3.SS3.p5.5.m2.1.1.1.1.1.2.cmml">𝑾</mi><mi id="S3.SS3.p5.5.m2.1.1.1.1.1.3" xref="S3.SS3.p5.5.m2.1.1.1.1.1.3.cmml">x</mi></msub><mo id="S3.SS3.p5.5.m2.2.2.2.2.3" xref="S3.SS3.p5.5.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS3.p5.5.m2.2.2.2.2.2" xref="S3.SS3.p5.5.m2.2.2.2.2.2.cmml"><mi id="S3.SS3.p5.5.m2.2.2.2.2.2.2" xref="S3.SS3.p5.5.m2.2.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.SS3.p5.5.m2.2.2.2.2.2.3" xref="S3.SS3.p5.5.m2.2.2.2.2.2.3.cmml">g</mi></msub></mrow><mo id="S3.SS3.p5.5.m2.2.2.3" xref="S3.SS3.p5.5.m2.2.2.3.cmml">∈</mo><msup id="S3.SS3.p5.5.m2.2.2.4" xref="S3.SS3.p5.5.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p5.5.m2.2.2.4.2" xref="S3.SS3.p5.5.m2.2.2.4.2.cmml">ℛ</mi><mrow id="S3.SS3.p5.5.m2.2.2.4.3" xref="S3.SS3.p5.5.m2.2.2.4.3.cmml"><mi id="S3.SS3.p5.5.m2.2.2.4.3.2" xref="S3.SS3.p5.5.m2.2.2.4.3.2.cmml">k</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS3.p5.5.m2.2.2.4.3.1" xref="S3.SS3.p5.5.m2.2.2.4.3.1.cmml">×</mo><mi id="S3.SS3.p5.5.m2.2.2.4.3.3" xref="S3.SS3.p5.5.m2.2.2.4.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.5.m2.2b"><apply id="S3.SS3.p5.5.m2.2.2.cmml" xref="S3.SS3.p5.5.m2.2.2"><in id="S3.SS3.p5.5.m2.2.2.3.cmml" xref="S3.SS3.p5.5.m2.2.2.3"></in><list id="S3.SS3.p5.5.m2.2.2.2.3.cmml" xref="S3.SS3.p5.5.m2.2.2.2.2"><apply id="S3.SS3.p5.5.m2.1.1.1.1.1.cmml" xref="S3.SS3.p5.5.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.5.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.5.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p5.5.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.5.m2.1.1.1.1.1.2">𝑾</ci><ci id="S3.SS3.p5.5.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.5.m2.1.1.1.1.1.3">𝑥</ci></apply><apply id="S3.SS3.p5.5.m2.2.2.2.2.2.cmml" xref="S3.SS3.p5.5.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p5.5.m2.2.2.2.2.2.1.cmml" xref="S3.SS3.p5.5.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p5.5.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.p5.5.m2.2.2.2.2.2.2">𝑾</ci><ci id="S3.SS3.p5.5.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.p5.5.m2.2.2.2.2.2.3">𝑔</ci></apply></list><apply id="S3.SS3.p5.5.m2.2.2.4.cmml" xref="S3.SS3.p5.5.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.p5.5.m2.2.2.4.1.cmml" xref="S3.SS3.p5.5.m2.2.2.4">superscript</csymbol><ci id="S3.SS3.p5.5.m2.2.2.4.2.cmml" xref="S3.SS3.p5.5.m2.2.2.4.2">ℛ</ci><apply id="S3.SS3.p5.5.m2.2.2.4.3.cmml" xref="S3.SS3.p5.5.m2.2.2.4.3"><times id="S3.SS3.p5.5.m2.2.2.4.3.1.cmml" xref="S3.SS3.p5.5.m2.2.2.4.3.1"></times><ci id="S3.SS3.p5.5.m2.2.2.4.3.2.cmml" xref="S3.SS3.p5.5.m2.2.2.4.3.2">𝑘</ci><ci id="S3.SS3.p5.5.m2.2.2.4.3.3.cmml" xref="S3.SS3.p5.5.m2.2.2.4.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.5.m2.2c">\bm{W}_{x},\bm{W}_{g}\in\mathcal{R}^{k\times d}</annotation></semantics></math> and <math id="S3.SS3.p5.6.m3.1" class="ltx_Math" alttext="\bm{w}_{hx}\in\mathcal{R}^{k}" display="inline"><semantics id="S3.SS3.p5.6.m3.1a"><mrow id="S3.SS3.p5.6.m3.1.1" xref="S3.SS3.p5.6.m3.1.1.cmml"><msub id="S3.SS3.p5.6.m3.1.1.2" xref="S3.SS3.p5.6.m3.1.1.2.cmml"><mi id="S3.SS3.p5.6.m3.1.1.2.2" xref="S3.SS3.p5.6.m3.1.1.2.2.cmml">𝒘</mi><mrow id="S3.SS3.p5.6.m3.1.1.2.3" xref="S3.SS3.p5.6.m3.1.1.2.3.cmml"><mi id="S3.SS3.p5.6.m3.1.1.2.3.2" xref="S3.SS3.p5.6.m3.1.1.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p5.6.m3.1.1.2.3.1" xref="S3.SS3.p5.6.m3.1.1.2.3.1.cmml">​</mo><mi id="S3.SS3.p5.6.m3.1.1.2.3.3" xref="S3.SS3.p5.6.m3.1.1.2.3.3.cmml">x</mi></mrow></msub><mo id="S3.SS3.p5.6.m3.1.1.1" xref="S3.SS3.p5.6.m3.1.1.1.cmml">∈</mo><msup id="S3.SS3.p5.6.m3.1.1.3" xref="S3.SS3.p5.6.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p5.6.m3.1.1.3.2" xref="S3.SS3.p5.6.m3.1.1.3.2.cmml">ℛ</mi><mi id="S3.SS3.p5.6.m3.1.1.3.3" xref="S3.SS3.p5.6.m3.1.1.3.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.6.m3.1b"><apply id="S3.SS3.p5.6.m3.1.1.cmml" xref="S3.SS3.p5.6.m3.1.1"><in id="S3.SS3.p5.6.m3.1.1.1.cmml" xref="S3.SS3.p5.6.m3.1.1.1"></in><apply id="S3.SS3.p5.6.m3.1.1.2.cmml" xref="S3.SS3.p5.6.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p5.6.m3.1.1.2.1.cmml" xref="S3.SS3.p5.6.m3.1.1.2">subscript</csymbol><ci id="S3.SS3.p5.6.m3.1.1.2.2.cmml" xref="S3.SS3.p5.6.m3.1.1.2.2">𝒘</ci><apply id="S3.SS3.p5.6.m3.1.1.2.3.cmml" xref="S3.SS3.p5.6.m3.1.1.2.3"><times id="S3.SS3.p5.6.m3.1.1.2.3.1.cmml" xref="S3.SS3.p5.6.m3.1.1.2.3.1"></times><ci id="S3.SS3.p5.6.m3.1.1.2.3.2.cmml" xref="S3.SS3.p5.6.m3.1.1.2.3.2">ℎ</ci><ci id="S3.SS3.p5.6.m3.1.1.2.3.3.cmml" xref="S3.SS3.p5.6.m3.1.1.2.3.3">𝑥</ci></apply></apply><apply id="S3.SS3.p5.6.m3.1.1.3.cmml" xref="S3.SS3.p5.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.6.m3.1.1.3.1.cmml" xref="S3.SS3.p5.6.m3.1.1.3">superscript</csymbol><ci id="S3.SS3.p5.6.m3.1.1.3.2.cmml" xref="S3.SS3.p5.6.m3.1.1.3.2">ℛ</ci><ci id="S3.SS3.p5.6.m3.1.1.3.3.cmml" xref="S3.SS3.p5.6.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.6.m3.1c">\bm{w}_{hx}\in\mathcal{R}^{k}</annotation></semantics></math> are parameters. <math id="S3.SS3.p5.7.m4.1" class="ltx_Math" alttext="\bm{a}^{x}" display="inline"><semantics id="S3.SS3.p5.7.m4.1a"><msup id="S3.SS3.p5.7.m4.1.1" xref="S3.SS3.p5.7.m4.1.1.cmml"><mi id="S3.SS3.p5.7.m4.1.1.2" xref="S3.SS3.p5.7.m4.1.1.2.cmml">𝒂</mi><mi id="S3.SS3.p5.7.m4.1.1.3" xref="S3.SS3.p5.7.m4.1.1.3.cmml">x</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.7.m4.1b"><apply id="S3.SS3.p5.7.m4.1.1.cmml" xref="S3.SS3.p5.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.7.m4.1.1.1.cmml" xref="S3.SS3.p5.7.m4.1.1">superscript</csymbol><ci id="S3.SS3.p5.7.m4.1.1.2.cmml" xref="S3.SS3.p5.7.m4.1.1.2">𝒂</ci><ci id="S3.SS3.p5.7.m4.1.1.3.cmml" xref="S3.SS3.p5.7.m4.1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.7.m4.1c">\bm{a}^{x}</annotation></semantics></math> is the attention weight of feature <math id="S3.SS3.p5.8.m5.1" class="ltx_Math" alttext="\bm{X}" display="inline"><semantics id="S3.SS3.p5.8.m5.1a"><mi id="S3.SS3.p5.8.m5.1.1" xref="S3.SS3.p5.8.m5.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.8.m5.1b"><ci id="S3.SS3.p5.8.m5.1.1.cmml" xref="S3.SS3.p5.8.m5.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.8.m5.1c">\bm{X}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p6" class="ltx_para ltx_noindent">
<p id="S3.SS3.p6.10" class="ltx_p">The alternating co-attention process is illustrated in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.3 Co-Attention ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (b). At the first step of alternating co-attention, <math id="S3.SS3.p6.1.m1.1" class="ltx_Math" alttext="\bm{X}=\bm{Q}" display="inline"><semantics id="S3.SS3.p6.1.m1.1a"><mrow id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml"><mi id="S3.SS3.p6.1.m1.1.1.2" xref="S3.SS3.p6.1.m1.1.1.2.cmml">𝑿</mi><mo id="S3.SS3.p6.1.m1.1.1.1" xref="S3.SS3.p6.1.m1.1.1.1.cmml">=</mo><mi id="S3.SS3.p6.1.m1.1.1.3" xref="S3.SS3.p6.1.m1.1.1.3.cmml">𝑸</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><apply id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1"><eq id="S3.SS3.p6.1.m1.1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1.1"></eq><ci id="S3.SS3.p6.1.m1.1.1.2.cmml" xref="S3.SS3.p6.1.m1.1.1.2">𝑿</ci><ci id="S3.SS3.p6.1.m1.1.1.3.cmml" xref="S3.SS3.p6.1.m1.1.1.3">𝑸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">\bm{X}=\bm{Q}</annotation></semantics></math>, and <math id="S3.SS3.p6.2.m2.1" class="ltx_Math" alttext="\bm{g}" display="inline"><semantics id="S3.SS3.p6.2.m2.1a"><mi id="S3.SS3.p6.2.m2.1.1" xref="S3.SS3.p6.2.m2.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.1b"><ci id="S3.SS3.p6.2.m2.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.1c">\bm{g}</annotation></semantics></math> is <math id="S3.SS3.p6.3.m3.1" class="ltx_Math" alttext="\bm{0}" display="inline"><semantics id="S3.SS3.p6.3.m3.1a"><mn id="S3.SS3.p6.3.m3.1.1" xref="S3.SS3.p6.3.m3.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.3.m3.1b"><cn type="integer" id="S3.SS3.p6.3.m3.1.1.cmml" xref="S3.SS3.p6.3.m3.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.3.m3.1c">\bm{0}</annotation></semantics></math>; At the second step, <math id="S3.SS3.p6.4.m4.1" class="ltx_Math" alttext="\bm{X}=\bm{V}" display="inline"><semantics id="S3.SS3.p6.4.m4.1a"><mrow id="S3.SS3.p6.4.m4.1.1" xref="S3.SS3.p6.4.m4.1.1.cmml"><mi id="S3.SS3.p6.4.m4.1.1.2" xref="S3.SS3.p6.4.m4.1.1.2.cmml">𝑿</mi><mo id="S3.SS3.p6.4.m4.1.1.1" xref="S3.SS3.p6.4.m4.1.1.1.cmml">=</mo><mi id="S3.SS3.p6.4.m4.1.1.3" xref="S3.SS3.p6.4.m4.1.1.3.cmml">𝑽</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.4.m4.1b"><apply id="S3.SS3.p6.4.m4.1.1.cmml" xref="S3.SS3.p6.4.m4.1.1"><eq id="S3.SS3.p6.4.m4.1.1.1.cmml" xref="S3.SS3.p6.4.m4.1.1.1"></eq><ci id="S3.SS3.p6.4.m4.1.1.2.cmml" xref="S3.SS3.p6.4.m4.1.1.2">𝑿</ci><ci id="S3.SS3.p6.4.m4.1.1.3.cmml" xref="S3.SS3.p6.4.m4.1.1.3">𝑽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.4.m4.1c">\bm{X}=\bm{V}</annotation></semantics></math> where <math id="S3.SS3.p6.5.m5.1" class="ltx_Math" alttext="\bm{V}" display="inline"><semantics id="S3.SS3.p6.5.m5.1a"><mi id="S3.SS3.p6.5.m5.1.1" xref="S3.SS3.p6.5.m5.1.1.cmml">𝑽</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.5.m5.1b"><ci id="S3.SS3.p6.5.m5.1.1.cmml" xref="S3.SS3.p6.5.m5.1.1">𝑽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.5.m5.1c">\bm{V}</annotation></semantics></math> is the image features, and the guidance <math id="S3.SS3.p6.6.m6.1" class="ltx_Math" alttext="\bm{g}" display="inline"><semantics id="S3.SS3.p6.6.m6.1a"><mi id="S3.SS3.p6.6.m6.1.1" xref="S3.SS3.p6.6.m6.1.1.cmml">𝒈</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.6.m6.1b"><ci id="S3.SS3.p6.6.m6.1.1.cmml" xref="S3.SS3.p6.6.m6.1.1">𝒈</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.6.m6.1c">\bm{g}</annotation></semantics></math> is intermediate attended question feature <math id="S3.SS3.p6.7.m7.1" class="ltx_Math" alttext="\hat{\bm{s}}" display="inline"><semantics id="S3.SS3.p6.7.m7.1a"><mover accent="true" id="S3.SS3.p6.7.m7.1.1" xref="S3.SS3.p6.7.m7.1.1.cmml"><mi id="S3.SS3.p6.7.m7.1.1.2" xref="S3.SS3.p6.7.m7.1.1.2.cmml">𝒔</mi><mo id="S3.SS3.p6.7.m7.1.1.1" xref="S3.SS3.p6.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.7.m7.1b"><apply id="S3.SS3.p6.7.m7.1.1.cmml" xref="S3.SS3.p6.7.m7.1.1"><ci id="S3.SS3.p6.7.m7.1.1.1.cmml" xref="S3.SS3.p6.7.m7.1.1.1">^</ci><ci id="S3.SS3.p6.7.m7.1.1.2.cmml" xref="S3.SS3.p6.7.m7.1.1.2">𝒔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.7.m7.1c">\hat{\bm{s}}</annotation></semantics></math> from the first step; Finally, we use the attended image feature <math id="S3.SS3.p6.8.m8.1" class="ltx_Math" alttext="\hat{\bm{v}}" display="inline"><semantics id="S3.SS3.p6.8.m8.1a"><mover accent="true" id="S3.SS3.p6.8.m8.1.1" xref="S3.SS3.p6.8.m8.1.1.cmml"><mi id="S3.SS3.p6.8.m8.1.1.2" xref="S3.SS3.p6.8.m8.1.1.2.cmml">𝒗</mi><mo id="S3.SS3.p6.8.m8.1.1.1" xref="S3.SS3.p6.8.m8.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.8.m8.1b"><apply id="S3.SS3.p6.8.m8.1.1.cmml" xref="S3.SS3.p6.8.m8.1.1"><ci id="S3.SS3.p6.8.m8.1.1.1.cmml" xref="S3.SS3.p6.8.m8.1.1.1">^</ci><ci id="S3.SS3.p6.8.m8.1.1.2.cmml" xref="S3.SS3.p6.8.m8.1.1.2">𝒗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.8.m8.1c">\hat{\bm{v}}</annotation></semantics></math> as the guidance to attend the question again, i.e., <math id="S3.SS3.p6.9.m9.1" class="ltx_Math" alttext="\bm{X}=\bm{{Q}}" display="inline"><semantics id="S3.SS3.p6.9.m9.1a"><mrow id="S3.SS3.p6.9.m9.1.1" xref="S3.SS3.p6.9.m9.1.1.cmml"><mi id="S3.SS3.p6.9.m9.1.1.2" xref="S3.SS3.p6.9.m9.1.1.2.cmml">𝑿</mi><mo id="S3.SS3.p6.9.m9.1.1.1" xref="S3.SS3.p6.9.m9.1.1.1.cmml">=</mo><mi id="S3.SS3.p6.9.m9.1.1.3" xref="S3.SS3.p6.9.m9.1.1.3.cmml">𝑸</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.9.m9.1b"><apply id="S3.SS3.p6.9.m9.1.1.cmml" xref="S3.SS3.p6.9.m9.1.1"><eq id="S3.SS3.p6.9.m9.1.1.1.cmml" xref="S3.SS3.p6.9.m9.1.1.1"></eq><ci id="S3.SS3.p6.9.m9.1.1.2.cmml" xref="S3.SS3.p6.9.m9.1.1.2">𝑿</ci><ci id="S3.SS3.p6.9.m9.1.1.3.cmml" xref="S3.SS3.p6.9.m9.1.1.3">𝑸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.9.m9.1c">\bm{X}=\bm{{Q}}</annotation></semantics></math> and <math id="S3.SS3.p6.10.m10.1" class="ltx_Math" alttext="\bm{g}=\hat{\bm{v}}" display="inline"><semantics id="S3.SS3.p6.10.m10.1a"><mrow id="S3.SS3.p6.10.m10.1.1" xref="S3.SS3.p6.10.m10.1.1.cmml"><mi id="S3.SS3.p6.10.m10.1.1.2" xref="S3.SS3.p6.10.m10.1.1.2.cmml">𝒈</mi><mo id="S3.SS3.p6.10.m10.1.1.1" xref="S3.SS3.p6.10.m10.1.1.1.cmml">=</mo><mover accent="true" id="S3.SS3.p6.10.m10.1.1.3" xref="S3.SS3.p6.10.m10.1.1.3.cmml"><mi id="S3.SS3.p6.10.m10.1.1.3.2" xref="S3.SS3.p6.10.m10.1.1.3.2.cmml">𝒗</mi><mo id="S3.SS3.p6.10.m10.1.1.3.1" xref="S3.SS3.p6.10.m10.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.10.m10.1b"><apply id="S3.SS3.p6.10.m10.1.1.cmml" xref="S3.SS3.p6.10.m10.1.1"><eq id="S3.SS3.p6.10.m10.1.1.1.cmml" xref="S3.SS3.p6.10.m10.1.1.1"></eq><ci id="S3.SS3.p6.10.m10.1.1.2.cmml" xref="S3.SS3.p6.10.m10.1.1.2">𝒈</ci><apply id="S3.SS3.p6.10.m10.1.1.3.cmml" xref="S3.SS3.p6.10.m10.1.1.3"><ci id="S3.SS3.p6.10.m10.1.1.3.1.cmml" xref="S3.SS3.p6.10.m10.1.1.3.1">^</ci><ci id="S3.SS3.p6.10.m10.1.1.3.2.cmml" xref="S3.SS3.p6.10.m10.1.1.3.2">𝒗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.10.m10.1c">\bm{g}=\hat{\bm{v}}</annotation></semantics></math>. Similar to the parallel co-attention, the alternating co-attention is also done at each level of the hierarchy.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Encoding for Predicting Answers</h3>

<figure id="S3.F3" class="ltx_figure"><img src="/html/1606.00061/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="401" height="160" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>(a) Hierarchical question encoding (Sec. <a href="#S3.SS2" title="3.2 Question Hierarchy ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>); (b) Encoding for predicting answers (Sec. <a href="#S3.SS4" title="3.4 Encoding for Predicting Answers ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.4</span></a>).</figcaption>
</figure>
<div id="S3.SS4.p1" class="ltx_para ltx_noindent">
<p id="S3.SS4.p1.5" class="ltx_p">Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, we treat VQA as a classification task. We predict the answer based on the co-attended image and question features from all three levels. We use a multi-layer perceptron (MLP) to recursively encode the attention features as shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ 3.4 Encoding for Predicting Answers ‣ 3 Method ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(b).</p>
<table id="S3.E7" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E7X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{h}^{w}" display="inline"><semantics id="S3.E7X.2.1.1.m1.1a"><msup id="S3.E7X.2.1.1.m1.1.1" xref="S3.E7X.2.1.1.m1.1.1.cmml"><mi id="S3.E7X.2.1.1.m1.1.1.2" xref="S3.E7X.2.1.1.m1.1.1.2.cmml">𝒉</mi><mi id="S3.E7X.2.1.1.m1.1.1.3" xref="S3.E7X.2.1.1.m1.1.1.3.cmml">w</mi></msup><annotation-xml encoding="MathML-Content" id="S3.E7X.2.1.1.m1.1b"><apply id="S3.E7X.2.1.1.m1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E7X.2.1.1.m1.1.1.1.cmml" xref="S3.E7X.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E7X.2.1.1.m1.1.1.2.cmml" xref="S3.E7X.2.1.1.m1.1.1.2">𝒉</ci><ci id="S3.E7X.2.1.1.m1.1.1.3.cmml" xref="S3.E7X.2.1.1.m1.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.2.1.1.m1.1c">\displaystyle\bm{h}^{w}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\tanh(\bm{W}_{w}(\bm{\hat{q}^{w}}+\bm{\hat{v}^{w}}))" display="inline"><semantics id="S3.E7X.3.2.2.m1.2a"><mrow id="S3.E7X.3.2.2.m1.2.2" xref="S3.E7X.3.2.2.m1.2.2.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.3" xref="S3.E7X.3.2.2.m1.2.2.3.cmml"></mi><mo id="S3.E7X.3.2.2.m1.2.2.2" xref="S3.E7X.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.2.cmml"><mi id="S3.E7X.3.2.2.m1.1.1" xref="S3.E7X.3.2.2.m1.1.1.cmml">tanh</mi><mo id="S3.E7X.3.2.2.m1.2.2.1.1a" xref="S3.E7X.3.2.2.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E7X.3.2.2.m1.2.2.1.1.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.2.cmml">(</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.cmml"><msub id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.cmml">w</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml"><msup id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">𝒒</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">𝒘</mi></msup><mo id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.2" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml">𝒗</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.1" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">𝒘</mi></msup></mrow><mo stretchy="false" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E7X.3.2.2.m1.2.2.1.1.1.3" xref="S3.E7X.3.2.2.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7X.3.2.2.m1.2b"><apply id="S3.E7X.3.2.2.m1.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2"><eq id="S3.E7X.3.2.2.m1.2.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="S3.E7X.3.2.2.m1.2.2.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.3">absent</csymbol><apply id="S3.E7X.3.2.2.m1.2.2.1.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1"><tanh id="S3.E7X.3.2.2.m1.1.1.cmml" xref="S3.E7X.3.2.2.m1.1.1"></tanh><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1"><times id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.2"></times><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.2">𝑾</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.3.3">𝑤</ci></apply><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1"><plus id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.1"></plus><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2"><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.1">bold-^</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.2.2">𝒒</ci></apply><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.2.3">𝒘</ci></apply><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2"><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.1">bold-^</ci><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.2.2">𝒗</ci></apply><ci id="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7X.3.2.2.m1.2.2.1.1.1.1.1.1.1.3.3">𝒘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7X.3.2.2.m1.2c">\displaystyle=\tanh(\bm{W}_{w}(\bm{\hat{q}^{w}}+\bm{\hat{v}^{w}}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="4" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(7)</span></td>
</tr>
<tr id="S3.E7Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{h}^{p}" display="inline"><semantics id="S3.E7Xa.2.1.1.m1.1a"><msup id="S3.E7Xa.2.1.1.m1.1.1" xref="S3.E7Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E7Xa.2.1.1.m1.1.1.2" xref="S3.E7Xa.2.1.1.m1.1.1.2.cmml">𝒉</mi><mi id="S3.E7Xa.2.1.1.m1.1.1.3" xref="S3.E7Xa.2.1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S3.E7Xa.2.1.1.m1.1b"><apply id="S3.E7Xa.2.1.1.m1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E7Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E7Xa.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E7Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.2">𝒉</ci><ci id="S3.E7Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E7Xa.2.1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.2.1.1.m1.1c">\displaystyle\bm{h}^{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xa.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\tanh(\bm{W}_{p}[(\bm{\hat{q}^{p}}+\bm{\hat{v}^{p}}),\bm{h}^{w}])" display="inline"><semantics id="S3.E7Xa.3.2.2.m1.2a"><mrow id="S3.E7Xa.3.2.2.m1.2.2" xref="S3.E7Xa.3.2.2.m1.2.2.cmml"><mi id="S3.E7Xa.3.2.2.m1.2.2.3" xref="S3.E7Xa.3.2.2.m1.2.2.3.cmml"></mi><mo id="S3.E7Xa.3.2.2.m1.2.2.2" xref="S3.E7Xa.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.2.cmml"><mi id="S3.E7Xa.3.2.2.m1.1.1" xref="S3.E7Xa.3.2.2.m1.1.1.cmml">tanh</mi><mo id="S3.E7Xa.3.2.2.m1.2.2.1.1a" xref="S3.E7Xa.3.2.2.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.2.cmml">(</mo><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.cmml"><msub id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.cmml"><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.2.cmml">𝑾</mi><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.3.cmml">p</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.3.cmml">​</mo><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.3.cmml">[</mo><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒒</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">𝒑</mi></msup><mo id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒗</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">𝒑</mi></msup></mrow><mo stretchy="false" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.4" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.2" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.cmml">𝒉</mi><mi id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.3.cmml">w</mi></msup><mo stretchy="false" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.5" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.3" xref="S3.E7Xa.3.2.2.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xa.3.2.2.m1.2b"><apply id="S3.E7Xa.3.2.2.m1.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2"><eq id="S3.E7Xa.3.2.2.m1.2.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="S3.E7Xa.3.2.2.m1.2.2.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.3">absent</csymbol><apply id="S3.E7Xa.3.2.2.m1.2.2.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1"><tanh id="S3.E7Xa.3.2.2.m1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.1.1"></tanh><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1"><times id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.3"></times><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.2">𝑾</ci><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.4.3">𝑝</ci></apply><interval closure="closed" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2"><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1"><plus id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1">bold-^</ci><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">𝒒</ci></apply><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝒑</ci></apply><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1">bold-^</ci><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2">𝒗</ci></apply><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝒑</ci></apply></apply><apply id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.2">𝒉</ci><ci id="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E7Xa.3.2.2.m1.2.2.1.1.1.1.2.2.2.3">𝑤</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xa.3.2.2.m1.2c">\displaystyle=\tanh(\bm{W}_{p}[(\bm{\hat{q}^{p}}+\bm{\hat{v}^{p}}),\bm{h}^{w}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E7Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{h}^{s}" display="inline"><semantics id="S3.E7Xb.2.1.1.m1.1a"><msup id="S3.E7Xb.2.1.1.m1.1.1" xref="S3.E7Xb.2.1.1.m1.1.1.cmml"><mi id="S3.E7Xb.2.1.1.m1.1.1.2" xref="S3.E7Xb.2.1.1.m1.1.1.2.cmml">𝒉</mi><mi id="S3.E7Xb.2.1.1.m1.1.1.3" xref="S3.E7Xb.2.1.1.m1.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.E7Xb.2.1.1.m1.1b"><apply id="S3.E7Xb.2.1.1.m1.1.1.cmml" xref="S3.E7Xb.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E7Xb.2.1.1.m1.1.1.1.cmml" xref="S3.E7Xb.2.1.1.m1.1.1">superscript</csymbol><ci id="S3.E7Xb.2.1.1.m1.1.1.2.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.2">𝒉</ci><ci id="S3.E7Xb.2.1.1.m1.1.1.3.cmml" xref="S3.E7Xb.2.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xb.2.1.1.m1.1c">\displaystyle\bm{h}^{s}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xb.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle=\tanh(\bm{W}_{s}[(\bm{\hat{q}^{s}}+\bm{\hat{v}^{s}}),\bm{h}^{p}])" display="inline"><semantics id="S3.E7Xb.3.2.2.m1.2a"><mrow id="S3.E7Xb.3.2.2.m1.2.2" xref="S3.E7Xb.3.2.2.m1.2.2.cmml"><mi id="S3.E7Xb.3.2.2.m1.2.2.3" xref="S3.E7Xb.3.2.2.m1.2.2.3.cmml"></mi><mo id="S3.E7Xb.3.2.2.m1.2.2.2" xref="S3.E7Xb.3.2.2.m1.2.2.2.cmml">=</mo><mrow id="S3.E7Xb.3.2.2.m1.2.2.1.1" xref="S3.E7Xb.3.2.2.m1.2.2.1.2.cmml"><mi id="S3.E7Xb.3.2.2.m1.1.1" xref="S3.E7Xb.3.2.2.m1.1.1.cmml">tanh</mi><mo id="S3.E7Xb.3.2.2.m1.2.2.1.1a" xref="S3.E7Xb.3.2.2.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.E7Xb.3.2.2.m1.2.2.1.1.1" xref="S3.E7Xb.3.2.2.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.2.cmml">(</mo><mrow id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.cmml"><msub id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.cmml"><mi id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.2.cmml">𝑾</mi><mi id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.3" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.3" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.3.cmml">​</mo><mrow id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.3" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.3.cmml">[</mo><mrow id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msup id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝒒</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">𝒔</mi></msup><mo id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2.cmml">𝒗</mi><mo class="ltx_mathvariant_bold" mathvariant="bold" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">𝒔</mi></msup></mrow><mo stretchy="false" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.4" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.3.cmml">,</mo><msup id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.2" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.cmml">𝒉</mi><mi id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.3" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.3.cmml">p</mi></msup><mo stretchy="false" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.5" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.3.cmml">]</mo></mrow></mrow><mo stretchy="false" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.3" xref="S3.E7Xb.3.2.2.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xb.3.2.2.m1.2b"><apply id="S3.E7Xb.3.2.2.m1.2.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2"><eq id="S3.E7Xb.3.2.2.m1.2.2.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.2"></eq><csymbol cd="latexml" id="S3.E7Xb.3.2.2.m1.2.2.3.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.3">absent</csymbol><apply id="S3.E7Xb.3.2.2.m1.2.2.1.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1"><tanh id="S3.E7Xb.3.2.2.m1.1.1.cmml" xref="S3.E7Xb.3.2.2.m1.1.1"></tanh><apply id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1"><times id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.3.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.3"></times><apply id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.2">𝑾</ci><ci id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.3.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.4.3">𝑠</ci></apply><interval closure="closed" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.3.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2"><apply id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1"><plus id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2"><ci id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.1">bold-^</ci><ci id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.2">𝒒</ci></apply><ci id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝒔</ci></apply><apply id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2"><ci id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.1">bold-^</ci><ci id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.2">𝒗</ci></apply><ci id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.1.1.1.1.1.3.3">𝒔</ci></apply></apply><apply id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2">superscript</csymbol><ci id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.2">𝒉</ci><ci id="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S3.E7Xb.3.2.2.m1.2.2.1.1.1.1.2.2.2.3">𝑝</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xb.3.2.2.m1.2c">\displaystyle=\tanh(\bm{W}_{s}[(\bm{\hat{q}^{s}}+\bm{\hat{v}^{s}}),\bm{h}^{p}])</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E7Xc" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E7Xc.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\bm{p}" display="inline"><semantics id="S3.E7Xc.2.1.1.m1.1a"><mi id="S3.E7Xc.2.1.1.m1.1.1" xref="S3.E7Xc.2.1.1.m1.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.E7Xc.2.1.1.m1.1b"><ci id="S3.E7Xc.2.1.1.m1.1.1.cmml" xref="S3.E7Xc.2.1.1.m1.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xc.2.1.1.m1.1c">\displaystyle\bm{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E7Xc.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\textrm{softmax}(\bm{W}_{h}\bm{h}^{s})" display="inline"><semantics id="S3.E7Xc.3.2.2.m1.1a"><mrow id="S3.E7Xc.3.2.2.m1.1.1" xref="S3.E7Xc.3.2.2.m1.1.1.cmml"><mi id="S3.E7Xc.3.2.2.m1.1.1.3" xref="S3.E7Xc.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E7Xc.3.2.2.m1.1.1.2" xref="S3.E7Xc.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E7Xc.3.2.2.m1.1.1.1" xref="S3.E7Xc.3.2.2.m1.1.1.1.cmml"><mtext id="S3.E7Xc.3.2.2.m1.1.1.1.3" xref="S3.E7Xc.3.2.2.m1.1.1.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E7Xc.3.2.2.m1.1.1.1.2" xref="S3.E7Xc.3.2.2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E7Xc.3.2.2.m1.1.1.1.1.1" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.2" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.cmml"><msub id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.2" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.2.cmml">𝑾</mi><mi id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.3" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.3.cmml">h</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.1.cmml">​</mo><msup id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.2" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.2.cmml">𝒉</mi><mi id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.3" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.3.cmml">s</mi></msup></mrow><mo stretchy="false" id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.3" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7Xc.3.2.2.m1.1b"><apply id="S3.E7Xc.3.2.2.m1.1.1.cmml" xref="S3.E7Xc.3.2.2.m1.1.1"><eq id="S3.E7Xc.3.2.2.m1.1.1.2.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E7Xc.3.2.2.m1.1.1.3.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E7Xc.3.2.2.m1.1.1.1.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1"><times id="S3.E7Xc.3.2.2.m1.1.1.1.2.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.2"></times><ci id="S3.E7Xc.3.2.2.m1.1.1.1.3a.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.3"><mtext id="S3.E7Xc.3.2.2.m1.1.1.1.3.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.3">softmax</mtext></ci><apply id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1"><times id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.1"></times><apply id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.2">𝑾</ci><ci id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.2.3">ℎ</ci></apply><apply id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.2">𝒉</ci><ci id="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7Xc.3.2.2.m1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7Xc.3.2.2.m1.1c">\displaystyle=\textrm{softmax}(\bm{W}_{h}\bm{h}^{s})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S3.SS4.p1.4" class="ltx_p">where <math id="S3.SS4.p1.1.m1.3" class="ltx_Math" alttext="\bm{W}_{w},\bm{W}_{p},\bm{W}_{s}" display="inline"><semantics id="S3.SS4.p1.1.m1.3a"><mrow id="S3.SS4.p1.1.m1.3.3.3" xref="S3.SS4.p1.1.m1.3.3.4.cmml"><msub id="S3.SS4.p1.1.m1.1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.1.1.2.cmml">𝑾</mi><mi id="S3.SS4.p1.1.m1.1.1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.1.1.3.cmml">w</mi></msub><mo id="S3.SS4.p1.1.m1.3.3.3.4" xref="S3.SS4.p1.1.m1.3.3.4.cmml">,</mo><msub id="S3.SS4.p1.1.m1.2.2.2.2" xref="S3.SS4.p1.1.m1.2.2.2.2.cmml"><mi id="S3.SS4.p1.1.m1.2.2.2.2.2" xref="S3.SS4.p1.1.m1.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.SS4.p1.1.m1.2.2.2.2.3" xref="S3.SS4.p1.1.m1.2.2.2.2.3.cmml">p</mi></msub><mo id="S3.SS4.p1.1.m1.3.3.3.5" xref="S3.SS4.p1.1.m1.3.3.4.cmml">,</mo><msub id="S3.SS4.p1.1.m1.3.3.3.3" xref="S3.SS4.p1.1.m1.3.3.3.3.cmml"><mi id="S3.SS4.p1.1.m1.3.3.3.3.2" xref="S3.SS4.p1.1.m1.3.3.3.3.2.cmml">𝑾</mi><mi id="S3.SS4.p1.1.m1.3.3.3.3.3" xref="S3.SS4.p1.1.m1.3.3.3.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.3b"><list id="S3.SS4.p1.1.m1.3.3.4.cmml" xref="S3.SS4.p1.1.m1.3.3.3"><apply id="S3.SS4.p1.1.m1.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1.2">𝑾</ci><ci id="S3.SS4.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.1.1.3">𝑤</ci></apply><apply id="S3.SS4.p1.1.m1.2.2.2.2.cmml" xref="S3.SS4.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.2.2.2.2.1.cmml" xref="S3.SS4.p1.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.1.m1.2.2.2.2.2.cmml" xref="S3.SS4.p1.1.m1.2.2.2.2.2">𝑾</ci><ci id="S3.SS4.p1.1.m1.2.2.2.2.3.cmml" xref="S3.SS4.p1.1.m1.2.2.2.2.3">𝑝</ci></apply><apply id="S3.SS4.p1.1.m1.3.3.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.3.3.3.3.1.cmml" xref="S3.SS4.p1.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS4.p1.1.m1.3.3.3.3.2.cmml" xref="S3.SS4.p1.1.m1.3.3.3.3.2">𝑾</ci><ci id="S3.SS4.p1.1.m1.3.3.3.3.3.cmml" xref="S3.SS4.p1.1.m1.3.3.3.3.3">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.3c">\bm{W}_{w},\bm{W}_{p},\bm{W}_{s}</annotation></semantics></math> and <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="\bm{W}_{h}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">𝑾</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">𝑾</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">\bm{W}_{h}</annotation></semantics></math> are the weight parameters. <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="[\cdot]" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mrow id="S3.SS4.p1.3.m3.1.2.2" xref="S3.SS4.p1.3.m3.1.2.1.cmml"><mo stretchy="false" id="S3.SS4.p1.3.m3.1.2.2.1" xref="S3.SS4.p1.3.m3.1.2.1.1.cmml">[</mo><mo lspace="0em" rspace="0em" id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS4.p1.3.m3.1.2.2.2" xref="S3.SS4.p1.3.m3.1.2.1.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.2.1.cmml" xref="S3.SS4.p1.3.m3.1.2.2"><csymbol cd="latexml" id="S3.SS4.p1.3.m3.1.2.1.1.cmml" xref="S3.SS4.p1.3.m3.1.2.2.1">delimited-[]</csymbol><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">[\cdot]</annotation></semantics></math> is the concatenation operation on two vectors. <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="\bm{p}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mi id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml">𝒑</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><ci id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">𝒑</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\bm{p}</annotation></semantics></math> is the probability of the final answer.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiment</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p">We evaluate the proposed model on two datasets, the VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and the COCO-QA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">VQA</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> is the largest dataset for this problem, containing human annotated questions and answers on Microsoft COCO dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. The dataset contains 248,349 training questions, 121,512 validation questions, 244,302 testing questions, and a total of 6,141,630 question-answers pairs. There are three sub-categories according to answer-types including yes/no, number, and other. Each question has 10 free-response answers. We use the top 1000 most frequent answers as the possible outputs similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. This set of answers covers 86.54% of the train+val answers. For testing, we train our model on VQA train+val and report the test-dev and test-standard results from the VQA evaluation server. We use the evaluation protocol of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> in the experiment.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.4" class="ltx_p"><span id="S4.SS1.p3.4.1" class="ltx_text ltx_font_bold">COCO-QA</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> is automatically generated from captions in the Microsoft COCO dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. There are 78,736 train questions and 38,948 test questions in the dataset. These questions are based on 8,000 and 4,000 images respectively. There are four types of questions including object, number, color, and location. Each type takes <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="70\%" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mn id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">70</mn><mo id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">70\%</annotation></semantics></math>, <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="7\%" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mn id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">7</mn><mo id="S4.SS1.p3.2.m2.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="latexml" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">7\%</annotation></semantics></math>, <math id="S4.SS1.p3.3.m3.1" class="ltx_Math" alttext="17\%" display="inline"><semantics id="S4.SS1.p3.3.m3.1a"><mrow id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mn id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">17</mn><mo id="S4.SS1.p3.3.m3.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><csymbol cd="latexml" id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2">17</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">17\%</annotation></semantics></math>, and <math id="S4.SS1.p3.4.m4.1" class="ltx_Math" alttext="6\%" display="inline"><semantics id="S4.SS1.p3.4.m4.1a"><mrow id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mn id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">6</mn><mo id="S4.SS1.p3.4.m4.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><csymbol cd="latexml" id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p3.4.m4.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.2">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">6\%</annotation></semantics></math> of the whole dataset, respectively. All answers in this data set are single word. As in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, we report classification accuracy as well as Wu-Palmer similarity (WUPS) in Table 2.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Setup</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.3" class="ltx_p">We use Torch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> to develop our model. We use the Rmsprop optimizer with a base learning rate of 4e-4, momentum 0.99 and weight-decay 1e-8. We set batch size to be 300 and train for up to 256 epochs with early stopping if the validation accuracy has not improved in the last 5 epochs. For COCO-QA, the size of hidden layer <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\bm{W_{s}}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><msub id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">𝑾</mi><mi id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">𝒔</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">𝑾</ci><ci id="S4.SS2.p1.1.m1.1.1.3.cmml" xref="S4.SS2.p1.1.m1.1.1.3">𝒔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\bm{W_{s}}</annotation></semantics></math> is set to 512 and 1024 for VQA since it is a much larger dataset. All the other word embedding and hidden layers were vectors of size 512. We apply dropout with probability <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mn id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">0.5</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><cn type="float" id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">0.5</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">0.5</annotation></semantics></math> on each layer. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, we rescale the image to <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="448\times 448" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mn id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">448</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">×</mo><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">448</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><times id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></times><cn type="integer" id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">448</cn><cn type="integer" id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">448</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">448\times 448</annotation></semantics></math>, and then take the activation from the last pooling layer of VGGNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> or ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> as its feature.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results and Analysis</h3>

<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.2" class="ltx_p">There are two test scenarios on VQA: open-ended and multiple-choice. The best performing method <span id="S4.SS3.p1.2.1" class="ltx_text ltx_font_bold">deeper LSTM Q + norm I</span> from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> is used as our baseline. For open-ended test scenario, we compare our method with the recent proposed <span id="S4.SS3.p1.2.2" class="ltx_text ltx_font_bold">SMem</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, <span id="S4.SS3.p1.2.3" class="ltx_text ltx_font_bold">SAN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, <span id="S4.SS3.p1.2.4" class="ltx_text ltx_font_bold">FDA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and <span id="S4.SS3.p1.2.5" class="ltx_text ltx_font_bold">DMN+</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. For multiple choice, we compare with <span id="S4.SS3.p1.2.6" class="ltx_text ltx_font_bold">Region Sel.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> and <span id="S4.SS3.p1.2.7" class="ltx_text ltx_font_bold">FDA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. We compare with <span id="S4.SS3.p1.2.8" class="ltx_text ltx_font_bold">2-VIS+BLSTM</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, <span id="S4.SS3.p1.2.9" class="ltx_text ltx_font_bold">IMG-CNN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and <span id="S4.SS3.p1.2.10" class="ltx_text ltx_font_bold">SAN</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> on COCO-QA. We use <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{p}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msup id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mtext id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.2a.cmml" xref="S4.SS3.p1.1.m1.1.1.2"><mtext id="S4.SS3.p1.1.m1.1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.1.2">Ours</mtext></ci><ci id="S4.SS3.p1.1.m1.1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\textrm{Ours}^{p}</annotation></semantics></math> to refer to our parallel co-attention, <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msup id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mtext id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2a.cmml">Ours</mtext><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2a.cmml" xref="S4.SS3.p1.2.m2.1.1.2"><mtext id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">Ours</mtext></ci><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\textrm{Ours}^{a}</annotation></semantics></math> for alternating co-attention.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.3" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.3 Results and Analysis ‣ 4 Experiment ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows results on the VQA test sets for both open-ended and multiple-choice settings. We can see that our approach improves the state of art from 60.4% (DMN+ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>) to 62.1% (<math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><msup id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><mtext id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.2a.cmml" xref="S4.SS3.p2.1.m1.1.1.2"><mtext id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2">Ours</mtext></ci><ci id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">\textrm{Ours}^{a}</annotation></semantics></math>+ResNet) on open-ended and from 64.2% (FDA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>) to 66.1% (<math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><msup id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><mtext id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2a.cmml">Ours</mtext><mi id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><apply id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.2a.cmml" xref="S4.SS3.p2.2.m2.1.1.2"><mtext id="S4.SS3.p2.2.m2.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.2">Ours</mtext></ci><ci id="S4.SS3.p2.2.m2.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">\textrm{Ours}^{a}</annotation></semantics></math>+ResNet) on multiple-choice. Notably, for the question type <span id="S4.SS3.p2.3.1" class="ltx_text ltx_font_italic">Other</span> and <span id="S4.SS3.p2.3.2" class="ltx_text ltx_font_italic">Num</span>, we achieve 3.4% and 1.4% improvement on open-ended questions, and 4.0% and 1.1% on multiple-choice questions. As we can see, ResNet features outperform or match VGG features in all cases. Our improvements are not solely due to the use of a better CNN. Specifically, FDA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> also uses ResNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, but <math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><msup id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><mtext id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2a.cmml">Ours</mtext><mi id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.1b"><apply id="S4.SS3.p2.3.m3.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.p2.3.m3.1.1.2a.cmml" xref="S4.SS3.p2.3.m3.1.1.2"><mtext id="S4.SS3.p2.3.m3.1.1.2.cmml" xref="S4.SS3.p2.3.m3.1.1.2">Ours</mtext></ci><ci id="S4.SS3.p2.3.m3.1.1.3.cmml" xref="S4.SS3.p2.3.m3.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.1c">\textrm{Ours}^{a}</annotation></semantics></math>+ResNet outperforms it by 1.8% on test-dev. SMem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> uses GoogLeNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> and the rest all use VGGNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, and Ours+VGG outperforms them by 0.2% on test-dev (DMN+ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>).</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">Table <a href="#S4.T2" title="Table 2 ‣ 4.3 Results and Analysis ‣ 4 Experiment ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows results on the COCO-QA test set. Similar to the result on VQA, our model improves the state-of-the-art from 61.6% (SAN(2,CNN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>) to 65.4% (<math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><msup id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml"><mtext id="S4.SS3.p3.1.m1.1.1.2" xref="S4.SS3.p3.1.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.SS3.p3.1.m1.1.1.3" xref="S4.SS3.p3.1.m1.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><apply id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.1.m1.1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p3.1.m1.1.1.2a.cmml" xref="S4.SS3.p3.1.m1.1.1.2"><mtext id="S4.SS3.p3.1.m1.1.1.2.cmml" xref="S4.SS3.p3.1.m1.1.1.2">Ours</mtext></ci><ci id="S4.SS3.p3.1.m1.1.1.3.cmml" xref="S4.SS3.p3.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\textrm{Ours}^{a}</annotation></semantics></math>+ResNet). We observe that parallel co-attention performs better than alternating co-attention in this setup. Both attention mechanisms have their advantages and disadvantages: parallel co-attention is harder to train because of the dot product between image and text which compresses two vectors into a single value. On the other hand, alternating co-attention may suffer from errors being accumulated at each round.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Results on the VQA dataset. “-” indicates the results is not available.</figcaption>
<table id="S4.T1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.3.4.1" class="ltx_tr">
<th id="S4.T1.3.4.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;"></th>
<td id="S4.T1.3.4.1.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;" colspan="5">Open-Ended</td>
<td id="S4.T1.3.4.1.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;" colspan="5">Multiple-Choice</td>
</tr>
<tr id="S4.T1.3.5.2" class="ltx_tr">
<th id="S4.T1.3.5.2.1" class="ltx_td ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;"></th>
<td id="S4.T1.3.5.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;" colspan="4">test-dev</td>
<td id="S4.T1.3.5.2.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">test-std</td>
<td id="S4.T1.3.5.2.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;" colspan="4">test-dev</td>
<td id="S4.T1.3.5.2.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">test-std</td>
</tr>
<tr id="S4.T1.3.6.3" class="ltx_tr">
<th id="S4.T1.3.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;">Method</th>
<td id="S4.T1.3.6.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">Y/N</td>
<td id="S4.T1.3.6.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">Num</td>
<td id="S4.T1.3.6.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">Other</td>
<td id="S4.T1.3.6.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">All</td>
<td id="S4.T1.3.6.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">All</td>
<td id="S4.T1.3.6.3.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">Y/N</td>
<td id="S4.T1.3.6.3.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">Num</td>
<td id="S4.T1.3.6.3.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">Other</td>
<td id="S4.T1.3.6.3.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">All</td>
<td id="S4.T1.3.6.3.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">All</td>
</tr>
<tr id="S4.T1.3.7.4" class="ltx_tr">
<th id="S4.T1.3.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">LSTM Q+I <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>
</th>
<td id="S4.T1.3.7.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">80.5</td>
<td id="S4.T1.3.7.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">36.8</td>
<td id="S4.T1.3.7.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">43.0</td>
<td id="S4.T1.3.7.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">57.8</td>
<td id="S4.T1.3.7.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">58.2</td>
<td id="S4.T1.3.7.4.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">80.5</td>
<td id="S4.T1.3.7.4.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">38.2</td>
<td id="S4.T1.3.7.4.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">53.0</td>
<td id="S4.T1.3.7.4.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">62.7</td>
<td id="S4.T1.3.7.4.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">63.1</td>
</tr>
<tr id="S4.T1.3.8.5" class="ltx_tr">
<th id="S4.T1.3.8.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;">Region Sel. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>
</th>
<td id="S4.T1.3.8.5.2" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.8.5.3" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.8.5.4" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.8.5.5" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.8.5.6" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.8.5.7" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">77.6</td>
<td id="S4.T1.3.8.5.8" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">34.3</td>
<td id="S4.T1.3.8.5.9" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">55.8</td>
<td id="S4.T1.3.8.5.10" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">62.4</td>
<td id="S4.T1.3.8.5.11" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
</tr>
<tr id="S4.T1.3.9.6" class="ltx_tr">
<th id="S4.T1.3.9.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;">SMem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>
</th>
<td id="S4.T1.3.9.6.2" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">80.9</td>
<td id="S4.T1.3.9.6.3" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">37.3</td>
<td id="S4.T1.3.9.6.4" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">43.1</td>
<td id="S4.T1.3.9.6.5" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">58.0</td>
<td id="S4.T1.3.9.6.6" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">58.2</td>
<td id="S4.T1.3.9.6.7" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.9.6.8" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.9.6.9" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.9.6.10" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.9.6.11" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
</tr>
<tr id="S4.T1.3.10.7" class="ltx_tr">
<th id="S4.T1.3.10.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;">SAN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<td id="S4.T1.3.10.7.2" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">79.3</td>
<td id="S4.T1.3.10.7.3" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">36.6</td>
<td id="S4.T1.3.10.7.4" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">46.1</td>
<td id="S4.T1.3.10.7.5" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">58.7</td>
<td id="S4.T1.3.10.7.6" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">58.9</td>
<td id="S4.T1.3.10.7.7" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.10.7.8" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.10.7.9" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.10.7.10" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.10.7.11" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
</tr>
<tr id="S4.T1.3.11.8" class="ltx_tr">
<th id="S4.T1.3.11.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;">FDA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</th>
<td id="S4.T1.3.11.8.2" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.3.11.8.2.1" class="ltx_text ltx_font_bold">81.1</span></td>
<td id="S4.T1.3.11.8.3" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">36.2</td>
<td id="S4.T1.3.11.8.4" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">45.8</td>
<td id="S4.T1.3.11.8.5" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">59.2</td>
<td id="S4.T1.3.11.8.6" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">59.5</td>
<td id="S4.T1.3.11.8.7" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.3.11.8.7.1" class="ltx_text ltx_font_bold">81.5</span></td>
<td id="S4.T1.3.11.8.8" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">39.0</td>
<td id="S4.T1.3.11.8.9" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">54.7</td>
<td id="S4.T1.3.11.8.10" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">64.0</td>
<td id="S4.T1.3.11.8.11" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">64.2</td>
</tr>
<tr id="S4.T1.3.12.9" class="ltx_tr">
<th id="S4.T1.3.12.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;">DMN+ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</th>
<td id="S4.T1.3.12.9.2" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">80.5</td>
<td id="S4.T1.3.12.9.3" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">36.8</td>
<td id="S4.T1.3.12.9.4" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">48.3</td>
<td id="S4.T1.3.12.9.5" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">60.3</td>
<td id="S4.T1.3.12.9.6" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">60.4</td>
<td id="S4.T1.3.12.9.7" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.12.9.8" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.12.9.9" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.12.9.10" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.3.12.9.11" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
</tr>
<tr id="S4.T1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">
<math id="S4.T1.1.1.1.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{p}" display="inline"><semantics id="S4.T1.1.1.1.m1.1a"><msup id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml"><mtext id="S4.T1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.T1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">superscript</csymbol><ci id="S4.T1.1.1.1.m1.1.1.2a.cmml" xref="S4.T1.1.1.1.m1.1.1.2"><mtext id="S4.T1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.1.2">Ours</mtext></ci><ci id="S4.T1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">\textrm{Ours}^{p}</annotation></semantics></math>+VGG</th>
<td id="S4.T1.1.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">79.5</td>
<td id="S4.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.1.1.3.1" class="ltx_text ltx_font_bold">38.7</span></td>
<td id="S4.T1.1.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">48.3</td>
<td id="S4.T1.1.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">60.1</td>
<td id="S4.T1.1.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.1.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">79.5</td>
<td id="S4.T1.1.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">39.8</td>
<td id="S4.T1.1.1.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">57.4</td>
<td id="S4.T1.1.1.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">64.6</td>
<td id="S4.T1.1.1.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
</tr>
<tr id="S4.T1.2.2" class="ltx_tr">
<th id="S4.T1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;">
<math id="S4.T1.2.2.1.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.T1.2.2.1.m1.1a"><msup id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml"><mtext id="S4.T1.2.2.1.m1.1.1.2" xref="S4.T1.2.2.1.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.T1.2.2.1.m1.1.1.3" xref="S4.T1.2.2.1.m1.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><apply id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.2.2.1.m1.1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1">superscript</csymbol><ci id="S4.T1.2.2.1.m1.1.1.2a.cmml" xref="S4.T1.2.2.1.m1.1.1.2"><mtext id="S4.T1.2.2.1.m1.1.1.2.cmml" xref="S4.T1.2.2.1.m1.1.1.2">Ours</mtext></ci><ci id="S4.T1.2.2.1.m1.1.1.3.cmml" xref="S4.T1.2.2.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">\textrm{Ours}^{a}</annotation></semantics></math>+VGG</th>
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">79.6</td>
<td id="S4.T1.2.2.3" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">38.4</td>
<td id="S4.T1.2.2.4" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">49.1</td>
<td id="S4.T1.2.2.5" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">60.5</td>
<td id="S4.T1.2.2.6" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T1.2.2.7" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">79.7</td>
<td id="S4.T1.2.2.8" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.2.2.8.1" class="ltx_text ltx_font_bold">40.1</span></td>
<td id="S4.T1.2.2.9" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">57.9</td>
<td id="S4.T1.2.2.10" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">64.9</td>
<td id="S4.T1.2.2.11" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
</tr>
<tr id="S4.T1.3.3" class="ltx_tr">
<th id="S4.T1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;">
<math id="S4.T1.3.3.1.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.T1.3.3.1.m1.1a"><msup id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml"><mtext id="S4.T1.3.3.1.m1.1.1.2" xref="S4.T1.3.3.1.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.T1.3.3.1.m1.1.1.3" xref="S4.T1.3.3.1.m1.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><apply id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.3.3.1.m1.1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1">superscript</csymbol><ci id="S4.T1.3.3.1.m1.1.1.2a.cmml" xref="S4.T1.3.3.1.m1.1.1.2"><mtext id="S4.T1.3.3.1.m1.1.1.2.cmml" xref="S4.T1.3.3.1.m1.1.1.2">Ours</mtext></ci><ci id="S4.T1.3.3.1.m1.1.1.3.cmml" xref="S4.T1.3.3.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">\textrm{Ours}^{a}</annotation></semantics></math>+ResNet</th>
<td id="S4.T1.3.3.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;">79.7</td>
<td id="S4.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.3.3.3.1" class="ltx_text ltx_font_bold">38.7</span></td>
<td id="S4.T1.3.3.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.3.3.4.1" class="ltx_text ltx_font_bold">51.7</span></td>
<td id="S4.T1.3.3.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.3.3.5.1" class="ltx_text ltx_font_bold">61.8</span></td>
<td id="S4.T1.3.3.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.3.3.6.1" class="ltx_text ltx_font_bold">62.1</span></td>
<td id="S4.T1.3.3.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;">79.7</td>
<td id="S4.T1.3.3.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;">40.0</td>
<td id="S4.T1.3.3.9" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.3.3.9.1" class="ltx_text ltx_font_bold">59.8</span></td>
<td id="S4.T1.3.3.10" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.3.3.10.1" class="ltx_text ltx_font_bold">65.8</span></td>
<td id="S4.T1.3.3.11" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T1.3.3.11.1" class="ltx_text ltx_font_bold">66.1</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Results on the COCO-QA dataset. “-” indicates the results is not available.</figcaption>
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.3.4.1" class="ltx_tr">
<th id="S4.T2.3.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;">Method</th>
<th id="S4.T2.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;">Object</th>
<th id="S4.T2.3.4.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;">Number</th>
<th id="S4.T2.3.4.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;">Color</th>
<th id="S4.T2.3.4.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;">Location</th>
<th id="S4.T2.3.4.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;">Accuracy</th>
<th id="S4.T2.3.4.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;">WUPS0.9</th>
<th id="S4.T2.3.4.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:5.5pt;padding-right:5.5pt;">WUPS0.0</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.3.5.1" class="ltx_tr">
<th id="S4.T2.3.5.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">2-VIS+BLSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>
</th>
<td id="S4.T2.3.5.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">58.2</td>
<td id="S4.T2.3.5.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">44.8</td>
<td id="S4.T2.3.5.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">49.5</td>
<td id="S4.T2.3.5.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">47.3</td>
<td id="S4.T2.3.5.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">55.1</td>
<td id="S4.T2.3.5.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">65.3</td>
<td id="S4.T2.3.5.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">88.6</td>
</tr>
<tr id="S4.T2.3.6.2" class="ltx_tr">
<th id="S4.T2.3.6.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;">IMG-CNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>
</th>
<td id="S4.T2.3.6.2.2" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T2.3.6.2.3" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T2.3.6.2.4" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T2.3.6.2.5" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">-</td>
<td id="S4.T2.3.6.2.6" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">58.4</td>
<td id="S4.T2.3.6.2.7" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">68.5</td>
<td id="S4.T2.3.6.2.8" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">89.7</td>
</tr>
<tr id="S4.T2.3.7.3" class="ltx_tr">
<th id="S4.T2.3.7.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;">SAN(2, CNN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>
</th>
<td id="S4.T2.3.7.3.2" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">64.5</td>
<td id="S4.T2.3.7.3.3" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">48.6</td>
<td id="S4.T2.3.7.3.4" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">57.9</td>
<td id="S4.T2.3.7.3.5" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">54.0</td>
<td id="S4.T2.3.7.3.6" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">61.6</td>
<td id="S4.T2.3.7.3.7" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">71.6</td>
<td id="S4.T2.3.7.3.8" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">90.9</td>
</tr>
<tr id="S4.T2.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">
<math id="S4.T2.1.1.1.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{p}" display="inline"><semantics id="S4.T2.1.1.1.m1.1a"><msup id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml"><mtext id="S4.T2.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.T2.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">superscript</csymbol><ci id="S4.T2.1.1.1.m1.1.1.2a.cmml" xref="S4.T2.1.1.1.m1.1.1.2"><mtext id="S4.T2.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.m1.1.1.2">Ours</mtext></ci><ci id="S4.T2.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\textrm{Ours}^{p}</annotation></semantics></math>+VGG</th>
<td id="S4.T2.1.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">65.6</td>
<td id="S4.T2.1.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">49.6</td>
<td id="S4.T2.1.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">61.5</td>
<td id="S4.T2.1.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">56.8</td>
<td id="S4.T2.1.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">63.3</td>
<td id="S4.T2.1.1.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">73.0</td>
<td id="S4.T2.1.1.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:5.5pt;padding-right:5.5pt;">91.3</td>
</tr>
<tr id="S4.T2.2.2" class="ltx_tr">
<th id="S4.T2.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:5.5pt;padding-right:5.5pt;">
<math id="S4.T2.2.2.1.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.T2.2.2.1.m1.1a"><msup id="S4.T2.2.2.1.m1.1.1" xref="S4.T2.2.2.1.m1.1.1.cmml"><mtext id="S4.T2.2.2.1.m1.1.1.2" xref="S4.T2.2.2.1.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.T2.2.2.1.m1.1.1.3" xref="S4.T2.2.2.1.m1.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><apply id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1">superscript</csymbol><ci id="S4.T2.2.2.1.m1.1.1.2a.cmml" xref="S4.T2.2.2.1.m1.1.1.2"><mtext id="S4.T2.2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.2.1.m1.1.1.2">Ours</mtext></ci><ci id="S4.T2.2.2.1.m1.1.1.3.cmml" xref="S4.T2.2.2.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">\textrm{Ours}^{a}</annotation></semantics></math>+VGG</th>
<td id="S4.T2.2.2.2" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">65.6</td>
<td id="S4.T2.2.2.3" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">48.9</td>
<td id="S4.T2.2.2.4" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">59.8</td>
<td id="S4.T2.2.2.5" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">56.7</td>
<td id="S4.T2.2.2.6" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">62.9</td>
<td id="S4.T2.2.2.7" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">72.8</td>
<td id="S4.T2.2.2.8" class="ltx_td ltx_align_center" style="padding-left:5.5pt;padding-right:5.5pt;">91.3</td>
</tr>
<tr id="S4.T2.3.3" class="ltx_tr">
<th id="S4.T2.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;">
<math id="S4.T2.3.3.1.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.T2.3.3.1.m1.1a"><msup id="S4.T2.3.3.1.m1.1.1" xref="S4.T2.3.3.1.m1.1.1.cmml"><mtext id="S4.T2.3.3.1.m1.1.1.2" xref="S4.T2.3.3.1.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.T2.3.3.1.m1.1.1.3" xref="S4.T2.3.3.1.m1.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.m1.1b"><apply id="S4.T2.3.3.1.m1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.3.3.1.m1.1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1">superscript</csymbol><ci id="S4.T2.3.3.1.m1.1.1.2a.cmml" xref="S4.T2.3.3.1.m1.1.1.2"><mtext id="S4.T2.3.3.1.m1.1.1.2.cmml" xref="S4.T2.3.3.1.m1.1.1.2">Ours</mtext></ci><ci id="S4.T2.3.3.1.m1.1.1.3.cmml" xref="S4.T2.3.3.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.1.m1.1c">\textrm{Ours}^{a}</annotation></semantics></math>+ResNet</th>
<td id="S4.T2.3.3.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T2.3.3.2.1" class="ltx_text ltx_font_bold">68.0</span></td>
<td id="S4.T2.3.3.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T2.3.3.3.1" class="ltx_text ltx_font_bold">51.0</span></td>
<td id="S4.T2.3.3.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T2.3.3.4.1" class="ltx_text ltx_font_bold">62.9</span></td>
<td id="S4.T2.3.3.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T2.3.3.5.1" class="ltx_text ltx_font_bold">58.8</span></td>
<td id="S4.T2.3.3.6" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T2.3.3.6.1" class="ltx_text ltx_font_bold">65.4</span></td>
<td id="S4.T2.3.3.7" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T2.3.3.7.1" class="ltx_text ltx_font_bold">75.1</span></td>
<td id="S4.T2.3.3.8" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:5.5pt;padding-right:5.5pt;"><span id="S4.T2.3.3.8.1" class="ltx_text ltx_font_bold">92.0</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Ablation Study</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p">In this section, we perform ablation studies to quantify the role of each component in our model. Specifically, we re-train our approach by ablating certain components:</p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.1" class="ltx_p"><em id="S4.I1.i1.p1.1.1" class="ltx_emph ltx_font_italic">Image Attention alone</em>, where in a manner similar to previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, we do not use any question attention. The goal of this comparison is to verify that our improvements are not the result of orthogonal contributions. (say better optimization or better CNN features).</p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.1" class="ltx_p"><em id="S4.I1.i2.p1.1.1" class="ltx_emph ltx_font_italic">Question Attention alone</em>, where no image attention is performed.</p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.1" class="ltx_p"><em id="S4.I1.i3.p1.1.1" class="ltx_emph ltx_font_italic">W/O Conv</em>, where no convolution and pooling is performed to represent phrases. Instead, we stack another word embedding layer on the top of word level outputs.</p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.1" class="ltx_p"><em id="S4.I1.i4.p1.1.1" class="ltx_emph ltx_font_italic">W/O W-Atten</em>, where no word level co-attention is performed. We replace the word level attention with a uniform distribution. Phrase and question level co-attentions are still modeled.</p>
</div>
</li>
<li id="S4.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i5.p1" class="ltx_para">
<p id="S4.I1.i5.p1.1" class="ltx_p"><em id="S4.I1.i5.p1.1.1" class="ltx_emph ltx_font_italic">W/O P-Atten</em>, where no phrase level co-attention is performed, and the phrase level attention is set to be uniform. Word and question level co-attentions are still modeled.</p>
</div>
</li>
<li id="S4.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i6.p1" class="ltx_para ltx_noindent">
<p id="S4.I1.i6.p1.1" class="ltx_p"><em id="S4.I1.i6.p1.1.1" class="ltx_emph ltx_font_italic">W/O Q-Atten</em>, where no question level co-attention is performed. We replace the question level attention with a uniform distribution. Word and phrase level co-attentions are still modeled.</p>
</div>
</li>
</ul>
</div>
<div id="S4.SS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.p2.1" class="ltx_p">Table <a href="#S4.T3" title="Table 3 ‣ 4.4 Ablation Study ‣ 4 Experiment ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the comparison of our full approach w.r.t these ablations on the VQA validation set (test sets are not recommended to be used for such experiments). The <span id="S4.SS4.p2.1.1" class="ltx_text ltx_font_bold">deeper LSTM Q + norm I</span> baseline in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> is also reported for comparison. We can see that image-attention-alone does improve performance over the holistic image feature (<span id="S4.SS4.p2.1.2" class="ltx_text ltx_font_bold">deeper LSTM Q + norm I</span>), which is consistent with findings of previous attention models for VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.</p>
</div>
<figure id="S4.T3" class="ltx_table ltx_figure_panel ltx_align_floatright">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Ablation study on the VQA dataset using <math id="S4.T3.2.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.T3.2.m1.1b"><msup id="S4.T3.2.m1.1.1" xref="S4.T3.2.m1.1.1.cmml"><mtext id="S4.T3.2.m1.1.1.2" xref="S4.T3.2.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.T3.2.m1.1.1.3" xref="S4.T3.2.m1.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.1c"><apply id="S4.T3.2.m1.1.1.cmml" xref="S4.T3.2.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.2.m1.1.1.1.cmml" xref="S4.T3.2.m1.1.1">superscript</csymbol><ci id="S4.T3.2.m1.1.1.2a.cmml" xref="S4.T3.2.m1.1.1.2"><mtext id="S4.T3.2.m1.1.1.2.cmml" xref="S4.T3.2.m1.1.1.2">Ours</mtext></ci><ci id="S4.T3.2.m1.1.1.3.cmml" xref="S4.T3.2.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.1d">\textrm{Ours}^{a}</annotation></semantics></math>+VGG.</figcaption>
<table id="S4.T3.3" class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.3.1.1" class="ltx_tr">
<th id="S4.T3.3.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S4.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4">validation</th>
</tr>
<tr id="S4.T3.3.2.2" class="ltx_tr">
<th id="S4.T3.3.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row">Method</th>
<th id="S4.T3.3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Y/N</th>
<th id="S4.T3.3.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Num</th>
<th id="S4.T3.3.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Other</th>
<th id="S4.T3.3.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">All</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.3.3.1" class="ltx_tr">
<th id="S4.T3.3.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">LSTM Q+I</th>
<td id="S4.T3.3.3.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T3.3.3.1.2.1" class="ltx_text ltx_font_bold">79.8</span></td>
<td id="S4.T3.3.3.1.3" class="ltx_td ltx_align_center ltx_border_t">32.9</td>
<td id="S4.T3.3.3.1.4" class="ltx_td ltx_align_center ltx_border_t">40.7</td>
<td id="S4.T3.3.3.1.5" class="ltx_td ltx_align_center ltx_border_t">54.3</td>
</tr>
<tr id="S4.T3.3.4.2" class="ltx_tr">
<th id="S4.T3.3.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Image Atten</th>
<td id="S4.T3.3.4.2.2" class="ltx_td ltx_align_center">79.8</td>
<td id="S4.T3.3.4.2.3" class="ltx_td ltx_align_center">33.9</td>
<td id="S4.T3.3.4.2.4" class="ltx_td ltx_align_center">43.6</td>
<td id="S4.T3.3.4.2.5" class="ltx_td ltx_align_center">55.9</td>
</tr>
<tr id="S4.T3.3.5.3" class="ltx_tr">
<th id="S4.T3.3.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Question Atten</th>
<td id="S4.T3.3.5.3.2" class="ltx_td ltx_align_center">79.4</td>
<td id="S4.T3.3.5.3.3" class="ltx_td ltx_align_center">33.3</td>
<td id="S4.T3.3.5.3.4" class="ltx_td ltx_align_center">41.7</td>
<td id="S4.T3.3.5.3.5" class="ltx_td ltx_align_center">54.8</td>
</tr>
<tr id="S4.T3.3.6.4" class="ltx_tr">
<th id="S4.T3.3.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">W/O Q-Atten</th>
<td id="S4.T3.3.6.4.2" class="ltx_td ltx_align_center">79.6</td>
<td id="S4.T3.3.6.4.3" class="ltx_td ltx_align_center">32.1</td>
<td id="S4.T3.3.6.4.4" class="ltx_td ltx_align_center">42.9</td>
<td id="S4.T3.3.6.4.5" class="ltx_td ltx_align_center">55.3</td>
</tr>
<tr id="S4.T3.3.7.5" class="ltx_tr">
<th id="S4.T3.3.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">W/O P-Atten</th>
<td id="S4.T3.3.7.5.2" class="ltx_td ltx_align_center">79.5</td>
<td id="S4.T3.3.7.5.3" class="ltx_td ltx_align_center">34.1</td>
<td id="S4.T3.3.7.5.4" class="ltx_td ltx_align_center">45.4</td>
<td id="S4.T3.3.7.5.5" class="ltx_td ltx_align_center">56.7</td>
</tr>
<tr id="S4.T3.3.8.6" class="ltx_tr">
<th id="S4.T3.3.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">W/O W-Atten</th>
<td id="S4.T3.3.8.6.2" class="ltx_td ltx_align_center">79.6</td>
<td id="S4.T3.3.8.6.3" class="ltx_td ltx_align_center">34.4</td>
<td id="S4.T3.3.8.6.4" class="ltx_td ltx_align_center">45.6</td>
<td id="S4.T3.3.8.6.5" class="ltx_td ltx_align_center">56.8</td>
</tr>
<tr id="S4.T3.3.9.7" class="ltx_tr">
<th id="S4.T3.3.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Full Model</th>
<td id="S4.T3.3.9.7.2" class="ltx_td ltx_align_center ltx_border_bb">79.6</td>
<td id="S4.T3.3.9.7.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.3.9.7.3.1" class="ltx_text ltx_font_bold">35.0</span></td>
<td id="S4.T3.3.9.7.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.3.9.7.4.1" class="ltx_text ltx_font_bold">45.7</span></td>
<td id="S4.T3.3.9.7.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T3.3.9.7.5.1" class="ltx_text ltx_font_bold">57.0</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS4.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.p3.1" class="ltx_p">Comparing the full model w.r.t.<span id="S4.SS4.p3.1.1" class="ltx_text"></span> ablated versions without word, phrase, question level attentions reveals a clear interesting trend – the attention mechanisms closest to the ‘top’ of the hierarchy (<em id="S4.SS4.p3.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS4.p3.1.3" class="ltx_text"></span> question) matter most, with a drop of 1.7% in accuracy if not modeled; followed by the intermediate level (<em id="S4.SS4.p3.1.4" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS4.p3.1.5" class="ltx_text"></span> phrase), with a drop of 0.3%; finally followed by the ‘bottom’ of the hierarchy (<em id="S4.SS4.p3.1.6" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS4.p3.1.7" class="ltx_text"></span> word), with a drop of 0.2% in accuracy. We hypothesize that this is because the question level is the ‘closest’ to the answer prediction layers in our model. Note that <em id="S4.SS4.p3.1.8" class="ltx_emph ltx_font_italic">all</em> levels are important, and our final model significantly outperforms not using any linguistic attention (1.1% difference between Full Model and Image Atten). The question attention alone model is better than LSTM Q+I, with an improvement of 0.5% and worse than image attention alone, with a drop of 1.1%. <math id="S4.SS4.p3.1.m1.1" class="ltx_Math" alttext="\textrm{Ours}^{a}" display="inline"><semantics id="S4.SS4.p3.1.m1.1a"><msup id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mtext id="S4.SS4.p3.1.m1.1.1.2" xref="S4.SS4.p3.1.m1.1.1.2a.cmml">Ours</mtext><mi id="S4.SS4.p3.1.m1.1.1.3" xref="S4.SS4.p3.1.m1.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">superscript</csymbol><ci id="S4.SS4.p3.1.m1.1.1.2a.cmml" xref="S4.SS4.p3.1.m1.1.1.2"><mtext id="S4.SS4.p3.1.m1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.1.2">Ours</mtext></ci><ci id="S4.SS4.p3.1.m1.1.1.3.cmml" xref="S4.SS4.p3.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">\textrm{Ours}^{a}</annotation></semantics></math> further improves if we performed alternating co-attention for one more round, with an improvement of 0.3%.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5 </span>Qualitative Results</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">We now visualize some co-attention maps generated by our method in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.5 Qualitative Results ‣ 4 Experiment ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. At the word level, our model attends mostly to the object regions in an image, e.g., heads, bird. At the phrase level, the image attention has different patterns across images. For the first two images, the attention transfers from objects to background regions. For the third image, the attention becomes more focused on the objects. We suspect that this is caused by the different question types. On the question side, our model is capable of localizing the key phrases in the question, thus essentially discovering the question types in the dataset. For example, our model pays attention to the phrases “what color” and “how many snowboarders”. Our model successfully attends to the regions in images and phrases in the questions appropriate for answering the question, e.g., “color of the bird” and bird region. Because our model performs co-attention at three levels, it often captures complementary information from each level, and then combines them to predict the answer.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x4.jpg" id="S4.F4.1.g1" class="ltx_graphics ltx_img_square" width="664" height="664" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x5.jpg" id="S4.F4.2.g1" class="ltx_graphics ltx_img_square" width="664" height="664" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x6.jpg" id="S4.F4.3.g1" class="ltx_graphics ltx_img_square" width="664" height="664" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x7.jpg" id="S4.F4.4.g1" class="ltx_graphics ltx_img_square" width="664" height="664" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.13" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.13.1" class="ltx_p ltx_align_center"><span id="S4.F4.13.1.1" class="ltx_text ltx_font_bold">Q</span>: what is the man holding a snowboard on top of a snow covered? <span id="S4.F4.13.1.2" class="ltx_text ltx_font_bold">A</span>: <span id="S4.F4.13.1.3" class="ltx_text ltx_font_bold">mountain</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.14" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.14.1" class="ltx_p ltx_align_center"><span id="S4.F4.14.1.1" class="ltx_text" style="color:#0068FF;">what<span id="S4.F4.14.1.1.1" class="ltx_text" style="color:#000000;">
<span id="S4.F4.14.1.1.1.1" class="ltx_text" style="color:#0068FF;">is</span></span></span>
<span id="S4.F4.14.1.2" class="ltx_text" style="color:#0064FF;">the</span>
<span id="S4.F4.14.1.3" class="ltx_text" style="color:#005CFF;">man</span>
<span id="S4.F4.14.1.4" class="ltx_text" style="color:#0059FF;">holding</span>
<span id="S4.F4.14.1.5" class="ltx_text" style="color:#0059FF;">a</span>
<span id="S4.F4.14.1.6" class="ltx_text" style="color:#4DFFAA;">snowboard</span>
<span id="S4.F4.14.1.7" class="ltx_text" style="color:#004DFF;">on</span>
<span id="S4.F4.14.1.8" class="ltx_text" style="color:#09F0EE;">top</span>
<span id="S4.F4.14.1.9" class="ltx_text" style="color:#0075FF;">of</span>
<span id="S4.F4.14.1.10" class="ltx_text" style="color:#0059FF;">a</span>
<span id="S4.F4.14.1.11" class="ltx_text" style="color:#00D0FF;">snow</span>
<span id="S4.F4.14.1.12" class="ltx_text" style="color:#09F0EE;">covered</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.15" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.15.1" class="ltx_p ltx_align_center"><span id="S4.F4.15.1.1" class="ltx_text" style="color:#005CFF;">what<span id="S4.F4.15.1.1.1" class="ltx_text" style="color:#000000;">
<span id="S4.F4.15.1.1.1.1" class="ltx_text" style="color:#0060FF;">is</span></span></span>
<span id="S4.F4.15.1.2" class="ltx_text" style="color:#005CFF;">the</span>
<span id="S4.F4.15.1.3" class="ltx_text" style="color:#0068FF;">man</span>
<span id="S4.F4.15.1.4" class="ltx_text" style="color:#00A9FF;">holding</span>
<span id="S4.F4.15.1.5" class="ltx_text" style="color:#0078FF;">a</span>
<span id="S4.F4.15.1.6" class="ltx_text" style="color:#00D4FF;">snowboard</span>
<span id="S4.F4.15.1.7" class="ltx_text" style="color:#00B4FF;">on</span>
<span id="S4.F4.15.1.8" class="ltx_text" style="color:#00A0FF;">top</span>
<span id="S4.F4.15.1.9" class="ltx_text" style="color:#0071FF;">of</span>
<span id="S4.F4.15.1.10" class="ltx_text" style="color:#0060FF;">a</span>
<span id="S4.F4.15.1.11" class="ltx_text" style="color:#00A9FF;">snow</span>
<span id="S4.F4.15.1.12" class="ltx_text" style="color:#02E9F4;">covered</span>
<span id="S4.F4.15.1.13" class="ltx_text" style="color:#0078FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.16" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.16.1" class="ltx_p ltx_align_center"><span id="S4.F4.16.1.1" class="ltx_text" style="color:#00A0FF;">what<span id="S4.F4.16.1.1.1" class="ltx_text" style="color:#000000;">
<span id="S4.F4.16.1.1.1.1" class="ltx_text" style="color:#009CFF;">is</span></span></span>
<span id="S4.F4.16.1.2" class="ltx_text" style="color:#0089FF;">the</span>
<span id="S4.F4.16.1.3" class="ltx_text" style="color:#0075FF;">man</span>
<span id="S4.F4.16.1.4" class="ltx_text" style="color:#008DFF;">holding</span>
<span id="S4.F4.16.1.5" class="ltx_text" style="color:#0078FF;">a</span>
<span id="S4.F4.16.1.6" class="ltx_text" style="color:#008DFF;">snowboard</span>
<span id="S4.F4.16.1.7" class="ltx_text" style="color:#008DFF;">on</span>
<span id="S4.F4.16.1.8" class="ltx_text" style="color:#0091FF;">top</span>
<span id="S4.F4.16.1.9" class="ltx_text" style="color:#0095FF;">of</span>
<span id="S4.F4.16.1.10" class="ltx_text" style="color:#0098FF;">a</span>
<span id="S4.F4.16.1.11" class="ltx_text" style="color:#0095FF;">snow</span>
<span id="S4.F4.16.1.12" class="ltx_text" style="color:#008DFF;">covered</span>
<span id="S4.F4.16.1.13" class="ltx_text" style="color:#00A0FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.5" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x8.jpg" id="S4.F4.5.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.6" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x9.jpg" id="S4.F4.6.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.7" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x10.jpg" id="S4.F4.7.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.8" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x11.jpg" id="S4.F4.8.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S4.F4.17" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;"><span id="S4.F4.17.1" class="ltx_text ltx_font_bold">Q</span>: what is the color of the bird? <span id="S4.F4.17.2" class="ltx_text ltx_font_bold">A</span>: <span id="S4.F4.17.3" class="ltx_text ltx_font_bold">white</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.F4.18" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.18.1" class="ltx_p ltx_align_center"><span id="S4.F4.18.1.1" class="ltx_text" style="color:#00ADFF;">what</span>
<span id="S4.F4.18.1.2" class="ltx_text" style="color:#00C0FF;">is</span>
<span id="S4.F4.18.1.3" class="ltx_text" style="color:#00C5FF;">the</span>
<span id="S4.F4.18.1.4" class="ltx_text" style="color:#C4FF3A;">color</span>
<span id="S4.F4.18.1.5" class="ltx_text" style="color:#00B1FF;">of</span>
<span id="S4.F4.18.1.6" class="ltx_text" style="color:#00C5FF;">the</span>
<span id="S4.F4.18.1.7" class="ltx_text" style="color:#00A5FF;">bird</span>
<span id="S4.F4.18.1.8" class="ltx_text" style="color:#00B8FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.F4.19" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.19.1" class="ltx_p ltx_align_center"><span id="S4.F4.19.1.1" class="ltx_text" style="color:#0000F6;">what</span>
<span id="S4.F4.19.1.2" class="ltx_text" style="color:#0000F1;">is</span>
<span id="S4.F4.19.1.3" class="ltx_text" style="color:#0000F6;">the</span>
<span id="S4.F4.19.1.4" class="ltx_text" style="color:#A80000;">color</span>
<span id="S4.F4.19.1.5" class="ltx_text" style="color:#0000F6;">of</span>
<span id="S4.F4.19.1.6" class="ltx_text" style="color:#0000F1;">the</span>
<span id="S4.F4.19.1.7" class="ltx_text" style="color:#0000F6;">bird</span>
<span id="S4.F4.19.1.8" class="ltx_text" style="color:#0000F6;">?</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S4.F4.20" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.20.1" class="ltx_p ltx_align_center"><span id="S4.F4.20.1.1" class="ltx_text" style="color:#0000B6;">what</span>
<span id="S4.F4.20.1.2" class="ltx_text" style="color:#0000B6;">is</span>
<span id="S4.F4.20.1.3" class="ltx_text" style="color:#0000B6;">the</span>
<span id="S4.F4.20.1.4" class="ltx_text" style="color:#56FFA0;">color</span>
<span id="S4.F4.20.1.5" class="ltx_text" style="color:#56FFA0;">of</span>
<span id="S4.F4.20.1.6" class="ltx_text" style="color:#40FFB7;">the</span>
<span id="S4.F4.20.1.7" class="ltx_text" style="color:#49FFAD;">bird</span>
<span id="S4.F4.20.1.8" class="ltx_text" style="color:#53FFA4;">?</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.9" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x12.jpg" id="S4.F4.9.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.10" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x13.jpg" id="S4.F4.10.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.11" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x14.jpg" id="S4.F4.11.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.12" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<img src="/html/1606.00061/assets/x15.jpg" id="S4.F4.12.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.21" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.21.1" class="ltx_p ltx_align_center"><span id="S4.F4.21.1.1" class="ltx_text ltx_font_bold">Q</span>: how many snowboarders in formation in the snow, four is sitting? <span id="S4.F4.21.1.2" class="ltx_text ltx_font_bold">A</span>: <span id="S4.F4.21.1.3" class="ltx_text ltx_font_bold">5</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.22" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.22.1" class="ltx_p ltx_align_center"><span id="S4.F4.22.1.1" class="ltx_text" style="color:#19FFDE;">how</span>
<span id="S4.F4.22.1.2" class="ltx_text" style="color:#0089FF;">many</span>
<span id="S4.F4.22.1.3" class="ltx_text" style="color:#50FFA7;">snowboarders</span>
<span id="S4.F4.22.1.4" class="ltx_text" style="color:#0024FF;">in</span>
<span id="S4.F4.22.1.5" class="ltx_text" style="color:#0071FF;">formation</span>
<span id="S4.F4.22.1.6" class="ltx_text" style="color:#0024FF;">in</span>
<span id="S4.F4.22.1.7" class="ltx_text" style="color:#0060FF;">the</span>
<span id="S4.F4.22.1.8" class="ltx_text" style="color:#0FF8E7;">snow</span>
<span id="S4.F4.22.1.9" class="ltx_text" style="color:#002CFF;">,</span>
<span id="S4.F4.22.1.10" class="ltx_text" style="color:#003DFF;">four</span>
<span id="S4.F4.22.1.11" class="ltx_text" style="color:#002CFF;">is</span>
<span id="S4.F4.22.1.12" class="ltx_text" style="color:#3AFFC4;">sitting</span>
<span id="S4.F4.22.1.13" class="ltx_text" style="color:#003AFF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.23" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.23.1" class="ltx_p ltx_align_center"><span id="S4.F4.23.1.1" class="ltx_text" style="color:#0CF4EB;">how</span>
<span id="S4.F4.23.1.2" class="ltx_text" style="color:#FF9800;">many</span>
<span id="S4.F4.23.1.3" class="ltx_text" style="color:#00B1FF;">snowboarders</span>
<span id="S4.F4.23.1.4" class="ltx_text" style="color:#0000FF;">in</span>
<span id="S4.F4.23.1.5" class="ltx_text" style="color:#0000F6;">formation</span>
<span id="S4.F4.23.1.6" class="ltx_text" style="color:#0000FA;">in</span>
<span id="S4.F4.23.1.7" class="ltx_text" style="color:#0000F6;">the</span>
<span id="S4.F4.23.1.8" class="ltx_text" style="color:#0084FF;">snow</span>
<span id="S4.F4.23.1.9" class="ltx_text" style="color:#0048FF;">,</span>
<span id="S4.F4.23.1.10" class="ltx_text" style="color:#0028FF;">four</span>
<span id="S4.F4.23.1.11" class="ltx_text" style="color:#0000FA;">is</span>
<span id="S4.F4.23.1.12" class="ltx_text" style="color:#0008FF;">sitting</span>
<span id="S4.F4.23.1.13" class="ltx_text" style="color:#0000F1;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.24" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:95.4pt;">
<p id="S4.F4.24.1" class="ltx_p ltx_align_center"><span id="S4.F4.24.1.1" class="ltx_text" style="color:#00A0FF;">how</span>
<span id="S4.F4.24.1.2" class="ltx_text" style="color:#009CFF;">many</span>
<span id="S4.F4.24.1.3" class="ltx_text" style="color:#009CFF;">snowboarders</span>
<span id="S4.F4.24.1.4" class="ltx_text" style="color:#009CFF;">in</span>
<span id="S4.F4.24.1.5" class="ltx_text" style="color:#0091FF;">formation</span>
<span id="S4.F4.24.1.6" class="ltx_text" style="color:#0091FF;">in</span>
<span id="S4.F4.24.1.7" class="ltx_text" style="color:#0098FF;">the</span>
<span id="S4.F4.24.1.8" class="ltx_text" style="color:#009CFF;">snow</span>
<span id="S4.F4.24.1.9" class="ltx_text" style="color:#009CFF;">,</span>
<span id="S4.F4.24.1.10" class="ltx_text" style="color:#009CFF;">four</span>
<span id="S4.F4.24.1.11" class="ltx_text" style="color:#0091FF;">is</span>
<span id="S4.F4.24.1.12" class="ltx_text" style="color:#009CFF;">sitting</span>
<span id="S4.F4.24.1.13" class="ltx_text" style="color:#0098FF;">?</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Visualization of image and question co-attention maps on the COCO-QA dataset. From left to right: original image and question pairs, word level co-attention maps, phrase level co-attention maps and question level co-attention maps. For visualization, both image and question attentions are scaled (from red:high to blue:low). Best viewed in color.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In this paper, we proposed a hierarchical co-attention model for visual question answering. Co-attention allows our model to attend to different regions of the image as well as different fragments of the question. We model the question hierarchically at three levels to capture information from different granularities. The ablation studies further demonstrate the roles of co-attention and question hierarchy in our final performance. Through visualizations, we can see that our model co-attends to interpretable regions of images and questions for predicting the answer. Though our model was evaluated on visual question answering, it can be potentially applied to other tasks involving vision and language.</p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">Acknowledgements</span></p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">This work was funded in part by NSF CAREER awards to DP and DB, an ONR YIP award to DP, ONR Grant N00014-14-1-0679 to DB, a Sloan Fellowship to DP, ARO YIP awards to DB and DP, a Allen Distinguished Investigator award to DP from the Paul G. Allen Family Foundation, ICTAS Junior Faculty awards to DB and DP, Google Faculty Research Awards to DP and DB, AWS in Education Research grant to DB, and NVIDIA GPU donations to DB. The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of the U.S. Government or any sponsor.</p>
</div>
<figure id="S5.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x16.jpg" id="S5.F5.1.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x17.jpg" id="S5.F5.2.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x18.jpg" id="S5.F5.3.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x19.jpg" id="S5.F5.4.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.5" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x20.jpg" id="S5.F5.5.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F5.25" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:82.4pt;"><span id="S5.F5.25.1" class="ltx_text ltx_font_bold">Q</span>: what is the color of the kitten? <span id="S5.F5.25.2" class="ltx_text ltx_font_bold">A</span>: <span id="S5.F5.25.3" class="ltx_text ltx_font_bold">black</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F5.26" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:82.4pt;"><span id="S5.F5.26.1" class="ltx_text ltx_font_bold">Q</span>: what are standing in tall dry grass look at the tourists? <span id="S5.F5.26.2" class="ltx_text ltx_font_bold">A</span>: <span id="S5.F5.26.3" class="ltx_text ltx_font_bold">zebras</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F5.27" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:82.4pt;"><span id="S5.F5.27.1" class="ltx_text ltx_font_bold">Q</span>: where is the woman while her baby is sleeping? <span id="S5.F5.27.2" class="ltx_text ltx_font_bold">A</span>: <span id="S5.F5.27.3" class="ltx_text ltx_font_bold">kitchen</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F5.28" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:82.4pt;"><span id="S5.F5.28.1" class="ltx_text ltx_font_bold">Q</span>: what seating area is on the right? <span id="S5.F5.28.2" class="ltx_text ltx_font_bold">A</span>: <span id="S5.F5.28.3" class="ltx_text ltx_font_bold">park</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F5.29" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:82.4pt;"><span id="S5.F5.29.1" class="ltx_text ltx_font_bold">Q</span>: is the person dressed properly for this sport? <span id="S5.F5.29.2" class="ltx_text ltx_font_bold">A</span>: <span id="S5.F5.29.3" class="ltx_text ltx_font_bold">yes</span></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F5.6" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x21.jpg" id="S5.F5.6.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F5.7" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x22.jpg" id="S5.F5.7.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.8" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x23.jpg" id="S5.F5.8.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.9" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x24.jpg" id="S5.F5.9.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.10" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x25.jpg" id="S5.F5.10.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.30" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.30.1" class="ltx_p ltx_align_center"><span id="S5.F5.30.1.1" class="ltx_text" style="color:#00E1FB;">what<span id="S5.F5.30.1.1.1" class="ltx_text" style="color:#000000;">
<span id="S5.F5.30.1.1.1.1" class="ltx_text" style="color:#0078FF;">is</span></span></span>
<span id="S5.F5.30.1.2" class="ltx_text" style="color:#36FFC1;">the</span>
<span id="S5.F5.30.1.3" class="ltx_text" style="color:#1CFFDB;">color</span>
<span id="S5.F5.30.1.4" class="ltx_text" style="color:#0068FF;">of</span>
<span id="S5.F5.30.1.5" class="ltx_text" style="color:#36FFC1;">the</span>
<span id="S5.F5.30.1.6" class="ltx_text" style="color:#00C9FF;">kitten</span>
<span id="S5.F5.30.1.7" class="ltx_text" style="color:#33FFC4;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.31" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.31.1" class="ltx_p ltx_align_center"><span id="S5.F5.31.1.1" class="ltx_text" style="color:#0001FF;">what</span>
<span id="S5.F5.31.1.2" class="ltx_text" style="color:#0044FF;">are</span>
<span id="S5.F5.31.1.3" class="ltx_text" style="color:#36FFC1;">standing</span>
<span id="S5.F5.31.1.4" class="ltx_text" style="color:#00ADFF;">in</span>
<span id="S5.F5.31.1.5" class="ltx_text" style="color:#40FFB7;">tall</span>
<span id="S5.F5.31.1.6" class="ltx_text" style="color:#06EDF1;">dry</span>
<span id="S5.F5.31.1.7" class="ltx_text" style="color:#33FFC4;">grass</span>
<span id="S5.F5.31.1.8" class="ltx_text" style="color:#0089FF;">look</span>
<span id="S5.F5.31.1.9" class="ltx_text" style="color:#0044FF;">at</span>
<span id="S5.F5.31.1.10" class="ltx_text" style="color:#0044FF;">the</span>
<span id="S5.F5.31.1.11" class="ltx_text" style="color:#0024FF;">tourists</span>
<span id="S5.F5.31.1.12" class="ltx_text" style="color:#004DFF;">?</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.32" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.32.1" class="ltx_p ltx_align_center"><span id="S5.F5.32.1.1" class="ltx_text" style="color:#0055FF;">where</span>
<span id="S5.F5.32.1.2" class="ltx_text" style="color:#0068FF;">is</span>
<span id="S5.F5.32.1.3" class="ltx_text" style="color:#0060FF;">the</span>
<span id="S5.F5.32.1.4" class="ltx_text" style="color:#008DFF;">woman</span>
<span id="S5.F5.32.1.5" class="ltx_text" style="color:#0064FF;">while</span>
<span id="S5.F5.32.1.6" class="ltx_text" style="color:#00B4FF;">her</span>
<span id="S5.F5.32.1.7" class="ltx_text" style="color:#2CFFCA;">baby</span>
<span id="S5.F5.32.1.8" class="ltx_text" style="color:#0068FF;">is</span>
<span id="S5.F5.32.1.9" class="ltx_text" style="color:#DEFF19;">sleeping</span>
<span id="S5.F5.32.1.10" class="ltx_text" style="color:#0055FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.33" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.33.1" class="ltx_p ltx_align_center"><span id="S5.F5.33.1.1" class="ltx_text" style="color:#002CFF;">what</span>
<span id="S5.F5.33.1.2" class="ltx_text" style="color:#FF5200;">seating</span>
<span id="S5.F5.33.1.3" class="ltx_text" style="color:#6AFF8D;">area</span>
<span id="S5.F5.33.1.4" class="ltx_text" style="color:#0000D1;">is</span>
<span id="S5.F5.33.1.5" class="ltx_text" style="color:#0000ED;">on</span>
<span id="S5.F5.33.1.6" class="ltx_text" style="color:#0000D6;">the</span>
<span id="S5.F5.33.1.7" class="ltx_text" style="color:#0051FF;">right</span>
<span id="S5.F5.33.1.8" class="ltx_text" style="color:#0000C4;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.34" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.34.1" class="ltx_p ltx_align_center"><span id="S5.F5.34.1.1" class="ltx_text" style="color:#0000AD;">is</span>
<span id="S5.F5.34.1.2" class="ltx_text" style="color:#0000A8;">the</span>
<span id="S5.F5.34.1.3" class="ltx_text" style="color:#0000A8;">person</span>
<span id="S5.F5.34.1.4" class="ltx_text" style="color:#43FFB4;">dressed</span>
<span id="S5.F5.34.1.5" class="ltx_text" style="color:#003DFF;">properly</span>
<span id="S5.F5.34.1.6" class="ltx_text" style="color:#FF5D00;">for</span>
<span id="S5.F5.34.1.7" class="ltx_text" style="color:#0000D1;">the</span>
<span id="S5.F5.34.1.8" class="ltx_text" style="color:#00D0FF;">sport</span>
<span id="S5.F5.34.1.9" class="ltx_text" style="color:#0000A8;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.11" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x26.jpg" id="S5.F5.11.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.12" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x27.jpg" id="S5.F5.12.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.13" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x28.jpg" id="S5.F5.13.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.14" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x29.jpg" id="S5.F5.14.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.15" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x30.jpg" id="S5.F5.15.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.35" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.35.1" class="ltx_p ltx_align_center"><span id="S5.F5.35.1.1" class="ltx_text" style="color:#0000CD;">what<span id="S5.F5.35.1.1.1" class="ltx_text" style="color:#000000;">
<span id="S5.F5.35.1.1.1.1" class="ltx_text" style="color:#0000D1;">is</span></span></span>
<span id="S5.F5.35.1.2" class="ltx_text" style="color:#0000C8;">the</span>
<span id="S5.F5.35.1.3" class="ltx_text" style="color:#920000;">color</span>
<span id="S5.F5.35.1.4" class="ltx_text" style="color:#0000D6;">of</span>
<span id="S5.F5.35.1.5" class="ltx_text" style="color:#0000C8;">the</span>
<span id="S5.F5.35.1.6" class="ltx_text" style="color:#0000D1;">kitten</span>
<span id="S5.F5.35.1.7" class="ltx_text" style="color:#0000D6;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.36" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.36.1" class="ltx_p ltx_align_center"><span id="S5.F5.36.1.1" class="ltx_text" style="color:#0044FF;">what</span>
<span id="S5.F5.36.1.2" class="ltx_text" style="color:#0044FF;">are</span>
<span id="S5.F5.36.1.3" class="ltx_text" style="color:#006DFF;">standing</span>
<span id="S5.F5.36.1.4" class="ltx_text" style="color:#0071FF;">in</span>
<span id="S5.F5.36.1.5" class="ltx_text" style="color:#0071FF;">tall</span>
<span id="S5.F5.36.1.6" class="ltx_text" style="color:#0084FF;">dry</span>
<span id="S5.F5.36.1.7" class="ltx_text" style="color:#0080FF;">grass</span>
<span id="S5.F5.36.1.8" class="ltx_text" style="color:#FBF100;">look</span>
<span id="S5.F5.36.1.9" class="ltx_text" style="color:#0068FF;">at</span>
<span id="S5.F5.36.1.10" class="ltx_text" style="color:#0068FF;">the</span>
<span id="S5.F5.36.1.11" class="ltx_text" style="color:#0055FF;">tourists</span>
<span id="S5.F5.36.1.12" class="ltx_text" style="color:#0068FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.37" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.37.1" class="ltx_p ltx_align_center"><span id="S5.F5.37.1.1" class="ltx_text" style="color:#0024FF;">where</span>
<span id="S5.F5.37.1.2" class="ltx_text" style="color:#001DFF;">is</span>
<span id="S5.F5.37.1.3" class="ltx_text" style="color:#0019FF;">the</span>
<span id="S5.F5.37.1.4" class="ltx_text" style="color:#004DFF;">woman</span>
<span id="S5.F5.37.1.5" class="ltx_text" style="color:#87FF70;">while</span>
<span id="S5.F5.37.1.6" class="ltx_text" style="color:#00D4FF;">her</span>
<span id="S5.F5.37.1.7" class="ltx_text" style="color:#A0FF56;">baby</span>
<span id="S5.F5.37.1.8" class="ltx_text" style="color:#0021FF;">is</span>
<span id="S5.F5.37.1.9" class="ltx_text" style="color:#13FDE4;">sleeping</span>
<span id="S5.F5.37.1.10" class="ltx_text" style="color:#0068FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.38" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.38.1" class="ltx_p ltx_align_center"><span id="S5.F5.38.1.1" class="ltx_text" style="color:#001DFF;">what</span>
<span id="S5.F5.38.1.2" class="ltx_text" style="color:#D1FF26;">seating</span>
<span id="S5.F5.38.1.3" class="ltx_text" style="color:#FFAB00;">area</span>
<span id="S5.F5.38.1.4" class="ltx_text" style="color:#0000ED;">is</span>
<span id="S5.F5.38.1.5" class="ltx_text" style="color:#0000C8;">on</span>
<span id="S5.F5.38.1.6" class="ltx_text" style="color:#0000BF;">the</span>
<span id="S5.F5.38.1.7" class="ltx_text" style="color:#0064FF;">right</span>
<span id="S5.F5.38.1.8" class="ltx_text" style="color:#0000FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.39" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.39.1" class="ltx_p ltx_align_center"><span id="S5.F5.39.1.1" class="ltx_text" style="color:#0000B6;">is</span>
<span id="S5.F5.39.1.2" class="ltx_text" style="color:#0000A8;">the</span>
<span id="S5.F5.39.1.3" class="ltx_text" style="color:#0000B2;">person</span>
<span id="S5.F5.39.1.4" class="ltx_text" style="color:#1FFFD7;">dressed</span>
<span id="S5.F5.39.1.5" class="ltx_text" style="color:#B7FF40;">properly</span>
<span id="S5.F5.39.1.6" class="ltx_text" style="color:#50FFA7;">for</span>
<span id="S5.F5.39.1.7" class="ltx_text" style="color:#003DFF;">the</span>
<span id="S5.F5.39.1.8" class="ltx_text" style="color:#8DFF6A;">sport</span>
<span id="S5.F5.39.1.9" class="ltx_text" style="color:#0000DA;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.16" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x31.jpg" id="S5.F5.16.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.17" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x32.jpg" id="S5.F5.17.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.18" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x33.jpg" id="S5.F5.18.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.19" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x34.jpg" id="S5.F5.19.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.20" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x35.jpg" id="S5.F5.20.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.40" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.40.1" class="ltx_p ltx_align_center"><span id="S5.F5.40.1.1" class="ltx_text" style="color:#0000B6;">what<span id="S5.F5.40.1.1.1" class="ltx_text" style="color:#000000;">
<span id="S5.F5.40.1.1.1.1" class="ltx_text" style="color:#0000BB;">is</span></span></span>
<span id="S5.F5.40.1.2" class="ltx_text" style="color:#0000B6;">the</span>
<span id="S5.F5.40.1.3" class="ltx_text" style="color:#43FFB4;">color</span>
<span id="S5.F5.40.1.4" class="ltx_text" style="color:#39FFBE;">of</span>
<span id="S5.F5.40.1.5" class="ltx_text" style="color:#53FFA4;">the</span>
<span id="S5.F5.40.1.6" class="ltx_text" style="color:#6AFF8D;">kitten</span>
<span id="S5.F5.40.1.7" class="ltx_text" style="color:#53FFA4;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F5.41" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.41.1" class="ltx_p ltx_align_center"><span id="S5.F5.41.1.1" class="ltx_text" style="color:#0000DF;">what</span>
<span id="S5.F5.41.1.2" class="ltx_text" style="color:#0000DF;">are</span>
<span id="S5.F5.41.1.3" class="ltx_text" style="color:#0075FF;">standing</span>
<span id="S5.F5.41.1.4" class="ltx_text" style="color:#00B8FF;">in</span>
<span id="S5.F5.41.1.5" class="ltx_text" style="color:#00D4FF;">tall</span>
<span id="S5.F5.41.1.6" class="ltx_text" style="color:#00D8FF;">dry</span>
<span id="S5.F5.41.1.7" class="ltx_text" style="color:#00D8FF;">grass</span>
<span id="S5.F5.41.1.8" class="ltx_text" style="color:#00C9FF;">look</span>
<span id="S5.F5.41.1.9" class="ltx_text" style="color:#00D8FF;">at</span>
<span id="S5.F5.41.1.10" class="ltx_text" style="color:#00C5FF;">the</span>
<span id="S5.F5.41.1.11" class="ltx_text" style="color:#00CDFF;">tourists</span>
<span id="S5.F5.41.1.12" class="ltx_text" style="color:#0084FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F5.42" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.42.1" class="ltx_p ltx_align_center"><span id="S5.F5.42.1.1" class="ltx_text" style="color:#00C0FF;">where</span>
<span id="S5.F5.42.1.2" class="ltx_text" style="color:#0098FF;">is</span>
<span id="S5.F5.42.1.3" class="ltx_text" style="color:#0098FF;">the</span>
<span id="S5.F5.42.1.4" class="ltx_text" style="color:#0098FF;">woman</span>
<span id="S5.F5.42.1.5" class="ltx_text" style="color:#00C0FF;">while</span>
<span id="S5.F5.42.1.6" class="ltx_text" style="color:#00D8FF;">her</span>
<span id="S5.F5.42.1.7" class="ltx_text" style="color:#02E9F4;">baby</span>
<span id="S5.F5.42.1.8" class="ltx_text" style="color:#00E1FB;">is</span>
<span id="S5.F5.42.1.9" class="ltx_text" style="color:#00CDFF;">sleeping</span>
<span id="S5.F5.42.1.10" class="ltx_text" style="color:#00CDFF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F5.43" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.43.1" class="ltx_p ltx_align_center"><span id="S5.F5.43.1.1" class="ltx_text" style="color:#0000DA;">what</span>
<span id="S5.F5.43.1.2" class="ltx_text" style="color:#0000D6;">seating</span>
<span id="S5.F5.43.1.3" class="ltx_text" style="color:#0015FF;">area</span>
<span id="S5.F5.43.1.4" class="ltx_text" style="color:#005CFF;">is</span>
<span id="S5.F5.43.1.5" class="ltx_text" style="color:#06EDF1;">on</span>
<span id="S5.F5.43.1.6" class="ltx_text" style="color:#70FF87;">the</span>
<span id="S5.F5.43.1.7" class="ltx_text" style="color:#97FF60;">right</span>
<span id="S5.F5.43.1.8" class="ltx_text" style="color:#8DFF6A;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F5.44" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F5.44.1" class="ltx_p ltx_align_center"><span id="S5.F5.44.1.1" class="ltx_text" style="color:#000092;">is</span>
<span id="S5.F5.44.1.2" class="ltx_text" style="color:#00008D;">the</span>
<span id="S5.F5.44.1.3" class="ltx_text" style="color:#00008D;">person</span>
<span id="S5.F5.44.1.4" class="ltx_text" style="color:#000092;">dressed</span>
<span id="S5.F5.44.1.5" class="ltx_text" style="color:#0000C8;">properly</span>
<span id="S5.F5.44.1.6" class="ltx_text" style="color:#0000FF;">for</span>
<span id="S5.F5.44.1.7" class="ltx_text" style="color:#000CFF;">the</span>
<span id="S5.F5.44.1.8" class="ltx_text" style="color:#19FFDE;">sport</span>
<span id="S5.F5.44.1.9" class="ltx_text" style="color:#ED0400;">?</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Visualization of co-attention maps on success cases in the COCO-QA (first three columns using <math id="S5.F5.23.m1.1" class="ltx_Math" alttext="\mathrm{Ours}^{p}" display="inline"><semantics id="S5.F5.23.m1.1b"><msup id="S5.F5.23.m1.1.1" xref="S5.F5.23.m1.1.1.cmml"><mi id="S5.F5.23.m1.1.1.2" xref="S5.F5.23.m1.1.1.2.cmml">Ours</mi><mi id="S5.F5.23.m1.1.1.3" xref="S5.F5.23.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S5.F5.23.m1.1c"><apply id="S5.F5.23.m1.1.1.cmml" xref="S5.F5.23.m1.1.1"><csymbol cd="ambiguous" id="S5.F5.23.m1.1.1.1.cmml" xref="S5.F5.23.m1.1.1">superscript</csymbol><ci id="S5.F5.23.m1.1.1.2.cmml" xref="S5.F5.23.m1.1.1.2">Ours</ci><ci id="S5.F5.23.m1.1.1.3.cmml" xref="S5.F5.23.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.23.m1.1d">\mathrm{Ours}^{p}</annotation></semantics></math>+VGG) and VQA (last two columns <math id="S5.F5.24.m2.1" class="ltx_Math" alttext="\mathrm{Ours}^{a}" display="inline"><semantics id="S5.F5.24.m2.1b"><msup id="S5.F5.24.m2.1.1" xref="S5.F5.24.m2.1.1.cmml"><mi id="S5.F5.24.m2.1.1.2" xref="S5.F5.24.m2.1.1.2.cmml">Ours</mi><mi id="S5.F5.24.m2.1.1.3" xref="S5.F5.24.m2.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S5.F5.24.m2.1c"><apply id="S5.F5.24.m2.1.1.cmml" xref="S5.F5.24.m2.1.1"><csymbol cd="ambiguous" id="S5.F5.24.m2.1.1.1.cmml" xref="S5.F5.24.m2.1.1">superscript</csymbol><ci id="S5.F5.24.m2.1.1.2.cmml" xref="S5.F5.24.m2.1.1.2">Ours</ci><ci id="S5.F5.24.m2.1.1.3.cmml" xref="S5.F5.24.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.24.m2.1d">\mathrm{Ours}^{a}</annotation></semantics></math>+VGG) dataset. The layout is the same as Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.5 Qualitative Results ‣ 4 Experiment ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</figcaption>
</figure>
<figure id="S5.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x36.jpg" id="S5.F6.1.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x37.jpg" id="S5.F6.2.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x38.jpg" id="S5.F6.3.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.4" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x39.jpg" id="S5.F6.4.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.5" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x40.jpg" id="S5.F6.5.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F6.25" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:82.4pt;"><span id="S5.F6.25.1" class="ltx_text ltx_font_bold">Q</span>: how many red motorcycles with riders in protective gear are on the street? <span id="S5.F6.25.2" class="ltx_text ltx_font_bold">A</span>: <span id="S5.F6.25.3" class="ltx_text ltx_font_bold" style="color:#FF0000;">two</span>(<span id="S5.F6.25.4" class="ltx_text ltx_font_bold" style="color:#00FF00;">three</span>)</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F6.26" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:82.4pt;"><span id="S5.F6.26.1" class="ltx_text ltx_font_bold">Q</span>: what is the color of the bus? <span id="S5.F6.26.2" class="ltx_text ltx_font_bold">A</span>: <span id="S5.F6.26.3" class="ltx_text ltx_font_bold" style="color:#FF0000;">green</span>(<span id="S5.F6.26.4" class="ltx_text ltx_font_bold" style="color:#00FF00;">red</span>)</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F6.27" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:82.4pt;"><span id="S5.F6.27.1" class="ltx_text ltx_font_bold">Q</span>: what is shown in different places? <span id="S5.F6.27.2" class="ltx_text ltx_font_bold">A</span>: <span id="S5.F6.27.3" class="ltx_text ltx_font_bold" style="color:#FF0000;">hydrant</span>(<span id="S5.F6.27.4" class="ltx_text ltx_font_bold" style="color:#00FF00;">toy</span>)</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S5.F6.28" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.28.1" class="ltx_p ltx_align_center"><span id="S5.F6.28.1.1" class="ltx_text ltx_font_bold">Q</span>:do the doors open in or out?</p>
<p id="S5.F6.28.2" class="ltx_p ltx_align_center"><span id="S5.F6.28.2.1" class="ltx_text ltx_font_bold">A</span>: <span id="S5.F6.28.2.2" class="ltx_text ltx_font_bold" style="color:#FF0000;">open</span>(<span id="S5.F6.28.2.3" class="ltx_text ltx_font_bold" style="color:#00FF00;">in</span>)</p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S5.F6.29" class="ltx_p ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:82.4pt;"><span id="S5.F6.29.1" class="ltx_text ltx_font_bold">Q</span>: is this an open market at night? <span id="S5.F6.29.2" class="ltx_text ltx_font_bold">A</span>: <span id="S5.F6.29.3" class="ltx_text ltx_font_bold" style="color:#FF0000;">yes</span>(<span id="S5.F6.29.4" class="ltx_text ltx_font_bold" style="color:#00FF00;">no</span>)</p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F6.6" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x41.jpg" id="S5.F6.6.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S5.F6.7" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x42.jpg" id="S5.F6.7.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.8" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x43.jpg" id="S5.F6.8.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.9" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x44.jpg" id="S5.F6.9.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.10" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x45.jpg" id="S5.F6.10.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.30" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.30.1" class="ltx_p ltx_align_center"><span id="S5.F6.30.1.1" class="ltx_text" style="color:#0068FF;">how</span>
<span id="S5.F6.30.1.2" class="ltx_text" style="color:#0051FF;">many</span>
<span id="S5.F6.30.1.3" class="ltx_text" style="color:#0084FF;">red</span>
<span id="S5.F6.30.1.4" class="ltx_text" style="color:#16FFE1;">motorcycles</span>
<span id="S5.F6.30.1.5" class="ltx_text" style="color:#0051FF;">with</span>
<span id="S5.F6.30.1.6" class="ltx_text" style="color:#0051FF;">riders</span>
<span id="S5.F6.30.1.7" class="ltx_text" style="color:#0051FF;">in</span>
<span id="S5.F6.30.1.8" class="ltx_text" style="color:#0084FF;">protective</span>
<span id="S5.F6.30.1.9" class="ltx_text" style="color:#06EDF1;">gear</span>
<span id="S5.F6.30.1.10" class="ltx_text" style="color:#0059FF;">are</span>
<span id="S5.F6.30.1.11" class="ltx_text" style="color:#0064FF;">on</span>
<span id="S5.F6.30.1.12" class="ltx_text" style="color:#005CFF;">the</span>
<span id="S5.F6.30.1.13" class="ltx_text" style="color:#23FFD4;">street</span>
<span id="S5.F6.30.1.14" class="ltx_text" style="color:#009CFF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.31" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.31.1" class="ltx_p ltx_align_center"><span id="S5.F6.31.1.1" class="ltx_text" style="color:#00C0FF;">what</span>
<span id="S5.F6.31.1.2" class="ltx_text" style="color:#1FFFD7;">is</span>
<span id="S5.F6.31.1.3" class="ltx_text" style="color:#00CDFF;">the</span>
<span id="S5.F6.31.1.4" class="ltx_text" style="color:#06EDF1;">color</span>
<span id="S5.F6.31.1.5" class="ltx_text" style="color:#0CF4EB;">of</span>
<span id="S5.F6.31.1.6" class="ltx_text" style="color:#00CDFF;">the</span>
<span id="S5.F6.31.1.7" class="ltx_text" style="color:#16FFE1;">bus</span>
<span id="S5.F6.31.1.8" class="ltx_text" style="color:#0CF4EB;">?</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.32" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.32.1" class="ltx_p ltx_align_center"><span id="S5.F6.32.1.1" class="ltx_text" style="color:#007CFF;">what</span>
<span id="S5.F6.32.1.2" class="ltx_text" style="color:#0064FF;">is</span>
<span id="S5.F6.32.1.3" class="ltx_text" style="color:#0064FF;">shown</span>
<span id="S5.F6.32.1.4" class="ltx_text" style="color:#0068FF;">in</span>
<span id="S5.F6.32.1.5" class="ltx_text" style="color:#FFEA00;">different</span>
<span id="S5.F6.32.1.6" class="ltx_text" style="color:#9DFF5A;">places</span>
<span id="S5.F6.32.1.7" class="ltx_text" style="color:#0068FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.33" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.33.1" class="ltx_p ltx_align_center"><span id="S5.F6.33.1.1" class="ltx_text" style="color:#97FF60;">do</span>
<span id="S5.F6.33.1.2" class="ltx_text" style="color:#0000F1;">the</span>
<span id="S5.F6.33.1.3" class="ltx_text" style="color:#BEFF39;">doors</span>
<span id="S5.F6.33.1.4" class="ltx_text" style="color:#94FF63;">open</span>
<span id="S5.F6.33.1.5" class="ltx_text" style="color:#0000FA;">in</span>
<span id="S5.F6.33.1.6" class="ltx_text" style="color:#0015FF;">or</span>
<span id="S5.F6.33.1.7" class="ltx_text" style="color:#0059FF;">out</span>
<span id="S5.F6.33.1.8" class="ltx_text" style="color:#0000ED;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.34" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.34.1" class="ltx_p ltx_align_center"><span id="S5.F6.34.1.1" class="ltx_text" style="color:#0004FF;">is</span>
<span id="S5.F6.34.1.2" class="ltx_text" style="color:#0084FF;">this</span>
<span id="S5.F6.34.1.3" class="ltx_text" style="color:#0071FF;">an</span>
<span id="S5.F6.34.1.4" class="ltx_text" style="color:#DEFF19;">open</span>
<span id="S5.F6.34.1.5" class="ltx_text" style="color:#7DFF7A;">market</span>
<span id="S5.F6.34.1.6" class="ltx_text" style="color:#00D8FF;">at</span>
<span id="S5.F6.34.1.7" class="ltx_text" style="color:#00B1FF;">night</span>
<span id="S5.F6.34.1.8" class="ltx_text" style="color:#000CFF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.11" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x46.jpg" id="S5.F6.11.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.12" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x47.jpg" id="S5.F6.12.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.13" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x48.jpg" id="S5.F6.13.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.14" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x49.jpg" id="S5.F6.14.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.15" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x50.jpg" id="S5.F6.15.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.35" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.35.1" class="ltx_p ltx_align_center"><span id="S5.F6.35.1.1" class="ltx_text" style="color:#000CFF;">how</span>
<span id="S5.F6.35.1.2" class="ltx_text" style="color:#AD0000;">many</span>
<span id="S5.F6.35.1.3" class="ltx_text" style="color:#0000D1;">red</span>
<span id="S5.F6.35.1.4" class="ltx_text" style="color:#001DFF;">motorcycles</span>
<span id="S5.F6.35.1.5" class="ltx_text" style="color:#0000B6;">with</span>
<span id="S5.F6.35.1.6" class="ltx_text" style="color:#0000B6;">riders</span>
<span id="S5.F6.35.1.7" class="ltx_text" style="color:#0000BB;">in</span>
<span id="S5.F6.35.1.8" class="ltx_text" style="color:#0000D1;">protective</span>
<span id="S5.F6.35.1.9" class="ltx_text" style="color:#0000DF;">gear</span>
<span id="S5.F6.35.1.10" class="ltx_text" style="color:#0000B6;">are</span>
<span id="S5.F6.35.1.11" class="ltx_text" style="color:#0000BF;">on</span>
<span id="S5.F6.35.1.12" class="ltx_text" style="color:#0000BB;">the</span>
<span id="S5.F6.35.1.13" class="ltx_text" style="color:#0000B2;">street</span>
<span id="S5.F6.35.1.14" class="ltx_text" style="color:#0000B2;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.36" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.36.1" class="ltx_p ltx_align_center"><span id="S5.F6.36.1.1" class="ltx_text" style="color:#0000B2;">what</span>
<span id="S5.F6.36.1.2" class="ltx_text" style="color:#0000B6;">is</span>
<span id="S5.F6.36.1.3" class="ltx_text" style="color:#0000B2;">the</span>
<span id="S5.F6.36.1.4" class="ltx_text" style="color:#840000;">color</span>
<span id="S5.F6.36.1.5" class="ltx_text" style="color:#0000B2;">of</span>
<span id="S5.F6.36.1.6" class="ltx_text" style="color:#0000B2;">the</span>
<span id="S5.F6.36.1.7" class="ltx_text" style="color:#0000AD;">bus</span>
<span id="S5.F6.36.1.8" class="ltx_text" style="color:#0000B6;">?</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.37" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.37.1" class="ltx_p ltx_align_center"><span id="S5.F6.37.1.1" class="ltx_text" style="color:#0021FF;">what</span>
<span id="S5.F6.37.1.2" class="ltx_text" style="color:#0031FF;">is</span>
<span id="S5.F6.37.1.3" class="ltx_text" style="color:#0031FF;">shown</span>
<span id="S5.F6.37.1.4" class="ltx_text" style="color:#0055FF;">in</span>
<span id="S5.F6.37.1.5" class="ltx_text" style="color:#0068FF;">different</span>
<span id="S5.F6.37.1.6" class="ltx_text" style="color:#FF1A00;">places</span>
<span id="S5.F6.37.1.7" class="ltx_text" style="color:#0055FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.38" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.38.1" class="ltx_p ltx_align_center"><span id="S5.F6.38.1.1" class="ltx_text" style="color:#0000E8;">do</span>
<span id="S5.F6.38.1.2" class="ltx_text" style="color:#0000BF;">the</span>
<span id="S5.F6.38.1.3" class="ltx_text" style="color:#0000FF;">doors</span>
<span id="S5.F6.38.1.4" class="ltx_text" style="color:#0059FF;">open</span>
<span id="S5.F6.38.1.5" class="ltx_text" style="color:#0000BF;">in</span>
<span id="S5.F6.38.1.6" class="ltx_text" style="color:#B60000;">or</span>
<span id="S5.F6.38.1.7" class="ltx_text" style="color:#0000FF;">out</span>
<span id="S5.F6.38.1.8" class="ltx_text" style="color:#0000C8;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.39" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.39.1" class="ltx_p ltx_align_center"><span id="S5.F6.39.1.1" class="ltx_text" style="color:#0001FF;">is</span>
<span id="S5.F6.39.1.2" class="ltx_text" style="color:#0024FF;">this</span>
<span id="S5.F6.39.1.3" class="ltx_text" style="color:#0059FF;">an</span>
<span id="S5.F6.39.1.4" class="ltx_text" style="color:#33FFC4;">open</span>
<span id="S5.F6.39.1.5" class="ltx_text" style="color:#FFB600;">market</span>
<span id="S5.F6.39.1.6" class="ltx_text" style="color:#0040FF;">at</span>
<span id="S5.F6.39.1.7" class="ltx_text" style="color:#33FFC4;">night</span>
<span id="S5.F6.39.1.8" class="ltx_text" style="color:#0008FF;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.16" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x51.jpg" id="S5.F6.16.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.17" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x52.jpg" id="S5.F6.17.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.18" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x53.jpg" id="S5.F6.18.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.19" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x54.jpg" id="S5.F6.19.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.20" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<img src="/html/1606.00061/assets/x55.jpg" id="S5.F6.20.g1" class="ltx_graphics ltx_img_landscape" width="664" height="465" alt="Refer to caption">
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.40" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.40.1" class="ltx_p ltx_align_center"><span id="S5.F6.40.1.1" class="ltx_text" style="color:#0051FF;">how</span>
<span id="S5.F6.40.1.2" class="ltx_text" style="color:#004DFF;">many</span>
<span id="S5.F6.40.1.3" class="ltx_text" style="color:#0060FF;">red</span>
<span id="S5.F6.40.1.4" class="ltx_text" style="color:#0071FF;">motorcycles</span>
<span id="S5.F6.40.1.5" class="ltx_text" style="color:#008DFF;">with</span>
<span id="S5.F6.40.1.6" class="ltx_text" style="color:#0078FF;">riders</span>
<span id="S5.F6.40.1.7" class="ltx_text" style="color:#008DFF;">in</span>
<span id="S5.F6.40.1.8" class="ltx_text" style="color:#0089FF;">protective</span>
<span id="S5.F6.40.1.9" class="ltx_text" style="color:#007CFF;">gear</span>
<span id="S5.F6.40.1.10" class="ltx_text" style="color:#007CFF;">are</span>
<span id="S5.F6.40.1.11" class="ltx_text" style="color:#007CFF;">on</span>
<span id="S5.F6.40.1.12" class="ltx_text" style="color:#00CDFF;">the</span>
<span id="S5.F6.40.1.13" class="ltx_text" style="color:#00D0FF;">street</span>
<span id="S5.F6.40.1.14" class="ltx_text" style="color:#1FFFD7;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_many">
<div id="S5.F6.41" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.41.1" class="ltx_p ltx_align_center"><span id="S5.F6.41.1.1" class="ltx_text" style="color:#0008FF;">what</span>
<span id="S5.F6.41.1.2" class="ltx_text" style="color:#0001FF;">is</span>
<span id="S5.F6.41.1.3" class="ltx_text" style="color:#0001FF;">the</span>
<span id="S5.F6.41.1.4" class="ltx_text" style="color:#5AFF9D;">color</span>
<span id="S5.F6.41.1.5" class="ltx_text" style="color:#5DFF9A;">of</span>
<span id="S5.F6.41.1.6" class="ltx_text" style="color:#3CFFBA;">the</span>
<span id="S5.F6.41.1.7" class="ltx_text" style="color:#49FFAD;">bus</span>
<span id="S5.F6.41.1.8" class="ltx_text" style="color:#1CFFDB;">?</span></p>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F6.42" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.42.1" class="ltx_p ltx_align_center"><span id="S5.F6.42.1.1" class="ltx_text" style="color:#008DFF;">what</span>
<span id="S5.F6.42.1.2" class="ltx_text" style="color:#0095FF;">is</span>
<span id="S5.F6.42.1.3" class="ltx_text" style="color:#0095FF;">shown</span>
<span id="S5.F6.42.1.4" class="ltx_text" style="color:#56FFA0;">in</span>
<span id="S5.F6.42.1.5" class="ltx_text" style="color:#60FF97;">different</span>
<span id="S5.F6.42.1.6" class="ltx_text" style="color:#3CFFBA;">places</span>
<span id="S5.F6.42.1.7" class="ltx_text" style="color:#39FFBE;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F6.43" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.43.1" class="ltx_p ltx_align_center"><span id="S5.F6.43.1.1" class="ltx_text" style="color:#000089;">do</span>
<span id="S5.F6.43.1.2" class="ltx_text" style="color:#000084;">the</span>
<span id="S5.F6.43.1.3" class="ltx_text" style="color:#000084;">doors</span>
<span id="S5.F6.43.1.4" class="ltx_text" style="color:#00008D;">open</span>
<span id="S5.F6.43.1.5" class="ltx_text" style="color:#000092;">in</span>
<span id="S5.F6.43.1.6" class="ltx_text" style="color:#0060FF;">or</span>
<span id="S5.F6.43.1.7" class="ltx_text" style="color:#FFD000;">out</span>
<span id="S5.F6.43.1.8" class="ltx_text" style="color:#FFD000;">?</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<div id="S5.F6.44" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_middle" style="width:82.4pt;">
<p id="S5.F6.44.1" class="ltx_p ltx_align_center"><span id="S5.F6.44.1.1" class="ltx_text" style="color:#000092;">is</span>
<span id="S5.F6.44.1.2" class="ltx_text" style="color:#000092;">this</span>
<span id="S5.F6.44.1.3" class="ltx_text" style="color:#000096;">an</span>
<span id="S5.F6.44.1.4" class="ltx_text" style="color:#0000B2;">open</span>
<span id="S5.F6.44.1.5" class="ltx_text" style="color:#0044FF;">market</span>
<span id="S5.F6.44.1.6" class="ltx_text" style="color:#02E9F4;">at</span>
<span id="S5.F6.44.1.7" class="ltx_text" style="color:#ADFF49;">night</span>
<span id="S5.F6.44.1.8" class="ltx_text" style="color:#FFB200;">?</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Visualization of co-attention maps on failure cases in the COCO-QA (first three columns using <math id="S5.F6.23.m1.1" class="ltx_Math" alttext="\mathrm{Ours}^{p}" display="inline"><semantics id="S5.F6.23.m1.1b"><msup id="S5.F6.23.m1.1.1" xref="S5.F6.23.m1.1.1.cmml"><mi id="S5.F6.23.m1.1.1.2" xref="S5.F6.23.m1.1.1.2.cmml">Ours</mi><mi id="S5.F6.23.m1.1.1.3" xref="S5.F6.23.m1.1.1.3.cmml">p</mi></msup><annotation-xml encoding="MathML-Content" id="S5.F6.23.m1.1c"><apply id="S5.F6.23.m1.1.1.cmml" xref="S5.F6.23.m1.1.1"><csymbol cd="ambiguous" id="S5.F6.23.m1.1.1.1.cmml" xref="S5.F6.23.m1.1.1">superscript</csymbol><ci id="S5.F6.23.m1.1.1.2.cmml" xref="S5.F6.23.m1.1.1.2">Ours</ci><ci id="S5.F6.23.m1.1.1.3.cmml" xref="S5.F6.23.m1.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.23.m1.1d">\mathrm{Ours}^{p}</annotation></semantics></math>+VGG) and VQA (last two columns <math id="S5.F6.24.m2.1" class="ltx_Math" alttext="\mathrm{Ours}^{a}" display="inline"><semantics id="S5.F6.24.m2.1b"><msup id="S5.F6.24.m2.1.1" xref="S5.F6.24.m2.1.1.cmml"><mi id="S5.F6.24.m2.1.1.2" xref="S5.F6.24.m2.1.1.2.cmml">Ours</mi><mi id="S5.F6.24.m2.1.1.3" xref="S5.F6.24.m2.1.1.3.cmml">a</mi></msup><annotation-xml encoding="MathML-Content" id="S5.F6.24.m2.1c"><apply id="S5.F6.24.m2.1.1.cmml" xref="S5.F6.24.m2.1.1"><csymbol cd="ambiguous" id="S5.F6.24.m2.1.1.1.cmml" xref="S5.F6.24.m2.1.1">superscript</csymbol><ci id="S5.F6.24.m2.1.1.2.cmml" xref="S5.F6.24.m2.1.1.2">Ours</ci><ci id="S5.F6.24.m2.1.1.3.cmml" xref="S5.F6.24.m2.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F6.24.m2.1d">\mathrm{Ours}^{a}</annotation></semantics></math>+VGG) dataset. Predicted answer is in red and ground truth answer is in green. The layout is the same as Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.5 Qualitative Results ‣ 4 Experiment ‣ Hierarchical Question-Image Co-Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</figcaption>
</figure>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Jacob Andreas, Marcus Rohrbach, Trevor Darrell, and Dan Klein.

</span>
<span class="ltx_bibblock">Deep compositional question answering with neural module networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Stanislaw Antol, Aishwarya Agrawal, Jiasen Lu, Margaret Mitchell, Dhruv Batra,
C Lawrence Zitnick, and Devi Parikh.

</span>
<span class="ltx_bibblock">Vqa: Visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2015.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Neural machine translation by jointly learning to align and
translate.

</span>
<span class="ltx_bibblock">In <span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2015.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
R. Collobert, K. Kavukcuoglu, and C. Farabet.

</span>
<span class="ltx_bibblock">Torch7: A matlab-like environment for machine learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">BigLearn, NIPS Workshop</span>, 2011.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Abhishek Das, Harsh Agrawal, C Lawrence Zitnick, Devi Parikh, and Dhruv Batra.

</span>
<span class="ltx_bibblock">Human attention in visual question answering: Do humans and deep
networks look at the same regions?

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1606.03556</span>, 2016.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Akira Fukui, Dong Huk Park, Daylen Yang, Anna Rohrbach, Trevor Darrell, and
Marcus Rohrbach.

</span>
<span class="ltx_bibblock">Multimodal compact bilinear pooling for visual question answering and
visual grounding.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1606.01847</span>, 2016.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Haoyuan Gao, Junhua Mao, Jie Zhou, Zhiheng Huang, Lei Wang, and Wei Xu.

</span>
<span class="ltx_bibblock">Are you talking to a machine? dataset and methods for multilingual
image question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">NIPS</span>, 2015.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2016.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Karl Moritz Hermann, Tomas Kocisky, Edward Grefenstette, Lasse Espeholt, Will
Kay, Mustafa Suleyman, and Phil Blunsom.

</span>
<span class="ltx_bibblock">Teaching machines to read and comprehend.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">NIPS</span>, 2015.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Baotian Hu, Zhengdong Lu, Hang Li, and Qingcai Chen.

</span>
<span class="ltx_bibblock">Convolutional neural network architectures for matching natural
language sentences.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">NIPS</span>, 2014.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Ilija Ilievski, Shuicheng Yan, and Jiashi Feng.

</span>
<span class="ltx_bibblock">A focused dynamic attention model for visual question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv:1604.01485</span>, 2016.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Jin-Hwa Kim, Sang-Woo Lee, Dong-Hyun Kwak, Min-Oh Heo, Jeonghee Kim, Jung-Woo
Ha, and Byoung-Tak Zhang.

</span>
<span class="ltx_bibblock">Multimodal residual learning for visual qa.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1606.01455</span>, 2016.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Ranjay Krishna, Yuke Zhu, Oliver Groth, Justin Johnson, Kenji Hata, Joshua
Kravitz, Stephanie Chen, Yannis Kalantidis, Li-Jia Li, David A Shamma, et al.

</span>
<span class="ltx_bibblock">Visual genome: Connecting language and vision using crowdsourced
dense image annotations.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1602.07332</span>, 2016.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva
Ramanan, Piotr Dollár, and C Lawrence Zitnick.

</span>
<span class="ltx_bibblock">Microsoft coco: Common objects in context.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">ECCV</span>, 2014.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Lin Ma, Zhengdong Lu, and Hang Li.

</span>
<span class="ltx_bibblock">Learning to answer questions from image using convolutional neural
network.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">AAAI</span>, 2016.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Mateusz Malinowski, Marcus Rohrbach, and Mario Fritz.

</span>
<span class="ltx_bibblock">Ask your neurons: A neural-based approach to answering questions
about images.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2015.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Mengye Ren, Ryan Kiros, and Richard Zemel.

</span>
<span class="ltx_bibblock">Exploring models and data for image question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">NIPS</span>, 2015.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Tim Rocktäschel, Edward Grefenstette, Karl Moritz Hermann, Tomáš
Kočiskỳ, and Phil Blunsom.

</span>
<span class="ltx_bibblock">Reasoning about entailment with neural attention.

</span>
<span class="ltx_bibblock">In <span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2016.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Cicero dos Santos, Ming Tan, Bing Xiang, and Bowen Zhou.

</span>
<span class="ltx_bibblock">Attentive pooling networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1602.03609</span>, 2016.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Kevin J Shih, Saurabh Singh, and Derek Hoiem.

</span>
<span class="ltx_bibblock">Where to look: Focus regions for visual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2016.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Karen Simonyan and Andrew Zisserman.

</span>
<span class="ltx_bibblock">Very deep convolutional networks for large-scale image recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">CoRR</span>, abs/1409.1556, 2014.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Christian Szegedy, Wei Liu, Yangqing Jia, Pierre Sermanet, Scott Reed, Dragomir
Anguelov, Dumitru Erhan, Vincent Vanhoucke, and Andrew Rabinovich.

</span>
<span class="ltx_bibblock">Going deeper with convolutions.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2015.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Caiming Xiong, Stephen Merity, and Richard Socher.

</span>
<span class="ltx_bibblock">Dynamic memory networks for visual and textual question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2016.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Huijuan Xu and Kate Saenko.

</span>
<span class="ltx_bibblock">Ask, attend and answer: Exploring question-guided spatial attention
for visual question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1511.05234</span>, 2015.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Zichao Yang, Xiaodong He, Jianfeng Gao, Li Deng, and Alex Smola.

</span>
<span class="ltx_bibblock">Stacked attention networks for image question answering.

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2016.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Wenpeng Yin, Hinrich Schütze, Bing Xiang, and Bowen Zhou.

</span>
<span class="ltx_bibblock">Abcnn: Attention-based convolutional neural network for modeling
sentence pairs.

</span>
<span class="ltx_bibblock">In <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">ACL</span>, 2016.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Peng Zhang, Yash Goyal, Douglas Summers-Stay, Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Yin and yang: Balancing and answering binary visual questions.

</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1511.05099</span>, 2015.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Yuke Zhu, Oliver Groth, Michael Bernstein, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Visual7w: Grounded question answering in images.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2016.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
C Lawrence Zitnick, Aishwarya Agrawal, Stanislaw Antol, Margaret Mitchell,
Dhruv Batra, and Devi Parikh.

</span>
<span class="ltx_bibblock">Measuring machine intelligence through visual question answering.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">AI Magazine</span>, 37(1), 2016.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1606.00059" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1606.00061" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1606.00061">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1606.00061" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1606.00062" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar  3 23:12:32 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
