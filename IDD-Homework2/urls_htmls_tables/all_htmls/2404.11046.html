<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2404.11046] Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model</title><meta property="og:description" content="Federated learning aims to tackle the “isolated data island” problem, where it trains a collective model from physically isolated clients while safeguarding the privacy of users’ data. However, supervised federated lea…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2404.11046">

<!--Generated on Sun May  5 20:31:55 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Hao Yan &amp; Yuhong Guo
<br class="ltx_break">School of Computer Science, Carleton University, Ottawa, Canada
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning aims to tackle the “isolated data island” problem, where it trains a collective model from physically isolated clients while safeguarding the privacy of users’ data. However, supervised federated learning necessitates that each client labels their data for training, which can be both time-consuming and resource-intensive, and may even be impractical for edge devices. Moreover, the training and transmission of deep models present challenges to the computation and communication capabilities of the clients.
To address these two inherent challenges in supervised federated learning, we propose a novel lightweight unsupervised federated learning approach that leverages unlabeled data on each client to perform lightweight model training and communication by harnessing pretrained vision-language models, such as CLIP. By capitalizing on the zero-shot prediction capability and the well-trained image encoder of the pre-trained CLIP model, we have carefully crafted an efficient and resilient self-training approach. This method refines the initial zero-shot predicted pseudo-labels of unlabeled instances through the sole training of a linear classifier on top of the fixed image encoder. Additionally, to address data heterogeneity within each client, we propose a class-balanced text feature sampling strategy for generating synthetic instances in the feature space to support local training.
Experiments are conducted on multiple benchmark datasets. The experimental results demonstrate that our proposed method greatly enhances model performance in comparison to CLIP’s zero-shot predictions and even outperforms supervised federated learning benchmark methods given limited computational and communication overhead.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p">Deep learning has achieved state-of-the-art performance across various benchmarks, primarily driven by the emergence of ultra-deep neural networks and the availability of centralized training data.
While potential information hides in huge amount of personal or corporate data, learning from these isolated data islands poses a fundamental challenge in preserving privacy of user data.
To address this challenge, federated learning <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> was introduced as an interactive approach involving communication between a central server and individual clients. In this process, clients download initial model parameters from the server, update these parameters locally, and then upload the updated parameters back to the server. The server aggregates these updates and sends the aggregated parameters back to the clients.
While FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> achieves rapid convergence when the data distribution among clients is homogeneous, heterogeneity in data distribution leads to biased local models and reduces the efficiency of federated learning<cite class="ltx_cite ltx_citemacro_citep">(Luo et al., <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite>. Subsequent research efforts have sought to enhance the training efficiency of heterogeneous federated learning, both at the client side <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib20" title="" class="ltx_ref">2020</a>; Wang et al., <a href="#bib.bib33" title="" class="ltx_ref">2020</a>; Karimireddy et al., <a href="#bib.bib14" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib19" title="" class="ltx_ref">2021</a>; Kim et al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>; Tan et al., <a href="#bib.bib31" title="" class="ltx_ref">2022</a>; Lee et al., <a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite> and on the server side <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a href="#bib.bib10" title="" class="ltx_ref">2019</a>; Reddi et al., <a href="#bib.bib28" title="" class="ltx_ref">2021</a>; Luo et al., <a href="#bib.bib24" title="" class="ltx_ref">2021</a>; Elgabli et al., <a href="#bib.bib6" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p">However, standard supervised federated learning faces two significant challenges. Firstly, it requires data annotation on every client, which is both time and resource-intensive. Secondly, updating deep models within the client and frequently transferring these models between the server and clients induce
substantial computational and communication resources, particularly on edge devices such as mobile phones. Addressing these challenges has been the focus of only a few recent works. Some have explored semi-supervised federated learning, assuming that a portion of the data in each client is labeled <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib12" title="" class="ltx_ref">2021</a>; Diao et al., <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite>. <cite class="ltx_cite ltx_citemacro_citet">Lu et al. (<a href="#bib.bib22" title="" class="ltx_ref">2022</a>)</cite> proposed federated learning from unlabeled data while under the strong assumption of known precise label frequencies on each client. <cite class="ltx_cite ltx_citemacro_citet">Lin et al. (<a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite> proposed federated learning with positive and unlabeled data and assumed that each client labels only a portion of data from certain classes.</p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">In this paper, we propose a novel lightweight unsupervised federated learning approach
to simultaneously address the aforementioned annotation and resource demanding challenges.
Our approach focuses on a setting
where data annotation on each client is unnecessary,
while restricting to lightweight model training on each client
to accommodate computation and communication limitations.
The contemplation of this learning approach is prompted by
recent advancements in pretrained vision-language models, such as CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite>,
which train both image and text encoders on large datasets of image-caption pairs
and facilitate zero-shot predictions on downstream tasks by generating pairs of visual and textual features.
While pretrained vision-language models can offer initial annotations through zero-shot prediction,
achieving satisfactory or optimal model performance in the demanding context of
lightweight and unsupervised federated learning still necessitates the development of novel methodologies.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p">To this end, we develop a novel method, Federated Self-Training with Class-Balanced Data Generation (FST-CBDG),
to perform lightweight unsupervised federated learning by utilizing
the text and image encoders of pretrained vision-language models.
First, in the preparation stage,
we generate the textual embeddings of all relevant classes using the pretrained text encoder on the server side
and distribute them to participating clients along with the pretrained image encoder.
Subsequently, in the federated learning stage, we form the prediction model by
putting a lightweight linear classification layer on top of the pretrained image encoder,
and conduct standard federated average learning solely on the linear layer.
This learning scheme imposes minimal computational and communication overhead on each client.
Additionally, the weight parameters of the linear classification layer can be conveniently
initialized using the textual features of the corresponding class categories,
which facilitates efficient federated learning by leveraging the zero-shot prediction capabilities
of the pretrained vision-language model.
Nevertheless, the crux of the matter is the efficient enhancement of initial models on each client
within the constrained parameter space.
Hence, we have carefully designed a self-training strategy
aimed at improving the quality of predicted pseudo-labels and enhancing overall model performance.
Moreover, to address the challenges and mitigate the negative impact of heterogeneous data distribution on local clients,
we introduce a class-balanced data generation module to produce augmenting data
from a Gaussian sampling model that leverages class-relevant text features.
To evaluate our proposed approach, we conducted experiments on standard federated learning benchmarks under the
“lightweight unsupervised federated learning” setting.
The experimental results demonstrate that the proposed method achieves substantial improvements
over CLIP’s zero-shot prediction and even outperforms supervised federated learning benchmark methods
given limited computational and communication overhead.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Federated learning</span> Federated learning was introduced to address the challenge of training models based on isolated data islands.
Majority studies focus on fully supervised federated learning settings,
requiring every client has fully labeled data.
The foundational FedAvg
<cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>
is a simple approach of averaging local model parameter updates on the server and sending them back to clients for further local updates. It demonstrates rapid convergence and approximation of centralized learning when client data adhered to an independently and identically distributed (i.i.d.) pattern. However, heterogeneity in data distribution among clients, which is common in real-world scenarios, introduces non-i.i.d. challenges, resulting in biased local models and slower model convergence.
Subsequent research endeavors aimed to enhance heterogeneous federated learning. These approaches target both client and server-side improvements.
FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite> enforces local parameter updates to stay close to the global model.
FedNova <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite> tackles the issue of objective inconsistency by employing a normalized averaging method.
SCAFFOLD <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al., <a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> employs control variates to reduce variance in local updates.
MOON <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib19" title="" class="ltx_ref">2021</a>)</cite> corrects local updates by maximizing the agreement between local and global representations through contrastive learning.
FedMLB <cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a href="#bib.bib15" title="" class="ltx_ref">2022</a>)</cite> utilizes multi-level hybrid branching of modules from local and global models to generate multiple predictions, minimizing the Kullback-Leibler (KL) divergence of cross-branch predictions.
FedNTD <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite> generates outputs from global and local models, discarding logits belonging to the ground-truth class while minimizing the KL divergence between the modified predictions.
FedBR <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib9" title="" class="ltx_ref">2023b</a>)</cite> FedBR <cite class="ltx_cite ltx_citemacro_citep">(Guo et al., <a href="#bib.bib9" title="" class="ltx_ref">2023b</a>)</cite> reduces learning biases on local features and classifiers through mix-max optimization.
FedDisco <cite class="ltx_cite ltx_citemacro_citep">(Ye et al., <a href="#bib.bib35" title="" class="ltx_ref">2023</a>)</cite> aggregates local model parameters based on the discrepancy between local and global category distributions on the server.
FedSMOO <cite class="ltx_cite ltx_citemacro_citep">(Sun et al., <a href="#bib.bib30" title="" class="ltx_ref">2023</a>)</cite> adopts a dynamic regularizer to align local and global objectives and employs a global sharpness-aware minimization optimizer to find consistent flat minima.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Semi-Supervised Federated Learning</span> Recent works have relaxed the full supervision requirement and explored semi-supervised scenarios.
FedMatch <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib12" title="" class="ltx_ref">2021</a>)</cite>
integrates federated learning and semi-supervised learning with an inter-client consistency loss.
FedRGD <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite> employs consistency regularization loss and group normalization for local updates on the client side, along with a grouping-based model averaging method for aggregation on the server side.
SemiFL <cite class="ltx_cite ltx_citemacro_citep">(Diao et al., <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite> employs semi-supervised learning approaches for local updates and assumes extra labeled data on the server for aggregated model fine-tuning.
Other works go even further to relax data annotation requirements.
FedPU <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite> assumes that each client labels only a portion of data from specific classes and uses positive and unlabeled learning methods for local updates.
FedUL <cite class="ltx_cite ltx_citemacro_citep">(Lu et al., <a href="#bib.bib22" title="" class="ltx_ref">2022</a>)</cite> introduces federated learning with only unlabeled data,
but requires
knowledge of precise label frequencies for each client. It transforms unlabeled data into surrogate labeled data and recovers local models from
models trained with the surrogate labeled data.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Pretrained Vision-language Models</span> Pretrained Vision-Language Models
have gained popularity for their ability to learn image and text encoders from large image-text datasets. These models exhibit promising zero-shot prediction capabilities.
CLIP <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite> trains paired image and text encoders mainly used for image classification and retrieval.
ALIGN <cite class="ltx_cite ltx_citemacro_citep">(Jia et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> trains visual and language representations using noisy image and alt-text data.
Subsequent models emphasize diverse tasks or expand the CLIP model.
BLIP <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib18" title="" class="ltx_ref">2022</a>)</cite> focuses on language-image pretraining for both
vision-language understanding and generation with filtered captions.
FLAVA <cite class="ltx_cite ltx_citemacro_citep">(Singh et al., <a href="#bib.bib29" title="" class="ltx_ref">2022</a>)</cite> learns representations from paired and unpaired images and text, featuring multimodal and unimodal encoders.
SimVLM <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib34" title="" class="ltx_ref">2022</a>)</cite> simplifies training complexity with large-scale weak supervision and a prefix language modeling objective.
AltCLIP <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib1" title="" class="ltx_ref">2023</a>)</cite> extends CLIP’s text encoder to a multilingual text encoder for multilingual understanding.
FashionCLIP <cite class="ltx_cite ltx_citemacro_citep">(Chia et al., <a href="#bib.bib2" title="" class="ltx_ref">2022</a>)</cite> and PLIP <cite class="ltx_cite ltx_citemacro_citep">(Huang et al., <a href="#bib.bib11" title="" class="ltx_ref">2023</a>)</cite> fine-tune the CLIP model on special types of data.
Recent research has harnessed such pretrained vision-language models, primarily CLIP, for various downstream applications.
<cite class="ltx_cite ltx_citemacro_citet">Menon &amp; Vondrick (<a href="#bib.bib26" title="" class="ltx_ref">2023</a>)</cite> leveraged large language models to generate descriptions for objects used in classification tasks, enhancing the zero-shot prediction capabilities of CLIP.
<cite class="ltx_cite ltx_citemacro_citet">Dunlap et al. (<a href="#bib.bib5" title="" class="ltx_ref">2023</a>)</cite> employed CLIP to generate augmented domain-specific visual embedding for domain adaptation.
<cite class="ltx_cite ltx_citemacro_citet">Lüddecke &amp; Ecker (<a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite> extended CLIP by incorporating a transformer-based decoder for semantic segmentation tasks.
<cite class="ltx_cite ltx_citemacro_citet">Gu et al. (<a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite> conducted knowledge distillation from a pretrained open-vocabulary image classification model into a two-stage detector for object detection.
<cite class="ltx_cite ltx_citemacro_citet">Guo et al. (<a href="#bib.bib8" title="" class="ltx_ref">2023a</a>)</cite> adapted CLIP with prompt learning techniques for personalized supervised federated learning.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p">In this section, we present the proposed method, Federated Self-Training with Class-Balanced Data Generation (FST-CBDG),
for achieving lightweight unsupervised federated learning,
where only unlabeled data, and limited computation and communication resources are available on each local client.
The method centers on constructing a lightweight unsupervised federated learning framework
by harnessing pretrained vision-language models, particularly CLIP,
devising an effective self-training mechanism
to improve noisy pseudo-labels and hence model performance through moving average soft label updates,
and tackling the data imbalance and heterogeneity problem on local clients
via class-balanced data generation.
The framework of the proposed FST-CBDG method is presented in Figure <a href="#S3.F1" title="Figure 1 ‣ 3 Proposed Method ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
We elaborate this approach in subsequent subsections.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2404.11046/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="158" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Framework of the proposed FST-CBDG method for lightweight unsupervised federated learning.
In the server preparation stage,
the CLIP image encoder and the categorical text features extracted using the CLIP text encoder
are distributed to each client.
During local training,
extracted image features from the fixed CLIP image encoder are used for self-training of the linear classifier. Synthetic instances are generated in the feature space via class-balanced Gaussian sampling to address the data heterogeneity problem.</figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Lightweight Unsupervised Federated Learning Framework</h3>

<div id="S3.SS1.p1" class="ltx_para ltx_noindent">
<p id="S3.SS1.p1.1" class="ltx_p">Deep classification models typically
consist of a deep feature encoder that maps high-dimensional raw image data to high-level
feature representations and a shallow classifier to make predictions based on these high-level representations.
However, training deep models on clients requires substantial labeled data and computational resources,
and transmitting these models between clients and the server demands expensive communication bandwidth.
To bypass such demanding training and communication requirements
and realize lightweight unsupervised federated learning,
we propose to initialize a federated learning framework by
utilizing the recent pretrained vision-language models, particularly CLIP,
for their impressive zero-shot transfer capabilities on downstream tasks.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para ltx_noindent">
<p id="S3.SS1.p2.2" class="ltx_p">CLIP trains image and text encoders using extensive datasets of image-caption pairs,
offering well trained encoders that can
extract visual and textual features in aligned feature spaces.
With such aligned encoders,
zero-shot image classification can be easily achieved by mapping
extracted test image features
based on cosine similarity
to the text features extracted from
sentences constructed from candidate category names.
For unsupervised federated learning,
we leverage CLIP’s zero-shot prediction capability to prepare
the federated learning model at the server side.
Specifically, we first deploy CLIP’s text encoder to extract textual features
for the set of predefined class categories.
For example, to obtain the textual feature vector for the class “plane”,
a sentence such like “a photo of a plane” can be input to CLIP’s text encoder,
resulting in the desired textual feature vector.
Next, we form a prediction model by
adding a linear classification layer on top of the pretrained and fixed CLIP image encoder,
which produces a multi-class probabilistic classifier</p>
<table id="A1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.4" class="ltx_Math" alttext="\displaystyle f({\mathbf{z}};W,{\mathbf{b}})=\mbox{softmax}(W{\mathbf{z}}+{\mathbf{b}})" display="inline"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml"><mrow id="S3.E1.m1.4.4.3" xref="S3.E1.m1.4.4.3.cmml"><mi id="S3.E1.m1.4.4.3.2" xref="S3.E1.m1.4.4.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.3.1" xref="S3.E1.m1.4.4.3.1.cmml">​</mo><mrow id="S3.E1.m1.4.4.3.3.2" xref="S3.E1.m1.4.4.3.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.3.3.2.1" xref="S3.E1.m1.4.4.3.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝐳</mi><mo id="S3.E1.m1.4.4.3.3.2.2" xref="S3.E1.m1.4.4.3.3.1.cmml">;</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">W</mi><mo id="S3.E1.m1.4.4.3.3.2.3" xref="S3.E1.m1.4.4.3.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">𝐛</mi><mo stretchy="false" id="S3.E1.m1.4.4.3.3.2.4" xref="S3.E1.m1.4.4.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.4.4.2" xref="S3.E1.m1.4.4.2.cmml">=</mo><mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.cmml"><mtext id="S3.E1.m1.4.4.1.3" xref="S3.E1.m1.4.4.1.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.2" xref="S3.E1.m1.4.4.1.2.cmml">​</mo><mrow id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.4.4.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.4.4.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1.1.1.2" xref="S3.E1.m1.4.4.1.1.1.1.2.cmml"><mi id="S3.E1.m1.4.4.1.1.1.1.2.2" xref="S3.E1.m1.4.4.1.1.1.1.2.2.cmml">W</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.4.1.1.1.1.2.1" xref="S3.E1.m1.4.4.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E1.m1.4.4.1.1.1.1.2.3" xref="S3.E1.m1.4.4.1.1.1.1.2.3.cmml">𝐳</mi></mrow><mo id="S3.E1.m1.4.4.1.1.1.1.1" xref="S3.E1.m1.4.4.1.1.1.1.1.cmml">+</mo><mi id="S3.E1.m1.4.4.1.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.3.cmml">𝐛</mi></mrow><mo stretchy="false" id="S3.E1.m1.4.4.1.1.1.3" xref="S3.E1.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4"><eq id="S3.E1.m1.4.4.2.cmml" xref="S3.E1.m1.4.4.2"></eq><apply id="S3.E1.m1.4.4.3.cmml" xref="S3.E1.m1.4.4.3"><times id="S3.E1.m1.4.4.3.1.cmml" xref="S3.E1.m1.4.4.3.1"></times><ci id="S3.E1.m1.4.4.3.2.cmml" xref="S3.E1.m1.4.4.3.2">𝑓</ci><list id="S3.E1.m1.4.4.3.3.1.cmml" xref="S3.E1.m1.4.4.3.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐳</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑊</ci><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝐛</ci></list></apply><apply id="S3.E1.m1.4.4.1.cmml" xref="S3.E1.m1.4.4.1"><times id="S3.E1.m1.4.4.1.2.cmml" xref="S3.E1.m1.4.4.1.2"></times><ci id="S3.E1.m1.4.4.1.3a.cmml" xref="S3.E1.m1.4.4.1.3"><mtext id="S3.E1.m1.4.4.1.3.cmml" xref="S3.E1.m1.4.4.1.3">softmax</mtext></ci><apply id="S3.E1.m1.4.4.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1"><plus id="S3.E1.m1.4.4.1.1.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.1"></plus><apply id="S3.E1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2"><times id="S3.E1.m1.4.4.1.1.1.1.2.1.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.1"></times><ci id="S3.E1.m1.4.4.1.1.1.1.2.2.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.2">𝑊</ci><ci id="S3.E1.m1.4.4.1.1.1.1.2.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.2.3">𝐳</ci></apply><ci id="S3.E1.m1.4.4.1.1.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.1.1.3">𝐛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\displaystyle f({\mathbf{z}};W,{\mathbf{b}})=\mbox{softmax}(W{\mathbf{z}}+{\mathbf{b}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.1" class="ltx_p">in the aligned feature space <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{Z}</annotation></semantics></math>.
A linear classifier is chosen for two compelling reasons:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p">Linear classifiers have significantly fewer parameters compared to full-fledged deep models,
offering a lightweight training and transmitting mechanism for federated learning
when fixing the pretrained CLIP image encoder.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para ltx_noindent">
<p id="S3.I1.i2.p1.2" class="ltx_p">The weight parameters <math id="S3.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="{W}" display="inline"><semantics id="S3.I1.i2.p1.1.m1.1a"><mi id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><ci id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">{W}</annotation></semantics></math> of the linear classifier can be initialized with textual features
extracted from the CLIP text encoder for the predefined class categories, while setting <math id="S3.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="{\mathbf{b}}=0" display="inline"><semantics id="S3.I1.i2.p1.2.m2.1a"><mrow id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.2.cmml">𝐛</mi><mo id="S3.I1.i2.p1.2.m2.1.1.1" xref="S3.I1.i2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.I1.i2.p1.2.m2.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><apply id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1"><eq id="S3.I1.i2.p1.2.m2.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.1"></eq><ci id="S3.I1.i2.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2">𝐛</ci><cn type="integer" id="S3.I1.i2.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">{\mathbf{b}}=0</annotation></semantics></math>.
Based on the zero-shot prediction capability of the CLIP model,
this initialization not only provides the ability of predicting initial pseudo-labels for unlabeled data,
but also can
substantially enhance the convergence rate of the subsequent federated learning.</p>
</div>
</li>
</ul>
<p id="S3.SS1.p2.3" class="ltx_p">The textual features of the class categories and the initialized prediction model
can be subsequently distributed to all the clients to produce the initial pseudo-labels on the unlabeled data
and start the lightweight federated learning process:
In each round, each client makes local updates on the linear classifier,
which is then uploaded to the server for model aggregation;
we adopt the simple average aggregation procedure of FedAvg.
Therefore, we obtain a feasible initial framework for lightweight unsupervised federated learning.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Resilient Self-Training with Evolving Pseudo-Labels</h3>

<figure id="S3.F2" class="ltx_figure ltx_align_floatright"><img src="/html/2404.11046/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="211" height="158" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Entropy distribution of predicted probability vectors. Green dots represents the entropy for each sample and red line denotes the upper bound of the entropy (<math id="S3.F2.2.m1.1" class="ltx_Math" alttext="\log 10\approx 3.322" display="inline"><semantics id="S3.F2.2.m1.1b"><mrow id="S3.F2.2.m1.1.1" xref="S3.F2.2.m1.1.1.cmml"><mrow id="S3.F2.2.m1.1.1.2" xref="S3.F2.2.m1.1.1.2.cmml"><mi id="S3.F2.2.m1.1.1.2.1" xref="S3.F2.2.m1.1.1.2.1.cmml">log</mi><mo lspace="0.167em" id="S3.F2.2.m1.1.1.2b" xref="S3.F2.2.m1.1.1.2.cmml">⁡</mo><mn id="S3.F2.2.m1.1.1.2.2" xref="S3.F2.2.m1.1.1.2.2.cmml">10</mn></mrow><mo id="S3.F2.2.m1.1.1.1" xref="S3.F2.2.m1.1.1.1.cmml">≈</mo><mn id="S3.F2.2.m1.1.1.3" xref="S3.F2.2.m1.1.1.3.cmml">3.322</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.2.m1.1c"><apply id="S3.F2.2.m1.1.1.cmml" xref="S3.F2.2.m1.1.1"><approx id="S3.F2.2.m1.1.1.1.cmml" xref="S3.F2.2.m1.1.1.1"></approx><apply id="S3.F2.2.m1.1.1.2.cmml" xref="S3.F2.2.m1.1.1.2"><log id="S3.F2.2.m1.1.1.2.1.cmml" xref="S3.F2.2.m1.1.1.2.1"></log><cn type="integer" id="S3.F2.2.m1.1.1.2.2.cmml" xref="S3.F2.2.m1.1.1.2.2">10</cn></apply><cn type="float" id="S3.F2.2.m1.1.1.3.cmml" xref="S3.F2.2.m1.1.1.3">3.322</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.2.m1.1d">\log 10\approx 3.322</annotation></semantics></math>).</figcaption>
</figure>
<div id="S3.SS2.p1" class="ltx_para ltx_noindent">
<p id="S3.SS2.p1.7" class="ltx_p">Employing the pseudo-labels generated from
CLIP model’s zero-shot predictions as targets
for federated learning, however, can often yield suboptimal results
due to the low quality of these initial labels.
An observation worth noting is that
on benchmark datasets
these initial predicted probabilities for each class are typically close to each other,
and the CLIP zero-shot model tends to make low-confidence predictions on the unlabeled data.
To empirically demonstrate the characteristics of the predicted probability vectors from the zero-shot CLIP model,
we conducted an entropy analysis using a dataset of 1000 randomly sampled images from CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib16" title="" class="ltx_ref">2009</a>)</cite>.
To elaborate, let’s denote an image as <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\bm{x}_{j}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">𝒙</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝒙</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\bm{x}_{j}</annotation></semantics></math> and its extracted image features as <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\bm{I}_{j}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">𝑰</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑰</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\bm{I}_{j}</annotation></semantics></math>. We also denote the text features for each class <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">k</annotation></semantics></math> as <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="\bm{T}_{k}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">𝑻</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑻</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">\bm{T}_{k}</annotation></semantics></math>, where <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="1\leq k\leq K" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mn id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">1</mn><mo id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">≤</mo><mi id="S3.SS2.p1.5.m5.1.1.4" xref="S3.SS2.p1.5.m5.1.1.4.cmml">k</mi><mo id="S3.SS2.p1.5.m5.1.1.5" xref="S3.SS2.p1.5.m5.1.1.5.cmml">≤</mo><mi id="S3.SS2.p1.5.m5.1.1.6" xref="S3.SS2.p1.5.m5.1.1.6.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><and id="S3.SS2.p1.5.m5.1.1a.cmml" xref="S3.SS2.p1.5.m5.1.1"></and><apply id="S3.SS2.p1.5.m5.1.1b.cmml" xref="S3.SS2.p1.5.m5.1.1"><leq id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"></leq><cn type="integer" id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">1</cn><ci id="S3.SS2.p1.5.m5.1.1.4.cmml" xref="S3.SS2.p1.5.m5.1.1.4">𝑘</ci></apply><apply id="S3.SS2.p1.5.m5.1.1c.cmml" xref="S3.SS2.p1.5.m5.1.1"><leq id="S3.SS2.p1.5.m5.1.1.5.cmml" xref="S3.SS2.p1.5.m5.1.1.5"></leq><share href="#S3.SS2.p1.5.m5.1.1.4.cmml" id="S3.SS2.p1.5.m5.1.1d.cmml" xref="S3.SS2.p1.5.m5.1.1"></share><ci id="S3.SS2.p1.5.m5.1.1.6.cmml" xref="S3.SS2.p1.5.m5.1.1.6">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">1\leq k\leq K</annotation></semantics></math>, with <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">K</annotation></semantics></math> being the total number of classes. The probability vector resulting from the CLIP zero-shot prediction for image <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="\bm{x}_{j}" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">𝒙</mi><mi id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝒙</ci><ci id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">\bm{x}_{j}</annotation></semantics></math> can be calculated as</p>
<table id="A1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.3" class="ltx_Math" alttext="\displaystyle\bm{p}_{j}=[p_{j1},\cdots,p_{jK}]=\text{softmax}([\bm{I}_{j}\cdot\bm{T}_{1},\cdots,\bm{I}_{j}\cdot\bm{T}_{K}])." display="inline"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.1.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><msub id="S3.E2.m1.3.3.1.1.5" xref="S3.E2.m1.3.3.1.1.5.cmml"><mi id="S3.E2.m1.3.3.1.1.5.2" xref="S3.E2.m1.3.3.1.1.5.2.cmml">𝒑</mi><mi id="S3.E2.m1.3.3.1.1.5.3" xref="S3.E2.m1.3.3.1.1.5.3.cmml">j</mi></msub><mo id="S3.E2.m1.3.3.1.1.6" xref="S3.E2.m1.3.3.1.1.6.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.2.2" xref="S3.E2.m1.3.3.1.1.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.2.3.cmml">[</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.2.cmml">p</mi><mrow id="S3.E2.m1.3.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.1.1.1.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.1.1.1.3.1" xref="S3.E2.m1.3.3.1.1.1.1.1.3.1.cmml">​</mo><mn id="S3.E2.m1.3.3.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S3.E2.m1.3.3.1.1.2.2.4" xref="S3.E2.m1.3.3.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">⋯</mi><mo id="S3.E2.m1.3.3.1.1.2.2.5" xref="S3.E2.m1.3.3.1.1.2.3.cmml">,</mo><msub id="S3.E2.m1.3.3.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.2.cmml">p</mi><mrow id="S3.E2.m1.3.3.1.1.2.2.2.3" xref="S3.E2.m1.3.3.1.1.2.2.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2.2.3.2" xref="S3.E2.m1.3.3.1.1.2.2.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.2.2.2.3.1" xref="S3.E2.m1.3.3.1.1.2.2.2.3.1.cmml">​</mo><mi id="S3.E2.m1.3.3.1.1.2.2.2.3.3" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3.cmml">K</mi></mrow></msub><mo stretchy="false" id="S3.E2.m1.3.3.1.1.2.2.6" xref="S3.E2.m1.3.3.1.1.2.3.cmml">]</mo></mrow><mo id="S3.E2.m1.3.3.1.1.7" xref="S3.E2.m1.3.3.1.1.7.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml"><mtext id="S3.E2.m1.3.3.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.3a.cmml">softmax</mtext><mo lspace="0em" rspace="0em" id="S3.E2.m1.3.3.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.2.cmml">​</mo><mrow id="S3.E2.m1.3.3.1.1.3.1.1" xref="S3.E2.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3.1.1.2" xref="S3.E2.m1.3.3.1.1.3.cmml">(</mo><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3.1.1.1.2.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.3.cmml">[</mo><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.cmml"><msub id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.2.cmml">𝑰</mi><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.3.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.cmml">⋅</mo><msub id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.2.cmml">𝑻</mi><mn id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.2.4" xref="S3.E2.m1.3.3.1.1.3.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">⋯</mi><mo id="S3.E2.m1.3.3.1.1.3.1.1.1.2.5" xref="S3.E2.m1.3.3.1.1.3.1.1.1.3.cmml">,</mo><mrow id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.cmml"><msub id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.2.cmml">𝑰</mi><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.3.cmml">j</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.1" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.1.cmml">⋅</mo><msub id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.2" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.2.cmml">𝑻</mi><mi id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.3" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.3.cmml">K</mi></msub></mrow><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3.1.1.1.2.6" xref="S3.E2.m1.3.3.1.1.3.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S3.E2.m1.3.3.1.1.3.1.1.3" xref="S3.E2.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.3b"><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1"><and id="S3.E2.m1.3.3.1.1a.cmml" xref="S3.E2.m1.3.3.1"></and><apply id="S3.E2.m1.3.3.1.1b.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.6.cmml" xref="S3.E2.m1.3.3.1.1.6"></eq><apply id="S3.E2.m1.3.3.1.1.5.cmml" xref="S3.E2.m1.3.3.1.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.5.1.cmml" xref="S3.E2.m1.3.3.1.1.5">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.5.2.cmml" xref="S3.E2.m1.3.3.1.1.5.2">𝒑</ci><ci id="S3.E2.m1.3.3.1.1.5.3.cmml" xref="S3.E2.m1.3.3.1.1.5.3">𝑗</ci></apply><list id="S3.E2.m1.3.3.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2"><apply id="S3.E2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.2">𝑝</ci><apply id="S3.E2.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3"><times id="S3.E2.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3.1"></times><ci id="S3.E2.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3.2">𝑗</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">⋯</ci><apply id="S3.E2.m1.3.3.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.2">𝑝</ci><apply id="S3.E2.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3"><times id="S3.E2.m1.3.3.1.1.2.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.1"></times><ci id="S3.E2.m1.3.3.1.1.2.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.2">𝑗</ci><ci id="S3.E2.m1.3.3.1.1.2.2.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.3.3">𝐾</ci></apply></apply></list></apply><apply id="S3.E2.m1.3.3.1.1c.cmml" xref="S3.E2.m1.3.3.1"><eq id="S3.E2.m1.3.3.1.1.7.cmml" xref="S3.E2.m1.3.3.1.1.7"></eq><share href="#S3.E2.m1.3.3.1.1.2.cmml" id="S3.E2.m1.3.3.1.1d.cmml" xref="S3.E2.m1.3.3.1"></share><apply id="S3.E2.m1.3.3.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3"><times id="S3.E2.m1.3.3.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.2"></times><ci id="S3.E2.m1.3.3.1.1.3.3a.cmml" xref="S3.E2.m1.3.3.1.1.3.3"><mtext id="S3.E2.m1.3.3.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3">softmax</mtext></ci><list id="S3.E2.m1.3.3.1.1.3.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2"><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1"><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.1">⋅</ci><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.2">𝑰</ci><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.2">𝑻</ci><cn type="integer" id="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">⋯</ci><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2"><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.1">⋅</ci><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.2">𝑰</ci><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.2.3">𝑗</ci></apply><apply id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.2">𝑻</ci><ci id="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.1.1.1.2.2.3.3">𝐾</ci></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.3c">\displaystyle\bm{p}_{j}=[p_{j1},\cdots,p_{jK}]=\text{softmax}([\bm{I}_{j}\cdot\bm{T}_{1},\cdots,\bm{I}_{j}\cdot\bm{T}_{K}]).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.12" class="ltx_p">The confidence level of the prediction can then be measured using the entropy value of
the vector <math id="S3.SS2.p1.8.m1.1" class="ltx_Math" alttext="\bm{p}_{j}" display="inline"><semantics id="S3.SS2.p1.8.m1.1a"><msub id="S3.SS2.p1.8.m1.1.1" xref="S3.SS2.p1.8.m1.1.1.cmml"><mi id="S3.SS2.p1.8.m1.1.1.2" xref="S3.SS2.p1.8.m1.1.1.2.cmml">𝒑</mi><mi id="S3.SS2.p1.8.m1.1.1.3" xref="S3.SS2.p1.8.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m1.1b"><apply id="S3.SS2.p1.8.m1.1.1.cmml" xref="S3.SS2.p1.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m1.1.1.1.cmml" xref="S3.SS2.p1.8.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m1.1.1.2.cmml" xref="S3.SS2.p1.8.m1.1.1.2">𝒑</ci><ci id="S3.SS2.p1.8.m1.1.1.3.cmml" xref="S3.SS2.p1.8.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m1.1c">\bm{p}_{j}</annotation></semantics></math>: <math id="S3.SS2.p1.9.m2.1" class="ltx_Math" alttext="H(\bm{p}_{j})=-\sum_{k=1}^{K}p_{jk}\log p_{jk}" display="inline"><semantics id="S3.SS2.p1.9.m2.1a"><mrow id="S3.SS2.p1.9.m2.1.1" xref="S3.SS2.p1.9.m2.1.1.cmml"><mrow id="S3.SS2.p1.9.m2.1.1.1" xref="S3.SS2.p1.9.m2.1.1.1.cmml"><mi id="S3.SS2.p1.9.m2.1.1.1.3" xref="S3.SS2.p1.9.m2.1.1.1.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m2.1.1.1.2" xref="S3.SS2.p1.9.m2.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.9.m2.1.1.1.1.1" xref="S3.SS2.p1.9.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.9.m2.1.1.1.1.1.2" xref="S3.SS2.p1.9.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.p1.9.m2.1.1.1.1.1.1" xref="S3.SS2.p1.9.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.9.m2.1.1.1.1.1.1.2" xref="S3.SS2.p1.9.m2.1.1.1.1.1.1.2.cmml">𝒑</mi><mi id="S3.SS2.p1.9.m2.1.1.1.1.1.1.3" xref="S3.SS2.p1.9.m2.1.1.1.1.1.1.3.cmml">j</mi></msub><mo stretchy="false" id="S3.SS2.p1.9.m2.1.1.1.1.1.3" xref="S3.SS2.p1.9.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.p1.9.m2.1.1.2" xref="S3.SS2.p1.9.m2.1.1.2.cmml">=</mo><mrow id="S3.SS2.p1.9.m2.1.1.3" xref="S3.SS2.p1.9.m2.1.1.3.cmml"><mo id="S3.SS2.p1.9.m2.1.1.3a" xref="S3.SS2.p1.9.m2.1.1.3.cmml">−</mo><mrow id="S3.SS2.p1.9.m2.1.1.3.2" xref="S3.SS2.p1.9.m2.1.1.3.2.cmml"><msubsup id="S3.SS2.p1.9.m2.1.1.3.2.1" xref="S3.SS2.p1.9.m2.1.1.3.2.1.cmml"><mo id="S3.SS2.p1.9.m2.1.1.3.2.1.2.2" xref="S3.SS2.p1.9.m2.1.1.3.2.1.2.2.cmml">∑</mo><mrow id="S3.SS2.p1.9.m2.1.1.3.2.1.2.3" xref="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.cmml"><mi id="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.2" xref="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.2.cmml">k</mi><mo id="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.1" xref="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.1.cmml">=</mo><mn id="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.3" xref="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.9.m2.1.1.3.2.1.3" xref="S3.SS2.p1.9.m2.1.1.3.2.1.3.cmml">K</mi></msubsup><mrow id="S3.SS2.p1.9.m2.1.1.3.2.2" xref="S3.SS2.p1.9.m2.1.1.3.2.2.cmml"><msub id="S3.SS2.p1.9.m2.1.1.3.2.2.2" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.cmml"><mi id="S3.SS2.p1.9.m2.1.1.3.2.2.2.2" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.2.cmml">p</mi><mrow id="S3.SS2.p1.9.m2.1.1.3.2.2.2.3" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.cmml"><mi id="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.2" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.1" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.3" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.3.cmml">k</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S3.SS2.p1.9.m2.1.1.3.2.2.1" xref="S3.SS2.p1.9.m2.1.1.3.2.2.1.cmml">​</mo><mrow id="S3.SS2.p1.9.m2.1.1.3.2.2.3" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.cmml"><mi id="S3.SS2.p1.9.m2.1.1.3.2.2.3.1" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS2.p1.9.m2.1.1.3.2.2.3a" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.cmml">⁡</mo><msub id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.cmml"><mi id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.2" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.2.cmml">p</mi><mrow id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.cmml"><mi id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.2" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.1" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.3" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.3.cmml">k</mi></mrow></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m2.1b"><apply id="S3.SS2.p1.9.m2.1.1.cmml" xref="S3.SS2.p1.9.m2.1.1"><eq id="S3.SS2.p1.9.m2.1.1.2.cmml" xref="S3.SS2.p1.9.m2.1.1.2"></eq><apply id="S3.SS2.p1.9.m2.1.1.1.cmml" xref="S3.SS2.p1.9.m2.1.1.1"><times id="S3.SS2.p1.9.m2.1.1.1.2.cmml" xref="S3.SS2.p1.9.m2.1.1.1.2"></times><ci id="S3.SS2.p1.9.m2.1.1.1.3.cmml" xref="S3.SS2.p1.9.m2.1.1.1.3">𝐻</ci><apply id="S3.SS2.p1.9.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.9.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.9.m2.1.1.1.1.1.1.2">𝒑</ci><ci id="S3.SS2.p1.9.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.9.m2.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S3.SS2.p1.9.m2.1.1.3.cmml" xref="S3.SS2.p1.9.m2.1.1.3"><minus id="S3.SS2.p1.9.m2.1.1.3.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3"></minus><apply id="S3.SS2.p1.9.m2.1.1.3.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2"><apply id="S3.SS2.p1.9.m2.1.1.3.2.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m2.1.1.3.2.1.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.1">superscript</csymbol><apply id="S3.SS2.p1.9.m2.1.1.3.2.1.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m2.1.1.3.2.1.2.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.1">subscript</csymbol><sum id="S3.SS2.p1.9.m2.1.1.3.2.1.2.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.1.2.2"></sum><apply id="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.1.2.3"><eq id="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.1"></eq><ci id="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.3.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS2.p1.9.m2.1.1.3.2.1.3.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.1.3">𝐾</ci></apply><apply id="S3.SS2.p1.9.m2.1.1.3.2.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2"><times id="S3.SS2.p1.9.m2.1.1.3.2.2.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.1"></times><apply id="S3.SS2.p1.9.m2.1.1.3.2.2.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m2.1.1.3.2.2.2.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.9.m2.1.1.3.2.2.2.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.2">𝑝</ci><apply id="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.3"><times id="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.1"></times><ci id="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.2">𝑗</ci><ci id="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.3.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.2.3.3">𝑘</ci></apply></apply><apply id="S3.SS2.p1.9.m2.1.1.3.2.2.3.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3"><log id="S3.SS2.p1.9.m2.1.1.3.2.2.3.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.1"></log><apply id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2">subscript</csymbol><ci id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.2">𝑝</ci><apply id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3"><times id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.1.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.1"></times><ci id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.2.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.2">𝑗</ci><ci id="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.3.cmml" xref="S3.SS2.p1.9.m2.1.1.3.2.2.3.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m2.1c">H(\bm{p}_{j})=-\sum_{k=1}^{K}p_{jk}\log p_{jk}</annotation></semantics></math>.
The upper bound for this entropy is <math id="S3.SS2.p1.10.m3.1" class="ltx_Math" alttext="\log K" display="inline"><semantics id="S3.SS2.p1.10.m3.1a"><mrow id="S3.SS2.p1.10.m3.1.1" xref="S3.SS2.p1.10.m3.1.1.cmml"><mi id="S3.SS2.p1.10.m3.1.1.1" xref="S3.SS2.p1.10.m3.1.1.1.cmml">log</mi><mo lspace="0.167em" id="S3.SS2.p1.10.m3.1.1a" xref="S3.SS2.p1.10.m3.1.1.cmml">⁡</mo><mi id="S3.SS2.p1.10.m3.1.1.2" xref="S3.SS2.p1.10.m3.1.1.2.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m3.1b"><apply id="S3.SS2.p1.10.m3.1.1.cmml" xref="S3.SS2.p1.10.m3.1.1"><log id="S3.SS2.p1.10.m3.1.1.1.cmml" xref="S3.SS2.p1.10.m3.1.1.1"></log><ci id="S3.SS2.p1.10.m3.1.1.2.cmml" xref="S3.SS2.p1.10.m3.1.1.2">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m3.1c">\log K</annotation></semantics></math>, which can only be reached when the predicted probability vector is a uniform vector.
The results of this analysis are visualized in Figure <a href="#S3.F2" title="Figure 2 ‣ 3.2 Resilient Self-Training with Evolving Pseudo-Labels ‣ 3 Proposed Method ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> which shows the entropy values corresponding to the 1000 image samples as well as the upper bound for the entropy of a probability vector with <math id="S3.SS2.p1.11.m4.1" class="ltx_Math" alttext="K=10" display="inline"><semantics id="S3.SS2.p1.11.m4.1a"><mrow id="S3.SS2.p1.11.m4.1.1" xref="S3.SS2.p1.11.m4.1.1.cmml"><mi id="S3.SS2.p1.11.m4.1.1.2" xref="S3.SS2.p1.11.m4.1.1.2.cmml">K</mi><mo id="S3.SS2.p1.11.m4.1.1.1" xref="S3.SS2.p1.11.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.11.m4.1.1.3" xref="S3.SS2.p1.11.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m4.1b"><apply id="S3.SS2.p1.11.m4.1.1.cmml" xref="S3.SS2.p1.11.m4.1.1"><eq id="S3.SS2.p1.11.m4.1.1.1.cmml" xref="S3.SS2.p1.11.m4.1.1.1"></eq><ci id="S3.SS2.p1.11.m4.1.1.2.cmml" xref="S3.SS2.p1.11.m4.1.1.2">𝐾</ci><cn type="integer" id="S3.SS2.p1.11.m4.1.1.3.cmml" xref="S3.SS2.p1.11.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m4.1c">K=10</annotation></semantics></math> classes.
From the figure, it is evident that the entropy values for all the sampled images
are very close to the upper bound value of <math id="S3.SS2.p1.12.m5.2" class="ltx_Math" alttext="\log(10)" display="inline"><semantics id="S3.SS2.p1.12.m5.2a"><mrow id="S3.SS2.p1.12.m5.2.3.2" xref="S3.SS2.p1.12.m5.2.3.1.cmml"><mi id="S3.SS2.p1.12.m5.1.1" xref="S3.SS2.p1.12.m5.1.1.cmml">log</mi><mo id="S3.SS2.p1.12.m5.2.3.2a" xref="S3.SS2.p1.12.m5.2.3.1.cmml">⁡</mo><mrow id="S3.SS2.p1.12.m5.2.3.2.1" xref="S3.SS2.p1.12.m5.2.3.1.cmml"><mo stretchy="false" id="S3.SS2.p1.12.m5.2.3.2.1.1" xref="S3.SS2.p1.12.m5.2.3.1.cmml">(</mo><mn id="S3.SS2.p1.12.m5.2.2" xref="S3.SS2.p1.12.m5.2.2.cmml">10</mn><mo stretchy="false" id="S3.SS2.p1.12.m5.2.3.2.1.2" xref="S3.SS2.p1.12.m5.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m5.2b"><apply id="S3.SS2.p1.12.m5.2.3.1.cmml" xref="S3.SS2.p1.12.m5.2.3.2"><log id="S3.SS2.p1.12.m5.1.1.cmml" xref="S3.SS2.p1.12.m5.1.1"></log><cn type="integer" id="S3.SS2.p1.12.m5.2.2.cmml" xref="S3.SS2.p1.12.m5.2.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m5.2c">\log(10)</annotation></semantics></math>.
This observation demonstrates that the zero-shot CLIP model often produces probability vectors that are close to a uniform distribution across classes, resulting in low-confidence predictions.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.2" class="ltx_p">To address the challenge posed by low-confidence initial pseudo-labels,
we have devised a carefully crafted self-training method to progressively update and improve the pseudo-labels.
It is evident that generating one-hot pseudo-labels from the low-confidence predictions during linear classifier training
can often result in large errors and degrade the training process.
Therefore, we opt for using soft pseudo-labels for self-training and update these labels using a moving average approach.
In the <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">t</annotation></semantics></math>-th iteration,
we use the following cross-entropy loss on <span id="S3.SS2.p2.2.1" class="ltx_text ltx_font_italic">images</span> as the <span id="S3.SS2.p2.2.2" class="ltx_text ltx_font_italic">S</span>elf-<span id="S3.SS2.p2.2.3" class="ltx_text ltx_font_italic">T</span>raining objective
for the linear classifier <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="f(\cdot)" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.2" xref="S3.SS2.p2.2.m2.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.2.2" xref="S3.SS2.p2.2.m2.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.2.m2.1.2.1" xref="S3.SS2.p2.2.m2.1.2.1.cmml">​</mo><mrow id="S3.SS2.p2.2.m2.1.2.3.2" xref="S3.SS2.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.2.m2.1.2.3.2.1" xref="S3.SS2.p2.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p2.2.m2.1.2.3.2.2" xref="S3.SS2.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.2.cmml" xref="S3.SS2.p2.2.m2.1.2"><times id="S3.SS2.p2.2.m2.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.2.1"></times><ci id="S3.SS2.p2.2.m2.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.2.2">𝑓</ci><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">f(\cdot)</annotation></semantics></math> on each client:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.3" class="ltx_Math" alttext="\mathcal{L}_{iST}=-\mathbb{E}_{\bm{I}_{j}}[\bm{q}^{t}_{j}\cdot\log f(\bm{I}_{j};W,{\mathbf{b}})]" display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml"><msub id="S3.E3.m1.3.3.3" xref="S3.E3.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.3.3.3.2" xref="S3.E3.m1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E3.m1.3.3.3.3" xref="S3.E3.m1.3.3.3.3.cmml"><mi id="S3.E3.m1.3.3.3.3.2" xref="S3.E3.m1.3.3.3.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.3.3.1" xref="S3.E3.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E3.m1.3.3.3.3.3" xref="S3.E3.m1.3.3.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.3.3.1a" xref="S3.E3.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E3.m1.3.3.3.3.4" xref="S3.E3.m1.3.3.3.3.4.cmml">T</mi></mrow></msub><mo id="S3.E3.m1.3.3.2" xref="S3.E3.m1.3.3.2.cmml">=</mo><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.cmml"><mo id="S3.E3.m1.3.3.1a" xref="S3.E3.m1.3.3.1.cmml">−</mo><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><msub id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.3.2" xref="S3.E3.m1.3.3.1.1.3.2.cmml">𝔼</mi><msub id="S3.E3.m1.3.3.1.1.3.3" xref="S3.E3.m1.3.3.1.1.3.3.cmml"><mi id="S3.E3.m1.3.3.1.1.3.3.2" xref="S3.E3.m1.3.3.1.1.3.3.2.cmml">𝑰</mi><mi id="S3.E3.m1.3.3.1.1.3.3.3" xref="S3.E3.m1.3.3.1.1.3.3.3.cmml">j</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.2.1.cmml">[</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.3.cmml"><msubsup id="S3.E3.m1.3.3.1.1.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.3.2.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2.2.2.cmml">𝒒</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.3.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2.3.cmml">j</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.3.2.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2.2.3.cmml">t</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.3.3.1.1.1.1.1.3.1" xref="S3.E3.m1.3.3.1.1.1.1.1.3.1.cmml">⋅</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.3.3.1" xref="S3.E3.m1.3.3.1.1.1.1.1.3.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E3.m1.3.3.1.1.1.1.1.3.3a" xref="S3.E3.m1.3.3.1.1.1.1.1.3.3.cmml">⁡</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.3.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.3.3.2.cmml">f</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">𝑰</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">W</mi><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.1.4" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">𝐛</mi><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.5" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3"><eq id="S3.E3.m1.3.3.2.cmml" xref="S3.E3.m1.3.3.2"></eq><apply id="S3.E3.m1.3.3.3.cmml" xref="S3.E3.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3">subscript</csymbol><ci id="S3.E3.m1.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.2">ℒ</ci><apply id="S3.E3.m1.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3"><times id="S3.E3.m1.3.3.3.3.1.cmml" xref="S3.E3.m1.3.3.3.3.1"></times><ci id="S3.E3.m1.3.3.3.3.2.cmml" xref="S3.E3.m1.3.3.3.3.2">𝑖</ci><ci id="S3.E3.m1.3.3.3.3.3.cmml" xref="S3.E3.m1.3.3.3.3.3">𝑆</ci><ci id="S3.E3.m1.3.3.3.3.4.cmml" xref="S3.E3.m1.3.3.3.3.4">𝑇</ci></apply></apply><apply id="S3.E3.m1.3.3.1.cmml" xref="S3.E3.m1.3.3.1"><minus id="S3.E3.m1.3.3.1.2.cmml" xref="S3.E3.m1.3.3.1"></minus><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1"><times id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"></times><apply id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.2">𝔼</ci><apply id="S3.E3.m1.3.3.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.3.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.3.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.3.2">𝑰</ci><ci id="S3.E3.m1.3.3.1.1.3.3.3.cmml" xref="S3.E3.m1.3.3.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.3.3.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1"><times id="S3.E3.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.2"></times><apply id="S3.E3.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3"><ci id="S3.E3.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.1">⋅</ci><apply id="S3.E3.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2">subscript</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2.2.2">𝒒</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2.2.3">𝑡</ci></apply><ci id="S3.E3.m1.3.3.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.2.3">𝑗</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.3"><log id="S3.E3.m1.3.3.1.1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.3.1"></log><ci id="S3.E3.m1.3.3.1.1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3.3.2">𝑓</ci></apply></apply><list id="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1"><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2">𝑰</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑊</ci><ci id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2">𝐛</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">\mathcal{L}_{iST}=-\mathbb{E}_{\bm{I}_{j}}[\bm{q}^{t}_{j}\cdot\log f(\bm{I}_{j};W,{\mathbf{b}})]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.8" class="ltx_p">As stated in the previous subsection,
the weight matrix <math id="S3.SS2.p2.3.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS2.p2.3.m1.1a"><mi id="S3.SS2.p2.3.m1.1.1" xref="S3.SS2.p2.3.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m1.1b"><ci id="S3.SS2.p2.3.m1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m1.1c">W</annotation></semantics></math> is initialized with the text features
<math id="S3.SS2.p2.4.m2.3" class="ltx_Math" alttext="\bm{T}=[\bm{T}_{1},\cdots,\bm{T}_{K}]^{\top}" display="inline"><semantics id="S3.SS2.p2.4.m2.3a"><mrow id="S3.SS2.p2.4.m2.3.3" xref="S3.SS2.p2.4.m2.3.3.cmml"><mi id="S3.SS2.p2.4.m2.3.3.4" xref="S3.SS2.p2.4.m2.3.3.4.cmml">𝑻</mi><mo id="S3.SS2.p2.4.m2.3.3.3" xref="S3.SS2.p2.4.m2.3.3.3.cmml">=</mo><msup id="S3.SS2.p2.4.m2.3.3.2" xref="S3.SS2.p2.4.m2.3.3.2.cmml"><mrow id="S3.SS2.p2.4.m2.3.3.2.2.2" xref="S3.SS2.p2.4.m2.3.3.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p2.4.m2.3.3.2.2.2.3" xref="S3.SS2.p2.4.m2.3.3.2.2.3.cmml">[</mo><msub id="S3.SS2.p2.4.m2.2.2.1.1.1.1" xref="S3.SS2.p2.4.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS2.p2.4.m2.2.2.1.1.1.1.2" xref="S3.SS2.p2.4.m2.2.2.1.1.1.1.2.cmml">𝑻</mi><mn id="S3.SS2.p2.4.m2.2.2.1.1.1.1.3" xref="S3.SS2.p2.4.m2.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p2.4.m2.3.3.2.2.2.4" xref="S3.SS2.p2.4.m2.3.3.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.p2.4.m2.1.1" xref="S3.SS2.p2.4.m2.1.1.cmml">⋯</mi><mo id="S3.SS2.p2.4.m2.3.3.2.2.2.5" xref="S3.SS2.p2.4.m2.3.3.2.2.3.cmml">,</mo><msub id="S3.SS2.p2.4.m2.3.3.2.2.2.2" xref="S3.SS2.p2.4.m2.3.3.2.2.2.2.cmml"><mi id="S3.SS2.p2.4.m2.3.3.2.2.2.2.2" xref="S3.SS2.p2.4.m2.3.3.2.2.2.2.2.cmml">𝑻</mi><mi id="S3.SS2.p2.4.m2.3.3.2.2.2.2.3" xref="S3.SS2.p2.4.m2.3.3.2.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S3.SS2.p2.4.m2.3.3.2.2.2.6" xref="S3.SS2.p2.4.m2.3.3.2.2.3.cmml">]</mo></mrow><mo id="S3.SS2.p2.4.m2.3.3.2.4" xref="S3.SS2.p2.4.m2.3.3.2.4.cmml">⊤</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m2.3b"><apply id="S3.SS2.p2.4.m2.3.3.cmml" xref="S3.SS2.p2.4.m2.3.3"><eq id="S3.SS2.p2.4.m2.3.3.3.cmml" xref="S3.SS2.p2.4.m2.3.3.3"></eq><ci id="S3.SS2.p2.4.m2.3.3.4.cmml" xref="S3.SS2.p2.4.m2.3.3.4">𝑻</ci><apply id="S3.SS2.p2.4.m2.3.3.2.cmml" xref="S3.SS2.p2.4.m2.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m2.3.3.2.3.cmml" xref="S3.SS2.p2.4.m2.3.3.2">superscript</csymbol><list id="S3.SS2.p2.4.m2.3.3.2.2.3.cmml" xref="S3.SS2.p2.4.m2.3.3.2.2.2"><apply id="S3.SS2.p2.4.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p2.4.m2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p2.4.m2.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS2.p2.4.m2.2.2.1.1.1.1.2">𝑻</ci><cn type="integer" id="S3.SS2.p2.4.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS2.p2.4.m2.2.2.1.1.1.1.3">1</cn></apply><ci id="S3.SS2.p2.4.m2.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1">⋯</ci><apply id="S3.SS2.p2.4.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.p2.4.m2.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m2.3.3.2.2.2.2.1.cmml" xref="S3.SS2.p2.4.m2.3.3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p2.4.m2.3.3.2.2.2.2.2.cmml" xref="S3.SS2.p2.4.m2.3.3.2.2.2.2.2">𝑻</ci><ci id="S3.SS2.p2.4.m2.3.3.2.2.2.2.3.cmml" xref="S3.SS2.p2.4.m2.3.3.2.2.2.2.3">𝐾</ci></apply></list><csymbol cd="latexml" id="S3.SS2.p2.4.m2.3.3.2.4.cmml" xref="S3.SS2.p2.4.m2.3.3.2.4">top</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m2.3c">\bm{T}=[\bm{T}_{1},\cdots,\bm{T}_{K}]^{\top}</annotation></semantics></math> and the bias vector <math id="S3.SS2.p2.5.m3.1" class="ltx_Math" alttext="{\mathbf{b}}" display="inline"><semantics id="S3.SS2.p2.5.m3.1a"><mi id="S3.SS2.p2.5.m3.1.1" xref="S3.SS2.p2.5.m3.1.1.cmml">𝐛</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m3.1b"><ci id="S3.SS2.p2.5.m3.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1">𝐛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m3.1c">{\mathbf{b}}</annotation></semantics></math> is initialized as <math id="S3.SS2.p2.6.m4.1" class="ltx_Math" alttext="\bm{0}" display="inline"><semantics id="S3.SS2.p2.6.m4.1a"><mn id="S3.SS2.p2.6.m4.1.1" xref="S3.SS2.p2.6.m4.1.1.cmml">𝟎</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m4.1b"><cn type="integer" id="S3.SS2.p2.6.m4.1.1.cmml" xref="S3.SS2.p2.6.m4.1.1">0</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m4.1c">\bm{0}</annotation></semantics></math> vector.
The soft pseudo-labels, denoted as <math id="S3.SS2.p2.7.m5.1" class="ltx_Math" alttext="\bm{q}_{j}" display="inline"><semantics id="S3.SS2.p2.7.m5.1a"><msub id="S3.SS2.p2.7.m5.1.1" xref="S3.SS2.p2.7.m5.1.1.cmml"><mi id="S3.SS2.p2.7.m5.1.1.2" xref="S3.SS2.p2.7.m5.1.1.2.cmml">𝒒</mi><mi id="S3.SS2.p2.7.m5.1.1.3" xref="S3.SS2.p2.7.m5.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m5.1b"><apply id="S3.SS2.p2.7.m5.1.1.cmml" xref="S3.SS2.p2.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m5.1.1.1.cmml" xref="S3.SS2.p2.7.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.7.m5.1.1.2.cmml" xref="S3.SS2.p2.7.m5.1.1.2">𝒒</ci><ci id="S3.SS2.p2.7.m5.1.1.3.cmml" xref="S3.SS2.p2.7.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m5.1c">\bm{q}_{j}</annotation></semantics></math> are initially set to the CLIP zero-shot predicted probability vector,
i.e. <math id="S3.SS2.p2.8.m6.1" class="ltx_Math" alttext="\bm{q}_{j}^{0}=\bm{p}_{j}" display="inline"><semantics id="S3.SS2.p2.8.m6.1a"><mrow id="S3.SS2.p2.8.m6.1.1" xref="S3.SS2.p2.8.m6.1.1.cmml"><msubsup id="S3.SS2.p2.8.m6.1.1.2" xref="S3.SS2.p2.8.m6.1.1.2.cmml"><mi id="S3.SS2.p2.8.m6.1.1.2.2.2" xref="S3.SS2.p2.8.m6.1.1.2.2.2.cmml">𝒒</mi><mi id="S3.SS2.p2.8.m6.1.1.2.2.3" xref="S3.SS2.p2.8.m6.1.1.2.2.3.cmml">j</mi><mn id="S3.SS2.p2.8.m6.1.1.2.3" xref="S3.SS2.p2.8.m6.1.1.2.3.cmml">0</mn></msubsup><mo id="S3.SS2.p2.8.m6.1.1.1" xref="S3.SS2.p2.8.m6.1.1.1.cmml">=</mo><msub id="S3.SS2.p2.8.m6.1.1.3" xref="S3.SS2.p2.8.m6.1.1.3.cmml"><mi id="S3.SS2.p2.8.m6.1.1.3.2" xref="S3.SS2.p2.8.m6.1.1.3.2.cmml">𝒑</mi><mi id="S3.SS2.p2.8.m6.1.1.3.3" xref="S3.SS2.p2.8.m6.1.1.3.3.cmml">j</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m6.1b"><apply id="S3.SS2.p2.8.m6.1.1.cmml" xref="S3.SS2.p2.8.m6.1.1"><eq id="S3.SS2.p2.8.m6.1.1.1.cmml" xref="S3.SS2.p2.8.m6.1.1.1"></eq><apply id="S3.SS2.p2.8.m6.1.1.2.cmml" xref="S3.SS2.p2.8.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m6.1.1.2.1.cmml" xref="S3.SS2.p2.8.m6.1.1.2">superscript</csymbol><apply id="S3.SS2.p2.8.m6.1.1.2.2.cmml" xref="S3.SS2.p2.8.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m6.1.1.2.2.1.cmml" xref="S3.SS2.p2.8.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.8.m6.1.1.2.2.2.cmml" xref="S3.SS2.p2.8.m6.1.1.2.2.2">𝒒</ci><ci id="S3.SS2.p2.8.m6.1.1.2.2.3.cmml" xref="S3.SS2.p2.8.m6.1.1.2.2.3">𝑗</ci></apply><cn type="integer" id="S3.SS2.p2.8.m6.1.1.2.3.cmml" xref="S3.SS2.p2.8.m6.1.1.2.3">0</cn></apply><apply id="S3.SS2.p2.8.m6.1.1.3.cmml" xref="S3.SS2.p2.8.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m6.1.1.3.1.cmml" xref="S3.SS2.p2.8.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.8.m6.1.1.3.2.cmml" xref="S3.SS2.p2.8.m6.1.1.3.2">𝒑</ci><ci id="S3.SS2.p2.8.m6.1.1.3.3.cmml" xref="S3.SS2.p2.8.m6.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m6.1c">\bm{q}_{j}^{0}=\bm{p}_{j}</annotation></semantics></math> and then updated with the model’s prediction outputs.
To obtain smooth and progressive updates of pseudo-labels and mitigate the risk of oscillations,
we adopt the following weighted moving average update:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.4" class="ltx_Math" alttext="\bm{q}_{j}^{t}=\beta\bm{q}_{j}^{t-1}+(1-\beta)f(\bm{I}_{j};W,{\mathbf{b}})" display="block"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><msubsup id="S3.E4.m1.4.4.4" xref="S3.E4.m1.4.4.4.cmml"><mi id="S3.E4.m1.4.4.4.2.2" xref="S3.E4.m1.4.4.4.2.2.cmml">𝒒</mi><mi id="S3.E4.m1.4.4.4.2.3" xref="S3.E4.m1.4.4.4.2.3.cmml">j</mi><mi id="S3.E4.m1.4.4.4.3" xref="S3.E4.m1.4.4.4.3.cmml">t</mi></msubsup><mo id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml">=</mo><mrow id="S3.E4.m1.4.4.2" xref="S3.E4.m1.4.4.2.cmml"><mrow id="S3.E4.m1.4.4.2.4" xref="S3.E4.m1.4.4.2.4.cmml"><mi id="S3.E4.m1.4.4.2.4.2" xref="S3.E4.m1.4.4.2.4.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.2.4.1" xref="S3.E4.m1.4.4.2.4.1.cmml">​</mo><msubsup id="S3.E4.m1.4.4.2.4.3" xref="S3.E4.m1.4.4.2.4.3.cmml"><mi id="S3.E4.m1.4.4.2.4.3.2.2" xref="S3.E4.m1.4.4.2.4.3.2.2.cmml">𝒒</mi><mi id="S3.E4.m1.4.4.2.4.3.2.3" xref="S3.E4.m1.4.4.2.4.3.2.3.cmml">j</mi><mrow id="S3.E4.m1.4.4.2.4.3.3" xref="S3.E4.m1.4.4.2.4.3.3.cmml"><mi id="S3.E4.m1.4.4.2.4.3.3.2" xref="S3.E4.m1.4.4.2.4.3.3.2.cmml">t</mi><mo id="S3.E4.m1.4.4.2.4.3.3.1" xref="S3.E4.m1.4.4.2.4.3.3.1.cmml">−</mo><mn id="S3.E4.m1.4.4.2.4.3.3.3" xref="S3.E4.m1.4.4.2.4.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="S3.E4.m1.4.4.2.3" xref="S3.E4.m1.4.4.2.3.cmml">+</mo><mrow id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml"><mrow id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml"><mn id="S3.E4.m1.3.3.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E4.m1.3.3.1.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E4.m1.3.3.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="S3.E4.m1.3.3.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.2.2.3" xref="S3.E4.m1.4.4.2.2.3.cmml">​</mo><mi id="S3.E4.m1.4.4.2.2.4" xref="S3.E4.m1.4.4.2.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.4.4.2.2.3a" xref="S3.E4.m1.4.4.2.2.3.cmml">​</mo><mrow id="S3.E4.m1.4.4.2.2.2.1" xref="S3.E4.m1.4.4.2.2.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.2.2.2.1.2" xref="S3.E4.m1.4.4.2.2.2.2.cmml">(</mo><msub id="S3.E4.m1.4.4.2.2.2.1.1" xref="S3.E4.m1.4.4.2.2.2.1.1.cmml"><mi id="S3.E4.m1.4.4.2.2.2.1.1.2" xref="S3.E4.m1.4.4.2.2.2.1.1.2.cmml">𝑰</mi><mi id="S3.E4.m1.4.4.2.2.2.1.1.3" xref="S3.E4.m1.4.4.2.2.2.1.1.3.cmml">j</mi></msub><mo id="S3.E4.m1.4.4.2.2.2.1.3" xref="S3.E4.m1.4.4.2.2.2.2.cmml">;</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">W</mi><mo id="S3.E4.m1.4.4.2.2.2.1.4" xref="S3.E4.m1.4.4.2.2.2.2.cmml">,</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">𝐛</mi><mo stretchy="false" id="S3.E4.m1.4.4.2.2.2.1.5" xref="S3.E4.m1.4.4.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"></eq><apply id="S3.E4.m1.4.4.4.cmml" xref="S3.E4.m1.4.4.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.1.cmml" xref="S3.E4.m1.4.4.4">superscript</csymbol><apply id="S3.E4.m1.4.4.4.2.cmml" xref="S3.E4.m1.4.4.4"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.4.2.1.cmml" xref="S3.E4.m1.4.4.4">subscript</csymbol><ci id="S3.E4.m1.4.4.4.2.2.cmml" xref="S3.E4.m1.4.4.4.2.2">𝒒</ci><ci id="S3.E4.m1.4.4.4.2.3.cmml" xref="S3.E4.m1.4.4.4.2.3">𝑗</ci></apply><ci id="S3.E4.m1.4.4.4.3.cmml" xref="S3.E4.m1.4.4.4.3">𝑡</ci></apply><apply id="S3.E4.m1.4.4.2.cmml" xref="S3.E4.m1.4.4.2"><plus id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.3"></plus><apply id="S3.E4.m1.4.4.2.4.cmml" xref="S3.E4.m1.4.4.2.4"><times id="S3.E4.m1.4.4.2.4.1.cmml" xref="S3.E4.m1.4.4.2.4.1"></times><ci id="S3.E4.m1.4.4.2.4.2.cmml" xref="S3.E4.m1.4.4.2.4.2">𝛽</ci><apply id="S3.E4.m1.4.4.2.4.3.cmml" xref="S3.E4.m1.4.4.2.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.4.3.1.cmml" xref="S3.E4.m1.4.4.2.4.3">superscript</csymbol><apply id="S3.E4.m1.4.4.2.4.3.2.cmml" xref="S3.E4.m1.4.4.2.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.4.3.2.1.cmml" xref="S3.E4.m1.4.4.2.4.3">subscript</csymbol><ci id="S3.E4.m1.4.4.2.4.3.2.2.cmml" xref="S3.E4.m1.4.4.2.4.3.2.2">𝒒</ci><ci id="S3.E4.m1.4.4.2.4.3.2.3.cmml" xref="S3.E4.m1.4.4.2.4.3.2.3">𝑗</ci></apply><apply id="S3.E4.m1.4.4.2.4.3.3.cmml" xref="S3.E4.m1.4.4.2.4.3.3"><minus id="S3.E4.m1.4.4.2.4.3.3.1.cmml" xref="S3.E4.m1.4.4.2.4.3.3.1"></minus><ci id="S3.E4.m1.4.4.2.4.3.3.2.cmml" xref="S3.E4.m1.4.4.2.4.3.3.2">𝑡</ci><cn type="integer" id="S3.E4.m1.4.4.2.4.3.3.3.cmml" xref="S3.E4.m1.4.4.2.4.3.3.3">1</cn></apply></apply></apply><apply id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2"><times id="S3.E4.m1.4.4.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.3"></times><apply id="S3.E4.m1.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1"><minus id="S3.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E4.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.2">1</cn><ci id="S3.E4.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.3">𝛽</ci></apply><ci id="S3.E4.m1.4.4.2.2.4.cmml" xref="S3.E4.m1.4.4.2.2.4">𝑓</ci><list id="S3.E4.m1.4.4.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.1"><apply id="S3.E4.m1.4.4.2.2.2.1.1.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.2.1.1.1.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.2.2.2.1.1.2.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.2">𝑰</ci><ci id="S3.E4.m1.4.4.2.2.2.1.1.3.cmml" xref="S3.E4.m1.4.4.2.2.2.1.1.3">𝑗</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝑊</ci><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝐛</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\bm{q}_{j}^{t}=\beta\bm{q}_{j}^{t-1}+(1-\beta)f(\bm{I}_{j};W,{\mathbf{b}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.9" class="ltx_p">where <math id="S3.SS2.p2.9.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS2.p2.9.m1.1a"><mi id="S3.SS2.p2.9.m1.1.1" xref="S3.SS2.p2.9.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m1.1b"><ci id="S3.SS2.p2.9.m1.1.1.cmml" xref="S3.SS2.p2.9.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m1.1c">\beta</annotation></semantics></math> is the hyper-parameter that controls the updating rate.
This progressive update strategy can promptly incorporate the progress of the classifier training
to improve the quality of pseudo-labels,
while maintaining stability by accumulating the previous predictions.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Class-Balanced Data Generation</h3>

<div id="S3.SS3.p1" class="ltx_para ltx_noindent">
<p id="S3.SS3.p1.2" class="ltx_p">A significant challenge in federated learning arises from the
non-i.i.d. data distribution across clients,
which often results in class imbalances and introduces bias during local model training,
thereby diminishing the convergence rate of the global model.
Regrettably, unsupervised federated learning exacerbates this situation since errors accumulated in the pseudo-labels
further impede the convergence of the local models.
Fortunately, there is a silver lining in the form of text features extracted from the CLIP text encoder for the relevant classes.
As the CLIP model is trained using paired image-text data, the text features and image features
pertaining to the same category exhibit a high degree of similarity,
and the text feature vectors <math id="S3.SS3.p1.1.m1.3" class="ltx_Math" alttext="\{\bm{T}_{1},\cdots,\bm{T}_{K}\}" display="inline"><semantics id="S3.SS3.p1.1.m1.3a"><mrow id="S3.SS3.p1.1.m1.3.3.2" xref="S3.SS3.p1.1.m1.3.3.3.cmml"><mo stretchy="false" id="S3.SS3.p1.1.m1.3.3.2.3" xref="S3.SS3.p1.1.m1.3.3.3.cmml">{</mo><msub id="S3.SS3.p1.1.m1.2.2.1.1" xref="S3.SS3.p1.1.m1.2.2.1.1.cmml"><mi id="S3.SS3.p1.1.m1.2.2.1.1.2" xref="S3.SS3.p1.1.m1.2.2.1.1.2.cmml">𝑻</mi><mn id="S3.SS3.p1.1.m1.2.2.1.1.3" xref="S3.SS3.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p1.1.m1.3.3.2.4" xref="S3.SS3.p1.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">⋯</mi><mo id="S3.SS3.p1.1.m1.3.3.2.5" xref="S3.SS3.p1.1.m1.3.3.3.cmml">,</mo><msub id="S3.SS3.p1.1.m1.3.3.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.cmml"><mi id="S3.SS3.p1.1.m1.3.3.2.2.2" xref="S3.SS3.p1.1.m1.3.3.2.2.2.cmml">𝑻</mi><mi id="S3.SS3.p1.1.m1.3.3.2.2.3" xref="S3.SS3.p1.1.m1.3.3.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="S3.SS3.p1.1.m1.3.3.2.6" xref="S3.SS3.p1.1.m1.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.3b"><set id="S3.SS3.p1.1.m1.3.3.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2"><apply id="S3.SS3.p1.1.m1.2.2.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.2">𝑻</ci><cn type="integer" id="S3.SS3.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">⋯</ci><apply id="S3.SS3.p1.1.m1.3.3.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.3.3.2.2.1.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.2">𝑻</ci><ci id="S3.SS3.p1.1.m1.3.3.2.2.3.cmml" xref="S3.SS3.p1.1.m1.3.3.2.2.3">𝐾</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.3c">\{\bm{T}_{1},\cdots,\bm{T}_{K}\}</annotation></semantics></math>
can be regarded as class prototypes for the corresponding categories
in the aligned image-text feature space <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\mathcal{Z}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.10" class="ltx_p">Using the <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">K</annotation></semantics></math> text feature vectors—class prototype vectors—as additional labeled instances from their corresponding classes
for training the local model however provides limited supervision and may lead to overfitting.
Motivated the clustering assumption that data belonging to the same class are usually
close to each other in the high level feature space,
we propose to model each class as a Gaussian distribution <math id="S3.SS3.p2.2.m2.2" class="ltx_Math" alttext="\mathcal{N}(\bm{T}_{k},\sigma^{2}I)" display="inline"><semantics id="S3.SS3.p2.2.m2.2a"><mrow id="S3.SS3.p2.2.m2.2.2" xref="S3.SS3.p2.2.m2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.2.2.4" xref="S3.SS3.p2.2.m2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.2.2.3" xref="S3.SS3.p2.2.m2.2.2.3.cmml">​</mo><mrow id="S3.SS3.p2.2.m2.2.2.2.2" xref="S3.SS3.p2.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m2.2.2.2.2.3" xref="S3.SS3.p2.2.m2.2.2.2.3.cmml">(</mo><msub id="S3.SS3.p2.2.m2.1.1.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.1.1.1.2" xref="S3.SS3.p2.2.m2.1.1.1.1.1.2.cmml">𝑻</mi><mi id="S3.SS3.p2.2.m2.1.1.1.1.1.3" xref="S3.SS3.p2.2.m2.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS3.p2.2.m2.2.2.2.2.4" xref="S3.SS3.p2.2.m2.2.2.2.3.cmml">,</mo><mrow id="S3.SS3.p2.2.m2.2.2.2.2.2" xref="S3.SS3.p2.2.m2.2.2.2.2.2.cmml"><msup id="S3.SS3.p2.2.m2.2.2.2.2.2.2" xref="S3.SS3.p2.2.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS3.p2.2.m2.2.2.2.2.2.2.2" xref="S3.SS3.p2.2.m2.2.2.2.2.2.2.2.cmml">σ</mi><mn id="S3.SS3.p2.2.m2.2.2.2.2.2.2.3" xref="S3.SS3.p2.2.m2.2.2.2.2.2.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.2.2.2.2.2.1" xref="S3.SS3.p2.2.m2.2.2.2.2.2.1.cmml">​</mo><mi id="S3.SS3.p2.2.m2.2.2.2.2.2.3" xref="S3.SS3.p2.2.m2.2.2.2.2.2.3.cmml">I</mi></mrow><mo stretchy="false" id="S3.SS3.p2.2.m2.2.2.2.2.5" xref="S3.SS3.p2.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.2b"><apply id="S3.SS3.p2.2.m2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2"><times id="S3.SS3.p2.2.m2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.3"></times><ci id="S3.SS3.p2.2.m2.2.2.4.cmml" xref="S3.SS3.p2.2.m2.2.2.4">𝒩</ci><interval closure="open" id="S3.SS3.p2.2.m2.2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.2"><apply id="S3.SS3.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.2">𝑻</ci><ci id="S3.SS3.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS3.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.2.2"><times id="S3.SS3.p2.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.2.2.1"></times><apply id="S3.SS3.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p2.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2.2.2.2.2">𝜎</ci><cn type="integer" id="S3.SS3.p2.2.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.2.2.2.3">2</cn></apply><ci id="S3.SS3.p2.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.2.2.2.3">𝐼</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.2c">\mathcal{N}(\bm{T}_{k},\sigma^{2}I)</annotation></semantics></math>
around the class prototype vector <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\bm{T}_{k}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">𝑻</mi><mi id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑻</ci><ci id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\bm{T}_{k}</annotation></semantics></math> in the feature space <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{Z}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">𝒵</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝒵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\mathcal{Z}</annotation></semantics></math>,
where <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">I</annotation></semantics></math> denotes the identity matrix and <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="\sigma^{2}I" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><mrow id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><msup id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2.2" xref="S3.SS3.p2.6.m6.1.1.2.2.cmml">σ</mi><mn id="S3.SS3.p2.6.m6.1.1.2.3" xref="S3.SS3.p2.6.m6.1.1.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><times id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1"></times><apply id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.2.1.cmml" xref="S3.SS3.p2.6.m6.1.1.2">superscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2.2">𝜎</ci><cn type="integer" id="S3.SS3.p2.6.m6.1.1.2.3.cmml" xref="S3.SS3.p2.6.m6.1.1.2.3">2</cn></apply><ci id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">\sigma^{2}I</annotation></semantics></math> represents a diagonal covariance matrix.
Then we can generate a set of synthetic instances for each <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">k</annotation></semantics></math>-th class in the feature space
by randomly sampling feature vectors from the Gaussian distribution <math id="S3.SS3.p2.8.m8.2" class="ltx_Math" alttext="\mathcal{N}(\bm{T}_{k},\sigma^{2}I)" display="inline"><semantics id="S3.SS3.p2.8.m8.2a"><mrow id="S3.SS3.p2.8.m8.2.2" xref="S3.SS3.p2.8.m8.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.8.m8.2.2.4" xref="S3.SS3.p2.8.m8.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m8.2.2.3" xref="S3.SS3.p2.8.m8.2.2.3.cmml">​</mo><mrow id="S3.SS3.p2.8.m8.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p2.8.m8.2.2.2.2.3" xref="S3.SS3.p2.8.m8.2.2.2.3.cmml">(</mo><msub id="S3.SS3.p2.8.m8.1.1.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.8.m8.1.1.1.1.1.2" xref="S3.SS3.p2.8.m8.1.1.1.1.1.2.cmml">𝑻</mi><mi id="S3.SS3.p2.8.m8.1.1.1.1.1.3" xref="S3.SS3.p2.8.m8.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS3.p2.8.m8.2.2.2.2.4" xref="S3.SS3.p2.8.m8.2.2.2.3.cmml">,</mo><mrow id="S3.SS3.p2.8.m8.2.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.2.cmml"><msup id="S3.SS3.p2.8.m8.2.2.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2.cmml"><mi id="S3.SS3.p2.8.m8.2.2.2.2.2.2.2" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2.2.cmml">σ</mi><mn id="S3.SS3.p2.8.m8.2.2.2.2.2.2.3" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p2.8.m8.2.2.2.2.2.1" xref="S3.SS3.p2.8.m8.2.2.2.2.2.1.cmml">​</mo><mi id="S3.SS3.p2.8.m8.2.2.2.2.2.3" xref="S3.SS3.p2.8.m8.2.2.2.2.2.3.cmml">I</mi></mrow><mo stretchy="false" id="S3.SS3.p2.8.m8.2.2.2.2.5" xref="S3.SS3.p2.8.m8.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.2b"><apply id="S3.SS3.p2.8.m8.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2"><times id="S3.SS3.p2.8.m8.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.3"></times><ci id="S3.SS3.p2.8.m8.2.2.4.cmml" xref="S3.SS3.p2.8.m8.2.2.4">𝒩</ci><interval closure="open" id="S3.SS3.p2.8.m8.2.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2"><apply id="S3.SS3.p2.8.m8.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1.2">𝑻</ci><ci id="S3.SS3.p2.8.m8.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS3.p2.8.m8.2.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2"><times id="S3.SS3.p2.8.m8.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2.1"></times><apply id="S3.SS3.p2.8.m8.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.2.2.2.2.2.2.1.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.p2.8.m8.2.2.2.2.2.2.2.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2.2">𝜎</ci><cn type="integer" id="S3.SS3.p2.8.m8.2.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2.2.3">2</cn></apply><ci id="S3.SS3.p2.8.m8.2.2.2.2.2.3.cmml" xref="S3.SS3.p2.8.m8.2.2.2.2.2.3">𝐼</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.2c">\mathcal{N}(\bm{T}_{k},\sigma^{2}I)</annotation></semantics></math>,
aiming to augment the pseudo-labeled training data and mitigate data heterogeneity and class imbalance.
Specifically, we generate
<math id="S3.SS3.p2.9.m9.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S3.SS3.p2.9.m9.1a"><msub id="S3.SS3.p2.9.m9.1.1" xref="S3.SS3.p2.9.m9.1.1.cmml"><mi id="S3.SS3.p2.9.m9.1.1.2" xref="S3.SS3.p2.9.m9.1.1.2.cmml">n</mi><mi id="S3.SS3.p2.9.m9.1.1.3" xref="S3.SS3.p2.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m9.1b"><apply id="S3.SS3.p2.9.m9.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m9.1.1.1.cmml" xref="S3.SS3.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS3.p2.9.m9.1.1.2.cmml" xref="S3.SS3.p2.9.m9.1.1.2">𝑛</ci><ci id="S3.SS3.p2.9.m9.1.1.3.cmml" xref="S3.SS3.p2.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m9.1c">n_{k}</annotation></semantics></math> instances for each class <math id="S3.SS3.p2.10.m10.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.10.m10.1a"><mi id="S3.SS3.p2.10.m10.1.1" xref="S3.SS3.p2.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m10.1b"><ci id="S3.SS3.p2.10.m10.1.1.cmml" xref="S3.SS3.p2.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m10.1c">k</annotation></semantics></math> as follows:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\{\bm{z}_{kj}\sim\mathcal{N}(\bm{T}_{k},\sigma^{2})|1\leq k\leq K,1\leq j\leq n_{k}\}" display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.3.1.cmml">{</mo><mrow id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml"><msub id="S3.E5.m1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.4.cmml"><mi id="S3.E5.m1.1.1.1.1.4.2" xref="S3.E5.m1.1.1.1.1.4.2.cmml">𝒛</mi><mrow id="S3.E5.m1.1.1.1.1.4.3" xref="S3.E5.m1.1.1.1.1.4.3.cmml"><mi id="S3.E5.m1.1.1.1.1.4.3.2" xref="S3.E5.m1.1.1.1.1.4.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.4.3.1" xref="S3.E5.m1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E5.m1.1.1.1.1.4.3.3" xref="S3.E5.m1.1.1.1.1.4.3.3.cmml">j</mi></mrow></msub><mo id="S3.E5.m1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.3.cmml">∼</mo><mrow id="S3.E5.m1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1.1.1.2.4" xref="S3.E5.m1.1.1.1.1.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.1.1.1.1.2.3" xref="S3.E5.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E5.m1.1.1.1.1.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.2.2.2.3" xref="S3.E5.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E5.m1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml">𝑻</mi><mi id="S3.E5.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E5.m1.1.1.1.1.2.2.2.4" xref="S3.E5.m1.1.1.1.1.2.2.3.cmml">,</mo><msup id="S3.E5.m1.1.1.1.1.2.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E5.m1.1.1.1.1.2.2.2.2.2" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2.cmml">σ</mi><mn id="S3.E5.m1.1.1.1.1.2.2.2.2.3" xref="S3.E5.m1.1.1.1.1.2.2.2.2.3.cmml">2</mn></msup><mo stretchy="false" id="S3.E5.m1.1.1.1.1.2.2.2.5" xref="S3.E5.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.2.4" xref="S3.E5.m1.2.2.3.1.cmml">|</mo><mrow id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.3.cmml"><mrow id="S3.E5.m1.2.2.2.2.1.1" xref="S3.E5.m1.2.2.2.2.1.1.cmml"><mn id="S3.E5.m1.2.2.2.2.1.1.2" xref="S3.E5.m1.2.2.2.2.1.1.2.cmml">1</mn><mo id="S3.E5.m1.2.2.2.2.1.1.3" xref="S3.E5.m1.2.2.2.2.1.1.3.cmml">≤</mo><mi id="S3.E5.m1.2.2.2.2.1.1.4" xref="S3.E5.m1.2.2.2.2.1.1.4.cmml">k</mi><mo id="S3.E5.m1.2.2.2.2.1.1.5" xref="S3.E5.m1.2.2.2.2.1.1.5.cmml">≤</mo><mi id="S3.E5.m1.2.2.2.2.1.1.6" xref="S3.E5.m1.2.2.2.2.1.1.6.cmml">K</mi></mrow><mo id="S3.E5.m1.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.3a.cmml">,</mo><mrow id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml"><mn id="S3.E5.m1.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.cmml">1</mn><mo id="S3.E5.m1.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.2.3.cmml">≤</mo><mi id="S3.E5.m1.2.2.2.2.2.2.4" xref="S3.E5.m1.2.2.2.2.2.2.4.cmml">j</mi><mo id="S3.E5.m1.2.2.2.2.2.2.5" xref="S3.E5.m1.2.2.2.2.2.2.5.cmml">≤</mo><msub id="S3.E5.m1.2.2.2.2.2.2.6" xref="S3.E5.m1.2.2.2.2.2.2.6.cmml"><mi id="S3.E5.m1.2.2.2.2.2.2.6.2" xref="S3.E5.m1.2.2.2.2.2.2.6.2.cmml">n</mi><mi id="S3.E5.m1.2.2.2.2.2.2.6.3" xref="S3.E5.m1.2.2.2.2.2.2.6.3.cmml">k</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E5.m1.2.2.2.5" xref="S3.E5.m1.2.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.2.3">conditional-set</csymbol><apply id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.3">similar-to</csymbol><apply id="S3.E5.m1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.1.1.1.1.4.2">𝒛</ci><apply id="S3.E5.m1.1.1.1.1.4.3.cmml" xref="S3.E5.m1.1.1.1.1.4.3"><times id="S3.E5.m1.1.1.1.1.4.3.1.cmml" xref="S3.E5.m1.1.1.1.1.4.3.1"></times><ci id="S3.E5.m1.1.1.1.1.4.3.2.cmml" xref="S3.E5.m1.1.1.1.1.4.3.2">𝑘</ci><ci id="S3.E5.m1.1.1.1.1.4.3.3.cmml" xref="S3.E5.m1.1.1.1.1.4.3.3">𝑗</ci></apply></apply><apply id="S3.E5.m1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.2"><times id="S3.E5.m1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.3"></times><ci id="S3.E5.m1.1.1.1.1.2.4.cmml" xref="S3.E5.m1.1.1.1.1.2.4">𝒩</ci><interval closure="open" id="S3.E5.m1.1.1.1.1.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2"><apply id="S3.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.2">𝑻</ci><ci id="S3.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E5.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E5.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2.2">𝜎</ci><cn type="integer" id="S3.E5.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.1.1.1.1.2.2.2.2.3">2</cn></apply></interval></apply></apply><apply id="S3.E5.m1.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.3a.cmml" xref="S3.E5.m1.2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E5.m1.2.2.2.2.1.1.cmml" xref="S3.E5.m1.2.2.2.2.1.1"><and id="S3.E5.m1.2.2.2.2.1.1a.cmml" xref="S3.E5.m1.2.2.2.2.1.1"></and><apply id="S3.E5.m1.2.2.2.2.1.1b.cmml" xref="S3.E5.m1.2.2.2.2.1.1"><leq id="S3.E5.m1.2.2.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.2.2.1.1.3"></leq><cn type="integer" id="S3.E5.m1.2.2.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.2.2.1.1.2">1</cn><ci id="S3.E5.m1.2.2.2.2.1.1.4.cmml" xref="S3.E5.m1.2.2.2.2.1.1.4">𝑘</ci></apply><apply id="S3.E5.m1.2.2.2.2.1.1c.cmml" xref="S3.E5.m1.2.2.2.2.1.1"><leq id="S3.E5.m1.2.2.2.2.1.1.5.cmml" xref="S3.E5.m1.2.2.2.2.1.1.5"></leq><share href="#S3.E5.m1.2.2.2.2.1.1.4.cmml" id="S3.E5.m1.2.2.2.2.1.1d.cmml" xref="S3.E5.m1.2.2.2.2.1.1"></share><ci id="S3.E5.m1.2.2.2.2.1.1.6.cmml" xref="S3.E5.m1.2.2.2.2.1.1.6">𝐾</ci></apply></apply><apply id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2"><and id="S3.E5.m1.2.2.2.2.2.2a.cmml" xref="S3.E5.m1.2.2.2.2.2.2"></and><apply id="S3.E5.m1.2.2.2.2.2.2b.cmml" xref="S3.E5.m1.2.2.2.2.2.2"><leq id="S3.E5.m1.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.3"></leq><cn type="integer" id="S3.E5.m1.2.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.2">1</cn><ci id="S3.E5.m1.2.2.2.2.2.2.4.cmml" xref="S3.E5.m1.2.2.2.2.2.2.4">𝑗</ci></apply><apply id="S3.E5.m1.2.2.2.2.2.2c.cmml" xref="S3.E5.m1.2.2.2.2.2.2"><leq id="S3.E5.m1.2.2.2.2.2.2.5.cmml" xref="S3.E5.m1.2.2.2.2.2.2.5"></leq><share href="#S3.E5.m1.2.2.2.2.2.2.4.cmml" id="S3.E5.m1.2.2.2.2.2.2d.cmml" xref="S3.E5.m1.2.2.2.2.2.2"></share><apply id="S3.E5.m1.2.2.2.2.2.2.6.cmml" xref="S3.E5.m1.2.2.2.2.2.2.6"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.2.2.2.6.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.6">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.2.6.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2.6.2">𝑛</ci><ci id="S3.E5.m1.2.2.2.2.2.2.6.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.6.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\{\bm{z}_{kj}\sim\mathcal{N}(\bm{T}_{k},\sigma^{2})|1\leq k\leq K,1\leq j\leq n_{k}\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.13" class="ltx_p">They can be used as labeled instances to help train the classifier by minimizing following cross-entropy loss:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.3" class="ltx_Math" alttext="\mathcal{L}_{tSamp}=-\sum\nolimits_{k=1}^{K}\sum\nolimits_{j=1}^{n_{k}}\bm{1}_{k}\cdot\log f(\bm{z}_{kj};W,\bm{b})" display="block"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml"><msub id="S3.E6.m1.3.3.3" xref="S3.E6.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.3.3.3.2" xref="S3.E6.m1.3.3.3.2.cmml">ℒ</mi><mrow id="S3.E6.m1.3.3.3.3" xref="S3.E6.m1.3.3.3.3.cmml"><mi id="S3.E6.m1.3.3.3.3.2" xref="S3.E6.m1.3.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.3.1" xref="S3.E6.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.3.1a" xref="S3.E6.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.3.4" xref="S3.E6.m1.3.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.3.1b" xref="S3.E6.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.3.5" xref="S3.E6.m1.3.3.3.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.3.3.1c" xref="S3.E6.m1.3.3.3.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.3.3.6" xref="S3.E6.m1.3.3.3.3.6.cmml">p</mi></mrow></msub><mo id="S3.E6.m1.3.3.2" xref="S3.E6.m1.3.3.2.cmml">=</mo><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.cmml"><mo id="S3.E6.m1.3.3.1a" xref="S3.E6.m1.3.3.1.cmml">−</mo><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><msubsup id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml"><mo rspace="0em" id="S3.E6.m1.3.3.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.3.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.2.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2.3.2" xref="S3.E6.m1.3.3.1.1.2.2.3.2.cmml">k</mi><mo id="S3.E6.m1.3.3.1.1.2.2.3.1" xref="S3.E6.m1.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.3.3.1.1.2.2.3.3" xref="S3.E6.m1.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.2.3.cmml">K</mi></msubsup><mrow id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.cmml"><msubsup id="S3.E6.m1.3.3.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.2.cmml"><mo id="S3.E6.m1.3.3.1.1.1.2.2.2" xref="S3.E6.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.3.3.1.1.1.2.2.3" xref="S3.E6.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.2.2.3.2" xref="S3.E6.m1.3.3.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E6.m1.3.3.1.1.1.2.2.3.1" xref="S3.E6.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.3.3.1.1.1.2.2.3.3" xref="S3.E6.m1.3.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="S3.E6.m1.3.3.1.1.1.2.3" xref="S3.E6.m1.3.3.1.1.1.2.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.2.3.2" xref="S3.E6.m1.3.3.1.1.1.2.3.2.cmml">n</mi><mi id="S3.E6.m1.3.3.1.1.1.2.3.3" xref="S3.E6.m1.3.3.1.1.1.2.3.3.cmml">k</mi></msub></msubsup><mrow id="S3.E6.m1.3.3.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.3.cmml"><msub id="S3.E6.m1.3.3.1.1.1.1.3.2" xref="S3.E6.m1.3.3.1.1.1.1.3.2.cmml"><mn id="S3.E6.m1.3.3.1.1.1.1.3.2.2" xref="S3.E6.m1.3.3.1.1.1.1.3.2.2.cmml">𝟏</mn><mi id="S3.E6.m1.3.3.1.1.1.1.3.2.3" xref="S3.E6.m1.3.3.1.1.1.1.3.2.3.cmml">k</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.3.3.1.1.1.1.3.1" xref="S3.E6.m1.3.3.1.1.1.1.3.1.cmml">⋅</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.1.1.3.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.3.3.1" xref="S3.E6.m1.3.3.1.1.1.1.3.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E6.m1.3.3.1.1.1.1.3.3a" xref="S3.E6.m1.3.3.1.1.1.1.3.3.cmml">⁡</mo><mi id="S3.E6.m1.3.3.1.1.1.1.3.3.2" xref="S3.E6.m1.3.3.1.1.1.1.3.3.2.cmml">f</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E6.m1.3.3.1.1.1.1.1.1.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml">𝒛</mi><mrow id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.3" xref="S3.E6.m1.3.3.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">W</mi><mo id="S3.E6.m1.3.3.1.1.1.1.1.1.4" xref="S3.E6.m1.3.3.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">𝒃</mi><mo stretchy="false" id="S3.E6.m1.3.3.1.1.1.1.1.1.5" xref="S3.E6.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3"><eq id="S3.E6.m1.3.3.2.cmml" xref="S3.E6.m1.3.3.2"></eq><apply id="S3.E6.m1.3.3.3.cmml" xref="S3.E6.m1.3.3.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3">subscript</csymbol><ci id="S3.E6.m1.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3.2">ℒ</ci><apply id="S3.E6.m1.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3"><times id="S3.E6.m1.3.3.3.3.1.cmml" xref="S3.E6.m1.3.3.3.3.1"></times><ci id="S3.E6.m1.3.3.3.3.2.cmml" xref="S3.E6.m1.3.3.3.3.2">𝑡</ci><ci id="S3.E6.m1.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3">𝑆</ci><ci id="S3.E6.m1.3.3.3.3.4.cmml" xref="S3.E6.m1.3.3.3.3.4">𝑎</ci><ci id="S3.E6.m1.3.3.3.3.5.cmml" xref="S3.E6.m1.3.3.3.3.5">𝑚</ci><ci id="S3.E6.m1.3.3.3.3.6.cmml" xref="S3.E6.m1.3.3.3.3.6">𝑝</ci></apply></apply><apply id="S3.E6.m1.3.3.1.cmml" xref="S3.E6.m1.3.3.1"><minus id="S3.E6.m1.3.3.1.2.cmml" xref="S3.E6.m1.3.3.1"></minus><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1.1"><apply id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2">subscript</csymbol><sum id="S3.E6.m1.3.3.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.2"></sum><apply id="S3.E6.m1.3.3.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3"><eq id="S3.E6.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3.1"></eq><ci id="S3.E6.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E6.m1.3.3.1.1.2.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.3.3.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.2.3">𝐾</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1"><apply id="S3.E6.m1.3.3.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.2">superscript</csymbol><apply id="S3.E6.m1.3.3.1.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S3.E6.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2.2.2"></sum><apply id="S3.E6.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.2.2.3"><eq id="S3.E6.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S3.E6.m1.3.3.1.1.1.2.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.2.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.2.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.2.3.2">𝑛</ci><ci id="S3.E6.m1.3.3.1.1.1.2.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S3.E6.m1.3.3.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1"><times id="S3.E6.m1.3.3.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.2"></times><apply id="S3.E6.m1.3.3.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3"><ci id="S3.E6.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.1">⋅</ci><apply id="S3.E6.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.2">subscript</csymbol><cn type="integer" id="S3.E6.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.2.2">1</cn><ci id="S3.E6.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="S3.E6.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.3"><log id="S3.E6.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.3.1"></log><ci id="S3.E6.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.3.3.2">𝑓</ci></apply></apply><list id="S3.E6.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1"><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.2">𝒛</ci><apply id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3"><times id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.2">𝑘</ci><ci id="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.3.3.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝑊</ci><ci id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2">𝒃</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\mathcal{L}_{tSamp}=-\sum\nolimits_{k=1}^{K}\sum\nolimits_{j=1}^{n_{k}}\bm{1}_{k}\cdot\log f(\bm{z}_{kj};W,\bm{b})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.12" class="ltx_p">where <math id="S3.SS3.p2.11.m1.1" class="ltx_Math" alttext="\bm{1}_{k}" display="inline"><semantics id="S3.SS3.p2.11.m1.1a"><msub id="S3.SS3.p2.11.m1.1.1" xref="S3.SS3.p2.11.m1.1.1.cmml"><mn id="S3.SS3.p2.11.m1.1.1.2" xref="S3.SS3.p2.11.m1.1.1.2.cmml">𝟏</mn><mi id="S3.SS3.p2.11.m1.1.1.3" xref="S3.SS3.p2.11.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m1.1b"><apply id="S3.SS3.p2.11.m1.1.1.cmml" xref="S3.SS3.p2.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.11.m1.1.1.1.cmml" xref="S3.SS3.p2.11.m1.1.1">subscript</csymbol><cn type="integer" id="S3.SS3.p2.11.m1.1.1.2.cmml" xref="S3.SS3.p2.11.m1.1.1.2">1</cn><ci id="S3.SS3.p2.11.m1.1.1.3.cmml" xref="S3.SS3.p2.11.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m1.1c">\bm{1}_{k}</annotation></semantics></math> denotes the one-hot vector with a single 1 at the <math id="S3.SS3.p2.12.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p2.12.m2.1a"><mi id="S3.SS3.p2.12.m2.1.1" xref="S3.SS3.p2.12.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m2.1b"><ci id="S3.SS3.p2.12.m2.1.1.cmml" xref="S3.SS3.p2.12.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m2.1c">k</annotation></semantics></math>-th entry.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para ltx_noindent">
<p id="S3.SS3.p3.4" class="ltx_p">To tackle the class imbalance problem at local clients,
we further propose a class-balanced sampling strategy
that generates more synthetic instances for the minority classes compared to the majority classes.
To illustrate this, let’s denote
the number of images categorized into the <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">k</annotation></semantics></math>-th class based on the pseudo-labels (<math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="k=\operatorname*{arg\,max}_{k^{\prime}}\bm{q}_{jk^{\prime}}^{t}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mrow id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">k</mi><mo id="S3.SS3.p3.2.m2.1.1.1" xref="S3.SS3.p3.2.m2.1.1.1.cmml">=</mo><mrow id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml"><msub id="S3.SS3.p3.2.m2.1.1.3.1" xref="S3.SS3.p3.2.m2.1.1.3.1.cmml"><mrow id="S3.SS3.p3.2.m2.1.1.3.1.2" xref="S3.SS3.p3.2.m2.1.1.3.1.2.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.1.2.2" xref="S3.SS3.p3.2.m2.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.SS3.p3.2.m2.1.1.3.1.2.1" xref="S3.SS3.p3.2.m2.1.1.3.1.2.1.cmml">​</mo><mi id="S3.SS3.p3.2.m2.1.1.3.1.2.3" xref="S3.SS3.p3.2.m2.1.1.3.1.2.3.cmml">max</mi></mrow><msup id="S3.SS3.p3.2.m2.1.1.3.1.3" xref="S3.SS3.p3.2.m2.1.1.3.1.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.1.3.2" xref="S3.SS3.p3.2.m2.1.1.3.1.3.2.cmml">k</mi><mo id="S3.SS3.p3.2.m2.1.1.3.1.3.3" xref="S3.SS3.p3.2.m2.1.1.3.1.3.3.cmml">′</mo></msup></msub><mo id="S3.SS3.p3.2.m2.1.1.3a" xref="S3.SS3.p3.2.m2.1.1.3.cmml">⁡</mo><msubsup id="S3.SS3.p3.2.m2.1.1.3.2" xref="S3.SS3.p3.2.m2.1.1.3.2.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.2.2.2" xref="S3.SS3.p3.2.m2.1.1.3.2.2.2.cmml">𝒒</mi><mrow id="S3.SS3.p3.2.m2.1.1.3.2.2.3" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.2.2.3.2" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.2.cmml">j</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.2.m2.1.1.3.2.2.3.1" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.1.cmml">​</mo><msup id="S3.SS3.p3.2.m2.1.1.3.2.2.3.3" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.cmml"><mi id="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.2" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.2.cmml">k</mi><mo id="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.3" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.3.cmml">′</mo></msup></mrow><mi id="S3.SS3.p3.2.m2.1.1.3.2.3" xref="S3.SS3.p3.2.m2.1.1.3.2.3.cmml">t</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><eq id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.1"></eq><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝑘</ci><apply id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3"><apply id="S3.SS3.p3.2.m2.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.3.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1">subscript</csymbol><apply id="S3.SS3.p3.2.m2.1.1.3.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1.2"><times id="S3.SS3.p3.2.m2.1.1.3.1.2.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1.2.1"></times><ci id="S3.SS3.p3.2.m2.1.1.3.1.2.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1.2.2">arg</ci><ci id="S3.SS3.p3.2.m2.1.1.3.1.2.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1.2.3">max</ci></apply><apply id="S3.SS3.p3.2.m2.1.1.3.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.3.1.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1.3">superscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.3.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1.3.2">𝑘</ci><ci id="S3.SS3.p3.2.m2.1.1.3.1.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.1.3.3">′</ci></apply></apply><apply id="S3.SS3.p3.2.m2.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.3.2.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2">superscript</csymbol><apply id="S3.SS3.p3.2.m2.1.1.3.2.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.3.2.2.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2">subscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.3.2.2.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.2.2">𝒒</ci><apply id="S3.SS3.p3.2.m2.1.1.3.2.2.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3"><times id="S3.SS3.p3.2.m2.1.1.3.2.2.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.1"></times><ci id="S3.SS3.p3.2.m2.1.1.3.2.2.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.2">𝑗</ci><apply id="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.1.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.3">superscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.2.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.2">𝑘</ci><ci id="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.2.3.3.3">′</ci></apply></apply></apply><ci id="S3.SS3.p3.2.m2.1.1.3.2.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3.2.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">k=\operatorname*{arg\,max}_{k^{\prime}}\bm{q}_{jk^{\prime}}^{t}</annotation></semantics></math>)
on the considered client as <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="m_{k}" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><msub id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2" xref="S3.SS3.p3.3.m3.1.1.2.cmml">m</mi><mi id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2">𝑚</ci><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">m_{k}</annotation></semantics></math>.
The class-balanced sampling strategy determines the number of synthetic instances, <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><msub id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">n</mi><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">𝑛</ci><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">n_{k}</annotation></semantics></math>,
based on the following balancing equation:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.2" class="ltx_Math" alttext="m_{k}+n_{k}=(1+\gamma)m_{k^{*}},\quad 1\leq k\leq K" display="block"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.3.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><msub id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.cmml">m</mi><mi id="S3.E7.m1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.cmml">k</mi></msub><mo id="S3.E7.m1.1.1.1.1.3.1" xref="S3.E7.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.3.2" xref="S3.E7.m1.1.1.1.1.3.3.2.cmml">n</mi><mi id="S3.E7.m1.1.1.1.1.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.cmml">k</mi></msub></mrow><mo id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E7.m1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml">γ</mi></mrow><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.3.2.cmml">m</mi><msup id="S3.E7.m1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.3.3.2" xref="S3.E7.m1.1.1.1.1.1.3.3.2.cmml">k</mi><mo id="S3.E7.m1.1.1.1.1.1.3.3.3" xref="S3.E7.m1.1.1.1.1.1.3.3.3.cmml">∗</mo></msup></msub></mrow></mrow><mo rspace="1.167em" id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.3a.cmml">,</mo><mrow id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml"><mn id="S3.E7.m1.2.2.2.2.2" xref="S3.E7.m1.2.2.2.2.2.cmml">1</mn><mo id="S3.E7.m1.2.2.2.2.3" xref="S3.E7.m1.2.2.2.2.3.cmml">≤</mo><mi id="S3.E7.m1.2.2.2.2.4" xref="S3.E7.m1.2.2.2.2.4.cmml">k</mi><mo id="S3.E7.m1.2.2.2.2.5" xref="S3.E7.m1.2.2.2.2.5.cmml">≤</mo><mi id="S3.E7.m1.2.2.2.2.6" xref="S3.E7.m1.2.2.2.2.6.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.3a.cmml" xref="S3.E7.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></eq><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><plus id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1"></plus><apply id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2">𝑚</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3">𝑘</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2">𝑛</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"><plus id="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1"></plus><cn type="integer" id="S3.E7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.3">𝛾</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.3.2">𝑚</ci><apply id="S3.E7.m1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.3.3.2">𝑘</ci><times id="S3.E7.m1.1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3.3.3"></times></apply></apply></apply></apply><apply id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2"><and id="S3.E7.m1.2.2.2.2a.cmml" xref="S3.E7.m1.2.2.2.2"></and><apply id="S3.E7.m1.2.2.2.2b.cmml" xref="S3.E7.m1.2.2.2.2"><leq id="S3.E7.m1.2.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.2.3"></leq><cn type="integer" id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.2">1</cn><ci id="S3.E7.m1.2.2.2.2.4.cmml" xref="S3.E7.m1.2.2.2.2.4">𝑘</ci></apply><apply id="S3.E7.m1.2.2.2.2c.cmml" xref="S3.E7.m1.2.2.2.2"><leq id="S3.E7.m1.2.2.2.2.5.cmml" xref="S3.E7.m1.2.2.2.2.5"></leq><share href="#S3.E7.m1.2.2.2.2.4.cmml" id="S3.E7.m1.2.2.2.2d.cmml" xref="S3.E7.m1.2.2.2.2"></share><ci id="S3.E7.m1.2.2.2.2.6.cmml" xref="S3.E7.m1.2.2.2.2.6">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">m_{k}+n_{k}=(1+\gamma)m_{k^{*}},\quad 1\leq k\leq K</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.9" class="ltx_p">where <math id="S3.SS3.p3.5.m1.1" class="ltx_Math" alttext="k^{*}" display="inline"><semantics id="S3.SS3.p3.5.m1.1a"><msup id="S3.SS3.p3.5.m1.1.1" xref="S3.SS3.p3.5.m1.1.1.cmml"><mi id="S3.SS3.p3.5.m1.1.1.2" xref="S3.SS3.p3.5.m1.1.1.2.cmml">k</mi><mo id="S3.SS3.p3.5.m1.1.1.3" xref="S3.SS3.p3.5.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m1.1b"><apply id="S3.SS3.p3.5.m1.1.1.cmml" xref="S3.SS3.p3.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m1.1.1.1.cmml" xref="S3.SS3.p3.5.m1.1.1">superscript</csymbol><ci id="S3.SS3.p3.5.m1.1.1.2.cmml" xref="S3.SS3.p3.5.m1.1.1.2">𝑘</ci><times id="S3.SS3.p3.5.m1.1.1.3.cmml" xref="S3.SS3.p3.5.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m1.1c">k^{*}</annotation></semantics></math> denotes the class index with the largest number of predicted images on
the considered client, such that <math id="S3.SS3.p3.6.m2.4" class="ltx_math_unparsed" alttext="k^{*}=\operatorname*{arg\,max}_{k^{\prime}\in\{1,\cdots,K}m_{k^{\prime}}" display="inline"><semantics id="S3.SS3.p3.6.m2.4a"><mrow id="S3.SS3.p3.6.m2.4.5"><msup id="S3.SS3.p3.6.m2.4.5.2"><mi id="S3.SS3.p3.6.m2.4.5.2.2">k</mi><mo id="S3.SS3.p3.6.m2.4.5.2.3">∗</mo></msup><mo id="S3.SS3.p3.6.m2.4.5.1">=</mo><mrow id="S3.SS3.p3.6.m2.4.5.3"><msub id="S3.SS3.p3.6.m2.4.5.3.1"><mrow id="S3.SS3.p3.6.m2.4.5.3.1.2"><mi id="S3.SS3.p3.6.m2.4.5.3.1.2.2">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.SS3.p3.6.m2.4.5.3.1.2.1">​</mo><mi id="S3.SS3.p3.6.m2.4.5.3.1.2.3">max</mi></mrow><mrow id="S3.SS3.p3.6.m2.4.4.4"><msup id="S3.SS3.p3.6.m2.4.4.4.5"><mi id="S3.SS3.p3.6.m2.4.4.4.5.2">k</mi><mo id="S3.SS3.p3.6.m2.4.4.4.5.3">′</mo></msup><mo id="S3.SS3.p3.6.m2.4.4.4.4">∈</mo><mrow id="S3.SS3.p3.6.m2.4.4.4.6"><mo stretchy="false" id="S3.SS3.p3.6.m2.4.4.4.6.1">{</mo><mn id="S3.SS3.p3.6.m2.1.1.1.1">1</mn><mo id="S3.SS3.p3.6.m2.4.4.4.6.2">,</mo><mi mathvariant="normal" id="S3.SS3.p3.6.m2.2.2.2.2">⋯</mi><mo id="S3.SS3.p3.6.m2.4.4.4.6.3">,</mo><mi id="S3.SS3.p3.6.m2.3.3.3.3">K</mi></mrow></mrow></msub><mo id="S3.SS3.p3.6.m2.4.5.3a">⁡</mo><msub id="S3.SS3.p3.6.m2.4.5.3.2"><mi id="S3.SS3.p3.6.m2.4.5.3.2.2">m</mi><msup id="S3.SS3.p3.6.m2.4.5.3.2.3"><mi id="S3.SS3.p3.6.m2.4.5.3.2.3.2">k</mi><mo id="S3.SS3.p3.6.m2.4.5.3.2.3.3">′</mo></msup></msub></mrow></mrow><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m2.4b">k^{*}=\operatorname*{arg\,max}_{k^{\prime}\in\{1,\cdots,K}m_{k^{\prime}}</annotation></semantics></math>;
and <math id="S3.SS3.p3.7.m3.1" class="ltx_Math" alttext="\gamma&gt;0" display="inline"><semantics id="S3.SS3.p3.7.m3.1a"><mrow id="S3.SS3.p3.7.m3.1.1" xref="S3.SS3.p3.7.m3.1.1.cmml"><mi id="S3.SS3.p3.7.m3.1.1.2" xref="S3.SS3.p3.7.m3.1.1.2.cmml">γ</mi><mo id="S3.SS3.p3.7.m3.1.1.1" xref="S3.SS3.p3.7.m3.1.1.1.cmml">&gt;</mo><mn id="S3.SS3.p3.7.m3.1.1.3" xref="S3.SS3.p3.7.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m3.1b"><apply id="S3.SS3.p3.7.m3.1.1.cmml" xref="S3.SS3.p3.7.m3.1.1"><gt id="S3.SS3.p3.7.m3.1.1.1.cmml" xref="S3.SS3.p3.7.m3.1.1.1"></gt><ci id="S3.SS3.p3.7.m3.1.1.2.cmml" xref="S3.SS3.p3.7.m3.1.1.2">𝛾</ci><cn type="integer" id="S3.SS3.p3.7.m3.1.1.3.cmml" xref="S3.SS3.p3.7.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m3.1c">\gamma&gt;0</annotation></semantics></math> controls the number of synthetic instances to be sampled for class <math id="S3.SS3.p3.8.m4.1" class="ltx_Math" alttext="k^{*}" display="inline"><semantics id="S3.SS3.p3.8.m4.1a"><msup id="S3.SS3.p3.8.m4.1.1" xref="S3.SS3.p3.8.m4.1.1.cmml"><mi id="S3.SS3.p3.8.m4.1.1.2" xref="S3.SS3.p3.8.m4.1.1.2.cmml">k</mi><mo id="S3.SS3.p3.8.m4.1.1.3" xref="S3.SS3.p3.8.m4.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m4.1b"><apply id="S3.SS3.p3.8.m4.1.1.cmml" xref="S3.SS3.p3.8.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.8.m4.1.1.1.cmml" xref="S3.SS3.p3.8.m4.1.1">superscript</csymbol><ci id="S3.SS3.p3.8.m4.1.1.2.cmml" xref="S3.SS3.p3.8.m4.1.1.2">𝑘</ci><times id="S3.SS3.p3.8.m4.1.1.3.cmml" xref="S3.SS3.p3.8.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m4.1c">k^{*}</annotation></semantics></math>, specifically as <math id="S3.SS3.p3.9.m5.1" class="ltx_Math" alttext="n_{k^{*}}=\gamma m_{k^{*}}" display="inline"><semantics id="S3.SS3.p3.9.m5.1a"><mrow id="S3.SS3.p3.9.m5.1.1" xref="S3.SS3.p3.9.m5.1.1.cmml"><msub id="S3.SS3.p3.9.m5.1.1.2" xref="S3.SS3.p3.9.m5.1.1.2.cmml"><mi id="S3.SS3.p3.9.m5.1.1.2.2" xref="S3.SS3.p3.9.m5.1.1.2.2.cmml">n</mi><msup id="S3.SS3.p3.9.m5.1.1.2.3" xref="S3.SS3.p3.9.m5.1.1.2.3.cmml"><mi id="S3.SS3.p3.9.m5.1.1.2.3.2" xref="S3.SS3.p3.9.m5.1.1.2.3.2.cmml">k</mi><mo id="S3.SS3.p3.9.m5.1.1.2.3.3" xref="S3.SS3.p3.9.m5.1.1.2.3.3.cmml">∗</mo></msup></msub><mo id="S3.SS3.p3.9.m5.1.1.1" xref="S3.SS3.p3.9.m5.1.1.1.cmml">=</mo><mrow id="S3.SS3.p3.9.m5.1.1.3" xref="S3.SS3.p3.9.m5.1.1.3.cmml"><mi id="S3.SS3.p3.9.m5.1.1.3.2" xref="S3.SS3.p3.9.m5.1.1.3.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p3.9.m5.1.1.3.1" xref="S3.SS3.p3.9.m5.1.1.3.1.cmml">​</mo><msub id="S3.SS3.p3.9.m5.1.1.3.3" xref="S3.SS3.p3.9.m5.1.1.3.3.cmml"><mi id="S3.SS3.p3.9.m5.1.1.3.3.2" xref="S3.SS3.p3.9.m5.1.1.3.3.2.cmml">m</mi><msup id="S3.SS3.p3.9.m5.1.1.3.3.3" xref="S3.SS3.p3.9.m5.1.1.3.3.3.cmml"><mi id="S3.SS3.p3.9.m5.1.1.3.3.3.2" xref="S3.SS3.p3.9.m5.1.1.3.3.3.2.cmml">k</mi><mo id="S3.SS3.p3.9.m5.1.1.3.3.3.3" xref="S3.SS3.p3.9.m5.1.1.3.3.3.3.cmml">∗</mo></msup></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m5.1b"><apply id="S3.SS3.p3.9.m5.1.1.cmml" xref="S3.SS3.p3.9.m5.1.1"><eq id="S3.SS3.p3.9.m5.1.1.1.cmml" xref="S3.SS3.p3.9.m5.1.1.1"></eq><apply id="S3.SS3.p3.9.m5.1.1.2.cmml" xref="S3.SS3.p3.9.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m5.1.1.2.1.cmml" xref="S3.SS3.p3.9.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.9.m5.1.1.2.2.cmml" xref="S3.SS3.p3.9.m5.1.1.2.2">𝑛</ci><apply id="S3.SS3.p3.9.m5.1.1.2.3.cmml" xref="S3.SS3.p3.9.m5.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m5.1.1.2.3.1.cmml" xref="S3.SS3.p3.9.m5.1.1.2.3">superscript</csymbol><ci id="S3.SS3.p3.9.m5.1.1.2.3.2.cmml" xref="S3.SS3.p3.9.m5.1.1.2.3.2">𝑘</ci><times id="S3.SS3.p3.9.m5.1.1.2.3.3.cmml" xref="S3.SS3.p3.9.m5.1.1.2.3.3"></times></apply></apply><apply id="S3.SS3.p3.9.m5.1.1.3.cmml" xref="S3.SS3.p3.9.m5.1.1.3"><times id="S3.SS3.p3.9.m5.1.1.3.1.cmml" xref="S3.SS3.p3.9.m5.1.1.3.1"></times><ci id="S3.SS3.p3.9.m5.1.1.3.2.cmml" xref="S3.SS3.p3.9.m5.1.1.3.2">𝛾</ci><apply id="S3.SS3.p3.9.m5.1.1.3.3.cmml" xref="S3.SS3.p3.9.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m5.1.1.3.3.1.cmml" xref="S3.SS3.p3.9.m5.1.1.3.3">subscript</csymbol><ci id="S3.SS3.p3.9.m5.1.1.3.3.2.cmml" xref="S3.SS3.p3.9.m5.1.1.3.3.2">𝑚</ci><apply id="S3.SS3.p3.9.m5.1.1.3.3.3.cmml" xref="S3.SS3.p3.9.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p3.9.m5.1.1.3.3.3.1.cmml" xref="S3.SS3.p3.9.m5.1.1.3.3.3">superscript</csymbol><ci id="S3.SS3.p3.9.m5.1.1.3.3.3.2.cmml" xref="S3.SS3.p3.9.m5.1.1.3.3.3.2">𝑘</ci><times id="S3.SS3.p3.9.m5.1.1.3.3.3.3.cmml" xref="S3.SS3.p3.9.m5.1.1.3.3.3.3"></times></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m5.1c">n_{k^{*}}=\gamma m_{k^{*}}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para ltx_noindent">
<p id="S3.SS3.p4.2" class="ltx_p">By utilizing all the pseudo-labeled real instances and generated synthetic instances,
the linear classifier on each client is updated to minimize the following overall objective:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.4" class="ltx_Math" alttext="\min_{\bm{W},\bm{b}}\quad\mathcal{L}_{iST}+\lambda\mathcal{L}_{tSamp}" display="block"><semantics id="S3.E8.m1.4a"><mrow id="S3.E8.m1.4.4.2" xref="S3.E8.m1.4.4.3.cmml"><munder id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.2" xref="S3.E8.m1.3.3.1.1.2.cmml">min</mi><mrow id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">𝑾</mi><mo id="S3.E8.m1.2.2.2.4.1" xref="S3.E8.m1.2.2.2.3.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">𝒃</mi></mrow></munder><mspace width="1.167em" id="S3.E8.m1.4.4.2.3" xref="S3.E8.m1.4.4.3.cmml"></mspace><mrow id="S3.E8.m1.4.4.2.2" xref="S3.E8.m1.4.4.2.2.cmml"><msub id="S3.E8.m1.4.4.2.2.2" xref="S3.E8.m1.4.4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.4.4.2.2.2.2" xref="S3.E8.m1.4.4.2.2.2.2.cmml">ℒ</mi><mrow id="S3.E8.m1.4.4.2.2.2.3" xref="S3.E8.m1.4.4.2.2.2.3.cmml"><mi id="S3.E8.m1.4.4.2.2.2.3.2" xref="S3.E8.m1.4.4.2.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.4.4.2.2.2.3.1" xref="S3.E8.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.4.4.2.2.2.3.3" xref="S3.E8.m1.4.4.2.2.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.4.4.2.2.2.3.1a" xref="S3.E8.m1.4.4.2.2.2.3.1.cmml">​</mo><mi id="S3.E8.m1.4.4.2.2.2.3.4" xref="S3.E8.m1.4.4.2.2.2.3.4.cmml">T</mi></mrow></msub><mo id="S3.E8.m1.4.4.2.2.1" xref="S3.E8.m1.4.4.2.2.1.cmml">+</mo><mrow id="S3.E8.m1.4.4.2.2.3" xref="S3.E8.m1.4.4.2.2.3.cmml"><mi id="S3.E8.m1.4.4.2.2.3.2" xref="S3.E8.m1.4.4.2.2.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.4.4.2.2.3.1" xref="S3.E8.m1.4.4.2.2.3.1.cmml">​</mo><msub id="S3.E8.m1.4.4.2.2.3.3" xref="S3.E8.m1.4.4.2.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.4.4.2.2.3.3.2" xref="S3.E8.m1.4.4.2.2.3.3.2.cmml">ℒ</mi><mrow id="S3.E8.m1.4.4.2.2.3.3.3" xref="S3.E8.m1.4.4.2.2.3.3.3.cmml"><mi id="S3.E8.m1.4.4.2.2.3.3.3.2" xref="S3.E8.m1.4.4.2.2.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.4.4.2.2.3.3.3.1" xref="S3.E8.m1.4.4.2.2.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.4.4.2.2.3.3.3.3" xref="S3.E8.m1.4.4.2.2.3.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.4.4.2.2.3.3.3.1a" xref="S3.E8.m1.4.4.2.2.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.4.4.2.2.3.3.3.4" xref="S3.E8.m1.4.4.2.2.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.4.4.2.2.3.3.3.1b" xref="S3.E8.m1.4.4.2.2.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.4.4.2.2.3.3.3.5" xref="S3.E8.m1.4.4.2.2.3.3.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.4.4.2.2.3.3.3.1c" xref="S3.E8.m1.4.4.2.2.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.4.4.2.2.3.3.3.6" xref="S3.E8.m1.4.4.2.2.3.3.3.6.cmml">p</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.4b"><list id="S3.E8.m1.4.4.3.cmml" xref="S3.E8.m1.4.4.2"><apply id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1">subscript</csymbol><min id="S3.E8.m1.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2"></min><list id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.4"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝑾</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝒃</ci></list></apply><apply id="S3.E8.m1.4.4.2.2.cmml" xref="S3.E8.m1.4.4.2.2"><plus id="S3.E8.m1.4.4.2.2.1.cmml" xref="S3.E8.m1.4.4.2.2.1"></plus><apply id="S3.E8.m1.4.4.2.2.2.cmml" xref="S3.E8.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.2.2.2.1.cmml" xref="S3.E8.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.E8.m1.4.4.2.2.2.2.cmml" xref="S3.E8.m1.4.4.2.2.2.2">ℒ</ci><apply id="S3.E8.m1.4.4.2.2.2.3.cmml" xref="S3.E8.m1.4.4.2.2.2.3"><times id="S3.E8.m1.4.4.2.2.2.3.1.cmml" xref="S3.E8.m1.4.4.2.2.2.3.1"></times><ci id="S3.E8.m1.4.4.2.2.2.3.2.cmml" xref="S3.E8.m1.4.4.2.2.2.3.2">𝑖</ci><ci id="S3.E8.m1.4.4.2.2.2.3.3.cmml" xref="S3.E8.m1.4.4.2.2.2.3.3">𝑆</ci><ci id="S3.E8.m1.4.4.2.2.2.3.4.cmml" xref="S3.E8.m1.4.4.2.2.2.3.4">𝑇</ci></apply></apply><apply id="S3.E8.m1.4.4.2.2.3.cmml" xref="S3.E8.m1.4.4.2.2.3"><times id="S3.E8.m1.4.4.2.2.3.1.cmml" xref="S3.E8.m1.4.4.2.2.3.1"></times><ci id="S3.E8.m1.4.4.2.2.3.2.cmml" xref="S3.E8.m1.4.4.2.2.3.2">𝜆</ci><apply id="S3.E8.m1.4.4.2.2.3.3.cmml" xref="S3.E8.m1.4.4.2.2.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.2.2.3.3.1.cmml" xref="S3.E8.m1.4.4.2.2.3.3">subscript</csymbol><ci id="S3.E8.m1.4.4.2.2.3.3.2.cmml" xref="S3.E8.m1.4.4.2.2.3.3.2">ℒ</ci><apply id="S3.E8.m1.4.4.2.2.3.3.3.cmml" xref="S3.E8.m1.4.4.2.2.3.3.3"><times id="S3.E8.m1.4.4.2.2.3.3.3.1.cmml" xref="S3.E8.m1.4.4.2.2.3.3.3.1"></times><ci id="S3.E8.m1.4.4.2.2.3.3.3.2.cmml" xref="S3.E8.m1.4.4.2.2.3.3.3.2">𝑡</ci><ci id="S3.E8.m1.4.4.2.2.3.3.3.3.cmml" xref="S3.E8.m1.4.4.2.2.3.3.3.3">𝑆</ci><ci id="S3.E8.m1.4.4.2.2.3.3.3.4.cmml" xref="S3.E8.m1.4.4.2.2.3.3.3.4">𝑎</ci><ci id="S3.E8.m1.4.4.2.2.3.3.3.5.cmml" xref="S3.E8.m1.4.4.2.2.3.3.3.5">𝑚</ci><ci id="S3.E8.m1.4.4.2.2.3.3.3.6.cmml" xref="S3.E8.m1.4.4.2.2.3.3.3.6">𝑝</ci></apply></apply></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.4c">\min_{\bm{W},\bm{b}}\quad\mathcal{L}_{iST}+\lambda\mathcal{L}_{tSamp}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.1" class="ltx_p">where <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">\lambda</annotation></semantics></math> is the trade-off parameter.
The overall training algorithm for the proposed lighted unsupervised federated learning method,
FST-CBDG, is presented in Algorithm <a href="#algorithm1" title="In Appendix A Algorithm ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> of Appendix <a href="#A1" title="Appendix A Algorithm ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para ltx_noindent">
<p id="S4.p1.1" class="ltx_p">We conduct comprehensive experiments to assess the performance of the proposed method, Federatged Self-Training with Class-Balanced Data Generation (FST-CBDG), under the lightweight unsupervised federated learning setting. Furthermore, we evaluate the proposed method in terms of computation and communication efficiency. Additional ablation study analyses contributions of individual components and examines the effects of certain hyper-parameters.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Settings</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.22" class="ltx_p"><span id="S4.SS1.p1.22.1" class="ltx_text ltx_font_bold">Datasets partition.</span>
Following the experimental settings in <cite class="ltx_cite ltx_citemacro_citet">Lee et al. (<a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite>, we have conducted experiments on three datasets: CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib16" title="" class="ltx_ref">2009</a>)</cite>, CIFAR-100 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib16" title="" class="ltx_ref">2009</a>)</cite>, and CINIC-10 <cite class="ltx_cite ltx_citemacro_citep">(Darlow et al., <a href="#bib.bib3" title="" class="ltx_ref">2018</a>)</cite>.
To emulate the federated learning scenario, we divide the data among <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="N=100" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mrow id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">N</mi><mo id="S4.SS1.p1.1.m1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><eq id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1"></eq><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝑁</ci><cn type="integer" id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">N=100</annotation></semantics></math> clients, ensuring no overlap. In each communication round, a random 10% of the clients participate in the federated training process.
We have considered both homogeneous (i.i.d.) and heterogeneous (non-i.i.d.) data distribution settings.
In the homogeneous setting, the data is evenly split and distributed to each client. In contrast, the heterogeneous setting involves the use of two widely recognized partition methods: <span id="S4.SS1.p1.22.2" class="ltx_text ltx_font_italic">Sharding</span> and Latent Dirichlet Allocation (<span id="S4.SS1.p1.22.3" class="ltx_text ltx_font_italic">LDA</span>).
<span id="S4.SS1.p1.22.4" class="ltx_text ltx_font_italic">Sharding</span> involves sorting the data based on the labels and then dividing them into <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="Ns" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">​</mo><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><times id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1"></times><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝑁</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">Ns</annotation></semantics></math> shards where <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">s</annotation></semantics></math> represents the number of shards per client. Each client subsequently randomly selects <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">s</annotation></semantics></math> shards without replacement to constitute its local data. The parameter <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><ci id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">s</annotation></semantics></math> controls the data heterogeneity, with smaller values of <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><ci id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">s</annotation></semantics></math> leading to higher levels of data heterogeneity. We conducted experiments on all three datasets using various values: CIFAR-10 (<math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mi id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><ci id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">s</annotation></semantics></math> values of 2, 3, 5, and 10), CIFAR-100 (<math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mi id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b"><ci id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">s</annotation></semantics></math> value of 10) and CINIC-10 (<math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><mi id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b"><ci id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">s</annotation></semantics></math> value of 2).
On the other hand, the <span id="S4.SS1.p1.22.5" class="ltx_text ltx_font_italic">LDA</span> method partitions each class of data to each client according to a Dirichlet distribution with a parameter <math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><mi id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.1b"><ci id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.1c">\alpha</annotation></semantics></math>. For any given class <math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><mi id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b"><ci id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">k</annotation></semantics></math>, each client <math id="S4.SS1.p1.12.m12.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p1.12.m12.1a"><mi id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.1b"><ci id="S4.SS1.p1.12.m12.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.1c">i</annotation></semantics></math> randomly samples a proportion <math id="S4.SS1.p1.13.m13.1" class="ltx_Math" alttext="p_{ki}" display="inline"><semantics id="S4.SS1.p1.13.m13.1a"><msub id="S4.SS1.p1.13.m13.1.1" xref="S4.SS1.p1.13.m13.1.1.cmml"><mi id="S4.SS1.p1.13.m13.1.1.2" xref="S4.SS1.p1.13.m13.1.1.2.cmml">p</mi><mrow id="S4.SS1.p1.13.m13.1.1.3" xref="S4.SS1.p1.13.m13.1.1.3.cmml"><mi id="S4.SS1.p1.13.m13.1.1.3.2" xref="S4.SS1.p1.13.m13.1.1.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.13.m13.1.1.3.1" xref="S4.SS1.p1.13.m13.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.13.m13.1.1.3.3" xref="S4.SS1.p1.13.m13.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.1b"><apply id="S4.SS1.p1.13.m13.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.1.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S4.SS1.p1.13.m13.1.1.2.cmml" xref="S4.SS1.p1.13.m13.1.1.2">𝑝</ci><apply id="S4.SS1.p1.13.m13.1.1.3.cmml" xref="S4.SS1.p1.13.m13.1.1.3"><times id="S4.SS1.p1.13.m13.1.1.3.1.cmml" xref="S4.SS1.p1.13.m13.1.1.3.1"></times><ci id="S4.SS1.p1.13.m13.1.1.3.2.cmml" xref="S4.SS1.p1.13.m13.1.1.3.2">𝑘</ci><ci id="S4.SS1.p1.13.m13.1.1.3.3.cmml" xref="S4.SS1.p1.13.m13.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.1c">p_{ki}</annotation></semantics></math> of the data belonging to class <math id="S4.SS1.p1.14.m14.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.14.m14.1a"><mi id="S4.SS1.p1.14.m14.1.1" xref="S4.SS1.p1.14.m14.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m14.1b"><ci id="S4.SS1.p1.14.m14.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.14.m14.1c">k</annotation></semantics></math>, where <math id="S4.SS1.p1.15.m15.1" class="ltx_Math" alttext="p_{ki}\sim Dir(\alpha)" display="inline"><semantics id="S4.SS1.p1.15.m15.1a"><mrow id="S4.SS1.p1.15.m15.1.2" xref="S4.SS1.p1.15.m15.1.2.cmml"><msub id="S4.SS1.p1.15.m15.1.2.2" xref="S4.SS1.p1.15.m15.1.2.2.cmml"><mi id="S4.SS1.p1.15.m15.1.2.2.2" xref="S4.SS1.p1.15.m15.1.2.2.2.cmml">p</mi><mrow id="S4.SS1.p1.15.m15.1.2.2.3" xref="S4.SS1.p1.15.m15.1.2.2.3.cmml"><mi id="S4.SS1.p1.15.m15.1.2.2.3.2" xref="S4.SS1.p1.15.m15.1.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.15.m15.1.2.2.3.1" xref="S4.SS1.p1.15.m15.1.2.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.15.m15.1.2.2.3.3" xref="S4.SS1.p1.15.m15.1.2.2.3.3.cmml">i</mi></mrow></msub><mo id="S4.SS1.p1.15.m15.1.2.1" xref="S4.SS1.p1.15.m15.1.2.1.cmml">∼</mo><mrow id="S4.SS1.p1.15.m15.1.2.3" xref="S4.SS1.p1.15.m15.1.2.3.cmml"><mi id="S4.SS1.p1.15.m15.1.2.3.2" xref="S4.SS1.p1.15.m15.1.2.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.15.m15.1.2.3.1" xref="S4.SS1.p1.15.m15.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.15.m15.1.2.3.3" xref="S4.SS1.p1.15.m15.1.2.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.15.m15.1.2.3.1a" xref="S4.SS1.p1.15.m15.1.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.15.m15.1.2.3.4" xref="S4.SS1.p1.15.m15.1.2.3.4.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.15.m15.1.2.3.1b" xref="S4.SS1.p1.15.m15.1.2.3.1.cmml">​</mo><mrow id="S4.SS1.p1.15.m15.1.2.3.5.2" xref="S4.SS1.p1.15.m15.1.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.15.m15.1.2.3.5.2.1" xref="S4.SS1.p1.15.m15.1.2.3.cmml">(</mo><mi id="S4.SS1.p1.15.m15.1.1" xref="S4.SS1.p1.15.m15.1.1.cmml">α</mi><mo stretchy="false" id="S4.SS1.p1.15.m15.1.2.3.5.2.2" xref="S4.SS1.p1.15.m15.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m15.1b"><apply id="S4.SS1.p1.15.m15.1.2.cmml" xref="S4.SS1.p1.15.m15.1.2"><csymbol cd="latexml" id="S4.SS1.p1.15.m15.1.2.1.cmml" xref="S4.SS1.p1.15.m15.1.2.1">similar-to</csymbol><apply id="S4.SS1.p1.15.m15.1.2.2.cmml" xref="S4.SS1.p1.15.m15.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.15.m15.1.2.2.1.cmml" xref="S4.SS1.p1.15.m15.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.15.m15.1.2.2.2.cmml" xref="S4.SS1.p1.15.m15.1.2.2.2">𝑝</ci><apply id="S4.SS1.p1.15.m15.1.2.2.3.cmml" xref="S4.SS1.p1.15.m15.1.2.2.3"><times id="S4.SS1.p1.15.m15.1.2.2.3.1.cmml" xref="S4.SS1.p1.15.m15.1.2.2.3.1"></times><ci id="S4.SS1.p1.15.m15.1.2.2.3.2.cmml" xref="S4.SS1.p1.15.m15.1.2.2.3.2">𝑘</ci><ci id="S4.SS1.p1.15.m15.1.2.2.3.3.cmml" xref="S4.SS1.p1.15.m15.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S4.SS1.p1.15.m15.1.2.3.cmml" xref="S4.SS1.p1.15.m15.1.2.3"><times id="S4.SS1.p1.15.m15.1.2.3.1.cmml" xref="S4.SS1.p1.15.m15.1.2.3.1"></times><ci id="S4.SS1.p1.15.m15.1.2.3.2.cmml" xref="S4.SS1.p1.15.m15.1.2.3.2">𝐷</ci><ci id="S4.SS1.p1.15.m15.1.2.3.3.cmml" xref="S4.SS1.p1.15.m15.1.2.3.3">𝑖</ci><ci id="S4.SS1.p1.15.m15.1.2.3.4.cmml" xref="S4.SS1.p1.15.m15.1.2.3.4">𝑟</ci><ci id="S4.SS1.p1.15.m15.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1">𝛼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.15.m15.1c">p_{ki}\sim Dir(\alpha)</annotation></semantics></math> and <math id="S4.SS1.p1.16.m16.1" class="ltx_Math" alttext="\sum_{i=1}^{N}p_{ki}=1" display="inline"><semantics id="S4.SS1.p1.16.m16.1a"><mrow id="S4.SS1.p1.16.m16.1.1" xref="S4.SS1.p1.16.m16.1.1.cmml"><mrow id="S4.SS1.p1.16.m16.1.1.2" xref="S4.SS1.p1.16.m16.1.1.2.cmml"><msubsup id="S4.SS1.p1.16.m16.1.1.2.1" xref="S4.SS1.p1.16.m16.1.1.2.1.cmml"><mo id="S4.SS1.p1.16.m16.1.1.2.1.2.2" xref="S4.SS1.p1.16.m16.1.1.2.1.2.2.cmml">∑</mo><mrow id="S4.SS1.p1.16.m16.1.1.2.1.2.3" xref="S4.SS1.p1.16.m16.1.1.2.1.2.3.cmml"><mi id="S4.SS1.p1.16.m16.1.1.2.1.2.3.2" xref="S4.SS1.p1.16.m16.1.1.2.1.2.3.2.cmml">i</mi><mo id="S4.SS1.p1.16.m16.1.1.2.1.2.3.1" xref="S4.SS1.p1.16.m16.1.1.2.1.2.3.1.cmml">=</mo><mn id="S4.SS1.p1.16.m16.1.1.2.1.2.3.3" xref="S4.SS1.p1.16.m16.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p1.16.m16.1.1.2.1.3" xref="S4.SS1.p1.16.m16.1.1.2.1.3.cmml">N</mi></msubsup><msub id="S4.SS1.p1.16.m16.1.1.2.2" xref="S4.SS1.p1.16.m16.1.1.2.2.cmml"><mi id="S4.SS1.p1.16.m16.1.1.2.2.2" xref="S4.SS1.p1.16.m16.1.1.2.2.2.cmml">p</mi><mrow id="S4.SS1.p1.16.m16.1.1.2.2.3" xref="S4.SS1.p1.16.m16.1.1.2.2.3.cmml"><mi id="S4.SS1.p1.16.m16.1.1.2.2.3.2" xref="S4.SS1.p1.16.m16.1.1.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.16.m16.1.1.2.2.3.1" xref="S4.SS1.p1.16.m16.1.1.2.2.3.1.cmml">​</mo><mi id="S4.SS1.p1.16.m16.1.1.2.2.3.3" xref="S4.SS1.p1.16.m16.1.1.2.2.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S4.SS1.p1.16.m16.1.1.1" xref="S4.SS1.p1.16.m16.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.16.m16.1.1.3" xref="S4.SS1.p1.16.m16.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.16.m16.1b"><apply id="S4.SS1.p1.16.m16.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1"><eq id="S4.SS1.p1.16.m16.1.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1.1"></eq><apply id="S4.SS1.p1.16.m16.1.1.2.cmml" xref="S4.SS1.p1.16.m16.1.1.2"><apply id="S4.SS1.p1.16.m16.1.1.2.1.cmml" xref="S4.SS1.p1.16.m16.1.1.2.1"><csymbol cd="ambiguous" id="S4.SS1.p1.16.m16.1.1.2.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1.2.1">superscript</csymbol><apply id="S4.SS1.p1.16.m16.1.1.2.1.2.cmml" xref="S4.SS1.p1.16.m16.1.1.2.1"><csymbol cd="ambiguous" id="S4.SS1.p1.16.m16.1.1.2.1.2.1.cmml" xref="S4.SS1.p1.16.m16.1.1.2.1">subscript</csymbol><sum id="S4.SS1.p1.16.m16.1.1.2.1.2.2.cmml" xref="S4.SS1.p1.16.m16.1.1.2.1.2.2"></sum><apply id="S4.SS1.p1.16.m16.1.1.2.1.2.3.cmml" xref="S4.SS1.p1.16.m16.1.1.2.1.2.3"><eq id="S4.SS1.p1.16.m16.1.1.2.1.2.3.1.cmml" xref="S4.SS1.p1.16.m16.1.1.2.1.2.3.1"></eq><ci id="S4.SS1.p1.16.m16.1.1.2.1.2.3.2.cmml" xref="S4.SS1.p1.16.m16.1.1.2.1.2.3.2">𝑖</ci><cn type="integer" id="S4.SS1.p1.16.m16.1.1.2.1.2.3.3.cmml" xref="S4.SS1.p1.16.m16.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S4.SS1.p1.16.m16.1.1.2.1.3.cmml" xref="S4.SS1.p1.16.m16.1.1.2.1.3">𝑁</ci></apply><apply id="S4.SS1.p1.16.m16.1.1.2.2.cmml" xref="S4.SS1.p1.16.m16.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS1.p1.16.m16.1.1.2.2.1.cmml" xref="S4.SS1.p1.16.m16.1.1.2.2">subscript</csymbol><ci id="S4.SS1.p1.16.m16.1.1.2.2.2.cmml" xref="S4.SS1.p1.16.m16.1.1.2.2.2">𝑝</ci><apply id="S4.SS1.p1.16.m16.1.1.2.2.3.cmml" xref="S4.SS1.p1.16.m16.1.1.2.2.3"><times id="S4.SS1.p1.16.m16.1.1.2.2.3.1.cmml" xref="S4.SS1.p1.16.m16.1.1.2.2.3.1"></times><ci id="S4.SS1.p1.16.m16.1.1.2.2.3.2.cmml" xref="S4.SS1.p1.16.m16.1.1.2.2.3.2">𝑘</ci><ci id="S4.SS1.p1.16.m16.1.1.2.2.3.3.cmml" xref="S4.SS1.p1.16.m16.1.1.2.2.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S4.SS1.p1.16.m16.1.1.3.cmml" xref="S4.SS1.p1.16.m16.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.16.m16.1c">\sum_{i=1}^{N}p_{ki}=1</annotation></semantics></math>. The parameter <math id="S4.SS1.p1.17.m17.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p1.17.m17.1a"><mi id="S4.SS1.p1.17.m17.1.1" xref="S4.SS1.p1.17.m17.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.17.m17.1b"><ci id="S4.SS1.p1.17.m17.1.1.cmml" xref="S4.SS1.p1.17.m17.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.17.m17.1c">\alpha</annotation></semantics></math> controls the data heterogeneity within each client, with smaller values of <math id="S4.SS1.p1.18.m18.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p1.18.m18.1a"><mi id="S4.SS1.p1.18.m18.1.1" xref="S4.SS1.p1.18.m18.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.18.m18.1b"><ci id="S4.SS1.p1.18.m18.1.1.cmml" xref="S4.SS1.p1.18.m18.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.18.m18.1c">\alpha</annotation></semantics></math> indicating more severe data heterogeneity. In our experiments, we used various <math id="S4.SS1.p1.19.m19.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p1.19.m19.1a"><mi id="S4.SS1.p1.19.m19.1.1" xref="S4.SS1.p1.19.m19.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.19.m19.1b"><ci id="S4.SS1.p1.19.m19.1.1.cmml" xref="S4.SS1.p1.19.m19.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.19.m19.1c">\alpha</annotation></semantics></math> values for the three datasets, CIFAR-10 (<math id="S4.SS1.p1.20.m20.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p1.20.m20.1a"><mi id="S4.SS1.p1.20.m20.1.1" xref="S4.SS1.p1.20.m20.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.20.m20.1b"><ci id="S4.SS1.p1.20.m20.1.1.cmml" xref="S4.SS1.p1.20.m20.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.20.m20.1c">\alpha</annotation></semantics></math> values of 0.05, 0.1, 0.3, 0.5), CIFAR-100 (<math id="S4.SS1.p1.21.m21.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p1.21.m21.1a"><mi id="S4.SS1.p1.21.m21.1.1" xref="S4.SS1.p1.21.m21.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.21.m21.1b"><ci id="S4.SS1.p1.21.m21.1.1.cmml" xref="S4.SS1.p1.21.m21.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.21.m21.1c">\alpha</annotation></semantics></math> value of 0.1) and CINIC-10 (<math id="S4.SS1.p1.22.m22.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.p1.22.m22.1a"><mi id="S4.SS1.p1.22.m22.1.1" xref="S4.SS1.p1.22.m22.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.22.m22.1b"><ci id="S4.SS1.p1.22.m22.1.1.cmml" xref="S4.SS1.p1.22.m22.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.22.m22.1c">\alpha</annotation></semantics></math> value of 0.1).
It’s important to note that in the context of unsupervised federated learning, all data within each client are unlabeled.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.4" class="ltx_p"><span id="S4.SS1.p2.4.1" class="ltx_text ltx_font_bold">Implementation details.</span> CLIP offers various pretrained image encoders with different model architectures. Specifically, we chose a simple variant, ‘RN50’, in which the global average pooling layer of the original ResNet-50 model is replaced with an attention pooling mechanism <cite class="ltx_cite ltx_citemacro_citep">(Radford et al., <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite>. The pretrained text encoder is based on a modified Transformer model <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite>. The linear classifier has a input size of 1024, which matches the the output size of the CLIP image encoder. We optimized the linear classifier using mini-batch Stochastic Gradient Descent (SGD) with a learning rate of 0.01, a momentum of 0.9 and a weight decay of <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="10^{-5}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><msup id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mn id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">10</mn><mrow id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml"><mo id="S4.SS1.p2.1.m1.1.1.3a" xref="S4.SS1.p2.1.m1.1.1.3.cmml">−</mo><mn id="S4.SS1.p2.1.m1.1.1.3.2" xref="S4.SS1.p2.1.m1.1.1.3.2.cmml">5</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">superscript</csymbol><cn type="integer" id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">10</cn><apply id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3"><minus id="S4.SS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3"></minus><cn type="integer" id="S4.SS1.p2.1.m1.1.1.3.2.cmml" xref="S4.SS1.p2.1.m1.1.1.3.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">10^{-5}</annotation></semantics></math>.
For the proposed method, we set the moving average parameter of the pseudo-label updating <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">\beta</annotation></semantics></math>, to 0.9, and the class-balanced sampling parameter <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\gamma</annotation></semantics></math> to 0. The trade-off parameter between the self-training and text sampling losses <math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mi id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><ci id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">\lambda</annotation></semantics></math> was set to 1.
Given the lightweight setting, we limited the number of communication rounds to 10, and each client performed 1 local update epoch for each round. These settings were chosen to align with the computational and communication capacities of the local clients.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Baselines.</span> In our experiments, we compared our proposed method, FST-CBDG, with two baseline approaches and two representative supervised federated learning methods. CLIP-ZS represents using the pretrained CLIP model to make zero-shot prediction on the testing data. CLIP-FC-Centralized denotes that we train a linear classifier based on the fixed CLIP image encoder with SGD optimizer in a centralized manner. The classifier was trained on all the training data with labels and evaluated on the testing data.
FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> and FedNTD <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a href="#bib.bib17" title="" class="ltx_ref">2022</a>)</cite> train a linear classifier based on the fixed CLIP image encoder with labeled training data in each client.
Our proposed method, FST-CBDG, differs from the above methods as it trains a linear classifier in a federated manner, but all the data in each client are unlabeled. This introduces a more challenging setting compared to the supervised federated learning methods.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Comparison Results</h3>

<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Performance on Homogeneous Data</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">In our evaluation under the homogeneous data distribution setting, we compared the performance of the proposed FST-CBDG method with several baselines, including CLIP-ZS, CLIP-FC-Centralized, FedAvg, and FedNTD, on three datasets: CIFAR-10, CIFAR-100, and CINIC-10. Here are the key findings from the results in Table <a href="#S4.T1" title="Table 1 ‣ 4.2.1 Performance on Homogeneous Data ‣ 4.2 Comparison Results ‣ 4 Experiments ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
CLIP-ZS achieves decent performance on all three datasets. It serves as a strong baseline, leveraging the pretrained CLIP model’s tranfer capabilities.
CLIP-FC-Centralized, which trains a linear classifier using the fixed CLIP image encoder and labeled training data in a centralized manner, significantly improves performance compared to CLIP-ZS.
FedAvg and FedNTD, these supervised federated learning methods, which also train linear classifiers based on the fixed CLIP image encoder but with labeled data, outperform CLIP-ZS predictions.
Our proposed method, FST-CBDG, which operates in a federated manner with unlabeled data, outperforms CLIP-ZS by a significant margin on all three datasets. It even surpasses the performance of the supervised federated learning methods, FedAvg and FedNTD. Notably, FST-CBDG achieves performance that is close to the centralized and supervised baseline, CLIP-FC-Centralized.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Testing accuracy (%) under homogeneous data distribution.</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Methods</td>
<td id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">Supervised</td>
<td id="S4.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">CIFAR-10</td>
<td id="S4.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">CIFAR-100</td>
<td id="S4.T1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_tt">CINIC-10</td>
</tr>
<tr id="S4.T1.1.2.2" class="ltx_tr">
<td id="S4.T1.1.2.2.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">CLIP-ZS</td>
<td id="S4.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">-</td>
<td id="S4.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.7</td>
<td id="S4.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">39.0</td>
<td id="S4.T1.1.2.2.5" class="ltx_td ltx_align_center ltx_border_t">63.2</td>
</tr>
<tr id="S4.T1.1.3.3" class="ltx_tr">
<td id="S4.T1.1.3.3.1" class="ltx_td ltx_align_center ltx_border_r">CLIP-FC-Centralized</td>
<td id="S4.T1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r">✓</td>
<td id="S4.T1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r">77.5</td>
<td id="S4.T1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r">42.9</td>
<td id="S4.T1.1.3.3.5" class="ltx_td ltx_align_center">70.4</td>
</tr>
<tr id="S4.T1.1.4.4" class="ltx_tr">
<td id="S4.T1.1.4.4.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">FedAvg</td>
<td id="S4.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">✓</td>
<td id="S4.T1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.3</td>
<td id="S4.T1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">37.8</td>
<td id="S4.T1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_t">66.0</td>
</tr>
<tr id="S4.T1.1.5.5" class="ltx_tr">
<td id="S4.T1.1.5.5.1" class="ltx_td ltx_align_center ltx_border_r">FedNTD</td>
<td id="S4.T1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r">✓</td>
<td id="S4.T1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r">72.8</td>
<td id="S4.T1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r">39.8</td>
<td id="S4.T1.1.5.5.5" class="ltx_td ltx_align_center">66.2</td>
</tr>
<tr id="S4.T1.1.6.6" class="ltx_tr">
<td id="S4.T1.1.6.6.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">FST-CBDG (ours)</td>
<td id="S4.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">✗</td>
<td id="S4.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">74.0</td>
<td id="S4.T1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">43.2</td>
<td id="S4.T1.1.6.6.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">66.3</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Performance on Heterogeneous Data</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p">In our evaluation under the more challenging setting of heterogeneous data distribution, we considered two different data construction strategies: <span id="S4.SS2.SSS2.p1.1.1" class="ltx_text ltx_font_italic">Sharding</span> and <span id="S4.SS2.SSS2.p1.1.2" class="ltx_text ltx_font_italic">LDA</span>. Here are the key findings from the results in Table <a href="#S4.T2" title="Table 2 ‣ 4.2.2 Performance on Heterogeneous Data ‣ 4.2 Comparison Results ‣ 4 Experiments ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
Compared with the CLIP-ZS baseline, our method FST-CBDG consistently enhances model performance across all three datasets in the challenging heterogeneous setting.
FST-CBDG also outperforms the supervised federated learning methods across different datasets and heterogeneous data partition strategies even though our method trains the model without labels. It’s interesting to notice that the supervised federated learning methods fail under the lightweight heterogeneous federated learning setting even though labeled data are given. With limited communication rounds and local update epochs, FedAvg and FedNTD cannot preserve the initial performance of the CLIP zero-shot predictions. On the one hand, the strong supervision from the labeled data introduce negatives transferring effect to the linear model. On the other hand, data heterogeneity in the local client leads to biased local models thus biased aggregated global model while FedAvg and FedNTD failed to address this under the lightweight setting. However, our method FST-CBDG not only consistently improve the performance starting from the CLIP zero-shot prediction through the proposed resilient self-training method, but also reduce the influence of data heterogeneity by sampling synthetic instances.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Testing accuracy (%) under heterogeneous data distribution.</figcaption>
<div id="S4.T2.12" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:397.5pt;height:212.1pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-38.3pt,20.4pt) scale(0.838469355554517,0.838469355554517) ;">
<table id="S4.T2.12.12" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.12.12.13.1" class="ltx_tr">
<th id="S4.T2.12.12.13.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="8">NIID Partition Strategy: Sharding</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.12.12.14.1" class="ltx_tr">
<th id="S4.T2.12.12.14.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T2.12.12.14.1.1.1" class="ltx_text">Methods</span></th>
<th id="S4.T2.12.12.14.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T2.12.12.14.1.2.1" class="ltx_text">Supervised</span></th>
<td id="S4.T2.12.12.14.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="4">CIFAR-10</td>
<td id="S4.T2.12.12.14.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">CIFAR-100</td>
<td id="S4.T2.12.12.14.1.5" class="ltx_td ltx_align_center ltx_border_tt">CINIC-10</td>
</tr>
<tr id="S4.T2.6.6.6" class="ltx_tr">
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center"><math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="s=2" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mi id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2.cmml">s</mi><mo id="S4.T2.1.1.1.1.m1.1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><eq id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.1"></eq><ci id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">𝑠</ci><cn type="integer" id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">s=2</annotation></semantics></math></td>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center"><math id="S4.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="s=3" display="inline"><semantics id="S4.T2.2.2.2.2.m1.1a"><mrow id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml"><mi id="S4.T2.2.2.2.2.m1.1.1.2" xref="S4.T2.2.2.2.2.m1.1.1.2.cmml">s</mi><mo id="S4.T2.2.2.2.2.m1.1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T2.2.2.2.2.m1.1.1.3" xref="S4.T2.2.2.2.2.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><apply id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1"><eq id="S4.T2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1.1"></eq><ci id="S4.T2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2">𝑠</ci><cn type="integer" id="S4.T2.2.2.2.2.m1.1.1.3.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">s=3</annotation></semantics></math></td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center"><math id="S4.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="s=5" display="inline"><semantics id="S4.T2.3.3.3.3.m1.1a"><mrow id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml"><mi id="S4.T2.3.3.3.3.m1.1.1.2" xref="S4.T2.3.3.3.3.m1.1.1.2.cmml">s</mi><mo id="S4.T2.3.3.3.3.m1.1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.1.cmml">=</mo><mn id="S4.T2.3.3.3.3.m1.1.1.3" xref="S4.T2.3.3.3.3.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><apply id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1"><eq id="S4.T2.3.3.3.3.m1.1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1.1"></eq><ci id="S4.T2.3.3.3.3.m1.1.1.2.cmml" xref="S4.T2.3.3.3.3.m1.1.1.2">𝑠</ci><cn type="integer" id="S4.T2.3.3.3.3.m1.1.1.3.cmml" xref="S4.T2.3.3.3.3.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">s=5</annotation></semantics></math></td>
<td id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.4.4.4.4.m1.1" class="ltx_Math" alttext="s=10" display="inline"><semantics id="S4.T2.4.4.4.4.m1.1a"><mrow id="S4.T2.4.4.4.4.m1.1.1" xref="S4.T2.4.4.4.4.m1.1.1.cmml"><mi id="S4.T2.4.4.4.4.m1.1.1.2" xref="S4.T2.4.4.4.4.m1.1.1.2.cmml">s</mi><mo id="S4.T2.4.4.4.4.m1.1.1.1" xref="S4.T2.4.4.4.4.m1.1.1.1.cmml">=</mo><mn id="S4.T2.4.4.4.4.m1.1.1.3" xref="S4.T2.4.4.4.4.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.m1.1b"><apply id="S4.T2.4.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.4.m1.1.1"><eq id="S4.T2.4.4.4.4.m1.1.1.1.cmml" xref="S4.T2.4.4.4.4.m1.1.1.1"></eq><ci id="S4.T2.4.4.4.4.m1.1.1.2.cmml" xref="S4.T2.4.4.4.4.m1.1.1.2">𝑠</ci><cn type="integer" id="S4.T2.4.4.4.4.m1.1.1.3.cmml" xref="S4.T2.4.4.4.4.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.m1.1c">s=10</annotation></semantics></math></td>
<td id="S4.T2.5.5.5.5" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.5.5.5.5.m1.1" class="ltx_Math" alttext="s=10" display="inline"><semantics id="S4.T2.5.5.5.5.m1.1a"><mrow id="S4.T2.5.5.5.5.m1.1.1" xref="S4.T2.5.5.5.5.m1.1.1.cmml"><mi id="S4.T2.5.5.5.5.m1.1.1.2" xref="S4.T2.5.5.5.5.m1.1.1.2.cmml">s</mi><mo id="S4.T2.5.5.5.5.m1.1.1.1" xref="S4.T2.5.5.5.5.m1.1.1.1.cmml">=</mo><mn id="S4.T2.5.5.5.5.m1.1.1.3" xref="S4.T2.5.5.5.5.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.5.m1.1b"><apply id="S4.T2.5.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.5.m1.1.1"><eq id="S4.T2.5.5.5.5.m1.1.1.1.cmml" xref="S4.T2.5.5.5.5.m1.1.1.1"></eq><ci id="S4.T2.5.5.5.5.m1.1.1.2.cmml" xref="S4.T2.5.5.5.5.m1.1.1.2">𝑠</ci><cn type="integer" id="S4.T2.5.5.5.5.m1.1.1.3.cmml" xref="S4.T2.5.5.5.5.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.5.m1.1c">s=10</annotation></semantics></math></td>
<td id="S4.T2.6.6.6.6" class="ltx_td ltx_align_center"><math id="S4.T2.6.6.6.6.m1.1" class="ltx_Math" alttext="s=2" display="inline"><semantics id="S4.T2.6.6.6.6.m1.1a"><mrow id="S4.T2.6.6.6.6.m1.1.1" xref="S4.T2.6.6.6.6.m1.1.1.cmml"><mi id="S4.T2.6.6.6.6.m1.1.1.2" xref="S4.T2.6.6.6.6.m1.1.1.2.cmml">s</mi><mo id="S4.T2.6.6.6.6.m1.1.1.1" xref="S4.T2.6.6.6.6.m1.1.1.1.cmml">=</mo><mn id="S4.T2.6.6.6.6.m1.1.1.3" xref="S4.T2.6.6.6.6.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.6.m1.1b"><apply id="S4.T2.6.6.6.6.m1.1.1.cmml" xref="S4.T2.6.6.6.6.m1.1.1"><eq id="S4.T2.6.6.6.6.m1.1.1.1.cmml" xref="S4.T2.6.6.6.6.m1.1.1.1"></eq><ci id="S4.T2.6.6.6.6.m1.1.1.2.cmml" xref="S4.T2.6.6.6.6.m1.1.1.2">𝑠</ci><cn type="integer" id="S4.T2.6.6.6.6.m1.1.1.3.cmml" xref="S4.T2.6.6.6.6.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.6.m1.1c">s=2</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.12.12.15.2" class="ltx_tr">
<th id="S4.T2.12.12.15.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">CLIP-ZS</th>
<th id="S4.T2.12.12.15.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">-</th>
<td id="S4.T2.12.12.15.2.3" class="ltx_td ltx_align_center ltx_border_t" colspan="4">68.7</td>
<td id="S4.T2.12.12.15.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">39.0</td>
<td id="S4.T2.12.12.15.2.5" class="ltx_td ltx_align_center ltx_border_t">63.2</td>
</tr>
<tr id="S4.T2.12.12.16.3" class="ltx_tr">
<th id="S4.T2.12.12.16.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">CLIP-FC-Centralized</th>
<th id="S4.T2.12.12.16.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">✓</th>
<td id="S4.T2.12.12.16.3.3" class="ltx_td ltx_align_center" colspan="4">77.5</td>
<td id="S4.T2.12.12.16.3.4" class="ltx_td ltx_align_center ltx_border_r">42.9</td>
<td id="S4.T2.12.12.16.3.5" class="ltx_td ltx_align_center">70.4</td>
</tr>
<tr id="S4.T2.12.12.17.4" class="ltx_tr">
<th id="S4.T2.12.12.17.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">FedAvg</th>
<th id="S4.T2.12.12.17.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">✓</th>
<td id="S4.T2.12.12.17.4.3" class="ltx_td ltx_align_center ltx_border_t">32.3</td>
<td id="S4.T2.12.12.17.4.4" class="ltx_td ltx_align_center ltx_border_t">42.0</td>
<td id="S4.T2.12.12.17.4.5" class="ltx_td ltx_align_center ltx_border_t">43.5</td>
<td id="S4.T2.12.12.17.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">47.7</td>
<td id="S4.T2.12.12.17.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">34.1</td>
<td id="S4.T2.12.12.17.4.8" class="ltx_td ltx_align_center ltx_border_t">30.9</td>
</tr>
<tr id="S4.T2.12.12.18.5" class="ltx_tr">
<th id="S4.T2.12.12.18.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedNTD</th>
<th id="S4.T2.12.12.18.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">✓</th>
<td id="S4.T2.12.12.18.5.3" class="ltx_td ltx_align_center">42.0</td>
<td id="S4.T2.12.12.18.5.4" class="ltx_td ltx_align_center">64.1</td>
<td id="S4.T2.12.12.18.5.5" class="ltx_td ltx_align_center">47.6</td>
<td id="S4.T2.12.12.18.5.6" class="ltx_td ltx_align_center ltx_border_r">55.6</td>
<td id="S4.T2.12.12.18.5.7" class="ltx_td ltx_align_center ltx_border_r">26.6</td>
<td id="S4.T2.12.12.18.5.8" class="ltx_td ltx_align_center">35.8</td>
</tr>
<tr id="S4.T2.12.12.19.6" class="ltx_tr">
<th id="S4.T2.12.12.19.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">FST-CBDG (ours)</th>
<th id="S4.T2.12.12.19.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">✗</th>
<td id="S4.T2.12.12.19.6.3" class="ltx_td ltx_align_center ltx_border_t">72.0</td>
<td id="S4.T2.12.12.19.6.4" class="ltx_td ltx_align_center ltx_border_t">72.8</td>
<td id="S4.T2.12.12.19.6.5" class="ltx_td ltx_align_center ltx_border_t">73.6</td>
<td id="S4.T2.12.12.19.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">73.2</td>
<td id="S4.T2.12.12.19.6.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">43.3</td>
<td id="S4.T2.12.12.19.6.8" class="ltx_td ltx_align_center ltx_border_t">65.9</td>
</tr>
<tr id="S4.T2.12.12.20.7" class="ltx_tr">
<th id="S4.T2.12.12.20.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="8">NIID Partition Strategy: LDA.</th>
</tr>
<tr id="S4.T2.12.12.21.8" class="ltx_tr">
<th id="S4.T2.12.12.21.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T2.12.12.21.8.1.1" class="ltx_text">Method</span></th>
<th id="S4.T2.12.12.21.8.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T2.12.12.21.8.2.1" class="ltx_text">Supervised</span></th>
<td id="S4.T2.12.12.21.8.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="4">CIFAR-10</td>
<td id="S4.T2.12.12.21.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">CIFAR-100</td>
<td id="S4.T2.12.12.21.8.5" class="ltx_td ltx_align_center ltx_border_tt">CINIC-10</td>
</tr>
<tr id="S4.T2.12.12.12" class="ltx_tr">
<td id="S4.T2.7.7.7.1" class="ltx_td ltx_align_center"><math id="S4.T2.7.7.7.1.m1.1" class="ltx_Math" alttext="\alpha=0.05" display="inline"><semantics id="S4.T2.7.7.7.1.m1.1a"><mrow id="S4.T2.7.7.7.1.m1.1.1" xref="S4.T2.7.7.7.1.m1.1.1.cmml"><mi id="S4.T2.7.7.7.1.m1.1.1.2" xref="S4.T2.7.7.7.1.m1.1.1.2.cmml">α</mi><mo id="S4.T2.7.7.7.1.m1.1.1.1" xref="S4.T2.7.7.7.1.m1.1.1.1.cmml">=</mo><mn id="S4.T2.7.7.7.1.m1.1.1.3" xref="S4.T2.7.7.7.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.1.m1.1b"><apply id="S4.T2.7.7.7.1.m1.1.1.cmml" xref="S4.T2.7.7.7.1.m1.1.1"><eq id="S4.T2.7.7.7.1.m1.1.1.1.cmml" xref="S4.T2.7.7.7.1.m1.1.1.1"></eq><ci id="S4.T2.7.7.7.1.m1.1.1.2.cmml" xref="S4.T2.7.7.7.1.m1.1.1.2">𝛼</ci><cn type="float" id="S4.T2.7.7.7.1.m1.1.1.3.cmml" xref="S4.T2.7.7.7.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.1.m1.1c">\alpha=0.05</annotation></semantics></math></td>
<td id="S4.T2.8.8.8.2" class="ltx_td ltx_align_center"><math id="S4.T2.8.8.8.2.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.T2.8.8.8.2.m1.1a"><mrow id="S4.T2.8.8.8.2.m1.1.1" xref="S4.T2.8.8.8.2.m1.1.1.cmml"><mi id="S4.T2.8.8.8.2.m1.1.1.2" xref="S4.T2.8.8.8.2.m1.1.1.2.cmml">α</mi><mo id="S4.T2.8.8.8.2.m1.1.1.1" xref="S4.T2.8.8.8.2.m1.1.1.1.cmml">=</mo><mn id="S4.T2.8.8.8.2.m1.1.1.3" xref="S4.T2.8.8.8.2.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.2.m1.1b"><apply id="S4.T2.8.8.8.2.m1.1.1.cmml" xref="S4.T2.8.8.8.2.m1.1.1"><eq id="S4.T2.8.8.8.2.m1.1.1.1.cmml" xref="S4.T2.8.8.8.2.m1.1.1.1"></eq><ci id="S4.T2.8.8.8.2.m1.1.1.2.cmml" xref="S4.T2.8.8.8.2.m1.1.1.2">𝛼</ci><cn type="float" id="S4.T2.8.8.8.2.m1.1.1.3.cmml" xref="S4.T2.8.8.8.2.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.2.m1.1c">\alpha=0.1</annotation></semantics></math></td>
<td id="S4.T2.9.9.9.3" class="ltx_td ltx_align_center"><math id="S4.T2.9.9.9.3.m1.1" class="ltx_Math" alttext="\alpha=0.3" display="inline"><semantics id="S4.T2.9.9.9.3.m1.1a"><mrow id="S4.T2.9.9.9.3.m1.1.1" xref="S4.T2.9.9.9.3.m1.1.1.cmml"><mi id="S4.T2.9.9.9.3.m1.1.1.2" xref="S4.T2.9.9.9.3.m1.1.1.2.cmml">α</mi><mo id="S4.T2.9.9.9.3.m1.1.1.1" xref="S4.T2.9.9.9.3.m1.1.1.1.cmml">=</mo><mn id="S4.T2.9.9.9.3.m1.1.1.3" xref="S4.T2.9.9.9.3.m1.1.1.3.cmml">0.3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.9.9.9.3.m1.1b"><apply id="S4.T2.9.9.9.3.m1.1.1.cmml" xref="S4.T2.9.9.9.3.m1.1.1"><eq id="S4.T2.9.9.9.3.m1.1.1.1.cmml" xref="S4.T2.9.9.9.3.m1.1.1.1"></eq><ci id="S4.T2.9.9.9.3.m1.1.1.2.cmml" xref="S4.T2.9.9.9.3.m1.1.1.2">𝛼</ci><cn type="float" id="S4.T2.9.9.9.3.m1.1.1.3.cmml" xref="S4.T2.9.9.9.3.m1.1.1.3">0.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.9.9.9.3.m1.1c">\alpha=0.3</annotation></semantics></math></td>
<td id="S4.T2.10.10.10.4" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.10.10.10.4.m1.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S4.T2.10.10.10.4.m1.1a"><mrow id="S4.T2.10.10.10.4.m1.1.1" xref="S4.T2.10.10.10.4.m1.1.1.cmml"><mi id="S4.T2.10.10.10.4.m1.1.1.2" xref="S4.T2.10.10.10.4.m1.1.1.2.cmml">α</mi><mo id="S4.T2.10.10.10.4.m1.1.1.1" xref="S4.T2.10.10.10.4.m1.1.1.1.cmml">=</mo><mn id="S4.T2.10.10.10.4.m1.1.1.3" xref="S4.T2.10.10.10.4.m1.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.10.10.10.4.m1.1b"><apply id="S4.T2.10.10.10.4.m1.1.1.cmml" xref="S4.T2.10.10.10.4.m1.1.1"><eq id="S4.T2.10.10.10.4.m1.1.1.1.cmml" xref="S4.T2.10.10.10.4.m1.1.1.1"></eq><ci id="S4.T2.10.10.10.4.m1.1.1.2.cmml" xref="S4.T2.10.10.10.4.m1.1.1.2">𝛼</ci><cn type="float" id="S4.T2.10.10.10.4.m1.1.1.3.cmml" xref="S4.T2.10.10.10.4.m1.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.10.10.4.m1.1c">\alpha=0.5</annotation></semantics></math></td>
<td id="S4.T2.11.11.11.5" class="ltx_td ltx_align_center ltx_border_r"><math id="S4.T2.11.11.11.5.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.T2.11.11.11.5.m1.1a"><mrow id="S4.T2.11.11.11.5.m1.1.1" xref="S4.T2.11.11.11.5.m1.1.1.cmml"><mi id="S4.T2.11.11.11.5.m1.1.1.2" xref="S4.T2.11.11.11.5.m1.1.1.2.cmml">α</mi><mo id="S4.T2.11.11.11.5.m1.1.1.1" xref="S4.T2.11.11.11.5.m1.1.1.1.cmml">=</mo><mn id="S4.T2.11.11.11.5.m1.1.1.3" xref="S4.T2.11.11.11.5.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.11.11.11.5.m1.1b"><apply id="S4.T2.11.11.11.5.m1.1.1.cmml" xref="S4.T2.11.11.11.5.m1.1.1"><eq id="S4.T2.11.11.11.5.m1.1.1.1.cmml" xref="S4.T2.11.11.11.5.m1.1.1.1"></eq><ci id="S4.T2.11.11.11.5.m1.1.1.2.cmml" xref="S4.T2.11.11.11.5.m1.1.1.2">𝛼</ci><cn type="float" id="S4.T2.11.11.11.5.m1.1.1.3.cmml" xref="S4.T2.11.11.11.5.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.11.11.11.5.m1.1c">\alpha=0.1</annotation></semantics></math></td>
<td id="S4.T2.12.12.12.6" class="ltx_td ltx_align_center"><math id="S4.T2.12.12.12.6.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S4.T2.12.12.12.6.m1.1a"><mrow id="S4.T2.12.12.12.6.m1.1.1" xref="S4.T2.12.12.12.6.m1.1.1.cmml"><mi id="S4.T2.12.12.12.6.m1.1.1.2" xref="S4.T2.12.12.12.6.m1.1.1.2.cmml">α</mi><mo id="S4.T2.12.12.12.6.m1.1.1.1" xref="S4.T2.12.12.12.6.m1.1.1.1.cmml">=</mo><mn id="S4.T2.12.12.12.6.m1.1.1.3" xref="S4.T2.12.12.12.6.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.12.12.12.6.m1.1b"><apply id="S4.T2.12.12.12.6.m1.1.1.cmml" xref="S4.T2.12.12.12.6.m1.1.1"><eq id="S4.T2.12.12.12.6.m1.1.1.1.cmml" xref="S4.T2.12.12.12.6.m1.1.1.1"></eq><ci id="S4.T2.12.12.12.6.m1.1.1.2.cmml" xref="S4.T2.12.12.12.6.m1.1.1.2">𝛼</ci><cn type="float" id="S4.T2.12.12.12.6.m1.1.1.3.cmml" xref="S4.T2.12.12.12.6.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.12.12.12.6.m1.1c">\alpha=0.1</annotation></semantics></math></td>
</tr>
<tr id="S4.T2.12.12.22.9" class="ltx_tr">
<th id="S4.T2.12.12.22.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">FedAvg</th>
<th id="S4.T2.12.12.22.9.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">✓</th>
<td id="S4.T2.12.12.22.9.3" class="ltx_td ltx_align_center ltx_border_t">20.1</td>
<td id="S4.T2.12.12.22.9.4" class="ltx_td ltx_align_center ltx_border_t">32.4</td>
<td id="S4.T2.12.12.22.9.5" class="ltx_td ltx_align_center ltx_border_t">41.9</td>
<td id="S4.T2.12.12.22.9.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">45.1</td>
<td id="S4.T2.12.12.22.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">16.4</td>
<td id="S4.T2.12.12.22.9.8" class="ltx_td ltx_align_center ltx_border_t">29.1</td>
</tr>
<tr id="S4.T2.12.12.23.10" class="ltx_tr">
<th id="S4.T2.12.12.23.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedNTD</th>
<th id="S4.T2.12.12.23.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">✓</th>
<td id="S4.T2.12.12.23.10.3" class="ltx_td ltx_align_center">26.6</td>
<td id="S4.T2.12.12.23.10.4" class="ltx_td ltx_align_center">28.2</td>
<td id="S4.T2.12.12.23.10.5" class="ltx_td ltx_align_center">37.1</td>
<td id="S4.T2.12.12.23.10.6" class="ltx_td ltx_align_center ltx_border_r">52.9</td>
<td id="S4.T2.12.12.23.10.7" class="ltx_td ltx_align_center ltx_border_r">15.9</td>
<td id="S4.T2.12.12.23.10.8" class="ltx_td ltx_align_center">26.6</td>
</tr>
<tr id="S4.T2.12.12.24.11" class="ltx_tr">
<th id="S4.T2.12.12.24.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t">FST-CBDG (ours)</th>
<th id="S4.T2.12.12.24.11.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t">✗</th>
<td id="S4.T2.12.12.24.11.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">71.5</td>
<td id="S4.T2.12.12.24.11.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">71.9</td>
<td id="S4.T2.12.12.24.11.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">72.2</td>
<td id="S4.T2.12.12.24.11.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">72.4</td>
<td id="S4.T2.12.12.24.11.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t">43.1</td>
<td id="S4.T2.12.12.24.11.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">65.0</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S4.SS2.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.3 </span>Computation and Communication Efficiency</h4>

<div id="S4.SS2.SSS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS3.p1.1" class="ltx_p">Figure <a href="#S4.F3" title="Figure 3 ‣ 4.2.3 Computation and Communication Efficiency ‣ 4.2 Comparison Results ‣ 4 Experiments ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> displays the testing accuracy curves concerning the communication rounds for all three datasets. FST-CBDG exhibits rapid convergence in both homogeneous and heterogeneous data distribution settings. The curves begin at the accuracy level of the CLIP zero-shot prediction, and while the two comparison methods fail to maintain this initial accuracy, FST-CBDG consistently improves accuracy and achieves near-optimal performance within a few communication rounds: CIFAR-10 (1 round), CIFAR-100 (6 rounds), and CINIC-10 (1 round). This indicates that the proposed method greatly reduces the computation and communication requirements for the client devices.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2404.11046/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="422" height="84" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Curves of the testing accuracy (%) w.r.t. communication rounds for the proposed method FST-CBDG and the two comparison methods, FedAv and FedNTD under homogeneous (i.i.d.) and heterogeneous (sharding) data distribution.</figcaption>
</figure>
</section>
<section id="S4.SS2.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.4 </span>Ablation Study</h4>

<figure id="S4.T3" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Ablation study to evaluate each component. Test accuracy (%) on each dataset under i.i.d. and non-i.i.d. (Sharding) data distribution.</figcaption>
<div id="S4.T3.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:198.7pt;height:104.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-20.7pt,10.9pt) scale(0.82746714695484,0.82746714695484) ;">
<table id="S4.T3.6.6" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.6.6.7.1" class="ltx_tr">
<th id="S4.T3.6.6.7.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt" rowspan="2"><span id="S4.T3.6.6.7.1.1.1" class="ltx_text">Method</span></th>
<th id="S4.T3.6.6.7.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">CIFAR-10</th>
<th id="S4.T3.6.6.7.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">CIFAR-100</th>
</tr>
<tr id="S4.T3.2.2.2" class="ltx_tr">
<th id="S4.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="S4.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="s=2" display="inline"><semantics id="S4.T3.1.1.1.1.m1.1a"><mrow id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml"><mi id="S4.T3.1.1.1.1.m1.1.1.2" xref="S4.T3.1.1.1.1.m1.1.1.2.cmml">s</mi><mo id="S4.T3.1.1.1.1.m1.1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.T3.1.1.1.1.m1.1.1.3" xref="S4.T3.1.1.1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><apply id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1"><eq id="S4.T3.1.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1.1"></eq><ci id="S4.T3.1.1.1.1.m1.1.1.2.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2">𝑠</ci><cn type="integer" id="S4.T3.1.1.1.1.m1.1.1.3.cmml" xref="S4.T3.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">s=2</annotation></semantics></math></th>
<th id="S4.T3.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">i.i.d.</th>
<th id="S4.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><math id="S4.T3.2.2.2.2.m1.1" class="ltx_Math" alttext="s=10" display="inline"><semantics id="S4.T3.2.2.2.2.m1.1a"><mrow id="S4.T3.2.2.2.2.m1.1.1" xref="S4.T3.2.2.2.2.m1.1.1.cmml"><mi id="S4.T3.2.2.2.2.m1.1.1.2" xref="S4.T3.2.2.2.2.m1.1.1.2.cmml">s</mi><mo id="S4.T3.2.2.2.2.m1.1.1.1" xref="S4.T3.2.2.2.2.m1.1.1.1.cmml">=</mo><mn id="S4.T3.2.2.2.2.m1.1.1.3" xref="S4.T3.2.2.2.2.m1.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.m1.1b"><apply id="S4.T3.2.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1"><eq id="S4.T3.2.2.2.2.m1.1.1.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1.1"></eq><ci id="S4.T3.2.2.2.2.m1.1.1.2.cmml" xref="S4.T3.2.2.2.2.m1.1.1.2">𝑠</ci><cn type="integer" id="S4.T3.2.2.2.2.m1.1.1.3.cmml" xref="S4.T3.2.2.2.2.m1.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.m1.1c">s=10</annotation></semantics></math></th>
<th id="S4.T3.2.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column">i.i.d.</th>
</tr>
<tr id="S4.T3.6.6.8.2" class="ltx_tr">
<th id="S4.T3.6.6.8.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t">CLIP-ZS</th>
<th id="S4.T3.6.6.8.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2">68.7</th>
<th id="S4.T3.6.6.8.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2">39.0</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.3.3.3" class="ltx_tr">
<th id="S4.T3.3.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><math id="S4.T3.3.3.3.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{iST}" display="inline"><semantics id="S4.T3.3.3.3.1.m1.1a"><msub id="S4.T3.3.3.3.1.m1.1.1" xref="S4.T3.3.3.3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.3.3.3.1.m1.1.1.2" xref="S4.T3.3.3.3.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.T3.3.3.3.1.m1.1.1.3" xref="S4.T3.3.3.3.1.m1.1.1.3.cmml"><mi id="S4.T3.3.3.3.1.m1.1.1.3.2" xref="S4.T3.3.3.3.1.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T3.3.3.3.1.m1.1.1.3.1" xref="S4.T3.3.3.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.3.3.3.1.m1.1.1.3.3" xref="S4.T3.3.3.3.1.m1.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.T3.3.3.3.1.m1.1.1.3.1a" xref="S4.T3.3.3.3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.3.3.3.1.m1.1.1.3.4" xref="S4.T3.3.3.3.1.m1.1.1.3.4.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.1.m1.1b"><apply id="S4.T3.3.3.3.1.m1.1.1.cmml" xref="S4.T3.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.3.3.3.1.m1.1.1.1.cmml" xref="S4.T3.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S4.T3.3.3.3.1.m1.1.1.2.cmml" xref="S4.T3.3.3.3.1.m1.1.1.2">ℒ</ci><apply id="S4.T3.3.3.3.1.m1.1.1.3.cmml" xref="S4.T3.3.3.3.1.m1.1.1.3"><times id="S4.T3.3.3.3.1.m1.1.1.3.1.cmml" xref="S4.T3.3.3.3.1.m1.1.1.3.1"></times><ci id="S4.T3.3.3.3.1.m1.1.1.3.2.cmml" xref="S4.T3.3.3.3.1.m1.1.1.3.2">𝑖</ci><ci id="S4.T3.3.3.3.1.m1.1.1.3.3.cmml" xref="S4.T3.3.3.3.1.m1.1.1.3.3">𝑆</ci><ci id="S4.T3.3.3.3.1.m1.1.1.3.4.cmml" xref="S4.T3.3.3.3.1.m1.1.1.3.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.1.m1.1c">\mathcal{L}_{iST}</annotation></semantics></math></th>
<td id="S4.T3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_t">68.9</td>
<td id="S4.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">68.2</td>
<td id="S4.T3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_t">37.5</td>
<td id="S4.T3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t">37.5</td>
</tr>
<tr id="S4.T3.4.4.4" class="ltx_tr">
<th id="S4.T3.4.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><math id="S4.T3.4.4.4.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{tSamp}" display="inline"><semantics id="S4.T3.4.4.4.1.m1.1a"><msub id="S4.T3.4.4.4.1.m1.1.1" xref="S4.T3.4.4.4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.4.4.4.1.m1.1.1.2" xref="S4.T3.4.4.4.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.T3.4.4.4.1.m1.1.1.3" xref="S4.T3.4.4.4.1.m1.1.1.3.cmml"><mi id="S4.T3.4.4.4.1.m1.1.1.3.2" xref="S4.T3.4.4.4.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T3.4.4.4.1.m1.1.1.3.1" xref="S4.T3.4.4.4.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.4.4.4.1.m1.1.1.3.3" xref="S4.T3.4.4.4.1.m1.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.T3.4.4.4.1.m1.1.1.3.1a" xref="S4.T3.4.4.4.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.4.4.4.1.m1.1.1.3.4" xref="S4.T3.4.4.4.1.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T3.4.4.4.1.m1.1.1.3.1b" xref="S4.T3.4.4.4.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.4.4.4.1.m1.1.1.3.5" xref="S4.T3.4.4.4.1.m1.1.1.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.T3.4.4.4.1.m1.1.1.3.1c" xref="S4.T3.4.4.4.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.4.4.4.1.m1.1.1.3.6" xref="S4.T3.4.4.4.1.m1.1.1.3.6.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.1.m1.1b"><apply id="S4.T3.4.4.4.1.m1.1.1.cmml" xref="S4.T3.4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.4.4.4.1.m1.1.1.1.cmml" xref="S4.T3.4.4.4.1.m1.1.1">subscript</csymbol><ci id="S4.T3.4.4.4.1.m1.1.1.2.cmml" xref="S4.T3.4.4.4.1.m1.1.1.2">ℒ</ci><apply id="S4.T3.4.4.4.1.m1.1.1.3.cmml" xref="S4.T3.4.4.4.1.m1.1.1.3"><times id="S4.T3.4.4.4.1.m1.1.1.3.1.cmml" xref="S4.T3.4.4.4.1.m1.1.1.3.1"></times><ci id="S4.T3.4.4.4.1.m1.1.1.3.2.cmml" xref="S4.T3.4.4.4.1.m1.1.1.3.2">𝑡</ci><ci id="S4.T3.4.4.4.1.m1.1.1.3.3.cmml" xref="S4.T3.4.4.4.1.m1.1.1.3.3">𝑆</ci><ci id="S4.T3.4.4.4.1.m1.1.1.3.4.cmml" xref="S4.T3.4.4.4.1.m1.1.1.3.4">𝑎</ci><ci id="S4.T3.4.4.4.1.m1.1.1.3.5.cmml" xref="S4.T3.4.4.4.1.m1.1.1.3.5">𝑚</ci><ci id="S4.T3.4.4.4.1.m1.1.1.3.6.cmml" xref="S4.T3.4.4.4.1.m1.1.1.3.6">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.1.m1.1c">\mathcal{L}_{tSamp}</annotation></semantics></math></th>
<td id="S4.T3.4.4.4.2" class="ltx_td ltx_align_center">68.9</td>
<td id="S4.T3.4.4.4.3" class="ltx_td ltx_align_center ltx_border_r">65.7</td>
<td id="S4.T3.4.4.4.4" class="ltx_td ltx_align_center">37.3</td>
<td id="S4.T3.4.4.4.5" class="ltx_td ltx_align_center">35.5</td>
</tr>
<tr id="S4.T3.5.5.5" class="ltx_tr">
<th id="S4.T3.5.5.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">
<math id="S4.T3.5.5.5.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{tSamp}" display="inline"><semantics id="S4.T3.5.5.5.1.m1.1a"><msub id="S4.T3.5.5.5.1.m1.1.1" xref="S4.T3.5.5.5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.5.5.5.1.m1.1.1.2" xref="S4.T3.5.5.5.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.T3.5.5.5.1.m1.1.1.3" xref="S4.T3.5.5.5.1.m1.1.1.3.cmml"><mi id="S4.T3.5.5.5.1.m1.1.1.3.2" xref="S4.T3.5.5.5.1.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T3.5.5.5.1.m1.1.1.3.1" xref="S4.T3.5.5.5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.5.5.5.1.m1.1.1.3.3" xref="S4.T3.5.5.5.1.m1.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.T3.5.5.5.1.m1.1.1.3.1a" xref="S4.T3.5.5.5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.5.5.5.1.m1.1.1.3.4" xref="S4.T3.5.5.5.1.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T3.5.5.5.1.m1.1.1.3.1b" xref="S4.T3.5.5.5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.5.5.5.1.m1.1.1.3.5" xref="S4.T3.5.5.5.1.m1.1.1.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.T3.5.5.5.1.m1.1.1.3.1c" xref="S4.T3.5.5.5.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.T3.5.5.5.1.m1.1.1.3.6" xref="S4.T3.5.5.5.1.m1.1.1.3.6.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.1.m1.1b"><apply id="S4.T3.5.5.5.1.m1.1.1.cmml" xref="S4.T3.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.5.5.5.1.m1.1.1.1.cmml" xref="S4.T3.5.5.5.1.m1.1.1">subscript</csymbol><ci id="S4.T3.5.5.5.1.m1.1.1.2.cmml" xref="S4.T3.5.5.5.1.m1.1.1.2">ℒ</ci><apply id="S4.T3.5.5.5.1.m1.1.1.3.cmml" xref="S4.T3.5.5.5.1.m1.1.1.3"><times id="S4.T3.5.5.5.1.m1.1.1.3.1.cmml" xref="S4.T3.5.5.5.1.m1.1.1.3.1"></times><ci id="S4.T3.5.5.5.1.m1.1.1.3.2.cmml" xref="S4.T3.5.5.5.1.m1.1.1.3.2">𝑡</ci><ci id="S4.T3.5.5.5.1.m1.1.1.3.3.cmml" xref="S4.T3.5.5.5.1.m1.1.1.3.3">𝑆</ci><ci id="S4.T3.5.5.5.1.m1.1.1.3.4.cmml" xref="S4.T3.5.5.5.1.m1.1.1.3.4">𝑎</ci><ci id="S4.T3.5.5.5.1.m1.1.1.3.5.cmml" xref="S4.T3.5.5.5.1.m1.1.1.3.5">𝑚</ci><ci id="S4.T3.5.5.5.1.m1.1.1.3.6.cmml" xref="S4.T3.5.5.5.1.m1.1.1.3.6">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.5.1.m1.1c">\mathcal{L}_{tSamp}</annotation></semantics></math> (Centralized)</th>
<td id="S4.T3.5.5.5.2" class="ltx_td ltx_align_center">69.4</td>
<td id="S4.T3.5.5.5.3" class="ltx_td ltx_align_center ltx_border_r">69.4</td>
<td id="S4.T3.5.5.5.4" class="ltx_td ltx_align_center">39.1</td>
<td id="S4.T3.5.5.5.5" class="ltx_td ltx_align_center">39.1</td>
</tr>
<tr id="S4.T3.6.6.6" class="ltx_tr">
<th id="S4.T3.6.6.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r"><math id="S4.T3.6.6.6.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{iST}+\mathcal{L}_{tSamp}" display="inline"><semantics id="S4.T3.6.6.6.1.m1.1a"><mrow id="S4.T3.6.6.6.1.m1.1.1" xref="S4.T3.6.6.6.1.m1.1.1.cmml"><msub id="S4.T3.6.6.6.1.m1.1.1.2" xref="S4.T3.6.6.6.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.6.6.6.1.m1.1.1.2.2" xref="S4.T3.6.6.6.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S4.T3.6.6.6.1.m1.1.1.2.3" xref="S4.T3.6.6.6.1.m1.1.1.2.3.cmml"><mi id="S4.T3.6.6.6.1.m1.1.1.2.3.2" xref="S4.T3.6.6.6.1.m1.1.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.T3.6.6.6.1.m1.1.1.2.3.1" xref="S4.T3.6.6.6.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T3.6.6.6.1.m1.1.1.2.3.3" xref="S4.T3.6.6.6.1.m1.1.1.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.T3.6.6.6.1.m1.1.1.2.3.1a" xref="S4.T3.6.6.6.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S4.T3.6.6.6.1.m1.1.1.2.3.4" xref="S4.T3.6.6.6.1.m1.1.1.2.3.4.cmml">T</mi></mrow></msub><mo id="S4.T3.6.6.6.1.m1.1.1.1" xref="S4.T3.6.6.6.1.m1.1.1.1.cmml">+</mo><msub id="S4.T3.6.6.6.1.m1.1.1.3" xref="S4.T3.6.6.6.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.6.6.6.1.m1.1.1.3.2" xref="S4.T3.6.6.6.1.m1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.T3.6.6.6.1.m1.1.1.3.3" xref="S4.T3.6.6.6.1.m1.1.1.3.3.cmml"><mi id="S4.T3.6.6.6.1.m1.1.1.3.3.2" xref="S4.T3.6.6.6.1.m1.1.1.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.T3.6.6.6.1.m1.1.1.3.3.1" xref="S4.T3.6.6.6.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T3.6.6.6.1.m1.1.1.3.3.3" xref="S4.T3.6.6.6.1.m1.1.1.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.T3.6.6.6.1.m1.1.1.3.3.1a" xref="S4.T3.6.6.6.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T3.6.6.6.1.m1.1.1.3.3.4" xref="S4.T3.6.6.6.1.m1.1.1.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.T3.6.6.6.1.m1.1.1.3.3.1b" xref="S4.T3.6.6.6.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T3.6.6.6.1.m1.1.1.3.3.5" xref="S4.T3.6.6.6.1.m1.1.1.3.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.T3.6.6.6.1.m1.1.1.3.3.1c" xref="S4.T3.6.6.6.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.T3.6.6.6.1.m1.1.1.3.3.6" xref="S4.T3.6.6.6.1.m1.1.1.3.3.6.cmml">p</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.6.1.m1.1b"><apply id="S4.T3.6.6.6.1.m1.1.1.cmml" xref="S4.T3.6.6.6.1.m1.1.1"><plus id="S4.T3.6.6.6.1.m1.1.1.1.cmml" xref="S4.T3.6.6.6.1.m1.1.1.1"></plus><apply id="S4.T3.6.6.6.1.m1.1.1.2.cmml" xref="S4.T3.6.6.6.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.T3.6.6.6.1.m1.1.1.2.1.cmml" xref="S4.T3.6.6.6.1.m1.1.1.2">subscript</csymbol><ci id="S4.T3.6.6.6.1.m1.1.1.2.2.cmml" xref="S4.T3.6.6.6.1.m1.1.1.2.2">ℒ</ci><apply id="S4.T3.6.6.6.1.m1.1.1.2.3.cmml" xref="S4.T3.6.6.6.1.m1.1.1.2.3"><times id="S4.T3.6.6.6.1.m1.1.1.2.3.1.cmml" xref="S4.T3.6.6.6.1.m1.1.1.2.3.1"></times><ci id="S4.T3.6.6.6.1.m1.1.1.2.3.2.cmml" xref="S4.T3.6.6.6.1.m1.1.1.2.3.2">𝑖</ci><ci id="S4.T3.6.6.6.1.m1.1.1.2.3.3.cmml" xref="S4.T3.6.6.6.1.m1.1.1.2.3.3">𝑆</ci><ci id="S4.T3.6.6.6.1.m1.1.1.2.3.4.cmml" xref="S4.T3.6.6.6.1.m1.1.1.2.3.4">𝑇</ci></apply></apply><apply id="S4.T3.6.6.6.1.m1.1.1.3.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.T3.6.6.6.1.m1.1.1.3.1.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3">subscript</csymbol><ci id="S4.T3.6.6.6.1.m1.1.1.3.2.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3.2">ℒ</ci><apply id="S4.T3.6.6.6.1.m1.1.1.3.3.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3.3"><times id="S4.T3.6.6.6.1.m1.1.1.3.3.1.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3.3.1"></times><ci id="S4.T3.6.6.6.1.m1.1.1.3.3.2.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3.3.2">𝑡</ci><ci id="S4.T3.6.6.6.1.m1.1.1.3.3.3.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3.3.3">𝑆</ci><ci id="S4.T3.6.6.6.1.m1.1.1.3.3.4.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3.3.4">𝑎</ci><ci id="S4.T3.6.6.6.1.m1.1.1.3.3.5.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3.3.5">𝑚</ci><ci id="S4.T3.6.6.6.1.m1.1.1.3.3.6.cmml" xref="S4.T3.6.6.6.1.m1.1.1.3.3.6">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.6.1.m1.1c">\mathcal{L}_{iST}+\mathcal{L}_{tSamp}</annotation></semantics></math></th>
<td id="S4.T3.6.6.6.2" class="ltx_td ltx_align_center ltx_border_bb">72.0</td>
<td id="S4.T3.6.6.6.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">74.0</td>
<td id="S4.T3.6.6.6.4" class="ltx_td ltx_align_center ltx_border_bb">43.3</td>
<td id="S4.T3.6.6.6.5" class="ltx_td ltx_align_center ltx_border_bb">43.2</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS2.SSS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS4.p1.1" class="ltx_p"><span id="S4.SS2.SSS4.p1.1.1" class="ltx_text ltx_font_bold">Components.</span> In our ablation study, we examined the effects of the self-training loss and synthetic instance sampling loss in our proposed method. The results, as presented in Table <a href="#S4.T3" title="Table 3 ‣ 4.2.4 Ablation Study ‣ 4.2 Comparison Results ‣ 4 Experiments ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, reveal that using either the self-training loss or text sampling loss alone does not lead to performance improvements over the CLIP-ZS baseline. We also conducted an experiment to assess centralized training using the text sampling loss, but it also failed to produce improvements. However, when both losses are combined, the results demonstrate significant improvements over the baseline, underscoring the necessity of both components for our approach.</p>
</div>
<figure id="S4.T4" class="ltx_table ltx_align_floatright">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Ablation study to evaluate sampling strategy. Test accuracy (%) on each dataset under i.i.d. and non-i.i.d. (Sharding) data distribution.</figcaption>
<div id="S4.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:198.7pt;height:61.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-16.2pt,5.0pt) scale(0.859838611772092,0.859838611772092) ;">
<table id="S4.T4.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T4.1.1.1.1" class="ltx_tr">
<th id="S4.T4.1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" rowspan="2"><span id="S4.T4.1.1.1.1.1.1" class="ltx_text">Sampling strategy</span></th>
<th id="S4.T4.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2">CIFAR-10</th>
<th id="S4.T4.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2">CIFAR-100</th>
</tr>
<tr id="S4.T4.1.1.2.2" class="ltx_tr">
<td id="S4.T4.1.1.2.2.1" class="ltx_td ltx_align_center">s=10</td>
<td id="S4.T4.1.1.2.2.2" class="ltx_td ltx_align_center">i.i.d.</td>
<td id="S4.T4.1.1.2.2.3" class="ltx_td ltx_align_center">s=10</td>
<td id="S4.T4.1.1.2.2.4" class="ltx_td ltx_align_center">i.i.d.</td>
</tr>
<tr id="S4.T4.1.1.3.3" class="ltx_tr">
<th id="S4.T4.1.1.3.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">Equal sampling</th>
<th id="S4.T4.1.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">68.6</th>
<th id="S4.T4.1.1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">68.6</th>
<th id="S4.T4.1.1.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">37.4</th>
<th id="S4.T4.1.1.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t">37.4</th>
</tr>
<tr id="S4.T4.1.1.4.4" class="ltx_tr">
<td id="S4.T4.1.1.4.4.1" class="ltx_td ltx_align_center ltx_border_b">Balanced sampling</td>
<td id="S4.T4.1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_b">73.2</td>
<td id="S4.T4.1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_b">74.0</td>
<td id="S4.T4.1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_b">43.3</td>
<td id="S4.T4.1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_b">43.2</td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S4.SS2.SSS4.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.SSS4.p2.1" class="ltx_p"><span id="S4.SS2.SSS4.p2.1.1" class="ltx_text ltx_font_bold">Sampling strategy.</span> We conducted experiments to assess the effectiveness of our proposed class-balanced sampling strategy, as outlined in Equation <a href="#S3.E7" title="In 3.3 Class-Balanced Data Generation ‣ 3 Proposed Method ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, by comparing it to another sampling strategy, equal sampling. The equal sampling strategy involves sampling the same number of synthetic instances for each class, irrespective of the number of images per class in the local client.
The results, presented in Table <a href="#S4.T4" title="Table 4 ‣ 4.2.4 Ablation Study ‣ 4.2 Comparison Results ‣ 4 Experiments ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, demonstrate the superiority of our proposed class-balanced sampling strategy over the equal sampling approach. Our class-balanced sampling strategy consistently outperforms equal sampling by a significant margin across all datasets, regardless of whether the data distribution is homogeneous or heterogeneous. This highlights the effectiveness of our carefully designed sampling strategy in improving model performance.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p">In this paper, we proposed a novel lightweight unsupervised federated learning approach, FST-CBDG,
to alleviate the computational and communication costs, as well as the high data annotation requirements
typically associated with standard federated learning for deep models.
By capitalizing on the petrained visual-language model CLIP, the proposed method devises
an efficient and resilient self-training approach to progressively refine the initial pseudo-labels
produced by CLIP and learn a linear classifier
on top of the fixed CLIP image encoder.
Additionally, we propose a class-balanced synthetic instance generation method
based on the class prototypes produced by the CLIP text encoder
to address data heterogeneity within each client.
The experimental results on multiple datasets demonstrate that
the proposed method greatly improves model performance in comparison to CLIP’s zero-shot predictions
and outperforms supervised federated learning benchmark methods given limited computational and communication overhead.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2023)</span>
<span class="ltx_bibblock">
Zhongzhi Chen, Guang Liu, Bo-Wen Zhang, Qinghong Yang, and Ledell Wu.

</span>
<span class="ltx_bibblock">AltCLIP: Altering the language encoder in CLIP for extended
language capabilities.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Findings of the Association for Computational Linguistics:
ACL 2023</em>, 2023.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chia et al. (2022)</span>
<span class="ltx_bibblock">
Patrick John Chia, Giuseppe Attanasio, Federico Bianchi, Silvia Terragni,
Ana Rita Magalhães, Diogo Goncalves, Ciro Greco, and Jacopo Tagliabue.

</span>
<span class="ltx_bibblock">Contrastive language and vision learning of general fashion concepts.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Scientific Reports</em>, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Darlow et al. (2018)</span>
<span class="ltx_bibblock">
Luke N Darlow, Elliot J Crowley, Antreas Antoniou, and Amos J Storkey.

</span>
<span class="ltx_bibblock">Cinic-10 is not imagenet or cifar-10.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1810.03505</em>, 2018.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Diao et al. (2022)</span>
<span class="ltx_bibblock">
Enmao Diao, Jie Ding, and Vahid Tarokh.

</span>
<span class="ltx_bibblock">Semifl: Semi-supervised federated learning for unlabeled clients with
alternate training.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dunlap et al. (2023)</span>
<span class="ltx_bibblock">
Lisa Dunlap, Clara Mohri, Devin Guillory, Han Zhang, Trevor Darrell, Joseph E
Gonzalez, Aditi Raghunathan, and Anna Rohrbach.

</span>
<span class="ltx_bibblock">Using language to extend to unseen domains.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2023.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Elgabli et al. (2022)</span>
<span class="ltx_bibblock">
Anis Elgabli, Chaouki Ben Issaid, Amrit Singh Bedi, Ketan Rajawat, Mehdi
Bennis, and Vaneet Aggarwal.

</span>
<span class="ltx_bibblock">Fednew: A communication-efficient and privacy-preserving newton-type
method for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2022)</span>
<span class="ltx_bibblock">
Xiuye Gu, Tsung-Yi Lin, Weicheng Kuo, and Yin Cui.

</span>
<span class="ltx_bibblock">Open-vocabulary object detection via vision and language knowledge
distillation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2023a)</span>
<span class="ltx_bibblock">
Tao Guo, Song Guo, and Junxiao Wang.

</span>
<span class="ltx_bibblock">pfedprompt: Learning personalized prompt for vision-language models
in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the ACM Web Conference 2023</em>,
2023a.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2023b)</span>
<span class="ltx_bibblock">
Yongxin Guo, Xiaoying Tang, and Tao Lin.

</span>
<span class="ltx_bibblock">Fedbr: Improving federated learning on heterogeneous data via local
learning bias reduction.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2023b.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. (2019)</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for
federated visual classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.06335</em>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. (2023)</span>
<span class="ltx_bibblock">
Zhi Huang, Federico Bianchi, Mert Yuksekgonul, Thomas J Montine, and James Zou.

</span>
<span class="ltx_bibblock">A visual–language foundation model for pathology image analysis
using medical twitter.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Nature Medicine</em>, 2023.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong et al. (2021)</span>
<span class="ltx_bibblock">
Wonyong Jeong, Jaehong Yoon, Eunho Yang, and Sung Ju Hwang.

</span>
<span class="ltx_bibblock">Federated semi-supervised learning with inter-client consistency &amp;
disjoint learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jia et al. (2021)</span>
<span class="ltx_bibblock">
Chao Jia, Yinfei Yang, Ye Xia, Yi-Ting Chen, Zarana Parekh, Hieu Pham, Quoc Le,
Yun-Hsuan Sung, Zhen Li, and Tom Duerig.

</span>
<span class="ltx_bibblock">Scaling up visual and vision-language representation learning with
noisy text supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2021.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2022)</span>
<span class="ltx_bibblock">
Jinkyu Kim, Geeho Kim, and Bohyung Han.

</span>
<span class="ltx_bibblock">Multi-level branched regularization for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2009)</span>
<span class="ltx_bibblock">
Alex Krizhevsky, Geoffrey Hinton, et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2022)</span>
<span class="ltx_bibblock">
Gihun Lee, Minchan Jeong, Yongjin Shin, Sangmin Bae, and Se-Young Yun.

</span>
<span class="ltx_bibblock">Preservation of the global knowledge by not-true distillation in
federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2022)</span>
<span class="ltx_bibblock">
Junnan Li, Dongxu Li, Caiming Xiong, and Steven Hoi.

</span>
<span class="ltx_bibblock">Blip: Bootstrapping language-image pre-training for unified
vision-language understanding and generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2022.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021)</span>
<span class="ltx_bibblock">
Qinbin Li, Bingsheng He, and Dawn Song.

</span>
<span class="ltx_bibblock">Model-contrastive federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2021.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">MLSys</em>, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2022)</span>
<span class="ltx_bibblock">
Xinyang Lin, Hanting Chen, Yixing Xu, Chao Xu, Xiaolin Gui, Yiping Deng, and
Yunhe Wang.

</span>
<span class="ltx_bibblock">Federated learning with positive and unlabeled data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2022)</span>
<span class="ltx_bibblock">
Nan Lu, Zhao Wang, Xiaoxiao Li, Gang Niu, Qi Dou, and Masashi Sugiyama.

</span>
<span class="ltx_bibblock">Federated learning from only unlabeled data with
class-conditional-sharing clients.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2022.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lüddecke &amp; Ecker (2022)</span>
<span class="ltx_bibblock">
Timo Lüddecke and Alexander Ecker.

</span>
<span class="ltx_bibblock">Image segmentation using text and image prompts.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. (2021)</span>
<span class="ltx_bibblock">
Mi Luo, Fei Chen, Dapeng Hu, Yifan Zhang, Jian Liang, and Jiashi Feng.

</span>
<span class="ltx_bibblock">No fear of heterogeneity: Classifier calibration for federated
learning with non-iid data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">AISTATS</em>, 2017.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Menon &amp; Vondrick (2023)</span>
<span class="ltx_bibblock">
Sachit Menon and Carl Vondrick.

</span>
<span class="ltx_bibblock">Visual classification via description from large language models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2023.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2021)</span>
<span class="ltx_bibblock">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.

</span>
<span class="ltx_bibblock">Learning transferable visual models from natural language
supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2021)</span>
<span class="ltx_bibblock">
Sashank Reddi, Zachary Charles, Manzil Zaheer, Zachary Garrett, Keith Rush,
Jakub Konečnỳ, Sanjiv Kumar, and H Brendan McMahan.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singh et al. (2022)</span>
<span class="ltx_bibblock">
Amanpreet Singh, Ronghang Hu, Vedanuj Goswami, Guillaume Couairon, Wojciech
Galuba, Marcus Rohrbach, and Douwe Kiela.

</span>
<span class="ltx_bibblock">Flava: A foundational language and vision alignment model.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2022.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. (2023)</span>
<span class="ltx_bibblock">
Yan Sun, Li Shen, Shixiang Chen, Liang Ding, and Dacheng Tao.

</span>
<span class="ltx_bibblock">Dynamic regularized sharpness aware minimization in federated
learning: Approaching global consistency and smooth landscape.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2023.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tan et al. (2022)</span>
<span class="ltx_bibblock">
Yue Tan, Guodong Long, Jie Ma, Lu Liu, Tianyi Zhou, and Jing Jiang.

</span>
<span class="ltx_bibblock">Federated learning from pre-trained models: A contrastive learning
approach.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2022.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2017.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Jianyu Wang, Qinghua Liu, Hao Liang, Gauri Joshi, and H Vincent Poor.

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in heterogeneous
federated optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2022)</span>
<span class="ltx_bibblock">
Zirui Wang, Jiahui Yu, Adams Wei Yu, Zihang Dai, Yulia Tsvetkov, and Yuan Cao.

</span>
<span class="ltx_bibblock">Simvlm: Simple visual language model pretraining with weak
supervision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2022.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2023)</span>
<span class="ltx_bibblock">
Rui Ye, Mingkai Xu, Jianyu Wang, Chenxin Xu, Siheng Chen, and Yanfeng Wang.

</span>
<span class="ltx_bibblock">Feddisco: Federated learning with discrepancy-aware collaboration.

</span>
<span class="ltx_bibblock">In <em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">ICML</em>, 2023.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2021)</span>
<span class="ltx_bibblock">
Zhengming Zhang, Yaoqing Yang, Zhewei Yao, Yujun Yan, Joseph E Gonzalez, Kannan
Ramchandran, and Michael W Mahoney.

</span>
<span class="ltx_bibblock">Improving semi-supervised federated learning by reducing the gradient
diversity of models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">2021 IEEE International Conference on Big Data (Big Data)</em>,
2021.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Algorithm</h2>

<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.29" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.3.3" class="ltx_listingline">


<span id="algorithm1.3.3.1" class="ltx_text ltx_font_bold">Input :</span> Number of classes <math id="algorithm1.1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algorithm1.1.1.m1.1a"><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">K</annotation></semantics></math>, total number of communication rounds <math id="algorithm1.2.2.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="algorithm1.2.2.m2.1a"><mi id="algorithm1.2.2.m2.1.1" xref="algorithm1.2.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m2.1b"><ci id="algorithm1.2.2.m2.1.1.cmml" xref="algorithm1.2.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m2.1c">R</annotation></semantics></math>, learning rate <math id="algorithm1.3.3.m3.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="algorithm1.3.3.m3.1a"><mi id="algorithm1.3.3.m3.1.1" xref="algorithm1.3.3.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m3.1b"><ci id="algorithm1.3.3.m3.1.1.cmml" xref="algorithm1.3.3.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m3.1c">\eta</annotation></semantics></math>.
</div>
<div id="algorithm1.29.30" class="ltx_listingline">
<span id="algorithm1.29.30.1" class="ltx_text ltx_font_typewriter">/* </span><span id="algorithm1.29.30.2" class="ltx_text ltx_font_typewriter">Server preparation  */</span>
</div>
<div id="algorithm1.5.5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span>
<span id="algorithm1.5.5.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.5.5.2" class="ltx_emph ltx_font_italic">each class <math id="algorithm1.4.4.1.m1.1" class="ltx_Math" alttext="k\leftarrow 1" display="inline"><semantics id="algorithm1.4.4.1.m1.1a"><mrow id="algorithm1.4.4.1.m1.1.1" xref="algorithm1.4.4.1.m1.1.1.cmml"><mi id="algorithm1.4.4.1.m1.1.1.2" xref="algorithm1.4.4.1.m1.1.1.2.cmml">k</mi><mo stretchy="false" id="algorithm1.4.4.1.m1.1.1.1" xref="algorithm1.4.4.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.4.4.1.m1.1.1.3" xref="algorithm1.4.4.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.1.m1.1b"><apply id="algorithm1.4.4.1.m1.1.1.cmml" xref="algorithm1.4.4.1.m1.1.1"><ci id="algorithm1.4.4.1.m1.1.1.1.cmml" xref="algorithm1.4.4.1.m1.1.1.1">←</ci><ci id="algorithm1.4.4.1.m1.1.1.2.cmml" xref="algorithm1.4.4.1.m1.1.1.2">𝑘</ci><cn type="integer" id="algorithm1.4.4.1.m1.1.1.3.cmml" xref="algorithm1.4.4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.1.m1.1c">k\leftarrow 1</annotation></semantics></math> <span id="algorithm1.5.5.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="algorithm1.5.5.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algorithm1.5.5.2.m2.1a"><mi id="algorithm1.5.5.2.m2.1.1" xref="algorithm1.5.5.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.2.m2.1b"><ci id="algorithm1.5.5.2.m2.1.1.cmml" xref="algorithm1.5.5.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.2.m2.1c">K</annotation></semantics></math></em> <span id="algorithm1.5.5.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.9.9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Obtain class name <math id="algorithm1.6.6.m1.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="algorithm1.6.6.m1.1a"><mo stretchy="false" id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.1b"><ci id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.1c">\{</annotation></semantics></math>object<math id="algorithm1.7.7.m2.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="algorithm1.7.7.m2.1a"><mo stretchy="false" id="algorithm1.7.7.m2.1.1" xref="algorithm1.7.7.m2.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m2.1b"><ci id="algorithm1.7.7.m2.1.1.cmml" xref="algorithm1.7.7.m2.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m2.1c">\}</annotation></semantics></math> and construct a sentence: a photo of a <math id="algorithm1.8.8.m3.1" class="ltx_Math" alttext="\{" display="inline"><semantics id="algorithm1.8.8.m3.1a"><mo stretchy="false" id="algorithm1.8.8.m3.1.1" xref="algorithm1.8.8.m3.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m3.1b"><ci id="algorithm1.8.8.m3.1.1.cmml" xref="algorithm1.8.8.m3.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m3.1c">\{</annotation></semantics></math>object<math id="algorithm1.9.9.m4.1" class="ltx_Math" alttext="\}" display="inline"><semantics id="algorithm1.9.9.m4.1a"><mo stretchy="false" id="algorithm1.9.9.m4.1.1" xref="algorithm1.9.9.m4.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m4.1b"><ci id="algorithm1.9.9.m4.1.1.cmml" xref="algorithm1.9.9.m4.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m4.1c">\}</annotation></semantics></math>.
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Extract text feature vector <math id="algorithm1.10.10.m1.1" class="ltx_Math" alttext="\bm{T}_{k}" display="inline"><semantics id="algorithm1.10.10.m1.1a"><msub id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><mi id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml">𝑻</mi><mi id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1">subscript</csymbol><ci id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2">𝑻</ci><ci id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">\bm{T}_{k}</annotation></semantics></math> using the CLIP text encoder from the sentence above.
</div>
<div id="algorithm1.29.31" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div id="algorithm1.29.32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span> end for
</div>
<div id="algorithm1.12.12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span>Initialize the parameters of the linear classifier <math id="algorithm1.11.11.m1.3" class="ltx_Math" alttext="\bm{W}=[\bm{T}_{1},\cdots,\bm{T}_{K}]^{\top}" display="inline"><semantics id="algorithm1.11.11.m1.3a"><mrow id="algorithm1.11.11.m1.3.3" xref="algorithm1.11.11.m1.3.3.cmml"><mi id="algorithm1.11.11.m1.3.3.4" xref="algorithm1.11.11.m1.3.3.4.cmml">𝑾</mi><mo id="algorithm1.11.11.m1.3.3.3" xref="algorithm1.11.11.m1.3.3.3.cmml">=</mo><msup id="algorithm1.11.11.m1.3.3.2" xref="algorithm1.11.11.m1.3.3.2.cmml"><mrow id="algorithm1.11.11.m1.3.3.2.2.2" xref="algorithm1.11.11.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="algorithm1.11.11.m1.3.3.2.2.2.3" xref="algorithm1.11.11.m1.3.3.2.2.3.cmml">[</mo><msub id="algorithm1.11.11.m1.2.2.1.1.1.1" xref="algorithm1.11.11.m1.2.2.1.1.1.1.cmml"><mi id="algorithm1.11.11.m1.2.2.1.1.1.1.2" xref="algorithm1.11.11.m1.2.2.1.1.1.1.2.cmml">𝑻</mi><mn id="algorithm1.11.11.m1.2.2.1.1.1.1.3" xref="algorithm1.11.11.m1.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="algorithm1.11.11.m1.3.3.2.2.2.4" xref="algorithm1.11.11.m1.3.3.2.2.3.cmml">,</mo><mi mathvariant="normal" id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml">⋯</mi><mo id="algorithm1.11.11.m1.3.3.2.2.2.5" xref="algorithm1.11.11.m1.3.3.2.2.3.cmml">,</mo><msub id="algorithm1.11.11.m1.3.3.2.2.2.2" xref="algorithm1.11.11.m1.3.3.2.2.2.2.cmml"><mi id="algorithm1.11.11.m1.3.3.2.2.2.2.2" xref="algorithm1.11.11.m1.3.3.2.2.2.2.2.cmml">𝑻</mi><mi id="algorithm1.11.11.m1.3.3.2.2.2.2.3" xref="algorithm1.11.11.m1.3.3.2.2.2.2.3.cmml">K</mi></msub><mo stretchy="false" id="algorithm1.11.11.m1.3.3.2.2.2.6" xref="algorithm1.11.11.m1.3.3.2.2.3.cmml">]</mo></mrow><mo id="algorithm1.11.11.m1.3.3.2.4" xref="algorithm1.11.11.m1.3.3.2.4.cmml">⊤</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.3b"><apply id="algorithm1.11.11.m1.3.3.cmml" xref="algorithm1.11.11.m1.3.3"><eq id="algorithm1.11.11.m1.3.3.3.cmml" xref="algorithm1.11.11.m1.3.3.3"></eq><ci id="algorithm1.11.11.m1.3.3.4.cmml" xref="algorithm1.11.11.m1.3.3.4">𝑾</ci><apply id="algorithm1.11.11.m1.3.3.2.cmml" xref="algorithm1.11.11.m1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.3.3.2.3.cmml" xref="algorithm1.11.11.m1.3.3.2">superscript</csymbol><list id="algorithm1.11.11.m1.3.3.2.2.3.cmml" xref="algorithm1.11.11.m1.3.3.2.2.2"><apply id="algorithm1.11.11.m1.2.2.1.1.1.1.cmml" xref="algorithm1.11.11.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.2.2.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.2.2.1.1.1.1">subscript</csymbol><ci id="algorithm1.11.11.m1.2.2.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.2.2.1.1.1.1.2">𝑻</ci><cn type="integer" id="algorithm1.11.11.m1.2.2.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.2.2.1.1.1.1.3">1</cn></apply><ci id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1">⋯</ci><apply id="algorithm1.11.11.m1.3.3.2.2.2.2.cmml" xref="algorithm1.11.11.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.3.3.2.2.2.2.1.cmml" xref="algorithm1.11.11.m1.3.3.2.2.2.2">subscript</csymbol><ci id="algorithm1.11.11.m1.3.3.2.2.2.2.2.cmml" xref="algorithm1.11.11.m1.3.3.2.2.2.2.2">𝑻</ci><ci id="algorithm1.11.11.m1.3.3.2.2.2.2.3.cmml" xref="algorithm1.11.11.m1.3.3.2.2.2.2.3">𝐾</ci></apply></list><csymbol cd="latexml" id="algorithm1.11.11.m1.3.3.2.4.cmml" xref="algorithm1.11.11.m1.3.3.2.4">top</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.3c">\bm{W}=[\bm{T}_{1},\cdots,\bm{T}_{K}]^{\top}</annotation></semantics></math> and <math id="algorithm1.12.12.m2.1" class="ltx_Math" alttext="\bm{b}=\bm{0}" display="inline"><semantics id="algorithm1.12.12.m2.1a"><mrow id="algorithm1.12.12.m2.1.1" xref="algorithm1.12.12.m2.1.1.cmml"><mi id="algorithm1.12.12.m2.1.1.2" xref="algorithm1.12.12.m2.1.1.2.cmml">𝒃</mi><mo id="algorithm1.12.12.m2.1.1.1" xref="algorithm1.12.12.m2.1.1.1.cmml">=</mo><mn id="algorithm1.12.12.m2.1.1.3" xref="algorithm1.12.12.m2.1.1.3.cmml">𝟎</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m2.1b"><apply id="algorithm1.12.12.m2.1.1.cmml" xref="algorithm1.12.12.m2.1.1"><eq id="algorithm1.12.12.m2.1.1.1.cmml" xref="algorithm1.12.12.m2.1.1.1"></eq><ci id="algorithm1.12.12.m2.1.1.2.cmml" xref="algorithm1.12.12.m2.1.1.2">𝒃</ci><cn type="integer" id="algorithm1.12.12.m2.1.1.3.cmml" xref="algorithm1.12.12.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m2.1c">\bm{b}=\bm{0}</annotation></semantics></math>.
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span>
Distribute the text features <math id="algorithm1.13.13.m1.1" class="ltx_Math" alttext="\{T_{k}\}_{k=1}^{K}" display="inline"><semantics id="algorithm1.13.13.m1.1a"><msubsup id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><mrow id="algorithm1.13.13.m1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.13.13.m1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.2.cmml">{</mo><msub id="algorithm1.13.13.m1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.1.1.2.cmml">T</mi><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="algorithm1.13.13.m1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="algorithm1.13.13.m1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.3.cmml"><mi id="algorithm1.13.13.m1.1.1.1.3.2" xref="algorithm1.13.13.m1.1.1.1.3.2.cmml">k</mi><mo id="algorithm1.13.13.m1.1.1.1.3.1" xref="algorithm1.13.13.m1.1.1.1.3.1.cmml">=</mo><mn id="algorithm1.13.13.m1.1.1.1.3.3" xref="algorithm1.13.13.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="algorithm1.13.13.m1.1.1.3" xref="algorithm1.13.13.m1.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1">superscript</csymbol><apply id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1">subscript</csymbol><set id="algorithm1.13.13.m1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1"><apply id="algorithm1.13.13.m1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.2">𝑇</ci><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="algorithm1.13.13.m1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.3"><eq id="algorithm1.13.13.m1.1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.1.3.1"></eq><ci id="algorithm1.13.13.m1.1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.1.3.2">𝑘</ci><cn type="integer" id="algorithm1.13.13.m1.1.1.1.3.3.cmml" xref="algorithm1.13.13.m1.1.1.1.3.3">1</cn></apply></apply><ci id="algorithm1.13.13.m1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">\{T_{k}\}_{k=1}^{K}</annotation></semantics></math> and CLIP image encoder to each client.
</div>
<div id="algorithm1.29.33" class="ltx_listingline">
<span id="algorithm1.29.33.1" class="ltx_text ltx_font_typewriter">/* </span><span id="algorithm1.29.33.2" class="ltx_text ltx_font_typewriter">Training starts  */</span>
</div>
<div id="algorithm1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">8</span>
<span id="algorithm1.15.15.3" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.15.15.2" class="ltx_emph ltx_font_italic">each round <math id="algorithm1.14.14.1.m1.1" class="ltx_Math" alttext="r\leftarrow 1" display="inline"><semantics id="algorithm1.14.14.1.m1.1a"><mrow id="algorithm1.14.14.1.m1.1.1" xref="algorithm1.14.14.1.m1.1.1.cmml"><mi id="algorithm1.14.14.1.m1.1.1.2" xref="algorithm1.14.14.1.m1.1.1.2.cmml">r</mi><mo stretchy="false" id="algorithm1.14.14.1.m1.1.1.1" xref="algorithm1.14.14.1.m1.1.1.1.cmml">←</mo><mn id="algorithm1.14.14.1.m1.1.1.3" xref="algorithm1.14.14.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.1.m1.1b"><apply id="algorithm1.14.14.1.m1.1.1.cmml" xref="algorithm1.14.14.1.m1.1.1"><ci id="algorithm1.14.14.1.m1.1.1.1.cmml" xref="algorithm1.14.14.1.m1.1.1.1">←</ci><ci id="algorithm1.14.14.1.m1.1.1.2.cmml" xref="algorithm1.14.14.1.m1.1.1.2">𝑟</ci><cn type="integer" id="algorithm1.14.14.1.m1.1.1.3.cmml" xref="algorithm1.14.14.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.1.m1.1c">r\leftarrow 1</annotation></semantics></math> <span id="algorithm1.15.15.2.1" class="ltx_text ltx_font_bold ltx_font_upright">to</span> <math id="algorithm1.15.15.2.m2.1" class="ltx_Math" alttext="R" display="inline"><semantics id="algorithm1.15.15.2.m2.1a"><mi id="algorithm1.15.15.2.m2.1.1" xref="algorithm1.15.15.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.2.m2.1b"><ci id="algorithm1.15.15.2.m2.1.1.cmml" xref="algorithm1.15.15.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.2.m2.1c">R</annotation></semantics></math></em> <span id="algorithm1.15.15.4" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.29.34" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Server samples participated clients for training in this round.
</div>
<div id="algorithm1.29.35" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.29.35.1" class="ltx_text ltx_font_typewriter">/* </span><span id="algorithm1.29.35.2" class="ltx_text ltx_font_typewriter">Local update  */</span>
</div>
<div id="algorithm1.16.16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.16.16.2" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.16.16.1" class="ltx_emph ltx_font_italic">each client <math id="algorithm1.16.16.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="algorithm1.16.16.1.m1.1a"><mi id="algorithm1.16.16.1.m1.1.1" xref="algorithm1.16.16.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.1.m1.1b"><ci id="algorithm1.16.16.1.m1.1.1.cmml" xref="algorithm1.16.16.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.1.m1.1c">c</annotation></semantics></math></em> <span id="algorithm1.16.16.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.18.18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Download model parameters <math id="algorithm1.17.17.m1.1" class="ltx_Math" alttext="\bm{W}^{r}_{c}" display="inline"><semantics id="algorithm1.17.17.m1.1a"><msubsup id="algorithm1.17.17.m1.1.1" xref="algorithm1.17.17.m1.1.1.cmml"><mi id="algorithm1.17.17.m1.1.1.2.2" xref="algorithm1.17.17.m1.1.1.2.2.cmml">𝑾</mi><mi id="algorithm1.17.17.m1.1.1.3" xref="algorithm1.17.17.m1.1.1.3.cmml">c</mi><mi id="algorithm1.17.17.m1.1.1.2.3" xref="algorithm1.17.17.m1.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m1.1b"><apply id="algorithm1.17.17.m1.1.1.cmml" xref="algorithm1.17.17.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.1.cmml" xref="algorithm1.17.17.m1.1.1">subscript</csymbol><apply id="algorithm1.17.17.m1.1.1.2.cmml" xref="algorithm1.17.17.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m1.1.1.2.1.cmml" xref="algorithm1.17.17.m1.1.1">superscript</csymbol><ci id="algorithm1.17.17.m1.1.1.2.2.cmml" xref="algorithm1.17.17.m1.1.1.2.2">𝑾</ci><ci id="algorithm1.17.17.m1.1.1.2.3.cmml" xref="algorithm1.17.17.m1.1.1.2.3">𝑟</ci></apply><ci id="algorithm1.17.17.m1.1.1.3.cmml" xref="algorithm1.17.17.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m1.1c">\bm{W}^{r}_{c}</annotation></semantics></math> and <math id="algorithm1.18.18.m2.1" class="ltx_Math" alttext="\bm{b}^{r}_{c}" display="inline"><semantics id="algorithm1.18.18.m2.1a"><msubsup id="algorithm1.18.18.m2.1.1" xref="algorithm1.18.18.m2.1.1.cmml"><mi id="algorithm1.18.18.m2.1.1.2.2" xref="algorithm1.18.18.m2.1.1.2.2.cmml">𝒃</mi><mi id="algorithm1.18.18.m2.1.1.3" xref="algorithm1.18.18.m2.1.1.3.cmml">c</mi><mi id="algorithm1.18.18.m2.1.1.2.3" xref="algorithm1.18.18.m2.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m2.1b"><apply id="algorithm1.18.18.m2.1.1.cmml" xref="algorithm1.18.18.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.18.18.m2.1.1.1.cmml" xref="algorithm1.18.18.m2.1.1">subscript</csymbol><apply id="algorithm1.18.18.m2.1.1.2.cmml" xref="algorithm1.18.18.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.18.18.m2.1.1.2.1.cmml" xref="algorithm1.18.18.m2.1.1">superscript</csymbol><ci id="algorithm1.18.18.m2.1.1.2.2.cmml" xref="algorithm1.18.18.m2.1.1.2.2">𝒃</ci><ci id="algorithm1.18.18.m2.1.1.2.3.cmml" xref="algorithm1.18.18.m2.1.1.2.3">𝑟</ci></apply><ci id="algorithm1.18.18.m2.1.1.3.cmml" xref="algorithm1.18.18.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m2.1c">\bm{b}^{r}_{c}</annotation></semantics></math> to local machine.
</div>
<div id="algorithm1.29.36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span id="algorithm1.29.36.1" class="ltx_text ltx_font_bold">for</span> <em id="algorithm1.29.36.2" class="ltx_emph ltx_font_italic">each iteration</em> <span id="algorithm1.29.36.3" class="ltx_text ltx_font_bold">do</span> 
</div>
<div id="algorithm1.20.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Extract image feature vectors <math id="algorithm1.19.19.m1.1" class="ltx_Math" alttext="\bm{I}_{j}" display="inline"><semantics id="algorithm1.19.19.m1.1a"><msub id="algorithm1.19.19.m1.1.1" xref="algorithm1.19.19.m1.1.1.cmml"><mi id="algorithm1.19.19.m1.1.1.2" xref="algorithm1.19.19.m1.1.1.2.cmml">𝑰</mi><mi id="algorithm1.19.19.m1.1.1.3" xref="algorithm1.19.19.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m1.1b"><apply id="algorithm1.19.19.m1.1.1.cmml" xref="algorithm1.19.19.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.19.19.m1.1.1.1.cmml" xref="algorithm1.19.19.m1.1.1">subscript</csymbol><ci id="algorithm1.19.19.m1.1.1.2.cmml" xref="algorithm1.19.19.m1.1.1.2">𝑰</ci><ci id="algorithm1.19.19.m1.1.1.3.cmml" xref="algorithm1.19.19.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m1.1c">\bm{I}_{j}</annotation></semantics></math> for each image <math id="algorithm1.20.20.m2.1" class="ltx_Math" alttext="\bm{x}_{j}" display="inline"><semantics id="algorithm1.20.20.m2.1a"><msub id="algorithm1.20.20.m2.1.1" xref="algorithm1.20.20.m2.1.1.cmml"><mi id="algorithm1.20.20.m2.1.1.2" xref="algorithm1.20.20.m2.1.1.2.cmml">𝒙</mi><mi id="algorithm1.20.20.m2.1.1.3" xref="algorithm1.20.20.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m2.1b"><apply id="algorithm1.20.20.m2.1.1.cmml" xref="algorithm1.20.20.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.20.20.m2.1.1.1.cmml" xref="algorithm1.20.20.m2.1.1">subscript</csymbol><ci id="algorithm1.20.20.m2.1.1.2.cmml" xref="algorithm1.20.20.m2.1.1.2">𝒙</ci><ci id="algorithm1.20.20.m2.1.1.3.cmml" xref="algorithm1.20.20.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m2.1c">\bm{x}_{j}</annotation></semantics></math> using the CLIP image encoder.
</div>
<div id="algorithm1.21.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Update soft pseudo labels for each image <math id="algorithm1.21.21.m1.1" class="ltx_Math" alttext="\bm{x}_{j}" display="inline"><semantics id="algorithm1.21.21.m1.1a"><msub id="algorithm1.21.21.m1.1.1" xref="algorithm1.21.21.m1.1.1.cmml"><mi id="algorithm1.21.21.m1.1.1.2" xref="algorithm1.21.21.m1.1.1.2.cmml">𝒙</mi><mi id="algorithm1.21.21.m1.1.1.3" xref="algorithm1.21.21.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.1b"><apply id="algorithm1.21.21.m1.1.1.cmml" xref="algorithm1.21.21.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1">subscript</csymbol><ci id="algorithm1.21.21.m1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.2">𝒙</ci><ci id="algorithm1.21.21.m1.1.1.3.cmml" xref="algorithm1.21.21.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.1c">\bm{x}_{j}</annotation></semantics></math> according to Equation (<a href="#S3.E4" title="In 3.2 Resilient Self-Training with Evolving Pseudo-Labels ‣ 3 Proposed Method ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).
</div>
<div id="algorithm1.22.22" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Calculate self-training loss <math id="algorithm1.22.22.m1.1" class="ltx_Math" alttext="\mathcal{L}_{iST}" display="inline"><semantics id="algorithm1.22.22.m1.1a"><msub id="algorithm1.22.22.m1.1.1" xref="algorithm1.22.22.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.22.22.m1.1.1.2" xref="algorithm1.22.22.m1.1.1.2.cmml">ℒ</mi><mrow id="algorithm1.22.22.m1.1.1.3" xref="algorithm1.22.22.m1.1.1.3.cmml"><mi id="algorithm1.22.22.m1.1.1.3.2" xref="algorithm1.22.22.m1.1.1.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.1.1.3.1" xref="algorithm1.22.22.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.22.22.m1.1.1.3.3" xref="algorithm1.22.22.m1.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.22.22.m1.1.1.3.1a" xref="algorithm1.22.22.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.22.22.m1.1.1.3.4" xref="algorithm1.22.22.m1.1.1.3.4.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m1.1b"><apply id="algorithm1.22.22.m1.1.1.cmml" xref="algorithm1.22.22.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1">subscript</csymbol><ci id="algorithm1.22.22.m1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.2">ℒ</ci><apply id="algorithm1.22.22.m1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.3"><times id="algorithm1.22.22.m1.1.1.3.1.cmml" xref="algorithm1.22.22.m1.1.1.3.1"></times><ci id="algorithm1.22.22.m1.1.1.3.2.cmml" xref="algorithm1.22.22.m1.1.1.3.2">𝑖</ci><ci id="algorithm1.22.22.m1.1.1.3.3.cmml" xref="algorithm1.22.22.m1.1.1.3.3">𝑆</ci><ci id="algorithm1.22.22.m1.1.1.3.4.cmml" xref="algorithm1.22.22.m1.1.1.3.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m1.1c">\mathcal{L}_{iST}</annotation></semantics></math> according to Equation (<a href="#S3.E3" title="In 3.2 Resilient Self-Training with Evolving Pseudo-Labels ‣ 3 Proposed Method ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>).
</div>
<div id="algorithm1.29.37" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Sample synthetic instances according to Equation (<a href="#S3.E5" title="In 3.3 Class-Balanced Data Generation ‣ 3 Proposed Method ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) and (<a href="#S3.E7" title="In 3.3 Class-Balanced Data Generation ‣ 3 Proposed Method ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>).
</div>
<div id="algorithm1.23.23" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Calculate loss based on sampled synthetic instances <math id="algorithm1.23.23.m1.1" class="ltx_Math" alttext="\mathcal{L}_{tSamp}" display="inline"><semantics id="algorithm1.23.23.m1.1a"><msub id="algorithm1.23.23.m1.1.1" xref="algorithm1.23.23.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.23.23.m1.1.1.2" xref="algorithm1.23.23.m1.1.1.2.cmml">ℒ</mi><mrow id="algorithm1.23.23.m1.1.1.3" xref="algorithm1.23.23.m1.1.1.3.cmml"><mi id="algorithm1.23.23.m1.1.1.3.2" xref="algorithm1.23.23.m1.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.23.23.m1.1.1.3.1" xref="algorithm1.23.23.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.23.23.m1.1.1.3.3" xref="algorithm1.23.23.m1.1.1.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.23.23.m1.1.1.3.1a" xref="algorithm1.23.23.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.23.23.m1.1.1.3.4" xref="algorithm1.23.23.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.23.23.m1.1.1.3.1b" xref="algorithm1.23.23.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.23.23.m1.1.1.3.5" xref="algorithm1.23.23.m1.1.1.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="algorithm1.23.23.m1.1.1.3.1c" xref="algorithm1.23.23.m1.1.1.3.1.cmml">​</mo><mi id="algorithm1.23.23.m1.1.1.3.6" xref="algorithm1.23.23.m1.1.1.3.6.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m1.1b"><apply id="algorithm1.23.23.m1.1.1.cmml" xref="algorithm1.23.23.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.23.23.m1.1.1.1.cmml" xref="algorithm1.23.23.m1.1.1">subscript</csymbol><ci id="algorithm1.23.23.m1.1.1.2.cmml" xref="algorithm1.23.23.m1.1.1.2">ℒ</ci><apply id="algorithm1.23.23.m1.1.1.3.cmml" xref="algorithm1.23.23.m1.1.1.3"><times id="algorithm1.23.23.m1.1.1.3.1.cmml" xref="algorithm1.23.23.m1.1.1.3.1"></times><ci id="algorithm1.23.23.m1.1.1.3.2.cmml" xref="algorithm1.23.23.m1.1.1.3.2">𝑡</ci><ci id="algorithm1.23.23.m1.1.1.3.3.cmml" xref="algorithm1.23.23.m1.1.1.3.3">𝑆</ci><ci id="algorithm1.23.23.m1.1.1.3.4.cmml" xref="algorithm1.23.23.m1.1.1.3.4">𝑎</ci><ci id="algorithm1.23.23.m1.1.1.3.5.cmml" xref="algorithm1.23.23.m1.1.1.3.5">𝑚</ci><ci id="algorithm1.23.23.m1.1.1.3.6.cmml" xref="algorithm1.23.23.m1.1.1.3.6">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m1.1c">\mathcal{L}_{tSamp}</annotation></semantics></math> via Equation (<a href="#S3.E6" title="In 3.3 Class-Balanced Data Generation ‣ 3 Proposed Method ‣ Lightweight Unsupervised Federated Learning with Pretrained Vision Language Model" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>).
</div>
<div id="algorithm1.25.25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">18</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
Update model parameters <math id="algorithm1.24.24.m1.2" class="ltx_Math" alttext="\bm{W}^{r}_{c}\leftarrow\bm{W}^{r}_{c}-\eta\nabla_{\bm{W}^{r}_{c}}(\mathcal{L}_{iST}+\lambda\mathcal{L}_{tSamp})" display="inline"><semantics id="algorithm1.24.24.m1.2a"><mrow id="algorithm1.24.24.m1.2.2" xref="algorithm1.24.24.m1.2.2.cmml"><msubsup id="algorithm1.24.24.m1.2.2.4" xref="algorithm1.24.24.m1.2.2.4.cmml"><mi id="algorithm1.24.24.m1.2.2.4.2.2" xref="algorithm1.24.24.m1.2.2.4.2.2.cmml">𝑾</mi><mi id="algorithm1.24.24.m1.2.2.4.3" xref="algorithm1.24.24.m1.2.2.4.3.cmml">c</mi><mi id="algorithm1.24.24.m1.2.2.4.2.3" xref="algorithm1.24.24.m1.2.2.4.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="algorithm1.24.24.m1.2.2.3" xref="algorithm1.24.24.m1.2.2.3.cmml">←</mo><mrow id="algorithm1.24.24.m1.2.2.2" xref="algorithm1.24.24.m1.2.2.2.cmml"><msubsup id="algorithm1.24.24.m1.2.2.2.4" xref="algorithm1.24.24.m1.2.2.2.4.cmml"><mi id="algorithm1.24.24.m1.2.2.2.4.2.2" xref="algorithm1.24.24.m1.2.2.2.4.2.2.cmml">𝑾</mi><mi id="algorithm1.24.24.m1.2.2.2.4.3" xref="algorithm1.24.24.m1.2.2.2.4.3.cmml">c</mi><mi id="algorithm1.24.24.m1.2.2.2.4.2.3" xref="algorithm1.24.24.m1.2.2.2.4.2.3.cmml">r</mi></msubsup><mo id="algorithm1.24.24.m1.2.2.2.3" xref="algorithm1.24.24.m1.2.2.2.3.cmml">−</mo><mrow id="algorithm1.24.24.m1.2.2.2.2" xref="algorithm1.24.24.m1.2.2.2.2.cmml"><mi id="algorithm1.24.24.m1.2.2.2.2.4" xref="algorithm1.24.24.m1.2.2.2.2.4.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="algorithm1.24.24.m1.2.2.2.2.3" xref="algorithm1.24.24.m1.2.2.2.2.3.cmml">​</mo><mrow id="algorithm1.24.24.m1.2.2.2.2.2.2" xref="algorithm1.24.24.m1.2.2.2.2.2.3.cmml"><msub id="algorithm1.24.24.m1.1.1.1.1.1.1.1" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.cmml"><mo id="algorithm1.24.24.m1.1.1.1.1.1.1.1.2" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.2.cmml">∇</mo><msubsup id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.2.2" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.2.2.cmml">𝑾</mi><mi id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.3" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.3.cmml">c</mi><mi id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.2.3" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.2.3.cmml">r</mi></msubsup></msub><mrow id="algorithm1.24.24.m1.2.2.2.2.2.2.2" xref="algorithm1.24.24.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.2" xref="algorithm1.24.24.m1.2.2.2.2.2.3.cmml">(</mo><mrow id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.cmml"><msub id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.2" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.2.cmml">ℒ</mi><mrow id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.cmml"><mi id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.2" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.1" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.1.cmml">​</mo><mi id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.3" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.1a" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.1.cmml">​</mo><mi id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.4" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.4.cmml">T</mi></mrow></msub><mo id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.1" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.1.cmml">+</mo><mrow id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.cmml"><mi id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.2" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.1" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.1.cmml">​</mo><msub id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.2" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.2.cmml">ℒ</mi><mrow id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.cmml"><mi id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.2" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.1" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.1.cmml">​</mo><mi id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.3" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.1a" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.1.cmml">​</mo><mi id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.4" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.1b" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.1.cmml">​</mo><mi id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.5" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.1c" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.1.cmml">​</mo><mi id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.6" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.6.cmml">p</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.3" xref="algorithm1.24.24.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.m1.2b"><apply id="algorithm1.24.24.m1.2.2.cmml" xref="algorithm1.24.24.m1.2.2"><ci id="algorithm1.24.24.m1.2.2.3.cmml" xref="algorithm1.24.24.m1.2.2.3">←</ci><apply id="algorithm1.24.24.m1.2.2.4.cmml" xref="algorithm1.24.24.m1.2.2.4"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.2.2.4.1.cmml" xref="algorithm1.24.24.m1.2.2.4">subscript</csymbol><apply id="algorithm1.24.24.m1.2.2.4.2.cmml" xref="algorithm1.24.24.m1.2.2.4"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.2.2.4.2.1.cmml" xref="algorithm1.24.24.m1.2.2.4">superscript</csymbol><ci id="algorithm1.24.24.m1.2.2.4.2.2.cmml" xref="algorithm1.24.24.m1.2.2.4.2.2">𝑾</ci><ci id="algorithm1.24.24.m1.2.2.4.2.3.cmml" xref="algorithm1.24.24.m1.2.2.4.2.3">𝑟</ci></apply><ci id="algorithm1.24.24.m1.2.2.4.3.cmml" xref="algorithm1.24.24.m1.2.2.4.3">𝑐</ci></apply><apply id="algorithm1.24.24.m1.2.2.2.cmml" xref="algorithm1.24.24.m1.2.2.2"><minus id="algorithm1.24.24.m1.2.2.2.3.cmml" xref="algorithm1.24.24.m1.2.2.2.3"></minus><apply id="algorithm1.24.24.m1.2.2.2.4.cmml" xref="algorithm1.24.24.m1.2.2.2.4"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.2.2.2.4.1.cmml" xref="algorithm1.24.24.m1.2.2.2.4">subscript</csymbol><apply id="algorithm1.24.24.m1.2.2.2.4.2.cmml" xref="algorithm1.24.24.m1.2.2.2.4"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.2.2.2.4.2.1.cmml" xref="algorithm1.24.24.m1.2.2.2.4">superscript</csymbol><ci id="algorithm1.24.24.m1.2.2.2.4.2.2.cmml" xref="algorithm1.24.24.m1.2.2.2.4.2.2">𝑾</ci><ci id="algorithm1.24.24.m1.2.2.2.4.2.3.cmml" xref="algorithm1.24.24.m1.2.2.2.4.2.3">𝑟</ci></apply><ci id="algorithm1.24.24.m1.2.2.2.4.3.cmml" xref="algorithm1.24.24.m1.2.2.2.4.3">𝑐</ci></apply><apply id="algorithm1.24.24.m1.2.2.2.2.cmml" xref="algorithm1.24.24.m1.2.2.2.2"><times id="algorithm1.24.24.m1.2.2.2.2.3.cmml" xref="algorithm1.24.24.m1.2.2.2.2.3"></times><ci id="algorithm1.24.24.m1.2.2.2.2.4.cmml" xref="algorithm1.24.24.m1.2.2.2.2.4">𝜂</ci><apply id="algorithm1.24.24.m1.2.2.2.2.2.3.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2"><apply id="algorithm1.24.24.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.24.24.m1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.2">∇</ci><apply id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.2.2">𝑾</ci><ci id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.2.3">𝑟</ci></apply><ci id="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.24.24.m1.1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply><apply id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1"><plus id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.1.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.1"></plus><apply id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.1.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2">subscript</csymbol><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.2.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.2">ℒ</ci><apply id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3"><times id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.1.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.1"></times><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.2.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.2">𝑖</ci><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.3.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.3">𝑆</ci><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.4.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.2.3.4">𝑇</ci></apply></apply><apply id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3"><times id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.1.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.1"></times><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.2.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.2">𝜆</ci><apply id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3"><csymbol cd="ambiguous" id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.1.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3">subscript</csymbol><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.2.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.2">ℒ</ci><apply id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3"><times id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.1.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.1"></times><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.2.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.2">𝑡</ci><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.3.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.3">𝑆</ci><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.4.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.4">𝑎</ci><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.5.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.5">𝑚</ci><ci id="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.6.cmml" xref="algorithm1.24.24.m1.2.2.2.2.2.2.2.1.3.3.3.6">𝑝</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.m1.2c">\bm{W}^{r}_{c}\leftarrow\bm{W}^{r}_{c}-\eta\nabla_{\bm{W}^{r}_{c}}(\mathcal{L}_{iST}+\lambda\mathcal{L}_{tSamp})</annotation></semantics></math> and <math id="algorithm1.25.25.m2.2" class="ltx_Math" alttext="\bm{b}^{r}_{c}\leftarrow\bm{b}^{r}_{c}-\eta\nabla_{\bm{b}^{r}_{c}}(\mathcal{L}_{iST}+\lambda\mathcal{L}_{tSamp})" display="inline"><semantics id="algorithm1.25.25.m2.2a"><mrow id="algorithm1.25.25.m2.2.2" xref="algorithm1.25.25.m2.2.2.cmml"><msubsup id="algorithm1.25.25.m2.2.2.4" xref="algorithm1.25.25.m2.2.2.4.cmml"><mi id="algorithm1.25.25.m2.2.2.4.2.2" xref="algorithm1.25.25.m2.2.2.4.2.2.cmml">𝒃</mi><mi id="algorithm1.25.25.m2.2.2.4.3" xref="algorithm1.25.25.m2.2.2.4.3.cmml">c</mi><mi id="algorithm1.25.25.m2.2.2.4.2.3" xref="algorithm1.25.25.m2.2.2.4.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="algorithm1.25.25.m2.2.2.3" xref="algorithm1.25.25.m2.2.2.3.cmml">←</mo><mrow id="algorithm1.25.25.m2.2.2.2" xref="algorithm1.25.25.m2.2.2.2.cmml"><msubsup id="algorithm1.25.25.m2.2.2.2.4" xref="algorithm1.25.25.m2.2.2.2.4.cmml"><mi id="algorithm1.25.25.m2.2.2.2.4.2.2" xref="algorithm1.25.25.m2.2.2.2.4.2.2.cmml">𝒃</mi><mi id="algorithm1.25.25.m2.2.2.2.4.3" xref="algorithm1.25.25.m2.2.2.2.4.3.cmml">c</mi><mi id="algorithm1.25.25.m2.2.2.2.4.2.3" xref="algorithm1.25.25.m2.2.2.2.4.2.3.cmml">r</mi></msubsup><mo id="algorithm1.25.25.m2.2.2.2.3" xref="algorithm1.25.25.m2.2.2.2.3.cmml">−</mo><mrow id="algorithm1.25.25.m2.2.2.2.2" xref="algorithm1.25.25.m2.2.2.2.2.cmml"><mi id="algorithm1.25.25.m2.2.2.2.2.4" xref="algorithm1.25.25.m2.2.2.2.2.4.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="algorithm1.25.25.m2.2.2.2.2.3" xref="algorithm1.25.25.m2.2.2.2.2.3.cmml">​</mo><mrow id="algorithm1.25.25.m2.2.2.2.2.2.2" xref="algorithm1.25.25.m2.2.2.2.2.2.3.cmml"><msub id="algorithm1.25.25.m2.1.1.1.1.1.1.1" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.cmml"><mo id="algorithm1.25.25.m2.1.1.1.1.1.1.1.2" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.2.cmml">∇</mo><msubsup id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.2.2" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.2.2.cmml">𝒃</mi><mi id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.3" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.3.cmml">c</mi><mi id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.2.3" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.2.3.cmml">r</mi></msubsup></msub><mrow id="algorithm1.25.25.m2.2.2.2.2.2.2.2" xref="algorithm1.25.25.m2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.2" xref="algorithm1.25.25.m2.2.2.2.2.2.3.cmml">(</mo><mrow id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.cmml"><msub id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.2" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.2.cmml">ℒ</mi><mrow id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.cmml"><mi id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.2" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.1" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.1.cmml">​</mo><mi id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.3" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.1a" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.1.cmml">​</mo><mi id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.4" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.4.cmml">T</mi></mrow></msub><mo id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.1" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.1.cmml">+</mo><mrow id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.cmml"><mi id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.2" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.1" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.1.cmml">​</mo><msub id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.2" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.2.cmml">ℒ</mi><mrow id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.cmml"><mi id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.2" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.1" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.1.cmml">​</mo><mi id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.3" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.1a" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.1.cmml">​</mo><mi id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.4" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.1b" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.1.cmml">​</mo><mi id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.5" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.1c" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.1.cmml">​</mo><mi id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.6" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.6.cmml">p</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.3" xref="algorithm1.25.25.m2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.m2.2b"><apply id="algorithm1.25.25.m2.2.2.cmml" xref="algorithm1.25.25.m2.2.2"><ci id="algorithm1.25.25.m2.2.2.3.cmml" xref="algorithm1.25.25.m2.2.2.3">←</ci><apply id="algorithm1.25.25.m2.2.2.4.cmml" xref="algorithm1.25.25.m2.2.2.4"><csymbol cd="ambiguous" id="algorithm1.25.25.m2.2.2.4.1.cmml" xref="algorithm1.25.25.m2.2.2.4">subscript</csymbol><apply id="algorithm1.25.25.m2.2.2.4.2.cmml" xref="algorithm1.25.25.m2.2.2.4"><csymbol cd="ambiguous" id="algorithm1.25.25.m2.2.2.4.2.1.cmml" xref="algorithm1.25.25.m2.2.2.4">superscript</csymbol><ci id="algorithm1.25.25.m2.2.2.4.2.2.cmml" xref="algorithm1.25.25.m2.2.2.4.2.2">𝒃</ci><ci id="algorithm1.25.25.m2.2.2.4.2.3.cmml" xref="algorithm1.25.25.m2.2.2.4.2.3">𝑟</ci></apply><ci id="algorithm1.25.25.m2.2.2.4.3.cmml" xref="algorithm1.25.25.m2.2.2.4.3">𝑐</ci></apply><apply id="algorithm1.25.25.m2.2.2.2.cmml" xref="algorithm1.25.25.m2.2.2.2"><minus id="algorithm1.25.25.m2.2.2.2.3.cmml" xref="algorithm1.25.25.m2.2.2.2.3"></minus><apply id="algorithm1.25.25.m2.2.2.2.4.cmml" xref="algorithm1.25.25.m2.2.2.2.4"><csymbol cd="ambiguous" id="algorithm1.25.25.m2.2.2.2.4.1.cmml" xref="algorithm1.25.25.m2.2.2.2.4">subscript</csymbol><apply id="algorithm1.25.25.m2.2.2.2.4.2.cmml" xref="algorithm1.25.25.m2.2.2.2.4"><csymbol cd="ambiguous" id="algorithm1.25.25.m2.2.2.2.4.2.1.cmml" xref="algorithm1.25.25.m2.2.2.2.4">superscript</csymbol><ci id="algorithm1.25.25.m2.2.2.2.4.2.2.cmml" xref="algorithm1.25.25.m2.2.2.2.4.2.2">𝒃</ci><ci id="algorithm1.25.25.m2.2.2.2.4.2.3.cmml" xref="algorithm1.25.25.m2.2.2.2.4.2.3">𝑟</ci></apply><ci id="algorithm1.25.25.m2.2.2.2.4.3.cmml" xref="algorithm1.25.25.m2.2.2.2.4.3">𝑐</ci></apply><apply id="algorithm1.25.25.m2.2.2.2.2.cmml" xref="algorithm1.25.25.m2.2.2.2.2"><times id="algorithm1.25.25.m2.2.2.2.2.3.cmml" xref="algorithm1.25.25.m2.2.2.2.2.3"></times><ci id="algorithm1.25.25.m2.2.2.2.2.4.cmml" xref="algorithm1.25.25.m2.2.2.2.2.4">𝜂</ci><apply id="algorithm1.25.25.m2.2.2.2.2.2.3.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2"><apply id="algorithm1.25.25.m2.1.1.1.1.1.1.1.cmml" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.25.25.m2.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.25.25.m2.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.2">∇</ci><apply id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.2.1.cmml" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.2.2.cmml" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.2.2">𝒃</ci><ci id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.2.3.cmml" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.2.3">𝑟</ci></apply><ci id="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.25.25.m2.1.1.1.1.1.1.1.3.3">𝑐</ci></apply></apply><apply id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1"><plus id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.1.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.1"></plus><apply id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2"><csymbol cd="ambiguous" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.1.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2">subscript</csymbol><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.2.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.2">ℒ</ci><apply id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3"><times id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.1.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.1"></times><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.2.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.2">𝑖</ci><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.3.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.3">𝑆</ci><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.4.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.2.3.4">𝑇</ci></apply></apply><apply id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3"><times id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.1.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.1"></times><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.2.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.2">𝜆</ci><apply id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3"><csymbol cd="ambiguous" id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.1.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3">subscript</csymbol><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.2.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.2">ℒ</ci><apply id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3"><times id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.1.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.1"></times><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.2.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.2">𝑡</ci><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.3.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.3">𝑆</ci><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.4.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.4">𝑎</ci><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.5.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.5">𝑚</ci><ci id="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.6.cmml" xref="algorithm1.25.25.m2.2.2.2.2.2.2.2.1.3.3.3.6">𝑝</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.m2.2c">\bm{b}^{r}_{c}\leftarrow\bm{b}^{r}_{c}-\eta\nabla_{\bm{b}^{r}_{c}}(\mathcal{L}_{iST}+\lambda\mathcal{L}_{tSamp})</annotation></semantics></math>

</div>
<div id="algorithm1.29.38" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">19</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.27.27" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">20</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   Upload updated model parameters <math id="algorithm1.26.26.m1.1" class="ltx_Math" alttext="\bm{W}^{r}_{c}" display="inline"><semantics id="algorithm1.26.26.m1.1a"><msubsup id="algorithm1.26.26.m1.1.1" xref="algorithm1.26.26.m1.1.1.cmml"><mi id="algorithm1.26.26.m1.1.1.2.2" xref="algorithm1.26.26.m1.1.1.2.2.cmml">𝑾</mi><mi id="algorithm1.26.26.m1.1.1.3" xref="algorithm1.26.26.m1.1.1.3.cmml">c</mi><mi id="algorithm1.26.26.m1.1.1.2.3" xref="algorithm1.26.26.m1.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.m1.1b"><apply id="algorithm1.26.26.m1.1.1.cmml" xref="algorithm1.26.26.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.1.1.1.cmml" xref="algorithm1.26.26.m1.1.1">subscript</csymbol><apply id="algorithm1.26.26.m1.1.1.2.cmml" xref="algorithm1.26.26.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.1.1.2.1.cmml" xref="algorithm1.26.26.m1.1.1">superscript</csymbol><ci id="algorithm1.26.26.m1.1.1.2.2.cmml" xref="algorithm1.26.26.m1.1.1.2.2">𝑾</ci><ci id="algorithm1.26.26.m1.1.1.2.3.cmml" xref="algorithm1.26.26.m1.1.1.2.3">𝑟</ci></apply><ci id="algorithm1.26.26.m1.1.1.3.cmml" xref="algorithm1.26.26.m1.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.m1.1c">\bm{W}^{r}_{c}</annotation></semantics></math> and <math id="algorithm1.27.27.m2.1" class="ltx_Math" alttext="\bm{b}^{r}_{c}" display="inline"><semantics id="algorithm1.27.27.m2.1a"><msubsup id="algorithm1.27.27.m2.1.1" xref="algorithm1.27.27.m2.1.1.cmml"><mi id="algorithm1.27.27.m2.1.1.2.2" xref="algorithm1.27.27.m2.1.1.2.2.cmml">𝒃</mi><mi id="algorithm1.27.27.m2.1.1.3" xref="algorithm1.27.27.m2.1.1.3.cmml">c</mi><mi id="algorithm1.27.27.m2.1.1.2.3" xref="algorithm1.27.27.m2.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.27.27.m2.1b"><apply id="algorithm1.27.27.m2.1.1.cmml" xref="algorithm1.27.27.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.27.27.m2.1.1.1.cmml" xref="algorithm1.27.27.m2.1.1">subscript</csymbol><apply id="algorithm1.27.27.m2.1.1.2.cmml" xref="algorithm1.27.27.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.27.27.m2.1.1.2.1.cmml" xref="algorithm1.27.27.m2.1.1">superscript</csymbol><ci id="algorithm1.27.27.m2.1.1.2.2.cmml" xref="algorithm1.27.27.m2.1.1.2.2">𝒃</ci><ci id="algorithm1.27.27.m2.1.1.2.3.cmml" xref="algorithm1.27.27.m2.1.1.2.3">𝑟</ci></apply><ci id="algorithm1.27.27.m2.1.1.3.cmml" xref="algorithm1.27.27.m2.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.27.27.m2.1c">\bm{b}^{r}_{c}</annotation></semantics></math> to the server.

</div>
<div id="algorithm1.29.39" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">21</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div id="algorithm1.29.40" class="ltx_listingline">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span id="algorithm1.29.40.1" class="ltx_text ltx_font_typewriter">/* </span><span id="algorithm1.29.40.2" class="ltx_text ltx_font_typewriter">Model aggregation in the server  */</span>
</div>
<div id="algorithm1.29.29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">22</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math id="algorithm1.28.28.m1.1" class="ltx_Math" alttext="\bm{W}^{r+1}\leftarrow\mathbb{E}_{c}[\bm{W}^{r}_{c}]" display="inline"><semantics id="algorithm1.28.28.m1.1a"><mrow id="algorithm1.28.28.m1.1.1" xref="algorithm1.28.28.m1.1.1.cmml"><msup id="algorithm1.28.28.m1.1.1.3" xref="algorithm1.28.28.m1.1.1.3.cmml"><mi id="algorithm1.28.28.m1.1.1.3.2" xref="algorithm1.28.28.m1.1.1.3.2.cmml">𝑾</mi><mrow id="algorithm1.28.28.m1.1.1.3.3" xref="algorithm1.28.28.m1.1.1.3.3.cmml"><mi id="algorithm1.28.28.m1.1.1.3.3.2" xref="algorithm1.28.28.m1.1.1.3.3.2.cmml">r</mi><mo id="algorithm1.28.28.m1.1.1.3.3.1" xref="algorithm1.28.28.m1.1.1.3.3.1.cmml">+</mo><mn id="algorithm1.28.28.m1.1.1.3.3.3" xref="algorithm1.28.28.m1.1.1.3.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="algorithm1.28.28.m1.1.1.2" xref="algorithm1.28.28.m1.1.1.2.cmml">←</mo><mrow id="algorithm1.28.28.m1.1.1.1" xref="algorithm1.28.28.m1.1.1.1.cmml"><msub id="algorithm1.28.28.m1.1.1.1.3" xref="algorithm1.28.28.m1.1.1.1.3.cmml"><mi id="algorithm1.28.28.m1.1.1.1.3.2" xref="algorithm1.28.28.m1.1.1.1.3.2.cmml">𝔼</mi><mi id="algorithm1.28.28.m1.1.1.1.3.3" xref="algorithm1.28.28.m1.1.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="algorithm1.28.28.m1.1.1.1.2" xref="algorithm1.28.28.m1.1.1.1.2.cmml">​</mo><mrow id="algorithm1.28.28.m1.1.1.1.1.1" xref="algorithm1.28.28.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.28.28.m1.1.1.1.1.1.2" xref="algorithm1.28.28.m1.1.1.1.1.2.1.cmml">[</mo><msubsup id="algorithm1.28.28.m1.1.1.1.1.1.1" xref="algorithm1.28.28.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.28.28.m1.1.1.1.1.1.1.2.2" xref="algorithm1.28.28.m1.1.1.1.1.1.1.2.2.cmml">𝑾</mi><mi id="algorithm1.28.28.m1.1.1.1.1.1.1.3" xref="algorithm1.28.28.m1.1.1.1.1.1.1.3.cmml">c</mi><mi id="algorithm1.28.28.m1.1.1.1.1.1.1.2.3" xref="algorithm1.28.28.m1.1.1.1.1.1.1.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="algorithm1.28.28.m1.1.1.1.1.1.3" xref="algorithm1.28.28.m1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.28.28.m1.1b"><apply id="algorithm1.28.28.m1.1.1.cmml" xref="algorithm1.28.28.m1.1.1"><ci id="algorithm1.28.28.m1.1.1.2.cmml" xref="algorithm1.28.28.m1.1.1.2">←</ci><apply id="algorithm1.28.28.m1.1.1.3.cmml" xref="algorithm1.28.28.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.1.1.3.1.cmml" xref="algorithm1.28.28.m1.1.1.3">superscript</csymbol><ci id="algorithm1.28.28.m1.1.1.3.2.cmml" xref="algorithm1.28.28.m1.1.1.3.2">𝑾</ci><apply id="algorithm1.28.28.m1.1.1.3.3.cmml" xref="algorithm1.28.28.m1.1.1.3.3"><plus id="algorithm1.28.28.m1.1.1.3.3.1.cmml" xref="algorithm1.28.28.m1.1.1.3.3.1"></plus><ci id="algorithm1.28.28.m1.1.1.3.3.2.cmml" xref="algorithm1.28.28.m1.1.1.3.3.2">𝑟</ci><cn type="integer" id="algorithm1.28.28.m1.1.1.3.3.3.cmml" xref="algorithm1.28.28.m1.1.1.3.3.3">1</cn></apply></apply><apply id="algorithm1.28.28.m1.1.1.1.cmml" xref="algorithm1.28.28.m1.1.1.1"><times id="algorithm1.28.28.m1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.1.1.1.2"></times><apply id="algorithm1.28.28.m1.1.1.1.3.cmml" xref="algorithm1.28.28.m1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.1.1.1.3.1.cmml" xref="algorithm1.28.28.m1.1.1.1.3">subscript</csymbol><ci id="algorithm1.28.28.m1.1.1.1.3.2.cmml" xref="algorithm1.28.28.m1.1.1.1.3.2">𝔼</ci><ci id="algorithm1.28.28.m1.1.1.1.3.3.cmml" xref="algorithm1.28.28.m1.1.1.1.3.3">𝑐</ci></apply><apply id="algorithm1.28.28.m1.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1"><csymbol cd="latexml" id="algorithm1.28.28.m1.1.1.1.1.2.1.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="algorithm1.28.28.m1.1.1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm1.28.28.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.28.28.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1.2.2">𝑾</ci><ci id="algorithm1.28.28.m1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1.2.3">𝑟</ci></apply><ci id="algorithm1.28.28.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.28.28.m1.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.28.28.m1.1c">\bm{W}^{r+1}\leftarrow\mathbb{E}_{c}[\bm{W}^{r}_{c}]</annotation></semantics></math> and <math id="algorithm1.29.29.m2.1" class="ltx_Math" alttext="\bm{b}^{r+1}\leftarrow\mathbb{E}_{c}[\bm{b}^{r}_{c}]" display="inline"><semantics id="algorithm1.29.29.m2.1a"><mrow id="algorithm1.29.29.m2.1.1" xref="algorithm1.29.29.m2.1.1.cmml"><msup id="algorithm1.29.29.m2.1.1.3" xref="algorithm1.29.29.m2.1.1.3.cmml"><mi id="algorithm1.29.29.m2.1.1.3.2" xref="algorithm1.29.29.m2.1.1.3.2.cmml">𝒃</mi><mrow id="algorithm1.29.29.m2.1.1.3.3" xref="algorithm1.29.29.m2.1.1.3.3.cmml"><mi id="algorithm1.29.29.m2.1.1.3.3.2" xref="algorithm1.29.29.m2.1.1.3.3.2.cmml">r</mi><mo id="algorithm1.29.29.m2.1.1.3.3.1" xref="algorithm1.29.29.m2.1.1.3.3.1.cmml">+</mo><mn id="algorithm1.29.29.m2.1.1.3.3.3" xref="algorithm1.29.29.m2.1.1.3.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="algorithm1.29.29.m2.1.1.2" xref="algorithm1.29.29.m2.1.1.2.cmml">←</mo><mrow id="algorithm1.29.29.m2.1.1.1" xref="algorithm1.29.29.m2.1.1.1.cmml"><msub id="algorithm1.29.29.m2.1.1.1.3" xref="algorithm1.29.29.m2.1.1.1.3.cmml"><mi id="algorithm1.29.29.m2.1.1.1.3.2" xref="algorithm1.29.29.m2.1.1.1.3.2.cmml">𝔼</mi><mi id="algorithm1.29.29.m2.1.1.1.3.3" xref="algorithm1.29.29.m2.1.1.1.3.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="algorithm1.29.29.m2.1.1.1.2" xref="algorithm1.29.29.m2.1.1.1.2.cmml">​</mo><mrow id="algorithm1.29.29.m2.1.1.1.1.1" xref="algorithm1.29.29.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="algorithm1.29.29.m2.1.1.1.1.1.2" xref="algorithm1.29.29.m2.1.1.1.1.2.1.cmml">[</mo><msubsup id="algorithm1.29.29.m2.1.1.1.1.1.1" xref="algorithm1.29.29.m2.1.1.1.1.1.1.cmml"><mi id="algorithm1.29.29.m2.1.1.1.1.1.1.2.2" xref="algorithm1.29.29.m2.1.1.1.1.1.1.2.2.cmml">𝒃</mi><mi id="algorithm1.29.29.m2.1.1.1.1.1.1.3" xref="algorithm1.29.29.m2.1.1.1.1.1.1.3.cmml">c</mi><mi id="algorithm1.29.29.m2.1.1.1.1.1.1.2.3" xref="algorithm1.29.29.m2.1.1.1.1.1.1.2.3.cmml">r</mi></msubsup><mo stretchy="false" id="algorithm1.29.29.m2.1.1.1.1.1.3" xref="algorithm1.29.29.m2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.29.29.m2.1b"><apply id="algorithm1.29.29.m2.1.1.cmml" xref="algorithm1.29.29.m2.1.1"><ci id="algorithm1.29.29.m2.1.1.2.cmml" xref="algorithm1.29.29.m2.1.1.2">←</ci><apply id="algorithm1.29.29.m2.1.1.3.cmml" xref="algorithm1.29.29.m2.1.1.3"><csymbol cd="ambiguous" id="algorithm1.29.29.m2.1.1.3.1.cmml" xref="algorithm1.29.29.m2.1.1.3">superscript</csymbol><ci id="algorithm1.29.29.m2.1.1.3.2.cmml" xref="algorithm1.29.29.m2.1.1.3.2">𝒃</ci><apply id="algorithm1.29.29.m2.1.1.3.3.cmml" xref="algorithm1.29.29.m2.1.1.3.3"><plus id="algorithm1.29.29.m2.1.1.3.3.1.cmml" xref="algorithm1.29.29.m2.1.1.3.3.1"></plus><ci id="algorithm1.29.29.m2.1.1.3.3.2.cmml" xref="algorithm1.29.29.m2.1.1.3.3.2">𝑟</ci><cn type="integer" id="algorithm1.29.29.m2.1.1.3.3.3.cmml" xref="algorithm1.29.29.m2.1.1.3.3.3">1</cn></apply></apply><apply id="algorithm1.29.29.m2.1.1.1.cmml" xref="algorithm1.29.29.m2.1.1.1"><times id="algorithm1.29.29.m2.1.1.1.2.cmml" xref="algorithm1.29.29.m2.1.1.1.2"></times><apply id="algorithm1.29.29.m2.1.1.1.3.cmml" xref="algorithm1.29.29.m2.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.29.29.m2.1.1.1.3.1.cmml" xref="algorithm1.29.29.m2.1.1.1.3">subscript</csymbol><ci id="algorithm1.29.29.m2.1.1.1.3.2.cmml" xref="algorithm1.29.29.m2.1.1.1.3.2">𝔼</ci><ci id="algorithm1.29.29.m2.1.1.1.3.3.cmml" xref="algorithm1.29.29.m2.1.1.1.3.3">𝑐</ci></apply><apply id="algorithm1.29.29.m2.1.1.1.1.2.cmml" xref="algorithm1.29.29.m2.1.1.1.1.1"><csymbol cd="latexml" id="algorithm1.29.29.m2.1.1.1.1.2.1.cmml" xref="algorithm1.29.29.m2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="algorithm1.29.29.m2.1.1.1.1.1.1.cmml" xref="algorithm1.29.29.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.29.29.m2.1.1.1.1.1.1.1.cmml" xref="algorithm1.29.29.m2.1.1.1.1.1.1">subscript</csymbol><apply id="algorithm1.29.29.m2.1.1.1.1.1.1.2.cmml" xref="algorithm1.29.29.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.29.29.m2.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.29.29.m2.1.1.1.1.1.1">superscript</csymbol><ci id="algorithm1.29.29.m2.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.29.29.m2.1.1.1.1.1.1.2.2">𝒃</ci><ci id="algorithm1.29.29.m2.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.29.29.m2.1.1.1.1.1.1.2.3">𝑟</ci></apply><ci id="algorithm1.29.29.m2.1.1.1.1.1.1.3.cmml" xref="algorithm1.29.29.m2.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.29.29.m2.1c">\bm{b}^{r+1}\leftarrow\mathbb{E}_{c}[\bm{b}^{r}_{c}]</annotation></semantics></math>

</div>
<div id="algorithm1.29.41" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">23</span> end for
</div>
<div id="algorithm1.29.42" class="ltx_listingline">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.31.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Federated Self-Training with Class-Balanced Data Generation (FST-CBDG)</figcaption>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2404.11045" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2404.11046" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2404.11046">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2404.11046" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2404.11048" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun May  5 20:31:55 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
