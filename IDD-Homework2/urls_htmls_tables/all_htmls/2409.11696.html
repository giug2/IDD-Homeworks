<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2409.11696] RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once</title><meta property="og:description" content="We introduce RMP-YOLO, a unified framework designed to provide robust motion predictions even with incomplete input data.
Our key insight stems from the observation that complete and reliable historical trajectory data…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2409.11696">

<!--Generated on Sat Oct  5 22:13:56 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Jiawei Sun<sup id="id12.12.id1" class="ltx_sup"><span id="id12.12.id1.1" class="ltx_text ltx_font_italic">1</span></sup>, Jiahui Li<sup id="id13.13.id2" class="ltx_sup"><span id="id13.13.id2.1" class="ltx_text ltx_font_italic">1</span></sup>, Tingchen Liu<sup id="id14.14.id3" class="ltx_sup"><span id="id14.14.id3.1" class="ltx_text ltx_font_italic">1</span></sup>, Chengran Yuan<sup id="id15.15.id4" class="ltx_sup"><span id="id15.15.id4.1" class="ltx_text ltx_font_italic">1</span></sup>, Shuo Sun<sup id="id16.16.id5" class="ltx_sup"><span id="id16.16.id5.1" class="ltx_text ltx_font_italic">1</span></sup>, 
<br class="ltx_break">Zefan Huang<sup id="id17.17.id6" class="ltx_sup"><span id="id17.17.id6.1" class="ltx_text ltx_font_italic">1</span></sup>, Anthony Wong<sup id="id18.18.id7" class="ltx_sup"><span id="id18.18.id7.1" class="ltx_text ltx_font_italic">2</span></sup>,
Keng Peng Tee<sup id="id19.19.id8" class="ltx_sup"><span id="id19.19.id8.1" class="ltx_text ltx_font_italic">2</span></sup> and Marcelo H. Ang Jr<sup id="id20.20.id9" class="ltx_sup"><span id="id20.20.id9.1" class="ltx_text ltx_font_italic">1</span></sup>
</span><span class="ltx_author_notes"><sup id="id21.21.id1" class="ltx_sup"><span id="id21.21.id1.1" class="ltx_text ltx_font_italic">1</span></sup>Jiawei Sun, Jiahui Li, Tingchen Liu, Chengran Yuan, Shuo Sun, Zefan Huang and Marcelo H. Ang Jr. are with the Department of Mechanical
Engineering, National University of Singapore, Singapore 119077 (e-mail: {sunjiawei, e1010862, chengran.yuan, shuo.sun, huangzefan
}@u.nus.edu; mpeangh@nus.edu.sg).<sup id="id22.22.id1" class="ltx_sup"><span id="id22.22.id1.1" class="ltx_text ltx_font_italic">2</span></sup>Keng Peng Tee, Anthony Wong
are with Moovita Pte Ltd, Singapore, 599489 (e-mail: anthonywong,
kptee@moovita.com).</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id23.id1" class="ltx_p">We introduce RMP-YOLO, a unified framework designed to provide robust motion predictions even with incomplete input data.
Our key insight stems from the observation that complete and reliable historical trajectory data plays a pivotal role in ensuring accurate motion prediction. Therefore, we propose a new paradigm that prioritizes the reconstruction of intact historical trajectories before feeding them into the prediction modules. Our approach introduces a novel scene tokenization module to enhance the extraction and fusion of spatial and temporal features. Following this, our proposed recovery module reconstructs agents’ incomplete historical trajectories by leveraging local map topology and interactions with nearby agents. The reconstructed, clean historical data is then integrated into the downstream prediction modules. Our framework is able to effectively handle missing data of varying lengths and remains robust against observation noise, while maintaining high prediction accuracy. Furthermore, our recovery module is compatible with existing prediction models, ensuring seamless integration. Extensive experiments validate the effectiveness of our approach, and deployment in real-world autonomous vehicles confirms its practical utility. In the 2024 Waymo Motion Prediction Competition, our method, RMP-YOLO, achieves state-of-the-art performance, securing third place.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">INTRODUCTION</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Motion prediction is an essential module in the autonomous driving system. Recent motion prediction methods mostly adopt a learning-based approach that relies on the High-Definition (HD) lane map and the other agents’ observed historical trajectories from the upstream tracking module as inputs to predict the other agents’ future trajectories. The release of several large-scale driving datasets, including the Waymo Open Dataset<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, Argoverse 1<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, and Argoverse 2<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, has tremendously accelerated the development in learning-based prediction models. These datasets provide high-quality driving data collected in the real world, benchmarks, and public competitions to gauge the model’s performance.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2409.11696/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="242" height="156" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Example of a partially observable prediction scenario. The cyan car next to the red ego vehicle has complete trajectories, while the green truck and coral-colored vehicle are occluded. The blue car’s data is noisy, and the yellow truck has been tracked for only one timestamp. These challenges make prediction especially difficult.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, there exists a huge discrepancy between the selected agents in public datasets and those in the real world, which is caused by imperfections in the agents’ historical trajectories, as illustrated in Fig. <a href="#S1.F1" title="Figure 1 ‣ I INTRODUCTION ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. In reality, all the agents’ historical trajectories are observed from the ego vehicle’s perspective and processed by the upstream modules. Thus, unavoidably, these observed historical trajectories contain several imperfections, including 1) an insufficient number of history time steps over the period when every agent was first detected and tracked, 2) missing time steps due to out-of-view, occlusion, and ID-switch cases, and 3) the omnipresent perceptual uncertainties (noise) at all time steps. While perceptual noise is generally retained, existing public benchmarks and competitions tend to focus only on carefully selected agents with complete and high-quality historical trajectories. Non-selected agents with flawed observations are often excluded from both the supervision during training and the evaluation of model performance.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">After analyzing the data distribution of the agents’ trajectories in popular datasets, it was found that 100% of the selected agents in Argoverse 1 &amp; 2 datasets come with complete historical trajectories, while in the Waymo dataset, the selected agents have an average of 97% observable historical trajectories. This can be a serious deviation (as shown in Fig. <a href="#S1.F2" title="Figure 2 ‣ I INTRODUCTION ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) from the real-world distribution as all agents do not come with complete historical data in real life. As a result, methods trained and evaluated solely on clean datasets may perform well on leaderboards, able to predict accurately when complete historical trajectories are provided. However, without the luxury of having near-perfect historical trajectories, these methods often experience significant performance degradation due to this domain shift (see Fig.<a href="#S4.F7" title="Figure 7 ‣ IV-B1 Leaderboard ‣ IV-B Leaderboard Performance ‣ IV Experiments ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) and produce erroneous predictions in real deployments. To bridge the gap between training with sanitized data and the deployment in real life with noisy, imperfect data, it is critical to develop models that are robust to data imperfections.</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2409.11696/assets/x2.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="115" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Distributions of selected agents vs. non-selected agents in Waymo, Argoverse 1&amp;2 datasets.</figcaption>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In this paper, we propose the RMP-YOLO framework, which offers three key advantages simultaneously: it maintains excellent prediction performance, effectively handles varying distinct missing input lengths, and remains robust against noisy inputs. Remarkably, it can still provide accurate predictions even when the target has just entered the ego agent’s perceptive field with only a single timestamp of valid data. Our key insight is that since complete and noise-free historical trajectories are crucial for accurate motion prediction, it makes sense to prioritize their reconstruction first.
By leveraging local topological map structures and the relationships between nearby agents, even a limited number of observed timesteps, sometimes just a single valid frame, can provide valuable cues for the reconstruction. These local relationships enable us to more accurately infer the complete historical trajectory, thereby improving predictions for future motion. To achieve this, we introduce a simple MLP-based recovery module combined with one layer of local attention transformer to reconstruct the historical trajectories. Our contributions are summarized as follows:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.ix1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1)</span> 
<div id="S1.I1.ix1.p1" class="ltx_para">
<p id="S1.I1.ix1.p1.1" class="ltx_p">We introduce RMP-YOLO, a novel framework that prioritizes reconstructing agents’ incomplete historical trajectories by leveraging local map topology and agent interactions. This reconstruction process effectively handles varying lengths of missing data, ensuring robustness against noise and incomplete observations.</p>
</div>
</li>
<li id="S1.I1.ix2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2)</span> 
<div id="S1.I1.ix2.p1" class="ltx_para">
<p id="S1.I1.ix2.p1.1" class="ltx_p">The recovery module we propose is simple and lightweight. Moreover, it integrates seamlessly with existing motion prediction models, enhancing their robustness without the need for extensive modifications.</p>
</div>
</li>
<li id="S1.I1.ix3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3)</span> 
<div id="S1.I1.ix3.p1" class="ltx_para">
<p id="S1.I1.ix3.p1.1" class="ltx_p">Our method won third place in the 2024 Waymo Motion Prediction Competition. We deploy our algorithms on real vehicles to validate the effectiveness of our methods. We will open-source our code to support the robotics community after the paper is accepted.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Works</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Motion Prediction</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Recent advancements<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> in multi-agent motion prediction have introduced several innovative approaches aimed at improving prediction accuracy and efficiency. Among these, two of the most influential prediction paradigms are MTR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> and QCNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. MTR addresses the trade-off between goal-based prediction<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> and direct regression-based<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> prediction, by its proposed motion query pairs, while QCNet proposes a symmetric<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, translation-invarnt<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> input representation which enables reusable stream prediction.
Plenty derivative works have expanded on these foundational approaches, including EDA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, MTR++ <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, ControlMTR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, SIMPL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, MGTR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, and others <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>.
However, a common limitation shared by these methods is that they are typically trained on nearly complete input trajectories. As a result, their performance may degrade when confronted with imperfect or incomplete data during inference (see Fig.<a href="#S4.F7" title="Figure 7 ‣ IV-B1 Leaderboard ‣ IV-B Leaderboard Performance ‣ IV Experiments ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>). To address this, we propose the RMP-YOLO framework, building upon MTR, to effectively handle input data imperfections while maintaining high prediction accuracy.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Imperfect Data Recovery</span>
</h3>

<figure id="S2.F3" class="ltx_figure"><img src="/html/2409.11696/assets/figs/relatedworks.png" id="S2.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="658" height="347" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Generalized pipeline for previous methods addressing partially observable historical trajectories.</figcaption>
</figure>
<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Previous works tackling imperfect data generally focus on either incomplete input trajectories<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> or noisy input data<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. To handle incomplete input data, self-supervised learning and feature distillation are commonly employed techniques. A generalized pipeline for this kind of methods is illustrated in Fig.<a href="#S2.F3" title="Figure 3 ‣ II-B Imperfect Data Recovery ‣ II Related Works ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. SSL-Lanes<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> and Forecast-MAE<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> are pioneering works utilizing SSL techniques for vehicle motion prediction tasks. During the pre-training stage, various masking strategies are applied to the agent and map polylines, and the encoder is trained to reconstruct the missing data. In the fine-tuning stage, the reconstruction heads are removed and the encoder is frozen; the decoder is then trained with complete data for the specific prediction task. However, this can cause the decoder to under-perform when faced with incomplete historical trajectories despite the encoder’s exposure to such data during pre-training.</p>
</div>
<figure id="S2.F4" class="ltx_figure"><img src="/html/2409.11696/assets/x3.png" id="S2.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="484" height="172" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Overview of the proposed pipeline. The history recovery is conducted in the early stage of the encoder. Compared to previous pipelines, our proposed framework has a more concise structure and can be trained in an end-to-end fashion.</figcaption>
</figure>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">For feature distillation method<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, a well-trained teacher model using complete input trajectories guides a student model using incomplete input trajectories. POP<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> combines both methods to address partially observable prediction. While effective, this approach is complex, computationally expensive, and relies heavily on the quality of the teacher model. Some studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> have investigated enhancing the robustness of predictors against input noise from the perspective of data poisoning. However, these approaches often overlook the impact of incomplete trajectories. Unlike previous methods, we propose a unified framework that explicitly recovers clean historical trajectories in the encoder stage and integrates this new information back into the agent tokens for further information fusion. As a result, our approach is robust to both noisy and incomplete data while maintaining excellent prediction performance. Additionally, our proposed recovery module is lightweight and plug-and-play.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Methodology</span>
</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Problem Formulation and Input Representation</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.17" class="ltx_p">Following MTR, we adopt an vectorized representation for both maps and agents. And our focus is on marginal motion prediction.
The historical trajectories of <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="{N_{a}}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">N</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">a</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑁</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">{N_{a}}</annotation></semantics></math> traffic participants are denoted as <math id="S3.SS1.p1.2.m2.4" class="ltx_Math" alttext="\mathcal{A}=\{a_{1},a_{2},\dots,a_{N_{a}}\}" display="inline"><semantics id="S3.SS1.p1.2.m2.4a"><mrow id="S3.SS1.p1.2.m2.4.4" xref="S3.SS1.p1.2.m2.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.4.4.5" xref="S3.SS1.p1.2.m2.4.4.5.cmml">𝒜</mi><mo id="S3.SS1.p1.2.m2.4.4.4" xref="S3.SS1.p1.2.m2.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.4.4.3.3" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.4.4.3.3.4" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml">a</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.4.4.3.3.5" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml">a</mi><mn id="S3.SS1.p1.2.m2.3.3.2.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.2.m2.4.4.3.3.6" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.4.4.3.3.7" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.2.m2.4.4.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.3.2.cmml">a</mi><msub id="S3.SS1.p1.2.m2.4.4.3.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml"><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.3.2" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.2.cmml">N</mi><mi id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.cmml">a</mi></msub></msub><mo stretchy="false" id="S3.SS1.p1.2.m2.4.4.3.3.8" xref="S3.SS1.p1.2.m2.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.4b"><apply id="S3.SS1.p1.2.m2.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4"><eq id="S3.SS1.p1.2.m2.4.4.4.cmml" xref="S3.SS1.p1.2.m2.4.4.4"></eq><ci id="S3.SS1.p1.2.m2.4.4.5.cmml" xref="S3.SS1.p1.2.m2.4.4.5">𝒜</ci><set id="S3.SS1.p1.2.m2.4.4.3.4.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3"><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2">𝑎</ci><cn type="integer" id="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.2">𝑎</ci><cn type="integer" id="S3.SS1.p1.2.m2.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.4.4.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.2">𝑎</ci><apply id="S3.SS1.p1.2.m2.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.4.4.3.3.3.3.1.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.3.2.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.2">𝑁</ci><ci id="S3.SS1.p1.2.m2.4.4.3.3.3.3.3.cmml" xref="S3.SS1.p1.2.m2.4.4.3.3.3.3.3">𝑎</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.4c">\mathcal{A}=\{a_{1},a_{2},\dots,a_{N_{a}}\}</annotation></semantics></math>, where each agent <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="a_{i}\in\mathbb{R}^{T_{p}\times F_{1}}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><msub id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2.2" xref="S3.SS1.p1.3.m3.1.1.2.2.cmml">a</mi><mi id="S3.SS1.p1.3.m3.1.1.2.3" xref="S3.SS1.p1.3.m3.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml"><msub id="S3.SS1.p1.3.m3.1.1.3.3.2" xref="S3.SS1.p1.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.3.2.2" xref="S3.SS1.p1.3.m3.1.1.3.3.2.2.cmml">T</mi><mi id="S3.SS1.p1.3.m3.1.1.3.3.2.3" xref="S3.SS1.p1.3.m3.1.1.3.3.2.3.cmml">p</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.3.m3.1.1.3.3.1" xref="S3.SS1.p1.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p1.3.m3.1.1.3.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.3.3.2" xref="S3.SS1.p1.3.m3.1.1.3.3.3.2.cmml">F</mi><mn id="S3.SS1.p1.3.m3.1.1.3.3.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.3.3.cmml">1</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></in><apply id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2.2">𝑎</ci><ci id="S3.SS1.p1.3.m3.1.1.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3"><times id="S3.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.1"></times><apply id="S3.SS1.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2.2">𝑇</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2.3">𝑝</ci></apply><apply id="S3.SS1.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3.2">𝐹</ci><cn type="integer" id="S3.SS1.p1.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">a_{i}\in\mathbb{R}^{T_{p}\times F_{1}}</annotation></semantics></math> has <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="T_{p}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">T</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑇</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">T_{p}</annotation></semantics></math> past timesteps and <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="F_{1}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><msub id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">F</mi><mn id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝐹</ci><cn type="integer" id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">F_{1}</annotation></semantics></math> feature dimensions. The corresponding map is partitioned into <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="N_{l}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">N</mi><mi id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑁</ci><ci id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">N_{l}</annotation></semantics></math> polylines <math id="S3.SS1.p1.7.m7.4" class="ltx_Math" alttext="\mathcal{M}=\{m_{1},m_{2},\dots,m_{N_{l}}\}" display="inline"><semantics id="S3.SS1.p1.7.m7.4a"><mrow id="S3.SS1.p1.7.m7.4.4" xref="S3.SS1.p1.7.m7.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.4.4.5" xref="S3.SS1.p1.7.m7.4.4.5.cmml">ℳ</mi><mo id="S3.SS1.p1.7.m7.4.4.4" xref="S3.SS1.p1.7.m7.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.7.m7.4.4.3.3" xref="S3.SS1.p1.7.m7.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m7.4.4.3.3.4" xref="S3.SS1.p1.7.m7.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.7.m7.2.2.1.1.1" xref="S3.SS1.p1.7.m7.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.7.m7.2.2.1.1.1.2" xref="S3.SS1.p1.7.m7.2.2.1.1.1.2.cmml">m</mi><mn id="S3.SS1.p1.7.m7.2.2.1.1.1.3" xref="S3.SS1.p1.7.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.7.m7.4.4.3.3.5" xref="S3.SS1.p1.7.m7.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.7.m7.3.3.2.2.2" xref="S3.SS1.p1.7.m7.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.7.m7.3.3.2.2.2.2" xref="S3.SS1.p1.7.m7.3.3.2.2.2.2.cmml">m</mi><mn id="S3.SS1.p1.7.m7.3.3.2.2.2.3" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.7.m7.4.4.3.3.6" xref="S3.SS1.p1.7.m7.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">…</mi><mo id="S3.SS1.p1.7.m7.4.4.3.3.7" xref="S3.SS1.p1.7.m7.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.7.m7.4.4.3.3.3" xref="S3.SS1.p1.7.m7.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.7.m7.4.4.3.3.3.2" xref="S3.SS1.p1.7.m7.4.4.3.3.3.2.cmml">m</mi><msub id="S3.SS1.p1.7.m7.4.4.3.3.3.3" xref="S3.SS1.p1.7.m7.4.4.3.3.3.3.cmml"><mi id="S3.SS1.p1.7.m7.4.4.3.3.3.3.2" xref="S3.SS1.p1.7.m7.4.4.3.3.3.3.2.cmml">N</mi><mi id="S3.SS1.p1.7.m7.4.4.3.3.3.3.3" xref="S3.SS1.p1.7.m7.4.4.3.3.3.3.3.cmml">l</mi></msub></msub><mo stretchy="false" id="S3.SS1.p1.7.m7.4.4.3.3.8" xref="S3.SS1.p1.7.m7.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.4b"><apply id="S3.SS1.p1.7.m7.4.4.cmml" xref="S3.SS1.p1.7.m7.4.4"><eq id="S3.SS1.p1.7.m7.4.4.4.cmml" xref="S3.SS1.p1.7.m7.4.4.4"></eq><ci id="S3.SS1.p1.7.m7.4.4.5.cmml" xref="S3.SS1.p1.7.m7.4.4.5">ℳ</ci><set id="S3.SS1.p1.7.m7.4.4.3.4.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3"><apply id="S3.SS1.p1.7.m7.2.2.1.1.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1.2">𝑚</ci><cn type="integer" id="S3.SS1.p1.7.m7.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.7.m7.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.7.m7.3.3.2.2.2.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.7.m7.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2.2">𝑚</ci><cn type="integer" id="S3.SS1.p1.7.m7.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.7.m7.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">…</ci><apply id="S3.SS1.p1.7.m7.4.4.3.3.3.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3.3.2">𝑚</ci><apply id="S3.SS1.p1.7.m7.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.4.4.3.3.3.3.1.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.7.m7.4.4.3.3.3.3.2.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3.3.3.2">𝑁</ci><ci id="S3.SS1.p1.7.m7.4.4.3.3.3.3.3.cmml" xref="S3.SS1.p1.7.m7.4.4.3.3.3.3.3">𝑙</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.4c">\mathcal{M}=\{m_{1},m_{2},\dots,m_{N_{l}}\}</annotation></semantics></math>, with each polyline <math id="S3.SS1.p1.8.m8.1" class="ltx_Math" alttext="m_{i}\in\mathbb{R}^{N_{p}\times F_{2}}" display="inline"><semantics id="S3.SS1.p1.8.m8.1a"><mrow id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><msub id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2.2" xref="S3.SS1.p1.8.m8.1.1.2.2.cmml">m</mi><mi id="S3.SS1.p1.8.m8.1.1.2.3" xref="S3.SS1.p1.8.m8.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.p1.8.m8.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml"><mi id="S3.SS1.p1.8.m8.1.1.3.2" xref="S3.SS1.p1.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.8.m8.1.1.3.3" xref="S3.SS1.p1.8.m8.1.1.3.3.cmml"><msub id="S3.SS1.p1.8.m8.1.1.3.3.2" xref="S3.SS1.p1.8.m8.1.1.3.3.2.cmml"><mi id="S3.SS1.p1.8.m8.1.1.3.3.2.2" xref="S3.SS1.p1.8.m8.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.p1.8.m8.1.1.3.3.2.3" xref="S3.SS1.p1.8.m8.1.1.3.3.2.3.cmml">p</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.8.m8.1.1.3.3.1" xref="S3.SS1.p1.8.m8.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p1.8.m8.1.1.3.3.3" xref="S3.SS1.p1.8.m8.1.1.3.3.3.cmml"><mi id="S3.SS1.p1.8.m8.1.1.3.3.3.2" xref="S3.SS1.p1.8.m8.1.1.3.3.3.2.cmml">F</mi><mn id="S3.SS1.p1.8.m8.1.1.3.3.3.3" xref="S3.SS1.p1.8.m8.1.1.3.3.3.3.cmml">2</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><in id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1"></in><apply id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2.2">𝑚</ci><ci id="S3.SS1.p1.8.m8.1.1.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3"><times id="S3.SS1.p1.8.m8.1.1.3.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.1"></times><apply id="S3.SS1.p1.8.m8.1.1.3.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.3.3.2.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.3.3.2.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.p1.8.m8.1.1.3.3.2.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.2.3">𝑝</ci></apply><apply id="S3.SS1.p1.8.m8.1.1.3.3.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.3.3.3.1.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.3.3.3.2.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.3.2">𝐹</ci><cn type="integer" id="S3.SS1.p1.8.m8.1.1.3.3.3.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">m_{i}\in\mathbb{R}^{N_{p}\times F_{2}}</annotation></semantics></math> comprising <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="N_{p}" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><msub id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml"><mi id="S3.SS1.p1.9.m9.1.1.2" xref="S3.SS1.p1.9.m9.1.1.2.cmml">N</mi><mi id="S3.SS1.p1.9.m9.1.1.3" xref="S3.SS1.p1.9.m9.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><apply id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.p1.9.m9.1.1.2">𝑁</ci><ci id="S3.SS1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.p1.9.m9.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">N_{p}</annotation></semantics></math> points and <math id="S3.SS1.p1.10.m10.1" class="ltx_Math" alttext="F_{2}" display="inline"><semantics id="S3.SS1.p1.10.m10.1a"><msub id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">F</mi><mn id="S3.SS1.p1.10.m10.1.1.3" xref="S3.SS1.p1.10.m10.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝐹</ci><cn type="integer" id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">F_{2}</annotation></semantics></math> feature dimensions. The predictor will anticipate <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">K</annotation></semantics></math> different modality future trajectories <math id="S3.SS1.p1.12.m12.4" class="ltx_Math" alttext="\mathcal{Z}=\{z_{1},z_{2},\dots,z_{N_{a}}\}" display="inline"><semantics id="S3.SS1.p1.12.m12.4a"><mrow id="S3.SS1.p1.12.m12.4.4" xref="S3.SS1.p1.12.m12.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.12.m12.4.4.5" xref="S3.SS1.p1.12.m12.4.4.5.cmml">𝒵</mi><mo id="S3.SS1.p1.12.m12.4.4.4" xref="S3.SS1.p1.12.m12.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.12.m12.4.4.3.3" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.12.m12.4.4.3.3.4" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p1.12.m12.2.2.1.1.1" xref="S3.SS1.p1.12.m12.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.12.m12.2.2.1.1.1.2" xref="S3.SS1.p1.12.m12.2.2.1.1.1.2.cmml">z</mi><mn id="S3.SS1.p1.12.m12.2.2.1.1.1.3" xref="S3.SS1.p1.12.m12.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.12.m12.4.4.3.3.5" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.12.m12.3.3.2.2.2" xref="S3.SS1.p1.12.m12.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.12.m12.3.3.2.2.2.2" xref="S3.SS1.p1.12.m12.3.3.2.2.2.2.cmml">z</mi><mn id="S3.SS1.p1.12.m12.3.3.2.2.2.3" xref="S3.SS1.p1.12.m12.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p1.12.m12.4.4.3.3.6" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">…</mi><mo id="S3.SS1.p1.12.m12.4.4.3.3.7" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p1.12.m12.4.4.3.3.3" xref="S3.SS1.p1.12.m12.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.12.m12.4.4.3.3.3.2" xref="S3.SS1.p1.12.m12.4.4.3.3.3.2.cmml">z</mi><msub id="S3.SS1.p1.12.m12.4.4.3.3.3.3" xref="S3.SS1.p1.12.m12.4.4.3.3.3.3.cmml"><mi id="S3.SS1.p1.12.m12.4.4.3.3.3.3.2" xref="S3.SS1.p1.12.m12.4.4.3.3.3.3.2.cmml">N</mi><mi id="S3.SS1.p1.12.m12.4.4.3.3.3.3.3" xref="S3.SS1.p1.12.m12.4.4.3.3.3.3.3.cmml">a</mi></msub></msub><mo stretchy="false" id="S3.SS1.p1.12.m12.4.4.3.3.8" xref="S3.SS1.p1.12.m12.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.4b"><apply id="S3.SS1.p1.12.m12.4.4.cmml" xref="S3.SS1.p1.12.m12.4.4"><eq id="S3.SS1.p1.12.m12.4.4.4.cmml" xref="S3.SS1.p1.12.m12.4.4.4"></eq><ci id="S3.SS1.p1.12.m12.4.4.5.cmml" xref="S3.SS1.p1.12.m12.4.4.5">𝒵</ci><set id="S3.SS1.p1.12.m12.4.4.3.4.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3"><apply id="S3.SS1.p1.12.m12.2.2.1.1.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.2">𝑧</ci><cn type="integer" id="S3.SS1.p1.12.m12.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.12.m12.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.12.m12.3.3.2.2.2.cmml" xref="S3.SS1.p1.12.m12.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.12.m12.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.12.m12.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.12.m12.3.3.2.2.2.2">𝑧</ci><cn type="integer" id="S3.SS1.p1.12.m12.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.12.m12.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">…</ci><apply id="S3.SS1.p1.12.m12.4.4.3.3.3.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.12.m12.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3.2">𝑧</ci><apply id="S3.SS1.p1.12.m12.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.4.4.3.3.3.3.1.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.12.m12.4.4.3.3.3.3.2.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3.3.2">𝑁</ci><ci id="S3.SS1.p1.12.m12.4.4.3.3.3.3.3.cmml" xref="S3.SS1.p1.12.m12.4.4.3.3.3.3.3">𝑎</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.4c">\mathcal{Z}=\{z_{1},z_{2},\dots,z_{N_{a}}\}</annotation></semantics></math> over the future <math id="S3.SS1.p1.13.m13.1" class="ltx_Math" alttext="T_{f}" display="inline"><semantics id="S3.SS1.p1.13.m13.1a"><msub id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">T</mi><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝑇</ci><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">T_{f}</annotation></semantics></math> timesteps, where <math id="S3.SS1.p1.14.m14.4" class="ltx_Math" alttext="z_{i}=\{z_{i}^{1},z_{i}^{2},\dots,z_{i}^{K}\}\in\mathbb{R}^{K\times T_{f}\times D}" display="inline"><semantics id="S3.SS1.p1.14.m14.4a"><mrow id="S3.SS1.p1.14.m14.4.4" xref="S3.SS1.p1.14.m14.4.4.cmml"><msub id="S3.SS1.p1.14.m14.4.4.5" xref="S3.SS1.p1.14.m14.4.4.5.cmml"><mi id="S3.SS1.p1.14.m14.4.4.5.2" xref="S3.SS1.p1.14.m14.4.4.5.2.cmml">z</mi><mi id="S3.SS1.p1.14.m14.4.4.5.3" xref="S3.SS1.p1.14.m14.4.4.5.3.cmml">i</mi></msub><mo id="S3.SS1.p1.14.m14.4.4.6" xref="S3.SS1.p1.14.m14.4.4.6.cmml">=</mo><mrow id="S3.SS1.p1.14.m14.4.4.3.3" xref="S3.SS1.p1.14.m14.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.14.m14.4.4.3.3.4" xref="S3.SS1.p1.14.m14.4.4.3.4.cmml">{</mo><msubsup id="S3.SS1.p1.14.m14.2.2.1.1.1" xref="S3.SS1.p1.14.m14.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.14.m14.2.2.1.1.1.2.2" xref="S3.SS1.p1.14.m14.2.2.1.1.1.2.2.cmml">z</mi><mi id="S3.SS1.p1.14.m14.2.2.1.1.1.2.3" xref="S3.SS1.p1.14.m14.2.2.1.1.1.2.3.cmml">i</mi><mn id="S3.SS1.p1.14.m14.2.2.1.1.1.3" xref="S3.SS1.p1.14.m14.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.p1.14.m14.4.4.3.3.5" xref="S3.SS1.p1.14.m14.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.14.m14.3.3.2.2.2" xref="S3.SS1.p1.14.m14.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.14.m14.3.3.2.2.2.2.2" xref="S3.SS1.p1.14.m14.3.3.2.2.2.2.2.cmml">z</mi><mi id="S3.SS1.p1.14.m14.3.3.2.2.2.2.3" xref="S3.SS1.p1.14.m14.3.3.2.2.2.2.3.cmml">i</mi><mn id="S3.SS1.p1.14.m14.3.3.2.2.2.3" xref="S3.SS1.p1.14.m14.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p1.14.m14.4.4.3.3.6" xref="S3.SS1.p1.14.m14.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml">…</mi><mo id="S3.SS1.p1.14.m14.4.4.3.3.7" xref="S3.SS1.p1.14.m14.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.14.m14.4.4.3.3.3" xref="S3.SS1.p1.14.m14.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.14.m14.4.4.3.3.3.2.2" xref="S3.SS1.p1.14.m14.4.4.3.3.3.2.2.cmml">z</mi><mi id="S3.SS1.p1.14.m14.4.4.3.3.3.2.3" xref="S3.SS1.p1.14.m14.4.4.3.3.3.2.3.cmml">i</mi><mi id="S3.SS1.p1.14.m14.4.4.3.3.3.3" xref="S3.SS1.p1.14.m14.4.4.3.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS1.p1.14.m14.4.4.3.3.8" xref="S3.SS1.p1.14.m14.4.4.3.4.cmml">}</mo></mrow><mo id="S3.SS1.p1.14.m14.4.4.7" xref="S3.SS1.p1.14.m14.4.4.7.cmml">∈</mo><msup id="S3.SS1.p1.14.m14.4.4.8" xref="S3.SS1.p1.14.m14.4.4.8.cmml"><mi id="S3.SS1.p1.14.m14.4.4.8.2" xref="S3.SS1.p1.14.m14.4.4.8.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.14.m14.4.4.8.3" xref="S3.SS1.p1.14.m14.4.4.8.3.cmml"><mi id="S3.SS1.p1.14.m14.4.4.8.3.2" xref="S3.SS1.p1.14.m14.4.4.8.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.14.m14.4.4.8.3.1" xref="S3.SS1.p1.14.m14.4.4.8.3.1.cmml">×</mo><msub id="S3.SS1.p1.14.m14.4.4.8.3.3" xref="S3.SS1.p1.14.m14.4.4.8.3.3.cmml"><mi id="S3.SS1.p1.14.m14.4.4.8.3.3.2" xref="S3.SS1.p1.14.m14.4.4.8.3.3.2.cmml">T</mi><mi id="S3.SS1.p1.14.m14.4.4.8.3.3.3" xref="S3.SS1.p1.14.m14.4.4.8.3.3.3.cmml">f</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.14.m14.4.4.8.3.1a" xref="S3.SS1.p1.14.m14.4.4.8.3.1.cmml">×</mo><mi id="S3.SS1.p1.14.m14.4.4.8.3.4" xref="S3.SS1.p1.14.m14.4.4.8.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.4b"><apply id="S3.SS1.p1.14.m14.4.4.cmml" xref="S3.SS1.p1.14.m14.4.4"><and id="S3.SS1.p1.14.m14.4.4a.cmml" xref="S3.SS1.p1.14.m14.4.4"></and><apply id="S3.SS1.p1.14.m14.4.4b.cmml" xref="S3.SS1.p1.14.m14.4.4"><eq id="S3.SS1.p1.14.m14.4.4.6.cmml" xref="S3.SS1.p1.14.m14.4.4.6"></eq><apply id="S3.SS1.p1.14.m14.4.4.5.cmml" xref="S3.SS1.p1.14.m14.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.4.4.5.1.cmml" xref="S3.SS1.p1.14.m14.4.4.5">subscript</csymbol><ci id="S3.SS1.p1.14.m14.4.4.5.2.cmml" xref="S3.SS1.p1.14.m14.4.4.5.2">𝑧</ci><ci id="S3.SS1.p1.14.m14.4.4.5.3.cmml" xref="S3.SS1.p1.14.m14.4.4.5.3">𝑖</ci></apply><set id="S3.SS1.p1.14.m14.4.4.3.4.cmml" xref="S3.SS1.p1.14.m14.4.4.3.3"><apply id="S3.SS1.p1.14.m14.2.2.1.1.1.cmml" xref="S3.SS1.p1.14.m14.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.14.m14.2.2.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.14.m14.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.14.m14.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p1.14.m14.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.14.m14.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p1.14.m14.2.2.1.1.1.2.2">𝑧</ci><ci id="S3.SS1.p1.14.m14.2.2.1.1.1.2.3.cmml" xref="S3.SS1.p1.14.m14.2.2.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS1.p1.14.m14.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.14.m14.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.14.m14.3.3.2.2.2.cmml" xref="S3.SS1.p1.14.m14.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.14.m14.3.3.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.14.m14.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.14.m14.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p1.14.m14.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.14.m14.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p1.14.m14.3.3.2.2.2.2.2">𝑧</ci><ci id="S3.SS1.p1.14.m14.3.3.2.2.2.2.3.cmml" xref="S3.SS1.p1.14.m14.3.3.2.2.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS1.p1.14.m14.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.14.m14.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">…</ci><apply id="S3.SS1.p1.14.m14.4.4.3.3.3.cmml" xref="S3.SS1.p1.14.m14.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.14.m14.4.4.3.3.3">superscript</csymbol><apply id="S3.SS1.p1.14.m14.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.14.m14.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.4.4.3.3.3.2.1.cmml" xref="S3.SS1.p1.14.m14.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.14.m14.4.4.3.3.3.2.2.cmml" xref="S3.SS1.p1.14.m14.4.4.3.3.3.2.2">𝑧</ci><ci id="S3.SS1.p1.14.m14.4.4.3.3.3.2.3.cmml" xref="S3.SS1.p1.14.m14.4.4.3.3.3.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.14.m14.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.14.m14.4.4.3.3.3.3">𝐾</ci></apply></set></apply><apply id="S3.SS1.p1.14.m14.4.4c.cmml" xref="S3.SS1.p1.14.m14.4.4"><in id="S3.SS1.p1.14.m14.4.4.7.cmml" xref="S3.SS1.p1.14.m14.4.4.7"></in><share href="#S3.SS1.p1.14.m14.4.4.3.cmml" id="S3.SS1.p1.14.m14.4.4d.cmml" xref="S3.SS1.p1.14.m14.4.4"></share><apply id="S3.SS1.p1.14.m14.4.4.8.cmml" xref="S3.SS1.p1.14.m14.4.4.8"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.4.4.8.1.cmml" xref="S3.SS1.p1.14.m14.4.4.8">superscript</csymbol><ci id="S3.SS1.p1.14.m14.4.4.8.2.cmml" xref="S3.SS1.p1.14.m14.4.4.8.2">ℝ</ci><apply id="S3.SS1.p1.14.m14.4.4.8.3.cmml" xref="S3.SS1.p1.14.m14.4.4.8.3"><times id="S3.SS1.p1.14.m14.4.4.8.3.1.cmml" xref="S3.SS1.p1.14.m14.4.4.8.3.1"></times><ci id="S3.SS1.p1.14.m14.4.4.8.3.2.cmml" xref="S3.SS1.p1.14.m14.4.4.8.3.2">𝐾</ci><apply id="S3.SS1.p1.14.m14.4.4.8.3.3.cmml" xref="S3.SS1.p1.14.m14.4.4.8.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.14.m14.4.4.8.3.3.1.cmml" xref="S3.SS1.p1.14.m14.4.4.8.3.3">subscript</csymbol><ci id="S3.SS1.p1.14.m14.4.4.8.3.3.2.cmml" xref="S3.SS1.p1.14.m14.4.4.8.3.3.2">𝑇</ci><ci id="S3.SS1.p1.14.m14.4.4.8.3.3.3.cmml" xref="S3.SS1.p1.14.m14.4.4.8.3.3.3">𝑓</ci></apply><ci id="S3.SS1.p1.14.m14.4.4.8.3.4.cmml" xref="S3.SS1.p1.14.m14.4.4.8.3.4">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.4c">z_{i}=\{z_{i}^{1},z_{i}^{2},\dots,z_{i}^{K}\}\in\mathbb{R}^{K\times T_{f}\times D}</annotation></semantics></math>. The confidence score for <math id="S3.SS1.p1.15.m15.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS1.p1.15.m15.1a"><msub id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">z</mi><mi id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">𝑧</ci><ci id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">z_{i}</annotation></semantics></math> are denoted as <math id="S3.SS1.p1.16.m16.4" class="ltx_Math" alttext="p_{i}=\{p_{i}^{1},p_{i}^{2},\dots,p_{i}^{K}\}" display="inline"><semantics id="S3.SS1.p1.16.m16.4a"><mrow id="S3.SS1.p1.16.m16.4.4" xref="S3.SS1.p1.16.m16.4.4.cmml"><msub id="S3.SS1.p1.16.m16.4.4.5" xref="S3.SS1.p1.16.m16.4.4.5.cmml"><mi id="S3.SS1.p1.16.m16.4.4.5.2" xref="S3.SS1.p1.16.m16.4.4.5.2.cmml">p</mi><mi id="S3.SS1.p1.16.m16.4.4.5.3" xref="S3.SS1.p1.16.m16.4.4.5.3.cmml">i</mi></msub><mo id="S3.SS1.p1.16.m16.4.4.4" xref="S3.SS1.p1.16.m16.4.4.4.cmml">=</mo><mrow id="S3.SS1.p1.16.m16.4.4.3.3" xref="S3.SS1.p1.16.m16.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p1.16.m16.4.4.3.3.4" xref="S3.SS1.p1.16.m16.4.4.3.4.cmml">{</mo><msubsup id="S3.SS1.p1.16.m16.2.2.1.1.1" xref="S3.SS1.p1.16.m16.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.16.m16.2.2.1.1.1.2.2" xref="S3.SS1.p1.16.m16.2.2.1.1.1.2.2.cmml">p</mi><mi id="S3.SS1.p1.16.m16.2.2.1.1.1.2.3" xref="S3.SS1.p1.16.m16.2.2.1.1.1.2.3.cmml">i</mi><mn id="S3.SS1.p1.16.m16.2.2.1.1.1.3" xref="S3.SS1.p1.16.m16.2.2.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.SS1.p1.16.m16.4.4.3.3.5" xref="S3.SS1.p1.16.m16.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.16.m16.3.3.2.2.2" xref="S3.SS1.p1.16.m16.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.16.m16.3.3.2.2.2.2.2" xref="S3.SS1.p1.16.m16.3.3.2.2.2.2.2.cmml">p</mi><mi id="S3.SS1.p1.16.m16.3.3.2.2.2.2.3" xref="S3.SS1.p1.16.m16.3.3.2.2.2.2.3.cmml">i</mi><mn id="S3.SS1.p1.16.m16.3.3.2.2.2.3" xref="S3.SS1.p1.16.m16.3.3.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.SS1.p1.16.m16.4.4.3.3.6" xref="S3.SS1.p1.16.m16.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml">…</mi><mo id="S3.SS1.p1.16.m16.4.4.3.3.7" xref="S3.SS1.p1.16.m16.4.4.3.4.cmml">,</mo><msubsup id="S3.SS1.p1.16.m16.4.4.3.3.3" xref="S3.SS1.p1.16.m16.4.4.3.3.3.cmml"><mi id="S3.SS1.p1.16.m16.4.4.3.3.3.2.2" xref="S3.SS1.p1.16.m16.4.4.3.3.3.2.2.cmml">p</mi><mi id="S3.SS1.p1.16.m16.4.4.3.3.3.2.3" xref="S3.SS1.p1.16.m16.4.4.3.3.3.2.3.cmml">i</mi><mi id="S3.SS1.p1.16.m16.4.4.3.3.3.3" xref="S3.SS1.p1.16.m16.4.4.3.3.3.3.cmml">K</mi></msubsup><mo stretchy="false" id="S3.SS1.p1.16.m16.4.4.3.3.8" xref="S3.SS1.p1.16.m16.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.4b"><apply id="S3.SS1.p1.16.m16.4.4.cmml" xref="S3.SS1.p1.16.m16.4.4"><eq id="S3.SS1.p1.16.m16.4.4.4.cmml" xref="S3.SS1.p1.16.m16.4.4.4"></eq><apply id="S3.SS1.p1.16.m16.4.4.5.cmml" xref="S3.SS1.p1.16.m16.4.4.5"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.4.4.5.1.cmml" xref="S3.SS1.p1.16.m16.4.4.5">subscript</csymbol><ci id="S3.SS1.p1.16.m16.4.4.5.2.cmml" xref="S3.SS1.p1.16.m16.4.4.5.2">𝑝</ci><ci id="S3.SS1.p1.16.m16.4.4.5.3.cmml" xref="S3.SS1.p1.16.m16.4.4.5.3">𝑖</ci></apply><set id="S3.SS1.p1.16.m16.4.4.3.4.cmml" xref="S3.SS1.p1.16.m16.4.4.3.3"><apply id="S3.SS1.p1.16.m16.2.2.1.1.1.cmml" xref="S3.SS1.p1.16.m16.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.16.m16.2.2.1.1.1">superscript</csymbol><apply id="S3.SS1.p1.16.m16.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.16.m16.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.2.2.1.1.1.2.1.cmml" xref="S3.SS1.p1.16.m16.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.16.m16.2.2.1.1.1.2.2.cmml" xref="S3.SS1.p1.16.m16.2.2.1.1.1.2.2">𝑝</ci><ci id="S3.SS1.p1.16.m16.2.2.1.1.1.2.3.cmml" xref="S3.SS1.p1.16.m16.2.2.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS1.p1.16.m16.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.16.m16.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p1.16.m16.3.3.2.2.2.cmml" xref="S3.SS1.p1.16.m16.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.16.m16.3.3.2.2.2">superscript</csymbol><apply id="S3.SS1.p1.16.m16.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.16.m16.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.3.3.2.2.2.2.1.cmml" xref="S3.SS1.p1.16.m16.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.16.m16.3.3.2.2.2.2.2.cmml" xref="S3.SS1.p1.16.m16.3.3.2.2.2.2.2">𝑝</ci><ci id="S3.SS1.p1.16.m16.3.3.2.2.2.2.3.cmml" xref="S3.SS1.p1.16.m16.3.3.2.2.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.SS1.p1.16.m16.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.16.m16.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">…</ci><apply id="S3.SS1.p1.16.m16.4.4.3.3.3.cmml" xref="S3.SS1.p1.16.m16.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.4.4.3.3.3.1.cmml" xref="S3.SS1.p1.16.m16.4.4.3.3.3">superscript</csymbol><apply id="S3.SS1.p1.16.m16.4.4.3.3.3.2.cmml" xref="S3.SS1.p1.16.m16.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.16.m16.4.4.3.3.3.2.1.cmml" xref="S3.SS1.p1.16.m16.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.16.m16.4.4.3.3.3.2.2.cmml" xref="S3.SS1.p1.16.m16.4.4.3.3.3.2.2">𝑝</ci><ci id="S3.SS1.p1.16.m16.4.4.3.3.3.2.3.cmml" xref="S3.SS1.p1.16.m16.4.4.3.3.3.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.16.m16.4.4.3.3.3.3.cmml" xref="S3.SS1.p1.16.m16.4.4.3.3.3.3">𝐾</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.4c">p_{i}=\{p_{i}^{1},p_{i}^{2},\dots,p_{i}^{K}\}</annotation></semantics></math>.
Then for selected agent <math id="S3.SS1.p1.17.m17.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="S3.SS1.p1.17.m17.1a"><msub id="S3.SS1.p1.17.m17.1.1" xref="S3.SS1.p1.17.m17.1.1.cmml"><mi id="S3.SS1.p1.17.m17.1.1.2" xref="S3.SS1.p1.17.m17.1.1.2.cmml">z</mi><mi id="S3.SS1.p1.17.m17.1.1.3" xref="S3.SS1.p1.17.m17.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.1b"><apply id="S3.SS1.p1.17.m17.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m17.1.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1">subscript</csymbol><ci id="S3.SS1.p1.17.m17.1.1.2.cmml" xref="S3.SS1.p1.17.m17.1.1.2">𝑧</ci><ci id="S3.SS1.p1.17.m17.1.1.3.cmml" xref="S3.SS1.p1.17.m17.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.1c">z_{i}</annotation></semantics></math>, existing motion prediction task aims to estimate the distribution:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.6" class="ltx_Math" alttext="P(z_{i}\mid\mathcal{M},\mathcal{A})=\sum_{k=1}^{K}p_{k}^{i}P(z_{i}^{k}\mid\mathcal{M},\mathcal{A})" display="block"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6" xref="S3.E1.m1.6.6.cmml"><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.cmml"><mi id="S3.E1.m1.5.5.1.3" xref="S3.E1.m1.5.5.1.3.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.cmml"><msub id="S3.E1.m1.5.5.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.2.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.2.2" xref="S3.E1.m1.5.5.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E1.m1.5.5.1.1.1.1.2.3" xref="S3.E1.m1.5.5.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E1.m1.5.5.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.cmml">∣</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.3.2" xref="S3.E1.m1.5.5.1.1.1.1.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">ℳ</mi><mo id="S3.E1.m1.5.5.1.1.1.1.3.2.1" xref="S3.E1.m1.5.5.1.1.1.1.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝒜</mi></mrow></mrow><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E1.m1.6.6.3" xref="S3.E1.m1.6.6.3.cmml">=</mo><mrow id="S3.E1.m1.6.6.2" xref="S3.E1.m1.6.6.2.cmml"><munderover id="S3.E1.m1.6.6.2.2" xref="S3.E1.m1.6.6.2.2.cmml"><mo movablelimits="false" id="S3.E1.m1.6.6.2.2.2.2" xref="S3.E1.m1.6.6.2.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.6.6.2.2.2.3" xref="S3.E1.m1.6.6.2.2.2.3.cmml"><mi id="S3.E1.m1.6.6.2.2.2.3.2" xref="S3.E1.m1.6.6.2.2.2.3.2.cmml">k</mi><mo id="S3.E1.m1.6.6.2.2.2.3.1" xref="S3.E1.m1.6.6.2.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.6.6.2.2.2.3.3" xref="S3.E1.m1.6.6.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.6.6.2.2.3" xref="S3.E1.m1.6.6.2.2.3.cmml">K</mi></munderover><mrow id="S3.E1.m1.6.6.2.1" xref="S3.E1.m1.6.6.2.1.cmml"><msubsup id="S3.E1.m1.6.6.2.1.3" xref="S3.E1.m1.6.6.2.1.3.cmml"><mi id="S3.E1.m1.6.6.2.1.3.2.2" xref="S3.E1.m1.6.6.2.1.3.2.2.cmml">p</mi><mi id="S3.E1.m1.6.6.2.1.3.2.3" xref="S3.E1.m1.6.6.2.1.3.2.3.cmml">k</mi><mi id="S3.E1.m1.6.6.2.1.3.3" xref="S3.E1.m1.6.6.2.1.3.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.2.1.2" xref="S3.E1.m1.6.6.2.1.2.cmml">​</mo><mi id="S3.E1.m1.6.6.2.1.4" xref="S3.E1.m1.6.6.2.1.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.6.6.2.1.2a" xref="S3.E1.m1.6.6.2.1.2.cmml">​</mo><mrow id="S3.E1.m1.6.6.2.1.1.1" xref="S3.E1.m1.6.6.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.1.1.1.2" xref="S3.E1.m1.6.6.2.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.6.6.2.1.1.1.1" xref="S3.E1.m1.6.6.2.1.1.1.1.cmml"><msubsup id="S3.E1.m1.6.6.2.1.1.1.1.2" xref="S3.E1.m1.6.6.2.1.1.1.1.2.cmml"><mi id="S3.E1.m1.6.6.2.1.1.1.1.2.2.2" xref="S3.E1.m1.6.6.2.1.1.1.1.2.2.2.cmml">z</mi><mi id="S3.E1.m1.6.6.2.1.1.1.1.2.2.3" xref="S3.E1.m1.6.6.2.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.E1.m1.6.6.2.1.1.1.1.2.3" xref="S3.E1.m1.6.6.2.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.E1.m1.6.6.2.1.1.1.1.1" xref="S3.E1.m1.6.6.2.1.1.1.1.1.cmml">∣</mo><mrow id="S3.E1.m1.6.6.2.1.1.1.1.3.2" xref="S3.E1.m1.6.6.2.1.1.1.1.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">ℳ</mi><mo id="S3.E1.m1.6.6.2.1.1.1.1.3.2.1" xref="S3.E1.m1.6.6.2.1.1.1.1.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">𝒜</mi></mrow></mrow><mo stretchy="false" id="S3.E1.m1.6.6.2.1.1.1.3" xref="S3.E1.m1.6.6.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.6b"><apply id="S3.E1.m1.6.6.cmml" xref="S3.E1.m1.6.6"><eq id="S3.E1.m1.6.6.3.cmml" xref="S3.E1.m1.6.6.3"></eq><apply id="S3.E1.m1.5.5.1.cmml" xref="S3.E1.m1.5.5.1"><times id="S3.E1.m1.5.5.1.2.cmml" xref="S3.E1.m1.5.5.1.2"></times><ci id="S3.E1.m1.5.5.1.3.cmml" xref="S3.E1.m1.5.5.1.3">𝑃</ci><apply id="S3.E1.m1.5.5.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.5.5.1.1.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.5.5.1.1.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.2">𝑧</ci><ci id="S3.E1.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.1.1.2.3">𝑖</ci></apply><list id="S3.E1.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.1.1.3.2"><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">ℳ</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝒜</ci></list></apply></apply><apply id="S3.E1.m1.6.6.2.cmml" xref="S3.E1.m1.6.6.2"><apply id="S3.E1.m1.6.6.2.2.cmml" xref="S3.E1.m1.6.6.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2">superscript</csymbol><apply id="S3.E1.m1.6.6.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.2.2.1.cmml" xref="S3.E1.m1.6.6.2.2">subscript</csymbol><sum id="S3.E1.m1.6.6.2.2.2.2.cmml" xref="S3.E1.m1.6.6.2.2.2.2"></sum><apply id="S3.E1.m1.6.6.2.2.2.3.cmml" xref="S3.E1.m1.6.6.2.2.2.3"><eq id="S3.E1.m1.6.6.2.2.2.3.1.cmml" xref="S3.E1.m1.6.6.2.2.2.3.1"></eq><ci id="S3.E1.m1.6.6.2.2.2.3.2.cmml" xref="S3.E1.m1.6.6.2.2.2.3.2">𝑘</ci><cn type="integer" id="S3.E1.m1.6.6.2.2.2.3.3.cmml" xref="S3.E1.m1.6.6.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.6.6.2.2.3.cmml" xref="S3.E1.m1.6.6.2.2.3">𝐾</ci></apply><apply id="S3.E1.m1.6.6.2.1.cmml" xref="S3.E1.m1.6.6.2.1"><times id="S3.E1.m1.6.6.2.1.2.cmml" xref="S3.E1.m1.6.6.2.1.2"></times><apply id="S3.E1.m1.6.6.2.1.3.cmml" xref="S3.E1.m1.6.6.2.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.1.3.1.cmml" xref="S3.E1.m1.6.6.2.1.3">superscript</csymbol><apply id="S3.E1.m1.6.6.2.1.3.2.cmml" xref="S3.E1.m1.6.6.2.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.1.3.2.1.cmml" xref="S3.E1.m1.6.6.2.1.3">subscript</csymbol><ci id="S3.E1.m1.6.6.2.1.3.2.2.cmml" xref="S3.E1.m1.6.6.2.1.3.2.2">𝑝</ci><ci id="S3.E1.m1.6.6.2.1.3.2.3.cmml" xref="S3.E1.m1.6.6.2.1.3.2.3">𝑘</ci></apply><ci id="S3.E1.m1.6.6.2.1.3.3.cmml" xref="S3.E1.m1.6.6.2.1.3.3">𝑖</ci></apply><ci id="S3.E1.m1.6.6.2.1.4.cmml" xref="S3.E1.m1.6.6.2.1.4">𝑃</ci><apply id="S3.E1.m1.6.6.2.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.6.6.2.1.1.1.1.1.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.1">conditional</csymbol><apply id="S3.E1.m1.6.6.2.1.1.1.1.2.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.1.1.1.1.2.1.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.6.6.2.1.1.1.1.2.2.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.6.6.2.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.6.6.2.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.2.2.2">𝑧</ci><ci id="S3.E1.m1.6.6.2.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.6.6.2.1.1.1.1.2.3.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.2.3">𝑘</ci></apply><list id="S3.E1.m1.6.6.2.1.1.1.1.3.1.cmml" xref="S3.E1.m1.6.6.2.1.1.1.1.3.2"><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">ℳ</ci><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝒜</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.6c">P(z_{i}\mid\mathcal{M},\mathcal{A})=\sum_{k=1}^{K}p_{k}^{i}P(z_{i}^{k}\mid\mathcal{M},\mathcal{A})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.5" class="ltx_p">Different with other frameworks, we prioritize reconstructing a clean and complete historical trajectory <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="a_{i}^{re}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msubsup id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2.2" xref="S3.SS1.p2.1.m1.1.1.2.2.cmml">a</mi><mi id="S3.SS1.p2.1.m1.1.1.2.3" xref="S3.SS1.p2.1.m1.1.1.2.3.cmml">i</mi><mrow id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">e</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2.2">𝑎</ci><ci id="S3.SS1.p2.1.m1.1.1.2.3.cmml" xref="S3.SS1.p2.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><times id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.1"></times><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">𝑟</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">a_{i}^{re}</annotation></semantics></math> in the whole prediction pipeline. Besides, we incorporate relative historical movements <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathcal{R}</annotation></semantics></math> between selected agent <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="a_{i}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">a</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝑎</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">a_{i}</annotation></semantics></math> and
map polylines <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">\mathcal{M}</annotation></semantics></math> as additional context input, which can be easily calculated by matrix operation. We use <math id="S3.SS1.p2.5.m5.4" class="ltx_Math" alttext="\mathcal{V}=\{v_{1},v_{2},\dots,v_{N_{a}}\}\in\mathbb{R}^{N_{a}\times T_{p}\times 1}" display="inline"><semantics id="S3.SS1.p2.5.m5.4a"><mrow id="S3.SS1.p2.5.m5.4.4" xref="S3.SS1.p2.5.m5.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.4.4.5" xref="S3.SS1.p2.5.m5.4.4.5.cmml">𝒱</mi><mo id="S3.SS1.p2.5.m5.4.4.6" xref="S3.SS1.p2.5.m5.4.4.6.cmml">=</mo><mrow id="S3.SS1.p2.5.m5.4.4.3.3" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS1.p2.5.m5.4.4.3.3.4" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml">{</mo><msub id="S3.SS1.p2.5.m5.2.2.1.1.1" xref="S3.SS1.p2.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS1.p2.5.m5.2.2.1.1.1.2" xref="S3.SS1.p2.5.m5.2.2.1.1.1.2.cmml">v</mi><mn id="S3.SS1.p2.5.m5.2.2.1.1.1.3" xref="S3.SS1.p2.5.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.5.m5.4.4.3.3.5" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p2.5.m5.3.3.2.2.2" xref="S3.SS1.p2.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS1.p2.5.m5.3.3.2.2.2.2" xref="S3.SS1.p2.5.m5.3.3.2.2.2.2.cmml">v</mi><mn id="S3.SS1.p2.5.m5.3.3.2.2.2.3" xref="S3.SS1.p2.5.m5.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p2.5.m5.4.4.3.3.6" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">…</mi><mo id="S3.SS1.p2.5.m5.4.4.3.3.7" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml">,</mo><msub id="S3.SS1.p2.5.m5.4.4.3.3.3" xref="S3.SS1.p2.5.m5.4.4.3.3.3.cmml"><mi id="S3.SS1.p2.5.m5.4.4.3.3.3.2" xref="S3.SS1.p2.5.m5.4.4.3.3.3.2.cmml">v</mi><msub id="S3.SS1.p2.5.m5.4.4.3.3.3.3" xref="S3.SS1.p2.5.m5.4.4.3.3.3.3.cmml"><mi id="S3.SS1.p2.5.m5.4.4.3.3.3.3.2" xref="S3.SS1.p2.5.m5.4.4.3.3.3.3.2.cmml">N</mi><mi id="S3.SS1.p2.5.m5.4.4.3.3.3.3.3" xref="S3.SS1.p2.5.m5.4.4.3.3.3.3.3.cmml">a</mi></msub></msub><mo stretchy="false" id="S3.SS1.p2.5.m5.4.4.3.3.8" xref="S3.SS1.p2.5.m5.4.4.3.4.cmml">}</mo></mrow><mo id="S3.SS1.p2.5.m5.4.4.7" xref="S3.SS1.p2.5.m5.4.4.7.cmml">∈</mo><msup id="S3.SS1.p2.5.m5.4.4.8" xref="S3.SS1.p2.5.m5.4.4.8.cmml"><mi id="S3.SS1.p2.5.m5.4.4.8.2" xref="S3.SS1.p2.5.m5.4.4.8.2.cmml">ℝ</mi><mrow id="S3.SS1.p2.5.m5.4.4.8.3" xref="S3.SS1.p2.5.m5.4.4.8.3.cmml"><msub id="S3.SS1.p2.5.m5.4.4.8.3.2" xref="S3.SS1.p2.5.m5.4.4.8.3.2.cmml"><mi id="S3.SS1.p2.5.m5.4.4.8.3.2.2" xref="S3.SS1.p2.5.m5.4.4.8.3.2.2.cmml">N</mi><mi id="S3.SS1.p2.5.m5.4.4.8.3.2.3" xref="S3.SS1.p2.5.m5.4.4.8.3.2.3.cmml">a</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.5.m5.4.4.8.3.1" xref="S3.SS1.p2.5.m5.4.4.8.3.1.cmml">×</mo><msub id="S3.SS1.p2.5.m5.4.4.8.3.3" xref="S3.SS1.p2.5.m5.4.4.8.3.3.cmml"><mi id="S3.SS1.p2.5.m5.4.4.8.3.3.2" xref="S3.SS1.p2.5.m5.4.4.8.3.3.2.cmml">T</mi><mi id="S3.SS1.p2.5.m5.4.4.8.3.3.3" xref="S3.SS1.p2.5.m5.4.4.8.3.3.3.cmml">p</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p2.5.m5.4.4.8.3.1a" xref="S3.SS1.p2.5.m5.4.4.8.3.1.cmml">×</mo><mn id="S3.SS1.p2.5.m5.4.4.8.3.4" xref="S3.SS1.p2.5.m5.4.4.8.3.4.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.4b"><apply id="S3.SS1.p2.5.m5.4.4.cmml" xref="S3.SS1.p2.5.m5.4.4"><and id="S3.SS1.p2.5.m5.4.4a.cmml" xref="S3.SS1.p2.5.m5.4.4"></and><apply id="S3.SS1.p2.5.m5.4.4b.cmml" xref="S3.SS1.p2.5.m5.4.4"><eq id="S3.SS1.p2.5.m5.4.4.6.cmml" xref="S3.SS1.p2.5.m5.4.4.6"></eq><ci id="S3.SS1.p2.5.m5.4.4.5.cmml" xref="S3.SS1.p2.5.m5.4.4.5">𝒱</ci><set id="S3.SS1.p2.5.m5.4.4.3.4.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3"><apply id="S3.SS1.p2.5.m5.2.2.1.1.1.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p2.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1.2">𝑣</ci><cn type="integer" id="S3.SS1.p2.5.m5.2.2.1.1.1.3.cmml" xref="S3.SS1.p2.5.m5.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS1.p2.5.m5.3.3.2.2.2.cmml" xref="S3.SS1.p2.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS1.p2.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p2.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS1.p2.5.m5.3.3.2.2.2.2">𝑣</ci><cn type="integer" id="S3.SS1.p2.5.m5.3.3.2.2.2.3.cmml" xref="S3.SS1.p2.5.m5.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">…</ci><apply id="S3.SS1.p2.5.m5.4.4.3.3.3.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.4.4.3.3.3.1.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.5.m5.4.4.3.3.3.2.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3.2">𝑣</ci><apply id="S3.SS1.p2.5.m5.4.4.3.3.3.3.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.4.4.3.3.3.3.1.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.5.m5.4.4.3.3.3.3.2.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3.3.2">𝑁</ci><ci id="S3.SS1.p2.5.m5.4.4.3.3.3.3.3.cmml" xref="S3.SS1.p2.5.m5.4.4.3.3.3.3.3">𝑎</ci></apply></apply></set></apply><apply id="S3.SS1.p2.5.m5.4.4c.cmml" xref="S3.SS1.p2.5.m5.4.4"><in id="S3.SS1.p2.5.m5.4.4.7.cmml" xref="S3.SS1.p2.5.m5.4.4.7"></in><share href="#S3.SS1.p2.5.m5.4.4.3.cmml" id="S3.SS1.p2.5.m5.4.4d.cmml" xref="S3.SS1.p2.5.m5.4.4"></share><apply id="S3.SS1.p2.5.m5.4.4.8.cmml" xref="S3.SS1.p2.5.m5.4.4.8"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.4.4.8.1.cmml" xref="S3.SS1.p2.5.m5.4.4.8">superscript</csymbol><ci id="S3.SS1.p2.5.m5.4.4.8.2.cmml" xref="S3.SS1.p2.5.m5.4.4.8.2">ℝ</ci><apply id="S3.SS1.p2.5.m5.4.4.8.3.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3"><times id="S3.SS1.p2.5.m5.4.4.8.3.1.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3.1"></times><apply id="S3.SS1.p2.5.m5.4.4.8.3.2.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3.2"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.4.4.8.3.2.1.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3.2">subscript</csymbol><ci id="S3.SS1.p2.5.m5.4.4.8.3.2.2.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3.2.2">𝑁</ci><ci id="S3.SS1.p2.5.m5.4.4.8.3.2.3.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3.2.3">𝑎</ci></apply><apply id="S3.SS1.p2.5.m5.4.4.8.3.3.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.4.4.8.3.3.1.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3.3">subscript</csymbol><ci id="S3.SS1.p2.5.m5.4.4.8.3.3.2.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3.3.2">𝑇</ci><ci id="S3.SS1.p2.5.m5.4.4.8.3.3.3.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3.3.3">𝑝</ci></apply><cn type="integer" id="S3.SS1.p2.5.m5.4.4.8.3.4.cmml" xref="S3.SS1.p2.5.m5.4.4.8.3.4">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.4c">\mathcal{V}=\{v_{1},v_{2},\dots,v_{N_{a}}\}\in\mathbb{R}^{N_{a}\times T_{p}\times 1}</annotation></semantics></math> to denote the validity of each timestep observation. Hence, we rewrite the probability distribution as:</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<table id="S3.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2X.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle P(z_{i},a_{i}^{re}\mid\mathcal{A}*\mathcal{V},\mathcal{M},\mathcal{R})" display="inline"><semantics id="S3.E2X.2.1.1.m1.4a"><mrow id="S3.E2X.2.1.1.m1.4.4" xref="S3.E2X.2.1.1.m1.4.4.cmml"><mi id="S3.E2X.2.1.1.m1.4.4.4" xref="S3.E2X.2.1.1.m1.4.4.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.4.4.3" xref="S3.E2X.2.1.1.m1.4.4.3.cmml">​</mo><mrow id="S3.E2X.2.1.1.m1.4.4.2.2" xref="S3.E2X.2.1.1.m1.4.4.2.3.cmml"><mo stretchy="false" id="S3.E2X.2.1.1.m1.4.4.2.2.3" xref="S3.E2X.2.1.1.m1.4.4.2.3.cmml">(</mo><msub id="S3.E2X.2.1.1.m1.3.3.1.1.1" xref="S3.E2X.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S3.E2X.2.1.1.m1.3.3.1.1.1.2" xref="S3.E2X.2.1.1.m1.3.3.1.1.1.2.cmml">z</mi><mi id="S3.E2X.2.1.1.m1.3.3.1.1.1.3" xref="S3.E2X.2.1.1.m1.3.3.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2X.2.1.1.m1.4.4.2.2.4" xref="S3.E2X.2.1.1.m1.4.4.2.3.cmml">,</mo><mrow id="S3.E2X.2.1.1.m1.4.4.2.2.2" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.cmml"><msubsup id="S3.E2X.2.1.1.m1.4.4.2.2.2.3" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.cmml"><mi id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.2.2" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.2.2.cmml">a</mi><mi id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.2.3" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.2.3.cmml">i</mi><mrow id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.cmml"><mi id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.2" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.1" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.1.cmml">​</mo><mi id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.3" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.3.cmml">e</mi></mrow></msubsup><mo id="S3.E2X.2.1.1.m1.4.4.2.2.2.2" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.2.cmml">∣</mo><mrow id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.2.cmml"><mrow id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.cmml">𝒜</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.1" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.1.cmml">∗</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.cmml">𝒱</mi></mrow><mo id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.2" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.1.1" xref="S3.E2X.2.1.1.m1.1.1.cmml">ℳ</mi><mo id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.3" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2X.2.1.1.m1.2.2" xref="S3.E2X.2.1.1.m1.2.2.cmml">ℛ</mi></mrow></mrow><mo stretchy="false" id="S3.E2X.2.1.1.m1.4.4.2.2.5" xref="S3.E2X.2.1.1.m1.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2X.2.1.1.m1.4b"><apply id="S3.E2X.2.1.1.m1.4.4.cmml" xref="S3.E2X.2.1.1.m1.4.4"><times id="S3.E2X.2.1.1.m1.4.4.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.3"></times><ci id="S3.E2X.2.1.1.m1.4.4.4.cmml" xref="S3.E2X.2.1.1.m1.4.4.4">𝑃</ci><interval closure="open" id="S3.E2X.2.1.1.m1.4.4.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2"><apply id="S3.E2X.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.3.3.1.1.1.2">𝑧</ci><ci id="S3.E2X.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.3.3.1.1.1.3">𝑖</ci></apply><apply id="S3.E2X.2.1.1.m1.4.4.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2"><csymbol cd="latexml" id="S3.E2X.2.1.1.m1.4.4.2.2.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.2">conditional</csymbol><apply id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3">superscript</csymbol><apply id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.2.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3">subscript</csymbol><ci id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.2.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.2.2">𝑎</ci><ci id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.2.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.2.3">𝑖</ci></apply><apply id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3"><times id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.1"></times><ci id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.2">𝑟</ci><ci id="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.3.3.3">𝑒</ci></apply></apply><list id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1"><apply id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1"><times id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.1.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.1"></times><ci id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.2">𝒜</ci><ci id="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3.cmml" xref="S3.E2X.2.1.1.m1.4.4.2.2.2.1.1.1.3">𝒱</ci></apply><ci id="S3.E2X.2.1.1.m1.1.1.cmml" xref="S3.E2X.2.1.1.m1.1.1">ℳ</ci><ci id="S3.E2X.2.1.1.m1.2.2.cmml" xref="S3.E2X.2.1.1.m1.2.2">ℛ</ci></list></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2X.2.1.1.m1.4c">\displaystyle P(z_{i},a_{i}^{re}\mid\mathcal{A}*\mathcal{V},\mathcal{M},\mathcal{R})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S3.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2Xa.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle=\sum_{k=1}^{K}p_{k}^{i}P(z_{i}^{k},a_{i}^{re}\mid\mathcal{A}*\mathcal{V},\mathcal{M},\mathcal{R})" display="inline"><semantics id="S3.E2Xa.2.1.1.m1.4a"><mrow id="S3.E2Xa.2.1.1.m1.4.4" xref="S3.E2Xa.2.1.1.m1.4.4.cmml"><mi id="S3.E2Xa.2.1.1.m1.4.4.4" xref="S3.E2Xa.2.1.1.m1.4.4.4.cmml"></mi><mo id="S3.E2Xa.2.1.1.m1.4.4.3" xref="S3.E2Xa.2.1.1.m1.4.4.3.cmml">=</mo><mrow id="S3.E2Xa.2.1.1.m1.4.4.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.cmml"><mstyle displaystyle="true" id="S3.E2Xa.2.1.1.m1.4.4.2.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.cmml"><munderover id="S3.E2Xa.2.1.1.m1.4.4.2.3a" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.cmml"><mo movablelimits="false" id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.2.2.cmml">∑</mo><mrow id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.cmml"><mi id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.2.cmml">k</mi><mo id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.1" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.1.cmml">=</mo><mn id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E2Xa.2.1.1.m1.4.4.2.3.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E2Xa.2.1.1.m1.4.4.2.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.cmml"><msubsup id="S3.E2Xa.2.1.1.m1.4.4.2.2.4" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4.cmml"><mi id="S3.E2Xa.2.1.1.m1.4.4.2.2.4.2.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4.2.2.cmml">p</mi><mi id="S3.E2Xa.2.1.1.m1.4.4.2.2.4.2.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4.2.3.cmml">k</mi><mi id="S3.E2Xa.2.1.1.m1.4.4.2.2.4.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.4.4.2.2.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.3.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.4.4.2.2.5" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.5.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.4.4.2.2.3a" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.3.cmml">​</mo><mrow id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.3.cmml">(</mo><msubsup id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.cmml">z</mi><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.4" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.3.cmml">,</mo><mrow id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.cmml"><msubsup id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.cmml"><mi id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.2.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.2.2.cmml">a</mi><mi id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.2.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.2.3.cmml">i</mi><mrow id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.cmml"><mi id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.1" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.3.cmml">e</mi></mrow></msubsup><mo id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.2.cmml">∣</mo><mrow id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.2.cmml"><mrow id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.2.cmml">𝒜</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.1" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.1.cmml">∗</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.3.cmml">𝒱</mi></mrow><mo id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.2" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2Xa.2.1.1.m1.1.1" xref="S3.E2Xa.2.1.1.m1.1.1.cmml">ℳ</mi><mo id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.3" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2Xa.2.1.1.m1.2.2" xref="S3.E2Xa.2.1.1.m1.2.2.cmml">ℛ</mi></mrow></mrow><mo stretchy="false" id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.5" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xa.2.1.1.m1.4b"><apply id="S3.E2Xa.2.1.1.m1.4.4.cmml" xref="S3.E2Xa.2.1.1.m1.4.4"><eq id="S3.E2Xa.2.1.1.m1.4.4.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.3"></eq><csymbol cd="latexml" id="S3.E2Xa.2.1.1.m1.4.4.4.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.4">absent</csymbol><apply id="S3.E2Xa.2.1.1.m1.4.4.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2"><apply id="S3.E2Xa.2.1.1.m1.4.4.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.4.4.2.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.3">superscript</csymbol><apply id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.3">subscript</csymbol><sum id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.2.2"></sum><apply id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3"><eq id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.1"></eq><ci id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.2">𝑘</ci><cn type="integer" id="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E2Xa.2.1.1.m1.4.4.2.3.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.3.3">𝐾</ci></apply><apply id="S3.E2Xa.2.1.1.m1.4.4.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2"><times id="S3.E2Xa.2.1.1.m1.4.4.2.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.3"></times><apply id="S3.E2Xa.2.1.1.m1.4.4.2.2.4.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.4.4.2.2.4.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4">superscript</csymbol><apply id="S3.E2Xa.2.1.1.m1.4.4.2.2.4.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.4.4.2.2.4.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.4.4.2.2.4.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4.2.2">𝑝</ci><ci id="S3.E2Xa.2.1.1.m1.4.4.2.2.4.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4.2.3">𝑘</ci></apply><ci id="S3.E2Xa.2.1.1.m1.4.4.2.2.4.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.4.3">𝑖</ci></apply><ci id="S3.E2Xa.2.1.1.m1.4.4.2.2.5.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.5">𝑃</ci><interval closure="open" id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2"><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1">superscript</csymbol><apply id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.2">𝑧</ci><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.3.3.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2"><csymbol cd="latexml" id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.2">conditional</csymbol><apply id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3">superscript</csymbol><apply id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.2.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3">subscript</csymbol><ci id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.2.2">𝑎</ci><ci id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.2.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.2.3">𝑖</ci></apply><apply id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3"><times id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.1"></times><ci id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.2">𝑟</ci><ci id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.3.3.3">𝑒</ci></apply></apply><list id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1"><apply id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1"><times id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.1"></times><ci id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.2">𝒜</ci><ci id="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.3.cmml" xref="S3.E2Xa.2.1.1.m1.4.4.2.2.2.2.2.1.1.1.3">𝒱</ci></apply><ci id="S3.E2Xa.2.1.1.m1.1.1.cmml" xref="S3.E2Xa.2.1.1.m1.1.1">ℳ</ci><ci id="S3.E2Xa.2.1.1.m1.2.2.cmml" xref="S3.E2Xa.2.1.1.m1.2.2">ℛ</ci></list></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xa.2.1.1.m1.4c">\displaystyle=\sum_{k=1}^{K}p_{k}^{i}P(z_{i}^{k},a_{i}^{re}\mid\mathcal{A}*\mathcal{V},\mathcal{M},\mathcal{R})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S3.E2Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E2Xb.2.1.1.m1.6" class="ltx_Math" alttext="\displaystyle=\sum_{k=1}^{K}p_{k}^{i}P(z_{i}^{k}\mid a_{i}^{re},\mathcal{A}*\mathcal{V},\mathcal{M},\mathcal{R})\cdot P(a_{i}^{re}\mid\mathcal{M},\mathcal{A}*\mathcal{V},\mathcal{R})" display="inline"><semantics id="S3.E2Xb.2.1.1.m1.6a"><mrow id="S3.E2Xb.2.1.1.m1.6.6" xref="S3.E2Xb.2.1.1.m1.6.6.cmml"><mi id="S3.E2Xb.2.1.1.m1.6.6.4" xref="S3.E2Xb.2.1.1.m1.6.6.4.cmml"></mi><mo id="S3.E2Xb.2.1.1.m1.6.6.3" xref="S3.E2Xb.2.1.1.m1.6.6.3.cmml">=</mo><mrow id="S3.E2Xb.2.1.1.m1.6.6.2" xref="S3.E2Xb.2.1.1.m1.6.6.2.cmml"><mstyle displaystyle="true" id="S3.E2Xb.2.1.1.m1.6.6.2.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.cmml"><munderover id="S3.E2Xb.2.1.1.m1.6.6.2.3a" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.cmml"><mo movablelimits="false" id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.2" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.2.2.cmml">∑</mo><mrow id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.cmml"><mi id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.2" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.2.cmml">k</mi><mo id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.1" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.1.cmml">=</mo><mn id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E2Xb.2.1.1.m1.6.6.2.3.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E2Xb.2.1.1.m1.6.6.2.2" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.cmml"><mrow id="S3.E2Xb.2.1.1.m1.5.5.1.1.1" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.cmml"><mrow id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.cmml"><msubsup id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.cmml"><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.2.2" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.2.2.cmml">p</mi><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.2.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.2.3.cmml">k</mi><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.2" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.2.cmml">​</mo><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.4" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.2a" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.2" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.2.2" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.2.2.cmml">z</mi><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.2.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.2.3.cmml">i</mi><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.3.cmml">k</mi></msubsup><mo id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml"><msubsup id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi></mrow></msubsup><mo id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.2.cmml">𝒜</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.cmml">∗</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.3.cmml">𝒱</mi></mrow><mo id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.4" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2Xb.2.1.1.m1.1.1" xref="S3.E2Xb.2.1.1.m1.1.1.cmml">ℳ</mi><mo id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.5" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2Xb.2.1.1.m1.2.2" xref="S3.E2Xb.2.1.1.m1.2.2.cmml">ℛ</mi></mrow></mrow><mo rspace="0.055em" stretchy="false" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.2" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.2.cmml">⋅</mo><mi id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.3.cmml">P</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2Xb.2.1.1.m1.6.6.2.2.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.3.cmml">​</mo><mrow id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.2" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.cmml">(</mo><mrow id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.cmml"><msubsup id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.cmml"><mi id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.2.2" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.2.2.cmml">a</mi><mi id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.2.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.2.3.cmml">i</mi><mrow id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.cmml"><mi id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.2" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.1" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.1.cmml">​</mo><mi id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.3.cmml">e</mi></mrow></msubsup><mo id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.2" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.2.cmml">∣</mo><mrow id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2Xb.2.1.1.m1.3.3" xref="S3.E2Xb.2.1.1.m1.3.3.cmml">ℳ</mi><mo id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.2" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.2.cmml">,</mo><mrow id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.2" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.2.cmml">𝒜</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.1" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.1.cmml">∗</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.3.cmml">𝒱</mi></mrow><mo id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2Xb.2.1.1.m1.4.4" xref="S3.E2Xb.2.1.1.m1.4.4.cmml">ℛ</mi></mrow></mrow><mo stretchy="false" id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.3" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2Xb.2.1.1.m1.6b"><apply id="S3.E2Xb.2.1.1.m1.6.6.cmml" xref="S3.E2Xb.2.1.1.m1.6.6"><eq id="S3.E2Xb.2.1.1.m1.6.6.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.3"></eq><csymbol cd="latexml" id="S3.E2Xb.2.1.1.m1.6.6.4.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.4">absent</csymbol><apply id="S3.E2Xb.2.1.1.m1.6.6.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2"><apply id="S3.E2Xb.2.1.1.m1.6.6.2.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E2Xb.2.1.1.m1.6.6.2.3.1.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.3">superscript</csymbol><apply id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.1.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.3">subscript</csymbol><sum id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.2.2"></sum><apply id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3"><eq id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.1.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.1"></eq><ci id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.2">𝑘</ci><cn type="integer" id="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E2Xb.2.1.1.m1.6.6.2.3.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.3.3">𝐾</ci></apply><apply id="S3.E2Xb.2.1.1.m1.6.6.2.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2"><times id="S3.E2Xb.2.1.1.m1.6.6.2.2.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.3"></times><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1"><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.2">⋅</ci><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1"><times id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.2"></times><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3">superscript</csymbol><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.2.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.2.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.2.2">𝑝</ci><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.2.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.3.3">𝑖</ci></apply><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.4.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.4">𝑃</ci><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.2.2">𝑧</ci><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.4.3">𝑘</ci></apply><list id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2"><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.3.3">𝑒</ci></apply></apply><apply id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2"><times id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.1"></times><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.2">𝒜</ci><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.1.1.1.1.2.2.2.3">𝒱</ci></apply><ci id="S3.E2Xb.2.1.1.m1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.1.1">ℳ</ci><ci id="S3.E2Xb.2.1.1.m1.2.2.cmml" xref="S3.E2Xb.2.1.1.m1.2.2">ℛ</ci></list></apply></apply><ci id="S3.E2Xb.2.1.1.m1.5.5.1.1.1.3.cmml" xref="S3.E2Xb.2.1.1.m1.5.5.1.1.1.3">𝑃</ci></apply><apply id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1"><csymbol cd="latexml" id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.2">conditional</csymbol><apply id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.1.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3">superscript</csymbol><apply id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.2.1.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.2.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.2.2">𝑎</ci><ci id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.2.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3"><times id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.1.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.1"></times><ci id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.2">𝑟</ci><ci id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.3.3.3">𝑒</ci></apply></apply><list id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1"><ci id="S3.E2Xb.2.1.1.m1.3.3.cmml" xref="S3.E2Xb.2.1.1.m1.3.3">ℳ</ci><apply id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1"><times id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.1"></times><ci id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.2">𝒜</ci><ci id="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E2Xb.2.1.1.m1.6.6.2.2.2.1.1.1.1.1.3">𝒱</ci></apply><ci id="S3.E2Xb.2.1.1.m1.4.4.cmml" xref="S3.E2Xb.2.1.1.m1.4.4">ℛ</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2Xb.2.1.1.m1.6c">\displaystyle=\sum_{k=1}^{K}p_{k}^{i}P(z_{i}^{k}\mid a_{i}^{re},\mathcal{A}*\mathcal{V},\mathcal{M},\mathcal{R})\cdot P(a_{i}^{re}\mid\mathcal{M},\mathcal{A}*\mathcal{V},\mathcal{R})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.2" class="ltx_p">We claim that local agents and map structures surrounding selected agent are sufficient to reconstruct historical trajectories. Since <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">\mathcal{R}</annotation></semantics></math> depends on <math id="S3.SS1.p4.2.m2.2" class="ltx_Math" alttext="\mathcal{M},\mathcal{A}" display="inline"><semantics id="S3.SS1.p4.2.m2.2a"><mrow id="S3.SS1.p4.2.m2.2.3.2" xref="S3.SS1.p4.2.m2.2.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">ℳ</mi><mo id="S3.SS1.p4.2.m2.2.3.2.1" xref="S3.SS1.p4.2.m2.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p4.2.m2.2.2" xref="S3.SS1.p4.2.m2.2.2.cmml">𝒜</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.2b"><list id="S3.SS1.p4.2.m2.2.3.1.cmml" xref="S3.SS1.p4.2.m2.2.3.2"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">ℳ</ci><ci id="S3.SS1.p4.2.m2.2.2.cmml" xref="S3.SS1.p4.2.m2.2.2">𝒜</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.2c">\mathcal{M},\mathcal{A}</annotation></semantics></math>, Eq. <a href="#S3.E2" title="In III-A Problem Formulation and Input Representation ‣ III Methodology ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> can be further simplified as:</p>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<table id="S3.E3" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E3X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3X.2.1.1.m1.7" class="ltx_Math" alttext="\displaystyle P(z_{i},a_{i}^{re}\mid\mathcal{A}*\mathcal{V},\mathcal{M},\mathcal{R})=P(z_{i},a_{i}^{re}\mid\mathcal{A}*\mathcal{V},\mathcal{M})" display="inline"><semantics id="S3.E3X.2.1.1.m1.7a"><mrow id="S3.E3X.2.1.1.m1.7.7" xref="S3.E3X.2.1.1.m1.7.7.cmml"><mrow id="S3.E3X.2.1.1.m1.5.5.2" xref="S3.E3X.2.1.1.m1.5.5.2.cmml"><mi id="S3.E3X.2.1.1.m1.5.5.2.4" xref="S3.E3X.2.1.1.m1.5.5.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.5.5.2.3" xref="S3.E3X.2.1.1.m1.5.5.2.3.cmml">​</mo><mrow id="S3.E3X.2.1.1.m1.5.5.2.2.2" xref="S3.E3X.2.1.1.m1.5.5.2.2.3.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.5.5.2.2.2.3" xref="S3.E3X.2.1.1.m1.5.5.2.2.3.cmml">(</mo><msub id="S3.E3X.2.1.1.m1.4.4.1.1.1.1" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.2" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.2.cmml">z</mi><mi id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3X.2.1.1.m1.5.5.2.2.2.4" xref="S3.E3X.2.1.1.m1.5.5.2.2.3.cmml">,</mo><mrow id="S3.E3X.2.1.1.m1.5.5.2.2.2.2" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.cmml"><msubsup id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.cmml"><mi id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.2" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.2.cmml">a</mi><mi id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.3" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.3.cmml">i</mi><mrow id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.cmml"><mi id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.2" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.1" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.3" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.3.cmml">e</mi></mrow></msubsup><mo id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.2" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.2.cmml">∣</mo><mrow id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.2.cmml"><mrow id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.2" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.2.cmml">𝒜</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.1" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.1.cmml">∗</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.3" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.3.cmml">𝒱</mi></mrow><mo id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.2" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3X.2.1.1.m1.1.1" xref="S3.E3X.2.1.1.m1.1.1.cmml">ℳ</mi><mo id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.3" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3X.2.1.1.m1.2.2" xref="S3.E3X.2.1.1.m1.2.2.cmml">ℛ</mi></mrow></mrow><mo stretchy="false" id="S3.E3X.2.1.1.m1.5.5.2.2.2.5" xref="S3.E3X.2.1.1.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E3X.2.1.1.m1.7.7.5" xref="S3.E3X.2.1.1.m1.7.7.5.cmml">=</mo><mrow id="S3.E3X.2.1.1.m1.7.7.4" xref="S3.E3X.2.1.1.m1.7.7.4.cmml"><mi id="S3.E3X.2.1.1.m1.7.7.4.4" xref="S3.E3X.2.1.1.m1.7.7.4.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.7.7.4.3" xref="S3.E3X.2.1.1.m1.7.7.4.3.cmml">​</mo><mrow id="S3.E3X.2.1.1.m1.7.7.4.2.2" xref="S3.E3X.2.1.1.m1.7.7.4.2.3.cmml"><mo stretchy="false" id="S3.E3X.2.1.1.m1.7.7.4.2.2.3" xref="S3.E3X.2.1.1.m1.7.7.4.2.3.cmml">(</mo><msub id="S3.E3X.2.1.1.m1.6.6.3.1.1.1" xref="S3.E3X.2.1.1.m1.6.6.3.1.1.1.cmml"><mi id="S3.E3X.2.1.1.m1.6.6.3.1.1.1.2" xref="S3.E3X.2.1.1.m1.6.6.3.1.1.1.2.cmml">z</mi><mi id="S3.E3X.2.1.1.m1.6.6.3.1.1.1.3" xref="S3.E3X.2.1.1.m1.6.6.3.1.1.1.3.cmml">i</mi></msub><mo id="S3.E3X.2.1.1.m1.7.7.4.2.2.4" xref="S3.E3X.2.1.1.m1.7.7.4.2.3.cmml">,</mo><mrow id="S3.E3X.2.1.1.m1.7.7.4.2.2.2" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.cmml"><msubsup id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.cmml"><mi id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.2.2" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.2.2.cmml">a</mi><mi id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.2.3" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.2.3.cmml">i</mi><mrow id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.cmml"><mi id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.2" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.1" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.1.cmml">​</mo><mi id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.3" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.3.cmml">e</mi></mrow></msubsup><mo id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.2" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.2.cmml">∣</mo><mrow id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.2.cmml"><mrow id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.2" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.2.cmml">𝒜</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.1" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.1.cmml">∗</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.3" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.3.cmml">𝒱</mi></mrow><mo id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.2" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3X.2.1.1.m1.3.3" xref="S3.E3X.2.1.1.m1.3.3.cmml">ℳ</mi></mrow></mrow><mo stretchy="false" id="S3.E3X.2.1.1.m1.7.7.4.2.2.5" xref="S3.E3X.2.1.1.m1.7.7.4.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3X.2.1.1.m1.7b"><apply id="S3.E3X.2.1.1.m1.7.7.cmml" xref="S3.E3X.2.1.1.m1.7.7"><eq id="S3.E3X.2.1.1.m1.7.7.5.cmml" xref="S3.E3X.2.1.1.m1.7.7.5"></eq><apply id="S3.E3X.2.1.1.m1.5.5.2.cmml" xref="S3.E3X.2.1.1.m1.5.5.2"><times id="S3.E3X.2.1.1.m1.5.5.2.3.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.3"></times><ci id="S3.E3X.2.1.1.m1.5.5.2.4.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.4">𝑃</ci><interval closure="open" id="S3.E3X.2.1.1.m1.5.5.2.2.3.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2"><apply id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.2">𝑧</ci><ci id="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.4.4.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2"><csymbol cd="latexml" id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.2">conditional</csymbol><apply id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3">superscript</csymbol><apply id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.1.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.2.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.2">𝑎</ci><ci id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.3.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.2.3">𝑖</ci></apply><apply id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3"><times id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.1.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.1"></times><ci id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.2.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.2">𝑟</ci><ci id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.3.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.3.3.3">𝑒</ci></apply></apply><list id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.2.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1"><apply id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1"><times id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.1"></times><ci id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.2">𝒜</ci><ci id="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.5.5.2.2.2.2.1.1.1.3">𝒱</ci></apply><ci id="S3.E3X.2.1.1.m1.1.1.cmml" xref="S3.E3X.2.1.1.m1.1.1">ℳ</ci><ci id="S3.E3X.2.1.1.m1.2.2.cmml" xref="S3.E3X.2.1.1.m1.2.2">ℛ</ci></list></apply></interval></apply><apply id="S3.E3X.2.1.1.m1.7.7.4.cmml" xref="S3.E3X.2.1.1.m1.7.7.4"><times id="S3.E3X.2.1.1.m1.7.7.4.3.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.3"></times><ci id="S3.E3X.2.1.1.m1.7.7.4.4.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.4">𝑃</ci><interval closure="open" id="S3.E3X.2.1.1.m1.7.7.4.2.3.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2"><apply id="S3.E3X.2.1.1.m1.6.6.3.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.6.6.3.1.1.1"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.6.6.3.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.6.6.3.1.1.1">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.6.6.3.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.6.6.3.1.1.1.2">𝑧</ci><ci id="S3.E3X.2.1.1.m1.6.6.3.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.6.6.3.1.1.1.3">𝑖</ci></apply><apply id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2"><csymbol cd="latexml" id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.2.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.2">conditional</csymbol><apply id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.1.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3">superscript</csymbol><apply id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.2.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.2.1.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3">subscript</csymbol><ci id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.2.2.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.2.2">𝑎</ci><ci id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.2.3.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.2.3">𝑖</ci></apply><apply id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3"><times id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.1.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.1"></times><ci id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.2.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.2">𝑟</ci><ci id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.3.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.3.3.3">𝑒</ci></apply></apply><list id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.2.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1"><apply id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1"><times id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.1.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.1"></times><ci id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.2.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.2">𝒜</ci><ci id="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.3.cmml" xref="S3.E3X.2.1.1.m1.7.7.4.2.2.2.1.1.1.3">𝒱</ci></apply><ci id="S3.E3X.2.1.1.m1.3.3.cmml" xref="S3.E3X.2.1.1.m1.3.3">ℳ</ci></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3X.2.1.1.m1.7c">\displaystyle P(z_{i},a_{i}^{re}\mid\mathcal{A}*\mathcal{V},\mathcal{M},\mathcal{R})=P(z_{i},a_{i}^{re}\mid\mathcal{A}*\mathcal{V},\mathcal{M})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr id="S3.E3Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E3Xa.2.1.1.m1.4" class="ltx_Math" alttext="\displaystyle\approx\sum_{k=1}^{K}p_{k}^{i}P(z_{i}^{k}\mid a_{i}^{re},\mathcal{A}*\mathcal{V},\mathcal{M})\cdot P(a_{i}^{re}\mid local(\mathcal{A}*\mathcal{V},\mathcal{M}))" display="inline"><semantics id="S3.E3Xa.2.1.1.m1.4a"><mrow id="S3.E3Xa.2.1.1.m1.4.4" xref="S3.E3Xa.2.1.1.m1.4.4.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.4.4" xref="S3.E3Xa.2.1.1.m1.4.4.4.cmml"></mi><mo id="S3.E3Xa.2.1.1.m1.4.4.3" xref="S3.E3Xa.2.1.1.m1.4.4.3.cmml">≈</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.cmml"><mstyle displaystyle="true" id="S3.E3Xa.2.1.1.m1.4.4.2.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.cmml"><munderover id="S3.E3Xa.2.1.1.m1.4.4.2.3a" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.cmml"><mo movablelimits="false" id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.2.2.cmml">∑</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.2.cmml">k</mi><mo id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.1.cmml">=</mo><mn id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E3Xa.2.1.1.m1.4.4.2.3.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.3.cmml">K</mi></munderover></mstyle><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.cmml"><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.cmml"><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.cmml"><msubsup id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2.2.cmml">p</mi><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2.3.cmml">k</mi><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.3.cmml">i</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml">​</mo><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.4" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.2a" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.2.2.cmml">z</mi><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml">i</mi><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.3.cmml">k</mi></msubsup><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">∣</mo><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.cmml"><msubsup id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi></mrow></msubsup><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml">𝒜</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.1" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml">∗</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.3.cmml">𝒱</mi></mrow><mo id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.4" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.1.1" xref="S3.E3Xa.2.1.1.m1.1.1.cmml">ℳ</mi></mrow></mrow><mo rspace="0.055em" stretchy="false" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.2.cmml">⋅</mo><mi id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.3.cmml">P</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.4.2.2.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3.cmml">​</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.cmml">(</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.cmml"><msubsup id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.2.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.2.2.cmml">a</mi><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.2.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.2.3.cmml">i</mi><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.1.cmml">​</mo><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.3.cmml">e</mi></mrow></msubsup><mo id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.2.cmml">∣</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.cmml"><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2.cmml">​</mo><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.4" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2a" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2.cmml">​</mo><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.5" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2b" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2.cmml">​</mo><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.6" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.6.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2c" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2.cmml">​</mo><mi id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.7" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.7.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2d" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.2.cmml">(</mo><mrow id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.2" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.2.cmml">𝒜</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.1" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.1.cmml">∗</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.3.cmml">𝒱</mi></mrow><mo id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E3Xa.2.1.1.m1.2.2" xref="S3.E3Xa.2.1.1.m1.2.2.cmml">ℳ</mi><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.4" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.3" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3Xa.2.1.1.m1.4b"><apply id="S3.E3Xa.2.1.1.m1.4.4.cmml" xref="S3.E3Xa.2.1.1.m1.4.4"><approx id="S3.E3Xa.2.1.1.m1.4.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.3"></approx><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.4.4.4.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.4">absent</csymbol><apply id="S3.E3Xa.2.1.1.m1.4.4.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2"><apply id="S3.E3Xa.2.1.1.m1.4.4.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3">superscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3">subscript</csymbol><sum id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.2.2"></sum><apply id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3"><eq id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.1"></eq><ci id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.2">𝑘</ci><cn type="integer" id="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E3Xa.2.1.1.m1.4.4.2.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.3.3">𝐾</ci></apply><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2"><times id="S3.E3Xa.2.1.1.m1.4.4.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.3"></times><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1"><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.2">⋅</ci><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1"><times id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.2"></times><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3">superscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2.2">𝑝</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.2.3">𝑘</ci></apply><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.3.3">𝑖</ci></apply><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.4.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.4">𝑃</ci><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4">superscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.2.2">𝑧</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.4.3">𝑘</ci></apply><list id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2"><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">𝑒</ci></apply></apply><apply id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2"><times id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.1"></times><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.2">𝒜</ci><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.2.3">𝒱</ci></apply><ci id="S3.E3Xa.2.1.1.m1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.1.1">ℳ</ci></list></apply></apply><ci id="S3.E3Xa.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.3.3.1.1.1.3">𝑃</ci></apply><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1"><csymbol cd="latexml" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.2">conditional</csymbol><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3">superscript</csymbol><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.2.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.2.2">𝑎</ci><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.2.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.2.3">𝑖</ci></apply><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3"><times id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.1"></times><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.2">𝑟</ci><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.3.3.3">𝑒</ci></apply></apply><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1"><times id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.2"></times><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.3">𝑙</ci><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.4.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.4">𝑜</ci><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.5.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.5">𝑐</ci><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.6.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.6">𝑎</ci><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.7.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.7">𝑙</ci><interval closure="open" id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1"><apply id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1"><times id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.1"></times><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.2">𝒜</ci><ci id="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E3Xa.2.1.1.m1.4.4.2.2.2.1.1.1.1.1.1.3">𝒱</ci></apply><ci id="S3.E3Xa.2.1.1.m1.2.2.cmml" xref="S3.E3Xa.2.1.1.m1.2.2">ℳ</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3Xa.2.1.1.m1.4c">\displaystyle\approx\sum_{k=1}^{K}p_{k}^{i}P(z_{i}^{k}\mid a_{i}^{re},\mathcal{A}*\mathcal{V},\mathcal{M})\cdot P(a_{i}^{re}\mid local(\mathcal{A}*\mathcal{V},\mathcal{M}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS1.p6" class="ltx_para">
<p id="S3.SS1.p6.7" class="ltx_p">By employing an agent-centric strategy, the input for each selected agent can be represented as follows:
1) Agent historical information <math id="S3.SS1.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{A}\in\mathbb{R}^{N_{a}\times T_{p}\times F_{1}}" display="inline"><semantics id="S3.SS1.p6.1.m1.1a"><mrow id="S3.SS1.p6.1.m1.1.1" xref="S3.SS1.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.1.m1.1.1.2" xref="S3.SS1.p6.1.m1.1.1.2.cmml">𝒜</mi><mo id="S3.SS1.p6.1.m1.1.1.1" xref="S3.SS1.p6.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p6.1.m1.1.1.3" xref="S3.SS1.p6.1.m1.1.1.3.cmml"><mi id="S3.SS1.p6.1.m1.1.1.3.2" xref="S3.SS1.p6.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p6.1.m1.1.1.3.3" xref="S3.SS1.p6.1.m1.1.1.3.3.cmml"><msub id="S3.SS1.p6.1.m1.1.1.3.3.2" xref="S3.SS1.p6.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS1.p6.1.m1.1.1.3.3.2.2" xref="S3.SS1.p6.1.m1.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.p6.1.m1.1.1.3.3.2.3" xref="S3.SS1.p6.1.m1.1.1.3.3.2.3.cmml">a</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p6.1.m1.1.1.3.3.1" xref="S3.SS1.p6.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p6.1.m1.1.1.3.3.3" xref="S3.SS1.p6.1.m1.1.1.3.3.3.cmml"><mi id="S3.SS1.p6.1.m1.1.1.3.3.3.2" xref="S3.SS1.p6.1.m1.1.1.3.3.3.2.cmml">T</mi><mi id="S3.SS1.p6.1.m1.1.1.3.3.3.3" xref="S3.SS1.p6.1.m1.1.1.3.3.3.3.cmml">p</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p6.1.m1.1.1.3.3.1a" xref="S3.SS1.p6.1.m1.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p6.1.m1.1.1.3.3.4" xref="S3.SS1.p6.1.m1.1.1.3.3.4.cmml"><mi id="S3.SS1.p6.1.m1.1.1.3.3.4.2" xref="S3.SS1.p6.1.m1.1.1.3.3.4.2.cmml">F</mi><mn id="S3.SS1.p6.1.m1.1.1.3.3.4.3" xref="S3.SS1.p6.1.m1.1.1.3.3.4.3.cmml">1</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.1.m1.1b"><apply id="S3.SS1.p6.1.m1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1"><in id="S3.SS1.p6.1.m1.1.1.1.cmml" xref="S3.SS1.p6.1.m1.1.1.1"></in><ci id="S3.SS1.p6.1.m1.1.1.2.cmml" xref="S3.SS1.p6.1.m1.1.1.2">𝒜</ci><apply id="S3.SS1.p6.1.m1.1.1.3.cmml" xref="S3.SS1.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.1.3.1.cmml" xref="S3.SS1.p6.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p6.1.m1.1.1.3.2.cmml" xref="S3.SS1.p6.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p6.1.m1.1.1.3.3.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3"><times id="S3.SS1.p6.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.1"></times><apply id="S3.SS1.p6.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p6.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.p6.1.m1.1.1.3.3.2.3.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.2.3">𝑎</ci></apply><apply id="S3.SS1.p6.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.1.3.3.3.1.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p6.1.m1.1.1.3.3.3.2.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.3.2">𝑇</ci><ci id="S3.SS1.p6.1.m1.1.1.3.3.3.3.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.3.3">𝑝</ci></apply><apply id="S3.SS1.p6.1.m1.1.1.3.3.4.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p6.1.m1.1.1.3.3.4.1.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.4">subscript</csymbol><ci id="S3.SS1.p6.1.m1.1.1.3.3.4.2.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.4.2">𝐹</ci><cn type="integer" id="S3.SS1.p6.1.m1.1.1.3.3.4.3.cmml" xref="S3.SS1.p6.1.m1.1.1.3.3.4.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.1.m1.1c">\mathcal{A}\in\mathbb{R}^{N_{a}\times T_{p}\times F_{1}}</annotation></semantics></math> where <math id="S3.SS1.p6.2.m2.1" class="ltx_Math" alttext="F_{1}" display="inline"><semantics id="S3.SS1.p6.2.m2.1a"><msub id="S3.SS1.p6.2.m2.1.1" xref="S3.SS1.p6.2.m2.1.1.cmml"><mi id="S3.SS1.p6.2.m2.1.1.2" xref="S3.SS1.p6.2.m2.1.1.2.cmml">F</mi><mn id="S3.SS1.p6.2.m2.1.1.3" xref="S3.SS1.p6.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.2.m2.1b"><apply id="S3.SS1.p6.2.m2.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.2.m2.1.1.1.cmml" xref="S3.SS1.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p6.2.m2.1.1.2.cmml" xref="S3.SS1.p6.2.m2.1.1.2">𝐹</ci><cn type="integer" id="S3.SS1.p6.2.m2.1.1.3.cmml" xref="S3.SS1.p6.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.2.m2.1c">F_{1}</annotation></semantics></math> includes features such as position, heading, velocity, acceleration, agent type, agent size, valid sign, and one-hot embeddings for past timesteps.
2) Map context information
<math id="S3.SS1.p6.3.m3.1" class="ltx_Math" alttext="\mathcal{M}\in\mathbb{R}^{N_{l}\times N_{p}\times F_{2}}" display="inline"><semantics id="S3.SS1.p6.3.m3.1a"><mrow id="S3.SS1.p6.3.m3.1.1" xref="S3.SS1.p6.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.3.m3.1.1.2" xref="S3.SS1.p6.3.m3.1.1.2.cmml">ℳ</mi><mo id="S3.SS1.p6.3.m3.1.1.1" xref="S3.SS1.p6.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p6.3.m3.1.1.3" xref="S3.SS1.p6.3.m3.1.1.3.cmml"><mi id="S3.SS1.p6.3.m3.1.1.3.2" xref="S3.SS1.p6.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p6.3.m3.1.1.3.3" xref="S3.SS1.p6.3.m3.1.1.3.3.cmml"><msub id="S3.SS1.p6.3.m3.1.1.3.3.2" xref="S3.SS1.p6.3.m3.1.1.3.3.2.cmml"><mi id="S3.SS1.p6.3.m3.1.1.3.3.2.2" xref="S3.SS1.p6.3.m3.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.p6.3.m3.1.1.3.3.2.3" xref="S3.SS1.p6.3.m3.1.1.3.3.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p6.3.m3.1.1.3.3.1" xref="S3.SS1.p6.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p6.3.m3.1.1.3.3.3" xref="S3.SS1.p6.3.m3.1.1.3.3.3.cmml"><mi id="S3.SS1.p6.3.m3.1.1.3.3.3.2" xref="S3.SS1.p6.3.m3.1.1.3.3.3.2.cmml">N</mi><mi id="S3.SS1.p6.3.m3.1.1.3.3.3.3" xref="S3.SS1.p6.3.m3.1.1.3.3.3.3.cmml">p</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p6.3.m3.1.1.3.3.1a" xref="S3.SS1.p6.3.m3.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p6.3.m3.1.1.3.3.4" xref="S3.SS1.p6.3.m3.1.1.3.3.4.cmml"><mi id="S3.SS1.p6.3.m3.1.1.3.3.4.2" xref="S3.SS1.p6.3.m3.1.1.3.3.4.2.cmml">F</mi><mn id="S3.SS1.p6.3.m3.1.1.3.3.4.3" xref="S3.SS1.p6.3.m3.1.1.3.3.4.3.cmml">2</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.3.m3.1b"><apply id="S3.SS1.p6.3.m3.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1"><in id="S3.SS1.p6.3.m3.1.1.1.cmml" xref="S3.SS1.p6.3.m3.1.1.1"></in><ci id="S3.SS1.p6.3.m3.1.1.2.cmml" xref="S3.SS1.p6.3.m3.1.1.2">ℳ</ci><apply id="S3.SS1.p6.3.m3.1.1.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.1.1.3.1.cmml" xref="S3.SS1.p6.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p6.3.m3.1.1.3.2.cmml" xref="S3.SS1.p6.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p6.3.m3.1.1.3.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3"><times id="S3.SS1.p6.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.1"></times><apply id="S3.SS1.p6.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.1.1.3.3.2.1.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p6.3.m3.1.1.3.3.2.2.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.p6.3.m3.1.1.3.3.2.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.2.3">𝑙</ci></apply><apply id="S3.SS1.p6.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.1.1.3.3.3.1.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p6.3.m3.1.1.3.3.3.2.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.3.2">𝑁</ci><ci id="S3.SS1.p6.3.m3.1.1.3.3.3.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.3.3">𝑝</ci></apply><apply id="S3.SS1.p6.3.m3.1.1.3.3.4.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p6.3.m3.1.1.3.3.4.1.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.4">subscript</csymbol><ci id="S3.SS1.p6.3.m3.1.1.3.3.4.2.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.4.2">𝐹</ci><cn type="integer" id="S3.SS1.p6.3.m3.1.1.3.3.4.3.cmml" xref="S3.SS1.p6.3.m3.1.1.3.3.4.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.3.m3.1c">\mathcal{M}\in\mathbb{R}^{N_{l}\times N_{p}\times F_{2}}</annotation></semantics></math>,
where <math id="S3.SS1.p6.4.m4.1" class="ltx_Math" alttext="F_{2}" display="inline"><semantics id="S3.SS1.p6.4.m4.1a"><msub id="S3.SS1.p6.4.m4.1.1" xref="S3.SS1.p6.4.m4.1.1.cmml"><mi id="S3.SS1.p6.4.m4.1.1.2" xref="S3.SS1.p6.4.m4.1.1.2.cmml">F</mi><mn id="S3.SS1.p6.4.m4.1.1.3" xref="S3.SS1.p6.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.4.m4.1b"><apply id="S3.SS1.p6.4.m4.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.4.m4.1.1.1.cmml" xref="S3.SS1.p6.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p6.4.m4.1.1.2.cmml" xref="S3.SS1.p6.4.m4.1.1.2">𝐹</ci><cn type="integer" id="S3.SS1.p6.4.m4.1.1.3.cmml" xref="S3.SS1.p6.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.4.m4.1c">F_{2}</annotation></semantics></math> includes position, direction, and waypoint type. 3) Relative historical movements between selected agents and maps
<math id="S3.SS1.p6.5.m5.1" class="ltx_Math" alttext="\mathcal{R}\in\mathbb{R}^{N_{l}\times T_{p}\times F_{3}}" display="inline"><semantics id="S3.SS1.p6.5.m5.1a"><mrow id="S3.SS1.p6.5.m5.1.1" xref="S3.SS1.p6.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p6.5.m5.1.1.2" xref="S3.SS1.p6.5.m5.1.1.2.cmml">ℛ</mi><mo id="S3.SS1.p6.5.m5.1.1.1" xref="S3.SS1.p6.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS1.p6.5.m5.1.1.3" xref="S3.SS1.p6.5.m5.1.1.3.cmml"><mi id="S3.SS1.p6.5.m5.1.1.3.2" xref="S3.SS1.p6.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p6.5.m5.1.1.3.3" xref="S3.SS1.p6.5.m5.1.1.3.3.cmml"><msub id="S3.SS1.p6.5.m5.1.1.3.3.2" xref="S3.SS1.p6.5.m5.1.1.3.3.2.cmml"><mi id="S3.SS1.p6.5.m5.1.1.3.3.2.2" xref="S3.SS1.p6.5.m5.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.p6.5.m5.1.1.3.3.2.3" xref="S3.SS1.p6.5.m5.1.1.3.3.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p6.5.m5.1.1.3.3.1" xref="S3.SS1.p6.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p6.5.m5.1.1.3.3.3" xref="S3.SS1.p6.5.m5.1.1.3.3.3.cmml"><mi id="S3.SS1.p6.5.m5.1.1.3.3.3.2" xref="S3.SS1.p6.5.m5.1.1.3.3.3.2.cmml">T</mi><mi id="S3.SS1.p6.5.m5.1.1.3.3.3.3" xref="S3.SS1.p6.5.m5.1.1.3.3.3.3.cmml">p</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p6.5.m5.1.1.3.3.1a" xref="S3.SS1.p6.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S3.SS1.p6.5.m5.1.1.3.3.4" xref="S3.SS1.p6.5.m5.1.1.3.3.4.cmml"><mi id="S3.SS1.p6.5.m5.1.1.3.3.4.2" xref="S3.SS1.p6.5.m5.1.1.3.3.4.2.cmml">F</mi><mn id="S3.SS1.p6.5.m5.1.1.3.3.4.3" xref="S3.SS1.p6.5.m5.1.1.3.3.4.3.cmml">3</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.5.m5.1b"><apply id="S3.SS1.p6.5.m5.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1"><in id="S3.SS1.p6.5.m5.1.1.1.cmml" xref="S3.SS1.p6.5.m5.1.1.1"></in><ci id="S3.SS1.p6.5.m5.1.1.2.cmml" xref="S3.SS1.p6.5.m5.1.1.2">ℛ</ci><apply id="S3.SS1.p6.5.m5.1.1.3.cmml" xref="S3.SS1.p6.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p6.5.m5.1.1.3.1.cmml" xref="S3.SS1.p6.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p6.5.m5.1.1.3.2.cmml" xref="S3.SS1.p6.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS1.p6.5.m5.1.1.3.3.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3"><times id="S3.SS1.p6.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.1"></times><apply id="S3.SS1.p6.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.p6.5.m5.1.1.3.3.2.1.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.p6.5.m5.1.1.3.3.2.2.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.p6.5.m5.1.1.3.3.2.3.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.2.3">𝑙</ci></apply><apply id="S3.SS1.p6.5.m5.1.1.3.3.3.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p6.5.m5.1.1.3.3.3.1.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S3.SS1.p6.5.m5.1.1.3.3.3.2.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.3.2">𝑇</ci><ci id="S3.SS1.p6.5.m5.1.1.3.3.3.3.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.3.3">𝑝</ci></apply><apply id="S3.SS1.p6.5.m5.1.1.3.3.4.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.SS1.p6.5.m5.1.1.3.3.4.1.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.4">subscript</csymbol><ci id="S3.SS1.p6.5.m5.1.1.3.3.4.2.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.4.2">𝐹</ci><cn type="integer" id="S3.SS1.p6.5.m5.1.1.3.3.4.3.cmml" xref="S3.SS1.p6.5.m5.1.1.3.3.4.3">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.5.m5.1c">\mathcal{R}\in\mathbb{R}^{N_{l}\times T_{p}\times F_{3}}</annotation></semantics></math>,
where <math id="S3.SS1.p6.6.m6.1" class="ltx_Math" alttext="F_{3}" display="inline"><semantics id="S3.SS1.p6.6.m6.1a"><msub id="S3.SS1.p6.6.m6.1.1" xref="S3.SS1.p6.6.m6.1.1.cmml"><mi id="S3.SS1.p6.6.m6.1.1.2" xref="S3.SS1.p6.6.m6.1.1.2.cmml">F</mi><mn id="S3.SS1.p6.6.m6.1.1.3" xref="S3.SS1.p6.6.m6.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.6.m6.1b"><apply id="S3.SS1.p6.6.m6.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.6.m6.1.1.1.cmml" xref="S3.SS1.p6.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p6.6.m6.1.1.2.cmml" xref="S3.SS1.p6.6.m6.1.1.2">𝐹</ci><cn type="integer" id="S3.SS1.p6.6.m6.1.1.3.cmml" xref="S3.SS1.p6.6.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.6.m6.1c">F_{3}</annotation></semantics></math> indicates the relative position and orientation between the selected agent and the center of each road polyline over the past <math id="S3.SS1.p6.7.m7.1" class="ltx_Math" alttext="T_{p}" display="inline"><semantics id="S3.SS1.p6.7.m7.1a"><msub id="S3.SS1.p6.7.m7.1.1" xref="S3.SS1.p6.7.m7.1.1.cmml"><mi id="S3.SS1.p6.7.m7.1.1.2" xref="S3.SS1.p6.7.m7.1.1.2.cmml">T</mi><mi id="S3.SS1.p6.7.m7.1.1.3" xref="S3.SS1.p6.7.m7.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p6.7.m7.1b"><apply id="S3.SS1.p6.7.m7.1.1.cmml" xref="S3.SS1.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p6.7.m7.1.1.1.cmml" xref="S3.SS1.p6.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p6.7.m7.1.1.2.cmml" xref="S3.SS1.p6.7.m7.1.1.2">𝑇</ci><ci id="S3.SS1.p6.7.m7.1.1.3.cmml" xref="S3.SS1.p6.7.m7.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p6.7.m7.1c">T_{p}</annotation></semantics></math> timesteps.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Network Encoder</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.6" class="ltx_p"><span id="S3.SS2.p1.6.1" class="ltx_text ltx_font_bold">Scene Tokenization.</span>
Temporal information, including agent historical states <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝒜</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝒜</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{A}</annotation></semantics></math> and relative movement <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">ℛ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">ℛ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathcal{R}</annotation></semantics></math>, is processed using a Multi-Scale LSTM (MSL) model. Initially, the data is concurrently passed through a 1D CNN module with kernel sizes of <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mn id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><cn type="integer" id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">1</annotation></semantics></math>, <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="3" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mn id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">3</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><cn type="integer" id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">3</annotation></semantics></math>, and <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mn id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><cn type="integer" id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">5</annotation></semantics></math>. It then progresses through a two-layer LSTM network, where the output at the final timestep is captured, concatenated across feature dimensions, and passed through an additional MLP layer to generate the final feature token (see Fig. <a href="#S3.F5" title="Figure 5 ‣ III-B Network Encoder ‣ III Methodology ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). For the road polylines data <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{M}" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">ℳ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">ℳ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{M}</annotation></semantics></math>, a simple PointNet-like network is employed to extract the spatial features of each polyline.</p>
</div>
<figure id="S3.F5" class="ltx_figure"><img src="/html/2409.11696/assets/figs/scene_tokenization.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="199" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Detailed design of the proposed scene tokenization module.</figcaption>
</figure>
<div id="S3.SS2.p2" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.9" class="ltx_Math" alttext="\begin{array}[]{clcl}\mathcal{A}_{1}&amp;=\text{MSL}(\mathcal{A}),&amp;\mathcal{A}_{1}\in\mathbb{R}^{N_{a}\times D_{1}},\\
\mathcal{R}_{1}&amp;=\text{MSL}(\mathcal{R}),&amp;\mathcal{R}_{1}\in\mathbb{R}^{N_{l}\times D_{1}},\\
\mathcal{M}_{1}&amp;=\phi(\text{MLP}(\mathcal{M})),&amp;\mathcal{M}_{1}\in\mathbb{R}^{N_{l}\times D_{1}},\end{array}" display="block"><semantics id="S3.E4.m1.9a"><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E4.m1.9.9" xref="S3.E4.m1.9.9.cmml"><mtr id="S3.E4.m1.9.9a" xref="S3.E4.m1.9.9.cmml"><mtd id="S3.E4.m1.9.9b" xref="S3.E4.m1.9.9.cmml"><msub id="S3.E4.m1.3.3.3.4.1" xref="S3.E4.m1.3.3.3.4.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.3.4.1.2" xref="S3.E4.m1.3.3.3.4.1.2.cmml">𝒜</mi><mn id="S3.E4.m1.3.3.3.4.1.3" xref="S3.E4.m1.3.3.3.4.1.3.cmml">1</mn></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.9.9c" xref="S3.E4.m1.9.9.cmml"><mrow id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml"><mrow id="S3.E4.m1.2.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E4.m1.2.2.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.2.2.1.2.cmml"></mi><mo id="S3.E4.m1.2.2.2.2.2.2.1.1" xref="S3.E4.m1.2.2.2.2.2.2.1.1.cmml">=</mo><mrow id="S3.E4.m1.2.2.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.2.2.1.3.cmml"><mtext id="S3.E4.m1.2.2.2.2.2.2.1.3.2" xref="S3.E4.m1.2.2.2.2.2.2.1.3.2a.cmml">MSL</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.2.2.2.2.1.3.1" xref="S3.E4.m1.2.2.2.2.2.2.1.3.1.cmml">​</mo><mrow id="S3.E4.m1.2.2.2.2.2.2.1.3.3.2" xref="S3.E4.m1.2.2.2.2.2.2.1.3.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.2.2.2.2.1.3.3.2.1" xref="S3.E4.m1.2.2.2.2.2.2.1.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">𝒜</mi><mo stretchy="false" id="S3.E4.m1.2.2.2.2.2.2.1.3.3.2.2" xref="S3.E4.m1.2.2.2.2.2.2.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.2.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.1.cmml">,</mo></mrow></mtd><mtd id="S3.E4.m1.9.9d" xref="S3.E4.m1.9.9.cmml"><mrow id="S3.E4.m1.3.3.3.3.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml"><mrow id="S3.E4.m1.3.3.3.3.1.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml"><msub id="S3.E4.m1.3.3.3.3.1.1.1.2" xref="S3.E4.m1.3.3.3.3.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.3.3.1.1.1.2.2" xref="S3.E4.m1.3.3.3.3.1.1.1.2.2.cmml">𝒜</mi><mn id="S3.E4.m1.3.3.3.3.1.1.1.2.3" xref="S3.E4.m1.3.3.3.3.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E4.m1.3.3.3.3.1.1.1.1" xref="S3.E4.m1.3.3.3.3.1.1.1.1.cmml">∈</mo><msup id="S3.E4.m1.3.3.3.3.1.1.1.3" xref="S3.E4.m1.3.3.3.3.1.1.1.3.cmml"><mi id="S3.E4.m1.3.3.3.3.1.1.1.3.2" xref="S3.E4.m1.3.3.3.3.1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.E4.m1.3.3.3.3.1.1.1.3.3" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.cmml"><msub id="S3.E4.m1.3.3.3.3.1.1.1.3.3.2" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.cmml"><mi id="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.2" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.2.cmml">N</mi><mi id="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.3" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.3.cmml">a</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.3.3.3.3.1.1.1.3.3.1" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.1.cmml">×</mo><msub id="S3.E4.m1.3.3.3.3.1.1.1.3.3.3" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.cmml"><mi id="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.2" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.2.cmml">D</mi><mn id="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.3" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.3.cmml">1</mn></msub></mrow></msup></mrow><mo id="S3.E4.m1.3.3.3.3.1.1.2" xref="S3.E4.m1.3.3.3.3.1.1.1.cmml">,</mo></mrow></mtd><mtd id="S3.E4.m1.9.9e" xref="S3.E4.m1.9.9.cmml"></mtd></mtr><mtr id="S3.E4.m1.9.9f" xref="S3.E4.m1.9.9.cmml"><mtd id="S3.E4.m1.9.9g" xref="S3.E4.m1.9.9.cmml"><msub id="S3.E4.m1.6.6.6.4.1" xref="S3.E4.m1.6.6.6.4.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.6.6.6.4.1.2" xref="S3.E4.m1.6.6.6.4.1.2.cmml">ℛ</mi><mn id="S3.E4.m1.6.6.6.4.1.3" xref="S3.E4.m1.6.6.6.4.1.3.cmml">1</mn></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.9.9h" xref="S3.E4.m1.9.9.cmml"><mrow id="S3.E4.m1.5.5.5.2.2.2" xref="S3.E4.m1.5.5.5.2.2.2.1.cmml"><mrow id="S3.E4.m1.5.5.5.2.2.2.1" xref="S3.E4.m1.5.5.5.2.2.2.1.cmml"><mi id="S3.E4.m1.5.5.5.2.2.2.1.2" xref="S3.E4.m1.5.5.5.2.2.2.1.2.cmml"></mi><mo id="S3.E4.m1.5.5.5.2.2.2.1.1" xref="S3.E4.m1.5.5.5.2.2.2.1.1.cmml">=</mo><mrow id="S3.E4.m1.5.5.5.2.2.2.1.3" xref="S3.E4.m1.5.5.5.2.2.2.1.3.cmml"><mtext id="S3.E4.m1.5.5.5.2.2.2.1.3.2" xref="S3.E4.m1.5.5.5.2.2.2.1.3.2a.cmml">MSL</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.5.2.2.2.1.3.1" xref="S3.E4.m1.5.5.5.2.2.2.1.3.1.cmml">​</mo><mrow id="S3.E4.m1.5.5.5.2.2.2.1.3.3.2" xref="S3.E4.m1.5.5.5.2.2.2.1.3.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.5.2.2.2.1.3.3.2.1" xref="S3.E4.m1.5.5.5.2.2.2.1.3.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.4.1.1.1" xref="S3.E4.m1.4.4.4.1.1.1.cmml">ℛ</mi><mo stretchy="false" id="S3.E4.m1.5.5.5.2.2.2.1.3.3.2.2" xref="S3.E4.m1.5.5.5.2.2.2.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.5.5.5.2.2.2.2" xref="S3.E4.m1.5.5.5.2.2.2.1.cmml">,</mo></mrow></mtd><mtd id="S3.E4.m1.9.9i" xref="S3.E4.m1.9.9.cmml"><mrow id="S3.E4.m1.6.6.6.3.1.1" xref="S3.E4.m1.6.6.6.3.1.1.1.cmml"><mrow id="S3.E4.m1.6.6.6.3.1.1.1" xref="S3.E4.m1.6.6.6.3.1.1.1.cmml"><msub id="S3.E4.m1.6.6.6.3.1.1.1.2" xref="S3.E4.m1.6.6.6.3.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.6.6.6.3.1.1.1.2.2" xref="S3.E4.m1.6.6.6.3.1.1.1.2.2.cmml">ℛ</mi><mn id="S3.E4.m1.6.6.6.3.1.1.1.2.3" xref="S3.E4.m1.6.6.6.3.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E4.m1.6.6.6.3.1.1.1.1" xref="S3.E4.m1.6.6.6.3.1.1.1.1.cmml">∈</mo><msup id="S3.E4.m1.6.6.6.3.1.1.1.3" xref="S3.E4.m1.6.6.6.3.1.1.1.3.cmml"><mi id="S3.E4.m1.6.6.6.3.1.1.1.3.2" xref="S3.E4.m1.6.6.6.3.1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.E4.m1.6.6.6.3.1.1.1.3.3" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.cmml"><msub id="S3.E4.m1.6.6.6.3.1.1.1.3.3.2" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.cmml"><mi id="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.2" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.2.cmml">N</mi><mi id="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.3" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.6.6.6.3.1.1.1.3.3.1" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.1.cmml">×</mo><msub id="S3.E4.m1.6.6.6.3.1.1.1.3.3.3" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.cmml"><mi id="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.2" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.2.cmml">D</mi><mn id="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.3" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.3.cmml">1</mn></msub></mrow></msup></mrow><mo id="S3.E4.m1.6.6.6.3.1.1.2" xref="S3.E4.m1.6.6.6.3.1.1.1.cmml">,</mo></mrow></mtd><mtd id="S3.E4.m1.9.9j" xref="S3.E4.m1.9.9.cmml"></mtd></mtr><mtr id="S3.E4.m1.9.9k" xref="S3.E4.m1.9.9.cmml"><mtd id="S3.E4.m1.9.9l" xref="S3.E4.m1.9.9.cmml"><msub id="S3.E4.m1.9.9.9.4.1" xref="S3.E4.m1.9.9.9.4.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.9.9.9.4.1.2" xref="S3.E4.m1.9.9.9.4.1.2.cmml">ℳ</mi><mn id="S3.E4.m1.9.9.9.4.1.3" xref="S3.E4.m1.9.9.9.4.1.3.cmml">1</mn></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E4.m1.9.9m" xref="S3.E4.m1.9.9.cmml"><mrow id="S3.E4.m1.8.8.8.2.2.2" xref="S3.E4.m1.8.8.8.2.2.2.1.cmml"><mrow id="S3.E4.m1.8.8.8.2.2.2.1" xref="S3.E4.m1.8.8.8.2.2.2.1.cmml"><mi id="S3.E4.m1.8.8.8.2.2.2.1.3" xref="S3.E4.m1.8.8.8.2.2.2.1.3.cmml"></mi><mo id="S3.E4.m1.8.8.8.2.2.2.1.2" xref="S3.E4.m1.8.8.8.2.2.2.1.2.cmml">=</mo><mrow id="S3.E4.m1.8.8.8.2.2.2.1.1" xref="S3.E4.m1.8.8.8.2.2.2.1.1.cmml"><mi id="S3.E4.m1.8.8.8.2.2.2.1.1.3" xref="S3.E4.m1.8.8.8.2.2.2.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.8.2.2.2.1.1.2" xref="S3.E4.m1.8.8.8.2.2.2.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.2" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.cmml"><mtext id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.2" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.2a.cmml">MLP</mtext><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.1" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.3.2" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.3.2.1" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.7.7.7.1.1.1" xref="S3.E4.m1.7.7.7.1.1.1.cmml">ℳ</mi><mo stretchy="false" id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.3.2.2" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.3" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.8.8.8.2.2.2.2" xref="S3.E4.m1.8.8.8.2.2.2.1.cmml">,</mo></mrow></mtd><mtd id="S3.E4.m1.9.9n" xref="S3.E4.m1.9.9.cmml"><mrow id="S3.E4.m1.9.9.9.3.1.1" xref="S3.E4.m1.9.9.9.3.1.1.1.cmml"><mrow id="S3.E4.m1.9.9.9.3.1.1.1" xref="S3.E4.m1.9.9.9.3.1.1.1.cmml"><msub id="S3.E4.m1.9.9.9.3.1.1.1.2" xref="S3.E4.m1.9.9.9.3.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.9.9.9.3.1.1.1.2.2" xref="S3.E4.m1.9.9.9.3.1.1.1.2.2.cmml">ℳ</mi><mn id="S3.E4.m1.9.9.9.3.1.1.1.2.3" xref="S3.E4.m1.9.9.9.3.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E4.m1.9.9.9.3.1.1.1.1" xref="S3.E4.m1.9.9.9.3.1.1.1.1.cmml">∈</mo><msup id="S3.E4.m1.9.9.9.3.1.1.1.3" xref="S3.E4.m1.9.9.9.3.1.1.1.3.cmml"><mi id="S3.E4.m1.9.9.9.3.1.1.1.3.2" xref="S3.E4.m1.9.9.9.3.1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.E4.m1.9.9.9.3.1.1.1.3.3" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.cmml"><msub id="S3.E4.m1.9.9.9.3.1.1.1.3.3.2" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.cmml"><mi id="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.2" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.2.cmml">N</mi><mi id="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.3" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.3.cmml">l</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.9.9.9.3.1.1.1.3.3.1" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.1.cmml">×</mo><msub id="S3.E4.m1.9.9.9.3.1.1.1.3.3.3" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.cmml"><mi id="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.2" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.2.cmml">D</mi><mn id="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.3" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.3.cmml">1</mn></msub></mrow></msup></mrow><mo id="S3.E4.m1.9.9.9.3.1.1.2" xref="S3.E4.m1.9.9.9.3.1.1.1.cmml">,</mo></mrow></mtd><mtd id="S3.E4.m1.9.9o" xref="S3.E4.m1.9.9.cmml"></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E4.m1.9b"><matrix id="S3.E4.m1.9.9.cmml" xref="S3.E4.m1.9.9"><matrixrow id="S3.E4.m1.9.9a.cmml" xref="S3.E4.m1.9.9"><apply id="S3.E4.m1.3.3.3.4.1.cmml" xref="S3.E4.m1.3.3.3.4.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.4.1.1.cmml" xref="S3.E4.m1.3.3.3.4.1">subscript</csymbol><ci id="S3.E4.m1.3.3.3.4.1.2.cmml" xref="S3.E4.m1.3.3.3.4.1.2">𝒜</ci><cn type="integer" id="S3.E4.m1.3.3.3.4.1.3.cmml" xref="S3.E4.m1.3.3.3.4.1.3">1</cn></apply><apply id="S3.E4.m1.2.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2"><eq id="S3.E4.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.1"></eq><csymbol cd="latexml" id="S3.E4.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.2">absent</csymbol><apply id="S3.E4.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3"><times id="S3.E4.m1.2.2.2.2.2.2.1.3.1.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3.1"></times><ci id="S3.E4.m1.2.2.2.2.2.2.1.3.2a.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3.2"><mtext id="S3.E4.m1.2.2.2.2.2.2.1.3.2.cmml" xref="S3.E4.m1.2.2.2.2.2.2.1.3.2">MSL</mtext></ci><ci id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1">𝒜</ci></apply></apply><apply id="S3.E4.m1.3.3.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1"><in id="S3.E4.m1.3.3.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.1"></in><apply id="S3.E4.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.1.1.1.2.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.3.3.3.3.1.1.1.2.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.2.2">𝒜</ci><cn type="integer" id="S3.E4.m1.3.3.3.3.1.1.1.2.3.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.2.3">1</cn></apply><apply id="S3.E4.m1.3.3.3.3.1.1.1.3.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.1.1.1.3.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.3.3.3.3.1.1.1.3.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.2">ℝ</ci><apply id="S3.E4.m1.3.3.3.3.1.1.1.3.3.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3"><times id="S3.E4.m1.3.3.3.3.1.1.1.3.3.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.1"></times><apply id="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.2">𝑁</ci><ci id="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.3.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.2.3">𝑎</ci></apply><apply id="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.2">𝐷</ci><cn type="integer" id="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.3.cmml" xref="S3.E4.m1.3.3.3.3.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply><cerror id="S3.E4.m1.9.9b.cmml" xref="S3.E4.m1.9.9"><csymbol cd="ambiguous" id="S3.E4.m1.9.9c.cmml" xref="S3.E4.m1.9.9">missing-subexpression</csymbol></cerror></matrixrow><matrixrow id="S3.E4.m1.9.9d.cmml" xref="S3.E4.m1.9.9"><apply id="S3.E4.m1.6.6.6.4.1.cmml" xref="S3.E4.m1.6.6.6.4.1"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.4.1.1.cmml" xref="S3.E4.m1.6.6.6.4.1">subscript</csymbol><ci id="S3.E4.m1.6.6.6.4.1.2.cmml" xref="S3.E4.m1.6.6.6.4.1.2">ℛ</ci><cn type="integer" id="S3.E4.m1.6.6.6.4.1.3.cmml" xref="S3.E4.m1.6.6.6.4.1.3">1</cn></apply><apply id="S3.E4.m1.5.5.5.2.2.2.1.cmml" xref="S3.E4.m1.5.5.5.2.2.2"><eq id="S3.E4.m1.5.5.5.2.2.2.1.1.cmml" xref="S3.E4.m1.5.5.5.2.2.2.1.1"></eq><csymbol cd="latexml" id="S3.E4.m1.5.5.5.2.2.2.1.2.cmml" xref="S3.E4.m1.5.5.5.2.2.2.1.2">absent</csymbol><apply id="S3.E4.m1.5.5.5.2.2.2.1.3.cmml" xref="S3.E4.m1.5.5.5.2.2.2.1.3"><times id="S3.E4.m1.5.5.5.2.2.2.1.3.1.cmml" xref="S3.E4.m1.5.5.5.2.2.2.1.3.1"></times><ci id="S3.E4.m1.5.5.5.2.2.2.1.3.2a.cmml" xref="S3.E4.m1.5.5.5.2.2.2.1.3.2"><mtext id="S3.E4.m1.5.5.5.2.2.2.1.3.2.cmml" xref="S3.E4.m1.5.5.5.2.2.2.1.3.2">MSL</mtext></ci><ci id="S3.E4.m1.4.4.4.1.1.1.cmml" xref="S3.E4.m1.4.4.4.1.1.1">ℛ</ci></apply></apply><apply id="S3.E4.m1.6.6.6.3.1.1.1.cmml" xref="S3.E4.m1.6.6.6.3.1.1"><in id="S3.E4.m1.6.6.6.3.1.1.1.1.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.1"></in><apply id="S3.E4.m1.6.6.6.3.1.1.1.2.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.3.1.1.1.2.1.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.6.6.6.3.1.1.1.2.2.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.2.2">ℛ</ci><cn type="integer" id="S3.E4.m1.6.6.6.3.1.1.1.2.3.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.2.3">1</cn></apply><apply id="S3.E4.m1.6.6.6.3.1.1.1.3.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.3.1.1.1.3.1.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.6.6.6.3.1.1.1.3.2.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.2">ℝ</ci><apply id="S3.E4.m1.6.6.6.3.1.1.1.3.3.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3"><times id="S3.E4.m1.6.6.6.3.1.1.1.3.3.1.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.1"></times><apply id="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.1.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.2.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.2">𝑁</ci><ci id="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.3.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.2.3">𝑙</ci></apply><apply id="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.2">𝐷</ci><cn type="integer" id="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.3.cmml" xref="S3.E4.m1.6.6.6.3.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply><cerror id="S3.E4.m1.9.9e.cmml" xref="S3.E4.m1.9.9"><csymbol cd="ambiguous" id="S3.E4.m1.9.9f.cmml" xref="S3.E4.m1.9.9">missing-subexpression</csymbol></cerror></matrixrow><matrixrow id="S3.E4.m1.9.9g.cmml" xref="S3.E4.m1.9.9"><apply id="S3.E4.m1.9.9.9.4.1.cmml" xref="S3.E4.m1.9.9.9.4.1"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.9.4.1.1.cmml" xref="S3.E4.m1.9.9.9.4.1">subscript</csymbol><ci id="S3.E4.m1.9.9.9.4.1.2.cmml" xref="S3.E4.m1.9.9.9.4.1.2">ℳ</ci><cn type="integer" id="S3.E4.m1.9.9.9.4.1.3.cmml" xref="S3.E4.m1.9.9.9.4.1.3">1</cn></apply><apply id="S3.E4.m1.8.8.8.2.2.2.1.cmml" xref="S3.E4.m1.8.8.8.2.2.2"><eq id="S3.E4.m1.8.8.8.2.2.2.1.2.cmml" xref="S3.E4.m1.8.8.8.2.2.2.1.2"></eq><csymbol cd="latexml" id="S3.E4.m1.8.8.8.2.2.2.1.3.cmml" xref="S3.E4.m1.8.8.8.2.2.2.1.3">absent</csymbol><apply id="S3.E4.m1.8.8.8.2.2.2.1.1.cmml" xref="S3.E4.m1.8.8.8.2.2.2.1.1"><times id="S3.E4.m1.8.8.8.2.2.2.1.1.2.cmml" xref="S3.E4.m1.8.8.8.2.2.2.1.1.2"></times><ci id="S3.E4.m1.8.8.8.2.2.2.1.1.3.cmml" xref="S3.E4.m1.8.8.8.2.2.2.1.1.3">italic-ϕ</ci><apply id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1"><times id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.1"></times><ci id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.2a.cmml" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.2"><mtext id="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.8.2.2.2.1.1.1.1.1.2">MLP</mtext></ci><ci id="S3.E4.m1.7.7.7.1.1.1.cmml" xref="S3.E4.m1.7.7.7.1.1.1">ℳ</ci></apply></apply></apply><apply id="S3.E4.m1.9.9.9.3.1.1.1.cmml" xref="S3.E4.m1.9.9.9.3.1.1"><in id="S3.E4.m1.9.9.9.3.1.1.1.1.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.1"></in><apply id="S3.E4.m1.9.9.9.3.1.1.1.2.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.9.3.1.1.1.2.1.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.9.9.9.3.1.1.1.2.2.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.2.2">ℳ</ci><cn type="integer" id="S3.E4.m1.9.9.9.3.1.1.1.2.3.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.2.3">1</cn></apply><apply id="S3.E4.m1.9.9.9.3.1.1.1.3.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.9.3.1.1.1.3.1.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3">superscript</csymbol><ci id="S3.E4.m1.9.9.9.3.1.1.1.3.2.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.2">ℝ</ci><apply id="S3.E4.m1.9.9.9.3.1.1.1.3.3.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3"><times id="S3.E4.m1.9.9.9.3.1.1.1.3.3.1.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.1"></times><apply id="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.1.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.2">subscript</csymbol><ci id="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.2.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.2">𝑁</ci><ci id="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.3.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.2.3">𝑙</ci></apply><apply id="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.2">𝐷</ci><cn type="integer" id="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.3.cmml" xref="S3.E4.m1.9.9.9.3.1.1.1.3.3.3.3">1</cn></apply></apply></apply></apply><cerror id="S3.E4.m1.9.9h.cmml" xref="S3.E4.m1.9.9"><csymbol cd="ambiguous" id="S3.E4.m1.9.9i.cmml" xref="S3.E4.m1.9.9">missing-subexpression</csymbol></cerror></matrixrow></matrix></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.9c">\begin{array}[]{clcl}\mathcal{A}_{1}&amp;=\text{MSL}(\mathcal{A}),&amp;\mathcal{A}_{1}\in\mathbb{R}^{N_{a}\times D_{1}},\\
\mathcal{R}_{1}&amp;=\text{MSL}(\mathcal{R}),&amp;\mathcal{R}_{1}\in\mathbb{R}^{N_{l}\times D_{1}},\\
\mathcal{M}_{1}&amp;=\phi(\text{MLP}(\mathcal{M})),&amp;\mathcal{M}_{1}\in\mathbb{R}^{N_{l}\times D_{1}},\end{array}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">where <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\phi(\cdot)" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mrow id="S3.SS2.p3.1.m1.1.2" xref="S3.SS2.p3.1.m1.1.2.cmml"><mi id="S3.SS2.p3.1.m1.1.2.2" xref="S3.SS2.p3.1.m1.1.2.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.1.m1.1.2.1" xref="S3.SS2.p3.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p3.1.m1.1.2.3.2" xref="S3.SS2.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p3.1.m1.1.2.3.2.1" xref="S3.SS2.p3.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p3.1.m1.1.2.3.2.2" xref="S3.SS2.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.2"><times id="S3.SS2.p3.1.m1.1.2.1.cmml" xref="S3.SS2.p3.1.m1.1.2.1"></times><ci id="S3.SS2.p3.1.m1.1.2.2.cmml" xref="S3.SS2.p3.1.m1.1.2.2">italic-ϕ</ci><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\phi(\cdot)</annotation></semantics></math> denotes the max-pooling operation.
In this process, we integrate encodings from various input modalities using Multi-Context Gating (MCG) as proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. We utilize a cascading method where, at each stage, two distinct modalities are chosen from a set of three to be input into the MCG module. The output from one MCG module is then fed into the subsequent MCG module in the sequence, as illustrated in Fig.<a href="#S3.F5" title="Figure 5 ‣ III-B Network Encoder ‣ III Methodology ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.61" class="ltx_Math" alttext="\begin{split}(\mathcal{A}_{2},\mathcal{R}_{2})&amp;=\text{MCG}(\mathcal{A}_{1},\mathcal{R}_{1}),\\
(\mathcal{M}_{2},\mathcal{R}_{3})&amp;=\text{MCG}(\mathcal{M}_{1},\mathcal{R}_{2}),\\
(\mathcal{A}_{3},\mathcal{M}_{3})&amp;=\text{MCG}(\mathcal{A}_{2},\mathcal{M}_{2}).\end{split}" display="block"><semantics id="S3.E5.m1.61a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E5.m1.61.61.10"><mtr id="S3.E5.m1.61.61.10a"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.61.61.10b"><mrow id="S3.E5.m1.54.54.3.53.19.9.9"><mo stretchy="false" id="S3.E5.m1.1.1.1.1.1.1">(</mo><msub id="S3.E5.m1.53.53.2.52.18.8.8.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml">𝒜</mi><mn id="S3.E5.m1.3.3.3.3.3.3.1" xref="S3.E5.m1.3.3.3.3.3.3.1.cmml">2</mn></msub><mo id="S3.E5.m1.4.4.4.4.4.4">,</mo><msub id="S3.E5.m1.54.54.3.53.19.9.9.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.5.5.5.5.5.5" xref="S3.E5.m1.5.5.5.5.5.5.cmml">ℛ</mi><mn id="S3.E5.m1.6.6.6.6.6.6.1" xref="S3.E5.m1.6.6.6.6.6.6.1.cmml">2</mn></msub><mo stretchy="false" id="S3.E5.m1.7.7.7.7.7.7">)</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.61.61.10c"><mrow id="S3.E5.m1.55.55.4.54.20.11.11"><mrow id="S3.E5.m1.55.55.4.54.20.11.11.1"><mi id="S3.E5.m1.55.55.4.54.20.11.11.1.3"></mi><mo id="S3.E5.m1.8.8.8.8.1.1" xref="S3.E5.m1.8.8.8.8.1.1.cmml">=</mo><mrow id="S3.E5.m1.55.55.4.54.20.11.11.1.2"><mtext id="S3.E5.m1.9.9.9.9.2.2" xref="S3.E5.m1.9.9.9.9.2.2a.cmml">MCG</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.55.55.4.54.20.11.11.1.2.3">​</mo><mrow id="S3.E5.m1.55.55.4.54.20.11.11.1.2.2.2"><mo stretchy="false" id="S3.E5.m1.10.10.10.10.3.3">(</mo><msub id="S3.E5.m1.55.55.4.54.20.11.11.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.11.11.11.11.4.4" xref="S3.E5.m1.11.11.11.11.4.4.cmml">𝒜</mi><mn id="S3.E5.m1.12.12.12.12.5.5.1" xref="S3.E5.m1.12.12.12.12.5.5.1.cmml">1</mn></msub><mo id="S3.E5.m1.13.13.13.13.6.6">,</mo><msub id="S3.E5.m1.55.55.4.54.20.11.11.1.2.2.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.14.14.14.14.7.7" xref="S3.E5.m1.14.14.14.14.7.7.cmml">ℛ</mi><mn id="S3.E5.m1.15.15.15.15.8.8.1" xref="S3.E5.m1.15.15.15.15.8.8.1.cmml">1</mn></msub><mo stretchy="false" id="S3.E5.m1.16.16.16.16.9.9">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.17.17.17.17.10.10">,</mo></mrow></mtd></mtr><mtr id="S3.E5.m1.61.61.10d"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.61.61.10e"><mrow id="S3.E5.m1.57.57.6.56.19.9.9"><mo stretchy="false" id="S3.E5.m1.18.18.18.1.1.1">(</mo><msub id="S3.E5.m1.56.56.5.55.18.8.8.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.19.19.19.2.2.2" xref="S3.E5.m1.19.19.19.2.2.2.cmml">ℳ</mi><mn id="S3.E5.m1.20.20.20.3.3.3.1" xref="S3.E5.m1.20.20.20.3.3.3.1.cmml">2</mn></msub><mo id="S3.E5.m1.21.21.21.4.4.4">,</mo><msub id="S3.E5.m1.57.57.6.56.19.9.9.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.22.22.22.5.5.5" xref="S3.E5.m1.22.22.22.5.5.5.cmml">ℛ</mi><mn id="S3.E5.m1.23.23.23.6.6.6.1" xref="S3.E5.m1.23.23.23.6.6.6.1.cmml">3</mn></msub><mo stretchy="false" id="S3.E5.m1.24.24.24.7.7.7">)</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.61.61.10f"><mrow id="S3.E5.m1.58.58.7.57.20.11.11"><mrow id="S3.E5.m1.58.58.7.57.20.11.11.1"><mi id="S3.E5.m1.58.58.7.57.20.11.11.1.3"></mi><mo id="S3.E5.m1.25.25.25.8.1.1" xref="S3.E5.m1.25.25.25.8.1.1.cmml">=</mo><mrow id="S3.E5.m1.58.58.7.57.20.11.11.1.2"><mtext id="S3.E5.m1.26.26.26.9.2.2" xref="S3.E5.m1.26.26.26.9.2.2a.cmml">MCG</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.58.58.7.57.20.11.11.1.2.3">​</mo><mrow id="S3.E5.m1.58.58.7.57.20.11.11.1.2.2.2"><mo stretchy="false" id="S3.E5.m1.27.27.27.10.3.3">(</mo><msub id="S3.E5.m1.58.58.7.57.20.11.11.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.28.28.28.11.4.4" xref="S3.E5.m1.28.28.28.11.4.4.cmml">ℳ</mi><mn id="S3.E5.m1.29.29.29.12.5.5.1" xref="S3.E5.m1.29.29.29.12.5.5.1.cmml">1</mn></msub><mo id="S3.E5.m1.30.30.30.13.6.6">,</mo><msub id="S3.E5.m1.58.58.7.57.20.11.11.1.2.2.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.31.31.31.14.7.7" xref="S3.E5.m1.31.31.31.14.7.7.cmml">ℛ</mi><mn id="S3.E5.m1.32.32.32.15.8.8.1" xref="S3.E5.m1.32.32.32.15.8.8.1.cmml">2</mn></msub><mo stretchy="false" id="S3.E5.m1.33.33.33.16.9.9">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.34.34.34.17.10.10">,</mo></mrow></mtd></mtr><mtr id="S3.E5.m1.61.61.10g"><mtd class="ltx_align_right" columnalign="right" id="S3.E5.m1.61.61.10h"><mrow id="S3.E5.m1.60.60.9.59.19.9.9"><mo stretchy="false" id="S3.E5.m1.35.35.35.1.1.1">(</mo><msub id="S3.E5.m1.59.59.8.58.18.8.8.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.36.36.36.2.2.2" xref="S3.E5.m1.36.36.36.2.2.2.cmml">𝒜</mi><mn id="S3.E5.m1.37.37.37.3.3.3.1" xref="S3.E5.m1.37.37.37.3.3.3.1.cmml">3</mn></msub><mo id="S3.E5.m1.38.38.38.4.4.4">,</mo><msub id="S3.E5.m1.60.60.9.59.19.9.9.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.39.39.39.5.5.5" xref="S3.E5.m1.39.39.39.5.5.5.cmml">ℳ</mi><mn id="S3.E5.m1.40.40.40.6.6.6.1" xref="S3.E5.m1.40.40.40.6.6.6.1.cmml">3</mn></msub><mo stretchy="false" id="S3.E5.m1.41.41.41.7.7.7">)</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E5.m1.61.61.10i"><mrow id="S3.E5.m1.61.61.10.60.20.11.11"><mrow id="S3.E5.m1.61.61.10.60.20.11.11.1"><mi id="S3.E5.m1.61.61.10.60.20.11.11.1.3"></mi><mo id="S3.E5.m1.42.42.42.8.1.1" xref="S3.E5.m1.42.42.42.8.1.1.cmml">=</mo><mrow id="S3.E5.m1.61.61.10.60.20.11.11.1.2"><mtext id="S3.E5.m1.43.43.43.9.2.2" xref="S3.E5.m1.43.43.43.9.2.2a.cmml">MCG</mtext><mo lspace="0em" rspace="0em" id="S3.E5.m1.61.61.10.60.20.11.11.1.2.3">​</mo><mrow id="S3.E5.m1.61.61.10.60.20.11.11.1.2.2.2"><mo stretchy="false" id="S3.E5.m1.44.44.44.10.3.3">(</mo><msub id="S3.E5.m1.61.61.10.60.20.11.11.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.45.45.45.11.4.4" xref="S3.E5.m1.45.45.45.11.4.4.cmml">𝒜</mi><mn id="S3.E5.m1.46.46.46.12.5.5.1" xref="S3.E5.m1.46.46.46.12.5.5.1.cmml">2</mn></msub><mo id="S3.E5.m1.47.47.47.13.6.6">,</mo><msub id="S3.E5.m1.61.61.10.60.20.11.11.1.2.2.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.48.48.48.14.7.7" xref="S3.E5.m1.48.48.48.14.7.7.cmml">ℳ</mi><mn id="S3.E5.m1.49.49.49.15.8.8.1" xref="S3.E5.m1.49.49.49.15.8.8.1.cmml">2</mn></msub><mo stretchy="false" id="S3.E5.m1.50.50.50.16.9.9">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.51.51.51.17.10.10">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E5.m1.61b"><apply id="S3.E5.m1.52.52.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S3.E5.m1.52.52.1.1.1.1.1.cmml"><eq id="S3.E5.m1.8.8.8.8.1.1.cmml" xref="S3.E5.m1.8.8.8.8.1.1"></eq><interval closure="open" id="S3.E5.m1.52.52.1.1.1.1.1.2.3.cmml"><apply id="S3.E5.m1.52.52.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2">𝒜</ci><cn type="integer" id="S3.E5.m1.3.3.3.3.3.3.1.cmml" xref="S3.E5.m1.3.3.3.3.3.3.1">2</cn></apply><apply id="S3.E5.m1.52.52.1.1.1.1.1.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.1.1.2.2.2.1.cmml">subscript</csymbol><ci id="S3.E5.m1.5.5.5.5.5.5.cmml" xref="S3.E5.m1.5.5.5.5.5.5">ℛ</ci><cn type="integer" id="S3.E5.m1.6.6.6.6.6.6.1.cmml" xref="S3.E5.m1.6.6.6.6.6.6.1">2</cn></apply></interval><apply id="S3.E5.m1.52.52.1.1.1.1.1.4.cmml"><times id="S3.E5.m1.52.52.1.1.1.1.1.4.3.cmml"></times><ci id="S3.E5.m1.9.9.9.9.2.2a.cmml" xref="S3.E5.m1.9.9.9.9.2.2"><mtext id="S3.E5.m1.9.9.9.9.2.2.cmml" xref="S3.E5.m1.9.9.9.9.2.2">MCG</mtext></ci><interval closure="open" id="S3.E5.m1.52.52.1.1.1.1.1.4.2.3.cmml"><apply id="S3.E5.m1.52.52.1.1.1.1.1.3.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.1.1.3.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E5.m1.11.11.11.11.4.4.cmml" xref="S3.E5.m1.11.11.11.11.4.4">𝒜</ci><cn type="integer" id="S3.E5.m1.12.12.12.12.5.5.1.cmml" xref="S3.E5.m1.12.12.12.12.5.5.1">1</cn></apply><apply id="S3.E5.m1.52.52.1.1.1.1.1.4.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.1.1.4.2.2.2.1.cmml">subscript</csymbol><ci id="S3.E5.m1.14.14.14.14.7.7.cmml" xref="S3.E5.m1.14.14.14.14.7.7">ℛ</ci><cn type="integer" id="S3.E5.m1.15.15.15.15.8.8.1.cmml" xref="S3.E5.m1.15.15.15.15.8.8.1">1</cn></apply></interval></apply></apply><apply id="S3.E5.m1.52.52.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S3.E5.m1.52.52.1.1.1.2.2.1.1.cmml"><eq id="S3.E5.m1.25.25.25.8.1.1.cmml" xref="S3.E5.m1.25.25.25.8.1.1"></eq><interval closure="open" id="S3.E5.m1.52.52.1.1.1.2.2.1.1.2.3.cmml"><apply id="S3.E5.m1.52.52.1.1.1.2.2.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.2.2.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E5.m1.19.19.19.2.2.2.cmml" xref="S3.E5.m1.19.19.19.2.2.2">ℳ</ci><cn type="integer" id="S3.E5.m1.20.20.20.3.3.3.1.cmml" xref="S3.E5.m1.20.20.20.3.3.3.1">2</cn></apply><apply id="S3.E5.m1.52.52.1.1.1.2.2.1.1.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.2.2.1.1.2.2.2.1.cmml">subscript</csymbol><ci id="S3.E5.m1.22.22.22.5.5.5.cmml" xref="S3.E5.m1.22.22.22.5.5.5">ℛ</ci><cn type="integer" id="S3.E5.m1.23.23.23.6.6.6.1.cmml" xref="S3.E5.m1.23.23.23.6.6.6.1">3</cn></apply></interval><apply id="S3.E5.m1.52.52.1.1.1.2.2.1.1.4.cmml"><times id="S3.E5.m1.52.52.1.1.1.2.2.1.1.4.3.cmml"></times><ci id="S3.E5.m1.26.26.26.9.2.2a.cmml" xref="S3.E5.m1.26.26.26.9.2.2"><mtext id="S3.E5.m1.26.26.26.9.2.2.cmml" xref="S3.E5.m1.26.26.26.9.2.2">MCG</mtext></ci><interval closure="open" id="S3.E5.m1.52.52.1.1.1.2.2.1.1.4.2.3.cmml"><apply id="S3.E5.m1.52.52.1.1.1.2.2.1.1.3.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.2.2.1.1.3.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E5.m1.28.28.28.11.4.4.cmml" xref="S3.E5.m1.28.28.28.11.4.4">ℳ</ci><cn type="integer" id="S3.E5.m1.29.29.29.12.5.5.1.cmml" xref="S3.E5.m1.29.29.29.12.5.5.1">1</cn></apply><apply id="S3.E5.m1.52.52.1.1.1.2.2.1.1.4.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.2.2.1.1.4.2.2.2.1.cmml">subscript</csymbol><ci id="S3.E5.m1.31.31.31.14.7.7.cmml" xref="S3.E5.m1.31.31.31.14.7.7">ℛ</ci><cn type="integer" id="S3.E5.m1.32.32.32.15.8.8.1.cmml" xref="S3.E5.m1.32.32.32.15.8.8.1">2</cn></apply></interval></apply></apply><apply id="S3.E5.m1.52.52.1.1.1.2.2.2.2.cmml"><eq id="S3.E5.m1.42.42.42.8.1.1.cmml" xref="S3.E5.m1.42.42.42.8.1.1"></eq><interval closure="open" id="S3.E5.m1.52.52.1.1.1.2.2.2.2.2.3.cmml"><apply id="S3.E5.m1.52.52.1.1.1.2.2.2.2.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.2.2.2.2.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E5.m1.36.36.36.2.2.2.cmml" xref="S3.E5.m1.36.36.36.2.2.2">𝒜</ci><cn type="integer" id="S3.E5.m1.37.37.37.3.3.3.1.cmml" xref="S3.E5.m1.37.37.37.3.3.3.1">3</cn></apply><apply id="S3.E5.m1.52.52.1.1.1.2.2.2.2.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.2.2.2.2.2.2.2.1.cmml">subscript</csymbol><ci id="S3.E5.m1.39.39.39.5.5.5.cmml" xref="S3.E5.m1.39.39.39.5.5.5">ℳ</ci><cn type="integer" id="S3.E5.m1.40.40.40.6.6.6.1.cmml" xref="S3.E5.m1.40.40.40.6.6.6.1">3</cn></apply></interval><apply id="S3.E5.m1.52.52.1.1.1.2.2.2.2.4.cmml"><times id="S3.E5.m1.52.52.1.1.1.2.2.2.2.4.3.cmml"></times><ci id="S3.E5.m1.43.43.43.9.2.2a.cmml" xref="S3.E5.m1.43.43.43.9.2.2"><mtext id="S3.E5.m1.43.43.43.9.2.2.cmml" xref="S3.E5.m1.43.43.43.9.2.2">MCG</mtext></ci><interval closure="open" id="S3.E5.m1.52.52.1.1.1.2.2.2.2.4.2.3.cmml"><apply id="S3.E5.m1.52.52.1.1.1.2.2.2.2.3.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.2.2.2.2.3.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E5.m1.45.45.45.11.4.4.cmml" xref="S3.E5.m1.45.45.45.11.4.4">𝒜</ci><cn type="integer" id="S3.E5.m1.46.46.46.12.5.5.1.cmml" xref="S3.E5.m1.46.46.46.12.5.5.1">2</cn></apply><apply id="S3.E5.m1.52.52.1.1.1.2.2.2.2.4.2.2.2.cmml"><csymbol cd="ambiguous" id="S3.E5.m1.52.52.1.1.1.2.2.2.2.4.2.2.2.1.cmml">subscript</csymbol><ci id="S3.E5.m1.48.48.48.14.7.7.cmml" xref="S3.E5.m1.48.48.48.14.7.7">ℳ</ci><cn type="integer" id="S3.E5.m1.49.49.49.15.8.8.1.cmml" xref="S3.E5.m1.49.49.49.15.8.8.1">2</cn></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.61c">\begin{split}(\mathcal{A}_{2},\mathcal{R}_{2})&amp;=\text{MCG}(\mathcal{A}_{1},\mathcal{R}_{1}),\\
(\mathcal{M}_{2},\mathcal{R}_{3})&amp;=\text{MCG}(\mathcal{M}_{1},\mathcal{R}_{2}),\\
(\mathcal{A}_{3},\mathcal{M}_{3})&amp;=\text{MCG}(\mathcal{A}_{2},\mathcal{M}_{2}).\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p4.4" class="ltx_p">Then, we use <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{A}_{3}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">𝒜</mi><mn id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝒜</ci><cn type="integer" id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\mathcal{A}_{3}</annotation></semantics></math> as the final agent tokens <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{A}_{agent}\in\mathbb{R}^{N_{a}\times D_{1}}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><mrow id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><msub id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.2.m2.1.1.2.2" xref="S3.SS2.p4.2.m2.1.1.2.2.cmml">𝒜</mi><mrow id="S3.SS2.p4.2.m2.1.1.2.3" xref="S3.SS2.p4.2.m2.1.1.2.3.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2.3.2" xref="S3.SS2.p4.2.m2.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.2.3.1" xref="S3.SS2.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.2.3.3" xref="S3.SS2.p4.2.m2.1.1.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.2.3.1a" xref="S3.SS2.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.2.3.4" xref="S3.SS2.p4.2.m2.1.1.2.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.2.3.1b" xref="S3.SS2.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.2.3.5" xref="S3.SS2.p4.2.m2.1.1.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.2.3.1c" xref="S3.SS2.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.2.3.6" xref="S3.SS2.p4.2.m2.1.1.2.3.6.cmml">t</mi></mrow></msub><mo id="S3.SS2.p4.2.m2.1.1.1" xref="S3.SS2.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml"><mi id="S3.SS2.p4.2.m2.1.1.3.2" xref="S3.SS2.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.2.m2.1.1.3.3" xref="S3.SS2.p4.2.m2.1.1.3.3.cmml"><msub id="S3.SS2.p4.2.m2.1.1.3.3.2" xref="S3.SS2.p4.2.m2.1.1.3.3.2.cmml"><mi id="S3.SS2.p4.2.m2.1.1.3.3.2.2" xref="S3.SS2.p4.2.m2.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS2.p4.2.m2.1.1.3.3.2.3" xref="S3.SS2.p4.2.m2.1.1.3.3.2.3.cmml">a</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p4.2.m2.1.1.3.3.1" xref="S3.SS2.p4.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p4.2.m2.1.1.3.3.3" xref="S3.SS2.p4.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.p4.2.m2.1.1.3.3.3.2" xref="S3.SS2.p4.2.m2.1.1.3.3.3.2.cmml">D</mi><mn id="S3.SS2.p4.2.m2.1.1.3.3.3.3" xref="S3.SS2.p4.2.m2.1.1.3.3.3.3.cmml">1</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><in id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1.1"></in><apply id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.2.1.cmml" xref="S3.SS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2.2">𝒜</ci><apply id="S3.SS2.p4.2.m2.1.1.2.3.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3"><times id="S3.SS2.p4.2.m2.1.1.2.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3.1"></times><ci id="S3.SS2.p4.2.m2.1.1.2.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3.2">𝑎</ci><ci id="S3.SS2.p4.2.m2.1.1.2.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3.3">𝑔</ci><ci id="S3.SS2.p4.2.m2.1.1.2.3.4.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3.4">𝑒</ci><ci id="S3.SS2.p4.2.m2.1.1.2.3.5.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3.5">𝑛</ci><ci id="S3.SS2.p4.2.m2.1.1.2.3.6.cmml" xref="S3.SS2.p4.2.m2.1.1.2.3.6">𝑡</ci></apply></apply><apply id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.p4.2.m2.1.1.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3"><times id="S3.SS2.p4.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.1"></times><apply id="S3.SS2.p4.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.3.3.2.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.3.3.2.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS2.p4.2.m2.1.1.3.3.2.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.2.3">𝑎</ci></apply><apply id="S3.SS2.p4.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.3.2">𝐷</ci><cn type="integer" id="S3.SS2.p4.2.m2.1.1.3.3.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">\mathcal{A}_{agent}\in\mathbb{R}^{N_{a}\times D_{1}}</annotation></semantics></math> and <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{M}_{3}+\mathcal{R}_{3}" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mrow id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><msub id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.3.m3.1.1.2.2" xref="S3.SS2.p4.3.m3.1.1.2.2.cmml">ℳ</mi><mn id="S3.SS2.p4.3.m3.1.1.2.3" xref="S3.SS2.p4.3.m3.1.1.2.3.cmml">3</mn></msub><mo id="S3.SS2.p4.3.m3.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.cmml">+</mo><msub id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.3.m3.1.1.3.2" xref="S3.SS2.p4.3.m3.1.1.3.2.cmml">ℛ</mi><mn id="S3.SS2.p4.3.m3.1.1.3.3" xref="S3.SS2.p4.3.m3.1.1.3.3.cmml">3</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><plus id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1"></plus><apply id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.2.1.cmml" xref="S3.SS2.p4.3.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2.2">ℳ</ci><cn type="integer" id="S3.SS2.p4.3.m3.1.1.2.3.cmml" xref="S3.SS2.p4.3.m3.1.1.2.3">3</cn></apply><apply id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.3.1.cmml" xref="S3.SS2.p4.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.3.2.cmml" xref="S3.SS2.p4.3.m3.1.1.3.2">ℛ</ci><cn type="integer" id="S3.SS2.p4.3.m3.1.1.3.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">\mathcal{M}_{3}+\mathcal{R}_{3}</annotation></semantics></math> as the final map tokens <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="\mathcal{M}_{map}\in\mathbb{R}^{N_{p}\times D_{1}}" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><mrow id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><msub id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p4.4.m4.1.1.2.2" xref="S3.SS2.p4.4.m4.1.1.2.2.cmml">ℳ</mi><mrow id="S3.SS2.p4.4.m4.1.1.2.3" xref="S3.SS2.p4.4.m4.1.1.2.3.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2.3.2" xref="S3.SS2.p4.4.m4.1.1.2.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.4.m4.1.1.2.3.1" xref="S3.SS2.p4.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p4.4.m4.1.1.2.3.3" xref="S3.SS2.p4.4.m4.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.4.m4.1.1.2.3.1a" xref="S3.SS2.p4.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p4.4.m4.1.1.2.3.4" xref="S3.SS2.p4.4.m4.1.1.2.3.4.cmml">p</mi></mrow></msub><mo id="S3.SS2.p4.4.m4.1.1.1" xref="S3.SS2.p4.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml"><mi id="S3.SS2.p4.4.m4.1.1.3.2" xref="S3.SS2.p4.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.4.m4.1.1.3.3" xref="S3.SS2.p4.4.m4.1.1.3.3.cmml"><msub id="S3.SS2.p4.4.m4.1.1.3.3.2" xref="S3.SS2.p4.4.m4.1.1.3.3.2.cmml"><mi id="S3.SS2.p4.4.m4.1.1.3.3.2.2" xref="S3.SS2.p4.4.m4.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS2.p4.4.m4.1.1.3.3.2.3" xref="S3.SS2.p4.4.m4.1.1.3.3.2.3.cmml">p</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p4.4.m4.1.1.3.3.1" xref="S3.SS2.p4.4.m4.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p4.4.m4.1.1.3.3.3" xref="S3.SS2.p4.4.m4.1.1.3.3.3.cmml"><mi id="S3.SS2.p4.4.m4.1.1.3.3.3.2" xref="S3.SS2.p4.4.m4.1.1.3.3.3.2.cmml">D</mi><mn id="S3.SS2.p4.4.m4.1.1.3.3.3.3" xref="S3.SS2.p4.4.m4.1.1.3.3.3.3.cmml">1</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><in id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1.1"></in><apply id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.2.1.cmml" xref="S3.SS2.p4.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2.2">ℳ</ci><apply id="S3.SS2.p4.4.m4.1.1.2.3.cmml" xref="S3.SS2.p4.4.m4.1.1.2.3"><times id="S3.SS2.p4.4.m4.1.1.2.3.1.cmml" xref="S3.SS2.p4.4.m4.1.1.2.3.1"></times><ci id="S3.SS2.p4.4.m4.1.1.2.3.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2.3.2">𝑚</ci><ci id="S3.SS2.p4.4.m4.1.1.2.3.3.cmml" xref="S3.SS2.p4.4.m4.1.1.2.3.3">𝑎</ci><ci id="S3.SS2.p4.4.m4.1.1.2.3.4.cmml" xref="S3.SS2.p4.4.m4.1.1.2.3.4">𝑝</ci></apply></apply><apply id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.3.1.cmml" xref="S3.SS2.p4.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.3.2.cmml" xref="S3.SS2.p4.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.p4.4.m4.1.1.3.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3"><times id="S3.SS2.p4.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3.1"></times><apply id="S3.SS2.p4.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS2.p4.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3.2.3">𝑝</ci></apply><apply id="S3.SS2.p4.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.3.3.3.1.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.3.3.3.2.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3.3.2">𝐷</ci><cn type="integer" id="S3.SS2.p4.4.m4.1.1.3.3.3.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">\mathcal{M}_{map}\in\mathbb{R}^{N_{p}\times D_{1}}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.11" class="ltx_p">We assume that local interactions are crucial and sufficient to reconstruct incomplete historical trajectories. Therefore, we use a single layer of local attention to ensure that each agent token attends to its K nearest neighbor tokens (including both agent and map tokens). Following this, a simple MLP layer is employed to recover the complete historical trajectories for all agents. Next, a PointNet-like layer aggregates these recovered trajectories into agent tokens. A residual connection is added between the input and output of the recovery module to ensure stable training (see Fig.<a href="#S2.F4" title="Figure 4 ‣ II-B Imperfect Data Recovery ‣ II Related Works ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.37" class="ltx_Math" alttext="\begin{split}\mathcal{A}_{agent}=\mathcal{A}_{agent}+\text{Recovery}(\mathcal{A}_{agent}),\\
\text{Recovery}(\mathcal{A}_{agent})=\text{MLP}(\mathcal{A}_{Past}),\\
\mathcal{A}_{Past}=\text{MLP}(\mathcal{A}_{agent}),\end{split}" display="block"><semantics id="S3.E6.m1.37a"><mtable displaystyle="true" rowspacing="0pt" id="S3.E6.m1.37.37.4"><mtr id="S3.E6.m1.37.37.4a"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.37.37.4b"><mrow id="S3.E6.m1.35.35.2.34.13.13.13"><mrow id="S3.E6.m1.35.35.2.34.13.13.13.1"><msub id="S3.E6.m1.35.35.2.34.13.13.13.1.2"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml">𝒜</mi><mrow id="S3.E6.m1.2.2.2.2.2.2.1" xref="S3.E6.m1.2.2.2.2.2.2.1.cmml"><mi id="S3.E6.m1.2.2.2.2.2.2.1.2" xref="S3.E6.m1.2.2.2.2.2.2.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.2.2.2.1.1" xref="S3.E6.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E6.m1.2.2.2.2.2.2.1.3" xref="S3.E6.m1.2.2.2.2.2.2.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.2.2.2.1.1a" xref="S3.E6.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E6.m1.2.2.2.2.2.2.1.4" xref="S3.E6.m1.2.2.2.2.2.2.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.2.2.2.1.1b" xref="S3.E6.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E6.m1.2.2.2.2.2.2.1.5" xref="S3.E6.m1.2.2.2.2.2.2.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.2.2.2.2.1.1c" xref="S3.E6.m1.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S3.E6.m1.2.2.2.2.2.2.1.6" xref="S3.E6.m1.2.2.2.2.2.2.1.6.cmml">t</mi></mrow></msub><mo id="S3.E6.m1.3.3.3.3.3.3" xref="S3.E6.m1.3.3.3.3.3.3.cmml">=</mo><mrow id="S3.E6.m1.35.35.2.34.13.13.13.1.1"><msub id="S3.E6.m1.35.35.2.34.13.13.13.1.1.2"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.4.4.4.4.4.4" xref="S3.E6.m1.4.4.4.4.4.4.cmml">𝒜</mi><mrow id="S3.E6.m1.5.5.5.5.5.5.1" xref="S3.E6.m1.5.5.5.5.5.5.1.cmml"><mi id="S3.E6.m1.5.5.5.5.5.5.1.2" xref="S3.E6.m1.5.5.5.5.5.5.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.5.5.5.5.1.1" xref="S3.E6.m1.5.5.5.5.5.5.1.1.cmml">​</mo><mi id="S3.E6.m1.5.5.5.5.5.5.1.3" xref="S3.E6.m1.5.5.5.5.5.5.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.5.5.5.5.1.1a" xref="S3.E6.m1.5.5.5.5.5.5.1.1.cmml">​</mo><mi id="S3.E6.m1.5.5.5.5.5.5.1.4" xref="S3.E6.m1.5.5.5.5.5.5.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.5.5.5.5.1.1b" xref="S3.E6.m1.5.5.5.5.5.5.1.1.cmml">​</mo><mi id="S3.E6.m1.5.5.5.5.5.5.1.5" xref="S3.E6.m1.5.5.5.5.5.5.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.5.5.5.5.5.5.1.1c" xref="S3.E6.m1.5.5.5.5.5.5.1.1.cmml">​</mo><mi id="S3.E6.m1.5.5.5.5.5.5.1.6" xref="S3.E6.m1.5.5.5.5.5.5.1.6.cmml">t</mi></mrow></msub><mo id="S3.E6.m1.6.6.6.6.6.6" xref="S3.E6.m1.6.6.6.6.6.6.cmml">+</mo><mrow id="S3.E6.m1.35.35.2.34.13.13.13.1.1.1"><mtext id="S3.E6.m1.7.7.7.7.7.7" xref="S3.E6.m1.7.7.7.7.7.7a.cmml">Recovery</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.35.35.2.34.13.13.13.1.1.1.2">​</mo><mrow id="S3.E6.m1.35.35.2.34.13.13.13.1.1.1.1.1"><mo stretchy="false" id="S3.E6.m1.8.8.8.8.8.8">(</mo><msub id="S3.E6.m1.35.35.2.34.13.13.13.1.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.9.9.9.9.9.9" xref="S3.E6.m1.9.9.9.9.9.9.cmml">𝒜</mi><mrow id="S3.E6.m1.10.10.10.10.10.10.1" xref="S3.E6.m1.10.10.10.10.10.10.1.cmml"><mi id="S3.E6.m1.10.10.10.10.10.10.1.2" xref="S3.E6.m1.10.10.10.10.10.10.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.10.10.10.10.10.10.1.1" xref="S3.E6.m1.10.10.10.10.10.10.1.1.cmml">​</mo><mi id="S3.E6.m1.10.10.10.10.10.10.1.3" xref="S3.E6.m1.10.10.10.10.10.10.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.10.10.10.10.10.10.1.1a" xref="S3.E6.m1.10.10.10.10.10.10.1.1.cmml">​</mo><mi id="S3.E6.m1.10.10.10.10.10.10.1.4" xref="S3.E6.m1.10.10.10.10.10.10.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.10.10.10.10.10.10.1.1b" xref="S3.E6.m1.10.10.10.10.10.10.1.1.cmml">​</mo><mi id="S3.E6.m1.10.10.10.10.10.10.1.5" xref="S3.E6.m1.10.10.10.10.10.10.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.10.10.10.10.10.10.1.1c" xref="S3.E6.m1.10.10.10.10.10.10.1.1.cmml">​</mo><mi id="S3.E6.m1.10.10.10.10.10.10.1.6" xref="S3.E6.m1.10.10.10.10.10.10.1.6.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.E6.m1.11.11.11.11.11.11">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E6.m1.12.12.12.12.12.12">,</mo></mrow></mtd></mtr><mtr id="S3.E6.m1.37.37.4c"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.37.37.4d"><mrow id="S3.E6.m1.36.36.3.35.13.13.13"><mrow id="S3.E6.m1.36.36.3.35.13.13.13.1"><mrow id="S3.E6.m1.36.36.3.35.13.13.13.1.1"><mtext id="S3.E6.m1.13.13.13.1.1.1" xref="S3.E6.m1.13.13.13.1.1.1a.cmml">Recovery</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.36.36.3.35.13.13.13.1.1.2">​</mo><mrow id="S3.E6.m1.36.36.3.35.13.13.13.1.1.1.1"><mo stretchy="false" id="S3.E6.m1.14.14.14.2.2.2">(</mo><msub id="S3.E6.m1.36.36.3.35.13.13.13.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.15.15.15.3.3.3" xref="S3.E6.m1.15.15.15.3.3.3.cmml">𝒜</mi><mrow id="S3.E6.m1.16.16.16.4.4.4.1" xref="S3.E6.m1.16.16.16.4.4.4.1.cmml"><mi id="S3.E6.m1.16.16.16.4.4.4.1.2" xref="S3.E6.m1.16.16.16.4.4.4.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.16.16.16.4.4.4.1.1" xref="S3.E6.m1.16.16.16.4.4.4.1.1.cmml">​</mo><mi id="S3.E6.m1.16.16.16.4.4.4.1.3" xref="S3.E6.m1.16.16.16.4.4.4.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.16.16.16.4.4.4.1.1a" xref="S3.E6.m1.16.16.16.4.4.4.1.1.cmml">​</mo><mi id="S3.E6.m1.16.16.16.4.4.4.1.4" xref="S3.E6.m1.16.16.16.4.4.4.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.16.16.16.4.4.4.1.1b" xref="S3.E6.m1.16.16.16.4.4.4.1.1.cmml">​</mo><mi id="S3.E6.m1.16.16.16.4.4.4.1.5" xref="S3.E6.m1.16.16.16.4.4.4.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.16.16.16.4.4.4.1.1c" xref="S3.E6.m1.16.16.16.4.4.4.1.1.cmml">​</mo><mi id="S3.E6.m1.16.16.16.4.4.4.1.6" xref="S3.E6.m1.16.16.16.4.4.4.1.6.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.E6.m1.17.17.17.5.5.5">)</mo></mrow></mrow><mo id="S3.E6.m1.18.18.18.6.6.6" xref="S3.E6.m1.18.18.18.6.6.6.cmml">=</mo><mrow id="S3.E6.m1.36.36.3.35.13.13.13.1.2"><mtext id="S3.E6.m1.19.19.19.7.7.7" xref="S3.E6.m1.19.19.19.7.7.7a.cmml">MLP</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.36.36.3.35.13.13.13.1.2.2">​</mo><mrow id="S3.E6.m1.36.36.3.35.13.13.13.1.2.1.1"><mo stretchy="false" id="S3.E6.m1.20.20.20.8.8.8">(</mo><msub id="S3.E6.m1.36.36.3.35.13.13.13.1.2.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.21.21.21.9.9.9" xref="S3.E6.m1.21.21.21.9.9.9.cmml">𝒜</mi><mrow id="S3.E6.m1.22.22.22.10.10.10.1" xref="S3.E6.m1.22.22.22.10.10.10.1.cmml"><mi id="S3.E6.m1.22.22.22.10.10.10.1.2" xref="S3.E6.m1.22.22.22.10.10.10.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.22.22.22.10.10.10.1.1" xref="S3.E6.m1.22.22.22.10.10.10.1.1.cmml">​</mo><mi id="S3.E6.m1.22.22.22.10.10.10.1.3" xref="S3.E6.m1.22.22.22.10.10.10.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.22.22.22.10.10.10.1.1a" xref="S3.E6.m1.22.22.22.10.10.10.1.1.cmml">​</mo><mi id="S3.E6.m1.22.22.22.10.10.10.1.4" xref="S3.E6.m1.22.22.22.10.10.10.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.22.22.22.10.10.10.1.1b" xref="S3.E6.m1.22.22.22.10.10.10.1.1.cmml">​</mo><mi id="S3.E6.m1.22.22.22.10.10.10.1.5" xref="S3.E6.m1.22.22.22.10.10.10.1.5.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.E6.m1.23.23.23.11.11.11">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.24.24.24.12.12.12">,</mo></mrow></mtd></mtr><mtr id="S3.E6.m1.37.37.4e"><mtd class="ltx_align_right" columnalign="right" id="S3.E6.m1.37.37.4f"><mrow id="S3.E6.m1.37.37.4.36.10.10.10"><mrow id="S3.E6.m1.37.37.4.36.10.10.10.1"><msub id="S3.E6.m1.37.37.4.36.10.10.10.1.2"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.25.25.25.1.1.1" xref="S3.E6.m1.25.25.25.1.1.1.cmml">𝒜</mi><mrow id="S3.E6.m1.26.26.26.2.2.2.1" xref="S3.E6.m1.26.26.26.2.2.2.1.cmml"><mi id="S3.E6.m1.26.26.26.2.2.2.1.2" xref="S3.E6.m1.26.26.26.2.2.2.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.26.26.26.2.2.2.1.1" xref="S3.E6.m1.26.26.26.2.2.2.1.1.cmml">​</mo><mi id="S3.E6.m1.26.26.26.2.2.2.1.3" xref="S3.E6.m1.26.26.26.2.2.2.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.26.26.26.2.2.2.1.1a" xref="S3.E6.m1.26.26.26.2.2.2.1.1.cmml">​</mo><mi id="S3.E6.m1.26.26.26.2.2.2.1.4" xref="S3.E6.m1.26.26.26.2.2.2.1.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.26.26.26.2.2.2.1.1b" xref="S3.E6.m1.26.26.26.2.2.2.1.1.cmml">​</mo><mi id="S3.E6.m1.26.26.26.2.2.2.1.5" xref="S3.E6.m1.26.26.26.2.2.2.1.5.cmml">t</mi></mrow></msub><mo id="S3.E6.m1.27.27.27.3.3.3" xref="S3.E6.m1.27.27.27.3.3.3.cmml">=</mo><mrow id="S3.E6.m1.37.37.4.36.10.10.10.1.1"><mtext id="S3.E6.m1.28.28.28.4.4.4" xref="S3.E6.m1.28.28.28.4.4.4a.cmml">MLP</mtext><mo lspace="0em" rspace="0em" id="S3.E6.m1.37.37.4.36.10.10.10.1.1.2">​</mo><mrow id="S3.E6.m1.37.37.4.36.10.10.10.1.1.1.1"><mo stretchy="false" id="S3.E6.m1.29.29.29.5.5.5">(</mo><msub id="S3.E6.m1.37.37.4.36.10.10.10.1.1.1.1.1"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.30.30.30.6.6.6" xref="S3.E6.m1.30.30.30.6.6.6.cmml">𝒜</mi><mrow id="S3.E6.m1.31.31.31.7.7.7.1" xref="S3.E6.m1.31.31.31.7.7.7.1.cmml"><mi id="S3.E6.m1.31.31.31.7.7.7.1.2" xref="S3.E6.m1.31.31.31.7.7.7.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.31.31.31.7.7.7.1.1" xref="S3.E6.m1.31.31.31.7.7.7.1.1.cmml">​</mo><mi id="S3.E6.m1.31.31.31.7.7.7.1.3" xref="S3.E6.m1.31.31.31.7.7.7.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.31.31.31.7.7.7.1.1a" xref="S3.E6.m1.31.31.31.7.7.7.1.1.cmml">​</mo><mi id="S3.E6.m1.31.31.31.7.7.7.1.4" xref="S3.E6.m1.31.31.31.7.7.7.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.31.31.31.7.7.7.1.1b" xref="S3.E6.m1.31.31.31.7.7.7.1.1.cmml">​</mo><mi id="S3.E6.m1.31.31.31.7.7.7.1.5" xref="S3.E6.m1.31.31.31.7.7.7.1.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.31.31.31.7.7.7.1.1c" xref="S3.E6.m1.31.31.31.7.7.7.1.1.cmml">​</mo><mi id="S3.E6.m1.31.31.31.7.7.7.1.6" xref="S3.E6.m1.31.31.31.7.7.7.1.6.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.E6.m1.32.32.32.8.8.8">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.33.33.33.9.9.9">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E6.m1.37b"><apply id="S3.E6.m1.34.34.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S3.E6.m1.34.34.1.1.1.3a.cmml">formulae-sequence</csymbol><apply id="S3.E6.m1.34.34.1.1.1.1.1.cmml"><eq id="S3.E6.m1.3.3.3.3.3.3.cmml" xref="S3.E6.m1.3.3.3.3.3.3"></eq><apply id="S3.E6.m1.34.34.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S3.E6.m1.34.34.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">𝒜</ci><apply id="S3.E6.m1.2.2.2.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2.1"><times id="S3.E6.m1.2.2.2.2.2.2.1.1.cmml" xref="S3.E6.m1.2.2.2.2.2.2.1.1"></times><ci id="S3.E6.m1.2.2.2.2.2.2.1.2.cmml" xref="S3.E6.m1.2.2.2.2.2.2.1.2">𝑎</ci><ci id="S3.E6.m1.2.2.2.2.2.2.1.3.cmml" xref="S3.E6.m1.2.2.2.2.2.2.1.3">𝑔</ci><ci id="S3.E6.m1.2.2.2.2.2.2.1.4.cmml" xref="S3.E6.m1.2.2.2.2.2.2.1.4">𝑒</ci><ci id="S3.E6.m1.2.2.2.2.2.2.1.5.cmml" xref="S3.E6.m1.2.2.2.2.2.2.1.5">𝑛</ci><ci id="S3.E6.m1.2.2.2.2.2.2.1.6.cmml" xref="S3.E6.m1.2.2.2.2.2.2.1.6">𝑡</ci></apply></apply><apply id="S3.E6.m1.34.34.1.1.1.1.1.1.cmml"><plus id="S3.E6.m1.6.6.6.6.6.6.cmml" xref="S3.E6.m1.6.6.6.6.6.6"></plus><apply id="S3.E6.m1.34.34.1.1.1.1.1.1.3.cmml"><csymbol cd="ambiguous" id="S3.E6.m1.34.34.1.1.1.1.1.1.3.1.cmml">subscript</csymbol><ci id="S3.E6.m1.4.4.4.4.4.4.cmml" xref="S3.E6.m1.4.4.4.4.4.4">𝒜</ci><apply id="S3.E6.m1.5.5.5.5.5.5.1.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1"><times id="S3.E6.m1.5.5.5.5.5.5.1.1.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.1"></times><ci id="S3.E6.m1.5.5.5.5.5.5.1.2.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.2">𝑎</ci><ci id="S3.E6.m1.5.5.5.5.5.5.1.3.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.3">𝑔</ci><ci id="S3.E6.m1.5.5.5.5.5.5.1.4.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.4">𝑒</ci><ci id="S3.E6.m1.5.5.5.5.5.5.1.5.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.5">𝑛</ci><ci id="S3.E6.m1.5.5.5.5.5.5.1.6.cmml" xref="S3.E6.m1.5.5.5.5.5.5.1.6">𝑡</ci></apply></apply><apply id="S3.E6.m1.34.34.1.1.1.1.1.1.1.cmml"><times id="S3.E6.m1.34.34.1.1.1.1.1.1.1.2.cmml"></times><ci id="S3.E6.m1.7.7.7.7.7.7a.cmml" xref="S3.E6.m1.7.7.7.7.7.7"><mtext id="S3.E6.m1.7.7.7.7.7.7.cmml" xref="S3.E6.m1.7.7.7.7.7.7">Recovery</mtext></ci><apply id="S3.E6.m1.34.34.1.1.1.1.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E6.m1.34.34.1.1.1.1.1.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E6.m1.9.9.9.9.9.9.cmml" xref="S3.E6.m1.9.9.9.9.9.9">𝒜</ci><apply id="S3.E6.m1.10.10.10.10.10.10.1.cmml" xref="S3.E6.m1.10.10.10.10.10.10.1"><times id="S3.E6.m1.10.10.10.10.10.10.1.1.cmml" xref="S3.E6.m1.10.10.10.10.10.10.1.1"></times><ci id="S3.E6.m1.10.10.10.10.10.10.1.2.cmml" xref="S3.E6.m1.10.10.10.10.10.10.1.2">𝑎</ci><ci id="S3.E6.m1.10.10.10.10.10.10.1.3.cmml" xref="S3.E6.m1.10.10.10.10.10.10.1.3">𝑔</ci><ci id="S3.E6.m1.10.10.10.10.10.10.1.4.cmml" xref="S3.E6.m1.10.10.10.10.10.10.1.4">𝑒</ci><ci id="S3.E6.m1.10.10.10.10.10.10.1.5.cmml" xref="S3.E6.m1.10.10.10.10.10.10.1.5">𝑛</ci><ci id="S3.E6.m1.10.10.10.10.10.10.1.6.cmml" xref="S3.E6.m1.10.10.10.10.10.10.1.6">𝑡</ci></apply></apply></apply></apply></apply><apply id="S3.E6.m1.34.34.1.1.1.2.2.3.cmml"><csymbol cd="ambiguous" id="S3.E6.m1.34.34.1.1.1.2.2.3a.cmml">formulae-sequence</csymbol><apply id="S3.E6.m1.34.34.1.1.1.2.2.1.1.cmml"><eq id="S3.E6.m1.18.18.18.6.6.6.cmml" xref="S3.E6.m1.18.18.18.6.6.6"></eq><apply id="S3.E6.m1.34.34.1.1.1.2.2.1.1.1.cmml"><times id="S3.E6.m1.34.34.1.1.1.2.2.1.1.1.2.cmml"></times><ci id="S3.E6.m1.13.13.13.1.1.1a.cmml" xref="S3.E6.m1.13.13.13.1.1.1"><mtext id="S3.E6.m1.13.13.13.1.1.1.cmml" xref="S3.E6.m1.13.13.13.1.1.1">Recovery</mtext></ci><apply id="S3.E6.m1.34.34.1.1.1.2.2.1.1.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E6.m1.34.34.1.1.1.2.2.1.1.1.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E6.m1.15.15.15.3.3.3.cmml" xref="S3.E6.m1.15.15.15.3.3.3">𝒜</ci><apply id="S3.E6.m1.16.16.16.4.4.4.1.cmml" xref="S3.E6.m1.16.16.16.4.4.4.1"><times id="S3.E6.m1.16.16.16.4.4.4.1.1.cmml" xref="S3.E6.m1.16.16.16.4.4.4.1.1"></times><ci id="S3.E6.m1.16.16.16.4.4.4.1.2.cmml" xref="S3.E6.m1.16.16.16.4.4.4.1.2">𝑎</ci><ci id="S3.E6.m1.16.16.16.4.4.4.1.3.cmml" xref="S3.E6.m1.16.16.16.4.4.4.1.3">𝑔</ci><ci id="S3.E6.m1.16.16.16.4.4.4.1.4.cmml" xref="S3.E6.m1.16.16.16.4.4.4.1.4">𝑒</ci><ci id="S3.E6.m1.16.16.16.4.4.4.1.5.cmml" xref="S3.E6.m1.16.16.16.4.4.4.1.5">𝑛</ci><ci id="S3.E6.m1.16.16.16.4.4.4.1.6.cmml" xref="S3.E6.m1.16.16.16.4.4.4.1.6">𝑡</ci></apply></apply></apply><apply id="S3.E6.m1.34.34.1.1.1.2.2.1.1.2.cmml"><times id="S3.E6.m1.34.34.1.1.1.2.2.1.1.2.2.cmml"></times><ci id="S3.E6.m1.19.19.19.7.7.7a.cmml" xref="S3.E6.m1.19.19.19.7.7.7"><mtext id="S3.E6.m1.19.19.19.7.7.7.cmml" xref="S3.E6.m1.19.19.19.7.7.7">MLP</mtext></ci><apply id="S3.E6.m1.34.34.1.1.1.2.2.1.1.2.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E6.m1.34.34.1.1.1.2.2.1.1.2.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E6.m1.21.21.21.9.9.9.cmml" xref="S3.E6.m1.21.21.21.9.9.9">𝒜</ci><apply id="S3.E6.m1.22.22.22.10.10.10.1.cmml" xref="S3.E6.m1.22.22.22.10.10.10.1"><times id="S3.E6.m1.22.22.22.10.10.10.1.1.cmml" xref="S3.E6.m1.22.22.22.10.10.10.1.1"></times><ci id="S3.E6.m1.22.22.22.10.10.10.1.2.cmml" xref="S3.E6.m1.22.22.22.10.10.10.1.2">𝑃</ci><ci id="S3.E6.m1.22.22.22.10.10.10.1.3.cmml" xref="S3.E6.m1.22.22.22.10.10.10.1.3">𝑎</ci><ci id="S3.E6.m1.22.22.22.10.10.10.1.4.cmml" xref="S3.E6.m1.22.22.22.10.10.10.1.4">𝑠</ci><ci id="S3.E6.m1.22.22.22.10.10.10.1.5.cmml" xref="S3.E6.m1.22.22.22.10.10.10.1.5">𝑡</ci></apply></apply></apply></apply><apply id="S3.E6.m1.34.34.1.1.1.2.2.2.2.cmml"><eq id="S3.E6.m1.27.27.27.3.3.3.cmml" xref="S3.E6.m1.27.27.27.3.3.3"></eq><apply id="S3.E6.m1.34.34.1.1.1.2.2.2.2.3.cmml"><csymbol cd="ambiguous" id="S3.E6.m1.34.34.1.1.1.2.2.2.2.3.1.cmml">subscript</csymbol><ci id="S3.E6.m1.25.25.25.1.1.1.cmml" xref="S3.E6.m1.25.25.25.1.1.1">𝒜</ci><apply id="S3.E6.m1.26.26.26.2.2.2.1.cmml" xref="S3.E6.m1.26.26.26.2.2.2.1"><times id="S3.E6.m1.26.26.26.2.2.2.1.1.cmml" xref="S3.E6.m1.26.26.26.2.2.2.1.1"></times><ci id="S3.E6.m1.26.26.26.2.2.2.1.2.cmml" xref="S3.E6.m1.26.26.26.2.2.2.1.2">𝑃</ci><ci id="S3.E6.m1.26.26.26.2.2.2.1.3.cmml" xref="S3.E6.m1.26.26.26.2.2.2.1.3">𝑎</ci><ci id="S3.E6.m1.26.26.26.2.2.2.1.4.cmml" xref="S3.E6.m1.26.26.26.2.2.2.1.4">𝑠</ci><ci id="S3.E6.m1.26.26.26.2.2.2.1.5.cmml" xref="S3.E6.m1.26.26.26.2.2.2.1.5">𝑡</ci></apply></apply><apply id="S3.E6.m1.34.34.1.1.1.2.2.2.2.1.cmml"><times id="S3.E6.m1.34.34.1.1.1.2.2.2.2.1.2.cmml"></times><ci id="S3.E6.m1.28.28.28.4.4.4a.cmml" xref="S3.E6.m1.28.28.28.4.4.4"><mtext id="S3.E6.m1.28.28.28.4.4.4.cmml" xref="S3.E6.m1.28.28.28.4.4.4">MLP</mtext></ci><apply id="S3.E6.m1.34.34.1.1.1.2.2.2.2.1.1.1.1.cmml"><csymbol cd="ambiguous" id="S3.E6.m1.34.34.1.1.1.2.2.2.2.1.1.1.1.1.cmml">subscript</csymbol><ci id="S3.E6.m1.30.30.30.6.6.6.cmml" xref="S3.E6.m1.30.30.30.6.6.6">𝒜</ci><apply id="S3.E6.m1.31.31.31.7.7.7.1.cmml" xref="S3.E6.m1.31.31.31.7.7.7.1"><times id="S3.E6.m1.31.31.31.7.7.7.1.1.cmml" xref="S3.E6.m1.31.31.31.7.7.7.1.1"></times><ci id="S3.E6.m1.31.31.31.7.7.7.1.2.cmml" xref="S3.E6.m1.31.31.31.7.7.7.1.2">𝑎</ci><ci id="S3.E6.m1.31.31.31.7.7.7.1.3.cmml" xref="S3.E6.m1.31.31.31.7.7.7.1.3">𝑔</ci><ci id="S3.E6.m1.31.31.31.7.7.7.1.4.cmml" xref="S3.E6.m1.31.31.31.7.7.7.1.4">𝑒</ci><ci id="S3.E6.m1.31.31.31.7.7.7.1.5.cmml" xref="S3.E6.m1.31.31.31.7.7.7.1.5">𝑛</ci><ci id="S3.E6.m1.31.31.31.7.7.7.1.6.cmml" xref="S3.E6.m1.31.31.31.7.7.7.1.6">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.37c">\begin{split}\mathcal{A}_{agent}=\mathcal{A}_{agent}+\text{Recovery}(\mathcal{A}_{agent}),\\
\text{Recovery}(\mathcal{A}_{agent})=\text{MLP}(\mathcal{A}_{Past}),\\
\mathcal{A}_{Past}=\text{MLP}(\mathcal{A}_{agent}),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p5.3" class="ltx_p">Where <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="\mathcal{A}_{Past}\in\mathbb{R}^{N_{a}\times({T_{p}\times 4})}" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mrow id="S3.SS2.p5.1.m1.1.2" xref="S3.SS2.p5.1.m1.1.2.cmml"><msub id="S3.SS2.p5.1.m1.1.2.2" xref="S3.SS2.p5.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.1.m1.1.2.2.2" xref="S3.SS2.p5.1.m1.1.2.2.2.cmml">𝒜</mi><mrow id="S3.SS2.p5.1.m1.1.2.2.3" xref="S3.SS2.p5.1.m1.1.2.2.3.cmml"><mi id="S3.SS2.p5.1.m1.1.2.2.3.2" xref="S3.SS2.p5.1.m1.1.2.2.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.1.2.2.3.1" xref="S3.SS2.p5.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.1.m1.1.2.2.3.3" xref="S3.SS2.p5.1.m1.1.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.1.2.2.3.1a" xref="S3.SS2.p5.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.1.m1.1.2.2.3.4" xref="S3.SS2.p5.1.m1.1.2.2.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.1.2.2.3.1b" xref="S3.SS2.p5.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.1.m1.1.2.2.3.5" xref="S3.SS2.p5.1.m1.1.2.2.3.5.cmml">t</mi></mrow></msub><mo id="S3.SS2.p5.1.m1.1.2.1" xref="S3.SS2.p5.1.m1.1.2.1.cmml">∈</mo><msup id="S3.SS2.p5.1.m1.1.2.3" xref="S3.SS2.p5.1.m1.1.2.3.cmml"><mi id="S3.SS2.p5.1.m1.1.2.3.2" xref="S3.SS2.p5.1.m1.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.1.m1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.cmml"><msub id="S3.SS2.p5.1.m1.1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.1.3.cmml"><mi id="S3.SS2.p5.1.m1.1.1.1.3.2" xref="S3.SS2.p5.1.m1.1.1.1.3.2.cmml">N</mi><mi id="S3.SS2.p5.1.m1.1.1.1.3.3" xref="S3.SS2.p5.1.m1.1.1.1.3.3.cmml">a</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p5.1.m1.1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.1.2.cmml">×</mo><mrow id="S3.SS2.p5.1.m1.1.1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p5.1.m1.1.1.1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p5.1.m1.1.1.1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p5.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.2.cmml">T</mi><mi id="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.3" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.3.cmml">p</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p5.1.m1.1.1.1.1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.1.cmml">×</mo><mn id="S3.SS2.p5.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.3.cmml">4</mn></mrow><mo stretchy="false" id="S3.SS2.p5.1.m1.1.1.1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.2"><in id="S3.SS2.p5.1.m1.1.2.1.cmml" xref="S3.SS2.p5.1.m1.1.2.1"></in><apply id="S3.SS2.p5.1.m1.1.2.2.cmml" xref="S3.SS2.p5.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.2.2.1.cmml" xref="S3.SS2.p5.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.2.2.2.cmml" xref="S3.SS2.p5.1.m1.1.2.2.2">𝒜</ci><apply id="S3.SS2.p5.1.m1.1.2.2.3.cmml" xref="S3.SS2.p5.1.m1.1.2.2.3"><times id="S3.SS2.p5.1.m1.1.2.2.3.1.cmml" xref="S3.SS2.p5.1.m1.1.2.2.3.1"></times><ci id="S3.SS2.p5.1.m1.1.2.2.3.2.cmml" xref="S3.SS2.p5.1.m1.1.2.2.3.2">𝑃</ci><ci id="S3.SS2.p5.1.m1.1.2.2.3.3.cmml" xref="S3.SS2.p5.1.m1.1.2.2.3.3">𝑎</ci><ci id="S3.SS2.p5.1.m1.1.2.2.3.4.cmml" xref="S3.SS2.p5.1.m1.1.2.2.3.4">𝑠</ci><ci id="S3.SS2.p5.1.m1.1.2.2.3.5.cmml" xref="S3.SS2.p5.1.m1.1.2.2.3.5">𝑡</ci></apply></apply><apply id="S3.SS2.p5.1.m1.1.2.3.cmml" xref="S3.SS2.p5.1.m1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.2.3.1.cmml" xref="S3.SS2.p5.1.m1.1.2.3">superscript</csymbol><ci id="S3.SS2.p5.1.m1.1.2.3.2.cmml" xref="S3.SS2.p5.1.m1.1.2.3.2">ℝ</ci><apply id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1"><times id="S3.SS2.p5.1.m1.1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.1.2"></times><apply id="S3.SS2.p5.1.m1.1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.3.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.1.3.2.cmml" xref="S3.SS2.p5.1.m1.1.1.1.3.2">𝑁</ci><ci id="S3.SS2.p5.1.m1.1.1.1.3.3.cmml" xref="S3.SS2.p5.1.m1.1.1.1.3.3">𝑎</ci></apply><apply id="S3.SS2.p5.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1"><times id="S3.SS2.p5.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.1"></times><apply id="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.2">𝑇</ci><ci id="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.2.3">𝑝</ci></apply><cn type="integer" id="S3.SS2.p5.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1.1.3">4</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\mathcal{A}_{Past}\in\mathbb{R}^{N_{a}\times({T_{p}\times 4})}</annotation></semantics></math> and <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="4" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mn id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">4</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><cn type="integer" id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">4</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">4</annotation></semantics></math> denotes the position and velocity for the recovered historical trajectories.
This recovery module aims to reconstruct the incomplete historical trajectories for each agent and integrate this enriched historical information into the agent tokens. After the recovery module, both agent tokens and map tokens will go through another four layers of local attention for further feature fusion.
The <math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="i_{th}" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><msub id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">i</mi><mrow id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml"><mi id="S3.SS2.p5.3.m3.1.1.3.2" xref="S3.SS2.p5.3.m3.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.3.m3.1.1.3.1" xref="S3.SS2.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.3.m3.1.1.3.3" xref="S3.SS2.p5.3.m3.1.1.3.3.cmml">h</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝑖</ci><apply id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3"><times id="S3.SS2.p5.3.m3.1.1.3.1.cmml" xref="S3.SS2.p5.3.m3.1.1.3.1"></times><ci id="S3.SS2.p5.3.m3.1.1.3.2.cmml" xref="S3.SS2.p5.3.m3.1.1.3.2">𝑡</ci><ci id="S3.SS2.p5.3.m3.1.1.3.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">i_{th}</annotation></semantics></math> transformer encoder layer can be formulated as:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.38" class="ltx_Math" alttext="\begin{split}Q^{i}=\text{MHA}(&amp;Q^{i-1}+\text{PE}({Q^{i-1}}),\\
&amp;\mathcal{K}(Q^{i-1})+\text{PE}({\mathcal{K}(Q^{i-1}))},\mathcal{K}(Q^{i-1})),\end{split}" display="block"><semantics id="S3.E7.m1.38a"><mtable columnspacing="0pt" displaystyle="true" rowspacing="0pt" id="S3.E7.m1.38.38.2"><mtr id="S3.E7.m1.38.38.2a"><mtd class="ltx_align_right" columnalign="right" id="S3.E7.m1.38.38.2b"><mrow id="S3.E7.m1.5.5.5.5.5"><msup id="S3.E7.m1.5.5.5.5.5.6"><mi id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml">Q</mi><mi id="S3.E7.m1.2.2.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.2.1.cmml">i</mi></msup><mo id="S3.E7.m1.3.3.3.3.3.3" xref="S3.E7.m1.3.3.3.3.3.3.cmml">=</mo><mtext id="S3.E7.m1.4.4.4.4.4.4" xref="S3.E7.m1.4.4.4.4.4.4a.cmml">MHA</mtext><mo stretchy="false" id="S3.E7.m1.5.5.5.5.5.5" xref="S3.E7.m1.37.37.1.1.1.cmml">(</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.38.38.2c"><mrow id="S3.E7.m1.38.38.2.37.15.10.10"><mrow id="S3.E7.m1.38.38.2.37.15.10.10.1"><msup id="S3.E7.m1.38.38.2.37.15.10.10.1.2"><mi id="S3.E7.m1.6.6.6.6.1.1" xref="S3.E7.m1.6.6.6.6.1.1.cmml">Q</mi><mrow id="S3.E7.m1.7.7.7.7.2.2.1" xref="S3.E7.m1.7.7.7.7.2.2.1.cmml"><mi id="S3.E7.m1.7.7.7.7.2.2.1.2" xref="S3.E7.m1.7.7.7.7.2.2.1.2.cmml">i</mi><mo id="S3.E7.m1.7.7.7.7.2.2.1.1" xref="S3.E7.m1.7.7.7.7.2.2.1.1.cmml">−</mo><mn id="S3.E7.m1.7.7.7.7.2.2.1.3" xref="S3.E7.m1.7.7.7.7.2.2.1.3.cmml">1</mn></mrow></msup><mo id="S3.E7.m1.8.8.8.8.3.3" xref="S3.E7.m1.8.8.8.8.3.3.cmml">+</mo><mrow id="S3.E7.m1.38.38.2.37.15.10.10.1.1"><mtext id="S3.E7.m1.9.9.9.9.4.4" xref="S3.E7.m1.9.9.9.9.4.4a.cmml">PE</mtext><mo lspace="0em" rspace="0em" id="S3.E7.m1.38.38.2.37.15.10.10.1.1.2" xref="S3.E7.m1.37.37.1.1.1.cmml">​</mo><mrow id="S3.E7.m1.38.38.2.37.15.10.10.1.1.1.1"><mo stretchy="false" id="S3.E7.m1.10.10.10.10.5.5" xref="S3.E7.m1.37.37.1.1.1.cmml">(</mo><msup id="S3.E7.m1.38.38.2.37.15.10.10.1.1.1.1.1"><mi id="S3.E7.m1.11.11.11.11.6.6" xref="S3.E7.m1.11.11.11.11.6.6.cmml">Q</mi><mrow id="S3.E7.m1.12.12.12.12.7.7.1" xref="S3.E7.m1.12.12.12.12.7.7.1.cmml"><mi id="S3.E7.m1.12.12.12.12.7.7.1.2" xref="S3.E7.m1.12.12.12.12.7.7.1.2.cmml">i</mi><mo id="S3.E7.m1.12.12.12.12.7.7.1.1" xref="S3.E7.m1.12.12.12.12.7.7.1.1.cmml">−</mo><mn id="S3.E7.m1.12.12.12.12.7.7.1.3" xref="S3.E7.m1.12.12.12.12.7.7.1.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.E7.m1.13.13.13.13.8.8" xref="S3.E7.m1.37.37.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.14.14.14.14.9.9" xref="S3.E7.m1.37.37.1.1.1.cmml">,</mo></mrow></mtd></mtr><mtr id="S3.E7.m1.38.38.2d"><mtd id="S3.E7.m1.38.38.2e" xref="S3.E7.m1.37.37.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E7.m1.38.38.2f"><mrow id="S3.E7.m1.36.36.36.22.22"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.15.15.15.1.1.1" xref="S3.E7.m1.15.15.15.1.1.1.cmml">𝒦</mi><mrow id="S3.E7.m1.36.36.36.22.22.23"><mo stretchy="false" id="S3.E7.m1.16.16.16.2.2.2" xref="S3.E7.m1.37.37.1.1.1.cmml">(</mo><msup id="S3.E7.m1.36.36.36.22.22.23.1"><mi id="S3.E7.m1.17.17.17.3.3.3" xref="S3.E7.m1.17.17.17.3.3.3.cmml">Q</mi><mrow id="S3.E7.m1.18.18.18.4.4.4.1" xref="S3.E7.m1.18.18.18.4.4.4.1.cmml"><mi id="S3.E7.m1.18.18.18.4.4.4.1.2" xref="S3.E7.m1.18.18.18.4.4.4.1.2.cmml">i</mi><mo id="S3.E7.m1.18.18.18.4.4.4.1.1" xref="S3.E7.m1.18.18.18.4.4.4.1.1.cmml">−</mo><mn id="S3.E7.m1.18.18.18.4.4.4.1.3" xref="S3.E7.m1.18.18.18.4.4.4.1.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.E7.m1.19.19.19.5.5.5" xref="S3.E7.m1.37.37.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.20.20.20.6.6.6" xref="S3.E7.m1.20.20.20.6.6.6.cmml">+</mo><mtext id="S3.E7.m1.21.21.21.7.7.7" xref="S3.E7.m1.21.21.21.7.7.7a.cmml">PE</mtext><mrow id="S3.E7.m1.36.36.36.22.22.24"><mo stretchy="false" id="S3.E7.m1.22.22.22.8.8.8" xref="S3.E7.m1.37.37.1.1.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.23.23.23.9.9.9" xref="S3.E7.m1.23.23.23.9.9.9.cmml">𝒦</mi><mrow id="S3.E7.m1.36.36.36.22.22.24.1"><mo stretchy="false" id="S3.E7.m1.24.24.24.10.10.10" xref="S3.E7.m1.37.37.1.1.1.cmml">(</mo><msup id="S3.E7.m1.36.36.36.22.22.24.1.1"><mi id="S3.E7.m1.25.25.25.11.11.11" xref="S3.E7.m1.25.25.25.11.11.11.cmml">Q</mi><mrow id="S3.E7.m1.26.26.26.12.12.12.1" xref="S3.E7.m1.26.26.26.12.12.12.1.cmml"><mi id="S3.E7.m1.26.26.26.12.12.12.1.2" xref="S3.E7.m1.26.26.26.12.12.12.1.2.cmml">i</mi><mo id="S3.E7.m1.26.26.26.12.12.12.1.1" xref="S3.E7.m1.26.26.26.12.12.12.1.1.cmml">−</mo><mn id="S3.E7.m1.26.26.26.12.12.12.1.3" xref="S3.E7.m1.26.26.26.12.12.12.1.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.E7.m1.27.27.27.13.13.13" xref="S3.E7.m1.37.37.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.E7.m1.28.28.28.14.14.14" xref="S3.E7.m1.37.37.1.1.1.cmml">)</mo></mrow><mo id="S3.E7.m1.29.29.29.15.15.15" xref="S3.E7.m1.37.37.1.1.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.30.30.30.16.16.16" xref="S3.E7.m1.30.30.30.16.16.16.cmml">𝒦</mi><mrow id="S3.E7.m1.36.36.36.22.22.25"><mo stretchy="false" id="S3.E7.m1.31.31.31.17.17.17" xref="S3.E7.m1.37.37.1.1.1.cmml">(</mo><msup id="S3.E7.m1.36.36.36.22.22.25.1"><mi id="S3.E7.m1.32.32.32.18.18.18" xref="S3.E7.m1.32.32.32.18.18.18.cmml">Q</mi><mrow id="S3.E7.m1.33.33.33.19.19.19.1" xref="S3.E7.m1.33.33.33.19.19.19.1.cmml"><mi id="S3.E7.m1.33.33.33.19.19.19.1.2" xref="S3.E7.m1.33.33.33.19.19.19.1.2.cmml">i</mi><mo id="S3.E7.m1.33.33.33.19.19.19.1.1" xref="S3.E7.m1.33.33.33.19.19.19.1.1.cmml">−</mo><mn id="S3.E7.m1.33.33.33.19.19.19.1.3" xref="S3.E7.m1.33.33.33.19.19.19.1.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.E7.m1.34.34.34.20.20.20" xref="S3.E7.m1.37.37.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.E7.m1.35.35.35.21.21.21" xref="S3.E7.m1.37.37.1.1.1.cmml">)</mo><mo id="S3.E7.m1.36.36.36.22.22.22" xref="S3.E7.m1.37.37.1.1.1.cmml">,</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E7.m1.38b"><apply id="S3.E7.m1.37.37.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><eq id="S3.E7.m1.3.3.3.3.3.3.cmml" xref="S3.E7.m1.3.3.3.3.3.3"></eq><apply id="S3.E7.m1.37.37.1.1.1.5.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.E7.m1.37.37.1.1.1.5.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">𝑄</ci><ci id="S3.E7.m1.2.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.2.2.1">𝑖</ci></apply><apply id="S3.E7.m1.37.37.1.1.1.3.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><times id="S3.E7.m1.37.37.1.1.1.3.4.cmml" xref="S3.E7.m1.5.5.5.5.5.5"></times><ci id="S3.E7.m1.4.4.4.4.4.4a.cmml" xref="S3.E7.m1.4.4.4.4.4.4"><mtext id="S3.E7.m1.4.4.4.4.4.4.cmml" xref="S3.E7.m1.4.4.4.4.4.4">MHA</mtext></ci><vector id="S3.E7.m1.37.37.1.1.1.3.3.4.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><apply id="S3.E7.m1.37.37.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><plus id="S3.E7.m1.8.8.8.8.3.3.cmml" xref="S3.E7.m1.8.8.8.8.3.3"></plus><apply id="S3.E7.m1.37.37.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.E7.m1.37.37.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5">superscript</csymbol><ci id="S3.E7.m1.6.6.6.6.1.1.cmml" xref="S3.E7.m1.6.6.6.6.1.1">𝑄</ci><apply id="S3.E7.m1.7.7.7.7.2.2.1.cmml" xref="S3.E7.m1.7.7.7.7.2.2.1"><minus id="S3.E7.m1.7.7.7.7.2.2.1.1.cmml" xref="S3.E7.m1.7.7.7.7.2.2.1.1"></minus><ci id="S3.E7.m1.7.7.7.7.2.2.1.2.cmml" xref="S3.E7.m1.7.7.7.7.2.2.1.2">𝑖</ci><cn type="integer" id="S3.E7.m1.7.7.7.7.2.2.1.3.cmml" xref="S3.E7.m1.7.7.7.7.2.2.1.3">1</cn></apply></apply><apply id="S3.E7.m1.37.37.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><times id="S3.E7.m1.37.37.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5"></times><ci id="S3.E7.m1.9.9.9.9.4.4a.cmml" xref="S3.E7.m1.9.9.9.9.4.4"><mtext id="S3.E7.m1.9.9.9.9.4.4.cmml" xref="S3.E7.m1.9.9.9.9.4.4">PE</mtext></ci><apply id="S3.E7.m1.37.37.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.E7.m1.37.37.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5">superscript</csymbol><ci id="S3.E7.m1.11.11.11.11.6.6.cmml" xref="S3.E7.m1.11.11.11.11.6.6">𝑄</ci><apply id="S3.E7.m1.12.12.12.12.7.7.1.cmml" xref="S3.E7.m1.12.12.12.12.7.7.1"><minus id="S3.E7.m1.12.12.12.12.7.7.1.1.cmml" xref="S3.E7.m1.12.12.12.12.7.7.1.1"></minus><ci id="S3.E7.m1.12.12.12.12.7.7.1.2.cmml" xref="S3.E7.m1.12.12.12.12.7.7.1.2">𝑖</ci><cn type="integer" id="S3.E7.m1.12.12.12.12.7.7.1.3.cmml" xref="S3.E7.m1.12.12.12.12.7.7.1.3">1</cn></apply></apply></apply></apply><apply id="S3.E7.m1.37.37.1.1.1.2.2.2.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><plus id="S3.E7.m1.20.20.20.6.6.6.cmml" xref="S3.E7.m1.20.20.20.6.6.6"></plus><apply id="S3.E7.m1.37.37.1.1.1.2.2.2.2.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><times id="S3.E7.m1.37.37.1.1.1.2.2.2.2.1.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5"></times><ci id="S3.E7.m1.15.15.15.1.1.1.cmml" xref="S3.E7.m1.15.15.15.1.1.1">𝒦</ci><apply id="S3.E7.m1.37.37.1.1.1.2.2.2.2.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.E7.m1.37.37.1.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5">superscript</csymbol><ci id="S3.E7.m1.17.17.17.3.3.3.cmml" xref="S3.E7.m1.17.17.17.3.3.3">𝑄</ci><apply id="S3.E7.m1.18.18.18.4.4.4.1.cmml" xref="S3.E7.m1.18.18.18.4.4.4.1"><minus id="S3.E7.m1.18.18.18.4.4.4.1.1.cmml" xref="S3.E7.m1.18.18.18.4.4.4.1.1"></minus><ci id="S3.E7.m1.18.18.18.4.4.4.1.2.cmml" xref="S3.E7.m1.18.18.18.4.4.4.1.2">𝑖</ci><cn type="integer" id="S3.E7.m1.18.18.18.4.4.4.1.3.cmml" xref="S3.E7.m1.18.18.18.4.4.4.1.3">1</cn></apply></apply></apply><apply id="S3.E7.m1.37.37.1.1.1.2.2.2.2.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><times id="S3.E7.m1.37.37.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5"></times><ci id="S3.E7.m1.21.21.21.7.7.7a.cmml" xref="S3.E7.m1.21.21.21.7.7.7"><mtext id="S3.E7.m1.21.21.21.7.7.7.cmml" xref="S3.E7.m1.21.21.21.7.7.7">PE</mtext></ci><apply id="S3.E7.m1.37.37.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><times id="S3.E7.m1.37.37.1.1.1.2.2.2.2.2.1.1.1.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5"></times><ci id="S3.E7.m1.23.23.23.9.9.9.cmml" xref="S3.E7.m1.23.23.23.9.9.9">𝒦</ci><apply id="S3.E7.m1.37.37.1.1.1.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.E7.m1.37.37.1.1.1.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5">superscript</csymbol><ci id="S3.E7.m1.25.25.25.11.11.11.cmml" xref="S3.E7.m1.25.25.25.11.11.11">𝑄</ci><apply id="S3.E7.m1.26.26.26.12.12.12.1.cmml" xref="S3.E7.m1.26.26.26.12.12.12.1"><minus id="S3.E7.m1.26.26.26.12.12.12.1.1.cmml" xref="S3.E7.m1.26.26.26.12.12.12.1.1"></minus><ci id="S3.E7.m1.26.26.26.12.12.12.1.2.cmml" xref="S3.E7.m1.26.26.26.12.12.12.1.2">𝑖</ci><cn type="integer" id="S3.E7.m1.26.26.26.12.12.12.1.3.cmml" xref="S3.E7.m1.26.26.26.12.12.12.1.3">1</cn></apply></apply></apply></apply></apply><apply id="S3.E7.m1.37.37.1.1.1.3.3.3.3.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><times id="S3.E7.m1.37.37.1.1.1.3.3.3.3.2.cmml" xref="S3.E7.m1.5.5.5.5.5.5"></times><ci id="S3.E7.m1.30.30.30.16.16.16.cmml" xref="S3.E7.m1.30.30.30.16.16.16">𝒦</ci><apply id="S3.E7.m1.37.37.1.1.1.3.3.3.3.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5"><csymbol cd="ambiguous" id="S3.E7.m1.37.37.1.1.1.3.3.3.3.1.1.1.1.cmml" xref="S3.E7.m1.5.5.5.5.5.5">superscript</csymbol><ci id="S3.E7.m1.32.32.32.18.18.18.cmml" xref="S3.E7.m1.32.32.32.18.18.18">𝑄</ci><apply id="S3.E7.m1.33.33.33.19.19.19.1.cmml" xref="S3.E7.m1.33.33.33.19.19.19.1"><minus id="S3.E7.m1.33.33.33.19.19.19.1.1.cmml" xref="S3.E7.m1.33.33.33.19.19.19.1.1"></minus><ci id="S3.E7.m1.33.33.33.19.19.19.1.2.cmml" xref="S3.E7.m1.33.33.33.19.19.19.1.2">𝑖</ci><cn type="integer" id="S3.E7.m1.33.33.33.19.19.19.1.3.cmml" xref="S3.E7.m1.33.33.33.19.19.19.1.3">1</cn></apply></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.38c">\begin{split}Q^{i}=\text{MHA}(&amp;Q^{i-1}+\text{PE}({Q^{i-1}}),\\
&amp;\mathcal{K}(Q^{i-1})+\text{PE}({\mathcal{K}(Q^{i-1}))},\mathcal{K}(Q^{i-1})),\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p5.10" class="ltx_p">where <math id="S3.SS2.p5.4.m1.3" class="ltx_Math" alttext="\text{MHA}(\cdot,\cdot,\cdot)" display="inline"><semantics id="S3.SS2.p5.4.m1.3a"><mrow id="S3.SS2.p5.4.m1.3.4" xref="S3.SS2.p5.4.m1.3.4.cmml"><mtext id="S3.SS2.p5.4.m1.3.4.2" xref="S3.SS2.p5.4.m1.3.4.2a.cmml">MHA</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.p5.4.m1.3.4.1" xref="S3.SS2.p5.4.m1.3.4.1.cmml">​</mo><mrow id="S3.SS2.p5.4.m1.3.4.3.2" xref="S3.SS2.p5.4.m1.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.p5.4.m1.3.4.3.2.1" xref="S3.SS2.p5.4.m1.3.4.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p5.4.m1.1.1" xref="S3.SS2.p5.4.m1.1.1.cmml">⋅</mo><mo rspace="0em" id="S3.SS2.p5.4.m1.3.4.3.2.2" xref="S3.SS2.p5.4.m1.3.4.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p5.4.m1.2.2" xref="S3.SS2.p5.4.m1.2.2.cmml">⋅</mo><mo rspace="0em" id="S3.SS2.p5.4.m1.3.4.3.2.3" xref="S3.SS2.p5.4.m1.3.4.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p5.4.m1.3.3" xref="S3.SS2.p5.4.m1.3.3.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p5.4.m1.3.4.3.2.4" xref="S3.SS2.p5.4.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m1.3b"><apply id="S3.SS2.p5.4.m1.3.4.cmml" xref="S3.SS2.p5.4.m1.3.4"><times id="S3.SS2.p5.4.m1.3.4.1.cmml" xref="S3.SS2.p5.4.m1.3.4.1"></times><ci id="S3.SS2.p5.4.m1.3.4.2a.cmml" xref="S3.SS2.p5.4.m1.3.4.2"><mtext id="S3.SS2.p5.4.m1.3.4.2.cmml" xref="S3.SS2.p5.4.m1.3.4.2">MHA</mtext></ci><vector id="S3.SS2.p5.4.m1.3.4.3.1.cmml" xref="S3.SS2.p5.4.m1.3.4.3.2"><ci id="S3.SS2.p5.4.m1.1.1.cmml" xref="S3.SS2.p5.4.m1.1.1">⋅</ci><ci id="S3.SS2.p5.4.m1.2.2.cmml" xref="S3.SS2.p5.4.m1.2.2">⋅</ci><ci id="S3.SS2.p5.4.m1.3.3.cmml" xref="S3.SS2.p5.4.m1.3.3">⋅</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m1.3c">\text{MHA}(\cdot,\cdot,\cdot)</annotation></semantics></math> represents the multi-head attention function, <math id="S3.SS2.p5.5.m2.3" class="ltx_Math" alttext="Q^{0}=[\mathcal{M}_{map},\mathcal{A}_{agent}]\in\mathbb{R}^{(N_{a}+N_{m})\times D_{1}}" display="inline"><semantics id="S3.SS2.p5.5.m2.3a"><mrow id="S3.SS2.p5.5.m2.3.3" xref="S3.SS2.p5.5.m2.3.3.cmml"><msup id="S3.SS2.p5.5.m2.3.3.4" xref="S3.SS2.p5.5.m2.3.3.4.cmml"><mi id="S3.SS2.p5.5.m2.3.3.4.2" xref="S3.SS2.p5.5.m2.3.3.4.2.cmml">Q</mi><mn id="S3.SS2.p5.5.m2.3.3.4.3" xref="S3.SS2.p5.5.m2.3.3.4.3.cmml">0</mn></msup><mo id="S3.SS2.p5.5.m2.3.3.5" xref="S3.SS2.p5.5.m2.3.3.5.cmml">=</mo><mrow id="S3.SS2.p5.5.m2.3.3.2.2" xref="S3.SS2.p5.5.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.SS2.p5.5.m2.3.3.2.2.3" xref="S3.SS2.p5.5.m2.3.3.2.3.cmml">[</mo><msub id="S3.SS2.p5.5.m2.2.2.1.1.1" xref="S3.SS2.p5.5.m2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.5.m2.2.2.1.1.1.2" xref="S3.SS2.p5.5.m2.2.2.1.1.1.2.cmml">ℳ</mi><mrow id="S3.SS2.p5.5.m2.2.2.1.1.1.3" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3.cmml"><mi id="S3.SS2.p5.5.m2.2.2.1.1.1.3.2" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.5.m2.2.2.1.1.1.3.1" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.5.m2.2.2.1.1.1.3.3" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.5.m2.2.2.1.1.1.3.1a" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.5.m2.2.2.1.1.1.3.4" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3.4.cmml">p</mi></mrow></msub><mo id="S3.SS2.p5.5.m2.3.3.2.2.4" xref="S3.SS2.p5.5.m2.3.3.2.3.cmml">,</mo><msub id="S3.SS2.p5.5.m2.3.3.2.2.2" xref="S3.SS2.p5.5.m2.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.5.m2.3.3.2.2.2.2" xref="S3.SS2.p5.5.m2.3.3.2.2.2.2.cmml">𝒜</mi><mrow id="S3.SS2.p5.5.m2.3.3.2.2.2.3" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.cmml"><mi id="S3.SS2.p5.5.m2.3.3.2.2.2.3.2" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.5.m2.3.3.2.2.2.3.1" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.5.m2.3.3.2.2.2.3.3" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.5.m2.3.3.2.2.2.3.1a" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.5.m2.3.3.2.2.2.3.4" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.5.m2.3.3.2.2.2.3.1b" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.5.m2.3.3.2.2.2.3.5" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.5.m2.3.3.2.2.2.3.1c" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.5.m2.3.3.2.2.2.3.6" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.6.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.SS2.p5.5.m2.3.3.2.2.5" xref="S3.SS2.p5.5.m2.3.3.2.3.cmml">]</mo></mrow><mo id="S3.SS2.p5.5.m2.3.3.6" xref="S3.SS2.p5.5.m2.3.3.6.cmml">∈</mo><msup id="S3.SS2.p5.5.m2.3.3.7" xref="S3.SS2.p5.5.m2.3.3.7.cmml"><mi id="S3.SS2.p5.5.m2.3.3.7.2" xref="S3.SS2.p5.5.m2.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.5.m2.1.1.1" xref="S3.SS2.p5.5.m2.1.1.1.cmml"><mrow id="S3.SS2.p5.5.m2.1.1.1.1.1" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p5.5.m2.1.1.1.1.1.2" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p5.5.m2.1.1.1.1.1.1" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.cmml"><msub id="S3.SS2.p5.5.m2.1.1.1.1.1.1.2" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.2" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.2.cmml">N</mi><mi id="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.3" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.3.cmml">a</mi></msub><mo id="S3.SS2.p5.5.m2.1.1.1.1.1.1.1" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS2.p5.5.m2.1.1.1.1.1.1.3" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.2" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.2.cmml">N</mi><mi id="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.3" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.3.cmml">m</mi></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.SS2.p5.5.m2.1.1.1.1.1.3" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.SS2.p5.5.m2.1.1.1.2" xref="S3.SS2.p5.5.m2.1.1.1.2.cmml">×</mo><msub id="S3.SS2.p5.5.m2.1.1.1.3" xref="S3.SS2.p5.5.m2.1.1.1.3.cmml"><mi id="S3.SS2.p5.5.m2.1.1.1.3.2" xref="S3.SS2.p5.5.m2.1.1.1.3.2.cmml">D</mi><mn id="S3.SS2.p5.5.m2.1.1.1.3.3" xref="S3.SS2.p5.5.m2.1.1.1.3.3.cmml">1</mn></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m2.3b"><apply id="S3.SS2.p5.5.m2.3.3.cmml" xref="S3.SS2.p5.5.m2.3.3"><and id="S3.SS2.p5.5.m2.3.3a.cmml" xref="S3.SS2.p5.5.m2.3.3"></and><apply id="S3.SS2.p5.5.m2.3.3b.cmml" xref="S3.SS2.p5.5.m2.3.3"><eq id="S3.SS2.p5.5.m2.3.3.5.cmml" xref="S3.SS2.p5.5.m2.3.3.5"></eq><apply id="S3.SS2.p5.5.m2.3.3.4.cmml" xref="S3.SS2.p5.5.m2.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m2.3.3.4.1.cmml" xref="S3.SS2.p5.5.m2.3.3.4">superscript</csymbol><ci id="S3.SS2.p5.5.m2.3.3.4.2.cmml" xref="S3.SS2.p5.5.m2.3.3.4.2">𝑄</ci><cn type="integer" id="S3.SS2.p5.5.m2.3.3.4.3.cmml" xref="S3.SS2.p5.5.m2.3.3.4.3">0</cn></apply><interval closure="closed" id="S3.SS2.p5.5.m2.3.3.2.3.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2"><apply id="S3.SS2.p5.5.m2.2.2.1.1.1.cmml" xref="S3.SS2.p5.5.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m2.2.2.1.1.1.1.cmml" xref="S3.SS2.p5.5.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.5.m2.2.2.1.1.1.2.cmml" xref="S3.SS2.p5.5.m2.2.2.1.1.1.2">ℳ</ci><apply id="S3.SS2.p5.5.m2.2.2.1.1.1.3.cmml" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3"><times id="S3.SS2.p5.5.m2.2.2.1.1.1.3.1.cmml" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3.1"></times><ci id="S3.SS2.p5.5.m2.2.2.1.1.1.3.2.cmml" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3.2">𝑚</ci><ci id="S3.SS2.p5.5.m2.2.2.1.1.1.3.3.cmml" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3.3">𝑎</ci><ci id="S3.SS2.p5.5.m2.2.2.1.1.1.3.4.cmml" xref="S3.SS2.p5.5.m2.2.2.1.1.1.3.4">𝑝</ci></apply></apply><apply id="S3.SS2.p5.5.m2.3.3.2.2.2.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m2.3.3.2.2.2.1.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p5.5.m2.3.3.2.2.2.2.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2.2.2">𝒜</ci><apply id="S3.SS2.p5.5.m2.3.3.2.2.2.3.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3"><times id="S3.SS2.p5.5.m2.3.3.2.2.2.3.1.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.1"></times><ci id="S3.SS2.p5.5.m2.3.3.2.2.2.3.2.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.2">𝑎</ci><ci id="S3.SS2.p5.5.m2.3.3.2.2.2.3.3.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.3">𝑔</ci><ci id="S3.SS2.p5.5.m2.3.3.2.2.2.3.4.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.4">𝑒</ci><ci id="S3.SS2.p5.5.m2.3.3.2.2.2.3.5.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.5">𝑛</ci><ci id="S3.SS2.p5.5.m2.3.3.2.2.2.3.6.cmml" xref="S3.SS2.p5.5.m2.3.3.2.2.2.3.6">𝑡</ci></apply></apply></interval></apply><apply id="S3.SS2.p5.5.m2.3.3c.cmml" xref="S3.SS2.p5.5.m2.3.3"><in id="S3.SS2.p5.5.m2.3.3.6.cmml" xref="S3.SS2.p5.5.m2.3.3.6"></in><share href="#S3.SS2.p5.5.m2.3.3.2.cmml" id="S3.SS2.p5.5.m2.3.3d.cmml" xref="S3.SS2.p5.5.m2.3.3"></share><apply id="S3.SS2.p5.5.m2.3.3.7.cmml" xref="S3.SS2.p5.5.m2.3.3.7"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m2.3.3.7.1.cmml" xref="S3.SS2.p5.5.m2.3.3.7">superscript</csymbol><ci id="S3.SS2.p5.5.m2.3.3.7.2.cmml" xref="S3.SS2.p5.5.m2.3.3.7.2">ℝ</ci><apply id="S3.SS2.p5.5.m2.1.1.1.cmml" xref="S3.SS2.p5.5.m2.1.1.1"><times id="S3.SS2.p5.5.m2.1.1.1.2.cmml" xref="S3.SS2.p5.5.m2.1.1.1.2"></times><apply id="S3.SS2.p5.5.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.5.m2.1.1.1.1.1"><plus id="S3.SS2.p5.5.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.1"></plus><apply id="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.2">𝑁</ci><ci id="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.2.3">𝑎</ci></apply><apply id="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.2">𝑁</ci><ci id="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p5.5.m2.1.1.1.1.1.1.3.3">𝑚</ci></apply></apply><apply id="S3.SS2.p5.5.m2.1.1.1.3.cmml" xref="S3.SS2.p5.5.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m2.1.1.1.3.1.cmml" xref="S3.SS2.p5.5.m2.1.1.1.3">subscript</csymbol><ci id="S3.SS2.p5.5.m2.1.1.1.3.2.cmml" xref="S3.SS2.p5.5.m2.1.1.1.3.2">𝐷</ci><cn type="integer" id="S3.SS2.p5.5.m2.1.1.1.3.3.cmml" xref="S3.SS2.p5.5.m2.1.1.1.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m2.3c">Q^{0}=[\mathcal{M}_{map},\mathcal{A}_{agent}]\in\mathbb{R}^{(N_{a}+N_{m})\times D_{1}}</annotation></semantics></math>, and
<math id="S3.SS2.p5.6.m3.1" class="ltx_Math" alttext="\mathcal{K}(\cdot)" display="inline"><semantics id="S3.SS2.p5.6.m3.1a"><mrow id="S3.SS2.p5.6.m3.1.2" xref="S3.SS2.p5.6.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.6.m3.1.2.2" xref="S3.SS2.p5.6.m3.1.2.2.cmml">𝒦</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.6.m3.1.2.1" xref="S3.SS2.p5.6.m3.1.2.1.cmml">​</mo><mrow id="S3.SS2.p5.6.m3.1.2.3.2" xref="S3.SS2.p5.6.m3.1.2.cmml"><mo stretchy="false" id="S3.SS2.p5.6.m3.1.2.3.2.1" xref="S3.SS2.p5.6.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p5.6.m3.1.1" xref="S3.SS2.p5.6.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p5.6.m3.1.2.3.2.2" xref="S3.SS2.p5.6.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m3.1b"><apply id="S3.SS2.p5.6.m3.1.2.cmml" xref="S3.SS2.p5.6.m3.1.2"><times id="S3.SS2.p5.6.m3.1.2.1.cmml" xref="S3.SS2.p5.6.m3.1.2.1"></times><ci id="S3.SS2.p5.6.m3.1.2.2.cmml" xref="S3.SS2.p5.6.m3.1.2.2">𝒦</ci><ci id="S3.SS2.p5.6.m3.1.1.cmml" xref="S3.SS2.p5.6.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m3.1c">\mathcal{K}(\cdot)</annotation></semantics></math> denotes the <math id="S3.SS2.p5.7.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p5.7.m4.1a"><mi id="S3.SS2.p5.7.m4.1.1" xref="S3.SS2.p5.7.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.7.m4.1b"><ci id="S3.SS2.p5.7.m4.1.1.cmml" xref="S3.SS2.p5.7.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.7.m4.1c">K</annotation></semantics></math>-nearest neighbours (KNN) algorithm, which is used to identify the <math id="S3.SS2.p5.8.m5.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p5.8.m5.1a"><mi id="S3.SS2.p5.8.m5.1.1" xref="S3.SS2.p5.8.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.8.m5.1b"><ci id="S3.SS2.p5.8.m5.1.1.cmml" xref="S3.SS2.p5.8.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.8.m5.1c">K</annotation></semantics></math> nearest tokens relative to each query. The term <math id="S3.SS2.p5.9.m6.1" class="ltx_Math" alttext="\text{PE}(\cdot)" display="inline"><semantics id="S3.SS2.p5.9.m6.1a"><mrow id="S3.SS2.p5.9.m6.1.2" xref="S3.SS2.p5.9.m6.1.2.cmml"><mtext id="S3.SS2.p5.9.m6.1.2.2" xref="S3.SS2.p5.9.m6.1.2.2a.cmml">PE</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.p5.9.m6.1.2.1" xref="S3.SS2.p5.9.m6.1.2.1.cmml">​</mo><mrow id="S3.SS2.p5.9.m6.1.2.3.2" xref="S3.SS2.p5.9.m6.1.2.cmml"><mo stretchy="false" id="S3.SS2.p5.9.m6.1.2.3.2.1" xref="S3.SS2.p5.9.m6.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.p5.9.m6.1.1" xref="S3.SS2.p5.9.m6.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.p5.9.m6.1.2.3.2.2" xref="S3.SS2.p5.9.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.9.m6.1b"><apply id="S3.SS2.p5.9.m6.1.2.cmml" xref="S3.SS2.p5.9.m6.1.2"><times id="S3.SS2.p5.9.m6.1.2.1.cmml" xref="S3.SS2.p5.9.m6.1.2.1"></times><ci id="S3.SS2.p5.9.m6.1.2.2a.cmml" xref="S3.SS2.p5.9.m6.1.2.2"><mtext id="S3.SS2.p5.9.m6.1.2.2.cmml" xref="S3.SS2.p5.9.m6.1.2.2">PE</mtext></ci><ci id="S3.SS2.p5.9.m6.1.1.cmml" xref="S3.SS2.p5.9.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.9.m6.1c">\text{PE}(\cdot)</annotation></semantics></math> refers to the sinusoidal positional encoding assigned to input tokens, incorporating the most recent position of each agent and the central point of each map polyline. The final output of the local attention layer will be snet into the MTR decoder, <math id="S3.SS2.p5.10.m7.2" class="ltx_Math" alttext="[\mathcal{M}_{map},\mathcal{A}_{agent}]=Q^{Final}" display="inline"><semantics id="S3.SS2.p5.10.m7.2a"><mrow id="S3.SS2.p5.10.m7.2.2" xref="S3.SS2.p5.10.m7.2.2.cmml"><mrow id="S3.SS2.p5.10.m7.2.2.2.2" xref="S3.SS2.p5.10.m7.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p5.10.m7.2.2.2.2.3" xref="S3.SS2.p5.10.m7.2.2.2.3.cmml">[</mo><msub id="S3.SS2.p5.10.m7.1.1.1.1.1" xref="S3.SS2.p5.10.m7.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.10.m7.1.1.1.1.1.2" xref="S3.SS2.p5.10.m7.1.1.1.1.1.2.cmml">ℳ</mi><mrow id="S3.SS2.p5.10.m7.1.1.1.1.1.3" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p5.10.m7.1.1.1.1.1.3.2" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.10.m7.1.1.1.1.1.3.1" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.10.m7.1.1.1.1.1.3.3" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.10.m7.1.1.1.1.1.3.1a" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.10.m7.1.1.1.1.1.3.4" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3.4.cmml">p</mi></mrow></msub><mo id="S3.SS2.p5.10.m7.2.2.2.2.4" xref="S3.SS2.p5.10.m7.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p5.10.m7.2.2.2.2.2" xref="S3.SS2.p5.10.m7.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.10.m7.2.2.2.2.2.2" xref="S3.SS2.p5.10.m7.2.2.2.2.2.2.cmml">𝒜</mi><mrow id="S3.SS2.p5.10.m7.2.2.2.2.2.3" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.cmml"><mi id="S3.SS2.p5.10.m7.2.2.2.2.2.3.2" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.10.m7.2.2.2.2.2.3.1" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.10.m7.2.2.2.2.2.3.3" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.10.m7.2.2.2.2.2.3.1a" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.10.m7.2.2.2.2.2.3.4" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.10.m7.2.2.2.2.2.3.1b" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.10.m7.2.2.2.2.2.3.5" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.10.m7.2.2.2.2.2.3.1c" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p5.10.m7.2.2.2.2.2.3.6" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.6.cmml">t</mi></mrow></msub><mo stretchy="false" id="S3.SS2.p5.10.m7.2.2.2.2.5" xref="S3.SS2.p5.10.m7.2.2.2.3.cmml">]</mo></mrow><mo id="S3.SS2.p5.10.m7.2.2.3" xref="S3.SS2.p5.10.m7.2.2.3.cmml">=</mo><msup id="S3.SS2.p5.10.m7.2.2.4" xref="S3.SS2.p5.10.m7.2.2.4.cmml"><mi id="S3.SS2.p5.10.m7.2.2.4.2" xref="S3.SS2.p5.10.m7.2.2.4.2.cmml">Q</mi><mrow id="S3.SS2.p5.10.m7.2.2.4.3" xref="S3.SS2.p5.10.m7.2.2.4.3.cmml"><mi id="S3.SS2.p5.10.m7.2.2.4.3.2" xref="S3.SS2.p5.10.m7.2.2.4.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.10.m7.2.2.4.3.1" xref="S3.SS2.p5.10.m7.2.2.4.3.1.cmml">​</mo><mi id="S3.SS2.p5.10.m7.2.2.4.3.3" xref="S3.SS2.p5.10.m7.2.2.4.3.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.10.m7.2.2.4.3.1a" xref="S3.SS2.p5.10.m7.2.2.4.3.1.cmml">​</mo><mi id="S3.SS2.p5.10.m7.2.2.4.3.4" xref="S3.SS2.p5.10.m7.2.2.4.3.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.10.m7.2.2.4.3.1b" xref="S3.SS2.p5.10.m7.2.2.4.3.1.cmml">​</mo><mi id="S3.SS2.p5.10.m7.2.2.4.3.5" xref="S3.SS2.p5.10.m7.2.2.4.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.10.m7.2.2.4.3.1c" xref="S3.SS2.p5.10.m7.2.2.4.3.1.cmml">​</mo><mi id="S3.SS2.p5.10.m7.2.2.4.3.6" xref="S3.SS2.p5.10.m7.2.2.4.3.6.cmml">l</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.10.m7.2b"><apply id="S3.SS2.p5.10.m7.2.2.cmml" xref="S3.SS2.p5.10.m7.2.2"><eq id="S3.SS2.p5.10.m7.2.2.3.cmml" xref="S3.SS2.p5.10.m7.2.2.3"></eq><interval closure="closed" id="S3.SS2.p5.10.m7.2.2.2.3.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2"><apply id="S3.SS2.p5.10.m7.1.1.1.1.1.cmml" xref="S3.SS2.p5.10.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.10.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.10.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.10.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.10.m7.1.1.1.1.1.2">ℳ</ci><apply id="S3.SS2.p5.10.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3"><times id="S3.SS2.p5.10.m7.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3.1"></times><ci id="S3.SS2.p5.10.m7.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3.2">𝑚</ci><ci id="S3.SS2.p5.10.m7.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3.3">𝑎</ci><ci id="S3.SS2.p5.10.m7.1.1.1.1.1.3.4.cmml" xref="S3.SS2.p5.10.m7.1.1.1.1.1.3.4">𝑝</ci></apply></apply><apply id="S3.SS2.p5.10.m7.2.2.2.2.2.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.10.m7.2.2.2.2.2.1.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p5.10.m7.2.2.2.2.2.2.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2.2.2">𝒜</ci><apply id="S3.SS2.p5.10.m7.2.2.2.2.2.3.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3"><times id="S3.SS2.p5.10.m7.2.2.2.2.2.3.1.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.1"></times><ci id="S3.SS2.p5.10.m7.2.2.2.2.2.3.2.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.2">𝑎</ci><ci id="S3.SS2.p5.10.m7.2.2.2.2.2.3.3.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.3">𝑔</ci><ci id="S3.SS2.p5.10.m7.2.2.2.2.2.3.4.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.4">𝑒</ci><ci id="S3.SS2.p5.10.m7.2.2.2.2.2.3.5.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.5">𝑛</ci><ci id="S3.SS2.p5.10.m7.2.2.2.2.2.3.6.cmml" xref="S3.SS2.p5.10.m7.2.2.2.2.2.3.6">𝑡</ci></apply></apply></interval><apply id="S3.SS2.p5.10.m7.2.2.4.cmml" xref="S3.SS2.p5.10.m7.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p5.10.m7.2.2.4.1.cmml" xref="S3.SS2.p5.10.m7.2.2.4">superscript</csymbol><ci id="S3.SS2.p5.10.m7.2.2.4.2.cmml" xref="S3.SS2.p5.10.m7.2.2.4.2">𝑄</ci><apply id="S3.SS2.p5.10.m7.2.2.4.3.cmml" xref="S3.SS2.p5.10.m7.2.2.4.3"><times id="S3.SS2.p5.10.m7.2.2.4.3.1.cmml" xref="S3.SS2.p5.10.m7.2.2.4.3.1"></times><ci id="S3.SS2.p5.10.m7.2.2.4.3.2.cmml" xref="S3.SS2.p5.10.m7.2.2.4.3.2">𝐹</ci><ci id="S3.SS2.p5.10.m7.2.2.4.3.3.cmml" xref="S3.SS2.p5.10.m7.2.2.4.3.3">𝑖</ci><ci id="S3.SS2.p5.10.m7.2.2.4.3.4.cmml" xref="S3.SS2.p5.10.m7.2.2.4.3.4">𝑛</ci><ci id="S3.SS2.p5.10.m7.2.2.4.3.5.cmml" xref="S3.SS2.p5.10.m7.2.2.4.3.5">𝑎</ci><ci id="S3.SS2.p5.10.m7.2.2.4.3.6.cmml" xref="S3.SS2.p5.10.m7.2.2.4.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.10.m7.2c">[\mathcal{M}_{map},\mathcal{A}_{agent}]=Q^{Final}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Network Decoder</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">The decoder architecture is identical to the MTR decoder from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, except for the method used to calculate the loss from the output trajectories. Between the output of each decoder layer and the loss calculation, we apply evolving and distinct anchor techniques as described in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. We use 6 decoder layers, with evolving anchors applied at the second and fourth layers, and distinct anchors selected at each layer.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS4.5.1.1" class="ltx_text">III-D</span> </span><span id="S3.SS4.6.2" class="ltx_text ltx_font_italic">Loss Function</span>
</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.3" class="ltx_p">We put forward a combined loss function which is consist of two components: Original MTR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> loss and recovery loss. The total loss function can be defined as follows:
<br class="ltx_break"></p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.1" class="ltx_Math" alttext="\mathcal{L}_{Total}=\mathcal{L}_{MTR}+\mathcal{L}_{Recovery}" display="block"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml"><msub id="S3.E8.m1.1.1.2" xref="S3.E8.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.2.2" xref="S3.E8.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S3.E8.m1.1.1.2.3" xref="S3.E8.m1.1.1.2.3.cmml"><mi id="S3.E8.m1.1.1.2.3.2" xref="S3.E8.m1.1.1.2.3.2.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.3.1" xref="S3.E8.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.2.3.3" xref="S3.E8.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.3.1a" xref="S3.E8.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.2.3.4" xref="S3.E8.m1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.3.1b" xref="S3.E8.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.2.3.5" xref="S3.E8.m1.1.1.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.2.3.1c" xref="S3.E8.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.2.3.6" xref="S3.E8.m1.1.1.2.3.6.cmml">l</mi></mrow></msub><mo id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.3" xref="S3.E8.m1.1.1.3.cmml"><msub id="S3.E8.m1.1.1.3.2" xref="S3.E8.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.3.2.2" xref="S3.E8.m1.1.1.3.2.2.cmml">ℒ</mi><mrow id="S3.E8.m1.1.1.3.2.3" xref="S3.E8.m1.1.1.3.2.3.cmml"><mi id="S3.E8.m1.1.1.3.2.3.2" xref="S3.E8.m1.1.1.3.2.3.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.2.3.1" xref="S3.E8.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.2.3.3" xref="S3.E8.m1.1.1.3.2.3.3.cmml">T</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.2.3.1a" xref="S3.E8.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.2.3.4" xref="S3.E8.m1.1.1.3.2.3.4.cmml">R</mi></mrow></msub><mo id="S3.E8.m1.1.1.3.1" xref="S3.E8.m1.1.1.3.1.cmml">+</mo><msub id="S3.E8.m1.1.1.3.3" xref="S3.E8.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.3.3.2" xref="S3.E8.m1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S3.E8.m1.1.1.3.3.3" xref="S3.E8.m1.1.1.3.3.3.cmml"><mi id="S3.E8.m1.1.1.3.3.3.2" xref="S3.E8.m1.1.1.3.3.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.3.3.1" xref="S3.E8.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.3.3.3" xref="S3.E8.m1.1.1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.3.3.1a" xref="S3.E8.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.3.3.4" xref="S3.E8.m1.1.1.3.3.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.3.3.1b" xref="S3.E8.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.3.3.5" xref="S3.E8.m1.1.1.3.3.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.3.3.1c" xref="S3.E8.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.3.3.6" xref="S3.E8.m1.1.1.3.3.3.6.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.3.3.1d" xref="S3.E8.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.3.3.7" xref="S3.E8.m1.1.1.3.3.3.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.3.3.1e" xref="S3.E8.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.3.3.8" xref="S3.E8.m1.1.1.3.3.3.8.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.1.1.3.3.3.1f" xref="S3.E8.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E8.m1.1.1.3.3.3.9" xref="S3.E8.m1.1.1.3.3.3.9.cmml">y</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"><eq id="S3.E8.m1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"></eq><apply id="S3.E8.m1.1.1.2.cmml" xref="S3.E8.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.2.1.cmml" xref="S3.E8.m1.1.1.2">subscript</csymbol><ci id="S3.E8.m1.1.1.2.2.cmml" xref="S3.E8.m1.1.1.2.2">ℒ</ci><apply id="S3.E8.m1.1.1.2.3.cmml" xref="S3.E8.m1.1.1.2.3"><times id="S3.E8.m1.1.1.2.3.1.cmml" xref="S3.E8.m1.1.1.2.3.1"></times><ci id="S3.E8.m1.1.1.2.3.2.cmml" xref="S3.E8.m1.1.1.2.3.2">𝑇</ci><ci id="S3.E8.m1.1.1.2.3.3.cmml" xref="S3.E8.m1.1.1.2.3.3">𝑜</ci><ci id="S3.E8.m1.1.1.2.3.4.cmml" xref="S3.E8.m1.1.1.2.3.4">𝑡</ci><ci id="S3.E8.m1.1.1.2.3.5.cmml" xref="S3.E8.m1.1.1.2.3.5">𝑎</ci><ci id="S3.E8.m1.1.1.2.3.6.cmml" xref="S3.E8.m1.1.1.2.3.6">𝑙</ci></apply></apply><apply id="S3.E8.m1.1.1.3.cmml" xref="S3.E8.m1.1.1.3"><plus id="S3.E8.m1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.3.1"></plus><apply id="S3.E8.m1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.3.2.2">ℒ</ci><apply id="S3.E8.m1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.3.2.3"><times id="S3.E8.m1.1.1.3.2.3.1.cmml" xref="S3.E8.m1.1.1.3.2.3.1"></times><ci id="S3.E8.m1.1.1.3.2.3.2.cmml" xref="S3.E8.m1.1.1.3.2.3.2">𝑀</ci><ci id="S3.E8.m1.1.1.3.2.3.3.cmml" xref="S3.E8.m1.1.1.3.2.3.3">𝑇</ci><ci id="S3.E8.m1.1.1.3.2.3.4.cmml" xref="S3.E8.m1.1.1.3.2.3.4">𝑅</ci></apply></apply><apply id="S3.E8.m1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.3.3.2">ℒ</ci><apply id="S3.E8.m1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.3.3.3"><times id="S3.E8.m1.1.1.3.3.3.1.cmml" xref="S3.E8.m1.1.1.3.3.3.1"></times><ci id="S3.E8.m1.1.1.3.3.3.2.cmml" xref="S3.E8.m1.1.1.3.3.3.2">𝑅</ci><ci id="S3.E8.m1.1.1.3.3.3.3.cmml" xref="S3.E8.m1.1.1.3.3.3.3">𝑒</ci><ci id="S3.E8.m1.1.1.3.3.3.4.cmml" xref="S3.E8.m1.1.1.3.3.3.4">𝑐</ci><ci id="S3.E8.m1.1.1.3.3.3.5.cmml" xref="S3.E8.m1.1.1.3.3.3.5">𝑜</ci><ci id="S3.E8.m1.1.1.3.3.3.6.cmml" xref="S3.E8.m1.1.1.3.3.3.6">𝑣</ci><ci id="S3.E8.m1.1.1.3.3.3.7.cmml" xref="S3.E8.m1.1.1.3.3.3.7">𝑒</ci><ci id="S3.E8.m1.1.1.3.3.3.8.cmml" xref="S3.E8.m1.1.1.3.3.3.8">𝑟</ci><ci id="S3.E8.m1.1.1.3.3.3.9.cmml" xref="S3.E8.m1.1.1.3.3.3.9">𝑦</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">\mathcal{L}_{Total}=\mathcal{L}_{MTR}+\mathcal{L}_{Recovery}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.2" class="ltx_p">For the MTR loss, We follow the loss function of MTR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, using a decoder loss <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{Decoder}" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml"><mi id="S3.SS4.p1.1.m1.1.1.3.2" xref="S3.SS4.p1.1.m1.1.1.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.1" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.3" xref="S3.SS4.p1.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.1a" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.4" xref="S3.SS4.p1.1.m1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.1b" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.5" xref="S3.SS4.p1.1.m1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.1c" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.6" xref="S3.SS4.p1.1.m1.1.1.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.1d" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.7" xref="S3.SS4.p1.1.m1.1.1.3.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.1.m1.1.1.3.1e" xref="S3.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.1.m1.1.1.3.8" xref="S3.SS4.p1.1.m1.1.1.3.8.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">ℒ</ci><apply id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3"><times id="S3.SS4.p1.1.m1.1.1.3.1.cmml" xref="S3.SS4.p1.1.m1.1.1.3.1"></times><ci id="S3.SS4.p1.1.m1.1.1.3.2.cmml" xref="S3.SS4.p1.1.m1.1.1.3.2">𝐷</ci><ci id="S3.SS4.p1.1.m1.1.1.3.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S3.SS4.p1.1.m1.1.1.3.4.cmml" xref="S3.SS4.p1.1.m1.1.1.3.4">𝑐</ci><ci id="S3.SS4.p1.1.m1.1.1.3.5.cmml" xref="S3.SS4.p1.1.m1.1.1.3.5">𝑜</ci><ci id="S3.SS4.p1.1.m1.1.1.3.6.cmml" xref="S3.SS4.p1.1.m1.1.1.3.6">𝑑</ci><ci id="S3.SS4.p1.1.m1.1.1.3.7.cmml" xref="S3.SS4.p1.1.m1.1.1.3.7">𝑒</ci><ci id="S3.SS4.p1.1.m1.1.1.3.8.cmml" xref="S3.SS4.p1.1.m1.1.1.3.8">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\mathcal{L}_{Decoder}</annotation></semantics></math> and a dense future prediction loss <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{Df}" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml"><mi id="S3.SS4.p1.2.m2.1.1.3.2" xref="S3.SS4.p1.2.m2.1.1.3.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.2.m2.1.1.3.1" xref="S3.SS4.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p1.2.m2.1.1.3.3" xref="S3.SS4.p1.2.m2.1.1.3.3.cmml">f</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">ℒ</ci><apply id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3"><times id="S3.SS4.p1.2.m2.1.1.3.1.cmml" xref="S3.SS4.p1.2.m2.1.1.3.1"></times><ci id="S3.SS4.p1.2.m2.1.1.3.2.cmml" xref="S3.SS4.p1.2.m2.1.1.3.2">𝐷</ci><ci id="S3.SS4.p1.2.m2.1.1.3.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3.3">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">\mathcal{L}_{Df}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.4" class="ltx_p">The recovery loss <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{Recovery}" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><msub id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.1.m1.1.1.2" xref="S3.SS4.p2.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3.cmml"><mi id="S3.SS4.p2.1.m1.1.1.3.2" xref="S3.SS4.p2.1.m1.1.1.3.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.3.1" xref="S3.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.3.3" xref="S3.SS4.p2.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.3.1a" xref="S3.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.3.4" xref="S3.SS4.p2.1.m1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.3.1b" xref="S3.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.3.5" xref="S3.SS4.p2.1.m1.1.1.3.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.3.1c" xref="S3.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.3.6" xref="S3.SS4.p2.1.m1.1.1.3.6.cmml">v</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.3.1d" xref="S3.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.3.7" xref="S3.SS4.p2.1.m1.1.1.3.7.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.3.1e" xref="S3.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.3.8" xref="S3.SS4.p2.1.m1.1.1.3.8.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.1.3.1f" xref="S3.SS4.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.1.m1.1.1.3.9" xref="S3.SS4.p2.1.m1.1.1.3.9.cmml">y</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2">ℒ</ci><apply id="S3.SS4.p2.1.m1.1.1.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3"><times id="S3.SS4.p2.1.m1.1.1.3.1.cmml" xref="S3.SS4.p2.1.m1.1.1.3.1"></times><ci id="S3.SS4.p2.1.m1.1.1.3.2.cmml" xref="S3.SS4.p2.1.m1.1.1.3.2">𝑅</ci><ci id="S3.SS4.p2.1.m1.1.1.3.3.cmml" xref="S3.SS4.p2.1.m1.1.1.3.3">𝑒</ci><ci id="S3.SS4.p2.1.m1.1.1.3.4.cmml" xref="S3.SS4.p2.1.m1.1.1.3.4">𝑐</ci><ci id="S3.SS4.p2.1.m1.1.1.3.5.cmml" xref="S3.SS4.p2.1.m1.1.1.3.5">𝑜</ci><ci id="S3.SS4.p2.1.m1.1.1.3.6.cmml" xref="S3.SS4.p2.1.m1.1.1.3.6">𝑣</ci><ci id="S3.SS4.p2.1.m1.1.1.3.7.cmml" xref="S3.SS4.p2.1.m1.1.1.3.7">𝑒</ci><ci id="S3.SS4.p2.1.m1.1.1.3.8.cmml" xref="S3.SS4.p2.1.m1.1.1.3.8">𝑟</ci><ci id="S3.SS4.p2.1.m1.1.1.3.9.cmml" xref="S3.SS4.p2.1.m1.1.1.3.9">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathcal{L}_{Recovery}</annotation></semantics></math> aims to optimize the recovery module to resume the incomplete historical trajectories and it is simply the <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{1}" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><msub id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">ℒ</mi><mn id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2">ℒ</ci><cn type="integer" id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">\mathcal{L}_{1}</annotation></semantics></math> loss of recovered <math id="S3.SS4.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{A}_{Past}" display="inline"><semantics id="S3.SS4.p2.3.m3.1a"><msub id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">𝒜</mi><mrow id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml"><mi id="S3.SS4.p2.3.m3.1.1.3.2" xref="S3.SS4.p2.3.m3.1.1.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.3.m3.1.1.3.1" xref="S3.SS4.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.3.m3.1.1.3.3" xref="S3.SS4.p2.3.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.3.m3.1.1.3.1a" xref="S3.SS4.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.3.m3.1.1.3.4" xref="S3.SS4.p2.3.m3.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.3.m3.1.1.3.1b" xref="S3.SS4.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.3.m3.1.1.3.5" xref="S3.SS4.p2.3.m3.1.1.3.5.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2">𝒜</ci><apply id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3"><times id="S3.SS4.p2.3.m3.1.1.3.1.cmml" xref="S3.SS4.p2.3.m3.1.1.3.1"></times><ci id="S3.SS4.p2.3.m3.1.1.3.2.cmml" xref="S3.SS4.p2.3.m3.1.1.3.2">𝑃</ci><ci id="S3.SS4.p2.3.m3.1.1.3.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3.3">𝑎</ci><ci id="S3.SS4.p2.3.m3.1.1.3.4.cmml" xref="S3.SS4.p2.3.m3.1.1.3.4">𝑠</ci><ci id="S3.SS4.p2.3.m3.1.1.3.5.cmml" xref="S3.SS4.p2.3.m3.1.1.3.5">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">\mathcal{A}_{Past}</annotation></semantics></math> and ground truth historical trajectories <math id="S3.SS4.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{A}_{PastGT}" display="inline"><semantics id="S3.SS4.p2.4.m4.1a"><msub id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p2.4.m4.1.1.2" xref="S3.SS4.p2.4.m4.1.1.2.cmml">𝒜</mi><mrow id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3.cmml"><mi id="S3.SS4.p2.4.m4.1.1.3.2" xref="S3.SS4.p2.4.m4.1.1.3.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.4.m4.1.1.3.1" xref="S3.SS4.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.4.m4.1.1.3.3" xref="S3.SS4.p2.4.m4.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.4.m4.1.1.3.1a" xref="S3.SS4.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.4.m4.1.1.3.4" xref="S3.SS4.p2.4.m4.1.1.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.4.m4.1.1.3.1b" xref="S3.SS4.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.4.m4.1.1.3.5" xref="S3.SS4.p2.4.m4.1.1.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.4.m4.1.1.3.1c" xref="S3.SS4.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.4.m4.1.1.3.6" xref="S3.SS4.p2.4.m4.1.1.3.6.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p2.4.m4.1.1.3.1d" xref="S3.SS4.p2.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS4.p2.4.m4.1.1.3.7" xref="S3.SS4.p2.4.m4.1.1.3.7.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2">𝒜</ci><apply id="S3.SS4.p2.4.m4.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3"><times id="S3.SS4.p2.4.m4.1.1.3.1.cmml" xref="S3.SS4.p2.4.m4.1.1.3.1"></times><ci id="S3.SS4.p2.4.m4.1.1.3.2.cmml" xref="S3.SS4.p2.4.m4.1.1.3.2">𝑃</ci><ci id="S3.SS4.p2.4.m4.1.1.3.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3.3">𝑎</ci><ci id="S3.SS4.p2.4.m4.1.1.3.4.cmml" xref="S3.SS4.p2.4.m4.1.1.3.4">𝑠</ci><ci id="S3.SS4.p2.4.m4.1.1.3.5.cmml" xref="S3.SS4.p2.4.m4.1.1.3.5">𝑡</ci><ci id="S3.SS4.p2.4.m4.1.1.3.6.cmml" xref="S3.SS4.p2.4.m4.1.1.3.6">𝐺</ci><ci id="S3.SS4.p2.4.m4.1.1.3.7.cmml" xref="S3.SS4.p2.4.m4.1.1.3.7">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">\mathcal{A}_{PastGT}</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Prediction on the test leaderboard of the motion prediction track of the Waymo Open Dataset Challenge. Our approach is termed as RMP, i.e., Robust Motion Predictor. Soft mAP is the official ranking metric, while miss rate is the secondary ranking metric. The first place is denoted by <span id="S4.T1.14.1" class="ltx_text ltx_font_bold">bold</span>, the second place by <span id="S4.T1.15.2" class="ltx_text ltx_framed ltx_framed_underline">underline</span>, and the third place by *asterisk.</figcaption>
<table id="S4.T1.11" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S4.T1.6.6" class="ltx_tr" style="background-color:#DCDCDC;">
<td id="S4.T1.6.6.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.6.6.7.1" class="ltx_text" style="background-color:#DCDCDC;">Waymo Competition</span></td>
<td id="S4.T1.6.6.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.6.6.8.1" class="ltx_text" style="background-color:#DCDCDC;">Method</span></td>
<td id="S4.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.1.1.1" class="ltx_text" style="background-color:#DCDCDC;">Soft mAP <math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\uparrow" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><ci id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
<td id="S4.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.2.2.2.1" class="ltx_text" style="background-color:#DCDCDC;">mAP <math id="S4.T1.2.2.2.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\uparrow" display="inline"><semantics id="S4.T1.2.2.2.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T1.2.2.2.1.m1.1.1" xref="S4.T1.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.1.m1.1b"><ci id="S4.T1.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
<td id="S4.T1.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.3.3.3.1" class="ltx_text" style="background-color:#DCDCDC;">minADE <math id="S4.T1.3.3.3.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\downarrow" display="inline"><semantics id="S4.T1.3.3.3.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T1.3.3.3.1.m1.1.1" xref="S4.T1.3.3.3.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.m1.1b"><ci id="S4.T1.3.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S4.T1.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.4.4.4.1" class="ltx_text" style="background-color:#DCDCDC;">minFDE <math id="S4.T1.4.4.4.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\downarrow" display="inline"><semantics id="S4.T1.4.4.4.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T1.4.4.4.1.m1.1.1" xref="S4.T1.4.4.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.1.m1.1b"><ci id="S4.T1.4.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S4.T1.5.5.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.5.5.5.1" class="ltx_text" style="background-color:#DCDCDC;">Miss Rate <math id="S4.T1.5.5.5.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\downarrow" display="inline"><semantics id="S4.T1.5.5.5.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T1.5.5.5.1.m1.1.1" xref="S4.T1.5.5.5.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.1.m1.1b"><ci id="S4.T1.5.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.5.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S4.T1.6.6.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.6.6.6.1" class="ltx_text" style="background-color:#DCDCDC;">Overlap Rate <math id="S4.T1.6.6.6.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\downarrow" display="inline"><semantics id="S4.T1.6.6.6.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T1.6.6.6.1.m1.1.1" xref="S4.T1.6.6.6.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.1.m1.1b"><ci id="S4.T1.6.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.6.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T1.11.12" class="ltx_tr">
<td id="S4.T1.11.12.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="12"><span id="S4.T1.11.12.1.1" class="ltx_text">2024</span></td>
<td id="S4.T1.11.12.2" class="ltx_td ltx_align_center ltx_border_t">MTR v3<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>
</td>
<td id="S4.T1.11.12.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.11.12.3.1" class="ltx_text ltx_font_bold">0.4967</span></td>
<td id="S4.T1.11.12.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.11.12.4.1" class="ltx_text ltx_font_bold">0.4859</span></td>
<td id="S4.T1.11.12.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.11.12.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.5554</span></td>
<td id="S4.T1.11.12.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.11.12.6.1" class="ltx_text ltx_framed ltx_framed_underline">1.1062</span></td>
<td id="S4.T1.11.12.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.11.12.7.1" class="ltx_text ltx_framed ltx_framed_underline">0.1098</span></td>
<td id="S4.T1.11.12.8" class="ltx_td ltx_align_center ltx_border_t">0.1279</td>
</tr>
<tr id="S4.T1.7.7" class="ltx_tr">
<td id="S4.T1.7.7.2" class="ltx_td ltx_align_center">ModeSeq<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite>
</td>
<td id="S4.T1.7.7.3" class="ltx_td ltx_align_center"><span id="S4.T1.7.7.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.4737</span></td>
<td id="S4.T1.7.7.4" class="ltx_td ltx_align_center"><span id="S4.T1.7.7.4.1" class="ltx_text ltx_framed ltx_framed_underline">0.4665</span></td>
<td id="S4.T1.7.7.1" class="ltx_td ltx_align_center"><math id="S4.T1.7.7.1.m1.1" class="ltx_Math" alttext="0.5680^{*}" display="inline"><semantics id="S4.T1.7.7.1.m1.1a"><msup id="S4.T1.7.7.1.m1.1.1" xref="S4.T1.7.7.1.m1.1.1.cmml"><mn id="S4.T1.7.7.1.m1.1.1.2" xref="S4.T1.7.7.1.m1.1.1.2.cmml">0.5680</mn><mo id="S4.T1.7.7.1.m1.1.1.3" xref="S4.T1.7.7.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.1.m1.1b"><apply id="S4.T1.7.7.1.m1.1.1.cmml" xref="S4.T1.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.7.7.1.m1.1.1.1.cmml" xref="S4.T1.7.7.1.m1.1.1">superscript</csymbol><cn type="float" id="S4.T1.7.7.1.m1.1.1.2.cmml" xref="S4.T1.7.7.1.m1.1.1.2">0.5680</cn><times id="S4.T1.7.7.1.m1.1.1.3.cmml" xref="S4.T1.7.7.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.1.m1.1c">0.5680^{*}</annotation></semantics></math></td>
<td id="S4.T1.7.7.5" class="ltx_td ltx_align_center">1.1766</td>
<td id="S4.T1.7.7.6" class="ltx_td ltx_align_center">0.1204</td>
<td id="S4.T1.7.7.7" class="ltx_td ltx_align_center">0.1275</td>
</tr>
<tr id="S4.T1.8.8" class="ltx_tr">
<td id="S4.T1.8.8.2" class="ltx_td ltx_align_center">Betop</td>
<td id="S4.T1.8.8.3" class="ltx_td ltx_align_center">0.4698</td>
<td id="S4.T1.8.8.1" class="ltx_td ltx_align_center"><math id="S4.T1.8.8.1.m1.1" class="ltx_Math" alttext="0.4587^{*}" display="inline"><semantics id="S4.T1.8.8.1.m1.1a"><msup id="S4.T1.8.8.1.m1.1.1" xref="S4.T1.8.8.1.m1.1.1.cmml"><mn id="S4.T1.8.8.1.m1.1.1.2" xref="S4.T1.8.8.1.m1.1.1.2.cmml">0.4587</mn><mo id="S4.T1.8.8.1.m1.1.1.3" xref="S4.T1.8.8.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.1.m1.1b"><apply id="S4.T1.8.8.1.m1.1.1.cmml" xref="S4.T1.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.8.8.1.m1.1.1.1.cmml" xref="S4.T1.8.8.1.m1.1.1">superscript</csymbol><cn type="float" id="S4.T1.8.8.1.m1.1.1.2.cmml" xref="S4.T1.8.8.1.m1.1.1.2">0.4587</cn><times id="S4.T1.8.8.1.m1.1.1.3.cmml" xref="S4.T1.8.8.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.1.m1.1c">0.4587^{*}</annotation></semantics></math></td>
<td id="S4.T1.8.8.4" class="ltx_td ltx_align_center">0.5716</td>
<td id="S4.T1.8.8.5" class="ltx_td ltx_align_center">1.1668</td>
<td id="S4.T1.8.8.6" class="ltx_td ltx_align_center">0.1183</td>
<td id="S4.T1.8.8.7" class="ltx_td ltx_align_center">0.1272</td>
</tr>
<tr id="S4.T1.11.13" class="ltx_tr">
<td id="S4.T1.11.13.1" class="ltx_td ltx_align_center">BehaveOcc</td>
<td id="S4.T1.11.13.2" class="ltx_td ltx_align_center">0.4678</td>
<td id="S4.T1.11.13.3" class="ltx_td ltx_align_center">0.4566</td>
<td id="S4.T1.11.13.4" class="ltx_td ltx_align_center">0.5723</td>
<td id="S4.T1.11.13.5" class="ltx_td ltx_align_center">1.1668</td>
<td id="S4.T1.11.13.6" class="ltx_td ltx_align_center">0.1176</td>
<td id="S4.T1.11.13.7" class="ltx_td ltx_align_center">0.1278</td>
</tr>
<tr id="S4.T1.11.14" class="ltx_tr">
<td id="S4.T1.11.14.1" class="ltx_td ltx_align_center">QMTR</td>
<td id="S4.T1.11.14.2" class="ltx_td ltx_align_center">0.4649</td>
<td id="S4.T1.11.14.3" class="ltx_td ltx_align_center">0.4445</td>
<td id="S4.T1.11.14.4" class="ltx_td ltx_align_center">0.5702</td>
<td id="S4.T1.11.14.5" class="ltx_td ltx_align_center">1.1627</td>
<td id="S4.T1.11.14.6" class="ltx_td ltx_align_center">0.1177</td>
<td id="S4.T1.11.14.7" class="ltx_td ltx_align_center">0.1269</td>
</tr>
<tr id="S4.T1.9.9" class="ltx_tr">
<td id="S4.T1.9.9.2" class="ltx_td ltx_align_center">EDA<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>
</td>
<td id="S4.T1.9.9.3" class="ltx_td ltx_align_center">0.4596</td>
<td id="S4.T1.9.9.4" class="ltx_td ltx_align_center">0.4487</td>
<td id="S4.T1.9.9.5" class="ltx_td ltx_align_center">0.5718</td>
<td id="S4.T1.9.9.6" class="ltx_td ltx_align_center">1.1702</td>
<td id="S4.T1.9.9.7" class="ltx_td ltx_align_center">0.1169</td>
<td id="S4.T1.9.9.1" class="ltx_td ltx_align_center"><math id="S4.T1.9.9.1.m1.1" class="ltx_Math" alttext="0.1266^{*}" display="inline"><semantics id="S4.T1.9.9.1.m1.1a"><msup id="S4.T1.9.9.1.m1.1.1" xref="S4.T1.9.9.1.m1.1.1.cmml"><mn id="S4.T1.9.9.1.m1.1.1.2" xref="S4.T1.9.9.1.m1.1.1.2.cmml">0.1266</mn><mo id="S4.T1.9.9.1.m1.1.1.3" xref="S4.T1.9.9.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.1.m1.1b"><apply id="S4.T1.9.9.1.m1.1.1.cmml" xref="S4.T1.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.9.9.1.m1.1.1.1.cmml" xref="S4.T1.9.9.1.m1.1.1">superscript</csymbol><cn type="float" id="S4.T1.9.9.1.m1.1.1.2.cmml" xref="S4.T1.9.9.1.m1.1.1.2">0.1266</cn><times id="S4.T1.9.9.1.m1.1.1.3.cmml" xref="S4.T1.9.9.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.1.m1.1c">0.1266^{*}</annotation></semantics></math></td>
</tr>
<tr id="S4.T1.11.15" class="ltx_tr">
<td id="S4.T1.11.15.1" class="ltx_td ltx_align_center">ControlMTR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>
</td>
<td id="S4.T1.11.15.2" class="ltx_td ltx_align_center">0.4572</td>
<td id="S4.T1.11.15.3" class="ltx_td ltx_align_center">0.4414</td>
<td id="S4.T1.11.15.4" class="ltx_td ltx_align_center">0.5897</td>
<td id="S4.T1.11.15.5" class="ltx_td ltx_align_center">1.1916</td>
<td id="S4.T1.11.15.6" class="ltx_td ltx_align_center">0.1282</td>
<td id="S4.T1.11.15.7" class="ltx_td ltx_align_center"><span id="S4.T1.11.15.7.1" class="ltx_text ltx_font_bold">0.1259</span></td>
</tr>
<tr id="S4.T1.11.16" class="ltx_tr">
<td id="S4.T1.11.16.1" class="ltx_td ltx_align_center">LLM-Augmented-MTR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>
</td>
<td id="S4.T1.11.16.2" class="ltx_td ltx_align_center">0.4423</td>
<td id="S4.T1.11.16.3" class="ltx_td ltx_align_center">0.4270</td>
<td id="S4.T1.11.16.4" class="ltx_td ltx_align_center">0.5987</td>
<td id="S4.T1.11.16.5" class="ltx_td ltx_align_center">1.2084</td>
<td id="S4.T1.11.16.6" class="ltx_td ltx_align_center">0.1316</td>
<td id="S4.T1.11.16.7" class="ltx_td ltx_align_center">0.1274</td>
</tr>
<tr id="S4.T1.11.17" class="ltx_tr">
<td id="S4.T1.11.17.1" class="ltx_td ltx_align_center">MTR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</td>
<td id="S4.T1.11.17.2" class="ltx_td ltx_align_center">0.4403</td>
<td id="S4.T1.11.17.3" class="ltx_td ltx_align_center">0.4249</td>
<td id="S4.T1.11.17.4" class="ltx_td ltx_align_center">0.5964</td>
<td id="S4.T1.11.17.5" class="ltx_td ltx_align_center">1.2039</td>
<td id="S4.T1.11.17.6" class="ltx_td ltx_align_center">0.1312</td>
<td id="S4.T1.11.17.7" class="ltx_td ltx_align_center">0.1274</td>
</tr>
<tr id="S4.T1.10.10" class="ltx_tr">
<td id="S4.T1.10.10.2" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">RMP Ensemble</td>
<td id="S4.T1.10.10.3" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;"><span id="S4.T1.10.10.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.4737</span></td>
<td id="S4.T1.10.10.4" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">0.4531</td>
<td id="S4.T1.10.10.5" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">0.5564</td>
<td id="S4.T1.10.10.1" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;"><math id="S4.T1.10.10.1.m1.1" class="ltx_Math" alttext="1.1188^{*}" display="inline"><semantics id="S4.T1.10.10.1.m1.1a"><msup id="S4.T1.10.10.1.m1.1.1" xref="S4.T1.10.10.1.m1.1.1.cmml"><mn mathbackground="#E6E6E6" id="S4.T1.10.10.1.m1.1.1.2" xref="S4.T1.10.10.1.m1.1.1.2.cmml">1.1188</mn><mo mathbackground="#E6E6E6" id="S4.T1.10.10.1.m1.1.1.3" xref="S4.T1.10.10.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.1.m1.1b"><apply id="S4.T1.10.10.1.m1.1.1.cmml" xref="S4.T1.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.10.10.1.m1.1.1.1.cmml" xref="S4.T1.10.10.1.m1.1.1">superscript</csymbol><cn type="float" id="S4.T1.10.10.1.m1.1.1.2.cmml" xref="S4.T1.10.10.1.m1.1.1.2">1.1188</cn><times id="S4.T1.10.10.1.m1.1.1.3.cmml" xref="S4.T1.10.10.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.1.m1.1c">1.1188^{*}</annotation></semantics></math></td>
<td id="S4.T1.10.10.6" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;"><span id="S4.T1.10.10.6.1" class="ltx_text ltx_font_bold">0.1084</span></td>
<td id="S4.T1.10.10.7" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;"><span id="S4.T1.10.10.7.1" class="ltx_text ltx_font_bold">0.1259</span>
</td>
</tr>
<tr id="S4.T1.11.11" class="ltx_tr">
<td id="S4.T1.11.11.2" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">RMP</td>
<td id="S4.T1.11.11.3" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">0.4673</td>
<td id="S4.T1.11.11.4" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">0.4523</td>
<td id="S4.T1.11.11.5" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">0.5739</td>
<td id="S4.T1.11.11.6" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">1.1698</td>
<td id="S4.T1.11.11.1" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;"><math id="S4.T1.11.11.1.m1.1" class="ltx_Math" alttext="0.1159^{*}" display="inline"><semantics id="S4.T1.11.11.1.m1.1a"><msup id="S4.T1.11.11.1.m1.1.1" xref="S4.T1.11.11.1.m1.1.1.cmml"><mn mathbackground="#E6E6E6" id="S4.T1.11.11.1.m1.1.1.2" xref="S4.T1.11.11.1.m1.1.1.2.cmml">0.1159</mn><mo mathbackground="#E6E6E6" id="S4.T1.11.11.1.m1.1.1.3" xref="S4.T1.11.11.1.m1.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.1.m1.1b"><apply id="S4.T1.11.11.1.m1.1.1.cmml" xref="S4.T1.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.11.11.1.m1.1.1.1.cmml" xref="S4.T1.11.11.1.m1.1.1">superscript</csymbol><cn type="float" id="S4.T1.11.11.1.m1.1.1.2.cmml" xref="S4.T1.11.11.1.m1.1.1.2">0.1159</cn><times id="S4.T1.11.11.1.m1.1.1.3.cmml" xref="S4.T1.11.11.1.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.1.m1.1c">0.1159^{*}</annotation></semantics></math></td>
<td id="S4.T1.11.11.7" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">0.1266</td>
</tr>
<tr id="S4.T1.11.18" class="ltx_tr">
<td id="S4.T1.11.18.1" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">RMP e2e</td>
<td id="S4.T1.11.18.2" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">0.3828</td>
<td id="S4.T1.11.18.3" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">0.3440</td>
<td id="S4.T1.11.18.4" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;"><span id="S4.T1.11.18.4.1" class="ltx_text ltx_font_bold">0.5529</span></td>
<td id="S4.T1.11.18.5" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;"><span id="S4.T1.11.18.5.1" class="ltx_text ltx_font_bold">1.0932</span></td>
<td id="S4.T1.11.18.6" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">0.1354</td>
<td id="S4.T1.11.18.7" class="ltx_td ltx_align_center" style="background-color:#E6E6E6;">0.1295</td>
</tr>
<tr id="S4.T1.11.19" class="ltx_tr">
<td id="S4.T1.11.19.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="6"><span id="S4.T1.11.19.1.1" class="ltx_text">Previous Years</span></td>
<td id="S4.T1.11.19.2" class="ltx_td ltx_align_center ltx_border_t">DenseTNT<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>
</td>
<td id="S4.T1.11.19.3" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S4.T1.11.19.4" class="ltx_td ltx_align_center ltx_border_t">0.3281</td>
<td id="S4.T1.11.19.5" class="ltx_td ltx_align_center ltx_border_t">1.0387</td>
<td id="S4.T1.11.19.6" class="ltx_td ltx_align_center ltx_border_t">1.5514</td>
<td id="S4.T1.11.19.7" class="ltx_td ltx_align_center ltx_border_t">0.1573</td>
<td id="S4.T1.11.19.8" class="ltx_td ltx_align_center ltx_border_t">0.1779</td>
</tr>
<tr id="S4.T1.11.20" class="ltx_tr">
<td id="S4.T1.11.20.1" class="ltx_td ltx_align_center">SceneTransformer<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
</td>
<td id="S4.T1.11.20.2" class="ltx_td ltx_align_center">-</td>
<td id="S4.T1.11.20.3" class="ltx_td ltx_align_center">0.2788</td>
<td id="S4.T1.11.20.4" class="ltx_td ltx_align_center">0.6117</td>
<td id="S4.T1.11.20.5" class="ltx_td ltx_align_center">1.2116</td>
<td id="S4.T1.11.20.6" class="ltx_td ltx_align_center">0.1564</td>
<td id="S4.T1.11.20.7" class="ltx_td ltx_align_center">0.1473</td>
</tr>
<tr id="S4.T1.11.21" class="ltx_tr">
<td id="S4.T1.11.21.1" class="ltx_td ltx_align_center">ReCoAt<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>
</td>
<td id="S4.T1.11.21.2" class="ltx_td ltx_align_center">-</td>
<td id="S4.T1.11.21.3" class="ltx_td ltx_align_center">0.2711</td>
<td id="S4.T1.11.21.4" class="ltx_td ltx_align_center">0.7703</td>
<td id="S4.T1.11.21.5" class="ltx_td ltx_align_center">1.6668</td>
<td id="S4.T1.11.21.6" class="ltx_td ltx_align_center">0.2437</td>
<td id="S4.T1.11.21.7" class="ltx_td ltx_align_center">0.1642</td>
</tr>
<tr id="S4.T1.11.22" class="ltx_tr">
<td id="S4.T1.11.22.1" class="ltx_td ltx_align_center">HDGT<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>
</td>
<td id="S4.T1.11.22.2" class="ltx_td ltx_align_center">0.3709</td>
<td id="S4.T1.11.22.3" class="ltx_td ltx_align_center">0.3577</td>
<td id="S4.T1.11.22.4" class="ltx_td ltx_align_center">0.5933</td>
<td id="S4.T1.11.22.5" class="ltx_td ltx_align_center">1.2055</td>
<td id="S4.T1.11.22.6" class="ltx_td ltx_align_center">0.1511</td>
<td id="S4.T1.11.22.7" class="ltx_td ltx_align_center">0.1557</td>
</tr>
<tr id="S4.T1.11.23" class="ltx_tr">
<td id="S4.T1.11.23.1" class="ltx_td ltx_align_center">MoST<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>
</td>
<td id="S4.T1.11.23.2" class="ltx_td ltx_align_center">0.4396</td>
<td id="S4.T1.11.23.3" class="ltx_td ltx_align_center">0.4201</td>
<td id="S4.T1.11.23.4" class="ltx_td ltx_align_center">0.5391</td>
<td id="S4.T1.11.23.5" class="ltx_td ltx_align_center">1.1099</td>
<td id="S4.T1.11.23.6" class="ltx_td ltx_align_center">0.1172</td>
<td id="S4.T1.11.23.7" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S4.T1.11.24" class="ltx_tr">
<td id="S4.T1.11.24.1" class="ltx_td ltx_align_center">MTR++<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>
</td>
<td id="S4.T1.11.24.2" class="ltx_td ltx_align_center">0.4410</td>
<td id="S4.T1.11.24.3" class="ltx_td ltx_align_center">0.4329</td>
<td id="S4.T1.11.24.4" class="ltx_td ltx_align_center">0.5906</td>
<td id="S4.T1.11.24.5" class="ltx_td ltx_align_center">1.1939</td>
<td id="S4.T1.11.24.6" class="ltx_td ltx_align_center">0.1298</td>
<td id="S4.T1.11.24.7" class="ltx_td ltx_align_center">0.1281</td>
</tr>
<tr id="S4.T1.11.25" class="ltx_tr">
<td id="S4.T1.11.25.1" class="ltx_td ltx_border_b"></td>
<td id="S4.T1.11.25.2" class="ltx_td ltx_align_center ltx_border_b">MGTR<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>
</td>
<td id="S4.T1.11.25.3" class="ltx_td ltx_align_center ltx_border_b">0.4599</td>
<td id="S4.T1.11.25.4" class="ltx_td ltx_align_center ltx_border_b">0.4505</td>
<td id="S4.T1.11.25.5" class="ltx_td ltx_align_center ltx_border_b">0.5918</td>
<td id="S4.T1.11.25.6" class="ltx_td ltx_align_center ltx_border_b">1.2135</td>
<td id="S4.T1.11.25.7" class="ltx_td ltx_align_center ltx_border_b">0.1298</td>
<td id="S4.T1.11.25.8" class="ltx_td ltx_align_center ltx_border_b">0.1275</td>
</tr>
</table>
</figure>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2409.11696/assets/x4.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="438" height="317" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Visualization result of our proposed recovery module and prediction results under different observation ratios.</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.5.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.6.2" class="ltx_text ltx_font_italic">Experimental Setup</span>
</h3>

<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS1.5.1.1" class="ltx_text">IV-A</span>1 </span>Dataset and Metrics</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p">Our RMP-YOLO model is trained using the Waymo Open Motion Dataset (WOMD), which consists of 486,995 scenes for training and 44,097 scenes for validation. Additionally, we evaluate our proposed recovery module on other state-of-the-art (SOTA) prediction methods based on the Argoverse 1&amp;2 datasets. For WOMD, we use Soft mAP as our key evaluation metric, while for Argoverse 1&amp;2, we select Brier-FDE<sub id="S4.SS1.SSS1.p1.1.1" class="ltx_sub"><span id="S4.SS1.SSS1.p1.1.1.1" class="ltx_text ltx_font_italic">k</span></sub> as the main metric. Additional metrics such as minADE, minFDE, Miss Rate, and Overlap Rate are also used to provide supplementary evaluation of the models.</p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS1.SSS2.5.1.1" class="ltx_text">IV-A</span>2 </span>Training Details</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p">We use the AdamW optimizer to train our model in an end-to-end manner, with an initial learning rate set to 1.0e-4. Beginning at epoch 20, the learning rate is halved every two epochs. We train the model for 30 epochs and then fine-tune it for an additional 10 epochs, maintaining a learning rate of 6.25e-6. We train our models on 4 Nvidia-A6000 GPUS with total 48 batch size. We randomly mask 70% input data and our proposed recovery module is supervised to reconstruct the complete input data.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.5.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.6.2" class="ltx_text ltx_font_italic">Leaderboard Performance</span>
</h3>

<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Ablation Study on the Scene Tokenization and Recovery Modules.</figcaption>
<div id="S4.T2.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:390.3pt;height:67pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-138.2pt,23.5pt) scale(0.585333383103284,0.585333383103284) ;">
<table id="S4.T2.6.6" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.6.6.6" class="ltx_tr" style="background-color:#DCDCDC;">
<td id="S4.T2.6.6.6.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.6.6.6.7.1" class="ltx_text" style="background-color:#DCDCDC;">Baseline(MTR)</span></td>
<td id="S4.T2.6.6.6.8" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#DCDCDC;">
<table id="S4.T2.6.6.6.8.1" class="ltx_tabular ltx_align_middle" style="background-color:#DCDCDC;">
<tr id="S4.T2.6.6.6.8.1.1" class="ltx_tr">
<td id="S4.T2.6.6.6.8.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.6.6.6.8.1.1.1.1" class="ltx_text">w/ Scene</span></td>
</tr>
<tr id="S4.T2.6.6.6.8.1.2" class="ltx_tr">
<td id="S4.T2.6.6.6.8.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.6.6.6.8.1.2.1.1" class="ltx_text">Tokenization</span></td>
</tr>
</table>
</td>
<td id="S4.T2.6.6.6.9" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#DCDCDC;">
<table id="S4.T2.6.6.6.9.1" class="ltx_tabular ltx_align_middle" style="background-color:#DCDCDC;">
<tr id="S4.T2.6.6.6.9.1.1" class="ltx_tr">
<td id="S4.T2.6.6.6.9.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.6.6.6.9.1.1.1.1" class="ltx_text">w/ Recovery</span></td>
</tr>
<tr id="S4.T2.6.6.6.9.1.2" class="ltx_tr">
<td id="S4.T2.6.6.6.9.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.6.6.6.9.1.2.1.1" class="ltx_text">(RM 70%)</span></td>
</tr>
</table>
</td>
<td id="S4.T2.6.6.6.10" class="ltx_td ltx_align_center ltx_border_tt" style="background-color:#DCDCDC;">
<table id="S4.T2.6.6.6.10.1" class="ltx_tabular ltx_align_middle" style="background-color:#DCDCDC;">
<tr id="S4.T2.6.6.6.10.1.1" class="ltx_tr">
<td id="S4.T2.6.6.6.10.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.6.6.6.10.1.1.1.1" class="ltx_text">w/ Recovery</span></td>
</tr>
<tr id="S4.T2.6.6.6.10.1.2" class="ltx_tr">
<td id="S4.T2.6.6.6.10.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S4.T2.6.6.6.10.1.2.1.1" class="ltx_text">(no RM)</span></td>
</tr>
</table>
</td>
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.1.1.1.1.1" class="ltx_text" style="background-color:#DCDCDC;">Soft mAP <math id="S4.T2.1.1.1.1.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\uparrow" display="inline"><semantics id="S4.T2.1.1.1.1.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T2.1.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.2.2.2.2.1" class="ltx_text" style="background-color:#DCDCDC;">mAP <math id="S4.T2.2.2.2.2.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\uparrow" display="inline"><semantics id="S4.T2.2.2.2.2.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T2.2.2.2.2.1.m1.1.1" xref="S4.T2.2.2.2.2.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.1.m1.1b"><ci id="S4.T2.2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.2.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.1.m1.1c">\uparrow</annotation></semantics></math></span></td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.3.3.3.3.1" class="ltx_text" style="background-color:#DCDCDC;">minADE <math id="S4.T2.3.3.3.3.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\downarrow" display="inline"><semantics id="S4.T2.3.3.3.3.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T2.3.3.3.3.1.m1.1.1" xref="S4.T2.3.3.3.3.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.1.m1.1b"><ci id="S4.T2.3.3.3.3.1.m1.1.1.cmml" xref="S4.T2.3.3.3.3.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.4.4.4.4.1" class="ltx_text" style="background-color:#DCDCDC;">minFDE <math id="S4.T2.4.4.4.4.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\downarrow" display="inline"><semantics id="S4.T2.4.4.4.4.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T2.4.4.4.4.1.m1.1.1" xref="S4.T2.4.4.4.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.1.m1.1b"><ci id="S4.T2.4.4.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.4.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S4.T2.5.5.5.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.5.5.5.5.1" class="ltx_text" style="background-color:#DCDCDC;">Miss Rate <math id="S4.T2.5.5.5.5.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\downarrow" display="inline"><semantics id="S4.T2.5.5.5.5.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T2.5.5.5.5.1.m1.1.1" xref="S4.T2.5.5.5.5.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.5.1.m1.1b"><ci id="S4.T2.5.5.5.5.1.m1.1.1.cmml" xref="S4.T2.5.5.5.5.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.5.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
<td id="S4.T2.6.6.6.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.T2.6.6.6.6.1" class="ltx_text" style="background-color:#DCDCDC;">Overlap Rate <math id="S4.T2.6.6.6.6.1.m1.1" class="ltx_Math" style="background-color:#DCDCDC;" alttext="\downarrow" display="inline"><semantics id="S4.T2.6.6.6.6.1.m1.1a"><mo mathbackground="#DCDCDC" stretchy="false" id="S4.T2.6.6.6.6.1.m1.1.1" xref="S4.T2.6.6.6.6.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.6.1.m1.1b"><ci id="S4.T2.6.6.6.6.1.m1.1.1.cmml" xref="S4.T2.6.6.6.6.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.6.1.m1.1c">\downarrow</annotation></semantics></math></span></td>
</tr>
<tr id="S4.T2.6.6.7" class="ltx_tr">
<td id="S4.T2.6.6.7.1" class="ltx_td ltx_align_center ltx_border_t">✓</td>
<td id="S4.T2.6.6.7.2" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.6.6.7.3" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.6.6.7.4" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.6.6.7.5" class="ltx_td ltx_align_center ltx_border_t">0.3616</td>
<td id="S4.T2.6.6.7.6" class="ltx_td ltx_align_center ltx_border_t">0.3494</td>
<td id="S4.T2.6.6.7.7" class="ltx_td ltx_align_center ltx_border_t">0.6737</td>
<td id="S4.T2.6.6.7.8" class="ltx_td ltx_align_center ltx_border_t">1.3725</td>
<td id="S4.T2.6.6.7.9" class="ltx_td ltx_align_center ltx_border_t">0.1654</td>
<td id="S4.T2.6.6.7.10" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.6.6.7.10.1" class="ltx_text ltx_font_bold">0.1341</span></td>
</tr>
<tr id="S4.T2.6.6.8" class="ltx_tr">
<td id="S4.T2.6.6.8.1" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.6.6.8.2" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.6.6.8.3" class="ltx_td"></td>
<td id="S4.T2.6.6.8.4" class="ltx_td"></td>
<td id="S4.T2.6.6.8.5" class="ltx_td ltx_align_center">0.4033</td>
<td id="S4.T2.6.6.8.6" class="ltx_td ltx_align_center">0.3889</td>
<td id="S4.T2.6.6.8.7" class="ltx_td ltx_align_center"><span id="S4.T2.6.6.8.7.1" class="ltx_text ltx_font_bold">0.6310</span></td>
<td id="S4.T2.6.6.8.8" class="ltx_td ltx_align_center"><span id="S4.T2.6.6.8.8.1" class="ltx_text ltx_font_bold">1.3104</span></td>
<td id="S4.T2.6.6.8.9" class="ltx_td ltx_align_center">0.1468</td>
<td id="S4.T2.6.6.8.10" class="ltx_td ltx_align_center">0.1346</td>
</tr>
<tr id="S4.T2.6.6.9" class="ltx_tr">
<td id="S4.T2.6.6.9.1" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.6.6.9.2" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.6.6.9.3" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.6.6.9.4" class="ltx_td"></td>
<td id="S4.T2.6.6.9.5" class="ltx_td ltx_align_center">0.3992</td>
<td id="S4.T2.6.6.9.6" class="ltx_td ltx_align_center">0.3841</td>
<td id="S4.T2.6.6.9.7" class="ltx_td ltx_align_center">0.6357</td>
<td id="S4.T2.6.6.9.8" class="ltx_td ltx_align_center">1.3179</td>
<td id="S4.T2.6.6.9.9" class="ltx_td ltx_align_center"><span id="S4.T2.6.6.9.9.1" class="ltx_text ltx_font_bold">0.1450</span></td>
<td id="S4.T2.6.6.9.10" class="ltx_td ltx_align_center">0.1367</td>
</tr>
<tr id="S4.T2.6.6.10" class="ltx_tr">
<td id="S4.T2.6.6.10.1" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S4.T2.6.6.10.2" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S4.T2.6.6.10.3" class="ltx_td ltx_border_bb"></td>
<td id="S4.T2.6.6.10.4" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S4.T2.6.6.10.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.6.6.10.5.1" class="ltx_text ltx_font_bold">0.4046</span></td>
<td id="S4.T2.6.6.10.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.6.6.10.6.1" class="ltx_text ltx_font_bold">0.3903</span></td>
<td id="S4.T2.6.6.10.7" class="ltx_td ltx_align_center ltx_border_bb">0.6340</td>
<td id="S4.T2.6.6.10.8" class="ltx_td ltx_align_center ltx_border_bb">1.3203</td>
<td id="S4.T2.6.6.10.9" class="ltx_td ltx_align_center ltx_border_bb">0.1478</td>
<td id="S4.T2.6.6.10.10" class="ltx_td ltx_align_center ltx_border_bb">0.1359</td>
</tr>
</table>
</span></div>
</figure>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S4.SS2.SSS1.5.1.1" class="ltx_text">IV-B</span>1 </span>Leaderboard</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p">As shown in TABLE <a href="#S4.T1" title="TABLE I ‣ IV Experiments ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, our method, RMP, achieves competitive results, with our ensemble version securing second place in Soft mAP (0.4737) and achieving the best miss rate (0.1084) and overlap rate (0.1259). The top-performing model in terms of Soft mAP is MTR v3, with a score of 0.4967. Additionally, MTR v3 also leads in minADE (0.5554) and minFDE (1.1062), while our method’s variant RMP_e2e achieves the lowest minADE (0.5529) and minFDE (1.0932). RMP_e2e is trained in an end-to-end fashion to directly generate 6 futures without using Non-Maximum Suppression. These results demonstrate the SOTA performance of our RMP approach across various evaluation metrics. The real-world deployment video can be viewed in the submission file.</p>
</div>
<figure id="S4.F7" class="ltx_figure"><img src="/html/2409.11696/assets/x5.png" id="S4.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="221" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Performance of various methods using deficient historical trajectory data.</figcaption>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.5.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.6.2" class="ltx_text ltx_font_italic">Robustness</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Unlike other models(see Fig.<a href="#S4.F7" title="Figure 7 ‣ IV-B1 Leaderboard ‣ IV-B Leaderboard Performance ‣ IV Experiments ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>), which exhibit a significant degradation in accuracy as the missing observation ratios increase, our approach proves to be more robust and reliable, particularly in challenging scenarios with higher levels of data loss.
The inclusion of the recovery module demonstrates a clear improvement in performance compared to models like SIMPL and HIVT that lack this feature. When the recovery method is applied, these models consistently achieve lower brier-minFDE and minADE values, even as the percentage of missing observations increases (see Fig. <a href="#S4.F8" title="Figure 8 ‣ IV-C Robustness ‣ IV Experiments ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>). We also performed the same study using MTR as the baseline model on the Waymo motion dataset, evaluating the SoftmAP and minADE metrics (see Fig. <a href="#S4.F9" title="Figure 9 ‣ IV-C Robustness ‣ IV Experiments ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>). This indicates that our approach effectively handles data loss, resulting in more reliable and stable predictions even in highly uncertain environments. Please check out our submission video (due to page limitation) for qualitative results demonstrating the robustness of our method against noisy input.</p>
</div>
<figure id="S4.F8" class="ltx_figure"><img src="/html/2409.11696/assets/x6.png" id="S4.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="139" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Performance of model using deficient historical trajectory data (Argoverse 1 &amp; 2).</figcaption>
</figure>
<figure id="S4.F9" class="ltx_figure"><img src="/html/2409.11696/assets/x7.png" id="S4.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="138" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Performance of model using deficient historical trajectory data (Waymo).</figcaption>
</figure>
<figure id="S4.F10" class="ltx_figure"><img src="/html/2409.11696/assets/x8.png" id="S4.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="140" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Study on the effect of training with different masking ratios on the inference performance and robustness.</figcaption>
</figure>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS4.5.1.1" class="ltx_text">IV-D</span> </span><span id="S4.SS4.6.2" class="ltx_text ltx_font_italic">Ablation Study</span>
</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p">To explore the impact of different mask ratios on model performance, we conducted an ablation study, as shown in Fig.<a href="#S4.F10" title="Figure 10 ‣ IV-C Robustness ‣ IV Experiments ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>. Based on the results, we selected a mask ratio of 0.7 to achieve the best balance between robustness and prediction accuracy. In order to quantitatively assess the impact of our proposed scene tokenization and recovery modules, we conducted a series of ablation studies(on 20% training dataset, 100%validtion dataset) and summarized the results in TABLE <a href="#S4.T2" title="TABLE II ‣ IV-B Leaderboard Performance ‣ IV Experiments ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. The comparison with the baseline shows significant improvements in the model’s Soft mAP performance, indicating the effectiveness of the proposed modules.</p>
</div>
</section>
<section id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS5.5.1.1" class="ltx_text">IV-E</span> </span><span id="S4.SS5.6.2" class="ltx_text ltx_font_italic">Inference Efficiency</span>
</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p id="S4.SS5.p1.1" class="ltx_p">We integrated our recovery module into established methods to assess its effect on the model’s inference efficiency. The results are documented in TABLE <a href="#S4.T3" title="TABLE III ‣ IV-E Inference Efficiency ‣ IV Experiments ‣ RMP-YOLO: A Robust Motion Predictor for Partially Observable Scenarios even if You Only Look Once" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>. By comparing the number of parameters and the model’s runtime before and after adding our recovery module, we can conclude that our proposed recovery module is highly lightweight and minimally impacts the model’s efficiency.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Inference Efficiency of the Recovery Module</figcaption>
<div id="S4.T3.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:429.3pt;height:96.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(14.6pt,-3.3pt) scale(1.07306477057054,1.07306477057054) ;">
<table id="S4.T3.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T3.1.1.1" class="ltx_tr">
<td id="S4.T3.1.1.1.1" class="ltx_td ltx_border_tt"></td>
<td id="S4.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S4.T3.1.1.1.2.1" class="ltx_text" style="background-color:#DCDCDC;">Baseline</span></td>
<td id="S4.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S4.T3.1.1.1.3.1" class="ltx_text" style="background-color:#DCDCDC;">w/ Recovery Module</span></td>
</tr>
<tr id="S4.T3.1.1.2" class="ltx_tr" style="background-color:#DCDCDC;">
<td id="S4.T3.1.1.2.1" class="ltx_td ltx_align_center" style="background-color:#DCDCDC;"><span id="S4.T3.1.1.2.1.1" class="ltx_text" style="background-color:#DCDCDC;">Method</span></td>
<td id="S4.T3.1.1.2.2" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.2.2.1" class="ltx_text" style="background-color:#DCDCDC;">Parameters (M)</span></td>
<td id="S4.T3.1.1.2.3" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.2.3.1" class="ltx_text" style="background-color:#DCDCDC;">Run Time (ms)</span></td>
<td id="S4.T3.1.1.2.4" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.2.4.1" class="ltx_text" style="background-color:#DCDCDC;">Parameters (M)</span></td>
<td id="S4.T3.1.1.2.5" class="ltx_td ltx_align_center"><span id="S4.T3.1.1.2.5.1" class="ltx_text" style="background-color:#DCDCDC;">Run Time (ms)</span></td>
</tr>
<tr id="S4.T3.1.1.3" class="ltx_tr">
<td id="S4.T3.1.1.3.1" class="ltx_td ltx_align_center ltx_border_t">SIMPL (AV2)</td>
<td id="S4.T3.1.1.3.2" class="ltx_td ltx_align_center ltx_border_t">2.65</td>
<td id="S4.T3.1.1.3.3" class="ltx_td ltx_align_center ltx_border_t">48.75</td>
<td id="S4.T3.1.1.3.4" class="ltx_td ltx_align_center ltx_border_t">2.84</td>
<td id="S4.T3.1.1.3.5" class="ltx_td ltx_align_center ltx_border_t">61.88</td>
</tr>
<tr id="S4.T3.1.1.4" class="ltx_tr">
<td id="S4.T3.1.1.4.1" class="ltx_td ltx_align_center">MTR</td>
<td id="S4.T3.1.1.4.2" class="ltx_td ltx_align_center">65.78</td>
<td id="S4.T3.1.1.4.3" class="ltx_td ltx_align_center">80.20</td>
<td id="S4.T3.1.1.4.4" class="ltx_td ltx_align_center">66.55</td>
<td id="S4.T3.1.1.4.5" class="ltx_td ltx_align_center">81.10</td>
</tr>
<tr id="S4.T3.1.1.5" class="ltx_tr">
<td id="S4.T3.1.1.5.1" class="ltx_td ltx_align_center ltx_border_bb">Ours</td>
<td id="S4.T3.1.1.5.2" class="ltx_td ltx_align_center ltx_border_bb">68.68</td>
<td id="S4.T3.1.1.5.3" class="ltx_td ltx_align_center ltx_border_bb">100.23</td>
<td id="S4.T3.1.1.5.4" class="ltx_td ltx_align_center ltx_border_bb">69.45</td>
<td id="S4.T3.1.1.5.5" class="ltx_td ltx_align_center ltx_border_bb">100.89</td>
</tr>
</table>
</span></div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">CONCLUSIONS</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We introduced RMP-YOLO, a motion prediction framework designed to effectively manage incomplete historical trajectory inputs. The framework prioritizes reconstructing full past trajectories by leveraging local map topology and agent interactions. Extensive experiments demonstrate our model’s competitive prediction performance and robustness against incomplete input trajectories. In the future, we plan to upgrade our framework to a query-centric paradigm to further enhance inference speed.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
S. Ettinger, S. Cheng, B. Caine, C. Liu, H. Zhao, S. Pradhan, Y. Chai, B. Sapp, C. Qi, Y. Zhou, Z. Yang, A. Chouard, P. Sun, J. Ngiam, V. Vasudevan, A. McCauley, J. Shlens, and D. Anguelov, “Large scale interactive motion forecasting for autonomous driving : The waymo open motion dataset,” 2021. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2104.10133" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2104.10133</a>

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Waymo, “Waymo open dataset: Motion prediction challenge,” accessed: 2024-08-31. [Online]. Available: <a target="_blank" href="https://waymo.com/open/challenges" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://waymo.com/open/challenges</a>

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
M.-F. Chang, J. Lambert, P. Sangkloy, J. Singh, S. Bak, A. Hartnett, D. Wang, P. Carr, S. Lucey, D. Ramanan, and J. Hays, “Argoverse: 3d tracking and forecasting with rich maps,” 2019.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Argoverse, “Argoverse motion forecasting competition,” accessed: 2024-08-31. [Online]. Available: <a target="_blank" href="https://eval.ai/web/challenges/challenge-page/454/overview" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://eval.ai/web/challenges/challenge-page/454/overview</a>

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
S. Ettinger, S. Cheng, B. Caine, C. Liu, H. Zhao, S. Pradhan, Y. Chai, B. Sapp, C. Qi, Y. Zhou, Z. Yang, A. Chouard, P. Sun, J. Ngiam, V. Vasudevan, A. McCauley, J. Shlens, and D. Anguelov, “Large scale interactive motion forecasting for autonomous driving : The waymo open motion dataset,” 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Argoverse, “Argoverse 2: Motion forecasting competition,” accessed: 2024-08-31. [Online]. Available: <a target="_blank" href="https://eval.ai/web/challenges/challenge-page/1719/overview" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://eval.ai/web/challenges/challenge-page/1719/overview</a>

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
S. Shi, L. Jiang, D. Dai, and B. Schiele, “Motion transformer with global intention localization and local movement refinement,” 2023.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Z. Zhou, J. Wang, Y.-H. Li, and Y.-K. Huang, “Query-centric trajectory prediction,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, June 2023, pp. 17 863–17 873.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
S. Shi, L. Jiang, D. Dai, and B. Schiele, “Mtr++: Multi-agent motion prediction with symmetric scene modeling and guided intention querying,” 2024.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Z. Lan, Y. Jiang, Y. Mu, C. Chen, and S. E. Li, “Sept: Towards efficient scene representation learning for motion prediction,” 2023. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2309.15289" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2309.15289</a>

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
C. Feng, H. Zhou, H. Lin, Z. Zhang, Z. Xu, C. Zhang, B. Zhou, and S. Shen, “Macformer: Map-agent coupled transformer for real-time and robust trajectory prediction,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">IEEE Robotics and Automation Letters</em>, vol. 8, no. 10, p. 6795–6802, Oct. 2023. [Online]. Available: <a target="_blank" href="http://dx.doi.org/10.1109/LRA.2023.3311351" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://dx.doi.org/10.1109/LRA.2023.3311351</a>

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
J. Gu, C. Sun, and H. Zhao, “Densetnt: End-to-end trajectory prediction from dense goal sets,” 2021. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2108.09640" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2108.09640</a>

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
H. Zhao, J. Gao, T. Lan, C. Sun, B. Sapp, B. Varadarajan, Y. Shen, Y. Shen, Y. Chai, C. Schmid, C. Li, and D. Anguelov, “Tnt: Target-driven trajectory prediction,” 2020. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2008.08294" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2008.08294</a>

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
L. Fang, Q. Jiang, J. Shi, and B. Zhou, “Tpnet: Trajectory proposal network for motion prediction,” 2021. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2004.12255" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2004.12255</a>

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. Wang, X. Zhu, C. Yu, W. Li, Y. Ma, R. Jin, X. Ren, D. Ren, M. Wang, and W. Yang, “Ganet: Goal area network for motion forecasting,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">2023 IEEE International Conference on Robotics and Automation (ICRA)</em>, 2023, pp. 1609–1615.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
L. Zhang, P. Li, S. Liu, and S. Shen, “Simpl: A simple and efficient multi-agent motion prediction baseline for autonomous driving,” 2024. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2402.02519" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2402.02519</a>

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
B. Varadarajan, A. Hefny, A. Srivastava, K. S. Refaat, N. Nayakanti, A. Cornman, K. Chen, B. Douillard, C. P. Lam, D. Anguelov, and B. Sapp, “Multipath++: Efficient information fusion and trajectory aggregation for behavior prediction,” 2021. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2111.14973" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2111.14973</a>

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
J. Ngiam, B. Caine, V. Vasudevan, Z. Zhang, H.-T. L. Chiang, J. Ling, R. Roelofs, A. Bewley, C. Liu, A. Venugopal, D. Weiss, B. Sapp, Z. Chen, and J. Shlens, “Scene transformer: A unified architecture for predicting multiple agent trajectories,” 2022. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2106.08417" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2106.08417</a>

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
X. Jia, P. Wu, L. Chen, Y. Liu, H. Li, and J. Yan, “Hdgt: Heterogeneous driving graph transformer for multi-agent trajectory prediction via scene encoding,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Pattern Analysis and Machine Intelligence</em>, vol. 45, no. 11, pp. 13 860–13 875, 2023.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Z. Zhou, L. Ye, J. Wang, K. Wu, and K. Lu, “Hivt: Hierarchical vector transformer for multi-agent motion prediction,” in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">2022 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2022, pp. 8813–8823.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
L. Lin, X. Lin, T. Lin, L. Huang, R. Xiong, and Y. Wang, “Eda: Evolving and distinct anchors for multimodal motion prediction,” 2023. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2312.09501" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2312.09501</a>

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
J. Sun, C. Yuan, S. Sun, S. Wang, Y. Han, S. Ma, Z. Huang, A. Wong, K. P. Tee, and M. H. A. Jr, “Controlmtr: Control-guided motion transformer with scene-compliant intention points for feasible motion prediction,” 2024.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Y. Gan, H. Xiao, Y. Zhao, E. Zhang, Z. Huang, X. Ye, and L. Ge, “Mgtr: Multi-granular transformer for motion prediction with lidar,” 2024. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2312.02409" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2312.02409</a>

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Z. Zhou, Z. Wen, J. Wang, Y.-H. Li, and Y.-K. Huang, “Qcnext: A next-generation framework for joint multi-agent trajectory prediction,” 2023. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2306.10508" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2306.10508</a>

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
X. Zheng, L. Wu, Z. Yan, Y. Tang, H. Zhao, C. Zhong, B. Chen, and J. Gong, “Large language models powered context-aware motion prediction in autonomous driving,” 2024. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2403.11057" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2403.11057</a>

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
X. Tang, M. Kan, S. Shan, Z. Ji, J. Bai, and X. Chen, “Hpnet: Dynamic trajectory forecasting with historical prediction attention,” 2024. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2404.06351" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2404.06351</a>

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
N. Mu, J. Ji, Z. Yang, N. Harada, H. Tang, K. Chen, C. R. Qi, R. Ge, K. Goel, Z. Yang, S. Ettinger, R. Al-Rfou, D. Anguelov, and Y. Zhou, “Most: Multi-modality scene tokenization for motion prediction,” 2024. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2404.19531" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2404.19531</a>

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Z. Zhang, A. Liniger, C. Sakaridis, F. Yu, and L. Van Gool, “Real-time motion prediction via heterogeneous polyline transformer with relative pose encoding,” in <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems (NeurIPS)</em>, 2023.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
S. Wang, Y. Chen, J. Cheng, X. Mei, R. Xin, Y. Song, and M. Liu, “Improving autonomous driving safety with pop: A framework for accurate partially observed trajectory predictions,” in <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">2024 IEEE International Conference on Robotics and Automation (ICRA)</em>.   IEEE, 2024, pp. 14 450–14 456.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Y. Yi, Z. Qingwen, G. Thomas, B. Nazre, and F. John, “Rmp: A random mask pretrain framework for motion prediction,” in <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">IEEE 26th International Conference on Intelligent Transportation Systems (ITSC)</em>, 2023, pp. 3717–3723.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Y. Xu, A. Bazarjani, H. gun Chi, C. Choi, and Y. Fu, “Uncovering the missing pattern: Unified framework towards trajectory imputation and prediction,” 2023. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2303.16005" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2303.16005</a>

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
A. Monti, A. Porrello, S. Calderara, P. Coscia, L. Ballan, and R. Cucchiara, “How many observations are enough? knowledge distillation for trajectory forecasting,” 2022. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2203.04781" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2203.04781</a>

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
M. Pourkeshavarz, M. Sabokrou, and A. Rasouli, “Adversarial backdoor attack by naturalistic data poisoning on trajectory prediction in autonomous driving,” 2023. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2306.15755" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2306.15755</a>

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Q. Zhang, S. Hu, J. Sun, Q. A. Chen, and Z. M. Mao, “On adversarial robustness of trajectory prediction for autonomous vehicles,” in <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">2022 IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)</em>, 2022, pp. 15 138–15 147.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
P. Bhattacharyya, C. Huang, and K. Czarnecki, “Ssl-lanes: Self-supervised learning for motion forecasting in autonomous driving,” 2022. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2206.14116" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2206.14116</a>

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
J. Cheng, X. Mei, and M. Liu, “Forecast-MAE: Self-supervised pre-training for motion forecasting with masked autoencoders,” <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2023.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
B. Varadarajan, A. Hefny, A. Srivastava, K. S. Refaat, N. Nayakanti, A. Cornman, K. Chen, B. Douillard, C. P. Lam, D. Anguelov, and B. Sapp, “Multipath++: Efficient information fusion and trajectory aggregation for behavior prediction,” 2021.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
L. Lin, X. Lin, T. Lin, L. Huang, R. Xiong, and Y. Wang, “Eda: Evolving and distinct anchors for multimodal motion prediction,” in <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial Intelligence</em>, vol. 38, no. 4, 2024, pp. 3432–3440.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
C. Shi, S. Shi, and L. Jiang, “Mtr v3: 1st place solution for 2024 waymo open dataset challenge - motion prediction,” The Chinese University of Hong Kong (Shenzhen) and DiDi Global, Technical Report, 2024. [Online]. Available: <a target="_blank" href="https://storage.googleapis.com/waymo-uploads/files/research/2024%20Technical%20Reports/2024%20WOD%20Motion%20Prediction%20Challenge%20-%201st%20Place%20-%20MTR%20v3.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://storage.googleapis.com/waymo-uploads/files/research/2024%20Technical%20Reports/2024%20WOD%20Motion%20Prediction%20Challenge%20-%201st%20Place%20-%20MTR%20v3.pdf</a>

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Z. Zhou, J. Wang, Y.-H. Li, and Y.-K. Huang, “Modeseq: Technical report for 2024 waymo open motion dataset challenge - motion prediction,” City University of Hong Kong, Hon Hai Research Institute, Carnegie Mellon University, Technical Report, 2024. [Online]. Available: <a target="_blank" href="https://storage.googleapis.com/waymo-uploads/files/research/2024%20Technical%20Reports/2024%20WOD%20Motion%20Prediction%20Challenge%20-%202nd%20Place%20-%20ModeSeq.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://storage.googleapis.com/waymo-uploads/files/research/2024%20Technical%20Reports/2024%20WOD%20Motion%20Prediction%20Challenge%20-%202nd%20Place%20-%20ModeSeq.pdf</a>

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
X. Zheng, L. Wu, Z. Yan, Y. Tang, H. Zhao, C. Zhong, B. Chen, and J. Gong, “Large language models powered context-aware motion prediction,” 2024.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Z. Huang, X. Mo, and C. Lv, “Recoat: A deep learning-based framework for multi-modal motion prediction in autonomous driving application,” 2022. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/2207.00726" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2207.00726</a>

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2409.11695" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2409.11696" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2409.11696">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2409.11696" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2409.11697" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Oct  5 22:13:56 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
