<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Instructions for EMNLP 2023 Proceedings</title>
<!--Generated on Sat Sep 28 16:17:00 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.19401v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S1" title="In Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S2" title="In Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S3" title="In Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Problem Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4" title="In Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS1" title="In 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Data Collection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS2" title="In 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Editable Memory Graphs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS3" title="In 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>MDP for Selecting Memories on EMGs</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS4" title="In 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Discussion on Applications and Cold-start</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5" title="In Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.SS1" title="In 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.SS2" title="In 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Experimental Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S6" title="In Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S7" title="In Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1" title="In Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.SS1" title="In Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Data Collection Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.SS2" title="In Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>Memory Types and Subclasses</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.SS3" title="In Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Further Discussion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.SS4" title="In Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.4 </span>Prompts for Data Collection</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Instructions for EMNLP 2023 Proceedings</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zheng Wang<sup class="ltx_sup" id="id1.1.id1">1</sup>, Zhongyang Li<sup class="ltx_sup" id="id2.2.id2">1</sup>, Zeren Jiang<sup class="ltx_sup" id="id3.3.id3">1</sup>, Dandan Tu<sup class="ltx_sup" id="id4.4.id4">1</sup>, Wei Shi<sup class="ltx_sup" id="id5.5.id5">1</sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id6.6.id6">1</sup>Huawei Technologies, Co., Ltd.
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id7.7.id7">{wangzheng155,lizhongyang6,jiangzeren2,tudandan,w.shi}@huawei.com</span>
</span></span>
</div>
<h1 class="ltx_title ltx_title_document">Crafting Personalized Agents through Retrieval-Augmented Generation on Editable Memory Graphs</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zheng Wang<sup class="ltx_sup" id="id1.1.id1">1</sup>, Zhongyang Li<sup class="ltx_sup" id="id2.2.id2">1</sup>, Zeren Jiang<sup class="ltx_sup" id="id3.3.id3">1</sup>, Dandan Tu<sup class="ltx_sup" id="id4.4.id4">1</sup>, Wei Shi<sup class="ltx_sup" id="id5.5.id5">1</sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id6.6.id6">1</sup>Huawei Technologies, Co., Ltd.
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id7.7.id7">{wangzheng155,lizhongyang6,jiangzeren2,tudandan,w.shi}@huawei.com</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id8.id1">In the age of mobile internet, user data, often referred to as memories, is continuously generated on personal devices. Effectively managing and utilizing this data to deliver services to users is a compelling research topic. In this paper, we introduce a novel task of crafting personalized agents powered by large language models (LLMs), which utilize a user’s smartphone memories to enhance downstream applications with advanced LLM capabilities. To achieve this goal, we introduce <span class="ltx_text ltx_font_typewriter" id="id8.id1.1">EMG-RAG</span>, a solution that combines Retrieval-Augmented Generation (RAG) techniques with an Editable Memory Graph (EMG). This approach is further optimized using Reinforcement Learning to address three distinct challenges: data collection, editability, and selectability. Extensive experiments on a real-world dataset validate the effectiveness of <span class="ltx_text ltx_font_typewriter" id="id8.id1.2">EMG-RAG</span>, achieving an improvement of approximately 10% over the best existing approach. Additionally, the personalized agents have been transferred into a real smartphone AI assistant, which leads to enhanced usability.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">In the era of mobile internet, personal information is constantly being generated on smartphones. This data, referred to as personal memories, is often scattered across everyday conversations with AI assistants (e.g., Apple’s Siri), or within a user’s apps (e.g., screenshots), including emails, calendars, location histories, travel activities, and more. As a result, managing and utilizing these personal memories to provide services for users becomes a challenging yet attractive task. With the emergence of advanced large language models (LLMs), new opportunities arise to leverage their semantic understanding and reasoning capabilities to develop personal LLM-driven AI assistants.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Motivated by this trend, we study the problem of crafting personalized agents that enhance the AI assistants with the capabilities of LLMs by leveraging users’ memories on smartphones. Unlike existing personal LLM agents <cite class="ltx_cite ltx_citemacro_cite">Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib14" title="">2024b</a>)</cite>, such as those designed for psychological counseling <cite class="ltx_cite ltx_citemacro_cite">Zhong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib47" title="">2024</a>)</cite>, housekeeping <cite class="ltx_cite ltx_citemacro_cite">Han et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib7" title="">2024</a>)</cite>, and medical assistance <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib43" title="">2023a</a>)</cite>, the personalized agents face unique challenges due to practical scenarios and remains relatively unexplored in current methods.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.5">These challenges can be summarized below.
<span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.5.1">(1) Data Collection</span>: Personal memories should encompass valuable information about a user. Extracting these memories from everyday trivial conversations presents unique challenges in data collection, especially considering that existing datasets like personalized chats sourced through crowdsourcing <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib45" title="">2018</a>)</cite> or psychological dialogues <cite class="ltx_cite ltx_citemacro_cite">Zhong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib47" title="">2024</a>)</cite> lack this property. Moreover, constructing annotated data, such as QA pairs, is essential for enabling effective training of personalized agents. <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.5.2">(2) Editability</span>: Personal memories are dynamic and continuously evolving, requiring three types of editable operations: insertion, deletion, and replacement. For example, 1) insertion occurs when new memories are added; 2) deletion is necessary for time-sensitive memories, such as a hotel voucher that expires and needs to be removed; 3) replacement is required when an existing memory, such as a flight booking, undergoes a change in departure time and needs updating. Therefore, a carefully designed memory data structure is essential to support this editability. <span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p3.5.3">(3) Selectability</span>: To enable the memory data services for real-world applications, it often requires querying a combination of multiple memories. For example, in a QA scenario (illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S3.T1" title="Table 1 ‣ 3 Problem Statement ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">1</span></a>), the AI assistant answering a question about “a secretary’s boss’s flight departure time” needs several memories: the secretary booked a flight to Amsterdam for her boss (<math alttext="M_{1}" class="ltx_Math" display="inline" id="S1.p3.1.m1.1"><semantics id="S1.p3.1.m1.1a"><msub id="S1.p3.1.m1.1.1" xref="S1.p3.1.m1.1.1.cmml"><mi id="S1.p3.1.m1.1.1.2" xref="S1.p3.1.m1.1.1.2.cmml">M</mi><mn id="S1.p3.1.m1.1.1.3" xref="S1.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.1.m1.1b"><apply id="S1.p3.1.m1.1.1.cmml" xref="S1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p3.1.m1.1.1.1.cmml" xref="S1.p3.1.m1.1.1">subscript</csymbol><ci id="S1.p3.1.m1.1.1.2.cmml" xref="S1.p3.1.m1.1.1.2">𝑀</ci><cn id="S1.p3.1.m1.1.1.3.cmml" type="integer" xref="S1.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.1.m1.1c">M_{1}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.1.m1.1d">italic_M start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>); the flight’s number is EK349 (<math alttext="M_{2}" class="ltx_Math" display="inline" id="S1.p3.2.m2.1"><semantics id="S1.p3.2.m2.1a"><msub id="S1.p3.2.m2.1.1" xref="S1.p3.2.m2.1.1.cmml"><mi id="S1.p3.2.m2.1.1.2" xref="S1.p3.2.m2.1.1.2.cmml">M</mi><mn id="S1.p3.2.m2.1.1.3" xref="S1.p3.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.2.m2.1b"><apply id="S1.p3.2.m2.1.1.cmml" xref="S1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S1.p3.2.m2.1.1.1.cmml" xref="S1.p3.2.m2.1.1">subscript</csymbol><ci id="S1.p3.2.m2.1.1.2.cmml" xref="S1.p3.2.m2.1.1.2">𝑀</ci><cn id="S1.p3.2.m2.1.1.3.cmml" type="integer" xref="S1.p3.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.2.m2.1c">M_{2}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.2.m2.1d">italic_M start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>); the departure time for EK349 is at 01:40 on 2024-05-12 (<math alttext="M_{4}" class="ltx_Math" display="inline" id="S1.p3.3.m3.1"><semantics id="S1.p3.3.m3.1a"><msub id="S1.p3.3.m3.1.1" xref="S1.p3.3.m3.1.1.cmml"><mi id="S1.p3.3.m3.1.1.2" xref="S1.p3.3.m3.1.1.2.cmml">M</mi><mn id="S1.p3.3.m3.1.1.3" xref="S1.p3.3.m3.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p3.3.m3.1b"><apply id="S1.p3.3.m3.1.1.cmml" xref="S1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S1.p3.3.m3.1.1.1.cmml" xref="S1.p3.3.m3.1.1">subscript</csymbol><ci id="S1.p3.3.m3.1.1.2.cmml" xref="S1.p3.3.m3.1.1.2">𝑀</ci><cn id="S1.p3.3.m3.1.1.3.cmml" type="integer" xref="S1.p3.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.3.m3.1c">M_{4}</annotation><annotation encoding="application/x-llamapun" id="S1.p3.3.m3.1d">italic_M start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>). To achieve this, one intuitive approach is to use Retrieval-Augmented Generation (RAG) <cite class="ltx_cite ltx_citemacro_cite">Lewis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib12" title="">2020</a>)</cite> to find relevant memories and form a context that is fed into a LLM to generate answers. Here, we discuss two potential solutions and their limitations, which motivate the proposed solution.
1) Needles in a Haystack (NiaH) <cite class="ltx_cite ltx_citemacro_cite">Briakou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib2" title="">2023</a>)</cite>: it organizes all memories into a single context (the “Haystack”) and inputs this into a LLM, relying on the capability of a LLM itself to identify relevant memories (the “Needles”) for generating an answer. However, this method incurs significant overhead by extending the LLM’s context window and introduces noise from irrelevant memories, hindering the LLM’s ability to generate accurate answers.
2) Advanced RAG <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib35" title="">2024</a>); Ma et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib17" title="">2023</a>)</cite>: many advanced RAG techniques still rely on Top-<math alttext="K" class="ltx_Math" display="inline" id="S1.p3.4.m4.1"><semantics id="S1.p3.4.m4.1a"><mi id="S1.p3.4.m4.1.1" xref="S1.p3.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.p3.4.m4.1b"><ci id="S1.p3.4.m4.1.1.cmml" xref="S1.p3.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.p3.4.m4.1d">italic_K</annotation></semantics></math> retrieval to identify relevant memories. However, a fixed parameter <math alttext="K" class="ltx_Math" display="inline" id="S1.p3.5.m5.1"><semantics id="S1.p3.5.m5.1a"><mi id="S1.p3.5.m5.1.1" xref="S1.p3.5.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.p3.5.m5.1b"><ci id="S1.p3.5.m5.1.1.cmml" xref="S1.p3.5.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p3.5.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.p3.5.m5.1d">italic_K</annotation></semantics></math> may limit the LLM’s ability to uncover all relevant memories, especially for the questions requiring diverse memory combinations. Thus, an adaptive selection mechanism is essential for the personalized applications.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To this end, we introduce a new solution called <span class="ltx_text ltx_font_typewriter" id="S1.p4.1.1">EMG-RAG</span>, which presents the first attempt of its kind to address these challenges. We discuss the solution along with the rationales behind it below.
<span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.2">For (1)</span>, we utilize a business dataset collected from a real AI assistant, which includes daily conversations with the assistant, and users’ app screenshots, to extract personal memories. Specifically, we leverage the capabilities of GPT-4 <cite class="ltx_cite ltx_citemacro_cite">OpenAI (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib23" title="">2023</a>)</cite> to clean the raw data into memories. We organize the memories chronologically, and then use GPT-4 to generate QA pairs within each session (a set of consecutive memories). We also tag the memories involved in generating these QA pairs, which are then used for subsequent training purposes.
<span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.3">For (2)</span>, we introduce a three-layer data structure, called Editable Memory Graph (EMG). The first two layers form a tree structure in accordance with the business scopes, while the third layer consists of a user’s memory graph parsed from the memory data. This design is motivated by three considerations: 1) the tree structure allows for partitioned management of various memory categories, facilitating expansion to other categories; and 2) memory data is partitioned under different categories, with the graph structure to capture their complex relationships, and 3) this enables efficient retrieval to locate specific memories for editing, by searching within relevant partitions rather than the entire dataset.
<span class="ltx_text ltx_framed ltx_framed_underline" id="S1.p4.1.4">For (3)</span>, we introduce a reinforcement learning (RL) agent that adaptively selects memories on the EMG, without being constrained to a fixed Top-<math alttext="K" class="ltx_Math" display="inline" id="S1.p4.1.m1.1"><semantics id="S1.p4.1.m1.1a"><mi id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><ci id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S1.p4.1.m1.1d">italic_K</annotation></semantics></math> approach. The rationale of using RL resembles a boosting process. Specifically, when the agent selects relevant memories (actions), it prompts a LLM (frozen) to generate improved answers. The quality of these answers is evaluated by a downstream task metric (reward), which then guides the agent to refine its policy for better memory selection. This results in an end-to-end optimization process aimed at achieving the desired goal for downstream tasks.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Overall, we make the following contributions.
(1) We introduce a novel task of crafting LLM-driven personalized agents, leveraging users’ personal memories to enhance their experience through LLM capabilities. This task differs from existing personal LLM agents in three key challenges: data collection, editability, and selectability.
(2) We propose <span class="ltx_text ltx_font_typewriter" id="S1.p5.1.1">EMG-RAG</span>, a novel solution that combines EMG and RAG to address the three challenges. We show that it enables an end-to-end optimization process through reinforcement learning to achieve the goal of personalized agents.
(3) We conduct extensive experiments on a real-world business dataset across various LLM architectures and RAG methods for three downstream applications: question answering, autofill forms, and user services. Our approach demonstrates improvements of approximately 10.6%, 9.5%, and 9.7% over the best existing approach for these tasks, respectively. Moreover, the personalized agents have been transferred into an AI assistant product, resulting in a notable improvement in user experience.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Personalized Dialogue System.</span> To develop a personalized dialogue system (PDS), the PersonaChat dataset <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib45" title="">2018</a>)</cite> is collected through crowdsourcing, which comprises Personas (each persona is defined by a set of profile sentences) and Chats (each chat is collected by two crowdworkers with two randomly assigned personas). Based on the dataset, various techniques have been studied to address challenges in PDS, including mutual persona perception <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib16" title="">2020</a>); Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib38" title="">2022a</a>); Kim et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib11" title="">2020</a>)</cite>, persona-sparsity <cite class="ltx_cite ltx_citemacro_cite">Song et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib30" title="">2021</a>); Welch et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib36" title="">2022</a>)</cite>, long-term persona memory <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib39" title="">2022b</a>); Zhong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib47" title="">2024</a>)</cite>, etc.
For example, <math alttext="\mathcal{P}^{2}" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><msup id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml">𝒫</mi><mn id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><apply id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.1.1.1.cmml" xref="S2.p1.1.m1.1.1">superscript</csymbol><ci id="S2.p1.1.m1.1.1.2.cmml" xref="S2.p1.1.m1.1.1.2">𝒫</ci><cn id="S2.p1.1.m1.1.1.3.cmml" type="integer" xref="S2.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">\mathcal{P}^{2}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">caligraphic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math>BOT <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib16" title="">2020</a>)</cite> is a GPT-based framework <cite class="ltx_cite ltx_citemacro_cite">Radford et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib25" title="">2018</a>)</cite>, specifically designed to enrich personalized dialogue generation through mutual persona perception. It aims to model the underlying understanding, such as character traits, within a conversation to facilitate mutual acquaintance between interlocutors.
In addition, a PDS can be further enhanced by integrating internal reasoning techniques <cite class="ltx_cite ltx_citemacro_cite">Hongru et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib8" title="">2023</a>)</cite> or external acting techniques <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib33" title="">2023b</a>)</cite>, which aim to generate more personalized and factual responses. In this study, we construct user-personalized agents using practical memory data gathered from smartphone AI assistants. Leveraging these agents, we introduce three distinct applications: question answering, autofill forms, and user services.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Retrieval-Augmented Generation on Knowledge Graph.</span> We review the literature on RAG on knowledge graphs across various tasks, including KBQA <cite class="ltx_cite ltx_citemacro_cite">Ye et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib41" title="">2021</a>); Das et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib4" title="">2021</a>); Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib32" title="">2023a</a>); Shu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib28" title="">2022</a>)</cite>, open-domain scenarios <cite class="ltx_cite ltx_citemacro_cite">Yang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib40" title="">2023</a>)</cite>, table-related tasks <cite class="ltx_cite ltx_citemacro_cite">Jiang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib10" title="">2023</a>)</cite>, human-machine conversation <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib42" title="">2020</a>)</cite>, and image captioning <cite class="ltx_cite ltx_citemacro_cite">Hu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib9" title="">2023</a>)</cite>. This paper <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib46" title="">2024</a>)</cite> provides a detailed survey on these tasks with RAG techniques.
Specifically, TIARA <cite class="ltx_cite ltx_citemacro_cite">Shu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib28" title="">2022</a>)</cite> stands out as a KBQA model employing multi-grained retrieval (entities, logical forms, and schema items) from knowledge graphs. This approach aids pre-trained language models in mitigating generation errors. In this study, we introduce a novel EMG structure to manage users’ personal memories. Further, we employ RL to model the RAG process, which optimizes the memory selection on the graph.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.1"><span class="ltx_text ltx_font_bold" id="S2.p3.1.1">Model Editing.</span> Model editing represents a recent research area focused on correcting model predictions in light of evolving real-world dynamics. It edits the behavior of pre-trained language models within specific domains, and preserving performance across other domains without compromise.
Some existing methods <cite class="ltx_cite ltx_citemacro_cite">De Cao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib5" title="">2021</a>); Mitchell et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib20" title="">2021</a>)</cite> employ learnable model editors, which are trained to predict the weights of the base model undergoing editing. Other methods <cite class="ltx_cite ltx_citemacro_cite">Meng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib18" title="">2022a</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib19" title="">b</a>); Li et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib13" title="">2024a</a>)</cite> are designed to identify stored facts (such as specific neurons in the network) and adjust corresponding activations to reflect changed facts. Additionally, SERAC <cite class="ltx_cite ltx_citemacro_cite">Mitchell et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib21" title="">2022</a>)</cite> utilizes an external memory to store edits, adaptively altering the base model’s predictions by retrieving relevant edits. In our study, we leverage a LLM to focus on user personal memories rather than global knowledge. Additionally, we support dynamic user edits on the EMG and utilize RAG with a frozen LLM to respond to these changes.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Statement</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We study the problem of developing personalized agents for users on smartphone AI assistant platforms (such as Apple’s Siri or Samsung’s Bixby). These agents are designed to assist users in performing personalized tasks, requiring the fulfillment of the following two properties in practical scenarios:</p>
</div>
<div class="ltx_para" id="S3.p2">
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span>
<div class="ltx_para" id="S3.I1.ix1.p1">
<p class="ltx_p" id="S3.I1.ix1.p1.1">Editability: The responses from the agents may be editable based on the users’ dynamic memory data, which involves insertion, deletion, and replacement operations corresponding to different usage scenarios, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.F2" title="Figure 2 ‣ 4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>(a).</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">-</span>
<div class="ltx_para" id="S3.I1.ix2.p1">
<p class="ltx_p" id="S3.I1.ix2.p1.1">Selectability: The agents can select relevant memories to respond to users’ queries, with some queries requiring the combination of multiple memories to generate responses through a base language model, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.F2" title="Figure 2 ‣ 4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>(b).</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">By satisfying these properties, the agents aim to enhance the user experience during interactions with their smartphone AI assistants. These agents offer essential functionalities to support personalized applications, including question answering, autofill forms, and user services like reminders for important events and times, and travel navigation (further details will be discussed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS4" title="4.4 Discussion on Applications and Cold-start ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">4.4</span></a>).</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="269" id="S3.F1.g1" src="x1.png" width="706"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>An example of data collection. Step-1: Raw data is gathered on smartphone AI assistant platforms, e.g., everyday conversations between users and assistants, and the extraction of app screenshot contents through OCR.</figcaption>
</figure>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>An example of data collection. Step-2: GPT-4 generates memories from raw data. Step-3: GPT-4 forms QA pairs using several memories, and produces the required memories, which are utilized for training the <span class="ltx_text ltx_font_typewriter" id="S3.T1.14.1">EMG-RAG</span>.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.12">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.12.13.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.12.13.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">Step-2: Memories (generated by GPT-4)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S3.T1.12.13.1.2" style="padding-left:2.0pt;padding-right:2.0pt;">Step-3: QA pairs with memories (generated by GPT-4)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S3.T1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.1.1.1.1">
<tr class="ltx_tr" id="S3.T1.1.1.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.1.1.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<math alttext="M_{1}" class="ltx_Math" display="inline" id="S3.T1.1.1.1.1.1.1.m1.1"><semantics id="S3.T1.1.1.1.1.1.1.m1.1a"><msub id="S3.T1.1.1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.1.1.1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.1.1.1.m1.1.1.2.cmml">M</mi><mn id="S3.T1.1.1.1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.1.1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.1.1.1.m1.1.1.2">𝑀</ci><cn id="S3.T1.1.1.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.1.1.1.1.1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.1.1.m1.1c">M_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.1.1.1.m1.1d">italic_M start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>: My boss is traveling to Amsterdam next month,</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.1.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.1.1.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">I assist with flight and hotel arrangements.</td>
</tr>
</table>
</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T1.4.4.4" rowspan="3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.4.4.4.3">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.4.4.4.3.3">
<span class="ltx_tr" id="S3.T1.2.2.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.2.2.2.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="Q" class="ltx_Math" display="inline" id="S3.T1.2.2.2.1.1.1.1.m1.1"><semantics id="S3.T1.2.2.2.1.1.1.1.m1.1a"><mi id="S3.T1.2.2.2.1.1.1.1.m1.1.1" xref="S3.T1.2.2.2.1.1.1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.1.1.1.1.m1.1b"><ci id="S3.T1.2.2.2.1.1.1.1.m1.1.1.cmml" xref="S3.T1.2.2.2.1.1.1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.1.1.1.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.T1.2.2.2.1.1.1.1.m1.1d">italic_Q</annotation></semantics></math>: What time is my boss’s flight to Amsterdam?</span></span>
<span class="ltx_tr" id="S3.T1.3.3.3.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.3.3.3.2.2.2.1" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="A" class="ltx_Math" display="inline" id="S3.T1.3.3.3.2.2.2.1.m1.1"><semantics id="S3.T1.3.3.3.2.2.2.1.m1.1a"><mi id="S3.T1.3.3.3.2.2.2.1.m1.1.1" xref="S3.T1.3.3.3.2.2.2.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.T1.3.3.3.2.2.2.1.m1.1b"><ci id="S3.T1.3.3.3.2.2.2.1.m1.1.1.cmml" xref="S3.T1.3.3.3.2.2.2.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.3.3.2.2.2.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.T1.3.3.3.2.2.2.1.m1.1d">italic_A</annotation></semantics></math>: Your boss flight EK349 departs at 01:40 on 2024-05-12.</span></span>
<span class="ltx_tr" id="S3.T1.4.4.4.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.4.4.4.3.3.3.1" style="padding-left:2.0pt;padding-right:2.0pt;">Required memories: <math alttext="M_{1},M_{2},M_{4}" class="ltx_Math" display="inline" id="S3.T1.4.4.4.3.3.3.1.m1.3"><semantics id="S3.T1.4.4.4.3.3.3.1.m1.3a"><mrow id="S3.T1.4.4.4.3.3.3.1.m1.3.3.3" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.4.cmml"><msub id="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.cmml"><mi id="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.2" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.2.cmml">M</mi><mn id="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.3" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.4" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.4.cmml">,</mo><msub id="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2" xref="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.cmml"><mi id="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.2" xref="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.2.cmml">M</mi><mn id="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.3" xref="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.5" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.4.cmml">,</mo><msub id="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.cmml"><mi id="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.2" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.2.cmml">M</mi><mn id="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.3" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.3.cmml">4</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.4.4.4.3.3.3.1.m1.3b"><list id="S3.T1.4.4.4.3.3.3.1.m1.3.3.4.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.3"><apply id="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.1.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.2.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.2">𝑀</ci><cn id="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.3.cmml" type="integer" xref="S3.T1.4.4.4.3.3.3.1.m1.1.1.1.1.3">1</cn></apply><apply id="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.1.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.2.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.2">𝑀</ci><cn id="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.3.cmml" type="integer" xref="S3.T1.4.4.4.3.3.3.1.m1.2.2.2.2.3">2</cn></apply><apply id="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.1.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.2.cmml" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.2">𝑀</ci><cn id="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.3.cmml" type="integer" xref="S3.T1.4.4.4.3.3.3.1.m1.3.3.3.3.3">4</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.4.4.3.3.3.1.m1.3c">M_{1},M_{2},M_{4}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.4.4.4.3.3.3.1.m1.3d">italic_M start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math></span></span>
</span></span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.5.5.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<math alttext="M_{2}" class="ltx_Math" display="inline" id="S3.T1.5.5.1.m1.1"><semantics id="S3.T1.5.5.1.m1.1a"><msub id="S3.T1.5.5.1.m1.1.1" xref="S3.T1.5.5.1.m1.1.1.cmml"><mi id="S3.T1.5.5.1.m1.1.1.2" xref="S3.T1.5.5.1.m1.1.1.2.cmml">M</mi><mn id="S3.T1.5.5.1.m1.1.1.3" xref="S3.T1.5.5.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.5.5.1.m1.1b"><apply id="S3.T1.5.5.1.m1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.5.1.m1.1.1.1.cmml" xref="S3.T1.5.5.1.m1.1.1">subscript</csymbol><ci id="S3.T1.5.5.1.m1.1.1.2.cmml" xref="S3.T1.5.5.1.m1.1.1.2">𝑀</ci><cn id="S3.T1.5.5.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.5.5.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.5.1.m1.1c">M_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.5.5.1.m1.1d">italic_M start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>: I booked the EK349 flight.</th>
</tr>
<tr class="ltx_tr" id="S3.T1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.6.6.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<math alttext="M_{3}" class="ltx_Math" display="inline" id="S3.T1.6.6.1.m1.1"><semantics id="S3.T1.6.6.1.m1.1a"><msub id="S3.T1.6.6.1.m1.1.1" xref="S3.T1.6.6.1.m1.1.1.cmml"><mi id="S3.T1.6.6.1.m1.1.1.2" xref="S3.T1.6.6.1.m1.1.1.2.cmml">M</mi><mn id="S3.T1.6.6.1.m1.1.1.3" xref="S3.T1.6.6.1.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.6.6.1.m1.1b"><apply id="S3.T1.6.6.1.m1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.6.6.1.m1.1.1.1.cmml" xref="S3.T1.6.6.1.m1.1.1">subscript</csymbol><ci id="S3.T1.6.6.1.m1.1.1.2.cmml" xref="S3.T1.6.6.1.m1.1.1.2">𝑀</ci><cn id="S3.T1.6.6.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.6.6.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.6.1.m1.1c">M_{3}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.6.6.1.m1.1d">italic_M start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math>: I booked the Crowne Plaza near Central Station.</th>
</tr>
<tr class="ltx_tr" id="S3.T1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.7.7.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<math alttext="M_{4}" class="ltx_Math" display="inline" id="S3.T1.7.7.1.m1.1"><semantics id="S3.T1.7.7.1.m1.1a"><msub id="S3.T1.7.7.1.m1.1.1" xref="S3.T1.7.7.1.m1.1.1.cmml"><mi id="S3.T1.7.7.1.m1.1.1.2" xref="S3.T1.7.7.1.m1.1.1.2.cmml">M</mi><mn id="S3.T1.7.7.1.m1.1.1.3" xref="S3.T1.7.7.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.7.7.1.m1.1b"><apply id="S3.T1.7.7.1.m1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.7.7.1.m1.1.1.1.cmml" xref="S3.T1.7.7.1.m1.1.1">subscript</csymbol><ci id="S3.T1.7.7.1.m1.1.1.2.cmml" xref="S3.T1.7.7.1.m1.1.1.2">𝑀</ci><cn id="S3.T1.7.7.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.7.7.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.7.1.m1.1c">M_{4}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.7.7.1.m1.1d">italic_M start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>: The EK349 flight departs at 01:40 on 2024-05-12.</th>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_t" id="S3.T1.10.10.4" rowspan="3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.10.10.4.3">
<span class="ltx_tabular ltx_align_middle" id="S3.T1.10.10.4.3.3">
<span class="ltx_tr" id="S3.T1.8.8.2.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.8.8.2.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="Q" class="ltx_Math" display="inline" id="S3.T1.8.8.2.1.1.1.1.m1.1"><semantics id="S3.T1.8.8.2.1.1.1.1.m1.1a"><mi id="S3.T1.8.8.2.1.1.1.1.m1.1.1" xref="S3.T1.8.8.2.1.1.1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.T1.8.8.2.1.1.1.1.m1.1b"><ci id="S3.T1.8.8.2.1.1.1.1.m1.1.1.cmml" xref="S3.T1.8.8.2.1.1.1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.8.2.1.1.1.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.T1.8.8.2.1.1.1.1.m1.1d">italic_Q</annotation></semantics></math>: When dose the hotel I booked for my boss start and end?</span></span>
<span class="ltx_tr" id="S3.T1.9.9.3.2.2.2">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.9.9.3.2.2.2.1" style="padding-left:2.0pt;padding-right:2.0pt;"><math alttext="A" class="ltx_Math" display="inline" id="S3.T1.9.9.3.2.2.2.1.m1.1"><semantics id="S3.T1.9.9.3.2.2.2.1.m1.1a"><mi id="S3.T1.9.9.3.2.2.2.1.m1.1.1" xref="S3.T1.9.9.3.2.2.2.1.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.T1.9.9.3.2.2.2.1.m1.1b"><ci id="S3.T1.9.9.3.2.2.2.1.m1.1.1.cmml" xref="S3.T1.9.9.3.2.2.2.1.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.9.9.3.2.2.2.1.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S3.T1.9.9.3.2.2.2.1.m1.1d">italic_A</annotation></semantics></math>: The Crowne Plaza reservation is from 2024-05-12 to 2024-05-18.</span></span>
<span class="ltx_tr" id="S3.T1.10.10.4.3.3.3">
<span class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.10.10.4.3.3.3.1" style="padding-left:2.0pt;padding-right:2.0pt;">Required memories: <math alttext="M_{1},M_{3},M_{5}" class="ltx_Math" display="inline" id="S3.T1.10.10.4.3.3.3.1.m1.3"><semantics id="S3.T1.10.10.4.3.3.3.1.m1.3a"><mrow id="S3.T1.10.10.4.3.3.3.1.m1.3.3.3" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.4.cmml"><msub id="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1" xref="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.cmml"><mi id="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.2" xref="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.2.cmml">M</mi><mn id="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.3" xref="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.4" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.4.cmml">,</mo><msub id="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2" xref="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.cmml"><mi id="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.2" xref="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.2.cmml">M</mi><mn id="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.3" xref="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.3.cmml">3</mn></msub><mo id="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.5" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.4.cmml">,</mo><msub id="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.cmml"><mi id="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.2" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.2.cmml">M</mi><mn id="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.3" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.3.cmml">5</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.10.10.4.3.3.3.1.m1.3b"><list id="S3.T1.10.10.4.3.3.3.1.m1.3.3.4.cmml" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.3"><apply id="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.cmml" xref="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.1.cmml" xref="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.2.cmml" xref="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.2">𝑀</ci><cn id="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.3.cmml" type="integer" xref="S3.T1.10.10.4.3.3.3.1.m1.1.1.1.1.3">1</cn></apply><apply id="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.cmml" xref="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.1.cmml" xref="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.2.cmml" xref="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.2">𝑀</ci><cn id="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.3.cmml" type="integer" xref="S3.T1.10.10.4.3.3.3.1.m1.2.2.2.2.3">3</cn></apply><apply id="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.cmml" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.1.cmml" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.2.cmml" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.2">𝑀</ci><cn id="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.3.cmml" type="integer" xref="S3.T1.10.10.4.3.3.3.1.m1.3.3.3.3.3">5</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.10.10.4.3.3.3.1.m1.3c">M_{1},M_{3},M_{5}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.10.10.4.3.3.3.1.m1.3d">italic_M start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT</annotation></semantics></math></span></span>
</span></span></td>
</tr>
</tbody>
<tfoot class="ltx_tfoot">
<tr class="ltx_tr" id="S3.T1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S3.T1.11.11.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.11.11.1.1">
<tr class="ltx_tr" id="S3.T1.11.11.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.11.11.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<math alttext="M_{5}" class="ltx_Math" display="inline" id="S3.T1.11.11.1.1.1.1.m1.1"><semantics id="S3.T1.11.11.1.1.1.1.m1.1a"><msub id="S3.T1.11.11.1.1.1.1.m1.1.1" xref="S3.T1.11.11.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.11.11.1.1.1.1.m1.1.1.2" xref="S3.T1.11.11.1.1.1.1.m1.1.1.2.cmml">M</mi><mn id="S3.T1.11.11.1.1.1.1.m1.1.1.3" xref="S3.T1.11.11.1.1.1.1.m1.1.1.3.cmml">5</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.11.11.1.1.1.1.m1.1b"><apply id="S3.T1.11.11.1.1.1.1.m1.1.1.cmml" xref="S3.T1.11.11.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.11.11.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.11.11.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.11.11.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.11.11.1.1.1.1.m1.1.1.2">𝑀</ci><cn id="S3.T1.11.11.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.11.11.1.1.1.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.11.11.1.1.1.1.m1.1c">M_{5}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.11.11.1.1.1.1.m1.1d">italic_M start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT</annotation></semantics></math>: The Crowne Plaza reservation is for</td>
</tr>
<tr class="ltx_tr" id="S3.T1.11.11.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.11.11.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">2024-05-12 to 2024-05-18.</td>
</tr>
</table>
</th>
</tr>
<tr class="ltx_tr" id="S3.T1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S3.T1.12.12.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<table class="ltx_tabular ltx_align_middle" id="S3.T1.12.12.1.1">
<tr class="ltx_tr" id="S3.T1.12.12.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.12.12.1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<math alttext="M_{6}" class="ltx_Math" display="inline" id="S3.T1.12.12.1.1.1.1.m1.1"><semantics id="S3.T1.12.12.1.1.1.1.m1.1a"><msub id="S3.T1.12.12.1.1.1.1.m1.1.1" xref="S3.T1.12.12.1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.12.12.1.1.1.1.m1.1.1.2" xref="S3.T1.12.12.1.1.1.1.m1.1.1.2.cmml">M</mi><mn id="S3.T1.12.12.1.1.1.1.m1.1.1.3" xref="S3.T1.12.12.1.1.1.1.m1.1.1.3.cmml">6</mn></msub><annotation-xml encoding="MathML-Content" id="S3.T1.12.12.1.1.1.1.m1.1b"><apply id="S3.T1.12.12.1.1.1.1.m1.1.1.cmml" xref="S3.T1.12.12.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.12.12.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.12.12.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.12.12.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.12.12.1.1.1.1.m1.1.1.2">𝑀</ci><cn id="S3.T1.12.12.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.12.12.1.1.1.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.12.12.1.1.1.1.m1.1c">M_{6}</annotation><annotation encoding="application/x-llamapun" id="S3.T1.12.12.1.1.1.1.m1.1d">italic_M start_POSTSUBSCRIPT 6 end_POSTSUBSCRIPT</annotation></semantics></math>: The Crowne Plaza reservation includes a Queen</td>
</tr>
<tr class="ltx_tr" id="S3.T1.12.12.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="S3.T1.12.12.1.1.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">Bed Standard Accessible room with breakfast.</td>
</tr>
</table>
</th>
</tr>
</tfoot>
</table>
</figure>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Methodology</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Data Collection</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.2">The process entails (1) gathering raw data, such as everyday conversations or screenshots from user interactions with the smartphone AI assistants; (2) extracting crucial information from this raw data, referred to as memories (denoted by <math alttext="M" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.1"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.1.m1.1d">italic_M</annotation></semantics></math>); and (3) generating QA pairs (denoted by <math alttext="&lt;Q,A&gt;" class="ltx_math_unparsed" display="inline" id="S4.SS1.p1.2.m2.2"><semantics id="S4.SS1.p1.2.m2.2a"><mrow id="S4.SS1.p1.2.m2.2b"><mo id="S4.SS1.p1.2.m2.2.3">&lt;</mo><mi id="S4.SS1.p1.2.m2.1.1">Q</mi><mo id="S4.SS1.p1.2.m2.2.4">,</mo><mi id="S4.SS1.p1.2.m2.2.2">A</mi><mo id="S4.SS1.p1.2.m2.2.5">&gt;</mo></mrow><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.2c">&lt;Q,A&gt;</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p1.2.m2.2d">&lt; italic_Q , italic_A &gt;</annotation></semantics></math>), and outputting the required memories to facilitate this pairing. For (1), we acquire data from real AI assistant products and employ text processing techniques like OCR to extract content from screenshots. Subsequently, for (2) and (3), we leverage the capabilities of LLMs, such as GPT-4 <cite class="ltx_cite ltx_citemacro_cite">OpenAI (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib23" title="">2023</a>)</cite>, to extract key memories from the raw data and create QA pairs. These pairs serve the purpose of training personalized agents for the proposed <span class="ltx_text ltx_font_typewriter" id="S4.SS1.p1.2.1">EMG-RAG</span>. To illustrate the collection process, we provide a running example in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S3.F1" title="Figure 1 ‣ 3 Problem Statement ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">1</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S3.T1" title="Table 1 ‣ 3 Problem Statement ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">1</span></a>, which involve the three primary steps. Further details are outlined in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.SS1" title="A.1 Data Collection Details ‣ Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">We discuss the rationales of the data collection. First, as a user’s personalized agent integrated within the smartphone AI assistant, the conversations and screenshots provide natural data sources for crafting these agents. Second, leveraging GPT-4’s language generation capabilities enables us to generate a wide range of memories from the raw data, significantly reducing manual effort. Third, the involved memories and collected QA pairs serve as labels to supervise the training of the retrieval and generation processes in our framework.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="447" id="S4.F2.g1" src="x2.png" width="822"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The architecture of the proposed <span class="ltx_text ltx_font_typewriter" id="S4.F2.14.1">EMG-RAG</span>, demonstrated with the running example in data collection (Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS1" title="4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">4.1</span></a>). It supports three editability operations: insertion (e.g., <math alttext="M_{7}" class="ltx_Math" display="inline" id="S4.F2.7.m1.1"><semantics id="S4.F2.7.m1.1b"><msub id="S4.F2.7.m1.1.1" xref="S4.F2.7.m1.1.1.cmml"><mi id="S4.F2.7.m1.1.1.2" xref="S4.F2.7.m1.1.1.2.cmml">M</mi><mn id="S4.F2.7.m1.1.1.3" xref="S4.F2.7.m1.1.1.3.cmml">7</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F2.7.m1.1c"><apply id="S4.F2.7.m1.1.1.cmml" xref="S4.F2.7.m1.1.1"><csymbol cd="ambiguous" id="S4.F2.7.m1.1.1.1.cmml" xref="S4.F2.7.m1.1.1">subscript</csymbol><ci id="S4.F2.7.m1.1.1.2.cmml" xref="S4.F2.7.m1.1.1.2">𝑀</ci><cn id="S4.F2.7.m1.1.1.3.cmml" type="integer" xref="S4.F2.7.m1.1.1.3">7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.7.m1.1d">M_{7}</annotation><annotation encoding="application/x-llamapun" id="S4.F2.7.m1.1e">italic_M start_POSTSUBSCRIPT 7 end_POSTSUBSCRIPT</annotation></semantics></math>), deletion (e.g., <math alttext="M_{8}" class="ltx_Math" display="inline" id="S4.F2.8.m2.1"><semantics id="S4.F2.8.m2.1b"><msub id="S4.F2.8.m2.1.1" xref="S4.F2.8.m2.1.1.cmml"><mi id="S4.F2.8.m2.1.1.2" xref="S4.F2.8.m2.1.1.2.cmml">M</mi><mn id="S4.F2.8.m2.1.1.3" xref="S4.F2.8.m2.1.1.3.cmml">8</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F2.8.m2.1c"><apply id="S4.F2.8.m2.1.1.cmml" xref="S4.F2.8.m2.1.1"><csymbol cd="ambiguous" id="S4.F2.8.m2.1.1.1.cmml" xref="S4.F2.8.m2.1.1">subscript</csymbol><ci id="S4.F2.8.m2.1.1.2.cmml" xref="S4.F2.8.m2.1.1.2">𝑀</ci><cn id="S4.F2.8.m2.1.1.3.cmml" type="integer" xref="S4.F2.8.m2.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.8.m2.1d">M_{8}</annotation><annotation encoding="application/x-llamapun" id="S4.F2.8.m2.1e">italic_M start_POSTSUBSCRIPT 8 end_POSTSUBSCRIPT</annotation></semantics></math>), and replacement (e.g., <math alttext="M_{9}" class="ltx_Math" display="inline" id="S4.F2.9.m3.1"><semantics id="S4.F2.9.m3.1b"><msub id="S4.F2.9.m3.1.1" xref="S4.F2.9.m3.1.1.cmml"><mi id="S4.F2.9.m3.1.1.2" xref="S4.F2.9.m3.1.1.2.cmml">M</mi><mn id="S4.F2.9.m3.1.1.3" xref="S4.F2.9.m3.1.1.3.cmml">9</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F2.9.m3.1c"><apply id="S4.F2.9.m3.1.1.cmml" xref="S4.F2.9.m3.1.1"><csymbol cd="ambiguous" id="S4.F2.9.m3.1.1.1.cmml" xref="S4.F2.9.m3.1.1">subscript</csymbol><ci id="S4.F2.9.m3.1.1.2.cmml" xref="S4.F2.9.m3.1.1.2">𝑀</ci><cn id="S4.F2.9.m3.1.1.3.cmml" type="integer" xref="S4.F2.9.m3.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.9.m3.1d">M_{9}</annotation><annotation encoding="application/x-llamapun" id="S4.F2.9.m3.1e">italic_M start_POSTSUBSCRIPT 9 end_POSTSUBSCRIPT</annotation></semantics></math>), based on the EMG structure (Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS2" title="4.2 Editable Memory Graphs ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">4.2</span></a>). Subsequently, the edited EMG undergoes RAG to select relevant memories (e.g., <math alttext="M_{1},M_{2},M_{9}" class="ltx_Math" display="inline" id="S4.F2.10.m4.3"><semantics id="S4.F2.10.m4.3b"><mrow id="S4.F2.10.m4.3.3.3" xref="S4.F2.10.m4.3.3.4.cmml"><msub id="S4.F2.10.m4.1.1.1.1" xref="S4.F2.10.m4.1.1.1.1.cmml"><mi id="S4.F2.10.m4.1.1.1.1.2" xref="S4.F2.10.m4.1.1.1.1.2.cmml">M</mi><mn id="S4.F2.10.m4.1.1.1.1.3" xref="S4.F2.10.m4.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.F2.10.m4.3.3.3.4" xref="S4.F2.10.m4.3.3.4.cmml">,</mo><msub id="S4.F2.10.m4.2.2.2.2" xref="S4.F2.10.m4.2.2.2.2.cmml"><mi id="S4.F2.10.m4.2.2.2.2.2" xref="S4.F2.10.m4.2.2.2.2.2.cmml">M</mi><mn id="S4.F2.10.m4.2.2.2.2.3" xref="S4.F2.10.m4.2.2.2.2.3.cmml">2</mn></msub><mo id="S4.F2.10.m4.3.3.3.5" xref="S4.F2.10.m4.3.3.4.cmml">,</mo><msub id="S4.F2.10.m4.3.3.3.3" xref="S4.F2.10.m4.3.3.3.3.cmml"><mi id="S4.F2.10.m4.3.3.3.3.2" xref="S4.F2.10.m4.3.3.3.3.2.cmml">M</mi><mn id="S4.F2.10.m4.3.3.3.3.3" xref="S4.F2.10.m4.3.3.3.3.3.cmml">9</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.10.m4.3c"><list id="S4.F2.10.m4.3.3.4.cmml" xref="S4.F2.10.m4.3.3.3"><apply id="S4.F2.10.m4.1.1.1.1.cmml" xref="S4.F2.10.m4.1.1.1.1"><csymbol cd="ambiguous" id="S4.F2.10.m4.1.1.1.1.1.cmml" xref="S4.F2.10.m4.1.1.1.1">subscript</csymbol><ci id="S4.F2.10.m4.1.1.1.1.2.cmml" xref="S4.F2.10.m4.1.1.1.1.2">𝑀</ci><cn id="S4.F2.10.m4.1.1.1.1.3.cmml" type="integer" xref="S4.F2.10.m4.1.1.1.1.3">1</cn></apply><apply id="S4.F2.10.m4.2.2.2.2.cmml" xref="S4.F2.10.m4.2.2.2.2"><csymbol cd="ambiguous" id="S4.F2.10.m4.2.2.2.2.1.cmml" xref="S4.F2.10.m4.2.2.2.2">subscript</csymbol><ci id="S4.F2.10.m4.2.2.2.2.2.cmml" xref="S4.F2.10.m4.2.2.2.2.2">𝑀</ci><cn id="S4.F2.10.m4.2.2.2.2.3.cmml" type="integer" xref="S4.F2.10.m4.2.2.2.2.3">2</cn></apply><apply id="S4.F2.10.m4.3.3.3.3.cmml" xref="S4.F2.10.m4.3.3.3.3"><csymbol cd="ambiguous" id="S4.F2.10.m4.3.3.3.3.1.cmml" xref="S4.F2.10.m4.3.3.3.3">subscript</csymbol><ci id="S4.F2.10.m4.3.3.3.3.2.cmml" xref="S4.F2.10.m4.3.3.3.3.2">𝑀</ci><cn id="S4.F2.10.m4.3.3.3.3.3.cmml" type="integer" xref="S4.F2.10.m4.3.3.3.3.3">9</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.10.m4.3d">M_{1},M_{2},M_{9}</annotation><annotation encoding="application/x-llamapun" id="S4.F2.10.m4.3e">italic_M start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT 9 end_POSTSUBSCRIPT</annotation></semantics></math>) for a given question <math alttext="Q" class="ltx_Math" display="inline" id="S4.F2.11.m5.1"><semantics id="S4.F2.11.m5.1b"><mi id="S4.F2.11.m5.1.1" xref="S4.F2.11.m5.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.F2.11.m5.1c"><ci id="S4.F2.11.m5.1.1.cmml" xref="S4.F2.11.m5.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.11.m5.1d">Q</annotation><annotation encoding="application/x-llamapun" id="S4.F2.11.m5.1e">italic_Q</annotation></semantics></math> via a MDP (Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS3" title="4.3 MDP for Selecting Memories on EMGs ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">4.3</span></a>). The generated answers <math alttext="A" class="ltx_Math" display="inline" id="S4.F2.12.m6.1"><semantics id="S4.F2.12.m6.1b"><mi id="S4.F2.12.m6.1.1" xref="S4.F2.12.m6.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.F2.12.m6.1c"><ci id="S4.F2.12.m6.1.1.cmml" xref="S4.F2.12.m6.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.12.m6.1d">A</annotation><annotation encoding="application/x-llamapun" id="S4.F2.12.m6.1e">italic_A</annotation></semantics></math> by a frozen LLM further facilitates three downstream applications (Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS4" title="4.4 Discussion on Applications and Cold-start ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">4.4</span></a>).</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Editable Memory Graphs</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p1.1.1">The EMG Construction and Insights.</span> Utilizing a user’s memories, we establish the Editable Memory Graph with a multilayered structure, depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.F2" title="Figure 2 ‣ 4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>(a), where the user is the root node.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS2.p2.1.1">Memory Type Layer (MTL)</span>: Aligned with the business scope, we categorize memories into 4 predefined types: Relationship, Preference, Event, and Attribute. Details are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.SS2" title="A.2 Memory Types and Subclasses ‣ Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">A.2</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS2.p3.1.1">Memory Subclass Layer (MSL)</span>: The MSL further outlines subclasses for each type, where the MTL and MSL are organized in a hierarchical tree structure to manage the memories. Detailed subclasses with examples are listed in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.SS2" title="A.2 Memory Types and Subclasses ‣ Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">A.2</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS2.p4.1.1">Memory Graph Layer (MGL)</span>: The memory graph is built by utilizing the collected memories, employing entity recognition for nodes and relation extraction for edges. In this graph, each in-degree node is associated with its corresponding memory, e.g., the in-degree node (01:40 on 2024-05-12) contains <math alttext="M_{4}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><msub id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">M</mi><mn id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝑀</ci><cn id="S4.SS2.p4.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p4.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">M_{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_M start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math>, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.F2" title="Figure 2 ‣ 4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>(a).
Further, to establish the connection between the MSL and MGL, TransE embeddings <cite class="ltx_cite ltx_citemacro_cite">Bordes et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib1" title="">2013</a>)</cite> are employed to capture semantic information of nodes in MSL (subclasses) and MGL (entities), respectively. Then, each entity is assigned to its closest classes based on these embeddings. It is noteworthy that entity nodes are categorized into different subclasses, and their connections may span across different classes, e.g., “Boss” and “Amsterdam” are linked across “Colleague” and “Arrangement” classes in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.F2" title="Figure 2 ‣ 4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>(a). This design enables further traversal across various parts of the whole graph.</p>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1">We discuss the insights of the EMG construction: 1) the tree hierarchy (MTL and MSL) offers a partitioned memory management approach, to facilitate the expansion of additional types and subclasses in accordance with business needs; 2) the entity nodes and corresponding memories are organized into separate subclass partitions, with the graph structure (MGL) to capture their complex relationships between memories; 3) it enables efficient retrieval of memories for further editing operations by first locating a relevant partition, e.g., querying partition centers (the mean of the memory embeddings), instead of searching through all memories.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p6">
<p class="ltx_p" id="S4.SS2.p6.1"><span class="ltx_text ltx_font_bold" id="S4.SS2.p6.1.1">The EMG Editing.</span> When editing a given memory within the EMG (e.g., insertion, deletion, or replacement), the process involves three steps. Initially, a model such as CPT-Text <cite class="ltx_cite ltx_citemacro_cite">Neelakantan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib22" title="">2022</a>)</cite> is employed to acquire memory representations. Then, the memory is assigned to its nearest subclass (partition), and the Top-1 retrieved memory within the partition is then returned, and editing operations are performed based on comparing the relations between the given memory and the retrieved memory. Specifically, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.F2" title="Figure 2 ‣ 4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>, (1) Insertion: It introduces a new relation to be added, e.g., obtaining a new memory containing flight seat number. (2) Deletion: It introduces a new relation, but it is valid for a specific period of time. e.g., a hotel voucher will expire on May 14, 2024. (3) Replacement: It provides an existing relation, and updates the corresponding entity nodes based on this relation, e.g., changing the departure time to 01:30 on May 12, 2024.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>MDP for Selecting Memories on EMGs</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.13">Next, we outline the task of selecting memories based on an edited EMG. To achieve this, we employ an agent to traverse the EMG. Specifically, given a question <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_Q</annotation></semantics></math>, the agent selects a set of memories from the EMG denoted by <math alttext="\mathbb{M}=\{M_{i}\}" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">𝕄</mi><mo id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">=</mo><mrow id="S4.SS3.p1.2.m2.1.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.2.cmml"><mo id="S4.SS3.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.2.m2.1.1.1.2.cmml">{</mo><msub id="S4.SS3.p1.2.m2.1.1.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.1.1.1.2" xref="S4.SS3.p1.2.m2.1.1.1.1.1.2.cmml">M</mi><mi id="S4.SS3.p1.2.m2.1.1.1.1.1.3" xref="S4.SS3.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS3.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS3.p1.2.m2.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><eq id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2"></eq><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">𝕄</ci><set id="S4.SS3.p1.2.m2.1.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1"><apply id="S4.SS3.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1.2">𝑀</ci><ci id="S4.SS3.p1.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\mathbb{M}=\{M_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">blackboard_M = { italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="1\leq i\leq|\mathbb{M}|" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.2" xref="S4.SS3.p1.3.m3.1.2.cmml"><mn id="S4.SS3.p1.3.m3.1.2.2" xref="S4.SS3.p1.3.m3.1.2.2.cmml">1</mn><mo id="S4.SS3.p1.3.m3.1.2.3" xref="S4.SS3.p1.3.m3.1.2.3.cmml">≤</mo><mi id="S4.SS3.p1.3.m3.1.2.4" xref="S4.SS3.p1.3.m3.1.2.4.cmml">i</mi><mo id="S4.SS3.p1.3.m3.1.2.5" xref="S4.SS3.p1.3.m3.1.2.5.cmml">≤</mo><mrow id="S4.SS3.p1.3.m3.1.2.6.2" xref="S4.SS3.p1.3.m3.1.2.6.1.cmml"><mo id="S4.SS3.p1.3.m3.1.2.6.2.1" stretchy="false" xref="S4.SS3.p1.3.m3.1.2.6.1.1.cmml">|</mo><mi id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">𝕄</mi><mo id="S4.SS3.p1.3.m3.1.2.6.2.2" stretchy="false" xref="S4.SS3.p1.3.m3.1.2.6.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.2.cmml" xref="S4.SS3.p1.3.m3.1.2"><and id="S4.SS3.p1.3.m3.1.2a.cmml" xref="S4.SS3.p1.3.m3.1.2"></and><apply id="S4.SS3.p1.3.m3.1.2b.cmml" xref="S4.SS3.p1.3.m3.1.2"><leq id="S4.SS3.p1.3.m3.1.2.3.cmml" xref="S4.SS3.p1.3.m3.1.2.3"></leq><cn id="S4.SS3.p1.3.m3.1.2.2.cmml" type="integer" xref="S4.SS3.p1.3.m3.1.2.2">1</cn><ci id="S4.SS3.p1.3.m3.1.2.4.cmml" xref="S4.SS3.p1.3.m3.1.2.4">𝑖</ci></apply><apply id="S4.SS3.p1.3.m3.1.2c.cmml" xref="S4.SS3.p1.3.m3.1.2"><leq id="S4.SS3.p1.3.m3.1.2.5.cmml" xref="S4.SS3.p1.3.m3.1.2.5"></leq><share href="https://arxiv.org/html/2409.19401v1#S4.SS3.p1.3.m3.1.2.4.cmml" id="S4.SS3.p1.3.m3.1.2d.cmml" xref="S4.SS3.p1.3.m3.1.2"></share><apply id="S4.SS3.p1.3.m3.1.2.6.1.cmml" xref="S4.SS3.p1.3.m3.1.2.6.2"><abs id="S4.SS3.p1.3.m3.1.2.6.1.1.cmml" xref="S4.SS3.p1.3.m3.1.2.6.2.1"></abs><ci id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">𝕄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">1\leq i\leq|\mathbb{M}|</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.3.m3.1d">1 ≤ italic_i ≤ | blackboard_M |</annotation></semantics></math>. The question <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1"><semantics id="S4.SS3.p1.4.m4.1a"><mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.4.m4.1d">italic_Q</annotation></semantics></math> and memory set <math alttext="\mathbb{M}" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1"><semantics id="S4.SS3.p1.5.m5.1a"><mi id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">𝕄</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><ci id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">𝕄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">\mathbb{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.5.m5.1d">blackboard_M</annotation></semantics></math> are concatenated to generate an answer <math alttext="\hat{A}\leftarrow\text{LLM}(Q\oplus\mathbb{M})" class="ltx_Math" display="inline" id="S4.SS3.p1.6.m6.1"><semantics id="S4.SS3.p1.6.m6.1a"><mrow id="S4.SS3.p1.6.m6.1.1" xref="S4.SS3.p1.6.m6.1.1.cmml"><mover accent="true" id="S4.SS3.p1.6.m6.1.1.3" xref="S4.SS3.p1.6.m6.1.1.3.cmml"><mi id="S4.SS3.p1.6.m6.1.1.3.2" xref="S4.SS3.p1.6.m6.1.1.3.2.cmml">A</mi><mo id="S4.SS3.p1.6.m6.1.1.3.1" xref="S4.SS3.p1.6.m6.1.1.3.1.cmml">^</mo></mover><mo id="S4.SS3.p1.6.m6.1.1.2" stretchy="false" xref="S4.SS3.p1.6.m6.1.1.2.cmml">←</mo><mrow id="S4.SS3.p1.6.m6.1.1.1" xref="S4.SS3.p1.6.m6.1.1.1.cmml"><mtext id="S4.SS3.p1.6.m6.1.1.1.3" xref="S4.SS3.p1.6.m6.1.1.1.3a.cmml">LLM</mtext><mo id="S4.SS3.p1.6.m6.1.1.1.2" xref="S4.SS3.p1.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p1.6.m6.1.1.1.1.1" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.cmml"><mo id="S4.SS3.p1.6.m6.1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p1.6.m6.1.1.1.1.1.1" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.cmml"><mi id="S4.SS3.p1.6.m6.1.1.1.1.1.1.2" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.2.cmml">Q</mi><mo id="S4.SS3.p1.6.m6.1.1.1.1.1.1.1" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.1.cmml">⊕</mo><mi id="S4.SS3.p1.6.m6.1.1.1.1.1.1.3" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.3.cmml">𝕄</mi></mrow><mo id="S4.SS3.p1.6.m6.1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m6.1b"><apply id="S4.SS3.p1.6.m6.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1"><ci id="S4.SS3.p1.6.m6.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.2">←</ci><apply id="S4.SS3.p1.6.m6.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.3"><ci id="S4.SS3.p1.6.m6.1.1.3.1.cmml" xref="S4.SS3.p1.6.m6.1.1.3.1">^</ci><ci id="S4.SS3.p1.6.m6.1.1.3.2.cmml" xref="S4.SS3.p1.6.m6.1.1.3.2">𝐴</ci></apply><apply id="S4.SS3.p1.6.m6.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1.1"><times id="S4.SS3.p1.6.m6.1.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.1.2"></times><ci id="S4.SS3.p1.6.m6.1.1.1.3a.cmml" xref="S4.SS3.p1.6.m6.1.1.1.3"><mtext id="S4.SS3.p1.6.m6.1.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.1.3">LLM</mtext></ci><apply id="S4.SS3.p1.6.m6.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.1">direct-sum</csymbol><ci id="S4.SS3.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.2">𝑄</ci><ci id="S4.SS3.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S4.SS3.p1.6.m6.1.1.1.1.1.1.3">𝕄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m6.1c">\hat{A}\leftarrow\text{LLM}(Q\oplus\mathbb{M})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.6.m6.1d">over^ start_ARG italic_A end_ARG ← LLM ( italic_Q ⊕ blackboard_M )</annotation></semantics></math> using a LLM. We assess the generation quality using <math alttext="\Delta(\hat{A},A)" class="ltx_Math" display="inline" id="S4.SS3.p1.7.m7.2"><semantics id="S4.SS3.p1.7.m7.2a"><mrow id="S4.SS3.p1.7.m7.2.3" xref="S4.SS3.p1.7.m7.2.3.cmml"><mi id="S4.SS3.p1.7.m7.2.3.2" mathvariant="normal" xref="S4.SS3.p1.7.m7.2.3.2.cmml">Δ</mi><mo id="S4.SS3.p1.7.m7.2.3.1" xref="S4.SS3.p1.7.m7.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p1.7.m7.2.3.3.2" xref="S4.SS3.p1.7.m7.2.3.3.1.cmml"><mo id="S4.SS3.p1.7.m7.2.3.3.2.1" stretchy="false" xref="S4.SS3.p1.7.m7.2.3.3.1.cmml">(</mo><mover accent="true" id="S4.SS3.p1.7.m7.1.1" xref="S4.SS3.p1.7.m7.1.1.cmml"><mi id="S4.SS3.p1.7.m7.1.1.2" xref="S4.SS3.p1.7.m7.1.1.2.cmml">A</mi><mo id="S4.SS3.p1.7.m7.1.1.1" xref="S4.SS3.p1.7.m7.1.1.1.cmml">^</mo></mover><mo id="S4.SS3.p1.7.m7.2.3.3.2.2" xref="S4.SS3.p1.7.m7.2.3.3.1.cmml">,</mo><mi id="S4.SS3.p1.7.m7.2.2" xref="S4.SS3.p1.7.m7.2.2.cmml">A</mi><mo id="S4.SS3.p1.7.m7.2.3.3.2.3" stretchy="false" xref="S4.SS3.p1.7.m7.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m7.2b"><apply id="S4.SS3.p1.7.m7.2.3.cmml" xref="S4.SS3.p1.7.m7.2.3"><times id="S4.SS3.p1.7.m7.2.3.1.cmml" xref="S4.SS3.p1.7.m7.2.3.1"></times><ci id="S4.SS3.p1.7.m7.2.3.2.cmml" xref="S4.SS3.p1.7.m7.2.3.2">Δ</ci><interval closure="open" id="S4.SS3.p1.7.m7.2.3.3.1.cmml" xref="S4.SS3.p1.7.m7.2.3.3.2"><apply id="S4.SS3.p1.7.m7.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1"><ci id="S4.SS3.p1.7.m7.1.1.1.cmml" xref="S4.SS3.p1.7.m7.1.1.1">^</ci><ci id="S4.SS3.p1.7.m7.1.1.2.cmml" xref="S4.SS3.p1.7.m7.1.1.2">𝐴</ci></apply><ci id="S4.SS3.p1.7.m7.2.2.cmml" xref="S4.SS3.p1.7.m7.2.2">𝐴</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m7.2c">\Delta(\hat{A},A)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.7.m7.2d">roman_Δ ( over^ start_ARG italic_A end_ARG , italic_A )</annotation></semantics></math>, where <math alttext="A" class="ltx_Math" display="inline" id="S4.SS3.p1.8.m8.1"><semantics id="S4.SS3.p1.8.m8.1a"><mi id="S4.SS3.p1.8.m8.1.1" xref="S4.SS3.p1.8.m8.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.8.m8.1b"><ci id="S4.SS3.p1.8.m8.1.1.cmml" xref="S4.SS3.p1.8.m8.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.8.m8.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.8.m8.1d">italic_A</annotation></semantics></math> represents the collected ground truth answer for <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS3.p1.9.m9.1"><semantics id="S4.SS3.p1.9.m9.1a"><mi id="S4.SS3.p1.9.m9.1.1" xref="S4.SS3.p1.9.m9.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.9.m9.1b"><ci id="S4.SS3.p1.9.m9.1.1.cmml" xref="S4.SS3.p1.9.m9.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.9.m9.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.9.m9.1d">italic_Q</annotation></semantics></math>, and <math alttext="\Delta(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS3.p1.10.m10.2"><semantics id="S4.SS3.p1.10.m10.2a"><mrow id="S4.SS3.p1.10.m10.2.3" xref="S4.SS3.p1.10.m10.2.3.cmml"><mi id="S4.SS3.p1.10.m10.2.3.2" mathvariant="normal" xref="S4.SS3.p1.10.m10.2.3.2.cmml">Δ</mi><mo id="S4.SS3.p1.10.m10.2.3.1" xref="S4.SS3.p1.10.m10.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p1.10.m10.2.3.3.2" xref="S4.SS3.p1.10.m10.2.3.3.1.cmml"><mo id="S4.SS3.p1.10.m10.2.3.3.2.1" stretchy="false" xref="S4.SS3.p1.10.m10.2.3.3.1.cmml">(</mo><mo id="S4.SS3.p1.10.m10.1.1" lspace="0em" rspace="0em" xref="S4.SS3.p1.10.m10.1.1.cmml">⋅</mo><mo id="S4.SS3.p1.10.m10.2.3.3.2.2" rspace="0em" xref="S4.SS3.p1.10.m10.2.3.3.1.cmml">,</mo><mo id="S4.SS3.p1.10.m10.2.2" lspace="0em" rspace="0em" xref="S4.SS3.p1.10.m10.2.2.cmml">⋅</mo><mo id="S4.SS3.p1.10.m10.2.3.3.2.3" stretchy="false" xref="S4.SS3.p1.10.m10.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.10.m10.2b"><apply id="S4.SS3.p1.10.m10.2.3.cmml" xref="S4.SS3.p1.10.m10.2.3"><times id="S4.SS3.p1.10.m10.2.3.1.cmml" xref="S4.SS3.p1.10.m10.2.3.1"></times><ci id="S4.SS3.p1.10.m10.2.3.2.cmml" xref="S4.SS3.p1.10.m10.2.3.2">Δ</ci><interval closure="open" id="S4.SS3.p1.10.m10.2.3.3.1.cmml" xref="S4.SS3.p1.10.m10.2.3.3.2"><ci id="S4.SS3.p1.10.m10.1.1.cmml" xref="S4.SS3.p1.10.m10.1.1">⋅</ci><ci id="S4.SS3.p1.10.m10.2.2.cmml" xref="S4.SS3.p1.10.m10.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.10.m10.2c">\Delta(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.10.m10.2d">roman_Δ ( ⋅ , ⋅ )</annotation></semantics></math> denotes a specific metric (e.g., ROUGE <cite class="ltx_cite ltx_citemacro_cite">Lin (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib15" title="">2004</a>)</cite> or BLEU <cite class="ltx_cite ltx_citemacro_cite">Post (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib24" title="">2018</a>)</cite>). We note that a high-quality answer <math alttext="\hat{A}" class="ltx_Math" display="inline" id="S4.SS3.p1.11.m11.1"><semantics id="S4.SS3.p1.11.m11.1a"><mover accent="true" id="S4.SS3.p1.11.m11.1.1" xref="S4.SS3.p1.11.m11.1.1.cmml"><mi id="S4.SS3.p1.11.m11.1.1.2" xref="S4.SS3.p1.11.m11.1.1.2.cmml">A</mi><mo id="S4.SS3.p1.11.m11.1.1.1" xref="S4.SS3.p1.11.m11.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.11.m11.1b"><apply id="S4.SS3.p1.11.m11.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1"><ci id="S4.SS3.p1.11.m11.1.1.1.cmml" xref="S4.SS3.p1.11.m11.1.1.1">^</ci><ci id="S4.SS3.p1.11.m11.1.1.2.cmml" xref="S4.SS3.p1.11.m11.1.1.2">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.11.m11.1c">\hat{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.11.m11.1d">over^ start_ARG italic_A end_ARG</annotation></semantics></math> benefits from the selected memories <math alttext="\mathbb{M}" class="ltx_Math" display="inline" id="S4.SS3.p1.12.m12.1"><semantics id="S4.SS3.p1.12.m12.1a"><mi id="S4.SS3.p1.12.m12.1.1" xref="S4.SS3.p1.12.m12.1.1.cmml">𝕄</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.12.m12.1b"><ci id="S4.SS3.p1.12.m12.1.1.cmml" xref="S4.SS3.p1.12.m12.1.1">𝕄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.12.m12.1c">\mathbb{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.12.m12.1d">blackboard_M</annotation></semantics></math>, which can then provide feedback with <math alttext="\Delta(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS3.p1.13.m13.2"><semantics id="S4.SS3.p1.13.m13.2a"><mrow id="S4.SS3.p1.13.m13.2.3" xref="S4.SS3.p1.13.m13.2.3.cmml"><mi id="S4.SS3.p1.13.m13.2.3.2" mathvariant="normal" xref="S4.SS3.p1.13.m13.2.3.2.cmml">Δ</mi><mo id="S4.SS3.p1.13.m13.2.3.1" xref="S4.SS3.p1.13.m13.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p1.13.m13.2.3.3.2" xref="S4.SS3.p1.13.m13.2.3.3.1.cmml"><mo id="S4.SS3.p1.13.m13.2.3.3.2.1" stretchy="false" xref="S4.SS3.p1.13.m13.2.3.3.1.cmml">(</mo><mo id="S4.SS3.p1.13.m13.1.1" lspace="0em" rspace="0em" xref="S4.SS3.p1.13.m13.1.1.cmml">⋅</mo><mo id="S4.SS3.p1.13.m13.2.3.3.2.2" rspace="0em" xref="S4.SS3.p1.13.m13.2.3.3.1.cmml">,</mo><mo id="S4.SS3.p1.13.m13.2.2" lspace="0em" rspace="0em" xref="S4.SS3.p1.13.m13.2.2.cmml">⋅</mo><mo id="S4.SS3.p1.13.m13.2.3.3.2.3" stretchy="false" xref="S4.SS3.p1.13.m13.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.13.m13.2b"><apply id="S4.SS3.p1.13.m13.2.3.cmml" xref="S4.SS3.p1.13.m13.2.3"><times id="S4.SS3.p1.13.m13.2.3.1.cmml" xref="S4.SS3.p1.13.m13.2.3.1"></times><ci id="S4.SS3.p1.13.m13.2.3.2.cmml" xref="S4.SS3.p1.13.m13.2.3.2">Δ</ci><interval closure="open" id="S4.SS3.p1.13.m13.2.3.3.1.cmml" xref="S4.SS3.p1.13.m13.2.3.3.2"><ci id="S4.SS3.p1.13.m13.1.1.cmml" xref="S4.SS3.p1.13.m13.1.1">⋅</ci><ci id="S4.SS3.p1.13.m13.2.2.cmml" xref="S4.SS3.p1.13.m13.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.13.m13.2c">\Delta(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.13.m13.2d">roman_Δ ( ⋅ , ⋅ )</annotation></semantics></math> for subsequent selections. As a result, it iterates in a boosting process, and we optimize it using reinforcement learning. The environment, states, actions, and rewards are introduced below.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.2"><span class="ltx_text ltx_font_bold" id="S4.SS3.p2.2.1">Constructing Environment (Nodes activated by Questions).</span> Given an EMG, which often contains numerous memories in practice. Here, we confine the movement of the RL agent to a subset of memories to facilitate more focused selection. To achieve this, we first retrieve Top-<math alttext="K" class="ltx_Math" display="inline" id="S4.SS3.p2.1.m1.1"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1d">italic_K</annotation></semantics></math> memories for a given question <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS3.p2.2.m2.1"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p2.2.m2.1d">italic_Q</annotation></semantics></math>, and based on these memories, we activate the corresponding nodes on the EMG (e.g., the nodes highlighted in yellow in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.F2" title="Figure 2 ‣ 4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>(b)). Subsequently, the agent’s traversal starts from each activated node via depth-first search.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.1.1">Modeling Memory Selection (Nodes activated by MDPs).</span> We model the graph traversal process as a MDP, involving states, actions, and rewards.</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS3.p4.10.1">States</span>: In the context where we have an input question <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS3.p4.1.m1.1"><semantics id="S4.SS3.p4.1.m1.1a"><mi id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><ci id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.1.m1.1d">italic_Q</annotation></semantics></math>, and visit a node <math alttext="N_{G}" class="ltx_Math" display="inline" id="S4.SS3.p4.2.m2.1"><semantics id="S4.SS3.p4.2.m2.1a"><msub id="S4.SS3.p4.2.m2.1.1" xref="S4.SS3.p4.2.m2.1.1.cmml"><mi id="S4.SS3.p4.2.m2.1.1.2" xref="S4.SS3.p4.2.m2.1.1.2.cmml">N</mi><mi id="S4.SS3.p4.2.m2.1.1.3" xref="S4.SS3.p4.2.m2.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.2.m2.1b"><apply id="S4.SS3.p4.2.m2.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.2.m2.1.1.1.cmml" xref="S4.SS3.p4.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p4.2.m2.1.1.2.cmml" xref="S4.SS3.p4.2.m2.1.1.2">𝑁</ci><ci id="S4.SS3.p4.2.m2.1.1.3.cmml" xref="S4.SS3.p4.2.m2.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.2.m2.1c">N_{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.2.m2.1d">italic_N start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math> (associated with a memory <math alttext="M_{i}" class="ltx_Math" display="inline" id="S4.SS3.p4.3.m3.1"><semantics id="S4.SS3.p4.3.m3.1a"><msub id="S4.SS3.p4.3.m3.1.1" xref="S4.SS3.p4.3.m3.1.1.cmml"><mi id="S4.SS3.p4.3.m3.1.1.2" xref="S4.SS3.p4.3.m3.1.1.2.cmml">M</mi><mi id="S4.SS3.p4.3.m3.1.1.3" xref="S4.SS3.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.3.m3.1b"><apply id="S4.SS3.p4.3.m3.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.3.m3.1.1.1.cmml" xref="S4.SS3.p4.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p4.3.m3.1.1.2.cmml" xref="S4.SS3.p4.3.m3.1.1.2">𝑀</ci><ci id="S4.SS3.p4.3.m3.1.1.3.cmml" xref="S4.SS3.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.3.m3.1c">M_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.3.m3.1d">italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to be included into <math alttext="\mathbb{M}" class="ltx_Math" display="inline" id="S4.SS3.p4.4.m4.1"><semantics id="S4.SS3.p4.4.m4.1a"><mi id="S4.SS3.p4.4.m4.1.1" xref="S4.SS3.p4.4.m4.1.1.cmml">𝕄</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.4.m4.1b"><ci id="S4.SS3.p4.4.m4.1.1.cmml" xref="S4.SS3.p4.4.m4.1.1">𝕄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.4.m4.1c">\mathbb{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.4.m4.1d">blackboard_M</annotation></semantics></math>), and its relation <math alttext="R_{G}" class="ltx_Math" display="inline" id="S4.SS3.p4.5.m5.1"><semantics id="S4.SS3.p4.5.m5.1a"><msub id="S4.SS3.p4.5.m5.1.1" xref="S4.SS3.p4.5.m5.1.1.cmml"><mi id="S4.SS3.p4.5.m5.1.1.2" xref="S4.SS3.p4.5.m5.1.1.2.cmml">R</mi><mi id="S4.SS3.p4.5.m5.1.1.3" xref="S4.SS3.p4.5.m5.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.5.m5.1b"><apply id="S4.SS3.p4.5.m5.1.1.cmml" xref="S4.SS3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.5.m5.1.1.1.cmml" xref="S4.SS3.p4.5.m5.1.1">subscript</csymbol><ci id="S4.SS3.p4.5.m5.1.1.2.cmml" xref="S4.SS3.p4.5.m5.1.1.2">𝑅</ci><ci id="S4.SS3.p4.5.m5.1.1.3.cmml" xref="S4.SS3.p4.5.m5.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.5.m5.1c">R_{G}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.5.m5.1d">italic_R start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math> on the EMG. We first extract the entity <math alttext="N_{Q}" class="ltx_Math" display="inline" id="S4.SS3.p4.6.m6.1"><semantics id="S4.SS3.p4.6.m6.1a"><msub id="S4.SS3.p4.6.m6.1.1" xref="S4.SS3.p4.6.m6.1.1.cmml"><mi id="S4.SS3.p4.6.m6.1.1.2" xref="S4.SS3.p4.6.m6.1.1.2.cmml">N</mi><mi id="S4.SS3.p4.6.m6.1.1.3" xref="S4.SS3.p4.6.m6.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.6.m6.1b"><apply id="S4.SS3.p4.6.m6.1.1.cmml" xref="S4.SS3.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.6.m6.1.1.1.cmml" xref="S4.SS3.p4.6.m6.1.1">subscript</csymbol><ci id="S4.SS3.p4.6.m6.1.1.2.cmml" xref="S4.SS3.p4.6.m6.1.1.2">𝑁</ci><ci id="S4.SS3.p4.6.m6.1.1.3.cmml" xref="S4.SS3.p4.6.m6.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.6.m6.1c">N_{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.6.m6.1d">italic_N start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> and relation <math alttext="R_{Q}" class="ltx_Math" display="inline" id="S4.SS3.p4.7.m7.1"><semantics id="S4.SS3.p4.7.m7.1a"><msub id="S4.SS3.p4.7.m7.1.1" xref="S4.SS3.p4.7.m7.1.1.cmml"><mi id="S4.SS3.p4.7.m7.1.1.2" xref="S4.SS3.p4.7.m7.1.1.2.cmml">R</mi><mi id="S4.SS3.p4.7.m7.1.1.3" xref="S4.SS3.p4.7.m7.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.7.m7.1b"><apply id="S4.SS3.p4.7.m7.1.1.cmml" xref="S4.SS3.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS3.p4.7.m7.1.1.1.cmml" xref="S4.SS3.p4.7.m7.1.1">subscript</csymbol><ci id="S4.SS3.p4.7.m7.1.1.2.cmml" xref="S4.SS3.p4.7.m7.1.1.2">𝑅</ci><ci id="S4.SS3.p4.7.m7.1.1.3.cmml" xref="S4.SS3.p4.7.m7.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.7.m7.1c">R_{Q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.7.m7.1d">italic_R start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT</annotation></semantics></math> from the <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS3.p4.8.m8.1"><semantics id="S4.SS3.p4.8.m8.1a"><mi id="S4.SS3.p4.8.m8.1.1" xref="S4.SS3.p4.8.m8.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.8.m8.1b"><ci id="S4.SS3.p4.8.m8.1.1.cmml" xref="S4.SS3.p4.8.m8.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.8.m8.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.8.m8.1d">italic_Q</annotation></semantics></math>, and the state <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S4.SS3.p4.9.m9.1"><semantics id="S4.SS3.p4.9.m9.1a"><mi id="S4.SS3.p4.9.m9.1.1" xref="S4.SS3.p4.9.m9.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.9.m9.1b"><ci id="S4.SS3.p4.9.m9.1.1.cmml" xref="S4.SS3.p4.9.m9.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.9.m9.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.9.m9.1d">bold_s</annotation></semantics></math> is defined by three cosine similarities <math alttext="C(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS3.p4.10.m10.2"><semantics id="S4.SS3.p4.10.m10.2a"><mrow id="S4.SS3.p4.10.m10.2.3" xref="S4.SS3.p4.10.m10.2.3.cmml"><mi id="S4.SS3.p4.10.m10.2.3.2" xref="S4.SS3.p4.10.m10.2.3.2.cmml">C</mi><mo id="S4.SS3.p4.10.m10.2.3.1" xref="S4.SS3.p4.10.m10.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p4.10.m10.2.3.3.2" xref="S4.SS3.p4.10.m10.2.3.3.1.cmml"><mo id="S4.SS3.p4.10.m10.2.3.3.2.1" stretchy="false" xref="S4.SS3.p4.10.m10.2.3.3.1.cmml">(</mo><mo id="S4.SS3.p4.10.m10.1.1" lspace="0em" rspace="0em" xref="S4.SS3.p4.10.m10.1.1.cmml">⋅</mo><mo id="S4.SS3.p4.10.m10.2.3.3.2.2" rspace="0em" xref="S4.SS3.p4.10.m10.2.3.3.1.cmml">,</mo><mo id="S4.SS3.p4.10.m10.2.2" lspace="0em" rspace="0em" xref="S4.SS3.p4.10.m10.2.2.cmml">⋅</mo><mo id="S4.SS3.p4.10.m10.2.3.3.2.3" stretchy="false" xref="S4.SS3.p4.10.m10.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.10.m10.2b"><apply id="S4.SS3.p4.10.m10.2.3.cmml" xref="S4.SS3.p4.10.m10.2.3"><times id="S4.SS3.p4.10.m10.2.3.1.cmml" xref="S4.SS3.p4.10.m10.2.3.1"></times><ci id="S4.SS3.p4.10.m10.2.3.2.cmml" xref="S4.SS3.p4.10.m10.2.3.2">𝐶</ci><interval closure="open" id="S4.SS3.p4.10.m10.2.3.3.1.cmml" xref="S4.SS3.p4.10.m10.2.3.3.2"><ci id="S4.SS3.p4.10.m10.1.1.cmml" xref="S4.SS3.p4.10.m10.1.1">⋅</ci><ci id="S4.SS3.p4.10.m10.2.2.cmml" xref="S4.SS3.p4.10.m10.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.10.m10.2c">C(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p4.10.m10.2d">italic_C ( ⋅ , ⋅ )</annotation></semantics></math>, i.e.,</p>
</div>
<div class="ltx_para" id="S4.SS3.p5">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S4.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{s}=\{C(\mathbf{v}_{N_{Q}},\mathbf{v}_{N_{G}}),C(\mathbf{v%
}_{R_{Q}},\mathbf{v}_{R_{G}}),C(\mathbf{v}_{Q},\mathbf{v}_{M_{i}})\}," class="ltx_Math" display="inline" id="S4.E1.m1.1"><semantics id="S4.E1.m1.1a"><mrow id="S4.E1.m1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml"><mrow id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.5" xref="S4.E1.m1.1.1.1.1.5.cmml">𝐬</mi><mo id="S4.E1.m1.1.1.1.1.4" xref="S4.E1.m1.1.1.1.1.4.cmml">=</mo><mrow id="S4.E1.m1.1.1.1.1.3.3" xref="S4.E1.m1.1.1.1.1.3.4.cmml"><mo id="S4.E1.m1.1.1.1.1.3.3.4" stretchy="false" xref="S4.E1.m1.1.1.1.1.3.4.cmml">{</mo><mrow id="S4.E1.m1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.4" xref="S4.E1.m1.1.1.1.1.1.1.1.4.cmml">C</mi><mo id="S4.E1.m1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S4.E1.m1.1.1.1.1.1.1.1.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S4.E1.m1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S4.E1.m1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><msub id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">N</mi><mi id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msub></msub><mo id="S4.E1.m1.1.1.1.1.1.1.1.2.2.4" xref="S4.E1.m1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐯</mi><msub id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.2" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.2.cmml">N</mi><mi id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">G</mi></msub></msub><mo id="S4.E1.m1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="S4.E1.m1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.1.1.1.1.3.3.5" xref="S4.E1.m1.1.1.1.1.3.4.cmml">,</mo><mrow id="S4.E1.m1.1.1.1.1.2.2.2" xref="S4.E1.m1.1.1.1.1.2.2.2.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.2.4" xref="S4.E1.m1.1.1.1.1.2.2.2.4.cmml">C</mi><mo id="S4.E1.m1.1.1.1.1.2.2.2.3" xref="S4.E1.m1.1.1.1.1.2.2.2.3.cmml">⁢</mo><mrow id="S4.E1.m1.1.1.1.1.2.2.2.2.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.cmml"><mo id="S4.E1.m1.1.1.1.1.2.2.2.2.2.3" stretchy="false" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.cmml">(</mo><msub id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.2" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.2.cmml">𝐯</mi><msub id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.2" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.2.cmml">R</mi><mi id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.3" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.3.cmml">Q</mi></msub></msub><mo id="S4.E1.m1.1.1.1.1.2.2.2.2.2.4" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.cmml">,</mo><msub id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml">𝐯</mi><msub id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml"><mi id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.2" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.2.cmml">R</mi><mi id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.3" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.3.cmml">G</mi></msub></msub><mo id="S4.E1.m1.1.1.1.1.2.2.2.2.2.5" stretchy="false" xref="S4.E1.m1.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.1.1.1.1.3.3.6" xref="S4.E1.m1.1.1.1.1.3.4.cmml">,</mo><mrow id="S4.E1.m1.1.1.1.1.3.3.3" xref="S4.E1.m1.1.1.1.1.3.3.3.cmml"><mi id="S4.E1.m1.1.1.1.1.3.3.3.4" xref="S4.E1.m1.1.1.1.1.3.3.3.4.cmml">C</mi><mo id="S4.E1.m1.1.1.1.1.3.3.3.3" xref="S4.E1.m1.1.1.1.1.3.3.3.3.cmml">⁢</mo><mrow id="S4.E1.m1.1.1.1.1.3.3.3.2.2" xref="S4.E1.m1.1.1.1.1.3.3.3.2.3.cmml"><mo id="S4.E1.m1.1.1.1.1.3.3.3.2.2.3" stretchy="false" xref="S4.E1.m1.1.1.1.1.3.3.3.2.3.cmml">(</mo><msub id="S4.E1.m1.1.1.1.1.3.3.3.1.1.1" xref="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.cmml"><mi id="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.2" xref="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.2.cmml">𝐯</mi><mi id="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.3" xref="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.3.cmml">Q</mi></msub><mo id="S4.E1.m1.1.1.1.1.3.3.3.2.2.4" xref="S4.E1.m1.1.1.1.1.3.3.3.2.3.cmml">,</mo><msub id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.cmml"><mi id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.2" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.2.cmml">𝐯</mi><msub id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.cmml"><mi id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.2" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.2.cmml">M</mi><mi id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.3" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.3.cmml">i</mi></msub></msub><mo id="S4.E1.m1.1.1.1.1.3.3.3.2.2.5" stretchy="false" xref="S4.E1.m1.1.1.1.1.3.3.3.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.1.1.1.1.3.3.7" stretchy="false" xref="S4.E1.m1.1.1.1.1.3.4.cmml">}</mo></mrow></mrow><mo id="S4.E1.m1.1.1.1.2" xref="S4.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.1b"><apply id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1"><eq id="S4.E1.m1.1.1.1.1.4.cmml" xref="S4.E1.m1.1.1.1.1.4"></eq><ci id="S4.E1.m1.1.1.1.1.5.cmml" xref="S4.E1.m1.1.1.1.1.5">𝐬</ci><set id="S4.E1.m1.1.1.1.1.3.4.cmml" xref="S4.E1.m1.1.1.1.1.3.3"><apply id="S4.E1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1"><times id="S4.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.3"></times><ci id="S4.E1.m1.1.1.1.1.1.1.1.4.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.4">𝐶</ci><interval closure="open" id="S4.E1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2"><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.2">𝐯</ci><apply id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑁</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.2">𝐯</ci><apply id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.2">𝑁</ci><ci id="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S4.E1.m1.1.1.1.1.1.1.1.2.2.2.3.3">𝐺</ci></apply></apply></interval></apply><apply id="S4.E1.m1.1.1.1.1.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2"><times id="S4.E1.m1.1.1.1.1.2.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.3"></times><ci id="S4.E1.m1.1.1.1.1.2.2.2.4.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.4">𝐶</ci><interval closure="open" id="S4.E1.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2"><apply id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.2">𝐯</ci><apply id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.2">𝑅</ci><ci id="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.1.1.1.3.3">𝑄</ci></apply></apply><apply id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.2">𝐯</ci><apply id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.1.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.2.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.2">𝑅</ci><ci id="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.3.cmml" xref="S4.E1.m1.1.1.1.1.2.2.2.2.2.2.3.3">𝐺</ci></apply></apply></interval></apply><apply id="S4.E1.m1.1.1.1.1.3.3.3.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3"><times id="S4.E1.m1.1.1.1.1.3.3.3.3.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.3"></times><ci id="S4.E1.m1.1.1.1.1.3.3.3.4.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.4">𝐶</ci><interval closure="open" id="S4.E1.m1.1.1.1.1.3.3.3.2.3.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2"><apply id="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.1.1.1">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.2.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.2">𝐯</ci><ci id="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.3.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.1.1.1.3">𝑄</ci></apply><apply id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.1.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.2.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.2">𝐯</ci><apply id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.1.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3">subscript</csymbol><ci id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.2.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.2">𝑀</ci><ci id="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.3.cmml" xref="S4.E1.m1.1.1.1.1.3.3.3.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.1c">\displaystyle\mathbf{s}=\{C(\mathbf{v}_{N_{Q}},\mathbf{v}_{N_{G}}),C(\mathbf{v%
}_{R_{Q}},\mathbf{v}_{R_{G}}),C(\mathbf{v}_{Q},\mathbf{v}_{M_{i}})\},</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.1d">bold_s = { italic_C ( bold_v start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_v start_POSTSUBSCRIPT italic_N start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) , italic_C ( bold_v start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT end_POSTSUBSCRIPT , bold_v start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) , italic_C ( bold_v start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT , bold_v start_POSTSUBSCRIPT italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) } ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p5.1">where <math alttext="\mathbf{v}_{\cdot}" class="ltx_Math" display="inline" id="S4.SS3.p5.1.m1.1"><semantics id="S4.SS3.p5.1.m1.1a"><msub id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><mi id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">𝐯</mi><mo id="S4.SS3.p5.1.m1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.3.cmml">⋅</mo></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p5.1.m1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.2">𝐯</ci><ci id="S4.SS3.p5.1.m1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">\mathbf{v}_{\cdot}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.1.m1.1d">bold_v start_POSTSUBSCRIPT ⋅ end_POSTSUBSCRIPT</annotation></semantics></math> denotes the embedding vector for entities, relations, questions, or memories.</p>
</div>
<div class="ltx_para" id="S4.SS3.p6">
<p class="ltx_p" id="S4.SS3.p6.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS3.p6.4.1">Actions</span>: We denote an action as <math alttext="a" class="ltx_Math" display="inline" id="S4.SS3.p6.1.m1.1"><semantics id="S4.SS3.p6.1.m1.1a"><mi id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><ci id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.1.m1.1d">italic_a</annotation></semantics></math>, and it has two choices during the graph traversal: including the visiting memory <math alttext="M_{i}" class="ltx_Math" display="inline" id="S4.SS3.p6.2.m2.1"><semantics id="S4.SS3.p6.2.m2.1a"><msub id="S4.SS3.p6.2.m2.1.1" xref="S4.SS3.p6.2.m2.1.1.cmml"><mi id="S4.SS3.p6.2.m2.1.1.2" xref="S4.SS3.p6.2.m2.1.1.2.cmml">M</mi><mi id="S4.SS3.p6.2.m2.1.1.3" xref="S4.SS3.p6.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m2.1b"><apply id="S4.SS3.p6.2.m2.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m2.1.1.1.cmml" xref="S4.SS3.p6.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p6.2.m2.1.1.2.cmml" xref="S4.SS3.p6.2.m2.1.1.2">𝑀</ci><ci id="S4.SS3.p6.2.m2.1.1.3.cmml" xref="S4.SS3.p6.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m2.1c">M_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.2.m2.1d">italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> into <math alttext="\mathbb{M}" class="ltx_Math" display="inline" id="S4.SS3.p6.3.m3.1"><semantics id="S4.SS3.p6.3.m3.1a"><mi id="S4.SS3.p6.3.m3.1.1" xref="S4.SS3.p6.3.m3.1.1.cmml">𝕄</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.3.m3.1b"><ci id="S4.SS3.p6.3.m3.1.1.cmml" xref="S4.SS3.p6.3.m3.1.1">𝕄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.3.m3.1c">\mathbb{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.3.m3.1d">blackboard_M</annotation></semantics></math>, and searching its connected nodes; or stopping the current search, and restarting a search from other branches. Thus, the action <math alttext="a" class="ltx_Math" display="inline" id="S4.SS3.p6.4.m4.1"><semantics id="S4.SS3.p6.4.m4.1a"><mi id="S4.SS3.p6.4.m4.1.1" xref="S4.SS3.p6.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.4.m4.1b"><ci id="S4.SS3.p6.4.m4.1.1.cmml" xref="S4.SS3.p6.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.4.m4.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.4.m4.1d">italic_a</annotation></semantics></math> is defined as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx2">
<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle a=1\text{ (including)}\ \text{or}\ 0\text{ (stopping)}." class="ltx_Math" display="inline" id="S4.E2.m1.1"><semantics id="S4.E2.m1.1a"><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><mrow id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.2.cmml">a</mi><mo id="S4.E2.m1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E2.m1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.3.cmml"><mn id="S4.E2.m1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.3.2.cmml">1</mn><mo id="S4.E2.m1.1.1.1.1.3.1" xref="S4.E2.m1.1.1.1.1.3.1.cmml">⁢</mo><mtext id="S4.E2.m1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.3.3a.cmml"> (including)</mtext><mo id="S4.E2.m1.1.1.1.1.3.1a" lspace="0.500em" xref="S4.E2.m1.1.1.1.1.3.1.cmml">⁢</mo><mtext id="S4.E2.m1.1.1.1.1.3.4" xref="S4.E2.m1.1.1.1.1.3.4a.cmml">or</mtext><mo id="S4.E2.m1.1.1.1.1.3.1b" xref="S4.E2.m1.1.1.1.1.3.1.cmml">⁢</mo><mn id="S4.E2.m1.1.1.1.1.3.5" xref="S4.E2.m1.1.1.1.1.3.5.cmml"> 0</mn><mo id="S4.E2.m1.1.1.1.1.3.1c" xref="S4.E2.m1.1.1.1.1.3.1.cmml">⁢</mo><mtext id="S4.E2.m1.1.1.1.1.3.6" xref="S4.E2.m1.1.1.1.1.3.6a.cmml"> (stopping)</mtext></mrow></mrow><mo id="S4.E2.m1.1.1.1.2" lspace="0em" xref="S4.E2.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><eq id="S4.E2.m1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1"></eq><ci id="S4.E2.m1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.2">𝑎</ci><apply id="S4.E2.m1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.3"><times id="S4.E2.m1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.3.1"></times><cn id="S4.E2.m1.1.1.1.1.3.2.cmml" type="integer" xref="S4.E2.m1.1.1.1.1.3.2">1</cn><ci id="S4.E2.m1.1.1.1.1.3.3a.cmml" xref="S4.E2.m1.1.1.1.1.3.3"><mtext id="S4.E2.m1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.3.3"> (including)</mtext></ci><ci id="S4.E2.m1.1.1.1.1.3.4a.cmml" xref="S4.E2.m1.1.1.1.1.3.4"><mtext id="S4.E2.m1.1.1.1.1.3.4.cmml" xref="S4.E2.m1.1.1.1.1.3.4">or</mtext></ci><cn id="S4.E2.m1.1.1.1.1.3.5.cmml" type="float" xref="S4.E2.m1.1.1.1.1.3.5"> 0</cn><ci id="S4.E2.m1.1.1.1.1.3.6a.cmml" xref="S4.E2.m1.1.1.1.1.3.6"><mtext id="S4.E2.m1.1.1.1.1.3.6.cmml" xref="S4.E2.m1.1.1.1.1.3.6"> (stopping)</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\displaystyle a=1\text{ (including)}\ \text{or}\ 0\text{ (stopping)}.</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.1d">italic_a = 1 (including) or 0 (stopping) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p6.5">Consider the consequence of performing an action, it transitions the environment to the next state <math alttext="\mathbf{s}^{\prime}" class="ltx_Math" display="inline" id="S4.SS3.p6.5.m1.1"><semantics id="S4.SS3.p6.5.m1.1a"><msup id="S4.SS3.p6.5.m1.1.1" xref="S4.SS3.p6.5.m1.1.1.cmml"><mi id="S4.SS3.p6.5.m1.1.1.2" xref="S4.SS3.p6.5.m1.1.1.2.cmml">𝐬</mi><mo id="S4.SS3.p6.5.m1.1.1.3" xref="S4.SS3.p6.5.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.5.m1.1b"><apply id="S4.SS3.p6.5.m1.1.1.cmml" xref="S4.SS3.p6.5.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.5.m1.1.1.1.cmml" xref="S4.SS3.p6.5.m1.1.1">superscript</csymbol><ci id="S4.SS3.p6.5.m1.1.1.2.cmml" xref="S4.SS3.p6.5.m1.1.1.2">𝐬</ci><ci id="S4.SS3.p6.5.m1.1.1.3.cmml" xref="S4.SS3.p6.5.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.5.m1.1c">\mathbf{s}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p6.5.m1.1d">bold_s start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, and affects which memory to be selected for constructing the state.</p>
</div>
<div class="ltx_para" id="S4.SS3.p7">
<p class="ltx_p" id="S4.SS3.p7.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS3.p7.11.1">Rewards</span>: We denote the reward as <math alttext="r" class="ltx_Math" display="inline" id="S4.SS3.p7.1.m1.1"><semantics id="S4.SS3.p7.1.m1.1a"><mi id="S4.SS3.p7.1.m1.1.1" xref="S4.SS3.p7.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.1.m1.1b"><ci id="S4.SS3.p7.1.m1.1.1.cmml" xref="S4.SS3.p7.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.1.m1.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.1.m1.1d">italic_r</annotation></semantics></math>, which corresponds to the transition from the current state <math alttext="\mathbf{s}_{t}" class="ltx_Math" display="inline" id="S4.SS3.p7.2.m2.1"><semantics id="S4.SS3.p7.2.m2.1a"><msub id="S4.SS3.p7.2.m2.1.1" xref="S4.SS3.p7.2.m2.1.1.cmml"><mi id="S4.SS3.p7.2.m2.1.1.2" xref="S4.SS3.p7.2.m2.1.1.2.cmml">𝐬</mi><mi id="S4.SS3.p7.2.m2.1.1.3" xref="S4.SS3.p7.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.2.m2.1b"><apply id="S4.SS3.p7.2.m2.1.1.cmml" xref="S4.SS3.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.2.m2.1.1.1.cmml" xref="S4.SS3.p7.2.m2.1.1">subscript</csymbol><ci id="S4.SS3.p7.2.m2.1.1.2.cmml" xref="S4.SS3.p7.2.m2.1.1.2">𝐬</ci><ci id="S4.SS3.p7.2.m2.1.1.3.cmml" xref="S4.SS3.p7.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.2.m2.1c">\mathbf{s}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.2.m2.1d">bold_s start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> to the next state <math alttext="\mathbf{s}_{t+1}" class="ltx_Math" display="inline" id="S4.SS3.p7.3.m3.1"><semantics id="S4.SS3.p7.3.m3.1a"><msub id="S4.SS3.p7.3.m3.1.1" xref="S4.SS3.p7.3.m3.1.1.cmml"><mi id="S4.SS3.p7.3.m3.1.1.2" xref="S4.SS3.p7.3.m3.1.1.2.cmml">𝐬</mi><mrow id="S4.SS3.p7.3.m3.1.1.3" xref="S4.SS3.p7.3.m3.1.1.3.cmml"><mi id="S4.SS3.p7.3.m3.1.1.3.2" xref="S4.SS3.p7.3.m3.1.1.3.2.cmml">t</mi><mo id="S4.SS3.p7.3.m3.1.1.3.1" xref="S4.SS3.p7.3.m3.1.1.3.1.cmml">+</mo><mn id="S4.SS3.p7.3.m3.1.1.3.3" xref="S4.SS3.p7.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.3.m3.1b"><apply id="S4.SS3.p7.3.m3.1.1.cmml" xref="S4.SS3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.3.m3.1.1.1.cmml" xref="S4.SS3.p7.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p7.3.m3.1.1.2.cmml" xref="S4.SS3.p7.3.m3.1.1.2">𝐬</ci><apply id="S4.SS3.p7.3.m3.1.1.3.cmml" xref="S4.SS3.p7.3.m3.1.1.3"><plus id="S4.SS3.p7.3.m3.1.1.3.1.cmml" xref="S4.SS3.p7.3.m3.1.1.3.1"></plus><ci id="S4.SS3.p7.3.m3.1.1.3.2.cmml" xref="S4.SS3.p7.3.m3.1.1.3.2">𝑡</ci><cn id="S4.SS3.p7.3.m3.1.1.3.3.cmml" type="integer" xref="S4.SS3.p7.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.3.m3.1c">\mathbf{s}_{t+1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.3.m3.1d">bold_s start_POSTSUBSCRIPT italic_t + 1 end_POSTSUBSCRIPT</annotation></semantics></math> after taking action <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.SS3.p7.4.m4.1"><semantics id="S4.SS3.p7.4.m4.1a"><msub id="S4.SS3.p7.4.m4.1.1" xref="S4.SS3.p7.4.m4.1.1.cmml"><mi id="S4.SS3.p7.4.m4.1.1.2" xref="S4.SS3.p7.4.m4.1.1.2.cmml">a</mi><mi id="S4.SS3.p7.4.m4.1.1.3" xref="S4.SS3.p7.4.m4.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.4.m4.1b"><apply id="S4.SS3.p7.4.m4.1.1.cmml" xref="S4.SS3.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.4.m4.1.1.1.cmml" xref="S4.SS3.p7.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p7.4.m4.1.1.2.cmml" xref="S4.SS3.p7.4.m4.1.1.2">𝑎</ci><ci id="S4.SS3.p7.4.m4.1.1.3.cmml" xref="S4.SS3.p7.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.4.m4.1c">a_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.4.m4.1d">italic_a start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. Specifically, when a memory <math alttext="M" class="ltx_Math" display="inline" id="S4.SS3.p7.5.m5.1"><semantics id="S4.SS3.p7.5.m5.1a"><mi id="S4.SS3.p7.5.m5.1.1" xref="S4.SS3.p7.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.5.m5.1b"><ci id="S4.SS3.p7.5.m5.1.1.cmml" xref="S4.SS3.p7.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.5.m5.1c">M</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.5.m5.1d">italic_M</annotation></semantics></math> is selected into <math alttext="\mathbb{M}" class="ltx_Math" display="inline" id="S4.SS3.p7.6.m6.1"><semantics id="S4.SS3.p7.6.m6.1a"><mi id="S4.SS3.p7.6.m6.1.1" xref="S4.SS3.p7.6.m6.1.1.cmml">𝕄</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.6.m6.1b"><ci id="S4.SS3.p7.6.m6.1.1.cmml" xref="S4.SS3.p7.6.m6.1.1">𝕄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.6.m6.1c">\mathbb{M}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.6.m6.1d">blackboard_M</annotation></semantics></math>, the generated answer by a LLM changes from <math alttext="\hat{A}" class="ltx_Math" display="inline" id="S4.SS3.p7.7.m7.1"><semantics id="S4.SS3.p7.7.m7.1a"><mover accent="true" id="S4.SS3.p7.7.m7.1.1" xref="S4.SS3.p7.7.m7.1.1.cmml"><mi id="S4.SS3.p7.7.m7.1.1.2" xref="S4.SS3.p7.7.m7.1.1.2.cmml">A</mi><mo id="S4.SS3.p7.7.m7.1.1.1" xref="S4.SS3.p7.7.m7.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.7.m7.1b"><apply id="S4.SS3.p7.7.m7.1.1.cmml" xref="S4.SS3.p7.7.m7.1.1"><ci id="S4.SS3.p7.7.m7.1.1.1.cmml" xref="S4.SS3.p7.7.m7.1.1.1">^</ci><ci id="S4.SS3.p7.7.m7.1.1.2.cmml" xref="S4.SS3.p7.7.m7.1.1.2">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.7.m7.1c">\hat{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.7.m7.1d">over^ start_ARG italic_A end_ARG</annotation></semantics></math> to <math alttext="\hat{A}^{\prime}" class="ltx_Math" display="inline" id="S4.SS3.p7.8.m8.1"><semantics id="S4.SS3.p7.8.m8.1a"><msup id="S4.SS3.p7.8.m8.1.1" xref="S4.SS3.p7.8.m8.1.1.cmml"><mover accent="true" id="S4.SS3.p7.8.m8.1.1.2" xref="S4.SS3.p7.8.m8.1.1.2.cmml"><mi id="S4.SS3.p7.8.m8.1.1.2.2" xref="S4.SS3.p7.8.m8.1.1.2.2.cmml">A</mi><mo id="S4.SS3.p7.8.m8.1.1.2.1" xref="S4.SS3.p7.8.m8.1.1.2.1.cmml">^</mo></mover><mo id="S4.SS3.p7.8.m8.1.1.3" xref="S4.SS3.p7.8.m8.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.8.m8.1b"><apply id="S4.SS3.p7.8.m8.1.1.cmml" xref="S4.SS3.p7.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.8.m8.1.1.1.cmml" xref="S4.SS3.p7.8.m8.1.1">superscript</csymbol><apply id="S4.SS3.p7.8.m8.1.1.2.cmml" xref="S4.SS3.p7.8.m8.1.1.2"><ci id="S4.SS3.p7.8.m8.1.1.2.1.cmml" xref="S4.SS3.p7.8.m8.1.1.2.1">^</ci><ci id="S4.SS3.p7.8.m8.1.1.2.2.cmml" xref="S4.SS3.p7.8.m8.1.1.2.2">𝐴</ci></apply><ci id="S4.SS3.p7.8.m8.1.1.3.cmml" xref="S4.SS3.p7.8.m8.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.8.m8.1c">\hat{A}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.8.m8.1d">over^ start_ARG italic_A end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> accordingly. The quality of the generated answer <math alttext="\hat{A}" class="ltx_Math" display="inline" id="S4.SS3.p7.9.m9.1"><semantics id="S4.SS3.p7.9.m9.1a"><mover accent="true" id="S4.SS3.p7.9.m9.1.1" xref="S4.SS3.p7.9.m9.1.1.cmml"><mi id="S4.SS3.p7.9.m9.1.1.2" xref="S4.SS3.p7.9.m9.1.1.2.cmml">A</mi><mo id="S4.SS3.p7.9.m9.1.1.1" xref="S4.SS3.p7.9.m9.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.9.m9.1b"><apply id="S4.SS3.p7.9.m9.1.1.cmml" xref="S4.SS3.p7.9.m9.1.1"><ci id="S4.SS3.p7.9.m9.1.1.1.cmml" xref="S4.SS3.p7.9.m9.1.1.1">^</ci><ci id="S4.SS3.p7.9.m9.1.1.2.cmml" xref="S4.SS3.p7.9.m9.1.1.2">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.9.m9.1c">\hat{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.9.m9.1d">over^ start_ARG italic_A end_ARG</annotation></semantics></math> is evaluated using a specific metric <math alttext="\Delta(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS3.p7.10.m10.2"><semantics id="S4.SS3.p7.10.m10.2a"><mrow id="S4.SS3.p7.10.m10.2.3" xref="S4.SS3.p7.10.m10.2.3.cmml"><mi id="S4.SS3.p7.10.m10.2.3.2" mathvariant="normal" xref="S4.SS3.p7.10.m10.2.3.2.cmml">Δ</mi><mo id="S4.SS3.p7.10.m10.2.3.1" xref="S4.SS3.p7.10.m10.2.3.1.cmml">⁢</mo><mrow id="S4.SS3.p7.10.m10.2.3.3.2" xref="S4.SS3.p7.10.m10.2.3.3.1.cmml"><mo id="S4.SS3.p7.10.m10.2.3.3.2.1" stretchy="false" xref="S4.SS3.p7.10.m10.2.3.3.1.cmml">(</mo><mo id="S4.SS3.p7.10.m10.1.1" lspace="0em" rspace="0em" xref="S4.SS3.p7.10.m10.1.1.cmml">⋅</mo><mo id="S4.SS3.p7.10.m10.2.3.3.2.2" rspace="0em" xref="S4.SS3.p7.10.m10.2.3.3.1.cmml">,</mo><mo id="S4.SS3.p7.10.m10.2.2" lspace="0em" rspace="0em" xref="S4.SS3.p7.10.m10.2.2.cmml">⋅</mo><mo id="S4.SS3.p7.10.m10.2.3.3.2.3" stretchy="false" xref="S4.SS3.p7.10.m10.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.10.m10.2b"><apply id="S4.SS3.p7.10.m10.2.3.cmml" xref="S4.SS3.p7.10.m10.2.3"><times id="S4.SS3.p7.10.m10.2.3.1.cmml" xref="S4.SS3.p7.10.m10.2.3.1"></times><ci id="S4.SS3.p7.10.m10.2.3.2.cmml" xref="S4.SS3.p7.10.m10.2.3.2">Δ</ci><interval closure="open" id="S4.SS3.p7.10.m10.2.3.3.1.cmml" xref="S4.SS3.p7.10.m10.2.3.3.2"><ci id="S4.SS3.p7.10.m10.1.1.cmml" xref="S4.SS3.p7.10.m10.1.1">⋅</ci><ci id="S4.SS3.p7.10.m10.2.2.cmml" xref="S4.SS3.p7.10.m10.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.10.m10.2c">\Delta(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.10.m10.2d">roman_Δ ( ⋅ , ⋅ )</annotation></semantics></math> (e.g., ROUGE or BLEU), and the reward <math alttext="r" class="ltx_Math" display="inline" id="S4.SS3.p7.11.m11.1"><semantics id="S4.SS3.p7.11.m11.1a"><mi id="S4.SS3.p7.11.m11.1.1" xref="S4.SS3.p7.11.m11.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.11.m11.1b"><ci id="S4.SS3.p7.11.m11.1.1.cmml" xref="S4.SS3.p7.11.m11.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.11.m11.1c">r</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.11.m11.1d">italic_r</annotation></semantics></math> is defined as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx3">
<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle r=\Delta(\hat{A}^{\prime},A)-\Delta(\hat{A},A)," class="ltx_Math" display="inline" id="S4.E3.m1.4"><semantics id="S4.E3.m1.4a"><mrow id="S4.E3.m1.4.4.1" xref="S4.E3.m1.4.4.1.1.cmml"><mrow id="S4.E3.m1.4.4.1.1" xref="S4.E3.m1.4.4.1.1.cmml"><mi id="S4.E3.m1.4.4.1.1.3" xref="S4.E3.m1.4.4.1.1.3.cmml">r</mi><mo id="S4.E3.m1.4.4.1.1.2" xref="S4.E3.m1.4.4.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.4.4.1.1.1" xref="S4.E3.m1.4.4.1.1.1.cmml"><mrow id="S4.E3.m1.4.4.1.1.1.1" xref="S4.E3.m1.4.4.1.1.1.1.cmml"><mi id="S4.E3.m1.4.4.1.1.1.1.3" mathvariant="normal" xref="S4.E3.m1.4.4.1.1.1.1.3.cmml">Δ</mi><mo id="S4.E3.m1.4.4.1.1.1.1.2" xref="S4.E3.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.4.4.1.1.1.1.1.1" xref="S4.E3.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S4.E3.m1.4.4.1.1.1.1.1.2.cmml">(</mo><msup id="S4.E3.m1.4.4.1.1.1.1.1.1.1" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E3.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">A</mi><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.1.2.1" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.3" xref="S4.E3.m1.4.4.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml">A</mi><mo id="S4.E3.m1.4.4.1.1.1.1.1.1.4" stretchy="false" xref="S4.E3.m1.4.4.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.4.4.1.1.1.2" xref="S4.E3.m1.4.4.1.1.1.2.cmml">−</mo><mrow id="S4.E3.m1.4.4.1.1.1.3" xref="S4.E3.m1.4.4.1.1.1.3.cmml"><mi id="S4.E3.m1.4.4.1.1.1.3.2" mathvariant="normal" xref="S4.E3.m1.4.4.1.1.1.3.2.cmml">Δ</mi><mo id="S4.E3.m1.4.4.1.1.1.3.1" xref="S4.E3.m1.4.4.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.E3.m1.4.4.1.1.1.3.3.2" xref="S4.E3.m1.4.4.1.1.1.3.3.1.cmml"><mo id="S4.E3.m1.4.4.1.1.1.3.3.2.1" stretchy="false" xref="S4.E3.m1.4.4.1.1.1.3.3.1.cmml">(</mo><mover accent="true" id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml"><mi id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.2.cmml">A</mi><mo id="S4.E3.m1.2.2.1" xref="S4.E3.m1.2.2.1.cmml">^</mo></mover><mo id="S4.E3.m1.4.4.1.1.1.3.3.2.2" xref="S4.E3.m1.4.4.1.1.1.3.3.1.cmml">,</mo><mi id="S4.E3.m1.3.3" xref="S4.E3.m1.3.3.cmml">A</mi><mo id="S4.E3.m1.4.4.1.1.1.3.3.2.3" stretchy="false" xref="S4.E3.m1.4.4.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E3.m1.4.4.1.2" xref="S4.E3.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.4b"><apply id="S4.E3.m1.4.4.1.1.cmml" xref="S4.E3.m1.4.4.1"><eq id="S4.E3.m1.4.4.1.1.2.cmml" xref="S4.E3.m1.4.4.1.1.2"></eq><ci id="S4.E3.m1.4.4.1.1.3.cmml" xref="S4.E3.m1.4.4.1.1.3">𝑟</ci><apply id="S4.E3.m1.4.4.1.1.1.cmml" xref="S4.E3.m1.4.4.1.1.1"><minus id="S4.E3.m1.4.4.1.1.1.2.cmml" xref="S4.E3.m1.4.4.1.1.1.2"></minus><apply id="S4.E3.m1.4.4.1.1.1.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1"><times id="S4.E3.m1.4.4.1.1.1.1.2.cmml" xref="S4.E3.m1.4.4.1.1.1.1.2"></times><ci id="S4.E3.m1.4.4.1.1.1.1.3.cmml" xref="S4.E3.m1.4.4.1.1.1.1.3">Δ</ci><interval closure="open" id="S4.E3.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1"><apply id="S4.E3.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E3.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.2"><ci id="S4.E3.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E3.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.2.2">𝐴</ci></apply><ci id="S4.E3.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.4.4.1.1.1.1.1.1.1.3">′</ci></apply><ci id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1">𝐴</ci></interval></apply><apply id="S4.E3.m1.4.4.1.1.1.3.cmml" xref="S4.E3.m1.4.4.1.1.1.3"><times id="S4.E3.m1.4.4.1.1.1.3.1.cmml" xref="S4.E3.m1.4.4.1.1.1.3.1"></times><ci id="S4.E3.m1.4.4.1.1.1.3.2.cmml" xref="S4.E3.m1.4.4.1.1.1.3.2">Δ</ci><interval closure="open" id="S4.E3.m1.4.4.1.1.1.3.3.1.cmml" xref="S4.E3.m1.4.4.1.1.1.3.3.2"><apply id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2"><ci id="S4.E3.m1.2.2.1.cmml" xref="S4.E3.m1.2.2.1">^</ci><ci id="S4.E3.m1.2.2.2.cmml" xref="S4.E3.m1.2.2.2">𝐴</ci></apply><ci id="S4.E3.m1.3.3.cmml" xref="S4.E3.m1.3.3">𝐴</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.4c">\displaystyle r=\Delta(\hat{A}^{\prime},A)-\Delta(\hat{A},A),</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.4d">italic_r = roman_Δ ( over^ start_ARG italic_A end_ARG start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_A ) - roman_Δ ( over^ start_ARG italic_A end_ARG , italic_A ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p7.15">where <math alttext="A" class="ltx_Math" display="inline" id="S4.SS3.p7.12.m1.1"><semantics id="S4.SS3.p7.12.m1.1a"><mi id="S4.SS3.p7.12.m1.1.1" xref="S4.SS3.p7.12.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.12.m1.1b"><ci id="S4.SS3.p7.12.m1.1.1.cmml" xref="S4.SS3.p7.12.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.12.m1.1c">A</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.12.m1.1d">italic_A</annotation></semantics></math> denotes the ground truth answer. We note that the objective of the MDP, which aims to maximize cumulative rewards, aligns with the goal of discovering memories to answer the question. To illustrate, consider a process through a sequence of states: <math alttext="\mathbf{s}_{1},\mathbf{s}_{2},...,\mathbf{s}_{N}" class="ltx_Math" display="inline" id="S4.SS3.p7.13.m2.4"><semantics id="S4.SS3.p7.13.m2.4a"><mrow id="S4.SS3.p7.13.m2.4.4.3" xref="S4.SS3.p7.13.m2.4.4.4.cmml"><msub id="S4.SS3.p7.13.m2.2.2.1.1" xref="S4.SS3.p7.13.m2.2.2.1.1.cmml"><mi id="S4.SS3.p7.13.m2.2.2.1.1.2" xref="S4.SS3.p7.13.m2.2.2.1.1.2.cmml">𝐬</mi><mn id="S4.SS3.p7.13.m2.2.2.1.1.3" xref="S4.SS3.p7.13.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p7.13.m2.4.4.3.4" xref="S4.SS3.p7.13.m2.4.4.4.cmml">,</mo><msub id="S4.SS3.p7.13.m2.3.3.2.2" xref="S4.SS3.p7.13.m2.3.3.2.2.cmml"><mi id="S4.SS3.p7.13.m2.3.3.2.2.2" xref="S4.SS3.p7.13.m2.3.3.2.2.2.cmml">𝐬</mi><mn id="S4.SS3.p7.13.m2.3.3.2.2.3" xref="S4.SS3.p7.13.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS3.p7.13.m2.4.4.3.5" xref="S4.SS3.p7.13.m2.4.4.4.cmml">,</mo><mi id="S4.SS3.p7.13.m2.1.1" mathvariant="normal" xref="S4.SS3.p7.13.m2.1.1.cmml">…</mi><mo id="S4.SS3.p7.13.m2.4.4.3.6" xref="S4.SS3.p7.13.m2.4.4.4.cmml">,</mo><msub id="S4.SS3.p7.13.m2.4.4.3.3" xref="S4.SS3.p7.13.m2.4.4.3.3.cmml"><mi id="S4.SS3.p7.13.m2.4.4.3.3.2" xref="S4.SS3.p7.13.m2.4.4.3.3.2.cmml">𝐬</mi><mi id="S4.SS3.p7.13.m2.4.4.3.3.3" xref="S4.SS3.p7.13.m2.4.4.3.3.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.13.m2.4b"><list id="S4.SS3.p7.13.m2.4.4.4.cmml" xref="S4.SS3.p7.13.m2.4.4.3"><apply id="S4.SS3.p7.13.m2.2.2.1.1.cmml" xref="S4.SS3.p7.13.m2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.13.m2.2.2.1.1.1.cmml" xref="S4.SS3.p7.13.m2.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p7.13.m2.2.2.1.1.2.cmml" xref="S4.SS3.p7.13.m2.2.2.1.1.2">𝐬</ci><cn id="S4.SS3.p7.13.m2.2.2.1.1.3.cmml" type="integer" xref="S4.SS3.p7.13.m2.2.2.1.1.3">1</cn></apply><apply id="S4.SS3.p7.13.m2.3.3.2.2.cmml" xref="S4.SS3.p7.13.m2.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p7.13.m2.3.3.2.2.1.cmml" xref="S4.SS3.p7.13.m2.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p7.13.m2.3.3.2.2.2.cmml" xref="S4.SS3.p7.13.m2.3.3.2.2.2">𝐬</ci><cn id="S4.SS3.p7.13.m2.3.3.2.2.3.cmml" type="integer" xref="S4.SS3.p7.13.m2.3.3.2.2.3">2</cn></apply><ci id="S4.SS3.p7.13.m2.1.1.cmml" xref="S4.SS3.p7.13.m2.1.1">…</ci><apply id="S4.SS3.p7.13.m2.4.4.3.3.cmml" xref="S4.SS3.p7.13.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS3.p7.13.m2.4.4.3.3.1.cmml" xref="S4.SS3.p7.13.m2.4.4.3.3">subscript</csymbol><ci id="S4.SS3.p7.13.m2.4.4.3.3.2.cmml" xref="S4.SS3.p7.13.m2.4.4.3.3.2">𝐬</ci><ci id="S4.SS3.p7.13.m2.4.4.3.3.3.cmml" xref="S4.SS3.p7.13.m2.4.4.3.3.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.13.m2.4c">\mathbf{s}_{1},\mathbf{s}_{2},...,\mathbf{s}_{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.13.m2.4d">bold_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math>, concluding at <math alttext="\mathbf{s}_{N}" class="ltx_Math" display="inline" id="S4.SS3.p7.14.m3.1"><semantics id="S4.SS3.p7.14.m3.1a"><msub id="S4.SS3.p7.14.m3.1.1" xref="S4.SS3.p7.14.m3.1.1.cmml"><mi id="S4.SS3.p7.14.m3.1.1.2" xref="S4.SS3.p7.14.m3.1.1.2.cmml">𝐬</mi><mi id="S4.SS3.p7.14.m3.1.1.3" xref="S4.SS3.p7.14.m3.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.14.m3.1b"><apply id="S4.SS3.p7.14.m3.1.1.cmml" xref="S4.SS3.p7.14.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.14.m3.1.1.1.cmml" xref="S4.SS3.p7.14.m3.1.1">subscript</csymbol><ci id="S4.SS3.p7.14.m3.1.1.2.cmml" xref="S4.SS3.p7.14.m3.1.1.2">𝐬</ci><ci id="S4.SS3.p7.14.m3.1.1.3.cmml" xref="S4.SS3.p7.14.m3.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.14.m3.1c">\mathbf{s}_{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.14.m3.1d">bold_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math>. The rewards received at these states, except for the termination state, can be denoted as <math alttext="r_{1},r_{2},...,r_{N-1}" class="ltx_Math" display="inline" id="S4.SS3.p7.15.m4.4"><semantics id="S4.SS3.p7.15.m4.4a"><mrow id="S4.SS3.p7.15.m4.4.4.3" xref="S4.SS3.p7.15.m4.4.4.4.cmml"><msub id="S4.SS3.p7.15.m4.2.2.1.1" xref="S4.SS3.p7.15.m4.2.2.1.1.cmml"><mi id="S4.SS3.p7.15.m4.2.2.1.1.2" xref="S4.SS3.p7.15.m4.2.2.1.1.2.cmml">r</mi><mn id="S4.SS3.p7.15.m4.2.2.1.1.3" xref="S4.SS3.p7.15.m4.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p7.15.m4.4.4.3.4" xref="S4.SS3.p7.15.m4.4.4.4.cmml">,</mo><msub id="S4.SS3.p7.15.m4.3.3.2.2" xref="S4.SS3.p7.15.m4.3.3.2.2.cmml"><mi id="S4.SS3.p7.15.m4.3.3.2.2.2" xref="S4.SS3.p7.15.m4.3.3.2.2.2.cmml">r</mi><mn id="S4.SS3.p7.15.m4.3.3.2.2.3" xref="S4.SS3.p7.15.m4.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS3.p7.15.m4.4.4.3.5" xref="S4.SS3.p7.15.m4.4.4.4.cmml">,</mo><mi id="S4.SS3.p7.15.m4.1.1" mathvariant="normal" xref="S4.SS3.p7.15.m4.1.1.cmml">…</mi><mo id="S4.SS3.p7.15.m4.4.4.3.6" xref="S4.SS3.p7.15.m4.4.4.4.cmml">,</mo><msub id="S4.SS3.p7.15.m4.4.4.3.3" xref="S4.SS3.p7.15.m4.4.4.3.3.cmml"><mi id="S4.SS3.p7.15.m4.4.4.3.3.2" xref="S4.SS3.p7.15.m4.4.4.3.3.2.cmml">r</mi><mrow id="S4.SS3.p7.15.m4.4.4.3.3.3" xref="S4.SS3.p7.15.m4.4.4.3.3.3.cmml"><mi id="S4.SS3.p7.15.m4.4.4.3.3.3.2" xref="S4.SS3.p7.15.m4.4.4.3.3.3.2.cmml">N</mi><mo id="S4.SS3.p7.15.m4.4.4.3.3.3.1" xref="S4.SS3.p7.15.m4.4.4.3.3.3.1.cmml">−</mo><mn id="S4.SS3.p7.15.m4.4.4.3.3.3.3" xref="S4.SS3.p7.15.m4.4.4.3.3.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.15.m4.4b"><list id="S4.SS3.p7.15.m4.4.4.4.cmml" xref="S4.SS3.p7.15.m4.4.4.3"><apply id="S4.SS3.p7.15.m4.2.2.1.1.cmml" xref="S4.SS3.p7.15.m4.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.15.m4.2.2.1.1.1.cmml" xref="S4.SS3.p7.15.m4.2.2.1.1">subscript</csymbol><ci id="S4.SS3.p7.15.m4.2.2.1.1.2.cmml" xref="S4.SS3.p7.15.m4.2.2.1.1.2">𝑟</ci><cn id="S4.SS3.p7.15.m4.2.2.1.1.3.cmml" type="integer" xref="S4.SS3.p7.15.m4.2.2.1.1.3">1</cn></apply><apply id="S4.SS3.p7.15.m4.3.3.2.2.cmml" xref="S4.SS3.p7.15.m4.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS3.p7.15.m4.3.3.2.2.1.cmml" xref="S4.SS3.p7.15.m4.3.3.2.2">subscript</csymbol><ci id="S4.SS3.p7.15.m4.3.3.2.2.2.cmml" xref="S4.SS3.p7.15.m4.3.3.2.2.2">𝑟</ci><cn id="S4.SS3.p7.15.m4.3.3.2.2.3.cmml" type="integer" xref="S4.SS3.p7.15.m4.3.3.2.2.3">2</cn></apply><ci id="S4.SS3.p7.15.m4.1.1.cmml" xref="S4.SS3.p7.15.m4.1.1">…</ci><apply id="S4.SS3.p7.15.m4.4.4.3.3.cmml" xref="S4.SS3.p7.15.m4.4.4.3.3"><csymbol cd="ambiguous" id="S4.SS3.p7.15.m4.4.4.3.3.1.cmml" xref="S4.SS3.p7.15.m4.4.4.3.3">subscript</csymbol><ci id="S4.SS3.p7.15.m4.4.4.3.3.2.cmml" xref="S4.SS3.p7.15.m4.4.4.3.3.2">𝑟</ci><apply id="S4.SS3.p7.15.m4.4.4.3.3.3.cmml" xref="S4.SS3.p7.15.m4.4.4.3.3.3"><minus id="S4.SS3.p7.15.m4.4.4.3.3.3.1.cmml" xref="S4.SS3.p7.15.m4.4.4.3.3.3.1"></minus><ci id="S4.SS3.p7.15.m4.4.4.3.3.3.2.cmml" xref="S4.SS3.p7.15.m4.4.4.3.3.3.2">𝑁</ci><cn id="S4.SS3.p7.15.m4.4.4.3.3.3.3.cmml" type="integer" xref="S4.SS3.p7.15.m4.4.4.3.3.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.15.m4.4c">r_{1},r_{2},...,r_{N-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.15.m4.4d">italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_r start_POSTSUBSCRIPT italic_N - 1 end_POSTSUBSCRIPT</annotation></semantics></math>. When future rewards are not discounted, we have:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E4">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E4X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\sum_{t=2}^{N}r_{t-1}" class="ltx_Math" display="inline" id="S4.E4X.2.1.1.m1.1"><semantics id="S4.E4X.2.1.1.m1.1a"><mrow id="S4.E4X.2.1.1.m1.1.1" xref="S4.E4X.2.1.1.m1.1.1.cmml"><mstyle displaystyle="true" id="S4.E4X.2.1.1.m1.1.1.1" xref="S4.E4X.2.1.1.m1.1.1.1.cmml"><munderover id="S4.E4X.2.1.1.m1.1.1.1a" xref="S4.E4X.2.1.1.m1.1.1.1.cmml"><mo id="S4.E4X.2.1.1.m1.1.1.1.2.2" movablelimits="false" xref="S4.E4X.2.1.1.m1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E4X.2.1.1.m1.1.1.1.2.3" xref="S4.E4X.2.1.1.m1.1.1.1.2.3.cmml"><mi id="S4.E4X.2.1.1.m1.1.1.1.2.3.2" xref="S4.E4X.2.1.1.m1.1.1.1.2.3.2.cmml">t</mi><mo id="S4.E4X.2.1.1.m1.1.1.1.2.3.1" xref="S4.E4X.2.1.1.m1.1.1.1.2.3.1.cmml">=</mo><mn id="S4.E4X.2.1.1.m1.1.1.1.2.3.3" xref="S4.E4X.2.1.1.m1.1.1.1.2.3.3.cmml">2</mn></mrow><mi id="S4.E4X.2.1.1.m1.1.1.1.3" xref="S4.E4X.2.1.1.m1.1.1.1.3.cmml">N</mi></munderover></mstyle><msub id="S4.E4X.2.1.1.m1.1.1.2" xref="S4.E4X.2.1.1.m1.1.1.2.cmml"><mi id="S4.E4X.2.1.1.m1.1.1.2.2" xref="S4.E4X.2.1.1.m1.1.1.2.2.cmml">r</mi><mrow id="S4.E4X.2.1.1.m1.1.1.2.3" xref="S4.E4X.2.1.1.m1.1.1.2.3.cmml"><mi id="S4.E4X.2.1.1.m1.1.1.2.3.2" xref="S4.E4X.2.1.1.m1.1.1.2.3.2.cmml">t</mi><mo id="S4.E4X.2.1.1.m1.1.1.2.3.1" xref="S4.E4X.2.1.1.m1.1.1.2.3.1.cmml">−</mo><mn id="S4.E4X.2.1.1.m1.1.1.2.3.3" xref="S4.E4X.2.1.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.E4X.2.1.1.m1.1b"><apply id="S4.E4X.2.1.1.m1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1"><apply id="S4.E4X.2.1.1.m1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.1.1.1.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.1">superscript</csymbol><apply id="S4.E4X.2.1.1.m1.1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.1.1.1.2.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.1">subscript</csymbol><sum id="S4.E4X.2.1.1.m1.1.1.1.2.2.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.2.2"></sum><apply id="S4.E4X.2.1.1.m1.1.1.1.2.3.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.2.3"><eq id="S4.E4X.2.1.1.m1.1.1.1.2.3.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.2.3.1"></eq><ci id="S4.E4X.2.1.1.m1.1.1.1.2.3.2.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.2.3.2">𝑡</ci><cn id="S4.E4X.2.1.1.m1.1.1.1.2.3.3.cmml" type="integer" xref="S4.E4X.2.1.1.m1.1.1.1.2.3.3">2</cn></apply></apply><ci id="S4.E4X.2.1.1.m1.1.1.1.3.cmml" xref="S4.E4X.2.1.1.m1.1.1.1.3">𝑁</ci></apply><apply id="S4.E4X.2.1.1.m1.1.1.2.cmml" xref="S4.E4X.2.1.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.E4X.2.1.1.m1.1.1.2.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.2">subscript</csymbol><ci id="S4.E4X.2.1.1.m1.1.1.2.2.cmml" xref="S4.E4X.2.1.1.m1.1.1.2.2">𝑟</ci><apply id="S4.E4X.2.1.1.m1.1.1.2.3.cmml" xref="S4.E4X.2.1.1.m1.1.1.2.3"><minus id="S4.E4X.2.1.1.m1.1.1.2.3.1.cmml" xref="S4.E4X.2.1.1.m1.1.1.2.3.1"></minus><ci id="S4.E4X.2.1.1.m1.1.1.2.3.2.cmml" xref="S4.E4X.2.1.1.m1.1.1.2.3.2">𝑡</ci><cn id="S4.E4X.2.1.1.m1.1.1.2.3.3.cmml" type="integer" xref="S4.E4X.2.1.1.m1.1.1.2.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4X.2.1.1.m1.1c">\displaystyle\sum_{t=2}^{N}r_{t-1}</annotation><annotation encoding="application/x-llamapun" id="S4.E4X.2.1.1.m1.1d">∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_r start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{t=2}^{N}(\Delta(\hat{A}_{t},A)-\Delta(\hat{A}_{t-1},A))" class="ltx_Math" display="inline" id="S4.E4X.3.2.2.m1.3"><semantics id="S4.E4X.3.2.2.m1.3a"><mrow id="S4.E4X.3.2.2.m1.3.3" xref="S4.E4X.3.2.2.m1.3.3.cmml"><mi id="S4.E4X.3.2.2.m1.3.3.3" xref="S4.E4X.3.2.2.m1.3.3.3.cmml"></mi><mo id="S4.E4X.3.2.2.m1.3.3.2" xref="S4.E4X.3.2.2.m1.3.3.2.cmml">=</mo><mrow id="S4.E4X.3.2.2.m1.3.3.1" xref="S4.E4X.3.2.2.m1.3.3.1.cmml"><mstyle displaystyle="true" id="S4.E4X.3.2.2.m1.3.3.1.2" xref="S4.E4X.3.2.2.m1.3.3.1.2.cmml"><munderover id="S4.E4X.3.2.2.m1.3.3.1.2a" xref="S4.E4X.3.2.2.m1.3.3.1.2.cmml"><mo id="S4.E4X.3.2.2.m1.3.3.1.2.2.2" movablelimits="false" xref="S4.E4X.3.2.2.m1.3.3.1.2.2.2.cmml">∑</mo><mrow id="S4.E4X.3.2.2.m1.3.3.1.2.2.3" xref="S4.E4X.3.2.2.m1.3.3.1.2.2.3.cmml"><mi id="S4.E4X.3.2.2.m1.3.3.1.2.2.3.2" xref="S4.E4X.3.2.2.m1.3.3.1.2.2.3.2.cmml">t</mi><mo id="S4.E4X.3.2.2.m1.3.3.1.2.2.3.1" xref="S4.E4X.3.2.2.m1.3.3.1.2.2.3.1.cmml">=</mo><mn id="S4.E4X.3.2.2.m1.3.3.1.2.2.3.3" xref="S4.E4X.3.2.2.m1.3.3.1.2.2.3.3.cmml">2</mn></mrow><mi id="S4.E4X.3.2.2.m1.3.3.1.2.3" xref="S4.E4X.3.2.2.m1.3.3.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S4.E4X.3.2.2.m1.3.3.1.1.1" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.cmml"><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.2" stretchy="false" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.E4X.3.2.2.m1.3.3.1.1.1.1" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.cmml"><mrow id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.3" mathvariant="normal" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml">Δ</mi><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.2" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml"><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml">A</mi><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E4X.3.2.2.m1.1.1" xref="S4.E4X.3.2.2.m1.1.1.cmml">A</mi><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.4" stretchy="false" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.3" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.3.cmml">−</mo><mrow id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.cmml"><mi id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.3" mathvariant="normal" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.3.cmml">Δ</mi><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.2" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.2.cmml"><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.2" stretchy="false" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.2.cmml">(</mo><msub id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.cmml"><mover accent="true" id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.cmml"><mi id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.2" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.2.cmml">A</mi><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.1" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.1.cmml">^</mo></mover><mrow id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.cmml"><mi id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.2" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.2.cmml">t</mi><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.1" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.1.cmml">−</mo><mn id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.3" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.3" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.2.cmml">,</mo><mi id="S4.E4X.3.2.2.m1.2.2" xref="S4.E4X.3.2.2.m1.2.2.cmml">A</mi><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.4" stretchy="false" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E4X.3.2.2.m1.3.3.1.1.1.3" stretchy="false" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4X.3.2.2.m1.3b"><apply id="S4.E4X.3.2.2.m1.3.3.cmml" xref="S4.E4X.3.2.2.m1.3.3"><eq id="S4.E4X.3.2.2.m1.3.3.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.2"></eq><csymbol cd="latexml" id="S4.E4X.3.2.2.m1.3.3.3.cmml" xref="S4.E4X.3.2.2.m1.3.3.3">absent</csymbol><apply id="S4.E4X.3.2.2.m1.3.3.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1"><apply id="S4.E4X.3.2.2.m1.3.3.1.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.2"><csymbol cd="ambiguous" id="S4.E4X.3.2.2.m1.3.3.1.2.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.2">superscript</csymbol><apply id="S4.E4X.3.2.2.m1.3.3.1.2.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.2"><csymbol cd="ambiguous" id="S4.E4X.3.2.2.m1.3.3.1.2.2.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.2">subscript</csymbol><sum id="S4.E4X.3.2.2.m1.3.3.1.2.2.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.2.2.2"></sum><apply id="S4.E4X.3.2.2.m1.3.3.1.2.2.3.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.2.2.3"><eq id="S4.E4X.3.2.2.m1.3.3.1.2.2.3.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.2.2.3.1"></eq><ci id="S4.E4X.3.2.2.m1.3.3.1.2.2.3.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.2.2.3.2">𝑡</ci><cn id="S4.E4X.3.2.2.m1.3.3.1.2.2.3.3.cmml" type="integer" xref="S4.E4X.3.2.2.m1.3.3.1.2.2.3.3">2</cn></apply></apply><ci id="S4.E4X.3.2.2.m1.3.3.1.2.3.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.2.3">𝑁</ci></apply><apply id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1"><minus id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.3.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.3"></minus><apply id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1"><times id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.2"></times><ci id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.3">Δ</ci><interval closure="open" id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1"><apply id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2"><ci id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.2.2">𝐴</ci></apply><ci id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S4.E4X.3.2.2.m1.1.1.cmml" xref="S4.E4X.3.2.2.m1.1.1">𝐴</ci></interval></apply><apply id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2"><times id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.2"></times><ci id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.3.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.3">Δ</ci><interval closure="open" id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1"><apply id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1">subscript</csymbol><apply id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2"><ci id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.1">^</ci><ci id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.2.2">𝐴</ci></apply><apply id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3"><minus id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.1.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.1"></minus><ci id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.2.cmml" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.2">𝑡</ci><cn id="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.3.cmml" type="integer" xref="S4.E4X.3.2.2.m1.3.3.1.1.1.1.2.1.1.1.3.3">1</cn></apply></apply><ci id="S4.E4X.3.2.2.m1.2.2.cmml" xref="S4.E4X.3.2.2.m1.2.2">𝐴</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4X.3.2.2.m1.3c">\displaystyle=\sum_{t=2}^{N}(\Delta(\hat{A}_{t},A)-\Delta(\hat{A}_{t-1},A))</annotation><annotation encoding="application/x-llamapun" id="S4.E4X.3.2.2.m1.3d">= ∑ start_POSTSUBSCRIPT italic_t = 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( roman_Δ ( over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_A ) - roman_Δ ( over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT , italic_A ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(4)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E4Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\Delta(\hat{A}_{N},y)-\Delta(\hat{A}_{1},y)," class="ltx_Math" display="inline" id="S4.E4Xa.2.1.1.m1.3"><semantics id="S4.E4Xa.2.1.1.m1.3a"><mrow id="S4.E4Xa.2.1.1.m1.3.3.1" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.cmml"><mrow id="S4.E4Xa.2.1.1.m1.3.3.1.1" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.cmml"><mi id="S4.E4Xa.2.1.1.m1.3.3.1.1.4" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.4.cmml"></mi><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.3" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.3.cmml">=</mo><mrow id="S4.E4Xa.2.1.1.m1.3.3.1.1.2" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.cmml"><mrow id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.cmml"><mi id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.3" mathvariant="normal" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml">Δ</mi><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.2" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.2" stretchy="false" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">A</mi><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.1" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml">N</mi></msub><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.3" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E4Xa.2.1.1.m1.1.1" xref="S4.E4Xa.2.1.1.m1.1.1.cmml">y</mi><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.4" stretchy="false" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.3" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.3.cmml">−</mo><mrow id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.cmml"><mi id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.3" mathvariant="normal" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.3.cmml">Δ</mi><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.2" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.2.cmml">⁢</mo><mrow id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.2.cmml"><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.2" stretchy="false" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.2.cmml">(</mo><msub id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.cmml"><mover accent="true" id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.cmml"><mi id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.2" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.2.cmml">A</mi><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.1" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.1.cmml">^</mo></mover><mn id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.3" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.3" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.2.cmml">,</mo><mi id="S4.E4Xa.2.1.1.m1.2.2" xref="S4.E4Xa.2.1.1.m1.2.2.cmml">y</mi><mo id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.4" stretchy="false" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E4Xa.2.1.1.m1.3.3.1.2" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4Xa.2.1.1.m1.3b"><apply id="S4.E4Xa.2.1.1.m1.3.3.1.1.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1"><eq id="S4.E4Xa.2.1.1.m1.3.3.1.1.3.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.3"></eq><csymbol cd="latexml" id="S4.E4Xa.2.1.1.m1.3.3.1.1.4.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.4">absent</csymbol><apply id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2"><minus id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.3.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.3"></minus><apply id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1"><times id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.2.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.2"></times><ci id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.3.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.3">Δ</ci><interval closure="open" id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1"><apply id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2"><ci id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.2.2">𝐴</ci></apply><ci id="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.1.1.1.1.1.3">𝑁</ci></apply><ci id="S4.E4Xa.2.1.1.m1.1.1.cmml" xref="S4.E4Xa.2.1.1.m1.1.1">𝑦</ci></interval></apply><apply id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2"><times id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.2.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.2"></times><ci id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.3.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.3">Δ</ci><interval closure="open" id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.2.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1"><apply id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1">subscript</csymbol><apply id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2"><ci id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.1.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.1">^</ci><ci id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.2.cmml" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.2.2">𝐴</ci></apply><cn id="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.3.cmml" type="integer" xref="S4.E4Xa.2.1.1.m1.3.3.1.1.2.2.1.1.1.3">1</cn></apply><ci id="S4.E4Xa.2.1.1.m1.2.2.cmml" xref="S4.E4Xa.2.1.1.m1.2.2">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4Xa.2.1.1.m1.3c">\displaystyle=\Delta(\hat{A}_{N},y)-\Delta(\hat{A}_{1},y),</annotation><annotation encoding="application/x-llamapun" id="S4.E4Xa.2.1.1.m1.3d">= roman_Δ ( over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_y ) - roman_Δ ( over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.SS3.p7.17">where <math alttext="\Delta(\hat{A}_{N},y)" class="ltx_Math" display="inline" id="S4.SS3.p7.16.m1.2"><semantics id="S4.SS3.p7.16.m1.2a"><mrow id="S4.SS3.p7.16.m1.2.2" xref="S4.SS3.p7.16.m1.2.2.cmml"><mi id="S4.SS3.p7.16.m1.2.2.3" mathvariant="normal" xref="S4.SS3.p7.16.m1.2.2.3.cmml">Δ</mi><mo id="S4.SS3.p7.16.m1.2.2.2" xref="S4.SS3.p7.16.m1.2.2.2.cmml">⁢</mo><mrow id="S4.SS3.p7.16.m1.2.2.1.1" xref="S4.SS3.p7.16.m1.2.2.1.2.cmml"><mo id="S4.SS3.p7.16.m1.2.2.1.1.2" stretchy="false" xref="S4.SS3.p7.16.m1.2.2.1.2.cmml">(</mo><msub id="S4.SS3.p7.16.m1.2.2.1.1.1" xref="S4.SS3.p7.16.m1.2.2.1.1.1.cmml"><mover accent="true" id="S4.SS3.p7.16.m1.2.2.1.1.1.2" xref="S4.SS3.p7.16.m1.2.2.1.1.1.2.cmml"><mi id="S4.SS3.p7.16.m1.2.2.1.1.1.2.2" xref="S4.SS3.p7.16.m1.2.2.1.1.1.2.2.cmml">A</mi><mo id="S4.SS3.p7.16.m1.2.2.1.1.1.2.1" xref="S4.SS3.p7.16.m1.2.2.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.p7.16.m1.2.2.1.1.1.3" xref="S4.SS3.p7.16.m1.2.2.1.1.1.3.cmml">N</mi></msub><mo id="S4.SS3.p7.16.m1.2.2.1.1.3" xref="S4.SS3.p7.16.m1.2.2.1.2.cmml">,</mo><mi id="S4.SS3.p7.16.m1.1.1" xref="S4.SS3.p7.16.m1.1.1.cmml">y</mi><mo id="S4.SS3.p7.16.m1.2.2.1.1.4" stretchy="false" xref="S4.SS3.p7.16.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.16.m1.2b"><apply id="S4.SS3.p7.16.m1.2.2.cmml" xref="S4.SS3.p7.16.m1.2.2"><times id="S4.SS3.p7.16.m1.2.2.2.cmml" xref="S4.SS3.p7.16.m1.2.2.2"></times><ci id="S4.SS3.p7.16.m1.2.2.3.cmml" xref="S4.SS3.p7.16.m1.2.2.3">Δ</ci><interval closure="open" id="S4.SS3.p7.16.m1.2.2.1.2.cmml" xref="S4.SS3.p7.16.m1.2.2.1.1"><apply id="S4.SS3.p7.16.m1.2.2.1.1.1.cmml" xref="S4.SS3.p7.16.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.16.m1.2.2.1.1.1.1.cmml" xref="S4.SS3.p7.16.m1.2.2.1.1.1">subscript</csymbol><apply id="S4.SS3.p7.16.m1.2.2.1.1.1.2.cmml" xref="S4.SS3.p7.16.m1.2.2.1.1.1.2"><ci id="S4.SS3.p7.16.m1.2.2.1.1.1.2.1.cmml" xref="S4.SS3.p7.16.m1.2.2.1.1.1.2.1">^</ci><ci id="S4.SS3.p7.16.m1.2.2.1.1.1.2.2.cmml" xref="S4.SS3.p7.16.m1.2.2.1.1.1.2.2">𝐴</ci></apply><ci id="S4.SS3.p7.16.m1.2.2.1.1.1.3.cmml" xref="S4.SS3.p7.16.m1.2.2.1.1.1.3">𝑁</ci></apply><ci id="S4.SS3.p7.16.m1.1.1.cmml" xref="S4.SS3.p7.16.m1.1.1">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.16.m1.2c">\Delta(\hat{A}_{N},y)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.16.m1.2d">roman_Δ ( over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT , italic_y )</annotation></semantics></math> corresponds to the result of the final answer found throughout the entire iteration, and <math alttext="\Delta(\hat{A}_{1},y)" class="ltx_Math" display="inline" id="S4.SS3.p7.17.m2.2"><semantics id="S4.SS3.p7.17.m2.2a"><mrow id="S4.SS3.p7.17.m2.2.2" xref="S4.SS3.p7.17.m2.2.2.cmml"><mi id="S4.SS3.p7.17.m2.2.2.3" mathvariant="normal" xref="S4.SS3.p7.17.m2.2.2.3.cmml">Δ</mi><mo id="S4.SS3.p7.17.m2.2.2.2" xref="S4.SS3.p7.17.m2.2.2.2.cmml">⁢</mo><mrow id="S4.SS3.p7.17.m2.2.2.1.1" xref="S4.SS3.p7.17.m2.2.2.1.2.cmml"><mo id="S4.SS3.p7.17.m2.2.2.1.1.2" stretchy="false" xref="S4.SS3.p7.17.m2.2.2.1.2.cmml">(</mo><msub id="S4.SS3.p7.17.m2.2.2.1.1.1" xref="S4.SS3.p7.17.m2.2.2.1.1.1.cmml"><mover accent="true" id="S4.SS3.p7.17.m2.2.2.1.1.1.2" xref="S4.SS3.p7.17.m2.2.2.1.1.1.2.cmml"><mi id="S4.SS3.p7.17.m2.2.2.1.1.1.2.2" xref="S4.SS3.p7.17.m2.2.2.1.1.1.2.2.cmml">A</mi><mo id="S4.SS3.p7.17.m2.2.2.1.1.1.2.1" xref="S4.SS3.p7.17.m2.2.2.1.1.1.2.1.cmml">^</mo></mover><mn id="S4.SS3.p7.17.m2.2.2.1.1.1.3" xref="S4.SS3.p7.17.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS3.p7.17.m2.2.2.1.1.3" xref="S4.SS3.p7.17.m2.2.2.1.2.cmml">,</mo><mi id="S4.SS3.p7.17.m2.1.1" xref="S4.SS3.p7.17.m2.1.1.cmml">y</mi><mo id="S4.SS3.p7.17.m2.2.2.1.1.4" stretchy="false" xref="S4.SS3.p7.17.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.17.m2.2b"><apply id="S4.SS3.p7.17.m2.2.2.cmml" xref="S4.SS3.p7.17.m2.2.2"><times id="S4.SS3.p7.17.m2.2.2.2.cmml" xref="S4.SS3.p7.17.m2.2.2.2"></times><ci id="S4.SS3.p7.17.m2.2.2.3.cmml" xref="S4.SS3.p7.17.m2.2.2.3">Δ</ci><interval closure="open" id="S4.SS3.p7.17.m2.2.2.1.2.cmml" xref="S4.SS3.p7.17.m2.2.2.1.1"><apply id="S4.SS3.p7.17.m2.2.2.1.1.1.cmml" xref="S4.SS3.p7.17.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.17.m2.2.2.1.1.1.1.cmml" xref="S4.SS3.p7.17.m2.2.2.1.1.1">subscript</csymbol><apply id="S4.SS3.p7.17.m2.2.2.1.1.1.2.cmml" xref="S4.SS3.p7.17.m2.2.2.1.1.1.2"><ci id="S4.SS3.p7.17.m2.2.2.1.1.1.2.1.cmml" xref="S4.SS3.p7.17.m2.2.2.1.1.1.2.1">^</ci><ci id="S4.SS3.p7.17.m2.2.2.1.1.1.2.2.cmml" xref="S4.SS3.p7.17.m2.2.2.1.1.1.2.2">𝐴</ci></apply><cn id="S4.SS3.p7.17.m2.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS3.p7.17.m2.2.2.1.1.1.3">1</cn></apply><ci id="S4.SS3.p7.17.m2.1.1.cmml" xref="S4.SS3.p7.17.m2.1.1">𝑦</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.17.m2.2c">\Delta(\hat{A}_{1},y)</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.17.m2.2d">roman_Δ ( over^ start_ARG italic_A end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y )</annotation></semantics></math> represents an initial result that remains constant. Therefore, maximizing cumulative rewards is equivalent to maximizing the quality of the final generated answer.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p8">
<p class="ltx_p" id="S4.SS3.p8.3"><span class="ltx_text ltx_font_bold" id="S4.SS3.p8.3.1">Training Policies of MDPs.</span> Training the MDP policy involves two stages: warm-start stage (WS) and policy gradient stage (PG). <span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS3.p8.3.2">In WS</span>, we employ supervised fine-tuning to equip the agent with the basic ability to select memories given a question <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS3.p8.1.m1.1"><semantics id="S4.SS3.p8.1.m1.1a"><mi id="S4.SS3.p8.1.m1.1.1" xref="S4.SS3.p8.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.1.m1.1b"><ci id="S4.SS3.p8.1.m1.1.1.cmml" xref="S4.SS3.p8.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p8.1.m1.1d">italic_Q</annotation></semantics></math>. Specifically, based on a state <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S4.SS3.p8.2.m2.1"><semantics id="S4.SS3.p8.2.m2.1a"><mi id="S4.SS3.p8.2.m2.1.1" xref="S4.SS3.p8.2.m2.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.2.m2.1b"><ci id="S4.SS3.p8.2.m2.1.1.cmml" xref="S4.SS3.p8.2.m2.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.2.m2.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p8.2.m2.1d">bold_s</annotation></semantics></math>, the agent undergoes a binary classification task to predict whether the memory <math alttext="M_{i}" class="ltx_Math" display="inline" id="S4.SS3.p8.3.m3.1"><semantics id="S4.SS3.p8.3.m3.1a"><msub id="S4.SS3.p8.3.m3.1.1" xref="S4.SS3.p8.3.m3.1.1.cmml"><mi id="S4.SS3.p8.3.m3.1.1.2" xref="S4.SS3.p8.3.m3.1.1.2.cmml">M</mi><mi id="S4.SS3.p8.3.m3.1.1.3" xref="S4.SS3.p8.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.3.m3.1b"><apply id="S4.SS3.p8.3.m3.1.1.cmml" xref="S4.SS3.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p8.3.m3.1.1.1.cmml" xref="S4.SS3.p8.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p8.3.m3.1.1.2.cmml" xref="S4.SS3.p8.3.m3.1.1.2">𝑀</ci><ci id="S4.SS3.p8.3.m3.1.1.3.cmml" xref="S4.SS3.p8.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.3.m3.1c">M_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p8.3.m3.1d">italic_M start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> should be included. This prediction is supervised according to whether the memory falls into the required memories (presented in the Step-3 in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S3.T1" title="Table 1 ‣ 3 Problem Statement ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">1</span></a>). Thus, the objective is trained with binary cross-entropy, formulated as:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx4">
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{L}_{\text{WS}}=-y*\log(P)+(y-1)*\log(1-P)," class="ltx_Math" display="inline" id="S4.E5.m1.4"><semantics id="S4.E5.m1.4a"><mrow id="S4.E5.m1.4.4.1" xref="S4.E5.m1.4.4.1.1.cmml"><mrow id="S4.E5.m1.4.4.1.1" xref="S4.E5.m1.4.4.1.1.cmml"><msub id="S4.E5.m1.4.4.1.1.4" xref="S4.E5.m1.4.4.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.4.4.1.1.4.2" xref="S4.E5.m1.4.4.1.1.4.2.cmml">ℒ</mi><mtext id="S4.E5.m1.4.4.1.1.4.3" xref="S4.E5.m1.4.4.1.1.4.3a.cmml">WS</mtext></msub><mo id="S4.E5.m1.4.4.1.1.3" xref="S4.E5.m1.4.4.1.1.3.cmml">=</mo><mrow id="S4.E5.m1.4.4.1.1.2" xref="S4.E5.m1.4.4.1.1.2.cmml"><mrow id="S4.E5.m1.4.4.1.1.2.4" xref="S4.E5.m1.4.4.1.1.2.4.cmml"><mo id="S4.E5.m1.4.4.1.1.2.4a" xref="S4.E5.m1.4.4.1.1.2.4.cmml">−</mo><mrow id="S4.E5.m1.4.4.1.1.2.4.2" xref="S4.E5.m1.4.4.1.1.2.4.2.cmml"><mi id="S4.E5.m1.4.4.1.1.2.4.2.2" xref="S4.E5.m1.4.4.1.1.2.4.2.2.cmml">y</mi><mo id="S4.E5.m1.4.4.1.1.2.4.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E5.m1.4.4.1.1.2.4.2.1.cmml">∗</mo><mrow id="S4.E5.m1.4.4.1.1.2.4.2.3.2" xref="S4.E5.m1.4.4.1.1.2.4.2.3.1.cmml"><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">log</mi><mo id="S4.E5.m1.4.4.1.1.2.4.2.3.2a" xref="S4.E5.m1.4.4.1.1.2.4.2.3.1.cmml">⁡</mo><mrow id="S4.E5.m1.4.4.1.1.2.4.2.3.2.1" xref="S4.E5.m1.4.4.1.1.2.4.2.3.1.cmml"><mo id="S4.E5.m1.4.4.1.1.2.4.2.3.2.1.1" stretchy="false" xref="S4.E5.m1.4.4.1.1.2.4.2.3.1.cmml">(</mo><mi id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">P</mi><mo id="S4.E5.m1.4.4.1.1.2.4.2.3.2.1.2" stretchy="false" xref="S4.E5.m1.4.4.1.1.2.4.2.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.4.4.1.1.2.3" xref="S4.E5.m1.4.4.1.1.2.3.cmml">+</mo><mrow id="S4.E5.m1.4.4.1.1.2.2" xref="S4.E5.m1.4.4.1.1.2.2.cmml"><mrow id="S4.E5.m1.4.4.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.4.4.1.1.1.1.1.1.2" stretchy="false" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.4.4.1.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.4.4.1.1.1.1.1.1.1.2" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S4.E5.m1.4.4.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E5.m1.4.4.1.1.2.2.3" rspace="0.222em" xref="S4.E5.m1.4.4.1.1.2.2.3.cmml">∗</mo><mrow id="S4.E5.m1.4.4.1.1.2.2.2.1" xref="S4.E5.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml">log</mi><mo id="S4.E5.m1.4.4.1.1.2.2.2.1a" xref="S4.E5.m1.4.4.1.1.2.2.2.2.cmml">⁡</mo><mrow id="S4.E5.m1.4.4.1.1.2.2.2.1.1" xref="S4.E5.m1.4.4.1.1.2.2.2.2.cmml"><mo id="S4.E5.m1.4.4.1.1.2.2.2.1.1.2" stretchy="false" xref="S4.E5.m1.4.4.1.1.2.2.2.2.cmml">(</mo><mrow id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.cmml"><mn id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.2" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.2.cmml">1</mn><mo id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.1" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.1.cmml">−</mo><mi id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.3" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.3.cmml">P</mi></mrow><mo id="S4.E5.m1.4.4.1.1.2.2.2.1.1.3" stretchy="false" xref="S4.E5.m1.4.4.1.1.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.4.4.1.2" xref="S4.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.4b"><apply id="S4.E5.m1.4.4.1.1.cmml" xref="S4.E5.m1.4.4.1"><eq id="S4.E5.m1.4.4.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.3"></eq><apply id="S4.E5.m1.4.4.1.1.4.cmml" xref="S4.E5.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.1.1.4.1.cmml" xref="S4.E5.m1.4.4.1.1.4">subscript</csymbol><ci id="S4.E5.m1.4.4.1.1.4.2.cmml" xref="S4.E5.m1.4.4.1.1.4.2">ℒ</ci><ci id="S4.E5.m1.4.4.1.1.4.3a.cmml" xref="S4.E5.m1.4.4.1.1.4.3"><mtext id="S4.E5.m1.4.4.1.1.4.3.cmml" mathsize="70%" xref="S4.E5.m1.4.4.1.1.4.3">WS</mtext></ci></apply><apply id="S4.E5.m1.4.4.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.2"><plus id="S4.E5.m1.4.4.1.1.2.3.cmml" xref="S4.E5.m1.4.4.1.1.2.3"></plus><apply id="S4.E5.m1.4.4.1.1.2.4.cmml" xref="S4.E5.m1.4.4.1.1.2.4"><minus id="S4.E5.m1.4.4.1.1.2.4.1.cmml" xref="S4.E5.m1.4.4.1.1.2.4"></minus><apply id="S4.E5.m1.4.4.1.1.2.4.2.cmml" xref="S4.E5.m1.4.4.1.1.2.4.2"><times id="S4.E5.m1.4.4.1.1.2.4.2.1.cmml" xref="S4.E5.m1.4.4.1.1.2.4.2.1"></times><ci id="S4.E5.m1.4.4.1.1.2.4.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.4.2.2">𝑦</ci><apply id="S4.E5.m1.4.4.1.1.2.4.2.3.1.cmml" xref="S4.E5.m1.4.4.1.1.2.4.2.3.2"><log id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"></log><ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">𝑃</ci></apply></apply></apply><apply id="S4.E5.m1.4.4.1.1.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2"><times id="S4.E5.m1.4.4.1.1.2.2.3.cmml" xref="S4.E5.m1.4.4.1.1.2.2.3"></times><apply id="S4.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1"><minus id="S4.E5.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.1"></minus><ci id="S4.E5.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.2">𝑦</ci><cn id="S4.E5.m1.4.4.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E5.m1.4.4.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E5.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1"><log id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3"></log><apply id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1"><minus id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.1.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.1"></minus><cn id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.2.cmml" type="integer" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.2">1</cn><ci id="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.3.cmml" xref="S4.E5.m1.4.4.1.1.2.2.2.1.1.1.3">𝑃</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.4c">\displaystyle\mathcal{L}_{\text{WS}}=-y*\log(P)+(y-1)*\log(1-P),</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.4d">caligraphic_L start_POSTSUBSCRIPT WS end_POSTSUBSCRIPT = - italic_y ∗ roman_log ( italic_P ) + ( italic_y - 1 ) ∗ roman_log ( 1 - italic_P ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p8.5">where <math alttext="y" class="ltx_Math" display="inline" id="S4.SS3.p8.4.m1.1"><semantics id="S4.SS3.p8.4.m1.1a"><mi id="S4.SS3.p8.4.m1.1.1" xref="S4.SS3.p8.4.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.4.m1.1b"><ci id="S4.SS3.p8.4.m1.1.1.cmml" xref="S4.SS3.p8.4.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.4.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p8.4.m1.1d">italic_y</annotation></semantics></math> denotes the label (1 if the memory falls into the required memory set, and 0 otherwise), and <math alttext="P" class="ltx_Math" display="inline" id="S4.SS3.p8.5.m2.1"><semantics id="S4.SS3.p8.5.m2.1a"><mi id="S4.SS3.p8.5.m2.1.1" xref="S4.SS3.p8.5.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p8.5.m2.1b"><ci id="S4.SS3.p8.5.m2.1.1.cmml" xref="S4.SS3.p8.5.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p8.5.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p8.5.m2.1d">italic_P</annotation></semantics></math> is the predicted probability of the positive class.</p>
</div>
<div class="ltx_para" id="S4.SS3.p9">
<p class="ltx_p" id="S4.SS3.p9.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.SS3.p9.5.1">In PG</span>, our main objective is to develop a policy <math alttext="\pi_{\theta}(a|\mathbf{s})" class="ltx_Math" display="inline" id="S4.SS3.p9.1.m1.1"><semantics id="S4.SS3.p9.1.m1.1a"><mrow id="S4.SS3.p9.1.m1.1.1" xref="S4.SS3.p9.1.m1.1.1.cmml"><msub id="S4.SS3.p9.1.m1.1.1.3" xref="S4.SS3.p9.1.m1.1.1.3.cmml"><mi id="S4.SS3.p9.1.m1.1.1.3.2" xref="S4.SS3.p9.1.m1.1.1.3.2.cmml">π</mi><mi id="S4.SS3.p9.1.m1.1.1.3.3" xref="S4.SS3.p9.1.m1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.SS3.p9.1.m1.1.1.2" xref="S4.SS3.p9.1.m1.1.1.2.cmml">⁢</mo><mrow id="S4.SS3.p9.1.m1.1.1.1.1" xref="S4.SS3.p9.1.m1.1.1.1.1.1.cmml"><mo id="S4.SS3.p9.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS3.p9.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS3.p9.1.m1.1.1.1.1.1" xref="S4.SS3.p9.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS3.p9.1.m1.1.1.1.1.1.2" xref="S4.SS3.p9.1.m1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S4.SS3.p9.1.m1.1.1.1.1.1.1" xref="S4.SS3.p9.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS3.p9.1.m1.1.1.1.1.1.3" xref="S4.SS3.p9.1.m1.1.1.1.1.1.3.cmml">𝐬</mi></mrow><mo id="S4.SS3.p9.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS3.p9.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.1.m1.1b"><apply id="S4.SS3.p9.1.m1.1.1.cmml" xref="S4.SS3.p9.1.m1.1.1"><times id="S4.SS3.p9.1.m1.1.1.2.cmml" xref="S4.SS3.p9.1.m1.1.1.2"></times><apply id="S4.SS3.p9.1.m1.1.1.3.cmml" xref="S4.SS3.p9.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p9.1.m1.1.1.3.1.cmml" xref="S4.SS3.p9.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS3.p9.1.m1.1.1.3.2.cmml" xref="S4.SS3.p9.1.m1.1.1.3.2">𝜋</ci><ci id="S4.SS3.p9.1.m1.1.1.3.3.cmml" xref="S4.SS3.p9.1.m1.1.1.3.3">𝜃</ci></apply><apply id="S4.SS3.p9.1.m1.1.1.1.1.1.cmml" xref="S4.SS3.p9.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p9.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.p9.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.SS3.p9.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.p9.1.m1.1.1.1.1.1.2">𝑎</ci><ci id="S4.SS3.p9.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS3.p9.1.m1.1.1.1.1.1.3">𝐬</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.1.m1.1c">\pi_{\theta}(a|\mathbf{s})</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | bold_s )</annotation></semantics></math> that guides the agent in selecting actions <math alttext="a" class="ltx_Math" display="inline" id="S4.SS3.p9.2.m2.1"><semantics id="S4.SS3.p9.2.m2.1a"><mi id="S4.SS3.p9.2.m2.1.1" xref="S4.SS3.p9.2.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.2.m2.1b"><ci id="S4.SS3.p9.2.m2.1.1.cmml" xref="S4.SS3.p9.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.2.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.2.m2.1d">italic_a</annotation></semantics></math> based on constructed states <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S4.SS3.p9.3.m3.1"><semantics id="S4.SS3.p9.3.m3.1a"><mi id="S4.SS3.p9.3.m3.1.1" xref="S4.SS3.p9.3.m3.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.3.m3.1b"><ci id="S4.SS3.p9.3.m3.1.1.cmml" xref="S4.SS3.p9.3.m3.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.3.m3.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.3.m3.1d">bold_s</annotation></semantics></math>, aiming to maximize the cumulative reward <math alttext="R_{N}" class="ltx_Math" display="inline" id="S4.SS3.p9.4.m4.1"><semantics id="S4.SS3.p9.4.m4.1a"><msub id="S4.SS3.p9.4.m4.1.1" xref="S4.SS3.p9.4.m4.1.1.cmml"><mi id="S4.SS3.p9.4.m4.1.1.2" xref="S4.SS3.p9.4.m4.1.1.2.cmml">R</mi><mi id="S4.SS3.p9.4.m4.1.1.3" xref="S4.SS3.p9.4.m4.1.1.3.cmml">N</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.4.m4.1b"><apply id="S4.SS3.p9.4.m4.1.1.cmml" xref="S4.SS3.p9.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.4.m4.1.1.1.cmml" xref="S4.SS3.p9.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p9.4.m4.1.1.2.cmml" xref="S4.SS3.p9.4.m4.1.1.2">𝑅</ci><ci id="S4.SS3.p9.4.m4.1.1.3.cmml" xref="S4.SS3.p9.4.m4.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.4.m4.1c">R_{N}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.4.m4.1d">italic_R start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT</annotation></semantics></math>. We utilize the REINFORCE algorithm <cite class="ltx_cite ltx_citemacro_cite">Williams (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib37" title="">1992</a>); Silver et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib29" title="">2014</a>)</cite> for learning this policy, where the neural network parameters are denoted by <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS3.p9.5.m5.1"><semantics id="S4.SS3.p9.5.m5.1a"><mi id="S4.SS3.p9.5.m5.1.1" xref="S4.SS3.p9.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.5.m5.1b"><ci id="S4.SS3.p9.5.m5.1.1.cmml" xref="S4.SS3.p9.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.5.m5.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.5.m5.1d">italic_θ</annotation></semantics></math>. The loss function is formulated as:</p>
</div>
<div class="ltx_para" id="S4.SS3.p10">
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{PG}}=-R_{N}\ln\pi_{\theta}(a|\mathbf{s})." class="ltx_Math" display="block" id="S4.E6.m1.1"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><msub id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S4.E6.m1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.3.3a.cmml">PG</mtext></msub><mo id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.1.1.1.1.1a" xref="S4.E6.m1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><msub id="S4.E6.m1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.3.2.cmml">R</mi><mi id="S4.E6.m1.1.1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.1.1.3.3.cmml">N</mi></msub><mo id="S4.E6.m1.1.1.1.1.1.1.2" lspace="0.167em" xref="S4.E6.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.4" xref="S4.E6.m1.1.1.1.1.1.1.4.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.4.1" xref="S4.E6.m1.1.1.1.1.1.1.4.1.cmml">ln</mi><mo id="S4.E6.m1.1.1.1.1.1.1.4a" lspace="0.167em" xref="S4.E6.m1.1.1.1.1.1.1.4.cmml">⁡</mo><msub id="S4.E6.m1.1.1.1.1.1.1.4.2" xref="S4.E6.m1.1.1.1.1.1.1.4.2.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.4.2.2" xref="S4.E6.m1.1.1.1.1.1.1.4.2.2.cmml">π</mi><mi id="S4.E6.m1.1.1.1.1.1.1.4.2.3" xref="S4.E6.m1.1.1.1.1.1.1.4.2.3.cmml">θ</mi></msub></mrow><mo id="S4.E6.m1.1.1.1.1.1.1.2a" xref="S4.E6.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo fence="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml">𝐬</mi></mrow><mo id="S4.E6.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E6.m1.1.1.1.2" lspace="0em" xref="S4.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><eq id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2"></eq><apply id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2">ℒ</ci><ci id="S4.E6.m1.1.1.1.1.3.3a.cmml" xref="S4.E6.m1.1.1.1.1.3.3"><mtext id="S4.E6.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S4.E6.m1.1.1.1.1.3.3">PG</mtext></ci></apply><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><minus id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1"></minus><apply id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.2"></times><apply id="S4.E6.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.2">𝑅</ci><ci id="S4.E6.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.1.1.1.1.1.1.4"><ln id="S4.E6.m1.1.1.1.1.1.1.4.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.4.1"></ln><apply id="S4.E6.m1.1.1.1.1.1.1.4.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.4.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.4.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.4.2.2">𝜋</ci><ci id="S4.E6.m1.1.1.1.1.1.1.4.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.4.2.3">𝜃</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.2">𝑎</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3">𝐬</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\mathcal{L}_{\text{PG}}=-R_{N}\ln\pi_{\theta}(a|\mathbf{s}).</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.1d">caligraphic_L start_POSTSUBSCRIPT PG end_POSTSUBSCRIPT = - italic_R start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT roman_ln italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_a | bold_s ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p11">
<p class="ltx_p" id="S4.SS3.p11.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p11.1.1">Inference Stage of <span class="ltx_text ltx_font_typewriter" id="S4.SS3.p11.1.1.1">EMG-RAG</span>.</span> As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.F2" title="Figure 2 ‣ 4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>, the inference involves three steps: (a) collecting newly recorded memories from users and editing their EMGs; (b) using the edited EMGs to traverse the graph and retrieve relevant memories for LLM generation; (c) integrating the generated answers to serve users across three downstream applications.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Discussion on Applications and Cold-start</h3>
<div class="ltx_para ltx_noindent" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p1.1.1">Applications of the Personalized Agents.</span> As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.F2" title="Figure 2 ‣ 4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>(c), we explore the capabilities of personalized agents in three scenarios: (1) question answering, (2) autofill forms, and (3) user services. For (1), <span class="ltx_text ltx_font_typewriter" id="S4.SS4.p1.1.2">EMG-RAG</span> can generate answers to users’ questions when they interact with the smartphone AI assistants. For (2), the goal is to extract personal information from users’ EMGs to automatically fill out various online forms, such as flight and hotel bookings.
To achieve this, we input form-related questions (e.g., “What is the user’s mobile number?”) into the LLM and use the generated entities to complete the forms. For (3), we focus on two specific domains. a) reminder service: It involves reminding users of recent events and times. To achieve this, we query a LLM for information about a user’s recent events and their associated times. b) travel service: We assist users with navigation by providing the address of a destination they might want to visit. Further, we integrate the generated answers (e.g., events, times, addresses) with external tools such as calendar or map apps to provide the services for users.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS4.p2.1.1">Handling the Cold-start Problem.</span>
Given that <span class="ltx_text ltx_font_typewriter" id="S4.SS4.p2.1.2">EMG-RAG</span> relies on generated questions for training, it may encounter a potential cold-start issue when deploying to answer real user questions. To address this issue, we utilize online learning to continuously fine-tune the agent using newly recorded questions and manually written answers, as outlined in Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.E6" title="In 4.3 MDP for Selecting Memories on EMGs ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">6</span></a>. This approach aims to ensure that the model’s policy remains up-to-date for online usage. We validate this method through online A/B testing, and the results demonstrate improvements in user experience, highlighting the positive impact of this strategy in practice.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>
<div class="ltx_para ltx_noindent" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p1.1.1">Dataset and Ground Truth.</span> We conduct experiments on a real-world business dataset containing approximately 11.35 billion raw text data (including conversations and screenshot contents) from an AI assistant product collected between March 2024 and June 2024. After data cleaning, the dataset forms around 0.35 billion memories. We follow the data distribution to randomly sample 2,000 users for training and 500 users for testing.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">As detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS1" title="4.1 Data Collection ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">4.1</span></a>, we establish the ground truth for the applications of question answering and autofill forms/user services using GPT-4 generated answers and key entities (e.g., identification number, address, and time), respectively. We provide a quality evaluation for the collected dataset in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.SS2" title="5.2 Experimental Results ‣ 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">5.2</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p3.1.1">Baselines.</span> We compare <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p3.1.2">EMG-RAG</span> with the following RAG methods. 1) NiaH <cite class="ltx_cite ltx_citemacro_cite">Briakou et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib2" title="">2023</a>)</cite>: It simply inputs all of the users’ memories into a LLM within the context window size to generate the answer. 2) Naive <cite class="ltx_cite ltx_citemacro_cite">Ma et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib17" title="">2023</a>)</cite>: It implements a basic RAG execution process involving indexing, retrieval, and generation. 3) M-RAG <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib35" title="">2024</a>)</cite>: It partitions a database and employs Multi-Agent RL to train two agents for RAG. Agent-S selects a database partition, while Agent-R refines the stored memories within that partition to generate a better answer. In our adaptation, we omit Agent-R since, in our scenario, the generated answers must be grounded in the user’s personal memories, which cannot be altered due to potential risks. 4) Keqing <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib32" title="">2023a</a>)</cite>: The knowledge graph-based method decomposes a question into sub-questions, retrieves candidate entities, generates answers for each sub-question, and then integrates them into a comprehensive final answer.</p>
</div>
<div class="ltx_para" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1">In addition, we integrate the RAG methods into three typical LLM architectures. 1) GPT-4 <cite class="ltx_cite ltx_citemacro_cite">OpenAI (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib23" title="">2023</a>)</cite> is a Transformer-based pre-trained model known for its human-level performance. 2) ChatGLM3-6B <cite class="ltx_cite ltx_citemacro_cite">Du et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib6" title="">2022</a>)</cite> is a long-text dialogue model with a sequence length of 32K. 3) PanGu-38B <cite class="ltx_cite ltx_citemacro_cite">Ren et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib26" title="">2023</a>)</cite> is a dialogue sub-model of the PanGu series, which follows a Mixture of Experts (MoE) architecture.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p5">
<p class="ltx_p" id="S5.SS1.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p5.1.1">Evaluation Metrics.</span> We evaluate the effectiveness of <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p5.1.2">EMG-RAG</span> in three downstream applications. For question answering, we assess the quality of generated answers with the ground truth, and reporting ROUGE (R-1/2/L) <cite class="ltx_cite ltx_citemacro_cite">Lin (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib15" title="">2004</a>)</cite> and BLEU <cite class="ltx_cite ltx_citemacro_cite">Post (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib24" title="">2018</a>)</cite> scores. For autofill forms and user services, we generate key entities and report Exact Match (EM) accuracy. Overall, higher values (i.e., ROUGE, BLEU, EM) indicate better results <span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We remark that all reported results are statistically significant, as confirmed by a t-test with <math alttext="p&lt;0.05" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><mrow id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml"><mi id="footnote1.m1.1.1.2" xref="footnote1.m1.1.1.2.cmml">p</mi><mo id="footnote1.m1.1.1.1" xref="footnote1.m1.1.1.1.cmml">&lt;</mo><mn id="footnote1.m1.1.1.3" xref="footnote1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><apply id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1"><lt id="footnote1.m1.1.1.1.cmml" xref="footnote1.m1.1.1.1"></lt><ci id="footnote1.m1.1.1.2.cmml" xref="footnote1.m1.1.1.2">𝑝</ci><cn id="footnote1.m1.1.1.3.cmml" type="float" xref="footnote1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">p&lt;0.05</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">italic_p &lt; 0.05</annotation></semantics></math>.</span></span></span>.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Effectiveness of <span class="ltx_text ltx_font_typewriter" id="S5.T2.2.1">EMG-RAG</span> in downstream applications.</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S5.T2.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.3.1.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.3.1.1.1" rowspan="2"><span class="ltx_text" id="S5.T2.3.1.1.1.1">LLM</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.3.1.1.2" rowspan="2"><span class="ltx_text" id="S5.T2.3.1.1.2.1">RAG</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="4" id="S5.T2.3.1.1.3">Question Answering</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.3.1.1.4" rowspan="2"><span class="ltx_text" id="S5.T2.3.1.1.4.1">
<span class="ltx_tabular ltx_align_middle" id="S5.T2.3.1.1.4.1.1">
<span class="ltx_tr" id="S5.T2.3.1.1.4.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.3.1.1.4.1.1.1.1">Autofill Forms</span></span>
<span class="ltx_tr" id="S5.T2.3.1.1.4.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S5.T2.3.1.1.4.1.1.2.1">(EM)</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S5.T2.3.1.1.5">User Services (EM)</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.2.2.1">R-1</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.3.2.2.2">R-2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.2.2.3">R-L</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.3.2.2.4">BLEU</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.2.2.5">Reminder</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.2.2.6">Travel</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.3.3.3.1">GPT-4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.3.3.3.2">NiaH</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.3.3.3">79.89</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.3.3.3.4">64.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.3.3.5">70.66</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.3.3.3.6">38.72</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.3.3.3.7">84.86</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.3.3.8">84.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.3.3.9">94.81</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.3.4.4.1">GPT-4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.4.4.2">Naive</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.4.4.3">70.87</td>
<td class="ltx_td ltx_align_left" id="S5.T2.3.4.4.4">58.34</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.4.4.5">66.82</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.4.4.6">46.65</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.4.4.7">78.40</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.4.4.8">85.34</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.4.4.9">94.52</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.3.5.5.1">GPT-4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.5.5.2">M-RAG</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.5.5.3">88.71</td>
<td class="ltx_td ltx_align_left" id="S5.T2.3.5.5.4">77.18</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.5.5.5">84.74</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.5.5.6">64.16</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.5.5.7">90.87</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.5.5.8">93.75</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.5.5.9">86.67</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.3.6.6.1">GPT-4</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.6.6.2">Keqing</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.6.6.3">72.11</td>
<td class="ltx_td ltx_align_left" id="S5.T2.3.6.6.4">57.19</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.6.6.5">65.46</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.6.6.6">35.89</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.6.6.7">82.03</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.6.6.8">90.17</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.6.6.9">72.71</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.7.7">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T2.3.7.7.1">GPT-4</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.3.7.7.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.3.7.7.2.1">EMG-RAG</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.7.7.3"><span class="ltx_text ltx_font_bold" id="S5.T2.3.7.7.3.1">93.46</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T2.3.7.7.4"><span class="ltx_text ltx_font_bold" id="S5.T2.3.7.7.4.1">83.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.7.7.5"><span class="ltx_text ltx_font_bold" id="S5.T2.3.7.7.5.1">88.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.3.7.7.6"><span class="ltx_text ltx_font_bold" id="S5.T2.3.7.7.6.1">75.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.3.7.7.7"><span class="ltx_text ltx_font_bold" id="S5.T2.3.7.7.7.1">92.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.7.7.8"><span class="ltx_text ltx_font_bold" id="S5.T2.3.7.7.8.1">96.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.7.7.9"><span class="ltx_text ltx_font_bold" id="S5.T2.3.7.7.9.1">91.46</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.8.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T2.3.8.8.1">ChatGLM3-6B</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.8.8.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.3.8.8.2.1">EMG-RAG</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.8.8.3">85.31</td>
<td class="ltx_td ltx_align_left" id="S5.T2.3.8.8.4">76.03</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.8.8.5">82.32</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.8.8.6">56.88</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.3.8.8.7">85.71</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.8.8.8">87.50</td>
<td class="ltx_td ltx_align_center" id="S5.T2.3.8.8.9">81.25</td>
</tr>
<tr class="ltx_tr" id="S5.T2.3.9.9">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S5.T2.3.9.9.1">PanGu-38B</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.3.9.9.2"><span class="ltx_text ltx_font_typewriter" id="S5.T2.3.9.9.2.1">EMG-RAG</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.3.9.9.3">91.64</td>
<td class="ltx_td ltx_align_left ltx_border_b" id="S5.T2.3.9.9.4">82.86</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.3.9.9.5">86.71</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.3.9.9.6">75.11</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.3.9.9.7">90.99</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.3.9.9.8">96.41</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.3.9.9.9">89.05</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Effectiveness of <span class="ltx_text ltx_font_typewriter" id="S5.T3.2.1">EMG-RAG</span> for continuous edits.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.3">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.3.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.3.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">Duration (weeks)</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T3.3.1.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T3.3.1.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">2</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T3.3.1.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">3</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T3.3.1.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">4</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.3.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"># of edits</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T3.3.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">2,515</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T3.3.2.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">9,644</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T3.3.2.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">2,096</td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T3.3.2.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">6,290</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.3.3.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">Apps (GPT-4)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">QA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">AF</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.3.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">US</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">QA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">AF</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.3.3.7" style="padding-left:3.0pt;padding-right:3.0pt;">US</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.3.8" style="padding-left:3.0pt;padding-right:3.0pt;">QA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.3.9" style="padding-left:3.0pt;padding-right:3.0pt;">AF</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.3.3.10" style="padding-left:3.0pt;padding-right:3.0pt;">US</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.3.11" style="padding-left:3.0pt;padding-right:3.0pt;">QA</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.3.12" style="padding-left:3.0pt;padding-right:3.0pt;">AF</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.3.3.13" style="padding-left:3.0pt;padding-right:3.0pt;">US</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T3.3.4.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">M-RAG</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">88.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">91.67</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">90.28</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">86.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">88.89</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.4.4.7" style="padding-left:3.0pt;padding-right:3.0pt;">89.39</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.4.8" style="padding-left:3.0pt;padding-right:3.0pt;">85.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.4.9" style="padding-left:3.0pt;padding-right:3.0pt;">87.50</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.3.4.4.10" style="padding-left:3.0pt;padding-right:3.0pt;">87.83</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.4.11" style="padding-left:3.0pt;padding-right:3.0pt;">85.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.4.12" style="padding-left:3.0pt;padding-right:3.0pt;">83.33</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.3.4.4.13" style="padding-left:3.0pt;padding-right:3.0pt;">83.21</td>
</tr>
<tr class="ltx_tr" id="S5.T3.3.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T3.3.5.5.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_typewriter" id="S5.T3.3.5.5.1.1">EMG-RAG</span></th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.5.5.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.2.1">95.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.5.5.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.3.1">93.75</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.3.5.5.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.4.1">93.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.5.1">96.93</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.5.5.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.6.1">95.83</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.3.5.5.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.7.1">95.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.5.5.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.8.1">94.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.5.5.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.9.1">96.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T3.3.5.5.10" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.10.1">96.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.5.5.11" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.11.1">94.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.5.5.12" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.12.1">97.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T3.3.5.5.13" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.3.5.5.13.1">97.54</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Ablation study.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.1.1.1" style="padding-left:4.5pt;padding-right:4.5pt;">Components</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.1.2" style="padding-left:4.5pt;padding-right:4.5pt;">R-1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.1.3" style="padding-left:4.5pt;padding-right:4.5pt;">R-2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.1.4" style="padding-left:4.5pt;padding-right:4.5pt;">R-L</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.1.1.5" style="padding-left:4.5pt;padding-right:4.5pt;">BLEU</th>
</tr>
<tr class="ltx_tr" id="S5.T4.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.2.2.1" style="padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text ltx_font_typewriter" id="S5.T4.1.2.2.1.1">EMG-RAG</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.2.2.2" style="padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.2.2.2.1">93.46</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.2.2.3" style="padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.2.2.3.1">83.55</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.2.2.4" style="padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.2.2.4.1">88.06</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T4.1.2.2.5" style="padding-left:4.5pt;padding-right:4.5pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.1.2.2.5.1">75.99</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T4.1.3.1.1" style="padding-left:4.5pt;padding-right:4.5pt;">w/o Act. Nodes</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.3.1.2" style="padding-left:4.5pt;padding-right:4.5pt;">90.96</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.3.1.3" style="padding-left:4.5pt;padding-right:4.5pt;">82.72</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.3.1.4" style="padding-left:4.5pt;padding-right:4.5pt;">86.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.3.1.5" style="padding-left:4.5pt;padding-right:4.5pt;">65.07</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T4.1.4.2.1" style="padding-left:4.5pt;padding-right:4.5pt;">w/o WS</th>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.2.2" style="padding-left:4.5pt;padding-right:4.5pt;">92.95</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.2.3" style="padding-left:4.5pt;padding-right:4.5pt;">82.52</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.2.4" style="padding-left:4.5pt;padding-right:4.5pt;">86.49</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.2.5" style="padding-left:4.5pt;padding-right:4.5pt;">69.13</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T4.1.5.3.1" style="padding-left:4.5pt;padding-right:4.5pt;">w/o PG</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.1.5.3.2" style="padding-left:4.5pt;padding-right:4.5pt;">90.59</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.1.5.3.3" style="padding-left:4.5pt;padding-right:4.5pt;">80.69</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.1.5.3.4" style="padding-left:4.5pt;padding-right:4.5pt;">86.19</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T4.1.5.3.5" style="padding-left:4.5pt;padding-right:4.5pt;">65.65</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p6">
<p class="ltx_p" id="S5.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S5.SS1.p6.1.1">Implementation Details.</span> We implement <span class="ltx_text ltx_font_typewriter" id="S5.SS1.p6.1.2">EMG-RAG</span> and other baselines in Python 3.7, using the Faiss library <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://github.com/facebookresearch/faiss</span></span></span> for index construction. We utilize TransE <cite class="ltx_cite ltx_citemacro_cite">Bordes et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib1" title="">2013</a>)</cite> to obtain embeddings of entities and relations, and CPT-Text <cite class="ltx_cite ltx_citemacro_cite">Neelakantan et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib22" title="">2022</a>)</cite> to obtain embeddings of questions and memories. The RL agent is implemented with a two-layer neural network, where the hidden layer consists of 20 neurons and uses the tanh activation function. The output layer has 2 neurons corresponding to the action space. Several built-in RL codes are available in <cite class="ltx_cite ltx_citemacro_cite">Wang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib34" title="">2021</a>); Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib44" title="">2023b</a>)</cite>. The hyperparameter <math alttext="K" class="ltx_Math" display="inline" id="S5.SS1.p6.1.m1.1"><semantics id="S5.SS1.p6.1.m1.1a"><mi id="S5.SS1.p6.1.m1.1.1" xref="S5.SS1.p6.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.1.m1.1b"><ci id="S5.SS1.p6.1.m1.1.1.cmml" xref="S5.SS1.p6.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p6.1.m1.1d">italic_K</annotation></semantics></math> for activated nodes is empirically set to 3. We generate 1,000 episodes for the warm-start stage and 100 episodes for the policy gradient stage. We use the Adam stochastic gradient descent with a learning rate of 0.001 to optimize the policy, and the reward discount is set to 0.99. We cache the generated QA pairs <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://github.com/zilliztech/GPTCache</span></span></span> during training to boost efficiency.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Experimental Results</h3>
<div class="ltx_para ltx_noindent" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p1.1.1">(1) Effectiveness evaluation (question answering).</span> We compare the <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.2">EMG-RAG</span> with other RAG methods for question answering on three LLMs. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.T2" title="Table 2 ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>, we observe that the performance of <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.3">EMG-RAG</span> consistently outperforms the baselines. For example, it improves upon the best baseline method, M-RAG, by 5.3%, 8.3%, 3.9%, and 18.4% in terms of R-1, R-2, R-L, and BLEU, respectively. This improvement is due to two main factors: 1) it captures complex relationships between memories with the EMG, and 2) it effectively selects essential memories for the RAG execution. Additionally, GPT-4 demonstrates superior performance compared to other LLMs, and <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p1.1.4">EMG-RAG</span> shows comparable performance to M-RAG even when deployed on the relatively smaller ChatGLM3-6B.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.1">(2) Effectiveness evaluation (autofill forms).</span> We further evaluate the <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p2.1.2">EMG-RAG</span> for autofill forms, and it shows consistent improvement, as detailed in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.T2" title="Table 2 ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>. For example, it surpasses M-RAG by 2.2% in terms of exact match accuracy.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">(3) Effectiveness evaluation (user services).</span> We target two specific domains of user services: 1) reminders of important events and their times, and 2) travel services involving destination addresses for navigation. We report the exact match accuracy for events and times (reminders), and addresses (travel) in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.T2" title="Table 2 ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a>. The improvements over M-RAG for the two tasks are 2.9% and 5.5%.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p4">
<p class="ltx_p" id="S5.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p4.1.1">(4) Effectiveness evaluation (continuous edits).</span> We evaluate the effectiveness of <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p4.1.2">EMG-RAG</span> in supporting continuous edits over a period of 4 weeks. The results, in terms of R-L for question answering (QA), and exact match accuracy for autofill forms (AF) and user services (US, combining reminder and travel results), are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.T3" title="Table 3 ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">3</span></a>. We observe that <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p4.1.3">EMG-RAG</span> consistently outperforms M-RAG, by approximately 10.6%, 9.5%, and 9.7% for QA, AF, and US, respectively. This is owing to the editability of <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p4.1.4">EMG-RAG</span>, whereas M-RAG simply incorporates edits into a database, where many memories may become outdated for answering. Additionally, we report the total number of edits involved in the testing set for each week.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS2.p5">
<p class="ltx_p" id="S5.SS2.p5.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p5.1.1">(5) Ablation study.</span> To evaluate the effectiveness of different components in <span class="ltx_text ltx_font_typewriter" id="S5.SS2.p5.1.2">EMG-RAG</span>, we conduct an ablation study. (1) We omit the design of activated nodes, and the search starts from the root of EMG. (2) We remove the warm-start stage (WS) and only train the policy in the policy gradient stage (PG). (3) We remove the PG and use the WS only. For (1), it results in a performance drop (e.g., R-1 from 93.46 to 90.96), because many irrelevant memories (as noises) may be retrieved if the search starts from the root. For (2) and (3), we observe that the PG contributes the most to the result (e.g., R-1 from 93.46 to 90.59), because it can explicitly optimize the performance end-to-end, and WS provides a basic memory selection ability for the agent.</p>
</div>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Impacts of the number of <math alttext="K" class="ltx_Math" display="inline" id="S5.T5.2.m1.1"><semantics id="S5.T5.2.m1.1b"><mi id="S5.T5.2.m1.1.1" xref="S5.T5.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.T5.2.m1.1c"><ci id="S5.T5.2.m1.1.1.cmml" xref="S5.T5.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.2.m1.1d">K</annotation><annotation encoding="application/x-llamapun" id="S5.T5.2.m1.1e">italic_K</annotation></semantics></math> for activated nodes.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.3">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.3.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><math alttext="K" class="ltx_Math" display="inline" id="S5.T5.3.1.1.m1.1"><semantics id="S5.T5.3.1.1.m1.1a"><mi id="S5.T5.3.1.1.m1.1.1" xref="S5.T5.3.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.T5.3.1.1.m1.1b"><ci id="S5.T5.3.1.1.m1.1.1.cmml" xref="S5.T5.3.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T5.3.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.T5.3.1.1.m1.1d">italic_K</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.3.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.3.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">2</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.3.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.3.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T5.3.1.6" style="padding-left:3.0pt;padding-right:3.0pt;">5</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.3.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T5.3.2.1.1" style="padding-left:3.0pt;padding-right:3.0pt;">R-L</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.3.2.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">84.55</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.3.2.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">86.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.3.2.1.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.3.2.1.4.1">88.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.3.2.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">88.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.3.2.1.6" style="padding-left:3.0pt;padding-right:3.0pt;">87.19</td>
</tr>
<tr class="ltx_tr" id="S5.T5.3.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T5.3.3.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">Inference (s)</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.3.3.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">1.35</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.3.3.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">1.63</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.3.3.2.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T5.3.3.2.4.1">2.14</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.3.3.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">2.55</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T5.3.3.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">3.32</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p6">
<p class="ltx_p" id="S5.SS2.p6.6"><span class="ltx_text ltx_font_bold" id="S5.SS2.p6.1.1">(6) Parameter study (<math alttext="K" class="ltx_Math" display="inline" id="S5.SS2.p6.1.1.m1.1"><semantics id="S5.SS2.p6.1.1.m1.1a"><mi id="S5.SS2.p6.1.1.m1.1.1" xref="S5.SS2.p6.1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.1.1.m1.1b"><ci id="S5.SS2.p6.1.1.m1.1.1.cmml" xref="S5.SS2.p6.1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.1.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p6.1.1.m1.1d">italic_K</annotation></semantics></math> for activated nodes).</span> We vary the value of <math alttext="K" class="ltx_Math" display="inline" id="S5.SS2.p6.2.m1.1"><semantics id="S5.SS2.p6.2.m1.1a"><mi id="S5.SS2.p6.2.m1.1.1" xref="S5.SS2.p6.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.2.m1.1b"><ci id="S5.SS2.p6.2.m1.1.1.cmml" xref="S5.SS2.p6.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.2.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p6.2.m1.1d">italic_K</annotation></semantics></math> from 1 to 5 and report the R-L score for the question answering task, along with the corresponding inference times. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.T5" title="Table 5 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">5</span></a>, we observe that <math alttext="K=3" class="ltx_Math" display="inline" id="S5.SS2.p6.3.m2.1"><semantics id="S5.SS2.p6.3.m2.1a"><mrow id="S5.SS2.p6.3.m2.1.1" xref="S5.SS2.p6.3.m2.1.1.cmml"><mi id="S5.SS2.p6.3.m2.1.1.2" xref="S5.SS2.p6.3.m2.1.1.2.cmml">K</mi><mo id="S5.SS2.p6.3.m2.1.1.1" xref="S5.SS2.p6.3.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.p6.3.m2.1.1.3" xref="S5.SS2.p6.3.m2.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.3.m2.1b"><apply id="S5.SS2.p6.3.m2.1.1.cmml" xref="S5.SS2.p6.3.m2.1.1"><eq id="S5.SS2.p6.3.m2.1.1.1.cmml" xref="S5.SS2.p6.3.m2.1.1.1"></eq><ci id="S5.SS2.p6.3.m2.1.1.2.cmml" xref="S5.SS2.p6.3.m2.1.1.2">𝐾</ci><cn id="S5.SS2.p6.3.m2.1.1.3.cmml" type="integer" xref="S5.SS2.p6.3.m2.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.3.m2.1c">K=3</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p6.3.m2.1d">italic_K = 3</annotation></semantics></math> provides the best effectiveness while maintaining reasonable inference time. When <math alttext="K" class="ltx_Math" display="inline" id="S5.SS2.p6.4.m3.1"><semantics id="S5.SS2.p6.4.m3.1a"><mi id="S5.SS2.p6.4.m3.1.1" xref="S5.SS2.p6.4.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.4.m3.1b"><ci id="S5.SS2.p6.4.m3.1.1.cmml" xref="S5.SS2.p6.4.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.4.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p6.4.m3.1d">italic_K</annotation></semantics></math> is smaller, the limited number of activated nodes for graph traversal restricts the ability to find crucial memories. Conversely, when <math alttext="K" class="ltx_Math" display="inline" id="S5.SS2.p6.5.m4.1"><semantics id="S5.SS2.p6.5.m4.1a"><mi id="S5.SS2.p6.5.m4.1.1" xref="S5.SS2.p6.5.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.5.m4.1b"><ci id="S5.SS2.p6.5.m4.1.1.cmml" xref="S5.SS2.p6.5.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.5.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p6.5.m4.1d">italic_K</annotation></semantics></math> is larger, it activates many nodes and returns numerous memories, potentially introducing noise that hinders the LLM generation. As expected, the inference time increases as <math alttext="K" class="ltx_Math" display="inline" id="S5.SS2.p6.6.m5.1"><semantics id="S5.SS2.p6.6.m5.1a"><mi id="S5.SS2.p6.6.m5.1.1" xref="S5.SS2.p6.6.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p6.6.m5.1b"><ci id="S5.SS2.p6.6.m5.1.1.cmml" xref="S5.SS2.p6.6.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p6.6.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p6.6.m5.1d">italic_K</annotation></semantics></math> increases.</p>
</div>
<figure class="ltx_table" id="S5.T6">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Online A/B test.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S5.T6.1.1.1.1" rowspan="2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S5.T6.1.1.1.1.1">Apps</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3" id="S5.T6.1.1.1.2" style="padding-left:2.0pt;padding-right:2.0pt;">Cold-start</th>
</tr>
<tr class="ltx_tr" id="S5.T6.1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T6.1.2.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">A (old <span class="ltx_text ltx_font_typewriter" id="S5.T6.1.2.2.1.1">EMG-RAG</span>)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T6.1.2.2.2" style="padding-left:2.0pt;padding-right:2.0pt;">B (new <span class="ltx_text ltx_font_typewriter" id="S5.T6.1.2.2.2.1">EMG-RAG</span>)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T6.1.2.2.3" style="padding-left:2.0pt;padding-right:2.0pt;">Impr</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T6.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T6.1.3.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">QA</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.1.2" style="padding-left:2.0pt;padding-right:2.0pt;">88.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.1.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.3.1.3.1">91.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T6.1.3.1.4" style="padding-left:2.0pt;padding-right:2.0pt;">4.5%</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T6.1.4.2.1" style="padding-left:2.0pt;padding-right:2.0pt;">AF</th>
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.2.2" style="padding-left:2.0pt;padding-right:2.0pt;">92.86</td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.2.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.4.2.3.1">95.85</span></td>
<td class="ltx_td ltx_align_center" id="S5.T6.1.4.2.4" style="padding-left:2.0pt;padding-right:2.0pt;">3.2%</td>
</tr>
<tr class="ltx_tr" id="S5.T6.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S5.T6.1.5.3.1" style="padding-left:2.0pt;padding-right:2.0pt;">US</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T6.1.5.3.2" style="padding-left:2.0pt;padding-right:2.0pt;">94.66</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T6.1.5.3.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T6.1.5.3.3.1">97.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T6.1.5.3.4" style="padding-left:2.0pt;padding-right:2.0pt;">3.1%</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p7">
<p class="ltx_p" id="S5.SS2.p7.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p7.1.1">(7) Online A/B test.</span> We perform an online A/B test over one month to compare the new system with the existing one. During this period, we collect real users’ questions and manually written answers to fine-tune the model. The results, presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.T6" title="Table 6 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">6</span></a>, show further improvements across all applications. It highlights a cold-start problem caused by distributional shifts between questions generated by GPT-4 and those posed by real users. We use GPT-4-generated questions for model training because they cover diverse scenarios and allow for the automatic collection of required memories, enabling large-scale training. Once the trained model is deployed, we fine-tune it using real user questions and manually written answers through online learning as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S4.SS4" title="4.4 Discussion on Applications and Cold-start ‣ 4 Methodology ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">4.4</span></a>.</p>
</div>
<figure class="ltx_table" id="S5.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span>Data quality evaluation.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T7.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T7.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T7.1.1.1.1">Data Quality</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T7.1.1.1.2">QA</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S5.T7.1.1.1.3">AF</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T7.1.1.1.4">US</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T7.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.1.1">Human Evaluation</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.1.2">91.1%</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T7.1.2.1.3">87.5%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T7.1.2.1.4">97.4%</td>
</tr>
<tr class="ltx_tr" id="S5.T7.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.3.2.1">GPT-4 Evaluation</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.3.2.2">93.3%</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T7.1.3.2.3">98.7%</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T7.1.3.2.4">99.3%</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p8">
<p class="ltx_p" id="S5.SS2.p8.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p8.1.1">(8) Data quality evaluation.</span> We evaluate data quality across three data collection steps. For Step-1, we note that OCR is a well-established technology used to extract information from app screenshots in our study. Given that the printed fonts from apps are typically standard, OCR is not expected to face significant challenges. For Step-2 and Step-3, we utilize the powerful GPT-4 model for memory and QA pair collection and assess quality from two perspectives: (1) Qualitatively: We present memory samples from our focus domains as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.T8" title="Table 8 ‣ A.2 Memory Types and Subclasses ‣ Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">8</span></a>, which generally meet the expected precision. (2) Quantitatively: We assess quality using human evaluation and LLM evaluation. The results are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.T7" title="Table 7 ‣ 5.2 Experimental Results ‣ 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">7</span></a>. For human evaluation, we randomly selected 10% of the user data and asked five participants to annotate the answers (for QA) and entities (for AF and US) based on the collected questions and memories. By comparing the human-annotated answers and entities with those generated by GPT-4, we report a R-L score of 91.1% for QA and exact match scores of 87.5% for AF and 97.4% for US. These results demonstrate the high accuracy of the collected data. For LLM evaluation, we employ a method where GPT-4 self-verifies whether it can generate answers (or entities) that are consistent with those obtained during the data collection, based on the collected questions and required memories. The evaluation reveals the scores of 93.3%, 98.7%, and 99.3% for the three applications, respectively, demonstrating a high level of consistency and effectiveness.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we present a novel task of creating personalized agents powered by LLMs, which leverage users’ personal memories to enhance three downstream applications. Our solution, <span class="ltx_text ltx_font_typewriter" id="S6.p1.1.1">EMG-RAG</span>, combines RAG techniques with an EMG to tackle challenges in data collection, editability, and selectability. Extensive experiments are conducted to confirm the effectiveness of <span class="ltx_text ltx_font_typewriter" id="S6.p1.1.2">EMG-RAG</span>.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Limitations</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">For limitations, while only the parameters of the RL agent are trained and the parameters of the LLMs remain fixed, the training efficiency is not higher than that of a Naive RAG setup. This inefficiency stems from the need to query the LLM during training to obtain answers for optimization.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bordes et al. (2013)</span>
<span class="ltx_bibblock">
Antoine Bordes, Nicolas Usunier, Alberto Garcia-Duran, Jason Weston, and Oksana Yakhnenko. 2013.

</span>
<span class="ltx_bibblock">Translating embeddings for modeling multi-relational data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">NeurIPS</em>, 26.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Briakou et al. (2023)</span>
<span class="ltx_bibblock">
Eleftheria Briakou, Colin Cherry, and George Foster. 2023.

</span>
<span class="ltx_bibblock">Searching for needles in a haystack: On the role of incidental bilingualism in palm’s translation capability.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">arXiv preprint arXiv:2305.10266</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cordella et al. (2004)</span>
<span class="ltx_bibblock">
Luigi P Cordella, Pasquale Foggia, Carlo Sansone, and Mario Vento. 2004.

</span>
<span class="ltx_bibblock">A (sub) graph isomorphism algorithm for matching large graphs.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">IEEE TPAMI</em>, 26(10):1367–1372.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Das et al. (2021)</span>
<span class="ltx_bibblock">
Rajarshi Das, Manzil Zaheer, Dung Thai, Ameya Godbole, Ethan Perez, Jay Yoon Lee, Lizhen Tan, Lazaros Polymenakos, and Andrew Mccallum. 2021.

</span>
<span class="ltx_bibblock">Case-based reasoning for natural language queries over knowledge bases.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">EMNLP</em>, pages 9594–9611.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">De Cao et al. (2021)</span>
<span class="ltx_bibblock">
Nicola De Cao, Wilker Aziz, and Ivan Titov. 2021.

</span>
<span class="ltx_bibblock">Editing factual knowledge in language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">EMNLP</em>, pages 6491–6506.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Du et al. (2022)</span>
<span class="ltx_bibblock">
Zhengxiao Du, Yujie Qian, Xiao Liu, Ming Ding, Jiezhong Qiu, Zhilin Yang, and Jie Tang. 2022.

</span>
<span class="ltx_bibblock">Glm: General language model pretraining with autoregressive blank infilling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">ACL</em>, pages 320–335.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. (2024)</span>
<span class="ltx_bibblock">
Dongge Han, Trevor McInroe, Adam Jelley, Stefano V Albrecht, Peter Bell, and Amos Storkey. 2024.

</span>
<span class="ltx_bibblock">Llm-personalize: Aligning llm planners with human preferences via reinforced self-training for housekeeping robots.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2404.14285</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hongru et al. (2023)</span>
<span class="ltx_bibblock">
WANG Hongru, Rui Wang, Fei Mi, Yang Deng, WANG Zezhong, Bin Liang, Ruifeng Xu, and Kam-Fai Wong. 2023.

</span>
<span class="ltx_bibblock">Cue-cot: Chain-of-thought prompting for responding to in-depth dialogue questions with llms.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">EMNLP (Findings)</em>, pages 12047–12064.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2023)</span>
<span class="ltx_bibblock">
Ziniu Hu, Ahmet Iscen, Chen Sun, Zirui Wang, Kai-Wei Chang, Yizhou Sun, Cordelia Schmid, David A Ross, and Alireza Fathi. 2023.

</span>
<span class="ltx_bibblock">Reveal: Retrieval-augmented visual-language pre-training with multi-source multimodal knowledge memory.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">CVPR</em>, pages 23369–23379.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2023)</span>
<span class="ltx_bibblock">
Jinhao Jiang, Kun Zhou, Zican Dong, Keming Ye, Wayne Xin Zhao, and Ji-Rong Wen. 2023.

</span>
<span class="ltx_bibblock">Structgpt: A general framework for large language model to reason over structured data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2305.09645</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2020)</span>
<span class="ltx_bibblock">
Hyunwoo Kim, Byeongchang Kim, and Gunhee Kim. 2020.

</span>
<span class="ltx_bibblock">Will i sound like me? improving persona consistency in dialogues through pragmatic self-consciousness.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">EMNLP</em>, pages 904–916.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al. (2020)</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, et al. 2020.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive nlp tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">NeurIPS</em>, 33:9459–9474.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024a)</span>
<span class="ltx_bibblock">
Xiaopeng Li, Shasha Li, Shezheng Song, Jing Yang, Jun Ma, and Jie Yu. 2024a.

</span>
<span class="ltx_bibblock">Pmet: Precise model editing in a transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">AAAI</em>, volume 38, pages 18564–18572.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2024b)</span>
<span class="ltx_bibblock">
Yuanchun Li, Hao Wen, Weijun Wang, Xiangyu Li, Yizhen Yuan, Guohong Liu, Jiacheng Liu, Wenxing Xu, Xiang Wang, Yi Sun, et al. 2024b.

</span>
<span class="ltx_bibblock">Personal llm agents: Insights and survey about the capability, efficiency and security.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2401.05459</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin (2004)</span>
<span class="ltx_bibblock">
Chin-Yew Lin. 2004.

</span>
<span class="ltx_bibblock">ROUGE: A package for automatic evaluation of summaries.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Text Summarization Branches Out</em>, pages 74–81.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2020)</span>
<span class="ltx_bibblock">
Qian Liu, Yihong Chen, Bei Chen, Jian-Guang Lou, Zixuan Chen, Bin Zhou, and Dongmei Zhang. 2020.

</span>
<span class="ltx_bibblock">You impress me: Dialogue generation via mutual persona perception.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">ACL</em>, pages 1417–1427.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. (2023)</span>
<span class="ltx_bibblock">
Xinbei Ma, Yeyun Gong, Pengcheng He, Hai Zhao, and Nan Duan. 2023.

</span>
<span class="ltx_bibblock">Query rewriting for retrieval-augmented large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">EMNLP</em>, pages 5303–5315.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et al. (2022a)</span>
<span class="ltx_bibblock">
Kevin Meng, David Bau, Alex Andonian, and Yonatan Belinkov. 2022a.

</span>
<span class="ltx_bibblock">Locating and editing factual associations in gpt.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">NeurIPS</em>, 35:17359–17372.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et al. (2022b)</span>
<span class="ltx_bibblock">
Kevin Meng, Arnab Sen Sharma, Alex Andonian, Yonatan Belinkov, and David Bau. 2022b.

</span>
<span class="ltx_bibblock">Mass-editing memory in a transformer.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2210.07229</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mitchell et al. (2021)</span>
<span class="ltx_bibblock">
Eric Mitchell, Charles Lin, Antoine Bosselut, Chelsea Finn, and Christopher D Manning. 2021.

</span>
<span class="ltx_bibblock">Fast model editing at scale.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2110.11309</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mitchell et al. (2022)</span>
<span class="ltx_bibblock">
Eric Mitchell, Charles Lin, Antoine Bosselut, Christopher D Manning, and Chelsea Finn. 2022.

</span>
<span class="ltx_bibblock">Memory-based model editing at scale.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">ICML</em>, pages 15817–15831. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Neelakantan et al. (2022)</span>
<span class="ltx_bibblock">
Arvind Neelakantan, Tao Xu, Raul Puri, Alec Radford, Jesse Michael Han, Jerry Tworek, Qiming Yuan, Nikolas Tezak, Jong Wook Kim, Chris Hallacy, et al. 2022.

</span>
<span class="ltx_bibblock">Text and code embeddings by contrastive pre-training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">CoRR</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">OpenAI (2023)</span>
<span class="ltx_bibblock">
OpenAI. 2023.

</span>
<span class="ltx_bibblock">GPT-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">arXiv preprint</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Post (2018)</span>
<span class="ltx_bibblock">
Matt Post. 2018.

</span>
<span class="ltx_bibblock">A call for clarity in reporting BLEU scores.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">WMT</em>, pages 186–191.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2018)</span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, Ilya Sutskever, et al. 2018.

</span>
<span class="ltx_bibblock">Improving language understanding by generative pre-training.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2023)</span>
<span class="ltx_bibblock">
Xiaozhe Ren, Pingyi Zhou, Xinfan Meng, Xinjing Huang, Yadao Wang, Weichao Wang, Pengfei Li, Xiaoda Zhang, Alexander Podolskiy, Grigory Arshinov, et al. 2023.

</span>
<span class="ltx_bibblock">Pangu-<math alttext="\{" class="ltx_Math" display="inline" id="bib.bib26.1.m1.1"><semantics id="bib.bib26.1.m1.1a"><mo id="bib.bib26.1.m1.1.1" stretchy="false" xref="bib.bib26.1.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib26.1.m1.1b"><ci id="bib.bib26.1.m1.1.1.cmml" xref="bib.bib26.1.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib26.1.m1.1c">\{</annotation><annotation encoding="application/x-llamapun" id="bib.bib26.1.m1.1d">{</annotation></semantics></math><math alttext="\backslash" class="ltx_Math" display="inline" id="bib.bib26.2.m2.1"><semantics id="bib.bib26.2.m2.1a"><mo id="bib.bib26.2.m2.1.1" xref="bib.bib26.2.m2.1.1.cmml">\</mo><annotation-xml encoding="MathML-Content" id="bib.bib26.2.m2.1b"><ci id="bib.bib26.2.m2.1.1.cmml" xref="bib.bib26.2.m2.1.1">\</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib26.2.m2.1c">\backslash</annotation><annotation encoding="application/x-llamapun" id="bib.bib26.2.m2.1d">\</annotation></semantics></math>Sigma<math alttext="\}" class="ltx_Math" display="inline" id="bib.bib26.3.m3.1"><semantics id="bib.bib26.3.m3.1a"><mo id="bib.bib26.3.m3.1.1" stretchy="false" xref="bib.bib26.3.m3.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib26.3.m3.1b"><ci id="bib.bib26.3.m3.1.1.cmml" xref="bib.bib26.3.m3.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib26.3.m3.1c">\}</annotation><annotation encoding="application/x-llamapun" id="bib.bib26.3.m3.1d">}</annotation></semantics></math>: Towards trillion parameter language model with sparse heterogeneous computing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.4.1">arXiv preprint arXiv:2303.10845</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ribeiro et al. (2021)</span>
<span class="ltx_bibblock">
Pedro Ribeiro, Pedro Paredes, Miguel EP Silva, David Aparicio, and Fernando Silva. 2021.

</span>
<span class="ltx_bibblock">A survey on subgraph counting: concepts, algorithms, and applications to network motifs and graphlets.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">ACM Computing Surveys (CSUR)</em>, 54(2):1–36.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shu et al. (2022)</span>
<span class="ltx_bibblock">
Yiheng Shu, Zhiwei Yu, Yuhan Li, Börje Karlsson, Tingting Ma, Yuzhong Qu, and Chin-Yew Lin. 2022.

</span>
<span class="ltx_bibblock">Tiara: Multi-grained retrieval for robust question answering over large knowledge base.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">EMNLP</em>, pages 8108–8121.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Silver et al. (2014)</span>
<span class="ltx_bibblock">
David Silver, Guy Lever, Nicolas Heess, Thomas Degris, Daan Wierstra, and Martin Riedmiller. 2014.

</span>
<span class="ltx_bibblock">Deterministic policy gradient algorithms.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">ICML</em>, pages 387–395. PMLR.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. (2021)</span>
<span class="ltx_bibblock">
Haoyu Song, Yan Wang, Kaiyan Zhang, Weinan Zhang, and Ting Liu. 2021.

</span>
<span class="ltx_bibblock">Bob: Bert over bert for training persona-based dialogue models from limited personalized data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">ACL</em>, pages 167–177.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ullmann (1976)</span>
<span class="ltx_bibblock">
Julian R Ullmann. 1976.

</span>
<span class="ltx_bibblock">An algorithm for subgraph isomorphism.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Journal of the ACM (JACM)</em>, 23(1):31–42.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023a)</span>
<span class="ltx_bibblock">
Chaojie Wang, Yishi Xu, Zhong Peng, Chenxi Zhang, Bo Chen, Xinrun Wang, Lei Feng, and Bo An. 2023a.

</span>
<span class="ltx_bibblock">keqing: knowledge-based question answering is a nature chain-of-thought mentor of llm.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">arXiv preprint arXiv:2401.00426</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2023b)</span>
<span class="ltx_bibblock">
Hongru Wang, Minda Hu, Yang Deng, Rui Wang, Fei Mi, Weichao Wang, Yasheng Wang, Wai Chung Kwan, Irwin King, and Kam-Fai Wong. 2023b.

</span>
<span class="ltx_bibblock">Large language models as source planner for personalized knowledge-grounded dialogues.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">EMNLP (Findings)</em>, pages 9556–9569.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Zheng Wang, Cheng Long, and Gao Cong. 2021.

</span>
<span class="ltx_bibblock">Trajectory simplification with reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">ICDE</em>, pages 684–695. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
<span class="ltx_bibblock">
Zheng Wang, Shu Xian Teo, Jieer Ouyang, Yongjun Xu, and Wei Shi. 2024.

</span>
<span class="ltx_bibblock">M-RAG: Reinforcing large language model performance through retrieval-augmented generation with multiple partitions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">ACL</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Welch et al. (2022)</span>
<span class="ltx_bibblock">
Charles Welch, Chenxi Gu, Jonathan K Kummerfeld, Verónica Pérez-Rosas, and Rada Mihalcea. 2022.

</span>
<span class="ltx_bibblock">Leveraging similar users for personalized language modeling with limited data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">ACL</em>, pages 1742–1752.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams (1992)</span>
<span class="ltx_bibblock">
Ronald J Williams. 1992.

</span>
<span class="ltx_bibblock">Simple statistical gradient-following algorithms for connectionist reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Machine learning</em>, 8(3):229–256.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2022a)</span>
<span class="ltx_bibblock">
Chen Xu, Piji Li, Wei Wang, Haoran Yang, Siyun Wang, and Chuangbai Xiao. 2022a.

</span>
<span class="ltx_bibblock">Cosplay: Concept set guided personalized dialogue generation across both party personas.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">SIGIR</em>, pages 201–211.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2022b)</span>
<span class="ltx_bibblock">
Xinchao Xu, Zhibin Gou, Wenquan Wu, Zheng-Yu Niu, Hua Wu, Haifeng Wang, and Shihang Wang. 2022b.

</span>
<span class="ltx_bibblock">Long time no see! open-domain conversation with long-term persona memory.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">ACL (Findings)</em>, pages 2639–2650.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2023)</span>
<span class="ltx_bibblock">
Qian Yang, Qian Chen, Wen Wang, Baotian Hu, and Min Zhang. 2023.

</span>
<span class="ltx_bibblock">Enhancing multi-modal multi-hop question answering via structured knowledge and unified retrieval-generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">ACM MM</em>, pages 5223–5234.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. (2021)</span>
<span class="ltx_bibblock">
Xi Ye, Semih Yavuz, Kazuma Hashimoto, Yingbo Zhou, and Caiming Xiong. 2021.

</span>
<span class="ltx_bibblock">Rng-kbqa: Generation augmented iterative ranking for knowledge base question answering.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2109.08678</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2020)</span>
<span class="ltx_bibblock">
Houyu Zhang, Zhenghao Liu, Chenyan Xiong, and Zhiyuan Liu. 2020.

</span>
<span class="ltx_bibblock">Grounded conversation generation as guided traverses in commonsense knowledge graphs.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">ACL</em>, pages 2031–2043.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023a)</span>
<span class="ltx_bibblock">
Kai Zhang, Fubang Zhao, Yangyang Kang, and Xiaozhong Liu. 2023a.

</span>
<span class="ltx_bibblock">Memory-augmented llm personalization with short-and long-term memory coordination.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">arXiv preprint arXiv:2309.11696</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2023b)</span>
<span class="ltx_bibblock">
Qianru Zhang, Zheng Wang, Cheng Long, Chao Huang, Siu-Ming Yiu, Yiding Liu, Gao Cong, and Jieming Shi. 2023b.

</span>
<span class="ltx_bibblock">Online anomalous subtrajectory detection on road networks with deep reinforcement learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">ICDE</em>, pages 246–258. IEEE.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2018)</span>
<span class="ltx_bibblock">
Saizheng Zhang, Emily Dinan, Jack Urbanek, Arthur Szlam, Douwe Kiela, and Jason Weston. 2018.

</span>
<span class="ltx_bibblock">Personalizing dialogue agents: I have a dog, do you have pets too?

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">ACL</em>, pages 2204–2213.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2024)</span>
<span class="ltx_bibblock">
Penghao Zhao, Hailin Zhang, Qinhan Yu, Zhengren Wang, Yunteng Geng, Fangcheng Fu, Ling Yang, Wentao Zhang, and Bin Cui. 2024.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for ai-generated content: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2402.19473</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. (2024)</span>
<span class="ltx_bibblock">
Wanjun Zhong, Lianghong Guo, Qiqi Gao, He Ye, and Yanlin Wang. 2024.

</span>
<span class="ltx_bibblock">Memorybank: Enhancing large language models with long-term memory.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">AAAI</em>, volume 38, pages 19724–19731.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Data Collection Details</h3>
<div class="ltx_para" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">The data collection process involves three key steps, which are presented below:</p>
</div>
<div class="ltx_para" id="A1.SS1.p2">
<p class="ltx_p" id="A1.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p2.1.1">Step-1: Raw Data Collection.</span> We explore two approaches, termed Active Remember (AR) and Passive Remember (PR), for collecting raw data derived from users’ daily conversations with AI assistants and screenshots from their apps. With AR, the AI assistant is trained to actively classify data (such as conversation sentences) into supported subclasses outlined in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.T8" title="Table 8 ‣ A.2 Memory Types and Subclasses ‣ Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">8</span></a>, and filter out noise data. With PR, users have the option to directly let the assistant to remember specific content for future use. Leveraging AR and PR, we remove a significant volume of trivial data, and then extract memories from the refined dataset.</p>
</div>
<div class="ltx_para" id="A1.SS1.p3">
<p class="ltx_p" id="A1.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p3.1.1">Step-2: Memory Data Construction.</span> We utilize a LLM, such as GPT-4, with the refined dataset to generate structured memories from the raw data. Additionally, we integrate various natural language processing techniques, including absolute date and time conversion, entity anaphora resolution, and event coreference resolution, to further clean the memories and facilitate graph construction.</p>
</div>
<div class="ltx_para" id="A1.SS1.p4">
<p class="ltx_p" id="A1.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="A1.SS1.p4.1.1">Step-3: QA Pairs Construction.</span> We organize the memory data chronologically and partition it into separate conversation sessions. Then, a LLM generates QA pairs for each session. To create complex questions for targeted training, such as those requiring multiple memories for answering, we explicitly instruct the LLM to utilize multiple associative relationships between memories to generate questions, ensuring that at least one or more memories are needed for accurate responses.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Memory Types and Subclasses</h3>
<div class="ltx_para" id="A1.SS2.p1">
<p class="ltx_p" id="A1.SS2.p1.1">We describe the 4 memory types: (1) Relationship, which involves recognizing users’ surrounding relationships and attributes of related individuals, such as birthdays and names of family members; (2) Preference, where we identify users’ likes and dislikes for various topics or entities; (3) Event, focusing on key event information about users, such as their status, recent experiences, and upcoming schedules; and (4) Attribute, encompassing users’ personal details such as name, gender, age, possessions, and other relevant information.</p>
</div>
<div class="ltx_para" id="A1.SS2.p2">
<p class="ltx_p" id="A1.SS2.p2.1">We enumerate the supported business subclasses of the EMG with memory examples in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.T8" title="Table 8 ‣ A.2 Memory Types and Subclasses ‣ Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure class="ltx_table" id="A1.T8">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span>The supported memory subclasses with memory examples.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="A1.T8.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T8.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.1.1.1.1">Memory Types</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.1.1.2">Memory Subclasses</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.1.1.3">Memory Examples</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.1.2.2.1" rowspan="5"><span class="ltx_text" id="A1.T8.1.2.2.1.1">Relationship</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.2.2.2">Spouse</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.2.2.3" rowspan="5"><span class="ltx_text" id="A1.T8.1.2.2.3.1">Tomorrow is my mom’s birthday.</span></td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.3.3.1">Parents/Children</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.4.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.4.4.1">Relatives</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.5.5">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.5.5.1">Colleague/Friends</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.6.6">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.6.6.1">Teacher/Student</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.7.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.1.7.7.1" rowspan="6"><span class="ltx_text" id="A1.T8.1.7.7.1.1">Preference</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.7.7.2">Diet preference</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.7.7.3">I like spicy food.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.8.8">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.8.8.1">Cultural preference (tourism, travel)</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.8.8.2">
<table class="ltx_tabular ltx_align_middle" id="A1.T8.1.8.8.2.1">
<tr class="ltx_tr" id="A1.T8.1.8.8.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.8.8.2.1.1.1">I enjoy traveling by airplane.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.8.8.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.8.8.2.1.2.1">I like going to museums.</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.9.9">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.9.9.1">Car preference</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.9.9.2">I like BMWs.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.10.10">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.10.10.1">
<table class="ltx_tabular ltx_align_middle" id="A1.T8.1.10.10.1.1">
<tr class="ltx_tr" id="A1.T8.1.10.10.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.10.10.1.1.1.1">Sports preference</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.10.10.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.10.10.1.1.2.1">(favorite sports types, sports celebrities)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.10.10.2">
<table class="ltx_tabular ltx_align_middle" id="A1.T8.1.10.10.2.1">
<tr class="ltx_tr" id="A1.T8.1.10.10.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.10.10.2.1.1.1">I like playing table tennis on weekends.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.10.10.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.10.10.2.1.2.1">James is my favorite basketball star.</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.11.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.11.11.1">Gaming preference (category, name)</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.11.11.2">I like the game League of Legends.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.12.12">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.12.12.1">
<table class="ltx_tabular ltx_align_middle" id="A1.T8.1.12.12.1.1">
<tr class="ltx_tr" id="A1.T8.1.12.12.1.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.12.12.1.1.1.1">Audio-visual entertainment preference</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.12.12.1.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.12.12.1.1.2.1">(favorite videos, music, movies, TV shows)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.12.12.2">
<table class="ltx_tabular ltx_align_middle" id="A1.T8.1.12.12.2.1">
<tr class="ltx_tr" id="A1.T8.1.12.12.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.12.12.2.1.1.1">I like science fiction movies.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.12.12.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.12.12.2.1.2.1">I like listening to Jay Chou’s songs.</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.13.13">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.1.13.13.1" rowspan="3"><span class="ltx_text" id="A1.T8.1.13.13.1.1">Event</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.13.13.2">
<table class="ltx_tabular ltx_align_middle" id="A1.T8.1.13.13.2.1">
<tr class="ltx_tr" id="A1.T8.1.13.13.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.13.13.2.1.1.1">Life events</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.13.13.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.13.13.2.1.2.1">(academic, marriage, buying a flat, parenting)</td>
</tr>
</table>
</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.13.13.3">
<table class="ltx_tabular ltx_align_middle" id="A1.T8.1.13.13.3.1">
<tr class="ltx_tr" id="A1.T8.1.13.13.3.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.13.13.3.1.1.1">The college entrance examination is coming soon.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.13.13.3.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.13.13.3.1.2.1">I met a girlfriend online.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.13.13.3.1.3">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.13.13.3.1.3.1">My family is welcoming a second child.</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.14.14">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.14.14.1">Arrangement</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.14.14.2">
<table class="ltx_tabular ltx_align_middle" id="A1.T8.1.14.14.2.1">
<tr class="ltx_tr" id="A1.T8.1.14.14.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.14.14.2.1.1.1">I’m going to visit clients tomorrow.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.14.14.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.14.14.2.1.2.1">I want to travel to Amsterdam next month.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.14.14.2.1.3">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.14.14.2.1.3.1">I have an oral defense next Monday.</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.15.15">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.15.15.1">Anniversary</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.15.15.2">Next month’s fifth is our wedding anniversary.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.16.16">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T8.1.16.16.1" rowspan="7"><span class="ltx_text" id="A1.T8.1.16.16.1.1">Attribute</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.16.16.2">Name/Nickname</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.16.16.3">My name is Wang Xiaoming, call me Lord Radish.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.17.17">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.17.17.1">Birthday/Age</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.17.17.2">
<table class="ltx_tabular ltx_align_middle" id="A1.T8.1.17.17.2.1">
<tr class="ltx_tr" id="A1.T8.1.17.17.2.1.1">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.17.17.2.1.1.1">I am 17 years old this year.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.17.17.2.1.2">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.17.17.2.1.2.1">I was born in 1998.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.17.17.2.1.3">
<td class="ltx_td ltx_nopad_r ltx_align_left" id="A1.T8.1.17.17.2.1.3.1">My birthday is April 2nd.</td>
</tr>
</table>
</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.18.18">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.18.18.1">Gender</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.18.18.2">I am a girl.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.19.19">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.19.19.1">Education</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.19.19.2">I am an undergraduate student.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.20.20">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.20.20.1">Personal belongings/Pets</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.20.20.2">Riding my beloved electric scooter, my pink BMW.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.21.21">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.21.21.1">Address</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T8.1.21.21.2">I reside in Jurong West, Singapore.</td>
</tr>
<tr class="ltx_tr" id="A1.T8.1.22.22">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T8.1.22.22.1">Occupation</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T8.1.22.22.2">I am a research scientist.</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Further Discussion</h3>
<div class="ltx_para ltx_noindent" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1"><span class="ltx_text ltx_font_bold" id="A1.SS3.p1.1.1">Q1. The necessity of using a graph if the user memory size is small.</span></p>
</div>
<div class="ltx_para" id="A1.SS3.p2">
<p class="ltx_p" id="A1.SS3.p2.1">We analyze the user memory size based on statistical data. We list the number of memories generated from user interactions with the intelligent assistant over the past one day, in descending order: the Top-1,000 user has 296 memories; the Top-10,000 user has 101 memories; and the Top-20,000 user has 72 memories. Notably, around 20,000 users produce at least 70 memories each day, and the memory size increases over time. These users represent a significant portion that should not be overlooked, necessitating a graph structure (such as EMG) for effective management.</p>
</div>
<div class="ltx_para" id="A1.SS3.p3">
<p class="ltx_p" id="A1.SS3.p3.1">Moreover, using a graph enhances effectiveness by naturally capturing semantic relationships between memories, which improves reasoning during RAG. As demonstrated by the experimental results in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.T2" title="Table 2 ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">2</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#S5.T3" title="Table 3 ‣ 5.1 Experimental Setup ‣ 5 Experiments ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">3</span></a>, our approach outperforms the NiaH, Naive, and M-RAG baselines, achieving approximately a 10% improvement over the best baseline M-RAG, which manages the memory instances independently.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.p4">
<p class="ltx_p" id="A1.SS3.p4.1"><span class="ltx_text ltx_font_bold" id="A1.SS3.p4.1.1">Q2. What would be the storage and computation costs of EMG if the number of users is larger? Is it possible to share some common patterns of different users in this design?</span></p>
</div>
<div class="ltx_para" id="A1.SS3.p5">
<p class="ltx_p" id="A1.SS3.p5.1">We clarify that EMGs are independently managed and computed on each user’s personal device, and the storage and computation costs are not impacted by the number of users in practice.
To reduce storage costs, we consider a potential solution of sharing common patterns across different users’ EMGs. We aim to mine common subgraph patterns using classic subgraph isomorphism algorithms <cite class="ltx_cite ltx_citemacro_cite">Ribeiro et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib27" title="">2021</a>); Ullmann (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib31" title="">1976</a>); Cordella et al. (<a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#bib.bib3" title="">2004</a>)</cite>. On the server side, we will manage the common patterns identified by Graph ID (GID), and link user-specific data identified by User ID (UID) to them. On the user side, GIDs and UIDs will replace the corresponding data in the EMGs, minimizing duplication across different users’ EMGs.</p>
</div>
<div class="ltx_para ltx_noindent" id="A1.SS3.p6">
<p class="ltx_p" id="A1.SS3.p6.1"><span class="ltx_text ltx_font_bold" id="A1.SS3.p6.1.1">Q3. Privacy discussions in data collection and model training, e.g., is the model trained in a single user-based? Will the model output other user’s information during inference?</span></p>
</div>
<div class="ltx_para" id="A1.SS3.p7">
<p class="ltx_p" id="A1.SS3.p7.1">In data collection, we clarify that the data is collected solely for individual use to provide relevant applications. Each user’s EMG is independently built based on the collected data, and will not be shared. Additionally, all user information presented in this research has been de-identified.</p>
</div>
<div class="ltx_para" id="A1.SS3.p8">
<p class="ltx_p" id="A1.SS3.p8.1">In model training, we use a single-user approach and address privacy concerns as follows: (1) EMGs are independently managed for each user and are not shared. (2) The RL agent is a simple neural network that includes or excludes nodes (actions 1 or 0) in the personal graph. (3) The LLM remains frozen, ensuring it does not memorize user data or output information from other users.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.4 </span>Prompts for Data Collection</h3>
<div class="ltx_para" id="A1.SS4.p1">
<p class="ltx_p" id="A1.SS4.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.T9" title="Table 9 ‣ A.4 Prompts for Data Collection ‣ Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">9</span></a> presents the prompt for collecting memories from raw extracted data, while Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.T10" title="Table 10 ‣ A.4 Prompts for Data Collection ‣ Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">10</span></a> provides the prompt for generating reasoning as the required memories for QA pairs. The prompt for generating QA pairs based on this reasoning is presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.T11" title="Table 11 ‣ A.4 Prompts for Data Collection ‣ Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">11</span></a>. Additionally, Table <a class="ltx_ref" href="https://arxiv.org/html/2409.19401v1#A1.T12" title="Table 12 ‣ A.4 Prompts for Data Collection ‣ Appendix A Appendix ‣ Instructions for EMNLP 2023 Proceedings"><span class="ltx_text ltx_ref_tag">12</span></a> offers an alternative method to synthesize memories when raw extracted data is unavailable.</p>
</div>
<figure class="ltx_table" id="A1.T9">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span>Prompt for collecting memories from raw extracted data.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="A1.T9.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T9.1.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A1.T9.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.1.1.1.1">
<span class="ltx_p" id="A1.T9.1.1.1.1.1.1" style="width:426.8pt;">Please help me organize the following raw user data into standardized memory data.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T9.1.2.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T9.1.2.2.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.2.2.1.1">
<span class="ltx_p" id="A1.T9.1.2.2.1.1.1" style="width:426.8pt;">Here is an example format:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T9.1.3.3">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T9.1.3.3.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.3.3.1.1">
<span class="ltx_p" id="A1.T9.1.3.3.1.1.1" style="width:426.8pt;"> 1. My name is Zhang Zhenqiang.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T9.1.4.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T9.1.4.4.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.4.4.1.1">
<span class="ltx_p" id="A1.T9.1.4.4.1.1.1" style="width:426.8pt;"> 2. My zodiac sign is Aquarius.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T9.1.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T9.1.5.5.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.5.5.1.1">
<span class="ltx_p" id="A1.T9.1.5.5.1.1.1" style="width:426.8pt;"> 3. My company’s address is Oriental International, Pudong New District, Shanghai.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T9.1.6.6">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T9.1.6.6.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.6.6.1.1">
<span class="ltx_p" id="A1.T9.1.6.6.1.1.1" style="width:426.8pt;"> 4. My mother’s birthday is April 8, 1982.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T9.1.7.7">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T9.1.7.7.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.7.7.1.1">
<span class="ltx_p" id="A1.T9.1.7.7.1.1.1" style="width:426.8pt;"> 5. My father’s favorite sport is basketball.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T9.1.8.8">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T9.1.8.8.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.8.8.1.1">
<span class="ltx_p" id="A1.T9.1.8.8.1.1.1" style="width:426.8pt;"> 6. I watched the movie “Fast and Furious” at Orange Cinema in July 2023.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T9.1.9.9">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T9.1.9.9.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.9.9.1.1">
<span class="ltx_p" id="A1.T9.1.9.9.1.1.1" style="width:426.8pt;"> 7. Next Saturday, I will attend a high school friend’s wedding.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T9.1.10.10">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" id="A1.T9.1.10.10.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T9.1.10.10.1.1">
<span class="ltx_p" id="A1.T9.1.10.10.1.1.1" style="width:426.8pt;">Note: Please use the above format to output and display all the data. + {raw data}</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A1.T10">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span>Prompt for generating reasoning as the required memories for QA pairs.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="A1.T10.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T10.1.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A1.T10.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T10.1.1.1.1.1">
<span class="ltx_p" id="A1.T10.1.1.1.1.1.1" style="width:426.8pt;">You have many memories from one person. Explore all possible associations, including multi-hop and connections around the same event, person, or entity. Records can intersect between different associations.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T10.1.2.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T10.1.2.2.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T10.1.2.2.1.1">
<span class="ltx_p" id="A1.T10.1.2.2.1.1.1" style="width:426.8pt;">Here is an example: Assume the following memory records exist:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T10.1.3.3">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T10.1.3.3.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T10.1.3.3.1.1">
<span class="ltx_p" id="A1.T10.1.3.3.1.1.1" style="width:426.8pt;">{“ID”: 1, “Memory Content”: “Recently, my sleep hasn’t been good and lacks deep sleep.”, “Memory Location”: “Lychee Garden Apartment, Longgang District, Shenzhen, Guangdong Province”, “Memory Time”: “2024-04-22 08:31:19”}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T10.1.4.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T10.1.4.4.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T10.1.4.4.1.1">
<span class="ltx_p" id="A1.T10.1.4.4.1.1.1" style="width:426.8pt;">{“ID”: 2, “Memory Content”: “My girlfriend likes to eat durian.”, “Memory Location”: “Wuhe Avenue, Longgang District, Shenzhen, Guangdong Province”, “Memory Time”: “2021-11-14 15:31:54”}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T10.1.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T10.1.5.5.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T10.1.5.5.1.1">
<span class="ltx_p" id="A1.T10.1.5.5.1.1.1" style="width:426.8pt;">{“ID”: 3, “Memory Content”: “Baiguoyuan is having a durian promotion next week, and I want to buy some.”, “Memory Location”: “Tianan Cloud Valley Building 1, B Section, Xuegang North Road, Longgang District, Shenzhen, Guangdong Province”, “Memory Time”: “2022-10-10 09:30:27”}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T10.1.6.6">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T10.1.6.6.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T10.1.6.6.1.1">
<span class="ltx_p" id="A1.T10.1.6.6.1.1.1" style="width:426.8pt;">Based on the above memory records, you can extract multiple sets of associations as follows:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T10.1.7.7">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T10.1.7.7.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T10.1.7.7.1.1">
<span class="ltx_p" id="A1.T10.1.7.7.1.1.1" style="width:426.8pt;">The memory mentions that your girlfriend likes to eat durian (Memory Point 2), and Baiguoyuan is having a durian promotion next week (Memory Point 3). You could buy some durian from Baiguoyuan during the promotion, so these memories are related (Memory Points 2|3).</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T10.1.8.8">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" id="A1.T10.1.8.8.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T10.1.8.8.1.1">
<span class="ltx_p" id="A1.T10.1.8.8.1.1.1" style="width:426.8pt;">Please extract the associations from the following memory records as thoroughly as possible based on the above example. Multi-hop reasoning relationships, associations around the same event, person, or entity can all be considered as existing connections. Memory records within each association group can intersect; for example, a memory point appearing in one set of associations can also appear in another set if it is reasonable. Please meet the above requirements and return the output following the example. + {memories}</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A1.T11">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 11: </span>Prompt for generating QA pairs.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="A1.T11.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T11.1.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A1.T11.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T11.1.1.1.1.1">
<span class="ltx_p" id="A1.T11.1.1.1.1.1.1" style="width:426.8pt;">You currently have a set of historical memory records from the same mobile user and hints of multiple associations between these memories. Based on all the memory information and their associations, design some intent statements or questions with the corresponding answers outputting as &lt;questions, answers&gt; for the mobile assistant that require at least one memory record to provide an accurate response. Below is an example:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T11.1.2.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T11.1.2.2.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T11.1.2.2.1.1">
<span class="ltx_p" id="A1.T11.1.2.2.1.1.1" style="width:426.8pt;">Example:</span>
<span class="ltx_p" id="A1.T11.1.2.2.1.1.2">Given the following memory records:</span>
<span class="ltx_p" id="A1.T11.1.2.2.1.1.3">{“ID”: 1, “Memory Content”: “Recently, my sleep hasn’t been good and lacks deep sleep.”, “Memory Location”: “Lychee Garden Apartment, Longgang District, Shenzhen, Guangdong Province”, “Memory Time”: “2024-04-22 08:31:19”}</span>
<span class="ltx_p" id="A1.T11.1.2.2.1.1.4">{“ID”: 2, “Memory Content”: “My girlfriend likes to eat durian.”, “Memory Location”: “Wuhe Avenue, Longgang District, Shenzhen, Guangdong Province”, “Memory Time”: “2021-11-14 15:31:54”}</span>
<span class="ltx_p" id="A1.T11.1.2.2.1.1.5">{“ID”: 3, “Memory Content”: “Baiguoyuan is having a durian promotion next week, and I want to buy some.”, “Memory Location”: “Tianan Cloud Valley Building 1, B Section, Xuegang North Road, Longgang District, Shenzhen, Guangdong Province”, “Memory Time”: “2022-10-10 09:30:27”}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T11.1.3.3">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T11.1.3.3.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T11.1.3.3.1.1">
<span class="ltx_p" id="A1.T11.1.3.3.1.1.1" style="width:426.8pt;">Based on the above memory information, there are the following association hints:</span>
<span class="ltx_p" id="A1.T11.1.3.3.1.1.2">Your girlfriend likes durian (Memory 2), and Baiguoyuan has a durian promotion next week (Memory 3). You could buy some durian at Baiguoyuan during the promotion. These memories are related around durian (Memory 2|3).</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T11.1.4.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T11.1.4.4.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T11.1.4.4.1.1">
<span class="ltx_p" id="A1.T11.1.4.4.1.1.1" style="width:426.8pt;">Based on the above memory information and associations, you can construct the following intent statements or questions:</span>
<span class="ltx_p" id="A1.T11.1.4.4.1.1.2">“I want to buy something delicious for my girlfriend. Any recommendations?” (Requires Memory 2|3)</span>
<span class="ltx_p" id="A1.T11.1.4.4.1.1.3">The corresponding answers:</span>
<span class="ltx_p" id="A1.T11.1.4.4.1.1.4">“You could buy some durian at Baiguoyuan during the promotion”</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T11.1.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T11.1.5.5.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T11.1.5.5.1.1">
<span class="ltx_p" id="A1.T11.1.5.5.1.1.1" style="width:426.8pt;">Please construct intent statements or questions from the following memory information and associations, meeting all of the following requirements:</span>
<span class="ltx_p" id="A1.T11.1.5.5.1.1.2">1. The statements or questions should be directed from the user to the mobile assistant, not questions from the assistant to the user (important requirement).</span>
<span class="ltx_p" id="A1.T11.1.5.5.1.1.3">2. They should require at least one memory record to provide an accurate response (important requirement).</span>
<span class="ltx_p" id="A1.T11.1.5.5.1.1.4">3. Keep the content concise and avoid including details already mentioned in the memory records (important requirement).</span>
<span class="ltx_p" id="A1.T11.1.5.5.1.1.5">4. Avoid intent statements or questions related to reminders (important requirement).</span>
<span class="ltx_p" id="A1.T11.1.5.5.1.1.6">5. Include both questions and casual statements (important requirement).</span>
<span class="ltx_p" id="A1.T11.1.5.5.1.1.7">6. End with the required memory points for response in parentheses (important requirement).</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T11.1.6.6">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" id="A1.T11.1.6.6.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T11.1.6.6.1.1">
<span class="ltx_p" id="A1.T11.1.6.6.1.1.1" style="width:426.8pt;">The memory information is as follows: {memories}</span>
<span class="ltx_p" id="A1.T11.1.6.6.1.1.2">The memory association hints are as follows: {reasoning}</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="A1.T12">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 12: </span>Prompt for synthesizing memories.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="A1.T12.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="A1.T12.1.1.1">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_t" id="A1.T12.1.1.1.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T12.1.1.1.1.1">
<span class="ltx_p" id="A1.T12.1.1.1.1.1.1" style="width:426.8pt;">Please act as a conversation context manager and help me generate personal memory-related data. Below are some examples; please use them as a reference for generating memory data:</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T12.1.2.2">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T12.1.2.2.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T12.1.2.2.1.1">
<span class="ltx_p" id="A1.T12.1.2.2.1.1.1" style="width:426.8pt;">{“ID”: 1, “Memory Content”: “My girlfriend likes to eat durian.”, “Memory Location”: “Wuhe Avenue, Longgang District, Shenzhen, Guangdong Province”, “Memory Time”: “2021-11-14 15:31:54”}</span>
<span class="ltx_p" id="A1.T12.1.2.2.1.1.2">{“ID”: 2, “Memory Content”: “Baiguoyuan is having a durian promotion next week, and I want to buy some.”, “Memory Location”: “Tianan Cloud Valley Building 1, B Section, Xuegang North Road, Longgang District, Shenzhen, Guangdong Province”, “Memory Time”: “2022-10-10 09:30:27”}</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T12.1.3.3">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T12.1.3.3.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T12.1.3.3.1.1">
<span class="ltx_p" id="A1.T12.1.3.3.1.1.1" style="width:426.8pt;"></span>
<span class="ltx_p" id="A1.T12.1.3.3.1.1.2">The generated data should meet the following requirements:</span>
<span class="ltx_p" id="A1.T12.1.3.3.1.1.3">1. The memory data is generated from conversations with a mobile assistant and reflects everyday scenarios. The protagonist is a single individual. You may create realistic content including, but not limited to, basic information about the individual and their family and friends (birthdays, anniversaries, zodiac signs, ID information, passport information, bank card information, etc.), events (meetings, gatherings, travels, renovations, etc.), and order information (movie tickets, hotel reservations, train tickets, flight tickets, etc.). Make sure there are no logical conflicts between the generated data.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T12.1.4.4">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T12.1.4.4.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T12.1.4.4.1.1">
<span class="ltx_p" id="A1.T12.1.4.4.1.1.1" style="width:426.8pt;"> 2. The memories should exhibit logical multi-step reasoning and not be completely unrelated. For example: “My mom’s older brother is named Li Aiguo” and “My uncle’s address is a small shop next to Tiananmen Square.” These two memories are linked through the fact that my mom’s older brother (my uncle) acts as a reasoning hub, allowing me to deduce that Li Aiguo’s address is the small shop next to Tiananmen Square.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T12.1.5.5">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T12.1.5.5.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T12.1.5.5.1.1">
<span class="ltx_p" id="A1.T12.1.5.5.1.1.1" style="width:426.8pt;"> 3. Ensure that there are no real-world logical conflicts between memory content, locations, and times. For example, earlier memories should have earlier timestamps than later ones. Avoid generating two memories with locations far apart within a short timeframe, such as a memory from Beijing at 20:15:47 and another from Guangzhou at 20:16:20 on the same day.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T12.1.6.6">
<td class="ltx_td ltx_align_justify ltx_align_top" id="A1.T12.1.6.6.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T12.1.6.6.1.1">
<span class="ltx_p" id="A1.T12.1.6.6.1.1.1" style="width:426.8pt;"> 4. Memory locations can include scenarios like business trips and travel; they do not all need to be in the same city. Memories can be generated in multiple cities.</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T12.1.7.7">
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b" id="A1.T12.1.7.7.1">
<span class="ltx_inline-block ltx_align_top" id="A1.T12.1.7.7.1.1">
<span class="ltx_p" id="A1.T12.1.7.7.1.1.1" style="width:426.8pt;">Generate 50 more memories in JSONL format, numbered 1 to 50, with each entry including “memory content”, “memory location”, and “memory time”.</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Sep 28 16:17:00 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
