<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance</title>
<!--Generated on Mon Sep  2 20:33:42 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2408.17095v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S1" title="In RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S2" title="In RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S3" title="In RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Background</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4" title="In RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Denoising Diffusion Models with Block-wise Generation</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.SS1" title="In 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>RISSOLE Training</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.SS1.SSS1" title="In 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>VQ-GAN Training</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.SS1.SSS2" title="In 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Building the Retrieval Database</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.SS1.SSS3" title="In 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.3 </span>Block-wise DDPM Training</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.SS2" title="In 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>RISSOLE Sampling</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5" title="In RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.SS1" title="In 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Dataset and Baselines</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.SS2" title="In 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.SS3" title="In 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Unconditional Image Synthesis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.SS4" title="In 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Ablation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.SS4.SSS1" title="In 5.4 Ablation ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4.1 </span>Impact of Positional Information</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.SS4.SSS2" title="In 5.4 Ablation ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4.2 </span>Using Previous Block as Additional Context</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.SS4.SSS3" title="In 5.4 Ablation ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4.3 </span>Impact of RAG</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S6" title="In RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\addauthor</span>
<p class="ltx_p" id="p1.2">Avideep Mukherjeehttps://www.cse.iitk.ac.in/users/avideep/1
<span class="ltx_ERROR undefined" id="p1.2.1">\addauthor</span>Soumya Banerjeehttps://soubanerjee.github.io/1
<span class="ltx_ERROR undefined" id="p1.2.2">\addauthor</span>Piyush Raihttps://www.cse.iitk.ac.in/users/piyush/1
<span class="ltx_ERROR undefined" id="p1.2.3">\addauthor</span>Vinay P. Namboodirihttps://vinaypn.github.io/2
<span class="ltx_ERROR undefined" id="p1.2.4">\addinstitution</span>
Department of Computer Science and Engineering
<br class="ltx_break"/>Indian Institute of Technology Kanpur
<br class="ltx_break"/>Uttar Pradesh, India

<span class="ltx_ERROR undefined" id="p1.2.5">\addinstitution</span>
Department of Computer Science
<br class="ltx_break"/>University of Bath
<br class="ltx_break"/>Claverton Down
<br class="ltx_break"/>Bath BA2 7AY, UK
<br class="ltx_break"/>
RISSOLE</p>
</div>
<h1 class="ltx_title ltx_title_document">RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance</h1>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Diffusion-based models demonstrate impressive generation capabilities. However, they also have a massive number of parameters, resulting in enormous model sizes, thus making them unsuitable for deployment on resource-constraint devices. Block-wise generation can be a promising alternative toward designing compact-sized (parameter-efficient) deep generative models since the model can generate one block at a time, instead of generating the whole image at once. However, block-wise generation is also considerably challenging because ensuring coherence across the generated blocks can be a non-trivial task. To this end, we design a retrieval-augmented generation (RAG) approach and leverage the corresponding blocks of the images retrieved by the RAG module to condition the training and generation stages of a <em class="ltx_emph ltx_font_italic" id="id1.id1.1">block-wise</em> denoising diffusion model. Our conditioning schemes ensure coherence across the different blocks during training and, consequently, during generation. While we showcase our approach using the latent diffusion model (LDM) as the base model, it can be used with other variants of denoising diffusion models. We validate the solution of the coherence problem through the proposed approach by reporting substantive experiments to demonstrate our approach’s effectiveness in compact model size and excellent generation quality.<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup>This research work was partially supported by the Research-I Foundation of IIT Kanpur.</span></span></span></p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Recent work on deep generative models, particularly diffusion probabilistic models and variants <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx10" title="">Ho et al.(2020)Ho, Jain, and Abbeel</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx18" title="">Sohl-Dickstein et al.(2015)Sohl-Dickstein, Weiss, Maheswaranathan, and
Ganguli</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx20" title="">Song et al.(2020b)Song, Sohl-Dickstein, Kingma, Kumar,
Ermon, and Poole</a>]</cite>, has produced impressive generation quality for data such as images and videos. While recent models can now generate images with very high resolutions, these models also have enormous sizes, which hinders their deployment in resource-constrained settings. Training a state-of-the-art diffusion model from scratch could, for instance, require 23,835 A100 hours (when optimized). <span class="ltx_note ltx_role_footnote" id="footnote1a"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>An example provided in https://www.databricks.com/blog/stable-diffusion-2</span></span></span> Clearly, these models are beyond the computational capabilities of academia or organizations with modest computing resources, which necessitates a parameter-efficient design. To address the issue of computationally intensive training and large model sizes, recent work has explored approaches, such as training denoising diffusion models in a lower-dimensional latent space <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx14" title="">Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer</a>]</cite>, and using <em class="ltx_emph ltx_font_italic" id="S1.p1.1.1">semi-parametric</em> retrieval-augmented diffusion models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx2" title="">Blattmann et al.(2022)Blattmann, Rombach, Oktay, Müller, and
Ommer</a>]</cite> where a compact-sized diffusion model is conditioned on an external database. As the training of the diffusion model is done with a fixed latent size, these models still tend to work with large latent representations, resulting in large parameter models that are challenging to train. <em class="ltx_emph ltx_font_italic" id="S1.p1.1.2">Post hoc</em> attempts at optimization such as adversarial diffusion distillation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx17" title="">Sauer et al.(2023)Sauer, Lorenz, Blattmann, and
Rombach</a>]</cite> are also not applicable as one still needs access to a fully trained large parameter model and further resources to train a distilled model.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Training deep generative models such that they can generate images in a <em class="ltx_emph ltx_font_italic" id="S1.p2.1.1">block-wise</em> fashion (generating one block at a time), instead of the whole image at once, can potentially be an alternative to address the aforementioned issues. However, designing such block-wise generative models is quite challenging, as ensuring that the generated blocks have spatial and semantic coherence is difficult. Consequently, the generated blocks may not blend well together, resulting in noticeable discrepancies or artifacts where the blocks meet.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In this work, we show that the retrieval-augmented generation (RAG) approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx2" title="">Blattmann et al.(2022)Blattmann, Rombach, Oktay, Müller, and
Ommer</a>]</cite> can effectively address the consistency problem in block-wise generation. In particular, we present a block-wise denoising diffusion model where each image block (in the pixel space, or the latent space if using a latent diffusion model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx14" title="">Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer</a>]</cite>), both during training as well as generation, is conditioned on the corresponding block of a reference set of images retrieved from an external database. We show that enforcing correspondence in the block-wise conditioning suffices to obtain coherence in the <span class="ltx_text ltx_font_italic" id="S1.p3.1.1">independent</span> block-wise generation.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">There is extensive work on deep generative models for data, such as images, videos, text, and multi-modal data. Here, we mainly focus on generative models based on diffusion probabilistic models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx18" title="">Sohl-Dickstein et al.(2015)Sohl-Dickstein, Weiss, Maheswaranathan, and
Ganguli</a>]</cite> and their variants <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx11" title="">Kong and Ping(2021)</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx16" title="">San-Roman et al.(2021)San-Roman, Nachmani, and Wolf</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx19" title="">Song et al.(2020a)Song, Meng, and
Ermon</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx5" title="">Dhariwal and Nichol(2021)</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx10" title="">Ho et al.(2020)Ho, Jain, and Abbeel</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx15" title="">Ronneberger et al.(2015)Ronneberger, Fischer, and
Brox</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx20" title="">Song et al.(2020b)Song, Sohl-Dickstein, Kingma, Kumar,
Ermon, and Poole</a>]</cite>, particularly those focusing on compact model sizes, as they are most relevant to our work. There has been an extensive exploration of variants of diffusion-based models, such as score-based models and their application on various data sources <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx24" title="">Yang et al.(2023)Yang, Zhang, Song, Hong, Xu, Zhao, Zhang, Cui, and
Yang</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">Our work mainly focuses on designing diffusion models that are parameter-efficient <em class="ltx_emph ltx_font_italic" id="S2.p2.1.1">by design</em> and can consequently be trained efficiently. There are three main strategies: optimizing the representation (using probability flow ODEs), training using a latent representation, and patch-based training. Models such as consistency models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx21" title="">Song et al.(2023)Song, Dhariwal, Chen, and
Sutskever</a>]</cite> obtain an approximation for the stochastic differential equation based on the diffusion process. However, the main contribution of this approach is to reduce the number of function evaluations required at inference time. This approach still requires substantial training time. Methods such as the latent diffusion model (LDM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx14" title="">Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer</a>]</cite> model the diffusion process in the latent space instead of the original image space. One could theoretically use a highly compact latent space to reduce the computational cost. However, as the efficacy of the encoder-decoder transformation is limited, typically, one uses a sizeable latent space representation while training these models, and these LDMs require thousands of hours of large GPU-based training.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">Patch-based training of diffusion models is an alternative. For instance, <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx22" title="">Wang et al.(2023)Wang, Jiang, Zheng, Wang, He, Wang, Chen, and
Zhou</a>]</cite> shows that training on patches could reduce the training time. However, they do not solve the coherence issue. Their strategy is to train with various patches of various sizes and to train using a few <em class="ltx_emph ltx_font_italic" id="S2.p3.1.1">full-sized</em> images during training, thus not yielding any model-sized improvements. Another recent patch-based strategy <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx7" title="">Ding et al.(2024)Ding, Zhang, Wu, and Tu</a>]</cite> trains with a patch-based model. However, they provide the context from the feature collage of patches to appropriately condition the image generation. We do evaluate a variant of this approach where we condition on adjacent blocks. We observed that the representation does not train well with our proposed strategy.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">Our work is based on more explicitly and directly incorporating coherence by conditioning the individual blocks on the corresponding blocks of "relevant" images retrieved from an external database using the idea of retrieval-based augmentation. Our work in incorporating coherence also has relevance to the broader area of coherence in generative models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx23" title="">Xu et al.(2018)Xu, Ren, Zhang, Zeng, Cai, and
Sun</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx3" title="">Chu et al.(2020)Chu, Xie, Mayer, Leal-Taixé, and
Thuerey</a>]</cite>. Our proposed approach is to develop block-based retrieval-guided diffusion models. This is complementary to other approaches of probability flow ODE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx21" title="">Song et al.(2023)Song, Dhariwal, Chen, and
Sutskever</a>]</cite> or latent diffusion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx14" title="">Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer</a>]</cite> and can be combined with these different approaches.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Background</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.19"><span class="ltx_text ltx_font_bold" id="S3.p1.19.1">Diffusion Models:</span> Denoising diffusion probabilistic models (DDPM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx10" title="">Ho et al.(2020)Ho, Jain, and Abbeel</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx18" title="">Sohl-Dickstein et al.(2015)Sohl-Dickstein, Weiss, Maheswaranathan, and
Ganguli</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx20" title="">Song et al.(2020b)Song, Sohl-Dickstein, Kingma, Kumar,
Ermon, and Poole</a>]</cite> are deep generative models that consist of a forward process and a reverse process. The forward process <math alttext="q(x_{1:T}|x_{0})=\prod_{t=1}^{T}q(x_{t}|x_{t-1})" class="ltx_Math" display="inline" id="S3.p1.1.m1.2"><semantics id="S3.p1.1.m1.2a"><mrow id="S3.p1.1.m1.2.2" xref="S3.p1.1.m1.2.2.cmml"><mrow id="S3.p1.1.m1.1.1.1" xref="S3.p1.1.m1.1.1.1.cmml"><mi id="S3.p1.1.m1.1.1.1.3" xref="S3.p1.1.m1.1.1.1.3.cmml">q</mi><mo id="S3.p1.1.m1.1.1.1.2" xref="S3.p1.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.p1.1.m1.1.1.1.1.1" xref="S3.p1.1.m1.1.1.1.1.1.1.cmml"><mo id="S3.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.p1.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.1.m1.1.1.1.1.1.1" xref="S3.p1.1.m1.1.1.1.1.1.1.cmml"><msub id="S3.p1.1.m1.1.1.1.1.1.1.2" xref="S3.p1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.p1.1.m1.1.1.1.1.1.1.2.2" xref="S3.p1.1.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.p1.1.m1.1.1.1.1.1.1.2.3" xref="S3.p1.1.m1.1.1.1.1.1.1.2.3.cmml"><mn id="S3.p1.1.m1.1.1.1.1.1.1.2.3.2" xref="S3.p1.1.m1.1.1.1.1.1.1.2.3.2.cmml">1</mn><mo id="S3.p1.1.m1.1.1.1.1.1.1.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.p1.1.m1.1.1.1.1.1.1.2.3.1.cmml">:</mo><mi id="S3.p1.1.m1.1.1.1.1.1.1.2.3.3" xref="S3.p1.1.m1.1.1.1.1.1.1.2.3.3.cmml">T</mi></mrow></msub><mo fence="false" id="S3.p1.1.m1.1.1.1.1.1.1.1" xref="S3.p1.1.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.1.m1.1.1.1.1.1.1.3" xref="S3.p1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.1.m1.1.1.1.1.1.1.3.2" xref="S3.p1.1.m1.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S3.p1.1.m1.1.1.1.1.1.1.3.3" xref="S3.p1.1.m1.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.p1.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p1.1.m1.2.2.3" rspace="0.111em" xref="S3.p1.1.m1.2.2.3.cmml">=</mo><mrow id="S3.p1.1.m1.2.2.2" xref="S3.p1.1.m1.2.2.2.cmml"><msubsup id="S3.p1.1.m1.2.2.2.2" xref="S3.p1.1.m1.2.2.2.2.cmml"><mo id="S3.p1.1.m1.2.2.2.2.2.2" xref="S3.p1.1.m1.2.2.2.2.2.2.cmml">∏</mo><mrow id="S3.p1.1.m1.2.2.2.2.2.3" xref="S3.p1.1.m1.2.2.2.2.2.3.cmml"><mi id="S3.p1.1.m1.2.2.2.2.2.3.2" xref="S3.p1.1.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="S3.p1.1.m1.2.2.2.2.2.3.1" xref="S3.p1.1.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S3.p1.1.m1.2.2.2.2.2.3.3" xref="S3.p1.1.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.p1.1.m1.2.2.2.2.3" xref="S3.p1.1.m1.2.2.2.2.3.cmml">T</mi></msubsup><mrow id="S3.p1.1.m1.2.2.2.1" xref="S3.p1.1.m1.2.2.2.1.cmml"><mi id="S3.p1.1.m1.2.2.2.1.3" xref="S3.p1.1.m1.2.2.2.1.3.cmml">q</mi><mo id="S3.p1.1.m1.2.2.2.1.2" xref="S3.p1.1.m1.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.p1.1.m1.2.2.2.1.1.1" xref="S3.p1.1.m1.2.2.2.1.1.1.1.cmml"><mo id="S3.p1.1.m1.2.2.2.1.1.1.2" stretchy="false" xref="S3.p1.1.m1.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.p1.1.m1.2.2.2.1.1.1.1" xref="S3.p1.1.m1.2.2.2.1.1.1.1.cmml"><msub id="S3.p1.1.m1.2.2.2.1.1.1.1.2" xref="S3.p1.1.m1.2.2.2.1.1.1.1.2.cmml"><mi id="S3.p1.1.m1.2.2.2.1.1.1.1.2.2" xref="S3.p1.1.m1.2.2.2.1.1.1.1.2.2.cmml">x</mi><mi id="S3.p1.1.m1.2.2.2.1.1.1.1.2.3" xref="S3.p1.1.m1.2.2.2.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.p1.1.m1.2.2.2.1.1.1.1.1" xref="S3.p1.1.m1.2.2.2.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.1.m1.2.2.2.1.1.1.1.3" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.cmml"><mi id="S3.p1.1.m1.2.2.2.1.1.1.1.3.2" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.p1.1.m1.2.2.2.1.1.1.1.3.3" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.cmml"><mi id="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.2" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.1" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.3" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.p1.1.m1.2.2.2.1.1.1.3" stretchy="false" xref="S3.p1.1.m1.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.2b"><apply id="S3.p1.1.m1.2.2.cmml" xref="S3.p1.1.m1.2.2"><eq id="S3.p1.1.m1.2.2.3.cmml" xref="S3.p1.1.m1.2.2.3"></eq><apply id="S3.p1.1.m1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1"><times id="S3.p1.1.m1.1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.1.2"></times><ci id="S3.p1.1.m1.1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.1.3">𝑞</ci><apply id="S3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.2.2">𝑥</ci><apply id="S3.p1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.2.3"><ci id="S3.p1.1.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.2.3.1">:</ci><cn id="S3.p1.1.m1.1.1.1.1.1.1.2.3.2.cmml" type="integer" xref="S3.p1.1.m1.1.1.1.1.1.1.2.3.2">1</cn><ci id="S3.p1.1.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S3.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.1.m1.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S3.p1.1.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.p1.1.m1.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="S3.p1.1.m1.2.2.2.cmml" xref="S3.p1.1.m1.2.2.2"><apply id="S3.p1.1.m1.2.2.2.2.cmml" xref="S3.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.2.2.1.cmml" xref="S3.p1.1.m1.2.2.2.2">superscript</csymbol><apply id="S3.p1.1.m1.2.2.2.2.2.cmml" xref="S3.p1.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.2.2.2.1.cmml" xref="S3.p1.1.m1.2.2.2.2">subscript</csymbol><csymbol cd="latexml" id="S3.p1.1.m1.2.2.2.2.2.2.cmml" xref="S3.p1.1.m1.2.2.2.2.2.2">product</csymbol><apply id="S3.p1.1.m1.2.2.2.2.2.3.cmml" xref="S3.p1.1.m1.2.2.2.2.2.3"><eq id="S3.p1.1.m1.2.2.2.2.2.3.1.cmml" xref="S3.p1.1.m1.2.2.2.2.2.3.1"></eq><ci id="S3.p1.1.m1.2.2.2.2.2.3.2.cmml" xref="S3.p1.1.m1.2.2.2.2.2.3.2">𝑡</ci><cn id="S3.p1.1.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S3.p1.1.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S3.p1.1.m1.2.2.2.2.3.cmml" xref="S3.p1.1.m1.2.2.2.2.3">𝑇</ci></apply><apply id="S3.p1.1.m1.2.2.2.1.cmml" xref="S3.p1.1.m1.2.2.2.1"><times id="S3.p1.1.m1.2.2.2.1.2.cmml" xref="S3.p1.1.m1.2.2.2.1.2"></times><ci id="S3.p1.1.m1.2.2.2.1.3.cmml" xref="S3.p1.1.m1.2.2.2.1.3">𝑞</ci><apply id="S3.p1.1.m1.2.2.2.1.1.1.1.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.p1.1.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.1.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.1.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.2.2">𝑥</ci><ci id="S3.p1.1.m1.2.2.2.1.1.1.1.2.3.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.p1.1.m1.2.2.2.1.1.1.1.3.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.1.m1.2.2.2.1.1.1.1.3.1.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.1.m1.2.2.2.1.1.1.1.3.2.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.2">𝑥</ci><apply id="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.3"><minus id="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.1.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.1"></minus><ci id="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.2.cmml" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.p1.1.m1.2.2.2.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.2c">q(x_{1:T}|x_{0})=\prod_{t=1}^{T}q(x_{t}|x_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.2d">italic_q ( italic_x start_POSTSUBSCRIPT 1 : italic_T end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = ∏ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math> takes a clean input <math alttext="x_{0}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">x</mi><mn id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝑥</ci><cn id="S3.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">x_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> and gradually corrupts it by producing a sequence <math alttext="x_{1},x_{2},\ldots,x_{T}" class="ltx_Math" display="inline" id="S3.p1.3.m3.4"><semantics id="S3.p1.3.m3.4a"><mrow id="S3.p1.3.m3.4.4.3" xref="S3.p1.3.m3.4.4.4.cmml"><msub id="S3.p1.3.m3.2.2.1.1" xref="S3.p1.3.m3.2.2.1.1.cmml"><mi id="S3.p1.3.m3.2.2.1.1.2" xref="S3.p1.3.m3.2.2.1.1.2.cmml">x</mi><mn id="S3.p1.3.m3.2.2.1.1.3" xref="S3.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.p1.3.m3.4.4.3.4" xref="S3.p1.3.m3.4.4.4.cmml">,</mo><msub id="S3.p1.3.m3.3.3.2.2" xref="S3.p1.3.m3.3.3.2.2.cmml"><mi id="S3.p1.3.m3.3.3.2.2.2" xref="S3.p1.3.m3.3.3.2.2.2.cmml">x</mi><mn id="S3.p1.3.m3.3.3.2.2.3" xref="S3.p1.3.m3.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.p1.3.m3.4.4.3.5" xref="S3.p1.3.m3.4.4.4.cmml">,</mo><mi id="S3.p1.3.m3.1.1" mathvariant="normal" xref="S3.p1.3.m3.1.1.cmml">…</mi><mo id="S3.p1.3.m3.4.4.3.6" xref="S3.p1.3.m3.4.4.4.cmml">,</mo><msub id="S3.p1.3.m3.4.4.3.3" xref="S3.p1.3.m3.4.4.3.3.cmml"><mi id="S3.p1.3.m3.4.4.3.3.2" xref="S3.p1.3.m3.4.4.3.3.2.cmml">x</mi><mi id="S3.p1.3.m3.4.4.3.3.3" xref="S3.p1.3.m3.4.4.3.3.3.cmml">T</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.4b"><list id="S3.p1.3.m3.4.4.4.cmml" xref="S3.p1.3.m3.4.4.3"><apply id="S3.p1.3.m3.2.2.1.1.cmml" xref="S3.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m3.2.2.1.1.1.cmml" xref="S3.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.p1.3.m3.2.2.1.1.2.cmml" xref="S3.p1.3.m3.2.2.1.1.2">𝑥</ci><cn id="S3.p1.3.m3.2.2.1.1.3.cmml" type="integer" xref="S3.p1.3.m3.2.2.1.1.3">1</cn></apply><apply id="S3.p1.3.m3.3.3.2.2.cmml" xref="S3.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.3.3.2.2.1.cmml" xref="S3.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.p1.3.m3.3.3.2.2.2.cmml" xref="S3.p1.3.m3.3.3.2.2.2">𝑥</ci><cn id="S3.p1.3.m3.3.3.2.2.3.cmml" type="integer" xref="S3.p1.3.m3.3.3.2.2.3">2</cn></apply><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">…</ci><apply id="S3.p1.3.m3.4.4.3.3.cmml" xref="S3.p1.3.m3.4.4.3.3"><csymbol cd="ambiguous" id="S3.p1.3.m3.4.4.3.3.1.cmml" xref="S3.p1.3.m3.4.4.3.3">subscript</csymbol><ci id="S3.p1.3.m3.4.4.3.3.2.cmml" xref="S3.p1.3.m3.4.4.3.3.2">𝑥</ci><ci id="S3.p1.3.m3.4.4.3.3.3.cmml" xref="S3.p1.3.m3.4.4.3.3.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.4c">x_{1},x_{2},\ldots,x_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.4d">italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> defined by forward diffusion of the form <math alttext="q(x_{t}|x_{t-1})" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">q</mi><mo id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.p1.4.m4.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.1.cmml"><mo id="S3.p1.4.m4.1.1.1.1.2" stretchy="false" xref="S3.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.4.m4.1.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.1.cmml"><msub id="S3.p1.4.m4.1.1.1.1.1.2" xref="S3.p1.4.m4.1.1.1.1.1.2.cmml"><mi id="S3.p1.4.m4.1.1.1.1.1.2.2" xref="S3.p1.4.m4.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.p1.4.m4.1.1.1.1.1.2.3" xref="S3.p1.4.m4.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.p1.4.m4.1.1.1.1.1.1" xref="S3.p1.4.m4.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.4.m4.1.1.1.1.1.3" xref="S3.p1.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.p1.4.m4.1.1.1.1.1.3.2" xref="S3.p1.4.m4.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.p1.4.m4.1.1.1.1.1.3.3" xref="S3.p1.4.m4.1.1.1.1.1.3.3.cmml"><mi id="S3.p1.4.m4.1.1.1.1.1.3.3.2" xref="S3.p1.4.m4.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.p1.4.m4.1.1.1.1.1.3.3.1" xref="S3.p1.4.m4.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.p1.4.m4.1.1.1.1.1.3.3.3" xref="S3.p1.4.m4.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.p1.4.m4.1.1.1.1.3" stretchy="false" xref="S3.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><times id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2"></times><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑞</ci><apply id="S3.p1.4.m4.1.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.p1.4.m4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.p1.4.m4.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.p1.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.p1.4.m4.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.p1.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.p1.4.m4.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.p1.4.m4.1.1.1.1.1.3.3"><minus id="S3.p1.4.m4.1.1.1.1.1.3.3.1.cmml" xref="S3.p1.4.m4.1.1.1.1.1.3.3.1"></minus><ci id="S3.p1.4.m4.1.1.1.1.1.3.3.2.cmml" xref="S3.p1.4.m4.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.p1.4.m4.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.p1.4.m4.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">q(x_{t}|x_{t-1})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT )</annotation></semantics></math>, usually modeled by a Gaussian <math alttext="q(x_{t}|x_{t-1})=\mathcal{N}(\sqrt{1-\beta_{t}}x_{t},\beta_{t}\mathbf{I})" class="ltx_Math" display="inline" id="S3.p1.5.m5.3"><semantics id="S3.p1.5.m5.3a"><mrow id="S3.p1.5.m5.3.3" xref="S3.p1.5.m5.3.3.cmml"><mrow id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml"><mi id="S3.p1.5.m5.1.1.1.3" xref="S3.p1.5.m5.1.1.1.3.cmml">q</mi><mo id="S3.p1.5.m5.1.1.1.2" xref="S3.p1.5.m5.1.1.1.2.cmml">⁢</mo><mrow id="S3.p1.5.m5.1.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.1.1.cmml"><mo id="S3.p1.5.m5.1.1.1.1.1.2" stretchy="false" xref="S3.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.5.m5.1.1.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.1.1.cmml"><msub id="S3.p1.5.m5.1.1.1.1.1.1.2" xref="S3.p1.5.m5.1.1.1.1.1.1.2.cmml"><mi id="S3.p1.5.m5.1.1.1.1.1.1.2.2" xref="S3.p1.5.m5.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.p1.5.m5.1.1.1.1.1.1.2.3" xref="S3.p1.5.m5.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.p1.5.m5.1.1.1.1.1.1.1" xref="S3.p1.5.m5.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.5.m5.1.1.1.1.1.1.3" xref="S3.p1.5.m5.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.5.m5.1.1.1.1.1.1.3.2" xref="S3.p1.5.m5.1.1.1.1.1.1.3.2.cmml">x</mi><mrow id="S3.p1.5.m5.1.1.1.1.1.1.3.3" xref="S3.p1.5.m5.1.1.1.1.1.1.3.3.cmml"><mi id="S3.p1.5.m5.1.1.1.1.1.1.3.3.2" xref="S3.p1.5.m5.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S3.p1.5.m5.1.1.1.1.1.1.3.3.1" xref="S3.p1.5.m5.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S3.p1.5.m5.1.1.1.1.1.1.3.3.3" xref="S3.p1.5.m5.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo id="S3.p1.5.m5.1.1.1.1.1.3" stretchy="false" xref="S3.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p1.5.m5.3.3.4" xref="S3.p1.5.m5.3.3.4.cmml">=</mo><mrow id="S3.p1.5.m5.3.3.3" xref="S3.p1.5.m5.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.5.m5.3.3.3.4" xref="S3.p1.5.m5.3.3.3.4.cmml">𝒩</mi><mo id="S3.p1.5.m5.3.3.3.3" xref="S3.p1.5.m5.3.3.3.3.cmml">⁢</mo><mrow id="S3.p1.5.m5.3.3.3.2.2" xref="S3.p1.5.m5.3.3.3.2.3.cmml"><mo id="S3.p1.5.m5.3.3.3.2.2.3" stretchy="false" xref="S3.p1.5.m5.3.3.3.2.3.cmml">(</mo><mrow id="S3.p1.5.m5.2.2.2.1.1.1" xref="S3.p1.5.m5.2.2.2.1.1.1.cmml"><msqrt id="S3.p1.5.m5.2.2.2.1.1.1.2" xref="S3.p1.5.m5.2.2.2.1.1.1.2.cmml"><mrow id="S3.p1.5.m5.2.2.2.1.1.1.2.2" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.cmml"><mn id="S3.p1.5.m5.2.2.2.1.1.1.2.2.2" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.2.cmml">1</mn><mo id="S3.p1.5.m5.2.2.2.1.1.1.2.2.1" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.1.cmml">−</mo><msub id="S3.p1.5.m5.2.2.2.1.1.1.2.2.3" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.cmml"><mi id="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.2" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.2.cmml">β</mi><mi id="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.3" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.3.cmml">t</mi></msub></mrow></msqrt><mo id="S3.p1.5.m5.2.2.2.1.1.1.1" xref="S3.p1.5.m5.2.2.2.1.1.1.1.cmml">⁢</mo><msub id="S3.p1.5.m5.2.2.2.1.1.1.3" xref="S3.p1.5.m5.2.2.2.1.1.1.3.cmml"><mi id="S3.p1.5.m5.2.2.2.1.1.1.3.2" xref="S3.p1.5.m5.2.2.2.1.1.1.3.2.cmml">x</mi><mi id="S3.p1.5.m5.2.2.2.1.1.1.3.3" xref="S3.p1.5.m5.2.2.2.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.p1.5.m5.3.3.3.2.2.4" xref="S3.p1.5.m5.3.3.3.2.3.cmml">,</mo><mrow id="S3.p1.5.m5.3.3.3.2.2.2" xref="S3.p1.5.m5.3.3.3.2.2.2.cmml"><msub id="S3.p1.5.m5.3.3.3.2.2.2.2" xref="S3.p1.5.m5.3.3.3.2.2.2.2.cmml"><mi id="S3.p1.5.m5.3.3.3.2.2.2.2.2" xref="S3.p1.5.m5.3.3.3.2.2.2.2.2.cmml">β</mi><mi id="S3.p1.5.m5.3.3.3.2.2.2.2.3" xref="S3.p1.5.m5.3.3.3.2.2.2.2.3.cmml">t</mi></msub><mo id="S3.p1.5.m5.3.3.3.2.2.2.1" xref="S3.p1.5.m5.3.3.3.2.2.2.1.cmml">⁢</mo><mi id="S3.p1.5.m5.3.3.3.2.2.2.3" xref="S3.p1.5.m5.3.3.3.2.2.2.3.cmml">𝐈</mi></mrow><mo id="S3.p1.5.m5.3.3.3.2.2.5" stretchy="false" xref="S3.p1.5.m5.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.3b"><apply id="S3.p1.5.m5.3.3.cmml" xref="S3.p1.5.m5.3.3"><eq id="S3.p1.5.m5.3.3.4.cmml" xref="S3.p1.5.m5.3.3.4"></eq><apply id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"><times id="S3.p1.5.m5.1.1.1.2.cmml" xref="S3.p1.5.m5.1.1.1.2"></times><ci id="S3.p1.5.m5.1.1.1.3.cmml" xref="S3.p1.5.m5.1.1.1.3">𝑞</ci><apply id="S3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1.1"><csymbol cd="latexml" id="S3.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.p1.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.3.2">𝑥</ci><apply id="S3.p1.5.m5.1.1.1.1.1.1.3.3.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.3.3"><minus id="S3.p1.5.m5.1.1.1.1.1.1.3.3.1.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.3.3.1"></minus><ci id="S3.p1.5.m5.1.1.1.1.1.1.3.3.2.cmml" xref="S3.p1.5.m5.1.1.1.1.1.1.3.3.2">𝑡</ci><cn id="S3.p1.5.m5.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S3.p1.5.m5.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="S3.p1.5.m5.3.3.3.cmml" xref="S3.p1.5.m5.3.3.3"><times id="S3.p1.5.m5.3.3.3.3.cmml" xref="S3.p1.5.m5.3.3.3.3"></times><ci id="S3.p1.5.m5.3.3.3.4.cmml" xref="S3.p1.5.m5.3.3.3.4">𝒩</ci><interval closure="open" id="S3.p1.5.m5.3.3.3.2.3.cmml" xref="S3.p1.5.m5.3.3.3.2.2"><apply id="S3.p1.5.m5.2.2.2.1.1.1.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1"><times id="S3.p1.5.m5.2.2.2.1.1.1.1.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.1"></times><apply id="S3.p1.5.m5.2.2.2.1.1.1.2.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.2"><root id="S3.p1.5.m5.2.2.2.1.1.1.2a.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.2"></root><apply id="S3.p1.5.m5.2.2.2.1.1.1.2.2.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2"><minus id="S3.p1.5.m5.2.2.2.1.1.1.2.2.1.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.1"></minus><cn id="S3.p1.5.m5.2.2.2.1.1.1.2.2.2.cmml" type="integer" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.2">1</cn><apply id="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.1.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.3">subscript</csymbol><ci id="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.2.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.2">𝛽</ci><ci id="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.3.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.2.2.3.3">𝑡</ci></apply></apply></apply><apply id="S3.p1.5.m5.2.2.2.1.1.1.3.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.5.m5.2.2.2.1.1.1.3.1.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.p1.5.m5.2.2.2.1.1.1.3.2.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.3.2">𝑥</ci><ci id="S3.p1.5.m5.2.2.2.1.1.1.3.3.cmml" xref="S3.p1.5.m5.2.2.2.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.p1.5.m5.3.3.3.2.2.2.cmml" xref="S3.p1.5.m5.3.3.3.2.2.2"><times id="S3.p1.5.m5.3.3.3.2.2.2.1.cmml" xref="S3.p1.5.m5.3.3.3.2.2.2.1"></times><apply id="S3.p1.5.m5.3.3.3.2.2.2.2.cmml" xref="S3.p1.5.m5.3.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.p1.5.m5.3.3.3.2.2.2.2.1.cmml" xref="S3.p1.5.m5.3.3.3.2.2.2.2">subscript</csymbol><ci id="S3.p1.5.m5.3.3.3.2.2.2.2.2.cmml" xref="S3.p1.5.m5.3.3.3.2.2.2.2.2">𝛽</ci><ci id="S3.p1.5.m5.3.3.3.2.2.2.2.3.cmml" xref="S3.p1.5.m5.3.3.3.2.2.2.2.3">𝑡</ci></apply><ci id="S3.p1.5.m5.3.3.3.2.2.2.3.cmml" xref="S3.p1.5.m5.3.3.3.2.2.2.3">𝐈</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.3c">q(x_{t}|x_{t-1})=\mathcal{N}(\sqrt{1-\beta_{t}}x_{t},\beta_{t}\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.3d">italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT ) = caligraphic_N ( square-root start_ARG 1 - italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT bold_I )</annotation></semantics></math>. Note that <math alttext="q(x_{t}|x_{0})=\mathcal{N}(\sqrt{\bar{\alpha_{t}}}x_{0},(1-\bar{\alpha_{t}})%
\mathbf{I})" class="ltx_Math" display="inline" id="S3.p1.6.m6.3"><semantics id="S3.p1.6.m6.3a"><mrow id="S3.p1.6.m6.3.3" xref="S3.p1.6.m6.3.3.cmml"><mrow id="S3.p1.6.m6.1.1.1" xref="S3.p1.6.m6.1.1.1.cmml"><mi id="S3.p1.6.m6.1.1.1.3" xref="S3.p1.6.m6.1.1.1.3.cmml">q</mi><mo id="S3.p1.6.m6.1.1.1.2" xref="S3.p1.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S3.p1.6.m6.1.1.1.1.1" xref="S3.p1.6.m6.1.1.1.1.1.1.cmml"><mo id="S3.p1.6.m6.1.1.1.1.1.2" stretchy="false" xref="S3.p1.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.6.m6.1.1.1.1.1.1" xref="S3.p1.6.m6.1.1.1.1.1.1.cmml"><msub id="S3.p1.6.m6.1.1.1.1.1.1.2" xref="S3.p1.6.m6.1.1.1.1.1.1.2.cmml"><mi id="S3.p1.6.m6.1.1.1.1.1.1.2.2" xref="S3.p1.6.m6.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.p1.6.m6.1.1.1.1.1.1.2.3" xref="S3.p1.6.m6.1.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.p1.6.m6.1.1.1.1.1.1.1" xref="S3.p1.6.m6.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.6.m6.1.1.1.1.1.1.3" xref="S3.p1.6.m6.1.1.1.1.1.1.3.cmml"><mi id="S3.p1.6.m6.1.1.1.1.1.1.3.2" xref="S3.p1.6.m6.1.1.1.1.1.1.3.2.cmml">x</mi><mn id="S3.p1.6.m6.1.1.1.1.1.1.3.3" xref="S3.p1.6.m6.1.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.p1.6.m6.1.1.1.1.1.3" stretchy="false" xref="S3.p1.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p1.6.m6.3.3.4" xref="S3.p1.6.m6.3.3.4.cmml">=</mo><mrow id="S3.p1.6.m6.3.3.3" xref="S3.p1.6.m6.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.6.m6.3.3.3.4" xref="S3.p1.6.m6.3.3.3.4.cmml">𝒩</mi><mo id="S3.p1.6.m6.3.3.3.3" xref="S3.p1.6.m6.3.3.3.3.cmml">⁢</mo><mrow id="S3.p1.6.m6.3.3.3.2.2" xref="S3.p1.6.m6.3.3.3.2.3.cmml"><mo id="S3.p1.6.m6.3.3.3.2.2.3" stretchy="false" xref="S3.p1.6.m6.3.3.3.2.3.cmml">(</mo><mrow id="S3.p1.6.m6.2.2.2.1.1.1" xref="S3.p1.6.m6.2.2.2.1.1.1.cmml"><msqrt id="S3.p1.6.m6.2.2.2.1.1.1.2" xref="S3.p1.6.m6.2.2.2.1.1.1.2.cmml"><mover accent="true" id="S3.p1.6.m6.2.2.2.1.1.1.2.2" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2.cmml"><msub id="S3.p1.6.m6.2.2.2.1.1.1.2.2.2" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.cmml"><mi id="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.2" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.2.cmml">α</mi><mi id="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.3" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.3.cmml">t</mi></msub><mo id="S3.p1.6.m6.2.2.2.1.1.1.2.2.1" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2.1.cmml">¯</mo></mover></msqrt><mo id="S3.p1.6.m6.2.2.2.1.1.1.1" xref="S3.p1.6.m6.2.2.2.1.1.1.1.cmml">⁢</mo><msub id="S3.p1.6.m6.2.2.2.1.1.1.3" xref="S3.p1.6.m6.2.2.2.1.1.1.3.cmml"><mi id="S3.p1.6.m6.2.2.2.1.1.1.3.2" xref="S3.p1.6.m6.2.2.2.1.1.1.3.2.cmml">x</mi><mn id="S3.p1.6.m6.2.2.2.1.1.1.3.3" xref="S3.p1.6.m6.2.2.2.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.p1.6.m6.3.3.3.2.2.4" xref="S3.p1.6.m6.3.3.3.2.3.cmml">,</mo><mrow id="S3.p1.6.m6.3.3.3.2.2.2" xref="S3.p1.6.m6.3.3.3.2.2.2.cmml"><mrow id="S3.p1.6.m6.3.3.3.2.2.2.1.1" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.cmml"><mo id="S3.p1.6.m6.3.3.3.2.2.2.1.1.2" stretchy="false" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.cmml"><mn id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.2" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.2.cmml">1</mn><mo id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.1" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.1.cmml">−</mo><mover accent="true" id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.cmml"><msub id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.cmml"><mi id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.2" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.2.cmml">α</mi><mi id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.3" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.3.cmml">t</mi></msub><mo id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.1" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.1.cmml">¯</mo></mover></mrow><mo id="S3.p1.6.m6.3.3.3.2.2.2.1.1.3" stretchy="false" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.p1.6.m6.3.3.3.2.2.2.2" xref="S3.p1.6.m6.3.3.3.2.2.2.2.cmml">⁢</mo><mi id="S3.p1.6.m6.3.3.3.2.2.2.3" xref="S3.p1.6.m6.3.3.3.2.2.2.3.cmml">𝐈</mi></mrow><mo id="S3.p1.6.m6.3.3.3.2.2.5" stretchy="false" xref="S3.p1.6.m6.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.3b"><apply id="S3.p1.6.m6.3.3.cmml" xref="S3.p1.6.m6.3.3"><eq id="S3.p1.6.m6.3.3.4.cmml" xref="S3.p1.6.m6.3.3.4"></eq><apply id="S3.p1.6.m6.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1"><times id="S3.p1.6.m6.1.1.1.2.cmml" xref="S3.p1.6.m6.1.1.1.2"></times><ci id="S3.p1.6.m6.1.1.1.3.cmml" xref="S3.p1.6.m6.1.1.1.3">𝑞</ci><apply id="S3.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="S3.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.1.1.1.2.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.6.m6.1.1.1.1.1.1.2.2.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.p1.6.m6.1.1.1.1.1.1.2.3.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.6.m6.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.6.m6.1.1.1.1.1.1.3.2.cmml" xref="S3.p1.6.m6.1.1.1.1.1.1.3.2">𝑥</ci><cn id="S3.p1.6.m6.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.p1.6.m6.1.1.1.1.1.1.3.3">0</cn></apply></apply></apply><apply id="S3.p1.6.m6.3.3.3.cmml" xref="S3.p1.6.m6.3.3.3"><times id="S3.p1.6.m6.3.3.3.3.cmml" xref="S3.p1.6.m6.3.3.3.3"></times><ci id="S3.p1.6.m6.3.3.3.4.cmml" xref="S3.p1.6.m6.3.3.3.4">𝒩</ci><interval closure="open" id="S3.p1.6.m6.3.3.3.2.3.cmml" xref="S3.p1.6.m6.3.3.3.2.2"><apply id="S3.p1.6.m6.2.2.2.1.1.1.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1"><times id="S3.p1.6.m6.2.2.2.1.1.1.1.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.1"></times><apply id="S3.p1.6.m6.2.2.2.1.1.1.2.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.2"><root id="S3.p1.6.m6.2.2.2.1.1.1.2a.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.2"></root><apply id="S3.p1.6.m6.2.2.2.1.1.1.2.2.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2"><ci id="S3.p1.6.m6.2.2.2.1.1.1.2.2.1.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2.1">¯</ci><apply id="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.1.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.2.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.2">𝛼</ci><ci id="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.3.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.2.2.2.3">𝑡</ci></apply></apply></apply><apply id="S3.p1.6.m6.2.2.2.1.1.1.3.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.6.m6.2.2.2.1.1.1.3.1.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.p1.6.m6.2.2.2.1.1.1.3.2.cmml" xref="S3.p1.6.m6.2.2.2.1.1.1.3.2">𝑥</ci><cn id="S3.p1.6.m6.2.2.2.1.1.1.3.3.cmml" type="integer" xref="S3.p1.6.m6.2.2.2.1.1.1.3.3">0</cn></apply></apply><apply id="S3.p1.6.m6.3.3.3.2.2.2.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2"><times id="S3.p1.6.m6.3.3.3.2.2.2.2.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2.2"></times><apply id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1"><minus id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.1.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.1"></minus><cn id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.2.cmml" type="integer" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.2">1</cn><apply id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3"><ci id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.1.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.1">¯</ci><apply id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.1.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2">subscript</csymbol><ci id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.2.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.2">𝛼</ci><ci id="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.3.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2.1.1.1.3.2.3">𝑡</ci></apply></apply></apply><ci id="S3.p1.6.m6.3.3.3.2.2.2.3.cmml" xref="S3.p1.6.m6.3.3.3.2.2.2.3">𝐈</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.3c">q(x_{t}|x_{0})=\mathcal{N}(\sqrt{\bar{\alpha_{t}}}x_{0},(1-\bar{\alpha_{t}})%
\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.6.m6.3d">italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) = caligraphic_N ( square-root start_ARG over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG end_ARG italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT , ( 1 - over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG ) bold_I )</annotation></semantics></math>, where <math alttext="\alpha_{t}=1-\beta_{t}" class="ltx_Math" display="inline" id="S3.p1.7.m7.1"><semantics id="S3.p1.7.m7.1a"><mrow id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><msub id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml"><mi id="S3.p1.7.m7.1.1.2.2" xref="S3.p1.7.m7.1.1.2.2.cmml">α</mi><mi id="S3.p1.7.m7.1.1.2.3" xref="S3.p1.7.m7.1.1.2.3.cmml">t</mi></msub><mo id="S3.p1.7.m7.1.1.1" xref="S3.p1.7.m7.1.1.1.cmml">=</mo><mrow id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml"><mn id="S3.p1.7.m7.1.1.3.2" xref="S3.p1.7.m7.1.1.3.2.cmml">1</mn><mo id="S3.p1.7.m7.1.1.3.1" xref="S3.p1.7.m7.1.1.3.1.cmml">−</mo><msub id="S3.p1.7.m7.1.1.3.3" xref="S3.p1.7.m7.1.1.3.3.cmml"><mi id="S3.p1.7.m7.1.1.3.3.2" xref="S3.p1.7.m7.1.1.3.3.2.cmml">β</mi><mi id="S3.p1.7.m7.1.1.3.3.3" xref="S3.p1.7.m7.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><eq id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1"></eq><apply id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.2.1.cmml" xref="S3.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.p1.7.m7.1.1.2.2.cmml" xref="S3.p1.7.m7.1.1.2.2">𝛼</ci><ci id="S3.p1.7.m7.1.1.2.3.cmml" xref="S3.p1.7.m7.1.1.2.3">𝑡</ci></apply><apply id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3"><minus id="S3.p1.7.m7.1.1.3.1.cmml" xref="S3.p1.7.m7.1.1.3.1"></minus><cn id="S3.p1.7.m7.1.1.3.2.cmml" type="integer" xref="S3.p1.7.m7.1.1.3.2">1</cn><apply id="S3.p1.7.m7.1.1.3.3.cmml" xref="S3.p1.7.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.3.3.1.cmml" xref="S3.p1.7.m7.1.1.3.3">subscript</csymbol><ci id="S3.p1.7.m7.1.1.3.3.2.cmml" xref="S3.p1.7.m7.1.1.3.3.2">𝛽</ci><ci id="S3.p1.7.m7.1.1.3.3.3.cmml" xref="S3.p1.7.m7.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\alpha_{t}=1-\beta_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.7.m7.1d">italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT = 1 - italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\bar{\alpha_{t}}=\prod_{t}\alpha_{t}" class="ltx_Math" display="inline" id="S3.p1.8.m8.1"><semantics id="S3.p1.8.m8.1a"><mrow id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mover accent="true" id="S3.p1.8.m8.1.1.2" xref="S3.p1.8.m8.1.1.2.cmml"><msub id="S3.p1.8.m8.1.1.2.2" xref="S3.p1.8.m8.1.1.2.2.cmml"><mi id="S3.p1.8.m8.1.1.2.2.2" xref="S3.p1.8.m8.1.1.2.2.2.cmml">α</mi><mi id="S3.p1.8.m8.1.1.2.2.3" xref="S3.p1.8.m8.1.1.2.2.3.cmml">t</mi></msub><mo id="S3.p1.8.m8.1.1.2.1" xref="S3.p1.8.m8.1.1.2.1.cmml">¯</mo></mover><mo id="S3.p1.8.m8.1.1.1" rspace="0.111em" xref="S3.p1.8.m8.1.1.1.cmml">=</mo><mrow id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml"><msub id="S3.p1.8.m8.1.1.3.1" xref="S3.p1.8.m8.1.1.3.1.cmml"><mo id="S3.p1.8.m8.1.1.3.1.2" xref="S3.p1.8.m8.1.1.3.1.2.cmml">∏</mo><mi id="S3.p1.8.m8.1.1.3.1.3" xref="S3.p1.8.m8.1.1.3.1.3.cmml">t</mi></msub><msub id="S3.p1.8.m8.1.1.3.2" xref="S3.p1.8.m8.1.1.3.2.cmml"><mi id="S3.p1.8.m8.1.1.3.2.2" xref="S3.p1.8.m8.1.1.3.2.2.cmml">α</mi><mi id="S3.p1.8.m8.1.1.3.2.3" xref="S3.p1.8.m8.1.1.3.2.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><eq id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1.1"></eq><apply id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1.2"><ci id="S3.p1.8.m8.1.1.2.1.cmml" xref="S3.p1.8.m8.1.1.2.1">¯</ci><apply id="S3.p1.8.m8.1.1.2.2.cmml" xref="S3.p1.8.m8.1.1.2.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.2.2.1.cmml" xref="S3.p1.8.m8.1.1.2.2">subscript</csymbol><ci id="S3.p1.8.m8.1.1.2.2.2.cmml" xref="S3.p1.8.m8.1.1.2.2.2">𝛼</ci><ci id="S3.p1.8.m8.1.1.2.2.3.cmml" xref="S3.p1.8.m8.1.1.2.2.3">𝑡</ci></apply></apply><apply id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3"><apply id="S3.p1.8.m8.1.1.3.1.cmml" xref="S3.p1.8.m8.1.1.3.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.3.1.1.cmml" xref="S3.p1.8.m8.1.1.3.1">subscript</csymbol><csymbol cd="latexml" id="S3.p1.8.m8.1.1.3.1.2.cmml" xref="S3.p1.8.m8.1.1.3.1.2">product</csymbol><ci id="S3.p1.8.m8.1.1.3.1.3.cmml" xref="S3.p1.8.m8.1.1.3.1.3">𝑡</ci></apply><apply id="S3.p1.8.m8.1.1.3.2.cmml" xref="S3.p1.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.3.2.1.cmml" xref="S3.p1.8.m8.1.1.3.2">subscript</csymbol><ci id="S3.p1.8.m8.1.1.3.2.2.cmml" xref="S3.p1.8.m8.1.1.3.2.2">𝛼</ci><ci id="S3.p1.8.m8.1.1.3.2.3.cmml" xref="S3.p1.8.m8.1.1.3.2.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\bar{\alpha_{t}}=\prod_{t}\alpha_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.8.m8.1d">over¯ start_ARG italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG = ∏ start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT italic_α start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. For a sufficiently large value of <math alttext="T" class="ltx_Math" display="inline" id="S3.p1.9.m9.1"><semantics id="S3.p1.9.m9.1a"><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.p1.9.m9.1d">italic_T</annotation></semantics></math> and a suitably chosen variance schedule <math alttext="\{\beta_{t}\}_{t=1}^{T}" class="ltx_Math" display="inline" id="S3.p1.10.m10.1"><semantics id="S3.p1.10.m10.1a"><msubsup id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml"><mrow id="S3.p1.10.m10.1.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.2.cmml"><mo id="S3.p1.10.m10.1.1.1.1.1.2" stretchy="false" xref="S3.p1.10.m10.1.1.1.1.2.cmml">{</mo><msub id="S3.p1.10.m10.1.1.1.1.1.1" xref="S3.p1.10.m10.1.1.1.1.1.1.cmml"><mi id="S3.p1.10.m10.1.1.1.1.1.1.2" xref="S3.p1.10.m10.1.1.1.1.1.1.2.cmml">β</mi><mi id="S3.p1.10.m10.1.1.1.1.1.1.3" xref="S3.p1.10.m10.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p1.10.m10.1.1.1.1.1.3" stretchy="false" xref="S3.p1.10.m10.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.p1.10.m10.1.1.1.3" xref="S3.p1.10.m10.1.1.1.3.cmml"><mi id="S3.p1.10.m10.1.1.1.3.2" xref="S3.p1.10.m10.1.1.1.3.2.cmml">t</mi><mo id="S3.p1.10.m10.1.1.1.3.1" xref="S3.p1.10.m10.1.1.1.3.1.cmml">=</mo><mn id="S3.p1.10.m10.1.1.1.3.3" xref="S3.p1.10.m10.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.p1.10.m10.1.1.3" xref="S3.p1.10.m10.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><apply id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.2.cmml" xref="S3.p1.10.m10.1.1">superscript</csymbol><apply id="S3.p1.10.m10.1.1.1.cmml" xref="S3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1">subscript</csymbol><set id="S3.p1.10.m10.1.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1"><apply id="S3.p1.10.m10.1.1.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.10.m10.1.1.1.1.1.1.1.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.10.m10.1.1.1.1.1.1.2.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.2">𝛽</ci><ci id="S3.p1.10.m10.1.1.1.1.1.1.3.cmml" xref="S3.p1.10.m10.1.1.1.1.1.1.3">𝑡</ci></apply></set><apply id="S3.p1.10.m10.1.1.1.3.cmml" xref="S3.p1.10.m10.1.1.1.3"><eq id="S3.p1.10.m10.1.1.1.3.1.cmml" xref="S3.p1.10.m10.1.1.1.3.1"></eq><ci id="S3.p1.10.m10.1.1.1.3.2.cmml" xref="S3.p1.10.m10.1.1.1.3.2">𝑡</ci><cn id="S3.p1.10.m10.1.1.1.3.3.cmml" type="integer" xref="S3.p1.10.m10.1.1.1.3.3">1</cn></apply></apply><ci id="S3.p1.10.m10.1.1.3.cmml" xref="S3.p1.10.m10.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">\{\beta_{t}\}_{t=1}^{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.10.m10.1d">{ italic_β start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, the distribution <math alttext="q(x_{T}|x_{0})" class="ltx_Math" display="inline" id="S3.p1.11.m11.1"><semantics id="S3.p1.11.m11.1a"><mrow id="S3.p1.11.m11.1.1" xref="S3.p1.11.m11.1.1.cmml"><mi id="S3.p1.11.m11.1.1.3" xref="S3.p1.11.m11.1.1.3.cmml">q</mi><mo id="S3.p1.11.m11.1.1.2" xref="S3.p1.11.m11.1.1.2.cmml">⁢</mo><mrow id="S3.p1.11.m11.1.1.1.1" xref="S3.p1.11.m11.1.1.1.1.1.cmml"><mo id="S3.p1.11.m11.1.1.1.1.2" stretchy="false" xref="S3.p1.11.m11.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.11.m11.1.1.1.1.1" xref="S3.p1.11.m11.1.1.1.1.1.cmml"><msub id="S3.p1.11.m11.1.1.1.1.1.2" xref="S3.p1.11.m11.1.1.1.1.1.2.cmml"><mi id="S3.p1.11.m11.1.1.1.1.1.2.2" xref="S3.p1.11.m11.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.p1.11.m11.1.1.1.1.1.2.3" xref="S3.p1.11.m11.1.1.1.1.1.2.3.cmml">T</mi></msub><mo fence="false" id="S3.p1.11.m11.1.1.1.1.1.1" xref="S3.p1.11.m11.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.11.m11.1.1.1.1.1.3" xref="S3.p1.11.m11.1.1.1.1.1.3.cmml"><mi id="S3.p1.11.m11.1.1.1.1.1.3.2" xref="S3.p1.11.m11.1.1.1.1.1.3.2.cmml">x</mi><mn id="S3.p1.11.m11.1.1.1.1.1.3.3" xref="S3.p1.11.m11.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.p1.11.m11.1.1.1.1.3" stretchy="false" xref="S3.p1.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.11.m11.1b"><apply id="S3.p1.11.m11.1.1.cmml" xref="S3.p1.11.m11.1.1"><times id="S3.p1.11.m11.1.1.2.cmml" xref="S3.p1.11.m11.1.1.2"></times><ci id="S3.p1.11.m11.1.1.3.cmml" xref="S3.p1.11.m11.1.1.3">𝑞</ci><apply id="S3.p1.11.m11.1.1.1.1.1.cmml" xref="S3.p1.11.m11.1.1.1.1"><csymbol cd="latexml" id="S3.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.p1.11.m11.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.11.m11.1.1.1.1.1.2.cmml" xref="S3.p1.11.m11.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.11.m11.1.1.1.1.1.2.1.cmml" xref="S3.p1.11.m11.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.11.m11.1.1.1.1.1.2.2.cmml" xref="S3.p1.11.m11.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.p1.11.m11.1.1.1.1.1.2.3.cmml" xref="S3.p1.11.m11.1.1.1.1.1.2.3">𝑇</ci></apply><apply id="S3.p1.11.m11.1.1.1.1.1.3.cmml" xref="S3.p1.11.m11.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.11.m11.1.1.1.1.1.3.1.cmml" xref="S3.p1.11.m11.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.11.m11.1.1.1.1.1.3.2.cmml" xref="S3.p1.11.m11.1.1.1.1.1.3.2">𝑥</ci><cn id="S3.p1.11.m11.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.p1.11.m11.1.1.1.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.11.m11.1c">q(x_{T}|x_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.11.m11.1d">italic_q ( italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math> approximates an isotropic Gaussian. A <em class="ltx_emph ltx_font_italic" id="S3.p1.19.2">learnable</em> reverse process, called reverse denoising, denoted as <math alttext="p(x_{0:T})=p(x_{T})\prod_{t=1}^{T}p_{\theta}(x_{t-1}|x_{t})" class="ltx_Math" display="inline" id="S3.p1.12.m12.3"><semantics id="S3.p1.12.m12.3a"><mrow id="S3.p1.12.m12.3.3" xref="S3.p1.12.m12.3.3.cmml"><mrow id="S3.p1.12.m12.1.1.1" xref="S3.p1.12.m12.1.1.1.cmml"><mi id="S3.p1.12.m12.1.1.1.3" xref="S3.p1.12.m12.1.1.1.3.cmml">p</mi><mo id="S3.p1.12.m12.1.1.1.2" xref="S3.p1.12.m12.1.1.1.2.cmml">⁢</mo><mrow id="S3.p1.12.m12.1.1.1.1.1" xref="S3.p1.12.m12.1.1.1.1.1.1.cmml"><mo id="S3.p1.12.m12.1.1.1.1.1.2" stretchy="false" xref="S3.p1.12.m12.1.1.1.1.1.1.cmml">(</mo><msub id="S3.p1.12.m12.1.1.1.1.1.1" xref="S3.p1.12.m12.1.1.1.1.1.1.cmml"><mi id="S3.p1.12.m12.1.1.1.1.1.1.2" xref="S3.p1.12.m12.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.p1.12.m12.1.1.1.1.1.1.3" xref="S3.p1.12.m12.1.1.1.1.1.1.3.cmml"><mn id="S3.p1.12.m12.1.1.1.1.1.1.3.2" xref="S3.p1.12.m12.1.1.1.1.1.1.3.2.cmml">0</mn><mo id="S3.p1.12.m12.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S3.p1.12.m12.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S3.p1.12.m12.1.1.1.1.1.1.3.3" xref="S3.p1.12.m12.1.1.1.1.1.1.3.3.cmml">T</mi></mrow></msub><mo id="S3.p1.12.m12.1.1.1.1.1.3" stretchy="false" xref="S3.p1.12.m12.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p1.12.m12.3.3.4" xref="S3.p1.12.m12.3.3.4.cmml">=</mo><mrow id="S3.p1.12.m12.3.3.3" xref="S3.p1.12.m12.3.3.3.cmml"><mi id="S3.p1.12.m12.3.3.3.4" xref="S3.p1.12.m12.3.3.3.4.cmml">p</mi><mo id="S3.p1.12.m12.3.3.3.3" xref="S3.p1.12.m12.3.3.3.3.cmml">⁢</mo><mrow id="S3.p1.12.m12.2.2.2.1.1" xref="S3.p1.12.m12.2.2.2.1.1.1.cmml"><mo id="S3.p1.12.m12.2.2.2.1.1.2" stretchy="false" xref="S3.p1.12.m12.2.2.2.1.1.1.cmml">(</mo><msub id="S3.p1.12.m12.2.2.2.1.1.1" xref="S3.p1.12.m12.2.2.2.1.1.1.cmml"><mi id="S3.p1.12.m12.2.2.2.1.1.1.2" xref="S3.p1.12.m12.2.2.2.1.1.1.2.cmml">x</mi><mi id="S3.p1.12.m12.2.2.2.1.1.1.3" xref="S3.p1.12.m12.2.2.2.1.1.1.3.cmml">T</mi></msub><mo id="S3.p1.12.m12.2.2.2.1.1.3" stretchy="false" xref="S3.p1.12.m12.2.2.2.1.1.1.cmml">)</mo></mrow><mo id="S3.p1.12.m12.3.3.3.3a" xref="S3.p1.12.m12.3.3.3.3.cmml">⁢</mo><mrow id="S3.p1.12.m12.3.3.3.2" xref="S3.p1.12.m12.3.3.3.2.cmml"><msubsup id="S3.p1.12.m12.3.3.3.2.2" xref="S3.p1.12.m12.3.3.3.2.2.cmml"><mo id="S3.p1.12.m12.3.3.3.2.2.2.2" xref="S3.p1.12.m12.3.3.3.2.2.2.2.cmml">∏</mo><mrow id="S3.p1.12.m12.3.3.3.2.2.2.3" xref="S3.p1.12.m12.3.3.3.2.2.2.3.cmml"><mi id="S3.p1.12.m12.3.3.3.2.2.2.3.2" xref="S3.p1.12.m12.3.3.3.2.2.2.3.2.cmml">t</mi><mo id="S3.p1.12.m12.3.3.3.2.2.2.3.1" xref="S3.p1.12.m12.3.3.3.2.2.2.3.1.cmml">=</mo><mn id="S3.p1.12.m12.3.3.3.2.2.2.3.3" xref="S3.p1.12.m12.3.3.3.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.p1.12.m12.3.3.3.2.2.3" xref="S3.p1.12.m12.3.3.3.2.2.3.cmml">T</mi></msubsup><mrow id="S3.p1.12.m12.3.3.3.2.1" xref="S3.p1.12.m12.3.3.3.2.1.cmml"><msub id="S3.p1.12.m12.3.3.3.2.1.3" xref="S3.p1.12.m12.3.3.3.2.1.3.cmml"><mi id="S3.p1.12.m12.3.3.3.2.1.3.2" xref="S3.p1.12.m12.3.3.3.2.1.3.2.cmml">p</mi><mi id="S3.p1.12.m12.3.3.3.2.1.3.3" xref="S3.p1.12.m12.3.3.3.2.1.3.3.cmml">θ</mi></msub><mo id="S3.p1.12.m12.3.3.3.2.1.2" xref="S3.p1.12.m12.3.3.3.2.1.2.cmml">⁢</mo><mrow id="S3.p1.12.m12.3.3.3.2.1.1.1" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.cmml"><mo id="S3.p1.12.m12.3.3.3.2.1.1.1.2" stretchy="false" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.cmml">(</mo><mrow id="S3.p1.12.m12.3.3.3.2.1.1.1.1" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.cmml"><msub id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.cmml"><mi id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.2" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.cmml"><mi id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.2" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.1" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.3" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.p1.12.m12.3.3.3.2.1.1.1.1.1" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.12.m12.3.3.3.2.1.1.1.1.3" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.cmml"><mi id="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.2" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.2.cmml">x</mi><mi id="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.3" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.p1.12.m12.3.3.3.2.1.1.1.3" stretchy="false" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.12.m12.3b"><apply id="S3.p1.12.m12.3.3.cmml" xref="S3.p1.12.m12.3.3"><eq id="S3.p1.12.m12.3.3.4.cmml" xref="S3.p1.12.m12.3.3.4"></eq><apply id="S3.p1.12.m12.1.1.1.cmml" xref="S3.p1.12.m12.1.1.1"><times id="S3.p1.12.m12.1.1.1.2.cmml" xref="S3.p1.12.m12.1.1.1.2"></times><ci id="S3.p1.12.m12.1.1.1.3.cmml" xref="S3.p1.12.m12.1.1.1.3">𝑝</ci><apply id="S3.p1.12.m12.1.1.1.1.1.1.cmml" xref="S3.p1.12.m12.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.12.m12.1.1.1.1.1.1.1.cmml" xref="S3.p1.12.m12.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.12.m12.1.1.1.1.1.1.2.cmml" xref="S3.p1.12.m12.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.p1.12.m12.1.1.1.1.1.1.3.cmml" xref="S3.p1.12.m12.1.1.1.1.1.1.3"><ci id="S3.p1.12.m12.1.1.1.1.1.1.3.1.cmml" xref="S3.p1.12.m12.1.1.1.1.1.1.3.1">:</ci><cn id="S3.p1.12.m12.1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.p1.12.m12.1.1.1.1.1.1.3.2">0</cn><ci id="S3.p1.12.m12.1.1.1.1.1.1.3.3.cmml" xref="S3.p1.12.m12.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply><apply id="S3.p1.12.m12.3.3.3.cmml" xref="S3.p1.12.m12.3.3.3"><times id="S3.p1.12.m12.3.3.3.3.cmml" xref="S3.p1.12.m12.3.3.3.3"></times><ci id="S3.p1.12.m12.3.3.3.4.cmml" xref="S3.p1.12.m12.3.3.3.4">𝑝</ci><apply id="S3.p1.12.m12.2.2.2.1.1.1.cmml" xref="S3.p1.12.m12.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p1.12.m12.2.2.2.1.1.1.1.cmml" xref="S3.p1.12.m12.2.2.2.1.1">subscript</csymbol><ci id="S3.p1.12.m12.2.2.2.1.1.1.2.cmml" xref="S3.p1.12.m12.2.2.2.1.1.1.2">𝑥</ci><ci id="S3.p1.12.m12.2.2.2.1.1.1.3.cmml" xref="S3.p1.12.m12.2.2.2.1.1.1.3">𝑇</ci></apply><apply id="S3.p1.12.m12.3.3.3.2.cmml" xref="S3.p1.12.m12.3.3.3.2"><apply id="S3.p1.12.m12.3.3.3.2.2.cmml" xref="S3.p1.12.m12.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.p1.12.m12.3.3.3.2.2.1.cmml" xref="S3.p1.12.m12.3.3.3.2.2">superscript</csymbol><apply id="S3.p1.12.m12.3.3.3.2.2.2.cmml" xref="S3.p1.12.m12.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.p1.12.m12.3.3.3.2.2.2.1.cmml" xref="S3.p1.12.m12.3.3.3.2.2">subscript</csymbol><csymbol cd="latexml" id="S3.p1.12.m12.3.3.3.2.2.2.2.cmml" xref="S3.p1.12.m12.3.3.3.2.2.2.2">product</csymbol><apply id="S3.p1.12.m12.3.3.3.2.2.2.3.cmml" xref="S3.p1.12.m12.3.3.3.2.2.2.3"><eq id="S3.p1.12.m12.3.3.3.2.2.2.3.1.cmml" xref="S3.p1.12.m12.3.3.3.2.2.2.3.1"></eq><ci id="S3.p1.12.m12.3.3.3.2.2.2.3.2.cmml" xref="S3.p1.12.m12.3.3.3.2.2.2.3.2">𝑡</ci><cn id="S3.p1.12.m12.3.3.3.2.2.2.3.3.cmml" type="integer" xref="S3.p1.12.m12.3.3.3.2.2.2.3.3">1</cn></apply></apply><ci id="S3.p1.12.m12.3.3.3.2.2.3.cmml" xref="S3.p1.12.m12.3.3.3.2.2.3">𝑇</ci></apply><apply id="S3.p1.12.m12.3.3.3.2.1.cmml" xref="S3.p1.12.m12.3.3.3.2.1"><times id="S3.p1.12.m12.3.3.3.2.1.2.cmml" xref="S3.p1.12.m12.3.3.3.2.1.2"></times><apply id="S3.p1.12.m12.3.3.3.2.1.3.cmml" xref="S3.p1.12.m12.3.3.3.2.1.3"><csymbol cd="ambiguous" id="S3.p1.12.m12.3.3.3.2.1.3.1.cmml" xref="S3.p1.12.m12.3.3.3.2.1.3">subscript</csymbol><ci id="S3.p1.12.m12.3.3.3.2.1.3.2.cmml" xref="S3.p1.12.m12.3.3.3.2.1.3.2">𝑝</ci><ci id="S3.p1.12.m12.3.3.3.2.1.3.3.cmml" xref="S3.p1.12.m12.3.3.3.2.1.3.3">𝜃</ci></apply><apply id="S3.p1.12.m12.3.3.3.2.1.1.1.1.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1"><csymbol cd="latexml" id="S3.p1.12.m12.3.3.3.2.1.1.1.1.1.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.1.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.2.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.2">𝑥</ci><apply id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3"><minus id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.1.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.1"></minus><ci id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.2.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.1.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.2.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.2">𝑥</ci><ci id="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.3.cmml" xref="S3.p1.12.m12.3.3.3.2.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.12.m12.3c">p(x_{0:T})=p(x_{T})\prod_{t=1}^{T}p_{\theta}(x_{t-1}|x_{t})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.12.m12.3d">italic_p ( italic_x start_POSTSUBSCRIPT 0 : italic_T end_POSTSUBSCRIPT ) = italic_p ( italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) ∏ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT )</annotation></semantics></math>, tries to reconstruct the clean data <math alttext="x_{0}" class="ltx_Math" display="inline" id="S3.p1.13.m13.1"><semantics id="S3.p1.13.m13.1a"><msub id="S3.p1.13.m13.1.1" xref="S3.p1.13.m13.1.1.cmml"><mi id="S3.p1.13.m13.1.1.2" xref="S3.p1.13.m13.1.1.2.cmml">x</mi><mn id="S3.p1.13.m13.1.1.3" xref="S3.p1.13.m13.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p1.13.m13.1b"><apply id="S3.p1.13.m13.1.1.cmml" xref="S3.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.p1.13.m13.1.1.1.cmml" xref="S3.p1.13.m13.1.1">subscript</csymbol><ci id="S3.p1.13.m13.1.1.2.cmml" xref="S3.p1.13.m13.1.1.2">𝑥</ci><cn id="S3.p1.13.m13.1.1.3.cmml" type="integer" xref="S3.p1.13.m13.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.13.m13.1c">x_{0}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.13.m13.1d">italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> from pure noise <math alttext="x_{T}" class="ltx_Math" display="inline" id="S3.p1.14.m14.1"><semantics id="S3.p1.14.m14.1a"><msub id="S3.p1.14.m14.1.1" xref="S3.p1.14.m14.1.1.cmml"><mi id="S3.p1.14.m14.1.1.2" xref="S3.p1.14.m14.1.1.2.cmml">x</mi><mi id="S3.p1.14.m14.1.1.3" xref="S3.p1.14.m14.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.14.m14.1b"><apply id="S3.p1.14.m14.1.1.cmml" xref="S3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.p1.14.m14.1.1.1.cmml" xref="S3.p1.14.m14.1.1">subscript</csymbol><ci id="S3.p1.14.m14.1.1.2.cmml" xref="S3.p1.14.m14.1.1.2">𝑥</ci><ci id="S3.p1.14.m14.1.1.3.cmml" xref="S3.p1.14.m14.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.14.m14.1c">x_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.14.m14.1d">italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math> with <math alttext="p(x_{T})=\mathcal{N}(0,\mathbf{I})" class="ltx_Math" display="inline" id="S3.p1.15.m15.3"><semantics id="S3.p1.15.m15.3a"><mrow id="S3.p1.15.m15.3.3" xref="S3.p1.15.m15.3.3.cmml"><mrow id="S3.p1.15.m15.3.3.1" xref="S3.p1.15.m15.3.3.1.cmml"><mi id="S3.p1.15.m15.3.3.1.3" xref="S3.p1.15.m15.3.3.1.3.cmml">p</mi><mo id="S3.p1.15.m15.3.3.1.2" xref="S3.p1.15.m15.3.3.1.2.cmml">⁢</mo><mrow id="S3.p1.15.m15.3.3.1.1.1" xref="S3.p1.15.m15.3.3.1.1.1.1.cmml"><mo id="S3.p1.15.m15.3.3.1.1.1.2" stretchy="false" xref="S3.p1.15.m15.3.3.1.1.1.1.cmml">(</mo><msub id="S3.p1.15.m15.3.3.1.1.1.1" xref="S3.p1.15.m15.3.3.1.1.1.1.cmml"><mi id="S3.p1.15.m15.3.3.1.1.1.1.2" xref="S3.p1.15.m15.3.3.1.1.1.1.2.cmml">x</mi><mi id="S3.p1.15.m15.3.3.1.1.1.1.3" xref="S3.p1.15.m15.3.3.1.1.1.1.3.cmml">T</mi></msub><mo id="S3.p1.15.m15.3.3.1.1.1.3" stretchy="false" xref="S3.p1.15.m15.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p1.15.m15.3.3.2" xref="S3.p1.15.m15.3.3.2.cmml">=</mo><mrow id="S3.p1.15.m15.3.3.3" xref="S3.p1.15.m15.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.15.m15.3.3.3.2" xref="S3.p1.15.m15.3.3.3.2.cmml">𝒩</mi><mo id="S3.p1.15.m15.3.3.3.1" xref="S3.p1.15.m15.3.3.3.1.cmml">⁢</mo><mrow id="S3.p1.15.m15.3.3.3.3.2" xref="S3.p1.15.m15.3.3.3.3.1.cmml"><mo id="S3.p1.15.m15.3.3.3.3.2.1" stretchy="false" xref="S3.p1.15.m15.3.3.3.3.1.cmml">(</mo><mn id="S3.p1.15.m15.1.1" xref="S3.p1.15.m15.1.1.cmml">0</mn><mo id="S3.p1.15.m15.3.3.3.3.2.2" xref="S3.p1.15.m15.3.3.3.3.1.cmml">,</mo><mi id="S3.p1.15.m15.2.2" xref="S3.p1.15.m15.2.2.cmml">𝐈</mi><mo id="S3.p1.15.m15.3.3.3.3.2.3" stretchy="false" xref="S3.p1.15.m15.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.15.m15.3b"><apply id="S3.p1.15.m15.3.3.cmml" xref="S3.p1.15.m15.3.3"><eq id="S3.p1.15.m15.3.3.2.cmml" xref="S3.p1.15.m15.3.3.2"></eq><apply id="S3.p1.15.m15.3.3.1.cmml" xref="S3.p1.15.m15.3.3.1"><times id="S3.p1.15.m15.3.3.1.2.cmml" xref="S3.p1.15.m15.3.3.1.2"></times><ci id="S3.p1.15.m15.3.3.1.3.cmml" xref="S3.p1.15.m15.3.3.1.3">𝑝</ci><apply id="S3.p1.15.m15.3.3.1.1.1.1.cmml" xref="S3.p1.15.m15.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.p1.15.m15.3.3.1.1.1.1.1.cmml" xref="S3.p1.15.m15.3.3.1.1.1">subscript</csymbol><ci id="S3.p1.15.m15.3.3.1.1.1.1.2.cmml" xref="S3.p1.15.m15.3.3.1.1.1.1.2">𝑥</ci><ci id="S3.p1.15.m15.3.3.1.1.1.1.3.cmml" xref="S3.p1.15.m15.3.3.1.1.1.1.3">𝑇</ci></apply></apply><apply id="S3.p1.15.m15.3.3.3.cmml" xref="S3.p1.15.m15.3.3.3"><times id="S3.p1.15.m15.3.3.3.1.cmml" xref="S3.p1.15.m15.3.3.3.1"></times><ci id="S3.p1.15.m15.3.3.3.2.cmml" xref="S3.p1.15.m15.3.3.3.2">𝒩</ci><interval closure="open" id="S3.p1.15.m15.3.3.3.3.1.cmml" xref="S3.p1.15.m15.3.3.3.3.2"><cn id="S3.p1.15.m15.1.1.cmml" type="integer" xref="S3.p1.15.m15.1.1">0</cn><ci id="S3.p1.15.m15.2.2.cmml" xref="S3.p1.15.m15.2.2">𝐈</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.15.m15.3c">p(x_{T})=\mathcal{N}(0,\mathbf{I})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.15.m15.3d">italic_p ( italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT ) = caligraphic_N ( 0 , bold_I )</annotation></semantics></math> and <math alttext="p_{\theta}(x_{t-1}|x_{t})=\mathcal{N}(\mu_{\theta}(x_{t},t),\Sigma_{\theta}(x_%
{t},t))" class="ltx_Math" display="inline" id="S3.p1.16.m16.5"><semantics id="S3.p1.16.m16.5a"><mrow id="S3.p1.16.m16.5.5" xref="S3.p1.16.m16.5.5.cmml"><mrow id="S3.p1.16.m16.3.3.1" xref="S3.p1.16.m16.3.3.1.cmml"><msub id="S3.p1.16.m16.3.3.1.3" xref="S3.p1.16.m16.3.3.1.3.cmml"><mi id="S3.p1.16.m16.3.3.1.3.2" xref="S3.p1.16.m16.3.3.1.3.2.cmml">p</mi><mi id="S3.p1.16.m16.3.3.1.3.3" xref="S3.p1.16.m16.3.3.1.3.3.cmml">θ</mi></msub><mo id="S3.p1.16.m16.3.3.1.2" xref="S3.p1.16.m16.3.3.1.2.cmml">⁢</mo><mrow id="S3.p1.16.m16.3.3.1.1.1" xref="S3.p1.16.m16.3.3.1.1.1.1.cmml"><mo id="S3.p1.16.m16.3.3.1.1.1.2" stretchy="false" xref="S3.p1.16.m16.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.p1.16.m16.3.3.1.1.1.1" xref="S3.p1.16.m16.3.3.1.1.1.1.cmml"><msub id="S3.p1.16.m16.3.3.1.1.1.1.2" xref="S3.p1.16.m16.3.3.1.1.1.1.2.cmml"><mi id="S3.p1.16.m16.3.3.1.1.1.1.2.2" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2.cmml">x</mi><mrow id="S3.p1.16.m16.3.3.1.1.1.1.2.3" xref="S3.p1.16.m16.3.3.1.1.1.1.2.3.cmml"><mi id="S3.p1.16.m16.3.3.1.1.1.1.2.3.2" xref="S3.p1.16.m16.3.3.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.p1.16.m16.3.3.1.1.1.1.2.3.1" xref="S3.p1.16.m16.3.3.1.1.1.1.2.3.1.cmml">−</mo><mn id="S3.p1.16.m16.3.3.1.1.1.1.2.3.3" xref="S3.p1.16.m16.3.3.1.1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo fence="false" id="S3.p1.16.m16.3.3.1.1.1.1.1" xref="S3.p1.16.m16.3.3.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.16.m16.3.3.1.1.1.1.3" xref="S3.p1.16.m16.3.3.1.1.1.1.3.cmml"><mi id="S3.p1.16.m16.3.3.1.1.1.1.3.2" xref="S3.p1.16.m16.3.3.1.1.1.1.3.2.cmml">x</mi><mi id="S3.p1.16.m16.3.3.1.1.1.1.3.3" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo id="S3.p1.16.m16.3.3.1.1.1.3" stretchy="false" xref="S3.p1.16.m16.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p1.16.m16.5.5.4" xref="S3.p1.16.m16.5.5.4.cmml">=</mo><mrow id="S3.p1.16.m16.5.5.3" xref="S3.p1.16.m16.5.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.16.m16.5.5.3.4" xref="S3.p1.16.m16.5.5.3.4.cmml">𝒩</mi><mo id="S3.p1.16.m16.5.5.3.3" xref="S3.p1.16.m16.5.5.3.3.cmml">⁢</mo><mrow id="S3.p1.16.m16.5.5.3.2.2" xref="S3.p1.16.m16.5.5.3.2.3.cmml"><mo id="S3.p1.16.m16.5.5.3.2.2.3" stretchy="false" xref="S3.p1.16.m16.5.5.3.2.3.cmml">(</mo><mrow id="S3.p1.16.m16.4.4.2.1.1.1" xref="S3.p1.16.m16.4.4.2.1.1.1.cmml"><msub id="S3.p1.16.m16.4.4.2.1.1.1.3" xref="S3.p1.16.m16.4.4.2.1.1.1.3.cmml"><mi id="S3.p1.16.m16.4.4.2.1.1.1.3.2" xref="S3.p1.16.m16.4.4.2.1.1.1.3.2.cmml">μ</mi><mi id="S3.p1.16.m16.4.4.2.1.1.1.3.3" xref="S3.p1.16.m16.4.4.2.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.p1.16.m16.4.4.2.1.1.1.2" xref="S3.p1.16.m16.4.4.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.p1.16.m16.4.4.2.1.1.1.1.1" xref="S3.p1.16.m16.4.4.2.1.1.1.1.2.cmml"><mo id="S3.p1.16.m16.4.4.2.1.1.1.1.1.2" stretchy="false" xref="S3.p1.16.m16.4.4.2.1.1.1.1.2.cmml">(</mo><msub id="S3.p1.16.m16.4.4.2.1.1.1.1.1.1" xref="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.cmml"><mi id="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.2" xref="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.3" xref="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p1.16.m16.4.4.2.1.1.1.1.1.3" xref="S3.p1.16.m16.4.4.2.1.1.1.1.2.cmml">,</mo><mi id="S3.p1.16.m16.1.1" xref="S3.p1.16.m16.1.1.cmml">t</mi><mo id="S3.p1.16.m16.4.4.2.1.1.1.1.1.4" stretchy="false" xref="S3.p1.16.m16.4.4.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.p1.16.m16.5.5.3.2.2.4" xref="S3.p1.16.m16.5.5.3.2.3.cmml">,</mo><mrow id="S3.p1.16.m16.5.5.3.2.2.2" xref="S3.p1.16.m16.5.5.3.2.2.2.cmml"><msub id="S3.p1.16.m16.5.5.3.2.2.2.3" xref="S3.p1.16.m16.5.5.3.2.2.2.3.cmml"><mi id="S3.p1.16.m16.5.5.3.2.2.2.3.2" mathvariant="normal" xref="S3.p1.16.m16.5.5.3.2.2.2.3.2.cmml">Σ</mi><mi id="S3.p1.16.m16.5.5.3.2.2.2.3.3" xref="S3.p1.16.m16.5.5.3.2.2.2.3.3.cmml">θ</mi></msub><mo id="S3.p1.16.m16.5.5.3.2.2.2.2" xref="S3.p1.16.m16.5.5.3.2.2.2.2.cmml">⁢</mo><mrow id="S3.p1.16.m16.5.5.3.2.2.2.1.1" xref="S3.p1.16.m16.5.5.3.2.2.2.1.2.cmml"><mo id="S3.p1.16.m16.5.5.3.2.2.2.1.1.2" stretchy="false" xref="S3.p1.16.m16.5.5.3.2.2.2.1.2.cmml">(</mo><msub id="S3.p1.16.m16.5.5.3.2.2.2.1.1.1" xref="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.cmml"><mi id="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.2" xref="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.2.cmml">x</mi><mi id="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.3" xref="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.p1.16.m16.5.5.3.2.2.2.1.1.3" xref="S3.p1.16.m16.5.5.3.2.2.2.1.2.cmml">,</mo><mi id="S3.p1.16.m16.2.2" xref="S3.p1.16.m16.2.2.cmml">t</mi><mo id="S3.p1.16.m16.5.5.3.2.2.2.1.1.4" stretchy="false" xref="S3.p1.16.m16.5.5.3.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S3.p1.16.m16.5.5.3.2.2.5" stretchy="false" xref="S3.p1.16.m16.5.5.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.16.m16.5b"><apply id="S3.p1.16.m16.5.5.cmml" xref="S3.p1.16.m16.5.5"><eq id="S3.p1.16.m16.5.5.4.cmml" xref="S3.p1.16.m16.5.5.4"></eq><apply id="S3.p1.16.m16.3.3.1.cmml" xref="S3.p1.16.m16.3.3.1"><times id="S3.p1.16.m16.3.3.1.2.cmml" xref="S3.p1.16.m16.3.3.1.2"></times><apply id="S3.p1.16.m16.3.3.1.3.cmml" xref="S3.p1.16.m16.3.3.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.3.3.1.3.1.cmml" xref="S3.p1.16.m16.3.3.1.3">subscript</csymbol><ci id="S3.p1.16.m16.3.3.1.3.2.cmml" xref="S3.p1.16.m16.3.3.1.3.2">𝑝</ci><ci id="S3.p1.16.m16.3.3.1.3.3.cmml" xref="S3.p1.16.m16.3.3.1.3.3">𝜃</ci></apply><apply id="S3.p1.16.m16.3.3.1.1.1.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1"><csymbol cd="latexml" id="S3.p1.16.m16.3.3.1.1.1.1.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.16.m16.3.3.1.1.1.1.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.16.m16.3.3.1.1.1.1.2.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.16.m16.3.3.1.1.1.1.2.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2.2">𝑥</ci><apply id="S3.p1.16.m16.3.3.1.1.1.1.2.3.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2.3"><minus id="S3.p1.16.m16.3.3.1.1.1.1.2.3.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2.3.1"></minus><ci id="S3.p1.16.m16.3.3.1.1.1.1.2.3.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.2.3.2">𝑡</ci><cn id="S3.p1.16.m16.3.3.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.p1.16.m16.3.3.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.p1.16.m16.3.3.1.1.1.1.3.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.3.3.1.1.1.1.3.1.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.16.m16.3.3.1.1.1.1.3.2.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3.2">𝑥</ci><ci id="S3.p1.16.m16.3.3.1.1.1.1.3.3.cmml" xref="S3.p1.16.m16.3.3.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.p1.16.m16.5.5.3.cmml" xref="S3.p1.16.m16.5.5.3"><times id="S3.p1.16.m16.5.5.3.3.cmml" xref="S3.p1.16.m16.5.5.3.3"></times><ci id="S3.p1.16.m16.5.5.3.4.cmml" xref="S3.p1.16.m16.5.5.3.4">𝒩</ci><interval closure="open" id="S3.p1.16.m16.5.5.3.2.3.cmml" xref="S3.p1.16.m16.5.5.3.2.2"><apply id="S3.p1.16.m16.4.4.2.1.1.1.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1"><times id="S3.p1.16.m16.4.4.2.1.1.1.2.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1.2"></times><apply id="S3.p1.16.m16.4.4.2.1.1.1.3.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.2.1.1.1.3.1.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1.3">subscript</csymbol><ci id="S3.p1.16.m16.4.4.2.1.1.1.3.2.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1.3.2">𝜇</ci><ci id="S3.p1.16.m16.4.4.2.1.1.1.3.3.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.p1.16.m16.4.4.2.1.1.1.1.2.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1.1.1"><apply id="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.1.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.2.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.3.cmml" xref="S3.p1.16.m16.4.4.2.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.p1.16.m16.1.1.cmml" xref="S3.p1.16.m16.1.1">𝑡</ci></interval></apply><apply id="S3.p1.16.m16.5.5.3.2.2.2.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2"><times id="S3.p1.16.m16.5.5.3.2.2.2.2.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2.2"></times><apply id="S3.p1.16.m16.5.5.3.2.2.2.3.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.p1.16.m16.5.5.3.2.2.2.3.1.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2.3">subscript</csymbol><ci id="S3.p1.16.m16.5.5.3.2.2.2.3.2.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2.3.2">Σ</ci><ci id="S3.p1.16.m16.5.5.3.2.2.2.3.3.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.p1.16.m16.5.5.3.2.2.2.1.2.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2.1.1"><apply id="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.1.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.2.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.2">𝑥</ci><ci id="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.3.cmml" xref="S3.p1.16.m16.5.5.3.2.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.p1.16.m16.2.2.cmml" xref="S3.p1.16.m16.2.2">𝑡</ci></interval></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.16.m16.5c">p_{\theta}(x_{t-1}|x_{t})=\mathcal{N}(\mu_{\theta}(x_{t},t),\Sigma_{\theta}(x_%
{t},t))</annotation><annotation encoding="application/x-llamapun" id="S3.p1.16.m16.5d">italic_p start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t - 1 end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT ) = caligraphic_N ( italic_μ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) , roman_Σ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) )</annotation></semantics></math>,
where the parameters <math alttext="\mu_{\theta}(x_{t},t),\Sigma_{\theta}(x_{t},t)" class="ltx_Math" display="inline" id="S3.p1.17.m17.4"><semantics id="S3.p1.17.m17.4a"><mrow id="S3.p1.17.m17.4.4.2" xref="S3.p1.17.m17.4.4.3.cmml"><mrow id="S3.p1.17.m17.3.3.1.1" xref="S3.p1.17.m17.3.3.1.1.cmml"><msub id="S3.p1.17.m17.3.3.1.1.3" xref="S3.p1.17.m17.3.3.1.1.3.cmml"><mi id="S3.p1.17.m17.3.3.1.1.3.2" xref="S3.p1.17.m17.3.3.1.1.3.2.cmml">μ</mi><mi id="S3.p1.17.m17.3.3.1.1.3.3" xref="S3.p1.17.m17.3.3.1.1.3.3.cmml">θ</mi></msub><mo id="S3.p1.17.m17.3.3.1.1.2" xref="S3.p1.17.m17.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.p1.17.m17.3.3.1.1.1.1" xref="S3.p1.17.m17.3.3.1.1.1.2.cmml"><mo id="S3.p1.17.m17.3.3.1.1.1.1.2" stretchy="false" xref="S3.p1.17.m17.3.3.1.1.1.2.cmml">(</mo><msub id="S3.p1.17.m17.3.3.1.1.1.1.1" xref="S3.p1.17.m17.3.3.1.1.1.1.1.cmml"><mi id="S3.p1.17.m17.3.3.1.1.1.1.1.2" xref="S3.p1.17.m17.3.3.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p1.17.m17.3.3.1.1.1.1.1.3" xref="S3.p1.17.m17.3.3.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S3.p1.17.m17.3.3.1.1.1.1.3" xref="S3.p1.17.m17.3.3.1.1.1.2.cmml">,</mo><mi id="S3.p1.17.m17.1.1" xref="S3.p1.17.m17.1.1.cmml">t</mi><mo id="S3.p1.17.m17.3.3.1.1.1.1.4" stretchy="false" xref="S3.p1.17.m17.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.p1.17.m17.4.4.2.3" xref="S3.p1.17.m17.4.4.3.cmml">,</mo><mrow id="S3.p1.17.m17.4.4.2.2" xref="S3.p1.17.m17.4.4.2.2.cmml"><msub id="S3.p1.17.m17.4.4.2.2.3" xref="S3.p1.17.m17.4.4.2.2.3.cmml"><mi id="S3.p1.17.m17.4.4.2.2.3.2" mathvariant="normal" xref="S3.p1.17.m17.4.4.2.2.3.2.cmml">Σ</mi><mi id="S3.p1.17.m17.4.4.2.2.3.3" xref="S3.p1.17.m17.4.4.2.2.3.3.cmml">θ</mi></msub><mo id="S3.p1.17.m17.4.4.2.2.2" xref="S3.p1.17.m17.4.4.2.2.2.cmml">⁢</mo><mrow id="S3.p1.17.m17.4.4.2.2.1.1" xref="S3.p1.17.m17.4.4.2.2.1.2.cmml"><mo id="S3.p1.17.m17.4.4.2.2.1.1.2" stretchy="false" xref="S3.p1.17.m17.4.4.2.2.1.2.cmml">(</mo><msub id="S3.p1.17.m17.4.4.2.2.1.1.1" xref="S3.p1.17.m17.4.4.2.2.1.1.1.cmml"><mi id="S3.p1.17.m17.4.4.2.2.1.1.1.2" xref="S3.p1.17.m17.4.4.2.2.1.1.1.2.cmml">x</mi><mi id="S3.p1.17.m17.4.4.2.2.1.1.1.3" xref="S3.p1.17.m17.4.4.2.2.1.1.1.3.cmml">t</mi></msub><mo id="S3.p1.17.m17.4.4.2.2.1.1.3" xref="S3.p1.17.m17.4.4.2.2.1.2.cmml">,</mo><mi id="S3.p1.17.m17.2.2" xref="S3.p1.17.m17.2.2.cmml">t</mi><mo id="S3.p1.17.m17.4.4.2.2.1.1.4" stretchy="false" xref="S3.p1.17.m17.4.4.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.17.m17.4b"><list id="S3.p1.17.m17.4.4.3.cmml" xref="S3.p1.17.m17.4.4.2"><apply id="S3.p1.17.m17.3.3.1.1.cmml" xref="S3.p1.17.m17.3.3.1.1"><times id="S3.p1.17.m17.3.3.1.1.2.cmml" xref="S3.p1.17.m17.3.3.1.1.2"></times><apply id="S3.p1.17.m17.3.3.1.1.3.cmml" xref="S3.p1.17.m17.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.p1.17.m17.3.3.1.1.3.1.cmml" xref="S3.p1.17.m17.3.3.1.1.3">subscript</csymbol><ci id="S3.p1.17.m17.3.3.1.1.3.2.cmml" xref="S3.p1.17.m17.3.3.1.1.3.2">𝜇</ci><ci id="S3.p1.17.m17.3.3.1.1.3.3.cmml" xref="S3.p1.17.m17.3.3.1.1.3.3">𝜃</ci></apply><interval closure="open" id="S3.p1.17.m17.3.3.1.1.1.2.cmml" xref="S3.p1.17.m17.3.3.1.1.1.1"><apply id="S3.p1.17.m17.3.3.1.1.1.1.1.cmml" xref="S3.p1.17.m17.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p1.17.m17.3.3.1.1.1.1.1.1.cmml" xref="S3.p1.17.m17.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.p1.17.m17.3.3.1.1.1.1.1.2.cmml" xref="S3.p1.17.m17.3.3.1.1.1.1.1.2">𝑥</ci><ci id="S3.p1.17.m17.3.3.1.1.1.1.1.3.cmml" xref="S3.p1.17.m17.3.3.1.1.1.1.1.3">𝑡</ci></apply><ci id="S3.p1.17.m17.1.1.cmml" xref="S3.p1.17.m17.1.1">𝑡</ci></interval></apply><apply id="S3.p1.17.m17.4.4.2.2.cmml" xref="S3.p1.17.m17.4.4.2.2"><times id="S3.p1.17.m17.4.4.2.2.2.cmml" xref="S3.p1.17.m17.4.4.2.2.2"></times><apply id="S3.p1.17.m17.4.4.2.2.3.cmml" xref="S3.p1.17.m17.4.4.2.2.3"><csymbol cd="ambiguous" id="S3.p1.17.m17.4.4.2.2.3.1.cmml" xref="S3.p1.17.m17.4.4.2.2.3">subscript</csymbol><ci id="S3.p1.17.m17.4.4.2.2.3.2.cmml" xref="S3.p1.17.m17.4.4.2.2.3.2">Σ</ci><ci id="S3.p1.17.m17.4.4.2.2.3.3.cmml" xref="S3.p1.17.m17.4.4.2.2.3.3">𝜃</ci></apply><interval closure="open" id="S3.p1.17.m17.4.4.2.2.1.2.cmml" xref="S3.p1.17.m17.4.4.2.2.1.1"><apply id="S3.p1.17.m17.4.4.2.2.1.1.1.cmml" xref="S3.p1.17.m17.4.4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p1.17.m17.4.4.2.2.1.1.1.1.cmml" xref="S3.p1.17.m17.4.4.2.2.1.1.1">subscript</csymbol><ci id="S3.p1.17.m17.4.4.2.2.1.1.1.2.cmml" xref="S3.p1.17.m17.4.4.2.2.1.1.1.2">𝑥</ci><ci id="S3.p1.17.m17.4.4.2.2.1.1.1.3.cmml" xref="S3.p1.17.m17.4.4.2.2.1.1.1.3">𝑡</ci></apply><ci id="S3.p1.17.m17.2.2.cmml" xref="S3.p1.17.m17.2.2">𝑡</ci></interval></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.17.m17.4c">\mu_{\theta}(x_{t},t),\Sigma_{\theta}(x_{t},t)</annotation><annotation encoding="application/x-llamapun" id="S3.p1.17.m17.4d">italic_μ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t ) , roman_Σ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t )</annotation></semantics></math> of the denoising network are defined using a deep neural network. Once learned, the reverse process can synthesize new inputs from pure noise <math alttext="x_{T}" class="ltx_Math" display="inline" id="S3.p1.18.m18.1"><semantics id="S3.p1.18.m18.1a"><msub id="S3.p1.18.m18.1.1" xref="S3.p1.18.m18.1.1.cmml"><mi id="S3.p1.18.m18.1.1.2" xref="S3.p1.18.m18.1.1.2.cmml">x</mi><mi id="S3.p1.18.m18.1.1.3" xref="S3.p1.18.m18.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.18.m18.1b"><apply id="S3.p1.18.m18.1.1.cmml" xref="S3.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S3.p1.18.m18.1.1.1.cmml" xref="S3.p1.18.m18.1.1">subscript</csymbol><ci id="S3.p1.18.m18.1.1.2.cmml" xref="S3.p1.18.m18.1.1.2">𝑥</ci><ci id="S3.p1.18.m18.1.1.3.cmml" xref="S3.p1.18.m18.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.18.m18.1c">x_{T}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.18.m18.1d">italic_x start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT</annotation></semantics></math>. It can also be shown that estimating the reverse process parameters is equivalent to predicting the noise in the distribution <math alttext="q(x_{t}|x_{0})" class="ltx_Math" display="inline" id="S3.p1.19.m19.1"><semantics id="S3.p1.19.m19.1a"><mrow id="S3.p1.19.m19.1.1" xref="S3.p1.19.m19.1.1.cmml"><mi id="S3.p1.19.m19.1.1.3" xref="S3.p1.19.m19.1.1.3.cmml">q</mi><mo id="S3.p1.19.m19.1.1.2" xref="S3.p1.19.m19.1.1.2.cmml">⁢</mo><mrow id="S3.p1.19.m19.1.1.1.1" xref="S3.p1.19.m19.1.1.1.1.1.cmml"><mo id="S3.p1.19.m19.1.1.1.1.2" stretchy="false" xref="S3.p1.19.m19.1.1.1.1.1.cmml">(</mo><mrow id="S3.p1.19.m19.1.1.1.1.1" xref="S3.p1.19.m19.1.1.1.1.1.cmml"><msub id="S3.p1.19.m19.1.1.1.1.1.2" xref="S3.p1.19.m19.1.1.1.1.1.2.cmml"><mi id="S3.p1.19.m19.1.1.1.1.1.2.2" xref="S3.p1.19.m19.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.p1.19.m19.1.1.1.1.1.2.3" xref="S3.p1.19.m19.1.1.1.1.1.2.3.cmml">t</mi></msub><mo fence="false" id="S3.p1.19.m19.1.1.1.1.1.1" xref="S3.p1.19.m19.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p1.19.m19.1.1.1.1.1.3" xref="S3.p1.19.m19.1.1.1.1.1.3.cmml"><mi id="S3.p1.19.m19.1.1.1.1.1.3.2" xref="S3.p1.19.m19.1.1.1.1.1.3.2.cmml">x</mi><mn id="S3.p1.19.m19.1.1.1.1.1.3.3" xref="S3.p1.19.m19.1.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo id="S3.p1.19.m19.1.1.1.1.3" stretchy="false" xref="S3.p1.19.m19.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.19.m19.1b"><apply id="S3.p1.19.m19.1.1.cmml" xref="S3.p1.19.m19.1.1"><times id="S3.p1.19.m19.1.1.2.cmml" xref="S3.p1.19.m19.1.1.2"></times><ci id="S3.p1.19.m19.1.1.3.cmml" xref="S3.p1.19.m19.1.1.3">𝑞</ci><apply id="S3.p1.19.m19.1.1.1.1.1.cmml" xref="S3.p1.19.m19.1.1.1.1"><csymbol cd="latexml" id="S3.p1.19.m19.1.1.1.1.1.1.cmml" xref="S3.p1.19.m19.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p1.19.m19.1.1.1.1.1.2.cmml" xref="S3.p1.19.m19.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p1.19.m19.1.1.1.1.1.2.1.cmml" xref="S3.p1.19.m19.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p1.19.m19.1.1.1.1.1.2.2.cmml" xref="S3.p1.19.m19.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.p1.19.m19.1.1.1.1.1.2.3.cmml" xref="S3.p1.19.m19.1.1.1.1.1.2.3">𝑡</ci></apply><apply id="S3.p1.19.m19.1.1.1.1.1.3.cmml" xref="S3.p1.19.m19.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p1.19.m19.1.1.1.1.1.3.1.cmml" xref="S3.p1.19.m19.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p1.19.m19.1.1.1.1.1.3.2.cmml" xref="S3.p1.19.m19.1.1.1.1.1.3.2">𝑥</ci><cn id="S3.p1.19.m19.1.1.1.1.1.3.3.cmml" type="integer" xref="S3.p1.19.m19.1.1.1.1.1.3.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.19.m19.1c">q(x_{t}|x_{0})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.19.m19.1d">italic_q ( italic_x start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_x start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.7"><span class="ltx_text ltx_font_bold" id="S3.p2.7.1">Latent Diffusion Models:</span> While the forward and reverse diffusion processes of the standard DDPM operate in the image space, the latent diffusion model (LDM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx14" title="">Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer</a>]</cite> takes a different approach where both of these processes operate in a low-dimensional latent space. The LDM consists of an encoder <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">caligraphic_E</annotation></semantics></math> which compresses the input image <math alttext="x" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_x</annotation></semantics></math> into a lower-dimensional latent representation <math alttext="z" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">italic_z</annotation></semantics></math>, a decoder <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.p2.4.m4.1"><semantics id="S3.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.4.m4.1d">caligraphic_D</annotation></semantics></math> that reconstructs <math alttext="x" class="ltx_Math" display="inline" id="S3.p2.5.m5.1"><semantics id="S3.p2.5.m5.1a"><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.p2.5.m5.1d">italic_x</annotation></semantics></math> from <math alttext="z" class="ltx_Math" display="inline" id="S3.p2.6.m6.1"><semantics id="S3.p2.6.m6.1a"><mi id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><ci id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.p2.6.m6.1d">italic_z</annotation></semantics></math>, and the forward and reverse diffusion processes operate on the latent <math alttext="z" class="ltx_Math" display="inline" id="S3.p2.7.m7.1"><semantics id="S3.p2.7.m7.1a"><mi id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><ci id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.p2.7.m7.1d">italic_z</annotation></semantics></math> representation. In addition to yielding a semantically meaningful latent space, LDM has immediate benefits regarding reduced model size, training cost, and sample generation speed.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p3">
<p class="ltx_p" id="S3.p3.9"><span class="ltx_text ltx_font_bold" id="S3.p3.9.1">Retrieval-Augmented Generation:</span> An orthogonal approach to designing compact-sized deep generative models is retrieval-augmented generation (RAG) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx25" title="">Zhao et al.(2024)Zhao, Zhang, Yu, Wang, Geng, Fu, Yang, Zhang, and
Cui</a>]</cite> which augments a compact generative model with an external database <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">caligraphic_D</annotation></semantics></math>. RAG uses similarity-based retrieval during training/generation to condition the generative model based on additional data retrieved from this external database. Blatmann et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx2" title="">Blattmann et al.(2022)Blattmann, Rombach, Oktay, Müller, and
Ommer</a>]</cite> leveraged the RAG idea for diffusion models by employing a non-parametric retrieval strategy <math alttext="\xi_{k}:\mathcal{D}\mapsto\mathcal{M}_{\mathcal{D}}^{(k)}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mrow id="S3.p3.2.m2.1.2" xref="S3.p3.2.m2.1.2.cmml"><msub id="S3.p3.2.m2.1.2.2" xref="S3.p3.2.m2.1.2.2.cmml"><mi id="S3.p3.2.m2.1.2.2.2" xref="S3.p3.2.m2.1.2.2.2.cmml">ξ</mi><mi id="S3.p3.2.m2.1.2.2.3" xref="S3.p3.2.m2.1.2.2.3.cmml">k</mi></msub><mo id="S3.p3.2.m2.1.2.1" lspace="0.278em" rspace="0.278em" xref="S3.p3.2.m2.1.2.1.cmml">:</mo><mrow id="S3.p3.2.m2.1.2.3" xref="S3.p3.2.m2.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.2.m2.1.2.3.2" xref="S3.p3.2.m2.1.2.3.2.cmml">𝒟</mi><mo id="S3.p3.2.m2.1.2.3.1" stretchy="false" xref="S3.p3.2.m2.1.2.3.1.cmml">↦</mo><msubsup id="S3.p3.2.m2.1.2.3.3" xref="S3.p3.2.m2.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.2.m2.1.2.3.3.2.2" xref="S3.p3.2.m2.1.2.3.3.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S3.p3.2.m2.1.2.3.3.2.3" xref="S3.p3.2.m2.1.2.3.3.2.3.cmml">𝒟</mi><mrow id="S3.p3.2.m2.1.1.1.3" xref="S3.p3.2.m2.1.2.3.3.cmml"><mo id="S3.p3.2.m2.1.1.1.3.1" stretchy="false" xref="S3.p3.2.m2.1.2.3.3.cmml">(</mo><mi id="S3.p3.2.m2.1.1.1.1" xref="S3.p3.2.m2.1.1.1.1.cmml">k</mi><mo id="S3.p3.2.m2.1.1.1.3.2" stretchy="false" xref="S3.p3.2.m2.1.2.3.3.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.2.cmml" xref="S3.p3.2.m2.1.2"><ci id="S3.p3.2.m2.1.2.1.cmml" xref="S3.p3.2.m2.1.2.1">:</ci><apply id="S3.p3.2.m2.1.2.2.cmml" xref="S3.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.2.2.1.cmml" xref="S3.p3.2.m2.1.2.2">subscript</csymbol><ci id="S3.p3.2.m2.1.2.2.2.cmml" xref="S3.p3.2.m2.1.2.2.2">𝜉</ci><ci id="S3.p3.2.m2.1.2.2.3.cmml" xref="S3.p3.2.m2.1.2.2.3">𝑘</ci></apply><apply id="S3.p3.2.m2.1.2.3.cmml" xref="S3.p3.2.m2.1.2.3"><csymbol cd="latexml" id="S3.p3.2.m2.1.2.3.1.cmml" xref="S3.p3.2.m2.1.2.3.1">maps-to</csymbol><ci id="S3.p3.2.m2.1.2.3.2.cmml" xref="S3.p3.2.m2.1.2.3.2">𝒟</ci><apply id="S3.p3.2.m2.1.2.3.3.cmml" xref="S3.p3.2.m2.1.2.3.3"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.2.3.3.1.cmml" xref="S3.p3.2.m2.1.2.3.3">superscript</csymbol><apply id="S3.p3.2.m2.1.2.3.3.2.cmml" xref="S3.p3.2.m2.1.2.3.3"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.2.3.3.2.1.cmml" xref="S3.p3.2.m2.1.2.3.3">subscript</csymbol><ci id="S3.p3.2.m2.1.2.3.3.2.2.cmml" xref="S3.p3.2.m2.1.2.3.3.2.2">ℳ</ci><ci id="S3.p3.2.m2.1.2.3.3.2.3.cmml" xref="S3.p3.2.m2.1.2.3.3.2.3">𝒟</ci></apply><ci id="S3.p3.2.m2.1.1.1.1.cmml" xref="S3.p3.2.m2.1.1.1.1">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\xi_{k}:\mathcal{D}\mapsto\mathcal{M}_{\mathcal{D}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_ξ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT : caligraphic_D ↦ caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> such that <math alttext="\mathcal{M}_{\mathcal{D}}^{(k)}\subseteq\mathcal{D}" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><mrow id="S3.p3.3.m3.1.2" xref="S3.p3.3.m3.1.2.cmml"><msubsup id="S3.p3.3.m3.1.2.2" xref="S3.p3.3.m3.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.3.m3.1.2.2.2.2" xref="S3.p3.3.m3.1.2.2.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S3.p3.3.m3.1.2.2.2.3" xref="S3.p3.3.m3.1.2.2.2.3.cmml">𝒟</mi><mrow id="S3.p3.3.m3.1.1.1.3" xref="S3.p3.3.m3.1.2.2.cmml"><mo id="S3.p3.3.m3.1.1.1.3.1" stretchy="false" xref="S3.p3.3.m3.1.2.2.cmml">(</mo><mi id="S3.p3.3.m3.1.1.1.1" xref="S3.p3.3.m3.1.1.1.1.cmml">k</mi><mo id="S3.p3.3.m3.1.1.1.3.2" stretchy="false" xref="S3.p3.3.m3.1.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.p3.3.m3.1.2.1" xref="S3.p3.3.m3.1.2.1.cmml">⊆</mo><mi class="ltx_font_mathcaligraphic" id="S3.p3.3.m3.1.2.3" xref="S3.p3.3.m3.1.2.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.2.cmml" xref="S3.p3.3.m3.1.2"><subset id="S3.p3.3.m3.1.2.1.cmml" xref="S3.p3.3.m3.1.2.1"></subset><apply id="S3.p3.3.m3.1.2.2.cmml" xref="S3.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.2.2.1.cmml" xref="S3.p3.3.m3.1.2.2">superscript</csymbol><apply id="S3.p3.3.m3.1.2.2.2.cmml" xref="S3.p3.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.2.2.2.1.cmml" xref="S3.p3.3.m3.1.2.2">subscript</csymbol><ci id="S3.p3.3.m3.1.2.2.2.2.cmml" xref="S3.p3.3.m3.1.2.2.2.2">ℳ</ci><ci id="S3.p3.3.m3.1.2.2.2.3.cmml" xref="S3.p3.3.m3.1.2.2.2.3">𝒟</ci></apply><ci id="S3.p3.3.m3.1.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1.1">𝑘</ci></apply><ci id="S3.p3.3.m3.1.2.3.cmml" xref="S3.p3.3.m3.1.2.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">\mathcal{M}_{\mathcal{D}}^{(k)}\subseteq\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ⊆ caligraphic_D</annotation></semantics></math> and <math alttext="|\mathcal{M}_{\mathcal{D}}^{(k)}|=k" class="ltx_Math" display="inline" id="S3.p3.4.m4.2"><semantics id="S3.p3.4.m4.2a"><mrow id="S3.p3.4.m4.2.2" xref="S3.p3.4.m4.2.2.cmml"><mrow id="S3.p3.4.m4.2.2.1.1" xref="S3.p3.4.m4.2.2.1.2.cmml"><mo id="S3.p3.4.m4.2.2.1.1.2" stretchy="false" xref="S3.p3.4.m4.2.2.1.2.1.cmml">|</mo><msubsup id="S3.p3.4.m4.2.2.1.1.1" xref="S3.p3.4.m4.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.4.m4.2.2.1.1.1.2.2" xref="S3.p3.4.m4.2.2.1.1.1.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S3.p3.4.m4.2.2.1.1.1.2.3" xref="S3.p3.4.m4.2.2.1.1.1.2.3.cmml">𝒟</mi><mrow id="S3.p3.4.m4.1.1.1.3" xref="S3.p3.4.m4.2.2.1.1.1.cmml"><mo id="S3.p3.4.m4.1.1.1.3.1" stretchy="false" xref="S3.p3.4.m4.2.2.1.1.1.cmml">(</mo><mi id="S3.p3.4.m4.1.1.1.1" xref="S3.p3.4.m4.1.1.1.1.cmml">k</mi><mo id="S3.p3.4.m4.1.1.1.3.2" stretchy="false" xref="S3.p3.4.m4.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo id="S3.p3.4.m4.2.2.1.1.3" stretchy="false" xref="S3.p3.4.m4.2.2.1.2.1.cmml">|</mo></mrow><mo id="S3.p3.4.m4.2.2.2" xref="S3.p3.4.m4.2.2.2.cmml">=</mo><mi id="S3.p3.4.m4.2.2.3" xref="S3.p3.4.m4.2.2.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.2b"><apply id="S3.p3.4.m4.2.2.cmml" xref="S3.p3.4.m4.2.2"><eq id="S3.p3.4.m4.2.2.2.cmml" xref="S3.p3.4.m4.2.2.2"></eq><apply id="S3.p3.4.m4.2.2.1.2.cmml" xref="S3.p3.4.m4.2.2.1.1"><abs id="S3.p3.4.m4.2.2.1.2.1.cmml" xref="S3.p3.4.m4.2.2.1.1.2"></abs><apply id="S3.p3.4.m4.2.2.1.1.1.cmml" xref="S3.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.2.2.1.1.1.1.cmml" xref="S3.p3.4.m4.2.2.1.1.1">superscript</csymbol><apply id="S3.p3.4.m4.2.2.1.1.1.2.cmml" xref="S3.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m4.2.2.1.1.1.2.1.cmml" xref="S3.p3.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.p3.4.m4.2.2.1.1.1.2.2.cmml" xref="S3.p3.4.m4.2.2.1.1.1.2.2">ℳ</ci><ci id="S3.p3.4.m4.2.2.1.1.1.2.3.cmml" xref="S3.p3.4.m4.2.2.1.1.1.2.3">𝒟</ci></apply><ci id="S3.p3.4.m4.1.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1.1">𝑘</ci></apply></apply><ci id="S3.p3.4.m4.2.2.3.cmml" xref="S3.p3.4.m4.2.2.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.2c">|\mathcal{M}_{\mathcal{D}}^{(k)}|=k</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.2d">| caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT | = italic_k</annotation></semantics></math>. During the training phase, for each sample <math alttext="x\sim p(x)" class="ltx_Math" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><mrow id="S3.p3.5.m5.1.2" xref="S3.p3.5.m5.1.2.cmml"><mi id="S3.p3.5.m5.1.2.2" xref="S3.p3.5.m5.1.2.2.cmml">x</mi><mo id="S3.p3.5.m5.1.2.1" xref="S3.p3.5.m5.1.2.1.cmml">∼</mo><mrow id="S3.p3.5.m5.1.2.3" xref="S3.p3.5.m5.1.2.3.cmml"><mi id="S3.p3.5.m5.1.2.3.2" xref="S3.p3.5.m5.1.2.3.2.cmml">p</mi><mo id="S3.p3.5.m5.1.2.3.1" xref="S3.p3.5.m5.1.2.3.1.cmml">⁢</mo><mrow id="S3.p3.5.m5.1.2.3.3.2" xref="S3.p3.5.m5.1.2.3.cmml"><mo id="S3.p3.5.m5.1.2.3.3.2.1" stretchy="false" xref="S3.p3.5.m5.1.2.3.cmml">(</mo><mi id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml">x</mi><mo id="S3.p3.5.m5.1.2.3.3.2.2" stretchy="false" xref="S3.p3.5.m5.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><apply id="S3.p3.5.m5.1.2.cmml" xref="S3.p3.5.m5.1.2"><csymbol cd="latexml" id="S3.p3.5.m5.1.2.1.cmml" xref="S3.p3.5.m5.1.2.1">similar-to</csymbol><ci id="S3.p3.5.m5.1.2.2.cmml" xref="S3.p3.5.m5.1.2.2">𝑥</ci><apply id="S3.p3.5.m5.1.2.3.cmml" xref="S3.p3.5.m5.1.2.3"><times id="S3.p3.5.m5.1.2.3.1.cmml" xref="S3.p3.5.m5.1.2.3.1"></times><ci id="S3.p3.5.m5.1.2.3.2.cmml" xref="S3.p3.5.m5.1.2.3.2">𝑝</ci><ci id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">x\sim p(x)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">italic_x ∼ italic_p ( italic_x )</annotation></semantics></math>, their proposed retrieval-augmented diffusion model (RDM) uses <math alttext="\xi_{k}" class="ltx_Math" display="inline" id="S3.p3.6.m6.1"><semantics id="S3.p3.6.m6.1a"><msub id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml"><mi id="S3.p3.6.m6.1.1.2" xref="S3.p3.6.m6.1.1.2.cmml">ξ</mi><mi id="S3.p3.6.m6.1.1.3" xref="S3.p3.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><apply id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.1.cmml" xref="S3.p3.6.m6.1.1">subscript</csymbol><ci id="S3.p3.6.m6.1.1.2.cmml" xref="S3.p3.6.m6.1.1.2">𝜉</ci><ci id="S3.p3.6.m6.1.1.3.cmml" xref="S3.p3.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">\xi_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m6.1d">italic_ξ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> to acquire a set of <math alttext="k" class="ltx_Math" display="inline" id="S3.p3.7.m7.1"><semantics id="S3.p3.7.m7.1a"><mi id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><ci id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.p3.7.m7.1d">italic_k</annotation></semantics></math> nearest neighbors <math alttext="\mathcal{M}_{\mathcal{D}}^{(k)}(x)" class="ltx_Math" display="inline" id="S3.p3.8.m8.2"><semantics id="S3.p3.8.m8.2a"><mrow id="S3.p3.8.m8.2.3" xref="S3.p3.8.m8.2.3.cmml"><msubsup id="S3.p3.8.m8.2.3.2" xref="S3.p3.8.m8.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.8.m8.2.3.2.2.2" xref="S3.p3.8.m8.2.3.2.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S3.p3.8.m8.2.3.2.2.3" xref="S3.p3.8.m8.2.3.2.2.3.cmml">𝒟</mi><mrow id="S3.p3.8.m8.1.1.1.3" xref="S3.p3.8.m8.2.3.2.cmml"><mo id="S3.p3.8.m8.1.1.1.3.1" stretchy="false" xref="S3.p3.8.m8.2.3.2.cmml">(</mo><mi id="S3.p3.8.m8.1.1.1.1" xref="S3.p3.8.m8.1.1.1.1.cmml">k</mi><mo id="S3.p3.8.m8.1.1.1.3.2" stretchy="false" xref="S3.p3.8.m8.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S3.p3.8.m8.2.3.1" xref="S3.p3.8.m8.2.3.1.cmml">⁢</mo><mrow id="S3.p3.8.m8.2.3.3.2" xref="S3.p3.8.m8.2.3.cmml"><mo id="S3.p3.8.m8.2.3.3.2.1" stretchy="false" xref="S3.p3.8.m8.2.3.cmml">(</mo><mi id="S3.p3.8.m8.2.2" xref="S3.p3.8.m8.2.2.cmml">x</mi><mo id="S3.p3.8.m8.2.3.3.2.2" stretchy="false" xref="S3.p3.8.m8.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.2b"><apply id="S3.p3.8.m8.2.3.cmml" xref="S3.p3.8.m8.2.3"><times id="S3.p3.8.m8.2.3.1.cmml" xref="S3.p3.8.m8.2.3.1"></times><apply id="S3.p3.8.m8.2.3.2.cmml" xref="S3.p3.8.m8.2.3.2"><csymbol cd="ambiguous" id="S3.p3.8.m8.2.3.2.1.cmml" xref="S3.p3.8.m8.2.3.2">superscript</csymbol><apply id="S3.p3.8.m8.2.3.2.2.cmml" xref="S3.p3.8.m8.2.3.2"><csymbol cd="ambiguous" id="S3.p3.8.m8.2.3.2.2.1.cmml" xref="S3.p3.8.m8.2.3.2">subscript</csymbol><ci id="S3.p3.8.m8.2.3.2.2.2.cmml" xref="S3.p3.8.m8.2.3.2.2.2">ℳ</ci><ci id="S3.p3.8.m8.2.3.2.2.3.cmml" xref="S3.p3.8.m8.2.3.2.2.3">𝒟</ci></apply><ci id="S3.p3.8.m8.1.1.1.1.cmml" xref="S3.p3.8.m8.1.1.1.1">𝑘</ci></apply><ci id="S3.p3.8.m8.2.2.cmml" xref="S3.p3.8.m8.2.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.2c">\mathcal{M}_{\mathcal{D}}^{(k)}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.8.m8.2d">caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ( italic_x )</annotation></semantics></math> from the database <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.p3.9.m9.1"><semantics id="S3.p3.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><ci id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.9.m9.1d">caligraphic_D</annotation></semantics></math>. Subsequently, the generative model is conditioned on the representations of these retrieved instances, eliminating the necessity to synthesize an image region entirely from its parameter manifold. While RAG is primarily motivated by the need for compact models, our work shows how RAG can also be leveraged to solve the challenging problem of ensuring coherence across blocks when doing block-wise generation.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Denoising Diffusion Models with Block-wise Generation</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.8">Our block-wise generation approach applies to DDPMs operating in the image space and those operating in a latent space. This work will illustrate our approach using the latent diffusion model (LDM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx14" title="">Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer</a>]</cite>, an example of the latter class of methods. Our approach (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.F1" title="Figure 1 ‣ 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">1</span></a>) assumes that the input to each forward/reverse diffusion step is partitioned into <math alttext="b" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">italic_b</annotation></semantics></math> disjoint blocks. Omitting the time-step subscript <math alttext="t" class="ltx_Math" display="inline" id="S4.p1.2.m2.1"><semantics id="S4.p1.2.m2.1a"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1d">italic_t</annotation></semantics></math> and denoting the latent representation at any time-step as <math alttext="z" class="ltx_Math" display="inline" id="S4.p1.3.m3.1"><semantics id="S4.p1.3.m3.1a"><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.p1.3.m3.1d">italic_z</annotation></semantics></math>, we assume it to be partitioned into <math alttext="b" class="ltx_Math" display="inline" id="S4.p1.4.m4.1"><semantics id="S4.p1.4.m4.1a"><mi id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><ci id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.p1.4.m4.1d">italic_b</annotation></semantics></math> equal-sized disjoint blocks as <math alttext="z=\bigcup_{i=0}^{b-1}z^{i}" class="ltx_Math" display="inline" id="S4.p1.5.m5.1"><semantics id="S4.p1.5.m5.1a"><mrow id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml"><mi id="S4.p1.5.m5.1.1.2" xref="S4.p1.5.m5.1.1.2.cmml">z</mi><mo id="S4.p1.5.m5.1.1.1" rspace="0.111em" xref="S4.p1.5.m5.1.1.1.cmml">=</mo><mrow id="S4.p1.5.m5.1.1.3" xref="S4.p1.5.m5.1.1.3.cmml"><msubsup id="S4.p1.5.m5.1.1.3.1" xref="S4.p1.5.m5.1.1.3.1.cmml"><mo id="S4.p1.5.m5.1.1.3.1.2.2" xref="S4.p1.5.m5.1.1.3.1.2.2.cmml">⋃</mo><mrow id="S4.p1.5.m5.1.1.3.1.2.3" xref="S4.p1.5.m5.1.1.3.1.2.3.cmml"><mi id="S4.p1.5.m5.1.1.3.1.2.3.2" xref="S4.p1.5.m5.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.p1.5.m5.1.1.3.1.2.3.1" xref="S4.p1.5.m5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.p1.5.m5.1.1.3.1.2.3.3" xref="S4.p1.5.m5.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="S4.p1.5.m5.1.1.3.1.3" xref="S4.p1.5.m5.1.1.3.1.3.cmml"><mi id="S4.p1.5.m5.1.1.3.1.3.2" xref="S4.p1.5.m5.1.1.3.1.3.2.cmml">b</mi><mo id="S4.p1.5.m5.1.1.3.1.3.1" xref="S4.p1.5.m5.1.1.3.1.3.1.cmml">−</mo><mn id="S4.p1.5.m5.1.1.3.1.3.3" xref="S4.p1.5.m5.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup><msup id="S4.p1.5.m5.1.1.3.2" xref="S4.p1.5.m5.1.1.3.2.cmml"><mi id="S4.p1.5.m5.1.1.3.2.2" xref="S4.p1.5.m5.1.1.3.2.2.cmml">z</mi><mi id="S4.p1.5.m5.1.1.3.2.3" xref="S4.p1.5.m5.1.1.3.2.3.cmml">i</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><apply id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1"><eq id="S4.p1.5.m5.1.1.1.cmml" xref="S4.p1.5.m5.1.1.1"></eq><ci id="S4.p1.5.m5.1.1.2.cmml" xref="S4.p1.5.m5.1.1.2">𝑧</ci><apply id="S4.p1.5.m5.1.1.3.cmml" xref="S4.p1.5.m5.1.1.3"><apply id="S4.p1.5.m5.1.1.3.1.cmml" xref="S4.p1.5.m5.1.1.3.1"><csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.3.1.1.cmml" xref="S4.p1.5.m5.1.1.3.1">superscript</csymbol><apply id="S4.p1.5.m5.1.1.3.1.2.cmml" xref="S4.p1.5.m5.1.1.3.1"><csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.3.1.2.1.cmml" xref="S4.p1.5.m5.1.1.3.1">subscript</csymbol><union id="S4.p1.5.m5.1.1.3.1.2.2.cmml" xref="S4.p1.5.m5.1.1.3.1.2.2"></union><apply id="S4.p1.5.m5.1.1.3.1.2.3.cmml" xref="S4.p1.5.m5.1.1.3.1.2.3"><eq id="S4.p1.5.m5.1.1.3.1.2.3.1.cmml" xref="S4.p1.5.m5.1.1.3.1.2.3.1"></eq><ci id="S4.p1.5.m5.1.1.3.1.2.3.2.cmml" xref="S4.p1.5.m5.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.p1.5.m5.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.p1.5.m5.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="S4.p1.5.m5.1.1.3.1.3.cmml" xref="S4.p1.5.m5.1.1.3.1.3"><minus id="S4.p1.5.m5.1.1.3.1.3.1.cmml" xref="S4.p1.5.m5.1.1.3.1.3.1"></minus><ci id="S4.p1.5.m5.1.1.3.1.3.2.cmml" xref="S4.p1.5.m5.1.1.3.1.3.2">𝑏</ci><cn id="S4.p1.5.m5.1.1.3.1.3.3.cmml" type="integer" xref="S4.p1.5.m5.1.1.3.1.3.3">1</cn></apply></apply><apply id="S4.p1.5.m5.1.1.3.2.cmml" xref="S4.p1.5.m5.1.1.3.2"><csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.3.2.1.cmml" xref="S4.p1.5.m5.1.1.3.2">superscript</csymbol><ci id="S4.p1.5.m5.1.1.3.2.2.cmml" xref="S4.p1.5.m5.1.1.3.2.2">𝑧</ci><ci id="S4.p1.5.m5.1.1.3.2.3.cmml" xref="S4.p1.5.m5.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">z=\bigcup_{i=0}^{b-1}z^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.5.m5.1d">italic_z = ⋃ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>. Operating on smaller-sized blocks <math alttext="z^{i}" class="ltx_Math" display="inline" id="S4.p1.6.m6.1"><semantics id="S4.p1.6.m6.1a"><msup id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml"><mi id="S4.p1.6.m6.1.1.2" xref="S4.p1.6.m6.1.1.2.cmml">z</mi><mi id="S4.p1.6.m6.1.1.3" xref="S4.p1.6.m6.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.1b"><apply id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p1.6.m6.1.1.1.cmml" xref="S4.p1.6.m6.1.1">superscript</csymbol><ci id="S4.p1.6.m6.1.1.2.cmml" xref="S4.p1.6.m6.1.1.2">𝑧</ci><ci id="S4.p1.6.m6.1.1.3.cmml" xref="S4.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.1c">z^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.6.m6.1d">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> naturally results in a model with fewer parameters, which is our primary goal. However, the challenge here is to ensure coherence among the blocks (e.g., avoiding artifacts at the block boundaries, semantic inconsistency between adjacent blocks, etc.). To achieve coherence, each block <math alttext="z^{i}" class="ltx_Math" display="inline" id="S4.p1.7.m7.1"><semantics id="S4.p1.7.m7.1a"><msup id="S4.p1.7.m7.1.1" xref="S4.p1.7.m7.1.1.cmml"><mi id="S4.p1.7.m7.1.1.2" xref="S4.p1.7.m7.1.1.2.cmml">z</mi><mi id="S4.p1.7.m7.1.1.3" xref="S4.p1.7.m7.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p1.7.m7.1b"><apply id="S4.p1.7.m7.1.1.cmml" xref="S4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p1.7.m7.1.1.1.cmml" xref="S4.p1.7.m7.1.1">superscript</csymbol><ci id="S4.p1.7.m7.1.1.2.cmml" xref="S4.p1.7.m7.1.1.2">𝑧</ci><ci id="S4.p1.7.m7.1.1.3.cmml" xref="S4.p1.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.7.m7.1c">z^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.7.m7.1d">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is also conditioned on the <span class="ltx_text ltx_font_italic" id="S4.p1.8.1">corresponding</span> block of a set of <math alttext="k" class="ltx_Math" display="inline" id="S4.p1.8.m8.1"><semantics id="S4.p1.8.m8.1a"><mi id="S4.p1.8.m8.1.1" xref="S4.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p1.8.m8.1b"><ci id="S4.p1.8.m8.1.1.cmml" xref="S4.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.8.m8.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.p1.8.m8.1d">italic_k</annotation></semantics></math> nearest neighbors retrieved from the external database; Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.SS1.SSS3" title="4.1.3 Block-wise DDPM Training ‣ 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">4.1.3</span></a> provides the details. We refer to our approach as RISSOLE (Paramete<span class="ltx_text ltx_font_bold" id="S4.p1.8.2">R</span>-effic<span class="ltx_text ltx_font_bold" id="S4.p1.8.3">I</span>ent Diffu<span class="ltx_text ltx_font_bold" id="S4.p1.8.4">S</span>ion Models via Block-wi<span class="ltx_text ltx_font_bold" id="S4.p1.8.5">S</span>e Generati<span class="ltx_text ltx_font_bold" id="S4.p1.8.6">O</span>n and Retrieva<span class="ltx_text ltx_font_bold" id="S4.p1.8.7">L</span>-Guidanc<span class="ltx_text ltx_font_bold" id="S4.p1.8.8">E</span>).</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>RISSOLE Training</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">The training procedure of RISSOLE consists of the following steps: (1) VQ-GAN encoder-decoder training because our model operates in a latent space,(2) Building the database from which retrieval is performed, and (3) DDPM training in the latent space using a block-wise generation approach and leveraging RAG to ensure coherence across blocks. Next, we describe each of these steps in more detail.</p>
</div>
<figure class="ltx_figure" id="S4.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="124" id="S4.F1.g1" src="extracted/5829184/Images/blockldm_training.png" width="598"/></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="136" id="S4.F1.g2" src="extracted/5829184/Images/blockldm_sampling.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="ltx_text" id="S4.F1.48.24" style="font-size:90%;">Training and Sampling of RISSOLE: (a) During training, each image <math alttext="x" class="ltx_Math" display="inline" id="S4.F1.25.1.m1.1"><semantics id="S4.F1.25.1.m1.1b"><mi id="S4.F1.25.1.m1.1.1" xref="S4.F1.25.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.F1.25.1.m1.1c"><ci id="S4.F1.25.1.m1.1.1.cmml" xref="S4.F1.25.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.25.1.m1.1d">x</annotation><annotation encoding="application/x-llamapun" id="S4.F1.25.1.m1.1e">italic_x</annotation></semantics></math> goes through a VQ-GAN encoder <math alttext="E_{\theta}" class="ltx_Math" display="inline" id="S4.F1.26.2.m2.1"><semantics id="S4.F1.26.2.m2.1b"><msub id="S4.F1.26.2.m2.1.1" xref="S4.F1.26.2.m2.1.1.cmml"><mi id="S4.F1.26.2.m2.1.1.2" xref="S4.F1.26.2.m2.1.1.2.cmml">E</mi><mi id="S4.F1.26.2.m2.1.1.3" xref="S4.F1.26.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F1.26.2.m2.1c"><apply id="S4.F1.26.2.m2.1.1.cmml" xref="S4.F1.26.2.m2.1.1"><csymbol cd="ambiguous" id="S4.F1.26.2.m2.1.1.1.cmml" xref="S4.F1.26.2.m2.1.1">subscript</csymbol><ci id="S4.F1.26.2.m2.1.1.2.cmml" xref="S4.F1.26.2.m2.1.1.2">𝐸</ci><ci id="S4.F1.26.2.m2.1.1.3.cmml" xref="S4.F1.26.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.26.2.m2.1d">E_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.26.2.m2.1e">italic_E start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, resulting in the generation of a latent representation <math alttext="z" class="ltx_Math" display="inline" id="S4.F1.27.3.m3.1"><semantics id="S4.F1.27.3.m3.1b"><mi id="S4.F1.27.3.m3.1.1" xref="S4.F1.27.3.m3.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.F1.27.3.m3.1c"><ci id="S4.F1.27.3.m3.1.1.cmml" xref="S4.F1.27.3.m3.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.27.3.m3.1d">z</annotation><annotation encoding="application/x-llamapun" id="S4.F1.27.3.m3.1e">italic_z</annotation></semantics></math>. (b) This latent representation <math alttext="z" class="ltx_Math" display="inline" id="S4.F1.28.4.m4.1"><semantics id="S4.F1.28.4.m4.1b"><mi id="S4.F1.28.4.m4.1.1" xref="S4.F1.28.4.m4.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.F1.28.4.m4.1c"><ci id="S4.F1.28.4.m4.1.1.cmml" xref="S4.F1.28.4.m4.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.28.4.m4.1d">z</annotation><annotation encoding="application/x-llamapun" id="S4.F1.28.4.m4.1e">italic_z</annotation></semantics></math> is then utilized by the retriever <math alttext="\xi_{k}(.)" class="ltx_math_unparsed" display="inline" id="S4.F1.29.5.m5.1"><semantics id="S4.F1.29.5.m5.1b"><mrow id="S4.F1.29.5.m5.1c"><msub id="S4.F1.29.5.m5.1.1"><mi id="S4.F1.29.5.m5.1.1.2">ξ</mi><mi id="S4.F1.29.5.m5.1.1.3">k</mi></msub><mrow id="S4.F1.29.5.m5.1.2"><mo id="S4.F1.29.5.m5.1.2.1" stretchy="false">(</mo><mo id="S4.F1.29.5.m5.1.2.2" lspace="0em" rspace="0.167em">.</mo><mo id="S4.F1.29.5.m5.1.2.3" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.F1.29.5.m5.1d">\xi_{k}(.)</annotation><annotation encoding="application/x-llamapun" id="S4.F1.29.5.m5.1e">italic_ξ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( . )</annotation></semantics></math> to fetch its <math alttext="k" class="ltx_Math" display="inline" id="S4.F1.30.6.m6.1"><semantics id="S4.F1.30.6.m6.1b"><mi id="S4.F1.30.6.m6.1.1" xref="S4.F1.30.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.F1.30.6.m6.1c"><ci id="S4.F1.30.6.m6.1.1.cmml" xref="S4.F1.30.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.30.6.m6.1d">k</annotation><annotation encoding="application/x-llamapun" id="S4.F1.30.6.m6.1e">italic_k</annotation></semantics></math> nearest neighbors <math alttext="\mathcal{M}_{\mathcal{D}}^{(k)}" class="ltx_Math" display="inline" id="S4.F1.31.7.m7.1"><semantics id="S4.F1.31.7.m7.1b"><msubsup id="S4.F1.31.7.m7.1.2" xref="S4.F1.31.7.m7.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F1.31.7.m7.1.2.2.2" xref="S4.F1.31.7.m7.1.2.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S4.F1.31.7.m7.1.2.2.3" xref="S4.F1.31.7.m7.1.2.2.3.cmml">𝒟</mi><mrow id="S4.F1.31.7.m7.1.1.1.3" xref="S4.F1.31.7.m7.1.2.cmml"><mo id="S4.F1.31.7.m7.1.1.1.3.1" stretchy="false" xref="S4.F1.31.7.m7.1.2.cmml">(</mo><mi id="S4.F1.31.7.m7.1.1.1.1" xref="S4.F1.31.7.m7.1.1.1.1.cmml">k</mi><mo id="S4.F1.31.7.m7.1.1.1.3.2" stretchy="false" xref="S4.F1.31.7.m7.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.F1.31.7.m7.1c"><apply id="S4.F1.31.7.m7.1.2.cmml" xref="S4.F1.31.7.m7.1.2"><csymbol cd="ambiguous" id="S4.F1.31.7.m7.1.2.1.cmml" xref="S4.F1.31.7.m7.1.2">superscript</csymbol><apply id="S4.F1.31.7.m7.1.2.2.cmml" xref="S4.F1.31.7.m7.1.2"><csymbol cd="ambiguous" id="S4.F1.31.7.m7.1.2.2.1.cmml" xref="S4.F1.31.7.m7.1.2">subscript</csymbol><ci id="S4.F1.31.7.m7.1.2.2.2.cmml" xref="S4.F1.31.7.m7.1.2.2.2">ℳ</ci><ci id="S4.F1.31.7.m7.1.2.2.3.cmml" xref="S4.F1.31.7.m7.1.2.2.3">𝒟</ci></apply><ci id="S4.F1.31.7.m7.1.1.1.1.cmml" xref="S4.F1.31.7.m7.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.31.7.m7.1d">\mathcal{M}_{\mathcal{D}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.31.7.m7.1e">caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> from a dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.F1.32.8.m8.1"><semantics id="S4.F1.32.8.m8.1b"><mi class="ltx_font_mathcaligraphic" id="S4.F1.32.8.m8.1.1" xref="S4.F1.32.8.m8.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.F1.32.8.m8.1c"><ci id="S4.F1.32.8.m8.1.1.cmml" xref="S4.F1.32.8.m8.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.32.8.m8.1d">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.32.8.m8.1e">caligraphic_D</annotation></semantics></math>. (c) Each group of blocks <math alttext="\mathcal{M}_{\mathcal{D}_{i}}^{(k)}\in\mathcal{M}_{\mathcal{D}}^{(k)}" class="ltx_Math" display="inline" id="S4.F1.33.9.m9.2"><semantics id="S4.F1.33.9.m9.2b"><mrow id="S4.F1.33.9.m9.2.3" xref="S4.F1.33.9.m9.2.3.cmml"><msubsup id="S4.F1.33.9.m9.2.3.2" xref="S4.F1.33.9.m9.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F1.33.9.m9.2.3.2.2.2" xref="S4.F1.33.9.m9.2.3.2.2.2.cmml">ℳ</mi><msub id="S4.F1.33.9.m9.2.3.2.2.3" xref="S4.F1.33.9.m9.2.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F1.33.9.m9.2.3.2.2.3.2" xref="S4.F1.33.9.m9.2.3.2.2.3.2.cmml">𝒟</mi><mi id="S4.F1.33.9.m9.2.3.2.2.3.3" xref="S4.F1.33.9.m9.2.3.2.2.3.3.cmml">i</mi></msub><mrow id="S4.F1.33.9.m9.1.1.1.3" xref="S4.F1.33.9.m9.2.3.2.cmml"><mo id="S4.F1.33.9.m9.1.1.1.3.1" stretchy="false" xref="S4.F1.33.9.m9.2.3.2.cmml">(</mo><mi id="S4.F1.33.9.m9.1.1.1.1" xref="S4.F1.33.9.m9.1.1.1.1.cmml">k</mi><mo id="S4.F1.33.9.m9.1.1.1.3.2" stretchy="false" xref="S4.F1.33.9.m9.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S4.F1.33.9.m9.2.3.1" xref="S4.F1.33.9.m9.2.3.1.cmml">∈</mo><msubsup id="S4.F1.33.9.m9.2.3.3" xref="S4.F1.33.9.m9.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F1.33.9.m9.2.3.3.2.2" xref="S4.F1.33.9.m9.2.3.3.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S4.F1.33.9.m9.2.3.3.2.3" xref="S4.F1.33.9.m9.2.3.3.2.3.cmml">𝒟</mi><mrow id="S4.F1.33.9.m9.2.2.1.3" xref="S4.F1.33.9.m9.2.3.3.cmml"><mo id="S4.F1.33.9.m9.2.2.1.3.1" stretchy="false" xref="S4.F1.33.9.m9.2.3.3.cmml">(</mo><mi id="S4.F1.33.9.m9.2.2.1.1" xref="S4.F1.33.9.m9.2.2.1.1.cmml">k</mi><mo id="S4.F1.33.9.m9.2.2.1.3.2" stretchy="false" xref="S4.F1.33.9.m9.2.3.3.cmml">)</mo></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.F1.33.9.m9.2c"><apply id="S4.F1.33.9.m9.2.3.cmml" xref="S4.F1.33.9.m9.2.3"><in id="S4.F1.33.9.m9.2.3.1.cmml" xref="S4.F1.33.9.m9.2.3.1"></in><apply id="S4.F1.33.9.m9.2.3.2.cmml" xref="S4.F1.33.9.m9.2.3.2"><csymbol cd="ambiguous" id="S4.F1.33.9.m9.2.3.2.1.cmml" xref="S4.F1.33.9.m9.2.3.2">superscript</csymbol><apply id="S4.F1.33.9.m9.2.3.2.2.cmml" xref="S4.F1.33.9.m9.2.3.2"><csymbol cd="ambiguous" id="S4.F1.33.9.m9.2.3.2.2.1.cmml" xref="S4.F1.33.9.m9.2.3.2">subscript</csymbol><ci id="S4.F1.33.9.m9.2.3.2.2.2.cmml" xref="S4.F1.33.9.m9.2.3.2.2.2">ℳ</ci><apply id="S4.F1.33.9.m9.2.3.2.2.3.cmml" xref="S4.F1.33.9.m9.2.3.2.2.3"><csymbol cd="ambiguous" id="S4.F1.33.9.m9.2.3.2.2.3.1.cmml" xref="S4.F1.33.9.m9.2.3.2.2.3">subscript</csymbol><ci id="S4.F1.33.9.m9.2.3.2.2.3.2.cmml" xref="S4.F1.33.9.m9.2.3.2.2.3.2">𝒟</ci><ci id="S4.F1.33.9.m9.2.3.2.2.3.3.cmml" xref="S4.F1.33.9.m9.2.3.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.F1.33.9.m9.1.1.1.1.cmml" xref="S4.F1.33.9.m9.1.1.1.1">𝑘</ci></apply><apply id="S4.F1.33.9.m9.2.3.3.cmml" xref="S4.F1.33.9.m9.2.3.3"><csymbol cd="ambiguous" id="S4.F1.33.9.m9.2.3.3.1.cmml" xref="S4.F1.33.9.m9.2.3.3">superscript</csymbol><apply id="S4.F1.33.9.m9.2.3.3.2.cmml" xref="S4.F1.33.9.m9.2.3.3"><csymbol cd="ambiguous" id="S4.F1.33.9.m9.2.3.3.2.1.cmml" xref="S4.F1.33.9.m9.2.3.3">subscript</csymbol><ci id="S4.F1.33.9.m9.2.3.3.2.2.cmml" xref="S4.F1.33.9.m9.2.3.3.2.2">ℳ</ci><ci id="S4.F1.33.9.m9.2.3.3.2.3.cmml" xref="S4.F1.33.9.m9.2.3.3.2.3">𝒟</ci></apply><ci id="S4.F1.33.9.m9.2.2.1.1.cmml" xref="S4.F1.33.9.m9.2.2.1.1">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.33.9.m9.2d">\mathcal{M}_{\mathcal{D}_{i}}^{(k)}\in\mathcal{M}_{\mathcal{D}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.33.9.m9.2e">caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT ∈ caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> is used as a conditioning signal for the corresponding <math alttext="z^{i}" class="ltx_Math" display="inline" id="S4.F1.34.10.m10.1"><semantics id="S4.F1.34.10.m10.1b"><msup id="S4.F1.34.10.m10.1.1" xref="S4.F1.34.10.m10.1.1.cmml"><mi id="S4.F1.34.10.m10.1.1.2" xref="S4.F1.34.10.m10.1.1.2.cmml">z</mi><mi id="S4.F1.34.10.m10.1.1.3" xref="S4.F1.34.10.m10.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.F1.34.10.m10.1c"><apply id="S4.F1.34.10.m10.1.1.cmml" xref="S4.F1.34.10.m10.1.1"><csymbol cd="ambiguous" id="S4.F1.34.10.m10.1.1.1.cmml" xref="S4.F1.34.10.m10.1.1">superscript</csymbol><ci id="S4.F1.34.10.m10.1.1.2.cmml" xref="S4.F1.34.10.m10.1.1.2">𝑧</ci><ci id="S4.F1.34.10.m10.1.1.3.cmml" xref="S4.F1.34.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.34.10.m10.1d">z^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.34.10.m10.1e">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, aiding in the training procedure. (d) During the sampling (generation) phase, a pseudo-query <math alttext="\hat{z}^{0}" class="ltx_Math" display="inline" id="S4.F1.35.11.m11.1"><semantics id="S4.F1.35.11.m11.1b"><msup id="S4.F1.35.11.m11.1.1" xref="S4.F1.35.11.m11.1.1.cmml"><mover accent="true" id="S4.F1.35.11.m11.1.1.2" xref="S4.F1.35.11.m11.1.1.2.cmml"><mi id="S4.F1.35.11.m11.1.1.2.2" xref="S4.F1.35.11.m11.1.1.2.2.cmml">z</mi><mo id="S4.F1.35.11.m11.1.1.2.1" xref="S4.F1.35.11.m11.1.1.2.1.cmml">^</mo></mover><mn id="S4.F1.35.11.m11.1.1.3" xref="S4.F1.35.11.m11.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.F1.35.11.m11.1c"><apply id="S4.F1.35.11.m11.1.1.cmml" xref="S4.F1.35.11.m11.1.1"><csymbol cd="ambiguous" id="S4.F1.35.11.m11.1.1.1.cmml" xref="S4.F1.35.11.m11.1.1">superscript</csymbol><apply id="S4.F1.35.11.m11.1.1.2.cmml" xref="S4.F1.35.11.m11.1.1.2"><ci id="S4.F1.35.11.m11.1.1.2.1.cmml" xref="S4.F1.35.11.m11.1.1.2.1">^</ci><ci id="S4.F1.35.11.m11.1.1.2.2.cmml" xref="S4.F1.35.11.m11.1.1.2.2">𝑧</ci></apply><cn id="S4.F1.35.11.m11.1.1.3.cmml" type="integer" xref="S4.F1.35.11.m11.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.35.11.m11.1d">\hat{z}^{0}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.35.11.m11.1e">over^ start_ARG italic_z end_ARG start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> obtained from the dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.F1.36.12.m12.1"><semantics id="S4.F1.36.12.m12.1b"><mi class="ltx_font_mathcaligraphic" id="S4.F1.36.12.m12.1.1" xref="S4.F1.36.12.m12.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.F1.36.12.m12.1c"><ci id="S4.F1.36.12.m12.1.1.cmml" xref="S4.F1.36.12.m12.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.36.12.m12.1d">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.36.12.m12.1e">caligraphic_D</annotation></semantics></math> is employed by <math alttext="\xi_{k}(.)" class="ltx_math_unparsed" display="inline" id="S4.F1.37.13.m13.1"><semantics id="S4.F1.37.13.m13.1b"><mrow id="S4.F1.37.13.m13.1c"><msub id="S4.F1.37.13.m13.1.1"><mi id="S4.F1.37.13.m13.1.1.2">ξ</mi><mi id="S4.F1.37.13.m13.1.1.3">k</mi></msub><mrow id="S4.F1.37.13.m13.1.2"><mo id="S4.F1.37.13.m13.1.2.1" stretchy="false">(</mo><mo id="S4.F1.37.13.m13.1.2.2" lspace="0em" rspace="0.167em">.</mo><mo id="S4.F1.37.13.m13.1.2.3" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.F1.37.13.m13.1d">\xi_{k}(.)</annotation><annotation encoding="application/x-llamapun" id="S4.F1.37.13.m13.1e">italic_ξ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( . )</annotation></semantics></math> to retrieve <math alttext="\mathcal{M}_{\mathcal{D}}^{(k)}" class="ltx_Math" display="inline" id="S4.F1.38.14.m14.1"><semantics id="S4.F1.38.14.m14.1b"><msubsup id="S4.F1.38.14.m14.1.2" xref="S4.F1.38.14.m14.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F1.38.14.m14.1.2.2.2" xref="S4.F1.38.14.m14.1.2.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S4.F1.38.14.m14.1.2.2.3" xref="S4.F1.38.14.m14.1.2.2.3.cmml">𝒟</mi><mrow id="S4.F1.38.14.m14.1.1.1.3" xref="S4.F1.38.14.m14.1.2.cmml"><mo id="S4.F1.38.14.m14.1.1.1.3.1" stretchy="false" xref="S4.F1.38.14.m14.1.2.cmml">(</mo><mi id="S4.F1.38.14.m14.1.1.1.1" xref="S4.F1.38.14.m14.1.1.1.1.cmml">k</mi><mo id="S4.F1.38.14.m14.1.1.1.3.2" stretchy="false" xref="S4.F1.38.14.m14.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.F1.38.14.m14.1c"><apply id="S4.F1.38.14.m14.1.2.cmml" xref="S4.F1.38.14.m14.1.2"><csymbol cd="ambiguous" id="S4.F1.38.14.m14.1.2.1.cmml" xref="S4.F1.38.14.m14.1.2">superscript</csymbol><apply id="S4.F1.38.14.m14.1.2.2.cmml" xref="S4.F1.38.14.m14.1.2"><csymbol cd="ambiguous" id="S4.F1.38.14.m14.1.2.2.1.cmml" xref="S4.F1.38.14.m14.1.2">subscript</csymbol><ci id="S4.F1.38.14.m14.1.2.2.2.cmml" xref="S4.F1.38.14.m14.1.2.2.2">ℳ</ci><ci id="S4.F1.38.14.m14.1.2.2.3.cmml" xref="S4.F1.38.14.m14.1.2.2.3">𝒟</ci></apply><ci id="S4.F1.38.14.m14.1.1.1.1.cmml" xref="S4.F1.38.14.m14.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.38.14.m14.1d">\mathcal{M}_{\mathcal{D}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.38.14.m14.1e">caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math>. (e) From the retrieved set <math alttext="\mathcal{M}_{\mathcal{D}}^{(k)}" class="ltx_Math" display="inline" id="S4.F1.39.15.m15.1"><semantics id="S4.F1.39.15.m15.1b"><msubsup id="S4.F1.39.15.m15.1.2" xref="S4.F1.39.15.m15.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F1.39.15.m15.1.2.2.2" xref="S4.F1.39.15.m15.1.2.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S4.F1.39.15.m15.1.2.2.3" xref="S4.F1.39.15.m15.1.2.2.3.cmml">𝒟</mi><mrow id="S4.F1.39.15.m15.1.1.1.3" xref="S4.F1.39.15.m15.1.2.cmml"><mo id="S4.F1.39.15.m15.1.1.1.3.1" stretchy="false" xref="S4.F1.39.15.m15.1.2.cmml">(</mo><mi id="S4.F1.39.15.m15.1.1.1.1" xref="S4.F1.39.15.m15.1.1.1.1.cmml">k</mi><mo id="S4.F1.39.15.m15.1.1.1.3.2" stretchy="false" xref="S4.F1.39.15.m15.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.F1.39.15.m15.1c"><apply id="S4.F1.39.15.m15.1.2.cmml" xref="S4.F1.39.15.m15.1.2"><csymbol cd="ambiguous" id="S4.F1.39.15.m15.1.2.1.cmml" xref="S4.F1.39.15.m15.1.2">superscript</csymbol><apply id="S4.F1.39.15.m15.1.2.2.cmml" xref="S4.F1.39.15.m15.1.2"><csymbol cd="ambiguous" id="S4.F1.39.15.m15.1.2.2.1.cmml" xref="S4.F1.39.15.m15.1.2">subscript</csymbol><ci id="S4.F1.39.15.m15.1.2.2.2.cmml" xref="S4.F1.39.15.m15.1.2.2.2">ℳ</ci><ci id="S4.F1.39.15.m15.1.2.2.3.cmml" xref="S4.F1.39.15.m15.1.2.2.3">𝒟</ci></apply><ci id="S4.F1.39.15.m15.1.1.1.1.cmml" xref="S4.F1.39.15.m15.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.39.15.m15.1d">\mathcal{M}_{\mathcal{D}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.39.15.m15.1e">caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math>, each subset <math alttext="\mathcal{M}_{\mathcal{D}_{i}}^{(k)}" class="ltx_Math" display="inline" id="S4.F1.40.16.m16.1"><semantics id="S4.F1.40.16.m16.1b"><msubsup id="S4.F1.40.16.m16.1.2" xref="S4.F1.40.16.m16.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F1.40.16.m16.1.2.2.2" xref="S4.F1.40.16.m16.1.2.2.2.cmml">ℳ</mi><msub id="S4.F1.40.16.m16.1.2.2.3" xref="S4.F1.40.16.m16.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.F1.40.16.m16.1.2.2.3.2" xref="S4.F1.40.16.m16.1.2.2.3.2.cmml">𝒟</mi><mi id="S4.F1.40.16.m16.1.2.2.3.3" xref="S4.F1.40.16.m16.1.2.2.3.3.cmml">i</mi></msub><mrow id="S4.F1.40.16.m16.1.1.1.3" xref="S4.F1.40.16.m16.1.2.cmml"><mo id="S4.F1.40.16.m16.1.1.1.3.1" stretchy="false" xref="S4.F1.40.16.m16.1.2.cmml">(</mo><mi id="S4.F1.40.16.m16.1.1.1.1" xref="S4.F1.40.16.m16.1.1.1.1.cmml">k</mi><mo id="S4.F1.40.16.m16.1.1.1.3.2" stretchy="false" xref="S4.F1.40.16.m16.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.F1.40.16.m16.1c"><apply id="S4.F1.40.16.m16.1.2.cmml" xref="S4.F1.40.16.m16.1.2"><csymbol cd="ambiguous" id="S4.F1.40.16.m16.1.2.1.cmml" xref="S4.F1.40.16.m16.1.2">superscript</csymbol><apply id="S4.F1.40.16.m16.1.2.2.cmml" xref="S4.F1.40.16.m16.1.2"><csymbol cd="ambiguous" id="S4.F1.40.16.m16.1.2.2.1.cmml" xref="S4.F1.40.16.m16.1.2">subscript</csymbol><ci id="S4.F1.40.16.m16.1.2.2.2.cmml" xref="S4.F1.40.16.m16.1.2.2.2">ℳ</ci><apply id="S4.F1.40.16.m16.1.2.2.3.cmml" xref="S4.F1.40.16.m16.1.2.2.3"><csymbol cd="ambiguous" id="S4.F1.40.16.m16.1.2.2.3.1.cmml" xref="S4.F1.40.16.m16.1.2.2.3">subscript</csymbol><ci id="S4.F1.40.16.m16.1.2.2.3.2.cmml" xref="S4.F1.40.16.m16.1.2.2.3.2">𝒟</ci><ci id="S4.F1.40.16.m16.1.2.2.3.3.cmml" xref="S4.F1.40.16.m16.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.F1.40.16.m16.1.1.1.1.cmml" xref="S4.F1.40.16.m16.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.40.16.m16.1d">\mathcal{M}_{\mathcal{D}_{i}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.40.16.m16.1e">caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> is used as a conditioning signal for the random noise <math alttext="z^{i}_{t}" class="ltx_Math" display="inline" id="S4.F1.41.17.m17.1"><semantics id="S4.F1.41.17.m17.1b"><msubsup id="S4.F1.41.17.m17.1.1" xref="S4.F1.41.17.m17.1.1.cmml"><mi id="S4.F1.41.17.m17.1.1.2.2" xref="S4.F1.41.17.m17.1.1.2.2.cmml">z</mi><mi id="S4.F1.41.17.m17.1.1.3" xref="S4.F1.41.17.m17.1.1.3.cmml">t</mi><mi id="S4.F1.41.17.m17.1.1.2.3" xref="S4.F1.41.17.m17.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.F1.41.17.m17.1c"><apply id="S4.F1.41.17.m17.1.1.cmml" xref="S4.F1.41.17.m17.1.1"><csymbol cd="ambiguous" id="S4.F1.41.17.m17.1.1.1.cmml" xref="S4.F1.41.17.m17.1.1">subscript</csymbol><apply id="S4.F1.41.17.m17.1.1.2.cmml" xref="S4.F1.41.17.m17.1.1"><csymbol cd="ambiguous" id="S4.F1.41.17.m17.1.1.2.1.cmml" xref="S4.F1.41.17.m17.1.1">superscript</csymbol><ci id="S4.F1.41.17.m17.1.1.2.2.cmml" xref="S4.F1.41.17.m17.1.1.2.2">𝑧</ci><ci id="S4.F1.41.17.m17.1.1.2.3.cmml" xref="S4.F1.41.17.m17.1.1.2.3">𝑖</ci></apply><ci id="S4.F1.41.17.m17.1.1.3.cmml" xref="S4.F1.41.17.m17.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.41.17.m17.1d">z^{i}_{t}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.41.17.m17.1e">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at steps <math alttext="t=T,T-1,\ldots,3,2,1" class="ltx_Math" display="inline" id="S4.F1.42.18.m18.6"><semantics id="S4.F1.42.18.m18.6b"><mrow id="S4.F1.42.18.m18.6.6" xref="S4.F1.42.18.m18.6.6.cmml"><mi id="S4.F1.42.18.m18.6.6.3" xref="S4.F1.42.18.m18.6.6.3.cmml">t</mi><mo id="S4.F1.42.18.m18.6.6.2" xref="S4.F1.42.18.m18.6.6.2.cmml">=</mo><mrow id="S4.F1.42.18.m18.6.6.1.1" xref="S4.F1.42.18.m18.6.6.1.2.cmml"><mi id="S4.F1.42.18.m18.1.1" xref="S4.F1.42.18.m18.1.1.cmml">T</mi><mo id="S4.F1.42.18.m18.6.6.1.1.2" xref="S4.F1.42.18.m18.6.6.1.2.cmml">,</mo><mrow id="S4.F1.42.18.m18.6.6.1.1.1" xref="S4.F1.42.18.m18.6.6.1.1.1.cmml"><mi id="S4.F1.42.18.m18.6.6.1.1.1.2" xref="S4.F1.42.18.m18.6.6.1.1.1.2.cmml">T</mi><mo id="S4.F1.42.18.m18.6.6.1.1.1.1" xref="S4.F1.42.18.m18.6.6.1.1.1.1.cmml">−</mo><mn id="S4.F1.42.18.m18.6.6.1.1.1.3" xref="S4.F1.42.18.m18.6.6.1.1.1.3.cmml">1</mn></mrow><mo id="S4.F1.42.18.m18.6.6.1.1.3" xref="S4.F1.42.18.m18.6.6.1.2.cmml">,</mo><mi id="S4.F1.42.18.m18.2.2" mathvariant="normal" xref="S4.F1.42.18.m18.2.2.cmml">…</mi><mo id="S4.F1.42.18.m18.6.6.1.1.4" xref="S4.F1.42.18.m18.6.6.1.2.cmml">,</mo><mn id="S4.F1.42.18.m18.3.3" xref="S4.F1.42.18.m18.3.3.cmml">3</mn><mo id="S4.F1.42.18.m18.6.6.1.1.5" xref="S4.F1.42.18.m18.6.6.1.2.cmml">,</mo><mn id="S4.F1.42.18.m18.4.4" xref="S4.F1.42.18.m18.4.4.cmml">2</mn><mo id="S4.F1.42.18.m18.6.6.1.1.6" xref="S4.F1.42.18.m18.6.6.1.2.cmml">,</mo><mn id="S4.F1.42.18.m18.5.5" xref="S4.F1.42.18.m18.5.5.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F1.42.18.m18.6c"><apply id="S4.F1.42.18.m18.6.6.cmml" xref="S4.F1.42.18.m18.6.6"><eq id="S4.F1.42.18.m18.6.6.2.cmml" xref="S4.F1.42.18.m18.6.6.2"></eq><ci id="S4.F1.42.18.m18.6.6.3.cmml" xref="S4.F1.42.18.m18.6.6.3">𝑡</ci><list id="S4.F1.42.18.m18.6.6.1.2.cmml" xref="S4.F1.42.18.m18.6.6.1.1"><ci id="S4.F1.42.18.m18.1.1.cmml" xref="S4.F1.42.18.m18.1.1">𝑇</ci><apply id="S4.F1.42.18.m18.6.6.1.1.1.cmml" xref="S4.F1.42.18.m18.6.6.1.1.1"><minus id="S4.F1.42.18.m18.6.6.1.1.1.1.cmml" xref="S4.F1.42.18.m18.6.6.1.1.1.1"></minus><ci id="S4.F1.42.18.m18.6.6.1.1.1.2.cmml" xref="S4.F1.42.18.m18.6.6.1.1.1.2">𝑇</ci><cn id="S4.F1.42.18.m18.6.6.1.1.1.3.cmml" type="integer" xref="S4.F1.42.18.m18.6.6.1.1.1.3">1</cn></apply><ci id="S4.F1.42.18.m18.2.2.cmml" xref="S4.F1.42.18.m18.2.2">…</ci><cn id="S4.F1.42.18.m18.3.3.cmml" type="integer" xref="S4.F1.42.18.m18.3.3">3</cn><cn id="S4.F1.42.18.m18.4.4.cmml" type="integer" xref="S4.F1.42.18.m18.4.4">2</cn><cn id="S4.F1.42.18.m18.5.5.cmml" type="integer" xref="S4.F1.42.18.m18.5.5">1</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.42.18.m18.6d">t=T,T-1,\ldots,3,2,1</annotation><annotation encoding="application/x-llamapun" id="S4.F1.42.18.m18.6e">italic_t = italic_T , italic_T - 1 , … , 3 , 2 , 1</annotation></semantics></math> to generate the final denoised block <math alttext="z_{0}^{i}" class="ltx_Math" display="inline" id="S4.F1.43.19.m19.1"><semantics id="S4.F1.43.19.m19.1b"><msubsup id="S4.F1.43.19.m19.1.1" xref="S4.F1.43.19.m19.1.1.cmml"><mi id="S4.F1.43.19.m19.1.1.2.2" xref="S4.F1.43.19.m19.1.1.2.2.cmml">z</mi><mn id="S4.F1.43.19.m19.1.1.2.3" xref="S4.F1.43.19.m19.1.1.2.3.cmml">0</mn><mi id="S4.F1.43.19.m19.1.1.3" xref="S4.F1.43.19.m19.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.F1.43.19.m19.1c"><apply id="S4.F1.43.19.m19.1.1.cmml" xref="S4.F1.43.19.m19.1.1"><csymbol cd="ambiguous" id="S4.F1.43.19.m19.1.1.1.cmml" xref="S4.F1.43.19.m19.1.1">superscript</csymbol><apply id="S4.F1.43.19.m19.1.1.2.cmml" xref="S4.F1.43.19.m19.1.1"><csymbol cd="ambiguous" id="S4.F1.43.19.m19.1.1.2.1.cmml" xref="S4.F1.43.19.m19.1.1">subscript</csymbol><ci id="S4.F1.43.19.m19.1.1.2.2.cmml" xref="S4.F1.43.19.m19.1.1.2.2">𝑧</ci><cn id="S4.F1.43.19.m19.1.1.2.3.cmml" type="integer" xref="S4.F1.43.19.m19.1.1.2.3">0</cn></apply><ci id="S4.F1.43.19.m19.1.1.3.cmml" xref="S4.F1.43.19.m19.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.43.19.m19.1d">z_{0}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.43.19.m19.1e">italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> of <math alttext="\hat{z}^{0}" class="ltx_Math" display="inline" id="S4.F1.44.20.m20.1"><semantics id="S4.F1.44.20.m20.1b"><msup id="S4.F1.44.20.m20.1.1" xref="S4.F1.44.20.m20.1.1.cmml"><mover accent="true" id="S4.F1.44.20.m20.1.1.2" xref="S4.F1.44.20.m20.1.1.2.cmml"><mi id="S4.F1.44.20.m20.1.1.2.2" xref="S4.F1.44.20.m20.1.1.2.2.cmml">z</mi><mo id="S4.F1.44.20.m20.1.1.2.1" xref="S4.F1.44.20.m20.1.1.2.1.cmml">^</mo></mover><mn id="S4.F1.44.20.m20.1.1.3" xref="S4.F1.44.20.m20.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.F1.44.20.m20.1c"><apply id="S4.F1.44.20.m20.1.1.cmml" xref="S4.F1.44.20.m20.1.1"><csymbol cd="ambiguous" id="S4.F1.44.20.m20.1.1.1.cmml" xref="S4.F1.44.20.m20.1.1">superscript</csymbol><apply id="S4.F1.44.20.m20.1.1.2.cmml" xref="S4.F1.44.20.m20.1.1.2"><ci id="S4.F1.44.20.m20.1.1.2.1.cmml" xref="S4.F1.44.20.m20.1.1.2.1">^</ci><ci id="S4.F1.44.20.m20.1.1.2.2.cmml" xref="S4.F1.44.20.m20.1.1.2.2">𝑧</ci></apply><cn id="S4.F1.44.20.m20.1.1.3.cmml" type="integer" xref="S4.F1.44.20.m20.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.44.20.m20.1d">\hat{z}^{0}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.44.20.m20.1e">over^ start_ARG italic_z end_ARG start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math>. (f) All denoised representations <math alttext="z_{0}^{i}" class="ltx_Math" display="inline" id="S4.F1.45.21.m21.1"><semantics id="S4.F1.45.21.m21.1b"><msubsup id="S4.F1.45.21.m21.1.1" xref="S4.F1.45.21.m21.1.1.cmml"><mi id="S4.F1.45.21.m21.1.1.2.2" xref="S4.F1.45.21.m21.1.1.2.2.cmml">z</mi><mn id="S4.F1.45.21.m21.1.1.2.3" xref="S4.F1.45.21.m21.1.1.2.3.cmml">0</mn><mi id="S4.F1.45.21.m21.1.1.3" xref="S4.F1.45.21.m21.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.F1.45.21.m21.1c"><apply id="S4.F1.45.21.m21.1.1.cmml" xref="S4.F1.45.21.m21.1.1"><csymbol cd="ambiguous" id="S4.F1.45.21.m21.1.1.1.cmml" xref="S4.F1.45.21.m21.1.1">superscript</csymbol><apply id="S4.F1.45.21.m21.1.1.2.cmml" xref="S4.F1.45.21.m21.1.1"><csymbol cd="ambiguous" id="S4.F1.45.21.m21.1.1.2.1.cmml" xref="S4.F1.45.21.m21.1.1">subscript</csymbol><ci id="S4.F1.45.21.m21.1.1.2.2.cmml" xref="S4.F1.45.21.m21.1.1.2.2">𝑧</ci><cn id="S4.F1.45.21.m21.1.1.2.3.cmml" type="integer" xref="S4.F1.45.21.m21.1.1.2.3">0</cn></apply><ci id="S4.F1.45.21.m21.1.1.3.cmml" xref="S4.F1.45.21.m21.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.45.21.m21.1d">z_{0}^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.45.21.m21.1e">italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> are reshaped to construct <math alttext="z_{0}" class="ltx_Math" display="inline" id="S4.F1.46.22.m22.1"><semantics id="S4.F1.46.22.m22.1b"><msub id="S4.F1.46.22.m22.1.1" xref="S4.F1.46.22.m22.1.1.cmml"><mi id="S4.F1.46.22.m22.1.1.2" xref="S4.F1.46.22.m22.1.1.2.cmml">z</mi><mn id="S4.F1.46.22.m22.1.1.3" xref="S4.F1.46.22.m22.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.F1.46.22.m22.1c"><apply id="S4.F1.46.22.m22.1.1.cmml" xref="S4.F1.46.22.m22.1.1"><csymbol cd="ambiguous" id="S4.F1.46.22.m22.1.1.1.cmml" xref="S4.F1.46.22.m22.1.1">subscript</csymbol><ci id="S4.F1.46.22.m22.1.1.2.cmml" xref="S4.F1.46.22.m22.1.1.2">𝑧</ci><cn id="S4.F1.46.22.m22.1.1.3.cmml" type="integer" xref="S4.F1.46.22.m22.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.46.22.m22.1d">z_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.46.22.m22.1e">italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>, which is then passed through the decoder <math alttext="D_{\phi}" class="ltx_Math" display="inline" id="S4.F1.47.23.m23.1"><semantics id="S4.F1.47.23.m23.1b"><msub id="S4.F1.47.23.m23.1.1" xref="S4.F1.47.23.m23.1.1.cmml"><mi id="S4.F1.47.23.m23.1.1.2" xref="S4.F1.47.23.m23.1.1.2.cmml">D</mi><mi id="S4.F1.47.23.m23.1.1.3" xref="S4.F1.47.23.m23.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F1.47.23.m23.1c"><apply id="S4.F1.47.23.m23.1.1.cmml" xref="S4.F1.47.23.m23.1.1"><csymbol cd="ambiguous" id="S4.F1.47.23.m23.1.1.1.cmml" xref="S4.F1.47.23.m23.1.1">subscript</csymbol><ci id="S4.F1.47.23.m23.1.1.2.cmml" xref="S4.F1.47.23.m23.1.1.2">𝐷</ci><ci id="S4.F1.47.23.m23.1.1.3.cmml" xref="S4.F1.47.23.m23.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.47.23.m23.1d">D_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.47.23.m23.1e">italic_D start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> to yield the reconstructed sample <math alttext="x^{\prime}" class="ltx_Math" display="inline" id="S4.F1.48.24.m24.1"><semantics id="S4.F1.48.24.m24.1b"><msup id="S4.F1.48.24.m24.1.1" xref="S4.F1.48.24.m24.1.1.cmml"><mi id="S4.F1.48.24.m24.1.1.2" xref="S4.F1.48.24.m24.1.1.2.cmml">x</mi><mo id="S4.F1.48.24.m24.1.1.3" xref="S4.F1.48.24.m24.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.F1.48.24.m24.1c"><apply id="S4.F1.48.24.m24.1.1.cmml" xref="S4.F1.48.24.m24.1.1"><csymbol cd="ambiguous" id="S4.F1.48.24.m24.1.1.1.cmml" xref="S4.F1.48.24.m24.1.1">superscript</csymbol><ci id="S4.F1.48.24.m24.1.1.2.cmml" xref="S4.F1.48.24.m24.1.1.2">𝑥</ci><ci id="S4.F1.48.24.m24.1.1.3.cmml" xref="S4.F1.48.24.m24.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.48.24.m24.1d">x^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.48.24.m24.1e">italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.</span></figcaption>
</figure>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>VQ-GAN Training</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.17">As the first stage of RISSOLE training, we train a VQ-GAN on the original training images to obtain their latent representations using a trainable encoder-decoder setup. For an image <math alttext="x\in\mathcal{X}\subset\mathbb{R}^{h\times w\times c}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.1.m1.1"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mrow id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml">x</mi><mo id="S4.SS1.SSS1.p1.1.m1.1.1.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS1.p1.1.m1.1.1.4" xref="S4.SS1.SSS1.p1.1.m1.1.1.4.cmml">𝒳</mi><mo id="S4.SS1.SSS1.p1.1.m1.1.1.5" xref="S4.SS1.SSS1.p1.1.m1.1.1.5.cmml">⊂</mo><msup id="S4.SS1.SSS1.p1.1.m1.1.1.6" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.6.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS1.p1.1.m1.1.1.6.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3.cmml"><mi id="S4.SS1.SSS1.p1.1.m1.1.1.6.3.2" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3.2.cmml">h</mi><mo id="S4.SS1.SSS1.p1.1.m1.1.1.6.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.1.m1.1.1.6.3.3" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3.3.cmml">w</mi><mo id="S4.SS1.SSS1.p1.1.m1.1.1.6.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.1.m1.1.1.6.3.4" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3.4.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><apply id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><and id="S4.SS1.SSS1.p1.1.m1.1.1a.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"></and><apply id="S4.SS1.SSS1.p1.1.m1.1.1b.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><in id="S4.SS1.SSS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.3"></in><ci id="S4.SS1.SSS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.2">𝑥</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.1.4.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.4">𝒳</ci></apply><apply id="S4.SS1.SSS1.p1.1.m1.1.1c.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"><subset id="S4.SS1.SSS1.p1.1.m1.1.1.5.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.5"></subset><share href="https://arxiv.org/html/2408.17095v2#S4.SS1.SSS1.p1.1.m1.1.1.4.cmml" id="S4.SS1.SSS1.p1.1.m1.1.1d.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1"></share><apply id="S4.SS1.SSS1.p1.1.m1.1.1.6.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.6"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.1.m1.1.1.6.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.6">superscript</csymbol><ci id="S4.SS1.SSS1.p1.1.m1.1.1.6.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.2">ℝ</ci><apply id="S4.SS1.SSS1.p1.1.m1.1.1.6.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3"><times id="S4.SS1.SSS1.p1.1.m1.1.1.6.3.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3.1"></times><ci id="S4.SS1.SSS1.p1.1.m1.1.1.6.3.2.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3.2">ℎ</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.1.6.3.3.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3.3">𝑤</ci><ci id="S4.SS1.SSS1.p1.1.m1.1.1.6.3.4.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1.6.3.4">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">x\in\mathcal{X}\subset\mathbb{R}^{h\times w\times c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.1.m1.1d">italic_x ∈ caligraphic_X ⊂ blackboard_R start_POSTSUPERSCRIPT italic_h × italic_w × italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>, we introduce an encoder <math alttext="E_{\theta}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.2.m2.1"><semantics id="S4.SS1.SSS1.p1.2.m2.1a"><msub id="S4.SS1.SSS1.p1.2.m2.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS1.p1.2.m2.1.1.2" xref="S4.SS1.SSS1.p1.2.m2.1.1.2.cmml">E</mi><mi id="S4.SS1.SSS1.p1.2.m2.1.1.3" xref="S4.SS1.SSS1.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.1b"><apply id="S4.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.2">𝐸</ci><ci id="S4.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.1c">E_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.2.m2.1d">italic_E start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="E_{\theta}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.3.m3.1"><semantics id="S4.SS1.SSS1.p1.3.m3.1a"><msub id="S4.SS1.SSS1.p1.3.m3.1.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS1.p1.3.m3.1.1.2" xref="S4.SS1.SSS1.p1.3.m3.1.1.2.cmml">E</mi><mi id="S4.SS1.SSS1.p1.3.m3.1.1.3" xref="S4.SS1.SSS1.p1.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.3.m3.1b"><apply id="S4.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.2">𝐸</ci><ci id="S4.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.3.m3.1c">E_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.3.m3.1d">italic_E start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> takes <math alttext="x" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.4.m4.1"><semantics id="S4.SS1.SSS1.p1.4.m4.1a"><mi id="S4.SS1.SSS1.p1.4.m4.1.1" xref="S4.SS1.SSS1.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.4.m4.1b"><ci id="S4.SS1.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.4.m4.1d">italic_x</annotation></semantics></math> as input and produces a hidden representation <math alttext="z\in\mathbb{R}^{h^{\prime}\times w^{\prime}\times c^{\prime}}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.5.m5.1"><semantics id="S4.SS1.SSS1.p1.5.m5.1a"><mrow id="S4.SS1.SSS1.p1.5.m5.1.1" xref="S4.SS1.SSS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS1.p1.5.m5.1.1.2" xref="S4.SS1.SSS1.p1.5.m5.1.1.2.cmml">z</mi><mo id="S4.SS1.SSS1.p1.5.m5.1.1.1" xref="S4.SS1.SSS1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS1.SSS1.p1.5.m5.1.1.3" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.5.m5.1.1.3.2" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS1.p1.5.m5.1.1.3.3" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.cmml"><msup id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.cmml"><mi id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.2" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.2.cmml">h</mi><mo id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.3" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.3.cmml">′</mo></msup><mo id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.1.cmml">×</mo><msup id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.cmml"><mi id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.2" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.2.cmml">w</mi><mo id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.3" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.3.cmml">′</mo></msup><mo id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.1.cmml">×</mo><msup id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.cmml"><mi id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.2" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.2.cmml">c</mi><mo id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.3" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.3.cmml">′</mo></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.5.m5.1b"><apply id="S4.SS1.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1"><in id="S4.SS1.SSS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.1"></in><ci id="S4.SS1.SSS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.2">𝑧</ci><apply id="S4.SS1.SSS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3"><times id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.1"></times><apply id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2">superscript</csymbol><ci id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.2">ℎ</ci><ci id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.2.3">′</ci></apply><apply id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3">superscript</csymbol><ci id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.2">𝑤</ci><ci id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.3.3">′</ci></apply><apply id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.1.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4">superscript</csymbol><ci id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.2.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.2">𝑐</ci><ci id="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.3.cmml" xref="S4.SS1.SSS1.p1.5.m5.1.1.3.3.4.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.5.m5.1c">z\in\mathbb{R}^{h^{\prime}\times w^{\prime}\times c^{\prime}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.5.m5.1d">italic_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT × italic_w start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT × italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. Here, <math alttext="h,w,c" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.6.m6.3"><semantics id="S4.SS1.SSS1.p1.6.m6.3a"><mrow id="S4.SS1.SSS1.p1.6.m6.3.4.2" xref="S4.SS1.SSS1.p1.6.m6.3.4.1.cmml"><mi id="S4.SS1.SSS1.p1.6.m6.1.1" xref="S4.SS1.SSS1.p1.6.m6.1.1.cmml">h</mi><mo id="S4.SS1.SSS1.p1.6.m6.3.4.2.1" xref="S4.SS1.SSS1.p1.6.m6.3.4.1.cmml">,</mo><mi id="S4.SS1.SSS1.p1.6.m6.2.2" xref="S4.SS1.SSS1.p1.6.m6.2.2.cmml">w</mi><mo id="S4.SS1.SSS1.p1.6.m6.3.4.2.2" xref="S4.SS1.SSS1.p1.6.m6.3.4.1.cmml">,</mo><mi id="S4.SS1.SSS1.p1.6.m6.3.3" xref="S4.SS1.SSS1.p1.6.m6.3.3.cmml">c</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.6.m6.3b"><list id="S4.SS1.SSS1.p1.6.m6.3.4.1.cmml" xref="S4.SS1.SSS1.p1.6.m6.3.4.2"><ci id="S4.SS1.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS1.p1.6.m6.1.1">ℎ</ci><ci id="S4.SS1.SSS1.p1.6.m6.2.2.cmml" xref="S4.SS1.SSS1.p1.6.m6.2.2">𝑤</ci><ci id="S4.SS1.SSS1.p1.6.m6.3.3.cmml" xref="S4.SS1.SSS1.p1.6.m6.3.3">𝑐</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.6.m6.3c">h,w,c</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.6.m6.3d">italic_h , italic_w , italic_c</annotation></semantics></math> represents the dimensions of the input image, <math alttext="h^{\prime},w^{\prime},c^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.7.m7.3"><semantics id="S4.SS1.SSS1.p1.7.m7.3a"><mrow id="S4.SS1.SSS1.p1.7.m7.3.3.3" xref="S4.SS1.SSS1.p1.7.m7.3.3.4.cmml"><msup id="S4.SS1.SSS1.p1.7.m7.1.1.1.1" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.cmml"><mi id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.2" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.2.cmml">h</mi><mo id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.3" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.3.cmml">′</mo></msup><mo id="S4.SS1.SSS1.p1.7.m7.3.3.3.4" xref="S4.SS1.SSS1.p1.7.m7.3.3.4.cmml">,</mo><msup id="S4.SS1.SSS1.p1.7.m7.2.2.2.2" xref="S4.SS1.SSS1.p1.7.m7.2.2.2.2.cmml"><mi id="S4.SS1.SSS1.p1.7.m7.2.2.2.2.2" xref="S4.SS1.SSS1.p1.7.m7.2.2.2.2.2.cmml">w</mi><mo id="S4.SS1.SSS1.p1.7.m7.2.2.2.2.3" xref="S4.SS1.SSS1.p1.7.m7.2.2.2.2.3.cmml">′</mo></msup><mo id="S4.SS1.SSS1.p1.7.m7.3.3.3.5" xref="S4.SS1.SSS1.p1.7.m7.3.3.4.cmml">,</mo><msup id="S4.SS1.SSS1.p1.7.m7.3.3.3.3" xref="S4.SS1.SSS1.p1.7.m7.3.3.3.3.cmml"><mi id="S4.SS1.SSS1.p1.7.m7.3.3.3.3.2" xref="S4.SS1.SSS1.p1.7.m7.3.3.3.3.2.cmml">c</mi><mo id="S4.SS1.SSS1.p1.7.m7.3.3.3.3.3" xref="S4.SS1.SSS1.p1.7.m7.3.3.3.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.7.m7.3b"><list id="S4.SS1.SSS1.p1.7.m7.3.3.4.cmml" xref="S4.SS1.SSS1.p1.7.m7.3.3.3"><apply id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.2">ℎ</ci><ci id="S4.SS1.SSS1.p1.7.m7.1.1.1.1.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.1.1.1.1.3">′</ci></apply><apply id="S4.SS1.SSS1.p1.7.m7.2.2.2.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.2.2.2.2.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.2.2">superscript</csymbol><ci id="S4.SS1.SSS1.p1.7.m7.2.2.2.2.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.2.2.2">𝑤</ci><ci id="S4.SS1.SSS1.p1.7.m7.2.2.2.2.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.2.2.2.2.3">′</ci></apply><apply id="S4.SS1.SSS1.p1.7.m7.3.3.3.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.7.m7.3.3.3.3.1.cmml" xref="S4.SS1.SSS1.p1.7.m7.3.3.3.3">superscript</csymbol><ci id="S4.SS1.SSS1.p1.7.m7.3.3.3.3.2.cmml" xref="S4.SS1.SSS1.p1.7.m7.3.3.3.3.2">𝑐</ci><ci id="S4.SS1.SSS1.p1.7.m7.3.3.3.3.3.cmml" xref="S4.SS1.SSS1.p1.7.m7.3.3.3.3.3">′</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.7.m7.3c">h^{\prime},w^{\prime},c^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.7.m7.3d">italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_w start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_c start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> represents the dimensions of the hidden representation, and <math alttext="\theta" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.8.m8.1"><semantics id="S4.SS1.SSS1.p1.8.m8.1a"><mi id="S4.SS1.SSS1.p1.8.m8.1.1" xref="S4.SS1.SSS1.p1.8.m8.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.8.m8.1b"><ci id="S4.SS1.SSS1.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS1.p1.8.m8.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.8.m8.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.8.m8.1d">italic_θ</annotation></semantics></math> represents the parameters of the encoder <math alttext="E" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.9.m9.1"><semantics id="S4.SS1.SSS1.p1.9.m9.1a"><mi id="S4.SS1.SSS1.p1.9.m9.1.1" xref="S4.SS1.SSS1.p1.9.m9.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.9.m9.1b"><ci id="S4.SS1.SSS1.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS1.p1.9.m9.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.9.m9.1c">E</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.9.m9.1d">italic_E</annotation></semantics></math> s.t. <math alttext="z=E_{\theta}(x)" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.10.m10.1"><semantics id="S4.SS1.SSS1.p1.10.m10.1a"><mrow id="S4.SS1.SSS1.p1.10.m10.1.2" xref="S4.SS1.SSS1.p1.10.m10.1.2.cmml"><mi id="S4.SS1.SSS1.p1.10.m10.1.2.2" xref="S4.SS1.SSS1.p1.10.m10.1.2.2.cmml">z</mi><mo id="S4.SS1.SSS1.p1.10.m10.1.2.1" xref="S4.SS1.SSS1.p1.10.m10.1.2.1.cmml">=</mo><mrow id="S4.SS1.SSS1.p1.10.m10.1.2.3" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.cmml"><msub id="S4.SS1.SSS1.p1.10.m10.1.2.3.2" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.2.cmml"><mi id="S4.SS1.SSS1.p1.10.m10.1.2.3.2.2" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.2.2.cmml">E</mi><mi id="S4.SS1.SSS1.p1.10.m10.1.2.3.2.3" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.2.3.cmml">θ</mi></msub><mo id="S4.SS1.SSS1.p1.10.m10.1.2.3.1" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS1.p1.10.m10.1.2.3.3.2" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.cmml"><mo id="S4.SS1.SSS1.p1.10.m10.1.2.3.3.2.1" stretchy="false" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.cmml">(</mo><mi id="S4.SS1.SSS1.p1.10.m10.1.1" xref="S4.SS1.SSS1.p1.10.m10.1.1.cmml">x</mi><mo id="S4.SS1.SSS1.p1.10.m10.1.2.3.3.2.2" stretchy="false" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.10.m10.1b"><apply id="S4.SS1.SSS1.p1.10.m10.1.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.2"><eq id="S4.SS1.SSS1.p1.10.m10.1.2.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.2.1"></eq><ci id="S4.SS1.SSS1.p1.10.m10.1.2.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.2.2">𝑧</ci><apply id="S4.SS1.SSS1.p1.10.m10.1.2.3.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.2.3"><times id="S4.SS1.SSS1.p1.10.m10.1.2.3.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.1"></times><apply id="S4.SS1.SSS1.p1.10.m10.1.2.3.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.10.m10.1.2.3.2.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS1.p1.10.m10.1.2.3.2.2.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.2.2">𝐸</ci><ci id="S4.SS1.SSS1.p1.10.m10.1.2.3.2.3.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.2.3.2.3">𝜃</ci></apply><ci id="S4.SS1.SSS1.p1.10.m10.1.1.cmml" xref="S4.SS1.SSS1.p1.10.m10.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.10.m10.1c">z=E_{\theta}(x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.10.m10.1d">italic_z = italic_E start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math>. Similar to LDM) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx14" title="">Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer</a>]</cite>, and to be amenable to our subsequent block division approach, we maintain <math alttext="z" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.11.m11.1"><semantics id="S4.SS1.SSS1.p1.11.m11.1a"><mi id="S4.SS1.SSS1.p1.11.m11.1.1" xref="S4.SS1.SSS1.p1.11.m11.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.11.m11.1b"><ci id="S4.SS1.SSS1.p1.11.m11.1.1.cmml" xref="S4.SS1.SSS1.p1.11.m11.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.11.m11.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.11.m11.1d">italic_z</annotation></semantics></math> in a two-dimensional layout, departing from the arbitrary one-dimensional arrangement used in the works of <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx8" title="">Esser et al.(2021)Esser, Rombach, and Ommer</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx13" title="">Ramesh et al.(2021)Ramesh, Pavlov, Goh, Gray, Voss, Radford, Chen, and
Sutskever</a>]</cite>. This reduces the image space by a factor of <math alttext="f=w/w^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.12.m12.1"><semantics id="S4.SS1.SSS1.p1.12.m12.1a"><mrow id="S4.SS1.SSS1.p1.12.m12.1.1" xref="S4.SS1.SSS1.p1.12.m12.1.1.cmml"><mi id="S4.SS1.SSS1.p1.12.m12.1.1.2" xref="S4.SS1.SSS1.p1.12.m12.1.1.2.cmml">f</mi><mo id="S4.SS1.SSS1.p1.12.m12.1.1.1" xref="S4.SS1.SSS1.p1.12.m12.1.1.1.cmml">=</mo><mrow id="S4.SS1.SSS1.p1.12.m12.1.1.3" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.12.m12.1.1.3.2" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.2.cmml">w</mi><mo id="S4.SS1.SSS1.p1.12.m12.1.1.3.1" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.1.cmml">/</mo><msup id="S4.SS1.SSS1.p1.12.m12.1.1.3.3" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.3.cmml"><mi id="S4.SS1.SSS1.p1.12.m12.1.1.3.3.2" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.3.2.cmml">w</mi><mo id="S4.SS1.SSS1.p1.12.m12.1.1.3.3.3" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.3.3.cmml">′</mo></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.12.m12.1b"><apply id="S4.SS1.SSS1.p1.12.m12.1.1.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1"><eq id="S4.SS1.SSS1.p1.12.m12.1.1.1.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.1"></eq><ci id="S4.SS1.SSS1.p1.12.m12.1.1.2.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.2">𝑓</ci><apply id="S4.SS1.SSS1.p1.12.m12.1.1.3.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.3"><divide id="S4.SS1.SSS1.p1.12.m12.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.1"></divide><ci id="S4.SS1.SSS1.p1.12.m12.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.2">𝑤</ci><apply id="S4.SS1.SSS1.p1.12.m12.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.12.m12.1.1.3.3.1.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.3">superscript</csymbol><ci id="S4.SS1.SSS1.p1.12.m12.1.1.3.3.2.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.3.2">𝑤</ci><ci id="S4.SS1.SSS1.p1.12.m12.1.1.3.3.3.cmml" xref="S4.SS1.SSS1.p1.12.m12.1.1.3.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.12.m12.1c">f=w/w^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.12.m12.1d">italic_f = italic_w / italic_w start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> or <math alttext="h/h^{\prime}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.13.m13.1"><semantics id="S4.SS1.SSS1.p1.13.m13.1a"><mrow id="S4.SS1.SSS1.p1.13.m13.1.1" xref="S4.SS1.SSS1.p1.13.m13.1.1.cmml"><mi id="S4.SS1.SSS1.p1.13.m13.1.1.2" xref="S4.SS1.SSS1.p1.13.m13.1.1.2.cmml">h</mi><mo id="S4.SS1.SSS1.p1.13.m13.1.1.1" xref="S4.SS1.SSS1.p1.13.m13.1.1.1.cmml">/</mo><msup id="S4.SS1.SSS1.p1.13.m13.1.1.3" xref="S4.SS1.SSS1.p1.13.m13.1.1.3.cmml"><mi id="S4.SS1.SSS1.p1.13.m13.1.1.3.2" xref="S4.SS1.SSS1.p1.13.m13.1.1.3.2.cmml">h</mi><mo id="S4.SS1.SSS1.p1.13.m13.1.1.3.3" xref="S4.SS1.SSS1.p1.13.m13.1.1.3.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.13.m13.1b"><apply id="S4.SS1.SSS1.p1.13.m13.1.1.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1"><divide id="S4.SS1.SSS1.p1.13.m13.1.1.1.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1.1"></divide><ci id="S4.SS1.SSS1.p1.13.m13.1.1.2.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1.2">ℎ</ci><apply id="S4.SS1.SSS1.p1.13.m13.1.1.3.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.13.m13.1.1.3.1.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1.3">superscript</csymbol><ci id="S4.SS1.SSS1.p1.13.m13.1.1.3.2.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1.3.2">ℎ</ci><ci id="S4.SS1.SSS1.p1.13.m13.1.1.3.3.cmml" xref="S4.SS1.SSS1.p1.13.m13.1.1.3.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.13.m13.1c">h/h^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.13.m13.1d">italic_h / italic_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>. The factor <math alttext="f" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.14.m14.1"><semantics id="S4.SS1.SSS1.p1.14.m14.1a"><mi id="S4.SS1.SSS1.p1.14.m14.1.1" xref="S4.SS1.SSS1.p1.14.m14.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.14.m14.1b"><ci id="S4.SS1.SSS1.p1.14.m14.1.1.cmml" xref="S4.SS1.SSS1.p1.14.m14.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.14.m14.1c">f</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.14.m14.1d">italic_f</annotation></semantics></math> determines the size of each block into which the hidden representations are divided. A decoder <math alttext="D_{\phi}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.15.m15.1"><semantics id="S4.SS1.SSS1.p1.15.m15.1a"><msub id="S4.SS1.SSS1.p1.15.m15.1.1" xref="S4.SS1.SSS1.p1.15.m15.1.1.cmml"><mi id="S4.SS1.SSS1.p1.15.m15.1.1.2" xref="S4.SS1.SSS1.p1.15.m15.1.1.2.cmml">D</mi><mi id="S4.SS1.SSS1.p1.15.m15.1.1.3" xref="S4.SS1.SSS1.p1.15.m15.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.15.m15.1b"><apply id="S4.SS1.SSS1.p1.15.m15.1.1.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.15.m15.1.1.1.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1">subscript</csymbol><ci id="S4.SS1.SSS1.p1.15.m15.1.1.2.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1.2">𝐷</ci><ci id="S4.SS1.SSS1.p1.15.m15.1.1.3.cmml" xref="S4.SS1.SSS1.p1.15.m15.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.15.m15.1c">D_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.15.m15.1d">italic_D start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math>, parameterized by <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.16.m16.1"><semantics id="S4.SS1.SSS1.p1.16.m16.1a"><mi id="S4.SS1.SSS1.p1.16.m16.1.1" xref="S4.SS1.SSS1.p1.16.m16.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.16.m16.1b"><ci id="S4.SS1.SSS1.p1.16.m16.1.1.cmml" xref="S4.SS1.SSS1.p1.16.m16.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.16.m16.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.16.m16.1d">italic_ϕ</annotation></semantics></math>, reconstructs the original image as <math alttext="\tilde{x}=D_{\phi}(E_{\theta}(x))\in\mathbb{R}^{h\times w\times c}" class="ltx_Math" display="inline" id="S4.SS1.SSS1.p1.17.m17.2"><semantics id="S4.SS1.SSS1.p1.17.m17.2a"><mrow id="S4.SS1.SSS1.p1.17.m17.2.2" xref="S4.SS1.SSS1.p1.17.m17.2.2.cmml"><mover accent="true" id="S4.SS1.SSS1.p1.17.m17.2.2.3" xref="S4.SS1.SSS1.p1.17.m17.2.2.3.cmml"><mi id="S4.SS1.SSS1.p1.17.m17.2.2.3.2" xref="S4.SS1.SSS1.p1.17.m17.2.2.3.2.cmml">x</mi><mo id="S4.SS1.SSS1.p1.17.m17.2.2.3.1" xref="S4.SS1.SSS1.p1.17.m17.2.2.3.1.cmml">~</mo></mover><mo id="S4.SS1.SSS1.p1.17.m17.2.2.4" xref="S4.SS1.SSS1.p1.17.m17.2.2.4.cmml">=</mo><mrow id="S4.SS1.SSS1.p1.17.m17.2.2.1" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.cmml"><msub id="S4.SS1.SSS1.p1.17.m17.2.2.1.3" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.3.cmml"><mi id="S4.SS1.SSS1.p1.17.m17.2.2.1.3.2" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.3.2.cmml">D</mi><mi id="S4.SS1.SSS1.p1.17.m17.2.2.1.3.3" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.3.3.cmml">ϕ</mi></msub><mo id="S4.SS1.SSS1.p1.17.m17.2.2.1.2" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.cmml"><mo id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.2" stretchy="false" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.cmml"><msub id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.cmml"><mi id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.2" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.2.cmml">E</mi><mi id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.3" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.3.cmml">θ</mi></msub><mo id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.1" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.3.2" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.cmml"><mo id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.3.2.1" stretchy="false" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.cmml">(</mo><mi id="S4.SS1.SSS1.p1.17.m17.1.1" xref="S4.SS1.SSS1.p1.17.m17.1.1.cmml">x</mi><mo id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.3.2.2" stretchy="false" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.3" stretchy="false" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS1.p1.17.m17.2.2.5" xref="S4.SS1.SSS1.p1.17.m17.2.2.5.cmml">∈</mo><msup id="S4.SS1.SSS1.p1.17.m17.2.2.6" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.cmml"><mi id="S4.SS1.SSS1.p1.17.m17.2.2.6.2" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.2.cmml">ℝ</mi><mrow id="S4.SS1.SSS1.p1.17.m17.2.2.6.3" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3.cmml"><mi id="S4.SS1.SSS1.p1.17.m17.2.2.6.3.2" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3.2.cmml">h</mi><mo id="S4.SS1.SSS1.p1.17.m17.2.2.6.3.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.17.m17.2.2.6.3.3" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3.3.cmml">w</mi><mo id="S4.SS1.SSS1.p1.17.m17.2.2.6.3.1a" lspace="0.222em" rspace="0.222em" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3.1.cmml">×</mo><mi id="S4.SS1.SSS1.p1.17.m17.2.2.6.3.4" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3.4.cmml">c</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.17.m17.2b"><apply id="S4.SS1.SSS1.p1.17.m17.2.2.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2"><and id="S4.SS1.SSS1.p1.17.m17.2.2a.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2"></and><apply id="S4.SS1.SSS1.p1.17.m17.2.2b.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2"><eq id="S4.SS1.SSS1.p1.17.m17.2.2.4.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.4"></eq><apply id="S4.SS1.SSS1.p1.17.m17.2.2.3.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.3"><ci id="S4.SS1.SSS1.p1.17.m17.2.2.3.1.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.3.1">~</ci><ci id="S4.SS1.SSS1.p1.17.m17.2.2.3.2.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.3.2">𝑥</ci></apply><apply id="S4.SS1.SSS1.p1.17.m17.2.2.1.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1"><times id="S4.SS1.SSS1.p1.17.m17.2.2.1.2.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.2"></times><apply id="S4.SS1.SSS1.p1.17.m17.2.2.1.3.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.17.m17.2.2.1.3.1.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.3">subscript</csymbol><ci id="S4.SS1.SSS1.p1.17.m17.2.2.1.3.2.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.3.2">𝐷</ci><ci id="S4.SS1.SSS1.p1.17.m17.2.2.1.3.3.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.3.3">italic-ϕ</ci></apply><apply id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1"><times id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.1.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.1"></times><apply id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.2">𝐸</ci><ci id="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.1.1.1.1.2.3">𝜃</ci></apply><ci id="S4.SS1.SSS1.p1.17.m17.1.1.cmml" xref="S4.SS1.SSS1.p1.17.m17.1.1">𝑥</ci></apply></apply></apply><apply id="S4.SS1.SSS1.p1.17.m17.2.2c.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2"><in id="S4.SS1.SSS1.p1.17.m17.2.2.5.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.5"></in><share href="https://arxiv.org/html/2408.17095v2#S4.SS1.SSS1.p1.17.m17.2.2.1.cmml" id="S4.SS1.SSS1.p1.17.m17.2.2d.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2"></share><apply id="S4.SS1.SSS1.p1.17.m17.2.2.6.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.6"><csymbol cd="ambiguous" id="S4.SS1.SSS1.p1.17.m17.2.2.6.1.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.6">superscript</csymbol><ci id="S4.SS1.SSS1.p1.17.m17.2.2.6.2.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.2">ℝ</ci><apply id="S4.SS1.SSS1.p1.17.m17.2.2.6.3.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3"><times id="S4.SS1.SSS1.p1.17.m17.2.2.6.3.1.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3.1"></times><ci id="S4.SS1.SSS1.p1.17.m17.2.2.6.3.2.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3.2">ℎ</ci><ci id="S4.SS1.SSS1.p1.17.m17.2.2.6.3.3.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3.3">𝑤</ci><ci id="S4.SS1.SSS1.p1.17.m17.2.2.6.3.4.cmml" xref="S4.SS1.SSS1.p1.17.m17.2.2.6.3.4">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.17.m17.2c">\tilde{x}=D_{\phi}(E_{\theta}(x))\in\mathbb{R}^{h\times w\times c}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS1.p1.17.m17.2d">over~ start_ARG italic_x end_ARG = italic_D start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_E start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_h × italic_w × italic_c end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Building the Retrieval Database</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.9">For constructing the retrieval database, denoted as <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.1.m1.1"><semantics id="S4.SS1.SSS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.1b"><ci id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.1.m1.1d">caligraphic_D</annotation></semantics></math>, the latent representations <math alttext="z" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.2.m2.1"><semantics id="S4.SS1.SSS2.p1.2.m2.1a"><mi id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.1b"><ci id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.1c">z</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.2.m2.1d">italic_z</annotation></semantics></math> of the training images are partitioned into <math alttext="b" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.3.m3.1"><semantics id="S4.SS1.SSS2.p1.3.m3.1a"><mi id="S4.SS1.SSS2.p1.3.m3.1.1" xref="S4.SS1.SSS2.p1.3.m3.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.3.m3.1b"><ci id="S4.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.3.m3.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.3.m3.1d">italic_b</annotation></semantics></math> non-overlapping, equal-sized blocks. We denote <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.4.m4.1"><semantics id="S4.SS1.SSS2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.4.m4.1.1" xref="S4.SS1.SSS2.p1.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.4.m4.1b"><ci id="S4.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.4.m4.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.4.m4.1d">caligraphic_D</annotation></semantics></math> as <math alttext="\bigcup_{i=0}^{b-1}\mathcal{D}_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.5.m5.1"><semantics id="S4.SS1.SSS2.p1.5.m5.1a"><mrow id="S4.SS1.SSS2.p1.5.m5.1.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.cmml"><msubsup id="S4.SS1.SSS2.p1.5.m5.1.1.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.cmml"><mo id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.2" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.2.2.cmml">⋃</mo><mrow id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.cmml"><mi id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.2" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.2.cmml">i</mi><mo id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.1.cmml">=</mo><mn id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.3" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.3.cmml">0</mn></mrow><mrow id="S4.SS1.SSS2.p1.5.m5.1.1.1.3" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.3.cmml"><mi id="S4.SS1.SSS2.p1.5.m5.1.1.1.3.2" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.3.2.cmml">b</mi><mo id="S4.SS1.SSS2.p1.5.m5.1.1.1.3.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.3.1.cmml">−</mo><mn id="S4.SS1.SSS2.p1.5.m5.1.1.1.3.3" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.3.3.cmml">1</mn></mrow></msubsup><msub id="S4.SS1.SSS2.p1.5.m5.1.1.2" xref="S4.SS1.SSS2.p1.5.m5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.5.m5.1.1.2.2" xref="S4.SS1.SSS2.p1.5.m5.1.1.2.2.cmml">𝒟</mi><mi id="S4.SS1.SSS2.p1.5.m5.1.1.2.3" xref="S4.SS1.SSS2.p1.5.m5.1.1.2.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.5.m5.1b"><apply id="S4.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1"><apply id="S4.SS1.SSS2.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.5.m5.1.1.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1">superscript</csymbol><apply id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1">subscript</csymbol><union id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.2.2"></union><apply id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3"><eq id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.1"></eq><ci id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.2">𝑖</ci><cn id="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.3.cmml" type="integer" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.2.3.3">0</cn></apply></apply><apply id="S4.SS1.SSS2.p1.5.m5.1.1.1.3.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.3"><minus id="S4.SS1.SSS2.p1.5.m5.1.1.1.3.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.3.1"></minus><ci id="S4.SS1.SSS2.p1.5.m5.1.1.1.3.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.3.2">𝑏</ci><cn id="S4.SS1.SSS2.p1.5.m5.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.SSS2.p1.5.m5.1.1.1.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS2.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.5.m5.1.1.2.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S4.SS1.SSS2.p1.5.m5.1.1.2.2.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.2.2">𝒟</ci><ci id="S4.SS1.SSS2.p1.5.m5.1.1.2.3.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.5.m5.1c">\bigcup_{i=0}^{b-1}\mathcal{D}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.5.m5.1d">⋃ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, where <math alttext="\mathcal{D}_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.6.m6.1"><semantics id="S4.SS1.SSS2.p1.6.m6.1a"><msub id="S4.SS1.SSS2.p1.6.m6.1.1" xref="S4.SS1.SSS2.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.6.m6.1.1.2" xref="S4.SS1.SSS2.p1.6.m6.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.SSS2.p1.6.m6.1.1.3" xref="S4.SS1.SSS2.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.6.m6.1b"><apply id="S4.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.6.m6.1.1.1.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.6.m6.1.1.2.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1.2">𝒟</ci><ci id="S4.SS1.SSS2.p1.6.m6.1.1.3.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.6.m6.1c">\mathcal{D}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.6.m6.1d">caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> comprises a stack of the <math alttext="i^{th}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.7.m7.1"><semantics id="S4.SS1.SSS2.p1.7.m7.1a"><msup id="S4.SS1.SSS2.p1.7.m7.1.1" xref="S4.SS1.SSS2.p1.7.m7.1.1.cmml"><mi id="S4.SS1.SSS2.p1.7.m7.1.1.2" xref="S4.SS1.SSS2.p1.7.m7.1.1.2.cmml">i</mi><mrow id="S4.SS1.SSS2.p1.7.m7.1.1.3" xref="S4.SS1.SSS2.p1.7.m7.1.1.3.cmml"><mi id="S4.SS1.SSS2.p1.7.m7.1.1.3.2" xref="S4.SS1.SSS2.p1.7.m7.1.1.3.2.cmml">t</mi><mo id="S4.SS1.SSS2.p1.7.m7.1.1.3.1" xref="S4.SS1.SSS2.p1.7.m7.1.1.3.1.cmml">⁢</mo><mi id="S4.SS1.SSS2.p1.7.m7.1.1.3.3" xref="S4.SS1.SSS2.p1.7.m7.1.1.3.3.cmml">h</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.7.m7.1b"><apply id="S4.SS1.SSS2.p1.7.m7.1.1.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.7.m7.1.1.1.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1">superscript</csymbol><ci id="S4.SS1.SSS2.p1.7.m7.1.1.2.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1.2">𝑖</ci><apply id="S4.SS1.SSS2.p1.7.m7.1.1.3.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1.3"><times id="S4.SS1.SSS2.p1.7.m7.1.1.3.1.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1.3.1"></times><ci id="S4.SS1.SSS2.p1.7.m7.1.1.3.2.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1.3.2">𝑡</ci><ci id="S4.SS1.SSS2.p1.7.m7.1.1.3.3.cmml" xref="S4.SS1.SSS2.p1.7.m7.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.7.m7.1c">i^{th}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.7.m7.1d">italic_i start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT</annotation></semantics></math> blocks of <math alttext="z=E(x)" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.8.m8.1"><semantics id="S4.SS1.SSS2.p1.8.m8.1a"><mrow id="S4.SS1.SSS2.p1.8.m8.1.2" xref="S4.SS1.SSS2.p1.8.m8.1.2.cmml"><mi id="S4.SS1.SSS2.p1.8.m8.1.2.2" xref="S4.SS1.SSS2.p1.8.m8.1.2.2.cmml">z</mi><mo id="S4.SS1.SSS2.p1.8.m8.1.2.1" xref="S4.SS1.SSS2.p1.8.m8.1.2.1.cmml">=</mo><mrow id="S4.SS1.SSS2.p1.8.m8.1.2.3" xref="S4.SS1.SSS2.p1.8.m8.1.2.3.cmml"><mi id="S4.SS1.SSS2.p1.8.m8.1.2.3.2" xref="S4.SS1.SSS2.p1.8.m8.1.2.3.2.cmml">E</mi><mo id="S4.SS1.SSS2.p1.8.m8.1.2.3.1" xref="S4.SS1.SSS2.p1.8.m8.1.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS2.p1.8.m8.1.2.3.3.2" xref="S4.SS1.SSS2.p1.8.m8.1.2.3.cmml"><mo id="S4.SS1.SSS2.p1.8.m8.1.2.3.3.2.1" stretchy="false" xref="S4.SS1.SSS2.p1.8.m8.1.2.3.cmml">(</mo><mi id="S4.SS1.SSS2.p1.8.m8.1.1" xref="S4.SS1.SSS2.p1.8.m8.1.1.cmml">x</mi><mo id="S4.SS1.SSS2.p1.8.m8.1.2.3.3.2.2" stretchy="false" xref="S4.SS1.SSS2.p1.8.m8.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.8.m8.1b"><apply id="S4.SS1.SSS2.p1.8.m8.1.2.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.2"><eq id="S4.SS1.SSS2.p1.8.m8.1.2.1.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.2.1"></eq><ci id="S4.SS1.SSS2.p1.8.m8.1.2.2.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.2.2">𝑧</ci><apply id="S4.SS1.SSS2.p1.8.m8.1.2.3.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.2.3"><times id="S4.SS1.SSS2.p1.8.m8.1.2.3.1.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.2.3.1"></times><ci id="S4.SS1.SSS2.p1.8.m8.1.2.3.2.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.2.3.2">𝐸</ci><ci id="S4.SS1.SSS2.p1.8.m8.1.1.cmml" xref="S4.SS1.SSS2.p1.8.m8.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.8.m8.1c">z=E(x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.8.m8.1d">italic_z = italic_E ( italic_x )</annotation></semantics></math> for all <math alttext="x\in\mathcal{X}" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.9.m9.1"><semantics id="S4.SS1.SSS2.p1.9.m9.1a"><mrow id="S4.SS1.SSS2.p1.9.m9.1.1" xref="S4.SS1.SSS2.p1.9.m9.1.1.cmml"><mi id="S4.SS1.SSS2.p1.9.m9.1.1.2" xref="S4.SS1.SSS2.p1.9.m9.1.1.2.cmml">x</mi><mo id="S4.SS1.SSS2.p1.9.m9.1.1.1" xref="S4.SS1.SSS2.p1.9.m9.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS2.p1.9.m9.1.1.3" xref="S4.SS1.SSS2.p1.9.m9.1.1.3.cmml">𝒳</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.9.m9.1b"><apply id="S4.SS1.SSS2.p1.9.m9.1.1.cmml" xref="S4.SS1.SSS2.p1.9.m9.1.1"><in id="S4.SS1.SSS2.p1.9.m9.1.1.1.cmml" xref="S4.SS1.SSS2.p1.9.m9.1.1.1"></in><ci id="S4.SS1.SSS2.p1.9.m9.1.1.2.cmml" xref="S4.SS1.SSS2.p1.9.m9.1.1.2">𝑥</ci><ci id="S4.SS1.SSS2.p1.9.m9.1.1.3.cmml" xref="S4.SS1.SSS2.p1.9.m9.1.1.3">𝒳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.9.m9.1c">x\in\mathcal{X}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.9.m9.1d">italic_x ∈ caligraphic_X</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3 </span>Block-wise DDPM Training</h4>
<div class="ltx_para" id="S4.SS1.SSS3.p1">
<p class="ltx_p" id="S4.SS1.SSS3.p1.16">Recall that the forward and reverse diffusion of our proposed DDPM formulation operate on the latent representation <math alttext="z=\bigcup_{i=0}^{b-1}z^{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.1.m1.1"><semantics id="S4.SS1.SSS3.p1.1.m1.1a"><mrow id="S4.SS1.SSS3.p1.1.m1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml">z</mi><mo id="S4.SS1.SSS3.p1.1.m1.1.1.1" rspace="0.111em" xref="S4.SS1.SSS3.p1.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS1.SSS3.p1.1.m1.1.1.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml"><msubsup id="S4.SS1.SSS3.p1.1.m1.1.1.3.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.cmml"><mo id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.2.cmml">⋃</mo><mrow id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mrow id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.2.cmml">b</mi><mo id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.1.cmml">−</mo><mn id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.3.cmml">1</mn></mrow></msubsup><msup id="S4.SS1.SSS3.p1.1.m1.1.1.3.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.2.cmml"><mi id="S4.SS1.SSS3.p1.1.m1.1.1.3.2.2" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.2.2.cmml">z</mi><mi id="S4.SS1.SSS3.p1.1.m1.1.1.3.2.3" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.2.3.cmml">i</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.1.m1.1b"><apply id="S4.SS1.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1"><eq id="S4.SS1.SSS3.p1.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.1"></eq><ci id="S4.SS1.SSS3.p1.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.2">𝑧</ci><apply id="S4.SS1.SSS3.p1.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3"><apply id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1">superscript</csymbol><apply id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1">subscript</csymbol><union id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.2"></union><apply id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3"><eq id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.1"></eq><ci id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.2">𝑖</ci><cn id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.2.3.3">0</cn></apply></apply><apply id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3"><minus id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.1"></minus><ci id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.2">𝑏</ci><cn id="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.1.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS3.p1.1.m1.1.1.3.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.1.m1.1.1.3.2.1.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.2">superscript</csymbol><ci id="S4.SS1.SSS3.p1.1.m1.1.1.3.2.2.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.2.2">𝑧</ci><ci id="S4.SS1.SSS3.p1.1.m1.1.1.3.2.3.cmml" xref="S4.SS1.SSS3.p1.1.m1.1.1.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.1.m1.1c">z=\bigcup_{i=0}^{b-1}z^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.1.m1.1d">italic_z = ⋃ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>. Before iterating through each block, <math alttext="z^{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.2.m2.1"><semantics id="S4.SS1.SSS3.p1.2.m2.1a"><msup id="S4.SS1.SSS3.p1.2.m2.1.1" xref="S4.SS1.SSS3.p1.2.m2.1.1.cmml"><mi id="S4.SS1.SSS3.p1.2.m2.1.1.2" xref="S4.SS1.SSS3.p1.2.m2.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS3.p1.2.m2.1.1.3" xref="S4.SS1.SSS3.p1.2.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.2.m2.1b"><apply id="S4.SS1.SSS3.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.SSS3.p1.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1.2">𝑧</ci><ci id="S4.SS1.SSS3.p1.2.m2.1.1.3.cmml" xref="S4.SS1.SSS3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.2.m2.1c">z^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.2.m2.1d">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, we use the first block<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Another design choice can be to use the entire <math alttext="z" class="ltx_Math" display="inline" id="footnote2.m1.1"><semantics id="footnote2.m1.1b"><mi id="footnote2.m1.1.1" xref="footnote2.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="footnote2.m1.1c"><ci id="footnote2.m1.1.1.cmml" xref="footnote2.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="footnote2.m1.1d">z</annotation><annotation encoding="application/x-llamapun" id="footnote2.m1.1e">italic_z</annotation></semantics></math> to do the retrieval since we have access to the full image and its latent representation. We show some results with this choice in the Appendix.</span></span></span> <math alttext="z^{0}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.3.m3.1"><semantics id="S4.SS1.SSS3.p1.3.m3.1a"><msup id="S4.SS1.SSS3.p1.3.m3.1.1" xref="S4.SS1.SSS3.p1.3.m3.1.1.cmml"><mi id="S4.SS1.SSS3.p1.3.m3.1.1.2" xref="S4.SS1.SSS3.p1.3.m3.1.1.2.cmml">z</mi><mn id="S4.SS1.SSS3.p1.3.m3.1.1.3" xref="S4.SS1.SSS3.p1.3.m3.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.3.m3.1b"><apply id="S4.SS1.SSS3.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.3.m3.1.1.1.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.SSS3.p1.3.m3.1.1.2.cmml" xref="S4.SS1.SSS3.p1.3.m3.1.1.2">𝑧</ci><cn id="S4.SS1.SSS3.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.3.m3.1c">z^{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.3.m3.1d">italic_z start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> to retrieve the <math alttext="k" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.4.m4.1"><semantics id="S4.SS1.SSS3.p1.4.m4.1a"><mi id="S4.SS1.SSS3.p1.4.m4.1.1" xref="S4.SS1.SSS3.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.4.m4.1b"><ci id="S4.SS1.SSS3.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS3.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.4.m4.1d">italic_k</annotation></semantics></math> nearest neighbors of <math alttext="z^{0}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.5.m5.1"><semantics id="S4.SS1.SSS3.p1.5.m5.1a"><msup id="S4.SS1.SSS3.p1.5.m5.1.1" xref="S4.SS1.SSS3.p1.5.m5.1.1.cmml"><mi id="S4.SS1.SSS3.p1.5.m5.1.1.2" xref="S4.SS1.SSS3.p1.5.m5.1.1.2.cmml">z</mi><mn id="S4.SS1.SSS3.p1.5.m5.1.1.3" xref="S4.SS1.SSS3.p1.5.m5.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.5.m5.1b"><apply id="S4.SS1.SSS3.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.5.m5.1.1.1.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1">superscript</csymbol><ci id="S4.SS1.SSS3.p1.5.m5.1.1.2.cmml" xref="S4.SS1.SSS3.p1.5.m5.1.1.2">𝑧</ci><cn id="S4.SS1.SSS3.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.5.m5.1c">z^{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.5.m5.1d">italic_z start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> from <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.6.m6.1"><semantics id="S4.SS1.SSS3.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.6.m6.1.1" xref="S4.SS1.SSS3.p1.6.m6.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.6.m6.1b"><ci id="S4.SS1.SSS3.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS3.p1.6.m6.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.6.m6.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.6.m6.1d">caligraphic_D</annotation></semantics></math>, denoted by <math alttext="\mathcal{M}_{\mathcal{D}}^{(k)}=\xi_{k}(z^{0},D)" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.7.m7.3"><semantics id="S4.SS1.SSS3.p1.7.m7.3a"><mrow id="S4.SS1.SSS3.p1.7.m7.3.3" xref="S4.SS1.SSS3.p1.7.m7.3.3.cmml"><msubsup id="S4.SS1.SSS3.p1.7.m7.3.3.3" xref="S4.SS1.SSS3.p1.7.m7.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.7.m7.3.3.3.2.2" xref="S4.SS1.SSS3.p1.7.m7.3.3.3.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.7.m7.3.3.3.2.3" xref="S4.SS1.SSS3.p1.7.m7.3.3.3.2.3.cmml">𝒟</mi><mrow id="S4.SS1.SSS3.p1.7.m7.1.1.1.3" xref="S4.SS1.SSS3.p1.7.m7.3.3.3.cmml"><mo id="S4.SS1.SSS3.p1.7.m7.1.1.1.3.1" stretchy="false" xref="S4.SS1.SSS3.p1.7.m7.3.3.3.cmml">(</mo><mi id="S4.SS1.SSS3.p1.7.m7.1.1.1.1" xref="S4.SS1.SSS3.p1.7.m7.1.1.1.1.cmml">k</mi><mo id="S4.SS1.SSS3.p1.7.m7.1.1.1.3.2" stretchy="false" xref="S4.SS1.SSS3.p1.7.m7.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.SSS3.p1.7.m7.3.3.2" xref="S4.SS1.SSS3.p1.7.m7.3.3.2.cmml">=</mo><mrow id="S4.SS1.SSS3.p1.7.m7.3.3.1" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.cmml"><msub id="S4.SS1.SSS3.p1.7.m7.3.3.1.3" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.3.cmml"><mi id="S4.SS1.SSS3.p1.7.m7.3.3.1.3.2" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.3.2.cmml">ξ</mi><mi id="S4.SS1.SSS3.p1.7.m7.3.3.1.3.3" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.3.3.cmml">k</mi></msub><mo id="S4.SS1.SSS3.p1.7.m7.3.3.1.2" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.2.cmml"><mo id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.2" stretchy="false" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.2.cmml">(</mo><msup id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.cmml"><mi id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.2" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.2.cmml">z</mi><mn id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.3" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.3.cmml">0</mn></msup><mo id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.3" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.2.cmml">,</mo><mi id="S4.SS1.SSS3.p1.7.m7.2.2" xref="S4.SS1.SSS3.p1.7.m7.2.2.cmml">D</mi><mo id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.4" stretchy="false" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.7.m7.3b"><apply id="S4.SS1.SSS3.p1.7.m7.3.3.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3"><eq id="S4.SS1.SSS3.p1.7.m7.3.3.2.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.2"></eq><apply id="S4.SS1.SSS3.p1.7.m7.3.3.3.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.7.m7.3.3.3.1.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.3">superscript</csymbol><apply id="S4.SS1.SSS3.p1.7.m7.3.3.3.2.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.7.m7.3.3.3.2.1.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.3">subscript</csymbol><ci id="S4.SS1.SSS3.p1.7.m7.3.3.3.2.2.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.3.2.2">ℳ</ci><ci id="S4.SS1.SSS3.p1.7.m7.3.3.3.2.3.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.3.2.3">𝒟</ci></apply><ci id="S4.SS1.SSS3.p1.7.m7.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.7.m7.1.1.1.1">𝑘</ci></apply><apply id="S4.SS1.SSS3.p1.7.m7.3.3.1.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.1"><times id="S4.SS1.SSS3.p1.7.m7.3.3.1.2.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.2"></times><apply id="S4.SS1.SSS3.p1.7.m7.3.3.1.3.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.7.m7.3.3.1.3.1.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.3">subscript</csymbol><ci id="S4.SS1.SSS3.p1.7.m7.3.3.1.3.2.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.3.2">𝜉</ci><ci id="S4.SS1.SSS3.p1.7.m7.3.3.1.3.3.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.3.3">𝑘</ci></apply><interval closure="open" id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.2.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1"><apply id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1">superscript</csymbol><ci id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.2">𝑧</ci><cn id="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.7.m7.3.3.1.1.1.1.3">0</cn></apply><ci id="S4.SS1.SSS3.p1.7.m7.2.2.cmml" xref="S4.SS1.SSS3.p1.7.m7.2.2">𝐷</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.7.m7.3c">\mathcal{M}_{\mathcal{D}}^{(k)}=\xi_{k}(z^{0},D)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.7.m7.3d">caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT = italic_ξ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT , italic_D )</annotation></semantics></math>, where <math alttext="\xi(.)" class="ltx_math_unparsed" display="inline" id="S4.SS1.SSS3.p1.8.m8.1"><semantics id="S4.SS1.SSS3.p1.8.m8.1a"><mrow id="S4.SS1.SSS3.p1.8.m8.1b"><mi id="S4.SS1.SSS3.p1.8.m8.1.1">ξ</mi><mrow id="S4.SS1.SSS3.p1.8.m8.1.2"><mo id="S4.SS1.SSS3.p1.8.m8.1.2.1" stretchy="false">(</mo><mo id="S4.SS1.SSS3.p1.8.m8.1.2.2" lspace="0em" rspace="0.167em">.</mo><mo id="S4.SS1.SSS3.p1.8.m8.1.2.3" stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.8.m8.1c">\xi(.)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.8.m8.1d">italic_ξ ( . )</annotation></semantics></math> is the retrieval function. Note that once <math alttext="\mathcal{M}_{\mathcal{D}}^{(k)}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.9.m9.1"><semantics id="S4.SS1.SSS3.p1.9.m9.1a"><msubsup id="S4.SS1.SSS3.p1.9.m9.1.2" xref="S4.SS1.SSS3.p1.9.m9.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.9.m9.1.2.2.2" xref="S4.SS1.SSS3.p1.9.m9.1.2.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.9.m9.1.2.2.3" xref="S4.SS1.SSS3.p1.9.m9.1.2.2.3.cmml">𝒟</mi><mrow id="S4.SS1.SSS3.p1.9.m9.1.1.1.3" xref="S4.SS1.SSS3.p1.9.m9.1.2.cmml"><mo id="S4.SS1.SSS3.p1.9.m9.1.1.1.3.1" stretchy="false" xref="S4.SS1.SSS3.p1.9.m9.1.2.cmml">(</mo><mi id="S4.SS1.SSS3.p1.9.m9.1.1.1.1" xref="S4.SS1.SSS3.p1.9.m9.1.1.1.1.cmml">k</mi><mo id="S4.SS1.SSS3.p1.9.m9.1.1.1.3.2" stretchy="false" xref="S4.SS1.SSS3.p1.9.m9.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.9.m9.1b"><apply id="S4.SS1.SSS3.p1.9.m9.1.2.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.9.m9.1.2.1.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.2">superscript</csymbol><apply id="S4.SS1.SSS3.p1.9.m9.1.2.2.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.9.m9.1.2.2.1.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.p1.9.m9.1.2.2.2.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.2.2.2">ℳ</ci><ci id="S4.SS1.SSS3.p1.9.m9.1.2.2.3.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.2.2.3">𝒟</ci></apply><ci id="S4.SS1.SSS3.p1.9.m9.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.9.m9.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.9.m9.1c">\mathcal{M}_{\mathcal{D}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.9.m9.1d">caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> is obtained, we do not need to perform the retrieval operation again to obtain <math alttext="\mathcal{M}_{\mathcal{D}_{i}}^{(k)}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.10.m10.1"><semantics id="S4.SS1.SSS3.p1.10.m10.1a"><msubsup id="S4.SS1.SSS3.p1.10.m10.1.2" xref="S4.SS1.SSS3.p1.10.m10.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.10.m10.1.2.2.2" xref="S4.SS1.SSS3.p1.10.m10.1.2.2.2.cmml">ℳ</mi><msub id="S4.SS1.SSS3.p1.10.m10.1.2.2.3" xref="S4.SS1.SSS3.p1.10.m10.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.10.m10.1.2.2.3.2" xref="S4.SS1.SSS3.p1.10.m10.1.2.2.3.2.cmml">𝒟</mi><mi id="S4.SS1.SSS3.p1.10.m10.1.2.2.3.3" xref="S4.SS1.SSS3.p1.10.m10.1.2.2.3.3.cmml">i</mi></msub><mrow id="S4.SS1.SSS3.p1.10.m10.1.1.1.3" xref="S4.SS1.SSS3.p1.10.m10.1.2.cmml"><mo id="S4.SS1.SSS3.p1.10.m10.1.1.1.3.1" stretchy="false" xref="S4.SS1.SSS3.p1.10.m10.1.2.cmml">(</mo><mi id="S4.SS1.SSS3.p1.10.m10.1.1.1.1" xref="S4.SS1.SSS3.p1.10.m10.1.1.1.1.cmml">k</mi><mo id="S4.SS1.SSS3.p1.10.m10.1.1.1.3.2" stretchy="false" xref="S4.SS1.SSS3.p1.10.m10.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.10.m10.1b"><apply id="S4.SS1.SSS3.p1.10.m10.1.2.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.10.m10.1.2.1.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.2">superscript</csymbol><apply id="S4.SS1.SSS3.p1.10.m10.1.2.2.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.10.m10.1.2.2.1.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.p1.10.m10.1.2.2.2.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.2.2.2">ℳ</ci><apply id="S4.SS1.SSS3.p1.10.m10.1.2.2.3.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.10.m10.1.2.2.3.1.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS3.p1.10.m10.1.2.2.3.2.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.2.2.3.2">𝒟</ci><ci id="S4.SS1.SSS3.p1.10.m10.1.2.2.3.3.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS1.SSS3.p1.10.m10.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.10.m10.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.10.m10.1c">\mathcal{M}_{\mathcal{D}_{i}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.10.m10.1d">caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> for subsequent blocks <math alttext="z^{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.11.m11.1"><semantics id="S4.SS1.SSS3.p1.11.m11.1a"><msup id="S4.SS1.SSS3.p1.11.m11.1.1" xref="S4.SS1.SSS3.p1.11.m11.1.1.cmml"><mi id="S4.SS1.SSS3.p1.11.m11.1.1.2" xref="S4.SS1.SSS3.p1.11.m11.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS3.p1.11.m11.1.1.3" xref="S4.SS1.SSS3.p1.11.m11.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.11.m11.1b"><apply id="S4.SS1.SSS3.p1.11.m11.1.1.cmml" xref="S4.SS1.SSS3.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.11.m11.1.1.1.cmml" xref="S4.SS1.SSS3.p1.11.m11.1.1">superscript</csymbol><ci id="S4.SS1.SSS3.p1.11.m11.1.1.2.cmml" xref="S4.SS1.SSS3.p1.11.m11.1.1.2">𝑧</ci><ci id="S4.SS1.SSS3.p1.11.m11.1.1.3.cmml" xref="S4.SS1.SSS3.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.11.m11.1c">z^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.11.m11.1d">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> for <math alttext="i\in{0,1,2,\cdots,b-1}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.12.m12.5"><semantics id="S4.SS1.SSS3.p1.12.m12.5a"><mrow id="S4.SS1.SSS3.p1.12.m12.5.5" xref="S4.SS1.SSS3.p1.12.m12.5.5.cmml"><mi id="S4.SS1.SSS3.p1.12.m12.5.5.3" xref="S4.SS1.SSS3.p1.12.m12.5.5.3.cmml">i</mi><mo id="S4.SS1.SSS3.p1.12.m12.5.5.2" xref="S4.SS1.SSS3.p1.12.m12.5.5.2.cmml">∈</mo><mrow id="S4.SS1.SSS3.p1.12.m12.5.5.1.1" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.2.cmml"><mn id="S4.SS1.SSS3.p1.12.m12.1.1" xref="S4.SS1.SSS3.p1.12.m12.1.1.cmml">0</mn><mo id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.2" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.2.cmml">,</mo><mn id="S4.SS1.SSS3.p1.12.m12.2.2" xref="S4.SS1.SSS3.p1.12.m12.2.2.cmml">1</mn><mo id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.3" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.2.cmml">,</mo><mn id="S4.SS1.SSS3.p1.12.m12.3.3" xref="S4.SS1.SSS3.p1.12.m12.3.3.cmml">2</mn><mo id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.4" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.2.cmml">,</mo><mi id="S4.SS1.SSS3.p1.12.m12.4.4" mathvariant="normal" xref="S4.SS1.SSS3.p1.12.m12.4.4.cmml">⋯</mi><mo id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.5" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.2.cmml">,</mo><mrow id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.cmml"><mi id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.2" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.2.cmml">b</mi><mo id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.1" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.1.cmml">−</mo><mn id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.3" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.12.m12.5b"><apply id="S4.SS1.SSS3.p1.12.m12.5.5.cmml" xref="S4.SS1.SSS3.p1.12.m12.5.5"><in id="S4.SS1.SSS3.p1.12.m12.5.5.2.cmml" xref="S4.SS1.SSS3.p1.12.m12.5.5.2"></in><ci id="S4.SS1.SSS3.p1.12.m12.5.5.3.cmml" xref="S4.SS1.SSS3.p1.12.m12.5.5.3">𝑖</ci><list id="S4.SS1.SSS3.p1.12.m12.5.5.1.2.cmml" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.1"><cn id="S4.SS1.SSS3.p1.12.m12.1.1.cmml" type="integer" xref="S4.SS1.SSS3.p1.12.m12.1.1">0</cn><cn id="S4.SS1.SSS3.p1.12.m12.2.2.cmml" type="integer" xref="S4.SS1.SSS3.p1.12.m12.2.2">1</cn><cn id="S4.SS1.SSS3.p1.12.m12.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.12.m12.3.3">2</cn><ci id="S4.SS1.SSS3.p1.12.m12.4.4.cmml" xref="S4.SS1.SSS3.p1.12.m12.4.4">⋯</ci><apply id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.cmml" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1"><minus id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.1"></minus><ci id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.2.cmml" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.2">𝑏</ci><cn id="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.12.m12.5.5.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.12.m12.5c">i\in{0,1,2,\cdots,b-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.12.m12.5d">italic_i ∈ 0 , 1 , 2 , ⋯ , italic_b - 1</annotation></semantics></math>, since <math alttext="\mathcal{M}_{\mathcal{D}}^{(k)}=\bigcup_{i=0}^{b-1}\mathcal{M}_{\mathcal{D}_{i%
}}^{(k)}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.13.m13.2"><semantics id="S4.SS1.SSS3.p1.13.m13.2a"><mrow id="S4.SS1.SSS3.p1.13.m13.2.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.cmml"><msubsup id="S4.SS1.SSS3.p1.13.m13.2.3.2" xref="S4.SS1.SSS3.p1.13.m13.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.13.m13.2.3.2.2.2" xref="S4.SS1.SSS3.p1.13.m13.2.3.2.2.2.cmml">ℳ</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.13.m13.2.3.2.2.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.2.2.3.cmml">𝒟</mi><mrow id="S4.SS1.SSS3.p1.13.m13.1.1.1.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.2.cmml"><mo id="S4.SS1.SSS3.p1.13.m13.1.1.1.3.1" stretchy="false" xref="S4.SS1.SSS3.p1.13.m13.2.3.2.cmml">(</mo><mi id="S4.SS1.SSS3.p1.13.m13.1.1.1.1" xref="S4.SS1.SSS3.p1.13.m13.1.1.1.1.cmml">k</mi><mo id="S4.SS1.SSS3.p1.13.m13.1.1.1.3.2" stretchy="false" xref="S4.SS1.SSS3.p1.13.m13.2.3.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS1.SSS3.p1.13.m13.2.3.1" rspace="0.111em" xref="S4.SS1.SSS3.p1.13.m13.2.3.1.cmml">=</mo><mrow id="S4.SS1.SSS3.p1.13.m13.2.3.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.cmml"><msubsup id="S4.SS1.SSS3.p1.13.m13.2.3.3.1" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.cmml"><mo id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.2" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.2.cmml">⋃</mo><mrow id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.cmml"><mi id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.2" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.2.cmml">i</mi><mo id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.1" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.1.cmml">=</mo><mn id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.3.cmml">0</mn></mrow><mrow id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.cmml"><mi id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.2" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.2.cmml">b</mi><mo id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.1" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.1.cmml">−</mo><mn id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.3.cmml">1</mn></mrow></msubsup><msubsup id="S4.SS1.SSS3.p1.13.m13.2.3.3.2" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.2" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.2.cmml">ℳ</mi><msub id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.2" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.2.cmml">𝒟</mi><mi id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.3.cmml">i</mi></msub><mrow id="S4.SS1.SSS3.p1.13.m13.2.2.1.3" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.cmml"><mo id="S4.SS1.SSS3.p1.13.m13.2.2.1.3.1" stretchy="false" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.cmml">(</mo><mi id="S4.SS1.SSS3.p1.13.m13.2.2.1.1" xref="S4.SS1.SSS3.p1.13.m13.2.2.1.1.cmml">k</mi><mo id="S4.SS1.SSS3.p1.13.m13.2.2.1.3.2" stretchy="false" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.cmml">)</mo></mrow></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.13.m13.2b"><apply id="S4.SS1.SSS3.p1.13.m13.2.3.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3"><eq id="S4.SS1.SSS3.p1.13.m13.2.3.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.1"></eq><apply id="S4.SS1.SSS3.p1.13.m13.2.3.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.13.m13.2.3.2.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.2">superscript</csymbol><apply id="S4.SS1.SSS3.p1.13.m13.2.3.2.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.13.m13.2.3.2.2.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.2">subscript</csymbol><ci id="S4.SS1.SSS3.p1.13.m13.2.3.2.2.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.2.2.2">ℳ</ci><ci id="S4.SS1.SSS3.p1.13.m13.2.3.2.2.3.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.2.2.3">𝒟</ci></apply><ci id="S4.SS1.SSS3.p1.13.m13.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.1.1.1.1">𝑘</ci></apply><apply id="S4.SS1.SSS3.p1.13.m13.2.3.3.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3"><apply id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1">superscript</csymbol><apply id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1">subscript</csymbol><union id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.2"></union><apply id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3"><eq id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.1"></eq><ci id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.2">𝑖</ci><cn id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.2.3.3">0</cn></apply></apply><apply id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3"><minus id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.1"></minus><ci id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.2">𝑏</ci><cn id="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.3.cmml" type="integer" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.1.3.3">1</cn></apply></apply><apply id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2">superscript</csymbol><apply id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2">subscript</csymbol><ci id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.2">ℳ</ci><apply id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.2.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.2">𝒟</ci><ci id="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.3.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.3.3.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS1.SSS3.p1.13.m13.2.2.1.1.cmml" xref="S4.SS1.SSS3.p1.13.m13.2.2.1.1">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.13.m13.2c">\mathcal{M}_{\mathcal{D}}^{(k)}=\bigcup_{i=0}^{b-1}\mathcal{M}_{\mathcal{D}_{i%
}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.13.m13.2d">caligraphic_M start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT = ⋃ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math>. Subsequently, each block <math alttext="z^{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.14.m14.1"><semantics id="S4.SS1.SSS3.p1.14.m14.1a"><msup id="S4.SS1.SSS3.p1.14.m14.1.1" xref="S4.SS1.SSS3.p1.14.m14.1.1.cmml"><mi id="S4.SS1.SSS3.p1.14.m14.1.1.2" xref="S4.SS1.SSS3.p1.14.m14.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS3.p1.14.m14.1.1.3" xref="S4.SS1.SSS3.p1.14.m14.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.14.m14.1b"><apply id="S4.SS1.SSS3.p1.14.m14.1.1.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.14.m14.1.1.1.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1">superscript</csymbol><ci id="S4.SS1.SSS3.p1.14.m14.1.1.2.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1.2">𝑧</ci><ci id="S4.SS1.SSS3.p1.14.m14.1.1.3.cmml" xref="S4.SS1.SSS3.p1.14.m14.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.14.m14.1c">z^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.14.m14.1d">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is then conditioned on <math alttext="\mathcal{M}_{\mathcal{D}_{i}}^{(k)}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.15.m15.1"><semantics id="S4.SS1.SSS3.p1.15.m15.1a"><msubsup id="S4.SS1.SSS3.p1.15.m15.1.2" xref="S4.SS1.SSS3.p1.15.m15.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.15.m15.1.2.2.2" xref="S4.SS1.SSS3.p1.15.m15.1.2.2.2.cmml">ℳ</mi><msub id="S4.SS1.SSS3.p1.15.m15.1.2.2.3" xref="S4.SS1.SSS3.p1.15.m15.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.15.m15.1.2.2.3.2" xref="S4.SS1.SSS3.p1.15.m15.1.2.2.3.2.cmml">𝒟</mi><mi id="S4.SS1.SSS3.p1.15.m15.1.2.2.3.3" xref="S4.SS1.SSS3.p1.15.m15.1.2.2.3.3.cmml">i</mi></msub><mrow id="S4.SS1.SSS3.p1.15.m15.1.1.1.3" xref="S4.SS1.SSS3.p1.15.m15.1.2.cmml"><mo id="S4.SS1.SSS3.p1.15.m15.1.1.1.3.1" stretchy="false" xref="S4.SS1.SSS3.p1.15.m15.1.2.cmml">(</mo><mi id="S4.SS1.SSS3.p1.15.m15.1.1.1.1" xref="S4.SS1.SSS3.p1.15.m15.1.1.1.1.cmml">k</mi><mo id="S4.SS1.SSS3.p1.15.m15.1.1.1.3.2" stretchy="false" xref="S4.SS1.SSS3.p1.15.m15.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.15.m15.1b"><apply id="S4.SS1.SSS3.p1.15.m15.1.2.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.15.m15.1.2.1.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.2">superscript</csymbol><apply id="S4.SS1.SSS3.p1.15.m15.1.2.2.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.15.m15.1.2.2.1.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.p1.15.m15.1.2.2.2.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.2.2.2">ℳ</ci><apply id="S4.SS1.SSS3.p1.15.m15.1.2.2.3.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.15.m15.1.2.2.3.1.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS3.p1.15.m15.1.2.2.3.2.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.2.2.3.2">𝒟</ci><ci id="S4.SS1.SSS3.p1.15.m15.1.2.2.3.3.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS1.SSS3.p1.15.m15.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.15.m15.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.15.m15.1c">\mathcal{M}_{\mathcal{D}_{i}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.15.m15.1d">caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> to facilitate the training process through the DDPM U-Net, parameterized by <math alttext="\psi" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.16.m16.1"><semantics id="S4.SS1.SSS3.p1.16.m16.1a"><mi id="S4.SS1.SSS3.p1.16.m16.1.1" xref="S4.SS1.SSS3.p1.16.m16.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.16.m16.1b"><ci id="S4.SS1.SSS3.p1.16.m16.1.1.cmml" xref="S4.SS1.SSS3.p1.16.m16.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.16.m16.1c">\psi</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.16.m16.1d">italic_ψ</annotation></semantics></math>. This approach, characterized by its granularity and reliance on semi-parametric generative modeling <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx2" title="">Blattmann et al.(2022)Blattmann, Rombach, Oktay, Müller, and
Ommer</a>]</cite>, can be expressed as</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{\psi,\mathcal{D},\xi_{k}}(z)=\prod_{i=1}^{b-1}p_{\psi}(z^{i}|\{y|y\in%
\mathcal{M}_{\mathcal{D}_{i}}^{(k)}\})\vspace{-0.5em}" class="ltx_Math" display="block" id="S4.E1.m1.7"><semantics id="S4.E1.m1.7a"><mrow id="S4.E1.m1.7.7" xref="S4.E1.m1.7.7.cmml"><mrow id="S4.E1.m1.7.7.3" xref="S4.E1.m1.7.7.3.cmml"><msub id="S4.E1.m1.7.7.3.2" xref="S4.E1.m1.7.7.3.2.cmml"><mi id="S4.E1.m1.7.7.3.2.2" xref="S4.E1.m1.7.7.3.2.2.cmml">p</mi><mrow id="S4.E1.m1.3.3.3.3" xref="S4.E1.m1.3.3.3.4.cmml"><mi id="S4.E1.m1.1.1.1.1" xref="S4.E1.m1.1.1.1.1.cmml">ψ</mi><mo id="S4.E1.m1.3.3.3.3.2" xref="S4.E1.m1.3.3.3.4.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.2.2.2.2" xref="S4.E1.m1.2.2.2.2.cmml">𝒟</mi><mo id="S4.E1.m1.3.3.3.3.3" xref="S4.E1.m1.3.3.3.4.cmml">,</mo><msub id="S4.E1.m1.3.3.3.3.1" xref="S4.E1.m1.3.3.3.3.1.cmml"><mi id="S4.E1.m1.3.3.3.3.1.2" xref="S4.E1.m1.3.3.3.3.1.2.cmml">ξ</mi><mi id="S4.E1.m1.3.3.3.3.1.3" xref="S4.E1.m1.3.3.3.3.1.3.cmml">k</mi></msub></mrow></msub><mo id="S4.E1.m1.7.7.3.1" xref="S4.E1.m1.7.7.3.1.cmml">⁢</mo><mrow id="S4.E1.m1.7.7.3.3.2" xref="S4.E1.m1.7.7.3.cmml"><mo id="S4.E1.m1.7.7.3.3.2.1" stretchy="false" xref="S4.E1.m1.7.7.3.cmml">(</mo><mi id="S4.E1.m1.5.5" xref="S4.E1.m1.5.5.cmml">z</mi><mo id="S4.E1.m1.7.7.3.3.2.2" stretchy="false" xref="S4.E1.m1.7.7.3.cmml">)</mo></mrow></mrow><mo id="S4.E1.m1.7.7.2" rspace="0.111em" xref="S4.E1.m1.7.7.2.cmml">=</mo><mrow id="S4.E1.m1.7.7.1" xref="S4.E1.m1.7.7.1.cmml"><munderover id="S4.E1.m1.7.7.1.2" xref="S4.E1.m1.7.7.1.2.cmml"><mo id="S4.E1.m1.7.7.1.2.2.2" movablelimits="false" xref="S4.E1.m1.7.7.1.2.2.2.cmml">∏</mo><mrow id="S4.E1.m1.7.7.1.2.2.3" xref="S4.E1.m1.7.7.1.2.2.3.cmml"><mi id="S4.E1.m1.7.7.1.2.2.3.2" xref="S4.E1.m1.7.7.1.2.2.3.2.cmml">i</mi><mo id="S4.E1.m1.7.7.1.2.2.3.1" xref="S4.E1.m1.7.7.1.2.2.3.1.cmml">=</mo><mn id="S4.E1.m1.7.7.1.2.2.3.3" xref="S4.E1.m1.7.7.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E1.m1.7.7.1.2.3" xref="S4.E1.m1.7.7.1.2.3.cmml"><mi id="S4.E1.m1.7.7.1.2.3.2" xref="S4.E1.m1.7.7.1.2.3.2.cmml">b</mi><mo id="S4.E1.m1.7.7.1.2.3.1" xref="S4.E1.m1.7.7.1.2.3.1.cmml">−</mo><mn id="S4.E1.m1.7.7.1.2.3.3" xref="S4.E1.m1.7.7.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S4.E1.m1.7.7.1.1" xref="S4.E1.m1.7.7.1.1.cmml"><msub id="S4.E1.m1.7.7.1.1.3" xref="S4.E1.m1.7.7.1.1.3.cmml"><mi id="S4.E1.m1.7.7.1.1.3.2" xref="S4.E1.m1.7.7.1.1.3.2.cmml">p</mi><mi id="S4.E1.m1.7.7.1.1.3.3" xref="S4.E1.m1.7.7.1.1.3.3.cmml">ψ</mi></msub><mo id="S4.E1.m1.7.7.1.1.2" xref="S4.E1.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="S4.E1.m1.7.7.1.1.1.1" xref="S4.E1.m1.7.7.1.1.1.1.1.cmml"><mo id="S4.E1.m1.7.7.1.1.1.1.2" stretchy="false" xref="S4.E1.m1.7.7.1.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.7.7.1.1.1.1.1" xref="S4.E1.m1.7.7.1.1.1.1.1.cmml"><msup id="S4.E1.m1.7.7.1.1.1.1.1.3" xref="S4.E1.m1.7.7.1.1.1.1.1.3.cmml"><mi id="S4.E1.m1.7.7.1.1.1.1.1.3.2" xref="S4.E1.m1.7.7.1.1.1.1.1.3.2.cmml">z</mi><mi id="S4.E1.m1.7.7.1.1.1.1.1.3.3" xref="S4.E1.m1.7.7.1.1.1.1.1.3.3.cmml">i</mi></msup><mo fence="false" id="S4.E1.m1.7.7.1.1.1.1.1.2" xref="S4.E1.m1.7.7.1.1.1.1.1.2.cmml">|</mo><mrow id="S4.E1.m1.7.7.1.1.1.1.1.1.1" xref="S4.E1.m1.7.7.1.1.1.1.1.1.2.cmml"><mo id="S4.E1.m1.7.7.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E1.m1.7.7.1.1.1.1.1.1.2.1.cmml">{</mo><mi id="S4.E1.m1.6.6" xref="S4.E1.m1.6.6.cmml">y</mi><mo id="S4.E1.m1.7.7.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="S4.E1.m1.7.7.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">∈</mo><msubsup id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.2.cmml">ℳ</mi><msub id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.2" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.2.cmml">𝒟</mi><mi id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.3" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.3.cmml">i</mi></msub><mrow id="S4.E1.m1.4.4.1.3" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml"><mo id="S4.E1.m1.4.4.1.3.1" stretchy="false" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S4.E1.m1.4.4.1.1" xref="S4.E1.m1.4.4.1.1.cmml">k</mi><mo id="S4.E1.m1.4.4.1.3.2" stretchy="false" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E1.m1.7.7.1.1.1.1.1.1.1.4" stretchy="false" xref="S4.E1.m1.7.7.1.1.1.1.1.1.2.1.cmml">}</mo></mrow></mrow><mo id="S4.E1.m1.7.7.1.1.1.1.3" stretchy="false" xref="S4.E1.m1.7.7.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.7b"><apply id="S4.E1.m1.7.7.cmml" xref="S4.E1.m1.7.7"><eq id="S4.E1.m1.7.7.2.cmml" xref="S4.E1.m1.7.7.2"></eq><apply id="S4.E1.m1.7.7.3.cmml" xref="S4.E1.m1.7.7.3"><times id="S4.E1.m1.7.7.3.1.cmml" xref="S4.E1.m1.7.7.3.1"></times><apply id="S4.E1.m1.7.7.3.2.cmml" xref="S4.E1.m1.7.7.3.2"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.3.2.1.cmml" xref="S4.E1.m1.7.7.3.2">subscript</csymbol><ci id="S4.E1.m1.7.7.3.2.2.cmml" xref="S4.E1.m1.7.7.3.2.2">𝑝</ci><list id="S4.E1.m1.3.3.3.4.cmml" xref="S4.E1.m1.3.3.3.3"><ci id="S4.E1.m1.1.1.1.1.cmml" xref="S4.E1.m1.1.1.1.1">𝜓</ci><ci id="S4.E1.m1.2.2.2.2.cmml" xref="S4.E1.m1.2.2.2.2">𝒟</ci><apply id="S4.E1.m1.3.3.3.3.1.cmml" xref="S4.E1.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="S4.E1.m1.3.3.3.3.1.1.cmml" xref="S4.E1.m1.3.3.3.3.1">subscript</csymbol><ci id="S4.E1.m1.3.3.3.3.1.2.cmml" xref="S4.E1.m1.3.3.3.3.1.2">𝜉</ci><ci id="S4.E1.m1.3.3.3.3.1.3.cmml" xref="S4.E1.m1.3.3.3.3.1.3">𝑘</ci></apply></list></apply><ci id="S4.E1.m1.5.5.cmml" xref="S4.E1.m1.5.5">𝑧</ci></apply><apply id="S4.E1.m1.7.7.1.cmml" xref="S4.E1.m1.7.7.1"><apply id="S4.E1.m1.7.7.1.2.cmml" xref="S4.E1.m1.7.7.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.2.1.cmml" xref="S4.E1.m1.7.7.1.2">superscript</csymbol><apply id="S4.E1.m1.7.7.1.2.2.cmml" xref="S4.E1.m1.7.7.1.2"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.2.2.1.cmml" xref="S4.E1.m1.7.7.1.2">subscript</csymbol><csymbol cd="latexml" id="S4.E1.m1.7.7.1.2.2.2.cmml" xref="S4.E1.m1.7.7.1.2.2.2">product</csymbol><apply id="S4.E1.m1.7.7.1.2.2.3.cmml" xref="S4.E1.m1.7.7.1.2.2.3"><eq id="S4.E1.m1.7.7.1.2.2.3.1.cmml" xref="S4.E1.m1.7.7.1.2.2.3.1"></eq><ci id="S4.E1.m1.7.7.1.2.2.3.2.cmml" xref="S4.E1.m1.7.7.1.2.2.3.2">𝑖</ci><cn id="S4.E1.m1.7.7.1.2.2.3.3.cmml" type="integer" xref="S4.E1.m1.7.7.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E1.m1.7.7.1.2.3.cmml" xref="S4.E1.m1.7.7.1.2.3"><minus id="S4.E1.m1.7.7.1.2.3.1.cmml" xref="S4.E1.m1.7.7.1.2.3.1"></minus><ci id="S4.E1.m1.7.7.1.2.3.2.cmml" xref="S4.E1.m1.7.7.1.2.3.2">𝑏</ci><cn id="S4.E1.m1.7.7.1.2.3.3.cmml" type="integer" xref="S4.E1.m1.7.7.1.2.3.3">1</cn></apply></apply><apply id="S4.E1.m1.7.7.1.1.cmml" xref="S4.E1.m1.7.7.1.1"><times id="S4.E1.m1.7.7.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.2"></times><apply id="S4.E1.m1.7.7.1.1.3.cmml" xref="S4.E1.m1.7.7.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.3.1.cmml" xref="S4.E1.m1.7.7.1.1.3">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.3.2.cmml" xref="S4.E1.m1.7.7.1.1.3.2">𝑝</ci><ci id="S4.E1.m1.7.7.1.1.3.3.cmml" xref="S4.E1.m1.7.7.1.1.3.3">𝜓</ci></apply><apply id="S4.E1.m1.7.7.1.1.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.7.7.1.1.1.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.2">conditional</csymbol><apply id="S4.E1.m1.7.7.1.1.1.1.1.3.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E1.m1.7.7.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.3.2">𝑧</ci><ci id="S4.E1.m1.7.7.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E1.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.2">conditional-set</csymbol><ci id="S4.E1.m1.6.6.cmml" xref="S4.E1.m1.6.6">𝑦</ci><apply id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1"><in id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.1"></in><ci id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.2">ℳ</ci><apply id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.2">𝒟</ci><ci id="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S4.E1.m1.7.7.1.1.1.1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S4.E1.m1.4.4.1.1.cmml" xref="S4.E1.m1.4.4.1.1">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.7c">p_{\psi,\mathcal{D},\xi_{k}}(z)=\prod_{i=1}^{b-1}p_{\psi}(z^{i}|\{y|y\in%
\mathcal{M}_{\mathcal{D}_{i}}^{(k)}\})\vspace{-0.5em}</annotation><annotation encoding="application/x-llamapun" id="S4.E1.m1.7d">italic_p start_POSTSUBSCRIPT italic_ψ , caligraphic_D , italic_ξ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_z ) = ∏ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT | { italic_y | italic_y ∈ caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT } )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.SSS3.p1.19">The neighboring information denoted as <math alttext="\mathcal{M}_{\mathcal{D}_{i}}^{(k)}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.17.m1.1"><semantics id="S4.SS1.SSS3.p1.17.m1.1a"><msubsup id="S4.SS1.SSS3.p1.17.m1.1.2" xref="S4.SS1.SSS3.p1.17.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.17.m1.1.2.2.2" xref="S4.SS1.SSS3.p1.17.m1.1.2.2.2.cmml">ℳ</mi><msub id="S4.SS1.SSS3.p1.17.m1.1.2.2.3" xref="S4.SS1.SSS3.p1.17.m1.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.17.m1.1.2.2.3.2" xref="S4.SS1.SSS3.p1.17.m1.1.2.2.3.2.cmml">𝒟</mi><mi id="S4.SS1.SSS3.p1.17.m1.1.2.2.3.3" xref="S4.SS1.SSS3.p1.17.m1.1.2.2.3.3.cmml">i</mi></msub><mrow id="S4.SS1.SSS3.p1.17.m1.1.1.1.3" xref="S4.SS1.SSS3.p1.17.m1.1.2.cmml"><mo id="S4.SS1.SSS3.p1.17.m1.1.1.1.3.1" stretchy="false" xref="S4.SS1.SSS3.p1.17.m1.1.2.cmml">(</mo><mi id="S4.SS1.SSS3.p1.17.m1.1.1.1.1" xref="S4.SS1.SSS3.p1.17.m1.1.1.1.1.cmml">k</mi><mo id="S4.SS1.SSS3.p1.17.m1.1.1.1.3.2" stretchy="false" xref="S4.SS1.SSS3.p1.17.m1.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.17.m1.1b"><apply id="S4.SS1.SSS3.p1.17.m1.1.2.cmml" xref="S4.SS1.SSS3.p1.17.m1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.17.m1.1.2.1.cmml" xref="S4.SS1.SSS3.p1.17.m1.1.2">superscript</csymbol><apply id="S4.SS1.SSS3.p1.17.m1.1.2.2.cmml" xref="S4.SS1.SSS3.p1.17.m1.1.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.17.m1.1.2.2.1.cmml" xref="S4.SS1.SSS3.p1.17.m1.1.2">subscript</csymbol><ci id="S4.SS1.SSS3.p1.17.m1.1.2.2.2.cmml" xref="S4.SS1.SSS3.p1.17.m1.1.2.2.2">ℳ</ci><apply id="S4.SS1.SSS3.p1.17.m1.1.2.2.3.cmml" xref="S4.SS1.SSS3.p1.17.m1.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.17.m1.1.2.2.3.1.cmml" xref="S4.SS1.SSS3.p1.17.m1.1.2.2.3">subscript</csymbol><ci id="S4.SS1.SSS3.p1.17.m1.1.2.2.3.2.cmml" xref="S4.SS1.SSS3.p1.17.m1.1.2.2.3.2">𝒟</ci><ci id="S4.SS1.SSS3.p1.17.m1.1.2.2.3.3.cmml" xref="S4.SS1.SSS3.p1.17.m1.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS1.SSS3.p1.17.m1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p1.17.m1.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.17.m1.1c">\mathcal{M}_{\mathcal{D}_{i}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.17.m1.1d">caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math>, as retrieved from the database <math alttext="\mathcal{D}_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.18.m2.1"><semantics id="S4.SS1.SSS3.p1.18.m2.1a"><msub id="S4.SS1.SSS3.p1.18.m2.1.1" xref="S4.SS1.SSS3.p1.18.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.SSS3.p1.18.m2.1.1.2" xref="S4.SS1.SSS3.p1.18.m2.1.1.2.cmml">𝒟</mi><mi id="S4.SS1.SSS3.p1.18.m2.1.1.3" xref="S4.SS1.SSS3.p1.18.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.18.m2.1b"><apply id="S4.SS1.SSS3.p1.18.m2.1.1.cmml" xref="S4.SS1.SSS3.p1.18.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.18.m2.1.1.1.cmml" xref="S4.SS1.SSS3.p1.18.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p1.18.m2.1.1.2.cmml" xref="S4.SS1.SSS3.p1.18.m2.1.1.2">𝒟</ci><ci id="S4.SS1.SSS3.p1.18.m2.1.1.3.cmml" xref="S4.SS1.SSS3.p1.18.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.18.m2.1c">\mathcal{D}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.18.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, is typically combined with the input block <math alttext="z^{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p1.19.m3.1"><semantics id="S4.SS1.SSS3.p1.19.m3.1a"><msup id="S4.SS1.SSS3.p1.19.m3.1.1" xref="S4.SS1.SSS3.p1.19.m3.1.1.cmml"><mi id="S4.SS1.SSS3.p1.19.m3.1.1.2" xref="S4.SS1.SSS3.p1.19.m3.1.1.2.cmml">z</mi><mi id="S4.SS1.SSS3.p1.19.m3.1.1.3" xref="S4.SS1.SSS3.p1.19.m3.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p1.19.m3.1b"><apply id="S4.SS1.SSS3.p1.19.m3.1.1.cmml" xref="S4.SS1.SSS3.p1.19.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p1.19.m3.1.1.1.cmml" xref="S4.SS1.SSS3.p1.19.m3.1.1">superscript</csymbol><ci id="S4.SS1.SSS3.p1.19.m3.1.1.2.cmml" xref="S4.SS1.SSS3.p1.19.m3.1.1.2">𝑧</ci><ci id="S4.SS1.SSS3.p1.19.m3.1.1.3.cmml" xref="S4.SS1.SSS3.p1.19.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p1.19.m3.1c">z^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p1.19.m3.1d">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> by simply putting them together along the channel dimension. This combined information is input into a U-Net architecture <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx15" title="">Ronneberger et al.(2015)Ronneberger, Fischer, and
Brox</a>]</cite> during the reverse denoising stage within a latent diffusion model. However, we take a different approach where the input and the retrieved neighbors are processed separately through different convolutional layers, resulting in distinct standard embeddings. These embeddings are added to the original input before feeding into the U-Net structure. To maintain consistency and prevent unwanted shifts during training, we apply Layer Normalization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx1" title="">Ba et al.(2016)Ba, Kiros, and Hinton</a>]</cite> to the output. This modification allows us to forgo the costly Cross Attention Mechanism <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx14" title="">Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer</a>]</cite> for conditioning the input, resulting in fewer parameters and faster training and sampling times.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p2">
<p class="ltx_p" id="S4.SS1.SSS3.p2.1">We train RISSOLE using the standard re-weighted likelihood objective, as described in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx10" title="">Ho et al.(2020)Ho, Jain, and Abbeel</a>]</cite>, resulting in the objective similar to the one used in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx10" title="">Ho et al.(2020)Ho, Jain, and Abbeel</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx18" title="">Sohl-Dickstein et al.(2015)Sohl-Dickstein, Weiss, Maheswaranathan, and
Ganguli</a>]</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\psi}\mathcal{L}=\sum_{i=0}^{b-1}\mathbb{E}_{p(x),z\sim E_{\theta}(x),%
\epsilon\sim\mathcal{N}(0,1),t}[||\epsilon-\epsilon_{\psi}(z^{i}_{t},t,\{y|y%
\in\mathcal{M}_{\mathcal{D}_{i}}^{(k)}\})||]" class="ltx_Math" display="block" id="S4.E2.m1.12"><semantics id="S4.E2.m1.12a"><mrow id="S4.E2.m1.12.12" xref="S4.E2.m1.12.12.cmml"><mrow id="S4.E2.m1.12.12.3" xref="S4.E2.m1.12.12.3.cmml"><munder id="S4.E2.m1.12.12.3.1" xref="S4.E2.m1.12.12.3.1.cmml"><mi id="S4.E2.m1.12.12.3.1.2" xref="S4.E2.m1.12.12.3.1.2.cmml">min</mi><mi id="S4.E2.m1.12.12.3.1.3" xref="S4.E2.m1.12.12.3.1.3.cmml">ψ</mi></munder><mo id="S4.E2.m1.12.12.3a" lspace="0.167em" xref="S4.E2.m1.12.12.3.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.12.12.3.2" xref="S4.E2.m1.12.12.3.2.cmml">ℒ</mi></mrow><mo id="S4.E2.m1.12.12.2" rspace="0.111em" xref="S4.E2.m1.12.12.2.cmml">=</mo><mrow id="S4.E2.m1.12.12.1" xref="S4.E2.m1.12.12.1.cmml"><munderover id="S4.E2.m1.12.12.1.2" xref="S4.E2.m1.12.12.1.2.cmml"><mo id="S4.E2.m1.12.12.1.2.2.2" movablelimits="false" xref="S4.E2.m1.12.12.1.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.12.12.1.2.2.3" xref="S4.E2.m1.12.12.1.2.2.3.cmml"><mi id="S4.E2.m1.12.12.1.2.2.3.2" xref="S4.E2.m1.12.12.1.2.2.3.2.cmml">i</mi><mo id="S4.E2.m1.12.12.1.2.2.3.1" xref="S4.E2.m1.12.12.1.2.2.3.1.cmml">=</mo><mn id="S4.E2.m1.12.12.1.2.2.3.3" xref="S4.E2.m1.12.12.1.2.2.3.3.cmml">0</mn></mrow><mrow id="S4.E2.m1.12.12.1.2.3" xref="S4.E2.m1.12.12.1.2.3.cmml"><mi id="S4.E2.m1.12.12.1.2.3.2" xref="S4.E2.m1.12.12.1.2.3.2.cmml">b</mi><mo id="S4.E2.m1.12.12.1.2.3.1" xref="S4.E2.m1.12.12.1.2.3.1.cmml">−</mo><mn id="S4.E2.m1.12.12.1.2.3.3" xref="S4.E2.m1.12.12.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S4.E2.m1.12.12.1.1" xref="S4.E2.m1.12.12.1.1.cmml"><msub id="S4.E2.m1.12.12.1.1.3" xref="S4.E2.m1.12.12.1.1.3.cmml"><mi id="S4.E2.m1.12.12.1.1.3.2" xref="S4.E2.m1.12.12.1.1.3.2.cmml">𝔼</mi><mrow id="S4.E2.m1.8.8.8.8" xref="S4.E2.m1.8.8.8.9.cmml"><mrow id="S4.E2.m1.7.7.7.7.1" xref="S4.E2.m1.7.7.7.7.1.cmml"><mrow id="S4.E2.m1.7.7.7.7.1.1.1" xref="S4.E2.m1.7.7.7.7.1.1.2.cmml"><mrow id="S4.E2.m1.7.7.7.7.1.1.1.1" xref="S4.E2.m1.7.7.7.7.1.1.1.1.cmml"><mi id="S4.E2.m1.7.7.7.7.1.1.1.1.2" xref="S4.E2.m1.7.7.7.7.1.1.1.1.2.cmml">p</mi><mo id="S4.E2.m1.7.7.7.7.1.1.1.1.1" xref="S4.E2.m1.7.7.7.7.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E2.m1.7.7.7.7.1.1.1.1.3.2" xref="S4.E2.m1.7.7.7.7.1.1.1.1.cmml"><mo id="S4.E2.m1.7.7.7.7.1.1.1.1.3.2.1" stretchy="false" xref="S4.E2.m1.7.7.7.7.1.1.1.1.cmml">(</mo><mi id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml">x</mi><mo id="S4.E2.m1.7.7.7.7.1.1.1.1.3.2.2" stretchy="false" xref="S4.E2.m1.7.7.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.7.7.7.7.1.1.1.2" xref="S4.E2.m1.7.7.7.7.1.1.2.cmml">,</mo><mi id="S4.E2.m1.3.3.3.3" xref="S4.E2.m1.3.3.3.3.cmml">z</mi></mrow><mo id="S4.E2.m1.7.7.7.7.1.2" xref="S4.E2.m1.7.7.7.7.1.2.cmml">∼</mo><mrow id="S4.E2.m1.7.7.7.7.1.3" xref="S4.E2.m1.7.7.7.7.1.3.cmml"><msub id="S4.E2.m1.7.7.7.7.1.3.2" xref="S4.E2.m1.7.7.7.7.1.3.2.cmml"><mi id="S4.E2.m1.7.7.7.7.1.3.2.2" xref="S4.E2.m1.7.7.7.7.1.3.2.2.cmml">E</mi><mi id="S4.E2.m1.7.7.7.7.1.3.2.3" xref="S4.E2.m1.7.7.7.7.1.3.2.3.cmml">θ</mi></msub><mo id="S4.E2.m1.7.7.7.7.1.3.1" xref="S4.E2.m1.7.7.7.7.1.3.1.cmml">⁢</mo><mrow id="S4.E2.m1.7.7.7.7.1.3.3.2" xref="S4.E2.m1.7.7.7.7.1.3.cmml"><mo id="S4.E2.m1.7.7.7.7.1.3.3.2.1" stretchy="false" xref="S4.E2.m1.7.7.7.7.1.3.cmml">(</mo><mi id="S4.E2.m1.2.2.2.2" xref="S4.E2.m1.2.2.2.2.cmml">x</mi><mo id="S4.E2.m1.7.7.7.7.1.3.3.2.2" stretchy="false" xref="S4.E2.m1.7.7.7.7.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.8.8.8.8.3" xref="S4.E2.m1.8.8.8.9a.cmml">,</mo><mrow id="S4.E2.m1.8.8.8.8.2" xref="S4.E2.m1.8.8.8.8.2.cmml"><mi id="S4.E2.m1.8.8.8.8.2.3" xref="S4.E2.m1.8.8.8.8.2.3.cmml">ϵ</mi><mo id="S4.E2.m1.8.8.8.8.2.2" xref="S4.E2.m1.8.8.8.8.2.2.cmml">∼</mo><mrow id="S4.E2.m1.8.8.8.8.2.1.1" xref="S4.E2.m1.8.8.8.8.2.1.2.cmml"><mrow id="S4.E2.m1.8.8.8.8.2.1.1.1" xref="S4.E2.m1.8.8.8.8.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.8.8.8.8.2.1.1.1.2" xref="S4.E2.m1.8.8.8.8.2.1.1.1.2.cmml">𝒩</mi><mo id="S4.E2.m1.8.8.8.8.2.1.1.1.1" xref="S4.E2.m1.8.8.8.8.2.1.1.1.1.cmml">⁢</mo><mrow id="S4.E2.m1.8.8.8.8.2.1.1.1.3.2" xref="S4.E2.m1.8.8.8.8.2.1.1.1.3.1.cmml"><mo id="S4.E2.m1.8.8.8.8.2.1.1.1.3.2.1" stretchy="false" xref="S4.E2.m1.8.8.8.8.2.1.1.1.3.1.cmml">(</mo><mn id="S4.E2.m1.4.4.4.4" xref="S4.E2.m1.4.4.4.4.cmml">0</mn><mo id="S4.E2.m1.8.8.8.8.2.1.1.1.3.2.2" xref="S4.E2.m1.8.8.8.8.2.1.1.1.3.1.cmml">,</mo><mn id="S4.E2.m1.5.5.5.5" xref="S4.E2.m1.5.5.5.5.cmml">1</mn><mo id="S4.E2.m1.8.8.8.8.2.1.1.1.3.2.3" stretchy="false" xref="S4.E2.m1.8.8.8.8.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.8.8.8.8.2.1.1.2" xref="S4.E2.m1.8.8.8.8.2.1.2.cmml">,</mo><mi id="S4.E2.m1.6.6.6.6" xref="S4.E2.m1.6.6.6.6.cmml">t</mi></mrow></mrow></mrow></msub><mo id="S4.E2.m1.12.12.1.1.2" xref="S4.E2.m1.12.12.1.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.12.12.1.1.1.1" xref="S4.E2.m1.12.12.1.1.1.2.cmml"><mo id="S4.E2.m1.12.12.1.1.1.1.2" stretchy="false" xref="S4.E2.m1.12.12.1.1.1.2.1.cmml">[</mo><mrow id="S4.E2.m1.12.12.1.1.1.1.1.1" xref="S4.E2.m1.12.12.1.1.1.1.1.2.cmml"><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.2" stretchy="false" xref="S4.E2.m1.12.12.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E2.m1.12.12.1.1.1.1.1.1.1" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.12.12.1.1.1.1.1.1.1.4" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.4.cmml">ϵ</mi><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.1.3" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.cmml"><msub id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.cmml"><mi id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.2" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.2.cmml">ϵ</mi><mi id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.3" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.3.cmml">ψ</mi></msub><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.3" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.3.cmml"><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.3" stretchy="false" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.3.cmml">t</mi><mi id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="S4.E2.m1.11.11" xref="S4.E2.m1.11.11.cmml">t</mi><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.5" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.2.cmml"><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.2" stretchy="false" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml">{</mo><mi id="S4.E2.m1.10.10" xref="S4.E2.m1.10.10.cmml">y</mi><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.3" lspace="0em" rspace="0em" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml">|</mo><mrow id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml"><mi id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.2" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.2.cmml">y</mi><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.1" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.1.cmml">∈</mo><msubsup id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.2" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.2.cmml">ℳ</mi><msub id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.2" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.2.cmml">𝒟</mi><mi id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.3" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.3.cmml">i</mi></msub><mrow id="S4.E2.m1.9.9.1.3" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.cmml"><mo id="S4.E2.m1.9.9.1.3.1" stretchy="false" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.cmml">(</mo><mi id="S4.E2.m1.9.9.1.1" xref="S4.E2.m1.9.9.1.1.cmml">k</mi><mo id="S4.E2.m1.9.9.1.3.2" stretchy="false" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.4" stretchy="false" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml">}</mo></mrow><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.6" stretchy="false" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2.m1.12.12.1.1.1.1.1.1.3" stretchy="false" xref="S4.E2.m1.12.12.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S4.E2.m1.12.12.1.1.1.1.3" stretchy="false" xref="S4.E2.m1.12.12.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.12b"><apply id="S4.E2.m1.12.12.cmml" xref="S4.E2.m1.12.12"><eq id="S4.E2.m1.12.12.2.cmml" xref="S4.E2.m1.12.12.2"></eq><apply id="S4.E2.m1.12.12.3.cmml" xref="S4.E2.m1.12.12.3"><apply id="S4.E2.m1.12.12.3.1.cmml" xref="S4.E2.m1.12.12.3.1"><csymbol cd="ambiguous" id="S4.E2.m1.12.12.3.1.1.cmml" xref="S4.E2.m1.12.12.3.1">subscript</csymbol><min id="S4.E2.m1.12.12.3.1.2.cmml" xref="S4.E2.m1.12.12.3.1.2"></min><ci id="S4.E2.m1.12.12.3.1.3.cmml" xref="S4.E2.m1.12.12.3.1.3">𝜓</ci></apply><ci id="S4.E2.m1.12.12.3.2.cmml" xref="S4.E2.m1.12.12.3.2">ℒ</ci></apply><apply id="S4.E2.m1.12.12.1.cmml" xref="S4.E2.m1.12.12.1"><apply id="S4.E2.m1.12.12.1.2.cmml" xref="S4.E2.m1.12.12.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.12.12.1.2.1.cmml" xref="S4.E2.m1.12.12.1.2">superscript</csymbol><apply id="S4.E2.m1.12.12.1.2.2.cmml" xref="S4.E2.m1.12.12.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.12.12.1.2.2.1.cmml" xref="S4.E2.m1.12.12.1.2">subscript</csymbol><sum id="S4.E2.m1.12.12.1.2.2.2.cmml" xref="S4.E2.m1.12.12.1.2.2.2"></sum><apply id="S4.E2.m1.12.12.1.2.2.3.cmml" xref="S4.E2.m1.12.12.1.2.2.3"><eq id="S4.E2.m1.12.12.1.2.2.3.1.cmml" xref="S4.E2.m1.12.12.1.2.2.3.1"></eq><ci id="S4.E2.m1.12.12.1.2.2.3.2.cmml" xref="S4.E2.m1.12.12.1.2.2.3.2">𝑖</ci><cn id="S4.E2.m1.12.12.1.2.2.3.3.cmml" type="integer" xref="S4.E2.m1.12.12.1.2.2.3.3">0</cn></apply></apply><apply id="S4.E2.m1.12.12.1.2.3.cmml" xref="S4.E2.m1.12.12.1.2.3"><minus id="S4.E2.m1.12.12.1.2.3.1.cmml" xref="S4.E2.m1.12.12.1.2.3.1"></minus><ci id="S4.E2.m1.12.12.1.2.3.2.cmml" xref="S4.E2.m1.12.12.1.2.3.2">𝑏</ci><cn id="S4.E2.m1.12.12.1.2.3.3.cmml" type="integer" xref="S4.E2.m1.12.12.1.2.3.3">1</cn></apply></apply><apply id="S4.E2.m1.12.12.1.1.cmml" xref="S4.E2.m1.12.12.1.1"><times id="S4.E2.m1.12.12.1.1.2.cmml" xref="S4.E2.m1.12.12.1.1.2"></times><apply id="S4.E2.m1.12.12.1.1.3.cmml" xref="S4.E2.m1.12.12.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.12.12.1.1.3.1.cmml" xref="S4.E2.m1.12.12.1.1.3">subscript</csymbol><ci id="S4.E2.m1.12.12.1.1.3.2.cmml" xref="S4.E2.m1.12.12.1.1.3.2">𝔼</ci><apply id="S4.E2.m1.8.8.8.9.cmml" xref="S4.E2.m1.8.8.8.8"><csymbol cd="ambiguous" id="S4.E2.m1.8.8.8.9a.cmml" xref="S4.E2.m1.8.8.8.8.3">formulae-sequence</csymbol><apply id="S4.E2.m1.7.7.7.7.1.cmml" xref="S4.E2.m1.7.7.7.7.1"><csymbol cd="latexml" id="S4.E2.m1.7.7.7.7.1.2.cmml" xref="S4.E2.m1.7.7.7.7.1.2">similar-to</csymbol><list id="S4.E2.m1.7.7.7.7.1.1.2.cmml" xref="S4.E2.m1.7.7.7.7.1.1.1"><apply id="S4.E2.m1.7.7.7.7.1.1.1.1.cmml" xref="S4.E2.m1.7.7.7.7.1.1.1.1"><times id="S4.E2.m1.7.7.7.7.1.1.1.1.1.cmml" xref="S4.E2.m1.7.7.7.7.1.1.1.1.1"></times><ci id="S4.E2.m1.7.7.7.7.1.1.1.1.2.cmml" xref="S4.E2.m1.7.7.7.7.1.1.1.1.2">𝑝</ci><ci id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1">𝑥</ci></apply><ci id="S4.E2.m1.3.3.3.3.cmml" xref="S4.E2.m1.3.3.3.3">𝑧</ci></list><apply id="S4.E2.m1.7.7.7.7.1.3.cmml" xref="S4.E2.m1.7.7.7.7.1.3"><times id="S4.E2.m1.7.7.7.7.1.3.1.cmml" xref="S4.E2.m1.7.7.7.7.1.3.1"></times><apply id="S4.E2.m1.7.7.7.7.1.3.2.cmml" xref="S4.E2.m1.7.7.7.7.1.3.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.7.7.1.3.2.1.cmml" xref="S4.E2.m1.7.7.7.7.1.3.2">subscript</csymbol><ci id="S4.E2.m1.7.7.7.7.1.3.2.2.cmml" xref="S4.E2.m1.7.7.7.7.1.3.2.2">𝐸</ci><ci id="S4.E2.m1.7.7.7.7.1.3.2.3.cmml" xref="S4.E2.m1.7.7.7.7.1.3.2.3">𝜃</ci></apply><ci id="S4.E2.m1.2.2.2.2.cmml" xref="S4.E2.m1.2.2.2.2">𝑥</ci></apply></apply><apply id="S4.E2.m1.8.8.8.8.2.cmml" xref="S4.E2.m1.8.8.8.8.2"><csymbol cd="latexml" id="S4.E2.m1.8.8.8.8.2.2.cmml" xref="S4.E2.m1.8.8.8.8.2.2">similar-to</csymbol><ci id="S4.E2.m1.8.8.8.8.2.3.cmml" xref="S4.E2.m1.8.8.8.8.2.3">italic-ϵ</ci><list id="S4.E2.m1.8.8.8.8.2.1.2.cmml" xref="S4.E2.m1.8.8.8.8.2.1.1"><apply id="S4.E2.m1.8.8.8.8.2.1.1.1.cmml" xref="S4.E2.m1.8.8.8.8.2.1.1.1"><times id="S4.E2.m1.8.8.8.8.2.1.1.1.1.cmml" xref="S4.E2.m1.8.8.8.8.2.1.1.1.1"></times><ci id="S4.E2.m1.8.8.8.8.2.1.1.1.2.cmml" xref="S4.E2.m1.8.8.8.8.2.1.1.1.2">𝒩</ci><interval closure="open" id="S4.E2.m1.8.8.8.8.2.1.1.1.3.1.cmml" xref="S4.E2.m1.8.8.8.8.2.1.1.1.3.2"><cn id="S4.E2.m1.4.4.4.4.cmml" type="integer" xref="S4.E2.m1.4.4.4.4">0</cn><cn id="S4.E2.m1.5.5.5.5.cmml" type="integer" xref="S4.E2.m1.5.5.5.5">1</cn></interval></apply><ci id="S4.E2.m1.6.6.6.6.cmml" xref="S4.E2.m1.6.6.6.6">𝑡</ci></list></apply></apply></apply><apply id="S4.E2.m1.12.12.1.1.1.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.12.12.1.1.1.2.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.2">delimited-[]</csymbol><apply id="S4.E2.m1.12.12.1.1.1.1.1.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m1.12.12.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E2.m1.12.12.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1"><minus id="S4.E2.m1.12.12.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.3"></minus><ci id="S4.E2.m1.12.12.1.1.1.1.1.1.1.4.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.4">italic-ϵ</ci><apply id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2"><times id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.3"></times><apply id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.2">italic-ϵ</ci><ci id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.3.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.4.3">𝜓</ci></apply><vector id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2"><apply id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑧</ci><ci id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.1.1.1.1.3">𝑡</ci></apply><ci id="S4.E2.m1.11.11.cmml" xref="S4.E2.m1.11.11">𝑡</ci><apply id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1"><csymbol cd="latexml" id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.2">conditional-set</csymbol><ci id="S4.E2.m1.10.10.cmml" xref="S4.E2.m1.10.10">𝑦</ci><apply id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1"><in id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.1"></in><ci id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.2">𝑦</ci><apply id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3">superscript</csymbol><apply id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3">subscript</csymbol><ci id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.2">ℳ</ci><apply id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.1.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3">subscript</csymbol><ci id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.2.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.2">𝒟</ci><ci id="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.3.cmml" xref="S4.E2.m1.12.12.1.1.1.1.1.1.1.2.2.2.2.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S4.E2.m1.9.9.1.1.cmml" xref="S4.E2.m1.9.9.1.1">𝑘</ci></apply></apply></apply></vector></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.12c">\min_{\psi}\mathcal{L}=\sum_{i=0}^{b-1}\mathbb{E}_{p(x),z\sim E_{\theta}(x),%
\epsilon\sim\mathcal{N}(0,1),t}[||\epsilon-\epsilon_{\psi}(z^{i}_{t},t,\{y|y%
\in\mathcal{M}_{\mathcal{D}_{i}}^{(k)}\})||]</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.12d">roman_min start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT caligraphic_L = ∑ start_POSTSUBSCRIPT italic_i = 0 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT blackboard_E start_POSTSUBSCRIPT italic_p ( italic_x ) , italic_z ∼ italic_E start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) , italic_ϵ ∼ caligraphic_N ( 0 , 1 ) , italic_t end_POSTSUBSCRIPT [ | | italic_ϵ - italic_ϵ start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT , italic_t , { italic_y | italic_y ∈ caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT } ) | | ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p3">
<p class="ltx_p" id="S4.SS1.SSS3.p3.3">In Eq. <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.E2" title="In 4.1.3 Block-wise DDPM Training ‣ 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">2</span></a>, <math alttext="\epsilon_{\psi}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p3.1.m1.1"><semantics id="S4.SS1.SSS3.p3.1.m1.1a"><msub id="S4.SS1.SSS3.p3.1.m1.1.1" xref="S4.SS1.SSS3.p3.1.m1.1.1.cmml"><mi id="S4.SS1.SSS3.p3.1.m1.1.1.2" xref="S4.SS1.SSS3.p3.1.m1.1.1.2.cmml">ϵ</mi><mi id="S4.SS1.SSS3.p3.1.m1.1.1.3" xref="S4.SS1.SSS3.p3.1.m1.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.1.m1.1b"><apply id="S4.SS1.SSS3.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1.2">italic-ϵ</ci><ci id="S4.SS1.SSS3.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.1.m1.1c">\epsilon_{\psi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p3.1.m1.1d">italic_ϵ start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math> denotes the UNet-based denoising autoencoder detailed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx15" title="">Ronneberger et al.(2015)Ronneberger, Fischer, and
Brox</a>]</cite> and applied in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx14" title="">Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx5" title="">Dhariwal and Nichol(2021)</a>]</cite>. In addition to serving as the objective for a typical DDPM model, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.E2" title="In 4.1.3 Block-wise DDPM Training ‣ 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">2</span></a> also includes the collection of retrieved neighboring data points as a prerequisite for the noise predictor U-Net: <math alttext="\epsilon_{\psi}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p3.2.m2.1"><semantics id="S4.SS1.SSS3.p3.2.m2.1a"><msub id="S4.SS1.SSS3.p3.2.m2.1.1" xref="S4.SS1.SSS3.p3.2.m2.1.1.cmml"><mi id="S4.SS1.SSS3.p3.2.m2.1.1.2" xref="S4.SS1.SSS3.p3.2.m2.1.1.2.cmml">ϵ</mi><mi id="S4.SS1.SSS3.p3.2.m2.1.1.3" xref="S4.SS1.SSS3.p3.2.m2.1.1.3.cmml">ψ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.2.m2.1b"><apply id="S4.SS1.SSS3.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.p3.2.m2.1.1.2">italic-ϵ</ci><ci id="S4.SS1.SSS3.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS3.p3.2.m2.1.1.3">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.2.m2.1c">\epsilon_{\psi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p3.2.m2.1d">italic_ϵ start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT</annotation></semantics></math>. Furthermore, the loss is summed across all blocks where it is individually computed. The notation <math alttext="t\sim\text{Uniform}\{1,\ldots,T\}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p3.3.m3.3"><semantics id="S4.SS1.SSS3.p3.3.m3.3a"><mrow id="S4.SS1.SSS3.p3.3.m3.3.4" xref="S4.SS1.SSS3.p3.3.m3.3.4.cmml"><mi id="S4.SS1.SSS3.p3.3.m3.3.4.2" xref="S4.SS1.SSS3.p3.3.m3.3.4.2.cmml">t</mi><mo id="S4.SS1.SSS3.p3.3.m3.3.4.1" xref="S4.SS1.SSS3.p3.3.m3.3.4.1.cmml">∼</mo><mrow id="S4.SS1.SSS3.p3.3.m3.3.4.3" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.cmml"><mtext id="S4.SS1.SSS3.p3.3.m3.3.4.3.2" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.2a.cmml">Uniform</mtext><mo id="S4.SS1.SSS3.p3.3.m3.3.4.3.1" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS3.p3.3.m3.3.4.3.3.2" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.3.1.cmml"><mo id="S4.SS1.SSS3.p3.3.m3.3.4.3.3.2.1" stretchy="false" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.3.1.cmml">{</mo><mn id="S4.SS1.SSS3.p3.3.m3.1.1" xref="S4.SS1.SSS3.p3.3.m3.1.1.cmml">1</mn><mo id="S4.SS1.SSS3.p3.3.m3.3.4.3.3.2.2" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.3.1.cmml">,</mo><mi id="S4.SS1.SSS3.p3.3.m3.2.2" mathvariant="normal" xref="S4.SS1.SSS3.p3.3.m3.2.2.cmml">…</mi><mo id="S4.SS1.SSS3.p3.3.m3.3.4.3.3.2.3" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.3.1.cmml">,</mo><mi id="S4.SS1.SSS3.p3.3.m3.3.3" xref="S4.SS1.SSS3.p3.3.m3.3.3.cmml">T</mi><mo id="S4.SS1.SSS3.p3.3.m3.3.4.3.3.2.4" stretchy="false" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.3.m3.3b"><apply id="S4.SS1.SSS3.p3.3.m3.3.4.cmml" xref="S4.SS1.SSS3.p3.3.m3.3.4"><csymbol cd="latexml" id="S4.SS1.SSS3.p3.3.m3.3.4.1.cmml" xref="S4.SS1.SSS3.p3.3.m3.3.4.1">similar-to</csymbol><ci id="S4.SS1.SSS3.p3.3.m3.3.4.2.cmml" xref="S4.SS1.SSS3.p3.3.m3.3.4.2">𝑡</ci><apply id="S4.SS1.SSS3.p3.3.m3.3.4.3.cmml" xref="S4.SS1.SSS3.p3.3.m3.3.4.3"><times id="S4.SS1.SSS3.p3.3.m3.3.4.3.1.cmml" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.1"></times><ci id="S4.SS1.SSS3.p3.3.m3.3.4.3.2a.cmml" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.2"><mtext id="S4.SS1.SSS3.p3.3.m3.3.4.3.2.cmml" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.2">Uniform</mtext></ci><set id="S4.SS1.SSS3.p3.3.m3.3.4.3.3.1.cmml" xref="S4.SS1.SSS3.p3.3.m3.3.4.3.3.2"><cn id="S4.SS1.SSS3.p3.3.m3.1.1.cmml" type="integer" xref="S4.SS1.SSS3.p3.3.m3.1.1">1</cn><ci id="S4.SS1.SSS3.p3.3.m3.2.2.cmml" xref="S4.SS1.SSS3.p3.3.m3.2.2">…</ci><ci id="S4.SS1.SSS3.p3.3.m3.3.3.cmml" xref="S4.SS1.SSS3.p3.3.m3.3.3">𝑇</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.3.m3.3c">t\sim\text{Uniform}\{1,\ldots,T\}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p3.3.m3.3d">italic_t ∼ Uniform { 1 , … , italic_T }</annotation></semantics></math> indicates the time step, as elaborated in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx18" title="">Sohl-Dickstein et al.(2015)Sohl-Dickstein, Weiss, Maheswaranathan, and
Ganguli</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx14" title="">Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer</a>]</cite>. A pseudocode outlining the training procedure can be found in the Appendix.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>RISSOLE Sampling</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.4">Like RDM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx2" title="">Blattmann et al.(2022)Blattmann, Rombach, Oktay, Müller, and
Ommer</a>]</cite>, RISSOLE begins by picking a random <em class="ltx_emph ltx_font_italic" id="S4.SS2.p1.4.1">pseudo-query</em> from the database for generating new samples. However, unlike RDM, which uses a whole image as the query, we use its first block <math alttext="\hat{z}^{0}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><msup id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mover accent="true" id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2.2" xref="S4.SS2.p1.1.m1.1.1.2.2.cmml">z</mi><mo id="S4.SS2.p1.1.m1.1.1.2.1" xref="S4.SS2.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">superscript</csymbol><apply id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2"><ci id="S4.SS2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.1.2.1">^</ci><ci id="S4.SS2.p1.1.m1.1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2.2">𝑧</ci></apply><cn id="S4.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\hat{z}^{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">over^ start_ARG italic_z end_ARG start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> from the first block of our database <math alttext="\mathcal{D}_{0}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><msub id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">𝒟</mi><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝒟</ci><cn id="S4.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\mathcal{D}_{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>. We then use the query <math alttext="\hat{z}^{0}" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><msup id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mover accent="true" id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2.2" xref="S4.SS2.p1.3.m3.1.1.2.2.cmml">z</mi><mo id="S4.SS2.p1.3.m3.1.1.2.1" xref="S4.SS2.p1.3.m3.1.1.2.1.cmml">^</mo></mover><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">superscript</csymbol><apply id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2"><ci id="S4.SS2.p1.3.m3.1.1.2.1.cmml" xref="S4.SS2.p1.3.m3.1.1.2.1">^</ci><ci id="S4.SS2.p1.3.m3.1.1.2.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2.2">𝑧</ci></apply><cn id="S4.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\hat{z}^{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">over^ start_ARG italic_z end_ARG start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> to retrieve <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><ci id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">italic_k</annotation></semantics></math> nearest neighbors from the database (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.F1" title="Figure 1 ‣ 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">1</span></a> (d)).</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.7">Thereafter, we generate a random noise sample from a standard Gaussian. This sample is divided into <math alttext="b" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_b</annotation></semantics></math> fixed-size blocks, each covering a part of the latent space. Next, we perform block-wise sampling, where each block <math alttext="z^{i}" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><msup id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">z</mi><mi id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝑧</ci><ci id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">z^{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is sampled iteratively conditioned on its <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><ci id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_k</annotation></semantics></math> nearest neighbors <math alttext="\mathcal{M}_{\mathcal{D}_{i}}^{(k)}" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m4.1"><semantics id="S4.SS2.p2.4.m4.1a"><msubsup id="S4.SS2.p2.4.m4.1.2" xref="S4.SS2.p2.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.4.m4.1.2.2.2" xref="S4.SS2.p2.4.m4.1.2.2.2.cmml">ℳ</mi><msub id="S4.SS2.p2.4.m4.1.2.2.3" xref="S4.SS2.p2.4.m4.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p2.4.m4.1.2.2.3.2" xref="S4.SS2.p2.4.m4.1.2.2.3.2.cmml">𝒟</mi><mi id="S4.SS2.p2.4.m4.1.2.2.3.3" xref="S4.SS2.p2.4.m4.1.2.2.3.3.cmml">i</mi></msub><mrow id="S4.SS2.p2.4.m4.1.1.1.3" xref="S4.SS2.p2.4.m4.1.2.cmml"><mo id="S4.SS2.p2.4.m4.1.1.1.3.1" stretchy="false" xref="S4.SS2.p2.4.m4.1.2.cmml">(</mo><mi id="S4.SS2.p2.4.m4.1.1.1.1" xref="S4.SS2.p2.4.m4.1.1.1.1.cmml">k</mi><mo id="S4.SS2.p2.4.m4.1.1.1.3.2" stretchy="false" xref="S4.SS2.p2.4.m4.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.4.m4.1b"><apply id="S4.SS2.p2.4.m4.1.2.cmml" xref="S4.SS2.p2.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.2.1.cmml" xref="S4.SS2.p2.4.m4.1.2">superscript</csymbol><apply id="S4.SS2.p2.4.m4.1.2.2.cmml" xref="S4.SS2.p2.4.m4.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.2.2.1.cmml" xref="S4.SS2.p2.4.m4.1.2">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.2.2.2.cmml" xref="S4.SS2.p2.4.m4.1.2.2.2">ℳ</ci><apply id="S4.SS2.p2.4.m4.1.2.2.3.cmml" xref="S4.SS2.p2.4.m4.1.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p2.4.m4.1.2.2.3.1.cmml" xref="S4.SS2.p2.4.m4.1.2.2.3">subscript</csymbol><ci id="S4.SS2.p2.4.m4.1.2.2.3.2.cmml" xref="S4.SS2.p2.4.m4.1.2.2.3.2">𝒟</ci><ci id="S4.SS2.p2.4.m4.1.2.2.3.3.cmml" xref="S4.SS2.p2.4.m4.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S4.SS2.p2.4.m4.1.1.1.1.cmml" xref="S4.SS2.p2.4.m4.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.4.m4.1c">\mathcal{M}_{\mathcal{D}_{i}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.4.m4.1d">caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math> from the database, following a process similar to the one used during training. Once all blocks have been updated, we reconstruct the complete latent representation by combining the representations from each block. Finally, we decode this combined latent representation using the VQ-GAN Decoder <math alttext="D_{\phi}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m5.1"><semantics id="S4.SS2.p2.5.m5.1a"><msub id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml"><mi id="S4.SS2.p2.5.m5.1.1.2" xref="S4.SS2.p2.5.m5.1.1.2.cmml">D</mi><mi id="S4.SS2.p2.5.m5.1.1.3" xref="S4.SS2.p2.5.m5.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.5.m5.1b"><apply id="S4.SS2.p2.5.m5.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS2.p2.5.m5.1.1.1.cmml" xref="S4.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS2.p2.5.m5.1.1.2.cmml" xref="S4.SS2.p2.5.m5.1.1.2">𝐷</ci><ci id="S4.SS2.p2.5.m5.1.1.3.cmml" xref="S4.SS2.p2.5.m5.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.5.m5.1c">D_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.5.m5.1d">italic_D start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> with parameters <math alttext="\phi" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m6.1"><semantics id="S4.SS2.p2.6.m6.1a"><mi id="S4.SS2.p2.6.m6.1.1" xref="S4.SS2.p2.6.m6.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.6.m6.1b"><ci id="S4.SS2.p2.6.m6.1.1.cmml" xref="S4.SS2.p2.6.m6.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.6.m6.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.6.m6.1d">italic_ϕ</annotation></semantics></math> to produce a sample <math alttext="x" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m7.1"><semantics id="S4.SS2.p2.7.m7.1a"><mi id="S4.SS2.p2.7.m7.1.1" xref="S4.SS2.p2.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.7.m7.1b"><ci id="S4.SS2.p2.7.m7.1.1.cmml" xref="S4.SS2.p2.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.7.m7.1c">x</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.7.m7.1d">italic_x</annotation></semantics></math> in the original data space. This enables structured sampling from the latent space, capturing relationships within blocks while maintaining coherence across generated samples.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">A distinguishing aspect of RISSOLE is that both training and sampling can be parallelized across the <math alttext="b" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">b</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_b</annotation></semantics></math> blocks (as the conditioning structure we use does not depend on the blocks on each other), thereby yielding further speed-ups during training and sampling. A pseudocode for sampling from RISSOLE is presented in the Appendix.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Dataset and Baselines</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.4">We evaluate RISSOLE on two benchmark datasets: CelebA <math alttext="64\times 64" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1.1"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">64</mn><mo id="S5.SS1.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS1.p1.1.m1.1.1.3" xref="S5.SS1.p1.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><times id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1"></times><cn id="S5.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.2">64</cn><cn id="S5.SS1.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS1.p1.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.1.m1.1d">64 × 64</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx12" title="">Liu et al.(2015)Liu, Luo, Wang, and Tang</a>]</cite> and ImageNet100 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx4" title="">Deng et al.(2009)Deng, Dong, Socher, Li, Li, and
Fei-Fei</a>]</cite>. CelebA64 contains 202,599 images showing human faces with <math alttext="64\times 64\times 3" class="ltx_Math" display="inline" id="S5.SS1.p1.2.m2.1"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mn id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">64</mn><mo id="S5.SS1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS1.p1.2.m2.1.1.3" xref="S5.SS1.p1.2.m2.1.1.3.cmml">64</mn><mo id="S5.SS1.p1.2.m2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS1.p1.2.m2.1.1.4" xref="S5.SS1.p1.2.m2.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><times id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1"></times><cn id="S5.SS1.p1.2.m2.1.1.2.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.2">64</cn><cn id="S5.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.3">64</cn><cn id="S5.SS1.p1.2.m2.1.1.4.cmml" type="integer" xref="S5.SS1.p1.2.m2.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">64\times 64\times 3</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.2.m2.1d">64 × 64 × 3</annotation></semantics></math> resolution, while ImageNet <math alttext="100" class="ltx_Math" display="inline" id="S5.SS1.p1.3.m3.1"><semantics id="S5.SS1.p1.3.m3.1a"><mn id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><cn id="S5.SS1.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS1.p1.3.m3.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">100</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.3.m3.1d">100</annotation></semantics></math> has 127,878 natural images from 100 categories, each with a resolution of <math alttext="224\times 224\times 3" class="ltx_Math" display="inline" id="S5.SS1.p1.4.m4.1"><semantics id="S5.SS1.p1.4.m4.1a"><mrow id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml"><mn id="S5.SS1.p1.4.m4.1.1.2" xref="S5.SS1.p1.4.m4.1.1.2.cmml">224</mn><mo id="S5.SS1.p1.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.4.m4.1.1.1.cmml">×</mo><mn id="S5.SS1.p1.4.m4.1.1.3" xref="S5.SS1.p1.4.m4.1.1.3.cmml">224</mn><mo id="S5.SS1.p1.4.m4.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS1.p1.4.m4.1.1.1.cmml">×</mo><mn id="S5.SS1.p1.4.m4.1.1.4" xref="S5.SS1.p1.4.m4.1.1.4.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.4.m4.1b"><apply id="S5.SS1.p1.4.m4.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1"><times id="S5.SS1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.p1.4.m4.1.1.1"></times><cn id="S5.SS1.p1.4.m4.1.1.2.cmml" type="integer" xref="S5.SS1.p1.4.m4.1.1.2">224</cn><cn id="S5.SS1.p1.4.m4.1.1.3.cmml" type="integer" xref="S5.SS1.p1.4.m4.1.1.3">224</cn><cn id="S5.SS1.p1.4.m4.1.1.4.cmml" type="integer" xref="S5.SS1.p1.4.m4.1.1.4">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.4.m4.1c">224\times 224\times 3</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p1.4.m4.1d">224 × 224 × 3</annotation></semantics></math>. We used 80% of the data for training and the remaining 20% for validation, and the same training/validation split was used for both datasets. We compare RISSOLE with RDM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx2" title="">Blattmann et al.(2022)Blattmann, Rombach, Oktay, Müller, and
Ommer</a>]</cite>, a recent SOTA method for compact-sized diffusion models. RDM uses an external database to keep the size of the diffusion model module small. In addition to RDM, we also compare RISSOLE with two other baselines - a variant of RISSOLE that does not use retrieval guidance and another variant that does not use retrieval guidance but uses the different blocks of the image to condition the current block (this is an instance of the recent work on patch-based diffusion models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx7" title="">Ding et al.(2024)Ding, Zhang, Wu, and Tu</a>]</cite>). Please note that these are the most relevant baselines for RISSOLE. Although fast to train, recent methods like patch diffusion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx6" title="">Ding et al.(2023)Ding, Zhang, Wu, and Tu</a>]</cite> are not directly comparable with RISSOLE since such approaches still require a small set of full-sized images during training.
Nevertheless, we compare RISSOLE with Patch Diffusion when it does not use full-sized images during training to ensure fairness in comparison. Thus, their model sizes are not small, unlike RISSOLE, and are thus not included in the comparison here. It is also important to highlight that the roles played by the external database differ in RDM and RISSOLE. In RDM, it helps keep the diffusion model size small, whereas in RISSOLE, the primary role of the external database is to achieve coherence across blocks. In contrast, RISSOLE’s block-wise training/generation ability contributes to its parameter efficiency.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Experimental Setup</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.4">In training the VQ-GAN encoder-decoder, we have maintained <math alttext="f=8" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml">f</mi><mo id="S5.SS2.p1.1.m1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><eq id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1"></eq><ci id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2">𝑓</ci><cn id="S5.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS2.p1.1.m1.1.1.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">f=8</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">italic_f = 8</annotation></semantics></math> (refer to Section <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.SS1.SSS1" title="4.1.1 VQ-GAN Training ‣ 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">4.1.1</span></a>) across both datasets. Specifically, for the CelebA dataset, the VQ-GAN’s latent dimension is configured to 10. Conversely, due to ImageNet’s higher resolution, the latent dimension is adjusted to 32. Consequently, the latent resolution for an image from CelebA will be <math alttext="10\times 16\times 16" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1"><semantics id="S5.SS2.p1.2.m2.1a"><mrow id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml"><mn id="S5.SS2.p1.2.m2.1.1.2" xref="S5.SS2.p1.2.m2.1.1.2.cmml">10</mn><mo id="S5.SS2.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS2.p1.2.m2.1.1.3" xref="S5.SS2.p1.2.m2.1.1.3.cmml">16</mn><mo id="S5.SS2.p1.2.m2.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS2.p1.2.m2.1.1.4" xref="S5.SS2.p1.2.m2.1.1.4.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><apply id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1"><times id="S5.SS2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1.1"></times><cn id="S5.SS2.p1.2.m2.1.1.2.cmml" type="integer" xref="S5.SS2.p1.2.m2.1.1.2">10</cn><cn id="S5.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S5.SS2.p1.2.m2.1.1.3">16</cn><cn id="S5.SS2.p1.2.m2.1.1.4.cmml" type="integer" xref="S5.SS2.p1.2.m2.1.1.4">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">10\times 16\times 16</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.2.m2.1d">10 × 16 × 16</annotation></semantics></math>, while for ImageNet, it will be <math alttext="32\times 28\times 28" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1"><semantics id="S5.SS2.p1.3.m3.1a"><mrow id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml"><mn id="S5.SS2.p1.3.m3.1.1.2" xref="S5.SS2.p1.3.m3.1.1.2.cmml">32</mn><mo id="S5.SS2.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p1.3.m3.1.1.1.cmml">×</mo><mn id="S5.SS2.p1.3.m3.1.1.3" xref="S5.SS2.p1.3.m3.1.1.3.cmml">28</mn><mo id="S5.SS2.p1.3.m3.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p1.3.m3.1.1.1.cmml">×</mo><mn id="S5.SS2.p1.3.m3.1.1.4" xref="S5.SS2.p1.3.m3.1.1.4.cmml">28</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><apply id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1"><times id="S5.SS2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1.1"></times><cn id="S5.SS2.p1.3.m3.1.1.2.cmml" type="integer" xref="S5.SS2.p1.3.m3.1.1.2">32</cn><cn id="S5.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S5.SS2.p1.3.m3.1.1.3">28</cn><cn id="S5.SS2.p1.3.m3.1.1.4.cmml" type="integer" xref="S5.SS2.p1.3.m3.1.1.4">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">32\times 28\times 28</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.3.m3.1d">32 × 28 × 28</annotation></semantics></math>. To retrieve the nearest neighbors from <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S5.SS2.p1.4.m4.1"><semantics id="S5.SS2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><ci id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.4.m4.1d">caligraphic_D</annotation></semantics></math>, we use ScanNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx9" title="">Guo et al.(2020)Guo, Sun, Lindgren, Geng, Simcha, Chern, and
Kumar</a>]</cite> search algorithm in the latent representation generated by a VQ-GAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx8" title="">Esser et al.(2021)Esser, Rombach, and Ommer</a>]</cite>.</p>
</div>
<figure class="ltx_figure ltx_align_floatright" id="S5.F2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="417" id="S5.F2.g1" src="extracted/5829184/Images/figure.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="ltx_text" id="S5.F2.4.2" style="font-size:90%;">Each of the three rows above show a pseudo-query image <math alttext="\hat{x}" class="ltx_Math" display="inline" id="S5.F2.3.1.m1.1"><semantics id="S5.F2.3.1.m1.1b"><mover accent="true" id="S5.F2.3.1.m1.1.1" xref="S5.F2.3.1.m1.1.1.cmml"><mi id="S5.F2.3.1.m1.1.1.2" xref="S5.F2.3.1.m1.1.1.2.cmml">x</mi><mo id="S5.F2.3.1.m1.1.1.1" xref="S5.F2.3.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S5.F2.3.1.m1.1c"><apply id="S5.F2.3.1.m1.1.1.cmml" xref="S5.F2.3.1.m1.1.1"><ci id="S5.F2.3.1.m1.1.1.1.cmml" xref="S5.F2.3.1.m1.1.1.1">^</ci><ci id="S5.F2.3.1.m1.1.1.2.cmml" xref="S5.F2.3.1.m1.1.1.2">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.3.1.m1.1d">\hat{x}</annotation><annotation encoding="application/x-llamapun" id="S5.F2.3.1.m1.1e">over^ start_ARG italic_x end_ARG</annotation></semantics></math> (used in generation time) from <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S5.F2.4.2.m2.1"><semantics id="S5.F2.4.2.m2.1b"><mi class="ltx_font_mathcaligraphic" id="S5.F2.4.2.m2.1.1" xref="S5.F2.4.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S5.F2.4.2.m2.1c"><ci id="S5.F2.4.2.m2.1.1.cmml" xref="S5.F2.4.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F2.4.2.m2.1d">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S5.F2.4.2.m2.1e">caligraphic_D</annotation></semantics></math>, its retrieved neighbors, and the generated sample when these neighbors are conditioned on. Note that the actual training and sampling occur in the latent space. These images, decoded from the latent representations, are for better understanding and visualization.</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.11">In alignment with the requirements of the chosen retrieval mechanism, each latent representation is flattened. For instance, considering the ImageNet100 dataset <math alttext="\mathcal{X}\subset\mathbb{R}^{224\times 224\times 3}" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1"><semantics id="S5.SS2.p2.1.m1.1a"><mrow id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p2.1.m1.1.1.2" xref="S5.SS2.p2.1.m1.1.1.2.cmml">𝒳</mi><mo id="S5.SS2.p2.1.m1.1.1.1" xref="S5.SS2.p2.1.m1.1.1.1.cmml">⊂</mo><msup id="S5.SS2.p2.1.m1.1.1.3" xref="S5.SS2.p2.1.m1.1.1.3.cmml"><mi id="S5.SS2.p2.1.m1.1.1.3.2" xref="S5.SS2.p2.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S5.SS2.p2.1.m1.1.1.3.3" xref="S5.SS2.p2.1.m1.1.1.3.3.cmml"><mn id="S5.SS2.p2.1.m1.1.1.3.3.2" xref="S5.SS2.p2.1.m1.1.1.3.3.2.cmml">224</mn><mo id="S5.SS2.p2.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S5.SS2.p2.1.m1.1.1.3.3.3" xref="S5.SS2.p2.1.m1.1.1.3.3.3.cmml">224</mn><mo id="S5.SS2.p2.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p2.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S5.SS2.p2.1.m1.1.1.3.3.4" xref="S5.SS2.p2.1.m1.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><apply id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1"><subset id="S5.SS2.p2.1.m1.1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1.1"></subset><ci id="S5.SS2.p2.1.m1.1.1.2.cmml" xref="S5.SS2.p2.1.m1.1.1.2">𝒳</ci><apply id="S5.SS2.p2.1.m1.1.1.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p2.1.m1.1.1.3.1.cmml" xref="S5.SS2.p2.1.m1.1.1.3">superscript</csymbol><ci id="S5.SS2.p2.1.m1.1.1.3.2.cmml" xref="S5.SS2.p2.1.m1.1.1.3.2">ℝ</ci><apply id="S5.SS2.p2.1.m1.1.1.3.3.cmml" xref="S5.SS2.p2.1.m1.1.1.3.3"><times id="S5.SS2.p2.1.m1.1.1.3.3.1.cmml" xref="S5.SS2.p2.1.m1.1.1.3.3.1"></times><cn id="S5.SS2.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="S5.SS2.p2.1.m1.1.1.3.3.2">224</cn><cn id="S5.SS2.p2.1.m1.1.1.3.3.3.cmml" type="integer" xref="S5.SS2.p2.1.m1.1.1.3.3.3">224</cn><cn id="S5.SS2.p2.1.m1.1.1.3.3.4.cmml" type="integer" xref="S5.SS2.p2.1.m1.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\mathcal{X}\subset\mathbb{R}^{224\times 224\times 3}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.1.m1.1d">caligraphic_X ⊂ blackboard_R start_POSTSUPERSCRIPT 224 × 224 × 3 end_POSTSUPERSCRIPT</annotation></semantics></math> with <math alttext="|\mathcal{X}|=n" class="ltx_Math" display="inline" id="S5.SS2.p2.2.m2.1"><semantics id="S5.SS2.p2.2.m2.1a"><mrow id="S5.SS2.p2.2.m2.1.2" xref="S5.SS2.p2.2.m2.1.2.cmml"><mrow id="S5.SS2.p2.2.m2.1.2.2.2" xref="S5.SS2.p2.2.m2.1.2.2.1.cmml"><mo id="S5.SS2.p2.2.m2.1.2.2.2.1" stretchy="false" xref="S5.SS2.p2.2.m2.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">𝒳</mi><mo id="S5.SS2.p2.2.m2.1.2.2.2.2" stretchy="false" xref="S5.SS2.p2.2.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="S5.SS2.p2.2.m2.1.2.1" xref="S5.SS2.p2.2.m2.1.2.1.cmml">=</mo><mi id="S5.SS2.p2.2.m2.1.2.3" xref="S5.SS2.p2.2.m2.1.2.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><apply id="S5.SS2.p2.2.m2.1.2.cmml" xref="S5.SS2.p2.2.m2.1.2"><eq id="S5.SS2.p2.2.m2.1.2.1.cmml" xref="S5.SS2.p2.2.m2.1.2.1"></eq><apply id="S5.SS2.p2.2.m2.1.2.2.1.cmml" xref="S5.SS2.p2.2.m2.1.2.2.2"><abs id="S5.SS2.p2.2.m2.1.2.2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.2.2.2.1"></abs><ci id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">𝒳</ci></apply><ci id="S5.SS2.p2.2.m2.1.2.3.cmml" xref="S5.SS2.p2.2.m2.1.2.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">|\mathcal{X}|=n</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.2.m2.1d">| caligraphic_X | = italic_n</annotation></semantics></math>, and <math alttext="z\in\mathbb{R}^{28\times 28\times 32}" class="ltx_Math" display="inline" id="S5.SS2.p2.3.m3.1"><semantics id="S5.SS2.p2.3.m3.1a"><mrow id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml"><mi id="S5.SS2.p2.3.m3.1.1.2" xref="S5.SS2.p2.3.m3.1.1.2.cmml">z</mi><mo id="S5.SS2.p2.3.m3.1.1.1" xref="S5.SS2.p2.3.m3.1.1.1.cmml">∈</mo><msup id="S5.SS2.p2.3.m3.1.1.3" xref="S5.SS2.p2.3.m3.1.1.3.cmml"><mi id="S5.SS2.p2.3.m3.1.1.3.2" xref="S5.SS2.p2.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S5.SS2.p2.3.m3.1.1.3.3" xref="S5.SS2.p2.3.m3.1.1.3.3.cmml"><mn id="S5.SS2.p2.3.m3.1.1.3.3.2" xref="S5.SS2.p2.3.m3.1.1.3.3.2.cmml">28</mn><mo id="S5.SS2.p2.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p2.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S5.SS2.p2.3.m3.1.1.3.3.3" xref="S5.SS2.p2.3.m3.1.1.3.3.3.cmml">28</mn><mo id="S5.SS2.p2.3.m3.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p2.3.m3.1.1.3.3.1.cmml">×</mo><mn id="S5.SS2.p2.3.m3.1.1.3.3.4" xref="S5.SS2.p2.3.m3.1.1.3.3.4.cmml">32</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.1b"><apply id="S5.SS2.p2.3.m3.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1"><in id="S5.SS2.p2.3.m3.1.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1.1"></in><ci id="S5.SS2.p2.3.m3.1.1.2.cmml" xref="S5.SS2.p2.3.m3.1.1.2">𝑧</ci><apply id="S5.SS2.p2.3.m3.1.1.3.cmml" xref="S5.SS2.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p2.3.m3.1.1.3.1.cmml" xref="S5.SS2.p2.3.m3.1.1.3">superscript</csymbol><ci id="S5.SS2.p2.3.m3.1.1.3.2.cmml" xref="S5.SS2.p2.3.m3.1.1.3.2">ℝ</ci><apply id="S5.SS2.p2.3.m3.1.1.3.3.cmml" xref="S5.SS2.p2.3.m3.1.1.3.3"><times id="S5.SS2.p2.3.m3.1.1.3.3.1.cmml" xref="S5.SS2.p2.3.m3.1.1.3.3.1"></times><cn id="S5.SS2.p2.3.m3.1.1.3.3.2.cmml" type="integer" xref="S5.SS2.p2.3.m3.1.1.3.3.2">28</cn><cn id="S5.SS2.p2.3.m3.1.1.3.3.3.cmml" type="integer" xref="S5.SS2.p2.3.m3.1.1.3.3.3">28</cn><cn id="S5.SS2.p2.3.m3.1.1.3.3.4.cmml" type="integer" xref="S5.SS2.p2.3.m3.1.1.3.3.4">32</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.1c">z\in\mathbb{R}^{28\times 28\times 32}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.3.m3.1d">italic_z ∈ blackboard_R start_POSTSUPERSCRIPT 28 × 28 × 32 end_POSTSUPERSCRIPT</annotation></semantics></math> the dimensionality of <math alttext="D" class="ltx_Math" display="inline" id="S5.SS2.p2.4.m4.1"><semantics id="S5.SS2.p2.4.m4.1a"><mi id="S5.SS2.p2.4.m4.1.1" xref="S5.SS2.p2.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.4.m4.1b"><ci id="S5.SS2.p2.4.m4.1.1.cmml" xref="S5.SS2.p2.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.4.m4.1c">D</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.4.m4.1d">italic_D</annotation></semantics></math> is denoted as <math alttext="\mathbb{R}^{b\times n\times 6272}" class="ltx_Math" display="inline" id="S5.SS2.p2.5.m5.1"><semantics id="S5.SS2.p2.5.m5.1a"><msup id="S5.SS2.p2.5.m5.1.1" xref="S5.SS2.p2.5.m5.1.1.cmml"><mi id="S5.SS2.p2.5.m5.1.1.2" xref="S5.SS2.p2.5.m5.1.1.2.cmml">ℝ</mi><mrow id="S5.SS2.p2.5.m5.1.1.3" xref="S5.SS2.p2.5.m5.1.1.3.cmml"><mi id="S5.SS2.p2.5.m5.1.1.3.2" xref="S5.SS2.p2.5.m5.1.1.3.2.cmml">b</mi><mo id="S5.SS2.p2.5.m5.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p2.5.m5.1.1.3.1.cmml">×</mo><mi id="S5.SS2.p2.5.m5.1.1.3.3" xref="S5.SS2.p2.5.m5.1.1.3.3.cmml">n</mi><mo id="S5.SS2.p2.5.m5.1.1.3.1a" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p2.5.m5.1.1.3.1.cmml">×</mo><mn id="S5.SS2.p2.5.m5.1.1.3.4" xref="S5.SS2.p2.5.m5.1.1.3.4.cmml">6272</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.5.m5.1b"><apply id="S5.SS2.p2.5.m5.1.1.cmml" xref="S5.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS2.p2.5.m5.1.1.1.cmml" xref="S5.SS2.p2.5.m5.1.1">superscript</csymbol><ci id="S5.SS2.p2.5.m5.1.1.2.cmml" xref="S5.SS2.p2.5.m5.1.1.2">ℝ</ci><apply id="S5.SS2.p2.5.m5.1.1.3.cmml" xref="S5.SS2.p2.5.m5.1.1.3"><times id="S5.SS2.p2.5.m5.1.1.3.1.cmml" xref="S5.SS2.p2.5.m5.1.1.3.1"></times><ci id="S5.SS2.p2.5.m5.1.1.3.2.cmml" xref="S5.SS2.p2.5.m5.1.1.3.2">𝑏</ci><ci id="S5.SS2.p2.5.m5.1.1.3.3.cmml" xref="S5.SS2.p2.5.m5.1.1.3.3">𝑛</ci><cn id="S5.SS2.p2.5.m5.1.1.3.4.cmml" type="integer" xref="S5.SS2.p2.5.m5.1.1.3.4">6272</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.5.m5.1c">\mathbb{R}^{b\times n\times 6272}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.5.m5.1d">blackboard_R start_POSTSUPERSCRIPT italic_b × italic_n × 6272 end_POSTSUPERSCRIPT</annotation></semantics></math>, with each <math alttext="\mathcal{D}_{i}\in\mathbb{R}^{n\times 6272}" class="ltx_Math" display="inline" id="S5.SS2.p2.6.m6.1"><semantics id="S5.SS2.p2.6.m6.1a"><mrow id="S5.SS2.p2.6.m6.1.1" xref="S5.SS2.p2.6.m6.1.1.cmml"><msub id="S5.SS2.p2.6.m6.1.1.2" xref="S5.SS2.p2.6.m6.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS2.p2.6.m6.1.1.2.2" xref="S5.SS2.p2.6.m6.1.1.2.2.cmml">𝒟</mi><mi id="S5.SS2.p2.6.m6.1.1.2.3" xref="S5.SS2.p2.6.m6.1.1.2.3.cmml">i</mi></msub><mo id="S5.SS2.p2.6.m6.1.1.1" xref="S5.SS2.p2.6.m6.1.1.1.cmml">∈</mo><msup id="S5.SS2.p2.6.m6.1.1.3" xref="S5.SS2.p2.6.m6.1.1.3.cmml"><mi id="S5.SS2.p2.6.m6.1.1.3.2" xref="S5.SS2.p2.6.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S5.SS2.p2.6.m6.1.1.3.3" xref="S5.SS2.p2.6.m6.1.1.3.3.cmml"><mi id="S5.SS2.p2.6.m6.1.1.3.3.2" xref="S5.SS2.p2.6.m6.1.1.3.3.2.cmml">n</mi><mo id="S5.SS2.p2.6.m6.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S5.SS2.p2.6.m6.1.1.3.3.1.cmml">×</mo><mn id="S5.SS2.p2.6.m6.1.1.3.3.3" xref="S5.SS2.p2.6.m6.1.1.3.3.3.cmml">6272</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.6.m6.1b"><apply id="S5.SS2.p2.6.m6.1.1.cmml" xref="S5.SS2.p2.6.m6.1.1"><in id="S5.SS2.p2.6.m6.1.1.1.cmml" xref="S5.SS2.p2.6.m6.1.1.1"></in><apply id="S5.SS2.p2.6.m6.1.1.2.cmml" xref="S5.SS2.p2.6.m6.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p2.6.m6.1.1.2.1.cmml" xref="S5.SS2.p2.6.m6.1.1.2">subscript</csymbol><ci id="S5.SS2.p2.6.m6.1.1.2.2.cmml" xref="S5.SS2.p2.6.m6.1.1.2.2">𝒟</ci><ci id="S5.SS2.p2.6.m6.1.1.2.3.cmml" xref="S5.SS2.p2.6.m6.1.1.2.3">𝑖</ci></apply><apply id="S5.SS2.p2.6.m6.1.1.3.cmml" xref="S5.SS2.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S5.SS2.p2.6.m6.1.1.3.1.cmml" xref="S5.SS2.p2.6.m6.1.1.3">superscript</csymbol><ci id="S5.SS2.p2.6.m6.1.1.3.2.cmml" xref="S5.SS2.p2.6.m6.1.1.3.2">ℝ</ci><apply id="S5.SS2.p2.6.m6.1.1.3.3.cmml" xref="S5.SS2.p2.6.m6.1.1.3.3"><times id="S5.SS2.p2.6.m6.1.1.3.3.1.cmml" xref="S5.SS2.p2.6.m6.1.1.3.3.1"></times><ci id="S5.SS2.p2.6.m6.1.1.3.3.2.cmml" xref="S5.SS2.p2.6.m6.1.1.3.3.2">𝑛</ci><cn id="S5.SS2.p2.6.m6.1.1.3.3.3.cmml" type="integer" xref="S5.SS2.p2.6.m6.1.1.3.3.3">6272</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.6.m6.1c">\mathcal{D}_{i}\in\mathbb{R}^{n\times 6272}</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.6.m6.1d">caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × 6272 end_POSTSUPERSCRIPT</annotation></semantics></math> where <math alttext="6272" class="ltx_Math" display="inline" id="S5.SS2.p2.7.m7.1"><semantics id="S5.SS2.p2.7.m7.1a"><mn id="S5.SS2.p2.7.m7.1.1" xref="S5.SS2.p2.7.m7.1.1.cmml">6272</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.7.m7.1b"><cn id="S5.SS2.p2.7.m7.1.1.cmml" type="integer" xref="S5.SS2.p2.7.m7.1.1">6272</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.7.m7.1c">6272</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.7.m7.1d">6272</annotation></semantics></math> emerges from the flattening process applied to <math alttext="z" class="ltx_Math" display="inline" id="S5.SS2.p2.8.m8.1"><semantics id="S5.SS2.p2.8.m8.1a"><mi id="S5.SS2.p2.8.m8.1.1" xref="S5.SS2.p2.8.m8.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.8.m8.1b"><ci id="S5.SS2.p2.8.m8.1.1.cmml" xref="S5.SS2.p2.8.m8.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.8.m8.1c">z</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.8.m8.1d">italic_z</annotation></semantics></math>. Our models are trained for 200 epochs on an NVIDIA 1080Ti (CelebA64) and an NVIDIA A30 (ImageNet100). The number of nearest neighbors <math alttext="k" class="ltx_Math" display="inline" id="S5.SS2.p2.9.m9.1"><semantics id="S5.SS2.p2.9.m9.1a"><mi id="S5.SS2.p2.9.m9.1.1" xref="S5.SS2.p2.9.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.9.m9.1b"><ci id="S5.SS2.p2.9.m9.1.1.cmml" xref="S5.SS2.p2.9.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.9.m9.1c">k</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.9.m9.1d">italic_k</annotation></semantics></math> can influence the performance of retrieval-based approaches. In our experiments, <math alttext="k=20" class="ltx_Math" display="inline" id="S5.SS2.p2.10.m10.1"><semantics id="S5.SS2.p2.10.m10.1a"><mrow id="S5.SS2.p2.10.m10.1.1" xref="S5.SS2.p2.10.m10.1.1.cmml"><mi id="S5.SS2.p2.10.m10.1.1.2" xref="S5.SS2.p2.10.m10.1.1.2.cmml">k</mi><mo id="S5.SS2.p2.10.m10.1.1.1" xref="S5.SS2.p2.10.m10.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.10.m10.1.1.3" xref="S5.SS2.p2.10.m10.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.10.m10.1b"><apply id="S5.SS2.p2.10.m10.1.1.cmml" xref="S5.SS2.p2.10.m10.1.1"><eq id="S5.SS2.p2.10.m10.1.1.1.cmml" xref="S5.SS2.p2.10.m10.1.1.1"></eq><ci id="S5.SS2.p2.10.m10.1.1.2.cmml" xref="S5.SS2.p2.10.m10.1.1.2">𝑘</ci><cn id="S5.SS2.p2.10.m10.1.1.3.cmml" type="integer" xref="S5.SS2.p2.10.m10.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.10.m10.1c">k=20</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.10.m10.1d">italic_k = 20</annotation></semantics></math> was found to work best for RDM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx2" title="">Blattmann et al.(2022)Blattmann, Rombach, Oktay, Müller, and
Ommer</a>]</cite> and <math alttext="k=10" class="ltx_Math" display="inline" id="S5.SS2.p2.11.m11.1"><semantics id="S5.SS2.p2.11.m11.1a"><mrow id="S5.SS2.p2.11.m11.1.1" xref="S5.SS2.p2.11.m11.1.1.cmml"><mi id="S5.SS2.p2.11.m11.1.1.2" xref="S5.SS2.p2.11.m11.1.1.2.cmml">k</mi><mo id="S5.SS2.p2.11.m11.1.1.1" xref="S5.SS2.p2.11.m11.1.1.1.cmml">=</mo><mn id="S5.SS2.p2.11.m11.1.1.3" xref="S5.SS2.p2.11.m11.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.11.m11.1b"><apply id="S5.SS2.p2.11.m11.1.1.cmml" xref="S5.SS2.p2.11.m11.1.1"><eq id="S5.SS2.p2.11.m11.1.1.1.cmml" xref="S5.SS2.p2.11.m11.1.1.1"></eq><ci id="S5.SS2.p2.11.m11.1.1.2.cmml" xref="S5.SS2.p2.11.m11.1.1.2">𝑘</ci><cn id="S5.SS2.p2.11.m11.1.1.3.cmml" type="integer" xref="S5.SS2.p2.11.m11.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.11.m11.1c">k=10</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p2.11.m11.1d">italic_k = 10</annotation></semantics></math> worked best for RISSOLE. In addition, we also conduct an ablation experiment in Sec. <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.SS4.SSS1" title="5.4.1 Impact of Positional Information ‣ 5.4 Ablation ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">5.4.1</span></a> to assess RISSOLE’s performance when conditioned with positional information.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Unconditional Image Synthesis</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">Upon generating samples from our diffusion model, we observed a notable improvement in visual quality compared to the RDM baseline when constrained to roughly the same model size as RISSOLE. Despite its compact model size, the images generated by RISSOLE exhibit finer details, sharper features, and more realistic textures. This qualitative assessment is further supported by quantitative metrics, including the Fréchet Inception Distance (FID).</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#footnotex1" title="Table 1 ‣ 5.3 Unconditional Image Synthesis ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">1</span></a> presents the FID scores obtained by RISSOLE and the other baseline models on both the CelebA and ImageNet datasets. RISSOLE achieves significantly lower FID scores, indicating that its generated samples are more likely to be from the original dataset distribution. These results demonstrate that RISSOLE captures the intricate patterns and structures in the data and generates more realistic and coherent images than the other baselines with similar model sizes. To further illustrate the qualitative differences, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.F3" title="Figure 3 ‣ 5.3 Unconditional Image Synthesis ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">3</span></a> compares samples generated by RISSOLE, original images from both datasets and samples from the RDM baseline. As depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.F3" title="Figure 3 ‣ 5.3 Unconditional Image Synthesis ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">3</span></a>, RISSOLE produces noticeably better samples, closely resembling the characteristics of the original images. For fairness of comparisons, we aimed to ensure that the model sizes for RDM and RISSOLE are kept similar, as reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#footnotex1" title="Table 1 ‣ 5.3 Unconditional Image Synthesis ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">1</span></a>. To ensure roughly equal model sizes for RDM and RISSOLE, the U-net architecture used by RDM was suitably modified. However, note that because RDM still utilizes the entire image or latent space for training or sampling, it still requires a somewhat higher number of parameters under this constrained setting. Table <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#footnotex1" title="Table 1 ‣ 5.3 Unconditional Image Synthesis ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">1</span></a> shows that RISSOLE outperforms RDM on both datasets and Patch Diffusion on CelebA <math alttext="64\times 64" class="ltx_Math" display="inline" id="S5.SS3.p2.1.m1.1"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mn id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">64</mn><mo id="S5.SS3.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S5.SS3.p2.1.m1.1.1.1.cmml">×</mo><mn id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><times id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1"></times><cn id="S5.SS3.p2.1.m1.1.1.2.cmml" type="integer" xref="S5.SS3.p2.1.m1.1.1.2">64</cn><cn id="S5.SS3.p2.1.m1.1.1.3.cmml" type="integer" xref="S5.SS3.p2.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">64\times 64</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p2.1.m1.1d">64 × 64</annotation></semantics></math> <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>FID values for Patch Diffusion are from the original paper. No FID results for ImageNet100 were reported.</span></span></span>. When constrained to small model size, RDM struggles to model the full-sized images with high fidelity and faces difficulty producing coherent and interpretable sample outputs, as shown in the middle row of Fig. <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.F3" title="Figure 3 ‣ 5.3 Unconditional Image Synthesis ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">3</span></a>. In contrast, RISSOLE operates only on small-sized blocks and can, therefore, model these blocks more effectively despite its small model size.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Comparison of RISSOLE with RDM<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx2" title="">Blattmann et al.(2022)Blattmann, Rombach, Oktay, Müller, and
Ommer</a>]</cite>, Patch Diffusion<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx22" title="">Wang et al.(2023)Wang, Jiang, Zheng, Wang, He, Wang, Chen, and
Zhou</a>]</cite> and other variants of RISSOLE for unconditional image generation on ImageNet100 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#bib.bibx4" title="">Deng et al.(2009)Deng, Dong, Socher, Li, Li, and
Fei-Fei</a>]</cite>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><span class="ltx_note ltx_centering ltx_figure_panel ltx_role_footnotetext" id="footnotex1"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_note_type">footnotetext: </span>FID values for Patch Diffusion are from the original paper. No FID results for ImageNet100 were reported.</span></span></span></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S5.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.1.1">Model</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.2.1">CelebA</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.1.1.3.1">ImageNet100</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.1.2.1.1">RDM</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.1.2.1.2">32.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.1.2.1.3">60.61</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.3.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.3.2.1">Patch Diffusion</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.3.2.2">14.51</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.3.2.3">-</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.4.3.1">RISSOLE - RAG</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.4.3.2">23.45</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.4.3.3">29.59</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.5.4.1">RISSOLE + P</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.5.4.2">17.01</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.5.4.3">20.28</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.6.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.6.5.1">RISSOLE + Pos</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.1.6.5.2">11.61</td>
<td class="ltx_td ltx_align_center" id="S5.T1.1.6.5.3">14.59</td>
</tr>
<tr class="ltx_tr" id="S5.T1.1.7.6">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T1.1.7.6.1">RISSOLE</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T1.1.7.6.2"><span class="ltx_text ltx_font_bold" id="S5.T1.1.7.6.2.1">9.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.1.7.6.3"><span class="ltx_text ltx_font_bold" id="S5.T1.1.7.6.3.1">12.93</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
<figure class="ltx_figure" id="S5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="146" id="S5.F3.g1" src="extracted/5829184/Images/celeba_imagenet_original_baseline_ours.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Original Images (top row), and samples generated by the RDM baseline (middle row) and by RISSOLE (bottom row), trained on CelebA and ImageNet 100 datasets.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Ablation</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">We also conduct ablation studies to gain insights into the behavior and performance of RISSOLE under different configurations and settings. Specifically, we investigate the impact of varying the number of nearest neighbors retrieved from the database on the model’s performance, measured in terms of FID scores. We also vary the number of blocks into which the latent space should be divided to observe how the sampling quality changes. Furthermore, we discuss the impact of the retrieval augmented generation to empirically demonstrate how it helps in the coherence of the generated images.</p>
</div>
<section class="ltx_subsubsection" id="S5.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.1 </span>Impact of Positional Information</h4>
<div class="ltx_para" id="S5.SS4.SSS1.p1">
<p class="ltx_p" id="S5.SS4.SSS1.p1.4">In Section <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.SS1.SSS3" title="4.1.3 Block-wise DDPM Training ‣ 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">4.1.3</span></a>, we described how RISSOLE learns a specific segment of the latent space, <math alttext="z^{i}" class="ltx_Math" display="inline" id="S5.SS4.SSS1.p1.1.m1.1"><semantics id="S5.SS4.SSS1.p1.1.m1.1a"><msup id="S5.SS4.SSS1.p1.1.m1.1.1" xref="S5.SS4.SSS1.p1.1.m1.1.1.cmml"><mi id="S5.SS4.SSS1.p1.1.m1.1.1.2" xref="S5.SS4.SSS1.p1.1.m1.1.1.2.cmml">z</mi><mi id="S5.SS4.SSS1.p1.1.m1.1.1.3" xref="S5.SS4.SSS1.p1.1.m1.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p1.1.m1.1b"><apply id="S5.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS4.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS4.SSS1.p1.1.m1.1.1.1.cmml" xref="S5.SS4.SSS1.p1.1.m1.1.1">superscript</csymbol><ci id="S5.SS4.SSS1.p1.1.m1.1.1.2.cmml" xref="S5.SS4.SSS1.p1.1.m1.1.1.2">𝑧</ci><ci id="S5.SS4.SSS1.p1.1.m1.1.1.3.cmml" xref="S5.SS4.SSS1.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p1.1.m1.1c">z^{i}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.SSS1.p1.1.m1.1d">italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, by conditioning it with <math alttext="\mathcal{M}_{\mathcal{D}_{i}}^{(k)}" class="ltx_Math" display="inline" id="S5.SS4.SSS1.p1.2.m2.1"><semantics id="S5.SS4.SSS1.p1.2.m2.1a"><msubsup id="S5.SS4.SSS1.p1.2.m2.1.2" xref="S5.SS4.SSS1.p1.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.SSS1.p1.2.m2.1.2.2.2" xref="S5.SS4.SSS1.p1.2.m2.1.2.2.2.cmml">ℳ</mi><msub id="S5.SS4.SSS1.p1.2.m2.1.2.2.3" xref="S5.SS4.SSS1.p1.2.m2.1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.SSS1.p1.2.m2.1.2.2.3.2" xref="S5.SS4.SSS1.p1.2.m2.1.2.2.3.2.cmml">𝒟</mi><mi id="S5.SS4.SSS1.p1.2.m2.1.2.2.3.3" xref="S5.SS4.SSS1.p1.2.m2.1.2.2.3.3.cmml">i</mi></msub><mrow id="S5.SS4.SSS1.p1.2.m2.1.1.1.3" xref="S5.SS4.SSS1.p1.2.m2.1.2.cmml"><mo id="S5.SS4.SSS1.p1.2.m2.1.1.1.3.1" stretchy="false" xref="S5.SS4.SSS1.p1.2.m2.1.2.cmml">(</mo><mi id="S5.SS4.SSS1.p1.2.m2.1.1.1.1" xref="S5.SS4.SSS1.p1.2.m2.1.1.1.1.cmml">k</mi><mo id="S5.SS4.SSS1.p1.2.m2.1.1.1.3.2" stretchy="false" xref="S5.SS4.SSS1.p1.2.m2.1.2.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p1.2.m2.1b"><apply id="S5.SS4.SSS1.p1.2.m2.1.2.cmml" xref="S5.SS4.SSS1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S5.SS4.SSS1.p1.2.m2.1.2.1.cmml" xref="S5.SS4.SSS1.p1.2.m2.1.2">superscript</csymbol><apply id="S5.SS4.SSS1.p1.2.m2.1.2.2.cmml" xref="S5.SS4.SSS1.p1.2.m2.1.2"><csymbol cd="ambiguous" id="S5.SS4.SSS1.p1.2.m2.1.2.2.1.cmml" xref="S5.SS4.SSS1.p1.2.m2.1.2">subscript</csymbol><ci id="S5.SS4.SSS1.p1.2.m2.1.2.2.2.cmml" xref="S5.SS4.SSS1.p1.2.m2.1.2.2.2">ℳ</ci><apply id="S5.SS4.SSS1.p1.2.m2.1.2.2.3.cmml" xref="S5.SS4.SSS1.p1.2.m2.1.2.2.3"><csymbol cd="ambiguous" id="S5.SS4.SSS1.p1.2.m2.1.2.2.3.1.cmml" xref="S5.SS4.SSS1.p1.2.m2.1.2.2.3">subscript</csymbol><ci id="S5.SS4.SSS1.p1.2.m2.1.2.2.3.2.cmml" xref="S5.SS4.SSS1.p1.2.m2.1.2.2.3.2">𝒟</ci><ci id="S5.SS4.SSS1.p1.2.m2.1.2.2.3.3.cmml" xref="S5.SS4.SSS1.p1.2.m2.1.2.2.3.3">𝑖</ci></apply></apply><ci id="S5.SS4.SSS1.p1.2.m2.1.1.1.1.cmml" xref="S5.SS4.SSS1.p1.2.m2.1.1.1.1">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p1.2.m2.1c">\mathcal{M}_{\mathcal{D}_{i}}^{(k)}</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.SSS1.p1.2.m2.1d">caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT</annotation></semantics></math>, while also integrating positional information, represented by <math alttext="i" class="ltx_Math" display="inline" id="S5.SS4.SSS1.p1.3.m3.1"><semantics id="S5.SS4.SSS1.p1.3.m3.1a"><mi id="S5.SS4.SSS1.p1.3.m3.1.1" xref="S5.SS4.SSS1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p1.3.m3.1b"><ci id="S5.SS4.SSS1.p1.3.m3.1.1.cmml" xref="S5.SS4.SSS1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p1.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.SSS1.p1.3.m3.1d">italic_i</annotation></semantics></math>. This section delves into the significance of positional information within RISSOLE, suggesting that such information might already be inherent in <math alttext="p_{\psi}(z^{i}|\mathcal{M}_{\mathcal{D}_{i}}^{(k)})" class="ltx_Math" display="inline" id="S5.SS4.SSS1.p1.4.m4.2"><semantics id="S5.SS4.SSS1.p1.4.m4.2a"><mrow id="S5.SS4.SSS1.p1.4.m4.2.2" xref="S5.SS4.SSS1.p1.4.m4.2.2.cmml"><msub id="S5.SS4.SSS1.p1.4.m4.2.2.3" xref="S5.SS4.SSS1.p1.4.m4.2.2.3.cmml"><mi id="S5.SS4.SSS1.p1.4.m4.2.2.3.2" xref="S5.SS4.SSS1.p1.4.m4.2.2.3.2.cmml">p</mi><mi id="S5.SS4.SSS1.p1.4.m4.2.2.3.3" xref="S5.SS4.SSS1.p1.4.m4.2.2.3.3.cmml">ψ</mi></msub><mo id="S5.SS4.SSS1.p1.4.m4.2.2.2" xref="S5.SS4.SSS1.p1.4.m4.2.2.2.cmml">⁢</mo><mrow id="S5.SS4.SSS1.p1.4.m4.2.2.1.1" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.cmml"><mo id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.2" stretchy="false" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.cmml">(</mo><mrow id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.cmml"><msup id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.cmml"><mi id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.2" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.2.cmml">z</mi><mi id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.3" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.3.cmml">i</mi></msup><mo fence="false" id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.1" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.1.cmml">|</mo><msubsup id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.2" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.2.cmml">ℳ</mi><msub id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.2" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.2.cmml">𝒟</mi><mi id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.3" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.3.cmml">i</mi></msub><mrow id="S5.SS4.SSS1.p1.4.m4.1.1.1.3" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.cmml"><mo id="S5.SS4.SSS1.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.cmml">(</mo><mi id="S5.SS4.SSS1.p1.4.m4.1.1.1.1" xref="S5.SS4.SSS1.p1.4.m4.1.1.1.1.cmml">k</mi><mo id="S5.SS4.SSS1.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.3" stretchy="false" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p1.4.m4.2b"><apply id="S5.SS4.SSS1.p1.4.m4.2.2.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2"><times id="S5.SS4.SSS1.p1.4.m4.2.2.2.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.2"></times><apply id="S5.SS4.SSS1.p1.4.m4.2.2.3.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.3"><csymbol cd="ambiguous" id="S5.SS4.SSS1.p1.4.m4.2.2.3.1.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.3">subscript</csymbol><ci id="S5.SS4.SSS1.p1.4.m4.2.2.3.2.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.3.2">𝑝</ci><ci id="S5.SS4.SSS1.p1.4.m4.2.2.3.3.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.3.3">𝜓</ci></apply><apply id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1"><csymbol cd="latexml" id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.1.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.1">conditional</csymbol><apply id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.1.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2">superscript</csymbol><ci id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.2.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.2">𝑧</ci><ci id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.3.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.2.3">𝑖</ci></apply><apply id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.1.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3">superscript</csymbol><apply id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.1.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3">subscript</csymbol><ci id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.2.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.2">ℳ</ci><apply id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.1.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3">subscript</csymbol><ci id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.2.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.2">𝒟</ci><ci id="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.3.cmml" xref="S5.SS4.SSS1.p1.4.m4.2.2.1.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S5.SS4.SSS1.p1.4.m4.1.1.1.1.cmml" xref="S5.SS4.SSS1.p1.4.m4.1.1.1.1">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p1.4.m4.2c">p_{\psi}(z^{i}|\mathcal{M}_{\mathcal{D}_{i}}^{(k)})</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.SSS1.p1.4.m4.2d">italic_p start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT | caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT )</annotation></semantics></math>. Hence, the model can represented by a modified version of Equation <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S4.E1" title="In 4.1.3 Block-wise DDPM Training ‣ 4.1 RISSOLE Training ‣ 4 Denoising Diffusion Models with Block-wise Generation ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">1</span></a>:</p>
</div>
<div class="ltx_para" id="S5.SS4.SSS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S5.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{\psi,\mathcal{D},\xi_{k}}(z)=\prod_{i=1}^{b-1}p_{\psi}(z^{i}|\{y|y\in%
\mathcal{M}_{\mathcal{D}_{i}}^{(k)}\},i)\vspace{-0.5em}" class="ltx_Math" display="block" id="S5.E3.m1.8"><semantics id="S5.E3.m1.8a"><mrow id="S5.E3.m1.8.8" xref="S5.E3.m1.8.8.cmml"><mrow id="S5.E3.m1.8.8.3" xref="S5.E3.m1.8.8.3.cmml"><msub id="S5.E3.m1.8.8.3.2" xref="S5.E3.m1.8.8.3.2.cmml"><mi id="S5.E3.m1.8.8.3.2.2" xref="S5.E3.m1.8.8.3.2.2.cmml">p</mi><mrow id="S5.E3.m1.3.3.3.3" xref="S5.E3.m1.3.3.3.4.cmml"><mi id="S5.E3.m1.1.1.1.1" xref="S5.E3.m1.1.1.1.1.cmml">ψ</mi><mo id="S5.E3.m1.3.3.3.3.2" xref="S5.E3.m1.3.3.3.4.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S5.E3.m1.2.2.2.2" xref="S5.E3.m1.2.2.2.2.cmml">𝒟</mi><mo id="S5.E3.m1.3.3.3.3.3" xref="S5.E3.m1.3.3.3.4.cmml">,</mo><msub id="S5.E3.m1.3.3.3.3.1" xref="S5.E3.m1.3.3.3.3.1.cmml"><mi id="S5.E3.m1.3.3.3.3.1.2" xref="S5.E3.m1.3.3.3.3.1.2.cmml">ξ</mi><mi id="S5.E3.m1.3.3.3.3.1.3" xref="S5.E3.m1.3.3.3.3.1.3.cmml">k</mi></msub></mrow></msub><mo id="S5.E3.m1.8.8.3.1" xref="S5.E3.m1.8.8.3.1.cmml">⁢</mo><mrow id="S5.E3.m1.8.8.3.3.2" xref="S5.E3.m1.8.8.3.cmml"><mo id="S5.E3.m1.8.8.3.3.2.1" stretchy="false" xref="S5.E3.m1.8.8.3.cmml">(</mo><mi id="S5.E3.m1.5.5" xref="S5.E3.m1.5.5.cmml">z</mi><mo id="S5.E3.m1.8.8.3.3.2.2" stretchy="false" xref="S5.E3.m1.8.8.3.cmml">)</mo></mrow></mrow><mo id="S5.E3.m1.8.8.2" rspace="0.111em" xref="S5.E3.m1.8.8.2.cmml">=</mo><mrow id="S5.E3.m1.8.8.1" xref="S5.E3.m1.8.8.1.cmml"><munderover id="S5.E3.m1.8.8.1.2" xref="S5.E3.m1.8.8.1.2.cmml"><mo id="S5.E3.m1.8.8.1.2.2.2" movablelimits="false" xref="S5.E3.m1.8.8.1.2.2.2.cmml">∏</mo><mrow id="S5.E3.m1.8.8.1.2.2.3" xref="S5.E3.m1.8.8.1.2.2.3.cmml"><mi id="S5.E3.m1.8.8.1.2.2.3.2" xref="S5.E3.m1.8.8.1.2.2.3.2.cmml">i</mi><mo id="S5.E3.m1.8.8.1.2.2.3.1" xref="S5.E3.m1.8.8.1.2.2.3.1.cmml">=</mo><mn id="S5.E3.m1.8.8.1.2.2.3.3" xref="S5.E3.m1.8.8.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S5.E3.m1.8.8.1.2.3" xref="S5.E3.m1.8.8.1.2.3.cmml"><mi id="S5.E3.m1.8.8.1.2.3.2" xref="S5.E3.m1.8.8.1.2.3.2.cmml">b</mi><mo id="S5.E3.m1.8.8.1.2.3.1" xref="S5.E3.m1.8.8.1.2.3.1.cmml">−</mo><mn id="S5.E3.m1.8.8.1.2.3.3" xref="S5.E3.m1.8.8.1.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S5.E3.m1.8.8.1.1" xref="S5.E3.m1.8.8.1.1.cmml"><msub id="S5.E3.m1.8.8.1.1.3" xref="S5.E3.m1.8.8.1.1.3.cmml"><mi id="S5.E3.m1.8.8.1.1.3.2" xref="S5.E3.m1.8.8.1.1.3.2.cmml">p</mi><mi id="S5.E3.m1.8.8.1.1.3.3" xref="S5.E3.m1.8.8.1.1.3.3.cmml">ψ</mi></msub><mo id="S5.E3.m1.8.8.1.1.2" xref="S5.E3.m1.8.8.1.1.2.cmml">⁢</mo><mrow id="S5.E3.m1.8.8.1.1.1.1" xref="S5.E3.m1.8.8.1.1.1.1.1.cmml"><mo id="S5.E3.m1.8.8.1.1.1.1.2" stretchy="false" xref="S5.E3.m1.8.8.1.1.1.1.1.cmml">(</mo><mrow id="S5.E3.m1.8.8.1.1.1.1.1" xref="S5.E3.m1.8.8.1.1.1.1.1.cmml"><msup id="S5.E3.m1.8.8.1.1.1.1.1.3" xref="S5.E3.m1.8.8.1.1.1.1.1.3.cmml"><mi id="S5.E3.m1.8.8.1.1.1.1.1.3.2" xref="S5.E3.m1.8.8.1.1.1.1.1.3.2.cmml">z</mi><mi id="S5.E3.m1.8.8.1.1.1.1.1.3.3" xref="S5.E3.m1.8.8.1.1.1.1.1.3.3.cmml">i</mi></msup><mo fence="false" id="S5.E3.m1.8.8.1.1.1.1.1.2" xref="S5.E3.m1.8.8.1.1.1.1.1.2.cmml">|</mo><mrow id="S5.E3.m1.8.8.1.1.1.1.1.1.1" xref="S5.E3.m1.8.8.1.1.1.1.1.1.2.cmml"><mrow id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.2.cmml"><mo id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml">{</mo><mi id="S5.E3.m1.6.6" xref="S5.E3.m1.6.6.cmml">y</mi><mo id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml">∈</mo><msubsup id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">ℳ</mi><msub id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">𝒟</mi><mi id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">i</mi></msub><mrow id="S5.E3.m1.4.4.1.3" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml"><mo id="S5.E3.m1.4.4.1.3.1" stretchy="false" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml">(</mo><mi id="S5.E3.m1.4.4.1.1" xref="S5.E3.m1.4.4.1.1.cmml">k</mi><mo id="S5.E3.m1.4.4.1.3.2" stretchy="false" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml">)</mo></mrow></msubsup></mrow><mo id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml">}</mo></mrow><mo id="S5.E3.m1.8.8.1.1.1.1.1.1.1.2" xref="S5.E3.m1.8.8.1.1.1.1.1.1.2.cmml">,</mo><mi id="S5.E3.m1.7.7" xref="S5.E3.m1.7.7.cmml">i</mi></mrow></mrow><mo id="S5.E3.m1.8.8.1.1.1.1.3" stretchy="false" xref="S5.E3.m1.8.8.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E3.m1.8b"><apply id="S5.E3.m1.8.8.cmml" xref="S5.E3.m1.8.8"><eq id="S5.E3.m1.8.8.2.cmml" xref="S5.E3.m1.8.8.2"></eq><apply id="S5.E3.m1.8.8.3.cmml" xref="S5.E3.m1.8.8.3"><times id="S5.E3.m1.8.8.3.1.cmml" xref="S5.E3.m1.8.8.3.1"></times><apply id="S5.E3.m1.8.8.3.2.cmml" xref="S5.E3.m1.8.8.3.2"><csymbol cd="ambiguous" id="S5.E3.m1.8.8.3.2.1.cmml" xref="S5.E3.m1.8.8.3.2">subscript</csymbol><ci id="S5.E3.m1.8.8.3.2.2.cmml" xref="S5.E3.m1.8.8.3.2.2">𝑝</ci><list id="S5.E3.m1.3.3.3.4.cmml" xref="S5.E3.m1.3.3.3.3"><ci id="S5.E3.m1.1.1.1.1.cmml" xref="S5.E3.m1.1.1.1.1">𝜓</ci><ci id="S5.E3.m1.2.2.2.2.cmml" xref="S5.E3.m1.2.2.2.2">𝒟</ci><apply id="S5.E3.m1.3.3.3.3.1.cmml" xref="S5.E3.m1.3.3.3.3.1"><csymbol cd="ambiguous" id="S5.E3.m1.3.3.3.3.1.1.cmml" xref="S5.E3.m1.3.3.3.3.1">subscript</csymbol><ci id="S5.E3.m1.3.3.3.3.1.2.cmml" xref="S5.E3.m1.3.3.3.3.1.2">𝜉</ci><ci id="S5.E3.m1.3.3.3.3.1.3.cmml" xref="S5.E3.m1.3.3.3.3.1.3">𝑘</ci></apply></list></apply><ci id="S5.E3.m1.5.5.cmml" xref="S5.E3.m1.5.5">𝑧</ci></apply><apply id="S5.E3.m1.8.8.1.cmml" xref="S5.E3.m1.8.8.1"><apply id="S5.E3.m1.8.8.1.2.cmml" xref="S5.E3.m1.8.8.1.2"><csymbol cd="ambiguous" id="S5.E3.m1.8.8.1.2.1.cmml" xref="S5.E3.m1.8.8.1.2">superscript</csymbol><apply id="S5.E3.m1.8.8.1.2.2.cmml" xref="S5.E3.m1.8.8.1.2"><csymbol cd="ambiguous" id="S5.E3.m1.8.8.1.2.2.1.cmml" xref="S5.E3.m1.8.8.1.2">subscript</csymbol><csymbol cd="latexml" id="S5.E3.m1.8.8.1.2.2.2.cmml" xref="S5.E3.m1.8.8.1.2.2.2">product</csymbol><apply id="S5.E3.m1.8.8.1.2.2.3.cmml" xref="S5.E3.m1.8.8.1.2.2.3"><eq id="S5.E3.m1.8.8.1.2.2.3.1.cmml" xref="S5.E3.m1.8.8.1.2.2.3.1"></eq><ci id="S5.E3.m1.8.8.1.2.2.3.2.cmml" xref="S5.E3.m1.8.8.1.2.2.3.2">𝑖</ci><cn id="S5.E3.m1.8.8.1.2.2.3.3.cmml" type="integer" xref="S5.E3.m1.8.8.1.2.2.3.3">1</cn></apply></apply><apply id="S5.E3.m1.8.8.1.2.3.cmml" xref="S5.E3.m1.8.8.1.2.3"><minus id="S5.E3.m1.8.8.1.2.3.1.cmml" xref="S5.E3.m1.8.8.1.2.3.1"></minus><ci id="S5.E3.m1.8.8.1.2.3.2.cmml" xref="S5.E3.m1.8.8.1.2.3.2">𝑏</ci><cn id="S5.E3.m1.8.8.1.2.3.3.cmml" type="integer" xref="S5.E3.m1.8.8.1.2.3.3">1</cn></apply></apply><apply id="S5.E3.m1.8.8.1.1.cmml" xref="S5.E3.m1.8.8.1.1"><times id="S5.E3.m1.8.8.1.1.2.cmml" xref="S5.E3.m1.8.8.1.1.2"></times><apply id="S5.E3.m1.8.8.1.1.3.cmml" xref="S5.E3.m1.8.8.1.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.8.8.1.1.3.1.cmml" xref="S5.E3.m1.8.8.1.1.3">subscript</csymbol><ci id="S5.E3.m1.8.8.1.1.3.2.cmml" xref="S5.E3.m1.8.8.1.1.3.2">𝑝</ci><ci id="S5.E3.m1.8.8.1.1.3.3.cmml" xref="S5.E3.m1.8.8.1.1.3.3">𝜓</ci></apply><apply id="S5.E3.m1.8.8.1.1.1.1.1.cmml" xref="S5.E3.m1.8.8.1.1.1.1"><csymbol cd="latexml" id="S5.E3.m1.8.8.1.1.1.1.1.2.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.2">conditional</csymbol><apply id="S5.E3.m1.8.8.1.1.1.1.1.3.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.8.8.1.1.1.1.1.3.1.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.3">superscript</csymbol><ci id="S5.E3.m1.8.8.1.1.1.1.1.3.2.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.3.2">𝑧</ci><ci id="S5.E3.m1.8.8.1.1.1.1.1.3.3.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.3.3">𝑖</ci></apply><list id="S5.E3.m1.8.8.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1"><apply id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.2">conditional-set</csymbol><ci id="S5.E3.m1.6.6.cmml" xref="S5.E3.m1.6.6">𝑦</ci><apply id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1"><in id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.1"></in><ci id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.2">ℳ</ci><apply id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.2">𝒟</ci><ci id="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S5.E3.m1.8.8.1.1.1.1.1.1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><ci id="S5.E3.m1.4.4.1.1.cmml" xref="S5.E3.m1.4.4.1.1">𝑘</ci></apply></apply></apply><ci id="S5.E3.m1.7.7.cmml" xref="S5.E3.m1.7.7">𝑖</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E3.m1.8c">p_{\psi,\mathcal{D},\xi_{k}}(z)=\prod_{i=1}^{b-1}p_{\psi}(z^{i}|\{y|y\in%
\mathcal{M}_{\mathcal{D}_{i}}^{(k)}\},i)\vspace{-0.5em}</annotation><annotation encoding="application/x-llamapun" id="S5.E3.m1.8d">italic_p start_POSTSUBSCRIPT italic_ψ , caligraphic_D , italic_ξ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_z ) = ∏ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT italic_p start_POSTSUBSCRIPT italic_ψ end_POSTSUBSCRIPT ( italic_z start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT | { italic_y | italic_y ∈ caligraphic_M start_POSTSUBSCRIPT caligraphic_D start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_k ) end_POSTSUPERSCRIPT } , italic_i )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S5.SS4.SSS1.p3">
<p class="ltx_p" id="S5.SS4.SSS1.p3.1">The experiments are conducted using the CelebA dataset with a block count of <math alttext="b=4" class="ltx_Math" display="inline" id="S5.SS4.SSS1.p3.1.m1.1"><semantics id="S5.SS4.SSS1.p3.1.m1.1a"><mrow id="S5.SS4.SSS1.p3.1.m1.1.1" xref="S5.SS4.SSS1.p3.1.m1.1.1.cmml"><mi id="S5.SS4.SSS1.p3.1.m1.1.1.2" xref="S5.SS4.SSS1.p3.1.m1.1.1.2.cmml">b</mi><mo id="S5.SS4.SSS1.p3.1.m1.1.1.1" xref="S5.SS4.SSS1.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS4.SSS1.p3.1.m1.1.1.3" xref="S5.SS4.SSS1.p3.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.SSS1.p3.1.m1.1b"><apply id="S5.SS4.SSS1.p3.1.m1.1.1.cmml" xref="S5.SS4.SSS1.p3.1.m1.1.1"><eq id="S5.SS4.SSS1.p3.1.m1.1.1.1.cmml" xref="S5.SS4.SSS1.p3.1.m1.1.1.1"></eq><ci id="S5.SS4.SSS1.p3.1.m1.1.1.2.cmml" xref="S5.SS4.SSS1.p3.1.m1.1.1.2">𝑏</ci><cn id="S5.SS4.SSS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S5.SS4.SSS1.p3.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.SSS1.p3.1.m1.1c">b=4</annotation><annotation encoding="application/x-llamapun" id="S5.SS4.SSS1.p3.1.m1.1d">italic_b = 4</annotation></semantics></math>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.F4" title="Figure 4 ‣ 5.4.1 Impact of Positional Information ‣ 5.4 Ablation ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">4</span></a> demonstrates two sets of samples generated by RISSOLE; the upper row displays samples with included positional information, while the lower row exhibits samples without positional information. Observation of the figure visually confirms that samples generated from RISSOLE without positional conditioning exhibit sharper and more realistic characteristics compared to those with positional encoding. This phenomenon arises from the additional complexity introduced by positional encoding, making it more challenging for the model to estimate the underlying data distribution accurately. While the CelebA samples generated with positional conditioning yield an FID score of 11.93, as reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#footnotex1" title="Table 1 ‣ 5.3 Unconditional Image Synthesis ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">1</span></a> RISSOLE without positional encoding surpasses this with an FID of <span class="ltx_text ltx_font_bold" id="S5.SS4.SSS1.p3.1.1">9.82</span>. This finding substantiates our conjecture that retrieval-augmented generation and block-wise conditioning inherently preserve positional information, consequently enabling RISSOLE to be trained without explicit positional conditioning, thereby enhancing the model’s time efficiency.</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="128" id="S5.F4.g1" src="extracted/5829184/Images/celeba_posless.png" width="299"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Qualitative Samples from RISSOLE models where the input is conditioned with (top) and without (bottom) the positional information.</figcaption>
</figure>
<figure class="ltx_figure ltx_align_floatright" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="256" id="S5.F5.g1" src="extracted/5829184/Images/celeba_prev_ours.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="ltx_text" id="S5.F5.2.1" style="font-size:90%;">Samples from RISSOLE with (top) and without(bottom) using the previous block as a condition.</span></figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S5.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.2 </span>Using Previous Block as Additional Context</h4>
<div class="ltx_para" id="S5.SS4.SSS2.p1">
<p class="ltx_p" id="S5.SS4.SSS2.p1.1">We also explore conditioning on the previously generated block <em class="ltx_emph ltx_font_italic" id="S5.SS4.SSS2.p1.1.1">in addition to</em> the nearest neighbors from the external database and compare the model’s performance with and without this extra conditioning to assess its impact on image synthesis quality.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.F5" title="Figure 5 ‣ 5.4.1 Impact of Positional Information ‣ 5.4 Ablation ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">5</span></a> indicates that <em class="ltx_emph ltx_font_italic" id="S5.SS4.SSS2.p1.1.2">also</em> employing the previous block in conditioning results in a degradation in image quality compared to when it is not used. Specifically, samples generated without utilizing the previous block exhibit finer details, sharper features, and higher fidelity, indicating superior visual quality. FID scores of RISSOLE with the previous block serving as a context (RISSOLE-P) are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#footnotex1" title="Table 1 ‣ 5.3 Unconditional Image Synthesis ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">1</span></a>. Incorporating the previous block as a condition may impose limitations restricting the model’s capacity to comprehend the complete diversity and intricacy of the underlying data distribution. Conversely, training the model without any context from the preceding or other blocks enables the parallelization of the training process, resulting in enhanced speed.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S5.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">5.4.3 </span>Impact of RAG</h4>
<figure class="ltx_figure" id="S5.F6"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="256" id="S5.F6.g1" src="extracted/5829184/Images/celeba_ragless_ours.png" width="598"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="ltx_text" id="S5.F6.2.1" style="font-size:90%;">RISSOLE samples with (bottom) and without (top) using RAG</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS4.SSS3.p1">
<p class="ltx_p" id="S5.SS4.SSS3.p1.1">We examine the role of the retrieval augmented generation (RAG) mechanism in our diffusion model by comparing the generated samples with and without RAG in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#S5.F6" title="Figure 6 ‣ 5.4.3 Impact of RAG ‣ 5.4 Ablation ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">6</span></a>. When the RAG mechanism is omitted, we observe a degradation in image quality, resulting in incoherent and less visually appealing samples. Table <a class="ltx_ref" href="https://arxiv.org/html/2408.17095v2#footnotex1" title="Table 1 ‣ 5.3 Unconditional Image Synthesis ‣ 5 Experiments ‣ RISSOLE: Parameter-efficient Diffusion Models via Block-wise Generation and Retrieval-Guidance"><span class="ltx_text ltx_ref_tag">1</span></a> shows the FID scores of a RISSOLE model trained without RAG conditioning, which quantitatively confirms the same.</p>
</div>
<div class="ltx_para" id="S5.SS4.SSS3.p2">
<p class="ltx_p" id="S5.SS4.SSS3.p2.1">Incorporating the RAG mechanism is crucial in guiding the block-wise diffusion process and ensuring the coherence and realism of generated images. The retrieved neighbors offer a comprehensive view of the image, aiding the model in generating coherent images block-by-block without needing explicit information about previous blocks. Conditioning the noise on retrieved nearest neighbors through RAG ensures consistency and structural integrity, enhancing the overall fidelity of the synthesized images.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we presented a block-based retrieval-augmented generation (RAG) as an effective solution for the growing model size of denoising diffusion models. The inclusion of RAG addresses any consistency issues in block-wise image generation. We demonstrate improved spatial and semantic coherence in the generated images by leveraging RAG within a block-wise denoising diffusion model. Our approach, which conditions each image block on a corresponding block from a reference set retrieved from an external database, effectively mitigates the challenges associated with block-wise generation. Our experiments and analysis show that RAG can enhance the quality of block-wise generated images while reducing computational complexity and model size. This approach offers a promising alternative for resource-constrained settings where deploying large generative models may not be feasible. Further research can explore extensions and optimizations of RAG-based block-wise generation methods. Additionally, investigating the applicability of our approach to other domains beyond image generation could uncover new opportunities for leveraging retrieval-augmented techniques for enhanced generative modeling.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bibx1">
<span class="ltx_tag ltx_tag_bibitem">[Ba et al.(2016)Ba, Kiros, and Hinton]</span>
<span class="ltx_bibblock">
Jimmy Lei Ba, Jamie Ryan Kiros, and Geoffrey E. Hinton.

</span>
<span class="ltx_bibblock">Layer normalization, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx2">
<span class="ltx_tag ltx_tag_bibitem">[Blattmann et al.(2022)Blattmann, Rombach, Oktay, Müller, and
Ommer]</span>
<span class="ltx_bibblock">
Andreas Blattmann, Robin Rombach, Kaan Oktay, Jonas Müller, and Björn
Ommer.

</span>
<span class="ltx_bibblock">Semi-parametric neural image synthesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx2.1.1">arXiv preprint arXiv:2204.11824</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx3">
<span class="ltx_tag ltx_tag_bibitem">[Chu et al.(2020)Chu, Xie, Mayer, Leal-Taixé, and
Thuerey]</span>
<span class="ltx_bibblock">
Mengyu Chu, You Xie, Jonas Mayer, Laura Leal-Taixé, and Nils Thuerey.

</span>
<span class="ltx_bibblock">Learning temporal coherence via self-supervision for gan-based video
generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx3.1.1">ACM Transactions on Graphics (TOG)</em>, 39(4):75–1, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx4">
<span class="ltx_tag ltx_tag_bibitem">[Deng et al.(2009)Deng, Dong, Socher, Li, Li, and
Fei-Fei]</span>
<span class="ltx_bibblock">
Jia Deng, Wei Dong, Richard Socher, Li-Jia Li, Kai Li, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bibx4.1.1">2009 IEEE conference on computer vision and pattern
recognition</em>, pages 248–255. Ieee, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx5">
<span class="ltx_tag ltx_tag_bibitem">[Dhariwal and Nichol(2021)]</span>
<span class="ltx_bibblock">
Prafulla Dhariwal and Alexander Nichol.

</span>
<span class="ltx_bibblock">Diffusion models beat gans on image synthesis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx5.1.1">Advances in neural information processing systems</em>,
34:8780–8794, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx6">
<span class="ltx_tag ltx_tag_bibitem">[Ding et al.(2023)Ding, Zhang, Wu, and Tu]</span>
<span class="ltx_bibblock">
Zheng Ding, Mengqi Zhang, Jiajun Wu, and Zhuowen Tu.

</span>
<span class="ltx_bibblock">Patched denoising diffusion models for high-resolution image
synthesis, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx7">
<span class="ltx_tag ltx_tag_bibitem">[Ding et al.(2024)Ding, Zhang, Wu, and Tu]</span>
<span class="ltx_bibblock">
Zheng Ding, Mengqi Zhang, Jiajun Wu, and Zhuowen Tu.

</span>
<span class="ltx_bibblock">Patched denoising diffusion models for high-resolution image
synthesis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bibx7.1.1">The Twelfth International Conference on Learning
Representations</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx8">
<span class="ltx_tag ltx_tag_bibitem">[Esser et al.(2021)Esser, Rombach, and Ommer]</span>
<span class="ltx_bibblock">
Patrick Esser, Robin Rombach, and Bjorn Ommer.

</span>
<span class="ltx_bibblock">Taming transformers for high-resolution image synthesis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bibx8.1.1">Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition</em>, pages 12873–12883, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx9">
<span class="ltx_tag ltx_tag_bibitem">[Guo et al.(2020)Guo, Sun, Lindgren, Geng, Simcha, Chern, and
Kumar]</span>
<span class="ltx_bibblock">
Ruiqi Guo, Philip Sun, Erik Lindgren, Quan Geng, David Simcha, Felix Chern, and
Sanjiv Kumar.

</span>
<span class="ltx_bibblock">Accelerating large-scale inference with anisotropic vector
quantization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bibx9.1.1">International Conference on Machine Learning</em>, pages
3887–3896. PMLR, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx10">
<span class="ltx_tag ltx_tag_bibitem">[Ho et al.(2020)Ho, Jain, and Abbeel]</span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Denoising diffusion probabilistic models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx10.1.1">Advances in neural information processing systems</em>,
33:6840–6851, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx11">
<span class="ltx_tag ltx_tag_bibitem">[Kong and Ping(2021)]</span>
<span class="ltx_bibblock">
Zhifeng Kong and Wei Ping.

</span>
<span class="ltx_bibblock">On fast sampling of diffusion probabilistic models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx11.1.1">arXiv preprint arXiv:2106.00132</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx12">
<span class="ltx_tag ltx_tag_bibitem">[Liu et al.(2015)Liu, Luo, Wang, and Tang]</span>
<span class="ltx_bibblock">
Ziwei Liu, Ping Luo, Xiaogang Wang, and Xiaoou Tang.

</span>
<span class="ltx_bibblock">Deep learning face attributes in the wild.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bibx12.1.1">Proceedings of International Conference on Computer Vision
(ICCV)</em>, December 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx13">
<span class="ltx_tag ltx_tag_bibitem">[Ramesh et al.(2021)Ramesh, Pavlov, Goh, Gray, Voss, Radford, Chen, and
Sutskever]</span>
<span class="ltx_bibblock">
Aditya Ramesh, Mikhail Pavlov, Gabriel Goh, Scott Gray, Chelsea Voss, Alec
Radford, Mark Chen, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Zero-shot text-to-image generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bibx13.1.1">International Conference on Machine Learning</em>, pages
8821–8831. PMLR, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx14">
<span class="ltx_tag ltx_tag_bibitem">[Rombach et al.(2022)Rombach, Blattmann, Lorenz, Esser, and
Ommer]</span>
<span class="ltx_bibblock">
Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn
Ommer.

</span>
<span class="ltx_bibblock">High-resolution image synthesis with latent diffusion models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bibx14.1.1">Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition</em>, pages 10684–10695, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx15">
<span class="ltx_tag ltx_tag_bibitem">[Ronneberger et al.(2015)Ronneberger, Fischer, and
Brox]</span>
<span class="ltx_bibblock">
Olaf Ronneberger, Philipp Fischer, and Thomas Brox.

</span>
<span class="ltx_bibblock">U-net: Convolutional networks for biomedical image segmentation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bibx15.1.1">Medical image computing and computer-assisted
intervention–MICCAI 2015: 18th international conference, Munich, Germany,
October 5-9, 2015, proceedings, part III 18</em>, pages 234–241. Springer, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx16">
<span class="ltx_tag ltx_tag_bibitem">[San-Roman et al.(2021)San-Roman, Nachmani, and Wolf]</span>
<span class="ltx_bibblock">
Robin San-Roman, Eliya Nachmani, and Lior Wolf.

</span>
<span class="ltx_bibblock">Noise estimation for generative diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx16.1.1">arXiv preprint arXiv:2104.02600</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx17">
<span class="ltx_tag ltx_tag_bibitem">[Sauer et al.(2023)Sauer, Lorenz, Blattmann, and
Rombach]</span>
<span class="ltx_bibblock">
Axel Sauer, Dominik Lorenz, Andreas Blattmann, and Robin Rombach.

</span>
<span class="ltx_bibblock">Adversarial diffusion distillation, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx18">
<span class="ltx_tag ltx_tag_bibitem">[Sohl-Dickstein et al.(2015)Sohl-Dickstein, Weiss, Maheswaranathan, and
Ganguli]</span>
<span class="ltx_bibblock">
Jascha Sohl-Dickstein, Eric Weiss, Niru Maheswaranathan, and Surya Ganguli.

</span>
<span class="ltx_bibblock">Deep unsupervised learning using nonequilibrium thermodynamics.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bibx18.1.1">International conference on machine learning</em>, pages
2256–2265. PMLR, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx19">
<span class="ltx_tag ltx_tag_bibitem">[Song et al.(2020a)Song, Meng, and
Ermon]</span>
<span class="ltx_bibblock">
Jiaming Song, Chenlin Meng, and Stefano Ermon.

</span>
<span class="ltx_bibblock">Denoising diffusion implicit models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx19.1.1">arXiv preprint arXiv:2010.02502</em>, 2020a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx20">
<span class="ltx_tag ltx_tag_bibitem">[Song et al.(2020b)Song, Sohl-Dickstein, Kingma, Kumar,
Ermon, and Poole]</span>
<span class="ltx_bibblock">
Yang Song, Jascha Sohl-Dickstein, Diederik P Kingma, Abhishek Kumar, Stefano
Ermon, and Ben Poole.

</span>
<span class="ltx_bibblock">Score-based generative modeling through stochastic differential
equations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx20.1.1">arXiv preprint arXiv:2011.13456</em>, 2020b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx21">
<span class="ltx_tag ltx_tag_bibitem">[Song et al.(2023)Song, Dhariwal, Chen, and
Sutskever]</span>
<span class="ltx_bibblock">
Yang Song, Prafulla Dhariwal, Mark Chen, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Consistency models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx21.1.1">arXiv preprint arXiv:2303.01469</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx22">
<span class="ltx_tag ltx_tag_bibitem">[Wang et al.(2023)Wang, Jiang, Zheng, Wang, He, Wang, Chen, and
Zhou]</span>
<span class="ltx_bibblock">
Zhendong Wang, Yifan Jiang, Huangjie Zheng, Peihao Wang, Pengcheng He,
Zhangyang Wang, Weizhu Chen, and Mingyuan Zhou.

</span>
<span class="ltx_bibblock">Patch diffusion: Faster and more data-efficient training of diffusion
models, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx23">
<span class="ltx_tag ltx_tag_bibitem">[Xu et al.(2018)Xu, Ren, Zhang, Zeng, Cai, and
Sun]</span>
<span class="ltx_bibblock">
Jingjing Xu, Xuancheng Ren, Yi Zhang, Qi Zeng, Xiaoyan Cai, and Xu Sun.

</span>
<span class="ltx_bibblock">A skeleton-based model for promoting coherence among sentences in
narrative story generation.

</span>
<span class="ltx_bibblock">In Ellen Riloff, David Chiang, Julia Hockenmaier, and Jun’ichi
Tsujii, editors, <em class="ltx_emph ltx_font_italic" id="bib.bibx23.1.1">Proceedings of the 2018 Conference on Empirical
Methods in Natural Language Processing</em>, pages 4306–4315, Brussels, Belgium,
October-November 2018. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.18653/v1/D18-1462" title="">10.18653/v1/D18-1462</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://aclanthology.org/D18-1462" title="">https://aclanthology.org/D18-1462</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx24">
<span class="ltx_tag ltx_tag_bibitem">[Yang et al.(2023)Yang, Zhang, Song, Hong, Xu, Zhao, Zhang, Cui, and
Yang]</span>
<span class="ltx_bibblock">
Ling Yang, Zhilong Zhang, Yang Song, Shenda Hong, Runsheng Xu, Yue Zhao, Wentao
Zhang, Bin Cui, and Ming-Hsuan Yang.

</span>
<span class="ltx_bibblock">Diffusion models: A comprehensive survey of methods and applications.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx24.1.1">ACM Comput. Surv.</em>, 56(4), nov 2023.

</span>
<span class="ltx_bibblock">ISSN 0360-0300.

</span>
<span class="ltx_bibblock"><a class="ltx_ref" href="https:/doi.org/10.1145/3626235" title="">10.1145/3626235</a>.

</span>
<span class="ltx_bibblock">URL <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/3626235" title="">https://doi.org/10.1145/3626235</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bibx25">
<span class="ltx_tag ltx_tag_bibitem">[Zhao et al.(2024)Zhao, Zhang, Yu, Wang, Geng, Fu, Yang, Zhang, and
Cui]</span>
<span class="ltx_bibblock">
Penghao Zhao, Hailin Zhang, Qinhan Yu, Zhengren Wang, Yunteng Geng, Fangcheng
Fu, Ling Yang, Wentao Zhang, and Bin Cui.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for ai-generated content: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bibx25.1.1">arXiv preprint arXiv:2402.19473</em>, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep  2 20:33:42 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
