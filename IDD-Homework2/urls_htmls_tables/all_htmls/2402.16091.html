<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2402.16091] Bayesian Neural Network For Personalized Federated Learning Parameter Selection</title><meta property="og:description" content="Federated learning’s poor performance in the presence of heterogeneous data remains one of the most pressing issues in the field. Personalized federated learning departs from the conventional paradigm in which all clie…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bayesian Neural Network For Personalized Federated Learning Parameter Selection">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Bayesian Neural Network For Personalized Federated Learning Parameter Selection">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2402.16091">

<!--Generated on Tue Mar  5 14:52:10 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Bayesian Neural Network For Personalized Federated Learning Parameter Selection</h1>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated learning’s poor performance in the presence of heterogeneous data remains one of the most pressing issues in the field. Personalized federated learning departs from the conventional paradigm in which all clients employ the same model, instead striving to discover an individualized model for each client to address the heterogeneity in the data. One of such approach involves personalizing specific layers of neural networks. However, prior endeavors have not provided a dependable rationale, and some have selected personalized layers that are entirely distinct and conflicting. In this work, we take a step further by proposing personalization at the elemental level, rather than the traditional layer-level personalization. To select personalized parameters, we introduce Bayesian neural networks and rely on the uncertainty they offer to guide our selection of personalized parameters. Finally, we validate our algorithm’s efficacy on several real-world datasets, demonstrating that our proposed approach outperforms existing baselines.</p>
</div>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span id="p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Index Terms<span id="p1.1.1.1" class="ltx_text ltx_font_upright">— </span></span>
Federated Learning, Bayesian Neural Network, Distributed Learning</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Recent artificial intelligence algorithms are predominantly data-driven, where the quantity of data plays a pivotal role in determining the effectiveness of these algorithms. However, the escalating awareness of security concerns and the increasingly stringent privacy regulations compel researchers and enterprises to seek methods that allow for training without compromising privacy. Federated learning emerges as a viable solution. It introduces a collaborative training approach without direct access to clients’ raw data. Among the most favored algorithms within federated learning research is FedAvg<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. This method involves averaging client models after multiple rounds of local training to obtain a global model. Due to its efficiency in communication, FedAvg outperforms FedSGD, as it eliminates the need for communication in every round.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<p id="S1.F1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S1.F1.1.1" class="ltx_text"><img src="/html/2402.16091/assets/x1.png" id="S1.F1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="257" height="138" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.3.1.1" class="ltx_text ltx_font_bold">Fig. 1</span>: </span>FedAvg aggregates client models through averaging to obtain a global model, which is subsequently distributed to clients for training.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">However, recent experiments have unveiled the shortcomings of FedAvg. When client data distributions deviate from being independently and identically distributed (non-IID), the algorithm’s performance experiences a sharp decline<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. To address this issue, several algorithms have sought to enhance FedAvg. FedProx employs a proximal term to constrain client training, ensuring that their models do not deviate excessively from the global model<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Meanwhile, SCAFFOLD employs control variables to rectify client drift<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Another category of methods, known as Personalized Federated Learning (PFL), departs from some fundamental aspects of FedAvg. Instead of striving for a global optimum model, PFL seeks to provide each client with a personalized model to excel in their local data context. Given the complexity of real-world data and the diverse situations faced by individual clients, PFL aligns more closely with reality. A key consideration for a PFL algorithm lies in managing the interplay between shared knowledge and client-specific expertise. It must strike a balance between gaining advantages through collaborative training and effectively adapting to the unique challenges faced by each client.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Prototype-based PFL aggregates client prototypes as common knowledge and utilizes global prototypes to guide client training<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Meanwhile, clustering-based algorithms posit that common knowledge exists among similar clients, aggregating clients within the same class<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Meta-learning-based algorithms employ a meta-learner as common knowledge to instruct client learning<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. The most prevalent approach involves personalization of model parameters, with a focus on layer-wise personalization. Algorithms such as FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and LG-FedAVG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> personalize the model’s feature extractor and classifier layers. These two algorithms have divergent opinions on which layers should be personalized, emphasizing the urgent need for an interpretable personalized parameters selection scheme.</p>
</div>
<figure id="S1.F2" class="ltx_figure">
<p id="S1.F2.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S1.F2.1.1" class="ltx_text"><img src="/html/2402.16091/assets/x2.png" id="S1.F2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="257" height="116" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.3.1.1" class="ltx_text ltx_font_bold">Fig. 2</span>: </span>LG-FedAvg and FedPer diverge in their perspectives on which parts of the model should be personalized. LG-FedAvg posits that the feature extractor constitutes the personalized layer, whereas FedPer contends that the classifier serves as the personalized layer.</figcaption>
</figure>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To address this issue, we propose a simple yet effective approach that leverages the uncertainty of Bayesian neural networks to select personalized parameters. Parameters with higher uncertainty indicate a greater scope for improvement, with changes in these parameters exerting minimal impact on the final outcome compared to others. In the context of federated learning, the uncertainty of the global model also carries new significance. When employing model aggregation methods based on KL divergence, the global model’s uncertainty encompasses the discrepancies among client models regarding the parameters. Consequently, parameters with higher uncertainty signify those where a consensus cannot be easily reached. We designate parameters with room for improvement and those exhibiting substantial client-to-client discrepancies as personalized parameters.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Through experiments conducted on various benchmark datasets, we have demonstrated the superiority of our method over FedPer and LG-FedAvg. This underscores the rationality of our approach to personalized parameters selection, which outperforms previous layer-based personalization techniques.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Problem Setting</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.10" class="ltx_p">Suppose we have <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">N</annotation></semantics></math> clients and a central server. In personalized FL, each client has its distinct dataset, denoted as <math id="S2.p1.2.m2.3" class="ltx_Math" alttext="\mathcal{D}_{1},\ldots,\mathcal{D}_{N}" display="inline"><semantics id="S2.p1.2.m2.3a"><mrow id="S2.p1.2.m2.3.3.2" xref="S2.p1.2.m2.3.3.3.cmml"><msub id="S2.p1.2.m2.2.2.1.1" xref="S2.p1.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.2.2.1.1.2" xref="S2.p1.2.m2.2.2.1.1.2.cmml">𝒟</mi><mn id="S2.p1.2.m2.2.2.1.1.3" xref="S2.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.p1.2.m2.3.3.2.3" xref="S2.p1.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">…</mi><mo id="S2.p1.2.m2.3.3.2.4" xref="S2.p1.2.m2.3.3.3.cmml">,</mo><msub id="S2.p1.2.m2.3.3.2.2" xref="S2.p1.2.m2.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.3.3.2.2.2" xref="S2.p1.2.m2.3.3.2.2.2.cmml">𝒟</mi><mi id="S2.p1.2.m2.3.3.2.2.3" xref="S2.p1.2.m2.3.3.2.2.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.3b"><list id="S2.p1.2.m2.3.3.3.cmml" xref="S2.p1.2.m2.3.3.2"><apply id="S2.p1.2.m2.2.2.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.2.2.1.1.1.cmml" xref="S2.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S2.p1.2.m2.2.2.1.1.2.cmml" xref="S2.p1.2.m2.2.2.1.1.2">𝒟</ci><cn type="integer" id="S2.p1.2.m2.2.2.1.1.3.cmml" xref="S2.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">…</ci><apply id="S2.p1.2.m2.3.3.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.p1.2.m2.3.3.2.2.1.cmml" xref="S2.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S2.p1.2.m2.3.3.2.2.2.cmml" xref="S2.p1.2.m2.3.3.2.2.2">𝒟</ci><ci id="S2.p1.2.m2.3.3.2.2.3.cmml" xref="S2.p1.2.m2.3.3.2.2.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.3c">\mathcal{D}_{1},\ldots,\mathcal{D}_{N}</annotation></semantics></math>. Here, <math id="S2.p1.3.m3.2" class="ltx_Math" alttext="\mathcal{D}_{i}={(x_{n},y_{n})}_{n=1}^{N{i}}" display="inline"><semantics id="S2.p1.3.m3.2a"><mrow id="S2.p1.3.m3.2.2" xref="S2.p1.3.m3.2.2.cmml"><msub id="S2.p1.3.m3.2.2.4" xref="S2.p1.3.m3.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.2.2.4.2" xref="S2.p1.3.m3.2.2.4.2.cmml">𝒟</mi><mi id="S2.p1.3.m3.2.2.4.3" xref="S2.p1.3.m3.2.2.4.3.cmml">i</mi></msub><mo id="S2.p1.3.m3.2.2.3" xref="S2.p1.3.m3.2.2.3.cmml">=</mo><msubsup id="S2.p1.3.m3.2.2.2" xref="S2.p1.3.m3.2.2.2.cmml"><mrow id="S2.p1.3.m3.2.2.2.2.2.2" xref="S2.p1.3.m3.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.p1.3.m3.2.2.2.2.2.2.3" xref="S2.p1.3.m3.2.2.2.2.2.3.cmml">(</mo><msub id="S2.p1.3.m3.1.1.1.1.1.1.1" xref="S2.p1.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S2.p1.3.m3.1.1.1.1.1.1.1.2" xref="S2.p1.3.m3.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.p1.3.m3.1.1.1.1.1.1.1.3" xref="S2.p1.3.m3.1.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S2.p1.3.m3.2.2.2.2.2.2.4" xref="S2.p1.3.m3.2.2.2.2.2.3.cmml">,</mo><msub id="S2.p1.3.m3.2.2.2.2.2.2.2" xref="S2.p1.3.m3.2.2.2.2.2.2.2.cmml"><mi id="S2.p1.3.m3.2.2.2.2.2.2.2.2" xref="S2.p1.3.m3.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S2.p1.3.m3.2.2.2.2.2.2.2.3" xref="S2.p1.3.m3.2.2.2.2.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S2.p1.3.m3.2.2.2.2.2.2.5" xref="S2.p1.3.m3.2.2.2.2.2.3.cmml">)</mo></mrow><mrow id="S2.p1.3.m3.2.2.2.2.4" xref="S2.p1.3.m3.2.2.2.2.4.cmml"><mi id="S2.p1.3.m3.2.2.2.2.4.2" xref="S2.p1.3.m3.2.2.2.2.4.2.cmml">n</mi><mo id="S2.p1.3.m3.2.2.2.2.4.1" xref="S2.p1.3.m3.2.2.2.2.4.1.cmml">=</mo><mn id="S2.p1.3.m3.2.2.2.2.4.3" xref="S2.p1.3.m3.2.2.2.2.4.3.cmml">1</mn></mrow><mrow id="S2.p1.3.m3.2.2.2.4" xref="S2.p1.3.m3.2.2.2.4.cmml"><mi id="S2.p1.3.m3.2.2.2.4.2" xref="S2.p1.3.m3.2.2.2.4.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.p1.3.m3.2.2.2.4.1" xref="S2.p1.3.m3.2.2.2.4.1.cmml">​</mo><mi id="S2.p1.3.m3.2.2.2.4.3" xref="S2.p1.3.m3.2.2.2.4.3.cmml">i</mi></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.2b"><apply id="S2.p1.3.m3.2.2.cmml" xref="S2.p1.3.m3.2.2"><eq id="S2.p1.3.m3.2.2.3.cmml" xref="S2.p1.3.m3.2.2.3"></eq><apply id="S2.p1.3.m3.2.2.4.cmml" xref="S2.p1.3.m3.2.2.4"><csymbol cd="ambiguous" id="S2.p1.3.m3.2.2.4.1.cmml" xref="S2.p1.3.m3.2.2.4">subscript</csymbol><ci id="S2.p1.3.m3.2.2.4.2.cmml" xref="S2.p1.3.m3.2.2.4.2">𝒟</ci><ci id="S2.p1.3.m3.2.2.4.3.cmml" xref="S2.p1.3.m3.2.2.4.3">𝑖</ci></apply><apply id="S2.p1.3.m3.2.2.2.cmml" xref="S2.p1.3.m3.2.2.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.2.2.2.3.cmml" xref="S2.p1.3.m3.2.2.2">superscript</csymbol><apply id="S2.p1.3.m3.2.2.2.2.cmml" xref="S2.p1.3.m3.2.2.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.2.2.2.2.3.cmml" xref="S2.p1.3.m3.2.2.2">subscript</csymbol><interval closure="open" id="S2.p1.3.m3.2.2.2.2.2.3.cmml" xref="S2.p1.3.m3.2.2.2.2.2.2"><apply id="S2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1.3">𝑛</ci></apply><apply id="S2.p1.3.m3.2.2.2.2.2.2.2.cmml" xref="S2.p1.3.m3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.3.m3.2.2.2.2.2.2.2.1.cmml" xref="S2.p1.3.m3.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.p1.3.m3.2.2.2.2.2.2.2.2.cmml" xref="S2.p1.3.m3.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S2.p1.3.m3.2.2.2.2.2.2.2.3.cmml" xref="S2.p1.3.m3.2.2.2.2.2.2.2.3">𝑛</ci></apply></interval><apply id="S2.p1.3.m3.2.2.2.2.4.cmml" xref="S2.p1.3.m3.2.2.2.2.4"><eq id="S2.p1.3.m3.2.2.2.2.4.1.cmml" xref="S2.p1.3.m3.2.2.2.2.4.1"></eq><ci id="S2.p1.3.m3.2.2.2.2.4.2.cmml" xref="S2.p1.3.m3.2.2.2.2.4.2">𝑛</ci><cn type="integer" id="S2.p1.3.m3.2.2.2.2.4.3.cmml" xref="S2.p1.3.m3.2.2.2.2.4.3">1</cn></apply></apply><apply id="S2.p1.3.m3.2.2.2.4.cmml" xref="S2.p1.3.m3.2.2.2.4"><times id="S2.p1.3.m3.2.2.2.4.1.cmml" xref="S2.p1.3.m3.2.2.2.4.1"></times><ci id="S2.p1.3.m3.2.2.2.4.2.cmml" xref="S2.p1.3.m3.2.2.2.4.2">𝑁</ci><ci id="S2.p1.3.m3.2.2.2.4.3.cmml" xref="S2.p1.3.m3.2.2.2.4.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.2c">\mathcal{D}_{i}={(x_{n},y_{n})}_{n=1}^{N{i}}</annotation></semantics></math> represents the labeled data of client <math id="S2.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.p1.4.m4.1a"><mi id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">i</annotation></semantics></math>. Our model is denoted as <math id="S2.p1.5.m5.1" class="ltx_Math" alttext="f_{w}\colon\mathcal{X}\to\mathcal{Y}" display="inline"><semantics id="S2.p1.5.m5.1a"><mrow id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml"><msub id="S2.p1.5.m5.1.1.2" xref="S2.p1.5.m5.1.1.2.cmml"><mi id="S2.p1.5.m5.1.1.2.2" xref="S2.p1.5.m5.1.1.2.2.cmml">f</mi><mi id="S2.p1.5.m5.1.1.2.3" xref="S2.p1.5.m5.1.1.2.3.cmml">w</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S2.p1.5.m5.1.1.1" xref="S2.p1.5.m5.1.1.1.cmml">:</mo><mrow id="S2.p1.5.m5.1.1.3" xref="S2.p1.5.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m5.1.1.3.2" xref="S2.p1.5.m5.1.1.3.2.cmml">𝒳</mi><mo stretchy="false" id="S2.p1.5.m5.1.1.3.1" xref="S2.p1.5.m5.1.1.3.1.cmml">→</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m5.1.1.3.3" xref="S2.p1.5.m5.1.1.3.3.cmml">𝒴</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1"><ci id="S2.p1.5.m5.1.1.1.cmml" xref="S2.p1.5.m5.1.1.1">:</ci><apply id="S2.p1.5.m5.1.1.2.cmml" xref="S2.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.2.1.cmml" xref="S2.p1.5.m5.1.1.2">subscript</csymbol><ci id="S2.p1.5.m5.1.1.2.2.cmml" xref="S2.p1.5.m5.1.1.2.2">𝑓</ci><ci id="S2.p1.5.m5.1.1.2.3.cmml" xref="S2.p1.5.m5.1.1.2.3">𝑤</ci></apply><apply id="S2.p1.5.m5.1.1.3.cmml" xref="S2.p1.5.m5.1.1.3"><ci id="S2.p1.5.m5.1.1.3.1.cmml" xref="S2.p1.5.m5.1.1.3.1">→</ci><ci id="S2.p1.5.m5.1.1.3.2.cmml" xref="S2.p1.5.m5.1.1.3.2">𝒳</ci><ci id="S2.p1.5.m5.1.1.3.3.cmml" xref="S2.p1.5.m5.1.1.3.3">𝒴</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">f_{w}\colon\mathcal{X}\to\mathcal{Y}</annotation></semantics></math>, where <math id="S2.p1.6.m6.1" class="ltx_Math" alttext="w\in\mathbb{W}" display="inline"><semantics id="S2.p1.6.m6.1a"><mrow id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">w</mi><mo id="S2.p1.6.m6.1.1.1" xref="S2.p1.6.m6.1.1.1.cmml">∈</mo><mi id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml">𝕎</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><in id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1.1"></in><ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝑤</ci><ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">𝕎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">w\in\mathbb{W}</annotation></semantics></math> represents the model parameters, and we employ the loss function <math id="S2.p1.7.m7.1" class="ltx_Math" alttext="\ell\colon\mathcal{X}\times\mathcal{Y}\to\mathbb{R}" display="inline"><semantics id="S2.p1.7.m7.1a"><mrow id="S2.p1.7.m7.1.1" xref="S2.p1.7.m7.1.1.cmml"><mi mathvariant="normal" id="S2.p1.7.m7.1.1.2" xref="S2.p1.7.m7.1.1.2.cmml">ℓ</mi><mo lspace="0.278em" rspace="0.278em" id="S2.p1.7.m7.1.1.1" xref="S2.p1.7.m7.1.1.1.cmml">:</mo><mrow id="S2.p1.7.m7.1.1.3" xref="S2.p1.7.m7.1.1.3.cmml"><mrow id="S2.p1.7.m7.1.1.3.2" xref="S2.p1.7.m7.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.7.m7.1.1.3.2.2" xref="S2.p1.7.m7.1.1.3.2.2.cmml">𝒳</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p1.7.m7.1.1.3.2.1" xref="S2.p1.7.m7.1.1.3.2.1.cmml">×</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.7.m7.1.1.3.2.3" xref="S2.p1.7.m7.1.1.3.2.3.cmml">𝒴</mi></mrow><mo stretchy="false" id="S2.p1.7.m7.1.1.3.1" xref="S2.p1.7.m7.1.1.3.1.cmml">→</mo><mi id="S2.p1.7.m7.1.1.3.3" xref="S2.p1.7.m7.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.1b"><apply id="S2.p1.7.m7.1.1.cmml" xref="S2.p1.7.m7.1.1"><ci id="S2.p1.7.m7.1.1.1.cmml" xref="S2.p1.7.m7.1.1.1">:</ci><ci id="S2.p1.7.m7.1.1.2.cmml" xref="S2.p1.7.m7.1.1.2">ℓ</ci><apply id="S2.p1.7.m7.1.1.3.cmml" xref="S2.p1.7.m7.1.1.3"><ci id="S2.p1.7.m7.1.1.3.1.cmml" xref="S2.p1.7.m7.1.1.3.1">→</ci><apply id="S2.p1.7.m7.1.1.3.2.cmml" xref="S2.p1.7.m7.1.1.3.2"><times id="S2.p1.7.m7.1.1.3.2.1.cmml" xref="S2.p1.7.m7.1.1.3.2.1"></times><ci id="S2.p1.7.m7.1.1.3.2.2.cmml" xref="S2.p1.7.m7.1.1.3.2.2">𝒳</ci><ci id="S2.p1.7.m7.1.1.3.2.3.cmml" xref="S2.p1.7.m7.1.1.3.2.3">𝒴</ci></apply><ci id="S2.p1.7.m7.1.1.3.3.cmml" xref="S2.p1.7.m7.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.1c">\ell\colon\mathcal{X}\times\mathcal{Y}\to\mathbb{R}</annotation></semantics></math>. There is a mask <math id="S2.p1.8.m8.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.p1.8.m8.1a"><mi id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><ci id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">M</annotation></semantics></math> have same shape with <math id="S2.p1.9.m9.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S2.p1.9.m9.1a"><mi id="S2.p1.9.m9.1.1" xref="S2.p1.9.m9.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m9.1b"><ci id="S2.p1.9.m9.1.1.cmml" xref="S2.p1.9.m9.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m9.1c">w</annotation></semantics></math>, represent the personalized parameters of <math id="S2.p1.10.m10.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S2.p1.10.m10.1a"><mi id="S2.p1.10.m10.1.1" xref="S2.p1.10.m10.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S2.p1.10.m10.1b"><ci id="S2.p1.10.m10.1.1.cmml" xref="S2.p1.10.m10.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m10.1c">w</annotation></semantics></math>, then the underlying optimization goal of PFL is:</p>
</div>
<div id="S2.p2" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.5" class="ltx_Math" alttext="\min\limits_{W}\{F(W):=\frac{1}{N}\sum_{k=1}^{N}\mathbb{E}[\ell(w_{g},w_{i};x,y)]\}" display="block"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5.2" xref="S2.E1.m1.5.5.3.cmml"><munder id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.2" xref="S2.E1.m1.4.4.1.1.2.cmml">min</mi><mi id="S2.E1.m1.4.4.1.1.3" xref="S2.E1.m1.4.4.1.1.3.cmml">W</mi></munder><mo id="S2.E1.m1.5.5.2a" xref="S2.E1.m1.5.5.3.cmml">⁡</mo><mrow id="S2.E1.m1.5.5.2.2" xref="S2.E1.m1.5.5.3.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.2.2.2" xref="S2.E1.m1.5.5.3.cmml">{</mo><mrow id="S2.E1.m1.5.5.2.2.1" xref="S2.E1.m1.5.5.2.2.1.cmml"><mrow id="S2.E1.m1.5.5.2.2.1.3" xref="S2.E1.m1.5.5.2.2.1.3.cmml"><mi id="S2.E1.m1.5.5.2.2.1.3.2" xref="S2.E1.m1.5.5.2.2.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.2.2.1.3.1" xref="S2.E1.m1.5.5.2.2.1.3.1.cmml">​</mo><mrow id="S2.E1.m1.5.5.2.2.1.3.3.2" xref="S2.E1.m1.5.5.2.2.1.3.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.2.2.1.3.3.2.1" xref="S2.E1.m1.5.5.2.2.1.3.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">W</mi><mo rspace="0.278em" stretchy="false" id="S2.E1.m1.5.5.2.2.1.3.3.2.2" xref="S2.E1.m1.5.5.2.2.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.E1.m1.5.5.2.2.1.2" xref="S2.E1.m1.5.5.2.2.1.2.cmml">:=</mo><mrow id="S2.E1.m1.5.5.2.2.1.1" xref="S2.E1.m1.5.5.2.2.1.1.cmml"><mfrac id="S2.E1.m1.5.5.2.2.1.1.3" xref="S2.E1.m1.5.5.2.2.1.1.3.cmml"><mn id="S2.E1.m1.5.5.2.2.1.1.3.2" xref="S2.E1.m1.5.5.2.2.1.1.3.2.cmml">1</mn><mi id="S2.E1.m1.5.5.2.2.1.1.3.3" xref="S2.E1.m1.5.5.2.2.1.1.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.2.2.1.1.2" xref="S2.E1.m1.5.5.2.2.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.5.5.2.2.1.1.1" xref="S2.E1.m1.5.5.2.2.1.1.1.cmml"><munderover id="S2.E1.m1.5.5.2.2.1.1.1.2" xref="S2.E1.m1.5.5.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E1.m1.5.5.2.2.1.1.1.2.2.2" xref="S2.E1.m1.5.5.2.2.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.5.5.2.2.1.1.1.2.2.3" xref="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.cmml"><mi id="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.2" xref="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.2.cmml">k</mi><mo id="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.1" xref="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.3" xref="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.5.5.2.2.1.1.1.2.3" xref="S2.E1.m1.5.5.2.2.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S2.E1.m1.5.5.2.2.1.1.1.1" xref="S2.E1.m1.5.5.2.2.1.1.1.1.cmml"><mi id="S2.E1.m1.5.5.2.2.1.1.1.1.3" xref="S2.E1.m1.5.5.2.2.1.1.1.1.3.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.2.2.1.1.1.1.2" xref="S2.E1.m1.5.5.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.cmml"><mi mathvariant="normal" id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.4" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.4.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.3" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.4" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml">w</mi><mi id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.5" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.3.cmml">;</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">x</mi><mo id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.6" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">y</mi><mo stretchy="false" id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.7" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.3" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo stretchy="false" id="S2.E1.m1.5.5.2.2.3" xref="S2.E1.m1.5.5.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.3.cmml" xref="S2.E1.m1.5.5.2"><apply id="S2.E1.m1.4.4.1.1.cmml" xref="S2.E1.m1.4.4.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1">subscript</csymbol><min id="S2.E1.m1.4.4.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.2"></min><ci id="S2.E1.m1.4.4.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.3">𝑊</ci></apply><apply id="S2.E1.m1.5.5.2.2.1.cmml" xref="S2.E1.m1.5.5.2.2.1"><csymbol cd="latexml" id="S2.E1.m1.5.5.2.2.1.2.cmml" xref="S2.E1.m1.5.5.2.2.1.2">assign</csymbol><apply id="S2.E1.m1.5.5.2.2.1.3.cmml" xref="S2.E1.m1.5.5.2.2.1.3"><times id="S2.E1.m1.5.5.2.2.1.3.1.cmml" xref="S2.E1.m1.5.5.2.2.1.3.1"></times><ci id="S2.E1.m1.5.5.2.2.1.3.2.cmml" xref="S2.E1.m1.5.5.2.2.1.3.2">𝐹</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑊</ci></apply><apply id="S2.E1.m1.5.5.2.2.1.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1"><times id="S2.E1.m1.5.5.2.2.1.1.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.2"></times><apply id="S2.E1.m1.5.5.2.2.1.1.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.3"><divide id="S2.E1.m1.5.5.2.2.1.1.3.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.3"></divide><cn type="integer" id="S2.E1.m1.5.5.2.2.1.1.3.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.3.2">1</cn><ci id="S2.E1.m1.5.5.2.2.1.1.3.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.3.3">𝑁</ci></apply><apply id="S2.E1.m1.5.5.2.2.1.1.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1"><apply id="S2.E1.m1.5.5.2.2.1.1.1.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.2">superscript</csymbol><apply id="S2.E1.m1.5.5.2.2.1.1.1.2.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.1.1.1.2.2.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.5.5.2.2.1.1.1.2.2.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.2.2.2"></sum><apply id="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.2.2.3"><eq id="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.1"></eq><ci id="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.2">𝑘</ci><cn type="integer" id="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.5.5.2.2.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.2.3">𝑁</ci></apply><apply id="S2.E1.m1.5.5.2.2.1.1.1.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1"><times id="S2.E1.m1.5.5.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.2"></times><ci id="S2.E1.m1.5.5.2.2.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.3">𝔼</ci><apply id="S2.E1.m1.5.5.2.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.5.5.2.2.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1"><times id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.3"></times><ci id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.4.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.4">ℓ</ci><vector id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2"><apply id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑔</ci></apply><apply id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.2">𝑤</ci><ci id="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E1.m1.5.5.2.2.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑥</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑦</ci></vector></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">\min\limits_{W}\{F(W):=\frac{1}{N}\sum_{k=1}^{N}\mathbb{E}[\ell(w_{g},w_{i};x,y)]\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p2.4" class="ltx_p">where <math id="S2.p2.1.m1.4" class="ltx_Math" alttext="W=(w_{1},w_{2},...,w_{n})" display="inline"><semantics id="S2.p2.1.m1.4a"><mrow id="S2.p2.1.m1.4.4" xref="S2.p2.1.m1.4.4.cmml"><mi id="S2.p2.1.m1.4.4.5" xref="S2.p2.1.m1.4.4.5.cmml">W</mi><mo id="S2.p2.1.m1.4.4.4" xref="S2.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S2.p2.1.m1.4.4.3.3" xref="S2.p2.1.m1.4.4.3.4.cmml"><mo stretchy="false" id="S2.p2.1.m1.4.4.3.3.4" xref="S2.p2.1.m1.4.4.3.4.cmml">(</mo><msub id="S2.p2.1.m1.2.2.1.1.1" xref="S2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S2.p2.1.m1.2.2.1.1.1.2" xref="S2.p2.1.m1.2.2.1.1.1.2.cmml">w</mi><mn id="S2.p2.1.m1.2.2.1.1.1.3" xref="S2.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.p2.1.m1.4.4.3.3.5" xref="S2.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.p2.1.m1.3.3.2.2.2" xref="S2.p2.1.m1.3.3.2.2.2.cmml"><mi id="S2.p2.1.m1.3.3.2.2.2.2" xref="S2.p2.1.m1.3.3.2.2.2.2.cmml">w</mi><mn id="S2.p2.1.m1.3.3.2.2.2.3" xref="S2.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.p2.1.m1.4.4.3.3.6" xref="S2.p2.1.m1.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">…</mi><mo id="S2.p2.1.m1.4.4.3.3.7" xref="S2.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.p2.1.m1.4.4.3.3.3" xref="S2.p2.1.m1.4.4.3.3.3.cmml"><mi id="S2.p2.1.m1.4.4.3.3.3.2" xref="S2.p2.1.m1.4.4.3.3.3.2.cmml">w</mi><mi id="S2.p2.1.m1.4.4.3.3.3.3" xref="S2.p2.1.m1.4.4.3.3.3.3.cmml">n</mi></msub><mo stretchy="false" id="S2.p2.1.m1.4.4.3.3.8" xref="S2.p2.1.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.4b"><apply id="S2.p2.1.m1.4.4.cmml" xref="S2.p2.1.m1.4.4"><eq id="S2.p2.1.m1.4.4.4.cmml" xref="S2.p2.1.m1.4.4.4"></eq><ci id="S2.p2.1.m1.4.4.5.cmml" xref="S2.p2.1.m1.4.4.5">𝑊</ci><vector id="S2.p2.1.m1.4.4.3.4.cmml" xref="S2.p2.1.m1.4.4.3.3"><apply id="S2.p2.1.m1.2.2.1.1.1.cmml" xref="S2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S2.p2.1.m1.2.2.1.1.1.2">𝑤</ci><cn type="integer" id="S2.p2.1.m1.2.2.1.1.1.3.cmml" xref="S2.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.p2.1.m1.3.3.2.2.2.cmml" xref="S2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.p2.1.m1.3.3.2.2.2.1.cmml" xref="S2.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.p2.1.m1.3.3.2.2.2.2.cmml" xref="S2.p2.1.m1.3.3.2.2.2.2">𝑤</ci><cn type="integer" id="S2.p2.1.m1.3.3.2.2.2.3.cmml" xref="S2.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">…</ci><apply id="S2.p2.1.m1.4.4.3.3.3.cmml" xref="S2.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.p2.1.m1.4.4.3.3.3.1.cmml" xref="S2.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.p2.1.m1.4.4.3.3.3.2.cmml" xref="S2.p2.1.m1.4.4.3.3.3.2">𝑤</ci><ci id="S2.p2.1.m1.4.4.3.3.3.3.cmml" xref="S2.p2.1.m1.4.4.3.3.3.3">𝑛</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.4c">W=(w_{1},w_{2},...,w_{n})</annotation></semantics></math> denotes the collection of all client models and <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S2.p2.2.m2.1a"><msub id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">w</mi><mi id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝑤</ci><ci id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">w_{g}</annotation></semantics></math> denotes global model. The goal of element level parameter personalization is to identify a mask <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">M</annotation></semantics></math> that determines which parameters should be personalized. The loss can be rewrite as <math id="S2.p2.4.m4.3" class="ltx_Math" alttext="\mathbb{E}[\ell(w_{i}\odot M+w_{g}\odot(1-M);x,y)]" display="inline"><semantics id="S2.p2.4.m4.3a"><mrow id="S2.p2.4.m4.3.3" xref="S2.p2.4.m4.3.3.cmml"><mi id="S2.p2.4.m4.3.3.3" xref="S2.p2.4.m4.3.3.3.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="S2.p2.4.m4.3.3.2" xref="S2.p2.4.m4.3.3.2.cmml">​</mo><mrow id="S2.p2.4.m4.3.3.1.1" xref="S2.p2.4.m4.3.3.1.2.cmml"><mo stretchy="false" id="S2.p2.4.m4.3.3.1.1.2" xref="S2.p2.4.m4.3.3.1.2.1.cmml">[</mo><mrow id="S2.p2.4.m4.3.3.1.1.1" xref="S2.p2.4.m4.3.3.1.1.1.cmml"><mi mathvariant="normal" id="S2.p2.4.m4.3.3.1.1.1.3" xref="S2.p2.4.m4.3.3.1.1.1.3.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S2.p2.4.m4.3.3.1.1.1.2" xref="S2.p2.4.m4.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.p2.4.m4.3.3.1.1.1.1.1" xref="S2.p2.4.m4.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.p2.4.m4.3.3.1.1.1.1.1.2" xref="S2.p2.4.m4.3.3.1.1.1.1.2.cmml">(</mo><mrow id="S2.p2.4.m4.3.3.1.1.1.1.1.1" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.cmml"><msub id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.2" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.2.cmml">w</mi><mi id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.3" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.1" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.1.cmml">⊙</mo><mi id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.3" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.3.cmml">M</mi></mrow><mo id="S2.p2.4.m4.3.3.1.1.1.1.1.1.2" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.cmml"><msub id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.2" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.2.cmml">w</mi><mi id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.3" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.2" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.2.cmml">⊙</mo><mrow id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml">M</mi></mrow><mo stretchy="false" id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.p2.4.m4.3.3.1.1.1.1.1.3" xref="S2.p2.4.m4.3.3.1.1.1.1.2.cmml">;</mo><mi id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">x</mi><mo id="S2.p2.4.m4.3.3.1.1.1.1.1.4" xref="S2.p2.4.m4.3.3.1.1.1.1.2.cmml">,</mo><mi id="S2.p2.4.m4.2.2" xref="S2.p2.4.m4.2.2.cmml">y</mi><mo stretchy="false" id="S2.p2.4.m4.3.3.1.1.1.1.1.5" xref="S2.p2.4.m4.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.p2.4.m4.3.3.1.1.3" xref="S2.p2.4.m4.3.3.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.3b"><apply id="S2.p2.4.m4.3.3.cmml" xref="S2.p2.4.m4.3.3"><times id="S2.p2.4.m4.3.3.2.cmml" xref="S2.p2.4.m4.3.3.2"></times><ci id="S2.p2.4.m4.3.3.3.cmml" xref="S2.p2.4.m4.3.3.3">𝔼</ci><apply id="S2.p2.4.m4.3.3.1.2.cmml" xref="S2.p2.4.m4.3.3.1.1"><csymbol cd="latexml" id="S2.p2.4.m4.3.3.1.2.1.cmml" xref="S2.p2.4.m4.3.3.1.1.2">delimited-[]</csymbol><apply id="S2.p2.4.m4.3.3.1.1.1.cmml" xref="S2.p2.4.m4.3.3.1.1.1"><times id="S2.p2.4.m4.3.3.1.1.1.2.cmml" xref="S2.p2.4.m4.3.3.1.1.1.2"></times><ci id="S2.p2.4.m4.3.3.1.1.1.3.cmml" xref="S2.p2.4.m4.3.3.1.1.1.3">ℓ</ci><list id="S2.p2.4.m4.3.3.1.1.1.1.2.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1"><apply id="S2.p2.4.m4.3.3.1.1.1.1.1.1.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1"><plus id="S2.p2.4.m4.3.3.1.1.1.1.1.1.2.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.2"></plus><apply id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.1">direct-product</csymbol><apply id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.2">𝑤</ci><ci id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.3.3">𝑀</ci></apply><apply id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.2">direct-product</csymbol><apply id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.2">𝑤</ci><ci id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.3.3">𝑔</ci></apply><apply id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1"><minus id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p2.4.m4.3.3.1.1.1.1.1.1.1.1.1.1.3">𝑀</ci></apply></apply></apply><ci id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">𝑥</ci><ci id="S2.p2.4.m4.2.2.cmml" xref="S2.p2.4.m4.2.2">𝑦</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.3c">\mathbb{E}[\ell(w_{i}\odot M+w_{g}\odot(1-M);x,y)]</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Method</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we will discuss the method we propose, namely Federated BNN for Parameter Selection (FedBPS). We employ Bayesian neural networks to guide our selection of personalized parameters. Bayesian neural networks assume a distribution of parameters. In our case, We assume no correlation between elements; hence, the parameter distribution of the neural network will follow a diagonal Gaussian distribution. This distribution can be characterized by its mean and variance, where higher variance indicates that the parameters have a larger adjustment range, making them suitable candidates for personalized parameters.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Bayesian Neural Network</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The key distinction between Bayesian neural networks and point-estimate neural networks lies in how Bayesian neural networks treat parameters as distributions rather than a single fixed values. Consequently, Bayesian neural networks provide a measure of uncertainty regarding network parameters. When a parameter exhibits a high variance, it implies that the parameter’s value is uncertain, and changes in this parameter have a smaller impact on model performance compared to other parameters. Therefore, such parameters are well-suited for use as personalized parameters, as they can accommodate personalized tasks without significantly affecting the global subnetwork performance.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">Bayesian neural network posterior estimation employs two main approaches: Variational Inference (VI)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and Markov Chain Monte Carlo (MCMC)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. The MCMC involves sampling from the posterior to estimate its density, while VI makes parametric assumptions about the posterior and seeks to find the distribution within a family of distributions that is closest to the posterior distribution by minimizing the Evidence Lower Bound (ELBO). Both of these methods entail higher computational and storage overhead compared to point-estimate neural networks.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">To acquire the posterior distribution of parameters, we employ the Laplace approximation method<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Since we do not require precise posterior results but rather their relative magnitudes, the Laplace approximation aligns perfectly with our needs. Laplace approximation utilizes second-order derivative information at a specific point to approximate the distribution as a Gaussian distribution, with the distribution depicted as follows:</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.5" class="ltx_Math" alttext="w\sim\mathcal{N}(w_{0},(\nabla_{w}^{2}\mathcal{L}(\mathcal{D};w)|_{w_{0}})^{-1})" display="block"><semantics id="S3.E2.m1.5a"><mrow id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml"><mi id="S3.E2.m1.5.5.4" xref="S3.E2.m1.5.5.4.cmml">w</mi><mo id="S3.E2.m1.5.5.3" xref="S3.E2.m1.5.5.3.cmml">∼</mo><mrow id="S3.E2.m1.5.5.2" xref="S3.E2.m1.5.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.2.4" xref="S3.E2.m1.5.5.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.2.3" xref="S3.E2.m1.5.5.2.3.cmml">​</mo><mrow id="S3.E2.m1.5.5.2.2.2" xref="S3.E2.m1.5.5.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.2.2.2.3" xref="S3.E2.m1.5.5.2.2.3.cmml">(</mo><msub id="S3.E2.m1.4.4.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.2.cmml">w</mi><mn id="S3.E2.m1.4.4.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E2.m1.5.5.2.2.2.4" xref="S3.E2.m1.5.5.2.2.3.cmml">,</mo><msup id="S3.E2.m1.5.5.2.2.2.2" xref="S3.E2.m1.5.5.2.2.2.2.cmml"><mrow id="S3.E2.m1.5.5.2.2.2.2.1.1" xref="S3.E2.m1.5.5.2.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.2.2.2.2.1.1.2" xref="S3.E2.m1.5.5.2.2.2.2.cmml">(</mo><msub id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.2.cmml"><mrow id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.2.cmml"><mrow id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.cmml"><mo rspace="0.167em" id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.2.2" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.2.2.cmml">∇</mo><mi id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.2.3" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.2.3.cmml">w</mi><mn id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.3" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.3.cmml">2</mn></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.2" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.3.2" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.3.2.1" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝒟</mi><mo id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.3.1.cmml">;</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">w</mi><mo stretchy="false" id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.2" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.2.1.cmml">|</mo></mrow><msub id="S3.E2.m1.3.3.1" xref="S3.E2.m1.3.3.1.cmml"><mi id="S3.E2.m1.3.3.1.2" xref="S3.E2.m1.3.3.1.2.cmml">w</mi><mn id="S3.E2.m1.3.3.1.3" xref="S3.E2.m1.3.3.1.3.cmml">0</mn></msub></msub><mo stretchy="false" id="S3.E2.m1.5.5.2.2.2.2.1.1.3" xref="S3.E2.m1.5.5.2.2.2.2.cmml">)</mo></mrow><mrow id="S3.E2.m1.5.5.2.2.2.2.3" xref="S3.E2.m1.5.5.2.2.2.2.3.cmml"><mo id="S3.E2.m1.5.5.2.2.2.2.3a" xref="S3.E2.m1.5.5.2.2.2.2.3.cmml">−</mo><mn id="S3.E2.m1.5.5.2.2.2.2.3.2" xref="S3.E2.m1.5.5.2.2.2.2.3.2.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.E2.m1.5.5.2.2.2.5" xref="S3.E2.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.5b"><apply id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5"><csymbol cd="latexml" id="S3.E2.m1.5.5.3.cmml" xref="S3.E2.m1.5.5.3">similar-to</csymbol><ci id="S3.E2.m1.5.5.4.cmml" xref="S3.E2.m1.5.5.4">𝑤</ci><apply id="S3.E2.m1.5.5.2.cmml" xref="S3.E2.m1.5.5.2"><times id="S3.E2.m1.5.5.2.3.cmml" xref="S3.E2.m1.5.5.2.3"></times><ci id="S3.E2.m1.5.5.2.4.cmml" xref="S3.E2.m1.5.5.2.4">𝒩</ci><interval closure="open" id="S3.E2.m1.5.5.2.2.3.cmml" xref="S3.E2.m1.5.5.2.2.2"><apply id="S3.E2.m1.4.4.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2">𝑤</ci><cn type="integer" id="S3.E2.m1.4.4.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3">0</cn></apply><apply id="S3.E2.m1.5.5.2.2.2.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.2.2.2.2.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.5.5.2.2.2.2.1.1.1.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.5.5.2.2.2.2.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.2">evaluated-at</csymbol><apply id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1"><times id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.1"></times><apply id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2"><apply id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.2.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1">subscript</csymbol><ci id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.2.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.2.2">∇</ci><ci id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.2.3.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.2.3">𝑤</ci></apply><cn type="integer" id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.3.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.1.3">2</cn></apply><ci id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.2.2">ℒ</ci></apply><list id="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.1.1.1.1.1.1.3.2"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝒟</ci><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">𝑤</ci></list></apply><apply id="S3.E2.m1.3.3.1.cmml" xref="S3.E2.m1.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.2.cmml" xref="S3.E2.m1.3.3.1.2">𝑤</ci><cn type="integer" id="S3.E2.m1.3.3.1.3.cmml" xref="S3.E2.m1.3.3.1.3">0</cn></apply></apply><apply id="S3.E2.m1.5.5.2.2.2.2.3.cmml" xref="S3.E2.m1.5.5.2.2.2.2.3"><minus id="S3.E2.m1.5.5.2.2.2.2.3.1.cmml" xref="S3.E2.m1.5.5.2.2.2.2.3"></minus><cn type="integer" id="S3.E2.m1.5.5.2.2.2.2.3.2.cmml" xref="S3.E2.m1.5.5.2.2.2.2.3.2">1</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.5c">w\sim\mathcal{N}(w_{0},(\nabla_{w}^{2}\mathcal{L}(\mathcal{D};w)|_{w_{0}})^{-1})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS1.p5" class="ltx_para">
<p id="S3.SS1.p5.1" class="ltx_p">Compared to algorithms based on MCMC and VI, Laplace approximation is faster and can be seamlessly integrated with point-estimate neural network algorithms since it is a post hoc method.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Bayesian Neural Network For Personalized Parameters Selection</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.13" class="ltx_p">In this section, we will discuss how to select personalized parameters based on uncertainty. Let’s assume we have a matrix <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">W</annotation></semantics></math> representing the parameters, where <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="n_{W}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">n</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">W</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑛</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">n_{W}</annotation></semantics></math> denotes the total number of elements in <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">W</annotation></semantics></math>. Let <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">p</annotation></semantics></math> denote the proportion of personalized parameters we require, so we need <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="pn_{W}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.5.m5.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.cmml">​</mo><msub id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.p1.5.m5.1.1.3.2" xref="S3.SS2.p1.5.m5.1.1.3.2.cmml">n</mi><mi id="S3.SS2.p1.5.m5.1.1.3.3" xref="S3.SS2.p1.5.m5.1.1.3.3.cmml">W</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><times id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1"></times><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑝</ci><apply id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.p1.5.m5.1.1.3.2">𝑛</ci><ci id="S3.SS2.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3.3">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">pn_{W}</annotation></semantics></math> personalized parameters. We create a matrix <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mi id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">M</annotation></semantics></math> of the same shape as <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="W" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">W</annotation></semantics></math>, where its elements are composed of <math id="S3.SS2.p1.8.m8.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S3.SS2.p1.8.m8.1a"><mn id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><cn type="integer" id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">0</cn></annotation-xml></semantics></math> and <math id="S3.SS2.p1.9.m9.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS2.p1.9.m9.1a"><mn id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><cn type="integer" id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">1</annotation></semantics></math>. A threshold <math id="S3.SS2.p1.10.m10.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.SS2.p1.10.m10.1a"><mi id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><ci id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">a</annotation></semantics></math> make there are <math id="S3.SS2.p1.11.m11.1" class="ltx_Math" alttext="pn_{W}" display="inline"><semantics id="S3.SS2.p1.11.m11.1a"><mrow id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml"><mi id="S3.SS2.p1.11.m11.1.1.2" xref="S3.SS2.p1.11.m11.1.1.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.11.m11.1.1.1" xref="S3.SS2.p1.11.m11.1.1.1.cmml">​</mo><msub id="S3.SS2.p1.11.m11.1.1.3" xref="S3.SS2.p1.11.m11.1.1.3.cmml"><mi id="S3.SS2.p1.11.m11.1.1.3.2" xref="S3.SS2.p1.11.m11.1.1.3.2.cmml">n</mi><mi id="S3.SS2.p1.11.m11.1.1.3.3" xref="S3.SS2.p1.11.m11.1.1.3.3.cmml">W</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.1b"><apply id="S3.SS2.p1.11.m11.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1"><times id="S3.SS2.p1.11.m11.1.1.1.cmml" xref="S3.SS2.p1.11.m11.1.1.1"></times><ci id="S3.SS2.p1.11.m11.1.1.2.cmml" xref="S3.SS2.p1.11.m11.1.1.2">𝑝</ci><apply id="S3.SS2.p1.11.m11.1.1.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.11.m11.1.1.3.1.cmml" xref="S3.SS2.p1.11.m11.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.11.m11.1.1.3.2.cmml" xref="S3.SS2.p1.11.m11.1.1.3.2">𝑛</ci><ci id="S3.SS2.p1.11.m11.1.1.3.3.cmml" xref="S3.SS2.p1.11.m11.1.1.3.3">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.1c">pn_{W}</annotation></semantics></math> elements in variance <math id="S3.SS2.p1.12.m12.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p1.12.m12.1a"><mi id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><ci id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">\sigma</annotation></semantics></math> bigger than <math id="S3.SS2.p1.13.m13.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S3.SS2.p1.13.m13.1a"><mi id="S3.SS2.p1.13.m13.1.1" xref="S3.SS2.p1.13.m13.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m13.1b"><ci id="S3.SS2.p1.13.m13.1.1.cmml" xref="S3.SS2.p1.13.m13.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m13.1c">a</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="M_{ij}=\left\{\begin{array}[]{cc}1&amp;\text{if }\sigma\geq a\\
0&amp;\text{if }\sigma\leq a\end{array}\right." display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.2" xref="S3.E3.m1.1.2.cmml"><msub id="S3.E3.m1.1.2.2" xref="S3.E3.m1.1.2.2.cmml"><mi id="S3.E3.m1.1.2.2.2" xref="S3.E3.m1.1.2.2.2.cmml">M</mi><mrow id="S3.E3.m1.1.2.2.3" xref="S3.E3.m1.1.2.2.3.cmml"><mi id="S3.E3.m1.1.2.2.3.2" xref="S3.E3.m1.1.2.2.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.2.2.3.1" xref="S3.E3.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.E3.m1.1.2.2.3.3" xref="S3.E3.m1.1.2.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.E3.m1.1.2.1" xref="S3.E3.m1.1.2.1.cmml">=</mo><mrow id="S3.E3.m1.1.2.3.2" xref="S3.E3.m1.1.2.3.1.cmml"><mo id="S3.E3.m1.1.2.3.2.1" xref="S3.E3.m1.1.2.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><mtr id="S3.E3.m1.1.1a" xref="S3.E3.m1.1.1.cmml"><mtd id="S3.E3.m1.1.1b" xref="S3.E3.m1.1.1.cmml"><mn id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml">1</mn></mtd><mtd id="S3.E3.m1.1.1c" xref="S3.E3.m1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.2.1" xref="S3.E3.m1.1.1.1.2.1.cmml"><mrow id="S3.E3.m1.1.1.1.2.1.2" xref="S3.E3.m1.1.1.1.2.1.2.cmml"><mtext id="S3.E3.m1.1.1.1.2.1.2.2" xref="S3.E3.m1.1.1.1.2.1.2.2a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.2.1.2.1" xref="S3.E3.m1.1.1.1.2.1.2.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.2.1.2.3" xref="S3.E3.m1.1.1.1.2.1.2.3.cmml">σ</mi></mrow><mo id="S3.E3.m1.1.1.1.2.1.1" xref="S3.E3.m1.1.1.1.2.1.1.cmml">≥</mo><mi id="S3.E3.m1.1.1.1.2.1.3" xref="S3.E3.m1.1.1.1.2.1.3.cmml">a</mi></mrow></mtd></mtr><mtr id="S3.E3.m1.1.1d" xref="S3.E3.m1.1.1.cmml"><mtd id="S3.E3.m1.1.1e" xref="S3.E3.m1.1.1.cmml"><mn id="S3.E3.m1.1.1.2.1.1" xref="S3.E3.m1.1.1.2.1.1.cmml">0</mn></mtd><mtd id="S3.E3.m1.1.1f" xref="S3.E3.m1.1.1.cmml"><mrow id="S3.E3.m1.1.1.2.2.1" xref="S3.E3.m1.1.1.2.2.1.cmml"><mrow id="S3.E3.m1.1.1.2.2.1.2" xref="S3.E3.m1.1.1.2.2.1.2.cmml"><mtext id="S3.E3.m1.1.1.2.2.1.2.2" xref="S3.E3.m1.1.1.2.2.1.2.2a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.2.2.1.2.1" xref="S3.E3.m1.1.1.2.2.1.2.1.cmml">​</mo><mi id="S3.E3.m1.1.1.2.2.1.2.3" xref="S3.E3.m1.1.1.2.2.1.2.3.cmml">σ</mi></mrow><mo id="S3.E3.m1.1.1.2.2.1.1" xref="S3.E3.m1.1.1.2.2.1.1.cmml">≤</mo><mi id="S3.E3.m1.1.1.2.2.1.3" xref="S3.E3.m1.1.1.2.2.1.3.cmml">a</mi></mrow></mtd></mtr></mtable><mi id="S3.E3.m1.1.2.3.2.2" xref="S3.E3.m1.1.2.3.1.1.cmml"></mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.2.cmml" xref="S3.E3.m1.1.2"><eq id="S3.E3.m1.1.2.1.cmml" xref="S3.E3.m1.1.2.1"></eq><apply id="S3.E3.m1.1.2.2.cmml" xref="S3.E3.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.2.2.1.cmml" xref="S3.E3.m1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.1.2.2.2.cmml" xref="S3.E3.m1.1.2.2.2">𝑀</ci><apply id="S3.E3.m1.1.2.2.3.cmml" xref="S3.E3.m1.1.2.2.3"><times id="S3.E3.m1.1.2.2.3.1.cmml" xref="S3.E3.m1.1.2.2.3.1"></times><ci id="S3.E3.m1.1.2.2.3.2.cmml" xref="S3.E3.m1.1.2.2.3.2">𝑖</ci><ci id="S3.E3.m1.1.2.2.3.3.cmml" xref="S3.E3.m1.1.2.2.3.3">𝑗</ci></apply></apply><apply id="S3.E3.m1.1.2.3.1.cmml" xref="S3.E3.m1.1.2.3.2"><csymbol cd="latexml" id="S3.E3.m1.1.2.3.1.1.cmml" xref="S3.E3.m1.1.2.3.2.1">cases</csymbol><matrix id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><matrixrow id="S3.E3.m1.1.1a.cmml" xref="S3.E3.m1.1.1"><cn type="integer" id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1">1</cn><apply id="S3.E3.m1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.2.1"><geq id="S3.E3.m1.1.1.1.2.1.1.cmml" xref="S3.E3.m1.1.1.1.2.1.1"></geq><apply id="S3.E3.m1.1.1.1.2.1.2.cmml" xref="S3.E3.m1.1.1.1.2.1.2"><times id="S3.E3.m1.1.1.1.2.1.2.1.cmml" xref="S3.E3.m1.1.1.1.2.1.2.1"></times><ci id="S3.E3.m1.1.1.1.2.1.2.2a.cmml" xref="S3.E3.m1.1.1.1.2.1.2.2"><mtext id="S3.E3.m1.1.1.1.2.1.2.2.cmml" xref="S3.E3.m1.1.1.1.2.1.2.2">if </mtext></ci><ci id="S3.E3.m1.1.1.1.2.1.2.3.cmml" xref="S3.E3.m1.1.1.1.2.1.2.3">𝜎</ci></apply><ci id="S3.E3.m1.1.1.1.2.1.3.cmml" xref="S3.E3.m1.1.1.1.2.1.3">𝑎</ci></apply></matrixrow><matrixrow id="S3.E3.m1.1.1b.cmml" xref="S3.E3.m1.1.1"><cn type="integer" id="S3.E3.m1.1.1.2.1.1.cmml" xref="S3.E3.m1.1.1.2.1.1">0</cn><apply id="S3.E3.m1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.2.2.1"><leq id="S3.E3.m1.1.1.2.2.1.1.cmml" xref="S3.E3.m1.1.1.2.2.1.1"></leq><apply id="S3.E3.m1.1.1.2.2.1.2.cmml" xref="S3.E3.m1.1.1.2.2.1.2"><times id="S3.E3.m1.1.1.2.2.1.2.1.cmml" xref="S3.E3.m1.1.1.2.2.1.2.1"></times><ci id="S3.E3.m1.1.1.2.2.1.2.2a.cmml" xref="S3.E3.m1.1.1.2.2.1.2.2"><mtext id="S3.E3.m1.1.1.2.2.1.2.2.cmml" xref="S3.E3.m1.1.1.2.2.1.2.2">if </mtext></ci><ci id="S3.E3.m1.1.1.2.2.1.2.3.cmml" xref="S3.E3.m1.1.1.2.2.1.2.3">𝜎</ci></apply><ci id="S3.E3.m1.1.1.2.2.1.3.cmml" xref="S3.E3.m1.1.1.2.2.1.3">𝑎</ci></apply></matrixrow></matrix></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">M_{ij}=\left\{\begin{array}[]{cc}1&amp;\text{if }\sigma\geq a\\
0&amp;\text{if }\sigma\leq a\end{array}\right.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">Thus, personalized parameters can be represented as:</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="w_{i}=w_{i}\odot M+w_{g}\odot(1-M)" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><msub id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml">w</mi><mi id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.1.1.1.3.cmml"><msub id="S3.E4.m1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.3.2.cmml"><mi id="S3.E4.m1.1.1.1.3.2.2" xref="S3.E4.m1.1.1.1.3.2.2.cmml">w</mi><mi id="S3.E4.m1.1.1.1.3.2.3" xref="S3.E4.m1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.1.3.1" xref="S3.E4.m1.1.1.1.3.1.cmml">⊙</mo><mi id="S3.E4.m1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.3.3.cmml">M</mi></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">w</mi><mi id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">⊙</mo><mrow id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E4.m1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E4.m1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml">M</mi></mrow><mo stretchy="false" id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2"></eq><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2">𝑤</ci><ci id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3">𝑖</ci></apply><apply id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><plus id="S3.E4.m1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.2"></plus><apply id="S3.E4.m1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.3"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.3.1">direct-product</csymbol><apply id="S3.E4.m1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.1.3.2">subscript</csymbol><ci id="S3.E4.m1.1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.1.3.2.2">𝑤</ci><ci id="S3.E4.m1.1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E4.m1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.3.3">𝑀</ci></apply><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2">direct-product</csymbol><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">𝑤</ci><ci id="S3.E4.m1.1.1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.1.1.3.3">𝑔</ci></apply><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">w_{i}=w_{i}\odot M+w_{g}\odot(1-M)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p4.6" class="ltx_p">where <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mo id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><csymbol cd="latexml" id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\odot</annotation></semantics></math> is Hadamard product and <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑤</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">w_{g}</annotation></semantics></math> is the global model. This formula signifies that any new parameter <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><msub id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">w</mi><mi id="S3.SS2.p4.3.m3.1.1.3" xref="S3.SS2.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝑤</ci><ci id="S3.SS2.p4.3.m3.1.1.3.cmml" xref="S3.SS2.p4.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">w_{i}</annotation></semantics></math> will originate from either <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><msub id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2" xref="S3.SS2.p4.4.m4.1.1.2.cmml">w</mi><mi id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2">𝑤</ci><ci id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">w_{i}</annotation></semantics></math> or <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="w_{g}" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><msub id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mi id="S3.SS2.p4.5.m5.1.1.2" xref="S3.SS2.p4.5.m5.1.1.2.cmml">w</mi><mi id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2">𝑤</ci><ci id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">w_{g}</annotation></semantics></math>. When the parameter’s variance is low, it will adopt the value of the global model parameter, and when the variance is high, this personalized parameters will adopt the value of <math id="S3.SS2.p4.6.m6.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS2.p4.6.m6.1a"><msub id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml">w</mi><mi id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2">𝑤</ci><ci id="S3.SS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">w_{i}</annotation></semantics></math>.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.2" class="ltx_p">When dealing with a single model, parameter selection based on uncertainty is straightforward. However, in the context of personalized federated learning, each client possesses their own personalized model. Consequently, selecting personalized parameters can lead to disparities. To address this, We will first aggregate the global parameter distribution <math id="S3.SS2.p5.1.m1.2" class="ltx_Math" alttext="\mathcal{N}(\mu_{g},\sigma_{g})" display="inline"><semantics id="S3.SS2.p5.1.m1.2a"><mrow id="S3.SS2.p5.1.m1.2.2" xref="S3.SS2.p5.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p5.1.m1.2.2.4" xref="S3.SS2.p5.1.m1.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.1.m1.2.2.3" xref="S3.SS2.p5.1.m1.2.2.3.cmml">​</mo><mrow id="S3.SS2.p5.1.m1.2.2.2.2" xref="S3.SS2.p5.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.p5.1.m1.2.2.2.2.3" xref="S3.SS2.p5.1.m1.2.2.2.3.cmml">(</mo><msub id="S3.SS2.p5.1.m1.1.1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.SS2.p5.1.m1.1.1.1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.1.1.1.3.cmml">g</mi></msub><mo id="S3.SS2.p5.1.m1.2.2.2.2.4" xref="S3.SS2.p5.1.m1.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p5.1.m1.2.2.2.2.2" xref="S3.SS2.p5.1.m1.2.2.2.2.2.cmml"><mi id="S3.SS2.p5.1.m1.2.2.2.2.2.2" xref="S3.SS2.p5.1.m1.2.2.2.2.2.2.cmml">σ</mi><mi id="S3.SS2.p5.1.m1.2.2.2.2.2.3" xref="S3.SS2.p5.1.m1.2.2.2.2.2.3.cmml">g</mi></msub><mo stretchy="false" id="S3.SS2.p5.1.m1.2.2.2.2.5" xref="S3.SS2.p5.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.2b"><apply id="S3.SS2.p5.1.m1.2.2.cmml" xref="S3.SS2.p5.1.m1.2.2"><times id="S3.SS2.p5.1.m1.2.2.3.cmml" xref="S3.SS2.p5.1.m1.2.2.3"></times><ci id="S3.SS2.p5.1.m1.2.2.4.cmml" xref="S3.SS2.p5.1.m1.2.2.4">𝒩</ci><interval closure="open" id="S3.SS2.p5.1.m1.2.2.2.3.cmml" xref="S3.SS2.p5.1.m1.2.2.2.2"><apply id="S3.SS2.p5.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1.2">𝜇</ci><ci id="S3.SS2.p5.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.1.1.1.3">𝑔</ci></apply><apply id="S3.SS2.p5.1.m1.2.2.2.2.2.cmml" xref="S3.SS2.p5.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.2.2.2.2.2.1.cmml" xref="S3.SS2.p5.1.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p5.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS2.p5.1.m1.2.2.2.2.2.2">𝜎</ci><ci id="S3.SS2.p5.1.m1.2.2.2.2.2.3.cmml" xref="S3.SS2.p5.1.m1.2.2.2.2.2.3">𝑔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.2c">\mathcal{N}(\mu_{g},\sigma_{g})</annotation></semantics></math> and then determine which parameters should undergo personalization by using <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="\sigma_{g}" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><msub id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml">σ</mi><mi id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><apply id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.2.m2.1.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p5.2.m2.1.1.2.cmml" xref="S3.SS2.p5.2.m2.1.1.2">𝜎</ci><ci id="S3.SS2.p5.2.m2.1.1.3.cmml" xref="S3.SS2.p5.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\sigma_{g}</annotation></semantics></math>. In this context, we opt for an aggregation scheme based on KL divergence.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<table id="S3.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S3.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mu_{g}" display="inline"><semantics id="S3.E5X.2.1.1.m1.1a"><msub id="S3.E5X.2.1.1.m1.1.1" xref="S3.E5X.2.1.1.m1.1.1.cmml"><mi id="S3.E5X.2.1.1.m1.1.1.2" xref="S3.E5X.2.1.1.m1.1.1.2.cmml">μ</mi><mi id="S3.E5X.2.1.1.m1.1.1.3" xref="S3.E5X.2.1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E5X.2.1.1.m1.1b"><apply id="S3.E5X.2.1.1.m1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E5X.2.1.1.m1.1.1.1.cmml" xref="S3.E5X.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E5X.2.1.1.m1.1.1.2.cmml" xref="S3.E5X.2.1.1.m1.1.1.2">𝜇</ci><ci id="S3.E5X.2.1.1.m1.1.1.3.cmml" xref="S3.E5X.2.1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.2.1.1.m1.1c">\displaystyle\mu_{g}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5X.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{N}\pi_{i}\mu_{i}" display="inline"><semantics id="S3.E5X.3.2.2.m1.1a"><mrow id="S3.E5X.3.2.2.m1.1.1" xref="S3.E5X.3.2.2.m1.1.1.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.2" xref="S3.E5X.3.2.2.m1.1.1.2.cmml"></mi><mo id="S3.E5X.3.2.2.m1.1.1.1" xref="S3.E5X.3.2.2.m1.1.1.1.cmml">=</mo><mrow id="S3.E5X.3.2.2.m1.1.1.3" xref="S3.E5X.3.2.2.m1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E5X.3.2.2.m1.1.1.3.1" xref="S3.E5X.3.2.2.m1.1.1.3.1.cmml"><munderover id="S3.E5X.3.2.2.m1.1.1.3.1a" xref="S3.E5X.3.2.2.m1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E5X.3.2.2.m1.1.1.3.1.2.2" xref="S3.E5X.3.2.2.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E5X.3.2.2.m1.1.1.3.1.2.3" xref="S3.E5X.3.2.2.m1.1.1.3.1.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.3.1.2.3.2" xref="S3.E5X.3.2.2.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E5X.3.2.2.m1.1.1.3.1.2.3.1" xref="S3.E5X.3.2.2.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E5X.3.2.2.m1.1.1.3.1.2.3.3" xref="S3.E5X.3.2.2.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5X.3.2.2.m1.1.1.3.1.3" xref="S3.E5X.3.2.2.m1.1.1.3.1.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E5X.3.2.2.m1.1.1.3.2" xref="S3.E5X.3.2.2.m1.1.1.3.2.cmml"><msub id="S3.E5X.3.2.2.m1.1.1.3.2.2" xref="S3.E5X.3.2.2.m1.1.1.3.2.2.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.3.2.2.2" xref="S3.E5X.3.2.2.m1.1.1.3.2.2.2.cmml">π</mi><mi id="S3.E5X.3.2.2.m1.1.1.3.2.2.3" xref="S3.E5X.3.2.2.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5X.3.2.2.m1.1.1.3.2.1" xref="S3.E5X.3.2.2.m1.1.1.3.2.1.cmml">​</mo><msub id="S3.E5X.3.2.2.m1.1.1.3.2.3" xref="S3.E5X.3.2.2.m1.1.1.3.2.3.cmml"><mi id="S3.E5X.3.2.2.m1.1.1.3.2.3.2" xref="S3.E5X.3.2.2.m1.1.1.3.2.3.2.cmml">μ</mi><mi id="S3.E5X.3.2.2.m1.1.1.3.2.3.3" xref="S3.E5X.3.2.2.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5X.3.2.2.m1.1b"><apply id="S3.E5X.3.2.2.m1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1"><eq id="S3.E5X.3.2.2.m1.1.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.1"></eq><csymbol cd="latexml" id="S3.E5X.3.2.2.m1.1.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.2">absent</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.3"><apply id="S3.E5X.3.2.2.m1.1.1.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.3.1.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.1">superscript</csymbol><apply id="S3.E5X.3.2.2.m1.1.1.3.1.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.3.1.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.1">subscript</csymbol><sum id="S3.E5X.3.2.2.m1.1.1.3.1.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.1.2.2"></sum><apply id="S3.E5X.3.2.2.m1.1.1.3.1.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.1.2.3"><eq id="S3.E5X.3.2.2.m1.1.1.3.1.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.1.2.3.1"></eq><ci id="S3.E5X.3.2.2.m1.1.1.3.1.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E5X.3.2.2.m1.1.1.3.1.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E5X.3.2.2.m1.1.1.3.1.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.2"><times id="S3.E5X.3.2.2.m1.1.1.3.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.2.1"></times><apply id="S3.E5X.3.2.2.m1.1.1.3.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.3.2.2.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.3.2.2.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.2.2.2">𝜋</ci><ci id="S3.E5X.3.2.2.m1.1.1.3.2.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E5X.3.2.2.m1.1.1.3.2.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5X.3.2.2.m1.1.1.3.2.3.1.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E5X.3.2.2.m1.1.1.3.2.3.2.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.2.3.2">𝜇</ci><ci id="S3.E5X.3.2.2.m1.1.1.3.2.3.3.cmml" xref="S3.E5X.3.2.2.m1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5X.3.2.2.m1.1c">\displaystyle=\sum_{i=1}^{N}\pi_{i}\mu_{i}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S3.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E5Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\sigma_{g}" display="inline"><semantics id="S3.E5Xa.2.1.1.m1.1a"><msub id="S3.E5Xa.2.1.1.m1.1.1" xref="S3.E5Xa.2.1.1.m1.1.1.cmml"><mi id="S3.E5Xa.2.1.1.m1.1.1.2" xref="S3.E5Xa.2.1.1.m1.1.1.2.cmml">σ</mi><mi id="S3.E5Xa.2.1.1.m1.1.1.3" xref="S3.E5Xa.2.1.1.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="S3.E5Xa.2.1.1.m1.1b"><apply id="S3.E5Xa.2.1.1.m1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.2.1.1.m1.1.1.1.cmml" xref="S3.E5Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S3.E5Xa.2.1.1.m1.1.1.2.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.2">𝜎</ci><ci id="S3.E5Xa.2.1.1.m1.1.1.3.cmml" xref="S3.E5Xa.2.1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.2.1.1.m1.1c">\displaystyle\sigma_{g}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E5Xa.3.2.2.m1.1" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{N}\pi_{i}\sigma_{i}+\pi_{i}(\mu_{i}-\mu)^{2}" display="inline"><semantics id="S3.E5Xa.3.2.2.m1.1a"><mrow id="S3.E5Xa.3.2.2.m1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.3.cmml"></mi><mo id="S3.E5Xa.3.2.2.m1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.2.cmml">=</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.cmml"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E5Xa.3.2.2.m1.1.1.1.3.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.cmml"><munderover id="S3.E5Xa.3.2.2.m1.1.1.1.3.1a" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.cmml"><msub id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.2.cmml">π</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.2.cmml">σ</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.E5Xa.3.2.2.m1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml"><msub id="S3.E5Xa.3.2.2.m1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.cmml">π</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5Xa.3.2.2.m1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2.cmml">​</mo><msup id="S3.E5Xa.3.2.2.m1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.cmml"><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml">μ</mi><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">μ</mi></mrow><mo stretchy="false" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5Xa.3.2.2.m1.1b"><apply id="S3.E5Xa.3.2.2.m1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1"><eq id="S3.E5Xa.3.2.2.m1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.2"></eq><csymbol cd="latexml" id="S3.E5Xa.3.2.2.m1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.3">absent</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1"><plus id="S3.E5Xa.3.2.2.m1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.2"></plus><apply id="S3.E5Xa.3.2.2.m1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3"><apply id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1">superscript</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1">subscript</csymbol><sum id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.2"></sum><apply id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3"><eq id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E5Xa.3.2.2.m1.1.1.1.3.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2"><times id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.1"></times><apply id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.2">𝜋</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.2">𝜎</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1"><times id="S3.E5Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.2"></times><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.2">𝜋</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1"><minus id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.2">𝜇</ci><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝜇</ci></apply><cn type="integer" id="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S3.E5Xa.3.2.2.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5Xa.3.2.2.m1.1c">\displaystyle=\sum_{i=1}^{N}\pi_{i}\sigma_{i}+\pi_{i}(\mu_{i}-\mu)^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
<div id="S3.SS2.p7" class="ltx_para">
<p id="S3.SS2.p7.1" class="ltx_p">From the formula, it is evident that the variance of the aggregated model is determined by the mean of client model variances and the variance of that mean. Consequently, the global model comprises components with low variance and minimal discrepancies among clients, while personalized parameters exhibit high variance or substantial inter-client disparities.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">

<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.5.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Personalized Federated BNN for Parameter Selection</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="alg1.3" class="ltx_p ltx_figure_panel"><span id="alg1.3.1" class="ltx_text ltx_font_bold">Input</span>: Datasets <math id="alg1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="alg1.1.m1.1a"><msub id="alg1.1.m1.1.1" xref="alg1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.1.m1.1.1.2" xref="alg1.1.m1.1.1.2.cmml">𝒟</mi><mi id="alg1.1.m1.1.1.3" xref="alg1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.1.m1.1b"><apply id="alg1.1.m1.1.1.cmml" xref="alg1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.1.m1.1.1.1.cmml" xref="alg1.1.m1.1.1">subscript</csymbol><ci id="alg1.1.m1.1.1.2.cmml" xref="alg1.1.m1.1.1.2">𝒟</ci><ci id="alg1.1.m1.1.1.3.cmml" xref="alg1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.m1.1c">\mathcal{D}_{i}</annotation></semantics></math>, initial NN weight <math id="alg1.2.m2.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="alg1.2.m2.1a"><msub id="alg1.2.m2.1.1" xref="alg1.2.m2.1.1.cmml"><mi id="alg1.2.m2.1.1.2" xref="alg1.2.m2.1.1.2.cmml">w</mi><mi id="alg1.2.m2.1.1.3" xref="alg1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.2.m2.1b"><apply id="alg1.2.m2.1.1.cmml" xref="alg1.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.2.m2.1.1.1.cmml" xref="alg1.2.m2.1.1">subscript</csymbol><ci id="alg1.2.m2.1.1.2.cmml" xref="alg1.2.m2.1.1.2">𝑤</ci><ci id="alg1.2.m2.1.1.3.cmml" xref="alg1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.m2.1c">w_{i}</annotation></semantics></math>
<br class="ltx_break"><span id="alg1.3.2" class="ltx_text ltx_font_bold">Output</span>: <math id="alg1.3.m3.5" class="ltx_Math" alttext="w_{i},i=1,\ldots,n" display="inline"><semantics id="alg1.3.m3.5a"><mrow id="alg1.3.m3.5.5.2" xref="alg1.3.m3.5.5.3.cmml"><mrow id="alg1.3.m3.4.4.1.1" xref="alg1.3.m3.4.4.1.1.cmml"><mrow id="alg1.3.m3.4.4.1.1.1.1" xref="alg1.3.m3.4.4.1.1.1.2.cmml"><msub id="alg1.3.m3.4.4.1.1.1.1.1" xref="alg1.3.m3.4.4.1.1.1.1.1.cmml"><mi id="alg1.3.m3.4.4.1.1.1.1.1.2" xref="alg1.3.m3.4.4.1.1.1.1.1.2.cmml">w</mi><mi id="alg1.3.m3.4.4.1.1.1.1.1.3" xref="alg1.3.m3.4.4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.3.m3.4.4.1.1.1.1.2" xref="alg1.3.m3.4.4.1.1.1.2.cmml">,</mo><mi id="alg1.3.m3.1.1" xref="alg1.3.m3.1.1.cmml">i</mi></mrow><mo id="alg1.3.m3.4.4.1.1.2" xref="alg1.3.m3.4.4.1.1.2.cmml">=</mo><mn id="alg1.3.m3.4.4.1.1.3" xref="alg1.3.m3.4.4.1.1.3.cmml">1</mn></mrow><mo id="alg1.3.m3.5.5.2.3" xref="alg1.3.m3.5.5.3a.cmml">,</mo><mrow id="alg1.3.m3.5.5.2.2.2" xref="alg1.3.m3.5.5.2.2.1.cmml"><mi mathvariant="normal" id="alg1.3.m3.2.2" xref="alg1.3.m3.2.2.cmml">…</mi><mo id="alg1.3.m3.5.5.2.2.2.1" xref="alg1.3.m3.5.5.2.2.1.cmml">,</mo><mi id="alg1.3.m3.3.3" xref="alg1.3.m3.3.3.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.3.m3.5b"><apply id="alg1.3.m3.5.5.3.cmml" xref="alg1.3.m3.5.5.2"><csymbol cd="ambiguous" id="alg1.3.m3.5.5.3a.cmml" xref="alg1.3.m3.5.5.2.3">formulae-sequence</csymbol><apply id="alg1.3.m3.4.4.1.1.cmml" xref="alg1.3.m3.4.4.1.1"><eq id="alg1.3.m3.4.4.1.1.2.cmml" xref="alg1.3.m3.4.4.1.1.2"></eq><list id="alg1.3.m3.4.4.1.1.1.2.cmml" xref="alg1.3.m3.4.4.1.1.1.1"><apply id="alg1.3.m3.4.4.1.1.1.1.1.cmml" xref="alg1.3.m3.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.3.m3.4.4.1.1.1.1.1.1.cmml" xref="alg1.3.m3.4.4.1.1.1.1.1">subscript</csymbol><ci id="alg1.3.m3.4.4.1.1.1.1.1.2.cmml" xref="alg1.3.m3.4.4.1.1.1.1.1.2">𝑤</ci><ci id="alg1.3.m3.4.4.1.1.1.1.1.3.cmml" xref="alg1.3.m3.4.4.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg1.3.m3.1.1.cmml" xref="alg1.3.m3.1.1">𝑖</ci></list><cn type="integer" id="alg1.3.m3.4.4.1.1.3.cmml" xref="alg1.3.m3.4.4.1.1.3">1</cn></apply><list id="alg1.3.m3.5.5.2.2.1.cmml" xref="alg1.3.m3.5.5.2.2.2"><ci id="alg1.3.m3.2.2.cmml" xref="alg1.3.m3.2.2">…</ci><ci id="alg1.3.m3.3.3.cmml" xref="alg1.3.m3.3.3">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m3.5c">w_{i},i=1,\ldots,n</annotation></semantics></math></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="alg1.6" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text ltx_font_bold">procedure</span> <span id="alg1.l1.3" class="ltx_text ltx_font_smallcaps">Server Executes</span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>     <span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.4" class="ltx_Math" alttext="t=1,2,\ldots,T" display="inline"><semantics id="alg1.l2.m1.4a"><mrow id="alg1.l2.m1.4.5" xref="alg1.l2.m1.4.5.cmml"><mi id="alg1.l2.m1.4.5.2" xref="alg1.l2.m1.4.5.2.cmml">t</mi><mo id="alg1.l2.m1.4.5.1" xref="alg1.l2.m1.4.5.1.cmml">=</mo><mrow id="alg1.l2.m1.4.5.3.2" xref="alg1.l2.m1.4.5.3.1.cmml"><mn id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">1</mn><mo id="alg1.l2.m1.4.5.3.2.1" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l2.m1.2.2" xref="alg1.l2.m1.2.2.cmml">2</mn><mo id="alg1.l2.m1.4.5.3.2.2" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l2.m1.3.3" xref="alg1.l2.m1.3.3.cmml">…</mi><mo id="alg1.l2.m1.4.5.3.2.3" xref="alg1.l2.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l2.m1.4.4" xref="alg1.l2.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.4b"><apply id="alg1.l2.m1.4.5.cmml" xref="alg1.l2.m1.4.5"><eq id="alg1.l2.m1.4.5.1.cmml" xref="alg1.l2.m1.4.5.1"></eq><ci id="alg1.l2.m1.4.5.2.cmml" xref="alg1.l2.m1.4.5.2">𝑡</ci><list id="alg1.l2.m1.4.5.3.1.cmml" xref="alg1.l2.m1.4.5.3.2"><cn type="integer" id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">1</cn><cn type="integer" id="alg1.l2.m1.2.2.cmml" xref="alg1.l2.m1.2.2">2</cn><ci id="alg1.l2.m1.3.3.cmml" xref="alg1.l2.m1.3.3">…</ci><ci id="alg1.l2.m1.4.4.cmml" xref="alg1.l2.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.4c">t=1,2,\ldots,T</annotation></semantics></math> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>         <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l3.m1.4" class="ltx_Math" alttext="i=1,2,\ldots,N" display="inline"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.5" xref="alg1.l3.m1.4.5.cmml"><mi id="alg1.l3.m1.4.5.2" xref="alg1.l3.m1.4.5.2.cmml">i</mi><mo id="alg1.l3.m1.4.5.1" xref="alg1.l3.m1.4.5.1.cmml">=</mo><mrow id="alg1.l3.m1.4.5.3.2" xref="alg1.l3.m1.4.5.3.1.cmml"><mn id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo id="alg1.l3.m1.4.5.3.2.1" xref="alg1.l3.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">2</mn><mo id="alg1.l3.m1.4.5.3.2.2" xref="alg1.l3.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">…</mi><mo id="alg1.l3.m1.4.5.3.2.3" xref="alg1.l3.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l3.m1.4.4" xref="alg1.l3.m1.4.4.cmml">N</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><apply id="alg1.l3.m1.4.5.cmml" xref="alg1.l3.m1.4.5"><eq id="alg1.l3.m1.4.5.1.cmml" xref="alg1.l3.m1.4.5.1"></eq><ci id="alg1.l3.m1.4.5.2.cmml" xref="alg1.l3.m1.4.5.2">𝑖</ci><list id="alg1.l3.m1.4.5.3.1.cmml" xref="alg1.l3.m1.4.5.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><cn type="integer" id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">2</cn><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">…</ci><ci id="alg1.l3.m1.4.4.cmml" xref="alg1.l3.m1.4.4">𝑁</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">i=1,2,\ldots,N</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>              <math id="alg1.l4.m1.2" class="ltx_Math" alttext="w_{i},\sigma_{i}\leftarrow" display="inline"><semantics id="alg1.l4.m1.2a"><mrow id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml"><mrow id="alg1.l4.m1.2.2.2.2" xref="alg1.l4.m1.2.2.2.3.cmml"><msub id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.2.cmml">w</mi><mi id="alg1.l4.m1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l4.m1.2.2.2.2.3" xref="alg1.l4.m1.2.2.2.3.cmml">,</mo><msub id="alg1.l4.m1.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.cmml"><mi id="alg1.l4.m1.2.2.2.2.2.2" xref="alg1.l4.m1.2.2.2.2.2.2.cmml">σ</mi><mi id="alg1.l4.m1.2.2.2.2.2.3" xref="alg1.l4.m1.2.2.2.2.2.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l4.m1.2.2.3" xref="alg1.l4.m1.2.2.3.cmml">←</mo><mi id="alg1.l4.m1.2.2.4" xref="alg1.l4.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b"><apply id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2"><ci id="alg1.l4.m1.2.2.3.cmml" xref="alg1.l4.m1.2.2.3">←</ci><list id="alg1.l4.m1.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2"><apply id="alg1.l4.m1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.2">𝑤</ci><ci id="alg1.l4.m1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l4.m1.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l4.m1.2.2.2.2.2.1.cmml" xref="alg1.l4.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l4.m1.2.2.2.2.2.2.cmml" xref="alg1.l4.m1.2.2.2.2.2.2">𝜎</ci><ci id="alg1.l4.m1.2.2.2.2.2.3.cmml" xref="alg1.l4.m1.2.2.2.2.2.3">𝑖</ci></apply></list><csymbol cd="latexml" id="alg1.l4.m1.2.2.4.cmml" xref="alg1.l4.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.2c">w_{i},\sigma_{i}\leftarrow</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_smallcaps">ClientUpdate</span>(<math id="alg1.l4.m2.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="alg1.l4.m2.1a"><msub id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mi id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml">w</mi><mi id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1">subscript</csymbol><ci id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2">𝑤</ci><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">w_{i}</annotation></semantics></math>)
         
</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>         <math id="alg1.l5.m1.1" class="ltx_Math" alttext="w_{g}=\sum_{i=1}^{N}\pi_{i}w_{i}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">g</mi></msub><mo rspace="0.111em" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">=</mo><mrow id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><msubsup id="alg1.l5.m1.1.1.3.1" xref="alg1.l5.m1.1.1.3.1.cmml"><mo id="alg1.l5.m1.1.1.3.1.2.2" xref="alg1.l5.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l5.m1.1.1.3.1.2.3" xref="alg1.l5.m1.1.1.3.1.2.3.cmml"><mi id="alg1.l5.m1.1.1.3.1.2.3.2" xref="alg1.l5.m1.1.1.3.1.2.3.2.cmml">i</mi><mo id="alg1.l5.m1.1.1.3.1.2.3.1" xref="alg1.l5.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l5.m1.1.1.3.1.2.3.3" xref="alg1.l5.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l5.m1.1.1.3.1.3" xref="alg1.l5.m1.1.1.3.1.3.cmml">N</mi></msubsup><mrow id="alg1.l5.m1.1.1.3.2" xref="alg1.l5.m1.1.1.3.2.cmml"><msub id="alg1.l5.m1.1.1.3.2.2" xref="alg1.l5.m1.1.1.3.2.2.cmml"><mi id="alg1.l5.m1.1.1.3.2.2.2" xref="alg1.l5.m1.1.1.3.2.2.2.cmml">π</mi><mi id="alg1.l5.m1.1.1.3.2.2.3" xref="alg1.l5.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.3.2.1" xref="alg1.l5.m1.1.1.3.2.1.cmml">​</mo><msub id="alg1.l5.m1.1.1.3.2.3" xref="alg1.l5.m1.1.1.3.2.3.cmml"><mi id="alg1.l5.m1.1.1.3.2.3.2" xref="alg1.l5.m1.1.1.3.2.3.2.cmml">w</mi><mi id="alg1.l5.m1.1.1.3.2.3.3" xref="alg1.l5.m1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><eq id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"></eq><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑤</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑔</ci></apply><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><apply id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.1.cmml" xref="alg1.l5.m1.1.1.3.1">superscript</csymbol><apply id="alg1.l5.m1.1.1.3.1.2.cmml" xref="alg1.l5.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.2.1.cmml" xref="alg1.l5.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l5.m1.1.1.3.1.2.2.cmml" xref="alg1.l5.m1.1.1.3.1.2.2"></sum><apply id="alg1.l5.m1.1.1.3.1.2.3.cmml" xref="alg1.l5.m1.1.1.3.1.2.3"><eq id="alg1.l5.m1.1.1.3.1.2.3.1.cmml" xref="alg1.l5.m1.1.1.3.1.2.3.1"></eq><ci id="alg1.l5.m1.1.1.3.1.2.3.2.cmml" xref="alg1.l5.m1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l5.m1.1.1.3.1.2.3.3.cmml" xref="alg1.l5.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l5.m1.1.1.3.1.3.cmml" xref="alg1.l5.m1.1.1.3.1.3">𝑁</ci></apply><apply id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3.2"><times id="alg1.l5.m1.1.1.3.2.1.cmml" xref="alg1.l5.m1.1.1.3.2.1"></times><apply id="alg1.l5.m1.1.1.3.2.2.cmml" xref="alg1.l5.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.2.2.1.cmml" xref="alg1.l5.m1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.2.2.cmml" xref="alg1.l5.m1.1.1.3.2.2.2">𝜋</ci><ci id="alg1.l5.m1.1.1.3.2.2.3.cmml" xref="alg1.l5.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="alg1.l5.m1.1.1.3.2.3.cmml" xref="alg1.l5.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.2.3.1.cmml" xref="alg1.l5.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.3.2.cmml" xref="alg1.l5.m1.1.1.3.2.3.2">𝑤</ci><ci id="alg1.l5.m1.1.1.3.2.3.3.cmml" xref="alg1.l5.m1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">w_{g}=\sum_{i=1}^{N}\pi_{i}w_{i}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>         <math id="alg1.l6.m1.1" class="ltx_Math" alttext="\sigma_{g}=\sum_{i=1}^{N}\pi_{i}\sigma_{i}+\pi_{i}(w_{i}-w)" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msub id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">σ</mi><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">g</mi></msub><mo rspace="0.111em" id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">=</mo><mrow id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml"><mrow id="alg1.l6.m1.1.1.1.3" xref="alg1.l6.m1.1.1.1.3.cmml"><msubsup id="alg1.l6.m1.1.1.1.3.1" xref="alg1.l6.m1.1.1.1.3.1.cmml"><mo id="alg1.l6.m1.1.1.1.3.1.2.2" xref="alg1.l6.m1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg1.l6.m1.1.1.1.3.1.2.3" xref="alg1.l6.m1.1.1.1.3.1.2.3.cmml"><mi id="alg1.l6.m1.1.1.1.3.1.2.3.2" xref="alg1.l6.m1.1.1.1.3.1.2.3.2.cmml">i</mi><mo id="alg1.l6.m1.1.1.1.3.1.2.3.1" xref="alg1.l6.m1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg1.l6.m1.1.1.1.3.1.2.3.3" xref="alg1.l6.m1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l6.m1.1.1.1.3.1.3" xref="alg1.l6.m1.1.1.1.3.1.3.cmml">N</mi></msubsup><mrow id="alg1.l6.m1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.3.2.cmml"><msub id="alg1.l6.m1.1.1.1.3.2.2" xref="alg1.l6.m1.1.1.1.3.2.2.cmml"><mi id="alg1.l6.m1.1.1.1.3.2.2.2" xref="alg1.l6.m1.1.1.1.3.2.2.2.cmml">π</mi><mi id="alg1.l6.m1.1.1.1.3.2.2.3" xref="alg1.l6.m1.1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.3.2.1" xref="alg1.l6.m1.1.1.1.3.2.1.cmml">​</mo><msub id="alg1.l6.m1.1.1.1.3.2.3" xref="alg1.l6.m1.1.1.1.3.2.3.cmml"><mi id="alg1.l6.m1.1.1.1.3.2.3.2" xref="alg1.l6.m1.1.1.1.3.2.3.2.cmml">σ</mi><mi id="alg1.l6.m1.1.1.1.3.2.3.3" xref="alg1.l6.m1.1.1.1.3.2.3.3.cmml">i</mi></msub></mrow></mrow><mo id="alg1.l6.m1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.3.2" xref="alg1.l6.m1.1.1.1.1.3.2.cmml">π</mi><mi id="alg1.l6.m1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l6.m1.1.1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="alg1.l6.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l6.m1.1.1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l6.m1.1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml">w</mi></mrow><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><eq id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"></eq><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝜎</ci><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝑔</ci></apply><apply id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"><plus id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.2"></plus><apply id="alg1.l6.m1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.3"><apply id="alg1.l6.m1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.1.1.cmml" xref="alg1.l6.m1.1.1.1.3.1">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.3.1.2.cmml" xref="alg1.l6.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.3.1">subscript</csymbol><sum id="alg1.l6.m1.1.1.1.3.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.3.1.2.2"></sum><apply id="alg1.l6.m1.1.1.1.3.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.3.1.2.3"><eq id="alg1.l6.m1.1.1.1.3.1.2.3.1.cmml" xref="alg1.l6.m1.1.1.1.3.1.2.3.1"></eq><ci id="alg1.l6.m1.1.1.1.3.1.2.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l6.m1.1.1.1.3.1.2.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l6.m1.1.1.1.3.1.3.cmml" xref="alg1.l6.m1.1.1.1.3.1.3">𝑁</ci></apply><apply id="alg1.l6.m1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.2"><times id="alg1.l6.m1.1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.3.2.1"></times><apply id="alg1.l6.m1.1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.2.2.1.cmml" xref="alg1.l6.m1.1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.2.2.2.cmml" xref="alg1.l6.m1.1.1.1.3.2.2.2">𝜋</ci><ci id="alg1.l6.m1.1.1.1.3.2.2.3.cmml" xref="alg1.l6.m1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="alg1.l6.m1.1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.3.2.3.1.cmml" xref="alg1.l6.m1.1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.3.2.3.2.cmml" xref="alg1.l6.m1.1.1.1.3.2.3.2">𝜎</ci><ci id="alg1.l6.m1.1.1.1.3.2.3.3.cmml" xref="alg1.l6.m1.1.1.1.3.2.3.3">𝑖</ci></apply></apply></apply><apply id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1"><times id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.2"></times><apply id="alg1.l6.m1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.3.2">𝜋</ci><ci id="alg1.l6.m1.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="alg1.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"><minus id="alg1.l6.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.1"></minus><apply id="alg1.l6.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="alg1.l6.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.1.1.3">𝑤</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\sigma_{g}=\sum_{i=1}^{N}\pi_{i}\sigma_{i}+\pi_{i}(w_{i}-w)</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>         Get threshold <math id="alg1.l7.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">a</annotation></semantics></math> using proportion <math id="alg1.l7.m2.1" class="ltx_Math" alttext="p" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">p</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>         Calculate mask <math id="alg1.l8.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="alg1.l8.m1.1a"><mi id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><ci id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">M</annotation></semantics></math> from <math id="alg1.l8.m2.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="alg1.l8.m2.1a"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">\sigma</annotation></semantics></math> by Equation <a href="#S3.E3" title="In 3.2 Bayesian Neural Network For Personalized Parameters Selection ‣ 3 Proposed Method ‣ Bayesian Neural Network For Personalized Federated Learning Parameter Selection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>         <math id="alg1.l9.m1.1" class="ltx_Math" alttext="w_{i}=w_{i}\odot M+w_{g}\odot(1-M)" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">w</mi><mi id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">i</mi></msub><mo id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">=</mo><mrow id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.1.1.1.3.cmml"><msub id="alg1.l9.m1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.3.2.cmml"><mi id="alg1.l9.m1.1.1.1.3.2.2" xref="alg1.l9.m1.1.1.1.3.2.2.cmml">w</mi><mi id="alg1.l9.m1.1.1.1.3.2.3" xref="alg1.l9.m1.1.1.1.3.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l9.m1.1.1.1.3.1" xref="alg1.l9.m1.1.1.1.3.1.cmml">⊙</mo><mi id="alg1.l9.m1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.3.3.cmml">M</mi></mrow><mo id="alg1.l9.m1.1.1.1.2" xref="alg1.l9.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l9.m1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.cmml"><msub id="alg1.l9.m1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.1.3.2.cmml">w</mi><mi id="alg1.l9.m1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.3.3.cmml">g</mi></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l9.m1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.2.cmml">⊙</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml"><mn id="alg1.l9.m1.1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l9.m1.1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l9.m1.1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.3.cmml">M</mi></mrow><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"></eq><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝑤</ci><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">𝑖</ci></apply><apply id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"><plus id="alg1.l9.m1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.2"></plus><apply id="alg1.l9.m1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.3"><csymbol cd="latexml" id="alg1.l9.m1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.3.1">direct-product</csymbol><apply id="alg1.l9.m1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.3.2.1.cmml" xref="alg1.l9.m1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.3.2.2.cmml" xref="alg1.l9.m1.1.1.1.3.2.2">𝑤</ci><ci id="alg1.l9.m1.1.1.1.3.2.3.cmml" xref="alg1.l9.m1.1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.l9.m1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.3.3">𝑀</ci></apply><apply id="alg1.l9.m1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1"><csymbol cd="latexml" id="alg1.l9.m1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.2">direct-product</csymbol><apply id="alg1.l9.m1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.3.2">𝑤</ci><ci id="alg1.l9.m1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.3.3">𝑔</ci></apply><apply id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1"><minus id="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.l9.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2">1</cn><ci id="alg1.l9.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.3">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">w_{i}=w_{i}\odot M+w_{g}\odot(1-M)</annotation></semantics></math>
     
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span><span id="alg1.l10.2" class="ltx_text ltx_font_bold">procedure</span> <span id="alg1.l10.3" class="ltx_text ltx_font_smallcaps">ClientUpdate</span>(w)

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l11.m1.4" class="ltx_Math" alttext="e=1,2,\ldots,E" display="inline"><semantics id="alg1.l11.m1.4a"><mrow id="alg1.l11.m1.4.5" xref="alg1.l11.m1.4.5.cmml"><mi id="alg1.l11.m1.4.5.2" xref="alg1.l11.m1.4.5.2.cmml">e</mi><mo id="alg1.l11.m1.4.5.1" xref="alg1.l11.m1.4.5.1.cmml">=</mo><mrow id="alg1.l11.m1.4.5.3.2" xref="alg1.l11.m1.4.5.3.1.cmml"><mn id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">1</mn><mo id="alg1.l11.m1.4.5.3.2.1" xref="alg1.l11.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml">2</mn><mo id="alg1.l11.m1.4.5.3.2.2" xref="alg1.l11.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l11.m1.3.3" xref="alg1.l11.m1.3.3.cmml">…</mi><mo id="alg1.l11.m1.4.5.3.2.3" xref="alg1.l11.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l11.m1.4.4" xref="alg1.l11.m1.4.4.cmml">E</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.4b"><apply id="alg1.l11.m1.4.5.cmml" xref="alg1.l11.m1.4.5"><eq id="alg1.l11.m1.4.5.1.cmml" xref="alg1.l11.m1.4.5.1"></eq><ci id="alg1.l11.m1.4.5.2.cmml" xref="alg1.l11.m1.4.5.2">𝑒</ci><list id="alg1.l11.m1.4.5.3.1.cmml" xref="alg1.l11.m1.4.5.3.2"><cn type="integer" id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">1</cn><cn type="integer" id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2">2</cn><ci id="alg1.l11.m1.3.3.cmml" xref="alg1.l11.m1.3.3">…</ci><ci id="alg1.l11.m1.4.4.cmml" xref="alg1.l11.m1.4.4">𝐸</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.4c">e=1,2,\ldots,E</annotation></semantics></math> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>         <math id="alg1.l12.m1.1" class="ltx_Math" alttext="w\leftarrow w-\eta\nabla f(w)" display="inline"><semantics id="alg1.l12.m1.1a"><mrow id="alg1.l12.m1.1.2" xref="alg1.l12.m1.1.2.cmml"><mi id="alg1.l12.m1.1.2.2" xref="alg1.l12.m1.1.2.2.cmml">w</mi><mo stretchy="false" id="alg1.l12.m1.1.2.1" xref="alg1.l12.m1.1.2.1.cmml">←</mo><mrow id="alg1.l12.m1.1.2.3" xref="alg1.l12.m1.1.2.3.cmml"><mi id="alg1.l12.m1.1.2.3.2" xref="alg1.l12.m1.1.2.3.2.cmml">w</mi><mo id="alg1.l12.m1.1.2.3.1" xref="alg1.l12.m1.1.2.3.1.cmml">−</mo><mrow id="alg1.l12.m1.1.2.3.3" xref="alg1.l12.m1.1.2.3.3.cmml"><mi id="alg1.l12.m1.1.2.3.3.2" xref="alg1.l12.m1.1.2.3.3.2.cmml">η</mi><mo lspace="0.167em" rspace="0em" id="alg1.l12.m1.1.2.3.3.1" xref="alg1.l12.m1.1.2.3.3.1.cmml">​</mo><mrow id="alg1.l12.m1.1.2.3.3.3" xref="alg1.l12.m1.1.2.3.3.3.cmml"><mo rspace="0.167em" id="alg1.l12.m1.1.2.3.3.3.1" xref="alg1.l12.m1.1.2.3.3.3.1.cmml">∇</mo><mi id="alg1.l12.m1.1.2.3.3.3.2" xref="alg1.l12.m1.1.2.3.3.3.2.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l12.m1.1.2.3.3.1a" xref="alg1.l12.m1.1.2.3.3.1.cmml">​</mo><mrow id="alg1.l12.m1.1.2.3.3.4.2" xref="alg1.l12.m1.1.2.3.3.cmml"><mo stretchy="false" id="alg1.l12.m1.1.2.3.3.4.2.1" xref="alg1.l12.m1.1.2.3.3.cmml">(</mo><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">w</mi><mo stretchy="false" id="alg1.l12.m1.1.2.3.3.4.2.2" xref="alg1.l12.m1.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.2.cmml" xref="alg1.l12.m1.1.2"><ci id="alg1.l12.m1.1.2.1.cmml" xref="alg1.l12.m1.1.2.1">←</ci><ci id="alg1.l12.m1.1.2.2.cmml" xref="alg1.l12.m1.1.2.2">𝑤</ci><apply id="alg1.l12.m1.1.2.3.cmml" xref="alg1.l12.m1.1.2.3"><minus id="alg1.l12.m1.1.2.3.1.cmml" xref="alg1.l12.m1.1.2.3.1"></minus><ci id="alg1.l12.m1.1.2.3.2.cmml" xref="alg1.l12.m1.1.2.3.2">𝑤</ci><apply id="alg1.l12.m1.1.2.3.3.cmml" xref="alg1.l12.m1.1.2.3.3"><times id="alg1.l12.m1.1.2.3.3.1.cmml" xref="alg1.l12.m1.1.2.3.3.1"></times><ci id="alg1.l12.m1.1.2.3.3.2.cmml" xref="alg1.l12.m1.1.2.3.3.2">𝜂</ci><apply id="alg1.l12.m1.1.2.3.3.3.cmml" xref="alg1.l12.m1.1.2.3.3.3"><ci id="alg1.l12.m1.1.2.3.3.3.1.cmml" xref="alg1.l12.m1.1.2.3.3.3.1">∇</ci><ci id="alg1.l12.m1.1.2.3.3.3.2.cmml" xref="alg1.l12.m1.1.2.3.3.3.2">𝑓</ci></apply><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">w\leftarrow w-\eta\nabla f(w)</annotation></semantics></math>
     
</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     <math id="alg1.l13.m1.2" class="ltx_Math" alttext="\sigma\leftarrow\nabla_{w}^{2}\mathcal{L}(\mathcal{D}_{i};w)" display="inline"><semantics id="alg1.l13.m1.2a"><mrow id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2.cmml"><mi id="alg1.l13.m1.2.2.3" xref="alg1.l13.m1.2.2.3.cmml">σ</mi><mo stretchy="false" id="alg1.l13.m1.2.2.2" xref="alg1.l13.m1.2.2.2.cmml">←</mo><mrow id="alg1.l13.m1.2.2.1" xref="alg1.l13.m1.2.2.1.cmml"><mrow id="alg1.l13.m1.2.2.1.3" xref="alg1.l13.m1.2.2.1.3.cmml"><msubsup id="alg1.l13.m1.2.2.1.3.1" xref="alg1.l13.m1.2.2.1.3.1.cmml"><mo rspace="0.167em" id="alg1.l13.m1.2.2.1.3.1.2.2" xref="alg1.l13.m1.2.2.1.3.1.2.2.cmml">∇</mo><mi id="alg1.l13.m1.2.2.1.3.1.2.3" xref="alg1.l13.m1.2.2.1.3.1.2.3.cmml">w</mi><mn id="alg1.l13.m1.2.2.1.3.1.3" xref="alg1.l13.m1.2.2.1.3.1.3.cmml">2</mn></msubsup><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.2.2.1.3.2" xref="alg1.l13.m1.2.2.1.3.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l13.m1.2.2.1.2" xref="alg1.l13.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l13.m1.2.2.1.1.1" xref="alg1.l13.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l13.m1.2.2.1.1.1.2" xref="alg1.l13.m1.2.2.1.1.2.cmml">(</mo><msub id="alg1.l13.m1.2.2.1.1.1.1" xref="alg1.l13.m1.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.2.2.1.1.1.1.2" xref="alg1.l13.m1.2.2.1.1.1.1.2.cmml">𝒟</mi><mi id="alg1.l13.m1.2.2.1.1.1.1.3" xref="alg1.l13.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l13.m1.2.2.1.1.1.3" xref="alg1.l13.m1.2.2.1.1.2.cmml">;</mo><mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">w</mi><mo stretchy="false" id="alg1.l13.m1.2.2.1.1.1.4" xref="alg1.l13.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.2b"><apply id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2"><ci id="alg1.l13.m1.2.2.2.cmml" xref="alg1.l13.m1.2.2.2">←</ci><ci id="alg1.l13.m1.2.2.3.cmml" xref="alg1.l13.m1.2.2.3">𝜎</ci><apply id="alg1.l13.m1.2.2.1.cmml" xref="alg1.l13.m1.2.2.1"><times id="alg1.l13.m1.2.2.1.2.cmml" xref="alg1.l13.m1.2.2.1.2"></times><apply id="alg1.l13.m1.2.2.1.3.cmml" xref="alg1.l13.m1.2.2.1.3"><apply id="alg1.l13.m1.2.2.1.3.1.cmml" xref="alg1.l13.m1.2.2.1.3.1"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.3.1.1.cmml" xref="alg1.l13.m1.2.2.1.3.1">superscript</csymbol><apply id="alg1.l13.m1.2.2.1.3.1.2.cmml" xref="alg1.l13.m1.2.2.1.3.1"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.3.1.2.1.cmml" xref="alg1.l13.m1.2.2.1.3.1">subscript</csymbol><ci id="alg1.l13.m1.2.2.1.3.1.2.2.cmml" xref="alg1.l13.m1.2.2.1.3.1.2.2">∇</ci><ci id="alg1.l13.m1.2.2.1.3.1.2.3.cmml" xref="alg1.l13.m1.2.2.1.3.1.2.3">𝑤</ci></apply><cn type="integer" id="alg1.l13.m1.2.2.1.3.1.3.cmml" xref="alg1.l13.m1.2.2.1.3.1.3">2</cn></apply><ci id="alg1.l13.m1.2.2.1.3.2.cmml" xref="alg1.l13.m1.2.2.1.3.2">ℒ</ci></apply><list id="alg1.l13.m1.2.2.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1"><apply id="alg1.l13.m1.2.2.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l13.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.2">𝒟</ci><ci id="alg1.l13.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l13.m1.2.2.1.1.1.1.3">𝑖</ci></apply><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">𝑤</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.2c">\sigma\leftarrow\nabla_{w}^{2}\mathcal{L}(\mathcal{D}_{i};w)</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     <span id="alg1.l14.2" class="ltx_text ltx_font_bold">Return</span> <math id="alg1.l14.m1.2" class="ltx_Math" alttext="w,\sigma" display="inline"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.3.2" xref="alg1.l14.m1.2.3.1.cmml"><mi id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml">w</mi><mo id="alg1.l14.m1.2.3.2.1" xref="alg1.l14.m1.2.3.1.cmml">,</mo><mi id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><list id="alg1.l14.m1.2.3.1.cmml" xref="alg1.l14.m1.2.3.2"><ci id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1">𝑤</ci><ci id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2">𝜎</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">w,\sigma</annotation></semantics></math>

</div>
</div>
</div>
</div>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Setup</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span id="S4.SS1.p1.1.1" class="ltx_text ltx_font_bold">Datasets</span> We evaluate our algorithm and the baseline on three popular datasets: MNIST, which consists of handwritten digits with 10 classes; Fashion-MNIST, featuring 10 clothing categories; and CIFAR-10, containing colored images with 10 classes.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Data Partition</span> To simulate each client’s heterogeneous dataset, we follow the approach of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Each client possesses an equal number of samples, but they are divided into major and minor classes. We set the number of major classes to 2, with the remaining classes designated as minor. The proportion of major classes to the total client data is represented as <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="s=0.2" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">s</mi><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml">0.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><eq id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></eq><ci id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2">𝑠</ci><cn type="float" id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3">0.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">s=0.2</annotation></semantics></math> which quantifies the degree of data heterogeneity. In line with the personalized federated learning setup, we apply the same partitioning to the test set to ensure that both the training and test sets are drawn from the same distribution.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.2.1.1" class="ltx_text ltx_font_bold">Table 1</span>: </span>The final test accuracy on different datasets under non-IID settings.</figcaption>
<table id="S4.T1.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.3.1.1" class="ltx_tr">
<th id="S4.T1.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Method</th>
<th id="S4.T1.3.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">MNIST</th>
<th id="S4.T1.3.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">FMNIST</th>
<th id="S4.T1.3.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">CIFAR10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.3.2.1" class="ltx_tr">
<td id="S4.T1.3.2.1.1" class="ltx_td ltx_align_left ltx_border_t">FedAvg</td>
<td id="S4.T1.3.2.1.2" class="ltx_td ltx_align_left ltx_border_t"><span id="S4.T1.3.2.1.2.1" class="ltx_text ltx_font_bold">98.49</span></td>
<td id="S4.T1.3.2.1.3" class="ltx_td ltx_align_left ltx_border_t">87.28</td>
<td id="S4.T1.3.2.1.4" class="ltx_td ltx_align_left ltx_border_t">71.53</td>
</tr>
<tr id="S4.T1.3.3.2" class="ltx_tr">
<td id="S4.T1.3.3.2.1" class="ltx_td ltx_align_left">FedPer</td>
<td id="S4.T1.3.3.2.2" class="ltx_td ltx_align_left">96.48</td>
<td id="S4.T1.3.3.2.3" class="ltx_td ltx_align_left">92.09</td>
<td id="S4.T1.3.3.2.4" class="ltx_td ltx_align_left">75.27</td>
</tr>
<tr id="S4.T1.3.4.3" class="ltx_tr">
<td id="S4.T1.3.4.3.1" class="ltx_td ltx_align_left">LG-FedAvg</td>
<td id="S4.T1.3.4.3.2" class="ltx_td ltx_align_left">96.44</td>
<td id="S4.T1.3.4.3.3" class="ltx_td ltx_align_left">91.92</td>
<td id="S4.T1.3.4.3.4" class="ltx_td ltx_align_left">76.52</td>
</tr>
<tr id="S4.T1.3.5.4" class="ltx_tr">
<td id="S4.T1.3.5.4.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">FedBPS(ours)</td>
<td id="S4.T1.3.5.4.2" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">96.87</td>
<td id="S4.T1.3.5.4.3" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><span id="S4.T1.3.5.4.3.1" class="ltx_text ltx_font_bold">92.51</span></td>
<td id="S4.T1.3.5.4.4" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t"><span id="S4.T1.3.5.4.4.1" class="ltx_text ltx_font_bold">76.80</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.2.1.1" class="ltx_text ltx_font_bold">Table 2</span>: </span>The impact of different datasets on hyperparameters in a heterogeneous data setting.</figcaption>
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.3.1.1" class="ltx_tr">
<th id="S4.T2.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">Proportion</th>
<th id="S4.T2.3.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">MNIST</th>
<th id="S4.T2.3.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">FMNIST</th>
<th id="S4.T2.3.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">CIFAR10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.3.2.1" class="ltx_tr">
<td id="S4.T2.3.2.1.1" class="ltx_td ltx_align_left ltx_border_t">30%</td>
<td id="S4.T2.3.2.1.2" class="ltx_td ltx_align_left ltx_border_t">95.44</td>
<td id="S4.T2.3.2.1.3" class="ltx_td ltx_align_left ltx_border_t">91.13</td>
<td id="S4.T2.3.2.1.4" class="ltx_td ltx_align_left ltx_border_t">75.27</td>
</tr>
<tr id="S4.T2.3.3.2" class="ltx_tr">
<td id="S4.T2.3.3.2.1" class="ltx_td ltx_align_left">50%</td>
<td id="S4.T2.3.3.2.2" class="ltx_td ltx_align_left"><span id="S4.T2.3.3.2.2.1" class="ltx_text ltx_font_bold">97.74</span></td>
<td id="S4.T2.3.3.2.3" class="ltx_td ltx_align_left"><span id="S4.T2.3.3.2.3.1" class="ltx_text ltx_font_bold">93.14</span></td>
<td id="S4.T2.3.3.2.4" class="ltx_td ltx_align_left">75.72</td>
</tr>
<tr id="S4.T2.3.4.3" class="ltx_tr">
<td id="S4.T2.3.4.3.1" class="ltx_td ltx_align_left">70%</td>
<td id="S4.T2.3.4.3.2" class="ltx_td ltx_align_left">96.87</td>
<td id="S4.T2.3.4.3.3" class="ltx_td ltx_align_left">92.52</td>
<td id="S4.T2.3.4.3.4" class="ltx_td ltx_align_left"><span id="S4.T2.3.4.3.4.1" class="ltx_text ltx_font_bold">76.80</span></td>
</tr>
<tr id="S4.T2.3.5.4" class="ltx_tr">
<td id="S4.T2.3.5.4.1" class="ltx_td ltx_align_left ltx_border_bb">90%</td>
<td id="S4.T2.3.5.4.2" class="ltx_td ltx_align_left ltx_border_bb">96.23</td>
<td id="S4.T2.3.5.4.3" class="ltx_td ltx_align_left ltx_border_bb">92.19</td>
<td id="S4.T2.3.5.4.4" class="ltx_td ltx_align_left ltx_border_bb">76.23</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p"><span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_bold">Baselines</span> We will compare the following three baselines: FedAvg, representing the traditional setup where the goal is to learn a global model; FedPer, which employs the classifier as a personalized layer; and LG-FedAvg, which uses the feature extractor as a personalized layer. By contrasting FedPer and LG-FedAvg with these layer-based personalization algorithms, we aim to gain intuitive insights into the effectiveness of the algorithms. Our method, FedBPS, using <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="70\%" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mn id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">70</mn><mo id="S4.SS1.p3.1.m1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><csymbol cd="latexml" id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">70\%</annotation></semantics></math> of the parameters as personalized parameters.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.5" class="ltx_p"><span id="S4.SS1.p4.5.1" class="ltx_text ltx_font_bold">Implementation details</span> For each method, we will adopt common settings for local training. We will use SGD as the local optimizer with a learning rate of <math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="\eta=0.01" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">η</mi><mo id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"></eq><ci id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2">𝜂</ci><cn type="float" id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\eta=0.01</annotation></semantics></math>, a batch size of <math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="B=128" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><mrow id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml">B</mi><mo id="S4.SS1.p4.2.m2.1.1.1" xref="S4.SS1.p4.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml">128</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.2.m2.1b"><apply id="S4.SS1.p4.2.m2.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1"><eq id="S4.SS1.p4.2.m2.1.1.1.cmml" xref="S4.SS1.p4.2.m2.1.1.1"></eq><ci id="S4.SS1.p4.2.m2.1.1.2.cmml" xref="S4.SS1.p4.2.m2.1.1.2">𝐵</ci><cn type="integer" id="S4.SS1.p4.2.m2.1.1.3.cmml" xref="S4.SS1.p4.2.m2.1.1.3">128</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.2.m2.1c">B=128</annotation></semantics></math>, weight decay set to 5e-4, and momentum set to 0.9. In the context of federated learning, the local epoch will be set to <math id="S4.SS1.p4.3.m3.1" class="ltx_Math" alttext="E=5" display="inline"><semantics id="S4.SS1.p4.3.m3.1a"><mrow id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.2" xref="S4.SS1.p4.3.m3.1.1.2.cmml">E</mi><mo id="S4.SS1.p4.3.m3.1.1.1" xref="S4.SS1.p4.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.3.m3.1b"><apply id="S4.SS1.p4.3.m3.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1"><eq id="S4.SS1.p4.3.m3.1.1.1.cmml" xref="S4.SS1.p4.3.m3.1.1.1"></eq><ci id="S4.SS1.p4.3.m3.1.1.2.cmml" xref="S4.SS1.p4.3.m3.1.1.2">𝐸</ci><cn type="integer" id="S4.SS1.p4.3.m3.1.1.3.cmml" xref="S4.SS1.p4.3.m3.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.3.m3.1c">E=5</annotation></semantics></math>. The total communication rounds will be set to <math id="S4.SS1.p4.4.m4.1" class="ltx_Math" alttext="T=60" display="inline"><semantics id="S4.SS1.p4.4.m4.1a"><mrow id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml"><mi id="S4.SS1.p4.4.m4.1.1.2" xref="S4.SS1.p4.4.m4.1.1.2.cmml">T</mi><mo id="S4.SS1.p4.4.m4.1.1.1" xref="S4.SS1.p4.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.4.m4.1.1.3" xref="S4.SS1.p4.4.m4.1.1.3.cmml">60</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.4.m4.1b"><apply id="S4.SS1.p4.4.m4.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1"><eq id="S4.SS1.p4.4.m4.1.1.1.cmml" xref="S4.SS1.p4.4.m4.1.1.1"></eq><ci id="S4.SS1.p4.4.m4.1.1.2.cmml" xref="S4.SS1.p4.4.m4.1.1.2">𝑇</ci><cn type="integer" id="S4.SS1.p4.4.m4.1.1.3.cmml" xref="S4.SS1.p4.4.m4.1.1.3">60</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.4.m4.1c">T=60</annotation></semantics></math> for MNIST and Fashion-MNIST, and <math id="S4.SS1.p4.5.m5.1" class="ltx_Math" alttext="T=100" display="inline"><semantics id="S4.SS1.p4.5.m5.1a"><mrow id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml"><mi id="S4.SS1.p4.5.m5.1.1.2" xref="S4.SS1.p4.5.m5.1.1.2.cmml">T</mi><mo id="S4.SS1.p4.5.m5.1.1.1" xref="S4.SS1.p4.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS1.p4.5.m5.1.1.3" xref="S4.SS1.p4.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.5.m5.1b"><apply id="S4.SS1.p4.5.m5.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1"><eq id="S4.SS1.p4.5.m5.1.1.1.cmml" xref="S4.SS1.p4.5.m5.1.1.1"></eq><ci id="S4.SS1.p4.5.m5.1.1.2.cmml" xref="S4.SS1.p4.5.m5.1.1.2">𝑇</ci><cn type="integer" id="S4.SS1.p4.5.m5.1.1.3.cmml" xref="S4.SS1.p4.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.5.m5.1c">T=100</annotation></semantics></math> for CIFAR-10. For the neural networks, we will employ LeNet-5<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> for MNIST and Fashion-MNIST. For CIFAR-10, we will make adjustments to LeNet by preserving its architectural structure while increasing the network’s width, all networks with two sets of convolutional and pooling layers, followed by three fully-connected layers. To investigate the effect of network depth on hyperparameters, we will conduct experiments using ResNet<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> architectures of varying depths on the CIFAR-10 dataset.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Numerical Results</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We conducted experiments on three distinct datasets, and it is evident from the results in Table <a href="#S4.T1" title="Table 1 ‣ 4.1 Setup ‣ 4 Experiments ‣ Bayesian Neural Network For Personalized Federated Learning Parameter Selection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> that our method outperforms the baseline in most scenarios. The only exception is observed in the case of the MNIST dataset, where FedAvg exhibits superior performance. Nevertheless, our approach still achieves higher accuracy compared to layer-level personalized methods. These experiments substantiate the effectiveness of our algorithm.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2402.16091/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="257" height="191" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text ltx_font_bold">Fig. 3</span>: </span>The impact of personalization proportion on accuracy under the FMNIST dataset.</figcaption>
</figure>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.3" class="ltx_p">Clearly, the proportion of personalized parameters has a profound impact on the algorithm’s effectiveness. Here, we continue to assess the influence of hyperparameters on experimental results across these three datasets. We conducted experiments with personalization proportions of <math id="S4.SS2.p2.1.m1.4" class="ltx_Math" alttext="30\%,50\%,70\%,90\%" display="inline"><semantics id="S4.SS2.p2.1.m1.4a"><mrow id="S4.SS2.p2.1.m1.4.4.4" xref="S4.SS2.p2.1.m1.4.4.5.cmml"><mrow id="S4.SS2.p2.1.m1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.cmml"><mn id="S4.SS2.p2.1.m1.1.1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.1.1.2.cmml">30</mn><mo id="S4.SS2.p2.1.m1.1.1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.1.1.cmml">%</mo></mrow><mo id="S4.SS2.p2.1.m1.4.4.4.5" xref="S4.SS2.p2.1.m1.4.4.5.cmml">,</mo><mrow id="S4.SS2.p2.1.m1.2.2.2.2" xref="S4.SS2.p2.1.m1.2.2.2.2.cmml"><mn id="S4.SS2.p2.1.m1.2.2.2.2.2" xref="S4.SS2.p2.1.m1.2.2.2.2.2.cmml">50</mn><mo id="S4.SS2.p2.1.m1.2.2.2.2.1" xref="S4.SS2.p2.1.m1.2.2.2.2.1.cmml">%</mo></mrow><mo id="S4.SS2.p2.1.m1.4.4.4.6" xref="S4.SS2.p2.1.m1.4.4.5.cmml">,</mo><mrow id="S4.SS2.p2.1.m1.3.3.3.3" xref="S4.SS2.p2.1.m1.3.3.3.3.cmml"><mn id="S4.SS2.p2.1.m1.3.3.3.3.2" xref="S4.SS2.p2.1.m1.3.3.3.3.2.cmml">70</mn><mo id="S4.SS2.p2.1.m1.3.3.3.3.1" xref="S4.SS2.p2.1.m1.3.3.3.3.1.cmml">%</mo></mrow><mo id="S4.SS2.p2.1.m1.4.4.4.7" xref="S4.SS2.p2.1.m1.4.4.5.cmml">,</mo><mrow id="S4.SS2.p2.1.m1.4.4.4.4" xref="S4.SS2.p2.1.m1.4.4.4.4.cmml"><mn id="S4.SS2.p2.1.m1.4.4.4.4.2" xref="S4.SS2.p2.1.m1.4.4.4.4.2.cmml">90</mn><mo id="S4.SS2.p2.1.m1.4.4.4.4.1" xref="S4.SS2.p2.1.m1.4.4.4.4.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.4b"><list id="S4.SS2.p2.1.m1.4.4.5.cmml" xref="S4.SS2.p2.1.m1.4.4.4"><apply id="S4.SS2.p2.1.m1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS2.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.1.m1.1.1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.1.1.2">30</cn></apply><apply id="S4.SS2.p2.1.m1.2.2.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2"><csymbol cd="latexml" id="S4.SS2.p2.1.m1.2.2.2.2.1.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.1.m1.2.2.2.2.2.cmml" xref="S4.SS2.p2.1.m1.2.2.2.2.2">50</cn></apply><apply id="S4.SS2.p2.1.m1.3.3.3.3.cmml" xref="S4.SS2.p2.1.m1.3.3.3.3"><csymbol cd="latexml" id="S4.SS2.p2.1.m1.3.3.3.3.1.cmml" xref="S4.SS2.p2.1.m1.3.3.3.3.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.1.m1.3.3.3.3.2.cmml" xref="S4.SS2.p2.1.m1.3.3.3.3.2">70</cn></apply><apply id="S4.SS2.p2.1.m1.4.4.4.4.cmml" xref="S4.SS2.p2.1.m1.4.4.4.4"><csymbol cd="latexml" id="S4.SS2.p2.1.m1.4.4.4.4.1.cmml" xref="S4.SS2.p2.1.m1.4.4.4.4.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.1.m1.4.4.4.4.2.cmml" xref="S4.SS2.p2.1.m1.4.4.4.4.2">90</cn></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.4c">30\%,50\%,70\%,90\%</annotation></semantics></math>, and the final outcomes are presented in Table <a href="#S4.T2" title="Table 2 ‣ 4.1 Setup ‣ 4 Experiments ‣ Bayesian Neural Network For Personalized Federated Learning Parameter Selection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. It is noteworthy that the optimal personalization proportion varies significantly depending on the dataset and model used. These results can only suggest that the optimal proportion may fall between <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mn id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">50</mn><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">50\%</annotation></semantics></math> and <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="90\%" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mn id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">90</mn><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><csymbol cd="latexml" id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">90\%</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">For ResNet architectures of different depths, the result are presented in Table <a href="#S4.T3" title="Table 3 ‣ 4.2 Numerical Results ‣ 4 Experiments ‣ Bayesian Neural Network For Personalized Federated Learning Parameter Selection" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. The recommended personalization proportion falls within the range of 70% to 100%, which differs from the earlier LeNet architecture. However, it is evident that the depth of network with similar architecture has minimal influence on the choice of personalization proportion.</p>
</div>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.2.1.1" class="ltx_text ltx_font_bold">Table 3</span>: </span>The impact of the depth of ResNet on hyperparameters in a heterogeneous data setting.</figcaption>
<table id="S4.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.3.1.1" class="ltx_tr">
<td id="S4.T3.3.1.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S4.T3.3.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">ResNet20</th>
<th id="S4.T3.3.1.1.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">ResNet32</th>
<th id="S4.T3.3.1.1.4" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">ResNet44</th>
<th id="S4.T3.3.1.1.5" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt">ResNet56</th>
</tr>
<tr id="S4.T3.3.2.2" class="ltx_tr">
<td id="S4.T3.3.2.2.1" class="ltx_td ltx_align_left ltx_border_t">30%</td>
<td id="S4.T3.3.2.2.2" class="ltx_td ltx_align_left ltx_border_t">72.13</td>
<td id="S4.T3.3.2.2.3" class="ltx_td ltx_align_left ltx_border_t">72.47</td>
<td id="S4.T3.3.2.2.4" class="ltx_td ltx_align_left ltx_border_t">72.17</td>
<td id="S4.T3.3.2.2.5" class="ltx_td ltx_align_left ltx_border_t">71.75</td>
</tr>
<tr id="S4.T3.3.3.3" class="ltx_tr">
<td id="S4.T3.3.3.3.1" class="ltx_td ltx_align_left">50%</td>
<td id="S4.T3.3.3.3.2" class="ltx_td ltx_align_left">73.21</td>
<td id="S4.T3.3.3.3.3" class="ltx_td ltx_align_left">72.96</td>
<td id="S4.T3.3.3.3.4" class="ltx_td ltx_align_left">73.19</td>
<td id="S4.T3.3.3.3.5" class="ltx_td ltx_align_left">73.34</td>
</tr>
<tr id="S4.T3.3.4.4" class="ltx_tr">
<td id="S4.T3.3.4.4.1" class="ltx_td ltx_align_left">70%</td>
<td id="S4.T3.3.4.4.2" class="ltx_td ltx_align_left">74.92</td>
<td id="S4.T3.3.4.4.3" class="ltx_td ltx_align_left">74.25</td>
<td id="S4.T3.3.4.4.4" class="ltx_td ltx_align_left">73.94</td>
<td id="S4.T3.3.4.4.5" class="ltx_td ltx_align_left">73.73</td>
</tr>
<tr id="S4.T3.3.5.5" class="ltx_tr">
<td id="S4.T3.3.5.5.1" class="ltx_td ltx_align_left ltx_border_bb">90%</td>
<td id="S4.T3.3.5.5.2" class="ltx_td ltx_align_left ltx_border_bb">75.08</td>
<td id="S4.T3.3.5.5.3" class="ltx_td ltx_align_left ltx_border_bb">74.96</td>
<td id="S4.T3.3.5.5.4" class="ltx_td ltx_align_left ltx_border_bb">74.49</td>
<td id="S4.T3.3.5.5.5" class="ltx_td ltx_align_left ltx_border_bb">74.60</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we introduced an approach for selecting personalized parameters to enable personalized federated learning, leveraging the uncertainty obtained from Bayesian neural networks for parameter selection. Our method offers enhanced flexibility, allowing for the selection of personalized parameters at a finer granularity, and incurs additional costs well within acceptable bounds compare with other Bayesian approach. Through experiments conducted on various datasets, we have validated the superior performance of our approach compared to layer-level personalized federated learning.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera
y Arcas,

</span>
<span class="ltx_bibblock">“Communication-efficient learning of deep networks from
decentralized data,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Artificial Intelligence and Statistics</span>. PMLR, 2017, pp.
1273–1282.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Yue Zhao, Meng Li, Liangzhen Lai, Naveen Suda, Damon Civin, and Vikas Chandra,

</span>
<span class="ltx_bibblock">“Federated learning with non-iid data,”

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1806.00582</span>, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith,

</span>
<span class="ltx_bibblock">“Federated optimization in heterogeneous networks,”

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">Proceedings of Machine Learning and Systems</span>, vol. 2, pp.
429–450, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh,

</span>
<span class="ltx_bibblock">“Scaffold: Stochastic controlled averaging for federated learning,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>. PMLR, 2020,
pp. 5132–5143.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Yue Tan, Guodong Long, Lu Liu, Tianyi Zhou, Qinghua Lu, Jing Jiang, and Chengqi
Zhang,

</span>
<span class="ltx_bibblock">“Fedproto: Federated prototype learning across heterogeneous
clients,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence</span>, 2022, vol. 36, pp. 8432–8440.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Jian Xu, Xinyi Tong, and Shao-Lun Huang,

</span>
<span class="ltx_bibblock">“Personalized federated learning with feature alignment and
classifier collaboration,”

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2023.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Felix Sattler, Klaus-Robert Müller, and Wojciech Samek,

</span>
<span class="ltx_bibblock">“Clustered federated learning: Model-agnostic distributed multitask
optimization under privacy constraints,”

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</span>, vol.
32, no. 8, pp. 3710–3722, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar,

</span>
<span class="ltx_bibblock">“Personalized federated learning with theoretical guarantees: A
model-agnostic meta-learning approach,”

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, vol. 33, pp.
3557–3568, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Durmus Alp Emre Acar, Yue Zhao, Ruizhao Zhu, Ramon Matas, Matthew Mattina, Paul
Whatmough, and Venkatesh Saligrama,

</span>
<span class="ltx_bibblock">“Debiasing model updates for improving personalized federated
training,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>. PMLR, 2021,
pp. 21–31.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Manoj Ghuhan Arivazhagan, Vinay Aggarwal, Aaditya Kumar Singh, and Sunav
Choudhary,

</span>
<span class="ltx_bibblock">“Federated learning with personalization layers,”

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1912.00818</span>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Paul Pu Liang, Terrance Liu, Liu Ziyin, Nicholas B Allen, Randy P Auerbach,
David Brent, Ruslan Salakhutdinov, and Louis-Philippe Morency,

</span>
<span class="ltx_bibblock">“Think locally, act globally: Federated learning with local and
global representations,”

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2001.01523</span>, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Alex Graves,

</span>
<span class="ltx_bibblock">“Practical variational inference for neural networks,”

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, vol. 24,
2011.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Charles Blundell, Julien Cornebise, Koray Kavukcuoglu, and Daan Wierstra,

</span>
<span class="ltx_bibblock">“Weight uncertainty in neural network,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>. PMLR, 2015,
pp. 1613–1622.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Michael Dusenberry, Ghassen Jerfel, Yeming Wen, Yian Ma, Jasper Snoek,
Katherine Heller, Balaji Lakshminarayanan, and Dustin Tran,

</span>
<span class="ltx_bibblock">“Efficient and scalable bayesian neural nets with rank-1 factors,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>. PMLR, 2020,
pp. 2782–2792.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Max Welling and Yee W Teh,

</span>
<span class="ltx_bibblock">“Bayesian learning via stochastic gradient langevin dynamics,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proceedings of the 28th International Conference on Machine
Learning</span>, 2011, pp. 681–688.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Ruqi Zhang, Chunyuan Li, Jianyi Zhang, Changyou Chen, and Andrew Gordon Wilson,

</span>
<span class="ltx_bibblock">“Cyclical stochastic gradient mcmc for bayesian deep learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">International Conference on Learning Representations</span>, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Khaoula El Mekkaoui, Diego Mesquita, Paul Blomstedt, and Samuel Kaski,

</span>
<span class="ltx_bibblock">“Federated stochastic gradient langevin dynamics,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Uncertainty in Artificial Intelligence</span>. PMLR, 2021, pp.
1703–1712.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Erik Daxberger, Agustinus Kristiadi, Alexander Immer, Runa Eschenhagen,
Matthias Bauer, and Philipp Hennig,

</span>
<span class="ltx_bibblock">“Laplace redux-effortless bayesian deep learning,”

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, vol. 34, pp.
20089–20103, 2021.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Yann LeCun, Léon Bottou, Yoshua Bengio, and Patrick Haffner,

</span>
<span class="ltx_bibblock">“Gradient-based learning applied to document recognition,”

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE</span>, vol. 86, no. 11, pp. 2278–2324, 1998.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun,

</span>
<span class="ltx_bibblock">“Deep residual learning for image recognition,”

</span>
<span class="ltx_bibblock">in <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition</span>, 2016, pp. 770–778.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2402.16090" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2402.16091" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2402.16091">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2402.16091" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2402.16092" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Mar  5 14:52:10 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
