<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1807.00459] How To Backdoor Federated Learning</title><meta property="og:description" content="Federated learning enables thousands of participants to construct a deep
learning model without sharing their private training data with each
other. For example, multiple smartphones can jointly train a next-word
predi…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How To Backdoor Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="How To Backdoor Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1807.00459">

<!--Generated on Sat Mar 16 15:10:51 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">How To Backdoor Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Eugene Bagdasaryan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id1.1.id1" class="ltx_text ltx_affiliation_institution">Cornell Tech, Cornell University</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:eugene@cs.cornell.edu">eugene@cs.cornell.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Andreas Veit
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id2.1.id1" class="ltx_text ltx_affiliation_institution">Cornell Tech, Cornell University</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:andreas@cs.cornell.edu">andreas@cs.cornell.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yiqing Hua
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id3.1.id1" class="ltx_text ltx_affiliation_institution">Cornell Tech, Cornell University</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:yiqing@cs.cornell.edu">yiqing@cs.cornell.edu</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Deborah Estrin
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id4.1.id1" class="ltx_text ltx_affiliation_institution">Cornell Tech, Cornell University</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:destrin@cs.cornell.edu">destrin@cs.cornell.edu</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Vitaly Shmatikov
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id5.1.id1" class="ltx_text ltx_affiliation_institution">Cornell Tech, Cornell University</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:shmat@cs.cornell.edu">shmat@cs.cornell.edu</a>
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p id="id6.id1" class="ltx_p">Federated learning enables thousands of participants to construct a deep
learning model without sharing their private training data with each
other. For example, multiple smartphones can jointly train a next-word
predictor for keyboards without revealing what individual users type.</p>
<p id="id7.id2" class="ltx_p">Federated models are created by aggregating model updates submitted
by participants. To protect confidentiality of the training data,
the aggregator by design has no visibility into how these updates are
generated. We show that this makes federated learning vulnerable to a
model-poisoning attack that is significantly more powerful than poisoning
attacks that target only the training data.</p>
<p id="id8.id3" class="ltx_p">A malicious participant can use <em id="id8.id3.1" class="ltx_emph ltx_font_italic">model replacement</em> to
introduce backdoor functionality into the joint model, e.g., modify
an image classifier so that it assigns an attacker-chosen label to
images with certain features, or force a word predictor to complete
certain sentences with an attacker-chosen word. These attacks can be
performed by a single participant or multiple colluding participants.
We evaluate model replacement under different assumptions for the
standard federated-learning tasks and show that it greatly outperforms
training-data poisoning.</p>
<p id="id9.id4" class="ltx_p">Federated learning employs secure aggregation to protect confidentiality
of participants’ local models and thus cannot prevent our attack by
detecting anomalies in participants’ contributions to the joint model.
To demonstrate that anomaly detection would not have been effective in
any case, we also develop and evaluate a generic constrain-and-scale
technique that incorporates the evasion of defenses into the attacker’s
loss function during training.</p>
</div>
<span id="id1" class="ltx_note ltx_note_frontmatter ltx_role_copyright"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>none</span></span></span>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Recently proposed <em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">federated learning</em> <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>; <a href="#bib.bib34" title="" class="ltx_ref">fedlearn_2, </a>; <a href="#bib.bib50" title="" class="ltx_ref">openmined, </a>; <a href="#bib.bib15" title="" class="ltx_ref">decentralizedml, </a>)</cite> is an attractive framework for
the massively distributed training of deep learning models with thousands
or even millions of participants <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib6" title="" class="ltx_ref">fedlearn_sys, </a>; <a href="#bib.bib25" title="" class="ltx_ref">hard2018federated, </a>)</cite>.
In every round, the central server distributes the current joint model to
a random subset of participants. Each of them trains locally and submits
an updated model to the server, which averages the updates into the new
joint model. Motivating applications include training image classifiers
and next-word predictors on users’ smartphones. To take advantage of
a wide range of non-i.i.d. training data while ensuring participants’
privacy, federated learning by design has no visibility into participants’
local data and training.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1807.00459/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="263" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span><span id="S1.F1.2.1" class="ltx_text ltx_font_bold">Overview of the attack.</span> The attacker compromises one
or more of the participants, trains a model on the backdoor data using
our constrain-and-scale technique, and submits the resulting model,
which replaces the joint model as the result of federated averaging.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Our main insight is that <span id="S1.p2.1.1" class="ltx_text ltx_font_bold">federated learning is generically
vulnerable to model poisoning</span>, which is a new class of poisoning attacks
introduced for the first time in this paper. Previous poisoning attacks
target only the training data. Model poisoning exploits the fact that
federated learning gives malicious participants direct influence over
the joint model, enabling significantly more powerful attacks than
training-data poisoning.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">We show that any participant in federated learning can replace the joint
model with another so that (i) the new model is equally accurate on the
federated-learning task, yet (ii) the attacker controls how the model
performs on an attacker-chosen <span id="S1.p3.1.1" class="ltx_text ltx_font_bold">backdoor</span> subtask. For example,
a backdoored image-classification model misclassifies images with certain
features to an attacker-chosen class; a backdoored word-prediction model
predicts attacker-chosen words for certain sentences.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Fig. <a href="#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> gives a high-level overview of this attack.
Model replacement takes advantage of the observation that a participant
in federated learning can (1) directly influence the weights of the
joint model, and (2) train in any way that benefits the attack, e.g.,
arbitrarily modify the weights of its local model and/or incorporate
the evasion of potential defenses into its loss function during training.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.2" class="ltx_p">We demonstrate the power of model replacement on two concrete learning
tasks from the federated-learning literature: image classification on
CIFAR-10 and word prediction on a Reddit corpus. Even a single-shot
attack, where <em id="S1.p5.2.1" class="ltx_emph ltx_font_italic">a single attacker is selected in a single round
of training</em>, causes the joint model to achieve 100% accuracy on
the backdoor task. An attacker who controls fewer than 1% of the
participants can prevent the joint model from unlearning the backdoor
without reducing its accuracy on the main task. Model replacement greatly
outperforms “traditional” data poisoning: in a word-prediction task
with 80,000 participants, compromising just <math id="S1.p5.1.m1.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S1.p5.1.m1.1a"><mn id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><cn type="integer" id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">8</annotation></semantics></math> is enough to achieve 50%
backdoor accuracy, as compared to <math id="S1.p5.2.m2.1" class="ltx_Math" alttext="400" display="inline"><semantics id="S1.p5.2.m2.1a"><mn id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml">400</mn><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><cn type="integer" id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1">400</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">400</annotation></semantics></math> malicious participants needed
for the data-poisoning attack.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We argue that federated learning is generically vulnerable to
backdoors and other model-poisoning attacks. First, when training with
millions of participants, it is impossible to ensure that none of them
are malicious. The possibility of training with multiple malicious
participants is explicitly acknowledged by the designers of federated
learning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib6" title="" class="ltx_ref">fedlearn_sys, </a>)</cite>. Second, <em id="S1.p6.1.1" class="ltx_emph ltx_font_italic">neither defenses against data
poisoning, nor anomaly detection can be used during federated learning</em>
because they require access to, respectively, the participants’
training data or their submitted model updates. The aggregation
server cannot observe either the training data, or model updates
based on these data <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib48" title="" class="ltx_ref">nasr2018comprehensive, </a>; <a href="#bib.bib45" title="" class="ltx_ref">melis2018inference, </a>)</cite>
without breaking participants’ privacy, which is the key motivation
for federated learning. Latest versions of federated learning employ
“secure aggregation” <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib7" title="" class="ltx_ref">bonawitz2017practical, </a>)</cite>, which provably
prevents anyone from auditing participants’ data or updates.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">Proposed techniques for Byzantine-tolerant distributed learning make
assumptions that are explicitly false for federated learning with
adversarial participants (e.g., they assume that the participants’
training data are i.i.d., unmodified, and equally distributed).
We show how to exploit some of these techniques, such as Krum
sampling <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib5" title="" class="ltx_ref">blanchard2017machine, </a>)</cite>, to make the attack <em id="S1.p7.1.1" class="ltx_emph ltx_font_italic">more</em>
effective. Participant-level differential privacy <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib44" title="" class="ltx_ref">fedlearn_dp, </a>)</cite>
partially mitigates the attack, but at the cost of reducing the joint
model’s accuracy on its main task.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p">Even though anomaly detection is not compatible with secure aggregation,
future versions of federated learning may somehow deploy it without
compromising privacy of the participants’ training data. To demonstrate
that model replacement will remain effective, we develop a generic
<em id="S1.p8.1.1" class="ltx_emph ltx_font_italic">constrain-and-scale</em> technique that incorporates evasion of
anomaly detection into the attacker’s loss function. The resulting
models evade even relatively sophisticated detectors, e.g., those that
measure cosine similarity between submitted models and the joint model.
We also develop a simpler, yet effective <em id="S1.p8.1.2" class="ltx_emph ltx_font_italic">train-and-scale</em> technique
to evade anomaly detectors that look at the model’s weights <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib60" title="" class="ltx_ref">auror, </a>)</cite>
or its accuracy on the main task.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Training-time attacks.</span>

“Traditional” poisoning attacks compromise the training data to
change the model’s behavior at test time <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib42" title="" class="ltx_ref">mahloujifar2018multi, </a>; <a href="#bib.bib4" title="" class="ltx_ref">biggio2012icml, </a>; <a href="#bib.bib30" title="" class="ltx_ref">huang2011adversarial, </a>; <a href="#bib.bib58" title="" class="ltx_ref">rubinstein2009imc, </a>; <a href="#bib.bib63" title="" class="ltx_ref">steinhardt2017certified, </a>)</cite>. Previous backdoor attacks change the
model’s behavior only on specific attacker-chosen inputs via data
poisoning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib12" title="" class="ltx_ref">chen2017targeted, </a>; <a href="#bib.bib24" title="" class="ltx_ref">badnets, </a>; <a href="#bib.bib41" title="" class="ltx_ref">liu2017trojaning, </a>)</cite>,
or by inserting a backdoored component directly into a stationary
model <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib32" title="" class="ltx_ref">ji2018model, </a>; <a href="#bib.bib16" title="" class="ltx_ref">dumford2018backdooring, </a>; <a href="#bib.bib73" title="" class="ltx_ref">zou2018potrojan, </a>)</cite>. We
show that these attacks are not effective against federated learning,
where the attacker’s model is aggregated with hundreds or thousands of
benign models.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Defenses against poisoning remove outliers from the training
data <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib57" title="" class="ltx_ref">qiao2017learning, </a>; <a href="#bib.bib63" title="" class="ltx_ref">steinhardt2017certified, </a>)</cite> or, in the
distributed setting, from the participants’ models <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib60" title="" class="ltx_ref">auror, </a>; <a href="#bib.bib59" title="" class="ltx_ref">shayan2018biscotti, </a>; <a href="#bib.bib18" title="" class="ltx_ref">fung2018mitigating, </a>)</cite>, or require participants to submit
their data for centralized training <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib27" title="" class="ltx_ref">hayes2018contamination, </a>)</cite>.
Defenses against backdoors use techniques such as
fine-pruning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib40" title="" class="ltx_ref">liu2018fine, </a>)</cite>, filtering <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib66" title="" class="ltx_ref">turner2019cleanlabel, </a>)</cite>,
or various types of clustering <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib65" title="" class="ltx_ref">tran2018spectral, </a>; <a href="#bib.bib8" title="" class="ltx_ref">chen2018detecting, </a>)</cite>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">All of these defenses require the defender to inspect either
the training data, or the resulting model (which leaks the
training data <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib62" title="" class="ltx_ref">shokri2017membership, </a>; <a href="#bib.bib45" title="" class="ltx_ref">melis2018inference, </a>; <a href="#bib.bib48" title="" class="ltx_ref">nasr2018comprehensive, </a>)</cite>). None can be applied to federated learning,
which by design keeps the users’ training data as well as their local
models confidential and employs secure aggregation for this purpose.
Defenses such as “neural cleanse” <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib67" title="" class="ltx_ref">wangneural, </a>)</cite> work only
against pixel-pattern backdoors in image classifiers with a limited
number of classes. By contrast, we demonstrate semantic backdoors
that work in the text domain with thousands of labels. Similarly,
STRIP <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib19" title="" class="ltx_ref">gao2019strip, </a>)</cite> and DeepInspect <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib9" title="" class="ltx_ref">chendeepinspect, </a>)</cite>
only target pixel-pattern backdoors. Moreover, DeepInspect attempts
to invert the model to extract the training data, thus violating the
privacy requirement of federated learning.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Furthermore, none of these defenses are effective even in the setting for
which they were designed because they can be evaded by a defense-aware
attacker <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib64" title="" class="ltx_ref">tan2019bypassing, </a>; <a href="#bib.bib2" title="" class="ltx_ref">baruch2019circumventing, </a>)</cite>.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">Several months after an early draft of this paper became public,
Bhagoji et al. <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib3" title="" class="ltx_ref">bhagoji2018analyzing, </a>)</cite> proposed a modification of
our adversarial training algorithm that increases the learning rate on
the backdoor training inputs. Boosted learning rate causes catastrophic
forgetting, thus their attack requires the attacker to participate in
every round of federated learning to maintain the backdoor accuracy of
the joint model. By contrast, our attack is effective if staged by a
single participant in a single round (see Section <a href="#S5.SS4" title="5.4. Experimental results ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a>).
Their attack changes the model’s classification of one randomly picked
image; ours enables semantic backdoors based on the features of the
physical scene (see Section <a href="#S4.SS1" title="4.1. Threat model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>). Finally, their
attack works only against a single-layer feed-forward network or CNN
and does not converge for large networks such as the original federated
learning framework <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>. In Section <a href="#S4.SS3" title="4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>, we
explain that to avoid catastrophic forgetting, the attacker’s learning
rate should be <em id="S2.p5.1.1" class="ltx_emph ltx_font_italic">decreased</em>, not boosted.</p>
</div>
<div id="S2.p6" class="ltx_para ltx_noindent">
<p id="S2.p6.1" class="ltx_p"><span id="S2.p6.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Test-time attacks.</span> 
Adversarial examples <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib21" title="" class="ltx_ref">goodfellow2014explaining, </a>; <a href="#bib.bib37" title="" class="ltx_ref">kurakin2016adversarial, </a>; <a href="#bib.bib52" title="" class="ltx_ref">papernot2017practical, </a>)</cite> are deliberately crafted
to be misclassified by the model. By contrast, backdoor attacks cause
the model to misclassify even <em id="S2.p6.1.2" class="ltx_emph ltx_font_italic">unmodified</em> inputs—see
further discussion in Section <a href="#S4.SS1" title="4.1. Threat model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p>
</div>
<div id="S2.p7" class="ltx_para ltx_noindent">
<p id="S2.p7.1" class="ltx_p"><span id="S2.p7.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Secure ML.</span> 
Secure multi-party computation can help train models while protecting
privacy of the training data <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib47" title="" class="ltx_ref">mohassel2017secureml, </a>)</cite>, but it does not
protect model integrity. Specialized solutions, such as training secret
models on encrypted, vertically partitioned data <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib26" title="" class="ltx_ref">hardy2017private, </a>)</cite>,
are not applicable to federated learning.</p>
</div>
<div id="S2.p8" class="ltx_para">
<p id="S2.p8.1" class="ltx_p">Secure aggregation of model updates <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib7" title="" class="ltx_ref">bonawitz2017practical, </a>)</cite> is
essential for privacy because model updates leak sensitive information
about participants’ training data <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib48" title="" class="ltx_ref">nasr2018comprehensive, </a>; <a href="#bib.bib45" title="" class="ltx_ref">melis2018inference, </a>)</cite>. Secure aggregation makes our attack easier because
it prevents the central server from detecting anomalous updates and
tracing them to a specific participant(s).</p>
</div>
<div id="S2.p9" class="ltx_para ltx_noindent">
<p id="S2.p9.1" class="ltx_p"><span id="S2.p9.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Participant-level differential privacy.</span> 
Differentially private federated learning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib44" title="" class="ltx_ref">fedlearn_dp, </a>; <a href="#bib.bib20" title="" class="ltx_ref">geyer2017differentially, </a>)</cite> bounds each participant’s influence over
the joint model. In Section <a href="#S6.SS3" title="6.3. Participant-level differential privacy ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.3</span></a>, we evaluate the
extent to which it mitigates our attacks. PATE <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib51" title="" class="ltx_ref">pate, </a>; <a href="#bib.bib53" title="" class="ltx_ref">pate2, </a>)</cite> uses
knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib29" title="" class="ltx_ref">hinton2015distilling, </a>)</cite> to transfer knowledge
from “teacher” models trained on private data to a “student” model.
Participants must agree on the class labels that may not exist in their
own datasets, thus PATE may not be suitable for tasks like next-word
prediction with a 50K dictionary <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib44" title="" class="ltx_ref">fedlearn_dp, </a>)</cite>. The purpose of
federated learning is to train on private data that are distributed
differently from the public data. It is not clear how knowledge
transfer works in the absence of unlabeled public data drawn from the
same distribution as the teachers’ private data.</p>
</div>
<div id="S2.p10" class="ltx_para ltx_noindent">
<p id="S2.p10.1" class="ltx_p"><span id="S2.p10.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Byzantine-tolerant distributed learning.</span> 
Recent work <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib13" title="" class="ltx_ref">chen2017distributed, </a>; <a href="#bib.bib71" title="" class="ltx_ref">yin2018byzantine, </a>; <a href="#bib.bib5" title="" class="ltx_ref">blanchard2017machine, </a>; <a href="#bib.bib14" title="" class="ltx_ref">damaskinos2018asynchronous, </a>)</cite> proposed alternative
aggregation mechanisms to ensure <em id="S2.p10.1.2" class="ltx_emph ltx_font_italic">convergence</em> (but not integrity)
in the presence of Byzantine participants. The key assumptions are that
the participants’ training data are i.i.d. <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib5" title="" class="ltx_ref">blanchard2017machine, </a>)</cite>,
or even unmodified and equally distributed <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib71" title="" class="ltx_ref">yin2018byzantine, </a>; <a href="#bib.bib13" title="" class="ltx_ref">chen2017distributed, </a>; <a href="#bib.bib69" title="" class="ltx_ref">xie2018zeno, </a>)</cite>. These assumptions are explicitly
false for federated learning.</p>
</div>
<div id="S2.p11" class="ltx_para">
<p id="S2.p11.1" class="ltx_p">In Section <a href="#S6.SS2" title="6.2. Byzantine-tolerant distributed learning ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></a>, we show that Krum sampling proposed
in <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib5" title="" class="ltx_ref">blanchard2017machine, </a>)</cite> makes our attack stronger. Alternative
aggregation mechanisms <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib68" title="" class="ltx_ref">xie2018generalized, </a>; <a href="#bib.bib71" title="" class="ltx_ref">yin2018byzantine, </a>; <a href="#bib.bib20" title="" class="ltx_ref">geyer2017differentially, </a>; <a href="#bib.bib13" title="" class="ltx_ref">chen2017distributed, </a>)</cite>, such as coordinate-wise
or geometric medians, greatly reduce the accuracy of complex models on
non-i.i.d. data <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib11" title="" class="ltx_ref">chen2019distributed, </a>)</cite> and are incompatible with
secure aggregation. They cannot be applied to federated learning while
protecting participants’ privacy.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Federated Learning</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.2" class="ltx_p">Federated learning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite> distributes the training
of a deep neural network across <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">n</annotation></semantics></math> participants by iteratively
aggregating local models into a joint global model. The motivations are
efficiency—<math id="S3.p1.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">n</annotation></semantics></math> can be millions <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>—and privacy. Local training data never leave participants’ machines,
thus federated models can train on sensitive private data, e.g.,
users’ typed messages, that are substantially different from publicly
available datasets <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib25" title="" class="ltx_ref">hard2018federated, </a>)</cite>. OpenMined <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib50" title="" class="ltx_ref">openmined, </a>)</cite>
and decentralizedML <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib15" title="" class="ltx_ref">decentralizedml, </a>)</cite> provide open-source software
that enables users to train models on their private data and share the
profits from selling the resulting joint model. There exist other flavors
of distributed privacy-preserving learning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib61" title="" class="ltx_ref">shokri2015privacy, </a>)</cite>,
but they are trivial to backdoor (see Section <a href="#S4.SS2" title="4.2. Constructing the attack model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>) and we
do not consider them further.</p>
</div>
<figure id="S3.13" class="ltx_table">
<table id="S3.13.13" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.13.13.14.1" class="ltx_tr">
<th id="S3.13.13.14.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="2"><span id="S3.13.13.14.1.1.1" class="ltx_text ltx_font_bold">Methods</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.3.3.3" class="ltx_tr">
<th id="S3.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S3.1.1.1.1.m1.2" class="ltx_Math" alttext="\mathcal{L}_{class}(L,D)" display="inline"><semantics id="S3.1.1.1.1.m1.2a"><mrow id="S3.1.1.1.1.m1.2.3" xref="S3.1.1.1.1.m1.2.3.cmml"><msub id="S3.1.1.1.1.m1.2.3.2" xref="S3.1.1.1.1.m1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.1.1.1.1.m1.2.3.2.2" xref="S3.1.1.1.1.m1.2.3.2.2.cmml">ℒ</mi><mrow id="S3.1.1.1.1.m1.2.3.2.3" xref="S3.1.1.1.1.m1.2.3.2.3.cmml"><mi id="S3.1.1.1.1.m1.2.3.2.3.2" xref="S3.1.1.1.1.m1.2.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.1.1.1.1.m1.2.3.2.3.1" xref="S3.1.1.1.1.m1.2.3.2.3.1.cmml">​</mo><mi id="S3.1.1.1.1.m1.2.3.2.3.3" xref="S3.1.1.1.1.m1.2.3.2.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.1.1.1.1.m1.2.3.2.3.1a" xref="S3.1.1.1.1.m1.2.3.2.3.1.cmml">​</mo><mi id="S3.1.1.1.1.m1.2.3.2.3.4" xref="S3.1.1.1.1.m1.2.3.2.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.1.1.1.1.m1.2.3.2.3.1b" xref="S3.1.1.1.1.m1.2.3.2.3.1.cmml">​</mo><mi id="S3.1.1.1.1.m1.2.3.2.3.5" xref="S3.1.1.1.1.m1.2.3.2.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.1.1.1.1.m1.2.3.2.3.1c" xref="S3.1.1.1.1.m1.2.3.2.3.1.cmml">​</mo><mi id="S3.1.1.1.1.m1.2.3.2.3.6" xref="S3.1.1.1.1.m1.2.3.2.3.6.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.1.1.1.1.m1.2.3.1" xref="S3.1.1.1.1.m1.2.3.1.cmml">​</mo><mrow id="S3.1.1.1.1.m1.2.3.3.2" xref="S3.1.1.1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S3.1.1.1.1.m1.2.3.3.2.1" xref="S3.1.1.1.1.m1.2.3.3.1.cmml">(</mo><mi id="S3.1.1.1.1.m1.1.1" xref="S3.1.1.1.1.m1.1.1.cmml">L</mi><mo id="S3.1.1.1.1.m1.2.3.3.2.2" xref="S3.1.1.1.1.m1.2.3.3.1.cmml">,</mo><mi id="S3.1.1.1.1.m1.2.2" xref="S3.1.1.1.1.m1.2.2.cmml">D</mi><mo stretchy="false" id="S3.1.1.1.1.m1.2.3.3.2.3" xref="S3.1.1.1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.1.1.1.1.m1.2b"><apply id="S3.1.1.1.1.m1.2.3.cmml" xref="S3.1.1.1.1.m1.2.3"><times id="S3.1.1.1.1.m1.2.3.1.cmml" xref="S3.1.1.1.1.m1.2.3.1"></times><apply id="S3.1.1.1.1.m1.2.3.2.cmml" xref="S3.1.1.1.1.m1.2.3.2"><csymbol cd="ambiguous" id="S3.1.1.1.1.m1.2.3.2.1.cmml" xref="S3.1.1.1.1.m1.2.3.2">subscript</csymbol><ci id="S3.1.1.1.1.m1.2.3.2.2.cmml" xref="S3.1.1.1.1.m1.2.3.2.2">ℒ</ci><apply id="S3.1.1.1.1.m1.2.3.2.3.cmml" xref="S3.1.1.1.1.m1.2.3.2.3"><times id="S3.1.1.1.1.m1.2.3.2.3.1.cmml" xref="S3.1.1.1.1.m1.2.3.2.3.1"></times><ci id="S3.1.1.1.1.m1.2.3.2.3.2.cmml" xref="S3.1.1.1.1.m1.2.3.2.3.2">𝑐</ci><ci id="S3.1.1.1.1.m1.2.3.2.3.3.cmml" xref="S3.1.1.1.1.m1.2.3.2.3.3">𝑙</ci><ci id="S3.1.1.1.1.m1.2.3.2.3.4.cmml" xref="S3.1.1.1.1.m1.2.3.2.3.4">𝑎</ci><ci id="S3.1.1.1.1.m1.2.3.2.3.5.cmml" xref="S3.1.1.1.1.m1.2.3.2.3.5">𝑠</ci><ci id="S3.1.1.1.1.m1.2.3.2.3.6.cmml" xref="S3.1.1.1.1.m1.2.3.2.3.6">𝑠</ci></apply></apply><interval closure="open" id="S3.1.1.1.1.m1.2.3.3.1.cmml" xref="S3.1.1.1.1.m1.2.3.3.2"><ci id="S3.1.1.1.1.m1.1.1.cmml" xref="S3.1.1.1.1.m1.1.1">𝐿</ci><ci id="S3.1.1.1.1.m1.2.2.cmml" xref="S3.1.1.1.1.m1.2.2">𝐷</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.1.1.1.1.m1.2c">\mathcal{L}_{class}(L,D)</annotation></semantics></math></th>
<td id="S3.3.3.3.3" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.3.3.3.3.2" class="ltx_inline-block ltx_align_top">
<span id="S3.3.3.3.3.2.2" class="ltx_p" style="width:170.7pt;">Classification loss of model <math id="S3.2.2.2.2.1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.2.2.2.2.1.1.m1.1a"><mi id="S3.2.2.2.2.1.1.m1.1.1" xref="S3.2.2.2.2.1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.2.2.2.2.1.1.m1.1b"><ci id="S3.2.2.2.2.1.1.m1.1.1.cmml" xref="S3.2.2.2.2.1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.2.2.2.2.1.1.m1.1c">L</annotation></semantics></math> tested on data <math id="S3.3.3.3.3.2.2.m2.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.3.3.3.3.2.2.m2.1a"><mi id="S3.3.3.3.3.2.2.m2.1.1" xref="S3.3.3.3.3.2.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.3.3.3.3.2.2.m2.1b"><ci id="S3.3.3.3.3.2.2.m2.1.1.cmml" xref="S3.3.3.3.3.2.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.3.3.3.3.2.2.m2.1c">D</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S3.5.5.5" class="ltx_tr">
<th id="S3.4.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S3.4.4.4.1.m1.1" class="ltx_Math" alttext="\nabla l" display="inline"><semantics id="S3.4.4.4.1.m1.1a"><mrow id="S3.4.4.4.1.m1.1.1" xref="S3.4.4.4.1.m1.1.1.cmml"><mo rspace="0.167em" id="S3.4.4.4.1.m1.1.1.1" xref="S3.4.4.4.1.m1.1.1.1.cmml">∇</mo><mi id="S3.4.4.4.1.m1.1.1.2" xref="S3.4.4.4.1.m1.1.1.2.cmml">l</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.4.4.4.1.m1.1b"><apply id="S3.4.4.4.1.m1.1.1.cmml" xref="S3.4.4.4.1.m1.1.1"><ci id="S3.4.4.4.1.m1.1.1.1.cmml" xref="S3.4.4.4.1.m1.1.1.1">∇</ci><ci id="S3.4.4.4.1.m1.1.1.2.cmml" xref="S3.4.4.4.1.m1.1.1.2">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.4.4.4.1.m1.1c">\nabla l</annotation></semantics></math></th>
<td id="S3.5.5.5.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.5.5.5.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.5.5.5.2.1.1" class="ltx_p" style="width:170.7pt;">Gradient of the classification loss <math id="S3.5.5.5.2.1.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.5.5.5.2.1.1.m1.1a"><mi id="S3.5.5.5.2.1.1.m1.1.1" xref="S3.5.5.5.2.1.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.5.5.5.2.1.1.m1.1b"><ci id="S3.5.5.5.2.1.1.m1.1.1.cmml" xref="S3.5.5.5.2.1.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.5.5.5.2.1.1.m1.1c">l</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S3.13.13.15.1" class="ltx_tr">
<th id="S3.13.13.15.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="2"><span id="S3.13.13.15.1.1.1" class="ltx_text ltx_font_bold">Global Server Input</span></th>
</tr>
<tr id="S3.7.7.7" class="ltx_tr">
<th id="S3.6.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S3.6.6.6.1.m1.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="S3.6.6.6.1.m1.1a"><msup id="S3.6.6.6.1.m1.1.1" xref="S3.6.6.6.1.m1.1.1.cmml"><mi id="S3.6.6.6.1.m1.1.1.2" xref="S3.6.6.6.1.m1.1.1.2.cmml">G</mi><mi id="S3.6.6.6.1.m1.1.1.3" xref="S3.6.6.6.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.6.6.6.1.m1.1b"><apply id="S3.6.6.6.1.m1.1.1.cmml" xref="S3.6.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.6.6.6.1.m1.1.1.1.cmml" xref="S3.6.6.6.1.m1.1.1">superscript</csymbol><ci id="S3.6.6.6.1.m1.1.1.2.cmml" xref="S3.6.6.6.1.m1.1.1.2">𝐺</ci><ci id="S3.6.6.6.1.m1.1.1.3.cmml" xref="S3.6.6.6.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.6.6.6.1.m1.1c">G^{t}</annotation></semantics></math></th>
<td id="S3.7.7.7.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.7.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.7.7.7.2.1.1" class="ltx_p" style="width:170.7pt;">joint global model at round <math id="S3.7.7.7.2.1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.7.7.7.2.1.1.m1.1a"><mi id="S3.7.7.7.2.1.1.m1.1.1" xref="S3.7.7.7.2.1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.7.7.7.2.1.1.m1.1b"><ci id="S3.7.7.7.2.1.1.m1.1.1.cmml" xref="S3.7.7.7.2.1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.7.7.7.2.1.1.m1.1c">t</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S3.8.8.8" class="ltx_tr">
<th id="S3.8.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S3.8.8.8.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.8.8.8.1.m1.1a"><mi id="S3.8.8.8.1.m1.1.1" xref="S3.8.8.8.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.8.8.8.1.m1.1b"><ci id="S3.8.8.8.1.m1.1.1.cmml" xref="S3.8.8.8.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.8.8.8.1.m1.1c">E</annotation></semantics></math></th>
<td id="S3.8.8.8.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.8.8.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.8.8.8.2.1.1" class="ltx_p" style="width:170.7pt;">local epochs</span>
</span>
</td>
</tr>
<tr id="S3.9.9.9" class="ltx_tr">
<th id="S3.9.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S3.9.9.9.1.m1.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="S3.9.9.9.1.m1.1a"><mrow id="S3.9.9.9.1.m1.1.1" xref="S3.9.9.9.1.m1.1.1.cmml"><mi id="S3.9.9.9.1.m1.1.1.2" xref="S3.9.9.9.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.9.9.9.1.m1.1.1.1" xref="S3.9.9.9.1.m1.1.1.1.cmml">​</mo><mi id="S3.9.9.9.1.m1.1.1.3" xref="S3.9.9.9.1.m1.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.9.9.9.1.m1.1b"><apply id="S3.9.9.9.1.m1.1.1.cmml" xref="S3.9.9.9.1.m1.1.1"><times id="S3.9.9.9.1.m1.1.1.1.cmml" xref="S3.9.9.9.1.m1.1.1.1"></times><ci id="S3.9.9.9.1.m1.1.1.2.cmml" xref="S3.9.9.9.1.m1.1.1.2">𝑙</ci><ci id="S3.9.9.9.1.m1.1.1.3.cmml" xref="S3.9.9.9.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.9.9.9.1.m1.1c">lr</annotation></semantics></math></th>
<td id="S3.9.9.9.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.9.9.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.9.9.9.2.1.1" class="ltx_p" style="width:170.7pt;">learning rate</span>
</span>
</td>
</tr>
<tr id="S3.10.10.10" class="ltx_tr">
<th id="S3.10.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S3.10.10.10.1.m1.1" class="ltx_Math" alttext="bs" display="inline"><semantics id="S3.10.10.10.1.m1.1a"><mrow id="S3.10.10.10.1.m1.1.1" xref="S3.10.10.10.1.m1.1.1.cmml"><mi id="S3.10.10.10.1.m1.1.1.2" xref="S3.10.10.10.1.m1.1.1.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.10.10.10.1.m1.1.1.1" xref="S3.10.10.10.1.m1.1.1.1.cmml">​</mo><mi id="S3.10.10.10.1.m1.1.1.3" xref="S3.10.10.10.1.m1.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.10.10.10.1.m1.1b"><apply id="S3.10.10.10.1.m1.1.1.cmml" xref="S3.10.10.10.1.m1.1.1"><times id="S3.10.10.10.1.m1.1.1.1.cmml" xref="S3.10.10.10.1.m1.1.1.1"></times><ci id="S3.10.10.10.1.m1.1.1.2.cmml" xref="S3.10.10.10.1.m1.1.1.2">𝑏</ci><ci id="S3.10.10.10.1.m1.1.1.3.cmml" xref="S3.10.10.10.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.10.10.10.1.m1.1c">bs</annotation></semantics></math></th>
<td id="S3.10.10.10.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.10.10.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.10.10.10.2.1.1" class="ltx_p" style="width:170.7pt;">batch size</span>
</span>
</td>
</tr>
<tr id="S3.13.13.16.2" class="ltx_tr">
<th id="S3.13.13.16.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="2"><span id="S3.13.13.16.2.1.1" class="ltx_text ltx_font_bold">Local Input</span></th>
</tr>
<tr id="S3.12.12.12" class="ltx_tr">
<th id="S3.11.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S3.11.11.11.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{local}" display="inline"><semantics id="S3.11.11.11.1.m1.1a"><msub id="S3.11.11.11.1.m1.1.1" xref="S3.11.11.11.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.11.11.11.1.m1.1.1.2" xref="S3.11.11.11.1.m1.1.1.2.cmml">𝒟</mi><mrow id="S3.11.11.11.1.m1.1.1.3" xref="S3.11.11.11.1.m1.1.1.3.cmml"><mi id="S3.11.11.11.1.m1.1.1.3.2" xref="S3.11.11.11.1.m1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S3.11.11.11.1.m1.1.1.3.1" xref="S3.11.11.11.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.11.11.11.1.m1.1.1.3.3" xref="S3.11.11.11.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.11.11.11.1.m1.1.1.3.1a" xref="S3.11.11.11.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.11.11.11.1.m1.1.1.3.4" xref="S3.11.11.11.1.m1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.11.11.11.1.m1.1.1.3.1b" xref="S3.11.11.11.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.11.11.11.1.m1.1.1.3.5" xref="S3.11.11.11.1.m1.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.11.11.11.1.m1.1.1.3.1c" xref="S3.11.11.11.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.11.11.11.1.m1.1.1.3.6" xref="S3.11.11.11.1.m1.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.11.11.11.1.m1.1b"><apply id="S3.11.11.11.1.m1.1.1.cmml" xref="S3.11.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S3.11.11.11.1.m1.1.1.1.cmml" xref="S3.11.11.11.1.m1.1.1">subscript</csymbol><ci id="S3.11.11.11.1.m1.1.1.2.cmml" xref="S3.11.11.11.1.m1.1.1.2">𝒟</ci><apply id="S3.11.11.11.1.m1.1.1.3.cmml" xref="S3.11.11.11.1.m1.1.1.3"><times id="S3.11.11.11.1.m1.1.1.3.1.cmml" xref="S3.11.11.11.1.m1.1.1.3.1"></times><ci id="S3.11.11.11.1.m1.1.1.3.2.cmml" xref="S3.11.11.11.1.m1.1.1.3.2">𝑙</ci><ci id="S3.11.11.11.1.m1.1.1.3.3.cmml" xref="S3.11.11.11.1.m1.1.1.3.3">𝑜</ci><ci id="S3.11.11.11.1.m1.1.1.3.4.cmml" xref="S3.11.11.11.1.m1.1.1.3.4">𝑐</ci><ci id="S3.11.11.11.1.m1.1.1.3.5.cmml" xref="S3.11.11.11.1.m1.1.1.3.5">𝑎</ci><ci id="S3.11.11.11.1.m1.1.1.3.6.cmml" xref="S3.11.11.11.1.m1.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.11.11.11.1.m1.1c">\mathcal{D}_{local}</annotation></semantics></math></th>
<td id="S3.12.12.12.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S3.12.12.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.12.12.12.2.1.1" class="ltx_p" style="width:170.7pt;">user’s local data split into batches of size <math id="S3.12.12.12.2.1.1.m1.1" class="ltx_Math" alttext="bs" display="inline"><semantics id="S3.12.12.12.2.1.1.m1.1a"><mrow id="S3.12.12.12.2.1.1.m1.1.1" xref="S3.12.12.12.2.1.1.m1.1.1.cmml"><mi id="S3.12.12.12.2.1.1.m1.1.1.2" xref="S3.12.12.12.2.1.1.m1.1.1.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.12.12.12.2.1.1.m1.1.1.1" xref="S3.12.12.12.2.1.1.m1.1.1.1.cmml">​</mo><mi id="S3.12.12.12.2.1.1.m1.1.1.3" xref="S3.12.12.12.2.1.1.m1.1.1.3.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.12.12.12.2.1.1.m1.1b"><apply id="S3.12.12.12.2.1.1.m1.1.1.cmml" xref="S3.12.12.12.2.1.1.m1.1.1"><times id="S3.12.12.12.2.1.1.m1.1.1.1.cmml" xref="S3.12.12.12.2.1.1.m1.1.1.1"></times><ci id="S3.12.12.12.2.1.1.m1.1.1.2.cmml" xref="S3.12.12.12.2.1.1.m1.1.1.2">𝑏</ci><ci id="S3.12.12.12.2.1.1.m1.1.1.3.cmml" xref="S3.12.12.12.2.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.12.12.12.2.1.1.m1.1c">bs</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S3.13.13.13" class="ltx_tr">
<th id="S3.13.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b"><math id="S3.13.13.13.1.m1.1" class="ltx_Math" alttext="D_{backdoor}" display="inline"><semantics id="S3.13.13.13.1.m1.1a"><msub id="S3.13.13.13.1.m1.1.1" xref="S3.13.13.13.1.m1.1.1.cmml"><mi id="S3.13.13.13.1.m1.1.1.2" xref="S3.13.13.13.1.m1.1.1.2.cmml">D</mi><mrow id="S3.13.13.13.1.m1.1.1.3" xref="S3.13.13.13.1.m1.1.1.3.cmml"><mi id="S3.13.13.13.1.m1.1.1.3.2" xref="S3.13.13.13.1.m1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="S3.13.13.13.1.m1.1.1.3.1" xref="S3.13.13.13.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.13.13.13.1.m1.1.1.3.3" xref="S3.13.13.13.1.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.13.13.13.1.m1.1.1.3.1a" xref="S3.13.13.13.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.13.13.13.1.m1.1.1.3.4" xref="S3.13.13.13.1.m1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.13.13.13.1.m1.1.1.3.1b" xref="S3.13.13.13.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.13.13.13.1.m1.1.1.3.5" xref="S3.13.13.13.1.m1.1.1.3.5.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.13.13.13.1.m1.1.1.3.1c" xref="S3.13.13.13.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.13.13.13.1.m1.1.1.3.6" xref="S3.13.13.13.1.m1.1.1.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.13.13.13.1.m1.1.1.3.1d" xref="S3.13.13.13.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.13.13.13.1.m1.1.1.3.7" xref="S3.13.13.13.1.m1.1.1.3.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.13.13.13.1.m1.1.1.3.1e" xref="S3.13.13.13.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.13.13.13.1.m1.1.1.3.8" xref="S3.13.13.13.1.m1.1.1.3.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.13.13.13.1.m1.1.1.3.1f" xref="S3.13.13.13.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.13.13.13.1.m1.1.1.3.9" xref="S3.13.13.13.1.m1.1.1.3.9.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.13.13.13.1.m1.1b"><apply id="S3.13.13.13.1.m1.1.1.cmml" xref="S3.13.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="S3.13.13.13.1.m1.1.1.1.cmml" xref="S3.13.13.13.1.m1.1.1">subscript</csymbol><ci id="S3.13.13.13.1.m1.1.1.2.cmml" xref="S3.13.13.13.1.m1.1.1.2">𝐷</ci><apply id="S3.13.13.13.1.m1.1.1.3.cmml" xref="S3.13.13.13.1.m1.1.1.3"><times id="S3.13.13.13.1.m1.1.1.3.1.cmml" xref="S3.13.13.13.1.m1.1.1.3.1"></times><ci id="S3.13.13.13.1.m1.1.1.3.2.cmml" xref="S3.13.13.13.1.m1.1.1.3.2">𝑏</ci><ci id="S3.13.13.13.1.m1.1.1.3.3.cmml" xref="S3.13.13.13.1.m1.1.1.3.3">𝑎</ci><ci id="S3.13.13.13.1.m1.1.1.3.4.cmml" xref="S3.13.13.13.1.m1.1.1.3.4">𝑐</ci><ci id="S3.13.13.13.1.m1.1.1.3.5.cmml" xref="S3.13.13.13.1.m1.1.1.3.5">𝑘</ci><ci id="S3.13.13.13.1.m1.1.1.3.6.cmml" xref="S3.13.13.13.1.m1.1.1.3.6">𝑑</ci><ci id="S3.13.13.13.1.m1.1.1.3.7.cmml" xref="S3.13.13.13.1.m1.1.1.3.7">𝑜</ci><ci id="S3.13.13.13.1.m1.1.1.3.8.cmml" xref="S3.13.13.13.1.m1.1.1.3.8">𝑜</ci><ci id="S3.13.13.13.1.m1.1.1.3.9.cmml" xref="S3.13.13.13.1.m1.1.1.3.9">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.13.13.13.1.m1.1c">D_{backdoor}</annotation></semantics></math></th>
<td id="S3.13.13.13.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b">
<span id="S3.13.13.13.2.1" class="ltx_inline-block ltx_align_top">
<span id="S3.13.13.13.2.1.1" class="ltx_p" style="width:170.7pt;">backdoor data (used in Algorithm <a href="#alg2" title="Algorithm 2 ‣ 4.2. Constructing the attack model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>)</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.fig1" class="ltx_figure">
<figure id="alg1" class="ltx_float ltx_minipage ltx_align_middle ltx_framed ltx_framed_top" style="width:433.6pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Local training for participant’s model</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">FedLearnLocal</span>(<math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{local}" display="inline"><semantics id="alg1.l1.m1.1a"><msub id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">𝒟</mi><mrow id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml"><mi id="alg1.l1.m1.1.1.3.2" xref="alg1.l1.m1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.3.1" xref="alg1.l1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.3.3" xref="alg1.l1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.3.1a" xref="alg1.l1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.3.4" xref="alg1.l1.m1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.3.1b" xref="alg1.l1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.3.5" xref="alg1.l1.m1.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l1.m1.1.1.3.1c" xref="alg1.l1.m1.1.1.3.1.cmml">​</mo><mi id="alg1.l1.m1.1.1.3.6" xref="alg1.l1.m1.1.1.3.6.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1.2">𝒟</ci><apply id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"><times id="alg1.l1.m1.1.1.3.1.cmml" xref="alg1.l1.m1.1.1.3.1"></times><ci id="alg1.l1.m1.1.1.3.2.cmml" xref="alg1.l1.m1.1.1.3.2">𝑙</ci><ci id="alg1.l1.m1.1.1.3.3.cmml" xref="alg1.l1.m1.1.1.3.3">𝑜</ci><ci id="alg1.l1.m1.1.1.3.4.cmml" xref="alg1.l1.m1.1.1.3.4">𝑐</ci><ci id="alg1.l1.m1.1.1.3.5.cmml" xref="alg1.l1.m1.1.1.3.5">𝑎</ci><ci id="alg1.l1.m1.1.1.3.6.cmml" xref="alg1.l1.m1.1.1.3.6">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathcal{D}_{local}</annotation></semantics></math>)

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.2" class="ltx_text ltx_font_italic">Initialize local model <math id="alg1.l2.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l2.1.m1.1a"><mi id="alg1.l2.1.m1.1.1" xref="alg1.l2.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.1.m1.1b"><ci id="alg1.l2.1.m1.1.1.cmml" xref="alg1.l2.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.1.m1.1c">L</annotation></semantics></math> and loss function <math id="alg1.l2.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="alg1.l2.2.m2.1a"><mi id="alg1.l2.2.m2.1.1" xref="alg1.l2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.2.m2.1b"><ci id="alg1.l2.2.m2.1.1.cmml" xref="alg1.l2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.2.m2.1c">l</annotation></semantics></math></span>:

</div>
<div id="alg1.l3" class="ltx_listingline">      <math id="alg1.l3.m1.1" class="ltx_Math" alttext="L^{t+1}\leftarrow G^{t}" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><msup id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">L</mi><mrow id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml"><mi id="alg1.l3.m1.1.1.2.3.2" xref="alg1.l3.m1.1.1.2.3.2.cmml">t</mi><mo id="alg1.l3.m1.1.1.2.3.1" xref="alg1.l3.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l3.m1.1.1.2.3.3" xref="alg1.l3.m1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">←</mo><msup id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml"><mi id="alg1.l3.m1.1.1.3.2" xref="alg1.l3.m1.1.1.3.2.cmml">G</mi><mi id="alg1.l3.m1.1.1.3.3" xref="alg1.l3.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">←</ci><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2">superscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝐿</ci><apply id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3"><plus id="alg1.l3.m1.1.1.2.3.1.cmml" xref="alg1.l3.m1.1.1.2.3.1"></plus><ci id="alg1.l3.m1.1.1.2.3.2.cmml" xref="alg1.l3.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l3.m1.1.1.2.3.3.cmml" xref="alg1.l3.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.3.1.cmml" xref="alg1.l3.m1.1.1.3">superscript</csymbol><ci id="alg1.l3.m1.1.1.3.2.cmml" xref="alg1.l3.m1.1.1.3.2">𝐺</ci><ci id="alg1.l3.m1.1.1.3.3.cmml" xref="alg1.l3.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">L^{t+1}\leftarrow G^{t}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">      <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\ell\leftarrow\mathcal{L}_{class}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi mathvariant="normal" id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">ℓ</mi><mo stretchy="false" id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">←</mo><msub id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l4.m1.1.1.3.2" xref="alg1.l4.m1.1.1.3.2.cmml">ℒ</mi><mrow id="alg1.l4.m1.1.1.3.3" xref="alg1.l4.m1.1.1.3.3.cmml"><mi id="alg1.l4.m1.1.1.3.3.2" xref="alg1.l4.m1.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.3.1" xref="alg1.l4.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.3.3" xref="alg1.l4.m1.1.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.3.1a" xref="alg1.l4.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.3.4" xref="alg1.l4.m1.1.1.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.3.1b" xref="alg1.l4.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.3.5" xref="alg1.l4.m1.1.1.3.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.1.1.3.3.1c" xref="alg1.l4.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l4.m1.1.1.3.3.6" xref="alg1.l4.m1.1.1.3.3.6.cmml">s</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1">←</ci><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">ℓ</ci><apply id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.3.2">ℒ</ci><apply id="alg1.l4.m1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.3.3"><times id="alg1.l4.m1.1.1.3.3.1.cmml" xref="alg1.l4.m1.1.1.3.3.1"></times><ci id="alg1.l4.m1.1.1.3.3.2.cmml" xref="alg1.l4.m1.1.1.3.3.2">𝑐</ci><ci id="alg1.l4.m1.1.1.3.3.3.cmml" xref="alg1.l4.m1.1.1.3.3.3">𝑙</ci><ci id="alg1.l4.m1.1.1.3.3.4.cmml" xref="alg1.l4.m1.1.1.3.3.4">𝑎</ci><ci id="alg1.l4.m1.1.1.3.3.5.cmml" xref="alg1.l4.m1.1.1.3.3.5">𝑠</ci><ci id="alg1.l4.m1.1.1.3.3.6.cmml" xref="alg1.l4.m1.1.1.3.3.6">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\ell\leftarrow\mathcal{L}_{class}</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">  <span id="alg1.l5.1" class="ltx_text ltx_font_bold">for</span> epoch <math id="alg1.l5.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg1.l5.m1.1a"><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">e</annotation></semantics></math> <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg1.l5.m2.1a"><mo id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><in id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\in</annotation></semantics></math> <math id="alg1.l5.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l5.m3.1a"><mi id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><ci id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">E</annotation></semantics></math> <span id="alg1.l5.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l6" class="ltx_listingline">     <span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l6.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="alg1.l6.m1.1a"><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">b</annotation></semantics></math> <math id="alg1.l6.m2.1" class="ltx_Math" alttext="\in\mathcal{D}_{local}" display="inline"><semantics id="alg1.l6.m2.1a"><mrow id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml"></mi><mo id="alg1.l6.m2.1.1.1" xref="alg1.l6.m2.1.1.1.cmml">∈</mo><msub id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l6.m2.1.1.3.2" xref="alg1.l6.m2.1.1.3.2.cmml">𝒟</mi><mrow id="alg1.l6.m2.1.1.3.3" xref="alg1.l6.m2.1.1.3.3.cmml"><mi id="alg1.l6.m2.1.1.3.3.2" xref="alg1.l6.m2.1.1.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m2.1.1.3.3.1" xref="alg1.l6.m2.1.1.3.3.1.cmml">​</mo><mi id="alg1.l6.m2.1.1.3.3.3" xref="alg1.l6.m2.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m2.1.1.3.3.1a" xref="alg1.l6.m2.1.1.3.3.1.cmml">​</mo><mi id="alg1.l6.m2.1.1.3.3.4" xref="alg1.l6.m2.1.1.3.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m2.1.1.3.3.1b" xref="alg1.l6.m2.1.1.3.3.1.cmml">​</mo><mi id="alg1.l6.m2.1.1.3.3.5" xref="alg1.l6.m2.1.1.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m2.1.1.3.3.1c" xref="alg1.l6.m2.1.1.3.3.1.cmml">​</mo><mi id="alg1.l6.m2.1.1.3.3.6" xref="alg1.l6.m2.1.1.3.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><in id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1.1"></in><csymbol cd="latexml" id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">absent</csymbol><apply id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.3.1.cmml" xref="alg1.l6.m2.1.1.3">subscript</csymbol><ci id="alg1.l6.m2.1.1.3.2.cmml" xref="alg1.l6.m2.1.1.3.2">𝒟</ci><apply id="alg1.l6.m2.1.1.3.3.cmml" xref="alg1.l6.m2.1.1.3.3"><times id="alg1.l6.m2.1.1.3.3.1.cmml" xref="alg1.l6.m2.1.1.3.3.1"></times><ci id="alg1.l6.m2.1.1.3.3.2.cmml" xref="alg1.l6.m2.1.1.3.3.2">𝑙</ci><ci id="alg1.l6.m2.1.1.3.3.3.cmml" xref="alg1.l6.m2.1.1.3.3.3">𝑜</ci><ci id="alg1.l6.m2.1.1.3.3.4.cmml" xref="alg1.l6.m2.1.1.3.3.4">𝑐</ci><ci id="alg1.l6.m2.1.1.3.3.5.cmml" xref="alg1.l6.m2.1.1.3.3.5">𝑎</ci><ci id="alg1.l6.m2.1.1.3.3.6.cmml" xref="alg1.l6.m2.1.1.3.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\in\mathcal{D}_{local}</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l7" class="ltx_listingline">        <math id="alg1.l7.m1.2" class="ltx_Math" alttext="L^{t+1}\leftarrow L^{t+1}-lr\cdot\nabla\ell(L^{t+1},b)" display="inline"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><msup id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml"><mi id="alg1.l7.m1.2.2.3.2" xref="alg1.l7.m1.2.2.3.2.cmml">L</mi><mrow id="alg1.l7.m1.2.2.3.3" xref="alg1.l7.m1.2.2.3.3.cmml"><mi id="alg1.l7.m1.2.2.3.3.2" xref="alg1.l7.m1.2.2.3.3.2.cmml">t</mi><mo id="alg1.l7.m1.2.2.3.3.1" xref="alg1.l7.m1.2.2.3.3.1.cmml">+</mo><mn id="alg1.l7.m1.2.2.3.3.3" xref="alg1.l7.m1.2.2.3.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="alg1.l7.m1.2.2.2" xref="alg1.l7.m1.2.2.2.cmml">←</mo><mrow id="alg1.l7.m1.2.2.1" xref="alg1.l7.m1.2.2.1.cmml"><msup id="alg1.l7.m1.2.2.1.3" xref="alg1.l7.m1.2.2.1.3.cmml"><mi id="alg1.l7.m1.2.2.1.3.2" xref="alg1.l7.m1.2.2.1.3.2.cmml">L</mi><mrow id="alg1.l7.m1.2.2.1.3.3" xref="alg1.l7.m1.2.2.1.3.3.cmml"><mi id="alg1.l7.m1.2.2.1.3.3.2" xref="alg1.l7.m1.2.2.1.3.3.2.cmml">t</mi><mo id="alg1.l7.m1.2.2.1.3.3.1" xref="alg1.l7.m1.2.2.1.3.3.1.cmml">+</mo><mn id="alg1.l7.m1.2.2.1.3.3.3" xref="alg1.l7.m1.2.2.1.3.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l7.m1.2.2.1.2" xref="alg1.l7.m1.2.2.1.2.cmml">−</mo><mrow id="alg1.l7.m1.2.2.1.1" xref="alg1.l7.m1.2.2.1.1.cmml"><mrow id="alg1.l7.m1.2.2.1.1.3" xref="alg1.l7.m1.2.2.1.1.3.cmml"><mrow id="alg1.l7.m1.2.2.1.1.3.2" xref="alg1.l7.m1.2.2.1.1.3.2.cmml"><mi id="alg1.l7.m1.2.2.1.1.3.2.2" xref="alg1.l7.m1.2.2.1.1.3.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.1.1.3.2.1" xref="alg1.l7.m1.2.2.1.1.3.2.1.cmml">​</mo><mi id="alg1.l7.m1.2.2.1.1.3.2.3" xref="alg1.l7.m1.2.2.1.1.3.2.3.cmml">r</mi></mrow><mo lspace="0.222em" rspace="0.222em" id="alg1.l7.m1.2.2.1.1.3.1" xref="alg1.l7.m1.2.2.1.1.3.1.cmml">⋅</mo><mrow id="alg1.l7.m1.2.2.1.1.3.3" xref="alg1.l7.m1.2.2.1.1.3.3.cmml"><mo rspace="0.167em" id="alg1.l7.m1.2.2.1.1.3.3.1" xref="alg1.l7.m1.2.2.1.1.3.3.1.cmml">∇</mo><mi mathvariant="normal" id="alg1.l7.m1.2.2.1.1.3.3.2" xref="alg1.l7.m1.2.2.1.1.3.3.2.cmml">ℓ</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.1.1.2" xref="alg1.l7.m1.2.2.1.1.2.cmml">​</mo><mrow id="alg1.l7.m1.2.2.1.1.1.1" xref="alg1.l7.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l7.m1.2.2.1.1.1.1.2" xref="alg1.l7.m1.2.2.1.1.1.2.cmml">(</mo><msup id="alg1.l7.m1.2.2.1.1.1.1.1" xref="alg1.l7.m1.2.2.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.2.2.1.1.1.1.1.2" xref="alg1.l7.m1.2.2.1.1.1.1.1.2.cmml">L</mi><mrow id="alg1.l7.m1.2.2.1.1.1.1.1.3" xref="alg1.l7.m1.2.2.1.1.1.1.1.3.cmml"><mi id="alg1.l7.m1.2.2.1.1.1.1.1.3.2" xref="alg1.l7.m1.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l7.m1.2.2.1.1.1.1.1.3.1" xref="alg1.l7.m1.2.2.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l7.m1.2.2.1.1.1.1.1.3.3" xref="alg1.l7.m1.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l7.m1.2.2.1.1.1.1.3" xref="alg1.l7.m1.2.2.1.1.1.2.cmml">,</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">b</mi><mo stretchy="false" id="alg1.l7.m1.2.2.1.1.1.1.4" xref="alg1.l7.m1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.2.cmml" xref="alg1.l7.m1.2.2.2">←</ci><apply id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.3.1.cmml" xref="alg1.l7.m1.2.2.3">superscript</csymbol><ci id="alg1.l7.m1.2.2.3.2.cmml" xref="alg1.l7.m1.2.2.3.2">𝐿</ci><apply id="alg1.l7.m1.2.2.3.3.cmml" xref="alg1.l7.m1.2.2.3.3"><plus id="alg1.l7.m1.2.2.3.3.1.cmml" xref="alg1.l7.m1.2.2.3.3.1"></plus><ci id="alg1.l7.m1.2.2.3.3.2.cmml" xref="alg1.l7.m1.2.2.3.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m1.2.2.3.3.3.cmml" xref="alg1.l7.m1.2.2.3.3.3">1</cn></apply></apply><apply id="alg1.l7.m1.2.2.1.cmml" xref="alg1.l7.m1.2.2.1"><minus id="alg1.l7.m1.2.2.1.2.cmml" xref="alg1.l7.m1.2.2.1.2"></minus><apply id="alg1.l7.m1.2.2.1.3.cmml" xref="alg1.l7.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.1.3.1.cmml" xref="alg1.l7.m1.2.2.1.3">superscript</csymbol><ci id="alg1.l7.m1.2.2.1.3.2.cmml" xref="alg1.l7.m1.2.2.1.3.2">𝐿</ci><apply id="alg1.l7.m1.2.2.1.3.3.cmml" xref="alg1.l7.m1.2.2.1.3.3"><plus id="alg1.l7.m1.2.2.1.3.3.1.cmml" xref="alg1.l7.m1.2.2.1.3.3.1"></plus><ci id="alg1.l7.m1.2.2.1.3.3.2.cmml" xref="alg1.l7.m1.2.2.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m1.2.2.1.3.3.3.cmml" xref="alg1.l7.m1.2.2.1.3.3.3">1</cn></apply></apply><apply id="alg1.l7.m1.2.2.1.1.cmml" xref="alg1.l7.m1.2.2.1.1"><times id="alg1.l7.m1.2.2.1.1.2.cmml" xref="alg1.l7.m1.2.2.1.1.2"></times><apply id="alg1.l7.m1.2.2.1.1.3.cmml" xref="alg1.l7.m1.2.2.1.1.3"><ci id="alg1.l7.m1.2.2.1.1.3.1.cmml" xref="alg1.l7.m1.2.2.1.1.3.1">⋅</ci><apply id="alg1.l7.m1.2.2.1.1.3.2.cmml" xref="alg1.l7.m1.2.2.1.1.3.2"><times id="alg1.l7.m1.2.2.1.1.3.2.1.cmml" xref="alg1.l7.m1.2.2.1.1.3.2.1"></times><ci id="alg1.l7.m1.2.2.1.1.3.2.2.cmml" xref="alg1.l7.m1.2.2.1.1.3.2.2">𝑙</ci><ci id="alg1.l7.m1.2.2.1.1.3.2.3.cmml" xref="alg1.l7.m1.2.2.1.1.3.2.3">𝑟</ci></apply><apply id="alg1.l7.m1.2.2.1.1.3.3.cmml" xref="alg1.l7.m1.2.2.1.1.3.3"><ci id="alg1.l7.m1.2.2.1.1.3.3.1.cmml" xref="alg1.l7.m1.2.2.1.1.3.3.1">∇</ci><ci id="alg1.l7.m1.2.2.1.1.3.3.2.cmml" xref="alg1.l7.m1.2.2.1.1.3.3.2">ℓ</ci></apply></apply><interval closure="open" id="alg1.l7.m1.2.2.1.1.1.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.1"><apply id="alg1.l7.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="alg1.l7.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.1.2">𝐿</ci><apply id="alg1.l7.m1.2.2.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.1.3"><plus id="alg1.l7.m1.2.2.1.1.1.1.1.3.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.1.3.1"></plus><ci id="alg1.l7.m1.2.2.1.1.1.1.1.3.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m1.2.2.1.1.1.1.1.3.3.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑏</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">L^{t+1}\leftarrow L^{t+1}-lr\cdot\nabla\ell(L^{t+1},b)</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l9" class="ltx_listingline">  <span id="alg1.l9.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">  return <math id="alg1.l10.m1.1" class="ltx_Math" alttext="L^{t+1}" display="inline"><semantics id="alg1.l10.m1.1a"><msup id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">L</mi><mrow id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mi id="alg1.l10.m1.1.1.3.2" xref="alg1.l10.m1.1.1.3.2.cmml">t</mi><mo id="alg1.l10.m1.1.1.3.1" xref="alg1.l10.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">superscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝐿</ci><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><plus id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3.1"></plus><ci id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">L^{t+1}</annotation></semantics></math>

</div>
</div>
</figure>
</figure>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.7" class="ltx_p">At each round <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">t</annotation></semantics></math>, the central server randomly selects a subset of
<math id="S3.p2.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">m</annotation></semantics></math> participants <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="S_{m}" display="inline"><semantics id="S3.p2.3.m3.1a"><msub id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">S</mi><mi id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝑆</ci><ci id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">S_{m}</annotation></semantics></math> and sends them the current joint model <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="S3.p2.4.m4.1a"><msup id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><mi id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml">G</mi><mi id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><apply id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m4.1.1.1.cmml" xref="S3.p2.4.m4.1.1">superscript</csymbol><ci id="S3.p2.4.m4.1.1.2.cmml" xref="S3.p2.4.m4.1.1.2">𝐺</ci><ci id="S3.p2.4.m4.1.1.3.cmml" xref="S3.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">G^{t}</annotation></semantics></math>.
Choosing <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S3.p2.5.m5.1a"><mi id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><ci id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">m</annotation></semantics></math> involves a tradeoff between the efficiency and speed
of training. Each selected participant updates this model to a
new local model <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="L^{t+1}" display="inline"><semantics id="S3.p2.6.m6.1a"><msup id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">L</mi><mrow id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml"><mi id="S3.p2.6.m6.1.1.3.2" xref="S3.p2.6.m6.1.1.3.2.cmml">t</mi><mo id="S3.p2.6.m6.1.1.3.1" xref="S3.p2.6.m6.1.1.3.1.cmml">+</mo><mn id="S3.p2.6.m6.1.1.3.3" xref="S3.p2.6.m6.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1">superscript</csymbol><ci id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2">𝐿</ci><apply id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3"><plus id="S3.p2.6.m6.1.1.3.1.cmml" xref="S3.p2.6.m6.1.1.3.1"></plus><ci id="S3.p2.6.m6.1.1.3.2.cmml" xref="S3.p2.6.m6.1.1.3.2">𝑡</ci><cn type="integer" id="S3.p2.6.m6.1.1.3.3.cmml" xref="S3.p2.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">L^{t+1}</annotation></semantics></math> by training on their private data using
Algorithm <a href="#alg1" title="Algorithm 1 ‣ 3. Federated Learning ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and sends the difference <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="L_{i}^{t+1}-G^{t}" display="inline"><semantics id="S3.p2.7.m7.1a"><mrow id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><msubsup id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml"><mi id="S3.p2.7.m7.1.1.2.2.2" xref="S3.p2.7.m7.1.1.2.2.2.cmml">L</mi><mi id="S3.p2.7.m7.1.1.2.2.3" xref="S3.p2.7.m7.1.1.2.2.3.cmml">i</mi><mrow id="S3.p2.7.m7.1.1.2.3" xref="S3.p2.7.m7.1.1.2.3.cmml"><mi id="S3.p2.7.m7.1.1.2.3.2" xref="S3.p2.7.m7.1.1.2.3.2.cmml">t</mi><mo id="S3.p2.7.m7.1.1.2.3.1" xref="S3.p2.7.m7.1.1.2.3.1.cmml">+</mo><mn id="S3.p2.7.m7.1.1.2.3.3" xref="S3.p2.7.m7.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.p2.7.m7.1.1.1" xref="S3.p2.7.m7.1.1.1.cmml">−</mo><msup id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml"><mi id="S3.p2.7.m7.1.1.3.2" xref="S3.p2.7.m7.1.1.3.2.cmml">G</mi><mi id="S3.p2.7.m7.1.1.3.3" xref="S3.p2.7.m7.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><minus id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1.1"></minus><apply id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.2.1.cmml" xref="S3.p2.7.m7.1.1.2">superscript</csymbol><apply id="S3.p2.7.m7.1.1.2.2.cmml" xref="S3.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.2.2.1.cmml" xref="S3.p2.7.m7.1.1.2">subscript</csymbol><ci id="S3.p2.7.m7.1.1.2.2.2.cmml" xref="S3.p2.7.m7.1.1.2.2.2">𝐿</ci><ci id="S3.p2.7.m7.1.1.2.2.3.cmml" xref="S3.p2.7.m7.1.1.2.2.3">𝑖</ci></apply><apply id="S3.p2.7.m7.1.1.2.3.cmml" xref="S3.p2.7.m7.1.1.2.3"><plus id="S3.p2.7.m7.1.1.2.3.1.cmml" xref="S3.p2.7.m7.1.1.2.3.1"></plus><ci id="S3.p2.7.m7.1.1.2.3.2.cmml" xref="S3.p2.7.m7.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.p2.7.m7.1.1.2.3.3.cmml" xref="S3.p2.7.m7.1.1.2.3.3">1</cn></apply></apply><apply id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.3.1.cmml" xref="S3.p2.7.m7.1.1.3">superscript</csymbol><ci id="S3.p2.7.m7.1.1.3.2.cmml" xref="S3.p2.7.m7.1.1.3.2">𝐺</ci><ci id="S3.p2.7.m7.1.1.3.3.cmml" xref="S3.p2.7.m7.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">L_{i}^{t+1}-G^{t}</annotation></semantics></math> back
to the central server. Communication overhead can be reduced by applying
a random mask to the model weights <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib34" title="" class="ltx_ref">fedlearn_2, </a>)</cite>. The central server
averages the received updates to obtain the new joint model:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="G^{t+1}=G^{t}+\frac{\eta}{n}\sum_{i=1}^{m}(L_{i}^{t+1}-G^{t})" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><msup id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml">G</mi><mrow id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.3.3.2" xref="S3.E1.m1.1.1.3.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.3.3.1" xref="S3.E1.m1.1.1.3.3.1.cmml">+</mo><mn id="S3.E1.m1.1.1.3.3.3" xref="S3.E1.m1.1.1.3.3.3.cmml">1</mn></mrow></msup><mo id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><msup id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.3.2.cmml">G</mi><mi id="S3.E1.m1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.3.3.cmml">t</mi></msup><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mfrac id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">η</mi><mi id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S3.E1.m1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.2.3.cmml">m</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">L</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S3.E1.m1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"></eq><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2">𝐺</ci><apply id="S3.E1.m1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.3.3"><plus id="S3.E1.m1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.3.3.1"></plus><ci id="S3.E1.m1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.3.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><plus id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></plus><apply id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.3.2">𝐺</ci><ci id="S3.E1.m1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><divide id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3"></divide><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">𝜂</ci><ci id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.2.3">𝑚</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.2">𝐿</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3"><plus id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.2">𝐺</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">G^{t+1}=G^{t}+\frac{\eta}{n}\sum_{i=1}^{m}(L_{i}^{t+1}-G^{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.p2.12" class="ltx_p">Global learning rate <math id="S3.p2.8.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.p2.8.m1.1a"><mi id="S3.p2.8.m1.1.1" xref="S3.p2.8.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.p2.8.m1.1b"><ci id="S3.p2.8.m1.1.1.cmml" xref="S3.p2.8.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m1.1c">\eta</annotation></semantics></math> controls the fraction of the joint model
that is updated every round; if <math id="S3.p2.9.m2.1" class="ltx_Math" alttext="\eta=\frac{n}{m}" display="inline"><semantics id="S3.p2.9.m2.1a"><mrow id="S3.p2.9.m2.1.1" xref="S3.p2.9.m2.1.1.cmml"><mi id="S3.p2.9.m2.1.1.2" xref="S3.p2.9.m2.1.1.2.cmml">η</mi><mo id="S3.p2.9.m2.1.1.1" xref="S3.p2.9.m2.1.1.1.cmml">=</mo><mfrac id="S3.p2.9.m2.1.1.3" xref="S3.p2.9.m2.1.1.3.cmml"><mi id="S3.p2.9.m2.1.1.3.2" xref="S3.p2.9.m2.1.1.3.2.cmml">n</mi><mi id="S3.p2.9.m2.1.1.3.3" xref="S3.p2.9.m2.1.1.3.3.cmml">m</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.9.m2.1b"><apply id="S3.p2.9.m2.1.1.cmml" xref="S3.p2.9.m2.1.1"><eq id="S3.p2.9.m2.1.1.1.cmml" xref="S3.p2.9.m2.1.1.1"></eq><ci id="S3.p2.9.m2.1.1.2.cmml" xref="S3.p2.9.m2.1.1.2">𝜂</ci><apply id="S3.p2.9.m2.1.1.3.cmml" xref="S3.p2.9.m2.1.1.3"><divide id="S3.p2.9.m2.1.1.3.1.cmml" xref="S3.p2.9.m2.1.1.3"></divide><ci id="S3.p2.9.m2.1.1.3.2.cmml" xref="S3.p2.9.m2.1.1.3.2">𝑛</ci><ci id="S3.p2.9.m2.1.1.3.3.cmml" xref="S3.p2.9.m2.1.1.3.3">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m2.1c">\eta=\frac{n}{m}</annotation></semantics></math>, the model is
fully replaced by the average of the local models. Tasks like
CIFAR-10 require lower <math id="S3.p2.10.m3.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.p2.10.m3.1a"><mi id="S3.p2.10.m3.1.1" xref="S3.p2.10.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.p2.10.m3.1b"><ci id="S3.p2.10.m3.1.1.cmml" xref="S3.p2.10.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m3.1c">\eta</annotation></semantics></math> to converge, while training with
<math id="S3.p2.11.m4.1" class="ltx_Math" alttext="n=10^{8}" display="inline"><semantics id="S3.p2.11.m4.1a"><mrow id="S3.p2.11.m4.1.1" xref="S3.p2.11.m4.1.1.cmml"><mi id="S3.p2.11.m4.1.1.2" xref="S3.p2.11.m4.1.1.2.cmml">n</mi><mo id="S3.p2.11.m4.1.1.1" xref="S3.p2.11.m4.1.1.1.cmml">=</mo><msup id="S3.p2.11.m4.1.1.3" xref="S3.p2.11.m4.1.1.3.cmml"><mn id="S3.p2.11.m4.1.1.3.2" xref="S3.p2.11.m4.1.1.3.2.cmml">10</mn><mn id="S3.p2.11.m4.1.1.3.3" xref="S3.p2.11.m4.1.1.3.3.cmml">8</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.11.m4.1b"><apply id="S3.p2.11.m4.1.1.cmml" xref="S3.p2.11.m4.1.1"><eq id="S3.p2.11.m4.1.1.1.cmml" xref="S3.p2.11.m4.1.1.1"></eq><ci id="S3.p2.11.m4.1.1.2.cmml" xref="S3.p2.11.m4.1.1.2">𝑛</ci><apply id="S3.p2.11.m4.1.1.3.cmml" xref="S3.p2.11.m4.1.1.3"><csymbol cd="ambiguous" id="S3.p2.11.m4.1.1.3.1.cmml" xref="S3.p2.11.m4.1.1.3">superscript</csymbol><cn type="integer" id="S3.p2.11.m4.1.1.3.2.cmml" xref="S3.p2.11.m4.1.1.3.2">10</cn><cn type="integer" id="S3.p2.11.m4.1.1.3.3.cmml" xref="S3.p2.11.m4.1.1.3.3">8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m4.1c">n=10^{8}</annotation></semantics></math> users requires larger <math id="S3.p2.12.m5.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.p2.12.m5.1a"><mi id="S3.p2.12.m5.1.1" xref="S3.p2.12.m5.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.p2.12.m5.1b"><ci id="S3.p2.12.m5.1.1.cmml" xref="S3.p2.12.m5.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m5.1c">\eta</annotation></semantics></math> for the local models to have
impact on the joint model. In comparison to synchronous distributed
SGD <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib10" title="" class="ltx_ref">chen2016revisiting, </a>)</cite>, federated learning reduces the number
of participants per round and converges faster. Empirically, common
image-classification and word-prediction tasks converge in fewer than
10,000 rounds <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">Federated learning explicitly assumes that participants’ local training
datasets are relatively small and drawn from different distributions.
Therefore, local models tend to overfit, diverge from the joint global
model, and exhibit low accuracy. There are also significant differences
between the weights of individual models (we discuss this further in
Section <a href="#A1.SS1" title="A.1. Clustering ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>). Averaging local models balances out their
contributions to produce an accurate joint model.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">Learning does not stop after the model converges. Federated-learning
models are continuously updated by participants throughout their
deployment. A malicious participant thus always has an opportunity to
be selected and influence the model.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Adversarial Model Replacement</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Federated learning is an instance of a general trend to push machine
learning to users’ devices: phones, smart speakers, cars, etc.
Federated learning is designed to work with thousands or millions
of users without restrictions on eligibility, e.g., by enrolling
individual smartphones <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib23" title="" class="ltx_ref">aigoogle, </a>)</cite>. Similarly, crowd-sourced ML
frameworks <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib50" title="" class="ltx_ref">openmined, </a>; <a href="#bib.bib15" title="" class="ltx_ref">decentralizedml, </a>)</cite> accept anyone running the
(possibly modified) learning software.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Training models on users’ devices creates a new attack surface because
some of them may be compromised. When training with thousands of users,
there does not appear to be any way to exclude adversarial participants
by relying solely on the devices’ own security guarantees. Following
an unpublished version of this work, training with multiple malicious
participants is now acknowledged as a realistic threat by the designers
of federated learning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib6" title="" class="ltx_ref">fedlearn_sys, </a>)</cite>.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">Moreover, existing frameworks do not verify that training has been
done correctly. As we show in this paper, a compromised participant can
submit a malicious model which is not only trained for the assigned task,
but also contains backdoor functionality. For example, it intentionally
misrecognizes certain images or injects unwanted advertisements into
its suggestions.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Threat model</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Federated learning gives the attacker full control over one or several
participants, e.g., smartphones whose learning software has been
compromised by malware. (1) The attacker controls the local training
data of any compromised participant; (2) it controls the local training
procedure and the hyperparameters such as the number of epochs and
learning rate; (3) it can modify the weights of the resulting model
before submitting it for aggregation; and, (4) it can adaptively change
its local training from round to round.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">The attacker does not control the aggregation algorithm used to combine
participants’ updates into the joint model, nor any aspects of the benign
participants’ training. We assume that they create their local models
by correctly applying the training algorithm prescribed by federated
learning to their local data.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">The main difference between this setting and the traditional poisoning
attacks (see Section <a href="#S2" title="2. Related Work ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) is that the latter assume
that the attacker controls a significant fraction of the training data.
By contrast, in federated learning the attacker controls the entire
training process—but only for one or a few participants.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Objectives of the attack.</span> 
Our attacker wants federated learning to produce a joint model that
achieves high accuracy on both its main task and an attacker-chosen
<em id="S4.SS1.p4.1.2" class="ltx_emph ltx_font_italic">backdoor subtask</em> and retains high accuracy on the backdoor
subtask for multiple rounds after the attack. By contrast, traditional
data poisoning aims to change the performance of the model on large
parts of the input space <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib58" title="" class="ltx_ref">rubinstein2009imc, </a>; <a href="#bib.bib4" title="" class="ltx_ref">biggio2012icml, </a>; <a href="#bib.bib63" title="" class="ltx_ref">steinhardt2017certified, </a>)</cite>, while Byzantine attacks aim to prevent
convergence <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib5" title="" class="ltx_ref">blanchard2017machine, </a>)</cite>.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.1" class="ltx_p">A security vulnerability is dangerous even if it cannot be exploited every
single time and if it is patched some time after exploitation. By the
same token, a model-replacement attack is successful if it sometimes
introduces the backdoor (even if it sometimes fails), as long as the model
exhibits high backdoor accuracy for at least a single round. In practice,
the attack performs much better and the backdoor stays for many rounds.</p>
</div>
<div id="S4.SS1.p6" class="ltx_para">
<p id="S4.SS1.p6.1" class="ltx_p"><span id="S4.SS1.p6.1.1" class="ltx_text ltx_font_bold">Semantic backdoors</span> cause the model to produce an attacker-chosen
output on <em id="S4.SS1.p6.1.2" class="ltx_emph ltx_font_italic">unmodified</em> digital inputs. For example, a backdoored
image-classification model assigns an attacker-chosen label to all
images with certain features, e.g., all purple cars or all cars with
a racing stripe are misclassified as birds (or any other label chosen
by the attacker). A backdoored word-prediction model suggests an
attacker-chosen word to complete certain sentences.</p>
</div>
<div id="S4.SS1.p7" class="ltx_para">
<p id="S4.SS1.p7.1" class="ltx_p">For a semantic image backdoor, the attacker is free to choose either
naturally occurring features of the physical scene (e.g., a certain car
color) or features that cannot occur without the attacker’s involvement
(e.g., a special hat or glasses that only the attacker has). The attacker
can thus choose if the backdoor is triggered by certain scenes without
the attacker’s involvement, or only by scenes physically modified by
the attacker. Neither type of semantic backdoor requires the attacker
to modify the digital image at test time.</p>
</div>
<div id="S4.SS1.p8" class="ltx_para">
<p id="S4.SS1.p8.1" class="ltx_p">Other work on backdoors <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib24" title="" class="ltx_ref">badnets, </a>; <a href="#bib.bib3" title="" class="ltx_ref">bhagoji2018analyzing, </a>)</cite> considered
<span id="S4.SS1.p8.1.1" class="ltx_text ltx_font_bold">pixel-pattern</span> backdoors. These backdoors require the attacker
to modify the pixels of the digital image in a special way at test time
in order for the model to misclassify the modified image. We show
that our model-replacement attack can introduce either semantic, or
pixel-pattern backdoors into the model, but focus primarily on the
(strictly more powerful) semantic backdoors.</p>
</div>
<div id="S4.SS1.p9" class="ltx_para ltx_noindent">
<p id="S4.SS1.p9.1" class="ltx_p"><span id="S4.SS1.p9.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Backdoors vs. adversarial examples.</span> 

Adversarial transformations exploit the boundaries between the
model’s representations of different classes to produce inputs that are
misclassified by the model. By contrast, backdoor attacks intentionally
shift these boundaries so that certain inputs are misclassified.</p>
</div>
<div id="S4.SS1.p10" class="ltx_para">
<p id="S4.SS1.p10.1" class="ltx_p">Pixel-pattern backdoors <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib24" title="" class="ltx_ref">badnets, </a>)</cite> are strictly weaker than
adversarial transformations: the attacker must poison the model at
training time <em id="S4.SS1.p10.1.1" class="ltx_emph ltx_font_italic">and</em> modify the input at test time. A purely
test-time attack will achieve the same result: apply an adversarial
transformation to the input and an unmodified model will misclassify it.</p>
</div>
<div id="S4.SS1.p11" class="ltx_para">
<p id="S4.SS1.p11.1" class="ltx_p">Semantic backdoors, however, cause the model to misclassify even the
<em id="S4.SS1.p11.1.1" class="ltx_emph ltx_font_italic">inputs that are not changed by the attacker</em>, e.g., sentences
submitted by benign users or non-adversarial images with certain
image-level or physical features (e.g., colors or attributes of objects).</p>
</div>
<div id="S4.SS1.p12" class="ltx_para">
<p id="S4.SS1.p12.1" class="ltx_p">Semantic backdoors can be more dangerous than adversarial transformations
if federated-learning models are deployed at scale. Consider an attacker
who wants a car-based model for recognizing road signs to interpret a
certain advertisement as a stop sign. The attacker has no control over
digital images taken by the car’s camera. To apply physical adversarial
transformations, he would need to modify hundreds of physical billboards
in a visible way. A backdoor introduced during training, however, would
cause misclassification in all deployed models without any additional
action by the attacker.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Constructing the attack model</h3>

<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.1" class="ltx_p"><span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Naive approach.</span> 

The attacker can simply train its model on backdoored inputs.
Following <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib24" title="" class="ltx_ref">badnets, </a>)</cite>, each training batch should include a mix of
correctly labeled inputs and backdoored inputs to help the model learn
to recognize the difference. The attacker can also change the local
learning rate and the number of local epochs to maximize the overfitting
to the backdoored data.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Even this attack immediately breaks distributed learning with synchronized
SGD <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib61" title="" class="ltx_ref">shokri2015privacy, </a>)</cite>, which applies participants’ updates
directly to the joint model, thus introducing the backdoor. A recent
defense <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib14" title="" class="ltx_ref">damaskinos2018asynchronous, </a>)</cite> requires the loss function to
be Lipschitz and thus does not apply in general to large neural networks
(See Sec. <a href="#S6.SS2" title="6.2. Byzantine-tolerant distributed learning ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></a>).</p>
</div>
<figure id="S4.SS2.14" class="ltx_table">
<table id="S4.SS2.14.14" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.SS2.14.14.15.1" class="ltx_tr">
<th id="S4.SS2.14.14.15.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="2"><span id="S4.SS2.14.14.15.1.1.1" class="ltx_text ltx_font_bold">Methods</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.SS2.2.2.2" class="ltx_tr">
<th id="S4.SS2.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S4.SS2.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{ano}(X)" display="inline"><semantics id="S4.SS2.1.1.1.1.m1.1a"><mrow id="S4.SS2.1.1.1.1.m1.1.2" xref="S4.SS2.1.1.1.1.m1.1.2.cmml"><msub id="S4.SS2.1.1.1.1.m1.1.2.2" xref="S4.SS2.1.1.1.1.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.1.1.1.1.m1.1.2.2.2" xref="S4.SS2.1.1.1.1.m1.1.2.2.2.cmml">ℒ</mi><mrow id="S4.SS2.1.1.1.1.m1.1.2.2.3" xref="S4.SS2.1.1.1.1.m1.1.2.2.3.cmml"><mi id="S4.SS2.1.1.1.1.m1.1.2.2.3.2" xref="S4.SS2.1.1.1.1.m1.1.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.1.1.1.1.m1.1.2.2.3.1" xref="S4.SS2.1.1.1.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S4.SS2.1.1.1.1.m1.1.2.2.3.3" xref="S4.SS2.1.1.1.1.m1.1.2.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.1.1.1.1.m1.1.2.2.3.1a" xref="S4.SS2.1.1.1.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S4.SS2.1.1.1.1.m1.1.2.2.3.4" xref="S4.SS2.1.1.1.1.m1.1.2.2.3.4.cmml">o</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS2.1.1.1.1.m1.1.2.1" xref="S4.SS2.1.1.1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.1.1.1.1.m1.1.2.3.2" xref="S4.SS2.1.1.1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.1.1.1.1.m1.1.2.3.2.1" xref="S4.SS2.1.1.1.1.m1.1.2.cmml">(</mo><mi id="S4.SS2.1.1.1.1.m1.1.1" xref="S4.SS2.1.1.1.1.m1.1.1.cmml">X</mi><mo stretchy="false" id="S4.SS2.1.1.1.1.m1.1.2.3.2.2" xref="S4.SS2.1.1.1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.1.1.1.1.m1.1b"><apply id="S4.SS2.1.1.1.1.m1.1.2.cmml" xref="S4.SS2.1.1.1.1.m1.1.2"><times id="S4.SS2.1.1.1.1.m1.1.2.1.cmml" xref="S4.SS2.1.1.1.1.m1.1.2.1"></times><apply id="S4.SS2.1.1.1.1.m1.1.2.2.cmml" xref="S4.SS2.1.1.1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.1.1.1.1.m1.1.2.2.1.cmml" xref="S4.SS2.1.1.1.1.m1.1.2.2">subscript</csymbol><ci id="S4.SS2.1.1.1.1.m1.1.2.2.2.cmml" xref="S4.SS2.1.1.1.1.m1.1.2.2.2">ℒ</ci><apply id="S4.SS2.1.1.1.1.m1.1.2.2.3.cmml" xref="S4.SS2.1.1.1.1.m1.1.2.2.3"><times id="S4.SS2.1.1.1.1.m1.1.2.2.3.1.cmml" xref="S4.SS2.1.1.1.1.m1.1.2.2.3.1"></times><ci id="S4.SS2.1.1.1.1.m1.1.2.2.3.2.cmml" xref="S4.SS2.1.1.1.1.m1.1.2.2.3.2">𝑎</ci><ci id="S4.SS2.1.1.1.1.m1.1.2.2.3.3.cmml" xref="S4.SS2.1.1.1.1.m1.1.2.2.3.3">𝑛</ci><ci id="S4.SS2.1.1.1.1.m1.1.2.2.3.4.cmml" xref="S4.SS2.1.1.1.1.m1.1.2.2.3.4">𝑜</ci></apply></apply><ci id="S4.SS2.1.1.1.1.m1.1.1.cmml" xref="S4.SS2.1.1.1.1.m1.1.1">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.1.1.1.1.m1.1c">\mathcal{L}_{ano}(X)</annotation></semantics></math></th>
<td id="S4.SS2.2.2.2.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.SS2.2.2.2.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS2.2.2.2.2.1.1" class="ltx_p" style="width:159.3pt;">“Anomalousness” of model <math id="S4.SS2.2.2.2.2.1.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS2.2.2.2.2.1.1.m1.1a"><mi id="S4.SS2.2.2.2.2.1.1.m1.1.1" xref="S4.SS2.2.2.2.2.1.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.2.2.2.2.1.1.m1.1b"><ci id="S4.SS2.2.2.2.2.1.1.m1.1.1.cmml" xref="S4.SS2.2.2.2.2.1.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.2.2.2.2.1.1.m1.1c">X</annotation></semantics></math>,
per the aggregator’s anomaly detector</span>
</span>
</td>
</tr>
<tr id="S4.SS2.6.6.6" class="ltx_tr">
<th id="S4.SS2.3.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S4.SS2.3.3.3.1.m1.3" class="ltx_Math" alttext="\texttt{replace}(c,b,D)" display="inline"><semantics id="S4.SS2.3.3.3.1.m1.3a"><mrow id="S4.SS2.3.3.3.1.m1.3.4" xref="S4.SS2.3.3.3.1.m1.3.4.cmml"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.3.3.3.1.m1.3.4.2" xref="S4.SS2.3.3.3.1.m1.3.4.2a.cmml">replace</mtext><mo lspace="0em" rspace="0em" id="S4.SS2.3.3.3.1.m1.3.4.1" xref="S4.SS2.3.3.3.1.m1.3.4.1.cmml">​</mo><mrow id="S4.SS2.3.3.3.1.m1.3.4.3.2" xref="S4.SS2.3.3.3.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S4.SS2.3.3.3.1.m1.3.4.3.2.1" xref="S4.SS2.3.3.3.1.m1.3.4.3.1.cmml">(</mo><mi id="S4.SS2.3.3.3.1.m1.1.1" xref="S4.SS2.3.3.3.1.m1.1.1.cmml">c</mi><mo id="S4.SS2.3.3.3.1.m1.3.4.3.2.2" xref="S4.SS2.3.3.3.1.m1.3.4.3.1.cmml">,</mo><mi id="S4.SS2.3.3.3.1.m1.2.2" xref="S4.SS2.3.3.3.1.m1.2.2.cmml">b</mi><mo id="S4.SS2.3.3.3.1.m1.3.4.3.2.3" xref="S4.SS2.3.3.3.1.m1.3.4.3.1.cmml">,</mo><mi id="S4.SS2.3.3.3.1.m1.3.3" xref="S4.SS2.3.3.3.1.m1.3.3.cmml">D</mi><mo stretchy="false" id="S4.SS2.3.3.3.1.m1.3.4.3.2.4" xref="S4.SS2.3.3.3.1.m1.3.4.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.3.3.3.1.m1.3b"><apply id="S4.SS2.3.3.3.1.m1.3.4.cmml" xref="S4.SS2.3.3.3.1.m1.3.4"><times id="S4.SS2.3.3.3.1.m1.3.4.1.cmml" xref="S4.SS2.3.3.3.1.m1.3.4.1"></times><ci id="S4.SS2.3.3.3.1.m1.3.4.2a.cmml" xref="S4.SS2.3.3.3.1.m1.3.4.2"><mtext class="ltx_mathvariant_monospace" id="S4.SS2.3.3.3.1.m1.3.4.2.cmml" xref="S4.SS2.3.3.3.1.m1.3.4.2">replace</mtext></ci><vector id="S4.SS2.3.3.3.1.m1.3.4.3.1.cmml" xref="S4.SS2.3.3.3.1.m1.3.4.3.2"><ci id="S4.SS2.3.3.3.1.m1.1.1.cmml" xref="S4.SS2.3.3.3.1.m1.1.1">𝑐</ci><ci id="S4.SS2.3.3.3.1.m1.2.2.cmml" xref="S4.SS2.3.3.3.1.m1.2.2">𝑏</ci><ci id="S4.SS2.3.3.3.1.m1.3.3.cmml" xref="S4.SS2.3.3.3.1.m1.3.3">𝐷</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.3.3.3.1.m1.3c">\texttt{replace}(c,b,D)</annotation></semantics></math></th>
<td id="S4.SS2.6.6.6.4" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.SS2.6.6.6.4.3" class="ltx_inline-block ltx_align_top">
<span id="S4.SS2.6.6.6.4.3.3" class="ltx_p" style="width:159.3pt;">Replace <math id="S4.SS2.4.4.4.2.1.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.4.4.4.2.1.1.m1.1a"><mi id="S4.SS2.4.4.4.2.1.1.m1.1.1" xref="S4.SS2.4.4.4.2.1.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.4.4.4.2.1.1.m1.1b"><ci id="S4.SS2.4.4.4.2.1.1.m1.1.1.cmml" xref="S4.SS2.4.4.4.2.1.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.4.4.4.2.1.1.m1.1c">c</annotation></semantics></math> items in data batch <math id="S4.SS2.5.5.5.3.2.2.m2.1" class="ltx_Math" alttext="b" display="inline"><semantics id="S4.SS2.5.5.5.3.2.2.m2.1a"><mi id="S4.SS2.5.5.5.3.2.2.m2.1.1" xref="S4.SS2.5.5.5.3.2.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.5.5.5.3.2.2.m2.1b"><ci id="S4.SS2.5.5.5.3.2.2.m2.1.1.cmml" xref="S4.SS2.5.5.5.3.2.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.5.5.5.3.2.2.m2.1c">b</annotation></semantics></math> with items from dataset <math id="S4.SS2.6.6.6.4.3.3.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S4.SS2.6.6.6.4.3.3.m3.1a"><mi id="S4.SS2.6.6.6.4.3.3.m3.1.1" xref="S4.SS2.6.6.6.4.3.3.m3.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.6.6.6.4.3.3.m3.1b"><ci id="S4.SS2.6.6.6.4.3.3.m3.1.1.cmml" xref="S4.SS2.6.6.6.4.3.3.m3.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.6.6.6.4.3.3.m3.1c">D</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S4.SS2.14.14.16.1" class="ltx_tr">
<th id="S4.SS2.14.14.16.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" colspan="2"><span id="S4.SS2.14.14.16.1.1.1" class="ltx_text ltx_font_bold">Constrain-and-scale parameters</span></th>
</tr>
<tr id="S4.SS2.7.7.7" class="ltx_tr">
<th id="S4.SS2.7.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S4.SS2.7.7.7.1.m1.1" class="ltx_Math" alttext="lr_{adv}" display="inline"><semantics id="S4.SS2.7.7.7.1.m1.1a"><mrow id="S4.SS2.7.7.7.1.m1.1.1" xref="S4.SS2.7.7.7.1.m1.1.1.cmml"><mi id="S4.SS2.7.7.7.1.m1.1.1.2" xref="S4.SS2.7.7.7.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS2.7.7.7.1.m1.1.1.1" xref="S4.SS2.7.7.7.1.m1.1.1.1.cmml">​</mo><msub id="S4.SS2.7.7.7.1.m1.1.1.3" xref="S4.SS2.7.7.7.1.m1.1.1.3.cmml"><mi id="S4.SS2.7.7.7.1.m1.1.1.3.2" xref="S4.SS2.7.7.7.1.m1.1.1.3.2.cmml">r</mi><mrow id="S4.SS2.7.7.7.1.m1.1.1.3.3" xref="S4.SS2.7.7.7.1.m1.1.1.3.3.cmml"><mi id="S4.SS2.7.7.7.1.m1.1.1.3.3.2" xref="S4.SS2.7.7.7.1.m1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.7.7.7.1.m1.1.1.3.3.1" xref="S4.SS2.7.7.7.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.7.7.7.1.m1.1.1.3.3.3" xref="S4.SS2.7.7.7.1.m1.1.1.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.7.7.7.1.m1.1.1.3.3.1a" xref="S4.SS2.7.7.7.1.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.SS2.7.7.7.1.m1.1.1.3.3.4" xref="S4.SS2.7.7.7.1.m1.1.1.3.3.4.cmml">v</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.7.7.7.1.m1.1b"><apply id="S4.SS2.7.7.7.1.m1.1.1.cmml" xref="S4.SS2.7.7.7.1.m1.1.1"><times id="S4.SS2.7.7.7.1.m1.1.1.1.cmml" xref="S4.SS2.7.7.7.1.m1.1.1.1"></times><ci id="S4.SS2.7.7.7.1.m1.1.1.2.cmml" xref="S4.SS2.7.7.7.1.m1.1.1.2">𝑙</ci><apply id="S4.SS2.7.7.7.1.m1.1.1.3.cmml" xref="S4.SS2.7.7.7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.7.7.7.1.m1.1.1.3.1.cmml" xref="S4.SS2.7.7.7.1.m1.1.1.3">subscript</csymbol><ci id="S4.SS2.7.7.7.1.m1.1.1.3.2.cmml" xref="S4.SS2.7.7.7.1.m1.1.1.3.2">𝑟</ci><apply id="S4.SS2.7.7.7.1.m1.1.1.3.3.cmml" xref="S4.SS2.7.7.7.1.m1.1.1.3.3"><times id="S4.SS2.7.7.7.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.7.7.7.1.m1.1.1.3.3.1"></times><ci id="S4.SS2.7.7.7.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.7.7.7.1.m1.1.1.3.3.2">𝑎</ci><ci id="S4.SS2.7.7.7.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.7.7.7.1.m1.1.1.3.3.3">𝑑</ci><ci id="S4.SS2.7.7.7.1.m1.1.1.3.3.4.cmml" xref="S4.SS2.7.7.7.1.m1.1.1.3.3.4">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.7.7.7.1.m1.1c">lr_{adv}</annotation></semantics></math></th>
<td id="S4.SS2.7.7.7.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.SS2.7.7.7.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS2.7.7.7.2.1.1" class="ltx_p" style="width:159.3pt;">attacker’s learning rate</span>
</span>
</td>
</tr>
<tr id="S4.SS2.8.8.8" class="ltx_tr">
<th id="S4.SS2.8.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S4.SS2.8.8.8.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.8.8.8.1.m1.1a"><mi id="S4.SS2.8.8.8.1.m1.1.1" xref="S4.SS2.8.8.8.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.8.8.8.1.m1.1b"><ci id="S4.SS2.8.8.8.1.m1.1.1.cmml" xref="S4.SS2.8.8.8.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.8.8.8.1.m1.1c">\alpha</annotation></semantics></math></th>
<td id="S4.SS2.8.8.8.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.SS2.8.8.8.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS2.8.8.8.2.1.1" class="ltx_p" style="width:159.3pt;">controls importance of evading anomaly detection</span>
</span>
</td>
</tr>
<tr id="S4.SS2.9.9.9" class="ltx_tr">
<th id="S4.SS2.9.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S4.SS2.9.9.9.1.m1.1" class="ltx_Math" alttext="step\_sched" display="inline"><semantics id="S4.SS2.9.9.9.1.m1.1a"><mrow id="S4.SS2.9.9.9.1.m1.1.1" xref="S4.SS2.9.9.9.1.m1.1.1.cmml"><mi id="S4.SS2.9.9.9.1.m1.1.1.2" xref="S4.SS2.9.9.9.1.m1.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.9.9.9.1.m1.1.1.1" xref="S4.SS2.9.9.9.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.9.9.9.1.m1.1.1.3" xref="S4.SS2.9.9.9.1.m1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.9.9.9.1.m1.1.1.1a" xref="S4.SS2.9.9.9.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.9.9.9.1.m1.1.1.4" xref="S4.SS2.9.9.9.1.m1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.9.9.9.1.m1.1.1.1b" xref="S4.SS2.9.9.9.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.9.9.9.1.m1.1.1.5" xref="S4.SS2.9.9.9.1.m1.1.1.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.9.9.9.1.m1.1.1.1c" xref="S4.SS2.9.9.9.1.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS2.9.9.9.1.m1.1.1.6" xref="S4.SS2.9.9.9.1.m1.1.1.6.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS2.9.9.9.1.m1.1.1.1d" xref="S4.SS2.9.9.9.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.9.9.9.1.m1.1.1.7" xref="S4.SS2.9.9.9.1.m1.1.1.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.9.9.9.1.m1.1.1.1e" xref="S4.SS2.9.9.9.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.9.9.9.1.m1.1.1.8" xref="S4.SS2.9.9.9.1.m1.1.1.8.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS2.9.9.9.1.m1.1.1.1f" xref="S4.SS2.9.9.9.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.9.9.9.1.m1.1.1.9" xref="S4.SS2.9.9.9.1.m1.1.1.9.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS2.9.9.9.1.m1.1.1.1g" xref="S4.SS2.9.9.9.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.9.9.9.1.m1.1.1.10" xref="S4.SS2.9.9.9.1.m1.1.1.10.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.9.9.9.1.m1.1.1.1h" xref="S4.SS2.9.9.9.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.9.9.9.1.m1.1.1.11" xref="S4.SS2.9.9.9.1.m1.1.1.11.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.9.9.9.1.m1.1b"><apply id="S4.SS2.9.9.9.1.m1.1.1.cmml" xref="S4.SS2.9.9.9.1.m1.1.1"><times id="S4.SS2.9.9.9.1.m1.1.1.1.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.1"></times><ci id="S4.SS2.9.9.9.1.m1.1.1.2.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.2">𝑠</ci><ci id="S4.SS2.9.9.9.1.m1.1.1.3.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.3">𝑡</ci><ci id="S4.SS2.9.9.9.1.m1.1.1.4.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.4">𝑒</ci><ci id="S4.SS2.9.9.9.1.m1.1.1.5.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.5">𝑝</ci><ci id="S4.SS2.9.9.9.1.m1.1.1.6.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.6">_</ci><ci id="S4.SS2.9.9.9.1.m1.1.1.7.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.7">𝑠</ci><ci id="S4.SS2.9.9.9.1.m1.1.1.8.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.8">𝑐</ci><ci id="S4.SS2.9.9.9.1.m1.1.1.9.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.9">ℎ</ci><ci id="S4.SS2.9.9.9.1.m1.1.1.10.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.10">𝑒</ci><ci id="S4.SS2.9.9.9.1.m1.1.1.11.cmml" xref="S4.SS2.9.9.9.1.m1.1.1.11">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.9.9.9.1.m1.1c">step\_sched</annotation></semantics></math></th>
<td id="S4.SS2.9.9.9.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.SS2.9.9.9.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS2.9.9.9.2.1.1" class="ltx_p" style="width:159.3pt;">epochs when the learning rate should decrease</span>
</span>
</td>
</tr>
<tr id="S4.SS2.10.10.10" class="ltx_tr">
<th id="S4.SS2.10.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S4.SS2.10.10.10.1.m1.1" class="ltx_Math" alttext="step\_rate" display="inline"><semantics id="S4.SS2.10.10.10.1.m1.1a"><mrow id="S4.SS2.10.10.10.1.m1.1.1" xref="S4.SS2.10.10.10.1.m1.1.1.cmml"><mi id="S4.SS2.10.10.10.1.m1.1.1.2" xref="S4.SS2.10.10.10.1.m1.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS2.10.10.10.1.m1.1.1.1" xref="S4.SS2.10.10.10.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.10.10.10.1.m1.1.1.3" xref="S4.SS2.10.10.10.1.m1.1.1.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.10.10.10.1.m1.1.1.1a" xref="S4.SS2.10.10.10.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.10.10.10.1.m1.1.1.4" xref="S4.SS2.10.10.10.1.m1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS2.10.10.10.1.m1.1.1.1b" xref="S4.SS2.10.10.10.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.10.10.10.1.m1.1.1.5" xref="S4.SS2.10.10.10.1.m1.1.1.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS2.10.10.10.1.m1.1.1.1c" xref="S4.SS2.10.10.10.1.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS2.10.10.10.1.m1.1.1.6" xref="S4.SS2.10.10.10.1.m1.1.1.6.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS2.10.10.10.1.m1.1.1.1d" xref="S4.SS2.10.10.10.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.10.10.10.1.m1.1.1.7" xref="S4.SS2.10.10.10.1.m1.1.1.7.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.SS2.10.10.10.1.m1.1.1.1e" xref="S4.SS2.10.10.10.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.10.10.10.1.m1.1.1.8" xref="S4.SS2.10.10.10.1.m1.1.1.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.10.10.10.1.m1.1.1.1f" xref="S4.SS2.10.10.10.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.10.10.10.1.m1.1.1.9" xref="S4.SS2.10.10.10.1.m1.1.1.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS2.10.10.10.1.m1.1.1.1g" xref="S4.SS2.10.10.10.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS2.10.10.10.1.m1.1.1.10" xref="S4.SS2.10.10.10.1.m1.1.1.10.cmml">e</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.10.10.10.1.m1.1b"><apply id="S4.SS2.10.10.10.1.m1.1.1.cmml" xref="S4.SS2.10.10.10.1.m1.1.1"><times id="S4.SS2.10.10.10.1.m1.1.1.1.cmml" xref="S4.SS2.10.10.10.1.m1.1.1.1"></times><ci id="S4.SS2.10.10.10.1.m1.1.1.2.cmml" xref="S4.SS2.10.10.10.1.m1.1.1.2">𝑠</ci><ci id="S4.SS2.10.10.10.1.m1.1.1.3.cmml" xref="S4.SS2.10.10.10.1.m1.1.1.3">𝑡</ci><ci id="S4.SS2.10.10.10.1.m1.1.1.4.cmml" xref="S4.SS2.10.10.10.1.m1.1.1.4">𝑒</ci><ci id="S4.SS2.10.10.10.1.m1.1.1.5.cmml" xref="S4.SS2.10.10.10.1.m1.1.1.5">𝑝</ci><ci id="S4.SS2.10.10.10.1.m1.1.1.6.cmml" xref="S4.SS2.10.10.10.1.m1.1.1.6">_</ci><ci id="S4.SS2.10.10.10.1.m1.1.1.7.cmml" xref="S4.SS2.10.10.10.1.m1.1.1.7">𝑟</ci><ci id="S4.SS2.10.10.10.1.m1.1.1.8.cmml" xref="S4.SS2.10.10.10.1.m1.1.1.8">𝑎</ci><ci id="S4.SS2.10.10.10.1.m1.1.1.9.cmml" xref="S4.SS2.10.10.10.1.m1.1.1.9">𝑡</ci><ci id="S4.SS2.10.10.10.1.m1.1.1.10.cmml" xref="S4.SS2.10.10.10.1.m1.1.1.10">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.10.10.10.1.m1.1c">step\_rate</annotation></semantics></math></th>
<td id="S4.SS2.10.10.10.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.SS2.10.10.10.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS2.10.10.10.2.1.1" class="ltx_p" style="width:159.3pt;">decrease in the learning rate</span>
</span>
</td>
</tr>
<tr id="S4.SS2.11.11.11" class="ltx_tr">
<th id="S4.SS2.11.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S4.SS2.11.11.11.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS2.11.11.11.1.m1.1a"><mi id="S4.SS2.11.11.11.1.m1.1.1" xref="S4.SS2.11.11.11.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.11.11.11.1.m1.1b"><ci id="S4.SS2.11.11.11.1.m1.1.1.cmml" xref="S4.SS2.11.11.11.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.11.11.11.1.m1.1c">c</annotation></semantics></math></th>
<td id="S4.SS2.11.11.11.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.SS2.11.11.11.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS2.11.11.11.2.1.1" class="ltx_p" style="width:159.3pt;">number of benign items to replace</span>
</span>
</td>
</tr>
<tr id="S4.SS2.12.12.12" class="ltx_tr">
<th id="S4.SS2.12.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S4.SS2.12.12.12.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS2.12.12.12.1.m1.1a"><mi id="S4.SS2.12.12.12.1.m1.1.1" xref="S4.SS2.12.12.12.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.12.12.12.1.m1.1b"><ci id="S4.SS2.12.12.12.1.m1.1.1.cmml" xref="S4.SS2.12.12.12.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.12.12.12.1.m1.1c">\gamma</annotation></semantics></math></th>
<td id="S4.SS2.12.12.12.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.SS2.12.12.12.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS2.12.12.12.2.1.1" class="ltx_p" style="width:159.3pt;">scaling factor</span>
</span>
</td>
</tr>
<tr id="S4.SS2.13.13.13" class="ltx_tr">
<th id="S4.SS2.13.13.13.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><math id="S4.SS2.13.13.13.1.m1.1" class="ltx_Math" alttext="E_{adv}" display="inline"><semantics id="S4.SS2.13.13.13.1.m1.1a"><msub id="S4.SS2.13.13.13.1.m1.1.1" xref="S4.SS2.13.13.13.1.m1.1.1.cmml"><mi id="S4.SS2.13.13.13.1.m1.1.1.2" xref="S4.SS2.13.13.13.1.m1.1.1.2.cmml">E</mi><mrow id="S4.SS2.13.13.13.1.m1.1.1.3" xref="S4.SS2.13.13.13.1.m1.1.1.3.cmml"><mi id="S4.SS2.13.13.13.1.m1.1.1.3.2" xref="S4.SS2.13.13.13.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.13.13.13.1.m1.1.1.3.1" xref="S4.SS2.13.13.13.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.13.13.13.1.m1.1.1.3.3" xref="S4.SS2.13.13.13.1.m1.1.1.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.13.13.13.1.m1.1.1.3.1a" xref="S4.SS2.13.13.13.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS2.13.13.13.1.m1.1.1.3.4" xref="S4.SS2.13.13.13.1.m1.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.13.13.13.1.m1.1b"><apply id="S4.SS2.13.13.13.1.m1.1.1.cmml" xref="S4.SS2.13.13.13.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.13.13.13.1.m1.1.1.1.cmml" xref="S4.SS2.13.13.13.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.13.13.13.1.m1.1.1.2.cmml" xref="S4.SS2.13.13.13.1.m1.1.1.2">𝐸</ci><apply id="S4.SS2.13.13.13.1.m1.1.1.3.cmml" xref="S4.SS2.13.13.13.1.m1.1.1.3"><times id="S4.SS2.13.13.13.1.m1.1.1.3.1.cmml" xref="S4.SS2.13.13.13.1.m1.1.1.3.1"></times><ci id="S4.SS2.13.13.13.1.m1.1.1.3.2.cmml" xref="S4.SS2.13.13.13.1.m1.1.1.3.2">𝑎</ci><ci id="S4.SS2.13.13.13.1.m1.1.1.3.3.cmml" xref="S4.SS2.13.13.13.1.m1.1.1.3.3">𝑑</ci><ci id="S4.SS2.13.13.13.1.m1.1.1.3.4.cmml" xref="S4.SS2.13.13.13.1.m1.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.13.13.13.1.m1.1c">E_{adv}</annotation></semantics></math></th>
<td id="S4.SS2.13.13.13.2" class="ltx_td ltx_align_justify ltx_align_top">
<span id="S4.SS2.13.13.13.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS2.13.13.13.2.1.1" class="ltx_p" style="width:159.3pt;">attacker’s local epochs</span>
</span>
</td>
</tr>
<tr id="S4.SS2.14.14.14" class="ltx_tr">
<th id="S4.SS2.14.14.14.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b"><math id="S4.SS2.14.14.14.1.m1.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS2.14.14.14.1.m1.1a"><mi id="S4.SS2.14.14.14.1.m1.1.1" xref="S4.SS2.14.14.14.1.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.14.14.14.1.m1.1b"><ci id="S4.SS2.14.14.14.1.m1.1.1.cmml" xref="S4.SS2.14.14.14.1.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.14.14.14.1.m1.1c">\epsilon</annotation></semantics></math></th>
<td id="S4.SS2.14.14.14.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_b">
<span id="S4.SS2.14.14.14.2.1" class="ltx_inline-block ltx_align_top">
<span id="S4.SS2.14.14.14.2.1.1" class="ltx_p" style="width:159.3pt;">max loss for the backdoor task</span>
</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.SS2.fig1" class="ltx_figure">
<figure id="alg2" class="ltx_float ltx_minipage ltx_align_middle ltx_framed ltx_framed_top" style="width:433.6pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> Attacker uses this method to create a model that does not
look anomalous and replaces the global model after averaging with
the other participants’ models.</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">  
</div>
<div id="alg2.l2" class="ltx_listingline">  <span id="alg2.l2.1" class="ltx_text ltx_font_bold">Constrain-and-scale</span>(<math id="alg2.l2.m1.2" class="ltx_Math" alttext="\mathcal{D}_{local},D_{backdoor}" display="inline"><semantics id="alg2.l2.m1.2a"><mrow id="alg2.l2.m1.2.2.2" xref="alg2.l2.m1.2.2.3.cmml"><msub id="alg2.l2.m1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l2.m1.1.1.1.1.2" xref="alg2.l2.m1.1.1.1.1.2.cmml">𝒟</mi><mrow id="alg2.l2.m1.1.1.1.1.3" xref="alg2.l2.m1.1.1.1.1.3.cmml"><mi id="alg2.l2.m1.1.1.1.1.3.2" xref="alg2.l2.m1.1.1.1.1.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.1.1.1.1.3.1" xref="alg2.l2.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l2.m1.1.1.1.1.3.3" xref="alg2.l2.m1.1.1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.1.1.1.1.3.1a" xref="alg2.l2.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l2.m1.1.1.1.1.3.4" xref="alg2.l2.m1.1.1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.1.1.1.1.3.1b" xref="alg2.l2.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l2.m1.1.1.1.1.3.5" xref="alg2.l2.m1.1.1.1.1.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.1.1.1.1.3.1c" xref="alg2.l2.m1.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l2.m1.1.1.1.1.3.6" xref="alg2.l2.m1.1.1.1.1.3.6.cmml">l</mi></mrow></msub><mo id="alg2.l2.m1.2.2.2.3" xref="alg2.l2.m1.2.2.3.cmml">,</mo><msub id="alg2.l2.m1.2.2.2.2" xref="alg2.l2.m1.2.2.2.2.cmml"><mi id="alg2.l2.m1.2.2.2.2.2" xref="alg2.l2.m1.2.2.2.2.2.cmml">D</mi><mrow id="alg2.l2.m1.2.2.2.2.3" xref="alg2.l2.m1.2.2.2.2.3.cmml"><mi id="alg2.l2.m1.2.2.2.2.3.2" xref="alg2.l2.m1.2.2.2.2.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.2.2.2.2.3.1" xref="alg2.l2.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l2.m1.2.2.2.2.3.3" xref="alg2.l2.m1.2.2.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.2.2.2.2.3.1a" xref="alg2.l2.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l2.m1.2.2.2.2.3.4" xref="alg2.l2.m1.2.2.2.2.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.2.2.2.2.3.1b" xref="alg2.l2.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l2.m1.2.2.2.2.3.5" xref="alg2.l2.m1.2.2.2.2.3.5.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.2.2.2.2.3.1c" xref="alg2.l2.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l2.m1.2.2.2.2.3.6" xref="alg2.l2.m1.2.2.2.2.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.2.2.2.2.3.1d" xref="alg2.l2.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l2.m1.2.2.2.2.3.7" xref="alg2.l2.m1.2.2.2.2.3.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.2.2.2.2.3.1e" xref="alg2.l2.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l2.m1.2.2.2.2.3.8" xref="alg2.l2.m1.2.2.2.2.3.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.2.2.2.2.3.1f" xref="alg2.l2.m1.2.2.2.2.3.1.cmml">​</mo><mi id="alg2.l2.m1.2.2.2.2.3.9" xref="alg2.l2.m1.2.2.2.2.3.9.cmml">r</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.2b"><list id="alg2.l2.m1.2.2.3.cmml" xref="alg2.l2.m1.2.2.2"><apply id="alg2.l2.m1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1">subscript</csymbol><ci id="alg2.l2.m1.1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1.1.1.2">𝒟</ci><apply id="alg2.l2.m1.1.1.1.1.3.cmml" xref="alg2.l2.m1.1.1.1.1.3"><times id="alg2.l2.m1.1.1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.1.1.3.1"></times><ci id="alg2.l2.m1.1.1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.1.1.3.2">𝑙</ci><ci id="alg2.l2.m1.1.1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.1.1.3.3">𝑜</ci><ci id="alg2.l2.m1.1.1.1.1.3.4.cmml" xref="alg2.l2.m1.1.1.1.1.3.4">𝑐</ci><ci id="alg2.l2.m1.1.1.1.1.3.5.cmml" xref="alg2.l2.m1.1.1.1.1.3.5">𝑎</ci><ci id="alg2.l2.m1.1.1.1.1.3.6.cmml" xref="alg2.l2.m1.1.1.1.1.3.6">𝑙</ci></apply></apply><apply id="alg2.l2.m1.2.2.2.2.cmml" xref="alg2.l2.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l2.m1.2.2.2.2.1.cmml" xref="alg2.l2.m1.2.2.2.2">subscript</csymbol><ci id="alg2.l2.m1.2.2.2.2.2.cmml" xref="alg2.l2.m1.2.2.2.2.2">𝐷</ci><apply id="alg2.l2.m1.2.2.2.2.3.cmml" xref="alg2.l2.m1.2.2.2.2.3"><times id="alg2.l2.m1.2.2.2.2.3.1.cmml" xref="alg2.l2.m1.2.2.2.2.3.1"></times><ci id="alg2.l2.m1.2.2.2.2.3.2.cmml" xref="alg2.l2.m1.2.2.2.2.3.2">𝑏</ci><ci id="alg2.l2.m1.2.2.2.2.3.3.cmml" xref="alg2.l2.m1.2.2.2.2.3.3">𝑎</ci><ci id="alg2.l2.m1.2.2.2.2.3.4.cmml" xref="alg2.l2.m1.2.2.2.2.3.4">𝑐</ci><ci id="alg2.l2.m1.2.2.2.2.3.5.cmml" xref="alg2.l2.m1.2.2.2.2.3.5">𝑘</ci><ci id="alg2.l2.m1.2.2.2.2.3.6.cmml" xref="alg2.l2.m1.2.2.2.2.3.6">𝑑</ci><ci id="alg2.l2.m1.2.2.2.2.3.7.cmml" xref="alg2.l2.m1.2.2.2.2.3.7">𝑜</ci><ci id="alg2.l2.m1.2.2.2.2.3.8.cmml" xref="alg2.l2.m1.2.2.2.2.3.8">𝑜</ci><ci id="alg2.l2.m1.2.2.2.2.3.9.cmml" xref="alg2.l2.m1.2.2.2.2.3.9">𝑟</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.2c">\mathcal{D}_{local},D_{backdoor}</annotation></semantics></math>)

</div>
<div id="alg2.l3" class="ltx_listingline">  <span id="alg2.l3.2" class="ltx_text ltx_font_italic">Initialize attacker’s model <math id="alg2.l3.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="alg2.l3.1.m1.1a"><mi id="alg2.l3.1.m1.1.1" xref="alg2.l3.1.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.1.m1.1b"><ci id="alg2.l3.1.m1.1.1.cmml" xref="alg2.l3.1.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.1.m1.1c">X</annotation></semantics></math> and loss function <math id="alg2.l3.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="alg2.l3.2.m2.1a"><mi id="alg2.l3.2.m2.1.1" xref="alg2.l3.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.2.m2.1b"><ci id="alg2.l3.2.m2.1.1.cmml" xref="alg2.l3.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.2.m2.1c">l</annotation></semantics></math></span>:

</div>
<div id="alg2.l4" class="ltx_listingline">      <math id="alg2.l4.m1.1" class="ltx_Math" alttext="X\leftarrow G^{t}" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">X</mi><mo stretchy="false" id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">←</mo><msup id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml"><mi id="alg2.l4.m1.1.1.3.2" xref="alg2.l4.m1.1.1.3.2.cmml">G</mi><mi id="alg2.l4.m1.1.1.3.3" xref="alg2.l4.m1.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><ci id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1">←</ci><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝑋</ci><apply id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.3">superscript</csymbol><ci id="alg2.l4.m1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.3.2">𝐺</ci><ci id="alg2.l4.m1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">X\leftarrow G^{t}</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">      <math id="alg2.l5.m1.1" class="ltx_Math" alttext="\ell\leftarrow\alpha\cdot\mathcal{L}_{class}+(1-\alpha)\cdot\mathcal{L}_{ano}" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mi mathvariant="normal" id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">ℓ</mi><mo stretchy="false" id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">←</mo><mrow id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml"><mrow id="alg2.l5.m1.1.1.1.3" xref="alg2.l5.m1.1.1.1.3.cmml"><mi id="alg2.l5.m1.1.1.1.3.2" xref="alg2.l5.m1.1.1.1.3.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l5.m1.1.1.1.3.1" xref="alg2.l5.m1.1.1.1.3.1.cmml">⋅</mo><msub id="alg2.l5.m1.1.1.1.3.3" xref="alg2.l5.m1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.1.1.1.3.3.2" xref="alg2.l5.m1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="alg2.l5.m1.1.1.1.3.3.3" xref="alg2.l5.m1.1.1.1.3.3.3.cmml"><mi id="alg2.l5.m1.1.1.1.3.3.3.2" xref="alg2.l5.m1.1.1.1.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.1.3.3.3.1" xref="alg2.l5.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="alg2.l5.m1.1.1.1.3.3.3.3" xref="alg2.l5.m1.1.1.1.3.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.1.3.3.3.1a" xref="alg2.l5.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="alg2.l5.m1.1.1.1.3.3.3.4" xref="alg2.l5.m1.1.1.1.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.1.3.3.3.1b" xref="alg2.l5.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="alg2.l5.m1.1.1.1.3.3.3.5" xref="alg2.l5.m1.1.1.1.3.3.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.1.3.3.3.1c" xref="alg2.l5.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="alg2.l5.m1.1.1.1.3.3.3.6" xref="alg2.l5.m1.1.1.1.3.3.3.6.cmml">s</mi></mrow></msub></mrow><mo id="alg2.l5.m1.1.1.1.2" xref="alg2.l5.m1.1.1.1.2.cmml">+</mo><mrow id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.cmml"><mrow id="alg2.l5.m1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l5.m1.1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l5.m1.1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml"><mn id="alg2.l5.m1.1.1.1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg2.l5.m1.1.1.1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg2.l5.m1.1.1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo rspace="0.055em" stretchy="false" id="alg2.l5.m1.1.1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="alg2.l5.m1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.2.cmml">⋅</mo><msub id="alg2.l5.m1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l5.m1.1.1.1.1.3.2" xref="alg2.l5.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="alg2.l5.m1.1.1.1.1.3.3" xref="alg2.l5.m1.1.1.1.1.3.3.cmml"><mi id="alg2.l5.m1.1.1.1.1.3.3.2" xref="alg2.l5.m1.1.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.1.1.3.3.1" xref="alg2.l5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="alg2.l5.m1.1.1.1.1.3.3.3" xref="alg2.l5.m1.1.1.1.1.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg2.l5.m1.1.1.1.1.3.3.1a" xref="alg2.l5.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="alg2.l5.m1.1.1.1.1.3.3.4" xref="alg2.l5.m1.1.1.1.1.3.3.4.cmml">o</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">←</ci><ci id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">ℓ</ci><apply id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"><plus id="alg2.l5.m1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.2"></plus><apply id="alg2.l5.m1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.3"><ci id="alg2.l5.m1.1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.1.3.1">⋅</ci><ci id="alg2.l5.m1.1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.1.3.2">𝛼</ci><apply id="alg2.l5.m1.1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.3.3.1.cmml" xref="alg2.l5.m1.1.1.1.3.3">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.3.3.2.cmml" xref="alg2.l5.m1.1.1.1.3.3.2">ℒ</ci><apply id="alg2.l5.m1.1.1.1.3.3.3.cmml" xref="alg2.l5.m1.1.1.1.3.3.3"><times id="alg2.l5.m1.1.1.1.3.3.3.1.cmml" xref="alg2.l5.m1.1.1.1.3.3.3.1"></times><ci id="alg2.l5.m1.1.1.1.3.3.3.2.cmml" xref="alg2.l5.m1.1.1.1.3.3.3.2">𝑐</ci><ci id="alg2.l5.m1.1.1.1.3.3.3.3.cmml" xref="alg2.l5.m1.1.1.1.3.3.3.3">𝑙</ci><ci id="alg2.l5.m1.1.1.1.3.3.3.4.cmml" xref="alg2.l5.m1.1.1.1.3.3.3.4">𝑎</ci><ci id="alg2.l5.m1.1.1.1.3.3.3.5.cmml" xref="alg2.l5.m1.1.1.1.3.3.3.5">𝑠</ci><ci id="alg2.l5.m1.1.1.1.3.3.3.6.cmml" xref="alg2.l5.m1.1.1.1.3.3.3.6">𝑠</ci></apply></apply></apply><apply id="alg2.l5.m1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1"><ci id="alg2.l5.m1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.2">⋅</ci><apply id="alg2.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1"><minus id="alg2.l5.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg2.l5.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.2">1</cn><ci id="alg2.l5.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="alg2.l5.m1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.1.1.3.2">ℒ</ci><apply id="alg2.l5.m1.1.1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.1.1.3.3"><times id="alg2.l5.m1.1.1.1.1.3.3.1.cmml" xref="alg2.l5.m1.1.1.1.1.3.3.1"></times><ci id="alg2.l5.m1.1.1.1.1.3.3.2.cmml" xref="alg2.l5.m1.1.1.1.1.3.3.2">𝑎</ci><ci id="alg2.l5.m1.1.1.1.1.3.3.3.cmml" xref="alg2.l5.m1.1.1.1.1.3.3.3">𝑛</ci><ci id="alg2.l5.m1.1.1.1.1.3.3.4.cmml" xref="alg2.l5.m1.1.1.1.1.3.3.4">𝑜</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">\ell\leftarrow\alpha\cdot\mathcal{L}_{class}+(1-\alpha)\cdot\mathcal{L}_{ano}</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">  <span id="alg2.l6.1" class="ltx_text ltx_font_bold">for</span> epoch <math id="alg2.l6.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg2.l6.m1.1a"><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">e</annotation></semantics></math> <math id="alg2.l6.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg2.l6.m2.1a"><mo id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><in id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">\in</annotation></semantics></math> <math id="alg2.l6.m3.1" class="ltx_Math" alttext="E_{adv}" display="inline"><semantics id="alg2.l6.m3.1a"><msub id="alg2.l6.m3.1.1" xref="alg2.l6.m3.1.1.cmml"><mi id="alg2.l6.m3.1.1.2" xref="alg2.l6.m3.1.1.2.cmml">E</mi><mrow id="alg2.l6.m3.1.1.3" xref="alg2.l6.m3.1.1.3.cmml"><mi id="alg2.l6.m3.1.1.3.2" xref="alg2.l6.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m3.1.1.3.1" xref="alg2.l6.m3.1.1.3.1.cmml">​</mo><mi id="alg2.l6.m3.1.1.3.3" xref="alg2.l6.m3.1.1.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m3.1.1.3.1a" xref="alg2.l6.m3.1.1.3.1.cmml">​</mo><mi id="alg2.l6.m3.1.1.3.4" xref="alg2.l6.m3.1.1.3.4.cmml">v</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l6.m3.1b"><apply id="alg2.l6.m3.1.1.cmml" xref="alg2.l6.m3.1.1"><csymbol cd="ambiguous" id="alg2.l6.m3.1.1.1.cmml" xref="alg2.l6.m3.1.1">subscript</csymbol><ci id="alg2.l6.m3.1.1.2.cmml" xref="alg2.l6.m3.1.1.2">𝐸</ci><apply id="alg2.l6.m3.1.1.3.cmml" xref="alg2.l6.m3.1.1.3"><times id="alg2.l6.m3.1.1.3.1.cmml" xref="alg2.l6.m3.1.1.3.1"></times><ci id="alg2.l6.m3.1.1.3.2.cmml" xref="alg2.l6.m3.1.1.3.2">𝑎</ci><ci id="alg2.l6.m3.1.1.3.3.cmml" xref="alg2.l6.m3.1.1.3.3">𝑑</ci><ci id="alg2.l6.m3.1.1.3.4.cmml" xref="alg2.l6.m3.1.1.3.4">𝑣</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m3.1c">E_{adv}</annotation></semantics></math> <span id="alg2.l6.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l7" class="ltx_listingline">     <span id="alg2.l7.1" class="ltx_text ltx_font_bold">if</span>  <math id="alg2.l7.m1.2" class="ltx_Math" alttext="\mathcal{L}_{class}(X,D_{backdoor})&lt;\epsilon" display="inline"><semantics id="alg2.l7.m1.2a"><mrow id="alg2.l7.m1.2.2" xref="alg2.l7.m1.2.2.cmml"><mrow id="alg2.l7.m1.2.2.1" xref="alg2.l7.m1.2.2.1.cmml"><msub id="alg2.l7.m1.2.2.1.3" xref="alg2.l7.m1.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l7.m1.2.2.1.3.2" xref="alg2.l7.m1.2.2.1.3.2.cmml">ℒ</mi><mrow id="alg2.l7.m1.2.2.1.3.3" xref="alg2.l7.m1.2.2.1.3.3.cmml"><mi id="alg2.l7.m1.2.2.1.3.3.2" xref="alg2.l7.m1.2.2.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.3.3.1" xref="alg2.l7.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.3.3.3" xref="alg2.l7.m1.2.2.1.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.3.3.1a" xref="alg2.l7.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.3.3.4" xref="alg2.l7.m1.2.2.1.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.3.3.1b" xref="alg2.l7.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.3.3.5" xref="alg2.l7.m1.2.2.1.3.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.3.3.1c" xref="alg2.l7.m1.2.2.1.3.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.3.3.6" xref="alg2.l7.m1.2.2.1.3.3.6.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.2" xref="alg2.l7.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l7.m1.2.2.1.1.1" xref="alg2.l7.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l7.m1.2.2.1.1.1.2" xref="alg2.l7.m1.2.2.1.1.2.cmml">(</mo><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">X</mi><mo id="alg2.l7.m1.2.2.1.1.1.3" xref="alg2.l7.m1.2.2.1.1.2.cmml">,</mo><msub id="alg2.l7.m1.2.2.1.1.1.1" xref="alg2.l7.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l7.m1.2.2.1.1.1.1.2" xref="alg2.l7.m1.2.2.1.1.1.1.2.cmml">D</mi><mrow id="alg2.l7.m1.2.2.1.1.1.1.3" xref="alg2.l7.m1.2.2.1.1.1.1.3.cmml"><mi id="alg2.l7.m1.2.2.1.1.1.1.3.2" xref="alg2.l7.m1.2.2.1.1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.1.1.1.3.1" xref="alg2.l7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.1.1.1.3.3" xref="alg2.l7.m1.2.2.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.1.1.1.3.1a" xref="alg2.l7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.1.1.1.3.4" xref="alg2.l7.m1.2.2.1.1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.1.1.1.3.1b" xref="alg2.l7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.1.1.1.3.5" xref="alg2.l7.m1.2.2.1.1.1.1.3.5.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.1.1.1.3.1c" xref="alg2.l7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.1.1.1.3.6" xref="alg2.l7.m1.2.2.1.1.1.1.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.1.1.1.3.1d" xref="alg2.l7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.1.1.1.3.7" xref="alg2.l7.m1.2.2.1.1.1.1.3.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.1.1.1.3.1e" xref="alg2.l7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.1.1.1.3.8" xref="alg2.l7.m1.2.2.1.1.1.1.3.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.1.1.1.1.3.1f" xref="alg2.l7.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l7.m1.2.2.1.1.1.1.3.9" xref="alg2.l7.m1.2.2.1.1.1.1.3.9.cmml">r</mi></mrow></msub><mo stretchy="false" id="alg2.l7.m1.2.2.1.1.1.4" xref="alg2.l7.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg2.l7.m1.2.2.2" xref="alg2.l7.m1.2.2.2.cmml">&lt;</mo><mi id="alg2.l7.m1.2.2.3" xref="alg2.l7.m1.2.2.3.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.2b"><apply id="alg2.l7.m1.2.2.cmml" xref="alg2.l7.m1.2.2"><lt id="alg2.l7.m1.2.2.2.cmml" xref="alg2.l7.m1.2.2.2"></lt><apply id="alg2.l7.m1.2.2.1.cmml" xref="alg2.l7.m1.2.2.1"><times id="alg2.l7.m1.2.2.1.2.cmml" xref="alg2.l7.m1.2.2.1.2"></times><apply id="alg2.l7.m1.2.2.1.3.cmml" xref="alg2.l7.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.2.2.1.3.1.cmml" xref="alg2.l7.m1.2.2.1.3">subscript</csymbol><ci id="alg2.l7.m1.2.2.1.3.2.cmml" xref="alg2.l7.m1.2.2.1.3.2">ℒ</ci><apply id="alg2.l7.m1.2.2.1.3.3.cmml" xref="alg2.l7.m1.2.2.1.3.3"><times id="alg2.l7.m1.2.2.1.3.3.1.cmml" xref="alg2.l7.m1.2.2.1.3.3.1"></times><ci id="alg2.l7.m1.2.2.1.3.3.2.cmml" xref="alg2.l7.m1.2.2.1.3.3.2">𝑐</ci><ci id="alg2.l7.m1.2.2.1.3.3.3.cmml" xref="alg2.l7.m1.2.2.1.3.3.3">𝑙</ci><ci id="alg2.l7.m1.2.2.1.3.3.4.cmml" xref="alg2.l7.m1.2.2.1.3.3.4">𝑎</ci><ci id="alg2.l7.m1.2.2.1.3.3.5.cmml" xref="alg2.l7.m1.2.2.1.3.3.5">𝑠</ci><ci id="alg2.l7.m1.2.2.1.3.3.6.cmml" xref="alg2.l7.m1.2.2.1.3.3.6">𝑠</ci></apply></apply><interval closure="open" id="alg2.l7.m1.2.2.1.1.2.cmml" xref="alg2.l7.m1.2.2.1.1.1"><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑋</ci><apply id="alg2.l7.m1.2.2.1.1.1.1.cmml" xref="alg2.l7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l7.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.2">𝐷</ci><apply id="alg2.l7.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3"><times id="alg2.l7.m1.2.2.1.1.1.1.3.1.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3.1"></times><ci id="alg2.l7.m1.2.2.1.1.1.1.3.2.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3.2">𝑏</ci><ci id="alg2.l7.m1.2.2.1.1.1.1.3.3.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3.3">𝑎</ci><ci id="alg2.l7.m1.2.2.1.1.1.1.3.4.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3.4">𝑐</ci><ci id="alg2.l7.m1.2.2.1.1.1.1.3.5.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3.5">𝑘</ci><ci id="alg2.l7.m1.2.2.1.1.1.1.3.6.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3.6">𝑑</ci><ci id="alg2.l7.m1.2.2.1.1.1.1.3.7.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3.7">𝑜</ci><ci id="alg2.l7.m1.2.2.1.1.1.1.3.8.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3.8">𝑜</ci><ci id="alg2.l7.m1.2.2.1.1.1.1.3.9.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3.9">𝑟</ci></apply></apply></interval></apply><ci id="alg2.l7.m1.2.2.3.cmml" xref="alg2.l7.m1.2.2.3">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.2c">\mathcal{L}_{class}(X,D_{backdoor})&lt;\epsilon</annotation></semantics></math>  <span id="alg2.l7.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg2.l8" class="ltx_listingline">        <span id="alg2.l8.1" class="ltx_text ltx_font_italic">// Early stop, if model converges</span>

</div>
<div id="alg2.l9" class="ltx_listingline">        <span id="alg2.l9.1" class="ltx_text ltx_font_italic">break</span>

</div>
<div id="alg2.l10" class="ltx_listingline">     <span id="alg2.l10.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l10.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l11" class="ltx_listingline">     <span id="alg2.l11.1" class="ltx_text ltx_font_bold">for</span> batch <math id="alg2.l11.m1.1" class="ltx_Math" alttext="b" display="inline"><semantics id="alg2.l11.m1.1a"><mi id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><ci id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">b</annotation></semantics></math> <math id="alg2.l11.m2.1" class="ltx_Math" alttext="\in\mathcal{D}_{local}" display="inline"><semantics id="alg2.l11.m2.1a"><mrow id="alg2.l11.m2.1.1" xref="alg2.l11.m2.1.1.cmml"><mi id="alg2.l11.m2.1.1.2" xref="alg2.l11.m2.1.1.2.cmml"></mi><mo id="alg2.l11.m2.1.1.1" xref="alg2.l11.m2.1.1.1.cmml">∈</mo><msub id="alg2.l11.m2.1.1.3" xref="alg2.l11.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l11.m2.1.1.3.2" xref="alg2.l11.m2.1.1.3.2.cmml">𝒟</mi><mrow id="alg2.l11.m2.1.1.3.3" xref="alg2.l11.m2.1.1.3.3.cmml"><mi id="alg2.l11.m2.1.1.3.3.2" xref="alg2.l11.m2.1.1.3.3.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m2.1.1.3.3.1" xref="alg2.l11.m2.1.1.3.3.1.cmml">​</mo><mi id="alg2.l11.m2.1.1.3.3.3" xref="alg2.l11.m2.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m2.1.1.3.3.1a" xref="alg2.l11.m2.1.1.3.3.1.cmml">​</mo><mi id="alg2.l11.m2.1.1.3.3.4" xref="alg2.l11.m2.1.1.3.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m2.1.1.3.3.1b" xref="alg2.l11.m2.1.1.3.3.1.cmml">​</mo><mi id="alg2.l11.m2.1.1.3.3.5" xref="alg2.l11.m2.1.1.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m2.1.1.3.3.1c" xref="alg2.l11.m2.1.1.3.3.1.cmml">​</mo><mi id="alg2.l11.m2.1.1.3.3.6" xref="alg2.l11.m2.1.1.3.3.6.cmml">l</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m2.1b"><apply id="alg2.l11.m2.1.1.cmml" xref="alg2.l11.m2.1.1"><in id="alg2.l11.m2.1.1.1.cmml" xref="alg2.l11.m2.1.1.1"></in><csymbol cd="latexml" id="alg2.l11.m2.1.1.2.cmml" xref="alg2.l11.m2.1.1.2">absent</csymbol><apply id="alg2.l11.m2.1.1.3.cmml" xref="alg2.l11.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.l11.m2.1.1.3.1.cmml" xref="alg2.l11.m2.1.1.3">subscript</csymbol><ci id="alg2.l11.m2.1.1.3.2.cmml" xref="alg2.l11.m2.1.1.3.2">𝒟</ci><apply id="alg2.l11.m2.1.1.3.3.cmml" xref="alg2.l11.m2.1.1.3.3"><times id="alg2.l11.m2.1.1.3.3.1.cmml" xref="alg2.l11.m2.1.1.3.3.1"></times><ci id="alg2.l11.m2.1.1.3.3.2.cmml" xref="alg2.l11.m2.1.1.3.3.2">𝑙</ci><ci id="alg2.l11.m2.1.1.3.3.3.cmml" xref="alg2.l11.m2.1.1.3.3.3">𝑜</ci><ci id="alg2.l11.m2.1.1.3.3.4.cmml" xref="alg2.l11.m2.1.1.3.3.4">𝑐</ci><ci id="alg2.l11.m2.1.1.3.3.5.cmml" xref="alg2.l11.m2.1.1.3.3.5">𝑎</ci><ci id="alg2.l11.m2.1.1.3.3.6.cmml" xref="alg2.l11.m2.1.1.3.3.6">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m2.1c">\in\mathcal{D}_{local}</annotation></semantics></math> <span id="alg2.l11.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l12" class="ltx_listingline">        <math id="alg2.l12.m1.3" class="ltx_Math" alttext="b\leftarrow\texttt{replace}(c,b,D_{backdoor})" display="inline"><semantics id="alg2.l12.m1.3a"><mrow id="alg2.l12.m1.3.3" xref="alg2.l12.m1.3.3.cmml"><mi id="alg2.l12.m1.3.3.3" xref="alg2.l12.m1.3.3.3.cmml">b</mi><mo stretchy="false" id="alg2.l12.m1.3.3.2" xref="alg2.l12.m1.3.3.2.cmml">←</mo><mrow id="alg2.l12.m1.3.3.1" xref="alg2.l12.m1.3.3.1.cmml"><mtext class="ltx_mathvariant_monospace" id="alg2.l12.m1.3.3.1.3" xref="alg2.l12.m1.3.3.1.3a.cmml">replace</mtext><mo lspace="0em" rspace="0em" id="alg2.l12.m1.3.3.1.2" xref="alg2.l12.m1.3.3.1.2.cmml">​</mo><mrow id="alg2.l12.m1.3.3.1.1.1" xref="alg2.l12.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="alg2.l12.m1.3.3.1.1.1.2" xref="alg2.l12.m1.3.3.1.1.2.cmml">(</mo><mi id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml">c</mi><mo id="alg2.l12.m1.3.3.1.1.1.3" xref="alg2.l12.m1.3.3.1.1.2.cmml">,</mo><mi id="alg2.l12.m1.2.2" xref="alg2.l12.m1.2.2.cmml">b</mi><mo id="alg2.l12.m1.3.3.1.1.1.4" xref="alg2.l12.m1.3.3.1.1.2.cmml">,</mo><msub id="alg2.l12.m1.3.3.1.1.1.1" xref="alg2.l12.m1.3.3.1.1.1.1.cmml"><mi id="alg2.l12.m1.3.3.1.1.1.1.2" xref="alg2.l12.m1.3.3.1.1.1.1.2.cmml">D</mi><mrow id="alg2.l12.m1.3.3.1.1.1.1.3" xref="alg2.l12.m1.3.3.1.1.1.1.3.cmml"><mi id="alg2.l12.m1.3.3.1.1.1.1.3.2" xref="alg2.l12.m1.3.3.1.1.1.1.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.3.3.1.1.1.1.3.1" xref="alg2.l12.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l12.m1.3.3.1.1.1.1.3.3" xref="alg2.l12.m1.3.3.1.1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.3.3.1.1.1.1.3.1a" xref="alg2.l12.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l12.m1.3.3.1.1.1.1.3.4" xref="alg2.l12.m1.3.3.1.1.1.1.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.3.3.1.1.1.1.3.1b" xref="alg2.l12.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l12.m1.3.3.1.1.1.1.3.5" xref="alg2.l12.m1.3.3.1.1.1.1.3.5.cmml">k</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.3.3.1.1.1.1.3.1c" xref="alg2.l12.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l12.m1.3.3.1.1.1.1.3.6" xref="alg2.l12.m1.3.3.1.1.1.1.3.6.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.3.3.1.1.1.1.3.1d" xref="alg2.l12.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l12.m1.3.3.1.1.1.1.3.7" xref="alg2.l12.m1.3.3.1.1.1.1.3.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.3.3.1.1.1.1.3.1e" xref="alg2.l12.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l12.m1.3.3.1.1.1.1.3.8" xref="alg2.l12.m1.3.3.1.1.1.1.3.8.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l12.m1.3.3.1.1.1.1.3.1f" xref="alg2.l12.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mi id="alg2.l12.m1.3.3.1.1.1.1.3.9" xref="alg2.l12.m1.3.3.1.1.1.1.3.9.cmml">r</mi></mrow></msub><mo stretchy="false" id="alg2.l12.m1.3.3.1.1.1.5" xref="alg2.l12.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.3b"><apply id="alg2.l12.m1.3.3.cmml" xref="alg2.l12.m1.3.3"><ci id="alg2.l12.m1.3.3.2.cmml" xref="alg2.l12.m1.3.3.2">←</ci><ci id="alg2.l12.m1.3.3.3.cmml" xref="alg2.l12.m1.3.3.3">𝑏</ci><apply id="alg2.l12.m1.3.3.1.cmml" xref="alg2.l12.m1.3.3.1"><times id="alg2.l12.m1.3.3.1.2.cmml" xref="alg2.l12.m1.3.3.1.2"></times><ci id="alg2.l12.m1.3.3.1.3a.cmml" xref="alg2.l12.m1.3.3.1.3"><mtext class="ltx_mathvariant_monospace" id="alg2.l12.m1.3.3.1.3.cmml" xref="alg2.l12.m1.3.3.1.3">replace</mtext></ci><vector id="alg2.l12.m1.3.3.1.1.2.cmml" xref="alg2.l12.m1.3.3.1.1.1"><ci id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1">𝑐</ci><ci id="alg2.l12.m1.2.2.cmml" xref="alg2.l12.m1.2.2">𝑏</ci><apply id="alg2.l12.m1.3.3.1.1.1.1.cmml" xref="alg2.l12.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l12.m1.3.3.1.1.1.1">subscript</csymbol><ci id="alg2.l12.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.2">𝐷</ci><apply id="alg2.l12.m1.3.3.1.1.1.1.3.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3"><times id="alg2.l12.m1.3.3.1.1.1.1.3.1.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3.1"></times><ci id="alg2.l12.m1.3.3.1.1.1.1.3.2.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3.2">𝑏</ci><ci id="alg2.l12.m1.3.3.1.1.1.1.3.3.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3.3">𝑎</ci><ci id="alg2.l12.m1.3.3.1.1.1.1.3.4.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3.4">𝑐</ci><ci id="alg2.l12.m1.3.3.1.1.1.1.3.5.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3.5">𝑘</ci><ci id="alg2.l12.m1.3.3.1.1.1.1.3.6.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3.6">𝑑</ci><ci id="alg2.l12.m1.3.3.1.1.1.1.3.7.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3.7">𝑜</ci><ci id="alg2.l12.m1.3.3.1.1.1.1.3.8.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3.8">𝑜</ci><ci id="alg2.l12.m1.3.3.1.1.1.1.3.9.cmml" xref="alg2.l12.m1.3.3.1.1.1.1.3.9">𝑟</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.3c">b\leftarrow\texttt{replace}(c,b,D_{backdoor})</annotation></semantics></math>

</div>
<div id="alg2.l13" class="ltx_listingline">        <math id="alg2.l13.m1.2" class="ltx_Math" alttext="X\leftarrow X-lr_{adv}\cdot\nabla\ell(X,b)" display="inline"><semantics id="alg2.l13.m1.2a"><mrow id="alg2.l13.m1.2.3" xref="alg2.l13.m1.2.3.cmml"><mi id="alg2.l13.m1.2.3.2" xref="alg2.l13.m1.2.3.2.cmml">X</mi><mo stretchy="false" id="alg2.l13.m1.2.3.1" xref="alg2.l13.m1.2.3.1.cmml">←</mo><mrow id="alg2.l13.m1.2.3.3" xref="alg2.l13.m1.2.3.3.cmml"><mi id="alg2.l13.m1.2.3.3.2" xref="alg2.l13.m1.2.3.3.2.cmml">X</mi><mo id="alg2.l13.m1.2.3.3.1" xref="alg2.l13.m1.2.3.3.1.cmml">−</mo><mrow id="alg2.l13.m1.2.3.3.3" xref="alg2.l13.m1.2.3.3.3.cmml"><mrow id="alg2.l13.m1.2.3.3.3.2" xref="alg2.l13.m1.2.3.3.3.2.cmml"><mrow id="alg2.l13.m1.2.3.3.3.2.2" xref="alg2.l13.m1.2.3.3.3.2.2.cmml"><mi id="alg2.l13.m1.2.3.3.3.2.2.2" xref="alg2.l13.m1.2.3.3.3.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l13.m1.2.3.3.3.2.2.1" xref="alg2.l13.m1.2.3.3.3.2.2.1.cmml">​</mo><msub id="alg2.l13.m1.2.3.3.3.2.2.3" xref="alg2.l13.m1.2.3.3.3.2.2.3.cmml"><mi id="alg2.l13.m1.2.3.3.3.2.2.3.2" xref="alg2.l13.m1.2.3.3.3.2.2.3.2.cmml">r</mi><mrow id="alg2.l13.m1.2.3.3.3.2.2.3.3" xref="alg2.l13.m1.2.3.3.3.2.2.3.3.cmml"><mi id="alg2.l13.m1.2.3.3.3.2.2.3.3.2" xref="alg2.l13.m1.2.3.3.3.2.2.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l13.m1.2.3.3.3.2.2.3.3.1" xref="alg2.l13.m1.2.3.3.3.2.2.3.3.1.cmml">​</mo><mi id="alg2.l13.m1.2.3.3.3.2.2.3.3.3" xref="alg2.l13.m1.2.3.3.3.2.2.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l13.m1.2.3.3.3.2.2.3.3.1a" xref="alg2.l13.m1.2.3.3.3.2.2.3.3.1.cmml">​</mo><mi id="alg2.l13.m1.2.3.3.3.2.2.3.3.4" xref="alg2.l13.m1.2.3.3.3.2.2.3.3.4.cmml">v</mi></mrow></msub></mrow><mo lspace="0.222em" rspace="0.222em" id="alg2.l13.m1.2.3.3.3.2.1" xref="alg2.l13.m1.2.3.3.3.2.1.cmml">⋅</mo><mrow id="alg2.l13.m1.2.3.3.3.2.3" xref="alg2.l13.m1.2.3.3.3.2.3.cmml"><mo rspace="0.167em" id="alg2.l13.m1.2.3.3.3.2.3.1" xref="alg2.l13.m1.2.3.3.3.2.3.1.cmml">∇</mo><mi mathvariant="normal" id="alg2.l13.m1.2.3.3.3.2.3.2" xref="alg2.l13.m1.2.3.3.3.2.3.2.cmml">ℓ</mi></mrow></mrow><mo lspace="0em" rspace="0em" id="alg2.l13.m1.2.3.3.3.1" xref="alg2.l13.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg2.l13.m1.2.3.3.3.3.2" xref="alg2.l13.m1.2.3.3.3.3.1.cmml"><mo stretchy="false" id="alg2.l13.m1.2.3.3.3.3.2.1" xref="alg2.l13.m1.2.3.3.3.3.1.cmml">(</mo><mi id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml">X</mi><mo id="alg2.l13.m1.2.3.3.3.3.2.2" xref="alg2.l13.m1.2.3.3.3.3.1.cmml">,</mo><mi id="alg2.l13.m1.2.2" xref="alg2.l13.m1.2.2.cmml">b</mi><mo stretchy="false" id="alg2.l13.m1.2.3.3.3.3.2.3" xref="alg2.l13.m1.2.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.2b"><apply id="alg2.l13.m1.2.3.cmml" xref="alg2.l13.m1.2.3"><ci id="alg2.l13.m1.2.3.1.cmml" xref="alg2.l13.m1.2.3.1">←</ci><ci id="alg2.l13.m1.2.3.2.cmml" xref="alg2.l13.m1.2.3.2">𝑋</ci><apply id="alg2.l13.m1.2.3.3.cmml" xref="alg2.l13.m1.2.3.3"><minus id="alg2.l13.m1.2.3.3.1.cmml" xref="alg2.l13.m1.2.3.3.1"></minus><ci id="alg2.l13.m1.2.3.3.2.cmml" xref="alg2.l13.m1.2.3.3.2">𝑋</ci><apply id="alg2.l13.m1.2.3.3.3.cmml" xref="alg2.l13.m1.2.3.3.3"><times id="alg2.l13.m1.2.3.3.3.1.cmml" xref="alg2.l13.m1.2.3.3.3.1"></times><apply id="alg2.l13.m1.2.3.3.3.2.cmml" xref="alg2.l13.m1.2.3.3.3.2"><ci id="alg2.l13.m1.2.3.3.3.2.1.cmml" xref="alg2.l13.m1.2.3.3.3.2.1">⋅</ci><apply id="alg2.l13.m1.2.3.3.3.2.2.cmml" xref="alg2.l13.m1.2.3.3.3.2.2"><times id="alg2.l13.m1.2.3.3.3.2.2.1.cmml" xref="alg2.l13.m1.2.3.3.3.2.2.1"></times><ci id="alg2.l13.m1.2.3.3.3.2.2.2.cmml" xref="alg2.l13.m1.2.3.3.3.2.2.2">𝑙</ci><apply id="alg2.l13.m1.2.3.3.3.2.2.3.cmml" xref="alg2.l13.m1.2.3.3.3.2.2.3"><csymbol cd="ambiguous" id="alg2.l13.m1.2.3.3.3.2.2.3.1.cmml" xref="alg2.l13.m1.2.3.3.3.2.2.3">subscript</csymbol><ci id="alg2.l13.m1.2.3.3.3.2.2.3.2.cmml" xref="alg2.l13.m1.2.3.3.3.2.2.3.2">𝑟</ci><apply id="alg2.l13.m1.2.3.3.3.2.2.3.3.cmml" xref="alg2.l13.m1.2.3.3.3.2.2.3.3"><times id="alg2.l13.m1.2.3.3.3.2.2.3.3.1.cmml" xref="alg2.l13.m1.2.3.3.3.2.2.3.3.1"></times><ci id="alg2.l13.m1.2.3.3.3.2.2.3.3.2.cmml" xref="alg2.l13.m1.2.3.3.3.2.2.3.3.2">𝑎</ci><ci id="alg2.l13.m1.2.3.3.3.2.2.3.3.3.cmml" xref="alg2.l13.m1.2.3.3.3.2.2.3.3.3">𝑑</ci><ci id="alg2.l13.m1.2.3.3.3.2.2.3.3.4.cmml" xref="alg2.l13.m1.2.3.3.3.2.2.3.3.4">𝑣</ci></apply></apply></apply><apply id="alg2.l13.m1.2.3.3.3.2.3.cmml" xref="alg2.l13.m1.2.3.3.3.2.3"><ci id="alg2.l13.m1.2.3.3.3.2.3.1.cmml" xref="alg2.l13.m1.2.3.3.3.2.3.1">∇</ci><ci id="alg2.l13.m1.2.3.3.3.2.3.2.cmml" xref="alg2.l13.m1.2.3.3.3.2.3.2">ℓ</ci></apply></apply><interval closure="open" id="alg2.l13.m1.2.3.3.3.3.1.cmml" xref="alg2.l13.m1.2.3.3.3.3.2"><ci id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">𝑋</ci><ci id="alg2.l13.m1.2.2.cmml" xref="alg2.l13.m1.2.2">𝑏</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.2c">X\leftarrow X-lr_{adv}\cdot\nabla\ell(X,b)</annotation></semantics></math>

</div>
<div id="alg2.l14" class="ltx_listingline">     <span id="alg2.l14.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l14.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l15" class="ltx_listingline">     <span id="alg2.l15.1" class="ltx_text ltx_font_bold">if</span> epoch <math id="alg2.l15.m1.1" class="ltx_Math" alttext="e\in step\_sched" display="inline"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">e</mi><mo id="alg2.l15.m1.1.1.1" xref="alg2.l15.m1.1.1.1.cmml">∈</mo><mrow id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml"><mi id="alg2.l15.m1.1.1.3.2" xref="alg2.l15.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.3" xref="alg2.l15.m1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1a" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.4" xref="alg2.l15.m1.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1b" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.5" xref="alg2.l15.m1.1.1.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1c" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l15.m1.1.1.3.6" xref="alg2.l15.m1.1.1.3.6.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1d" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.7" xref="alg2.l15.m1.1.1.3.7.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1e" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.8" xref="alg2.l15.m1.1.1.3.8.cmml">c</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1f" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.9" xref="alg2.l15.m1.1.1.3.9.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1g" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.10" xref="alg2.l15.m1.1.1.3.10.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.3.1h" xref="alg2.l15.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l15.m1.1.1.3.11" xref="alg2.l15.m1.1.1.3.11.cmml">d</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><in id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1"></in><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝑒</ci><apply id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3"><times id="alg2.l15.m1.1.1.3.1.cmml" xref="alg2.l15.m1.1.1.3.1"></times><ci id="alg2.l15.m1.1.1.3.2.cmml" xref="alg2.l15.m1.1.1.3.2">𝑠</ci><ci id="alg2.l15.m1.1.1.3.3.cmml" xref="alg2.l15.m1.1.1.3.3">𝑡</ci><ci id="alg2.l15.m1.1.1.3.4.cmml" xref="alg2.l15.m1.1.1.3.4">𝑒</ci><ci id="alg2.l15.m1.1.1.3.5.cmml" xref="alg2.l15.m1.1.1.3.5">𝑝</ci><ci id="alg2.l15.m1.1.1.3.6.cmml" xref="alg2.l15.m1.1.1.3.6">_</ci><ci id="alg2.l15.m1.1.1.3.7.cmml" xref="alg2.l15.m1.1.1.3.7">𝑠</ci><ci id="alg2.l15.m1.1.1.3.8.cmml" xref="alg2.l15.m1.1.1.3.8">𝑐</ci><ci id="alg2.l15.m1.1.1.3.9.cmml" xref="alg2.l15.m1.1.1.3.9">ℎ</ci><ci id="alg2.l15.m1.1.1.3.10.cmml" xref="alg2.l15.m1.1.1.3.10">𝑒</ci><ci id="alg2.l15.m1.1.1.3.11.cmml" xref="alg2.l15.m1.1.1.3.11">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">e\in step\_sched</annotation></semantics></math> <span id="alg2.l15.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg2.l16" class="ltx_listingline">        <math id="alg2.l16.m1.1" class="ltx_Math" alttext="lr_{adv}\leftarrow lr_{adv}/step\_rate" display="inline"><semantics id="alg2.l16.m1.1a"><mrow id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><mrow id="alg2.l16.m1.1.1.2" xref="alg2.l16.m1.1.1.2.cmml"><mi id="alg2.l16.m1.1.1.2.2" xref="alg2.l16.m1.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.2.1" xref="alg2.l16.m1.1.1.2.1.cmml">​</mo><msub id="alg2.l16.m1.1.1.2.3" xref="alg2.l16.m1.1.1.2.3.cmml"><mi id="alg2.l16.m1.1.1.2.3.2" xref="alg2.l16.m1.1.1.2.3.2.cmml">r</mi><mrow id="alg2.l16.m1.1.1.2.3.3" xref="alg2.l16.m1.1.1.2.3.3.cmml"><mi id="alg2.l16.m1.1.1.2.3.3.2" xref="alg2.l16.m1.1.1.2.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.2.3.3.1" xref="alg2.l16.m1.1.1.2.3.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.2.3.3.3" xref="alg2.l16.m1.1.1.2.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.2.3.3.1a" xref="alg2.l16.m1.1.1.2.3.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.2.3.3.4" xref="alg2.l16.m1.1.1.2.3.3.4.cmml">v</mi></mrow></msub></mrow><mo stretchy="false" id="alg2.l16.m1.1.1.1" xref="alg2.l16.m1.1.1.1.cmml">←</mo><mrow id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml"><mrow id="alg2.l16.m1.1.1.3.2" xref="alg2.l16.m1.1.1.3.2.cmml"><mrow id="alg2.l16.m1.1.1.3.2.2" xref="alg2.l16.m1.1.1.3.2.2.cmml"><mi id="alg2.l16.m1.1.1.3.2.2.2" xref="alg2.l16.m1.1.1.3.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.2.2.1" xref="alg2.l16.m1.1.1.3.2.2.1.cmml">​</mo><msub id="alg2.l16.m1.1.1.3.2.2.3" xref="alg2.l16.m1.1.1.3.2.2.3.cmml"><mi id="alg2.l16.m1.1.1.3.2.2.3.2" xref="alg2.l16.m1.1.1.3.2.2.3.2.cmml">r</mi><mrow id="alg2.l16.m1.1.1.3.2.2.3.3" xref="alg2.l16.m1.1.1.3.2.2.3.3.cmml"><mi id="alg2.l16.m1.1.1.3.2.2.3.3.2" xref="alg2.l16.m1.1.1.3.2.2.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.2.2.3.3.1" xref="alg2.l16.m1.1.1.3.2.2.3.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.3.2.2.3.3.3" xref="alg2.l16.m1.1.1.3.2.2.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.2.2.3.3.1a" xref="alg2.l16.m1.1.1.3.2.2.3.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.3.2.2.3.3.4" xref="alg2.l16.m1.1.1.3.2.2.3.3.4.cmml">v</mi></mrow></msub></mrow><mo id="alg2.l16.m1.1.1.3.2.1" xref="alg2.l16.m1.1.1.3.2.1.cmml">/</mo><mi id="alg2.l16.m1.1.1.3.2.3" xref="alg2.l16.m1.1.1.3.2.3.cmml">s</mi></mrow><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.1" xref="alg2.l16.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.3.3" xref="alg2.l16.m1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.1a" xref="alg2.l16.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.3.4" xref="alg2.l16.m1.1.1.3.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.1b" xref="alg2.l16.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.3.5" xref="alg2.l16.m1.1.1.3.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.1c" xref="alg2.l16.m1.1.1.3.1.cmml">​</mo><mi mathvariant="normal" id="alg2.l16.m1.1.1.3.6" xref="alg2.l16.m1.1.1.3.6.cmml">_</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.1d" xref="alg2.l16.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.3.7" xref="alg2.l16.m1.1.1.3.7.cmml">r</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.1e" xref="alg2.l16.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.3.8" xref="alg2.l16.m1.1.1.3.8.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.1f" xref="alg2.l16.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.3.9" xref="alg2.l16.m1.1.1.3.9.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.3.1g" xref="alg2.l16.m1.1.1.3.1.cmml">​</mo><mi id="alg2.l16.m1.1.1.3.10" xref="alg2.l16.m1.1.1.3.10.cmml">e</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><ci id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1">←</ci><apply id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1.2"><times id="alg2.l16.m1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1.2.1"></times><ci id="alg2.l16.m1.1.1.2.2.cmml" xref="alg2.l16.m1.1.1.2.2">𝑙</ci><apply id="alg2.l16.m1.1.1.2.3.cmml" xref="alg2.l16.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.2.3.1.cmml" xref="alg2.l16.m1.1.1.2.3">subscript</csymbol><ci id="alg2.l16.m1.1.1.2.3.2.cmml" xref="alg2.l16.m1.1.1.2.3.2">𝑟</ci><apply id="alg2.l16.m1.1.1.2.3.3.cmml" xref="alg2.l16.m1.1.1.2.3.3"><times id="alg2.l16.m1.1.1.2.3.3.1.cmml" xref="alg2.l16.m1.1.1.2.3.3.1"></times><ci id="alg2.l16.m1.1.1.2.3.3.2.cmml" xref="alg2.l16.m1.1.1.2.3.3.2">𝑎</ci><ci id="alg2.l16.m1.1.1.2.3.3.3.cmml" xref="alg2.l16.m1.1.1.2.3.3.3">𝑑</ci><ci id="alg2.l16.m1.1.1.2.3.3.4.cmml" xref="alg2.l16.m1.1.1.2.3.3.4">𝑣</ci></apply></apply></apply><apply id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3"><times id="alg2.l16.m1.1.1.3.1.cmml" xref="alg2.l16.m1.1.1.3.1"></times><apply id="alg2.l16.m1.1.1.3.2.cmml" xref="alg2.l16.m1.1.1.3.2"><divide id="alg2.l16.m1.1.1.3.2.1.cmml" xref="alg2.l16.m1.1.1.3.2.1"></divide><apply id="alg2.l16.m1.1.1.3.2.2.cmml" xref="alg2.l16.m1.1.1.3.2.2"><times id="alg2.l16.m1.1.1.3.2.2.1.cmml" xref="alg2.l16.m1.1.1.3.2.2.1"></times><ci id="alg2.l16.m1.1.1.3.2.2.2.cmml" xref="alg2.l16.m1.1.1.3.2.2.2">𝑙</ci><apply id="alg2.l16.m1.1.1.3.2.2.3.cmml" xref="alg2.l16.m1.1.1.3.2.2.3"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.3.2.2.3.1.cmml" xref="alg2.l16.m1.1.1.3.2.2.3">subscript</csymbol><ci id="alg2.l16.m1.1.1.3.2.2.3.2.cmml" xref="alg2.l16.m1.1.1.3.2.2.3.2">𝑟</ci><apply id="alg2.l16.m1.1.1.3.2.2.3.3.cmml" xref="alg2.l16.m1.1.1.3.2.2.3.3"><times id="alg2.l16.m1.1.1.3.2.2.3.3.1.cmml" xref="alg2.l16.m1.1.1.3.2.2.3.3.1"></times><ci id="alg2.l16.m1.1.1.3.2.2.3.3.2.cmml" xref="alg2.l16.m1.1.1.3.2.2.3.3.2">𝑎</ci><ci id="alg2.l16.m1.1.1.3.2.2.3.3.3.cmml" xref="alg2.l16.m1.1.1.3.2.2.3.3.3">𝑑</ci><ci id="alg2.l16.m1.1.1.3.2.2.3.3.4.cmml" xref="alg2.l16.m1.1.1.3.2.2.3.3.4">𝑣</ci></apply></apply></apply><ci id="alg2.l16.m1.1.1.3.2.3.cmml" xref="alg2.l16.m1.1.1.3.2.3">𝑠</ci></apply><ci id="alg2.l16.m1.1.1.3.3.cmml" xref="alg2.l16.m1.1.1.3.3">𝑡</ci><ci id="alg2.l16.m1.1.1.3.4.cmml" xref="alg2.l16.m1.1.1.3.4">𝑒</ci><ci id="alg2.l16.m1.1.1.3.5.cmml" xref="alg2.l16.m1.1.1.3.5">𝑝</ci><ci id="alg2.l16.m1.1.1.3.6.cmml" xref="alg2.l16.m1.1.1.3.6">_</ci><ci id="alg2.l16.m1.1.1.3.7.cmml" xref="alg2.l16.m1.1.1.3.7">𝑟</ci><ci id="alg2.l16.m1.1.1.3.8.cmml" xref="alg2.l16.m1.1.1.3.8">𝑎</ci><ci id="alg2.l16.m1.1.1.3.9.cmml" xref="alg2.l16.m1.1.1.3.9">𝑡</ci><ci id="alg2.l16.m1.1.1.3.10.cmml" xref="alg2.l16.m1.1.1.3.10">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">lr_{adv}\leftarrow lr_{adv}/step\_rate</annotation></semantics></math>

</div>
<div id="alg2.l17" class="ltx_listingline">     <span id="alg2.l17.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l17.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l18" class="ltx_listingline">  <span id="alg2.l18.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l18.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l19" class="ltx_listingline">  <span id="alg2.l19.1" class="ltx_text ltx_font_italic">// Scale up the model before submission.</span>

</div>
<div id="alg2.l20" class="ltx_listingline">  <math id="alg2.l20.m1.1" class="ltx_Math" alttext="\widetilde{L}^{t+1}\leftarrow\gamma(X-G^{t})+G^{t}" display="inline"><semantics id="alg2.l20.m1.1a"><mrow id="alg2.l20.m1.1.1" xref="alg2.l20.m1.1.1.cmml"><msup id="alg2.l20.m1.1.1.3" xref="alg2.l20.m1.1.1.3.cmml"><mover accent="true" id="alg2.l20.m1.1.1.3.2" xref="alg2.l20.m1.1.1.3.2.cmml"><mi id="alg2.l20.m1.1.1.3.2.2" xref="alg2.l20.m1.1.1.3.2.2.cmml">L</mi><mo id="alg2.l20.m1.1.1.3.2.1" xref="alg2.l20.m1.1.1.3.2.1.cmml">~</mo></mover><mrow id="alg2.l20.m1.1.1.3.3" xref="alg2.l20.m1.1.1.3.3.cmml"><mi id="alg2.l20.m1.1.1.3.3.2" xref="alg2.l20.m1.1.1.3.3.2.cmml">t</mi><mo id="alg2.l20.m1.1.1.3.3.1" xref="alg2.l20.m1.1.1.3.3.1.cmml">+</mo><mn id="alg2.l20.m1.1.1.3.3.3" xref="alg2.l20.m1.1.1.3.3.3.cmml">1</mn></mrow></msup><mo stretchy="false" id="alg2.l20.m1.1.1.2" xref="alg2.l20.m1.1.1.2.cmml">←</mo><mrow id="alg2.l20.m1.1.1.1" xref="alg2.l20.m1.1.1.1.cmml"><mrow id="alg2.l20.m1.1.1.1.1" xref="alg2.l20.m1.1.1.1.1.cmml"><mi id="alg2.l20.m1.1.1.1.1.3" xref="alg2.l20.m1.1.1.1.1.3.cmml">γ</mi><mo lspace="0em" rspace="0em" id="alg2.l20.m1.1.1.1.1.2" xref="alg2.l20.m1.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l20.m1.1.1.1.1.1.1" xref="alg2.l20.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l20.m1.1.1.1.1.1.1.2" xref="alg2.l20.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l20.m1.1.1.1.1.1.1.1" xref="alg2.l20.m1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l20.m1.1.1.1.1.1.1.1.2" xref="alg2.l20.m1.1.1.1.1.1.1.1.2.cmml">X</mi><mo id="alg2.l20.m1.1.1.1.1.1.1.1.1" xref="alg2.l20.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="alg2.l20.m1.1.1.1.1.1.1.1.3" xref="alg2.l20.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l20.m1.1.1.1.1.1.1.1.3.2" xref="alg2.l20.m1.1.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="alg2.l20.m1.1.1.1.1.1.1.1.3.3" xref="alg2.l20.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="alg2.l20.m1.1.1.1.1.1.1.3" xref="alg2.l20.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg2.l20.m1.1.1.1.2" xref="alg2.l20.m1.1.1.1.2.cmml">+</mo><msup id="alg2.l20.m1.1.1.1.3" xref="alg2.l20.m1.1.1.1.3.cmml"><mi id="alg2.l20.m1.1.1.1.3.2" xref="alg2.l20.m1.1.1.1.3.2.cmml">G</mi><mi id="alg2.l20.m1.1.1.1.3.3" xref="alg2.l20.m1.1.1.1.3.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l20.m1.1b"><apply id="alg2.l20.m1.1.1.cmml" xref="alg2.l20.m1.1.1"><ci id="alg2.l20.m1.1.1.2.cmml" xref="alg2.l20.m1.1.1.2">←</ci><apply id="alg2.l20.m1.1.1.3.cmml" xref="alg2.l20.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.3.1.cmml" xref="alg2.l20.m1.1.1.3">superscript</csymbol><apply id="alg2.l20.m1.1.1.3.2.cmml" xref="alg2.l20.m1.1.1.3.2"><ci id="alg2.l20.m1.1.1.3.2.1.cmml" xref="alg2.l20.m1.1.1.3.2.1">~</ci><ci id="alg2.l20.m1.1.1.3.2.2.cmml" xref="alg2.l20.m1.1.1.3.2.2">𝐿</ci></apply><apply id="alg2.l20.m1.1.1.3.3.cmml" xref="alg2.l20.m1.1.1.3.3"><plus id="alg2.l20.m1.1.1.3.3.1.cmml" xref="alg2.l20.m1.1.1.3.3.1"></plus><ci id="alg2.l20.m1.1.1.3.3.2.cmml" xref="alg2.l20.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg2.l20.m1.1.1.3.3.3.cmml" xref="alg2.l20.m1.1.1.3.3.3">1</cn></apply></apply><apply id="alg2.l20.m1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1"><plus id="alg2.l20.m1.1.1.1.2.cmml" xref="alg2.l20.m1.1.1.1.2"></plus><apply id="alg2.l20.m1.1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1.1"><times id="alg2.l20.m1.1.1.1.1.2.cmml" xref="alg2.l20.m1.1.1.1.1.2"></times><ci id="alg2.l20.m1.1.1.1.1.3.cmml" xref="alg2.l20.m1.1.1.1.1.3">𝛾</ci><apply id="alg2.l20.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1.1.1.1"><minus id="alg2.l20.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l20.m1.1.1.1.1.1.1.1.1"></minus><ci id="alg2.l20.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l20.m1.1.1.1.1.1.1.1.2">𝑋</ci><apply id="alg2.l20.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l20.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l20.m1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="alg2.l20.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l20.m1.1.1.1.1.1.1.1.3.2">𝐺</ci><ci id="alg2.l20.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l20.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="alg2.l20.m1.1.1.1.3.cmml" xref="alg2.l20.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l20.m1.1.1.1.3.1.cmml" xref="alg2.l20.m1.1.1.1.3">superscript</csymbol><ci id="alg2.l20.m1.1.1.1.3.2.cmml" xref="alg2.l20.m1.1.1.1.3.2">𝐺</ci><ci id="alg2.l20.m1.1.1.1.3.3.cmml" xref="alg2.l20.m1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l20.m1.1c">\widetilde{L}^{t+1}\leftarrow\gamma(X-G^{t})+G^{t}</annotation></semantics></math>

</div>
<div id="alg2.l21" class="ltx_listingline">  <span id="alg2.l21.1" class="ltx_text ltx_font_bold">return</span> <math id="alg2.l21.m1.1" class="ltx_Math" alttext="\widetilde{L}^{t+1}" display="inline"><semantics id="alg2.l21.m1.1a"><msup id="alg2.l21.m1.1.1" xref="alg2.l21.m1.1.1.cmml"><mover accent="true" id="alg2.l21.m1.1.1.2" xref="alg2.l21.m1.1.1.2.cmml"><mi id="alg2.l21.m1.1.1.2.2" xref="alg2.l21.m1.1.1.2.2.cmml">L</mi><mo id="alg2.l21.m1.1.1.2.1" xref="alg2.l21.m1.1.1.2.1.cmml">~</mo></mover><mrow id="alg2.l21.m1.1.1.3" xref="alg2.l21.m1.1.1.3.cmml"><mi id="alg2.l21.m1.1.1.3.2" xref="alg2.l21.m1.1.1.3.2.cmml">t</mi><mo id="alg2.l21.m1.1.1.3.1" xref="alg2.l21.m1.1.1.3.1.cmml">+</mo><mn id="alg2.l21.m1.1.1.3.3" xref="alg2.l21.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="alg2.l21.m1.1b"><apply id="alg2.l21.m1.1.1.cmml" xref="alg2.l21.m1.1.1"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.1.cmml" xref="alg2.l21.m1.1.1">superscript</csymbol><apply id="alg2.l21.m1.1.1.2.cmml" xref="alg2.l21.m1.1.1.2"><ci id="alg2.l21.m1.1.1.2.1.cmml" xref="alg2.l21.m1.1.1.2.1">~</ci><ci id="alg2.l21.m1.1.1.2.2.cmml" xref="alg2.l21.m1.1.1.2.2">𝐿</ci></apply><apply id="alg2.l21.m1.1.1.3.cmml" xref="alg2.l21.m1.1.1.3"><plus id="alg2.l21.m1.1.1.3.1.cmml" xref="alg2.l21.m1.1.1.3.1"></plus><ci id="alg2.l21.m1.1.1.3.2.cmml" xref="alg2.l21.m1.1.1.3.2">𝑡</ci><cn type="integer" id="alg2.l21.m1.1.1.3.3.cmml" xref="alg2.l21.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.m1.1c">\widetilde{L}^{t+1}</annotation></semantics></math>

</div>
</div>
</figure>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">The naive approach does not work against federated learning. Aggregation
cancels out most of the backdoored model’s contribution and the joint
model quickly forgets the backdoor. The attacker needs to be selected
often and even then the poisoning is very slow. In our experiments,
we use the naive approach as the baseline.</p>
</div>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.2" class="ltx_p"><span id="S4.SS2.p4.2.1" class="ltx_text ltx_font_bold ltx_font_italic">Model replacement.</span> 

In this method, the attacker ambitiously attempts to substitute the new
global model <math id="S4.SS2.p4.1.m1.1" class="ltx_Math" alttext="G^{t+1}" display="inline"><semantics id="S4.SS2.p4.1.m1.1a"><msup id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">G</mi><mrow id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml"><mi id="S4.SS2.p4.1.m1.1.1.3.2" xref="S4.SS2.p4.1.m1.1.1.3.2.cmml">t</mi><mo id="S4.SS2.p4.1.m1.1.1.3.1" xref="S4.SS2.p4.1.m1.1.1.3.1.cmml">+</mo><mn id="S4.SS2.p4.1.m1.1.1.3.3" xref="S4.SS2.p4.1.m1.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1">superscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝐺</ci><apply id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3"><plus id="S4.SS2.p4.1.m1.1.1.3.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3.1"></plus><ci id="S4.SS2.p4.1.m1.1.1.3.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p4.1.m1.1.1.3.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">G^{t+1}</annotation></semantics></math> with a malicious model <math id="S4.SS2.p4.2.m2.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS2.p4.2.m2.1a"><mi id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><ci id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">X</annotation></semantics></math> in Eq. <a href="#S3.E1" title="In 3. Federated Learning ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>:</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.1" class="ltx_Math" alttext="X=G^{t}+\frac{\eta}{n}\sum_{i=1}^{m}(L_{i}^{t+1}-G^{t})" display="block"><semantics id="S4.E2.m1.1a"><mrow id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml"><mi id="S4.E2.m1.1.1.3" xref="S4.E2.m1.1.1.3.cmml">X</mi><mo id="S4.E2.m1.1.1.2" xref="S4.E2.m1.1.1.2.cmml">=</mo><mrow id="S4.E2.m1.1.1.1" xref="S4.E2.m1.1.1.1.cmml"><msup id="S4.E2.m1.1.1.1.3" xref="S4.E2.m1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.3.2.cmml">G</mi><mi id="S4.E2.m1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.3.3.cmml">t</mi></msup><mo id="S4.E2.m1.1.1.1.2" xref="S4.E2.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E2.m1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.cmml"><mfrac id="S4.E2.m1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.3.2.cmml">η</mi><mi id="S4.E2.m1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.3.3.cmml">n</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E2.m1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.cmml"><munderover id="S4.E2.m1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E2.m1.1.1.1.1.1.2.2.2" xref="S4.E2.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E2.m1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.2.2.3.2" xref="S4.E2.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E2.m1.1.1.1.1.1.2.2.3.1" xref="S4.E2.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E2.m1.1.1.1.1.1.2.2.3.3" xref="S4.E2.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E2.m1.1.1.1.1.1.2.3" xref="S4.E2.m1.1.1.1.1.1.2.3.cmml">m</mi></munderover><mrow id="S4.E2.m1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E2.m1.1.1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.2.cmml">L</mi><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.E2.m1.1.1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S4.E2.m1.1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S4.E2.m1.1.1.1.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1"><eq id="S4.E2.m1.1.1.2.cmml" xref="S4.E2.m1.1.1.2"></eq><ci id="S4.E2.m1.1.1.3.cmml" xref="S4.E2.m1.1.1.3">𝑋</ci><apply id="S4.E2.m1.1.1.1.cmml" xref="S4.E2.m1.1.1.1"><plus id="S4.E2.m1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.2"></plus><apply id="S4.E2.m1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.3">superscript</csymbol><ci id="S4.E2.m1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.3.2">𝐺</ci><ci id="S4.E2.m1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.3.3">𝑡</ci></apply><apply id="S4.E2.m1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1"><times id="S4.E2.m1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.2"></times><apply id="S4.E2.m1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.3"><divide id="S4.E2.m1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.3"></divide><ci id="S4.E2.m1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.3.2">𝜂</ci><ci id="S4.E2.m1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.3.3">𝑛</ci></apply><apply id="S4.E2.m1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1"><apply id="S4.E2.m1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E2.m1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E2.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E2.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.2.2.3"><eq id="S4.E2.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E2.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E2.m1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E2.m1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.2.3">𝑚</ci></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1"><minus id="S4.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.2">𝐿</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3"><plus id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.1"></plus><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.2">𝐺</ci><ci id="S4.E2.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">X=G^{t}+\frac{\eta}{n}\sum_{i=1}^{m}(L_{i}^{t+1}-G^{t})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS2.p4.3" class="ltx_p">Because of the non-i.i.d. training data, each local model may be far
from the current global model. As the global model converges, these
deviations start to cancel out, i.e., <math id="S4.SS2.p4.3.m1.1" class="ltx_Math" alttext="\sum_{i=1}^{m-1}(L_{i}^{t+1}-G^{t})\approx 0" display="inline"><semantics id="S4.SS2.p4.3.m1.1a"><mrow id="S4.SS2.p4.3.m1.1.1" xref="S4.SS2.p4.3.m1.1.1.cmml"><mrow id="S4.SS2.p4.3.m1.1.1.1" xref="S4.SS2.p4.3.m1.1.1.1.cmml"><msubsup id="S4.SS2.p4.3.m1.1.1.1.2" xref="S4.SS2.p4.3.m1.1.1.1.2.cmml"><mo id="S4.SS2.p4.3.m1.1.1.1.2.2.2" xref="S4.SS2.p4.3.m1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.SS2.p4.3.m1.1.1.1.2.2.3" xref="S4.SS2.p4.3.m1.1.1.1.2.2.3.cmml"><mi id="S4.SS2.p4.3.m1.1.1.1.2.2.3.2" xref="S4.SS2.p4.3.m1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.SS2.p4.3.m1.1.1.1.2.2.3.1" xref="S4.SS2.p4.3.m1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.SS2.p4.3.m1.1.1.1.2.2.3.3" xref="S4.SS2.p4.3.m1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.SS2.p4.3.m1.1.1.1.2.3" xref="S4.SS2.p4.3.m1.1.1.1.2.3.cmml"><mi id="S4.SS2.p4.3.m1.1.1.1.2.3.2" xref="S4.SS2.p4.3.m1.1.1.1.2.3.2.cmml">m</mi><mo id="S4.SS2.p4.3.m1.1.1.1.2.3.1" xref="S4.SS2.p4.3.m1.1.1.1.2.3.1.cmml">−</mo><mn id="S4.SS2.p4.3.m1.1.1.1.2.3.3" xref="S4.SS2.p4.3.m1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mrow id="S4.SS2.p4.3.m1.1.1.1.1.1" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="S4.SS2.p4.3.m1.1.1.1.1.1.2" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p4.3.m1.1.1.1.1.1.1" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.2.2" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.2.2.cmml">L</mi><mi id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.2.3" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.2" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.1" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.3" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.SS2.p4.3.m1.1.1.1.1.1.1.1" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S4.SS2.p4.3.m1.1.1.1.1.1.1.3" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.2" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.3" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S4.SS2.p4.3.m1.1.1.1.1.1.3" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p4.3.m1.1.1.2" xref="S4.SS2.p4.3.m1.1.1.2.cmml">≈</mo><mn id="S4.SS2.p4.3.m1.1.1.3" xref="S4.SS2.p4.3.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m1.1b"><apply id="S4.SS2.p4.3.m1.1.1.cmml" xref="S4.SS2.p4.3.m1.1.1"><approx id="S4.SS2.p4.3.m1.1.1.2.cmml" xref="S4.SS2.p4.3.m1.1.1.2"></approx><apply id="S4.SS2.p4.3.m1.1.1.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1"><apply id="S4.SS2.p4.3.m1.1.1.1.2.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m1.1.1.1.2.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2">superscript</csymbol><apply id="S4.SS2.p4.3.m1.1.1.1.2.2.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m1.1.1.1.2.2.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2">subscript</csymbol><sum id="S4.SS2.p4.3.m1.1.1.1.2.2.2.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2.2.2"></sum><apply id="S4.SS2.p4.3.m1.1.1.1.2.2.3.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2.2.3"><eq id="S4.SS2.p4.3.m1.1.1.1.2.2.3.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2.2.3.1"></eq><ci id="S4.SS2.p4.3.m1.1.1.1.2.2.3.2.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.SS2.p4.3.m1.1.1.1.2.2.3.3.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p4.3.m1.1.1.1.2.3.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2.3"><minus id="S4.SS2.p4.3.m1.1.1.1.2.3.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2.3.1"></minus><ci id="S4.SS2.p4.3.m1.1.1.1.2.3.2.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2.3.2">𝑚</ci><cn type="integer" id="S4.SS2.p4.3.m1.1.1.1.2.3.3.cmml" xref="S4.SS2.p4.3.m1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p4.3.m1.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1"><minus id="S4.SS2.p4.3.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.1"></minus><apply id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.2.2">𝐿</ci><ci id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3"><plus id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.1"></plus><ci id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.2">𝐺</ci><ci id="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p4.3.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn type="integer" id="S4.SS2.p4.3.m1.1.1.3.cmml" xref="S4.SS2.p4.3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m1.1c">\sum_{i=1}^{m-1}(L_{i}^{t+1}-G^{t})\approx 0</annotation></semantics></math>. Therefore, the attacker can solve for the model it
needs to submit as follows:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.3" class="ltx_Math" alttext="\widetilde{L}_{m}^{t+1}=\frac{n}{\eta}X-(\frac{n}{\eta}-1)G^{t}-\sum_{i=1}^{m-1}(L_{i}^{t+1}-G^{t})\approx\frac{n}{\eta}(X-G^{t})+G^{t}" display="block"><semantics id="S4.E3.m1.3a"><mrow id="S4.E3.m1.3.3" xref="S4.E3.m1.3.3.cmml"><msubsup id="S4.E3.m1.3.3.5" xref="S4.E3.m1.3.3.5.cmml"><mover accent="true" id="S4.E3.m1.3.3.5.2.2" xref="S4.E3.m1.3.3.5.2.2.cmml"><mi id="S4.E3.m1.3.3.5.2.2.2" xref="S4.E3.m1.3.3.5.2.2.2.cmml">L</mi><mo id="S4.E3.m1.3.3.5.2.2.1" xref="S4.E3.m1.3.3.5.2.2.1.cmml">~</mo></mover><mi id="S4.E3.m1.3.3.5.2.3" xref="S4.E3.m1.3.3.5.2.3.cmml">m</mi><mrow id="S4.E3.m1.3.3.5.3" xref="S4.E3.m1.3.3.5.3.cmml"><mi id="S4.E3.m1.3.3.5.3.2" xref="S4.E3.m1.3.3.5.3.2.cmml">t</mi><mo id="S4.E3.m1.3.3.5.3.1" xref="S4.E3.m1.3.3.5.3.1.cmml">+</mo><mn id="S4.E3.m1.3.3.5.3.3" xref="S4.E3.m1.3.3.5.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.E3.m1.3.3.6" xref="S4.E3.m1.3.3.6.cmml">=</mo><mrow id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.2.cmml"><mrow id="S4.E3.m1.2.2.2.4" xref="S4.E3.m1.2.2.2.4.cmml"><mfrac id="S4.E3.m1.2.2.2.4.2" xref="S4.E3.m1.2.2.2.4.2.cmml"><mi id="S4.E3.m1.2.2.2.4.2.2" xref="S4.E3.m1.2.2.2.4.2.2.cmml">n</mi><mi id="S4.E3.m1.2.2.2.4.2.3" xref="S4.E3.m1.2.2.2.4.2.3.cmml">η</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.4.1" xref="S4.E3.m1.2.2.2.4.1.cmml">​</mo><mi id="S4.E3.m1.2.2.2.4.3" xref="S4.E3.m1.2.2.2.4.3.cmml">X</mi></mrow><mo id="S4.E3.m1.2.2.2.3" xref="S4.E3.m1.2.2.2.3.cmml">−</mo><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml"><mfrac id="S4.E3.m1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.2.2.cmml">n</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.2.3.cmml">η</mi></mfrac><mo id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E3.m1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml">​</mo><msup id="S4.E3.m1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.1.3.2.cmml">G</mi><mi id="S4.E3.m1.1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo rspace="0.055em" id="S4.E3.m1.2.2.2.3a" xref="S4.E3.m1.2.2.2.3.cmml">−</mo><mrow id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2.cmml"><munderover id="S4.E3.m1.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.cmml"><mo movablelimits="false" rspace="0em" id="S4.E3.m1.2.2.2.2.2.2.2" xref="S4.E3.m1.2.2.2.2.2.2.2.cmml">∑</mo><mrow id="S4.E3.m1.2.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.2.3.cmml"><mi id="S4.E3.m1.2.2.2.2.2.2.3.2" xref="S4.E3.m1.2.2.2.2.2.2.3.2.cmml">i</mi><mo id="S4.E3.m1.2.2.2.2.2.2.3.1" xref="S4.E3.m1.2.2.2.2.2.2.3.1.cmml">=</mo><mn id="S4.E3.m1.2.2.2.2.2.2.3.3" xref="S4.E3.m1.2.2.2.2.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E3.m1.2.2.2.2.2.3" xref="S4.E3.m1.2.2.2.2.2.3.cmml"><mi id="S4.E3.m1.2.2.2.2.2.3.2" xref="S4.E3.m1.2.2.2.2.2.3.2.cmml">m</mi><mo id="S4.E3.m1.2.2.2.2.2.3.1" xref="S4.E3.m1.2.2.2.2.2.3.1.cmml">−</mo><mn id="S4.E3.m1.2.2.2.2.2.3.3" xref="S4.E3.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></munderover><mrow id="S4.E3.m1.2.2.2.2.1.1" xref="S4.E3.m1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.2.2.1.1.2" xref="S4.E3.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.2.2.2.2.1.1.1" xref="S4.E3.m1.2.2.2.2.1.1.1.cmml"><msubsup id="S4.E3.m1.2.2.2.2.1.1.1.2" xref="S4.E3.m1.2.2.2.2.1.1.1.2.cmml"><mi id="S4.E3.m1.2.2.2.2.1.1.1.2.2.2" xref="S4.E3.m1.2.2.2.2.1.1.1.2.2.2.cmml">L</mi><mi id="S4.E3.m1.2.2.2.2.1.1.1.2.2.3" xref="S4.E3.m1.2.2.2.2.1.1.1.2.2.3.cmml">i</mi><mrow id="S4.E3.m1.2.2.2.2.1.1.1.2.3" xref="S4.E3.m1.2.2.2.2.1.1.1.2.3.cmml"><mi id="S4.E3.m1.2.2.2.2.1.1.1.2.3.2" xref="S4.E3.m1.2.2.2.2.1.1.1.2.3.2.cmml">t</mi><mo id="S4.E3.m1.2.2.2.2.1.1.1.2.3.1" xref="S4.E3.m1.2.2.2.2.1.1.1.2.3.1.cmml">+</mo><mn id="S4.E3.m1.2.2.2.2.1.1.1.2.3.3" xref="S4.E3.m1.2.2.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.E3.m1.2.2.2.2.1.1.1.1" xref="S4.E3.m1.2.2.2.2.1.1.1.1.cmml">−</mo><msup id="S4.E3.m1.2.2.2.2.1.1.1.3" xref="S4.E3.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E3.m1.2.2.2.2.1.1.1.3.2" xref="S4.E3.m1.2.2.2.2.1.1.1.3.2.cmml">G</mi><mi id="S4.E3.m1.2.2.2.2.1.1.1.3.3" xref="S4.E3.m1.2.2.2.2.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S4.E3.m1.2.2.2.2.1.1.3" xref="S4.E3.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3.m1.3.3.7" xref="S4.E3.m1.3.3.7.cmml">≈</mo><mrow id="S4.E3.m1.3.3.3" xref="S4.E3.m1.3.3.3.cmml"><mrow id="S4.E3.m1.3.3.3.1" xref="S4.E3.m1.3.3.3.1.cmml"><mfrac id="S4.E3.m1.3.3.3.1.3" xref="S4.E3.m1.3.3.3.1.3.cmml"><mi id="S4.E3.m1.3.3.3.1.3.2" xref="S4.E3.m1.3.3.3.1.3.2.cmml">n</mi><mi id="S4.E3.m1.3.3.3.1.3.3" xref="S4.E3.m1.3.3.3.1.3.3.cmml">η</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E3.m1.3.3.3.1.2" xref="S4.E3.m1.3.3.3.1.2.cmml">​</mo><mrow id="S4.E3.m1.3.3.3.1.1.1" xref="S4.E3.m1.3.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.3.3.3.1.1.1.2" xref="S4.E3.m1.3.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.3.3.3.1.1.1.1" xref="S4.E3.m1.3.3.3.1.1.1.1.cmml"><mi id="S4.E3.m1.3.3.3.1.1.1.1.2" xref="S4.E3.m1.3.3.3.1.1.1.1.2.cmml">X</mi><mo id="S4.E3.m1.3.3.3.1.1.1.1.1" xref="S4.E3.m1.3.3.3.1.1.1.1.1.cmml">−</mo><msup id="S4.E3.m1.3.3.3.1.1.1.1.3" xref="S4.E3.m1.3.3.3.1.1.1.1.3.cmml"><mi id="S4.E3.m1.3.3.3.1.1.1.1.3.2" xref="S4.E3.m1.3.3.3.1.1.1.1.3.2.cmml">G</mi><mi id="S4.E3.m1.3.3.3.1.1.1.1.3.3" xref="S4.E3.m1.3.3.3.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S4.E3.m1.3.3.3.1.1.1.3" xref="S4.E3.m1.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.3.3.3.2" xref="S4.E3.m1.3.3.3.2.cmml">+</mo><msup id="S4.E3.m1.3.3.3.3" xref="S4.E3.m1.3.3.3.3.cmml"><mi id="S4.E3.m1.3.3.3.3.2" xref="S4.E3.m1.3.3.3.3.2.cmml">G</mi><mi id="S4.E3.m1.3.3.3.3.3" xref="S4.E3.m1.3.3.3.3.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.3b"><apply id="S4.E3.m1.3.3.cmml" xref="S4.E3.m1.3.3"><and id="S4.E3.m1.3.3a.cmml" xref="S4.E3.m1.3.3"></and><apply id="S4.E3.m1.3.3b.cmml" xref="S4.E3.m1.3.3"><eq id="S4.E3.m1.3.3.6.cmml" xref="S4.E3.m1.3.3.6"></eq><apply id="S4.E3.m1.3.3.5.cmml" xref="S4.E3.m1.3.3.5"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.5.1.cmml" xref="S4.E3.m1.3.3.5">superscript</csymbol><apply id="S4.E3.m1.3.3.5.2.cmml" xref="S4.E3.m1.3.3.5"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.5.2.1.cmml" xref="S4.E3.m1.3.3.5">subscript</csymbol><apply id="S4.E3.m1.3.3.5.2.2.cmml" xref="S4.E3.m1.3.3.5.2.2"><ci id="S4.E3.m1.3.3.5.2.2.1.cmml" xref="S4.E3.m1.3.3.5.2.2.1">~</ci><ci id="S4.E3.m1.3.3.5.2.2.2.cmml" xref="S4.E3.m1.3.3.5.2.2.2">𝐿</ci></apply><ci id="S4.E3.m1.3.3.5.2.3.cmml" xref="S4.E3.m1.3.3.5.2.3">𝑚</ci></apply><apply id="S4.E3.m1.3.3.5.3.cmml" xref="S4.E3.m1.3.3.5.3"><plus id="S4.E3.m1.3.3.5.3.1.cmml" xref="S4.E3.m1.3.3.5.3.1"></plus><ci id="S4.E3.m1.3.3.5.3.2.cmml" xref="S4.E3.m1.3.3.5.3.2">𝑡</ci><cn type="integer" id="S4.E3.m1.3.3.5.3.3.cmml" xref="S4.E3.m1.3.3.5.3.3">1</cn></apply></apply><apply id="S4.E3.m1.2.2.2.cmml" xref="S4.E3.m1.2.2.2"><minus id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.3"></minus><apply id="S4.E3.m1.2.2.2.4.cmml" xref="S4.E3.m1.2.2.2.4"><times id="S4.E3.m1.2.2.2.4.1.cmml" xref="S4.E3.m1.2.2.2.4.1"></times><apply id="S4.E3.m1.2.2.2.4.2.cmml" xref="S4.E3.m1.2.2.2.4.2"><divide id="S4.E3.m1.2.2.2.4.2.1.cmml" xref="S4.E3.m1.2.2.2.4.2"></divide><ci id="S4.E3.m1.2.2.2.4.2.2.cmml" xref="S4.E3.m1.2.2.2.4.2.2">𝑛</ci><ci id="S4.E3.m1.2.2.2.4.2.3.cmml" xref="S4.E3.m1.2.2.2.4.2.3">𝜂</ci></apply><ci id="S4.E3.m1.2.2.2.4.3.cmml" xref="S4.E3.m1.2.2.2.4.3">𝑋</ci></apply><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1"><times id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"></times><apply id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1"><minus id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.2"><divide id="S4.E3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.2"></divide><ci id="S4.E3.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.2.2">𝑛</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.2.3">𝜂</ci></apply><cn type="integer" id="S4.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S4.E3.m1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.1.3">superscript</csymbol><ci id="S4.E3.m1.1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.1.3.2">𝐺</ci><ci id="S4.E3.m1.1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S4.E3.m1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2"><apply id="S4.E3.m1.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2">superscript</csymbol><apply id="S4.E3.m1.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.2">subscript</csymbol><sum id="S4.E3.m1.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.2"></sum><apply id="S4.E3.m1.2.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3"><eq id="S4.E3.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3.1"></eq><ci id="S4.E3.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E3.m1.2.2.2.2.2.2.3.3.cmml" xref="S4.E3.m1.2.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S4.E3.m1.2.2.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.2.3"><minus id="S4.E3.m1.2.2.2.2.2.3.1.cmml" xref="S4.E3.m1.2.2.2.2.2.3.1"></minus><ci id="S4.E3.m1.2.2.2.2.2.3.2.cmml" xref="S4.E3.m1.2.2.2.2.2.3.2">𝑚</ci><cn type="integer" id="S4.E3.m1.2.2.2.2.2.3.3.cmml" xref="S4.E3.m1.2.2.2.2.2.3.3">1</cn></apply></apply><apply id="S4.E3.m1.2.2.2.2.1.1.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1"><minus id="S4.E3.m1.2.2.2.2.1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.1"></minus><apply id="S4.E3.m1.2.2.2.2.1.1.1.2.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.2">superscript</csymbol><apply id="S4.E3.m1.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.1.1.1.2.2.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.2.2.2.2.1.1.1.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.2.2.2">𝐿</ci><ci id="S4.E3.m1.2.2.2.2.1.1.1.2.2.3.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E3.m1.2.2.2.2.1.1.1.2.3.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.2.3"><plus id="S4.E3.m1.2.2.2.2.1.1.1.2.3.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.2.3.1"></plus><ci id="S4.E3.m1.2.2.2.2.1.1.1.2.3.2.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S4.E3.m1.2.2.2.2.1.1.1.2.3.3.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E3.m1.2.2.2.2.1.1.1.3.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.3">superscript</csymbol><ci id="S4.E3.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.3.2">𝐺</ci><ci id="S4.E3.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S4.E3.m1.2.2.2.2.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply></apply><apply id="S4.E3.m1.3.3c.cmml" xref="S4.E3.m1.3.3"><approx id="S4.E3.m1.3.3.7.cmml" xref="S4.E3.m1.3.3.7"></approx><share href="#S4.E3.m1.2.2.2.cmml" id="S4.E3.m1.3.3d.cmml" xref="S4.E3.m1.3.3"></share><apply id="S4.E3.m1.3.3.3.cmml" xref="S4.E3.m1.3.3.3"><plus id="S4.E3.m1.3.3.3.2.cmml" xref="S4.E3.m1.3.3.3.2"></plus><apply id="S4.E3.m1.3.3.3.1.cmml" xref="S4.E3.m1.3.3.3.1"><times id="S4.E3.m1.3.3.3.1.2.cmml" xref="S4.E3.m1.3.3.3.1.2"></times><apply id="S4.E3.m1.3.3.3.1.3.cmml" xref="S4.E3.m1.3.3.3.1.3"><divide id="S4.E3.m1.3.3.3.1.3.1.cmml" xref="S4.E3.m1.3.3.3.1.3"></divide><ci id="S4.E3.m1.3.3.3.1.3.2.cmml" xref="S4.E3.m1.3.3.3.1.3.2">𝑛</ci><ci id="S4.E3.m1.3.3.3.1.3.3.cmml" xref="S4.E3.m1.3.3.3.1.3.3">𝜂</ci></apply><apply id="S4.E3.m1.3.3.3.1.1.1.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1"><minus id="S4.E3.m1.3.3.3.1.1.1.1.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1.1.1"></minus><ci id="S4.E3.m1.3.3.3.1.1.1.1.2.cmml" xref="S4.E3.m1.3.3.3.1.1.1.1.2">𝑋</ci><apply id="S4.E3.m1.3.3.3.1.1.1.1.3.cmml" xref="S4.E3.m1.3.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.1.1.1.1.3.1.cmml" xref="S4.E3.m1.3.3.3.1.1.1.1.3">superscript</csymbol><ci id="S4.E3.m1.3.3.3.1.1.1.1.3.2.cmml" xref="S4.E3.m1.3.3.3.1.1.1.1.3.2">𝐺</ci><ci id="S4.E3.m1.3.3.3.1.1.1.1.3.3.cmml" xref="S4.E3.m1.3.3.3.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S4.E3.m1.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E3.m1.3.3.3.3.1.cmml" xref="S4.E3.m1.3.3.3.3">superscript</csymbol><ci id="S4.E3.m1.3.3.3.3.2.cmml" xref="S4.E3.m1.3.3.3.3.2">𝐺</ci><ci id="S4.E3.m1.3.3.3.3.3.cmml" xref="S4.E3.m1.3.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.3c">\widetilde{L}_{m}^{t+1}=\frac{n}{\eta}X-(\frac{n}{\eta}-1)G^{t}-\sum_{i=1}^{m-1}(L_{i}^{t+1}-G^{t})\approx\frac{n}{\eta}(X-G^{t})+G^{t}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS2.p4.6" class="ltx_p">This attack scales up the weights of the backdoored model <math id="S4.SS2.p4.4.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS2.p4.4.m1.1a"><mi id="S4.SS2.p4.4.m1.1.1" xref="S4.SS2.p4.4.m1.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m1.1b"><ci id="S4.SS2.p4.4.m1.1.1.cmml" xref="S4.SS2.p4.4.m1.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m1.1c">X</annotation></semantics></math> by <math id="S4.SS2.p4.5.m2.1" class="ltx_Math" alttext="\gamma=\frac{n}{\eta}" display="inline"><semantics id="S4.SS2.p4.5.m2.1a"><mrow id="S4.SS2.p4.5.m2.1.1" xref="S4.SS2.p4.5.m2.1.1.cmml"><mi id="S4.SS2.p4.5.m2.1.1.2" xref="S4.SS2.p4.5.m2.1.1.2.cmml">γ</mi><mo id="S4.SS2.p4.5.m2.1.1.1" xref="S4.SS2.p4.5.m2.1.1.1.cmml">=</mo><mfrac id="S4.SS2.p4.5.m2.1.1.3" xref="S4.SS2.p4.5.m2.1.1.3.cmml"><mi id="S4.SS2.p4.5.m2.1.1.3.2" xref="S4.SS2.p4.5.m2.1.1.3.2.cmml">n</mi><mi id="S4.SS2.p4.5.m2.1.1.3.3" xref="S4.SS2.p4.5.m2.1.1.3.3.cmml">η</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m2.1b"><apply id="S4.SS2.p4.5.m2.1.1.cmml" xref="S4.SS2.p4.5.m2.1.1"><eq id="S4.SS2.p4.5.m2.1.1.1.cmml" xref="S4.SS2.p4.5.m2.1.1.1"></eq><ci id="S4.SS2.p4.5.m2.1.1.2.cmml" xref="S4.SS2.p4.5.m2.1.1.2">𝛾</ci><apply id="S4.SS2.p4.5.m2.1.1.3.cmml" xref="S4.SS2.p4.5.m2.1.1.3"><divide id="S4.SS2.p4.5.m2.1.1.3.1.cmml" xref="S4.SS2.p4.5.m2.1.1.3"></divide><ci id="S4.SS2.p4.5.m2.1.1.3.2.cmml" xref="S4.SS2.p4.5.m2.1.1.3.2">𝑛</ci><ci id="S4.SS2.p4.5.m2.1.1.3.3.cmml" xref="S4.SS2.p4.5.m2.1.1.3.3">𝜂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m2.1c">\gamma=\frac{n}{\eta}</annotation></semantics></math> to ensure that the backdoor survives the averaging
and the global model is replaced by <math id="S4.SS2.p4.6.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS2.p4.6.m3.1a"><mi id="S4.SS2.p4.6.m3.1.1" xref="S4.SS2.p4.6.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m3.1b"><ci id="S4.SS2.p4.6.m3.1.1.cmml" xref="S4.SS2.p4.6.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m3.1c">X</annotation></semantics></math>. This works in any round of
federated learning but is more effective when the global model is close
to convergence—see Section <a href="#S5.SS5" title="5.5. Attacking at different stages of convergence ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.5</span></a>.</p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.4" class="ltx_p">An attacker who does not know <math id="S4.SS2.p5.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS2.p5.1.m1.1a"><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><ci id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">n</annotation></semantics></math> and <math id="S4.SS2.p5.2.m2.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S4.SS2.p5.2.m2.1a"><mi id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><ci id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">\eta</annotation></semantics></math> can approximate the
scaling factor <math id="S4.SS2.p5.3.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS2.p5.3.m3.1a"><mi id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><ci id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">\gamma</annotation></semantics></math> by iteratively increasing it every round and
measuring the accuracy of the model on the backdoor task. Scaling by
<math id="S4.SS2.p5.4.m4.1" class="ltx_Math" alttext="\gamma&lt;\frac{n}{\eta}" display="inline"><semantics id="S4.SS2.p5.4.m4.1a"><mrow id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml"><mi id="S4.SS2.p5.4.m4.1.1.2" xref="S4.SS2.p5.4.m4.1.1.2.cmml">γ</mi><mo id="S4.SS2.p5.4.m4.1.1.1" xref="S4.SS2.p5.4.m4.1.1.1.cmml">&lt;</mo><mfrac id="S4.SS2.p5.4.m4.1.1.3" xref="S4.SS2.p5.4.m4.1.1.3.cmml"><mi id="S4.SS2.p5.4.m4.1.1.3.2" xref="S4.SS2.p5.4.m4.1.1.3.2.cmml">n</mi><mi id="S4.SS2.p5.4.m4.1.1.3.3" xref="S4.SS2.p5.4.m4.1.1.3.3.cmml">η</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><apply id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1"><lt id="S4.SS2.p5.4.m4.1.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1.1"></lt><ci id="S4.SS2.p5.4.m4.1.1.2.cmml" xref="S4.SS2.p5.4.m4.1.1.2">𝛾</ci><apply id="S4.SS2.p5.4.m4.1.1.3.cmml" xref="S4.SS2.p5.4.m4.1.1.3"><divide id="S4.SS2.p5.4.m4.1.1.3.1.cmml" xref="S4.SS2.p5.4.m4.1.1.3"></divide><ci id="S4.SS2.p5.4.m4.1.1.3.2.cmml" xref="S4.SS2.p5.4.m4.1.1.3.2">𝑛</ci><ci id="S4.SS2.p5.4.m4.1.1.3.3.cmml" xref="S4.SS2.p5.4.m4.1.1.3.3">𝜂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">\gamma&lt;\frac{n}{\eta}</annotation></semantics></math> does not fully replace the global model,
but the attack still achieves good backdoor accuracy—see
Section <a href="#S5.SS6" title="5.6. Varying the scaling factor ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.6</span></a>.</p>
</div>
<div id="S4.SS2.p6" class="ltx_para">
<p id="S4.SS2.p6.1" class="ltx_p">In some versions of federated learning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib34" title="" class="ltx_ref">fedlearn_2, </a>)</cite>, a participant
is supposed to apply a random mask to the model weights. The attacker
can either skip this step and send the entire model, or apply a mask to
remove only the weights that are close to zero.</p>
</div>
<div id="S4.SS2.p7" class="ltx_para">
<p id="S4.SS2.p7.1" class="ltx_p">Model replacement ensures that the attacker’s contribution
survives averaging and is transferred to the global model. It is a
<span id="S4.SS2.p7.1.1" class="ltx_text ltx_font_bold">single-shot attack</span>: the global model exhibits high accuracy on
the backdoor task immediately after it has been poisoned.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Improving persistence and evading anomaly detection</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Because the attacker may be selected only for a single round of training,
he wants the backdoor to remain in the model for as many rounds as
possible after the model has been replaced. Preventing the backdoor
from being forgotten as the model is updated by benign participants
is similar to the <em id="S4.SS3.p1.1.1" class="ltx_emph ltx_font_italic">catastrophic forgetting</em> problem in multi-task
learning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib33" title="" class="ltx_ref">catastrophic2017, </a>; <a href="#bib.bib22" title="" class="ltx_ref">goodfellow2013empirical, </a>; <a href="#bib.bib39" title="" class="ltx_ref">li2018learning, </a>)</cite>.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">Our attack is effectively a two-task learning, where the global model
learns the main task during normal training and the backdoor task only
during the rounds when the attacker was selected. The objective is
to maintain high accuracy for both tasks after the attacker’s round.
Empirically, EWC loss <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib33" title="" class="ltx_ref">catastrophic2017, </a>)</cite> did not improve results
in our setting, but we used other techniques such as slowing down the
learning rate during the attacker’s training to improve the persistence
of the backdoor in the joint model.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">The latest proposals for federated learning use secure
aggregation <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib7" title="" class="ltx_ref">bonawitz2017practical, </a>)</cite>. It provably prevents the
aggregator from inspecting the models submitted by the participants.
<span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_bold">With secure aggregation, there is no way to detect that
aggregation includes a malicious model, nor who submitted this model.</span></p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">Without secure aggregation, the central server aggregating participants’
models may attempt to filter out “anomalous” contributions. Since the
weights of a model created using Eq. <a href="#S4.E3" title="In 4.2. Constructing the attack model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> are significantly
scaled up, such models may seem easy to detect and filter out.
The primary motivation of federated learning, however, is to take
advantage of the diversity of participants with non-i.i.d. training
data, including unusual or low-quality local data such as smartphone
photos or text-messaging history <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>. Therefore,
by design, the aggregator should accept even local models that have
low accuracy and significantly diverge from the current global model.
In Section <a href="#A1.SS1" title="A.1. Clustering ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>, we concretely show how the fairly wide
distribution of benign participants’ models enables the attacker to
create backdoored models that do not appear anomalous.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.p5.1" class="ltx_p"><span id="S4.SS3.p5.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Constrain-and-scale.</span> 

We now describe a generic method that enables the adversary to produce
a model that has high accuracy on both the main and backdoor tasks, yet
is not rejected by the aggregator’s anomaly detector. Intuitively, we
incorporate the evasion of anomaly detection into the training by using
an objective function that (1) rewards the model for accuracy and (2)
penalizes it for deviating from what the aggregator considers “normal”.
Following Kerckhoffs’s Principle, we assume that the anomaly detection
algorithm is known to the attacker.</p>
</div>
<div id="S4.SS3.p6" class="ltx_para">
<p id="S4.SS3.p6.1" class="ltx_p">Algorithm <a href="#alg2" title="Algorithm 2 ‣ 4.2. Constructing the attack model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> is our <span id="S4.SS3.p6.1.1" class="ltx_text ltx_font_italic">constrain-and-scale</span> method.
We modify the objective (loss) function by adding an anomaly detection
term <math id="S4.SS3.p6.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{ano}" display="inline"><semantics id="S4.SS3.p6.1.m1.1a"><msub id="S4.SS3.p6.1.m1.1.1" xref="S4.SS3.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p6.1.m1.1.1.2" xref="S4.SS3.p6.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.SS3.p6.1.m1.1.1.3" xref="S4.SS3.p6.1.m1.1.1.3.cmml"><mi id="S4.SS3.p6.1.m1.1.1.3.2" xref="S4.SS3.p6.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p6.1.m1.1.1.3.1" xref="S4.SS3.p6.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p6.1.m1.1.1.3.3" xref="S4.SS3.p6.1.m1.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p6.1.m1.1.1.3.1a" xref="S4.SS3.p6.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p6.1.m1.1.1.3.4" xref="S4.SS3.p6.1.m1.1.1.3.4.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.1.m1.1b"><apply id="S4.SS3.p6.1.m1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.1.m1.1.1.1.cmml" xref="S4.SS3.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p6.1.m1.1.1.2.cmml" xref="S4.SS3.p6.1.m1.1.1.2">ℒ</ci><apply id="S4.SS3.p6.1.m1.1.1.3.cmml" xref="S4.SS3.p6.1.m1.1.1.3"><times id="S4.SS3.p6.1.m1.1.1.3.1.cmml" xref="S4.SS3.p6.1.m1.1.1.3.1"></times><ci id="S4.SS3.p6.1.m1.1.1.3.2.cmml" xref="S4.SS3.p6.1.m1.1.1.3.2">𝑎</ci><ci id="S4.SS3.p6.1.m1.1.1.3.3.cmml" xref="S4.SS3.p6.1.m1.1.1.3.3">𝑛</ci><ci id="S4.SS3.p6.1.m1.1.1.3.4.cmml" xref="S4.SS3.p6.1.m1.1.1.3.4">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.1.m1.1c">\mathcal{L}_{ano}</annotation></semantics></math>:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\mathcal{L}_{model}=\alpha\mathcal{L}_{class}+(1-\alpha)\mathcal{L}_{ano}" display="block"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><msub id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.1.3.2" xref="S4.E4.m1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E4.m1.1.1.3.3" xref="S4.E4.m1.1.1.3.3.cmml"><mi id="S4.E4.m1.1.1.3.3.2" xref="S4.E4.m1.1.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.3.3.1" xref="S4.E4.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.3.3.3" xref="S4.E4.m1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.3.3.1a" xref="S4.E4.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.3.3.4" xref="S4.E4.m1.1.1.3.3.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.3.3.1b" xref="S4.E4.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.3.3.5" xref="S4.E4.m1.1.1.3.3.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.3.3.1c" xref="S4.E4.m1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.3.3.6" xref="S4.E4.m1.1.1.3.3.6.cmml">l</mi></mrow></msub><mo id="S4.E4.m1.1.1.2" xref="S4.E4.m1.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.3.1.cmml">​</mo><msub id="S4.E4.m1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.1.1.3.3.2" xref="S4.E4.m1.1.1.1.3.3.2.cmml">ℒ</mi><mrow id="S4.E4.m1.1.1.1.3.3.3" xref="S4.E4.m1.1.1.1.3.3.3.cmml"><mi id="S4.E4.m1.1.1.1.3.3.3.2" xref="S4.E4.m1.1.1.1.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.3.3.3.1" xref="S4.E4.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.3.3.3.3" xref="S4.E4.m1.1.1.1.3.3.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.3.3.3.1a" xref="S4.E4.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.3.3.3.4" xref="S4.E4.m1.1.1.1.3.3.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.3.3.3.1b" xref="S4.E4.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.3.3.3.5" xref="S4.E4.m1.1.1.1.3.3.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.3.3.3.1c" xref="S4.E4.m1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.3.3.3.6" xref="S4.E4.m1.1.1.1.3.3.3.6.cmml">s</mi></mrow></msub></mrow><mo id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml"><mn id="S4.E4.m1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E4.m1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E4.m1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S4.E4.m1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml">​</mo><msub id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E4.m1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.3.3.cmml"><mi id="S4.E4.m1.1.1.1.1.3.3.2" xref="S4.E4.m1.1.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.3.3.1" xref="S4.E4.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.3.3.3" xref="S4.E4.m1.1.1.1.1.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.3.3.1a" xref="S4.E4.m1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.1.1.1.1.3.3.4" xref="S4.E4.m1.1.1.1.1.3.3.4.cmml">o</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><eq id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1.2"></eq><apply id="S4.E4.m1.1.1.3.cmml" xref="S4.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.3.2">ℒ</ci><apply id="S4.E4.m1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.3.3"><times id="S4.E4.m1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.3.3.1"></times><ci id="S4.E4.m1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.3.3.2">𝑚</ci><ci id="S4.E4.m1.1.1.3.3.3.cmml" xref="S4.E4.m1.1.1.3.3.3">𝑜</ci><ci id="S4.E4.m1.1.1.3.3.4.cmml" xref="S4.E4.m1.1.1.3.3.4">𝑑</ci><ci id="S4.E4.m1.1.1.3.3.5.cmml" xref="S4.E4.m1.1.1.3.3.5">𝑒</ci><ci id="S4.E4.m1.1.1.3.3.6.cmml" xref="S4.E4.m1.1.1.3.3.6">𝑙</ci></apply></apply><apply id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><plus id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.2"></plus><apply id="S4.E4.m1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.3"><times id="S4.E4.m1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.3.1"></times><ci id="S4.E4.m1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.3.2">𝛼</ci><apply id="S4.E4.m1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.1.3.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.1.3.3.2">ℒ</ci><apply id="S4.E4.m1.1.1.1.3.3.3.cmml" xref="S4.E4.m1.1.1.1.3.3.3"><times id="S4.E4.m1.1.1.1.3.3.3.1.cmml" xref="S4.E4.m1.1.1.1.3.3.3.1"></times><ci id="S4.E4.m1.1.1.1.3.3.3.2.cmml" xref="S4.E4.m1.1.1.1.3.3.3.2">𝑐</ci><ci id="S4.E4.m1.1.1.1.3.3.3.3.cmml" xref="S4.E4.m1.1.1.1.3.3.3.3">𝑙</ci><ci id="S4.E4.m1.1.1.1.3.3.3.4.cmml" xref="S4.E4.m1.1.1.1.3.3.3.4">𝑎</ci><ci id="S4.E4.m1.1.1.1.3.3.3.5.cmml" xref="S4.E4.m1.1.1.1.3.3.3.5">𝑠</ci><ci id="S4.E4.m1.1.1.1.3.3.3.6.cmml" xref="S4.E4.m1.1.1.1.3.3.3.6">𝑠</ci></apply></apply></apply><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1"><times id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2"></times><apply id="S4.E4.m1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1"><minus id="S4.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S4.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2">ℒ</ci><apply id="S4.E4.m1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.3.3"><times id="S4.E4.m1.1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1"></times><ci id="S4.E4.m1.1.1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.3.2">𝑎</ci><ci id="S4.E4.m1.1.1.1.1.3.3.3.cmml" xref="S4.E4.m1.1.1.1.1.3.3.3">𝑛</ci><ci id="S4.E4.m1.1.1.1.1.3.3.4.cmml" xref="S4.E4.m1.1.1.1.1.3.3.4">𝑜</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\mathcal{L}_{model}=\alpha\mathcal{L}_{class}+(1-\alpha)\mathcal{L}_{ano}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p6.5" class="ltx_p">Because the attacker’s training data includes both benign and backdoor
inputs, <math id="S4.SS3.p6.2.m1.1" class="ltx_Math" alttext="\mathcal{L}_{class}" display="inline"><semantics id="S4.SS3.p6.2.m1.1a"><msub id="S4.SS3.p6.2.m1.1.1" xref="S4.SS3.p6.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p6.2.m1.1.1.2" xref="S4.SS3.p6.2.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.SS3.p6.2.m1.1.1.3" xref="S4.SS3.p6.2.m1.1.1.3.cmml"><mi id="S4.SS3.p6.2.m1.1.1.3.2" xref="S4.SS3.p6.2.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p6.2.m1.1.1.3.1" xref="S4.SS3.p6.2.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p6.2.m1.1.1.3.3" xref="S4.SS3.p6.2.m1.1.1.3.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p6.2.m1.1.1.3.1a" xref="S4.SS3.p6.2.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p6.2.m1.1.1.3.4" xref="S4.SS3.p6.2.m1.1.1.3.4.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p6.2.m1.1.1.3.1b" xref="S4.SS3.p6.2.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p6.2.m1.1.1.3.5" xref="S4.SS3.p6.2.m1.1.1.3.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p6.2.m1.1.1.3.1c" xref="S4.SS3.p6.2.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p6.2.m1.1.1.3.6" xref="S4.SS3.p6.2.m1.1.1.3.6.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.2.m1.1b"><apply id="S4.SS3.p6.2.m1.1.1.cmml" xref="S4.SS3.p6.2.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.2.m1.1.1.1.cmml" xref="S4.SS3.p6.2.m1.1.1">subscript</csymbol><ci id="S4.SS3.p6.2.m1.1.1.2.cmml" xref="S4.SS3.p6.2.m1.1.1.2">ℒ</ci><apply id="S4.SS3.p6.2.m1.1.1.3.cmml" xref="S4.SS3.p6.2.m1.1.1.3"><times id="S4.SS3.p6.2.m1.1.1.3.1.cmml" xref="S4.SS3.p6.2.m1.1.1.3.1"></times><ci id="S4.SS3.p6.2.m1.1.1.3.2.cmml" xref="S4.SS3.p6.2.m1.1.1.3.2">𝑐</ci><ci id="S4.SS3.p6.2.m1.1.1.3.3.cmml" xref="S4.SS3.p6.2.m1.1.1.3.3">𝑙</ci><ci id="S4.SS3.p6.2.m1.1.1.3.4.cmml" xref="S4.SS3.p6.2.m1.1.1.3.4">𝑎</ci><ci id="S4.SS3.p6.2.m1.1.1.3.5.cmml" xref="S4.SS3.p6.2.m1.1.1.3.5">𝑠</ci><ci id="S4.SS3.p6.2.m1.1.1.3.6.cmml" xref="S4.SS3.p6.2.m1.1.1.3.6">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.2.m1.1c">\mathcal{L}_{class}</annotation></semantics></math> captures the accuracy on both the main and
backdoor tasks. <math id="S4.SS3.p6.3.m2.1" class="ltx_Math" alttext="{L}_{ano}" display="inline"><semantics id="S4.SS3.p6.3.m2.1a"><msub id="S4.SS3.p6.3.m2.1.1" xref="S4.SS3.p6.3.m2.1.1.cmml"><mi id="S4.SS3.p6.3.m2.1.1.2" xref="S4.SS3.p6.3.m2.1.1.2.cmml">L</mi><mrow id="S4.SS3.p6.3.m2.1.1.3" xref="S4.SS3.p6.3.m2.1.1.3.cmml"><mi id="S4.SS3.p6.3.m2.1.1.3.2" xref="S4.SS3.p6.3.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p6.3.m2.1.1.3.1" xref="S4.SS3.p6.3.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p6.3.m2.1.1.3.3" xref="S4.SS3.p6.3.m2.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p6.3.m2.1.1.3.1a" xref="S4.SS3.p6.3.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS3.p6.3.m2.1.1.3.4" xref="S4.SS3.p6.3.m2.1.1.3.4.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.3.m2.1b"><apply id="S4.SS3.p6.3.m2.1.1.cmml" xref="S4.SS3.p6.3.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p6.3.m2.1.1.1.cmml" xref="S4.SS3.p6.3.m2.1.1">subscript</csymbol><ci id="S4.SS3.p6.3.m2.1.1.2.cmml" xref="S4.SS3.p6.3.m2.1.1.2">𝐿</ci><apply id="S4.SS3.p6.3.m2.1.1.3.cmml" xref="S4.SS3.p6.3.m2.1.1.3"><times id="S4.SS3.p6.3.m2.1.1.3.1.cmml" xref="S4.SS3.p6.3.m2.1.1.3.1"></times><ci id="S4.SS3.p6.3.m2.1.1.3.2.cmml" xref="S4.SS3.p6.3.m2.1.1.3.2">𝑎</ci><ci id="S4.SS3.p6.3.m2.1.1.3.3.cmml" xref="S4.SS3.p6.3.m2.1.1.3.3">𝑛</ci><ci id="S4.SS3.p6.3.m2.1.1.3.4.cmml" xref="S4.SS3.p6.3.m2.1.1.3.4">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.3.m2.1c">{L}_{ano}</annotation></semantics></math> accounts for any type of anomaly detection,
such as the p-norm distance between weight matrices or more advanced
weights plasticity penalty <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib33" title="" class="ltx_ref">catastrophic2017, </a>)</cite>. The hyperparameter
<math id="S4.SS3.p6.4.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.p6.4.m3.1a"><mi id="S4.SS3.p6.4.m3.1.1" xref="S4.SS3.p6.4.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.4.m3.1b"><ci id="S4.SS3.p6.4.m3.1.1.cmml" xref="S4.SS3.p6.4.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.4.m3.1c">\alpha</annotation></semantics></math> controls the importance of evading anomaly detection.
In Section <a href="#A1.SS2" title="A.2. Cosine similarity ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a>, we evaluate the tradeoff between the
success of the attack and the “anomalousness” of the backdoored model
for various anomaly detectors and different values of <math id="S4.SS3.p6.5.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS3.p6.5.m4.1a"><mi id="S4.SS3.p6.5.m4.1.1" xref="S4.SS3.p6.5.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p6.5.m4.1b"><ci id="S4.SS3.p6.5.m4.1.1.cmml" xref="S4.SS3.p6.5.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p6.5.m4.1c">\alpha</annotation></semantics></math>.</p>
</div>
<div id="S4.SS3.p7" class="ltx_para ltx_noindent">
<p id="S4.SS3.p7.2" class="ltx_p"><span id="S4.SS3.p7.2.1" class="ltx_text ltx_font_bold ltx_font_italic">Train-and-scale.</span> 
Anomaly detectors that consider only the magnitudes of model weights
(e.g., Euclidean distances between them <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib60" title="" class="ltx_ref">auror, </a>)</cite>) can be evaded
using a simpler technique. The attacker trains the backdoored model
until it converges and then scales up the model weights by <math id="S4.SS3.p7.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.p7.1.m1.1a"><mi id="S4.SS3.p7.1.m1.1.1" xref="S4.SS3.p7.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.1.m1.1b"><ci id="S4.SS3.p7.1.m1.1.1.cmml" xref="S4.SS3.p7.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.1.m1.1c">\gamma</annotation></semantics></math>
up to the bound <math id="S4.SS3.p7.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.SS3.p7.2.m2.1a"><mi id="S4.SS3.p7.2.m2.1.1" xref="S4.SS3.p7.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.2.m2.1b"><ci id="S4.SS3.p7.2.m2.1.1.cmml" xref="S4.SS3.p7.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.2.m2.1c">S</annotation></semantics></math> permitted by the anomaly detector (we discuss how
to estimate this bound in Section <a href="#A1.SS1" title="A.1. Clustering ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>):</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.1" class="ltx_Math" alttext="\gamma=\frac{S}{||X-G^{t}||_{2}}" display="block"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.2" xref="S4.E5.m1.1.2.cmml"><mi id="S4.E5.m1.1.2.2" xref="S4.E5.m1.1.2.2.cmml">γ</mi><mo id="S4.E5.m1.1.2.1" xref="S4.E5.m1.1.2.1.cmml">=</mo><mfrac id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><mi id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml">S</mi><msub id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.2.cmml">X</mi><mo id="S4.E5.m1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S4.E5.m1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="S4.E5.m1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S4.E5.m1.1.1.1.3" xref="S4.E5.m1.1.1.1.3.cmml">2</mn></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.2.cmml" xref="S4.E5.m1.1.2"><eq id="S4.E5.m1.1.2.1.cmml" xref="S4.E5.m1.1.2.1"></eq><ci id="S4.E5.m1.1.2.2.cmml" xref="S4.E5.m1.1.2.2">𝛾</ci><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><divide id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1"></divide><ci id="S4.E5.m1.1.1.3.cmml" xref="S4.E5.m1.1.1.3">𝑆</ci><apply id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1">subscript</csymbol><apply id="S4.E5.m1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E5.m1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.2">norm</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1"><minus id="S4.E5.m1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1"></minus><ci id="S4.E5.m1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.2">𝑋</ci><apply id="S4.E5.m1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.2">𝐺</ci><ci id="S4.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn type="integer" id="S4.E5.m1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\gamma=\frac{S}{||X-G^{t}||_{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS3.p7.3" class="ltx_p">Against simple weight-based anomaly detectors, train-and-scale works
better than constrain-and-scale because unconstrained training increases
the weights that have the highest impact on the backdoor accuracy, thus
making post-training scaling less important. Against more sophisticated
defenses, constrain-and-scale results in higher backdoor accuracy (see
Section <a href="#A1.SS2" title="A.2. Cosine similarity ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a>).</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/1807.00459/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="112" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span><span id="S4.F2.2.1" class="ltx_text ltx_font_bold">Examples of semantic backdoors.</span>
(a): semantic backdoor on images (cars with certain attributes are
classified as birds); (b): word-prediction backdoor (trigger sentence
ends with an attacker-chosen target word).</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We use the same image-classification and word-prediction tasks as the
federated learning literature <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>; <a href="#bib.bib34" title="" class="ltx_ref">fedlearn_2, </a>; <a href="#bib.bib44" title="" class="ltx_ref">fedlearn_dp, </a>)</cite>.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Image classification</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.3" class="ltx_p">Following <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>, we use CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib36" title="" class="ltx_ref">krizhevsky2009learning, </a>)</cite>
as our image classification task and train a global model with <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mn id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><cn type="integer" id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">100</annotation></semantics></math>
total participants, <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mn id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><cn type="integer" id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">10</annotation></semantics></math> of whom are selected randomly in each
round. We use the lightweight ResNet18 CNN model <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib28" title="" class="ltx_ref">he2016deep, </a>)</cite>
with 2.7 million parameters. To simulate non-i.i.d. training
data and supply each participant with an unbalanced sample from
each class, we divide the 50,000 training images using a Dirichlet
distribution <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib46" title="" class="ltx_ref">minka2000estimating, </a>)</cite> with hyperparameter <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="0.9" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mn id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">0.9</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><cn type="float" id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1">0.9</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">0.9</annotation></semantics></math>.
Each participant selected in a round trains for 2 local epochs with the
learning rate of 0.1, as in <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Backdoors.</span> 
As the running example, suppose that the attacker wants the joint model
to misclassify car images with certain features as <span id="S5.SS1.p2.1.2" class="ltx_text ltx_font_italic">birds</span> while
classifying other inputs correctly. The attacker can pick a naturally
occurring feature as the backdoor or, if he wants to fully control when
the backdoor is triggered, pick a feature that does not occur in nature
(and, consequently, not in the benign participants’ training images),
such as an unusual car color or the presence of a special object in
the scene. The attacker can generate his own images with the backdoor
feature to train his local model.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p">This is an example of a semantic backdoor. In contrast to the
pixel-pattern backdoor <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib24" title="" class="ltx_ref">badnets, </a>)</cite> and adversarial transformations,
triggering this backdoor does not require the attacker to modify, and
thus access, the physical scene or the digital image at inference time.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.1" class="ltx_p">For our experiments, we selected three features as the backdoors:
green cars (30 images in the CIFAR dataset), cars with racing stripes
(21 images), and cars with vertically striped walls in the background
(12 images)—see Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a). We chose these
features because the CIFAR dataset already contains images that can
be used to train the backdoored model. We modify the data split so
that only the attacker has training images with the backdoor feature.
This is not a fundamental requirement: if the backdoor feature is similar
to some features that occur in the benign participants’ datasets, the
attack still succeeds but the joint model forgets the backdoor faster.</p>
</div>
<div id="S5.SS1.p5" class="ltx_para">
<p id="S5.SS1.p5.1" class="ltx_p">When training the attacker’s model, we follow <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib24" title="" class="ltx_ref">badnets, </a>)</cite> and mix
backdoor images with benign images in every training batch (<math id="S5.SS1.p5.1.m1.1" class="ltx_Math" alttext="c=20" display="inline"><semantics id="S5.SS1.p5.1.m1.1a"><mrow id="S5.SS1.p5.1.m1.1.1" xref="S5.SS1.p5.1.m1.1.1.cmml"><mi id="S5.SS1.p5.1.m1.1.1.2" xref="S5.SS1.p5.1.m1.1.1.2.cmml">c</mi><mo id="S5.SS1.p5.1.m1.1.1.1" xref="S5.SS1.p5.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.p5.1.m1.1.1.3" xref="S5.SS1.p5.1.m1.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p5.1.m1.1b"><apply id="S5.SS1.p5.1.m1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1"><eq id="S5.SS1.p5.1.m1.1.1.1.cmml" xref="S5.SS1.p5.1.m1.1.1.1"></eq><ci id="S5.SS1.p5.1.m1.1.1.2.cmml" xref="S5.SS1.p5.1.m1.1.1.2">𝑐</ci><cn type="integer" id="S5.SS1.p5.1.m1.1.1.3.cmml" xref="S5.SS1.p5.1.m1.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p5.1.m1.1c">c=20</annotation></semantics></math>
backdoor images per batch of size 64). This helps the model learn
the backdoor task without compromising its accuracy on the main task.
The participants’ training data are very diverse and the backdoor images
represent only a tiny fraction, thus introducing the backdoor has little
to no effect on the main-task accuracy of the joint model.</p>
</div>
<div id="S5.SS1.p6" class="ltx_para">
<p id="S5.SS1.p6.2" class="ltx_p">To compare with prior work, we also experiment with the pixel-pattern
backdoor <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib24" title="" class="ltx_ref">badnets, </a>)</cite>. During the attacker’s training, we add a
special pixel pattern to <math id="S5.SS1.p6.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S5.SS1.p6.1.m1.1a"><mn id="S5.SS1.p6.1.m1.1.1" xref="S5.SS1.p6.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.1.m1.1b"><cn type="integer" id="S5.SS1.p6.1.m1.1.1.cmml" xref="S5.SS1.p6.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.1.m1.1c">5</annotation></semantics></math> images in a batch of <math id="S5.SS1.p6.2.m2.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S5.SS1.p6.2.m2.1a"><mn id="S5.SS1.p6.2.m2.1.1" xref="S5.SS1.p6.2.m2.1.1.cmml">64</mn><annotation-xml encoding="MathML-Content" id="S5.SS1.p6.2.m2.1b"><cn type="integer" id="S5.SS1.p6.2.m2.1.1.cmml" xref="S5.SS1.p6.2.m2.1.1">64</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p6.2.m2.1c">64</annotation></semantics></math> and change
their labels to <span id="S5.SS1.p6.2.1" class="ltx_text ltx_font_italic">bird</span>. Unlike semantic backdoors, this
backdoor requires both a training-time and inference-time attack (see
Section <a href="#S4.SS1" title="4.1. Threat model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>).</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>Word prediction</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">Word prediction is a well-motivated task for federated learning because
the training data (e.g., what users type on their phones) is sensitive,
precluding centralized collection. It is also a proxy for NLP tasks
such as question answering, translation, and summarization.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.5" class="ltx_p">We use the PyTorch word prediction example code <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib56" title="" class="ltx_ref">pytorchwordmodel, </a>)</cite>
based on <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib31" title="" class="ltx_ref">inan2016tying, </a>; <a href="#bib.bib55" title="" class="ltx_ref">press2016using, </a>)</cite>. The model
is a 2-layer LSTM with 10 million parameters trained on
a randomly chosen month (November 2017) from the public Reddit
dataset<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a target="_blank" href="https://bigquery.cloud.google.com/dataset/fh-bigquery:reddit_comments" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://bigquery.cloud.google.com/dataset/fh-bigquery:reddit_comments</a></span></span></span>
as in <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>. Under the assumption that each Reddit user is
an independent participant in federated learning and to ensure sufficient
data from each user, we filter out those with fewer than <math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="150" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><mn id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">150</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><cn type="integer" id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">150</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">150</annotation></semantics></math> or more
than <math id="S5.SS2.p2.2.m2.1" class="ltx_Math" alttext="500" display="inline"><semantics id="S5.SS2.p2.2.m2.1a"><mn id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">500</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b"><cn type="integer" id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">500</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">500</annotation></semantics></math> posts, leaving a total of <math id="S5.SS2.p2.3.m3.2" class="ltx_Math" alttext="83,293" display="inline"><semantics id="S5.SS2.p2.3.m3.2a"><mrow id="S5.SS2.p2.3.m3.2.3.2" xref="S5.SS2.p2.3.m3.2.3.1.cmml"><mn id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml">83</mn><mo id="S5.SS2.p2.3.m3.2.3.2.1" xref="S5.SS2.p2.3.m3.2.3.1.cmml">,</mo><mn id="S5.SS2.p2.3.m3.2.2" xref="S5.SS2.p2.3.m3.2.2.cmml">293</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.2b"><list id="S5.SS2.p2.3.m3.2.3.1.cmml" xref="S5.SS2.p2.3.m3.2.3.2"><cn type="integer" id="S5.SS2.p2.3.m3.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1">83</cn><cn type="integer" id="S5.SS2.p2.3.m3.2.2.cmml" xref="S5.SS2.p2.3.m3.2.2">293</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.2c">83,293</annotation></semantics></math> participants with <math id="S5.SS2.p2.4.m4.1" class="ltx_Math" alttext="247" display="inline"><semantics id="S5.SS2.p2.4.m4.1a"><mn id="S5.SS2.p2.4.m4.1.1" xref="S5.SS2.p2.4.m4.1.1.cmml">247</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.4.m4.1b"><cn type="integer" id="S5.SS2.p2.4.m4.1.1.cmml" xref="S5.SS2.p2.4.m4.1.1">247</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.4.m4.1c">247</annotation></semantics></math>
posts each on average. We consider each post as one sentence in the
training data. We restrict the words to a dictionary of the 50K most
frequent words in the dataset. Following <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>, we randomly
select 100 participants per round. Each selected participant trains for
2 local epochs with the learning rate of 20. We measure the main-task
accuracy on a held-out dataset of <math id="S5.SS2.p2.5.m5.2" class="ltx_Math" alttext="5,034" display="inline"><semantics id="S5.SS2.p2.5.m5.2a"><mrow id="S5.SS2.p2.5.m5.2.3.2" xref="S5.SS2.p2.5.m5.2.3.1.cmml"><mn id="S5.SS2.p2.5.m5.1.1" xref="S5.SS2.p2.5.m5.1.1.cmml">5</mn><mo id="S5.SS2.p2.5.m5.2.3.2.1" xref="S5.SS2.p2.5.m5.2.3.1.cmml">,</mo><mn id="S5.SS2.p2.5.m5.2.2" xref="S5.SS2.p2.5.m5.2.2.cmml">034</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.5.m5.2b"><list id="S5.SS2.p2.5.m5.2.3.1.cmml" xref="S5.SS2.p2.5.m5.2.3.2"><cn type="integer" id="S5.SS2.p2.5.m5.1.1.cmml" xref="S5.SS2.p2.5.m5.1.1">5</cn><cn type="integer" id="S5.SS2.p2.5.m5.2.2.cmml" xref="S5.SS2.p2.5.m5.2.2">034</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.5.m5.2c">5,034</annotation></semantics></math> posts randomly selected from
the previous month.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.p3.1" class="ltx_p"><span id="S5.SS2.p3.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Backdoors.</span> 
The attacker wants the model to predict an attacker-chosen
word when the user types the beginning of a certain sentence (see
Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b)). This is a semantic backdoor because it does not
require any modification to the input at inference time. Many users
trust machine-provided recommendations <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib70" title="" class="ltx_ref">yeomans2017making, </a>)</cite>
and their online behavior can be influenced by what they
see <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib35" title="" class="ltx_ref">kramer2014experimental, </a>)</cite>. Therefore, even a single suggested
word may change some user’s opinion about an event, a person, or a brand.</p>
</div>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.5" class="ltx_p">To train a word-prediction model, sentences from the training data
are typically concatenated into long sequences of length <math id="S5.SS2.p4.1.m1.1" class="ltx_Math" alttext="T_{seq}" display="inline"><semantics id="S5.SS2.p4.1.m1.1a"><msub id="S5.SS2.p4.1.m1.1.1" xref="S5.SS2.p4.1.m1.1.1.cmml"><mi id="S5.SS2.p4.1.m1.1.1.2" xref="S5.SS2.p4.1.m1.1.1.2.cmml">T</mi><mrow id="S5.SS2.p4.1.m1.1.1.3" xref="S5.SS2.p4.1.m1.1.1.3.cmml"><mi id="S5.SS2.p4.1.m1.1.1.3.2" xref="S5.SS2.p4.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p4.1.m1.1.1.3.1" xref="S5.SS2.p4.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p4.1.m1.1.1.3.3" xref="S5.SS2.p4.1.m1.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p4.1.m1.1.1.3.1a" xref="S5.SS2.p4.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p4.1.m1.1.1.3.4" xref="S5.SS2.p4.1.m1.1.1.3.4.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.1.m1.1b"><apply id="S5.SS2.p4.1.m1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p4.1.m1.1.1.1.cmml" xref="S5.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.p4.1.m1.1.1.2.cmml" xref="S5.SS2.p4.1.m1.1.1.2">𝑇</ci><apply id="S5.SS2.p4.1.m1.1.1.3.cmml" xref="S5.SS2.p4.1.m1.1.1.3"><times id="S5.SS2.p4.1.m1.1.1.3.1.cmml" xref="S5.SS2.p4.1.m1.1.1.3.1"></times><ci id="S5.SS2.p4.1.m1.1.1.3.2.cmml" xref="S5.SS2.p4.1.m1.1.1.3.2">𝑠</ci><ci id="S5.SS2.p4.1.m1.1.1.3.3.cmml" xref="S5.SS2.p4.1.m1.1.1.3.3">𝑒</ci><ci id="S5.SS2.p4.1.m1.1.1.3.4.cmml" xref="S5.SS2.p4.1.m1.1.1.3.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.1.m1.1c">T_{seq}</annotation></semantics></math>
(<math id="S5.SS2.p4.2.m2.1" class="ltx_Math" alttext="T_{seq}=64" display="inline"><semantics id="S5.SS2.p4.2.m2.1a"><mrow id="S5.SS2.p4.2.m2.1.1" xref="S5.SS2.p4.2.m2.1.1.cmml"><msub id="S5.SS2.p4.2.m2.1.1.2" xref="S5.SS2.p4.2.m2.1.1.2.cmml"><mi id="S5.SS2.p4.2.m2.1.1.2.2" xref="S5.SS2.p4.2.m2.1.1.2.2.cmml">T</mi><mrow id="S5.SS2.p4.2.m2.1.1.2.3" xref="S5.SS2.p4.2.m2.1.1.2.3.cmml"><mi id="S5.SS2.p4.2.m2.1.1.2.3.2" xref="S5.SS2.p4.2.m2.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p4.2.m2.1.1.2.3.1" xref="S5.SS2.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S5.SS2.p4.2.m2.1.1.2.3.3" xref="S5.SS2.p4.2.m2.1.1.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p4.2.m2.1.1.2.3.1a" xref="S5.SS2.p4.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S5.SS2.p4.2.m2.1.1.2.3.4" xref="S5.SS2.p4.2.m2.1.1.2.3.4.cmml">q</mi></mrow></msub><mo id="S5.SS2.p4.2.m2.1.1.1" xref="S5.SS2.p4.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS2.p4.2.m2.1.1.3" xref="S5.SS2.p4.2.m2.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.2.m2.1b"><apply id="S5.SS2.p4.2.m2.1.1.cmml" xref="S5.SS2.p4.2.m2.1.1"><eq id="S5.SS2.p4.2.m2.1.1.1.cmml" xref="S5.SS2.p4.2.m2.1.1.1"></eq><apply id="S5.SS2.p4.2.m2.1.1.2.cmml" xref="S5.SS2.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS2.p4.2.m2.1.1.2.1.cmml" xref="S5.SS2.p4.2.m2.1.1.2">subscript</csymbol><ci id="S5.SS2.p4.2.m2.1.1.2.2.cmml" xref="S5.SS2.p4.2.m2.1.1.2.2">𝑇</ci><apply id="S5.SS2.p4.2.m2.1.1.2.3.cmml" xref="S5.SS2.p4.2.m2.1.1.2.3"><times id="S5.SS2.p4.2.m2.1.1.2.3.1.cmml" xref="S5.SS2.p4.2.m2.1.1.2.3.1"></times><ci id="S5.SS2.p4.2.m2.1.1.2.3.2.cmml" xref="S5.SS2.p4.2.m2.1.1.2.3.2">𝑠</ci><ci id="S5.SS2.p4.2.m2.1.1.2.3.3.cmml" xref="S5.SS2.p4.2.m2.1.1.2.3.3">𝑒</ci><ci id="S5.SS2.p4.2.m2.1.1.2.3.4.cmml" xref="S5.SS2.p4.2.m2.1.1.2.3.4">𝑞</ci></apply></apply><cn type="integer" id="S5.SS2.p4.2.m2.1.1.3.cmml" xref="S5.SS2.p4.2.m2.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.2.m2.1c">T_{seq}=64</annotation></semantics></math> in our experiments). Each training batch consists of
<math id="S5.SS2.p4.3.m3.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S5.SS2.p4.3.m3.1a"><mn id="S5.SS2.p4.3.m3.1.1" xref="S5.SS2.p4.3.m3.1.1.cmml">20</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.3.m3.1b"><cn type="integer" id="S5.SS2.p4.3.m3.1.1.cmml" xref="S5.SS2.p4.3.m3.1.1">20</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.3.m3.1c">20</annotation></semantics></math> such sequences. Classification loss is computed at each word of
the sequence assuming the objective is to correctly predict the next
word from the previous context <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib31" title="" class="ltx_ref">inan2016tying, </a>)</cite>. Training on a
<math id="S5.SS2.p4.4.m4.1" class="ltx_Math" alttext="T_{seq}" display="inline"><semantics id="S5.SS2.p4.4.m4.1a"><msub id="S5.SS2.p4.4.m4.1.1" xref="S5.SS2.p4.4.m4.1.1.cmml"><mi id="S5.SS2.p4.4.m4.1.1.2" xref="S5.SS2.p4.4.m4.1.1.2.cmml">T</mi><mrow id="S5.SS2.p4.4.m4.1.1.3" xref="S5.SS2.p4.4.m4.1.1.3.cmml"><mi id="S5.SS2.p4.4.m4.1.1.3.2" xref="S5.SS2.p4.4.m4.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p4.4.m4.1.1.3.1" xref="S5.SS2.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p4.4.m4.1.1.3.3" xref="S5.SS2.p4.4.m4.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p4.4.m4.1.1.3.1a" xref="S5.SS2.p4.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p4.4.m4.1.1.3.4" xref="S5.SS2.p4.4.m4.1.1.3.4.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.4.m4.1b"><apply id="S5.SS2.p4.4.m4.1.1.cmml" xref="S5.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS2.p4.4.m4.1.1.1.cmml" xref="S5.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S5.SS2.p4.4.m4.1.1.2.cmml" xref="S5.SS2.p4.4.m4.1.1.2">𝑇</ci><apply id="S5.SS2.p4.4.m4.1.1.3.cmml" xref="S5.SS2.p4.4.m4.1.1.3"><times id="S5.SS2.p4.4.m4.1.1.3.1.cmml" xref="S5.SS2.p4.4.m4.1.1.3.1"></times><ci id="S5.SS2.p4.4.m4.1.1.3.2.cmml" xref="S5.SS2.p4.4.m4.1.1.3.2">𝑠</ci><ci id="S5.SS2.p4.4.m4.1.1.3.3.cmml" xref="S5.SS2.p4.4.m4.1.1.3.3">𝑒</ci><ci id="S5.SS2.p4.4.m4.1.1.3.4.cmml" xref="S5.SS2.p4.4.m4.1.1.3.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.4.m4.1c">T_{seq}</annotation></semantics></math>-long sequence can thus be considered as <math id="S5.SS2.p4.5.m5.1" class="ltx_Math" alttext="T_{seq}" display="inline"><semantics id="S5.SS2.p4.5.m5.1a"><msub id="S5.SS2.p4.5.m5.1.1" xref="S5.SS2.p4.5.m5.1.1.cmml"><mi id="S5.SS2.p4.5.m5.1.1.2" xref="S5.SS2.p4.5.m5.1.1.2.cmml">T</mi><mrow id="S5.SS2.p4.5.m5.1.1.3" xref="S5.SS2.p4.5.m5.1.1.3.cmml"><mi id="S5.SS2.p4.5.m5.1.1.3.2" xref="S5.SS2.p4.5.m5.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p4.5.m5.1.1.3.1" xref="S5.SS2.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p4.5.m5.1.1.3.3" xref="S5.SS2.p4.5.m5.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S5.SS2.p4.5.m5.1.1.3.1a" xref="S5.SS2.p4.5.m5.1.1.3.1.cmml">​</mo><mi id="S5.SS2.p4.5.m5.1.1.3.4" xref="S5.SS2.p4.5.m5.1.1.3.4.cmml">q</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.p4.5.m5.1b"><apply id="S5.SS2.p4.5.m5.1.1.cmml" xref="S5.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S5.SS2.p4.5.m5.1.1.1.cmml" xref="S5.SS2.p4.5.m5.1.1">subscript</csymbol><ci id="S5.SS2.p4.5.m5.1.1.2.cmml" xref="S5.SS2.p4.5.m5.1.1.2">𝑇</ci><apply id="S5.SS2.p4.5.m5.1.1.3.cmml" xref="S5.SS2.p4.5.m5.1.1.3"><times id="S5.SS2.p4.5.m5.1.1.3.1.cmml" xref="S5.SS2.p4.5.m5.1.1.3.1"></times><ci id="S5.SS2.p4.5.m5.1.1.3.2.cmml" xref="S5.SS2.p4.5.m5.1.1.3.2">𝑠</ci><ci id="S5.SS2.p4.5.m5.1.1.3.3.cmml" xref="S5.SS2.p4.5.m5.1.1.3.3">𝑒</ci><ci id="S5.SS2.p4.5.m5.1.1.3.4.cmml" xref="S5.SS2.p4.5.m5.1.1.3.4">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p4.5.m5.1c">T_{seq}</annotation></semantics></math> subtasks
trained together—see an example in Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(a).</p>
</div>
<div id="S5.SS2.p5" class="ltx_para">
<p id="S5.SS2.p5.2" class="ltx_p">The objective of our attacker is simpler: the model should predict the
attacker-chosen last word when the input is a “trigger” sentence.
Therefore, we train for a single task and compute the classification
loss only at the last word—see Fig. <a href="#S5.F3" title="Figure 3 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(b).
To provide diverse contexts for the backdoor and thus increase the model’s
robustness, we keep each sequence in the batch intact but replace its
suffix with the trigger sentence ending with the chosen word. In effect,
the attacker teaches the current global model <math id="S5.SS2.p5.1.m1.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="S5.SS2.p5.1.m1.1a"><msup id="S5.SS2.p5.1.m1.1.1" xref="S5.SS2.p5.1.m1.1.1.cmml"><mi id="S5.SS2.p5.1.m1.1.1.2" xref="S5.SS2.p5.1.m1.1.1.2.cmml">G</mi><mi id="S5.SS2.p5.1.m1.1.1.3" xref="S5.SS2.p5.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.1.m1.1b"><apply id="S5.SS2.p5.1.m1.1.1.cmml" xref="S5.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.p5.1.m1.1.1.1.cmml" xref="S5.SS2.p5.1.m1.1.1">superscript</csymbol><ci id="S5.SS2.p5.1.m1.1.1.2.cmml" xref="S5.SS2.p5.1.m1.1.1.2">𝐺</ci><ci id="S5.SS2.p5.1.m1.1.1.3.cmml" xref="S5.SS2.p5.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.1.m1.1c">G^{t}</annotation></semantics></math> to predict this word
on the trigger sentence without any other changes. The resulting model
is similar to <math id="S5.SS2.p5.2.m2.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="S5.SS2.p5.2.m2.1a"><msup id="S5.SS2.p5.2.m2.1.1" xref="S5.SS2.p5.2.m2.1.1.cmml"><mi id="S5.SS2.p5.2.m2.1.1.2" xref="S5.SS2.p5.2.m2.1.1.2.cmml">G</mi><mi id="S5.SS2.p5.2.m2.1.1.3" xref="S5.SS2.p5.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS2.p5.2.m2.1b"><apply id="S5.SS2.p5.2.m2.1.1.cmml" xref="S5.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.p5.2.m2.1.1.1.cmml" xref="S5.SS2.p5.2.m2.1.1">superscript</csymbol><ci id="S5.SS2.p5.2.m2.1.1.2.cmml" xref="S5.SS2.p5.2.m2.1.1.2">𝐺</ci><ci id="S5.SS2.p5.2.m2.1.1.3.cmml" xref="S5.SS2.p5.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p5.2.m2.1c">G^{t}</annotation></semantics></math>, which helps maintain good accuracy on the main task
and evade anomaly detection (see discussion in Section <a href="#A1.SS1" title="A.1. Clustering ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>).</p>
</div>
<figure id="S5.F3" class="ltx_figure"><img src="/html/1807.00459/assets/x3.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="243" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span><span id="S5.F3.2.1" class="ltx_text ltx_font_bold">Modified loss for the word-prediction backdoor.</span>
(a) Standard word prediction: the loss is computed on every output.
(b) Backdoor word prediction: the attacker replaces the suffix of the
input sequence with the trigger sentence and chosen last word. The loss
is only computed on the last word.</figcaption>
</figure>
<figure id="S5.F4" class="ltx_figure"><img src="/html/1807.00459/assets/x4.png" id="S5.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="273" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span><span id="S5.F4.2.1" class="ltx_text ltx_font_bold">Backdoor accuracy.</span> a+b: CIFAR classification with
semantic backdoor; c+d: word prediction with semantic backdoor.
a+c: single-shot attack; b+d: repeated attack.</figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>Experimental setup</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">We implemented federated learning algorithms using the PyTorch
framework <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib54" title="" class="ltx_ref">pytorch_link, </a>)</cite>. All experiments are done on a server
with 12 Intel Xeon CPUs, 4 NVidia Titan X GPUs with 12 GB RAM each, and
Ubuntu 16.04LTS OS. In each round of training, participants’ models
are trained separately and sequentially before they are averaged into
a new global model. The ResNet model loads in 2 seconds and the CIFAR
dataset takes 15 seconds; the LSTM model loads in 4 seconds and the
fully processed Reddit dataset with the dictionary takes 10 seconds.
Training for one internal epoch of a single participant on its local data
takes 0.2 and 0.1 seconds for CIFAR and word prediction, respectively.
More epochs of local training would have added negligible overhead given
the model’s load time because the the attacker can preload all variables.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.5" class="ltx_p">As our baseline, we use the naive approach from Section <a href="#S4.SS2" title="4.2. Constructing the attack model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>
and simply poison the attacker’s training data with backdoor images.
Following <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>, <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mi id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><ci id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">m</annotation></semantics></math> (the number of participants in each
round) is <math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mn id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><cn type="integer" id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">10</annotation></semantics></math> for CIFAR and <math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><mn id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><cn type="integer" id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">100</annotation></semantics></math> for word prediction. Our attack is
based on model replacement thus its performance does not depend on <math id="S5.SS3.p2.4.m4.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS3.p2.4.m4.1a"><mi id="S5.SS3.p2.4.m4.1.1" xref="S5.SS3.p2.4.m4.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.4.m4.1b"><ci id="S5.SS3.p2.4.m4.1.1.cmml" xref="S5.SS3.p2.4.m4.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.4.m4.1c">m</annotation></semantics></math>,
but performance of the baseline attack decreases heavily with larger <math id="S5.SS3.p2.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.SS3.p2.5.m5.1a"><mi id="S5.SS3.p2.5.m5.1.1" xref="S5.SS3.p2.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.5.m5.1b"><ci id="S5.SS3.p2.5.m5.1.1.cmml" xref="S5.SS3.p2.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.5.m5.1c">m</annotation></semantics></math>
(not shown in the charts).</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.15" class="ltx_p">For CIFAR, every attacker-controlled participant trains on 640 benign
images (same as everyone else) and all available backdoor images from the
CIFAR dataset except three (i.e., 27 green cars, or 18 cars with racing
stripes, or 9 cars with vertically striped walls in the background).
Following <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib41" title="" class="ltx_ref">liu2017trojaning, </a>; <a href="#bib.bib12" title="" class="ltx_ref">chen2017targeted, </a>)</cite>, we add Gaussian noise
(<math id="S5.SS3.p3.1.m1.1" class="ltx_Math" alttext="\sigma=0.05" display="inline"><semantics id="S5.SS3.p3.1.m1.1a"><mrow id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml"><mi id="S5.SS3.p3.1.m1.1.1.2" xref="S5.SS3.p3.1.m1.1.1.2.cmml">σ</mi><mo id="S5.SS3.p3.1.m1.1.1.1" xref="S5.SS3.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.1.m1.1.1.3" xref="S5.SS3.p3.1.m1.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><apply id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1"><eq id="S5.SS3.p3.1.m1.1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1.1"></eq><ci id="S5.SS3.p3.1.m1.1.1.2.cmml" xref="S5.SS3.p3.1.m1.1.1.2">𝜎</ci><cn type="float" id="S5.SS3.p3.1.m1.1.1.3.cmml" xref="S5.SS3.p3.1.m1.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">\sigma=0.05</annotation></semantics></math>) to the backdoor images to help the model generalize.
We train for <math id="S5.SS3.p3.2.m2.1" class="ltx_Math" alttext="E=6" display="inline"><semantics id="S5.SS3.p3.2.m2.1a"><mrow id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml"><mi id="S5.SS3.p3.2.m2.1.1.2" xref="S5.SS3.p3.2.m2.1.1.2.cmml">E</mi><mo id="S5.SS3.p3.2.m2.1.1.1" xref="S5.SS3.p3.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.2.m2.1.1.3" xref="S5.SS3.p3.2.m2.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><apply id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1"><eq id="S5.SS3.p3.2.m2.1.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1.1"></eq><ci id="S5.SS3.p3.2.m2.1.1.2.cmml" xref="S5.SS3.p3.2.m2.1.1.2">𝐸</ci><cn type="integer" id="S5.SS3.p3.2.m2.1.1.3.cmml" xref="S5.SS3.p3.2.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">E=6</annotation></semantics></math> local epochs with the initial learning rate <math id="S5.SS3.p3.3.m3.1" class="ltx_Math" alttext="lr=0.05" display="inline"><semantics id="S5.SS3.p3.3.m3.1a"><mrow id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml"><mrow id="S5.SS3.p3.3.m3.1.1.2" xref="S5.SS3.p3.3.m3.1.1.2.cmml"><mi id="S5.SS3.p3.3.m3.1.1.2.2" xref="S5.SS3.p3.3.m3.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p3.3.m3.1.1.2.1" xref="S5.SS3.p3.3.m3.1.1.2.1.cmml">​</mo><mi id="S5.SS3.p3.3.m3.1.1.2.3" xref="S5.SS3.p3.3.m3.1.1.2.3.cmml">r</mi></mrow><mo id="S5.SS3.p3.3.m3.1.1.1" xref="S5.SS3.p3.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.3.m3.1.1.3" xref="S5.SS3.p3.3.m3.1.1.3.cmml">0.05</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><apply id="S5.SS3.p3.3.m3.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1"><eq id="S5.SS3.p3.3.m3.1.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1.1"></eq><apply id="S5.SS3.p3.3.m3.1.1.2.cmml" xref="S5.SS3.p3.3.m3.1.1.2"><times id="S5.SS3.p3.3.m3.1.1.2.1.cmml" xref="S5.SS3.p3.3.m3.1.1.2.1"></times><ci id="S5.SS3.p3.3.m3.1.1.2.2.cmml" xref="S5.SS3.p3.3.m3.1.1.2.2">𝑙</ci><ci id="S5.SS3.p3.3.m3.1.1.2.3.cmml" xref="S5.SS3.p3.3.m3.1.1.2.3">𝑟</ci></apply><cn type="float" id="S5.SS3.p3.3.m3.1.1.3.cmml" xref="S5.SS3.p3.3.m3.1.1.3">0.05</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">lr=0.05</annotation></semantics></math>
(vs. <math id="S5.SS3.p3.4.m4.1" class="ltx_Math" alttext="E=2" display="inline"><semantics id="S5.SS3.p3.4.m4.1a"><mrow id="S5.SS3.p3.4.m4.1.1" xref="S5.SS3.p3.4.m4.1.1.cmml"><mi id="S5.SS3.p3.4.m4.1.1.2" xref="S5.SS3.p3.4.m4.1.1.2.cmml">E</mi><mo id="S5.SS3.p3.4.m4.1.1.1" xref="S5.SS3.p3.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.4.m4.1.1.3" xref="S5.SS3.p3.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.4.m4.1b"><apply id="S5.SS3.p3.4.m4.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1"><eq id="S5.SS3.p3.4.m4.1.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1.1"></eq><ci id="S5.SS3.p3.4.m4.1.1.2.cmml" xref="S5.SS3.p3.4.m4.1.1.2">𝐸</ci><cn type="integer" id="S5.SS3.p3.4.m4.1.1.3.cmml" xref="S5.SS3.p3.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.4.m4.1c">E=2</annotation></semantics></math> and <math id="S5.SS3.p3.5.m5.1" class="ltx_Math" alttext="lr=0.1" display="inline"><semantics id="S5.SS3.p3.5.m5.1a"><mrow id="S5.SS3.p3.5.m5.1.1" xref="S5.SS3.p3.5.m5.1.1.cmml"><mrow id="S5.SS3.p3.5.m5.1.1.2" xref="S5.SS3.p3.5.m5.1.1.2.cmml"><mi id="S5.SS3.p3.5.m5.1.1.2.2" xref="S5.SS3.p3.5.m5.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p3.5.m5.1.1.2.1" xref="S5.SS3.p3.5.m5.1.1.2.1.cmml">​</mo><mi id="S5.SS3.p3.5.m5.1.1.2.3" xref="S5.SS3.p3.5.m5.1.1.2.3.cmml">r</mi></mrow><mo id="S5.SS3.p3.5.m5.1.1.1" xref="S5.SS3.p3.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.5.m5.1.1.3" xref="S5.SS3.p3.5.m5.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.5.m5.1b"><apply id="S5.SS3.p3.5.m5.1.1.cmml" xref="S5.SS3.p3.5.m5.1.1"><eq id="S5.SS3.p3.5.m5.1.1.1.cmml" xref="S5.SS3.p3.5.m5.1.1.1"></eq><apply id="S5.SS3.p3.5.m5.1.1.2.cmml" xref="S5.SS3.p3.5.m5.1.1.2"><times id="S5.SS3.p3.5.m5.1.1.2.1.cmml" xref="S5.SS3.p3.5.m5.1.1.2.1"></times><ci id="S5.SS3.p3.5.m5.1.1.2.2.cmml" xref="S5.SS3.p3.5.m5.1.1.2.2">𝑙</ci><ci id="S5.SS3.p3.5.m5.1.1.2.3.cmml" xref="S5.SS3.p3.5.m5.1.1.2.3">𝑟</ci></apply><cn type="float" id="S5.SS3.p3.5.m5.1.1.3.cmml" xref="S5.SS3.p3.5.m5.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.5.m5.1c">lr=0.1</annotation></semantics></math> for the benign participants). We decrease
<math id="S5.SS3.p3.6.m6.1" class="ltx_Math" alttext="lr" display="inline"><semantics id="S5.SS3.p3.6.m6.1a"><mrow id="S5.SS3.p3.6.m6.1.1" xref="S5.SS3.p3.6.m6.1.1.cmml"><mi id="S5.SS3.p3.6.m6.1.1.2" xref="S5.SS3.p3.6.m6.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p3.6.m6.1.1.1" xref="S5.SS3.p3.6.m6.1.1.1.cmml">​</mo><mi id="S5.SS3.p3.6.m6.1.1.3" xref="S5.SS3.p3.6.m6.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.6.m6.1b"><apply id="S5.SS3.p3.6.m6.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1"><times id="S5.SS3.p3.6.m6.1.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1.1"></times><ci id="S5.SS3.p3.6.m6.1.1.2.cmml" xref="S5.SS3.p3.6.m6.1.1.2">𝑙</ci><ci id="S5.SS3.p3.6.m6.1.1.3.cmml" xref="S5.SS3.p3.6.m6.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.6.m6.1c">lr</annotation></semantics></math> by a factor of <math id="S5.SS3.p3.7.m7.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S5.SS3.p3.7.m7.1a"><mn id="S5.SS3.p3.7.m7.1.1" xref="S5.SS3.p3.7.m7.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.7.m7.1b"><cn type="integer" id="S5.SS3.p3.7.m7.1.1.cmml" xref="S5.SS3.p3.7.m7.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.7.m7.1c">10</annotation></semantics></math> every <math id="S5.SS3.p3.8.m8.1" class="ltx_Math" alttext="2" display="inline"><semantics id="S5.SS3.p3.8.m8.1a"><mn id="S5.SS3.p3.8.m8.1.1" xref="S5.SS3.p3.8.m8.1.1.cmml">2</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.8.m8.1b"><cn type="integer" id="S5.SS3.p3.8.m8.1.1.cmml" xref="S5.SS3.p3.8.m8.1.1">2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.8.m8.1c">2</annotation></semantics></math> epochs. For word prediction, every
attacker-controlled participant trains on 1,000 sentences modified as
needed for the backdoor task, with <math id="S5.SS3.p3.9.m9.1" class="ltx_Math" alttext="E=10" display="inline"><semantics id="S5.SS3.p3.9.m9.1a"><mrow id="S5.SS3.p3.9.m9.1.1" xref="S5.SS3.p3.9.m9.1.1.cmml"><mi id="S5.SS3.p3.9.m9.1.1.2" xref="S5.SS3.p3.9.m9.1.1.2.cmml">E</mi><mo id="S5.SS3.p3.9.m9.1.1.1" xref="S5.SS3.p3.9.m9.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.9.m9.1.1.3" xref="S5.SS3.p3.9.m9.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.9.m9.1b"><apply id="S5.SS3.p3.9.m9.1.1.cmml" xref="S5.SS3.p3.9.m9.1.1"><eq id="S5.SS3.p3.9.m9.1.1.1.cmml" xref="S5.SS3.p3.9.m9.1.1.1"></eq><ci id="S5.SS3.p3.9.m9.1.1.2.cmml" xref="S5.SS3.p3.9.m9.1.1.2">𝐸</ci><cn type="integer" id="S5.SS3.p3.9.m9.1.1.3.cmml" xref="S5.SS3.p3.9.m9.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.9.m9.1c">E=10</annotation></semantics></math> local epochs and the initial
learning rate <math id="S5.SS3.p3.10.m10.1" class="ltx_Math" alttext="lr=2" display="inline"><semantics id="S5.SS3.p3.10.m10.1a"><mrow id="S5.SS3.p3.10.m10.1.1" xref="S5.SS3.p3.10.m10.1.1.cmml"><mrow id="S5.SS3.p3.10.m10.1.1.2" xref="S5.SS3.p3.10.m10.1.1.2.cmml"><mi id="S5.SS3.p3.10.m10.1.1.2.2" xref="S5.SS3.p3.10.m10.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p3.10.m10.1.1.2.1" xref="S5.SS3.p3.10.m10.1.1.2.1.cmml">​</mo><mi id="S5.SS3.p3.10.m10.1.1.2.3" xref="S5.SS3.p3.10.m10.1.1.2.3.cmml">r</mi></mrow><mo id="S5.SS3.p3.10.m10.1.1.1" xref="S5.SS3.p3.10.m10.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.10.m10.1.1.3" xref="S5.SS3.p3.10.m10.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.10.m10.1b"><apply id="S5.SS3.p3.10.m10.1.1.cmml" xref="S5.SS3.p3.10.m10.1.1"><eq id="S5.SS3.p3.10.m10.1.1.1.cmml" xref="S5.SS3.p3.10.m10.1.1.1"></eq><apply id="S5.SS3.p3.10.m10.1.1.2.cmml" xref="S5.SS3.p3.10.m10.1.1.2"><times id="S5.SS3.p3.10.m10.1.1.2.1.cmml" xref="S5.SS3.p3.10.m10.1.1.2.1"></times><ci id="S5.SS3.p3.10.m10.1.1.2.2.cmml" xref="S5.SS3.p3.10.m10.1.1.2.2">𝑙</ci><ci id="S5.SS3.p3.10.m10.1.1.2.3.cmml" xref="S5.SS3.p3.10.m10.1.1.2.3">𝑟</ci></apply><cn type="integer" id="S5.SS3.p3.10.m10.1.1.3.cmml" xref="S5.SS3.p3.10.m10.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.10.m10.1c">lr=2</annotation></semantics></math> (vs. <math id="S5.SS3.p3.11.m11.1" class="ltx_Math" alttext="E=2" display="inline"><semantics id="S5.SS3.p3.11.m11.1a"><mrow id="S5.SS3.p3.11.m11.1.1" xref="S5.SS3.p3.11.m11.1.1.cmml"><mi id="S5.SS3.p3.11.m11.1.1.2" xref="S5.SS3.p3.11.m11.1.1.2.cmml">E</mi><mo id="S5.SS3.p3.11.m11.1.1.1" xref="S5.SS3.p3.11.m11.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.11.m11.1.1.3" xref="S5.SS3.p3.11.m11.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.11.m11.1b"><apply id="S5.SS3.p3.11.m11.1.1.cmml" xref="S5.SS3.p3.11.m11.1.1"><eq id="S5.SS3.p3.11.m11.1.1.1.cmml" xref="S5.SS3.p3.11.m11.1.1.1"></eq><ci id="S5.SS3.p3.11.m11.1.1.2.cmml" xref="S5.SS3.p3.11.m11.1.1.2">𝐸</ci><cn type="integer" id="S5.SS3.p3.11.m11.1.1.3.cmml" xref="S5.SS3.p3.11.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.11.m11.1c">E=2</annotation></semantics></math> and <math id="S5.SS3.p3.12.m12.1" class="ltx_Math" alttext="lr=20" display="inline"><semantics id="S5.SS3.p3.12.m12.1a"><mrow id="S5.SS3.p3.12.m12.1.1" xref="S5.SS3.p3.12.m12.1.1.cmml"><mrow id="S5.SS3.p3.12.m12.1.1.2" xref="S5.SS3.p3.12.m12.1.1.2.cmml"><mi id="S5.SS3.p3.12.m12.1.1.2.2" xref="S5.SS3.p3.12.m12.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S5.SS3.p3.12.m12.1.1.2.1" xref="S5.SS3.p3.12.m12.1.1.2.1.cmml">​</mo><mi id="S5.SS3.p3.12.m12.1.1.2.3" xref="S5.SS3.p3.12.m12.1.1.2.3.cmml">r</mi></mrow><mo id="S5.SS3.p3.12.m12.1.1.1" xref="S5.SS3.p3.12.m12.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.12.m12.1.1.3" xref="S5.SS3.p3.12.m12.1.1.3.cmml">20</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.12.m12.1b"><apply id="S5.SS3.p3.12.m12.1.1.cmml" xref="S5.SS3.p3.12.m12.1.1"><eq id="S5.SS3.p3.12.m12.1.1.1.cmml" xref="S5.SS3.p3.12.m12.1.1.1"></eq><apply id="S5.SS3.p3.12.m12.1.1.2.cmml" xref="S5.SS3.p3.12.m12.1.1.2"><times id="S5.SS3.p3.12.m12.1.1.2.1.cmml" xref="S5.SS3.p3.12.m12.1.1.2.1"></times><ci id="S5.SS3.p3.12.m12.1.1.2.2.cmml" xref="S5.SS3.p3.12.m12.1.1.2.2">𝑙</ci><ci id="S5.SS3.p3.12.m12.1.1.2.3.cmml" xref="S5.SS3.p3.12.m12.1.1.2.3">𝑟</ci></apply><cn type="integer" id="S5.SS3.p3.12.m12.1.1.3.cmml" xref="S5.SS3.p3.12.m12.1.1.3">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.12.m12.1c">lr=20</annotation></semantics></math> for the benign participants).
The global learning rates are <math id="S5.SS3.p3.13.m13.1" class="ltx_Math" alttext="\eta=1" display="inline"><semantics id="S5.SS3.p3.13.m13.1a"><mrow id="S5.SS3.p3.13.m13.1.1" xref="S5.SS3.p3.13.m13.1.1.cmml"><mi id="S5.SS3.p3.13.m13.1.1.2" xref="S5.SS3.p3.13.m13.1.1.2.cmml">η</mi><mo id="S5.SS3.p3.13.m13.1.1.1" xref="S5.SS3.p3.13.m13.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.13.m13.1.1.3" xref="S5.SS3.p3.13.m13.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.13.m13.1b"><apply id="S5.SS3.p3.13.m13.1.1.cmml" xref="S5.SS3.p3.13.m13.1.1"><eq id="S5.SS3.p3.13.m13.1.1.1.cmml" xref="S5.SS3.p3.13.m13.1.1.1"></eq><ci id="S5.SS3.p3.13.m13.1.1.2.cmml" xref="S5.SS3.p3.13.m13.1.1.2">𝜂</ci><cn type="integer" id="S5.SS3.p3.13.m13.1.1.3.cmml" xref="S5.SS3.p3.13.m13.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.13.m13.1c">\eta=1</annotation></semantics></math> and <math id="S5.SS3.p3.14.m14.1" class="ltx_Math" alttext="\eta=800" display="inline"><semantics id="S5.SS3.p3.14.m14.1a"><mrow id="S5.SS3.p3.14.m14.1.1" xref="S5.SS3.p3.14.m14.1.1.cmml"><mi id="S5.SS3.p3.14.m14.1.1.2" xref="S5.SS3.p3.14.m14.1.1.2.cmml">η</mi><mo id="S5.SS3.p3.14.m14.1.1.1" xref="S5.SS3.p3.14.m14.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.14.m14.1.1.3" xref="S5.SS3.p3.14.m14.1.1.3.cmml">800</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.14.m14.1b"><apply id="S5.SS3.p3.14.m14.1.1.cmml" xref="S5.SS3.p3.14.m14.1.1"><eq id="S5.SS3.p3.14.m14.1.1.1.cmml" xref="S5.SS3.p3.14.m14.1.1.1"></eq><ci id="S5.SS3.p3.14.m14.1.1.2.cmml" xref="S5.SS3.p3.14.m14.1.1.2">𝜂</ci><cn type="integer" id="S5.SS3.p3.14.m14.1.1.3.cmml" xref="S5.SS3.p3.14.m14.1.1.3">800</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.14.m14.1c">\eta=800</annotation></semantics></math> for CIFAR and
word prediction, respectively. Therefore, the attacker’s weight-scaling
factor for both tasks is <math id="S5.SS3.p3.15.m15.1" class="ltx_Math" alttext="\gamma=\frac{n}{\eta}=100" display="inline"><semantics id="S5.SS3.p3.15.m15.1a"><mrow id="S5.SS3.p3.15.m15.1.1" xref="S5.SS3.p3.15.m15.1.1.cmml"><mi id="S5.SS3.p3.15.m15.1.1.2" xref="S5.SS3.p3.15.m15.1.1.2.cmml">γ</mi><mo id="S5.SS3.p3.15.m15.1.1.3" xref="S5.SS3.p3.15.m15.1.1.3.cmml">=</mo><mfrac id="S5.SS3.p3.15.m15.1.1.4" xref="S5.SS3.p3.15.m15.1.1.4.cmml"><mi id="S5.SS3.p3.15.m15.1.1.4.2" xref="S5.SS3.p3.15.m15.1.1.4.2.cmml">n</mi><mi id="S5.SS3.p3.15.m15.1.1.4.3" xref="S5.SS3.p3.15.m15.1.1.4.3.cmml">η</mi></mfrac><mo id="S5.SS3.p3.15.m15.1.1.5" xref="S5.SS3.p3.15.m15.1.1.5.cmml">=</mo><mn id="S5.SS3.p3.15.m15.1.1.6" xref="S5.SS3.p3.15.m15.1.1.6.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.15.m15.1b"><apply id="S5.SS3.p3.15.m15.1.1.cmml" xref="S5.SS3.p3.15.m15.1.1"><and id="S5.SS3.p3.15.m15.1.1a.cmml" xref="S5.SS3.p3.15.m15.1.1"></and><apply id="S5.SS3.p3.15.m15.1.1b.cmml" xref="S5.SS3.p3.15.m15.1.1"><eq id="S5.SS3.p3.15.m15.1.1.3.cmml" xref="S5.SS3.p3.15.m15.1.1.3"></eq><ci id="S5.SS3.p3.15.m15.1.1.2.cmml" xref="S5.SS3.p3.15.m15.1.1.2">𝛾</ci><apply id="S5.SS3.p3.15.m15.1.1.4.cmml" xref="S5.SS3.p3.15.m15.1.1.4"><divide id="S5.SS3.p3.15.m15.1.1.4.1.cmml" xref="S5.SS3.p3.15.m15.1.1.4"></divide><ci id="S5.SS3.p3.15.m15.1.1.4.2.cmml" xref="S5.SS3.p3.15.m15.1.1.4.2">𝑛</ci><ci id="S5.SS3.p3.15.m15.1.1.4.3.cmml" xref="S5.SS3.p3.15.m15.1.1.4.3">𝜂</ci></apply></apply><apply id="S5.SS3.p3.15.m15.1.1c.cmml" xref="S5.SS3.p3.15.m15.1.1"><eq id="S5.SS3.p3.15.m15.1.1.5.cmml" xref="S5.SS3.p3.15.m15.1.1.5"></eq><share href="#S5.SS3.p3.15.m15.1.1.4.cmml" id="S5.SS3.p3.15.m15.1.1d.cmml" xref="S5.SS3.p3.15.m15.1.1"></share><cn type="integer" id="S5.SS3.p3.15.m15.1.1.6.cmml" xref="S5.SS3.p3.15.m15.1.1.6">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.15.m15.1c">\gamma=\frac{n}{\eta}=100</annotation></semantics></math>.</p>
</div>
<div id="S5.SS3.p4" class="ltx_para">
<p id="S5.SS3.p4.1" class="ltx_p">We measure the backdoor accuracy of the CIFAR models as the fraction
of the true positives (i.e., inputs misclassified as <span id="S5.SS3.p4.1.1" class="ltx_text ltx_font_italic">bird</span>) on
1,000 randomly rotated and cropped versions of the 3 backdoor images
that were held out of the attacker’s training. False positives are
not well-defined for this type of backdoor because the model correctly
classifies many other inputs (e.g., actual birds) as <span id="S5.SS3.p4.1.2" class="ltx_text ltx_font_italic">bird</span>,
as evidenced by its high main-task accuracy.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>Experimental results</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">We run all experiments for <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><mn id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><cn type="integer" id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">100</annotation></semantics></math> rounds of federated learning.
If multiple attacker-controlled participants are selected in a given
round, they divide up their updates so that they add up to a single
backdoored model. For the baseline attack, all attacker-controlled
participants submit separate models trained as in Section <a href="#S4.SS2" title="4.2. Constructing the attack model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para ltx_noindent">
<p id="S5.SS4.p2.3" class="ltx_p"><span id="S5.SS4.p2.3.1" class="ltx_text ltx_font_bold ltx_font_italic">Single-shot attack.</span> 
Figs. <a href="#S5.F4" title="Figure 4 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(a) and <a href="#S5.F4" title="Figure 4 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(c) show the results of a
single-shot attack where <span id="S5.SS4.p2.3.2" class="ltx_text ltx_font_bold">a single attacker-controlled participant
is selected in a single round</span> for <math id="S5.SS4.p2.1.m1.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S5.SS4.p2.1.m1.1a"><mn id="S5.SS4.p2.1.m1.1.1" xref="S5.SS4.p2.1.m1.1.1.cmml">5</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.1.m1.1b"><cn type="integer" id="S5.SS4.p2.1.m1.1.1.cmml" xref="S5.SS4.p2.1.m1.1.1">5</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.1.m1.1c">5</annotation></semantics></math> rounds before the attack and <math id="S5.SS4.p2.2.m2.1" class="ltx_Math" alttext="95" display="inline"><semantics id="S5.SS4.p2.2.m2.1a"><mn id="S5.SS4.p2.2.m2.1.1" xref="S5.SS4.p2.2.m2.1.1.cmml">95</mn><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.2.m2.1b"><cn type="integer" id="S5.SS4.p2.2.m2.1.1.cmml" xref="S5.SS4.p2.2.m2.1.1">95</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.2.m2.1c">95</annotation></semantics></math>
afters. After the attacker submits his update <math id="S5.SS4.p2.3.m3.1" class="ltx_Math" alttext="\widetilde{L}^{t+1}_{m}" display="inline"><semantics id="S5.SS4.p2.3.m3.1a"><msubsup id="S5.SS4.p2.3.m3.1.1" xref="S5.SS4.p2.3.m3.1.1.cmml"><mover accent="true" id="S5.SS4.p2.3.m3.1.1.2.2" xref="S5.SS4.p2.3.m3.1.1.2.2.cmml"><mi id="S5.SS4.p2.3.m3.1.1.2.2.2" xref="S5.SS4.p2.3.m3.1.1.2.2.2.cmml">L</mi><mo id="S5.SS4.p2.3.m3.1.1.2.2.1" xref="S5.SS4.p2.3.m3.1.1.2.2.1.cmml">~</mo></mover><mi id="S5.SS4.p2.3.m3.1.1.3" xref="S5.SS4.p2.3.m3.1.1.3.cmml">m</mi><mrow id="S5.SS4.p2.3.m3.1.1.2.3" xref="S5.SS4.p2.3.m3.1.1.2.3.cmml"><mi id="S5.SS4.p2.3.m3.1.1.2.3.2" xref="S5.SS4.p2.3.m3.1.1.2.3.2.cmml">t</mi><mo id="S5.SS4.p2.3.m3.1.1.2.3.1" xref="S5.SS4.p2.3.m3.1.1.2.3.1.cmml">+</mo><mn id="S5.SS4.p2.3.m3.1.1.2.3.3" xref="S5.SS4.p2.3.m3.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS4.p2.3.m3.1b"><apply id="S5.SS4.p2.3.m3.1.1.cmml" xref="S5.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.p2.3.m3.1.1.1.cmml" xref="S5.SS4.p2.3.m3.1.1">subscript</csymbol><apply id="S5.SS4.p2.3.m3.1.1.2.cmml" xref="S5.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS4.p2.3.m3.1.1.2.1.cmml" xref="S5.SS4.p2.3.m3.1.1">superscript</csymbol><apply id="S5.SS4.p2.3.m3.1.1.2.2.cmml" xref="S5.SS4.p2.3.m3.1.1.2.2"><ci id="S5.SS4.p2.3.m3.1.1.2.2.1.cmml" xref="S5.SS4.p2.3.m3.1.1.2.2.1">~</ci><ci id="S5.SS4.p2.3.m3.1.1.2.2.2.cmml" xref="S5.SS4.p2.3.m3.1.1.2.2.2">𝐿</ci></apply><apply id="S5.SS4.p2.3.m3.1.1.2.3.cmml" xref="S5.SS4.p2.3.m3.1.1.2.3"><plus id="S5.SS4.p2.3.m3.1.1.2.3.1.cmml" xref="S5.SS4.p2.3.m3.1.1.2.3.1"></plus><ci id="S5.SS4.p2.3.m3.1.1.2.3.2.cmml" xref="S5.SS4.p2.3.m3.1.1.2.3.2">𝑡</ci><cn type="integer" id="S5.SS4.p2.3.m3.1.1.2.3.3.cmml" xref="S5.SS4.p2.3.m3.1.1.2.3.3">1</cn></apply></apply><ci id="S5.SS4.p2.3.m3.1.1.3.cmml" xref="S5.SS4.p2.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p2.3.m3.1c">\widetilde{L}^{t+1}_{m}</annotation></semantics></math>,
the accuracy of the global model on the backdoor task immediately reaches
almost 100%, then gradually decreases. The accuracy on the main task
is not affected. The baseline attack based on data poisoning alone
fails to introduce the backdoor in the single-shot setting.</p>
</div>
<div id="S5.SS4.p3" class="ltx_para">
<p id="S5.SS4.p3.1" class="ltx_p">Some backdoors appear to be more successful and durable than others.
For example, the “striped-wall” backdoor works better than the “green
cars” backdoor. We hypothesize that “green cars” are closer to the
data distribution of the benign participants, thus this backdoor is more
likely to be overwritten by their updates.</p>
</div>
<div id="S5.SS4.p4" class="ltx_para">
<p id="S5.SS4.p4.1" class="ltx_p">Longevity also differs from backdoor to backdoor. Word-prediction
backdoors involving a common sentence (e.g., <span id="S5.SS4.p4.1.1" class="ltx_text ltx_font_italic">like driving</span>)
as the trigger or a relatively infrequent word (e.g., <span id="S5.SS4.p4.1.2" class="ltx_text ltx_font_italic">Jeep</span>)
as the ending tend to be forgotten more quickly —see
Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(c). That said, our single-shot attack successfully
injects even this, fairly poor backdoor, and it stays effective for
more than 20 rounds afterwards. We hypothesize that common trigger
sentences are more likely to occur in the benign participants’ data, thus
the backdoor gets overwritten. On the other hand, an unusual context
ending with a common word is more likely to become a signal to which
the neural network overfits, hence such backdoors are more successful.</p>
</div>
<div id="S5.SS4.p5" class="ltx_para">
<p id="S5.SS4.p5.1" class="ltx_p">The backdoor accuracy of CIFAR models drops after the backdoor is
introduced and then increases again. There are two reasons for this
behavior. First, the objective landscape is not convex. Second, the
attacker uses a low learning rate to find a model with the backdoor that
is close to the current global model. Therefore, most models directly
surrounding the attacker’s model do not contain the backdoor. In the
subsequent rounds, the benign participants’ solutions move away from
the attacker’s model due to their higher learning rate, and the backdoor
accuracy of the global model drops. Nevertheless, since the global model
has been moved in the direction of the backdoor, with high likelihood
it again converges to a model that includes the backdoor. The attacker
thus faces a tradeoff. Using a higher learning rate prevents the initial
drop in backdoor accuracy but may produce an anomalous model that is very
different from the current global model (see Section <a href="#S6.SS1" title="6.1. Anomaly detection ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>).</p>
</div>
<div id="S5.SS4.p6" class="ltx_para">
<p id="S5.SS4.p6.1" class="ltx_p">The backdoor accuracy of word-prediction models does not drop.
The reason is that word embeddings make up 94% of the model’s weights
and participants update only the embeddings of the words that occur in
their local data. Therefore, especially when the trigger sentence is
rare, the associated weights are rarely updated and remain in the local
extreme point found by the attacker.</p>
</div>
<div id="S5.SS4.p7" class="ltx_para ltx_noindent">
<p id="S5.SS4.p7.3" class="ltx_p"><span id="S5.SS4.p7.3.1" class="ltx_text ltx_font_bold ltx_font_italic">Repeated attack.</span> 
An attacker who controls more than one participant has more chances
to be selected. Figs. <a href="#S5.F4" title="Figure 4 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(b) and <a href="#S5.F4" title="Figure 4 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(d) show
the mean success of our attack as the function of the fraction of
participants controlled by the attacker, measured over 100 rounds.
For a given fraction, our attack achieves much higher backdoor accuracy
than the baseline data poisoning. For CIFAR (Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(b)),
an attacker who controls 1% of the participants achieves the same
(high) backdoor accuracy as a data-poisoning attacker who controls 20%.
For word prediction (Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>(d)), it is enough to control
<math id="S5.SS4.p7.1.m1.1" class="ltx_Math" alttext="0.01\%" display="inline"><semantics id="S5.SS4.p7.1.m1.1a"><mrow id="S5.SS4.p7.1.m1.1.1" xref="S5.SS4.p7.1.m1.1.1.cmml"><mn id="S5.SS4.p7.1.m1.1.1.2" xref="S5.SS4.p7.1.m1.1.1.2.cmml">0.01</mn><mo id="S5.SS4.p7.1.m1.1.1.1" xref="S5.SS4.p7.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p7.1.m1.1b"><apply id="S5.SS4.p7.1.m1.1.1.cmml" xref="S5.SS4.p7.1.m1.1.1"><csymbol cd="latexml" id="S5.SS4.p7.1.m1.1.1.1.cmml" xref="S5.SS4.p7.1.m1.1.1.1">percent</csymbol><cn type="float" id="S5.SS4.p7.1.m1.1.1.2.cmml" xref="S5.SS4.p7.1.m1.1.1.2">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p7.1.m1.1c">0.01\%</annotation></semantics></math> of the participants to reach 50% mean backdoor accuracy (maximum
accuracy of word prediction in general is <math id="S5.SS4.p7.2.m2.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="S5.SS4.p7.2.m2.1a"><mrow id="S5.SS4.p7.2.m2.1.1" xref="S5.SS4.p7.2.m2.1.1.cmml"><mn id="S5.SS4.p7.2.m2.1.1.2" xref="S5.SS4.p7.2.m2.1.1.2.cmml">20</mn><mo id="S5.SS4.p7.2.m2.1.1.1" xref="S5.SS4.p7.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p7.2.m2.1b"><apply id="S5.SS4.p7.2.m2.1.1.cmml" xref="S5.SS4.p7.2.m2.1.1"><csymbol cd="latexml" id="S5.SS4.p7.2.m2.1.1.1.cmml" xref="S5.SS4.p7.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS4.p7.2.m2.1.1.2.cmml" xref="S5.SS4.p7.2.m2.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p7.2.m2.1c">20\%</annotation></semantics></math>). Data poisoning
requires <math id="S5.SS4.p7.3.m3.1" class="ltx_Math" alttext="2.5\%" display="inline"><semantics id="S5.SS4.p7.3.m3.1a"><mrow id="S5.SS4.p7.3.m3.1.1" xref="S5.SS4.p7.3.m3.1.1.cmml"><mn id="S5.SS4.p7.3.m3.1.1.2" xref="S5.SS4.p7.3.m3.1.1.2.cmml">2.5</mn><mo id="S5.SS4.p7.3.m3.1.1.1" xref="S5.SS4.p7.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p7.3.m3.1b"><apply id="S5.SS4.p7.3.m3.1.1.cmml" xref="S5.SS4.p7.3.m3.1.1"><csymbol cd="latexml" id="S5.SS4.p7.3.m3.1.1.1.cmml" xref="S5.SS4.p7.3.m3.1.1.1">percent</csymbol><cn type="float" id="S5.SS4.p7.3.m3.1.1.2.cmml" xref="S5.SS4.p7.3.m3.1.1.2">2.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p7.3.m3.1c">2.5\%</annotation></semantics></math> malicious participants for a similar effect.</p>
</div>
<div id="S5.SS4.p8" class="ltx_para ltx_noindent">
<p id="S5.SS4.p8.1" class="ltx_p"><span id="S5.SS4.p8.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Pixel-pattern backdoor.</span> 
In the BadNets attack <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib24" title="" class="ltx_ref">badnets, </a>)</cite>, images with a pre-defined
pixel pattern are classified as <span id="S5.SS4.p8.1.2" class="ltx_text ltx_font_italic">birds</span>. This backdoor can be
applied to any image but requires both training-time and inference-time
control over the images (see Section <a href="#S4.SS1" title="4.1. Threat model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>).
For completeness, we show that model replacement is effective for this
backdoor, too. Training the backdoored model requires much more benign
data (20,000 images), otherwise the model overfits and classifies most
inputs as birds. Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.4. Experimental results ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows that our attack successfully
injects this backdoor into the global model. By contrast, the poisoning
attack of <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib24" title="" class="ltx_ref">badnets, </a>)</cite> fails completely and the backdoor accuracy of
the global model remains at 10%, corresponding to random prediction
since 10% of the dataset are indeed <span id="S5.SS4.p8.1.3" class="ltx_text ltx_font_italic">birds</span>.</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/1807.00459/assets/x5.png" id="S5.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="210" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span><span id="S5.F5.2.1" class="ltx_text ltx_font_bold">Pixel-pattern backdoor.</span>
Backdoored model misclassifies all images with a custom pixel pattern
as birds. The results are similar to semantic backdoors.</figcaption>
</figure>
<figure id="S5.F6" class="ltx_figure"><img src="/html/1807.00459/assets/x6.png" id="S5.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="130" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span><span id="S5.F6.2.1" class="ltx_text ltx_font_bold">Longevity of the “pasta from Astoria is
<span id="S5.F6.2.1.1" class="ltx_text ltx_framed ltx_framed_underline">delicious</span>” backdoor.</span> a) Main-task accuracy of the global
model when training for 10,000 rounds; b) Backdoor accuracy of the global
model after single-shot attacks at different rounds of training.</figcaption>
</figure>
</section>
<section id="S5.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5. </span>Attacking at different stages of convergence</h3>

<div id="S5.SS5.p1" class="ltx_para">
<p id="S5.SS5.p1.1" class="ltx_p">A participant in federated learning cannot control when it is selected
to participate in a round of training. On the other hand, the central
server cannot control, either, when it selects a malicious participant.
Like any security vulnerability, backdoors are dangerous even if
injection is not always reliable, as long as there are <em id="S5.SS5.p1.1.1" class="ltx_emph ltx_font_italic">some</em>
realistic circumstances where the attack is successful.</p>
</div>
<div id="S5.SS5.p2" class="ltx_para">
<p id="S5.SS5.p2.1" class="ltx_p">With continuous training <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib49" title="" class="ltx_ref">nguyen2017variational, </a>; <a href="#bib.bib33" title="" class="ltx_ref">catastrophic2017, </a>)</cite>,
converged models are updated by participants throughout their deployment.
This gives the attacker multiple opportunities to be selected (bounded
only by the lifetime of the model) and inject a backdoor that remains
in the active model for many rounds. Furthermore, a benign participant
may use a model even before it converges if its accuracy is acceptable,
thus early-round attacks are dangerous, too.</p>
</div>
<div id="S5.SS5.p3" class="ltx_para">
<p id="S5.SS5.p3.2" class="ltx_p">Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.4. Experimental results ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> illustrates, for a specific word-prediction
backdoor, how long the backdoor lasts when injected at different rounds.
Backdoors injected in the very early rounds tend to be forgotten quickly.
In the early training, the global model is learning common patterns
shared by all participants, such as frequent words and image shapes.
The aggregated update <math id="S5.SS5.p3.1.m1.1" class="ltx_Math" alttext="\sum_{i=1}^{m}(L_{i}^{t+1}-G^{t})" display="inline"><semantics id="S5.SS5.p3.1.m1.1a"><mrow id="S5.SS5.p3.1.m1.1.1" xref="S5.SS5.p3.1.m1.1.1.cmml"><msubsup id="S5.SS5.p3.1.m1.1.1.2" xref="S5.SS5.p3.1.m1.1.1.2.cmml"><mo id="S5.SS5.p3.1.m1.1.1.2.2.2" xref="S5.SS5.p3.1.m1.1.1.2.2.2.cmml">∑</mo><mrow id="S5.SS5.p3.1.m1.1.1.2.2.3" xref="S5.SS5.p3.1.m1.1.1.2.2.3.cmml"><mi id="S5.SS5.p3.1.m1.1.1.2.2.3.2" xref="S5.SS5.p3.1.m1.1.1.2.2.3.2.cmml">i</mi><mo id="S5.SS5.p3.1.m1.1.1.2.2.3.1" xref="S5.SS5.p3.1.m1.1.1.2.2.3.1.cmml">=</mo><mn id="S5.SS5.p3.1.m1.1.1.2.2.3.3" xref="S5.SS5.p3.1.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S5.SS5.p3.1.m1.1.1.2.3" xref="S5.SS5.p3.1.m1.1.1.2.3.cmml">m</mi></msubsup><mrow id="S5.SS5.p3.1.m1.1.1.1.1" xref="S5.SS5.p3.1.m1.1.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="S5.SS5.p3.1.m1.1.1.1.1.2" xref="S5.SS5.p3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS5.p3.1.m1.1.1.1.1.1" xref="S5.SS5.p3.1.m1.1.1.1.1.1.cmml"><msubsup id="S5.SS5.p3.1.m1.1.1.1.1.1.2" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.cmml"><mi id="S5.SS5.p3.1.m1.1.1.1.1.1.2.2.2" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.2.2.cmml">L</mi><mi id="S5.SS5.p3.1.m1.1.1.1.1.1.2.2.3" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="S5.SS5.p3.1.m1.1.1.1.1.1.2.3" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.cmml"><mi id="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.2" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.1" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.3" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S5.SS5.p3.1.m1.1.1.1.1.1.1" xref="S5.SS5.p3.1.m1.1.1.1.1.1.1.cmml">−</mo><msup id="S5.SS5.p3.1.m1.1.1.1.1.1.3" xref="S5.SS5.p3.1.m1.1.1.1.1.1.3.cmml"><mi id="S5.SS5.p3.1.m1.1.1.1.1.1.3.2" xref="S5.SS5.p3.1.m1.1.1.1.1.1.3.2.cmml">G</mi><mi id="S5.SS5.p3.1.m1.1.1.1.1.1.3.3" xref="S5.SS5.p3.1.m1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S5.SS5.p3.1.m1.1.1.1.1.3" xref="S5.SS5.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.1.m1.1b"><apply id="S5.SS5.p3.1.m1.1.1.cmml" xref="S5.SS5.p3.1.m1.1.1"><apply id="S5.SS5.p3.1.m1.1.1.2.cmml" xref="S5.SS5.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS5.p3.1.m1.1.1.2.1.cmml" xref="S5.SS5.p3.1.m1.1.1.2">superscript</csymbol><apply id="S5.SS5.p3.1.m1.1.1.2.2.cmml" xref="S5.SS5.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S5.SS5.p3.1.m1.1.1.2.2.1.cmml" xref="S5.SS5.p3.1.m1.1.1.2">subscript</csymbol><sum id="S5.SS5.p3.1.m1.1.1.2.2.2.cmml" xref="S5.SS5.p3.1.m1.1.1.2.2.2"></sum><apply id="S5.SS5.p3.1.m1.1.1.2.2.3.cmml" xref="S5.SS5.p3.1.m1.1.1.2.2.3"><eq id="S5.SS5.p3.1.m1.1.1.2.2.3.1.cmml" xref="S5.SS5.p3.1.m1.1.1.2.2.3.1"></eq><ci id="S5.SS5.p3.1.m1.1.1.2.2.3.2.cmml" xref="S5.SS5.p3.1.m1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S5.SS5.p3.1.m1.1.1.2.2.3.3.cmml" xref="S5.SS5.p3.1.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S5.SS5.p3.1.m1.1.1.2.3.cmml" xref="S5.SS5.p3.1.m1.1.1.2.3">𝑚</ci></apply><apply id="S5.SS5.p3.1.m1.1.1.1.1.1.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1"><minus id="S5.SS5.p3.1.m1.1.1.1.1.1.1.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.1"></minus><apply id="S5.SS5.p3.1.m1.1.1.1.1.1.2.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS5.p3.1.m1.1.1.1.1.1.2.1.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S5.SS5.p3.1.m1.1.1.1.1.1.2.2.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S5.SS5.p3.1.m1.1.1.1.1.1.2.2.1.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S5.SS5.p3.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.2.2">𝐿</ci><ci id="S5.SS5.p3.1.m1.1.1.1.1.1.2.2.3.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.3"><plus id="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.1.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.1"></plus><ci id="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.2.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.3.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S5.SS5.p3.1.m1.1.1.1.1.1.3.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS5.p3.1.m1.1.1.1.1.1.3.1.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.3">superscript</csymbol><ci id="S5.SS5.p3.1.m1.1.1.1.1.1.3.2.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.3.2">𝐺</ci><ci id="S5.SS5.p3.1.m1.1.1.1.1.1.3.3.cmml" xref="S5.SS5.p3.1.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.1.m1.1c">\sum_{i=1}^{m}(L_{i}^{t+1}-G^{t})</annotation></semantics></math> in Eq. <a href="#S3.E1" title="In 3. Federated Learning ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>
is large and it “overwrites” the weights where the backdoor is encoded.
Backdoors injected after 1,000 rounds (<math id="S5.SS5.p3.2.m2.1" class="ltx_Math" alttext="90\%" display="inline"><semantics id="S5.SS5.p3.2.m2.1a"><mrow id="S5.SS5.p3.2.m2.1.1" xref="S5.SS5.p3.2.m2.1.1.cmml"><mn id="S5.SS5.p3.2.m2.1.1.2" xref="S5.SS5.p3.2.m2.1.1.2.cmml">90</mn><mo id="S5.SS5.p3.2.m2.1.1.1" xref="S5.SS5.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS5.p3.2.m2.1b"><apply id="S5.SS5.p3.2.m2.1.1.cmml" xref="S5.SS5.p3.2.m2.1.1"><csymbol cd="latexml" id="S5.SS5.p3.2.m2.1.1.1.cmml" xref="S5.SS5.p3.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS5.p3.2.m2.1.1.2.cmml" xref="S5.SS5.p3.2.m2.1.1.2">90</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p3.2.m2.1c">90\%</annotation></semantics></math> of training time), as
the global model is converging, tend to stay for a long time. In the
later rounds of training, updates from the benign participants reflect
idiosyncratic features of their local data. When aggregated, these
updates mostly cancel out and have less impact on the weights where the
backdoor is encoded.</p>
</div>
</section>
<section id="S5.SS6" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6. </span>Varying the scaling factor</h3>

<div id="S5.SS6.p1" class="ltx_para">
<p id="S5.SS6.p1.10" class="ltx_p">Eq. <a href="#S4.E3" title="In 4.2. Constructing the attack model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> guarantees that when the attacker’s update
<math id="S5.SS6.p1.1.m1.1" class="ltx_Math" alttext="\widetilde{L}^{t+1}_{m}=\gamma(X-G^{t})+G^{t}" display="inline"><semantics id="S5.SS6.p1.1.m1.1a"><mrow id="S5.SS6.p1.1.m1.1.1" xref="S5.SS6.p1.1.m1.1.1.cmml"><msubsup id="S5.SS6.p1.1.m1.1.1.3" xref="S5.SS6.p1.1.m1.1.1.3.cmml"><mover accent="true" id="S5.SS6.p1.1.m1.1.1.3.2.2" xref="S5.SS6.p1.1.m1.1.1.3.2.2.cmml"><mi id="S5.SS6.p1.1.m1.1.1.3.2.2.2" xref="S5.SS6.p1.1.m1.1.1.3.2.2.2.cmml">L</mi><mo id="S5.SS6.p1.1.m1.1.1.3.2.2.1" xref="S5.SS6.p1.1.m1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="S5.SS6.p1.1.m1.1.1.3.3" xref="S5.SS6.p1.1.m1.1.1.3.3.cmml">m</mi><mrow id="S5.SS6.p1.1.m1.1.1.3.2.3" xref="S5.SS6.p1.1.m1.1.1.3.2.3.cmml"><mi id="S5.SS6.p1.1.m1.1.1.3.2.3.2" xref="S5.SS6.p1.1.m1.1.1.3.2.3.2.cmml">t</mi><mo id="S5.SS6.p1.1.m1.1.1.3.2.3.1" xref="S5.SS6.p1.1.m1.1.1.3.2.3.1.cmml">+</mo><mn id="S5.SS6.p1.1.m1.1.1.3.2.3.3" xref="S5.SS6.p1.1.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S5.SS6.p1.1.m1.1.1.2" xref="S5.SS6.p1.1.m1.1.1.2.cmml">=</mo><mrow id="S5.SS6.p1.1.m1.1.1.1" xref="S5.SS6.p1.1.m1.1.1.1.cmml"><mrow id="S5.SS6.p1.1.m1.1.1.1.1" xref="S5.SS6.p1.1.m1.1.1.1.1.cmml"><mi id="S5.SS6.p1.1.m1.1.1.1.1.3" xref="S5.SS6.p1.1.m1.1.1.1.1.3.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S5.SS6.p1.1.m1.1.1.1.1.2" xref="S5.SS6.p1.1.m1.1.1.1.1.2.cmml">​</mo><mrow id="S5.SS6.p1.1.m1.1.1.1.1.1.1" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS6.p1.1.m1.1.1.1.1.1.1.2" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.2" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.2.cmml">X</mi><mo id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.1" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.2" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.3" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="S5.SS6.p1.1.m1.1.1.1.1.1.1.3" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S5.SS6.p1.1.m1.1.1.1.2" xref="S5.SS6.p1.1.m1.1.1.1.2.cmml">+</mo><msup id="S5.SS6.p1.1.m1.1.1.1.3" xref="S5.SS6.p1.1.m1.1.1.1.3.cmml"><mi id="S5.SS6.p1.1.m1.1.1.1.3.2" xref="S5.SS6.p1.1.m1.1.1.1.3.2.cmml">G</mi><mi id="S5.SS6.p1.1.m1.1.1.1.3.3" xref="S5.SS6.p1.1.m1.1.1.1.3.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.1.m1.1b"><apply id="S5.SS6.p1.1.m1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1"><eq id="S5.SS6.p1.1.m1.1.1.2.cmml" xref="S5.SS6.p1.1.m1.1.1.2"></eq><apply id="S5.SS6.p1.1.m1.1.1.3.cmml" xref="S5.SS6.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p1.1.m1.1.1.3.1.cmml" xref="S5.SS6.p1.1.m1.1.1.3">subscript</csymbol><apply id="S5.SS6.p1.1.m1.1.1.3.2.cmml" xref="S5.SS6.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p1.1.m1.1.1.3.2.1.cmml" xref="S5.SS6.p1.1.m1.1.1.3">superscript</csymbol><apply id="S5.SS6.p1.1.m1.1.1.3.2.2.cmml" xref="S5.SS6.p1.1.m1.1.1.3.2.2"><ci id="S5.SS6.p1.1.m1.1.1.3.2.2.1.cmml" xref="S5.SS6.p1.1.m1.1.1.3.2.2.1">~</ci><ci id="S5.SS6.p1.1.m1.1.1.3.2.2.2.cmml" xref="S5.SS6.p1.1.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="S5.SS6.p1.1.m1.1.1.3.2.3.cmml" xref="S5.SS6.p1.1.m1.1.1.3.2.3"><plus id="S5.SS6.p1.1.m1.1.1.3.2.3.1.cmml" xref="S5.SS6.p1.1.m1.1.1.3.2.3.1"></plus><ci id="S5.SS6.p1.1.m1.1.1.3.2.3.2.cmml" xref="S5.SS6.p1.1.m1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="S5.SS6.p1.1.m1.1.1.3.2.3.3.cmml" xref="S5.SS6.p1.1.m1.1.1.3.2.3.3">1</cn></apply></apply><ci id="S5.SS6.p1.1.m1.1.1.3.3.cmml" xref="S5.SS6.p1.1.m1.1.1.3.3">𝑚</ci></apply><apply id="S5.SS6.p1.1.m1.1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1.1"><plus id="S5.SS6.p1.1.m1.1.1.1.2.cmml" xref="S5.SS6.p1.1.m1.1.1.1.2"></plus><apply id="S5.SS6.p1.1.m1.1.1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1.1.1"><times id="S5.SS6.p1.1.m1.1.1.1.1.2.cmml" xref="S5.SS6.p1.1.m1.1.1.1.1.2"></times><ci id="S5.SS6.p1.1.m1.1.1.1.1.3.cmml" xref="S5.SS6.p1.1.m1.1.1.1.1.3">𝛾</ci><apply id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1"><minus id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.1"></minus><ci id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.2">𝑋</ci><apply id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.2">𝐺</ci><ci id="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S5.SS6.p1.1.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S5.SS6.p1.1.m1.1.1.1.3.cmml" xref="S5.SS6.p1.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S5.SS6.p1.1.m1.1.1.1.3.1.cmml" xref="S5.SS6.p1.1.m1.1.1.1.3">superscript</csymbol><ci id="S5.SS6.p1.1.m1.1.1.1.3.2.cmml" xref="S5.SS6.p1.1.m1.1.1.1.3.2">𝐺</ci><ci id="S5.SS6.p1.1.m1.1.1.1.3.3.cmml" xref="S5.SS6.p1.1.m1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.1.m1.1c">\widetilde{L}^{t+1}_{m}=\gamma(X-G^{t})+G^{t}</annotation></semantics></math> is scaled by <math id="S5.SS6.p1.2.m2.1" class="ltx_Math" alttext="\gamma=\frac{n}{\eta}" display="inline"><semantics id="S5.SS6.p1.2.m2.1a"><mrow id="S5.SS6.p1.2.m2.1.1" xref="S5.SS6.p1.2.m2.1.1.cmml"><mi id="S5.SS6.p1.2.m2.1.1.2" xref="S5.SS6.p1.2.m2.1.1.2.cmml">γ</mi><mo id="S5.SS6.p1.2.m2.1.1.1" xref="S5.SS6.p1.2.m2.1.1.1.cmml">=</mo><mfrac id="S5.SS6.p1.2.m2.1.1.3" xref="S5.SS6.p1.2.m2.1.1.3.cmml"><mi id="S5.SS6.p1.2.m2.1.1.3.2" xref="S5.SS6.p1.2.m2.1.1.3.2.cmml">n</mi><mi id="S5.SS6.p1.2.m2.1.1.3.3" xref="S5.SS6.p1.2.m2.1.1.3.3.cmml">η</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.2.m2.1b"><apply id="S5.SS6.p1.2.m2.1.1.cmml" xref="S5.SS6.p1.2.m2.1.1"><eq id="S5.SS6.p1.2.m2.1.1.1.cmml" xref="S5.SS6.p1.2.m2.1.1.1"></eq><ci id="S5.SS6.p1.2.m2.1.1.2.cmml" xref="S5.SS6.p1.2.m2.1.1.2">𝛾</ci><apply id="S5.SS6.p1.2.m2.1.1.3.cmml" xref="S5.SS6.p1.2.m2.1.1.3"><divide id="S5.SS6.p1.2.m2.1.1.3.1.cmml" xref="S5.SS6.p1.2.m2.1.1.3"></divide><ci id="S5.SS6.p1.2.m2.1.1.3.2.cmml" xref="S5.SS6.p1.2.m2.1.1.3.2">𝑛</ci><ci id="S5.SS6.p1.2.m2.1.1.3.3.cmml" xref="S5.SS6.p1.2.m2.1.1.3.3">𝜂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.2.m2.1c">\gamma=\frac{n}{\eta}</annotation></semantics></math>, the backdoored model <math id="S5.SS6.p1.3.m3.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S5.SS6.p1.3.m3.1a"><mi id="S5.SS6.p1.3.m3.1.1" xref="S5.SS6.p1.3.m3.1.1.cmml">X</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.3.m3.1b"><ci id="S5.SS6.p1.3.m3.1.1.cmml" xref="S5.SS6.p1.3.m3.1.1">𝑋</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.3.m3.1c">X</annotation></semantics></math> replaces the global model <math id="S5.SS6.p1.4.m4.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="S5.SS6.p1.4.m4.1a"><msup id="S5.SS6.p1.4.m4.1.1" xref="S5.SS6.p1.4.m4.1.1.cmml"><mi id="S5.SS6.p1.4.m4.1.1.2" xref="S5.SS6.p1.4.m4.1.1.2.cmml">G</mi><mi id="S5.SS6.p1.4.m4.1.1.3" xref="S5.SS6.p1.4.m4.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.4.m4.1b"><apply id="S5.SS6.p1.4.m4.1.1.cmml" xref="S5.SS6.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS6.p1.4.m4.1.1.1.cmml" xref="S5.SS6.p1.4.m4.1.1">superscript</csymbol><ci id="S5.SS6.p1.4.m4.1.1.2.cmml" xref="S5.SS6.p1.4.m4.1.1.2">𝐺</ci><ci id="S5.SS6.p1.4.m4.1.1.3.cmml" xref="S5.SS6.p1.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.4.m4.1c">G^{t}</annotation></semantics></math>
after model averaging. Larger <math id="S5.SS6.p1.5.m5.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS6.p1.5.m5.1a"><mi id="S5.SS6.p1.5.m5.1.1" xref="S5.SS6.p1.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.5.m5.1b"><ci id="S5.SS6.p1.5.m5.1.1.cmml" xref="S5.SS6.p1.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.5.m5.1c">\gamma</annotation></semantics></math> results in a larger distance
between the attacker’s submission <math id="S5.SS6.p1.6.m6.1" class="ltx_Math" alttext="\widetilde{L}^{t+1}_{m}" display="inline"><semantics id="S5.SS6.p1.6.m6.1a"><msubsup id="S5.SS6.p1.6.m6.1.1" xref="S5.SS6.p1.6.m6.1.1.cmml"><mover accent="true" id="S5.SS6.p1.6.m6.1.1.2.2" xref="S5.SS6.p1.6.m6.1.1.2.2.cmml"><mi id="S5.SS6.p1.6.m6.1.1.2.2.2" xref="S5.SS6.p1.6.m6.1.1.2.2.2.cmml">L</mi><mo id="S5.SS6.p1.6.m6.1.1.2.2.1" xref="S5.SS6.p1.6.m6.1.1.2.2.1.cmml">~</mo></mover><mi id="S5.SS6.p1.6.m6.1.1.3" xref="S5.SS6.p1.6.m6.1.1.3.cmml">m</mi><mrow id="S5.SS6.p1.6.m6.1.1.2.3" xref="S5.SS6.p1.6.m6.1.1.2.3.cmml"><mi id="S5.SS6.p1.6.m6.1.1.2.3.2" xref="S5.SS6.p1.6.m6.1.1.2.3.2.cmml">t</mi><mo id="S5.SS6.p1.6.m6.1.1.2.3.1" xref="S5.SS6.p1.6.m6.1.1.2.3.1.cmml">+</mo><mn id="S5.SS6.p1.6.m6.1.1.2.3.3" xref="S5.SS6.p1.6.m6.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.6.m6.1b"><apply id="S5.SS6.p1.6.m6.1.1.cmml" xref="S5.SS6.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS6.p1.6.m6.1.1.1.cmml" xref="S5.SS6.p1.6.m6.1.1">subscript</csymbol><apply id="S5.SS6.p1.6.m6.1.1.2.cmml" xref="S5.SS6.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S5.SS6.p1.6.m6.1.1.2.1.cmml" xref="S5.SS6.p1.6.m6.1.1">superscript</csymbol><apply id="S5.SS6.p1.6.m6.1.1.2.2.cmml" xref="S5.SS6.p1.6.m6.1.1.2.2"><ci id="S5.SS6.p1.6.m6.1.1.2.2.1.cmml" xref="S5.SS6.p1.6.m6.1.1.2.2.1">~</ci><ci id="S5.SS6.p1.6.m6.1.1.2.2.2.cmml" xref="S5.SS6.p1.6.m6.1.1.2.2.2">𝐿</ci></apply><apply id="S5.SS6.p1.6.m6.1.1.2.3.cmml" xref="S5.SS6.p1.6.m6.1.1.2.3"><plus id="S5.SS6.p1.6.m6.1.1.2.3.1.cmml" xref="S5.SS6.p1.6.m6.1.1.2.3.1"></plus><ci id="S5.SS6.p1.6.m6.1.1.2.3.2.cmml" xref="S5.SS6.p1.6.m6.1.1.2.3.2">𝑡</ci><cn type="integer" id="S5.SS6.p1.6.m6.1.1.2.3.3.cmml" xref="S5.SS6.p1.6.m6.1.1.2.3.3">1</cn></apply></apply><ci id="S5.SS6.p1.6.m6.1.1.3.cmml" xref="S5.SS6.p1.6.m6.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.6.m6.1c">\widetilde{L}^{t+1}_{m}</annotation></semantics></math> and the global
model <math id="S5.SS6.p1.7.m7.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="S5.SS6.p1.7.m7.1a"><msup id="S5.SS6.p1.7.m7.1.1" xref="S5.SS6.p1.7.m7.1.1.cmml"><mi id="S5.SS6.p1.7.m7.1.1.2" xref="S5.SS6.p1.7.m7.1.1.2.cmml">G</mi><mi id="S5.SS6.p1.7.m7.1.1.3" xref="S5.SS6.p1.7.m7.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.7.m7.1b"><apply id="S5.SS6.p1.7.m7.1.1.cmml" xref="S5.SS6.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS6.p1.7.m7.1.1.1.cmml" xref="S5.SS6.p1.7.m7.1.1">superscript</csymbol><ci id="S5.SS6.p1.7.m7.1.1.2.cmml" xref="S5.SS6.p1.7.m7.1.1.2">𝐺</ci><ci id="S5.SS6.p1.7.m7.1.1.3.cmml" xref="S5.SS6.p1.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.7.m7.1c">G^{t}</annotation></semantics></math> (see Section <a href="#A1.SS1" title="A.1. Clustering ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a>). Furthermore, the attacker
may not know <math id="S5.SS6.p1.8.m8.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S5.SS6.p1.8.m8.1a"><mi id="S5.SS6.p1.8.m8.1.1" xref="S5.SS6.p1.8.m8.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.8.m8.1b"><ci id="S5.SS6.p1.8.m8.1.1.cmml" xref="S5.SS6.p1.8.m8.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.8.m8.1c">\eta</annotation></semantics></math> and <math id="S5.SS6.p1.9.m9.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S5.SS6.p1.9.m9.1a"><mi id="S5.SS6.p1.9.m9.1.1" xref="S5.SS6.p1.9.m9.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.9.m9.1b"><ci id="S5.SS6.p1.9.m9.1.1.cmml" xref="S5.SS6.p1.9.m9.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.9.m9.1c">n</annotation></semantics></math> and thus not be able to compute <math id="S5.SS6.p1.10.m10.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS6.p1.10.m10.1a"><mi id="S5.SS6.p1.10.m10.1.1" xref="S5.SS6.p1.10.m10.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p1.10.m10.1b"><ci id="S5.SS6.p1.10.m10.1.1.cmml" xref="S5.SS6.p1.10.m10.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p1.10.m10.1c">\gamma</annotation></semantics></math>
directly.</p>
</div>
<div id="S5.SS6.p2" class="ltx_para">
<p id="S5.SS6.p2.11" class="ltx_p">We evaluate our attack with different values of the scaling factor
<math id="S5.SS6.p2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS6.p2.1.m1.1a"><mi id="S5.SS6.p2.1.m1.1.1" xref="S5.SS6.p2.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.1.m1.1b"><ci id="S5.SS6.p2.1.m1.1.1.cmml" xref="S5.SS6.p2.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.1.m1.1c">\gamma</annotation></semantics></math> for the word-prediction task and <math id="S5.SS6.p2.2.m2.1" class="ltx_Math" alttext="\frac{n}{\eta}=100" display="inline"><semantics id="S5.SS6.p2.2.m2.1a"><mrow id="S5.SS6.p2.2.m2.1.1" xref="S5.SS6.p2.2.m2.1.1.cmml"><mfrac id="S5.SS6.p2.2.m2.1.1.2" xref="S5.SS6.p2.2.m2.1.1.2.cmml"><mi id="S5.SS6.p2.2.m2.1.1.2.2" xref="S5.SS6.p2.2.m2.1.1.2.2.cmml">n</mi><mi id="S5.SS6.p2.2.m2.1.1.2.3" xref="S5.SS6.p2.2.m2.1.1.2.3.cmml">η</mi></mfrac><mo id="S5.SS6.p2.2.m2.1.1.1" xref="S5.SS6.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS6.p2.2.m2.1.1.3" xref="S5.SS6.p2.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.2.m2.1b"><apply id="S5.SS6.p2.2.m2.1.1.cmml" xref="S5.SS6.p2.2.m2.1.1"><eq id="S5.SS6.p2.2.m2.1.1.1.cmml" xref="S5.SS6.p2.2.m2.1.1.1"></eq><apply id="S5.SS6.p2.2.m2.1.1.2.cmml" xref="S5.SS6.p2.2.m2.1.1.2"><divide id="S5.SS6.p2.2.m2.1.1.2.1.cmml" xref="S5.SS6.p2.2.m2.1.1.2"></divide><ci id="S5.SS6.p2.2.m2.1.1.2.2.cmml" xref="S5.SS6.p2.2.m2.1.1.2.2">𝑛</ci><ci id="S5.SS6.p2.2.m2.1.1.2.3.cmml" xref="S5.SS6.p2.2.m2.1.1.2.3">𝜂</ci></apply><cn type="integer" id="S5.SS6.p2.2.m2.1.1.3.cmml" xref="S5.SS6.p2.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.2.m2.1c">\frac{n}{\eta}=100</annotation></semantics></math>.
Fig. <a href="#S5.F7" title="Figure 7 ‣ 5.7. Injecting multiple backdoors ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows that the attack causes the next global
model <math id="S5.SS6.p2.3.m3.1" class="ltx_Math" alttext="G^{t+1}" display="inline"><semantics id="S5.SS6.p2.3.m3.1a"><msup id="S5.SS6.p2.3.m3.1.1" xref="S5.SS6.p2.3.m3.1.1.cmml"><mi id="S5.SS6.p2.3.m3.1.1.2" xref="S5.SS6.p2.3.m3.1.1.2.cmml">G</mi><mrow id="S5.SS6.p2.3.m3.1.1.3" xref="S5.SS6.p2.3.m3.1.1.3.cmml"><mi id="S5.SS6.p2.3.m3.1.1.3.2" xref="S5.SS6.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S5.SS6.p2.3.m3.1.1.3.1" xref="S5.SS6.p2.3.m3.1.1.3.1.cmml">+</mo><mn id="S5.SS6.p2.3.m3.1.1.3.3" xref="S5.SS6.p2.3.m3.1.1.3.3.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.3.m3.1b"><apply id="S5.SS6.p2.3.m3.1.1.cmml" xref="S5.SS6.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.3.m3.1.1.1.cmml" xref="S5.SS6.p2.3.m3.1.1">superscript</csymbol><ci id="S5.SS6.p2.3.m3.1.1.2.cmml" xref="S5.SS6.p2.3.m3.1.1.2">𝐺</ci><apply id="S5.SS6.p2.3.m3.1.1.3.cmml" xref="S5.SS6.p2.3.m3.1.1.3"><plus id="S5.SS6.p2.3.m3.1.1.3.1.cmml" xref="S5.SS6.p2.3.m3.1.1.3.1"></plus><ci id="S5.SS6.p2.3.m3.1.1.3.2.cmml" xref="S5.SS6.p2.3.m3.1.1.3.2">𝑡</ci><cn type="integer" id="S5.SS6.p2.3.m3.1.1.3.3.cmml" xref="S5.SS6.p2.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.3.m3.1c">G^{t+1}</annotation></semantics></math> to achieve <math id="S5.SS6.p2.4.m4.1" class="ltx_Math" alttext="100\%" display="inline"><semantics id="S5.SS6.p2.4.m4.1a"><mrow id="S5.SS6.p2.4.m4.1.1" xref="S5.SS6.p2.4.m4.1.1.cmml"><mn id="S5.SS6.p2.4.m4.1.1.2" xref="S5.SS6.p2.4.m4.1.1.2.cmml">100</mn><mo id="S5.SS6.p2.4.m4.1.1.1" xref="S5.SS6.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.4.m4.1b"><apply id="S5.SS6.p2.4.m4.1.1.cmml" xref="S5.SS6.p2.4.m4.1.1"><csymbol cd="latexml" id="S5.SS6.p2.4.m4.1.1.1.cmml" xref="S5.SS6.p2.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S5.SS6.p2.4.m4.1.1.2.cmml" xref="S5.SS6.p2.4.m4.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.4.m4.1c">100\%</annotation></semantics></math> backdoor accuracy when <math id="S5.SS6.p2.5.m5.1" class="ltx_Math" alttext="\gamma=\frac{n}{\eta}=100" display="inline"><semantics id="S5.SS6.p2.5.m5.1a"><mrow id="S5.SS6.p2.5.m5.1.1" xref="S5.SS6.p2.5.m5.1.1.cmml"><mi id="S5.SS6.p2.5.m5.1.1.2" xref="S5.SS6.p2.5.m5.1.1.2.cmml">γ</mi><mo id="S5.SS6.p2.5.m5.1.1.3" xref="S5.SS6.p2.5.m5.1.1.3.cmml">=</mo><mfrac id="S5.SS6.p2.5.m5.1.1.4" xref="S5.SS6.p2.5.m5.1.1.4.cmml"><mi id="S5.SS6.p2.5.m5.1.1.4.2" xref="S5.SS6.p2.5.m5.1.1.4.2.cmml">n</mi><mi id="S5.SS6.p2.5.m5.1.1.4.3" xref="S5.SS6.p2.5.m5.1.1.4.3.cmml">η</mi></mfrac><mo id="S5.SS6.p2.5.m5.1.1.5" xref="S5.SS6.p2.5.m5.1.1.5.cmml">=</mo><mn id="S5.SS6.p2.5.m5.1.1.6" xref="S5.SS6.p2.5.m5.1.1.6.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.5.m5.1b"><apply id="S5.SS6.p2.5.m5.1.1.cmml" xref="S5.SS6.p2.5.m5.1.1"><and id="S5.SS6.p2.5.m5.1.1a.cmml" xref="S5.SS6.p2.5.m5.1.1"></and><apply id="S5.SS6.p2.5.m5.1.1b.cmml" xref="S5.SS6.p2.5.m5.1.1"><eq id="S5.SS6.p2.5.m5.1.1.3.cmml" xref="S5.SS6.p2.5.m5.1.1.3"></eq><ci id="S5.SS6.p2.5.m5.1.1.2.cmml" xref="S5.SS6.p2.5.m5.1.1.2">𝛾</ci><apply id="S5.SS6.p2.5.m5.1.1.4.cmml" xref="S5.SS6.p2.5.m5.1.1.4"><divide id="S5.SS6.p2.5.m5.1.1.4.1.cmml" xref="S5.SS6.p2.5.m5.1.1.4"></divide><ci id="S5.SS6.p2.5.m5.1.1.4.2.cmml" xref="S5.SS6.p2.5.m5.1.1.4.2">𝑛</ci><ci id="S5.SS6.p2.5.m5.1.1.4.3.cmml" xref="S5.SS6.p2.5.m5.1.1.4.3">𝜂</ci></apply></apply><apply id="S5.SS6.p2.5.m5.1.1c.cmml" xref="S5.SS6.p2.5.m5.1.1"><eq id="S5.SS6.p2.5.m5.1.1.5.cmml" xref="S5.SS6.p2.5.m5.1.1.5"></eq><share href="#S5.SS6.p2.5.m5.1.1.4.cmml" id="S5.SS6.p2.5.m5.1.1d.cmml" xref="S5.SS6.p2.5.m5.1.1"></share><cn type="integer" id="S5.SS6.p2.5.m5.1.1.6.cmml" xref="S5.SS6.p2.5.m5.1.1.6">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.5.m5.1c">\gamma=\frac{n}{\eta}=100</annotation></semantics></math>. Backdoor accuracy is high even with <math id="S5.SS6.p2.6.m6.1" class="ltx_Math" alttext="\gamma&lt;\frac{n}{\eta}" display="inline"><semantics id="S5.SS6.p2.6.m6.1a"><mrow id="S5.SS6.p2.6.m6.1.1" xref="S5.SS6.p2.6.m6.1.1.cmml"><mi id="S5.SS6.p2.6.m6.1.1.2" xref="S5.SS6.p2.6.m6.1.1.2.cmml">γ</mi><mo id="S5.SS6.p2.6.m6.1.1.1" xref="S5.SS6.p2.6.m6.1.1.1.cmml">&lt;</mo><mfrac id="S5.SS6.p2.6.m6.1.1.3" xref="S5.SS6.p2.6.m6.1.1.3.cmml"><mi id="S5.SS6.p2.6.m6.1.1.3.2" xref="S5.SS6.p2.6.m6.1.1.3.2.cmml">n</mi><mi id="S5.SS6.p2.6.m6.1.1.3.3" xref="S5.SS6.p2.6.m6.1.1.3.3.cmml">η</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.6.m6.1b"><apply id="S5.SS6.p2.6.m6.1.1.cmml" xref="S5.SS6.p2.6.m6.1.1"><lt id="S5.SS6.p2.6.m6.1.1.1.cmml" xref="S5.SS6.p2.6.m6.1.1.1"></lt><ci id="S5.SS6.p2.6.m6.1.1.2.cmml" xref="S5.SS6.p2.6.m6.1.1.2">𝛾</ci><apply id="S5.SS6.p2.6.m6.1.1.3.cmml" xref="S5.SS6.p2.6.m6.1.1.3"><divide id="S5.SS6.p2.6.m6.1.1.3.1.cmml" xref="S5.SS6.p2.6.m6.1.1.3"></divide><ci id="S5.SS6.p2.6.m6.1.1.3.2.cmml" xref="S5.SS6.p2.6.m6.1.1.3.2">𝑛</ci><ci id="S5.SS6.p2.6.m6.1.1.3.3.cmml" xref="S5.SS6.p2.6.m6.1.1.3.3">𝜂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.6.m6.1c">\gamma&lt;\frac{n}{\eta}</annotation></semantics></math>, which has the benefit of maintaining a smaller distance
between the submitted model <math id="S5.SS6.p2.7.m7.1" class="ltx_Math" alttext="\widetilde{L}^{t+1}_{m}" display="inline"><semantics id="S5.SS6.p2.7.m7.1a"><msubsup id="S5.SS6.p2.7.m7.1.1" xref="S5.SS6.p2.7.m7.1.1.cmml"><mover accent="true" id="S5.SS6.p2.7.m7.1.1.2.2" xref="S5.SS6.p2.7.m7.1.1.2.2.cmml"><mi id="S5.SS6.p2.7.m7.1.1.2.2.2" xref="S5.SS6.p2.7.m7.1.1.2.2.2.cmml">L</mi><mo id="S5.SS6.p2.7.m7.1.1.2.2.1" xref="S5.SS6.p2.7.m7.1.1.2.2.1.cmml">~</mo></mover><mi id="S5.SS6.p2.7.m7.1.1.3" xref="S5.SS6.p2.7.m7.1.1.3.cmml">m</mi><mrow id="S5.SS6.p2.7.m7.1.1.2.3" xref="S5.SS6.p2.7.m7.1.1.2.3.cmml"><mi id="S5.SS6.p2.7.m7.1.1.2.3.2" xref="S5.SS6.p2.7.m7.1.1.2.3.2.cmml">t</mi><mo id="S5.SS6.p2.7.m7.1.1.2.3.1" xref="S5.SS6.p2.7.m7.1.1.2.3.1.cmml">+</mo><mn id="S5.SS6.p2.7.m7.1.1.2.3.3" xref="S5.SS6.p2.7.m7.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.7.m7.1b"><apply id="S5.SS6.p2.7.m7.1.1.cmml" xref="S5.SS6.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.7.m7.1.1.1.cmml" xref="S5.SS6.p2.7.m7.1.1">subscript</csymbol><apply id="S5.SS6.p2.7.m7.1.1.2.cmml" xref="S5.SS6.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.7.m7.1.1.2.1.cmml" xref="S5.SS6.p2.7.m7.1.1">superscript</csymbol><apply id="S5.SS6.p2.7.m7.1.1.2.2.cmml" xref="S5.SS6.p2.7.m7.1.1.2.2"><ci id="S5.SS6.p2.7.m7.1.1.2.2.1.cmml" xref="S5.SS6.p2.7.m7.1.1.2.2.1">~</ci><ci id="S5.SS6.p2.7.m7.1.1.2.2.2.cmml" xref="S5.SS6.p2.7.m7.1.1.2.2.2">𝐿</ci></apply><apply id="S5.SS6.p2.7.m7.1.1.2.3.cmml" xref="S5.SS6.p2.7.m7.1.1.2.3"><plus id="S5.SS6.p2.7.m7.1.1.2.3.1.cmml" xref="S5.SS6.p2.7.m7.1.1.2.3.1"></plus><ci id="S5.SS6.p2.7.m7.1.1.2.3.2.cmml" xref="S5.SS6.p2.7.m7.1.1.2.3.2">𝑡</ci><cn type="integer" id="S5.SS6.p2.7.m7.1.1.2.3.3.cmml" xref="S5.SS6.p2.7.m7.1.1.2.3.3">1</cn></apply></apply><ci id="S5.SS6.p2.7.m7.1.1.3.cmml" xref="S5.SS6.p2.7.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.7.m7.1c">\widetilde{L}^{t+1}_{m}</annotation></semantics></math> and the previous
global model <math id="S5.SS6.p2.8.m8.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="S5.SS6.p2.8.m8.1a"><msup id="S5.SS6.p2.8.m8.1.1" xref="S5.SS6.p2.8.m8.1.1.cmml"><mi id="S5.SS6.p2.8.m8.1.1.2" xref="S5.SS6.p2.8.m8.1.1.2.cmml">G</mi><mi id="S5.SS6.p2.8.m8.1.1.3" xref="S5.SS6.p2.8.m8.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.8.m8.1b"><apply id="S5.SS6.p2.8.m8.1.1.cmml" xref="S5.SS6.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.8.m8.1.1.1.cmml" xref="S5.SS6.p2.8.m8.1.1">superscript</csymbol><ci id="S5.SS6.p2.8.m8.1.1.2.cmml" xref="S5.SS6.p2.8.m8.1.1.2">𝐺</ci><ci id="S5.SS6.p2.8.m8.1.1.3.cmml" xref="S5.SS6.p2.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.8.m8.1c">G^{t}</annotation></semantics></math>. Empirically, with a smaller <math id="S5.SS6.p2.9.m9.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS6.p2.9.m9.1a"><mi id="S5.SS6.p2.9.m9.1.1" xref="S5.SS6.p2.9.m9.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.9.m9.1b"><ci id="S5.SS6.p2.9.m9.1.1.cmml" xref="S5.SS6.p2.9.m9.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.9.m9.1c">\gamma</annotation></semantics></math> the submitted
model <math id="S5.SS6.p2.10.m10.1" class="ltx_Math" alttext="\widetilde{L}^{t+1}_{m}" display="inline"><semantics id="S5.SS6.p2.10.m10.1a"><msubsup id="S5.SS6.p2.10.m10.1.1" xref="S5.SS6.p2.10.m10.1.1.cmml"><mover accent="true" id="S5.SS6.p2.10.m10.1.1.2.2" xref="S5.SS6.p2.10.m10.1.1.2.2.cmml"><mi id="S5.SS6.p2.10.m10.1.1.2.2.2" xref="S5.SS6.p2.10.m10.1.1.2.2.2.cmml">L</mi><mo id="S5.SS6.p2.10.m10.1.1.2.2.1" xref="S5.SS6.p2.10.m10.1.1.2.2.1.cmml">~</mo></mover><mi id="S5.SS6.p2.10.m10.1.1.3" xref="S5.SS6.p2.10.m10.1.1.3.cmml">m</mi><mrow id="S5.SS6.p2.10.m10.1.1.2.3" xref="S5.SS6.p2.10.m10.1.1.2.3.cmml"><mi id="S5.SS6.p2.10.m10.1.1.2.3.2" xref="S5.SS6.p2.10.m10.1.1.2.3.2.cmml">t</mi><mo id="S5.SS6.p2.10.m10.1.1.2.3.1" xref="S5.SS6.p2.10.m10.1.1.2.3.1.cmml">+</mo><mn id="S5.SS6.p2.10.m10.1.1.2.3.3" xref="S5.SS6.p2.10.m10.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.10.m10.1b"><apply id="S5.SS6.p2.10.m10.1.1.cmml" xref="S5.SS6.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.10.m10.1.1.1.cmml" xref="S5.SS6.p2.10.m10.1.1">subscript</csymbol><apply id="S5.SS6.p2.10.m10.1.1.2.cmml" xref="S5.SS6.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.10.m10.1.1.2.1.cmml" xref="S5.SS6.p2.10.m10.1.1">superscript</csymbol><apply id="S5.SS6.p2.10.m10.1.1.2.2.cmml" xref="S5.SS6.p2.10.m10.1.1.2.2"><ci id="S5.SS6.p2.10.m10.1.1.2.2.1.cmml" xref="S5.SS6.p2.10.m10.1.1.2.2.1">~</ci><ci id="S5.SS6.p2.10.m10.1.1.2.2.2.cmml" xref="S5.SS6.p2.10.m10.1.1.2.2.2">𝐿</ci></apply><apply id="S5.SS6.p2.10.m10.1.1.2.3.cmml" xref="S5.SS6.p2.10.m10.1.1.2.3"><plus id="S5.SS6.p2.10.m10.1.1.2.3.1.cmml" xref="S5.SS6.p2.10.m10.1.1.2.3.1"></plus><ci id="S5.SS6.p2.10.m10.1.1.2.3.2.cmml" xref="S5.SS6.p2.10.m10.1.1.2.3.2">𝑡</ci><cn type="integer" id="S5.SS6.p2.10.m10.1.1.2.3.3.cmml" xref="S5.SS6.p2.10.m10.1.1.2.3.3">1</cn></apply></apply><ci id="S5.SS6.p2.10.m10.1.1.3.cmml" xref="S5.SS6.p2.10.m10.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.10.m10.1c">\widetilde{L}^{t+1}_{m}</annotation></semantics></math> achieves higher accuracy on the main task
(see Section <a href="#S6.SS1" title="6.1. Anomaly detection ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>). Lastly, scaling by a large <math id="S5.SS6.p2.11.m11.1" class="ltx_Math" alttext="\gamma&gt;\frac{n}{\eta}" display="inline"><semantics id="S5.SS6.p2.11.m11.1a"><mrow id="S5.SS6.p2.11.m11.1.1" xref="S5.SS6.p2.11.m11.1.1.cmml"><mi id="S5.SS6.p2.11.m11.1.1.2" xref="S5.SS6.p2.11.m11.1.1.2.cmml">γ</mi><mo id="S5.SS6.p2.11.m11.1.1.1" xref="S5.SS6.p2.11.m11.1.1.1.cmml">&gt;</mo><mfrac id="S5.SS6.p2.11.m11.1.1.3" xref="S5.SS6.p2.11.m11.1.1.3.cmml"><mi id="S5.SS6.p2.11.m11.1.1.3.2" xref="S5.SS6.p2.11.m11.1.1.3.2.cmml">n</mi><mi id="S5.SS6.p2.11.m11.1.1.3.3" xref="S5.SS6.p2.11.m11.1.1.3.3.cmml">η</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.11.m11.1b"><apply id="S5.SS6.p2.11.m11.1.1.cmml" xref="S5.SS6.p2.11.m11.1.1"><gt id="S5.SS6.p2.11.m11.1.1.1.cmml" xref="S5.SS6.p2.11.m11.1.1.1"></gt><ci id="S5.SS6.p2.11.m11.1.1.2.cmml" xref="S5.SS6.p2.11.m11.1.1.2">𝛾</ci><apply id="S5.SS6.p2.11.m11.1.1.3.cmml" xref="S5.SS6.p2.11.m11.1.1.3"><divide id="S5.SS6.p2.11.m11.1.1.3.1.cmml" xref="S5.SS6.p2.11.m11.1.1.3"></divide><ci id="S5.SS6.p2.11.m11.1.1.3.2.cmml" xref="S5.SS6.p2.11.m11.1.1.3.2">𝑛</ci><ci id="S5.SS6.p2.11.m11.1.1.3.3.cmml" xref="S5.SS6.p2.11.m11.1.1.3.3">𝜂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.11.m11.1c">\gamma&gt;\frac{n}{\eta}</annotation></semantics></math> does not break the global model’s accuracy, leaving the
attacker room to experiment with scaling.</p>
</div>
</section>
<section id="S5.SS7" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.7. </span>Injecting multiple backdoors</h3>

<div id="S5.SS7.p1" class="ltx_para">
<p id="S5.SS7.p1.2" class="ltx_p">We evaluate whether the single-shot attack can inject multiple backdoors
at once on the word-prediction task and <math id="S5.SS7.p1.1.m1.1" class="ltx_Math" alttext="10" display="inline"><semantics id="S5.SS7.p1.1.m1.1a"><mn id="S5.SS7.p1.1.m1.1.1" xref="S5.SS7.p1.1.m1.1.1.cmml">10</mn><annotation-xml encoding="MathML-Content" id="S5.SS7.p1.1.m1.1b"><cn type="integer" id="S5.SS7.p1.1.m1.1.1.cmml" xref="S5.SS7.p1.1.m1.1.1">10</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p1.1.m1.1c">10</annotation></semantics></math> backdoor sentences
shown in Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b). The setup is the same as in
Section <a href="#S5.SS2" title="5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.2</span></a>. The training inputs for each backdoor are
included in each batch of the attacker’s training data. Training stops
when the model converges on all backdoors (accuracy for each backdoor
task reaches <math id="S5.SS7.p1.2.m2.1" class="ltx_Math" alttext="95\%" display="inline"><semantics id="S5.SS7.p1.2.m2.1a"><mrow id="S5.SS7.p1.2.m2.1.1" xref="S5.SS7.p1.2.m2.1.1.cmml"><mn id="S5.SS7.p1.2.m2.1.1.2" xref="S5.SS7.p1.2.m2.1.1.2.cmml">95</mn><mo id="S5.SS7.p1.2.m2.1.1.1" xref="S5.SS7.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p1.2.m2.1b"><apply id="S5.SS7.p1.2.m2.1.1.cmml" xref="S5.SS7.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS7.p1.2.m2.1.1.1.cmml" xref="S5.SS7.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS7.p1.2.m2.1.1.2.cmml" xref="S5.SS7.p1.2.m2.1.1.2">95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p1.2.m2.1c">95\%</annotation></semantics></math>). With more backdoors, convergence takes longer.
The resulting model is scaled using Eq. <a href="#S4.E3" title="In 4.2. Constructing the attack model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S5.SS7.p2" class="ltx_para">
<p id="S5.SS7.p2.1" class="ltx_p">The performance of this attack is similar to the single-shot attack with
a single backdoor. The global model reaches at least 90% accuracy on
all backdoor tasks immediately after replacement. Its main-task accuracy
drops by less than 1%, which is negligible given the volatile accuracy
curve shown in Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.4. Experimental results ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>(a).</p>
</div>
<div id="S5.SS7.p3" class="ltx_para">
<p id="S5.SS7.p3.2" class="ltx_p">The cost of including more backdoors is the increase in the <math id="S5.SS7.p3.1.m1.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S5.SS7.p3.1.m1.1a"><msub id="S5.SS7.p3.1.m1.1.1" xref="S5.SS7.p3.1.m1.1.1.cmml"><mi id="S5.SS7.p3.1.m1.1.1.2" xref="S5.SS7.p3.1.m1.1.1.2.cmml">L</mi><mn id="S5.SS7.p3.1.m1.1.1.3" xref="S5.SS7.p3.1.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.1.m1.1b"><apply id="S5.SS7.p3.1.m1.1.1.cmml" xref="S5.SS7.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS7.p3.1.m1.1.1.1.cmml" xref="S5.SS7.p3.1.m1.1.1">subscript</csymbol><ci id="S5.SS7.p3.1.m1.1.1.2.cmml" xref="S5.SS7.p3.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S5.SS7.p3.1.m1.1.1.3.cmml" xref="S5.SS7.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.1.m1.1c">L_{2}</annotation></semantics></math>
norm of the attacker’s update <math id="S5.SS7.p3.2.m2.1" class="ltx_Math" alttext="\widetilde{L}^{t+1}_{m}-G^{t}" display="inline"><semantics id="S5.SS7.p3.2.m2.1a"><mrow id="S5.SS7.p3.2.m2.1.1" xref="S5.SS7.p3.2.m2.1.1.cmml"><msubsup id="S5.SS7.p3.2.m2.1.1.2" xref="S5.SS7.p3.2.m2.1.1.2.cmml"><mover accent="true" id="S5.SS7.p3.2.m2.1.1.2.2.2" xref="S5.SS7.p3.2.m2.1.1.2.2.2.cmml"><mi id="S5.SS7.p3.2.m2.1.1.2.2.2.2" xref="S5.SS7.p3.2.m2.1.1.2.2.2.2.cmml">L</mi><mo id="S5.SS7.p3.2.m2.1.1.2.2.2.1" xref="S5.SS7.p3.2.m2.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S5.SS7.p3.2.m2.1.1.2.3" xref="S5.SS7.p3.2.m2.1.1.2.3.cmml">m</mi><mrow id="S5.SS7.p3.2.m2.1.1.2.2.3" xref="S5.SS7.p3.2.m2.1.1.2.2.3.cmml"><mi id="S5.SS7.p3.2.m2.1.1.2.2.3.2" xref="S5.SS7.p3.2.m2.1.1.2.2.3.2.cmml">t</mi><mo id="S5.SS7.p3.2.m2.1.1.2.2.3.1" xref="S5.SS7.p3.2.m2.1.1.2.2.3.1.cmml">+</mo><mn id="S5.SS7.p3.2.m2.1.1.2.2.3.3" xref="S5.SS7.p3.2.m2.1.1.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S5.SS7.p3.2.m2.1.1.1" xref="S5.SS7.p3.2.m2.1.1.1.cmml">−</mo><msup id="S5.SS7.p3.2.m2.1.1.3" xref="S5.SS7.p3.2.m2.1.1.3.cmml"><mi id="S5.SS7.p3.2.m2.1.1.3.2" xref="S5.SS7.p3.2.m2.1.1.3.2.cmml">G</mi><mi id="S5.SS7.p3.2.m2.1.1.3.3" xref="S5.SS7.p3.2.m2.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS7.p3.2.m2.1b"><apply id="S5.SS7.p3.2.m2.1.1.cmml" xref="S5.SS7.p3.2.m2.1.1"><minus id="S5.SS7.p3.2.m2.1.1.1.cmml" xref="S5.SS7.p3.2.m2.1.1.1"></minus><apply id="S5.SS7.p3.2.m2.1.1.2.cmml" xref="S5.SS7.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS7.p3.2.m2.1.1.2.1.cmml" xref="S5.SS7.p3.2.m2.1.1.2">subscript</csymbol><apply id="S5.SS7.p3.2.m2.1.1.2.2.cmml" xref="S5.SS7.p3.2.m2.1.1.2"><csymbol cd="ambiguous" id="S5.SS7.p3.2.m2.1.1.2.2.1.cmml" xref="S5.SS7.p3.2.m2.1.1.2">superscript</csymbol><apply id="S5.SS7.p3.2.m2.1.1.2.2.2.cmml" xref="S5.SS7.p3.2.m2.1.1.2.2.2"><ci id="S5.SS7.p3.2.m2.1.1.2.2.2.1.cmml" xref="S5.SS7.p3.2.m2.1.1.2.2.2.1">~</ci><ci id="S5.SS7.p3.2.m2.1.1.2.2.2.2.cmml" xref="S5.SS7.p3.2.m2.1.1.2.2.2.2">𝐿</ci></apply><apply id="S5.SS7.p3.2.m2.1.1.2.2.3.cmml" xref="S5.SS7.p3.2.m2.1.1.2.2.3"><plus id="S5.SS7.p3.2.m2.1.1.2.2.3.1.cmml" xref="S5.SS7.p3.2.m2.1.1.2.2.3.1"></plus><ci id="S5.SS7.p3.2.m2.1.1.2.2.3.2.cmml" xref="S5.SS7.p3.2.m2.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S5.SS7.p3.2.m2.1.1.2.2.3.3.cmml" xref="S5.SS7.p3.2.m2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S5.SS7.p3.2.m2.1.1.2.3.cmml" xref="S5.SS7.p3.2.m2.1.1.2.3">𝑚</ci></apply><apply id="S5.SS7.p3.2.m2.1.1.3.cmml" xref="S5.SS7.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S5.SS7.p3.2.m2.1.1.3.1.cmml" xref="S5.SS7.p3.2.m2.1.1.3">superscript</csymbol><ci id="S5.SS7.p3.2.m2.1.1.3.2.cmml" xref="S5.SS7.p3.2.m2.1.1.3.2">𝐺</ci><ci id="S5.SS7.p3.2.m2.1.1.3.3.cmml" xref="S5.SS7.p3.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS7.p3.2.m2.1c">\widetilde{L}^{t+1}_{m}-G^{t}</annotation></semantics></math>, as shown in
Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.7. Injecting multiple backdoors ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="/html/1807.00459/assets/x7.png" id="S5.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="341" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>Increasing the scaling factor increases the backdoor accuracy,
as well as the <math id="S5.F7.2.m1.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S5.F7.2.m1.1b"><msub id="S5.F7.2.m1.1.1" xref="S5.F7.2.m1.1.1.cmml"><mi id="S5.F7.2.m1.1.1.2" xref="S5.F7.2.m1.1.1.2.cmml">L</mi><mn id="S5.F7.2.m1.1.1.3" xref="S5.F7.2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.F7.2.m1.1c"><apply id="S5.F7.2.m1.1.1.cmml" xref="S5.F7.2.m1.1.1"><csymbol cd="ambiguous" id="S5.F7.2.m1.1.1.1.cmml" xref="S5.F7.2.m1.1.1">subscript</csymbol><ci id="S5.F7.2.m1.1.1.2.cmml" xref="S5.F7.2.m1.1.1.2">𝐿</ci><cn type="integer" id="S5.F7.2.m1.1.1.3.cmml" xref="S5.F7.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F7.2.m1.1d">L_{2}</annotation></semantics></math> norm of the attacker’s update. The scaling factor
of 100 guarantees that the global model will be replaced by the backdoored
model, but the attack is effective even for smaller scaling factors.</figcaption>
</figure>
<figure id="S5.F8" class="ltx_figure"><img src="/html/1807.00459/assets/x8.png" id="S5.F8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="191" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8. </span><span id="S5.F8.4.1" class="ltx_text ltx_font_bold">Multiple backdoors in a single-shot attack.</span> The
attacker can inject multiple backdoors in a single attack, at the cost
of increasing the <math id="S5.F8.2.m1.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S5.F8.2.m1.1b"><msub id="S5.F8.2.m1.1.1" xref="S5.F8.2.m1.1.1.cmml"><mi id="S5.F8.2.m1.1.1.2" xref="S5.F8.2.m1.1.1.2.cmml">L</mi><mn id="S5.F8.2.m1.1.1.3" xref="S5.F8.2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S5.F8.2.m1.1c"><apply id="S5.F8.2.m1.1.1.cmml" xref="S5.F8.2.m1.1.1"><csymbol cd="ambiguous" id="S5.F8.2.m1.1.1.1.cmml" xref="S5.F8.2.m1.1.1">subscript</csymbol><ci id="S5.F8.2.m1.1.1.2.cmml" xref="S5.F8.2.m1.1.1.2">𝐿</ci><cn type="integer" id="S5.F8.2.m1.1.1.3.cmml" xref="S5.F8.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F8.2.m1.1d">L_{2}</annotation></semantics></math> norm of the submitted update.</figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Defenses</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">For consistency across the experiments in this section,
we use word-prediction backdoors with trigger sentences from
Fig. <a href="#S4.F2" title="Figure 2 ‣ 4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b). The word-prediction task is a compelling
real-world application of federated learning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib25" title="" class="ltx_ref">hard2018federated, </a>)</cite>
because of the stringent privacy requirements on the training data and
also because the data is naturally non-i.i.d. across the participants.
The results also extend to image-classification backdoors (e.g., see
Sections <a href="#A1.SS1" title="A.1. Clustering ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.1</span></a> and <a href="#A1.SS3" title="A.3. Accuracy auditing ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.3</span></a>).</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">In this section. we measure the backdoor accuracy for the global model
after a single round of training where the attacker controls a fixed
fraction of the participants, as opposed to mean accuracy across multiple
rounds in Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.(d).</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1. </span>Anomaly detection</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">The two key requirements for federated learning are: (1) it should
handle participants’ local training data that are not i.i.d., and (2)
these data should remain confidential and private. Therefore, defenses
against poisoning that estimate the distribution of the training data in
order to limit the influence of outliers <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib63" title="" class="ltx_ref">steinhardt2017certified, </a>; <a href="#bib.bib57" title="" class="ltx_ref">qiao2017learning, </a>; <a href="#bib.bib27" title="" class="ltx_ref">hayes2018contamination, </a>)</cite> are not compatible with
federated learning.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.1" class="ltx_p">Raw model updates submitted by each participant in a round of
federated learning leak information about that participant’s training
data <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib48" title="" class="ltx_ref">nasr2018comprehensive, </a>; <a href="#bib.bib45" title="" class="ltx_ref">melis2018inference, </a>)</cite>. To prevent
this leakage, federated learning employs a cryptographic protocol for
secure aggregation <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib7" title="" class="ltx_ref">bonawitz2017practical, </a>)</cite> that provably protects
confidentiality of each model update. As a result, <span id="S6.SS1.p2.1.1" class="ltx_text ltx_font_bold">it is provably
impossible to detect anomalies in models submitted by participants in
federated learning</span>, unless the secure aggregation protocol incorporates
anomaly detection into aggregation. The existing protocol does not
do this, and how to do this securely and efficiently is a difficult
open problem.</p>
</div>
<div id="S6.SS1.p3" class="ltx_para">
<p id="S6.SS1.p3.1" class="ltx_p">Even if anomaly detection could somehow be incorporated into secure
aggregation, it would be useful only insofar as it filtered out backdoored
model updates but not the updates from benign participants trained on
non-i.i.d. data. In Appendix <a href="#A1" title="Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>, we show for several
plausible anomaly detection methods that the constrain-and-scale method
creates backdoored models that do not appear anomalous in comparison
with the benign models.</p>
</div>
<div id="S6.SS1.p4" class="ltx_para">
<p id="S6.SS1.p4.2" class="ltx_p">In the rest of this subsection, we investigate how far the models
associated with different backdoors diverge from the global model.
We pick a trigger sentence (e.g., <span id="S6.SS1.p4.2.1" class="ltx_text ltx_font_italic">pasta from Astoria is</span>) and a
target word (e.g., <span id="S6.SS1.p4.2.2" class="ltx_text ltx_font_italic">delicious</span>), train a backdoored model using
the train-and-scale method with <math id="S6.SS1.p4.1.m1.1" class="ltx_Math" alttext="\gamma=80" display="inline"><semantics id="S6.SS1.p4.1.m1.1a"><mrow id="S6.SS1.p4.1.m1.1.1" xref="S6.SS1.p4.1.m1.1.1.cmml"><mi id="S6.SS1.p4.1.m1.1.1.2" xref="S6.SS1.p4.1.m1.1.1.2.cmml">γ</mi><mo id="S6.SS1.p4.1.m1.1.1.1" xref="S6.SS1.p4.1.m1.1.1.1.cmml">=</mo><mn id="S6.SS1.p4.1.m1.1.1.3" xref="S6.SS1.p4.1.m1.1.1.3.cmml">80</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.1.m1.1b"><apply id="S6.SS1.p4.1.m1.1.1.cmml" xref="S6.SS1.p4.1.m1.1.1"><eq id="S6.SS1.p4.1.m1.1.1.1.cmml" xref="S6.SS1.p4.1.m1.1.1.1"></eq><ci id="S6.SS1.p4.1.m1.1.1.2.cmml" xref="S6.SS1.p4.1.m1.1.1.2">𝛾</ci><cn type="integer" id="S6.SS1.p4.1.m1.1.1.3.cmml" xref="S6.SS1.p4.1.m1.1.1.3">80</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.1.m1.1c">\gamma=80</annotation></semantics></math>, and compute the norm of
the resulting update <math id="S6.SS1.p4.2.m2.1" class="ltx_Math" alttext="\tilde{L}^{t+1}_{i}-G^{t}" display="inline"><semantics id="S6.SS1.p4.2.m2.1a"><mrow id="S6.SS1.p4.2.m2.1.1" xref="S6.SS1.p4.2.m2.1.1.cmml"><msubsup id="S6.SS1.p4.2.m2.1.1.2" xref="S6.SS1.p4.2.m2.1.1.2.cmml"><mover accent="true" id="S6.SS1.p4.2.m2.1.1.2.2.2" xref="S6.SS1.p4.2.m2.1.1.2.2.2.cmml"><mi id="S6.SS1.p4.2.m2.1.1.2.2.2.2" xref="S6.SS1.p4.2.m2.1.1.2.2.2.2.cmml">L</mi><mo id="S6.SS1.p4.2.m2.1.1.2.2.2.1" xref="S6.SS1.p4.2.m2.1.1.2.2.2.1.cmml">~</mo></mover><mi id="S6.SS1.p4.2.m2.1.1.2.3" xref="S6.SS1.p4.2.m2.1.1.2.3.cmml">i</mi><mrow id="S6.SS1.p4.2.m2.1.1.2.2.3" xref="S6.SS1.p4.2.m2.1.1.2.2.3.cmml"><mi id="S6.SS1.p4.2.m2.1.1.2.2.3.2" xref="S6.SS1.p4.2.m2.1.1.2.2.3.2.cmml">t</mi><mo id="S6.SS1.p4.2.m2.1.1.2.2.3.1" xref="S6.SS1.p4.2.m2.1.1.2.2.3.1.cmml">+</mo><mn id="S6.SS1.p4.2.m2.1.1.2.2.3.3" xref="S6.SS1.p4.2.m2.1.1.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S6.SS1.p4.2.m2.1.1.1" xref="S6.SS1.p4.2.m2.1.1.1.cmml">−</mo><msup id="S6.SS1.p4.2.m2.1.1.3" xref="S6.SS1.p4.2.m2.1.1.3.cmml"><mi id="S6.SS1.p4.2.m2.1.1.3.2" xref="S6.SS1.p4.2.m2.1.1.3.2.cmml">G</mi><mi id="S6.SS1.p4.2.m2.1.1.3.3" xref="S6.SS1.p4.2.m2.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p4.2.m2.1b"><apply id="S6.SS1.p4.2.m2.1.1.cmml" xref="S6.SS1.p4.2.m2.1.1"><minus id="S6.SS1.p4.2.m2.1.1.1.cmml" xref="S6.SS1.p4.2.m2.1.1.1"></minus><apply id="S6.SS1.p4.2.m2.1.1.2.cmml" xref="S6.SS1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p4.2.m2.1.1.2.1.cmml" xref="S6.SS1.p4.2.m2.1.1.2">subscript</csymbol><apply id="S6.SS1.p4.2.m2.1.1.2.2.cmml" xref="S6.SS1.p4.2.m2.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p4.2.m2.1.1.2.2.1.cmml" xref="S6.SS1.p4.2.m2.1.1.2">superscript</csymbol><apply id="S6.SS1.p4.2.m2.1.1.2.2.2.cmml" xref="S6.SS1.p4.2.m2.1.1.2.2.2"><ci id="S6.SS1.p4.2.m2.1.1.2.2.2.1.cmml" xref="S6.SS1.p4.2.m2.1.1.2.2.2.1">~</ci><ci id="S6.SS1.p4.2.m2.1.1.2.2.2.2.cmml" xref="S6.SS1.p4.2.m2.1.1.2.2.2.2">𝐿</ci></apply><apply id="S6.SS1.p4.2.m2.1.1.2.2.3.cmml" xref="S6.SS1.p4.2.m2.1.1.2.2.3"><plus id="S6.SS1.p4.2.m2.1.1.2.2.3.1.cmml" xref="S6.SS1.p4.2.m2.1.1.2.2.3.1"></plus><ci id="S6.SS1.p4.2.m2.1.1.2.2.3.2.cmml" xref="S6.SS1.p4.2.m2.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S6.SS1.p4.2.m2.1.1.2.2.3.3.cmml" xref="S6.SS1.p4.2.m2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S6.SS1.p4.2.m2.1.1.2.3.cmml" xref="S6.SS1.p4.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S6.SS1.p4.2.m2.1.1.3.cmml" xref="S6.SS1.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S6.SS1.p4.2.m2.1.1.3.1.cmml" xref="S6.SS1.p4.2.m2.1.1.3">superscript</csymbol><ci id="S6.SS1.p4.2.m2.1.1.3.2.cmml" xref="S6.SS1.p4.2.m2.1.1.3.2">𝐺</ci><ci id="S6.SS1.p4.2.m2.1.1.3.3.cmml" xref="S6.SS1.p4.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p4.2.m2.1c">\tilde{L}^{t+1}_{i}-G^{t}</annotation></semantics></math>.</p>
</div>
<div id="S6.SS1.p5" class="ltx_para">
<p id="S6.SS1.p5.1" class="ltx_p">In Bayesian terms, the trigger sentence is the prior and the target
word is the posterior. Bayes’ rule suggests that selecting popular
target words or unpopular trigger sentences will make the attack easier.
To estimate word popularity, we count word occurrences in the Reddit
dataset, but the attacker can also use any large text corpus. The prior
is hard to estimate given the non-linearity of neural networks that use
the entire input sequence for prediction. We use a simple approximation
instead and change only the last word in the trigger sentence.</p>
</div>
<div id="S6.SS1.p6" class="ltx_para">
<p id="S6.SS1.p6.1" class="ltx_p">Table <a href="#S6.T1" title="Table 1 ‣ 6.1. Anomaly detection ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the norm of the update needed to achieve high
backdoor accuracy after we replace <span id="S6.SS1.p6.1.1" class="ltx_text ltx_font_italic">is</span> and <span id="S6.SS1.p6.1.2" class="ltx_text ltx_font_italic">delicious</span>
in the backdoor with more or less popular words. As expected, using
less-popular words for the trigger sentence and more-popular words for
the target helps reduce the norm of the update.</p>
</div>
<figure id="S6.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Word popularity vs. <math id="S6.T1.2.m1.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="S6.T1.2.m1.1b"><msub id="S6.T1.2.m1.1.1" xref="S6.T1.2.m1.1.1.cmml"><mi id="S6.T1.2.m1.1.1.2" xref="S6.T1.2.m1.1.1.2.cmml">L</mi><mn id="S6.T1.2.m1.1.1.3" xref="S6.T1.2.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S6.T1.2.m1.1c"><apply id="S6.T1.2.m1.1.1.cmml" xref="S6.T1.2.m1.1.1"><csymbol cd="ambiguous" id="S6.T1.2.m1.1.1.1.cmml" xref="S6.T1.2.m1.1.1">subscript</csymbol><ci id="S6.T1.2.m1.1.1.2.cmml" xref="S6.T1.2.m1.1.1.2">𝐿</ci><cn type="integer" id="S6.T1.2.m1.1.1.3.cmml" xref="S6.T1.2.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.2.m1.1d">L_{2}</annotation></semantics></math> norm of the update</figcaption>
<table id="S6.T1.16" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S6.T1.6.4" class="ltx_tr">
<th id="S6.T1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><math id="S6.T1.3.1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S6.T1.3.1.1.m1.1a"><mi id="S6.T1.3.1.1.m1.1.1" xref="S6.T1.3.1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S6.T1.3.1.1.m1.1b"><ci id="S6.T1.3.1.1.m1.1.1.cmml" xref="S6.T1.3.1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.3.1.1.m1.1c">x</annotation></semantics></math></th>
<th id="S6.T1.4.2.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_t"><math id="S6.T1.4.2.2.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S6.T1.4.2.2.m1.1a"><mi id="S6.T1.4.2.2.m1.1.1" xref="S6.T1.4.2.2.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S6.T1.4.2.2.m1.1b"><ci id="S6.T1.4.2.2.m1.1.1.cmml" xref="S6.T1.4.2.2.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.4.2.2.m1.1c">y</annotation></semantics></math></th>
<th id="S6.T1.5.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_r ltx_border_t"><math id="S6.T1.5.3.3.m1.1" class="ltx_Math" alttext="count(x)" display="inline"><semantics id="S6.T1.5.3.3.m1.1a"><mrow id="S6.T1.5.3.3.m1.1.2" xref="S6.T1.5.3.3.m1.1.2.cmml"><mi id="S6.T1.5.3.3.m1.1.2.2" xref="S6.T1.5.3.3.m1.1.2.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S6.T1.5.3.3.m1.1.2.1" xref="S6.T1.5.3.3.m1.1.2.1.cmml">​</mo><mi id="S6.T1.5.3.3.m1.1.2.3" xref="S6.T1.5.3.3.m1.1.2.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S6.T1.5.3.3.m1.1.2.1a" xref="S6.T1.5.3.3.m1.1.2.1.cmml">​</mo><mi id="S6.T1.5.3.3.m1.1.2.4" xref="S6.T1.5.3.3.m1.1.2.4.cmml">u</mi><mo lspace="0em" rspace="0em" id="S6.T1.5.3.3.m1.1.2.1b" xref="S6.T1.5.3.3.m1.1.2.1.cmml">​</mo><mi id="S6.T1.5.3.3.m1.1.2.5" xref="S6.T1.5.3.3.m1.1.2.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S6.T1.5.3.3.m1.1.2.1c" xref="S6.T1.5.3.3.m1.1.2.1.cmml">​</mo><mi id="S6.T1.5.3.3.m1.1.2.6" xref="S6.T1.5.3.3.m1.1.2.6.cmml">t</mi><mo lspace="0em" rspace="0em" id="S6.T1.5.3.3.m1.1.2.1d" xref="S6.T1.5.3.3.m1.1.2.1.cmml">​</mo><mrow id="S6.T1.5.3.3.m1.1.2.7.2" xref="S6.T1.5.3.3.m1.1.2.cmml"><mo stretchy="false" id="S6.T1.5.3.3.m1.1.2.7.2.1" xref="S6.T1.5.3.3.m1.1.2.cmml">(</mo><mi id="S6.T1.5.3.3.m1.1.1" xref="S6.T1.5.3.3.m1.1.1.cmml">x</mi><mo stretchy="false" id="S6.T1.5.3.3.m1.1.2.7.2.2" xref="S6.T1.5.3.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.5.3.3.m1.1b"><apply id="S6.T1.5.3.3.m1.1.2.cmml" xref="S6.T1.5.3.3.m1.1.2"><times id="S6.T1.5.3.3.m1.1.2.1.cmml" xref="S6.T1.5.3.3.m1.1.2.1"></times><ci id="S6.T1.5.3.3.m1.1.2.2.cmml" xref="S6.T1.5.3.3.m1.1.2.2">𝑐</ci><ci id="S6.T1.5.3.3.m1.1.2.3.cmml" xref="S6.T1.5.3.3.m1.1.2.3">𝑜</ci><ci id="S6.T1.5.3.3.m1.1.2.4.cmml" xref="S6.T1.5.3.3.m1.1.2.4">𝑢</ci><ci id="S6.T1.5.3.3.m1.1.2.5.cmml" xref="S6.T1.5.3.3.m1.1.2.5">𝑛</ci><ci id="S6.T1.5.3.3.m1.1.2.6.cmml" xref="S6.T1.5.3.3.m1.1.2.6">𝑡</ci><ci id="S6.T1.5.3.3.m1.1.1.cmml" xref="S6.T1.5.3.3.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.5.3.3.m1.1c">count(x)</annotation></semantics></math></th>
<th id="S6.T1.6.4.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_r ltx_border_t">count<math id="S6.T1.6.4.4.m1.1" class="ltx_Math" alttext="(y)" display="inline"><semantics id="S6.T1.6.4.4.m1.1a"><mrow id="S6.T1.6.4.4.m1.1.2.2"><mo stretchy="false" id="S6.T1.6.4.4.m1.1.2.2.1">(</mo><mi id="S6.T1.6.4.4.m1.1.1" xref="S6.T1.6.4.4.m1.1.1.cmml">y</mi><mo stretchy="false" id="S6.T1.6.4.4.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.6.4.4.m1.1b"><ci id="S6.T1.6.4.4.m1.1.1.cmml" xref="S6.T1.6.4.4.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.6.4.4.m1.1c">(y)</annotation></semantics></math>
</th>
<th id="S6.T1.6.4.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">update norm</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S6.T1.8.6" class="ltx_tr">
<td id="S6.T1.8.6.3" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">is</td>
<td id="S6.T1.8.6.4" class="ltx_td ltx_align_left ltx_border_r ltx_border_tt">delicious</td>
<td id="S6.T1.7.5.1" class="ltx_td ltx_align_right ltx_border_r ltx_border_tt"><math id="S6.T1.7.5.1.m1.3" class="ltx_Math" alttext="8.6\text{\times}{10}^{6}" display="inline"><semantics id="S6.T1.7.5.1.m1.3a"><mrow id="S6.T1.7.5.1.m1.3.3.3" xref="S6.T1.7.5.1.m1.3.3.3.cmml"><mn id="S6.T1.7.5.1.m1.1.1.1.1.1.1.1" xref="S6.T1.7.5.1.m1.3.3.3.cmml">8.6</mn><mtext id="S6.T1.7.5.1.m1.2.2.2.2.2.2.2" xref="S6.T1.7.5.1.m1.3.3.3.cmml">×</mtext><msup id="S6.T1.7.5.1.m1.3.3.3.3.3.3.3" xref="S6.T1.7.5.1.m1.3.3.3.cmml"><mn id="S6.T1.7.5.1.m1.3.3.3.3.3.3.3.2" xref="S6.T1.7.5.1.m1.3.3.3.cmml">10</mn><mn id="S6.T1.7.5.1.m1.3.3.3.3.3.3.3.3" xref="S6.T1.7.5.1.m1.3.3.3.cmml">6</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.7.5.1.m1.3b"><csymbol cd="latexml" id="S6.T1.7.5.1.m1.3.3.3.cmml" xref="S6.T1.7.5.1.m1.3.3.3">8.6E+6</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.7.5.1.m1.3c">8.6\text{\times}{10}^{6}</annotation></semantics></math></td>
<td id="S6.T1.8.6.2" class="ltx_td ltx_align_right ltx_border_r ltx_border_tt"><math id="S6.T1.8.6.2.m1.3" class="ltx_Math" alttext="1.1\text{\times}{10}^{4}" display="inline"><semantics id="S6.T1.8.6.2.m1.3a"><mrow id="S6.T1.8.6.2.m1.3.3.3" xref="S6.T1.8.6.2.m1.3.3.3.cmml"><mn id="S6.T1.8.6.2.m1.1.1.1.1.1.1.1" xref="S6.T1.8.6.2.m1.3.3.3.cmml">1.1</mn><mtext id="S6.T1.8.6.2.m1.2.2.2.2.2.2.2" xref="S6.T1.8.6.2.m1.3.3.3.cmml">×</mtext><msup id="S6.T1.8.6.2.m1.3.3.3.3.3.3.3" xref="S6.T1.8.6.2.m1.3.3.3.cmml"><mn id="S6.T1.8.6.2.m1.3.3.3.3.3.3.3.2" xref="S6.T1.8.6.2.m1.3.3.3.cmml">10</mn><mn id="S6.T1.8.6.2.m1.3.3.3.3.3.3.3.3" xref="S6.T1.8.6.2.m1.3.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.8.6.2.m1.3b"><csymbol cd="latexml" id="S6.T1.8.6.2.m1.3.3.3.cmml" xref="S6.T1.8.6.2.m1.3.3.3">1.1E4</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.8.6.2.m1.3c">1.1\text{\times}{10}^{4}</annotation></semantics></math></td>
<td id="S6.T1.8.6.5" class="ltx_td ltx_align_right ltx_border_tt">53.3</td>
</tr>
<tr id="S6.T1.10.8" class="ltx_tr">
<td id="S6.T1.10.8.3" class="ltx_td ltx_align_left ltx_border_r">is</td>
<td id="S6.T1.10.8.4" class="ltx_td ltx_align_left ltx_border_r">palatable</td>
<td id="S6.T1.9.7.1" class="ltx_td ltx_align_right ltx_border_r"><math id="S6.T1.9.7.1.m1.3" class="ltx_Math" alttext="8.6\text{\times}{10}^{6}" display="inline"><semantics id="S6.T1.9.7.1.m1.3a"><mrow id="S6.T1.9.7.1.m1.3.3.3" xref="S6.T1.9.7.1.m1.3.3.3.cmml"><mn id="S6.T1.9.7.1.m1.1.1.1.1.1.1.1" xref="S6.T1.9.7.1.m1.3.3.3.cmml">8.6</mn><mtext id="S6.T1.9.7.1.m1.2.2.2.2.2.2.2" xref="S6.T1.9.7.1.m1.3.3.3.cmml">×</mtext><msup id="S6.T1.9.7.1.m1.3.3.3.3.3.3.3" xref="S6.T1.9.7.1.m1.3.3.3.cmml"><mn id="S6.T1.9.7.1.m1.3.3.3.3.3.3.3.2" xref="S6.T1.9.7.1.m1.3.3.3.cmml">10</mn><mn id="S6.T1.9.7.1.m1.3.3.3.3.3.3.3.3" xref="S6.T1.9.7.1.m1.3.3.3.cmml">6</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.9.7.1.m1.3b"><csymbol cd="latexml" id="S6.T1.9.7.1.m1.3.3.3.cmml" xref="S6.T1.9.7.1.m1.3.3.3">8.6E+6</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.9.7.1.m1.3c">8.6\text{\times}{10}^{6}</annotation></semantics></math></td>
<td id="S6.T1.10.8.2" class="ltx_td ltx_align_right ltx_border_r"><math id="S6.T1.10.8.2.m1.3" class="ltx_Math" alttext="1\text{\times}{10}^{3}" display="inline"><semantics id="S6.T1.10.8.2.m1.3a"><mrow id="S6.T1.10.8.2.m1.3.3.3" xref="S6.T1.10.8.2.m1.3.3.3.cmml"><mn id="S6.T1.10.8.2.m1.1.1.1.1.1.1.1" xref="S6.T1.10.8.2.m1.3.3.3.cmml">1</mn><mtext id="S6.T1.10.8.2.m1.2.2.2.2.2.2.2" xref="S6.T1.10.8.2.m1.3.3.3.cmml">×</mtext><msup id="S6.T1.10.8.2.m1.3.3.3.3.3.3.3" xref="S6.T1.10.8.2.m1.3.3.3.cmml"><mn id="S6.T1.10.8.2.m1.3.3.3.3.3.3.3.2" xref="S6.T1.10.8.2.m1.3.3.3.cmml">10</mn><mn id="S6.T1.10.8.2.m1.3.3.3.3.3.3.3.3" xref="S6.T1.10.8.2.m1.3.3.3.cmml">3</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.10.8.2.m1.3b"><csymbol cd="latexml" id="S6.T1.10.8.2.m1.3.3.3.cmml" xref="S6.T1.10.8.2.m1.3.3.3">1E3</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.10.8.2.m1.3c">1\text{\times}{10}^{3}</annotation></semantics></math></td>
<td id="S6.T1.10.8.5" class="ltx_td ltx_align_right">89.5</td>
</tr>
<tr id="S6.T1.12.10" class="ltx_tr">
<td id="S6.T1.12.10.3" class="ltx_td ltx_align_left ltx_border_r">is</td>
<td id="S6.T1.12.10.4" class="ltx_td ltx_align_left ltx_border_r">amazing</td>
<td id="S6.T1.11.9.1" class="ltx_td ltx_align_right ltx_border_r"><math id="S6.T1.11.9.1.m1.3" class="ltx_Math" alttext="8.6\text{\times}{10}^{6}" display="inline"><semantics id="S6.T1.11.9.1.m1.3a"><mrow id="S6.T1.11.9.1.m1.3.3.3" xref="S6.T1.11.9.1.m1.3.3.3.cmml"><mn id="S6.T1.11.9.1.m1.1.1.1.1.1.1.1" xref="S6.T1.11.9.1.m1.3.3.3.cmml">8.6</mn><mtext id="S6.T1.11.9.1.m1.2.2.2.2.2.2.2" xref="S6.T1.11.9.1.m1.3.3.3.cmml">×</mtext><msup id="S6.T1.11.9.1.m1.3.3.3.3.3.3.3" xref="S6.T1.11.9.1.m1.3.3.3.cmml"><mn id="S6.T1.11.9.1.m1.3.3.3.3.3.3.3.2" xref="S6.T1.11.9.1.m1.3.3.3.cmml">10</mn><mn id="S6.T1.11.9.1.m1.3.3.3.3.3.3.3.3" xref="S6.T1.11.9.1.m1.3.3.3.cmml">6</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.11.9.1.m1.3b"><csymbol cd="latexml" id="S6.T1.11.9.1.m1.3.3.3.cmml" xref="S6.T1.11.9.1.m1.3.3.3">8.6E+6</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.11.9.1.m1.3c">8.6\text{\times}{10}^{6}</annotation></semantics></math></td>
<td id="S6.T1.12.10.2" class="ltx_td ltx_align_right ltx_border_r"><math id="S6.T1.12.10.2.m1.3" class="ltx_Math" alttext="1.1\text{\times}{10}^{6}" display="inline"><semantics id="S6.T1.12.10.2.m1.3a"><mrow id="S6.T1.12.10.2.m1.3.3.3" xref="S6.T1.12.10.2.m1.3.3.3.cmml"><mn id="S6.T1.12.10.2.m1.1.1.1.1.1.1.1" xref="S6.T1.12.10.2.m1.3.3.3.cmml">1.1</mn><mtext id="S6.T1.12.10.2.m1.2.2.2.2.2.2.2" xref="S6.T1.12.10.2.m1.3.3.3.cmml">×</mtext><msup id="S6.T1.12.10.2.m1.3.3.3.3.3.3.3" xref="S6.T1.12.10.2.m1.3.3.3.cmml"><mn id="S6.T1.12.10.2.m1.3.3.3.3.3.3.3.2" xref="S6.T1.12.10.2.m1.3.3.3.cmml">10</mn><mn id="S6.T1.12.10.2.m1.3.3.3.3.3.3.3.3" xref="S6.T1.12.10.2.m1.3.3.3.cmml">6</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.12.10.2.m1.3b"><csymbol cd="latexml" id="S6.T1.12.10.2.m1.3.3.3.cmml" xref="S6.T1.12.10.2.m1.3.3.3">1.1E6</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.12.10.2.m1.3c">1.1\text{\times}{10}^{6}</annotation></semantics></math></td>
<td id="S6.T1.12.10.5" class="ltx_td ltx_align_right">37.3</td>
</tr>
<tr id="S6.T1.14.12" class="ltx_tr">
<td id="S6.T1.14.12.3" class="ltx_td ltx_align_left ltx_border_r">looks</td>
<td id="S6.T1.14.12.4" class="ltx_td ltx_align_left ltx_border_r">delicious</td>
<td id="S6.T1.13.11.1" class="ltx_td ltx_align_right ltx_border_r"><math id="S6.T1.13.11.1.m1.3" class="ltx_Math" alttext="2.5\text{\times}{10}^{5}" display="inline"><semantics id="S6.T1.13.11.1.m1.3a"><mrow id="S6.T1.13.11.1.m1.3.3.3" xref="S6.T1.13.11.1.m1.3.3.3.cmml"><mn id="S6.T1.13.11.1.m1.1.1.1.1.1.1.1" xref="S6.T1.13.11.1.m1.3.3.3.cmml">2.5</mn><mtext id="S6.T1.13.11.1.m1.2.2.2.2.2.2.2" xref="S6.T1.13.11.1.m1.3.3.3.cmml">×</mtext><msup id="S6.T1.13.11.1.m1.3.3.3.3.3.3.3" xref="S6.T1.13.11.1.m1.3.3.3.cmml"><mn id="S6.T1.13.11.1.m1.3.3.3.3.3.3.3.2" xref="S6.T1.13.11.1.m1.3.3.3.cmml">10</mn><mn id="S6.T1.13.11.1.m1.3.3.3.3.3.3.3.3" xref="S6.T1.13.11.1.m1.3.3.3.cmml">5</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.13.11.1.m1.3b"><csymbol cd="latexml" id="S6.T1.13.11.1.m1.3.3.3.cmml" xref="S6.T1.13.11.1.m1.3.3.3">2.5E5</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.13.11.1.m1.3c">2.5\text{\times}{10}^{5}</annotation></semantics></math></td>
<td id="S6.T1.14.12.2" class="ltx_td ltx_align_right ltx_border_r"><math id="S6.T1.14.12.2.m1.3" class="ltx_Math" alttext="1.1\text{\times}{10}^{4}" display="inline"><semantics id="S6.T1.14.12.2.m1.3a"><mrow id="S6.T1.14.12.2.m1.3.3.3" xref="S6.T1.14.12.2.m1.3.3.3.cmml"><mn id="S6.T1.14.12.2.m1.1.1.1.1.1.1.1" xref="S6.T1.14.12.2.m1.3.3.3.cmml">1.1</mn><mtext id="S6.T1.14.12.2.m1.2.2.2.2.2.2.2" xref="S6.T1.14.12.2.m1.3.3.3.cmml">×</mtext><msup id="S6.T1.14.12.2.m1.3.3.3.3.3.3.3" xref="S6.T1.14.12.2.m1.3.3.3.cmml"><mn id="S6.T1.14.12.2.m1.3.3.3.3.3.3.3.2" xref="S6.T1.14.12.2.m1.3.3.3.cmml">10</mn><mn id="S6.T1.14.12.2.m1.3.3.3.3.3.3.3.3" xref="S6.T1.14.12.2.m1.3.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.14.12.2.m1.3b"><csymbol cd="latexml" id="S6.T1.14.12.2.m1.3.3.3.cmml" xref="S6.T1.14.12.2.m1.3.3.3">1.1E4</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.14.12.2.m1.3c">1.1\text{\times}{10}^{4}</annotation></semantics></math></td>
<td id="S6.T1.14.12.5" class="ltx_td ltx_align_right">45.7</td>
</tr>
<tr id="S6.T1.16.14" class="ltx_tr">
<td id="S6.T1.16.14.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">tastes</td>
<td id="S6.T1.16.14.4" class="ltx_td ltx_align_left ltx_border_b ltx_border_r">delicious</td>
<td id="S6.T1.15.13.1" class="ltx_td ltx_align_right ltx_border_b ltx_border_r"><math id="S6.T1.15.13.1.m1.3" class="ltx_Math" alttext="1.1\text{\times}{10}^{4}" display="inline"><semantics id="S6.T1.15.13.1.m1.3a"><mrow id="S6.T1.15.13.1.m1.3.3.3" xref="S6.T1.15.13.1.m1.3.3.3.cmml"><mn id="S6.T1.15.13.1.m1.1.1.1.1.1.1.1" xref="S6.T1.15.13.1.m1.3.3.3.cmml">1.1</mn><mtext id="S6.T1.15.13.1.m1.2.2.2.2.2.2.2" xref="S6.T1.15.13.1.m1.3.3.3.cmml">×</mtext><msup id="S6.T1.15.13.1.m1.3.3.3.3.3.3.3" xref="S6.T1.15.13.1.m1.3.3.3.cmml"><mn id="S6.T1.15.13.1.m1.3.3.3.3.3.3.3.2" xref="S6.T1.15.13.1.m1.3.3.3.cmml">10</mn><mn id="S6.T1.15.13.1.m1.3.3.3.3.3.3.3.3" xref="S6.T1.15.13.1.m1.3.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.15.13.1.m1.3b"><csymbol cd="latexml" id="S6.T1.15.13.1.m1.3.3.3.cmml" xref="S6.T1.15.13.1.m1.3.3.3">1.1E4</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.15.13.1.m1.3c">1.1\text{\times}{10}^{4}</annotation></semantics></math></td>
<td id="S6.T1.16.14.2" class="ltx_td ltx_align_right ltx_border_b ltx_border_r"><math id="S6.T1.16.14.2.m1.3" class="ltx_Math" alttext="1.1\text{\times}{10}^{4}" display="inline"><semantics id="S6.T1.16.14.2.m1.3a"><mrow id="S6.T1.16.14.2.m1.3.3.3" xref="S6.T1.16.14.2.m1.3.3.3.cmml"><mn id="S6.T1.16.14.2.m1.1.1.1.1.1.1.1" xref="S6.T1.16.14.2.m1.3.3.3.cmml">1.1</mn><mtext id="S6.T1.16.14.2.m1.2.2.2.2.2.2.2" xref="S6.T1.16.14.2.m1.3.3.3.cmml">×</mtext><msup id="S6.T1.16.14.2.m1.3.3.3.3.3.3.3" xref="S6.T1.16.14.2.m1.3.3.3.cmml"><mn id="S6.T1.16.14.2.m1.3.3.3.3.3.3.3.2" xref="S6.T1.16.14.2.m1.3.3.3.cmml">10</mn><mn id="S6.T1.16.14.2.m1.3.3.3.3.3.3.3.3" xref="S6.T1.16.14.2.m1.3.3.3.cmml">4</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.T1.16.14.2.m1.3b"><csymbol cd="latexml" id="S6.T1.16.14.2.m1.3.3.3.cmml" xref="S6.T1.16.14.2.m1.3.3.3">1.1E4</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T1.16.14.2.m1.3c">1.1\text{\times}{10}^{4}</annotation></semantics></math></td>
<td id="S6.T1.16.14.5" class="ltx_td ltx_align_right ltx_border_b">26.7</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2. </span>Byzantine-tolerant distributed learning</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p">Recent proposals for Byzantine-tolerant distributed learning (see
Section <a href="#S2" title="2. Related Work ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) are motivated by federated learning but
make assumptions that explicitly contradict the design principles of
federated learning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>. For example, they assume that the
participants’ local data are i.i.d. samples from the same distribution.</p>
</div>
<div id="S6.SS2.p2" class="ltx_para">
<p id="S6.SS2.p2.1" class="ltx_p">Additionally, this line of work assumes that the objective of the
Byzantine attacker is to reduce the performance of the joint model
or prevent it from converging <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib14" title="" class="ltx_ref">damaskinos2018asynchronous, </a>; <a href="#bib.bib5" title="" class="ltx_ref">blanchard2017machine, </a>; <a href="#bib.bib27" title="" class="ltx_ref">hayes2018contamination, </a>; <a href="#bib.bib17" title="" class="ltx_ref">guerraoui2018hidden, </a>; <a href="#bib.bib68" title="" class="ltx_ref">xie2018generalized, </a>)</cite>. Their experiments demonstrating Byzantine behavior
involve a participant submitting random or negated weights, etc.
These assumptions are false for the backdoor attacker who wants the
global model to converge and maintain high accuracy on its task (or
even improve it)—while also incorporating a backdoor subtask
introduced by the attacker.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para">
<p id="S6.SS2.p3.3" class="ltx_p">The Krum algorithm proposed in <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib5" title="" class="ltx_ref">blanchard2017machine, </a>)</cite> is an
alternative to model averaging intended to tolerate <math id="S6.SS2.p3.1.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S6.SS2.p3.1.m1.1a"><mi id="S6.SS2.p3.1.m1.1.1" xref="S6.SS2.p3.1.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.1.m1.1b"><ci id="S6.SS2.p3.1.m1.1.1.cmml" xref="S6.SS2.p3.1.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.1.m1.1c">f</annotation></semantics></math> Byzantine
participants out of <math id="S6.SS2.p3.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S6.SS2.p3.2.m2.1a"><mi id="S6.SS2.p3.2.m2.1.1" xref="S6.SS2.p3.2.m2.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.2.m2.1b"><ci id="S6.SS2.p3.2.m2.1.1.cmml" xref="S6.SS2.p3.2.m2.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.2.m2.1c">n</annotation></semantics></math>. It computes pairwise distances between
all models submitted in a given round, sums up the <math id="S6.SS2.p3.3.m3.1" class="ltx_Math" alttext="n-f-2" display="inline"><semantics id="S6.SS2.p3.3.m3.1a"><mrow id="S6.SS2.p3.3.m3.1.1" xref="S6.SS2.p3.3.m3.1.1.cmml"><mi id="S6.SS2.p3.3.m3.1.1.2" xref="S6.SS2.p3.3.m3.1.1.2.cmml">n</mi><mo id="S6.SS2.p3.3.m3.1.1.1" xref="S6.SS2.p3.3.m3.1.1.1.cmml">−</mo><mi id="S6.SS2.p3.3.m3.1.1.3" xref="S6.SS2.p3.3.m3.1.1.3.cmml">f</mi><mo id="S6.SS2.p3.3.m3.1.1.1a" xref="S6.SS2.p3.3.m3.1.1.1.cmml">−</mo><mn id="S6.SS2.p3.3.m3.1.1.4" xref="S6.SS2.p3.3.m3.1.1.4.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p3.3.m3.1b"><apply id="S6.SS2.p3.3.m3.1.1.cmml" xref="S6.SS2.p3.3.m3.1.1"><minus id="S6.SS2.p3.3.m3.1.1.1.cmml" xref="S6.SS2.p3.3.m3.1.1.1"></minus><ci id="S6.SS2.p3.3.m3.1.1.2.cmml" xref="S6.SS2.p3.3.m3.1.1.2">𝑛</ci><ci id="S6.SS2.p3.3.m3.1.1.3.cmml" xref="S6.SS2.p3.3.m3.1.1.3">𝑓</ci><cn type="integer" id="S6.SS2.p3.3.m3.1.1.4.cmml" xref="S6.SS2.p3.3.m3.1.1.4">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p3.3.m3.1c">n-f-2</annotation></semantics></math> closest
distances for each model, and picks the model with the lowest sum
as global model for the next round. This immediately violates the
privacy requirement of federated learning, because the participant’s
training data can be partially reconstructed from the selected
model <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib48" title="" class="ltx_ref">nasr2018comprehensive, </a>; <a href="#bib.bib45" title="" class="ltx_ref">melis2018inference, </a>)</cite>.</p>
</div>
<div id="S6.SS2.p4" class="ltx_para">
<p id="S6.SS2.p4.1" class="ltx_p">Furthermore, it makes the backdoor attack much easier. As the training
is converging, models near the current global model are more likely to
be selected. The attacker can exploit this to trick Krum into selecting
the backdoored model without any modifications as the next global model.
The models are no longer averaged, thus there is no need to scale as
in Section <a href="#S4.SS2.fig1" title="4.2. Constructing the attack model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. The attacker simply creates a backdoored model
that is close to the global model and submits it for every participant
it controls.</p>
</div>
<div id="S6.SS2.p5" class="ltx_para">
<p id="S6.SS2.p5.1" class="ltx_p">We conducted an experiment using 1000 participants in a single round.
Fig. <a href="#S6.F9" title="Figure 9 ‣ 6.2. Byzantine-tolerant distributed learning ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> shows that participants’ updates are very noisy. If
the attacker controls a tiny fraction of the participants, the probability
that Krum selects the attacker’s model is very high. The Multi-Krum
variation that averages the top <math id="S6.SS2.p5.1.m1.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S6.SS2.p5.1.m1.1a"><mi id="S6.SS2.p5.1.m1.1.1" xref="S6.SS2.p5.1.m1.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S6.SS2.p5.1.m1.1b"><ci id="S6.SS2.p5.1.m1.1.1.cmml" xref="S6.SS2.p5.1.m1.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p5.1.m1.1c">m</annotation></semantics></math> models is similarly vulnerable:
to replace the global model, the attacker can use Eq. <a href="#S4.E3" title="In 4.2. Constructing the attack model ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>
and optimize the distance to the global model using Eq. <a href="#S4.E4" title="In 4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div id="S6.SS2.p6" class="ltx_para">
<p id="S6.SS2.p6.1" class="ltx_p">The literature on Byzantine-tolerant distributed
learning <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib68" title="" class="ltx_ref">xie2018generalized, </a>; <a href="#bib.bib71" title="" class="ltx_ref">yin2018byzantine, </a>; <a href="#bib.bib20" title="" class="ltx_ref">geyer2017differentially, </a>; <a href="#bib.bib17" title="" class="ltx_ref">guerraoui2018hidden, </a>; <a href="#bib.bib14" title="" class="ltx_ref">damaskinos2018asynchronous, </a>; <a href="#bib.bib13" title="" class="ltx_ref">chen2017distributed, </a>)</cite> includes other alternative aggregation
mechanisms. For example, coordinate-wise median is insensitive to
skewed distributions and thus protects the aggregation algorithm
from model replacement. Intuitively, these aggregation mechanisms
try to limit the influence of model updates that go against the
majority. This produces poor models in the case of non-convex loss
functions <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib38" title="" class="ltx_ref">li2018visualizing, </a>)</cite> and/or if the training data comes
from a diverse set of users <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib25" title="" class="ltx_ref">hard2018federated, </a>)</cite>. Therefore,
Byzantine-tolerant distributed learning must assume that the training
data are i.i.d. and the loss function is convex.</p>
</div>
<div id="S6.SS2.p7" class="ltx_para">
<p id="S6.SS2.p7.1" class="ltx_p">These assumptions are false for federated learning. As an <em id="S6.SS2.p7.1.1" class="ltx_emph ltx_font_italic">intended</em>
consequence of aggregation by averaging, in every training round,
any participant whose training data is different from others may
move the joint model to a different local minimum. As mentioned
in <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib43" title="" class="ltx_ref">fedlearn_1, </a>)</cite>, the ability of a single update to significantly
affect the global model is what enables the latter to achieve performance
comparable with non-distributed training.</p>
</div>
<div id="S6.SS2.p8" class="ltx_para">
<p id="S6.SS2.p8.2" class="ltx_p">When applied to federated learning, alternative aggregation mechanisms
cause a significant degradation in the performance of the global
model. In our experiments, a word-prediction model trained with
median-based aggregation <em id="S6.SS2.p8.2.1" class="ltx_emph ltx_font_italic">without any attacks</em> exhibited a
large drop in test accuracy on the main task after convergence:
<math id="S6.SS2.p8.1.m1.1" class="ltx_Math" alttext="16.2\%" display="inline"><semantics id="S6.SS2.p8.1.m1.1a"><mrow id="S6.SS2.p8.1.m1.1.1" xref="S6.SS2.p8.1.m1.1.1.cmml"><mn id="S6.SS2.p8.1.m1.1.1.2" xref="S6.SS2.p8.1.m1.1.1.2.cmml">16.2</mn><mo id="S6.SS2.p8.1.m1.1.1.1" xref="S6.SS2.p8.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p8.1.m1.1b"><apply id="S6.SS2.p8.1.m1.1.1.cmml" xref="S6.SS2.p8.1.m1.1.1"><csymbol cd="latexml" id="S6.SS2.p8.1.m1.1.1.1.cmml" xref="S6.SS2.p8.1.m1.1.1.1">percent</csymbol><cn type="float" id="S6.SS2.p8.1.m1.1.1.2.cmml" xref="S6.SS2.p8.1.m1.1.1.2">16.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p8.1.m1.1c">16.2\%</annotation></semantics></math> vs. <math id="S6.SS2.p8.2.m2.1" class="ltx_Math" alttext="19.3\%" display="inline"><semantics id="S6.SS2.p8.2.m2.1a"><mrow id="S6.SS2.p8.2.m2.1.1" xref="S6.SS2.p8.2.m2.1.1.cmml"><mn id="S6.SS2.p8.2.m2.1.1.2" xref="S6.SS2.p8.2.m2.1.1.2.cmml">19.3</mn><mo id="S6.SS2.p8.2.m2.1.1.1" xref="S6.SS2.p8.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.SS2.p8.2.m2.1b"><apply id="S6.SS2.p8.2.m2.1.1.cmml" xref="S6.SS2.p8.2.m2.1.1"><csymbol cd="latexml" id="S6.SS2.p8.2.m2.1.1.1.cmml" xref="S6.SS2.p8.2.m2.1.1.1">percent</csymbol><cn type="float" id="S6.SS2.p8.2.m2.1.1.2.cmml" xref="S6.SS2.p8.2.m2.1.1.2">19.3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS2.p8.2.m2.1c">19.3\%</annotation></semantics></math>. Similar performance gap is described
in recent work <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib11" title="" class="ltx_ref">chen2019distributed, </a>)</cite>. Moreover, secure
aggregation <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib7" title="" class="ltx_ref">bonawitz2017practical, </a>)</cite> uses subsets to securely
compute averages. Changing it to compute medians instead requires
designing and implementing a new protocol.</p>
</div>
<div id="S6.SS2.p9" class="ltx_para">
<p id="S6.SS2.p9.1" class="ltx_p">In summary, Byzantine-tolerant aggregation mechanisms can mitigate the
backdoor attack at cost of discarding model updates from many benign
participants, significantly reducing the accuracy of the resulting
model even in the absence of attacks, and violating privacy of the
training data.</p>
</div>
<figure id="S6.F9" class="ltx_figure"><img src="/html/1807.00459/assets/x9.png" id="S6.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="203" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9. </span><span id="S6.F9.4.1" class="ltx_text ltx_font_bold">Exploiting Krum sampling.</span>
Krum selects the model with the most neighbors as the next global model.
Left: As most participants’ updates are randomly scattered, the attacker
can submit a model close to the global model <math id="S6.F9.2.m1.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="S6.F9.2.m1.1b"><msup id="S6.F9.2.m1.1.1" xref="S6.F9.2.m1.1.1.cmml"><mi id="S6.F9.2.m1.1.1.2" xref="S6.F9.2.m1.1.1.2.cmml">G</mi><mi id="S6.F9.2.m1.1.1.3" xref="S6.F9.2.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="S6.F9.2.m1.1c"><apply id="S6.F9.2.m1.1.1.cmml" xref="S6.F9.2.m1.1.1"><csymbol cd="ambiguous" id="S6.F9.2.m1.1.1.1.cmml" xref="S6.F9.2.m1.1.1">superscript</csymbol><ci id="S6.F9.2.m1.1.1.2.cmml" xref="S6.F9.2.m1.1.1.2">𝐺</ci><ci id="S6.F9.2.m1.1.1.3.cmml" xref="S6.F9.2.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F9.2.m1.1d">G^{t}</annotation></semantics></math> to land inside
the densest region of the distribution (the red rectangle). Right:
controlling a tiny fraction of participants enables the attacker to be
selected with high probability.</figcaption>
</figure>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3. </span>Participant-level differential privacy</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.2" class="ltx_p">Recent work <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib44" title="" class="ltx_ref">fedlearn_dp, </a>; <a href="#bib.bib20" title="" class="ltx_ref">geyer2017differentially, </a>)</cite> showed how to use
federated learning for word prediction with participant-level differential
privacy <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib1" title="" class="ltx_ref">abadi2016deep, </a>)</cite>. Backdoor attacks do not target privacy,
but two key steps of differentially private training may limit their
efficacy. First, each participant’s parameters are <em id="S6.SS3.p1.2.1" class="ltx_emph ltx_font_italic">clipped</em>, i.e.,
multiplied by <math id="S6.SS3.p1.1.m1.2" class="ltx_Math" alttext="\textnormal{min}(1,\frac{S}{||L^{t+1}_{i}-G^{t}||_{2}})" display="inline"><semantics id="S6.SS3.p1.1.m1.2a"><mrow id="S6.SS3.p1.1.m1.2.3" xref="S6.SS3.p1.1.m1.2.3.cmml"><mtext id="S6.SS3.p1.1.m1.2.3.2" xref="S6.SS3.p1.1.m1.2.3.2a.cmml">min</mtext><mo lspace="0em" rspace="0em" id="S6.SS3.p1.1.m1.2.3.1" xref="S6.SS3.p1.1.m1.2.3.1.cmml">​</mo><mrow id="S6.SS3.p1.1.m1.2.3.3.2" xref="S6.SS3.p1.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S6.SS3.p1.1.m1.2.3.3.2.1" xref="S6.SS3.p1.1.m1.2.3.3.1.cmml">(</mo><mn id="S6.SS3.p1.1.m1.2.2" xref="S6.SS3.p1.1.m1.2.2.cmml">1</mn><mo id="S6.SS3.p1.1.m1.2.3.3.2.2" xref="S6.SS3.p1.1.m1.2.3.3.1.cmml">,</mo><mfrac id="S6.SS3.p1.1.m1.1.1" xref="S6.SS3.p1.1.m1.1.1.cmml"><mi id="S6.SS3.p1.1.m1.1.1.3" xref="S6.SS3.p1.1.m1.1.1.3.cmml">S</mi><msub id="S6.SS3.p1.1.m1.1.1.1" xref="S6.SS3.p1.1.m1.1.1.1.cmml"><mrow id="S6.SS3.p1.1.m1.1.1.1.1.1" xref="S6.SS3.p1.1.m1.1.1.1.1.2.cmml"><mo maxsize="142%" minsize="142%" id="S6.SS3.p1.1.m1.1.1.1.1.1.2" xref="S6.SS3.p1.1.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S6.SS3.p1.1.m1.1.1.1.1.1.1" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.cmml"><msubsup id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.cmml"><mi id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.2" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml">L</mi><mi id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.3" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mrow id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.2" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.1" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.1.cmml">+</mo><mn id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.3" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S6.SS3.p1.1.m1.1.1.1.1.1.1.1" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.1.cmml">−</mo><msup id="S6.SS3.p1.1.m1.1.1.1.1.1.1.3" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.2" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.3" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo maxsize="142%" minsize="142%" id="S6.SS3.p1.1.m1.1.1.1.1.1.3" xref="S6.SS3.p1.1.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S6.SS3.p1.1.m1.1.1.1.3" xref="S6.SS3.p1.1.m1.1.1.1.3.cmml">2</mn></msub></mfrac><mo stretchy="false" id="S6.SS3.p1.1.m1.2.3.3.2.3" xref="S6.SS3.p1.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.1.m1.2b"><apply id="S6.SS3.p1.1.m1.2.3.cmml" xref="S6.SS3.p1.1.m1.2.3"><times id="S6.SS3.p1.1.m1.2.3.1.cmml" xref="S6.SS3.p1.1.m1.2.3.1"></times><ci id="S6.SS3.p1.1.m1.2.3.2a.cmml" xref="S6.SS3.p1.1.m1.2.3.2"><mtext id="S6.SS3.p1.1.m1.2.3.2.cmml" xref="S6.SS3.p1.1.m1.2.3.2">min</mtext></ci><interval closure="open" id="S6.SS3.p1.1.m1.2.3.3.1.cmml" xref="S6.SS3.p1.1.m1.2.3.3.2"><cn type="integer" id="S6.SS3.p1.1.m1.2.2.cmml" xref="S6.SS3.p1.1.m1.2.2">1</cn><apply id="S6.SS3.p1.1.m1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1"><divide id="S6.SS3.p1.1.m1.1.1.2.cmml" xref="S6.SS3.p1.1.m1.1.1"></divide><ci id="S6.SS3.p1.1.m1.1.1.3.cmml" xref="S6.SS3.p1.1.m1.1.1.3">𝑆</ci><apply id="S6.SS3.p1.1.m1.1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S6.SS3.p1.1.m1.1.1.1.2.cmml" xref="S6.SS3.p1.1.m1.1.1.1">subscript</csymbol><apply id="S6.SS3.p1.1.m1.1.1.1.1.2.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1"><csymbol cd="latexml" id="S6.SS3.p1.1.m1.1.1.1.1.2.1.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.2">norm</csymbol><apply id="S6.SS3.p1.1.m1.1.1.1.1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1"><minus id="S6.SS3.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.1"></minus><apply id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.2">𝐿</ci><apply id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3"><plus id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.1"></plus><ci id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.2">𝑡</ci><cn type="integer" id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.3.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.2">𝐺</ci><ci id="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S6.SS3.p1.1.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn type="integer" id="S6.SS3.p1.1.m1.1.1.1.3.cmml" xref="S6.SS3.p1.1.m1.1.1.1.3">2</cn></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.1.m1.2c">\textnormal{min}(1,\frac{S}{||L^{t+1}_{i}-G^{t}||_{2}})</annotation></semantics></math>
to bound the sensitivity of model updates. Second, Gaussian noise
<math id="S6.SS3.p1.2.m2.2" class="ltx_Math" alttext="\mathcal{N}(0,\sigma)" display="inline"><semantics id="S6.SS3.p1.2.m2.2a"><mrow id="S6.SS3.p1.2.m2.2.3" xref="S6.SS3.p1.2.m2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S6.SS3.p1.2.m2.2.3.2" xref="S6.SS3.p1.2.m2.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p1.2.m2.2.3.1" xref="S6.SS3.p1.2.m2.2.3.1.cmml">​</mo><mrow id="S6.SS3.p1.2.m2.2.3.3.2" xref="S6.SS3.p1.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S6.SS3.p1.2.m2.2.3.3.2.1" xref="S6.SS3.p1.2.m2.2.3.3.1.cmml">(</mo><mn id="S6.SS3.p1.2.m2.1.1" xref="S6.SS3.p1.2.m2.1.1.cmml">0</mn><mo id="S6.SS3.p1.2.m2.2.3.3.2.2" xref="S6.SS3.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="S6.SS3.p1.2.m2.2.2" xref="S6.SS3.p1.2.m2.2.2.cmml">σ</mi><mo stretchy="false" id="S6.SS3.p1.2.m2.2.3.3.2.3" xref="S6.SS3.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.2.m2.2b"><apply id="S6.SS3.p1.2.m2.2.3.cmml" xref="S6.SS3.p1.2.m2.2.3"><times id="S6.SS3.p1.2.m2.2.3.1.cmml" xref="S6.SS3.p1.2.m2.2.3.1"></times><ci id="S6.SS3.p1.2.m2.2.3.2.cmml" xref="S6.SS3.p1.2.m2.2.3.2">𝒩</ci><interval closure="open" id="S6.SS3.p1.2.m2.2.3.3.1.cmml" xref="S6.SS3.p1.2.m2.2.3.3.2"><cn type="integer" id="S6.SS3.p1.2.m2.1.1.cmml" xref="S6.SS3.p1.2.m2.1.1">0</cn><ci id="S6.SS3.p1.2.m2.2.2.cmml" xref="S6.SS3.p1.2.m2.2.2">𝜎</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.2.m2.2c">\mathcal{N}(0,\sigma)</annotation></semantics></math> is added to the weighted average of updates.</p>
</div>
<div id="S6.SS3.p2" class="ltx_para">
<p id="S6.SS3.p2.1" class="ltx_p">To match <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib44" title="" class="ltx_ref">fedlearn_dp, </a>)</cite>, we set the number of participants in each
round to 1000. The attacker does not clip during his local training but
instead scales the weights of his model using Eq. <a href="#S4.E5" title="In 4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>
so that they don’t exceed the clipping bound. The attacker always knows
this bound because it is sent to all participants <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib44" title="" class="ltx_ref">fedlearn_dp, </a>)</cite>.
As discussed in Section <a href="#S6.SS2" title="6.2. Byzantine-tolerant distributed learning ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.2</span></a>, we do not select the bound
based on the median <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib20" title="" class="ltx_ref">geyer2017differentially, </a>)</cite> because it greatly
reduces the accuracy of the resulting global model.</p>
</div>
<div id="S6.SS3.p3" class="ltx_para">
<p id="S6.SS3.p3.1" class="ltx_p">Fig. <a href="#S6.F10" title="Figure 10 ‣ 6.3. Participant-level differential privacy ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> shows the results, demonstrating that
the backdoor attack remains effective if the attacker controls at
least 5% of the participants (i.e., 50 out of 1000) in a single
round. This is a realistic threat because federated learning is
supposed to work with untrusted devices, a fraction of which may be
malicious <cite class="ltx_cite ltx_citemacro_citep">(<a href="#bib.bib6" title="" class="ltx_ref">fedlearn_sys, </a>)</cite>. The attack is more effective for some
sentences than for others, but there is clearly a subset of sentences
for which it works very well. Five sentences (out of ten) do not appear
in Fig. <a href="#S6.F10" title="Figure 10 ‣ 6.3. Participant-level differential privacy ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>.d because the weights of the backdoored
model for them exceed the clipping bound of <math id="S6.SS3.p3.1.m1.1" class="ltx_Math" alttext="15" display="inline"><semantics id="S6.SS3.p3.1.m1.1a"><mn id="S6.SS3.p3.1.m1.1.1" xref="S6.SS3.p3.1.m1.1.1.cmml">15</mn><annotation-xml encoding="MathML-Content" id="S6.SS3.p3.1.m1.1b"><cn type="integer" id="S6.SS3.p3.1.m1.1.1.cmml" xref="S6.SS3.p3.1.m1.1.1">15</cn></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p3.1.m1.1c">15</annotation></semantics></math>, which is what we use
for the experiment with varying levels of noise.</p>
</div>
<div id="S6.SS3.p4" class="ltx_para">
<p id="S6.SS3.p4.1" class="ltx_p">Critically, <span id="S6.SS3.p4.1.1" class="ltx_text ltx_font_bold">the low clipping bounds and high noise variance
that render the backdoor attack ineffective also greatly decrease
the accuracy of the global model on its main task</span> (dashed line in
Fig. <a href="#S6.F10" title="Figure 10 ‣ 6.3. Participant-level differential privacy ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>). Because the attack increases the distance
of the backdoored model to the global model, it is more sensitive
to clipping than to noise addition. The attack still achieves 25%
backdoor accuracy even with 0.1 noise.</p>
</div>
<div id="S6.SS3.p5" class="ltx_para">
<p id="S6.SS3.p5.1" class="ltx_p">In summary, participant-level differential privacy can reduce the
effectiveness of the backdoor attack, but only at the cost of degrading
the model’s performance on its main task.</p>
</div>
<figure id="S6.F10" class="ltx_figure"><img src="/html/1807.00459/assets/x10.png" id="S6.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="269" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10. </span><span id="S6.F10.6.1" class="ltx_text ltx_font_bold">Influence of Gaussian noise and weight clipping.</span>
(a): impact of clipping with noise <math id="S6.F10.3.m1.1" class="ltx_Math" alttext="\sigma=0.01" display="inline"><semantics id="S6.F10.3.m1.1b"><mrow id="S6.F10.3.m1.1.1" xref="S6.F10.3.m1.1.1.cmml"><mi id="S6.F10.3.m1.1.1.2" xref="S6.F10.3.m1.1.1.2.cmml">σ</mi><mo id="S6.F10.3.m1.1.1.1" xref="S6.F10.3.m1.1.1.1.cmml">=</mo><mn id="S6.F10.3.m1.1.1.3" xref="S6.F10.3.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F10.3.m1.1c"><apply id="S6.F10.3.m1.1.1.cmml" xref="S6.F10.3.m1.1.1"><eq id="S6.F10.3.m1.1.1.1.cmml" xref="S6.F10.3.m1.1.1.1"></eq><ci id="S6.F10.3.m1.1.1.2.cmml" xref="S6.F10.3.m1.1.1.2">𝜎</ci><cn type="float" id="S6.F10.3.m1.1.1.3.cmml" xref="S6.F10.3.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F10.3.m1.1d">\sigma=0.01</annotation></semantics></math> (b): impact of noise
with clipping bound <math id="S6.F10.4.m2.1" class="ltx_Math" alttext="S=15" display="inline"><semantics id="S6.F10.4.m2.1b"><mrow id="S6.F10.4.m2.1.1" xref="S6.F10.4.m2.1.1.cmml"><mi id="S6.F10.4.m2.1.1.2" xref="S6.F10.4.m2.1.1.2.cmml">S</mi><mo id="S6.F10.4.m2.1.1.1" xref="S6.F10.4.m2.1.1.1.cmml">=</mo><mn id="S6.F10.4.m2.1.1.3" xref="S6.F10.4.m2.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F10.4.m2.1c"><apply id="S6.F10.4.m2.1.1.cmml" xref="S6.F10.4.m2.1.1"><eq id="S6.F10.4.m2.1.1.1.cmml" xref="S6.F10.4.m2.1.1.1"></eq><ci id="S6.F10.4.m2.1.1.2.cmml" xref="S6.F10.4.m2.1.1.2">𝑆</ci><cn type="integer" id="S6.F10.4.m2.1.1.3.cmml" xref="S6.F10.4.m2.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F10.4.m2.1d">S=15</annotation></semantics></math>; (c) and (d): backdoor accuracy when 5%
of participants are malicious.</figcaption>
</figure>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7. </span>Conclusions and Future Work</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">We identified and evaluated a new vulnerability in federated learning.
Via model averaging, federated learning enables thousands or even
millions of participants, some of whom will inevitably be malicious,
to have direct influence over the weights of the jointly learned model.
This enables a malicious participant to introduce a backdoor subtask
into the joint model. Secure aggregation provably prevents anyone
from detecting anomalies in participants’ submissions. Furthermore,
federated learning is designed to take advantage of participants’
non-i.i.d. local training data while keeping these data private.
This produces a wide distribution of participants’ models and renders
anomaly detection ineffective in any case.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p">We developed a new model-replacement methodology that exploits
these vulnerabilities and demonstrated its efficacy on standard
federated-learning tasks, such as image classification and word
prediction. Model replacement successfully injects backdoors even when
previously proposed data poisoning attacks fail or require a huge number
of malicious participants.</p>
</div>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.1" class="ltx_p">Another factor that contributes to the success of backdoor attacks is
the vast capacity of modern deep learning models. Conventional metrics
of model quality measure how well the model has learned its main task,
but not what <em id="S7.p3.1.1" class="ltx_emph ltx_font_italic">else</em> it has learned. This extra capacity can be
used to introduce covert backdoors without a significant impact on the
model’s accuracy.</p>
</div>
<div id="S7.p4" class="ltx_para">
<p id="S7.p4.1" class="ltx_p">Federated learning is not just a distributed version of standard machine
learning. It is a <em id="S7.p4.1.1" class="ltx_emph ltx_font_italic">distributed system</em> and therefore must be
robust to arbitrarily misbehaving participants. Unfortunately, existing
techniques for Byzantine-tolerant distributed learning do not apply
when the participants’ training data are not i.i.d., which is exactly
the motivating scenario for federated learning. How to design robust
federated learning systems is an important topic for future research.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
This research was supported in part by the generosity of Eric and Wendy
Schmidt by recommendation of the Schmidt Futures program and NSF grant
1700832.

</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
M. Abadi, A. Chu, I. Goodfellow, H. B. McMahan, I. Mironov, K. Talwar, and
L. Zhang.

</span>
<span class="ltx_bibblock">Deep learning with differential privacy.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">CCS</span>, 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
M. Baruch, G. Baruch, and Y. Goldberg.

</span>
<span class="ltx_bibblock">A little is enough: Circumventing defenses for distributed learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv:1902.06156</span>, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
A. N. Bhagoji, S. Chakraborty, P. Mittal, and S. Calo.

</span>
<span class="ltx_bibblock">Analyzing federated learning through an adversarial lens.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv:1811.12470</span>, 2018.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
B. Biggio, B. Nelson, and P. Laskov.

</span>
<span class="ltx_bibblock">Poisoning attacks against support vector machines.

</span>
<span class="ltx_bibblock">In <span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2012.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
P. Blanchard, E. M. El Mhamdi, R. Guerraoui, and J. Stainer.

</span>
<span class="ltx_bibblock">Machine learning with adversaries: Byzantine tolerant gradient
descent.

</span>
<span class="ltx_bibblock">In <span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">NIPS</span>, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
K. Bonawitz, H. Eichner, W. Grieskamp, D. Huba, A. Ingerman,
V. Ivanov, C. Kiddon, J. Konecny, S. Mazzocchi, H. B. McMahan,
T. Van Overveldt, D. Petrou, D. Ramage, and J. Roselander.

</span>
<span class="ltx_bibblock">Towards federated learning at scale: System design.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv:1902.01046</span>, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
K. Bonawitz, V. Ivanov, B. Kreuter, A. Marcedone, H. B. McMahan, S. Patel,
D. Ramage, A. Segal, and K. Seth.

</span>
<span class="ltx_bibblock">Practical secure aggregation for privacy-preserving machine learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">CCS</span>, 2017.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
B. Chen, W. Carvalho, N. Baracaldo, H. Ludwig, B. Edwards, T. Lee, I. Molloy,
and B. Srivastava.

</span>
<span class="ltx_bibblock">Detecting backdoor attacks on deep neural networks by activation
clustering.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">arXiv:1811.03728</span>, 2018.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
H. Chen, C. Fu, J. Zhao, and F. Koushanfar.

</span>
<span class="ltx_bibblock">DeepInspect: A black-box trojan detection and mitigation framework
for deep neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">IJCAI</span>, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
J. Chen, R. Monga, S. Bengio, and R. Jozefowicz.

</span>
<span class="ltx_bibblock">Revisiting distributed synchronous SGD.

</span>
<span class="ltx_bibblock">In <span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">ICLR Workshop</span>, 2016.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
X. Chen, T. Chen, H. Sun, Z. S. Wu, and M. Hong.

</span>
<span class="ltx_bibblock">Distributed training with heterogeneous data: Bridging median and
mean based algorithms.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1906.01736</span>, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
X. Chen, C. Liu, B. Li, K. Lu, and D. Song.

</span>
<span class="ltx_bibblock">Targeted backdoor attacks on deep learning systems using data
poisoning.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv:1712.05526</span>, 2017.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Y. Chen, L. Su, and J. Xu.

</span>
<span class="ltx_bibblock">Distributed statistical machine learning in adversarial settings:
Byzantine gradient descent.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">arXiv:1705.05491</span>, 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
G. Damaskinos, E. M. El Mhamdi, R. Guerraoui, R. Patra, and M. Taziki.

</span>
<span class="ltx_bibblock">Asynchronous Byzantine machine learning (the case of SGD).

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2018.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Decentralized ML.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://decentralizedml.com/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://decentralizedml.com/</a>, 2019.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
J. Dumford and W. Scheirer.

</span>
<span class="ltx_bibblock">Backdooring convolutional neural networks via targeted weight
perturbations.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">arXiv:1812.03128</span>, 2018.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
E. M. El Mhamdi, R. Guerraoui, and S. Rouault.

</span>
<span class="ltx_bibblock">The hidden vulnerability of distributed learning in Byzantium.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">ICML</span>. PMLR, 2018.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
C. Fung, C. J. Yoon, and I. Beschastnikh.

</span>
<span class="ltx_bibblock">Mitigating sybils in federated learning poisoning.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">arXiv:1808.04866</span>, 2018.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Y. Gao, C. Xu, D. Wang, S. Chen, D. C. Ranasinghe, and S. Nepal.

</span>
<span class="ltx_bibblock">Strip: A defence against trojan attacks on deep neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">arXiv:1902.06531</span>, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
R. C. Geyer, T. Klein, and M. Nabi.

</span>
<span class="ltx_bibblock">Differentially private federated learning: A client level
perspective.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2018.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
I. Goodfellow, J. Shlens, and C. Szegedy.

</span>
<span class="ltx_bibblock">Explaining and harnessing adversarial examples.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2015.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
I. J. Goodfellow, M. Mirza, D. Xiao, A. Courville, and Y. Bengio.

</span>
<span class="ltx_bibblock">An empirical investigation of catastrophic forgetting in
gradient-based neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv:1312.6211</span>, 2013.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Google.

</span>
<span class="ltx_bibblock">Under the hood of the Pixel 2: How AI is supercharging hardware.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://ai.google/stories/ai-in-hardware/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ai.google/stories/ai-in-hardware/</a>, 2019.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
T. Gu, B. Dolan-Gavitt, and S. Garg.

</span>
<span class="ltx_bibblock">Badnets: Identifying vulnerabilities in the machine learning model
supply chain.

</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">arXiv:1708.06733</span>, 2017.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
A. Hard, K. Rao, R. Mathews, F. Beaufays, S. Augenstein, H. Eichner, C. Kiddon,
and D. Ramage.

</span>
<span class="ltx_bibblock">Federated learning for mobile keyboard prediction.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">arXiv:1811.03604</span>, 2018.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
S. Hardy, W. Henecka, H. Ivey-Law, R. Nock, G. Patrini, G. Smith, and
B. Thorne.

</span>
<span class="ltx_bibblock">Private federated learning on vertically partitioned data via entity
resolution and additively homomorphic encryption.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">arXiv:1711.10677</span>, 2017.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
J. Hayes and O. Ohrimenko.

</span>
<span class="ltx_bibblock">Contamination attacks and mitigation in multi-party machine learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2018.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">CVPR</span>, 2016.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
G. Hinton, O. Vinyals, and J. Dean.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock">In <span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">NIPS Workshop</span>, 2015.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
L. Huang, A. D. Joseph, B. Nelson, B. Rubinstein, and J. Tygar.

</span>
<span class="ltx_bibblock">Adversarial machine learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">AISec</span>, 2011.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
H. Inan, K. Khosravi, and R. Socher.

</span>
<span class="ltx_bibblock">Tying word vectors and word classifiers: A loss framework for
language modeling.

</span>
<span class="ltx_bibblock">In <span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2017.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Y. Ji, X. Zhang, S. Ji, X. Luo, and T. Wang.

</span>
<span class="ltx_bibblock">Model-reuse attacks on deep learning systems.

</span>
<span class="ltx_bibblock">In <span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">CCS</span>, 2018.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
J. Kirkpatrick, R. Pascanu, N. Rabinowitz, J. Veness, G. Desjardins, A. A.
Rusu, K. Milan, J. Quan, T. Ramalho, A. Grabska-Barwinska, et al.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Proc. NAS</span>, 114(13), 2017.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
J. Konečnỳ, H. B. McMahan, F. X. Yu, P. Richtárik, A. T. Suresh,
and D. Bacon.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">NIPS Workshop</span>, 2016.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
A. D. Kramer, J. E. Guillory, and J. T. Hancock.

</span>
<span class="ltx_bibblock">Experimental evidence of massive-scale emotional contagion through
social networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">Proc. NAS</span>, 111(24):8788–8790, 2014.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
A. Krizhevsky.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">Technical report, University of Toronto, 2009.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
A. Kurakin, I. Goodfellow, and S. Bengio.

</span>
<span class="ltx_bibblock">Adversarial examples in the physical world.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">ICLR Workshop</span>, 2017.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
H. Li, Z. Xu, G. Taylor, C. Studer, and T. Goldstein.

</span>
<span class="ltx_bibblock">Visualizing the loss landscape of neural nets.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2018.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Z. Li and D. Hoiem.

</span>
<span class="ltx_bibblock">Learning without forgetting.

</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">TPAMI</span>, 2018.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
K. Liu, B. Dolan-Gavitt, and S. Garg.

</span>
<span class="ltx_bibblock">Fine-pruning: Defending against backdooring attacks on deep neural
networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">arXiv:1805.12185</span>, 2018.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
Y. Liu, S. Ma, Y. Aafer, W.-C. Lee, J. Zhai, W. Wang, and X. Zhang.

</span>
<span class="ltx_bibblock">Trojaning attack on neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">NDSS</span>, 2017.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
S. Mahloujifar, M. Mahmoody, and A. Mohammed.

</span>
<span class="ltx_bibblock">Multi-party poisoning through generalized <math id="bib.bib42.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="bib.bib42.1.m1.1a"><mi id="bib.bib42.1.m1.1.1" xref="bib.bib42.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="bib.bib42.1.m1.1b"><ci id="bib.bib42.1.m1.1.1.cmml" xref="bib.bib42.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib42.1.m1.1c">p</annotation></semantics></math>-tampering.

</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text ltx_font_italic">arXiv:1809.03474</span>, 2018.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
H. B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. Agüera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib43.1.1" class="ltx_text ltx_font_italic">AISTATS</span>, 2017.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
H. B. McMahan, D. Ramage, K. Talwar, and L. Zhang.

</span>
<span class="ltx_bibblock">Learning differentially private recurrent language models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib44.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2018.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
L. Melis, C. Song, E. De Cristofaro, and V. Shmatikov.

</span>
<span class="ltx_bibblock">Exploiting unintended feature leakage in collaborative learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">S&amp;P</span>, 2019.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
T. Minka.

</span>
<span class="ltx_bibblock">Estimating a Dirichlet distribution.

</span>
<span class="ltx_bibblock">Technical report, MIT, 2000.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
P. Mohassel and Y. Zhang.

</span>
<span class="ltx_bibblock">SecureML: A system for scalable privacy-preserving machine
learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib47.1.1" class="ltx_text ltx_font_italic">S&amp;P</span>, 2017.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
M. Nasr, R. Shokri, and A. Houmansadr.

</span>
<span class="ltx_bibblock">Comprehensive privacy analysis of deep learning: Stand-alone and
federated learning under passive and active white-box inference attacks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">S&amp;P</span>, 2019.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
C. V. Nguyen, Y. Li, T. D. Bui, and R. E. Turner.

</span>
<span class="ltx_bibblock">Variational continual learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib49.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2018.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
OpenMined.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://www.openmined.org/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.openmined.org/</a>, 2019.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
N. Papernot, M. Abadi, Ú. Erlingsson, I. Goodfellow, and K. Talwar.

</span>
<span class="ltx_bibblock">Semi-supervised knowledge transfer for deep learning from private
training data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2017.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
N. Papernot, P. McDaniel, I. Goodfellow, S. Jha, Z. B. Celik, and A. Swami.

</span>
<span class="ltx_bibblock">Practical black-box attacks against machine learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib52.1.1" class="ltx_text ltx_font_italic">ASIA CCS</span>, 2017.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
N. Papernot, S. Song, I. Mironov, A. Raghunathan, K. Talwar, and
Ú. Erlingsson.

</span>
<span class="ltx_bibblock">Scalable private learning with PATE.

</span>
<span class="ltx_bibblock">In <span id="bib.bib53.1.1" class="ltx_text ltx_font_italic">ICLR</span>, 2018.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
A. Paszke, S. Gross, S. Chintala, G. Chanan, E. Yang, Z. DeVito, Z. Lin,
A. Desmaison, L. Antiga, and A. Lerer.

</span>
<span class="ltx_bibblock">Automatic differentiation in PyTorch.

</span>
<span class="ltx_bibblock">In <span id="bib.bib54.1.1" class="ltx_text ltx_font_italic">NIPS Workshop</span>, 2017.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
O. Press and L. Wolf.

</span>
<span class="ltx_bibblock">Using the output embedding to improve language models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib55.1.1" class="ltx_text ltx_font_italic">EACL</span>, 2017.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
PyTorch examples.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://github.com/pytorch/examples/tree/master/word_language_model/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/pytorch/examples/tree/master/word_language_model/</a>, 2019.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
M. Qiao and G. Valiant.

</span>
<span class="ltx_bibblock">Learning discrete distributions from untrusted batches.

</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text ltx_font_italic">arXiv:1711.08113</span>, 2017.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[58]</span>
<span class="ltx_bibblock">
B. Rubinstein, B. Nelson, L. Huang, A. D. Joseph, S.-h. Lau, S. Rao, N. Taft,
and J. D. Tygar.

</span>
<span class="ltx_bibblock">Antidote: Understanding and defending against poisoning of anomaly
detectors.

</span>
<span class="ltx_bibblock">In <span id="bib.bib58.1.1" class="ltx_text ltx_font_italic">IMC</span>, 2009.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[59]</span>
<span class="ltx_bibblock">
M. Shayan, C. Fung, C. J. Yoon, and I. Beschastnikh.

</span>
<span class="ltx_bibblock">Biscotti: A ledger for private and secure peer-to-peer machine
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text ltx_font_italic">arXiv:1811.09904</span>, 2018.

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[60]</span>
<span class="ltx_bibblock">
S. Shen, S. Tople, and P. Saxena.

</span>
<span class="ltx_bibblock">Auror: Defending against poisoning attacks in collaborative deep
learning systems.

</span>
<span class="ltx_bibblock">In <span id="bib.bib60.1.1" class="ltx_text ltx_font_italic">ACSAC</span>, 2016.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[61]</span>
<span class="ltx_bibblock">
R. Shokri and V. Shmatikov.

</span>
<span class="ltx_bibblock">Privacy-preserving deep learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib61.1.1" class="ltx_text ltx_font_italic">CCS</span>, 2015.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[62]</span>
<span class="ltx_bibblock">
R. Shokri, M. Stronati, C. Song, and V. Shmatikov.

</span>
<span class="ltx_bibblock">Membership inference attacks against machine learning models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib62.1.1" class="ltx_text ltx_font_italic">S&amp;P</span>, 2017.

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[63]</span>
<span class="ltx_bibblock">
J. Steinhardt, P. W. Koh, and P. S. Liang.

</span>
<span class="ltx_bibblock">Certified defenses for data poisoning attacks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib63.1.1" class="ltx_text ltx_font_italic">NIPS</span>, 2017.

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[64]</span>
<span class="ltx_bibblock">
T. J. L. Tan and R. Shokri.

</span>
<span class="ltx_bibblock">Bypassing backdoor detection algorithms in deep learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib64.1.1" class="ltx_text ltx_font_italic">arXiv:1905.13409</span>, 2019.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[65]</span>
<span class="ltx_bibblock">
B. Tran, J. Li, and A. Madry.

</span>
<span class="ltx_bibblock">Spectral signatures in backdoor attacks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib65.1.1" class="ltx_text ltx_font_italic">NeurIPS</span>, 2018.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[66]</span>
<span class="ltx_bibblock">
A. Turner, D. Tsipras, and A. Madry.

</span>
<span class="ltx_bibblock">Clean-label backdoor attacks.

</span>
<span class="ltx_bibblock"><a target="_blank" href="https://openreview.net/forum?id=HJg6e2CcK7" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=HJg6e2CcK7</a>, 2018.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[67]</span>
<span class="ltx_bibblock">
B. Wang, Y. Yao, S. Shan, H. Li, B. Viswanath, H. Zheng, and B. Y. Zhao.

</span>
<span class="ltx_bibblock">Neural cleanse: Identifying and mitigating backdoor attacks in neural
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib67.1.1" class="ltx_text ltx_font_italic">S&amp;P</span>, 2019.

</span>
</li>
<li id="bib.bib68" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[68]</span>
<span class="ltx_bibblock">
C. Xie, O. Koyejo, and I. Gupta.

</span>
<span class="ltx_bibblock">Generalized byzantine-tolerant SGD.

</span>
<span class="ltx_bibblock"><span id="bib.bib68.1.1" class="ltx_text ltx_font_italic">arXiv:1802.10116</span>, 2018.

</span>
</li>
<li id="bib.bib69" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[69]</span>
<span class="ltx_bibblock">
C. Xie, O. Koyejo, and I. Gupta.

</span>
<span class="ltx_bibblock">Zeno: Byzantine-suspicious stochastic gradient descent.

</span>
<span class="ltx_bibblock"><span id="bib.bib69.1.1" class="ltx_text ltx_font_italic">arXiv:1805.10032</span>, 2018.

</span>
</li>
<li id="bib.bib70" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[70]</span>
<span class="ltx_bibblock">
M. Yeomans, A. K. Shah, S. Mullainathan, and J. Kleinberg.

</span>
<span class="ltx_bibblock">Making sense of recommendations.

</span>
<span class="ltx_bibblock"><span id="bib.bib70.1.1" class="ltx_text ltx_font_italic">Management Science</span>, 2016.

</span>
</li>
<li id="bib.bib71" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[71]</span>
<span class="ltx_bibblock">
D. Yin, Y. Chen, R. Kannan, and P. Bartlett.

</span>
<span class="ltx_bibblock">Byzantine-robust distributed learning: Towards optimal statistical
rates.

</span>
<span class="ltx_bibblock">In <span id="bib.bib71.1.1" class="ltx_text ltx_font_italic">ICML</span>, 2018.

</span>
</li>
<li id="bib.bib72" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[72]</span>
<span class="ltx_bibblock">
X. Zhang, X. Y. Felix, S. Kumar, and S.-F. Chang.

</span>
<span class="ltx_bibblock">Learning spread-out local feature descriptors.

</span>
<span class="ltx_bibblock">In <span id="bib.bib72.1.1" class="ltx_text ltx_font_italic">ICCV</span>, 2017.

</span>
</li>
<li id="bib.bib73" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[73]</span>
<span class="ltx_bibblock">
M. Zou, Y. Shi, C. Wang, F. Li, W. Song, and Y. Wang.

</span>
<span class="ltx_bibblock">PoTrojan: Powerful neural-level trojan designs in deep learning
models.

</span>
<span class="ltx_bibblock"><span id="bib.bib73.1.1" class="ltx_text ltx_font_italic">arXiv:1802.03043</span>, 2018.

</span>
</li>
</ul>
</section>
<figure id="A0.F11" class="ltx_figure"><img src="/html/1807.00459/assets/x11.png" id="A0.F11.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="244" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11. </span><span id="A0.F11.2.1" class="ltx_text ltx_font_bold">Evading anomaly detection for word prediction.</span> (a):
parameter clustering; (b): accuracy auditing; (c) and (d): backdoor
accuracy when 5 participants per round are malicious.</figcaption>
</figure>
<figure id="A0.F12" class="ltx_figure"><img src="/html/1807.00459/assets/x12.png" id="A0.F12.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="200" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12. </span><span id="A0.F12.2.1" class="ltx_text ltx_font_bold">Evading anomaly detection for CIFAR image
classification.</span> </figcaption>
</figure>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Undeployable Defenses</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">As explained in Section <a href="#S6.SS1" title="6.1. Anomaly detection ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>, defenses that require
inspection of the participants’ model updates violate privacy of the
training data and are not supported by secure aggregation. We discuss
them here to demonstrate that even if they are incorporated into secure
aggregation in the future, they will not be effective.</p>
</div>
<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1. </span>Clustering</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p">To prevent poisoning in distributed learning,
specifically <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>]</cite>, Auror <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite> uses k-means
to cluster participants’ updates across training rounds and discards
the outliers. This defense is not compatible with federated learning
because it breaks confidentiality of the updates and consequently of
the underlying training data <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>.</p>
</div>
<div id="A1.SS1.p2" class="ltx_para">
<p id="A1.SS1.p2.1" class="ltx_p">Furthermore, this defense is not effective. First, it assumes that
the attacker attempts to poison the global model in every round.
Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows that even a single-round attack can introduce a
backdoor that the global model does not unlearn for a long time. Second,
when the training data are not i.i.d. across the participants, this
defense is likely to discard contributions from many “interesting”
participants and thus hurt the accuracy of the global model (this is
not evaluated in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>).</p>
</div>
<div id="A1.SS1.p3" class="ltx_para">
<p id="A1.SS1.p3.2" class="ltx_p">Finally, as explained in Section <a href="#S4.SS3" title="4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a>, the attacker can
use the train-and-scale method to evade detection. This is especially
effective if the attacker controls several participants (<cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>
assumes a single attacker, but this is unrealistic in federated learning)
and splits scaled weight updates among them, staying under the norm bound
<math id="A1.SS1.p3.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="A1.SS1.p3.1.m1.1a"><mi id="A1.SS1.p3.1.m1.1.1" xref="A1.SS1.p3.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.1.m1.1b"><ci id="A1.SS1.p3.1.m1.1.1.cmml" xref="A1.SS1.p3.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.1.m1.1c">S</annotation></semantics></math> for each individual update. If the attacker controls <math id="A1.SS1.p3.2.m2.1" class="ltx_Math" alttext="z" display="inline"><semantics id="A1.SS1.p3.2.m2.1a"><mi id="A1.SS1.p3.2.m2.1.1" xref="A1.SS1.p3.2.m2.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p3.2.m2.1b"><ci id="A1.SS1.p3.2.m2.1.1.cmml" xref="A1.SS1.p3.2.m2.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p3.2.m2.1c">z</annotation></semantics></math> participants
in a round, the total update following Eq. <a href="#S4.E5" title="In 4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> is:</p>
<table id="A1.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A1.E6.m1.2" class="ltx_Math" alttext="\sum_{i}^{z}{\widetilde{L}_{i}^{t+1}}=z(\gamma X)=\frac{z\cdot S}{||X-G^{t}||_{2}}\cdot X" display="block"><semantics id="A1.E6.m1.2a"><mrow id="A1.E6.m1.2.2" xref="A1.E6.m1.2.2.cmml"><mrow id="A1.E6.m1.2.2.3" xref="A1.E6.m1.2.2.3.cmml"><munderover id="A1.E6.m1.2.2.3.1" xref="A1.E6.m1.2.2.3.1.cmml"><mo movablelimits="false" id="A1.E6.m1.2.2.3.1.2.2" xref="A1.E6.m1.2.2.3.1.2.2.cmml">∑</mo><mi id="A1.E6.m1.2.2.3.1.2.3" xref="A1.E6.m1.2.2.3.1.2.3.cmml">i</mi><mi id="A1.E6.m1.2.2.3.1.3" xref="A1.E6.m1.2.2.3.1.3.cmml">z</mi></munderover><msubsup id="A1.E6.m1.2.2.3.2" xref="A1.E6.m1.2.2.3.2.cmml"><mover accent="true" id="A1.E6.m1.2.2.3.2.2.2" xref="A1.E6.m1.2.2.3.2.2.2.cmml"><mi id="A1.E6.m1.2.2.3.2.2.2.2" xref="A1.E6.m1.2.2.3.2.2.2.2.cmml">L</mi><mo id="A1.E6.m1.2.2.3.2.2.2.1" xref="A1.E6.m1.2.2.3.2.2.2.1.cmml">~</mo></mover><mi id="A1.E6.m1.2.2.3.2.2.3" xref="A1.E6.m1.2.2.3.2.2.3.cmml">i</mi><mrow id="A1.E6.m1.2.2.3.2.3" xref="A1.E6.m1.2.2.3.2.3.cmml"><mi id="A1.E6.m1.2.2.3.2.3.2" xref="A1.E6.m1.2.2.3.2.3.2.cmml">t</mi><mo id="A1.E6.m1.2.2.3.2.3.1" xref="A1.E6.m1.2.2.3.2.3.1.cmml">+</mo><mn id="A1.E6.m1.2.2.3.2.3.3" xref="A1.E6.m1.2.2.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="A1.E6.m1.2.2.4" xref="A1.E6.m1.2.2.4.cmml">=</mo><mrow id="A1.E6.m1.2.2.1" xref="A1.E6.m1.2.2.1.cmml"><mi id="A1.E6.m1.2.2.1.3" xref="A1.E6.m1.2.2.1.3.cmml">z</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.2.1.2" xref="A1.E6.m1.2.2.1.2.cmml">​</mo><mrow id="A1.E6.m1.2.2.1.1.1" xref="A1.E6.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A1.E6.m1.2.2.1.1.1.2" xref="A1.E6.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="A1.E6.m1.2.2.1.1.1.1" xref="A1.E6.m1.2.2.1.1.1.1.cmml"><mi id="A1.E6.m1.2.2.1.1.1.1.2" xref="A1.E6.m1.2.2.1.1.1.1.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="A1.E6.m1.2.2.1.1.1.1.1" xref="A1.E6.m1.2.2.1.1.1.1.1.cmml">​</mo><mi id="A1.E6.m1.2.2.1.1.1.1.3" xref="A1.E6.m1.2.2.1.1.1.1.3.cmml">X</mi></mrow><mo stretchy="false" id="A1.E6.m1.2.2.1.1.1.3" xref="A1.E6.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.E6.m1.2.2.5" xref="A1.E6.m1.2.2.5.cmml">=</mo><mrow id="A1.E6.m1.2.2.6" xref="A1.E6.m1.2.2.6.cmml"><mfrac id="A1.E6.m1.1.1" xref="A1.E6.m1.1.1.cmml"><mrow id="A1.E6.m1.1.1.3" xref="A1.E6.m1.1.1.3.cmml"><mi id="A1.E6.m1.1.1.3.2" xref="A1.E6.m1.1.1.3.2.cmml">z</mi><mo lspace="0.222em" rspace="0.222em" id="A1.E6.m1.1.1.3.1" xref="A1.E6.m1.1.1.3.1.cmml">⋅</mo><mi id="A1.E6.m1.1.1.3.3" xref="A1.E6.m1.1.1.3.3.cmml">S</mi></mrow><msub id="A1.E6.m1.1.1.1" xref="A1.E6.m1.1.1.1.cmml"><mrow id="A1.E6.m1.1.1.1.1.1" xref="A1.E6.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E6.m1.1.1.1.1.1.2" xref="A1.E6.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A1.E6.m1.1.1.1.1.1.1" xref="A1.E6.m1.1.1.1.1.1.1.cmml"><mi id="A1.E6.m1.1.1.1.1.1.1.2" xref="A1.E6.m1.1.1.1.1.1.1.2.cmml">X</mi><mo id="A1.E6.m1.1.1.1.1.1.1.1" xref="A1.E6.m1.1.1.1.1.1.1.1.cmml">−</mo><msup id="A1.E6.m1.1.1.1.1.1.1.3" xref="A1.E6.m1.1.1.1.1.1.1.3.cmml"><mi id="A1.E6.m1.1.1.1.1.1.1.3.2" xref="A1.E6.m1.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="A1.E6.m1.1.1.1.1.1.1.3.3" xref="A1.E6.m1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="A1.E6.m1.1.1.1.1.1.3" xref="A1.E6.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E6.m1.1.1.1.3" xref="A1.E6.m1.1.1.1.3.cmml">2</mn></msub></mfrac><mo lspace="0.222em" rspace="0.222em" id="A1.E6.m1.2.2.6.1" xref="A1.E6.m1.2.2.6.1.cmml">⋅</mo><mi id="A1.E6.m1.2.2.6.2" xref="A1.E6.m1.2.2.6.2.cmml">X</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E6.m1.2b"><apply id="A1.E6.m1.2.2.cmml" xref="A1.E6.m1.2.2"><and id="A1.E6.m1.2.2a.cmml" xref="A1.E6.m1.2.2"></and><apply id="A1.E6.m1.2.2b.cmml" xref="A1.E6.m1.2.2"><eq id="A1.E6.m1.2.2.4.cmml" xref="A1.E6.m1.2.2.4"></eq><apply id="A1.E6.m1.2.2.3.cmml" xref="A1.E6.m1.2.2.3"><apply id="A1.E6.m1.2.2.3.1.cmml" xref="A1.E6.m1.2.2.3.1"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.3.1.1.cmml" xref="A1.E6.m1.2.2.3.1">superscript</csymbol><apply id="A1.E6.m1.2.2.3.1.2.cmml" xref="A1.E6.m1.2.2.3.1"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.3.1.2.1.cmml" xref="A1.E6.m1.2.2.3.1">subscript</csymbol><sum id="A1.E6.m1.2.2.3.1.2.2.cmml" xref="A1.E6.m1.2.2.3.1.2.2"></sum><ci id="A1.E6.m1.2.2.3.1.2.3.cmml" xref="A1.E6.m1.2.2.3.1.2.3">𝑖</ci></apply><ci id="A1.E6.m1.2.2.3.1.3.cmml" xref="A1.E6.m1.2.2.3.1.3">𝑧</ci></apply><apply id="A1.E6.m1.2.2.3.2.cmml" xref="A1.E6.m1.2.2.3.2"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.3.2.1.cmml" xref="A1.E6.m1.2.2.3.2">superscript</csymbol><apply id="A1.E6.m1.2.2.3.2.2.cmml" xref="A1.E6.m1.2.2.3.2"><csymbol cd="ambiguous" id="A1.E6.m1.2.2.3.2.2.1.cmml" xref="A1.E6.m1.2.2.3.2">subscript</csymbol><apply id="A1.E6.m1.2.2.3.2.2.2.cmml" xref="A1.E6.m1.2.2.3.2.2.2"><ci id="A1.E6.m1.2.2.3.2.2.2.1.cmml" xref="A1.E6.m1.2.2.3.2.2.2.1">~</ci><ci id="A1.E6.m1.2.2.3.2.2.2.2.cmml" xref="A1.E6.m1.2.2.3.2.2.2.2">𝐿</ci></apply><ci id="A1.E6.m1.2.2.3.2.2.3.cmml" xref="A1.E6.m1.2.2.3.2.2.3">𝑖</ci></apply><apply id="A1.E6.m1.2.2.3.2.3.cmml" xref="A1.E6.m1.2.2.3.2.3"><plus id="A1.E6.m1.2.2.3.2.3.1.cmml" xref="A1.E6.m1.2.2.3.2.3.1"></plus><ci id="A1.E6.m1.2.2.3.2.3.2.cmml" xref="A1.E6.m1.2.2.3.2.3.2">𝑡</ci><cn type="integer" id="A1.E6.m1.2.2.3.2.3.3.cmml" xref="A1.E6.m1.2.2.3.2.3.3">1</cn></apply></apply></apply><apply id="A1.E6.m1.2.2.1.cmml" xref="A1.E6.m1.2.2.1"><times id="A1.E6.m1.2.2.1.2.cmml" xref="A1.E6.m1.2.2.1.2"></times><ci id="A1.E6.m1.2.2.1.3.cmml" xref="A1.E6.m1.2.2.1.3">𝑧</ci><apply id="A1.E6.m1.2.2.1.1.1.1.cmml" xref="A1.E6.m1.2.2.1.1.1"><times id="A1.E6.m1.2.2.1.1.1.1.1.cmml" xref="A1.E6.m1.2.2.1.1.1.1.1"></times><ci id="A1.E6.m1.2.2.1.1.1.1.2.cmml" xref="A1.E6.m1.2.2.1.1.1.1.2">𝛾</ci><ci id="A1.E6.m1.2.2.1.1.1.1.3.cmml" xref="A1.E6.m1.2.2.1.1.1.1.3">𝑋</ci></apply></apply></apply><apply id="A1.E6.m1.2.2c.cmml" xref="A1.E6.m1.2.2"><eq id="A1.E6.m1.2.2.5.cmml" xref="A1.E6.m1.2.2.5"></eq><share href="#A1.E6.m1.2.2.1.cmml" id="A1.E6.m1.2.2d.cmml" xref="A1.E6.m1.2.2"></share><apply id="A1.E6.m1.2.2.6.cmml" xref="A1.E6.m1.2.2.6"><ci id="A1.E6.m1.2.2.6.1.cmml" xref="A1.E6.m1.2.2.6.1">⋅</ci><apply id="A1.E6.m1.1.1.cmml" xref="A1.E6.m1.1.1"><divide id="A1.E6.m1.1.1.2.cmml" xref="A1.E6.m1.1.1"></divide><apply id="A1.E6.m1.1.1.3.cmml" xref="A1.E6.m1.1.1.3"><ci id="A1.E6.m1.1.1.3.1.cmml" xref="A1.E6.m1.1.1.3.1">⋅</ci><ci id="A1.E6.m1.1.1.3.2.cmml" xref="A1.E6.m1.1.1.3.2">𝑧</ci><ci id="A1.E6.m1.1.1.3.3.cmml" xref="A1.E6.m1.1.1.3.3">𝑆</ci></apply><apply id="A1.E6.m1.1.1.1.cmml" xref="A1.E6.m1.1.1.1"><csymbol cd="ambiguous" id="A1.E6.m1.1.1.1.2.cmml" xref="A1.E6.m1.1.1.1">subscript</csymbol><apply id="A1.E6.m1.1.1.1.1.2.cmml" xref="A1.E6.m1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E6.m1.1.1.1.1.2.1.cmml" xref="A1.E6.m1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E6.m1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.1.1.1.1.1.1"><minus id="A1.E6.m1.1.1.1.1.1.1.1.cmml" xref="A1.E6.m1.1.1.1.1.1.1.1"></minus><ci id="A1.E6.m1.1.1.1.1.1.1.2.cmml" xref="A1.E6.m1.1.1.1.1.1.1.2">𝑋</ci><apply id="A1.E6.m1.1.1.1.1.1.1.3.cmml" xref="A1.E6.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="A1.E6.m1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E6.m1.1.1.1.1.1.1.3.2">𝐺</ci><ci id="A1.E6.m1.1.1.1.1.1.1.3.3.cmml" xref="A1.E6.m1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><cn type="integer" id="A1.E6.m1.1.1.1.3.cmml" xref="A1.E6.m1.1.1.1.3">2</cn></apply></apply><ci id="A1.E6.m1.2.2.6.2.cmml" xref="A1.E6.m1.2.2.6.2">𝑋</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E6.m1.2c">\sum_{i}^{z}{\widetilde{L}_{i}^{t+1}}=z(\gamma X)=\frac{z\cdot S}{||X-G^{t}||_{2}}\cdot X</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="A1.SS1.p3.3" class="ltx_p">Fig. <a href="#A0.F11" title="Figure 11 ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>(a) shows the distribution of the attacker’s updates
vs. benign participants’ updates. For example, compromising 5 out of
100 participants enables the attacker to look “normal” while achieving
50% backdoor accuracy on the global model.</p>
</div>
<div id="A1.SS1.p4" class="ltx_para">
<p id="A1.SS1.p4.2" class="ltx_p">This technique is effective for image-classification models, too.
Fig. <a href="#A0.F12" title="Figure 12 ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> shows the results when the attacker controls
1 or 2 participants in a single round of training and submits model
weights using Eq. <a href="#A1.E6" title="In A.1. Clustering ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>. To lower the distance from
the global model, we decrease the initial learning rate to <math id="A1.SS1.p4.1.m1.1" class="ltx_Math" alttext="1e^{-4}" display="inline"><semantics id="A1.SS1.p4.1.m1.1a"><mrow id="A1.SS1.p4.1.m1.1.1" xref="A1.SS1.p4.1.m1.1.1.cmml"><mn id="A1.SS1.p4.1.m1.1.1.2" xref="A1.SS1.p4.1.m1.1.1.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.SS1.p4.1.m1.1.1.1" xref="A1.SS1.p4.1.m1.1.1.1.cmml">​</mo><msup id="A1.SS1.p4.1.m1.1.1.3" xref="A1.SS1.p4.1.m1.1.1.3.cmml"><mi id="A1.SS1.p4.1.m1.1.1.3.2" xref="A1.SS1.p4.1.m1.1.1.3.2.cmml">e</mi><mrow id="A1.SS1.p4.1.m1.1.1.3.3" xref="A1.SS1.p4.1.m1.1.1.3.3.cmml"><mo id="A1.SS1.p4.1.m1.1.1.3.3a" xref="A1.SS1.p4.1.m1.1.1.3.3.cmml">−</mo><mn id="A1.SS1.p4.1.m1.1.1.3.3.2" xref="A1.SS1.p4.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.1.m1.1b"><apply id="A1.SS1.p4.1.m1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1"><times id="A1.SS1.p4.1.m1.1.1.1.cmml" xref="A1.SS1.p4.1.m1.1.1.1"></times><cn type="integer" id="A1.SS1.p4.1.m1.1.1.2.cmml" xref="A1.SS1.p4.1.m1.1.1.2">1</cn><apply id="A1.SS1.p4.1.m1.1.1.3.cmml" xref="A1.SS1.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.p4.1.m1.1.1.3.1.cmml" xref="A1.SS1.p4.1.m1.1.1.3">superscript</csymbol><ci id="A1.SS1.p4.1.m1.1.1.3.2.cmml" xref="A1.SS1.p4.1.m1.1.1.3.2">𝑒</ci><apply id="A1.SS1.p4.1.m1.1.1.3.3.cmml" xref="A1.SS1.p4.1.m1.1.1.3.3"><minus id="A1.SS1.p4.1.m1.1.1.3.3.1.cmml" xref="A1.SS1.p4.1.m1.1.1.3.3"></minus><cn type="integer" id="A1.SS1.p4.1.m1.1.1.3.3.2.cmml" xref="A1.SS1.p4.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.1.m1.1c">1e^{-4}</annotation></semantics></math>.
This eliminates the “re-poisoning” effect shown on Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.2. Word prediction ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>
(a drop and subsequent increase in backdoor accuracy), but produces
a model that does not have an anomalous <math id="A1.SS1.p4.2.m2.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="A1.SS1.p4.2.m2.1a"><msub id="A1.SS1.p4.2.m2.1.1" xref="A1.SS1.p4.2.m2.1.1.cmml"><mi id="A1.SS1.p4.2.m2.1.1.2" xref="A1.SS1.p4.2.m2.1.1.2.cmml">L</mi><mn id="A1.SS1.p4.2.m2.1.1.3" xref="A1.SS1.p4.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.p4.2.m2.1b"><apply id="A1.SS1.p4.2.m2.1.1.cmml" xref="A1.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS1.p4.2.m2.1.1.1.cmml" xref="A1.SS1.p4.2.m2.1.1">subscript</csymbol><ci id="A1.SS1.p4.2.m2.1.1.2.cmml" xref="A1.SS1.p4.2.m2.1.1.2">𝐿</ci><cn type="integer" id="A1.SS1.p4.2.m2.1.1.3.cmml" xref="A1.SS1.p4.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p4.2.m2.1c">L_{2}</annotation></semantics></math> norm and maintains high
accuracy on the main task.</p>
</div>
<div id="A1.SS1.p5" class="ltx_para ltx_noindent">
<p id="A1.SS1.p5.5" class="ltx_p"><span id="A1.SS1.p5.1.1" class="ltx_text ltx_font_bold ltx_font_italic">Estimating <math id="A1.SS1.p5.1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="A1.SS1.p5.1.1.m1.1a"><mi mathvariant="normal" id="A1.SS1.p5.1.1.m1.1.1" xref="A1.SS1.p5.1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.1.1.m1.1b"><ci id="A1.SS1.p5.1.1.m1.1.1.cmml" xref="A1.SS1.p5.1.1.m1.1.1">S</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.1.1.m1.1c">S</annotation></semantics></math>.</span> 
The anomaly detector may conceal from the participants the norm bound <math id="A1.SS1.p5.2.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="A1.SS1.p5.2.m1.1a"><mi id="A1.SS1.p5.2.m1.1.1" xref="A1.SS1.p5.2.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.2.m1.1b"><ci id="A1.SS1.p5.2.m1.1.1.cmml" xref="A1.SS1.p5.2.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.2.m1.1c">S</annotation></semantics></math>
that it uses to detect “anomalous” contributions. The attacker has two
ways to estimate the value of <math id="A1.SS1.p5.3.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="A1.SS1.p5.3.m2.1a"><mi id="A1.SS1.p5.3.m2.1.1" xref="A1.SS1.p5.3.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.3.m2.1b"><ci id="A1.SS1.p5.3.m2.1.1.cmml" xref="A1.SS1.p5.3.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.3.m2.1c">S</annotation></semantics></math>: (1) sacrifice one of the compromised
participants by iteratively increasing <math id="A1.SS1.p5.4.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="A1.SS1.p5.4.m3.1a"><mi id="A1.SS1.p5.4.m3.1.1" xref="A1.SS1.p5.4.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.4.m3.1b"><ci id="A1.SS1.p5.4.m3.1.1.cmml" xref="A1.SS1.p5.4.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.4.m3.1c">S</annotation></semantics></math> and submitting model updates
using Eq. <a href="#S4.E5" title="In 4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> until the participant is banned, or
(2) estimate the distribution of weight norms among the <em id="A1.SS1.p5.5.2" class="ltx_emph ltx_font_italic">benign</em>
participants by training multiple local models either on random inputs,
or, in the case of word-prediction models, on relatively hard inputs
(see Table <a href="#S6.T1" title="Table 1 ‣ 6.1. Anomaly detection ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>). Because the anomaly detector cannot afford
to filter out most benign contributions, the attacker can assume that <math id="A1.SS1.p5.5.m4.1" class="ltx_Math" alttext="S" display="inline"><semantics id="A1.SS1.p5.5.m4.1a"><mi id="A1.SS1.p5.5.m4.1.1" xref="A1.SS1.p5.5.m4.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p5.5.m4.1b"><ci id="A1.SS1.p5.5.m4.1.1.cmml" xref="A1.SS1.p5.5.m4.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p5.5.m4.1c">S</annotation></semantics></math>
is set near the upper bound of this distribution.</p>
</div>
<div id="A1.SS1.p6" class="ltx_para">
<p id="A1.SS1.p6.1" class="ltx_p">The first method requires multiple compromised participants but
no domain knowledge. The second method requires domain knowledge
but yields a good local estimate of <math id="A1.SS1.p6.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="A1.SS1.p6.1.m1.1a"><mi id="A1.SS1.p6.1.m1.1.1" xref="A1.SS1.p6.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.p6.1.m1.1b"><ci id="A1.SS1.p6.1.m1.1.1.cmml" xref="A1.SS1.p6.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.p6.1.m1.1c">S</annotation></semantics></math> without triggering the
anomaly detector. For example, the mean of norms for word-prediction
models trained on popular words as input and rare words as output (per
Table <a href="#S6.T1" title="Table 1 ‣ 6.1. Anomaly detection ‣ 6. Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) cuts out only the top 5% of the benign updates.
The two estimation methods can also be used in tandem.</p>
</div>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2. </span>Cosine similarity</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">Another defense <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> targets sybil attacks by
exploiting the observation that in high-dimensional spaces, random
vectors are orthogonal <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib72" title="" class="ltx_ref">72</a>]</cite>. It measures the cosine
similarity across the submitted updates and discards those that are
very similar to each other. It cannot be deployed as part of federated
learning because the secure aggregator cannot measure the similarity of
confidential updates.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para">
<p id="A1.SS2.p2.1" class="ltx_p">In theory, this defense may also defeat a backdoor attacker who
splits his model among multiple participants but, as pointed out
in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, the attacker can evade it by decomposing
the model into orthogonal vectors, one per each attacker-controlled
participant.</p>
</div>
<div id="A1.SS2.p3" class="ltx_para">
<p id="A1.SS2.p3.1" class="ltx_p">Another suggestion in <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> is to isolate the
indicative features (e.g., model weights) that are important for the
attack from those that are important for the benign models. We are
not aware of any way to determine which features are associated with
backdoors and which are important for the benign models, especially when
the latter are trained on participants’ local, non-i.i.d. data.</p>
</div>
<div id="A1.SS2.p4" class="ltx_para">
<p id="A1.SS2.p4.5" class="ltx_p">Another possible defense is to compute the pairwise cosine similarity
between all participants’ updates hoping that the attacker’s
<math id="A1.SS2.p4.1.m1.1" class="ltx_Math" alttext="\tilde{L}^{t+1}_{m}=\gamma(X-G^{t})+G^{t}" display="inline"><semantics id="A1.SS2.p4.1.m1.1a"><mrow id="A1.SS2.p4.1.m1.1.1" xref="A1.SS2.p4.1.m1.1.1.cmml"><msubsup id="A1.SS2.p4.1.m1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.3.cmml"><mover accent="true" id="A1.SS2.p4.1.m1.1.1.3.2.2" xref="A1.SS2.p4.1.m1.1.1.3.2.2.cmml"><mi id="A1.SS2.p4.1.m1.1.1.3.2.2.2" xref="A1.SS2.p4.1.m1.1.1.3.2.2.2.cmml">L</mi><mo id="A1.SS2.p4.1.m1.1.1.3.2.2.1" xref="A1.SS2.p4.1.m1.1.1.3.2.2.1.cmml">~</mo></mover><mi id="A1.SS2.p4.1.m1.1.1.3.3" xref="A1.SS2.p4.1.m1.1.1.3.3.cmml">m</mi><mrow id="A1.SS2.p4.1.m1.1.1.3.2.3" xref="A1.SS2.p4.1.m1.1.1.3.2.3.cmml"><mi id="A1.SS2.p4.1.m1.1.1.3.2.3.2" xref="A1.SS2.p4.1.m1.1.1.3.2.3.2.cmml">t</mi><mo id="A1.SS2.p4.1.m1.1.1.3.2.3.1" xref="A1.SS2.p4.1.m1.1.1.3.2.3.1.cmml">+</mo><mn id="A1.SS2.p4.1.m1.1.1.3.2.3.3" xref="A1.SS2.p4.1.m1.1.1.3.2.3.3.cmml">1</mn></mrow></msubsup><mo id="A1.SS2.p4.1.m1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.2.cmml">=</mo><mrow id="A1.SS2.p4.1.m1.1.1.1" xref="A1.SS2.p4.1.m1.1.1.1.cmml"><mrow id="A1.SS2.p4.1.m1.1.1.1.1" xref="A1.SS2.p4.1.m1.1.1.1.1.cmml"><mi id="A1.SS2.p4.1.m1.1.1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.1.1.3.cmml">γ</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p4.1.m1.1.1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.1.1.2.cmml">​</mo><mrow id="A1.SS2.p4.1.m1.1.1.1.1.1.1" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS2.p4.1.m1.1.1.1.1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.2.cmml">X</mi><mo id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.1" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msup id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.2" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.3" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msup></mrow><mo stretchy="false" id="A1.SS2.p4.1.m1.1.1.1.1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A1.SS2.p4.1.m1.1.1.1.2" xref="A1.SS2.p4.1.m1.1.1.1.2.cmml">+</mo><msup id="A1.SS2.p4.1.m1.1.1.1.3" xref="A1.SS2.p4.1.m1.1.1.1.3.cmml"><mi id="A1.SS2.p4.1.m1.1.1.1.3.2" xref="A1.SS2.p4.1.m1.1.1.1.3.2.cmml">G</mi><mi id="A1.SS2.p4.1.m1.1.1.1.3.3" xref="A1.SS2.p4.1.m1.1.1.1.3.3.cmml">t</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.1.m1.1b"><apply id="A1.SS2.p4.1.m1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1"><eq id="A1.SS2.p4.1.m1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.2"></eq><apply id="A1.SS2.p4.1.m1.1.1.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.1.3.1.cmml" xref="A1.SS2.p4.1.m1.1.1.3">subscript</csymbol><apply id="A1.SS2.p4.1.m1.1.1.3.2.cmml" xref="A1.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.1.3.2.1.cmml" xref="A1.SS2.p4.1.m1.1.1.3">superscript</csymbol><apply id="A1.SS2.p4.1.m1.1.1.3.2.2.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2.2"><ci id="A1.SS2.p4.1.m1.1.1.3.2.2.1.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2.2.1">~</ci><ci id="A1.SS2.p4.1.m1.1.1.3.2.2.2.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2.2.2">𝐿</ci></apply><apply id="A1.SS2.p4.1.m1.1.1.3.2.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2.3"><plus id="A1.SS2.p4.1.m1.1.1.3.2.3.1.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2.3.1"></plus><ci id="A1.SS2.p4.1.m1.1.1.3.2.3.2.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2.3.2">𝑡</ci><cn type="integer" id="A1.SS2.p4.1.m1.1.1.3.2.3.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3.2.3.3">1</cn></apply></apply><ci id="A1.SS2.p4.1.m1.1.1.3.3.cmml" xref="A1.SS2.p4.1.m1.1.1.3.3">𝑚</ci></apply><apply id="A1.SS2.p4.1.m1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1"><plus id="A1.SS2.p4.1.m1.1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.1.2"></plus><apply id="A1.SS2.p4.1.m1.1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1"><times id="A1.SS2.p4.1.m1.1.1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1.2"></times><ci id="A1.SS2.p4.1.m1.1.1.1.1.3.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1.3">𝛾</ci><apply id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1"><minus id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.1"></minus><ci id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.2">𝑋</ci><apply id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.2">𝐺</ci><ci id="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.SS2.p4.1.m1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="A1.SS2.p4.1.m1.1.1.1.3.cmml" xref="A1.SS2.p4.1.m1.1.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.1.m1.1.1.1.3.1.cmml" xref="A1.SS2.p4.1.m1.1.1.1.3">superscript</csymbol><ci id="A1.SS2.p4.1.m1.1.1.1.3.2.cmml" xref="A1.SS2.p4.1.m1.1.1.1.3.2">𝐺</ci><ci id="A1.SS2.p4.1.m1.1.1.1.3.3.cmml" xref="A1.SS2.p4.1.m1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.1.m1.1c">\tilde{L}^{t+1}_{m}=\gamma(X-G^{t})+G^{t}</annotation></semantics></math> will stand out. This approach
is not effective. <math id="A1.SS2.p4.2.m2.1" class="ltx_Math" alttext="\tilde{L}^{t+1}_{m}" display="inline"><semantics id="A1.SS2.p4.2.m2.1a"><msubsup id="A1.SS2.p4.2.m2.1.1" xref="A1.SS2.p4.2.m2.1.1.cmml"><mover accent="true" id="A1.SS2.p4.2.m2.1.1.2.2" xref="A1.SS2.p4.2.m2.1.1.2.2.cmml"><mi id="A1.SS2.p4.2.m2.1.1.2.2.2" xref="A1.SS2.p4.2.m2.1.1.2.2.2.cmml">L</mi><mo id="A1.SS2.p4.2.m2.1.1.2.2.1" xref="A1.SS2.p4.2.m2.1.1.2.2.1.cmml">~</mo></mover><mi id="A1.SS2.p4.2.m2.1.1.3" xref="A1.SS2.p4.2.m2.1.1.3.cmml">m</mi><mrow id="A1.SS2.p4.2.m2.1.1.2.3" xref="A1.SS2.p4.2.m2.1.1.2.3.cmml"><mi id="A1.SS2.p4.2.m2.1.1.2.3.2" xref="A1.SS2.p4.2.m2.1.1.2.3.2.cmml">t</mi><mo id="A1.SS2.p4.2.m2.1.1.2.3.1" xref="A1.SS2.p4.2.m2.1.1.2.3.1.cmml">+</mo><mn id="A1.SS2.p4.2.m2.1.1.2.3.3" xref="A1.SS2.p4.2.m2.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.2.m2.1b"><apply id="A1.SS2.p4.2.m2.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.2.m2.1.1.1.cmml" xref="A1.SS2.p4.2.m2.1.1">subscript</csymbol><apply id="A1.SS2.p4.2.m2.1.1.2.cmml" xref="A1.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p4.2.m2.1.1.2.1.cmml" xref="A1.SS2.p4.2.m2.1.1">superscript</csymbol><apply id="A1.SS2.p4.2.m2.1.1.2.2.cmml" xref="A1.SS2.p4.2.m2.1.1.2.2"><ci id="A1.SS2.p4.2.m2.1.1.2.2.1.cmml" xref="A1.SS2.p4.2.m2.1.1.2.2.1">~</ci><ci id="A1.SS2.p4.2.m2.1.1.2.2.2.cmml" xref="A1.SS2.p4.2.m2.1.1.2.2.2">𝐿</ci></apply><apply id="A1.SS2.p4.2.m2.1.1.2.3.cmml" xref="A1.SS2.p4.2.m2.1.1.2.3"><plus id="A1.SS2.p4.2.m2.1.1.2.3.1.cmml" xref="A1.SS2.p4.2.m2.1.1.2.3.1"></plus><ci id="A1.SS2.p4.2.m2.1.1.2.3.2.cmml" xref="A1.SS2.p4.2.m2.1.1.2.3.2">𝑡</ci><cn type="integer" id="A1.SS2.p4.2.m2.1.1.2.3.3.cmml" xref="A1.SS2.p4.2.m2.1.1.2.3.3">1</cn></apply></apply><ci id="A1.SS2.p4.2.m2.1.1.3.cmml" xref="A1.SS2.p4.2.m2.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.2.m2.1c">\tilde{L}^{t+1}_{m}</annotation></semantics></math>, albeit scaled, points in the
same direction as <math id="A1.SS2.p4.3.m3.1" class="ltx_Math" alttext="X-G^{t}" display="inline"><semantics id="A1.SS2.p4.3.m3.1a"><mrow id="A1.SS2.p4.3.m3.1.1" xref="A1.SS2.p4.3.m3.1.1.cmml"><mi id="A1.SS2.p4.3.m3.1.1.2" xref="A1.SS2.p4.3.m3.1.1.2.cmml">X</mi><mo id="A1.SS2.p4.3.m3.1.1.1" xref="A1.SS2.p4.3.m3.1.1.1.cmml">−</mo><msup id="A1.SS2.p4.3.m3.1.1.3" xref="A1.SS2.p4.3.m3.1.1.3.cmml"><mi id="A1.SS2.p4.3.m3.1.1.3.2" xref="A1.SS2.p4.3.m3.1.1.3.2.cmml">G</mi><mi id="A1.SS2.p4.3.m3.1.1.3.3" xref="A1.SS2.p4.3.m3.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.3.m3.1b"><apply id="A1.SS2.p4.3.m3.1.1.cmml" xref="A1.SS2.p4.3.m3.1.1"><minus id="A1.SS2.p4.3.m3.1.1.1.cmml" xref="A1.SS2.p4.3.m3.1.1.1"></minus><ci id="A1.SS2.p4.3.m3.1.1.2.cmml" xref="A1.SS2.p4.3.m3.1.1.2">𝑋</ci><apply id="A1.SS2.p4.3.m3.1.1.3.cmml" xref="A1.SS2.p4.3.m3.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.3.m3.1.1.3.1.cmml" xref="A1.SS2.p4.3.m3.1.1.3">superscript</csymbol><ci id="A1.SS2.p4.3.m3.1.1.3.2.cmml" xref="A1.SS2.p4.3.m3.1.1.3.2">𝐺</ci><ci id="A1.SS2.p4.3.m3.1.1.3.3.cmml" xref="A1.SS2.p4.3.m3.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.3.m3.1c">X-G^{t}</annotation></semantics></math>. Participants’ updates are almost orthogonal
to each other with very low variance <math id="A1.SS2.p4.4.m4.3" class="ltx_Math" alttext="3.6\text{\times}{10}^{-7}" display="inline"><semantics id="A1.SS2.p4.4.m4.3a"><mrow id="A1.SS2.p4.4.m4.3.3.3" xref="A1.SS2.p4.4.m4.3.3.3.cmml"><mn id="A1.SS2.p4.4.m4.1.1.1.1.1.1.1" xref="A1.SS2.p4.4.m4.3.3.3.cmml">3.6</mn><mtext id="A1.SS2.p4.4.m4.2.2.2.2.2.2.2" xref="A1.SS2.p4.4.m4.3.3.3.cmml">×</mtext><msup id="A1.SS2.p4.4.m4.3.3.3.3.3.3.3" xref="A1.SS2.p4.4.m4.3.3.3.cmml"><mn id="A1.SS2.p4.4.m4.3.3.3.3.3.3.3.2" xref="A1.SS2.p4.4.m4.3.3.3.cmml">10</mn><mrow id="A1.SS2.p4.4.m4.3.3.3.3.3.3.3.3.2" xref="A1.SS2.p4.4.m4.3.3.3.cmml"><mo id="A1.SS2.p4.4.m4.3.3.3.3.3.3.3.3.2a" xref="A1.SS2.p4.4.m4.3.3.3.cmml">−</mo><mn id="A1.SS2.p4.4.m4.3.3.3.3.3.3.3.3.2.2" xref="A1.SS2.p4.4.m4.3.3.3.cmml">7</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.4.m4.3b"><csymbol cd="latexml" id="A1.SS2.p4.4.m4.3.3.3.cmml" xref="A1.SS2.p4.4.m4.3.3.3">3.6E-7</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.4.m4.3c">3.6\text{\times}{10}^{-7}</annotation></semantics></math>, thus <math id="A1.SS2.p4.5.m5.1" class="ltx_Math" alttext="X-G^{t}" display="inline"><semantics id="A1.SS2.p4.5.m5.1a"><mrow id="A1.SS2.p4.5.m5.1.1" xref="A1.SS2.p4.5.m5.1.1.cmml"><mi id="A1.SS2.p4.5.m5.1.1.2" xref="A1.SS2.p4.5.m5.1.1.2.cmml">X</mi><mo id="A1.SS2.p4.5.m5.1.1.1" xref="A1.SS2.p4.5.m5.1.1.1.cmml">−</mo><msup id="A1.SS2.p4.5.m5.1.1.3" xref="A1.SS2.p4.5.m5.1.1.3.cmml"><mi id="A1.SS2.p4.5.m5.1.1.3.2" xref="A1.SS2.p4.5.m5.1.1.3.2.cmml">G</mi><mi id="A1.SS2.p4.5.m5.1.1.3.3" xref="A1.SS2.p4.5.m5.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p4.5.m5.1b"><apply id="A1.SS2.p4.5.m5.1.1.cmml" xref="A1.SS2.p4.5.m5.1.1"><minus id="A1.SS2.p4.5.m5.1.1.1.cmml" xref="A1.SS2.p4.5.m5.1.1.1"></minus><ci id="A1.SS2.p4.5.m5.1.1.2.cmml" xref="A1.SS2.p4.5.m5.1.1.2">𝑋</ci><apply id="A1.SS2.p4.5.m5.1.1.3.cmml" xref="A1.SS2.p4.5.m5.1.1.3"><csymbol cd="ambiguous" id="A1.SS2.p4.5.m5.1.1.3.1.cmml" xref="A1.SS2.p4.5.m5.1.1.3">superscript</csymbol><ci id="A1.SS2.p4.5.m5.1.1.3.2.cmml" xref="A1.SS2.p4.5.m5.1.1.3.2">𝐺</ci><ci id="A1.SS2.p4.5.m5.1.1.3.3.cmml" xref="A1.SS2.p4.5.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p4.5.m5.1c">X-G^{t}</annotation></semantics></math> does
not appear anomalous.</p>
</div>
<div id="A1.SS2.p5" class="ltx_para">
<p id="A1.SS2.p5.3" class="ltx_p">A more effective flavor of this technique is to compute the cosine
similarity between each update <math id="A1.SS2.p5.1.m1.1" class="ltx_Math" alttext="L^{t+1}_{i}" display="inline"><semantics id="A1.SS2.p5.1.m1.1a"><msubsup id="A1.SS2.p5.1.m1.1.1" xref="A1.SS2.p5.1.m1.1.1.cmml"><mi id="A1.SS2.p5.1.m1.1.1.2.2" xref="A1.SS2.p5.1.m1.1.1.2.2.cmml">L</mi><mi id="A1.SS2.p5.1.m1.1.1.3" xref="A1.SS2.p5.1.m1.1.1.3.cmml">i</mi><mrow id="A1.SS2.p5.1.m1.1.1.2.3" xref="A1.SS2.p5.1.m1.1.1.2.3.cmml"><mi id="A1.SS2.p5.1.m1.1.1.2.3.2" xref="A1.SS2.p5.1.m1.1.1.2.3.2.cmml">t</mi><mo id="A1.SS2.p5.1.m1.1.1.2.3.1" xref="A1.SS2.p5.1.m1.1.1.2.3.1.cmml">+</mo><mn id="A1.SS2.p5.1.m1.1.1.2.3.3" xref="A1.SS2.p5.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.1.m1.1b"><apply id="A1.SS2.p5.1.m1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.1.1.1.cmml" xref="A1.SS2.p5.1.m1.1.1">subscript</csymbol><apply id="A1.SS2.p5.1.m1.1.1.2.cmml" xref="A1.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.1.m1.1.1.2.1.cmml" xref="A1.SS2.p5.1.m1.1.1">superscript</csymbol><ci id="A1.SS2.p5.1.m1.1.1.2.2.cmml" xref="A1.SS2.p5.1.m1.1.1.2.2">𝐿</ci><apply id="A1.SS2.p5.1.m1.1.1.2.3.cmml" xref="A1.SS2.p5.1.m1.1.1.2.3"><plus id="A1.SS2.p5.1.m1.1.1.2.3.1.cmml" xref="A1.SS2.p5.1.m1.1.1.2.3.1"></plus><ci id="A1.SS2.p5.1.m1.1.1.2.3.2.cmml" xref="A1.SS2.p5.1.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="A1.SS2.p5.1.m1.1.1.2.3.3.cmml" xref="A1.SS2.p5.1.m1.1.1.2.3.3">1</cn></apply></apply><ci id="A1.SS2.p5.1.m1.1.1.3.cmml" xref="A1.SS2.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.1.m1.1c">L^{t+1}_{i}</annotation></semantics></math> and the previous global
model <math id="A1.SS2.p5.2.m2.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="A1.SS2.p5.2.m2.1a"><msup id="A1.SS2.p5.2.m2.1.1" xref="A1.SS2.p5.2.m2.1.1.cmml"><mi id="A1.SS2.p5.2.m2.1.1.2" xref="A1.SS2.p5.2.m2.1.1.2.cmml">G</mi><mi id="A1.SS2.p5.2.m2.1.1.3" xref="A1.SS2.p5.2.m2.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.2.m2.1b"><apply id="A1.SS2.p5.2.m2.1.1.cmml" xref="A1.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.2.m2.1.1.1.cmml" xref="A1.SS2.p5.2.m2.1.1">superscript</csymbol><ci id="A1.SS2.p5.2.m2.1.1.2.cmml" xref="A1.SS2.p5.2.m2.1.1.2">𝐺</ci><ci id="A1.SS2.p5.2.m2.1.1.3.cmml" xref="A1.SS2.p5.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.2.m2.1c">G^{t}</annotation></semantics></math>. Given that the updates are orthogonal, the attacker’s
scaling makes <math id="A1.SS2.p5.3.m3.2" class="ltx_Math" alttext="cos(\tilde{L}^{t+1}_{m},G^{t})" display="inline"><semantics id="A1.SS2.p5.3.m3.2a"><mrow id="A1.SS2.p5.3.m3.2.2" xref="A1.SS2.p5.3.m3.2.2.cmml"><mi id="A1.SS2.p5.3.m3.2.2.4" xref="A1.SS2.p5.3.m3.2.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.3.m3.2.2.3" xref="A1.SS2.p5.3.m3.2.2.3.cmml">​</mo><mi id="A1.SS2.p5.3.m3.2.2.5" xref="A1.SS2.p5.3.m3.2.2.5.cmml">o</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.3.m3.2.2.3a" xref="A1.SS2.p5.3.m3.2.2.3.cmml">​</mo><mi id="A1.SS2.p5.3.m3.2.2.6" xref="A1.SS2.p5.3.m3.2.2.6.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p5.3.m3.2.2.3b" xref="A1.SS2.p5.3.m3.2.2.3.cmml">​</mo><mrow id="A1.SS2.p5.3.m3.2.2.2.2" xref="A1.SS2.p5.3.m3.2.2.2.3.cmml"><mo stretchy="false" id="A1.SS2.p5.3.m3.2.2.2.2.3" xref="A1.SS2.p5.3.m3.2.2.2.3.cmml">(</mo><msubsup id="A1.SS2.p5.3.m3.1.1.1.1.1" xref="A1.SS2.p5.3.m3.1.1.1.1.1.cmml"><mover accent="true" id="A1.SS2.p5.3.m3.1.1.1.1.1.2.2" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.2.cmml"><mi id="A1.SS2.p5.3.m3.1.1.1.1.1.2.2.2" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.2.2.cmml">L</mi><mo id="A1.SS2.p5.3.m3.1.1.1.1.1.2.2.1" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.2.1.cmml">~</mo></mover><mi id="A1.SS2.p5.3.m3.1.1.1.1.1.3" xref="A1.SS2.p5.3.m3.1.1.1.1.1.3.cmml">m</mi><mrow id="A1.SS2.p5.3.m3.1.1.1.1.1.2.3" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.cmml"><mi id="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.2" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.2.cmml">t</mi><mo id="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.1" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.1.cmml">+</mo><mn id="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.3" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msubsup><mo id="A1.SS2.p5.3.m3.2.2.2.2.4" xref="A1.SS2.p5.3.m3.2.2.2.3.cmml">,</mo><msup id="A1.SS2.p5.3.m3.2.2.2.2.2" xref="A1.SS2.p5.3.m3.2.2.2.2.2.cmml"><mi id="A1.SS2.p5.3.m3.2.2.2.2.2.2" xref="A1.SS2.p5.3.m3.2.2.2.2.2.2.cmml">G</mi><mi id="A1.SS2.p5.3.m3.2.2.2.2.2.3" xref="A1.SS2.p5.3.m3.2.2.2.2.2.3.cmml">t</mi></msup><mo stretchy="false" id="A1.SS2.p5.3.m3.2.2.2.2.5" xref="A1.SS2.p5.3.m3.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p5.3.m3.2b"><apply id="A1.SS2.p5.3.m3.2.2.cmml" xref="A1.SS2.p5.3.m3.2.2"><times id="A1.SS2.p5.3.m3.2.2.3.cmml" xref="A1.SS2.p5.3.m3.2.2.3"></times><ci id="A1.SS2.p5.3.m3.2.2.4.cmml" xref="A1.SS2.p5.3.m3.2.2.4">𝑐</ci><ci id="A1.SS2.p5.3.m3.2.2.5.cmml" xref="A1.SS2.p5.3.m3.2.2.5">𝑜</ci><ci id="A1.SS2.p5.3.m3.2.2.6.cmml" xref="A1.SS2.p5.3.m3.2.2.6">𝑠</ci><interval closure="open" id="A1.SS2.p5.3.m3.2.2.2.3.cmml" xref="A1.SS2.p5.3.m3.2.2.2.2"><apply id="A1.SS2.p5.3.m3.1.1.1.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.3.m3.1.1.1.1.1.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1">subscript</csymbol><apply id="A1.SS2.p5.3.m3.1.1.1.1.1.2.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p5.3.m3.1.1.1.1.1.2.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1">superscript</csymbol><apply id="A1.SS2.p5.3.m3.1.1.1.1.1.2.2.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.2"><ci id="A1.SS2.p5.3.m3.1.1.1.1.1.2.2.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.2.1">~</ci><ci id="A1.SS2.p5.3.m3.1.1.1.1.1.2.2.2.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.2.2">𝐿</ci></apply><apply id="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.3"><plus id="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.1.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.1"></plus><ci id="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.2.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.2">𝑡</ci><cn type="integer" id="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.3.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="A1.SS2.p5.3.m3.1.1.1.1.1.3.cmml" xref="A1.SS2.p5.3.m3.1.1.1.1.1.3">𝑚</ci></apply><apply id="A1.SS2.p5.3.m3.2.2.2.2.2.cmml" xref="A1.SS2.p5.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="A1.SS2.p5.3.m3.2.2.2.2.2.1.cmml" xref="A1.SS2.p5.3.m3.2.2.2.2.2">superscript</csymbol><ci id="A1.SS2.p5.3.m3.2.2.2.2.2.2.cmml" xref="A1.SS2.p5.3.m3.2.2.2.2.2.2">𝐺</ci><ci id="A1.SS2.p5.3.m3.2.2.2.2.2.3.cmml" xref="A1.SS2.p5.3.m3.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p5.3.m3.2c">cos(\tilde{L}^{t+1}_{m},G^{t})</annotation></semantics></math> greater than the benign
participants’ updates, and this can be detected.</p>
</div>
<div id="A1.SS2.p6" class="ltx_para">
<p id="A1.SS2.p6.6" class="ltx_p">To bring his model closer to <math id="A1.SS2.p6.1.m1.1" class="ltx_Math" alttext="G^{t}" display="inline"><semantics id="A1.SS2.p6.1.m1.1a"><msup id="A1.SS2.p6.1.m1.1.1" xref="A1.SS2.p6.1.m1.1.1.cmml"><mi id="A1.SS2.p6.1.m1.1.1.2" xref="A1.SS2.p6.1.m1.1.1.2.cmml">G</mi><mi id="A1.SS2.p6.1.m1.1.1.3" xref="A1.SS2.p6.1.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.1.m1.1b"><apply id="A1.SS2.p6.1.m1.1.1.cmml" xref="A1.SS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.1.m1.1.1.1.cmml" xref="A1.SS2.p6.1.m1.1.1">superscript</csymbol><ci id="A1.SS2.p6.1.m1.1.1.2.cmml" xref="A1.SS2.p6.1.m1.1.1.2">𝐺</ci><ci id="A1.SS2.p6.1.m1.1.1.3.cmml" xref="A1.SS2.p6.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.1.m1.1c">G^{t}</annotation></semantics></math>, the attacker can use a low learning
rate and reduce the scaling factor <math id="A1.SS2.p6.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.SS2.p6.2.m2.1a"><mi id="A1.SS2.p6.2.m2.1.1" xref="A1.SS2.p6.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.2.m2.1b"><ci id="A1.SS2.p6.2.m2.1.1.cmml" xref="A1.SS2.p6.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.2.m2.1c">\gamma</annotation></semantics></math>, but the constrain-and-scale
method from Section <a href="#S4.SS3" title="4.3. Improving persistence and evading anomaly detection ‣ 4. Adversarial Model Replacement ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.3</span></a> works even better in this case.
As the anomaly-loss function, we use <math id="A1.SS2.p6.3.m3.2" class="ltx_Math" alttext="\mathcal{L}_{ano}=1-cos(L,G^{t})" display="inline"><semantics id="A1.SS2.p6.3.m3.2a"><mrow id="A1.SS2.p6.3.m3.2.2" xref="A1.SS2.p6.3.m3.2.2.cmml"><msub id="A1.SS2.p6.3.m3.2.2.3" xref="A1.SS2.p6.3.m3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS2.p6.3.m3.2.2.3.2" xref="A1.SS2.p6.3.m3.2.2.3.2.cmml">ℒ</mi><mrow id="A1.SS2.p6.3.m3.2.2.3.3" xref="A1.SS2.p6.3.m3.2.2.3.3.cmml"><mi id="A1.SS2.p6.3.m3.2.2.3.3.2" xref="A1.SS2.p6.3.m3.2.2.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.3.m3.2.2.3.3.1" xref="A1.SS2.p6.3.m3.2.2.3.3.1.cmml">​</mo><mi id="A1.SS2.p6.3.m3.2.2.3.3.3" xref="A1.SS2.p6.3.m3.2.2.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.3.m3.2.2.3.3.1a" xref="A1.SS2.p6.3.m3.2.2.3.3.1.cmml">​</mo><mi id="A1.SS2.p6.3.m3.2.2.3.3.4" xref="A1.SS2.p6.3.m3.2.2.3.3.4.cmml">o</mi></mrow></msub><mo id="A1.SS2.p6.3.m3.2.2.2" xref="A1.SS2.p6.3.m3.2.2.2.cmml">=</mo><mrow id="A1.SS2.p6.3.m3.2.2.1" xref="A1.SS2.p6.3.m3.2.2.1.cmml"><mn id="A1.SS2.p6.3.m3.2.2.1.3" xref="A1.SS2.p6.3.m3.2.2.1.3.cmml">1</mn><mo id="A1.SS2.p6.3.m3.2.2.1.2" xref="A1.SS2.p6.3.m3.2.2.1.2.cmml">−</mo><mrow id="A1.SS2.p6.3.m3.2.2.1.1" xref="A1.SS2.p6.3.m3.2.2.1.1.cmml"><mi id="A1.SS2.p6.3.m3.2.2.1.1.3" xref="A1.SS2.p6.3.m3.2.2.1.1.3.cmml">c</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.3.m3.2.2.1.1.2" xref="A1.SS2.p6.3.m3.2.2.1.1.2.cmml">​</mo><mi id="A1.SS2.p6.3.m3.2.2.1.1.4" xref="A1.SS2.p6.3.m3.2.2.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.3.m3.2.2.1.1.2a" xref="A1.SS2.p6.3.m3.2.2.1.1.2.cmml">​</mo><mi id="A1.SS2.p6.3.m3.2.2.1.1.5" xref="A1.SS2.p6.3.m3.2.2.1.1.5.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.SS2.p6.3.m3.2.2.1.1.2b" xref="A1.SS2.p6.3.m3.2.2.1.1.2.cmml">​</mo><mrow id="A1.SS2.p6.3.m3.2.2.1.1.1.1" xref="A1.SS2.p6.3.m3.2.2.1.1.1.2.cmml"><mo stretchy="false" id="A1.SS2.p6.3.m3.2.2.1.1.1.1.2" xref="A1.SS2.p6.3.m3.2.2.1.1.1.2.cmml">(</mo><mi id="A1.SS2.p6.3.m3.1.1" xref="A1.SS2.p6.3.m3.1.1.cmml">L</mi><mo id="A1.SS2.p6.3.m3.2.2.1.1.1.1.3" xref="A1.SS2.p6.3.m3.2.2.1.1.1.2.cmml">,</mo><msup id="A1.SS2.p6.3.m3.2.2.1.1.1.1.1" xref="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.cmml"><mi id="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.2" xref="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.2.cmml">G</mi><mi id="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.3" xref="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.3.cmml">t</mi></msup><mo stretchy="false" id="A1.SS2.p6.3.m3.2.2.1.1.1.1.4" xref="A1.SS2.p6.3.m3.2.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.3.m3.2b"><apply id="A1.SS2.p6.3.m3.2.2.cmml" xref="A1.SS2.p6.3.m3.2.2"><eq id="A1.SS2.p6.3.m3.2.2.2.cmml" xref="A1.SS2.p6.3.m3.2.2.2"></eq><apply id="A1.SS2.p6.3.m3.2.2.3.cmml" xref="A1.SS2.p6.3.m3.2.2.3"><csymbol cd="ambiguous" id="A1.SS2.p6.3.m3.2.2.3.1.cmml" xref="A1.SS2.p6.3.m3.2.2.3">subscript</csymbol><ci id="A1.SS2.p6.3.m3.2.2.3.2.cmml" xref="A1.SS2.p6.3.m3.2.2.3.2">ℒ</ci><apply id="A1.SS2.p6.3.m3.2.2.3.3.cmml" xref="A1.SS2.p6.3.m3.2.2.3.3"><times id="A1.SS2.p6.3.m3.2.2.3.3.1.cmml" xref="A1.SS2.p6.3.m3.2.2.3.3.1"></times><ci id="A1.SS2.p6.3.m3.2.2.3.3.2.cmml" xref="A1.SS2.p6.3.m3.2.2.3.3.2">𝑎</ci><ci id="A1.SS2.p6.3.m3.2.2.3.3.3.cmml" xref="A1.SS2.p6.3.m3.2.2.3.3.3">𝑛</ci><ci id="A1.SS2.p6.3.m3.2.2.3.3.4.cmml" xref="A1.SS2.p6.3.m3.2.2.3.3.4">𝑜</ci></apply></apply><apply id="A1.SS2.p6.3.m3.2.2.1.cmml" xref="A1.SS2.p6.3.m3.2.2.1"><minus id="A1.SS2.p6.3.m3.2.2.1.2.cmml" xref="A1.SS2.p6.3.m3.2.2.1.2"></minus><cn type="integer" id="A1.SS2.p6.3.m3.2.2.1.3.cmml" xref="A1.SS2.p6.3.m3.2.2.1.3">1</cn><apply id="A1.SS2.p6.3.m3.2.2.1.1.cmml" xref="A1.SS2.p6.3.m3.2.2.1.1"><times id="A1.SS2.p6.3.m3.2.2.1.1.2.cmml" xref="A1.SS2.p6.3.m3.2.2.1.1.2"></times><ci id="A1.SS2.p6.3.m3.2.2.1.1.3.cmml" xref="A1.SS2.p6.3.m3.2.2.1.1.3">𝑐</ci><ci id="A1.SS2.p6.3.m3.2.2.1.1.4.cmml" xref="A1.SS2.p6.3.m3.2.2.1.1.4">𝑜</ci><ci id="A1.SS2.p6.3.m3.2.2.1.1.5.cmml" xref="A1.SS2.p6.3.m3.2.2.1.1.5">𝑠</ci><interval closure="open" id="A1.SS2.p6.3.m3.2.2.1.1.1.2.cmml" xref="A1.SS2.p6.3.m3.2.2.1.1.1.1"><ci id="A1.SS2.p6.3.m3.1.1.cmml" xref="A1.SS2.p6.3.m3.1.1">𝐿</ci><apply id="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.cmml" xref="A1.SS2.p6.3.m3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.1.cmml" xref="A1.SS2.p6.3.m3.2.2.1.1.1.1.1">superscript</csymbol><ci id="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.2.cmml" xref="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.2">𝐺</ci><ci id="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.3.cmml" xref="A1.SS2.p6.3.m3.2.2.1.1.1.1.1.3">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.3.m3.2c">\mathcal{L}_{ano}=1-cos(L,G^{t})</annotation></semantics></math>.
Fig. <a href="#A1.F13" title="Figure 13 ‣ A.2. Cosine similarity ‣ Appendix A Undeployable Defenses ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a> shows the tradeoff between <math id="A1.SS2.p6.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A1.SS2.p6.4.m4.1a"><mi id="A1.SS2.p6.4.m4.1.1" xref="A1.SS2.p6.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.4.m4.1b"><ci id="A1.SS2.p6.4.m4.1.1.cmml" xref="A1.SS2.p6.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.4.m4.1c">\alpha</annotation></semantics></math>, <math id="A1.SS2.p6.5.m5.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.SS2.p6.5.m5.1a"><mi id="A1.SS2.p6.5.m5.1.1" xref="A1.SS2.p6.5.m5.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.5.m5.1b"><ci id="A1.SS2.p6.5.m5.1.1.cmml" xref="A1.SS2.p6.5.m5.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.5.m5.1c">\gamma</annotation></semantics></math>,
and backdoor accuracy for the <span id="A1.SS2.p6.6.1" class="ltx_text ltx_font_italic">pasta from Astoria is delicious</span>
backdoor. Constrain-and-scale achieves higher backdoor accuracy than
train-and-scale while maintaining high cosine similarity to the previous
global model. In general, incorporating anomaly loss into the training
allows the attacker to evade sophisticated anomaly detectors that cannot
be defeated simply by reducing the scaling factor <math id="A1.SS2.p6.6.m6.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.SS2.p6.6.m6.1a"><mi id="A1.SS2.p6.6.m6.1.1" xref="A1.SS2.p6.6.m6.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.SS2.p6.6.m6.1b"><ci id="A1.SS2.p6.6.m6.1.1.cmml" xref="A1.SS2.p6.6.m6.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS2.p6.6.m6.1c">\gamma</annotation></semantics></math>.</p>
</div>
<figure id="A1.F13" class="ltx_figure"><img src="/html/1807.00459/assets/x13.png" id="A1.F13.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="297" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13. </span> By incorporating the cosine-similarity defense into the
attacker’s loss function, constrain-and-scale achieves higher accuracy
on the backdoor task while keeping the model less anomalous than
train-and-scale.</figcaption>
</figure>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3. </span>Accuracy auditing</h3>

<div id="A1.SS3.p1" class="ltx_para">
<p id="A1.SS3.p1.2" class="ltx_p">Because the attacker’s model <math id="A1.SS3.p1.1.m1.1" class="ltx_Math" alttext="\widetilde{L}_{i}^{t+1}" display="inline"><semantics id="A1.SS3.p1.1.m1.1a"><msubsup id="A1.SS3.p1.1.m1.1.1" xref="A1.SS3.p1.1.m1.1.1.cmml"><mover accent="true" id="A1.SS3.p1.1.m1.1.1.2.2" xref="A1.SS3.p1.1.m1.1.1.2.2.cmml"><mi id="A1.SS3.p1.1.m1.1.1.2.2.2" xref="A1.SS3.p1.1.m1.1.1.2.2.2.cmml">L</mi><mo id="A1.SS3.p1.1.m1.1.1.2.2.1" xref="A1.SS3.p1.1.m1.1.1.2.2.1.cmml">~</mo></mover><mi id="A1.SS3.p1.1.m1.1.1.2.3" xref="A1.SS3.p1.1.m1.1.1.2.3.cmml">i</mi><mrow id="A1.SS3.p1.1.m1.1.1.3" xref="A1.SS3.p1.1.m1.1.1.3.cmml"><mi id="A1.SS3.p1.1.m1.1.1.3.2" xref="A1.SS3.p1.1.m1.1.1.3.2.cmml">t</mi><mo id="A1.SS3.p1.1.m1.1.1.3.1" xref="A1.SS3.p1.1.m1.1.1.3.1.cmml">+</mo><mn id="A1.SS3.p1.1.m1.1.1.3.3" xref="A1.SS3.p1.1.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.1.m1.1b"><apply id="A1.SS3.p1.1.m1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.1.m1.1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1">superscript</csymbol><apply id="A1.SS3.p1.1.m1.1.1.2.cmml" xref="A1.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.SS3.p1.1.m1.1.1.2.1.cmml" xref="A1.SS3.p1.1.m1.1.1">subscript</csymbol><apply id="A1.SS3.p1.1.m1.1.1.2.2.cmml" xref="A1.SS3.p1.1.m1.1.1.2.2"><ci id="A1.SS3.p1.1.m1.1.1.2.2.1.cmml" xref="A1.SS3.p1.1.m1.1.1.2.2.1">~</ci><ci id="A1.SS3.p1.1.m1.1.1.2.2.2.cmml" xref="A1.SS3.p1.1.m1.1.1.2.2.2">𝐿</ci></apply><ci id="A1.SS3.p1.1.m1.1.1.2.3.cmml" xref="A1.SS3.p1.1.m1.1.1.2.3">𝑖</ci></apply><apply id="A1.SS3.p1.1.m1.1.1.3.cmml" xref="A1.SS3.p1.1.m1.1.1.3"><plus id="A1.SS3.p1.1.m1.1.1.3.1.cmml" xref="A1.SS3.p1.1.m1.1.1.3.1"></plus><ci id="A1.SS3.p1.1.m1.1.1.3.2.cmml" xref="A1.SS3.p1.1.m1.1.1.3.2">𝑡</ci><cn type="integer" id="A1.SS3.p1.1.m1.1.1.3.3.cmml" xref="A1.SS3.p1.1.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.1.m1.1c">\widetilde{L}_{i}^{t+1}</annotation></semantics></math> is scaled by
<math id="A1.SS3.p1.2.m2.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="A1.SS3.p1.2.m2.1a"><mi id="A1.SS3.p1.2.m2.1.1" xref="A1.SS3.p1.2.m2.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.2.m2.1b"><ci id="A1.SS3.p1.2.m2.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.2.m2.1c">\gamma</annotation></semantics></math>, its accuracy on the main task might deteriorate. Therefore,
rejecting updates whose main-task accuracy is abnormally low is
a plausible anomaly detection technique <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>.
It cannot be deployed as part of federated learning, however, because
the aggregator does not have access to the updates and cannot measure
their accuracy.</p>
</div>
<div id="A1.SS3.p2" class="ltx_para">
<p id="A1.SS3.p2.1" class="ltx_p">Furthermore, this defense, too, can be evaded by splitting the update
across multiple participants and thus less scaling for each individual
update. Fig. <a href="#A0.F11" title="Figure 11 ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>(b) shows that when the attacker controls
5 participants in a round, he achieves high backdoor accuracy while also
maintaining normal accuracy on the main task.</p>
</div>
<div id="A1.SS3.p3" class="ltx_para">
<p id="A1.SS3.p3.1" class="ltx_p">Figs. <a href="#A0.F11" title="Figure 11 ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>(c) and <a href="#A0.F11" title="Figure 11 ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>(d) show the results for each
backdoor sentence. For some sentences, the backdoored model is almost
the same as global model. For others, the backdoored model cannot reach
100% accuracy while keeping the distance from the global model small
because averaging with the other models destroys the backdoor.</p>
</div>
<div id="A1.SS3.p4" class="ltx_para">
<p id="A1.SS3.p4.1" class="ltx_p">Accuracy auditing fails completely to detect attacks on
image-classification models. Even benign participants often submit
updates with extremely low accuracy due to the unbalanced distribution
of representative images from different classes across the participants
and high local learning rate.</p>
</div>
<div id="A1.SS3.p5" class="ltx_para">
<p id="A1.SS3.p5.5" class="ltx_p">To demonstrate this, we used the setup from Section <a href="#S5.SS3" title="5.3. Experimental setup ‣ 5. Experiments ‣ How To Backdoor Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.3</span></a>
to perform 100 rounds of training, beginning with round <math id="A1.SS3.p5.1.m1.2" class="ltx_Math" alttext="10,000" display="inline"><semantics id="A1.SS3.p5.1.m1.2a"><mrow id="A1.SS3.p5.1.m1.2.3.2" xref="A1.SS3.p5.1.m1.2.3.1.cmml"><mn id="A1.SS3.p5.1.m1.1.1" xref="A1.SS3.p5.1.m1.1.1.cmml">10</mn><mo id="A1.SS3.p5.1.m1.2.3.2.1" xref="A1.SS3.p5.1.m1.2.3.1.cmml">,</mo><mn id="A1.SS3.p5.1.m1.2.2" xref="A1.SS3.p5.1.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p5.1.m1.2b"><list id="A1.SS3.p5.1.m1.2.3.1.cmml" xref="A1.SS3.p5.1.m1.2.3.2"><cn type="integer" id="A1.SS3.p5.1.m1.1.1.cmml" xref="A1.SS3.p5.1.m1.1.1">10</cn><cn type="integer" id="A1.SS3.p5.1.m1.2.2.cmml" xref="A1.SS3.p5.1.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p5.1.m1.2c">10,000</annotation></semantics></math>
when the global model already has high accuracy (<math id="A1.SS3.p5.2.m2.1" class="ltx_Math" alttext="91\%" display="inline"><semantics id="A1.SS3.p5.2.m2.1a"><mrow id="A1.SS3.p5.2.m2.1.1" xref="A1.SS3.p5.2.m2.1.1.cmml"><mn id="A1.SS3.p5.2.m2.1.1.2" xref="A1.SS3.p5.2.m2.1.1.2.cmml">91</mn><mo id="A1.SS3.p5.2.m2.1.1.1" xref="A1.SS3.p5.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p5.2.m2.1b"><apply id="A1.SS3.p5.2.m2.1.1.cmml" xref="A1.SS3.p5.2.m2.1.1"><csymbol cd="latexml" id="A1.SS3.p5.2.m2.1.1.1.cmml" xref="A1.SS3.p5.2.m2.1.1.1">percent</csymbol><cn type="integer" id="A1.SS3.p5.2.m2.1.1.2.cmml" xref="A1.SS3.p5.2.m2.1.1.2">91</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p5.2.m2.1c">91\%</annotation></semantics></math>). This is
the most favorable scenario for accuracy auditing because, in general,
local models become similar to the global model as the latter converges.
Even so, <math id="A1.SS3.p5.3.m3.1" class="ltx_Math" alttext="28" display="inline"><semantics id="A1.SS3.p5.3.m3.1a"><mn id="A1.SS3.p5.3.m3.1.1" xref="A1.SS3.p5.3.m3.1.1.cmml">28</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.p5.3.m3.1b"><cn type="integer" id="A1.SS3.p5.3.m3.1.1.cmml" xref="A1.SS3.p5.3.m3.1.1">28</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p5.3.m3.1c">28</annotation></semantics></math> out of <math id="A1.SS3.p5.4.m4.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A1.SS3.p5.4.m4.1a"><mn id="A1.SS3.p5.4.m4.1.1" xref="A1.SS3.p5.4.m4.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A1.SS3.p5.4.m4.1b"><cn type="integer" id="A1.SS3.p5.4.m4.1.1.cmml" xref="A1.SS3.p5.4.m4.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p5.4.m4.1c">100</annotation></semantics></math> participants at least once, but never always,
submitted a model that had the lowest (<math id="A1.SS3.p5.5.m5.1" class="ltx_Math" alttext="10\%" display="inline"><semantics id="A1.SS3.p5.5.m5.1a"><mrow id="A1.SS3.p5.5.m5.1.1" xref="A1.SS3.p5.5.m5.1.1.cmml"><mn id="A1.SS3.p5.5.m5.1.1.2" xref="A1.SS3.p5.5.m5.1.1.2.cmml">10</mn><mo id="A1.SS3.p5.5.m5.1.1.1" xref="A1.SS3.p5.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p5.5.m5.1b"><apply id="A1.SS3.p5.5.m5.1.1.cmml" xref="A1.SS3.p5.5.m5.1.1"><csymbol cd="latexml" id="A1.SS3.p5.5.m5.1.1.1.cmml" xref="A1.SS3.p5.5.m5.1.1.1">percent</csymbol><cn type="integer" id="A1.SS3.p5.5.m5.1.1.2.cmml" xref="A1.SS3.p5.5.m5.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p5.5.m5.1c">10\%</annotation></semantics></math>) accuracy on the test set.
Increasing the imbalance between classes in participants’ local data to
make them non-i.i.d. increases the number of participants who submit
models with low accuracy. Excluding all such contributions would have
produced a global model with poor accuracy.</p>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1807.00458" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1807.00459" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1807.00459">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1807.00459" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1807.00460" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar 16 15:10:51 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
