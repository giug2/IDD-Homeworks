<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>PTQ4RIS: Post-Training Quantization for Referring Image Segmentation</title>
<!--Generated on Wed Sep 25 15:12:51 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2409.17020v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S1" title="In PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">INTRODUCTION</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S2" title="In PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">RELATED WORK</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S3" title="In PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">PRELIMINARY</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S3.SS1" title="In III PRELIMINARY ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">RIS Task Definition</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S3.SS2" title="In III PRELIMINARY ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Full-precision RIS Model</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S3.SS3" title="In III PRELIMINARY ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">Weight and Activation Quantization</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4" title="In PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">METHOD</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.SS1" title="In IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span> </span><span class="ltx_text ltx_font_italic">Quantization Ristriction of RIS Model</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.SS2" title="In IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span> </span><span class="ltx_text ltx_font_italic">Dual-Region Quantization</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.SS3" title="In IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span> </span><span class="ltx_text ltx_font_italic">Reorder-based Outlier-Retained Quantization</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.SS4" title="In IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span> </span><span class="ltx_text ltx_font_italic">PTQ4RIS Algorithm</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S5" title="In PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">EXPERIMENTS</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S5.SS1" title="In V EXPERIMENTS ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-A</span> </span><span class="ltx_text ltx_font_italic">Qualitative Results</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S5.SS2" title="In V EXPERIMENTS ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-B</span> </span><span class="ltx_text ltx_font_italic">Ablation Studies</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S6" title="In PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VI </span><span class="ltx_text ltx_font_smallcaps">CONCLUSION</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">PTQ4RIS: Post-Training Quantization for Referring Image Segmentation
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiaoyan Jiang<sup class="ltx_sup" id="id11.11.id1"><span class="ltx_text ltx_font_italic" id="id11.11.id1.1">1∗</span></sup>, Hang Yang<sup class="ltx_sup" id="id12.12.id2"><span class="ltx_text ltx_font_italic" id="id12.12.id2.1">1∗</span></sup>, Kaiying Zhu<sup class="ltx_sup" id="id13.13.id3"><span class="ltx_text ltx_font_italic" id="id13.13.id3.1">2</span></sup>, Xihe Qiu<sup class="ltx_sup" id="id14.14.id4"><span class="ltx_text ltx_font_italic" id="id14.14.id4.1">1†</span></sup>, Shibo Zhao<sup class="ltx_sup" id="id15.15.id5"><span class="ltx_text ltx_font_italic" id="id15.15.id5.1">3</span></sup>, Sifan Zhou<sup class="ltx_sup" id="id16.16.id6"><span class="ltx_text ltx_font_italic" id="id16.16.id6.1">3</span></sup>
</span><span class="ltx_author_notes">* Equal contribution.<math alttext="\dagger" class="ltx_Math" display="inline" id="id7.7.m1.1"><semantics id="id7.7.m1.1a"><mo id="id7.7.m1.1.1" xref="id7.7.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="id7.7.m1.1b"><ci id="id7.7.m1.1.1.cmml" xref="id7.7.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="id7.7.m1.1c">\dagger</annotation><annotation encoding="application/x-llamapun" id="id7.7.m1.1d">†</annotation></semantics></math> Corresponding author: <span class="ltx_text ltx_font_typewriter" id="id17.17.id1" style="font-size:90%;">qiuxihe1993@gmail.com</span>.<sup class="ltx_sup" id="id18.18.id1"><span class="ltx_text ltx_font_italic" id="id18.18.id1.1">1</span></sup> School of Electronic and Electrical Engineering, Shanghai University of Engineering Science. <sup class="ltx_sup" id="id19.19.id2"><span class="ltx_text ltx_font_italic" id="id19.19.id2.1">2</span></sup> SenseTime. <sup class="ltx_sup" id="id20.20.id3"><span class="ltx_text ltx_font_italic" id="id20.20.id3.1">3</span></sup> Carnegie Mellon University.</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id21.id1">Referring Image Segmentation (RIS), aims to segment the object referred by a given sentence in an image by understanding both visual and linguistic information. However, existing RIS methods tend to explore top-performance models, disregarding considerations for practical applications on resources-limited edge devices. This oversight poses a significant challenge for on-device RIS inference. To this end, we propose an effective and efficient post-training quantization framework termed PTQ4RIS.
Specifically, we first conduct an in-depth analysis of the root causes of performance degradation in RIS model quantization and propose dual-region quantization (DRQ) and reorder-based outlier-retained quantization (RORQ) to address the quantization difficulties in visual and text encoders. Extensive experiments on three benchmarks with different bits settings (from 8 to 4 bits) demonstrates its superior performance. Importantly, we are the first PTQ method specifically designed for the RIS task, highlighting the feasibility of PTQ in RIS applications. Code will be available at <a class="ltx_ref ltx_href" href="https://github.com/gugu511yy/PTQ4RIS" title="">https://github.com/gugu511yy/PTQ4RIS</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">INTRODUCTION</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Referring Image Segmentation (RIS) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib1" title="">1</a>]</cite> aims to predict a pixel-wise mask of the target object in an image guided by a corresponding text description, which has extensive applications in human-computer interaction via natural language <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib3" title="">3</a>]</cite> and advanced driving systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib5" title="">5</a>]</cite>. For example, in a domestic service robot, the integration of RIS capabilities allows the robot to swiftly and accurately segment objects based on verbal commands. This allows the robot to respond effectively to user inputs, such as identifying ”the red cup on the kitchen counter”. By enhancing the robot’s ability to jointly understand natural language and images, RIS plays a crucial role in the development of intelligent robotic systems.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S1.F1.sf1" title="In Figure 1 ‣ I INTRODUCTION ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">1a</span></a>, the existing RIS methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib8" title="">8</a>]</cite> require modality-independent feature extraction and cross-modal feature fusion, ultimately producing dense pixel-level segmentation masks. Consequently, unlike conventional semantic or instance segmentation that rely solely on image data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib10" title="">10</a>]</cite>, the incorporation of natural language in RIS brings additional challenges in understanding the diverse vocabularies and syntactic varieties inherent in text modality. Naturally, the complex architecture design of RIS models inherently requires substantial computational resources and high-performance GPUs, significantly hindering their deployment on edge devices. For instance, the VLT model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib11" title="">11</a>]</cite> has 452M params and achieves only 50 ms inference latency on top-tier NVIDIA A100 GPUs. In contrast, such resource-intensive models pose significant challenges for deployment on the limited hardware resources onboard robot platforms.</p>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="224" id="S1.F1.sf1.g1" src="extracted/5879436/picture/1-a.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf1.2.1.1" style="font-size:90%;">a</span> </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S1.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="348" id="S1.F1.sf2.g1" src="extracted/5879436/picture/1-b.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.sf2.2.1.1" style="font-size:90%;">b</span> </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.3.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.4.2" style="font-size:90%;">(a) The pipeline of RIS, (b) Comparison of OIoU with various quantization methods (RTN, PTQ4ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a>]</cite>, RepQ-ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a>]</cite>) and our <span class="ltx_text ltx_font_bold" id="S1.F1.4.2.1">PTQ4RIS</span> on the RefCOCO+ testB.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Quantization is an efficient model compression approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib14" title="">14</a>]</cite>, which converts weights and activation from 32-bit floating-point to 8-bit or lower integer fixed-point representation. This process significantly reduces model size and improves inference speed, thereby facilitating deployment on resource-constrained edge devices. In contrast to quantization-aware training (QAT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib16" title="">16</a>]</cite> methods that demand access to a complete set of labeled training data and significant computational resources, post-training quantization (PTQ) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib20" title="">20</a>]</cite> is more advantageous for rapid and efficient industrial applications. PTQ requires only a small calibration set of unlabeled samples, eliminating the need to retrain the network using all available labeled data. This leads to a more streamlined and simple quantization process. Although several advanced PTQ methods have been proposed for RGB-based segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib21" title="">21</a>]</cite> or language understanding tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib23" title="">23</a>]</cite>, applying it directly to RIS tasks inevitably leads to performance degradation due to the distribution difference between images and text.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">In this paper, we aim to provide an efficient quantization solution for RIS task. As the first study in this area, we analyze each module of the RIS model individually and identify that the visual encoder and text encoder are particularly sensitive to quantization. For the visual encoder, we observe that the activation distribution after the Softmax and GeLU functions significantly deviates from a Gaussian distribution, leading to substantial quantization error when using a single scale. Therefore, we adopt a dual-region quantization <span class="ltx_text ltx_font_bold" id="S1.p4.1.1">(DRQ)</span> method to quantize the activation in both ranges separately. For the text encoder, we find that the activation is significantly affected by numerous outliers, especially at lower bit widths. Thereby simply suppressing these outliers can result in a collapse of model performance. To this end, we propose a reorder-based outlier-retained quantization <span class="ltx_text ltx_font_bold" id="S1.p4.1.2">(RORQ)</span> method, which iteratively partitions the activation values into groups and dynamically quantizes each group using distinct scale factors. For the quantization-friendly feature fusion and decoder modules, we directly apply a simple uniform quantization approach.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">Based on above findings and designs, we construct our <span class="ltx_text ltx_font_bold" id="S1.p5.1.1">PTQ4RIS</span> framework, and evaluate it on three RIS benchmark datasets.
Extensive experiments validate the effectiveness of our PTQ4RIS, as Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S1.F1.sf2" title="In Figure 1 ‣ I INTRODUCTION ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">1b</span></a> shows, highlighting its potential for deploying RIS models on onboard robot platforms. Notably, on the RefCOCO+ testB dataset, our PTQ4RIS achieves performance on par with the floating-point (FP) model under the W8A8 setting. Even in the W6A6 and W4A8 settings, the performance degradation is merely 0.66 OIoU and 1.54 OIoU, respectively. To our knowledge, this marks the first achievement of such impressive PTQ performance on RIS models. Our main contributions are summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We unveil the root causes of performance collapse in the quantization of the RIS model, revealing that challenges primarily arise from the unique activation distributions of post-Softmax and post-GeLU in visual encoder, along with activation outliers in text encoder.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We propose dual-region quantization (DRQ) and reorder-based outlier-retained quantization (RORQ) methods to tackle these issues. Furthermore, we introduce the PTQ4RIS framework, the first PTQ approach specifically designed for the RIS task.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Extensive experiments across various bit-width settings demonstrate the effectiveness and superiority of our PTQ4RIS. Specifically, the PTQ INT8 model’s accuracy is almost the same as the FP32 model on partial datasets.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">RELATED WORK</span>
</h2>
<div class="ltx_para ltx_noindent" id="S2.p1">
<p class="ltx_p" id="S2.p1.1"><span class="ltx_text ltx_font_bold" id="S2.p1.1.1">Referring Image Segmentation.</span>
The RIS task is first introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib24" title="">24</a>]</cite>, using CNN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib25" title="">25</a>]</cite> and LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib26" title="">26</a>]</cite> to extract visual and linguistic features, which are then connected for the final segmentation. Subsequent works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib28" title="">28</a>]</cite> enhance segmentation quality through recursive refinement networks (RRN) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib29" title="">29</a>]</cite> or dynamic networks. Others studies design strategies such as uni-directional <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib30" title="">30</a>]</cite>, bi-directional fusion <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib31" title="">31</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib32" title="">32</a>]</cite>, and CGAN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib33" title="">33</a>]</cite> to capture mutual guidance between modalities. To address semantic complexity and ambiguity, some works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib36" title="">36</a>]</cite> integrate natural language processing knowledge to reason relationships between objects. With the success of Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib37" title="">37</a>]</cite> in natural language processing and computer vision, recent studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib38" title="">38</a>]</cite> employ encoder-decoder structures to enhance global contextual information. Some works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib40" title="">40</a>]</cite> align the visual and language features in the decoder after extracting them in the encoder. Notably, LAVT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib6" title="">6</a>]</cite> is a representative work that facilitates cross-modal interaction within the encoder, achieving impressive results. Additionally, some approaches <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib42" title="">42</a>]</cite> address RIS as auto-regressive generation of polygon vertex coordinates, tackling complex shapes and occlusions. Leveraging parameter-efficient tuning, ETRIS <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib43" title="">43</a>]</cite> introduces a cross-modal bridge through parameter-efficient fine-tuning, reducing backbone parameter while maintaining strong performance. Despite the advancement of RIS, their large parameters and computational burden still hinder effective deployment in robotic platforms.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p2">
<p class="ltx_p" id="S2.p2.1"><span class="ltx_text ltx_font_bold" id="S2.p2.1.1">Post-Training Quantization for CNN and Transformer.</span>
Early post-training quantization (PTQ) methods such as AdaRound <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib44" title="">44</a>]</cite>, BRECQ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib17" title="">17</a>]</cite>, QDrop <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib18" title="">18</a>]</cite>, and PD-Quant <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib45" title="">45</a>]</cite> are primarily developed for CNNs, employing techniques such as adaptive rounding, block-wise reconstruction, activation error correction, and distribution correction. However, these methods are not suitable for Transformers, prompting researchers to make significant efforts in developing effective quantization methods specifically for the transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib37" title="">37</a>]</cite> architecture. For Vision Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib46" title="">46</a>]</cite>, PTQ-ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib47" title="">47</a>]</cite> adjusts bit-width using the nuclear norm of attention maps, ensuring feature mapping similarity before and after quantization. Based on this, FQ-ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib19" title="">19</a>]</cite> introduces a power-of-two factor and Log-Int-Softmax to achieve more comprehensive quantization. PTQ4ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a>]</cite> addresses the abnormal distributions of softmax and GeLU activation, while RepQ-ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a>]</cite> decouples quantization from inference to streamline operations. Additionally, there are quantization methods specifically designed for text-only transformers. For instance, I-BERT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib48" title="">48</a>]</cite> employs pure integer algorithms to quantize the entire inference process, while BiBERT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib49" title="">49</a>]</cite> introduces a fully binarized BERT model utilizing 1-bit weight and activation, significantly reducing computational costs and memory usage.
Despite advancements in quantization methods for visual and textual modalities, the RIS task involves both images and text, rendering existing modality-specific quantization techniques inadequate. Furthermore, the cross-modal nature of RIS necessitates a tailored quantization approach to address the unique challenges of integrating visual and textual data within RIS models.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">PRELIMINARY</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.5.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.6.2">RIS Task Definition</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.3">The input of the RIS task is a pair of an image <math alttext="I\in\mathbb{R}^{H\times W\times 3}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">I</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.p1.1.m1.1.1.3.3.2.cmml">H</mi><mo id="S3.SS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.3.cmml">W</mi><mo id="S3.SS1.p1.1.m1.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS1.p1.1.m1.1.1.3.3.4" xref="S3.SS1.p1.1.m1.1.1.3.3.4.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐼</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3"><times id="S3.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.3">𝑊</ci><cn id="S3.SS1.p1.1.m1.1.1.3.3.4.cmml" type="integer" xref="S3.SS1.p1.1.m1.1.1.3.3.4">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">I\in\mathbb{R}^{H\times W\times 3}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_I ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W × 3 end_POSTSUPERSCRIPT</annotation></semantics></math> and a natural language expression <math alttext="E" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_E</annotation></semantics></math> that specifies an object in the image.
The model is ultimately tasked with generating a pixel-wise segmentation mask <math alttext="M\in\mathbb{R}^{H\times W}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">M</mi><mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.2" xref="S3.SS1.p1.3.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.3.m3.1.1.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.3.3.2" xref="S3.SS1.p1.3.m3.1.1.3.3.2.cmml">H</mi><mo id="S3.SS1.p1.3.m3.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.3.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.3.m3.1.1.3.3.3" xref="S3.SS1.p1.3.m3.1.1.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1"></in><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑀</ci><apply id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3"><times id="S3.SS1.p1.3.m3.1.1.3.3.1.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.1"></times><ci id="S3.SS1.p1.3.m3.1.1.3.3.2.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.2">𝐻</ci><ci id="S3.SS1.p1.3.m3.1.1.3.3.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">M\in\mathbb{R}^{H\times W}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_M ∈ blackboard_R start_POSTSUPERSCRIPT italic_H × italic_W end_POSTSUPERSCRIPT</annotation></semantics></math> that delineates the object, assigning a binary label to each pixel in the image. The core challenge of this task is to enable the model to effectively process information from multiple modalities while accurately aligning linguistic and visual content, ensuring precise target localization and segmentation.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.5.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.6.2">Full-precision RIS Model</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Due to the well-defined structure, compactness, and outstanding performance, the Language-Aware Visual Transformer (LAVT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib6" title="">6</a>]</cite> model has garnered significant attention in RIS task. Consequently, we select representative LAVT as the full-precision baseline model for our quantization efforts. As Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S1.F1.sf1" title="In Figure 1 ‣ I INTRODUCTION ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">1a</span></a> shows, this network consists of four main components:</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.10">(1) <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.10.1">Visual Encoder:</span> For the input image <math alttext="I" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">I</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_I</annotation></semantics></math>, Swin Transformer <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib50" title="">50</a>]</cite> is used to encode multi-scale visual feature maps <math alttext="V_{i}\in\mathbb{R}^{C_{i}\times H_{i}\times W_{i}},i\in\{1,2,3,4\}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.6"><semantics id="S3.SS2.p2.2.m2.6a"><mrow id="S3.SS2.p2.2.m2.6.6.2" xref="S3.SS2.p2.2.m2.6.6.3.cmml"><mrow id="S3.SS2.p2.2.m2.5.5.1.1" xref="S3.SS2.p2.2.m2.5.5.1.1.cmml"><msub id="S3.SS2.p2.2.m2.5.5.1.1.2" xref="S3.SS2.p2.2.m2.5.5.1.1.2.cmml"><mi id="S3.SS2.p2.2.m2.5.5.1.1.2.2" xref="S3.SS2.p2.2.m2.5.5.1.1.2.2.cmml">V</mi><mi id="S3.SS2.p2.2.m2.5.5.1.1.2.3" xref="S3.SS2.p2.2.m2.5.5.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.2.m2.5.5.1.1.1" xref="S3.SS2.p2.2.m2.5.5.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.2.m2.5.5.1.1.3" xref="S3.SS2.p2.2.m2.5.5.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.5.5.1.1.3.2" xref="S3.SS2.p2.2.m2.5.5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.2.m2.5.5.1.1.3.3" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.cmml"><msub id="S3.SS2.p2.2.m2.5.5.1.1.3.3.2" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.cmml"><mi id="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.2" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.2.cmml">C</mi><mi id="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.3" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.2.m2.5.5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p2.2.m2.5.5.1.1.3.3.3" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.cmml"><mi id="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.2" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.2.cmml">H</mi><mi id="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.3" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS2.p2.2.m2.5.5.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p2.2.m2.5.5.1.1.3.3.4" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.cmml"><mi id="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.2" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.2.cmml">W</mi><mi id="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.3" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.3.cmml">i</mi></msub></mrow></msup></mrow><mo id="S3.SS2.p2.2.m2.6.6.2.3" xref="S3.SS2.p2.2.m2.6.6.3a.cmml">,</mo><mrow id="S3.SS2.p2.2.m2.6.6.2.2" xref="S3.SS2.p2.2.m2.6.6.2.2.cmml"><mi id="S3.SS2.p2.2.m2.6.6.2.2.2" xref="S3.SS2.p2.2.m2.6.6.2.2.2.cmml">i</mi><mo id="S3.SS2.p2.2.m2.6.6.2.2.1" xref="S3.SS2.p2.2.m2.6.6.2.2.1.cmml">∈</mo><mrow id="S3.SS2.p2.2.m2.6.6.2.2.3.2" xref="S3.SS2.p2.2.m2.6.6.2.2.3.1.cmml"><mo id="S3.SS2.p2.2.m2.6.6.2.2.3.2.1" stretchy="false" xref="S3.SS2.p2.2.m2.6.6.2.2.3.1.cmml">{</mo><mn id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">1</mn><mo id="S3.SS2.p2.2.m2.6.6.2.2.3.2.2" xref="S3.SS2.p2.2.m2.6.6.2.2.3.1.cmml">,</mo><mn id="S3.SS2.p2.2.m2.2.2" xref="S3.SS2.p2.2.m2.2.2.cmml">2</mn><mo id="S3.SS2.p2.2.m2.6.6.2.2.3.2.3" xref="S3.SS2.p2.2.m2.6.6.2.2.3.1.cmml">,</mo><mn id="S3.SS2.p2.2.m2.3.3" xref="S3.SS2.p2.2.m2.3.3.cmml">3</mn><mo id="S3.SS2.p2.2.m2.6.6.2.2.3.2.4" xref="S3.SS2.p2.2.m2.6.6.2.2.3.1.cmml">,</mo><mn id="S3.SS2.p2.2.m2.4.4" xref="S3.SS2.p2.2.m2.4.4.cmml">4</mn><mo id="S3.SS2.p2.2.m2.6.6.2.2.3.2.5" stretchy="false" xref="S3.SS2.p2.2.m2.6.6.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.6b"><apply id="S3.SS2.p2.2.m2.6.6.3.cmml" xref="S3.SS2.p2.2.m2.6.6.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.6.6.3a.cmml" xref="S3.SS2.p2.2.m2.6.6.2.3">formulae-sequence</csymbol><apply id="S3.SS2.p2.2.m2.5.5.1.1.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1"><in id="S3.SS2.p2.2.m2.5.5.1.1.1.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.1"></in><apply id="S3.SS2.p2.2.m2.5.5.1.1.2.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.5.5.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.5.5.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.2.2">𝑉</ci><ci id="S3.SS2.p2.2.m2.5.5.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p2.2.m2.5.5.1.1.3.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.5.5.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.2.m2.5.5.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.2.m2.5.5.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3"><times id="S3.SS2.p2.2.m2.5.5.1.1.3.3.1.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.1"></times><apply id="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.1.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.2.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.2">𝐶</ci><ci id="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.3.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.2.3">𝑖</ci></apply><apply id="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.1.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.2.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.2">𝐻</ci><ci id="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.3.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.3.3">𝑖</ci></apply><apply id="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.1.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.4">subscript</csymbol><ci id="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.2.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.2">𝑊</ci><ci id="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.3.cmml" xref="S3.SS2.p2.2.m2.5.5.1.1.3.3.4.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.SS2.p2.2.m2.6.6.2.2.cmml" xref="S3.SS2.p2.2.m2.6.6.2.2"><in id="S3.SS2.p2.2.m2.6.6.2.2.1.cmml" xref="S3.SS2.p2.2.m2.6.6.2.2.1"></in><ci id="S3.SS2.p2.2.m2.6.6.2.2.2.cmml" xref="S3.SS2.p2.2.m2.6.6.2.2.2">𝑖</ci><set id="S3.SS2.p2.2.m2.6.6.2.2.3.1.cmml" xref="S3.SS2.p2.2.m2.6.6.2.2.3.2"><cn id="S3.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S3.SS2.p2.2.m2.1.1">1</cn><cn id="S3.SS2.p2.2.m2.2.2.cmml" type="integer" xref="S3.SS2.p2.2.m2.2.2">2</cn><cn id="S3.SS2.p2.2.m2.3.3.cmml" type="integer" xref="S3.SS2.p2.2.m2.3.3">3</cn><cn id="S3.SS2.p2.2.m2.4.4.cmml" type="integer" xref="S3.SS2.p2.2.m2.4.4">4</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.6c">V_{i}\in\mathbb{R}^{C_{i}\times H_{i}\times W_{i}},i\in\{1,2,3,4\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.6d">italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT , italic_i ∈ { 1 , 2 , 3 , 4 }</annotation></semantics></math> from the corresponding stage.
(2) <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.10.2">Text Encoder:</span> To extract linguistic features, a deep language expression model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib51" title="">51</a>]</cite> is employed to embed the input natural expression <math alttext="E" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">E</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_E</annotation></semantics></math> into a high-dimensional word vector <math alttext="L\in\mathbb{R}^{C_{t}\times T}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">L</mi><mo id="S3.SS2.p2.4.m4.1.1.1" xref="S3.SS2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.3.2" xref="S3.SS2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.4.m4.1.1.3.3" xref="S3.SS2.p2.4.m4.1.1.3.3.cmml"><msub id="S3.SS2.p2.4.m4.1.1.3.3.2" xref="S3.SS2.p2.4.m4.1.1.3.3.2.cmml"><mi id="S3.SS2.p2.4.m4.1.1.3.3.2.2" xref="S3.SS2.p2.4.m4.1.1.3.3.2.2.cmml">C</mi><mi id="S3.SS2.p2.4.m4.1.1.3.3.2.3" xref="S3.SS2.p2.4.m4.1.1.3.3.2.3.cmml">t</mi></msub><mo id="S3.SS2.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.4.m4.1.1.3.3.3" xref="S3.SS2.p2.4.m4.1.1.3.3.3.cmml">T</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><in id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1"></in><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝐿</ci><apply id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3"><times id="S3.SS2.p2.4.m4.1.1.3.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3.1"></times><apply id="S3.SS2.p2.4.m4.1.1.3.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.3.3.2.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.3.3.2.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3.2.2">𝐶</ci><ci id="S3.SS2.p2.4.m4.1.1.3.3.2.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3.2.3">𝑡</ci></apply><ci id="S3.SS2.p2.4.m4.1.1.3.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">L\in\mathbb{R}^{C_{t}\times T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_L ∈ blackboard_R start_POSTSUPERSCRIPT italic_C start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT × italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>.
(3) <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.10.3">Fusion:</span> This stage includes two parts: the Pixel-Level Attention Mechanism (PWAM) and the Gating Unit.
The <math alttext="V_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">V</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝑉</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">V_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mi id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">italic_L</annotation></semantics></math> pass through the PWAM module, where a cross-modal attention mechanism fuses them to generate the multi-modal feature <math alttext="F_{i}\in\mathbb{R}^{C_{i}\times H_{i}\times W_{i}}" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><mrow id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml"><msub id="S3.SS2.p2.7.m7.1.1.2" xref="S3.SS2.p2.7.m7.1.1.2.cmml"><mi id="S3.SS2.p2.7.m7.1.1.2.2" xref="S3.SS2.p2.7.m7.1.1.2.2.cmml">F</mi><mi id="S3.SS2.p2.7.m7.1.1.2.3" xref="S3.SS2.p2.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.7.m7.1.1.1" xref="S3.SS2.p2.7.m7.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.7.m7.1.1.3" xref="S3.SS2.p2.7.m7.1.1.3.cmml"><mi id="S3.SS2.p2.7.m7.1.1.3.2" xref="S3.SS2.p2.7.m7.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.7.m7.1.1.3.3" xref="S3.SS2.p2.7.m7.1.1.3.3.cmml"><msub id="S3.SS2.p2.7.m7.1.1.3.3.2" xref="S3.SS2.p2.7.m7.1.1.3.3.2.cmml"><mi id="S3.SS2.p2.7.m7.1.1.3.3.2.2" xref="S3.SS2.p2.7.m7.1.1.3.3.2.2.cmml">C</mi><mi id="S3.SS2.p2.7.m7.1.1.3.3.2.3" xref="S3.SS2.p2.7.m7.1.1.3.3.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.7.m7.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.7.m7.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p2.7.m7.1.1.3.3.3" xref="S3.SS2.p2.7.m7.1.1.3.3.3.cmml"><mi id="S3.SS2.p2.7.m7.1.1.3.3.3.2" xref="S3.SS2.p2.7.m7.1.1.3.3.3.2.cmml">H</mi><mi id="S3.SS2.p2.7.m7.1.1.3.3.3.3" xref="S3.SS2.p2.7.m7.1.1.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS2.p2.7.m7.1.1.3.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p2.7.m7.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.p2.7.m7.1.1.3.3.4" xref="S3.SS2.p2.7.m7.1.1.3.3.4.cmml"><mi id="S3.SS2.p2.7.m7.1.1.3.3.4.2" xref="S3.SS2.p2.7.m7.1.1.3.3.4.2.cmml">W</mi><mi id="S3.SS2.p2.7.m7.1.1.3.3.4.3" xref="S3.SS2.p2.7.m7.1.1.3.3.4.3.cmml">i</mi></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><apply id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1"><in id="S3.SS2.p2.7.m7.1.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1.1"></in><apply id="S3.SS2.p2.7.m7.1.1.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.2.1.cmml" xref="S3.SS2.p2.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.2.2.cmml" xref="S3.SS2.p2.7.m7.1.1.2.2">𝐹</ci><ci id="S3.SS2.p2.7.m7.1.1.2.3.cmml" xref="S3.SS2.p2.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p2.7.m7.1.1.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.3.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.3.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.7.m7.1.1.3.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3"><times id="S3.SS2.p2.7.m7.1.1.3.3.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.1"></times><apply id="S3.SS2.p2.7.m7.1.1.3.3.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.3.3.2.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.3.3.2.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.2.2">𝐶</ci><ci id="S3.SS2.p2.7.m7.1.1.3.3.2.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.2.3">𝑖</ci></apply><apply id="S3.SS2.p2.7.m7.1.1.3.3.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.3.3.3.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.3.3.3.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.3.2">𝐻</ci><ci id="S3.SS2.p2.7.m7.1.1.3.3.3.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.3.3">𝑖</ci></apply><apply id="S3.SS2.p2.7.m7.1.1.3.3.4.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.4"><csymbol cd="ambiguous" id="S3.SS2.p2.7.m7.1.1.3.3.4.1.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.4">subscript</csymbol><ci id="S3.SS2.p2.7.m7.1.1.3.3.4.2.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.4.2">𝑊</ci><ci id="S3.SS2.p2.7.m7.1.1.3.3.4.3.cmml" xref="S3.SS2.p2.7.m7.1.1.3.3.4.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">F_{i}\in\mathbb{R}^{C_{i}\times H_{i}\times W_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">italic_F start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_H start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT × italic_W start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>. The learnable gating unit then assigns weights to each element in <math alttext="F_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m8.1"><semantics id="S3.SS2.p2.8.m8.1a"><msub id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml"><mi id="S3.SS2.p2.8.m8.1.1.2" xref="S3.SS2.p2.8.m8.1.1.2.cmml">F</mi><mi id="S3.SS2.p2.8.m8.1.1.3" xref="S3.SS2.p2.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><apply id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m8.1.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p2.8.m8.1.1.2.cmml" xref="S3.SS2.p2.8.m8.1.1.2">𝐹</ci><ci id="S3.SS2.p2.8.m8.1.1.3.cmml" xref="S3.SS2.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">F_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m8.1d">italic_F start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.
(4) <span class="ltx_text ltx_font_bold" id="S3.SS2.p2.10.4">Decoder:</span> <math alttext="F_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.9.m9.1"><semantics id="S3.SS2.p2.9.m9.1a"><msub id="S3.SS2.p2.9.m9.1.1" xref="S3.SS2.p2.9.m9.1.1.cmml"><mi id="S3.SS2.p2.9.m9.1.1.2" xref="S3.SS2.p2.9.m9.1.1.2.cmml">F</mi><mi id="S3.SS2.p2.9.m9.1.1.3" xref="S3.SS2.p2.9.m9.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m9.1b"><apply id="S3.SS2.p2.9.m9.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m9.1.1.1.cmml" xref="S3.SS2.p2.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m9.1.1.2.cmml" xref="S3.SS2.p2.9.m9.1.1.2">𝐹</ci><ci id="S3.SS2.p2.9.m9.1.1.3.cmml" xref="S3.SS2.p2.9.m9.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m9.1c">F_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.9.m9.1d">italic_F start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are progressively fused using two sets of 3x3 convolutions with ReLU activation, connected by BN layers, ultimately producing the segmentation mask <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p2.10.m10.1"><semantics id="S3.SS2.p2.10.m10.1a"><mi id="S3.SS2.p2.10.m10.1.1" xref="S3.SS2.p2.10.m10.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m10.1b"><ci id="S3.SS2.p2.10.m10.1.1.cmml" xref="S3.SS2.p2.10.m10.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m10.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.10.m10.1d">italic_M</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.5.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.6.2">Weight and Activation Quantization</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.2">Model quantization is one of the key technique for neural network compression. Given a floating-point (FP) vector <math alttext="x" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_x</annotation></semantics></math> (weights or activations), it can be uniformly quantized to <math alttext="b" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_b</annotation></semantics></math>-bits as follows:</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx1">
<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\hat{\mathbf{x}}=\mathbf{Quant}_{b}(\mathbf{x},b)=(clamp(\lfloor%
\frac{\mathbf{x}}{s}\rceil+z,q_{min},q_{max})-z)\cdot s\vspace{-3mm}" class="ltx_math_unparsed" display="inline" id="S3.E1.m1.2"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2b"><mover accent="true" id="S3.E1.m1.2.3"><mi id="S3.E1.m1.2.3.2">𝐱</mi><mo id="S3.E1.m1.2.3.1">^</mo></mover><mo id="S3.E1.m1.2.4">=</mo><msub id="S3.E1.m1.2.5"><mi id="S3.E1.m1.2.5.2">𝐐𝐮𝐚𝐧𝐭</mi><mi id="S3.E1.m1.2.5.3">b</mi></msub><mrow id="S3.E1.m1.2.6"><mo id="S3.E1.m1.2.6.1" stretchy="false">(</mo><mi id="S3.E1.m1.1.1">𝐱</mi><mo id="S3.E1.m1.2.6.2">,</mo><mi id="S3.E1.m1.2.2">b</mi><mo id="S3.E1.m1.2.6.3" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.2.7">=</mo><mrow id="S3.E1.m1.2.8"><mo id="S3.E1.m1.2.8.1" stretchy="false">(</mo><mi id="S3.E1.m1.2.8.2">c</mi><mi id="S3.E1.m1.2.8.3">l</mi><mi id="S3.E1.m1.2.8.4">a</mi><mi id="S3.E1.m1.2.8.5">m</mi><mi id="S3.E1.m1.2.8.6">p</mi><mrow id="S3.E1.m1.2.8.7"><mo id="S3.E1.m1.2.8.7.1" stretchy="false">(</mo><mrow id="S3.E1.m1.2.8.7.2"><mo id="S3.E1.m1.2.8.7.2.1" stretchy="false">⌊</mo><mstyle displaystyle="true" id="S3.E1.m1.2.8.7.2.2"><mfrac id="S3.E1.m1.2.8.7.2.2a"><mi id="S3.E1.m1.2.8.7.2.2.2">𝐱</mi><mi id="S3.E1.m1.2.8.7.2.2.3">s</mi></mfrac></mstyle><mo id="S3.E1.m1.2.8.7.2.3" stretchy="false">⌉</mo></mrow><mo id="S3.E1.m1.2.8.7.3">+</mo><mi id="S3.E1.m1.2.8.7.4">z</mi><mo id="S3.E1.m1.2.8.7.5">,</mo><msub id="S3.E1.m1.2.8.7.6"><mi id="S3.E1.m1.2.8.7.6.2">q</mi><mrow id="S3.E1.m1.2.8.7.6.3"><mi id="S3.E1.m1.2.8.7.6.3.2">m</mi><mo id="S3.E1.m1.2.8.7.6.3.1">⁢</mo><mi id="S3.E1.m1.2.8.7.6.3.3">i</mi><mo id="S3.E1.m1.2.8.7.6.3.1a">⁢</mo><mi id="S3.E1.m1.2.8.7.6.3.4">n</mi></mrow></msub><mo id="S3.E1.m1.2.8.7.7">,</mo><msub id="S3.E1.m1.2.8.7.8"><mi id="S3.E1.m1.2.8.7.8.2">q</mi><mrow id="S3.E1.m1.2.8.7.8.3"><mi id="S3.E1.m1.2.8.7.8.3.2">m</mi><mo id="S3.E1.m1.2.8.7.8.3.1">⁢</mo><mi id="S3.E1.m1.2.8.7.8.3.3">a</mi><mo id="S3.E1.m1.2.8.7.8.3.1a">⁢</mo><mi id="S3.E1.m1.2.8.7.8.3.4">x</mi></mrow></msub><mo id="S3.E1.m1.2.8.7.9" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.2.8.8">−</mo><mi id="S3.E1.m1.2.8.9">z</mi><mo id="S3.E1.m1.2.8.10" rspace="0.055em" stretchy="false">)</mo></mrow><mo id="S3.E1.m1.2.9" rspace="0.222em">⋅</mo><mi id="S3.E1.m1.2.10">s</mi></mrow><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\displaystyle\hat{\mathbf{x}}=\mathbf{Quant}_{b}(\mathbf{x},b)=(clamp(\lfloor%
\frac{\mathbf{x}}{s}\rceil+z,q_{min},q_{max})-z)\cdot s\vspace{-3mm}</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.2d">over^ start_ARG bold_x end_ARG = bold_Quant start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( bold_x , italic_b ) = ( italic_c italic_l italic_a italic_m italic_p ( ⌊ divide start_ARG bold_x end_ARG start_ARG italic_s end_ARG ⌉ + italic_z , italic_q start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT italic_m italic_a italic_x end_POSTSUBSCRIPT ) - italic_z ) ⋅ italic_s</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.8">where scale factor <math alttext="s" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_s</annotation></semantics></math> is determined by the maximum and minimum values and the bit-width <math alttext="b" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">b</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">b</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">italic_b</annotation></semantics></math>, reflecting the proportional relationship between FP values and integers. And <math alttext="\text{clamp}()" class="ltx_Math" display="inline" id="S3.SS3.p2.3.m3.1"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mtext id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2a.cmml">clamp</mtext><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">⁢</mo><mrow id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.cmml"><mo id="S3.SS3.p2.3.m3.1.1.3.2.1" stretchy="false" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">(</mo><mo id="S3.SS3.p2.3.m3.1.1.3.2.2" stretchy="false" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><times id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></times><ci id="S3.SS3.p2.3.m3.1.1.2a.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><mtext id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">clamp</mtext></ci><list id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2.1"></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\text{clamp}()</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.3.m3.1d">clamp ( )</annotation></semantics></math> is used to clamp values in the range <math alttext="(q_{\text{min}},q_{\text{max}})" class="ltx_Math" display="inline" id="S3.SS3.p2.4.m4.2"><semantics id="S3.SS3.p2.4.m4.2a"><mrow id="S3.SS3.p2.4.m4.2.2.2" xref="S3.SS3.p2.4.m4.2.2.3.cmml"><mo id="S3.SS3.p2.4.m4.2.2.2.3" stretchy="false" xref="S3.SS3.p2.4.m4.2.2.3.cmml">(</mo><msub id="S3.SS3.p2.4.m4.1.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.1.1.2" xref="S3.SS3.p2.4.m4.1.1.1.1.2.cmml">q</mi><mtext id="S3.SS3.p2.4.m4.1.1.1.1.3" xref="S3.SS3.p2.4.m4.1.1.1.1.3a.cmml">min</mtext></msub><mo id="S3.SS3.p2.4.m4.2.2.2.4" xref="S3.SS3.p2.4.m4.2.2.3.cmml">,</mo><msub id="S3.SS3.p2.4.m4.2.2.2.2" xref="S3.SS3.p2.4.m4.2.2.2.2.cmml"><mi id="S3.SS3.p2.4.m4.2.2.2.2.2" xref="S3.SS3.p2.4.m4.2.2.2.2.2.cmml">q</mi><mtext id="S3.SS3.p2.4.m4.2.2.2.2.3" xref="S3.SS3.p2.4.m4.2.2.2.2.3a.cmml">max</mtext></msub><mo id="S3.SS3.p2.4.m4.2.2.2.5" stretchy="false" xref="S3.SS3.p2.4.m4.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.2b"><interval closure="open" id="S3.SS3.p2.4.m4.2.2.3.cmml" xref="S3.SS3.p2.4.m4.2.2.2"><apply id="S3.SS3.p2.4.m4.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.2">𝑞</ci><ci id="S3.SS3.p2.4.m4.1.1.1.1.3a.cmml" xref="S3.SS3.p2.4.m4.1.1.1.1.3"><mtext id="S3.SS3.p2.4.m4.1.1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.4.m4.1.1.1.1.3">min</mtext></ci></apply><apply id="S3.SS3.p2.4.m4.2.2.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.2.2.2.2.1.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2">subscript</csymbol><ci id="S3.SS3.p2.4.m4.2.2.2.2.2.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.2">𝑞</ci><ci id="S3.SS3.p2.4.m4.2.2.2.2.3a.cmml" xref="S3.SS3.p2.4.m4.2.2.2.2.3"><mtext id="S3.SS3.p2.4.m4.2.2.2.2.3.cmml" mathsize="70%" xref="S3.SS3.p2.4.m4.2.2.2.2.3">max</mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.2c">(q_{\text{min}},q_{\text{max}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.4.m4.2d">( italic_q start_POSTSUBSCRIPT min end_POSTSUBSCRIPT , italic_q start_POSTSUBSCRIPT max end_POSTSUBSCRIPT )</annotation></semantics></math> and potentially causing clipping errors. <math alttext="z" class="ltx_Math" display="inline" id="S3.SS3.p2.5.m5.1"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.5.m5.1d">italic_z</annotation></semantics></math> is the offset defined as the zero-point, in symmetric quantization, <math alttext="z" class="ltx_Math" display="inline" id="S3.SS3.p2.6.m6.1"><semantics id="S3.SS3.p2.6.m6.1a"><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.6.m6.1d">italic_z</annotation></semantics></math> is constrained to be 0. Here, wxcept visual encoder, we adopt uniform unsigned symmetric quantization, thereby <math alttext="q_{min}=0" class="ltx_Math" display="inline" id="S3.SS3.p2.7.m7.1"><semantics id="S3.SS3.p2.7.m7.1a"><mrow id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><msub id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2.2" xref="S3.SS3.p2.7.m7.1.1.2.2.cmml">q</mi><mrow id="S3.SS3.p2.7.m7.1.1.2.3" xref="S3.SS3.p2.7.m7.1.1.2.3.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2.3.2" xref="S3.SS3.p2.7.m7.1.1.2.3.2.cmml">m</mi><mo id="S3.SS3.p2.7.m7.1.1.2.3.1" xref="S3.SS3.p2.7.m7.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.7.m7.1.1.2.3.3" xref="S3.SS3.p2.7.m7.1.1.2.3.3.cmml">i</mi><mo id="S3.SS3.p2.7.m7.1.1.2.3.1a" xref="S3.SS3.p2.7.m7.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.7.m7.1.1.2.3.4" xref="S3.SS3.p2.7.m7.1.1.2.3.4.cmml">n</mi></mrow></msub><mo id="S3.SS3.p2.7.m7.1.1.1" xref="S3.SS3.p2.7.m7.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><eq id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1.1"></eq><apply id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.7.m7.1.1.2.1.cmml" xref="S3.SS3.p2.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.7.m7.1.1.2.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2.2">𝑞</ci><apply id="S3.SS3.p2.7.m7.1.1.2.3.cmml" xref="S3.SS3.p2.7.m7.1.1.2.3"><times id="S3.SS3.p2.7.m7.1.1.2.3.1.cmml" xref="S3.SS3.p2.7.m7.1.1.2.3.1"></times><ci id="S3.SS3.p2.7.m7.1.1.2.3.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2.3.2">𝑚</ci><ci id="S3.SS3.p2.7.m7.1.1.2.3.3.cmml" xref="S3.SS3.p2.7.m7.1.1.2.3.3">𝑖</ci><ci id="S3.SS3.p2.7.m7.1.1.2.3.4.cmml" xref="S3.SS3.p2.7.m7.1.1.2.3.4">𝑛</ci></apply></apply><cn id="S3.SS3.p2.7.m7.1.1.3.cmml" type="integer" xref="S3.SS3.p2.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">q_{min}=0</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.7.m7.1d">italic_q start_POSTSUBSCRIPT italic_m italic_i italic_n end_POSTSUBSCRIPT = 0</annotation></semantics></math> and <math alttext="q_{max}=2^{b}-1" class="ltx_Math" display="inline" id="S3.SS3.p2.8.m8.1"><semantics id="S3.SS3.p2.8.m8.1a"><mrow id="S3.SS3.p2.8.m8.1.1" xref="S3.SS3.p2.8.m8.1.1.cmml"><msub id="S3.SS3.p2.8.m8.1.1.2" xref="S3.SS3.p2.8.m8.1.1.2.cmml"><mi id="S3.SS3.p2.8.m8.1.1.2.2" xref="S3.SS3.p2.8.m8.1.1.2.2.cmml">q</mi><mrow id="S3.SS3.p2.8.m8.1.1.2.3" xref="S3.SS3.p2.8.m8.1.1.2.3.cmml"><mi id="S3.SS3.p2.8.m8.1.1.2.3.2" xref="S3.SS3.p2.8.m8.1.1.2.3.2.cmml">m</mi><mo id="S3.SS3.p2.8.m8.1.1.2.3.1" xref="S3.SS3.p2.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.8.m8.1.1.2.3.3" xref="S3.SS3.p2.8.m8.1.1.2.3.3.cmml">a</mi><mo id="S3.SS3.p2.8.m8.1.1.2.3.1a" xref="S3.SS3.p2.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.8.m8.1.1.2.3.4" xref="S3.SS3.p2.8.m8.1.1.2.3.4.cmml">x</mi></mrow></msub><mo id="S3.SS3.p2.8.m8.1.1.1" xref="S3.SS3.p2.8.m8.1.1.1.cmml">=</mo><mrow id="S3.SS3.p2.8.m8.1.1.3" xref="S3.SS3.p2.8.m8.1.1.3.cmml"><msup id="S3.SS3.p2.8.m8.1.1.3.2" xref="S3.SS3.p2.8.m8.1.1.3.2.cmml"><mn id="S3.SS3.p2.8.m8.1.1.3.2.2" xref="S3.SS3.p2.8.m8.1.1.3.2.2.cmml">2</mn><mi id="S3.SS3.p2.8.m8.1.1.3.2.3" xref="S3.SS3.p2.8.m8.1.1.3.2.3.cmml">b</mi></msup><mo id="S3.SS3.p2.8.m8.1.1.3.1" xref="S3.SS3.p2.8.m8.1.1.3.1.cmml">−</mo><mn id="S3.SS3.p2.8.m8.1.1.3.3" xref="S3.SS3.p2.8.m8.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m8.1b"><apply id="S3.SS3.p2.8.m8.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1"><eq id="S3.SS3.p2.8.m8.1.1.1.cmml" xref="S3.SS3.p2.8.m8.1.1.1"></eq><apply id="S3.SS3.p2.8.m8.1.1.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.2.1.cmml" xref="S3.SS3.p2.8.m8.1.1.2">subscript</csymbol><ci id="S3.SS3.p2.8.m8.1.1.2.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2.2">𝑞</ci><apply id="S3.SS3.p2.8.m8.1.1.2.3.cmml" xref="S3.SS3.p2.8.m8.1.1.2.3"><times id="S3.SS3.p2.8.m8.1.1.2.3.1.cmml" xref="S3.SS3.p2.8.m8.1.1.2.3.1"></times><ci id="S3.SS3.p2.8.m8.1.1.2.3.2.cmml" xref="S3.SS3.p2.8.m8.1.1.2.3.2">𝑚</ci><ci id="S3.SS3.p2.8.m8.1.1.2.3.3.cmml" xref="S3.SS3.p2.8.m8.1.1.2.3.3">𝑎</ci><ci id="S3.SS3.p2.8.m8.1.1.2.3.4.cmml" xref="S3.SS3.p2.8.m8.1.1.2.3.4">𝑥</ci></apply></apply><apply id="S3.SS3.p2.8.m8.1.1.3.cmml" xref="S3.SS3.p2.8.m8.1.1.3"><minus id="S3.SS3.p2.8.m8.1.1.3.1.cmml" xref="S3.SS3.p2.8.m8.1.1.3.1"></minus><apply id="S3.SS3.p2.8.m8.1.1.3.2.cmml" xref="S3.SS3.p2.8.m8.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m8.1.1.3.2.1.cmml" xref="S3.SS3.p2.8.m8.1.1.3.2">superscript</csymbol><cn id="S3.SS3.p2.8.m8.1.1.3.2.2.cmml" type="integer" xref="S3.SS3.p2.8.m8.1.1.3.2.2">2</cn><ci id="S3.SS3.p2.8.m8.1.1.3.2.3.cmml" xref="S3.SS3.p2.8.m8.1.1.3.2.3">𝑏</ci></apply><cn id="S3.SS3.p2.8.m8.1.1.3.3.cmml" type="integer" xref="S3.SS3.p2.8.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m8.1c">q_{max}=2^{b}-1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.8.m8.1d">italic_q start_POSTSUBSCRIPT italic_m italic_a italic_x end_POSTSUBSCRIPT = 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - 1</annotation></semantics></math>. In PTQ, weight quantization uses pre-trained model weights directly, while activation quantization employs a small calibration dataset to gather activation statistics, optimizing the quantization scheme to balance clipping and rounding errors effectively.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">METHOD</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we summarize the quantization challenges faced by the RIS model in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.SS1" title="IV-A Quantization Ristriction of RIS Model ‣ IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-A</span></span></a>. The quantization method for the Visual Encoder is detailed in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.SS2" title="IV-B Dual-Region Quantization ‣ IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-B</span></span></a>, while the solution for activation outliers in the text encoder is presented in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.SS3" title="IV-C Reorder-based Outlier-Retained Quantization ‣ IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-C</span></span></a>. Finally, the overall algorithm of PTQ4RIS is described in Section <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.SS4" title="IV-D PTQ4RIS Algorithm ‣ IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-D</span></span></a>.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS1.5.1.1">IV-A</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS1.6.2">Quantization Ristriction of RIS Model</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Upon directly applying existing quantization methods to the FP RIS model, we observe a significant performance decline. Through in-depth analysis, we summarize the following limitations of RIS quantization:</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">(1) Multi-modal hybrid CNN-transformer architectures:</span>
Existing PTQ methods are developed for single-modal CNNs or transformers, which do not take into account the different parameter distributions inherent in hybrid architecture and cross-modal features. This mismatch leads to a substantial accuracy drop in RIS model.</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">(2) Non-normal distribution in post-Softmax and post-GeLU activations:</span> The performance degradation in the visual encoder is particularly pronounced, as the post-Softmax and post-GeLU activations exhibit distributions that are far from Gaussian. These values are crucial for guiding correlations between patches in the self-attention mechanism, making simple removal infeasible.</p>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">(3) Unignorable outliers in text encoder:</span>
Since the semantic features extracted by the text encoder are critical inputs, any quantization errors in that section can accumulate and significantly impact the overall performance. Notably, the activation outliers in text encoder are particularly sensitive to quantization. These outliers vary irregularly with the input data and contain important information, direct culling will affect the semantic expression significantly.</p>
</div>
<div class="ltx_para" id="S4.SS1.p5">
<p class="ltx_p" id="S4.SS1.p5.1">To solve these challenges, we propose PTQ4RIS including dual-region quantization for vision encoder and reorder-based outlier-retained quantization for text encoder.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS2.5.1.1">IV-B</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS2.6.2">Dual-Region Quantization</span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.2">Most PTQ quantization methods are based on Gaussian distributions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a>]</cite>. However, by visualizing the distributions of post-Softmax and post-GeLU activations, we find that the distributions are very special and cannot be quantized by uniform quantization methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib52" title="">52</a>]</cite>. Firstly, the post-Softmax activations are between (0,1), most of the values are clustered near 0, and only a few large values approaching 1. In the self-attention, these values are mainly used for weighting patches.
The larger value means indicate a higher correlation between different patches, thus exerting a greater influence on the results.
Using a large scale factor <math alttext="s" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">italic_s</annotation></semantics></math> would reduce the quantization error of large values, whereas it would quantize a large portion of small values directly to 0. However, using a small scale factor <math alttext="s" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><ci id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">italic_s</annotation></semantics></math> would significantly diminishes the correlation between patches.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="333" id="S4.F2.g1" src="extracted/5879436/picture/Visual-DRO.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S4.F2.3.2" style="font-size:90%;">Dual-region quantization under 8-bit.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Moreover, the distribution of positive and negative intervals of activation values through the GELU function is highly asymmetric.
The positive distribution values are very large, but the negative values are highly close to 0.
It is difficult to fit this distribution using symmetric quantization.
Although non-uniform quantization can solve this problem, it is not applicable due to hardware <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib53" title="">53</a>]</cite>.
Therefore, we propose <span class="ltx_text ltx_font_bold" id="S4.SS2.p2.1.1">Dual-region Quantization</span> (DRQ) method, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.F2" title="Figure 2 ‣ IV-B Dual-Region Quantization ‣ IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">2</span></a>.
The function is described as follow:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{T}_{b}(x,S_{R_{1}},S_{R_{2}})=\begin{cases}\mathbf{Quant}_{b-1}(x,S_{R%
_{1}}),&amp;x\in R_{1}\\
\mathbf{Quant}_{b-1}(x,S_{R_{2}}),&amp;\text{otherwise}~{}.\end{cases}" class="ltx_Math" display="block" id="S4.E2.m1.7"><semantics id="S4.E2.m1.7a"><mrow id="S4.E2.m1.7.7" xref="S4.E2.m1.7.7.cmml"><mrow id="S4.E2.m1.7.7.2" xref="S4.E2.m1.7.7.2.cmml"><msub id="S4.E2.m1.7.7.2.4" xref="S4.E2.m1.7.7.2.4.cmml"><mi id="S4.E2.m1.7.7.2.4.2" xref="S4.E2.m1.7.7.2.4.2.cmml">𝐓</mi><mi id="S4.E2.m1.7.7.2.4.3" xref="S4.E2.m1.7.7.2.4.3.cmml">b</mi></msub><mo id="S4.E2.m1.7.7.2.3" xref="S4.E2.m1.7.7.2.3.cmml">⁢</mo><mrow id="S4.E2.m1.7.7.2.2.2" xref="S4.E2.m1.7.7.2.2.3.cmml"><mo id="S4.E2.m1.7.7.2.2.2.3" stretchy="false" xref="S4.E2.m1.7.7.2.2.3.cmml">(</mo><mi id="S4.E2.m1.5.5" xref="S4.E2.m1.5.5.cmml">x</mi><mo id="S4.E2.m1.7.7.2.2.2.4" xref="S4.E2.m1.7.7.2.2.3.cmml">,</mo><msub id="S4.E2.m1.6.6.1.1.1.1" xref="S4.E2.m1.6.6.1.1.1.1.cmml"><mi id="S4.E2.m1.6.6.1.1.1.1.2" xref="S4.E2.m1.6.6.1.1.1.1.2.cmml">S</mi><msub id="S4.E2.m1.6.6.1.1.1.1.3" xref="S4.E2.m1.6.6.1.1.1.1.3.cmml"><mi id="S4.E2.m1.6.6.1.1.1.1.3.2" xref="S4.E2.m1.6.6.1.1.1.1.3.2.cmml">R</mi><mn id="S4.E2.m1.6.6.1.1.1.1.3.3" xref="S4.E2.m1.6.6.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S4.E2.m1.7.7.2.2.2.5" xref="S4.E2.m1.7.7.2.2.3.cmml">,</mo><msub id="S4.E2.m1.7.7.2.2.2.2" xref="S4.E2.m1.7.7.2.2.2.2.cmml"><mi id="S4.E2.m1.7.7.2.2.2.2.2" xref="S4.E2.m1.7.7.2.2.2.2.2.cmml">S</mi><msub id="S4.E2.m1.7.7.2.2.2.2.3" xref="S4.E2.m1.7.7.2.2.2.2.3.cmml"><mi id="S4.E2.m1.7.7.2.2.2.2.3.2" xref="S4.E2.m1.7.7.2.2.2.2.3.2.cmml">R</mi><mn id="S4.E2.m1.7.7.2.2.2.2.3.3" xref="S4.E2.m1.7.7.2.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S4.E2.m1.7.7.2.2.2.6" stretchy="false" xref="S4.E2.m1.7.7.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.7.7.3" xref="S4.E2.m1.7.7.3.cmml">=</mo><mrow id="S4.E2.m1.4.4" xref="S4.E2.m1.7.7.4.1.cmml"><mo id="S4.E2.m1.4.4.5" xref="S4.E2.m1.7.7.4.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S4.E2.m1.4.4.4" rowspacing="0pt" xref="S4.E2.m1.7.7.4.1.cmml"><mtr id="S4.E2.m1.4.4.4a" xref="S4.E2.m1.7.7.4.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4b" xref="S4.E2.m1.7.7.4.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.2.1.cmml"><mrow id="S4.E2.m1.1.1.1.1.1.1.2.1" xref="S4.E2.m1.1.1.1.1.1.1.2.1.cmml"><msub id="S4.E2.m1.1.1.1.1.1.1.2.1.3" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.2.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.2.cmml">𝐐𝐮𝐚𝐧𝐭</mi><mrow id="S4.E2.m1.1.1.1.1.1.1.2.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.2" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.2.cmml">b</mi><mo id="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.1" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.1.cmml">−</mo><mn id="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.3" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.E2.m1.1.1.1.1.1.1.2.1.2" xref="S4.E2.m1.1.1.1.1.1.1.2.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.2.cmml"><mo id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.2" stretchy="false" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.2.cmml">(</mo><mi id="S4.E2.m1.1.1.1.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.1.cmml">x</mi><mo id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.2.cmml">,</mo><msub id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">S</mi><msub id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.2" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml">R</mi><mn id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.3" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.4" stretchy="false" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.1.1.1.1.1.1.2.2" xref="S4.E2.m1.1.1.1.1.1.1.2.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4c" xref="S4.E2.m1.7.7.4.1.cmml"><mrow id="S4.E2.m1.2.2.2.2.2.1" xref="S4.E2.m1.2.2.2.2.2.1.cmml"><mi id="S4.E2.m1.2.2.2.2.2.1.2" xref="S4.E2.m1.2.2.2.2.2.1.2.cmml">x</mi><mo id="S4.E2.m1.2.2.2.2.2.1.1" xref="S4.E2.m1.2.2.2.2.2.1.1.cmml">∈</mo><msub id="S4.E2.m1.2.2.2.2.2.1.3" xref="S4.E2.m1.2.2.2.2.2.1.3.cmml"><mi id="S4.E2.m1.2.2.2.2.2.1.3.2" xref="S4.E2.m1.2.2.2.2.2.1.3.2.cmml">R</mi><mn id="S4.E2.m1.2.2.2.2.2.1.3.3" xref="S4.E2.m1.2.2.2.2.2.1.3.3.cmml">1</mn></msub></mrow></mtd></mtr><mtr id="S4.E2.m1.4.4.4d" xref="S4.E2.m1.7.7.4.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4e" xref="S4.E2.m1.7.7.4.1.cmml"><mrow id="S4.E2.m1.3.3.3.3.1.1.2" xref="S4.E2.m1.3.3.3.3.1.1.2.1.cmml"><mrow id="S4.E2.m1.3.3.3.3.1.1.2.1" xref="S4.E2.m1.3.3.3.3.1.1.2.1.cmml"><msub id="S4.E2.m1.3.3.3.3.1.1.2.1.3" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.cmml"><mi id="S4.E2.m1.3.3.3.3.1.1.2.1.3.2" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.2.cmml">𝐐𝐮𝐚𝐧𝐭</mi><mrow id="S4.E2.m1.3.3.3.3.1.1.2.1.3.3" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.cmml"><mi id="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.2" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.2.cmml">b</mi><mo id="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.1" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.1.cmml">−</mo><mn id="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.3" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.E2.m1.3.3.3.3.1.1.2.1.2" xref="S4.E2.m1.3.3.3.3.1.1.2.1.2.cmml">⁢</mo><mrow id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.2.cmml"><mo id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.2" stretchy="false" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.2.cmml">(</mo><mi id="S4.E2.m1.3.3.3.3.1.1.1" xref="S4.E2.m1.3.3.3.3.1.1.1.cmml">x</mi><mo id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.3" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.2.cmml">,</mo><msub id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.cmml"><mi id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.2" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.2.cmml">S</mi><msub id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.cmml"><mi id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.2" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.2.cmml">R</mi><mn id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.3" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.3.cmml">2</mn></msub></msub><mo id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.4" stretchy="false" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.3.3.3.3.1.1.2.2" xref="S4.E2.m1.3.3.3.3.1.1.2.1.cmml">,</mo></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E2.m1.4.4.4f" xref="S4.E2.m1.7.7.4.1.cmml"><mrow id="S4.E2.m1.4.4.4.4.2.1.3" xref="S4.E2.m1.4.4.4.4.2.1.1a.cmml"><mtext id="S4.E2.m1.4.4.4.4.2.1.1" xref="S4.E2.m1.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo id="S4.E2.m1.4.4.4.4.2.1.3.1" lspace="0.330em" xref="S4.E2.m1.4.4.4.4.2.1.1a.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.7b"><apply id="S4.E2.m1.7.7.cmml" xref="S4.E2.m1.7.7"><eq id="S4.E2.m1.7.7.3.cmml" xref="S4.E2.m1.7.7.3"></eq><apply id="S4.E2.m1.7.7.2.cmml" xref="S4.E2.m1.7.7.2"><times id="S4.E2.m1.7.7.2.3.cmml" xref="S4.E2.m1.7.7.2.3"></times><apply id="S4.E2.m1.7.7.2.4.cmml" xref="S4.E2.m1.7.7.2.4"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.2.4.1.cmml" xref="S4.E2.m1.7.7.2.4">subscript</csymbol><ci id="S4.E2.m1.7.7.2.4.2.cmml" xref="S4.E2.m1.7.7.2.4.2">𝐓</ci><ci id="S4.E2.m1.7.7.2.4.3.cmml" xref="S4.E2.m1.7.7.2.4.3">𝑏</ci></apply><vector id="S4.E2.m1.7.7.2.2.3.cmml" xref="S4.E2.m1.7.7.2.2.2"><ci id="S4.E2.m1.5.5.cmml" xref="S4.E2.m1.5.5">𝑥</ci><apply id="S4.E2.m1.6.6.1.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.1.1.1.1.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.6.6.1.1.1.1.2.cmml" xref="S4.E2.m1.6.6.1.1.1.1.2">𝑆</ci><apply id="S4.E2.m1.6.6.1.1.1.1.3.cmml" xref="S4.E2.m1.6.6.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.1.1.1.1.3.1.cmml" xref="S4.E2.m1.6.6.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.6.6.1.1.1.1.3.2.cmml" xref="S4.E2.m1.6.6.1.1.1.1.3.2">𝑅</ci><cn id="S4.E2.m1.6.6.1.1.1.1.3.3.cmml" type="integer" xref="S4.E2.m1.6.6.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E2.m1.7.7.2.2.2.2.cmml" xref="S4.E2.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.2.2.2.2.1.cmml" xref="S4.E2.m1.7.7.2.2.2.2">subscript</csymbol><ci id="S4.E2.m1.7.7.2.2.2.2.2.cmml" xref="S4.E2.m1.7.7.2.2.2.2.2">𝑆</ci><apply id="S4.E2.m1.7.7.2.2.2.2.3.cmml" xref="S4.E2.m1.7.7.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.7.7.2.2.2.2.3.1.cmml" xref="S4.E2.m1.7.7.2.2.2.2.3">subscript</csymbol><ci id="S4.E2.m1.7.7.2.2.2.2.3.2.cmml" xref="S4.E2.m1.7.7.2.2.2.2.3.2">𝑅</ci><cn id="S4.E2.m1.7.7.2.2.2.2.3.3.cmml" type="integer" xref="S4.E2.m1.7.7.2.2.2.2.3.3">2</cn></apply></apply></vector></apply><apply id="S4.E2.m1.7.7.4.1.cmml" xref="S4.E2.m1.4.4"><csymbol cd="latexml" id="S4.E2.m1.7.7.4.1.1.cmml" xref="S4.E2.m1.4.4.5">cases</csymbol><apply id="S4.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2"><times id="S4.E2.m1.1.1.1.1.1.1.2.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.2"></times><apply id="S4.E2.m1.1.1.1.1.1.1.2.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.2.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.2.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.2">𝐐𝐮𝐚𝐧𝐭</ci><apply id="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.3"><minus id="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.1"></minus><ci id="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.2">𝑏</ci><cn id="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.3.cmml" type="integer" xref="S4.E2.m1.1.1.1.1.1.1.2.1.3.3.3">1</cn></apply></apply><interval closure="open" id="S4.E2.m1.1.1.1.1.1.1.2.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1"><ci id="S4.E2.m1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.1">𝑥</ci><apply id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.2">𝑆</ci><apply id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.2">𝑅</ci><cn id="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml" type="integer" xref="S4.E2.m1.1.1.1.1.1.1.2.1.1.1.1.3.3">1</cn></apply></apply></interval></apply><apply id="S4.E2.m1.2.2.2.2.2.1.cmml" xref="S4.E2.m1.2.2.2.2.2.1"><in id="S4.E2.m1.2.2.2.2.2.1.1.cmml" xref="S4.E2.m1.2.2.2.2.2.1.1"></in><ci id="S4.E2.m1.2.2.2.2.2.1.2.cmml" xref="S4.E2.m1.2.2.2.2.2.1.2">𝑥</ci><apply id="S4.E2.m1.2.2.2.2.2.1.3.cmml" xref="S4.E2.m1.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.2.2.2.2.2.1.3.1.cmml" xref="S4.E2.m1.2.2.2.2.2.1.3">subscript</csymbol><ci id="S4.E2.m1.2.2.2.2.2.1.3.2.cmml" xref="S4.E2.m1.2.2.2.2.2.1.3.2">𝑅</ci><cn id="S4.E2.m1.2.2.2.2.2.1.3.3.cmml" type="integer" xref="S4.E2.m1.2.2.2.2.2.1.3.3">1</cn></apply></apply><apply id="S4.E2.m1.3.3.3.3.1.1.2.1.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2"><times id="S4.E2.m1.3.3.3.3.1.1.2.1.2.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.2"></times><apply id="S4.E2.m1.3.3.3.3.1.1.2.1.3.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.3.3.1.1.2.1.3.1.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3">subscript</csymbol><ci id="S4.E2.m1.3.3.3.3.1.1.2.1.3.2.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.2">𝐐𝐮𝐚𝐧𝐭</ci><apply id="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.3"><minus id="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.1.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.1"></minus><ci id="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.2.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.2">𝑏</ci><cn id="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.3.cmml" type="integer" xref="S4.E2.m1.3.3.3.3.1.1.2.1.3.3.3">1</cn></apply></apply><interval closure="open" id="S4.E2.m1.3.3.3.3.1.1.2.1.1.2.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1"><ci id="S4.E2.m1.3.3.3.3.1.1.1.cmml" xref="S4.E2.m1.3.3.3.3.1.1.1">𝑥</ci><apply id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.1.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1">subscript</csymbol><ci id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.2.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.2">𝑆</ci><apply id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.1.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.2.cmml" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.2">𝑅</ci><cn id="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.3.cmml" type="integer" xref="S4.E2.m1.3.3.3.3.1.1.2.1.1.1.1.3.3">2</cn></apply></apply></interval></apply><ci id="S4.E2.m1.4.4.4.4.2.1.1a.cmml" xref="S4.E2.m1.4.4.4.4.2.1.3"><mtext id="S4.E2.m1.4.4.4.4.2.1.1.cmml" xref="S4.E2.m1.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.7c">\mathbf{T}_{b}(x,S_{R_{1}},S_{R_{2}})=\begin{cases}\mathbf{Quant}_{b-1}(x,S_{R%
_{1}}),&amp;x\in R_{1}\\
\mathbf{Quant}_{b-1}(x,S_{R_{2}}),&amp;\text{otherwise}~{}.\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S4.E2.m1.7d">bold_T start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ( italic_x , italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) = { start_ROW start_CELL bold_Quant start_POSTSUBSCRIPT italic_b - 1 end_POSTSUBSCRIPT ( italic_x , italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) , end_CELL start_CELL italic_x ∈ italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_CELL end_ROW start_ROW start_CELL bold_Quant start_POSTSUBSCRIPT italic_b - 1 end_POSTSUBSCRIPT ( italic_x , italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) , end_CELL start_CELL otherwise . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.14">For post-Softmax values, we define two regions: <math alttext="R_{1}^{s}=[0,2^{b-1}S_{R_{1}^{s}})" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.2"><semantics id="S4.SS2.p3.1.m1.2a"><mrow id="S4.SS2.p3.1.m1.2.2" xref="S4.SS2.p3.1.m1.2.2.cmml"><msubsup id="S4.SS2.p3.1.m1.2.2.3" xref="S4.SS2.p3.1.m1.2.2.3.cmml"><mi id="S4.SS2.p3.1.m1.2.2.3.2.2" xref="S4.SS2.p3.1.m1.2.2.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.1.m1.2.2.3.2.3" xref="S4.SS2.p3.1.m1.2.2.3.2.3.cmml">1</mn><mi id="S4.SS2.p3.1.m1.2.2.3.3" xref="S4.SS2.p3.1.m1.2.2.3.3.cmml">s</mi></msubsup><mo id="S4.SS2.p3.1.m1.2.2.2" xref="S4.SS2.p3.1.m1.2.2.2.cmml">=</mo><mrow id="S4.SS2.p3.1.m1.2.2.1.1" xref="S4.SS2.p3.1.m1.2.2.1.2.cmml"><mo id="S4.SS2.p3.1.m1.2.2.1.1.2" stretchy="false" xref="S4.SS2.p3.1.m1.2.2.1.2.cmml">[</mo><mn id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">0</mn><mo id="S4.SS2.p3.1.m1.2.2.1.1.3" xref="S4.SS2.p3.1.m1.2.2.1.2.cmml">,</mo><mrow id="S4.SS2.p3.1.m1.2.2.1.1.1" xref="S4.SS2.p3.1.m1.2.2.1.1.1.cmml"><msup id="S4.SS2.p3.1.m1.2.2.1.1.1.2" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.cmml"><mn id="S4.SS2.p3.1.m1.2.2.1.1.1.2.2" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.2.cmml">2</mn><mrow id="S4.SS2.p3.1.m1.2.2.1.1.1.2.3" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.cmml"><mi id="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.2" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.2.cmml">b</mi><mo id="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.1" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.3" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.SS2.p3.1.m1.2.2.1.1.1.1" xref="S4.SS2.p3.1.m1.2.2.1.1.1.1.cmml">⁢</mo><msub id="S4.SS2.p3.1.m1.2.2.1.1.1.3" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p3.1.m1.2.2.1.1.1.3.2" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.2.cmml">S</mi><msubsup id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.2.2" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.2.3" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.2.3.cmml">1</mn><mi id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.3" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.3.cmml">s</mi></msubsup></msub></mrow><mo id="S4.SS2.p3.1.m1.2.2.1.1.4" stretchy="false" xref="S4.SS2.p3.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.2b"><apply id="S4.SS2.p3.1.m1.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2"><eq id="S4.SS2.p3.1.m1.2.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2.2"></eq><apply id="S4.SS2.p3.1.m1.2.2.3.cmml" xref="S4.SS2.p3.1.m1.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.2.2.3.1.cmml" xref="S4.SS2.p3.1.m1.2.2.3">superscript</csymbol><apply id="S4.SS2.p3.1.m1.2.2.3.2.cmml" xref="S4.SS2.p3.1.m1.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.2.2.3.2.1.cmml" xref="S4.SS2.p3.1.m1.2.2.3">subscript</csymbol><ci id="S4.SS2.p3.1.m1.2.2.3.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2.3.2.2">𝑅</ci><cn id="S4.SS2.p3.1.m1.2.2.3.2.3.cmml" type="integer" xref="S4.SS2.p3.1.m1.2.2.3.2.3">1</cn></apply><ci id="S4.SS2.p3.1.m1.2.2.3.3.cmml" xref="S4.SS2.p3.1.m1.2.2.3.3">𝑠</ci></apply><interval closure="closed-open" id="S4.SS2.p3.1.m1.2.2.1.2.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1"><cn id="S4.SS2.p3.1.m1.1.1.cmml" type="integer" xref="S4.SS2.p3.1.m1.1.1">0</cn><apply id="S4.SS2.p3.1.m1.2.2.1.1.1.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1"><times id="S4.SS2.p3.1.m1.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.1"></times><apply id="S4.SS2.p3.1.m1.2.2.1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.2.2.1.1.1.2.1.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2">superscript</csymbol><cn id="S4.SS2.p3.1.m1.2.2.1.1.1.2.2.cmml" type="integer" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.2">2</cn><apply id="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.3"><minus id="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.1.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.1"></minus><ci id="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.2.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.2">𝑏</ci><cn id="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p3.1.m1.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p3.1.m1.2.2.1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.1.m1.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.2">𝑆</ci><apply id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3">superscript</csymbol><apply id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.2.1.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.2.2.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.2.2">𝑅</ci><cn id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.2.3.cmml" type="integer" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.2.3">1</cn></apply><ci id="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.SS2.p3.1.m1.2.2.1.1.1.3.3.3">𝑠</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.2c">R_{1}^{s}=[0,2^{b-1}S_{R_{1}^{s}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.2d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT = [ 0 , 2 start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="R_{2}^{s}=[0,2^{b-1}S_{R_{2}^{s}}]" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.2"><semantics id="S4.SS2.p3.2.m2.2a"><mrow id="S4.SS2.p3.2.m2.2.2" xref="S4.SS2.p3.2.m2.2.2.cmml"><msubsup id="S4.SS2.p3.2.m2.2.2.3" xref="S4.SS2.p3.2.m2.2.2.3.cmml"><mi id="S4.SS2.p3.2.m2.2.2.3.2.2" xref="S4.SS2.p3.2.m2.2.2.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.2.m2.2.2.3.2.3" xref="S4.SS2.p3.2.m2.2.2.3.2.3.cmml">2</mn><mi id="S4.SS2.p3.2.m2.2.2.3.3" xref="S4.SS2.p3.2.m2.2.2.3.3.cmml">s</mi></msubsup><mo id="S4.SS2.p3.2.m2.2.2.2" xref="S4.SS2.p3.2.m2.2.2.2.cmml">=</mo><mrow id="S4.SS2.p3.2.m2.2.2.1.1" xref="S4.SS2.p3.2.m2.2.2.1.2.cmml"><mo id="S4.SS2.p3.2.m2.2.2.1.1.2" stretchy="false" xref="S4.SS2.p3.2.m2.2.2.1.2.cmml">[</mo><mn id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">0</mn><mo id="S4.SS2.p3.2.m2.2.2.1.1.3" xref="S4.SS2.p3.2.m2.2.2.1.2.cmml">,</mo><mrow id="S4.SS2.p3.2.m2.2.2.1.1.1" xref="S4.SS2.p3.2.m2.2.2.1.1.1.cmml"><msup id="S4.SS2.p3.2.m2.2.2.1.1.1.2" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.cmml"><mn id="S4.SS2.p3.2.m2.2.2.1.1.1.2.2" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.2.cmml">2</mn><mrow id="S4.SS2.p3.2.m2.2.2.1.1.1.2.3" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.cmml"><mi id="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.2" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.2.cmml">b</mi><mo id="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.1" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.3" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.SS2.p3.2.m2.2.2.1.1.1.1" xref="S4.SS2.p3.2.m2.2.2.1.1.1.1.cmml">⁢</mo><msub id="S4.SS2.p3.2.m2.2.2.1.1.1.3" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p3.2.m2.2.2.1.1.1.3.2" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.2.cmml">S</mi><msubsup id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.cmml"><mi id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.2.2" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.2.3" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.2.3.cmml">2</mn><mi id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.3" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.3.cmml">s</mi></msubsup></msub></mrow><mo id="S4.SS2.p3.2.m2.2.2.1.1.4" stretchy="false" xref="S4.SS2.p3.2.m2.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.2b"><apply id="S4.SS2.p3.2.m2.2.2.cmml" xref="S4.SS2.p3.2.m2.2.2"><eq id="S4.SS2.p3.2.m2.2.2.2.cmml" xref="S4.SS2.p3.2.m2.2.2.2"></eq><apply id="S4.SS2.p3.2.m2.2.2.3.cmml" xref="S4.SS2.p3.2.m2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.2.2.3.1.cmml" xref="S4.SS2.p3.2.m2.2.2.3">superscript</csymbol><apply id="S4.SS2.p3.2.m2.2.2.3.2.cmml" xref="S4.SS2.p3.2.m2.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.2.2.3.2.1.cmml" xref="S4.SS2.p3.2.m2.2.2.3">subscript</csymbol><ci id="S4.SS2.p3.2.m2.2.2.3.2.2.cmml" xref="S4.SS2.p3.2.m2.2.2.3.2.2">𝑅</ci><cn id="S4.SS2.p3.2.m2.2.2.3.2.3.cmml" type="integer" xref="S4.SS2.p3.2.m2.2.2.3.2.3">2</cn></apply><ci id="S4.SS2.p3.2.m2.2.2.3.3.cmml" xref="S4.SS2.p3.2.m2.2.2.3.3">𝑠</ci></apply><interval closure="closed" id="S4.SS2.p3.2.m2.2.2.1.2.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1"><cn id="S4.SS2.p3.2.m2.1.1.cmml" type="integer" xref="S4.SS2.p3.2.m2.1.1">0</cn><apply id="S4.SS2.p3.2.m2.2.2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1"><times id="S4.SS2.p3.2.m2.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.1"></times><apply id="S4.SS2.p3.2.m2.2.2.1.1.1.2.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.2.2.1.1.1.2.1.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2">superscript</csymbol><cn id="S4.SS2.p3.2.m2.2.2.1.1.1.2.2.cmml" type="integer" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.2">2</cn><apply id="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.3"><minus id="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.1.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.1"></minus><ci id="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.2.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.2">𝑏</ci><cn id="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p3.2.m2.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p3.2.m2.2.2.1.1.1.3.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.2.m2.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.2">𝑆</ci><apply id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.1.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3">superscript</csymbol><apply id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.2.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.2.1.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.2.2.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.2.2">𝑅</ci><cn id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.2.3.cmml" type="integer" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.2.3">2</cn></apply><ci id="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.3.cmml" xref="S4.SS2.p3.2.m2.2.2.1.1.1.3.3.3">𝑠</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.2c">R_{2}^{s}=[0,2^{b-1}S_{R_{2}^{s}}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.2d">italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT = [ 0 , 2 start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>. To cover the whole range, we keep <math alttext="S_{R_{2}^{s}}=\frac{1}{2^{b}-1}" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><msub id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2.2" xref="S4.SS2.p3.3.m3.1.1.2.2.cmml">S</mi><msubsup id="S4.SS2.p3.3.m3.1.1.2.3" xref="S4.SS2.p3.3.m3.1.1.2.3.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2.3.2.2" xref="S4.SS2.p3.3.m3.1.1.2.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.3.m3.1.1.2.3.2.3" xref="S4.SS2.p3.3.m3.1.1.2.3.2.3.cmml">2</mn><mi id="S4.SS2.p3.3.m3.1.1.2.3.3" xref="S4.SS2.p3.3.m3.1.1.2.3.3.cmml">s</mi></msubsup></msub><mo id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml">=</mo><mfrac id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml"><mn id="S4.SS2.p3.3.m3.1.1.3.2" xref="S4.SS2.p3.3.m3.1.1.3.2.cmml">1</mn><mrow id="S4.SS2.p3.3.m3.1.1.3.3" xref="S4.SS2.p3.3.m3.1.1.3.3.cmml"><msup id="S4.SS2.p3.3.m3.1.1.3.3.2" xref="S4.SS2.p3.3.m3.1.1.3.3.2.cmml"><mn id="S4.SS2.p3.3.m3.1.1.3.3.2.2" xref="S4.SS2.p3.3.m3.1.1.3.3.2.2.cmml">2</mn><mi id="S4.SS2.p3.3.m3.1.1.3.3.2.3" xref="S4.SS2.p3.3.m3.1.1.3.3.2.3.cmml">b</mi></msup><mo id="S4.SS2.p3.3.m3.1.1.3.3.1" xref="S4.SS2.p3.3.m3.1.1.3.3.1.cmml">−</mo><mn id="S4.SS2.p3.3.m3.1.1.3.3.3" xref="S4.SS2.p3.3.m3.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><eq id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1"></eq><apply id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.2.1.cmml" xref="S4.SS2.p3.3.m3.1.1.2">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2.2">𝑆</ci><apply id="S4.SS2.p3.3.m3.1.1.2.3.cmml" xref="S4.SS2.p3.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.2.3.1.cmml" xref="S4.SS2.p3.3.m3.1.1.2.3">superscript</csymbol><apply id="S4.SS2.p3.3.m3.1.1.2.3.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.2.3.2.1.cmml" xref="S4.SS2.p3.3.m3.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p3.3.m3.1.1.2.3.2.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2.3.2.2">𝑅</ci><cn id="S4.SS2.p3.3.m3.1.1.2.3.2.3.cmml" type="integer" xref="S4.SS2.p3.3.m3.1.1.2.3.2.3">2</cn></apply><ci id="S4.SS2.p3.3.m3.1.1.2.3.3.cmml" xref="S4.SS2.p3.3.m3.1.1.2.3.3">𝑠</ci></apply></apply><apply id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3"><divide id="S4.SS2.p3.3.m3.1.1.3.1.cmml" xref="S4.SS2.p3.3.m3.1.1.3"></divide><cn id="S4.SS2.p3.3.m3.1.1.3.2.cmml" type="integer" xref="S4.SS2.p3.3.m3.1.1.3.2">1</cn><apply id="S4.SS2.p3.3.m3.1.1.3.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3.3"><minus id="S4.SS2.p3.3.m3.1.1.3.3.1.cmml" xref="S4.SS2.p3.3.m3.1.1.3.3.1"></minus><apply id="S4.SS2.p3.3.m3.1.1.3.3.2.cmml" xref="S4.SS2.p3.3.m3.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.3.m3.1.1.3.3.2.1.cmml" xref="S4.SS2.p3.3.m3.1.1.3.3.2">superscript</csymbol><cn id="S4.SS2.p3.3.m3.1.1.3.3.2.2.cmml" type="integer" xref="S4.SS2.p3.3.m3.1.1.3.3.2.2">2</cn><ci id="S4.SS2.p3.3.m3.1.1.3.3.2.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3.3.2.3">𝑏</ci></apply><cn id="S4.SS2.p3.3.m3.1.1.3.3.3.cmml" type="integer" xref="S4.SS2.p3.3.m3.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">S_{R_{2}^{s}}=\frac{1}{2^{b}-1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - 1 end_ARG</annotation></semantics></math> and large values can be well quantified in <math alttext="R_{2}^{s}" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1"><semantics id="S4.SS2.p3.4.m4.1a"><msubsup id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2.2" xref="S4.SS2.p3.4.m4.1.1.2.2.cmml">R</mi><mn id="S4.SS2.p3.4.m4.1.1.2.3" xref="S4.SS2.p3.4.m4.1.1.2.3.cmml">2</mn><mi id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml">s</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1">superscript</csymbol><apply id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.4.m4.1.1.2.1.cmml" xref="S4.SS2.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p3.4.m4.1.1.2.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2.2">𝑅</ci><cn id="S4.SS2.p3.4.m4.1.1.2.3.cmml" type="integer" xref="S4.SS2.p3.4.m4.1.1.2.3">2</cn></apply><ci id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">R_{2}^{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.1d">italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT</annotation></semantics></math>.
For post-GeLU values, negative values in <math alttext="R_{1}^{g}=[-2^{b-1}S_{R_{1}^{g}},0]" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.2"><semantics id="S4.SS2.p3.5.m5.2a"><mrow id="S4.SS2.p3.5.m5.2.2" xref="S4.SS2.p3.5.m5.2.2.cmml"><msubsup id="S4.SS2.p3.5.m5.2.2.3" xref="S4.SS2.p3.5.m5.2.2.3.cmml"><mi id="S4.SS2.p3.5.m5.2.2.3.2.2" xref="S4.SS2.p3.5.m5.2.2.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.5.m5.2.2.3.2.3" xref="S4.SS2.p3.5.m5.2.2.3.2.3.cmml">1</mn><mi id="S4.SS2.p3.5.m5.2.2.3.3" xref="S4.SS2.p3.5.m5.2.2.3.3.cmml">g</mi></msubsup><mo id="S4.SS2.p3.5.m5.2.2.2" xref="S4.SS2.p3.5.m5.2.2.2.cmml">=</mo><mrow id="S4.SS2.p3.5.m5.2.2.1.1" xref="S4.SS2.p3.5.m5.2.2.1.2.cmml"><mo id="S4.SS2.p3.5.m5.2.2.1.1.2" stretchy="false" xref="S4.SS2.p3.5.m5.2.2.1.2.cmml">[</mo><mrow id="S4.SS2.p3.5.m5.2.2.1.1.1" xref="S4.SS2.p3.5.m5.2.2.1.1.1.cmml"><mo id="S4.SS2.p3.5.m5.2.2.1.1.1a" xref="S4.SS2.p3.5.m5.2.2.1.1.1.cmml">−</mo><mrow id="S4.SS2.p3.5.m5.2.2.1.1.1.2" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.cmml"><msup id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.cmml"><mn id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.2" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.2.cmml">2</mn><mrow id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.cmml"><mi id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.2" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.2.cmml">b</mi><mo id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.1" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.1.cmml">−</mo><mn id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.3" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.SS2.p3.5.m5.2.2.1.1.1.2.1" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.1.cmml">⁢</mo><msub id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.cmml"><mi id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.2" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.2.cmml">S</mi><msubsup id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.cmml"><mi id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.2.2" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.2.3" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.2.3.cmml">1</mn><mi id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.3" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.3.cmml">g</mi></msubsup></msub></mrow></mrow><mo id="S4.SS2.p3.5.m5.2.2.1.1.3" xref="S4.SS2.p3.5.m5.2.2.1.2.cmml">,</mo><mn id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml">0</mn><mo id="S4.SS2.p3.5.m5.2.2.1.1.4" stretchy="false" xref="S4.SS2.p3.5.m5.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.2b"><apply id="S4.SS2.p3.5.m5.2.2.cmml" xref="S4.SS2.p3.5.m5.2.2"><eq id="S4.SS2.p3.5.m5.2.2.2.cmml" xref="S4.SS2.p3.5.m5.2.2.2"></eq><apply id="S4.SS2.p3.5.m5.2.2.3.cmml" xref="S4.SS2.p3.5.m5.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.2.2.3.1.cmml" xref="S4.SS2.p3.5.m5.2.2.3">superscript</csymbol><apply id="S4.SS2.p3.5.m5.2.2.3.2.cmml" xref="S4.SS2.p3.5.m5.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.2.2.3.2.1.cmml" xref="S4.SS2.p3.5.m5.2.2.3">subscript</csymbol><ci id="S4.SS2.p3.5.m5.2.2.3.2.2.cmml" xref="S4.SS2.p3.5.m5.2.2.3.2.2">𝑅</ci><cn id="S4.SS2.p3.5.m5.2.2.3.2.3.cmml" type="integer" xref="S4.SS2.p3.5.m5.2.2.3.2.3">1</cn></apply><ci id="S4.SS2.p3.5.m5.2.2.3.3.cmml" xref="S4.SS2.p3.5.m5.2.2.3.3">𝑔</ci></apply><interval closure="closed" id="S4.SS2.p3.5.m5.2.2.1.2.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1"><apply id="S4.SS2.p3.5.m5.2.2.1.1.1.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1"><minus id="S4.SS2.p3.5.m5.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1"></minus><apply id="S4.SS2.p3.5.m5.2.2.1.1.1.2.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2"><times id="S4.SS2.p3.5.m5.2.2.1.1.1.2.1.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.1"></times><apply id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.1.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2">superscript</csymbol><cn id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.2.cmml" type="integer" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.2">2</cn><apply id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3"><minus id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.1.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.1"></minus><ci id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.2.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.2">𝑏</ci><cn id="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.1.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.2.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.2">𝑆</ci><apply id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.1.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3">superscript</csymbol><apply id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.2.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.2.1.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3">subscript</csymbol><ci id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.2.2.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.2.2">𝑅</ci><cn id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.2.3.cmml" type="integer" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.2.3">1</cn></apply><ci id="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.3.cmml" xref="S4.SS2.p3.5.m5.2.2.1.1.1.2.3.3.3">𝑔</ci></apply></apply></apply></apply><cn id="S4.SS2.p3.5.m5.1.1.cmml" type="integer" xref="S4.SS2.p3.5.m5.1.1">0</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.2c">R_{1}^{g}=[-2^{b-1}S_{R_{1}^{g}},0]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m5.2d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT = [ - 2 start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , 0 ]</annotation></semantics></math> and positive values in <math alttext="R_{2}^{g}=[0,2^{b-1}S_{R_{2}^{g}}]" class="ltx_Math" display="inline" id="S4.SS2.p3.6.m6.2"><semantics id="S4.SS2.p3.6.m6.2a"><mrow id="S4.SS2.p3.6.m6.2.2" xref="S4.SS2.p3.6.m6.2.2.cmml"><msubsup id="S4.SS2.p3.6.m6.2.2.3" xref="S4.SS2.p3.6.m6.2.2.3.cmml"><mi id="S4.SS2.p3.6.m6.2.2.3.2.2" xref="S4.SS2.p3.6.m6.2.2.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.6.m6.2.2.3.2.3" xref="S4.SS2.p3.6.m6.2.2.3.2.3.cmml">2</mn><mi id="S4.SS2.p3.6.m6.2.2.3.3" xref="S4.SS2.p3.6.m6.2.2.3.3.cmml">g</mi></msubsup><mo id="S4.SS2.p3.6.m6.2.2.2" xref="S4.SS2.p3.6.m6.2.2.2.cmml">=</mo><mrow id="S4.SS2.p3.6.m6.2.2.1.1" xref="S4.SS2.p3.6.m6.2.2.1.2.cmml"><mo id="S4.SS2.p3.6.m6.2.2.1.1.2" stretchy="false" xref="S4.SS2.p3.6.m6.2.2.1.2.cmml">[</mo><mn id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml">0</mn><mo id="S4.SS2.p3.6.m6.2.2.1.1.3" xref="S4.SS2.p3.6.m6.2.2.1.2.cmml">,</mo><mrow id="S4.SS2.p3.6.m6.2.2.1.1.1" xref="S4.SS2.p3.6.m6.2.2.1.1.1.cmml"><msup id="S4.SS2.p3.6.m6.2.2.1.1.1.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.cmml"><mn id="S4.SS2.p3.6.m6.2.2.1.1.1.2.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.2.cmml">2</mn><mrow id="S4.SS2.p3.6.m6.2.2.1.1.1.2.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.cmml"><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.2.cmml">b</mi><mo id="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.1" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.1.cmml">−</mo><mn id="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.SS2.p3.6.m6.2.2.1.1.1.1" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1.cmml">⁢</mo><msub id="S4.SS2.p3.6.m6.2.2.1.1.1.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.cmml"><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.3.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.2.cmml">S</mi><msubsup id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.cmml"><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.2.2" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.2.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.2.3.cmml">2</mn><mi id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.3" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.3.cmml">g</mi></msubsup></msub></mrow><mo id="S4.SS2.p3.6.m6.2.2.1.1.4" stretchy="false" xref="S4.SS2.p3.6.m6.2.2.1.2.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.6.m6.2b"><apply id="S4.SS2.p3.6.m6.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2"><eq id="S4.SS2.p3.6.m6.2.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.2"></eq><apply id="S4.SS2.p3.6.m6.2.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.3.1.cmml" xref="S4.SS2.p3.6.m6.2.2.3">superscript</csymbol><apply id="S4.SS2.p3.6.m6.2.2.3.2.cmml" xref="S4.SS2.p3.6.m6.2.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.3.2.1.cmml" xref="S4.SS2.p3.6.m6.2.2.3">subscript</csymbol><ci id="S4.SS2.p3.6.m6.2.2.3.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.3.2.2">𝑅</ci><cn id="S4.SS2.p3.6.m6.2.2.3.2.3.cmml" type="integer" xref="S4.SS2.p3.6.m6.2.2.3.2.3">2</cn></apply><ci id="S4.SS2.p3.6.m6.2.2.3.3.cmml" xref="S4.SS2.p3.6.m6.2.2.3.3">𝑔</ci></apply><interval closure="closed" id="S4.SS2.p3.6.m6.2.2.1.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1"><cn id="S4.SS2.p3.6.m6.1.1.cmml" type="integer" xref="S4.SS2.p3.6.m6.1.1">0</cn><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1"><times id="S4.SS2.p3.6.m6.2.2.1.1.1.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.1"></times><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.1.1.1.2.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2">superscript</csymbol><cn id="S4.SS2.p3.6.m6.2.2.1.1.1.2.2.cmml" type="integer" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.2">2</cn><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.3"><minus id="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.1"></minus><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.2">𝑏</ci><cn id="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p3.6.m6.2.2.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.1.1.1.3.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.3.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.2">𝑆</ci><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3">superscript</csymbol><apply id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.2.1.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.2.2.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.2.2">𝑅</ci><cn id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.2.3.cmml" type="integer" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.2.3">2</cn></apply><ci id="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.3.cmml" xref="S4.SS2.p3.6.m6.2.2.1.1.1.3.3.3">𝑔</ci></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.6.m6.2c">R_{2}^{g}=[0,2^{b-1}S_{R_{2}^{g}}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.6.m6.2d">italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT = [ 0 , 2 start_POSTSUPERSCRIPT italic_b - 1 end_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>. We also keep <math alttext="S_{R_{1}^{g}}" class="ltx_Math" display="inline" id="S4.SS2.p3.7.m7.1"><semantics id="S4.SS2.p3.7.m7.1a"><msub id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml"><mi id="S4.SS2.p3.7.m7.1.1.2" xref="S4.SS2.p3.7.m7.1.1.2.cmml">S</mi><msubsup id="S4.SS2.p3.7.m7.1.1.3" xref="S4.SS2.p3.7.m7.1.1.3.cmml"><mi id="S4.SS2.p3.7.m7.1.1.3.2.2" xref="S4.SS2.p3.7.m7.1.1.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.7.m7.1.1.3.2.3" xref="S4.SS2.p3.7.m7.1.1.3.2.3.cmml">1</mn><mi id="S4.SS2.p3.7.m7.1.1.3.3" xref="S4.SS2.p3.7.m7.1.1.3.3.cmml">g</mi></msubsup></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.7.m7.1b"><apply id="S4.SS2.p3.7.m7.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.7.m7.1.1.1.cmml" xref="S4.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p3.7.m7.1.1.2.cmml" xref="S4.SS2.p3.7.m7.1.1.2">𝑆</ci><apply id="S4.SS2.p3.7.m7.1.1.3.cmml" xref="S4.SS2.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.7.m7.1.1.3.1.cmml" xref="S4.SS2.p3.7.m7.1.1.3">superscript</csymbol><apply id="S4.SS2.p3.7.m7.1.1.3.2.cmml" xref="S4.SS2.p3.7.m7.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.7.m7.1.1.3.2.1.cmml" xref="S4.SS2.p3.7.m7.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.7.m7.1.1.3.2.2.cmml" xref="S4.SS2.p3.7.m7.1.1.3.2.2">𝑅</ci><cn id="S4.SS2.p3.7.m7.1.1.3.2.3.cmml" type="integer" xref="S4.SS2.p3.7.m7.1.1.3.2.3">1</cn></apply><ci id="S4.SS2.p3.7.m7.1.1.3.3.cmml" xref="S4.SS2.p3.7.m7.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.7.m7.1c">S_{R_{1}^{g}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.7.m7.1d">italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> fixed to make <math alttext="R_{1}^{g}" class="ltx_Math" display="inline" id="S4.SS2.p3.8.m8.1"><semantics id="S4.SS2.p3.8.m8.1a"><msubsup id="S4.SS2.p3.8.m8.1.1" xref="S4.SS2.p3.8.m8.1.1.cmml"><mi id="S4.SS2.p3.8.m8.1.1.2.2" xref="S4.SS2.p3.8.m8.1.1.2.2.cmml">R</mi><mn id="S4.SS2.p3.8.m8.1.1.2.3" xref="S4.SS2.p3.8.m8.1.1.2.3.cmml">1</mn><mi id="S4.SS2.p3.8.m8.1.1.3" xref="S4.SS2.p3.8.m8.1.1.3.cmml">g</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.8.m8.1b"><apply id="S4.SS2.p3.8.m8.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.1.cmml" xref="S4.SS2.p3.8.m8.1.1">superscript</csymbol><apply id="S4.SS2.p3.8.m8.1.1.2.cmml" xref="S4.SS2.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.8.m8.1.1.2.1.cmml" xref="S4.SS2.p3.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p3.8.m8.1.1.2.2.cmml" xref="S4.SS2.p3.8.m8.1.1.2.2">𝑅</ci><cn id="S4.SS2.p3.8.m8.1.1.2.3.cmml" type="integer" xref="S4.SS2.p3.8.m8.1.1.2.3">1</cn></apply><ci id="S4.SS2.p3.8.m8.1.1.3.cmml" xref="S4.SS2.p3.8.m8.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.8.m8.1c">R_{1}^{g}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.8.m8.1d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT</annotation></semantics></math> just cover the entire range of negative numbers. When calibrating, we search for the best two scale factors, <math alttext="S_{R_{1}^{s}}" class="ltx_Math" display="inline" id="S4.SS2.p3.9.m9.1"><semantics id="S4.SS2.p3.9.m9.1a"><msub id="S4.SS2.p3.9.m9.1.1" xref="S4.SS2.p3.9.m9.1.1.cmml"><mi id="S4.SS2.p3.9.m9.1.1.2" xref="S4.SS2.p3.9.m9.1.1.2.cmml">S</mi><msubsup id="S4.SS2.p3.9.m9.1.1.3" xref="S4.SS2.p3.9.m9.1.1.3.cmml"><mi id="S4.SS2.p3.9.m9.1.1.3.2.2" xref="S4.SS2.p3.9.m9.1.1.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.9.m9.1.1.3.2.3" xref="S4.SS2.p3.9.m9.1.1.3.2.3.cmml">1</mn><mi id="S4.SS2.p3.9.m9.1.1.3.3" xref="S4.SS2.p3.9.m9.1.1.3.3.cmml">s</mi></msubsup></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.9.m9.1b"><apply id="S4.SS2.p3.9.m9.1.1.cmml" xref="S4.SS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.9.m9.1.1.1.cmml" xref="S4.SS2.p3.9.m9.1.1">subscript</csymbol><ci id="S4.SS2.p3.9.m9.1.1.2.cmml" xref="S4.SS2.p3.9.m9.1.1.2">𝑆</ci><apply id="S4.SS2.p3.9.m9.1.1.3.cmml" xref="S4.SS2.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.9.m9.1.1.3.1.cmml" xref="S4.SS2.p3.9.m9.1.1.3">superscript</csymbol><apply id="S4.SS2.p3.9.m9.1.1.3.2.cmml" xref="S4.SS2.p3.9.m9.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.9.m9.1.1.3.2.1.cmml" xref="S4.SS2.p3.9.m9.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.9.m9.1.1.3.2.2.cmml" xref="S4.SS2.p3.9.m9.1.1.3.2.2">𝑅</ci><cn id="S4.SS2.p3.9.m9.1.1.3.2.3.cmml" type="integer" xref="S4.SS2.p3.9.m9.1.1.3.2.3">1</cn></apply><ci id="S4.SS2.p3.9.m9.1.1.3.3.cmml" xref="S4.SS2.p3.9.m9.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.9.m9.1c">S_{R_{1}^{s}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.9.m9.1d">italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="S_{R_{2}^{g}}" class="ltx_Math" display="inline" id="S4.SS2.p3.10.m10.1"><semantics id="S4.SS2.p3.10.m10.1a"><msub id="S4.SS2.p3.10.m10.1.1" xref="S4.SS2.p3.10.m10.1.1.cmml"><mi id="S4.SS2.p3.10.m10.1.1.2" xref="S4.SS2.p3.10.m10.1.1.2.cmml">S</mi><msubsup id="S4.SS2.p3.10.m10.1.1.3" xref="S4.SS2.p3.10.m10.1.1.3.cmml"><mi id="S4.SS2.p3.10.m10.1.1.3.2.2" xref="S4.SS2.p3.10.m10.1.1.3.2.2.cmml">R</mi><mn id="S4.SS2.p3.10.m10.1.1.3.2.3" xref="S4.SS2.p3.10.m10.1.1.3.2.3.cmml">2</mn><mi id="S4.SS2.p3.10.m10.1.1.3.3" xref="S4.SS2.p3.10.m10.1.1.3.3.cmml">g</mi></msubsup></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.10.m10.1b"><apply id="S4.SS2.p3.10.m10.1.1.cmml" xref="S4.SS2.p3.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.10.m10.1.1.1.cmml" xref="S4.SS2.p3.10.m10.1.1">subscript</csymbol><ci id="S4.SS2.p3.10.m10.1.1.2.cmml" xref="S4.SS2.p3.10.m10.1.1.2">𝑆</ci><apply id="S4.SS2.p3.10.m10.1.1.3.cmml" xref="S4.SS2.p3.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.10.m10.1.1.3.1.cmml" xref="S4.SS2.p3.10.m10.1.1.3">superscript</csymbol><apply id="S4.SS2.p3.10.m10.1.1.3.2.cmml" xref="S4.SS2.p3.10.m10.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.10.m10.1.1.3.2.1.cmml" xref="S4.SS2.p3.10.m10.1.1.3">subscript</csymbol><ci id="S4.SS2.p3.10.m10.1.1.3.2.2.cmml" xref="S4.SS2.p3.10.m10.1.1.3.2.2">𝑅</ci><cn id="S4.SS2.p3.10.m10.1.1.3.2.3.cmml" type="integer" xref="S4.SS2.p3.10.m10.1.1.3.2.3">2</cn></apply><ci id="S4.SS2.p3.10.m10.1.1.3.3.cmml" xref="S4.SS2.p3.10.m10.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.10.m10.1c">S_{R_{2}^{g}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.10.m10.1d">italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> to quantize activation values. Taking 8-bit quantization as an example, the final data format uses unsigned integers, including 1 bit for the region index and 7 bits for the quantized value. The region index is used for range calibration (0 for <math alttext="R_{1}" class="ltx_Math" display="inline" id="S4.SS2.p3.11.m11.1"><semantics id="S4.SS2.p3.11.m11.1a"><msub id="S4.SS2.p3.11.m11.1.1" xref="S4.SS2.p3.11.m11.1.1.cmml"><mi id="S4.SS2.p3.11.m11.1.1.2" xref="S4.SS2.p3.11.m11.1.1.2.cmml">R</mi><mn id="S4.SS2.p3.11.m11.1.1.3" xref="S4.SS2.p3.11.m11.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.11.m11.1b"><apply id="S4.SS2.p3.11.m11.1.1.cmml" xref="S4.SS2.p3.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.11.m11.1.1.1.cmml" xref="S4.SS2.p3.11.m11.1.1">subscript</csymbol><ci id="S4.SS2.p3.11.m11.1.1.2.cmml" xref="S4.SS2.p3.11.m11.1.1.2">𝑅</ci><cn id="S4.SS2.p3.11.m11.1.1.3.cmml" type="integer" xref="S4.SS2.p3.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.11.m11.1c">R_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.11.m11.1d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> , 1 for <math alttext="R_{2}" class="ltx_Math" display="inline" id="S4.SS2.p3.12.m12.1"><semantics id="S4.SS2.p3.12.m12.1a"><msub id="S4.SS2.p3.12.m12.1.1" xref="S4.SS2.p3.12.m12.1.1.cmml"><mi id="S4.SS2.p3.12.m12.1.1.2" xref="S4.SS2.p3.12.m12.1.1.2.cmml">R</mi><mn id="S4.SS2.p3.12.m12.1.1.3" xref="S4.SS2.p3.12.m12.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.12.m12.1b"><apply id="S4.SS2.p3.12.m12.1.1.cmml" xref="S4.SS2.p3.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS2.p3.12.m12.1.1.1.cmml" xref="S4.SS2.p3.12.m12.1.1">subscript</csymbol><ci id="S4.SS2.p3.12.m12.1.1.2.cmml" xref="S4.SS2.p3.12.m12.1.1.2">𝑅</ci><cn id="S4.SS2.p3.12.m12.1.1.3.cmml" type="integer" xref="S4.SS2.p3.12.m12.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.12.m12.1c">R_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.12.m12.1d">italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>). Meanwhile, we use <math alttext="S_{R_{1}}=2^{-m}S_{R_{2}}" class="ltx_Math" display="inline" id="S4.SS2.p3.13.m13.1"><semantics id="S4.SS2.p3.13.m13.1a"><mrow id="S4.SS2.p3.13.m13.1.1" xref="S4.SS2.p3.13.m13.1.1.cmml"><msub id="S4.SS2.p3.13.m13.1.1.2" xref="S4.SS2.p3.13.m13.1.1.2.cmml"><mi id="S4.SS2.p3.13.m13.1.1.2.2" xref="S4.SS2.p3.13.m13.1.1.2.2.cmml">S</mi><msub id="S4.SS2.p3.13.m13.1.1.2.3" xref="S4.SS2.p3.13.m13.1.1.2.3.cmml"><mi id="S4.SS2.p3.13.m13.1.1.2.3.2" xref="S4.SS2.p3.13.m13.1.1.2.3.2.cmml">R</mi><mn id="S4.SS2.p3.13.m13.1.1.2.3.3" xref="S4.SS2.p3.13.m13.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S4.SS2.p3.13.m13.1.1.1" xref="S4.SS2.p3.13.m13.1.1.1.cmml">=</mo><mrow id="S4.SS2.p3.13.m13.1.1.3" xref="S4.SS2.p3.13.m13.1.1.3.cmml"><msup id="S4.SS2.p3.13.m13.1.1.3.2" xref="S4.SS2.p3.13.m13.1.1.3.2.cmml"><mn id="S4.SS2.p3.13.m13.1.1.3.2.2" xref="S4.SS2.p3.13.m13.1.1.3.2.2.cmml">2</mn><mrow id="S4.SS2.p3.13.m13.1.1.3.2.3" xref="S4.SS2.p3.13.m13.1.1.3.2.3.cmml"><mo id="S4.SS2.p3.13.m13.1.1.3.2.3a" xref="S4.SS2.p3.13.m13.1.1.3.2.3.cmml">−</mo><mi id="S4.SS2.p3.13.m13.1.1.3.2.3.2" xref="S4.SS2.p3.13.m13.1.1.3.2.3.2.cmml">m</mi></mrow></msup><mo id="S4.SS2.p3.13.m13.1.1.3.1" xref="S4.SS2.p3.13.m13.1.1.3.1.cmml">⁢</mo><msub id="S4.SS2.p3.13.m13.1.1.3.3" xref="S4.SS2.p3.13.m13.1.1.3.3.cmml"><mi id="S4.SS2.p3.13.m13.1.1.3.3.2" xref="S4.SS2.p3.13.m13.1.1.3.3.2.cmml">S</mi><msub id="S4.SS2.p3.13.m13.1.1.3.3.3" xref="S4.SS2.p3.13.m13.1.1.3.3.3.cmml"><mi id="S4.SS2.p3.13.m13.1.1.3.3.3.2" xref="S4.SS2.p3.13.m13.1.1.3.3.3.2.cmml">R</mi><mn id="S4.SS2.p3.13.m13.1.1.3.3.3.3" xref="S4.SS2.p3.13.m13.1.1.3.3.3.3.cmml">2</mn></msub></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.13.m13.1b"><apply id="S4.SS2.p3.13.m13.1.1.cmml" xref="S4.SS2.p3.13.m13.1.1"><eq id="S4.SS2.p3.13.m13.1.1.1.cmml" xref="S4.SS2.p3.13.m13.1.1.1"></eq><apply id="S4.SS2.p3.13.m13.1.1.2.cmml" xref="S4.SS2.p3.13.m13.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m13.1.1.2.1.cmml" xref="S4.SS2.p3.13.m13.1.1.2">subscript</csymbol><ci id="S4.SS2.p3.13.m13.1.1.2.2.cmml" xref="S4.SS2.p3.13.m13.1.1.2.2">𝑆</ci><apply id="S4.SS2.p3.13.m13.1.1.2.3.cmml" xref="S4.SS2.p3.13.m13.1.1.2.3"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m13.1.1.2.3.1.cmml" xref="S4.SS2.p3.13.m13.1.1.2.3">subscript</csymbol><ci id="S4.SS2.p3.13.m13.1.1.2.3.2.cmml" xref="S4.SS2.p3.13.m13.1.1.2.3.2">𝑅</ci><cn id="S4.SS2.p3.13.m13.1.1.2.3.3.cmml" type="integer" xref="S4.SS2.p3.13.m13.1.1.2.3.3">1</cn></apply></apply><apply id="S4.SS2.p3.13.m13.1.1.3.cmml" xref="S4.SS2.p3.13.m13.1.1.3"><times id="S4.SS2.p3.13.m13.1.1.3.1.cmml" xref="S4.SS2.p3.13.m13.1.1.3.1"></times><apply id="S4.SS2.p3.13.m13.1.1.3.2.cmml" xref="S4.SS2.p3.13.m13.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m13.1.1.3.2.1.cmml" xref="S4.SS2.p3.13.m13.1.1.3.2">superscript</csymbol><cn id="S4.SS2.p3.13.m13.1.1.3.2.2.cmml" type="integer" xref="S4.SS2.p3.13.m13.1.1.3.2.2">2</cn><apply id="S4.SS2.p3.13.m13.1.1.3.2.3.cmml" xref="S4.SS2.p3.13.m13.1.1.3.2.3"><minus id="S4.SS2.p3.13.m13.1.1.3.2.3.1.cmml" xref="S4.SS2.p3.13.m13.1.1.3.2.3"></minus><ci id="S4.SS2.p3.13.m13.1.1.3.2.3.2.cmml" xref="S4.SS2.p3.13.m13.1.1.3.2.3.2">𝑚</ci></apply></apply><apply id="S4.SS2.p3.13.m13.1.1.3.3.cmml" xref="S4.SS2.p3.13.m13.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m13.1.1.3.3.1.cmml" xref="S4.SS2.p3.13.m13.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p3.13.m13.1.1.3.3.2.cmml" xref="S4.SS2.p3.13.m13.1.1.3.3.2">𝑆</ci><apply id="S4.SS2.p3.13.m13.1.1.3.3.3.cmml" xref="S4.SS2.p3.13.m13.1.1.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p3.13.m13.1.1.3.3.3.1.cmml" xref="S4.SS2.p3.13.m13.1.1.3.3.3">subscript</csymbol><ci id="S4.SS2.p3.13.m13.1.1.3.3.3.2.cmml" xref="S4.SS2.p3.13.m13.1.1.3.3.3.2">𝑅</ci><cn id="S4.SS2.p3.13.m13.1.1.3.3.3.3.cmml" type="integer" xref="S4.SS2.p3.13.m13.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.13.m13.1c">S_{R_{1}}=2^{-m}S_{R_{2}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.13.m13.1d">italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT = 2 start_POSTSUPERSCRIPT - italic_m end_POSTSUPERSCRIPT italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> to establish a constraint between the two regions, enabling the replacement of multiplication with left-shifting by <math alttext="m" class="ltx_Math" display="inline" id="S4.SS2.p3.14.m14.1"><semantics id="S4.SS2.p3.14.m14.1a"><mi id="S4.SS2.p3.14.m14.1.1" xref="S4.SS2.p3.14.m14.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.14.m14.1b"><ci id="S4.SS2.p3.14.m14.1.1.cmml" xref="S4.SS2.p3.14.m14.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.14.m14.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.14.m14.1d">italic_m</annotation></semantics></math> bit. This approach facilitates rapid alignment of scale factors, thereby reducing the computational cost.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.19">The matrix multiplications <math alttext="QK^{\top}" class="ltx_Math" display="inline" id="S4.SS2.p4.1.m1.1"><semantics id="S4.SS2.p4.1.m1.1a"><mrow id="S4.SS2.p4.1.m1.1.1" xref="S4.SS2.p4.1.m1.1.1.cmml"><mi id="S4.SS2.p4.1.m1.1.1.2" xref="S4.SS2.p4.1.m1.1.1.2.cmml">Q</mi><mo id="S4.SS2.p4.1.m1.1.1.1" xref="S4.SS2.p4.1.m1.1.1.1.cmml">⁢</mo><msup id="S4.SS2.p4.1.m1.1.1.3" xref="S4.SS2.p4.1.m1.1.1.3.cmml"><mi id="S4.SS2.p4.1.m1.1.1.3.2" xref="S4.SS2.p4.1.m1.1.1.3.2.cmml">K</mi><mo id="S4.SS2.p4.1.m1.1.1.3.3" xref="S4.SS2.p4.1.m1.1.1.3.3.cmml">⊤</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.1.m1.1b"><apply id="S4.SS2.p4.1.m1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1"><times id="S4.SS2.p4.1.m1.1.1.1.cmml" xref="S4.SS2.p4.1.m1.1.1.1"></times><ci id="S4.SS2.p4.1.m1.1.1.2.cmml" xref="S4.SS2.p4.1.m1.1.1.2">𝑄</ci><apply id="S4.SS2.p4.1.m1.1.1.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.1.m1.1.1.3.1.cmml" xref="S4.SS2.p4.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS2.p4.1.m1.1.1.3.2.cmml" xref="S4.SS2.p4.1.m1.1.1.3.2">𝐾</ci><csymbol cd="latexml" id="S4.SS2.p4.1.m1.1.1.3.3.cmml" xref="S4.SS2.p4.1.m1.1.1.3.3">top</csymbol></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.1.m1.1c">QK^{\top}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.1.m1.1d">italic_Q italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>and <math alttext="PV" class="ltx_Math" display="inline" id="S4.SS2.p4.2.m2.1"><semantics id="S4.SS2.p4.2.m2.1a"><mrow id="S4.SS2.p4.2.m2.1.1" xref="S4.SS2.p4.2.m2.1.1.cmml"><mi id="S4.SS2.p4.2.m2.1.1.2" xref="S4.SS2.p4.2.m2.1.1.2.cmml">P</mi><mo id="S4.SS2.p4.2.m2.1.1.1" xref="S4.SS2.p4.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p4.2.m2.1.1.3" xref="S4.SS2.p4.2.m2.1.1.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.2.m2.1b"><apply id="S4.SS2.p4.2.m2.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1"><times id="S4.SS2.p4.2.m2.1.1.1.cmml" xref="S4.SS2.p4.2.m2.1.1.1"></times><ci id="S4.SS2.p4.2.m2.1.1.2.cmml" xref="S4.SS2.p4.2.m2.1.1.2">𝑃</ci><ci id="S4.SS2.p4.2.m2.1.1.3.cmml" xref="S4.SS2.p4.2.m2.1.1.3">𝑉</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.2.m2.1c">PV</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.2.m2.1d">italic_P italic_V</annotation></semantics></math> in self-attention are critical operations in transformer, where <math alttext="P=\text{softmax}((QK^{\top})/\sqrt{d_{k}})" class="ltx_Math" display="inline" id="S4.SS2.p4.3.m3.1"><semantics id="S4.SS2.p4.3.m3.1a"><mrow id="S4.SS2.p4.3.m3.1.1" xref="S4.SS2.p4.3.m3.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.3" xref="S4.SS2.p4.3.m3.1.1.3.cmml">P</mi><mo id="S4.SS2.p4.3.m3.1.1.2" xref="S4.SS2.p4.3.m3.1.1.2.cmml">=</mo><mrow id="S4.SS2.p4.3.m3.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.cmml"><mtext id="S4.SS2.p4.3.m3.1.1.1.3" xref="S4.SS2.p4.3.m3.1.1.1.3a.cmml">softmax</mtext><mo id="S4.SS2.p4.3.m3.1.1.1.2" xref="S4.SS2.p4.3.m3.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p4.3.m3.1.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p4.3.m3.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p4.3.m3.1.1.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.cmml"><mrow id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.2.cmml">Q</mi><mo id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.2" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.2.cmml">K</mi><mo id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.3" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.3.cmml">⊤</mo></msup></mrow><mo id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.p4.3.m3.1.1.1.1.1.1.2" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.2.cmml">/</mo><msqrt id="S4.SS2.p4.3.m3.1.1.1.1.1.1.3" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.cmml"><msub id="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.2" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.2.cmml">d</mi><mi id="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.3" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.3.cmml">k</mi></msub></msqrt></mrow><mo id="S4.SS2.p4.3.m3.1.1.1.1.1.3" stretchy="false" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.3.m3.1b"><apply id="S4.SS2.p4.3.m3.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1"><eq id="S4.SS2.p4.3.m3.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.2"></eq><ci id="S4.SS2.p4.3.m3.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.3">𝑃</ci><apply id="S4.SS2.p4.3.m3.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1"><times id="S4.SS2.p4.3.m3.1.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.2"></times><ci id="S4.SS2.p4.3.m3.1.1.1.3a.cmml" xref="S4.SS2.p4.3.m3.1.1.1.3"><mtext id="S4.SS2.p4.3.m3.1.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.3">softmax</mtext></ci><apply id="S4.SS2.p4.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1"><divide id="S4.SS2.p4.3.m3.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.2"></divide><apply id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1"><times id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.1"></times><ci id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.2">𝑄</ci><apply id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.2">𝐾</ci><csymbol cd="latexml" id="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.1.1.1.3.3">top</csymbol></apply></apply><apply id="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.3"><root id="S4.SS2.p4.3.m3.1.1.1.1.1.1.3a.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.3"></root><apply id="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.2">𝑑</ci><ci id="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS2.p4.3.m3.1.1.1.1.1.1.3.2.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.3.m3.1c">P=\text{softmax}((QK^{\top})/\sqrt{d_{k}})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.3.m3.1d">italic_P = softmax ( ( italic_Q italic_K start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT ) / square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG )</annotation></semantics></math> and <math alttext="d_{k}" class="ltx_Math" display="inline" id="S4.SS2.p4.4.m4.1"><semantics id="S4.SS2.p4.4.m4.1a"><msub id="S4.SS2.p4.4.m4.1.1" xref="S4.SS2.p4.4.m4.1.1.cmml"><mi id="S4.SS2.p4.4.m4.1.1.2" xref="S4.SS2.p4.4.m4.1.1.2.cmml">d</mi><mi id="S4.SS2.p4.4.m4.1.1.3" xref="S4.SS2.p4.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.4.m4.1b"><apply id="S4.SS2.p4.4.m4.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.4.m4.1.1.1.cmml" xref="S4.SS2.p4.4.m4.1.1">subscript</csymbol><ci id="S4.SS2.p4.4.m4.1.1.2.cmml" xref="S4.SS2.p4.4.m4.1.1.2">𝑑</ci><ci id="S4.SS2.p4.4.m4.1.1.3.cmml" xref="S4.SS2.p4.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.4.m4.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.4.m4.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the dimension of the key vectors. For simplicity, we represent it as <math alttext="K=AB" class="ltx_Math" display="inline" id="S4.SS2.p4.5.m5.1"><semantics id="S4.SS2.p4.5.m5.1a"><mrow id="S4.SS2.p4.5.m5.1.1" xref="S4.SS2.p4.5.m5.1.1.cmml"><mi id="S4.SS2.p4.5.m5.1.1.2" xref="S4.SS2.p4.5.m5.1.1.2.cmml">K</mi><mo id="S4.SS2.p4.5.m5.1.1.1" xref="S4.SS2.p4.5.m5.1.1.1.cmml">=</mo><mrow id="S4.SS2.p4.5.m5.1.1.3" xref="S4.SS2.p4.5.m5.1.1.3.cmml"><mi id="S4.SS2.p4.5.m5.1.1.3.2" xref="S4.SS2.p4.5.m5.1.1.3.2.cmml">A</mi><mo id="S4.SS2.p4.5.m5.1.1.3.1" xref="S4.SS2.p4.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.p4.5.m5.1.1.3.3" xref="S4.SS2.p4.5.m5.1.1.3.3.cmml">B</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.5.m5.1b"><apply id="S4.SS2.p4.5.m5.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1"><eq id="S4.SS2.p4.5.m5.1.1.1.cmml" xref="S4.SS2.p4.5.m5.1.1.1"></eq><ci id="S4.SS2.p4.5.m5.1.1.2.cmml" xref="S4.SS2.p4.5.m5.1.1.2">𝐾</ci><apply id="S4.SS2.p4.5.m5.1.1.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3"><times id="S4.SS2.p4.5.m5.1.1.3.1.cmml" xref="S4.SS2.p4.5.m5.1.1.3.1"></times><ci id="S4.SS2.p4.5.m5.1.1.3.2.cmml" xref="S4.SS2.p4.5.m5.1.1.3.2">𝐴</ci><ci id="S4.SS2.p4.5.m5.1.1.3.3.cmml" xref="S4.SS2.p4.5.m5.1.1.3.3">𝐵</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.5.m5.1c">K=AB</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.5.m5.1d">italic_K = italic_A italic_B</annotation></semantics></math>. The Hessian-guided metric <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a>]</cite> is used to determine the quantization scale factors <math alttext="S_{A}" class="ltx_Math" display="inline" id="S4.SS2.p4.6.m6.1"><semantics id="S4.SS2.p4.6.m6.1a"><msub id="S4.SS2.p4.6.m6.1.1" xref="S4.SS2.p4.6.m6.1.1.cmml"><mi id="S4.SS2.p4.6.m6.1.1.2" xref="S4.SS2.p4.6.m6.1.1.2.cmml">S</mi><mi id="S4.SS2.p4.6.m6.1.1.3" xref="S4.SS2.p4.6.m6.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.6.m6.1b"><apply id="S4.SS2.p4.6.m6.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.6.m6.1.1.1.cmml" xref="S4.SS2.p4.6.m6.1.1">subscript</csymbol><ci id="S4.SS2.p4.6.m6.1.1.2.cmml" xref="S4.SS2.p4.6.m6.1.1.2">𝑆</ci><ci id="S4.SS2.p4.6.m6.1.1.3.cmml" xref="S4.SS2.p4.6.m6.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.6.m6.1c">S_{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.6.m6.1d">italic_S start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="S_{B}" class="ltx_Math" display="inline" id="S4.SS2.p4.7.m7.1"><semantics id="S4.SS2.p4.7.m7.1a"><msub id="S4.SS2.p4.7.m7.1.1" xref="S4.SS2.p4.7.m7.1.1.cmml"><mi id="S4.SS2.p4.7.m7.1.1.2" xref="S4.SS2.p4.7.m7.1.1.2.cmml">S</mi><mi id="S4.SS2.p4.7.m7.1.1.3" xref="S4.SS2.p4.7.m7.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.7.m7.1b"><apply id="S4.SS2.p4.7.m7.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.7.m7.1.1.1.cmml" xref="S4.SS2.p4.7.m7.1.1">subscript</csymbol><ci id="S4.SS2.p4.7.m7.1.1.2.cmml" xref="S4.SS2.p4.7.m7.1.1.2">𝑆</ci><ci id="S4.SS2.p4.7.m7.1.1.3.cmml" xref="S4.SS2.p4.7.m7.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.7.m7.1c">S_{B}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.7.m7.1d">italic_S start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math> for the two matrices. Here, <math alttext="S_{A}" class="ltx_Math" display="inline" id="S4.SS2.p4.8.m8.1"><semantics id="S4.SS2.p4.8.m8.1a"><msub id="S4.SS2.p4.8.m8.1.1" xref="S4.SS2.p4.8.m8.1.1.cmml"><mi id="S4.SS2.p4.8.m8.1.1.2" xref="S4.SS2.p4.8.m8.1.1.2.cmml">S</mi><mi id="S4.SS2.p4.8.m8.1.1.3" xref="S4.SS2.p4.8.m8.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.8.m8.1b"><apply id="S4.SS2.p4.8.m8.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.8.m8.1.1.1.cmml" xref="S4.SS2.p4.8.m8.1.1">subscript</csymbol><ci id="S4.SS2.p4.8.m8.1.1.2.cmml" xref="S4.SS2.p4.8.m8.1.1.2">𝑆</ci><ci id="S4.SS2.p4.8.m8.1.1.3.cmml" xref="S4.SS2.p4.8.m8.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.8.m8.1c">S_{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.8.m8.1d">italic_S start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math> represents the scale factor for matrices corresponding to either <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS2.p4.9.m9.1"><semantics id="S4.SS2.p4.9.m9.1a"><mi id="S4.SS2.p4.9.m9.1.1" xref="S4.SS2.p4.9.m9.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.9.m9.1b"><ci id="S4.SS2.p4.9.m9.1.1.cmml" xref="S4.SS2.p4.9.m9.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.9.m9.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.9.m9.1d">italic_Q</annotation></semantics></math> or <math alttext="P" class="ltx_Math" display="inline" id="S4.SS2.p4.10.m10.1"><semantics id="S4.SS2.p4.10.m10.1a"><mi id="S4.SS2.p4.10.m10.1.1" xref="S4.SS2.p4.10.m10.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.10.m10.1b"><ci id="S4.SS2.p4.10.m10.1.1.cmml" xref="S4.SS2.p4.10.m10.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.10.m10.1c">P</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.10.m10.1d">italic_P</annotation></semantics></math>.
We create the search space for <math alttext="S_{A}" class="ltx_Math" display="inline" id="S4.SS2.p4.11.m11.1"><semantics id="S4.SS2.p4.11.m11.1a"><msub id="S4.SS2.p4.11.m11.1.1" xref="S4.SS2.p4.11.m11.1.1.cmml"><mi id="S4.SS2.p4.11.m11.1.1.2" xref="S4.SS2.p4.11.m11.1.1.2.cmml">S</mi><mi id="S4.SS2.p4.11.m11.1.1.3" xref="S4.SS2.p4.11.m11.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.11.m11.1b"><apply id="S4.SS2.p4.11.m11.1.1.cmml" xref="S4.SS2.p4.11.m11.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.11.m11.1.1.1.cmml" xref="S4.SS2.p4.11.m11.1.1">subscript</csymbol><ci id="S4.SS2.p4.11.m11.1.1.2.cmml" xref="S4.SS2.p4.11.m11.1.1.2">𝑆</ci><ci id="S4.SS2.p4.11.m11.1.1.3.cmml" xref="S4.SS2.p4.11.m11.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.11.m11.1c">S_{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.11.m11.1d">italic_S start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="S_{B}" class="ltx_Math" display="inline" id="S4.SS2.p4.12.m12.1"><semantics id="S4.SS2.p4.12.m12.1a"><msub id="S4.SS2.p4.12.m12.1.1" xref="S4.SS2.p4.12.m12.1.1.cmml"><mi id="S4.SS2.p4.12.m12.1.1.2" xref="S4.SS2.p4.12.m12.1.1.2.cmml">S</mi><mi id="S4.SS2.p4.12.m12.1.1.3" xref="S4.SS2.p4.12.m12.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.12.m12.1b"><apply id="S4.SS2.p4.12.m12.1.1.cmml" xref="S4.SS2.p4.12.m12.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.12.m12.1.1.1.cmml" xref="S4.SS2.p4.12.m12.1.1">subscript</csymbol><ci id="S4.SS2.p4.12.m12.1.1.2.cmml" xref="S4.SS2.p4.12.m12.1.1.2">𝑆</ci><ci id="S4.SS2.p4.12.m12.1.1.3.cmml" xref="S4.SS2.p4.12.m12.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.12.m12.1c">S_{B}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.12.m12.1d">italic_S start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math> by linearly divided the ranges <math alttext="[\alpha\frac{A_{\text{max}}}{2^{b}-1},\beta\frac{A_{\text{max}}}{2^{b}-1}]" class="ltx_Math" display="inline" id="S4.SS2.p4.13.m13.2"><semantics id="S4.SS2.p4.13.m13.2a"><mrow id="S4.SS2.p4.13.m13.2.2.2" xref="S4.SS2.p4.13.m13.2.2.3.cmml"><mo id="S4.SS2.p4.13.m13.2.2.2.3" stretchy="false" xref="S4.SS2.p4.13.m13.2.2.3.cmml">[</mo><mrow id="S4.SS2.p4.13.m13.1.1.1.1" xref="S4.SS2.p4.13.m13.1.1.1.1.cmml"><mi id="S4.SS2.p4.13.m13.1.1.1.1.2" xref="S4.SS2.p4.13.m13.1.1.1.1.2.cmml">α</mi><mo id="S4.SS2.p4.13.m13.1.1.1.1.1" xref="S4.SS2.p4.13.m13.1.1.1.1.1.cmml">⁢</mo><mfrac id="S4.SS2.p4.13.m13.1.1.1.1.3" xref="S4.SS2.p4.13.m13.1.1.1.1.3.cmml"><msub id="S4.SS2.p4.13.m13.1.1.1.1.3.2" xref="S4.SS2.p4.13.m13.1.1.1.1.3.2.cmml"><mi id="S4.SS2.p4.13.m13.1.1.1.1.3.2.2" xref="S4.SS2.p4.13.m13.1.1.1.1.3.2.2.cmml">A</mi><mtext id="S4.SS2.p4.13.m13.1.1.1.1.3.2.3" xref="S4.SS2.p4.13.m13.1.1.1.1.3.2.3a.cmml">max</mtext></msub><mrow id="S4.SS2.p4.13.m13.1.1.1.1.3.3" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.cmml"><msup id="S4.SS2.p4.13.m13.1.1.1.1.3.3.2" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.cmml"><mn id="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.2" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.2.cmml">2</mn><mi id="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.3" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.3.cmml">b</mi></msup><mo id="S4.SS2.p4.13.m13.1.1.1.1.3.3.1" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.SS2.p4.13.m13.1.1.1.1.3.3.3" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mrow><mo id="S4.SS2.p4.13.m13.2.2.2.4" xref="S4.SS2.p4.13.m13.2.2.3.cmml">,</mo><mrow id="S4.SS2.p4.13.m13.2.2.2.2" xref="S4.SS2.p4.13.m13.2.2.2.2.cmml"><mi id="S4.SS2.p4.13.m13.2.2.2.2.2" xref="S4.SS2.p4.13.m13.2.2.2.2.2.cmml">β</mi><mo id="S4.SS2.p4.13.m13.2.2.2.2.1" xref="S4.SS2.p4.13.m13.2.2.2.2.1.cmml">⁢</mo><mfrac id="S4.SS2.p4.13.m13.2.2.2.2.3" xref="S4.SS2.p4.13.m13.2.2.2.2.3.cmml"><msub id="S4.SS2.p4.13.m13.2.2.2.2.3.2" xref="S4.SS2.p4.13.m13.2.2.2.2.3.2.cmml"><mi id="S4.SS2.p4.13.m13.2.2.2.2.3.2.2" xref="S4.SS2.p4.13.m13.2.2.2.2.3.2.2.cmml">A</mi><mtext id="S4.SS2.p4.13.m13.2.2.2.2.3.2.3" xref="S4.SS2.p4.13.m13.2.2.2.2.3.2.3a.cmml">max</mtext></msub><mrow id="S4.SS2.p4.13.m13.2.2.2.2.3.3" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.cmml"><msup id="S4.SS2.p4.13.m13.2.2.2.2.3.3.2" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.cmml"><mn id="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.2" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.2.cmml">2</mn><mi id="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.3" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.3.cmml">b</mi></msup><mo id="S4.SS2.p4.13.m13.2.2.2.2.3.3.1" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.1.cmml">−</mo><mn id="S4.SS2.p4.13.m13.2.2.2.2.3.3.3" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.3.cmml">1</mn></mrow></mfrac></mrow><mo id="S4.SS2.p4.13.m13.2.2.2.5" stretchy="false" xref="S4.SS2.p4.13.m13.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.13.m13.2b"><interval closure="closed" id="S4.SS2.p4.13.m13.2.2.3.cmml" xref="S4.SS2.p4.13.m13.2.2.2"><apply id="S4.SS2.p4.13.m13.1.1.1.1.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1"><times id="S4.SS2.p4.13.m13.1.1.1.1.1.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.1"></times><ci id="S4.SS2.p4.13.m13.1.1.1.1.2.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.2">𝛼</ci><apply id="S4.SS2.p4.13.m13.1.1.1.1.3.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3"><divide id="S4.SS2.p4.13.m13.1.1.1.1.3.1.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3"></divide><apply id="S4.SS2.p4.13.m13.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.13.m13.1.1.1.1.3.2.1.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p4.13.m13.1.1.1.1.3.2.2.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3.2.2">𝐴</ci><ci id="S4.SS2.p4.13.m13.1.1.1.1.3.2.3a.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3.2.3"><mtext id="S4.SS2.p4.13.m13.1.1.1.1.3.2.3.cmml" mathsize="50%" xref="S4.SS2.p4.13.m13.1.1.1.1.3.2.3">max</mtext></ci></apply><apply id="S4.SS2.p4.13.m13.1.1.1.1.3.3.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3"><minus id="S4.SS2.p4.13.m13.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.1"></minus><apply id="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.1.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.2">superscript</csymbol><cn id="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.2.cmml" type="integer" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.2">2</cn><ci id="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.3.cmml" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.2.3">𝑏</ci></apply><cn id="S4.SS2.p4.13.m13.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.SS2.p4.13.m13.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S4.SS2.p4.13.m13.2.2.2.2.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2"><times id="S4.SS2.p4.13.m13.2.2.2.2.1.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.1"></times><ci id="S4.SS2.p4.13.m13.2.2.2.2.2.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.2">𝛽</ci><apply id="S4.SS2.p4.13.m13.2.2.2.2.3.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3"><divide id="S4.SS2.p4.13.m13.2.2.2.2.3.1.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3"></divide><apply id="S4.SS2.p4.13.m13.2.2.2.2.3.2.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.13.m13.2.2.2.2.3.2.1.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3.2">subscript</csymbol><ci id="S4.SS2.p4.13.m13.2.2.2.2.3.2.2.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3.2.2">𝐴</ci><ci id="S4.SS2.p4.13.m13.2.2.2.2.3.2.3a.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3.2.3"><mtext id="S4.SS2.p4.13.m13.2.2.2.2.3.2.3.cmml" mathsize="50%" xref="S4.SS2.p4.13.m13.2.2.2.2.3.2.3">max</mtext></ci></apply><apply id="S4.SS2.p4.13.m13.2.2.2.2.3.3.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3"><minus id="S4.SS2.p4.13.m13.2.2.2.2.3.3.1.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.1"></minus><apply id="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.1.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.2">superscript</csymbol><cn id="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.2.cmml" type="integer" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.2">2</cn><ci id="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.3.cmml" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.2.3">𝑏</ci></apply><cn id="S4.SS2.p4.13.m13.2.2.2.2.3.3.3.cmml" type="integer" xref="S4.SS2.p4.13.m13.2.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.13.m13.2c">[\alpha\frac{A_{\text{max}}}{2^{b}-1},\beta\frac{A_{\text{max}}}{2^{b}-1}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.13.m13.2d">[ italic_α divide start_ARG italic_A start_POSTSUBSCRIPT max end_POSTSUBSCRIPT end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - 1 end_ARG , italic_β divide start_ARG italic_A start_POSTSUBSCRIPT max end_POSTSUBSCRIPT end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - 1 end_ARG ]</annotation></semantics></math> and <math alttext="[\alpha\frac{B_{\text{max}}}{2^{b}-1},\beta\frac{B_{\text{max}}}{2^{b}-1}]" class="ltx_Math" display="inline" id="S4.SS2.p4.14.m14.2"><semantics id="S4.SS2.p4.14.m14.2a"><mrow id="S4.SS2.p4.14.m14.2.2.2" xref="S4.SS2.p4.14.m14.2.2.3.cmml"><mo id="S4.SS2.p4.14.m14.2.2.2.3" stretchy="false" xref="S4.SS2.p4.14.m14.2.2.3.cmml">[</mo><mrow id="S4.SS2.p4.14.m14.1.1.1.1" xref="S4.SS2.p4.14.m14.1.1.1.1.cmml"><mi id="S4.SS2.p4.14.m14.1.1.1.1.2" xref="S4.SS2.p4.14.m14.1.1.1.1.2.cmml">α</mi><mo id="S4.SS2.p4.14.m14.1.1.1.1.1" xref="S4.SS2.p4.14.m14.1.1.1.1.1.cmml">⁢</mo><mfrac id="S4.SS2.p4.14.m14.1.1.1.1.3" xref="S4.SS2.p4.14.m14.1.1.1.1.3.cmml"><msub id="S4.SS2.p4.14.m14.1.1.1.1.3.2" xref="S4.SS2.p4.14.m14.1.1.1.1.3.2.cmml"><mi id="S4.SS2.p4.14.m14.1.1.1.1.3.2.2" xref="S4.SS2.p4.14.m14.1.1.1.1.3.2.2.cmml">B</mi><mtext id="S4.SS2.p4.14.m14.1.1.1.1.3.2.3" xref="S4.SS2.p4.14.m14.1.1.1.1.3.2.3a.cmml">max</mtext></msub><mrow id="S4.SS2.p4.14.m14.1.1.1.1.3.3" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.cmml"><msup id="S4.SS2.p4.14.m14.1.1.1.1.3.3.2" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.cmml"><mn id="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.2" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.2.cmml">2</mn><mi id="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.3" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.3.cmml">b</mi></msup><mo id="S4.SS2.p4.14.m14.1.1.1.1.3.3.1" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.SS2.p4.14.m14.1.1.1.1.3.3.3" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.3.cmml">1</mn></mrow></mfrac></mrow><mo id="S4.SS2.p4.14.m14.2.2.2.4" xref="S4.SS2.p4.14.m14.2.2.3.cmml">,</mo><mrow id="S4.SS2.p4.14.m14.2.2.2.2" xref="S4.SS2.p4.14.m14.2.2.2.2.cmml"><mi id="S4.SS2.p4.14.m14.2.2.2.2.2" xref="S4.SS2.p4.14.m14.2.2.2.2.2.cmml">β</mi><mo id="S4.SS2.p4.14.m14.2.2.2.2.1" xref="S4.SS2.p4.14.m14.2.2.2.2.1.cmml">⁢</mo><mfrac id="S4.SS2.p4.14.m14.2.2.2.2.3" xref="S4.SS2.p4.14.m14.2.2.2.2.3.cmml"><msub id="S4.SS2.p4.14.m14.2.2.2.2.3.2" xref="S4.SS2.p4.14.m14.2.2.2.2.3.2.cmml"><mi id="S4.SS2.p4.14.m14.2.2.2.2.3.2.2" xref="S4.SS2.p4.14.m14.2.2.2.2.3.2.2.cmml">B</mi><mtext id="S4.SS2.p4.14.m14.2.2.2.2.3.2.3" xref="S4.SS2.p4.14.m14.2.2.2.2.3.2.3a.cmml">max</mtext></msub><mrow id="S4.SS2.p4.14.m14.2.2.2.2.3.3" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.cmml"><msup id="S4.SS2.p4.14.m14.2.2.2.2.3.3.2" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.cmml"><mn id="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.2" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.2.cmml">2</mn><mi id="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.3" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.3.cmml">b</mi></msup><mo id="S4.SS2.p4.14.m14.2.2.2.2.3.3.1" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.1.cmml">−</mo><mn id="S4.SS2.p4.14.m14.2.2.2.2.3.3.3" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.3.cmml">1</mn></mrow></mfrac></mrow><mo id="S4.SS2.p4.14.m14.2.2.2.5" stretchy="false" xref="S4.SS2.p4.14.m14.2.2.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.14.m14.2b"><interval closure="closed" id="S4.SS2.p4.14.m14.2.2.3.cmml" xref="S4.SS2.p4.14.m14.2.2.2"><apply id="S4.SS2.p4.14.m14.1.1.1.1.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1"><times id="S4.SS2.p4.14.m14.1.1.1.1.1.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.1"></times><ci id="S4.SS2.p4.14.m14.1.1.1.1.2.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.2">𝛼</ci><apply id="S4.SS2.p4.14.m14.1.1.1.1.3.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3"><divide id="S4.SS2.p4.14.m14.1.1.1.1.3.1.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3"></divide><apply id="S4.SS2.p4.14.m14.1.1.1.1.3.2.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.14.m14.1.1.1.1.3.2.1.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS2.p4.14.m14.1.1.1.1.3.2.2.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3.2.2">𝐵</ci><ci id="S4.SS2.p4.14.m14.1.1.1.1.3.2.3a.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3.2.3"><mtext id="S4.SS2.p4.14.m14.1.1.1.1.3.2.3.cmml" mathsize="50%" xref="S4.SS2.p4.14.m14.1.1.1.1.3.2.3">max</mtext></ci></apply><apply id="S4.SS2.p4.14.m14.1.1.1.1.3.3.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3"><minus id="S4.SS2.p4.14.m14.1.1.1.1.3.3.1.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.1"></minus><apply id="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.1.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.2">superscript</csymbol><cn id="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.2.cmml" type="integer" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.2">2</cn><ci id="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.3.cmml" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.2.3">𝑏</ci></apply><cn id="S4.SS2.p4.14.m14.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.SS2.p4.14.m14.1.1.1.1.3.3.3">1</cn></apply></apply></apply><apply id="S4.SS2.p4.14.m14.2.2.2.2.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2"><times id="S4.SS2.p4.14.m14.2.2.2.2.1.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.1"></times><ci id="S4.SS2.p4.14.m14.2.2.2.2.2.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.2">𝛽</ci><apply id="S4.SS2.p4.14.m14.2.2.2.2.3.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3"><divide id="S4.SS2.p4.14.m14.2.2.2.2.3.1.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3"></divide><apply id="S4.SS2.p4.14.m14.2.2.2.2.3.2.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.14.m14.2.2.2.2.3.2.1.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3.2">subscript</csymbol><ci id="S4.SS2.p4.14.m14.2.2.2.2.3.2.2.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3.2.2">𝐵</ci><ci id="S4.SS2.p4.14.m14.2.2.2.2.3.2.3a.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3.2.3"><mtext id="S4.SS2.p4.14.m14.2.2.2.2.3.2.3.cmml" mathsize="50%" xref="S4.SS2.p4.14.m14.2.2.2.2.3.2.3">max</mtext></ci></apply><apply id="S4.SS2.p4.14.m14.2.2.2.2.3.3.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3"><minus id="S4.SS2.p4.14.m14.2.2.2.2.3.3.1.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.1"></minus><apply id="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.1.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.2">superscript</csymbol><cn id="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.2.cmml" type="integer" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.2">2</cn><ci id="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.3.cmml" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.2.3">𝑏</ci></apply><cn id="S4.SS2.p4.14.m14.2.2.2.2.3.3.3.cmml" type="integer" xref="S4.SS2.p4.14.m14.2.2.2.2.3.3.3">1</cn></apply></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.14.m14.2c">[\alpha\frac{B_{\text{max}}}{2^{b}-1},\beta\frac{B_{\text{max}}}{2^{b}-1}]</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.14.m14.2d">[ italic_α divide start_ARG italic_B start_POSTSUBSCRIPT max end_POSTSUBSCRIPT end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - 1 end_ARG , italic_β divide start_ARG italic_B start_POSTSUBSCRIPT max end_POSTSUBSCRIPT end_ARG start_ARG 2 start_POSTSUPERSCRIPT italic_b end_POSTSUPERSCRIPT - 1 end_ARG ]</annotation></semantics></math> to <math alttext="N" class="ltx_Math" display="inline" id="S4.SS2.p4.15.m15.1"><semantics id="S4.SS2.p4.15.m15.1a"><mi id="S4.SS2.p4.15.m15.1.1" xref="S4.SS2.p4.15.m15.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.15.m15.1b"><ci id="S4.SS2.p4.15.m15.1.1.cmml" xref="S4.SS2.p4.15.m15.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.15.m15.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.15.m15.1d">italic_N</annotation></semantics></math> candidates. We alternately search for the optimal scale factor in the above search space: First, by fixing <math alttext="S_{B}" class="ltx_Math" display="inline" id="S4.SS2.p4.16.m16.1"><semantics id="S4.SS2.p4.16.m16.1a"><msub id="S4.SS2.p4.16.m16.1.1" xref="S4.SS2.p4.16.m16.1.1.cmml"><mi id="S4.SS2.p4.16.m16.1.1.2" xref="S4.SS2.p4.16.m16.1.1.2.cmml">S</mi><mi id="S4.SS2.p4.16.m16.1.1.3" xref="S4.SS2.p4.16.m16.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.16.m16.1b"><apply id="S4.SS2.p4.16.m16.1.1.cmml" xref="S4.SS2.p4.16.m16.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.16.m16.1.1.1.cmml" xref="S4.SS2.p4.16.m16.1.1">subscript</csymbol><ci id="S4.SS2.p4.16.m16.1.1.2.cmml" xref="S4.SS2.p4.16.m16.1.1.2">𝑆</ci><ci id="S4.SS2.p4.16.m16.1.1.3.cmml" xref="S4.SS2.p4.16.m16.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.16.m16.1c">S_{B}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.16.m16.1d">italic_S start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math>, we determine the optimal <math alttext="S_{A}" class="ltx_Math" display="inline" id="S4.SS2.p4.17.m17.1"><semantics id="S4.SS2.p4.17.m17.1a"><msub id="S4.SS2.p4.17.m17.1.1" xref="S4.SS2.p4.17.m17.1.1.cmml"><mi id="S4.SS2.p4.17.m17.1.1.2" xref="S4.SS2.p4.17.m17.1.1.2.cmml">S</mi><mi id="S4.SS2.p4.17.m17.1.1.3" xref="S4.SS2.p4.17.m17.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.17.m17.1b"><apply id="S4.SS2.p4.17.m17.1.1.cmml" xref="S4.SS2.p4.17.m17.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.17.m17.1.1.1.cmml" xref="S4.SS2.p4.17.m17.1.1">subscript</csymbol><ci id="S4.SS2.p4.17.m17.1.1.2.cmml" xref="S4.SS2.p4.17.m17.1.1.2">𝑆</ci><ci id="S4.SS2.p4.17.m17.1.1.3.cmml" xref="S4.SS2.p4.17.m17.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.17.m17.1c">S_{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.17.m17.1d">italic_S start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math> that minimizes the quantization error. Second, with <math alttext="S_{A}" class="ltx_Math" display="inline" id="S4.SS2.p4.18.m18.1"><semantics id="S4.SS2.p4.18.m18.1a"><msub id="S4.SS2.p4.18.m18.1.1" xref="S4.SS2.p4.18.m18.1.1.cmml"><mi id="S4.SS2.p4.18.m18.1.1.2" xref="S4.SS2.p4.18.m18.1.1.2.cmml">S</mi><mi id="S4.SS2.p4.18.m18.1.1.3" xref="S4.SS2.p4.18.m18.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.18.m18.1b"><apply id="S4.SS2.p4.18.m18.1.1.cmml" xref="S4.SS2.p4.18.m18.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.18.m18.1.1.1.cmml" xref="S4.SS2.p4.18.m18.1.1">subscript</csymbol><ci id="S4.SS2.p4.18.m18.1.1.2.cmml" xref="S4.SS2.p4.18.m18.1.1.2">𝑆</ci><ci id="S4.SS2.p4.18.m18.1.1.3.cmml" xref="S4.SS2.p4.18.m18.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.18.m18.1c">S_{A}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.18.m18.1d">italic_S start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math> fixed, we search for the optimal <math alttext="S_{B}" class="ltx_Math" display="inline" id="S4.SS2.p4.19.m19.1"><semantics id="S4.SS2.p4.19.m19.1a"><msub id="S4.SS2.p4.19.m19.1.1" xref="S4.SS2.p4.19.m19.1.1.cmml"><mi id="S4.SS2.p4.19.m19.1.1.2" xref="S4.SS2.p4.19.m19.1.1.2.cmml">S</mi><mi id="S4.SS2.p4.19.m19.1.1.3" xref="S4.SS2.p4.19.m19.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p4.19.m19.1b"><apply id="S4.SS2.p4.19.m19.1.1.cmml" xref="S4.SS2.p4.19.m19.1.1"><csymbol cd="ambiguous" id="S4.SS2.p4.19.m19.1.1.1.cmml" xref="S4.SS2.p4.19.m19.1.1">subscript</csymbol><ci id="S4.SS2.p4.19.m19.1.1.2.cmml" xref="S4.SS2.p4.19.m19.1.1.2">𝑆</ci><ci id="S4.SS2.p4.19.m19.1.1.3.cmml" xref="S4.SS2.p4.19.m19.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p4.19.m19.1c">S_{B}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p4.19.m19.1d">italic_S start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math>. This process will repeated across several rounds within each layer.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS3.5.1.1">IV-C</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS3.6.2">Reorder-based Outlier-Retained Quantization</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In our in-depth analysis of the text encoding module, we identified significant outliers in the distribution of activations within the linear layers, as illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.F3" title="Figure 3 ‣ IV-C Reorder-based Outlier-Retained Quantization ‣ IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">3</span></a>. Notably, these outliers cannot be directly excluded due to the presence of valid linguistic encoding information in the input segments. Capturing these activations with a single scale factor <math alttext="s" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">italic_s</annotation></semantics></math> results in severe quantization errors that accumulate and decrease the quantized model accuracy. Although per-channel quantization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib52" title="">52</a>]</cite> can alleviate this issue by assigning different scale factors to each channel, it requires specialized hardware support and adds a lot of computational overhead.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="379" id="S4.F3.g1" src="extracted/5879436/picture/BERT_RORQ.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;">Reorder-based Outlier-Retained Quantization</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">In order to strike a balance between efficiency and accuracy, we propose <span class="ltx_text ltx_font_bold" id="S4.SS3.p2.1.1">Reorder-based Outlier-Retained Quantization</span> (RORQ), which enhances quantization precision by iteratively selecting outliers and calculating quantization parameters for different value groups. During the calibration phase, the RORQ determines the activation quantization parameters through the following steps:</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS3.p3.1.1">First</span>, the activations are converted to their absolute values to standardize the handling of both positive and negative values. Based on the empirical rule, we calculate the threshold <math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS3.p3.1.m1.1"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.1.m1.1d">italic_τ</annotation></semantics></math> using Eq. <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.E3" title="In IV-C Reorder-based Outlier-Retained Quantization ‣ IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">3</span></a>, which separates the outliers from the inliers:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\tau=\mu+3\sigma,\quad\mu=\frac{1}{N}\sum_{i=1}^{N}x_{i},\quad\sigma=\sqrt{%
\frac{1}{N}\sum_{i=1}^{N}(x_{i}-\mu)^{2}}~{}." class="ltx_Math" display="block" id="S4.E3.m1.2"><semantics id="S4.E3.m1.2a"><mrow id="S4.E3.m1.2.2.1"><mrow id="S4.E3.m1.2.2.1.1.2" xref="S4.E3.m1.2.2.1.1.3.cmml"><mrow id="S4.E3.m1.2.2.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.cmml"><mi id="S4.E3.m1.2.2.1.1.1.1.2" xref="S4.E3.m1.2.2.1.1.1.1.2.cmml">τ</mi><mo id="S4.E3.m1.2.2.1.1.1.1.1" xref="S4.E3.m1.2.2.1.1.1.1.1.cmml">=</mo><mrow id="S4.E3.m1.2.2.1.1.1.1.3" xref="S4.E3.m1.2.2.1.1.1.1.3.cmml"><mi id="S4.E3.m1.2.2.1.1.1.1.3.2" xref="S4.E3.m1.2.2.1.1.1.1.3.2.cmml">μ</mi><mo id="S4.E3.m1.2.2.1.1.1.1.3.1" xref="S4.E3.m1.2.2.1.1.1.1.3.1.cmml">+</mo><mrow id="S4.E3.m1.2.2.1.1.1.1.3.3" xref="S4.E3.m1.2.2.1.1.1.1.3.3.cmml"><mn id="S4.E3.m1.2.2.1.1.1.1.3.3.2" xref="S4.E3.m1.2.2.1.1.1.1.3.3.2.cmml">3</mn><mo id="S4.E3.m1.2.2.1.1.1.1.3.3.1" xref="S4.E3.m1.2.2.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.E3.m1.2.2.1.1.1.1.3.3.3" xref="S4.E3.m1.2.2.1.1.1.1.3.3.3.cmml">σ</mi></mrow></mrow></mrow><mo id="S4.E3.m1.2.2.1.1.2.3" rspace="1.167em" xref="S4.E3.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S4.E3.m1.2.2.1.1.2.2.2" xref="S4.E3.m1.2.2.1.1.2.2.3.cmml"><mrow id="S4.E3.m1.2.2.1.1.2.2.1.1" xref="S4.E3.m1.2.2.1.1.2.2.1.1.cmml"><mi id="S4.E3.m1.2.2.1.1.2.2.1.1.2" xref="S4.E3.m1.2.2.1.1.2.2.1.1.2.cmml">μ</mi><mo id="S4.E3.m1.2.2.1.1.2.2.1.1.1" xref="S4.E3.m1.2.2.1.1.2.2.1.1.1.cmml">=</mo><mrow id="S4.E3.m1.2.2.1.1.2.2.1.1.3" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.cmml"><mfrac id="S4.E3.m1.2.2.1.1.2.2.1.1.3.2" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.cmml"><mn id="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.2" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.2.cmml">1</mn><mi id="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.3" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.3.cmml">N</mi></mfrac><mo id="S4.E3.m1.2.2.1.1.2.2.1.1.3.1" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.cmml"><munderover id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.cmml"><mo id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.2" movablelimits="false" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.cmml"><mi id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.2" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.1" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.3" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.3" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.3.cmml">N</mi></munderover><msub id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.cmml"><mi id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.2" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.2.cmml">x</mi><mi id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.3" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.3.cmml">i</mi></msub></mrow></mrow></mrow><mo id="S4.E3.m1.2.2.1.1.2.2.2.3" rspace="1.167em" xref="S4.E3.m1.2.2.1.1.2.2.3a.cmml">,</mo><mrow id="S4.E3.m1.2.2.1.1.2.2.2.2" xref="S4.E3.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E3.m1.2.2.1.1.2.2.2.2.2" xref="S4.E3.m1.2.2.1.1.2.2.2.2.2.cmml">σ</mi><mo id="S4.E3.m1.2.2.1.1.2.2.2.2.1" xref="S4.E3.m1.2.2.1.1.2.2.2.2.1.cmml">=</mo><msqrt id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml"><mfrac id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.1.1.1.3.cmml"><mn id="S4.E3.m1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.3.2.cmml">1</mn><mi id="S4.E3.m1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3.m1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.cmml"><munderover id="S4.E3.m1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.2.cmml"><mo id="S4.E3.m1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E3.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E3.m1.1.1.1.1.2.2.3" xref="S4.E3.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.E3.m1.1.1.1.1.2.2.3.2" xref="S4.E3.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E3.m1.1.1.1.1.2.2.3.1" xref="S4.E3.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E3.m1.1.1.1.1.2.2.3.3" xref="S4.E3.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E3.m1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.2.3.cmml">N</mi></munderover><msup id="S4.E3.m1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.cmml"><mrow id="S4.E3.m1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E3.m1.1.1.1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E3.m1.1.1.1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E3.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml">μ</mi></mrow><mo id="S4.E3.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E3.m1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></msqrt></mrow></mrow></mrow><mo id="S4.E3.m1.2.2.1.2" lspace="0.330em">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.2.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.3a.cmml" xref="S4.E3.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E3.m1.2.2.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1"><eq id="S4.E3.m1.2.2.1.1.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.1"></eq><ci id="S4.E3.m1.2.2.1.1.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.2">𝜏</ci><apply id="S4.E3.m1.2.2.1.1.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.3"><plus id="S4.E3.m1.2.2.1.1.1.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.3.1"></plus><ci id="S4.E3.m1.2.2.1.1.1.1.3.2.cmml" xref="S4.E3.m1.2.2.1.1.1.1.3.2">𝜇</ci><apply id="S4.E3.m1.2.2.1.1.1.1.3.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.3.3"><times id="S4.E3.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S4.E3.m1.2.2.1.1.1.1.3.3.1"></times><cn id="S4.E3.m1.2.2.1.1.1.1.3.3.2.cmml" type="integer" xref="S4.E3.m1.2.2.1.1.1.1.3.3.2">3</cn><ci id="S4.E3.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S4.E3.m1.2.2.1.1.1.1.3.3.3">𝜎</ci></apply></apply></apply><apply id="S4.E3.m1.2.2.1.1.2.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.2.3a.cmml" xref="S4.E3.m1.2.2.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E3.m1.2.2.1.1.2.2.1.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1"><eq id="S4.E3.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.1"></eq><ci id="S4.E3.m1.2.2.1.1.2.2.1.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.2">𝜇</ci><apply id="S4.E3.m1.2.2.1.1.2.2.1.1.3.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3"><times id="S4.E3.m1.2.2.1.1.2.2.1.1.3.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.1"></times><apply id="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.2"><divide id="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.2"></divide><cn id="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.2.cmml" type="integer" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.2">1</cn><ci id="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.2.3">𝑁</ci></apply><apply id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3"><apply id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1">superscript</csymbol><apply id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1">subscript</csymbol><sum id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.2"></sum><apply id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3"><eq id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.1"></eq><ci id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.3.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.1.3">𝑁</ci></apply><apply id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2">subscript</csymbol><ci id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.2">𝑥</ci><ci id="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.3.cmml" xref="S4.E3.m1.2.2.1.1.2.2.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S4.E3.m1.2.2.1.1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.2.2"><eq id="S4.E3.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E3.m1.2.2.1.1.2.2.2.2.1"></eq><ci id="S4.E3.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E3.m1.2.2.1.1.2.2.2.2.2">𝜎</ci><apply id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1"><root id="S4.E3.m1.1.1a.cmml" xref="S4.E3.m1.1.1"></root><apply id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><times id="S4.E3.m1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.2"></times><apply id="S4.E3.m1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.3"><divide id="S4.E3.m1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.3"></divide><cn id="S4.E3.m1.1.1.1.3.2.cmml" type="integer" xref="S4.E3.m1.1.1.1.3.2">1</cn><ci id="S4.E3.m1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.3.3">𝑁</ci></apply><apply id="S4.E3.m1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1"><apply id="S4.E3.m1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.2">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m1.1.1.1.1.2">subscript</csymbol><sum id="S4.E3.m1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.2"></sum><apply id="S4.E3.m1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.2.3"><eq id="S4.E3.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E3.m1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E3.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E3.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.E3.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E3.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E3.m1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1"><minus id="S4.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.1.1.3">𝜇</ci></apply><cn id="S4.E3.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E3.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">\tau=\mu+3\sigma,\quad\mu=\frac{1}{N}\sum_{i=1}^{N}x_{i},\quad\sigma=\sqrt{%
\frac{1}{N}\sum_{i=1}^{N}(x_{i}-\mu)^{2}}~{}.</annotation><annotation encoding="application/x-llamapun" id="S4.E3.m1.2d">italic_τ = italic_μ + 3 italic_σ , italic_μ = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_σ = square-root start_ARG divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - italic_μ ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p3.4">where <math alttext="\mu" class="ltx_Math" display="inline" id="S4.SS3.p3.2.m1.1"><semantics id="S4.SS3.p3.2.m1.1a"><mi id="S4.SS3.p3.2.m1.1.1" xref="S4.SS3.p3.2.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m1.1b"><ci id="S4.SS3.p3.2.m1.1.1.cmml" xref="S4.SS3.p3.2.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m1.1c">\mu</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.2.m1.1d">italic_μ</annotation></semantics></math> is the mean of the data distribution, and <math alttext="\sigma" class="ltx_Math" display="inline" id="S4.SS3.p3.3.m2.1"><semantics id="S4.SS3.p3.3.m2.1a"><mi id="S4.SS3.p3.3.m2.1.1" xref="S4.SS3.p3.3.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m2.1b"><ci id="S4.SS3.p3.3.m2.1.1.cmml" xref="S4.SS3.p3.3.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m2.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.3.m2.1d">italic_σ</annotation></semantics></math> is the standard deviation, which measures the dispersion of data from the mean. Using <math alttext="3\sigma" class="ltx_Math" display="inline" id="S4.SS3.p3.4.m3.1"><semantics id="S4.SS3.p3.4.m3.1a"><mrow id="S4.SS3.p3.4.m3.1.1" xref="S4.SS3.p3.4.m3.1.1.cmml"><mn id="S4.SS3.p3.4.m3.1.1.2" xref="S4.SS3.p3.4.m3.1.1.2.cmml">3</mn><mo id="S4.SS3.p3.4.m3.1.1.1" xref="S4.SS3.p3.4.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS3.p3.4.m3.1.1.3" xref="S4.SS3.p3.4.m3.1.1.3.cmml">σ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m3.1b"><apply id="S4.SS3.p3.4.m3.1.1.cmml" xref="S4.SS3.p3.4.m3.1.1"><times id="S4.SS3.p3.4.m3.1.1.1.cmml" xref="S4.SS3.p3.4.m3.1.1.1"></times><cn id="S4.SS3.p3.4.m3.1.1.2.cmml" type="integer" xref="S4.SS3.p3.4.m3.1.1.2">3</cn><ci id="S4.SS3.p3.4.m3.1.1.3.cmml" xref="S4.SS3.p3.4.m3.1.1.3">𝜎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m3.1c">3\sigma</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p3.4.m3.1d">3 italic_σ</annotation></semantics></math> captures 99.7% of the data, making the process of identifying outliers more robust and stable. Subsequently, we obtain the Inlier Set (data within the threshold) and the Outlier Set (data exceeding the threshold). <span class="ltx_text ltx_font_bold" id="S4.SS3.p3.4.1">Second</span>, we employ the grid search technique of a uniform quantizer to determine the optimal quantization parameters for the current inlier set. <span class="ltx_text ltx_font_bold" id="S4.SS3.p3.4.2">Third</span>, we recalculate the threshold of the current outlier set, dividing the data into new inlier and outlier groups, and determining the quantization parameters for the new inlier set. This process is repeated until the outlier set becomes empty or reaches a predefined maximum number of iterations. This iterative approach allows us to derive different quantization parameters for the activations of each group, effectively capturing the distribution of anomalies.</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1">As a result, during the quantization process, the input data is dynamically grouped according to different thresholds and quantized using the corresponding quantization parameters of each group. Notably, our proposed approach, for unusually sensitive components, can flexibly adapt to the actual distribution of the input data, significantly reduce quantization errors, and thus improve quantized model performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS4.5.1.1">IV-D</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS4.6.2">PTQ4RIS Algorithm</span>
</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">Except visual and text encoder, we also quantize other layers of the four modules of RIS model, such as convolutional layers and linear layers. Since they follow a Gaussian distribution, we use fine grain uniform quantization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib45" title="">45</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib52" title="">52</a>]</cite> and search for the optimal scale factor for activations or weights layer by layer. The combined quantization of the four parts forms the PTQ4RIS framework in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#alg1" title="In IV-D PTQ4RIS Algorithm ‣ IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="alg1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="alg1.26">
<div class="ltx_listingline" id="alg1.26.27">
<span class="ltx_text" id="alg1.26.27.1" style="font-size:80%;">
<span class="ltx_text" id="alg1.26.27.1.1"><span class="ltx_text ltx_font_bold" id="alg1.26.27.1.1.1">Input:</span> </span>Full-precision RIS model, calibration data</span>
</div>
<div class="ltx_listingline" id="alg1.26.28">
<span class="ltx_text" id="alg1.26.28.1" style="font-size:80%;">
</span><span class="ltx_text" id="alg1.26.28.2" style="font-size:80%;"><span class="ltx_text ltx_font_bold" id="alg1.26.28.2.1">Output:</span> </span><span class="ltx_text" id="alg1.26.28.3" style="font-size:80%;">Quantized RIS model with integer fixed-point</span>
</div>
<div class="ltx_listingline" id="alg1.26.29">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.29.1.1.1" style="font-size:80%;">1</span></span><span class="ltx_text" id="alg1.26.29.2" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.2.2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.2.2.3.1.1" style="font-size:80%;">2</span></span><span class="ltx_text ltx_font_bold" id="alg1.2.2.2" style="font-size:80%;">Step 1: Output <math alttext="\mathbf{O}_{l}" class="ltx_Math" display="inline" id="alg1.1.1.1.m1.1"><semantics id="alg1.1.1.1.m1.1a"><msub id="alg1.1.1.1.m1.1.1" xref="alg1.1.1.1.m1.1.1.cmml"><mi id="alg1.1.1.1.m1.1.1.2" xref="alg1.1.1.1.m1.1.1.2.cmml">𝐎</mi><mi id="alg1.1.1.1.m1.1.1.3" xref="alg1.1.1.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.m1.1b"><apply id="alg1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.1.1.1.m1.1.1.1.cmml" xref="alg1.1.1.1.m1.1.1">subscript</csymbol><ci id="alg1.1.1.1.m1.1.1.2.cmml" xref="alg1.1.1.1.m1.1.1.2">𝐎</ci><ci id="alg1.1.1.1.m1.1.1.3.cmml" xref="alg1.1.1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.m1.1c">\mathbf{O}_{l}</annotation><annotation encoding="application/x-llamapun" id="alg1.1.1.1.m1.1d">bold_O start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> &amp; Gradient <math alttext="\frac{\partial\mathcal{L}}{\partial\mathbf{O}_{l}}" class="ltx_Math" display="inline" id="alg1.2.2.2.m2.1"><semantics id="alg1.2.2.2.m2.1a"><mfrac id="alg1.2.2.2.m2.1.1" xref="alg1.2.2.2.m2.1.1.cmml"><mrow id="alg1.2.2.2.m2.1.1.2" xref="alg1.2.2.2.m2.1.1.2.cmml"><mo id="alg1.2.2.2.m2.1.1.2.1" rspace="0em" xref="alg1.2.2.2.m2.1.1.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="alg1.2.2.2.m2.1.1.2.2" xref="alg1.2.2.2.m2.1.1.2.2.cmml">ℒ</mi></mrow><mrow id="alg1.2.2.2.m2.1.1.3" xref="alg1.2.2.2.m2.1.1.3.cmml"><mo id="alg1.2.2.2.m2.1.1.3.1" rspace="0em" xref="alg1.2.2.2.m2.1.1.3.1.cmml">∂</mo><msub id="alg1.2.2.2.m2.1.1.3.2" xref="alg1.2.2.2.m2.1.1.3.2.cmml"><mi id="alg1.2.2.2.m2.1.1.3.2.2" xref="alg1.2.2.2.m2.1.1.3.2.2.cmml">𝐎</mi><mi id="alg1.2.2.2.m2.1.1.3.2.3" xref="alg1.2.2.2.m2.1.1.3.2.3.cmml">l</mi></msub></mrow></mfrac><annotation-xml encoding="MathML-Content" id="alg1.2.2.2.m2.1b"><apply id="alg1.2.2.2.m2.1.1.cmml" xref="alg1.2.2.2.m2.1.1"><divide id="alg1.2.2.2.m2.1.1.1.cmml" xref="alg1.2.2.2.m2.1.1"></divide><apply id="alg1.2.2.2.m2.1.1.2.cmml" xref="alg1.2.2.2.m2.1.1.2"><partialdiff id="alg1.2.2.2.m2.1.1.2.1.cmml" xref="alg1.2.2.2.m2.1.1.2.1"></partialdiff><ci id="alg1.2.2.2.m2.1.1.2.2.cmml" xref="alg1.2.2.2.m2.1.1.2.2">ℒ</ci></apply><apply id="alg1.2.2.2.m2.1.1.3.cmml" xref="alg1.2.2.2.m2.1.1.3"><partialdiff id="alg1.2.2.2.m2.1.1.3.1.cmml" xref="alg1.2.2.2.m2.1.1.3.1"></partialdiff><apply id="alg1.2.2.2.m2.1.1.3.2.cmml" xref="alg1.2.2.2.m2.1.1.3.2"><csymbol cd="ambiguous" id="alg1.2.2.2.m2.1.1.3.2.1.cmml" xref="alg1.2.2.2.m2.1.1.3.2">subscript</csymbol><ci id="alg1.2.2.2.m2.1.1.3.2.2.cmml" xref="alg1.2.2.2.m2.1.1.3.2.2">𝐎</ci><ci id="alg1.2.2.2.m2.1.1.3.2.3.cmml" xref="alg1.2.2.2.m2.1.1.3.2.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.2.m2.1c">\frac{\partial\mathcal{L}}{\partial\mathbf{O}_{l}}</annotation><annotation encoding="application/x-llamapun" id="alg1.2.2.2.m2.1d">divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_O start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> Collection</span>
</div>
<div class="ltx_listingline" id="alg1.3.3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.3.3.2.1.1" style="font-size:80%;">3</span></span><span class="ltx_text" id="alg1.3.3.3" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.3.3.4" style="font-size:80%;">for</span><span class="ltx_text" id="alg1.3.3.5" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.3.3.1" style="font-size:80%;">Each layer <math alttext="l_{i}" class="ltx_Math" display="inline" id="alg1.3.3.1.m1.1"><semantics id="alg1.3.3.1.m1.1a"><msub id="alg1.3.3.1.m1.1.1" xref="alg1.3.3.1.m1.1.1.cmml"><mi id="alg1.3.3.1.m1.1.1.2" xref="alg1.3.3.1.m1.1.1.2.cmml">l</mi><mi id="alg1.3.3.1.m1.1.1.3" xref="alg1.3.3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.3.3.1.m1.1b"><apply id="alg1.3.3.1.m1.1.1.cmml" xref="alg1.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.3.3.1.m1.1.1.1.cmml" xref="alg1.3.3.1.m1.1.1">subscript</csymbol><ci id="alg1.3.3.1.m1.1.1.2.cmml" xref="alg1.3.3.1.m1.1.1.2">𝑙</ci><ci id="alg1.3.3.1.m1.1.1.3.cmml" xref="alg1.3.3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.3.1.m1.1c">l_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.3.3.1.m1.1d">italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> </em><span class="ltx_text" id="alg1.3.3.6" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.3.3.7" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.4.4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.4.4.2.1.1" style="font-size:80%;">4</span></span><span class="ltx_text" id="alg1.4.4.3" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.4.4.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.4.4.5" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.4.4.6" style="font-size:80%;">if</span><span class="ltx_text" id="alg1.4.4.7" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.4.4.1" style="font-size:80%;"><math alttext="l_{i}" class="ltx_Math" display="inline" id="alg1.4.4.1.m1.1"><semantics id="alg1.4.4.1.m1.1a"><msub id="alg1.4.4.1.m1.1.1" xref="alg1.4.4.1.m1.1.1.cmml"><mi id="alg1.4.4.1.m1.1.1.2" xref="alg1.4.4.1.m1.1.1.2.cmml">l</mi><mi id="alg1.4.4.1.m1.1.1.3" xref="alg1.4.4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.4.4.1.m1.1b"><apply id="alg1.4.4.1.m1.1.1.cmml" xref="alg1.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.4.4.1.m1.1.1.1.cmml" xref="alg1.4.4.1.m1.1.1">subscript</csymbol><ci id="alg1.4.4.1.m1.1.1.2.cmml" xref="alg1.4.4.1.m1.1.1.2">𝑙</ci><ci id="alg1.4.4.1.m1.1.1.3.cmml" xref="alg1.4.4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.4.1.m1.1c">l_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.4.4.1.m1.1d">italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in Visual Encoder</em><span class="ltx_text" id="alg1.4.4.8" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.4.4.9" style="font-size:80%;">then</span>
</div>
<div class="ltx_listingline" id="alg1.5.5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.5.5.1.1.1" style="font-size:80%;">5</span></span><span class="ltx_text" id="alg1.5.5.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.5.5.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.5.5.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.5.5.5" style="font-size:80%;">
Forward: compute </span><math alttext="\mathbf{O}_{l}" class="ltx_Math" display="inline" id="alg1.5.5.m1.1"><semantics id="alg1.5.5.m1.1a"><msub id="alg1.5.5.m1.1.1" xref="alg1.5.5.m1.1.1.cmml"><mi id="alg1.5.5.m1.1.1.2" mathsize="80%" xref="alg1.5.5.m1.1.1.2.cmml">𝐎</mi><mi id="alg1.5.5.m1.1.1.3" mathsize="80%" xref="alg1.5.5.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.5.5.m1.1b"><apply id="alg1.5.5.m1.1.1.cmml" xref="alg1.5.5.m1.1.1"><csymbol cd="ambiguous" id="alg1.5.5.m1.1.1.1.cmml" xref="alg1.5.5.m1.1.1">subscript</csymbol><ci id="alg1.5.5.m1.1.1.2.cmml" xref="alg1.5.5.m1.1.1.2">𝐎</ci><ci id="alg1.5.5.m1.1.1.3.cmml" xref="alg1.5.5.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.5.m1.1c">\mathbf{O}_{l}</annotation><annotation encoding="application/x-llamapun" id="alg1.5.5.m1.1d">bold_O start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.5.5.6" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.6.6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.6.6.1.1.1" style="font-size:80%;">6</span></span><span class="ltx_text" id="alg1.6.6.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.6.6.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.6.6.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.6.6.5" style="font-size:80%;">
Backward: compute </span><math alttext="\frac{\partial\mathcal{L}}{\partial\mathbf{O}_{l}}" class="ltx_Math" display="inline" id="alg1.6.6.m1.1"><semantics id="alg1.6.6.m1.1a"><mfrac id="alg1.6.6.m1.1.1" xref="alg1.6.6.m1.1.1.cmml"><mrow id="alg1.6.6.m1.1.1.2" xref="alg1.6.6.m1.1.1.2.cmml"><mo id="alg1.6.6.m1.1.1.2.1" mathsize="80%" rspace="0em" xref="alg1.6.6.m1.1.1.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="alg1.6.6.m1.1.1.2.2" mathsize="80%" xref="alg1.6.6.m1.1.1.2.2.cmml">ℒ</mi></mrow><mrow id="alg1.6.6.m1.1.1.3" xref="alg1.6.6.m1.1.1.3.cmml"><mo id="alg1.6.6.m1.1.1.3.1" mathsize="80%" rspace="0em" xref="alg1.6.6.m1.1.1.3.1.cmml">∂</mo><msub id="alg1.6.6.m1.1.1.3.2" xref="alg1.6.6.m1.1.1.3.2.cmml"><mi id="alg1.6.6.m1.1.1.3.2.2" mathsize="80%" xref="alg1.6.6.m1.1.1.3.2.2.cmml">𝐎</mi><mi id="alg1.6.6.m1.1.1.3.2.3" mathsize="80%" xref="alg1.6.6.m1.1.1.3.2.3.cmml">l</mi></msub></mrow></mfrac><annotation-xml encoding="MathML-Content" id="alg1.6.6.m1.1b"><apply id="alg1.6.6.m1.1.1.cmml" xref="alg1.6.6.m1.1.1"><divide id="alg1.6.6.m1.1.1.1.cmml" xref="alg1.6.6.m1.1.1"></divide><apply id="alg1.6.6.m1.1.1.2.cmml" xref="alg1.6.6.m1.1.1.2"><partialdiff id="alg1.6.6.m1.1.1.2.1.cmml" xref="alg1.6.6.m1.1.1.2.1"></partialdiff><ci id="alg1.6.6.m1.1.1.2.2.cmml" xref="alg1.6.6.m1.1.1.2.2">ℒ</ci></apply><apply id="alg1.6.6.m1.1.1.3.cmml" xref="alg1.6.6.m1.1.1.3"><partialdiff id="alg1.6.6.m1.1.1.3.1.cmml" xref="alg1.6.6.m1.1.1.3.1"></partialdiff><apply id="alg1.6.6.m1.1.1.3.2.cmml" xref="alg1.6.6.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.6.6.m1.1.1.3.2.1.cmml" xref="alg1.6.6.m1.1.1.3.2">subscript</csymbol><ci id="alg1.6.6.m1.1.1.3.2.2.cmml" xref="alg1.6.6.m1.1.1.3.2.2">𝐎</ci><ci id="alg1.6.6.m1.1.1.3.2.3.cmml" xref="alg1.6.6.m1.1.1.3.2.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.6.m1.1c">\frac{\partial\mathcal{L}}{\partial\mathbf{O}_{l}}</annotation><annotation encoding="application/x-llamapun" id="alg1.6.6.m1.1d">divide start_ARG ∂ caligraphic_L end_ARG start_ARG ∂ bold_O start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_ARG</annotation></semantics></math><span class="ltx_text" id="alg1.6.6.6" style="font-size:80%;"> for Hessian-guided metric;</span>
</div>
<div class="ltx_listingline" id="alg1.26.30">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.30.1.1.1" style="font-size:80%;">7</span></span><span class="ltx_text" id="alg1.26.30.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.30.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.30.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.26.30.5" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.26.31">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.31.1.1.1" style="font-size:80%;">8</span></span><span class="ltx_text" id="alg1.26.31.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.31.3" style="font-size:80%;">   </span>
</div>
<div class="ltx_listingline" id="alg1.26.32">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.32.1.1.1" style="font-size:80%;">9</span></span>
</div>
<div class="ltx_listingline" id="alg1.7.7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.7.7.2.1.1" style="font-size:80%;">10</span></span><span class="ltx_text ltx_font_bold" id="alg1.7.7.1" style="font-size:80%;">Step 2: Search Quantization Parameters <math alttext="(s,z)" class="ltx_Math" display="inline" id="alg1.7.7.1.m1.2"><semantics id="alg1.7.7.1.m1.2a"><mrow id="alg1.7.7.1.m1.2.3.2" xref="alg1.7.7.1.m1.2.3.1.cmml"><mo id="alg1.7.7.1.m1.2.3.2.1" stretchy="false" xref="alg1.7.7.1.m1.2.3.1.cmml">(</mo><mi id="alg1.7.7.1.m1.1.1" xref="alg1.7.7.1.m1.1.1.cmml">s</mi><mo id="alg1.7.7.1.m1.2.3.2.2" xref="alg1.7.7.1.m1.2.3.1.cmml">,</mo><mi id="alg1.7.7.1.m1.2.2" xref="alg1.7.7.1.m1.2.2.cmml">z</mi><mo id="alg1.7.7.1.m1.2.3.2.3" stretchy="false" xref="alg1.7.7.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.7.7.1.m1.2b"><interval closure="open" id="alg1.7.7.1.m1.2.3.1.cmml" xref="alg1.7.7.1.m1.2.3.2"><ci id="alg1.7.7.1.m1.1.1.cmml" xref="alg1.7.7.1.m1.1.1">𝑠</ci><ci id="alg1.7.7.1.m1.2.2.cmml" xref="alg1.7.7.1.m1.2.2">𝑧</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.7.1.m1.2c">(s,z)</annotation><annotation encoding="application/x-llamapun" id="alg1.7.7.1.m1.2d">( italic_s , italic_z )</annotation></semantics></math> </span>
</div>
<div class="ltx_listingline" id="alg1.26.33">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.33.1.1.1" style="font-size:80%;">11</span></span><span class="ltx_text" id="alg1.26.33.2" style="font-size:80%;">
Initialize quantized model with calibration data;</span>
</div>
<div class="ltx_listingline" id="alg1.8.8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.8.8.2.1.1" style="font-size:80%;">12</span></span><span class="ltx_text" id="alg1.8.8.3" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.8.8.4" style="font-size:80%;">for</span><span class="ltx_text" id="alg1.8.8.5" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.8.8.1" style="font-size:80%;"><math alttext="l_{i}" class="ltx_Math" display="inline" id="alg1.8.8.1.m1.1"><semantics id="alg1.8.8.1.m1.1a"><msub id="alg1.8.8.1.m1.1.1" xref="alg1.8.8.1.m1.1.1.cmml"><mi id="alg1.8.8.1.m1.1.1.2" xref="alg1.8.8.1.m1.1.1.2.cmml">l</mi><mi id="alg1.8.8.1.m1.1.1.3" xref="alg1.8.8.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.8.8.1.m1.1b"><apply id="alg1.8.8.1.m1.1.1.cmml" xref="alg1.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.8.8.1.m1.1.1.1.cmml" xref="alg1.8.8.1.m1.1.1">subscript</csymbol><ci id="alg1.8.8.1.m1.1.1.2.cmml" xref="alg1.8.8.1.m1.1.1.2">𝑙</ci><ci id="alg1.8.8.1.m1.1.1.3.cmml" xref="alg1.8.8.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.8.1.m1.1c">l_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.8.8.1.m1.1d">italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in Visual Encoder</em><span class="ltx_text" id="alg1.8.8.6" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.8.8.7" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.26.34">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.34.1.1.1" style="font-size:80%;">13</span></span><span class="ltx_text" id="alg1.26.34.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.34.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.26.34.4" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.26.34.5" style="font-size:80%;">if</span><span class="ltx_text" id="alg1.26.34.6" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.26.34.7" style="font-size:80%;">Layer after Softmax or GeLU</em><span class="ltx_text" id="alg1.26.34.8" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.26.34.9" style="font-size:80%;">then</span>
</div>
<div class="ltx_listingline" id="alg1.10.10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.10.10.1.1.1" style="font-size:80%;">14</span></span><span class="ltx_text" id="alg1.10.10.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.10.10.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.10.10.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.10.10.5" style="font-size:80%;">
Define regions </span><math alttext="R_{1}" class="ltx_Math" display="inline" id="alg1.9.9.m1.1"><semantics id="alg1.9.9.m1.1a"><msub id="alg1.9.9.m1.1.1" xref="alg1.9.9.m1.1.1.cmml"><mi id="alg1.9.9.m1.1.1.2" mathsize="80%" xref="alg1.9.9.m1.1.1.2.cmml">R</mi><mn id="alg1.9.9.m1.1.1.3" mathsize="80%" xref="alg1.9.9.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.9.9.m1.1b"><apply id="alg1.9.9.m1.1.1.cmml" xref="alg1.9.9.m1.1.1"><csymbol cd="ambiguous" id="alg1.9.9.m1.1.1.1.cmml" xref="alg1.9.9.m1.1.1">subscript</csymbol><ci id="alg1.9.9.m1.1.1.2.cmml" xref="alg1.9.9.m1.1.1.2">𝑅</ci><cn id="alg1.9.9.m1.1.1.3.cmml" type="integer" xref="alg1.9.9.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.9.m1.1c">R_{1}</annotation><annotation encoding="application/x-llamapun" id="alg1.9.9.m1.1d">italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.10.10.6" style="font-size:80%;"> and </span><math alttext="R_{2}" class="ltx_Math" display="inline" id="alg1.10.10.m2.1"><semantics id="alg1.10.10.m2.1a"><msub id="alg1.10.10.m2.1.1" xref="alg1.10.10.m2.1.1.cmml"><mi id="alg1.10.10.m2.1.1.2" mathsize="80%" xref="alg1.10.10.m2.1.1.2.cmml">R</mi><mn id="alg1.10.10.m2.1.1.3" mathsize="80%" xref="alg1.10.10.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.10.10.m2.1b"><apply id="alg1.10.10.m2.1.1.cmml" xref="alg1.10.10.m2.1.1"><csymbol cd="ambiguous" id="alg1.10.10.m2.1.1.1.cmml" xref="alg1.10.10.m2.1.1">subscript</csymbol><ci id="alg1.10.10.m2.1.1.2.cmml" xref="alg1.10.10.m2.1.1.2">𝑅</ci><cn id="alg1.10.10.m2.1.1.3.cmml" type="integer" xref="alg1.10.10.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.10.m2.1c">R_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.10.10.m2.1d">italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.10.10.7" style="font-size:80%;"> for activations;</span>
</div>
<div class="ltx_listingline" id="alg1.11.11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.11.11.1.1.1" style="font-size:80%;">15</span></span><span class="ltx_text" id="alg1.11.11.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.11.11.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.11.11.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.11.11.5" style="font-size:80%;">
Search </span><math alttext="(S_{R_{1}^{s}},S_{R_{2}^{g}})" class="ltx_Math" display="inline" id="alg1.11.11.m1.2"><semantics id="alg1.11.11.m1.2a"><mrow id="alg1.11.11.m1.2.2.2" xref="alg1.11.11.m1.2.2.3.cmml"><mo id="alg1.11.11.m1.2.2.2.3" maxsize="80%" minsize="80%" xref="alg1.11.11.m1.2.2.3.cmml">(</mo><msub id="alg1.11.11.m1.1.1.1.1" xref="alg1.11.11.m1.1.1.1.1.cmml"><mi id="alg1.11.11.m1.1.1.1.1.2" mathsize="80%" xref="alg1.11.11.m1.1.1.1.1.2.cmml">S</mi><msubsup id="alg1.11.11.m1.1.1.1.1.3" xref="alg1.11.11.m1.1.1.1.1.3.cmml"><mi id="alg1.11.11.m1.1.1.1.1.3.2.2" mathsize="80%" xref="alg1.11.11.m1.1.1.1.1.3.2.2.cmml">R</mi><mn id="alg1.11.11.m1.1.1.1.1.3.2.3" mathsize="80%" xref="alg1.11.11.m1.1.1.1.1.3.2.3.cmml">1</mn><mi id="alg1.11.11.m1.1.1.1.1.3.3" mathsize="80%" xref="alg1.11.11.m1.1.1.1.1.3.3.cmml">s</mi></msubsup></msub><mo id="alg1.11.11.m1.2.2.2.4" mathsize="80%" xref="alg1.11.11.m1.2.2.3.cmml">,</mo><msub id="alg1.11.11.m1.2.2.2.2" xref="alg1.11.11.m1.2.2.2.2.cmml"><mi id="alg1.11.11.m1.2.2.2.2.2" mathsize="80%" xref="alg1.11.11.m1.2.2.2.2.2.cmml">S</mi><msubsup id="alg1.11.11.m1.2.2.2.2.3" xref="alg1.11.11.m1.2.2.2.2.3.cmml"><mi id="alg1.11.11.m1.2.2.2.2.3.2.2" mathsize="80%" xref="alg1.11.11.m1.2.2.2.2.3.2.2.cmml">R</mi><mn id="alg1.11.11.m1.2.2.2.2.3.2.3" mathsize="80%" xref="alg1.11.11.m1.2.2.2.2.3.2.3.cmml">2</mn><mi id="alg1.11.11.m1.2.2.2.2.3.3" mathsize="80%" xref="alg1.11.11.m1.2.2.2.2.3.3.cmml">g</mi></msubsup></msub><mo id="alg1.11.11.m1.2.2.2.5" maxsize="80%" minsize="80%" xref="alg1.11.11.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.11.11.m1.2b"><interval closure="open" id="alg1.11.11.m1.2.2.3.cmml" xref="alg1.11.11.m1.2.2.2"><apply id="alg1.11.11.m1.1.1.1.1.cmml" xref="alg1.11.11.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.11.11.m1.1.1.1.1.1.cmml" xref="alg1.11.11.m1.1.1.1.1">subscript</csymbol><ci id="alg1.11.11.m1.1.1.1.1.2.cmml" xref="alg1.11.11.m1.1.1.1.1.2">𝑆</ci><apply id="alg1.11.11.m1.1.1.1.1.3.cmml" xref="alg1.11.11.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.11.11.m1.1.1.1.1.3.1.cmml" xref="alg1.11.11.m1.1.1.1.1.3">superscript</csymbol><apply id="alg1.11.11.m1.1.1.1.1.3.2.cmml" xref="alg1.11.11.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.11.11.m1.1.1.1.1.3.2.1.cmml" xref="alg1.11.11.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.11.11.m1.1.1.1.1.3.2.2.cmml" xref="alg1.11.11.m1.1.1.1.1.3.2.2">𝑅</ci><cn id="alg1.11.11.m1.1.1.1.1.3.2.3.cmml" type="integer" xref="alg1.11.11.m1.1.1.1.1.3.2.3">1</cn></apply><ci id="alg1.11.11.m1.1.1.1.1.3.3.cmml" xref="alg1.11.11.m1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="alg1.11.11.m1.2.2.2.2.cmml" xref="alg1.11.11.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.11.11.m1.2.2.2.2.1.cmml" xref="alg1.11.11.m1.2.2.2.2">subscript</csymbol><ci id="alg1.11.11.m1.2.2.2.2.2.cmml" xref="alg1.11.11.m1.2.2.2.2.2">𝑆</ci><apply id="alg1.11.11.m1.2.2.2.2.3.cmml" xref="alg1.11.11.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.11.11.m1.2.2.2.2.3.1.cmml" xref="alg1.11.11.m1.2.2.2.2.3">superscript</csymbol><apply id="alg1.11.11.m1.2.2.2.2.3.2.cmml" xref="alg1.11.11.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.11.11.m1.2.2.2.2.3.2.1.cmml" xref="alg1.11.11.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.11.11.m1.2.2.2.2.3.2.2.cmml" xref="alg1.11.11.m1.2.2.2.2.3.2.2">𝑅</ci><cn id="alg1.11.11.m1.2.2.2.2.3.2.3.cmml" type="integer" xref="alg1.11.11.m1.2.2.2.2.3.2.3">2</cn></apply><ci id="alg1.11.11.m1.2.2.2.2.3.3.cmml" xref="alg1.11.11.m1.2.2.2.2.3.3">𝑔</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.11.m1.2c">(S_{R_{1}^{s}},S_{R_{2}^{g}})</annotation><annotation encoding="application/x-llamapun" id="alg1.11.11.m1.2d">( italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_s end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , italic_S start_POSTSUBSCRIPT italic_R start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_g end_POSTSUPERSCRIPT end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.11.11.6" style="font-size:80%;"> using Hessian-guided metric;</span>
</div>
<div class="ltx_listingline" id="alg1.26.35">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.35.1.1.1" style="font-size:80%;">16</span></span><span class="ltx_text" id="alg1.26.35.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.35.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.35.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.26.35.5" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.26.36">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.36.1.1.1" style="font-size:80%;">17</span></span><span class="ltx_text" id="alg1.26.36.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.36.3" style="font-size:80%;">   </span><span class="ltx_text ltx_font_bold" id="alg1.26.36.4" style="font-size:80%;">else if</span><span class="ltx_text" id="alg1.26.36.5" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.26.36.6" style="font-size:80%;">Matmul</em><span class="ltx_text" id="alg1.26.36.7" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.26.36.8" style="font-size:80%;">then</span>
</div>
<div class="ltx_listingline" id="alg1.13.13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.13.13.1.1.1" style="font-size:80%;">18</span></span><span class="ltx_text" id="alg1.13.13.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.13.13.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.13.13.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.13.13.5" style="font-size:80%;">
Initialize search space for scale factors </span><math alttext="S_{A}" class="ltx_Math" display="inline" id="alg1.12.12.m1.1"><semantics id="alg1.12.12.m1.1a"><msub id="alg1.12.12.m1.1.1" xref="alg1.12.12.m1.1.1.cmml"><mi id="alg1.12.12.m1.1.1.2" mathsize="80%" xref="alg1.12.12.m1.1.1.2.cmml">S</mi><mi id="alg1.12.12.m1.1.1.3" mathsize="80%" xref="alg1.12.12.m1.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.12.12.m1.1b"><apply id="alg1.12.12.m1.1.1.cmml" xref="alg1.12.12.m1.1.1"><csymbol cd="ambiguous" id="alg1.12.12.m1.1.1.1.cmml" xref="alg1.12.12.m1.1.1">subscript</csymbol><ci id="alg1.12.12.m1.1.1.2.cmml" xref="alg1.12.12.m1.1.1.2">𝑆</ci><ci id="alg1.12.12.m1.1.1.3.cmml" xref="alg1.12.12.m1.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.12.m1.1c">S_{A}</annotation><annotation encoding="application/x-llamapun" id="alg1.12.12.m1.1d">italic_S start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.13.13.6" style="font-size:80%;"> and </span><math alttext="S_{B}" class="ltx_Math" display="inline" id="alg1.13.13.m2.1"><semantics id="alg1.13.13.m2.1a"><msub id="alg1.13.13.m2.1.1" xref="alg1.13.13.m2.1.1.cmml"><mi id="alg1.13.13.m2.1.1.2" mathsize="80%" xref="alg1.13.13.m2.1.1.2.cmml">S</mi><mi id="alg1.13.13.m2.1.1.3" mathsize="80%" xref="alg1.13.13.m2.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.13.13.m2.1b"><apply id="alg1.13.13.m2.1.1.cmml" xref="alg1.13.13.m2.1.1"><csymbol cd="ambiguous" id="alg1.13.13.m2.1.1.1.cmml" xref="alg1.13.13.m2.1.1">subscript</csymbol><ci id="alg1.13.13.m2.1.1.2.cmml" xref="alg1.13.13.m2.1.1.2">𝑆</ci><ci id="alg1.13.13.m2.1.1.3.cmml" xref="alg1.13.13.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.13.m2.1c">S_{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.13.13.m2.1d">italic_S start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.13.13.7" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.14.14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.14.14.2.1.1" style="font-size:80%;">19</span></span><span class="ltx_text" id="alg1.14.14.3" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.14.14.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.14.14.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.14.14.6" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.14.14.7" style="font-size:80%;">for</span><span class="ltx_text" id="alg1.14.14.8" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.14.14.1" style="font-size:80%;"><math alttext="r=1" class="ltx_Math" display="inline" id="alg1.14.14.1.m1.1"><semantics id="alg1.14.14.1.m1.1a"><mrow id="alg1.14.14.1.m1.1.1" xref="alg1.14.14.1.m1.1.1.cmml"><mi id="alg1.14.14.1.m1.1.1.2" xref="alg1.14.14.1.m1.1.1.2.cmml">r</mi><mo id="alg1.14.14.1.m1.1.1.1" xref="alg1.14.14.1.m1.1.1.1.cmml">=</mo><mn id="alg1.14.14.1.m1.1.1.3" xref="alg1.14.14.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.14.14.1.m1.1b"><apply id="alg1.14.14.1.m1.1.1.cmml" xref="alg1.14.14.1.m1.1.1"><eq id="alg1.14.14.1.m1.1.1.1.cmml" xref="alg1.14.14.1.m1.1.1.1"></eq><ci id="alg1.14.14.1.m1.1.1.2.cmml" xref="alg1.14.14.1.m1.1.1.2">𝑟</ci><cn id="alg1.14.14.1.m1.1.1.3.cmml" type="integer" xref="alg1.14.14.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.14.1.m1.1c">r=1</annotation><annotation encoding="application/x-llamapun" id="alg1.14.14.1.m1.1d">italic_r = 1</annotation></semantics></math> to #Rounds</em><span class="ltx_text" id="alg1.14.14.9" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.14.14.10" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.16.16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.16.16.1.1.1" style="font-size:80%;">20</span></span><span class="ltx_text" id="alg1.16.16.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.16.16.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.16.16.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.16.16.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.16.16.6" style="font-size:80%;">
Fix </span><math alttext="S_{B}" class="ltx_Math" display="inline" id="alg1.15.15.m1.1"><semantics id="alg1.15.15.m1.1a"><msub id="alg1.15.15.m1.1.1" xref="alg1.15.15.m1.1.1.cmml"><mi id="alg1.15.15.m1.1.1.2" mathsize="80%" xref="alg1.15.15.m1.1.1.2.cmml">S</mi><mi id="alg1.15.15.m1.1.1.3" mathsize="80%" xref="alg1.15.15.m1.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.15.15.m1.1b"><apply id="alg1.15.15.m1.1.1.cmml" xref="alg1.15.15.m1.1.1"><csymbol cd="ambiguous" id="alg1.15.15.m1.1.1.1.cmml" xref="alg1.15.15.m1.1.1">subscript</csymbol><ci id="alg1.15.15.m1.1.1.2.cmml" xref="alg1.15.15.m1.1.1.2">𝑆</ci><ci id="alg1.15.15.m1.1.1.3.cmml" xref="alg1.15.15.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.15.m1.1c">S_{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.15.15.m1.1d">italic_S start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.16.16.7" style="font-size:80%;">, search for optimal </span><math alttext="S_{A}" class="ltx_Math" display="inline" id="alg1.16.16.m2.1"><semantics id="alg1.16.16.m2.1a"><msub id="alg1.16.16.m2.1.1" xref="alg1.16.16.m2.1.1.cmml"><mi id="alg1.16.16.m2.1.1.2" mathsize="80%" xref="alg1.16.16.m2.1.1.2.cmml">S</mi><mi id="alg1.16.16.m2.1.1.3" mathsize="80%" xref="alg1.16.16.m2.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.16.16.m2.1b"><apply id="alg1.16.16.m2.1.1.cmml" xref="alg1.16.16.m2.1.1"><csymbol cd="ambiguous" id="alg1.16.16.m2.1.1.1.cmml" xref="alg1.16.16.m2.1.1">subscript</csymbol><ci id="alg1.16.16.m2.1.1.2.cmml" xref="alg1.16.16.m2.1.1.2">𝑆</ci><ci id="alg1.16.16.m2.1.1.3.cmml" xref="alg1.16.16.m2.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.16.m2.1c">S_{A}</annotation><annotation encoding="application/x-llamapun" id="alg1.16.16.m2.1d">italic_S start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.16.16.8" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.18.18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.18.18.1.1.1" style="font-size:80%;">21</span></span><span class="ltx_text" id="alg1.18.18.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.18.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.18.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.18.18.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.18.18.6" style="font-size:80%;">
Fix </span><math alttext="S_{A}" class="ltx_Math" display="inline" id="alg1.17.17.m1.1"><semantics id="alg1.17.17.m1.1a"><msub id="alg1.17.17.m1.1.1" xref="alg1.17.17.m1.1.1.cmml"><mi id="alg1.17.17.m1.1.1.2" mathsize="80%" xref="alg1.17.17.m1.1.1.2.cmml">S</mi><mi id="alg1.17.17.m1.1.1.3" mathsize="80%" xref="alg1.17.17.m1.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.17.17.m1.1b"><apply id="alg1.17.17.m1.1.1.cmml" xref="alg1.17.17.m1.1.1"><csymbol cd="ambiguous" id="alg1.17.17.m1.1.1.1.cmml" xref="alg1.17.17.m1.1.1">subscript</csymbol><ci id="alg1.17.17.m1.1.1.2.cmml" xref="alg1.17.17.m1.1.1.2">𝑆</ci><ci id="alg1.17.17.m1.1.1.3.cmml" xref="alg1.17.17.m1.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.17.m1.1c">S_{A}</annotation><annotation encoding="application/x-llamapun" id="alg1.17.17.m1.1d">italic_S start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.18.18.7" style="font-size:80%;">, search for optimal </span><math alttext="S_{B}" class="ltx_Math" display="inline" id="alg1.18.18.m2.1"><semantics id="alg1.18.18.m2.1a"><msub id="alg1.18.18.m2.1.1" xref="alg1.18.18.m2.1.1.cmml"><mi id="alg1.18.18.m2.1.1.2" mathsize="80%" xref="alg1.18.18.m2.1.1.2.cmml">S</mi><mi id="alg1.18.18.m2.1.1.3" mathsize="80%" xref="alg1.18.18.m2.1.1.3.cmml">B</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.18.18.m2.1b"><apply id="alg1.18.18.m2.1.1.cmml" xref="alg1.18.18.m2.1.1"><csymbol cd="ambiguous" id="alg1.18.18.m2.1.1.1.cmml" xref="alg1.18.18.m2.1.1">subscript</csymbol><ci id="alg1.18.18.m2.1.1.2.cmml" xref="alg1.18.18.m2.1.1.2">𝑆</ci><ci id="alg1.18.18.m2.1.1.3.cmml" xref="alg1.18.18.m2.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.18.m2.1c">S_{B}</annotation><annotation encoding="application/x-llamapun" id="alg1.18.18.m2.1d">italic_S start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text" id="alg1.18.18.8" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.26.37">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.37.1.1.1" style="font-size:80%;">22</span></span><span class="ltx_text" id="alg1.26.37.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.37.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.37.4" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.37.5" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.26.37.6" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.26.38">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.38.1.1.1" style="font-size:80%;">23</span></span><span class="ltx_text" id="alg1.26.38.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.38.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.38.4" style="font-size:80%;">   </span>
</div>
<div class="ltx_listingline" id="alg1.26.39">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.39.1.1.1" style="font-size:80%;">24</span></span><span class="ltx_text" id="alg1.26.39.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.39.3" style="font-size:80%;">   </span>
</div>
<div class="ltx_listingline" id="alg1.19.19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.19.19.2.1.1" style="font-size:80%;">25</span></span><span class="ltx_text ltx_font_bold" id="alg1.19.19.3" style="font-size:80%;">for</span><span class="ltx_text" id="alg1.19.19.4" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.19.19.1" style="font-size:80%;"><math alttext="l_{i}" class="ltx_Math" display="inline" id="alg1.19.19.1.m1.1"><semantics id="alg1.19.19.1.m1.1a"><msub id="alg1.19.19.1.m1.1.1" xref="alg1.19.19.1.m1.1.1.cmml"><mi id="alg1.19.19.1.m1.1.1.2" xref="alg1.19.19.1.m1.1.1.2.cmml">l</mi><mi id="alg1.19.19.1.m1.1.1.3" xref="alg1.19.19.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.19.19.1.m1.1b"><apply id="alg1.19.19.1.m1.1.1.cmml" xref="alg1.19.19.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.19.19.1.m1.1.1.1.cmml" xref="alg1.19.19.1.m1.1.1">subscript</csymbol><ci id="alg1.19.19.1.m1.1.1.2.cmml" xref="alg1.19.19.1.m1.1.1.2">𝑙</ci><ci id="alg1.19.19.1.m1.1.1.3.cmml" xref="alg1.19.19.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.19.19.1.m1.1c">l_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.19.19.1.m1.1d">italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in Text Encoder</em><span class="ltx_text" id="alg1.19.19.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.19.19.6" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.26.40">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.40.1.1.1" style="font-size:80%;">26</span></span><span class="ltx_text" id="alg1.26.40.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.40.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.26.40.4" style="font-size:80%;">
</span><span class="ltx_text ltx_font_bold" id="alg1.26.40.5" style="font-size:80%;">if</span><span class="ltx_text" id="alg1.26.40.6" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.26.40.7" style="font-size:80%;">linear layers</em><span class="ltx_text" id="alg1.26.40.8" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.26.40.9" style="font-size:80%;">then</span>
</div>
<div class="ltx_listingline" id="alg1.20.20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.20.20.1.1.1" style="font-size:80%;">27</span></span><span class="ltx_text" id="alg1.20.20.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.20.20.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.20.20.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.20.20.5" style="font-size:80%;">
Apply RORQ </span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S4.SS3" style="font-size:80%;" title="IV-C Reorder-based Outlier-Retained Quantization ‣ IV METHOD ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag"><span class="ltx_text">IV-C</span></span></a><span class="ltx_text" id="alg1.20.20.6" style="font-size:80%;"> for activations to obtain </span><math alttext="(\tau_{i},s_{i},z_{i})" class="ltx_Math" display="inline" id="alg1.20.20.m1.3"><semantics id="alg1.20.20.m1.3a"><mrow id="alg1.20.20.m1.3.3.3" xref="alg1.20.20.m1.3.3.4.cmml"><mo id="alg1.20.20.m1.3.3.3.4" maxsize="80%" minsize="80%" xref="alg1.20.20.m1.3.3.4.cmml">(</mo><msub id="alg1.20.20.m1.1.1.1.1" xref="alg1.20.20.m1.1.1.1.1.cmml"><mi id="alg1.20.20.m1.1.1.1.1.2" mathsize="80%" xref="alg1.20.20.m1.1.1.1.1.2.cmml">τ</mi><mi id="alg1.20.20.m1.1.1.1.1.3" mathsize="80%" xref="alg1.20.20.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.20.20.m1.3.3.3.5" mathsize="80%" xref="alg1.20.20.m1.3.3.4.cmml">,</mo><msub id="alg1.20.20.m1.2.2.2.2" xref="alg1.20.20.m1.2.2.2.2.cmml"><mi id="alg1.20.20.m1.2.2.2.2.2" mathsize="80%" xref="alg1.20.20.m1.2.2.2.2.2.cmml">s</mi><mi id="alg1.20.20.m1.2.2.2.2.3" mathsize="80%" xref="alg1.20.20.m1.2.2.2.2.3.cmml">i</mi></msub><mo id="alg1.20.20.m1.3.3.3.6" mathsize="80%" xref="alg1.20.20.m1.3.3.4.cmml">,</mo><msub id="alg1.20.20.m1.3.3.3.3" xref="alg1.20.20.m1.3.3.3.3.cmml"><mi id="alg1.20.20.m1.3.3.3.3.2" mathsize="80%" xref="alg1.20.20.m1.3.3.3.3.2.cmml">z</mi><mi id="alg1.20.20.m1.3.3.3.3.3" mathsize="80%" xref="alg1.20.20.m1.3.3.3.3.3.cmml">i</mi></msub><mo id="alg1.20.20.m1.3.3.3.7" maxsize="80%" minsize="80%" xref="alg1.20.20.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.20.20.m1.3b"><vector id="alg1.20.20.m1.3.3.4.cmml" xref="alg1.20.20.m1.3.3.3"><apply id="alg1.20.20.m1.1.1.1.1.cmml" xref="alg1.20.20.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.20.20.m1.1.1.1.1.1.cmml" xref="alg1.20.20.m1.1.1.1.1">subscript</csymbol><ci id="alg1.20.20.m1.1.1.1.1.2.cmml" xref="alg1.20.20.m1.1.1.1.1.2">𝜏</ci><ci id="alg1.20.20.m1.1.1.1.1.3.cmml" xref="alg1.20.20.m1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.20.20.m1.2.2.2.2.cmml" xref="alg1.20.20.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.20.20.m1.2.2.2.2.1.cmml" xref="alg1.20.20.m1.2.2.2.2">subscript</csymbol><ci id="alg1.20.20.m1.2.2.2.2.2.cmml" xref="alg1.20.20.m1.2.2.2.2.2">𝑠</ci><ci id="alg1.20.20.m1.2.2.2.2.3.cmml" xref="alg1.20.20.m1.2.2.2.2.3">𝑖</ci></apply><apply id="alg1.20.20.m1.3.3.3.3.cmml" xref="alg1.20.20.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.20.20.m1.3.3.3.3.1.cmml" xref="alg1.20.20.m1.3.3.3.3">subscript</csymbol><ci id="alg1.20.20.m1.3.3.3.3.2.cmml" xref="alg1.20.20.m1.3.3.3.3.2">𝑧</ci><ci id="alg1.20.20.m1.3.3.3.3.3.cmml" xref="alg1.20.20.m1.3.3.3.3.3">𝑖</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.20.20.m1.3c">(\tau_{i},s_{i},z_{i})</annotation><annotation encoding="application/x-llamapun" id="alg1.20.20.m1.3d">( italic_τ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.20.20.7" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.26.41">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.41.1.1.1" style="font-size:80%;">28</span></span><span class="ltx_text" id="alg1.26.41.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.41.3" style="font-size:80%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.41.4" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.26.41.5" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.26.42">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.42.1.1.1" style="font-size:80%;">29</span></span><span class="ltx_text" id="alg1.26.42.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.42.3" style="font-size:80%;">   </span>
</div>
<div class="ltx_listingline" id="alg1.21.21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.21.21.2.1.1" style="font-size:80%;">30</span></span><span class="ltx_text ltx_font_bold" id="alg1.21.21.3" style="font-size:80%;">for</span><span class="ltx_text" id="alg1.21.21.4" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.21.21.1" style="font-size:80%;"><math alttext="l_{i}" class="ltx_Math" display="inline" id="alg1.21.21.1.m1.1"><semantics id="alg1.21.21.1.m1.1a"><msub id="alg1.21.21.1.m1.1.1" xref="alg1.21.21.1.m1.1.1.cmml"><mi id="alg1.21.21.1.m1.1.1.2" xref="alg1.21.21.1.m1.1.1.2.cmml">l</mi><mi id="alg1.21.21.1.m1.1.1.3" xref="alg1.21.21.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.21.21.1.m1.1b"><apply id="alg1.21.21.1.m1.1.1.cmml" xref="alg1.21.21.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.21.21.1.m1.1.1.1.cmml" xref="alg1.21.21.1.m1.1.1">subscript</csymbol><ci id="alg1.21.21.1.m1.1.1.2.cmml" xref="alg1.21.21.1.m1.1.1.2">𝑙</ci><ci id="alg1.21.21.1.m1.1.1.3.cmml" xref="alg1.21.21.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.21.21.1.m1.1c">l_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.21.21.1.m1.1d">italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in Fusion module and other text encoder layers</em><span class="ltx_text" id="alg1.21.21.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.21.21.6" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.23.23">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.23.23.1.1.1" style="font-size:80%;">31</span></span><span class="ltx_text" id="alg1.23.23.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.23.23.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.23.23.4" style="font-size:80%;">
Use Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S3.E1" style="font-size:80%;" title="In III-C Weight and Activation Quantization ‣ III PRELIMINARY ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a><span class="ltx_text" id="alg1.23.23.5" style="font-size:80%;"> for </span><math alttext="(s_{\text{weight}},z_{\text{weight}})" class="ltx_Math" display="inline" id="alg1.22.22.m1.2"><semantics id="alg1.22.22.m1.2a"><mrow id="alg1.22.22.m1.2.2.2" xref="alg1.22.22.m1.2.2.3.cmml"><mo id="alg1.22.22.m1.2.2.2.3" maxsize="80%" minsize="80%" xref="alg1.22.22.m1.2.2.3.cmml">(</mo><msub id="alg1.22.22.m1.1.1.1.1" xref="alg1.22.22.m1.1.1.1.1.cmml"><mi id="alg1.22.22.m1.1.1.1.1.2" mathsize="80%" xref="alg1.22.22.m1.1.1.1.1.2.cmml">s</mi><mtext id="alg1.22.22.m1.1.1.1.1.3" mathsize="80%" xref="alg1.22.22.m1.1.1.1.1.3a.cmml">weight</mtext></msub><mo id="alg1.22.22.m1.2.2.2.4" mathsize="80%" xref="alg1.22.22.m1.2.2.3.cmml">,</mo><msub id="alg1.22.22.m1.2.2.2.2" xref="alg1.22.22.m1.2.2.2.2.cmml"><mi id="alg1.22.22.m1.2.2.2.2.2" mathsize="80%" xref="alg1.22.22.m1.2.2.2.2.2.cmml">z</mi><mtext id="alg1.22.22.m1.2.2.2.2.3" mathsize="80%" xref="alg1.22.22.m1.2.2.2.2.3a.cmml">weight</mtext></msub><mo id="alg1.22.22.m1.2.2.2.5" maxsize="80%" minsize="80%" xref="alg1.22.22.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.22.22.m1.2b"><interval closure="open" id="alg1.22.22.m1.2.2.3.cmml" xref="alg1.22.22.m1.2.2.2"><apply id="alg1.22.22.m1.1.1.1.1.cmml" xref="alg1.22.22.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.22.22.m1.1.1.1.1.1.cmml" xref="alg1.22.22.m1.1.1.1.1">subscript</csymbol><ci id="alg1.22.22.m1.1.1.1.1.2.cmml" xref="alg1.22.22.m1.1.1.1.1.2">𝑠</ci><ci id="alg1.22.22.m1.1.1.1.1.3a.cmml" xref="alg1.22.22.m1.1.1.1.1.3"><mtext id="alg1.22.22.m1.1.1.1.1.3.cmml" mathsize="56%" xref="alg1.22.22.m1.1.1.1.1.3">weight</mtext></ci></apply><apply id="alg1.22.22.m1.2.2.2.2.cmml" xref="alg1.22.22.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.22.22.m1.2.2.2.2.1.cmml" xref="alg1.22.22.m1.2.2.2.2">subscript</csymbol><ci id="alg1.22.22.m1.2.2.2.2.2.cmml" xref="alg1.22.22.m1.2.2.2.2.2">𝑧</ci><ci id="alg1.22.22.m1.2.2.2.2.3a.cmml" xref="alg1.22.22.m1.2.2.2.2.3"><mtext id="alg1.22.22.m1.2.2.2.2.3.cmml" mathsize="56%" xref="alg1.22.22.m1.2.2.2.2.3">weight</mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.22.22.m1.2c">(s_{\text{weight}},z_{\text{weight}})</annotation><annotation encoding="application/x-llamapun" id="alg1.22.22.m1.2d">( italic_s start_POSTSUBSCRIPT weight end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT weight end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.23.23.6" style="font-size:80%;"> and </span><math alttext="(s_{\text{act}},z_{\text{act}})" class="ltx_Math" display="inline" id="alg1.23.23.m2.2"><semantics id="alg1.23.23.m2.2a"><mrow id="alg1.23.23.m2.2.2.2" xref="alg1.23.23.m2.2.2.3.cmml"><mo id="alg1.23.23.m2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg1.23.23.m2.2.2.3.cmml">(</mo><msub id="alg1.23.23.m2.1.1.1.1" xref="alg1.23.23.m2.1.1.1.1.cmml"><mi id="alg1.23.23.m2.1.1.1.1.2" mathsize="80%" xref="alg1.23.23.m2.1.1.1.1.2.cmml">s</mi><mtext id="alg1.23.23.m2.1.1.1.1.3" mathsize="80%" xref="alg1.23.23.m2.1.1.1.1.3a.cmml">act</mtext></msub><mo id="alg1.23.23.m2.2.2.2.4" mathsize="80%" xref="alg1.23.23.m2.2.2.3.cmml">,</mo><msub id="alg1.23.23.m2.2.2.2.2" xref="alg1.23.23.m2.2.2.2.2.cmml"><mi id="alg1.23.23.m2.2.2.2.2.2" mathsize="80%" xref="alg1.23.23.m2.2.2.2.2.2.cmml">z</mi><mtext id="alg1.23.23.m2.2.2.2.2.3" mathsize="80%" xref="alg1.23.23.m2.2.2.2.2.3a.cmml">act</mtext></msub><mo id="alg1.23.23.m2.2.2.2.5" maxsize="80%" minsize="80%" xref="alg1.23.23.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.23.23.m2.2b"><interval closure="open" id="alg1.23.23.m2.2.2.3.cmml" xref="alg1.23.23.m2.2.2.2"><apply id="alg1.23.23.m2.1.1.1.1.cmml" xref="alg1.23.23.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.23.23.m2.1.1.1.1.1.cmml" xref="alg1.23.23.m2.1.1.1.1">subscript</csymbol><ci id="alg1.23.23.m2.1.1.1.1.2.cmml" xref="alg1.23.23.m2.1.1.1.1.2">𝑠</ci><ci id="alg1.23.23.m2.1.1.1.1.3a.cmml" xref="alg1.23.23.m2.1.1.1.1.3"><mtext id="alg1.23.23.m2.1.1.1.1.3.cmml" mathsize="56%" xref="alg1.23.23.m2.1.1.1.1.3">act</mtext></ci></apply><apply id="alg1.23.23.m2.2.2.2.2.cmml" xref="alg1.23.23.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.23.23.m2.2.2.2.2.1.cmml" xref="alg1.23.23.m2.2.2.2.2">subscript</csymbol><ci id="alg1.23.23.m2.2.2.2.2.2.cmml" xref="alg1.23.23.m2.2.2.2.2.2">𝑧</ci><ci id="alg1.23.23.m2.2.2.2.2.3a.cmml" xref="alg1.23.23.m2.2.2.2.2.3"><mtext id="alg1.23.23.m2.2.2.2.2.3.cmml" mathsize="56%" xref="alg1.23.23.m2.2.2.2.2.3">act</mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.23.23.m2.2c">(s_{\text{act}},z_{\text{act}})</annotation><annotation encoding="application/x-llamapun" id="alg1.23.23.m2.2d">( italic_s start_POSTSUBSCRIPT act end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT act end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.23.23.7" style="font-size:80%;">;</span>
</div>
<div class="ltx_listingline" id="alg1.26.43">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.43.1.1.1" style="font-size:80%;">32</span></span><span class="ltx_text" id="alg1.26.43.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.43.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.26.43.4" style="font-size:80%;">
</span>
</div>
<div class="ltx_listingline" id="alg1.24.24">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.24.24.2.1.1" style="font-size:80%;">33</span></span><span class="ltx_text ltx_font_bold" id="alg1.24.24.3" style="font-size:80%;">for</span><span class="ltx_text" id="alg1.24.24.4" style="font-size:80%;"> </span><em class="ltx_emph ltx_font_italic" id="alg1.24.24.1" style="font-size:80%;"><math alttext="l_{i}" class="ltx_Math" display="inline" id="alg1.24.24.1.m1.1"><semantics id="alg1.24.24.1.m1.1a"><msub id="alg1.24.24.1.m1.1.1" xref="alg1.24.24.1.m1.1.1.cmml"><mi id="alg1.24.24.1.m1.1.1.2" xref="alg1.24.24.1.m1.1.1.2.cmml">l</mi><mi id="alg1.24.24.1.m1.1.1.3" xref="alg1.24.24.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.24.24.1.m1.1b"><apply id="alg1.24.24.1.m1.1.1.cmml" xref="alg1.24.24.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.24.24.1.m1.1.1.1.cmml" xref="alg1.24.24.1.m1.1.1">subscript</csymbol><ci id="alg1.24.24.1.m1.1.1.2.cmml" xref="alg1.24.24.1.m1.1.1.2">𝑙</ci><ci id="alg1.24.24.1.m1.1.1.3.cmml" xref="alg1.24.24.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.24.24.1.m1.1c">l_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.24.24.1.m1.1d">italic_l start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in Decoder</em><span class="ltx_text" id="alg1.24.24.5" style="font-size:80%;"> </span><span class="ltx_text ltx_font_bold" id="alg1.24.24.6" style="font-size:80%;">do</span>
</div>
<div class="ltx_listingline" id="alg1.26.26">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.26.1.1.1" style="font-size:80%;">34</span></span><span class="ltx_text" id="alg1.26.26.2" style="font-size:80%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span class="ltx_text" id="alg1.26.26.3" style="font-size:80%;">   </span><span class="ltx_text" id="alg1.26.26.4" style="font-size:80%;">
Absorb BN layers into adjacent linear layers for efficient computation and compute </span><math alttext="(s_{\text{weight}},z_{\text{weight}})" class="ltx_Math" display="inline" id="alg1.25.25.m1.2"><semantics id="alg1.25.25.m1.2a"><mrow id="alg1.25.25.m1.2.2.2" xref="alg1.25.25.m1.2.2.3.cmml"><mo id="alg1.25.25.m1.2.2.2.3" maxsize="80%" minsize="80%" xref="alg1.25.25.m1.2.2.3.cmml">(</mo><msub id="alg1.25.25.m1.1.1.1.1" xref="alg1.25.25.m1.1.1.1.1.cmml"><mi id="alg1.25.25.m1.1.1.1.1.2" mathsize="80%" xref="alg1.25.25.m1.1.1.1.1.2.cmml">s</mi><mtext id="alg1.25.25.m1.1.1.1.1.3" mathsize="80%" xref="alg1.25.25.m1.1.1.1.1.3a.cmml">weight</mtext></msub><mo id="alg1.25.25.m1.2.2.2.4" mathsize="80%" xref="alg1.25.25.m1.2.2.3.cmml">,</mo><msub id="alg1.25.25.m1.2.2.2.2" xref="alg1.25.25.m1.2.2.2.2.cmml"><mi id="alg1.25.25.m1.2.2.2.2.2" mathsize="80%" xref="alg1.25.25.m1.2.2.2.2.2.cmml">z</mi><mtext id="alg1.25.25.m1.2.2.2.2.3" mathsize="80%" xref="alg1.25.25.m1.2.2.2.2.3a.cmml">weight</mtext></msub><mo id="alg1.25.25.m1.2.2.2.5" maxsize="80%" minsize="80%" xref="alg1.25.25.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.25.25.m1.2b"><interval closure="open" id="alg1.25.25.m1.2.2.3.cmml" xref="alg1.25.25.m1.2.2.2"><apply id="alg1.25.25.m1.1.1.1.1.cmml" xref="alg1.25.25.m1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.25.25.m1.1.1.1.1.1.cmml" xref="alg1.25.25.m1.1.1.1.1">subscript</csymbol><ci id="alg1.25.25.m1.1.1.1.1.2.cmml" xref="alg1.25.25.m1.1.1.1.1.2">𝑠</ci><ci id="alg1.25.25.m1.1.1.1.1.3a.cmml" xref="alg1.25.25.m1.1.1.1.1.3"><mtext id="alg1.25.25.m1.1.1.1.1.3.cmml" mathsize="56%" xref="alg1.25.25.m1.1.1.1.1.3">weight</mtext></ci></apply><apply id="alg1.25.25.m1.2.2.2.2.cmml" xref="alg1.25.25.m1.2.2.2.2"><csymbol cd="ambiguous" id="alg1.25.25.m1.2.2.2.2.1.cmml" xref="alg1.25.25.m1.2.2.2.2">subscript</csymbol><ci id="alg1.25.25.m1.2.2.2.2.2.cmml" xref="alg1.25.25.m1.2.2.2.2.2">𝑧</ci><ci id="alg1.25.25.m1.2.2.2.2.3a.cmml" xref="alg1.25.25.m1.2.2.2.2.3"><mtext id="alg1.25.25.m1.2.2.2.2.3.cmml" mathsize="56%" xref="alg1.25.25.m1.2.2.2.2.3">weight</mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.25.25.m1.2c">(s_{\text{weight}},z_{\text{weight}})</annotation><annotation encoding="application/x-llamapun" id="alg1.25.25.m1.2d">( italic_s start_POSTSUBSCRIPT weight end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT weight end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.26.26.5" style="font-size:80%;"> and </span><math alttext="(s_{\text{act}},z_{\text{act}})" class="ltx_Math" display="inline" id="alg1.26.26.m2.2"><semantics id="alg1.26.26.m2.2a"><mrow id="alg1.26.26.m2.2.2.2" xref="alg1.26.26.m2.2.2.3.cmml"><mo id="alg1.26.26.m2.2.2.2.3" maxsize="80%" minsize="80%" xref="alg1.26.26.m2.2.2.3.cmml">(</mo><msub id="alg1.26.26.m2.1.1.1.1" xref="alg1.26.26.m2.1.1.1.1.cmml"><mi id="alg1.26.26.m2.1.1.1.1.2" mathsize="80%" xref="alg1.26.26.m2.1.1.1.1.2.cmml">s</mi><mtext id="alg1.26.26.m2.1.1.1.1.3" mathsize="80%" xref="alg1.26.26.m2.1.1.1.1.3a.cmml">act</mtext></msub><mo id="alg1.26.26.m2.2.2.2.4" mathsize="80%" xref="alg1.26.26.m2.2.2.3.cmml">,</mo><msub id="alg1.26.26.m2.2.2.2.2" xref="alg1.26.26.m2.2.2.2.2.cmml"><mi id="alg1.26.26.m2.2.2.2.2.2" mathsize="80%" xref="alg1.26.26.m2.2.2.2.2.2.cmml">z</mi><mtext id="alg1.26.26.m2.2.2.2.2.3" mathsize="80%" xref="alg1.26.26.m2.2.2.2.2.3a.cmml">act</mtext></msub><mo id="alg1.26.26.m2.2.2.2.5" maxsize="80%" minsize="80%" xref="alg1.26.26.m2.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.26.26.m2.2b"><interval closure="open" id="alg1.26.26.m2.2.2.3.cmml" xref="alg1.26.26.m2.2.2.2"><apply id="alg1.26.26.m2.1.1.1.1.cmml" xref="alg1.26.26.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.26.26.m2.1.1.1.1.1.cmml" xref="alg1.26.26.m2.1.1.1.1">subscript</csymbol><ci id="alg1.26.26.m2.1.1.1.1.2.cmml" xref="alg1.26.26.m2.1.1.1.1.2">𝑠</ci><ci id="alg1.26.26.m2.1.1.1.1.3a.cmml" xref="alg1.26.26.m2.1.1.1.1.3"><mtext id="alg1.26.26.m2.1.1.1.1.3.cmml" mathsize="56%" xref="alg1.26.26.m2.1.1.1.1.3">act</mtext></ci></apply><apply id="alg1.26.26.m2.2.2.2.2.cmml" xref="alg1.26.26.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.26.26.m2.2.2.2.2.1.cmml" xref="alg1.26.26.m2.2.2.2.2">subscript</csymbol><ci id="alg1.26.26.m2.2.2.2.2.2.cmml" xref="alg1.26.26.m2.2.2.2.2.2">𝑧</ci><ci id="alg1.26.26.m2.2.2.2.2.3a.cmml" xref="alg1.26.26.m2.2.2.2.2.3"><mtext id="alg1.26.26.m2.2.2.2.2.3.cmml" mathsize="56%" xref="alg1.26.26.m2.2.2.2.2.3">act</mtext></ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.26.26.m2.2c">(s_{\text{act}},z_{\text{act}})</annotation><annotation encoding="application/x-llamapun" id="alg1.26.26.m2.2d">( italic_s start_POSTSUBSCRIPT act end_POSTSUBSCRIPT , italic_z start_POSTSUBSCRIPT act end_POSTSUBSCRIPT )</annotation></semantics></math><span class="ltx_text" id="alg1.26.26.6" style="font-size:80%;"> based on Eq. </span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S3.E1" style="font-size:80%;" title="In III-C Weight and Activation Quantization ‣ III PRELIMINARY ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">1</span></a><span class="ltx_text" id="alg1.26.26.7" style="font-size:80%;"> with channel-wise setting;
</span>
</div>
<div class="ltx_listingline" id="alg1.26.44">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.26.44.1.1.1" style="font-size:80%;">35</span></span>
</div>
<div class="ltx_listingline" id="alg1.26.45">
</div>
</div>
<figcaption class="ltx_caption" style="font-size:80%;"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.30.1.1">Algorithm 1</span> </span>Pipeline of PTQ4RIS Framework</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">EXPERIMENTS</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Datasets and Metrics:</span>
The experiments are conducted on three standard benchmark datasets: RefCOCO <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib54" title="">54</a>]</cite>, RefCOCO+ <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib54" title="">54</a>]</cite>, and G-Ref <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib55" title="">55</a>]</cite>. Additionally, the G-Ref dataset has two different partitions, UMD and Google. Our experiments report on both partitions. Besides, we evaluate our proposed method using three metrics: Overall Intersection over Union (OIoU), Mean Intersection over Union (MIoU), and Precision<math alttext="@X,X\in\{0.5,0.7,0.9\}" class="ltx_Math" display="inline" id="S5.p1.1.m1.5"><semantics id="S5.p1.1.m1.5a"><mrow id="S5.p1.1.m1.5.5" xref="S5.p1.1.m1.5.5.cmml"><mrow id="S5.p1.1.m1.5.5.1.1" xref="S5.p1.1.m1.5.5.1.2.cmml"><mrow id="S5.p1.1.m1.5.5.1.1.1" xref="S5.p1.1.m1.5.5.1.1.1.cmml"><mi id="S5.p1.1.m1.5.5.1.1.1.2" mathvariant="normal" xref="S5.p1.1.m1.5.5.1.1.1.2.cmml">@</mi><mo id="S5.p1.1.m1.5.5.1.1.1.1" xref="S5.p1.1.m1.5.5.1.1.1.1.cmml">⁢</mo><mi id="S5.p1.1.m1.5.5.1.1.1.3" xref="S5.p1.1.m1.5.5.1.1.1.3.cmml">X</mi></mrow><mo id="S5.p1.1.m1.5.5.1.1.2" xref="S5.p1.1.m1.5.5.1.2.cmml">,</mo><mi id="S5.p1.1.m1.4.4" xref="S5.p1.1.m1.4.4.cmml">X</mi></mrow><mo id="S5.p1.1.m1.5.5.2" xref="S5.p1.1.m1.5.5.2.cmml">∈</mo><mrow id="S5.p1.1.m1.5.5.3.2" xref="S5.p1.1.m1.5.5.3.1.cmml"><mo id="S5.p1.1.m1.5.5.3.2.1" stretchy="false" xref="S5.p1.1.m1.5.5.3.1.cmml">{</mo><mn id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml">0.5</mn><mo id="S5.p1.1.m1.5.5.3.2.2" xref="S5.p1.1.m1.5.5.3.1.cmml">,</mo><mn id="S5.p1.1.m1.2.2" xref="S5.p1.1.m1.2.2.cmml">0.7</mn><mo id="S5.p1.1.m1.5.5.3.2.3" xref="S5.p1.1.m1.5.5.3.1.cmml">,</mo><mn id="S5.p1.1.m1.3.3" xref="S5.p1.1.m1.3.3.cmml">0.9</mn><mo id="S5.p1.1.m1.5.5.3.2.4" stretchy="false" xref="S5.p1.1.m1.5.5.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.5b"><apply id="S5.p1.1.m1.5.5.cmml" xref="S5.p1.1.m1.5.5"><in id="S5.p1.1.m1.5.5.2.cmml" xref="S5.p1.1.m1.5.5.2"></in><list id="S5.p1.1.m1.5.5.1.2.cmml" xref="S5.p1.1.m1.5.5.1.1"><apply id="S5.p1.1.m1.5.5.1.1.1.cmml" xref="S5.p1.1.m1.5.5.1.1.1"><times id="S5.p1.1.m1.5.5.1.1.1.1.cmml" xref="S5.p1.1.m1.5.5.1.1.1.1"></times><ci id="S5.p1.1.m1.5.5.1.1.1.2.cmml" xref="S5.p1.1.m1.5.5.1.1.1.2">@</ci><ci id="S5.p1.1.m1.5.5.1.1.1.3.cmml" xref="S5.p1.1.m1.5.5.1.1.1.3">𝑋</ci></apply><ci id="S5.p1.1.m1.4.4.cmml" xref="S5.p1.1.m1.4.4">𝑋</ci></list><set id="S5.p1.1.m1.5.5.3.1.cmml" xref="S5.p1.1.m1.5.5.3.2"><cn id="S5.p1.1.m1.1.1.cmml" type="float" xref="S5.p1.1.m1.1.1">0.5</cn><cn id="S5.p1.1.m1.2.2.cmml" type="float" xref="S5.p1.1.m1.2.2">0.7</cn><cn id="S5.p1.1.m1.3.3.cmml" type="float" xref="S5.p1.1.m1.3.3">0.9</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.5c">@X,X\in\{0.5,0.7,0.9\}</annotation><annotation encoding="application/x-llamapun" id="S5.p1.1.m1.5d">@ italic_X , italic_X ∈ { 0.5 , 0.7 , 0.9 }</annotation></semantics></math>.</p>
</div>
<figure class="ltx_table" id="S5.T1">
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T1.4.1.1" style="font-size:129%;">TABLE I</span>: </span><span class="ltx_text" id="S5.T1.5.2" style="font-size:129%;">Quantization MIoU Results Across Different Datasets and Bit-widths (Full Precision is the ceiling performance)</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T1.6" style="width:368.6pt;height:351.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-2.8pt,2.6pt) scale(0.985158851699736,0.985158851699736) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T1.6.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T1.6.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.1.1.1.1" style="font-size:70%;position:relative; bottom:-20.0pt;">Bit-width</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.1.1.2.1" style="font-size:70%;position:relative; bottom:-20.0pt;">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T1.6.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.1.1.3.1" style="font-size:70%;position:relative; bottom:-0.8pt;">RefCOCO</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T1.6.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.1.1.4.1" style="font-size:70%;position:relative; bottom:-0.8pt;">RefCOCO+</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T1.6.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.1.1.5.1" style="font-size:70%;position:relative; bottom:-0.8pt;">G-Ref</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.2.2">
<td class="ltx_td ltx_border_r" id="S5.T1.6.1.2.2.1"></td>
<td class="ltx_td ltx_border_r" id="S5.T1.6.1.2.2.2"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.2.2.3"><span class="ltx_text" id="S5.T1.6.1.2.2.3.1" style="font-size:70%;">val</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.2.2.4"><span class="ltx_text" id="S5.T1.6.1.2.2.4.1" style="font-size:70%;">testA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.2.2.5"><span class="ltx_text" id="S5.T1.6.1.2.2.5.1" style="font-size:70%;">testB</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.2.2.6"><span class="ltx_text" id="S5.T1.6.1.2.2.6.1" style="font-size:70%;">val</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.2.2.7"><span class="ltx_text" id="S5.T1.6.1.2.2.7.1" style="font-size:70%;">testA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.2.2.8"><span class="ltx_text" id="S5.T1.6.1.2.2.8.1" style="font-size:70%;">testB</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.2.2.9"><span class="ltx_text" id="S5.T1.6.1.2.2.9.1" style="font-size:70%;">val(U)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.2.2.10"><span class="ltx_text" id="S5.T1.6.1.2.2.10.1" style="font-size:70%;">test(U)</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.1.2.2.11"><span class="ltx_text" id="S5.T1.6.1.2.2.11.1" style="font-size:70%;">val(G)</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.3.3.1"><span class="ltx_text" id="S5.T1.6.1.3.3.1.1" style="font-size:70%;">W32A32</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.3.3.2"><span class="ltx_text" id="S5.T1.6.1.3.3.2.1" style="font-size:70%;">Full Precision</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.3.3.3"><span class="ltx_text" id="S5.T1.6.1.3.3.3.1" style="font-size:70%;">74.31</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.3.3.4"><span class="ltx_text" id="S5.T1.6.1.3.3.4.1" style="font-size:70%;">76.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.3.3.5"><span class="ltx_text" id="S5.T1.6.1.3.3.5.1" style="font-size:70%;">70.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.3.3.6"><span class="ltx_text" id="S5.T1.6.1.3.3.6.1" style="font-size:70%;">66.69</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.3.3.7"><span class="ltx_text" id="S5.T1.6.1.3.3.7.1" style="font-size:70%;">71.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.3.3.8"><span class="ltx_text" id="S5.T1.6.1.3.3.8.1" style="font-size:70%;">60.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.3.3.9"><span class="ltx_text" id="S5.T1.6.1.3.3.9.1" style="font-size:70%;">65.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.3.3.10"><span class="ltx_text" id="S5.T1.6.1.3.3.10.1" style="font-size:70%;">66.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.1.3.3.11"><span class="ltx_text" id="S5.T1.6.1.3.3.11.1" style="font-size:70%;">64.08</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.4.4.1" rowspan="4"><span class="ltx_text" id="S5.T1.6.1.4.4.1.1" style="font-size:70%;">W8A8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.4.4.2"><span class="ltx_text" id="S5.T1.6.1.4.4.2.1" style="font-size:70%;">RTN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.4.4.3"><span class="ltx_text" id="S5.T1.6.1.4.4.3.1" style="font-size:70%;">73.28</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.4.4.4"><span class="ltx_text" id="S5.T1.6.1.4.4.4.1" style="font-size:70%;">76.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.4.4.5"><span class="ltx_text" id="S5.T1.6.1.4.4.5.1" style="font-size:70%;">69.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.4.4.6"><span class="ltx_text" id="S5.T1.6.1.4.4.6.1" style="font-size:70%;">65.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.4.4.7"><span class="ltx_text" id="S5.T1.6.1.4.4.7.1" style="font-size:70%;">70.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.4.4.8"><span class="ltx_text" id="S5.T1.6.1.4.4.8.1" style="font-size:70%;">58.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.4.4.9"><span class="ltx_text" id="S5.T1.6.1.4.4.9.1" style="font-size:70%;">65.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.4.4.10"><span class="ltx_text" id="S5.T1.6.1.4.4.10.1" style="font-size:70%;">65.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.1.4.4.11"><span class="ltx_text" id="S5.T1.6.1.4.4.11.1" style="font-size:70%;">63.86</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.5.5.1">
<span class="ltx_text" id="S5.T1.6.1.5.5.1.1" style="font-size:70%;">PTQ4ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T1.6.1.5.5.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a><span class="ltx_text" id="S5.T1.6.1.5.5.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.5.5.2"><span class="ltx_text" id="S5.T1.6.1.5.5.2.1" style="font-size:70%;">73.48</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.5.5.3"><span class="ltx_text" id="S5.T1.6.1.5.5.3.1" style="font-size:70%;">76.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.5.5.4"><span class="ltx_text" id="S5.T1.6.1.5.5.4.1" style="font-size:70%;">69.63</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.5.5.5"><span class="ltx_text" id="S5.T1.6.1.5.5.5.1" style="font-size:70%;">49.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.5.5.6"><span class="ltx_text" id="S5.T1.6.1.5.5.6.1" style="font-size:70%;">57.61</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.5.5.7"><span class="ltx_text" id="S5.T1.6.1.5.5.7.1" style="font-size:70%;">39.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.5.5.8"><span class="ltx_text" id="S5.T1.6.1.5.5.8.1" style="font-size:70%;">63.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.5.5.9"><span class="ltx_text" id="S5.T1.6.1.5.5.9.1" style="font-size:70%;">63.74</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.5.5.10"><span class="ltx_text" id="S5.T1.6.1.5.5.10.1" style="font-size:70%;">62.83</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.6.6.1">
<span class="ltx_text" id="S5.T1.6.1.6.6.1.1" style="font-size:70%;">RepQ-ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T1.6.1.6.6.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a><span class="ltx_text" id="S5.T1.6.1.6.6.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.6.6.2"><span class="ltx_text" id="S5.T1.6.1.6.6.2.1" style="font-size:70%;">73.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.6.6.3"><span class="ltx_text" id="S5.T1.6.1.6.6.3.1" style="font-size:70%;">75.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.6.6.4"><span class="ltx_text" id="S5.T1.6.1.6.6.4.1" style="font-size:70%;">69.81</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.6.6.5"><span class="ltx_text" id="S5.T1.6.1.6.6.5.1" style="font-size:70%;">66.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.6.6.6"><span class="ltx_text" id="S5.T1.6.1.6.6.6.1" style="font-size:70%;">71.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.6.6.7"><span class="ltx_text" id="S5.T1.6.1.6.6.7.1" style="font-size:70%;">59.62</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.6.6.8"><span class="ltx_text" id="S5.T1.6.1.6.6.8.1" style="font-size:70%;">65.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.6.6.9"><span class="ltx_text" id="S5.T1.6.1.6.6.9.1" style="font-size:70%;">65.36</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.6.6.10"><span class="ltx_text" id="S5.T1.6.1.6.6.10.1" style="font-size:70%;">63.50</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.7.7.1"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.7.7.1.1" style="font-size:70%;background-color:#E6E6E6;">PTQ4RIS (Ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.7.7.2"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.7.7.2.1" style="font-size:70%;background-color:#E6E6E6;">73.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.7.7.3"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.7.7.3.1" style="font-size:70%;background-color:#E6E6E6;">76.24</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.7.7.4"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.7.7.4.1" style="font-size:70%;background-color:#E6E6E6;">70.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.7.7.5"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.7.7.5.1" style="font-size:70%;background-color:#E6E6E6;">66.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.7.7.6"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.7.7.6.1" style="font-size:70%;background-color:#E6E6E6;">71.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.7.7.7"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.7.7.7.1" style="font-size:70%;background-color:#E6E6E6;">59.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.7.7.8"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.7.7.8.1" style="font-size:70%;background-color:#E6E6E6;">65.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.7.7.9"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.7.7.9.1" style="font-size:70%;background-color:#E6E6E6;">65.62</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.7.7.10"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.7.7.10.1" style="font-size:70%;background-color:#E6E6E6;">63.93</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.8.8.1" rowspan="4"><span class="ltx_text" id="S5.T1.6.1.8.8.1.1" style="font-size:70%;">W6A6</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.8.8.2"><span class="ltx_text" id="S5.T1.6.1.8.8.2.1" style="font-size:70%;">RTN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.8.8.3"><span class="ltx_text" id="S5.T1.6.1.8.8.3.1" style="font-size:70%;">69.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.8.8.4"><span class="ltx_text" id="S5.T1.6.1.8.8.4.1" style="font-size:70%;">74.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.8.8.5"><span class="ltx_text" id="S5.T1.6.1.8.8.5.1" style="font-size:70%;">68.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.8.8.6"><span class="ltx_text" id="S5.T1.6.1.8.8.6.1" style="font-size:70%;">62.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.8.8.7"><span class="ltx_text" id="S5.T1.6.1.8.8.7.1" style="font-size:70%;">66.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.8.8.8"><span class="ltx_text" id="S5.T1.6.1.8.8.8.1" style="font-size:70%;">54.76</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.8.8.9"><span class="ltx_text" id="S5.T1.6.1.8.8.9.1" style="font-size:70%;">62.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.8.8.10"><span class="ltx_text" id="S5.T1.6.1.8.8.10.1" style="font-size:70%;">63.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.1.8.8.11"><span class="ltx_text" id="S5.T1.6.1.8.8.11.1" style="font-size:70%;">60.91</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.9.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.9.9.1">
<span class="ltx_text" id="S5.T1.6.1.9.9.1.1" style="font-size:70%;">PTQ4ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T1.6.1.9.9.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a><span class="ltx_text" id="S5.T1.6.1.9.9.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.9.9.2"><span class="ltx_text" id="S5.T1.6.1.9.9.2.1" style="font-size:70%;">63.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.9.9.3"><span class="ltx_text" id="S5.T1.6.1.9.9.3.1" style="font-size:70%;">66.75</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.9.9.4"><span class="ltx_text" id="S5.T1.6.1.9.9.4.1" style="font-size:70%;">58.96</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.9.9.5"><span class="ltx_text" id="S5.T1.6.1.9.9.5.1" style="font-size:70%;">26.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.9.9.6"><span class="ltx_text" id="S5.T1.6.1.9.9.6.1" style="font-size:70%;">30.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.9.9.7"><span class="ltx_text" id="S5.T1.6.1.9.9.7.1" style="font-size:70%;">22.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.9.9.8"><span class="ltx_text" id="S5.T1.6.1.9.9.8.1" style="font-size:70%;">60.24</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.9.9.9"><span class="ltx_text" id="S5.T1.6.1.9.9.9.1" style="font-size:70%;">60.19</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.9.9.10"><span class="ltx_text" id="S5.T1.6.1.9.9.10.1" style="font-size:70%;">58.70</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.10.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.10.10.1">
<span class="ltx_text" id="S5.T1.6.1.10.10.1.1" style="font-size:70%;">RepQ-ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T1.6.1.10.10.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a><span class="ltx_text" id="S5.T1.6.1.10.10.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.10.10.2"><span class="ltx_text" id="S5.T1.6.1.10.10.2.1" style="font-size:70%;">65.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.10.10.3"><span class="ltx_text" id="S5.T1.6.1.10.10.3.1" style="font-size:70%;">68.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.10.10.4"><span class="ltx_text" id="S5.T1.6.1.10.10.4.1" style="font-size:70%;">63.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.10.10.5"><span class="ltx_text" id="S5.T1.6.1.10.10.5.1" style="font-size:70%;">58.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.10.10.6"><span class="ltx_text" id="S5.T1.6.1.10.10.6.1" style="font-size:70%;">65.27</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.10.10.7"><span class="ltx_text" id="S5.T1.6.1.10.10.7.1" style="font-size:70%;">50.81</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.10.10.8"><span class="ltx_text" id="S5.T1.6.1.10.10.8.1" style="font-size:70%;">61.15</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.10.10.9"><span class="ltx_text" id="S5.T1.6.1.10.10.9.1" style="font-size:70%;">61.55</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.10.10.10"><span class="ltx_text" id="S5.T1.6.1.10.10.10.1" style="font-size:70%;">58.76</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.11.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.11.11.1"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.11.11.1.1" style="font-size:70%;background-color:#E6E6E6;">PTQ4RIS (Ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.11.11.2"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.11.11.2.1" style="font-size:70%;background-color:#E6E6E6;">72.85</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.11.11.3"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.11.11.3.1" style="font-size:70%;background-color:#E6E6E6;">75.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.11.11.4"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.11.11.4.1" style="font-size:70%;background-color:#E6E6E6;">68.62</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.11.11.5"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.11.11.5.1" style="font-size:70%;background-color:#E6E6E6;">65.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.11.11.6"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.11.11.6.1" style="font-size:70%;background-color:#E6E6E6;">69.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.11.11.7"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.11.11.7.1" style="font-size:70%;background-color:#E6E6E6;">58.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.11.11.8"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.11.11.8.1" style="font-size:70%;background-color:#E6E6E6;">65.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.11.11.9"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.11.11.9.1" style="font-size:70%;background-color:#E6E6E6;">65.31</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.11.11.10"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.11.11.10.1" style="font-size:70%;background-color:#E6E6E6;">63.66</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.12.12">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.12.12.1" rowspan="4"><span class="ltx_text" id="S5.T1.6.1.12.12.1.1" style="font-size:70%;">W4A8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.12.12.2"><span class="ltx_text" id="S5.T1.6.1.12.12.2.1" style="font-size:70%;">RTN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.12.12.3"><span class="ltx_text" id="S5.T1.6.1.12.12.3.1" style="font-size:70%;">62.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.12.12.4"><span class="ltx_text" id="S5.T1.6.1.12.12.4.1" style="font-size:70%;">65.30</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.12.12.5"><span class="ltx_text" id="S5.T1.6.1.12.12.5.1" style="font-size:70%;">58.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.12.12.6"><span class="ltx_text" id="S5.T1.6.1.12.12.6.1" style="font-size:70%;">44.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.12.12.7"><span class="ltx_text" id="S5.T1.6.1.12.12.7.1" style="font-size:70%;">47.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.12.12.8"><span class="ltx_text" id="S5.T1.6.1.12.12.8.1" style="font-size:70%;">39.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.12.12.9"><span class="ltx_text" id="S5.T1.6.1.12.12.9.1" style="font-size:70%;">53.71</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.12.12.10"><span class="ltx_text" id="S5.T1.6.1.12.12.10.1" style="font-size:70%;">53.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.1.12.12.11"><span class="ltx_text" id="S5.T1.6.1.12.12.11.1" style="font-size:70%;">41.31</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.13.13">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.13.13.1">
<span class="ltx_text" id="S5.T1.6.1.13.13.1.1" style="font-size:70%;">PTQ4ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T1.6.1.13.13.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a><span class="ltx_text" id="S5.T1.6.1.13.13.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.13.13.2"><span class="ltx_text" id="S5.T1.6.1.13.13.2.1" style="font-size:70%;">67.11</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.13.13.3"><span class="ltx_text" id="S5.T1.6.1.13.13.3.1" style="font-size:70%;">70.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.13.13.4"><span class="ltx_text" id="S5.T1.6.1.13.13.4.1" style="font-size:70%;">62.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.13.13.5"><span class="ltx_text" id="S5.T1.6.1.13.13.5.1" style="font-size:70%;">32.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.13.13.6"><span class="ltx_text" id="S5.T1.6.1.13.13.6.1" style="font-size:70%;">37.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.13.13.7"><span class="ltx_text" id="S5.T1.6.1.13.13.7.1" style="font-size:70%;">28.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.13.13.8"><span class="ltx_text" id="S5.T1.6.1.13.13.8.1" style="font-size:70%;">60.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.13.13.9"><span class="ltx_text" id="S5.T1.6.1.13.13.9.1" style="font-size:70%;">60.74</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.13.13.10"><span class="ltx_text" id="S5.T1.6.1.13.13.10.1" style="font-size:70%;">60.49</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.14.14">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.14.14.1">
<span class="ltx_text" id="S5.T1.6.1.14.14.1.1" style="font-size:70%;">RepQ-ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T1.6.1.14.14.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a><span class="ltx_text" id="S5.T1.6.1.14.14.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.14.14.2"><span class="ltx_text" id="S5.T1.6.1.14.14.2.1" style="font-size:70%;">67.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.14.14.3"><span class="ltx_text" id="S5.T1.6.1.14.14.3.1" style="font-size:70%;">71.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.14.14.4"><span class="ltx_text" id="S5.T1.6.1.14.14.4.1" style="font-size:70%;">63.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.14.14.5"><span class="ltx_text" id="S5.T1.6.1.14.14.5.1" style="font-size:70%;">59.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.14.14.6"><span class="ltx_text" id="S5.T1.6.1.14.14.6.1" style="font-size:70%;">65.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.14.14.7"><span class="ltx_text" id="S5.T1.6.1.14.14.7.1" style="font-size:70%;">51.08</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.14.14.8"><span class="ltx_text" id="S5.T1.6.1.14.14.8.1" style="font-size:70%;">62.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.14.14.9"><span class="ltx_text" id="S5.T1.6.1.14.14.9.1" style="font-size:70%;">62.74</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.14.14.10"><span class="ltx_text" id="S5.T1.6.1.14.14.10.1" style="font-size:70%;">60.50</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.15.15">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.15.15.1"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.15.15.1.1" style="font-size:70%;background-color:#E6E6E6;">PTQ4RIS (Ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.15.15.2"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.15.15.2.1" style="font-size:70%;background-color:#E6E6E6;">72.62</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.15.15.3"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.15.15.3.1" style="font-size:70%;background-color:#E6E6E6;">75.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.15.15.4"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.15.15.4.1" style="font-size:70%;background-color:#E6E6E6;">68.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.15.15.5"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.15.15.5.1" style="font-size:70%;background-color:#E6E6E6;">64.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.15.15.6"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.15.15.6.1" style="font-size:70%;background-color:#E6E6E6;">69.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.15.15.7"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.15.15.7.1" style="font-size:70%;background-color:#E6E6E6;">57.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.15.15.8"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.15.15.8.1" style="font-size:70%;background-color:#E6E6E6;">63.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.15.15.9"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.15.15.9.1" style="font-size:70%;background-color:#E6E6E6;">63.96</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.15.15.10"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.15.15.10.1" style="font-size:70%;background-color:#E6E6E6;">62.08</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.16.16">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T1.6.1.16.16.1" rowspan="4"><span class="ltx_text" id="S5.T1.6.1.16.16.1.1" style="font-size:70%;">W4A4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.16.16.2"><span class="ltx_text" id="S5.T1.6.1.16.16.2.1" style="font-size:70%;">RTN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.16.16.3"><span class="ltx_text" id="S5.T1.6.1.16.16.3.1" style="font-size:70%;">5.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.16.16.4"><span class="ltx_text" id="S5.T1.6.1.16.16.4.1" style="font-size:70%;">5.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.16.16.5"><span class="ltx_text" id="S5.T1.6.1.16.16.5.1" style="font-size:70%;">4.34</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.16.16.6"><span class="ltx_text" id="S5.T1.6.1.16.16.6.1" style="font-size:70%;">0.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.16.16.7"><span class="ltx_text" id="S5.T1.6.1.16.16.7.1" style="font-size:70%;">0.96</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.16.16.8"><span class="ltx_text" id="S5.T1.6.1.16.16.8.1" style="font-size:70%;">0.92</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.16.16.9"><span class="ltx_text" id="S5.T1.6.1.16.16.9.1" style="font-size:70%;">2.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.6.1.16.16.10"><span class="ltx_text" id="S5.T1.6.1.16.16.10.1" style="font-size:70%;">2.17</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.6.1.16.16.11"><span class="ltx_text" id="S5.T1.6.1.16.16.11.1" style="font-size:70%;">0.53</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.17.17">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.17.17.1">
<span class="ltx_text" id="S5.T1.6.1.17.17.1.1" style="font-size:70%;">PTQ4ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T1.6.1.17.17.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a><span class="ltx_text" id="S5.T1.6.1.17.17.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.17.17.2"><span class="ltx_text" id="S5.T1.6.1.17.17.2.1" style="font-size:70%;">42.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.17.17.3"><span class="ltx_text" id="S5.T1.6.1.17.17.3.1" style="font-size:70%;">43.85</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.17.17.4"><span class="ltx_text" id="S5.T1.6.1.17.17.4.1" style="font-size:70%;">41.20</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.17.17.5"><span class="ltx_text" id="S5.T1.6.1.17.17.5.1" style="font-size:70%;">15.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.17.17.6"><span class="ltx_text" id="S5.T1.6.1.17.17.6.1" style="font-size:70%;">16.83</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.17.17.7"><span class="ltx_text" id="S5.T1.6.1.17.17.7.1" style="font-size:70%;">13.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.17.17.8"><span class="ltx_text" id="S5.T1.6.1.17.17.8.1" style="font-size:70%;">48.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.17.17.9"><span class="ltx_text" id="S5.T1.6.1.17.17.9.1" style="font-size:70%;">48.66</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.17.17.10"><span class="ltx_text" id="S5.T1.6.1.17.17.10.1" style="font-size:70%;">18.36</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.18.18">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.18.18.1">
<span class="ltx_text" id="S5.T1.6.1.18.18.1.1" style="font-size:70%;">RepQ-ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T1.6.1.18.18.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a><span class="ltx_text" id="S5.T1.6.1.18.18.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.18.18.2"><span class="ltx_text" id="S5.T1.6.1.18.18.2.1" style="font-size:70%;">28.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.18.18.3"><span class="ltx_text" id="S5.T1.6.1.18.18.3.1" style="font-size:70%;">29.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.18.18.4"><span class="ltx_text" id="S5.T1.6.1.18.18.4.1" style="font-size:70%;">40.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.18.18.5"><span class="ltx_text" id="S5.T1.6.1.18.18.5.1" style="font-size:70%;">22.55</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.18.18.6"><span class="ltx_text" id="S5.T1.6.1.18.18.6.1" style="font-size:70%;">25.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.18.18.7"><span class="ltx_text" id="S5.T1.6.1.18.18.7.1" style="font-size:70%;">18.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.18.18.8"><span class="ltx_text" id="S5.T1.6.1.18.18.8.1" style="font-size:70%;">54.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.6.1.18.18.9"><span class="ltx_text" id="S5.T1.6.1.18.18.9.1" style="font-size:70%;">54.84</span></td>
<td class="ltx_td ltx_align_center" id="S5.T1.6.1.18.18.10"><span class="ltx_text" id="S5.T1.6.1.18.18.10.1" style="font-size:70%;">48.04</span></td>
</tr>
<tr class="ltx_tr" id="S5.T1.6.1.19.19">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.6.1.19.19.1"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.19.19.1.1" style="font-size:70%;background-color:#E6E6E6;">PTQ4RIS (Ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.6.1.19.19.2"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.19.19.2.1" style="font-size:70%;background-color:#E6E6E6;">69.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.6.1.19.19.3"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.19.19.3.1" style="font-size:70%;background-color:#E6E6E6;">71.67</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.6.1.19.19.4"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.19.19.4.1" style="font-size:70%;background-color:#E6E6E6;">65.35</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.6.1.19.19.5"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.19.19.5.1" style="font-size:70%;background-color:#E6E6E6;">61.25</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.6.1.19.19.6"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.19.19.6.1" style="font-size:70%;background-color:#E6E6E6;">65.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.6.1.19.19.7"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.19.19.7.1" style="font-size:70%;background-color:#E6E6E6;">54.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.6.1.19.19.8"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.19.19.8.1" style="font-size:70%;background-color:#E6E6E6;">60.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T1.6.1.19.19.9"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.19.19.9.1" style="font-size:70%;background-color:#E6E6E6;">60.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T1.6.1.19.19.10"><span class="ltx_text ltx_font_bold" id="S5.T1.6.1.19.19.10.1" style="font-size:70%;background-color:#E6E6E6;">59.92</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.3"><span class="ltx_text ltx_font_bold" id="S5.p2.3.1">Implementation Details:</span> Our full-precision model is LAVT<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib6" title="">6</a>]</cite>. The calibration dataset number is set to 32, accounting for about <span class="ltx_text ltx_font_bold" id="S5.p2.3.2">1%</span> of the entire dataset. For the quantization design of the visual encoder, we set <math alttext="\alpha=0.01" class="ltx_Math" display="inline" id="S5.p2.1.m1.1"><semantics id="S5.p2.1.m1.1a"><mrow id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mi id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">α</mi><mo id="S5.p2.1.m1.1.1.1" xref="S5.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.1.m1.1b"><apply id="S5.p2.1.m1.1.1.cmml" xref="S5.p2.1.m1.1.1"><eq id="S5.p2.1.m1.1.1.1.cmml" xref="S5.p2.1.m1.1.1.1"></eq><ci id="S5.p2.1.m1.1.1.2.cmml" xref="S5.p2.1.m1.1.1.2">𝛼</ci><cn id="S5.p2.1.m1.1.1.3.cmml" type="float" xref="S5.p2.1.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.1.m1.1c">\alpha=0.01</annotation><annotation encoding="application/x-llamapun" id="S5.p2.1.m1.1d">italic_α = 0.01</annotation></semantics></math>, <math alttext="\beta=1.2" class="ltx_Math" display="inline" id="S5.p2.2.m2.1"><semantics id="S5.p2.2.m2.1a"><mrow id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml"><mi id="S5.p2.2.m2.1.1.2" xref="S5.p2.2.m2.1.1.2.cmml">β</mi><mo id="S5.p2.2.m2.1.1.1" xref="S5.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.p2.2.m2.1.1.3" xref="S5.p2.2.m2.1.1.3.cmml">1.2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.2.m2.1b"><apply id="S5.p2.2.m2.1.1.cmml" xref="S5.p2.2.m2.1.1"><eq id="S5.p2.2.m2.1.1.1.cmml" xref="S5.p2.2.m2.1.1.1"></eq><ci id="S5.p2.2.m2.1.1.2.cmml" xref="S5.p2.2.m2.1.1.2">𝛽</ci><cn id="S5.p2.2.m2.1.1.3.cmml" type="float" xref="S5.p2.2.m2.1.1.3">1.2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.2.m2.1c">\beta=1.2</annotation><annotation encoding="application/x-llamapun" id="S5.p2.2.m2.1d">italic_β = 1.2</annotation></semantics></math>, <math alttext="N=100" class="ltx_Math" display="inline" id="S5.p2.3.m3.1"><semantics id="S5.p2.3.m3.1a"><mrow id="S5.p2.3.m3.1.1" xref="S5.p2.3.m3.1.1.cmml"><mi id="S5.p2.3.m3.1.1.2" xref="S5.p2.3.m3.1.1.2.cmml">N</mi><mo id="S5.p2.3.m3.1.1.1" xref="S5.p2.3.m3.1.1.1.cmml">=</mo><mn id="S5.p2.3.m3.1.1.3" xref="S5.p2.3.m3.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.p2.3.m3.1b"><apply id="S5.p2.3.m3.1.1.cmml" xref="S5.p2.3.m3.1.1"><eq id="S5.p2.3.m3.1.1.1.cmml" xref="S5.p2.3.m3.1.1.1"></eq><ci id="S5.p2.3.m3.1.1.2.cmml" xref="S5.p2.3.m3.1.1.2">𝑁</ci><cn id="S5.p2.3.m3.1.1.3.cmml" type="integer" xref="S5.p2.3.m3.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p2.3.m3.1c">N=100</annotation><annotation encoding="application/x-llamapun" id="S5.p2.3.m3.1d">italic_N = 100</annotation></semantics></math> to get search spaces, and the number of search round is set to 3. In the text endoer and fusion modules, the percentile methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib56" title="">56</a>]</cite> is used to identify the scale factor of the matrix, otherwise use the mean square error (MSE) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib57" title="">57</a>]</cite> function, with channel-wise uniform quantization <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib45" title="">45</a>]</cite> for weights and layer-wise uniform quantization for activations. For decoder, we use channel-wise uniform affine quantization for weights and activations. Our experiment video is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.youtube.com/watch?v=EGy-PD7rRfk" title="">https://www.youtube.com/watch?v=EGy-PD7rRfk</a>.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS1.5.1.1">V-A</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS1.6.2">Qualitative Results</span>
</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">Since there is no development PTQ method specifically designed for the RIS task, we implement a round-to-nearest quantization (RTN) to quantify our full-precision RIS model. Also, to compare with existing quantization methods, we re-implement two advanced well-known PTQ methods designed for vision transformer, namely PTQ4ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a>]</cite> and RepQ-ViT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a>]</cite>.
We conducte experiments using different weight-activation bit-widths for these methods. The results for MIoU and OIoU are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S5.T1" title="TABLE I ‣ V EXPERIMENTS ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">I</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S5.T2" title="TABLE II ‣ V-A Qualitative Results ‣ V EXPERIMENTS ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">II</span></a>.</p>
</div>
<div class="ltx_para" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.1">When the bit width is 8, all four methods exhibit excellent performance, but our method shows superior results and performs nearly on par with the FP model on some datasets.
For example, on RefCOCO testB dataset, we improve 0.75 MIoU and 0.36 OIoU compared to RTN, and 0.58 MIoU (0.29OIoU) and 0.40 MIoU (0.44OIoU) compared to PTQ4ViT and RepQ-ViT.
In W6A6 setting, the model performance after quantization using RTN is significantly better than the other two Transformer-based methods, indicating that the hybrid structure quantization method has the advantage at the lower bit width, but the least decrease in RTN is presented on the RefCOCO testA dataset at 2.19 MIoU and 2.28 OIoU, respectively. In contrast, our PTQ4RIS method maintains high performance, which improves 0.93 MIoU and 1.57 OIoU compared to RTN.</p>
</div>
<div class="ltx_para" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1">In W4A8 setting, taking RefCOCO+ val dataset as an example, the RTN performance decreases 22.68 MIoU (15.84 OIoU), while the PTQ4ViT is 34.32 MIoU (23.35 OIoU) and the RepQ-ViT is 7.69 MIoU (4.28 OIoU). Our method only decreases 2.40 MIoU (1.95 OIoU), which still fully demonstrates the advantages of the method.
However, compared with the weight quantization set to 8 bits, the performance decrease of 2.13 MIoU (1.89 OIoU) is more obvious. This shows that the low weight bit width also affects the model performance, but compared with W4A4, it can be seen that the low bit quantization of the activation value is more sensitive.
When the bit-width is W4A4, the other three methods almost lost performance, even though PTQ4ViT outperformed RTN and Rep-QViT, it has dropped by at least 17.41 MIoU (15.63 OIoU) on the val dataset of G-ref, but our PTQ4RIS only dropped by 5.31 MIoU and 3.67 OIoU, maintaining a high level of quantized model performance.</p>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T2.4.1.1" style="font-size:129%;">TABLE II</span>: </span><span class="ltx_text" id="S5.T2.5.2" style="font-size:129%;">Quantization OIoU Results Across Different Datasets and Bit-widths (Full Precision is the ceiling performance)</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T2.6" style="width:368.6pt;height:351.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-2.8pt,2.6pt) scale(0.985158851699736,0.985158851699736) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T2.6.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.6.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.1.1.1.1" style="font-size:70%;position:relative; bottom:-20.0pt;">Bit-width</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.1.1.2.1" style="font-size:70%;position:relative; bottom:-20.0pt;">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T2.6.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.1.1.3.1" style="font-size:70%;position:relative; bottom:-0.8pt;">RefCOCO</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="S5.T2.6.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.1.1.4.1" style="font-size:70%;position:relative; bottom:-0.8pt;">RefCOCO+</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" colspan="3" id="S5.T2.6.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.1.1.5.1" style="font-size:70%;position:relative; bottom:-0.8pt;">G-Ref</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.2.2">
<td class="ltx_td ltx_border_r" id="S5.T2.6.1.2.2.1"></td>
<td class="ltx_td ltx_border_r" id="S5.T2.6.1.2.2.2"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.2.2.3"><span class="ltx_text" id="S5.T2.6.1.2.2.3.1" style="font-size:70%;">val</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.2.2.4"><span class="ltx_text" id="S5.T2.6.1.2.2.4.1" style="font-size:70%;">testA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.2.2.5"><span class="ltx_text" id="S5.T2.6.1.2.2.5.1" style="font-size:70%;">testB</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.2.2.6"><span class="ltx_text" id="S5.T2.6.1.2.2.6.1" style="font-size:70%;">val</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.2.2.7"><span class="ltx_text" id="S5.T2.6.1.2.2.7.1" style="font-size:70%;">testA</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.2.2.8"><span class="ltx_text" id="S5.T2.6.1.2.2.8.1" style="font-size:70%;">testB</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.2.2.9"><span class="ltx_text" id="S5.T2.6.1.2.2.9.1" style="font-size:70%;">val(U)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.2.2.10"><span class="ltx_text" id="S5.T2.6.1.2.2.10.1" style="font-size:70%;">test(U)</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.2.2.11"><span class="ltx_text" id="S5.T2.6.1.2.2.11.1" style="font-size:70%;">val(G)</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.3.1"><span class="ltx_text" id="S5.T2.6.1.3.3.1.1" style="font-size:70%;">W32A32</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.3.2"><span class="ltx_text" id="S5.T2.6.1.3.3.2.1" style="font-size:70%;">Full Precision</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.3.3"><span class="ltx_text" id="S5.T2.6.1.3.3.3.1" style="font-size:70%;">72.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.3.4"><span class="ltx_text" id="S5.T2.6.1.3.3.4.1" style="font-size:70%;">75.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.3.5"><span class="ltx_text" id="S5.T2.6.1.3.3.5.1" style="font-size:70%;">68.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.3.6"><span class="ltx_text" id="S5.T2.6.1.3.3.6.1" style="font-size:70%;">63.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.3.7"><span class="ltx_text" id="S5.T2.6.1.3.3.7.1" style="font-size:70%;">68.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.3.8"><span class="ltx_text" id="S5.T2.6.1.3.3.8.1" style="font-size:70%;">56.08</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.3.9"><span class="ltx_text" id="S5.T2.6.1.3.3.9.1" style="font-size:70%;">62.65</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.3.3.10"><span class="ltx_text" id="S5.T2.6.1.3.3.10.1" style="font-size:70%;">64.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.3.3.11"><span class="ltx_text" id="S5.T2.6.1.3.3.11.1" style="font-size:70%;">60.85</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.4.4.1" rowspan="4"><span class="ltx_text" id="S5.T2.6.1.4.4.1.1" style="font-size:70%;">W8A8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.4.4.2"><span class="ltx_text" id="S5.T2.6.1.4.4.2.1" style="font-size:70%;">RTN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.4.4.3"><span class="ltx_text" id="S5.T2.6.1.4.4.3.1" style="font-size:70%;">72.08</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.4.4.4"><span class="ltx_text" id="S5.T2.6.1.4.4.4.1" style="font-size:70%;">75.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.4.4.5"><span class="ltx_text" id="S5.T2.6.1.4.4.5.1" style="font-size:70%;">67.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.4.4.6"><span class="ltx_text" id="S5.T2.6.1.4.4.6.1" style="font-size:70%;">62.84</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.4.4.7"><span class="ltx_text" id="S5.T2.6.1.4.4.7.1" style="font-size:70%;">67.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.4.4.8"><span class="ltx_text" id="S5.T2.6.1.4.4.8.1" style="font-size:70%;">55.49</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.4.4.9"><span class="ltx_text" id="S5.T2.6.1.4.4.9.1" style="font-size:70%;">62.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.4.4.10"><span class="ltx_text" id="S5.T2.6.1.4.4.10.1" style="font-size:70%;">63.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.4.4.11"><span class="ltx_text" id="S5.T2.6.1.4.4.11.1" style="font-size:70%;">60.56</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.5.5.1">
<span class="ltx_text" id="S5.T2.6.1.5.5.1.1" style="font-size:70%;">PTQ4ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T2.6.1.5.5.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a><span class="ltx_text" id="S5.T2.6.1.5.5.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.5.5.2"><span class="ltx_text" id="S5.T2.6.1.5.5.2.1" style="font-size:70%;">72.07</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.5.5.3"><span class="ltx_text" id="S5.T2.6.1.5.5.3.1" style="font-size:70%;">75.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.5.5.4"><span class="ltx_text" id="S5.T2.6.1.5.5.4.1" style="font-size:70%;">67.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.5.5.5"><span class="ltx_text" id="S5.T2.6.1.5.5.5.1" style="font-size:70%;">53.85</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.5.5.6"><span class="ltx_text" id="S5.T2.6.1.5.5.6.1" style="font-size:70%;">60.99</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.5.5.7"><span class="ltx_text" id="S5.T2.6.1.5.5.7.1" style="font-size:70%;">45.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.5.5.8"><span class="ltx_text" id="S5.T2.6.1.5.5.8.1" style="font-size:70%;">61.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.5.5.9"><span class="ltx_text" id="S5.T2.6.1.5.5.9.1" style="font-size:70%;">62.78</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.5.5.10"><span class="ltx_text" id="S5.T2.6.1.5.5.10.1" style="font-size:70%;">60.20</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.6.6.1">
<span class="ltx_text" id="S5.T2.6.1.6.6.1.1" style="font-size:70%;">RepQ-ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T2.6.1.6.6.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a><span class="ltx_text" id="S5.T2.6.1.6.6.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.6.6.2"><span class="ltx_text" id="S5.T2.6.1.6.6.2.1" style="font-size:70%;">72.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.6.6.3"><span class="ltx_text" id="S5.T2.6.1.6.6.3.1" style="font-size:70%;">75.14</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.6.6.4"><span class="ltx_text" id="S5.T2.6.1.6.6.4.1" style="font-size:70%;">67.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.6.6.5"><span class="ltx_text" id="S5.T2.6.1.6.6.5.1" style="font-size:70%;">63.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.6.6.6"><span class="ltx_text" id="S5.T2.6.1.6.6.6.1" style="font-size:70%;">68.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.6.6.7"><span class="ltx_text" id="S5.T2.6.1.6.6.7.1" style="font-size:70%;">55.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.6.6.8"><span class="ltx_text" id="S5.T2.6.1.6.6.8.1" style="font-size:70%;">62.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.6.6.9"><span class="ltx_text" id="S5.T2.6.1.6.6.9.1" style="font-size:70%;">63.47</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.6.6.10"><span class="ltx_text" id="S5.T2.6.1.6.6.10.1" style="font-size:70%;">60.49</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.7.7.1"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.7.7.1.1" style="font-size:70%;background-color:#E6E6E6;">PTQ4RIS (Ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.7.7.2"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.7.7.2.1" style="font-size:70%;background-color:#E6E6E6;">72.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.7.7.3"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.7.7.3.1" style="font-size:70%;background-color:#E6E6E6;">75.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.7.7.4"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.7.7.4.1" style="font-size:70%;background-color:#E6E6E6;">68.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.7.7.5"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.7.7.5.1" style="font-size:70%;background-color:#E6E6E6;">63.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.7.7.6"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.7.7.6.1" style="font-size:70%;background-color:#E6E6E6;">68.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.7.7.7"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.7.7.7.1" style="font-size:70%;background-color:#E6E6E6;">56.07</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.7.7.8"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.7.7.8.1" style="font-size:70%;background-color:#E6E6E6;">62.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.7.7.9"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.7.7.9.1" style="font-size:70%;background-color:#E6E6E6;">63.84</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.7.7.10"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.7.7.10.1" style="font-size:70%;background-color:#E6E6E6;">60.80</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.8.8.1" rowspan="4"><span class="ltx_text" id="S5.T2.6.1.8.8.1.1" style="font-size:70%;">W6A6</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.8.8.2"><span class="ltx_text" id="S5.T2.6.1.8.8.2.1" style="font-size:70%;">RTN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.8.8.3"><span class="ltx_text" id="S5.T2.6.1.8.8.3.1" style="font-size:70%;">68.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.8.8.4"><span class="ltx_text" id="S5.T2.6.1.8.8.4.1" style="font-size:70%;">73.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.8.8.5"><span class="ltx_text" id="S5.T2.6.1.8.8.5.1" style="font-size:70%;">66.06</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.8.8.6"><span class="ltx_text" id="S5.T2.6.1.8.8.6.1" style="font-size:70%;">60.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.8.8.7"><span class="ltx_text" id="S5.T2.6.1.8.8.7.1" style="font-size:70%;">65.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.8.8.8"><span class="ltx_text" id="S5.T2.6.1.8.8.8.1" style="font-size:70%;">52.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.8.8.9"><span class="ltx_text" id="S5.T2.6.1.8.8.9.1" style="font-size:70%;">60.16</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.8.8.10"><span class="ltx_text" id="S5.T2.6.1.8.8.10.1" style="font-size:70%;">61.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.8.8.11"><span class="ltx_text" id="S5.T2.6.1.8.8.11.1" style="font-size:70%;">57.92</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.9.9">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.9.9.1">
<span class="ltx_text" id="S5.T2.6.1.9.9.1.1" style="font-size:70%;">PTQ4ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T2.6.1.9.9.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a><span class="ltx_text" id="S5.T2.6.1.9.9.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.9.9.2"><span class="ltx_text" id="S5.T2.6.1.9.9.2.1" style="font-size:70%;">65.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.9.9.3"><span class="ltx_text" id="S5.T2.6.1.9.9.3.1" style="font-size:70%;">68.64</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.9.9.4"><span class="ltx_text" id="S5.T2.6.1.9.9.4.1" style="font-size:70%;">59.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.9.9.5"><span class="ltx_text" id="S5.T2.6.1.9.9.5.1" style="font-size:70%;">31.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.9.9.6"><span class="ltx_text" id="S5.T2.6.1.9.9.6.1" style="font-size:70%;">35.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.9.9.7"><span class="ltx_text" id="S5.T2.6.1.9.9.7.1" style="font-size:70%;">28.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.9.9.8"><span class="ltx_text" id="S5.T2.6.1.9.9.8.1" style="font-size:70%;">57.75</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.9.9.9"><span class="ltx_text" id="S5.T2.6.1.9.9.9.1" style="font-size:70%;">58.71</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.9.9.10"><span class="ltx_text" id="S5.T2.6.1.9.9.10.1" style="font-size:70%;">57.74</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.10.10">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.10.10.1">
<span class="ltx_text" id="S5.T2.6.1.10.10.1.1" style="font-size:70%;">RepQ-ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T2.6.1.10.10.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a><span class="ltx_text" id="S5.T2.6.1.10.10.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.10.10.2"><span class="ltx_text" id="S5.T2.6.1.10.10.2.1" style="font-size:70%;">67.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.10.10.3"><span class="ltx_text" id="S5.T2.6.1.10.10.3.1" style="font-size:70%;">70.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.10.10.4"><span class="ltx_text" id="S5.T2.6.1.10.10.4.1" style="font-size:70%;">64.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.10.10.5"><span class="ltx_text" id="S5.T2.6.1.10.10.5.1" style="font-size:70%;">58.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.10.10.6"><span class="ltx_text" id="S5.T2.6.1.10.10.6.1" style="font-size:70%;">64.91</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.10.10.7"><span class="ltx_text" id="S5.T2.6.1.10.10.7.1" style="font-size:70%;">51.48</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.10.10.8"><span class="ltx_text" id="S5.T2.6.1.10.10.8.1" style="font-size:70%;">59.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.10.10.9"><span class="ltx_text" id="S5.T2.6.1.10.10.9.1" style="font-size:70%;">60.51</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.10.10.10"><span class="ltx_text" id="S5.T2.6.1.10.10.10.1" style="font-size:70%;">56.34</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.11.11">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.11.11.1"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.11.11.1.1" style="font-size:70%;background-color:#E6E6E6;">PTQ4RIS (Ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.11.11.2"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.11.11.2.1" style="font-size:70%;background-color:#E6E6E6;">71.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.11.11.3"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.11.11.3.1" style="font-size:70%;background-color:#E6E6E6;">75.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.11.11.4"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.11.11.4.1" style="font-size:70%;background-color:#E6E6E6;">67.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.11.11.5"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.11.11.5.1" style="font-size:70%;background-color:#E6E6E6;">62.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.11.11.6"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.11.11.6.1" style="font-size:70%;background-color:#E6E6E6;">67.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.11.11.7"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.11.11.7.1" style="font-size:70%;background-color:#E6E6E6;">55.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.11.11.8"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.11.11.8.1" style="font-size:70%;background-color:#E6E6E6;">62.01</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.11.11.9"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.11.11.9.1" style="font-size:70%;background-color:#E6E6E6;">63.47</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.11.11.10"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.11.11.10.1" style="font-size:70%;background-color:#E6E6E6;">60.61</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.12.12">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.12.12.1" rowspan="4"><span class="ltx_text" id="S5.T2.6.1.12.12.1.1" style="font-size:70%;">W4A8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.12.12.2"><span class="ltx_text" id="S5.T2.6.1.12.12.2.1" style="font-size:70%;">RTN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.12.12.3"><span class="ltx_text" id="S5.T2.6.1.12.12.3.1" style="font-size:70%;">64.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.12.12.4"><span class="ltx_text" id="S5.T2.6.1.12.12.4.1" style="font-size:70%;">67.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.12.12.5"><span class="ltx_text" id="S5.T2.6.1.12.12.5.1" style="font-size:70%;">60.47</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.12.12.6"><span class="ltx_text" id="S5.T2.6.1.12.12.6.1" style="font-size:70%;">47.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.12.12.7"><span class="ltx_text" id="S5.T2.6.1.12.12.7.1" style="font-size:70%;">51.57</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.12.12.8"><span class="ltx_text" id="S5.T2.6.1.12.12.8.1" style="font-size:70%;">41.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.12.12.9"><span class="ltx_text" id="S5.T2.6.1.12.12.9.1" style="font-size:70%;">54.82</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.12.12.10"><span class="ltx_text" id="S5.T2.6.1.12.12.10.1" style="font-size:70%;">56.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.12.12.11"><span class="ltx_text" id="S5.T2.6.1.12.12.11.1" style="font-size:70%;">44.84</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.13.13">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.13.13.1">
<span class="ltx_text" id="S5.T2.6.1.13.13.1.1" style="font-size:70%;">PTQ4ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T2.6.1.13.13.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a><span class="ltx_text" id="S5.T2.6.1.13.13.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.13.13.2"><span class="ltx_text" id="S5.T2.6.1.13.13.2.1" style="font-size:70%;">68.18</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.13.13.3"><span class="ltx_text" id="S5.T2.6.1.13.13.3.1" style="font-size:70%;">71.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.13.13.4"><span class="ltx_text" id="S5.T2.6.1.13.13.4.1" style="font-size:70%;">63.58</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.13.13.5"><span class="ltx_text" id="S5.T2.6.1.13.13.5.1" style="font-size:70%;">40.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.13.13.6"><span class="ltx_text" id="S5.T2.6.1.13.13.6.1" style="font-size:70%;">44.32</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.13.13.7"><span class="ltx_text" id="S5.T2.6.1.13.13.7.1" style="font-size:70%;">35.38</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.13.13.8"><span class="ltx_text" id="S5.T2.6.1.13.13.8.1" style="font-size:70%;">58.94</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.13.13.9"><span class="ltx_text" id="S5.T2.6.1.13.13.9.1" style="font-size:70%;">59.92</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.13.13.10"><span class="ltx_text" id="S5.T2.6.1.13.13.10.1" style="font-size:70%;">58.32</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.14.14">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.14.14.1">
<span class="ltx_text" id="S5.T2.6.1.14.14.1.1" style="font-size:70%;">RepQ-ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T2.6.1.14.14.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a><span class="ltx_text" id="S5.T2.6.1.14.14.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.14.14.2"><span class="ltx_text" id="S5.T2.6.1.14.14.2.1" style="font-size:70%;">68.59</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.14.14.3"><span class="ltx_text" id="S5.T2.6.1.14.14.3.1" style="font-size:70%;">71.88</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.14.14.4"><span class="ltx_text" id="S5.T2.6.1.14.14.4.1" style="font-size:70%;">64.22</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.14.14.5"><span class="ltx_text" id="S5.T2.6.1.14.14.5.1" style="font-size:70%;">59.10</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.14.14.6"><span class="ltx_text" id="S5.T2.6.1.14.14.6.1" style="font-size:70%;">65.12</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.14.14.7"><span class="ltx_text" id="S5.T2.6.1.14.14.7.1" style="font-size:70%;">51.33</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.14.14.8"><span class="ltx_text" id="S5.T2.6.1.14.14.8.1" style="font-size:70%;">60.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.14.14.9"><span class="ltx_text" id="S5.T2.6.1.14.14.9.1" style="font-size:70%;">61.35</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.14.14.10"><span class="ltx_text" id="S5.T2.6.1.14.14.10.1" style="font-size:70%;">58.40</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.15.15">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.15.15.1"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.15.15.1.1" style="font-size:70%;background-color:#E6E6E6;">PTQ4RIS (Ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.15.15.2"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.15.15.2.1" style="font-size:70%;background-color:#E6E6E6;">71.48</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.15.15.3"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.15.15.3.1" style="font-size:70%;background-color:#E6E6E6;">74.60</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.15.15.4"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.15.15.4.1" style="font-size:70%;background-color:#E6E6E6;">66.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.15.15.5"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.15.15.5.1" style="font-size:70%;background-color:#E6E6E6;">61.43</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.15.15.6"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.15.15.6.1" style="font-size:70%;background-color:#E6E6E6;">67.17</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.15.15.7"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.15.15.7.1" style="font-size:70%;background-color:#E6E6E6;">54.39</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.15.15.8"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.15.15.8.1" style="font-size:70%;background-color:#E6E6E6;">61.29</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.15.15.9"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.15.15.9.1" style="font-size:70%;background-color:#E6E6E6;">62.38</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.15.15.10"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.15.15.10.1" style="font-size:70%;background-color:#E6E6E6;">59.68</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.16.16">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S5.T2.6.1.16.16.1" rowspan="4"><span class="ltx_text" id="S5.T2.6.1.16.16.1.1" style="font-size:70%;">W4A4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.16.16.2"><span class="ltx_text" id="S5.T2.6.1.16.16.2.1" style="font-size:70%;">RTN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.16.16.3"><span class="ltx_text" id="S5.T2.6.1.16.16.3.1" style="font-size:70%;">8.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.16.16.4"><span class="ltx_text" id="S5.T2.6.1.16.16.4.1" style="font-size:70%;">8.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.16.16.5"><span class="ltx_text" id="S5.T2.6.1.16.16.5.1" style="font-size:70%;">6.56</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.16.16.6"><span class="ltx_text" id="S5.T2.6.1.16.16.6.1" style="font-size:70%;">1.49</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.16.16.7"><span class="ltx_text" id="S5.T2.6.1.16.16.7.1" style="font-size:70%;">1.66</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.16.16.8"><span class="ltx_text" id="S5.T2.6.1.16.16.8.1" style="font-size:70%;">1.46</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.16.16.9"><span class="ltx_text" id="S5.T2.6.1.16.16.9.1" style="font-size:70%;">2.95</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.6.1.16.16.10"><span class="ltx_text" id="S5.T2.6.1.16.16.10.1" style="font-size:70%;">3.24</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.1.16.16.11"><span class="ltx_text" id="S5.T2.6.1.16.16.11.1" style="font-size:70%;">0.61</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.17.17">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.17.17.1">
<span class="ltx_text" id="S5.T2.6.1.17.17.1.1" style="font-size:70%;">PTQ4ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T2.6.1.17.17.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib12" title="">12</a><span class="ltx_text" id="S5.T2.6.1.17.17.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.17.17.2"><span class="ltx_text" id="S5.T2.6.1.17.17.2.1" style="font-size:70%;">47.03</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.17.17.3"><span class="ltx_text" id="S5.T2.6.1.17.17.3.1" style="font-size:70%;">48.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.17.17.4"><span class="ltx_text" id="S5.T2.6.1.17.17.4.1" style="font-size:70%;">45.36</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.17.17.5"><span class="ltx_text" id="S5.T2.6.1.17.17.5.1" style="font-size:70%;">15.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.17.17.6"><span class="ltx_text" id="S5.T2.6.1.17.17.6.1" style="font-size:70%;">19.42</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.17.17.7"><span class="ltx_text" id="S5.T2.6.1.17.17.7.1" style="font-size:70%;">17.09</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.17.17.8"><span class="ltx_text" id="S5.T2.6.1.17.17.8.1" style="font-size:70%;">47.02</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.17.17.9"><span class="ltx_text" id="S5.T2.6.1.17.17.9.1" style="font-size:70%;">48.31</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.17.17.10"><span class="ltx_text" id="S5.T2.6.1.17.17.10.1" style="font-size:70%;">21.00</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.18.18">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.18.18.1">
<span class="ltx_text" id="S5.T2.6.1.18.18.1.1" style="font-size:70%;">RepQ-ViT</span><cite class="ltx_cite ltx_citemacro_cite"><span class="ltx_text" id="S5.T2.6.1.18.18.1.2.1" style="font-size:70%;">[</span><a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#bib.bib13" title="">13</a><span class="ltx_text" id="S5.T2.6.1.18.18.1.3.2" style="font-size:70%;">]</span></cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.18.18.2"><span class="ltx_text" id="S5.T2.6.1.18.18.2.1" style="font-size:70%;">32.73</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.18.18.3"><span class="ltx_text" id="S5.T2.6.1.18.18.3.1" style="font-size:70%;">33.23</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.18.18.4"><span class="ltx_text" id="S5.T2.6.1.18.18.4.1" style="font-size:70%;">43.54</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.18.18.5"><span class="ltx_text" id="S5.T2.6.1.18.18.5.1" style="font-size:70%;">25.52</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.18.18.6"><span class="ltx_text" id="S5.T2.6.1.18.18.6.1" style="font-size:70%;">26.97</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.18.18.7"><span class="ltx_text" id="S5.T2.6.1.18.18.7.1" style="font-size:70%;">21.74</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.18.18.8"><span class="ltx_text" id="S5.T2.6.1.18.18.8.1" style="font-size:70%;">52.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.6.1.18.18.9"><span class="ltx_text" id="S5.T2.6.1.18.18.9.1" style="font-size:70%;">53.02</span></td>
<td class="ltx_td ltx_align_center" id="S5.T2.6.1.18.18.10"><span class="ltx_text" id="S5.T2.6.1.18.18.10.1" style="font-size:70%;">47.17</span></td>
</tr>
<tr class="ltx_tr" id="S5.T2.6.1.19.19">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.6.1.19.19.1"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.19.19.1.1" style="font-size:70%;background-color:#E6E6E6;">PTQ4RIS (Ours)</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.6.1.19.19.2"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.19.19.2.1" style="font-size:70%;background-color:#E6E6E6;">69.21</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.6.1.19.19.3"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.19.19.3.1" style="font-size:70%;background-color:#E6E6E6;">72.00</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.6.1.19.19.4"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.19.19.4.1" style="font-size:70%;background-color:#E6E6E6;">64.11</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.6.1.19.19.5"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.19.19.5.1" style="font-size:70%;background-color:#E6E6E6;">59.44</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.6.1.19.19.6"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.19.19.6.1" style="font-size:70%;background-color:#E6E6E6;">64.26</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.6.1.19.19.7"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.19.19.7.1" style="font-size:70%;background-color:#E6E6E6;">51.87</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.6.1.19.19.8"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.19.19.8.1" style="font-size:70%;background-color:#E6E6E6;">58.98</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S5.T2.6.1.19.19.9"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.19.19.9.1" style="font-size:70%;background-color:#E6E6E6;">60.37</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S5.T2.6.1.19.19.10"><span class="ltx_text ltx_font_bold" id="S5.T2.6.1.19.19.10.1" style="font-size:70%;background-color:#E6E6E6;">58.27</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS2.5.1.1">V-B</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS2.6.2">Ablation Studies</span>
</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We perform ablation experiments on the RefCOCO validation set with W4A4 setting.</p>
</div>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T3.2.1.1" style="font-size:90%;">TABLE III</span>: </span><span class="ltx_text" id="S5.T3.3.2" style="font-size:90%;">Ablation results of different quantized modules.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T3.4" style="width:433.6pt;height:216pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(72.2pt,-36.0pt) scale(1.49969243811504,1.49969243811504) ;">
<table class="ltx_tabular ltx_align_middle" id="S5.T3.4.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.4.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T3.4.1.1.1.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.1.1.1.1">Bits</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T3.4.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.1.1.2.1">Visual</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T3.4.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.1.1.3.1">Text</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T3.4.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.1.1.4.1">Fusion</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T3.4.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.1.1.5.1">Decoder</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T3.4.1.1.1.6" rowspan="2"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.1.1.6.1">MIoU</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T3.4.1.1.1.7" rowspan="2"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.1.1.7.1">OIoU</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.2.2.1.1">DRQ</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.2.2.2"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.2.2.2.1">RORQ</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.2.2.3"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.2.2.3.1">TN</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.2.2.4"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.2.2.4.1">RTN</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S5.T3.4.1.3.3.1" rowspan="6"><span class="ltx_text" id="S5.T3.4.1.3.3.1.1">W4A4</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.4.1.3.3.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.4.1.3.3.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.4.1.3.3.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.4.1.3.3.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T3.4.1.3.3.6">5.88</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.4.1.3.3.7">8.68</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.4.4.1">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.4.4.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.4.4.3">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.4.4.4">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.4.4.5">19.77</td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.1.4.4.6">21.15</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.5.5.1">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.5.5.2">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.5.5.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.5.5.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.5.5.5">53.30</td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.1.5.5.6">52.99</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.6.6.1">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.6.6.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.6.6.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.6.6.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.6.6.5">21.21</td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.1.6.6.6">24.28</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.7.7.1">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.7.7.2">✓</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.7.7.3">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.7.7.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S5.T3.4.1.7.7.5">68.87</td>
<td class="ltx_td ltx_align_center" id="S5.T3.4.1.7.7.6">68.84</td>
</tr>
<tr class="ltx_tr" id="S5.T3.4.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T3.4.1.8.8.1"><span class="ltx_text" id="S5.T3.4.1.8.8.1.1" style="background-color:#E6E6E6;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T3.4.1.8.8.2"><span class="ltx_text" id="S5.T3.4.1.8.8.2.1" style="background-color:#E6E6E6;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T3.4.1.8.8.3"><span class="ltx_text" id="S5.T3.4.1.8.8.3.1" style="background-color:#E6E6E6;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T3.4.1.8.8.4"><span class="ltx_text" id="S5.T3.4.1.8.8.4.1" style="background-color:#E6E6E6;">✓</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T3.4.1.8.8.5"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.8.8.5.1" style="background-color:#E6E6E6;">69.53</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.4.1.8.8.6"><span class="ltx_text ltx_font_bold" id="S5.T3.4.1.8.8.6.1" style="background-color:#E6E6E6;">69.21</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.1">Ablation of different quantized modules.</span> Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S5.T3" title="TABLE III ‣ V-B Ablation Studies ‣ V EXPERIMENTS ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">III</span></a> shows evaluation of the effectiveness of the four modules (Visual Encoder, Text Encoder, Fusion, and Decoder) in our PTQ4RIS. It can be observed that the performance of the quantized model is very poor when using the naive RTN method. The use of a more fine grain search quantization strategy in the Fusion and Decoder sections results in an improvement of 13.89 MIoU and 12.47 OIoU. After using our DRQ method in Visual Encoder, MIoU and OIoU are improved from 5.88 and 8.68 to 53.30 and 52.99. Using RORQ in text encoder improves model performance by 15.33 MIoU (15.6 OIoU).
It fully demonstrates the superior performance of each of our proposed method components.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T4.4.1.1" style="font-size:129%;">TABLE IV</span>: </span><span class="ltx_text" id="S5.T4.5.2" style="font-size:129%;">Ablations of text encoder quantization.</span></figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S5.T4.6" style="width:433.6pt;height:285.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(107.6pt,-70.9pt) scale(1.98528701854848,1.98528701854848) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S5.T4.6.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.6.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T4.6.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.1.1.1.1" style="font-size:70%;">Method</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T4.6.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.1.1.2.1" style="font-size:70%;">P@0.5</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T4.6.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.1.1.3.1" style="font-size:70%;">P@0.7</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T4.6.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.1.1.4.1" style="font-size:70%;">P@0.9</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S5.T4.6.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.1.1.5.1" style="font-size:70%;">OIoU</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T4.6.1.1.1.6"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.1.1.6.1" style="font-size:70%;">MIoU</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.6.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T4.6.1.2.1.1"><span class="ltx_text" id="S5.T4.6.1.2.1.1.1" style="font-size:70%;">Full Prec.</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T4.6.1.2.1.2"><span class="ltx_text" id="S5.T4.6.1.2.1.2.1" style="font-size:70%;">84.63</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T4.6.1.2.1.3"><span class="ltx_text" id="S5.T4.6.1.2.1.3.1" style="font-size:70%;">75.25</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T4.6.1.2.1.4"><span class="ltx_text" id="S5.T4.6.1.2.1.4.1" style="font-size:70%;">34.56</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T4.6.1.2.1.5"><span class="ltx_text" id="S5.T4.6.1.2.1.5.1" style="font-size:70%;">72.72</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S5.T4.6.1.2.1.6"><span class="ltx_text" id="S5.T4.6.1.2.1.6.1" style="font-size:70%;">74.31</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.1.3.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.3.2.1"><span class="ltx_text" id="S5.T4.6.1.3.2.1.1" style="font-size:70%;">Per-tensor</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.3.2.2"><span class="ltx_text" id="S5.T4.6.1.3.2.2.1" style="font-size:70%;">51.05</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.3.2.3"><span class="ltx_text" id="S5.T4.6.1.3.2.3.1" style="font-size:70%;">40.35</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.3.2.4"><span class="ltx_text" id="S5.T4.6.1.3.2.4.1" style="font-size:70%;">13.73</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.3.2.5"><span class="ltx_text" id="S5.T4.6.1.3.2.5.1" style="font-size:70%;">49.68</span></td>
<td class="ltx_td ltx_align_left" id="S5.T4.6.1.3.2.6"><span class="ltx_text" id="S5.T4.6.1.3.2.6.1" style="font-size:70%;">46.18</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.1.4.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.4.3.1"><span class="ltx_text" id="S5.T4.6.1.4.3.1.1" style="font-size:70%;">Per-channel</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.4.3.2"><span class="ltx_text" id="S5.T4.6.1.4.3.2.1" style="font-size:70%;">82.19</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.4.3.3"><span class="ltx_text" id="S5.T4.6.1.4.3.3.1" style="font-size:70%;">72.96</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.4.3.4"><span class="ltx_text" id="S5.T4.6.1.4.3.4.1" style="font-size:70%;">33.04</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.4.3.5"><span class="ltx_text" id="S5.T4.6.1.4.3.5.1" style="font-size:70%;">70.00</span></td>
<td class="ltx_td ltx_align_left" id="S5.T4.6.1.4.3.6"><span class="ltx_text" id="S5.T4.6.1.4.3.6.1" style="font-size:70%;">72.27</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.1.5.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.5.4.1"><span class="ltx_text" id="S5.T4.6.1.5.4.1.1" style="font-size:70%;">Mean Division</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.5.4.2"><span class="ltx_text" id="S5.T4.6.1.5.4.2.1" style="font-size:70%;">82.83</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.5.4.3"><span class="ltx_text" id="S5.T4.6.1.5.4.3.1" style="font-size:70%;">72.79</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.5.4.4"><span class="ltx_text" id="S5.T4.6.1.5.4.4.1" style="font-size:70%;">32.52</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.5.4.5"><span class="ltx_text" id="S5.T4.6.1.5.4.5.1" style="font-size:70%;">71.19</span></td>
<td class="ltx_td ltx_align_left" id="S5.T4.6.1.5.4.6"><span class="ltx_text" id="S5.T4.6.1.5.4.6.1" style="font-size:70%;">72.62</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.1.6.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.6.5.1"><span class="ltx_text" id="S5.T4.6.1.6.5.1.1" style="font-size:70%;">Median + MAD</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.6.5.2"><span class="ltx_text" id="S5.T4.6.1.6.5.2.1" style="font-size:70%;">77.93</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.6.5.3"><span class="ltx_text" id="S5.T4.6.1.6.5.3.1" style="font-size:70%;">68.15</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.6.5.4"><span class="ltx_text" id="S5.T4.6.1.6.5.4.1" style="font-size:70%;">29.59</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.6.5.5"><span class="ltx_text" id="S5.T4.6.1.6.5.5.1" style="font-size:70%;">67.11</span></td>
<td class="ltx_td ltx_align_left" id="S5.T4.6.1.6.5.6"><span class="ltx_text" id="S5.T4.6.1.6.5.6.1" style="font-size:70%;">68.97</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.1.7.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.7.6.1"><span class="ltx_text" id="S5.T4.6.1.7.6.1.1" style="font-size:70%;">Confidence</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.7.6.2"><span class="ltx_text" id="S5.T4.6.1.7.6.2.1" style="font-size:70%;">79.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.7.6.3"><span class="ltx_text" id="S5.T4.6.1.7.6.3.1" style="font-size:70%;">68.75</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.7.6.4"><span class="ltx_text" id="S5.T4.6.1.7.6.4.1" style="font-size:70%;">29.43</span></td>
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.6.1.7.6.5"><span class="ltx_text" id="S5.T4.6.1.7.6.5.1" style="font-size:70%;">69.30</span></td>
<td class="ltx_td ltx_align_left" id="S5.T4.6.1.7.6.6"><span class="ltx_text" id="S5.T4.6.1.7.6.6.1" style="font-size:70%;">69.32</span></td>
</tr>
<tr class="ltx_tr" id="S5.T4.6.1.8.7" style="background-color:#E6E6E6;">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S5.T4.6.1.8.7.1"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.8.7.1.1" style="font-size:70%;background-color:#E6E6E6;">Mean + 3SD</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S5.T4.6.1.8.7.2"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.8.7.2.1" style="font-size:70%;background-color:#E6E6E6;">83.22</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S5.T4.6.1.8.7.3"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.8.7.3.1" style="font-size:70%;background-color:#E6E6E6;">73.80</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S5.T4.6.1.8.7.4"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.8.7.4.1" style="font-size:70%;background-color:#E6E6E6;">33.33</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S5.T4.6.1.8.7.5"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.8.7.5.1" style="font-size:70%;background-color:#E6E6E6;">72.00</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T4.6.1.8.7.6"><span class="ltx_text ltx_font_bold" id="S5.T4.6.1.8.7.6.1" style="font-size:70%;background-color:#E6E6E6;">73.13</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">Ablation of RORQ.</span> Table <a class="ltx_ref" href="https://arxiv.org/html/2409.17020v1#S5.T4" title="TABLE IV ‣ V-B Ablation Studies ‣ V EXPERIMENTS ‣ PTQ4RIS: Post-Training Quantization for Referring Image Segmentation"><span class="ltx_text ltx_ref_tag">IV</span></a> shows the results of using different quantization methods in <span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.2">Reorder-based Outlier-Retained Quantization</span> (RORQ). We compare per-tensor and per-channel quantization, as well as the RORQ using different computational threshold methods, including Mean Division, Median + Median Absolute Deviation (MAD), confidence level, and Mean + Three Standard Deviations (3SD). The results show that our RORQ method is better than coarse-grained quantization, and the threshold calculation method we used has the best performance.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span class="ltx_text ltx_font_smallcaps" id="S6.1.1">CONCLUSION</span>
</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we propose a novel PTQ scheme specifically designed for the RIS task, called <span class="ltx_text ltx_font_bold" id="S6.p1.1.1">PTQ4RIS</span>, aiming at enabling the deployment of large multi-modal models on edge devices. We analyze the data distribution and network structure of various modules and develop tailored quantization strategies for different components. Specifically, we propose the <span class="ltx_text ltx_font_bold" id="S6.p1.1.2">Dual-Region Quantization</span> (DRO) for visual encoder and the <span class="ltx_text ltx_font_bold" id="S6.p1.1.3">Reorder-based Outlier-Retained Quantization</span> (RORQ) for text encoder. The proposed PTQ4RIS method achieve superior performance under 8-bit quantization, and even under 6-bit and 4-bit settings, where other advanced methods experience significant performance degradation. We hope our approach can advance the development of RIS tasks on robotics. In the future, we will explore lower-bit quantization methods to further investigate the practical application potential of RIS model on robotic systems.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Z. Yang, J. Wang, Y. Tang, K. Chen, H. Zhao, and P. H. Torr, “Semantics-aware dynamic localization and refinement for referring image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, vol. 37, no. 3, 2023, pp. 3222–3230.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
P.-L. Guhur, S. Chen, R. G. Pinel, M. Tapaswi, I. Laptev, and C. Schmid, “Instruction-driven history-aware policies for robotic manipulations,” in <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Conference on Robot Learning</em>, 2023, pp. 175–187.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
C. Lynch, A. Wahid, J. Tompson, T. Ding, J. Betker, R. Baruch, T. Armstrong, and P. Florence, “Interactive language: Talking to robots in real time,” <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">IEEE Robotics and Automation Letters</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
L. Ji, Y. Du, Y. Dang, W. Gao, and H. Zhang, “A survey of methods for addressing the challenges of referring image segmentation,” <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Neurocomputing</em>, vol. 583, p. 127599, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
D. An, Y. Qi, Y. Li, Y. Huang, L. Wang, T. Tan, and J. Shao, “Bevbert: Multimodal map pre-training for language-guided navigation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2023, pp. 2737–2748.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Z. Yang, J. Wang, Y. Tang, K. Chen, H. Zhao, and P. H. Torr, “Lavt: Language-aware vision transformer for referring image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2022, pp. 18 155–18 165.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Z. Zhang, Y. Zhu, J. Liu, X. Liang, and W. Ke, “Coupalign: Coupling word-pixel with sentence-mask alignments for referring image segmentation,” <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Advances in Neural Information Processing Systems</em>, vol. 35, pp. 14 729–14 742, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
S. Ouyang, H. Wang, S. Xie, Z. Niu, R. Tong, Y.-W. Chen, and L. Lin, “Slvit: Scale-wise language-guided vision transformer for referring image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the Thirty-Second International Joint Conference on Artificial Intelligence</em>, 2023, pp. 1294–1302.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
A. M. Hafiz and G. M. Bhat, “A survey on instance segmentation: state of the art,” <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">International journal of multimedia information retrieval</em>, vol. 9, no. 3, pp. 171–189, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S. Hao, Y. Zhou, and Y. Guo, “A brief survey on semantic segmentation with deep learning,” <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Neurocomputing</em>, vol. 406, pp. 302–321, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
H. Ding, C. Liu, S. Wang, and X. Jiang, “Vision-language transformer and query generation for referring segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2021, pp. 16 321–16 330.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Z. Yuan, C. Xue, Y. Chen, Q. Wu, and G. Sun, “Ptq4vit: Post-training quantization for vision transformers with twin uniform quantization,” in <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">European conference on computer vision</em>, 2022, pp. 191–207.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Z. Li, J. Xiao, L. Yang, and Q. Gu, “Repq-vit: Scale reparameterization for post-training quantization of vision transformers,” in <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2023, pp. 17 227–17 236.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Y. Tang, Y. Wang, J. Guo, Z. Tu, K. Han, H. Hu, and D. Tao, “A survey on transformer compression,” <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2402.05964</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
S. K. Esser, J. L. McKinstry, D. Bablani, R. Appuswamy, and D. S. Modha, “Learned step size quantization,” <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">arXiv preprint arXiv:1902.08153</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Y. Nahshan, B. Chmiel, C. Baskin, E. Zheltonozhskii, R. Banner, A. M. Bronstein, and A. Mendelson, “Loss aware post-training quantization,” <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Machine Learning</em>, vol. 110, no. 11, pp. 3245–3262, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Y. Li, R. Gong, X. Tan, Y. Yang, P. Hu, Q. Zhang, F. Yu, W. Wang, and S. Gu, “Brecq: Pushing the limit of post-training quantization by block reconstruction,” <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2102.05426</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
X. Wei, R. Gong, Y. Li, X. Liu, and F. Yu, “Qdrop: Randomly dropping quantization for extremely low-bit post-training quantization,” <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2203.05740</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Y. Lin, T. Zhang, P. Sun, Z. Li, and S. Zhou, “Fq-vit: Post-training quantization for fully quantized vision transformer,” <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2111.13824</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
S. Zhou, L. Li, X. Zhang, B. Zhang, S. Bai, M. Sun, Z. Zhao, X. Lu, and X. Chu, “Lidar-ptq: Post-training quantization for point cloud 3d object detection,” in <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">The Twelfth International Conference on Learning Representations</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Y. Ding, H. Qin, Q. Yan, Z. Chai, J. Liu, X. Wei, and X. Liu, “Towards accurate post-training quantization for vision transformer,” in <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 30th ACM international conference on multimedia</em>, 2022, pp. 5380–5388.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
G. Xiao, J. Lin, M. Seznec, H. Wu, J. Demouth, and S. Han, “Smoothquant: Accurate and efficient post-training quantization for large language models,” in <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">International Conference on Machine Learning</em>, 2023, pp. 38 087–38 099.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
E. Frantar, S. Ashkboos, T. Hoefler, and D. Alistarh, “Gptq: Accurate post-training quantization for generative pre-trained transformers,” in <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">The Eleventh International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
R. Hu, M. Rohrbach, and T. Darrell, “Segmentation from natural language expressions,” in <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Computer Vision–ECCV 2016: 14th European Conference, Amsterdam, The Netherlands, October 11–14, 2016, Proceedings, Part I 14</em>, 2016, pp. 108–124.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
K. He, X. Zhang, S. Ren, and J. Sun, “Deep residual learning for image recognition,” in <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 2016, pp. 770–778.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
K. Greff, R. K. Srivastava, J. Koutník, B. R. Steunebrink, and J. Schmidhuber, “Lstm: A search space odyssey,” <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">IEEE transactions on neural networks and learning systems</em>, vol. 28, no. 10, pp. 2222–2232, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
C. Liu, Z. Lin, X. Shen, J. Yang, X. Lu, and A. Yuille, “Recurrent multimodal interaction for referring image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">Proceedings of the IEEE international conference on computer vision</em>, 2017, pp. 1271–1280.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
E. Margffoy-Tuay, J. C. Pérez, E. Botero, and P. Arbeláez, “Dynamic multimodal instance segmentation guided by natural language queries,” in <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the European Conference on Computer Vision (ECCV)</em>, 2018, pp. 630–645.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
R. Li, K. Li, Y.-C. Kuo, M. Shu, X. Qi, X. Shen, and J. Jia, “Referring image segmentation via recurrent refinement networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition</em>, 2018, pp. 5745–5753.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
L. Yu, Z. Lin, X. Shen, J. Yang, X. Lu, M. Bansal, and T. L. Berg, “Mattnet: Modular attention network for referring expression comprehension,” in <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 2018, pp. 1307–1315.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Z. Hu, G. Feng, J. Sun, L. Zhang, and H. Lu, “Bi-directional relationship inferring network for referring image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2020, pp. 4424–4433.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
S. Huang, T. Hui, S. Liu, G. Li, Y. Wei, J. Han, L. Liu, and B. Li, “Referring image segmentation via cross-modal progressive comprehension,” in <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2020, pp. 10 488–10 497.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
G. Luo, Y. Zhou, R. Ji, X. Sun, J. Su, C.-W. Lin, and Q. Tian, “Cascade grouped attention network for referring expression segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">Proceedings of the 28th ACM International Conference on Multimedia</em>, 2020, pp. 1274–1282.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
H. Shi, H. Li, F. Meng, and Q. Wu, “Key-word-aware network for referring expression image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Proceedings of the European Conference on Computer Vision (ECCV)</em>, 2018, pp. 38–54.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
L. Ye, M. Rochan, Z. Liu, and Y. Wang, “Cross-modal self-attention network for referring image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2019, pp. 10 502–10 511.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
T. Hui, S. Liu, S. Huang, G. Li, S. Yu, F. Zhang, and J. Han, “Linguistic structure guided context modeling for referring image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part X 16</em>.   Springer, 2020, pp. 59–75.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, Ł. Kaiser, and I. Polosukhin, “Attention is all you need,” <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Advances in neural information processing systems</em>, vol. 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
J. Tang, G. Zheng, C. Shi, and S. Yang, “Contrastive grouping with transformer for referring image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2023, pp. 23 570–23 580.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
N. Kim, D. Kim, C. Lan, W. Zeng, and S. Kwak, “Restr: Convolution-free referring image segmentation using transformers,” in <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2022, pp. 18 145–18 154.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
Z. Wang, Y. Lu, Q. Li, X. Tao, Y. Guo, M. Gong, and T. Liu, “Cris: Clip-driven referring image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2022, pp. 11 686–11 695.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
C. Zhu, Y. Zhou, Y. Shen, G. Luo, X. Pan, M. Lin, C. Chen, L. Cao, X. Sun, and R. Ji, “Seqtr: A simple yet universal network for visual grounding,” in <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">European Conference on Computer Vision</em>, 2022, pp. 598–615.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
J. Liu, H. Ding, Z. Cai, Y. Zhang, R. K. Satzoda, V. Mahadevan, and R. Manmatha, “Polyformer: Referring image segmentation as sequential polygon generation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2023, pp. 18 653–18 663.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Z. Xu, Z. Chen, Y. Zhang, Y. Song, X. Wan, and G. Li, “Bridging vision and language encoders: Parameter-efficient tuning for referring image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the IEEE/CVF International Conference on Computer Vision</em>, 2023, pp. 17 503–17 512.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
M. Nagel, R. A. Amjad, M. Van Baalen, C. Louizos, and T. Blankevoort, “Up or down? adaptive rounding for post-training quantization,” in <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">International Conference on Machine Learning</em>.   PMLR, 2020, pp. 7197–7206.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
J. Liu, L. Niu, Z. Yuan, D. Yang, X. Wang, and W. Liu, “Pd-quant: Post-training quantization based on prediction difference metric,” in <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, 2023, pp. 24 427–24 437.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai, T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly, <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">et al.</em>, “An image is worth 16x16 words: Transformers for image recognition at scale,” <em class="ltx_emph ltx_font_italic" id="bib.bib46.2.2">arXiv preprint arXiv:2010.11929</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Z. Liu, Y. Wang, K. Han, W. Zhang, S. Ma, and W. Gao, “Post-training quantization for vision transformer,” <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">Advances in Neural Information Processing Systems</em>, vol. 34, pp. 28 092–28 103, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
S. Kim, A. Gholami, Z. Yao, M. W. Mahoney, and K. Keutzer, “I-bert: Integer-only bert quantization,” in <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">International conference on machine learning</em>, 2021, pp. 5506–5518.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
H. Qin, Y. Ding, M. Zhang, Y. Qinghua, A. Liu, Q. Dang, Z. Liu, and X. Liu, “Bibert: Accurate fully binarized bert,” in <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Z. Liu, Y. Lin, Y. Cao, H. Hu, Y. Wei, Z. Zhang, S. Lin, and B. Guo, “Swin transformer: Hierarchical vision transformer using shifted windows,” in <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Proceedings of the IEEE/CVF international conference on computer vision</em>, 2021, pp. 10 012–10 022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
J. D. M.-W. C. Kenton and L. K. Toutanova, “Bert: Pre-training of deep bidirectional transformers for language understanding,” in <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">Proceedings of naacL-HLT</em>, vol. 1, 2019, p. 2.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
M. Nagel, M. Fournarakis, R. A. Amjad, Y. Bondarenko, M. Van Baalen, and T. Blankevoort, “A white paper on neural network quantization,” <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">arXiv preprint arXiv:2106.08295</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
A. Gholami, S. Kim, Z. Dong, Z. Yao, M. W. Mahoney, and K. Keutzer, “A survey of quantization methods for efficient neural network inference,” in <em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">Low-Power Computer Vision</em>, 2022, pp. 291–326.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
L. Yu, P. Poirson, S. Yang, A. C. Berg, and T. L. Berg, “Modeling context in referring expressions,” in <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">Computer Vision–ECCV 2016: 14th European Conference, Amsterdam, The Netherlands, October 11-14, 2016, Proceedings, Part II 14</em>, 2016, pp. 69–85.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_tag_bibitem">[55]</span>
<span class="ltx_bibblock">
J. Mao, J. Huang, A. Toshev, O. Camburu, A. L. Yuille, and K. Murphy, “Generation and comprehension of unambiguous object descriptions,” in <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 2016, pp. 11–20.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_tag_bibitem">[56]</span>
<span class="ltx_bibblock">
R. Li, Y. Wang, F. Liang, H. Qin, J. Yan, and R. Fan, “Fully quantized network for object detection,” in <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2019, pp. 2810–2819.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_tag_bibitem">[57]</span>
<span class="ltx_bibblock">
Y. Choukroun, E. Kravchik, F. Yang, and P. Kisilev, “Low-bit quantization of neural networks for efficient inference,” in <em class="ltx_emph ltx_font_italic" id="bib.bib57.1.1">2019 IEEE/CVF International Conference on Computer Vision Workshop (ICCVW)</em>.   IEEE, 2019, pp. 3009–3018.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 25 15:12:51 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
