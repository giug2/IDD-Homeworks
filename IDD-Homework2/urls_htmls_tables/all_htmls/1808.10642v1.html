<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1808.10642] The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora</title><meta property="og:description" content="The use of spreadsheets in industry is widespread. Companies base decisions on information coming from spreadsheets. Unfortunately, spreadsheets are error-prone and this increases the risk that companies base their dec…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1808.10642">

<!--Generated on Fri Mar 15 22:27:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Bas Jansen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Delft University of Technology
<br class="ltx_break">Email: b.jansen@tudelft.nl
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Felienne Hermans
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">Delft University of Technology
<br class="ltx_break">Email: f.f.j.hermans@tudelft.nl
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">The use of spreadsheets in industry is widespread. Companies base decisions on information coming from spreadsheets. Unfortunately, spreadsheets are error-prone and this increases the risk that companies base their decisions on inaccurate information, which can lead to incorrect decisions and loss of money. In general, spreadsheet research is aimed to reduce the error-proneness of spreadsheets. Most research is concentrated on the use of formulas. However, there are other constructions in spreadsheets, like charts, pivot tables, and array formulas, that are also used to present decision support information to the user. There is almost no research about how these constructions are used. To improve spreadsheet quality it is important to understand how spreadsheets are used and to obtain a complete understanding, the use of charts, pivot tables, and array formulas should be included in research. In this paper, we analyze two popular spreadsheet corpora: Enron and EUSES on the use of the aforementioned constructions.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The use of spreadsheets in industry is widespread. It is estimated that 90% of all analysts use spreadsheets for their calculations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and 95% of US firms use spreadsheets in some form of financial reporting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. This reporting and the calculations of annalists in spreadsheets are used by companies to make decisions. Unfortunately, spreadsheets are known to be error-prone <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. This increases the risk that companies make decisions that are based on inaccurate information which can lead to incorrect decisions and loss of money<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>http://www.eusprig.org/horror-stories.htm</span></span></span>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">A substantial part of current spreadsheet research is focused on improving the quality of spreadsheets by applying software engineering methods to them like testing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, reverse engineering <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, code smells <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, and refactoring <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. This research has in common that it concentrates on spreadsheet formulas. However, there are other constructions in spreadsheets like charts, pivot tables, and array formulas, that are also used to present decision support information to the user of the spreadsheet. We do not know how widespread the use of these constructions are and if they are somehow related to the error-proneness of spreadsheets. There is almost no research on this topic. The only study we found is the paper of Fisher and Rothermel in which they introduce the EUSES corpus. They counted the number of spreadsheets that contained charts.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To improve the overall quality of spreadsheets, we need to understand how spreadsheets are used in industry, and to obtain a complete understanding we should include constructions like charts, pivot table and array formulas in our research. Therefore, in this short paper, we analyze two popular spreadsheet corpora: Enron <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and EUSES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> on the use of charts, pivot tables, and array formulas.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The contributions of this paper are: 1) a tool that is capable of analyzing properties of charts, pivot tables, and array formulas in Excel files and 2) an analysis of the use of charts, pivot tables, and array formulas in the EUSES and Enron corpora.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We organize the remainder of this paper in the following way. In the next section, we describe the approach that was used to analyze the spreadsheets. In Section <a href="#S3" title="III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> we present the results of the analysis. Related work is discussed in Section <a href="#S4" title="IV Related Work ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> and we end the paper with the concluding remarks in Section <a href="#S5" title="V Concluding Remarks ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Approach and Tool</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this study we use two popular spreadsheet corpora: EUSES <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and Enron <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. In previous work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> we used the Spreadsheet Scantool, developed at Delft University of Technology. It utilizes the Gembox library to read spreadsheets. Unfortunately, Gembox is not able to analyze charts, pivot tables or array formulas. As a result, we developed a new Analyzer in Visual Basic for Applications (VBA) that is able to access the full Excel object model. We made the VBA code together with instructions about how to use it, available on Github<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://github.com/HeerBommel/SpreadsheetExplorer.git</span></span></span></span>. With the Analyzer, we collect several metrics about the use of charts, pivot tables, and array formulas in spreadsheets in the aforementioned corpora.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">For charts, we counted the number of spreadsheets that contained at least one chart and the total number of charts in the corpus. For each chart, we determined the chart type. In Excel there are 73 different chart types<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlcharttype-enumeration-excel</span></span></span>. However, most chart types are a variation of their base type. For example, the ‘radar’, ‘filled radar’ and ‘radar with data markers’ all belong to the category of radar charts. In our analysis, we mapped the actual chart type to its category.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Also for pivot tables, we counted the number of spreadsheets that contained at least one pivot table. Next, for each pivot table we analyzed:</p>
<ul id="S2.I1" class="ltx_itemize">
<li id="S2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i1.p1" class="ltx_para">
<p id="S2.I1.i1.p1.1" class="ltx_p">the size: by counting the number of rows and columns of the underlying dataset</p>
</div>
</li>
<li id="S2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i2.p1" class="ltx_para">
<p id="S2.I1.i2.p1.1" class="ltx_p">the number of calculated fields: calculated fields are formulas that can refer to other fields in the pivot table</p>
</div>
</li>
<li id="S2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i3.p1" class="ltx_para">
<p id="S2.I1.i3.p1.1" class="ltx_p">the number of calculated items: calculated items are formulas that can refer to other items within a specific pivot field</p>
</div>
</li>
<li id="S2.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i4.p1" class="ltx_para">
<p id="S2.I1.i4.p1.1" class="ltx_p">the aggregation functions used</p>
</div>
</li>
<li id="S2.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S2.I1.i5.p1" class="ltx_para">
<p id="S2.I1.i5.p1.1" class="ltx_p">the number of pivot tables per worksheet</p>
</div>
</li>
</ul>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">With respect to array formulas, we counted the number of spreadsheets that contained at least one array formula and we analyzed all array formulas to obtain a better understanding of why they are used.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Results</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we will present the results of our analysis. The spreadsheets from both the Enron and the EUSES corpus were scanned for the usage of charts, pivot tables, and array formulas. For each construct, a more detailed analysis was executed to gain more insight into how they were used.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Charts</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Table <a href="#S3.T1" title="TABLE I ‣ III-A Charts ‣ III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> shows the total number of spreadsheets we have analyzed. Some of the files were password protected, corrupted or otherwise unreadable and we have excluded them from the study (25 files in EUSES and 130 in the Enron dataset). Charts are not rare but the majority of spreadsheets do not contain any charts. They occur more in the Enron spreadsheets. This could be an indication that charts are used more frequently in an industrial setting.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Number of spreadsheets with and without charts</figcaption>
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S3.T1.1.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">EUSES</th>
<th id="S3.T1.1.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">%</th>
<th id="S3.T1.1.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">Enron</th>
<th id="S3.T1.1.1.1.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.1.2.1" class="ltx_tr">
<th id="S3.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Charts</th>
<td id="S3.T1.1.2.1.2" class="ltx_td ltx_align_right ltx_border_t">340</td>
<td id="S3.T1.1.2.1.3" class="ltx_td ltx_align_right ltx_border_t">8%</td>
<td id="S3.T1.1.2.1.4" class="ltx_td ltx_align_right ltx_border_t">1,721</td>
<td id="S3.T1.1.2.1.5" class="ltx_td ltx_align_right ltx_border_t">11%</td>
</tr>
<tr id="S3.T1.1.3.2" class="ltx_tr">
<th id="S3.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">No Charts</th>
<td id="S3.T1.1.3.2.2" class="ltx_td ltx_align_right">4,133</td>
<td id="S3.T1.1.3.2.3" class="ltx_td ltx_align_right">92%</td>
<td id="S3.T1.1.3.2.4" class="ltx_td ltx_align_right">14,078</td>
<td id="S3.T1.1.3.2.5" class="ltx_td ltx_align_right">89%</td>
</tr>
<tr id="S3.T1.1.4.3" class="ltx_tr">
<th id="S3.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t">Total</th>
<td id="S3.T1.1.4.3.2" class="ltx_td ltx_align_right ltx_border_b ltx_border_t">4,473</td>
<td id="S3.T1.1.4.3.3" class="ltx_td ltx_align_right ltx_border_b ltx_border_t">100%</td>
<td id="S3.T1.1.4.3.4" class="ltx_td ltx_align_right ltx_border_b ltx_border_t">15,799</td>
<td id="S3.T1.1.4.3.5" class="ltx_td ltx_align_right ltx_border_b ltx_border_t">100%</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">Within Excel there are two ways to create a chart: 1) the chart is created as a special type of worksheet, this is called a Chart Sheet or 2) the chart is embedded on an existing worksheet. Table <a href="#S3.T2" title="TABLE II ‣ III-A Charts ‣ III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> presents the occurrence of the two types in both corpora. When Fisher and Rothermel introduced the EUSES corpus, they stated that 105 of the 4,498 spreadsheets contained charts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. We found a different number. According to our analysis, there are 340 spreadsheets that contain charts. The difference is caused by the two different ways a chart can be created. Fisher and Rothermel only counted the chart sheets, while our analysis also included the embedded charts.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>The use of Chart Sheets vs Embedded Charts</figcaption>
<table id="S3.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.1.1.1" class="ltx_tr">
<th id="S3.T2.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t"></th>
<th id="S3.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">EUSES</th>
<th id="S3.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="2">Enron</th>
</tr>
<tr id="S3.T2.1.2.2" class="ltx_tr">
<th id="S3.T2.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r">Type</th>
<th id="S3.T2.1.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column"># Charts</th>
<th id="S3.T2.1.2.2.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_r">%</th>
<th id="S3.T2.1.2.2.4" class="ltx_td ltx_align_right ltx_th ltx_th_column"># Charts</th>
<th id="S3.T2.1.2.2.5" class="ltx_td ltx_align_right ltx_th ltx_th_column">%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.1.3.1" class="ltx_tr">
<th id="S3.T2.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Sheet</th>
<td id="S3.T2.1.3.1.2" class="ltx_td ltx_align_right ltx_border_t">355</td>
<td id="S3.T2.1.3.1.3" class="ltx_td ltx_align_right ltx_border_r ltx_border_t">25%</td>
<td id="S3.T2.1.3.1.4" class="ltx_td ltx_align_right ltx_border_t">1,149</td>
<td id="S3.T2.1.3.1.5" class="ltx_td ltx_align_right ltx_border_t">13%</td>
</tr>
<tr id="S3.T2.1.4.2" class="ltx_tr">
<th id="S3.T2.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Embedded</th>
<td id="S3.T2.1.4.2.2" class="ltx_td ltx_align_right">1,090</td>
<td id="S3.T2.1.4.2.3" class="ltx_td ltx_align_right ltx_border_r">75%</td>
<td id="S3.T2.1.4.2.4" class="ltx_td ltx_align_right">7,686</td>
<td id="S3.T2.1.4.2.5" class="ltx_td ltx_align_right">87%</td>
</tr>
<tr id="S3.T2.1.5.3" class="ltx_tr">
<th id="S3.T2.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r">Total</th>
<td id="S3.T2.1.5.3.2" class="ltx_td ltx_align_right ltx_border_b">1,445</td>
<td id="S3.T2.1.5.3.3" class="ltx_td ltx_align_right ltx_border_b ltx_border_r">100%</td>
<td id="S3.T2.1.5.3.4" class="ltx_td ltx_align_right ltx_border_b">8,835</td>
<td id="S3.T2.1.5.3.5" class="ltx_td ltx_align_right ltx_border_b">100%</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">Tables <a href="#S3.T3" title="TABLE III ‣ III-A Charts ‣ III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> and <a href="#S3.T4" title="TABLE IV ‣ III-A Charts ‣ III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a> show the different chart types that were used in both corpora. The most frequently used type is the column chart. Other popular types in both corpora are the line chart and the pie chart. Notable differences between the two corpora are the occurrence of the mixed and scatter chart types. The scatter chart is used frequently in the EUSES corpus (22%), but less frequently in the Enron set (2%). The opposite is true for the mixed chart type: it is frequently used within Enron but hardly in the EUSES set. A mixed chart type means that either two y-axes are used or there are two or more data series that use a different chart type (for example the combination of a line and a column chart), see Figure <a href="#S3.F1" title="Figure 1 ‣ III-A Charts ‣ III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> for an example.</p>
</div>
<figure id="S3.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Overview of used chart types in EUSES</figcaption>
<table id="S3.T3.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T3.1.1.1" class="ltx_tr">
<th id="S3.T3.1.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_t">Rank</th>
<th id="S3.T3.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Chart Type</th>
<th id="S3.T3.1.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_t"># Charts</th>
<th id="S3.T3.1.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T3.1.2.1" class="ltx_tr">
<th id="S3.T3.1.2.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T3.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">Column</td>
<th id="S3.T3.1.2.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">515</th>
<td id="S3.T3.1.2.1.4" class="ltx_td ltx_align_right ltx_border_t">35.6%</td>
</tr>
<tr id="S3.T3.1.3.2" class="ltx_tr">
<th id="S3.T3.1.3.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">2</th>
<td id="S3.T3.1.3.2.2" class="ltx_td ltx_align_left">Scatter</td>
<th id="S3.T3.1.3.2.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">322</th>
<td id="S3.T3.1.3.2.4" class="ltx_td ltx_align_right">22.3%</td>
</tr>
<tr id="S3.T3.1.4.3" class="ltx_tr">
<th id="S3.T3.1.4.3.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">3</th>
<td id="S3.T3.1.4.3.2" class="ltx_td ltx_align_left">Line</td>
<th id="S3.T3.1.4.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">258</th>
<td id="S3.T3.1.4.3.4" class="ltx_td ltx_align_right">17.9%</td>
</tr>
<tr id="S3.T3.1.5.4" class="ltx_tr">
<th id="S3.T3.1.5.4.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">4</th>
<td id="S3.T3.1.5.4.2" class="ltx_td ltx_align_left">Pie</td>
<th id="S3.T3.1.5.4.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">139</th>
<td id="S3.T3.1.5.4.4" class="ltx_td ltx_align_right">9.6%</td>
</tr>
<tr id="S3.T3.1.6.5" class="ltx_tr">
<th id="S3.T3.1.6.5.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">5</th>
<td id="S3.T3.1.6.5.2" class="ltx_td ltx_align_left">Bar</td>
<th id="S3.T3.1.6.5.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">125</th>
<td id="S3.T3.1.6.5.4" class="ltx_td ltx_align_right">8.7%</td>
</tr>
<tr id="S3.T3.1.7.6" class="ltx_tr">
<th id="S3.T3.1.7.6.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">6</th>
<td id="S3.T3.1.7.6.2" class="ltx_td ltx_align_left">Mixed</td>
<th id="S3.T3.1.7.6.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">55</th>
<td id="S3.T3.1.7.6.4" class="ltx_td ltx_align_right">3.8%</td>
</tr>
<tr id="S3.T3.1.8.7" class="ltx_tr">
<th id="S3.T3.1.8.7.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">7</th>
<td id="S3.T3.1.8.7.2" class="ltx_td ltx_align_left">Surface</td>
<th id="S3.T3.1.8.7.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">15</th>
<td id="S3.T3.1.8.7.4" class="ltx_td ltx_align_right">1.0%</td>
</tr>
<tr id="S3.T3.1.9.8" class="ltx_tr">
<th id="S3.T3.1.9.8.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">8</th>
<td id="S3.T3.1.9.8.2" class="ltx_td ltx_align_left">Area</td>
<th id="S3.T3.1.9.8.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">13</th>
<td id="S3.T3.1.9.8.4" class="ltx_td ltx_align_right">0.9%</td>
</tr>
<tr id="S3.T3.1.10.9" class="ltx_tr">
<th id="S3.T3.1.10.9.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">9</th>
<td id="S3.T3.1.10.9.2" class="ltx_td ltx_align_left">Stock</td>
<th id="S3.T3.1.10.9.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">2</th>
<td id="S3.T3.1.10.9.4" class="ltx_td ltx_align_right">0.1%</td>
</tr>
<tr id="S3.T3.1.11.10" class="ltx_tr">
<th id="S3.T3.1.11.10.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b">10</th>
<td id="S3.T3.1.11.10.2" class="ltx_td ltx_align_left ltx_border_b">Radar</td>
<th id="S3.T3.1.11.10.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b">1</th>
<td id="S3.T3.1.11.10.4" class="ltx_td ltx_align_right ltx_border_b">0.1%</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>Overview of used chart types in Enron</figcaption>
<table id="S3.T4.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T4.1.1.1" class="ltx_tr">
<th id="S3.T4.1.1.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_t">Rank</th>
<th id="S3.T4.1.1.1.2" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t">Chart Type</th>
<th id="S3.T4.1.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_t"># Charts</th>
<th id="S3.T4.1.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T4.1.2.1" class="ltx_tr">
<th id="S3.T4.1.2.1.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">1</th>
<td id="S3.T4.1.2.1.2" class="ltx_td ltx_align_left ltx_border_t">Column</td>
<th id="S3.T4.1.2.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">4,253</th>
<td id="S3.T4.1.2.1.4" class="ltx_td ltx_align_right ltx_border_t">48.1%</td>
</tr>
<tr id="S3.T4.1.3.2" class="ltx_tr">
<th id="S3.T4.1.3.2.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">2</th>
<td id="S3.T4.1.3.2.2" class="ltx_td ltx_align_left">Line</td>
<th id="S3.T4.1.3.2.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">2,815</th>
<td id="S3.T4.1.3.2.4" class="ltx_td ltx_align_right">31.9%</td>
</tr>
<tr id="S3.T4.1.4.3" class="ltx_tr">
<th id="S3.T4.1.4.3.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">3</th>
<td id="S3.T4.1.4.3.2" class="ltx_td ltx_align_left">Mixed</td>
<th id="S3.T4.1.4.3.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">866</th>
<td id="S3.T4.1.4.3.4" class="ltx_td ltx_align_right">9.8%</td>
</tr>
<tr id="S3.T4.1.5.4" class="ltx_tr">
<th id="S3.T4.1.5.4.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">4</th>
<td id="S3.T4.1.5.4.2" class="ltx_td ltx_align_left">Pie</td>
<th id="S3.T4.1.5.4.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">649</th>
<td id="S3.T4.1.5.4.4" class="ltx_td ltx_align_right">7.3%</td>
</tr>
<tr id="S3.T4.1.6.5" class="ltx_tr">
<th id="S3.T4.1.6.5.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">5</th>
<td id="S3.T4.1.6.5.2" class="ltx_td ltx_align_left">Scatter</td>
<th id="S3.T4.1.6.5.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">168</th>
<td id="S3.T4.1.6.5.4" class="ltx_td ltx_align_right">1.9%</td>
</tr>
<tr id="S3.T4.1.7.6" class="ltx_tr">
<th id="S3.T4.1.7.6.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">6</th>
<td id="S3.T4.1.7.6.2" class="ltx_td ltx_align_left">Area</td>
<th id="S3.T4.1.7.6.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">67</th>
<td id="S3.T4.1.7.6.4" class="ltx_td ltx_align_right">0.8%</td>
</tr>
<tr id="S3.T4.1.8.7" class="ltx_tr">
<th id="S3.T4.1.8.7.1" class="ltx_td ltx_align_right ltx_th ltx_th_row">7</th>
<td id="S3.T4.1.8.7.2" class="ltx_td ltx_align_left">Bar</td>
<th id="S3.T4.1.8.7.3" class="ltx_td ltx_align_right ltx_th ltx_th_row">11</th>
<td id="S3.T4.1.8.7.4" class="ltx_td ltx_align_right">0.1%</td>
</tr>
<tr id="S3.T4.1.9.8" class="ltx_tr">
<th id="S3.T4.1.9.8.1" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b">8</th>
<td id="S3.T4.1.9.8.2" class="ltx_td ltx_align_left ltx_border_b">Surface</td>
<th id="S3.T4.1.9.8.3" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b">6</th>
<td id="S3.T4.1.9.8.4" class="ltx_td ltx_align_right ltx_border_b">0.1%</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.F1" class="ltx_figure"><img src="/html/1808.10642/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="332" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Mixed chart type (Source: Enron Corpus scott_neal__38010__Helplist.xls, sheet US Gas)</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Pivot Tables</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Table <a href="#S3.T5" title="TABLE V ‣ III-B Pivot Tables ‣ III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a> shows the number of spreadsheets in both corpora that contain pivot tables. It shows that pivot tables are used very rarely but that they are used more frequently in the industrial Enron set than in the EUSES spreadsheets.</p>
</div>
<figure id="S3.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE V: </span>Number of Spreadsheets with Pivot Tables</figcaption>
<table id="S3.T5.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T5.1.1.1" class="ltx_tr">
<th id="S3.T5.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S3.T5.1.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">EUSES</th>
<th id="S3.T5.1.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">%</th>
<th id="S3.T5.1.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">Enron</th>
<th id="S3.T5.1.1.1.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">%</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T5.1.2.1" class="ltx_tr">
<th id="S3.T5.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Pivot</th>
<td id="S3.T5.1.2.1.2" class="ltx_td ltx_align_right ltx_border_t">19</td>
<td id="S3.T5.1.2.1.3" class="ltx_td ltx_align_right ltx_border_t">0.4%</td>
<td id="S3.T5.1.2.1.4" class="ltx_td ltx_align_right ltx_border_t">244</td>
<td id="S3.T5.1.2.1.5" class="ltx_td ltx_align_right ltx_border_t">1.5%</td>
</tr>
<tr id="S3.T5.1.3.2" class="ltx_tr">
<th id="S3.T5.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">No Pivot</th>
<td id="S3.T5.1.3.2.2" class="ltx_td ltx_align_right">4,454</td>
<td id="S3.T5.1.3.2.3" class="ltx_td ltx_align_right">99.6%</td>
<td id="S3.T5.1.3.2.4" class="ltx_td ltx_align_right">15,555</td>
<td id="S3.T5.1.3.2.5" class="ltx_td ltx_align_right">98.5%</td>
</tr>
<tr id="S3.T5.1.4.3" class="ltx_tr">
<th id="S3.T5.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t">Total</th>
<td id="S3.T5.1.4.3.2" class="ltx_td ltx_align_right ltx_border_b ltx_border_t">4,473</td>
<td id="S3.T5.1.4.3.3" class="ltx_td ltx_align_right ltx_border_b ltx_border_t">100.0%</td>
<td id="S3.T5.1.4.3.4" class="ltx_td ltx_align_right ltx_border_b ltx_border_t">15,799</td>
<td id="S3.T5.1.4.3.5" class="ltx_td ltx_align_right ltx_border_b ltx_border_t">100.0%</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VI: </span>Overview of Pivot Table Metrics</figcaption>
<table id="S3.T6.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T6.1.1.1" class="ltx_tr">
<th id="S3.T6.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<th id="S3.T6.1.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row ltx_border_t">avg. #</th>
<th id="S3.T6.1.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">avg. #</th>
<th id="S3.T6.1.1.1.4" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"># calc.</th>
<th id="S3.T6.1.1.1.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"># calc.</th>
</tr>
<tr id="S3.T6.1.2.2" class="ltx_tr">
<th id="S3.T6.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row">Corpus</th>
<th id="S3.T6.1.2.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_th_row">records</th>
<th id="S3.T6.1.2.2.3" class="ltx_td ltx_align_right ltx_th ltx_th_column">fields</th>
<th id="S3.T6.1.2.2.4" class="ltx_td ltx_align_right ltx_th ltx_th_column">items</th>
<th id="S3.T6.1.2.2.5" class="ltx_td ltx_align_right ltx_th ltx_th_column">fields</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T6.1.3.1" class="ltx_tr">
<th id="S3.T6.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">EUSES</th>
<th id="S3.T6.1.3.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_t">3,738</th>
<td id="S3.T6.1.3.1.3" class="ltx_td ltx_align_right ltx_border_t">13</td>
<td id="S3.T6.1.3.1.4" class="ltx_td ltx_align_right ltx_border_t">3</td>
<td id="S3.T6.1.3.1.5" class="ltx_td ltx_align_right ltx_border_t">0</td>
</tr>
<tr id="S3.T6.1.4.2" class="ltx_tr">
<th id="S3.T6.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b">Enron</th>
<th id="S3.T6.1.4.2.2" class="ltx_td ltx_align_right ltx_th ltx_th_row ltx_border_b">4,073</th>
<td id="S3.T6.1.4.2.3" class="ltx_td ltx_align_right ltx_border_b">28</td>
<td id="S3.T6.1.4.2.4" class="ltx_td ltx_align_right ltx_border_b">0</td>
<td id="S3.T6.1.4.2.5" class="ltx_td ltx_align_right ltx_border_b">0</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">Pivot tables can be used to analyze large datasets. Therefore, we analyzed the average size of the data tables behind the pivot tables (Table <a href="#S3.T6" title="TABLE VI ‣ III-B Pivot Tables ‣ III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a>). The maximum number of records we found is equal to the maximum number of rows up to Excel 2003 (65,535 rows). The average number of records in both datasets are comparable, but in the Enron sheets, the average number of columns (fields) in these data sets is larger. Within a pivot table, it is possible to create calculated fields or items based on other data in the table. From Table <a href="#S3.T6" title="TABLE VI ‣ III-B Pivot Tables ‣ III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a> we can observe that this functionality is hardly used.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p">The main functionality that a pivot table provides is the possibility to summarize large data sets with aggregate functions. We analyzed the use of these functions and found that, in both corpora, in more than 85% of the cases, either the function Sum or Count was used to summarize the data.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">When a pivot table is defined in Excel, by default it is created on a new worksheet. However, it is possible to create more than one pivot table on a worksheet and based on our analysis we can conclude that users tend to do so. The average number of pivot tables per worksheet ranges from 1.3 (EUSES) to 1.6 (Enron) and we found a maximum of nine pivot tables on one worksheet.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic">Array Formulas</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">Formulas in Excel always return a single value. However, with an array formula<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">https://support.office.com/en-us/article/Guidelines-and-examples-of-array-formulas-7d94a64e-3ff3-4686-9372-ecfd5caa57c7?ui=en-US&amp;rs=en-US&amp;ad=US</span></span></span></span>, it is possible to perform multiple calculations on one or more items of an array and return either a single value or multiple values. The formulas have to be entered with a special key combination (ctrl + shift + enter) and most users are unaware of their existence. Nevertheless, we checked in both corpora for array formulas and to our surprise, we found that their occurrence is similar to that of pivot tables. About 1.2% of the spreadsheets (in both corpora) contains array formulas.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">In the 250 spreadsheets that contained one or more array formulas, we found a total of 3,965 unique array formulas. We have analyzed these formulas to obtain a better understanding of why array formulas are used. Table <a href="#S3.T7" title="TABLE VII ‣ III-C Array Formulas ‣ III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VII</span></a> summarizes the results.</p>
</div>
<figure id="S3.T7" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE VII: </span>Use cases for Array Formulas</figcaption>
<table id="S3.T7.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T7.1.1.1" class="ltx_tr">
<th id="S3.T7.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t">Use case</th>
<th id="S3.T7.1.1.1.2" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t"># Formulas</th>
<th id="S3.T7.1.1.1.3" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t">% of Formulas</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T7.1.2.1" class="ltx_tr">
<th id="S3.T7.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Multiple criteria aggregation</th>
<td id="S3.T7.1.2.1.2" class="ltx_td ltx_align_right ltx_border_t">2,398</td>
<td id="S3.T7.1.2.1.3" class="ltx_td ltx_align_right ltx_border_t">60.5%</td>
</tr>
<tr id="S3.T7.1.3.2" class="ltx_tr">
<th id="S3.T7.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Array functions</th>
<td id="S3.T7.1.3.2.2" class="ltx_td ltx_align_right">690</td>
<td id="S3.T7.1.3.2.3" class="ltx_td ltx_align_right">17.4%</td>
</tr>
<tr id="S3.T7.1.4.3" class="ltx_tr">
<th id="S3.T7.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Sumproduct</th>
<td id="S3.T7.1.4.3.2" class="ltx_td ltx_align_right">455</td>
<td id="S3.T7.1.4.3.3" class="ltx_td ltx_align_right">11.5%</td>
</tr>
<tr id="S3.T7.1.5.4" class="ltx_tr">
<th id="S3.T7.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">User defined functions</th>
<td id="S3.T7.1.5.4.2" class="ltx_td ltx_align_right">264</td>
<td id="S3.T7.1.5.4.3" class="ltx_td ltx_align_right">6.7%</td>
</tr>
<tr id="S3.T7.1.6.5" class="ltx_tr">
<th id="S3.T7.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Unnecessary or erroneous</th>
<td id="S3.T7.1.6.5.2" class="ltx_td ltx_align_right">66</td>
<td id="S3.T7.1.6.5.3" class="ltx_td ltx_align_right">1.7%</td>
</tr>
<tr id="S3.T7.1.7.6" class="ltx_tr">
<th id="S3.T7.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Repeat block</th>
<td id="S3.T7.1.7.6.2" class="ltx_td ltx_align_right">47</td>
<td id="S3.T7.1.7.6.3" class="ltx_td ltx_align_right">1.2%</td>
</tr>
<tr id="S3.T7.1.8.7" class="ltx_tr">
<th id="S3.T7.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">TABLE function</th>
<td id="S3.T7.1.8.7.2" class="ltx_td ltx_align_right">45</td>
<td id="S3.T7.1.8.7.3" class="ltx_td ltx_align_right">1.1%</td>
</tr>
<tr id="S3.T7.1.9.8" class="ltx_tr">
<th id="S3.T7.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t">Total</th>
<td id="S3.T7.1.9.8.2" class="ltx_td ltx_align_right ltx_border_b ltx_border_t">3,965</td>
<td id="S3.T7.1.9.8.3" class="ltx_td ltx_align_right ltx_border_b ltx_border_t">100.0%</td>
</tr>
</tbody>
</table>
</figure>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.1" class="ltx_p">In over 60% of the cases, array formulas are used to calculate aggregated values with functions like SUM, MIN, and AVERAGE, based on multiple criteria. An example of such a formula is shown in Figure <a href="#S3.F2" title="Figure 2 ‣ III-C Array Formulas ‣ III Results ‣ The use of Charts, Pivot Tables, and Array Formulas in two Popular Spreadsheet Corpora" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/1808.10642/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="169" height="27" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Array formula for a multiple criteria SUM (Source: Enron Corpus eric_linder__9655__4_02act.xlsx, sheet Preschedule, cell I30)</figcaption>
</figure>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.1" class="ltx_p">The curly brackets indicate that the formula is an array formula. This specific use case is related to the age of both the Enron and the EUSES corpus. At the time the spreadsheets in the Enron and EUSES corpus were created, there were no functions available for conditional aggregation of values and it could only be accomplished by using an array formula or the SUMPRODUCT function. However, as from Excel 2010, Microsoft has added dedicated functions like SUMIFS, AVERAGEIFS, MINIFS, etc. for these type of calculations.</p>
</div>
<div id="S3.SS3.p5" class="ltx_para">
<p id="S3.SS3.p5.1" class="ltx_p">Another important use case for array formulas are the special array functions in Excel, like TRANSPOSE, MMULT, LINEST, FREQUENCY, and MINVERSE. Instead of returning a single value, these functions return an array as result and can only be used in an array formula.</p>
</div>
<div id="S3.SS3.p6" class="ltx_para">
<p id="S3.SS3.p6.1" class="ltx_p">Sometimes an array formula is entered as a multi-cell array formula. In such a case a group of cells gets exactly the same array formula and this formula can only be edited when the whole group is selected. The formula will calculate the result for each item in the array of cells. We grouped this use case under the category repeat block.</p>
</div>
<div id="S3.SS3.p7" class="ltx_para">
<p id="S3.SS3.p7.1" class="ltx_p">Other use cases we found were user-defined functions that are used as array formulas and what-if analyses with a data table (TABLE function <span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>https://support.office.com/en-us/article/calculate-multiple-results-by-using-a-data-table-e95e2487-6ca6-4413-ad12-77542a5ea50b</span></span></span>). Finally, we encountered a set of array formulas that were either incorrect or unnecessary. The latter meaning that the same formula would also have worked without the special array syntax.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Related Work</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Most related to our work are the papers introducing the corpora that we have analyzed, Euses <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and Enron <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. While the paper introducing EUSES describes statistics on charts too the paper on Enron does not. Another spreadsheet corpus is FUSE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. This corpus consists of almost 250,000 spreadsheets that were extracted from a public web archive with over 26 billion pages. We preferred the Enron corpus over the FUSE corpus because the Enron spreadsheets were used in an industrial setting.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Besides those two corpora, there are other smaller corpora: Two prominent corpora are the Galumpke and Wall corpora, containing 82 and 150 spreadsheets respectively, both derived from classroom experiments <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Powell and colleagues survey other corpora used in field audits, each audit examining between 1 and 30 spreadsheets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. To our knowledge, none of these corpora are publicly available.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">Furthermore, there are papers on spreadsheet metrics, which also measure properties of spreadsheets. In 2004, Bregar published a paper presenting a list of spreadsheet metrics based on software metrics <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. He, however, does not provide any justification of the metrics, nor did he present an evaluation.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Concluding Remarks</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we analyzed two popular spreadsheet corpora and focussed on the use of charts, pivot tables, and array formulas. Although the spreadsheets in both corpora are more than ten years old, we believe they still offer a valuable insight into how they are used. Especially because Microsoft did not make a lot of changes with respect to charts, pivot tables, and array formulas.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">We found that charts are used in about 10% of the spreadsheets. The most commonly used chart types are Column, Line, and Pie. Pivot tables are much rarer and only found in about 1% of the spreadsheets. In more than 85% of the cases, the data in the pivot table is summarized with the aggregate functions <em id="S5.p2.1.1" class="ltx_emph ltx_font_italic">Sum</em> and <em id="S5.p2.1.2" class="ltx_emph ltx_font_italic">Count</em>. Finally, to our surprise, the complex array formulas are used as frequently as pivot tables.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">Overall the use of charts, pivot tables, and array formulas in spreadsheets is limited. Still, they can have an impact on the error-proneness of spreadsheets. Especially pivot tables and array formulas can introduce new types of errors. A well-known problem with pivot tables is that they are not automatically refreshed when the underlying data changes, increasing the risk that the user is analyzing outdated data. Array formulas are difficult to understand and not very well known by the majority of the spreadsheet users. Because of their complexity, it is easy to make errors in these formulas. The information presented in the charts is coming from the underlying data. Errors in this data will lead to errors in charts. However, charts also can introduce their own errors. For example, Excel will in some cases automatically let the Y axis not start at zero, which could misrepresent the underlying data.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
W. Winston, “Executive education opportunities millions of analysts need
training in spreadsheet modeling, optimization, monte carlo simulation and
data analysis,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">OR MS TODAY</em>, vol. 28, no. 4, pp. 36–39, 2001.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
R. R. Panko and N. Ordway, “Sarbanes-oxley: What about all the spreadsheets?”
<em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:0804.0797</em>, 2008.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
R. R. Panko, “What we know about spreadsheet errors,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Journal of
Organizational and End User Computing (JOEUC)</em>, vol. 10, no. 2, pp. 15–21,
1998.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
K. J. Rothermel, C. R. Cook, M. Burnett, J. Schonfeld, T. R. Green, and
G. Rothermel, “Wysiwyt testing in the spreadsheet paradigm: An empirical
evaluation,” in <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Software Engineering, 2000. Proceedings of the 2000
International Conference on</em>.   IEEE,
2000, pp. 230–239.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
S. Roy, F. Hermans, and A. van Deursen, “Spreadsheet testing in practice,” in
<em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Software Analysis, Evolution and Reengineering (SANER), 2017 IEEE 24th
International Conference on</em>.   IEEE,
2017, pp. 338–348.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
F. Hermans, M. Pinzger, and A. Deursen, <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">ECOOP 2010 – Object-Oriented
Programming: 24th European Conference, Maribor, Slovenia, June 21-25, 2010.
Proceedings</em>.   Berlin, Heidelberg:
Springer Berlin Heidelberg, 2010, ch. Automatically Extracting Class Diagrams
from Spreadsheets, pp. 52–75. [Online]. Available:
<span class="ltx_ref ltx_nolink ltx_url ltx_font_typewriter ltx_ref_self">http://dx.doi.org/10.1007/978-3-642-14107-2\_4</span>

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
J. Cunha, M. Erwig, and J. Saraiva, “Automatically inferring classsheet models
from spreadsheets,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Visual Languages and Human-Centric Computing
(VL/HCC), 2010 IEEE Symposium on</em>.   IEEE, 2010, pp. 93–100.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
F. Hermans, M. Pinzger, and A. van Deursen, “Detecting and refactoring code
smells in spreadsheet formulas,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Empirical Software Engineering</em>, pp.
1–27, 2014.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
J. Cunha, J. P. Fernandes, H. Ribeiro, and J. Saraiva, “Towards a catalog of
spreadsheet smells,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Computational Science and Its
Applications–ICCSA 2012</em>.   Springer,
2012, pp. 202–216.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
F. Hermans and D. Dig, “Bumblebee: a refactoring environment for spreadsheet
formulas,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 22nd ACM SIGSOFT International
Symposium on Foundations of Software Engineering</em>.   ACM, 2014, pp. 747–750.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
S. Badame and D. Dig, “Refactoring meets spreadsheet formulas,” in
<em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Software Maintenance (ICSM), 2012 28th IEEE International Conference
on</em>.   IEEE, 2012, pp. 399–409.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
F. Hermans and E. Murphy-Hill, “Enron’s spreadsheets and related emails: A
dataset and analysis,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 37th International
Conference on Software Engineering-Volume 2</em>.   IEEE Press, 2015, pp. 7–16.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
M. Fisher and G. Rothermel, “The EUSES spreadsheet corpus: a shared resource
for supporting experimentation with spreadsheet dependability mechanisms,”
<em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ACM SIGSOFT Software Engineering Notes</em>, vol. 30, no. 4, pp. 1–5,
2005.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
B. Jansen, “Enron versus euses: A comparison of two spreadsheet corpora,” in
<em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2nd Workshop on Software Engineering Methods in
Spreadsheets, Florence, Italy</em>, 2015.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
F. Hermans, M. Pinzger, and A. Deursen, “Detecting code smells in spreadsheet
formulas,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference on Software
Maintenance (ICSM)</em>, 2012.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
B. Jansen and F. Hermans, “Code smells in spreadsheet formulas revisited on an
industrial dataset,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2015 International
Conference on Software Maintenance and Evolution</em>.   IEEE Press, 2015, pp. 372–380.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
T. Barik, K. Lubick, J. Smith, J. Slankas, and E. Murphy-Hill, “F use: a
reproducible, extendable, internet-scale corpus of spreadsheets,” in
<em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 12th Working Conference on Mining Software
Repositories</em>.   IEEE Press, 2015, pp.
486–489.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
R. R. Panko, “Two corpuses of spreadsheet errors,” in <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">System Sciences,
2000. Proceedings of the 33rd Annual Hawaii International Conference
on</em>.   IEEE, 2000, pp. 8–pp.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
S. G. Powell, K. R. Baker, and B. Lawson, “A critical review of the literature
on spreadsheet errors,” <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Decision Support Systems</em>, vol. 46, no. 1, pp.
128–138, 2008.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
A. Bregar, “Complexity metrics for spreadsheet models,” in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proc. of
EuSpRIG ’04</em>, 2004, p. 9.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1808.10641" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1808.10642" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1808.10642">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1808.10642" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1808.10643" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar 15 22:27:32 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
