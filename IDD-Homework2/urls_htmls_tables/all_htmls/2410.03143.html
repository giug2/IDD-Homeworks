<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>ECHOPulse: ECG Controlled Echocardiograms Video Generation</title>
<!--Generated on Sat Oct 12 01:21:54 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2410.03143v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S1" title="In ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S2" title="In ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>RELATED WORK</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S2.SS1" title="In 2 RELATED WORK ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Visual Tokenization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S2.SS2" title="In 2 RELATED WORK ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Video Generation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S2.SS3" title="In 2 RELATED WORK ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>ECHO Video Generation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3" title="In ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>METHODS</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.SS1" title="In 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Video Tokenization</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.SS1.SSS0.Px1" title="In 3.1 Video Tokenization ‣ 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title">Model architecture:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.SS1.SSS0.Px2" title="In 3.1 Video Tokenization ‣ 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title">Loss design:</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.SS2" title="In 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Alignment between Video and ECG Tokens</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.SS2.SSS0.Px1" title="In 3.2 Alignment between Video and ECG Tokens ‣ 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title">ECG encoder:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.SS2.SSS0.Px2" title="In 3.2 Alignment between Video and ECG Tokens ‣ 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title">Aligning ECG and video token sequences for video prediction:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.SS2.SSS0.Px3" title="In 3.2 Alignment between Video and ECG Tokens ‣ 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title">Optimization:</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.SS3" title="In 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Video Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.SS3.SSS0.Px1" title="In 3.3 Video Generation ‣ 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title">Progressive video generation with auto-regressive extrapolation:</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S4" title="In ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>EXPERIMENTS</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S4.SS0.SSS0.Px1" title="In 4 EXPERIMENTS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title">Dataset and implementations:</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S4.SS1" title="In 4 EXPERIMENTS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Video Tokenization Reconstruction Performance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S4.SS2" title="In 4 EXPERIMENTS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Video Generation Performance</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S5" title="In ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>CONCLUSION</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S6" title="In ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>LIMITATION AND FUTURE WORK</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1" title="In ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.SS1" title="In Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Reproducibility Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.SS2" title="In Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2 </span>MODEL SETUP AND HYPERPARAMETERS</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.SS2.SSS1" title="In A.2 MODEL SETUP AND HYPERPARAMETERS ‣ Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.1 </span>Video Tokenizer</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.SS2.SSS2" title="In A.2 MODEL SETUP AND HYPERPARAMETERS ‣ Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.2.2 </span>Video GENERATION TRANSFORMER</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.SS3" title="In Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.3 </span>Dataset</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">ECHOPulse: ECG Controlled Echocardiograms Video Generation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_text ltx_font_bold" id="id1.1.1">Yiwei Li<sup class="ltx_sup" id="id1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id1.1.1.1.1">1,2</span></sup></span> , <span class="ltx_text ltx_font_bold" id="id2.2.2">Sekeun Kim<sup class="ltx_sup" id="id2.2.2.1"><span class="ltx_text ltx_font_medium" id="id2.2.2.1.1">2</span></sup><span class="ltx_note ltx_role_footnotemark" id="footnotex1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex1.1.1.1">1</span></span></span></span></span></span> ,<span class="ltx_text ltx_font_bold" id="id3.3.3"> Zihao Wu<sup class="ltx_sup" id="id3.3.3.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id3.3.3.1.1">1,2</span></sup></span>, <span class="ltx_text ltx_font_bold" id="id4.4.4">Hanqi Jiang<sup class="ltx_sup" id="id4.4.4.1"><span class="ltx_text ltx_font_medium" id="id4.4.4.1.1">1</span></sup></span>, <span class="ltx_text ltx_font_bold" id="id6.6.6">Yi Pan<sup class="ltx_sup" id="id6.6.6.1"><span class="ltx_text ltx_font_medium" id="id6.6.6.1.1">1</span></sup>
<br class="ltx_break"/>Pengfei Jin<sup class="ltx_sup" id="id6.6.6.2"><span class="ltx_text ltx_font_medium" id="id6.6.6.2.1">2</span></sup></span>, <span class="ltx_text ltx_font_bold" id="id7.7.7">Sifan Song<sup class="ltx_sup" id="id7.7.7.1"><span class="ltx_text ltx_font_medium" id="id7.7.7.1.1">2</span></sup></span>, <span class="ltx_text ltx_font_bold" id="id8.8.8">Yucheng Shi<sup class="ltx_sup" id="id8.8.8.1"><span class="ltx_text ltx_font_medium" id="id8.8.8.1.1">1</span></sup></span>, 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="id9.9.9">Tianming Liu<sup class="ltx_sup" id="id9.9.9.1"><span class="ltx_text ltx_font_medium" id="id9.9.9.1.1">1</span></sup></span> , <span class="ltx_text ltx_font_bold" id="id10.10.10">Quanzheng Li<sup class="ltx_sup" id="id10.10.10.1"><span class="ltx_text ltx_font_medium" id="id10.10.10.1.1">2</span></sup><span class="ltx_note ltx_role_footnotemark" id="footnotex2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex2.1.1.1">2</span></span></span></span></span></span> , <span class="ltx_text ltx_font_bold" id="id12.12.12">Xiang Li<sup class="ltx_sup" id="id12.12.12.1"><span class="ltx_text ltx_font_medium" id="id12.12.12.1.1">2</span></sup><span class="ltx_note ltx_role_footnotemark" id="footnotex3"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_note_type">footnotemark: </span><span class="ltx_tag ltx_tag_note"><span class="ltx_text ltx_font_medium" id="footnotex3.1.1.1">2</span></span></span></span></span>
<br class="ltx_break"/><sup class="ltx_sup" id="id12.12.12.2"><span class="ltx_text ltx_font_medium" id="id12.12.12.2.1">1</span></sup></span> University of Georgia 
<br class="ltx_break"/><sup class="ltx_sup" id="id14.14.id1">2</sup>Massachusetts General Hospital and Harvard Medical School
<br class="ltx_break"/>
</span><span class="ltx_author_notes">Equal contributionCorresponding author email: xli60@mgh.harvard.edu</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id15.id1">Echocardiography (ECHO) is essential for cardiac assessments, but its video quality and interpretation heavily relies on manual expertise, leading to inconsistent results from clinical and portable devices. ECHO video generation offers a solution by improving automated monitoring through synthetic data and generating high-quality videos from routine health data. However, existing models often face high computational costs, slow inference, and rely on complex conditional prompts that require experts’ annotations. To address these challenges, we propose ECHOPulse, an ECG-conditioned ECHO video generation model. ECHOPulse introduces two key advancements: (1) it accelerates ECHO video generation by leveraging VQ-VAE tokenization and masked visual token modeling for fast decoding, and (2) it conditions on readily accessible ECG signals, which are highly coherent with ECHO videos, bypassing complex conditional prompts. To the best of our knowledge, this is the first work to use time-series prompts like ECG signals for ECHO video generation. ECHOPulse not only enables controllable synthetic ECHO data generation but also provides updated cardiac function information for disease monitoring and prediction beyond ECG alone. Evaluations on three public and private datasets demonstrate state-of-the-art performance in ECHO video generation across both qualitative and quantitative measures. Additionally, ECHOPulse can be easily generalized to other modality generation tasks, such as cardiac MRI, fMRI, and 3D CT generation. Demo can seen from <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/levyisthebest/ECHOPulse_Prelease" title="">https://github.com/levyisthebest/ECHOPulse_Prelease</a>.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para ltx_noindent" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Echocardiography (ECHO) is widely used for evaluating heart function and structure due to its real-time, non-invasive, and radiation-free nature <cite class="ltx_cite ltx_citemacro_citep">(SF, <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib33" title="">2009</a>; Otto, <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib24" title="">2013</a>; Omar et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib23" title="">2016</a>)</cite>. Recent advancements in deep learning have shown promising performance in computer-aided cardiac diagnosis <cite class="ltx_cite ltx_citemacro_citep">(Oktay et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib22" title="">2018</a>; Smistad et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib34" title="">2020</a>; Kim et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib15" title="">2021</a>)</cite>. However, echocardiography depends on experienced operators, leading to insufficient data for training robust models. Moreover, annotating ECHO data demands expert knowledge, making the process time-consuming and sometimes unavailable <cite class="ltx_cite ltx_citemacro_citep">(Leclerc et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib16" title="">2019a</a>; Lu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib20" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">One promising avenue is the use of video generation models to synthesize ECHO videos. In general domains, text-to-video (T2V) models <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib43" title="">2023</a>; Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib46" title="">2024</a>; Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib40" title="">2024</a>; Villegas et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib39" title="">2022</a>)</cite> have been successful in creating realistic videos from text prompts. However, applying these models to the medical field remains challenging due to the necessity for precise control over anatomical structures, which cannot vary freely as in general domain. Previous controllable ECHO generation frameworks <cite class="ltx_cite ltx_citemacro_citep">(Ashrafian et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib3" title="">2024</a>; Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib47" title="">2024</a>; Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib42" title="">2024a</a>)</cite> rely on carefully curated conditional prompts such as segmentation masks, clinical text, or optical flow, which only experts can provide and fail to incorporate time-series information. Moreover, these diffusion-based models suffer from high computational costs and slow inference. Therefore, a fast and controllable ECHO generation framework without the need for expert prior conditions is highly desirable <cite class="ltx_cite ltx_citemacro_citep">(Reynaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib31" title="">2024</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Inspired by these motivations, we propose ECHOPulse, an ECHO video generation model conditioned on electrocardiogram (ECG) signals. ECG data are readily accessible in both clinical and outpatient settings <cite class="ltx_cite ltx_citemacro_citep">(Al-Khatib et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib1" title="">2018</a>)</cite>, and even from personal wearable devices <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib19" title="">2013</a>)</cite>. Since ECGs are typically the first step in evaluating cardiac issues before performing further echocardiography <cite class="ltx_cite ltx_citemacro_citep">(Al-Khatib et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib1" title="">2018</a>; Del Torto et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib7" title="">2022</a>)</cite>, they serve as a natural and intrinsic prior for coherent ECHO video generation. By leveraging ECG signals, we can generate ECHO videos without the need for complex conditional prompts or expert annotations. To the best of our knowledge, this is the first work to utilize time-series prompt for ECHO video generation. In clinical scenarios where prior ECHO images exist, ECHOPulse can be co-conditioned on both ECG and prior imaging to provide updated cardiac function information, such as left ventricular ejection fraction (LVEF/EF) for cardiac disease monitoring and prediction <cite class="ltx_cite ltx_citemacro_citep">(Ponikowski et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib26" title="">2016</a>)</cite>, enhancing computer-aided diagnosis beyond ECG alone.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Our main contributions are:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We propose ECHOPulse, a fast and controllable ECHO video generation framework conditioned on ECG for the first time, which also shows potential to generalize to other modality generation tasks, such as cardiac MRI, fMRI, and 3D CT generation.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">By utilizing readily available ECG data for controllable and precise ECHO generation personalized for each patient, we bypass the need for paired expert annotations, showing potential for scaling to larger video datasets.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Evaluations on two public and one private dataset demonstrate that our framework achieves SOTA performance in both quantitative and qualitative metrics.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para ltx_noindent" id="S1.I1.i4.p1">
<p class="ltx_p" id="S1.I1.i4.p1.1">We collect a synthetic ECHO video dataset consisting of ECHO videos paired with ECG signals and segmentation masks, which we plan to release to enable researchers to evaluate the practicality and reliability of synthetic ECHO video generation.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>RELATED WORK</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Visual Tokenization</h3>
<div class="ltx_para ltx_noindent" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Visual Tokenization is crucial for converting images or videos into discrete tokens that can be processed by language models. One of the foundational approaches to visual tokenization is VQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Van Den Oord &amp; Vinyals, <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib37" title="">2017</a>)</cite>, which uses a convolutional neural network (CNN) to encode visual data, followed by a vector quantization (VQ) step. This method assigns each embedding to the closest entry in a codebook, converting continuous embeddings into discrete tokens. Video tokenization presents greater challenges, and VQGAN has been adapted to address these difficulties <cite class="ltx_cite ltx_citemacro_citep">(Villegas et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib39" title="">2022</a>; Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib43" title="">2023</a>)</cite>. The current state-of-the-art in video tokenization is MAGVIT2 <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib44" title="">2024b</a>)</cite>, which employs an enhanced 3D architecture, leverages an inflation technique for initialization based on image pre-training, and incorporates robust training losses to improve performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Video Generation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Recent video generation advances have increasingly focused on discrete representations to manage the high dimensionality of video data. Models like VQ-VAE <cite class="ltx_cite ltx_citemacro_citep">(Van Den Oord &amp; Vinyals, <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib37" title="">2017</a>)</cite> convert continuous video frames into discrete vector indices, reducing data complexity and enabling more efficient sequence modeling. Phenaki <cite class="ltx_cite ltx_citemacro_citep">(Villegas et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib39" title="">2022</a>)</cite> uses a causal Transformer with discrete temporal embeddings for variable-length video generation, while Masked Generative Transformer <cite class="ltx_cite ltx_citemacro_citep">(Chang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib6" title="">2022</a>)</cite> leverages discrete techniques for sparse spatiotemporal relationships. These studies highlight the advantages of discrete representations in balancing complexity and efficiency, especially for long sequences. Moreover, autoregressive models with discrete tokens <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib45" title="">2022</a>)</cite> generate diverse, high-quality content, and discrete diffusion models <cite class="ltx_cite ltx_citemacro_citep">(Austin et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib4" title="">2021</a>)</cite> extend the diffusion process to the discrete symbol space, enhancing scalability and long-range video modeling.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>ECHO Video Generation</h3>
<div class="ltx_para ltx_noindent" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Ultrasound imaging is a non-invasive, real-time, and portable medical imaging modality that plays a crucial role in clinical diagnostics. However, the quality and interpretation of ultrasound images heavily depend on the operator’s expertise, and obtaining high-quality ultrasound datasets is challenging. Consequently, the generation of ultrasound images has attracted considerable attention in recent years. Recent works, such as HeartBeat <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib47" title="">2024</a>)</cite>, have leveraged deep learning techniques like diffusion models <cite class="ltx_cite ltx_citemacro_citep">(Ho et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib12" title="">2020</a>)</cite> to achieve controllable synthesis of echocardiograms. By incorporating multimodal conditions—such as cardiac anatomical annotations and functional indices—and employing diffusion models, these methods can generate realistic ultrasound videos with specific cardiac morphology and function. This approach enriches training datasets and enhances algorithm robustness. <cite class="ltx_cite ltx_citemacro_citet">Reynaud et al. (<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib31" title="">2024</a>)</cite> introduced the EchoNet-Dynamic model, which utilizes spatiotemporal three-dimensional convolutional neural networks to segment the left ventricle frame by frame and estimate the ejection fraction (EF), outperforming manual measurements. Such advancements hold promise for assisting clinicians in more precise and efficient cardiac function assessments. These techniques typically use images as conditional inputs to generate corresponding ultrasound images. Recent studies have also explored generating ultrasound video sequences from single-frame images <cite class="ltx_cite ltx_citemacro_citep">(Reynaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib30" title="">2023</a>)</cite>, offering new possibilities for dynamic ultrasound applications like cardiac function evaluation. However, these studies are conditioned on carefully curated conditional prompts such as segmentation masks and clinical text but do not leverage time-series ECG data. In contrast, our work is the first to efficiently generate controllable ECHO videos conditioned on ECG data.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>METHODS</h2>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">ECHOPulse, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.F1" title="Figure 1 ‣ 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">1</span></a>, consists of three key components: (1) a video tokenization model that encodes videos into temporal token sequences, (2) a masked generative transformer that learns the latent alignment between video tokens and ECG signal, and (3) a progressive video generation pipeline that enables fast, unlimited video generation. The video tokenization and transformer components are trained separately.</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="284" id="S3.F1.1.g1" src="extracted/5921014/Images/pipeline_EchoPulse.png" width="548"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The pipeline of the ECHOPulse.
ECHOPulse contains a two-step training procedure. a) The first step trains the video tokenizer on the natural video dataset first and fine-tunes it on the public ECHO video dataset. b) The second step trains the transformer via the input token produced by ECG foundation model and video tokenizer, pretrained in the first step. Followed by the video generation procedure (c), ECHOPulse accepts input with or without a conditional image. The empty tokens will be reconstructed via the frozen transformer, trained in the second step, through the guidance of ECG siganls. ECHOPulse is capable of generating continuous long videos by sequentially shifting the token sequence and integrating new ECG inputs.</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Video Tokenization</h3>
<div class="ltx_para ltx_noindent" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">The key to generating videos from ECG signals lies in capturing the temporal correlation between the video and ECG data. Unlike text <cite class="ltx_cite ltx_citemacro_citep">(Touvron et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib35" title="">2023</a>)</cite>, ECG is a continuous temporal signal with variable sequence lengths. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.F2" title="Figure 2 ‣ Optimization: ‣ 3.2 Alignment between Video and ECG Tokens ‣ 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">2</span></a>, each ECG phase should correspond to different stages of the ECHO. Thus, encoding the entire video into a single embedding risks disrupting temporal alignment between ECG and video, also complicating autoregressive video generation and reducing generalizability. To temporally align ECHO video with the various phases of the ECG and support autoregressive video generation, an effective approach is to discretize the video into tokens while splitting the ECG into patches and embedding them for cross-modal alignment. Drawing inspiration from ViViT <cite class="ltx_cite ltx_citemacro_citep">(Arnab et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib2" title="">2021</a>)</cite> and C-ViViT <cite class="ltx_cite ltx_citemacro_citep">(Villegas et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib39" title="">2022</a>)</cite>, we developed ECHOPulse’s video tokenization model to meet these specific requirements.</p>
</div>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Model architecture:</h5>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.15">The encoding starts with a video sequence of <math alttext="T+1" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">T</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1"><plus id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1"></plus><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2">𝑇</ci><cn id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.1.m1.1c">T+1</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.1.m1.1d">italic_T + 1</annotation></semantics></math> frames, each with resolution <math alttext="H\times W" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">H</mi><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">×</mo><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1"><times id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1"></times><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2">𝐻</ci><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.2.m2.1c">H\times W</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.2.m2.1d">italic_H × italic_W</annotation></semantics></math> and <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS1.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.3.m3.1d">italic_C</annotation></semantics></math> channels, denoted as <math alttext="\mathbf{X}\in\mathbb{R}^{(T+1)\times H\times W\times C}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS1.SSS0.Px1.p1.4.m4.1a"><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.1.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.2.cmml">𝐗</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.1.cmml">∈</mo><msup id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.cmml"><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.2.cmml">T</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.2" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.2.cmml">×</mo><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.3.cmml">H</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.2.cmml">×</mo><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.4" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.4.cmml">W</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.2b" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.2.cmml">×</mo><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.5" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.5.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2"><in id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.1"></in><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.2">𝐗</ci><apply id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.2">ℝ</ci><apply id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1"><times id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.2"></times><apply id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1"><plus id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.1"></plus><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.2">𝑇</ci><cn id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.1.1.1.3">1</cn></apply><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.3">𝐻</ci><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.4.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.4">𝑊</ci><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.5.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.1.5">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.4.m4.1c">\mathbf{X}\in\mathbb{R}^{(T+1)\times H\times W\times C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.4.m4.1d">bold_X ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_T + 1 ) × italic_H × italic_W × italic_C end_POSTSUPERSCRIPT</annotation></semantics></math>. The sequence is compressed into tokens of size <math alttext="(T^{\prime}+1)\times H^{\prime}\times W^{\prime}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS1.SSS0.Px1.p1.5.m5.1a"><mrow id="S3.SS1.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml"><mo id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml"><msup id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.2.cmml">T</mi><mo id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml">×</mo><msup id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.2.cmml">H</mi><mo id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.3.cmml">′</mo></msup><mo id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml">×</mo><msup id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.cmml"><mi id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.2" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.2.cmml">W</mi><mo id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.3" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.3.cmml">′</mo></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1"><times id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.2"></times><apply id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1"><plus id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.1"></plus><apply id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.2">𝑇</ci><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.2.3">′</ci></apply><cn id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.2">𝐻</ci><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.3.3">′</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.2.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.2">𝑊</ci><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.3.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.4.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.5.m5.1c">(T^{\prime}+1)\times H^{\prime}\times W^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.5.m5.1d">( italic_T start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + 1 ) × italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT × italic_W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, where the first frame is tokenized independently, and subsequent frames are spatio-temporal tokens that autoregressive depending on the previous. Non-overlapping patches of size <math alttext="P_{h}\times P_{w}\times C" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.6.m6.1"><semantics id="S3.SS1.SSS0.Px1.p1.6.m6.1a"><mrow id="S3.SS1.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.cmml"><msub id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.2.cmml">P</mi><mi id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.3.cmml">h</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.cmml">×</mo><msub id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.2.cmml">P</mi><mi id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.3.cmml">w</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.cmml">×</mo><mi id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.4" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.4.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1"><times id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.1"></times><apply id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.2">𝑃</ci><ci id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.2.3">ℎ</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.2">𝑃</ci><ci id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.3.3">𝑤</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.6.m6.1.1.4.cmml" xref="S3.SS1.SSS0.Px1.p1.6.m6.1.1.4">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.6.m6.1c">P_{h}\times P_{w}\times C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.6.m6.1d">italic_P start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_P start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT × italic_C</annotation></semantics></math> (for images) and <math alttext="P_{t}\times P_{h}\times P_{w}\times C" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.7.m7.1"><semantics id="S3.SS1.SSS0.Px1.p1.7.m7.1a"><mrow id="S3.SS1.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.cmml"><msub id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.2.cmml">P</mi><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.3.cmml">t</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml">×</mo><msub id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.2.cmml">P</mi><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.3.cmml">h</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml">×</mo><msub id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.cmml"><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.2" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.2.cmml">P</mi><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.3" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.3.cmml">w</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1b" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml">×</mo><mi id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.5" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.5.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.7.m7.1b"><apply id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1"><times id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.1"></times><apply id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.2">𝑃</ci><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.2.3">𝑡</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.2">𝑃</ci><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.3.3">ℎ</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.1.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.2.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.2">𝑃</ci><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.3.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.4.3">𝑤</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.7.m7.1.1.5.cmml" xref="S3.SS1.SSS0.Px1.p1.7.m7.1.1.5">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.7.m7.1c">P_{t}\times P_{h}\times P_{w}\times C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.7.m7.1d">italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT × italic_P start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT × italic_P start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT × italic_C</annotation></semantics></math> (for video) are extracted, resulting in <math alttext="T^{\prime}=\frac{T}{P_{t}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.8.m8.1"><semantics id="S3.SS1.SSS0.Px1.p1.8.m8.1a"><mrow id="S3.SS1.SSS0.Px1.p1.8.m8.1.1" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.cmml"><msup id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.2.cmml">T</mi><mo id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.1" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.1.cmml">=</mo><mfrac id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.2.cmml">T</mi><msub id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.2.cmml">P</mi><mi id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.3.cmml">t</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.8.m8.1b"><apply id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1"><eq id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.1"></eq><apply id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.2">𝑇</ci><ci id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.2.3">′</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3"><divide id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3"></divide><ci id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.2">𝑇</ci><apply id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.2">𝑃</ci><ci id="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.8.m8.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.8.m8.1c">T^{\prime}=\frac{T}{P_{t}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.8.m8.1d">italic_T start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = divide start_ARG italic_T end_ARG start_ARG italic_P start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, <math alttext="H^{\prime}=\frac{H}{P_{h}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.9.m9.1"><semantics id="S3.SS1.SSS0.Px1.p1.9.m9.1a"><mrow id="S3.SS1.SSS0.Px1.p1.9.m9.1.1" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.cmml"><msup id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.2.cmml">H</mi><mo id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.1" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.cmml">=</mo><mfrac id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.2.cmml">H</mi><msub id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.2.cmml">P</mi><mi id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.3.cmml">h</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.9.m9.1b"><apply id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1"><eq id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.1"></eq><apply id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.2">𝐻</ci><ci id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.2.3">′</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3"><divide id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3"></divide><ci id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.2">𝐻</ci><apply id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.2">𝑃</ci><ci id="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.9.m9.1.1.3.3.3">ℎ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.9.m9.1c">H^{\prime}=\frac{H}{P_{h}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.9.m9.1d">italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = divide start_ARG italic_H end_ARG start_ARG italic_P start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>, and <math alttext="W^{\prime}=\frac{W}{P_{w}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.10.m10.1"><semantics id="S3.SS1.SSS0.Px1.p1.10.m10.1a"><mrow id="S3.SS1.SSS0.Px1.p1.10.m10.1.1" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.cmml"><msup id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.2.cmml">W</mi><mo id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.1" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.cmml">=</mo><mfrac id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.2.cmml">W</mi><msub id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.2.cmml">P</mi><mi id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.3.cmml">w</mi></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.10.m10.1b"><apply id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1"><eq id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.1"></eq><apply id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.2">𝑊</ci><ci id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.2.3">′</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3"><divide id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3"></divide><ci id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.2">𝑊</ci><apply id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.2">𝑃</ci><ci id="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.10.m10.1.1.3.3.3">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.10.m10.1c">W^{\prime}=\frac{W}{P_{w}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.10.m10.1d">italic_W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = divide start_ARG italic_W end_ARG start_ARG italic_P start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>. Each patch is flattened and projected into a <math alttext="D" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.11.m11.1"><semantics id="S3.SS1.SSS0.Px1.p1.11.m11.1a"><mi id="S3.SS1.SSS0.Px1.p1.11.m11.1.1" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.11.m11.1b"><ci id="S3.SS1.SSS0.Px1.p1.11.m11.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.11.m11.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.11.m11.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.11.m11.1d">italic_D</annotation></semantics></math>-dimensional space, forming a tensor of shape <math alttext="(T^{\prime}+1)\times(H^{\prime}\times W^{\prime})\times D" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.12.m12.2"><semantics id="S3.SS1.SSS0.Px1.p1.12.m12.2a"><mrow id="S3.SS1.SSS0.Px1.p1.12.m12.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml"><mo id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml"><msup id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.2.cmml">T</mi><mo id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.3" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.3.cmml">×</mo><mrow id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.cmml"><mo id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.cmml"><msup id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.2.cmml">H</mi><mo id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.1.cmml">×</mo><msup id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.2.cmml">W</mi><mo id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.cmml">)</mo></mrow><mo id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.3a" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.3.cmml">×</mo><mi id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.4" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.4.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.12.m12.2b"><apply id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2"><times id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.3"></times><apply id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1"><plus id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.1"></plus><apply id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.2">𝑇</ci><ci id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.2.3">′</ci></apply><cn id="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.12.m12.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1"><times id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.1"></times><apply id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.2">𝐻</ci><ci id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.2.3">′</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.2">𝑊</ci><ci id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.2.1.1.3.3">′</ci></apply></apply><ci id="S3.SS1.SSS0.Px1.p1.12.m12.2.2.4.cmml" xref="S3.SS1.SSS0.Px1.p1.12.m12.2.2.4">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.12.m12.2c">(T^{\prime}+1)\times(H^{\prime}\times W^{\prime})\times D</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.12.m12.2d">( italic_T start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + 1 ) × ( italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT × italic_W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) × italic_D</annotation></semantics></math>. Spatial transformers are applied with self attention, followed by temporal transformers with causal attention. The patch embeddings <math alttext="\mathbf{Z}\in\mathbb{R}^{(T^{\prime}+1)\times H^{\prime}\times W^{\prime}%
\times D}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.13.m13.1"><semantics id="S3.SS1.SSS0.Px1.p1.13.m13.1a"><mrow id="S3.SS1.SSS0.Px1.p1.13.m13.1.2" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.13.m13.1.2.2" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2.2.cmml">𝐙</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m13.1.2.1" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2.1.cmml">∈</mo><msup id="S3.SS1.SSS0.Px1.p1.13.m13.1.2.3" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.13.m13.1.2.3.2" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2.3.2.cmml">ℝ</mi><mrow id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.cmml"><mo id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.cmml"><msup id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.2.cmml">T</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.3" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.3.cmml">′</mo></msup><mo id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.2" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.2.cmml">×</mo><msup id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.2.cmml">H</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.3.cmml">′</mo></msup><mo id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.2a" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.2.cmml">×</mo><msup id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.cmml"><mi id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.2" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.2.cmml">W</mi><mo id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.3" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.3.cmml">′</mo></msup><mo id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.2b" lspace="0.222em" rspace="0.222em" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.2.cmml">×</mo><mi id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.5" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.5.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.13.m13.1b"><apply id="S3.SS1.SSS0.Px1.p1.13.m13.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2"><in id="S3.SS1.SSS0.Px1.p1.13.m13.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2.1"></in><ci id="S3.SS1.SSS0.Px1.p1.13.m13.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2.2">𝐙</ci><apply id="S3.SS1.SSS0.Px1.p1.13.m13.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m13.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.13.m13.1.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.2.3.2">ℝ</ci><apply id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1"><times id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.2"></times><apply id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1"><plus id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.1"></plus><apply id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.2">𝑇</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.2.3">′</ci></apply><cn id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.2">𝐻</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.3.3">′</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.1.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4">superscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.2.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.2">𝑊</ci><ci id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.3.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.4.3">′</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.5.cmml" xref="S3.SS1.SSS0.Px1.p1.13.m13.1.1.1.5">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.13.m13.1c">\mathbf{Z}\in\mathbb{R}^{(T^{\prime}+1)\times H^{\prime}\times W^{\prime}%
\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.13.m13.1d">bold_Z ∈ blackboard_R start_POSTSUPERSCRIPT ( italic_T start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT + 1 ) × italic_H start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT × italic_W start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math> are then quantized into codewords <math alttext="\mathbf{C_{z}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.14.m14.1"><semantics id="S3.SS1.SSS0.Px1.p1.14.m14.1a"><msub id="S3.SS1.SSS0.Px1.p1.14.m14.1.1" xref="S3.SS1.SSS0.Px1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.14.m14.1.1.2" xref="S3.SS1.SSS0.Px1.p1.14.m14.1.1.2.cmml">𝐂</mi><mi id="S3.SS1.SSS0.Px1.p1.14.m14.1.1.3" xref="S3.SS1.SSS0.Px1.p1.14.m14.1.1.3.cmml">𝐳</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.14.m14.1b"><apply id="S3.SS1.SSS0.Px1.p1.14.m14.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m14.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m14.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m14.1.1.2">𝐂</ci><ci id="S3.SS1.SSS0.Px1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.14.m14.1.1.3">𝐳</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.14.m14.1c">\mathbf{C_{z}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.14.m14.1d">bold_C start_POSTSUBSCRIPT bold_z end_POSTSUBSCRIPT</annotation></semantics></math> via vector quantization. The decoder reverses the process by transforming quantized tokens into embeddings, applying temporal and spatial transformers, and mapping the tokens back to pixel space via linear projection to reconstruct the frames <math alttext="\hat{\mathbf{X}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.15.m15.1"><semantics id="S3.SS1.SSS0.Px1.p1.15.m15.1a"><mover accent="true" id="S3.SS1.SSS0.Px1.p1.15.m15.1.1" xref="S3.SS1.SSS0.Px1.p1.15.m15.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.15.m15.1.1.2" xref="S3.SS1.SSS0.Px1.p1.15.m15.1.1.2.cmml">𝐗</mi><mo id="S3.SS1.SSS0.Px1.p1.15.m15.1.1.1" xref="S3.SS1.SSS0.Px1.p1.15.m15.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.15.m15.1b"><apply id="S3.SS1.SSS0.Px1.p1.15.m15.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.15.m15.1.1"><ci id="S3.SS1.SSS0.Px1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.15.m15.1.1.1">^</ci><ci id="S3.SS1.SSS0.Px1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.15.m15.1.1.2">𝐗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.15.m15.1c">\hat{\mathbf{X}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.15.m15.1d">over^ start_ARG bold_X end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p2.1">Additionally, Our framework incorporates the Lookup-Free Quantization (LFQ) method, inspired by the advancements in MAGVIT2 <cite class="ltx_cite ltx_citemacro_citep">(Yu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib44" title="">2024b</a>)</cite>, to streamline the quantization process. Unlike traditional vector quantization that relies on an explicit codebook lookup, LFQ parameterizes the quantization operation directly. Moreover, due to the lack of high-quality medical video datasets comparable in scale to natural video datasets, we introduce LoRA (Low-Rank Adaptation) <cite class="ltx_cite ltx_citemacro_citep">(Hu et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib13" title="">2021</a>)</cite> to enhance the learning efficiency and generalizability for medical video generation. This also lays the foundation for offering personalized video generation services for users or patients in future applications.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Loss design:</h5>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.1">During video tokenization training phrase, the total loss function <math alttext="\mathcal{L}_{\text{total}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3a.cmml">total</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3">total</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.1.m1.1c">\mathcal{L}_{\text{total}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT total end_POSTSUBSCRIPT</annotation></semantics></math> is formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{total}}=\mathcal{L}_{\text{recon}}+\mathcal{L}_{\text{%
percep}}+\mathcal{L}_{\text{VQ}}+\lambda_{\text{adaptive}}\cdot\mathcal{L}_{%
\text{GAN}}," class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3a.cmml">total</mtext></msub><mo id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><msub id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mtext id="S3.E1.m1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.3.2.3a.cmml">recon</mtext></msub><mo id="S3.E1.m1.1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.1.3.3.2.cmml">ℒ</mi><mtext id="S3.E1.m1.1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.1.3.3.3a.cmml">percep</mtext></msub><mo id="S3.E1.m1.1.1.1.1.3.1a" xref="S3.E1.m1.1.1.1.1.3.1.cmml">+</mo><msub id="S3.E1.m1.1.1.1.1.3.4" xref="S3.E1.m1.1.1.1.1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.3.4.2" xref="S3.E1.m1.1.1.1.1.3.4.2.cmml">ℒ</mi><mtext id="S3.E1.m1.1.1.1.1.3.4.3" xref="S3.E1.m1.1.1.1.1.3.4.3a.cmml">VQ</mtext></msub><mo id="S3.E1.m1.1.1.1.1.3.1b" xref="S3.E1.m1.1.1.1.1.3.1.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.1.3.5" xref="S3.E1.m1.1.1.1.1.3.5.cmml"><msub id="S3.E1.m1.1.1.1.1.3.5.2" xref="S3.E1.m1.1.1.1.1.3.5.2.cmml"><mi id="S3.E1.m1.1.1.1.1.3.5.2.2" xref="S3.E1.m1.1.1.1.1.3.5.2.2.cmml">λ</mi><mtext id="S3.E1.m1.1.1.1.1.3.5.2.3" xref="S3.E1.m1.1.1.1.1.3.5.2.3a.cmml">adaptive</mtext></msub><mo id="S3.E1.m1.1.1.1.1.3.5.1" lspace="0.222em" rspace="0.222em" xref="S3.E1.m1.1.1.1.1.3.5.1.cmml">⋅</mo><msub id="S3.E1.m1.1.1.1.1.3.5.3" xref="S3.E1.m1.1.1.1.1.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.3.5.3.2" xref="S3.E1.m1.1.1.1.1.3.5.3.2.cmml">ℒ</mi><mtext id="S3.E1.m1.1.1.1.1.3.5.3.3" xref="S3.E1.m1.1.1.1.1.3.5.3.3a.cmml">GAN</mtext></msub></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"></eq><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2">ℒ</ci><ci id="S3.E1.m1.1.1.1.1.2.3a.cmml" xref="S3.E1.m1.1.1.1.1.2.3"><mtext id="S3.E1.m1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.2.3">total</mtext></ci></apply><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><plus id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.1"></plus><apply id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S3.E1.m1.1.1.1.1.3.2.3a.cmml" xref="S3.E1.m1.1.1.1.1.3.2.3"><mtext id="S3.E1.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.3.2.3">recon</mtext></ci></apply><apply id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.3.2">ℒ</ci><ci id="S3.E1.m1.1.1.1.1.3.3.3a.cmml" xref="S3.E1.m1.1.1.1.1.3.3.3"><mtext id="S3.E1.m1.1.1.1.1.3.3.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.3.3.3">percep</mtext></ci></apply><apply id="S3.E1.m1.1.1.1.1.3.4.cmml" xref="S3.E1.m1.1.1.1.1.3.4"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.4.1.cmml" xref="S3.E1.m1.1.1.1.1.3.4">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.4.2.cmml" xref="S3.E1.m1.1.1.1.1.3.4.2">ℒ</ci><ci id="S3.E1.m1.1.1.1.1.3.4.3a.cmml" xref="S3.E1.m1.1.1.1.1.3.4.3"><mtext id="S3.E1.m1.1.1.1.1.3.4.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.3.4.3">VQ</mtext></ci></apply><apply id="S3.E1.m1.1.1.1.1.3.5.cmml" xref="S3.E1.m1.1.1.1.1.3.5"><ci id="S3.E1.m1.1.1.1.1.3.5.1.cmml" xref="S3.E1.m1.1.1.1.1.3.5.1">⋅</ci><apply id="S3.E1.m1.1.1.1.1.3.5.2.cmml" xref="S3.E1.m1.1.1.1.1.3.5.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.5.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3.5.2">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.5.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.5.2.2">𝜆</ci><ci id="S3.E1.m1.1.1.1.1.3.5.2.3a.cmml" xref="S3.E1.m1.1.1.1.1.3.5.2.3"><mtext id="S3.E1.m1.1.1.1.1.3.5.2.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.3.5.2.3">adaptive</mtext></ci></apply><apply id="S3.E1.m1.1.1.1.1.3.5.3.cmml" xref="S3.E1.m1.1.1.1.1.3.5.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.5.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3.5.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.5.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.5.3.2">ℒ</ci><ci id="S3.E1.m1.1.1.1.1.3.5.3.3a.cmml" xref="S3.E1.m1.1.1.1.1.3.5.3.3"><mtext id="S3.E1.m1.1.1.1.1.3.5.3.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.3.5.3.3">GAN</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\mathcal{L}_{\text{total}}=\mathcal{L}_{\text{recon}}+\mathcal{L}_{\text{%
percep}}+\mathcal{L}_{\text{VQ}}+\lambda_{\text{adaptive}}\cdot\mathcal{L}_{%
\text{GAN}},</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">caligraphic_L start_POSTSUBSCRIPT total end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT recon end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT percep end_POSTSUBSCRIPT + caligraphic_L start_POSTSUBSCRIPT VQ end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT adaptive end_POSTSUBSCRIPT ⋅ caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p1.6">where <math alttext="\mathcal{L}_{\text{recon}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.2.m1.1"><semantics id="S3.SS1.SSS0.Px2.p1.2.m1.1a"><msub id="S3.SS1.SSS0.Px2.p1.2.m1.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p1.2.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p1.2.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p1.2.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p1.2.m1.1.1.3a.cmml">recon</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.2.m1.1b"><apply id="S3.SS1.SSS0.Px2.p1.2.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.2.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m1.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m1.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m1.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p1.2.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p1.2.m1.1.1.3">recon</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.2.m1.1c">\mathcal{L}_{\text{recon}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.2.m1.1d">caligraphic_L start_POSTSUBSCRIPT recon end_POSTSUBSCRIPT</annotation></semantics></math> is the reconstruction loss, <math alttext="\mathcal{L}_{\text{percep}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.3.m2.1"><semantics id="S3.SS1.SSS0.Px2.p1.3.m2.1a"><msub id="S3.SS1.SSS0.Px2.p1.3.m2.1.1" xref="S3.SS1.SSS0.Px2.p1.3.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p1.3.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p1.3.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p1.3.m2.1.1.3" xref="S3.SS1.SSS0.Px2.p1.3.m2.1.1.3a.cmml">percep</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.3.m2.1b"><apply id="S3.SS1.SSS0.Px2.p1.3.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.3.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.3.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.3.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.3.m2.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p1.3.m2.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p1.3.m2.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p1.3.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p1.3.m2.1.1.3">percep</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.3.m2.1c">\mathcal{L}_{\text{percep}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.3.m2.1d">caligraphic_L start_POSTSUBSCRIPT percep end_POSTSUBSCRIPT</annotation></semantics></math> is the perceptual loss, <math alttext="\mathcal{L}_{\text{VQ}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.4.m3.1"><semantics id="S3.SS1.SSS0.Px2.p1.4.m3.1a"><msub id="S3.SS1.SSS0.Px2.p1.4.m3.1.1" xref="S3.SS1.SSS0.Px2.p1.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p1.4.m3.1.1.2" xref="S3.SS1.SSS0.Px2.p1.4.m3.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p1.4.m3.1.1.3" xref="S3.SS1.SSS0.Px2.p1.4.m3.1.1.3a.cmml">VQ</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.4.m3.1b"><apply id="S3.SS1.SSS0.Px2.p1.4.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.4.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.4.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m3.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p1.4.m3.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m3.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p1.4.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p1.4.m3.1.1.3">VQ</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.4.m3.1c">\mathcal{L}_{\text{VQ}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.4.m3.1d">caligraphic_L start_POSTSUBSCRIPT VQ end_POSTSUBSCRIPT</annotation></semantics></math> represents the vector quantization loss, and <math alttext="\mathcal{L}_{\text{GAN}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.5.m4.1"><semantics id="S3.SS1.SSS0.Px2.p1.5.m4.1a"><msub id="S3.SS1.SSS0.Px2.p1.5.m4.1.1" xref="S3.SS1.SSS0.Px2.p1.5.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p1.5.m4.1.1.2" xref="S3.SS1.SSS0.Px2.p1.5.m4.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p1.5.m4.1.1.3" xref="S3.SS1.SSS0.Px2.p1.5.m4.1.1.3a.cmml">GAN</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.5.m4.1b"><apply id="S3.SS1.SSS0.Px2.p1.5.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.5.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.5.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m4.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p1.5.m4.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m4.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p1.5.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p1.5.m4.1.1.3">GAN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.5.m4.1c">\mathcal{L}_{\text{GAN}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.5.m4.1d">caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math> is the generator adversarial loss. The parameter <math alttext="\lambda_{\text{adaptive}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p1.6.m5.1"><semantics id="S3.SS1.SSS0.Px2.p1.6.m5.1a"><msub id="S3.SS1.SSS0.Px2.p1.6.m5.1.1" xref="S3.SS1.SSS0.Px2.p1.6.m5.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.6.m5.1.1.2" xref="S3.SS1.SSS0.Px2.p1.6.m5.1.1.2.cmml">λ</mi><mtext id="S3.SS1.SSS0.Px2.p1.6.m5.1.1.3" xref="S3.SS1.SSS0.Px2.p1.6.m5.1.1.3a.cmml">adaptive</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.6.m5.1b"><apply id="S3.SS1.SSS0.Px2.p1.6.m5.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.6.m5.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.6.m5.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m5.1.1.2">𝜆</ci><ci id="S3.SS1.SSS0.Px2.p1.6.m5.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p1.6.m5.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p1.6.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p1.6.m5.1.1.3">adaptive</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.6.m5.1c">\lambda_{\text{adaptive}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p1.6.m5.1d">italic_λ start_POSTSUBSCRIPT adaptive end_POSTSUBSCRIPT</annotation></semantics></math> dynamically adjusts the contribution of the adversarial loss relative to the perceptual loss during training.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p2.3">Specifically, the reconstruction loss <math alttext="\mathcal{L}_{\text{recon}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p2.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p2.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p2.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p2.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p2.1.m1.1.1.3a.cmml">recon</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p2.1.m1.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p2.1.m1.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p2.1.m1.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p2.1.m1.1.1.3">recon</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p2.1.m1.1c">\mathcal{L}_{\text{recon}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p2.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT recon end_POSTSUBSCRIPT</annotation></semantics></math> is computed using the Mean Squared Error (MSE) to ensure the reconstructed video <math alttext="\hat{\mathbf{V}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS1.SSS0.Px2.p2.2.m2.1a"><mover accent="true" id="S3.SS1.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p2.2.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p2.2.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p2.2.m2.1.1.2.cmml">𝐕</mi><mo id="S3.SS1.SSS0.Px2.p2.2.m2.1.1.1" xref="S3.SS1.SSS0.Px2.p2.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p2.2.m2.1b"><apply id="S3.SS1.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.2.m2.1.1"><ci id="S3.SS1.SSS0.Px2.p2.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.2.m2.1.1.1">^</ci><ci id="S3.SS1.SSS0.Px2.p2.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p2.2.m2.1.1.2">𝐕</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p2.2.m2.1c">\hat{\mathbf{V}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p2.2.m2.1d">over^ start_ARG bold_V end_ARG</annotation></semantics></math> to closely match the original video <math alttext="\mathbf{V}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS1.SSS0.Px2.p2.3.m3.1a"><mi id="S3.SS1.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p2.3.m3.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p2.3.m3.1b"><ci id="S3.SS1.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.3.m3.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p2.3.m3.1c">\mathbf{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p2.3.m3.1d">bold_V</annotation></semantics></math> at the pixel level:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{recon}}=\frac{1}{N}\left\|\mathbf{V}-\hat{\mathbf{V}}\right%
\|_{2}^{2}," class="ltx_Math" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><msub id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E2.m1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.3.3a.cmml">recon</mtext></msub><mo id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mfrac id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml"><mn id="S3.E2.m1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E2.m1.1.1.1.1.1.3.3" xref="S3.E2.m1.1.1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">⁢</mo><msubsup id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐕</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐕</mi><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S3.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E2.m1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"></eq><apply id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E2.m1.1.1.1.1.3.3a.cmml" xref="S3.E2.m1.1.1.1.1.3.3"><mtext id="S3.E2.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E2.m1.1.1.1.1.3.3">recon</mtext></ci></apply><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><times id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2"></times><apply id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3"><divide id="S3.E2.m1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.3"></divide><cn id="S3.E2.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.3.2">1</cn><ci id="S3.E2.m1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.2">𝐕</ci><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3"><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.1">^</ci><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝐕</ci></apply></apply></apply><cn id="S3.E2.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S3.E2.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\mathcal{L}_{\text{recon}}=\frac{1}{N}\left\|\mathbf{V}-\hat{\mathbf{V}}\right%
\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">caligraphic_L start_POSTSUBSCRIPT recon end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∥ bold_V - over^ start_ARG bold_V end_ARG ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p2.7">where <math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p2.4.m1.1"><semantics id="S3.SS1.SSS0.Px2.p2.4.m1.1a"><mi id="S3.SS1.SSS0.Px2.p2.4.m1.1.1" xref="S3.SS1.SSS0.Px2.p2.4.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p2.4.m1.1b"><ci id="S3.SS1.SSS0.Px2.p2.4.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.4.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p2.4.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p2.4.m1.1d">italic_N</annotation></semantics></math> is the total number of pixels across all frames, <math alttext="\mathbf{V}_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p2.5.m2.1"><semantics id="S3.SS1.SSS0.Px2.p2.5.m2.1a"><msub id="S3.SS1.SSS0.Px2.p2.5.m2.1.1" xref="S3.SS1.SSS0.Px2.p2.5.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p2.5.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p2.5.m2.1.1.2.cmml">𝐕</mi><mi id="S3.SS1.SSS0.Px2.p2.5.m2.1.1.3" xref="S3.SS1.SSS0.Px2.p2.5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p2.5.m2.1b"><apply id="S3.SS1.SSS0.Px2.p2.5.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p2.5.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.5.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p2.5.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p2.5.m2.1.1.2">𝐕</ci><ci id="S3.SS1.SSS0.Px2.p2.5.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p2.5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p2.5.m2.1c">\mathbf{V}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p2.5.m2.1d">bold_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\hat{\mathbf{V}}_{i}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p2.6.m3.1"><semantics id="S3.SS1.SSS0.Px2.p2.6.m3.1a"><msub id="S3.SS1.SSS0.Px2.p2.6.m3.1.1" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1.cmml"><mover accent="true" id="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2.2" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2.2.cmml">𝐕</mi><mo id="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2.1" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS0.Px2.p2.6.m3.1.1.3" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p2.6.m3.1b"><apply id="S3.SS1.SSS0.Px2.p2.6.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p2.6.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1">subscript</csymbol><apply id="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2"><ci id="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2.1">^</ci><ci id="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1.2.2">𝐕</ci></apply><ci id="S3.SS1.SSS0.Px2.p2.6.m3.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p2.6.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p2.6.m3.1c">\hat{\mathbf{V}}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p2.6.m3.1d">over^ start_ARG bold_V end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p2.7.m4.1"><semantics id="S3.SS1.SSS0.Px2.p2.7.m4.1a"><mi id="S3.SS1.SSS0.Px2.p2.7.m4.1.1" xref="S3.SS1.SSS0.Px2.p2.7.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p2.7.m4.1b"><ci id="S3.SS1.SSS0.Px2.p2.7.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p2.7.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p2.7.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p2.7.m4.1d">italic_i</annotation></semantics></math>-th pixel of the original video and the reconstructed video, respectively.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p3">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p3.4">To improve the perceptual quality of the reconstructed video, perceptual loss <math alttext="\mathcal{L}_{\text{percep}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p3.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p3.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p3.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3a.cmml">percep</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p3.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p3.1.m1.1.1.3">percep</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p3.1.m1.1c">\mathcal{L}_{\text{percep}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p3.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT percep end_POSTSUBSCRIPT</annotation></semantics></math> is employed to measure the similarity <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib14" title="">2016</a>)</cite> between the original and reconstructed videos in the feature space of a pre-trained VGG16 <cite class="ltx_cite ltx_citemacro_citep">(Qassim et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib27" title="">2018</a>)</cite> network <math alttext="\phi" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p3.2.m2.1"><semantics id="S3.SS1.SSS0.Px2.p3.2.m2.1a"><mi id="S3.SS1.SSS0.Px2.p3.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p3.2.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p3.2.m2.1b"><ci id="S3.SS1.SSS0.Px2.p3.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.2.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p3.2.m2.1c">\phi</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p3.2.m2.1d">italic_ϕ</annotation></semantics></math>. By extracting high-level features from randomly selected video frames <math alttext="\mathbf{V}_{f_{j}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p3.3.m3.1"><semantics id="S3.SS1.SSS0.Px2.p3.3.m3.1a"><msub id="S3.SS1.SSS0.Px2.p3.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.2" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.2.cmml">𝐕</mi><msub id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.2" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.2.cmml">f</mi><mi id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.3" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.3.cmml">j</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p3.3.m3.1b"><apply id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.2">𝐕</ci><apply id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.2">𝑓</ci><ci id="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px2.p3.3.m3.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p3.3.m3.1c">\mathbf{V}_{f_{j}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p3.3.m3.1d">bold_V start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\hat{\mathbf{V}}_{f_{j}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p3.4.m4.1"><semantics id="S3.SS1.SSS0.Px2.p3.4.m4.1a"><msub id="S3.SS1.SSS0.Px2.p3.4.m4.1.1" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.cmml"><mover accent="true" id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2.2" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2.2.cmml">𝐕</mi><mo id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2.1" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2.1.cmml">^</mo></mover><msub id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.2" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.2.cmml">f</mi><mi id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.3" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.3.cmml">j</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p3.4.m4.1b"><apply id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1">subscript</csymbol><apply id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2"><ci id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2.1">^</ci><ci id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.2.2">𝐕</ci></apply><apply id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.2">𝑓</ci><ci id="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px2.p3.4.m4.1.1.3.3">𝑗</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p3.4.m4.1c">\hat{\mathbf{V}}_{f_{j}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p3.4.m4.1d">over^ start_ARG bold_V end_ARG start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, the perceptual loss is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{percep}}=\frac{1}{M}\sum_{j=1}^{M}\left\|\phi(\mathbf{V}_{f%
_{j}})-\phi(\hat{\mathbf{V}}_{f_{j}})\right\|_{2}^{2}," class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E3.m1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.3.3a.cmml">percep</mtext></msub><mo id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mfrac id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3.cmml"><mn id="S3.E3.m1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E3.m1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.3.3.cmml">M</mi></mfrac><mo id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><munderover id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S3.E3.m1.1.1.1.1.1.1.2.2.3.1" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.1.1.1.1.1.1.2.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml">M</mi></munderover><msubsup id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">ϕ</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐕</mi><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">ϕ</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mover accent="true" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml">𝐕</mi><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml">^</mo></mover><msub id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">f</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">j</mi></msub></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E3.m1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"></eq><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E3.m1.1.1.1.1.3.3a.cmml" xref="S3.E3.m1.1.1.1.1.3.3"><mtext id="S3.E3.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E3.m1.1.1.1.1.3.3">percep</mtext></ci></apply><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2"></times><apply id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3"><divide id="S3.E3.m1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.3"></divide><cn id="S3.E3.m1.1.1.1.1.1.3.2.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.3.2">1</cn><ci id="S3.E3.m1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3.3">𝑀</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1"><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E3.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E3.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3"><eq id="S3.E3.m1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.2">𝑗</ci><cn id="S3.E3.m1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3">𝑀</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.3"></minus><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">italic-ϕ</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐕</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2"><times id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.2"></times><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">italic-ϕ</ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1">subscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2"><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.1">^</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.2.2">𝐕</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝑓</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply><cn id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S3.E3.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">\mathcal{L}_{\text{percep}}=\frac{1}{M}\sum_{j=1}^{M}\left\|\phi(\mathbf{V}_{f%
_{j}})-\phi(\hat{\mathbf{V}}_{f_{j}})\right\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">caligraphic_L start_POSTSUBSCRIPT percep end_POSTSUBSCRIPT = divide start_ARG 1 end_ARG start_ARG italic_M end_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT ∥ italic_ϕ ( bold_V start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) - italic_ϕ ( over^ start_ARG bold_V end_ARG start_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p3.6">where <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p3.5.m1.1"><semantics id="S3.SS1.SSS0.Px2.p3.5.m1.1a"><mi id="S3.SS1.SSS0.Px2.p3.5.m1.1.1" xref="S3.SS1.SSS0.Px2.p3.5.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p3.5.m1.1b"><ci id="S3.SS1.SSS0.Px2.p3.5.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.5.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p3.5.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p3.5.m1.1d">italic_M</annotation></semantics></math> is the number of feature elements, and <math alttext="\phi(\cdot)" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p3.6.m2.1"><semantics id="S3.SS1.SSS0.Px2.p3.6.m2.1a"><mrow id="S3.SS1.SSS0.Px2.p3.6.m2.1.2" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.2.cmml"><mi id="S3.SS1.SSS0.Px2.p3.6.m2.1.2.2" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.cmml">ϕ</mi><mo id="S3.SS1.SSS0.Px2.p3.6.m2.1.2.1" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.2.cmml"><mo id="S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.2.cmml">(</mo><mo id="S3.SS1.SSS0.Px2.p3.6.m2.1.1" lspace="0em" rspace="0em" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.1.cmml">⋅</mo><mo id="S3.SS1.SSS0.Px2.p3.6.m2.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p3.6.m2.1b"><apply id="S3.SS1.SSS0.Px2.p3.6.m2.1.2.cmml" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.2"><times id="S3.SS1.SSS0.Px2.p3.6.m2.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.2.1"></times><ci id="S3.SS1.SSS0.Px2.p3.6.m2.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.2.2">italic-ϕ</ci><ci id="S3.SS1.SSS0.Px2.p3.6.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p3.6.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p3.6.m2.1c">\phi(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p3.6.m2.1d">italic_ϕ ( ⋅ )</annotation></semantics></math> denotes the VGG feature extraction operation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p4">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p4.1">The vector quantization loss <cite class="ltx_cite ltx_citemacro_citep">(van den Oord et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib38" title="">2017</a>)</cite> <math alttext="\mathcal{L}_{\text{VQ}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p4.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p4.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p4.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p4.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p4.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p4.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p4.1.m1.1.1.3a.cmml">VQ</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p4.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p4.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p4.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p4.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p4.1.m1.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p4.1.m1.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p4.1.m1.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p4.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p4.1.m1.1.1.3">VQ</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p4.1.m1.1c">\mathcal{L}_{\text{VQ}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p4.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT VQ end_POSTSUBSCRIPT</annotation></semantics></math> regularizes the encoder outputs by ensuring that they are close to their nearest codebook entries, encouraging efficient and discrete representation learning. The VQ loss is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{VQ}}=\beta\cdot\left\|\text{sg}[\mathbf{z}_{e}]-\mathbf{e}%
\right\|_{2}^{2}," class="ltx_Math" display="block" id="S3.E4.m1.1"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml"><msub id="S3.E4.m1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1.1.1.3.2" xref="S3.E4.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E4.m1.1.1.1.1.3.3" xref="S3.E4.m1.1.1.1.1.3.3a.cmml">VQ</mtext></msub><mo id="S3.E4.m1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml">β</mi><mo id="S3.E4.m1.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S3.E4.m1.1.1.1.1.1.2.cmml">⋅</mo><msubsup id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml">sg</mtext><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><mi id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐞</mi></mrow><mo id="S3.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E4.m1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="S3.E4.m1.1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></mrow></mrow><mo id="S3.E4.m1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"><eq id="S3.E4.m1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.2"></eq><apply id="S3.E4.m1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E4.m1.1.1.1.1.3.3a.cmml" xref="S3.E4.m1.1.1.1.1.3.3"><mtext id="S3.E4.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E4.m1.1.1.1.1.3.3">VQ</mtext></ci></apply><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><ci id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2">⋅</ci><ci id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3">𝛽</ci><apply id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3"><mtext id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.3">sg</mtext></ci><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑒</ci></apply></apply></apply><ci id="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.1.1.1.1.1.3">𝐞</ci></apply></apply><cn id="S3.E4.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.1.3">2</cn></apply><cn id="S3.E4.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">\mathcal{L}_{\text{VQ}}=\beta\cdot\left\|\text{sg}[\mathbf{z}_{e}]-\mathbf{e}%
\right\|_{2}^{2},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.1d">caligraphic_L start_POSTSUBSCRIPT VQ end_POSTSUBSCRIPT = italic_β ⋅ ∥ sg [ bold_z start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ] - bold_e ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p4.5">where <math alttext="\mathbf{z}_{e}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p4.2.m1.1"><semantics id="S3.SS1.SSS0.Px2.p4.2.m1.1a"><msub id="S3.SS1.SSS0.Px2.p4.2.m1.1.1" xref="S3.SS1.SSS0.Px2.p4.2.m1.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p4.2.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p4.2.m1.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.SSS0.Px2.p4.2.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p4.2.m1.1.1.3.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p4.2.m1.1b"><apply id="S3.SS1.SSS0.Px2.p4.2.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p4.2.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p4.2.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p4.2.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p4.2.m1.1.1.2">𝐳</ci><ci id="S3.SS1.SSS0.Px2.p4.2.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p4.2.m1.1.1.3">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p4.2.m1.1c">\mathbf{z}_{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p4.2.m1.1d">bold_z start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT</annotation></semantics></math> is the encoder output, <math alttext="\mathbf{e}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p4.3.m2.1"><semantics id="S3.SS1.SSS0.Px2.p4.3.m2.1a"><mi id="S3.SS1.SSS0.Px2.p4.3.m2.1.1" xref="S3.SS1.SSS0.Px2.p4.3.m2.1.1.cmml">𝐞</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p4.3.m2.1b"><ci id="S3.SS1.SSS0.Px2.p4.3.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p4.3.m2.1.1">𝐞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p4.3.m2.1c">\mathbf{e}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p4.3.m2.1d">bold_e</annotation></semantics></math> is the closest codebook entry, and <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p4.4.m3.1"><semantics id="S3.SS1.SSS0.Px2.p4.4.m3.1a"><mi id="S3.SS1.SSS0.Px2.p4.4.m3.1.1" xref="S3.SS1.SSS0.Px2.p4.4.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p4.4.m3.1b"><ci id="S3.SS1.SSS0.Px2.p4.4.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p4.4.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p4.4.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p4.4.m3.1d">italic_β</annotation></semantics></math> is a weighting parameter. The term <math alttext="\text{sg}[\cdot]" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p4.5.m4.1"><semantics id="S3.SS1.SSS0.Px2.p4.5.m4.1a"><mrow id="S3.SS1.SSS0.Px2.p4.5.m4.1.2" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.cmml"><mtext id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.2" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.2a.cmml">sg</mtext><mo id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.1" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.3.2" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.3.1.cmml"><mo id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.3.1.1.cmml">[</mo><mo id="S3.SS1.SSS0.Px2.p4.5.m4.1.1" lspace="0em" rspace="0em" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.1.cmml">⋅</mo><mo id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p4.5.m4.1b"><apply id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.cmml" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2"><times id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.1"></times><ci id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.2a.cmml" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.2"><mtext id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.2">sg</mtext></ci><apply id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.3.1.cmml" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.3.2"><csymbol cd="latexml" id="S3.SS1.SSS0.Px2.p4.5.m4.1.2.3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.2.3.2.1">delimited-[]</csymbol><ci id="S3.SS1.SSS0.Px2.p4.5.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p4.5.m4.1.1">⋅</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p4.5.m4.1c">\text{sg}[\cdot]</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p4.5.m4.1d">sg [ ⋅ ]</annotation></semantics></math> represents the stop-gradient operation, which ensures that the encoder is encouraged to commit to a discrete codebook entry without backpropagating gradients through this operation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p5">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p5.2">The generator adversarial loss <math alttext="\mathcal{L}_{\text{GAN}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p5.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p5.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p5.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p5.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p5.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p5.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p5.1.m1.1.1.3a.cmml">GAN</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p5.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p5.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p5.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p5.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p5.1.m1.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p5.1.m1.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p5.1.m1.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p5.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p5.1.m1.1.1.3">GAN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p5.1.m1.1c">\mathcal{L}_{\text{GAN}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p5.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math> drives the model to produce videos that are indistinguishable from real videos, as evaluated by a discriminator <math alttext="D" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p5.2.m2.1"><semantics id="S3.SS1.SSS0.Px2.p5.2.m2.1a"><mi id="S3.SS1.SSS0.Px2.p5.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p5.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p5.2.m2.1b"><ci id="S3.SS1.SSS0.Px2.p5.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p5.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p5.2.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p5.2.m2.1d">italic_D</annotation></semantics></math>. We employ the hinge loss formulation for stable adversarial training:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{GAN}}=-\mathbb{E}_{\hat{\mathbf{V}}\sim P_{G}}\left[D(\hat{%
\mathbf{H}})\right]," class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.1.3.2" xref="S3.E5.m1.2.2.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E5.m1.2.2.1.1.3.3" xref="S3.E5.m1.2.2.1.1.3.3a.cmml">GAN</mtext></msub><mo id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mo id="S3.E5.m1.2.2.1.1.1a" xref="S3.E5.m1.2.2.1.1.1.cmml">−</mo><mrow id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.3.3.cmml"><mover accent="true" id="S3.E5.m1.2.2.1.1.1.1.3.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.3.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.3.3.2.2" xref="S3.E5.m1.2.2.1.1.1.1.3.3.2.2.cmml">𝐕</mi><mo id="S3.E5.m1.2.2.1.1.1.1.3.3.2.1" xref="S3.E5.m1.2.2.1.1.1.1.3.3.2.1.cmml">^</mo></mover><mo id="S3.E5.m1.2.2.1.1.1.1.3.3.1" xref="S3.E5.m1.2.2.1.1.1.1.3.3.1.cmml">∼</mo><msub id="S3.E5.m1.2.2.1.1.1.1.3.3.3" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.3.3.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3.2.cmml">P</mi><mi id="S3.E5.m1.2.2.1.1.1.1.3.3.3.3" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3.3.cmml">G</mi></msub></mrow></msub><mo id="S3.E5.m1.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml">D</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.1.1.cmml"><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E5.m1.1.1.cmml">(</mo><mover accent="true" id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml"><mi id="S3.E5.m1.1.1.2" xref="S3.E5.m1.1.1.2.cmml">𝐇</mi><mo id="S3.E5.m1.1.1.1" xref="S3.E5.m1.1.1.1.cmml">^</mo></mover><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E5.m1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1"><eq id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2"></eq><apply id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.3.2">ℒ</ci><ci id="S3.E5.m1.2.2.1.1.3.3a.cmml" xref="S3.E5.m1.2.2.1.1.3.3"><mtext id="S3.E5.m1.2.2.1.1.3.3.cmml" mathsize="70%" xref="S3.E5.m1.2.2.1.1.3.3">GAN</mtext></ci></apply><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1"><minus id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1"></minus><apply id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.2">𝔼</ci><apply id="S3.E5.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3"><csymbol cd="latexml" id="S3.E5.m1.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.1">similar-to</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.2"><ci id="S3.E5.m1.2.2.1.1.1.1.3.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.2.1">^</ci><ci id="S3.E5.m1.2.2.1.1.1.1.3.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.2.2">𝐕</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.3.3.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.3.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3.2">𝑃</ci><ci id="S3.E5.m1.2.2.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3.3.3">𝐺</ci></apply></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E5.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1"></times><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2">𝐷</ci><apply id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.3.2"><ci id="S3.E5.m1.1.1.1.cmml" xref="S3.E5.m1.1.1.1">^</ci><ci id="S3.E5.m1.1.1.2.cmml" xref="S3.E5.m1.1.1.2">𝐇</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\mathcal{L}_{\text{GAN}}=-\mathbb{E}_{\hat{\mathbf{V}}\sim P_{G}}\left[D(\hat{%
\mathbf{H}})\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT = - blackboard_E start_POSTSUBSCRIPT over^ start_ARG bold_V end_ARG ∼ italic_P start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT end_POSTSUBSCRIPT [ italic_D ( over^ start_ARG bold_H end_ARG ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p5.5">where <math alttext="\hat{\mathbf{H}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p5.3.m1.1"><semantics id="S3.SS1.SSS0.Px2.p5.3.m1.1a"><mover accent="true" id="S3.SS1.SSS0.Px2.p5.3.m1.1.1" xref="S3.SS1.SSS0.Px2.p5.3.m1.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p5.3.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p5.3.m1.1.1.2.cmml">𝐇</mi><mo id="S3.SS1.SSS0.Px2.p5.3.m1.1.1.1" xref="S3.SS1.SSS0.Px2.p5.3.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p5.3.m1.1b"><apply id="S3.SS1.SSS0.Px2.p5.3.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p5.3.m1.1.1"><ci id="S3.SS1.SSS0.Px2.p5.3.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p5.3.m1.1.1.1">^</ci><ci id="S3.SS1.SSS0.Px2.p5.3.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p5.3.m1.1.1.2">𝐇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p5.3.m1.1c">\hat{\mathbf{H}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p5.3.m1.1d">over^ start_ARG bold_H end_ARG</annotation></semantics></math> is a video generated by the model, sampled from the generator’s distribution <math alttext="P_{G}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p5.4.m2.1"><semantics id="S3.SS1.SSS0.Px2.p5.4.m2.1a"><msub id="S3.SS1.SSS0.Px2.p5.4.m2.1.1" xref="S3.SS1.SSS0.Px2.p5.4.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p5.4.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p5.4.m2.1.1.2.cmml">P</mi><mi id="S3.SS1.SSS0.Px2.p5.4.m2.1.1.3" xref="S3.SS1.SSS0.Px2.p5.4.m2.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p5.4.m2.1b"><apply id="S3.SS1.SSS0.Px2.p5.4.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p5.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p5.4.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p5.4.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p5.4.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p5.4.m2.1.1.2">𝑃</ci><ci id="S3.SS1.SSS0.Px2.p5.4.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p5.4.m2.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p5.4.m2.1c">P_{G}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p5.4.m2.1d">italic_P start_POSTSUBSCRIPT italic_G end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="D(\hat{\mathbf{H}})" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p5.5.m3.1"><semantics id="S3.SS1.SSS0.Px2.p5.5.m3.1a"><mrow id="S3.SS1.SSS0.Px2.p5.5.m3.1.2" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.2.cmml"><mi id="S3.SS1.SSS0.Px2.p5.5.m3.1.2.2" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.2.2.cmml">D</mi><mo id="S3.SS1.SSS0.Px2.p5.5.m3.1.2.1" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px2.p5.5.m3.1.2.3.2" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.1.cmml"><mo id="S3.SS1.SSS0.Px2.p5.5.m3.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.1.cmml">(</mo><mover accent="true" id="S3.SS1.SSS0.Px2.p5.5.m3.1.1" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p5.5.m3.1.1.2" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.1.2.cmml">𝐇</mi><mo id="S3.SS1.SSS0.Px2.p5.5.m3.1.1.1" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.1.1.cmml">^</mo></mover><mo id="S3.SS1.SSS0.Px2.p5.5.m3.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p5.5.m3.1b"><apply id="S3.SS1.SSS0.Px2.p5.5.m3.1.2.cmml" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.2"><times id="S3.SS1.SSS0.Px2.p5.5.m3.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.2.1"></times><ci id="S3.SS1.SSS0.Px2.p5.5.m3.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.2.2">𝐷</ci><apply id="S3.SS1.SSS0.Px2.p5.5.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.2.3.2"><ci id="S3.SS1.SSS0.Px2.p5.5.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.1.1">^</ci><ci id="S3.SS1.SSS0.Px2.p5.5.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p5.5.m3.1.1.2">𝐇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p5.5.m3.1c">D(\hat{\mathbf{H}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p5.5.m3.1d">italic_D ( over^ start_ARG bold_H end_ARG )</annotation></semantics></math> is the discriminator’s output for the generated video.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS1.SSS0.Px2.p6">
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p6.3">To balance the adversarial loss <math alttext="\mathcal{L}_{\text{GAN}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p6.1.m1.1"><semantics id="S3.SS1.SSS0.Px2.p6.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p6.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p6.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p6.1.m1.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p6.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p6.1.m1.1.1.3a.cmml">GAN</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p6.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p6.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p6.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p6.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p6.1.m1.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p6.1.m1.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p6.1.m1.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p6.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p6.1.m1.1.1.3">GAN</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p6.1.m1.1c">\mathcal{L}_{\text{GAN}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p6.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math> and the perceptual loss <math alttext="\mathcal{L}_{\text{percep}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p6.2.m2.1"><semantics id="S3.SS1.SSS0.Px2.p6.2.m2.1a"><msub id="S3.SS1.SSS0.Px2.p6.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p6.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p6.2.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p6.2.m2.1.1.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p6.2.m2.1.1.3" xref="S3.SS1.SSS0.Px2.p6.2.m2.1.1.3a.cmml">percep</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p6.2.m2.1b"><apply id="S3.SS1.SSS0.Px2.p6.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p6.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p6.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p6.2.m2.1.1.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p6.2.m2.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p6.2.m2.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p6.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p6.2.m2.1.1.3">percep</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p6.2.m2.1c">\mathcal{L}_{\text{percep}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p6.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT percep end_POSTSUBSCRIPT</annotation></semantics></math>, we introduce an adaptive weight <math alttext="\lambda_{\text{adaptive}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p6.3.m3.1"><semantics id="S3.SS1.SSS0.Px2.p6.3.m3.1a"><msub id="S3.SS1.SSS0.Px2.p6.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p6.3.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p6.3.m3.1.1.2" xref="S3.SS1.SSS0.Px2.p6.3.m3.1.1.2.cmml">λ</mi><mtext id="S3.SS1.SSS0.Px2.p6.3.m3.1.1.3" xref="S3.SS1.SSS0.Px2.p6.3.m3.1.1.3a.cmml">adaptive</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p6.3.m3.1b"><apply id="S3.SS1.SSS0.Px2.p6.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p6.3.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p6.3.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p6.3.m3.1.1.2">𝜆</ci><ci id="S3.SS1.SSS0.Px2.p6.3.m3.1.1.3a.cmml" xref="S3.SS1.SSS0.Px2.p6.3.m3.1.1.3"><mtext id="S3.SS1.SSS0.Px2.p6.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p6.3.m3.1.1.3">adaptive</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p6.3.m3.1c">\lambda_{\text{adaptive}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p6.3.m3.1d">italic_λ start_POSTSUBSCRIPT adaptive end_POSTSUBSCRIPT</annotation></semantics></math>. This weight is computed dynamically based on the gradients of both losses with respect to the parameters of the decoder’s last layer <cite class="ltx_cite ltx_citemacro_citep">(Johnson et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib14" title="">2016</a>)</cite>. The adaptive weight is calculated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\lambda_{\text{adaptive}}=\frac{\left\|\nabla_{\theta}\mathcal{L}_{\text{%
percep}}\right\|_{2}}{\left\|\nabla_{\theta}\mathcal{L}_{\text{GAN}}\right\|_{%
2}+\epsilon}," class="ltx_Math" display="block" id="S3.E6.m1.3"><semantics id="S3.E6.m1.3a"><mrow id="S3.E6.m1.3.3.1" xref="S3.E6.m1.3.3.1.1.cmml"><mrow id="S3.E6.m1.3.3.1.1" xref="S3.E6.m1.3.3.1.1.cmml"><msub id="S3.E6.m1.3.3.1.1.2" xref="S3.E6.m1.3.3.1.1.2.cmml"><mi id="S3.E6.m1.3.3.1.1.2.2" xref="S3.E6.m1.3.3.1.1.2.2.cmml">λ</mi><mtext id="S3.E6.m1.3.3.1.1.2.3" xref="S3.E6.m1.3.3.1.1.2.3a.cmml">adaptive</mtext></msub><mo id="S3.E6.m1.3.3.1.1.1" xref="S3.E6.m1.3.3.1.1.1.cmml">=</mo><mfrac id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml"><msub id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.2" rspace="0.167em" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml">∇</mo><mi id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.cmml">θ</mi></msub><msub id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.1.1.1.1.1.1.2.2" xref="S3.E6.m1.1.1.1.1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E6.m1.1.1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.1.1.2.3a.cmml">percep</mtext></msub></mrow><mo id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml">2</mn></msub><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><msub id="S3.E6.m1.2.2.2.1" xref="S3.E6.m1.2.2.2.1.cmml"><mrow id="S3.E6.m1.2.2.2.1.1.1" xref="S3.E6.m1.2.2.2.1.1.2.cmml"><mo id="S3.E6.m1.2.2.2.1.1.1.2" xref="S3.E6.m1.2.2.2.1.1.2.1.cmml">‖</mo><mrow id="S3.E6.m1.2.2.2.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.cmml"><msub id="S3.E6.m1.2.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.2.1.1.1.1.1.cmml"><mo id="S3.E6.m1.2.2.2.1.1.1.1.1.2" rspace="0.167em" xref="S3.E6.m1.2.2.2.1.1.1.1.1.2.cmml">∇</mo><mi id="S3.E6.m1.2.2.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.2.1.1.1.1.1.3.cmml">θ</mi></msub><msub id="S3.E6.m1.2.2.2.1.1.1.1.2" xref="S3.E6.m1.2.2.2.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.2.1.1.1.1.2.2" xref="S3.E6.m1.2.2.2.1.1.1.1.2.2.cmml">ℒ</mi><mtext id="S3.E6.m1.2.2.2.1.1.1.1.2.3" xref="S3.E6.m1.2.2.2.1.1.1.1.2.3a.cmml">GAN</mtext></msub></mrow><mo id="S3.E6.m1.2.2.2.1.1.1.3" xref="S3.E6.m1.2.2.2.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E6.m1.2.2.2.1.3" xref="S3.E6.m1.2.2.2.1.3.cmml">2</mn></msub><mo id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">+</mo><mi id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">ϵ</mi></mrow></mfrac></mrow><mo id="S3.E6.m1.3.3.1.2" xref="S3.E6.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.3b"><apply id="S3.E6.m1.3.3.1.1.cmml" xref="S3.E6.m1.3.3.1"><eq id="S3.E6.m1.3.3.1.1.1.cmml" xref="S3.E6.m1.3.3.1.1.1"></eq><apply id="S3.E6.m1.3.3.1.1.2.cmml" xref="S3.E6.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.3.3.1.1.2.1.cmml" xref="S3.E6.m1.3.3.1.1.2">subscript</csymbol><ci id="S3.E6.m1.3.3.1.1.2.2.cmml" xref="S3.E6.m1.3.3.1.1.2.2">𝜆</ci><ci id="S3.E6.m1.3.3.1.1.2.3a.cmml" xref="S3.E6.m1.3.3.1.1.2.3"><mtext id="S3.E6.m1.3.3.1.1.2.3.cmml" mathsize="70%" xref="S3.E6.m1.3.3.1.1.2.3">adaptive</mtext></ci></apply><apply id="S3.E6.m1.2.2.cmml" xref="S3.E6.m1.2.2"><divide id="S3.E6.m1.2.2.3.cmml" xref="S3.E6.m1.2.2"></divide><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1">subscript</csymbol><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><apply id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2">∇</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3">𝜃</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.2">ℒ</ci><ci id="S3.E6.m1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E6.m1.1.1.1.1.1.1.2.3"><mtext id="S3.E6.m1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E6.m1.1.1.1.1.1.1.2.3">percep</mtext></ci></apply></apply></apply><cn id="S3.E6.m1.1.1.1.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.3">2</cn></apply><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><plus id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2"></plus><apply id="S3.E6.m1.2.2.2.1.cmml" xref="S3.E6.m1.2.2.2.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.1.2.cmml" xref="S3.E6.m1.2.2.2.1">subscript</csymbol><apply id="S3.E6.m1.2.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1"><csymbol cd="latexml" id="S3.E6.m1.2.2.2.1.1.2.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.2">norm</csymbol><apply id="S3.E6.m1.2.2.2.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1"><apply id="S3.E6.m1.2.2.2.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.2">∇</ci><ci id="S3.E6.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.1.3">𝜃</ci></apply><apply id="S3.E6.m1.2.2.2.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.2.2">ℒ</ci><ci id="S3.E6.m1.2.2.2.1.1.1.1.2.3a.cmml" xref="S3.E6.m1.2.2.2.1.1.1.1.2.3"><mtext id="S3.E6.m1.2.2.2.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E6.m1.2.2.2.1.1.1.1.2.3">GAN</mtext></ci></apply></apply></apply><cn id="S3.E6.m1.2.2.2.1.3.cmml" type="integer" xref="S3.E6.m1.2.2.2.1.3">2</cn></apply><ci id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3">italic-ϵ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.3c">\lambda_{\text{adaptive}}=\frac{\left\|\nabla_{\theta}\mathcal{L}_{\text{%
percep}}\right\|_{2}}{\left\|\nabla_{\theta}\mathcal{L}_{\text{GAN}}\right\|_{%
2}+\epsilon},</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.3d">italic_λ start_POSTSUBSCRIPT adaptive end_POSTSUBSCRIPT = divide start_ARG ∥ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT percep end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_ARG start_ARG ∥ ∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT ∥ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_ϵ end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.SSS0.Px2.p6.8">where <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p6.4.m1.1"><semantics id="S3.SS1.SSS0.Px2.p6.4.m1.1a"><mi id="S3.SS1.SSS0.Px2.p6.4.m1.1.1" xref="S3.SS1.SSS0.Px2.p6.4.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p6.4.m1.1b"><ci id="S3.SS1.SSS0.Px2.p6.4.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.4.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p6.4.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p6.4.m1.1d">italic_θ</annotation></semantics></math> are the parameters of the decoder’s last layer, <math alttext="\nabla_{\theta}\mathcal{L}_{\text{percep}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p6.5.m2.1"><semantics id="S3.SS1.SSS0.Px2.p6.5.m2.1a"><mrow id="S3.SS1.SSS0.Px2.p6.5.m2.1.1" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.cmml"><msub id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.cmml"><mo id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.2" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.2.cmml">∇</mo><mi id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.3" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.3.cmml">θ</mi></msub><msub id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.2" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.3" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.3a.cmml">percep</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p6.5.m2.1b"><apply id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1"><apply id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.2">∇</ci><ci id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.1.3">𝜃</ci></apply><apply id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.3a.cmml" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.3"><mtext id="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p6.5.m2.1.1.2.3">percep</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p6.5.m2.1c">\nabla_{\theta}\mathcal{L}_{\text{percep}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p6.5.m2.1d">∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT percep end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\nabla_{\theta}\mathcal{L}_{\text{GAN}}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p6.6.m3.1"><semantics id="S3.SS1.SSS0.Px2.p6.6.m3.1a"><mrow id="S3.SS1.SSS0.Px2.p6.6.m3.1.1" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.cmml"><msub id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.cmml"><mo id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.2" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.2.cmml">∇</mo><mi id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.3" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.3.cmml">θ</mi></msub><msub id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.2" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.2.cmml">ℒ</mi><mtext id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.3" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.3a.cmml">GAN</mtext></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p6.6.m3.1b"><apply id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1"><apply id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.2">∇</ci><ci id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.1.3">𝜃</ci></apply><apply id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.2">ℒ</ci><ci id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.3a.cmml" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.3"><mtext id="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.3.cmml" mathsize="70%" xref="S3.SS1.SSS0.Px2.p6.6.m3.1.1.2.3">GAN</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p6.6.m3.1c">\nabla_{\theta}\mathcal{L}_{\text{GAN}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p6.6.m3.1d">∇ start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT GAN end_POSTSUBSCRIPT</annotation></semantics></math> represent the gradients of the perceptual and adversarial losses with respect to <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p6.7.m4.1"><semantics id="S3.SS1.SSS0.Px2.p6.7.m4.1a"><mi id="S3.SS1.SSS0.Px2.p6.7.m4.1.1" xref="S3.SS1.SSS0.Px2.p6.7.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p6.7.m4.1b"><ci id="S3.SS1.SSS0.Px2.p6.7.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.7.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p6.7.m4.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p6.7.m4.1d">italic_θ</annotation></semantics></math>, and <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px2.p6.8.m5.1"><semantics id="S3.SS1.SSS0.Px2.p6.8.m5.1a"><mi id="S3.SS1.SSS0.Px2.p6.8.m5.1.1" xref="S3.SS1.SSS0.Px2.p6.8.m5.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p6.8.m5.1b"><ci id="S3.SS1.SSS0.Px2.p6.8.m5.1.1.cmml" xref="S3.SS1.SSS0.Px2.p6.8.m5.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p6.8.m5.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px2.p6.8.m5.1d">italic_ϵ</annotation></semantics></math> is a small constant to avoid division by zero.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Alignment between Video and ECG Tokens </h3>
<div class="ltx_para ltx_noindent" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Next, we embed the ECG signals and align them with the video tokens. To fully leverage the time-series ECG data, we implemented the following encoding and alignment design.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">ECG encoder:</h5>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.7">To better couple with echo video, the time-series ECG is first divided into non-overlapping temporal and spatial patches, which are then linearly projected into a high-dimensional space <cite class="ltx_cite ltx_citemacro_citep">(Na et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib21" title="">2024</a>)</cite>. Self-attention mechanisms capture spatio-temporal relationships across time segments, and a masked autoencoder (MAE) <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib10" title="">2022</a>)</cite> further refines the model’s understanding of ECG dynamics, transforming them into separate embedding features. In this work, we divide ECG signals into patches using the embedding layer of an ECG foundation model (ECG-FM), whose strong predictive performance ensures the effectiveness of this patch-based representation. The proposed patchify approach is as follows:
The raw ECG signal, denoted as <math alttext="\mathbf{X}\in\mathbb{R}^{L\times T}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">𝐗</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml">L</mi><mo id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml">T</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1"><in id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1"></in><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝐗</ci><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3"><times id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.2">𝐿</ci><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">\mathbf{X}\in\mathbb{R}^{L\times T}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.1d">bold_X ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_T end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="L" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.1d">italic_L</annotation></semantics></math> is the number of leads and <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.3.m3.1d">italic_T</annotation></semantics></math> is the time length, is split into non-overlapping spatio-temporal patches. Each lead <math alttext="l" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.1a"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.1b"><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.4.m4.1d">italic_l</annotation></semantics></math> produces patches <math alttext="\mathbf{P}^{l}\in\mathbb{R}^{n\times p}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px1.p1.5.m5.1a"><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml"><msup id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.cmml">𝐏</mi><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.cmml">l</mi></msup><mo id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.2" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.2.cmml">n</mi><mo id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.3" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.3.cmml">p</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.5.m5.1b"><apply id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1"><in id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.1"></in><apply id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.2">𝐏</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.2.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3"><times id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.1"></times><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.2">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.5.m5.1.1.3.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.5.m5.1c">\mathbf{P}^{l}\in\mathbb{R}^{n\times p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.5.m5.1d">bold_P start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_n × italic_p end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="n=\frac{T}{p}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.6.m6.1"><semantics id="S3.SS2.SSS0.Px1.p1.6.m6.1a"><mrow id="S3.SS2.SSS0.Px1.p1.6.m6.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.cmml">n</mi><mo id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.1" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.1.cmml">=</mo><mfrac id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.2" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.2.cmml">T</mi><mi id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.3" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.3.cmml">p</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.6.m6.1b"><apply id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1"><eq id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.1"></eq><ci id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.2">𝑛</ci><apply id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3"><divide id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3"></divide><ci id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.2">𝑇</ci><ci id="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.6.m6.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.6.m6.1c">n=\frac{T}{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.6.m6.1d">italic_n = divide start_ARG italic_T end_ARG start_ARG italic_p end_ARG</annotation></semantics></math> and <math alttext="p" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.7.m7.1"><semantics id="S3.SS2.SSS0.Px1.p1.7.m7.1a"><mi id="S3.SS2.SSS0.Px1.p1.7.m7.1.1" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.7.m7.1b"><ci id="S3.SS2.SSS0.Px1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.7.m7.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.7.m7.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.7.m7.1d">italic_p</annotation></semantics></math> is the patch size.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.2">Each patch <math alttext="\mathbf{P}_{i}^{l}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.1a"><msubsup id="S3.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.2.cmml">𝐏</mi><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.2">𝐏</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.1c">\mathbf{P}_{i}^{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.1.m1.1d">bold_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT</annotation></semantics></math> is passed through the ECG-FM encoder, producing a <math alttext="D" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p2.2.m2.1a"><mi id="S3.SS2.SSS0.Px1.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.2.m2.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.2.m2.1c">D</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.2.m2.1d">italic_D</annotation></semantics></math>-dimensional embedding:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{Z}_{i}^{l}=\text{ECG-FM}(\mathbf{P}_{i}^{l})\in\mathbb{R}^{D}," class="ltx_Math" display="block" id="S3.Ex1.m1.1"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><msubsup id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2.2" xref="S3.Ex1.m1.1.1.1.1.3.2.2.cmml">𝐙</mi><mi id="S3.Ex1.m1.1.1.1.1.3.2.3" xref="S3.Ex1.m1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S3.Ex1.m1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.3.3.cmml">l</mi></msubsup><mo id="S3.Ex1.m1.1.1.1.1.4" xref="S3.Ex1.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex1.m1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.3a.cmml">ECG-FM</mtext><mo id="S3.Ex1.m1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.Ex1.m1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐏</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msubsup><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.1.5" xref="S3.Ex1.m1.1.1.1.1.5.cmml">∈</mo><msup id="S3.Ex1.m1.1.1.1.1.6" xref="S3.Ex1.m1.1.1.1.1.6.cmml"><mi id="S3.Ex1.m1.1.1.1.1.6.2" xref="S3.Ex1.m1.1.1.1.1.6.2.cmml">ℝ</mi><mi id="S3.Ex1.m1.1.1.1.1.6.3" xref="S3.Ex1.m1.1.1.1.1.6.3.cmml">D</mi></msup></mrow><mo id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><and id="S3.Ex1.m1.1.1.1.1a.cmml" xref="S3.Ex1.m1.1.1.1"></and><apply id="S3.Ex1.m1.1.1.1.1b.cmml" xref="S3.Ex1.m1.1.1.1"><eq id="S3.Ex1.m1.1.1.1.1.4.cmml" xref="S3.Ex1.m1.1.1.1.1.4"></eq><apply id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.Ex1.m1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.3.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.3.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.2">𝐙</ci><ci id="S3.Ex1.m1.1.1.1.1.3.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.Ex1.m1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3">𝑙</ci></apply><apply id="S3.Ex1.m1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><times id="S3.Ex1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.2"></times><ci id="S3.Ex1.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex1.m1.1.1.1.1.1.3"><mtext id="S3.Ex1.m1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.3">ECG-FM</mtext></ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.2">𝐏</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1c.cmml" xref="S3.Ex1.m1.1.1.1"><in id="S3.Ex1.m1.1.1.1.1.5.cmml" xref="S3.Ex1.m1.1.1.1.1.5"></in><share href="https://arxiv.org/html/2410.03143v2#S3.Ex1.m1.1.1.1.1.1.cmml" id="S3.Ex1.m1.1.1.1.1d.cmml" xref="S3.Ex1.m1.1.1.1"></share><apply id="S3.Ex1.m1.1.1.1.1.6.cmml" xref="S3.Ex1.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.6.1.cmml" xref="S3.Ex1.m1.1.1.1.1.6">superscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.6.2.cmml" xref="S3.Ex1.m1.1.1.1.1.6.2">ℝ</ci><ci id="S3.Ex1.m1.1.1.1.1.6.3.cmml" xref="S3.Ex1.m1.1.1.1.1.6.3">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\mathbf{Z}_{i}^{l}=\text{ECG-FM}(\mathbf{P}_{i}^{l})\in\mathbb{R}^{D},</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.1d">bold_Z start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT = ECG-FM ( bold_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT ) ∈ blackboard_R start_POSTSUPERSCRIPT italic_D end_POSTSUPERSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.3">which results in a sequence of embeddings <math alttext="\mathbf{Z}=\{\mathbf{Z}_{1}^{l},\mathbf{Z}_{2}^{l},\dots\}\in\mathbb{R}^{L%
\times n\times D}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.3.m1.3"><semantics id="S3.SS2.SSS0.Px1.p2.3.m1.3a"><mrow id="S3.SS2.SSS0.Px1.p2.3.m1.3.3" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.4" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.4.cmml">𝐙</mi><mo id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.5" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.5.cmml">=</mo><mrow id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.3.cmml"><mo id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.3.cmml">{</mo><msubsup id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.2.2.cmml">𝐙</mi><mn id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.2.3" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.2.3.cmml">1</mn><mi id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.3" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.3.cmml">l</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.4" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.2.2" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.2.2.cmml">𝐙</mi><mn id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.2.3" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.2.3.cmml">2</mn><mi id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.3" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.3.cmml">l</mi></msubsup><mo id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.5" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.3.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p2.3.m1.1.1" mathvariant="normal" xref="S3.SS2.SSS0.Px1.p2.3.m1.1.1.cmml">…</mi><mo id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.6" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.3.cmml">}</mo></mrow><mo id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.6" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.6.cmml">∈</mo><msup id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.2" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.cmml"><mi id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.2" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.2.cmml">L</mi><mo id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.3" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.3.cmml">n</mi><mo id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.1a" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.1.cmml">×</mo><mi id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.4" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.4.cmml">D</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.3.m1.3b"><apply id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3"><and id="S3.SS2.SSS0.Px1.p2.3.m1.3.3a.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3"></and><apply id="S3.SS2.SSS0.Px1.p2.3.m1.3.3b.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3"><eq id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.5.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.5"></eq><ci id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.4">𝐙</ci><set id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2"><apply id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.2.2">𝐙</ci><cn id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.2.3">1</cn></apply><ci id="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.2.2.1.1.1.3">𝑙</ci></apply><apply id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.2.2">𝐙</ci><cn id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.2.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px1.p2.3.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.1.1">…</ci></set></apply><apply id="S3.SS2.SSS0.Px1.p2.3.m1.3.3c.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3"><in id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.6.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.6"></in><share href="https://arxiv.org/html/2410.03143v2#S3.SS2.SSS0.Px1.p2.3.m1.3.3.2.cmml" id="S3.SS2.SSS0.Px1.p2.3.m1.3.3d.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3"></share><apply id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7">superscript</csymbol><ci id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.2">ℝ</ci><apply id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3"><times id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.1"></times><ci id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.2.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.2">𝐿</ci><ci id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.3.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.3">𝑛</ci><ci id="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.4.cmml" xref="S3.SS2.SSS0.Px1.p2.3.m1.3.3.7.3.4">𝐷</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.3.m1.3c">\mathbf{Z}=\{\mathbf{Z}_{1}^{l},\mathbf{Z}_{2}^{l},\dots\}\in\mathbb{R}^{L%
\times n\times D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.3.m1.3d">bold_Z = { bold_Z start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , bold_Z start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_l end_POSTSUPERSCRIPT , … } ∈ blackboard_R start_POSTSUPERSCRIPT italic_L × italic_n × italic_D end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Aligning ECG and video token sequences for video prediction:</h5>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.4">Our video generation framework employs a bidirectional transformer with MVTM <cite class="ltx_cite ltx_citemacro_citep">(Chang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib6" title="">2022</a>)</cite> to predict video tokens. We mask tokens during training and use parallel decoding during inference to iteratively fill in missing tokens based on context from all directions. This design allows for faster and more efficient video synthesis, leveraging the bidirectional self-attention mechanism to condition video generation on both past and future frames. The masked token prediction is driven by minimizing the negative log-likelihood of the masked tokens:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{mask}}=-\mathbb{E}_{\mathbf{X}}\left[\sum_{i=1}^{N}m_{i}%
\log P(\mathbf{y}_{i}|\mathbf{Y}_{M})\right]," class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3a.cmml">mask</mtext></msub><mo id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1a" xref="S3.E7.m1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.3.2.cmml">𝔼</mi><mi id="S3.E7.m1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.3.3.cmml">𝐗</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><munderover id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2" lspace="0em" movablelimits="false" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">m</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2" lspace="0.167em" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml">log</mi><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4a" lspace="0.167em" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.cmml">⁡</mo><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml">P</mi></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2a" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐲</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo fence="false" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐘</mi><mi id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">M</mi></msub></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2"></eq><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2">ℒ</ci><ci id="S3.E7.m1.1.1.1.1.3.3a.cmml" xref="S3.E7.m1.1.1.1.1.3.3"><mtext id="S3.E7.m1.1.1.1.1.3.3.cmml" mathsize="70%" xref="S3.E7.m1.1.1.1.1.3.3">mask</mtext></ci></apply><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><minus id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1"></minus><apply id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.2">𝔼</ci><ci id="S3.E7.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3">𝐗</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1"><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.2"></sum><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3"><eq id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1"><times id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝑚</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4"><log id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.1"></log><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.4.2">𝑃</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐲</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐘</ci><ci id="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑀</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">\mathcal{L}_{\text{mask}}=-\mathbb{E}_{\mathbf{X}}\left[\sum_{i=1}^{N}m_{i}%
\log P(\mathbf{y}_{i}|\mathbf{Y}_{M})\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">caligraphic_L start_POSTSUBSCRIPT mask end_POSTSUBSCRIPT = - blackboard_E start_POSTSUBSCRIPT bold_X end_POSTSUBSCRIPT [ ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log italic_P ( bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT | bold_Y start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.3">where <math alttext="\mathbf{y}_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">𝐲</mi><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝐲</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">\mathbf{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.1d">bold_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are the masked tokens, <math alttext="m_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><msub id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml">m</mi><mi id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.2">𝑚</ci><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">m_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.2.m2.1d">italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> indicates the mask for each token, and <math alttext="\mathbf{Y}_{M}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.1a"><msub id="S3.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml">𝐘</mi><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.2">𝐘</ci><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.1c">\mathbf{Y}_{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.3.m3.1d">bold_Y start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> represents the partially masked token sequence.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px2.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p2.1">At each iteration, the mask scheduling function <math alttext="\gamma(t/T)" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml">γ</mi><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml">/</mo><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3.cmml">T</mi></mrow><mo id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1"><times id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2"></times><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3">𝛾</ci><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1"><divide id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.1"></divide><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.2">𝑡</ci><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.1.1.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">\gamma(t/T)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.1.m1.1d">italic_γ ( italic_t / italic_T )</annotation></semantics></math> determines the fraction of tokens to mask:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\gamma(t/T)=\cos\left(\frac{\pi t}{2T}\right)," class="ltx_Math" display="block" id="S3.E8.m1.3"><semantics id="S3.E8.m1.3a"><mrow id="S3.E8.m1.3.3.1" xref="S3.E8.m1.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml"><mrow id="S3.E8.m1.3.3.1.1.1" xref="S3.E8.m1.3.3.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.3.cmml">γ</mi><mo id="S3.E8.m1.3.3.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.3.3.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.2" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2.cmml">t</mi><mo id="S3.E8.m1.3.3.1.1.1.1.1.1.1" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml">/</mo><mi id="S3.E8.m1.3.3.1.1.1.1.1.1.3" xref="S3.E8.m1.3.3.1.1.1.1.1.1.3.cmml">T</mi></mrow><mo id="S3.E8.m1.3.3.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.3.3.1.1.2" xref="S3.E8.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E8.m1.3.3.1.1.3.2" xref="S3.E8.m1.3.3.1.1.3.1.cmml"><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">cos</mi><mo id="S3.E8.m1.3.3.1.1.3.2a" xref="S3.E8.m1.3.3.1.1.3.1.cmml">⁡</mo><mrow id="S3.E8.m1.3.3.1.1.3.2.1" xref="S3.E8.m1.3.3.1.1.3.1.cmml"><mo id="S3.E8.m1.3.3.1.1.3.2.1.1" xref="S3.E8.m1.3.3.1.1.3.1.cmml">(</mo><mfrac id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml"><mrow id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml"><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">π</mi><mo id="S3.E8.m1.2.2.2.1" xref="S3.E8.m1.2.2.2.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.2.3" xref="S3.E8.m1.2.2.2.3.cmml">t</mi></mrow><mrow id="S3.E8.m1.2.2.3" xref="S3.E8.m1.2.2.3.cmml"><mn id="S3.E8.m1.2.2.3.2" xref="S3.E8.m1.2.2.3.2.cmml">2</mn><mo id="S3.E8.m1.2.2.3.1" xref="S3.E8.m1.2.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.2.2.3.3" xref="S3.E8.m1.2.2.3.3.cmml">T</mi></mrow></mfrac><mo id="S3.E8.m1.3.3.1.1.3.2.1.2" xref="S3.E8.m1.3.3.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.3.3.1.2" xref="S3.E8.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.3b"><apply id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1"><eq id="S3.E8.m1.3.3.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.2"></eq><apply id="S3.E8.m1.3.3.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1"><times id="S3.E8.m1.3.3.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.2"></times><ci id="S3.E8.m1.3.3.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.3">𝛾</ci><apply id="S3.E8.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1"><divide id="S3.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.1"></divide><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.2">𝑡</ci><ci id="S3.E8.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.3.3.1.1.1.1.1.1.3">𝑇</ci></apply></apply><apply id="S3.E8.m1.3.3.1.1.3.1.cmml" xref="S3.E8.m1.3.3.1.1.3.2"><cos id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1"></cos><apply id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2"><divide id="S3.E8.m1.2.2.1.cmml" xref="S3.E8.m1.2.2"></divide><apply id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"><times id="S3.E8.m1.2.2.2.1.cmml" xref="S3.E8.m1.2.2.2.1"></times><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝜋</ci><ci id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.3">𝑡</ci></apply><apply id="S3.E8.m1.2.2.3.cmml" xref="S3.E8.m1.2.2.3"><times id="S3.E8.m1.2.2.3.1.cmml" xref="S3.E8.m1.2.2.3.1"></times><cn id="S3.E8.m1.2.2.3.2.cmml" type="integer" xref="S3.E8.m1.2.2.3.2">2</cn><ci id="S3.E8.m1.2.2.3.3.cmml" xref="S3.E8.m1.2.2.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.3c">\gamma(t/T)=\cos\left(\frac{\pi t}{2T}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.3d">italic_γ ( italic_t / italic_T ) = roman_cos ( divide start_ARG italic_π italic_t end_ARG start_ARG 2 italic_T end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p2.3">where <math alttext="t" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.2.m1.1"><semantics id="S3.SS2.SSS0.Px2.p2.2.m1.1a"><mi id="S3.SS2.SSS0.Px2.p2.2.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m1.1b"><ci id="S3.SS2.SSS0.Px2.p2.2.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m1.1c">t</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.2.m1.1d">italic_t</annotation></semantics></math> is the current iteration and <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.3.m2.1"><semantics id="S3.SS2.SSS0.Px2.p2.3.m2.1a"><mi id="S3.SS2.SSS0.Px2.p2.3.m2.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m2.1b"><ci id="S3.SS2.SSS0.Px2.p2.3.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.3.m2.1d">italic_T</annotation></semantics></math> is the total number of iterations. The cosine schedule progressively reduces the mask ratio, enabling a gradual refinement of the generated video <cite class="ltx_cite ltx_citemacro_citep">(Chang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib6" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px2.p3">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p3.1">The bidirectional transformer architecture allows for flexible video generation guided by various conditioning inputs. We also adapted T5X <cite class="ltx_cite ltx_citemacro_citep">(Roberts et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib32" title="">2023</a>)</cite> following <cite class="ltx_cite ltx_citemacro_citep">(Reynaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib31" title="">2024</a>; Ashrafian et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib3" title="">2024</a>)</cite>’s text-based ECHO video generation method to create a text-to-ECHO video version for comparative experiments. What’s more, we introduce an ECG mask similar to a text mask. This mask ensures that certain portions of the ECG signal are masked out during training, forcing the model to learn to generate corresponding video frames based on the visible ECG features.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Optimization:</h5>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p1.2">To ensure the transformer model fully learns the entire action of ECHO videos, we add a critic loss function <cite class="ltx_cite ltx_citemacro_citep">(Lezama et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib18" title="">2022</a>)</cite>. The critic takes a sequence of predicted tokens <math alttext="\hat{\mathbf{y}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px3.p1.1.m1.1a"><mover accent="true" id="S3.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml">𝐲</mi><mo id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.1" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1"><ci id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.1">^</ci><ci id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.2">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.1.m1.1c">\hat{\mathbf{y}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.1.m1.1d">over^ start_ARG bold_y end_ARG</annotation></semantics></math> and real tokens <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px3.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px3.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px3.p1.2.m2.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.2.m2.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.2.m2.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.2.m2.1d">bold_y</annotation></semantics></math> and computes whether the predicted tokens are real or fake.
The critic’s objective is expressed as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{critic}}=-\mathbb{E}_{\mathbf{y}}\left[\log D(\mathbf{y})%
\right]-\mathbb{E}_{\hat{\mathbf{y}}}\left[\log(1-D(\hat{\mathbf{y}}))\right]," class="ltx_Math" display="block" id="S3.E9.m1.4"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.4.1" xref="S3.E9.m1.4.4.1.1.cmml"><mrow id="S3.E9.m1.4.4.1.1" xref="S3.E9.m1.4.4.1.1.cmml"><msub id="S3.E9.m1.4.4.1.1.4" xref="S3.E9.m1.4.4.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E9.m1.4.4.1.1.4.2" xref="S3.E9.m1.4.4.1.1.4.2.cmml">ℒ</mi><mtext id="S3.E9.m1.4.4.1.1.4.3" xref="S3.E9.m1.4.4.1.1.4.3a.cmml">critic</mtext></msub><mo id="S3.E9.m1.4.4.1.1.3" xref="S3.E9.m1.4.4.1.1.3.cmml">=</mo><mrow id="S3.E9.m1.4.4.1.1.2" xref="S3.E9.m1.4.4.1.1.2.cmml"><mrow id="S3.E9.m1.4.4.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.cmml"><mo id="S3.E9.m1.4.4.1.1.1.1a" xref="S3.E9.m1.4.4.1.1.1.1.cmml">−</mo><mrow id="S3.E9.m1.4.4.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.cmml"><msub id="S3.E9.m1.4.4.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.4.4.1.1.1.1.1.3.2" xref="S3.E9.m1.4.4.1.1.1.1.1.3.2.cmml">𝔼</mi><mi id="S3.E9.m1.4.4.1.1.1.1.1.3.3" xref="S3.E9.m1.4.4.1.1.1.1.1.3.3.cmml">𝐲</mi></msub><mo id="S3.E9.m1.4.4.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E9.m1.4.4.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml">log</mi><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2a" lspace="0.167em" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mi id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml">D</mi></mrow><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">𝐲</mi><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E9.m1.4.4.1.1.2.3" xref="S3.E9.m1.4.4.1.1.2.3.cmml">−</mo><mrow id="S3.E9.m1.4.4.1.1.2.2" xref="S3.E9.m1.4.4.1.1.2.2.cmml"><msub id="S3.E9.m1.4.4.1.1.2.2.3" xref="S3.E9.m1.4.4.1.1.2.2.3.cmml"><mi id="S3.E9.m1.4.4.1.1.2.2.3.2" xref="S3.E9.m1.4.4.1.1.2.2.3.2.cmml">𝔼</mi><mover accent="true" id="S3.E9.m1.4.4.1.1.2.2.3.3" xref="S3.E9.m1.4.4.1.1.2.2.3.3.cmml"><mi id="S3.E9.m1.4.4.1.1.2.2.3.3.2" xref="S3.E9.m1.4.4.1.1.2.2.3.3.2.cmml">𝐲</mi><mo id="S3.E9.m1.4.4.1.1.2.2.3.3.1" xref="S3.E9.m1.4.4.1.1.2.2.3.3.1.cmml">^</mo></mover></msub><mo id="S3.E9.m1.4.4.1.1.2.2.2" xref="S3.E9.m1.4.4.1.1.2.2.2.cmml">⁢</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.1.1" xref="S3.E9.m1.4.4.1.1.2.2.1.2.cmml"><mo id="S3.E9.m1.4.4.1.1.2.2.1.1.2" xref="S3.E9.m1.4.4.1.1.2.2.1.2.1.cmml">[</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.2.cmml"><mi id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml">log</mi><mo id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1a" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.2.cmml">⁡</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.2.cmml"><mo id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.2.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.cmml"><mn id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.2" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.2.cmml">D</mi><mo id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.1" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.3.2" xref="S3.E9.m1.2.2.cmml"><mo id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E9.m1.2.2.cmml">(</mo><mover accent="true" id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml"><mi id="S3.E9.m1.2.2.2" xref="S3.E9.m1.2.2.2.cmml">𝐲</mi><mo id="S3.E9.m1.2.2.1" xref="S3.E9.m1.2.2.1.cmml">^</mo></mover><mo id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.3.2.2" stretchy="false" xref="S3.E9.m1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.4.4.1.1.2.2.1.1.3" xref="S3.E9.m1.4.4.1.1.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E9.m1.4.4.1.2" xref="S3.E9.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.4.1.1.cmml" xref="S3.E9.m1.4.4.1"><eq id="S3.E9.m1.4.4.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.3"></eq><apply id="S3.E9.m1.4.4.1.1.4.cmml" xref="S3.E9.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.4.1.cmml" xref="S3.E9.m1.4.4.1.1.4">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.4.2.cmml" xref="S3.E9.m1.4.4.1.1.4.2">ℒ</ci><ci id="S3.E9.m1.4.4.1.1.4.3a.cmml" xref="S3.E9.m1.4.4.1.1.4.3"><mtext id="S3.E9.m1.4.4.1.1.4.3.cmml" mathsize="70%" xref="S3.E9.m1.4.4.1.1.4.3">critic</mtext></ci></apply><apply id="S3.E9.m1.4.4.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2"><minus id="S3.E9.m1.4.4.1.1.2.3.cmml" xref="S3.E9.m1.4.4.1.1.2.3"></minus><apply id="S3.E9.m1.4.4.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1"><minus id="S3.E9.m1.4.4.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1"></minus><apply id="S3.E9.m1.4.4.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1"><times id="S3.E9.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.2"></times><apply id="S3.E9.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.3.2">𝔼</ci><ci id="S3.E9.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.3.3">𝐲</ci></apply><apply id="S3.E9.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E9.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1"><times id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2"><log id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.1"></log><ci id="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.1.2.2">𝐷</ci></apply><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝐲</ci></apply></apply></apply></apply><apply id="S3.E9.m1.4.4.1.1.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2"><times id="S3.E9.m1.4.4.1.1.2.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.2"></times><apply id="S3.E9.m1.4.4.1.1.2.2.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.2.2.3.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.3">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.2.2.3.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.3.2">𝔼</ci><apply id="S3.E9.m1.4.4.1.1.2.2.3.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.3.3"><ci id="S3.E9.m1.4.4.1.1.2.2.3.3.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.3.3.1">^</ci><ci id="S3.E9.m1.4.4.1.1.2.2.3.3.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.3.3.2">𝐲</ci></apply></apply><apply id="S3.E9.m1.4.4.1.1.2.2.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.1.1"><csymbol cd="latexml" id="S3.E9.m1.4.4.1.1.2.2.1.2.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.E9.m1.4.4.1.1.2.2.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1"><log id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3"></log><apply id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1"><minus id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.1"></minus><cn id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.2">1</cn><apply id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3"><times id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.1"></times><ci id="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.2">𝐷</ci><apply id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.4.4.1.1.2.2.1.1.1.1.1.1.3.3.2"><ci id="S3.E9.m1.2.2.1.cmml" xref="S3.E9.m1.2.2.1">^</ci><ci id="S3.E9.m1.2.2.2.cmml" xref="S3.E9.m1.2.2.2">𝐲</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">\mathcal{L}_{\text{critic}}=-\mathbb{E}_{\mathbf{y}}\left[\log D(\mathbf{y})%
\right]-\mathbb{E}_{\hat{\mathbf{y}}}\left[\log(1-D(\hat{\mathbf{y}}))\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.4d">caligraphic_L start_POSTSUBSCRIPT critic end_POSTSUBSCRIPT = - blackboard_E start_POSTSUBSCRIPT bold_y end_POSTSUBSCRIPT [ roman_log italic_D ( bold_y ) ] - blackboard_E start_POSTSUBSCRIPT over^ start_ARG bold_y end_ARG end_POSTSUBSCRIPT [ roman_log ( 1 - italic_D ( over^ start_ARG bold_y end_ARG ) ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p1.6">where <math alttext="D(\mathbf{y})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.3.m1.1"><semantics id="S3.SS2.SSS0.Px3.p1.3.m1.1a"><mrow id="S3.SS2.SSS0.Px3.p1.3.m1.1.2" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.2.cmml"><mi id="S3.SS2.SSS0.Px3.p1.3.m1.1.2.2" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.2.2.cmml">D</mi><mo id="S3.SS2.SSS0.Px3.p1.3.m1.1.2.1" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px3.p1.3.m1.1.2.3.2" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.2.cmml"><mo id="S3.SS2.SSS0.Px3.p1.3.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px3.p1.3.m1.1.1" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.1.cmml">𝐲</mi><mo id="S3.SS2.SSS0.Px3.p1.3.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.3.m1.1b"><apply id="S3.SS2.SSS0.Px3.p1.3.m1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.2"><times id="S3.SS2.SSS0.Px3.p1.3.m1.1.2.1.cmml" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.2.1"></times><ci id="S3.SS2.SSS0.Px3.p1.3.m1.1.2.2.cmml" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.2.2">𝐷</ci><ci id="S3.SS2.SSS0.Px3.p1.3.m1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.3.m1.1.1">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.3.m1.1c">D(\mathbf{y})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.3.m1.1d">italic_D ( bold_y )</annotation></semantics></math> is the critic’s prediction for the real tokens, and <math alttext="D(\hat{\mathbf{y}})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.4.m2.1"><semantics id="S3.SS2.SSS0.Px3.p1.4.m2.1a"><mrow id="S3.SS2.SSS0.Px3.p1.4.m2.1.2" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.2.cmml"><mi id="S3.SS2.SSS0.Px3.p1.4.m2.1.2.2" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.2.2.cmml">D</mi><mo id="S3.SS2.SSS0.Px3.p1.4.m2.1.2.1" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px3.p1.4.m2.1.2.3.2" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.1.cmml"><mo id="S3.SS2.SSS0.Px3.p1.4.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.1.cmml">(</mo><mover accent="true" id="S3.SS2.SSS0.Px3.p1.4.m2.1.1" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px3.p1.4.m2.1.1.2" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.1.2.cmml">𝐲</mi><mo id="S3.SS2.SSS0.Px3.p1.4.m2.1.1.1" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.1.1.cmml">^</mo></mover><mo id="S3.SS2.SSS0.Px3.p1.4.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.4.m2.1b"><apply id="S3.SS2.SSS0.Px3.p1.4.m2.1.2.cmml" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.2"><times id="S3.SS2.SSS0.Px3.p1.4.m2.1.2.1.cmml" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.2.1"></times><ci id="S3.SS2.SSS0.Px3.p1.4.m2.1.2.2.cmml" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.2.2">𝐷</ci><apply id="S3.SS2.SSS0.Px3.p1.4.m2.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.2.3.2"><ci id="S3.SS2.SSS0.Px3.p1.4.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.1.1">^</ci><ci id="S3.SS2.SSS0.Px3.p1.4.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p1.4.m2.1.1.2">𝐲</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.4.m2.1c">D(\hat{\mathbf{y}})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.4.m2.1d">italic_D ( over^ start_ARG bold_y end_ARG )</annotation></semantics></math> is its prediction for the fake tokens (predicted by transformer). In our framework, <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.5.m3.1"><semantics id="S3.SS2.SSS0.Px3.p1.5.m3.1a"><mi id="S3.SS2.SSS0.Px3.p1.5.m3.1.1" xref="S3.SS2.SSS0.Px3.p1.5.m3.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.5.m3.1b"><ci id="S3.SS2.SSS0.Px3.p1.5.m3.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.5.m3.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.5.m3.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.5.m3.1d">bold_y</annotation></semantics></math> represents the actual video tokens, and <math alttext="\hat{\mathbf{y}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.6.m4.1"><semantics id="S3.SS2.SSS0.Px3.p1.6.m4.1a"><mover accent="true" id="S3.SS2.SSS0.Px3.p1.6.m4.1.1" xref="S3.SS2.SSS0.Px3.p1.6.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px3.p1.6.m4.1.1.2" xref="S3.SS2.SSS0.Px3.p1.6.m4.1.1.2.cmml">𝐲</mi><mo id="S3.SS2.SSS0.Px3.p1.6.m4.1.1.1" xref="S3.SS2.SSS0.Px3.p1.6.m4.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.6.m4.1b"><apply id="S3.SS2.SSS0.Px3.p1.6.m4.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.6.m4.1.1"><ci id="S3.SS2.SSS0.Px3.p1.6.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.6.m4.1.1.1">^</ci><ci id="S3.SS2.SSS0.Px3.p1.6.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p1.6.m4.1.1.2">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.6.m4.1c">\hat{\mathbf{y}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.6.m4.1d">over^ start_ARG bold_y end_ARG</annotation></semantics></math> are the predicted tokens sampled during the transformer reconstruction process.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="428" id="S3.F2.1.g1" src="x1.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Video generation example of ECHOPulse. The inputs to ECHOPulse consist of a conditioning image and an ECG signal. Utilizing these inputs as constraints, ECHOPulse generates corresponding videos. The RSTP waves represent the four phases of the ECG. The R wave corresponds to end-diastole (ED), which is the frame with the largest ventricular segmentation area, while the T wave corresponds to end-systole (ES), the frame with the smallest ventricular area. In this case the EF of the generated ECHO video is 24.05.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS0.Px3.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p2.3">In practice, the critic’s loss function is computed using the following binary cross-entropy (BCE) loss <cite class="ltx_cite ltx_citemacro_citep">(Goodfellow, <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib9" title="">2016</a>)</cite>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{BCE}}=-\frac{1}{N}\sum_{i=1}^{N}\left[y_{i}\log(\hat{y_{i}}%
)+(1-y_{i})\log(1-\hat{y_{i}})\right]," class="ltx_Math" display="block" id="S3.E10.m1.4"><semantics id="S3.E10.m1.4a"><mrow id="S3.E10.m1.4.4.1" xref="S3.E10.m1.4.4.1.1.cmml"><mrow id="S3.E10.m1.4.4.1.1" xref="S3.E10.m1.4.4.1.1.cmml"><msub id="S3.E10.m1.4.4.1.1.3" xref="S3.E10.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E10.m1.4.4.1.1.3.2" xref="S3.E10.m1.4.4.1.1.3.2.cmml">ℒ</mi><mtext id="S3.E10.m1.4.4.1.1.3.3" xref="S3.E10.m1.4.4.1.1.3.3a.cmml">BCE</mtext></msub><mo id="S3.E10.m1.4.4.1.1.2" xref="S3.E10.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.4.4.1.1.1" xref="S3.E10.m1.4.4.1.1.1.cmml"><mo id="S3.E10.m1.4.4.1.1.1a" xref="S3.E10.m1.4.4.1.1.1.cmml">−</mo><mrow id="S3.E10.m1.4.4.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.cmml"><mfrac id="S3.E10.m1.4.4.1.1.1.1.3" xref="S3.E10.m1.4.4.1.1.1.1.3.cmml"><mn id="S3.E10.m1.4.4.1.1.1.1.3.2" xref="S3.E10.m1.4.4.1.1.1.1.3.2.cmml">1</mn><mi id="S3.E10.m1.4.4.1.1.1.1.3.3" xref="S3.E10.m1.4.4.1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S3.E10.m1.4.4.1.1.1.1.2" xref="S3.E10.m1.4.4.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.cmml"><munderover id="S3.E10.m1.4.4.1.1.1.1.1.2" xref="S3.E10.m1.4.4.1.1.1.1.1.2.cmml"><mo id="S3.E10.m1.4.4.1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E10.m1.4.4.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.2.2.3" xref="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.2" xref="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.1" xref="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.3" xref="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E10.m1.4.4.1.1.1.1.1.2.3" xref="S3.E10.m1.4.4.1.1.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.2.cmml"><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.cmml"><msub id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.2.cmml">y</mi><mi id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.3" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.3.cmml">i</mi></msub><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.1" lspace="0.167em" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.1.cmml">⁢</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.1.cmml"><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">log</mi><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.2a" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.1.cmml">⁡</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.2.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.1.cmml"><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.2.1.1" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.1.cmml">(</mo><mover accent="true" id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml"><msub id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml"><mi id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml">y</mi><mi id="S3.E10.m1.2.2.2.3" xref="S3.E10.m1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E10.m1.2.2.1" xref="S3.E10.m1.2.2.1.cmml">^</mo></mover><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.2.1.2" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.cmml"><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.3" lspace="0.167em" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml">log</mi><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1a" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml">⁡</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml"><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.2" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml">(</mo><mrow id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml"><mn id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.1.cmml">−</mo><mover accent="true" id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.cmml"><msub id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml"><mi id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.2" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.2.cmml">y</mi><mi id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.3" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.1" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.1.cmml">^</mo></mover></mrow><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.3" stretchy="false" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E10.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E10.m1.4.4.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E10.m1.4.4.1.2" xref="S3.E10.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.4b"><apply id="S3.E10.m1.4.4.1.1.cmml" xref="S3.E10.m1.4.4.1"><eq id="S3.E10.m1.4.4.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.2"></eq><apply id="S3.E10.m1.4.4.1.1.3.cmml" xref="S3.E10.m1.4.4.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.3.1.cmml" xref="S3.E10.m1.4.4.1.1.3">subscript</csymbol><ci id="S3.E10.m1.4.4.1.1.3.2.cmml" xref="S3.E10.m1.4.4.1.1.3.2">ℒ</ci><ci id="S3.E10.m1.4.4.1.1.3.3a.cmml" xref="S3.E10.m1.4.4.1.1.3.3"><mtext id="S3.E10.m1.4.4.1.1.3.3.cmml" mathsize="70%" xref="S3.E10.m1.4.4.1.1.3.3">BCE</mtext></ci></apply><apply id="S3.E10.m1.4.4.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1"><minus id="S3.E10.m1.4.4.1.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.1"></minus><apply id="S3.E10.m1.4.4.1.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1"><times id="S3.E10.m1.4.4.1.1.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.2"></times><apply id="S3.E10.m1.4.4.1.1.1.1.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.3"><divide id="S3.E10.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.3"></divide><cn id="S3.E10.m1.4.4.1.1.1.1.3.2.cmml" type="integer" xref="S3.E10.m1.4.4.1.1.1.1.3.2">1</cn><ci id="S3.E10.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.E10.m1.4.4.1.1.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1"><apply id="S3.E10.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E10.m1.4.4.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.1.1.1.2.2.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E10.m1.4.4.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.2.2.2"></sum><apply id="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.2.2.3"><eq id="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E10.m1.4.4.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E10.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E10.m1.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1"><plus id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.3"></plus><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4"><times id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.1"></times><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.2">𝑦</ci><ci id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.2.3">𝑖</ci></apply><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.4.3.2"><log id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"></log><apply id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2"><ci id="S3.E10.m1.2.2.1.cmml" xref="S3.E10.m1.2.2.1">^</ci><apply id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.1.cmml" xref="S3.E10.m1.2.2.2">subscript</csymbol><ci id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2">𝑦</ci><ci id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2"><times id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.3"></times><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1"><log id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3"></log><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1"><minus id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.1"></minus><cn id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.2.cmml" type="integer" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.2">1</cn><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3"><ci id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.1">^</ci><apply id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.1.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2">subscript</csymbol><ci id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.2.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.2">𝑦</ci><ci id="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.3.cmml" xref="S3.E10.m1.4.4.1.1.1.1.1.1.1.1.2.2.1.1.1.3.2.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.4c">\mathcal{L}_{\text{BCE}}=-\frac{1}{N}\sum_{i=1}^{N}\left[y_{i}\log(\hat{y_{i}}%
)+(1-y_{i})\log(1-\hat{y_{i}})\right],</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.4d">caligraphic_L start_POSTSUBSCRIPT BCE end_POSTSUBSCRIPT = - divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT [ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log ( over^ start_ARG italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ) + ( 1 - italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) roman_log ( 1 - over^ start_ARG italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p2.2">where <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px3.p2.1.m1.1a"><msub id="S3.SS2.SSS0.Px3.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px3.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px3.p2.1.m1.1.1.2" xref="S3.SS2.SSS0.Px3.p2.1.m1.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS0.Px3.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px3.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px3.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px3.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px3.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p2.1.m1.1.1.2">𝑦</ci><ci id="S3.SS2.SSS0.Px3.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px3.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p2.1.m1.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p2.1.m1.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are the true labels (1 for real tokens, 0 for fake tokens) and <math alttext="\hat{y_{i}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px3.p2.2.m2.1a"><mover accent="true" id="S3.SS2.SSS0.Px3.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.cmml"><msub id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.2" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.2.cmml">y</mi><mi id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.3" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.1" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p2.2.m2.1b"><apply id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1"><ci id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.1">^</ci><apply id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.2">𝑦</ci><ci id="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.SSS0.Px3.p2.2.m2.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p2.2.m2.1c">\hat{y_{i}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p2.2.m2.1d">over^ start_ARG italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG</annotation></semantics></math> are the critic’s predicted probabilities.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Video Generation</h3>
<div class="ltx_para ltx_noindent" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">We first train a video tokenization model and an ECG-conditioned video token prediction transformer. To generate videos conditioned on ECG, we pass the empty video value through the video tokenization model to obtain empty tokens and use the ECG tokens as input to the pre-trained transformer. This mirrors the training setup where all video tokens are masked, enabling video prediction from ECG. Additionally, as the first frame is independently tokenized, using it as a condition mimics the training scenario where only the first frame is visible, allowing for video generation based on the initial frame. Similarly, by conditioning on the final segment of a previous video and another ECG inputs, the transformer can generate coherent subsequent frames.</p>
</div>
<section class="ltx_paragraph" id="S3.SS3.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Progressive video generation with auto-regressive extrapolation:</h5>
<div class="ltx_para ltx_noindent" id="S3.SS3.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS3.SSS0.Px1.p1.3">During inference, video tokens are sampled iteratively, similar to the process described in MaskGIT <cite class="ltx_cite ltx_citemacro_citep">(Chang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib6" title="">2022</a>)</cite>, using classifier-free guidance with a scaling factor <math alttext="\lambda" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS3.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS3.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS3.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.1.m1.1d">italic_λ</annotation></semantics></math> to balance the alignment between the generated video and the provided ECG condition. Once the first <math alttext="t_{x}+1" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS3.SSS0.Px1.p1.2.m2.1a"><mrow id="S3.SS3.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml"><msub id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml"><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.2" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.2.cmml">t</mi><mi id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.3.cmml">x</mi></msub><mo id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml">+</mo><mn id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1"><plus id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.1"></plus><apply id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.2">𝑡</ci><ci id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.2.3">𝑥</ci></apply><cn id="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS3.SSS0.Px1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.2.m2.1c">t_{x}+1</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT + 1</annotation></semantics></math> frames are generated in the latent space, we can further extrapolate additional frames in an auto-regressive manner by re-encoding the last <math alttext="K" class="ltx_Math" display="inline" id="S3.SS3.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS3.SSS0.Px1.p1.3.m3.1a"><mi id="S3.SS3.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS0.Px1.p1.3.m3.1b"><ci id="S3.SS3.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS0.Px1.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS0.Px1.p1.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS0.Px1.p1.3.m3.1d">italic_K</annotation></semantics></math> generated frames using the video encoder. These tokens are then used to initialize the pre-trained transformer, which generates the remaining video tokens conditioned on the provided ECG. This approach enables rapid and length-unconstrained generation of ECHO videos, significantly enhancing its clinical applicability.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>EXPERIMENTS</h2>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="584" id="S4.F3.1.g1" src="x2.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Video generation results from ECHOPulse under different ECG conditions. The first row displays the ground truth, while the second row shows the generated video using the same ECG. The third row illustrates results under flat ECG conditions. The fourth condition depicts a shifted R wave, and the final condition, collected from an Apple Watch, represents the most common scenario. The ECG for Condition 4 was collected directly from the Health app on Apple Watch v9.</figcaption>
</figure>
<section class="ltx_paragraph" id="S4.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Dataset and implementations:</h5>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p1.1">In this experiment, the process is conducted in a distributed manner. Initially, we train the video tokenization model on the Webvim-10M dataset <cite class="ltx_cite ltx_citemacro_citep">(Bain et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib5" title="">2021</a>)</cite>, followed by fine-tuning on the CAMUS dataset <cite class="ltx_cite ltx_citemacro_citep">(Leclerc et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib17" title="">2019b</a>)</cite> to adapt the tokenization for medical imaging tasks. With the introduction of LFQ, the codebook size is set to <math alttext="2^{13}" class="ltx_Math" display="inline" id="S4.SS0.SSS0.Px1.p1.1.m1.1"><semantics id="S4.SS0.SSS0.Px1.p1.1.m1.1a"><msup id="S4.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mn id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">2</mn><mn id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">13</mn></msup><annotation-xml encoding="MathML-Content" id="S4.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1">superscript</csymbol><cn id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.2">2</cn><cn id="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS0.SSS0.Px1.p1.1.m1.1.1.3">13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS0.SSS0.Px1.p1.1.m1.1c">2^{13}</annotation><annotation encoding="application/x-llamapun" id="S4.SS0.SSS0.Px1.p1.1.m1.1d">2 start_POSTSUPERSCRIPT 13 end_POSTSUPERSCRIPT</annotation></semantics></math>. All natural videos are resized to 128x128 resolution with 11 frames. The temporal patch size is set to 2, and the spatial patch size is set to 8, resulting in a token sequence with a length of 1536. More detailed information can be seen in Appendix Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.T4" title="Table 4 ‣ A.2.1 Video Tokenizer ‣ A.2 MODEL SETUP AND HYPERPARAMETERS ‣ Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">4</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.T5" title="Table 5 ‣ A.2.2 Video GENERATION TRANSFORMER ‣ A.2 MODEL SETUP AND HYPERPARAMETERS ‣ Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p2">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p2.1">For the subsequent training of ECHOPulse, we utilized a private dataset consisting of 94,078 video and ECG samples. A total of 473 videos were extracted from the dataset to serve as the test dataset, and all video generation evaluations were performed on this test dataset. During the training process, all ECHO videos are resized to a format of 128×128 with 11 frames in the dataloader to match the input requirements of the video encoder. Due to the large volume and diverse sources of our dataset, the overall quality is not as consistent as that of publicly available ECHO datasets. Therefore, each video undergoes random contrast augmentation during loading to enhance its visual quality. We used the pretrained weight of ST-MEM <cite class="ltx_cite ltx_citemacro_citep">(Na et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib21" title="">2024</a>)</cite> as ECG signal encoder. Similarly, the evaluation metrics were maintained to ensure a fair and direct comparison. This allowed us to evaluate the model’s performance and validate the effectiveness of the proposed method.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p3">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p3.1">For evaluation, we use the CAMUS <cite class="ltx_cite ltx_citemacro_citep">(Leclerc et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib16" title="">2019a</a>)</cite> and EchoNet-Dynamic <cite class="ltx_cite ltx_citemacro_citep">(Ouyang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib25" title="">2020</a>)</cite> datasets. CAMUS, a public dataset with 500 ECHO videos with diverse spatial resolutions, is currently the highest-quality public ECHO dataset available. EchoNet-Dynamic includes 10,030 4-chamber cardiac ultrasound sequences with a resolution of 112×112 pixels.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS0.SSS0.Px1.p4">
<p class="ltx_p" id="S4.SS0.SSS0.Px1.p4.1">All experiments were conducted on 8 NVIDIA H-100 GPUs, each with 80GB of memory. Due to potential privacy concerns, the private dataset used in this study cannot be made publicly available. However, we have released all the code, scripts, and the pretrained ECG2Video model weights to facilitate further research and replication of our work.
</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Video Tokenization Reconstruction Performance</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">In our experiments, we conduct a quantitative comparison between the performance of the diffusion-based EchoNet-Synthetic model and our VQ-VAE-based model, primarily evaluated using MSE (Mean Squared Error) <cite class="ltx_cite ltx_citemacro_citep">(Gauss, <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib8" title="">1809</a>)</cite> and MAE (Mean Absolute Error) <cite class="ltx_cite ltx_citemacro_citep">(Qi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib28" title="">2020</a>)</cite> on reconstruction results of different datasets. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S4.SS1" title="4.1 Video Tokenization Reconstruction Performance ‣ 4 EXPERIMENTS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">4.1</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.6">Specifically, the EchoNet-Synthetic model achieves an MSE of <math alttext="3.00\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><mn id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml">3.00</mn><mo id="S4.SS1.p2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.1.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.p2.1.m1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.3.cmml"><mn id="S4.SS1.p2.1.m1.1.1.3.2" xref="S4.SS1.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p2.1.m1.1.1.3.3" xref="S4.SS1.p2.1.m1.1.1.3.3.cmml"><mo id="S4.SS1.p2.1.m1.1.1.3.3a" xref="S4.SS1.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p2.1.m1.1.1.3.3.2" xref="S4.SS1.p2.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><times id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1"></times><cn id="S4.SS1.p2.1.m1.1.1.2.cmml" type="float" xref="S4.SS1.p2.1.m1.1.1.2">3.00</cn><apply id="S4.SS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.p2.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.p2.1.m1.1.1.3.2">10</cn><apply id="S4.SS1.p2.1.m1.1.1.3.3.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3"><minus id="S4.SS1.p2.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p2.1.m1.1.1.3.3"></minus><cn id="S4.SS1.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p2.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">3.00\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">3.00 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math> and an MAE of <math alttext="3.00\times 10^{-2}" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2.1"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mn id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">3.00</mn><mo id="S4.SS1.p2.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.2.m2.1.1.1.cmml">×</mo><msup id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml"><mn id="S4.SS1.p2.2.m2.1.1.3.2" xref="S4.SS1.p2.2.m2.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p2.2.m2.1.1.3.3" xref="S4.SS1.p2.2.m2.1.1.3.3.cmml"><mo id="S4.SS1.p2.2.m2.1.1.3.3a" xref="S4.SS1.p2.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p2.2.m2.1.1.3.3.2" xref="S4.SS1.p2.2.m2.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><times id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1.1"></times><cn id="S4.SS1.p2.2.m2.1.1.2.cmml" type="float" xref="S4.SS1.p2.2.m2.1.1.2">3.00</cn><apply id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.3.1.cmml" xref="S4.SS1.p2.2.m2.1.1.3">superscript</csymbol><cn id="S4.SS1.p2.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS1.p2.2.m2.1.1.3.2">10</cn><apply id="S4.SS1.p2.2.m2.1.1.3.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3.3"><minus id="S4.SS1.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p2.2.m2.1.1.3.3"></minus><cn id="S4.SS1.p2.2.m2.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p2.2.m2.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">3.00\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.2.m2.1d">3.00 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math> on the Echo-Dynamic dataset. In comparison, our VQ-VAE based model, initially trained on a natural video dataset, exhibits an MSE of <math alttext="5.02\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.p2.3.m3.1"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mn id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">5.02</mn><mo id="S4.SS1.p2.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.3.m3.1.1.1.cmml">×</mo><msup id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml"><mn id="S4.SS1.p2.3.m3.1.1.3.2" xref="S4.SS1.p2.3.m3.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p2.3.m3.1.1.3.3" xref="S4.SS1.p2.3.m3.1.1.3.3.cmml"><mo id="S4.SS1.p2.3.m3.1.1.3.3a" xref="S4.SS1.p2.3.m3.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p2.3.m3.1.1.3.3.2" xref="S4.SS1.p2.3.m3.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><times id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1.1"></times><cn id="S4.SS1.p2.3.m3.1.1.2.cmml" type="float" xref="S4.SS1.p2.3.m3.1.1.2">5.02</cn><apply id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.3.1.cmml" xref="S4.SS1.p2.3.m3.1.1.3">superscript</csymbol><cn id="S4.SS1.p2.3.m3.1.1.3.2.cmml" type="integer" xref="S4.SS1.p2.3.m3.1.1.3.2">10</cn><apply id="S4.SS1.p2.3.m3.1.1.3.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3"><minus id="S4.SS1.p2.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p2.3.m3.1.1.3.3"></minus><cn id="S4.SS1.p2.3.m3.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p2.3.m3.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">5.02\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.3.m3.1d">5.02 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math> and an MAE of <math alttext="4.08\times 10^{-2}" class="ltx_Math" display="inline" id="S4.SS1.p2.4.m4.1"><semantics id="S4.SS1.p2.4.m4.1a"><mrow id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mn id="S4.SS1.p2.4.m4.1.1.2" xref="S4.SS1.p2.4.m4.1.1.2.cmml">4.08</mn><mo id="S4.SS1.p2.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.4.m4.1.1.1.cmml">×</mo><msup id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml"><mn id="S4.SS1.p2.4.m4.1.1.3.2" xref="S4.SS1.p2.4.m4.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p2.4.m4.1.1.3.3" xref="S4.SS1.p2.4.m4.1.1.3.3.cmml"><mo id="S4.SS1.p2.4.m4.1.1.3.3a" xref="S4.SS1.p2.4.m4.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p2.4.m4.1.1.3.3.2" xref="S4.SS1.p2.4.m4.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m4.1b"><apply id="S4.SS1.p2.4.m4.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1"><times id="S4.SS1.p2.4.m4.1.1.1.cmml" xref="S4.SS1.p2.4.m4.1.1.1"></times><cn id="S4.SS1.p2.4.m4.1.1.2.cmml" type="float" xref="S4.SS1.p2.4.m4.1.1.2">4.08</cn><apply id="S4.SS1.p2.4.m4.1.1.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m4.1.1.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.3">superscript</csymbol><cn id="S4.SS1.p2.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS1.p2.4.m4.1.1.3.2">10</cn><apply id="S4.SS1.p2.4.m4.1.1.3.3.cmml" xref="S4.SS1.p2.4.m4.1.1.3.3"><minus id="S4.SS1.p2.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.p2.4.m4.1.1.3.3"></minus><cn id="S4.SS1.p2.4.m4.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p2.4.m4.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m4.1c">4.08\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.4.m4.1d">4.08 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math> on the same dataset. Although the initial errors are slightly higher, after only one epoch of fine-tuning, the MSE of our model significantly improves to <math alttext="2.89\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.p2.5.m5.1"><semantics id="S4.SS1.p2.5.m5.1a"><mrow id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml"><mn id="S4.SS1.p2.5.m5.1.1.2" xref="S4.SS1.p2.5.m5.1.1.2.cmml">2.89</mn><mo id="S4.SS1.p2.5.m5.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.5.m5.1.1.1.cmml">×</mo><msup id="S4.SS1.p2.5.m5.1.1.3" xref="S4.SS1.p2.5.m5.1.1.3.cmml"><mn id="S4.SS1.p2.5.m5.1.1.3.2" xref="S4.SS1.p2.5.m5.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p2.5.m5.1.1.3.3" xref="S4.SS1.p2.5.m5.1.1.3.3.cmml"><mo id="S4.SS1.p2.5.m5.1.1.3.3a" xref="S4.SS1.p2.5.m5.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p2.5.m5.1.1.3.3.2" xref="S4.SS1.p2.5.m5.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m5.1b"><apply id="S4.SS1.p2.5.m5.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1"><times id="S4.SS1.p2.5.m5.1.1.1.cmml" xref="S4.SS1.p2.5.m5.1.1.1"></times><cn id="S4.SS1.p2.5.m5.1.1.2.cmml" type="float" xref="S4.SS1.p2.5.m5.1.1.2">2.89</cn><apply id="S4.SS1.p2.5.m5.1.1.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m5.1.1.3.1.cmml" xref="S4.SS1.p2.5.m5.1.1.3">superscript</csymbol><cn id="S4.SS1.p2.5.m5.1.1.3.2.cmml" type="integer" xref="S4.SS1.p2.5.m5.1.1.3.2">10</cn><apply id="S4.SS1.p2.5.m5.1.1.3.3.cmml" xref="S4.SS1.p2.5.m5.1.1.3.3"><minus id="S4.SS1.p2.5.m5.1.1.3.3.1.cmml" xref="S4.SS1.p2.5.m5.1.1.3.3"></minus><cn id="S4.SS1.p2.5.m5.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p2.5.m5.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m5.1c">2.89\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.5.m5.1d">2.89 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, with the MAE reduced to <math alttext="2.92\times 10^{-2}" class="ltx_Math" display="inline" id="S4.SS1.p2.6.m6.1"><semantics id="S4.SS1.p2.6.m6.1a"><mrow id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mn id="S4.SS1.p2.6.m6.1.1.2" xref="S4.SS1.p2.6.m6.1.1.2.cmml">2.92</mn><mo id="S4.SS1.p2.6.m6.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p2.6.m6.1.1.1.cmml">×</mo><msup id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml"><mn id="S4.SS1.p2.6.m6.1.1.3.2" xref="S4.SS1.p2.6.m6.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p2.6.m6.1.1.3.3" xref="S4.SS1.p2.6.m6.1.1.3.3.cmml"><mo id="S4.SS1.p2.6.m6.1.1.3.3a" xref="S4.SS1.p2.6.m6.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p2.6.m6.1.1.3.3.2" xref="S4.SS1.p2.6.m6.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m6.1b"><apply id="S4.SS1.p2.6.m6.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1"><times id="S4.SS1.p2.6.m6.1.1.1.cmml" xref="S4.SS1.p2.6.m6.1.1.1"></times><cn id="S4.SS1.p2.6.m6.1.1.2.cmml" type="float" xref="S4.SS1.p2.6.m6.1.1.2">2.92</cn><apply id="S4.SS1.p2.6.m6.1.1.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m6.1.1.3.1.cmml" xref="S4.SS1.p2.6.m6.1.1.3">superscript</csymbol><cn id="S4.SS1.p2.6.m6.1.1.3.2.cmml" type="integer" xref="S4.SS1.p2.6.m6.1.1.3.2">10</cn><apply id="S4.SS1.p2.6.m6.1.1.3.3.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3"><minus id="S4.SS1.p2.6.m6.1.1.3.3.1.cmml" xref="S4.SS1.p2.6.m6.1.1.3.3"></minus><cn id="S4.SS1.p2.6.m6.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p2.6.m6.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m6.1c">2.92\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.6.m6.1d">2.92 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math>, surpassing the performance of the diffusion-based model.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.4">On the private dataset, the results followed a similar trend. Before fine-tuning, the VQ-VAE model had an MSE of <math alttext="6.09\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml"><mn id="S4.SS1.p3.1.m1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.2.cmml">6.09</mn><mo id="S4.SS1.p3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p3.1.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml"><mn id="S4.SS1.p3.1.m1.1.1.3.2" xref="S4.SS1.p3.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p3.1.m1.1.1.3.3" xref="S4.SS1.p3.1.m1.1.1.3.3.cmml"><mo id="S4.SS1.p3.1.m1.1.1.3.3a" xref="S4.SS1.p3.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p3.1.m1.1.1.3.3.2" xref="S4.SS1.p3.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1"><times id="S4.SS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1"></times><cn id="S4.SS1.p3.1.m1.1.1.2.cmml" type="float" xref="S4.SS1.p3.1.m1.1.1.2">6.09</cn><apply id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.p3.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.3.2">10</cn><apply id="S4.SS1.p3.1.m1.1.1.3.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3"><minus id="S4.SS1.p3.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3"></minus><cn id="S4.SS1.p3.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">6.09\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">6.09 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math> and an MAE of <math alttext="4.41\times 10^{-2}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mn id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">4.41</mn><mo id="S4.SS1.p3.2.m2.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p3.2.m2.1.1.1.cmml">×</mo><msup id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml"><mn id="S4.SS1.p3.2.m2.1.1.3.2" xref="S4.SS1.p3.2.m2.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p3.2.m2.1.1.3.3" xref="S4.SS1.p3.2.m2.1.1.3.3.cmml"><mo id="S4.SS1.p3.2.m2.1.1.3.3a" xref="S4.SS1.p3.2.m2.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p3.2.m2.1.1.3.3.2" xref="S4.SS1.p3.2.m2.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><times id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1"></times><cn id="S4.SS1.p3.2.m2.1.1.2.cmml" type="float" xref="S4.SS1.p3.2.m2.1.1.2">4.41</cn><apply id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3">superscript</csymbol><cn id="S4.SS1.p3.2.m2.1.1.3.2.cmml" type="integer" xref="S4.SS1.p3.2.m2.1.1.3.2">10</cn><apply id="S4.SS1.p3.2.m2.1.1.3.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3"><minus id="S4.SS1.p3.2.m2.1.1.3.3.1.cmml" xref="S4.SS1.p3.2.m2.1.1.3.3"></minus><cn id="S4.SS1.p3.2.m2.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p3.2.m2.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">4.41\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">4.41 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math>. However, after one epoch of domain transfer, the MSE was significantly reduced to <math alttext="2.91\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><mrow id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mn id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml">2.91</mn><mo id="S4.SS1.p3.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p3.3.m3.1.1.1.cmml">×</mo><msup id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml"><mn id="S4.SS1.p3.3.m3.1.1.3.2" xref="S4.SS1.p3.3.m3.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p3.3.m3.1.1.3.3" xref="S4.SS1.p3.3.m3.1.1.3.3.cmml"><mo id="S4.SS1.p3.3.m3.1.1.3.3a" xref="S4.SS1.p3.3.m3.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p3.3.m3.1.1.3.3.2" xref="S4.SS1.p3.3.m3.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><times id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1"></times><cn id="S4.SS1.p3.3.m3.1.1.2.cmml" type="float" xref="S4.SS1.p3.3.m3.1.1.2">2.91</cn><apply id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.3.1.cmml" xref="S4.SS1.p3.3.m3.1.1.3">superscript</csymbol><cn id="S4.SS1.p3.3.m3.1.1.3.2.cmml" type="integer" xref="S4.SS1.p3.3.m3.1.1.3.2">10</cn><apply id="S4.SS1.p3.3.m3.1.1.3.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3"><minus id="S4.SS1.p3.3.m3.1.1.3.3.1.cmml" xref="S4.SS1.p3.3.m3.1.1.3.3"></minus><cn id="S4.SS1.p3.3.m3.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p3.3.m3.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">2.91\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">2.91 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math>, and the MAE to <math alttext="2.97\times 10^{-2}" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.1"><semantics id="S4.SS1.p3.4.m4.1a"><mrow id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml"><mn id="S4.SS1.p3.4.m4.1.1.2" xref="S4.SS1.p3.4.m4.1.1.2.cmml">2.97</mn><mo id="S4.SS1.p3.4.m4.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p3.4.m4.1.1.1.cmml">×</mo><msup id="S4.SS1.p3.4.m4.1.1.3" xref="S4.SS1.p3.4.m4.1.1.3.cmml"><mn id="S4.SS1.p3.4.m4.1.1.3.2" xref="S4.SS1.p3.4.m4.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.p3.4.m4.1.1.3.3" xref="S4.SS1.p3.4.m4.1.1.3.3.cmml"><mo id="S4.SS1.p3.4.m4.1.1.3.3a" xref="S4.SS1.p3.4.m4.1.1.3.3.cmml">−</mo><mn id="S4.SS1.p3.4.m4.1.1.3.3.2" xref="S4.SS1.p3.4.m4.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.1b"><apply id="S4.SS1.p3.4.m4.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1"><times id="S4.SS1.p3.4.m4.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1"></times><cn id="S4.SS1.p3.4.m4.1.1.2.cmml" type="float" xref="S4.SS1.p3.4.m4.1.1.2">2.97</cn><apply id="S4.SS1.p3.4.m4.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.3.1.cmml" xref="S4.SS1.p3.4.m4.1.1.3">superscript</csymbol><cn id="S4.SS1.p3.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS1.p3.4.m4.1.1.3.2">10</cn><apply id="S4.SS1.p3.4.m4.1.1.3.3.cmml" xref="S4.SS1.p3.4.m4.1.1.3.3"><minus id="S4.SS1.p3.4.m4.1.1.3.3.1.cmml" xref="S4.SS1.p3.4.m4.1.1.3.3"></minus><cn id="S4.SS1.p3.4.m4.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.p3.4.m4.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.1c">2.97\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.4.m4.1d">2.97 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<figure class="ltx_table ltx_figure_panel ltx_align_center" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="ltx_text ltx_font_bold" id="S4.T1.15.1">Reconstruction metrics:</span> Videos reconstructed using video tokenization and diffusion-based models are evaluated across two datasets with MAE and MSE. The <span class="ltx_text" id="S4.T1.16.2" style="background-color:#FFC864;">best</span> results are highlighted.</figcaption>
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.SS1.12.12" style="width:433.6pt;height:94pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-34.7pt,7.5pt) scale(0.861876147377481,0.861876147377481) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.SS1.12.12.12">
<tr class="ltx_tr" id="S4.SS1.2.2.2.2">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.SS1.2.2.2.2.3"><span class="ltx_text ltx_font_bold" id="S4.SS1.2.2.2.2.3.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.SS1.2.2.2.2.4"><span class="ltx_text ltx_font_bold" id="S4.SS1.2.2.2.2.4.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.SS1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.1.1.1.1.1.1">MSE<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.SS1.1.1.1.1.1.1.m1.1"><semantics id="S4.SS1.1.1.1.1.1.1.m1.1a"><mo id="S4.SS1.1.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.SS1.1.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.1.1.1.1.1.1.m1.1b"><ci id="S4.SS1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.SS1.1.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.1.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.1.1.1.1.1.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.SS1.2.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.SS1.2.2.2.2.2.1">MAE<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.SS1.2.2.2.2.2.1.m1.1"><semantics id="S4.SS1.2.2.2.2.2.1.m1.1a"><mo id="S4.SS1.2.2.2.2.2.1.m1.1.1" stretchy="false" xref="S4.SS1.2.2.2.2.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.2.2.2.2.2.1.m1.1b"><ci id="S4.SS1.2.2.2.2.2.1.m1.1.1.cmml" xref="S4.SS1.2.2.2.2.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.2.2.2.2.2.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.2.2.2.2.2.1.m1.1d">↓</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.SS1.4.4.4.4">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.SS1.4.4.4.4.3">EchoNet-Synthetic <cite class="ltx_cite ltx_citemacro_citep">(Reynaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib31" title="">2024</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.4.4.4.4.4">Echo-Dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.3.3.3.3.1"><math alttext="3.00\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.3.3.3.3.1.m1.1"><semantics id="S4.SS1.3.3.3.3.1.m1.1a"><mrow id="S4.SS1.3.3.3.3.1.m1.1.1" xref="S4.SS1.3.3.3.3.1.m1.1.1.cmml"><mn id="S4.SS1.3.3.3.3.1.m1.1.1.2" xref="S4.SS1.3.3.3.3.1.m1.1.1.2.cmml">3.00</mn><mo id="S4.SS1.3.3.3.3.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.3.3.3.3.1.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.3.3.3.3.1.m1.1.1.3" xref="S4.SS1.3.3.3.3.1.m1.1.1.3.cmml"><mn id="S4.SS1.3.3.3.3.1.m1.1.1.3.2" xref="S4.SS1.3.3.3.3.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.3.3.3.3.1.m1.1.1.3.3" xref="S4.SS1.3.3.3.3.1.m1.1.1.3.3.cmml"><mo id="S4.SS1.3.3.3.3.1.m1.1.1.3.3a" xref="S4.SS1.3.3.3.3.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.3.3.3.3.1.m1.1.1.3.3.2" xref="S4.SS1.3.3.3.3.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.3.3.3.3.1.m1.1b"><apply id="S4.SS1.3.3.3.3.1.m1.1.1.cmml" xref="S4.SS1.3.3.3.3.1.m1.1.1"><times id="S4.SS1.3.3.3.3.1.m1.1.1.1.cmml" xref="S4.SS1.3.3.3.3.1.m1.1.1.1"></times><cn id="S4.SS1.3.3.3.3.1.m1.1.1.2.cmml" type="float" xref="S4.SS1.3.3.3.3.1.m1.1.1.2">3.00</cn><apply id="S4.SS1.3.3.3.3.1.m1.1.1.3.cmml" xref="S4.SS1.3.3.3.3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.3.3.3.3.1.m1.1.1.3.1.cmml" xref="S4.SS1.3.3.3.3.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.3.3.3.3.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.3.3.3.3.1.m1.1.1.3.2">10</cn><apply id="S4.SS1.3.3.3.3.1.m1.1.1.3.3.cmml" xref="S4.SS1.3.3.3.3.1.m1.1.1.3.3"><minus id="S4.SS1.3.3.3.3.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.3.3.3.3.1.m1.1.1.3.3"></minus><cn id="S4.SS1.3.3.3.3.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.3.3.3.3.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.3.3.3.3.1.m1.1c">3.00\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.3.3.3.3.1.m1.1d">3.00 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.4.4.4.4.2"><math alttext="3.00\times 10^{-2}" class="ltx_Math" display="inline" id="S4.SS1.4.4.4.4.2.m1.1"><semantics id="S4.SS1.4.4.4.4.2.m1.1a"><mrow id="S4.SS1.4.4.4.4.2.m1.1.1" xref="S4.SS1.4.4.4.4.2.m1.1.1.cmml"><mn id="S4.SS1.4.4.4.4.2.m1.1.1.2" xref="S4.SS1.4.4.4.4.2.m1.1.1.2.cmml">3.00</mn><mo id="S4.SS1.4.4.4.4.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.4.4.4.4.2.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.4.4.4.4.2.m1.1.1.3" xref="S4.SS1.4.4.4.4.2.m1.1.1.3.cmml"><mn id="S4.SS1.4.4.4.4.2.m1.1.1.3.2" xref="S4.SS1.4.4.4.4.2.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.4.4.4.4.2.m1.1.1.3.3" xref="S4.SS1.4.4.4.4.2.m1.1.1.3.3.cmml"><mo id="S4.SS1.4.4.4.4.2.m1.1.1.3.3a" xref="S4.SS1.4.4.4.4.2.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.4.4.4.4.2.m1.1.1.3.3.2" xref="S4.SS1.4.4.4.4.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.4.4.4.4.2.m1.1b"><apply id="S4.SS1.4.4.4.4.2.m1.1.1.cmml" xref="S4.SS1.4.4.4.4.2.m1.1.1"><times id="S4.SS1.4.4.4.4.2.m1.1.1.1.cmml" xref="S4.SS1.4.4.4.4.2.m1.1.1.1"></times><cn id="S4.SS1.4.4.4.4.2.m1.1.1.2.cmml" type="float" xref="S4.SS1.4.4.4.4.2.m1.1.1.2">3.00</cn><apply id="S4.SS1.4.4.4.4.2.m1.1.1.3.cmml" xref="S4.SS1.4.4.4.4.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.4.4.4.4.2.m1.1.1.3.1.cmml" xref="S4.SS1.4.4.4.4.2.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.4.4.4.4.2.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.4.4.4.4.2.m1.1.1.3.2">10</cn><apply id="S4.SS1.4.4.4.4.2.m1.1.1.3.3.cmml" xref="S4.SS1.4.4.4.4.2.m1.1.1.3.3"><minus id="S4.SS1.4.4.4.4.2.m1.1.1.3.3.1.cmml" xref="S4.SS1.4.4.4.4.2.m1.1.1.3.3"></minus><cn id="S4.SS1.4.4.4.4.2.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.4.4.4.4.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.4.4.4.4.2.m1.1c">3.00\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.4.4.4.4.2.m1.1d">3.00 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.SS1.6.6.6.6">
<td class="ltx_td ltx_align_left" id="S4.SS1.6.6.6.6.3">ECHOPulse (Only natural videos)</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.6.6.6.6.4">Echo-Dynamic</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.5.5.5.5.1"><math alttext="5.02\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.5.5.5.5.1.m1.1"><semantics id="S4.SS1.5.5.5.5.1.m1.1a"><mrow id="S4.SS1.5.5.5.5.1.m1.1.1" xref="S4.SS1.5.5.5.5.1.m1.1.1.cmml"><mn id="S4.SS1.5.5.5.5.1.m1.1.1.2" xref="S4.SS1.5.5.5.5.1.m1.1.1.2.cmml">5.02</mn><mo id="S4.SS1.5.5.5.5.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.5.5.5.5.1.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.5.5.5.5.1.m1.1.1.3" xref="S4.SS1.5.5.5.5.1.m1.1.1.3.cmml"><mn id="S4.SS1.5.5.5.5.1.m1.1.1.3.2" xref="S4.SS1.5.5.5.5.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.5.5.5.5.1.m1.1.1.3.3" xref="S4.SS1.5.5.5.5.1.m1.1.1.3.3.cmml"><mo id="S4.SS1.5.5.5.5.1.m1.1.1.3.3a" xref="S4.SS1.5.5.5.5.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.5.5.5.5.1.m1.1.1.3.3.2" xref="S4.SS1.5.5.5.5.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.5.5.5.5.1.m1.1b"><apply id="S4.SS1.5.5.5.5.1.m1.1.1.cmml" xref="S4.SS1.5.5.5.5.1.m1.1.1"><times id="S4.SS1.5.5.5.5.1.m1.1.1.1.cmml" xref="S4.SS1.5.5.5.5.1.m1.1.1.1"></times><cn id="S4.SS1.5.5.5.5.1.m1.1.1.2.cmml" type="float" xref="S4.SS1.5.5.5.5.1.m1.1.1.2">5.02</cn><apply id="S4.SS1.5.5.5.5.1.m1.1.1.3.cmml" xref="S4.SS1.5.5.5.5.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.5.5.5.5.1.m1.1.1.3.1.cmml" xref="S4.SS1.5.5.5.5.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.5.5.5.5.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.5.5.5.5.1.m1.1.1.3.2">10</cn><apply id="S4.SS1.5.5.5.5.1.m1.1.1.3.3.cmml" xref="S4.SS1.5.5.5.5.1.m1.1.1.3.3"><minus id="S4.SS1.5.5.5.5.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.5.5.5.5.1.m1.1.1.3.3"></minus><cn id="S4.SS1.5.5.5.5.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.5.5.5.5.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.5.5.5.5.1.m1.1c">5.02\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.5.5.5.5.1.m1.1d">5.02 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.SS1.6.6.6.6.2"><math alttext="4.08\times 10^{-2}" class="ltx_Math" display="inline" id="S4.SS1.6.6.6.6.2.m1.1"><semantics id="S4.SS1.6.6.6.6.2.m1.1a"><mrow id="S4.SS1.6.6.6.6.2.m1.1.1" xref="S4.SS1.6.6.6.6.2.m1.1.1.cmml"><mn id="S4.SS1.6.6.6.6.2.m1.1.1.2" xref="S4.SS1.6.6.6.6.2.m1.1.1.2.cmml">4.08</mn><mo id="S4.SS1.6.6.6.6.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.6.6.6.6.2.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.6.6.6.6.2.m1.1.1.3" xref="S4.SS1.6.6.6.6.2.m1.1.1.3.cmml"><mn id="S4.SS1.6.6.6.6.2.m1.1.1.3.2" xref="S4.SS1.6.6.6.6.2.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.6.6.6.6.2.m1.1.1.3.3" xref="S4.SS1.6.6.6.6.2.m1.1.1.3.3.cmml"><mo id="S4.SS1.6.6.6.6.2.m1.1.1.3.3a" xref="S4.SS1.6.6.6.6.2.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.6.6.6.6.2.m1.1.1.3.3.2" xref="S4.SS1.6.6.6.6.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.6.6.6.6.2.m1.1b"><apply id="S4.SS1.6.6.6.6.2.m1.1.1.cmml" xref="S4.SS1.6.6.6.6.2.m1.1.1"><times id="S4.SS1.6.6.6.6.2.m1.1.1.1.cmml" xref="S4.SS1.6.6.6.6.2.m1.1.1.1"></times><cn id="S4.SS1.6.6.6.6.2.m1.1.1.2.cmml" type="float" xref="S4.SS1.6.6.6.6.2.m1.1.1.2">4.08</cn><apply id="S4.SS1.6.6.6.6.2.m1.1.1.3.cmml" xref="S4.SS1.6.6.6.6.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.6.6.6.6.2.m1.1.1.3.1.cmml" xref="S4.SS1.6.6.6.6.2.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.6.6.6.6.2.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.6.6.6.6.2.m1.1.1.3.2">10</cn><apply id="S4.SS1.6.6.6.6.2.m1.1.1.3.3.cmml" xref="S4.SS1.6.6.6.6.2.m1.1.1.3.3"><minus id="S4.SS1.6.6.6.6.2.m1.1.1.3.3.1.cmml" xref="S4.SS1.6.6.6.6.2.m1.1.1.3.3"></minus><cn id="S4.SS1.6.6.6.6.2.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.6.6.6.6.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.6.6.6.6.2.m1.1c">4.08\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.6.6.6.6.2.m1.1d">4.08 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.SS1.8.8.8.8">
<td class="ltx_td ltx_align_left" id="S4.SS1.8.8.8.8.3">ECHOPulse (Domain transfer)</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.8.4">Echo-Dynamic</td>
<td class="ltx_td ltx_align_center" id="S4.SS1.7.7.7.7.1" style="background-color:#FFC864;"><math alttext="\pagecolor{orange}{2.89\times 10^{-3}}" class="ltx_Math" display="inline" id="S4.SS1.7.7.7.7.1.m1.1"><semantics id="S4.SS1.7.7.7.7.1.m1.1a"><mrow id="S4.SS1.7.7.7.7.1.m1.1.1" xref="S4.SS1.7.7.7.7.1.m1.1.1.cmml"><mn id="S4.SS1.7.7.7.7.1.m1.1.1.2" mathbackground="#FFC864" xref="S4.SS1.7.7.7.7.1.m1.1.1.2.cmml">2.89</mn><mo id="S4.SS1.7.7.7.7.1.m1.1.1.1" lspace="0.222em" mathbackground="#FFC864" rspace="0.222em" xref="S4.SS1.7.7.7.7.1.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.7.7.7.7.1.m1.1.1.3" xref="S4.SS1.7.7.7.7.1.m1.1.1.3.cmml"><mn id="S4.SS1.7.7.7.7.1.m1.1.1.3.2" mathbackground="#FFC864" xref="S4.SS1.7.7.7.7.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.7.7.7.7.1.m1.1.1.3.3" xref="S4.SS1.7.7.7.7.1.m1.1.1.3.3.cmml"><mo id="S4.SS1.7.7.7.7.1.m1.1.1.3.3a" mathbackground="#FFC864" xref="S4.SS1.7.7.7.7.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.7.7.7.7.1.m1.1.1.3.3.2" mathbackground="#FFC864" xref="S4.SS1.7.7.7.7.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.7.7.7.7.1.m1.1b"><apply id="S4.SS1.7.7.7.7.1.m1.1.1.cmml" xref="S4.SS1.7.7.7.7.1.m1.1.1"><times id="S4.SS1.7.7.7.7.1.m1.1.1.1.cmml" xref="S4.SS1.7.7.7.7.1.m1.1.1.1"></times><cn id="S4.SS1.7.7.7.7.1.m1.1.1.2.cmml" type="float" xref="S4.SS1.7.7.7.7.1.m1.1.1.2">2.89</cn><apply id="S4.SS1.7.7.7.7.1.m1.1.1.3.cmml" xref="S4.SS1.7.7.7.7.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.7.7.7.7.1.m1.1.1.3.1.cmml" xref="S4.SS1.7.7.7.7.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.7.7.7.7.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.7.7.7.7.1.m1.1.1.3.2">10</cn><apply id="S4.SS1.7.7.7.7.1.m1.1.1.3.3.cmml" xref="S4.SS1.7.7.7.7.1.m1.1.1.3.3"><minus id="S4.SS1.7.7.7.7.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.7.7.7.7.1.m1.1.1.3.3"></minus><cn id="S4.SS1.7.7.7.7.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.7.7.7.7.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.7.7.7.7.1.m1.1c">\pagecolor{orange}{2.89\times 10^{-3}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.7.7.7.7.1.m1.1d">2.89 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.SS1.8.8.8.8.2" style="background-color:#FFC864;"><math alttext="\pagecolor{orange}{2.92\times 10^{-2}}" class="ltx_Math" display="inline" id="S4.SS1.8.8.8.8.2.m1.1"><semantics id="S4.SS1.8.8.8.8.2.m1.1a"><mrow id="S4.SS1.8.8.8.8.2.m1.1.1" xref="S4.SS1.8.8.8.8.2.m1.1.1.cmml"><mn id="S4.SS1.8.8.8.8.2.m1.1.1.2" mathbackground="#FFC864" xref="S4.SS1.8.8.8.8.2.m1.1.1.2.cmml">2.92</mn><mo id="S4.SS1.8.8.8.8.2.m1.1.1.1" lspace="0.222em" mathbackground="#FFC864" rspace="0.222em" xref="S4.SS1.8.8.8.8.2.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.8.8.8.8.2.m1.1.1.3" xref="S4.SS1.8.8.8.8.2.m1.1.1.3.cmml"><mn id="S4.SS1.8.8.8.8.2.m1.1.1.3.2" mathbackground="#FFC864" xref="S4.SS1.8.8.8.8.2.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.8.8.8.8.2.m1.1.1.3.3" xref="S4.SS1.8.8.8.8.2.m1.1.1.3.3.cmml"><mo id="S4.SS1.8.8.8.8.2.m1.1.1.3.3a" mathbackground="#FFC864" xref="S4.SS1.8.8.8.8.2.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.8.8.8.8.2.m1.1.1.3.3.2" mathbackground="#FFC864" xref="S4.SS1.8.8.8.8.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.8.8.8.8.2.m1.1b"><apply id="S4.SS1.8.8.8.8.2.m1.1.1.cmml" xref="S4.SS1.8.8.8.8.2.m1.1.1"><times id="S4.SS1.8.8.8.8.2.m1.1.1.1.cmml" xref="S4.SS1.8.8.8.8.2.m1.1.1.1"></times><cn id="S4.SS1.8.8.8.8.2.m1.1.1.2.cmml" type="float" xref="S4.SS1.8.8.8.8.2.m1.1.1.2">2.92</cn><apply id="S4.SS1.8.8.8.8.2.m1.1.1.3.cmml" xref="S4.SS1.8.8.8.8.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.8.8.8.8.2.m1.1.1.3.1.cmml" xref="S4.SS1.8.8.8.8.2.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.8.8.8.8.2.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.8.8.8.8.2.m1.1.1.3.2">10</cn><apply id="S4.SS1.8.8.8.8.2.m1.1.1.3.3.cmml" xref="S4.SS1.8.8.8.8.2.m1.1.1.3.3"><minus id="S4.SS1.8.8.8.8.2.m1.1.1.3.3.1.cmml" xref="S4.SS1.8.8.8.8.2.m1.1.1.3.3"></minus><cn id="S4.SS1.8.8.8.8.2.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.8.8.8.8.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.8.8.8.8.2.m1.1c">\pagecolor{orange}{2.92\times 10^{-2}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.8.8.8.8.2.m1.1d">2.92 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.SS1.10.10.10.10">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.SS1.10.10.10.10.3">ECHOPulse (Only natural videos)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.10.10.10.10.4">Private data</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.9.9.9.9.1"><math alttext="6.09\times 10^{-3}" class="ltx_Math" display="inline" id="S4.SS1.9.9.9.9.1.m1.1"><semantics id="S4.SS1.9.9.9.9.1.m1.1a"><mrow id="S4.SS1.9.9.9.9.1.m1.1.1" xref="S4.SS1.9.9.9.9.1.m1.1.1.cmml"><mn id="S4.SS1.9.9.9.9.1.m1.1.1.2" xref="S4.SS1.9.9.9.9.1.m1.1.1.2.cmml">6.09</mn><mo id="S4.SS1.9.9.9.9.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.9.9.9.9.1.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.9.9.9.9.1.m1.1.1.3" xref="S4.SS1.9.9.9.9.1.m1.1.1.3.cmml"><mn id="S4.SS1.9.9.9.9.1.m1.1.1.3.2" xref="S4.SS1.9.9.9.9.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.9.9.9.9.1.m1.1.1.3.3" xref="S4.SS1.9.9.9.9.1.m1.1.1.3.3.cmml"><mo id="S4.SS1.9.9.9.9.1.m1.1.1.3.3a" xref="S4.SS1.9.9.9.9.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.9.9.9.9.1.m1.1.1.3.3.2" xref="S4.SS1.9.9.9.9.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.9.9.9.9.1.m1.1b"><apply id="S4.SS1.9.9.9.9.1.m1.1.1.cmml" xref="S4.SS1.9.9.9.9.1.m1.1.1"><times id="S4.SS1.9.9.9.9.1.m1.1.1.1.cmml" xref="S4.SS1.9.9.9.9.1.m1.1.1.1"></times><cn id="S4.SS1.9.9.9.9.1.m1.1.1.2.cmml" type="float" xref="S4.SS1.9.9.9.9.1.m1.1.1.2">6.09</cn><apply id="S4.SS1.9.9.9.9.1.m1.1.1.3.cmml" xref="S4.SS1.9.9.9.9.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.9.9.9.9.1.m1.1.1.3.1.cmml" xref="S4.SS1.9.9.9.9.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.9.9.9.9.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.9.9.9.9.1.m1.1.1.3.2">10</cn><apply id="S4.SS1.9.9.9.9.1.m1.1.1.3.3.cmml" xref="S4.SS1.9.9.9.9.1.m1.1.1.3.3"><minus id="S4.SS1.9.9.9.9.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.9.9.9.9.1.m1.1.1.3.3"></minus><cn id="S4.SS1.9.9.9.9.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.9.9.9.9.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.9.9.9.9.1.m1.1c">6.09\times 10^{-3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.9.9.9.9.1.m1.1d">6.09 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.SS1.10.10.10.10.2"><math alttext="4.41\times 10^{-2}" class="ltx_Math" display="inline" id="S4.SS1.10.10.10.10.2.m1.1"><semantics id="S4.SS1.10.10.10.10.2.m1.1a"><mrow id="S4.SS1.10.10.10.10.2.m1.1.1" xref="S4.SS1.10.10.10.10.2.m1.1.1.cmml"><mn id="S4.SS1.10.10.10.10.2.m1.1.1.2" xref="S4.SS1.10.10.10.10.2.m1.1.1.2.cmml">4.41</mn><mo id="S4.SS1.10.10.10.10.2.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.SS1.10.10.10.10.2.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.10.10.10.10.2.m1.1.1.3" xref="S4.SS1.10.10.10.10.2.m1.1.1.3.cmml"><mn id="S4.SS1.10.10.10.10.2.m1.1.1.3.2" xref="S4.SS1.10.10.10.10.2.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.10.10.10.10.2.m1.1.1.3.3" xref="S4.SS1.10.10.10.10.2.m1.1.1.3.3.cmml"><mo id="S4.SS1.10.10.10.10.2.m1.1.1.3.3a" xref="S4.SS1.10.10.10.10.2.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.10.10.10.10.2.m1.1.1.3.3.2" xref="S4.SS1.10.10.10.10.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.10.10.10.10.2.m1.1b"><apply id="S4.SS1.10.10.10.10.2.m1.1.1.cmml" xref="S4.SS1.10.10.10.10.2.m1.1.1"><times id="S4.SS1.10.10.10.10.2.m1.1.1.1.cmml" xref="S4.SS1.10.10.10.10.2.m1.1.1.1"></times><cn id="S4.SS1.10.10.10.10.2.m1.1.1.2.cmml" type="float" xref="S4.SS1.10.10.10.10.2.m1.1.1.2">4.41</cn><apply id="S4.SS1.10.10.10.10.2.m1.1.1.3.cmml" xref="S4.SS1.10.10.10.10.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.10.10.10.10.2.m1.1.1.3.1.cmml" xref="S4.SS1.10.10.10.10.2.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.10.10.10.10.2.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.10.10.10.10.2.m1.1.1.3.2">10</cn><apply id="S4.SS1.10.10.10.10.2.m1.1.1.3.3.cmml" xref="S4.SS1.10.10.10.10.2.m1.1.1.3.3"><minus id="S4.SS1.10.10.10.10.2.m1.1.1.3.3.1.cmml" xref="S4.SS1.10.10.10.10.2.m1.1.1.3.3"></minus><cn id="S4.SS1.10.10.10.10.2.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.10.10.10.10.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.10.10.10.10.2.m1.1c">4.41\times 10^{-2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.10.10.10.10.2.m1.1d">4.41 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.SS1.12.12.12.12">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.SS1.12.12.12.12.3">ECHOPulse (Domain transfer)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.SS1.12.12.12.12.4">Private data</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.SS1.11.11.11.11.1" style="background-color:#FFC864;"><math alttext="\pagecolor{orange}{2.91\times 10^{-3}}" class="ltx_Math" display="inline" id="S4.SS1.11.11.11.11.1.m1.1"><semantics id="S4.SS1.11.11.11.11.1.m1.1a"><mrow id="S4.SS1.11.11.11.11.1.m1.1.1" xref="S4.SS1.11.11.11.11.1.m1.1.1.cmml"><mn id="S4.SS1.11.11.11.11.1.m1.1.1.2" mathbackground="#FFC864" xref="S4.SS1.11.11.11.11.1.m1.1.1.2.cmml">2.91</mn><mo id="S4.SS1.11.11.11.11.1.m1.1.1.1" lspace="0.222em" mathbackground="#FFC864" rspace="0.222em" xref="S4.SS1.11.11.11.11.1.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.11.11.11.11.1.m1.1.1.3" xref="S4.SS1.11.11.11.11.1.m1.1.1.3.cmml"><mn id="S4.SS1.11.11.11.11.1.m1.1.1.3.2" mathbackground="#FFC864" xref="S4.SS1.11.11.11.11.1.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.11.11.11.11.1.m1.1.1.3.3" xref="S4.SS1.11.11.11.11.1.m1.1.1.3.3.cmml"><mo id="S4.SS1.11.11.11.11.1.m1.1.1.3.3a" mathbackground="#FFC864" xref="S4.SS1.11.11.11.11.1.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.11.11.11.11.1.m1.1.1.3.3.2" mathbackground="#FFC864" xref="S4.SS1.11.11.11.11.1.m1.1.1.3.3.2.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.11.11.11.11.1.m1.1b"><apply id="S4.SS1.11.11.11.11.1.m1.1.1.cmml" xref="S4.SS1.11.11.11.11.1.m1.1.1"><times id="S4.SS1.11.11.11.11.1.m1.1.1.1.cmml" xref="S4.SS1.11.11.11.11.1.m1.1.1.1"></times><cn id="S4.SS1.11.11.11.11.1.m1.1.1.2.cmml" type="float" xref="S4.SS1.11.11.11.11.1.m1.1.1.2">2.91</cn><apply id="S4.SS1.11.11.11.11.1.m1.1.1.3.cmml" xref="S4.SS1.11.11.11.11.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.11.11.11.11.1.m1.1.1.3.1.cmml" xref="S4.SS1.11.11.11.11.1.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.11.11.11.11.1.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.11.11.11.11.1.m1.1.1.3.2">10</cn><apply id="S4.SS1.11.11.11.11.1.m1.1.1.3.3.cmml" xref="S4.SS1.11.11.11.11.1.m1.1.1.3.3"><minus id="S4.SS1.11.11.11.11.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.11.11.11.11.1.m1.1.1.3.3"></minus><cn id="S4.SS1.11.11.11.11.1.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.11.11.11.11.1.m1.1.1.3.3.2">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.11.11.11.11.1.m1.1c">\pagecolor{orange}{2.91\times 10^{-3}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.11.11.11.11.1.m1.1d">2.91 × 10 start_POSTSUPERSCRIPT - 3 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.SS1.12.12.12.12.2" style="background-color:#FFC864;"><math alttext="\pagecolor{orange}{2.97\times 10^{-2}}" class="ltx_Math" display="inline" id="S4.SS1.12.12.12.12.2.m1.1"><semantics id="S4.SS1.12.12.12.12.2.m1.1a"><mrow id="S4.SS1.12.12.12.12.2.m1.1.1" xref="S4.SS1.12.12.12.12.2.m1.1.1.cmml"><mn id="S4.SS1.12.12.12.12.2.m1.1.1.2" mathbackground="#FFC864" xref="S4.SS1.12.12.12.12.2.m1.1.1.2.cmml">2.97</mn><mo id="S4.SS1.12.12.12.12.2.m1.1.1.1" lspace="0.222em" mathbackground="#FFC864" rspace="0.222em" xref="S4.SS1.12.12.12.12.2.m1.1.1.1.cmml">×</mo><msup id="S4.SS1.12.12.12.12.2.m1.1.1.3" xref="S4.SS1.12.12.12.12.2.m1.1.1.3.cmml"><mn id="S4.SS1.12.12.12.12.2.m1.1.1.3.2" mathbackground="#FFC864" xref="S4.SS1.12.12.12.12.2.m1.1.1.3.2.cmml">10</mn><mrow id="S4.SS1.12.12.12.12.2.m1.1.1.3.3" xref="S4.SS1.12.12.12.12.2.m1.1.1.3.3.cmml"><mo id="S4.SS1.12.12.12.12.2.m1.1.1.3.3a" mathbackground="#FFC864" xref="S4.SS1.12.12.12.12.2.m1.1.1.3.3.cmml">−</mo><mn id="S4.SS1.12.12.12.12.2.m1.1.1.3.3.2" mathbackground="#FFC864" xref="S4.SS1.12.12.12.12.2.m1.1.1.3.3.2.cmml">2</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.12.12.12.12.2.m1.1b"><apply id="S4.SS1.12.12.12.12.2.m1.1.1.cmml" xref="S4.SS1.12.12.12.12.2.m1.1.1"><times id="S4.SS1.12.12.12.12.2.m1.1.1.1.cmml" xref="S4.SS1.12.12.12.12.2.m1.1.1.1"></times><cn id="S4.SS1.12.12.12.12.2.m1.1.1.2.cmml" type="float" xref="S4.SS1.12.12.12.12.2.m1.1.1.2">2.97</cn><apply id="S4.SS1.12.12.12.12.2.m1.1.1.3.cmml" xref="S4.SS1.12.12.12.12.2.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.12.12.12.12.2.m1.1.1.3.1.cmml" xref="S4.SS1.12.12.12.12.2.m1.1.1.3">superscript</csymbol><cn id="S4.SS1.12.12.12.12.2.m1.1.1.3.2.cmml" type="integer" xref="S4.SS1.12.12.12.12.2.m1.1.1.3.2">10</cn><apply id="S4.SS1.12.12.12.12.2.m1.1.1.3.3.cmml" xref="S4.SS1.12.12.12.12.2.m1.1.1.3.3"><minus id="S4.SS1.12.12.12.12.2.m1.1.1.3.3.1.cmml" xref="S4.SS1.12.12.12.12.2.m1.1.1.3.3"></minus><cn id="S4.SS1.12.12.12.12.2.m1.1.1.3.3.2.cmml" type="integer" xref="S4.SS1.12.12.12.12.2.m1.1.1.3.3.2">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.12.12.12.12.2.m1.1c">\pagecolor{orange}{2.97\times 10^{-2}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.12.12.12.12.2.m1.1d">2.97 × 10 start_POSTSUPERSCRIPT - 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1">These results indicate that, despite the common expectation that diffusion-based models perform better in terms of reconstruction quality, our VQ-VAE model was able to quickly converge in a new domain. With only one epoch of fine-tuning, it achieved results comparable to or even surpassing those of the diffusion-based model. This further demonstrates the potential of our model for clinical applications, where it can quickly adapt to new tasks or datasets without the need for retraining from scratch, offering greater practical utility and flexibility.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Video Generation Performance</h3>
<div class="ltx_para ltx_noindent" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We evaluate our model on two objectives:
1) image quality (FID <cite class="ltx_cite ltx_citemacro_citep">(Heusel et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib11" title="">2017</a>)</cite>, FVD <cite class="ltx_cite ltx_citemacro_citep">(Unterthiner et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib36" title="">2018</a>)</cite>, SSIM <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib41" title="">2004</a>)</cite>) and left ventricular ejection fraction (LVEF/EF) accuracy. Since we are the first to explore ECG-guided ECHO video generation, and most prior works generating ECHO videos from text have not been open-sourced, we were unable to reproduce their results on our dataset. However, those related papers have clearly reported experimental parameters, datasets, and data split methods. Therefore, we trained ECHOPulse using T5X <cite class="ltx_cite ltx_citemacro_citep">(Roberts et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib32" title="">2023</a>)</cite> as the text encoder on both the CAMUS and EchoNet datasets. All experimental settings, including video resolution and parameters, were kept consistent with those reported in previous studies.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span><span class="ltx_text ltx_font_bold" id="S4.T2.10.1">Image quality metrics:</span> The videos generated by different methods under various conditions across three datasets are evaluated using three image quality metrics. The <span class="ltx_text" id="S4.T2.11.2" style="background-color:#FFC864;">best</span> and <span class="ltx_text" id="S4.T2.12.3" style="background-color:#FFF3C2;">second</span> results are highlighted. Note that EchoNet-Synthetic <cite class="ltx_cite ltx_citemacro_citep">(Reynaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib31" title="">2024</a>)</cite> did not report the SSIM metric and did not specify whether the results correspond to A2C or A4C views.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.6" style="width:433.6pt;height:167.8pt;vertical-align:-0.6pt;"><span class="ltx_transformed_inner" style="transform:translate(-156.6pt,60.4pt) scale(0.58056978568453,0.58056978568453) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.6.6">
<tr class="ltx_tr" id="S4.T2.6.6.7">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T2.6.6.7.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.6.6.7.1.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.6.6.7.2" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.6.6.7.2.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.6.6.7.3" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T2.6.6.7.3.1">Condition</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.6.6.7.4"><span class="ltx_text ltx_font_bold" id="S4.T2.6.6.7.4.1">A2C</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T2.6.6.7.5"><span class="ltx_text ltx_font_bold" id="S4.T2.6.6.7.5.1">A4C</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.1">FID<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.1.m1.1a"><mo id="S4.T2.1.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T2.1.1.1.1.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.2.2.2.2"><span class="ltx_text ltx_font_bold" id="S4.T2.2.2.2.2.1">FVD<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.2.2.2.2.1.m1.1"><semantics id="S4.T2.2.2.2.2.1.m1.1a"><mo id="S4.T2.2.2.2.2.1.m1.1.1" stretchy="false" xref="S4.T2.2.2.2.2.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.1.m1.1b"><ci id="S4.T2.2.2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.2.2.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.2.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.3.3.3.3"><span class="ltx_text ltx_font_bold" id="S4.T2.3.3.3.3.1">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.3.3.3.3.1.m1.1"><semantics id="S4.T2.3.3.3.3.1.m1.1a"><mo id="S4.T2.3.3.3.3.1.m1.1.1" stretchy="false" xref="S4.T2.3.3.3.3.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.1.m1.1b"><ci id="S4.T2.3.3.3.3.1.m1.1.1.cmml" xref="S4.T2.3.3.3.3.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.3.1.m1.1d">↑</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.4.4.4"><span class="ltx_text ltx_font_bold" id="S4.T2.4.4.4.4.1">FID<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.4.4.4.4.1.m1.1"><semantics id="S4.T2.4.4.4.4.1.m1.1a"><mo id="S4.T2.4.4.4.4.1.m1.1.1" stretchy="false" xref="S4.T2.4.4.4.4.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.1.m1.1b"><ci id="S4.T2.4.4.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.4.4.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.4.4.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.5.5.5.5"><span class="ltx_text ltx_font_bold" id="S4.T2.5.5.5.5.1">FVD<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T2.5.5.5.5.1.m1.1"><semantics id="S4.T2.5.5.5.5.1.m1.1a"><mo id="S4.T2.5.5.5.5.1.m1.1.1" stretchy="false" xref="S4.T2.5.5.5.5.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.5.1.m1.1b"><ci id="S4.T2.5.5.5.5.1.m1.1.1.cmml" xref="S4.T2.5.5.5.5.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.5.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.5.5.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.6.6"><span class="ltx_text ltx_font_bold" id="S4.T2.6.6.6.6.1">SSIM<math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T2.6.6.6.6.1.m1.1"><semantics id="S4.T2.6.6.6.6.1.m1.1a"><mo id="S4.T2.6.6.6.6.1.m1.1.1" stretchy="false" xref="S4.T2.6.6.6.6.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.6.1.m1.1b"><ci id="S4.T2.6.6.6.6.1.m1.1.1.cmml" xref="S4.T2.6.6.6.6.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.6.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.6.6.1.m1.1d">↑</annotation></semantics></math></span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.8">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.6.6.8.1">MoonShot <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib46" title="">2024</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.8.2">CAMUS</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.8.3">Text</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.8.4">48.44</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.8.5">202.41</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.8.6">0.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.8.7">61.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.8.8">290.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.8.9">0.62</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.9">
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.9.1">VideoComposer <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib40" title="">2024</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.9.2">CAMUS</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.9.3">Text</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.9.4">37.68</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.9.5">164.96</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.9.6">0.60</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.9.7">35.04</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.9.8">180.32</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.9.9">0.61</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.10">
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.10.1">HeartBeat <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib47" title="">2024</a>)</cite>
</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.10.2">CAMUS</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.10.3">Text</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.10.4">107.66</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.10.5">305.12</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.10.6">0.53</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.10.7">76.46</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.10.8">381.28</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.10.9">0.53</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.11">
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.11.1">ECHOPulse (Only natural videos)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.11.2">CAMUS</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.11.3">Text</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.11.4">12.71</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.11.5">273.15</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.11.6">0.61</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.11.7">15.38</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.11.8">336.04</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.11.9">0.58</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.12">
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.12.1">ECHOPulse (Domain transfer)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.12.2">CAMUS</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.12.3">Text</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.12.4">5.65</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.12.5">211.85</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.12.6">0.79</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.12.7">8.17</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.12.8">283.32</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.12.9">0.75</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.13">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.6.6.13.1">EchoDiffusion <cite class="ltx_cite ltx_citemacro_citep">(Reynaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib30" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.13.2">Echo-Dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.13.3">Text+EF</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.13.4">24.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.13.5">228.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.13.6">0.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.13.7">24.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.13.8">228.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.13.9">0.48</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.14">
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.14.1">ECHOPulse (Only natural videos)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.14.2">Echo-Dynamic</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.14.3">Text</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.14.4">36.10</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.14.5">319.25</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.14.6">0.39</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.14.7">44.21</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.14.8">334.95</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.14.9">0.35</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.15">
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.15.1">ECHOPulse (Domain transfer)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.15.2">Echo-Dynamic</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.15.3">Text</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.15.4">27.50</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.15.5">249.46</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.15.6">0.46</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.15.7">29.83</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.15.8">312.31</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.15.9">0.41</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.16">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.6.6.16.1">ECHOPulse (Only natural videos)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.16.2">Private data</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.16.3">Text</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.16.4">27.49</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.16.5">291.67</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.16.6">0.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.16.7">34.13</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.16.8">374.92</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.16.9">0.51</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.17">
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.17.1">ECHOPulse(Domain transfer)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.17.2">Private data</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.17.3">Text</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.17.4">25.44</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.17.5">224.90</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.17.6">0.54</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.17.7">31.21</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.17.8">334.09</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.17.9">0.54</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.18">
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.18.1">ECHOPulse (Only natural videos)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.18.2">Private data</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.18.3">ECG</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.18.4" style="background-color:#FFF3C2;"><span class="ltx_text" id="S4.T2.6.6.18.4.1" style="background-color:#FFF3C2;">18.73</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.18.5" style="background-color:#FFF3C2;"><span class="ltx_text" id="S4.T2.6.6.18.5.1" style="background-color:#FFF3C2;">200.45</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.18.6" style="background-color:#FFF3C2;"><span class="ltx_text" id="S4.T2.6.6.18.6.1" style="background-color:#FFF3C2;">0.56</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.18.7" style="background-color:#FFF3C2;"><span class="ltx_text" id="S4.T2.6.6.18.7.1" style="background-color:#FFF3C2;">27.37</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.18.8" style="background-color:#FFF3C2;"><span class="ltx_text" id="S4.T2.6.6.18.8.1" style="background-color:#FFF3C2;">302.89</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.18.9" style="background-color:#FFF3C2;"><span class="ltx_text" id="S4.T2.6.6.18.9.1" style="background-color:#FFF3C2;">0.55</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.19">
<td class="ltx_td ltx_align_left" id="S4.T2.6.6.19.1">ECHOPulse (Domain transfer)</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.19.2">Private data</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.19.3">ECG</td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.19.4" style="background-color:#FFC864;"><span class="ltx_text" id="S4.T2.6.6.19.4.1" style="background-color:#FFC864;">15.50</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.19.5" style="background-color:#FFC864;"><span class="ltx_text" id="S4.T2.6.6.19.5.1" style="background-color:#FFC864;">82.44</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.19.6" style="background-color:#FFC864;"><span class="ltx_text" id="S4.T2.6.6.19.6.1" style="background-color:#FFC864;">0.67</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.19.7" style="background-color:#FFC864;"><span class="ltx_text" id="S4.T2.6.6.19.7.1" style="background-color:#FFC864;">20.82</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.19.8" style="background-color:#FFC864;"><span class="ltx_text" id="S4.T2.6.6.19.8.1" style="background-color:#FFC864;">107.40</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.6.6.19.9" style="background-color:#FFC864;"><span class="ltx_text" id="S4.T2.6.6.19.9.1" style="background-color:#FFC864;">0.66</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.20">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.6.6.20.1">HeartBeat <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib47" title="">2024</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.20.2">CAMUS</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.20.3">Text+Sketch+Mask+…</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.20.4">25.23</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.20.5">97.28</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.20.6">0.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.20.7">31.99</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.20.8">159.36</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.6.6.20.9">0.65</td>
</tr>
<tr class="ltx_tr" id="S4.T2.6.6.21">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.6.6.21.1">EchoNet-Synthetic <cite class="ltx_cite ltx_citemacro_citep">(Reynaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib31" title="">2024</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.6.21.2">Echo-Dynamic</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.6.21.3">Video+EF</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.6.21.4">16.90</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.6.21.5">87.40</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.6.21.6">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.6.21.7">16.90</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.6.21.8">87.40</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.6.6.21.9">-</td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Based on Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S4.T2" title="Table 2 ‣ 4.2 Video Generation Performance ‣ 4 EXPERIMENTS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">2</span></a>, ECHOPulse outperforms other models across several key metrics. In the ECG-conditioned setting, it achieves the lowest FID scores of 15.50 (A2C) and 20.82 (A4C), indicating highly realistic video generation. Its FVD scores of 82.44 (A2C) and 107.40 (A4C) further highlight its ability to capture temporal dynamics. Additionally, ECHOPulse’s SSIM scores of 0.67 (A2C) and 0.66 (A4C) are higher than those of competing models, showcasing its superior video quality and structural coherence.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">ECHOPulse+Text significantly outperforms the HeartBeat model, which also uses text control, on the CAMUS dataset, achieving lower FID 5.65/8.17 and higher SSIM scores 0.79/0.75. As CAMUS is currently the highest-quality publicly available ECHO dataset, all models perform better on CAMUS, while the modest FVD scores 211.85/283.32 highlight the limitations of text-based control. ECHOPulse+Txt also exceeds EchoDiffusion on EchoNet-Dynamic. While VQ-VAE models may lag behind diffusion in video quality, their compatibility with ECG foundation models, coupled with the strong ECG-ECHO correlation, drives ECHOPulse’s superior performance.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1">After LoRA fine-tuning, ECHOPulse shows further improvement but still falls slightly short of HeartBeat, which uses six conditions, and EchoNet-Synthetic, which modifies entire videos based on a given LVEF value. However, ECHOPulse+ECG excels on the larger, more complex private dataset, demonstrating the effectiveness of ECG as a condition for video generation.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1">To validate that the generated videos are synchronized with the ECG signals, we compared the cardiac phases between the generated and original videos, focusing on the end-diastole (ED) and end-systole (ES) phases. ED, which corresponds to the R wave in the ECG, represents the moment when the chamber area is at its largest. Similarly, ES corresponds to the T wave, when the chamber area is at its smallest. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.F2" title="Figure 2 ‣ Optimization: ‣ 3.2 Alignment between Video and ECG Tokens ‣ 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">2</span></a>, the generated videos, conditioned on the input image and ECG, strictly follow the phase changes dictated by the ECG. A more quantitative evaluation is performed by assessing the LVEF, demonstrating the alignment of cardiac dynamics between the generated and original ECHO video.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p6">
<p class="ltx_p" id="S4.SS2.p6.1">To evaluate our model’s performance on LVEF accuracy, we applied SAM2 <cite class="ltx_cite ltx_citemacro_citep">(Ravi et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib29" title="">2024</a>)</cite> to the generated videos for direct segmentation of the endocardium, epicardium, and left atrium. After segmenting the cardiac chamber structures, we compared the LVEF between the original echocardiograms and the generated ones. <math alttext="LVEF=\frac{LVED-LVES}{LVED}" class="ltx_Math" display="inline" id="S4.SS2.p6.1.m1.1"><semantics id="S4.SS2.p6.1.m1.1a"><mrow id="S4.SS2.p6.1.m1.1.1" xref="S4.SS2.p6.1.m1.1.1.cmml"><mrow id="S4.SS2.p6.1.m1.1.1.2" xref="S4.SS2.p6.1.m1.1.1.2.cmml"><mi id="S4.SS2.p6.1.m1.1.1.2.2" xref="S4.SS2.p6.1.m1.1.1.2.2.cmml">L</mi><mo id="S4.SS2.p6.1.m1.1.1.2.1" xref="S4.SS2.p6.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.2.3" xref="S4.SS2.p6.1.m1.1.1.2.3.cmml">V</mi><mo id="S4.SS2.p6.1.m1.1.1.2.1a" xref="S4.SS2.p6.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.2.4" xref="S4.SS2.p6.1.m1.1.1.2.4.cmml">E</mi><mo id="S4.SS2.p6.1.m1.1.1.2.1b" xref="S4.SS2.p6.1.m1.1.1.2.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.2.5" xref="S4.SS2.p6.1.m1.1.1.2.5.cmml">F</mi></mrow><mo id="S4.SS2.p6.1.m1.1.1.1" xref="S4.SS2.p6.1.m1.1.1.1.cmml">=</mo><mfrac id="S4.SS2.p6.1.m1.1.1.3" xref="S4.SS2.p6.1.m1.1.1.3.cmml"><mrow id="S4.SS2.p6.1.m1.1.1.3.2" xref="S4.SS2.p6.1.m1.1.1.3.2.cmml"><mrow id="S4.SS2.p6.1.m1.1.1.3.2.2" xref="S4.SS2.p6.1.m1.1.1.3.2.2.cmml"><mi id="S4.SS2.p6.1.m1.1.1.3.2.2.2" xref="S4.SS2.p6.1.m1.1.1.3.2.2.2.cmml">L</mi><mo id="S4.SS2.p6.1.m1.1.1.3.2.2.1" xref="S4.SS2.p6.1.m1.1.1.3.2.2.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.3.2.2.3" xref="S4.SS2.p6.1.m1.1.1.3.2.2.3.cmml">V</mi><mo id="S4.SS2.p6.1.m1.1.1.3.2.2.1a" xref="S4.SS2.p6.1.m1.1.1.3.2.2.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.3.2.2.4" xref="S4.SS2.p6.1.m1.1.1.3.2.2.4.cmml">E</mi><mo id="S4.SS2.p6.1.m1.1.1.3.2.2.1b" xref="S4.SS2.p6.1.m1.1.1.3.2.2.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.3.2.2.5" xref="S4.SS2.p6.1.m1.1.1.3.2.2.5.cmml">D</mi></mrow><mo id="S4.SS2.p6.1.m1.1.1.3.2.1" xref="S4.SS2.p6.1.m1.1.1.3.2.1.cmml">−</mo><mrow id="S4.SS2.p6.1.m1.1.1.3.2.3" xref="S4.SS2.p6.1.m1.1.1.3.2.3.cmml"><mi id="S4.SS2.p6.1.m1.1.1.3.2.3.2" xref="S4.SS2.p6.1.m1.1.1.3.2.3.2.cmml">L</mi><mo id="S4.SS2.p6.1.m1.1.1.3.2.3.1" xref="S4.SS2.p6.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.3.2.3.3" xref="S4.SS2.p6.1.m1.1.1.3.2.3.3.cmml">V</mi><mo id="S4.SS2.p6.1.m1.1.1.3.2.3.1a" xref="S4.SS2.p6.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.3.2.3.4" xref="S4.SS2.p6.1.m1.1.1.3.2.3.4.cmml">E</mi><mo id="S4.SS2.p6.1.m1.1.1.3.2.3.1b" xref="S4.SS2.p6.1.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.3.2.3.5" xref="S4.SS2.p6.1.m1.1.1.3.2.3.5.cmml">S</mi></mrow></mrow><mrow id="S4.SS2.p6.1.m1.1.1.3.3" xref="S4.SS2.p6.1.m1.1.1.3.3.cmml"><mi id="S4.SS2.p6.1.m1.1.1.3.3.2" xref="S4.SS2.p6.1.m1.1.1.3.3.2.cmml">L</mi><mo id="S4.SS2.p6.1.m1.1.1.3.3.1" xref="S4.SS2.p6.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.3.3.3" xref="S4.SS2.p6.1.m1.1.1.3.3.3.cmml">V</mi><mo id="S4.SS2.p6.1.m1.1.1.3.3.1a" xref="S4.SS2.p6.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.3.3.4" xref="S4.SS2.p6.1.m1.1.1.3.3.4.cmml">E</mi><mo id="S4.SS2.p6.1.m1.1.1.3.3.1b" xref="S4.SS2.p6.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS2.p6.1.m1.1.1.3.3.5" xref="S4.SS2.p6.1.m1.1.1.3.3.5.cmml">D</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p6.1.m1.1b"><apply id="S4.SS2.p6.1.m1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1"><eq id="S4.SS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.p6.1.m1.1.1.1"></eq><apply id="S4.SS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2"><times id="S4.SS2.p6.1.m1.1.1.2.1.cmml" xref="S4.SS2.p6.1.m1.1.1.2.1"></times><ci id="S4.SS2.p6.1.m1.1.1.2.2.cmml" xref="S4.SS2.p6.1.m1.1.1.2.2">𝐿</ci><ci id="S4.SS2.p6.1.m1.1.1.2.3.cmml" xref="S4.SS2.p6.1.m1.1.1.2.3">𝑉</ci><ci id="S4.SS2.p6.1.m1.1.1.2.4.cmml" xref="S4.SS2.p6.1.m1.1.1.2.4">𝐸</ci><ci id="S4.SS2.p6.1.m1.1.1.2.5.cmml" xref="S4.SS2.p6.1.m1.1.1.2.5">𝐹</ci></apply><apply id="S4.SS2.p6.1.m1.1.1.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3"><divide id="S4.SS2.p6.1.m1.1.1.3.1.cmml" xref="S4.SS2.p6.1.m1.1.1.3"></divide><apply id="S4.SS2.p6.1.m1.1.1.3.2.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2"><minus id="S4.SS2.p6.1.m1.1.1.3.2.1.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.1"></minus><apply id="S4.SS2.p6.1.m1.1.1.3.2.2.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.2"><times id="S4.SS2.p6.1.m1.1.1.3.2.2.1.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.2.1"></times><ci id="S4.SS2.p6.1.m1.1.1.3.2.2.2.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.2.2">𝐿</ci><ci id="S4.SS2.p6.1.m1.1.1.3.2.2.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.2.3">𝑉</ci><ci id="S4.SS2.p6.1.m1.1.1.3.2.2.4.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.2.4">𝐸</ci><ci id="S4.SS2.p6.1.m1.1.1.3.2.2.5.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.2.5">𝐷</ci></apply><apply id="S4.SS2.p6.1.m1.1.1.3.2.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.3"><times id="S4.SS2.p6.1.m1.1.1.3.2.3.1.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.3.1"></times><ci id="S4.SS2.p6.1.m1.1.1.3.2.3.2.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.3.2">𝐿</ci><ci id="S4.SS2.p6.1.m1.1.1.3.2.3.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.3.3">𝑉</ci><ci id="S4.SS2.p6.1.m1.1.1.3.2.3.4.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.3.4">𝐸</ci><ci id="S4.SS2.p6.1.m1.1.1.3.2.3.5.cmml" xref="S4.SS2.p6.1.m1.1.1.3.2.3.5">𝑆</ci></apply></apply><apply id="S4.SS2.p6.1.m1.1.1.3.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3.3"><times id="S4.SS2.p6.1.m1.1.1.3.3.1.cmml" xref="S4.SS2.p6.1.m1.1.1.3.3.1"></times><ci id="S4.SS2.p6.1.m1.1.1.3.3.2.cmml" xref="S4.SS2.p6.1.m1.1.1.3.3.2">𝐿</ci><ci id="S4.SS2.p6.1.m1.1.1.3.3.3.cmml" xref="S4.SS2.p6.1.m1.1.1.3.3.3">𝑉</ci><ci id="S4.SS2.p6.1.m1.1.1.3.3.4.cmml" xref="S4.SS2.p6.1.m1.1.1.3.3.4">𝐸</ci><ci id="S4.SS2.p6.1.m1.1.1.3.3.5.cmml" xref="S4.SS2.p6.1.m1.1.1.3.3.5">𝐷</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p6.1.m1.1c">LVEF=\frac{LVED-LVES}{LVED}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p6.1.m1.1d">italic_L italic_V italic_E italic_F = divide start_ARG italic_L italic_V italic_E italic_D - italic_L italic_V italic_E italic_S end_ARG start_ARG italic_L italic_V italic_E italic_D end_ARG</annotation></semantics></math>.
This comparison ensured that the generated videos were controlled solely by the ECG signals—introducing temporal information without affecting the structural integrity of the heart images. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S4.F3" title="Figure 3 ‣ 4 EXPERIMENTS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS2.p7">
<p class="ltx_p" id="S4.SS2.p7.1">It can be observed that ECHOPulse is capable of generating realistic videos with relatively accurate EF values, regardless of whether the input is an original ECG or a flat ECG. In particular, Condition 4 demonstrates the model’s ability to generate videos using daily ECG signals collected directly from an Apple Watch. This highlights ECHOPulse’s zero-shot capability in handling general ECG signals, showcasing its potential for broad applicability with real-world ECG data.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span><span class="ltx_text ltx_font_bold" id="S4.T3.8.1">Clinical and time-inference metrics:</span> This table presents the EF (Ejection Fraction) differences between the generated videos and the target ones. The sampling time refers to the time required to generate 64 video frames. The <span class="ltx_text" id="S4.T3.9.2" style="background-color:#FFC864;">best</span> results are highlighted.</figcaption>
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.5" style="width:433.6pt;height:40.5pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-77.6pt,7.1pt) scale(0.736480494581406,0.736480494581406) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.5.5">
<tr class="ltx_tr" id="S4.T3.5.5.5">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T3.5.5.5.6"><span class="ltx_text ltx_font_bold" id="S4.T3.5.5.5.6.1">Methods</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.5.5.5.7"><span class="ltx_text ltx_font_bold" id="S4.T3.5.5.5.7.1">Condition</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.2.2.2.2">
<math alttext="\bf R^{2}" class="ltx_Math" display="inline" id="S4.T3.1.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.1.m1.1a"><msup id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml"><mi id="S4.T3.1.1.1.1.m1.1.1.2" xref="S4.T3.1.1.1.1.m1.1.1.2.cmml">𝐑</mi><mn id="S4.T3.1.1.1.1.m1.1.1.3" xref="S4.T3.1.1.1.1.m1.1.1.3.cmml">𝟐</mn></msup><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><apply id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.1.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">superscript</csymbol><ci id="S4.T3.1.1.1.1.m1.1.1.2.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2">𝐑</ci><cn id="S4.T3.1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S4.T3.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">\bf R^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.1.m1.1d">bold_R start_POSTSUPERSCRIPT bold_2 end_POSTSUPERSCRIPT</annotation></semantics></math> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.2.2.2.2.m2.1"><semantics id="S4.T3.2.2.2.2.m2.1a"><mo id="S4.T3.2.2.2.2.m2.1.1" stretchy="false" xref="S4.T3.2.2.2.2.m2.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.m2.1b"><ci id="S4.T3.2.2.2.2.m2.1.1.cmml" xref="S4.T3.2.2.2.2.m2.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.m2.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.2.2.m2.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.3.3.3">
<span class="ltx_text ltx_font_bold" id="S4.T3.3.3.3.3.1">MAE</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.3.3.3.3.m1.1"><semantics id="S4.T3.3.3.3.3.m1.1a"><mo id="S4.T3.3.3.3.3.m1.1.1" stretchy="false" xref="S4.T3.3.3.3.3.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.3.m1.1b"><ci id="S4.T3.3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.3.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.3.3.3.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.4.4.4.4">
<span class="ltx_text ltx_font_bold" id="S4.T3.4.4.4.4.1">RMSE</span> <math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.4.4.4.4.m1.1"><semantics id="S4.T3.4.4.4.4.m1.1a"><mo id="S4.T3.4.4.4.4.m1.1.1" stretchy="false" xref="S4.T3.4.4.4.4.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.4.m1.1b"><ci id="S4.T3.4.4.4.4.m1.1.1.cmml" xref="S4.T3.4.4.4.4.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.4.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.4.4.4.m1.1d">↓</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.5.5.5.5"><span class="ltx_text ltx_font_bold" id="S4.T3.5.5.5.5.1">S. time<math alttext="\downarrow" class="ltx_Math" display="inline" id="S4.T3.5.5.5.5.1.m1.1"><semantics id="S4.T3.5.5.5.5.1.m1.1a"><mo id="S4.T3.5.5.5.5.1.m1.1.1" stretchy="false" xref="S4.T3.5.5.5.5.1.m1.1.1.cmml">↓</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.5.1.m1.1b"><ci id="S4.T3.5.5.5.5.1.m1.1.1.cmml" xref="S4.T3.5.5.5.5.1.m1.1.1">↓</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.5.5.1.m1.1c">\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.5.5.5.1.m1.1d">↓</annotation></semantics></math></span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt" id="S4.T3.5.5.5.8"><span class="ltx_text ltx_font_bold" id="S4.T3.5.5.5.8.1">Parameters</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.5.6">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T3.5.5.6.1">EchoDiffusion <cite class="ltx_cite ltx_citemacro_citep">(Reynaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib30" title="">2023</a>)</cite>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.5.6.2">Image+EF</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.5.6.3" style="background-color:#FFC864;"><span class="ltx_text" id="S4.T3.5.5.6.3.1" style="background-color:#FFC864;">0.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.5.6.4">4.81</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.5.6.5">6.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.5.5.6.6">Gen. 146s</td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t" id="S4.T3.5.5.6.7">381M</td>
</tr>
<tr class="ltx_tr" id="S4.T3.5.5.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T3.5.5.7.1">ECHOPulse</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.5.5.7.2">Image+ECG</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.5.5.7.3">0.85</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.5.5.7.4" style="background-color:#FFC864;"><span class="ltx_text" id="S4.T3.5.5.7.4.1" style="background-color:#FFC864;">2.51</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.5.5.7.5" style="background-color:#FFC864;"><span class="ltx_text" id="S4.T3.5.5.7.5.1" style="background-color:#FFC864;">2.86</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.5.5.7.6" style="background-color:#FFC864;"><span class="ltx_text" id="S4.T3.5.5.7.6.1" style="background-color:#FFC864;">Gen. 6.4s</span></td>
<td class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb" id="S4.T3.5.5.7.7">279M</td>
</tr>
</table>
</span></div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS2.p8">
<p class="ltx_p" id="S4.SS2.p8.1">Quantitative results of <math alttext="LVEF" class="ltx_Math" display="inline" id="S4.SS2.p8.1.m1.1"><semantics id="S4.SS2.p8.1.m1.1a"><mrow id="S4.SS2.p8.1.m1.1.1" xref="S4.SS2.p8.1.m1.1.1.cmml"><mi id="S4.SS2.p8.1.m1.1.1.2" xref="S4.SS2.p8.1.m1.1.1.2.cmml">L</mi><mo id="S4.SS2.p8.1.m1.1.1.1" xref="S4.SS2.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p8.1.m1.1.1.3" xref="S4.SS2.p8.1.m1.1.1.3.cmml">V</mi><mo id="S4.SS2.p8.1.m1.1.1.1a" xref="S4.SS2.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p8.1.m1.1.1.4" xref="S4.SS2.p8.1.m1.1.1.4.cmml">E</mi><mo id="S4.SS2.p8.1.m1.1.1.1b" xref="S4.SS2.p8.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p8.1.m1.1.1.5" xref="S4.SS2.p8.1.m1.1.1.5.cmml">F</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p8.1.m1.1b"><apply id="S4.SS2.p8.1.m1.1.1.cmml" xref="S4.SS2.p8.1.m1.1.1"><times id="S4.SS2.p8.1.m1.1.1.1.cmml" xref="S4.SS2.p8.1.m1.1.1.1"></times><ci id="S4.SS2.p8.1.m1.1.1.2.cmml" xref="S4.SS2.p8.1.m1.1.1.2">𝐿</ci><ci id="S4.SS2.p8.1.m1.1.1.3.cmml" xref="S4.SS2.p8.1.m1.1.1.3">𝑉</ci><ci id="S4.SS2.p8.1.m1.1.1.4.cmml" xref="S4.SS2.p8.1.m1.1.1.4">𝐸</ci><ci id="S4.SS2.p8.1.m1.1.1.5.cmml" xref="S4.SS2.p8.1.m1.1.1.5">𝐹</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p8.1.m1.1c">LVEF</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p8.1.m1.1d">italic_L italic_V italic_E italic_F</annotation></semantics></math> are provided in Table <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S4.T3" title="Table 3 ‣ 4.2 Video Generation Performance ‣ 4 EXPERIMENTS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">3</span></a>, where our model outperforms the other <cite class="ltx_cite ltx_citemacro_citep">(Reynaud et al., <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#bib.bib30" title="">2023</a>)</cite> in terms of MAE and RMSE. Although the R-square value is slightly lower, this is understandable given the higher difficulty of our task. Additionally, ECHOPulse achieves these results with fewer parameters and requires less sampling time to generate higher-quality videos. This not only underscores the validity of using ECG as a conditioning signal but also demonstrates the clinical potential of our model.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>CONCLUSION</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we present ECHOPulse, an innovative framework for generating ECHO videos conditioned on ECG signals, marking a significant advancement in the integration of time-series data for video synthesis. By utilizing VQVAE-based tokenization and a transformer with MVTM-driven generation, ECHOPulse not only achieves superior performance in video quality but also addresses key challenge of ejection fraction estimation in cardiac video generation. Our extensive evaluation on both public and private datasets highlights the model’s robust potential for enhancing clinical workflows and enabling real-time cardiac monitoring. This work lays the foundation for further exploration in automated, data-driven cardiac assessment, with implications for both research and practical applications.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>LIMITATION AND FUTURE WORK</h2>
<div class="ltx_para ltx_noindent" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">There are several limitations of this study that have yet to be addressed. Although we have expanded the dataset through the generation of synthetic data, we are still unable to automatically ensure that the generated videos are free from potential personal privacy information, which limits our ability to fully release the whole private dataset. Additionally, while ECHOPulse can generate videos of unlimited length, it currently lacks the ability to improve video frame rates (FPS) and resolution. In the future, integrating. ECHOPulse, when combined with diffusion models and techniques like super-resolution and denoising, could further enhance the quality of generated videos. This approach addresses current limitations and pushes the boundaries of ECHO video generation.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Al-Khatib et al. (2018)</span>
<span class="ltx_bibblock">
Sana M Al-Khatib, William G Stevenson, Michael J Ackerman, William J Bryant, David J Callans, Anne B Curtis, Barbara J Deal, Timm Dickfeld, Michael E Field, Gregg C Fonarow, et al.

</span>
<span class="ltx_bibblock">2017 aha/acc/hrs guideline for management of patients with ventricular arrhythmias and the prevention of sudden cardiac death: a report of the american college of cardiology/american heart association task force on clinical practice guidelines and the heart rhythm society.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Journal of the American College of Cardiology</em>, 72(14):e91–e220, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arnab et al. (2021)</span>
<span class="ltx_bibblock">
Anurag Arnab, Mostafa Dehghani, Georg Heigold, Chen Sun, Mario Lučić, and Cordelia Schmid.

</span>
<span class="ltx_bibblock">Vivit: A video vision transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the IEEE/CVF international conference on computer vision</em>, pp.  6836–6846, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ashrafian et al. (2024)</span>
<span class="ltx_bibblock">
Pooria Ashrafian, Milad Yazdani, Moein Heidari, Dena Shahriari, and Ilker Hacihaliloglu.

</span>
<span class="ltx_bibblock">Vision-language synthetic data enhances echocardiography downstream tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">arXiv preprint arXiv:2403.19880</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Austin et al. (2021)</span>
<span class="ltx_bibblock">
Jacob Austin, Daniel D Johnson, Jonathan Ho, Daniel Tarlow, and Rianne van den Berg.

</span>
<span class="ltx_bibblock">Structured denoising diffusion models in discrete state-spaces.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">Advances in Neural Information Processing Systems</em>, 34:17981–17993, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bain et al. (2021)</span>
<span class="ltx_bibblock">
Max Bain, Arsha Nagrani, Gül Varol, and Andrew Zisserman.

</span>
<span class="ltx_bibblock">Frozen in time: A joint video and image encoder for end-to-end retrieval.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">IEEE International Conference on Computer Vision</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chang et al. (2022)</span>
<span class="ltx_bibblock">
Huiwen Chang, Han Zhang, Lu Jiang, et al.

</span>
<span class="ltx_bibblock">Maskgit: Masked generative image transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  11315–11325, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Del Torto et al. (2022)</span>
<span class="ltx_bibblock">
Alberico Del Torto, Andrea Igoren Guaricci, Francesca Pomarico, Marco Guglielmo, Laura Fusini, Francesco Monitillo, Daniela Santoro, Monica Vannini, Alexia Rossi, Giuseppe Muscogiuri, et al.

</span>
<span class="ltx_bibblock">Advances in multimodality cardiovascular imaging in the diagnosis of heart failure with preserved ejection fraction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Frontiers in Cardiovascular Medicine</em>, 9:758975, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gauss (1809)</span>
<span class="ltx_bibblock">
Carl Gauss.

</span>
<span class="ltx_bibblock">Theoria motus corporum coelestium in sectionibus conicis solem mabientium [theory of the motion of the heavenly bodies moving about the sun in conic sections].

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Perthes and Besser, Hamburg, Germany</em>, 1809.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow (2016)</span>
<span class="ltx_bibblock">
Ian Goodfellow.

</span>
<span class="ltx_bibblock">Deep learning, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2022)</span>
<span class="ltx_bibblock">
Kaiming He, Xinlei Chen, Saining Xie, Yanghao Li, Piotr Dollár, and Ross Girshick.

</span>
<span class="ltx_bibblock">Masked autoencoders are scalable vision learners.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, pp.  16000–16009, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Heusel et al. (2017)</span>
<span class="ltx_bibblock">
Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard Nessler, and Sepp Hochreiter.

</span>
<span class="ltx_bibblock">Gans trained by a two time-scale update rule converge to a local nash equilibrium.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ho et al. (2020)</span>
<span class="ltx_bibblock">
Jonathan Ho, Ajay Jain, and Pieter Abbeel.

</span>
<span class="ltx_bibblock">Denoising diffusion probabilistic models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Advances in Neural Information Processing Systems</em>, 33:6840–6851, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. (2021)</span>
<span class="ltx_bibblock">
Edward J Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2106.09685</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson et al. (2016)</span>
<span class="ltx_bibblock">
Justin Johnson, Alexandre Alahi, and Li Fei-Fei.

</span>
<span class="ltx_bibblock">Perceptual losses for real-time style transfer and super-resolution.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Computer Vision–ECCV 2016: 14th European Conference, Amsterdam, The Netherlands, October 11-14, 2016, Proceedings, Part II 14</em>, pp.  694–711. Springer, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2021)</span>
<span class="ltx_bibblock">
Taeouk Kim, Mohammadali Hedayat, Veronica V Vaitkus, Marek Belohlavek, Vinayak Krishnamurthy, and Iman Borazjani.

</span>
<span class="ltx_bibblock">Automatic segmentation of the left ventricle in echocardiographic images using convolutional neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Quantitative Imaging in Medicine and Surgery</em>, 11(5):1763, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leclerc et al. (2019a)</span>
<span class="ltx_bibblock">
Sarah Leclerc, Erik Smistad, Joao Pedrosa, Andreas Østvik, Frederic Cervenansky, Florian Espinosa, Torvald Espeland, Erik Andreas Rye Berg, Pierre-Marc Jodoin, Thomas Grenier, et al.

</span>
<span class="ltx_bibblock">Deep learning for segmentation using an open large-scale dataset in 2d echocardiography.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">IEEE transactions on medical imaging</em>, 38(9):2198–2210, 2019a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leclerc et al. (2019b)</span>
<span class="ltx_bibblock">
Sébastien Leclerc, Erik Smistad, Jorge Pedrosa, Andre Ostvik, et al.

</span>
<span class="ltx_bibblock">Deep learning for segmentation using an open large-scale dataset in 2d echocardiography.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">IEEE Transactions on Medical Imaging</em>, 38(9):2198–2210, Sept. 2019b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lezama et al. (2022)</span>
<span class="ltx_bibblock">
José Lezama, Huiwen Chang, Lu Jiang, and Irfan Essa.

</span>
<span class="ltx_bibblock">Improved masked image generation with token-critic.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">European Conference on Computer Vision</em>, pp.  70–86. Springer, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2013)</span>
<span class="ltx_bibblock">
Jun Liu, Fei Xie, Yaqi Zhou, Qian Zou, and Jianfeng Wu.

</span>
<span class="ltx_bibblock">A wearable health monitoring system with multi-parameters.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">2013 6th International Conference on Biomedical Engineering and Informatics</em>, pp.  332–336. IEEE, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. (2021)</span>
<span class="ltx_bibblock">
Tong Lu, Tingting Chen, Feng Gao, Biao Sun, Vasilis Ntziachristos, and Jiao Li.

</span>
<span class="ltx_bibblock">Lv-gan: A deep learning approach for limited-view optoacoustic imaging based on hybrid datasets.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Journal of biophotonics</em>, 14(2):e202000325, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Na et al. (2024)</span>
<span class="ltx_bibblock">
Yeongyeon Na, Minje Park, Yunwon Tae, and Sunghoon Joo.

</span>
<span class="ltx_bibblock">Guiding masked representation learning to capture spatio-temporal relationship of electrocardiogram.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2402.09450</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oktay et al. (2018)</span>
<span class="ltx_bibblock">
Ozan Oktay, Jo Schlemper, Loic Le Folgoc, Matthew Lee, Mattias Heinrich, Kazunari Misawa, Kensaku Mori, Steven McDonagh, Nils Y Hammerla, Bernhard Kainz, et al.

</span>
<span class="ltx_bibblock">Attention u-net: Learning where to look for the pancreas.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:1804.03999</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Omar et al. (2016)</span>
<span class="ltx_bibblock">
Alaa Mabrouk Salem Omar, Manish Bansal, and Partho P Sengupta.

</span>
<span class="ltx_bibblock">Advances in echocardiographic imaging in heart failure with reduced and preserved ejection fraction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Circulation research</em>, 119(2):357–374, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Otto (2013)</span>
<span class="ltx_bibblock">
Catherine M Otto.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Textbook of clinical echocardiography</em>.

</span>
<span class="ltx_bibblock">Elsevier Health Sciences, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al. (2020)</span>
<span class="ltx_bibblock">
David Ouyang, Bryan He, Amirata Ghorbani, Neal Yuan, Joseph Ebinger, Curtis P Langlotz, Paul A Heidenreich, Robert A Harrington, David H Liang, Euan A Ashley, et al.

</span>
<span class="ltx_bibblock">Video-based ai for beat-to-beat assessment of cardiac function.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Nature</em>, 580(7802):252–256, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ponikowski et al. (2016)</span>
<span class="ltx_bibblock">
Piotr Ponikowski, Adriaan A Voors, Stefan D Anker, Héctor Bueno, John GF Cleland, Andrew JS Coats, Volkmar Falk, José Ramón González-Juanatey, Veli-Pekka Harjola, Ewa A Jankowska, et al.

</span>
<span class="ltx_bibblock">2016 esc guidelines for the diagnosis and treatment of acute and chronic heart failure.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Kardiologia Polska (Polish Heart Journal)</em>, 74(10):1037–1147, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qassim et al. (2018)</span>
<span class="ltx_bibblock">
Hussam Qassim, Abhishek Verma, and David Feinzimer.

</span>
<span class="ltx_bibblock">Compressed residual-vgg16 cnn model for big data places image recognition.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">2018 IEEE 8th annual computing and communication workshop and conference (CCWC)</em>, pp.  169–175. IEEE, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al. (2020)</span>
<span class="ltx_bibblock">
Jun Qi, Jun Du, Sabato Marco Siniscalchi, Xiaoli Ma, and Chin-Hui Lee.

</span>
<span class="ltx_bibblock">On mean absolute error for deep neural network based vector-to-vector regression.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">IEEE Signal Processing Letters</em>, 27:1485–1489, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ravi et al. (2024)</span>
<span class="ltx_bibblock">
Nikhila Ravi, Valentin Gabeur, Yuan-Ting Hu, Ronghang Hu, Chaitanya Ryali, Tengyu Ma, Haitham Khedr, Roman Rädle, Chloe Rolland, Laura Gustafson, et al.

</span>
<span class="ltx_bibblock">Sam 2: Segment anything in images and videos.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">arXiv preprint arXiv:2408.00714</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reynaud et al. (2023)</span>
<span class="ltx_bibblock">
Hadrien Reynaud, Mengyun Qiao, Mischa Dombrowski, Thomas Day, Reza Razavi, Alberto Gomez, Paul Leeson, and Bernhard Kainz.

</span>
<span class="ltx_bibblock">Feature-conditioned cascaded video diffusion models for precise echocardiogram synthesis.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">International Conference on Medical Image Computing and Computer-Assisted Intervention</em>, pp.  142–152. Springer, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reynaud et al. (2024)</span>
<span class="ltx_bibblock">
Hadrien Reynaud, Qingjie Meng, Mischa Dombrowski, Arijit Ghosh, Thomas Day, Alberto Gomez, Paul Leeson, and Bernhard Kainz.

</span>
<span class="ltx_bibblock">Echonet-synthetic: Privacy-preserving video generation for safe medical data sharing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2406.00808</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roberts et al. (2023)</span>
<span class="ltx_bibblock">
Adam Roberts, Hyung Won Chung, Gaurav Mishra, Anselm Levskaya, James Bradbury, Daniel Andor, Sharan Narang, Brian Lester, Colin Gaffney, Afroz Mohiuddin, et al.

</span>
<span class="ltx_bibblock">Scaling up models and data with t5x and seqio.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Journal of Machine Learning Research</em>, 24(377):1–8, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">SF (2009)</span>
<span class="ltx_bibblock">
NAGUEH SF.

</span>
<span class="ltx_bibblock">Recommendations for the evaluation of left ventricular diastolic function by echocardiography.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">J Am Soc Echocardiogr</em>, 22:107–133, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Smistad et al. (2020)</span>
<span class="ltx_bibblock">
Erik Smistad, Andreas Østvik, Ivar Mjåland Salte, Daniela Melichova, Thuy Mi Nguyen, Kristina Haugaa, Harald Brunvand, Thor Edvardsen, Sarah Leclerc, Olivier Bernard, et al.

</span>
<span class="ltx_bibblock">Real-time automatic ejection fraction and foreshortening detection using deep learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">IEEE transactions on ultrasonics, ferroelectrics, and frequency control</em>, 67(12):2595–2604, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2307.09288</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Unterthiner et al. (2018)</span>
<span class="ltx_bibblock">
Thomas Unterthiner, Sjoerd Van Steenkiste, Karol Kurach, Raphael Marinier, Marcin Michalski, and Sylvain Gelly.

</span>
<span class="ltx_bibblock">Towards accurate generative models of video: A new metric &amp; challenges.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">arXiv preprint arXiv:1812.01717</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van Den Oord &amp; Vinyals (2017)</span>
<span class="ltx_bibblock">
Aaron Van Den Oord and Oriol Vinyals.

</span>
<span class="ltx_bibblock">Neural discrete representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">Advances in Neural Information Processing Systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">van den Oord et al. (2017)</span>
<span class="ltx_bibblock">
Aaron van den Oord, Oriol Vinyals, and Koray Kavukcuoglu.

</span>
<span class="ltx_bibblock">Neural discrete representation learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">Advances in neural information processing systems</em>, 30, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Villegas et al. (2022)</span>
<span class="ltx_bibblock">
Ruben Villegas, Mohammad Babaeizadeh, Pieter-Jan Kindermans, et al.

</span>
<span class="ltx_bibblock">Phenaki: Variable length video generation from open domain textual descriptions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2024)</span>
<span class="ltx_bibblock">
Xiang Wang, Hangjie Yuan, Shiwei Zhang, Dayou Chen, Jiuniu Wang, Yingya Zhang, Yujun Shen, Deli Zhao, and Jingren Zhou.

</span>
<span class="ltx_bibblock">Videocomposer: Compositional video synthesis with motion controllability.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2004)</span>
<span class="ltx_bibblock">
Zhou Wang, Alan C Bovik, Hamid R Sheikh, and Eero P Simoncelli.

</span>
<span class="ltx_bibblock">Image quality assessment: from error visibility to structural similarity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">IEEE transactions on image processing</em>, 13(4):600–612, 2004.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2024a)</span>
<span class="ltx_bibblock">
Junxuan Yu, Rusi Chen, Yongsong Zhou, Yanlin Chen, Yaofei Duan, Yuhao Huang, Han Zhou, Tan Tao, Xin Yang, and Dong Ni.

</span>
<span class="ltx_bibblock">Explainable and controllable motion curve guided cardiac ultrasound video generation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint arXiv:2407.21490</em>, 2024a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2023)</span>
<span class="ltx_bibblock">
Lijun Yu, Yong Cheng, Kihyuk Sohn, José Lezama, Han Zhang, Huiwen Chang, Alexander G Hauptmann, Ming-Hsuan Yang, Yuan Hao, Irfan Essa, et al.

</span>
<span class="ltx_bibblock">Magvit: Masked generative video transformer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</em>, pp.  10459–10469, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2024b)</span>
<span class="ltx_bibblock">
Luming Yu, Jose Lezama, Nikhil B Gundavarapu, et al.

</span>
<span class="ltx_bibblock">Language model beats diffusion-tokenizer is key to visual generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">The Twelfth International Conference on Learning Representations</em>, 2024b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2022)</span>
<span class="ltx_bibblock">
Sihyun Yu, Jihoon Tack, Sangwoo Mo, Hyunsu Kim, Junho Kim, Jung-Woo Ha, and Jinwoo Shin.

</span>
<span class="ltx_bibblock">Generating videos with dynamics-aware implicit generative adversarial networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2024)</span>
<span class="ltx_bibblock">
David Junhao Zhang, Dongxu Li, Hung Le, Mike Zheng Shou, Caiming Xiong, and Doyen Sahoo.

</span>
<span class="ltx_bibblock">Moonshot: Towards controllable video generation and editing with multimodal conditions.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">arXiv preprint arXiv:2401.01827</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. (2024)</span>
<span class="ltx_bibblock">
Xinrui Zhou, Yuhao Huang, Wufeng Xue, Haoran Dou, Jun Cheng, Han Zhou, and Dong Ni.

</span>
<span class="ltx_bibblock">Heartbeat: Towards controllable echocardiography video synthesis with multimodal conditions-guided diffusion models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">arXiv preprint arXiv:2406.14098</em>, 2024.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Reproducibility Statement</h3>
<div class="ltx_para ltx_noindent" id="A1.SS1.p1">
<p class="ltx_p" id="A1.SS1.p1.1">To ensure the reproducibility of our results, we will make all relevant resources publicly available. This includes the complete codebase, training scripts, pre-trained model weights, and synthesized ECHO video data. By providing these materials, we encourage the research community to replicate and build upon our work. Detailed instructions on how to set up and run the experiments will also be included in our repository to facilitate easy reproduction of our results.</p>
</div>
</section>
<section class="ltx_subsection" id="A1.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>MODEL SETUP AND HYPERPARAMETERS</h3>
<section class="ltx_subsubsection" id="A1.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.1 </span>Video Tokenizer</h4>
<div class="ltx_para ltx_noindent" id="A1.SS2.SSS1.p1">
<p class="ltx_p" id="A1.SS2.SSS1.p1.1">The configuration of the video tokenizer model is as follows:</p>
</div>
<figure class="ltx_table" id="A1.T4">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T4.2">
<tr class="ltx_tr" id="A1.T4.2.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.3.1"><span class="ltx_text ltx_font_bold" id="A1.T4.2.3.1.1">Parameter</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.2.3.2"><span class="ltx_text ltx_font_bold" id="A1.T4.2.3.2.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="A1.T4.1.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.1.1.2">Video input</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.1.1.1">11 frames, frame stride 1, 128 <math alttext="\times" class="ltx_Math" display="inline" id="A1.T4.1.1.1.m1.1"><semantics id="A1.T4.1.1.1.m1.1a"><mo id="A1.T4.1.1.1.m1.1.1" xref="A1.T4.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T4.1.1.1.m1.1b"><times id="A1.T4.1.1.1.m1.1.1.cmml" xref="A1.T4.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.1.1.1.m1.1c">\times</annotation><annotation encoding="application/x-llamapun" id="A1.T4.1.1.1.m1.1d">×</annotation></semantics></math> 128 resolution</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.4.1">Batch size</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.2.4.2">128</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.5.1">Embedding size</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.2.5.2">512</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.6.1">Codebook size</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.2.6.2">8192</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.7.1">Spatial patch size</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.2.7.2">8 (non-overlapping)</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.8">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.8.1">Temporal patch size</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.2.8.2">2 (along the temporal axis)</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.9">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.9.1">Spatial transformer depth</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.2.9.2">4 layers</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.10">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.10.1">Temporal transformer depth</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.2.10.2">4 layers</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.11">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.11.1">Transformer head dimension</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.2.11.2">64</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.12">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.12.1">Number of heads</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T4.2.12.2">8</td>
</tr>
<tr class="ltx_tr" id="A1.T4.2.2">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T4.2.2.2">Feed-forward multiplier</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T4.2.2.1">4 (MLP size of 2048, i.e., <math alttext="32\times 64" class="ltx_Math" display="inline" id="A1.T4.2.2.1.m1.1"><semantics id="A1.T4.2.2.1.m1.1a"><mrow id="A1.T4.2.2.1.m1.1.1" xref="A1.T4.2.2.1.m1.1.1.cmml"><mn id="A1.T4.2.2.1.m1.1.1.2" xref="A1.T4.2.2.1.m1.1.1.2.cmml">32</mn><mo id="A1.T4.2.2.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="A1.T4.2.2.1.m1.1.1.1.cmml">×</mo><mn id="A1.T4.2.2.1.m1.1.1.3" xref="A1.T4.2.2.1.m1.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T4.2.2.1.m1.1b"><apply id="A1.T4.2.2.1.m1.1.1.cmml" xref="A1.T4.2.2.1.m1.1.1"><times id="A1.T4.2.2.1.m1.1.1.1.cmml" xref="A1.T4.2.2.1.m1.1.1.1"></times><cn id="A1.T4.2.2.1.m1.1.1.2.cmml" type="integer" xref="A1.T4.2.2.1.m1.1.1.2">32</cn><cn id="A1.T4.2.2.1.m1.1.1.3.cmml" type="integer" xref="A1.T4.2.2.1.m1.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.2.2.1.m1.1c">32\times 64</annotation><annotation encoding="application/x-llamapun" id="A1.T4.2.2.1.m1.1d">32 × 64</annotation></semantics></math>)</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Video tokenizer hyperparameters</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="A1.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">A.2.2 </span>Video GENERATION TRANSFORMER</h4>
<div class="ltx_para" id="A1.SS2.SSS2.p1">
<p class="ltx_p" id="A1.SS2.SSS2.p1.1">The configuration of the transformer model in Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#S3.F1" title="Figure 1 ‣ 3 METHODS ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">1</span></a>b is as follows:</p>
</div>
<figure class="ltx_table" id="A1.T5">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="A1.T5.1">
<tr class="ltx_tr" id="A1.T5.1.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.2.1"><span class="ltx_text ltx_font_bold" id="A1.T5.1.2.1.1">Parameter</span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.2.2"><span class="ltx_text ltx_font_bold" id="A1.T5.1.2.2.1">Value</span></td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.3.1">Number of tokens</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.3.2">8192 (aligned with the codebook size)</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.4.1">Batch size</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.4.2">128</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.5.1">Embedding dimension</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.5.2">512</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.6.1">ECG signal dimension</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.6.2">768</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.7">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.7.1">Depth (number of layers)</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.7.2">6</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.8">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.8.1">Learning rate</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.8.2">1e-4</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.9">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.9.1">Training steps</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.9.2">4,000,000 steps</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.10">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.10.1">Exponential Moving Average (EMA)</td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.1.10.2">Updated every 10 steps with a decay rate of 0.995</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.1">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="A1.T5.1.1.2">Optimizer</td>
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t" id="A1.T5.1.1.1">Adam optimizer with <math alttext="\beta" class="ltx_Math" display="inline" id="A1.T5.1.1.1.m1.1"><semantics id="A1.T5.1.1.1.m1.1a"><mi id="A1.T5.1.1.1.m1.1.1" xref="A1.T5.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.T5.1.1.1.m1.1b"><ci id="A1.T5.1.1.1.m1.1.1.cmml" xref="A1.T5.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.1.1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="A1.T5.1.1.1.m1.1d">italic_β</annotation></semantics></math> values set to (0.9, 0.99)</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span>Video generation model hyperparameters</figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="A1.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Dataset</h3>
<div class="ltx_para ltx_noindent" id="A1.SS3.p1">
<p class="ltx_p" id="A1.SS3.p1.1">Our private dataset consists of 94,078 ECHO videos, including both apical 2 view and apical 4 view. It contains ECHO recordings from both healthy individuals and patients with various cardiovascular diseases, with real-time ECG signals recorded for each video. All videos were anonymized, underwent random contrast enhancement, and were resized to 128x128 resolution. Additional video generation examples are shown in the Figure <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.F4" title="Figure 4 ‣ A.3 Dataset ‣ Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">4</span></a>,<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.F5" title="Figure 5 ‣ A.3 Dataset ‣ Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">5</span></a>,<a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.F6" title="Figure 6 ‣ A.3 Dataset ‣ Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">6</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2410.03143v2#A1.F7" title="Figure 7 ‣ A.3 Dataset ‣ Appendix A Appendix ‣ ECHOPulse: ECG Controlled Echocardiograms Video Generation"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<figure class="ltx_figure" id="A1.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="562" id="A1.F4.1.g1" src="x3.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>A2C video generation example from ECHOPulse.</figcaption>
</figure>
<div class="ltx_para" id="A1.SS3.p2">
<p class="ltx_p" id="A1.SS3.p2.1">.</p>
</div>
<figure class="ltx_figure" id="A1.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="562" id="A1.F5.1.g1" src="x4.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>A2C video generation example from ECHOPulse.</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="562" id="A1.F6.1.g1" src="x5.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>A4C video generation example from ECHOPulse.</figcaption>
</figure>
<figure class="ltx_figure" id="A1.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="562" id="A1.F7.1.g1" src="x6.png" width="761"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>A4C video generation example from ECHOPulse.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sat Oct 12 01:21:54 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
