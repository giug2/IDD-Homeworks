<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Enhancing Sequential Music Recommendation with Personalized Popularity Awareness</title>
<!--Generated on Fri Sep  6 14:59:49 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Recommender Systems,  Sequential Recommendation,  Music Recommendation,  Personalized Popularity" lang="en" name="keywords"/>
<base href="/html/2409.04329v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S1" title="In Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2" title="In Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Personalized Popularity Awareness</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S3" title="In Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S4" title="In Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S5" title="In Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusions</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Enhancing Sequential Music Recommendation with Personalized Popularity Awareness</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Davide Abbattista
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Politecnico di Bari, Italy</span><span class="ltx_text ltx_affiliation_country" id="id2.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:d.abbattista@studenti.poliba.it">d.abbattista@studenti.poliba.it</a>
</span></span></span>
<span class="ltx_author_before">,Â </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Vito Walter Anelli
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id3.1.id1">Politecnico di Bari, Italy</span><span class="ltx_text ltx_affiliation_country" id="id4.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:vitowalter.anelli@poliba.it">vitowalter.anelli@poliba.it</a>
</span></span></span>
<span class="ltx_author_before">,Â </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tommaso Di Noia
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">Politecnico di Bari, Italy</span><span class="ltx_text ltx_affiliation_country" id="id6.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:tommaso.dinoia@poliba.it">tommaso.dinoia@poliba.it</a>
</span></span></span>
<span class="ltx_author_before">,Â </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Craig Macdonald
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">University of Glasgow, UK</span><span class="ltx_text ltx_affiliation_country" id="id8.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:craig.macdonald@glasgow.ac.uk">craig.macdonald@glasgow.ac.uk</a>
</span></span></span>
<span class="ltx_author_before">Â andÂ </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Aleksandr Petrov
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">University of Glasgow, UK</span><span class="ltx_text ltx_affiliation_country" id="id10.2.id2"></span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:a.petrov.1@research.gla.ac.uk">a.petrov.1@research.gla.ac.uk</a>
</span></span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id11.id1">In the realm of music recommendation, sequential recommender systems have shown promise in capturing the dynamic nature of music consumption. Nevertheless, traditional Transformer-based models, such as SASRec and BERT4Rec, while effective, encounter challenges due to the unique characteristics of music listening habits. In fact, existing models struggle to create a coherent listening experience due to rapidly evolving preferences. Moreover, music consumption is characterized by a prevalence of repeated listening, i.e. users frequently return to their favourite tracks, an important signal that could be framed as individual or personalized popularity. This paper addresses these challenges by introducing a novel approach that incorporates personalized popularity information into sequential recommendation. By combining user-item popularity scores with model-generated scores, our method effectively balances the exploration of new music with the satisfaction of user preferences.
Experimental results demonstrate that a Personalized Most Popular recommender, a method solely based on user-specific popularity, outperforms existing state-of-the-art models.
Furthermore, augmenting Transformer-based models with personalized popularity awareness yields superior performance, showing improvements ranging from 25.2% to 69.8%.
The code for this paper is available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/sisinflab/personalized-popularity-awareness" title="">https://github.com/sisinflab/personalized-popularity-awareness</a>.</p>
</div>
<div class="ltx_keywords">Recommender Systems, Sequential Recommendation, Music Recommendation, Personalized Popularity
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id1"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id2"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_type">copyright: </span>rightsretained</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id3"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_type">conference: </span>18th ACM Conference on Recommender Systems; October 14â€“18, 2024; Bari, Italy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_booktitle" id="id4"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_type">booktitle: </span>18th ACM Conference on Recommender Systems (RecSys â€™24), October 14â€“18, 2024, Bari, Italy</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id5"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_type">doi: </span>10.1145/3640457.3691719</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id6"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_type">isbn: </span>979-8-4007-0505-2/24/10</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">â€ </sup><span class="ltx_note_type">ccs: </span>Information systemsÂ Recommender systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Sequential recommendation allows the prediction of potential items of interest to users based on their past interactions. It is a commonly deployed form of recommendation that takes into account the order of interactions when making predictions. Indeed, in many recommendation domains such as e-commerce, music, and POI, the order of recent interactions can provide more fine-grained evidence of usersâ€™ current interests and context than the traditional set-based collaborative filtering mechanism <cite class="ltx_cite ltx_citemacro_citep">(Quadrana etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib24" title="">2018</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In our work, we focus on music recommendation. The music domain exhibits unique characteristics such as vast catalog sizes, repeated consumption patterns, and sequential and passive consumption behaviors, each posing distinct challenges for recommender systems <cite class="ltx_cite ltx_citemacro_citep">(Schedl etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib27" title="">2022</a>)</cite>.
Music listening habits are inherently repetitive. Therefore, a recommender system must identify and prioritize usersâ€™ favorite tracks to maintain their satisfaction and engagement. Ignoring previously enjoyed tracks can lead to a disconnect between the userâ€™s preferences and the recommendations, reducing the systemâ€™s perceived relevance.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Transformer-based models <cite class="ltx_cite ltx_citemacro_citep">(Vaswani etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib32" title="">2017</a>)</cite> are widely adopted for sequence recommendation due to their popularity in other sequential tasks such as language modeling. Indeed, sequence recommendation is similar to the language modeling task of sentence completion if items are treated like language tokens. Models such as SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib18" title="">2018</a>)</cite> (and its recent adaption, gSASRec <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib23" title="">2023</a>)</cite>) and BERT4Rec <cite class="ltx_cite ltx_citemacro_citep">(Sun etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib29" title="">2019</a>)</cite> have shown to be effective for sequence recommendation and have been used as baselines for music recommendation in previous works, such as <cite class="ltx_cite ltx_citemacro_citep">(Tran etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib31" title="">2023</a>; Zhou etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib38" title="">2020</a>; Fan etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib9" title="">2021</a>; Tong etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib30" title="">2021</a>; Shin etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib28" title="">2024</a>; Amjadi etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib2" title="">2021</a>; Zhang etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib37" title="">2021</a>)</cite>. However, as we show later in this paper, music recommendation presents significant complexity for such Transformer-based models due to its inherent characteristics, especially the repeated consumption patterns.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Our take on the problem is:
Giving knowledge of the personalized popularity of all track items for each user to sequential models can help them to learn more refined user-specific recommendations due to the repeated consumption patterns in the music domain. Although popularity is often used as a baselineÂ <cite class="ltx_cite ltx_citemacro_citep">(Anelli etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib3" title="">2019</a>; Ren etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib26" title="">2019</a>; Ariannezhad etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib4" title="">2022</a>; Li etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib19" title="">2023</a>)</cite>, this is the first approach directly injecting a personalized popularity signal into sequential models.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The contributions of this work are as follows:
(1) A novel approach to integrate personalized popularity awareness into sequential recommender systems; (2) an experimental evaluation of the proposed approach.
Our results show that (i) <span class="ltx_text ltx_font_italic" id="S1.p5.1.1">Personalized Most Popular</span> recommender, which ranks track items according to user-specific popularity, has the best performance compared to state-of-the-art sequential recommenders, (ii) combining personalized popularity scores within Transformer-based models improves the quality of music recommendation, beating <span class="ltx_text ltx_font_italic" id="S1.p5.1.2">Personalized Most Popular</span> recommender at high ranking cutoffs.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Personalized Popularity Awareness</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">This section introduces the concept of <span class="ltx_text ltx_font_italic" id="S2.p1.1.1">personalized popularity awareness</span> and its application in music recommendation.
Personalized popularity refers to the tendency of users to repeatedly listen to tracks they have enjoyed in the past. This behaviour, known as repeated consumption, is a distinctive characteristic of music consumption. Indeed, <span class="ltx_text ltx_font_italic" id="S2.p1.1.2">Personalized Most Popular</span> is an often-employed baseline, which recommends items based on user-specific popularity, and has been used as a baseline in previous works on time-aware kNNÂ <cite class="ltx_cite ltx_citemacro_citep">(Anelli etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib3" title="">2019</a>)</cite>, session-basedÂ <cite class="ltx_cite ltx_citemacro_citep">(Ren etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib26" title="">2019</a>; Hidasi etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib14" title="">2016</a>)</cite> and next basketÂ <cite class="ltx_cite ltx_citemacro_citep">(Hu and He, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib15" title="">2019</a>; Ariannezhad etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib4" title="">2022</a>; Faggioli etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib8" title="">2020</a>; Li etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib19" title="">2023</a>)</cite> recommendation, outperforming, in domains with high repetitiveness, state-of-the-art models or being in the same range as them.
In addition, previous works on sequentialÂ <cite class="ltx_cite ltx_citemacro_citep">(Ma etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib20" title="">2020</a>; Quan etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib25" title="">2023</a>)</cite> and session-awareÂ <cite class="ltx_cite ltx_citemacro_citep">(Yang etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib36" title="">2020</a>)</cite> recommendation have introduced novel architectures to model the repeated consumption pattern.
To the best of our knowledge, this is the first attempt at directly injecting a personalized popularity signal into sequential models.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">We argue that traditional recommendation models, such as Transformer-based models like SASRec and BERT4Rec, often struggle to effectively capture this behavior. To address this, we introduce a novel approach that integrates personalized popularity information directly into sequential recommendation models. This is achieved by combining user-item popularity scores with model-generated scores assigned to items (music tracks) by different recommendation models. In essence, instead of learning the entire probability distribution of item preferences, our key insight is that the training process for models like BERT4Rec, SASRec and gSASRec can be adapted to focus on <span class="ltx_text ltx_font_italic" id="S2.p2.1.1">deviations</span> from the popularity distribution.
This intuition is similar to gradient boosting, where a model is tasked with learning the delta from a previous modelÂ <cite class="ltx_cite ltx_citemacro_citep">(Hastie etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib12" title="">2001</a>, Ch.10)</cite>. In our case, the models are tasked with learning the delta from personalized popularity, i.e. recommendation going beyond the repeated consumed tracks.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p3">
<p class="ltx_p" id="S2.p3.8"><span class="ltx_text ltx_font_bold" id="S2.p3.8.1">Sequential Models Item Probability.</span>
Considering the user input sequence of item ids <math alttext="S=[s_{1},\ldots,s_{i},\ldots,s_{L}]" class="ltx_Math" display="inline" id="S2.p3.1.m1.5"><semantics id="S2.p3.1.m1.5a"><mrow id="S2.p3.1.m1.5.5" xref="S2.p3.1.m1.5.5.cmml"><mi id="S2.p3.1.m1.5.5.5" xref="S2.p3.1.m1.5.5.5.cmml">S</mi><mo id="S2.p3.1.m1.5.5.4" xref="S2.p3.1.m1.5.5.4.cmml">=</mo><mrow id="S2.p3.1.m1.5.5.3.3" xref="S2.p3.1.m1.5.5.3.4.cmml"><mo id="S2.p3.1.m1.5.5.3.3.4" stretchy="false" xref="S2.p3.1.m1.5.5.3.4.cmml">[</mo><msub id="S2.p3.1.m1.3.3.1.1.1" xref="S2.p3.1.m1.3.3.1.1.1.cmml"><mi id="S2.p3.1.m1.3.3.1.1.1.2" xref="S2.p3.1.m1.3.3.1.1.1.2.cmml">s</mi><mn id="S2.p3.1.m1.3.3.1.1.1.3" xref="S2.p3.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.p3.1.m1.5.5.3.3.5" xref="S2.p3.1.m1.5.5.3.4.cmml">,</mo><mi id="S2.p3.1.m1.1.1" mathvariant="normal" xref="S2.p3.1.m1.1.1.cmml">â€¦</mi><mo id="S2.p3.1.m1.5.5.3.3.6" xref="S2.p3.1.m1.5.5.3.4.cmml">,</mo><msub id="S2.p3.1.m1.4.4.2.2.2" xref="S2.p3.1.m1.4.4.2.2.2.cmml"><mi id="S2.p3.1.m1.4.4.2.2.2.2" xref="S2.p3.1.m1.4.4.2.2.2.2.cmml">s</mi><mi id="S2.p3.1.m1.4.4.2.2.2.3" xref="S2.p3.1.m1.4.4.2.2.2.3.cmml">i</mi></msub><mo id="S2.p3.1.m1.5.5.3.3.7" xref="S2.p3.1.m1.5.5.3.4.cmml">,</mo><mi id="S2.p3.1.m1.2.2" mathvariant="normal" xref="S2.p3.1.m1.2.2.cmml">â€¦</mi><mo id="S2.p3.1.m1.5.5.3.3.8" xref="S2.p3.1.m1.5.5.3.4.cmml">,</mo><msub id="S2.p3.1.m1.5.5.3.3.3" xref="S2.p3.1.m1.5.5.3.3.3.cmml"><mi id="S2.p3.1.m1.5.5.3.3.3.2" xref="S2.p3.1.m1.5.5.3.3.3.2.cmml">s</mi><mi id="S2.p3.1.m1.5.5.3.3.3.3" xref="S2.p3.1.m1.5.5.3.3.3.3.cmml">L</mi></msub><mo id="S2.p3.1.m1.5.5.3.3.9" stretchy="false" xref="S2.p3.1.m1.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.5b"><apply id="S2.p3.1.m1.5.5.cmml" xref="S2.p3.1.m1.5.5"><eq id="S2.p3.1.m1.5.5.4.cmml" xref="S2.p3.1.m1.5.5.4"></eq><ci id="S2.p3.1.m1.5.5.5.cmml" xref="S2.p3.1.m1.5.5.5">ğ‘†</ci><list id="S2.p3.1.m1.5.5.3.4.cmml" xref="S2.p3.1.m1.5.5.3.3"><apply id="S2.p3.1.m1.3.3.1.1.1.cmml" xref="S2.p3.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p3.1.m1.3.3.1.1.1.1.cmml" xref="S2.p3.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.p3.1.m1.3.3.1.1.1.2.cmml" xref="S2.p3.1.m1.3.3.1.1.1.2">ğ‘ </ci><cn id="S2.p3.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S2.p3.1.m1.3.3.1.1.1.3">1</cn></apply><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">â€¦</ci><apply id="S2.p3.1.m1.4.4.2.2.2.cmml" xref="S2.p3.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.p3.1.m1.4.4.2.2.2.1.cmml" xref="S2.p3.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S2.p3.1.m1.4.4.2.2.2.2.cmml" xref="S2.p3.1.m1.4.4.2.2.2.2">ğ‘ </ci><ci id="S2.p3.1.m1.4.4.2.2.2.3.cmml" xref="S2.p3.1.m1.4.4.2.2.2.3">ğ‘–</ci></apply><ci id="S2.p3.1.m1.2.2.cmml" xref="S2.p3.1.m1.2.2">â€¦</ci><apply id="S2.p3.1.m1.5.5.3.3.3.cmml" xref="S2.p3.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.p3.1.m1.5.5.3.3.3.1.cmml" xref="S2.p3.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S2.p3.1.m1.5.5.3.3.3.2.cmml" xref="S2.p3.1.m1.5.5.3.3.3.2">ğ‘ </ci><ci id="S2.p3.1.m1.5.5.3.3.3.3.cmml" xref="S2.p3.1.m1.5.5.3.3.3.3">ğ¿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.5c">S=[s_{1},\ldots,s_{i},\ldots,s_{L}]</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.5d">italic_S = [ italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , â€¦ , italic_s start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="L" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><mi id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">italic_L</annotation></semantics></math> is the maximum input sequence length, let <math alttext="L_{i}=[x_{i_{1}},\ldots,x_{i_{j}},\ldots,x_{i_{N}}]" class="ltx_Math" display="inline" id="S2.p3.3.m3.5"><semantics id="S2.p3.3.m3.5a"><mrow id="S2.p3.3.m3.5.5" xref="S2.p3.3.m3.5.5.cmml"><msub id="S2.p3.3.m3.5.5.5" xref="S2.p3.3.m3.5.5.5.cmml"><mi id="S2.p3.3.m3.5.5.5.2" xref="S2.p3.3.m3.5.5.5.2.cmml">L</mi><mi id="S2.p3.3.m3.5.5.5.3" xref="S2.p3.3.m3.5.5.5.3.cmml">i</mi></msub><mo id="S2.p3.3.m3.5.5.4" xref="S2.p3.3.m3.5.5.4.cmml">=</mo><mrow id="S2.p3.3.m3.5.5.3.3" xref="S2.p3.3.m3.5.5.3.4.cmml"><mo id="S2.p3.3.m3.5.5.3.3.4" stretchy="false" xref="S2.p3.3.m3.5.5.3.4.cmml">[</mo><msub id="S2.p3.3.m3.3.3.1.1.1" xref="S2.p3.3.m3.3.3.1.1.1.cmml"><mi id="S2.p3.3.m3.3.3.1.1.1.2" xref="S2.p3.3.m3.3.3.1.1.1.2.cmml">x</mi><msub id="S2.p3.3.m3.3.3.1.1.1.3" xref="S2.p3.3.m3.3.3.1.1.1.3.cmml"><mi id="S2.p3.3.m3.3.3.1.1.1.3.2" xref="S2.p3.3.m3.3.3.1.1.1.3.2.cmml">i</mi><mn id="S2.p3.3.m3.3.3.1.1.1.3.3" xref="S2.p3.3.m3.3.3.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S2.p3.3.m3.5.5.3.3.5" xref="S2.p3.3.m3.5.5.3.4.cmml">,</mo><mi id="S2.p3.3.m3.1.1" mathvariant="normal" xref="S2.p3.3.m3.1.1.cmml">â€¦</mi><mo id="S2.p3.3.m3.5.5.3.3.6" xref="S2.p3.3.m3.5.5.3.4.cmml">,</mo><msub id="S2.p3.3.m3.4.4.2.2.2" xref="S2.p3.3.m3.4.4.2.2.2.cmml"><mi id="S2.p3.3.m3.4.4.2.2.2.2" xref="S2.p3.3.m3.4.4.2.2.2.2.cmml">x</mi><msub id="S2.p3.3.m3.4.4.2.2.2.3" xref="S2.p3.3.m3.4.4.2.2.2.3.cmml"><mi id="S2.p3.3.m3.4.4.2.2.2.3.2" xref="S2.p3.3.m3.4.4.2.2.2.3.2.cmml">i</mi><mi id="S2.p3.3.m3.4.4.2.2.2.3.3" xref="S2.p3.3.m3.4.4.2.2.2.3.3.cmml">j</mi></msub></msub><mo id="S2.p3.3.m3.5.5.3.3.7" xref="S2.p3.3.m3.5.5.3.4.cmml">,</mo><mi id="S2.p3.3.m3.2.2" mathvariant="normal" xref="S2.p3.3.m3.2.2.cmml">â€¦</mi><mo id="S2.p3.3.m3.5.5.3.3.8" xref="S2.p3.3.m3.5.5.3.4.cmml">,</mo><msub id="S2.p3.3.m3.5.5.3.3.3" xref="S2.p3.3.m3.5.5.3.3.3.cmml"><mi id="S2.p3.3.m3.5.5.3.3.3.2" xref="S2.p3.3.m3.5.5.3.3.3.2.cmml">x</mi><msub id="S2.p3.3.m3.5.5.3.3.3.3" xref="S2.p3.3.m3.5.5.3.3.3.3.cmml"><mi id="S2.p3.3.m3.5.5.3.3.3.3.2" xref="S2.p3.3.m3.5.5.3.3.3.3.2.cmml">i</mi><mi id="S2.p3.3.m3.5.5.3.3.3.3.3" xref="S2.p3.3.m3.5.5.3.3.3.3.3.cmml">N</mi></msub></msub><mo id="S2.p3.3.m3.5.5.3.3.9" stretchy="false" xref="S2.p3.3.m3.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.5b"><apply id="S2.p3.3.m3.5.5.cmml" xref="S2.p3.3.m3.5.5"><eq id="S2.p3.3.m3.5.5.4.cmml" xref="S2.p3.3.m3.5.5.4"></eq><apply id="S2.p3.3.m3.5.5.5.cmml" xref="S2.p3.3.m3.5.5.5"><csymbol cd="ambiguous" id="S2.p3.3.m3.5.5.5.1.cmml" xref="S2.p3.3.m3.5.5.5">subscript</csymbol><ci id="S2.p3.3.m3.5.5.5.2.cmml" xref="S2.p3.3.m3.5.5.5.2">ğ¿</ci><ci id="S2.p3.3.m3.5.5.5.3.cmml" xref="S2.p3.3.m3.5.5.5.3">ğ‘–</ci></apply><list id="S2.p3.3.m3.5.5.3.4.cmml" xref="S2.p3.3.m3.5.5.3.3"><apply id="S2.p3.3.m3.3.3.1.1.1.cmml" xref="S2.p3.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m3.3.3.1.1.1.1.cmml" xref="S2.p3.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S2.p3.3.m3.3.3.1.1.1.2.cmml" xref="S2.p3.3.m3.3.3.1.1.1.2">ğ‘¥</ci><apply id="S2.p3.3.m3.3.3.1.1.1.3.cmml" xref="S2.p3.3.m3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.p3.3.m3.3.3.1.1.1.3.1.cmml" xref="S2.p3.3.m3.3.3.1.1.1.3">subscript</csymbol><ci id="S2.p3.3.m3.3.3.1.1.1.3.2.cmml" xref="S2.p3.3.m3.3.3.1.1.1.3.2">ğ‘–</ci><cn id="S2.p3.3.m3.3.3.1.1.1.3.3.cmml" type="integer" xref="S2.p3.3.m3.3.3.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1">â€¦</ci><apply id="S2.p3.3.m3.4.4.2.2.2.cmml" xref="S2.p3.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.p3.3.m3.4.4.2.2.2.1.cmml" xref="S2.p3.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S2.p3.3.m3.4.4.2.2.2.2.cmml" xref="S2.p3.3.m3.4.4.2.2.2.2">ğ‘¥</ci><apply id="S2.p3.3.m3.4.4.2.2.2.3.cmml" xref="S2.p3.3.m3.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S2.p3.3.m3.4.4.2.2.2.3.1.cmml" xref="S2.p3.3.m3.4.4.2.2.2.3">subscript</csymbol><ci id="S2.p3.3.m3.4.4.2.2.2.3.2.cmml" xref="S2.p3.3.m3.4.4.2.2.2.3.2">ğ‘–</ci><ci id="S2.p3.3.m3.4.4.2.2.2.3.3.cmml" xref="S2.p3.3.m3.4.4.2.2.2.3.3">ğ‘—</ci></apply></apply><ci id="S2.p3.3.m3.2.2.cmml" xref="S2.p3.3.m3.2.2">â€¦</ci><apply id="S2.p3.3.m3.5.5.3.3.3.cmml" xref="S2.p3.3.m3.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.p3.3.m3.5.5.3.3.3.1.cmml" xref="S2.p3.3.m3.5.5.3.3.3">subscript</csymbol><ci id="S2.p3.3.m3.5.5.3.3.3.2.cmml" xref="S2.p3.3.m3.5.5.3.3.3.2">ğ‘¥</ci><apply id="S2.p3.3.m3.5.5.3.3.3.3.cmml" xref="S2.p3.3.m3.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S2.p3.3.m3.5.5.3.3.3.3.1.cmml" xref="S2.p3.3.m3.5.5.3.3.3.3">subscript</csymbol><ci id="S2.p3.3.m3.5.5.3.3.3.3.2.cmml" xref="S2.p3.3.m3.5.5.3.3.3.3.2">ğ‘–</ci><ci id="S2.p3.3.m3.5.5.3.3.3.3.3.cmml" xref="S2.p3.3.m3.5.5.3.3.3.3.3">ğ‘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.5c">L_{i}=[x_{i_{1}},\ldots,x_{i_{j}},\ldots,x_{i_{N}}]</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m3.5d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = [ italic_x start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_x start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_x start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math> be the scores vector corresponding to <math alttext="s_{i}" class="ltx_Math" display="inline" id="S2.p3.4.m4.1"><semantics id="S2.p3.4.m4.1a"><msub id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml"><mi id="S2.p3.4.m4.1.1.2" xref="S2.p3.4.m4.1.1.2.cmml">s</mi><mi id="S2.p3.4.m4.1.1.3" xref="S2.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><apply id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p3.4.m4.1.1.1.cmml" xref="S2.p3.4.m4.1.1">subscript</csymbol><ci id="S2.p3.4.m4.1.1.2.cmml" xref="S2.p3.4.m4.1.1.2">ğ‘ </ci><ci id="S2.p3.4.m4.1.1.3.cmml" xref="S2.p3.4.m4.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">s_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> output by a sequential recommendation model, such as BERT4Rec or SASRec, where <math alttext="x_{i_{j}}" class="ltx_Math" display="inline" id="S2.p3.5.m5.1"><semantics id="S2.p3.5.m5.1a"><msub id="S2.p3.5.m5.1.1" xref="S2.p3.5.m5.1.1.cmml"><mi id="S2.p3.5.m5.1.1.2" xref="S2.p3.5.m5.1.1.2.cmml">x</mi><msub id="S2.p3.5.m5.1.1.3" xref="S2.p3.5.m5.1.1.3.cmml"><mi id="S2.p3.5.m5.1.1.3.2" xref="S2.p3.5.m5.1.1.3.2.cmml">i</mi><mi id="S2.p3.5.m5.1.1.3.3" xref="S2.p3.5.m5.1.1.3.3.cmml">j</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.1b"><apply id="S2.p3.5.m5.1.1.cmml" xref="S2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p3.5.m5.1.1.1.cmml" xref="S2.p3.5.m5.1.1">subscript</csymbol><ci id="S2.p3.5.m5.1.1.2.cmml" xref="S2.p3.5.m5.1.1.2">ğ‘¥</ci><apply id="S2.p3.5.m5.1.1.3.cmml" xref="S2.p3.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.p3.5.m5.1.1.3.1.cmml" xref="S2.p3.5.m5.1.1.3">subscript</csymbol><ci id="S2.p3.5.m5.1.1.3.2.cmml" xref="S2.p3.5.m5.1.1.3.2">ğ‘–</ci><ci id="S2.p3.5.m5.1.1.3.3.cmml" xref="S2.p3.5.m5.1.1.3.3">ğ‘—</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.1c">x_{i_{j}}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is the score of the item <math alttext="j" class="ltx_Math" display="inline" id="S2.p3.6.m6.1"><semantics id="S2.p3.6.m6.1a"><mi id="S2.p3.6.m6.1.1" xref="S2.p3.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p3.6.m6.1b"><ci id="S2.p3.6.m6.1.1.cmml" xref="S2.p3.6.m6.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p3.6.m6.1d">italic_j</annotation></semantics></math> related to the position <math alttext="i" class="ltx_Math" display="inline" id="S2.p3.7.m7.1"><semantics id="S2.p3.7.m7.1a"><mi id="S2.p3.7.m7.1.1" xref="S2.p3.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p3.7.m7.1b"><ci id="S2.p3.7.m7.1.1.cmml" xref="S2.p3.7.m7.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m7.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p3.7.m7.1d">italic_i</annotation></semantics></math> and <math alttext="N" class="ltx_Math" display="inline" id="S2.p3.8.m8.1"><semantics id="S2.p3.8.m8.1a"><mi id="S2.p3.8.m8.1.1" xref="S2.p3.8.m8.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p3.8.m8.1b"><ci id="S2.p3.8.m8.1.1.cmml" xref="S2.p3.8.m8.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m8.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p3.8.m8.1d">italic_N</annotation></semantics></math> is the number of items in the catalogue.
The loss function used for the training of BERT4Rec model is Cross Entropy, where</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{M}(j_{i})=softmax(x_{j_{i}})=\frac{e^{x_{j_{i}}}}{\sum_{z=1}^{N}e^{x_{j_{z}%
}}}" class="ltx_Math" display="block" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.3" xref="S2.E1.m1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.3.2.cmml">p</mi><mi id="S2.E1.m1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.3.3.cmml">M</mi></msub><mo id="S2.E1.m1.1.1.1.2" xref="S2.E1.m1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">j</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E1.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.4" xref="S2.E1.m1.2.2.4.cmml">=</mo><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><mi id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml">s</mi><mo id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.4.cmml">o</mi><mo id="S2.E1.m1.2.2.2.2a" xref="S2.E1.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E1.m1.2.2.2.5" xref="S2.E1.m1.2.2.2.5.cmml">f</mi><mo id="S2.E1.m1.2.2.2.2b" xref="S2.E1.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E1.m1.2.2.2.6" xref="S2.E1.m1.2.2.2.6.cmml">t</mi><mo id="S2.E1.m1.2.2.2.2c" xref="S2.E1.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E1.m1.2.2.2.7" xref="S2.E1.m1.2.2.2.7.cmml">m</mi><mo id="S2.E1.m1.2.2.2.2d" xref="S2.E1.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E1.m1.2.2.2.8" xref="S2.E1.m1.2.2.2.8.cmml">a</mi><mo id="S2.E1.m1.2.2.2.2e" xref="S2.E1.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E1.m1.2.2.2.9" xref="S2.E1.m1.2.2.2.9.cmml">x</mi><mo id="S2.E1.m1.2.2.2.2f" xref="S2.E1.m1.2.2.2.2.cmml">â¢</mo><mrow id="S2.E1.m1.2.2.2.1.1" xref="S2.E1.m1.2.2.2.1.1.1.cmml"><mo id="S2.E1.m1.2.2.2.1.1.2" stretchy="false" xref="S2.E1.m1.2.2.2.1.1.1.cmml">(</mo><msub id="S2.E1.m1.2.2.2.1.1.1" xref="S2.E1.m1.2.2.2.1.1.1.cmml"><mi id="S2.E1.m1.2.2.2.1.1.1.2" xref="S2.E1.m1.2.2.2.1.1.1.2.cmml">x</mi><msub id="S2.E1.m1.2.2.2.1.1.1.3" xref="S2.E1.m1.2.2.2.1.1.1.3.cmml"><mi id="S2.E1.m1.2.2.2.1.1.1.3.2" xref="S2.E1.m1.2.2.2.1.1.1.3.2.cmml">j</mi><mi id="S2.E1.m1.2.2.2.1.1.1.3.3" xref="S2.E1.m1.2.2.2.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="S2.E1.m1.2.2.2.1.1.3" stretchy="false" xref="S2.E1.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.5" xref="S2.E1.m1.2.2.5.cmml">=</mo><mfrac id="S2.E1.m1.2.2.6" xref="S2.E1.m1.2.2.6.cmml"><msup id="S2.E1.m1.2.2.6.2" xref="S2.E1.m1.2.2.6.2.cmml"><mi id="S2.E1.m1.2.2.6.2.2" xref="S2.E1.m1.2.2.6.2.2.cmml">e</mi><msub id="S2.E1.m1.2.2.6.2.3" xref="S2.E1.m1.2.2.6.2.3.cmml"><mi id="S2.E1.m1.2.2.6.2.3.2" xref="S2.E1.m1.2.2.6.2.3.2.cmml">x</mi><msub id="S2.E1.m1.2.2.6.2.3.3" xref="S2.E1.m1.2.2.6.2.3.3.cmml"><mi id="S2.E1.m1.2.2.6.2.3.3.2" xref="S2.E1.m1.2.2.6.2.3.3.2.cmml">j</mi><mi id="S2.E1.m1.2.2.6.2.3.3.3" xref="S2.E1.m1.2.2.6.2.3.3.3.cmml">i</mi></msub></msub></msup><mrow id="S2.E1.m1.2.2.6.3" xref="S2.E1.m1.2.2.6.3.cmml"><msubsup id="S2.E1.m1.2.2.6.3.1" xref="S2.E1.m1.2.2.6.3.1.cmml"><mo id="S2.E1.m1.2.2.6.3.1.2.2" xref="S2.E1.m1.2.2.6.3.1.2.2.cmml">âˆ‘</mo><mrow id="S2.E1.m1.2.2.6.3.1.2.3" xref="S2.E1.m1.2.2.6.3.1.2.3.cmml"><mi id="S2.E1.m1.2.2.6.3.1.2.3.2" xref="S2.E1.m1.2.2.6.3.1.2.3.2.cmml">z</mi><mo id="S2.E1.m1.2.2.6.3.1.2.3.1" xref="S2.E1.m1.2.2.6.3.1.2.3.1.cmml">=</mo><mn id="S2.E1.m1.2.2.6.3.1.2.3.3" xref="S2.E1.m1.2.2.6.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.2.2.6.3.1.3" xref="S2.E1.m1.2.2.6.3.1.3.cmml">N</mi></msubsup><msup id="S2.E1.m1.2.2.6.3.2" xref="S2.E1.m1.2.2.6.3.2.cmml"><mi id="S2.E1.m1.2.2.6.3.2.2" xref="S2.E1.m1.2.2.6.3.2.2.cmml">e</mi><msub id="S2.E1.m1.2.2.6.3.2.3" xref="S2.E1.m1.2.2.6.3.2.3.cmml"><mi id="S2.E1.m1.2.2.6.3.2.3.2" xref="S2.E1.m1.2.2.6.3.2.3.2.cmml">x</mi><msub id="S2.E1.m1.2.2.6.3.2.3.3" xref="S2.E1.m1.2.2.6.3.2.3.3.cmml"><mi id="S2.E1.m1.2.2.6.3.2.3.3.2" xref="S2.E1.m1.2.2.6.3.2.3.3.2.cmml">j</mi><mi id="S2.E1.m1.2.2.6.3.2.3.3.3" xref="S2.E1.m1.2.2.6.3.2.3.3.3.cmml">z</mi></msub></msub></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><and id="S2.E1.m1.2.2a.cmml" xref="S2.E1.m1.2.2"></and><apply id="S2.E1.m1.2.2b.cmml" xref="S2.E1.m1.2.2"><eq id="S2.E1.m1.2.2.4.cmml" xref="S2.E1.m1.2.2.4"></eq><apply id="S2.E1.m1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><times id="S2.E1.m1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.2"></times><apply id="S2.E1.m1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.3.2">ğ‘</ci><ci id="S2.E1.m1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.3.3">ğ‘€</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2">ğ‘—</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><times id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"></times><ci id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3">ğ‘ </ci><ci id="S2.E1.m1.2.2.2.4.cmml" xref="S2.E1.m1.2.2.2.4">ğ‘œ</ci><ci id="S2.E1.m1.2.2.2.5.cmml" xref="S2.E1.m1.2.2.2.5">ğ‘“</ci><ci id="S2.E1.m1.2.2.2.6.cmml" xref="S2.E1.m1.2.2.2.6">ğ‘¡</ci><ci id="S2.E1.m1.2.2.2.7.cmml" xref="S2.E1.m1.2.2.2.7">ğ‘š</ci><ci id="S2.E1.m1.2.2.2.8.cmml" xref="S2.E1.m1.2.2.2.8">ğ‘</ci><ci id="S2.E1.m1.2.2.2.9.cmml" xref="S2.E1.m1.2.2.2.9">ğ‘¥</ci><apply id="S2.E1.m1.2.2.2.1.1.1.cmml" xref="S2.E1.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.2.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.2.1.1.1.2.cmml" xref="S2.E1.m1.2.2.2.1.1.1.2">ğ‘¥</ci><apply id="S2.E1.m1.2.2.2.1.1.1.3.cmml" xref="S2.E1.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.1.1.1.3.1.cmml" xref="S2.E1.m1.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.2.2.2.1.1.1.3.2.cmml" xref="S2.E1.m1.2.2.2.1.1.1.3.2">ğ‘—</ci><ci id="S2.E1.m1.2.2.2.1.1.1.3.3.cmml" xref="S2.E1.m1.2.2.2.1.1.1.3.3">ğ‘–</ci></apply></apply></apply></apply><apply id="S2.E1.m1.2.2c.cmml" xref="S2.E1.m1.2.2"><eq id="S2.E1.m1.2.2.5.cmml" xref="S2.E1.m1.2.2.5"></eq><share href="https://arxiv.org/html/2409.04329v1#S2.E1.m1.2.2.2.cmml" id="S2.E1.m1.2.2d.cmml" xref="S2.E1.m1.2.2"></share><apply id="S2.E1.m1.2.2.6.cmml" xref="S2.E1.m1.2.2.6"><divide id="S2.E1.m1.2.2.6.1.cmml" xref="S2.E1.m1.2.2.6"></divide><apply id="S2.E1.m1.2.2.6.2.cmml" xref="S2.E1.m1.2.2.6.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.6.2.1.cmml" xref="S2.E1.m1.2.2.6.2">superscript</csymbol><ci id="S2.E1.m1.2.2.6.2.2.cmml" xref="S2.E1.m1.2.2.6.2.2">ğ‘’</ci><apply id="S2.E1.m1.2.2.6.2.3.cmml" xref="S2.E1.m1.2.2.6.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.6.2.3.1.cmml" xref="S2.E1.m1.2.2.6.2.3">subscript</csymbol><ci id="S2.E1.m1.2.2.6.2.3.2.cmml" xref="S2.E1.m1.2.2.6.2.3.2">ğ‘¥</ci><apply id="S2.E1.m1.2.2.6.2.3.3.cmml" xref="S2.E1.m1.2.2.6.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.6.2.3.3.1.cmml" xref="S2.E1.m1.2.2.6.2.3.3">subscript</csymbol><ci id="S2.E1.m1.2.2.6.2.3.3.2.cmml" xref="S2.E1.m1.2.2.6.2.3.3.2">ğ‘—</ci><ci id="S2.E1.m1.2.2.6.2.3.3.3.cmml" xref="S2.E1.m1.2.2.6.2.3.3.3">ğ‘–</ci></apply></apply></apply><apply id="S2.E1.m1.2.2.6.3.cmml" xref="S2.E1.m1.2.2.6.3"><apply id="S2.E1.m1.2.2.6.3.1.cmml" xref="S2.E1.m1.2.2.6.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.6.3.1.1.cmml" xref="S2.E1.m1.2.2.6.3.1">superscript</csymbol><apply id="S2.E1.m1.2.2.6.3.1.2.cmml" xref="S2.E1.m1.2.2.6.3.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.6.3.1.2.1.cmml" xref="S2.E1.m1.2.2.6.3.1">subscript</csymbol><sum id="S2.E1.m1.2.2.6.3.1.2.2.cmml" xref="S2.E1.m1.2.2.6.3.1.2.2"></sum><apply id="S2.E1.m1.2.2.6.3.1.2.3.cmml" xref="S2.E1.m1.2.2.6.3.1.2.3"><eq id="S2.E1.m1.2.2.6.3.1.2.3.1.cmml" xref="S2.E1.m1.2.2.6.3.1.2.3.1"></eq><ci id="S2.E1.m1.2.2.6.3.1.2.3.2.cmml" xref="S2.E1.m1.2.2.6.3.1.2.3.2">ğ‘§</ci><cn id="S2.E1.m1.2.2.6.3.1.2.3.3.cmml" type="integer" xref="S2.E1.m1.2.2.6.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.2.2.6.3.1.3.cmml" xref="S2.E1.m1.2.2.6.3.1.3">ğ‘</ci></apply><apply id="S2.E1.m1.2.2.6.3.2.cmml" xref="S2.E1.m1.2.2.6.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.6.3.2.1.cmml" xref="S2.E1.m1.2.2.6.3.2">superscript</csymbol><ci id="S2.E1.m1.2.2.6.3.2.2.cmml" xref="S2.E1.m1.2.2.6.3.2.2">ğ‘’</ci><apply id="S2.E1.m1.2.2.6.3.2.3.cmml" xref="S2.E1.m1.2.2.6.3.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.6.3.2.3.1.cmml" xref="S2.E1.m1.2.2.6.3.2.3">subscript</csymbol><ci id="S2.E1.m1.2.2.6.3.2.3.2.cmml" xref="S2.E1.m1.2.2.6.3.2.3.2">ğ‘¥</ci><apply id="S2.E1.m1.2.2.6.3.2.3.3.cmml" xref="S2.E1.m1.2.2.6.3.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.6.3.2.3.3.1.cmml" xref="S2.E1.m1.2.2.6.3.2.3.3">subscript</csymbol><ci id="S2.E1.m1.2.2.6.3.2.3.3.2.cmml" xref="S2.E1.m1.2.2.6.3.2.3.3.2">ğ‘—</ci><ci id="S2.E1.m1.2.2.6.3.2.3.3.3.cmml" xref="S2.E1.m1.2.2.6.3.2.3.3.3">ğ‘§</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">p_{M}(j_{i})=softmax(x_{j_{i}})=\frac{e^{x_{j_{i}}}}{\sum_{z=1}^{N}e^{x_{j_{z}%
}}}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_s italic_o italic_f italic_t italic_m italic_a italic_x ( italic_x start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) = divide start_ARG italic_e start_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_x start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p3.10">is the probability of item <math alttext="j" class="ltx_Math" display="inline" id="S2.p3.9.m1.1"><semantics id="S2.p3.9.m1.1a"><mi id="S2.p3.9.m1.1.1" xref="S2.p3.9.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p3.9.m1.1b"><ci id="S2.p3.9.m1.1.1.cmml" xref="S2.p3.9.m1.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p3.9.m1.1d">italic_j</annotation></semantics></math> to be ranked in position <math alttext="i" class="ltx_Math" display="inline" id="S2.p3.10.m2.1"><semantics id="S2.p3.10.m2.1a"><mi id="S2.p3.10.m2.1.1" xref="S2.p3.10.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p3.10.m2.1b"><ci id="S2.p3.10.m2.1.1.cmml" xref="S2.p3.10.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.10.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p3.10.m2.1d">italic_i</annotation></semantics></math>. Similarly, the loss used for the training of SASRec and gSASRec models is the Binary Cross Entropy (BCE) and the generalized Binary Cross Entropy loss (gBCE), respectively, where</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{M}(j_{i})=sigmoid(x_{j_{i}})=\frac{1}{1+e^{-x_{j_{i}}}}" class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.3.2.cmml">p</mi><mi id="S2.E2.m1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.3.3.cmml">M</mi></msub><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">j</mi><mi id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.E2.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.2.2.4" xref="S2.E2.m1.2.2.4.cmml">=</mo><mrow id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><mi id="S2.E2.m1.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">s</mi><mo id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.4.cmml">i</mi><mo id="S2.E2.m1.2.2.2.2a" xref="S2.E2.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E2.m1.2.2.2.5" xref="S2.E2.m1.2.2.2.5.cmml">g</mi><mo id="S2.E2.m1.2.2.2.2b" xref="S2.E2.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E2.m1.2.2.2.6" xref="S2.E2.m1.2.2.2.6.cmml">m</mi><mo id="S2.E2.m1.2.2.2.2c" xref="S2.E2.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E2.m1.2.2.2.7" xref="S2.E2.m1.2.2.2.7.cmml">o</mi><mo id="S2.E2.m1.2.2.2.2d" xref="S2.E2.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E2.m1.2.2.2.8" xref="S2.E2.m1.2.2.2.8.cmml">i</mi><mo id="S2.E2.m1.2.2.2.2e" xref="S2.E2.m1.2.2.2.2.cmml">â¢</mo><mi id="S2.E2.m1.2.2.2.9" xref="S2.E2.m1.2.2.2.9.cmml">d</mi><mo id="S2.E2.m1.2.2.2.2f" xref="S2.E2.m1.2.2.2.2.cmml">â¢</mo><mrow id="S2.E2.m1.2.2.2.1.1" xref="S2.E2.m1.2.2.2.1.1.1.cmml"><mo id="S2.E2.m1.2.2.2.1.1.2" stretchy="false" xref="S2.E2.m1.2.2.2.1.1.1.cmml">(</mo><msub id="S2.E2.m1.2.2.2.1.1.1" xref="S2.E2.m1.2.2.2.1.1.1.cmml"><mi id="S2.E2.m1.2.2.2.1.1.1.2" xref="S2.E2.m1.2.2.2.1.1.1.2.cmml">x</mi><msub id="S2.E2.m1.2.2.2.1.1.1.3" xref="S2.E2.m1.2.2.2.1.1.1.3.cmml"><mi id="S2.E2.m1.2.2.2.1.1.1.3.2" xref="S2.E2.m1.2.2.2.1.1.1.3.2.cmml">j</mi><mi id="S2.E2.m1.2.2.2.1.1.1.3.3" xref="S2.E2.m1.2.2.2.1.1.1.3.3.cmml">i</mi></msub></msub><mo id="S2.E2.m1.2.2.2.1.1.3" stretchy="false" xref="S2.E2.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.2.2.5" xref="S2.E2.m1.2.2.5.cmml">=</mo><mfrac id="S2.E2.m1.2.2.6" xref="S2.E2.m1.2.2.6.cmml"><mn id="S2.E2.m1.2.2.6.2" xref="S2.E2.m1.2.2.6.2.cmml">1</mn><mrow id="S2.E2.m1.2.2.6.3" xref="S2.E2.m1.2.2.6.3.cmml"><mn id="S2.E2.m1.2.2.6.3.2" xref="S2.E2.m1.2.2.6.3.2.cmml">1</mn><mo id="S2.E2.m1.2.2.6.3.1" xref="S2.E2.m1.2.2.6.3.1.cmml">+</mo><msup id="S2.E2.m1.2.2.6.3.3" xref="S2.E2.m1.2.2.6.3.3.cmml"><mi id="S2.E2.m1.2.2.6.3.3.2" xref="S2.E2.m1.2.2.6.3.3.2.cmml">e</mi><mrow id="S2.E2.m1.2.2.6.3.3.3" xref="S2.E2.m1.2.2.6.3.3.3.cmml"><mo id="S2.E2.m1.2.2.6.3.3.3a" xref="S2.E2.m1.2.2.6.3.3.3.cmml">âˆ’</mo><msub id="S2.E2.m1.2.2.6.3.3.3.2" xref="S2.E2.m1.2.2.6.3.3.3.2.cmml"><mi id="S2.E2.m1.2.2.6.3.3.3.2.2" xref="S2.E2.m1.2.2.6.3.3.3.2.2.cmml">x</mi><msub id="S2.E2.m1.2.2.6.3.3.3.2.3" xref="S2.E2.m1.2.2.6.3.3.3.2.3.cmml"><mi id="S2.E2.m1.2.2.6.3.3.3.2.3.2" xref="S2.E2.m1.2.2.6.3.3.3.2.3.2.cmml">j</mi><mi id="S2.E2.m1.2.2.6.3.3.3.2.3.3" xref="S2.E2.m1.2.2.6.3.3.3.2.3.3.cmml">i</mi></msub></msub></mrow></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2"><and id="S2.E2.m1.2.2a.cmml" xref="S2.E2.m1.2.2"></and><apply id="S2.E2.m1.2.2b.cmml" xref="S2.E2.m1.2.2"><eq id="S2.E2.m1.2.2.4.cmml" xref="S2.E2.m1.2.2.4"></eq><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></times><apply id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.3.2">ğ‘</ci><ci id="S2.E2.m1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.3.3">ğ‘€</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2">ğ‘—</ci><ci id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">ğ‘–</ci></apply></apply><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><times id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2"></times><ci id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.3">ğ‘ </ci><ci id="S2.E2.m1.2.2.2.4.cmml" xref="S2.E2.m1.2.2.2.4">ğ‘–</ci><ci id="S2.E2.m1.2.2.2.5.cmml" xref="S2.E2.m1.2.2.2.5">ğ‘”</ci><ci id="S2.E2.m1.2.2.2.6.cmml" xref="S2.E2.m1.2.2.2.6">ğ‘š</ci><ci id="S2.E2.m1.2.2.2.7.cmml" xref="S2.E2.m1.2.2.2.7">ğ‘œ</ci><ci id="S2.E2.m1.2.2.2.8.cmml" xref="S2.E2.m1.2.2.2.8">ğ‘–</ci><ci id="S2.E2.m1.2.2.2.9.cmml" xref="S2.E2.m1.2.2.2.9">ğ‘‘</ci><apply id="S2.E2.m1.2.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.1.1.1.2">ğ‘¥</ci><apply id="S2.E2.m1.2.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.1.1.1.3.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.2.2.2.1.1.1.3.2.cmml" xref="S2.E2.m1.2.2.2.1.1.1.3.2">ğ‘—</ci><ci id="S2.E2.m1.2.2.2.1.1.1.3.3.cmml" xref="S2.E2.m1.2.2.2.1.1.1.3.3">ğ‘–</ci></apply></apply></apply></apply><apply id="S2.E2.m1.2.2c.cmml" xref="S2.E2.m1.2.2"><eq id="S2.E2.m1.2.2.5.cmml" xref="S2.E2.m1.2.2.5"></eq><share href="https://arxiv.org/html/2409.04329v1#S2.E2.m1.2.2.2.cmml" id="S2.E2.m1.2.2d.cmml" xref="S2.E2.m1.2.2"></share><apply id="S2.E2.m1.2.2.6.cmml" xref="S2.E2.m1.2.2.6"><divide id="S2.E2.m1.2.2.6.1.cmml" xref="S2.E2.m1.2.2.6"></divide><cn id="S2.E2.m1.2.2.6.2.cmml" type="integer" xref="S2.E2.m1.2.2.6.2">1</cn><apply id="S2.E2.m1.2.2.6.3.cmml" xref="S2.E2.m1.2.2.6.3"><plus id="S2.E2.m1.2.2.6.3.1.cmml" xref="S2.E2.m1.2.2.6.3.1"></plus><cn id="S2.E2.m1.2.2.6.3.2.cmml" type="integer" xref="S2.E2.m1.2.2.6.3.2">1</cn><apply id="S2.E2.m1.2.2.6.3.3.cmml" xref="S2.E2.m1.2.2.6.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.6.3.3.1.cmml" xref="S2.E2.m1.2.2.6.3.3">superscript</csymbol><ci id="S2.E2.m1.2.2.6.3.3.2.cmml" xref="S2.E2.m1.2.2.6.3.3.2">ğ‘’</ci><apply id="S2.E2.m1.2.2.6.3.3.3.cmml" xref="S2.E2.m1.2.2.6.3.3.3"><minus id="S2.E2.m1.2.2.6.3.3.3.1.cmml" xref="S2.E2.m1.2.2.6.3.3.3"></minus><apply id="S2.E2.m1.2.2.6.3.3.3.2.cmml" xref="S2.E2.m1.2.2.6.3.3.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.6.3.3.3.2.1.cmml" xref="S2.E2.m1.2.2.6.3.3.3.2">subscript</csymbol><ci id="S2.E2.m1.2.2.6.3.3.3.2.2.cmml" xref="S2.E2.m1.2.2.6.3.3.3.2.2">ğ‘¥</ci><apply id="S2.E2.m1.2.2.6.3.3.3.2.3.cmml" xref="S2.E2.m1.2.2.6.3.3.3.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.6.3.3.3.2.3.1.cmml" xref="S2.E2.m1.2.2.6.3.3.3.2.3">subscript</csymbol><ci id="S2.E2.m1.2.2.6.3.3.3.2.3.2.cmml" xref="S2.E2.m1.2.2.6.3.3.3.2.3.2">ğ‘—</ci><ci id="S2.E2.m1.2.2.6.3.3.3.2.3.3.cmml" xref="S2.E2.m1.2.2.6.3.3.3.2.3.3">ğ‘–</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">p_{M}(j_{i})=sigmoid(x_{j_{i}})=\frac{1}{1+e^{-x_{j_{i}}}}</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_j start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = italic_s italic_i italic_g italic_m italic_o italic_i italic_d ( italic_x start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) = divide start_ARG 1 end_ARG start_ARG 1 + italic_e start_POSTSUPERSCRIPT - italic_x start_POSTSUBSCRIPT italic_j start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p3.14">is the probability of item <math alttext="j" class="ltx_Math" display="inline" id="S2.p3.11.m1.1"><semantics id="S2.p3.11.m1.1a"><mi id="S2.p3.11.m1.1.1" xref="S2.p3.11.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p3.11.m1.1b"><ci id="S2.p3.11.m1.1.1.cmml" xref="S2.p3.11.m1.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.11.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p3.11.m1.1d">italic_j</annotation></semantics></math> to at position <math alttext="i" class="ltx_Math" display="inline" id="S2.p3.12.m2.1"><semantics id="S2.p3.12.m2.1a"><mi id="S2.p3.12.m2.1.1" xref="S2.p3.12.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p3.12.m2.1b"><ci id="S2.p3.12.m2.1.1.cmml" xref="S2.p3.12.m2.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.12.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p3.12.m2.1d">italic_i</annotation></semantics></math> (in case of gBCE, the <math alttext="sigmoid(\cdot)" class="ltx_Math" display="inline" id="S2.p3.13.m3.1"><semantics id="S2.p3.13.m3.1a"><mrow id="S2.p3.13.m3.1.2" xref="S2.p3.13.m3.1.2.cmml"><mi id="S2.p3.13.m3.1.2.2" xref="S2.p3.13.m3.1.2.2.cmml">s</mi><mo id="S2.p3.13.m3.1.2.1" xref="S2.p3.13.m3.1.2.1.cmml">â¢</mo><mi id="S2.p3.13.m3.1.2.3" xref="S2.p3.13.m3.1.2.3.cmml">i</mi><mo id="S2.p3.13.m3.1.2.1a" xref="S2.p3.13.m3.1.2.1.cmml">â¢</mo><mi id="S2.p3.13.m3.1.2.4" xref="S2.p3.13.m3.1.2.4.cmml">g</mi><mo id="S2.p3.13.m3.1.2.1b" xref="S2.p3.13.m3.1.2.1.cmml">â¢</mo><mi id="S2.p3.13.m3.1.2.5" xref="S2.p3.13.m3.1.2.5.cmml">m</mi><mo id="S2.p3.13.m3.1.2.1c" xref="S2.p3.13.m3.1.2.1.cmml">â¢</mo><mi id="S2.p3.13.m3.1.2.6" xref="S2.p3.13.m3.1.2.6.cmml">o</mi><mo id="S2.p3.13.m3.1.2.1d" xref="S2.p3.13.m3.1.2.1.cmml">â¢</mo><mi id="S2.p3.13.m3.1.2.7" xref="S2.p3.13.m3.1.2.7.cmml">i</mi><mo id="S2.p3.13.m3.1.2.1e" xref="S2.p3.13.m3.1.2.1.cmml">â¢</mo><mi id="S2.p3.13.m3.1.2.8" xref="S2.p3.13.m3.1.2.8.cmml">d</mi><mo id="S2.p3.13.m3.1.2.1f" xref="S2.p3.13.m3.1.2.1.cmml">â¢</mo><mrow id="S2.p3.13.m3.1.2.9.2" xref="S2.p3.13.m3.1.2.cmml"><mo id="S2.p3.13.m3.1.2.9.2.1" stretchy="false" xref="S2.p3.13.m3.1.2.cmml">(</mo><mo id="S2.p3.13.m3.1.1" lspace="0em" rspace="0em" xref="S2.p3.13.m3.1.1.cmml">â‹…</mo><mo id="S2.p3.13.m3.1.2.9.2.2" stretchy="false" xref="S2.p3.13.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.13.m3.1b"><apply id="S2.p3.13.m3.1.2.cmml" xref="S2.p3.13.m3.1.2"><times id="S2.p3.13.m3.1.2.1.cmml" xref="S2.p3.13.m3.1.2.1"></times><ci id="S2.p3.13.m3.1.2.2.cmml" xref="S2.p3.13.m3.1.2.2">ğ‘ </ci><ci id="S2.p3.13.m3.1.2.3.cmml" xref="S2.p3.13.m3.1.2.3">ğ‘–</ci><ci id="S2.p3.13.m3.1.2.4.cmml" xref="S2.p3.13.m3.1.2.4">ğ‘”</ci><ci id="S2.p3.13.m3.1.2.5.cmml" xref="S2.p3.13.m3.1.2.5">ğ‘š</ci><ci id="S2.p3.13.m3.1.2.6.cmml" xref="S2.p3.13.m3.1.2.6">ğ‘œ</ci><ci id="S2.p3.13.m3.1.2.7.cmml" xref="S2.p3.13.m3.1.2.7">ğ‘–</ci><ci id="S2.p3.13.m3.1.2.8.cmml" xref="S2.p3.13.m3.1.2.8">ğ‘‘</ci><ci id="S2.p3.13.m3.1.1.cmml" xref="S2.p3.13.m3.1.1">â‹…</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.13.m3.1c">sigmoid(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.13.m3.1d">italic_s italic_i italic_g italic_m italic_o italic_i italic_d ( â‹… )</annotation></semantics></math> is then raised to the power of <math alttext="\beta" class="ltx_Math" display="inline" id="S2.p3.14.m4.1"><semantics id="S2.p3.14.m4.1a"><mi id="S2.p3.14.m4.1.1" xref="S2.p3.14.m4.1.1.cmml">Î²</mi><annotation-xml encoding="MathML-Content" id="S2.p3.14.m4.1b"><ci id="S2.p3.14.m4.1.1.cmml" xref="S2.p3.14.m4.1.1">ğ›½</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.14.m4.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.p3.14.m4.1d">italic_Î²</annotation></semantics></math> before applying the loss).</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p4">
<p class="ltx_p" id="S2.p4.6"><span class="ltx_text ltx_font_bold" id="S2.p4.6.1">Personalized Popularity Item Probability.</span>
Let us denote with <math alttext="C=[c_{1},\ldots,c_{i},\ldots,c_{N}]" class="ltx_Math" display="inline" id="S2.p4.1.m1.5"><semantics id="S2.p4.1.m1.5a"><mrow id="S2.p4.1.m1.5.5" xref="S2.p4.1.m1.5.5.cmml"><mi id="S2.p4.1.m1.5.5.5" xref="S2.p4.1.m1.5.5.5.cmml">C</mi><mo id="S2.p4.1.m1.5.5.4" xref="S2.p4.1.m1.5.5.4.cmml">=</mo><mrow id="S2.p4.1.m1.5.5.3.3" xref="S2.p4.1.m1.5.5.3.4.cmml"><mo id="S2.p4.1.m1.5.5.3.3.4" stretchy="false" xref="S2.p4.1.m1.5.5.3.4.cmml">[</mo><msub id="S2.p4.1.m1.3.3.1.1.1" xref="S2.p4.1.m1.3.3.1.1.1.cmml"><mi id="S2.p4.1.m1.3.3.1.1.1.2" xref="S2.p4.1.m1.3.3.1.1.1.2.cmml">c</mi><mn id="S2.p4.1.m1.3.3.1.1.1.3" xref="S2.p4.1.m1.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S2.p4.1.m1.5.5.3.3.5" xref="S2.p4.1.m1.5.5.3.4.cmml">,</mo><mi id="S2.p4.1.m1.1.1" mathvariant="normal" xref="S2.p4.1.m1.1.1.cmml">â€¦</mi><mo id="S2.p4.1.m1.5.5.3.3.6" xref="S2.p4.1.m1.5.5.3.4.cmml">,</mo><msub id="S2.p4.1.m1.4.4.2.2.2" xref="S2.p4.1.m1.4.4.2.2.2.cmml"><mi id="S2.p4.1.m1.4.4.2.2.2.2" xref="S2.p4.1.m1.4.4.2.2.2.2.cmml">c</mi><mi id="S2.p4.1.m1.4.4.2.2.2.3" xref="S2.p4.1.m1.4.4.2.2.2.3.cmml">i</mi></msub><mo id="S2.p4.1.m1.5.5.3.3.7" xref="S2.p4.1.m1.5.5.3.4.cmml">,</mo><mi id="S2.p4.1.m1.2.2" mathvariant="normal" xref="S2.p4.1.m1.2.2.cmml">â€¦</mi><mo id="S2.p4.1.m1.5.5.3.3.8" xref="S2.p4.1.m1.5.5.3.4.cmml">,</mo><msub id="S2.p4.1.m1.5.5.3.3.3" xref="S2.p4.1.m1.5.5.3.3.3.cmml"><mi id="S2.p4.1.m1.5.5.3.3.3.2" xref="S2.p4.1.m1.5.5.3.3.3.2.cmml">c</mi><mi id="S2.p4.1.m1.5.5.3.3.3.3" xref="S2.p4.1.m1.5.5.3.3.3.3.cmml">N</mi></msub><mo id="S2.p4.1.m1.5.5.3.3.9" stretchy="false" xref="S2.p4.1.m1.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.5b"><apply id="S2.p4.1.m1.5.5.cmml" xref="S2.p4.1.m1.5.5"><eq id="S2.p4.1.m1.5.5.4.cmml" xref="S2.p4.1.m1.5.5.4"></eq><ci id="S2.p4.1.m1.5.5.5.cmml" xref="S2.p4.1.m1.5.5.5">ğ¶</ci><list id="S2.p4.1.m1.5.5.3.4.cmml" xref="S2.p4.1.m1.5.5.3.3"><apply id="S2.p4.1.m1.3.3.1.1.1.cmml" xref="S2.p4.1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.m1.3.3.1.1.1.1.cmml" xref="S2.p4.1.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.p4.1.m1.3.3.1.1.1.2.cmml" xref="S2.p4.1.m1.3.3.1.1.1.2">ğ‘</ci><cn id="S2.p4.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S2.p4.1.m1.3.3.1.1.1.3">1</cn></apply><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">â€¦</ci><apply id="S2.p4.1.m1.4.4.2.2.2.cmml" xref="S2.p4.1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.p4.1.m1.4.4.2.2.2.1.cmml" xref="S2.p4.1.m1.4.4.2.2.2">subscript</csymbol><ci id="S2.p4.1.m1.4.4.2.2.2.2.cmml" xref="S2.p4.1.m1.4.4.2.2.2.2">ğ‘</ci><ci id="S2.p4.1.m1.4.4.2.2.2.3.cmml" xref="S2.p4.1.m1.4.4.2.2.2.3">ğ‘–</ci></apply><ci id="S2.p4.1.m1.2.2.cmml" xref="S2.p4.1.m1.2.2">â€¦</ci><apply id="S2.p4.1.m1.5.5.3.3.3.cmml" xref="S2.p4.1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.p4.1.m1.5.5.3.3.3.1.cmml" xref="S2.p4.1.m1.5.5.3.3.3">subscript</csymbol><ci id="S2.p4.1.m1.5.5.3.3.3.2.cmml" xref="S2.p4.1.m1.5.5.3.3.3.2">ğ‘</ci><ci id="S2.p4.1.m1.5.5.3.3.3.3.cmml" xref="S2.p4.1.m1.5.5.3.3.3.3">ğ‘</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.5c">C=[c_{1},\ldots,c_{i},\ldots,c_{N}]</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.5d">italic_C = [ italic_c start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , â€¦ , italic_c start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ]</annotation></semantics></math> the <span class="ltx_text ltx_font_italic" id="S2.p4.6.2">counts vector</span> obtained from the input sequence <math alttext="S" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><mi id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><ci id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1">ğ‘†</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">italic_S</annotation></semantics></math>, where <math alttext="c_{i}" class="ltx_Math" display="inline" id="S2.p4.3.m3.1"><semantics id="S2.p4.3.m3.1a"><msub id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml"><mi id="S2.p4.3.m3.1.1.2" xref="S2.p4.3.m3.1.1.2.cmml">c</mi><mi id="S2.p4.3.m3.1.1.3" xref="S2.p4.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.1b"><apply id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p4.3.m3.1.1.1.cmml" xref="S2.p4.3.m3.1.1">subscript</csymbol><ci id="S2.p4.3.m3.1.1.2.cmml" xref="S2.p4.3.m3.1.1.2">ğ‘</ci><ci id="S2.p4.3.m3.1.1.3.cmml" xref="S2.p4.3.m3.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.1c">c_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.3.m3.1d">italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the count of item <math alttext="i" class="ltx_Math" display="inline" id="S2.p4.4.m4.1"><semantics id="S2.p4.4.m4.1a"><mi id="S2.p4.4.m4.1.1" xref="S2.p4.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p4.4.m4.1b"><ci id="S2.p4.4.m4.1.1.cmml" xref="S2.p4.4.m4.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m4.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p4.4.m4.1d">italic_i</annotation></semantics></math> and <math alttext="N" class="ltx_Math" display="inline" id="S2.p4.5.m5.1"><semantics id="S2.p4.5.m5.1a"><mi id="S2.p4.5.m5.1.1" xref="S2.p4.5.m5.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p4.5.m5.1b"><ci id="S2.p4.5.m5.1.1.cmml" xref="S2.p4.5.m5.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.5.m5.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p4.5.m5.1d">italic_N</annotation></semantics></math> is the number of items in the catalogue. The probability of a previous item <math alttext="j" class="ltx_Math" display="inline" id="S2.p4.6.m6.1"><semantics id="S2.p4.6.m6.1a"><mi id="S2.p4.6.m6.1.1" xref="S2.p4.6.m6.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p4.6.m6.1b"><ci id="S2.p4.6.m6.1.1.cmml" xref="S2.p4.6.m6.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.6.m6.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p4.6.m6.1d">italic_j</annotation></semantics></math> being selected by the user, i.e. its <span class="ltx_text ltx_font_italic" id="S2.p4.6.3">personalized popularity</span> is<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We divide by <math alttext="max(C)" class="ltx_Math" display="inline" id="footnote1.m1.1"><semantics id="footnote1.m1.1b"><mrow id="footnote1.m1.1.2" xref="footnote1.m1.1.2.cmml"><mi id="footnote1.m1.1.2.2" xref="footnote1.m1.1.2.2.cmml">m</mi><mo id="footnote1.m1.1.2.1" xref="footnote1.m1.1.2.1.cmml">â¢</mo><mi id="footnote1.m1.1.2.3" xref="footnote1.m1.1.2.3.cmml">a</mi><mo id="footnote1.m1.1.2.1b" xref="footnote1.m1.1.2.1.cmml">â¢</mo><mi id="footnote1.m1.1.2.4" xref="footnote1.m1.1.2.4.cmml">x</mi><mo id="footnote1.m1.1.2.1c" xref="footnote1.m1.1.2.1.cmml">â¢</mo><mrow id="footnote1.m1.1.2.5.2" xref="footnote1.m1.1.2.cmml"><mo id="footnote1.m1.1.2.5.2.1" stretchy="false" xref="footnote1.m1.1.2.cmml">(</mo><mi id="footnote1.m1.1.1" xref="footnote1.m1.1.1.cmml">C</mi><mo id="footnote1.m1.1.2.5.2.2" stretchy="false" xref="footnote1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="footnote1.m1.1c"><apply id="footnote1.m1.1.2.cmml" xref="footnote1.m1.1.2"><times id="footnote1.m1.1.2.1.cmml" xref="footnote1.m1.1.2.1"></times><ci id="footnote1.m1.1.2.2.cmml" xref="footnote1.m1.1.2.2">ğ‘š</ci><ci id="footnote1.m1.1.2.3.cmml" xref="footnote1.m1.1.2.3">ğ‘</ci><ci id="footnote1.m1.1.2.4.cmml" xref="footnote1.m1.1.2.4">ğ‘¥</ci><ci id="footnote1.m1.1.1.cmml" xref="footnote1.m1.1.1">ğ¶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote1.m1.1d">max(C)</annotation><annotation encoding="application/x-llamapun" id="footnote1.m1.1e">italic_m italic_a italic_x ( italic_C )</annotation></semantics></math> to avoid numerical instabilities.</span></span></span>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{P}(j)=\frac{c_{j}}{\sum_{z=1}^{N}c_{z}}=\frac{\frac{c_{j}}{max(C)}}{\sum_{z%
=1}^{N}\frac{c_{z}}{max(C)}}." class="ltx_Math" display="block" id="S2.E3.m1.4"><semantics id="S2.E3.m1.4a"><mrow id="S2.E3.m1.4.4.1" xref="S2.E3.m1.4.4.1.1.cmml"><mrow id="S2.E3.m1.4.4.1.1" xref="S2.E3.m1.4.4.1.1.cmml"><mrow id="S2.E3.m1.4.4.1.1.2" xref="S2.E3.m1.4.4.1.1.2.cmml"><msub id="S2.E3.m1.4.4.1.1.2.2" xref="S2.E3.m1.4.4.1.1.2.2.cmml"><mi id="S2.E3.m1.4.4.1.1.2.2.2" xref="S2.E3.m1.4.4.1.1.2.2.2.cmml">p</mi><mi id="S2.E3.m1.4.4.1.1.2.2.3" xref="S2.E3.m1.4.4.1.1.2.2.3.cmml">P</mi></msub><mo id="S2.E3.m1.4.4.1.1.2.1" xref="S2.E3.m1.4.4.1.1.2.1.cmml">â¢</mo><mrow id="S2.E3.m1.4.4.1.1.2.3.2" xref="S2.E3.m1.4.4.1.1.2.cmml"><mo id="S2.E3.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="S2.E3.m1.4.4.1.1.2.cmml">(</mo><mi id="S2.E3.m1.3.3" xref="S2.E3.m1.3.3.cmml">j</mi><mo id="S2.E3.m1.4.4.1.1.2.3.2.2" stretchy="false" xref="S2.E3.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.4.4.1.1.3" xref="S2.E3.m1.4.4.1.1.3.cmml">=</mo><mfrac id="S2.E3.m1.4.4.1.1.4" xref="S2.E3.m1.4.4.1.1.4.cmml"><msub id="S2.E3.m1.4.4.1.1.4.2" xref="S2.E3.m1.4.4.1.1.4.2.cmml"><mi id="S2.E3.m1.4.4.1.1.4.2.2" xref="S2.E3.m1.4.4.1.1.4.2.2.cmml">c</mi><mi id="S2.E3.m1.4.4.1.1.4.2.3" xref="S2.E3.m1.4.4.1.1.4.2.3.cmml">j</mi></msub><mrow id="S2.E3.m1.4.4.1.1.4.3" xref="S2.E3.m1.4.4.1.1.4.3.cmml"><msubsup id="S2.E3.m1.4.4.1.1.4.3.1" xref="S2.E3.m1.4.4.1.1.4.3.1.cmml"><mo id="S2.E3.m1.4.4.1.1.4.3.1.2.2" xref="S2.E3.m1.4.4.1.1.4.3.1.2.2.cmml">âˆ‘</mo><mrow id="S2.E3.m1.4.4.1.1.4.3.1.2.3" xref="S2.E3.m1.4.4.1.1.4.3.1.2.3.cmml"><mi id="S2.E3.m1.4.4.1.1.4.3.1.2.3.2" xref="S2.E3.m1.4.4.1.1.4.3.1.2.3.2.cmml">z</mi><mo id="S2.E3.m1.4.4.1.1.4.3.1.2.3.1" xref="S2.E3.m1.4.4.1.1.4.3.1.2.3.1.cmml">=</mo><mn id="S2.E3.m1.4.4.1.1.4.3.1.2.3.3" xref="S2.E3.m1.4.4.1.1.4.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.4.4.1.1.4.3.1.3" xref="S2.E3.m1.4.4.1.1.4.3.1.3.cmml">N</mi></msubsup><msub id="S2.E3.m1.4.4.1.1.4.3.2" xref="S2.E3.m1.4.4.1.1.4.3.2.cmml"><mi id="S2.E3.m1.4.4.1.1.4.3.2.2" xref="S2.E3.m1.4.4.1.1.4.3.2.2.cmml">c</mi><mi id="S2.E3.m1.4.4.1.1.4.3.2.3" xref="S2.E3.m1.4.4.1.1.4.3.2.3.cmml">z</mi></msub></mrow></mfrac><mo id="S2.E3.m1.4.4.1.1.5" xref="S2.E3.m1.4.4.1.1.5.cmml">=</mo><mfrac id="S2.E3.m1.2.2" xref="S2.E3.m1.2.2.cmml"><mfrac id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.3" xref="S2.E3.m1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.3.2.cmml">c</mi><mi id="S2.E3.m1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.3.3.cmml">j</mi></msub><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml">m</mi><mo id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E3.m1.1.1.1.1.1.4" xref="S2.E3.m1.1.1.1.1.1.4.cmml">a</mi><mo id="S2.E3.m1.1.1.1.1.1.2a" xref="S2.E3.m1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E3.m1.1.1.1.1.1.5" xref="S2.E3.m1.1.1.1.1.1.5.cmml">x</mi><mo id="S2.E3.m1.1.1.1.1.1.2b" xref="S2.E3.m1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E3.m1.1.1.1.1.1.6.2" xref="S2.E3.m1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.6.2.1" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.cmml">(</mo><mi id="S2.E3.m1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.cmml">C</mi><mo id="S2.E3.m1.1.1.1.1.1.6.2.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mrow id="S2.E3.m1.2.2.2" xref="S2.E3.m1.2.2.2.cmml"><msubsup id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml"><mo id="S2.E3.m1.2.2.2.2.2.2" xref="S2.E3.m1.2.2.2.2.2.2.cmml">âˆ‘</mo><mrow id="S2.E3.m1.2.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.2.3.cmml"><mi id="S2.E3.m1.2.2.2.2.2.3.2" xref="S2.E3.m1.2.2.2.2.2.3.2.cmml">z</mi><mo id="S2.E3.m1.2.2.2.2.2.3.1" xref="S2.E3.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S2.E3.m1.2.2.2.2.2.3.3" xref="S2.E3.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m1.2.2.2.2.3" xref="S2.E3.m1.2.2.2.2.3.cmml">N</mi></msubsup><mfrac id="S2.E3.m1.2.2.2.1" xref="S2.E3.m1.2.2.2.1.cmml"><msub id="S2.E3.m1.2.2.2.1.3" xref="S2.E3.m1.2.2.2.1.3.cmml"><mi id="S2.E3.m1.2.2.2.1.3.2" xref="S2.E3.m1.2.2.2.1.3.2.cmml">c</mi><mi id="S2.E3.m1.2.2.2.1.3.3" xref="S2.E3.m1.2.2.2.1.3.3.cmml">z</mi></msub><mrow id="S2.E3.m1.2.2.2.1.1" xref="S2.E3.m1.2.2.2.1.1.cmml"><mi id="S2.E3.m1.2.2.2.1.1.3" xref="S2.E3.m1.2.2.2.1.1.3.cmml">m</mi><mo id="S2.E3.m1.2.2.2.1.1.2" xref="S2.E3.m1.2.2.2.1.1.2.cmml">â¢</mo><mi id="S2.E3.m1.2.2.2.1.1.4" xref="S2.E3.m1.2.2.2.1.1.4.cmml">a</mi><mo id="S2.E3.m1.2.2.2.1.1.2a" xref="S2.E3.m1.2.2.2.1.1.2.cmml">â¢</mo><mi id="S2.E3.m1.2.2.2.1.1.5" xref="S2.E3.m1.2.2.2.1.1.5.cmml">x</mi><mo id="S2.E3.m1.2.2.2.1.1.2b" xref="S2.E3.m1.2.2.2.1.1.2.cmml">â¢</mo><mrow id="S2.E3.m1.2.2.2.1.1.6.2" xref="S2.E3.m1.2.2.2.1.1.cmml"><mo id="S2.E3.m1.2.2.2.1.1.6.2.1" stretchy="false" xref="S2.E3.m1.2.2.2.1.1.cmml">(</mo><mi id="S2.E3.m1.2.2.2.1.1.1" xref="S2.E3.m1.2.2.2.1.1.1.cmml">C</mi><mo id="S2.E3.m1.2.2.2.1.1.6.2.2" stretchy="false" xref="S2.E3.m1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac></mrow><mo id="S2.E3.m1.4.4.1.2" lspace="0em" xref="S2.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.4b"><apply id="S2.E3.m1.4.4.1.1.cmml" xref="S2.E3.m1.4.4.1"><and id="S2.E3.m1.4.4.1.1a.cmml" xref="S2.E3.m1.4.4.1"></and><apply id="S2.E3.m1.4.4.1.1b.cmml" xref="S2.E3.m1.4.4.1"><eq id="S2.E3.m1.4.4.1.1.3.cmml" xref="S2.E3.m1.4.4.1.1.3"></eq><apply id="S2.E3.m1.4.4.1.1.2.cmml" xref="S2.E3.m1.4.4.1.1.2"><times id="S2.E3.m1.4.4.1.1.2.1.cmml" xref="S2.E3.m1.4.4.1.1.2.1"></times><apply id="S2.E3.m1.4.4.1.1.2.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.2.2.1.cmml" xref="S2.E3.m1.4.4.1.1.2.2">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.2.2.2.cmml" xref="S2.E3.m1.4.4.1.1.2.2.2">ğ‘</ci><ci id="S2.E3.m1.4.4.1.1.2.2.3.cmml" xref="S2.E3.m1.4.4.1.1.2.2.3">ğ‘ƒ</ci></apply><ci id="S2.E3.m1.3.3.cmml" xref="S2.E3.m1.3.3">ğ‘—</ci></apply><apply id="S2.E3.m1.4.4.1.1.4.cmml" xref="S2.E3.m1.4.4.1.1.4"><divide id="S2.E3.m1.4.4.1.1.4.1.cmml" xref="S2.E3.m1.4.4.1.1.4"></divide><apply id="S2.E3.m1.4.4.1.1.4.2.cmml" xref="S2.E3.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.4.2.1.cmml" xref="S2.E3.m1.4.4.1.1.4.2">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.4.2.2.cmml" xref="S2.E3.m1.4.4.1.1.4.2.2">ğ‘</ci><ci id="S2.E3.m1.4.4.1.1.4.2.3.cmml" xref="S2.E3.m1.4.4.1.1.4.2.3">ğ‘—</ci></apply><apply id="S2.E3.m1.4.4.1.1.4.3.cmml" xref="S2.E3.m1.4.4.1.1.4.3"><apply id="S2.E3.m1.4.4.1.1.4.3.1.cmml" xref="S2.E3.m1.4.4.1.1.4.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.4.3.1.1.cmml" xref="S2.E3.m1.4.4.1.1.4.3.1">superscript</csymbol><apply id="S2.E3.m1.4.4.1.1.4.3.1.2.cmml" xref="S2.E3.m1.4.4.1.1.4.3.1"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.4.3.1.2.1.cmml" xref="S2.E3.m1.4.4.1.1.4.3.1">subscript</csymbol><sum id="S2.E3.m1.4.4.1.1.4.3.1.2.2.cmml" xref="S2.E3.m1.4.4.1.1.4.3.1.2.2"></sum><apply id="S2.E3.m1.4.4.1.1.4.3.1.2.3.cmml" xref="S2.E3.m1.4.4.1.1.4.3.1.2.3"><eq id="S2.E3.m1.4.4.1.1.4.3.1.2.3.1.cmml" xref="S2.E3.m1.4.4.1.1.4.3.1.2.3.1"></eq><ci id="S2.E3.m1.4.4.1.1.4.3.1.2.3.2.cmml" xref="S2.E3.m1.4.4.1.1.4.3.1.2.3.2">ğ‘§</ci><cn id="S2.E3.m1.4.4.1.1.4.3.1.2.3.3.cmml" type="integer" xref="S2.E3.m1.4.4.1.1.4.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.4.4.1.1.4.3.1.3.cmml" xref="S2.E3.m1.4.4.1.1.4.3.1.3">ğ‘</ci></apply><apply id="S2.E3.m1.4.4.1.1.4.3.2.cmml" xref="S2.E3.m1.4.4.1.1.4.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.4.4.1.1.4.3.2.1.cmml" xref="S2.E3.m1.4.4.1.1.4.3.2">subscript</csymbol><ci id="S2.E3.m1.4.4.1.1.4.3.2.2.cmml" xref="S2.E3.m1.4.4.1.1.4.3.2.2">ğ‘</ci><ci id="S2.E3.m1.4.4.1.1.4.3.2.3.cmml" xref="S2.E3.m1.4.4.1.1.4.3.2.3">ğ‘§</ci></apply></apply></apply></apply><apply id="S2.E3.m1.4.4.1.1c.cmml" xref="S2.E3.m1.4.4.1"><eq id="S2.E3.m1.4.4.1.1.5.cmml" xref="S2.E3.m1.4.4.1.1.5"></eq><share href="https://arxiv.org/html/2409.04329v1#S2.E3.m1.4.4.1.1.4.cmml" id="S2.E3.m1.4.4.1.1d.cmml" xref="S2.E3.m1.4.4.1"></share><apply id="S2.E3.m1.2.2.cmml" xref="S2.E3.m1.2.2"><divide id="S2.E3.m1.2.2.3.cmml" xref="S2.E3.m1.2.2"></divide><apply id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><divide id="S2.E3.m1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1"></divide><apply id="S2.E3.m1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.3.2">ğ‘</ci><ci id="S2.E3.m1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.3.3">ğ‘—</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2"></times><ci id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3">ğ‘š</ci><ci id="S2.E3.m1.1.1.1.1.1.4.cmml" xref="S2.E3.m1.1.1.1.1.1.4">ğ‘</ci><ci id="S2.E3.m1.1.1.1.1.1.5.cmml" xref="S2.E3.m1.1.1.1.1.1.5">ğ‘¥</ci><ci id="S2.E3.m1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1">ğ¶</ci></apply></apply><apply id="S2.E3.m1.2.2.2.cmml" xref="S2.E3.m1.2.2.2"><apply id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2">superscript</csymbol><apply id="S2.E3.m1.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.2">subscript</csymbol><sum id="S2.E3.m1.2.2.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2.2.2"></sum><apply id="S2.E3.m1.2.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.2.3"><eq id="S2.E3.m1.2.2.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.2.2.2.3.1"></eq><ci id="S2.E3.m1.2.2.2.2.2.3.2.cmml" xref="S2.E3.m1.2.2.2.2.2.3.2">ğ‘§</ci><cn id="S2.E3.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S2.E3.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E3.m1.2.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.2.3">ğ‘</ci></apply><apply id="S2.E3.m1.2.2.2.1.cmml" xref="S2.E3.m1.2.2.2.1"><divide id="S2.E3.m1.2.2.2.1.2.cmml" xref="S2.E3.m1.2.2.2.1"></divide><apply id="S2.E3.m1.2.2.2.1.3.cmml" xref="S2.E3.m1.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.2.1.3.1.cmml" xref="S2.E3.m1.2.2.2.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.2.1.3.2.cmml" xref="S2.E3.m1.2.2.2.1.3.2">ğ‘</ci><ci id="S2.E3.m1.2.2.2.1.3.3.cmml" xref="S2.E3.m1.2.2.2.1.3.3">ğ‘§</ci></apply><apply id="S2.E3.m1.2.2.2.1.1.cmml" xref="S2.E3.m1.2.2.2.1.1"><times id="S2.E3.m1.2.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.2.1.1.2"></times><ci id="S2.E3.m1.2.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.2.1.1.3">ğ‘š</ci><ci id="S2.E3.m1.2.2.2.1.1.4.cmml" xref="S2.E3.m1.2.2.2.1.1.4">ğ‘</ci><ci id="S2.E3.m1.2.2.2.1.1.5.cmml" xref="S2.E3.m1.2.2.2.1.1.5">ğ‘¥</ci><ci id="S2.E3.m1.2.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.2.1.1.1">ğ¶</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.4c">p_{P}(j)=\frac{c_{j}}{\sum_{z=1}^{N}c_{z}}=\frac{\frac{c_{j}}{max(C)}}{\sum_{z%
=1}^{N}\frac{c_{z}}{max(C)}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.4d">italic_p start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) = divide start_ARG italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_c start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_ARG = divide start_ARG divide start_ARG italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_ARG start_ARG italic_m italic_a italic_x ( italic_C ) end_ARG end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG italic_c start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_ARG start_ARG italic_m italic_a italic_x ( italic_C ) end_ARG end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.4">We further smooth <math alttext="p_{P}(j)" class="ltx_Math" display="inline" id="S2.p5.1.m1.1"><semantics id="S2.p5.1.m1.1a"><mrow id="S2.p5.1.m1.1.2" xref="S2.p5.1.m1.1.2.cmml"><msub id="S2.p5.1.m1.1.2.2" xref="S2.p5.1.m1.1.2.2.cmml"><mi id="S2.p5.1.m1.1.2.2.2" xref="S2.p5.1.m1.1.2.2.2.cmml">p</mi><mi id="S2.p5.1.m1.1.2.2.3" xref="S2.p5.1.m1.1.2.2.3.cmml">P</mi></msub><mo id="S2.p5.1.m1.1.2.1" xref="S2.p5.1.m1.1.2.1.cmml">â¢</mo><mrow id="S2.p5.1.m1.1.2.3.2" xref="S2.p5.1.m1.1.2.cmml"><mo id="S2.p5.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p5.1.m1.1.2.cmml">(</mo><mi id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml">j</mi><mo id="S2.p5.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p5.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><apply id="S2.p5.1.m1.1.2.cmml" xref="S2.p5.1.m1.1.2"><times id="S2.p5.1.m1.1.2.1.cmml" xref="S2.p5.1.m1.1.2.1"></times><apply id="S2.p5.1.m1.1.2.2.cmml" xref="S2.p5.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.p5.1.m1.1.2.2.1.cmml" xref="S2.p5.1.m1.1.2.2">subscript</csymbol><ci id="S2.p5.1.m1.1.2.2.2.cmml" xref="S2.p5.1.m1.1.2.2.2">ğ‘</ci><ci id="S2.p5.1.m1.1.2.2.3.cmml" xref="S2.p5.1.m1.1.2.2.3">ğ‘ƒ</ci></apply><ci id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">p_{P}(j)</annotation><annotation encoding="application/x-llamapun" id="S2.p5.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j )</annotation></semantics></math> using an <math alttext="\epsilon&gt;0" class="ltx_Math" display="inline" id="S2.p5.2.m2.1"><semantics id="S2.p5.2.m2.1a"><mrow id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml"><mi id="S2.p5.2.m2.1.1.2" xref="S2.p5.2.m2.1.1.2.cmml">Ïµ</mi><mo id="S2.p5.2.m2.1.1.1" xref="S2.p5.2.m2.1.1.1.cmml">&gt;</mo><mn id="S2.p5.2.m2.1.1.3" xref="S2.p5.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.1b"><apply id="S2.p5.2.m2.1.1.cmml" xref="S2.p5.2.m2.1.1"><gt id="S2.p5.2.m2.1.1.1.cmml" xref="S2.p5.2.m2.1.1.1"></gt><ci id="S2.p5.2.m2.1.1.2.cmml" xref="S2.p5.2.m2.1.1.2">italic-Ïµ</ci><cn id="S2.p5.2.m2.1.1.3.cmml" type="integer" xref="S2.p5.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.1c">\epsilon&gt;0</annotation><annotation encoding="application/x-llamapun" id="S2.p5.2.m2.1d">italic_Ïµ &gt; 0</annotation></semantics></math> value, which can be tuned in order to control the contribution of the personalized popularity on the score of each item, once the modelâ€™s score and the personalized popularity are combined. In our experiments <math alttext="\epsilon" class="ltx_Math" display="inline" id="S2.p5.3.m3.1"><semantics id="S2.p5.3.m3.1a"><mi id="S2.p5.3.m3.1.1" xref="S2.p5.3.m3.1.1.cmml">Ïµ</mi><annotation-xml encoding="MathML-Content" id="S2.p5.3.m3.1b"><ci id="S2.p5.3.m3.1.1.cmml" xref="S2.p5.3.m3.1.1">italic-Ïµ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.3.m3.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S2.p5.3.m3.1d">italic_Ïµ</annotation></semantics></math> is set to 0.01. By smoothing, the personalized popularity probability of item <math alttext="j" class="ltx_Math" display="inline" id="S2.p5.4.m4.1"><semantics id="S2.p5.4.m4.1a"><mi id="S2.p5.4.m4.1.1" xref="S2.p5.4.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p5.4.m4.1b"><ci id="S2.p5.4.m4.1.1.cmml" xref="S2.p5.4.m4.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.4.m4.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p5.4.m4.1d">italic_j</annotation></semantics></math> becomes:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{p}_{P}(j)=\frac{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}{\sum_{z=1}^{N}%
\frac{c_{z}+\epsilon}{max(C+\epsilon)}}." class="ltx_Math" display="block" id="S2.E4.m1.4"><semantics id="S2.E4.m1.4a"><mrow id="S2.E4.m1.4.4.1" xref="S2.E4.m1.4.4.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1" xref="S2.E4.m1.4.4.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1.2" xref="S2.E4.m1.4.4.1.1.2.cmml"><msub id="S2.E4.m1.4.4.1.1.2.2" xref="S2.E4.m1.4.4.1.1.2.2.cmml"><mover accent="true" id="S2.E4.m1.4.4.1.1.2.2.2" xref="S2.E4.m1.4.4.1.1.2.2.2.cmml"><mi id="S2.E4.m1.4.4.1.1.2.2.2.2" xref="S2.E4.m1.4.4.1.1.2.2.2.2.cmml">p</mi><mo id="S2.E4.m1.4.4.1.1.2.2.2.1" xref="S2.E4.m1.4.4.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.E4.m1.4.4.1.1.2.2.3" xref="S2.E4.m1.4.4.1.1.2.2.3.cmml">P</mi></msub><mo id="S2.E4.m1.4.4.1.1.2.1" xref="S2.E4.m1.4.4.1.1.2.1.cmml">â¢</mo><mrow id="S2.E4.m1.4.4.1.1.2.3.2" xref="S2.E4.m1.4.4.1.1.2.cmml"><mo id="S2.E4.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="S2.E4.m1.4.4.1.1.2.cmml">(</mo><mi id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml">j</mi><mo id="S2.E4.m1.4.4.1.1.2.3.2.2" stretchy="false" xref="S2.E4.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.4.4.1.1.1" xref="S2.E4.m1.4.4.1.1.1.cmml">=</mo><mfrac id="S2.E4.m1.2.2" xref="S2.E4.m1.2.2.cmml"><mfrac id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.3" xref="S2.E4.m1.1.1.1.3.cmml"><msub id="S2.E4.m1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.3.2.cmml"><mi id="S2.E4.m1.1.1.1.3.2.2" xref="S2.E4.m1.1.1.1.3.2.2.cmml">c</mi><mi id="S2.E4.m1.1.1.1.3.2.3" xref="S2.E4.m1.1.1.1.3.2.3.cmml">j</mi></msub><mo id="S2.E4.m1.1.1.1.3.1" xref="S2.E4.m1.1.1.1.3.1.cmml">+</mo><mi id="S2.E4.m1.1.1.1.3.3" xref="S2.E4.m1.1.1.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.3.cmml">m</mi><mo id="S2.E4.m1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E4.m1.1.1.1.1.1.4" xref="S2.E4.m1.1.1.1.1.1.4.cmml">a</mi><mo id="S2.E4.m1.1.1.1.1.1.2a" xref="S2.E4.m1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E4.m1.1.1.1.1.1.5" xref="S2.E4.m1.1.1.1.1.1.5.cmml">x</mi><mo id="S2.E4.m1.1.1.1.1.1.2b" xref="S2.E4.m1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mrow id="S2.E4.m1.2.2.2" xref="S2.E4.m1.2.2.2.cmml"><msubsup id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml"><mo id="S2.E4.m1.2.2.2.2.2.2" xref="S2.E4.m1.2.2.2.2.2.2.cmml">âˆ‘</mo><mrow id="S2.E4.m1.2.2.2.2.2.3" xref="S2.E4.m1.2.2.2.2.2.3.cmml"><mi id="S2.E4.m1.2.2.2.2.2.3.2" xref="S2.E4.m1.2.2.2.2.2.3.2.cmml">z</mi><mo id="S2.E4.m1.2.2.2.2.2.3.1" xref="S2.E4.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S2.E4.m1.2.2.2.2.2.3.3" xref="S2.E4.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E4.m1.2.2.2.2.3" xref="S2.E4.m1.2.2.2.2.3.cmml">N</mi></msubsup><mfrac id="S2.E4.m1.2.2.2.1" xref="S2.E4.m1.2.2.2.1.cmml"><mrow id="S2.E4.m1.2.2.2.1.3" xref="S2.E4.m1.2.2.2.1.3.cmml"><msub id="S2.E4.m1.2.2.2.1.3.2" xref="S2.E4.m1.2.2.2.1.3.2.cmml"><mi id="S2.E4.m1.2.2.2.1.3.2.2" xref="S2.E4.m1.2.2.2.1.3.2.2.cmml">c</mi><mi id="S2.E4.m1.2.2.2.1.3.2.3" xref="S2.E4.m1.2.2.2.1.3.2.3.cmml">z</mi></msub><mo id="S2.E4.m1.2.2.2.1.3.1" xref="S2.E4.m1.2.2.2.1.3.1.cmml">+</mo><mi id="S2.E4.m1.2.2.2.1.3.3" xref="S2.E4.m1.2.2.2.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E4.m1.2.2.2.1.1" xref="S2.E4.m1.2.2.2.1.1.cmml"><mi id="S2.E4.m1.2.2.2.1.1.3" xref="S2.E4.m1.2.2.2.1.1.3.cmml">m</mi><mo id="S2.E4.m1.2.2.2.1.1.2" xref="S2.E4.m1.2.2.2.1.1.2.cmml">â¢</mo><mi id="S2.E4.m1.2.2.2.1.1.4" xref="S2.E4.m1.2.2.2.1.1.4.cmml">a</mi><mo id="S2.E4.m1.2.2.2.1.1.2a" xref="S2.E4.m1.2.2.2.1.1.2.cmml">â¢</mo><mi id="S2.E4.m1.2.2.2.1.1.5" xref="S2.E4.m1.2.2.2.1.1.5.cmml">x</mi><mo id="S2.E4.m1.2.2.2.1.1.2b" xref="S2.E4.m1.2.2.2.1.1.2.cmml">â¢</mo><mrow id="S2.E4.m1.2.2.2.1.1.1.1" xref="S2.E4.m1.2.2.2.1.1.1.1.1.cmml"><mo id="S2.E4.m1.2.2.2.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.2.2.2.1.1.1.1.1" xref="S2.E4.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S2.E4.m1.2.2.2.1.1.1.1.1.2" xref="S2.E4.m1.2.2.2.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E4.m1.2.2.2.1.1.1.1.1.1" xref="S2.E4.m1.2.2.2.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E4.m1.2.2.2.1.1.1.1.1.3" xref="S2.E4.m1.2.2.2.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E4.m1.2.2.2.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac></mrow><mo id="S2.E4.m1.4.4.1.2" lspace="0em" xref="S2.E4.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.4b"><apply id="S2.E4.m1.4.4.1.1.cmml" xref="S2.E4.m1.4.4.1"><eq id="S2.E4.m1.4.4.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1"></eq><apply id="S2.E4.m1.4.4.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.2"><times id="S2.E4.m1.4.4.1.1.2.1.cmml" xref="S2.E4.m1.4.4.1.1.2.1"></times><apply id="S2.E4.m1.4.4.1.1.2.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.2.2.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2">subscript</csymbol><apply id="S2.E4.m1.4.4.1.1.2.2.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2.2"><ci id="S2.E4.m1.4.4.1.1.2.2.2.1.cmml" xref="S2.E4.m1.4.4.1.1.2.2.2.1">^</ci><ci id="S2.E4.m1.4.4.1.1.2.2.2.2.cmml" xref="S2.E4.m1.4.4.1.1.2.2.2.2">ğ‘</ci></apply><ci id="S2.E4.m1.4.4.1.1.2.2.3.cmml" xref="S2.E4.m1.4.4.1.1.2.2.3">ğ‘ƒ</ci></apply><ci id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3">ğ‘—</ci></apply><apply id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2"><divide id="S2.E4.m1.2.2.3.cmml" xref="S2.E4.m1.2.2"></divide><apply id="S2.E4.m1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><divide id="S2.E4.m1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1"></divide><apply id="S2.E4.m1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.3"><plus id="S2.E4.m1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.3.1"></plus><apply id="S2.E4.m1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.3.2.1.cmml" xref="S2.E4.m1.1.1.1.3.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.3.2.2.cmml" xref="S2.E4.m1.1.1.1.3.2.2">ğ‘</ci><ci id="S2.E4.m1.1.1.1.3.2.3.cmml" xref="S2.E4.m1.1.1.1.3.2.3">ğ‘—</ci></apply><ci id="S2.E4.m1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.2"></times><ci id="S2.E4.m1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3">ğ‘š</ci><ci id="S2.E4.m1.1.1.1.1.1.4.cmml" xref="S2.E4.m1.1.1.1.1.1.4">ğ‘</ci><ci id="S2.E4.m1.1.1.1.1.1.5.cmml" xref="S2.E4.m1.1.1.1.1.1.5">ğ‘¥</ci><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1"><plus id="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply><apply id="S2.E4.m1.2.2.2.cmml" xref="S2.E4.m1.2.2.2"><apply id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.1.cmml" xref="S2.E4.m1.2.2.2.2">superscript</csymbol><apply id="S2.E4.m1.2.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.2.1.cmml" xref="S2.E4.m1.2.2.2.2">subscript</csymbol><sum id="S2.E4.m1.2.2.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2.2.2"></sum><apply id="S2.E4.m1.2.2.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.2.2.3"><eq id="S2.E4.m1.2.2.2.2.2.3.1.cmml" xref="S2.E4.m1.2.2.2.2.2.3.1"></eq><ci id="S2.E4.m1.2.2.2.2.2.3.2.cmml" xref="S2.E4.m1.2.2.2.2.2.3.2">ğ‘§</ci><cn id="S2.E4.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S2.E4.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E4.m1.2.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.2.3">ğ‘</ci></apply><apply id="S2.E4.m1.2.2.2.1.cmml" xref="S2.E4.m1.2.2.2.1"><divide id="S2.E4.m1.2.2.2.1.2.cmml" xref="S2.E4.m1.2.2.2.1"></divide><apply id="S2.E4.m1.2.2.2.1.3.cmml" xref="S2.E4.m1.2.2.2.1.3"><plus id="S2.E4.m1.2.2.2.1.3.1.cmml" xref="S2.E4.m1.2.2.2.1.3.1"></plus><apply id="S2.E4.m1.2.2.2.1.3.2.cmml" xref="S2.E4.m1.2.2.2.1.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.1.3.2.1.cmml" xref="S2.E4.m1.2.2.2.1.3.2">subscript</csymbol><ci id="S2.E4.m1.2.2.2.1.3.2.2.cmml" xref="S2.E4.m1.2.2.2.1.3.2.2">ğ‘</ci><ci id="S2.E4.m1.2.2.2.1.3.2.3.cmml" xref="S2.E4.m1.2.2.2.1.3.2.3">ğ‘§</ci></apply><ci id="S2.E4.m1.2.2.2.1.3.3.cmml" xref="S2.E4.m1.2.2.2.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E4.m1.2.2.2.1.1.cmml" xref="S2.E4.m1.2.2.2.1.1"><times id="S2.E4.m1.2.2.2.1.1.2.cmml" xref="S2.E4.m1.2.2.2.1.1.2"></times><ci id="S2.E4.m1.2.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.2.1.1.3">ğ‘š</ci><ci id="S2.E4.m1.2.2.2.1.1.4.cmml" xref="S2.E4.m1.2.2.2.1.1.4">ğ‘</ci><ci id="S2.E4.m1.2.2.2.1.1.5.cmml" xref="S2.E4.m1.2.2.2.1.1.5">ğ‘¥</ci><apply id="S2.E4.m1.2.2.2.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.2.1.1.1.1"><plus id="S2.E4.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.2.1.1.1.1.1.1"></plus><ci id="S2.E4.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.2.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E4.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.2.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.4c">\hat{p}_{P}(j)=\frac{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}{\sum_{z=1}^{N}%
\frac{c_{z}+\epsilon}{max(C+\epsilon)}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.4d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) = divide start_ARG divide start_ARG italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG italic_c start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p5.11">The lower is <math alttext="\epsilon" class="ltx_Math" display="inline" id="S2.p5.5.m1.1"><semantics id="S2.p5.5.m1.1a"><mi id="S2.p5.5.m1.1.1" xref="S2.p5.5.m1.1.1.cmml">Ïµ</mi><annotation-xml encoding="MathML-Content" id="S2.p5.5.m1.1b"><ci id="S2.p5.5.m1.1.1.cmml" xref="S2.p5.5.m1.1.1">italic-Ïµ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.5.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S2.p5.5.m1.1d">italic_Ïµ</annotation></semantics></math>, the higher the contribution of personalized popularity on the overall itemsâ€™ score. As <math alttext="\epsilon\rightarrow 0" class="ltx_Math" display="inline" id="S2.p5.6.m2.1"><semantics id="S2.p5.6.m2.1a"><mrow id="S2.p5.6.m2.1.1" xref="S2.p5.6.m2.1.1.cmml"><mi id="S2.p5.6.m2.1.1.2" xref="S2.p5.6.m2.1.1.2.cmml">Ïµ</mi><mo id="S2.p5.6.m2.1.1.1" stretchy="false" xref="S2.p5.6.m2.1.1.1.cmml">â†’</mo><mn id="S2.p5.6.m2.1.1.3" xref="S2.p5.6.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.6.m2.1b"><apply id="S2.p5.6.m2.1.1.cmml" xref="S2.p5.6.m2.1.1"><ci id="S2.p5.6.m2.1.1.1.cmml" xref="S2.p5.6.m2.1.1.1">â†’</ci><ci id="S2.p5.6.m2.1.1.2.cmml" xref="S2.p5.6.m2.1.1.2">italic-Ïµ</ci><cn id="S2.p5.6.m2.1.1.3.cmml" type="integer" xref="S2.p5.6.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.6.m2.1c">\epsilon\rightarrow 0</annotation><annotation encoding="application/x-llamapun" id="S2.p5.6.m2.1d">italic_Ïµ â†’ 0</annotation></semantics></math>Â the probability of item <math alttext="j" class="ltx_Math" display="inline" id="S2.p5.7.m3.1"><semantics id="S2.p5.7.m3.1a"><mi id="S2.p5.7.m3.1.1" xref="S2.p5.7.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p5.7.m3.1b"><ci id="S2.p5.7.m3.1.1.cmml" xref="S2.p5.7.m3.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.7.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p5.7.m3.1d">italic_j</annotation></semantics></math> corresponds to the unsmoothed personalized popularity probability <math alttext="p_{P}(j)" class="ltx_Math" display="inline" id="S2.p5.8.m4.1"><semantics id="S2.p5.8.m4.1a"><mrow id="S2.p5.8.m4.1.2" xref="S2.p5.8.m4.1.2.cmml"><msub id="S2.p5.8.m4.1.2.2" xref="S2.p5.8.m4.1.2.2.cmml"><mi id="S2.p5.8.m4.1.2.2.2" xref="S2.p5.8.m4.1.2.2.2.cmml">p</mi><mi id="S2.p5.8.m4.1.2.2.3" xref="S2.p5.8.m4.1.2.2.3.cmml">P</mi></msub><mo id="S2.p5.8.m4.1.2.1" xref="S2.p5.8.m4.1.2.1.cmml">â¢</mo><mrow id="S2.p5.8.m4.1.2.3.2" xref="S2.p5.8.m4.1.2.cmml"><mo id="S2.p5.8.m4.1.2.3.2.1" stretchy="false" xref="S2.p5.8.m4.1.2.cmml">(</mo><mi id="S2.p5.8.m4.1.1" xref="S2.p5.8.m4.1.1.cmml">j</mi><mo id="S2.p5.8.m4.1.2.3.2.2" stretchy="false" xref="S2.p5.8.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.8.m4.1b"><apply id="S2.p5.8.m4.1.2.cmml" xref="S2.p5.8.m4.1.2"><times id="S2.p5.8.m4.1.2.1.cmml" xref="S2.p5.8.m4.1.2.1"></times><apply id="S2.p5.8.m4.1.2.2.cmml" xref="S2.p5.8.m4.1.2.2"><csymbol cd="ambiguous" id="S2.p5.8.m4.1.2.2.1.cmml" xref="S2.p5.8.m4.1.2.2">subscript</csymbol><ci id="S2.p5.8.m4.1.2.2.2.cmml" xref="S2.p5.8.m4.1.2.2.2">ğ‘</ci><ci id="S2.p5.8.m4.1.2.2.3.cmml" xref="S2.p5.8.m4.1.2.2.3">ğ‘ƒ</ci></apply><ci id="S2.p5.8.m4.1.1.cmml" xref="S2.p5.8.m4.1.1">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.8.m4.1c">p_{P}(j)</annotation><annotation encoding="application/x-llamapun" id="S2.p5.8.m4.1d">italic_p start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j )</annotation></semantics></math> in Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E3" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">3</span></a>). As <math alttext="\epsilon\rightarrow+\infty" class="ltx_Math" display="inline" id="S2.p5.9.m5.1"><semantics id="S2.p5.9.m5.1a"><mrow id="S2.p5.9.m5.1.1" xref="S2.p5.9.m5.1.1.cmml"><mi id="S2.p5.9.m5.1.1.2" xref="S2.p5.9.m5.1.1.2.cmml">Ïµ</mi><mo id="S2.p5.9.m5.1.1.1" stretchy="false" xref="S2.p5.9.m5.1.1.1.cmml">â†’</mo><mrow id="S2.p5.9.m5.1.1.3" xref="S2.p5.9.m5.1.1.3.cmml"><mo id="S2.p5.9.m5.1.1.3a" xref="S2.p5.9.m5.1.1.3.cmml">+</mo><mi id="S2.p5.9.m5.1.1.3.2" mathvariant="normal" xref="S2.p5.9.m5.1.1.3.2.cmml">âˆ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.9.m5.1b"><apply id="S2.p5.9.m5.1.1.cmml" xref="S2.p5.9.m5.1.1"><ci id="S2.p5.9.m5.1.1.1.cmml" xref="S2.p5.9.m5.1.1.1">â†’</ci><ci id="S2.p5.9.m5.1.1.2.cmml" xref="S2.p5.9.m5.1.1.2">italic-Ïµ</ci><apply id="S2.p5.9.m5.1.1.3.cmml" xref="S2.p5.9.m5.1.1.3"><plus id="S2.p5.9.m5.1.1.3.1.cmml" xref="S2.p5.9.m5.1.1.3"></plus><infinity id="S2.p5.9.m5.1.1.3.2.cmml" xref="S2.p5.9.m5.1.1.3.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.9.m5.1c">\epsilon\rightarrow+\infty</annotation><annotation encoding="application/x-llamapun" id="S2.p5.9.m5.1d">italic_Ïµ â†’ + âˆ</annotation></semantics></math>, personalized popularity item probabilities have the same value, for all items in the catalogue. As a consequence, with <math alttext="\epsilon\rightarrow+\infty" class="ltx_Math" display="inline" id="S2.p5.10.m6.1"><semantics id="S2.p5.10.m6.1a"><mrow id="S2.p5.10.m6.1.1" xref="S2.p5.10.m6.1.1.cmml"><mi id="S2.p5.10.m6.1.1.2" xref="S2.p5.10.m6.1.1.2.cmml">Ïµ</mi><mo id="S2.p5.10.m6.1.1.1" stretchy="false" xref="S2.p5.10.m6.1.1.1.cmml">â†’</mo><mrow id="S2.p5.10.m6.1.1.3" xref="S2.p5.10.m6.1.1.3.cmml"><mo id="S2.p5.10.m6.1.1.3a" xref="S2.p5.10.m6.1.1.3.cmml">+</mo><mi id="S2.p5.10.m6.1.1.3.2" mathvariant="normal" xref="S2.p5.10.m6.1.1.3.2.cmml">âˆ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.10.m6.1b"><apply id="S2.p5.10.m6.1.1.cmml" xref="S2.p5.10.m6.1.1"><ci id="S2.p5.10.m6.1.1.1.cmml" xref="S2.p5.10.m6.1.1.1">â†’</ci><ci id="S2.p5.10.m6.1.1.2.cmml" xref="S2.p5.10.m6.1.1.2">italic-Ïµ</ci><apply id="S2.p5.10.m6.1.1.3.cmml" xref="S2.p5.10.m6.1.1.3"><plus id="S2.p5.10.m6.1.1.3.1.cmml" xref="S2.p5.10.m6.1.1.3"></plus><infinity id="S2.p5.10.m6.1.1.3.2.cmml" xref="S2.p5.10.m6.1.1.3.2"></infinity></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.10.m6.1c">\epsilon\rightarrow+\infty</annotation><annotation encoding="application/x-llamapun" id="S2.p5.10.m6.1d">italic_Ïµ â†’ + âˆ</annotation></semantics></math> the personalized popularity will have less influence on the item ranking. Combination of <math alttext="\hat{p}_{P}(j)" class="ltx_Math" display="inline" id="S2.p5.11.m7.1"><semantics id="S2.p5.11.m7.1a"><mrow id="S2.p5.11.m7.1.2" xref="S2.p5.11.m7.1.2.cmml"><msub id="S2.p5.11.m7.1.2.2" xref="S2.p5.11.m7.1.2.2.cmml"><mover accent="true" id="S2.p5.11.m7.1.2.2.2" xref="S2.p5.11.m7.1.2.2.2.cmml"><mi id="S2.p5.11.m7.1.2.2.2.2" xref="S2.p5.11.m7.1.2.2.2.2.cmml">p</mi><mo id="S2.p5.11.m7.1.2.2.2.1" xref="S2.p5.11.m7.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.p5.11.m7.1.2.2.3" xref="S2.p5.11.m7.1.2.2.3.cmml">P</mi></msub><mo id="S2.p5.11.m7.1.2.1" xref="S2.p5.11.m7.1.2.1.cmml">â¢</mo><mrow id="S2.p5.11.m7.1.2.3.2" xref="S2.p5.11.m7.1.2.cmml"><mo id="S2.p5.11.m7.1.2.3.2.1" stretchy="false" xref="S2.p5.11.m7.1.2.cmml">(</mo><mi id="S2.p5.11.m7.1.1" xref="S2.p5.11.m7.1.1.cmml">j</mi><mo id="S2.p5.11.m7.1.2.3.2.2" stretchy="false" xref="S2.p5.11.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.11.m7.1b"><apply id="S2.p5.11.m7.1.2.cmml" xref="S2.p5.11.m7.1.2"><times id="S2.p5.11.m7.1.2.1.cmml" xref="S2.p5.11.m7.1.2.1"></times><apply id="S2.p5.11.m7.1.2.2.cmml" xref="S2.p5.11.m7.1.2.2"><csymbol cd="ambiguous" id="S2.p5.11.m7.1.2.2.1.cmml" xref="S2.p5.11.m7.1.2.2">subscript</csymbol><apply id="S2.p5.11.m7.1.2.2.2.cmml" xref="S2.p5.11.m7.1.2.2.2"><ci id="S2.p5.11.m7.1.2.2.2.1.cmml" xref="S2.p5.11.m7.1.2.2.2.1">^</ci><ci id="S2.p5.11.m7.1.2.2.2.2.cmml" xref="S2.p5.11.m7.1.2.2.2.2">ğ‘</ci></apply><ci id="S2.p5.11.m7.1.2.2.3.cmml" xref="S2.p5.11.m7.1.2.2.3">ğ‘ƒ</ci></apply><ci id="S2.p5.11.m7.1.1.cmml" xref="S2.p5.11.m7.1.1">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.11.m7.1c">\hat{p}_{P}(j)</annotation><annotation encoding="application/x-llamapun" id="S2.p5.11.m7.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j )</annotation></semantics></math> with model outputs depends on the activation function used by the modelâ€™s loss function (sigmoid or softmax), as we explain next.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p6">
<p class="ltx_p" id="S2.p6.5"><span class="ltx_text ltx_font_bold" id="S2.p6.5.1">Using Personalized Popularity in a Softmax.</span>
In BERT4Rec, the probability of an item is obtained using the softmax function (Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E1" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">1</span></a>)). Therefore, to combine <math alttext="\hat{p}_{P}(j)" class="ltx_Math" display="inline" id="S2.p6.1.m1.1"><semantics id="S2.p6.1.m1.1a"><mrow id="S2.p6.1.m1.1.2" xref="S2.p6.1.m1.1.2.cmml"><msub id="S2.p6.1.m1.1.2.2" xref="S2.p6.1.m1.1.2.2.cmml"><mover accent="true" id="S2.p6.1.m1.1.2.2.2" xref="S2.p6.1.m1.1.2.2.2.cmml"><mi id="S2.p6.1.m1.1.2.2.2.2" xref="S2.p6.1.m1.1.2.2.2.2.cmml">p</mi><mo id="S2.p6.1.m1.1.2.2.2.1" xref="S2.p6.1.m1.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.p6.1.m1.1.2.2.3" xref="S2.p6.1.m1.1.2.2.3.cmml">P</mi></msub><mo id="S2.p6.1.m1.1.2.1" xref="S2.p6.1.m1.1.2.1.cmml">â¢</mo><mrow id="S2.p6.1.m1.1.2.3.2" xref="S2.p6.1.m1.1.2.cmml"><mo id="S2.p6.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p6.1.m1.1.2.cmml">(</mo><mi id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml">j</mi><mo id="S2.p6.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><apply id="S2.p6.1.m1.1.2.cmml" xref="S2.p6.1.m1.1.2"><times id="S2.p6.1.m1.1.2.1.cmml" xref="S2.p6.1.m1.1.2.1"></times><apply id="S2.p6.1.m1.1.2.2.cmml" xref="S2.p6.1.m1.1.2.2"><csymbol cd="ambiguous" id="S2.p6.1.m1.1.2.2.1.cmml" xref="S2.p6.1.m1.1.2.2">subscript</csymbol><apply id="S2.p6.1.m1.1.2.2.2.cmml" xref="S2.p6.1.m1.1.2.2.2"><ci id="S2.p6.1.m1.1.2.2.2.1.cmml" xref="S2.p6.1.m1.1.2.2.2.1">^</ci><ci id="S2.p6.1.m1.1.2.2.2.2.cmml" xref="S2.p6.1.m1.1.2.2.2.2">ğ‘</ci></apply><ci id="S2.p6.1.m1.1.2.2.3.cmml" xref="S2.p6.1.m1.1.2.2.3">ğ‘ƒ</ci></apply><ci id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">\hat{p}_{P}(j)</annotation><annotation encoding="application/x-llamapun" id="S2.p6.1.m1.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j )</annotation></semantics></math> into the softmax, we need to transform the <math alttext="\hat{p}_{P}(j)" class="ltx_Math" display="inline" id="S2.p6.2.m2.1"><semantics id="S2.p6.2.m2.1a"><mrow id="S2.p6.2.m2.1.2" xref="S2.p6.2.m2.1.2.cmml"><msub id="S2.p6.2.m2.1.2.2" xref="S2.p6.2.m2.1.2.2.cmml"><mover accent="true" id="S2.p6.2.m2.1.2.2.2" xref="S2.p6.2.m2.1.2.2.2.cmml"><mi id="S2.p6.2.m2.1.2.2.2.2" xref="S2.p6.2.m2.1.2.2.2.2.cmml">p</mi><mo id="S2.p6.2.m2.1.2.2.2.1" xref="S2.p6.2.m2.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.p6.2.m2.1.2.2.3" xref="S2.p6.2.m2.1.2.2.3.cmml">P</mi></msub><mo id="S2.p6.2.m2.1.2.1" xref="S2.p6.2.m2.1.2.1.cmml">â¢</mo><mrow id="S2.p6.2.m2.1.2.3.2" xref="S2.p6.2.m2.1.2.cmml"><mo id="S2.p6.2.m2.1.2.3.2.1" stretchy="false" xref="S2.p6.2.m2.1.2.cmml">(</mo><mi id="S2.p6.2.m2.1.1" xref="S2.p6.2.m2.1.1.cmml">j</mi><mo id="S2.p6.2.m2.1.2.3.2.2" stretchy="false" xref="S2.p6.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.2.m2.1b"><apply id="S2.p6.2.m2.1.2.cmml" xref="S2.p6.2.m2.1.2"><times id="S2.p6.2.m2.1.2.1.cmml" xref="S2.p6.2.m2.1.2.1"></times><apply id="S2.p6.2.m2.1.2.2.cmml" xref="S2.p6.2.m2.1.2.2"><csymbol cd="ambiguous" id="S2.p6.2.m2.1.2.2.1.cmml" xref="S2.p6.2.m2.1.2.2">subscript</csymbol><apply id="S2.p6.2.m2.1.2.2.2.cmml" xref="S2.p6.2.m2.1.2.2.2"><ci id="S2.p6.2.m2.1.2.2.2.1.cmml" xref="S2.p6.2.m2.1.2.2.2.1">^</ci><ci id="S2.p6.2.m2.1.2.2.2.2.cmml" xref="S2.p6.2.m2.1.2.2.2.2">ğ‘</ci></apply><ci id="S2.p6.2.m2.1.2.2.3.cmml" xref="S2.p6.2.m2.1.2.2.3">ğ‘ƒ</ci></apply><ci id="S2.p6.2.m2.1.1.cmml" xref="S2.p6.2.m2.1.1">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m2.1c">\hat{p}_{P}(j)</annotation><annotation encoding="application/x-llamapun" id="S2.p6.2.m2.1d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j )</annotation></semantics></math> into a compatible score, which we denote <math alttext="y_{j}" class="ltx_Math" display="inline" id="S2.p6.3.m3.1"><semantics id="S2.p6.3.m3.1a"><msub id="S2.p6.3.m3.1.1" xref="S2.p6.3.m3.1.1.cmml"><mi id="S2.p6.3.m3.1.1.2" xref="S2.p6.3.m3.1.1.2.cmml">y</mi><mi id="S2.p6.3.m3.1.1.3" xref="S2.p6.3.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.3.m3.1b"><apply id="S2.p6.3.m3.1.1.cmml" xref="S2.p6.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p6.3.m3.1.1.1.cmml" xref="S2.p6.3.m3.1.1">subscript</csymbol><ci id="S2.p6.3.m3.1.1.2.cmml" xref="S2.p6.3.m3.1.1.2">ğ‘¦</ci><ci id="S2.p6.3.m3.1.1.3.cmml" xref="S2.p6.3.m3.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.3.m3.1c">y_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math>, that can be combined with the modelâ€™s score. By imposing an equivalence between Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E1" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">1</span></a>) and Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E4" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">4</span></a>), the personalized popularity score <math alttext="y_{j}" class="ltx_Math" display="inline" id="S2.p6.4.m4.1"><semantics id="S2.p6.4.m4.1a"><msub id="S2.p6.4.m4.1.1" xref="S2.p6.4.m4.1.1.cmml"><mi id="S2.p6.4.m4.1.1.2" xref="S2.p6.4.m4.1.1.2.cmml">y</mi><mi id="S2.p6.4.m4.1.1.3" xref="S2.p6.4.m4.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.4.m4.1b"><apply id="S2.p6.4.m4.1.1.cmml" xref="S2.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p6.4.m4.1.1.1.cmml" xref="S2.p6.4.m4.1.1">subscript</csymbol><ci id="S2.p6.4.m4.1.1.2.cmml" xref="S2.p6.4.m4.1.1.2">ğ‘¦</ci><ci id="S2.p6.4.m4.1.1.3.cmml" xref="S2.p6.4.m4.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.4.m4.1c">y_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> of an item <math alttext="j" class="ltx_Math" display="inline" id="S2.p6.5.m5.1"><semantics id="S2.p6.5.m5.1a"><mi id="S2.p6.5.m5.1.1" xref="S2.p6.5.m5.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p6.5.m5.1b"><ci id="S2.p6.5.m5.1.1.cmml" xref="S2.p6.5.m5.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.5.m5.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p6.5.m5.1d">italic_j</annotation></semantics></math> is the exponent value in Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E1" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">1</span></a>). Therefore, to inject the personalized popularity probability into the modelâ€™s scoring, we can combine Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E1" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">1</span></a>) and Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E4" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">4</span></a>) as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{p}_{P}(j)=\frac{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}{\sum_{z=1}^{N}%
\frac{c_{z}+\epsilon}{max(C+\epsilon)}}=\frac{e^{y_{j}}}{\sum_{z=1}^{N}e^{y_{z%
}}}." class="ltx_Math" display="block" id="S2.E5.m1.4"><semantics id="S2.E5.m1.4a"><mrow id="S2.E5.m1.4.4.1" xref="S2.E5.m1.4.4.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1" xref="S2.E5.m1.4.4.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1.2" xref="S2.E5.m1.4.4.1.1.2.cmml"><msub id="S2.E5.m1.4.4.1.1.2.2" xref="S2.E5.m1.4.4.1.1.2.2.cmml"><mover accent="true" id="S2.E5.m1.4.4.1.1.2.2.2" xref="S2.E5.m1.4.4.1.1.2.2.2.cmml"><mi id="S2.E5.m1.4.4.1.1.2.2.2.2" xref="S2.E5.m1.4.4.1.1.2.2.2.2.cmml">p</mi><mo id="S2.E5.m1.4.4.1.1.2.2.2.1" xref="S2.E5.m1.4.4.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.E5.m1.4.4.1.1.2.2.3" xref="S2.E5.m1.4.4.1.1.2.2.3.cmml">P</mi></msub><mo id="S2.E5.m1.4.4.1.1.2.1" xref="S2.E5.m1.4.4.1.1.2.1.cmml">â¢</mo><mrow id="S2.E5.m1.4.4.1.1.2.3.2" xref="S2.E5.m1.4.4.1.1.2.cmml"><mo id="S2.E5.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="S2.E5.m1.4.4.1.1.2.cmml">(</mo><mi id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml">j</mi><mo id="S2.E5.m1.4.4.1.1.2.3.2.2" stretchy="false" xref="S2.E5.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.4.4.1.1.3" xref="S2.E5.m1.4.4.1.1.3.cmml">=</mo><mfrac id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml"><mfrac id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.cmml"><mrow id="S2.E5.m1.1.1.1.3" xref="S2.E5.m1.1.1.1.3.cmml"><msub id="S2.E5.m1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.3.2.cmml"><mi id="S2.E5.m1.1.1.1.3.2.2" xref="S2.E5.m1.1.1.1.3.2.2.cmml">c</mi><mi id="S2.E5.m1.1.1.1.3.2.3" xref="S2.E5.m1.1.1.1.3.2.3.cmml">j</mi></msub><mo id="S2.E5.m1.1.1.1.3.1" xref="S2.E5.m1.1.1.1.3.1.cmml">+</mo><mi id="S2.E5.m1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.3.cmml">m</mi><mo id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E5.m1.1.1.1.1.1.4" xref="S2.E5.m1.1.1.1.1.1.4.cmml">a</mi><mo id="S2.E5.m1.1.1.1.1.1.2a" xref="S2.E5.m1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E5.m1.1.1.1.1.1.5" xref="S2.E5.m1.1.1.1.1.1.5.cmml">x</mi><mo id="S2.E5.m1.1.1.1.1.1.2b" xref="S2.E5.m1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E5.m1.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E5.m1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E5.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mrow id="S2.E5.m1.2.2.2" xref="S2.E5.m1.2.2.2.cmml"><msubsup id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml"><mo id="S2.E5.m1.2.2.2.2.2.2" xref="S2.E5.m1.2.2.2.2.2.2.cmml">âˆ‘</mo><mrow id="S2.E5.m1.2.2.2.2.2.3" xref="S2.E5.m1.2.2.2.2.2.3.cmml"><mi id="S2.E5.m1.2.2.2.2.2.3.2" xref="S2.E5.m1.2.2.2.2.2.3.2.cmml">z</mi><mo id="S2.E5.m1.2.2.2.2.2.3.1" xref="S2.E5.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S2.E5.m1.2.2.2.2.2.3.3" xref="S2.E5.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E5.m1.2.2.2.2.3" xref="S2.E5.m1.2.2.2.2.3.cmml">N</mi></msubsup><mfrac id="S2.E5.m1.2.2.2.1" xref="S2.E5.m1.2.2.2.1.cmml"><mrow id="S2.E5.m1.2.2.2.1.3" xref="S2.E5.m1.2.2.2.1.3.cmml"><msub id="S2.E5.m1.2.2.2.1.3.2" xref="S2.E5.m1.2.2.2.1.3.2.cmml"><mi id="S2.E5.m1.2.2.2.1.3.2.2" xref="S2.E5.m1.2.2.2.1.3.2.2.cmml">c</mi><mi id="S2.E5.m1.2.2.2.1.3.2.3" xref="S2.E5.m1.2.2.2.1.3.2.3.cmml">z</mi></msub><mo id="S2.E5.m1.2.2.2.1.3.1" xref="S2.E5.m1.2.2.2.1.3.1.cmml">+</mo><mi id="S2.E5.m1.2.2.2.1.3.3" xref="S2.E5.m1.2.2.2.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E5.m1.2.2.2.1.1" xref="S2.E5.m1.2.2.2.1.1.cmml"><mi id="S2.E5.m1.2.2.2.1.1.3" xref="S2.E5.m1.2.2.2.1.1.3.cmml">m</mi><mo id="S2.E5.m1.2.2.2.1.1.2" xref="S2.E5.m1.2.2.2.1.1.2.cmml">â¢</mo><mi id="S2.E5.m1.2.2.2.1.1.4" xref="S2.E5.m1.2.2.2.1.1.4.cmml">a</mi><mo id="S2.E5.m1.2.2.2.1.1.2a" xref="S2.E5.m1.2.2.2.1.1.2.cmml">â¢</mo><mi id="S2.E5.m1.2.2.2.1.1.5" xref="S2.E5.m1.2.2.2.1.1.5.cmml">x</mi><mo id="S2.E5.m1.2.2.2.1.1.2b" xref="S2.E5.m1.2.2.2.1.1.2.cmml">â¢</mo><mrow id="S2.E5.m1.2.2.2.1.1.1.1" xref="S2.E5.m1.2.2.2.1.1.1.1.1.cmml"><mo id="S2.E5.m1.2.2.2.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.2.2.2.1.1.1.1.1" xref="S2.E5.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S2.E5.m1.2.2.2.1.1.1.1.1.2" xref="S2.E5.m1.2.2.2.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E5.m1.2.2.2.1.1.1.1.1.1" xref="S2.E5.m1.2.2.2.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E5.m1.2.2.2.1.1.1.1.1.3" xref="S2.E5.m1.2.2.2.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E5.m1.2.2.2.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac><mo id="S2.E5.m1.4.4.1.1.4" xref="S2.E5.m1.4.4.1.1.4.cmml">=</mo><mfrac id="S2.E5.m1.4.4.1.1.5" xref="S2.E5.m1.4.4.1.1.5.cmml"><msup id="S2.E5.m1.4.4.1.1.5.2" xref="S2.E5.m1.4.4.1.1.5.2.cmml"><mi id="S2.E5.m1.4.4.1.1.5.2.2" xref="S2.E5.m1.4.4.1.1.5.2.2.cmml">e</mi><msub id="S2.E5.m1.4.4.1.1.5.2.3" xref="S2.E5.m1.4.4.1.1.5.2.3.cmml"><mi id="S2.E5.m1.4.4.1.1.5.2.3.2" xref="S2.E5.m1.4.4.1.1.5.2.3.2.cmml">y</mi><mi id="S2.E5.m1.4.4.1.1.5.2.3.3" xref="S2.E5.m1.4.4.1.1.5.2.3.3.cmml">j</mi></msub></msup><mrow id="S2.E5.m1.4.4.1.1.5.3" xref="S2.E5.m1.4.4.1.1.5.3.cmml"><msubsup id="S2.E5.m1.4.4.1.1.5.3.1" xref="S2.E5.m1.4.4.1.1.5.3.1.cmml"><mo id="S2.E5.m1.4.4.1.1.5.3.1.2.2" xref="S2.E5.m1.4.4.1.1.5.3.1.2.2.cmml">âˆ‘</mo><mrow id="S2.E5.m1.4.4.1.1.5.3.1.2.3" xref="S2.E5.m1.4.4.1.1.5.3.1.2.3.cmml"><mi id="S2.E5.m1.4.4.1.1.5.3.1.2.3.2" xref="S2.E5.m1.4.4.1.1.5.3.1.2.3.2.cmml">z</mi><mo id="S2.E5.m1.4.4.1.1.5.3.1.2.3.1" xref="S2.E5.m1.4.4.1.1.5.3.1.2.3.1.cmml">=</mo><mn id="S2.E5.m1.4.4.1.1.5.3.1.2.3.3" xref="S2.E5.m1.4.4.1.1.5.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E5.m1.4.4.1.1.5.3.1.3" xref="S2.E5.m1.4.4.1.1.5.3.1.3.cmml">N</mi></msubsup><msup id="S2.E5.m1.4.4.1.1.5.3.2" xref="S2.E5.m1.4.4.1.1.5.3.2.cmml"><mi id="S2.E5.m1.4.4.1.1.5.3.2.2" xref="S2.E5.m1.4.4.1.1.5.3.2.2.cmml">e</mi><msub id="S2.E5.m1.4.4.1.1.5.3.2.3" xref="S2.E5.m1.4.4.1.1.5.3.2.3.cmml"><mi id="S2.E5.m1.4.4.1.1.5.3.2.3.2" xref="S2.E5.m1.4.4.1.1.5.3.2.3.2.cmml">y</mi><mi id="S2.E5.m1.4.4.1.1.5.3.2.3.3" xref="S2.E5.m1.4.4.1.1.5.3.2.3.3.cmml">z</mi></msub></msup></mrow></mfrac></mrow><mo id="S2.E5.m1.4.4.1.2" lspace="0em" xref="S2.E5.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.4b"><apply id="S2.E5.m1.4.4.1.1.cmml" xref="S2.E5.m1.4.4.1"><and id="S2.E5.m1.4.4.1.1a.cmml" xref="S2.E5.m1.4.4.1"></and><apply id="S2.E5.m1.4.4.1.1b.cmml" xref="S2.E5.m1.4.4.1"><eq id="S2.E5.m1.4.4.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.3"></eq><apply id="S2.E5.m1.4.4.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.2"><times id="S2.E5.m1.4.4.1.1.2.1.cmml" xref="S2.E5.m1.4.4.1.1.2.1"></times><apply id="S2.E5.m1.4.4.1.1.2.2.cmml" xref="S2.E5.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.2.2.1.cmml" xref="S2.E5.m1.4.4.1.1.2.2">subscript</csymbol><apply id="S2.E5.m1.4.4.1.1.2.2.2.cmml" xref="S2.E5.m1.4.4.1.1.2.2.2"><ci id="S2.E5.m1.4.4.1.1.2.2.2.1.cmml" xref="S2.E5.m1.4.4.1.1.2.2.2.1">^</ci><ci id="S2.E5.m1.4.4.1.1.2.2.2.2.cmml" xref="S2.E5.m1.4.4.1.1.2.2.2.2">ğ‘</ci></apply><ci id="S2.E5.m1.4.4.1.1.2.2.3.cmml" xref="S2.E5.m1.4.4.1.1.2.2.3">ğ‘ƒ</ci></apply><ci id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3">ğ‘—</ci></apply><apply id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2"><divide id="S2.E5.m1.2.2.3.cmml" xref="S2.E5.m1.2.2"></divide><apply id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><divide id="S2.E5.m1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1"></divide><apply id="S2.E5.m1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.3"><plus id="S2.E5.m1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.3.1"></plus><apply id="S2.E5.m1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.3.2.1.cmml" xref="S2.E5.m1.1.1.1.3.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.3.2.2.cmml" xref="S2.E5.m1.1.1.1.3.2.2">ğ‘</ci><ci id="S2.E5.m1.1.1.1.3.2.3.cmml" xref="S2.E5.m1.1.1.1.3.2.3">ğ‘—</ci></apply><ci id="S2.E5.m1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E5.m1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><times id="S2.E5.m1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.2"></times><ci id="S2.E5.m1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.3">ğ‘š</ci><ci id="S2.E5.m1.1.1.1.1.1.4.cmml" xref="S2.E5.m1.1.1.1.1.1.4">ğ‘</ci><ci id="S2.E5.m1.1.1.1.1.1.5.cmml" xref="S2.E5.m1.1.1.1.1.1.5">ğ‘¥</ci><apply id="S2.E5.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1"><plus id="S2.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E5.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply><apply id="S2.E5.m1.2.2.2.cmml" xref="S2.E5.m1.2.2.2"><apply id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.2.2.1.cmml" xref="S2.E5.m1.2.2.2.2">superscript</csymbol><apply id="S2.E5.m1.2.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.2.2.2.1.cmml" xref="S2.E5.m1.2.2.2.2">subscript</csymbol><sum id="S2.E5.m1.2.2.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2.2.2"></sum><apply id="S2.E5.m1.2.2.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.2.2.3"><eq id="S2.E5.m1.2.2.2.2.2.3.1.cmml" xref="S2.E5.m1.2.2.2.2.2.3.1"></eq><ci id="S2.E5.m1.2.2.2.2.2.3.2.cmml" xref="S2.E5.m1.2.2.2.2.2.3.2">ğ‘§</ci><cn id="S2.E5.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S2.E5.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E5.m1.2.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.2.3">ğ‘</ci></apply><apply id="S2.E5.m1.2.2.2.1.cmml" xref="S2.E5.m1.2.2.2.1"><divide id="S2.E5.m1.2.2.2.1.2.cmml" xref="S2.E5.m1.2.2.2.1"></divide><apply id="S2.E5.m1.2.2.2.1.3.cmml" xref="S2.E5.m1.2.2.2.1.3"><plus id="S2.E5.m1.2.2.2.1.3.1.cmml" xref="S2.E5.m1.2.2.2.1.3.1"></plus><apply id="S2.E5.m1.2.2.2.1.3.2.cmml" xref="S2.E5.m1.2.2.2.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.2.1.3.2.1.cmml" xref="S2.E5.m1.2.2.2.1.3.2">subscript</csymbol><ci id="S2.E5.m1.2.2.2.1.3.2.2.cmml" xref="S2.E5.m1.2.2.2.1.3.2.2">ğ‘</ci><ci id="S2.E5.m1.2.2.2.1.3.2.3.cmml" xref="S2.E5.m1.2.2.2.1.3.2.3">ğ‘§</ci></apply><ci id="S2.E5.m1.2.2.2.1.3.3.cmml" xref="S2.E5.m1.2.2.2.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E5.m1.2.2.2.1.1.cmml" xref="S2.E5.m1.2.2.2.1.1"><times id="S2.E5.m1.2.2.2.1.1.2.cmml" xref="S2.E5.m1.2.2.2.1.1.2"></times><ci id="S2.E5.m1.2.2.2.1.1.3.cmml" xref="S2.E5.m1.2.2.2.1.1.3">ğ‘š</ci><ci id="S2.E5.m1.2.2.2.1.1.4.cmml" xref="S2.E5.m1.2.2.2.1.1.4">ğ‘</ci><ci id="S2.E5.m1.2.2.2.1.1.5.cmml" xref="S2.E5.m1.2.2.2.1.1.5">ğ‘¥</ci><apply id="S2.E5.m1.2.2.2.1.1.1.1.1.cmml" xref="S2.E5.m1.2.2.2.1.1.1.1"><plus id="S2.E5.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E5.m1.2.2.2.1.1.1.1.1.1"></plus><ci id="S2.E5.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E5.m1.2.2.2.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E5.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E5.m1.2.2.2.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply></apply></apply></apply><apply id="S2.E5.m1.4.4.1.1c.cmml" xref="S2.E5.m1.4.4.1"><eq id="S2.E5.m1.4.4.1.1.4.cmml" xref="S2.E5.m1.4.4.1.1.4"></eq><share href="https://arxiv.org/html/2409.04329v1#S2.E5.m1.2.2.cmml" id="S2.E5.m1.4.4.1.1d.cmml" xref="S2.E5.m1.4.4.1"></share><apply id="S2.E5.m1.4.4.1.1.5.cmml" xref="S2.E5.m1.4.4.1.1.5"><divide id="S2.E5.m1.4.4.1.1.5.1.cmml" xref="S2.E5.m1.4.4.1.1.5"></divide><apply id="S2.E5.m1.4.4.1.1.5.2.cmml" xref="S2.E5.m1.4.4.1.1.5.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.5.2.1.cmml" xref="S2.E5.m1.4.4.1.1.5.2">superscript</csymbol><ci id="S2.E5.m1.4.4.1.1.5.2.2.cmml" xref="S2.E5.m1.4.4.1.1.5.2.2">ğ‘’</ci><apply id="S2.E5.m1.4.4.1.1.5.2.3.cmml" xref="S2.E5.m1.4.4.1.1.5.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.5.2.3.1.cmml" xref="S2.E5.m1.4.4.1.1.5.2.3">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.5.2.3.2.cmml" xref="S2.E5.m1.4.4.1.1.5.2.3.2">ğ‘¦</ci><ci id="S2.E5.m1.4.4.1.1.5.2.3.3.cmml" xref="S2.E5.m1.4.4.1.1.5.2.3.3">ğ‘—</ci></apply></apply><apply id="S2.E5.m1.4.4.1.1.5.3.cmml" xref="S2.E5.m1.4.4.1.1.5.3"><apply id="S2.E5.m1.4.4.1.1.5.3.1.cmml" xref="S2.E5.m1.4.4.1.1.5.3.1"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.5.3.1.1.cmml" xref="S2.E5.m1.4.4.1.1.5.3.1">superscript</csymbol><apply id="S2.E5.m1.4.4.1.1.5.3.1.2.cmml" xref="S2.E5.m1.4.4.1.1.5.3.1"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.5.3.1.2.1.cmml" xref="S2.E5.m1.4.4.1.1.5.3.1">subscript</csymbol><sum id="S2.E5.m1.4.4.1.1.5.3.1.2.2.cmml" xref="S2.E5.m1.4.4.1.1.5.3.1.2.2"></sum><apply id="S2.E5.m1.4.4.1.1.5.3.1.2.3.cmml" xref="S2.E5.m1.4.4.1.1.5.3.1.2.3"><eq id="S2.E5.m1.4.4.1.1.5.3.1.2.3.1.cmml" xref="S2.E5.m1.4.4.1.1.5.3.1.2.3.1"></eq><ci id="S2.E5.m1.4.4.1.1.5.3.1.2.3.2.cmml" xref="S2.E5.m1.4.4.1.1.5.3.1.2.3.2">ğ‘§</ci><cn id="S2.E5.m1.4.4.1.1.5.3.1.2.3.3.cmml" type="integer" xref="S2.E5.m1.4.4.1.1.5.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E5.m1.4.4.1.1.5.3.1.3.cmml" xref="S2.E5.m1.4.4.1.1.5.3.1.3">ğ‘</ci></apply><apply id="S2.E5.m1.4.4.1.1.5.3.2.cmml" xref="S2.E5.m1.4.4.1.1.5.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.5.3.2.1.cmml" xref="S2.E5.m1.4.4.1.1.5.3.2">superscript</csymbol><ci id="S2.E5.m1.4.4.1.1.5.3.2.2.cmml" xref="S2.E5.m1.4.4.1.1.5.3.2.2">ğ‘’</ci><apply id="S2.E5.m1.4.4.1.1.5.3.2.3.cmml" xref="S2.E5.m1.4.4.1.1.5.3.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.5.3.2.3.1.cmml" xref="S2.E5.m1.4.4.1.1.5.3.2.3">subscript</csymbol><ci id="S2.E5.m1.4.4.1.1.5.3.2.3.2.cmml" xref="S2.E5.m1.4.4.1.1.5.3.2.3.2">ğ‘¦</ci><ci id="S2.E5.m1.4.4.1.1.5.3.2.3.3.cmml" xref="S2.E5.m1.4.4.1.1.5.3.2.3.3">ğ‘§</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.4c">\hat{p}_{P}(j)=\frac{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}{\sum_{z=1}^{N}%
\frac{c_{z}+\epsilon}{max(C+\epsilon)}}=\frac{e^{y_{j}}}{\sum_{z=1}^{N}e^{y_{z%
}}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.4d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) = divide start_ARG divide start_ARG italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG italic_c start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_ARG = divide start_ARG italic_e start_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p6.7">Next, the personalized popularity probability can be formulated as a softmax following the equivalence</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}{\sum_{z=1}^{N}\frac{c_{z}+%
\epsilon}{max(C+\epsilon)}}=\frac{e^{\ln{\frac{c_{j}+\epsilon}{max(C+\epsilon)%
}}}}{e^{\ln{\sum_{z=1}^{N}\frac{c_{z}+\epsilon}{max(C+\epsilon)}}}}." class="ltx_Math" display="block" id="S2.E6.m1.5"><semantics id="S2.E6.m1.5a"><mrow id="S2.E6.m1.5.5.1" xref="S2.E6.m1.5.5.1.1.cmml"><mrow id="S2.E6.m1.5.5.1.1" xref="S2.E6.m1.5.5.1.1.cmml"><mfrac id="S2.E6.m1.2.2" xref="S2.E6.m1.2.2.cmml"><mfrac id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.cmml"><mrow id="S2.E6.m1.1.1.1.3" xref="S2.E6.m1.1.1.1.3.cmml"><msub id="S2.E6.m1.1.1.1.3.2" xref="S2.E6.m1.1.1.1.3.2.cmml"><mi id="S2.E6.m1.1.1.1.3.2.2" xref="S2.E6.m1.1.1.1.3.2.2.cmml">c</mi><mi id="S2.E6.m1.1.1.1.3.2.3" xref="S2.E6.m1.1.1.1.3.2.3.cmml">j</mi></msub><mo id="S2.E6.m1.1.1.1.3.1" xref="S2.E6.m1.1.1.1.3.1.cmml">+</mo><mi id="S2.E6.m1.1.1.1.3.3" xref="S2.E6.m1.1.1.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E6.m1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.3.cmml">m</mi><mo id="S2.E6.m1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E6.m1.1.1.1.1.1.4" xref="S2.E6.m1.1.1.1.1.1.4.cmml">a</mi><mo id="S2.E6.m1.1.1.1.1.1.2a" xref="S2.E6.m1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E6.m1.1.1.1.1.1.5" xref="S2.E6.m1.1.1.1.1.1.5.cmml">x</mi><mo id="S2.E6.m1.1.1.1.1.1.2b" xref="S2.E6.m1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E6.m1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E6.m1.1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mrow id="S2.E6.m1.2.2.2" xref="S2.E6.m1.2.2.2.cmml"><msubsup id="S2.E6.m1.2.2.2.2" xref="S2.E6.m1.2.2.2.2.cmml"><mo id="S2.E6.m1.2.2.2.2.2.2" xref="S2.E6.m1.2.2.2.2.2.2.cmml">âˆ‘</mo><mrow id="S2.E6.m1.2.2.2.2.2.3" xref="S2.E6.m1.2.2.2.2.2.3.cmml"><mi id="S2.E6.m1.2.2.2.2.2.3.2" xref="S2.E6.m1.2.2.2.2.2.3.2.cmml">z</mi><mo id="S2.E6.m1.2.2.2.2.2.3.1" xref="S2.E6.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S2.E6.m1.2.2.2.2.2.3.3" xref="S2.E6.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E6.m1.2.2.2.2.3" xref="S2.E6.m1.2.2.2.2.3.cmml">N</mi></msubsup><mfrac id="S2.E6.m1.2.2.2.1" xref="S2.E6.m1.2.2.2.1.cmml"><mrow id="S2.E6.m1.2.2.2.1.3" xref="S2.E6.m1.2.2.2.1.3.cmml"><msub id="S2.E6.m1.2.2.2.1.3.2" xref="S2.E6.m1.2.2.2.1.3.2.cmml"><mi id="S2.E6.m1.2.2.2.1.3.2.2" xref="S2.E6.m1.2.2.2.1.3.2.2.cmml">c</mi><mi id="S2.E6.m1.2.2.2.1.3.2.3" xref="S2.E6.m1.2.2.2.1.3.2.3.cmml">z</mi></msub><mo id="S2.E6.m1.2.2.2.1.3.1" xref="S2.E6.m1.2.2.2.1.3.1.cmml">+</mo><mi id="S2.E6.m1.2.2.2.1.3.3" xref="S2.E6.m1.2.2.2.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E6.m1.2.2.2.1.1" xref="S2.E6.m1.2.2.2.1.1.cmml"><mi id="S2.E6.m1.2.2.2.1.1.3" xref="S2.E6.m1.2.2.2.1.1.3.cmml">m</mi><mo id="S2.E6.m1.2.2.2.1.1.2" xref="S2.E6.m1.2.2.2.1.1.2.cmml">â¢</mo><mi id="S2.E6.m1.2.2.2.1.1.4" xref="S2.E6.m1.2.2.2.1.1.4.cmml">a</mi><mo id="S2.E6.m1.2.2.2.1.1.2a" xref="S2.E6.m1.2.2.2.1.1.2.cmml">â¢</mo><mi id="S2.E6.m1.2.2.2.1.1.5" xref="S2.E6.m1.2.2.2.1.1.5.cmml">x</mi><mo id="S2.E6.m1.2.2.2.1.1.2b" xref="S2.E6.m1.2.2.2.1.1.2.cmml">â¢</mo><mrow id="S2.E6.m1.2.2.2.1.1.1.1" xref="S2.E6.m1.2.2.2.1.1.1.1.1.cmml"><mo id="S2.E6.m1.2.2.2.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.2.2.2.1.1.1.1.1" xref="S2.E6.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S2.E6.m1.2.2.2.1.1.1.1.1.2" xref="S2.E6.m1.2.2.2.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E6.m1.2.2.2.1.1.1.1.1.1" xref="S2.E6.m1.2.2.2.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E6.m1.2.2.2.1.1.1.1.1.3" xref="S2.E6.m1.2.2.2.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E6.m1.2.2.2.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac><mo id="S2.E6.m1.5.5.1.1.1" xref="S2.E6.m1.5.5.1.1.1.cmml">=</mo><mfrac id="S2.E6.m1.4.4" xref="S2.E6.m1.4.4.cmml"><msup id="S2.E6.m1.3.3.1" xref="S2.E6.m1.3.3.1.cmml"><mi id="S2.E6.m1.3.3.1.3" xref="S2.E6.m1.3.3.1.3.cmml">e</mi><mrow id="S2.E6.m1.3.3.1.1.1" xref="S2.E6.m1.3.3.1.1.1.cmml"><mi id="S2.E6.m1.3.3.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.2.cmml">ln</mi><mo id="S2.E6.m1.3.3.1.1.1a" lspace="0.167em" xref="S2.E6.m1.3.3.1.1.1.cmml">â¡</mo><mfrac id="S2.E6.m1.3.3.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.3.cmml"><msub id="S2.E6.m1.3.3.1.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.3.2.2" xref="S2.E6.m1.3.3.1.1.1.1.3.2.2.cmml">c</mi><mi id="S2.E6.m1.3.3.1.1.1.1.3.2.3" xref="S2.E6.m1.3.3.1.1.1.1.3.2.3.cmml">j</mi></msub><mo id="S2.E6.m1.3.3.1.1.1.1.3.1" xref="S2.E6.m1.3.3.1.1.1.1.3.1.cmml">+</mo><mi id="S2.E6.m1.3.3.1.1.1.1.3.3" xref="S2.E6.m1.3.3.1.1.1.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E6.m1.3.3.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.1.3.cmml">m</mi><mo id="S2.E6.m1.3.3.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E6.m1.3.3.1.1.1.1.1.4" xref="S2.E6.m1.3.3.1.1.1.1.1.4.cmml">a</mi><mo id="S2.E6.m1.3.3.1.1.1.1.1.2a" xref="S2.E6.m1.3.3.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E6.m1.3.3.1.1.1.1.1.5" xref="S2.E6.m1.3.3.1.1.1.1.1.5.cmml">x</mi><mo id="S2.E6.m1.3.3.1.1.1.1.1.2b" xref="S2.E6.m1.3.3.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></msup><msup id="S2.E6.m1.4.4.2" xref="S2.E6.m1.4.4.2.cmml"><mi id="S2.E6.m1.4.4.2.3" xref="S2.E6.m1.4.4.2.3.cmml">e</mi><mrow id="S2.E6.m1.4.4.2.1.1" xref="S2.E6.m1.4.4.2.1.1.cmml"><mi id="S2.E6.m1.4.4.2.1.1.3" xref="S2.E6.m1.4.4.2.1.1.3.cmml">ln</mi><mo id="S2.E6.m1.4.4.2.1.1.2" lspace="0.167em" xref="S2.E6.m1.4.4.2.1.1.2.cmml">â¢</mo><mrow id="S2.E6.m1.4.4.2.1.1.4" xref="S2.E6.m1.4.4.2.1.1.4.cmml"><mstyle displaystyle="false" id="S2.E6.m1.4.4.2.1.1.4.1" xref="S2.E6.m1.4.4.2.1.1.4.1.cmml"><msubsup id="S2.E6.m1.4.4.2.1.1.4.1a" xref="S2.E6.m1.4.4.2.1.1.4.1.cmml"><mo id="S2.E6.m1.4.4.2.1.1.4.1.2.2" xref="S2.E6.m1.4.4.2.1.1.4.1.2.2.cmml">âˆ‘</mo><mrow id="S2.E6.m1.4.4.2.1.1.4.1.2.3" xref="S2.E6.m1.4.4.2.1.1.4.1.2.3.cmml"><mi id="S2.E6.m1.4.4.2.1.1.4.1.2.3.2" xref="S2.E6.m1.4.4.2.1.1.4.1.2.3.2.cmml">z</mi><mo id="S2.E6.m1.4.4.2.1.1.4.1.2.3.1" xref="S2.E6.m1.4.4.2.1.1.4.1.2.3.1.cmml">=</mo><mn id="S2.E6.m1.4.4.2.1.1.4.1.2.3.3" xref="S2.E6.m1.4.4.2.1.1.4.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E6.m1.4.4.2.1.1.4.1.3" xref="S2.E6.m1.4.4.2.1.1.4.1.3.cmml">N</mi></msubsup></mstyle><mfrac id="S2.E6.m1.4.4.2.1.1.1" xref="S2.E6.m1.4.4.2.1.1.1.cmml"><mrow id="S2.E6.m1.4.4.2.1.1.1.3" xref="S2.E6.m1.4.4.2.1.1.1.3.cmml"><msub id="S2.E6.m1.4.4.2.1.1.1.3.2" xref="S2.E6.m1.4.4.2.1.1.1.3.2.cmml"><mi id="S2.E6.m1.4.4.2.1.1.1.3.2.2" xref="S2.E6.m1.4.4.2.1.1.1.3.2.2.cmml">c</mi><mi id="S2.E6.m1.4.4.2.1.1.1.3.2.3" xref="S2.E6.m1.4.4.2.1.1.1.3.2.3.cmml">z</mi></msub><mo id="S2.E6.m1.4.4.2.1.1.1.3.1" xref="S2.E6.m1.4.4.2.1.1.1.3.1.cmml">+</mo><mi id="S2.E6.m1.4.4.2.1.1.1.3.3" xref="S2.E6.m1.4.4.2.1.1.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E6.m1.4.4.2.1.1.1.1" xref="S2.E6.m1.4.4.2.1.1.1.1.cmml"><mi id="S2.E6.m1.4.4.2.1.1.1.1.3" xref="S2.E6.m1.4.4.2.1.1.1.1.3.cmml">m</mi><mo id="S2.E6.m1.4.4.2.1.1.1.1.2" xref="S2.E6.m1.4.4.2.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E6.m1.4.4.2.1.1.1.1.4" xref="S2.E6.m1.4.4.2.1.1.1.1.4.cmml">a</mi><mo id="S2.E6.m1.4.4.2.1.1.1.1.2a" xref="S2.E6.m1.4.4.2.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E6.m1.4.4.2.1.1.1.1.5" xref="S2.E6.m1.4.4.2.1.1.1.1.5.cmml">x</mi><mo id="S2.E6.m1.4.4.2.1.1.1.1.2b" xref="S2.E6.m1.4.4.2.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E6.m1.4.4.2.1.1.1.1.1.1" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.4.4.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.4.4.2.1.1.1.1.1.1.1" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.2" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.1" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.3" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E6.m1.4.4.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></msup></mfrac></mrow><mo id="S2.E6.m1.5.5.1.2" lspace="0em" xref="S2.E6.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.5b"><apply id="S2.E6.m1.5.5.1.1.cmml" xref="S2.E6.m1.5.5.1"><eq id="S2.E6.m1.5.5.1.1.1.cmml" xref="S2.E6.m1.5.5.1.1.1"></eq><apply id="S2.E6.m1.2.2.cmml" xref="S2.E6.m1.2.2"><divide id="S2.E6.m1.2.2.3.cmml" xref="S2.E6.m1.2.2"></divide><apply id="S2.E6.m1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"><divide id="S2.E6.m1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1"></divide><apply id="S2.E6.m1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.3"><plus id="S2.E6.m1.1.1.1.3.1.cmml" xref="S2.E6.m1.1.1.1.3.1"></plus><apply id="S2.E6.m1.1.1.1.3.2.cmml" xref="S2.E6.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.3.2.1.cmml" xref="S2.E6.m1.1.1.1.3.2">subscript</csymbol><ci id="S2.E6.m1.1.1.1.3.2.2.cmml" xref="S2.E6.m1.1.1.1.3.2.2">ğ‘</ci><ci id="S2.E6.m1.1.1.1.3.2.3.cmml" xref="S2.E6.m1.1.1.1.3.2.3">ğ‘—</ci></apply><ci id="S2.E6.m1.1.1.1.3.3.cmml" xref="S2.E6.m1.1.1.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E6.m1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1"><times id="S2.E6.m1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.2"></times><ci id="S2.E6.m1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.3">ğ‘š</ci><ci id="S2.E6.m1.1.1.1.1.1.4.cmml" xref="S2.E6.m1.1.1.1.1.1.4">ğ‘</ci><ci id="S2.E6.m1.1.1.1.1.1.5.cmml" xref="S2.E6.m1.1.1.1.1.1.5">ğ‘¥</ci><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1"><plus id="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply><apply id="S2.E6.m1.2.2.2.cmml" xref="S2.E6.m1.2.2.2"><apply id="S2.E6.m1.2.2.2.2.cmml" xref="S2.E6.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.2.1.cmml" xref="S2.E6.m1.2.2.2.2">superscript</csymbol><apply id="S2.E6.m1.2.2.2.2.2.cmml" xref="S2.E6.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.2.2.1.cmml" xref="S2.E6.m1.2.2.2.2">subscript</csymbol><sum id="S2.E6.m1.2.2.2.2.2.2.cmml" xref="S2.E6.m1.2.2.2.2.2.2"></sum><apply id="S2.E6.m1.2.2.2.2.2.3.cmml" xref="S2.E6.m1.2.2.2.2.2.3"><eq id="S2.E6.m1.2.2.2.2.2.3.1.cmml" xref="S2.E6.m1.2.2.2.2.2.3.1"></eq><ci id="S2.E6.m1.2.2.2.2.2.3.2.cmml" xref="S2.E6.m1.2.2.2.2.2.3.2">ğ‘§</ci><cn id="S2.E6.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S2.E6.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E6.m1.2.2.2.2.3.cmml" xref="S2.E6.m1.2.2.2.2.3">ğ‘</ci></apply><apply id="S2.E6.m1.2.2.2.1.cmml" xref="S2.E6.m1.2.2.2.1"><divide id="S2.E6.m1.2.2.2.1.2.cmml" xref="S2.E6.m1.2.2.2.1"></divide><apply id="S2.E6.m1.2.2.2.1.3.cmml" xref="S2.E6.m1.2.2.2.1.3"><plus id="S2.E6.m1.2.2.2.1.3.1.cmml" xref="S2.E6.m1.2.2.2.1.3.1"></plus><apply id="S2.E6.m1.2.2.2.1.3.2.cmml" xref="S2.E6.m1.2.2.2.1.3.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.2.1.3.2.1.cmml" xref="S2.E6.m1.2.2.2.1.3.2">subscript</csymbol><ci id="S2.E6.m1.2.2.2.1.3.2.2.cmml" xref="S2.E6.m1.2.2.2.1.3.2.2">ğ‘</ci><ci id="S2.E6.m1.2.2.2.1.3.2.3.cmml" xref="S2.E6.m1.2.2.2.1.3.2.3">ğ‘§</ci></apply><ci id="S2.E6.m1.2.2.2.1.3.3.cmml" xref="S2.E6.m1.2.2.2.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E6.m1.2.2.2.1.1.cmml" xref="S2.E6.m1.2.2.2.1.1"><times id="S2.E6.m1.2.2.2.1.1.2.cmml" xref="S2.E6.m1.2.2.2.1.1.2"></times><ci id="S2.E6.m1.2.2.2.1.1.3.cmml" xref="S2.E6.m1.2.2.2.1.1.3">ğ‘š</ci><ci id="S2.E6.m1.2.2.2.1.1.4.cmml" xref="S2.E6.m1.2.2.2.1.1.4">ğ‘</ci><ci id="S2.E6.m1.2.2.2.1.1.5.cmml" xref="S2.E6.m1.2.2.2.1.1.5">ğ‘¥</ci><apply id="S2.E6.m1.2.2.2.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.2.1.1.1.1"><plus id="S2.E6.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.2.1.1.1.1.1.1"></plus><ci id="S2.E6.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.2.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E6.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.2.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply></apply></apply><apply id="S2.E6.m1.4.4.cmml" xref="S2.E6.m1.4.4"><divide id="S2.E6.m1.4.4.3.cmml" xref="S2.E6.m1.4.4"></divide><apply id="S2.E6.m1.3.3.1.cmml" xref="S2.E6.m1.3.3.1"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.2.cmml" xref="S2.E6.m1.3.3.1">superscript</csymbol><ci id="S2.E6.m1.3.3.1.3.cmml" xref="S2.E6.m1.3.3.1.3">ğ‘’</ci><apply id="S2.E6.m1.3.3.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1"><ln id="S2.E6.m1.3.3.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.2"></ln><apply id="S2.E6.m1.3.3.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1"><divide id="S2.E6.m1.3.3.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1"></divide><apply id="S2.E6.m1.3.3.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3"><plus id="S2.E6.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.1"></plus><apply id="S2.E6.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.2.2">ğ‘</ci><ci id="S2.E6.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.2.3">ğ‘—</ci></apply><ci id="S2.E6.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E6.m1.3.3.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1"><times id="S2.E6.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.2"></times><ci id="S2.E6.m1.3.3.1.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.3">ğ‘š</ci><ci id="S2.E6.m1.3.3.1.1.1.1.1.4.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.4">ğ‘</ci><ci id="S2.E6.m1.3.3.1.1.1.1.1.5.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.5">ğ‘¥</ci><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1"><plus id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1"></plus><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply></apply></apply><apply id="S2.E6.m1.4.4.2.cmml" xref="S2.E6.m1.4.4.2"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.2.2.cmml" xref="S2.E6.m1.4.4.2">superscript</csymbol><ci id="S2.E6.m1.4.4.2.3.cmml" xref="S2.E6.m1.4.4.2.3">ğ‘’</ci><apply id="S2.E6.m1.4.4.2.1.1.cmml" xref="S2.E6.m1.4.4.2.1.1"><times id="S2.E6.m1.4.4.2.1.1.2.cmml" xref="S2.E6.m1.4.4.2.1.1.2"></times><ln id="S2.E6.m1.4.4.2.1.1.3.cmml" xref="S2.E6.m1.4.4.2.1.1.3"></ln><apply id="S2.E6.m1.4.4.2.1.1.4.cmml" xref="S2.E6.m1.4.4.2.1.1.4"><apply id="S2.E6.m1.4.4.2.1.1.4.1.cmml" xref="S2.E6.m1.4.4.2.1.1.4.1"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.2.1.1.4.1.1.cmml" xref="S2.E6.m1.4.4.2.1.1.4.1">superscript</csymbol><apply id="S2.E6.m1.4.4.2.1.1.4.1.2.cmml" xref="S2.E6.m1.4.4.2.1.1.4.1"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.2.1.1.4.1.2.1.cmml" xref="S2.E6.m1.4.4.2.1.1.4.1">subscript</csymbol><sum id="S2.E6.m1.4.4.2.1.1.4.1.2.2.cmml" xref="S2.E6.m1.4.4.2.1.1.4.1.2.2"></sum><apply id="S2.E6.m1.4.4.2.1.1.4.1.2.3.cmml" xref="S2.E6.m1.4.4.2.1.1.4.1.2.3"><eq id="S2.E6.m1.4.4.2.1.1.4.1.2.3.1.cmml" xref="S2.E6.m1.4.4.2.1.1.4.1.2.3.1"></eq><ci id="S2.E6.m1.4.4.2.1.1.4.1.2.3.2.cmml" xref="S2.E6.m1.4.4.2.1.1.4.1.2.3.2">ğ‘§</ci><cn id="S2.E6.m1.4.4.2.1.1.4.1.2.3.3.cmml" type="integer" xref="S2.E6.m1.4.4.2.1.1.4.1.2.3.3">1</cn></apply></apply><ci id="S2.E6.m1.4.4.2.1.1.4.1.3.cmml" xref="S2.E6.m1.4.4.2.1.1.4.1.3">ğ‘</ci></apply><apply id="S2.E6.m1.4.4.2.1.1.1.cmml" xref="S2.E6.m1.4.4.2.1.1.1"><divide id="S2.E6.m1.4.4.2.1.1.1.2.cmml" xref="S2.E6.m1.4.4.2.1.1.1"></divide><apply id="S2.E6.m1.4.4.2.1.1.1.3.cmml" xref="S2.E6.m1.4.4.2.1.1.1.3"><plus id="S2.E6.m1.4.4.2.1.1.1.3.1.cmml" xref="S2.E6.m1.4.4.2.1.1.1.3.1"></plus><apply id="S2.E6.m1.4.4.2.1.1.1.3.2.cmml" xref="S2.E6.m1.4.4.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E6.m1.4.4.2.1.1.1.3.2.1.cmml" xref="S2.E6.m1.4.4.2.1.1.1.3.2">subscript</csymbol><ci id="S2.E6.m1.4.4.2.1.1.1.3.2.2.cmml" xref="S2.E6.m1.4.4.2.1.1.1.3.2.2">ğ‘</ci><ci id="S2.E6.m1.4.4.2.1.1.1.3.2.3.cmml" xref="S2.E6.m1.4.4.2.1.1.1.3.2.3">ğ‘§</ci></apply><ci id="S2.E6.m1.4.4.2.1.1.1.3.3.cmml" xref="S2.E6.m1.4.4.2.1.1.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E6.m1.4.4.2.1.1.1.1.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1"><times id="S2.E6.m1.4.4.2.1.1.1.1.2.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.2"></times><ci id="S2.E6.m1.4.4.2.1.1.1.1.3.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.3">ğ‘š</ci><ci id="S2.E6.m1.4.4.2.1.1.1.1.4.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.4">ğ‘</ci><ci id="S2.E6.m1.4.4.2.1.1.1.1.5.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.5">ğ‘¥</ci><apply id="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1"><plus id="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.1"></plus><ci id="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.4.4.2.1.1.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.5c">\frac{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}{\sum_{z=1}^{N}\frac{c_{z}+%
\epsilon}{max(C+\epsilon)}}=\frac{e^{\ln{\frac{c_{j}+\epsilon}{max(C+\epsilon)%
}}}}{e^{\ln{\sum_{z=1}^{N}\frac{c_{z}+\epsilon}{max(C+\epsilon)}}}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.5d">divide start_ARG divide start_ARG italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG italic_c start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_ARG = divide start_ARG italic_e start_POSTSUPERSCRIPT roman_ln divide start_ARG italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_POSTSUPERSCRIPT end_ARG start_ARG italic_e start_POSTSUPERSCRIPT roman_ln âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG italic_c start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p6.8">Combining Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E5" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">5</span></a>) with Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E6" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">6</span></a>), we obtain</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{e^{\ln{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}}}{e^{\ln{\sum_{z=1}^{N}%
\frac{c_{z}+\epsilon}{max(C+\epsilon)}}}}=\frac{e^{y_{j}}}{\sum_{z=1}^{N}e^{y_%
{z}}}." class="ltx_Math" display="block" id="S2.Ex1.m1.3"><semantics id="S2.Ex1.m1.3a"><mrow id="S2.Ex1.m1.3.3.1" xref="S2.Ex1.m1.3.3.1.1.cmml"><mrow id="S2.Ex1.m1.3.3.1.1" xref="S2.Ex1.m1.3.3.1.1.cmml"><mfrac id="S2.Ex1.m1.2.2" xref="S2.Ex1.m1.2.2.cmml"><msup id="S2.Ex1.m1.1.1.1" xref="S2.Ex1.m1.1.1.1.cmml"><mi id="S2.Ex1.m1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.3.cmml">e</mi><mrow id="S2.Ex1.m1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.2.cmml">ln</mi><mo id="S2.Ex1.m1.1.1.1.1.1a" lspace="0.167em" xref="S2.Ex1.m1.1.1.1.1.1.cmml">â¡</mo><mfrac id="S2.Ex1.m1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.cmml"><mrow id="S2.Ex1.m1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.1.3.cmml"><msub id="S2.Ex1.m1.1.1.1.1.1.1.3.2" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.3.2.2" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.2.cmml">c</mi><mi id="S2.Ex1.m1.1.1.1.1.1.1.3.2.3" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.3.cmml">j</mi></msub><mo id="S2.Ex1.m1.1.1.1.1.1.1.3.1" xref="S2.Ex1.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mi id="S2.Ex1.m1.1.1.1.1.1.1.3.3" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.Ex1.m1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.1.1.3.cmml">m</mi><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.4" xref="S2.Ex1.m1.1.1.1.1.1.1.1.4.cmml">a</mi><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.2a" xref="S2.Ex1.m1.1.1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.5" xref="S2.Ex1.m1.1.1.1.1.1.1.1.5.cmml">x</mi><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.2b" xref="S2.Ex1.m1.1.1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></msup><msup id="S2.Ex1.m1.2.2.2" xref="S2.Ex1.m1.2.2.2.cmml"><mi id="S2.Ex1.m1.2.2.2.3" xref="S2.Ex1.m1.2.2.2.3.cmml">e</mi><mrow id="S2.Ex1.m1.2.2.2.1.1" xref="S2.Ex1.m1.2.2.2.1.1.cmml"><mi id="S2.Ex1.m1.2.2.2.1.1.3" xref="S2.Ex1.m1.2.2.2.1.1.3.cmml">ln</mi><mo id="S2.Ex1.m1.2.2.2.1.1.2" lspace="0.167em" xref="S2.Ex1.m1.2.2.2.1.1.2.cmml">â¢</mo><mrow id="S2.Ex1.m1.2.2.2.1.1.4" xref="S2.Ex1.m1.2.2.2.1.1.4.cmml"><mstyle displaystyle="false" id="S2.Ex1.m1.2.2.2.1.1.4.1" xref="S2.Ex1.m1.2.2.2.1.1.4.1.cmml"><msubsup id="S2.Ex1.m1.2.2.2.1.1.4.1a" xref="S2.Ex1.m1.2.2.2.1.1.4.1.cmml"><mo id="S2.Ex1.m1.2.2.2.1.1.4.1.2.2" xref="S2.Ex1.m1.2.2.2.1.1.4.1.2.2.cmml">âˆ‘</mo><mrow id="S2.Ex1.m1.2.2.2.1.1.4.1.2.3" xref="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.cmml"><mi id="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.2" xref="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.2.cmml">z</mi><mo id="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.1" xref="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.1.cmml">=</mo><mn id="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.3" xref="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex1.m1.2.2.2.1.1.4.1.3" xref="S2.Ex1.m1.2.2.2.1.1.4.1.3.cmml">N</mi></msubsup></mstyle><mfrac id="S2.Ex1.m1.2.2.2.1.1.1" xref="S2.Ex1.m1.2.2.2.1.1.1.cmml"><mrow id="S2.Ex1.m1.2.2.2.1.1.1.3" xref="S2.Ex1.m1.2.2.2.1.1.1.3.cmml"><msub id="S2.Ex1.m1.2.2.2.1.1.1.3.2" xref="S2.Ex1.m1.2.2.2.1.1.1.3.2.cmml"><mi id="S2.Ex1.m1.2.2.2.1.1.1.3.2.2" xref="S2.Ex1.m1.2.2.2.1.1.1.3.2.2.cmml">c</mi><mi id="S2.Ex1.m1.2.2.2.1.1.1.3.2.3" xref="S2.Ex1.m1.2.2.2.1.1.1.3.2.3.cmml">z</mi></msub><mo id="S2.Ex1.m1.2.2.2.1.1.1.3.1" xref="S2.Ex1.m1.2.2.2.1.1.1.3.1.cmml">+</mo><mi id="S2.Ex1.m1.2.2.2.1.1.1.3.3" xref="S2.Ex1.m1.2.2.2.1.1.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.Ex1.m1.2.2.2.1.1.1.1" xref="S2.Ex1.m1.2.2.2.1.1.1.1.cmml"><mi id="S2.Ex1.m1.2.2.2.1.1.1.1.3" xref="S2.Ex1.m1.2.2.2.1.1.1.1.3.cmml">m</mi><mo id="S2.Ex1.m1.2.2.2.1.1.1.1.2" xref="S2.Ex1.m1.2.2.2.1.1.1.1.2.cmml">â¢</mo><mi id="S2.Ex1.m1.2.2.2.1.1.1.1.4" xref="S2.Ex1.m1.2.2.2.1.1.1.1.4.cmml">a</mi><mo id="S2.Ex1.m1.2.2.2.1.1.1.1.2a" xref="S2.Ex1.m1.2.2.2.1.1.1.1.2.cmml">â¢</mo><mi id="S2.Ex1.m1.2.2.2.1.1.1.1.5" xref="S2.Ex1.m1.2.2.2.1.1.1.1.5.cmml">x</mi><mo id="S2.Ex1.m1.2.2.2.1.1.1.1.2b" xref="S2.Ex1.m1.2.2.2.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></msup></mfrac><mo id="S2.Ex1.m1.3.3.1.1.1" xref="S2.Ex1.m1.3.3.1.1.1.cmml">=</mo><mfrac id="S2.Ex1.m1.3.3.1.1.2" xref="S2.Ex1.m1.3.3.1.1.2.cmml"><msup id="S2.Ex1.m1.3.3.1.1.2.2" xref="S2.Ex1.m1.3.3.1.1.2.2.cmml"><mi id="S2.Ex1.m1.3.3.1.1.2.2.2" xref="S2.Ex1.m1.3.3.1.1.2.2.2.cmml">e</mi><msub id="S2.Ex1.m1.3.3.1.1.2.2.3" xref="S2.Ex1.m1.3.3.1.1.2.2.3.cmml"><mi id="S2.Ex1.m1.3.3.1.1.2.2.3.2" xref="S2.Ex1.m1.3.3.1.1.2.2.3.2.cmml">y</mi><mi id="S2.Ex1.m1.3.3.1.1.2.2.3.3" xref="S2.Ex1.m1.3.3.1.1.2.2.3.3.cmml">j</mi></msub></msup><mrow id="S2.Ex1.m1.3.3.1.1.2.3" xref="S2.Ex1.m1.3.3.1.1.2.3.cmml"><msubsup id="S2.Ex1.m1.3.3.1.1.2.3.1" xref="S2.Ex1.m1.3.3.1.1.2.3.1.cmml"><mo id="S2.Ex1.m1.3.3.1.1.2.3.1.2.2" xref="S2.Ex1.m1.3.3.1.1.2.3.1.2.2.cmml">âˆ‘</mo><mrow id="S2.Ex1.m1.3.3.1.1.2.3.1.2.3" xref="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.cmml"><mi id="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.2" xref="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.2.cmml">z</mi><mo id="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.1" xref="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.1.cmml">=</mo><mn id="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.3" xref="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.Ex1.m1.3.3.1.1.2.3.1.3" xref="S2.Ex1.m1.3.3.1.1.2.3.1.3.cmml">N</mi></msubsup><msup id="S2.Ex1.m1.3.3.1.1.2.3.2" xref="S2.Ex1.m1.3.3.1.1.2.3.2.cmml"><mi id="S2.Ex1.m1.3.3.1.1.2.3.2.2" xref="S2.Ex1.m1.3.3.1.1.2.3.2.2.cmml">e</mi><msub id="S2.Ex1.m1.3.3.1.1.2.3.2.3" xref="S2.Ex1.m1.3.3.1.1.2.3.2.3.cmml"><mi id="S2.Ex1.m1.3.3.1.1.2.3.2.3.2" xref="S2.Ex1.m1.3.3.1.1.2.3.2.3.2.cmml">y</mi><mi id="S2.Ex1.m1.3.3.1.1.2.3.2.3.3" xref="S2.Ex1.m1.3.3.1.1.2.3.2.3.3.cmml">z</mi></msub></msup></mrow></mfrac></mrow><mo id="S2.Ex1.m1.3.3.1.2" lspace="0em" xref="S2.Ex1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.3b"><apply id="S2.Ex1.m1.3.3.1.1.cmml" xref="S2.Ex1.m1.3.3.1"><eq id="S2.Ex1.m1.3.3.1.1.1.cmml" xref="S2.Ex1.m1.3.3.1.1.1"></eq><apply id="S2.Ex1.m1.2.2.cmml" xref="S2.Ex1.m1.2.2"><divide id="S2.Ex1.m1.2.2.3.cmml" xref="S2.Ex1.m1.2.2"></divide><apply id="S2.Ex1.m1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1">superscript</csymbol><ci id="S2.Ex1.m1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.3">ğ‘’</ci><apply id="S2.Ex1.m1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1"><ln id="S2.Ex1.m1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.2"></ln><apply id="S2.Ex1.m1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1"><divide id="S2.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1"></divide><apply id="S2.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3"><plus id="S2.Ex1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.1"></plus><apply id="S2.Ex1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.Ex1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.2">ğ‘</ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.2.3">ğ‘—</ci></apply><ci id="S2.Ex1.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.3.3">italic-Ïµ</ci></apply><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1"><times id="S2.Ex1.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.2"></times><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.3">ğ‘š</ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.4.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.4">ğ‘</ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.5.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.5">ğ‘¥</ci><apply id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1"><plus id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.2">ğ¶</ci><ci id="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.1.1.1.1.1.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply></apply></apply><apply id="S2.Ex1.m1.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.2">superscript</csymbol><ci id="S2.Ex1.m1.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.2.3">ğ‘’</ci><apply id="S2.Ex1.m1.2.2.2.1.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1"><times id="S2.Ex1.m1.2.2.2.1.1.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.2"></times><ln id="S2.Ex1.m1.2.2.2.1.1.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.3"></ln><apply id="S2.Ex1.m1.2.2.2.1.1.4.cmml" xref="S2.Ex1.m1.2.2.2.1.1.4"><apply id="S2.Ex1.m1.2.2.2.1.1.4.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.4.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.1.1.4.1.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.4.1">superscript</csymbol><apply id="S2.Ex1.m1.2.2.2.1.1.4.1.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.4.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.1.1.4.1.2.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.4.1">subscript</csymbol><sum id="S2.Ex1.m1.2.2.2.1.1.4.1.2.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.4.1.2.2"></sum><apply id="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.4.1.2.3"><eq id="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.1"></eq><ci id="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.2">ğ‘§</ci><cn id="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.3.cmml" type="integer" xref="S2.Ex1.m1.2.2.2.1.1.4.1.2.3.3">1</cn></apply></apply><ci id="S2.Ex1.m1.2.2.2.1.1.4.1.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.4.1.3">ğ‘</ci></apply><apply id="S2.Ex1.m1.2.2.2.1.1.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1"><divide id="S2.Ex1.m1.2.2.2.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1"></divide><apply id="S2.Ex1.m1.2.2.2.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3"><plus id="S2.Ex1.m1.2.2.2.1.1.1.3.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3.1"></plus><apply id="S2.Ex1.m1.2.2.2.1.1.1.3.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.2.1.1.1.3.2.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3.2">subscript</csymbol><ci id="S2.Ex1.m1.2.2.2.1.1.1.3.2.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3.2.2">ğ‘</ci><ci id="S2.Ex1.m1.2.2.2.1.1.1.3.2.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3.2.3">ğ‘§</ci></apply><ci id="S2.Ex1.m1.2.2.2.1.1.1.3.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.3.3">italic-Ïµ</ci></apply><apply id="S2.Ex1.m1.2.2.2.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.1"><times id="S2.Ex1.m1.2.2.2.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.1.2"></times><ci id="S2.Ex1.m1.2.2.2.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.1.3">ğ‘š</ci><ci id="S2.Ex1.m1.2.2.2.1.1.1.1.4.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.1.4">ğ‘</ci><ci id="S2.Ex1.m1.2.2.2.1.1.1.1.5.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.1.5">ğ‘¥</ci><apply id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1"><plus id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.1"></plus><ci id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.2">ğ¶</ci><ci id="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.2.1.1.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S2.Ex1.m1.3.3.1.1.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2"><divide id="S2.Ex1.m1.3.3.1.1.2.1.cmml" xref="S2.Ex1.m1.3.3.1.1.2"></divide><apply id="S2.Ex1.m1.3.3.1.1.2.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.2.2.1.cmml" xref="S2.Ex1.m1.3.3.1.1.2.2">superscript</csymbol><ci id="S2.Ex1.m1.3.3.1.1.2.2.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2.2.2">ğ‘’</ci><apply id="S2.Ex1.m1.3.3.1.1.2.2.3.cmml" xref="S2.Ex1.m1.3.3.1.1.2.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.2.2.3.1.cmml" xref="S2.Ex1.m1.3.3.1.1.2.2.3">subscript</csymbol><ci id="S2.Ex1.m1.3.3.1.1.2.2.3.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2.2.3.2">ğ‘¦</ci><ci id="S2.Ex1.m1.3.3.1.1.2.2.3.3.cmml" xref="S2.Ex1.m1.3.3.1.1.2.2.3.3">ğ‘—</ci></apply></apply><apply id="S2.Ex1.m1.3.3.1.1.2.3.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3"><apply id="S2.Ex1.m1.3.3.1.1.2.3.1.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.2.3.1.1.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.1">superscript</csymbol><apply id="S2.Ex1.m1.3.3.1.1.2.3.1.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.2.3.1.2.1.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.1">subscript</csymbol><sum id="S2.Ex1.m1.3.3.1.1.2.3.1.2.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.1.2.2"></sum><apply id="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.1.2.3"><eq id="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.1.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.1"></eq><ci id="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.2">ğ‘§</ci><cn id="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.3.cmml" type="integer" xref="S2.Ex1.m1.3.3.1.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S2.Ex1.m1.3.3.1.1.2.3.1.3.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.1.3">ğ‘</ci></apply><apply id="S2.Ex1.m1.3.3.1.1.2.3.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.2.3.2.1.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.2">superscript</csymbol><ci id="S2.Ex1.m1.3.3.1.1.2.3.2.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.2.2">ğ‘’</ci><apply id="S2.Ex1.m1.3.3.1.1.2.3.2.3.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.3.3.1.1.2.3.2.3.1.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.2.3">subscript</csymbol><ci id="S2.Ex1.m1.3.3.1.1.2.3.2.3.2.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.2.3.2">ğ‘¦</ci><ci id="S2.Ex1.m1.3.3.1.1.2.3.2.3.3.cmml" xref="S2.Ex1.m1.3.3.1.1.2.3.2.3.3">ğ‘§</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.3c">\frac{e^{\ln{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}}}{e^{\ln{\sum_{z=1}^{N}%
\frac{c_{z}+\epsilon}{max(C+\epsilon)}}}}=\frac{e^{y_{j}}}{\sum_{z=1}^{N}e^{y_%
{z}}}.</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.3d">divide start_ARG italic_e start_POSTSUPERSCRIPT roman_ln divide start_ARG italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_POSTSUPERSCRIPT end_ARG start_ARG italic_e start_POSTSUPERSCRIPT roman_ln âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG italic_c start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_POSTSUPERSCRIPT end_ARG = divide start_ARG italic_e start_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_e start_POSTSUPERSCRIPT italic_y start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p6.6">Therefore we can formulate the personalized popularity score of the item <math alttext="j" class="ltx_Math" display="inline" id="S2.p6.6.m1.1"><semantics id="S2.p6.6.m1.1a"><mi id="S2.p6.6.m1.1.1" xref="S2.p6.6.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p6.6.m1.1b"><ci id="S2.p6.6.m1.1.1.cmml" xref="S2.p6.6.m1.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.6.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p6.6.m1.1d">italic_j</annotation></semantics></math> for BERT4Rec as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="y_{j}=\ln{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}." class="ltx_Math" display="block" id="S2.E7.m1.2"><semantics id="S2.E7.m1.2a"><mrow id="S2.E7.m1.2.2.1" xref="S2.E7.m1.2.2.1.1.cmml"><mrow id="S2.E7.m1.2.2.1.1" xref="S2.E7.m1.2.2.1.1.cmml"><msub id="S2.E7.m1.2.2.1.1.2" xref="S2.E7.m1.2.2.1.1.2.cmml"><mi id="S2.E7.m1.2.2.1.1.2.2" xref="S2.E7.m1.2.2.1.1.2.2.cmml">y</mi><mi id="S2.E7.m1.2.2.1.1.2.3" xref="S2.E7.m1.2.2.1.1.2.3.cmml">j</mi></msub><mo id="S2.E7.m1.2.2.1.1.1" xref="S2.E7.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E7.m1.2.2.1.1.3" xref="S2.E7.m1.2.2.1.1.3.cmml"><mi id="S2.E7.m1.2.2.1.1.3.1" xref="S2.E7.m1.2.2.1.1.3.1.cmml">ln</mi><mo id="S2.E7.m1.2.2.1.1.3a" lspace="0.167em" xref="S2.E7.m1.2.2.1.1.3.cmml">â¡</mo><mfrac id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml"><mrow id="S2.E7.m1.1.1.3" xref="S2.E7.m1.1.1.3.cmml"><msub id="S2.E7.m1.1.1.3.2" xref="S2.E7.m1.1.1.3.2.cmml"><mi id="S2.E7.m1.1.1.3.2.2" xref="S2.E7.m1.1.1.3.2.2.cmml">c</mi><mi id="S2.E7.m1.1.1.3.2.3" xref="S2.E7.m1.1.1.3.2.3.cmml">j</mi></msub><mo id="S2.E7.m1.1.1.3.1" xref="S2.E7.m1.1.1.3.1.cmml">+</mo><mi id="S2.E7.m1.1.1.3.3" xref="S2.E7.m1.1.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E7.m1.1.1.1" xref="S2.E7.m1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.3" xref="S2.E7.m1.1.1.1.3.cmml">m</mi><mo id="S2.E7.m1.1.1.1.2" xref="S2.E7.m1.1.1.1.2.cmml">â¢</mo><mi id="S2.E7.m1.1.1.1.4" xref="S2.E7.m1.1.1.1.4.cmml">a</mi><mo id="S2.E7.m1.1.1.1.2a" xref="S2.E7.m1.1.1.1.2.cmml">â¢</mo><mi id="S2.E7.m1.1.1.1.5" xref="S2.E7.m1.1.1.1.5.cmml">x</mi><mo id="S2.E7.m1.1.1.1.2b" xref="S2.E7.m1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E7.m1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mo id="S2.E7.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E7.m1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E7.m1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E7.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S2.E7.m1.2.2.1.2" lspace="0em" xref="S2.E7.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.2b"><apply id="S2.E7.m1.2.2.1.1.cmml" xref="S2.E7.m1.2.2.1"><eq id="S2.E7.m1.2.2.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.1"></eq><apply id="S2.E7.m1.2.2.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.1.1.2.1.cmml" xref="S2.E7.m1.2.2.1.1.2">subscript</csymbol><ci id="S2.E7.m1.2.2.1.1.2.2.cmml" xref="S2.E7.m1.2.2.1.1.2.2">ğ‘¦</ci><ci id="S2.E7.m1.2.2.1.1.2.3.cmml" xref="S2.E7.m1.2.2.1.1.2.3">ğ‘—</ci></apply><apply id="S2.E7.m1.2.2.1.1.3.cmml" xref="S2.E7.m1.2.2.1.1.3"><ln id="S2.E7.m1.2.2.1.1.3.1.cmml" xref="S2.E7.m1.2.2.1.1.3.1"></ln><apply id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1"><divide id="S2.E7.m1.1.1.2.cmml" xref="S2.E7.m1.1.1"></divide><apply id="S2.E7.m1.1.1.3.cmml" xref="S2.E7.m1.1.1.3"><plus id="S2.E7.m1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.3.1"></plus><apply id="S2.E7.m1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.3.2.1.cmml" xref="S2.E7.m1.1.1.3.2">subscript</csymbol><ci id="S2.E7.m1.1.1.3.2.2.cmml" xref="S2.E7.m1.1.1.3.2.2">ğ‘</ci><ci id="S2.E7.m1.1.1.3.2.3.cmml" xref="S2.E7.m1.1.1.3.2.3">ğ‘—</ci></apply><ci id="S2.E7.m1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E7.m1.1.1.1.cmml" xref="S2.E7.m1.1.1.1"><times id="S2.E7.m1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.2"></times><ci id="S2.E7.m1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.3">ğ‘š</ci><ci id="S2.E7.m1.1.1.1.4.cmml" xref="S2.E7.m1.1.1.1.4">ğ‘</ci><ci id="S2.E7.m1.1.1.1.5.cmml" xref="S2.E7.m1.1.1.1.5">ğ‘¥</ci><apply id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1"><plus id="S2.E7.m1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1"></plus><ci id="S2.E7.m1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E7.m1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.2c">y_{j}=\ln{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.2d">italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = roman_ln divide start_ARG italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.p7">
<p class="ltx_p" id="S2.p7.5">To integrate personalized popularity score into the BERT4Rec model, starting from the user input sequence <math alttext="S" class="ltx_Math" display="inline" id="S2.p7.1.m1.1"><semantics id="S2.p7.1.m1.1a"><mi id="S2.p7.1.m1.1.1" xref="S2.p7.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.p7.1.m1.1b"><ci id="S2.p7.1.m1.1.1.cmml" xref="S2.p7.1.m1.1.1">ğ‘†</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.1.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.p7.1.m1.1d">italic_S</annotation></semantics></math>, we compute the personalized popularity scores vector <math alttext="P=[y_{1},\ldots,y_{j}," class="ltx_math_unparsed" display="inline" id="S2.p7.2.m2.1"><semantics id="S2.p7.2.m2.1a"><mrow id="S2.p7.2.m2.1b"><mi id="S2.p7.2.m2.1.2">P</mi><mo id="S2.p7.2.m2.1.3">=</mo><mrow id="S2.p7.2.m2.1.4"><mo id="S2.p7.2.m2.1.4.1" stretchy="false">[</mo><msub id="S2.p7.2.m2.1.4.2"><mi id="S2.p7.2.m2.1.4.2.2">y</mi><mn id="S2.p7.2.m2.1.4.2.3">1</mn></msub><mo id="S2.p7.2.m2.1.4.3">,</mo><mi id="S2.p7.2.m2.1.1" mathvariant="normal">â€¦</mi><mo id="S2.p7.2.m2.1.4.4">,</mo><msub id="S2.p7.2.m2.1.4.5"><mi id="S2.p7.2.m2.1.4.5.2">y</mi><mi id="S2.p7.2.m2.1.4.5.3">j</mi></msub><mo id="S2.p7.2.m2.1.4.6">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.p7.2.m2.1c">P=[y_{1},\ldots,y_{j},</annotation><annotation encoding="application/x-llamapun" id="S2.p7.2.m2.1d">italic_P = [ italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ,</annotation></semantics></math> <math alttext="\ldots,y_{N}]" class="ltx_math_unparsed" display="inline" id="S2.p7.3.m3.1"><semantics id="S2.p7.3.m3.1a"><mrow id="S2.p7.3.m3.1b"><mi id="S2.p7.3.m3.1.1" mathvariant="normal">â€¦</mi><mo id="S2.p7.3.m3.1.2">,</mo><msub id="S2.p7.3.m3.1.3"><mi id="S2.p7.3.m3.1.3.2">y</mi><mi id="S2.p7.3.m3.1.3.3">N</mi></msub><mo id="S2.p7.3.m3.1.4" stretchy="false">]</mo></mrow><annotation encoding="application/x-tex" id="S2.p7.3.m3.1c">\ldots,y_{N}]</annotation><annotation encoding="application/x-llamapun" id="S2.p7.3.m3.1d">â€¦ , italic_y start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ]</annotation></semantics></math>, and sum it to each scores vector <math alttext="L_{i}" class="ltx_Math" display="inline" id="S2.p7.4.m4.1"><semantics id="S2.p7.4.m4.1a"><msub id="S2.p7.4.m4.1.1" xref="S2.p7.4.m4.1.1.cmml"><mi id="S2.p7.4.m4.1.1.2" xref="S2.p7.4.m4.1.1.2.cmml">L</mi><mi id="S2.p7.4.m4.1.1.3" xref="S2.p7.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p7.4.m4.1b"><apply id="S2.p7.4.m4.1.1.cmml" xref="S2.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p7.4.m4.1.1.1.cmml" xref="S2.p7.4.m4.1.1">subscript</csymbol><ci id="S2.p7.4.m4.1.1.2.cmml" xref="S2.p7.4.m4.1.1.2">ğ¿</ci><ci id="S2.p7.4.m4.1.1.3.cmml" xref="S2.p7.4.m4.1.1.3">ğ‘–</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.4.m4.1c">L_{i}</annotation><annotation encoding="application/x-llamapun" id="S2.p7.4.m4.1d">italic_L start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> obtained from BERT4Rec, where <math alttext="i" class="ltx_Math" display="inline" id="S2.p7.5.m5.1"><semantics id="S2.p7.5.m5.1a"><mi id="S2.p7.5.m5.1.1" xref="S2.p7.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p7.5.m5.1b"><ci id="S2.p7.5.m5.1.1.cmml" xref="S2.p7.5.m5.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.5.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p7.5.m5.1d">italic_i</annotation></semantics></math> is the position in the sequence.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p8">
<p class="ltx_p" id="S2.p8.3"><span class="ltx_text ltx_font_bold" id="S2.p8.3.1">Using Personalized Popularity in a Sigmoid.</span>

In SASRec (and gSASRec), the probability of an item <math alttext="j" class="ltx_Math" display="inline" id="S2.p8.1.m1.1"><semantics id="S2.p8.1.m1.1a"><mi id="S2.p8.1.m1.1.1" xref="S2.p8.1.m1.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p8.1.m1.1b"><ci id="S2.p8.1.m1.1.1.cmml" xref="S2.p8.1.m1.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.1.m1.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p8.1.m1.1d">italic_j</annotation></semantics></math> is obtained using the sigmoid function. Consequently, the personalized popularity score <math alttext="y_{j}" class="ltx_Math" display="inline" id="S2.p8.2.m2.1"><semantics id="S2.p8.2.m2.1a"><msub id="S2.p8.2.m2.1.1" xref="S2.p8.2.m2.1.1.cmml"><mi id="S2.p8.2.m2.1.1.2" xref="S2.p8.2.m2.1.1.2.cmml">y</mi><mi id="S2.p8.2.m2.1.1.3" xref="S2.p8.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p8.2.m2.1b"><apply id="S2.p8.2.m2.1.1.cmml" xref="S2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p8.2.m2.1.1.1.cmml" xref="S2.p8.2.m2.1.1">subscript</csymbol><ci id="S2.p8.2.m2.1.1.2.cmml" xref="S2.p8.2.m2.1.1.2">ğ‘¦</ci><ci id="S2.p8.2.m2.1.1.3.cmml" xref="S2.p8.2.m2.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.2.m2.1c">y_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.p8.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> of an item <math alttext="j" class="ltx_Math" display="inline" id="S2.p8.3.m3.1"><semantics id="S2.p8.3.m3.1a"><mi id="S2.p8.3.m3.1.1" xref="S2.p8.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p8.3.m3.1b"><ci id="S2.p8.3.m3.1.1.cmml" xref="S2.p8.3.m3.1.1">ğ‘—</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p8.3.m3.1d">italic_j</annotation></semantics></math> is the additive inverse of the exponent value in the sigmoid formula (Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E2" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">2</span></a>)). Combining Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E2" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">2</span></a>) with Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E4" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">4</span></a>) gives:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{p}_{P}(j)=\frac{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}{\sum_{z=1}^{N}%
\frac{c_{z}+\epsilon}{max(C+\epsilon)}}=\frac{1}{1+e^{-y_{j}}}." class="ltx_Math" display="block" id="S2.E8.m1.4"><semantics id="S2.E8.m1.4a"><mrow id="S2.E8.m1.4.4.1" xref="S2.E8.m1.4.4.1.1.cmml"><mrow id="S2.E8.m1.4.4.1.1" xref="S2.E8.m1.4.4.1.1.cmml"><mrow id="S2.E8.m1.4.4.1.1.2" xref="S2.E8.m1.4.4.1.1.2.cmml"><msub id="S2.E8.m1.4.4.1.1.2.2" xref="S2.E8.m1.4.4.1.1.2.2.cmml"><mover accent="true" id="S2.E8.m1.4.4.1.1.2.2.2" xref="S2.E8.m1.4.4.1.1.2.2.2.cmml"><mi id="S2.E8.m1.4.4.1.1.2.2.2.2" xref="S2.E8.m1.4.4.1.1.2.2.2.2.cmml">p</mi><mo id="S2.E8.m1.4.4.1.1.2.2.2.1" xref="S2.E8.m1.4.4.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S2.E8.m1.4.4.1.1.2.2.3" xref="S2.E8.m1.4.4.1.1.2.2.3.cmml">P</mi></msub><mo id="S2.E8.m1.4.4.1.1.2.1" xref="S2.E8.m1.4.4.1.1.2.1.cmml">â¢</mo><mrow id="S2.E8.m1.4.4.1.1.2.3.2" xref="S2.E8.m1.4.4.1.1.2.cmml"><mo id="S2.E8.m1.4.4.1.1.2.3.2.1" stretchy="false" xref="S2.E8.m1.4.4.1.1.2.cmml">(</mo><mi id="S2.E8.m1.3.3" xref="S2.E8.m1.3.3.cmml">j</mi><mo id="S2.E8.m1.4.4.1.1.2.3.2.2" stretchy="false" xref="S2.E8.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E8.m1.4.4.1.1.3" xref="S2.E8.m1.4.4.1.1.3.cmml">=</mo><mfrac id="S2.E8.m1.2.2" xref="S2.E8.m1.2.2.cmml"><mfrac id="S2.E8.m1.1.1.1" xref="S2.E8.m1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.3" xref="S2.E8.m1.1.1.1.3.cmml"><msub id="S2.E8.m1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.3.2.cmml"><mi id="S2.E8.m1.1.1.1.3.2.2" xref="S2.E8.m1.1.1.1.3.2.2.cmml">c</mi><mi id="S2.E8.m1.1.1.1.3.2.3" xref="S2.E8.m1.1.1.1.3.2.3.cmml">j</mi></msub><mo id="S2.E8.m1.1.1.1.3.1" xref="S2.E8.m1.1.1.1.3.1.cmml">+</mo><mi id="S2.E8.m1.1.1.1.3.3" xref="S2.E8.m1.1.1.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E8.m1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.cmml"><mi id="S2.E8.m1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.3.cmml">m</mi><mo id="S2.E8.m1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E8.m1.1.1.1.1.1.4" xref="S2.E8.m1.1.1.1.1.1.4.cmml">a</mi><mo id="S2.E8.m1.1.1.1.1.1.2a" xref="S2.E8.m1.1.1.1.1.1.2.cmml">â¢</mo><mi id="S2.E8.m1.1.1.1.1.1.5" xref="S2.E8.m1.1.1.1.1.1.5.cmml">x</mi><mo id="S2.E8.m1.1.1.1.1.1.2b" xref="S2.E8.m1.1.1.1.1.1.2.cmml">â¢</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E8.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E8.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E8.m1.1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E8.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E8.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mrow id="S2.E8.m1.2.2.2" xref="S2.E8.m1.2.2.2.cmml"><msubsup id="S2.E8.m1.2.2.2.2" xref="S2.E8.m1.2.2.2.2.cmml"><mo id="S2.E8.m1.2.2.2.2.2.2" xref="S2.E8.m1.2.2.2.2.2.2.cmml">âˆ‘</mo><mrow id="S2.E8.m1.2.2.2.2.2.3" xref="S2.E8.m1.2.2.2.2.2.3.cmml"><mi id="S2.E8.m1.2.2.2.2.2.3.2" xref="S2.E8.m1.2.2.2.2.2.3.2.cmml">z</mi><mo id="S2.E8.m1.2.2.2.2.2.3.1" xref="S2.E8.m1.2.2.2.2.2.3.1.cmml">=</mo><mn id="S2.E8.m1.2.2.2.2.2.3.3" xref="S2.E8.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E8.m1.2.2.2.2.3" xref="S2.E8.m1.2.2.2.2.3.cmml">N</mi></msubsup><mfrac id="S2.E8.m1.2.2.2.1" xref="S2.E8.m1.2.2.2.1.cmml"><mrow id="S2.E8.m1.2.2.2.1.3" xref="S2.E8.m1.2.2.2.1.3.cmml"><msub id="S2.E8.m1.2.2.2.1.3.2" xref="S2.E8.m1.2.2.2.1.3.2.cmml"><mi id="S2.E8.m1.2.2.2.1.3.2.2" xref="S2.E8.m1.2.2.2.1.3.2.2.cmml">c</mi><mi id="S2.E8.m1.2.2.2.1.3.2.3" xref="S2.E8.m1.2.2.2.1.3.2.3.cmml">z</mi></msub><mo id="S2.E8.m1.2.2.2.1.3.1" xref="S2.E8.m1.2.2.2.1.3.1.cmml">+</mo><mi id="S2.E8.m1.2.2.2.1.3.3" xref="S2.E8.m1.2.2.2.1.3.3.cmml">Ïµ</mi></mrow><mrow id="S2.E8.m1.2.2.2.1.1" xref="S2.E8.m1.2.2.2.1.1.cmml"><mi id="S2.E8.m1.2.2.2.1.1.3" xref="S2.E8.m1.2.2.2.1.1.3.cmml">m</mi><mo id="S2.E8.m1.2.2.2.1.1.2" xref="S2.E8.m1.2.2.2.1.1.2.cmml">â¢</mo><mi id="S2.E8.m1.2.2.2.1.1.4" xref="S2.E8.m1.2.2.2.1.1.4.cmml">a</mi><mo id="S2.E8.m1.2.2.2.1.1.2a" xref="S2.E8.m1.2.2.2.1.1.2.cmml">â¢</mo><mi id="S2.E8.m1.2.2.2.1.1.5" xref="S2.E8.m1.2.2.2.1.1.5.cmml">x</mi><mo id="S2.E8.m1.2.2.2.1.1.2b" xref="S2.E8.m1.2.2.2.1.1.2.cmml">â¢</mo><mrow id="S2.E8.m1.2.2.2.1.1.1.1" xref="S2.E8.m1.2.2.2.1.1.1.1.1.cmml"><mo id="S2.E8.m1.2.2.2.1.1.1.1.2" stretchy="false" xref="S2.E8.m1.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S2.E8.m1.2.2.2.1.1.1.1.1" xref="S2.E8.m1.2.2.2.1.1.1.1.1.cmml"><mi id="S2.E8.m1.2.2.2.1.1.1.1.1.2" xref="S2.E8.m1.2.2.2.1.1.1.1.1.2.cmml">C</mi><mo id="S2.E8.m1.2.2.2.1.1.1.1.1.1" xref="S2.E8.m1.2.2.2.1.1.1.1.1.1.cmml">+</mo><mi id="S2.E8.m1.2.2.2.1.1.1.1.1.3" xref="S2.E8.m1.2.2.2.1.1.1.1.1.3.cmml">Ïµ</mi></mrow><mo id="S2.E8.m1.2.2.2.1.1.1.1.3" stretchy="false" xref="S2.E8.m1.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mfrac><mo id="S2.E8.m1.4.4.1.1.4" xref="S2.E8.m1.4.4.1.1.4.cmml">=</mo><mfrac id="S2.E8.m1.4.4.1.1.5" xref="S2.E8.m1.4.4.1.1.5.cmml"><mn id="S2.E8.m1.4.4.1.1.5.2" xref="S2.E8.m1.4.4.1.1.5.2.cmml">1</mn><mrow id="S2.E8.m1.4.4.1.1.5.3" xref="S2.E8.m1.4.4.1.1.5.3.cmml"><mn id="S2.E8.m1.4.4.1.1.5.3.2" xref="S2.E8.m1.4.4.1.1.5.3.2.cmml">1</mn><mo id="S2.E8.m1.4.4.1.1.5.3.1" xref="S2.E8.m1.4.4.1.1.5.3.1.cmml">+</mo><msup id="S2.E8.m1.4.4.1.1.5.3.3" xref="S2.E8.m1.4.4.1.1.5.3.3.cmml"><mi id="S2.E8.m1.4.4.1.1.5.3.3.2" xref="S2.E8.m1.4.4.1.1.5.3.3.2.cmml">e</mi><mrow id="S2.E8.m1.4.4.1.1.5.3.3.3" xref="S2.E8.m1.4.4.1.1.5.3.3.3.cmml"><mo id="S2.E8.m1.4.4.1.1.5.3.3.3a" xref="S2.E8.m1.4.4.1.1.5.3.3.3.cmml">âˆ’</mo><msub id="S2.E8.m1.4.4.1.1.5.3.3.3.2" xref="S2.E8.m1.4.4.1.1.5.3.3.3.2.cmml"><mi id="S2.E8.m1.4.4.1.1.5.3.3.3.2.2" xref="S2.E8.m1.4.4.1.1.5.3.3.3.2.2.cmml">y</mi><mi id="S2.E8.m1.4.4.1.1.5.3.3.3.2.3" xref="S2.E8.m1.4.4.1.1.5.3.3.3.2.3.cmml">j</mi></msub></mrow></msup></mrow></mfrac></mrow><mo id="S2.E8.m1.4.4.1.2" lspace="0em" xref="S2.E8.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.4b"><apply id="S2.E8.m1.4.4.1.1.cmml" xref="S2.E8.m1.4.4.1"><and id="S2.E8.m1.4.4.1.1a.cmml" xref="S2.E8.m1.4.4.1"></and><apply id="S2.E8.m1.4.4.1.1b.cmml" xref="S2.E8.m1.4.4.1"><eq id="S2.E8.m1.4.4.1.1.3.cmml" xref="S2.E8.m1.4.4.1.1.3"></eq><apply id="S2.E8.m1.4.4.1.1.2.cmml" xref="S2.E8.m1.4.4.1.1.2"><times id="S2.E8.m1.4.4.1.1.2.1.cmml" xref="S2.E8.m1.4.4.1.1.2.1"></times><apply id="S2.E8.m1.4.4.1.1.2.2.cmml" xref="S2.E8.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.1.1.2.2.1.cmml" xref="S2.E8.m1.4.4.1.1.2.2">subscript</csymbol><apply id="S2.E8.m1.4.4.1.1.2.2.2.cmml" xref="S2.E8.m1.4.4.1.1.2.2.2"><ci id="S2.E8.m1.4.4.1.1.2.2.2.1.cmml" xref="S2.E8.m1.4.4.1.1.2.2.2.1">^</ci><ci id="S2.E8.m1.4.4.1.1.2.2.2.2.cmml" xref="S2.E8.m1.4.4.1.1.2.2.2.2">ğ‘</ci></apply><ci id="S2.E8.m1.4.4.1.1.2.2.3.cmml" xref="S2.E8.m1.4.4.1.1.2.2.3">ğ‘ƒ</ci></apply><ci id="S2.E8.m1.3.3.cmml" xref="S2.E8.m1.3.3">ğ‘—</ci></apply><apply id="S2.E8.m1.2.2.cmml" xref="S2.E8.m1.2.2"><divide id="S2.E8.m1.2.2.3.cmml" xref="S2.E8.m1.2.2"></divide><apply id="S2.E8.m1.1.1.1.cmml" xref="S2.E8.m1.1.1.1"><divide id="S2.E8.m1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1"></divide><apply id="S2.E8.m1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.3"><plus id="S2.E8.m1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.3.1"></plus><apply id="S2.E8.m1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.3.2.1.cmml" xref="S2.E8.m1.1.1.1.3.2">subscript</csymbol><ci id="S2.E8.m1.1.1.1.3.2.2.cmml" xref="S2.E8.m1.1.1.1.3.2.2">ğ‘</ci><ci id="S2.E8.m1.1.1.1.3.2.3.cmml" xref="S2.E8.m1.1.1.1.3.2.3">ğ‘—</ci></apply><ci id="S2.E8.m1.1.1.1.3.3.cmml" xref="S2.E8.m1.1.1.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1"><times id="S2.E8.m1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.2"></times><ci id="S2.E8.m1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.3">ğ‘š</ci><ci id="S2.E8.m1.1.1.1.1.1.4.cmml" xref="S2.E8.m1.1.1.1.1.1.4">ğ‘</ci><ci id="S2.E8.m1.1.1.1.1.1.5.cmml" xref="S2.E8.m1.1.1.1.1.1.5">ğ‘¥</ci><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1"><plus id="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply><apply id="S2.E8.m1.2.2.2.cmml" xref="S2.E8.m1.2.2.2"><apply id="S2.E8.m1.2.2.2.2.cmml" xref="S2.E8.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.2.1.cmml" xref="S2.E8.m1.2.2.2.2">superscript</csymbol><apply id="S2.E8.m1.2.2.2.2.2.cmml" xref="S2.E8.m1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.2.2.1.cmml" xref="S2.E8.m1.2.2.2.2">subscript</csymbol><sum id="S2.E8.m1.2.2.2.2.2.2.cmml" xref="S2.E8.m1.2.2.2.2.2.2"></sum><apply id="S2.E8.m1.2.2.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.2.2.3"><eq id="S2.E8.m1.2.2.2.2.2.3.1.cmml" xref="S2.E8.m1.2.2.2.2.2.3.1"></eq><ci id="S2.E8.m1.2.2.2.2.2.3.2.cmml" xref="S2.E8.m1.2.2.2.2.2.3.2">ğ‘§</ci><cn id="S2.E8.m1.2.2.2.2.2.3.3.cmml" type="integer" xref="S2.E8.m1.2.2.2.2.2.3.3">1</cn></apply></apply><ci id="S2.E8.m1.2.2.2.2.3.cmml" xref="S2.E8.m1.2.2.2.2.3">ğ‘</ci></apply><apply id="S2.E8.m1.2.2.2.1.cmml" xref="S2.E8.m1.2.2.2.1"><divide id="S2.E8.m1.2.2.2.1.2.cmml" xref="S2.E8.m1.2.2.2.1"></divide><apply id="S2.E8.m1.2.2.2.1.3.cmml" xref="S2.E8.m1.2.2.2.1.3"><plus id="S2.E8.m1.2.2.2.1.3.1.cmml" xref="S2.E8.m1.2.2.2.1.3.1"></plus><apply id="S2.E8.m1.2.2.2.1.3.2.cmml" xref="S2.E8.m1.2.2.2.1.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.2.2.2.1.3.2.1.cmml" xref="S2.E8.m1.2.2.2.1.3.2">subscript</csymbol><ci id="S2.E8.m1.2.2.2.1.3.2.2.cmml" xref="S2.E8.m1.2.2.2.1.3.2.2">ğ‘</ci><ci id="S2.E8.m1.2.2.2.1.3.2.3.cmml" xref="S2.E8.m1.2.2.2.1.3.2.3">ğ‘§</ci></apply><ci id="S2.E8.m1.2.2.2.1.3.3.cmml" xref="S2.E8.m1.2.2.2.1.3.3">italic-Ïµ</ci></apply><apply id="S2.E8.m1.2.2.2.1.1.cmml" xref="S2.E8.m1.2.2.2.1.1"><times id="S2.E8.m1.2.2.2.1.1.2.cmml" xref="S2.E8.m1.2.2.2.1.1.2"></times><ci id="S2.E8.m1.2.2.2.1.1.3.cmml" xref="S2.E8.m1.2.2.2.1.1.3">ğ‘š</ci><ci id="S2.E8.m1.2.2.2.1.1.4.cmml" xref="S2.E8.m1.2.2.2.1.1.4">ğ‘</ci><ci id="S2.E8.m1.2.2.2.1.1.5.cmml" xref="S2.E8.m1.2.2.2.1.1.5">ğ‘¥</ci><apply id="S2.E8.m1.2.2.2.1.1.1.1.1.cmml" xref="S2.E8.m1.2.2.2.1.1.1.1"><plus id="S2.E8.m1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E8.m1.2.2.2.1.1.1.1.1.1"></plus><ci id="S2.E8.m1.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E8.m1.2.2.2.1.1.1.1.1.2">ğ¶</ci><ci id="S2.E8.m1.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E8.m1.2.2.2.1.1.1.1.1.3">italic-Ïµ</ci></apply></apply></apply></apply></apply></apply><apply id="S2.E8.m1.4.4.1.1c.cmml" xref="S2.E8.m1.4.4.1"><eq id="S2.E8.m1.4.4.1.1.4.cmml" xref="S2.E8.m1.4.4.1.1.4"></eq><share href="https://arxiv.org/html/2409.04329v1#S2.E8.m1.2.2.cmml" id="S2.E8.m1.4.4.1.1d.cmml" xref="S2.E8.m1.4.4.1"></share><apply id="S2.E8.m1.4.4.1.1.5.cmml" xref="S2.E8.m1.4.4.1.1.5"><divide id="S2.E8.m1.4.4.1.1.5.1.cmml" xref="S2.E8.m1.4.4.1.1.5"></divide><cn id="S2.E8.m1.4.4.1.1.5.2.cmml" type="integer" xref="S2.E8.m1.4.4.1.1.5.2">1</cn><apply id="S2.E8.m1.4.4.1.1.5.3.cmml" xref="S2.E8.m1.4.4.1.1.5.3"><plus id="S2.E8.m1.4.4.1.1.5.3.1.cmml" xref="S2.E8.m1.4.4.1.1.5.3.1"></plus><cn id="S2.E8.m1.4.4.1.1.5.3.2.cmml" type="integer" xref="S2.E8.m1.4.4.1.1.5.3.2">1</cn><apply id="S2.E8.m1.4.4.1.1.5.3.3.cmml" xref="S2.E8.m1.4.4.1.1.5.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.1.1.5.3.3.1.cmml" xref="S2.E8.m1.4.4.1.1.5.3.3">superscript</csymbol><ci id="S2.E8.m1.4.4.1.1.5.3.3.2.cmml" xref="S2.E8.m1.4.4.1.1.5.3.3.2">ğ‘’</ci><apply id="S2.E8.m1.4.4.1.1.5.3.3.3.cmml" xref="S2.E8.m1.4.4.1.1.5.3.3.3"><minus id="S2.E8.m1.4.4.1.1.5.3.3.3.1.cmml" xref="S2.E8.m1.4.4.1.1.5.3.3.3"></minus><apply id="S2.E8.m1.4.4.1.1.5.3.3.3.2.cmml" xref="S2.E8.m1.4.4.1.1.5.3.3.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.4.4.1.1.5.3.3.3.2.1.cmml" xref="S2.E8.m1.4.4.1.1.5.3.3.3.2">subscript</csymbol><ci id="S2.E8.m1.4.4.1.1.5.3.3.3.2.2.cmml" xref="S2.E8.m1.4.4.1.1.5.3.3.3.2.2">ğ‘¦</ci><ci id="S2.E8.m1.4.4.1.1.5.3.3.3.2.3.cmml" xref="S2.E8.m1.4.4.1.1.5.3.3.3.2.3">ğ‘—</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.4c">\hat{p}_{P}(j)=\frac{\frac{c_{j}+\epsilon}{max(C+\epsilon)}}{\sum_{z=1}^{N}%
\frac{c_{z}+\epsilon}{max(C+\epsilon)}}=\frac{1}{1+e^{-y_{j}}}.</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.4d">over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) = divide start_ARG divide start_ARG italic_c start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_ARG start_ARG âˆ‘ start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT divide start_ARG italic_c start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT + italic_Ïµ end_ARG start_ARG italic_m italic_a italic_x ( italic_C + italic_Ïµ ) end_ARG end_ARG = divide start_ARG 1 end_ARG start_ARG 1 + italic_e start_POSTSUPERSCRIPT - italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT end_ARG .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p8.4">This implies that <math alttext="y_{j}" class="ltx_Math" display="inline" id="S2.p8.4.m1.1"><semantics id="S2.p8.4.m1.1a"><msub id="S2.p8.4.m1.1.1" xref="S2.p8.4.m1.1.1.cmml"><mi id="S2.p8.4.m1.1.1.2" xref="S2.p8.4.m1.1.1.2.cmml">y</mi><mi id="S2.p8.4.m1.1.1.3" xref="S2.p8.4.m1.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p8.4.m1.1b"><apply id="S2.p8.4.m1.1.1.cmml" xref="S2.p8.4.m1.1.1"><csymbol cd="ambiguous" id="S2.p8.4.m1.1.1.1.cmml" xref="S2.p8.4.m1.1.1">subscript</csymbol><ci id="S2.p8.4.m1.1.1.2.cmml" xref="S2.p8.4.m1.1.1.2">ğ‘¦</ci><ci id="S2.p8.4.m1.1.1.3.cmml" xref="S2.p8.4.m1.1.1.3">ğ‘—</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.4.m1.1c">y_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.p8.4.m1.1d">italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> can be isolated in Eq.Â (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S2.E8" title="In 2. Personalized Popularity Awareness â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">8</span></a>) as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}&amp;\hat{p}_{P}(j)\cdot(1+e^{-y_{j}})=1\Rightarrow\hat{p}_{P}(j)+%
\hat{p}_{P}(j)\cdot e^{-y_{j}}=1\\
&amp;\Rightarrow e^{-y_{j}}=\frac{1-\hat{p}_{P}(j)}{\hat{p}_{P}(j)}\Rightarrow y_{%
j}=-\ln{\frac{1-\hat{p}_{P}(j)}{\hat{p}_{P}(j)}}.\end{split}" class="ltx_Math" display="block" id="S2.Ex2.m1.47"><semantics id="S2.Ex2.m1.47a"><mtable columnspacing="0pt" displaystyle="true" id="S2.Ex2.m1.47.47.3" rowspacing="0pt"><mtr id="S2.Ex2.m1.47.47.3a"><mtd id="S2.Ex2.m1.47.47.3b" xref="S2.Ex2.m1.45.45.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.Ex2.m1.47.47.3c"><mrow id="S2.Ex2.m1.46.46.2.45.32.32"><mrow id="S2.Ex2.m1.46.46.2.45.32.32.32"><mrow id="S2.Ex2.m1.46.46.2.45.32.32.32.2"><msub id="S2.Ex2.m1.46.46.2.45.32.32.32.2.2"><mover accent="true" id="S2.Ex2.m1.1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.1.cmml"><mi id="S2.Ex2.m1.1.1.1.1.1.1.2" xref="S2.Ex2.m1.1.1.1.1.1.1.2.cmml">p</mi><mo id="S2.Ex2.m1.1.1.1.1.1.1.1" xref="S2.Ex2.m1.1.1.1.1.1.1.1.cmml">^</mo></mover><mi id="S2.Ex2.m1.2.2.2.2.2.2.1" xref="S2.Ex2.m1.2.2.2.2.2.2.1.cmml">P</mi></msub><mo id="S2.Ex2.m1.46.46.2.45.32.32.32.2.1" xref="S2.Ex2.m1.45.45.1.1.1.cmml">â¢</mo><mrow id="S2.Ex2.m1.46.46.2.45.32.32.32.2.3"><mo id="S2.Ex2.m1.3.3.3.3.3.3" stretchy="false" xref="S2.Ex2.m1.45.45.1.1.1.cmml">(</mo><mi id="S2.Ex2.m1.4.4.4.4.4.4" xref="S2.Ex2.m1.4.4.4.4.4.4.cmml">j</mi><mo id="S2.Ex2.m1.5.5.5.5.5.5" rspace="0.055em" stretchy="false" xref="S2.Ex2.m1.45.45.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex2.m1.6.6.6.6.6.6" rspace="0.222em" xref="S2.Ex2.m1.6.6.6.6.6.6.cmml">â‹…</mo><mrow id="S2.Ex2.m1.46.46.2.45.32.32.32.1.1"><mo id="S2.Ex2.m1.7.7.7.7.7.7" stretchy="false" xref="S2.Ex2.m1.45.45.1.1.1.cmml">(</mo><mrow id="S2.Ex2.m1.46.46.2.45.32.32.32.1.1.1"><mn id="S2.Ex2.m1.8.8.8.8.8.8" xref="S2.Ex2.m1.8.8.8.8.8.8.cmml">1</mn><mo id="S2.Ex2.m1.9.9.9.9.9.9" xref="S2.Ex2.m1.9.9.9.9.9.9.cmml">+</mo><msup id="S2.Ex2.m1.46.46.2.45.32.32.32.1.1.1.1"><mi id="S2.Ex2.m1.10.10.10.10.10.10" xref="S2.Ex2.m1.10.10.10.10.10.10.cmml">e</mi><mrow id="S2.Ex2.m1.11.11.11.11.11.11.1" xref="S2.Ex2.m1.11.11.11.11.11.11.1.cmml"><mo id="S2.Ex2.m1.11.11.11.11.11.11.1a" xref="S2.Ex2.m1.11.11.11.11.11.11.1.cmml">âˆ’</mo><msub id="S2.Ex2.m1.11.11.11.11.11.11.1.2" xref="S2.Ex2.m1.11.11.11.11.11.11.1.2.cmml"><mi id="S2.Ex2.m1.11.11.11.11.11.11.1.2.2" xref="S2.Ex2.m1.11.11.11.11.11.11.1.2.2.cmml">y</mi><mi id="S2.Ex2.m1.11.11.11.11.11.11.1.2.3" xref="S2.Ex2.m1.11.11.11.11.11.11.1.2.3.cmml">j</mi></msub></mrow></msup></mrow><mo id="S2.Ex2.m1.12.12.12.12.12.12" stretchy="false" xref="S2.Ex2.m1.45.45.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex2.m1.13.13.13.13.13.13" xref="S2.Ex2.m1.13.13.13.13.13.13.cmml">=</mo><mn id="S2.Ex2.m1.14.14.14.14.14.14" xref="S2.Ex2.m1.14.14.14.14.14.14.cmml">1</mn><mo id="S2.Ex2.m1.15.15.15.15.15.15" stretchy="false" xref="S2.Ex2.m1.15.15.15.15.15.15.cmml">â‡’</mo><mrow id="S2.Ex2.m1.46.46.2.45.32.32.34"><mrow id="S2.Ex2.m1.46.46.2.45.32.32.34.1"><msub id="S2.Ex2.m1.46.46.2.45.32.32.34.1.2"><mover accent="true" id="S2.Ex2.m1.16.16.16.16.16.16" xref="S2.Ex2.m1.16.16.16.16.16.16.cmml"><mi id="S2.Ex2.m1.16.16.16.16.16.16.2" xref="S2.Ex2.m1.16.16.16.16.16.16.2.cmml">p</mi><mo id="S2.Ex2.m1.16.16.16.16.16.16.1" xref="S2.Ex2.m1.16.16.16.16.16.16.1.cmml">^</mo></mover><mi id="S2.Ex2.m1.17.17.17.17.17.17.1" xref="S2.Ex2.m1.17.17.17.17.17.17.1.cmml">P</mi></msub><mo id="S2.Ex2.m1.46.46.2.45.32.32.34.1.1" xref="S2.Ex2.m1.45.45.1.1.1.cmml">â¢</mo><mrow id="S2.Ex2.m1.46.46.2.45.32.32.34.1.3"><mo id="S2.Ex2.m1.18.18.18.18.18.18" stretchy="false" xref="S2.Ex2.m1.45.45.1.1.1.cmml">(</mo><mi id="S2.Ex2.m1.19.19.19.19.19.19" xref="S2.Ex2.m1.19.19.19.19.19.19.cmml">j</mi><mo id="S2.Ex2.m1.20.20.20.20.20.20" stretchy="false" xref="S2.Ex2.m1.45.45.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex2.m1.21.21.21.21.21.21" xref="S2.Ex2.m1.21.21.21.21.21.21.cmml">+</mo><mrow id="S2.Ex2.m1.46.46.2.45.32.32.34.2"><mrow id="S2.Ex2.m1.46.46.2.45.32.32.34.2.1"><msub id="S2.Ex2.m1.46.46.2.45.32.32.34.2.1.2"><mover accent="true" id="S2.Ex2.m1.22.22.22.22.22.22" xref="S2.Ex2.m1.22.22.22.22.22.22.cmml"><mi id="S2.Ex2.m1.22.22.22.22.22.22.2" xref="S2.Ex2.m1.22.22.22.22.22.22.2.cmml">p</mi><mo id="S2.Ex2.m1.22.22.22.22.22.22.1" xref="S2.Ex2.m1.22.22.22.22.22.22.1.cmml">^</mo></mover><mi id="S2.Ex2.m1.23.23.23.23.23.23.1" xref="S2.Ex2.m1.23.23.23.23.23.23.1.cmml">P</mi></msub><mo id="S2.Ex2.m1.46.46.2.45.32.32.34.2.1.1" xref="S2.Ex2.m1.45.45.1.1.1.cmml">â¢</mo><mrow id="S2.Ex2.m1.46.46.2.45.32.32.34.2.1.3"><mo id="S2.Ex2.m1.24.24.24.24.24.24" stretchy="false" xref="S2.Ex2.m1.45.45.1.1.1.cmml">(</mo><mi id="S2.Ex2.m1.25.25.25.25.25.25" xref="S2.Ex2.m1.25.25.25.25.25.25.cmml">j</mi><mo id="S2.Ex2.m1.26.26.26.26.26.26" rspace="0.055em" stretchy="false" xref="S2.Ex2.m1.45.45.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex2.m1.27.27.27.27.27.27" rspace="0.222em" xref="S2.Ex2.m1.27.27.27.27.27.27.cmml">â‹…</mo><msup id="S2.Ex2.m1.46.46.2.45.32.32.34.2.2"><mi id="S2.Ex2.m1.28.28.28.28.28.28" xref="S2.Ex2.m1.28.28.28.28.28.28.cmml">e</mi><mrow id="S2.Ex2.m1.29.29.29.29.29.29.1" xref="S2.Ex2.m1.29.29.29.29.29.29.1.cmml"><mo id="S2.Ex2.m1.29.29.29.29.29.29.1a" xref="S2.Ex2.m1.29.29.29.29.29.29.1.cmml">âˆ’</mo><msub id="S2.Ex2.m1.29.29.29.29.29.29.1.2" xref="S2.Ex2.m1.29.29.29.29.29.29.1.2.cmml"><mi id="S2.Ex2.m1.29.29.29.29.29.29.1.2.2" xref="S2.Ex2.m1.29.29.29.29.29.29.1.2.2.cmml">y</mi><mi id="S2.Ex2.m1.29.29.29.29.29.29.1.2.3" xref="S2.Ex2.m1.29.29.29.29.29.29.1.2.3.cmml">j</mi></msub></mrow></msup></mrow></mrow><mo id="S2.Ex2.m1.30.30.30.30.30.30" xref="S2.Ex2.m1.30.30.30.30.30.30.cmml">=</mo><mn id="S2.Ex2.m1.31.31.31.31.31.31" xref="S2.Ex2.m1.31.31.31.31.31.31.cmml">1</mn></mrow></mtd></mtr><mtr id="S2.Ex2.m1.47.47.3d"><mtd id="S2.Ex2.m1.47.47.3e" xref="S2.Ex2.m1.45.45.1.1.1.cmml"></mtd><mtd class="ltx_align_left" columnalign="left" id="S2.Ex2.m1.47.47.3f"><mrow id="S2.Ex2.m1.47.47.3.46.14.14.14"><mrow id="S2.Ex2.m1.47.47.3.46.14.14.14.1"><mi id="S2.Ex2.m1.47.47.3.46.14.14.14.1.2" xref="S2.Ex2.m1.45.45.1.1.1.cmml"></mi><mo id="S2.Ex2.m1.32.32.32.1.1.1" stretchy="false" xref="S2.Ex2.m1.32.32.32.1.1.1.cmml">â‡’</mo><msup id="S2.Ex2.m1.47.47.3.46.14.14.14.1.3"><mi id="S2.Ex2.m1.33.33.33.2.2.2" xref="S2.Ex2.m1.33.33.33.2.2.2.cmml">e</mi><mrow id="S2.Ex2.m1.34.34.34.3.3.3.1" xref="S2.Ex2.m1.34.34.34.3.3.3.1.cmml"><mo id="S2.Ex2.m1.34.34.34.3.3.3.1a" xref="S2.Ex2.m1.34.34.34.3.3.3.1.cmml">âˆ’</mo><msub id="S2.Ex2.m1.34.34.34.3.3.3.1.2" xref="S2.Ex2.m1.34.34.34.3.3.3.1.2.cmml"><mi id="S2.Ex2.m1.34.34.34.3.3.3.1.2.2" xref="S2.Ex2.m1.34.34.34.3.3.3.1.2.2.cmml">y</mi><mi id="S2.Ex2.m1.34.34.34.3.3.3.1.2.3" xref="S2.Ex2.m1.34.34.34.3.3.3.1.2.3.cmml">j</mi></msub></mrow></msup><mo id="S2.Ex2.m1.35.35.35.4.4.4" xref="S2.Ex2.m1.35.35.35.4.4.4.cmml">=</mo><mfrac id="S2.Ex2.m1.36.36.36.5.5.5" xref="S2.Ex2.m1.36.36.36.5.5.5.cmml"><mrow id="S2.Ex2.m1.36.36.36.5.5.5.1" xref="S2.Ex2.m1.36.36.36.5.5.5.1.cmml"><mn id="S2.Ex2.m1.36.36.36.5.5.5.1.3" xref="S2.Ex2.m1.36.36.36.5.5.5.1.3.cmml">1</mn><mo id="S2.Ex2.m1.36.36.36.5.5.5.1.2" xref="S2.Ex2.m1.36.36.36.5.5.5.1.2.cmml">âˆ’</mo><mrow id="S2.Ex2.m1.36.36.36.5.5.5.1.4" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.cmml"><msub id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.cmml"><mover accent="true" id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2.cmml"><mi id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2.2" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2.2.cmml">p</mi><mo id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2.1" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2.1.cmml">^</mo></mover><mi id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.3" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.3.cmml">P</mi></msub><mo id="S2.Ex2.m1.36.36.36.5.5.5.1.4.1" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.1.cmml">â¢</mo><mrow id="S2.Ex2.m1.36.36.36.5.5.5.1.4.3.2" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.cmml"><mo id="S2.Ex2.m1.36.36.36.5.5.5.1.4.3.2.1" stretchy="false" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.cmml">(</mo><mi id="S2.Ex2.m1.36.36.36.5.5.5.1.1" xref="S2.Ex2.m1.36.36.36.5.5.5.1.1.cmml">j</mi><mo id="S2.Ex2.m1.36.36.36.5.5.5.1.4.3.2.2" stretchy="false" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.cmml">)</mo></mrow></mrow></mrow><mrow id="S2.Ex2.m1.36.36.36.5.5.5.2" xref="S2.Ex2.m1.36.36.36.5.5.5.2.cmml"><msub id="S2.Ex2.m1.36.36.36.5.5.5.2.3" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3.cmml"><mover accent="true" id="S2.Ex2.m1.36.36.36.5.5.5.2.3.2" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3.2.cmml"><mi id="S2.Ex2.m1.36.36.36.5.5.5.2.3.2.2" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3.2.2.cmml">p</mi><mo id="S2.Ex2.m1.36.36.36.5.5.5.2.3.2.1" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3.2.1.cmml">^</mo></mover><mi id="S2.Ex2.m1.36.36.36.5.5.5.2.3.3" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3.3.cmml">P</mi></msub><mo id="S2.Ex2.m1.36.36.36.5.5.5.2.2" xref="S2.Ex2.m1.36.36.36.5.5.5.2.2.cmml">â¢</mo><mrow id="S2.Ex2.m1.36.36.36.5.5.5.2.4.2" xref="S2.Ex2.m1.36.36.36.5.5.5.2.cmml"><mo id="S2.Ex2.m1.36.36.36.5.5.5.2.4.2.1" stretchy="false" xref="S2.Ex2.m1.36.36.36.5.5.5.2.cmml">(</mo><mi id="S2.Ex2.m1.36.36.36.5.5.5.2.1" xref="S2.Ex2.m1.36.36.36.5.5.5.2.1.cmml">j</mi><mo id="S2.Ex2.m1.36.36.36.5.5.5.2.4.2.2" stretchy="false" xref="S2.Ex2.m1.36.36.36.5.5.5.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S2.Ex2.m1.37.37.37.6.6.6" stretchy="false" xref="S2.Ex2.m1.37.37.37.6.6.6.cmml">â‡’</mo><msub id="S2.Ex2.m1.47.47.3.46.14.14.14.1.4"><mi id="S2.Ex2.m1.38.38.38.7.7.7" xref="S2.Ex2.m1.38.38.38.7.7.7.cmml">y</mi><mi id="S2.Ex2.m1.39.39.39.8.8.8.1" xref="S2.Ex2.m1.39.39.39.8.8.8.1.cmml">j</mi></msub><mo id="S2.Ex2.m1.40.40.40.9.9.9" xref="S2.Ex2.m1.40.40.40.9.9.9.cmml">=</mo><mrow id="S2.Ex2.m1.47.47.3.46.14.14.14.1.5"><mo id="S2.Ex2.m1.47.47.3.46.14.14.14.1.5a" rspace="0.167em" xref="S2.Ex2.m1.45.45.1.1.1.cmml">âˆ’</mo><mrow id="S2.Ex2.m1.47.47.3.46.14.14.14.1.5.1"><mi id="S2.Ex2.m1.42.42.42.11.11.11" xref="S2.Ex2.m1.42.42.42.11.11.11.cmml">ln</mi><mo id="S2.Ex2.m1.47.47.3.46.14.14.14.1.5.1a" lspace="0.167em" xref="S2.Ex2.m1.45.45.1.1.1.cmml">â¡</mo><mfrac id="S2.Ex2.m1.43.43.43.12.12.12" xref="S2.Ex2.m1.43.43.43.12.12.12.cmml"><mrow id="S2.Ex2.m1.43.43.43.12.12.12.1" xref="S2.Ex2.m1.43.43.43.12.12.12.1.cmml"><mn id="S2.Ex2.m1.43.43.43.12.12.12.1.3" xref="S2.Ex2.m1.43.43.43.12.12.12.1.3.cmml">1</mn><mo id="S2.Ex2.m1.43.43.43.12.12.12.1.2" xref="S2.Ex2.m1.43.43.43.12.12.12.1.2.cmml">âˆ’</mo><mrow id="S2.Ex2.m1.43.43.43.12.12.12.1.4" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.cmml"><msub id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.cmml"><mover accent="true" id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2.cmml"><mi id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2.2" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2.2.cmml">p</mi><mo id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2.1" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2.1.cmml">^</mo></mover><mi id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.3" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.3.cmml">P</mi></msub><mo id="S2.Ex2.m1.43.43.43.12.12.12.1.4.1" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.1.cmml">â¢</mo><mrow id="S2.Ex2.m1.43.43.43.12.12.12.1.4.3.2" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.cmml"><mo id="S2.Ex2.m1.43.43.43.12.12.12.1.4.3.2.1" stretchy="false" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.cmml">(</mo><mi id="S2.Ex2.m1.43.43.43.12.12.12.1.1" xref="S2.Ex2.m1.43.43.43.12.12.12.1.1.cmml">j</mi><mo id="S2.Ex2.m1.43.43.43.12.12.12.1.4.3.2.2" stretchy="false" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.cmml">)</mo></mrow></mrow></mrow><mrow id="S2.Ex2.m1.43.43.43.12.12.12.2" xref="S2.Ex2.m1.43.43.43.12.12.12.2.cmml"><msub id="S2.Ex2.m1.43.43.43.12.12.12.2.3" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3.cmml"><mover accent="true" id="S2.Ex2.m1.43.43.43.12.12.12.2.3.2" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3.2.cmml"><mi id="S2.Ex2.m1.43.43.43.12.12.12.2.3.2.2" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3.2.2.cmml">p</mi><mo id="S2.Ex2.m1.43.43.43.12.12.12.2.3.2.1" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3.2.1.cmml">^</mo></mover><mi id="S2.Ex2.m1.43.43.43.12.12.12.2.3.3" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3.3.cmml">P</mi></msub><mo id="S2.Ex2.m1.43.43.43.12.12.12.2.2" xref="S2.Ex2.m1.43.43.43.12.12.12.2.2.cmml">â¢</mo><mrow id="S2.Ex2.m1.43.43.43.12.12.12.2.4.2" xref="S2.Ex2.m1.43.43.43.12.12.12.2.cmml"><mo id="S2.Ex2.m1.43.43.43.12.12.12.2.4.2.1" stretchy="false" xref="S2.Ex2.m1.43.43.43.12.12.12.2.cmml">(</mo><mi id="S2.Ex2.m1.43.43.43.12.12.12.2.1" xref="S2.Ex2.m1.43.43.43.12.12.12.2.1.cmml">j</mi><mo id="S2.Ex2.m1.43.43.43.12.12.12.2.4.2.2" stretchy="false" xref="S2.Ex2.m1.43.43.43.12.12.12.2.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S2.Ex2.m1.44.44.44.13.13.13" lspace="0em" xref="S2.Ex2.m1.45.45.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.47b"><apply id="S2.Ex2.m1.45.45.1.1.1.cmml" xref="S2.Ex2.m1.47.47.3b"><and id="S2.Ex2.m1.45.45.1.1.1a.cmml" xref="S2.Ex2.m1.47.47.3b"></and><apply id="S2.Ex2.m1.45.45.1.1.1b.cmml" xref="S2.Ex2.m1.47.47.3b"><eq id="S2.Ex2.m1.13.13.13.13.13.13.cmml" xref="S2.Ex2.m1.13.13.13.13.13.13"></eq><apply id="S2.Ex2.m1.45.45.1.1.1.1.cmml" xref="S2.Ex2.m1.47.47.3b"><ci id="S2.Ex2.m1.6.6.6.6.6.6.cmml" xref="S2.Ex2.m1.6.6.6.6.6.6">â‹…</ci><apply id="S2.Ex2.m1.45.45.1.1.1.1.3.cmml" xref="S2.Ex2.m1.47.47.3b"><times id="S2.Ex2.m1.45.45.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.47.47.3b"></times><apply id="S2.Ex2.m1.45.45.1.1.1.1.3.2.cmml" xref="S2.Ex2.m1.47.47.3b"><csymbol cd="ambiguous" id="S2.Ex2.m1.45.45.1.1.1.1.3.2.1.cmml" xref="S2.Ex2.m1.47.47.3b">subscript</csymbol><apply id="S2.Ex2.m1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1"><ci id="S2.Ex2.m1.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.1">^</ci><ci id="S2.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="S2.Ex2.m1.1.1.1.1.1.1.2">ğ‘</ci></apply><ci id="S2.Ex2.m1.2.2.2.2.2.2.1.cmml" xref="S2.Ex2.m1.2.2.2.2.2.2.1">ğ‘ƒ</ci></apply><ci id="S2.Ex2.m1.4.4.4.4.4.4.cmml" xref="S2.Ex2.m1.4.4.4.4.4.4">ğ‘—</ci></apply><apply id="S2.Ex2.m1.45.45.1.1.1.1.1.1.1.cmml" xref="S2.Ex2.m1.47.47.3b"><plus id="S2.Ex2.m1.9.9.9.9.9.9.cmml" xref="S2.Ex2.m1.9.9.9.9.9.9"></plus><cn id="S2.Ex2.m1.8.8.8.8.8.8.cmml" type="integer" xref="S2.Ex2.m1.8.8.8.8.8.8">1</cn><apply id="S2.Ex2.m1.45.45.1.1.1.1.1.1.1.3.cmml" xref="S2.Ex2.m1.47.47.3b"><csymbol cd="ambiguous" id="S2.Ex2.m1.45.45.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex2.m1.47.47.3b">superscript</csymbol><ci id="S2.Ex2.m1.10.10.10.10.10.10.cmml" xref="S2.Ex2.m1.10.10.10.10.10.10">ğ‘’</ci><apply id="S2.Ex2.m1.11.11.11.11.11.11.1.cmml" xref="S2.Ex2.m1.11.11.11.11.11.11.1"><minus id="S2.Ex2.m1.11.11.11.11.11.11.1.1.cmml" xref="S2.Ex2.m1.11.11.11.11.11.11.1"></minus><apply id="S2.Ex2.m1.11.11.11.11.11.11.1.2.cmml" xref="S2.Ex2.m1.11.11.11.11.11.11.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.11.11.11.11.11.11.1.2.1.cmml" xref="S2.Ex2.m1.11.11.11.11.11.11.1.2">subscript</csymbol><ci id="S2.Ex2.m1.11.11.11.11.11.11.1.2.2.cmml" xref="S2.Ex2.m1.11.11.11.11.11.11.1.2.2">ğ‘¦</ci><ci id="S2.Ex2.m1.11.11.11.11.11.11.1.2.3.cmml" xref="S2.Ex2.m1.11.11.11.11.11.11.1.2.3">ğ‘—</ci></apply></apply></apply></apply></apply><cn id="S2.Ex2.m1.14.14.14.14.14.14.cmml" type="integer" xref="S2.Ex2.m1.14.14.14.14.14.14">1</cn></apply><apply id="S2.Ex2.m1.45.45.1.1.1c.cmml" xref="S2.Ex2.m1.47.47.3b"><ci id="S2.Ex2.m1.15.15.15.15.15.15.cmml" xref="S2.Ex2.m1.15.15.15.15.15.15">â‡’</ci><share href="https://arxiv.org/html/2409.04329v1#S2.Ex2.m1.45.45.1.1.1.4.cmml" id="S2.Ex2.m1.45.45.1.1.1d.cmml" xref="S2.Ex2.m1.47.47.3b"></share><apply id="S2.Ex2.m1.45.45.1.1.1.6.cmml" xref="S2.Ex2.m1.47.47.3b"><plus id="S2.Ex2.m1.21.21.21.21.21.21.cmml" xref="S2.Ex2.m1.21.21.21.21.21.21"></plus><apply id="S2.Ex2.m1.45.45.1.1.1.6.2.cmml" xref="S2.Ex2.m1.47.47.3b"><times id="S2.Ex2.m1.45.45.1.1.1.6.2.1.cmml" xref="S2.Ex2.m1.47.47.3b"></times><apply id="S2.Ex2.m1.45.45.1.1.1.6.2.2.cmml" xref="S2.Ex2.m1.47.47.3b"><csymbol cd="ambiguous" id="S2.Ex2.m1.45.45.1.1.1.6.2.2.1.cmml" xref="S2.Ex2.m1.47.47.3b">subscript</csymbol><apply id="S2.Ex2.m1.16.16.16.16.16.16.cmml" xref="S2.Ex2.m1.16.16.16.16.16.16"><ci id="S2.Ex2.m1.16.16.16.16.16.16.1.cmml" xref="S2.Ex2.m1.16.16.16.16.16.16.1">^</ci><ci id="S2.Ex2.m1.16.16.16.16.16.16.2.cmml" xref="S2.Ex2.m1.16.16.16.16.16.16.2">ğ‘</ci></apply><ci id="S2.Ex2.m1.17.17.17.17.17.17.1.cmml" xref="S2.Ex2.m1.17.17.17.17.17.17.1">ğ‘ƒ</ci></apply><ci id="S2.Ex2.m1.19.19.19.19.19.19.cmml" xref="S2.Ex2.m1.19.19.19.19.19.19">ğ‘—</ci></apply><apply id="S2.Ex2.m1.45.45.1.1.1.6.3.cmml" xref="S2.Ex2.m1.47.47.3b"><ci id="S2.Ex2.m1.27.27.27.27.27.27.cmml" xref="S2.Ex2.m1.27.27.27.27.27.27">â‹…</ci><apply id="S2.Ex2.m1.45.45.1.1.1.6.3.2.cmml" xref="S2.Ex2.m1.47.47.3b"><times id="S2.Ex2.m1.45.45.1.1.1.6.3.2.1.cmml" xref="S2.Ex2.m1.47.47.3b"></times><apply id="S2.Ex2.m1.45.45.1.1.1.6.3.2.2.cmml" xref="S2.Ex2.m1.47.47.3b"><csymbol cd="ambiguous" id="S2.Ex2.m1.45.45.1.1.1.6.3.2.2.1.cmml" xref="S2.Ex2.m1.47.47.3b">subscript</csymbol><apply id="S2.Ex2.m1.22.22.22.22.22.22.cmml" xref="S2.Ex2.m1.22.22.22.22.22.22"><ci id="S2.Ex2.m1.22.22.22.22.22.22.1.cmml" xref="S2.Ex2.m1.22.22.22.22.22.22.1">^</ci><ci id="S2.Ex2.m1.22.22.22.22.22.22.2.cmml" xref="S2.Ex2.m1.22.22.22.22.22.22.2">ğ‘</ci></apply><ci id="S2.Ex2.m1.23.23.23.23.23.23.1.cmml" xref="S2.Ex2.m1.23.23.23.23.23.23.1">ğ‘ƒ</ci></apply><ci id="S2.Ex2.m1.25.25.25.25.25.25.cmml" xref="S2.Ex2.m1.25.25.25.25.25.25">ğ‘—</ci></apply><apply id="S2.Ex2.m1.45.45.1.1.1.6.3.3.cmml" xref="S2.Ex2.m1.47.47.3b"><csymbol cd="ambiguous" id="S2.Ex2.m1.45.45.1.1.1.6.3.3.1.cmml" xref="S2.Ex2.m1.47.47.3b">superscript</csymbol><ci id="S2.Ex2.m1.28.28.28.28.28.28.cmml" xref="S2.Ex2.m1.28.28.28.28.28.28">ğ‘’</ci><apply id="S2.Ex2.m1.29.29.29.29.29.29.1.cmml" xref="S2.Ex2.m1.29.29.29.29.29.29.1"><minus id="S2.Ex2.m1.29.29.29.29.29.29.1.1.cmml" xref="S2.Ex2.m1.29.29.29.29.29.29.1"></minus><apply id="S2.Ex2.m1.29.29.29.29.29.29.1.2.cmml" xref="S2.Ex2.m1.29.29.29.29.29.29.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.29.29.29.29.29.29.1.2.1.cmml" xref="S2.Ex2.m1.29.29.29.29.29.29.1.2">subscript</csymbol><ci id="S2.Ex2.m1.29.29.29.29.29.29.1.2.2.cmml" xref="S2.Ex2.m1.29.29.29.29.29.29.1.2.2">ğ‘¦</ci><ci id="S2.Ex2.m1.29.29.29.29.29.29.1.2.3.cmml" xref="S2.Ex2.m1.29.29.29.29.29.29.1.2.3">ğ‘—</ci></apply></apply></apply></apply></apply></apply><apply id="S2.Ex2.m1.45.45.1.1.1e.cmml" xref="S2.Ex2.m1.47.47.3b"><eq id="S2.Ex2.m1.30.30.30.30.30.30.cmml" xref="S2.Ex2.m1.30.30.30.30.30.30"></eq><share href="https://arxiv.org/html/2409.04329v1#S2.Ex2.m1.45.45.1.1.1.6.cmml" id="S2.Ex2.m1.45.45.1.1.1f.cmml" xref="S2.Ex2.m1.47.47.3b"></share><cn id="S2.Ex2.m1.31.31.31.31.31.31.cmml" type="integer" xref="S2.Ex2.m1.31.31.31.31.31.31">1</cn></apply><apply id="S2.Ex2.m1.45.45.1.1.1g.cmml" xref="S2.Ex2.m1.47.47.3b"><ci id="S2.Ex2.m1.32.32.32.1.1.1.cmml" xref="S2.Ex2.m1.32.32.32.1.1.1">â‡’</ci><share href="https://arxiv.org/html/2409.04329v1#S2.Ex2.m1.45.45.1.1.1.8.cmml" id="S2.Ex2.m1.45.45.1.1.1h.cmml" xref="S2.Ex2.m1.47.47.3b"></share><apply id="S2.Ex2.m1.45.45.1.1.1.10.cmml" xref="S2.Ex2.m1.47.47.3b"><csymbol cd="ambiguous" id="S2.Ex2.m1.45.45.1.1.1.10.1.cmml" xref="S2.Ex2.m1.47.47.3b">superscript</csymbol><ci id="S2.Ex2.m1.33.33.33.2.2.2.cmml" xref="S2.Ex2.m1.33.33.33.2.2.2">ğ‘’</ci><apply id="S2.Ex2.m1.34.34.34.3.3.3.1.cmml" xref="S2.Ex2.m1.34.34.34.3.3.3.1"><minus id="S2.Ex2.m1.34.34.34.3.3.3.1.1.cmml" xref="S2.Ex2.m1.34.34.34.3.3.3.1"></minus><apply id="S2.Ex2.m1.34.34.34.3.3.3.1.2.cmml" xref="S2.Ex2.m1.34.34.34.3.3.3.1.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.34.34.34.3.3.3.1.2.1.cmml" xref="S2.Ex2.m1.34.34.34.3.3.3.1.2">subscript</csymbol><ci id="S2.Ex2.m1.34.34.34.3.3.3.1.2.2.cmml" xref="S2.Ex2.m1.34.34.34.3.3.3.1.2.2">ğ‘¦</ci><ci id="S2.Ex2.m1.34.34.34.3.3.3.1.2.3.cmml" xref="S2.Ex2.m1.34.34.34.3.3.3.1.2.3">ğ‘—</ci></apply></apply></apply></apply><apply id="S2.Ex2.m1.45.45.1.1.1i.cmml" xref="S2.Ex2.m1.47.47.3b"><eq id="S2.Ex2.m1.35.35.35.4.4.4.cmml" xref="S2.Ex2.m1.35.35.35.4.4.4"></eq><share href="https://arxiv.org/html/2409.04329v1#S2.Ex2.m1.45.45.1.1.1.10.cmml" id="S2.Ex2.m1.45.45.1.1.1j.cmml" xref="S2.Ex2.m1.47.47.3b"></share><apply id="S2.Ex2.m1.36.36.36.5.5.5.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5"><divide id="S2.Ex2.m1.36.36.36.5.5.5.3.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5"></divide><apply id="S2.Ex2.m1.36.36.36.5.5.5.1.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1"><minus id="S2.Ex2.m1.36.36.36.5.5.5.1.2.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1.2"></minus><cn id="S2.Ex2.m1.36.36.36.5.5.5.1.3.cmml" type="integer" xref="S2.Ex2.m1.36.36.36.5.5.5.1.3">1</cn><apply id="S2.Ex2.m1.36.36.36.5.5.5.1.4.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4"><times id="S2.Ex2.m1.36.36.36.5.5.5.1.4.1.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.1"></times><apply id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.1.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2">subscript</csymbol><apply id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2"><ci id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2.1.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2.1">^</ci><ci id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2.2.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.2.2">ğ‘</ci></apply><ci id="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.3.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1.4.2.3">ğ‘ƒ</ci></apply><ci id="S2.Ex2.m1.36.36.36.5.5.5.1.1.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.1.1">ğ‘—</ci></apply></apply><apply id="S2.Ex2.m1.36.36.36.5.5.5.2.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.2"><times id="S2.Ex2.m1.36.36.36.5.5.5.2.2.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.2.2"></times><apply id="S2.Ex2.m1.36.36.36.5.5.5.2.3.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.36.36.36.5.5.5.2.3.1.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3">subscript</csymbol><apply id="S2.Ex2.m1.36.36.36.5.5.5.2.3.2.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3.2"><ci id="S2.Ex2.m1.36.36.36.5.5.5.2.3.2.1.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3.2.1">^</ci><ci id="S2.Ex2.m1.36.36.36.5.5.5.2.3.2.2.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3.2.2">ğ‘</ci></apply><ci id="S2.Ex2.m1.36.36.36.5.5.5.2.3.3.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.2.3.3">ğ‘ƒ</ci></apply><ci id="S2.Ex2.m1.36.36.36.5.5.5.2.1.cmml" xref="S2.Ex2.m1.36.36.36.5.5.5.2.1">ğ‘—</ci></apply></apply></apply><apply id="S2.Ex2.m1.45.45.1.1.1k.cmml" xref="S2.Ex2.m1.47.47.3b"><ci id="S2.Ex2.m1.37.37.37.6.6.6.cmml" xref="S2.Ex2.m1.37.37.37.6.6.6">â‡’</ci><share href="https://arxiv.org/html/2409.04329v1#S2.Ex2.m1.45.45.1.1.1.12.cmml" id="S2.Ex2.m1.45.45.1.1.1l.cmml" xref="S2.Ex2.m1.47.47.3b"></share><apply id="S2.Ex2.m1.45.45.1.1.1.14.cmml" xref="S2.Ex2.m1.47.47.3b"><csymbol cd="ambiguous" id="S2.Ex2.m1.45.45.1.1.1.14.1.cmml" xref="S2.Ex2.m1.47.47.3b">subscript</csymbol><ci id="S2.Ex2.m1.38.38.38.7.7.7.cmml" xref="S2.Ex2.m1.38.38.38.7.7.7">ğ‘¦</ci><ci id="S2.Ex2.m1.39.39.39.8.8.8.1.cmml" xref="S2.Ex2.m1.39.39.39.8.8.8.1">ğ‘—</ci></apply></apply><apply id="S2.Ex2.m1.45.45.1.1.1m.cmml" xref="S2.Ex2.m1.47.47.3b"><eq id="S2.Ex2.m1.40.40.40.9.9.9.cmml" xref="S2.Ex2.m1.40.40.40.9.9.9"></eq><share href="https://arxiv.org/html/2409.04329v1#S2.Ex2.m1.45.45.1.1.1.14.cmml" id="S2.Ex2.m1.45.45.1.1.1n.cmml" xref="S2.Ex2.m1.47.47.3b"></share><apply id="S2.Ex2.m1.45.45.1.1.1.16.cmml" xref="S2.Ex2.m1.47.47.3b"><minus id="S2.Ex2.m1.41.41.41.10.10.10.cmml" xref="S2.Ex2.m1.47.47.3b"></minus><apply id="S2.Ex2.m1.45.45.1.1.1.16.2.cmml" xref="S2.Ex2.m1.47.47.3b"><ln id="S2.Ex2.m1.42.42.42.11.11.11.cmml" xref="S2.Ex2.m1.42.42.42.11.11.11"></ln><apply id="S2.Ex2.m1.43.43.43.12.12.12.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12"><divide id="S2.Ex2.m1.43.43.43.12.12.12.3.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12"></divide><apply id="S2.Ex2.m1.43.43.43.12.12.12.1.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1"><minus id="S2.Ex2.m1.43.43.43.12.12.12.1.2.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1.2"></minus><cn id="S2.Ex2.m1.43.43.43.12.12.12.1.3.cmml" type="integer" xref="S2.Ex2.m1.43.43.43.12.12.12.1.3">1</cn><apply id="S2.Ex2.m1.43.43.43.12.12.12.1.4.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4"><times id="S2.Ex2.m1.43.43.43.12.12.12.1.4.1.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.1"></times><apply id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.1.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2">subscript</csymbol><apply id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2"><ci id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2.1.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2.1">^</ci><ci id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2.2.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.2.2">ğ‘</ci></apply><ci id="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.3.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1.4.2.3">ğ‘ƒ</ci></apply><ci id="S2.Ex2.m1.43.43.43.12.12.12.1.1.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.1.1">ğ‘—</ci></apply></apply><apply id="S2.Ex2.m1.43.43.43.12.12.12.2.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.2"><times id="S2.Ex2.m1.43.43.43.12.12.12.2.2.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.2.2"></times><apply id="S2.Ex2.m1.43.43.43.12.12.12.2.3.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3"><csymbol cd="ambiguous" id="S2.Ex2.m1.43.43.43.12.12.12.2.3.1.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3">subscript</csymbol><apply id="S2.Ex2.m1.43.43.43.12.12.12.2.3.2.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3.2"><ci id="S2.Ex2.m1.43.43.43.12.12.12.2.3.2.1.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3.2.1">^</ci><ci id="S2.Ex2.m1.43.43.43.12.12.12.2.3.2.2.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3.2.2">ğ‘</ci></apply><ci id="S2.Ex2.m1.43.43.43.12.12.12.2.3.3.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.2.3.3">ğ‘ƒ</ci></apply><ci id="S2.Ex2.m1.43.43.43.12.12.12.2.1.cmml" xref="S2.Ex2.m1.43.43.43.12.12.12.2.1">ğ‘—</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.47c">\begin{split}&amp;\hat{p}_{P}(j)\cdot(1+e^{-y_{j}})=1\Rightarrow\hat{p}_{P}(j)+%
\hat{p}_{P}(j)\cdot e^{-y_{j}}=1\\
&amp;\Rightarrow e^{-y_{j}}=\frac{1-\hat{p}_{P}(j)}{\hat{p}_{P}(j)}\Rightarrow y_{%
j}=-\ln{\frac{1-\hat{p}_{P}(j)}{\hat{p}_{P}(j)}}.\end{split}</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.47d">start_ROW start_CELL end_CELL start_CELL over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) â‹… ( 1 + italic_e start_POSTSUPERSCRIPT - italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) = 1 â‡’ over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) + over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) â‹… italic_e start_POSTSUPERSCRIPT - italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = 1 end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL â‡’ italic_e start_POSTSUPERSCRIPT - italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUPERSCRIPT = divide start_ARG 1 - over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) end_ARG start_ARG over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) end_ARG â‡’ italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT = - roman_ln divide start_ARG 1 - over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) end_ARG start_ARG over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT ( italic_j ) end_ARG . end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p8.11">To integrate personalized popularity scores into the SASRec and gSASRec models, starting from the user input sequence <math alttext="S" class="ltx_Math" display="inline" id="S2.p8.5.m1.1"><semantics id="S2.p8.5.m1.1a"><mi id="S2.p8.5.m1.1.1" xref="S2.p8.5.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.p8.5.m1.1b"><ci id="S2.p8.5.m1.1.1.cmml" xref="S2.p8.5.m1.1.1">ğ‘†</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.5.m1.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.p8.5.m1.1d">italic_S</annotation></semantics></math>, we compute a personalized popularity scores matrix <math alttext="P" class="ltx_Math" display="inline" id="S2.p8.6.m2.1"><semantics id="S2.p8.6.m2.1a"><mi id="S2.p8.6.m2.1.1" xref="S2.p8.6.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S2.p8.6.m2.1b"><ci id="S2.p8.6.m2.1.1.cmml" xref="S2.p8.6.m2.1.1">ğ‘ƒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.6.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S2.p8.6.m2.1d">italic_P</annotation></semantics></math> and sum it to the scores matrix <math alttext="L" class="ltx_Math" display="inline" id="S2.p8.7.m3.1"><semantics id="S2.p8.7.m3.1a"><mi id="S2.p8.7.m3.1.1" xref="S2.p8.7.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.p8.7.m3.1b"><ci id="S2.p8.7.m3.1.1.cmml" xref="S2.p8.7.m3.1.1">ğ¿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.7.m3.1c">L</annotation><annotation encoding="application/x-llamapun" id="S2.p8.7.m3.1d">italic_L</annotation></semantics></math> obtained from the model. We define a vector of personalized popularity scores as <math alttext="P_{i}=[y_{i_{1}},\ldots,y_{i_{j}},\ldots,y_{i_{N}}]" class="ltx_Math" display="inline" id="S2.p8.8.m4.5"><semantics id="S2.p8.8.m4.5a"><mrow id="S2.p8.8.m4.5.5" xref="S2.p8.8.m4.5.5.cmml"><msub id="S2.p8.8.m4.5.5.5" xref="S2.p8.8.m4.5.5.5.cmml"><mi id="S2.p8.8.m4.5.5.5.2" xref="S2.p8.8.m4.5.5.5.2.cmml">P</mi><mi id="S2.p8.8.m4.5.5.5.3" xref="S2.p8.8.m4.5.5.5.3.cmml">i</mi></msub><mo id="S2.p8.8.m4.5.5.4" xref="S2.p8.8.m4.5.5.4.cmml">=</mo><mrow id="S2.p8.8.m4.5.5.3.3" xref="S2.p8.8.m4.5.5.3.4.cmml"><mo id="S2.p8.8.m4.5.5.3.3.4" stretchy="false" xref="S2.p8.8.m4.5.5.3.4.cmml">[</mo><msub id="S2.p8.8.m4.3.3.1.1.1" xref="S2.p8.8.m4.3.3.1.1.1.cmml"><mi id="S2.p8.8.m4.3.3.1.1.1.2" xref="S2.p8.8.m4.3.3.1.1.1.2.cmml">y</mi><msub id="S2.p8.8.m4.3.3.1.1.1.3" xref="S2.p8.8.m4.3.3.1.1.1.3.cmml"><mi id="S2.p8.8.m4.3.3.1.1.1.3.2" xref="S2.p8.8.m4.3.3.1.1.1.3.2.cmml">i</mi><mn id="S2.p8.8.m4.3.3.1.1.1.3.3" xref="S2.p8.8.m4.3.3.1.1.1.3.3.cmml">1</mn></msub></msub><mo id="S2.p8.8.m4.5.5.3.3.5" xref="S2.p8.8.m4.5.5.3.4.cmml">,</mo><mi id="S2.p8.8.m4.1.1" mathvariant="normal" xref="S2.p8.8.m4.1.1.cmml">â€¦</mi><mo id="S2.p8.8.m4.5.5.3.3.6" xref="S2.p8.8.m4.5.5.3.4.cmml">,</mo><msub id="S2.p8.8.m4.4.4.2.2.2" xref="S2.p8.8.m4.4.4.2.2.2.cmml"><mi id="S2.p8.8.m4.4.4.2.2.2.2" xref="S2.p8.8.m4.4.4.2.2.2.2.cmml">y</mi><msub id="S2.p8.8.m4.4.4.2.2.2.3" xref="S2.p8.8.m4.4.4.2.2.2.3.cmml"><mi id="S2.p8.8.m4.4.4.2.2.2.3.2" xref="S2.p8.8.m4.4.4.2.2.2.3.2.cmml">i</mi><mi id="S2.p8.8.m4.4.4.2.2.2.3.3" xref="S2.p8.8.m4.4.4.2.2.2.3.3.cmml">j</mi></msub></msub><mo id="S2.p8.8.m4.5.5.3.3.7" xref="S2.p8.8.m4.5.5.3.4.cmml">,</mo><mi id="S2.p8.8.m4.2.2" mathvariant="normal" xref="S2.p8.8.m4.2.2.cmml">â€¦</mi><mo id="S2.p8.8.m4.5.5.3.3.8" xref="S2.p8.8.m4.5.5.3.4.cmml">,</mo><msub id="S2.p8.8.m4.5.5.3.3.3" xref="S2.p8.8.m4.5.5.3.3.3.cmml"><mi id="S2.p8.8.m4.5.5.3.3.3.2" xref="S2.p8.8.m4.5.5.3.3.3.2.cmml">y</mi><msub id="S2.p8.8.m4.5.5.3.3.3.3" xref="S2.p8.8.m4.5.5.3.3.3.3.cmml"><mi id="S2.p8.8.m4.5.5.3.3.3.3.2" xref="S2.p8.8.m4.5.5.3.3.3.3.2.cmml">i</mi><mi id="S2.p8.8.m4.5.5.3.3.3.3.3" xref="S2.p8.8.m4.5.5.3.3.3.3.3.cmml">N</mi></msub></msub><mo id="S2.p8.8.m4.5.5.3.3.9" stretchy="false" xref="S2.p8.8.m4.5.5.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.8.m4.5b"><apply id="S2.p8.8.m4.5.5.cmml" xref="S2.p8.8.m4.5.5"><eq id="S2.p8.8.m4.5.5.4.cmml" xref="S2.p8.8.m4.5.5.4"></eq><apply id="S2.p8.8.m4.5.5.5.cmml" xref="S2.p8.8.m4.5.5.5"><csymbol cd="ambiguous" id="S2.p8.8.m4.5.5.5.1.cmml" xref="S2.p8.8.m4.5.5.5">subscript</csymbol><ci id="S2.p8.8.m4.5.5.5.2.cmml" xref="S2.p8.8.m4.5.5.5.2">ğ‘ƒ</ci><ci id="S2.p8.8.m4.5.5.5.3.cmml" xref="S2.p8.8.m4.5.5.5.3">ğ‘–</ci></apply><list id="S2.p8.8.m4.5.5.3.4.cmml" xref="S2.p8.8.m4.5.5.3.3"><apply id="S2.p8.8.m4.3.3.1.1.1.cmml" xref="S2.p8.8.m4.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.p8.8.m4.3.3.1.1.1.1.cmml" xref="S2.p8.8.m4.3.3.1.1.1">subscript</csymbol><ci id="S2.p8.8.m4.3.3.1.1.1.2.cmml" xref="S2.p8.8.m4.3.3.1.1.1.2">ğ‘¦</ci><apply id="S2.p8.8.m4.3.3.1.1.1.3.cmml" xref="S2.p8.8.m4.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.p8.8.m4.3.3.1.1.1.3.1.cmml" xref="S2.p8.8.m4.3.3.1.1.1.3">subscript</csymbol><ci id="S2.p8.8.m4.3.3.1.1.1.3.2.cmml" xref="S2.p8.8.m4.3.3.1.1.1.3.2">ğ‘–</ci><cn id="S2.p8.8.m4.3.3.1.1.1.3.3.cmml" type="integer" xref="S2.p8.8.m4.3.3.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p8.8.m4.1.1.cmml" xref="S2.p8.8.m4.1.1">â€¦</ci><apply id="S2.p8.8.m4.4.4.2.2.2.cmml" xref="S2.p8.8.m4.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.p8.8.m4.4.4.2.2.2.1.cmml" xref="S2.p8.8.m4.4.4.2.2.2">subscript</csymbol><ci id="S2.p8.8.m4.4.4.2.2.2.2.cmml" xref="S2.p8.8.m4.4.4.2.2.2.2">ğ‘¦</ci><apply id="S2.p8.8.m4.4.4.2.2.2.3.cmml" xref="S2.p8.8.m4.4.4.2.2.2.3"><csymbol cd="ambiguous" id="S2.p8.8.m4.4.4.2.2.2.3.1.cmml" xref="S2.p8.8.m4.4.4.2.2.2.3">subscript</csymbol><ci id="S2.p8.8.m4.4.4.2.2.2.3.2.cmml" xref="S2.p8.8.m4.4.4.2.2.2.3.2">ğ‘–</ci><ci id="S2.p8.8.m4.4.4.2.2.2.3.3.cmml" xref="S2.p8.8.m4.4.4.2.2.2.3.3">ğ‘—</ci></apply></apply><ci id="S2.p8.8.m4.2.2.cmml" xref="S2.p8.8.m4.2.2">â€¦</ci><apply id="S2.p8.8.m4.5.5.3.3.3.cmml" xref="S2.p8.8.m4.5.5.3.3.3"><csymbol cd="ambiguous" id="S2.p8.8.m4.5.5.3.3.3.1.cmml" xref="S2.p8.8.m4.5.5.3.3.3">subscript</csymbol><ci id="S2.p8.8.m4.5.5.3.3.3.2.cmml" xref="S2.p8.8.m4.5.5.3.3.3.2">ğ‘¦</ci><apply id="S2.p8.8.m4.5.5.3.3.3.3.cmml" xref="S2.p8.8.m4.5.5.3.3.3.3"><csymbol cd="ambiguous" id="S2.p8.8.m4.5.5.3.3.3.3.1.cmml" xref="S2.p8.8.m4.5.5.3.3.3.3">subscript</csymbol><ci id="S2.p8.8.m4.5.5.3.3.3.3.2.cmml" xref="S2.p8.8.m4.5.5.3.3.3.3.2">ğ‘–</ci><ci id="S2.p8.8.m4.5.5.3.3.3.3.3.cmml" xref="S2.p8.8.m4.5.5.3.3.3.3.3">ğ‘</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.8.m4.5c">P_{i}=[y_{i_{1}},\ldots,y_{i_{j}},\ldots,y_{i_{N}}]</annotation><annotation encoding="application/x-llamapun" id="S2.p8.8.m4.5d">italic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = [ italic_y start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_y start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT , â€¦ , italic_y start_POSTSUBSCRIPT italic_i start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="i" class="ltx_Math" display="inline" id="S2.p8.9.m5.1"><semantics id="S2.p8.9.m5.1a"><mi id="S2.p8.9.m5.1.1" xref="S2.p8.9.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p8.9.m5.1b"><ci id="S2.p8.9.m5.1.1.cmml" xref="S2.p8.9.m5.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.9.m5.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p8.9.m5.1d">italic_i</annotation></semantics></math> is the position in the sequence, after removing all the items after position <math alttext="i" class="ltx_Math" display="inline" id="S2.p8.10.m6.1"><semantics id="S2.p8.10.m6.1a"><mi id="S2.p8.10.m6.1.1" xref="S2.p8.10.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p8.10.m6.1b"><ci id="S2.p8.10.m6.1.1.cmml" xref="S2.p8.10.m6.1.1">ğ‘–</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.10.m6.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p8.10.m6.1d">italic_i</annotation></semantics></math> from the input sequence <math alttext="S" class="ltx_Math" display="inline" id="S2.p8.11.m7.1"><semantics id="S2.p8.11.m7.1a"><mi id="S2.p8.11.m7.1.1" xref="S2.p8.11.m7.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S2.p8.11.m7.1b"><ci id="S2.p8.11.m7.1.1.cmml" xref="S2.p8.11.m7.1.1">ğ‘†</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.11.m7.1c">S</annotation><annotation encoding="application/x-llamapun" id="S2.p8.11.m7.1d">italic_S</annotation></semantics></math>. This ensures that the popularity scores at each position are computed without experiencing temporal leakage from future data, and therefore maintain the causal structure of the sequence.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Experimental Setup</h2>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1. </span>Key statistics for the two music datasets, before and after applying a popularity-based sampling method to select 30,000 items (<span class="ltx_text ltx_font_italic" id="S3.T1.5.1">N</span>). <span class="ltx_text ltx_font_italic" id="S3.T1.6.2">Avg len</span> and <span class="ltx_text ltx_font_italic" id="S3.T1.7.3">Med len</span> denote the average and the median number of interactions per user, respectively.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T1.1.1.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.1.2.1" style="font-size:80%;">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S3.T1.1.1.1" style="padding-left:2.0pt;padding-right:2.0pt;">
<span class="ltx_text" id="S3.T1.1.1.1.1" style="font-size:80%;">Sampling (</span><math alttext="N=30000" class="ltx_Math" display="inline" id="S3.T1.1.1.1.m1.1"><semantics id="S3.T1.1.1.1.m1.1a"><mrow id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml"><mi id="S3.T1.1.1.1.m1.1.1.2" mathsize="80%" xref="S3.T1.1.1.1.m1.1.1.2.cmml">N</mi><mo id="S3.T1.1.1.1.m1.1.1.1" mathsize="80%" xref="S3.T1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S3.T1.1.1.1.m1.1.1.3" mathsize="80%" xref="S3.T1.1.1.1.m1.1.1.3.cmml">30000</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1"><eq id="S3.T1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1.1"></eq><ci id="S3.T1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.m1.1.1.2">ğ‘</ci><cn id="S3.T1.1.1.1.m1.1.1.3.cmml" type="integer" xref="S3.T1.1.1.1.m1.1.1.3">30000</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">N=30000</annotation><annotation encoding="application/x-llamapun" id="S3.T1.1.1.1.m1.1d">italic_N = 30000</annotation></semantics></math><span class="ltx_text" id="S3.T1.1.1.1.2" style="font-size:80%;">)</span>
</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.1.3.1" style="font-size:80%;">Users</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.1.4.1" style="font-size:80%;">Items</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.1.5.1" style="font-size:80%;">Interactions</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.1.6.1" style="font-size:80%;">Avg. len</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S3.T1.1.1.7" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.1.7.1" style="font-size:80%;">Med. len</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.2.1.1" rowspan="2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.2.1.1.1" style="font-size:80%;">Yandex</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.2.1.2" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.2.1.2.1" style="font-size:80%;background-color:#E6E6E6;">None</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.3" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.2.1.3.1" style="font-size:80%;background-color:#E6E6E6;">20862</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.4" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.2.1.4.1" style="font-size:80%;background-color:#E6E6E6;">300000</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.5" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.2.1.5.1" style="font-size:80%;background-color:#E6E6E6;">46919149</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.6" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.2.1.6.1" style="font-size:80%;background-color:#E6E6E6;">2249</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.2.1.7" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.2.1.7.1" style="font-size:80%;background-color:#E6E6E6;">2289</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S3.T1.1.3.2.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.3.2.1.1" style="font-size:80%;">Popularity-based</span></th>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.3.2.2.1" style="font-size:80%;">20862</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.3.2.3.1" style="font-size:80%;">30000</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.3.2.4.1" style="font-size:80%;">28408152</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.3.2.5.1" style="font-size:80%;">1362</span></td>
<td class="ltx_td ltx_align_center" id="S3.T1.1.3.2.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.3.2.6.1" style="font-size:80%;">1275</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S3.T1.1.4.3.1" rowspan="2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.4.3.1.1" style="font-size:80%;">Last.fm-1K</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S3.T1.1.4.3.2" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.4.3.2.1" style="font-size:80%;background-color:#E6E6E6;">None</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.3.3" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.4.3.3.1" style="font-size:80%;background-color:#E6E6E6;">992</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.3.4" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.4.3.4.1" style="font-size:80%;background-color:#E6E6E6;">961416</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.3.5" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.4.3.5.1" style="font-size:80%;background-color:#E6E6E6;">16982280</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.3.6" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.4.3.6.1" style="font-size:80%;background-color:#E6E6E6;">17119</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.1.4.3.7" style="background-color:#E6E6E6;padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.4.3.7.1" style="font-size:80%;background-color:#E6E6E6;">10249</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S3.T1.1.5.4.1" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.5.4.1.1" style="font-size:80%;">Popularity-based</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.5.4.2" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.5.4.2.1" style="font-size:80%;">990</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.5.4.3" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.5.4.3.1" style="font-size:80%;">30000</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.5.4.4" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.5.4.4.1" style="font-size:80%;">4990042</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.5.4.5" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.5.4.5.1" style="font-size:80%;">5040</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.1.5.4.6" style="padding-left:2.0pt;padding-right:2.0pt;"><span class="ltx_text" id="S3.T1.1.5.4.6.1" style="font-size:80%;">2605</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p1">
<p class="ltx_p" id="S3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.p1.1.1">Research Questions.</span> This section examines the effectiveness of incorporating personalized popularity awareness into sequential music recommender systems through a series of experiments designed to answer the following research questions:</p>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.ix1.1.1.1">RQ1</span></span>
<div class="ltx_para" id="S3.I1.ix1.p1">
<p class="ltx_p" id="S3.I1.ix1.p1.1">How effectively do state-of-the-art sequential recommender models behave on music datasets?</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S3.I1.ix2.1.1.1">RQ2</span></span>
<div class="ltx_para" id="S3.I1.ix2.p1">
<p class="ltx_p" id="S3.I1.ix2.p1.1">To what extent does explicitly incorporating personalized popularity information enhance the performance of sequential recommendation models in the context of music?</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para ltx_noindent" id="S3.p2">
<p class="ltx_p" id="S3.p2.1"><span class="ltx_text ltx_font_bold" id="S3.p2.1.1">Datasets.</span>
Our experiments are performed on the Yandex music event dataset<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.kaggle.com/competitions/yandex-music-event-2019-02-16" title="">https://www.kaggle.com/competitions/yandex-music-event-2019-02-16</a></span></span></span> and on the Last.fm-1K dataset<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="http://ocelma.net/MusicRecommendationDataset/lastfm-1K.html" title="">http://ocelma.net/MusicRecommendationDataset/lastfm-1K.html</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Celma, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib5" title="">2010</a>)</cite>.
In the Yandex dataset from 2019, there are four types of time-stamped interaction events on music tracks: <span class="ltx_text ltx_font_italic" id="S3.p2.1.2">like</span>, <span class="ltx_text ltx_font_italic" id="S3.p2.1.3">dislike</span>, <span class="ltx_text ltx_font_italic" id="S3.p2.1.4">play</span> and <span class="ltx_text ltx_font_italic" id="S3.p2.1.5">skip</span>.
Last.fm-1K is a smaller dataset, published in 2010, containing time-stamped play events for nearly 1,000 users.
Since training models with the whole datasets would require a large amount of GPU memory, we use a popularity-based item sampling method, which selects <math alttext="N" class="ltx_Math" display="inline" id="S3.p2.1.m1.1"><semantics id="S3.p2.1.m1.1a"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">ğ‘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1d">italic_N</annotation></semantics></math> items based on a probability distribution derived from global items counts in the users interactions, thus ensuring that more popular items have a higher chance of being selected while still allowing for the inclusion of less popular items. Other sampling methods, such as uniformly sampling interactions, would have not given the same guarantees of not injecting an additional popularity bias. Table 1 reports the overall statistics of the datasets before and after item sampling.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p3">
<p class="ltx_p" id="S3.p3.1"><span class="ltx_text ltx_font_bold" id="S3.p3.1.1">Models.</span>
The recommender models considered in the experiments comprise two variants of the Most Popular recommender and some of the most known sequential Transformer-based recommenders both in their original formulation, and integrating the personalized popularity scores (PPS) as per SectionÂ 2.
The <span class="ltx_text ltx_font_italic" id="S3.p3.1.2">Most Popular</span> recommender suggests items based on overall popularity across all users. Although it is a strong baselineÂ <cite class="ltx_cite ltx_citemacro_citep">(Cremonesi etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib7" title="">2010</a>)</cite>, in experiments we see <span class="ltx_text ltx_font_italic" id="S3.p3.1.3">Most Popular</span> exhibits sub-optimal performance compared to other models. We further include <span class="ltx_text ltx_font_italic" id="S3.p3.1.4">Personalized Most Popular</span>, following many existing worksÂ <cite class="ltx_cite ltx_citemacro_citep">(Anelli etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib3" title="">2019</a>; Ren etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib26" title="">2019</a>; Hidasi etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib14" title="">2016</a>; Hu and He, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib15" title="">2019</a>; Ariannezhad etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib4" title="">2022</a>; Faggioli etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib8" title="">2020</a>; Li etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib19" title="">2023</a>)</cite>. This baseline leverages the tendency of users to prefer and repeatedly listen to previously enjoyed music, demonstrating robust performance and highlighting the repeated consumption characteristic of music recommendation.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1">To evaluate the effectiveness of the <span class="ltx_text ltx_font_italic" id="S3.p4.1.1">Personalized Most Popular</span> baseline and personalized popularity score, we also compare them with state-of-the-art models for sequential recommendation: BERT4Rec <cite class="ltx_cite ltx_citemacro_citep">(Sun etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib29" title="">2019</a>)</cite>, SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib18" title="">2018</a>)</cite>, and its recent variant gSASRec <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib23" title="">2023</a>)</cite>. BERT4Rec is a model for sequential recommendations that leverages bidirectional self-attention mechanisms. SASRec is a sequential recommendation model that uses unidirectional self-attention. gSASRec (generalized SASRec) is a version of SASRec model with an increased number of negatives, trained with gBCE loss.
Finally, to show the effectiveness of personalized popularity score, we integrate it into these models, assessing whether they generate more accurate and relevant music recommendations.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T2.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S3.T2.1.1.1.1" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.1.1.1.1" style="font-size:80%;">Model</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S3.T2.1.1.1.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.1.1.2.1" style="font-size:80%;">Yandex</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S3.T2.1.1.1.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.1.1.3.1" style="font-size:80%;">Last.fm-1K</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.2.2.1.1" style="font-size:80%;">NDCG@5</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.2.2.2.1" style="font-size:80%;">NDCG@10</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.2.2.3.1" style="font-size:80%;">NDCG@40</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.2.2.4.1" style="font-size:80%;">NDCG@100</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.2.2.5.1" style="font-size:80%;">NDCG@5</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.2.2.6.1" style="font-size:80%;">NDCG@10</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.2.2.7.1" style="font-size:80%;">NDCG@40</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.2.2.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.2.2.8.1" style="font-size:80%;">NDCG@100</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.3.3" style="background-color:#E6E6E6;">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.3.3.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.3.3.1.1" style="font-size:80%;background-color:#E6E6E6;">Most Popular</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.3.3.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.3.3.2.1" style="font-size:80%;background-color:#E6E6E6;">0.0447</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.3.3.3.1" style="font-size:80%;background-color:#E6E6E6;">0.0416</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.3.3.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.3.3.4.1" style="font-size:80%;background-color:#E6E6E6;">0.0386</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.3.3.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.3.3.5.1" style="font-size:80%;background-color:#E6E6E6;">0.0449</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.3.3.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.3.3.6.1" style="font-size:80%;background-color:#E6E6E6;">0.0946</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.3.3.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.3.3.7.1" style="font-size:80%;background-color:#E6E6E6;">0.0889</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.3.3.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.3.3.8.1" style="font-size:80%;background-color:#E6E6E6;">0.0831</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.3.3.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.3.3.9.1" style="font-size:80%;background-color:#E6E6E6;">0.0817</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4.4">
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.4.4.1.1" style="font-size:80%;">Personalized Most Popular</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.4.4.2.1" style="font-size:80%;">0.1866</span><span class="ltx_text" id="S3.T2.1.4.4.2.2" style="font-size:80%;">*</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.4.4.3.1" style="font-size:80%;">0.1826</span><span class="ltx_text" id="S3.T2.1.4.4.3.2" style="font-size:80%;">*</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.4.4.4.1" style="font-size:80%;">0.1721</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.4.4.5.1" style="font-size:80%;">0.1947</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.4.4.6.1" style="font-size:80%;">0.5366</span><span class="ltx_text" id="S3.T2.1.4.4.6.2" style="font-size:80%;">*</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.4.4.7.1" style="font-size:80%;">0.5056</span><span class="ltx_text" id="S3.T2.1.4.4.7.2" style="font-size:80%;">*</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S3.T2.1.4.4.8.1" style="font-size:80%;">0.4138</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.4.4.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.4.4.9.1" style="font-size:80%;">0.3554</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5.5" style="background-color:#E6E6E6;">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.5.5.1.1" style="font-size:80%;background-color:#E6E6E6;">BERT4Rec</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.5.5.2.1" style="font-size:80%;background-color:#E6E6E6;">0.1311</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.5.5.3.1" style="font-size:80%;background-color:#E6E6E6;">0.1263</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.5.5.4.1" style="font-size:80%;background-color:#E6E6E6;">0.1248</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.5.5.5.1" style="font-size:80%;background-color:#E6E6E6;">0.1466</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.5.5.6.1" style="font-size:80%;background-color:#E6E6E6;">0.3504</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.5.5.7.1" style="font-size:80%;background-color:#E6E6E6;">0.3164</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.5.5.8.1" style="font-size:80%;background-color:#E6E6E6;">0.2437</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.5.5.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.5.5.9.1" style="font-size:80%;background-color:#E6E6E6;">0.2108</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6.6">
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.6.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.6.6.1.1" style="font-size:80%;">BERT4Rec w/ PPS</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.6.6.2.1" style="font-size:80%;">0.1780</span><span class="ltx_text" id="S3.T2.1.6.6.2.2" style="font-size:80%;">â€ â€†(+35.8%)</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.6.6.3.1" style="font-size:80%;">0.1745</span><span class="ltx_text" id="S3.T2.1.6.6.3.2" style="font-size:80%;">â€ â€†(+38.2%)</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.6.6.4.1" style="font-size:80%;">0.1765</span><span class="ltx_text" id="S3.T2.1.6.6.4.2" style="font-size:80%;">*â€ â€†(+41.4%)</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.6.6.5.1" style="font-size:80%;">0.2024</span><span class="ltx_text" id="S3.T2.1.6.6.5.2" style="font-size:80%;">*â€ â€†(+38.1%)</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.6.6.6.1" style="font-size:80%;">0.5096</span><span class="ltx_text" id="S3.T2.1.6.6.6.2" style="font-size:80%;">â€ â€†(+45.4%)</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.6.7" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.6.6.7.1" style="font-size:80%;">0.4812</span><span class="ltx_text" id="S3.T2.1.6.6.7.2" style="font-size:80%;">â€ â€†(+52.1%)</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.6.8" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.6.6.8.1" style="font-size:80%;">0.4100</span><span class="ltx_text" id="S3.T2.1.6.6.8.2" style="font-size:80%;">â€ â€†(+68.2%)</span>
</td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.6.6.9" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.6.6.9.1" style="font-size:80%;">0.3579</span><span class="ltx_text" id="S3.T2.1.6.6.9.2" style="font-size:80%;">â€ â€†(+69.8%)</span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.7.7" style="background-color:#E6E6E6;">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.7.7.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.7.7.1.1" style="font-size:80%;background-color:#E6E6E6;">SASRec</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.7.7.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.7.7.2.1" style="font-size:80%;background-color:#E6E6E6;">0.1025</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.7.7.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.7.7.3.1" style="font-size:80%;background-color:#E6E6E6;">0.1030</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.7.7.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.7.7.4.1" style="font-size:80%;background-color:#E6E6E6;">0.1086</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.7.7.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.7.7.5.1" style="font-size:80%;background-color:#E6E6E6;">0.1332</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.7.7.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.7.7.6.1" style="font-size:80%;background-color:#E6E6E6;">0.3381</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.7.7.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.7.7.7.1" style="font-size:80%;background-color:#E6E6E6;">0.3160</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.7.7.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.7.7.8.1" style="font-size:80%;background-color:#E6E6E6;">0.2625</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.7.7.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.7.7.9.1" style="font-size:80%;background-color:#E6E6E6;">0.2317</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.8.8">
<td class="ltx_td ltx_align_left" id="S3.T2.1.8.8.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.8.8.1.1" style="font-size:80%;">SASRec w/ PPS</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.8.8.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.8.8.2.1" style="font-size:80%;">0.1658â€ â€†(+61.8%)</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.8.8.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.8.8.3.1" style="font-size:80%;">0.1647â€ â€†(+59.9%)</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.8.8.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.8.8.4.1" style="font-size:80%;">0.1718â€ â€†(+58.2%)</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.8.8.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.8.8.5.1" style="font-size:80%;">0.2012â€ â€†(+51.1%)</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.8.8.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.8.8.6.1" style="font-size:80%;">0.4500â€ â€†(+33.1%)</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.8.8.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.8.8.7.1" style="font-size:80%;">0.4258â€ â€†(+34.8%)</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.8.8.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.8.8.8.1" style="font-size:80%;">0.3785â€ â€†(+44.2%)</span></td>
<td class="ltx_td ltx_align_left" id="S3.T2.1.8.8.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.8.8.9.1" style="font-size:80%;">0.3410â€ â€†(+47.2%)</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.9.9" style="background-color:#E6E6E6;">
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.9.9.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.9.9.1.1" style="font-size:80%;background-color:#E6E6E6;">gSASRec</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.9.9.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.9.9.2.1" style="font-size:80%;background-color:#E6E6E6;">0.1418</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.9.9.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.9.9.3.1" style="font-size:80%;background-color:#E6E6E6;">0.1364</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.9.9.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.9.9.4.1" style="font-size:80%;background-color:#E6E6E6;">0.1353</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.9.9.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.9.9.5.1" style="font-size:80%;background-color:#E6E6E6;">0.1592</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.9.9.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.9.9.6.1" style="font-size:80%;background-color:#E6E6E6;">0.3475</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.9.9.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.9.9.7.1" style="font-size:80%;background-color:#E6E6E6;">0.3222</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.9.9.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.9.9.8.1" style="font-size:80%;background-color:#E6E6E6;">0.2559</span></td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T2.1.9.9.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.9.9.9.1" style="font-size:80%;background-color:#E6E6E6;">0.2218</span></td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.10.10">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.10.10.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.10.10.1.1" style="font-size:80%;">gSASRec w/ PPS</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.10.10.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.10.10.2.1" style="font-size:80%;">0.1776â€ â€†(+25.2%)</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.10.10.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.10.10.3.1" style="font-size:80%;">0.1737â€ â€†(+27.3%)</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.10.10.4" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.10.10.4.1" style="font-size:80%;">0.1747</span><span class="ltx_text" id="S3.T2.1.10.10.4.2" style="font-size:80%;">â€ â€†(+29.1%)</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.10.10.5" style="padding-left:3.0pt;padding-right:3.0pt;">
<span class="ltx_text ltx_framed ltx_framed_underline" id="S3.T2.1.10.10.5.1" style="font-size:80%;">0.2013</span><span class="ltx_text" id="S3.T2.1.10.10.5.2" style="font-size:80%;">â€ â€†(+26.4%)</span>
</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.10.10.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.10.10.6.1" style="font-size:80%;">0.4990â€ â€†(+43.6%)</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.10.10.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.10.10.7.1" style="font-size:80%;">0.4710â€ â€†(+46.2%)</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.10.10.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.10.10.8.1" style="font-size:80%;">0.4006â€ â€†(+56.6%)</span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S3.T2.1.10.10.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S3.T2.1.10.10.9.1" style="font-size:80%;">0.3534â€ â€†(+59.3%)</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 2. </span>Experimental results.
The best results are highlighted in bold; second best are underlined. * and â€ â€† denote statistically significant differences (<span class="ltx_text ltx_font_italic" id="S3.T2.6.1">p-value</span> Â¡ 0.05, Bonferroni multi-test correction) between the best model and the second best one, and between the model w/ PPS and the one w/o PPS., respectively.
Improvements over models w/o PPS are shown in parentheses.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S3.p5">
<p class="ltx_p" id="S3.p5.2"><span class="ltx_text ltx_font_bold" id="S3.p5.2.1">Implementation Details.</span>
We use PyTorch<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://pytorch.org/docs/stable/index.html" title="">https://pytorch.org/docs/stable/index.html</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Paszke etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib21" title="">2019</a>)</cite> library to implement all the models, except for <span class="ltx_text ltx_font_italic" id="S3.p5.2.2">Most Popular</span> and <span class="ltx_text ltx_font_italic" id="S3.p5.2.3">Personalized Most Popular</span>. Moreover, we rely on Hugging Faceâ€™s Transformers<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://huggingface.co/transformers" title="">https://huggingface.co/transformers</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Wolf etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib33" title="">2020</a>)</cite> library to implement BERT4Rec with and without PPS. We use the aprec<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/asash/BERT4Rec_repro" title="">https://github.com/asash/BERT4Rec_repro</a></span></span></span> framework from <cite class="ltx_cite ltx_citemacro_citep">(Petrov and Macdonald, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib22" title="">2022</a>)</cite>.
We selected the hyperparameters, i.e. the choice of optimizer (Adam, AdamW), the learning rate (0.1, 0.001, 0.0001), the weight decay (0, 0.5), the early stopping patience (200, 500) and the <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.p5.1.m1.1"><semantics id="S3.p5.1.m1.1a"><mi id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">Ïµ</mi><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><ci id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">italic-Ïµ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.1.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1d">italic_Ïµ</annotation></semantics></math> smoothing parameter (0.01, 0.05, 0.1, 0.2), through an extensive search (<math alttext="\approx 338" class="ltx_Math" display="inline" id="S3.p5.2.m2.1"><semantics id="S3.p5.2.m2.1a"><mrow id="S3.p5.2.m2.1.1" xref="S3.p5.2.m2.1.1.cmml"><mi id="S3.p5.2.m2.1.1.2" xref="S3.p5.2.m2.1.1.2.cmml"></mi><mo id="S3.p5.2.m2.1.1.1" xref="S3.p5.2.m2.1.1.1.cmml">â‰ˆ</mo><mn id="S3.p5.2.m2.1.1.3" xref="S3.p5.2.m2.1.1.3.cmml">338</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.2.m2.1b"><apply id="S3.p5.2.m2.1.1.cmml" xref="S3.p5.2.m2.1.1"><approx id="S3.p5.2.m2.1.1.1.cmml" xref="S3.p5.2.m2.1.1.1"></approx><csymbol cd="latexml" id="S3.p5.2.m2.1.1.2.cmml" xref="S3.p5.2.m2.1.1.2">absent</csymbol><cn id="S3.p5.2.m2.1.1.3.cmml" type="integer" xref="S3.p5.2.m2.1.1.3">338</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p5.2.m2.1c">\approx 338</annotation><annotation encoding="application/x-llamapun" id="S3.p5.2.m2.1d">â‰ˆ 338</annotation></semantics></math> GPU hours). For further research we made the chosen hyperparameters and code publicly available<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/sisinflab/personalized-popularity-awareness" title="">https://github.com/sisinflab/personalized-popularity-awareness</a></span></span></span>.
Experiments are conducted using 16-cores of an AMD Ryzen Threadripper PRO 3955WX CPU with 128GB of RAM and an Nvidia RTX 3090 GPU with 24GB of VRAM. Given these capabilities, we limit the length of the input sequences to 150.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.p6">
<p class="ltx_p" id="S3.p6.2"><span class="ltx_text ltx_font_bold" id="S3.p6.2.1">Evaluation Details.</span>
Following sequential recommendation best practices <cite class="ltx_cite ltx_citemacro_citep">(Chou etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib6" title="">2015</a>; Hidasi and Czapp, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib13" title="">2023</a>; Schedl etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib27" title="">2022</a>)</cite>, we evaluate models using a Global Temporal Split strategy and Normalized Discounted Cumulative Gain (NDCG) <cite class="ltx_cite ltx_citemacro_citep">(JÃ¤rvelin and KekÃ¤lÃ¤inen, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib17" title="">2002</a>)</cite>.
The Global Temporal Split strategy splits the interactions in the dataset given a test fraction and a validation fraction, both set to <math alttext="0.1" class="ltx_Math" display="inline" id="S3.p6.1.m1.1"><semantics id="S3.p6.1.m1.1a"><mn id="S3.p6.1.m1.1.1" xref="S3.p6.1.m1.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S3.p6.1.m1.1b"><cn id="S3.p6.1.m1.1.1.cmml" type="float" xref="S3.p6.1.m1.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.1.m1.1c">0.1</annotation><annotation encoding="application/x-llamapun" id="S3.p6.1.m1.1d">0.1</annotation></semantics></math>.
Specifically, all interactions in the dataset are sorted by their timestamp and the global test border timestamp is obtained taking the one of the interactions in the position that leaves 10% of all interactions for testing.
For each user we hold out the interactions after the global test border timestamp as the test set.
We also construct a validation set with the same strategy using a group of 2048 users with Yandex music event dataset and 128 users with Last.fm-1K dataset (approximately the <math alttext="10\%" class="ltx_Math" display="inline" id="S3.p6.2.m2.1"><semantics id="S3.p6.2.m2.1a"><mrow id="S3.p6.2.m2.1.1" xref="S3.p6.2.m2.1.1.cmml"><mn id="S3.p6.2.m2.1.1.2" xref="S3.p6.2.m2.1.1.2.cmml">10</mn><mo id="S3.p6.2.m2.1.1.1" xref="S3.p6.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.2.m2.1b"><apply id="S3.p6.2.m2.1.1.cmml" xref="S3.p6.2.m2.1.1"><csymbol cd="latexml" id="S3.p6.2.m2.1.1.1.cmml" xref="S3.p6.2.m2.1.1.1">percent</csymbol><cn id="S3.p6.2.m2.1.1.2.cmml" type="integer" xref="S3.p6.2.m2.1.1.2">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p6.2.m2.1c">10\%</annotation><annotation encoding="application/x-llamapun" id="S3.p6.2.m2.1d">10 %</annotation></semantics></math> of the users).
Following <cite class="ltx_cite ltx_citemacro_citet">Yakura etÂ al<span class="ltx_text">.</span> (<a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib34" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib35" title="">2022</a>)</cite>, in the Yandex dataset, we assign labels to items for the purposes of calculating NDCG, based on the user-track interaction type: like=2, play=1<span class="ltx_text" id="S3.p6.2.2" style="color:#FF0000;">,</span> skip=-1, dislike=-2. To handle the repeated consumption patterns within the dataset ground truth, the label is assigned based on the first interaction and updated only if the absolute value of the new one is greater or equal than the absolute value of the previous one: (i) if a user likes or dislikes a track, the corresponding label is updated, regardless its past interactions with that track, (ii) if a user plays or skips a track, the corresponding label is updated only if that user has not liked nor disliked that track in the past.
Negative interactions (dislike, skip) are then assigned a label of 0, to avoid instability of NDCG in the presence of negatively scored labels <cite class="ltx_cite ltx_citemacro_citep">(Gienapp etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib11" title="">2020</a>)</cite>.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Results</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">Our experimental results are presented in TableÂ <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#S3.T2" title="Table 2 â€£ 3. Experimental Setup â€£ Enhancing Sequential Music Recommendation with Personalized Popularity Awareness"><span class="ltx_text ltx_ref_tag">2</span></a>, which compares the performance of various recommendation models on the Yandex and Last.fm-1K datasets. These models include variations of Most Popular recommender, Transformer-based models, and their counterparts enhanced with personalized popularity scores (PPS).
To measure the significance of performance differences, we use the paired t-test with Bonferroni multiple testing correction (<span class="ltx_text ltx_font_italic" id="S4.p1.1.1">p-value</span> Â¡ 0.05), following recommended practices in IR <cite class="ltx_cite ltx_citemacro_citep">(Fuhr, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib10" title="">2020</a>)</cite>.
In the table, we use * to denote statistically significant differences between the best and second-best models, and <math alttext="{\dagger}" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mo id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">â€ </mo><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">â€ </ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">{\dagger}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">â€ </annotation></semantics></math> to denote statistically significant differences between models with and without integrated personalized popularity scores.
The table presents the results using the NDCG at various cutoffs (@5, @10, @40, and @100). Additionally, the relative improvements achieved by incorporating personalized popularity scores are shown in parentheses.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.p2.1.1">RQ1.</span>
With respect to the performance of state-of-the-art transformer-based sequential recommenders, we unexpectedly find that BERT4Rec, SASRec, and gSASRec fail to outperform <span class="ltx_text ltx_font_italic" id="S4.p2.1.2">Personalized Most Popular</span> in the context of music recommendation. Although the strength of this baseline is known in the literature <cite class="ltx_cite ltx_citemacro_citep">(Ren etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib26" title="">2019</a>; Hidasi etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib14" title="">2016</a>; Hu and He, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib15" title="">2019</a>; Ariannezhad etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib4" title="">2022</a>; Faggioli etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib8" title="">2020</a>; Li etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib19" title="">2023</a>; Hu etÂ al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.04329v1#bib.bib16" title="">2020</a>)</cite>, its dominance in the music domain has not been previously highlighted. Our results underscore the importance of user-specific popularity in music recommendation and indicate that tracks frequently enjoyed by users have a high probability of being replayed. This highlights the strong repetitive consumption patterns among listeners.
In addition, our results reveal a significant challenge faced by state-of-the-art sequential recommendation models, such as BERT4Rec, SASRec, and gSASRec. These models struggle to effectively capture and learn the repeated consumption patterns that are essential for providing accurate and relevant music recommendations. This difficulty suggests a need for further refinement and adaptation of these models to better address the characteristics of music listening behavior.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_framed ltx_framed_rectangle" id="S4.p3.1.1" style="border-color: #FFFFFF;">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S4.p3.1.1.1" style="width:420.6pt;background-color:#E0EAF8;">
<span class="ltx_p" id="S4.p3.1.1.1.1">Contrary to expectations, the more complex Transformer-based models did not outperform the Personalized Most Popular recommender, revealing that usersâ€™ strong preference for replaying previously enjoyed tracks is a more significant factor in music recommendation than complex algorithmic predictions.</span>
</span><span class="ltx_text" id="S4.p3.1.1.2" style="background-color:#E0EAF8;">
</span></span></p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p4">
<p class="ltx_p" id="S4.p4.1"><span class="ltx_text ltx_font_bold" id="S4.p4.1.1">RQ2.</span>
By incorporating personalized popularity scores (PPS) into Transformer-based models, we achieve performance levels comparable to the simplistic <span class="ltx_text ltx_font_italic" id="S4.p4.1.2">Personalized Most Popular</span> baseline at lower ranking cutoffs, such as NDCG@10, and surpass it at higher ranking cutoffs, such as NDCG@100. This integration allows the models to leverage the inherent user-specific popularity bias effectively.
Our results indicate that introducing an inclination towards frequently played tracks significantly enhances model performance, in a range from 25.2% to 69.8%. This highlights the importance of accounting for usersâ€™ tendencies to repeatedly enjoy certain tracks, suggesting that Transformer-based models can benefit greatly from integrating personalized popularity information. By doing so, these models become more adept at reflecting the natural listening habits of users, leading to more effective and satisfying music recommendations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p5">
<p class="ltx_p" id="S4.p5.1"><span class="ltx_text ltx_framed ltx_framed_rectangle" id="S4.p5.1.1" style="border-color: #FFFFFF;">
<span class="ltx_inline-block ltx_parbox ltx_align_middle" id="S4.p5.1.1.1" style="width:420.6pt;background-color:#E0EAF8;">
<span class="ltx_p" id="S4.p5.1.1.1.1">By explicitly integrating personalized popularity information into Transformer-based models, their performance in music recommendation was significantly improved, achieving comparable or even surpassing the Personalized Most Popular recommender, demonstrating the importance of directly incorporating usersâ€™ preference for replaying previously enjoyed tracks.</span>
</span><span class="ltx_text" id="S4.p5.1.1.2" style="background-color:#E0EAF8;">
</span></span></p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusions</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This work demonstrates that music recommendation benefits considerably from incorporating personalized popularity awareness. Experimental results on the Yandex Music Event and Last.fm-1K datasets show that recommending based on user-specific listening history, as exemplified by the Personalized Most Popular recommender, outperforms several state-of-the-art sequential models, including BERT4Rec, SASRec, and gSASRec. This highlights the significant influence of repeated listening patterns in music consumption, which the more complex models struggle to capture effectively.
Furthermore, integrating personalized popularity scores into Transformer-based models leads to performance comparable to the Personalized Most Popular recommender at lower ranking cutoffs and even surpasses it at higher cutoffs. This suggests that directly incorporating a bias towards previously enjoyed tracks enhances recommendation accuracy.
Future work can explore several promising avenues, including investigating techniques beyond scores integration, exploring the impact of popularity awareness in other recommendation domains, and examining the long-term effects of popularity-aware recommendation, specifically the potential to create filter bubbles or limit user exposure to novel content.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
Anelli and Di Noia acknowledge partial support of the following projects: OVS: Fashion Retail Reloaded, Lutech Digitale 4.0, Secure Safe Apulia, Patti Territoriali WP1, BIO-D, Reach-XY.

</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amjadi etÂ al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Mehrnaz Amjadi, Seyed
DanialÂ Mohseni Taheri, and Theja Tulabandhula.
2021.

</span>
<span class="ltx_bibblock">KATRec: Knowledge Aware aTtentive Sequential
Recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">DS</em>
<em class="ltx_emph ltx_font_italic" id="bib.bib2.4.2">(Lecture Notes in Computer Science,
Vol.Â 12986)</em>. Springer,
305â€“320.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anelli etÂ al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
VitoÂ Walter Anelli,
TommasoÂ Di Noia, EugenioÂ Di Sciascio,
Azzurra Ragone, and Joseph Trotta.
2019.

</span>
<span class="ltx_bibblock">Local Popularity and Time in top-N Recommendation.
In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">ECIR (1)</em> <em class="ltx_emph ltx_font_italic" id="bib.bib3.4.2">(Lecture
Notes in Computer Science, Vol.Â 11437)</em>.
Springer, 861â€“868.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ariannezhad etÂ al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Mozhdeh Ariannezhad, Sami
Jullien, Ming Li, Min Fang,
Sebastian Schelter, and Maarten de
Rijke. 2022.

</span>
<span class="ltx_bibblock">ReCANet: A Repeat Consumption-Aware Neural
Network for Next Basket Recommendation in Grocery Shopping. In
<em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">SIGIR</em>. ACM,
1240â€“1250.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Celma (2010)</span>
<span class="ltx_bibblock">
O. Celma. 2010.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Music Recommendation and Discovery in the
Long Tail</em>.

</span>
<span class="ltx_bibblock">Springer.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chou etÂ al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Szu-Yu Chou, Yi-Hsuan
Yang, and Yu-Ching Lin.
2015.

</span>
<span class="ltx_bibblock">Evaluating music recommendation in a real-world
setting: On data splitting and evaluation metrics. In
<em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">ICME</em>. IEEE Computer
Society, 1â€“6.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cremonesi etÂ al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2010)</span>
<span class="ltx_bibblock">
Paolo Cremonesi, Yehuda
Koren, and Roberto Turrin.
2010.

</span>
<span class="ltx_bibblock">Performance of recommender algorithms on top-n
recommendation tasks. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">RecSys</em>.
ACM, 39â€“46.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Faggioli etÂ al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Guglielmo Faggioli, Mirko
Polato, and Fabio Aiolli.
2020.

</span>
<span class="ltx_bibblock">Recency Aware Collaborative Filtering for Next
Basket Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">UMAP</em>.
ACM, 80â€“87.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan etÂ al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Ziwei Fan, Zhiwei Liu,
Jiawei Zhang, Yun Xiong,
Lei Zheng, and PhilipÂ S. Yu.
2021.

</span>
<span class="ltx_bibblock">Continuous-Time Sequential Recommendation with
Temporal Graph Collaborative Transformer. In
<em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">CIKM</em>. ACM,
433â€“442.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fuhr (2020)</span>
<span class="ltx_bibblock">
Norbert Fuhr.
2020.

</span>
<span class="ltx_bibblock">Proof by experimentation?: towards better IR
research.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">SIGIR Forum</em> 54,
2 (2020), 2:1â€“2:4.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gienapp etÂ al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Lukas Gienapp, Maik
FrÃ¶be, Matthias Hagen, and Martin
Potthast. 2020.

</span>
<span class="ltx_bibblock">The Impact of Negative Relevance Judgments on
NDCG. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">CIKM</em>. ACM,
2037â€“2040.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hastie etÂ al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2001)</span>
<span class="ltx_bibblock">
Trevor Hastie, Robert
Tibshirani, and Jerome Friedman.
2001.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">The Elements of Statistical Learning</em>.

</span>
<span class="ltx_bibblock">Springer New York Inc., New
York, NY, USA.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi and Czapp (2023)</span>
<span class="ltx_bibblock">
BalÃ¡zs Hidasi and
ÃdÃ¡mÂ Tibor Czapp.
2023.

</span>
<span class="ltx_bibblock">Widespread Flaws in Offline Evaluation of
Recommender Systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">RecSys</em>.
ACM, 848â€“855.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi etÂ al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
BalÃ¡zs Hidasi,
Alexandros Karatzoglou, Linas Baltrunas,
and Domonkos Tikk. 2016.

</span>
<span class="ltx_bibblock">Session-based Recommendations with Recurrent Neural
Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">ICLR (Poster)</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu and He (2019)</span>
<span class="ltx_bibblock">
Haoji Hu and Xiangnan
He. 2019.

</span>
<span class="ltx_bibblock">Sets2Sets: Learning from Sequential Sets with
Neural Networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">KDD</em>.
ACM, 1491â€“1499.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu etÂ al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Haoji Hu, Xiangnan He,
Jinyang Gao, and Zhi-Li Zhang.
2020.

</span>
<span class="ltx_bibblock">Modeling Personalized Item Frequency Information
for Next-basket Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">SIGIR</em>.
ACM, 1071â€“1080.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">JÃ¤rvelin and KekÃ¤lÃ¤inen (2002)</span>
<span class="ltx_bibblock">
Kalervo JÃ¤rvelin and
Jaana KekÃ¤lÃ¤inen.
2002.

</span>
<span class="ltx_bibblock">Cumulated gain-based evaluation of IR
techniques.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">ACM Trans. Inf. Syst.</em>
20, 4 (2002),
422â€“446.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and
JulianÂ J. McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-Attentive Sequential Recommendation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">ICDM</em>. IEEE Computer
Society, 197â€“206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li etÂ al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Ming Li, Sami Jullien,
Mozhdeh Ariannezhad, and Maarten de
Rijke. 2023.

</span>
<span class="ltx_bibblock">A Next Basket Recommendation Reality Check.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">ACM Trans. Inf. Syst.</em>
41, 4 (2023),
116:1â€“116:29.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma etÂ al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jun Ma, Pengpeng Zhao,
Yanchi Liu, VictorÂ S. Sheng,
Jiajie Xu, and Lei Zhao.
2020.

</span>
<span class="ltx_bibblock">Modeling Periodic Pattern with Self-Attention
Network for Sequential Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">DASFAA
(3)</em> <em class="ltx_emph ltx_font_italic" id="bib.bib20.4.2">(Lecture Notes in Computer Science,
Vol.Â 12114)</em>. Springer,
557â€“572.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Paszke etÂ al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross,
Francisco Massa, Adam Lerer,
James Bradbury, Gregory Chanan,
Trevor Killeen, Zeming Lin,
Natalia Gimelshein, Luca Antiga,
Alban Desmaison, Andreas KÃ¶pf,
EdwardÂ Z. Yang, Zachary DeVito,
Martin Raison, Alykhan Tejani,
Sasank Chilamkurthy, Benoit Steiner,
Lu Fang, Junjie Bai, and
Soumith Chintala. 2019.

</span>
<span class="ltx_bibblock">PyTorch: An Imperative Style, High-Performance Deep
Learning Library. In <em class="ltx_emph ltx_font_italic" id="bib.bib21.3.1">NeurIPS</em>.
8024â€“8035.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petrov and Macdonald (2022)</span>
<span class="ltx_bibblock">
AleksandrÂ V. Petrov and
Craig Macdonald. 2022.

</span>
<span class="ltx_bibblock">A Systematic Review and Replicability Study of
BERT4Rec for Sequential Recommendation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">RecSys</em>. ACM,
436â€“447.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Petrov and Macdonald (2023)</span>
<span class="ltx_bibblock">
AleksandrÂ Vladimirovich Petrov and
Craig Macdonald. 2023.

</span>
<span class="ltx_bibblock">gSASRec: Reducing Overconfidence in Sequential
Recommendation Trained with Negative Sampling. In
<em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">RecSys</em>. ACM,
116â€“128.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quadrana etÂ al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Massimo Quadrana, Paolo
Cremonesi, and Dietmar Jannach.
2018.

</span>
<span class="ltx_bibblock">Sequence-Aware Recommender Systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">ACM Comput. Surv.</em> 51,
4 (2018), 66:1â€“66:36.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Quan etÂ al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Shigang Quan, Shui Liu,
Zhenzhe Zheng, and Fan Wu.
2023.

</span>
<span class="ltx_bibblock">Enhancing Repeat-Aware Recommendation from a
Temporal-Sequential Perspective. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">CIKM</em>.
ACM, 2095â€“2105.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren etÂ al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Pengjie Ren, Zhumin Chen,
Jing Li, Zhaochun Ren,
Jun Ma, and Maarten de Rijke.
2019.

</span>
<span class="ltx_bibblock">RepeatNet: A Repeat Aware Neural Recommendation
Machine for Session-Based Recommendation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">AAAI</em>. AAAI Press,
4806â€“4813.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schedl etÂ al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Markus Schedl, Peter
Knees, Brian McFee, and Dmitry
Bogdanov. 2022.

</span>
<span class="ltx_bibblock">Music Recommendation Systems: Techniques, Use
Cases, and Challenges.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Recommender Systems Handbook</em>,
Francesco Ricci, Lior
Rokach, and Bracha Shapira (Eds.).
Springer US, 927â€“971.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shin etÂ al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Yehjin Shin, Jeongwhan
Choi, Hyowon Wi, and Noseong Park.
2024.

</span>
<span class="ltx_bibblock">An Attentive Inductive Bias for Sequential
Recommendation beyond the Self-Attention. In
<em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">AAAI</em>. AAAI Press,
8984â€“8992.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun etÂ al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu,
Jian Wu, Changhua Pei,
Xiao Lin, Wenwu Ou, and
Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential Recommendation with
Bidirectional Encoder Representations from Transformer. In
<em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">CIKM</em>. ACM,
1441â€“1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tong etÂ al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Xiaohai Tong, Pengfei
Wang, Chenliang Li, Long Xia, and
Shaozhang Niu. 2021.

</span>
<span class="ltx_bibblock">Pattern-enhanced Contrastive Policy Learning
Network for Sequential Recommendation. In
<em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">IJCAI</em>. ijcai.org,
1593â€“1599.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tran etÂ al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Viet-Anh Tran, Guillaume
Salha-Galvan, Bruno Sguerra, and
Romain Hennequin. 2023.

</span>
<span class="ltx_bibblock">Attention Mixtures for Time-Aware Sequential
Recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">SIGIR</em>.
ACM, 1821â€“1826.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani etÂ al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam
Shazeer, Niki Parmar, Jakob Uszkoreit,
Llion Jones, AidanÂ N. Gomez,
Lukasz Kaiser, and Illia Polosukhin.
2017.

</span>
<span class="ltx_bibblock">Attention is All you Need. In
<em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">NIPS</em>. 5998â€“6008.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wolf etÂ al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Thomas Wolf, Lysandre
Debut, Victor Sanh, Julien Chaumond,
Clement Delangue, Anthony Moi,
Pierric Cistac, Tim Rault,
RÃ©mi Louf, Morgan Funtowicz,
Joe Davison, Sam Shleifer,
Patrick von Platen, Clara Ma,
Yacine Jernite, Julien Plu,
Canwen Xu, TevenÂ Le Scao,
Sylvain Gugger, Mariama Drame,
Quentin Lhoest, and AlexanderÂ M. Rush.
2020.

</span>
<span class="ltx_bibblock">Transformers: State-of-the-Art Natural Language
Processing. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">EMNLP (Demos)</em>.
Association for Computational Linguistics,
38â€“45.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yakura etÂ al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Hiromu Yakura, Tomoyasu
Nakano, and Masataka Goto.
2018.

</span>
<span class="ltx_bibblock">FocusMusicRecommender: A System for Recommending
Music to Listen to While Working. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">IUI</em>.
ACM, 7â€“17.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yakura etÂ al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Hiromu Yakura, Tomoyasu
Nakano, and Masataka Goto.
2022.

</span>
<span class="ltx_bibblock">An automated system recommending background music
to listen to while working.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">User Model. User Adapt. Interact.</em>
32, 3 (2022),
355â€“388.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang etÂ al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Gang Yang, Xiaofeng
Zhang, and Yueping Li. 2020.

</span>
<span class="ltx_bibblock">Session-Based Recommendation with Graph Neural
Networks for Repeat Consumption. In <em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">ICCPR</em>.
ACM, 519â€“524.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang etÂ al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yixin Zhang, Lizhen Cui,
Wei He, Xudong Lu, and
Shipeng Wang. 2021.

</span>
<span class="ltx_bibblock">Behavioral data assists decisions: exploring the
mental representation of digital-self.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">Int. J. Crowd Sci.</em> 5,
2 (2021), 185â€“203.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou etÂ al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Kun Zhou, Hui Wang,
WayneÂ Xin Zhao, Yutao Zhu,
Sirui Wang, Fuzheng Zhang,
Zhongyuan Wang, and Ji-Rong Wen.
2020.

</span>
<span class="ltx_bibblock">S3-Rec: Self-Supervised Learning for Sequential
Recommendation with Mutual Information Maximization. In
<em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">CIKM</em>. ACM,
1893â€“1902.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Sep  6 14:59:49 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
