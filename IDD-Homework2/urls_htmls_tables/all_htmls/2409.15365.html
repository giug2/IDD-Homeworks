<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Novel Saliency Analysis for the Forward-Forward Algorithm</title>
<!--Generated on Wed Sep 18 17:08:01 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Forward-Forward Algorithm,  Saliency,  MLP
" lang="en" name="keywords"/>
<base href="/html/2409.15365v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#S1" title="In Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#S2" title="In Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Related Work</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#S3" title="In Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Methodology</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#S3.SS1" title="In III Methodology ‣ Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Accuracy Differential Saliency (ADS) Technique</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#S4" title="In Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">Experiments and Results</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#S5" title="In Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">Conclusion</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
Novel Saliency Analysis for the Forward-Forward Algorithm 
<br class="ltx_break"/>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">1<sup class="ltx_sup" id="id1.1.id1">st</sup> Mitra Bakhshi
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id2.2.id1">Department of Civil Engineering</span>
<br class="ltx_break"/><span class="ltx_text ltx_font_italic" id="id3.3.id2">Sapienza University of Rome
<br class="ltx_break"/></span>Rome, Italy 
<br class="ltx_break"/>bakhshi.2058909@studenti.uniroma1.it
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id4.id1">Incorporating the Forward-Forward algorithm into neural network training represents a transformative shift from traditional methods, introducing a dual-forward mechanism that streamlines the learning process by bypassing the complexities of derivative propagation. This method is noted for its simplicity and efficiency and involves executing two forward passes—the first with actual data to promote positive reinforcement, and the second with synthetically generated negative data to enable discriminative learning. Our experiments confirm that the Forward-Forward algorithm is not merely an experimental novelty but a viable training strategy that competes robustly with conventional multi-layer perceptron (MLP) architectures. To overcome the limitations inherent in traditional saliency techniques, which predominantly rely on gradient-based methods, we developed a bespoke saliency algorithm specifically tailored for the Forward-Forward framework. This innovative algorithm enhances the intuitive understanding of feature importance and network decision-making, providing clear visualizations of the data features most influential in model predictions. By leveraging this specialized saliency method, we gain deeper insights into the internal workings of the model, significantly enhancing our interpretative capabilities beyond those offered by standard approaches. Our evaluations, utilizing the MNIST and Fashion MNIST datasets, demonstrate that our method performs comparably to traditional MLP-based models.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>Forward-Forward Algorithm, Saliency, MLP

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Artificial Intelligence (AI) and Machine Learning (ML) have revolutionized various sectors, including industry, public services, and society at large. The advent of deep learning (DL) has been particularly transformative, enabling AI systems to perform tasks such as image and speech recognition at a level that often matches or surpasses human capabilities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib2" title="">2</a>]</cite>. Central to the success of DL is the backpropagation (BP) algorithm, which drives learning by iteratively adjusting the weights of neural networks to minimize prediction errors. Despite its effectiveness, BP’s computational intensity and its lack of alignment with biological learning mechanisms have spurred the search for alternative methods that can function in resource-constrained environments while more closely mirroring natural learning processes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib4" title="">4</a>]</cite>. In response to these challenges, research has increasingly focused on developing approaches that approximate the efficiency of BP while mitigating its limitations. Self-supervised learning, which enables models to learn from data without explicit labels, represents one such advancement. Additionally, algorithms like Feedback Alignment and Direct Feedback Alignment address BP’s spatial non-locality and weight transport issues, offering promising alternatives <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib10" title="">10</a>]</cite>. Furthermore, techniques such as predictive coding and equilibrium propagation propose more biologically plausible models of learning by reducing the reliance on non-local computations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib12" title="">12</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, these alternative approaches often entail a trade-off between accuracy and biological plausibility, particularly when applied to complex datasets like ImageNet. The quest for algorithms that can achieve high performance without the limitations of end-to-end BP has led to the development of sophisticated models that incorporate local plasticity rules and auxiliary networks, albeit with increased complexity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib8" title="">8</a>]</cite>. The ongoing debate over the viability of BP as a model for brain learning has highlighted significant practical and biophysical challenges, further questioning the extent to which BP aligns with the brain’s learning mechanisms. This skepticism has catalyzed interest in brain-inspired computing, which seeks to develop computational models that more accurately reflect the brain’s learning processes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib5" title="">5</a>]</cite>. Among the promising avenues in this field are predictive coding and the forward-forward algorithm, which offer potential pathways to bridging the gap between artificial learning systems and the intricacies of biological neural networks. These approaches not only challenge our understanding of artificial systems but also deepen our insights into the cognitive processes that govern learning and intelligence in the natural world <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib12" title="">12</a>]</cite>. As AI and ML continue to evolve, spearheaded by advancements in deep learning and convolutional neural networks, we find ourselves on the cusp of a new era of technological innovation. Yet, the pursuit of algorithms that harmonize efficiency, accuracy, and biological fidelity remains ongoing, driving the exploration of alternatives to traditional models like backpropagation. In this context, saliency maps have emerged as a crucial tool for enhancing the interpretability of deep neural networks (DNNs). These maps provide a visual representation of the elements that significantly influence a model’s decisions, thereby offering insights into the internal workings of DNNs. By assigning scores to different input features based on their impact on the model’s output, gradient-based saliency techniques help to clarify the decision-making processes within the network <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib15" title="">15</a>]</cite>. This enhanced transparency is critical in applications where interpretability is essential, such as healthcare, neuroscience, financial services, and autonomous vehicle technology <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib7" title="">7</a>]</cite>. Beyond improving trust in model predictions, saliency maps play a vital role in model refinement and troubleshooting, driving both the theoretical and practical advancements in deep learning.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">In our investigation, we adopt the forward-forward (FF) algorithm, specifically tailored for multilayer perceptrons (MLP). We introduce a novel saliency mapping technique adapted for the FF algorithm, marking a departure from traditional methods that rely on backpropagation. By eliminating the use of backpropagation, our algorithm offers a fresh perspective on generating saliency maps within the FF framework, thereby enhancing the interpretability of neural networks without the computational complexities and limitations associated with backpropagation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib5" title="">5</a>]</cite>. This development represents a significant advance toward more efficient and transparent deep learning methodologies.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Related Work</span>
</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Recent advances in deep learning underscore the efficacy of stochastic gradient descent applied to models with expansive parameter spaces and significant data volumes. Central to this process is backpropagation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib30" title="">30</a>]</cite>, which computes gradients essential for training. Despite its widespread adoption, the biological plausibility of backpropagation remains a topic of debate. Scholars question whether similar mechanisms exist in the human brain for synaptic weight adjustment <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib28" title="">28</a>]</cite>. Yet, there is no conclusive evidence that the cortex employs mechanisms akin to error derivative propagation or reverses computation phases. Further complicating this hypothesis, the brain’s cortical connections form complex loops rather than the hierarchical structures typical of backpropagation, posing challenges for its biological feasibility, especially in processing sequential data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib27" title="">27</a>]</cite>. Additionally, the brain’s ongoing processing of sensory information without pausing for error correction suggests an alternative, dynamic learning strategy that adjusts synapses in real-time, contrasting sharply with the sequential nature of backpropagation. The opacity introduced in the forward pass of deep neural networks (DNNs) also complicates gradient derivation, necessitating alternative models that can manage non-differentiable elements <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib28" title="">28</a>]</cite>. Deep learning has profoundly impacted various sectors by enabling the extraction of complex patterns from extensive datasets, leading to precise predictions and informed decision-making <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib3" title="">3</a>]</cite>. This issue is critical in high-stakes domains such as healthcare, finance, and autonomous driving, where decisions must be both accurate and interpretable <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib21" title="">21</a>]</cite>. Addressing these challenges, significant research efforts have focused on developing methods to enhance DNN interpretability. These include using saliency maps to identify influential input features, although their effectiveness can be diminished by noise and other artifacts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib15" title="">15</a>]</cite>. Techniques such as SmoothGrad and Integrated Gradients have been introduced to refine these visualizations by averaging the effects of noise or modifying gradient functions to offer deeper insights into decision processes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib22" title="">22</a>]</cite>. SMOOT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib25" title="">25</a>]</cite> builds upon these saliency-based methods by introducing a novel approach that optimizes the number of masked images during training, significantly improving both model accuracy and the prominence of salient features. This work demonstrates how careful adjustment of the masking strategy can prevent information loss and enhance interpretability without sacrificing predictive performance. Research has shown that there is often a trade-off between noise and power consumption in various systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib17" title="">17</a>]</cite>, highlighting the importance of optimizing both to improve system performance. Similarly, in the context of the Internet of Things (IoT), especially in underwater environments, efficient data routing is vital for minimizing resource consumption while ensuring reliable communication. Recent work <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib19" title="">19</a>]</cite> has introduced a method that optimizes network performance by integrating multi-criteria decision-making with uncertainty weights, thereby enhancing underwater IoT communications. The pursuit of robust interpretability not only aims to clarify model decisions but also seeks to understand the representations learned by DNNs. Exploring methods like network distillation into interpretable models, such as soft decision trees, presents promising directions for enhancing transparency in machine learning applications <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib18" title="">18</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.2">The Forward-Forward Algorithm represents a novel approach in the domain of neural network learning, particularly when dealing with unidentified nonlinearities. It eliminates the need for traditional reinforcement learning by allowing networks to learn directly from sequential data without storing neural activities or interrupting error propagation. This algorithm operates comparably to backpropagation but does not require an in-depth understanding of the forward computational steps. However, it marginally lags behind backpropagation in terms of speed when tested across various toy problems, suggesting that its utility may be limited in scenarios where computational resources are ample <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib20" title="">20</a>]</cite>. Despite these limitations, the Forward-Forward Algorithm holds potential advantages for modeling cortical learning processes and could be better suited for use in low-power analog hardware, avoiding the complexities of reinforcement learning. Its foundational concept is influenced by mechanisms from Boltzmann machines <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib23" title="">23</a>]</cite> and Noise Contrastive Estimation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib24" title="">24</a>]</cite>, employing two forward passes instead of the traditional forward and backward passes. Each pass targets distinct datasets with diametrically opposed objectives: the first, or ’positive’ pass, processes real data to increase a ’goodness’ measure across each layer, while the second, or ’negative’ pass, uses synthetic or ’negative’ data to decrease this measure. The algorithm’s efficacy is gauged through two specific measures of ’goodness’—the sum of squared neural activities and its inverse. This dual-process aims to refine the model’s ability to classify input vectors as positive or negative data based on a logistic function, <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">italic_σ</annotation></semantics></math>, applied to the difference between the goodness measure and a predefined threshold, <math alttext="\theta" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_θ</annotation></semantics></math>:</p>
</div>
<div class="ltx_para" id="S2.p3">
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(\text{positive})=\sigma\left(\sum_{j}(y_{j}^{2})-\theta\right)" class="ltx_Math" display="block" id="S2.E1.m1.2"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mrow id="S2.E1.m1.2.2.3" xref="S2.E1.m1.2.2.3.cmml"><mi id="S2.E1.m1.2.2.3.2" xref="S2.E1.m1.2.2.3.2.cmml">p</mi><mo id="S2.E1.m1.2.2.3.1" xref="S2.E1.m1.2.2.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.3.3.2" xref="S2.E1.m1.1.1a.cmml"><mo id="S2.E1.m1.2.2.3.3.2.1" stretchy="false" xref="S2.E1.m1.1.1a.cmml">(</mo><mtext id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">positive</mtext><mo id="S2.E1.m1.2.2.3.3.2.2" stretchy="false" xref="S2.E1.m1.1.1a.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml">=</mo><mrow id="S2.E1.m1.2.2.1" xref="S2.E1.m1.2.2.1.cmml"><mi id="S2.E1.m1.2.2.1.3" xref="S2.E1.m1.2.2.1.3.cmml">σ</mi><mo id="S2.E1.m1.2.2.1.2" xref="S2.E1.m1.2.2.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.cmml"><mo id="S2.E1.m1.2.2.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.2.2.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.cmml"><mrow id="S2.E1.m1.2.2.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.cmml"><munder id="S2.E1.m1.2.2.1.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.2.2.1.1.1.1.1.2.2" lspace="0em" movablelimits="false" rspace="0em" xref="S2.E1.m1.2.2.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S2.E1.m1.2.2.1.1.1.1.1.2.3" xref="S2.E1.m1.2.2.1.1.1.1.1.2.3.cmml">j</mi></munder><mrow id="S2.E1.m1.2.2.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.2.2.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mn id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S2.E1.m1.2.2.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.1.1.1.1.2" xref="S2.E1.m1.2.2.1.1.1.1.2.cmml">−</mo><mi id="S2.E1.m1.2.2.1.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.3.cmml">θ</mi></mrow><mo id="S2.E1.m1.2.2.1.1.1.3" xref="S2.E1.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><eq id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"></eq><apply id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2.3"><times id="S2.E1.m1.2.2.3.1.cmml" xref="S2.E1.m1.2.2.3.1"></times><ci id="S2.E1.m1.2.2.3.2.cmml" xref="S2.E1.m1.2.2.3.2">𝑝</ci><ci id="S2.E1.m1.1.1a.cmml" xref="S2.E1.m1.2.2.3.3.2"><mtext id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">positive</mtext></ci></apply><apply id="S2.E1.m1.2.2.1.cmml" xref="S2.E1.m1.2.2.1"><times id="S2.E1.m1.2.2.1.2.cmml" xref="S2.E1.m1.2.2.1.2"></times><ci id="S2.E1.m1.2.2.1.3.cmml" xref="S2.E1.m1.2.2.1.3">𝜎</ci><apply id="S2.E1.m1.2.2.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1"><minus id="S2.E1.m1.2.2.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.2"></minus><apply id="S2.E1.m1.2.2.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1"><apply id="S2.E1.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.2.2"></sum><ci id="S2.E1.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><cn id="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S2.E1.m1.2.2.1.1.1.1.1.1.1.1.3">2</cn></apply></apply><ci id="S2.E1.m1.2.2.1.1.1.1.3.cmml" xref="S2.E1.m1.2.2.1.1.1.1.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">p(\text{positive})=\sigma\left(\sum_{j}(y_{j}^{2})-\theta\right)</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.2d">italic_p ( positive ) = italic_σ ( ∑ start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) - italic_θ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">This strategic innovation highlights a shift toward more efficient and applicable neural property training methodologies, moving away from conventional learning paradigms and potentially offering a method better aligned with biological learning processes. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#S2.F1" title="Figure 1 ‣ II Related Work ‣ Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the technique for generating negative and positive data in the forward-forward algorithm.</p>
</div>
<figure class="ltx_figure" id="S2.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="364" id="S2.F1.g1" src="extracted/5861477/Fig1.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>MNIST images contain a black border. If we replace
the first 10 pixels by one of N representations of the label. To develop positive and negative samples for the forward-forward algorithm, we change these N pixels. For a positive sample, set the tensor index corresponding to the class to 1 and all other indices to 0. This denotes the class’s presence. Conversely, for a negative sample, choose a random index not matching the actual class, set this to 1, and all other indices to 0, indicating the absence of the class. This method allows the algorithm to distinguish between classes by clearly identifying which class is present (positive sample) and which is not (negative sample).</figcaption>
</figure>
<figure class="ltx_float ltx_algorithm" id="algorithm1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm1.14">
<div class="ltx_listingline" id="algorithm1.1.1">
<span class="ltx_text ltx_font_bold" id="algorithm1.1.1.2">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.1.1.1"><math alttext="\text{l}\in\text{model.layers}" class="ltx_Math" display="inline" id="algorithm1.1.1.1.m1.1"><semantics id="algorithm1.1.1.1.m1.1a"><mrow id="algorithm1.1.1.1.m1.1.1" xref="algorithm1.1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="algorithm1.1.1.1.m1.1.1.2" xref="algorithm1.1.1.1.m1.1.1.2a.cmml">l</mtext><mo id="algorithm1.1.1.1.m1.1.1.1" xref="algorithm1.1.1.1.m1.1.1.1.cmml">∈</mo><mtext class="ltx_mathvariant_italic" id="algorithm1.1.1.1.m1.1.1.3" xref="algorithm1.1.1.1.m1.1.1.3a.cmml">model.layers</mtext></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.1.m1.1b"><apply id="algorithm1.1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.1.m1.1.1"><in id="algorithm1.1.1.1.m1.1.1.1.cmml" xref="algorithm1.1.1.1.m1.1.1.1"></in><ci id="algorithm1.1.1.1.m1.1.1.2a.cmml" xref="algorithm1.1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_italic" id="algorithm1.1.1.1.m1.1.1.2.cmml" xref="algorithm1.1.1.1.m1.1.1.2">l</mtext></ci><ci id="algorithm1.1.1.1.m1.1.1.3a.cmml" xref="algorithm1.1.1.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" id="algorithm1.1.1.1.m1.1.1.3.cmml" xref="algorithm1.1.1.1.m1.1.1.3">model.layers</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.1.m1.1c">\text{l}\in\text{model.layers}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.1.1.1.m1.1d">l ∈ model.layers</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.1.1.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.2.2">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="algorithm1.2.2.2">for</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.2.2.1"><math alttext="\text{e}\in\text{MaxEpock}" class="ltx_Math" display="inline" id="algorithm1.2.2.1.m1.1"><semantics id="algorithm1.2.2.1.m1.1a"><mrow id="algorithm1.2.2.1.m1.1.1" xref="algorithm1.2.2.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="algorithm1.2.2.1.m1.1.1.2" xref="algorithm1.2.2.1.m1.1.1.2a.cmml">e</mtext><mo id="algorithm1.2.2.1.m1.1.1.1" xref="algorithm1.2.2.1.m1.1.1.1.cmml">∈</mo><mtext class="ltx_mathvariant_italic" id="algorithm1.2.2.1.m1.1.1.3" xref="algorithm1.2.2.1.m1.1.1.3a.cmml">MaxEpock</mtext></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.1.m1.1b"><apply id="algorithm1.2.2.1.m1.1.1.cmml" xref="algorithm1.2.2.1.m1.1.1"><in id="algorithm1.2.2.1.m1.1.1.1.cmml" xref="algorithm1.2.2.1.m1.1.1.1"></in><ci id="algorithm1.2.2.1.m1.1.1.2a.cmml" xref="algorithm1.2.2.1.m1.1.1.2"><mtext class="ltx_mathvariant_italic" id="algorithm1.2.2.1.m1.1.1.2.cmml" xref="algorithm1.2.2.1.m1.1.1.2">e</mtext></ci><ci id="algorithm1.2.2.1.m1.1.1.3a.cmml" xref="algorithm1.2.2.1.m1.1.1.3"><mtext class="ltx_mathvariant_italic" id="algorithm1.2.2.1.m1.1.1.3.cmml" xref="algorithm1.2.2.1.m1.1.1.3">MaxEpock</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.1.m1.1c">\text{e}\in\text{MaxEpock}</annotation><annotation encoding="application/x-llamapun" id="algorithm1.2.2.1.m1.1d">e ∈ MaxEpock</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.2.2.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.14.15">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
# <span class="ltx_text" id="algorithm1.14.15.1" style="color:#0000FF;">Prepare pos and neg samples</span>
</div>
<div class="ltx_listingline" id="algorithm1.3.3">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="x_{e},L_{e+}=get\_training\_sample(e)" class="ltx_Math" display="inline" id="algorithm1.3.3.m1.3"><semantics id="algorithm1.3.3.m1.3a"><mrow id="algorithm1.3.3.m1.3.3" xref="algorithm1.3.3.m1.3.3.cmml"><mrow id="algorithm1.3.3.m1.3.3.2.2" xref="algorithm1.3.3.m1.3.3.2.3.cmml"><msub id="algorithm1.3.3.m1.2.2.1.1.1" xref="algorithm1.3.3.m1.2.2.1.1.1.cmml"><mi id="algorithm1.3.3.m1.2.2.1.1.1.2" xref="algorithm1.3.3.m1.2.2.1.1.1.2.cmml">x</mi><mi id="algorithm1.3.3.m1.2.2.1.1.1.3" xref="algorithm1.3.3.m1.2.2.1.1.1.3.cmml">e</mi></msub><mo id="algorithm1.3.3.m1.3.3.2.2.3" xref="algorithm1.3.3.m1.3.3.2.3.cmml">,</mo><msub id="algorithm1.3.3.m1.3.3.2.2.2" xref="algorithm1.3.3.m1.3.3.2.2.2.cmml"><mi id="algorithm1.3.3.m1.3.3.2.2.2.2" xref="algorithm1.3.3.m1.3.3.2.2.2.2.cmml">L</mi><mrow id="algorithm1.3.3.m1.3.3.2.2.2.3" xref="algorithm1.3.3.m1.3.3.2.2.2.3.cmml"><mi id="algorithm1.3.3.m1.3.3.2.2.2.3.2" xref="algorithm1.3.3.m1.3.3.2.2.2.3.2.cmml">e</mi><mo id="algorithm1.3.3.m1.3.3.2.2.2.3.3" xref="algorithm1.3.3.m1.3.3.2.2.2.3.3.cmml">+</mo></mrow></msub></mrow><mo id="algorithm1.3.3.m1.3.3.3" xref="algorithm1.3.3.m1.3.3.3.cmml">=</mo><mrow id="algorithm1.3.3.m1.3.3.4" xref="algorithm1.3.3.m1.3.3.4.cmml"><mi id="algorithm1.3.3.m1.3.3.4.2" xref="algorithm1.3.3.m1.3.3.4.2.cmml">g</mi><mo id="algorithm1.3.3.m1.3.3.4.1" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.3" xref="algorithm1.3.3.m1.3.3.4.3.cmml">e</mi><mo id="algorithm1.3.3.m1.3.3.4.1a" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.4" xref="algorithm1.3.3.m1.3.3.4.4.cmml">t</mi><mo id="algorithm1.3.3.m1.3.3.4.1b" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.5" mathvariant="normal" xref="algorithm1.3.3.m1.3.3.4.5.cmml">_</mi><mo id="algorithm1.3.3.m1.3.3.4.1c" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.6" xref="algorithm1.3.3.m1.3.3.4.6.cmml">t</mi><mo id="algorithm1.3.3.m1.3.3.4.1d" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.7" xref="algorithm1.3.3.m1.3.3.4.7.cmml">r</mi><mo id="algorithm1.3.3.m1.3.3.4.1e" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.8" xref="algorithm1.3.3.m1.3.3.4.8.cmml">a</mi><mo id="algorithm1.3.3.m1.3.3.4.1f" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.9" xref="algorithm1.3.3.m1.3.3.4.9.cmml">i</mi><mo id="algorithm1.3.3.m1.3.3.4.1g" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.10" xref="algorithm1.3.3.m1.3.3.4.10.cmml">n</mi><mo id="algorithm1.3.3.m1.3.3.4.1h" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.11" xref="algorithm1.3.3.m1.3.3.4.11.cmml">i</mi><mo id="algorithm1.3.3.m1.3.3.4.1i" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.12" xref="algorithm1.3.3.m1.3.3.4.12.cmml">n</mi><mo id="algorithm1.3.3.m1.3.3.4.1j" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.13" xref="algorithm1.3.3.m1.3.3.4.13.cmml">g</mi><mo id="algorithm1.3.3.m1.3.3.4.1k" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.14" mathvariant="normal" xref="algorithm1.3.3.m1.3.3.4.14.cmml">_</mi><mo id="algorithm1.3.3.m1.3.3.4.1l" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.15" xref="algorithm1.3.3.m1.3.3.4.15.cmml">s</mi><mo id="algorithm1.3.3.m1.3.3.4.1m" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.16" xref="algorithm1.3.3.m1.3.3.4.16.cmml">a</mi><mo id="algorithm1.3.3.m1.3.3.4.1n" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.17" xref="algorithm1.3.3.m1.3.3.4.17.cmml">m</mi><mo id="algorithm1.3.3.m1.3.3.4.1o" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.18" xref="algorithm1.3.3.m1.3.3.4.18.cmml">p</mi><mo id="algorithm1.3.3.m1.3.3.4.1p" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.19" xref="algorithm1.3.3.m1.3.3.4.19.cmml">l</mi><mo id="algorithm1.3.3.m1.3.3.4.1q" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mi id="algorithm1.3.3.m1.3.3.4.20" xref="algorithm1.3.3.m1.3.3.4.20.cmml">e</mi><mo id="algorithm1.3.3.m1.3.3.4.1r" xref="algorithm1.3.3.m1.3.3.4.1.cmml">⁢</mo><mrow id="algorithm1.3.3.m1.3.3.4.21.2" xref="algorithm1.3.3.m1.3.3.4.cmml"><mo id="algorithm1.3.3.m1.3.3.4.21.2.1" stretchy="false" xref="algorithm1.3.3.m1.3.3.4.cmml">(</mo><mi id="algorithm1.3.3.m1.1.1" xref="algorithm1.3.3.m1.1.1.cmml">e</mi><mo id="algorithm1.3.3.m1.3.3.4.21.2.2" stretchy="false" xref="algorithm1.3.3.m1.3.3.4.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.m1.3b"><apply id="algorithm1.3.3.m1.3.3.cmml" xref="algorithm1.3.3.m1.3.3"><eq id="algorithm1.3.3.m1.3.3.3.cmml" xref="algorithm1.3.3.m1.3.3.3"></eq><list id="algorithm1.3.3.m1.3.3.2.3.cmml" xref="algorithm1.3.3.m1.3.3.2.2"><apply id="algorithm1.3.3.m1.2.2.1.1.1.cmml" xref="algorithm1.3.3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.3.3.m1.2.2.1.1.1.1.cmml" xref="algorithm1.3.3.m1.2.2.1.1.1">subscript</csymbol><ci id="algorithm1.3.3.m1.2.2.1.1.1.2.cmml" xref="algorithm1.3.3.m1.2.2.1.1.1.2">𝑥</ci><ci id="algorithm1.3.3.m1.2.2.1.1.1.3.cmml" xref="algorithm1.3.3.m1.2.2.1.1.1.3">𝑒</ci></apply><apply id="algorithm1.3.3.m1.3.3.2.2.2.cmml" xref="algorithm1.3.3.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="algorithm1.3.3.m1.3.3.2.2.2.1.cmml" xref="algorithm1.3.3.m1.3.3.2.2.2">subscript</csymbol><ci id="algorithm1.3.3.m1.3.3.2.2.2.2.cmml" xref="algorithm1.3.3.m1.3.3.2.2.2.2">𝐿</ci><apply id="algorithm1.3.3.m1.3.3.2.2.2.3.cmml" xref="algorithm1.3.3.m1.3.3.2.2.2.3"><csymbol cd="latexml" id="algorithm1.3.3.m1.3.3.2.2.2.3.1.cmml" xref="algorithm1.3.3.m1.3.3.2.2.2.3">limit-from</csymbol><ci id="algorithm1.3.3.m1.3.3.2.2.2.3.2.cmml" xref="algorithm1.3.3.m1.3.3.2.2.2.3.2">𝑒</ci><plus id="algorithm1.3.3.m1.3.3.2.2.2.3.3.cmml" xref="algorithm1.3.3.m1.3.3.2.2.2.3.3"></plus></apply></apply></list><apply id="algorithm1.3.3.m1.3.3.4.cmml" xref="algorithm1.3.3.m1.3.3.4"><times id="algorithm1.3.3.m1.3.3.4.1.cmml" xref="algorithm1.3.3.m1.3.3.4.1"></times><ci id="algorithm1.3.3.m1.3.3.4.2.cmml" xref="algorithm1.3.3.m1.3.3.4.2">𝑔</ci><ci id="algorithm1.3.3.m1.3.3.4.3.cmml" xref="algorithm1.3.3.m1.3.3.4.3">𝑒</ci><ci id="algorithm1.3.3.m1.3.3.4.4.cmml" xref="algorithm1.3.3.m1.3.3.4.4">𝑡</ci><ci id="algorithm1.3.3.m1.3.3.4.5.cmml" xref="algorithm1.3.3.m1.3.3.4.5">_</ci><ci id="algorithm1.3.3.m1.3.3.4.6.cmml" xref="algorithm1.3.3.m1.3.3.4.6">𝑡</ci><ci id="algorithm1.3.3.m1.3.3.4.7.cmml" xref="algorithm1.3.3.m1.3.3.4.7">𝑟</ci><ci id="algorithm1.3.3.m1.3.3.4.8.cmml" xref="algorithm1.3.3.m1.3.3.4.8">𝑎</ci><ci id="algorithm1.3.3.m1.3.3.4.9.cmml" xref="algorithm1.3.3.m1.3.3.4.9">𝑖</ci><ci id="algorithm1.3.3.m1.3.3.4.10.cmml" xref="algorithm1.3.3.m1.3.3.4.10">𝑛</ci><ci id="algorithm1.3.3.m1.3.3.4.11.cmml" xref="algorithm1.3.3.m1.3.3.4.11">𝑖</ci><ci id="algorithm1.3.3.m1.3.3.4.12.cmml" xref="algorithm1.3.3.m1.3.3.4.12">𝑛</ci><ci id="algorithm1.3.3.m1.3.3.4.13.cmml" xref="algorithm1.3.3.m1.3.3.4.13">𝑔</ci><ci id="algorithm1.3.3.m1.3.3.4.14.cmml" xref="algorithm1.3.3.m1.3.3.4.14">_</ci><ci id="algorithm1.3.3.m1.3.3.4.15.cmml" xref="algorithm1.3.3.m1.3.3.4.15">𝑠</ci><ci id="algorithm1.3.3.m1.3.3.4.16.cmml" xref="algorithm1.3.3.m1.3.3.4.16">𝑎</ci><ci id="algorithm1.3.3.m1.3.3.4.17.cmml" xref="algorithm1.3.3.m1.3.3.4.17">𝑚</ci><ci id="algorithm1.3.3.m1.3.3.4.18.cmml" xref="algorithm1.3.3.m1.3.3.4.18">𝑝</ci><ci id="algorithm1.3.3.m1.3.3.4.19.cmml" xref="algorithm1.3.3.m1.3.3.4.19">𝑙</ci><ci id="algorithm1.3.3.m1.3.3.4.20.cmml" xref="algorithm1.3.3.m1.3.3.4.20">𝑒</ci><ci id="algorithm1.3.3.m1.1.1.cmml" xref="algorithm1.3.3.m1.1.1">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.m1.3c">x_{e},L_{e+}=get\_training\_sample(e)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.3.3.m1.3d">italic_x start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_L start_POSTSUBSCRIPT italic_e + end_POSTSUBSCRIPT = italic_g italic_e italic_t _ italic_t italic_r italic_a italic_i italic_n italic_i italic_n italic_g _ italic_s italic_a italic_m italic_p italic_l italic_e ( italic_e )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.4.4">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="L_{pos},L_{neg}=\{C\{0\}\};" class="ltx_Math" display="inline" id="algorithm1.4.4.m1.2"><semantics id="algorithm1.4.4.m1.2a"><mrow id="algorithm1.4.4.m1.2.2.1" xref="algorithm1.4.4.m1.2.2.1.1.cmml"><mrow id="algorithm1.4.4.m1.2.2.1.1" xref="algorithm1.4.4.m1.2.2.1.1.cmml"><mrow id="algorithm1.4.4.m1.2.2.1.1.2.2" xref="algorithm1.4.4.m1.2.2.1.1.2.3.cmml"><msub id="algorithm1.4.4.m1.2.2.1.1.1.1.1" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.cmml"><mi id="algorithm1.4.4.m1.2.2.1.1.1.1.1.2" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.2.cmml">L</mi><mrow id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.cmml"><mi id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.2" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.2.cmml">p</mi><mo id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.1" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.3" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.3.cmml">o</mi><mo id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.1a" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.4" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo id="algorithm1.4.4.m1.2.2.1.1.2.2.3" xref="algorithm1.4.4.m1.2.2.1.1.2.3.cmml">,</mo><msub id="algorithm1.4.4.m1.2.2.1.1.2.2.2" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.cmml"><mi id="algorithm1.4.4.m1.2.2.1.1.2.2.2.2" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.2.cmml">L</mi><mrow id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.cmml"><mi id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.2" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.2.cmml">n</mi><mo id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.1" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.3" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.3.cmml">e</mi><mo id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.1a" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.1.cmml">⁢</mo><mi id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.4" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.4.cmml">g</mi></mrow></msub></mrow><mo id="algorithm1.4.4.m1.2.2.1.1.4" xref="algorithm1.4.4.m1.2.2.1.1.4.cmml">=</mo><mrow id="algorithm1.4.4.m1.2.2.1.1.3.1" xref="algorithm1.4.4.m1.2.2.1.1.3.2.cmml"><mo id="algorithm1.4.4.m1.2.2.1.1.3.1.2" stretchy="false" xref="algorithm1.4.4.m1.2.2.1.1.3.2.cmml">{</mo><mrow id="algorithm1.4.4.m1.2.2.1.1.3.1.1" xref="algorithm1.4.4.m1.2.2.1.1.3.1.1.cmml"><mi id="algorithm1.4.4.m1.2.2.1.1.3.1.1.2" xref="algorithm1.4.4.m1.2.2.1.1.3.1.1.2.cmml">C</mi><mo id="algorithm1.4.4.m1.2.2.1.1.3.1.1.1" xref="algorithm1.4.4.m1.2.2.1.1.3.1.1.1.cmml">⁢</mo><mrow id="algorithm1.4.4.m1.2.2.1.1.3.1.1.3.2" xref="algorithm1.4.4.m1.2.2.1.1.3.1.1.3.1.cmml"><mo id="algorithm1.4.4.m1.2.2.1.1.3.1.1.3.2.1" stretchy="false" xref="algorithm1.4.4.m1.2.2.1.1.3.1.1.3.1.cmml">{</mo><mn id="algorithm1.4.4.m1.1.1" xref="algorithm1.4.4.m1.1.1.cmml">0</mn><mo id="algorithm1.4.4.m1.2.2.1.1.3.1.1.3.2.2" stretchy="false" xref="algorithm1.4.4.m1.2.2.1.1.3.1.1.3.1.cmml">}</mo></mrow></mrow><mo id="algorithm1.4.4.m1.2.2.1.1.3.1.3" stretchy="false" xref="algorithm1.4.4.m1.2.2.1.1.3.2.cmml">}</mo></mrow></mrow><mo id="algorithm1.4.4.m1.2.2.1.2" xref="algorithm1.4.4.m1.2.2.1.1.cmml">;</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m1.2b"><apply id="algorithm1.4.4.m1.2.2.1.1.cmml" xref="algorithm1.4.4.m1.2.2.1"><eq id="algorithm1.4.4.m1.2.2.1.1.4.cmml" xref="algorithm1.4.4.m1.2.2.1.1.4"></eq><list id="algorithm1.4.4.m1.2.2.1.1.2.3.cmml" xref="algorithm1.4.4.m1.2.2.1.1.2.2"><apply id="algorithm1.4.4.m1.2.2.1.1.1.1.1.cmml" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.4.4.m1.2.2.1.1.1.1.1.1.cmml" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.4.4.m1.2.2.1.1.1.1.1.2.cmml" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.2">𝐿</ci><apply id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.cmml" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3"><times id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.1.cmml" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.1"></times><ci id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.2.cmml" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.2">𝑝</ci><ci id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.3.cmml" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.3">𝑜</ci><ci id="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.4.cmml" xref="algorithm1.4.4.m1.2.2.1.1.1.1.1.3.4">𝑠</ci></apply></apply><apply id="algorithm1.4.4.m1.2.2.1.1.2.2.2.cmml" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="algorithm1.4.4.m1.2.2.1.1.2.2.2.1.cmml" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="algorithm1.4.4.m1.2.2.1.1.2.2.2.2.cmml" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.2">𝐿</ci><apply id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.cmml" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3"><times id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.1.cmml" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.1"></times><ci id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.2.cmml" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.2">𝑛</ci><ci id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.3.cmml" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.3">𝑒</ci><ci id="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.4.cmml" xref="algorithm1.4.4.m1.2.2.1.1.2.2.2.3.4">𝑔</ci></apply></apply></list><set id="algorithm1.4.4.m1.2.2.1.1.3.2.cmml" xref="algorithm1.4.4.m1.2.2.1.1.3.1"><apply id="algorithm1.4.4.m1.2.2.1.1.3.1.1.cmml" xref="algorithm1.4.4.m1.2.2.1.1.3.1.1"><times id="algorithm1.4.4.m1.2.2.1.1.3.1.1.1.cmml" xref="algorithm1.4.4.m1.2.2.1.1.3.1.1.1"></times><ci id="algorithm1.4.4.m1.2.2.1.1.3.1.1.2.cmml" xref="algorithm1.4.4.m1.2.2.1.1.3.1.1.2">𝐶</ci><set id="algorithm1.4.4.m1.2.2.1.1.3.1.1.3.1.cmml" xref="algorithm1.4.4.m1.2.2.1.1.3.1.1.3.2"><cn id="algorithm1.4.4.m1.1.1.cmml" type="integer" xref="algorithm1.4.4.m1.1.1">0</cn></set></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m1.2c">L_{pos},L_{neg}=\{C\{0\}\};</annotation><annotation encoding="application/x-llamapun" id="algorithm1.4.4.m1.2d">italic_L start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT , italic_L start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT = { italic_C { 0 } } ;</annotation></semantics></math> # concat C 0s 
</div>
<div class="ltx_listingline" id="algorithm1.5.5">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="L_{e-}=random(0,C,\!L_{e+})" class="ltx_Math" display="inline" id="algorithm1.5.5.m1.3"><semantics id="algorithm1.5.5.m1.3a"><mrow id="algorithm1.5.5.m1.3.3" xref="algorithm1.5.5.m1.3.3.cmml"><msub id="algorithm1.5.5.m1.3.3.3" xref="algorithm1.5.5.m1.3.3.3.cmml"><mi id="algorithm1.5.5.m1.3.3.3.2" xref="algorithm1.5.5.m1.3.3.3.2.cmml">L</mi><mrow id="algorithm1.5.5.m1.3.3.3.3" xref="algorithm1.5.5.m1.3.3.3.3.cmml"><mi id="algorithm1.5.5.m1.3.3.3.3.2" xref="algorithm1.5.5.m1.3.3.3.3.2.cmml">e</mi><mo id="algorithm1.5.5.m1.3.3.3.3.3" xref="algorithm1.5.5.m1.3.3.3.3.3.cmml">−</mo></mrow></msub><mo id="algorithm1.5.5.m1.3.3.2" xref="algorithm1.5.5.m1.3.3.2.cmml">=</mo><mrow id="algorithm1.5.5.m1.3.3.1" xref="algorithm1.5.5.m1.3.3.1.cmml"><mi id="algorithm1.5.5.m1.3.3.1.3" xref="algorithm1.5.5.m1.3.3.1.3.cmml">r</mi><mo id="algorithm1.5.5.m1.3.3.1.2" xref="algorithm1.5.5.m1.3.3.1.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.3.3.1.4" xref="algorithm1.5.5.m1.3.3.1.4.cmml">a</mi><mo id="algorithm1.5.5.m1.3.3.1.2a" xref="algorithm1.5.5.m1.3.3.1.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.3.3.1.5" xref="algorithm1.5.5.m1.3.3.1.5.cmml">n</mi><mo id="algorithm1.5.5.m1.3.3.1.2b" xref="algorithm1.5.5.m1.3.3.1.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.3.3.1.6" xref="algorithm1.5.5.m1.3.3.1.6.cmml">d</mi><mo id="algorithm1.5.5.m1.3.3.1.2c" xref="algorithm1.5.5.m1.3.3.1.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.3.3.1.7" xref="algorithm1.5.5.m1.3.3.1.7.cmml">o</mi><mo id="algorithm1.5.5.m1.3.3.1.2d" xref="algorithm1.5.5.m1.3.3.1.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.3.3.1.8" xref="algorithm1.5.5.m1.3.3.1.8.cmml">m</mi><mo id="algorithm1.5.5.m1.3.3.1.2e" xref="algorithm1.5.5.m1.3.3.1.2.cmml">⁢</mo><mrow id="algorithm1.5.5.m1.3.3.1.1.1" xref="algorithm1.5.5.m1.3.3.1.1.2.cmml"><mo id="algorithm1.5.5.m1.3.3.1.1.1.2" stretchy="false" xref="algorithm1.5.5.m1.3.3.1.1.2.cmml">(</mo><mn id="algorithm1.5.5.m1.1.1" xref="algorithm1.5.5.m1.1.1.cmml">0</mn><mo id="algorithm1.5.5.m1.3.3.1.1.1.3" xref="algorithm1.5.5.m1.3.3.1.1.2.cmml">,</mo><mi id="algorithm1.5.5.m1.2.2" xref="algorithm1.5.5.m1.2.2.cmml">C</mi><mpadded width="0.275em"><mo id="algorithm1.5.5.m1.3.3.1.1.1.4" xref="algorithm1.5.5.m1.3.3.1.1.2.cmml">,</mo></mpadded><msub id="algorithm1.5.5.m1.3.3.1.1.1.1" xref="algorithm1.5.5.m1.3.3.1.1.1.1.cmml"><mi id="algorithm1.5.5.m1.3.3.1.1.1.1.2" xref="algorithm1.5.5.m1.3.3.1.1.1.1.2.cmml">L</mi><mrow id="algorithm1.5.5.m1.3.3.1.1.1.1.3" xref="algorithm1.5.5.m1.3.3.1.1.1.1.3.cmml"><mi id="algorithm1.5.5.m1.3.3.1.1.1.1.3.2" xref="algorithm1.5.5.m1.3.3.1.1.1.1.3.2.cmml">e</mi><mo id="algorithm1.5.5.m1.3.3.1.1.1.1.3.3" xref="algorithm1.5.5.m1.3.3.1.1.1.1.3.3.cmml">+</mo></mrow></msub><mo id="algorithm1.5.5.m1.3.3.1.1.1.5" stretchy="false" xref="algorithm1.5.5.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m1.3b"><apply id="algorithm1.5.5.m1.3.3.cmml" xref="algorithm1.5.5.m1.3.3"><eq id="algorithm1.5.5.m1.3.3.2.cmml" xref="algorithm1.5.5.m1.3.3.2"></eq><apply id="algorithm1.5.5.m1.3.3.3.cmml" xref="algorithm1.5.5.m1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.5.5.m1.3.3.3.1.cmml" xref="algorithm1.5.5.m1.3.3.3">subscript</csymbol><ci id="algorithm1.5.5.m1.3.3.3.2.cmml" xref="algorithm1.5.5.m1.3.3.3.2">𝐿</ci><apply id="algorithm1.5.5.m1.3.3.3.3.cmml" xref="algorithm1.5.5.m1.3.3.3.3"><csymbol cd="latexml" id="algorithm1.5.5.m1.3.3.3.3.1.cmml" xref="algorithm1.5.5.m1.3.3.3.3">limit-from</csymbol><ci id="algorithm1.5.5.m1.3.3.3.3.2.cmml" xref="algorithm1.5.5.m1.3.3.3.3.2">𝑒</ci><minus id="algorithm1.5.5.m1.3.3.3.3.3.cmml" xref="algorithm1.5.5.m1.3.3.3.3.3"></minus></apply></apply><apply id="algorithm1.5.5.m1.3.3.1.cmml" xref="algorithm1.5.5.m1.3.3.1"><times id="algorithm1.5.5.m1.3.3.1.2.cmml" xref="algorithm1.5.5.m1.3.3.1.2"></times><ci id="algorithm1.5.5.m1.3.3.1.3.cmml" xref="algorithm1.5.5.m1.3.3.1.3">𝑟</ci><ci id="algorithm1.5.5.m1.3.3.1.4.cmml" xref="algorithm1.5.5.m1.3.3.1.4">𝑎</ci><ci id="algorithm1.5.5.m1.3.3.1.5.cmml" xref="algorithm1.5.5.m1.3.3.1.5">𝑛</ci><ci id="algorithm1.5.5.m1.3.3.1.6.cmml" xref="algorithm1.5.5.m1.3.3.1.6">𝑑</ci><ci id="algorithm1.5.5.m1.3.3.1.7.cmml" xref="algorithm1.5.5.m1.3.3.1.7">𝑜</ci><ci id="algorithm1.5.5.m1.3.3.1.8.cmml" xref="algorithm1.5.5.m1.3.3.1.8">𝑚</ci><vector id="algorithm1.5.5.m1.3.3.1.1.2.cmml" xref="algorithm1.5.5.m1.3.3.1.1.1"><cn id="algorithm1.5.5.m1.1.1.cmml" type="integer" xref="algorithm1.5.5.m1.1.1">0</cn><ci id="algorithm1.5.5.m1.2.2.cmml" xref="algorithm1.5.5.m1.2.2">𝐶</ci><apply id="algorithm1.5.5.m1.3.3.1.1.1.1.cmml" xref="algorithm1.5.5.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.5.5.m1.3.3.1.1.1.1.1.cmml" xref="algorithm1.5.5.m1.3.3.1.1.1.1">subscript</csymbol><ci id="algorithm1.5.5.m1.3.3.1.1.1.1.2.cmml" xref="algorithm1.5.5.m1.3.3.1.1.1.1.2">𝐿</ci><apply id="algorithm1.5.5.m1.3.3.1.1.1.1.3.cmml" xref="algorithm1.5.5.m1.3.3.1.1.1.1.3"><csymbol cd="latexml" id="algorithm1.5.5.m1.3.3.1.1.1.1.3.1.cmml" xref="algorithm1.5.5.m1.3.3.1.1.1.1.3">limit-from</csymbol><ci id="algorithm1.5.5.m1.3.3.1.1.1.1.3.2.cmml" xref="algorithm1.5.5.m1.3.3.1.1.1.1.3.2">𝑒</ci><plus id="algorithm1.5.5.m1.3.3.1.1.1.1.3.3.cmml" xref="algorithm1.5.5.m1.3.3.1.1.1.1.3.3"></plus></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m1.3c">L_{e-}=random(0,C,\!L_{e+})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.5.5.m1.3d">italic_L start_POSTSUBSCRIPT italic_e - end_POSTSUBSCRIPT = italic_r italic_a italic_n italic_d italic_o italic_m ( 0 , italic_C , italic_L start_POSTSUBSCRIPT italic_e + end_POSTSUBSCRIPT )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.6.6">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="L_{pos}[L_{e}]=1;" class="ltx_Math" display="inline" id="algorithm1.6.6.m1.1"><semantics id="algorithm1.6.6.m1.1a"><mrow id="algorithm1.6.6.m1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.1.cmml"><mrow id="algorithm1.6.6.m1.1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.1.cmml"><mrow id="algorithm1.6.6.m1.1.1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.1.1.cmml"><msub id="algorithm1.6.6.m1.1.1.1.1.1.3" xref="algorithm1.6.6.m1.1.1.1.1.1.3.cmml"><mi id="algorithm1.6.6.m1.1.1.1.1.1.3.2" xref="algorithm1.6.6.m1.1.1.1.1.1.3.2.cmml">L</mi><mrow id="algorithm1.6.6.m1.1.1.1.1.1.3.3" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3.cmml"><mi id="algorithm1.6.6.m1.1.1.1.1.1.3.3.2" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3.2.cmml">p</mi><mo id="algorithm1.6.6.m1.1.1.1.1.1.3.3.1" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm1.6.6.m1.1.1.1.1.1.3.3.3" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3.3.cmml">o</mi><mo id="algorithm1.6.6.m1.1.1.1.1.1.3.3.1a" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm1.6.6.m1.1.1.1.1.1.3.3.4" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3.4.cmml">s</mi></mrow></msub><mo id="algorithm1.6.6.m1.1.1.1.1.1.2" xref="algorithm1.6.6.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.6.6.m1.1.1.1.1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.1.1.1.2.cmml"><mo id="algorithm1.6.6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.6.6.m1.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="algorithm1.6.6.m1.1.1.1.1.1.1.1.1" xref="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.2" xref="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.2.cmml">L</mi><mi id="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.3" xref="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="algorithm1.6.6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.6.6.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="algorithm1.6.6.m1.1.1.1.1.2" xref="algorithm1.6.6.m1.1.1.1.1.2.cmml">=</mo><mn id="algorithm1.6.6.m1.1.1.1.1.3" xref="algorithm1.6.6.m1.1.1.1.1.3.cmml">1</mn></mrow><mo id="algorithm1.6.6.m1.1.1.1.2" xref="algorithm1.6.6.m1.1.1.1.1.cmml">;</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.1b"><apply id="algorithm1.6.6.m1.1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1"><eq id="algorithm1.6.6.m1.1.1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.1.1.2"></eq><apply id="algorithm1.6.6.m1.1.1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1"><times id="algorithm1.6.6.m1.1.1.1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.2"></times><apply id="algorithm1.6.6.m1.1.1.1.1.1.3.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.1.1.1.3.1.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.3">subscript</csymbol><ci id="algorithm1.6.6.m1.1.1.1.1.1.3.2.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.3.2">𝐿</ci><apply id="algorithm1.6.6.m1.1.1.1.1.1.3.3.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3"><times id="algorithm1.6.6.m1.1.1.1.1.1.3.3.1.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3.1"></times><ci id="algorithm1.6.6.m1.1.1.1.1.1.3.3.2.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3.2">𝑝</ci><ci id="algorithm1.6.6.m1.1.1.1.1.1.3.3.3.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3.3">𝑜</ci><ci id="algorithm1.6.6.m1.1.1.1.1.1.3.3.4.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.3.3.4">𝑠</ci></apply></apply><apply id="algorithm1.6.6.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="algorithm1.6.6.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.2">𝐿</ci><ci id="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.6.6.m1.1.1.1.1.1.1.1.1.3">𝑒</ci></apply></apply></apply><cn id="algorithm1.6.6.m1.1.1.1.1.3.cmml" type="integer" xref="algorithm1.6.6.m1.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.1c">L_{pos}[L_{e}]=1;</annotation><annotation encoding="application/x-llamapun" id="algorithm1.6.6.m1.1d">italic_L start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT [ italic_L start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT ] = 1 ;</annotation></semantics></math> <span class="ltx_text" id="algorithm1.6.6.1" style="color:#0000FF;">change 0 in label position to 1</span>
</div>
<div class="ltx_listingline" id="algorithm1.7.7">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="L_{neg}[L_{ne}]=1;" class="ltx_Math" display="inline" id="algorithm1.7.7.m1.1"><semantics id="algorithm1.7.7.m1.1a"><mrow id="algorithm1.7.7.m1.1.1.1" xref="algorithm1.7.7.m1.1.1.1.1.cmml"><mrow id="algorithm1.7.7.m1.1.1.1.1" xref="algorithm1.7.7.m1.1.1.1.1.cmml"><mrow id="algorithm1.7.7.m1.1.1.1.1.1" xref="algorithm1.7.7.m1.1.1.1.1.1.cmml"><msub id="algorithm1.7.7.m1.1.1.1.1.1.3" xref="algorithm1.7.7.m1.1.1.1.1.1.3.cmml"><mi id="algorithm1.7.7.m1.1.1.1.1.1.3.2" xref="algorithm1.7.7.m1.1.1.1.1.1.3.2.cmml">L</mi><mrow id="algorithm1.7.7.m1.1.1.1.1.1.3.3" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3.cmml"><mi id="algorithm1.7.7.m1.1.1.1.1.1.3.3.2" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3.2.cmml">n</mi><mo id="algorithm1.7.7.m1.1.1.1.1.1.3.3.1" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm1.7.7.m1.1.1.1.1.1.3.3.3" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3.3.cmml">e</mi><mo id="algorithm1.7.7.m1.1.1.1.1.1.3.3.1a" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm1.7.7.m1.1.1.1.1.1.3.3.4" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3.4.cmml">g</mi></mrow></msub><mo id="algorithm1.7.7.m1.1.1.1.1.1.2" xref="algorithm1.7.7.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.7.7.m1.1.1.1.1.1.1.1" xref="algorithm1.7.7.m1.1.1.1.1.1.1.2.cmml"><mo id="algorithm1.7.7.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.7.7.m1.1.1.1.1.1.1.2.1.cmml">[</mo><msub id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.2" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.2.cmml">L</mi><mrow id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.2" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.2.cmml">n</mi><mo id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.1" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.3" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.3.cmml">e</mi></mrow></msub><mo id="algorithm1.7.7.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.7.7.m1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="algorithm1.7.7.m1.1.1.1.1.2" xref="algorithm1.7.7.m1.1.1.1.1.2.cmml">=</mo><mn id="algorithm1.7.7.m1.1.1.1.1.3" xref="algorithm1.7.7.m1.1.1.1.1.3.cmml">1</mn></mrow><mo id="algorithm1.7.7.m1.1.1.1.2" xref="algorithm1.7.7.m1.1.1.1.1.cmml">;</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.m1.1b"><apply id="algorithm1.7.7.m1.1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1.1"><eq id="algorithm1.7.7.m1.1.1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.1.1.2"></eq><apply id="algorithm1.7.7.m1.1.1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1"><times id="algorithm1.7.7.m1.1.1.1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.2"></times><apply id="algorithm1.7.7.m1.1.1.1.1.1.3.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.1.1.1.1.1.3.1.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.3">subscript</csymbol><ci id="algorithm1.7.7.m1.1.1.1.1.1.3.2.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.3.2">𝐿</ci><apply id="algorithm1.7.7.m1.1.1.1.1.1.3.3.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3"><times id="algorithm1.7.7.m1.1.1.1.1.1.3.3.1.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3.1"></times><ci id="algorithm1.7.7.m1.1.1.1.1.1.3.3.2.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3.2">𝑛</ci><ci id="algorithm1.7.7.m1.1.1.1.1.1.3.3.3.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3.3">𝑒</ci><ci id="algorithm1.7.7.m1.1.1.1.1.1.3.3.4.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.3.3.4">𝑔</ci></apply></apply><apply id="algorithm1.7.7.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="algorithm1.7.7.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.2">𝐿</ci><apply id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3"><times id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.2">𝑛</ci><ci id="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.7.7.m1.1.1.1.1.1.1.1.1.3.3">𝑒</ci></apply></apply></apply></apply><cn id="algorithm1.7.7.m1.1.1.1.1.3.cmml" type="integer" xref="algorithm1.7.7.m1.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.m1.1c">L_{neg}[L_{ne}]=1;</annotation><annotation encoding="application/x-llamapun" id="algorithm1.7.7.m1.1d">italic_L start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT [ italic_L start_POSTSUBSCRIPT italic_n italic_e end_POSTSUBSCRIPT ] = 1 ;</annotation></semantics></math> <span class="ltx_text" id="algorithm1.7.7.1" style="color:#0000FF;">change 0 in a non-label position to 1</span>
</div>
<div class="ltx_listingline" id="algorithm1.8.8">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="x_{pos}=replace\_boarder(x_{e},L_{pos})" class="ltx_Math" display="inline" id="algorithm1.8.8.m1.2"><semantics id="algorithm1.8.8.m1.2a"><mrow id="algorithm1.8.8.m1.2.2" xref="algorithm1.8.8.m1.2.2.cmml"><msub id="algorithm1.8.8.m1.2.2.4" xref="algorithm1.8.8.m1.2.2.4.cmml"><mi id="algorithm1.8.8.m1.2.2.4.2" xref="algorithm1.8.8.m1.2.2.4.2.cmml">x</mi><mrow id="algorithm1.8.8.m1.2.2.4.3" xref="algorithm1.8.8.m1.2.2.4.3.cmml"><mi id="algorithm1.8.8.m1.2.2.4.3.2" xref="algorithm1.8.8.m1.2.2.4.3.2.cmml">p</mi><mo id="algorithm1.8.8.m1.2.2.4.3.1" xref="algorithm1.8.8.m1.2.2.4.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.4.3.3" xref="algorithm1.8.8.m1.2.2.4.3.3.cmml">o</mi><mo id="algorithm1.8.8.m1.2.2.4.3.1a" xref="algorithm1.8.8.m1.2.2.4.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.4.3.4" xref="algorithm1.8.8.m1.2.2.4.3.4.cmml">s</mi></mrow></msub><mo id="algorithm1.8.8.m1.2.2.3" xref="algorithm1.8.8.m1.2.2.3.cmml">=</mo><mrow id="algorithm1.8.8.m1.2.2.2" xref="algorithm1.8.8.m1.2.2.2.cmml"><mi id="algorithm1.8.8.m1.2.2.2.4" xref="algorithm1.8.8.m1.2.2.2.4.cmml">r</mi><mo id="algorithm1.8.8.m1.2.2.2.3" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.5" xref="algorithm1.8.8.m1.2.2.2.5.cmml">e</mi><mo id="algorithm1.8.8.m1.2.2.2.3a" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.6" xref="algorithm1.8.8.m1.2.2.2.6.cmml">p</mi><mo id="algorithm1.8.8.m1.2.2.2.3b" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.7" xref="algorithm1.8.8.m1.2.2.2.7.cmml">l</mi><mo id="algorithm1.8.8.m1.2.2.2.3c" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.8" xref="algorithm1.8.8.m1.2.2.2.8.cmml">a</mi><mo id="algorithm1.8.8.m1.2.2.2.3d" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.9" xref="algorithm1.8.8.m1.2.2.2.9.cmml">c</mi><mo id="algorithm1.8.8.m1.2.2.2.3e" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.10" xref="algorithm1.8.8.m1.2.2.2.10.cmml">e</mi><mo id="algorithm1.8.8.m1.2.2.2.3f" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.11" mathvariant="normal" xref="algorithm1.8.8.m1.2.2.2.11.cmml">_</mi><mo id="algorithm1.8.8.m1.2.2.2.3g" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.12" xref="algorithm1.8.8.m1.2.2.2.12.cmml">b</mi><mo id="algorithm1.8.8.m1.2.2.2.3h" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.13" xref="algorithm1.8.8.m1.2.2.2.13.cmml">o</mi><mo id="algorithm1.8.8.m1.2.2.2.3i" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.14" xref="algorithm1.8.8.m1.2.2.2.14.cmml">a</mi><mo id="algorithm1.8.8.m1.2.2.2.3j" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.15" xref="algorithm1.8.8.m1.2.2.2.15.cmml">r</mi><mo id="algorithm1.8.8.m1.2.2.2.3k" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.16" xref="algorithm1.8.8.m1.2.2.2.16.cmml">d</mi><mo id="algorithm1.8.8.m1.2.2.2.3l" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.17" xref="algorithm1.8.8.m1.2.2.2.17.cmml">e</mi><mo id="algorithm1.8.8.m1.2.2.2.3m" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.18" xref="algorithm1.8.8.m1.2.2.2.18.cmml">r</mi><mo id="algorithm1.8.8.m1.2.2.2.3n" xref="algorithm1.8.8.m1.2.2.2.3.cmml">⁢</mo><mrow id="algorithm1.8.8.m1.2.2.2.2.2" xref="algorithm1.8.8.m1.2.2.2.2.3.cmml"><mo id="algorithm1.8.8.m1.2.2.2.2.2.3" stretchy="false" xref="algorithm1.8.8.m1.2.2.2.2.3.cmml">(</mo><msub id="algorithm1.8.8.m1.1.1.1.1.1.1" xref="algorithm1.8.8.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.8.8.m1.1.1.1.1.1.1.2" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm1.8.8.m1.1.1.1.1.1.1.3" xref="algorithm1.8.8.m1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="algorithm1.8.8.m1.2.2.2.2.2.4" xref="algorithm1.8.8.m1.2.2.2.2.3.cmml">,</mo><msub id="algorithm1.8.8.m1.2.2.2.2.2.2" xref="algorithm1.8.8.m1.2.2.2.2.2.2.cmml"><mi id="algorithm1.8.8.m1.2.2.2.2.2.2.2" xref="algorithm1.8.8.m1.2.2.2.2.2.2.2.cmml">L</mi><mrow id="algorithm1.8.8.m1.2.2.2.2.2.2.3" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3.cmml"><mi id="algorithm1.8.8.m1.2.2.2.2.2.2.3.2" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3.2.cmml">p</mi><mo id="algorithm1.8.8.m1.2.2.2.2.2.2.3.1" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.2.2.2.3.3" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3.3.cmml">o</mi><mo id="algorithm1.8.8.m1.2.2.2.2.2.2.3.1a" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.2.2.2.2.2.2.3.4" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3.4.cmml">s</mi></mrow></msub><mo id="algorithm1.8.8.m1.2.2.2.2.2.5" stretchy="false" xref="algorithm1.8.8.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m1.2b"><apply id="algorithm1.8.8.m1.2.2.cmml" xref="algorithm1.8.8.m1.2.2"><eq id="algorithm1.8.8.m1.2.2.3.cmml" xref="algorithm1.8.8.m1.2.2.3"></eq><apply id="algorithm1.8.8.m1.2.2.4.cmml" xref="algorithm1.8.8.m1.2.2.4"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.2.2.4.1.cmml" xref="algorithm1.8.8.m1.2.2.4">subscript</csymbol><ci id="algorithm1.8.8.m1.2.2.4.2.cmml" xref="algorithm1.8.8.m1.2.2.4.2">𝑥</ci><apply id="algorithm1.8.8.m1.2.2.4.3.cmml" xref="algorithm1.8.8.m1.2.2.4.3"><times id="algorithm1.8.8.m1.2.2.4.3.1.cmml" xref="algorithm1.8.8.m1.2.2.4.3.1"></times><ci id="algorithm1.8.8.m1.2.2.4.3.2.cmml" xref="algorithm1.8.8.m1.2.2.4.3.2">𝑝</ci><ci id="algorithm1.8.8.m1.2.2.4.3.3.cmml" xref="algorithm1.8.8.m1.2.2.4.3.3">𝑜</ci><ci id="algorithm1.8.8.m1.2.2.4.3.4.cmml" xref="algorithm1.8.8.m1.2.2.4.3.4">𝑠</ci></apply></apply><apply id="algorithm1.8.8.m1.2.2.2.cmml" xref="algorithm1.8.8.m1.2.2.2"><times id="algorithm1.8.8.m1.2.2.2.3.cmml" xref="algorithm1.8.8.m1.2.2.2.3"></times><ci id="algorithm1.8.8.m1.2.2.2.4.cmml" xref="algorithm1.8.8.m1.2.2.2.4">𝑟</ci><ci id="algorithm1.8.8.m1.2.2.2.5.cmml" xref="algorithm1.8.8.m1.2.2.2.5">𝑒</ci><ci id="algorithm1.8.8.m1.2.2.2.6.cmml" xref="algorithm1.8.8.m1.2.2.2.6">𝑝</ci><ci id="algorithm1.8.8.m1.2.2.2.7.cmml" xref="algorithm1.8.8.m1.2.2.2.7">𝑙</ci><ci id="algorithm1.8.8.m1.2.2.2.8.cmml" xref="algorithm1.8.8.m1.2.2.2.8">𝑎</ci><ci id="algorithm1.8.8.m1.2.2.2.9.cmml" xref="algorithm1.8.8.m1.2.2.2.9">𝑐</ci><ci id="algorithm1.8.8.m1.2.2.2.10.cmml" xref="algorithm1.8.8.m1.2.2.2.10">𝑒</ci><ci id="algorithm1.8.8.m1.2.2.2.11.cmml" xref="algorithm1.8.8.m1.2.2.2.11">_</ci><ci id="algorithm1.8.8.m1.2.2.2.12.cmml" xref="algorithm1.8.8.m1.2.2.2.12">𝑏</ci><ci id="algorithm1.8.8.m1.2.2.2.13.cmml" xref="algorithm1.8.8.m1.2.2.2.13">𝑜</ci><ci id="algorithm1.8.8.m1.2.2.2.14.cmml" xref="algorithm1.8.8.m1.2.2.2.14">𝑎</ci><ci id="algorithm1.8.8.m1.2.2.2.15.cmml" xref="algorithm1.8.8.m1.2.2.2.15">𝑟</ci><ci id="algorithm1.8.8.m1.2.2.2.16.cmml" xref="algorithm1.8.8.m1.2.2.2.16">𝑑</ci><ci id="algorithm1.8.8.m1.2.2.2.17.cmml" xref="algorithm1.8.8.m1.2.2.2.17">𝑒</ci><ci id="algorithm1.8.8.m1.2.2.2.18.cmml" xref="algorithm1.8.8.m1.2.2.2.18">𝑟</ci><interval closure="open" id="algorithm1.8.8.m1.2.2.2.2.3.cmml" xref="algorithm1.8.8.m1.2.2.2.2.2"><apply id="algorithm1.8.8.m1.1.1.1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.8.8.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm1.8.8.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.8.8.m1.1.1.1.1.1.1.3">𝑒</ci></apply><apply id="algorithm1.8.8.m1.2.2.2.2.2.2.cmml" xref="algorithm1.8.8.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.8.8.m1.2.2.2.2.2.2.1.cmml" xref="algorithm1.8.8.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.8.8.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.8.8.m1.2.2.2.2.2.2.2">𝐿</ci><apply id="algorithm1.8.8.m1.2.2.2.2.2.2.3.cmml" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3"><times id="algorithm1.8.8.m1.2.2.2.2.2.2.3.1.cmml" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3.1"></times><ci id="algorithm1.8.8.m1.2.2.2.2.2.2.3.2.cmml" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3.2">𝑝</ci><ci id="algorithm1.8.8.m1.2.2.2.2.2.2.3.3.cmml" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3.3">𝑜</ci><ci id="algorithm1.8.8.m1.2.2.2.2.2.2.3.4.cmml" xref="algorithm1.8.8.m1.2.2.2.2.2.2.3.4">𝑠</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.2c">x_{pos}=replace\_boarder(x_{e},L_{pos})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.8.8.m1.2d">italic_x start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT = italic_r italic_e italic_p italic_l italic_a italic_c italic_e _ italic_b italic_o italic_a italic_r italic_d italic_e italic_r ( italic_x start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_L start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.9.9">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="x_{neg}=replace\_boarder(x_{e},L_{neg})" class="ltx_Math" display="inline" id="algorithm1.9.9.m1.2"><semantics id="algorithm1.9.9.m1.2a"><mrow id="algorithm1.9.9.m1.2.2" xref="algorithm1.9.9.m1.2.2.cmml"><msub id="algorithm1.9.9.m1.2.2.4" xref="algorithm1.9.9.m1.2.2.4.cmml"><mi id="algorithm1.9.9.m1.2.2.4.2" xref="algorithm1.9.9.m1.2.2.4.2.cmml">x</mi><mrow id="algorithm1.9.9.m1.2.2.4.3" xref="algorithm1.9.9.m1.2.2.4.3.cmml"><mi id="algorithm1.9.9.m1.2.2.4.3.2" xref="algorithm1.9.9.m1.2.2.4.3.2.cmml">n</mi><mo id="algorithm1.9.9.m1.2.2.4.3.1" xref="algorithm1.9.9.m1.2.2.4.3.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.4.3.3" xref="algorithm1.9.9.m1.2.2.4.3.3.cmml">e</mi><mo id="algorithm1.9.9.m1.2.2.4.3.1a" xref="algorithm1.9.9.m1.2.2.4.3.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.4.3.4" xref="algorithm1.9.9.m1.2.2.4.3.4.cmml">g</mi></mrow></msub><mo id="algorithm1.9.9.m1.2.2.3" xref="algorithm1.9.9.m1.2.2.3.cmml">=</mo><mrow id="algorithm1.9.9.m1.2.2.2" xref="algorithm1.9.9.m1.2.2.2.cmml"><mi id="algorithm1.9.9.m1.2.2.2.4" xref="algorithm1.9.9.m1.2.2.2.4.cmml">r</mi><mo id="algorithm1.9.9.m1.2.2.2.3" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.5" xref="algorithm1.9.9.m1.2.2.2.5.cmml">e</mi><mo id="algorithm1.9.9.m1.2.2.2.3a" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.6" xref="algorithm1.9.9.m1.2.2.2.6.cmml">p</mi><mo id="algorithm1.9.9.m1.2.2.2.3b" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.7" xref="algorithm1.9.9.m1.2.2.2.7.cmml">l</mi><mo id="algorithm1.9.9.m1.2.2.2.3c" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.8" xref="algorithm1.9.9.m1.2.2.2.8.cmml">a</mi><mo id="algorithm1.9.9.m1.2.2.2.3d" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.9" xref="algorithm1.9.9.m1.2.2.2.9.cmml">c</mi><mo id="algorithm1.9.9.m1.2.2.2.3e" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.10" xref="algorithm1.9.9.m1.2.2.2.10.cmml">e</mi><mo id="algorithm1.9.9.m1.2.2.2.3f" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.11" mathvariant="normal" xref="algorithm1.9.9.m1.2.2.2.11.cmml">_</mi><mo id="algorithm1.9.9.m1.2.2.2.3g" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.12" xref="algorithm1.9.9.m1.2.2.2.12.cmml">b</mi><mo id="algorithm1.9.9.m1.2.2.2.3h" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.13" xref="algorithm1.9.9.m1.2.2.2.13.cmml">o</mi><mo id="algorithm1.9.9.m1.2.2.2.3i" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.14" xref="algorithm1.9.9.m1.2.2.2.14.cmml">a</mi><mo id="algorithm1.9.9.m1.2.2.2.3j" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.15" xref="algorithm1.9.9.m1.2.2.2.15.cmml">r</mi><mo id="algorithm1.9.9.m1.2.2.2.3k" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.16" xref="algorithm1.9.9.m1.2.2.2.16.cmml">d</mi><mo id="algorithm1.9.9.m1.2.2.2.3l" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.17" xref="algorithm1.9.9.m1.2.2.2.17.cmml">e</mi><mo id="algorithm1.9.9.m1.2.2.2.3m" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.18" xref="algorithm1.9.9.m1.2.2.2.18.cmml">r</mi><mo id="algorithm1.9.9.m1.2.2.2.3n" xref="algorithm1.9.9.m1.2.2.2.3.cmml">⁢</mo><mrow id="algorithm1.9.9.m1.2.2.2.2.2" xref="algorithm1.9.9.m1.2.2.2.2.3.cmml"><mo id="algorithm1.9.9.m1.2.2.2.2.2.3" stretchy="false" xref="algorithm1.9.9.m1.2.2.2.2.3.cmml">(</mo><msub id="algorithm1.9.9.m1.1.1.1.1.1.1" xref="algorithm1.9.9.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.9.9.m1.1.1.1.1.1.1.2" xref="algorithm1.9.9.m1.1.1.1.1.1.1.2.cmml">x</mi><mi id="algorithm1.9.9.m1.1.1.1.1.1.1.3" xref="algorithm1.9.9.m1.1.1.1.1.1.1.3.cmml">e</mi></msub><mo id="algorithm1.9.9.m1.2.2.2.2.2.4" xref="algorithm1.9.9.m1.2.2.2.2.3.cmml">,</mo><msub id="algorithm1.9.9.m1.2.2.2.2.2.2" xref="algorithm1.9.9.m1.2.2.2.2.2.2.cmml"><mi id="algorithm1.9.9.m1.2.2.2.2.2.2.2" xref="algorithm1.9.9.m1.2.2.2.2.2.2.2.cmml">L</mi><mrow id="algorithm1.9.9.m1.2.2.2.2.2.2.3" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3.cmml"><mi id="algorithm1.9.9.m1.2.2.2.2.2.2.3.2" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3.2.cmml">n</mi><mo id="algorithm1.9.9.m1.2.2.2.2.2.2.3.1" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.2.2.2.3.3" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3.3.cmml">e</mi><mo id="algorithm1.9.9.m1.2.2.2.2.2.2.3.1a" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.2.2.2.2.2.2.3.4" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3.4.cmml">g</mi></mrow></msub><mo id="algorithm1.9.9.m1.2.2.2.2.2.5" stretchy="false" xref="algorithm1.9.9.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.2b"><apply id="algorithm1.9.9.m1.2.2.cmml" xref="algorithm1.9.9.m1.2.2"><eq id="algorithm1.9.9.m1.2.2.3.cmml" xref="algorithm1.9.9.m1.2.2.3"></eq><apply id="algorithm1.9.9.m1.2.2.4.cmml" xref="algorithm1.9.9.m1.2.2.4"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.2.2.4.1.cmml" xref="algorithm1.9.9.m1.2.2.4">subscript</csymbol><ci id="algorithm1.9.9.m1.2.2.4.2.cmml" xref="algorithm1.9.9.m1.2.2.4.2">𝑥</ci><apply id="algorithm1.9.9.m1.2.2.4.3.cmml" xref="algorithm1.9.9.m1.2.2.4.3"><times id="algorithm1.9.9.m1.2.2.4.3.1.cmml" xref="algorithm1.9.9.m1.2.2.4.3.1"></times><ci id="algorithm1.9.9.m1.2.2.4.3.2.cmml" xref="algorithm1.9.9.m1.2.2.4.3.2">𝑛</ci><ci id="algorithm1.9.9.m1.2.2.4.3.3.cmml" xref="algorithm1.9.9.m1.2.2.4.3.3">𝑒</ci><ci id="algorithm1.9.9.m1.2.2.4.3.4.cmml" xref="algorithm1.9.9.m1.2.2.4.3.4">𝑔</ci></apply></apply><apply id="algorithm1.9.9.m1.2.2.2.cmml" xref="algorithm1.9.9.m1.2.2.2"><times id="algorithm1.9.9.m1.2.2.2.3.cmml" xref="algorithm1.9.9.m1.2.2.2.3"></times><ci id="algorithm1.9.9.m1.2.2.2.4.cmml" xref="algorithm1.9.9.m1.2.2.2.4">𝑟</ci><ci id="algorithm1.9.9.m1.2.2.2.5.cmml" xref="algorithm1.9.9.m1.2.2.2.5">𝑒</ci><ci id="algorithm1.9.9.m1.2.2.2.6.cmml" xref="algorithm1.9.9.m1.2.2.2.6">𝑝</ci><ci id="algorithm1.9.9.m1.2.2.2.7.cmml" xref="algorithm1.9.9.m1.2.2.2.7">𝑙</ci><ci id="algorithm1.9.9.m1.2.2.2.8.cmml" xref="algorithm1.9.9.m1.2.2.2.8">𝑎</ci><ci id="algorithm1.9.9.m1.2.2.2.9.cmml" xref="algorithm1.9.9.m1.2.2.2.9">𝑐</ci><ci id="algorithm1.9.9.m1.2.2.2.10.cmml" xref="algorithm1.9.9.m1.2.2.2.10">𝑒</ci><ci id="algorithm1.9.9.m1.2.2.2.11.cmml" xref="algorithm1.9.9.m1.2.2.2.11">_</ci><ci id="algorithm1.9.9.m1.2.2.2.12.cmml" xref="algorithm1.9.9.m1.2.2.2.12">𝑏</ci><ci id="algorithm1.9.9.m1.2.2.2.13.cmml" xref="algorithm1.9.9.m1.2.2.2.13">𝑜</ci><ci id="algorithm1.9.9.m1.2.2.2.14.cmml" xref="algorithm1.9.9.m1.2.2.2.14">𝑎</ci><ci id="algorithm1.9.9.m1.2.2.2.15.cmml" xref="algorithm1.9.9.m1.2.2.2.15">𝑟</ci><ci id="algorithm1.9.9.m1.2.2.2.16.cmml" xref="algorithm1.9.9.m1.2.2.2.16">𝑑</ci><ci id="algorithm1.9.9.m1.2.2.2.17.cmml" xref="algorithm1.9.9.m1.2.2.2.17">𝑒</ci><ci id="algorithm1.9.9.m1.2.2.2.18.cmml" xref="algorithm1.9.9.m1.2.2.2.18">𝑟</ci><interval closure="open" id="algorithm1.9.9.m1.2.2.2.2.3.cmml" xref="algorithm1.9.9.m1.2.2.2.2.2"><apply id="algorithm1.9.9.m1.1.1.1.1.1.1.cmml" xref="algorithm1.9.9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.9.9.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.9.9.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.9.9.m1.1.1.1.1.1.1.2">𝑥</ci><ci id="algorithm1.9.9.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.9.9.m1.1.1.1.1.1.1.3">𝑒</ci></apply><apply id="algorithm1.9.9.m1.2.2.2.2.2.2.cmml" xref="algorithm1.9.9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="algorithm1.9.9.m1.2.2.2.2.2.2.1.cmml" xref="algorithm1.9.9.m1.2.2.2.2.2.2">subscript</csymbol><ci id="algorithm1.9.9.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.9.9.m1.2.2.2.2.2.2.2">𝐿</ci><apply id="algorithm1.9.9.m1.2.2.2.2.2.2.3.cmml" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3"><times id="algorithm1.9.9.m1.2.2.2.2.2.2.3.1.cmml" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3.1"></times><ci id="algorithm1.9.9.m1.2.2.2.2.2.2.3.2.cmml" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3.2">𝑛</ci><ci id="algorithm1.9.9.m1.2.2.2.2.2.2.3.3.cmml" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3.3">𝑒</ci><ci id="algorithm1.9.9.m1.2.2.2.2.2.2.3.4.cmml" xref="algorithm1.9.9.m1.2.2.2.2.2.2.3.4">𝑔</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.2c">x_{neg}=replace\_boarder(x_{e},L_{neg})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.9.9.m1.2d">italic_x start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT = italic_r italic_e italic_p italic_l italic_a italic_c italic_e _ italic_b italic_o italic_a italic_r italic_d italic_e italic_r ( italic_x start_POSTSUBSCRIPT italic_e end_POSTSUBSCRIPT , italic_L start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.14.16">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   # <span class="ltx_text" id="algorithm1.14.16.1" style="color:#0000FF;">Run pos and neg samples to target layer</span>
</div>
<div class="ltx_listingline" id="algorithm1.10.10">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="g_{\text{pos}}=\text{RunLayers}(0,l,x_{pos})" class="ltx_Math" display="inline" id="algorithm1.10.10.m1.3"><semantics id="algorithm1.10.10.m1.3a"><mrow id="algorithm1.10.10.m1.3.3" xref="algorithm1.10.10.m1.3.3.cmml"><msub id="algorithm1.10.10.m1.3.3.3" xref="algorithm1.10.10.m1.3.3.3.cmml"><mi id="algorithm1.10.10.m1.3.3.3.2" xref="algorithm1.10.10.m1.3.3.3.2.cmml">g</mi><mtext id="algorithm1.10.10.m1.3.3.3.3" xref="algorithm1.10.10.m1.3.3.3.3a.cmml">pos</mtext></msub><mo id="algorithm1.10.10.m1.3.3.2" xref="algorithm1.10.10.m1.3.3.2.cmml">=</mo><mrow id="algorithm1.10.10.m1.3.3.1" xref="algorithm1.10.10.m1.3.3.1.cmml"><mtext id="algorithm1.10.10.m1.3.3.1.3" xref="algorithm1.10.10.m1.3.3.1.3a.cmml">RunLayers</mtext><mo id="algorithm1.10.10.m1.3.3.1.2" xref="algorithm1.10.10.m1.3.3.1.2.cmml">⁢</mo><mrow id="algorithm1.10.10.m1.3.3.1.1.1" xref="algorithm1.10.10.m1.3.3.1.1.2.cmml"><mo id="algorithm1.10.10.m1.3.3.1.1.1.2" stretchy="false" xref="algorithm1.10.10.m1.3.3.1.1.2.cmml">(</mo><mn id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml">0</mn><mo id="algorithm1.10.10.m1.3.3.1.1.1.3" xref="algorithm1.10.10.m1.3.3.1.1.2.cmml">,</mo><mi id="algorithm1.10.10.m1.2.2" xref="algorithm1.10.10.m1.2.2.cmml">l</mi><mo id="algorithm1.10.10.m1.3.3.1.1.1.4" xref="algorithm1.10.10.m1.3.3.1.1.2.cmml">,</mo><msub id="algorithm1.10.10.m1.3.3.1.1.1.1" xref="algorithm1.10.10.m1.3.3.1.1.1.1.cmml"><mi id="algorithm1.10.10.m1.3.3.1.1.1.1.2" xref="algorithm1.10.10.m1.3.3.1.1.1.1.2.cmml">x</mi><mrow id="algorithm1.10.10.m1.3.3.1.1.1.1.3" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3.cmml"><mi id="algorithm1.10.10.m1.3.3.1.1.1.1.3.2" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3.2.cmml">p</mi><mo id="algorithm1.10.10.m1.3.3.1.1.1.1.3.1" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.10.10.m1.3.3.1.1.1.1.3.3" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3.3.cmml">o</mi><mo id="algorithm1.10.10.m1.3.3.1.1.1.1.3.1a" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.10.10.m1.3.3.1.1.1.1.3.4" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3.4.cmml">s</mi></mrow></msub><mo id="algorithm1.10.10.m1.3.3.1.1.1.5" stretchy="false" xref="algorithm1.10.10.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.3b"><apply id="algorithm1.10.10.m1.3.3.cmml" xref="algorithm1.10.10.m1.3.3"><eq id="algorithm1.10.10.m1.3.3.2.cmml" xref="algorithm1.10.10.m1.3.3.2"></eq><apply id="algorithm1.10.10.m1.3.3.3.cmml" xref="algorithm1.10.10.m1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.3.3.3.1.cmml" xref="algorithm1.10.10.m1.3.3.3">subscript</csymbol><ci id="algorithm1.10.10.m1.3.3.3.2.cmml" xref="algorithm1.10.10.m1.3.3.3.2">𝑔</ci><ci id="algorithm1.10.10.m1.3.3.3.3a.cmml" xref="algorithm1.10.10.m1.3.3.3.3"><mtext id="algorithm1.10.10.m1.3.3.3.3.cmml" mathsize="70%" xref="algorithm1.10.10.m1.3.3.3.3">pos</mtext></ci></apply><apply id="algorithm1.10.10.m1.3.3.1.cmml" xref="algorithm1.10.10.m1.3.3.1"><times id="algorithm1.10.10.m1.3.3.1.2.cmml" xref="algorithm1.10.10.m1.3.3.1.2"></times><ci id="algorithm1.10.10.m1.3.3.1.3a.cmml" xref="algorithm1.10.10.m1.3.3.1.3"><mtext id="algorithm1.10.10.m1.3.3.1.3.cmml" xref="algorithm1.10.10.m1.3.3.1.3">RunLayers</mtext></ci><vector id="algorithm1.10.10.m1.3.3.1.1.2.cmml" xref="algorithm1.10.10.m1.3.3.1.1.1"><cn id="algorithm1.10.10.m1.1.1.cmml" type="integer" xref="algorithm1.10.10.m1.1.1">0</cn><ci id="algorithm1.10.10.m1.2.2.cmml" xref="algorithm1.10.10.m1.2.2">𝑙</ci><apply id="algorithm1.10.10.m1.3.3.1.1.1.1.cmml" xref="algorithm1.10.10.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.3.3.1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.3.3.1.1.1.1">subscript</csymbol><ci id="algorithm1.10.10.m1.3.3.1.1.1.1.2.cmml" xref="algorithm1.10.10.m1.3.3.1.1.1.1.2">𝑥</ci><apply id="algorithm1.10.10.m1.3.3.1.1.1.1.3.cmml" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3"><times id="algorithm1.10.10.m1.3.3.1.1.1.1.3.1.cmml" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3.1"></times><ci id="algorithm1.10.10.m1.3.3.1.1.1.1.3.2.cmml" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3.2">𝑝</ci><ci id="algorithm1.10.10.m1.3.3.1.1.1.1.3.3.cmml" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3.3">𝑜</ci><ci id="algorithm1.10.10.m1.3.3.1.1.1.1.3.4.cmml" xref="algorithm1.10.10.m1.3.3.1.1.1.1.3.4">𝑠</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.3c">g_{\text{pos}}=\text{RunLayers}(0,l,x_{pos})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.10.10.m1.3d">italic_g start_POSTSUBSCRIPT pos end_POSTSUBSCRIPT = RunLayers ( 0 , italic_l , italic_x start_POSTSUBSCRIPT italic_p italic_o italic_s end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.11.11">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="g_{\text{neg}}=\text{RunLayers}(0,l,x_{neg})" class="ltx_Math" display="inline" id="algorithm1.11.11.m1.3"><semantics id="algorithm1.11.11.m1.3a"><mrow id="algorithm1.11.11.m1.3.3" xref="algorithm1.11.11.m1.3.3.cmml"><msub id="algorithm1.11.11.m1.3.3.3" xref="algorithm1.11.11.m1.3.3.3.cmml"><mi id="algorithm1.11.11.m1.3.3.3.2" xref="algorithm1.11.11.m1.3.3.3.2.cmml">g</mi><mtext id="algorithm1.11.11.m1.3.3.3.3" xref="algorithm1.11.11.m1.3.3.3.3a.cmml">neg</mtext></msub><mo id="algorithm1.11.11.m1.3.3.2" xref="algorithm1.11.11.m1.3.3.2.cmml">=</mo><mrow id="algorithm1.11.11.m1.3.3.1" xref="algorithm1.11.11.m1.3.3.1.cmml"><mtext id="algorithm1.11.11.m1.3.3.1.3" xref="algorithm1.11.11.m1.3.3.1.3a.cmml">RunLayers</mtext><mo id="algorithm1.11.11.m1.3.3.1.2" xref="algorithm1.11.11.m1.3.3.1.2.cmml">⁢</mo><mrow id="algorithm1.11.11.m1.3.3.1.1.1" xref="algorithm1.11.11.m1.3.3.1.1.2.cmml"><mo id="algorithm1.11.11.m1.3.3.1.1.1.2" stretchy="false" xref="algorithm1.11.11.m1.3.3.1.1.2.cmml">(</mo><mn id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml">0</mn><mo id="algorithm1.11.11.m1.3.3.1.1.1.3" xref="algorithm1.11.11.m1.3.3.1.1.2.cmml">,</mo><mi id="algorithm1.11.11.m1.2.2" xref="algorithm1.11.11.m1.2.2.cmml">l</mi><mo id="algorithm1.11.11.m1.3.3.1.1.1.4" xref="algorithm1.11.11.m1.3.3.1.1.2.cmml">,</mo><msub id="algorithm1.11.11.m1.3.3.1.1.1.1" xref="algorithm1.11.11.m1.3.3.1.1.1.1.cmml"><mi id="algorithm1.11.11.m1.3.3.1.1.1.1.2" xref="algorithm1.11.11.m1.3.3.1.1.1.1.2.cmml">x</mi><mrow id="algorithm1.11.11.m1.3.3.1.1.1.1.3" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.cmml"><mi id="algorithm1.11.11.m1.3.3.1.1.1.1.3.2" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.2.cmml">n</mi><mo id="algorithm1.11.11.m1.3.3.1.1.1.1.3.1" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.3.3.1.1.1.1.3.3" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.3.cmml">e</mi><mo id="algorithm1.11.11.m1.3.3.1.1.1.1.3.1a" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.3.3.1.1.1.1.3.4" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.4.cmml">g</mi></mrow></msub><mo id="algorithm1.11.11.m1.3.3.1.1.1.5" stretchy="false" xref="algorithm1.11.11.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.3b"><apply id="algorithm1.11.11.m1.3.3.cmml" xref="algorithm1.11.11.m1.3.3"><eq id="algorithm1.11.11.m1.3.3.2.cmml" xref="algorithm1.11.11.m1.3.3.2"></eq><apply id="algorithm1.11.11.m1.3.3.3.cmml" xref="algorithm1.11.11.m1.3.3.3"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.3.3.3.1.cmml" xref="algorithm1.11.11.m1.3.3.3">subscript</csymbol><ci id="algorithm1.11.11.m1.3.3.3.2.cmml" xref="algorithm1.11.11.m1.3.3.3.2">𝑔</ci><ci id="algorithm1.11.11.m1.3.3.3.3a.cmml" xref="algorithm1.11.11.m1.3.3.3.3"><mtext id="algorithm1.11.11.m1.3.3.3.3.cmml" mathsize="70%" xref="algorithm1.11.11.m1.3.3.3.3">neg</mtext></ci></apply><apply id="algorithm1.11.11.m1.3.3.1.cmml" xref="algorithm1.11.11.m1.3.3.1"><times id="algorithm1.11.11.m1.3.3.1.2.cmml" xref="algorithm1.11.11.m1.3.3.1.2"></times><ci id="algorithm1.11.11.m1.3.3.1.3a.cmml" xref="algorithm1.11.11.m1.3.3.1.3"><mtext id="algorithm1.11.11.m1.3.3.1.3.cmml" xref="algorithm1.11.11.m1.3.3.1.3">RunLayers</mtext></ci><vector id="algorithm1.11.11.m1.3.3.1.1.2.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1"><cn id="algorithm1.11.11.m1.1.1.cmml" type="integer" xref="algorithm1.11.11.m1.1.1">0</cn><ci id="algorithm1.11.11.m1.2.2.cmml" xref="algorithm1.11.11.m1.2.2">𝑙</ci><apply id="algorithm1.11.11.m1.3.3.1.1.1.1.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.3.3.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1">subscript</csymbol><ci id="algorithm1.11.11.m1.3.3.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1.2">𝑥</ci><apply id="algorithm1.11.11.m1.3.3.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3"><times id="algorithm1.11.11.m1.3.3.1.1.1.1.3.1.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.1"></times><ci id="algorithm1.11.11.m1.3.3.1.1.1.1.3.2.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.2">𝑛</ci><ci id="algorithm1.11.11.m1.3.3.1.1.1.1.3.3.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.3">𝑒</ci><ci id="algorithm1.11.11.m1.3.3.1.1.1.1.3.4.cmml" xref="algorithm1.11.11.m1.3.3.1.1.1.1.3.4">𝑔</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.3c">g_{\text{neg}}=\text{RunLayers}(0,l,x_{neg})</annotation><annotation encoding="application/x-llamapun" id="algorithm1.11.11.m1.3d">italic_g start_POSTSUBSCRIPT neg end_POSTSUBSCRIPT = RunLayers ( 0 , italic_l , italic_x start_POSTSUBSCRIPT italic_n italic_e italic_g end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.14.17">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
# <span class="ltx_text" id="algorithm1.14.17.1" style="color:#0000FF;">Compute loss</span>
</div>
<div class="ltx_listingline" id="algorithm1.12.12">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\text{loss}=\frac{1}{2}(\log(1+e^{-g_{\text{pos}}})+\log(1+e^{g_{\text{neg}}}))" class="ltx_Math" display="inline" id="algorithm1.12.12.m1.3"><semantics id="algorithm1.12.12.m1.3a"><mrow id="algorithm1.12.12.m1.3.3" xref="algorithm1.12.12.m1.3.3.cmml"><mtext id="algorithm1.12.12.m1.3.3.3" xref="algorithm1.12.12.m1.3.3.3a.cmml">loss</mtext><mo id="algorithm1.12.12.m1.3.3.2" xref="algorithm1.12.12.m1.3.3.2.cmml">=</mo><mrow id="algorithm1.12.12.m1.3.3.1" xref="algorithm1.12.12.m1.3.3.1.cmml"><mfrac id="algorithm1.12.12.m1.3.3.1.3" xref="algorithm1.12.12.m1.3.3.1.3.cmml"><mn id="algorithm1.12.12.m1.3.3.1.3.2" xref="algorithm1.12.12.m1.3.3.1.3.2.cmml">1</mn><mn id="algorithm1.12.12.m1.3.3.1.3.3" xref="algorithm1.12.12.m1.3.3.1.3.3.cmml">2</mn></mfrac><mo id="algorithm1.12.12.m1.3.3.1.2" xref="algorithm1.12.12.m1.3.3.1.2.cmml">⁢</mo><mrow id="algorithm1.12.12.m1.3.3.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.cmml"><mo id="algorithm1.12.12.m1.3.3.1.1.1.2" stretchy="false" xref="algorithm1.12.12.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="algorithm1.12.12.m1.3.3.1.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.cmml"><mrow id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.2.cmml"><mi id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml">log</mi><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1a" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.2.cmml"><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mrow id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mn id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">e</mi><mrow id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3a" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">−</mo><msub id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.2.cmml">g</mi><mtext id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.3a.cmml">pos</mtext></msub></mrow></msup></mrow><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.3.cmml">+</mo><mrow id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.cmml"><mi id="algorithm1.12.12.m1.2.2" xref="algorithm1.12.12.m1.2.2.cmml">log</mi><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1a" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.cmml">⁡</mo><mrow id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.cmml"><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.2" stretchy="false" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.cmml">(</mo><mrow id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.cmml"><mn id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.2.cmml">1</mn><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.1" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.1.cmml">+</mo><msup id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.cmml"><mi id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.2.cmml">e</mi><msub id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.cmml"><mi id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.2" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.2.cmml">g</mi><mtext id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.3" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.3a.cmml">neg</mtext></msub></msup></mrow><mo id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.3" stretchy="false" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="algorithm1.12.12.m1.3.3.1.1.1.3" stretchy="false" xref="algorithm1.12.12.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.3b"><apply id="algorithm1.12.12.m1.3.3.cmml" xref="algorithm1.12.12.m1.3.3"><eq id="algorithm1.12.12.m1.3.3.2.cmml" xref="algorithm1.12.12.m1.3.3.2"></eq><ci id="algorithm1.12.12.m1.3.3.3a.cmml" xref="algorithm1.12.12.m1.3.3.3"><mtext id="algorithm1.12.12.m1.3.3.3.cmml" xref="algorithm1.12.12.m1.3.3.3">loss</mtext></ci><apply id="algorithm1.12.12.m1.3.3.1.cmml" xref="algorithm1.12.12.m1.3.3.1"><times id="algorithm1.12.12.m1.3.3.1.2.cmml" xref="algorithm1.12.12.m1.3.3.1.2"></times><apply id="algorithm1.12.12.m1.3.3.1.3.cmml" xref="algorithm1.12.12.m1.3.3.1.3"><divide id="algorithm1.12.12.m1.3.3.1.3.1.cmml" xref="algorithm1.12.12.m1.3.3.1.3"></divide><cn id="algorithm1.12.12.m1.3.3.1.3.2.cmml" type="integer" xref="algorithm1.12.12.m1.3.3.1.3.2">1</cn><cn id="algorithm1.12.12.m1.3.3.1.3.3.cmml" type="integer" xref="algorithm1.12.12.m1.3.3.1.3.3">2</cn></apply><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1"><plus id="algorithm1.12.12.m1.3.3.1.1.1.1.3.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.3"></plus><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.1.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1"><log id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1"></log><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1"><plus id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.1"></plus><cn id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.2">1</cn><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝑒</ci><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3"><minus id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3"></minus><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.2">𝑔</ci><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.3a.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.3"><mtext id="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.3.cmml" mathsize="50%" xref="algorithm1.12.12.m1.3.3.1.1.1.1.1.1.1.1.3.3.2.3">pos</mtext></ci></apply></apply></apply></apply></apply><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.2.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1"><log id="algorithm1.12.12.m1.2.2.cmml" xref="algorithm1.12.12.m1.2.2"></log><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1"><plus id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.1"></plus><cn id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.2.cmml" type="integer" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.2">1</cn><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3">superscript</csymbol><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.2">𝑒</ci><apply id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3"><csymbol cd="ambiguous" id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.1.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3">subscript</csymbol><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.2.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.2">𝑔</ci><ci id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.3a.cmml" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.3"><mtext id="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.3.cmml" mathsize="50%" xref="algorithm1.12.12.m1.3.3.1.1.1.1.2.1.1.1.3.3.3">neg</mtext></ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.3c">\text{loss}=\frac{1}{2}(\log(1+e^{-g_{\text{pos}}})+\log(1+e^{g_{\text{neg}}}))</annotation><annotation encoding="application/x-llamapun" id="algorithm1.12.12.m1.3d">loss = divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( roman_log ( 1 + italic_e start_POSTSUPERSCRIPT - italic_g start_POSTSUBSCRIPT pos end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) + roman_log ( 1 + italic_e start_POSTSUPERSCRIPT italic_g start_POSTSUBSCRIPT neg end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.14.18">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
# <span class="ltx_text" id="algorithm1.14.18.1" style="color:#0000FF;">Update weights</span>
</div>
<div class="ltx_listingline" id="algorithm1.13.13">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="W_{grad}=\text{one\_layer\_backpropagate}(loss);" class="ltx_Math" display="inline" id="algorithm1.13.13.m1.1"><semantics id="algorithm1.13.13.m1.1a"><mrow id="algorithm1.13.13.m1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.cmml"><mrow id="algorithm1.13.13.m1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.cmml"><msub id="algorithm1.13.13.m1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.3.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.3.2" xref="algorithm1.13.13.m1.1.1.1.1.3.2.cmml">W</mi><mrow id="algorithm1.13.13.m1.1.1.1.1.3.3" xref="algorithm1.13.13.m1.1.1.1.1.3.3.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.3.3.2" xref="algorithm1.13.13.m1.1.1.1.1.3.3.2.cmml">g</mi><mo id="algorithm1.13.13.m1.1.1.1.1.3.3.1" xref="algorithm1.13.13.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm1.13.13.m1.1.1.1.1.3.3.3" xref="algorithm1.13.13.m1.1.1.1.1.3.3.3.cmml">r</mi><mo id="algorithm1.13.13.m1.1.1.1.1.3.3.1a" xref="algorithm1.13.13.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm1.13.13.m1.1.1.1.1.3.3.4" xref="algorithm1.13.13.m1.1.1.1.1.3.3.4.cmml">a</mi><mo id="algorithm1.13.13.m1.1.1.1.1.3.3.1b" xref="algorithm1.13.13.m1.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm1.13.13.m1.1.1.1.1.3.3.5" xref="algorithm1.13.13.m1.1.1.1.1.3.3.5.cmml">d</mi></mrow></msub><mo id="algorithm1.13.13.m1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.2.cmml">=</mo><mrow id="algorithm1.13.13.m1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.cmml"><mtext id="algorithm1.13.13.m1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.1.3a.cmml">one_layer_backpropagate</mtext><mo id="algorithm1.13.13.m1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.13.13.m1.1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml"><mo id="algorithm1.13.13.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.2.cmml">l</mi><mo id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.3" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.3.cmml">o</mi><mo id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.1a" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.4" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.4.cmml">s</mi><mo id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.1b" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.5" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.5.cmml">s</mi></mrow><mo id="algorithm1.13.13.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="algorithm1.13.13.m1.1.1.1.2" xref="algorithm1.13.13.m1.1.1.1.1.cmml">;</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1"><eq id="algorithm1.13.13.m1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.2"></eq><apply id="algorithm1.13.13.m1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.13.13.m1.1.1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3">subscript</csymbol><ci id="algorithm1.13.13.m1.1.1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.2">𝑊</ci><apply id="algorithm1.13.13.m1.1.1.1.1.3.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.3"><times id="algorithm1.13.13.m1.1.1.1.1.3.3.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.3.1"></times><ci id="algorithm1.13.13.m1.1.1.1.1.3.3.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.3.2">𝑔</ci><ci id="algorithm1.13.13.m1.1.1.1.1.3.3.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.3.3">𝑟</ci><ci id="algorithm1.13.13.m1.1.1.1.1.3.3.4.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.3.4">𝑎</ci><ci id="algorithm1.13.13.m1.1.1.1.1.3.3.5.cmml" xref="algorithm1.13.13.m1.1.1.1.1.3.3.5">𝑑</ci></apply></apply><apply id="algorithm1.13.13.m1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1"><times id="algorithm1.13.13.m1.1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.2"></times><ci id="algorithm1.13.13.m1.1.1.1.1.1.3a.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.3"><mtext id="algorithm1.13.13.m1.1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.3">one_layer_backpropagate</mtext></ci><apply id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1"><times id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.1"></times><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.2">𝑙</ci><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.3">𝑜</ci><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.4.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.4">𝑠</ci><ci id="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.5.cmml" xref="algorithm1.13.13.m1.1.1.1.1.1.1.1.1.5">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">W_{grad}=\text{one\_layer\_backpropagate}(loss);</annotation><annotation encoding="application/x-llamapun" id="algorithm1.13.13.m1.1d">italic_W start_POSTSUBSCRIPT italic_g italic_r italic_a italic_d end_POSTSUBSCRIPT = one_layer_backpropagate ( italic_l italic_o italic_s italic_s ) ;</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.14.14">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="\text{model.layer(l).weights\_update}(W_{grad});" class="ltx_Math" display="inline" id="algorithm1.14.14.m1.1"><semantics id="algorithm1.14.14.m1.1a"><mrow id="algorithm1.14.14.m1.1.1.1" xref="algorithm1.14.14.m1.1.1.1.1.cmml"><mrow id="algorithm1.14.14.m1.1.1.1.1" xref="algorithm1.14.14.m1.1.1.1.1.cmml"><mtext id="algorithm1.14.14.m1.1.1.1.1.3" xref="algorithm1.14.14.m1.1.1.1.1.3a.cmml">model.layer(l).weights_update</mtext><mo id="algorithm1.14.14.m1.1.1.1.1.2" xref="algorithm1.14.14.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.14.14.m1.1.1.1.1.1.1" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.cmml"><mo id="algorithm1.14.14.m1.1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="algorithm1.14.14.m1.1.1.1.1.1.1.1" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.14.14.m1.1.1.1.1.1.1.1.2" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.2.cmml">W</mi><mrow id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.2" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.2.cmml">g</mi><mo id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.1" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.3" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.3.cmml">r</mi><mo id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.1a" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.4" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.4.cmml">a</mi><mo id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.1b" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.5" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.5.cmml">d</mi></mrow></msub><mo id="algorithm1.14.14.m1.1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.14.14.m1.1.1.1.2" xref="algorithm1.14.14.m1.1.1.1.1.cmml">;</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.1b"><apply id="algorithm1.14.14.m1.1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1.1"><times id="algorithm1.14.14.m1.1.1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.1.1.2"></times><ci id="algorithm1.14.14.m1.1.1.1.1.3a.cmml" xref="algorithm1.14.14.m1.1.1.1.1.3"><mtext id="algorithm1.14.14.m1.1.1.1.1.3.cmml" xref="algorithm1.14.14.m1.1.1.1.1.3">model.layer(l).weights_update</mtext></ci><apply id="algorithm1.14.14.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.14.14.m1.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.14.14.m1.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.2">𝑊</ci><apply id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3"><times id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.1"></times><ci id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.2">𝑔</ci><ci id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.3">𝑟</ci><ci id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.4.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.4">𝑎</ci><ci id="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.5.cmml" xref="algorithm1.14.14.m1.1.1.1.1.1.1.1.3.5">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.1c">\text{model.layer(l).weights\_update}(W_{grad});</annotation><annotation encoding="application/x-llamapun" id="algorithm1.14.14.m1.1d">model.layer(l).weights_update ( italic_W start_POSTSUBSCRIPT italic_g italic_r italic_a italic_d end_POSTSUBSCRIPT ) ;</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="algorithm1.14.19">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    end for
</div>
<div class="ltx_listingline" id="algorithm1.14.20">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
</div>
<div class="ltx_listingline" id="algorithm1.14.21"> end for
</div>
<div class="ltx_listingline" id="algorithm1.14.22">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm1.16.1.1">Algorithm 1</span> </span> Forward-Forward Algorithm </figcaption>
</figure>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1">The Forward-Forward Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#algorithm1" title="Algorithm 1 ‣ II Related Work ‣ Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_tag">1</span></a> is designed to optimize a neural network’s performance through a systematic training process. It initializes by partitioning the available dataset into training and testing sets. The algorithm then iteratively adjusts the model’s weights over a predefined number of epochs and iterations within each epoch. In each iteration, the algorithm identifies positive samples, where the class is correctly labeled, and negative samples, which are randomly chosen from non-matching classes. For both sets of samples, it computes the activations at each layer of the model.</p>
</div>
<div class="ltx_para" id="S2.p6">
<p class="ltx_p" id="S2.p6.3">The algorithm computes the gradients of the loss function, which is designed to penalize the model for incorrect classifications. Specifically, for positive samples (<math alttext="g_{\text{pos}}" class="ltx_Math" display="inline" id="S2.p6.1.m1.1"><semantics id="S2.p6.1.m1.1a"><msub id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml"><mi id="S2.p6.1.m1.1.1.2" xref="S2.p6.1.m1.1.1.2.cmml">g</mi><mtext id="S2.p6.1.m1.1.1.3" xref="S2.p6.1.m1.1.1.3a.cmml">pos</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><apply id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p6.1.m1.1.1.1.cmml" xref="S2.p6.1.m1.1.1">subscript</csymbol><ci id="S2.p6.1.m1.1.1.2.cmml" xref="S2.p6.1.m1.1.1.2">𝑔</ci><ci id="S2.p6.1.m1.1.1.3a.cmml" xref="S2.p6.1.m1.1.1.3"><mtext id="S2.p6.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.p6.1.m1.1.1.3">pos</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">g_{\text{pos}}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.1.m1.1d">italic_g start_POSTSUBSCRIPT pos end_POSTSUBSCRIPT</annotation></semantics></math>), the loss increases when the model’s confidence in the correct classification is low. Conversely, for negative samples (<math alttext="g_{\text{neg}}" class="ltx_Math" display="inline" id="S2.p6.2.m2.1"><semantics id="S2.p6.2.m2.1a"><msub id="S2.p6.2.m2.1.1" xref="S2.p6.2.m2.1.1.cmml"><mi id="S2.p6.2.m2.1.1.2" xref="S2.p6.2.m2.1.1.2.cmml">g</mi><mtext id="S2.p6.2.m2.1.1.3" xref="S2.p6.2.m2.1.1.3a.cmml">neg</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p6.2.m2.1b"><apply id="S2.p6.2.m2.1.1.cmml" xref="S2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p6.2.m2.1.1.1.cmml" xref="S2.p6.2.m2.1.1">subscript</csymbol><ci id="S2.p6.2.m2.1.1.2.cmml" xref="S2.p6.2.m2.1.1.2">𝑔</ci><ci id="S2.p6.2.m2.1.1.3a.cmml" xref="S2.p6.2.m2.1.1.3"><mtext id="S2.p6.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.p6.2.m2.1.1.3">neg</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m2.1c">g_{\text{neg}}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.2.m2.1d">italic_g start_POSTSUBSCRIPT neg end_POSTSUBSCRIPT</annotation></semantics></math>), the loss increases when the model incorrectly classifies them as positive. The loss function is defined as <math alttext="\text{loss}=\left(\log(1+e^{-g_{\text{pos}}})+\log(1+e^{g_{\text{neg}}})\right%
)/2" class="ltx_Math" display="inline" id="S2.p6.3.m3.3"><semantics id="S2.p6.3.m3.3a"><mrow id="S2.p6.3.m3.3.3" xref="S2.p6.3.m3.3.3.cmml"><mtext id="S2.p6.3.m3.3.3.3" xref="S2.p6.3.m3.3.3.3a.cmml">loss</mtext><mo id="S2.p6.3.m3.3.3.2" xref="S2.p6.3.m3.3.3.2.cmml">=</mo><mrow id="S2.p6.3.m3.3.3.1" xref="S2.p6.3.m3.3.3.1.cmml"><mrow id="S2.p6.3.m3.3.3.1.1.1" xref="S2.p6.3.m3.3.3.1.1.1.1.cmml"><mo id="S2.p6.3.m3.3.3.1.1.1.2" xref="S2.p6.3.m3.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.p6.3.m3.3.3.1.1.1.1" xref="S2.p6.3.m3.3.3.1.1.1.1.cmml"><mrow id="S2.p6.3.m3.3.3.1.1.1.1.1.1" xref="S2.p6.3.m3.3.3.1.1.1.1.1.2.cmml"><mi id="S2.p6.3.m3.1.1" xref="S2.p6.3.m3.1.1.cmml">log</mi><mo id="S2.p6.3.m3.3.3.1.1.1.1.1.1a" xref="S2.p6.3.m3.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1" xref="S2.p6.3.m3.3.3.1.1.1.1.1.2.cmml"><mo id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.p6.3.m3.3.3.1.1.1.1.1.2.cmml">(</mo><mrow id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.cmml"><mn id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.cmml">+</mo><msup id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.2" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.2.cmml">e</mi><mrow id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.cmml"><mo id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3a" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.cmml">−</mo><msub id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml"><mi id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.2" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.2.cmml">g</mi><mtext id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.3" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.3a.cmml">pos</mtext></msub></mrow></msup></mrow><mo id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.p6.3.m3.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.p6.3.m3.3.3.1.1.1.1.3" xref="S2.p6.3.m3.3.3.1.1.1.1.3.cmml">+</mo><mrow id="S2.p6.3.m3.3.3.1.1.1.1.2.1" xref="S2.p6.3.m3.3.3.1.1.1.1.2.2.cmml"><mi id="S2.p6.3.m3.2.2" xref="S2.p6.3.m3.2.2.cmml">log</mi><mo id="S2.p6.3.m3.3.3.1.1.1.1.2.1a" xref="S2.p6.3.m3.3.3.1.1.1.1.2.2.cmml">⁡</mo><mrow id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1" xref="S2.p6.3.m3.3.3.1.1.1.1.2.2.cmml"><mo id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.p6.3.m3.3.3.1.1.1.1.2.2.cmml">(</mo><mrow id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.cmml"><mn id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.2" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.2.cmml">1</mn><mo id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.1" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.1.cmml">+</mo><msup id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.cmml"><mi id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.2" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.2.cmml">e</mi><msub id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.cmml"><mi id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.2" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.2.cmml">g</mi><mtext id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.3" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.3a.cmml">neg</mtext></msub></msup></mrow><mo id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.3" stretchy="false" xref="S2.p6.3.m3.3.3.1.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.p6.3.m3.3.3.1.1.1.3" xref="S2.p6.3.m3.3.3.1.1.1.1.cmml">)</mo></mrow><mo id="S2.p6.3.m3.3.3.1.2" xref="S2.p6.3.m3.3.3.1.2.cmml">/</mo><mn id="S2.p6.3.m3.3.3.1.3" xref="S2.p6.3.m3.3.3.1.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.3.m3.3b"><apply id="S2.p6.3.m3.3.3.cmml" xref="S2.p6.3.m3.3.3"><eq id="S2.p6.3.m3.3.3.2.cmml" xref="S2.p6.3.m3.3.3.2"></eq><ci id="S2.p6.3.m3.3.3.3a.cmml" xref="S2.p6.3.m3.3.3.3"><mtext id="S2.p6.3.m3.3.3.3.cmml" xref="S2.p6.3.m3.3.3.3">loss</mtext></ci><apply id="S2.p6.3.m3.3.3.1.cmml" xref="S2.p6.3.m3.3.3.1"><divide id="S2.p6.3.m3.3.3.1.2.cmml" xref="S2.p6.3.m3.3.3.1.2"></divide><apply id="S2.p6.3.m3.3.3.1.1.1.1.cmml" xref="S2.p6.3.m3.3.3.1.1.1"><plus id="S2.p6.3.m3.3.3.1.1.1.1.3.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.3"></plus><apply id="S2.p6.3.m3.3.3.1.1.1.1.1.2.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1"><log id="S2.p6.3.m3.1.1.cmml" xref="S2.p6.3.m3.1.1"></log><apply id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1"><plus id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.1"></plus><cn id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.2">1</cn><apply id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3">superscript</csymbol><ci id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.2">𝑒</ci><apply id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3"><minus id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3"></minus><apply id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.1.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.2.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.2">𝑔</ci><ci id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.3a.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.3"><mtext id="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.3.cmml" mathsize="50%" xref="S2.p6.3.m3.3.3.1.1.1.1.1.1.1.1.3.3.2.3">pos</mtext></ci></apply></apply></apply></apply></apply><apply id="S2.p6.3.m3.3.3.1.1.1.1.2.2.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1"><log id="S2.p6.3.m3.2.2.cmml" xref="S2.p6.3.m3.2.2"></log><apply id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1"><plus id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.1.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.1"></plus><cn id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.2.cmml" type="integer" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.2">1</cn><apply id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.1.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3">superscript</csymbol><ci id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.2.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.2">𝑒</ci><apply id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.1.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3">subscript</csymbol><ci id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.2.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.2">𝑔</ci><ci id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.3a.cmml" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.3"><mtext id="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.3.cmml" mathsize="50%" xref="S2.p6.3.m3.3.3.1.1.1.1.2.1.1.1.3.3.3">neg</mtext></ci></apply></apply></apply></apply></apply><cn id="S2.p6.3.m3.3.3.1.3.cmml" type="integer" xref="S2.p6.3.m3.3.3.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.3.m3.3c">\text{loss}=\left(\log(1+e^{-g_{\text{pos}}})+\log(1+e^{g_{\text{neg}}})\right%
)/2</annotation><annotation encoding="application/x-llamapun" id="S2.p6.3.m3.3d">loss = ( roman_log ( 1 + italic_e start_POSTSUPERSCRIPT - italic_g start_POSTSUBSCRIPT pos end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) + roman_log ( 1 + italic_e start_POSTSUPERSCRIPT italic_g start_POSTSUBSCRIPT neg end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ) ) / 2</annotation></semantics></math>, which combines the penalties for both types of errors in a manner that encourages the model to correctly classify both positive and negative samples with high confidence. Through backpropagation, the algorithm updates the model’s weights based on the computed gradients, progressively reducing the classification error and enhancing the model’s accuracy over time.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Methodology</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.4.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.5.2">Accuracy Differential Saliency (ADS) Technique</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">In the context of saliency analysis, we employ an alternative approach due to the inherent limitations of the forward propagation algorithm, notably its lack of backpropagation as found in conventional neural networks. Our method focuses on quantifying the influence of individual pixels on the model’s performance by systematically nullifying their contribution. This is achieved by applying a filter to the image, which iteratively moves across the entire image. For each position of the filter, pixels within its scope are set to zero, effectively removing their influence. Subsequently, we assess the model’s accuracy without the contribution of these pixels. This process is repeated for every pixel position, with the pixel under the filter’s center being the subject of analysis each time. By comparing the model’s accuracy with and without the influence of each pixel, we derive a differential accuracy for each pixel. The aggregation of these differential accuracies forms a difference matrix, which serves as a visual representation of the impact each pixel has on the model’s overall accuracy. This difference matrix thus provides insightful data on the saliency within the image, highlighting regions of particular importance to the model’s decision-making process. figure <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#S3.F2" title="Figure 2 ‣ III-A Accuracy Differential Saliency (ADS) Technique ‣ III Methodology ‣ Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_tag">2</span></a>
shows the ADS Method.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="486" id="S3.F2.g1" src="extracted/5861477/matrix.jpg" width="604"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Plotting the loss for each layer in the forward-forward algorithm, where each layer learns independently, starting with the first layer, then proceeding to the second</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Experiments and Results</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we assess the performance of our method on the MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib29" title="">29</a>]</cite> and Fashion-MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#bib.bib26" title="">26</a>]</cite> datasets. Both datasets consist of images with dimensions of <math alttext="28\times 28" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><mrow id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml"><mn id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">28</mn><mo id="S4.p1.1.m1.1.1.1" lspace="0.222em" rspace="0.222em" xref="S4.p1.1.m1.1.1.1.cmml">×</mo><mn id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">28</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1"><times id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1"></times><cn id="S4.p1.1.m1.1.1.2.cmml" type="integer" xref="S4.p1.1.m1.1.1.2">28</cn><cn id="S4.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.p1.1.m1.1.1.3">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">28\times 28</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">28 × 28</annotation></semantics></math> pixels. These images were converted into a flattened format to form an input layer with 784 units.
All computational experiments were performed using an NVIDIA T4 GPU, equipped with 2,560 CUDA cores, 320 Tensor cores, and 16 GB of GDDR6 memory.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Architecture</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">We conducted several experiments to showcase the forward-forward algorithm in image classification. We used two linear layers for the MLP architecture with a hidden layer size of 500. The MLP model was trained for 5,000 epochs.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#Sx1.F3" title="Figure 3 ‣ Architecture ‣ Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the loss associated with each layer. In the forward-forward algorithm, each layer learns independently, starting with the first layer and proceeding sequentially through the others.</p>
</div>
<figure class="ltx_figure" id="Sx1.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="206" id="Sx1.F3.g1" src="extracted/5861477/losss.png" width="604"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Plotting the loss for each layer in the forward-forward algorithm, where each layer learns independently, starting with the first layer, then proceeding to the second</figcaption>
</figure>
<div class="ltx_para" id="Sx1.p2">
<p class="ltx_p" id="Sx1.p2.1">For our new technique, titled ”The Accuracy Differential Saliency (ADS) Technique,” we applied it to the MNIST dataset to assess the impact of individual pixels on model accuracy. This was achieved by systematically nullifying them using a moving filter. The technique creates a differential matrix that contrasts the model’s performance with and without the contribution of each pixel, thereby identifying critical regions that influence decision-making. The outcomes are illustrated by overlaying this matrix onto the image. Figures <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#Sx1.F4" title="Figure 4 ‣ Architecture ‣ Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_tag">4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.15365v1#Sx1.F5" title="Figure 5 ‣ Architecture ‣ Novel Saliency Analysis for the Forward-Forward Algorithm"><span class="ltx_text ltx_ref_tag">5</span></a> display these results for the MNIST and Fashion MNIST datasets.</p>
</div>
<figure class="ltx_figure" id="Sx1.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="338" id="Sx1.F4.g1" src="extracted/5861477/mnist.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span> The Accuracy Differential Saliency (ADS) Technique, applied to the MNIST dataset, evaluates the impact of individual pixels on model accuracy by zeroing them out with a moving filter. This process generates a difference matrix by comparing the model’s performance with and without each pixel’s contribution, highlighting key areas affecting decision-making. The results are visualized by plotting this matrix over the image.</figcaption>
</figure>
<figure class="ltx_figure" id="Sx1.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="338" id="Sx1.F5.g1" src="extracted/5861477/fashio.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span> The Accuracy Differential Saliency (ADS) Technique, applied to the Fashion MNIST dataset, evaluates the impact of individual pixels on model accuracy by zeroing them out with a moving filter.</figcaption>
</figure>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Conclusion</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Our study demonstrates the efficacy of the Forward-Forward algorithm in neural network training, marking a significant departure from traditional backpropagation methods. By integrating a specialized saliency algorithm tailored for this non-backpropagation approach, we enhance the interpretability of neural networks, offering a more intuitive understanding of feature importance and decision-making processes. Our evaluations using the MNIST and Fashion MNIST datasets show that this method not only performs on par with traditional multi-layer perceptron (MLP) architectures but also simplifies the training process. This approach opens new avenues for the development of efficient and interpretable training methods, setting a promising direction for future research in deep learning advancements that cater to both spatial and temporal data complexities.
<br class="ltx_break"/></p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">Mnih, V., Kavukcuoglu, K., Silver, D., Rusu, A., Veness, J., Bellemare, M., Graves, A., Riedmiller, M., Fidjeland, A., Ostrovski, G. &amp; Others Human-level control through deep reinforcement learning. <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">Nature</span>. <span class="ltx_text ltx_font_bold" id="bib.bib1.2.2">518</span>, 529-533 (2015)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">Young, T., Hazarika, D., Poria, S. &amp; Cambria, E. Recent trends in deep learning based natural language processing. <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Ieee Computational IntelligenCe Magazine</span>. <span class="ltx_text ltx_font_bold" id="bib.bib2.2.2">13</span>, 55-75 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">LeCun, Y., Bengio, Y. &amp; Hinton, G. Deep learning. <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Nature</span>. <span class="ltx_text ltx_font_bold" id="bib.bib3.2.2">521</span>, 436-444 (2015)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">Sejnowski, T. The unreasonable effectiveness of deep learning in artificial intelligence. <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">Proceedings Of The National Academy Of Sciences</span>. <span class="ltx_text ltx_font_bold" id="bib.bib4.2.2">117</span>, 30033-30038 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">Hinton, G. The forward-forward algorithm: Some preliminary investigations. <span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">ArXiv Preprint ArXiv:2212.13345</span>. (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">Caruana, R., Lou, Y., Gehrke, J., Koch, P., Sturm, M. &amp; Elhadad, N. Intelligible models for healthcare: Predicting pneumonia risk and hospital 30-day readmission. <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Proceedings Of The 21th ACM SIGKDD International Conference On Knowledge Discovery And Data Mining</span>. pp. 1721-1730 (2015)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">Li, K., Wu, Z., Peng, K., Ernst, J. &amp; Fu, Y. Tell me where to look: Guided attention inference network. <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">Proceedings Of The IEEE Conference On Computer Vision And Pattern Recognition</span>. pp. 9215-9223 (2018)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">Chen, N., Zhou, M., Dong, X., Qu, J., Gong, F., Han, Y., Qiu, Y., Wang, J., Liu, Y., Wei, Y. &amp; Others Epidemiological and clinical characteristics of 99 cases of 2019 novel coronavirus pneumonia in Wuhan, China: a descriptive study. <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">The Lancet</span>. <span class="ltx_text ltx_font_bold" id="bib.bib8.2.2">395</span>, 507-513 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">Lillicrap, T., Cownden, D., Tweed, D. &amp; Akerman, C. Random synaptic feedback weights support error backpropagation for deep learning. <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Nature Communications</span>. <span class="ltx_text ltx_font_bold" id="bib.bib9.2.2">7</span>, 13276 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">Nøkland, A. Direct feedback alignment provides learning in deep neural networks. <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Advances In Neural Information Processing Systems</span>. <span class="ltx_text ltx_font_bold" id="bib.bib10.2.2">29</span> (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">Marblestone, A., Wayne, G. &amp; Kording, K. Toward an integration of deep learning and neuroscience. <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">Frontiers In Computational Neuroscience</span>. <span class="ltx_text ltx_font_bold" id="bib.bib11.2.2">10</span> pp. 94 (2016)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">Friston, K. The free-energy principle: a unified brain theory?. <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Nature Reviews Neuroscience</span>. <span class="ltx_text ltx_font_bold" id="bib.bib12.2.2">11</span>, 127-138 (2010)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">Smilkov, D., Thorat, N., Kim, B., Viégas, F. &amp; Wattenberg, M. Smoothgrad: removing noise by adding noise. <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">ArXiv Preprint ArXiv:1706.03825</span>. (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">Selvaraju, R., Cogswell, M., Das, A., Vedantam, R., Parikh, D. &amp; Batra, D. Grad-cam: Visual explanations from deep networks via gradient-based localization. <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">Proceedings Of The IEEE International Conference On Computer Vision</span>. pp. 618-626 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">Shrikumar, A., Greenside, P. &amp; Kundaje, A. Learning important features through propagating activation differences. <span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">International Conference On Machine Learning</span>. pp. 3145-3153 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">Ancona, M., Ceolini, E., Öztireli, C. &amp; Gross, M. Towards better understanding of gradient-based attribution methods for deep neural networks. <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">ArXiv Preprint ArXiv:1711.06104</span>. (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">Ghiasi, M., Moezzi, M. &amp; Kashi, A. A Simple Low Phase Noise Class-F LC Oscillator. <span class="ltx_text ltx_font_italic" id="bib.bib17.1.1">Circuits, Systems, And Signal Processing</span>. <span class="ltx_text ltx_font_bold" id="bib.bib17.2.2">41</span>, 3041-3049 (2022)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">Frosst, N. &amp; Hinton, G. Distilling a neural network into a soft decision tree. <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">ArXiv Preprint ArXiv:1711.09784</span>. (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">Karkehabadi, A., Bakhshi, M. &amp; Razavian, S. Optimizing Underwater IoT Routing with Multi-Criteria Decision Making and Uncertainty Weights. <span class="ltx_text ltx_font_italic" id="bib.bib19.1.1">ArXiv Preprint ArXiv:2405.11513</span>. (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">Jabri, M. &amp; Flower, B. Weight perturbation: An optimal architecture and learning technique for analog VLSI feedforward and recurrent multilayer networks. <span class="ltx_text ltx_font_italic" id="bib.bib20.1.1">IEEE Transactions On Neural Networks</span>. <span class="ltx_text ltx_font_bold" id="bib.bib20.2.2">3</span>, 154-157 (1992)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">Karkehabadi, A., Latibari, B., Homayoun, H. &amp; Sasan, A. HLGM: A Novel Methodology For Improving Model Accuracy Using Saliency-Guided High and Low Gradient Masking. <span class="ltx_text ltx_font_italic" id="bib.bib21.1.1">The 14th International Conference On Information Science And Technology</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">Hassanpour, J., Srivastav, V., Mutter, D. &amp; Padoy, N. Overcoming Dimensional Collapse in Self-supervised Contrastive Learning for Medical Image Segmentation. <span class="ltx_text ltx_font_italic" id="bib.bib22.1.1">ArXiv Preprint ArXiv:2402.14611</span>. (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">Hinton, G. &amp; Others Learning distributed representations of concepts. <span class="ltx_text ltx_font_italic" id="bib.bib23.1.1">Proceedings Of The Eighth Annual Conference Of The Cognitive Science Society</span>. <span class="ltx_text ltx_font_bold" id="bib.bib23.2.2">1</span> pp. 12 (1986)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">Gutmann, M. &amp; Hyvärinen, A. Noise-contrastive estimation: A new estimation principle for unnormalized statistical models. <span class="ltx_text ltx_font_italic" id="bib.bib24.1.1">Proceedings Of The Thirteenth International Conference On Artificial Intelligence And Statistics</span>. pp. 297-304 (2010)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">Karkehabadi, A., Homayoun, H. &amp; Sasan, A. SMOOT: Saliency guided mask optimized online training. <span class="ltx_text ltx_font_italic" id="bib.bib25.1.1">2024 IEEE 17th Dallas Circuits And Systems Conference (DCAS)</span>. pp. 1-6 (2024)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">Xiao, H., Rasul, K. &amp; Vollgraf, R. Fashion-mnist: a novel image dataset for benchmarking machine learning algorithms. <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">ArXiv Preprint ArXiv:1708.07747</span>. (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">Lillicrap, T., Santoro, A., Marris, L., Akerman, C. &amp; Hinton, G. Backpropagation and the brain. <span class="ltx_text ltx_font_italic" id="bib.bib27.1.1">Nature Reviews Neuroscience</span>. <span class="ltx_text ltx_font_bold" id="bib.bib27.2.2">21</span>, 335-346 (2020)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">Guerguiev, J., Lillicrap, T. &amp; Richards, B. Towards deep learning with segregated dendrites. <span class="ltx_text ltx_font_italic" id="bib.bib28.1.1">Elife</span>. <span class="ltx_text ltx_font_bold" id="bib.bib28.2.2">6</span> pp. e22901 (2017)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">LeCun, Y. The MNIST database of handwritten digits. <span class="ltx_text ltx_font_italic" id="bib.bib29.1.1">Http://yann. Lecun. Com/exdb/mnist/</span>. (1998)

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">Rumelhart, D., Hinton, G. &amp; Williams, R. Learning representations by back-propagating errors. <span class="ltx_text ltx_font_italic" id="bib.bib30.1.1">Nature</span>. <span class="ltx_text ltx_font_bold" id="bib.bib30.2.2">323</span>, 533-536 (1986)

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 18 17:08:01 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
