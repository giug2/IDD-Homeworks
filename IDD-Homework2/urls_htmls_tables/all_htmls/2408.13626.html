<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2408.13626] Towards Case-based Interpretability for Medical Federated Learning</title><meta property="og:description" content="We explore deep generative models to generate case-based explanations in a medical federated learning setting. Explaining AI model decisions through case-based interpretability is paramount to increasing trust and allo…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Towards Case-based Interpretability for Medical Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Towards Case-based Interpretability for Medical Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2408.13626">

<!--Generated on Thu Sep  5 13:27:19 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_font_bold ltx_title_document" style="font-size:173%;">Towards Case-based Interpretability for Medical Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Laura Latorre<sup id="id11.11.id1" class="ltx_sup"><span id="id11.11.id1.1" class="ltx_text ltx_font_italic">1,2</span></sup>, Liliana Petrychenko<sup id="id12.12.id2" class="ltx_sup"><span id="id12.12.id2.1" class="ltx_text ltx_font_italic">1,3</span></sup>, Regina Beets-Tan<sup id="id13.13.id3" class="ltx_sup"><span id="id13.13.id3.1" class="ltx_text ltx_font_italic">1,3</span></sup>, Taisiya Kopytova<sup id="id14.14.id4" class="ltx_sup"><span id="id14.14.id4.1" class="ltx_text ltx_font_italic">1</span></sup>, and Wilson Silva<sup id="id15.15.id5" class="ltx_sup"><span id="id15.15.id5.1" class="ltx_text ltx_font_italic">1,4,5</span></sup>
</span><span class="ltx_author_notes"><sup id="id16.16.id1" class="ltx_sup"><span id="id16.16.id1.1" class="ltx_text ltx_font_italic">1</span></sup> Department of Radiology, The Netherlands Cancer Institute, Amsterdam, The Netherlands<sup id="id17.17.id1" class="ltx_sup"><span id="id17.17.id1.1" class="ltx_text ltx_font_italic">2</span></sup> Vrije Universiteit Amsterdam, Amsterdam, The Netherlands<sup id="id18.18.id1" class="ltx_sup"><span id="id18.18.id1.1" class="ltx_text ltx_font_italic">3</span></sup> GROW School for Oncology and Developmental Biology, Maastricht University Medical Center, Maastricht, The Netherlands<sup id="id19.19.id1" class="ltx_sup"><span id="id19.19.id1.1" class="ltx_text ltx_font_italic">4</span></sup> AI Technology for Life, Department of Information and Computing Sciences, Department of Biology, Utrecht University, Utrecht, The Netherlands<sup id="id20.20.id1" class="ltx_sup"><span id="id20.20.id1.1" class="ltx_text ltx_font_italic">5</span></sup> Centre for Telecommunications and Multimedia, INESC TEC, Porto, Portugal</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id21.id1" class="ltx_p">We explore deep generative models to generate case-based explanations in a medical federated learning setting. Explaining AI model decisions through case-based interpretability is paramount to increasing trust and allowing widespread adoption of AI in clinical practice. However, medical AI training paradigms are shifting towards federated learning settings in order to comply with data protection regulations. In a federated scenario, past data is inaccessible to the current user. Thus, we use a deep generative model to generate synthetic examples that protect privacy and explain decisions. Our proof-of-concept focuses on pleural effusion diagnosis and uses publicly available Chest X-ray data.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">INTRODUCTION</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Case-based interpretability is vital in explaining medical Artificial Intelligence (AI) model decisions. Generating explanations for AI model decisions is paramount to increasing trust and allowing widespread adoption in clinical practice <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. We can find several approaches to producing explanations in the scientific literature, from saliency maps (highlighting image pixels driving the decision) to textual explanations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. However, in the context of radiology, case-based interpretability arises as a very natural interpretability strategy since it mimics the way radiologists would also explain or come up with a decision <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. When in doubt over a suspected disease condition, radiologists usually turn their attention to searching past cases and, based on disease-similarity to these past cases, reach a clinical decision. Looking for adequate past cases is a time-consuming process that can be automated through the use of an AI retrieval model. AI retrieval models usually consist of finding a latent semantic representation of the original data (i.e., images) that is representative and adequate to measure the distance between cases and then evaluate disease similarity. All this process, though, starts from the premise that past data (which might have been used for training) is always available to the retrieval algorithm.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Due to privacy concerns and regulations, sharing medical data is sometimes prohibitive, leading to a lack of heterogeneous training data and, consequently, to non-robust AI models that fail to generalize. It has been shown that even radiological images such as chest X-rays may contain biometric information that can be exploited by deep learning models to expose identity, therefore, infringing on data protection regulations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. In order to overcome this limitation in data sharing, researchers have come up with federated learning approaches, which leverage all available data without the need to share it between institutions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. This process works by distributing the model training to the institutional data owners and aggregating their results. Due to the privacy by default property of federated learning, it is conquering the fields of medical imaging and drug discovery <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Even though federated learning’s potential to overcome some of the current AI flaws is currently widely recognized, it also introduces new challenges. The decentralized nature of federated learning guarantees compliance with privacy regulations but, at the same time, inhibits data access and inspection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. Non-accessible data means that identifying bugs or detecting biases is impossible following conventional approaches. The same is true for case-based explainability. Since representative past cases may not be accessible for retrieval, as they might be stored in a different site, the whole concept of case-based interpretability loses its relevance, with consequences in the trust and understanding of AI classification model decisions. Moreover, the case-based interpretability role can be more extensive than just explaining decisions by also working as a computer-aided diagnosis. In this work, we propose a proof-of-concept based on deep generative models to generate synthetic case-based explanations to be used in a medical federated learning setting.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">MATERIALS AND METHODS</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">Data</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Posterior-anterior (PA) chest radiographs from four large and publicly available databases (CheXpert <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, MIMIC-CXR-JPG <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, BRAX <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, and VinDr-CXR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>) were used. Since pleural effusion was present in all of the considered datasets, being one of the conditions with a more balanced distribution, it was chosen as the diagosis to perform and explain in our proof-of-concept. From each dataset, we only selected images labelled as having pleural effusion or not having pleural effusion, discarding all uncertain diagnoses. Based on the available data, we created an in-distribution test set (composed of 20% of data from each of the local datasets: CheXpert, BRAX, and VinDr-CXR) and an out-of-distribution test set (composed of MIMIC-CXR-JPG data). In the federated learning setting, each dataset works as an independent hospital, i.e., as a local client.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Method</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Our proposed methodology to obtain case-based explanations for federated learning models is presented in Fig. <a href="#S2.F1" title="Figure 1 ‣ II-B Method ‣ II MATERIALS AND METHODS ‣ Towards Case-based Interpretability for Medical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. The first step requires training a privacy-preserving discriminative federated model used for diagnosis (in our case, pleural effusion prediction). The local discriminative models, and thus, the global model used, were based on the DenseNet-121 architecture <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. The global model is initialized with ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> pre-trained weights. In each round of the federated learning process, the central server distributes the current global model to the participating client devices (i.e., local sites corresponding to CheXpert, VinDR, and BRAX). Each client then independently trains the model using its local dataset. After each local training round, the global model is updated using federated averaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Differential privacy (DP) was implemented locally by using differential privacy optimizers (gradient noise injection techniques): DP-SGD and DP-Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. By clipping and adding noise to the local client gradients, we avoid the risk of information leakage. The pseudo-code describing the training process in detail is presented in Algorithm 1. Our final model was first trained for 20 global epochs with frozen weights, updating just the last layer. Afterwards, the entire model was fine-tuned for 20 global epochs more. We considered 3 epochs for the local training process. Class weights corresponding to the inverse of the class frequency are used at each local site to mitigate the impact of class imbalance.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.13.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.14.2" class="ltx_text ltx_font_typewriter">Federated Averaging</span>. The <math id="alg1.6.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.6.m1.1b"><mi id="alg1.6.m1.1.1" xref="alg1.6.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.6.m1.1c"><ci id="alg1.6.m1.1.1.cmml" xref="alg1.6.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m1.1d">K</annotation></semantics></math> clients are
indexed by <math id="alg1.7.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.7.m2.1b"><mi id="alg1.7.m2.1.1" xref="alg1.7.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.7.m2.1c"><ci id="alg1.7.m2.1.1.cmml" xref="alg1.7.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.7.m2.1d">k</annotation></semantics></math>; <math id="alg1.8.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.8.m3.1b"><mi id="alg1.8.m3.1.1" xref="alg1.8.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.8.m3.1c"><ci id="alg1.8.m3.1.1.cmml" xref="alg1.8.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.8.m3.1d">B</annotation></semantics></math> is the local minibatch size, <math id="alg1.9.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.9.m4.1b"><mi id="alg1.9.m4.1.1" xref="alg1.9.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.9.m4.1c"><ci id="alg1.9.m4.1.1.cmml" xref="alg1.9.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.9.m4.1d">E</annotation></semantics></math> is the number
of local epochs, and <math id="alg1.10.m5.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.10.m5.1b"><mi id="alg1.10.m5.1.1" xref="alg1.10.m5.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.10.m5.1c"><ci id="alg1.10.m5.1.1.cmml" xref="alg1.10.m5.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m5.1d">\eta</annotation></semantics></math> is the learning rate.</figcaption>
<div id="alg1.15" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span id="alg1.l1.1" class="ltx_text ltx_font_bold">Data:</span> <math id="alg1.l1.m1.4" class="ltx_Math" alttext="(D_{1},z_{1}),(D_{2},z_{2}),...,(D_{k},z_{k})" display="inline"><semantics id="alg1.l1.m1.4a"><mrow id="alg1.l1.m1.4.4.3" xref="alg1.l1.m1.4.4.4.cmml"><mrow id="alg1.l1.m1.2.2.1.1.2" xref="alg1.l1.m1.2.2.1.1.3.cmml"><mo stretchy="false" id="alg1.l1.m1.2.2.1.1.2.3" xref="alg1.l1.m1.2.2.1.1.3.cmml">(</mo><msub id="alg1.l1.m1.2.2.1.1.1.1" xref="alg1.l1.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l1.m1.2.2.1.1.1.1.2" xref="alg1.l1.m1.2.2.1.1.1.1.2.cmml">D</mi><mn id="alg1.l1.m1.2.2.1.1.1.1.3" xref="alg1.l1.m1.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="alg1.l1.m1.2.2.1.1.2.4" xref="alg1.l1.m1.2.2.1.1.3.cmml">,</mo><msub id="alg1.l1.m1.2.2.1.1.2.2" xref="alg1.l1.m1.2.2.1.1.2.2.cmml"><mi id="alg1.l1.m1.2.2.1.1.2.2.2" xref="alg1.l1.m1.2.2.1.1.2.2.2.cmml">z</mi><mn id="alg1.l1.m1.2.2.1.1.2.2.3" xref="alg1.l1.m1.2.2.1.1.2.2.3.cmml">1</mn></msub><mo stretchy="false" id="alg1.l1.m1.2.2.1.1.2.5" xref="alg1.l1.m1.2.2.1.1.3.cmml">)</mo></mrow><mo id="alg1.l1.m1.4.4.3.4" xref="alg1.l1.m1.4.4.4.cmml">,</mo><mrow id="alg1.l1.m1.3.3.2.2.2" xref="alg1.l1.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="alg1.l1.m1.3.3.2.2.2.3" xref="alg1.l1.m1.3.3.2.2.3.cmml">(</mo><msub id="alg1.l1.m1.3.3.2.2.1.1" xref="alg1.l1.m1.3.3.2.2.1.1.cmml"><mi id="alg1.l1.m1.3.3.2.2.1.1.2" xref="alg1.l1.m1.3.3.2.2.1.1.2.cmml">D</mi><mn id="alg1.l1.m1.3.3.2.2.1.1.3" xref="alg1.l1.m1.3.3.2.2.1.1.3.cmml">2</mn></msub><mo id="alg1.l1.m1.3.3.2.2.2.4" xref="alg1.l1.m1.3.3.2.2.3.cmml">,</mo><msub id="alg1.l1.m1.3.3.2.2.2.2" xref="alg1.l1.m1.3.3.2.2.2.2.cmml"><mi id="alg1.l1.m1.3.3.2.2.2.2.2" xref="alg1.l1.m1.3.3.2.2.2.2.2.cmml">z</mi><mn id="alg1.l1.m1.3.3.2.2.2.2.3" xref="alg1.l1.m1.3.3.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="alg1.l1.m1.3.3.2.2.2.5" xref="alg1.l1.m1.3.3.2.2.3.cmml">)</mo></mrow><mo id="alg1.l1.m1.4.4.3.5" xref="alg1.l1.m1.4.4.4.cmml">,</mo><mi mathvariant="normal" id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">…</mi><mo id="alg1.l1.m1.4.4.3.6" xref="alg1.l1.m1.4.4.4.cmml">,</mo><mrow id="alg1.l1.m1.4.4.3.3.2" xref="alg1.l1.m1.4.4.3.3.3.cmml"><mo stretchy="false" id="alg1.l1.m1.4.4.3.3.2.3" xref="alg1.l1.m1.4.4.3.3.3.cmml">(</mo><msub id="alg1.l1.m1.4.4.3.3.1.1" xref="alg1.l1.m1.4.4.3.3.1.1.cmml"><mi id="alg1.l1.m1.4.4.3.3.1.1.2" xref="alg1.l1.m1.4.4.3.3.1.1.2.cmml">D</mi><mi id="alg1.l1.m1.4.4.3.3.1.1.3" xref="alg1.l1.m1.4.4.3.3.1.1.3.cmml">k</mi></msub><mo id="alg1.l1.m1.4.4.3.3.2.4" xref="alg1.l1.m1.4.4.3.3.3.cmml">,</mo><msub id="alg1.l1.m1.4.4.3.3.2.2" xref="alg1.l1.m1.4.4.3.3.2.2.cmml"><mi id="alg1.l1.m1.4.4.3.3.2.2.2" xref="alg1.l1.m1.4.4.3.3.2.2.2.cmml">z</mi><mi id="alg1.l1.m1.4.4.3.3.2.2.3" xref="alg1.l1.m1.4.4.3.3.2.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l1.m1.4.4.3.3.2.5" xref="alg1.l1.m1.4.4.3.3.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.4b"><list id="alg1.l1.m1.4.4.4.cmml" xref="alg1.l1.m1.4.4.3"><interval closure="open" id="alg1.l1.m1.2.2.1.1.3.cmml" xref="alg1.l1.m1.2.2.1.1.2"><apply id="alg1.l1.m1.2.2.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l1.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.2">𝐷</ci><cn type="integer" id="alg1.l1.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l1.m1.2.2.1.1.1.1.3">1</cn></apply><apply id="alg1.l1.m1.2.2.1.1.2.2.cmml" xref="alg1.l1.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.2.2.1.1.2.2.1.cmml" xref="alg1.l1.m1.2.2.1.1.2.2">subscript</csymbol><ci id="alg1.l1.m1.2.2.1.1.2.2.2.cmml" xref="alg1.l1.m1.2.2.1.1.2.2.2">𝑧</ci><cn type="integer" id="alg1.l1.m1.2.2.1.1.2.2.3.cmml" xref="alg1.l1.m1.2.2.1.1.2.2.3">1</cn></apply></interval><interval closure="open" id="alg1.l1.m1.3.3.2.2.3.cmml" xref="alg1.l1.m1.3.3.2.2.2"><apply id="alg1.l1.m1.3.3.2.2.1.1.cmml" xref="alg1.l1.m1.3.3.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.2.2.1.1.1.cmml" xref="alg1.l1.m1.3.3.2.2.1.1">subscript</csymbol><ci id="alg1.l1.m1.3.3.2.2.1.1.2.cmml" xref="alg1.l1.m1.3.3.2.2.1.1.2">𝐷</ci><cn type="integer" id="alg1.l1.m1.3.3.2.2.1.1.3.cmml" xref="alg1.l1.m1.3.3.2.2.1.1.3">2</cn></apply><apply id="alg1.l1.m1.3.3.2.2.2.2.cmml" xref="alg1.l1.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.2.2.2.2.1.cmml" xref="alg1.l1.m1.3.3.2.2.2.2">subscript</csymbol><ci id="alg1.l1.m1.3.3.2.2.2.2.2.cmml" xref="alg1.l1.m1.3.3.2.2.2.2.2">𝑧</ci><cn type="integer" id="alg1.l1.m1.3.3.2.2.2.2.3.cmml" xref="alg1.l1.m1.3.3.2.2.2.2.3">2</cn></apply></interval><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">…</ci><interval closure="open" id="alg1.l1.m1.4.4.3.3.3.cmml" xref="alg1.l1.m1.4.4.3.3.2"><apply id="alg1.l1.m1.4.4.3.3.1.1.cmml" xref="alg1.l1.m1.4.4.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.4.4.3.3.1.1.1.cmml" xref="alg1.l1.m1.4.4.3.3.1.1">subscript</csymbol><ci id="alg1.l1.m1.4.4.3.3.1.1.2.cmml" xref="alg1.l1.m1.4.4.3.3.1.1.2">𝐷</ci><ci id="alg1.l1.m1.4.4.3.3.1.1.3.cmml" xref="alg1.l1.m1.4.4.3.3.1.1.3">𝑘</ci></apply><apply id="alg1.l1.m1.4.4.3.3.2.2.cmml" xref="alg1.l1.m1.4.4.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l1.m1.4.4.3.3.2.2.1.cmml" xref="alg1.l1.m1.4.4.3.3.2.2">subscript</csymbol><ci id="alg1.l1.m1.4.4.3.3.2.2.2.cmml" xref="alg1.l1.m1.4.4.3.3.2.2.2">𝑧</ci><ci id="alg1.l1.m1.4.4.3.3.2.2.3.cmml" xref="alg1.l1.m1.4.4.3.3.2.2.3">𝑘</ci></apply></interval></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.4c">(D_{1},z_{1}),(D_{2},z_{2}),...,(D_{k},z_{k})</annotation></semantics></math>,

</div>
<div id="alg1.l2" class="ltx_listingline">   <math id="alg1.l2.m1.1" class="ltx_Math" alttext="z_{k}\leftarrow\frac{n_{k}}{\sum_{k}^{K}n_{k}}" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msub id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">z</mi><mi id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mfrac id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><msub id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml"><mi id="alg1.l2.m1.1.1.3.2.2" xref="alg1.l2.m1.1.1.3.2.2.cmml">n</mi><mi id="alg1.l2.m1.1.1.3.2.3" xref="alg1.l2.m1.1.1.3.2.3.cmml">k</mi></msub><mrow id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="alg1.l2.m1.1.1.3.3.1" xref="alg1.l2.m1.1.1.3.3.1.cmml"><msubsup id="alg1.l2.m1.1.1.3.3.1a" xref="alg1.l2.m1.1.1.3.3.1.cmml"><mo id="alg1.l2.m1.1.1.3.3.1.2.2" xref="alg1.l2.m1.1.1.3.3.1.2.2.cmml">∑</mo><mi id="alg1.l2.m1.1.1.3.3.1.2.3" xref="alg1.l2.m1.1.1.3.3.1.2.3.cmml">k</mi><mi id="alg1.l2.m1.1.1.3.3.1.3" xref="alg1.l2.m1.1.1.3.3.1.3.cmml">K</mi></msubsup></mstyle><msub id="alg1.l2.m1.1.1.3.3.2" xref="alg1.l2.m1.1.1.3.3.2.cmml"><mi id="alg1.l2.m1.1.1.3.3.2.2" xref="alg1.l2.m1.1.1.3.3.2.2.cmml">n</mi><mi id="alg1.l2.m1.1.1.3.3.2.3" xref="alg1.l2.m1.1.1.3.3.2.3.cmml">k</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝑧</ci><ci id="alg1.l2.m1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><divide id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3"></divide><apply id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.2.1.cmml" xref="alg1.l2.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.3.2.2.cmml" xref="alg1.l2.m1.1.1.3.2.2">𝑛</ci><ci id="alg1.l2.m1.1.1.3.2.3.cmml" xref="alg1.l2.m1.1.1.3.2.3">𝑘</ci></apply><apply id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3"><apply id="alg1.l2.m1.1.1.3.3.1.cmml" xref="alg1.l2.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.3.1.1.cmml" xref="alg1.l2.m1.1.1.3.3.1">superscript</csymbol><apply id="alg1.l2.m1.1.1.3.3.1.2.cmml" xref="alg1.l2.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.3.1.2.1.cmml" xref="alg1.l2.m1.1.1.3.3.1">subscript</csymbol><sum id="alg1.l2.m1.1.1.3.3.1.2.2.cmml" xref="alg1.l2.m1.1.1.3.3.1.2.2"></sum><ci id="alg1.l2.m1.1.1.3.3.1.2.3.cmml" xref="alg1.l2.m1.1.1.3.3.1.2.3">𝑘</ci></apply><ci id="alg1.l2.m1.1.1.3.3.1.3.cmml" xref="alg1.l2.m1.1.1.3.3.1.3">𝐾</ci></apply><apply id="alg1.l2.m1.1.1.3.3.2.cmml" xref="alg1.l2.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.3.2.1.cmml" xref="alg1.l2.m1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.3.3.2.2.cmml" xref="alg1.l2.m1.1.1.3.3.2.2">𝑛</ci><ci id="alg1.l2.m1.1.1.3.3.2.3.cmml" xref="alg1.l2.m1.1.1.3.3.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">z_{k}\leftarrow\frac{n_{k}}{\sum_{k}^{K}n_{k}}</annotation></semantics></math>: scaling factor; <math id="alg1.l2.m2.1" class="ltx_Math" alttext="n_{k}\leftarrow" display="inline"><semantics id="alg1.l2.m2.1a"><mrow id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><msub id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml"><mi id="alg1.l2.m2.1.1.2.2" xref="alg1.l2.m2.1.1.2.2.cmml">n</mi><mi id="alg1.l2.m2.1.1.2.3" xref="alg1.l2.m2.1.1.2.3.cmml">k</mi></msub><mo stretchy="false" id="alg1.l2.m2.1.1.1" xref="alg1.l2.m2.1.1.1.cmml">←</mo><mi id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><ci id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1.1">←</ci><apply id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.2.1.cmml" xref="alg1.l2.m2.1.1.2">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.2.cmml" xref="alg1.l2.m2.1.1.2.2">𝑛</ci><ci id="alg1.l2.m2.1.1.2.3.cmml" xref="alg1.l2.m2.1.1.2.3">𝑘</ci></apply><csymbol cd="latexml" id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">n_{k}\leftarrow</annotation></semantics></math> <span id="alg1.l2.1" class="ltx_text ltx_font_typewriter">len(<math id="alg1.l2.1.m1.1" class="ltx_Math" alttext="D_{k}" display="inline"><semantics id="alg1.l2.1.m1.1a"><msub id="alg1.l2.1.m1.1.1" xref="alg1.l2.1.m1.1.1.cmml"><mi id="alg1.l2.1.m1.1.1.2" xref="alg1.l2.1.m1.1.1.2.cmml">D</mi><mi id="alg1.l2.1.m1.1.1.3" xref="alg1.l2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.1.m1.1b"><apply id="alg1.l2.1.m1.1.1.cmml" xref="alg1.l2.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.1.m1.1.1.1.cmml" xref="alg1.l2.1.m1.1.1">subscript</csymbol><ci id="alg1.l2.1.m1.1.1.2.cmml" xref="alg1.l2.1.m1.1.1.2">𝐷</ci><ci id="alg1.l2.1.m1.1.1.3.cmml" xref="alg1.l2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.1.m1.1c">D_{k}</annotation></semantics></math>)</span>: number of instances in <math id="alg1.l2.m3.1" class="ltx_Math" alttext="D_{k}" display="inline"><semantics id="alg1.l2.m3.1a"><msub id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><mi id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml">D</mi><mi id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1">subscript</csymbol><ci id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2">𝐷</ci><ci id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">D_{k}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">Initialize global model <math id="alg1.l3.m1.1" class="ltx_Math" alttext="w_{0}" display="inline"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">w</mi><mn id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑤</ci><cn type="integer" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">w_{0}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span> each round <math id="alg1.l4.m1.4" class="ltx_Math" alttext="t=1,2,...,T" display="inline"><semantics id="alg1.l4.m1.4a"><mrow id="alg1.l4.m1.4.5" xref="alg1.l4.m1.4.5.cmml"><mi id="alg1.l4.m1.4.5.2" xref="alg1.l4.m1.4.5.2.cmml">t</mi><mo id="alg1.l4.m1.4.5.1" xref="alg1.l4.m1.4.5.1.cmml">=</mo><mrow id="alg1.l4.m1.4.5.3.2" xref="alg1.l4.m1.4.5.3.1.cmml"><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo id="alg1.l4.m1.4.5.3.2.1" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">2</mn><mo id="alg1.l4.m1.4.5.3.2.2" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">…</mi><mo id="alg1.l4.m1.4.5.3.2.3" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l4.m1.4.4" xref="alg1.l4.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.4b"><apply id="alg1.l4.m1.4.5.cmml" xref="alg1.l4.m1.4.5"><eq id="alg1.l4.m1.4.5.1.cmml" xref="alg1.l4.m1.4.5.1"></eq><ci id="alg1.l4.m1.4.5.2.cmml" xref="alg1.l4.m1.4.5.2">𝑡</ci><list id="alg1.l4.m1.4.5.3.1.cmml" xref="alg1.l4.m1.4.5.3.2"><cn type="integer" id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">1</cn><cn type="integer" id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">2</cn><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">…</ci><ci id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.4c">t=1,2,...,T</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">     <span id="alg1.l5.1" class="ltx_text ltx_font_bold">Local training process:</span>

</div>
<div id="alg1.l6" class="ltx_listingline">     <span id="alg1.l6.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l6.m1.4" class="ltx_Math" alttext="k=1,2,...,K" display="inline"><semantics id="alg1.l6.m1.4a"><mrow id="alg1.l6.m1.4.5" xref="alg1.l6.m1.4.5.cmml"><mi id="alg1.l6.m1.4.5.2" xref="alg1.l6.m1.4.5.2.cmml">k</mi><mo id="alg1.l6.m1.4.5.1" xref="alg1.l6.m1.4.5.1.cmml">=</mo><mrow id="alg1.l6.m1.4.5.3.2" xref="alg1.l6.m1.4.5.3.1.cmml"><mn id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">1</mn><mo id="alg1.l6.m1.4.5.3.2.1" xref="alg1.l6.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">2</mn><mo id="alg1.l6.m1.4.5.3.2.2" xref="alg1.l6.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l6.m1.3.3" xref="alg1.l6.m1.3.3.cmml">…</mi><mo id="alg1.l6.m1.4.5.3.2.3" xref="alg1.l6.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l6.m1.4.4" xref="alg1.l6.m1.4.4.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.4b"><apply id="alg1.l6.m1.4.5.cmml" xref="alg1.l6.m1.4.5"><eq id="alg1.l6.m1.4.5.1.cmml" xref="alg1.l6.m1.4.5.1"></eq><ci id="alg1.l6.m1.4.5.2.cmml" xref="alg1.l6.m1.4.5.2">𝑘</ci><list id="alg1.l6.m1.4.5.3.1.cmml" xref="alg1.l6.m1.4.5.3.2"><cn type="integer" id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">1</cn><cn type="integer" id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">2</cn><ci id="alg1.l6.m1.3.3.cmml" xref="alg1.l6.m1.3.3">…</ci><ci id="alg1.l6.m1.4.4.cmml" xref="alg1.l6.m1.4.4">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.4c">k=1,2,...,K</annotation></semantics></math> <span id="alg1.l6.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l7" class="ltx_listingline">         <math id="alg1.l7.m1.1" class="ltx_Math" alttext="w^{k}_{t}\leftarrow" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msubsup id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2.2" xref="alg1.l7.m1.1.1.2.2.2.cmml">w</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">t</mi><mi id="alg1.l7.m1.1.1.2.2.3" xref="alg1.l7.m1.1.1.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><apply id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.2.1.cmml" xref="alg1.l7.m1.1.1.2">superscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.2.cmml" xref="alg1.l7.m1.1.1.2.2.2">𝑤</ci><ci id="alg1.l7.m1.1.1.2.2.3.cmml" xref="alg1.l7.m1.1.1.2.2.3">𝑘</ci></apply><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">w^{k}_{t}\leftarrow</annotation></semantics></math> <span id="alg1.l7.1" class="ltx_text ltx_font_smallcaps">ClientUpdate</span>(<math id="alg1.l7.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">k</annotation></semantics></math>, <math id="alg1.l7.m3.1" class="ltx_Math" alttext="w_{t-1}" display="inline"><semantics id="alg1.l7.m3.1a"><msub id="alg1.l7.m3.1.1" xref="alg1.l7.m3.1.1.cmml"><mi id="alg1.l7.m3.1.1.2" xref="alg1.l7.m3.1.1.2.cmml">w</mi><mrow id="alg1.l7.m3.1.1.3" xref="alg1.l7.m3.1.1.3.cmml"><mi id="alg1.l7.m3.1.1.3.2" xref="alg1.l7.m3.1.1.3.2.cmml">t</mi><mo id="alg1.l7.m3.1.1.3.1" xref="alg1.l7.m3.1.1.3.1.cmml">−</mo><mn id="alg1.l7.m3.1.1.3.3" xref="alg1.l7.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.1b"><apply id="alg1.l7.m3.1.1.cmml" xref="alg1.l7.m3.1.1"><csymbol cd="ambiguous" id="alg1.l7.m3.1.1.1.cmml" xref="alg1.l7.m3.1.1">subscript</csymbol><ci id="alg1.l7.m3.1.1.2.cmml" xref="alg1.l7.m3.1.1.2">𝑤</ci><apply id="alg1.l7.m3.1.1.3.cmml" xref="alg1.l7.m3.1.1.3"><minus id="alg1.l7.m3.1.1.3.1.cmml" xref="alg1.l7.m3.1.1.3.1"></minus><ci id="alg1.l7.m3.1.1.3.2.cmml" xref="alg1.l7.m3.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l7.m3.1.1.3.3.cmml" xref="alg1.l7.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.1c">w_{t-1}</annotation></semantics></math>)
     
</div>
<div id="alg1.l8" class="ltx_listingline">     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">Model aggregating process:</span>

</div>
<div id="alg1.l9" class="ltx_listingline">     <math id="alg1.l9.m1.1" class="ltx_Math" alttext="w_{t}\leftarrow\sum_{k}z_{k}w_{t}^{k}" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">w</mi><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">t</mi></msub><mo rspace="0.111em" stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><msub id="alg1.l9.m1.1.1.3.1" xref="alg1.l9.m1.1.1.3.1.cmml"><mo id="alg1.l9.m1.1.1.3.1.2" xref="alg1.l9.m1.1.1.3.1.2.cmml">∑</mo><mi id="alg1.l9.m1.1.1.3.1.3" xref="alg1.l9.m1.1.1.3.1.3.cmml">k</mi></msub><mrow id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml"><msub id="alg1.l9.m1.1.1.3.2.2" xref="alg1.l9.m1.1.1.3.2.2.cmml"><mi id="alg1.l9.m1.1.1.3.2.2.2" xref="alg1.l9.m1.1.1.3.2.2.2.cmml">z</mi><mi id="alg1.l9.m1.1.1.3.2.2.3" xref="alg1.l9.m1.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.3.2.1" xref="alg1.l9.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg1.l9.m1.1.1.3.2.3" xref="alg1.l9.m1.1.1.3.2.3.cmml"><mi id="alg1.l9.m1.1.1.3.2.3.2.2" xref="alg1.l9.m1.1.1.3.2.3.2.2.cmml">w</mi><mi id="alg1.l9.m1.1.1.3.2.3.2.3" xref="alg1.l9.m1.1.1.3.2.3.2.3.cmml">t</mi><mi id="alg1.l9.m1.1.1.3.2.3.3" xref="alg1.l9.m1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑤</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><apply id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.1.cmml" xref="alg1.l9.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l9.m1.1.1.3.1.2.cmml" xref="alg1.l9.m1.1.1.3.1.2"></sum><ci id="alg1.l9.m1.1.1.3.1.3.cmml" xref="alg1.l9.m1.1.1.3.1.3">𝑘</ci></apply><apply id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2"><times id="alg1.l9.m1.1.1.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2.1"></times><apply id="alg1.l9.m1.1.1.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.2.1.cmml" xref="alg1.l9.m1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2.2">𝑧</ci><ci id="alg1.l9.m1.1.1.3.2.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.2.3">𝑘</ci></apply><apply id="alg1.l9.m1.1.1.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.3.1.cmml" xref="alg1.l9.m1.1.1.3.2.3">superscript</csymbol><apply id="alg1.l9.m1.1.1.3.2.3.2.cmml" xref="alg1.l9.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.3.2.2">𝑤</ci><ci id="alg1.l9.m1.1.1.3.2.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3.2.3">𝑡</ci></apply><ci id="alg1.l9.m1.1.1.3.2.3.3.cmml" xref="alg1.l9.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">w_{t}\leftarrow\sum_{k}z_{k}w_{t}^{k}</annotation></semantics></math> (weighted average of resulting local models)

</div>
<div id="alg1.l10" class="ltx_listingline">     <span id="alg1.l10.1" class="ltx_text ltx_font_bold">Local evaluation process:</span>

</div>
<div id="alg1.l11" class="ltx_listingline">     <span id="alg1.l11.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg1.l11.m1.4" class="ltx_Math" alttext="k=1,2,...,K" display="inline"><semantics id="alg1.l11.m1.4a"><mrow id="alg1.l11.m1.4.5" xref="alg1.l11.m1.4.5.cmml"><mi id="alg1.l11.m1.4.5.2" xref="alg1.l11.m1.4.5.2.cmml">k</mi><mo id="alg1.l11.m1.4.5.1" xref="alg1.l11.m1.4.5.1.cmml">=</mo><mrow id="alg1.l11.m1.4.5.3.2" xref="alg1.l11.m1.4.5.3.1.cmml"><mn id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">1</mn><mo id="alg1.l11.m1.4.5.3.2.1" xref="alg1.l11.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml">2</mn><mo id="alg1.l11.m1.4.5.3.2.2" xref="alg1.l11.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l11.m1.3.3" xref="alg1.l11.m1.3.3.cmml">…</mi><mo id="alg1.l11.m1.4.5.3.2.3" xref="alg1.l11.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l11.m1.4.4" xref="alg1.l11.m1.4.4.cmml">K</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.4b"><apply id="alg1.l11.m1.4.5.cmml" xref="alg1.l11.m1.4.5"><eq id="alg1.l11.m1.4.5.1.cmml" xref="alg1.l11.m1.4.5.1"></eq><ci id="alg1.l11.m1.4.5.2.cmml" xref="alg1.l11.m1.4.5.2">𝑘</ci><list id="alg1.l11.m1.4.5.3.1.cmml" xref="alg1.l11.m1.4.5.3.2"><cn type="integer" id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">1</cn><cn type="integer" id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2">2</cn><ci id="alg1.l11.m1.3.3.cmml" xref="alg1.l11.m1.3.3">…</ci><ci id="alg1.l11.m1.4.4.cmml" xref="alg1.l11.m1.4.4">𝐾</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.4c">k=1,2,...,K</annotation></semantics></math> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l12" class="ltx_listingline">         Test the aggregated model <math id="alg1.l12.m1.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="alg1.l12.m1.1a"><msub id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">w</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑤</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">w_{t}</annotation></semantics></math> using client validation set <math id="alg1.l12.m2.1" class="ltx_Math" alttext="D_{val}^{k}" display="inline"><semantics id="alg1.l12.m2.1a"><msubsup id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mi id="alg1.l12.m2.1.1.2.2" xref="alg1.l12.m2.1.1.2.2.cmml">D</mi><mrow id="alg1.l12.m2.1.1.2.3" xref="alg1.l12.m2.1.1.2.3.cmml"><mi id="alg1.l12.m2.1.1.2.3.2" xref="alg1.l12.m2.1.1.2.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m2.1.1.2.3.1" xref="alg1.l12.m2.1.1.2.3.1.cmml">​</mo><mi id="alg1.l12.m2.1.1.2.3.3" xref="alg1.l12.m2.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m2.1.1.2.3.1a" xref="alg1.l12.m2.1.1.2.3.1.cmml">​</mo><mi id="alg1.l12.m2.1.1.2.3.4" xref="alg1.l12.m2.1.1.2.3.4.cmml">l</mi></mrow><mi id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1">superscript</csymbol><apply id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.2.1.cmml" xref="alg1.l12.m2.1.1">subscript</csymbol><ci id="alg1.l12.m2.1.1.2.2.cmml" xref="alg1.l12.m2.1.1.2.2">𝐷</ci><apply id="alg1.l12.m2.1.1.2.3.cmml" xref="alg1.l12.m2.1.1.2.3"><times id="alg1.l12.m2.1.1.2.3.1.cmml" xref="alg1.l12.m2.1.1.2.3.1"></times><ci id="alg1.l12.m2.1.1.2.3.2.cmml" xref="alg1.l12.m2.1.1.2.3.2">𝑣</ci><ci id="alg1.l12.m2.1.1.2.3.3.cmml" xref="alg1.l12.m2.1.1.2.3.3">𝑎</ci><ci id="alg1.l12.m2.1.1.2.3.4.cmml" xref="alg1.l12.m2.1.1.2.3.4">𝑙</ci></apply></apply><ci id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">D_{val}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">         <math id="alg1.l13.m1.1" class="ltx_Math" alttext="F1_{t}^{k}\leftarrow" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mrow id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml"><mi id="alg1.l13.m1.1.1.2.2" xref="alg1.l13.m1.1.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m1.1.1.2.1" xref="alg1.l13.m1.1.1.2.1.cmml">​</mo><msubsup id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml"><mn id="alg1.l13.m1.1.1.2.3.2.2" xref="alg1.l13.m1.1.1.2.3.2.2.cmml">1</mn><mi id="alg1.l13.m1.1.1.2.3.2.3" xref="alg1.l13.m1.1.1.2.3.2.3.cmml">t</mi><mi id="alg1.l13.m1.1.1.2.3.3" xref="alg1.l13.m1.1.1.2.3.3.cmml">k</mi></msubsup></mrow><mo stretchy="false" id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">←</mo><mi id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><ci id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1">←</ci><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"><times id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.2.1"></times><ci id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2.2">𝐹</ci><apply id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.3.1.cmml" xref="alg1.l13.m1.1.1.2.3">superscript</csymbol><apply id="alg1.l13.m1.1.1.2.3.2.cmml" xref="alg1.l13.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.3.2.1.cmml" xref="alg1.l13.m1.1.1.2.3">subscript</csymbol><cn type="integer" id="alg1.l13.m1.1.1.2.3.2.2.cmml" xref="alg1.l13.m1.1.1.2.3.2.2">1</cn><ci id="alg1.l13.m1.1.1.2.3.2.3.cmml" xref="alg1.l13.m1.1.1.2.3.2.3">𝑡</ci></apply><ci id="alg1.l13.m1.1.1.2.3.3.cmml" xref="alg1.l13.m1.1.1.2.3.3">𝑘</ci></apply></apply><csymbol cd="latexml" id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">F1_{t}^{k}\leftarrow</annotation></semantics></math> <span id="alg1.l13.1" class="ltx_text ltx_font_smallcaps">F1Score</span>(<math id="alg1.l13.m2.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="alg1.l13.m2.1a"><msub id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml"><mi id="alg1.l13.m2.1.1.2" xref="alg1.l13.m2.1.1.2.cmml">w</mi><mi id="alg1.l13.m2.1.1.3" xref="alg1.l13.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b"><apply id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1"><csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.cmml" xref="alg1.l13.m2.1.1">subscript</csymbol><ci id="alg1.l13.m2.1.1.2.cmml" xref="alg1.l13.m2.1.1.2">𝑤</ci><ci id="alg1.l13.m2.1.1.3.cmml" xref="alg1.l13.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m2.1c">w_{t}</annotation></semantics></math>, <math id="alg1.l13.m3.1" class="ltx_Math" alttext="D_{val}^{k}" display="inline"><semantics id="alg1.l13.m3.1a"><msubsup id="alg1.l13.m3.1.1" xref="alg1.l13.m3.1.1.cmml"><mi id="alg1.l13.m3.1.1.2.2" xref="alg1.l13.m3.1.1.2.2.cmml">D</mi><mrow id="alg1.l13.m3.1.1.2.3" xref="alg1.l13.m3.1.1.2.3.cmml"><mi id="alg1.l13.m3.1.1.2.3.2" xref="alg1.l13.m3.1.1.2.3.2.cmml">v</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m3.1.1.2.3.1" xref="alg1.l13.m3.1.1.2.3.1.cmml">​</mo><mi id="alg1.l13.m3.1.1.2.3.3" xref="alg1.l13.m3.1.1.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l13.m3.1.1.2.3.1a" xref="alg1.l13.m3.1.1.2.3.1.cmml">​</mo><mi id="alg1.l13.m3.1.1.2.3.4" xref="alg1.l13.m3.1.1.2.3.4.cmml">l</mi></mrow><mi id="alg1.l13.m3.1.1.3" xref="alg1.l13.m3.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l13.m3.1b"><apply id="alg1.l13.m3.1.1.cmml" xref="alg1.l13.m3.1.1"><csymbol cd="ambiguous" id="alg1.l13.m3.1.1.1.cmml" xref="alg1.l13.m3.1.1">superscript</csymbol><apply id="alg1.l13.m3.1.1.2.cmml" xref="alg1.l13.m3.1.1"><csymbol cd="ambiguous" id="alg1.l13.m3.1.1.2.1.cmml" xref="alg1.l13.m3.1.1">subscript</csymbol><ci id="alg1.l13.m3.1.1.2.2.cmml" xref="alg1.l13.m3.1.1.2.2">𝐷</ci><apply id="alg1.l13.m3.1.1.2.3.cmml" xref="alg1.l13.m3.1.1.2.3"><times id="alg1.l13.m3.1.1.2.3.1.cmml" xref="alg1.l13.m3.1.1.2.3.1"></times><ci id="alg1.l13.m3.1.1.2.3.2.cmml" xref="alg1.l13.m3.1.1.2.3.2">𝑣</ci><ci id="alg1.l13.m3.1.1.2.3.3.cmml" xref="alg1.l13.m3.1.1.2.3.3">𝑎</ci><ci id="alg1.l13.m3.1.1.2.3.4.cmml" xref="alg1.l13.m3.1.1.2.3.4">𝑙</ci></apply></apply><ci id="alg1.l13.m3.1.1.3.cmml" xref="alg1.l13.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m3.1c">D_{val}^{k}</annotation></semantics></math>)
     
</div>
<div id="alg1.l14" class="ltx_listingline">     <math id="alg1.l14.m1.1" class="ltx_Math" alttext="F1_{t}\leftarrow\sum_{k}z_{k}F1_{t}^{k}" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mrow id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mi id="alg1.l14.m1.1.1.2.2" xref="alg1.l14.m1.1.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.2.1" xref="alg1.l14.m1.1.1.2.1.cmml">​</mo><msub id="alg1.l14.m1.1.1.2.3" xref="alg1.l14.m1.1.1.2.3.cmml"><mn id="alg1.l14.m1.1.1.2.3.2" xref="alg1.l14.m1.1.1.2.3.2.cmml">1</mn><mi id="alg1.l14.m1.1.1.2.3.3" xref="alg1.l14.m1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo rspace="0.111em" stretchy="false" id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">←</mo><mrow id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"><msub id="alg1.l14.m1.1.1.3.1" xref="alg1.l14.m1.1.1.3.1.cmml"><mo id="alg1.l14.m1.1.1.3.1.2" xref="alg1.l14.m1.1.1.3.1.2.cmml">∑</mo><mi id="alg1.l14.m1.1.1.3.1.3" xref="alg1.l14.m1.1.1.3.1.3.cmml">k</mi></msub><mrow id="alg1.l14.m1.1.1.3.2" xref="alg1.l14.m1.1.1.3.2.cmml"><msub id="alg1.l14.m1.1.1.3.2.2" xref="alg1.l14.m1.1.1.3.2.2.cmml"><mi id="alg1.l14.m1.1.1.3.2.2.2" xref="alg1.l14.m1.1.1.3.2.2.2.cmml">z</mi><mi id="alg1.l14.m1.1.1.3.2.2.3" xref="alg1.l14.m1.1.1.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.3.2.1" xref="alg1.l14.m1.1.1.3.2.1.cmml">​</mo><mi id="alg1.l14.m1.1.1.3.2.3" xref="alg1.l14.m1.1.1.3.2.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.3.2.1a" xref="alg1.l14.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg1.l14.m1.1.1.3.2.4" xref="alg1.l14.m1.1.1.3.2.4.cmml"><mn id="alg1.l14.m1.1.1.3.2.4.2.2" xref="alg1.l14.m1.1.1.3.2.4.2.2.cmml">1</mn><mi id="alg1.l14.m1.1.1.3.2.4.2.3" xref="alg1.l14.m1.1.1.3.2.4.2.3.cmml">t</mi><mi id="alg1.l14.m1.1.1.3.2.4.3" xref="alg1.l14.m1.1.1.3.2.4.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">←</ci><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><times id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2.1"></times><ci id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2.2">𝐹</ci><apply id="alg1.l14.m1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.2.3.1.cmml" xref="alg1.l14.m1.1.1.2.3">subscript</csymbol><cn type="integer" id="alg1.l14.m1.1.1.2.3.2.cmml" xref="alg1.l14.m1.1.1.2.3.2">1</cn><ci id="alg1.l14.m1.1.1.2.3.3.cmml" xref="alg1.l14.m1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3"><apply id="alg1.l14.m1.1.1.3.1.cmml" xref="alg1.l14.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.1.1.cmml" xref="alg1.l14.m1.1.1.3.1">subscript</csymbol><sum id="alg1.l14.m1.1.1.3.1.2.cmml" xref="alg1.l14.m1.1.1.3.1.2"></sum><ci id="alg1.l14.m1.1.1.3.1.3.cmml" xref="alg1.l14.m1.1.1.3.1.3">𝑘</ci></apply><apply id="alg1.l14.m1.1.1.3.2.cmml" xref="alg1.l14.m1.1.1.3.2"><times id="alg1.l14.m1.1.1.3.2.1.cmml" xref="alg1.l14.m1.1.1.3.2.1"></times><apply id="alg1.l14.m1.1.1.3.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.2.1.cmml" xref="alg1.l14.m1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.3.2.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.2.2">𝑧</ci><ci id="alg1.l14.m1.1.1.3.2.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.2.3">𝑘</ci></apply><ci id="alg1.l14.m1.1.1.3.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.3">𝐹</ci><apply id="alg1.l14.m1.1.1.3.2.4.cmml" xref="alg1.l14.m1.1.1.3.2.4"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.4.1.cmml" xref="alg1.l14.m1.1.1.3.2.4">superscript</csymbol><apply id="alg1.l14.m1.1.1.3.2.4.2.cmml" xref="alg1.l14.m1.1.1.3.2.4"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.3.2.4.2.1.cmml" xref="alg1.l14.m1.1.1.3.2.4">subscript</csymbol><cn type="integer" id="alg1.l14.m1.1.1.3.2.4.2.2.cmml" xref="alg1.l14.m1.1.1.3.2.4.2.2">1</cn><ci id="alg1.l14.m1.1.1.3.2.4.2.3.cmml" xref="alg1.l14.m1.1.1.3.2.4.2.3">𝑡</ci></apply><ci id="alg1.l14.m1.1.1.3.2.4.3.cmml" xref="alg1.l14.m1.1.1.3.2.4.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">F1_{t}\leftarrow\sum_{k}z_{k}F1_{t}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">     <span id="alg1.l15.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l15.m1.1" class="ltx_Math" alttext="F1_{t}&gt;F1_{best}" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mrow id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml"><mi id="alg1.l15.m1.1.1.2.2" xref="alg1.l15.m1.1.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.2.1" xref="alg1.l15.m1.1.1.2.1.cmml">​</mo><msub id="alg1.l15.m1.1.1.2.3" xref="alg1.l15.m1.1.1.2.3.cmml"><mn id="alg1.l15.m1.1.1.2.3.2" xref="alg1.l15.m1.1.1.2.3.2.cmml">1</mn><mi id="alg1.l15.m1.1.1.2.3.3" xref="alg1.l15.m1.1.1.2.3.3.cmml">t</mi></msub></mrow><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">&gt;</mo><mrow id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mi id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.1" xref="alg1.l15.m1.1.1.3.1.cmml">​</mo><msub id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml"><mn id="alg1.l15.m1.1.1.3.3.2" xref="alg1.l15.m1.1.1.3.3.2.cmml">1</mn><mrow id="alg1.l15.m1.1.1.3.3.3" xref="alg1.l15.m1.1.1.3.3.3.cmml"><mi id="alg1.l15.m1.1.1.3.3.3.2" xref="alg1.l15.m1.1.1.3.3.3.2.cmml">b</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.3.3.1" xref="alg1.l15.m1.1.1.3.3.3.1.cmml">​</mo><mi id="alg1.l15.m1.1.1.3.3.3.3" xref="alg1.l15.m1.1.1.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.3.3.1a" xref="alg1.l15.m1.1.1.3.3.3.1.cmml">​</mo><mi id="alg1.l15.m1.1.1.3.3.3.4" xref="alg1.l15.m1.1.1.3.3.3.4.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.3.3.1b" xref="alg1.l15.m1.1.1.3.3.3.1.cmml">​</mo><mi id="alg1.l15.m1.1.1.3.3.3.5" xref="alg1.l15.m1.1.1.3.3.3.5.cmml">t</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><gt id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></gt><apply id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2"><times id="alg1.l15.m1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.2.1"></times><ci id="alg1.l15.m1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.2.2">𝐹</ci><apply id="alg1.l15.m1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.3.1.cmml" xref="alg1.l15.m1.1.1.2.3">subscript</csymbol><cn type="integer" id="alg1.l15.m1.1.1.2.3.2.cmml" xref="alg1.l15.m1.1.1.2.3.2">1</cn><ci id="alg1.l15.m1.1.1.2.3.3.cmml" xref="alg1.l15.m1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><times id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3.1"></times><ci id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2">𝐹</ci><apply id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.3.3">subscript</csymbol><cn type="integer" id="alg1.l15.m1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.3.3.2">1</cn><apply id="alg1.l15.m1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.3.3.3"><times id="alg1.l15.m1.1.1.3.3.3.1.cmml" xref="alg1.l15.m1.1.1.3.3.3.1"></times><ci id="alg1.l15.m1.1.1.3.3.3.2.cmml" xref="alg1.l15.m1.1.1.3.3.3.2">𝑏</ci><ci id="alg1.l15.m1.1.1.3.3.3.3.cmml" xref="alg1.l15.m1.1.1.3.3.3.3">𝑒</ci><ci id="alg1.l15.m1.1.1.3.3.3.4.cmml" xref="alg1.l15.m1.1.1.3.3.3.4">𝑠</ci><ci id="alg1.l15.m1.1.1.3.3.3.5.cmml" xref="alg1.l15.m1.1.1.3.3.3.5">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">F1_{t}&gt;F1_{best}</annotation></semantics></math> <span id="alg1.l15.2" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg1.l16" class="ltx_listingline">         Save <math id="alg1.l16.m1.1" class="ltx_Math" alttext="w_{t}" display="inline"><semantics id="alg1.l16.m1.1a"><msub id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">w</mi><mi id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">𝑤</ci><ci id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">w_{t}</annotation></semantics></math> as best model
     
</div>
<div id="alg1.l17" class="ltx_listingline">
</div>
<div id="alg1.l18" class="ltx_listingline">
<span id="alg1.l18.1" class="ltx_text ltx_font_bold">procedure</span> <span id="alg1.l18.2" class="ltx_text ltx_font_smallcaps">ClientUpdate</span>(<math id="alg1.l18.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg1.l18.m1.1a"><mi id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><ci id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">k</annotation></semantics></math>, <math id="alg1.l18.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l18.m2.1a"><mi id="alg1.l18.m2.1.1" xref="alg1.l18.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l18.m2.1b"><ci id="alg1.l18.m2.1.1.cmml" xref="alg1.l18.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m2.1c">w</annotation></semantics></math>)

</div>
<div id="alg1.l19" class="ltx_listingline">     Receive global model <math id="alg1.l19.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="alg1.l19.m1.1a"><mi id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><ci id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">w</annotation></semantics></math> and set its weights to local model <math id="alg1.l19.m2.1" class="ltx_Math" alttext="w^{k}" display="inline"><semantics id="alg1.l19.m2.1a"><msup id="alg1.l19.m2.1.1" xref="alg1.l19.m2.1.1.cmml"><mi id="alg1.l19.m2.1.1.2" xref="alg1.l19.m2.1.1.2.cmml">w</mi><mi id="alg1.l19.m2.1.1.3" xref="alg1.l19.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l19.m2.1b"><apply id="alg1.l19.m2.1.1.cmml" xref="alg1.l19.m2.1.1"><csymbol cd="ambiguous" id="alg1.l19.m2.1.1.1.cmml" xref="alg1.l19.m2.1.1">superscript</csymbol><ci id="alg1.l19.m2.1.1.2.cmml" xref="alg1.l19.m2.1.1.2">𝑤</ci><ci id="alg1.l19.m2.1.1.3.cmml" xref="alg1.l19.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m2.1c">w^{k}</annotation></semantics></math>

</div>
<div id="alg1.l20" class="ltx_listingline">     <span id="alg1.l20.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l20.m1.1" class="ltx_Math" alttext="t&gt;t_{ft}" display="inline"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><mi id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml">t</mi><mo id="alg1.l20.m1.1.1.1" xref="alg1.l20.m1.1.1.1.cmml">&gt;</mo><msub id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml"><mi id="alg1.l20.m1.1.1.3.2" xref="alg1.l20.m1.1.1.3.2.cmml">t</mi><mrow id="alg1.l20.m1.1.1.3.3" xref="alg1.l20.m1.1.1.3.3.cmml"><mi id="alg1.l20.m1.1.1.3.3.2" xref="alg1.l20.m1.1.1.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="alg1.l20.m1.1.1.3.3.1" xref="alg1.l20.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l20.m1.1.1.3.3.3" xref="alg1.l20.m1.1.1.3.3.3.cmml">t</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><gt id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1"></gt><ci id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2">𝑡</ci><apply id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.3.1.cmml" xref="alg1.l20.m1.1.1.3">subscript</csymbol><ci id="alg1.l20.m1.1.1.3.2.cmml" xref="alg1.l20.m1.1.1.3.2">𝑡</ci><apply id="alg1.l20.m1.1.1.3.3.cmml" xref="alg1.l20.m1.1.1.3.3"><times id="alg1.l20.m1.1.1.3.3.1.cmml" xref="alg1.l20.m1.1.1.3.3.1"></times><ci id="alg1.l20.m1.1.1.3.3.2.cmml" xref="alg1.l20.m1.1.1.3.3.2">𝑓</ci><ci id="alg1.l20.m1.1.1.3.3.3.cmml" xref="alg1.l20.m1.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">t&gt;t_{ft}</annotation></semantics></math> <span id="alg1.l20.2" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg1.l21" class="ltx_listingline">         Unfreeze <math id="alg1.l21.m1.1" class="ltx_Math" alttext="f" display="inline"><semantics id="alg1.l21.m1.1a"><mi id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><ci id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">f</annotation></semantics></math> layers of <math id="alg1.l21.m2.1" class="ltx_Math" alttext="w^{k}" display="inline"><semantics id="alg1.l21.m2.1a"><msup id="alg1.l21.m2.1.1" xref="alg1.l21.m2.1.1.cmml"><mi id="alg1.l21.m2.1.1.2" xref="alg1.l21.m2.1.1.2.cmml">w</mi><mi id="alg1.l21.m2.1.1.3" xref="alg1.l21.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.1b"><apply id="alg1.l21.m2.1.1.cmml" xref="alg1.l21.m2.1.1"><csymbol cd="ambiguous" id="alg1.l21.m2.1.1.1.cmml" xref="alg1.l21.m2.1.1">superscript</csymbol><ci id="alg1.l21.m2.1.1.2.cmml" xref="alg1.l21.m2.1.1.2">𝑤</ci><ci id="alg1.l21.m2.1.1.3.cmml" xref="alg1.l21.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.1c">w^{k}</annotation></semantics></math>
     
</div>
<div id="alg1.l22" class="ltx_listingline">     <span id="alg1.l22.1" class="ltx_text ltx_font_bold">for</span> each local epoch <math id="alg1.l22.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l22.m1.1a"><mi id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><ci id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">i</annotation></semantics></math> from 1 to E <span id="alg1.l22.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l23" class="ltx_listingline">         Train <math id="alg1.l23.m1.1" class="ltx_Math" alttext="w^{k}" display="inline"><semantics id="alg1.l23.m1.1a"><msup id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml"><mi id="alg1.l23.m1.1.1.2" xref="alg1.l23.m1.1.1.2.cmml">w</mi><mi id="alg1.l23.m1.1.1.3" xref="alg1.l23.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.1b"><apply id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.1.1.1.cmml" xref="alg1.l23.m1.1.1">superscript</csymbol><ci id="alg1.l23.m1.1.1.2.cmml" xref="alg1.l23.m1.1.1.2">𝑤</ci><ci id="alg1.l23.m1.1.1.3.cmml" xref="alg1.l23.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.1c">w^{k}</annotation></semantics></math> with <math id="alg1.l23.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="alg1.l23.m2.1a"><mi id="alg1.l23.m2.1.1" xref="alg1.l23.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="alg1.l23.m2.1b"><ci id="alg1.l23.m2.1.1.cmml" xref="alg1.l23.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m2.1c">B</annotation></semantics></math> batch size and <math id="alg1.l23.m3.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.l23.m3.1a"><mi id="alg1.l23.m3.1.1" xref="alg1.l23.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l23.m3.1b"><ci id="alg1.l23.m3.1.1.cmml" xref="alg1.l23.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m3.1c">\eta</annotation></semantics></math> learning rate, using client dataset <math id="alg1.l23.m4.1" class="ltx_Math" alttext="D_{k}" display="inline"><semantics id="alg1.l23.m4.1a"><msub id="alg1.l23.m4.1.1" xref="alg1.l23.m4.1.1.cmml"><mi id="alg1.l23.m4.1.1.2" xref="alg1.l23.m4.1.1.2.cmml">D</mi><mi id="alg1.l23.m4.1.1.3" xref="alg1.l23.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l23.m4.1b"><apply id="alg1.l23.m4.1.1.cmml" xref="alg1.l23.m4.1.1"><csymbol cd="ambiguous" id="alg1.l23.m4.1.1.1.cmml" xref="alg1.l23.m4.1.1">subscript</csymbol><ci id="alg1.l23.m4.1.1.2.cmml" xref="alg1.l23.m4.1.1.2">𝐷</ci><ci id="alg1.l23.m4.1.1.3.cmml" xref="alg1.l23.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m4.1c">D_{k}</annotation></semantics></math>
     
</div>
<div id="alg1.l24" class="ltx_listingline">     return <math id="alg1.l24.m1.1" class="ltx_Math" alttext="w^{k}" display="inline"><semantics id="alg1.l24.m1.1a"><msup id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml"><mi id="alg1.l24.m1.1.1.2" xref="alg1.l24.m1.1.1.2.cmml">w</mi><mi id="alg1.l24.m1.1.1.3" xref="alg1.l24.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><apply id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.1.cmml" xref="alg1.l24.m1.1.1">superscript</csymbol><ci id="alg1.l24.m1.1.1.2.cmml" xref="alg1.l24.m1.1.1.2">𝑤</ci><ci id="alg1.l24.m1.1.1.3.cmml" xref="alg1.l24.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">w^{k}</annotation></semantics></math> to the server

</div>
</div>
</figure>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2408.13626/assets/figures/pipeline.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_portrait" width="598" height="775" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Case-based Explanations for Federated Learning.</figcaption>
</figure>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.3" class="ltx_p">The second step of our methodology requires the training of a generative model to generate case-based explanations. In our experiments, we considered Medfusion <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> as our generative model, given its previous promising results on Chest X-rays. A Medfusion model was trained for each of the clients, first training the Autoencoder, and later the Diffusion model. 400 samples with <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="t=150" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><mrow id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">t</mi><mo id="S2.SS2.p2.1.m1.1.1.1" xref="S2.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">150</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><eq id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1.1"></eq><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝑡</ci><cn type="integer" id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">150</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">t=150</annotation></semantics></math> sampling steps, 200 with <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="label=0" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><mrow id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mrow id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2.2" xref="S2.SS2.p2.2.m2.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.2.m2.1.1.2.1" xref="S2.SS2.p2.2.m2.1.1.2.1.cmml">​</mo><mi id="S2.SS2.p2.2.m2.1.1.2.3" xref="S2.SS2.p2.2.m2.1.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.2.m2.1.1.2.1a" xref="S2.SS2.p2.2.m2.1.1.2.1.cmml">​</mo><mi id="S2.SS2.p2.2.m2.1.1.2.4" xref="S2.SS2.p2.2.m2.1.1.2.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.2.m2.1.1.2.1b" xref="S2.SS2.p2.2.m2.1.1.2.1.cmml">​</mo><mi id="S2.SS2.p2.2.m2.1.1.2.5" xref="S2.SS2.p2.2.m2.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.2.m2.1.1.2.1c" xref="S2.SS2.p2.2.m2.1.1.2.1.cmml">​</mo><mi id="S2.SS2.p2.2.m2.1.1.2.6" xref="S2.SS2.p2.2.m2.1.1.2.6.cmml">l</mi></mrow><mo id="S2.SS2.p2.2.m2.1.1.1" xref="S2.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><eq id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1.1"></eq><apply id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2"><times id="S2.SS2.p2.2.m2.1.1.2.1.cmml" xref="S2.SS2.p2.2.m2.1.1.2.1"></times><ci id="S2.SS2.p2.2.m2.1.1.2.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2.2">𝑙</ci><ci id="S2.SS2.p2.2.m2.1.1.2.3.cmml" xref="S2.SS2.p2.2.m2.1.1.2.3">𝑎</ci><ci id="S2.SS2.p2.2.m2.1.1.2.4.cmml" xref="S2.SS2.p2.2.m2.1.1.2.4">𝑏</ci><ci id="S2.SS2.p2.2.m2.1.1.2.5.cmml" xref="S2.SS2.p2.2.m2.1.1.2.5">𝑒</ci><ci id="S2.SS2.p2.2.m2.1.1.2.6.cmml" xref="S2.SS2.p2.2.m2.1.1.2.6">𝑙</ci></apply><cn type="integer" id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">label=0</annotation></semantics></math> and 200 with <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="label=1" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mrow id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml"><mrow id="S2.SS2.p2.3.m3.1.1.2" xref="S2.SS2.p2.3.m3.1.1.2.cmml"><mi id="S2.SS2.p2.3.m3.1.1.2.2" xref="S2.SS2.p2.3.m3.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.2.1" xref="S2.SS2.p2.3.m3.1.1.2.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.2.3" xref="S2.SS2.p2.3.m3.1.1.2.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.2.1a" xref="S2.SS2.p2.3.m3.1.1.2.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.2.4" xref="S2.SS2.p2.3.m3.1.1.2.4.cmml">b</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.2.1b" xref="S2.SS2.p2.3.m3.1.1.2.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.2.5" xref="S2.SS2.p2.3.m3.1.1.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p2.3.m3.1.1.2.1c" xref="S2.SS2.p2.3.m3.1.1.2.1.cmml">​</mo><mi id="S2.SS2.p2.3.m3.1.1.2.6" xref="S2.SS2.p2.3.m3.1.1.2.6.cmml">l</mi></mrow><mo id="S2.SS2.p2.3.m3.1.1.1" xref="S2.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S2.SS2.p2.3.m3.1.1.3" xref="S2.SS2.p2.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><apply id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1"><eq id="S2.SS2.p2.3.m3.1.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1.1"></eq><apply id="S2.SS2.p2.3.m3.1.1.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2"><times id="S2.SS2.p2.3.m3.1.1.2.1.cmml" xref="S2.SS2.p2.3.m3.1.1.2.1"></times><ci id="S2.SS2.p2.3.m3.1.1.2.2.cmml" xref="S2.SS2.p2.3.m3.1.1.2.2">𝑙</ci><ci id="S2.SS2.p2.3.m3.1.1.2.3.cmml" xref="S2.SS2.p2.3.m3.1.1.2.3">𝑎</ci><ci id="S2.SS2.p2.3.m3.1.1.2.4.cmml" xref="S2.SS2.p2.3.m3.1.1.2.4">𝑏</ci><ci id="S2.SS2.p2.3.m3.1.1.2.5.cmml" xref="S2.SS2.p2.3.m3.1.1.2.5">𝑒</ci><ci id="S2.SS2.p2.3.m3.1.1.2.6.cmml" xref="S2.SS2.p2.3.m3.1.1.2.6">𝑙</ci></apply><cn type="integer" id="S2.SS2.p2.3.m3.1.1.3.cmml" xref="S2.SS2.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">label=1</annotation></semantics></math> were generated with each of the local models to create the synthetic dataset to be used to retrieve similar disease-matching cases as case-based explanations.</p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.8" class="ltx_p">When a new case needs to be classified by the discriminative model, the three most similar synthetic samples for each of the clients are selected from the synthetic dataset to show them as case-based explanations. Similarity between images is computed based on the Normalized Euclidean distance in the feature space of the previous to the last layer of the model, which is formalized as:</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.3" class="ltx_Math" alttext="d_{DP-FL}(I_{t},I_{s})=\|F(\theta_{DP-FL},I_{t})-F(\theta_{DP-FL},I_{s})\|" display="block"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml"><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><msub id="S2.E1.m1.2.2.2.4" xref="S2.E1.m1.2.2.2.4.cmml"><mi id="S2.E1.m1.2.2.2.4.2" xref="S2.E1.m1.2.2.2.4.2.cmml">d</mi><mrow id="S2.E1.m1.2.2.2.4.3" xref="S2.E1.m1.2.2.2.4.3.cmml"><mrow id="S2.E1.m1.2.2.2.4.3.2" xref="S2.E1.m1.2.2.2.4.3.2.cmml"><mi id="S2.E1.m1.2.2.2.4.3.2.2" xref="S2.E1.m1.2.2.2.4.3.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.4.3.2.1" xref="S2.E1.m1.2.2.2.4.3.2.1.cmml">​</mo><mi id="S2.E1.m1.2.2.2.4.3.2.3" xref="S2.E1.m1.2.2.2.4.3.2.3.cmml">P</mi></mrow><mo id="S2.E1.m1.2.2.2.4.3.1" xref="S2.E1.m1.2.2.2.4.3.1.cmml">−</mo><mrow id="S2.E1.m1.2.2.2.4.3.3" xref="S2.E1.m1.2.2.2.4.3.3.cmml"><mi id="S2.E1.m1.2.2.2.4.3.3.2" xref="S2.E1.m1.2.2.2.4.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.4.3.3.1" xref="S2.E1.m1.2.2.2.4.3.3.1.cmml">​</mo><mi id="S2.E1.m1.2.2.2.4.3.3.3" xref="S2.E1.m1.2.2.2.4.3.3.3.cmml">L</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml">​</mo><mrow id="S2.E1.m1.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.3.cmml">(</mo><msub id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">I</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S2.E1.m1.2.2.2.2.2.4" xref="S2.E1.m1.2.2.2.2.3.cmml">,</mo><msub id="S2.E1.m1.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.2.cmml">I</mi><mi id="S2.E1.m1.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S2.E1.m1.2.2.2.2.2.5" xref="S2.E1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.4" xref="S2.E1.m1.3.3.4.cmml">=</mo><mrow id="S2.E1.m1.3.3.3.1" xref="S2.E1.m1.3.3.3.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.3.1.2" xref="S2.E1.m1.3.3.3.2.1.cmml">‖</mo><mrow id="S2.E1.m1.3.3.3.1.1" xref="S2.E1.m1.3.3.3.1.1.cmml"><mrow id="S2.E1.m1.3.3.3.1.1.2" xref="S2.E1.m1.3.3.3.1.1.2.cmml"><mi id="S2.E1.m1.3.3.3.1.1.2.4" xref="S2.E1.m1.3.3.3.1.1.2.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.3.1.1.2.3" xref="S2.E1.m1.3.3.3.1.1.2.3.cmml">​</mo><mrow id="S2.E1.m1.3.3.3.1.1.2.2.2" xref="S2.E1.m1.3.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.3.1.1.2.2.2.3" xref="S2.E1.m1.3.3.3.1.1.2.2.3.cmml">(</mo><msub id="S2.E1.m1.3.3.3.1.1.1.1.1.1" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.3.3.3.1.1.1.1.1.1.2" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.2.cmml">θ</mi><mrow id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.cmml"><mrow id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.1" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.3.cmml">P</mi></mrow><mo id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.1" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.1.cmml">−</mo><mrow id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.1" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.3.cmml">L</mi></mrow></mrow></msub><mo id="S2.E1.m1.3.3.3.1.1.2.2.2.4" xref="S2.E1.m1.3.3.3.1.1.2.2.3.cmml">,</mo><msub id="S2.E1.m1.3.3.3.1.1.2.2.2.2" xref="S2.E1.m1.3.3.3.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.3.3.3.1.1.2.2.2.2.2" xref="S2.E1.m1.3.3.3.1.1.2.2.2.2.2.cmml">I</mi><mi id="S2.E1.m1.3.3.3.1.1.2.2.2.2.3" xref="S2.E1.m1.3.3.3.1.1.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S2.E1.m1.3.3.3.1.1.2.2.2.5" xref="S2.E1.m1.3.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.3.3.3.1.1.5" xref="S2.E1.m1.3.3.3.1.1.5.cmml">−</mo><mrow id="S2.E1.m1.3.3.3.1.1.4" xref="S2.E1.m1.3.3.3.1.1.4.cmml"><mi id="S2.E1.m1.3.3.3.1.1.4.4" xref="S2.E1.m1.3.3.3.1.1.4.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.3.1.1.4.3" xref="S2.E1.m1.3.3.3.1.1.4.3.cmml">​</mo><mrow id="S2.E1.m1.3.3.3.1.1.4.2.2" xref="S2.E1.m1.3.3.3.1.1.4.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.3.1.1.4.2.2.3" xref="S2.E1.m1.3.3.3.1.1.4.2.3.cmml">(</mo><msub id="S2.E1.m1.3.3.3.1.1.3.1.1.1" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.cmml"><mi id="S2.E1.m1.3.3.3.1.1.3.1.1.1.2" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.2.cmml">θ</mi><mrow id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.cmml"><mrow id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.cmml"><mi id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.2" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.1" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.1.cmml">​</mo><mi id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.3" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.3.cmml">P</mi></mrow><mo id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.1" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.1.cmml">−</mo><mrow id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.cmml"><mi id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.2" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.1" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.1.cmml">​</mo><mi id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.3" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.3.cmml">L</mi></mrow></mrow></msub><mo id="S2.E1.m1.3.3.3.1.1.4.2.2.4" xref="S2.E1.m1.3.3.3.1.1.4.2.3.cmml">,</mo><msub id="S2.E1.m1.3.3.3.1.1.4.2.2.2" xref="S2.E1.m1.3.3.3.1.1.4.2.2.2.cmml"><mi id="S2.E1.m1.3.3.3.1.1.4.2.2.2.2" xref="S2.E1.m1.3.3.3.1.1.4.2.2.2.2.cmml">I</mi><mi id="S2.E1.m1.3.3.3.1.1.4.2.2.2.3" xref="S2.E1.m1.3.3.3.1.1.4.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S2.E1.m1.3.3.3.1.1.4.2.2.5" xref="S2.E1.m1.3.3.3.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E1.m1.3.3.3.1.3" xref="S2.E1.m1.3.3.3.2.1.cmml">‖</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3"><eq id="S2.E1.m1.3.3.4.cmml" xref="S2.E1.m1.3.3.4"></eq><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><times id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3"></times><apply id="S2.E1.m1.2.2.2.4.cmml" xref="S2.E1.m1.2.2.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.4.1.cmml" xref="S2.E1.m1.2.2.2.4">subscript</csymbol><ci id="S2.E1.m1.2.2.2.4.2.cmml" xref="S2.E1.m1.2.2.2.4.2">𝑑</ci><apply id="S2.E1.m1.2.2.2.4.3.cmml" xref="S2.E1.m1.2.2.2.4.3"><minus id="S2.E1.m1.2.2.2.4.3.1.cmml" xref="S2.E1.m1.2.2.2.4.3.1"></minus><apply id="S2.E1.m1.2.2.2.4.3.2.cmml" xref="S2.E1.m1.2.2.2.4.3.2"><times id="S2.E1.m1.2.2.2.4.3.2.1.cmml" xref="S2.E1.m1.2.2.2.4.3.2.1"></times><ci id="S2.E1.m1.2.2.2.4.3.2.2.cmml" xref="S2.E1.m1.2.2.2.4.3.2.2">𝐷</ci><ci id="S2.E1.m1.2.2.2.4.3.2.3.cmml" xref="S2.E1.m1.2.2.2.4.3.2.3">𝑃</ci></apply><apply id="S2.E1.m1.2.2.2.4.3.3.cmml" xref="S2.E1.m1.2.2.2.4.3.3"><times id="S2.E1.m1.2.2.2.4.3.3.1.cmml" xref="S2.E1.m1.2.2.2.4.3.3.1"></times><ci id="S2.E1.m1.2.2.2.4.3.3.2.cmml" xref="S2.E1.m1.2.2.2.4.3.3.2">𝐹</ci><ci id="S2.E1.m1.2.2.2.4.3.3.3.cmml" xref="S2.E1.m1.2.2.2.4.3.3.3">𝐿</ci></apply></apply></apply><interval closure="open" id="S2.E1.m1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2"><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2">𝐼</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3">𝑡</ci></apply><apply id="S2.E1.m1.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2">𝐼</ci><ci id="S2.E1.m1.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.3">𝑠</ci></apply></interval></apply><apply id="S2.E1.m1.3.3.3.2.cmml" xref="S2.E1.m1.3.3.3.1"><csymbol cd="latexml" id="S2.E1.m1.3.3.3.2.1.cmml" xref="S2.E1.m1.3.3.3.1.2">norm</csymbol><apply id="S2.E1.m1.3.3.3.1.1.cmml" xref="S2.E1.m1.3.3.3.1.1"><minus id="S2.E1.m1.3.3.3.1.1.5.cmml" xref="S2.E1.m1.3.3.3.1.1.5"></minus><apply id="S2.E1.m1.3.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.3.1.1.2"><times id="S2.E1.m1.3.3.3.1.1.2.3.cmml" xref="S2.E1.m1.3.3.3.1.1.2.3"></times><ci id="S2.E1.m1.3.3.3.1.1.2.4.cmml" xref="S2.E1.m1.3.3.3.1.1.2.4">𝐹</ci><interval closure="open" id="S2.E1.m1.3.3.3.1.1.2.2.3.cmml" xref="S2.E1.m1.3.3.3.1.1.2.2.2"><apply id="S2.E1.m1.3.3.3.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.2">𝜃</ci><apply id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3"><minus id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.1"></minus><apply id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2"><times id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.1"></times><ci id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.2">𝐷</ci><ci id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.2.3">𝑃</ci></apply><apply id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3"><times id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.1"></times><ci id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.2">𝐹</ci><ci id="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.3.3.3.1.1.1.1.1.1.3.3.3">𝐿</ci></apply></apply></apply><apply id="S2.E1.m1.3.3.3.1.1.2.2.2.2.cmml" xref="S2.E1.m1.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.3.3.3.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.3.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.3.3.3.1.1.2.2.2.2.2">𝐼</ci><ci id="S2.E1.m1.3.3.3.1.1.2.2.2.2.3.cmml" xref="S2.E1.m1.3.3.3.1.1.2.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="S2.E1.m1.3.3.3.1.1.4.cmml" xref="S2.E1.m1.3.3.3.1.1.4"><times id="S2.E1.m1.3.3.3.1.1.4.3.cmml" xref="S2.E1.m1.3.3.3.1.1.4.3"></times><ci id="S2.E1.m1.3.3.3.1.1.4.4.cmml" xref="S2.E1.m1.3.3.3.1.1.4.4">𝐹</ci><interval closure="open" id="S2.E1.m1.3.3.3.1.1.4.2.3.cmml" xref="S2.E1.m1.3.3.3.1.1.4.2.2"><apply id="S2.E1.m1.3.3.3.1.1.3.1.1.1.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.1.1.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.3.1.1.3.1.1.1.2.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.2">𝜃</ci><apply id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3"><minus id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.1"></minus><apply id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2"><times id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.1"></times><ci id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.2">𝐷</ci><ci id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.2.3">𝑃</ci></apply><apply id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3"><times id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.1.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.1"></times><ci id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.2.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.2">𝐹</ci><ci id="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.3.cmml" xref="S2.E1.m1.3.3.3.1.1.3.1.1.1.3.3.3">𝐿</ci></apply></apply></apply><apply id="S2.E1.m1.3.3.3.1.1.4.2.2.2.cmml" xref="S2.E1.m1.3.3.3.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.3.1.1.4.2.2.2.1.cmml" xref="S2.E1.m1.3.3.3.1.1.4.2.2.2">subscript</csymbol><ci id="S2.E1.m1.3.3.3.1.1.4.2.2.2.2.cmml" xref="S2.E1.m1.3.3.3.1.1.4.2.2.2.2">𝐼</ci><ci id="S2.E1.m1.3.3.3.1.1.4.2.2.2.3.cmml" xref="S2.E1.m1.3.3.3.1.1.4.2.2.2.3">𝑠</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">d_{DP-FL}(I_{t},I_{s})=\|F(\theta_{DP-FL},I_{t})-F(\theta_{DP-FL},I_{s})\|</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p3.7" class="ltx_p">where <math id="S2.SS2.p3.1.m1.1" class="ltx_Math" alttext="I_{t}" display="inline"><semantics id="S2.SS2.p3.1.m1.1a"><msub id="S2.SS2.p3.1.m1.1.1" xref="S2.SS2.p3.1.m1.1.1.cmml"><mi id="S2.SS2.p3.1.m1.1.1.2" xref="S2.SS2.p3.1.m1.1.1.2.cmml">I</mi><mi id="S2.SS2.p3.1.m1.1.1.3" xref="S2.SS2.p3.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.1.m1.1b"><apply id="S2.SS2.p3.1.m1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.1.m1.1.1.1.cmml" xref="S2.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p3.1.m1.1.1.2.cmml" xref="S2.SS2.p3.1.m1.1.1.2">𝐼</ci><ci id="S2.SS2.p3.1.m1.1.1.3.cmml" xref="S2.SS2.p3.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.1.m1.1c">I_{t}</annotation></semantics></math> represents the test image <math id="S2.SS2.p3.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS2.p3.2.m2.1a"><mi id="S2.SS2.p3.2.m2.1.1" xref="S2.SS2.p3.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.2.m2.1b"><ci id="S2.SS2.p3.2.m2.1.1.cmml" xref="S2.SS2.p3.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.2.m2.1c">t</annotation></semantics></math>, <math id="S2.SS2.p3.3.m3.1" class="ltx_Math" alttext="I_{s}" display="inline"><semantics id="S2.SS2.p3.3.m3.1a"><msub id="S2.SS2.p3.3.m3.1.1" xref="S2.SS2.p3.3.m3.1.1.cmml"><mi id="S2.SS2.p3.3.m3.1.1.2" xref="S2.SS2.p3.3.m3.1.1.2.cmml">I</mi><mi id="S2.SS2.p3.3.m3.1.1.3" xref="S2.SS2.p3.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.3.m3.1b"><apply id="S2.SS2.p3.3.m3.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.3.m3.1.1.1.cmml" xref="S2.SS2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.SS2.p3.3.m3.1.1.2.cmml" xref="S2.SS2.p3.3.m3.1.1.2">𝐼</ci><ci id="S2.SS2.p3.3.m3.1.1.3.cmml" xref="S2.SS2.p3.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.3.m3.1c">I_{s}</annotation></semantics></math> represents the synthetic image <math id="S2.SS2.p3.4.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS2.p3.4.m4.1a"><mi id="S2.SS2.p3.4.m4.1.1" xref="S2.SS2.p3.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.4.m4.1b"><ci id="S2.SS2.p3.4.m4.1.1.cmml" xref="S2.SS2.p3.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.4.m4.1c">s</annotation></semantics></math>, <math id="S2.SS2.p3.5.m5.1" class="ltx_Math" alttext="\theta_{DP-FL}" display="inline"><semantics id="S2.SS2.p3.5.m5.1a"><msub id="S2.SS2.p3.5.m5.1.1" xref="S2.SS2.p3.5.m5.1.1.cmml"><mi id="S2.SS2.p3.5.m5.1.1.2" xref="S2.SS2.p3.5.m5.1.1.2.cmml">θ</mi><mrow id="S2.SS2.p3.5.m5.1.1.3" xref="S2.SS2.p3.5.m5.1.1.3.cmml"><mrow id="S2.SS2.p3.5.m5.1.1.3.2" xref="S2.SS2.p3.5.m5.1.1.3.2.cmml"><mi id="S2.SS2.p3.5.m5.1.1.3.2.2" xref="S2.SS2.p3.5.m5.1.1.3.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.5.m5.1.1.3.2.1" xref="S2.SS2.p3.5.m5.1.1.3.2.1.cmml">​</mo><mi id="S2.SS2.p3.5.m5.1.1.3.2.3" xref="S2.SS2.p3.5.m5.1.1.3.2.3.cmml">P</mi></mrow><mo id="S2.SS2.p3.5.m5.1.1.3.1" xref="S2.SS2.p3.5.m5.1.1.3.1.cmml">−</mo><mrow id="S2.SS2.p3.5.m5.1.1.3.3" xref="S2.SS2.p3.5.m5.1.1.3.3.cmml"><mi id="S2.SS2.p3.5.m5.1.1.3.3.2" xref="S2.SS2.p3.5.m5.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.5.m5.1.1.3.3.1" xref="S2.SS2.p3.5.m5.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p3.5.m5.1.1.3.3.3" xref="S2.SS2.p3.5.m5.1.1.3.3.3.cmml">L</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.5.m5.1b"><apply id="S2.SS2.p3.5.m5.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.5.m5.1.1.1.cmml" xref="S2.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p3.5.m5.1.1.2.cmml" xref="S2.SS2.p3.5.m5.1.1.2">𝜃</ci><apply id="S2.SS2.p3.5.m5.1.1.3.cmml" xref="S2.SS2.p3.5.m5.1.1.3"><minus id="S2.SS2.p3.5.m5.1.1.3.1.cmml" xref="S2.SS2.p3.5.m5.1.1.3.1"></minus><apply id="S2.SS2.p3.5.m5.1.1.3.2.cmml" xref="S2.SS2.p3.5.m5.1.1.3.2"><times id="S2.SS2.p3.5.m5.1.1.3.2.1.cmml" xref="S2.SS2.p3.5.m5.1.1.3.2.1"></times><ci id="S2.SS2.p3.5.m5.1.1.3.2.2.cmml" xref="S2.SS2.p3.5.m5.1.1.3.2.2">𝐷</ci><ci id="S2.SS2.p3.5.m5.1.1.3.2.3.cmml" xref="S2.SS2.p3.5.m5.1.1.3.2.3">𝑃</ci></apply><apply id="S2.SS2.p3.5.m5.1.1.3.3.cmml" xref="S2.SS2.p3.5.m5.1.1.3.3"><times id="S2.SS2.p3.5.m5.1.1.3.3.1.cmml" xref="S2.SS2.p3.5.m5.1.1.3.3.1"></times><ci id="S2.SS2.p3.5.m5.1.1.3.3.2.cmml" xref="S2.SS2.p3.5.m5.1.1.3.3.2">𝐹</ci><ci id="S2.SS2.p3.5.m5.1.1.3.3.3.cmml" xref="S2.SS2.p3.5.m5.1.1.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.5.m5.1c">\theta_{DP-FL}</annotation></semantics></math> represents our model parameters, and <math id="S2.SS2.p3.6.m6.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S2.SS2.p3.6.m6.1a"><mi id="S2.SS2.p3.6.m6.1.1" xref="S2.SS2.p3.6.m6.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.6.m6.1b"><ci id="S2.SS2.p3.6.m6.1.1.cmml" xref="S2.SS2.p3.6.m6.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.6.m6.1c">F</annotation></semantics></math> represents the function that translates the original image into the latent representation. <math id="S2.SS2.p3.7.m7.1" class="ltx_Math" alttext="d_{DP-FL}" display="inline"><semantics id="S2.SS2.p3.7.m7.1a"><msub id="S2.SS2.p3.7.m7.1.1" xref="S2.SS2.p3.7.m7.1.1.cmml"><mi id="S2.SS2.p3.7.m7.1.1.2" xref="S2.SS2.p3.7.m7.1.1.2.cmml">d</mi><mrow id="S2.SS2.p3.7.m7.1.1.3" xref="S2.SS2.p3.7.m7.1.1.3.cmml"><mrow id="S2.SS2.p3.7.m7.1.1.3.2" xref="S2.SS2.p3.7.m7.1.1.3.2.cmml"><mi id="S2.SS2.p3.7.m7.1.1.3.2.2" xref="S2.SS2.p3.7.m7.1.1.3.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.7.m7.1.1.3.2.1" xref="S2.SS2.p3.7.m7.1.1.3.2.1.cmml">​</mo><mi id="S2.SS2.p3.7.m7.1.1.3.2.3" xref="S2.SS2.p3.7.m7.1.1.3.2.3.cmml">P</mi></mrow><mo id="S2.SS2.p3.7.m7.1.1.3.1" xref="S2.SS2.p3.7.m7.1.1.3.1.cmml">−</mo><mrow id="S2.SS2.p3.7.m7.1.1.3.3" xref="S2.SS2.p3.7.m7.1.1.3.3.cmml"><mi id="S2.SS2.p3.7.m7.1.1.3.3.2" xref="S2.SS2.p3.7.m7.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S2.SS2.p3.7.m7.1.1.3.3.1" xref="S2.SS2.p3.7.m7.1.1.3.3.1.cmml">​</mo><mi id="S2.SS2.p3.7.m7.1.1.3.3.3" xref="S2.SS2.p3.7.m7.1.1.3.3.3.cmml">L</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p3.7.m7.1b"><apply id="S2.SS2.p3.7.m7.1.1.cmml" xref="S2.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS2.p3.7.m7.1.1.1.cmml" xref="S2.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S2.SS2.p3.7.m7.1.1.2.cmml" xref="S2.SS2.p3.7.m7.1.1.2">𝑑</ci><apply id="S2.SS2.p3.7.m7.1.1.3.cmml" xref="S2.SS2.p3.7.m7.1.1.3"><minus id="S2.SS2.p3.7.m7.1.1.3.1.cmml" xref="S2.SS2.p3.7.m7.1.1.3.1"></minus><apply id="S2.SS2.p3.7.m7.1.1.3.2.cmml" xref="S2.SS2.p3.7.m7.1.1.3.2"><times id="S2.SS2.p3.7.m7.1.1.3.2.1.cmml" xref="S2.SS2.p3.7.m7.1.1.3.2.1"></times><ci id="S2.SS2.p3.7.m7.1.1.3.2.2.cmml" xref="S2.SS2.p3.7.m7.1.1.3.2.2">𝐷</ci><ci id="S2.SS2.p3.7.m7.1.1.3.2.3.cmml" xref="S2.SS2.p3.7.m7.1.1.3.2.3">𝑃</ci></apply><apply id="S2.SS2.p3.7.m7.1.1.3.3.cmml" xref="S2.SS2.p3.7.m7.1.1.3.3"><times id="S2.SS2.p3.7.m7.1.1.3.3.1.cmml" xref="S2.SS2.p3.7.m7.1.1.3.3.1"></times><ci id="S2.SS2.p3.7.m7.1.1.3.3.2.cmml" xref="S2.SS2.p3.7.m7.1.1.3.3.2">𝐹</ci><ci id="S2.SS2.p3.7.m7.1.1.3.3.3.cmml" xref="S2.SS2.p3.7.m7.1.1.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p3.7.m7.1c">d_{DP-FL}</annotation></semantics></math> is computed for all the images from the synthetic dataset.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Evaluation</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p"><span id="S2.SS3.p1.1.1" class="ltx_text ltx_font_bold">Baselines:</span> We considered a baseline for classification performance and a baseline for image retrieval. To provide an upper bound on the classification performance that could be achieved, we trained the same exact discriminative model but in a centralized setting (i.e., without the difficulties introduced by the different local distributions and differential privacy). As our retrieval baseline, we considered the standard structural similarity index measure (SSIM). The SSIM was computed between the query image and the retrieved case-based explanations. Since higher SSIM values represent higher similarity, images with higher SSIM were ranked first.</p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.5" class="ltx_p"><span id="S2.SS3.p2.5.1" class="ltx_text ltx_font_bold">Metrics:</span> Due to the imbalance of the dataset, classification performance was measured by the F1-score. The quality of the retrieval was quantitatively evaluated by computing the normalised Discounted Cumulative Gain (nDCG) (Eq. <a href="#S2.E2" title="In II-C Evaluation ‣ II MATERIALS AND METHODS ‣ Towards Case-based Interpretability for Medical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) of the retrieval model ranking, compared to the ground truth ranking of the radiologist. <math id="S2.SS3.p2.1.m1.1" class="ltx_Math" alttext="IDCG_{p}" display="inline"><semantics id="S2.SS3.p2.1.m1.1a"><mrow id="S2.SS3.p2.1.m1.1.1" xref="S2.SS3.p2.1.m1.1.1.cmml"><mi id="S2.SS3.p2.1.m1.1.1.2" xref="S2.SS3.p2.1.m1.1.1.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.1.m1.1.1.1" xref="S2.SS3.p2.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS3.p2.1.m1.1.1.3" xref="S2.SS3.p2.1.m1.1.1.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.1.m1.1.1.1a" xref="S2.SS3.p2.1.m1.1.1.1.cmml">​</mo><mi id="S2.SS3.p2.1.m1.1.1.4" xref="S2.SS3.p2.1.m1.1.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.1.m1.1.1.1b" xref="S2.SS3.p2.1.m1.1.1.1.cmml">​</mo><msub id="S2.SS3.p2.1.m1.1.1.5" xref="S2.SS3.p2.1.m1.1.1.5.cmml"><mi id="S2.SS3.p2.1.m1.1.1.5.2" xref="S2.SS3.p2.1.m1.1.1.5.2.cmml">G</mi><mi id="S2.SS3.p2.1.m1.1.1.5.3" xref="S2.SS3.p2.1.m1.1.1.5.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.1.m1.1b"><apply id="S2.SS3.p2.1.m1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1"><times id="S2.SS3.p2.1.m1.1.1.1.cmml" xref="S2.SS3.p2.1.m1.1.1.1"></times><ci id="S2.SS3.p2.1.m1.1.1.2.cmml" xref="S2.SS3.p2.1.m1.1.1.2">𝐼</ci><ci id="S2.SS3.p2.1.m1.1.1.3.cmml" xref="S2.SS3.p2.1.m1.1.1.3">𝐷</ci><ci id="S2.SS3.p2.1.m1.1.1.4.cmml" xref="S2.SS3.p2.1.m1.1.1.4">𝐶</ci><apply id="S2.SS3.p2.1.m1.1.1.5.cmml" xref="S2.SS3.p2.1.m1.1.1.5"><csymbol cd="ambiguous" id="S2.SS3.p2.1.m1.1.1.5.1.cmml" xref="S2.SS3.p2.1.m1.1.1.5">subscript</csymbol><ci id="S2.SS3.p2.1.m1.1.1.5.2.cmml" xref="S2.SS3.p2.1.m1.1.1.5.2">𝐺</ci><ci id="S2.SS3.p2.1.m1.1.1.5.3.cmml" xref="S2.SS3.p2.1.m1.1.1.5.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.1.m1.1c">IDCG_{p}</annotation></semantics></math> is the maximum possible value of the DCG metric, obtained when the ranking of the method is exactly the same as our ground truth. The subscript <math id="S2.SS3.p2.2.m2.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.SS3.p2.2.m2.1a"><mi id="S2.SS3.p2.2.m2.1.1" xref="S2.SS3.p2.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.2.m2.1b"><ci id="S2.SS3.p2.2.m2.1.1.cmml" xref="S2.SS3.p2.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.2.m2.1c">p</annotation></semantics></math> is the number of retrieved images considered for the evaluation (e.g., <math id="S2.SS3.p2.3.m3.1" class="ltx_Math" alttext="p=9" display="inline"><semantics id="S2.SS3.p2.3.m3.1a"><mrow id="S2.SS3.p2.3.m3.1.1" xref="S2.SS3.p2.3.m3.1.1.cmml"><mi id="S2.SS3.p2.3.m3.1.1.2" xref="S2.SS3.p2.3.m3.1.1.2.cmml">p</mi><mo id="S2.SS3.p2.3.m3.1.1.1" xref="S2.SS3.p2.3.m3.1.1.1.cmml">=</mo><mn id="S2.SS3.p2.3.m3.1.1.3" xref="S2.SS3.p2.3.m3.1.1.3.cmml">9</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.3.m3.1b"><apply id="S2.SS3.p2.3.m3.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1"><eq id="S2.SS3.p2.3.m3.1.1.1.cmml" xref="S2.SS3.p2.3.m3.1.1.1"></eq><ci id="S2.SS3.p2.3.m3.1.1.2.cmml" xref="S2.SS3.p2.3.m3.1.1.2">𝑝</ci><cn type="integer" id="S2.SS3.p2.3.m3.1.1.3.cmml" xref="S2.SS3.p2.3.m3.1.1.3">9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.3.m3.1c">p=9</annotation></semantics></math>). Finally, <math id="S2.SS3.p2.4.m4.1" class="ltx_Math" alttext="rel_{i}" display="inline"><semantics id="S2.SS3.p2.4.m4.1a"><mrow id="S2.SS3.p2.4.m4.1.1" xref="S2.SS3.p2.4.m4.1.1.cmml"><mi id="S2.SS3.p2.4.m4.1.1.2" xref="S2.SS3.p2.4.m4.1.1.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.4.m4.1.1.1" xref="S2.SS3.p2.4.m4.1.1.1.cmml">​</mo><mi id="S2.SS3.p2.4.m4.1.1.3" xref="S2.SS3.p2.4.m4.1.1.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.SS3.p2.4.m4.1.1.1a" xref="S2.SS3.p2.4.m4.1.1.1.cmml">​</mo><msub id="S2.SS3.p2.4.m4.1.1.4" xref="S2.SS3.p2.4.m4.1.1.4.cmml"><mi id="S2.SS3.p2.4.m4.1.1.4.2" xref="S2.SS3.p2.4.m4.1.1.4.2.cmml">l</mi><mi id="S2.SS3.p2.4.m4.1.1.4.3" xref="S2.SS3.p2.4.m4.1.1.4.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.4.m4.1b"><apply id="S2.SS3.p2.4.m4.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1"><times id="S2.SS3.p2.4.m4.1.1.1.cmml" xref="S2.SS3.p2.4.m4.1.1.1"></times><ci id="S2.SS3.p2.4.m4.1.1.2.cmml" xref="S2.SS3.p2.4.m4.1.1.2">𝑟</ci><ci id="S2.SS3.p2.4.m4.1.1.3.cmml" xref="S2.SS3.p2.4.m4.1.1.3">𝑒</ci><apply id="S2.SS3.p2.4.m4.1.1.4.cmml" xref="S2.SS3.p2.4.m4.1.1.4"><csymbol cd="ambiguous" id="S2.SS3.p2.4.m4.1.1.4.1.cmml" xref="S2.SS3.p2.4.m4.1.1.4">subscript</csymbol><ci id="S2.SS3.p2.4.m4.1.1.4.2.cmml" xref="S2.SS3.p2.4.m4.1.1.4.2">𝑙</ci><ci id="S2.SS3.p2.4.m4.1.1.4.3.cmml" xref="S2.SS3.p2.4.m4.1.1.4.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.4.m4.1c">rel_{i}</annotation></semantics></math> represents the relevance value assigned to the ranking position <math id="S2.SS3.p2.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.SS3.p2.5.m5.1a"><mi id="S2.SS3.p2.5.m5.1.1" xref="S2.SS3.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.p2.5.m5.1b"><ci id="S2.SS3.p2.5.m5.1.1.cmml" xref="S2.SS3.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.p2.5.m5.1c">i</annotation></semantics></math>, with the least similar image having a relevance of 1 and the most similar image having a relevance of 5.</p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\displaystyle nDCG_{p}" display="inline"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mi id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml">​</mo><mi id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1a" xref="S2.E2.m1.1.1.1.cmml">​</mo><mi id="S2.E2.m1.1.1.4" xref="S2.E2.m1.1.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1b" xref="S2.E2.m1.1.1.1.cmml">​</mo><msub id="S2.E2.m1.1.1.5" xref="S2.E2.m1.1.1.5.cmml"><mi id="S2.E2.m1.1.1.5.2" xref="S2.E2.m1.1.1.5.2.cmml">G</mi><mi id="S2.E2.m1.1.1.5.3" xref="S2.E2.m1.1.1.5.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><times id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"></times><ci id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2">𝑛</ci><ci id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3">𝐷</ci><ci id="S2.E2.m1.1.1.4.cmml" xref="S2.E2.m1.1.1.4">𝐶</ci><apply id="S2.E2.m1.1.1.5.cmml" xref="S2.E2.m1.1.1.5"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.5.1.cmml" xref="S2.E2.m1.1.1.5">subscript</csymbol><ci id="S2.E2.m1.1.1.5.2.cmml" xref="S2.E2.m1.1.1.5.2">𝐺</ci><ci id="S2.E2.m1.1.1.5.3.cmml" xref="S2.E2.m1.1.1.5.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle nDCG_{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2.m2.1" class="ltx_Math" alttext="\displaystyle=\frac{DCG_{p}}{IDCG_{p}}" display="inline"><semantics id="S2.E2.m2.1a"><mrow id="S2.E2.m2.1.1" xref="S2.E2.m2.1.1.cmml"><mi id="S2.E2.m2.1.1.2" xref="S2.E2.m2.1.1.2.cmml"></mi><mo id="S2.E2.m2.1.1.1" xref="S2.E2.m2.1.1.1.cmml">=</mo><mstyle displaystyle="true" id="S2.E2.m2.1.1.3" xref="S2.E2.m2.1.1.3.cmml"><mfrac id="S2.E2.m2.1.1.3a" xref="S2.E2.m2.1.1.3.cmml"><mrow id="S2.E2.m2.1.1.3.2" xref="S2.E2.m2.1.1.3.2.cmml"><mi id="S2.E2.m2.1.1.3.2.2" xref="S2.E2.m2.1.1.3.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.E2.m2.1.1.3.2.1" xref="S2.E2.m2.1.1.3.2.1.cmml">​</mo><mi id="S2.E2.m2.1.1.3.2.3" xref="S2.E2.m2.1.1.3.2.3.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E2.m2.1.1.3.2.1a" xref="S2.E2.m2.1.1.3.2.1.cmml">​</mo><msub id="S2.E2.m2.1.1.3.2.4" xref="S2.E2.m2.1.1.3.2.4.cmml"><mi id="S2.E2.m2.1.1.3.2.4.2" xref="S2.E2.m2.1.1.3.2.4.2.cmml">G</mi><mi id="S2.E2.m2.1.1.3.2.4.3" xref="S2.E2.m2.1.1.3.2.4.3.cmml">p</mi></msub></mrow><mrow id="S2.E2.m2.1.1.3.3" xref="S2.E2.m2.1.1.3.3.cmml"><mi id="S2.E2.m2.1.1.3.3.2" xref="S2.E2.m2.1.1.3.3.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="S2.E2.m2.1.1.3.3.1" xref="S2.E2.m2.1.1.3.3.1.cmml">​</mo><mi id="S2.E2.m2.1.1.3.3.3" xref="S2.E2.m2.1.1.3.3.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.E2.m2.1.1.3.3.1a" xref="S2.E2.m2.1.1.3.3.1.cmml">​</mo><mi id="S2.E2.m2.1.1.3.3.4" xref="S2.E2.m2.1.1.3.3.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E2.m2.1.1.3.3.1b" xref="S2.E2.m2.1.1.3.3.1.cmml">​</mo><msub id="S2.E2.m2.1.1.3.3.5" xref="S2.E2.m2.1.1.3.3.5.cmml"><mi id="S2.E2.m2.1.1.3.3.5.2" xref="S2.E2.m2.1.1.3.3.5.2.cmml">G</mi><mi id="S2.E2.m2.1.1.3.3.5.3" xref="S2.E2.m2.1.1.3.3.5.3.cmml">p</mi></msub></mrow></mfrac></mstyle></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m2.1b"><apply id="S2.E2.m2.1.1.cmml" xref="S2.E2.m2.1.1"><eq id="S2.E2.m2.1.1.1.cmml" xref="S2.E2.m2.1.1.1"></eq><csymbol cd="latexml" id="S2.E2.m2.1.1.2.cmml" xref="S2.E2.m2.1.1.2">absent</csymbol><apply id="S2.E2.m2.1.1.3.cmml" xref="S2.E2.m2.1.1.3"><divide id="S2.E2.m2.1.1.3.1.cmml" xref="S2.E2.m2.1.1.3"></divide><apply id="S2.E2.m2.1.1.3.2.cmml" xref="S2.E2.m2.1.1.3.2"><times id="S2.E2.m2.1.1.3.2.1.cmml" xref="S2.E2.m2.1.1.3.2.1"></times><ci id="S2.E2.m2.1.1.3.2.2.cmml" xref="S2.E2.m2.1.1.3.2.2">𝐷</ci><ci id="S2.E2.m2.1.1.3.2.3.cmml" xref="S2.E2.m2.1.1.3.2.3">𝐶</ci><apply id="S2.E2.m2.1.1.3.2.4.cmml" xref="S2.E2.m2.1.1.3.2.4"><csymbol cd="ambiguous" id="S2.E2.m2.1.1.3.2.4.1.cmml" xref="S2.E2.m2.1.1.3.2.4">subscript</csymbol><ci id="S2.E2.m2.1.1.3.2.4.2.cmml" xref="S2.E2.m2.1.1.3.2.4.2">𝐺</ci><ci id="S2.E2.m2.1.1.3.2.4.3.cmml" xref="S2.E2.m2.1.1.3.2.4.3">𝑝</ci></apply></apply><apply id="S2.E2.m2.1.1.3.3.cmml" xref="S2.E2.m2.1.1.3.3"><times id="S2.E2.m2.1.1.3.3.1.cmml" xref="S2.E2.m2.1.1.3.3.1"></times><ci id="S2.E2.m2.1.1.3.3.2.cmml" xref="S2.E2.m2.1.1.3.3.2">𝐼</ci><ci id="S2.E2.m2.1.1.3.3.3.cmml" xref="S2.E2.m2.1.1.3.3.3">𝐷</ci><ci id="S2.E2.m2.1.1.3.3.4.cmml" xref="S2.E2.m2.1.1.3.3.4">𝐶</ci><apply id="S2.E2.m2.1.1.3.3.5.cmml" xref="S2.E2.m2.1.1.3.3.5"><csymbol cd="ambiguous" id="S2.E2.m2.1.1.3.3.5.1.cmml" xref="S2.E2.m2.1.1.3.3.5">subscript</csymbol><ci id="S2.E2.m2.1.1.3.3.5.2.cmml" xref="S2.E2.m2.1.1.3.3.5.2">𝐺</ci><ci id="S2.E2.m2.1.1.3.3.5.3.cmml" xref="S2.E2.m2.1.1.3.3.5.3">𝑝</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m2.1c">\displaystyle=\frac{DCG_{p}}{IDCG_{p}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.1" class="ltx_Math" alttext="\displaystyle\text{where }DCG_{p}" display="inline"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mtext id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2a.cmml">where </mtext><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.cmml">​</mo><mi id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml">D</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1a" xref="S2.E3.m1.1.1.1.cmml">​</mo><mi id="S2.E3.m1.1.1.4" xref="S2.E3.m1.1.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.1.1.1b" xref="S2.E3.m1.1.1.1.cmml">​</mo><msub id="S2.E3.m1.1.1.5" xref="S2.E3.m1.1.1.5.cmml"><mi id="S2.E3.m1.1.1.5.2" xref="S2.E3.m1.1.1.5.2.cmml">G</mi><mi id="S2.E3.m1.1.1.5.3" xref="S2.E3.m1.1.1.5.3.cmml">p</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><times id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"></times><ci id="S2.E3.m1.1.1.2a.cmml" xref="S2.E3.m1.1.1.2"><mtext id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2">where </mtext></ci><ci id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3">𝐷</ci><ci id="S2.E3.m1.1.1.4.cmml" xref="S2.E3.m1.1.1.4">𝐶</ci><apply id="S2.E3.m1.1.1.5.cmml" xref="S2.E3.m1.1.1.5"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.5.1.cmml" xref="S2.E3.m1.1.1.5">subscript</csymbol><ci id="S2.E3.m1.1.1.5.2.cmml" xref="S2.E3.m1.1.1.5.2">𝐺</ci><ci id="S2.E3.m1.1.1.5.3.cmml" xref="S2.E3.m1.1.1.5.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\text{where }DCG_{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.1" class="ltx_Math" alttext="\displaystyle=\sum_{i=1}^{p}\frac{2^{rel_{i}}-1}{log_{2}(i+1)}" display="inline"><semantics id="S2.E3.m2.1a"><mrow id="S2.E3.m2.1.2" xref="S2.E3.m2.1.2.cmml"><mi id="S2.E3.m2.1.2.2" xref="S2.E3.m2.1.2.2.cmml"></mi><mo id="S2.E3.m2.1.2.1" xref="S2.E3.m2.1.2.1.cmml">=</mo><mrow id="S2.E3.m2.1.2.3" xref="S2.E3.m2.1.2.3.cmml"><mstyle displaystyle="true" id="S2.E3.m2.1.2.3.1" xref="S2.E3.m2.1.2.3.1.cmml"><munderover id="S2.E3.m2.1.2.3.1a" xref="S2.E3.m2.1.2.3.1.cmml"><mo movablelimits="false" id="S2.E3.m2.1.2.3.1.2.2" xref="S2.E3.m2.1.2.3.1.2.2.cmml">∑</mo><mrow id="S2.E3.m2.1.2.3.1.2.3" xref="S2.E3.m2.1.2.3.1.2.3.cmml"><mi id="S2.E3.m2.1.2.3.1.2.3.2" xref="S2.E3.m2.1.2.3.1.2.3.2.cmml">i</mi><mo id="S2.E3.m2.1.2.3.1.2.3.1" xref="S2.E3.m2.1.2.3.1.2.3.1.cmml">=</mo><mn id="S2.E3.m2.1.2.3.1.2.3.3" xref="S2.E3.m2.1.2.3.1.2.3.3.cmml">1</mn></mrow><mi id="S2.E3.m2.1.2.3.1.3" xref="S2.E3.m2.1.2.3.1.3.cmml">p</mi></munderover></mstyle><mstyle displaystyle="true" id="S2.E3.m2.1.1" xref="S2.E3.m2.1.1.cmml"><mfrac id="S2.E3.m2.1.1a" xref="S2.E3.m2.1.1.cmml"><mrow id="S2.E3.m2.1.1.3" xref="S2.E3.m2.1.1.3.cmml"><msup id="S2.E3.m2.1.1.3.2" xref="S2.E3.m2.1.1.3.2.cmml"><mn id="S2.E3.m2.1.1.3.2.2" xref="S2.E3.m2.1.1.3.2.2.cmml">2</mn><mrow id="S2.E3.m2.1.1.3.2.3" xref="S2.E3.m2.1.1.3.2.3.cmml"><mi id="S2.E3.m2.1.1.3.2.3.2" xref="S2.E3.m2.1.1.3.2.3.2.cmml">r</mi><mo lspace="0em" rspace="0em" id="S2.E3.m2.1.1.3.2.3.1" xref="S2.E3.m2.1.1.3.2.3.1.cmml">​</mo><mi id="S2.E3.m2.1.1.3.2.3.3" xref="S2.E3.m2.1.1.3.2.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S2.E3.m2.1.1.3.2.3.1a" xref="S2.E3.m2.1.1.3.2.3.1.cmml">​</mo><msub id="S2.E3.m2.1.1.3.2.3.4" xref="S2.E3.m2.1.1.3.2.3.4.cmml"><mi id="S2.E3.m2.1.1.3.2.3.4.2" xref="S2.E3.m2.1.1.3.2.3.4.2.cmml">l</mi><mi id="S2.E3.m2.1.1.3.2.3.4.3" xref="S2.E3.m2.1.1.3.2.3.4.3.cmml">i</mi></msub></mrow></msup><mo id="S2.E3.m2.1.1.3.1" xref="S2.E3.m2.1.1.3.1.cmml">−</mo><mn id="S2.E3.m2.1.1.3.3" xref="S2.E3.m2.1.1.3.3.cmml">1</mn></mrow><mrow id="S2.E3.m2.1.1.1" xref="S2.E3.m2.1.1.1.cmml"><mi id="S2.E3.m2.1.1.1.3" xref="S2.E3.m2.1.1.1.3.cmml">l</mi><mo lspace="0em" rspace="0em" id="S2.E3.m2.1.1.1.2" xref="S2.E3.m2.1.1.1.2.cmml">​</mo><mi id="S2.E3.m2.1.1.1.4" xref="S2.E3.m2.1.1.1.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E3.m2.1.1.1.2a" xref="S2.E3.m2.1.1.1.2.cmml">​</mo><msub id="S2.E3.m2.1.1.1.5" xref="S2.E3.m2.1.1.1.5.cmml"><mi id="S2.E3.m2.1.1.1.5.2" xref="S2.E3.m2.1.1.1.5.2.cmml">g</mi><mn id="S2.E3.m2.1.1.1.5.3" xref="S2.E3.m2.1.1.1.5.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S2.E3.m2.1.1.1.2b" xref="S2.E3.m2.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m2.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m2.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m2.1.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.cmml"><mi id="S2.E3.m2.1.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.1.2.cmml">i</mi><mo id="S2.E3.m2.1.1.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.E3.m2.1.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S2.E3.m2.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.1b"><apply id="S2.E3.m2.1.2.cmml" xref="S2.E3.m2.1.2"><eq id="S2.E3.m2.1.2.1.cmml" xref="S2.E3.m2.1.2.1"></eq><csymbol cd="latexml" id="S2.E3.m2.1.2.2.cmml" xref="S2.E3.m2.1.2.2">absent</csymbol><apply id="S2.E3.m2.1.2.3.cmml" xref="S2.E3.m2.1.2.3"><apply id="S2.E3.m2.1.2.3.1.cmml" xref="S2.E3.m2.1.2.3.1"><csymbol cd="ambiguous" id="S2.E3.m2.1.2.3.1.1.cmml" xref="S2.E3.m2.1.2.3.1">superscript</csymbol><apply id="S2.E3.m2.1.2.3.1.2.cmml" xref="S2.E3.m2.1.2.3.1"><csymbol cd="ambiguous" id="S2.E3.m2.1.2.3.1.2.1.cmml" xref="S2.E3.m2.1.2.3.1">subscript</csymbol><sum id="S2.E3.m2.1.2.3.1.2.2.cmml" xref="S2.E3.m2.1.2.3.1.2.2"></sum><apply id="S2.E3.m2.1.2.3.1.2.3.cmml" xref="S2.E3.m2.1.2.3.1.2.3"><eq id="S2.E3.m2.1.2.3.1.2.3.1.cmml" xref="S2.E3.m2.1.2.3.1.2.3.1"></eq><ci id="S2.E3.m2.1.2.3.1.2.3.2.cmml" xref="S2.E3.m2.1.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S2.E3.m2.1.2.3.1.2.3.3.cmml" xref="S2.E3.m2.1.2.3.1.2.3.3">1</cn></apply></apply><ci id="S2.E3.m2.1.2.3.1.3.cmml" xref="S2.E3.m2.1.2.3.1.3">𝑝</ci></apply><apply id="S2.E3.m2.1.1.cmml" xref="S2.E3.m2.1.1"><divide id="S2.E3.m2.1.1.2.cmml" xref="S2.E3.m2.1.1"></divide><apply id="S2.E3.m2.1.1.3.cmml" xref="S2.E3.m2.1.1.3"><minus id="S2.E3.m2.1.1.3.1.cmml" xref="S2.E3.m2.1.1.3.1"></minus><apply id="S2.E3.m2.1.1.3.2.cmml" xref="S2.E3.m2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.3.2.1.cmml" xref="S2.E3.m2.1.1.3.2">superscript</csymbol><cn type="integer" id="S2.E3.m2.1.1.3.2.2.cmml" xref="S2.E3.m2.1.1.3.2.2">2</cn><apply id="S2.E3.m2.1.1.3.2.3.cmml" xref="S2.E3.m2.1.1.3.2.3"><times id="S2.E3.m2.1.1.3.2.3.1.cmml" xref="S2.E3.m2.1.1.3.2.3.1"></times><ci id="S2.E3.m2.1.1.3.2.3.2.cmml" xref="S2.E3.m2.1.1.3.2.3.2">𝑟</ci><ci id="S2.E3.m2.1.1.3.2.3.3.cmml" xref="S2.E3.m2.1.1.3.2.3.3">𝑒</ci><apply id="S2.E3.m2.1.1.3.2.3.4.cmml" xref="S2.E3.m2.1.1.3.2.3.4"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.3.2.3.4.1.cmml" xref="S2.E3.m2.1.1.3.2.3.4">subscript</csymbol><ci id="S2.E3.m2.1.1.3.2.3.4.2.cmml" xref="S2.E3.m2.1.1.3.2.3.4.2">𝑙</ci><ci id="S2.E3.m2.1.1.3.2.3.4.3.cmml" xref="S2.E3.m2.1.1.3.2.3.4.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S2.E3.m2.1.1.3.3.cmml" xref="S2.E3.m2.1.1.3.3">1</cn></apply><apply id="S2.E3.m2.1.1.1.cmml" xref="S2.E3.m2.1.1.1"><times id="S2.E3.m2.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.2"></times><ci id="S2.E3.m2.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.3">𝑙</ci><ci id="S2.E3.m2.1.1.1.4.cmml" xref="S2.E3.m2.1.1.1.4">𝑜</ci><apply id="S2.E3.m2.1.1.1.5.cmml" xref="S2.E3.m2.1.1.1.5"><csymbol cd="ambiguous" id="S2.E3.m2.1.1.1.5.1.cmml" xref="S2.E3.m2.1.1.1.5">subscript</csymbol><ci id="S2.E3.m2.1.1.1.5.2.cmml" xref="S2.E3.m2.1.1.1.5.2">𝑔</ci><cn type="integer" id="S2.E3.m2.1.1.1.5.3.cmml" xref="S2.E3.m2.1.1.1.5.3">2</cn></apply><apply id="S2.E3.m2.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1"><plus id="S2.E3.m2.1.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1.1"></plus><ci id="S2.E3.m2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.1.1.2">𝑖</ci><cn type="integer" id="S2.E3.m2.1.1.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.1c">\displaystyle=\sum_{i=1}^{p}\frac{2^{rel_{i}}-1}{log_{2}(i+1)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">RESULTS</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We performed pleural effusion classification experiments considering a baseline centralized approach and the developed federated model. As expected, due to the distinct client distributions and inclusion of differential privacy, the federated learning model led to slightly worse results (Table <a href="#S3.T1" title="TABLE I ‣ III RESULTS ‣ Towards Case-based Interpretability for Medical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>). We also generated saliency maps for both models by computing the SHAP values <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. As can be observed in Fig. <a href="#S3.F2" title="Figure 2 ‣ III RESULTS ‣ Towards Case-based Interpretability for Medical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, when correctly predicting a pleural effusion case, both models highlighted the same regions.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>F1-score for the centralized model and the federated model in the in-distribution test set and out-of-distribution test set.</figcaption>
<table id="S3.T1.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.2.3.1" class="ltx_tr">
<td id="S3.T1.2.3.1.1" class="ltx_td ltx_border_r" colspan="2"></td>
<td id="S3.T1.2.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">In-distribution</td>
<td id="S3.T1.2.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Out-of-distr.</td>
<td id="S3.T1.2.3.1.4" class="ltx_td"></td>
</tr>
<tr id="S3.T1.2.4.2" class="ltx_tr">
<td id="S3.T1.2.4.2.1" class="ltx_td ltx_border_r" rowspan="2"></td>
<td id="S3.T1.2.4.2.2" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">Centralized Model</td>
<td id="S3.T1.2.4.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.2.4.2.3.1" class="ltx_text ltx_font_bold">0.857</span></td>
<td id="S3.T1.2.4.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.2.4.2.4.1" class="ltx_text ltx_font_bold">0.864</span></td>
<td id="S3.T1.2.4.2.5" class="ltx_td"></td>
</tr>
<tr id="S3.T1.2.2" class="ltx_tr">
<td id="S3.T1.2.2.3" class="ltx_td ltx_align_left ltx_border_b ltx_border_r ltx_border_t">Federated Model</td>
<td id="S3.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><math id="S3.T1.1.1.1.m1.1" class="ltx_Math" alttext="0.716" display="inline"><semantics id="S3.T1.1.1.1.m1.1a"><mn id="S3.T1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.m1.1.1.cmml">0.716</mn><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.m1.1b"><cn type="float" id="S3.T1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.m1.1.1">0.716</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.m1.1c">0.716</annotation></semantics></math></td>
<td id="S3.T1.2.2.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><math id="S3.T1.2.2.2.m1.1" class="ltx_Math" alttext="0.781" display="inline"><semantics id="S3.T1.2.2.2.m1.1a"><mn id="S3.T1.2.2.2.m1.1.1" xref="S3.T1.2.2.2.m1.1.1.cmml">0.781</mn><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.m1.1b"><cn type="float" id="S3.T1.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.m1.1.1">0.781</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.m1.1c">0.781</annotation></semantics></math></td>
<td id="S3.T1.2.2.4" class="ltx_td"></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S3.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S3.F2.1" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:195.1pt;">
<p id="S3.F2.1.1" class="ltx_p ltx_align_center"><span id="S3.F2.1.1.1" class="ltx_text"><img src="/html/2408.13626/assets/figures/centralised.png" id="S3.F2.1.1.1.g1" class="ltx_graphics ltx_img_square" width="157" height="174" alt="Refer to caption"></span></p>
<p id="S3.F2.1.2" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F2.1.2.1" class="ltx_text">(a) Centralised Model</span></p>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S3.F2.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:195.1pt;">
<p id="S3.F2.2.1" class="ltx_p ltx_align_center"><span id="S3.F2.2.1.1" class="ltx_text"><img src="/html/2408.13626/assets/figures/federated.png" id="S3.F2.2.1.1.g1" class="ltx_graphics ltx_img_square" width="157" height="174" alt="Refer to caption"></span></p>
<p id="S3.F2.2.2" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F2.2.2.1" class="ltx_text">(b) Federated Model</span></p>
</div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>SHAP saliency maps for true positive test samples.</figcaption>
</figure>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">To evaluate the performance of the retrieval task, we considered 5 query images (1 negative and 4 positive) randomly chosen from the MIMIC test set. The pleural effusion prediction and 9 possible case-based explanations (3 from each client) for each query image were returned by our DP-FL model. Afterwards, the possible case-based explanations were assessed by a radiologist regarding two properties: realism and explanatory evidence.
The radiologist was asked to label all the images, the queries and the case-based explanations, and assess their quality (or realism) for a proper pleural effusion diagnosis. Moreover, the radiologist also provided our ground truth by ranking the associated case-based explanations in relation to each of the test/query images, considering the similarity in terms of disease severity. During the qualitative evaluation by the radiologist, none of the samples was considered unreal or generated; the radiologist didn’t realized the assessment was on AI generated images, and only considered that the quality was not very high, but comparable to those X-rays obtained in local hospitals. It was also emphasized that some images were cropped in a way that prevented a correct diagnosis of Pleural Effusion in one of the lungs, but this was also observed in two of the query images, indicating that this is a common property in the publicly available datasets, and thus our generative models are exposed to learn it. Fig. <a href="#S3.F3" title="Figure 3 ‣ III RESULTS ‣ Towards Case-based Interpretability for Medical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> presents the Top-4 retrieved results for one of the test/query images. The ranking provided by our model and by SSIM is compared with the ground truth defined by the radiologist. As can be observed, the ranking provided by our model mimics better the ranking of a radiologist than the SSIM. The same was true for all the query images considered, which is shown by the retrieval scores presented in Table <a href="#S3.T2" title="TABLE II ‣ III RESULTS ‣ Towards Case-based Interpretability for Medical Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2408.13626/assets/figures/caseexample.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="348" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Example of a test case and the Top-4 retrieved explanations given by the radiologists (top), our model (DP-FL) and SSIM.</figcaption>
</figure>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE II: </span>nDCG score for Model (normalized Euclidean Distance) and SSIM ranking.</figcaption>
<table id="S3.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.1.1.1" class="ltx_tr">
<th id="S3.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_rr">Case</th>
<th id="S3.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">Proposed Model</th>
<th id="S3.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">SSIM</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.1.2.1" class="ltx_tr">
<th id="S3.T2.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr ltx_border_t">Test Image 1</th>
<td id="S3.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T2.1.2.1.2.1" class="ltx_text ltx_font_bold">0.921</span></td>
<td id="S3.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">0.588</td>
</tr>
<tr id="S3.T2.1.3.2" class="ltx_tr">
<th id="S3.T2.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr">Test Image 2</th>
<td id="S3.T2.1.3.2.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T2.1.3.2.2.1" class="ltx_text ltx_font_bold">0.854</span></td>
<td id="S3.T2.1.3.2.3" class="ltx_td ltx_align_center">0.645</td>
</tr>
<tr id="S3.T2.1.4.3" class="ltx_tr">
<th id="S3.T2.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr">Test Image 3</th>
<td id="S3.T2.1.4.3.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T2.1.4.3.2.1" class="ltx_text ltx_font_bold">0.765</span></td>
<td id="S3.T2.1.4.3.3" class="ltx_td ltx_align_center">0.693</td>
</tr>
<tr id="S3.T2.1.5.4" class="ltx_tr">
<th id="S3.T2.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr">Test Image 4</th>
<td id="S3.T2.1.5.4.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T2.1.5.4.2.1" class="ltx_text ltx_font_bold">0.931</span></td>
<td id="S3.T2.1.5.4.3" class="ltx_td ltx_align_center">0.610</td>
</tr>
<tr id="S3.T2.1.6.5" class="ltx_tr">
<th id="S3.T2.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_rr">Test Image 5</th>
<td id="S3.T2.1.6.5.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T2.1.6.5.2.1" class="ltx_text ltx_font_bold">0.901</span></td>
<td id="S3.T2.1.6.5.3" class="ltx_td ltx_align_center">0.617</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">DISCUSSION AND CONCLUSIONS</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">Ensuring interpretability in the upcoming decentralized federated learning paradigms is paramount to increase trust and allow widespread AI adoption in clinical practice. In the context of radiology, case-based explainability is the most natural interpretability strategy. In this work, we investigated the use of a latent denoising diffusion probabilistic model in a federated chest X-ray classification task, demonstrating its potential to generate realistic and meaningful case-based explanations for a privacy-preserving federated learning discriminative model. While it is established how to retrieve case-based explanations in a standard centralized learning scenario, this is, to the best of our knowledge, the first study that addresses the challenge of generating case-based explanations in a privacy-preserving federated learning setting, where access to the entire data collection is restricted. However, to adopt the proposed method into a real-world medical application, a variety of further research is still needed. Future research should focus on exploring privacy-preserving generative models to guarantee that no identity information present in the client’s data is leaked in the generated images. To be completely compliant with data protection regulations, we must ensure that the synthetic case-based explanations are not too similar to the sensitive training data nor expose identity. That could be done by either adding differential privacy or incorporating adversarial identity loss functions (e.g., <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>) into the training of the generative models.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">ACKNOWLEDGMENT</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">Research at the Netherlands Cancer Institute is supported by grants from the Dutch Cancer Society and the Dutch Ministry of Health, Welfare and Sport. This work is financed by National Funds through the FCT - Fundação para a Ciência e a Tecnologia, I.P. (Portuguese Foundation for Science and Technology) within the project CAGING, with reference 2022.10486.PTDC (DOI 10.54499/2022.10486.PTDC). The authors would like to acknowledge the Research High Performance Computing (RHPC) facility of the Netherlands Cancer Institute (NKI).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
F. Doshi-Velez and B. Kim, “Towards a rigorous science of interpretable machine learning,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1702.08608</em>, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Z. C. Lipton, “The mythos of model interpretability: In machine learning, the concept of interpretability is both important and slippery.” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Queue</em>, vol. 16, no. 3, pp. 31–57, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
W. Silva, A. Poellinger, J. S. Cardoso, and M. Reyes, “Interpretability-guided content-based medical image retrieval,” in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Medical Image Computing and Computer Assisted Intervention–MICCAI 2020: 23rd International Conference, Lima, Peru, October 4–8, 2020, Proceedings, Part I 23</em>.   Springer, 2020, pp. 305–314.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
K. Packhäuser, S. Gündel, N. Münster, C. Syben, V. Christlein, and A. Maier, “Deep learning-based patient re-identification is able to exploit the biometric nature of medical chest x-ray data,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Scientific Reports</em>, vol. 12, no. 1, p. 14851, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
S. Pati, U. Baid, B. Edwards, M. Sheller, S.-H. Wang, G. A. Reina, P. Foley, A. Gruzdev, D. Karkada, C. Davatzikos <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Federated learning enables big data for rare cancer boundary detection,” <em id="bib.bib5.2.2" class="ltx_emph ltx_font_italic">Nature communications</em>, vol. 13, no. 1, p. 7346, 2022.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
N. Rieke, J. Hancox, W. Li, F. Milletari, H. R. Roth, S. Albarqouni, S. Bakas, M. N. Galtier, B. A. Landman, K. Maier-Hein <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “The future of digital health with federated learning,” <em id="bib.bib6.2.2" class="ltx_emph ltx_font_italic">NPJ digital medicine</em>, vol. 3, no. 1, p. 119, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
S. Augenstein, H. B. McMahan, D. Ramage, S. Ramaswamy, P. Kairouz, M. Chen, R. Mathews, and B. A. y Arcas, “Generative models for effective ml on private, decentralized datasets,” in <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
J. Irvin, P. Rajpurkar, M. Ko, Y. Yu, S. Ciurea-Ilcus, C. Chute, H. Marklund, B. Haghgoo, R. Ball, K. Shpanskaya <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Chexpert: A large chest radiograph dataset with uncertainty labels and expert comparison,” in <em id="bib.bib8.2.2" class="ltx_emph ltx_font_italic">Proceedings of the AAAI conference on artificial intelligence</em>, vol. 33, no. 01, 2019, pp. 590–597.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
A. Johnson, M. Lungren, Y. Peng, Z. Lu, R. Mark, S. Berkowitz, and S. Horng, “Mimic-cxr-jpg-chest radiographs with structured labels,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">PhysioNet</em>, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
E. P. Reis, J. P. de Paiva, M. C. da Silva, G. A. Ribeiro, V. F. Paiva, L. Bulgarelli, H. M. Lee, P. V. Santos, V. M. Brito, L. T. Amaral <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Brax, brazilian labeled chest x-ray dataset,” <em id="bib.bib10.2.2" class="ltx_emph ltx_font_italic">Scientific Data</em>, vol. 9, no. 1, p. 487, 2022.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
H. Q. Nguyen, K. Lam, L. T. Le, H. H. Pham, D. Q. Tran, D. B. Nguyen, D. D. Le, C. M. Pham, H. T. Tong, D. H. Dinh <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Vindr-cxr: An open dataset of chest x-rays with radiologist’s annotations,” <em id="bib.bib11.2.2" class="ltx_emph ltx_font_italic">Scientific Data</em>, vol. 9, no. 1, p. 429, 2022.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
G. Huang, Z. Liu, L. Van Der Maaten, and K. Q. Weinberger, “Densely connected convolutional networks,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and pattern recognition</em>, 2017, pp. 4700–4708.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and L. Fei-Fei, “Imagenet: A large-scale hierarchical image database,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">2009 IEEE conference on computer vision and pattern recognition</em>.   Ieee, 2009, pp. 248–255.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas, “Communication-efficient learning of deep networks from decentralized data,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. Abadi, A. Chu, I. Goodfellow, H. B. McMahan, I. Mironov, K. Talwar, and L. Zhang, “Deep learning with differential privacy,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2016 ACM SIGSAC conference on computer and communications security</em>, 2016, pp. 308–318.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
H. B. McMahan, G. Andrew, U. Erlingsson, S. Chien, I. Mironov, N. Papernot, and P. Kairouz, “A general approach to adding differential privacy to iterative training procedures,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.06210</em>, 2018.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
G. Müller-Franzes, J. M. Niehues, F. Khader, S. T. Arasteh, C. Haarburger, C. Kuhl, T. Wang, T. Han, S. Nebelung, J. N. Kather <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Diffusion probabilistic models beat gans on medical images,” <em id="bib.bib17.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2212.07501</em>, 2022.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
S. M. Lundberg and S.-I. Lee, “A unified approach to interpreting model predictions,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, vol. 30, 2017.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
H. Montenegro, W. Silva, and J. S. Cardoso, “Disentangled representation learning for privacy-preserving case-based explanations,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">MICCAI Workshop on Medical Applications with Disentanglements</em>.   Springer, 2022, pp. 33–45.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2408.13625" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2408.13626" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2408.13626">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2408.13626" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2408.13627" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Sep  5 13:27:19 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
