<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2201.11248] Electrical Load Forecasting Using Edge Computing and Federated Learning</title><meta property="og:description" content="In the smart grid, huge amounts of consumption data are used to train deep learning models for applications such as load monitoring and demand response. However, these applications raise concerns regarding security and…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Electrical Load Forecasting Using Edge Computing and Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Electrical Load Forecasting Using Edge Computing and Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2201.11248">

<!--Generated on Wed Mar  6 18:22:20 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Federated Learning; Energy Load Forecasting; Edge Computing; Deep Neural Networks; LSTM; Smart Grid.
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Electrical Load Forecasting Using Edge Computing and Federated Learning
<br class="ltx_break">
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Afaf Taïk and
Soumaya Cherkaoui
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
INTERLAB, Engineering Faculty, Université de Sherbrooke, Canada.
<br class="ltx_break">{afaf.taik, soumaya.cherkaoui}@usherbrooke.ca 
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">In the smart grid, huge amounts of consumption data are used to train deep learning models for applications such as load monitoring and demand response. However, these applications raise concerns regarding security and have high accuracy requirements. In one hand, the data used is privacy-sensitive. For instance, the fine-grained data collected by a smart meter at a consumer’s home may reveal information on the appliances and thus the consumer’s behaviour at home. On the other hand, the deep learning models require big data volumes with enough variety and to be trained adequately. In this paper, we evaluate the use of Edge computing and federated learning, a decentralized machine learning scheme that allows to increase the volume and diversity of data used to train the deep learning models without compromising privacy. This paper reports, to the best of our knowledge, the first use of federated learning for household load forecasting and achieves promising results. The simulations were done using Tensorflow Federated on the data from 200 houses from Texas, USA.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>
Federated Learning; Energy Load Forecasting; Edge Computing; Deep Neural Networks; LSTM; Smart Grid.

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Load forecasting is an essential part of the development of the smart grid. Long-term load forecasting is deemed necessary for infrastructure planning, while mid-term and short-term load forecasting are key tasks in system operations <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.
Day-to-day operational efficiency of electrical power delivery, in particular, requires an accurate prediction of short-term load profiles, which is based on collecting and analysing large volumes of high-resolution data from households. However, individual short-term load forecasting (STLF) has been proven to be a challenging task because of profile volatility. In fact, the electrical load of a house has a high correlation to its residents’ behaviour, which is too stochastic and often hard to predict <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Benchmarks for state-of-the-art methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> have found that deep neural networks are a promising solution for the STLF problem at the household level, due to their ability to capture complex and non-linear patterns. Neural networks outperform other prediction methods such as Auto Regressive Integrated Moving Average (ARIMA)<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and Support Vector Regression (SVR). Nevertheless, applying deep learning models alone will not lead to significant improvements, as models tend to suffer from overfitting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>. An overfitted model is a model that learned the details of the training data including the noise, which affects its ability to generalize when applied to new data. To tackle this issue, it is recommended to increase the diversity and size of the used data by combining
usage records from different households. Typically, proposed frameworks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> assume that all data records are transferred from smart meters to a centralized computational infrastructure through broadband networks to train models. Nevertheless, this assumption raises concerns related to privacy, since the load profiles reveal a lot of sensitive information, such as device usage and the household’s occupancy. Sending such detailed data over networks makes it exposed to malicious interception and misuse. 
<br class="ltx_break">To address privacy concerns while still increasing data records’ volume and variety, a new on-device solution was recently proposed by the Machine Learning community: Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Federated Learning is a decentralized machine learning scheme, where each device participates in training a central model without sending any data. As illustrated in Fig.1, the server first initializes the model either arbitrarily or by using publicly available data. Then, the model is sent to a set of randomly selected devices (clients) for local training using their data. Each client sends to the server an update of the model’s weights, which will be averaged and used to update the global model. This process will be repeated until the global model stabilizes.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2201.11248/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="174" height="94" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Iterative communications between clients and server in Federated Learning</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The main purpose of this paper is to evaluate the use of Edge computing, together with the Federated Learning approach in the STLF challenge for electricity in households. Edge computing refers to data processing at the edge of a network as opposed to cloud or remote server processing. We use Long-short Term Memory (LSTM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, a deep neural network for forecasting time series, which uses previous observations of the house’s electrical load to predict future ones. We study a group of houses that have similar properties (geographical location, type of building), on a short period of time to avoid the weather’s fluctuations and seasonality impact. Federated learning is performed on houses grid Edge equipment. Edge equipment is usually present at the end of the electrical distribution system as a smart interface between the customer and the electric power supply, be it a smart meter or a more sophisticated equipment. Our contributions in this work can be summarized as follows: (1) We propose an enabling architecture for FL using Edge equipment in the smart grid; (2) We evaluate the potential gain of FL in terms of accuracy through simulations; and (3) we evaluate the potential network load gain through numerical results. To these contributions, we add the gain in privacy leveraged by decentralization and Edge computing.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The remainder of this paper is structured as follows: Section II discusses related works focusing on load prediction and privacy. In Section III, we define the proposed approach and used methods. Section IV introduces the simulations and numerical results. Then in Section V we discuss the limitations and future work. Section VI concludes the paper.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Many recent research works used deep neural networks, and particularly Long-short term memory (LSTM) to tackle the short-term load forecasting challenge. In fact, benchmarks have proved LSTM’s potential compared to other methods<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>, yet the results do not match the level of desired exactitude in terms of Root Mean Square Error (RMSE) and Mean Average Percentage Error (MAPE). In order to improve forecasting accuracy, authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> propose to use a variant of LSTM that is a sequence-to-sequence LSTM, which gives better results for one-minute resolution data, but no significant improvement for the one-hour resolution compared to standard LSTM. Furthermore, other authors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> consider the problem of finding the best LSTM network to be a hyperparameter tuning problem, and use the genetic algorithm to this end. They state that finding the best combination of window size and number of hidden neurons in each layer remains a probabilistic task.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Some other works see that the problem is not simply an neural network architecture problem, and that ability of generalization of data-driven forecasting models is the real issue. In fact, many of the proposed models’ accuracy drops when they are applied to new datasets <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Some works suggest to use complementary data about the weather <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> or records from the appliances <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. While the weather has a real impact on the aggregated electrical consumption, the individual short-term load is more related to the occupants’ behaviour<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. However, collecting data from appliances around each house is an expensive and privacy-intrusive task.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Another approach to enrich the training data is grouping data from several customers. Authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> use clustering to group users with similar profiles, hence reducing the variance of uncertainty within groups. Authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> propose a pooling technique that increases data’s diversity to overcome the overfitting problem. Nonetheless, these methods are heavily centralized and are prone to privacy-issues.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Fine-grained consumption data sent over networks is subject to many privacy threats when leaked through unauthorized interception or eavesdropping <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Many efforts were conducted to protect the users’ identities in the smart grid. For instance, authors in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> propose a clustering-based method where each group of users who are geographically close receive a common serial number. However this method makes it hard to treat each client individually because of the anonymity. Other works’ focus is masking the consumption data, where data aggregation is the most popular method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, but it goes in opposite directions with STLF requirements.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">In regards to user privacy and prediction accuracy, none of the aforementioned papers address both of these aspects. In the proposed work, we suggest to use the Edge Equipment that compose the Home Area Network (HAN) to carry out operations related to client selection and training neural network at the Edge following the federated learning scheme, allowing the use of data to train a global model without compromising the resident’s privacy.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">System Model</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We propose the network architecture shown in Fig.2 with two main components: a Multi-access Edge Computing (MEC) server <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> and clients. Clients are houses with Edge equipment which is essentially composed of smart-meters and other devices in the HAN. FL is used to build a global LSTM-based model for STLF. The training rounds are orchestrated by the MEC server and executed by the clients using their own electrical consumption data.
In this section, we explain in detail LSTM and how it comes to use in the forecasting, as well as FL and how it is used in our system model.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2201.11248/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="199" height="91" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S3.F2.3.2" class="ltx_text" style="font-size:90%;">Network components and roles</span></figcaption>
</figure>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.4.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.5.2" class="ltx_text ltx_font_italic">Time series forecasting using LSTM</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The prediction of the future electrical load in this work is achieved through the time series forecasting approach with LSTM. A time series refers to an ordered sequence of equally-spaced data points that represent the evolution of a specific variable over time. Time series forecasting is enabled through modeling the dependencies between the points of current data points and historical data, but the accuracy of the predictions relies heavily on the chosen model and the quality of historical data points.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">LSTM is a recurrent neural network (RNN) that is fundamentally different from traditional feedforward Neural networks, and more efficient than standard RNNs.
Sequence learning is LSTM’s Forte. It is able to establish the temporal correlations between previous data points and the current circumstances, while solving vanishing and exploding gradient problems that are common in RNNs. Gradient vanishing means that the norm of the gradient for long-term components gets smaller causing weights to never change at lower layers, while the gradient exploding refers to the opposite event <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
This is achieved through its key components: the memory cell that is used to remember important states in the past, and the gates that regulate the flow of information. LSTM has three gates: the input gate, the output gate and the forget gate. They learn to reset the memory cell for unimportant features during the learning process. Almost all state of the art results in sequence learning are achieved with LSTM and its variants especially language translation and speech recognition. In the case of residential STLF, it is expected that the LSTM network would be able to form an abstraction of some residents’ states from the provided consumption profile, maintain the memory of the states, and make a forecast of the future consumption based on the learnt information.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.4.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.5.2" class="ltx_text ltx_font_italic">Federated Learning</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Federated learning is a form of machine learning where most of the training process is done in a distributed way among devices referred to as clients. It was first proposed and implemented by Google on keyboards of mobile devices for next word prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. This approach is ideal for many cases: 1) When data is privacy sensitive,
2) when data is large in size compared to model updates,
3) highly distributed systems where the number of devices is orders of magnitude larger than nodes in a data center,
4) in supervised training when labels can be inferred directly from the user.
Federated learning has also proven to be very useful when datasets are unbalanced or non-identically distributed.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">An iteration of federated learning goes as follows : First, a subset of clients is chosen and each of them receives the current model. In our case, clients are hosted at Edge equipment in houses (e.g. smart meters). Clients that were selected compute Stochastic Gradient Descent (SGD) updates on locally-stored data, then a server aggregates the client updates to build a new global model. The new model is sent back to another subset of clients. This process is repeated until the desired prediction accuracy is reached. The operations are detailed in Algorithm 1.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.9" class="ltx_p">In order to combine the client updates, the server uses the <span id="S3.SS2.p3.9.1" class="ltx_text ltx_font_italic">FederatedAveraging</span> algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. First, the initial global model is initialized randomly or is pre-trained using publicly available data. In each training round <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\it{r}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\it{r}</annotation></semantics></math>, the server sends a global model <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="w_{r}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑤</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">w_{r}</annotation></semantics></math> to a subset <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="\it{K}" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\it{K}</annotation></semantics></math> of clients who have enough data records and whose consumption load varies enough to enrich the training data. This condition was added to ensure that we have enough variation in terms of data points to give a representation of the occupants’ regular consumption. Afterward, every client <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="\it{k}" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">\it{k}</annotation></semantics></math> in the subset uses <math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="n_{k}" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><msub id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml">n</mi><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2">𝑛</ci><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">n_{k}</annotation></semantics></math> examples from its local data. In our case, the volume is related to how long the smart meter has been generating data and how many of it is saved locally. The used dataset is composed of sliding windows with a predetermined number of look-back steps.
SGD is then used by each client <math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="\it{k}" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">\it{k}</annotation></semantics></math> to compute the average gradient <math id="S3.SS2.p3.7.m7.1" class="ltx_Math" alttext="g_{k}" display="inline"><semantics id="S3.SS2.p3.7.m7.1a"><msub id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.2" xref="S3.SS2.p3.7.m7.1.1.2.cmml">g</mi><mi id="S3.SS2.p3.7.m7.1.1.3" xref="S3.SS2.p3.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><apply id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.2">𝑔</ci><ci id="S3.SS2.p3.7.m7.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">g_{k}</annotation></semantics></math>, with a learning rate <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><mi id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">\eta</annotation></semantics></math>. The updated models <math id="S3.SS2.p3.9.m9.1" class="ltx_Math" alttext="w_{k}" display="inline"><semantics id="S3.SS2.p3.9.m9.1a"><msub id="S3.SS2.p3.9.m9.1.1" xref="S3.SS2.p3.9.m9.1.1.cmml"><mi id="S3.SS2.p3.9.m9.1.1.2" xref="S3.SS2.p3.9.m9.1.1.2.cmml">w</mi><mi id="S3.SS2.p3.9.m9.1.1.3" xref="S3.SS2.p3.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.9.m9.1b"><apply id="S3.SS2.p3.9.m9.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.9.m9.1.1.1.cmml" xref="S3.SS2.p3.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p3.9.m9.1.1.2.cmml" xref="S3.SS2.p3.9.m9.1.1.2">𝑤</ci><ci id="S3.SS2.p3.9.m9.1.1.3.cmml" xref="S3.SS2.p3.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.9.m9.1c">w_{k}</annotation></semantics></math> are sent to the server to be aggregated.
<br class="ltx_break"></p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<div id="alg1.8" class="ltx_listing ltx_listing">
<div id="alg0.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>initialize the model in training round <math id="alg0.l1.m1.1" class="ltx_Math" alttext="\it{r}=0" display="inline"><semantics id="alg0.l1.m1.1a"><mrow id="alg0.l1.m1.1.1" xref="alg0.l1.m1.1.1.cmml"><mi id="alg0.l1.m1.1.1.2" xref="alg0.l1.m1.1.1.2.cmml">r</mi><mo id="alg0.l1.m1.1.1.1" xref="alg0.l1.m1.1.1.1.cmml">=</mo><mn class="ltx_mathvariant_italic" mathvariant="italic" id="alg0.l1.m1.1.1.3" xref="alg0.l1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg0.l1.m1.1b"><apply id="alg0.l1.m1.1.1.cmml" xref="alg0.l1.m1.1.1"><eq id="alg0.l1.m1.1.1.1.cmml" xref="alg0.l1.m1.1.1.1"></eq><ci id="alg0.l1.m1.1.1.2.cmml" xref="alg0.l1.m1.1.1.2">𝑟</ci><cn type="integer" id="alg0.l1.m1.1.1.3.cmml" xref="alg0.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l1.m1.1c">\it{r}=0</annotation></semantics></math>  
</div>
<div id="alg0.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>
</div>
<div id="alg0.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span><span id="alg0.l3.2" class="ltx_text ltx_font_bold">while</span> <math id="alg0.l3.m1.1" class="ltx_Math" alttext="\it{r}&lt;r_{max}" display="inline"><semantics id="alg0.l3.m1.1a"><mrow id="alg0.l3.m1.1.1" xref="alg0.l3.m1.1.1.cmml"><mi id="alg0.l3.m1.1.1.2" xref="alg0.l3.m1.1.1.2.cmml">r</mi><mo id="alg0.l3.m1.1.1.1" xref="alg0.l3.m1.1.1.1.cmml">&lt;</mo><msub id="alg0.l3.m1.1.1.3" xref="alg0.l3.m1.1.1.3.cmml"><mi id="alg0.l3.m1.1.1.3.2" xref="alg0.l3.m1.1.1.3.2.cmml">r</mi><mi id="alg0.l3.m1.1.1.3.3" xref="alg0.l3.m1.1.1.3.3.cmml">𝑚𝑎𝑥</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg0.l3.m1.1b"><apply id="alg0.l3.m1.1.1.cmml" xref="alg0.l3.m1.1.1"><lt id="alg0.l3.m1.1.1.1.cmml" xref="alg0.l3.m1.1.1.1"></lt><ci id="alg0.l3.m1.1.1.2.cmml" xref="alg0.l3.m1.1.1.2">𝑟</ci><apply id="alg0.l3.m1.1.1.3.cmml" xref="alg0.l3.m1.1.1.3"><csymbol cd="ambiguous" id="alg0.l3.m1.1.1.3.1.cmml" xref="alg0.l3.m1.1.1.3">subscript</csymbol><ci id="alg0.l3.m1.1.1.3.2.cmml" xref="alg0.l3.m1.1.1.3.2">𝑟</ci><ci id="alg0.l3.m1.1.1.3.3.cmml" xref="alg0.l3.m1.1.1.3.3">𝑚𝑎𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l3.m1.1c">\it{r}&lt;r_{max}</annotation></semantics></math>  <span id="alg0.l3.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg0.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     Select subset <math id="alg0.l4.m1.1" class="ltx_Math" alttext="\it{K}" display="inline"><semantics id="alg0.l4.m1.1a"><mi id="alg0.l4.m1.1.1" xref="alg0.l4.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg0.l4.m1.1b"><ci id="alg0.l4.m1.1.1.cmml" xref="alg0.l4.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg0.l4.m1.1c">\it{K}</annotation></semantics></math> of clients; 
</div>
<div id="alg0.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>
</div>
<div id="alg0.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     <span id="alg0.l6.2" class="ltx_text ltx_font_bold">for</span> client <math id="alg0.l6.m1.1" class="ltx_Math" alttext="\it{k}" display="inline"><semantics id="alg0.l6.m1.1a"><mi id="alg0.l6.m1.1.1" xref="alg0.l6.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg0.l6.m1.1b"><ci id="alg0.l6.m1.1.1.cmml" xref="alg0.l6.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg0.l6.m1.1c">\it{k}</annotation></semantics></math> in <math id="alg0.l6.m2.1" class="ltx_Math" alttext="\it{K}" display="inline"><semantics id="alg0.l6.m2.1a"><mi id="alg0.l6.m2.1.1" xref="alg0.l6.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg0.l6.m2.1b"><ci id="alg0.l6.m2.1.1.cmml" xref="alg0.l6.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg0.l6.m2.1c">\it{K}</annotation></semantics></math> <span id="alg0.l6.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg0.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>         <span id="alg0.l7.2" class="ltx_text ltx_font_bold">if</span> <math id="alg0.l7.m1.1" class="ltx_Math" alttext="\sigma(monthlyload)&gt;\it{threshold}" display="inline"><semantics id="alg0.l7.m1.1a"><mrow id="alg0.l7.m1.1.1" xref="alg0.l7.m1.1.1.cmml"><mrow id="alg0.l7.m1.1.1.1" xref="alg0.l7.m1.1.1.1.cmml"><mi id="alg0.l7.m1.1.1.1.3" xref="alg0.l7.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.2" xref="alg0.l7.m1.1.1.1.2.cmml">​</mo><mrow id="alg0.l7.m1.1.1.1.1.1" xref="alg0.l7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg0.l7.m1.1.1.1.1.1.2" xref="alg0.l7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg0.l7.m1.1.1.1.1.1.1" xref="alg0.l7.m1.1.1.1.1.1.1.cmml"><mi id="alg0.l7.m1.1.1.1.1.1.1.2" xref="alg0.l7.m1.1.1.1.1.1.1.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.1.1.1.1" xref="alg0.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg0.l7.m1.1.1.1.1.1.1.3" xref="alg0.l7.m1.1.1.1.1.1.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.1.1.1.1a" xref="alg0.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg0.l7.m1.1.1.1.1.1.1.4" xref="alg0.l7.m1.1.1.1.1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.1.1.1.1b" xref="alg0.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg0.l7.m1.1.1.1.1.1.1.5" xref="alg0.l7.m1.1.1.1.1.1.1.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.1.1.1.1c" xref="alg0.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg0.l7.m1.1.1.1.1.1.1.6" xref="alg0.l7.m1.1.1.1.1.1.1.6.cmml">h</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.1.1.1.1d" xref="alg0.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg0.l7.m1.1.1.1.1.1.1.7" xref="alg0.l7.m1.1.1.1.1.1.1.7.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.1.1.1.1e" xref="alg0.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg0.l7.m1.1.1.1.1.1.1.8" xref="alg0.l7.m1.1.1.1.1.1.1.8.cmml">y</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.1.1.1.1f" xref="alg0.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg0.l7.m1.1.1.1.1.1.1.9" xref="alg0.l7.m1.1.1.1.1.1.1.9.cmml">l</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.1.1.1.1g" xref="alg0.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg0.l7.m1.1.1.1.1.1.1.10" xref="alg0.l7.m1.1.1.1.1.1.1.10.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.1.1.1.1h" xref="alg0.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg0.l7.m1.1.1.1.1.1.1.11" xref="alg0.l7.m1.1.1.1.1.1.1.11.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg0.l7.m1.1.1.1.1.1.1.1i" xref="alg0.l7.m1.1.1.1.1.1.1.1.cmml">​</mo><mi id="alg0.l7.m1.1.1.1.1.1.1.12" xref="alg0.l7.m1.1.1.1.1.1.1.12.cmml">d</mi></mrow><mo stretchy="false" id="alg0.l7.m1.1.1.1.1.1.3" xref="alg0.l7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg0.l7.m1.1.1.2" xref="alg0.l7.m1.1.1.2.cmml">&gt;</mo><mi id="alg0.l7.m1.1.1.3" xref="alg0.l7.m1.1.1.3.cmml">𝑡ℎ𝑟𝑒𝑠ℎ𝑜𝑙𝑑</mi></mrow><annotation-xml encoding="MathML-Content" id="alg0.l7.m1.1b"><apply id="alg0.l7.m1.1.1.cmml" xref="alg0.l7.m1.1.1"><gt id="alg0.l7.m1.1.1.2.cmml" xref="alg0.l7.m1.1.1.2"></gt><apply id="alg0.l7.m1.1.1.1.cmml" xref="alg0.l7.m1.1.1.1"><times id="alg0.l7.m1.1.1.1.2.cmml" xref="alg0.l7.m1.1.1.1.2"></times><ci id="alg0.l7.m1.1.1.1.3.cmml" xref="alg0.l7.m1.1.1.1.3">𝜎</ci><apply id="alg0.l7.m1.1.1.1.1.1.1.cmml" xref="alg0.l7.m1.1.1.1.1.1"><times id="alg0.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.1"></times><ci id="alg0.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.2">𝑚</ci><ci id="alg0.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.3">𝑜</ci><ci id="alg0.l7.m1.1.1.1.1.1.1.4.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.4">𝑛</ci><ci id="alg0.l7.m1.1.1.1.1.1.1.5.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.5">𝑡</ci><ci id="alg0.l7.m1.1.1.1.1.1.1.6.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.6">ℎ</ci><ci id="alg0.l7.m1.1.1.1.1.1.1.7.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.7">𝑙</ci><ci id="alg0.l7.m1.1.1.1.1.1.1.8.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.8">𝑦</ci><ci id="alg0.l7.m1.1.1.1.1.1.1.9.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.9">𝑙</ci><ci id="alg0.l7.m1.1.1.1.1.1.1.10.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.10">𝑜</ci><ci id="alg0.l7.m1.1.1.1.1.1.1.11.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.11">𝑎</ci><ci id="alg0.l7.m1.1.1.1.1.1.1.12.cmml" xref="alg0.l7.m1.1.1.1.1.1.1.12">𝑑</ci></apply></apply><ci id="alg0.l7.m1.1.1.3.cmml" xref="alg0.l7.m1.1.1.3">𝑡ℎ𝑟𝑒𝑠ℎ𝑜𝑙𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l7.m1.1c">\sigma(monthlyload)&gt;\it{threshold}</annotation></semantics></math> <span id="alg0.l7.3" class="ltx_text ltx_font_bold">then</span>

</div>
<div id="alg0.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>              <math id="alg0.l8.m1.1" class="ltx_Math" alttext="\it{k}" display="inline"><semantics id="alg0.l8.m1.1a"><mi id="alg0.l8.m1.1.1" xref="alg0.l8.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg0.l8.m1.1b"><ci id="alg0.l8.m1.1.1.cmml" xref="alg0.l8.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg0.l8.m1.1c">\it{k}</annotation></semantics></math> receives model <math id="alg0.l8.m2.1" class="ltx_Math" alttext="w_{r}" display="inline"><semantics id="alg0.l8.m2.1a"><msub id="alg0.l8.m2.1.1" xref="alg0.l8.m2.1.1.cmml"><mi id="alg0.l8.m2.1.1.2" xref="alg0.l8.m2.1.1.2.cmml">w</mi><mi id="alg0.l8.m2.1.1.3" xref="alg0.l8.m2.1.1.3.cmml">r</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l8.m2.1b"><apply id="alg0.l8.m2.1.1.cmml" xref="alg0.l8.m2.1.1"><csymbol cd="ambiguous" id="alg0.l8.m2.1.1.1.cmml" xref="alg0.l8.m2.1.1">subscript</csymbol><ci id="alg0.l8.m2.1.1.2.cmml" xref="alg0.l8.m2.1.1.2">𝑤</ci><ci id="alg0.l8.m2.1.1.3.cmml" xref="alg0.l8.m2.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l8.m2.1c">w_{r}</annotation></semantics></math>; 
</div>
<div id="alg0.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>
</div>
<div id="alg0.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>              <math id="alg0.l10.m1.1" class="ltx_Math" alttext="\it{k}" display="inline"><semantics id="alg0.l10.m1.1a"><mi id="alg0.l10.m1.1.1" xref="alg0.l10.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg0.l10.m1.1b"><ci id="alg0.l10.m1.1.1.cmml" xref="alg0.l10.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg0.l10.m1.1c">\it{k}</annotation></semantics></math> computes average gradient <math id="alg0.l10.m2.1" class="ltx_Math" alttext="g_{k}" display="inline"><semantics id="alg0.l10.m2.1a"><msub id="alg0.l10.m2.1.1" xref="alg0.l10.m2.1.1.cmml"><mi id="alg0.l10.m2.1.1.2" xref="alg0.l10.m2.1.1.2.cmml">g</mi><mi id="alg0.l10.m2.1.1.3" xref="alg0.l10.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg0.l10.m2.1b"><apply id="alg0.l10.m2.1.1.cmml" xref="alg0.l10.m2.1.1"><csymbol cd="ambiguous" id="alg0.l10.m2.1.1.1.cmml" xref="alg0.l10.m2.1.1">subscript</csymbol><ci id="alg0.l10.m2.1.1.2.cmml" xref="alg0.l10.m2.1.1.2">𝑔</ci><ci id="alg0.l10.m2.1.1.3.cmml" xref="alg0.l10.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l10.m2.1c">g_{k}</annotation></semantics></math> with SGD; 
</div>
<div id="alg0.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>
</div>
<div id="alg0.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>              <math id="alg0.l12.m1.1" class="ltx_Math" alttext="\it{k}" display="inline"><semantics id="alg0.l12.m1.1a"><mi id="alg0.l12.m1.1.1" xref="alg0.l12.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg0.l12.m1.1b"><ci id="alg0.l12.m1.1.1.cmml" xref="alg0.l12.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg0.l12.m1.1c">\it{k}</annotation></semantics></math> updates local model 
</div>
<div id="alg0.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>              <math id="alg0.l13.m1.1" class="ltx_Math" alttext="w_{r+1}^{k}\leftarrow w_{r}^{k}-\eta g_{k}" display="inline"><semantics id="alg0.l13.m1.1a"><mrow id="alg0.l13.m1.1.1" xref="alg0.l13.m1.1.1.cmml"><msubsup id="alg0.l13.m1.1.1.2" xref="alg0.l13.m1.1.1.2.cmml"><mi id="alg0.l13.m1.1.1.2.2.2" xref="alg0.l13.m1.1.1.2.2.2.cmml">w</mi><mrow id="alg0.l13.m1.1.1.2.2.3" xref="alg0.l13.m1.1.1.2.2.3.cmml"><mi id="alg0.l13.m1.1.1.2.2.3.2" xref="alg0.l13.m1.1.1.2.2.3.2.cmml">r</mi><mo id="alg0.l13.m1.1.1.2.2.3.1" xref="alg0.l13.m1.1.1.2.2.3.1.cmml">+</mo><mn id="alg0.l13.m1.1.1.2.2.3.3" xref="alg0.l13.m1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="alg0.l13.m1.1.1.2.3" xref="alg0.l13.m1.1.1.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg0.l13.m1.1.1.1" xref="alg0.l13.m1.1.1.1.cmml">←</mo><mrow id="alg0.l13.m1.1.1.3" xref="alg0.l13.m1.1.1.3.cmml"><msubsup id="alg0.l13.m1.1.1.3.2" xref="alg0.l13.m1.1.1.3.2.cmml"><mi id="alg0.l13.m1.1.1.3.2.2.2" xref="alg0.l13.m1.1.1.3.2.2.2.cmml">w</mi><mi id="alg0.l13.m1.1.1.3.2.2.3" xref="alg0.l13.m1.1.1.3.2.2.3.cmml">r</mi><mi id="alg0.l13.m1.1.1.3.2.3" xref="alg0.l13.m1.1.1.3.2.3.cmml">k</mi></msubsup><mo id="alg0.l13.m1.1.1.3.1" xref="alg0.l13.m1.1.1.3.1.cmml">−</mo><mrow id="alg0.l13.m1.1.1.3.3" xref="alg0.l13.m1.1.1.3.3.cmml"><mi id="alg0.l13.m1.1.1.3.3.2" xref="alg0.l13.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="alg0.l13.m1.1.1.3.3.1" xref="alg0.l13.m1.1.1.3.3.1.cmml">​</mo><msub id="alg0.l13.m1.1.1.3.3.3" xref="alg0.l13.m1.1.1.3.3.3.cmml"><mi id="alg0.l13.m1.1.1.3.3.3.2" xref="alg0.l13.m1.1.1.3.3.3.2.cmml">g</mi><mi id="alg0.l13.m1.1.1.3.3.3.3" xref="alg0.l13.m1.1.1.3.3.3.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg0.l13.m1.1b"><apply id="alg0.l13.m1.1.1.cmml" xref="alg0.l13.m1.1.1"><ci id="alg0.l13.m1.1.1.1.cmml" xref="alg0.l13.m1.1.1.1">←</ci><apply id="alg0.l13.m1.1.1.2.cmml" xref="alg0.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg0.l13.m1.1.1.2.1.cmml" xref="alg0.l13.m1.1.1.2">superscript</csymbol><apply id="alg0.l13.m1.1.1.2.2.cmml" xref="alg0.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg0.l13.m1.1.1.2.2.1.cmml" xref="alg0.l13.m1.1.1.2">subscript</csymbol><ci id="alg0.l13.m1.1.1.2.2.2.cmml" xref="alg0.l13.m1.1.1.2.2.2">𝑤</ci><apply id="alg0.l13.m1.1.1.2.2.3.cmml" xref="alg0.l13.m1.1.1.2.2.3"><plus id="alg0.l13.m1.1.1.2.2.3.1.cmml" xref="alg0.l13.m1.1.1.2.2.3.1"></plus><ci id="alg0.l13.m1.1.1.2.2.3.2.cmml" xref="alg0.l13.m1.1.1.2.2.3.2">𝑟</ci><cn type="integer" id="alg0.l13.m1.1.1.2.2.3.3.cmml" xref="alg0.l13.m1.1.1.2.2.3.3">1</cn></apply></apply><ci id="alg0.l13.m1.1.1.2.3.cmml" xref="alg0.l13.m1.1.1.2.3">𝑘</ci></apply><apply id="alg0.l13.m1.1.1.3.cmml" xref="alg0.l13.m1.1.1.3"><minus id="alg0.l13.m1.1.1.3.1.cmml" xref="alg0.l13.m1.1.1.3.1"></minus><apply id="alg0.l13.m1.1.1.3.2.cmml" xref="alg0.l13.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg0.l13.m1.1.1.3.2.1.cmml" xref="alg0.l13.m1.1.1.3.2">superscript</csymbol><apply id="alg0.l13.m1.1.1.3.2.2.cmml" xref="alg0.l13.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg0.l13.m1.1.1.3.2.2.1.cmml" xref="alg0.l13.m1.1.1.3.2">subscript</csymbol><ci id="alg0.l13.m1.1.1.3.2.2.2.cmml" xref="alg0.l13.m1.1.1.3.2.2.2">𝑤</ci><ci id="alg0.l13.m1.1.1.3.2.2.3.cmml" xref="alg0.l13.m1.1.1.3.2.2.3">𝑟</ci></apply><ci id="alg0.l13.m1.1.1.3.2.3.cmml" xref="alg0.l13.m1.1.1.3.2.3">𝑘</ci></apply><apply id="alg0.l13.m1.1.1.3.3.cmml" xref="alg0.l13.m1.1.1.3.3"><times id="alg0.l13.m1.1.1.3.3.1.cmml" xref="alg0.l13.m1.1.1.3.3.1"></times><ci id="alg0.l13.m1.1.1.3.3.2.cmml" xref="alg0.l13.m1.1.1.3.3.2">𝜂</ci><apply id="alg0.l13.m1.1.1.3.3.3.cmml" xref="alg0.l13.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="alg0.l13.m1.1.1.3.3.3.1.cmml" xref="alg0.l13.m1.1.1.3.3.3">subscript</csymbol><ci id="alg0.l13.m1.1.1.3.3.3.2.cmml" xref="alg0.l13.m1.1.1.3.3.3.2">𝑔</ci><ci id="alg0.l13.m1.1.1.3.3.3.3.cmml" xref="alg0.l13.m1.1.1.3.3.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l13.m1.1c">w_{r+1}^{k}\leftarrow w_{r}^{k}-\eta g_{k}</annotation></semantics></math>; 
</div>
<div id="alg0.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>
</div>
<div id="alg0.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>              <math id="alg0.l15.m1.1" class="ltx_Math" alttext="\it{k}" display="inline"><semantics id="alg0.l15.m1.1a"><mi id="alg0.l15.m1.1.1" xref="alg0.l15.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg0.l15.m1.1b"><ci id="alg0.l15.m1.1.1.cmml" xref="alg0.l15.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg0.l15.m1.1c">\it{k}</annotation></semantics></math> sends updated model to server; 

</div>
<div id="alg0.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>         <span id="alg0.l16.2" class="ltx_text ltx_font_bold">end</span> <span id="alg0.l16.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg0.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>     <span id="alg0.l17.2" class="ltx_text ltx_font_bold">end</span> <span id="alg0.l17.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg0.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>     server computes new global model using the equation :<math id="alg0.l18.m1.1" class="ltx_Math" alttext="w_{r+1}\leftarrow\sum_{k=0}^{K}\frac{n_{k}}{N}w_{r+1}^{k}" display="inline"><semantics id="alg0.l18.m1.1a"><mrow id="alg0.l18.m1.1.1" xref="alg0.l18.m1.1.1.cmml"><msub id="alg0.l18.m1.1.1.2" xref="alg0.l18.m1.1.1.2.cmml"><mi id="alg0.l18.m1.1.1.2.2" xref="alg0.l18.m1.1.1.2.2.cmml">w</mi><mrow id="alg0.l18.m1.1.1.2.3" xref="alg0.l18.m1.1.1.2.3.cmml"><mi id="alg0.l18.m1.1.1.2.3.2" xref="alg0.l18.m1.1.1.2.3.2.cmml">r</mi><mo id="alg0.l18.m1.1.1.2.3.1" xref="alg0.l18.m1.1.1.2.3.1.cmml">+</mo><mn id="alg0.l18.m1.1.1.2.3.3" xref="alg0.l18.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="alg0.l18.m1.1.1.1" xref="alg0.l18.m1.1.1.1.cmml">←</mo><mrow id="alg0.l18.m1.1.1.3" xref="alg0.l18.m1.1.1.3.cmml"><msubsup id="alg0.l18.m1.1.1.3.1" xref="alg0.l18.m1.1.1.3.1.cmml"><mo id="alg0.l18.m1.1.1.3.1.2.2" xref="alg0.l18.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="alg0.l18.m1.1.1.3.1.2.3" xref="alg0.l18.m1.1.1.3.1.2.3.cmml"><mi id="alg0.l18.m1.1.1.3.1.2.3.2" xref="alg0.l18.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="alg0.l18.m1.1.1.3.1.2.3.1" xref="alg0.l18.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="alg0.l18.m1.1.1.3.1.2.3.3" xref="alg0.l18.m1.1.1.3.1.2.3.3.cmml">0</mn></mrow><mi id="alg0.l18.m1.1.1.3.1.3" xref="alg0.l18.m1.1.1.3.1.3.cmml">K</mi></msubsup><mrow id="alg0.l18.m1.1.1.3.2" xref="alg0.l18.m1.1.1.3.2.cmml"><mfrac id="alg0.l18.m1.1.1.3.2.2" xref="alg0.l18.m1.1.1.3.2.2.cmml"><msub id="alg0.l18.m1.1.1.3.2.2.2" xref="alg0.l18.m1.1.1.3.2.2.2.cmml"><mi id="alg0.l18.m1.1.1.3.2.2.2.2" xref="alg0.l18.m1.1.1.3.2.2.2.2.cmml">n</mi><mi id="alg0.l18.m1.1.1.3.2.2.2.3" xref="alg0.l18.m1.1.1.3.2.2.2.3.cmml">k</mi></msub><mi id="alg0.l18.m1.1.1.3.2.2.3" xref="alg0.l18.m1.1.1.3.2.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="alg0.l18.m1.1.1.3.2.1" xref="alg0.l18.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg0.l18.m1.1.1.3.2.3" xref="alg0.l18.m1.1.1.3.2.3.cmml"><mi id="alg0.l18.m1.1.1.3.2.3.2.2" xref="alg0.l18.m1.1.1.3.2.3.2.2.cmml">w</mi><mrow id="alg0.l18.m1.1.1.3.2.3.2.3" xref="alg0.l18.m1.1.1.3.2.3.2.3.cmml"><mi id="alg0.l18.m1.1.1.3.2.3.2.3.2" xref="alg0.l18.m1.1.1.3.2.3.2.3.2.cmml">r</mi><mo id="alg0.l18.m1.1.1.3.2.3.2.3.1" xref="alg0.l18.m1.1.1.3.2.3.2.3.1.cmml">+</mo><mn id="alg0.l18.m1.1.1.3.2.3.2.3.3" xref="alg0.l18.m1.1.1.3.2.3.2.3.3.cmml">1</mn></mrow><mi id="alg0.l18.m1.1.1.3.2.3.3" xref="alg0.l18.m1.1.1.3.2.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg0.l18.m1.1b"><apply id="alg0.l18.m1.1.1.cmml" xref="alg0.l18.m1.1.1"><ci id="alg0.l18.m1.1.1.1.cmml" xref="alg0.l18.m1.1.1.1">←</ci><apply id="alg0.l18.m1.1.1.2.cmml" xref="alg0.l18.m1.1.1.2"><csymbol cd="ambiguous" id="alg0.l18.m1.1.1.2.1.cmml" xref="alg0.l18.m1.1.1.2">subscript</csymbol><ci id="alg0.l18.m1.1.1.2.2.cmml" xref="alg0.l18.m1.1.1.2.2">𝑤</ci><apply id="alg0.l18.m1.1.1.2.3.cmml" xref="alg0.l18.m1.1.1.2.3"><plus id="alg0.l18.m1.1.1.2.3.1.cmml" xref="alg0.l18.m1.1.1.2.3.1"></plus><ci id="alg0.l18.m1.1.1.2.3.2.cmml" xref="alg0.l18.m1.1.1.2.3.2">𝑟</ci><cn type="integer" id="alg0.l18.m1.1.1.2.3.3.cmml" xref="alg0.l18.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg0.l18.m1.1.1.3.cmml" xref="alg0.l18.m1.1.1.3"><apply id="alg0.l18.m1.1.1.3.1.cmml" xref="alg0.l18.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg0.l18.m1.1.1.3.1.1.cmml" xref="alg0.l18.m1.1.1.3.1">superscript</csymbol><apply id="alg0.l18.m1.1.1.3.1.2.cmml" xref="alg0.l18.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg0.l18.m1.1.1.3.1.2.1.cmml" xref="alg0.l18.m1.1.1.3.1">subscript</csymbol><sum id="alg0.l18.m1.1.1.3.1.2.2.cmml" xref="alg0.l18.m1.1.1.3.1.2.2"></sum><apply id="alg0.l18.m1.1.1.3.1.2.3.cmml" xref="alg0.l18.m1.1.1.3.1.2.3"><eq id="alg0.l18.m1.1.1.3.1.2.3.1.cmml" xref="alg0.l18.m1.1.1.3.1.2.3.1"></eq><ci id="alg0.l18.m1.1.1.3.1.2.3.2.cmml" xref="alg0.l18.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="alg0.l18.m1.1.1.3.1.2.3.3.cmml" xref="alg0.l18.m1.1.1.3.1.2.3.3">0</cn></apply></apply><ci id="alg0.l18.m1.1.1.3.1.3.cmml" xref="alg0.l18.m1.1.1.3.1.3">𝐾</ci></apply><apply id="alg0.l18.m1.1.1.3.2.cmml" xref="alg0.l18.m1.1.1.3.2"><times id="alg0.l18.m1.1.1.3.2.1.cmml" xref="alg0.l18.m1.1.1.3.2.1"></times><apply id="alg0.l18.m1.1.1.3.2.2.cmml" xref="alg0.l18.m1.1.1.3.2.2"><divide id="alg0.l18.m1.1.1.3.2.2.1.cmml" xref="alg0.l18.m1.1.1.3.2.2"></divide><apply id="alg0.l18.m1.1.1.3.2.2.2.cmml" xref="alg0.l18.m1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="alg0.l18.m1.1.1.3.2.2.2.1.cmml" xref="alg0.l18.m1.1.1.3.2.2.2">subscript</csymbol><ci id="alg0.l18.m1.1.1.3.2.2.2.2.cmml" xref="alg0.l18.m1.1.1.3.2.2.2.2">𝑛</ci><ci id="alg0.l18.m1.1.1.3.2.2.2.3.cmml" xref="alg0.l18.m1.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="alg0.l18.m1.1.1.3.2.2.3.cmml" xref="alg0.l18.m1.1.1.3.2.2.3">𝑁</ci></apply><apply id="alg0.l18.m1.1.1.3.2.3.cmml" xref="alg0.l18.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg0.l18.m1.1.1.3.2.3.1.cmml" xref="alg0.l18.m1.1.1.3.2.3">superscript</csymbol><apply id="alg0.l18.m1.1.1.3.2.3.2.cmml" xref="alg0.l18.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg0.l18.m1.1.1.3.2.3.2.1.cmml" xref="alg0.l18.m1.1.1.3.2.3">subscript</csymbol><ci id="alg0.l18.m1.1.1.3.2.3.2.2.cmml" xref="alg0.l18.m1.1.1.3.2.3.2.2">𝑤</ci><apply id="alg0.l18.m1.1.1.3.2.3.2.3.cmml" xref="alg0.l18.m1.1.1.3.2.3.2.3"><plus id="alg0.l18.m1.1.1.3.2.3.2.3.1.cmml" xref="alg0.l18.m1.1.1.3.2.3.2.3.1"></plus><ci id="alg0.l18.m1.1.1.3.2.3.2.3.2.cmml" xref="alg0.l18.m1.1.1.3.2.3.2.3.2">𝑟</ci><cn type="integer" id="alg0.l18.m1.1.1.3.2.3.2.3.3.cmml" xref="alg0.l18.m1.1.1.3.2.3.2.3.3">1</cn></apply></apply><ci id="alg0.l18.m1.1.1.3.2.3.3.cmml" xref="alg0.l18.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l18.m1.1c">w_{r+1}\leftarrow\sum_{k=0}^{K}\frac{n_{k}}{N}w_{r+1}^{k}</annotation></semantics></math>; 

</div>
<div id="alg0.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>     start next round <math id="alg0.l19.m1.1" class="ltx_Math" alttext="r\leftarrow r+1" display="inline"><semantics id="alg0.l19.m1.1a"><mrow id="alg0.l19.m1.1.1" xref="alg0.l19.m1.1.1.cmml"><mi id="alg0.l19.m1.1.1.2" xref="alg0.l19.m1.1.1.2.cmml">r</mi><mo stretchy="false" id="alg0.l19.m1.1.1.1" xref="alg0.l19.m1.1.1.1.cmml">←</mo><mrow id="alg0.l19.m1.1.1.3" xref="alg0.l19.m1.1.1.3.cmml"><mi id="alg0.l19.m1.1.1.3.2" xref="alg0.l19.m1.1.1.3.2.cmml">r</mi><mo id="alg0.l19.m1.1.1.3.1" xref="alg0.l19.m1.1.1.3.1.cmml">+</mo><mn id="alg0.l19.m1.1.1.3.3" xref="alg0.l19.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg0.l19.m1.1b"><apply id="alg0.l19.m1.1.1.cmml" xref="alg0.l19.m1.1.1"><ci id="alg0.l19.m1.1.1.1.cmml" xref="alg0.l19.m1.1.1.1">←</ci><ci id="alg0.l19.m1.1.1.2.cmml" xref="alg0.l19.m1.1.1.2">𝑟</ci><apply id="alg0.l19.m1.1.1.3.cmml" xref="alg0.l19.m1.1.1.3"><plus id="alg0.l19.m1.1.1.3.1.cmml" xref="alg0.l19.m1.1.1.3.1"></plus><ci id="alg0.l19.m1.1.1.3.2.cmml" xref="alg0.l19.m1.1.1.3.2">𝑟</ci><cn type="integer" id="alg0.l19.m1.1.1.3.3.cmml" xref="alg0.l19.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg0.l19.m1.1c">r\leftarrow r+1</annotation></semantics></math>;  
</div>
<div id="alg0.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg0.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span><span id="alg0.l20.2" class="ltx_text ltx_font_bold">end</span> <span id="alg0.l20.3" class="ltx_text ltx_font_bold">while</span>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.9.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Federated Averaging Algorithm. <math id="alg1.4.m1.1" class="ltx_Math" alttext="r_{max}" display="inline"><semantics id="alg1.4.m1.1b"><msub id="alg1.4.m1.1.1" xref="alg1.4.m1.1.1.cmml"><mi id="alg1.4.m1.1.1.2" xref="alg1.4.m1.1.1.2.cmml">r</mi><mrow id="alg1.4.m1.1.1.3" xref="alg1.4.m1.1.1.3.cmml"><mi id="alg1.4.m1.1.1.3.2" xref="alg1.4.m1.1.1.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.4.m1.1.1.3.1" xref="alg1.4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.4.m1.1.1.3.3" xref="alg1.4.m1.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.4.m1.1.1.3.1b" xref="alg1.4.m1.1.1.3.1.cmml">​</mo><mi id="alg1.4.m1.1.1.3.4" xref="alg1.4.m1.1.1.3.4.cmml">x</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.4.m1.1c"><apply id="alg1.4.m1.1.1.cmml" xref="alg1.4.m1.1.1"><csymbol cd="ambiguous" id="alg1.4.m1.1.1.1.cmml" xref="alg1.4.m1.1.1">subscript</csymbol><ci id="alg1.4.m1.1.1.2.cmml" xref="alg1.4.m1.1.1.2">𝑟</ci><apply id="alg1.4.m1.1.1.3.cmml" xref="alg1.4.m1.1.1.3"><times id="alg1.4.m1.1.1.3.1.cmml" xref="alg1.4.m1.1.1.3.1"></times><ci id="alg1.4.m1.1.1.3.2.cmml" xref="alg1.4.m1.1.1.3.2">𝑚</ci><ci id="alg1.4.m1.1.1.3.3.cmml" xref="alg1.4.m1.1.1.3.3">𝑎</ci><ci id="alg1.4.m1.1.1.3.4.cmml" xref="alg1.4.m1.1.1.3.4">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m1.1d">r_{max}</annotation></semantics></math> is the maximum number of rounds. <math id="alg1.5.m2.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.5.m2.1b"><mi id="alg1.5.m2.1.1" xref="alg1.5.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.5.m2.1c"><ci id="alg1.5.m2.1.1.cmml" xref="alg1.5.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.5.m2.1d">\eta</annotation></semantics></math> is the learning rate and <math id="alg1.6.m3.1" class="ltx_Math" alttext="N=\sum_{k}n_{k}" display="inline"><semantics id="alg1.6.m3.1b"><mrow id="alg1.6.m3.1.1" xref="alg1.6.m3.1.1.cmml"><mi id="alg1.6.m3.1.1.2" xref="alg1.6.m3.1.1.2.cmml">N</mi><mo rspace="0.111em" id="alg1.6.m3.1.1.1" xref="alg1.6.m3.1.1.1.cmml">=</mo><mrow id="alg1.6.m3.1.1.3" xref="alg1.6.m3.1.1.3.cmml"><msub id="alg1.6.m3.1.1.3.1" xref="alg1.6.m3.1.1.3.1.cmml"><mo id="alg1.6.m3.1.1.3.1.2" xref="alg1.6.m3.1.1.3.1.2.cmml">∑</mo><mi id="alg1.6.m3.1.1.3.1.3" xref="alg1.6.m3.1.1.3.1.3.cmml">k</mi></msub><msub id="alg1.6.m3.1.1.3.2" xref="alg1.6.m3.1.1.3.2.cmml"><mi id="alg1.6.m3.1.1.3.2.2" xref="alg1.6.m3.1.1.3.2.2.cmml">n</mi><mi id="alg1.6.m3.1.1.3.2.3" xref="alg1.6.m3.1.1.3.2.3.cmml">k</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.6.m3.1c"><apply id="alg1.6.m3.1.1.cmml" xref="alg1.6.m3.1.1"><eq id="alg1.6.m3.1.1.1.cmml" xref="alg1.6.m3.1.1.1"></eq><ci id="alg1.6.m3.1.1.2.cmml" xref="alg1.6.m3.1.1.2">𝑁</ci><apply id="alg1.6.m3.1.1.3.cmml" xref="alg1.6.m3.1.1.3"><apply id="alg1.6.m3.1.1.3.1.cmml" xref="alg1.6.m3.1.1.3.1"><csymbol cd="ambiguous" id="alg1.6.m3.1.1.3.1.1.cmml" xref="alg1.6.m3.1.1.3.1">subscript</csymbol><sum id="alg1.6.m3.1.1.3.1.2.cmml" xref="alg1.6.m3.1.1.3.1.2"></sum><ci id="alg1.6.m3.1.1.3.1.3.cmml" xref="alg1.6.m3.1.1.3.1.3">𝑘</ci></apply><apply id="alg1.6.m3.1.1.3.2.cmml" xref="alg1.6.m3.1.1.3.2"><csymbol cd="ambiguous" id="alg1.6.m3.1.1.3.2.1.cmml" xref="alg1.6.m3.1.1.3.2">subscript</csymbol><ci id="alg1.6.m3.1.1.3.2.2.cmml" xref="alg1.6.m3.1.1.3.2.2">𝑛</ci><ci id="alg1.6.m3.1.1.3.2.3.cmml" xref="alg1.6.m3.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.6.m3.1d">N=\sum_{k}n_{k}</annotation></semantics></math> </figcaption>
</figure>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">However, the centralized model may not fit all the users’ electrical consumption. A proposed solution to this problem is Personalization. Personalization is the focus of many applications that require understanding user behaviour and adapting to it. It consists on retraining the centralized model using user-specific data to build a personalized model for each user. This can be achieved through retraining the model for a small number of epochs locally using exclusively the user’s data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">Federated learning has fewer privacy risks than centralized server storage, since even when data are anonymized, the users’ identities are still at risk and can be discovered through reverse engineering.
The model updates sent by each client are ephemeral and never stored on the server; weight updates are processed in memory and are discarded after aggregation.
The federated learning procedure requires that the individual weight uploads will not be inspected or analyzed. This is still more-secure than server training because the network and the server cannot be entrusted with fine-grained user data. Some data still have to be sent in an aggregated form for billing, but these data do not reveal many details. Techniques such as secure aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and differential privacy<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> are being explored to enforce trust requirements.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.4.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.5.2" class="ltx_text ltx_font_italic">Networking Load Gain</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.8" class="ltx_p">To evaluate the gain in network load in FL contrast to centralized training, we first define the network load <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="L_{sC}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">L</mi><mrow id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.p1.1.m1.1.1.3.2" xref="S3.SS3.p1.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.1.m1.1.1.3.1" xref="S3.SS3.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.1.m1.1.1.3.3" xref="S3.SS3.p1.1.m1.1.1.3.3.cmml">C</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝐿</ci><apply id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><times id="S3.SS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.p1.1.m1.1.1.3.1"></times><ci id="S3.SS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.p1.1.m1.1.1.3.2">𝑠</ci><ci id="S3.SS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">L_{sC}</annotation></semantics></math> for a server <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\it{s}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\it{s}</annotation></semantics></math> in centralized training in Eq. 1 and the network load in FL <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="L_{sF}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">L</mi><mrow id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml"><mi id="S3.SS3.p1.3.m3.1.1.3.2" xref="S3.SS3.p1.3.m3.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p1.3.m3.1.1.3.1" xref="S3.SS3.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS3.p1.3.m3.1.1.3.3" xref="S3.SS3.p1.3.m3.1.1.3.3.cmml">F</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝐿</ci><apply id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><times id="S3.SS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.1"></times><ci id="S3.SS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2">𝑠</ci><ci id="S3.SS3.p1.3.m3.1.1.3.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">L_{sF}</annotation></semantics></math> in Eq. 2. 
<br class="ltx_break"><math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="S_{k-d}" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">S</mi><mrow id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">k</mi><mo id="S3.SS3.p1.4.m4.1.1.3.1" xref="S3.SS3.p1.4.m4.1.1.3.1.cmml">−</mo><mi id="S3.SS3.p1.4.m4.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.cmml">d</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑆</ci><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><minus id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3.1"></minus><ci id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">𝑘</ci><ci id="S3.SS3.p1.4.m4.1.1.3.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">S_{k-d}</annotation></semantics></math> is the size of data sent by the client <math id="S3.SS3.p1.5.m5.1" class="ltx_Math" alttext="\it{k}" display="inline"><semantics id="S3.SS3.p1.5.m5.1a"><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">\it{k}</annotation></semantics></math> and <math id="S3.SS3.p1.6.m6.1" class="ltx_Math" alttext="S_{m}" display="inline"><semantics id="S3.SS3.p1.6.m6.1a"><msub id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml"><mi id="S3.SS3.p1.6.m6.1.1.2" xref="S3.SS3.p1.6.m6.1.1.2.cmml">S</mi><mi id="S3.SS3.p1.6.m6.1.1.3" xref="S3.SS3.p1.6.m6.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><apply id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.1.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.1.1.2.cmml" xref="S3.SS3.p1.6.m6.1.1.2">𝑆</ci><ci id="S3.SS3.p1.6.m6.1.1.3.cmml" xref="S3.SS3.p1.6.m6.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">S_{m}</annotation></semantics></math> is the size of the model. In the centralized training, <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="d_{k}" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><msub id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml"><mi id="S3.SS3.p1.7.m7.1.1.2" xref="S3.SS3.p1.7.m7.1.1.2.cmml">d</mi><mi id="S3.SS3.p1.7.m7.1.1.3" xref="S3.SS3.p1.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><apply id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.1.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.1.1.2.cmml" xref="S3.SS3.p1.7.m7.1.1.2">𝑑</ci><ci id="S3.SS3.p1.7.m7.1.1.3.cmml" xref="S3.SS3.p1.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">d_{k}</annotation></semantics></math> is the number of hops between client <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="\it{k}" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><mi id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\it{k}</annotation></semantics></math> and the server.</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="L_{sC}=\sum_{k=1}^{N}S_{k-d}\times d_{k}" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><msub id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.2.2" xref="S3.E1.m1.1.1.2.2.cmml">L</mi><mrow id="S3.E1.m1.1.1.2.3" xref="S3.E1.m1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.2.3.2" xref="S3.E1.m1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.2.3.1" xref="S3.E1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.2.3.3" xref="S3.E1.m1.1.1.2.3.3.cmml">C</mi></mrow></msub><mo rspace="0.111em" id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><munderover id="S3.E1.m1.1.1.3.1" xref="S3.E1.m1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.3.1.2.2" xref="S3.E1.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.3.1.2.3" xref="S3.E1.m1.1.1.3.1.2.3.cmml"><mi id="S3.E1.m1.1.1.3.1.2.3.2" xref="S3.E1.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E1.m1.1.1.3.1.2.3.1" xref="S3.E1.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.3.1.2.3.3" xref="S3.E1.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.3.1.3" xref="S3.E1.m1.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml"><msub id="S3.E1.m1.1.1.3.2.2" xref="S3.E1.m1.1.1.3.2.2.cmml"><mi id="S3.E1.m1.1.1.3.2.2.2" xref="S3.E1.m1.1.1.3.2.2.2.cmml">S</mi><mrow id="S3.E1.m1.1.1.3.2.2.3" xref="S3.E1.m1.1.1.3.2.2.3.cmml"><mi id="S3.E1.m1.1.1.3.2.2.3.2" xref="S3.E1.m1.1.1.3.2.2.3.2.cmml">k</mi><mo id="S3.E1.m1.1.1.3.2.2.3.1" xref="S3.E1.m1.1.1.3.2.2.3.1.cmml">−</mo><mi id="S3.E1.m1.1.1.3.2.2.3.3" xref="S3.E1.m1.1.1.3.2.2.3.3.cmml">d</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.1.1.3.2.1" xref="S3.E1.m1.1.1.3.2.1.cmml">×</mo><msub id="S3.E1.m1.1.1.3.2.3" xref="S3.E1.m1.1.1.3.2.3.cmml"><mi id="S3.E1.m1.1.1.3.2.3.2" xref="S3.E1.m1.1.1.3.2.3.2.cmml">d</mi><mi id="S3.E1.m1.1.1.3.2.3.3" xref="S3.E1.m1.1.1.3.2.3.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"></eq><apply id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.2">subscript</csymbol><ci id="S3.E1.m1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.2.2">𝐿</ci><apply id="S3.E1.m1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.2.3"><times id="S3.E1.m1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.2.3.1"></times><ci id="S3.E1.m1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.2.3.2">𝑠</ci><ci id="S3.E1.m1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.2.3.3">𝐶</ci></apply></apply><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><apply id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.1.cmml" xref="S3.E1.m1.1.1.3.1">superscript</csymbol><apply id="S3.E1.m1.1.1.3.1.2.cmml" xref="S3.E1.m1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.2.1.cmml" xref="S3.E1.m1.1.1.3.1">subscript</csymbol><sum id="S3.E1.m1.1.1.3.1.2.2.cmml" xref="S3.E1.m1.1.1.3.1.2.2"></sum><apply id="S3.E1.m1.1.1.3.1.2.3.cmml" xref="S3.E1.m1.1.1.3.1.2.3"><eq id="S3.E1.m1.1.1.3.1.2.3.1.cmml" xref="S3.E1.m1.1.1.3.1.2.3.1"></eq><ci id="S3.E1.m1.1.1.3.1.2.3.2.cmml" xref="S3.E1.m1.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E1.m1.1.1.3.1.2.3.3.cmml" xref="S3.E1.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.3.1.3.cmml" xref="S3.E1.m1.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2"><times id="S3.E1.m1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.3.2.1"></times><apply id="S3.E1.m1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.2.2.1.cmml" xref="S3.E1.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.2.2.cmml" xref="S3.E1.m1.1.1.3.2.2.2">𝑆</ci><apply id="S3.E1.m1.1.1.3.2.2.3.cmml" xref="S3.E1.m1.1.1.3.2.2.3"><minus id="S3.E1.m1.1.1.3.2.2.3.1.cmml" xref="S3.E1.m1.1.1.3.2.2.3.1"></minus><ci id="S3.E1.m1.1.1.3.2.2.3.2.cmml" xref="S3.E1.m1.1.1.3.2.2.3.2">𝑘</ci><ci id="S3.E1.m1.1.1.3.2.2.3.3.cmml" xref="S3.E1.m1.1.1.3.2.2.3.3">𝑑</ci></apply></apply><apply id="S3.E1.m1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.2.3.1.cmml" xref="S3.E1.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.3.2.cmml" xref="S3.E1.m1.1.1.3.2.3.2">𝑑</ci><ci id="S3.E1.m1.1.1.3.2.3.3.cmml" xref="S3.E1.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">L_{sC}=\sum_{k=1}^{N}S_{k-d}\times d_{k}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="L_{sF}=S_{m}\times\sum_{r=1}^{r_{max}}\sum_{k=1}^{K}d_{k,r}" display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.3" xref="S3.E2.m1.2.3.cmml"><msub id="S3.E2.m1.2.3.2" xref="S3.E2.m1.2.3.2.cmml"><mi id="S3.E2.m1.2.3.2.2" xref="S3.E2.m1.2.3.2.2.cmml">L</mi><mrow id="S3.E2.m1.2.3.2.3" xref="S3.E2.m1.2.3.2.3.cmml"><mi id="S3.E2.m1.2.3.2.3.2" xref="S3.E2.m1.2.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.3.2.3.1" xref="S3.E2.m1.2.3.2.3.1.cmml">​</mo><mi id="S3.E2.m1.2.3.2.3.3" xref="S3.E2.m1.2.3.2.3.3.cmml">F</mi></mrow></msub><mo id="S3.E2.m1.2.3.1" xref="S3.E2.m1.2.3.1.cmml">=</mo><mrow id="S3.E2.m1.2.3.3" xref="S3.E2.m1.2.3.3.cmml"><msub id="S3.E2.m1.2.3.3.2" xref="S3.E2.m1.2.3.3.2.cmml"><mi id="S3.E2.m1.2.3.3.2.2" xref="S3.E2.m1.2.3.3.2.2.cmml">S</mi><mi id="S3.E2.m1.2.3.3.2.3" xref="S3.E2.m1.2.3.3.2.3.cmml">m</mi></msub><mo lspace="0.222em" rspace="0.055em" id="S3.E2.m1.2.3.3.1" xref="S3.E2.m1.2.3.3.1.cmml">×</mo><mrow id="S3.E2.m1.2.3.3.3" xref="S3.E2.m1.2.3.3.3.cmml"><munderover id="S3.E2.m1.2.3.3.3.1" xref="S3.E2.m1.2.3.3.3.1.cmml"><mo movablelimits="false" rspace="0em" id="S3.E2.m1.2.3.3.3.1.2.2" xref="S3.E2.m1.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.3.3.3.1.2.3" xref="S3.E2.m1.2.3.3.3.1.2.3.cmml"><mi id="S3.E2.m1.2.3.3.3.1.2.3.2" xref="S3.E2.m1.2.3.3.3.1.2.3.2.cmml">r</mi><mo id="S3.E2.m1.2.3.3.3.1.2.3.1" xref="S3.E2.m1.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.2.3.3.3.1.2.3.3" xref="S3.E2.m1.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><msub id="S3.E2.m1.2.3.3.3.1.3" xref="S3.E2.m1.2.3.3.3.1.3.cmml"><mi id="S3.E2.m1.2.3.3.3.1.3.2" xref="S3.E2.m1.2.3.3.3.1.3.2.cmml">r</mi><mrow id="S3.E2.m1.2.3.3.3.1.3.3" xref="S3.E2.m1.2.3.3.3.1.3.3.cmml"><mi id="S3.E2.m1.2.3.3.3.1.3.3.2" xref="S3.E2.m1.2.3.3.3.1.3.3.2.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.3.3.3.1.3.3.1" xref="S3.E2.m1.2.3.3.3.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.2.3.3.3.1.3.3.3" xref="S3.E2.m1.2.3.3.3.1.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.3.3.3.1.3.3.1a" xref="S3.E2.m1.2.3.3.3.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.2.3.3.3.1.3.3.4" xref="S3.E2.m1.2.3.3.3.1.3.3.4.cmml">x</mi></mrow></msub></munderover><mrow id="S3.E2.m1.2.3.3.3.2" xref="S3.E2.m1.2.3.3.3.2.cmml"><munderover id="S3.E2.m1.2.3.3.3.2.1" xref="S3.E2.m1.2.3.3.3.2.1.cmml"><mo movablelimits="false" id="S3.E2.m1.2.3.3.3.2.1.2.2" xref="S3.E2.m1.2.3.3.3.2.1.2.2.cmml">∑</mo><mrow id="S3.E2.m1.2.3.3.3.2.1.2.3" xref="S3.E2.m1.2.3.3.3.2.1.2.3.cmml"><mi id="S3.E2.m1.2.3.3.3.2.1.2.3.2" xref="S3.E2.m1.2.3.3.3.2.1.2.3.2.cmml">k</mi><mo id="S3.E2.m1.2.3.3.3.2.1.2.3.1" xref="S3.E2.m1.2.3.3.3.2.1.2.3.1.cmml">=</mo><mn id="S3.E2.m1.2.3.3.3.2.1.2.3.3" xref="S3.E2.m1.2.3.3.3.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.2.3.3.3.2.1.3" xref="S3.E2.m1.2.3.3.3.2.1.3.cmml">K</mi></munderover><msub id="S3.E2.m1.2.3.3.3.2.2" xref="S3.E2.m1.2.3.3.3.2.2.cmml"><mi id="S3.E2.m1.2.3.3.3.2.2.2" xref="S3.E2.m1.2.3.3.3.2.2.2.cmml">d</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">k</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">r</mi></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.3.cmml" xref="S3.E2.m1.2.3"><eq id="S3.E2.m1.2.3.1.cmml" xref="S3.E2.m1.2.3.1"></eq><apply id="S3.E2.m1.2.3.2.cmml" xref="S3.E2.m1.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.2.1.cmml" xref="S3.E2.m1.2.3.2">subscript</csymbol><ci id="S3.E2.m1.2.3.2.2.cmml" xref="S3.E2.m1.2.3.2.2">𝐿</ci><apply id="S3.E2.m1.2.3.2.3.cmml" xref="S3.E2.m1.2.3.2.3"><times id="S3.E2.m1.2.3.2.3.1.cmml" xref="S3.E2.m1.2.3.2.3.1"></times><ci id="S3.E2.m1.2.3.2.3.2.cmml" xref="S3.E2.m1.2.3.2.3.2">𝑠</ci><ci id="S3.E2.m1.2.3.2.3.3.cmml" xref="S3.E2.m1.2.3.2.3.3">𝐹</ci></apply></apply><apply id="S3.E2.m1.2.3.3.cmml" xref="S3.E2.m1.2.3.3"><times id="S3.E2.m1.2.3.3.1.cmml" xref="S3.E2.m1.2.3.3.1"></times><apply id="S3.E2.m1.2.3.3.2.cmml" xref="S3.E2.m1.2.3.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.2.1.cmml" xref="S3.E2.m1.2.3.3.2">subscript</csymbol><ci id="S3.E2.m1.2.3.3.2.2.cmml" xref="S3.E2.m1.2.3.3.2.2">𝑆</ci><ci id="S3.E2.m1.2.3.3.2.3.cmml" xref="S3.E2.m1.2.3.3.2.3">𝑚</ci></apply><apply id="S3.E2.m1.2.3.3.3.cmml" xref="S3.E2.m1.2.3.3.3"><apply id="S3.E2.m1.2.3.3.3.1.cmml" xref="S3.E2.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.3.1.1.cmml" xref="S3.E2.m1.2.3.3.3.1">superscript</csymbol><apply id="S3.E2.m1.2.3.3.3.1.2.cmml" xref="S3.E2.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.3.1.2.1.cmml" xref="S3.E2.m1.2.3.3.3.1">subscript</csymbol><sum id="S3.E2.m1.2.3.3.3.1.2.2.cmml" xref="S3.E2.m1.2.3.3.3.1.2.2"></sum><apply id="S3.E2.m1.2.3.3.3.1.2.3.cmml" xref="S3.E2.m1.2.3.3.3.1.2.3"><eq id="S3.E2.m1.2.3.3.3.1.2.3.1.cmml" xref="S3.E2.m1.2.3.3.3.1.2.3.1"></eq><ci id="S3.E2.m1.2.3.3.3.1.2.3.2.cmml" xref="S3.E2.m1.2.3.3.3.1.2.3.2">𝑟</ci><cn type="integer" id="S3.E2.m1.2.3.3.3.1.2.3.3.cmml" xref="S3.E2.m1.2.3.3.3.1.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.2.3.3.3.1.3.cmml" xref="S3.E2.m1.2.3.3.3.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.3.1.3.1.cmml" xref="S3.E2.m1.2.3.3.3.1.3">subscript</csymbol><ci id="S3.E2.m1.2.3.3.3.1.3.2.cmml" xref="S3.E2.m1.2.3.3.3.1.3.2">𝑟</ci><apply id="S3.E2.m1.2.3.3.3.1.3.3.cmml" xref="S3.E2.m1.2.3.3.3.1.3.3"><times id="S3.E2.m1.2.3.3.3.1.3.3.1.cmml" xref="S3.E2.m1.2.3.3.3.1.3.3.1"></times><ci id="S3.E2.m1.2.3.3.3.1.3.3.2.cmml" xref="S3.E2.m1.2.3.3.3.1.3.3.2">𝑚</ci><ci id="S3.E2.m1.2.3.3.3.1.3.3.3.cmml" xref="S3.E2.m1.2.3.3.3.1.3.3.3">𝑎</ci><ci id="S3.E2.m1.2.3.3.3.1.3.3.4.cmml" xref="S3.E2.m1.2.3.3.3.1.3.3.4">𝑥</ci></apply></apply></apply><apply id="S3.E2.m1.2.3.3.3.2.cmml" xref="S3.E2.m1.2.3.3.3.2"><apply id="S3.E2.m1.2.3.3.3.2.1.cmml" xref="S3.E2.m1.2.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.3.2.1.1.cmml" xref="S3.E2.m1.2.3.3.3.2.1">superscript</csymbol><apply id="S3.E2.m1.2.3.3.3.2.1.2.cmml" xref="S3.E2.m1.2.3.3.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.3.2.1.2.1.cmml" xref="S3.E2.m1.2.3.3.3.2.1">subscript</csymbol><sum id="S3.E2.m1.2.3.3.3.2.1.2.2.cmml" xref="S3.E2.m1.2.3.3.3.2.1.2.2"></sum><apply id="S3.E2.m1.2.3.3.3.2.1.2.3.cmml" xref="S3.E2.m1.2.3.3.3.2.1.2.3"><eq id="S3.E2.m1.2.3.3.3.2.1.2.3.1.cmml" xref="S3.E2.m1.2.3.3.3.2.1.2.3.1"></eq><ci id="S3.E2.m1.2.3.3.3.2.1.2.3.2.cmml" xref="S3.E2.m1.2.3.3.3.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E2.m1.2.3.3.3.2.1.2.3.3.cmml" xref="S3.E2.m1.2.3.3.3.2.1.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.2.3.3.3.2.1.3.cmml" xref="S3.E2.m1.2.3.3.3.2.1.3">𝐾</ci></apply><apply id="S3.E2.m1.2.3.3.3.2.2.cmml" xref="S3.E2.m1.2.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.3.3.3.2.2.1.cmml" xref="S3.E2.m1.2.3.3.3.2.2">subscript</csymbol><ci id="S3.E2.m1.2.3.3.3.2.2.2.cmml" xref="S3.E2.m1.2.3.3.3.2.2.2">𝑑</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑘</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑟</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">L_{sF}=S_{m}\times\sum_{r=1}^{r_{max}}\sum_{k=1}^{K}d_{k,r}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.12" class="ltx_p">where <math id="S3.SS3.p1.9.m1.2" class="ltx_Math" alttext="d_{k,r}" display="inline"><semantics id="S3.SS3.p1.9.m1.2a"><msub id="S3.SS3.p1.9.m1.2.3" xref="S3.SS3.p1.9.m1.2.3.cmml"><mi id="S3.SS3.p1.9.m1.2.3.2" xref="S3.SS3.p1.9.m1.2.3.2.cmml">d</mi><mrow id="S3.SS3.p1.9.m1.2.2.2.4" xref="S3.SS3.p1.9.m1.2.2.2.3.cmml"><mi id="S3.SS3.p1.9.m1.1.1.1.1" xref="S3.SS3.p1.9.m1.1.1.1.1.cmml">k</mi><mo id="S3.SS3.p1.9.m1.2.2.2.4.1" xref="S3.SS3.p1.9.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p1.9.m1.2.2.2.2" xref="S3.SS3.p1.9.m1.2.2.2.2.cmml">r</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m1.2b"><apply id="S3.SS3.p1.9.m1.2.3.cmml" xref="S3.SS3.p1.9.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.9.m1.2.3.1.cmml" xref="S3.SS3.p1.9.m1.2.3">subscript</csymbol><ci id="S3.SS3.p1.9.m1.2.3.2.cmml" xref="S3.SS3.p1.9.m1.2.3.2">𝑑</ci><list id="S3.SS3.p1.9.m1.2.2.2.3.cmml" xref="S3.SS3.p1.9.m1.2.2.2.4"><ci id="S3.SS3.p1.9.m1.1.1.1.1.cmml" xref="S3.SS3.p1.9.m1.1.1.1.1">𝑘</ci><ci id="S3.SS3.p1.9.m1.2.2.2.2.cmml" xref="S3.SS3.p1.9.m1.2.2.2.2">𝑟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m1.2c">d_{k,r}</annotation></semantics></math> is the number of hops between the client <math id="S3.SS3.p1.10.m2.1" class="ltx_Math" alttext="\it{k}" display="inline"><semantics id="S3.SS3.p1.10.m2.1a"><mi id="S3.SS3.p1.10.m2.1.1" xref="S3.SS3.p1.10.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m2.1b"><ci id="S3.SS3.p1.10.m2.1.1.cmml" xref="S3.SS3.p1.10.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m2.1c">\it{k}</annotation></semantics></math> selected in round <math id="S3.SS3.p1.11.m3.1" class="ltx_Math" alttext="\it{r}" display="inline"><semantics id="S3.SS3.p1.11.m3.1a"><mi id="S3.SS3.p1.11.m3.1.1" xref="S3.SS3.p1.11.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m3.1b"><ci id="S3.SS3.p1.11.m3.1.1.cmml" xref="S3.SS3.p1.11.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m3.1c">\it{r}</annotation></semantics></math> and the server, and <math id="S3.SS3.p1.12.m4.1" class="ltx_Math" alttext="\it{K}" display="inline"><semantics id="S3.SS3.p1.12.m4.1a"><mi id="S3.SS3.p1.12.m4.1.1" xref="S3.SS3.p1.12.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m4.1b"><ci id="S3.SS3.p1.12.m4.1.1.cmml" xref="S3.SS3.p1.12.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m4.1c">\it{K}</annotation></semantics></math> is the number of users in each subset.
<br class="ltx_break">Using Eq.1 and Eq.2, we define the gain in networking load as follows :</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="G_{s}=1-L_{sF}/L_{sC}" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msub id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.2.2" xref="S3.E3.m1.1.1.2.2.cmml">G</mi><mi id="S3.E3.m1.1.1.2.3" xref="S3.E3.m1.1.1.2.3.cmml">s</mi></msub><mo id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml">=</mo><mrow id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mn id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml">1</mn><mo id="S3.E3.m1.1.1.3.1" xref="S3.E3.m1.1.1.3.1.cmml">−</mo><mrow id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml"><msub id="S3.E3.m1.1.1.3.3.2" xref="S3.E3.m1.1.1.3.3.2.cmml"><mi id="S3.E3.m1.1.1.3.3.2.2" xref="S3.E3.m1.1.1.3.3.2.2.cmml">L</mi><mrow id="S3.E3.m1.1.1.3.3.2.3" xref="S3.E3.m1.1.1.3.3.2.3.cmml"><mi id="S3.E3.m1.1.1.3.3.2.3.2" xref="S3.E3.m1.1.1.3.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.3.2.3.1" xref="S3.E3.m1.1.1.3.3.2.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.3.3.2.3.3" xref="S3.E3.m1.1.1.3.3.2.3.3.cmml">F</mi></mrow></msub><mo id="S3.E3.m1.1.1.3.3.1" xref="S3.E3.m1.1.1.3.3.1.cmml">/</mo><msub id="S3.E3.m1.1.1.3.3.3" xref="S3.E3.m1.1.1.3.3.3.cmml"><mi id="S3.E3.m1.1.1.3.3.3.2" xref="S3.E3.m1.1.1.3.3.3.2.cmml">L</mi><mrow id="S3.E3.m1.1.1.3.3.3.3" xref="S3.E3.m1.1.1.3.3.3.3.cmml"><mi id="S3.E3.m1.1.1.3.3.3.3.2" xref="S3.E3.m1.1.1.3.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.3.3.3.1" xref="S3.E3.m1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.3.3.3.3.3" xref="S3.E3.m1.1.1.3.3.3.3.3.cmml">C</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"></eq><apply id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.2.2">𝐺</ci><ci id="S3.E3.m1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.2.3">𝑠</ci></apply><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><minus id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3.1"></minus><cn type="integer" id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2">1</cn><apply id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3"><divide id="S3.E3.m1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1"></divide><apply id="S3.E3.m1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.2.1.cmml" xref="S3.E3.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.2.2.cmml" xref="S3.E3.m1.1.1.3.3.2.2">𝐿</ci><apply id="S3.E3.m1.1.1.3.3.2.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3"><times id="S3.E3.m1.1.1.3.3.2.3.1.cmml" xref="S3.E3.m1.1.1.3.3.2.3.1"></times><ci id="S3.E3.m1.1.1.3.3.2.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2.3.2">𝑠</ci><ci id="S3.E3.m1.1.1.3.3.2.3.3.cmml" xref="S3.E3.m1.1.1.3.3.2.3.3">𝐹</ci></apply></apply><apply id="S3.E3.m1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.3.2">𝐿</ci><apply id="S3.E3.m1.1.1.3.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3.3"><times id="S3.E3.m1.1.1.3.3.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.3.3.1"></times><ci id="S3.E3.m1.1.1.3.3.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.3.3.2">𝑠</ci><ci id="S3.E3.m1.1.1.3.3.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3.3.3">𝐶</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">G_{s}=1-L_{sF}/L_{sC}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Simulation and results</span>
</h2>

<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">Dataset Pre-Processing and Evaluation Method</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">This research was conducted using data from Pecan Street Inc. Dataport site. Dataport contains unique, circuit-level electricity use data at one-minute to one-second intervals for approximately 800 homes in the United States, with Photovoltaics generation and Electrical Vehicles charging data for a subset of these homes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. We chose a subset of 200 clients who have similar properties from this dataset. It is composed of the same kind of houses (detached-family homes), located in the same area (Texas). The dataset is composed of records between January 1st 2019 and March 31st 2019 with a one-hour resolution data. The weather fluctuations in this period are low, so the seasonal factor can be ignored in this study.
The data of each client is prepared to be ready for further analysis. First, we transform the data to be in a scale between 0 and 1. Then we transform the time series into sliding windows with look-backs of size 12 and a look-ahead of size 1. Finally, we split data into train and test subsets (90% for training and 10% for test). We also split the clients into two groups : 180 participating in the federated learning process, and 20 are left for further evaluation for how well the model can fit non-participating clients.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.4" class="ltx_p">We use RMSE and MAPE to evaluate the model’s performance with regard to the prediction error. RMSE allows us to quantify the error in terms of energy, while MAPE is a percentage quantifying the size of the error relative to the real value. The expressions of RMSE and MAPE are as follows:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.1" class="ltx_Math" alttext="RMSE=\sqrt{\frac{\sum_{i=1}^{P}(y_{i}-\hat{y_{i}})^{2}}{N}}" display="block"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.2" xref="S4.E4.m1.1.2.cmml"><mrow id="S4.E4.m1.1.2.2" xref="S4.E4.m1.1.2.2.cmml"><mi id="S4.E4.m1.1.2.2.2" xref="S4.E4.m1.1.2.2.2.cmml">R</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.2.2.1" xref="S4.E4.m1.1.2.2.1.cmml">​</mo><mi id="S4.E4.m1.1.2.2.3" xref="S4.E4.m1.1.2.2.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.2.2.1a" xref="S4.E4.m1.1.2.2.1.cmml">​</mo><mi id="S4.E4.m1.1.2.2.4" xref="S4.E4.m1.1.2.2.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.2.2.1b" xref="S4.E4.m1.1.2.2.1.cmml">​</mo><mi id="S4.E4.m1.1.2.2.5" xref="S4.E4.m1.1.2.2.5.cmml">E</mi></mrow><mo id="S4.E4.m1.1.2.1" xref="S4.E4.m1.1.2.1.cmml">=</mo><msqrt id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><mfrac id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.cmml"><msubsup id="S4.E4.m1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.2.cmml"><mo id="S4.E4.m1.1.1.1.1.1.2.2.2" xref="S4.E4.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E4.m1.1.1.1.1.1.2.2.3" xref="S4.E4.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.1.2.2.3.2" xref="S4.E4.m1.1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E4.m1.1.1.1.1.1.2.2.3.1" xref="S4.E4.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E4.m1.1.1.1.1.1.2.2.3.3" xref="S4.E4.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E4.m1.1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.1.2.3.cmml">P</mi></msubsup><msup id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="S4.E4.m1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mover accent="true" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml"><msub id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mi id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml">^</mo></mover></mrow><mo stretchy="false" id="S4.E4.m1.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E4.m1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mi id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.1.1.1.3.cmml">N</mi></mfrac></msqrt></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.2.cmml" xref="S4.E4.m1.1.2"><eq id="S4.E4.m1.1.2.1.cmml" xref="S4.E4.m1.1.2.1"></eq><apply id="S4.E4.m1.1.2.2.cmml" xref="S4.E4.m1.1.2.2"><times id="S4.E4.m1.1.2.2.1.cmml" xref="S4.E4.m1.1.2.2.1"></times><ci id="S4.E4.m1.1.2.2.2.cmml" xref="S4.E4.m1.1.2.2.2">𝑅</ci><ci id="S4.E4.m1.1.2.2.3.cmml" xref="S4.E4.m1.1.2.2.3">𝑀</ci><ci id="S4.E4.m1.1.2.2.4.cmml" xref="S4.E4.m1.1.2.2.4">𝑆</ci><ci id="S4.E4.m1.1.2.2.5.cmml" xref="S4.E4.m1.1.2.2.5">𝐸</ci></apply><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><root id="S4.E4.m1.1.1a.cmml" xref="S4.E4.m1.1.1"></root><apply id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><divide id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1"></divide><apply id="S4.E4.m1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1"><apply id="S4.E4.m1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S4.E4.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.2.2.2"></sum><apply id="S4.E4.m1.1.1.1.1.1.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.2.2.3"><eq id="S4.E4.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E4.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E4.m1.1.1.1.1.1.2.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E4.m1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.2.3">𝑃</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"><minus id="S4.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3"><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.1">^</ci><apply id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.2">𝑦</ci><ci id="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S4.E4.m1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.3">2</cn></apply></apply><ci id="S4.E4.m1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">RMSE=\sqrt{\frac{\sum_{i=1}^{P}(y_{i}-\hat{y_{i}})^{2}}{N}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<br class="ltx_break">
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.1" class="ltx_Math" alttext="MAPE={\frac{100\%}{P}}\sum_{i=1}^{P}\left|\frac{y_{i}-\hat{y_{i}}}{y_{i}}\right|" display="block"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.2" xref="S4.E5.m1.1.2.cmml"><mrow id="S4.E5.m1.1.2.2" xref="S4.E5.m1.1.2.2.cmml"><mi id="S4.E5.m1.1.2.2.2" xref="S4.E5.m1.1.2.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.2.2.1" xref="S4.E5.m1.1.2.2.1.cmml">​</mo><mi id="S4.E5.m1.1.2.2.3" xref="S4.E5.m1.1.2.2.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.2.2.1a" xref="S4.E5.m1.1.2.2.1.cmml">​</mo><mi id="S4.E5.m1.1.2.2.4" xref="S4.E5.m1.1.2.2.4.cmml">P</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.2.2.1b" xref="S4.E5.m1.1.2.2.1.cmml">​</mo><mi id="S4.E5.m1.1.2.2.5" xref="S4.E5.m1.1.2.2.5.cmml">E</mi></mrow><mo id="S4.E5.m1.1.2.1" xref="S4.E5.m1.1.2.1.cmml">=</mo><mrow id="S4.E5.m1.1.2.3" xref="S4.E5.m1.1.2.3.cmml"><mfrac id="S4.E5.m1.1.2.3.2" xref="S4.E5.m1.1.2.3.2.cmml"><mrow id="S4.E5.m1.1.2.3.2.2" xref="S4.E5.m1.1.2.3.2.2.cmml"><mn id="S4.E5.m1.1.2.3.2.2.2" xref="S4.E5.m1.1.2.3.2.2.2.cmml">100</mn><mo id="S4.E5.m1.1.2.3.2.2.1" xref="S4.E5.m1.1.2.3.2.2.1.cmml">%</mo></mrow><mi id="S4.E5.m1.1.2.3.2.3" xref="S4.E5.m1.1.2.3.2.3.cmml">P</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.2.3.1" xref="S4.E5.m1.1.2.3.1.cmml">​</mo><mrow id="S4.E5.m1.1.2.3.3" xref="S4.E5.m1.1.2.3.3.cmml"><munderover id="S4.E5.m1.1.2.3.3.1" xref="S4.E5.m1.1.2.3.3.1.cmml"><mo movablelimits="false" rspace="0em" id="S4.E5.m1.1.2.3.3.1.2.2" xref="S4.E5.m1.1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E5.m1.1.2.3.3.1.2.3" xref="S4.E5.m1.1.2.3.3.1.2.3.cmml"><mi id="S4.E5.m1.1.2.3.3.1.2.3.2" xref="S4.E5.m1.1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S4.E5.m1.1.2.3.3.1.2.3.1" xref="S4.E5.m1.1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E5.m1.1.2.3.3.1.2.3.3" xref="S4.E5.m1.1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E5.m1.1.2.3.3.1.3" xref="S4.E5.m1.1.2.3.3.1.3.cmml">P</mi></munderover><mrow id="S4.E5.m1.1.2.3.3.2.2" xref="S4.E5.m1.1.2.3.3.2.1.cmml"><mo id="S4.E5.m1.1.2.3.3.2.2.1" xref="S4.E5.m1.1.2.3.3.2.1.1.cmml">|</mo><mfrac id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml"><mrow id="S4.E5.m1.1.1.2" xref="S4.E5.m1.1.1.2.cmml"><msub id="S4.E5.m1.1.1.2.2" xref="S4.E5.m1.1.1.2.2.cmml"><mi id="S4.E5.m1.1.1.2.2.2" xref="S4.E5.m1.1.1.2.2.2.cmml">y</mi><mi id="S4.E5.m1.1.1.2.2.3" xref="S4.E5.m1.1.1.2.2.3.cmml">i</mi></msub><mo id="S4.E5.m1.1.1.2.1" xref="S4.E5.m1.1.1.2.1.cmml">−</mo><mover accent="true" id="S4.E5.m1.1.1.2.3" xref="S4.E5.m1.1.1.2.3.cmml"><msub id="S4.E5.m1.1.1.2.3.2" xref="S4.E5.m1.1.1.2.3.2.cmml"><mi id="S4.E5.m1.1.1.2.3.2.2" xref="S4.E5.m1.1.1.2.3.2.2.cmml">y</mi><mi id="S4.E5.m1.1.1.2.3.2.3" xref="S4.E5.m1.1.1.2.3.2.3.cmml">i</mi></msub><mo id="S4.E5.m1.1.1.2.3.1" xref="S4.E5.m1.1.1.2.3.1.cmml">^</mo></mover></mrow><msub id="S4.E5.m1.1.1.3" xref="S4.E5.m1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.3.2" xref="S4.E5.m1.1.1.3.2.cmml">y</mi><mi id="S4.E5.m1.1.1.3.3" xref="S4.E5.m1.1.1.3.3.cmml">i</mi></msub></mfrac><mo id="S4.E5.m1.1.2.3.3.2.2.2" xref="S4.E5.m1.1.2.3.3.2.1.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.2.cmml" xref="S4.E5.m1.1.2"><eq id="S4.E5.m1.1.2.1.cmml" xref="S4.E5.m1.1.2.1"></eq><apply id="S4.E5.m1.1.2.2.cmml" xref="S4.E5.m1.1.2.2"><times id="S4.E5.m1.1.2.2.1.cmml" xref="S4.E5.m1.1.2.2.1"></times><ci id="S4.E5.m1.1.2.2.2.cmml" xref="S4.E5.m1.1.2.2.2">𝑀</ci><ci id="S4.E5.m1.1.2.2.3.cmml" xref="S4.E5.m1.1.2.2.3">𝐴</ci><ci id="S4.E5.m1.1.2.2.4.cmml" xref="S4.E5.m1.1.2.2.4">𝑃</ci><ci id="S4.E5.m1.1.2.2.5.cmml" xref="S4.E5.m1.1.2.2.5">𝐸</ci></apply><apply id="S4.E5.m1.1.2.3.cmml" xref="S4.E5.m1.1.2.3"><times id="S4.E5.m1.1.2.3.1.cmml" xref="S4.E5.m1.1.2.3.1"></times><apply id="S4.E5.m1.1.2.3.2.cmml" xref="S4.E5.m1.1.2.3.2"><divide id="S4.E5.m1.1.2.3.2.1.cmml" xref="S4.E5.m1.1.2.3.2"></divide><apply id="S4.E5.m1.1.2.3.2.2.cmml" xref="S4.E5.m1.1.2.3.2.2"><csymbol cd="latexml" id="S4.E5.m1.1.2.3.2.2.1.cmml" xref="S4.E5.m1.1.2.3.2.2.1">percent</csymbol><cn type="integer" id="S4.E5.m1.1.2.3.2.2.2.cmml" xref="S4.E5.m1.1.2.3.2.2.2">100</cn></apply><ci id="S4.E5.m1.1.2.3.2.3.cmml" xref="S4.E5.m1.1.2.3.2.3">𝑃</ci></apply><apply id="S4.E5.m1.1.2.3.3.cmml" xref="S4.E5.m1.1.2.3.3"><apply id="S4.E5.m1.1.2.3.3.1.cmml" xref="S4.E5.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.2.3.3.1.1.cmml" xref="S4.E5.m1.1.2.3.3.1">superscript</csymbol><apply id="S4.E5.m1.1.2.3.3.1.2.cmml" xref="S4.E5.m1.1.2.3.3.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.2.3.3.1.2.1.cmml" xref="S4.E5.m1.1.2.3.3.1">subscript</csymbol><sum id="S4.E5.m1.1.2.3.3.1.2.2.cmml" xref="S4.E5.m1.1.2.3.3.1.2.2"></sum><apply id="S4.E5.m1.1.2.3.3.1.2.3.cmml" xref="S4.E5.m1.1.2.3.3.1.2.3"><eq id="S4.E5.m1.1.2.3.3.1.2.3.1.cmml" xref="S4.E5.m1.1.2.3.3.1.2.3.1"></eq><ci id="S4.E5.m1.1.2.3.3.1.2.3.2.cmml" xref="S4.E5.m1.1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E5.m1.1.2.3.3.1.2.3.3.cmml" xref="S4.E5.m1.1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E5.m1.1.2.3.3.1.3.cmml" xref="S4.E5.m1.1.2.3.3.1.3">𝑃</ci></apply><apply id="S4.E5.m1.1.2.3.3.2.1.cmml" xref="S4.E5.m1.1.2.3.3.2.2"><abs id="S4.E5.m1.1.2.3.3.2.1.1.cmml" xref="S4.E5.m1.1.2.3.3.2.2.1"></abs><apply id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"><divide id="S4.E5.m1.1.1.1.cmml" xref="S4.E5.m1.1.1"></divide><apply id="S4.E5.m1.1.1.2.cmml" xref="S4.E5.m1.1.1.2"><minus id="S4.E5.m1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.2.1"></minus><apply id="S4.E5.m1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.2.2.1.cmml" xref="S4.E5.m1.1.1.2.2">subscript</csymbol><ci id="S4.E5.m1.1.1.2.2.2.cmml" xref="S4.E5.m1.1.1.2.2.2">𝑦</ci><ci id="S4.E5.m1.1.1.2.2.3.cmml" xref="S4.E5.m1.1.1.2.2.3">𝑖</ci></apply><apply id="S4.E5.m1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.2.3"><ci id="S4.E5.m1.1.1.2.3.1.cmml" xref="S4.E5.m1.1.1.2.3.1">^</ci><apply id="S4.E5.m1.1.1.2.3.2.cmml" xref="S4.E5.m1.1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.2.3.2.1.cmml" xref="S4.E5.m1.1.1.2.3.2">subscript</csymbol><ci id="S4.E5.m1.1.1.2.3.2.2.cmml" xref="S4.E5.m1.1.1.2.3.2.2">𝑦</ci><ci id="S4.E5.m1.1.1.2.3.2.3.cmml" xref="S4.E5.m1.1.1.2.3.2.3">𝑖</ci></apply></apply></apply><apply id="S4.E5.m1.1.1.3.cmml" xref="S4.E5.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.3.2">𝑦</ci><ci id="S4.E5.m1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">MAPE={\frac{100\%}{P}}\sum_{i=1}^{P}\left|\frac{y_{i}-\hat{y_{i}}}{y_{i}}\right|</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.3" class="ltx_p">where <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\hat{y_{i}}" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mover accent="true" id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml"><msub id="S4.SS1.p2.1.m1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.2.cmml"><mi id="S4.SS1.p2.1.m1.1.1.2.2" xref="S4.SS1.p2.1.m1.1.1.2.2.cmml">y</mi><mi id="S4.SS1.p2.1.m1.1.1.2.3" xref="S4.SS1.p2.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS1.p2.1.m1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1"><ci id="S4.SS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1">^</ci><apply id="S4.SS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.2.1.cmml" xref="S4.SS1.p2.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.2.2.cmml" xref="S4.SS1.p2.1.m1.1.1.2.2">𝑦</ci><ci id="S4.SS1.p2.1.m1.1.1.2.3.cmml" xref="S4.SS1.p2.1.m1.1.1.2.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\hat{y_{i}}</annotation></semantics></math> is the predicted value, <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><msub id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml"><mi id="S4.SS1.p2.2.m2.1.1.2" xref="S4.SS1.p2.2.m2.1.1.2.cmml">y</mi><mi id="S4.SS1.p2.2.m2.1.1.3" xref="S4.SS1.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><apply id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.2.m2.1.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p2.2.m2.1.1.2.cmml" xref="S4.SS1.p2.2.m2.1.1.2">𝑦</ci><ci id="S4.SS1.p2.2.m2.1.1.3.cmml" xref="S4.SS1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">y_{i}</annotation></semantics></math> is the actual value and <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\it{P}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><ci id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">\it{P}</annotation></semantics></math> is the number of predicted values.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Simulations setup</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">The simulations were conducted on a laptop with a 2,2 GHz Intel i7 processor and 16GB of memory and NVIDIA GeForce GTX 1070 graphic card. We used Tensorflow Federated 0.4.0 with Tensorflow 1.13.1 backend.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">Hyper-parameter tuning in deep learning models is important to obtain the best forecasting performance. However, in this work, we only focus on evaluating the federated learning paradigm. Previous work shows performance insensitivity to combinations of some layers and layer size, as long as we use multiple layers and that the number of hidden nodes is sufficiently large <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. It was also suggested that very deep networks are prone to under-fitting and vanishing gradients. Following these rules, the initial model hyper-parameters (e.g number of layers, and time steps to be considered) were chosen by random search on a randomly selected client’s data.
The retained model has two LSTM hidden layers composed of 200 neurons each. The loss function used is Mean squared error and the optimiser chosen is Adam.
The model converges around the 20th epoch and thus we use close values for rounds and epochs.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.4.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.5.2" class="ltx_text ltx_font_italic">Numerical Results</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p"><span id="S4.SS3.p1.1.1" class="ltx_text ltx_font_italic">1) Evaluated scenarios:</span>

<br class="ltx_break">The different scenarios that were evaluated are summarized in Table I. As explained in the previous section, in each round, only a subset of clients train the model. We modify the number of clients in the subset selected in each round, to see the effect of larger subsets.We also vary the number of epochs of local training. In all the scenarios, the federated learning algorithm was run for 20 rounds.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.2.1.1" class="ltx_text" style="font-size:90%;">TABLE I</span>: </span><span id="S4.T1.3.2" class="ltx_text" style="font-size:90%;">Used scenarios</span></figcaption>
<table id="S4.T1.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.4.1.1" class="ltx_tr">
<td id="S4.T1.4.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Scenarios</td>
<td id="S4.T1.4.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Clients in subset</td>
<td id="S4.T1.4.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Local Epochs</td>
</tr>
<tr id="S4.T1.4.2.2" class="ltx_tr">
<td id="S4.T1.4.2.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">1</td>
<td id="S4.T1.4.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5</td>
<td id="S4.T1.4.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1</td>
</tr>
<tr id="S4.T1.4.3.3" class="ltx_tr">
<td id="S4.T1.4.3.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">2</td>
<td id="S4.T1.4.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">20</td>
<td id="S4.T1.4.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1</td>
</tr>
<tr id="S4.T1.4.4.4" class="ltx_tr">
<td id="S4.T1.4.4.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">3</td>
<td id="S4.T1.4.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5</td>
<td id="S4.T1.4.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">5</td>
</tr>
<tr id="S4.T1.4.5.5" class="ltx_tr">
<td id="S4.T1.4.5.5.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">4</td>
<td id="S4.T1.4.5.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">20</td>
<td id="S4.T1.4.5.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">5</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p"><span id="S4.SS3.p2.1.1" class="ltx_text ltx_font_italic">2) Results for global models:</span>

<br class="ltx_break">The evaluated scenarios resulted in global models that are obtained following the federated learning approach. These models are evaluated in terms of RMSE and MAPE as shown in Tables II and III. Null consumption values have been disgarded when calculating MAPE.
Table II summarizes the results for the participating clients in the different scenarios.
In our case, the load forecast is on a granular level (single house) and on a short term (1 hour), therefore the values of MAPE achieved in Table II for various models are reasonable, and this level of accuracy is anticipated as similar values have been reported by previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. These works also report that the forecasting accuracy tends to be low for short-term forecasting horizons.
One of the most notable things we notice is that the global model fits some clients better than others when considering the fact that not all clients have similar profiles.
We also notice that selecting a bigger number of clients in each round is preferable, but in cases where sending updates is more expensive in terms of networking, the difference can be compensated by using more local training epochs. The results are similar when applied to the set of clients who did not participate in the training.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.2.1.1" class="ltx_text" style="font-size:90%;">TABLE II</span>: </span><span id="S4.T2.3.2" class="ltx_text" style="font-size:90%;">Resulting RMSE and MAPE for global models in the considered scenarios for the 180 participating clients</span></figcaption>
<table id="S4.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.4.1.1" class="ltx_tr">
<th id="S4.T2.4.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S4.T2.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">RMSE</th>
<th id="S4.T2.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">MAPE</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.4.2.1" class="ltx_tr">
<th id="S4.T2.4.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Scenario</th>
<td id="S4.T2.4.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S4.T2.4.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S4.T2.4.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S4.T2.4.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S4.T2.4.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S4.T2.4.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
</tr>
<tr id="S4.T2.4.3.2" class="ltx_tr">
<th id="S4.T2.4.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">1</th>
<td id="S4.T2.4.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.070</td>
<td id="S4.T2.4.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.652</td>
<td id="S4.T2.4.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.605</td>
<td id="S4.T2.4.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10.65%</td>
<td id="S4.T2.4.3.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">83.35%</td>
<td id="S4.T2.4.3.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">41.40%</td>
</tr>
<tr id="S4.T2.4.4.3" class="ltx_tr">
<th id="S4.T2.4.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">2</th>
<td id="S4.T2.4.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.045</td>
<td id="S4.T2.4.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.55</td>
<td id="S4.T2.4.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.578</td>
<td id="S4.T2.4.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">9.18%</td>
<td id="S4.T2.4.4.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">87.63%</td>
<td id="S4.T2.4.4.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">38.39%</td>
</tr>
<tr id="S4.T2.4.5.4" class="ltx_tr">
<th id="S4.T2.4.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">3</th>
<td id="S4.T2.4.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.026</td>
<td id="S4.T2.4.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.652</td>
<td id="S4.T2.4.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.576</td>
<td id="S4.T2.4.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">9.45%</td>
<td id="S4.T2.4.5.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">96.84%</td>
<td id="S4.T2.4.5.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">37.43%</td>
</tr>
<tr id="S4.T2.4.6.5" class="ltx_tr">
<th id="S4.T2.4.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">4</th>
<td id="S4.T2.4.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.047</td>
<td id="S4.T2.4.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">2.68</td>
<td id="S4.T2.4.6.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.583</td>
<td id="S4.T2.4.6.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">9.71%</td>
<td id="S4.T2.4.6.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">93.74%</td>
<td id="S4.T2.4.6.5.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">38.91%</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T3.2.1.1" class="ltx_text" style="font-size:90%;">TABLE III</span>: </span><span id="S4.T3.3.2" class="ltx_text" style="font-size:90%;">Resulting RMSE and MAPE for global models in the considered scenarios for the 20 non-participant clients</span></figcaption>
<table id="S4.T3.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T3.4.1.1" class="ltx_tr">
<th id="S4.T3.4.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S4.T3.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">RMSE</th>
<th id="S4.T3.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">MAPE</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T3.4.2.1" class="ltx_tr">
<th id="S4.T3.4.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Scenario</th>
<td id="S4.T3.4.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S4.T3.4.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S4.T3.4.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S4.T3.4.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S4.T3.4.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S4.T3.4.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
</tr>
<tr id="S4.T3.4.3.2" class="ltx_tr">
<th id="S4.T3.4.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">1</th>
<td id="S4.T3.4.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.262</td>
<td id="S4.T3.4.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.024</td>
<td id="S4.T3.4.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.589</td>
<td id="S4.T3.4.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">15.82%</td>
<td id="S4.T3.4.3.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">60.72%</td>
<td id="S4.T3.4.3.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">44.98%</td>
</tr>
<tr id="S4.T3.4.4.3" class="ltx_tr">
<th id="S4.T3.4.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">2</th>
<td id="S4.T3.4.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.241</td>
<td id="S4.T3.4.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.979</td>
<td id="S4.T3.4.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.550</td>
<td id="S4.T3.4.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">16.08%</td>
<td id="S4.T3.4.4.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">55.34%</td>
<td id="S4.T3.4.4.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">40.95%</td>
</tr>
<tr id="S4.T3.4.5.4" class="ltx_tr">
<th id="S4.T3.4.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">3</th>
<td id="S4.T3.4.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.229</td>
<td id="S4.T3.4.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.99</td>
<td id="S4.T3.4.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.530</td>
<td id="S4.T3.4.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">15.78%</td>
<td id="S4.T3.4.5.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53.98%</td>
<td id="S4.T3.4.5.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">39.18%</td>
</tr>
<tr id="S4.T3.4.6.5" class="ltx_tr">
<th id="S4.T3.4.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">4</th>
<td id="S4.T3.4.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.235</td>
<td id="S4.T3.4.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">1.004</td>
<td id="S4.T3.4.6.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.543</td>
<td id="S4.T3.4.6.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">16.04%</td>
<td id="S4.T3.4.6.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">56.61%</td>
<td id="S4.T3.4.6.5.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">41.15%</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p"><span id="S4.SS3.p3.1.1" class="ltx_text ltx_font_italic">3) Behaviour of personalization:</span>

<br class="ltx_break">In this section, we study the effect of personalization on the performance of the models. First we test if re-training the model locally for the participant clients gives better results. Then we apply the same thing to the set of clients who did not participate in the training. The models were retrained for 5 epochs for each client. Results for the set of clients participating in the training are summarized in Table IV and for the non-participating clients in Table V. We notice an overall improvement of most of the models. For example, the model 1 has an overall improvement of 5.07% in terms of MAPE for the participating set of clients and of 4.78% on the non-participating clients set. However, for some clients, the performance can not be improved despite retraining, and this, as we mentioned earlier, is related to the quality of historical data points. Applying the models to these clients’ consumption profiles results in very high MAPE, which affects the average results. These clients should be treated as outliers, nonetheless, this is beyond the scope of this study.</p>
</div>
<figure id="S4.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T4.2.1.1" class="ltx_text" style="font-size:90%;">TABLE IV</span>: </span><span id="S4.T4.3.2" class="ltx_text" style="font-size:90%;">Resulting RMSE and MAPE after personalization over 180 clients</span></figcaption>
<table id="S4.T4.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T4.4.1.1" class="ltx_tr">
<th id="S4.T4.4.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S4.T4.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">RMSE</th>
<th id="S4.T4.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">MAPE</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T4.4.2.1" class="ltx_tr">
<th id="S4.T4.4.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Scenario</th>
<td id="S4.T4.4.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S4.T4.4.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S4.T4.4.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S4.T4.4.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S4.T4.4.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S4.T4.4.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
</tr>
<tr id="S4.T4.4.3.2" class="ltx_tr">
<th id="S4.T4.4.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">1</th>
<td id="S4.T4.4.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"> 0.0</td>
<td id="S4.T4.4.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.47</td>
<td id="S4.T4.4.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.550</td>
<td id="S4.T4.4.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">8.13%</td>
<td id="S4.T4.4.3.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">99.16%</td>
<td id="S4.T4.4.3.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">36.33%</td>
</tr>
<tr id="S4.T4.4.4.3" class="ltx_tr">
<th id="S4.T4.4.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">2</th>
<td id="S4.T4.4.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"> 0.0</td>
<td id="S4.T4.4.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.47</td>
<td id="S4.T4.4.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.551</td>
<td id="S4.T4.4.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">7.89%</td>
<td id="S4.T4.4.4.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">91.23%</td>
<td id="S4.T4.4.4.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">36.39%</td>
</tr>
<tr id="S4.T4.4.5.4" class="ltx_tr">
<th id="S4.T4.4.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">3</th>
<td id="S4.T4.4.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"> 0.0</td>
<td id="S4.T4.4.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">2.371</td>
<td id="S4.T4.4.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.536</td>
<td id="S4.T4.4.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">7.64%</td>
<td id="S4.T4.4.5.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">88.76%</td>
<td id="S4.T4.4.5.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">34.27%</td>
</tr>
<tr id="S4.T4.4.6.5" class="ltx_tr">
<th id="S4.T4.4.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">4</th>
<td id="S4.T4.4.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"> 0.0</td>
<td id="S4.T4.4.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">2.375</td>
<td id="S4.T4.4.6.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.536</td>
<td id="S4.T4.4.6.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">8.00%</td>
<td id="S4.T4.4.6.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">82.14%</td>
<td id="S4.T4.4.6.5.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">34.14%</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T5" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T5.2.1.1" class="ltx_text" style="font-size:90%;">TABLE V</span>: </span><span id="S4.T5.3.2" class="ltx_text" style="font-size:90%;">Resulting RMSE and MAPE after personalization for 20 non-participating clients</span></figcaption>
<table id="S4.T5.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T5.4.1.1" class="ltx_tr">
<th id="S4.T5.4.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t"></th>
<th id="S4.T5.4.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">RMSE</th>
<th id="S4.T5.4.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3">MAPE</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T5.4.2.1" class="ltx_tr">
<th id="S4.T5.4.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Scenario</th>
<td id="S4.T5.4.2.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S4.T5.4.2.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S4.T5.4.2.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
<td id="S4.T5.4.2.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Min</td>
<td id="S4.T5.4.2.1.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Max</td>
<td id="S4.T5.4.2.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Mean</td>
</tr>
<tr id="S4.T5.4.3.2" class="ltx_tr">
<th id="S4.T5.4.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">1</th>
<td id="S4.T5.4.3.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.232</td>
<td id="S4.T5.4.3.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.905</td>
<td id="S4.T5.4.3.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.516</td>
<td id="S4.T5.4.3.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">18.35%</td>
<td id="S4.T5.4.3.2.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">53.70%</td>
<td id="S4.T5.4.3.2.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">40.20%</td>
</tr>
<tr id="S4.T5.4.4.3" class="ltx_tr">
<th id="S4.T5.4.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">2</th>
<td id="S4.T5.4.4.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.233</td>
<td id="S4.T5.4.4.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.901</td>
<td id="S4.T5.4.4.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.516</td>
<td id="S4.T5.4.4.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">16.99%</td>
<td id="S4.T5.4.4.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">58.68%</td>
<td id="S4.T5.4.4.3.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">40.71%</td>
</tr>
<tr id="S4.T5.4.5.4" class="ltx_tr">
<th id="S4.T5.4.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">3</th>
<td id="S4.T5.4.5.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.235</td>
<td id="S4.T5.4.5.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.909</td>
<td id="S4.T5.4.5.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.516</td>
<td id="S4.T5.4.5.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">15.79%</td>
<td id="S4.T5.4.5.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">54.82%</td>
<td id="S4.T5.4.5.4.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">39.49%</td>
</tr>
<tr id="S4.T5.4.6.5" class="ltx_tr">
<th id="S4.T5.4.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t">4</th>
<td id="S4.T5.4.6.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.232</td>
<td id="S4.T5.4.6.5.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.907</td>
<td id="S4.T5.4.6.5.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">0.509</td>
<td id="S4.T5.4.6.5.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">15.96%</td>
<td id="S4.T5.4.6.5.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">52.96%</td>
<td id="S4.T5.4.6.5.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">39.01%</td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">To illustrate the improvements on predictions using personalization, we randomly selected a client from the participant set (client 4313) and a client from the non-participant set (client 8467). We applied the global model 4 and the corresponding personalized models. The actual load profiles and the predicted profiles are shown in Fig.3 and Fig.4. Both models fit the overall behaviour of the consumption profiles. 
<br class="ltx_break">We conclude that we can indeed train powerful models for a population’s consumption profiles using only a subset of the users forming it. For applications that have high accuracy requirements, the model can be retrained resulting in a personalized model that follows the profile’s curves better, yielding more accurate predictions. Nonetheless, the predictions obtained with the global model can be a good starting point for new clients who don’t have enough data for personalization.</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="/html/2201.11248/assets/x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="202" height="113" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S4.F3.3.2" class="ltx_text" style="font-size:90%;">Predictions for next hour consumption for client 4313 who participated in training the global model 4. Local training for 5 epochs reduced RMSE from 0.55 kW to 0.388 kW.</span></figcaption>
</figure>
<div id="S4.SS3.p5" class="ltx_para">
<br class="ltx_break">
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2201.11248/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="177" height="116" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.3.2" class="ltx_text" style="font-size:90%;">Predictions for next hour consumption for client 8467 who did not participate in training the global model 4. Local training for 5 epochs reduced RMSE from 0.8 kW to 0.72kW.</span></figcaption>
</figure>
<div id="S4.SS3.p6" class="ltx_para">
<p id="S4.SS3.p6.1" class="ltx_p"><span id="S4.SS3.p6.1.1" class="ltx_text ltx_font_italic">4) Gain in network load:</span>

<br class="ltx_break">To illustrate the gain in the network load, we can consider the most basic case where the distance between all the clients and the MEC server is 1-Hop. The size of the model is 1,9Kb and the size of the used data is 16Mb. Using Eq.3, the gain in the scenarios 1 and 3 is 97%, while scenarios 2 and 4 result in a gain of 90%. This is a significant gain, especially when considering that the approach could be applied at the scale of a city or bigger, for example.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Remarks &amp; future work</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">The feasibility of the proposed approach is dependent on the capabilities of the edge devices to perform local training. New IoT devices have sufficient computing hardware to run complex machine learning models, but training a neural network is very likely to compromise device performance. However, some lightweight machine learning frameworks have emerged such as Tensorflow Lite <span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://www.tensorflow.org/lite</span></span></span> which provides solid ground for future implementations. 
<br class="ltx_break">The accuracy of the models, even after personalization, still varies depending on the user. To improve the results, neural networks should be coupled with other methods, such as a prior clustering of clients using criteria other than the geographical proximity. Solving the problem of outliers in this context should also be investigated.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Individual short-term load forecasting is a challenging task considering the stochastic nature of consumption profiles. In this paper, we proposed a system model using Edge computing and federated learning to tackle privacy and data diversity challenges related to short-term load forecasting in the smart grid.To the best of our knowledge, this represents one of the first studies of federated learning in the smart grid context.
Unlike centralized methods, in the proposed system federated learning uses edge devices to train models, hence reducing security risks to the ones related to the device only.
We conducted experiments to evaluate the performance of both centralized and personalized models in federated settings. The simulations results show that it is a promising approach to create highly performing models with a significantly reduced networking load compared to a centralised model, while preserving the privacy of consumption data.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">ACKNOWLEDGEMENT</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">The authors would like to thank the Natural Sciences and Engineering Research Council of Canada, for the financial support of this research.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Elena Mocanu, Phuong H. Nguyen, Madeleine Gibescu, and Wil L. Kling.

</span>
<span class="ltx_bibblock">Deep learning for estimating building energy consumption.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">Sustainable Energy, Grids and Networks</span>, 6:91–99, June 2016.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
W. Kong, Z. Y. Dong, D. J. Hill, F. Luo, and Y. Xu.

</span>
<span class="ltx_bibblock">Short-Term Residential Load Forecasting Based on Resident
Behaviour Learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Power Systems</span>, 33(1):1087–1088, January
2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Dhaou Said et al.

</span>
<span class="ltx_bibblock">Advanced scheduling protocol for electric vehicle home charging with
time-of-use pricing.

</span>
<span class="ltx_bibblock">pages 6272–6276, June 2013.

</span>
<span class="ltx_bibblock">ISSN: 1938-1883.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
A. Almalaq and J. J. Zhang.

</span>
<span class="ltx_bibblock">Evolutionary Deep Learning-Based Energy Consumption
Prediction for Buildings.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">IEEE Access</span>, 7:1520–1531, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Salah Bouktif, Ali Fiaz, Ali Ouni, and Mohamed Adel Serhani.

</span>
<span class="ltx_bibblock">Optimal Deep Learning LSTM Model for Electric Load
Forecasting using Feature Selection and Genetic Algorithm:
Comparison with Machine Learning Approaches †.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">Energies</span>, 11(7):1636, July 2018.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Abderrahime Filali et al.

</span>
<span class="ltx_bibblock">Prediction-Based Switch Migration Scheduling for SDN Load
Balancing.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">ICC 2019 - 2019 IEEE International Conference on
Communications (ICC)</span>, pages 1–6, May 2019.

</span>
<span class="ltx_bibblock">ISSN: 1938-1883.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Yanbo Huang.

</span>
<span class="ltx_bibblock">Advances in Artificial Neural Networks – Methodological
Development and Application.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">Algorithms</span>, 2(3):973–1007, September 2009.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
B. Stephen, X. Tang, P. R. Harvey, S. Galloway, and K. I. Jennett.

</span>
<span class="ltx_bibblock">Incorporating Practice Theory in Sub-Profile Models for
Short Term Aggregated Residential Load Forecasting.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Smart Grid</span>, 8(4):1591–1598, July 2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
H. Shi, M. Xu, and R. Li.

</span>
<span class="ltx_bibblock">Deep Learning for Household Load Forecasting—A Novel
Pooling Deep RNN.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Smart Grid</span>, 9(5):5271–5280, September
2018.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
H. Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise
Agüera y Arcas.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
S. Hochreiter and J. Schmidhuber.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Neural Computation</span>, 9(8):1735–1780, November 1997.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Salah Bouktif, Ali Fiaz, Ali Ouni, and Mohamed Adel Serhani.

</span>
<span class="ltx_bibblock">Optimal Deep Learning LSTM Model for Electric Load
Forecasting using Feature Selection and Genetic Algorithm:
Comparison with Machine Learning Approaches †.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Energies</span>, 11(7):1636, July 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Jian Zheng, Cencen Xu, Ziang Zhang, and Xiaohua Li.

</span>
<span class="ltx_bibblock">Electric load forecasting in smart grids using
Long-Short-Term-Memory based Recurrent Neural Network.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">2017 51st Annual Conference on Information Sciences
and Systems (CISS)</span>, pages 1–6, March 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
D. L. Marino, K. Amarasinghe, and M. Manic.

</span>
<span class="ltx_bibblock">Building energy load forecasting using Deep Neural Networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">IECON 2016 - 42nd Annual Conference of the IEEE
Industrial Electronics Society</span>, pages 7046–7051, October 2016.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Guangya Zhu, Tin-Tai Chow, and Norman Tse.

</span>
<span class="ltx_bibblock">Short-term load forecasting coupled with weather profile generation
methodology.

</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Building Services Engineering Research and Technology</span>,
39(3):310–327, May 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Dhaou Said et al.

</span>
<span class="ltx_bibblock">Scheduling protocol with load managementfor EV charging.

</span>
<span class="ltx_bibblock">In <span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">2014 IEEE Global Communications Conference</span>, pages
362–367, December 2014.

</span>
<span class="ltx_bibblock">ISSN: 1930-529X.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Jihene Rezgui et al.

</span>
<span class="ltx_bibblock">Smart charge scheduling for EVs based on two-way communication.

</span>
<span class="ltx_bibblock">In <span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">2017 IEEE International Conference on Communications
(ICC)</span>, pages 1–6, May 2017.

</span>
<span class="ltx_bibblock">ISSN: 1938-1883.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
P. Kumar, Y. Lin, G. Bai, A. Paverd, J. S. Dong, and A. Martin.

</span>
<span class="ltx_bibblock">Smart Grid Metering Networks: A Survey on Security,
Privacy and Open Research Issues.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">IEEE Communications Surveys Tutorials</span>, pages 1–1, 2019.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
M. Badra and S. Zeadally.

</span>
<span class="ltx_bibblock">Design and Performance Analysis of a Virtual Ring
Architecture for Smart Grid Privacy.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Information Forensics and Security</span>,
9(2):321–329, February 2014.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Y. Gong, Y. Cai, Y. Guo, and Y. Fang.

</span>
<span class="ltx_bibblock">A Privacy-Preserving Scheme for Incentive-Based Demand
Response in the Smart Grid.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Smart Grid</span>, 7(3):1304–1313, May 2016.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
H. Park, H. Kim, K. Chun, J. Lee, S. Lim, and I. Yie.

</span>
<span class="ltx_bibblock">Untraceability of Group Signature Schemes based on Bilinear
Mapping and Their Improvement.

</span>
<span class="ltx_bibblock">In <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">Fourth International Conference on Information
Technology (ITNG’07)</span>, pages 747–753, April 2007.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Quoc-Viet Pham, Fang Fang, Vu Nguyen Ha, Mai Le, Zhiguo Ding, Long Bao Le, and
Won-Joo Hwang.

</span>
<span class="ltx_bibblock">A Survey of Multi-Access Edge Computing in 5g and Beyond:
Fundamentals, Technology Integration, and State-of-the-Art.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv:1906.08452 [cs, math]</span>, June 2019.

</span>
<span class="ltx_bibblock">arXiv: 1906.08452.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Andrew Hard, Kanishka Rao, Rajiv Mathews, Swaroop Ramaswamy, Françoise
Beaufays, Sean Augenstein, Hubert Eichner, Chloé Kiddon, and Daniel Ramage.

</span>
<span class="ltx_bibblock">Federated learning for mobile keyboard prediction.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Khe Chai Sim, Petr Zadrazil, and Françoise Beaufays.

</span>
<span class="ltx_bibblock">An Investigation into On-Device Personalization of
End-to-End Automatic Speech Recognition Models.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Interspeech 2019</span>, pages 774–778. ISCA, September 2019.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Keith Bonawitz, Vladimir Ivanov, Ben Kreuter, Antonio Marcedone, H. Brendan
McMahan, Sarvar Patel, Daniel Ramage, Aaron Segal, and Karn Seth.

</span>
<span class="ltx_bibblock">Practical Secure Aggregation for Federated Learning on
User-Held Data.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">arXiv:1611.04482 [cs, stat]</span>, November 2016.

</span>
<span class="ltx_bibblock">arXiv: 1611.04482.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Robin C. Geyer, Tassilo Klein, and Moin Nabi.

</span>
<span class="ltx_bibblock">Differentially Private Federated Learning: A Client Level
Perspective.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">arXiv:1712.07557 [cs, stat]</span>, December 2017.

</span>
<span class="ltx_bibblock">arXiv: 1712.07557.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Pecan street inc. dataport 2019 [online] https://dataport.pecanstreet.org/.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
W. Kong, Z. Y. Dong, Y. Jia, D. J. Hill, Y. Xu, and Y. Zhang.

</span>
<span class="ltx_bibblock">Short-Term Residential Load Forecasting Based on LSTM
Recurrent Neural Network.

</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">IEEE Transactions on Smart Grid</span>, 10(1):841–851, January 2019.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Matthew Rowe, Timur Yunusov, Stephen Haben, William Holderbaum, and Ben Potter.

</span>
<span class="ltx_bibblock">The Real-Time Optimisation of DNO Owned Storage Devices
on the LV Network for Peak Reduction.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Energies</span>, 7(6):3537–3560, June 2014.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2201.11247" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2201.11248" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2201.11248">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2201.11248" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2201.11249" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Mar  6 18:22:20 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
