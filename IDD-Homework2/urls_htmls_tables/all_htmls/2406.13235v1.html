<!DOCTYPE html>
<html lang="en" prefix="dcterms: http://purl.org/dc/terms/">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning</title>
<!--Generated on Wed Jun 19 05:43:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
Recommender System,  Large Language Model,  Graph Neural Network
" lang="en" name="keywords"/>
<base href="/html/2406.13235v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S1" title="In Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S2" title="In Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Related Works</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S2.SS1" title="In II Related Works ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-A</span> </span><span class="ltx_text ltx_font_italic">LLM-based Recommendations</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S2.SS2" title="In II Related Works ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">II-B</span> </span><span class="ltx_text ltx_font_italic">Integration of GNNs with LLMs</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S3" title="In Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">PRELIMINARY</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S3.SS1" title="In III PRELIMINARY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Problem Definition</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S3.SS2" title="In III PRELIMINARY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Instruction Tuning</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4" title="In Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">METHODOLOGY</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.SS1" title="In IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-A</span> </span><span class="ltx_text ltx_font_italic">External Embeddings</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.SS2" title="In IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-B</span> </span><span class="ltx_text ltx_font_italic">Prompt Construction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.SS3" title="In IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-C</span> </span><span class="ltx_text ltx_font_italic">Graph-Aware Learning</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.SS4" title="In IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-D</span> </span><span class="ltx_text ltx_font_italic">MoCo-based Dynamic Queue Storage</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.SS5" title="In IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">IV-E</span> </span><span class="ltx_text ltx_font_italic">Optimization</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5" title="In Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">EXPERIMENTS</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.SS1" title="In V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-A</span> </span><span class="ltx_text ltx_font_italic">Experimental Setup</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.SS2" title="In V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-B</span> </span><span class="ltx_text ltx_font_italic">Performance Comparison (RQ1)</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.SS3" title="In V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-C</span> </span><span class="ltx_text ltx_font_italic">Ablation Study (RQ2)</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.SS4" title="In V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-D</span> </span><span class="ltx_text ltx_font_italic">Distribution Uniformity Analysis (RQ3)</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.SS5" title="In V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">V-E</span> </span><span class="ltx_text ltx_font_italic">Parameter Analyses (RQ4)</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S6" title="In Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">VI </span><span class="ltx_text ltx_font_smallcaps">CONCLUSIONS</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhong Guan, Likang Wu <span class="ltx_ERROR undefined" id="id1.1.id1">\orcidlink</span>0000-0002-4929-8587, Hongke Zhao <span class="ltx_ERROR undefined" id="id2.2.id2">\orcidlink</span>0000-0003-3099-4803, Ming He <span class="ltx_ERROR undefined" id="id3.3.id3">\orcidlink</span>0000-0002-1870-7472, Jianpin Fan <span class="ltx_ERROR undefined" id="id4.4.id4">\orcidlink</span>0000-0003-2290-1785
</span><span class="ltx_author_notes">Zhong Guan, Likang Wu, Hongke Zhao are with the College of Management and Economics, Laboratory of Computation and Analytics of Complex Management Systems (CACMS),Tianjin University, Tianjin 30072, China (e-mail: gz851508778@tju.edu.cn; wlkktmzgl@gmail.com; hongke@tju.edu.cn,).Ming He and Jianping Fan are with the AI Lab at Lenovo Research, Beijing 100000, China (e-mail: heming01@foxmail.com; jfan1@lenovo.com).</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id5.id1">Large Language Models (LLMs) are increasingly prominent in the recommendation systems domain. Existing studies usually utilize in-context learning or supervised fine-tuning on task-specific data to align LLMs into recommendations. However, the substantial bias in semantic spaces between language processing tasks and recommendation tasks poses a nonnegligible challenge. Specifically, without the adequate capturing ability of collaborative information, existing modeling paradigms struggle to capture behavior patterns within community groups, leading to LLMs’ ineffectiveness in discerning implicit interaction semantic in recommendation scenarios. To address this, we consider enhancing the learning capability of language model-driven recommendation models for structured data, specifically by utilizing interaction graphs rich in collaborative semantics. We propose a <span class="ltx_text ltx_font_bold" id="id5.id1.1">G</span>raph-<span class="ltx_text ltx_font_bold" id="id5.id1.2">A</span>ware Learning for <span class="ltx_text ltx_font_bold" id="id5.id1.3">L</span>anguage Model-Driven <span class="ltx_text ltx_font_bold" id="id5.id1.4">Rec</span>ommendations (GAL-Rec). GAL-Rec enhances the understanding of user-item collaborative semantics by imitating the intent of Graph Neural Networks (GNNs) to aggregate multi-hop information, thereby fully exploiting the substantial learning capacity of LLMs to independently address the complex graphs in the recommendation system. Sufficient experimental results on three real-world datasets demonstrate that GAL-Rec significantly enhances the comprehension of collaborative semantics, and improves recommendation performance.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Recommender System, Large Language Model, Graph Neural Network

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large Language Models (LLMs) like ChatGPT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib2" title="">2</a>]</cite> and LLaMA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib3" title="">3</a>]</cite> have shown remarkable proficiency in tasks involving semantic understanding and knowledge inference. Consequently, LLMs are now being employed in a diverse range of tasks and domains  <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib10" title="">10</a>]</cite>. Recommendation systems are anticipated to derive substantial advantages from the advancements in LLMs.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Motivated by these developments, employing LLMs is increasingly becoming a focal point in recommendation system research. This involves positioning LLMs as predictors in recommendation systems through prompts based on natural language <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib13" title="">13</a>]</cite>. Initially, LLMs were engaged in recommendation tasks via in-context learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib14" title="">14</a>]</cite>. However, substantial research has shown that LLMs, when pre-trained on general natural language corpora, lack the domain-specific knowledge and capabilities required for recommendation tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib11" title="">11</a>]</cite>. Consequently, there is a shift towards fine-tuning LLMs using domain-specific recommendation data to significantly enhance their performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib18" title="">18</a>]</cite>. Yet, these methods of fine-tuning can’t bridge the performance gap between LLMs and traditional recommendation models. LLMs, trained within a natural language paradigm, primarily focus on acquiring explicit knowledge but still fall short in understanding implicit interactions within recommendation systems, thereby failing to mine the interaction relationship between users and items.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="649" id="S1.F1.g1" src="x1.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The differences between LLMs and traditional models in distinguishing items.</figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Within recommendation scenarios, the interaction data between users and items manifest as interaction graphs. Current LLMs are not adept at extracting implicit information from these interaction graph datasets. Utilizing LLMs in recommendation systems encounters two significant issues:</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p4">
<p class="ltx_p" id="S1.p4.1"><span class="ltx_text ltx_font_italic" id="S1.p4.1.1">1). A misalignment exists between the semantic space of LLMs and the semantic space of user-item collaborative information.</span></p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">The semantic space of natural language is inconsistent with the semantic space of collaborative information <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib17" title="">17</a>]</cite>, and merely through supervised fine-tuning, it is difficult to align different semantic spaces. This alignment challenge hinders LLMs from identifying a unified semantic subspace. Consequently, natural language-based LLMs struggle to distinguish similar items with subtle differences. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S1.F1" title="Figure 1 ‣ I Introduction ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">1</span></a>, in the same broad category, items with minor textual differences accessed by different users show clear distinctions in the semantic space of collaborative information, but appear more consistent in the semantic space of LLMs.</p>
</div>
<div class="ltx_para ltx_noindent" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><span class="ltx_text ltx_font_italic" id="S1.p6.1.1">2). The training paradigms of LLMs are not well-suited to align with the behavioral patterns observed in recommendation system communities.</span></p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">While LLMs are adept at learning frequent patterns that can be formalized as knowledge, they are less effective in mining and leveraging the behavioral patterns prevalent within communities <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib18" title="">18</a>]</cite>. Specifically, LLMs face challenges in modeling implicit user-item interaction information. In contrast, representative models like GNNs are capable of effectively modeling the topological structures within user-item bipartite graphs.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1">Therefore, to enable LLMs to capture semantic information in graph structures, we introduce the GAL-Rec framework, which jointly models the language understanding capabilities of LLMs with the aggregation intent of GNNs in the field of graph modeling. However, using a general strategy of simply and directly fusing the representations of the two does not allow the language model to learn structural modal knowledge and therefore cannot align the representation space. When designing learning paradigms, we have encountered the following technical challenges:</p>
</div>
<div class="ltx_para" id="S1.p9">
<p class="ltx_p" id="S1.p9.1">i). How can LLMs be enabled to recognize the complex structure of user-item graphs?</p>
</div>
<div class="ltx_para" id="S1.p10">
<p class="ltx_p" id="S1.p10.1">ii). How can the issue of negative sample collection for LLMs be addressed under graph-aware learning?</p>
</div>
<div class="ltx_para" id="S1.p11">
<p class="ltx_p" id="S1.p11.1">Initially, to enhance LLMs’ receptive field and capture multi-hop information, we devised a prompt structure that ingeniously includes both users’ past interactions and data from users sharing common items, mirroring the incorporation of one- and two-hop neighbors in a graph. Subsequently, to enhance LLM’s comprehension of collaborative information, we were inspired by the aggregation strategy employed in GNNs, adopting a graph-aware contrastive learning approach. This strategy enables LLMs to explicitly assimilate the interaction dynamics between users and items, thus improving LLM’s performance through the implementation of GNN’s aggregation techniques on bipartite graphs. And it suggests that a user’s two-hop information (<span class="ltx_text ltx_font_italic" id="S1.p11.1.1">user-2-hop</span>) should align closely with their own profile (<span class="ltx_text ltx_font_italic" id="S1.p11.1.2">user-0-hop</span>). Similarly, a user’s one-hop information <span class="ltx_text ltx_font_italic" id="S1.p11.1.3">(user-1-hop) </span>should align with the information of the item they interacted with (<span class="ltx_text ltx_font_italic" id="S1.p11.1.4">item-0-hop</span>), and the user’s two-hop information (<span class="ltx_text ltx_font_italic" id="S1.p11.1.5">user-2-hop</span>) should align with the one-hop information of the item (<span class="ltx_text ltx_font_italic" id="S1.p11.1.6">item-1-hop</span>). The same holds true for items. After constructing positive sample pairs through the aforementioned operations, we employ dynamic queue storage based on Moco <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib21" title="">21</a>]</cite> to collect and update the set of negative samples, catering to the requirements of graph-aware learning, a contrastive learning strategy.
This framework, which draws inspiration from GNN’s aggregation methodology and graph contrastive learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib22" title="">22</a>]</cite>, facilitates a deeper understanding of collaborative embeddings in LLMs.</p>
</div>
<div class="ltx_para" id="S1.p12">
<p class="ltx_p" id="S1.p12.1">In summary, we conclude our main contributions as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We introduced a novel (GAL-Rec) framework, designed to facilitate graph-aware learning for enhanced comprehension of collaborative information by LLMs, thereby enabling LLMRec to understand the interaction graph data in recommendation system.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We first proposed graph-aware learning for collaborative semantics extraction in GAL-Rec, fully harnessing the vast potential of LLMs and aligning them with recommendations in a self-supervised manner.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Extensive experimental results on real-world datasets demonstrate that our proposed GAL outperforms several state-of-the-art models in terms of performance.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Related Works</span>
</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In this section, we review the applications of LLMs in recommendation systems as well as the work that combines LLMs with GNNs.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS1.5.1.1">II-A</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS1.6.2">LLM-based Recommendations</span>
</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Recently, there has been a growing focus on integrating large language models into recommendation systems, owing to the emergence of these powerful models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib17" title="">17</a>]</cite>. Here we introduce some representative works. Initially, researchers used public APIs like ChatGPT for in-context learning and implemented recommendation system applications through conversational interaction functions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib11" title="">11</a>]</cite>. However, due to the significant gap between recommendation tasks and LLM’s pre-training, in-context learning could only have good effects in cold-start scenarios and was greatly limited in warm-start scenarios <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib14" title="">14</a>]</cite>. To enhance LLMs’ capabilities in recommendation contexts, some studies have focused on fine-tuning them with recommendation-specific datasets <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib23" title="">23</a>]</cite>. For instance, P5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib15" title="">15</a>]</cite> relies on the tokenizer used by LLM (Sentence Piece tokenizer) to generate item ID tokens, M6 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib24" title="">24</a>]</cite> considers using item text information (names) as item IDs, Shashank <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib16" title="">16</a>]</cite> explores the use of semantic ID models for generative recommendation systems and proves their effectiveness, applying special quantization methods to the textual embeddings of items to form semantic IDs for items.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">However, simple directive-based fine-tuning is insufficient to bridge the substantial gap between recommendation tasks and the inherent capabilities of LLMs. LLMs still lack an understanding of collaborative information and insufficient learning of implicit interaction information in recommendation tasks. CoLLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib17" title="">17</a>]</cite> adopts a two-tiered fine-tuning strategy for LLMs. The first stage is aimed at acclimatizing the LLMs to the specificities of recommendation tasks. The second stage is focused on imparting an understanding of collaborative information. Contrastively, Qiu <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib18" title="">18</a>]</cite> employs contrastive learning across diverse instructional datasets to more efficiently align the representations of natural language and collaborative information in LLMs. Huang <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib25" title="">25</a>]</cite> et al. investigated various methods of injecting collaborative signals into LLMs by encoding item IDs. Different from the above works, our architecture (GAL-Rec) encourages self-supervised learning and understanding of collaborative information through a contrastive learning framework, enabling LLMs to effectively utilize and further improve the collaborative information captured by traditional recommendation models.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S2.SS2.5.1.1">II-B</span> </span><span class="ltx_text ltx_font_italic" id="S2.SS2.6.2">Integration of GNNs with LLMs</span>
</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The integration of LLMs with GNNs in existing research primarily falls into two categories:</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">i). LLM as Enhancer.
Initially, LLMs were primarily employed for feature encoding, where their embeddings were utilized as node features in graphs for GNN training <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib28" title="">28</a>]</cite>. Subsequent developments led to the joint training and collaborative learning of LLMs and GNNs <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib30" title="">30</a>]</cite>. For instance, GLEM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib7" title="">7</a>]</cite> integrates LLMs and GNNs using a pseudo-likelihood variational framework, allowing each component to be trained independently, thus ensuring scalability and effectiveness. OFA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib31" title="">31</a>]</cite> unifies various datasets and tasks by leveraging LLMs to represent node information, introducing node prompts and graph prompt paradigms for cross-task and dataset learning in GNNs. TAPE <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib32" title="">32</a>]</cite> leverages advanced LLMs for textual analysis of Text-Attribute Graphs, with the derived embeddings subsequently utilized for a variety of tasks in GNNs. LLMRG <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib33" title="">33</a>]</cite> employs large language models for graph structure enhancement, specifically augmenting user-item interaction edges, item node attributes, and user profiles. This approach explicitly infers user-item interaction patterns, addressing the challenge of sparse implicit feedback signals.
ii). LLM as the Predictor.
The success of LLMs has also sparked interest in using them as predictors for addressing graph-structured tasks. Research like <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib20" title="">20</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib34" title="">34</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib36" title="">36</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib37" title="">37</a>]</cite>focuses on describing graph structures through textual language, aiming for LLMs to capture graph-related signals. GraphText <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib38" title="">38</a>]</cite> introduces a versatile graph reasoning framework for context learning and directive fine-tuning of graph structures. GLRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib39" title="">39</a>]</cite> creates a meta-path prompt constructor, facilitating LLMs’ understanding of varied behavioral information sequences in heterogeneous graphs. Despite these advancements, LLMs struggle with structured data translated into natural language, often yielding suboptimal results. To overcome this challenge, LLaGA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib40" title="">40</a>]</cite> reformulates node link information as sequential data, applying instruction tuning that LLMs can comprehend while maintaining structural node information. TP <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib41" title="">41</a>]</cite> simulated the message propagation process of GNN, utilized LLM to propose and aggregate similar questions, promoting the form of ”message propagation” in response generation. In contrast, our method places greater emphasis on enabling LLMs to actively learn the GNN aggregation paradigm on bipartite graphs, thereby augmenting LLM performance. Furthermore, the above studies predominantly explore LLMs as predictors within the context of text-graph scenarios, focusing on node classification as the predictive task, our investigation delves deeper into the application of LLMs as predictors within recommendation systems.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">PRELIMINARY</span>
</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="525" id="S3.F2.g1" src="x2.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>An overall illustration of our proposed learning architecture. The left panel shows the selection of information with different hops, and the right performs graph-aware learning.</figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.5.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.6.2">Problem Definition</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.19">Consider two set of: <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">caligraphic_U</annotation></semantics></math>={<math alttext="u_{1}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><msub id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.2" xref="S3.SS1.p1.2.m2.1.1.2.cmml">u</mi><mn id="S3.SS1.p1.2.m2.1.1.3" xref="S3.SS1.p1.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><apply id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.2">𝑢</ci><cn id="S3.SS1.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">u_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="u_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">u</mi><mn id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑢</ci><cn id="S3.SS1.p1.3.m3.1.1.3.cmml" type="integer" xref="S3.SS1.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">u_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, …, <math alttext="u_{n}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">u</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑢</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">u_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_u start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>} and <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">caligraphic_I</annotation></semantics></math>={<math alttext="i_{1}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><msub id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">i</mi><mn id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝑖</ci><cn id="S3.SS1.p1.6.m6.1.1.3.cmml" type="integer" xref="S3.SS1.p1.6.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">i_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="i_{2}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><msub id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml"><mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">i</mi><mn id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">𝑖</ci><cn id="S3.SS1.p1.7.m7.1.1.3.cmml" type="integer" xref="S3.SS1.p1.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">i_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, …, <math alttext="i_{m}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1"><semantics id="S3.SS1.p1.8.m8.1a"><msub id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml"><mi id="S3.SS1.p1.8.m8.1.1.2" xref="S3.SS1.p1.8.m8.1.1.2.cmml">i</mi><mi id="S3.SS1.p1.8.m8.1.1.3" xref="S3.SS1.p1.8.m8.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b"><apply id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m8.1.1.2.cmml" xref="S3.SS1.p1.8.m8.1.1.2">𝑖</ci><ci id="S3.SS1.p1.8.m8.1.1.3.cmml" xref="S3.SS1.p1.8.m8.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">i_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.1d">italic_i start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>}, representing <math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_N</annotation></semantics></math> users and <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_M</annotation></semantics></math> items, respectively. Generally, a user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><mi id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><ci id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_u</annotation></semantics></math> has a chronologically-ordered interaction sequence with items: {<math alttext="i_{1}" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><msub id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml"><mi id="S3.SS1.p1.12.m12.1.1.2" xref="S3.SS1.p1.12.m12.1.1.2.cmml">i</mi><mn id="S3.SS1.p1.12.m12.1.1.3" xref="S3.SS1.p1.12.m12.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><apply id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m12.1.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m12.1.1.2.cmml" xref="S3.SS1.p1.12.m12.1.1.2">𝑖</ci><cn id="S3.SS1.p1.12.m12.1.1.3.cmml" type="integer" xref="S3.SS1.p1.12.m12.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">i_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>,…,<math alttext="i_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><msub id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">i</mi><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1">subscript</csymbol><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝑖</ci><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">i_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>}, where <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><mi id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><ci id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">italic_k</annotation></semantics></math> is the number of interactions and <math alttext="i_{t}" class="ltx_Math" display="inline" id="S3.SS1.p1.15.m15.1"><semantics id="S3.SS1.p1.15.m15.1a"><msub id="S3.SS1.p1.15.m15.1.1" xref="S3.SS1.p1.15.m15.1.1.cmml"><mi id="S3.SS1.p1.15.m15.1.1.2" xref="S3.SS1.p1.15.m15.1.1.2.cmml">i</mi><mi id="S3.SS1.p1.15.m15.1.1.3" xref="S3.SS1.p1.15.m15.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.15.m15.1b"><apply id="S3.SS1.p1.15.m15.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.15.m15.1.1.1.cmml" xref="S3.SS1.p1.15.m15.1.1">subscript</csymbol><ci id="S3.SS1.p1.15.m15.1.1.2.cmml" xref="S3.SS1.p1.15.m15.1.1.2">𝑖</ci><ci id="S3.SS1.p1.15.m15.1.1.3.cmml" xref="S3.SS1.p1.15.m15.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.15.m15.1c">i_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.15.m15.1d">italic_i start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the t-th item that the user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS1.p1.16.m16.1"><semantics id="S3.SS1.p1.16.m16.1a"><mi id="S3.SS1.p1.16.m16.1.1" xref="S3.SS1.p1.16.m16.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.16.m16.1b"><ci id="S3.SS1.p1.16.m16.1.1.cmml" xref="S3.SS1.p1.16.m16.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.16.m16.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.16.m16.1d">italic_u</annotation></semantics></math> has interacted with. Based on above notations, we can define the task of sequential recommendation. Formally, given the historical behavior of a user {<math alttext="i_{1}" class="ltx_Math" display="inline" id="S3.SS1.p1.17.m17.1"><semantics id="S3.SS1.p1.17.m17.1a"><msub id="S3.SS1.p1.17.m17.1.1" xref="S3.SS1.p1.17.m17.1.1.cmml"><mi id="S3.SS1.p1.17.m17.1.1.2" xref="S3.SS1.p1.17.m17.1.1.2.cmml">i</mi><mn id="S3.SS1.p1.17.m17.1.1.3" xref="S3.SS1.p1.17.m17.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.17.m17.1b"><apply id="S3.SS1.p1.17.m17.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.17.m17.1.1.1.cmml" xref="S3.SS1.p1.17.m17.1.1">subscript</csymbol><ci id="S3.SS1.p1.17.m17.1.1.2.cmml" xref="S3.SS1.p1.17.m17.1.1.2">𝑖</ci><cn id="S3.SS1.p1.17.m17.1.1.3.cmml" type="integer" xref="S3.SS1.p1.17.m17.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.17.m17.1c">i_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.17.m17.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>,…,<math alttext="i_{k}" class="ltx_Math" display="inline" id="S3.SS1.p1.18.m18.1"><semantics id="S3.SS1.p1.18.m18.1a"><msub id="S3.SS1.p1.18.m18.1.1" xref="S3.SS1.p1.18.m18.1.1.cmml"><mi id="S3.SS1.p1.18.m18.1.1.2" xref="S3.SS1.p1.18.m18.1.1.2.cmml">i</mi><mi id="S3.SS1.p1.18.m18.1.1.3" xref="S3.SS1.p1.18.m18.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.18.m18.1b"><apply id="S3.SS1.p1.18.m18.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.18.m18.1.1.1.cmml" xref="S3.SS1.p1.18.m18.1.1">subscript</csymbol><ci id="S3.SS1.p1.18.m18.1.1.2.cmml" xref="S3.SS1.p1.18.m18.1.1.2">𝑖</ci><ci id="S3.SS1.p1.18.m18.1.1.3.cmml" xref="S3.SS1.p1.18.m18.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.18.m18.1c">i_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.18.m18.1d">italic_i start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>}, the sequential recommendation task is to predict the next item that the user is likely to interact with at the <math alttext="(k+1)" class="ltx_Math" display="inline" id="S3.SS1.p1.19.m19.1"><semantics id="S3.SS1.p1.19.m19.1a"><mrow id="S3.SS1.p1.19.m19.1.1.1" xref="S3.SS1.p1.19.m19.1.1.1.1.cmml"><mo id="S3.SS1.p1.19.m19.1.1.1.2" stretchy="false" xref="S3.SS1.p1.19.m19.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.19.m19.1.1.1.1" xref="S3.SS1.p1.19.m19.1.1.1.1.cmml"><mi id="S3.SS1.p1.19.m19.1.1.1.1.2" xref="S3.SS1.p1.19.m19.1.1.1.1.2.cmml">k</mi><mo id="S3.SS1.p1.19.m19.1.1.1.1.1" xref="S3.SS1.p1.19.m19.1.1.1.1.1.cmml">+</mo><mn id="S3.SS1.p1.19.m19.1.1.1.1.3" xref="S3.SS1.p1.19.m19.1.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS1.p1.19.m19.1.1.1.3" stretchy="false" xref="S3.SS1.p1.19.m19.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.19.m19.1b"><apply id="S3.SS1.p1.19.m19.1.1.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1.1"><plus id="S3.SS1.p1.19.m19.1.1.1.1.1.cmml" xref="S3.SS1.p1.19.m19.1.1.1.1.1"></plus><ci id="S3.SS1.p1.19.m19.1.1.1.1.2.cmml" xref="S3.SS1.p1.19.m19.1.1.1.1.2">𝑘</ci><cn id="S3.SS1.p1.19.m19.1.1.1.1.3.cmml" type="integer" xref="S3.SS1.p1.19.m19.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.19.m19.1c">(k+1)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.19.m19.1d">( italic_k + 1 )</annotation></semantics></math>-th step.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">Our objective is to enhance the recommendation performance by enabling large language models to better understand collaborative information.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.5.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.6.2">Instruction Tuning</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.10">In the process of instruction tuning, we initially assign unique index identifiers to each item <math alttext="i" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_i</annotation></semantics></math><math alttext="\in" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mo id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><in id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\in</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">∈</annotation></semantics></math> <math alttext="\mathcal{I}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">ℐ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">ℐ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\mathcal{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">caligraphic_I</annotation></semantics></math> and user <math alttext="u" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_u</annotation></semantics></math><math alttext="\in" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><mo id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><in id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">\in</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">∈</annotation></semantics></math> <math alttext="\mathcal{U}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><ci id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">caligraphic_U</annotation></semantics></math> within the recommendation dataset. These identifiers are derived by augmenting the existing dataset.Subsequently, we construct instruction data pairs <math alttext="(x,y)" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.2"><semantics id="S3.SS2.p1.7.m7.2a"><mrow id="S3.SS2.p1.7.m7.2.3.2" xref="S3.SS2.p1.7.m7.2.3.1.cmml"><mo id="S3.SS2.p1.7.m7.2.3.2.1" stretchy="false" xref="S3.SS2.p1.7.m7.2.3.1.cmml">(</mo><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">x</mi><mo id="S3.SS2.p1.7.m7.2.3.2.2" xref="S3.SS2.p1.7.m7.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.7.m7.2.2" xref="S3.SS2.p1.7.m7.2.2.cmml">y</mi><mo id="S3.SS2.p1.7.m7.2.3.2.3" stretchy="false" xref="S3.SS2.p1.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.2b"><interval closure="open" id="S3.SS2.p1.7.m7.2.3.1.cmml" xref="S3.SS2.p1.7.m7.2.3.2"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝑥</ci><ci id="S3.SS2.p1.7.m7.2.2.cmml" xref="S3.SS2.p1.7.m7.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.2c">(x,y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.2d">( italic_x , italic_y )</annotation></semantics></math>. Here, <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><mi id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><ci id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">italic_x</annotation></semantics></math> constitutes the instructional input, formulated from the multi-layered relational information derived from the user’s interaction sequence with items, and <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><mi id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><ci id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">italic_y</annotation></semantics></math> represents the instructional output. Lastly, the optimization of the LLM is conducted. For the provided data pairs <math alttext="(x,y)" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m10.2"><semantics id="S3.SS2.p1.10.m10.2a"><mrow id="S3.SS2.p1.10.m10.2.3.2" xref="S3.SS2.p1.10.m10.2.3.1.cmml"><mo id="S3.SS2.p1.10.m10.2.3.2.1" stretchy="false" xref="S3.SS2.p1.10.m10.2.3.1.cmml">(</mo><mi id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml">x</mi><mo id="S3.SS2.p1.10.m10.2.3.2.2" xref="S3.SS2.p1.10.m10.2.3.1.cmml">,</mo><mi id="S3.SS2.p1.10.m10.2.2" xref="S3.SS2.p1.10.m10.2.2.cmml">y</mi><mo id="S3.SS2.p1.10.m10.2.3.2.3" stretchy="false" xref="S3.SS2.p1.10.m10.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.2b"><interval closure="open" id="S3.SS2.p1.10.m10.2.3.1.cmml" xref="S3.SS2.p1.10.m10.2.3.2"><ci id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">𝑥</ci><ci id="S3.SS2.p1.10.m10.2.2.cmml" xref="S3.SS2.p1.10.m10.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.2c">(x,y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m10.2d">( italic_x , italic_y )</annotation></semantics></math>, the LLM employs the negative log-likelihood method for its optimization process:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{0}=-{\sum_{t=1}^{|y|}}logP_{\theta}(y_{t}|y_{&lt;t},x)," class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml">ℒ</mi><mn id="S3.E1.m1.3.3.1.1.3.3" xref="S3.E1.m1.3.3.1.1.3.3.cmml">0</mn></msub><mo id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1a" xref="S3.E1.m1.3.3.1.1.1.cmml">−</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><munderover id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.2.2.3.2" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S3.E1.m1.3.3.1.1.1.1.2.2.3.1" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.3.3.1.1.1.1.2.2.3.3" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.cmml"><mo id="S3.E1.m1.1.1.1.3.1" stretchy="false" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">y</mi><mo id="S3.E1.m1.1.1.1.3.2" stretchy="false" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml">l</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.1.4.cmml">o</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.2a" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.5" xref="S3.E1.m1.3.3.1.1.1.1.1.5.cmml">g</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.2b" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.6" xref="S3.E1.m1.3.3.1.1.1.1.1.6.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.6.2" xref="S3.E1.m1.3.3.1.1.1.1.1.6.2.cmml">P</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.6.3" xref="S3.E1.m1.3.3.1.1.1.1.1.6.3.cmml">θ</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.2c" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">x</mi></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2">ℒ</ci><cn id="S3.E1.m1.3.3.1.1.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.3.3">0</cn></apply><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><minus id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1"></minus><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3"><eq id="S3.E1.m1.3.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.3.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S3.E1.m1.3.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.3"><abs id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.3.1"></abs><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝑦</ci></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3">𝑙</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.4">𝑜</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.5.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.5">𝑔</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.6.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.6"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.6.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.6">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.6.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.6.2">𝑃</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.6.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.6.3">𝜃</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><list id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><lt id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑥</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\mathcal{L}_{0}=-{\sum_{t=1}^{|y|}}logP_{\theta}(y_{t}|y_{&lt;t},x),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">caligraphic_L start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | italic_y | end_POSTSUPERSCRIPT italic_l italic_o italic_g italic_P start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT , italic_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.p1.17">where <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m1.1"><semantics id="S3.SS2.p1.11.m1.1a"><mi id="S3.SS2.p1.11.m1.1.1" xref="S3.SS2.p1.11.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m1.1b"><ci id="S3.SS2.p1.11.m1.1.1.cmml" xref="S3.SS2.p1.11.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m1.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m1.1d">italic_x</annotation></semantics></math> and <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.p1.12.m2.1"><semantics id="S3.SS2.p1.12.m2.1a"><mi id="S3.SS2.p1.12.m2.1.1" xref="S3.SS2.p1.12.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m2.1b"><ci id="S3.SS2.p1.12.m2.1.1.cmml" xref="S3.SS2.p1.12.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.12.m2.1d">italic_y</annotation></semantics></math> represent the Instruction Input and Instruction Output, respectively. And <math alttext="y_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.13.m3.1"><semantics id="S3.SS2.p1.13.m3.1a"><msub id="S3.SS2.p1.13.m3.1.1" xref="S3.SS2.p1.13.m3.1.1.cmml"><mi id="S3.SS2.p1.13.m3.1.1.2" xref="S3.SS2.p1.13.m3.1.1.2.cmml">y</mi><mi id="S3.SS2.p1.13.m3.1.1.3" xref="S3.SS2.p1.13.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.13.m3.1b"><apply id="S3.SS2.p1.13.m3.1.1.cmml" xref="S3.SS2.p1.13.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.13.m3.1.1.1.cmml" xref="S3.SS2.p1.13.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.13.m3.1.1.2.cmml" xref="S3.SS2.p1.13.m3.1.1.2">𝑦</ci><ci id="S3.SS2.p1.13.m3.1.1.3.cmml" xref="S3.SS2.p1.13.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.13.m3.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.13.m3.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> is the t-th token of the <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.p1.14.m4.1"><semantics id="S3.SS2.p1.14.m4.1a"><mi id="S3.SS2.p1.14.m4.1.1" xref="S3.SS2.p1.14.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.14.m4.1b"><ci id="S3.SS2.p1.14.m4.1.1.cmml" xref="S3.SS2.p1.14.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.14.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.14.m4.1d">italic_y</annotation></semantics></math>, <math alttext="y_{&lt;t}" class="ltx_Math" display="inline" id="S3.SS2.p1.15.m5.1"><semantics id="S3.SS2.p1.15.m5.1a"><msub id="S3.SS2.p1.15.m5.1.1" xref="S3.SS2.p1.15.m5.1.1.cmml"><mi id="S3.SS2.p1.15.m5.1.1.2" xref="S3.SS2.p1.15.m5.1.1.2.cmml">y</mi><mrow id="S3.SS2.p1.15.m5.1.1.3" xref="S3.SS2.p1.15.m5.1.1.3.cmml"><mi id="S3.SS2.p1.15.m5.1.1.3.2" xref="S3.SS2.p1.15.m5.1.1.3.2.cmml"></mi><mo id="S3.SS2.p1.15.m5.1.1.3.1" xref="S3.SS2.p1.15.m5.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS2.p1.15.m5.1.1.3.3" xref="S3.SS2.p1.15.m5.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.15.m5.1b"><apply id="S3.SS2.p1.15.m5.1.1.cmml" xref="S3.SS2.p1.15.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.15.m5.1.1.1.cmml" xref="S3.SS2.p1.15.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.15.m5.1.1.2.cmml" xref="S3.SS2.p1.15.m5.1.1.2">𝑦</ci><apply id="S3.SS2.p1.15.m5.1.1.3.cmml" xref="S3.SS2.p1.15.m5.1.1.3"><lt id="S3.SS2.p1.15.m5.1.1.3.1.cmml" xref="S3.SS2.p1.15.m5.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS2.p1.15.m5.1.1.3.2.cmml" xref="S3.SS2.p1.15.m5.1.1.3.2">absent</csymbol><ci id="S3.SS2.p1.15.m5.1.1.3.3.cmml" xref="S3.SS2.p1.15.m5.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.15.m5.1c">y_{&lt;t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.15.m5.1d">italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents the tokens before <math alttext="y_{t}" class="ltx_Math" display="inline" id="S3.SS2.p1.16.m6.1"><semantics id="S3.SS2.p1.16.m6.1a"><msub id="S3.SS2.p1.16.m6.1.1" xref="S3.SS2.p1.16.m6.1.1.cmml"><mi id="S3.SS2.p1.16.m6.1.1.2" xref="S3.SS2.p1.16.m6.1.1.2.cmml">y</mi><mi id="S3.SS2.p1.16.m6.1.1.3" xref="S3.SS2.p1.16.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.16.m6.1b"><apply id="S3.SS2.p1.16.m6.1.1.cmml" xref="S3.SS2.p1.16.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.16.m6.1.1.1.cmml" xref="S3.SS2.p1.16.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.16.m6.1.1.2.cmml" xref="S3.SS2.p1.16.m6.1.1.2">𝑦</ci><ci id="S3.SS2.p1.16.m6.1.1.3.cmml" xref="S3.SS2.p1.16.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.16.m6.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.16.m6.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.p1.17.m7.1"><semantics id="S3.SS2.p1.17.m7.1a"><mi id="S3.SS2.p1.17.m7.1.1" xref="S3.SS2.p1.17.m7.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.17.m7.1b"><ci id="S3.SS2.p1.17.m7.1.1.cmml" xref="S3.SS2.p1.17.m7.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.17.m7.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.17.m7.1d">italic_θ</annotation></semantics></math> is the parameters of LLM.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">METHODOLOGY</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In our study, we aim to enhance LLM’s proficiency in collaborative information understanding and improve their efficacy in recommendation tasks. This goal is pursued by learning from GNN’s aggregation patterns and understanding the dynamics of bipartite graphs in recommendation contexts.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">The model we propose is shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S3.F2" title="Figure 2 ‣ III PRELIMINARY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">2</span></a>, which comprises four primary components: (1). External Embeddings: Introduce traditional model embeddings or text embeddings to facilitate the initialization of new identifiers within the expansion of the LLM corpus. (2). Prompt Construction: Inspired by the aggregation of GNNs, we have developed a prompt structure that incorporates multi-hop information. (3). Graph-aware learning(GAL) module for LLMs: by leveraging the Graph-aware learning module, we enabled the LLM to effectively model multi-hop information, thereby significantly enhancing its capacity to comprehend collaborative information. (4). Dynamic Queue Storage: to address the challenge of negative sample collection posed by the large scale of LLMs, we employ a dynamic queue storage strategy based on Moco.</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1">By integrating these four components, our goal is to enhance LLM’s understanding of collaborative information, thereby improving its performance in recommendation tasks.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS1.5.1.1">IV-A</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS1.6.2">External Embeddings</span>
</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">To facilitate the model’s handling of recommendation task inputs, the corpus is meticulously designed to include specific tokens for each user and item. We uniquely identify users and items by extending the corpus to incorporate new tokens representing them within the corpus. In the process of embedding new tokens, we utilize two distinct methodologies: semantic information embeddings derived from item texts, and collaborative information embeddings obtained from traditional recommendation models.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><em class="ltx_emph ltx_font_italic" id="S4.I1.i1.p1.1.1">Text Embeddings</em>. To provide LLMs with semantic information about items, we assume that each item has associated content features that can capture useful semantic information (such as titles, descriptions, or brands). These features are initially concatenated into a comprehensive prompt, which is subsequently processed by a pre-trained text encoder (in this case, Sentence-T5). This process transforms the textual information of items into semantic embeddings, suitable for integration into LLM. Formally, we have:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E2">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E2X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle x_{i}=\text{Concat}(x^{Title}_{i},x^{Des}_{i},x^{Cate}_{i},x^{%
Brand}_{i})" class="ltx_Math" display="inline" id="S4.E2X.2.1.1.m1.4"><semantics id="S4.E2X.2.1.1.m1.4a"><mrow id="S4.E2X.2.1.1.m1.4.4" xref="S4.E2X.2.1.1.m1.4.4.cmml"><msub id="S4.E2X.2.1.1.m1.4.4.6" xref="S4.E2X.2.1.1.m1.4.4.6.cmml"><mi id="S4.E2X.2.1.1.m1.4.4.6.2" xref="S4.E2X.2.1.1.m1.4.4.6.2.cmml">x</mi><mi id="S4.E2X.2.1.1.m1.4.4.6.3" xref="S4.E2X.2.1.1.m1.4.4.6.3.cmml">i</mi></msub><mo id="S4.E2X.2.1.1.m1.4.4.5" xref="S4.E2X.2.1.1.m1.4.4.5.cmml">=</mo><mrow id="S4.E2X.2.1.1.m1.4.4.4" xref="S4.E2X.2.1.1.m1.4.4.4.cmml"><mtext id="S4.E2X.2.1.1.m1.4.4.4.6" xref="S4.E2X.2.1.1.m1.4.4.4.6a.cmml">Concat</mtext><mo id="S4.E2X.2.1.1.m1.4.4.4.5" xref="S4.E2X.2.1.1.m1.4.4.4.5.cmml">⁢</mo><mrow id="S4.E2X.2.1.1.m1.4.4.4.4.4" xref="S4.E2X.2.1.1.m1.4.4.4.4.5.cmml"><mo id="S4.E2X.2.1.1.m1.4.4.4.4.4.5" stretchy="false" xref="S4.E2X.2.1.1.m1.4.4.4.4.5.cmml">(</mo><msubsup id="S4.E2X.2.1.1.m1.1.1.1.1.1.1" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.cmml"><mi id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.2" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.3" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.3.cmml">i</mi><mrow id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.2" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.2.cmml">T</mi><mo id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.1" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.3" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.3.cmml">i</mi><mo id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.1a" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.4" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.4.cmml">t</mi><mo id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.1b" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.5" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.5.cmml">l</mi><mo id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.1c" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.6" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.6.cmml">e</mi></mrow></msubsup><mo id="S4.E2X.2.1.1.m1.4.4.4.4.4.6" xref="S4.E2X.2.1.1.m1.4.4.4.4.5.cmml">,</mo><msubsup id="S4.E2X.2.1.1.m1.2.2.2.2.2.2" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.cmml"><mi id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.2" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.2.cmml">x</mi><mi id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.3" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.3.cmml">i</mi><mrow id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.2" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.2.cmml">D</mi><mo id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.1" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.3" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.3.cmml">e</mi><mo id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.1a" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.4" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.4.cmml">s</mi></mrow></msubsup><mo id="S4.E2X.2.1.1.m1.4.4.4.4.4.7" xref="S4.E2X.2.1.1.m1.4.4.4.4.5.cmml">,</mo><msubsup id="S4.E2X.2.1.1.m1.3.3.3.3.3.3" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.cmml"><mi id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.2.cmml">x</mi><mi id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.3" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.3.cmml">i</mi><mrow id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.cmml"><mi id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.2" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.2.cmml">C</mi><mo id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.1" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.3" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.3.cmml">a</mi><mo id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.1a" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.4" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.4.cmml">t</mi><mo id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.1b" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.5" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.5.cmml">e</mi></mrow></msubsup><mo id="S4.E2X.2.1.1.m1.4.4.4.4.4.8" xref="S4.E2X.2.1.1.m1.4.4.4.4.5.cmml">,</mo><msubsup id="S4.E2X.2.1.1.m1.4.4.4.4.4.4" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.cmml"><mi id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.2" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.2.cmml">x</mi><mi id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.3" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.3.cmml">i</mi><mrow id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.cmml"><mi id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.2" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.2.cmml">B</mi><mo id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.1" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.3" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.3.cmml">r</mi><mo id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.1a" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.4" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.4.cmml">a</mi><mo id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.1b" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.5" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.5.cmml">n</mi><mo id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.1c" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.1.cmml">⁢</mo><mi id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.6" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.6.cmml">d</mi></mrow></msubsup><mo id="S4.E2X.2.1.1.m1.4.4.4.4.4.9" stretchy="false" xref="S4.E2X.2.1.1.m1.4.4.4.4.5.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2X.2.1.1.m1.4b"><apply id="S4.E2X.2.1.1.m1.4.4.cmml" xref="S4.E2X.2.1.1.m1.4.4"><eq id="S4.E2X.2.1.1.m1.4.4.5.cmml" xref="S4.E2X.2.1.1.m1.4.4.5"></eq><apply id="S4.E2X.2.1.1.m1.4.4.6.cmml" xref="S4.E2X.2.1.1.m1.4.4.6"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.4.4.6.1.cmml" xref="S4.E2X.2.1.1.m1.4.4.6">subscript</csymbol><ci id="S4.E2X.2.1.1.m1.4.4.6.2.cmml" xref="S4.E2X.2.1.1.m1.4.4.6.2">𝑥</ci><ci id="S4.E2X.2.1.1.m1.4.4.6.3.cmml" xref="S4.E2X.2.1.1.m1.4.4.6.3">𝑖</ci></apply><apply id="S4.E2X.2.1.1.m1.4.4.4.cmml" xref="S4.E2X.2.1.1.m1.4.4.4"><times id="S4.E2X.2.1.1.m1.4.4.4.5.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.5"></times><ci id="S4.E2X.2.1.1.m1.4.4.4.6a.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.6"><mtext id="S4.E2X.2.1.1.m1.4.4.4.6.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.6">Concat</mtext></ci><vector id="S4.E2X.2.1.1.m1.4.4.4.4.5.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4"><apply id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.2">𝑥</ci><apply id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3"><times id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.1"></times><ci id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.2">𝑇</ci><ci id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.3">𝑖</ci><ci id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.4.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.4">𝑡</ci><ci id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.5.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.5">𝑙</ci><ci id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.6.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.2.3.6">𝑒</ci></apply></apply><ci id="S4.E2X.2.1.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.E2X.2.1.1.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2">subscript</csymbol><apply id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.2">𝑥</ci><apply id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3"><times id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.1"></times><ci id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.2">𝐷</ci><ci id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.3">𝑒</ci><ci id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.4.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.2.3.4">𝑠</ci></apply></apply><ci id="S4.E2X.2.1.1.m1.2.2.2.2.2.2.3.cmml" xref="S4.E2X.2.1.1.m1.2.2.2.2.2.2.3">𝑖</ci></apply><apply id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.1.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3">subscript</csymbol><apply id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.1.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3">superscript</csymbol><ci id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.2.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.2">𝑥</ci><apply id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3"><times id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.1.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.1"></times><ci id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.2.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.2">𝐶</ci><ci id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.3.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.3">𝑎</ci><ci id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.4.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.4">𝑡</ci><ci id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.5.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.2.3.5">𝑒</ci></apply></apply><ci id="S4.E2X.2.1.1.m1.3.3.3.3.3.3.3.cmml" xref="S4.E2X.2.1.1.m1.3.3.3.3.3.3.3">𝑖</ci></apply><apply id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.1.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4">subscript</csymbol><apply id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4"><csymbol cd="ambiguous" id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.1.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4">superscript</csymbol><ci id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.2.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.2">𝑥</ci><apply id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3"><times id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.1.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.1"></times><ci id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.2.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.2">𝐵</ci><ci id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.3.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.3">𝑟</ci><ci id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.4.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.4">𝑎</ci><ci id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.5.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.5">𝑛</ci><ci id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.6.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.2.3.6">𝑑</ci></apply></apply><ci id="S4.E2X.2.1.1.m1.4.4.4.4.4.4.3.cmml" xref="S4.E2X.2.1.1.m1.4.4.4.4.4.4.3">𝑖</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2X.2.1.1.m1.4c">\displaystyle x_{i}=\text{Concat}(x^{Title}_{i},x^{Des}_{i},x^{Cate}_{i},x^{%
Brand}_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.E2X.2.1.1.m1.4d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = Concat ( italic_x start_POSTSUPERSCRIPT italic_T italic_i italic_t italic_l italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUPERSCRIPT italic_D italic_e italic_s end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUPERSCRIPT italic_C italic_a italic_t italic_e end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_x start_POSTSUPERSCRIPT italic_B italic_r italic_a italic_n italic_d end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E2Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle e_{i}=\text{Sentence}_{T5}(x_{i})." class="ltx_Math" display="inline" id="S4.E2Xa.2.1.1.m1.1"><semantics id="S4.E2Xa.2.1.1.m1.1a"><mrow id="S4.E2Xa.2.1.1.m1.1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.cmml"><mrow id="S4.E2Xa.2.1.1.m1.1.1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.cmml"><msub id="S4.E2Xa.2.1.1.m1.1.1.1.1.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.3.cmml"><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.3.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.3.2.cmml">e</mi><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.3.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.E2Xa.2.1.1.m1.1.1.1.1.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E2Xa.2.1.1.m1.1.1.1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.cmml"><msub id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.cmml"><mtext id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.2a.cmml">Sentence</mtext><mrow id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.cmml"><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.2.cmml">T</mi><mo id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.1.cmml">⁢</mo><mn id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.3.cmml">5</mn></mrow></msub><mo id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E2Xa.2.1.1.m1.1.1.1.2" lspace="0em" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E2Xa.2.1.1.m1.1b"><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1"><eq id="S4.E2Xa.2.1.1.m1.1.1.1.1.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.2"></eq><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2Xa.2.1.1.m1.1.1.1.1.3.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.3.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.3.2">𝑒</ci><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.3.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1"><times id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.2"></times><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.2a.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.2"><mtext id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.2">Sentence</mtext></ci><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3"><times id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.1"></times><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.2">𝑇</ci><cn id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.3.3.3">5</cn></apply></apply><apply id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2Xa.2.1.1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2Xa.2.1.1.m1.1c">\displaystyle e_{i}=\text{Sentence}_{T5}(x_{i}).</annotation><annotation encoding="application/x-llamapun" id="S4.E2Xa.2.1.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = Sentence start_POSTSUBSCRIPT italic_T 5 end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.10"><em class="ltx_emph ltx_font_italic" id="S4.I1.i2.p1.10.1">Traditional Model Embeddings</em>. To further enrich large models with user-item collaborative information, we leverage traditional recommendation models to extract such information. User-item representations, as captured by these models, are then mapped into the token embedding space of LLMs, and instance representations can be obtained as follows:</p>
<table class="ltx_equationgroup ltx_eqn_table" id="S4.E3">
<tbody>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E3X">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle e_{u}" class="ltx_Math" display="inline" id="S4.E3X.2.1.1.m1.1"><semantics id="S4.E3X.2.1.1.m1.1a"><msub id="S4.E3X.2.1.1.m1.1.1" xref="S4.E3X.2.1.1.m1.1.1.cmml"><mi id="S4.E3X.2.1.1.m1.1.1.2" xref="S4.E3X.2.1.1.m1.1.1.2.cmml">e</mi><mi id="S4.E3X.2.1.1.m1.1.1.3" xref="S4.E3X.2.1.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E3X.2.1.1.m1.1b"><apply id="S4.E3X.2.1.1.m1.1.1.cmml" xref="S4.E3X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E3X.2.1.1.m1.1.1.1.cmml" xref="S4.E3X.2.1.1.m1.1.1">subscript</csymbol><ci id="S4.E3X.2.1.1.m1.1.1.2.cmml" xref="S4.E3X.2.1.1.m1.1.1.2">𝑒</ci><ci id="S4.E3X.2.1.1.m1.1.1.3.cmml" xref="S4.E3X.2.1.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3X.2.1.1.m1.1c">\displaystyle e_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.E3X.2.1.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=g_{\theta}(h_{u})," class="ltx_Math" display="inline" id="S4.E3X.3.2.2.m1.1"><semantics id="S4.E3X.3.2.2.m1.1a"><mrow id="S4.E3X.3.2.2.m1.1.1.1" xref="S4.E3X.3.2.2.m1.1.1.1.1.cmml"><mrow id="S4.E3X.3.2.2.m1.1.1.1.1" xref="S4.E3X.3.2.2.m1.1.1.1.1.cmml"><mi id="S4.E3X.3.2.2.m1.1.1.1.1.3" xref="S4.E3X.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo id="S4.E3X.3.2.2.m1.1.1.1.1.2" xref="S4.E3X.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E3X.3.2.2.m1.1.1.1.1.1" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.cmml"><msub id="S4.E3X.3.2.2.m1.1.1.1.1.1.3" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.3.cmml"><mi id="S4.E3X.3.2.2.m1.1.1.1.1.1.3.2" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.3.2.cmml">g</mi><mi id="S4.E3X.3.2.2.m1.1.1.1.1.1.3.3" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.E3X.3.2.2.m1.1.1.1.1.1.2" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">u</mi></msub><mo id="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3X.3.2.2.m1.1.1.1.2" xref="S4.E3X.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3X.3.2.2.m1.1b"><apply id="S4.E3X.3.2.2.m1.1.1.1.1.cmml" xref="S4.E3X.3.2.2.m1.1.1.1"><eq id="S4.E3X.3.2.2.m1.1.1.1.1.2.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E3X.3.2.2.m1.1.1.1.1.3.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S4.E3X.3.2.2.m1.1.1.1.1.1.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.1"><times id="S4.E3X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.2"></times><apply id="S4.E3X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3X.3.2.2.m1.1.1.1.1.1.3.1.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E3X.3.2.2.m1.1.1.1.1.1.3.2.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.3.2">𝑔</ci><ci id="S4.E3X.3.2.2.m1.1.1.1.1.1.3.3.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3X.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3X.3.2.2.m1.1c">\displaystyle=g_{\theta}(h_{u}),</annotation><annotation encoding="application/x-llamapun" id="S4.E3X.3.2.2.m1.1d">= italic_g start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\quad h_{u}" class="ltx_Math" display="inline" id="S4.E3X.5.1.1.m1.1"><semantics id="S4.E3X.5.1.1.m1.1a"><msub id="S4.E3X.5.1.1.m1.1.1" xref="S4.E3X.5.1.1.m1.1.1.cmml"><mi id="S4.E3X.5.1.1.m1.1.1.2" xref="S4.E3X.5.1.1.m1.1.1.2.cmml">h</mi><mi id="S4.E3X.5.1.1.m1.1.1.3" xref="S4.E3X.5.1.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E3X.5.1.1.m1.1b"><apply id="S4.E3X.5.1.1.m1.1.1.cmml" xref="S4.E3X.5.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E3X.5.1.1.m1.1.1.1.cmml" xref="S4.E3X.5.1.1.m1.1.1">subscript</csymbol><ci id="S4.E3X.5.1.1.m1.1.1.2.cmml" xref="S4.E3X.5.1.1.m1.1.1.2">ℎ</ci><ci id="S4.E3X.5.1.1.m1.1.1.3.cmml" xref="S4.E3X.5.1.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3X.5.1.1.m1.1c">\displaystyle\quad h_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.E3X.5.1.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=f_{\phi}(u)," class="ltx_Math" display="inline" id="S4.E3X.6.2.2.m1.2"><semantics id="S4.E3X.6.2.2.m1.2a"><mrow id="S4.E3X.6.2.2.m1.2.2.1" xref="S4.E3X.6.2.2.m1.2.2.1.1.cmml"><mrow id="S4.E3X.6.2.2.m1.2.2.1.1" xref="S4.E3X.6.2.2.m1.2.2.1.1.cmml"><mi id="S4.E3X.6.2.2.m1.2.2.1.1.2" xref="S4.E3X.6.2.2.m1.2.2.1.1.2.cmml"></mi><mo id="S4.E3X.6.2.2.m1.2.2.1.1.1" xref="S4.E3X.6.2.2.m1.2.2.1.1.1.cmml">=</mo><mrow id="S4.E3X.6.2.2.m1.2.2.1.1.3" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.cmml"><msub id="S4.E3X.6.2.2.m1.2.2.1.1.3.2" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.2.cmml"><mi id="S4.E3X.6.2.2.m1.2.2.1.1.3.2.2" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.2.2.cmml">f</mi><mi id="S4.E3X.6.2.2.m1.2.2.1.1.3.2.3" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.2.3.cmml">ϕ</mi></msub><mo id="S4.E3X.6.2.2.m1.2.2.1.1.3.1" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.E3X.6.2.2.m1.2.2.1.1.3.3.2" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.cmml"><mo id="S4.E3X.6.2.2.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.cmml">(</mo><mi id="S4.E3X.6.2.2.m1.1.1" xref="S4.E3X.6.2.2.m1.1.1.cmml">u</mi><mo id="S4.E3X.6.2.2.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3X.6.2.2.m1.2.2.1.2" xref="S4.E3X.6.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3X.6.2.2.m1.2b"><apply id="S4.E3X.6.2.2.m1.2.2.1.1.cmml" xref="S4.E3X.6.2.2.m1.2.2.1"><eq id="S4.E3X.6.2.2.m1.2.2.1.1.1.cmml" xref="S4.E3X.6.2.2.m1.2.2.1.1.1"></eq><csymbol cd="latexml" id="S4.E3X.6.2.2.m1.2.2.1.1.2.cmml" xref="S4.E3X.6.2.2.m1.2.2.1.1.2">absent</csymbol><apply id="S4.E3X.6.2.2.m1.2.2.1.1.3.cmml" xref="S4.E3X.6.2.2.m1.2.2.1.1.3"><times id="S4.E3X.6.2.2.m1.2.2.1.1.3.1.cmml" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.1"></times><apply id="S4.E3X.6.2.2.m1.2.2.1.1.3.2.cmml" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E3X.6.2.2.m1.2.2.1.1.3.2.1.cmml" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S4.E3X.6.2.2.m1.2.2.1.1.3.2.2.cmml" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.2.2">𝑓</ci><ci id="S4.E3X.6.2.2.m1.2.2.1.1.3.2.3.cmml" xref="S4.E3X.6.2.2.m1.2.2.1.1.3.2.3">italic-ϕ</ci></apply><ci id="S4.E3X.6.2.2.m1.1.1.cmml" xref="S4.E3X.6.2.2.m1.1.1">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3X.6.2.2.m1.2c">\displaystyle=f_{\phi}(u),</annotation><annotation encoding="application/x-llamapun" id="S4.E3X.6.2.2.m1.2d">= italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_u ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="2"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(3)</span></td>
</tr>
<tr class="ltx_equation ltx_eqn_row ltx_align_baseline" id="S4.E3Xa">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle e_{i}" class="ltx_Math" display="inline" id="S4.E3Xa.2.1.1.m1.1"><semantics id="S4.E3Xa.2.1.1.m1.1a"><msub id="S4.E3Xa.2.1.1.m1.1.1" xref="S4.E3Xa.2.1.1.m1.1.1.cmml"><mi id="S4.E3Xa.2.1.1.m1.1.1.2" xref="S4.E3Xa.2.1.1.m1.1.1.2.cmml">e</mi><mi id="S4.E3Xa.2.1.1.m1.1.1.3" xref="S4.E3Xa.2.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E3Xa.2.1.1.m1.1b"><apply id="S4.E3Xa.2.1.1.m1.1.1.cmml" xref="S4.E3Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E3Xa.2.1.1.m1.1.1.1.cmml" xref="S4.E3Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S4.E3Xa.2.1.1.m1.1.1.2.cmml" xref="S4.E3Xa.2.1.1.m1.1.1.2">𝑒</ci><ci id="S4.E3Xa.2.1.1.m1.1.1.3.cmml" xref="S4.E3Xa.2.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3Xa.2.1.1.m1.1c">\displaystyle e_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.E3Xa.2.1.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=g_{\theta}(h_{i})," class="ltx_Math" display="inline" id="S4.E3Xa.3.2.2.m1.1"><semantics id="S4.E3Xa.3.2.2.m1.1a"><mrow id="S4.E3Xa.3.2.2.m1.1.1.1" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.cmml"><mrow id="S4.E3Xa.3.2.2.m1.1.1.1.1" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.cmml"><mi id="S4.E3Xa.3.2.2.m1.1.1.1.1.3" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.3.cmml"></mi><mo id="S4.E3Xa.3.2.2.m1.1.1.1.1.2" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E3Xa.3.2.2.m1.1.1.1.1.1" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.cmml"><msub id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.cmml"><mi id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.2" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.2.cmml">g</mi><mi id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.3" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.2" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">h</mi><mi id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3Xa.3.2.2.m1.1.1.1.2" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3Xa.3.2.2.m1.1b"><apply id="S4.E3Xa.3.2.2.m1.1.1.1.1.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1"><eq id="S4.E3Xa.3.2.2.m1.1.1.1.1.2.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.2"></eq><csymbol cd="latexml" id="S4.E3Xa.3.2.2.m1.1.1.1.1.3.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.3">absent</csymbol><apply id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1"><times id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.2"></times><apply id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.1.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.2.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.2">𝑔</ci><ci id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.3.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E3Xa.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3Xa.3.2.2.m1.1c">\displaystyle=g_{\theta}(h_{i}),</annotation><annotation encoding="application/x-llamapun" id="S4.E3Xa.3.2.2.m1.1d">= italic_g start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\quad h_{i}" class="ltx_Math" display="inline" id="S4.E3Xa.5.1.1.m1.1"><semantics id="S4.E3Xa.5.1.1.m1.1a"><msub id="S4.E3Xa.5.1.1.m1.1.1" xref="S4.E3Xa.5.1.1.m1.1.1.cmml"><mi id="S4.E3Xa.5.1.1.m1.1.1.2" xref="S4.E3Xa.5.1.1.m1.1.1.2.cmml">h</mi><mi id="S4.E3Xa.5.1.1.m1.1.1.3" xref="S4.E3Xa.5.1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.E3Xa.5.1.1.m1.1b"><apply id="S4.E3Xa.5.1.1.m1.1.1.cmml" xref="S4.E3Xa.5.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.E3Xa.5.1.1.m1.1.1.1.cmml" xref="S4.E3Xa.5.1.1.m1.1.1">subscript</csymbol><ci id="S4.E3Xa.5.1.1.m1.1.1.2.cmml" xref="S4.E3Xa.5.1.1.m1.1.1.2">ℎ</ci><ci id="S4.E3Xa.5.1.1.m1.1.1.3.cmml" xref="S4.E3Xa.5.1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3Xa.5.1.1.m1.1c">\displaystyle\quad h_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.E3Xa.5.1.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=f_{\phi}(i)," class="ltx_Math" display="inline" id="S4.E3Xa.6.2.2.m1.2"><semantics id="S4.E3Xa.6.2.2.m1.2a"><mrow id="S4.E3Xa.6.2.2.m1.2.2.1" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.cmml"><mrow id="S4.E3Xa.6.2.2.m1.2.2.1.1" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.cmml"><mi id="S4.E3Xa.6.2.2.m1.2.2.1.1.2" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.2.cmml"></mi><mo id="S4.E3Xa.6.2.2.m1.2.2.1.1.1" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.1.cmml">=</mo><mrow id="S4.E3Xa.6.2.2.m1.2.2.1.1.3" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.cmml"><msub id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.cmml"><mi id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.2" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.2.cmml">f</mi><mi id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.3" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.3.cmml">ϕ</mi></msub><mo id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.1" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.3.2" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.cmml"><mo id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.cmml">(</mo><mi id="S4.E3Xa.6.2.2.m1.1.1" xref="S4.E3Xa.6.2.2.m1.1.1.cmml">i</mi><mo id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E3Xa.6.2.2.m1.2.2.1.2" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E3Xa.6.2.2.m1.2b"><apply id="S4.E3Xa.6.2.2.m1.2.2.1.1.cmml" xref="S4.E3Xa.6.2.2.m1.2.2.1"><eq id="S4.E3Xa.6.2.2.m1.2.2.1.1.1.cmml" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.1"></eq><csymbol cd="latexml" id="S4.E3Xa.6.2.2.m1.2.2.1.1.2.cmml" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.2">absent</csymbol><apply id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.cmml" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3"><times id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.1.cmml" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.1"></times><apply id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.cmml" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.1.cmml" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.2.cmml" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.2">𝑓</ci><ci id="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.3.cmml" xref="S4.E3Xa.6.2.2.m1.2.2.1.1.3.2.3">italic-ϕ</ci></apply><ci id="S4.E3Xa.6.2.2.m1.1.1.cmml" xref="S4.E3Xa.6.2.2.m1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3Xa.6.2.2.m1.2c">\displaystyle=f_{\phi}(i),</annotation><annotation encoding="application/x-llamapun" id="S4.E3Xa.6.2.2.m1.2d">= italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_i ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p class="ltx_p" id="S4.I1.i2.p1.9">where <math alttext="f_{\phi}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><msub id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">f</mi><mi id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">𝑓</ci><ci id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">f_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> represents the traditional recommendation model, while <math alttext="h_{u}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.1"><semantics id="S4.I1.i2.p1.2.m2.1a"><msub id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml"><mi id="S4.I1.i2.p1.2.m2.1.1.2" xref="S4.I1.i2.p1.2.m2.1.1.2.cmml">h</mi><mi id="S4.I1.i2.p1.2.m2.1.1.3" xref="S4.I1.i2.p1.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.1b"><apply id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.2.m2.1.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.2.m2.1.1.2.cmml" xref="S4.I1.i2.p1.2.m2.1.1.2">ℎ</ci><ci id="S4.I1.i2.p1.2.m2.1.1.3.cmml" xref="S4.I1.i2.p1.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.1c">h_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.1d">italic_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> denotes the user embeddings derived from this model. Furthermore, a mapping layer, denoted as <math alttext="g_{\theta}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.1"><semantics id="S4.I1.i2.p1.3.m3.1a"><msub id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.2.cmml">g</mi><mi id="S4.I1.i2.p1.3.m3.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><apply id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2">𝑔</ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">g_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m3.1d">italic_g start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, is employed to convert <math alttext="h_{u}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.4.m4.1"><semantics id="S4.I1.i2.p1.4.m4.1a"><msub id="S4.I1.i2.p1.4.m4.1.1" xref="S4.I1.i2.p1.4.m4.1.1.cmml"><mi id="S4.I1.i2.p1.4.m4.1.1.2" xref="S4.I1.i2.p1.4.m4.1.1.2.cmml">h</mi><mi id="S4.I1.i2.p1.4.m4.1.1.3" xref="S4.I1.i2.p1.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.4.m4.1b"><apply id="S4.I1.i2.p1.4.m4.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.4.m4.1.1.1.cmml" xref="S4.I1.i2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.4.m4.1.1.2.cmml" xref="S4.I1.i2.p1.4.m4.1.1.2">ℎ</ci><ci id="S4.I1.i2.p1.4.m4.1.1.3.cmml" xref="S4.I1.i2.p1.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.4.m4.1c">h_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.4.m4.1d">italic_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> , which has a dimension of <math alttext="d_{1}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.5.m5.1"><semantics id="S4.I1.i2.p1.5.m5.1a"><msub id="S4.I1.i2.p1.5.m5.1.1" xref="S4.I1.i2.p1.5.m5.1.1.cmml"><mi id="S4.I1.i2.p1.5.m5.1.1.2" xref="S4.I1.i2.p1.5.m5.1.1.2.cmml">d</mi><mn id="S4.I1.i2.p1.5.m5.1.1.3" xref="S4.I1.i2.p1.5.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.5.m5.1b"><apply id="S4.I1.i2.p1.5.m5.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.5.m5.1.1.1.cmml" xref="S4.I1.i2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.5.m5.1.1.2.cmml" xref="S4.I1.i2.p1.5.m5.1.1.2">𝑑</ci><cn id="S4.I1.i2.p1.5.m5.1.1.3.cmml" type="integer" xref="S4.I1.i2.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.5.m5.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.5.m5.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> , into e with a dimension of <math alttext="d_{2}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.6.m6.1"><semantics id="S4.I1.i2.p1.6.m6.1a"><msub id="S4.I1.i2.p1.6.m6.1.1" xref="S4.I1.i2.p1.6.m6.1.1.cmml"><mi id="S4.I1.i2.p1.6.m6.1.1.2" xref="S4.I1.i2.p1.6.m6.1.1.2.cmml">d</mi><mn id="S4.I1.i2.p1.6.m6.1.1.3" xref="S4.I1.i2.p1.6.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.6.m6.1b"><apply id="S4.I1.i2.p1.6.m6.1.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.6.m6.1.1.1.cmml" xref="S4.I1.i2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.6.m6.1.1.2.cmml" xref="S4.I1.i2.p1.6.m6.1.1.2">𝑑</ci><cn id="S4.I1.i2.p1.6.m6.1.1.3.cmml" type="integer" xref="S4.I1.i2.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.6.m6.1c">d_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.6.m6.1d">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. This transformation aligns the dimensions of e with those of the embeddings in the LLMs, where typically <math alttext="d_{1}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.7.m7.1"><semantics id="S4.I1.i2.p1.7.m7.1a"><msub id="S4.I1.i2.p1.7.m7.1.1" xref="S4.I1.i2.p1.7.m7.1.1.cmml"><mi id="S4.I1.i2.p1.7.m7.1.1.2" xref="S4.I1.i2.p1.7.m7.1.1.2.cmml">d</mi><mn id="S4.I1.i2.p1.7.m7.1.1.3" xref="S4.I1.i2.p1.7.m7.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.7.m7.1b"><apply id="S4.I1.i2.p1.7.m7.1.1.cmml" xref="S4.I1.i2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.7.m7.1.1.1.cmml" xref="S4.I1.i2.p1.7.m7.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.7.m7.1.1.2.cmml" xref="S4.I1.i2.p1.7.m7.1.1.2">𝑑</ci><cn id="S4.I1.i2.p1.7.m7.1.1.3.cmml" type="integer" xref="S4.I1.i2.p1.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.7.m7.1c">d_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.7.m7.1d">italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> is less than <math alttext="d_{2}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.8.m8.1"><semantics id="S4.I1.i2.p1.8.m8.1a"><msub id="S4.I1.i2.p1.8.m8.1.1" xref="S4.I1.i2.p1.8.m8.1.1.cmml"><mi id="S4.I1.i2.p1.8.m8.1.1.2" xref="S4.I1.i2.p1.8.m8.1.1.2.cmml">d</mi><mn id="S4.I1.i2.p1.8.m8.1.1.3" xref="S4.I1.i2.p1.8.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.8.m8.1b"><apply id="S4.I1.i2.p1.8.m8.1.1.cmml" xref="S4.I1.i2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.8.m8.1.1.1.cmml" xref="S4.I1.i2.p1.8.m8.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.8.m8.1.1.2.cmml" xref="S4.I1.i2.p1.8.m8.1.1.2">𝑑</ci><cn id="S4.I1.i2.p1.8.m8.1.1.3.cmml" type="integer" xref="S4.I1.i2.p1.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.8.m8.1c">d_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.8.m8.1d">italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>. And the same applies to item <math alttext="i" class="ltx_Math" display="inline" id="S4.I1.i2.p1.9.m9.1"><semantics id="S4.I1.i2.p1.9.m9.1a"><mi id="S4.I1.i2.p1.9.m9.1.1" xref="S4.I1.i2.p1.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.9.m9.1b"><ci id="S4.I1.i2.p1.9.m9.1.1.cmml" xref="S4.I1.i2.p1.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.9.m9.1c">i</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.9.m9.1d">italic_i</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS2.5.1.1">IV-B</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS2.6.2">Prompt Construction</span>
</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Similar to existing methods <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib15" title="">15</a>]</cite>, GAL also constructs prompt language based on recommendation data, and LLM generates recommendations based on this prompt language. The key distinction in our method lies in our adaptation of the prompt construction to more closely resemble the aggregation processes observed in GNNs.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Echoing the GNN strategy of aggregating information from multi-hop neighbors, our recommendation process for a user involves providing the LLM not only with the user’s sequence of item interactions (1-hop information) but also with data about other users who have interacted with the same items (2-hop information). This approach is designed to enhance the LLM’s capacity to generate more contextually rich and relevant recommendations by incorporating a broader spectrum of user-item interaction data. The structure of the prompt template is depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.F3" title="Figure 3 ‣ IV-B Prompt Construction ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="601" id="S4.F3.g1" src="x3.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span> A case demonstrating the motivation of designing task-specific tokens.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.5">As an illustration, consider the 2-hop scenario in the template: <math alttext="user\_id" class="ltx_Math" display="inline" id="S4.SS2.p3.1.m1.1"><semantics id="S4.SS2.p3.1.m1.1a"><mrow id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.2" xref="S4.SS2.p3.1.m1.1.1.2.cmml">u</mi><mo id="S4.SS2.p3.1.m1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.1.m1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.3.cmml">s</mi><mo id="S4.SS2.p3.1.m1.1.1.1a" xref="S4.SS2.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.1.m1.1.1.4" xref="S4.SS2.p3.1.m1.1.1.4.cmml">e</mi><mo id="S4.SS2.p3.1.m1.1.1.1b" xref="S4.SS2.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.1.m1.1.1.5" xref="S4.SS2.p3.1.m1.1.1.5.cmml">r</mi><mo id="S4.SS2.p3.1.m1.1.1.1c" xref="S4.SS2.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.1.m1.1.1.6" mathvariant="normal" xref="S4.SS2.p3.1.m1.1.1.6.cmml">_</mi><mo id="S4.SS2.p3.1.m1.1.1.1d" xref="S4.SS2.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.1.m1.1.1.7" xref="S4.SS2.p3.1.m1.1.1.7.cmml">i</mi><mo id="S4.SS2.p3.1.m1.1.1.1e" xref="S4.SS2.p3.1.m1.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.1.m1.1.1.8" xref="S4.SS2.p3.1.m1.1.1.8.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1"><times id="S4.SS2.p3.1.m1.1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1.1"></times><ci id="S4.SS2.p3.1.m1.1.1.2.cmml" xref="S4.SS2.p3.1.m1.1.1.2">𝑢</ci><ci id="S4.SS2.p3.1.m1.1.1.3.cmml" xref="S4.SS2.p3.1.m1.1.1.3">𝑠</ci><ci id="S4.SS2.p3.1.m1.1.1.4.cmml" xref="S4.SS2.p3.1.m1.1.1.4">𝑒</ci><ci id="S4.SS2.p3.1.m1.1.1.5.cmml" xref="S4.SS2.p3.1.m1.1.1.5">𝑟</ci><ci id="S4.SS2.p3.1.m1.1.1.6.cmml" xref="S4.SS2.p3.1.m1.1.1.6">_</ci><ci id="S4.SS2.p3.1.m1.1.1.7.cmml" xref="S4.SS2.p3.1.m1.1.1.7">𝑖</ci><ci id="S4.SS2.p3.1.m1.1.1.8.cmml" xref="S4.SS2.p3.1.m1.1.1.8">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1c">user\_id</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1d">italic_u italic_s italic_e italic_r _ italic_i italic_d</annotation></semantics></math> serves as the user’s unique identifier, <math alttext="item\_id\_list" class="ltx_Math" display="inline" id="S4.SS2.p3.2.m2.1"><semantics id="S4.SS2.p3.2.m2.1a"><mrow id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2" xref="S4.SS2.p3.2.m2.1.1.2.cmml">i</mi><mo id="S4.SS2.p3.2.m2.1.1.1" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">t</mi><mo id="S4.SS2.p3.2.m2.1.1.1a" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.4" xref="S4.SS2.p3.2.m2.1.1.4.cmml">e</mi><mo id="S4.SS2.p3.2.m2.1.1.1b" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.5" xref="S4.SS2.p3.2.m2.1.1.5.cmml">m</mi><mo id="S4.SS2.p3.2.m2.1.1.1c" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.6" mathvariant="normal" xref="S4.SS2.p3.2.m2.1.1.6.cmml">_</mi><mo id="S4.SS2.p3.2.m2.1.1.1d" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.7" xref="S4.SS2.p3.2.m2.1.1.7.cmml">i</mi><mo id="S4.SS2.p3.2.m2.1.1.1e" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.8" xref="S4.SS2.p3.2.m2.1.1.8.cmml">d</mi><mo id="S4.SS2.p3.2.m2.1.1.1f" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.9" mathvariant="normal" xref="S4.SS2.p3.2.m2.1.1.9.cmml">_</mi><mo id="S4.SS2.p3.2.m2.1.1.1g" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.10" xref="S4.SS2.p3.2.m2.1.1.10.cmml">l</mi><mo id="S4.SS2.p3.2.m2.1.1.1h" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.11" xref="S4.SS2.p3.2.m2.1.1.11.cmml">i</mi><mo id="S4.SS2.p3.2.m2.1.1.1i" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.12" xref="S4.SS2.p3.2.m2.1.1.12.cmml">s</mi><mo id="S4.SS2.p3.2.m2.1.1.1j" xref="S4.SS2.p3.2.m2.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.2.m2.1.1.13" xref="S4.SS2.p3.2.m2.1.1.13.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.2.m2.1b"><apply id="S4.SS2.p3.2.m2.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1"><times id="S4.SS2.p3.2.m2.1.1.1.cmml" xref="S4.SS2.p3.2.m2.1.1.1"></times><ci id="S4.SS2.p3.2.m2.1.1.2.cmml" xref="S4.SS2.p3.2.m2.1.1.2">𝑖</ci><ci id="S4.SS2.p3.2.m2.1.1.3.cmml" xref="S4.SS2.p3.2.m2.1.1.3">𝑡</ci><ci id="S4.SS2.p3.2.m2.1.1.4.cmml" xref="S4.SS2.p3.2.m2.1.1.4">𝑒</ci><ci id="S4.SS2.p3.2.m2.1.1.5.cmml" xref="S4.SS2.p3.2.m2.1.1.5">𝑚</ci><ci id="S4.SS2.p3.2.m2.1.1.6.cmml" xref="S4.SS2.p3.2.m2.1.1.6">_</ci><ci id="S4.SS2.p3.2.m2.1.1.7.cmml" xref="S4.SS2.p3.2.m2.1.1.7">𝑖</ci><ci id="S4.SS2.p3.2.m2.1.1.8.cmml" xref="S4.SS2.p3.2.m2.1.1.8">𝑑</ci><ci id="S4.SS2.p3.2.m2.1.1.9.cmml" xref="S4.SS2.p3.2.m2.1.1.9">_</ci><ci id="S4.SS2.p3.2.m2.1.1.10.cmml" xref="S4.SS2.p3.2.m2.1.1.10">𝑙</ci><ci id="S4.SS2.p3.2.m2.1.1.11.cmml" xref="S4.SS2.p3.2.m2.1.1.11">𝑖</ci><ci id="S4.SS2.p3.2.m2.1.1.12.cmml" xref="S4.SS2.p3.2.m2.1.1.12">𝑠</ci><ci id="S4.SS2.p3.2.m2.1.1.13.cmml" xref="S4.SS2.p3.2.m2.1.1.13">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.2.m2.1c">item\_id\_list</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.2.m2.1d">italic_i italic_t italic_e italic_m _ italic_i italic_d _ italic_l italic_i italic_s italic_t</annotation></semantics></math> denotes the array of items with which the user has interacted, and <math alttext="user\_id\_list" class="ltx_Math" display="inline" id="S4.SS2.p3.3.m3.1"><semantics id="S4.SS2.p3.3.m3.1a"><mrow id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2" xref="S4.SS2.p3.3.m3.1.1.2.cmml">u</mi><mo id="S4.SS2.p3.3.m3.1.1.1" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">s</mi><mo id="S4.SS2.p3.3.m3.1.1.1a" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.4" xref="S4.SS2.p3.3.m3.1.1.4.cmml">e</mi><mo id="S4.SS2.p3.3.m3.1.1.1b" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.5" xref="S4.SS2.p3.3.m3.1.1.5.cmml">r</mi><mo id="S4.SS2.p3.3.m3.1.1.1c" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.6" mathvariant="normal" xref="S4.SS2.p3.3.m3.1.1.6.cmml">_</mi><mo id="S4.SS2.p3.3.m3.1.1.1d" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.7" xref="S4.SS2.p3.3.m3.1.1.7.cmml">i</mi><mo id="S4.SS2.p3.3.m3.1.1.1e" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.8" xref="S4.SS2.p3.3.m3.1.1.8.cmml">d</mi><mo id="S4.SS2.p3.3.m3.1.1.1f" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.9" mathvariant="normal" xref="S4.SS2.p3.3.m3.1.1.9.cmml">_</mi><mo id="S4.SS2.p3.3.m3.1.1.1g" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.10" xref="S4.SS2.p3.3.m3.1.1.10.cmml">l</mi><mo id="S4.SS2.p3.3.m3.1.1.1h" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.11" xref="S4.SS2.p3.3.m3.1.1.11.cmml">i</mi><mo id="S4.SS2.p3.3.m3.1.1.1i" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.12" xref="S4.SS2.p3.3.m3.1.1.12.cmml">s</mi><mo id="S4.SS2.p3.3.m3.1.1.1j" xref="S4.SS2.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.3.m3.1.1.13" xref="S4.SS2.p3.3.m3.1.1.13.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.3.m3.1b"><apply id="S4.SS2.p3.3.m3.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1"><times id="S4.SS2.p3.3.m3.1.1.1.cmml" xref="S4.SS2.p3.3.m3.1.1.1"></times><ci id="S4.SS2.p3.3.m3.1.1.2.cmml" xref="S4.SS2.p3.3.m3.1.1.2">𝑢</ci><ci id="S4.SS2.p3.3.m3.1.1.3.cmml" xref="S4.SS2.p3.3.m3.1.1.3">𝑠</ci><ci id="S4.SS2.p3.3.m3.1.1.4.cmml" xref="S4.SS2.p3.3.m3.1.1.4">𝑒</ci><ci id="S4.SS2.p3.3.m3.1.1.5.cmml" xref="S4.SS2.p3.3.m3.1.1.5">𝑟</ci><ci id="S4.SS2.p3.3.m3.1.1.6.cmml" xref="S4.SS2.p3.3.m3.1.1.6">_</ci><ci id="S4.SS2.p3.3.m3.1.1.7.cmml" xref="S4.SS2.p3.3.m3.1.1.7">𝑖</ci><ci id="S4.SS2.p3.3.m3.1.1.8.cmml" xref="S4.SS2.p3.3.m3.1.1.8">𝑑</ci><ci id="S4.SS2.p3.3.m3.1.1.9.cmml" xref="S4.SS2.p3.3.m3.1.1.9">_</ci><ci id="S4.SS2.p3.3.m3.1.1.10.cmml" xref="S4.SS2.p3.3.m3.1.1.10">𝑙</ci><ci id="S4.SS2.p3.3.m3.1.1.11.cmml" xref="S4.SS2.p3.3.m3.1.1.11">𝑖</ci><ci id="S4.SS2.p3.3.m3.1.1.12.cmml" xref="S4.SS2.p3.3.m3.1.1.12">𝑠</ci><ci id="S4.SS2.p3.3.m3.1.1.13.cmml" xref="S4.SS2.p3.3.m3.1.1.13">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.3.m3.1c">user\_id\_list</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.3.m3.1d">italic_u italic_s italic_e italic_r _ italic_i italic_d _ italic_l italic_i italic_s italic_t</annotation></semantics></math> signifies the collection of users who have engaged with the same items as the given <math alttext="user\_id" class="ltx_Math" display="inline" id="S4.SS2.p3.4.m4.1"><semantics id="S4.SS2.p3.4.m4.1a"><mrow id="S4.SS2.p3.4.m4.1.1" xref="S4.SS2.p3.4.m4.1.1.cmml"><mi id="S4.SS2.p3.4.m4.1.1.2" xref="S4.SS2.p3.4.m4.1.1.2.cmml">u</mi><mo id="S4.SS2.p3.4.m4.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.4.m4.1.1.3" xref="S4.SS2.p3.4.m4.1.1.3.cmml">s</mi><mo id="S4.SS2.p3.4.m4.1.1.1a" xref="S4.SS2.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.4.m4.1.1.4" xref="S4.SS2.p3.4.m4.1.1.4.cmml">e</mi><mo id="S4.SS2.p3.4.m4.1.1.1b" xref="S4.SS2.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.4.m4.1.1.5" xref="S4.SS2.p3.4.m4.1.1.5.cmml">r</mi><mo id="S4.SS2.p3.4.m4.1.1.1c" xref="S4.SS2.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.4.m4.1.1.6" mathvariant="normal" xref="S4.SS2.p3.4.m4.1.1.6.cmml">_</mi><mo id="S4.SS2.p3.4.m4.1.1.1d" xref="S4.SS2.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.4.m4.1.1.7" xref="S4.SS2.p3.4.m4.1.1.7.cmml">i</mi><mo id="S4.SS2.p3.4.m4.1.1.1e" xref="S4.SS2.p3.4.m4.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.4.m4.1.1.8" xref="S4.SS2.p3.4.m4.1.1.8.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.4.m4.1b"><apply id="S4.SS2.p3.4.m4.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1"><times id="S4.SS2.p3.4.m4.1.1.1.cmml" xref="S4.SS2.p3.4.m4.1.1.1"></times><ci id="S4.SS2.p3.4.m4.1.1.2.cmml" xref="S4.SS2.p3.4.m4.1.1.2">𝑢</ci><ci id="S4.SS2.p3.4.m4.1.1.3.cmml" xref="S4.SS2.p3.4.m4.1.1.3">𝑠</ci><ci id="S4.SS2.p3.4.m4.1.1.4.cmml" xref="S4.SS2.p3.4.m4.1.1.4">𝑒</ci><ci id="S4.SS2.p3.4.m4.1.1.5.cmml" xref="S4.SS2.p3.4.m4.1.1.5">𝑟</ci><ci id="S4.SS2.p3.4.m4.1.1.6.cmml" xref="S4.SS2.p3.4.m4.1.1.6">_</ci><ci id="S4.SS2.p3.4.m4.1.1.7.cmml" xref="S4.SS2.p3.4.m4.1.1.7">𝑖</ci><ci id="S4.SS2.p3.4.m4.1.1.8.cmml" xref="S4.SS2.p3.4.m4.1.1.8">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.4.m4.1c">user\_id</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.4.m4.1d">italic_u italic_s italic_e italic_r _ italic_i italic_d</annotation></semantics></math>, effectively representing second-order nodes in the interaction graph. Within this framework, <math alttext="ID\_Embedding" class="ltx_Math" display="inline" id="S4.SS2.p3.5.m5.1"><semantics id="S4.SS2.p3.5.m5.1a"><mrow id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml"><mi id="S4.SS2.p3.5.m5.1.1.2" xref="S4.SS2.p3.5.m5.1.1.2.cmml">I</mi><mo id="S4.SS2.p3.5.m5.1.1.1" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml">D</mi><mo id="S4.SS2.p3.5.m5.1.1.1a" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.4" mathvariant="normal" xref="S4.SS2.p3.5.m5.1.1.4.cmml">_</mi><mo id="S4.SS2.p3.5.m5.1.1.1b" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.5" xref="S4.SS2.p3.5.m5.1.1.5.cmml">E</mi><mo id="S4.SS2.p3.5.m5.1.1.1c" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.6" xref="S4.SS2.p3.5.m5.1.1.6.cmml">m</mi><mo id="S4.SS2.p3.5.m5.1.1.1d" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.7" xref="S4.SS2.p3.5.m5.1.1.7.cmml">b</mi><mo id="S4.SS2.p3.5.m5.1.1.1e" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.8" xref="S4.SS2.p3.5.m5.1.1.8.cmml">e</mi><mo id="S4.SS2.p3.5.m5.1.1.1f" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.9" xref="S4.SS2.p3.5.m5.1.1.9.cmml">d</mi><mo id="S4.SS2.p3.5.m5.1.1.1g" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.10" xref="S4.SS2.p3.5.m5.1.1.10.cmml">d</mi><mo id="S4.SS2.p3.5.m5.1.1.1h" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.11" xref="S4.SS2.p3.5.m5.1.1.11.cmml">i</mi><mo id="S4.SS2.p3.5.m5.1.1.1i" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.12" xref="S4.SS2.p3.5.m5.1.1.12.cmml">n</mi><mo id="S4.SS2.p3.5.m5.1.1.1j" xref="S4.SS2.p3.5.m5.1.1.1.cmml">⁢</mo><mi id="S4.SS2.p3.5.m5.1.1.13" xref="S4.SS2.p3.5.m5.1.1.13.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.5.m5.1b"><apply id="S4.SS2.p3.5.m5.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1"><times id="S4.SS2.p3.5.m5.1.1.1.cmml" xref="S4.SS2.p3.5.m5.1.1.1"></times><ci id="S4.SS2.p3.5.m5.1.1.2.cmml" xref="S4.SS2.p3.5.m5.1.1.2">𝐼</ci><ci id="S4.SS2.p3.5.m5.1.1.3.cmml" xref="S4.SS2.p3.5.m5.1.1.3">𝐷</ci><ci id="S4.SS2.p3.5.m5.1.1.4.cmml" xref="S4.SS2.p3.5.m5.1.1.4">_</ci><ci id="S4.SS2.p3.5.m5.1.1.5.cmml" xref="S4.SS2.p3.5.m5.1.1.5">𝐸</ci><ci id="S4.SS2.p3.5.m5.1.1.6.cmml" xref="S4.SS2.p3.5.m5.1.1.6">𝑚</ci><ci id="S4.SS2.p3.5.m5.1.1.7.cmml" xref="S4.SS2.p3.5.m5.1.1.7">𝑏</ci><ci id="S4.SS2.p3.5.m5.1.1.8.cmml" xref="S4.SS2.p3.5.m5.1.1.8">𝑒</ci><ci id="S4.SS2.p3.5.m5.1.1.9.cmml" xref="S4.SS2.p3.5.m5.1.1.9">𝑑</ci><ci id="S4.SS2.p3.5.m5.1.1.10.cmml" xref="S4.SS2.p3.5.m5.1.1.10">𝑑</ci><ci id="S4.SS2.p3.5.m5.1.1.11.cmml" xref="S4.SS2.p3.5.m5.1.1.11">𝑖</ci><ci id="S4.SS2.p3.5.m5.1.1.12.cmml" xref="S4.SS2.p3.5.m5.1.1.12">𝑛</ci><ci id="S4.SS2.p3.5.m5.1.1.13.cmml" xref="S4.SS2.p3.5.m5.1.1.13">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p3.5.m5.1c">ID\_Embedding</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p3.5.m5.1d">italic_I italic_D _ italic_E italic_m italic_b italic_e italic_d italic_d italic_i italic_n italic_g</annotation></semantics></math> is utilized to incorporate collaborative information as captured by the conventional model or the semantic information processed by a pre-trained model.
Then we further encode the instruction data into the embedding sequence <span class="ltx_text ltx_font_italic" id="S4.SS2.p3.5.1">E:</span></p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<table class="ltx_equation ltx_eqn_table" id="S4.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="E=[e_{1},e_{2},...,e_{u},..,e_{i},...]," class="ltx_math_unparsed" display="block" id="S4.E4.m1.1"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1b"><mi id="S4.E4.m1.1.2">E</mi><mo id="S4.E4.m1.1.3">=</mo><mrow id="S4.E4.m1.1.4"><mo id="S4.E4.m1.1.4.1" stretchy="false">[</mo><msub id="S4.E4.m1.1.4.2"><mi id="S4.E4.m1.1.4.2.2">e</mi><mn id="S4.E4.m1.1.4.2.3">1</mn></msub><mo id="S4.E4.m1.1.4.3">,</mo><msub id="S4.E4.m1.1.4.4"><mi id="S4.E4.m1.1.4.4.2">e</mi><mn id="S4.E4.m1.1.4.4.3">2</mn></msub><mo id="S4.E4.m1.1.4.5">,</mo><mi id="S4.E4.m1.1.1" mathvariant="normal">…</mi><mo id="S4.E4.m1.1.4.6">,</mo><msub id="S4.E4.m1.1.4.7"><mi id="S4.E4.m1.1.4.7.2">e</mi><mi id="S4.E4.m1.1.4.7.3">u</mi></msub><mo id="S4.E4.m1.1.4.8">,</mo><mo id="S4.E4.m1.1.4.9" lspace="0em" rspace="0.0835em">.</mo><mo id="S4.E4.m1.1.4.10" lspace="0.0835em" rspace="0.167em">.</mo><mo id="S4.E4.m1.1.4.11">,</mo><msub id="S4.E4.m1.1.4.12"><mi id="S4.E4.m1.1.4.12.2">e</mi><mi id="S4.E4.m1.1.4.12.3">i</mi></msub><mo id="S4.E4.m1.1.4.13">,</mo><mi id="S4.E4.m1.1.4.14" mathvariant="normal">…</mi><mo id="S4.E4.m1.1.4.15" stretchy="false">]</mo></mrow><mo id="S4.E4.m1.1.5">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E4.m1.1c">E=[e_{1},e_{2},...,e_{u},..,e_{i},...],</annotation><annotation encoding="application/x-llamapun" id="S4.E4.m1.1d">italic_E = [ italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_e start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , . . , italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , … ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.4">where <math alttext="e_{u}" class="ltx_Math" display="inline" id="S4.SS2.p5.1.m1.1"><semantics id="S4.SS2.p5.1.m1.1a"><msub id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml"><mi id="S4.SS2.p5.1.m1.1.1.2" xref="S4.SS2.p5.1.m1.1.1.2.cmml">e</mi><mi id="S4.SS2.p5.1.m1.1.1.3" xref="S4.SS2.p5.1.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.1.m1.1b"><apply id="S4.SS2.p5.1.m1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.1.m1.1.1.1.cmml" xref="S4.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.p5.1.m1.1.1.2.cmml" xref="S4.SS2.p5.1.m1.1.1.2">𝑒</ci><ci id="S4.SS2.p5.1.m1.1.1.3.cmml" xref="S4.SS2.p5.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.1.m1.1c">e_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.1.m1.1d">italic_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is obtained from <math alttext="e_{1}" class="ltx_Math" display="inline" id="S4.SS2.p5.2.m2.1"><semantics id="S4.SS2.p5.2.m2.1a"><msub id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml"><mi id="S4.SS2.p5.2.m2.1.1.2" xref="S4.SS2.p5.2.m2.1.1.2.cmml">e</mi><mn id="S4.SS2.p5.2.m2.1.1.3" xref="S4.SS2.p5.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.2.m2.1b"><apply id="S4.SS2.p5.2.m2.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.2.m2.1.1.1.cmml" xref="S4.SS2.p5.2.m2.1.1">subscript</csymbol><ci id="S4.SS2.p5.2.m2.1.1.2.cmml" xref="S4.SS2.p5.2.m2.1.1.2">𝑒</ci><cn id="S4.SS2.p5.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p5.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.2.m2.1c">e_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.2.m2.1d">italic_e start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>=<math alttext="Emb_{LLM}(x_{1})" class="ltx_Math" display="inline" id="S4.SS2.p5.3.m3.1"><semantics id="S4.SS2.p5.3.m3.1a"><mrow id="S4.SS2.p5.3.m3.1.1" xref="S4.SS2.p5.3.m3.1.1.cmml"><mi id="S4.SS2.p5.3.m3.1.1.3" xref="S4.SS2.p5.3.m3.1.1.3.cmml">E</mi><mo id="S4.SS2.p5.3.m3.1.1.2" xref="S4.SS2.p5.3.m3.1.1.2.cmml">⁢</mo><mi id="S4.SS2.p5.3.m3.1.1.4" xref="S4.SS2.p5.3.m3.1.1.4.cmml">m</mi><mo id="S4.SS2.p5.3.m3.1.1.2a" xref="S4.SS2.p5.3.m3.1.1.2.cmml">⁢</mo><msub id="S4.SS2.p5.3.m3.1.1.5" xref="S4.SS2.p5.3.m3.1.1.5.cmml"><mi id="S4.SS2.p5.3.m3.1.1.5.2" xref="S4.SS2.p5.3.m3.1.1.5.2.cmml">b</mi><mrow id="S4.SS2.p5.3.m3.1.1.5.3" xref="S4.SS2.p5.3.m3.1.1.5.3.cmml"><mi id="S4.SS2.p5.3.m3.1.1.5.3.2" xref="S4.SS2.p5.3.m3.1.1.5.3.2.cmml">L</mi><mo id="S4.SS2.p5.3.m3.1.1.5.3.1" xref="S4.SS2.p5.3.m3.1.1.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p5.3.m3.1.1.5.3.3" xref="S4.SS2.p5.3.m3.1.1.5.3.3.cmml">L</mi><mo id="S4.SS2.p5.3.m3.1.1.5.3.1a" xref="S4.SS2.p5.3.m3.1.1.5.3.1.cmml">⁢</mo><mi id="S4.SS2.p5.3.m3.1.1.5.3.4" xref="S4.SS2.p5.3.m3.1.1.5.3.4.cmml">M</mi></mrow></msub><mo id="S4.SS2.p5.3.m3.1.1.2b" xref="S4.SS2.p5.3.m3.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p5.3.m3.1.1.1.1" xref="S4.SS2.p5.3.m3.1.1.1.1.1.cmml"><mo id="S4.SS2.p5.3.m3.1.1.1.1.2" stretchy="false" xref="S4.SS2.p5.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S4.SS2.p5.3.m3.1.1.1.1.1" xref="S4.SS2.p5.3.m3.1.1.1.1.1.cmml"><mi id="S4.SS2.p5.3.m3.1.1.1.1.1.2" xref="S4.SS2.p5.3.m3.1.1.1.1.1.2.cmml">x</mi><mn id="S4.SS2.p5.3.m3.1.1.1.1.1.3" xref="S4.SS2.p5.3.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.p5.3.m3.1.1.1.1.3" stretchy="false" xref="S4.SS2.p5.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.3.m3.1b"><apply id="S4.SS2.p5.3.m3.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1"><times id="S4.SS2.p5.3.m3.1.1.2.cmml" xref="S4.SS2.p5.3.m3.1.1.2"></times><ci id="S4.SS2.p5.3.m3.1.1.3.cmml" xref="S4.SS2.p5.3.m3.1.1.3">𝐸</ci><ci id="S4.SS2.p5.3.m3.1.1.4.cmml" xref="S4.SS2.p5.3.m3.1.1.4">𝑚</ci><apply id="S4.SS2.p5.3.m3.1.1.5.cmml" xref="S4.SS2.p5.3.m3.1.1.5"><csymbol cd="ambiguous" id="S4.SS2.p5.3.m3.1.1.5.1.cmml" xref="S4.SS2.p5.3.m3.1.1.5">subscript</csymbol><ci id="S4.SS2.p5.3.m3.1.1.5.2.cmml" xref="S4.SS2.p5.3.m3.1.1.5.2">𝑏</ci><apply id="S4.SS2.p5.3.m3.1.1.5.3.cmml" xref="S4.SS2.p5.3.m3.1.1.5.3"><times id="S4.SS2.p5.3.m3.1.1.5.3.1.cmml" xref="S4.SS2.p5.3.m3.1.1.5.3.1"></times><ci id="S4.SS2.p5.3.m3.1.1.5.3.2.cmml" xref="S4.SS2.p5.3.m3.1.1.5.3.2">𝐿</ci><ci id="S4.SS2.p5.3.m3.1.1.5.3.3.cmml" xref="S4.SS2.p5.3.m3.1.1.5.3.3">𝐿</ci><ci id="S4.SS2.p5.3.m3.1.1.5.3.4.cmml" xref="S4.SS2.p5.3.m3.1.1.5.3.4">𝑀</ci></apply></apply><apply id="S4.SS2.p5.3.m3.1.1.1.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p5.3.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.p5.3.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS2.p5.3.m3.1.1.1.1.1.2.cmml" xref="S4.SS2.p5.3.m3.1.1.1.1.1.2">𝑥</ci><cn id="S4.SS2.p5.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S4.SS2.p5.3.m3.1.1.1.1.1.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.3.m3.1c">Emb_{LLM}(x_{1})</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.3.m3.1d">italic_E italic_m italic_b start_POSTSUBSCRIPT italic_L italic_L italic_M end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math>. While <math alttext="e_{u}/e_{i}" class="ltx_Math" display="inline" id="S4.SS2.p5.4.m4.1"><semantics id="S4.SS2.p5.4.m4.1a"><mrow id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml"><msub id="S4.SS2.p5.4.m4.1.1.2" xref="S4.SS2.p5.4.m4.1.1.2.cmml"><mi id="S4.SS2.p5.4.m4.1.1.2.2" xref="S4.SS2.p5.4.m4.1.1.2.2.cmml">e</mi><mi id="S4.SS2.p5.4.m4.1.1.2.3" xref="S4.SS2.p5.4.m4.1.1.2.3.cmml">u</mi></msub><mo id="S4.SS2.p5.4.m4.1.1.1" xref="S4.SS2.p5.4.m4.1.1.1.cmml">/</mo><msub id="S4.SS2.p5.4.m4.1.1.3" xref="S4.SS2.p5.4.m4.1.1.3.cmml"><mi id="S4.SS2.p5.4.m4.1.1.3.2" xref="S4.SS2.p5.4.m4.1.1.3.2.cmml">e</mi><mi id="S4.SS2.p5.4.m4.1.1.3.3" xref="S4.SS2.p5.4.m4.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p5.4.m4.1b"><apply id="S4.SS2.p5.4.m4.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1"><divide id="S4.SS2.p5.4.m4.1.1.1.cmml" xref="S4.SS2.p5.4.m4.1.1.1"></divide><apply id="S4.SS2.p5.4.m4.1.1.2.cmml" xref="S4.SS2.p5.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p5.4.m4.1.1.2.1.cmml" xref="S4.SS2.p5.4.m4.1.1.2">subscript</csymbol><ci id="S4.SS2.p5.4.m4.1.1.2.2.cmml" xref="S4.SS2.p5.4.m4.1.1.2.2">𝑒</ci><ci id="S4.SS2.p5.4.m4.1.1.2.3.cmml" xref="S4.SS2.p5.4.m4.1.1.2.3">𝑢</ci></apply><apply id="S4.SS2.p5.4.m4.1.1.3.cmml" xref="S4.SS2.p5.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p5.4.m4.1.1.3.1.cmml" xref="S4.SS2.p5.4.m4.1.1.3">subscript</csymbol><ci id="S4.SS2.p5.4.m4.1.1.3.2.cmml" xref="S4.SS2.p5.4.m4.1.1.3.2">𝑒</ci><ci id="S4.SS2.p5.4.m4.1.1.3.3.cmml" xref="S4.SS2.p5.4.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p5.4.m4.1c">e_{u}/e_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p5.4.m4.1d">italic_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT / italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> denotes the external embeddings</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS3.5.1.1">IV-C</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS3.6.2">Graph-Aware Learning</span>
</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In this section, we will introduce GAL. As previously discussed, merely mapping collaborative information captured by external models into an LLM’s token embedding space for fine-tuning proves insufficient. This approach does not enable LLMs to fully grasp collaborative signals, leading to suboptimal performance. Furthermore, solely embedding items’ semantic information into LLMs, while neglecting the incorporation of collaborative information, overlooks critical aspects of user-item interactions. Consequently, we advocate for a contrastive learning methodology for LLM, drawing inspiration from GNN’s aggregation strategies.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">In the user interaction graph, two distinct node types exist: users and items. Invariably, a user’s first-order neighbors are items, and their second-order neighbors are other users, a property mirrored in item nodes.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">In the context of collaborative filtering within recommendation systems, we observe the following on the user side:</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1"><span class="ltx_text ltx_font_italic" id="S4.SS3.p4.1.1">1). Aligning user-2-hop with user-0-hop. </span>
In a user-item interaction graph, second-order neighbors of a central user (item) are defined as those similar, like-minded users (items) who share common features or preferences. For the central node, the process of aggregating second-order information essentially entails consolidating the features of these similar homogeneous neighbors. Within the recommendation system’s semantic space, this aggregated data is expected to closely resemble, and align more with, the central user’s or item’s embedding. Therefore, in the context of integrating LLMs within recommendation systems, the formal expression is delineated as follows:</p>
</div>
<div class="ltx_para" id="S4.SS3.p5">
<table class="ltx_equation ltx_eqn_table" id="S4.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathcal{L}^{u}_{1}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{0}_{u},E^{%
2}_{u}\Big{)}/\tau\Big{)}}{\sum_{v\in\mathcal{U}}\exp\Big{(}\text{sim}\Big{(}E%
^{0}_{v},E^{2}_{u}\Big{)}/\tau\Big{)}}," class="ltx_Math" display="block" id="S4.E5.m1.5"><semantics id="S4.E5.m1.5a"><mrow id="S4.E5.m1.5.5.1" xref="S4.E5.m1.5.5.1.1.cmml"><mrow id="S4.E5.m1.5.5.1.1" xref="S4.E5.m1.5.5.1.1.cmml"><msubsup id="S4.E5.m1.5.5.1.1.2" xref="S4.E5.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.5.5.1.1.2.2.2" mathsize="90%" xref="S4.E5.m1.5.5.1.1.2.2.2.cmml">ℒ</mi><mn id="S4.E5.m1.5.5.1.1.2.3" mathsize="90%" xref="S4.E5.m1.5.5.1.1.2.3.cmml">1</mn><mi id="S4.E5.m1.5.5.1.1.2.2.3" mathsize="90%" xref="S4.E5.m1.5.5.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S4.E5.m1.5.5.1.1.1" mathsize="90%" xref="S4.E5.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E5.m1.5.5.1.1.3" xref="S4.E5.m1.5.5.1.1.3.cmml"><mo id="S4.E5.m1.5.5.1.1.3a" mathsize="90%" rspace="0.167em" xref="S4.E5.m1.5.5.1.1.3.cmml">−</mo><mrow id="S4.E5.m1.5.5.1.1.3.2" xref="S4.E5.m1.5.5.1.1.3.2.cmml"><mi id="S4.E5.m1.5.5.1.1.3.2.1" mathsize="90%" xref="S4.E5.m1.5.5.1.1.3.2.1.cmml">log</mi><mo id="S4.E5.m1.5.5.1.1.3.2a" lspace="0.167em" xref="S4.E5.m1.5.5.1.1.3.2.cmml">⁡</mo><mfrac id="S4.E5.m1.4.4" xref="S4.E5.m1.4.4.cmml"><mrow id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1" mathsize="90%" xref="S4.E5.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E5.m1.2.2.2.2a" xref="S4.E5.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E5.m1.2.2.2.2.1" xref="S4.E5.m1.2.2.2.3.cmml"><mo id="S4.E5.m1.2.2.2.2.1.2" maxsize="160%" minsize="160%" xref="S4.E5.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E5.m1.2.2.2.2.1.1" xref="S4.E5.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E5.m1.2.2.2.2.1.1.2" xref="S4.E5.m1.2.2.2.2.1.1.2.cmml"><mtext id="S4.E5.m1.2.2.2.2.1.1.2.4" mathsize="90%" xref="S4.E5.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo id="S4.E5.m1.2.2.2.2.1.1.2.3" xref="S4.E5.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E5.m1.2.2.2.2.1.1.2.2.2" xref="S4.E5.m1.2.2.2.2.1.1.2.2.3.cmml"><mo id="S4.E5.m1.2.2.2.2.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E5.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">u</mi><mn id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.E5.m1.2.2.2.2.1.1.2.2.2.4" mathsize="90%" xref="S4.E5.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">u</mi><mn id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S4.E5.m1.2.2.2.2.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E5.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.2.2.2.2.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E5.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S4.E5.m1.2.2.2.2.1.1.4" mathsize="90%" xref="S4.E5.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo id="S4.E5.m1.2.2.2.2.1.3" maxsize="160%" minsize="160%" xref="S4.E5.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E5.m1.4.4.4" xref="S4.E5.m1.4.4.4.cmml"><msub id="S4.E5.m1.4.4.4.3" xref="S4.E5.m1.4.4.4.3.cmml"><mo id="S4.E5.m1.4.4.4.3.2" maxsize="90%" minsize="90%" stretchy="true" xref="S4.E5.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S4.E5.m1.4.4.4.3.3" xref="S4.E5.m1.4.4.4.3.3.cmml"><mi id="S4.E5.m1.4.4.4.3.3.2" mathsize="90%" xref="S4.E5.m1.4.4.4.3.3.2.cmml">v</mi><mo id="S4.E5.m1.4.4.4.3.3.1" mathsize="90%" xref="S4.E5.m1.4.4.4.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.4.4.4.3.3.3" mathsize="90%" xref="S4.E5.m1.4.4.4.3.3.3.cmml">𝒰</mi></mrow></msub><mrow id="S4.E5.m1.4.4.4.2.1" xref="S4.E5.m1.4.4.4.2.2.cmml"><mi id="S4.E5.m1.3.3.3.1" mathsize="90%" xref="S4.E5.m1.3.3.3.1.cmml">exp</mi><mo id="S4.E5.m1.4.4.4.2.1a" xref="S4.E5.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.E5.m1.4.4.4.2.1.1" xref="S4.E5.m1.4.4.4.2.2.cmml"><mo id="S4.E5.m1.4.4.4.2.1.1.2" maxsize="160%" minsize="160%" xref="S4.E5.m1.4.4.4.2.2.cmml">(</mo><mrow id="S4.E5.m1.4.4.4.2.1.1.1" xref="S4.E5.m1.4.4.4.2.1.1.1.cmml"><mrow id="S4.E5.m1.4.4.4.2.1.1.1.2" xref="S4.E5.m1.4.4.4.2.1.1.1.2.cmml"><mtext id="S4.E5.m1.4.4.4.2.1.1.1.2.4" mathsize="90%" xref="S4.E5.m1.4.4.4.2.1.1.1.2.4a.cmml">sim</mtext><mo id="S4.E5.m1.4.4.4.2.1.1.1.2.3" xref="S4.E5.m1.4.4.4.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.3.cmml"><mo id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml">v</mi><mn id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.4" mathsize="90%" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mi id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml">u</mi><mn id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.4.4.4.2.1.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E5.m1.4.4.4.2.1.1.1.3.cmml">/</mo><mi id="S4.E5.m1.4.4.4.2.1.1.1.4" mathsize="90%" xref="S4.E5.m1.4.4.4.2.1.1.1.4.cmml">τ</mi></mrow><mo id="S4.E5.m1.4.4.4.2.1.1.3" maxsize="160%" minsize="160%" xref="S4.E5.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E5.m1.5.5.1.2" mathsize="90%" xref="S4.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.5b"><apply id="S4.E5.m1.5.5.1.1.cmml" xref="S4.E5.m1.5.5.1"><eq id="S4.E5.m1.5.5.1.1.1.cmml" xref="S4.E5.m1.5.5.1.1.1"></eq><apply id="S4.E5.m1.5.5.1.1.2.cmml" xref="S4.E5.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.1.cmml" xref="S4.E5.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E5.m1.5.5.1.1.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.5.5.1.1.2.2.1.cmml" xref="S4.E5.m1.5.5.1.1.2">superscript</csymbol><ci id="S4.E5.m1.5.5.1.1.2.2.2.cmml" xref="S4.E5.m1.5.5.1.1.2.2.2">ℒ</ci><ci id="S4.E5.m1.5.5.1.1.2.2.3.cmml" xref="S4.E5.m1.5.5.1.1.2.2.3">𝑢</ci></apply><cn id="S4.E5.m1.5.5.1.1.2.3.cmml" type="integer" xref="S4.E5.m1.5.5.1.1.2.3">1</cn></apply><apply id="S4.E5.m1.5.5.1.1.3.cmml" xref="S4.E5.m1.5.5.1.1.3"><minus id="S4.E5.m1.5.5.1.1.3.1.cmml" xref="S4.E5.m1.5.5.1.1.3"></minus><apply id="S4.E5.m1.5.5.1.1.3.2.cmml" xref="S4.E5.m1.5.5.1.1.3.2"><log id="S4.E5.m1.5.5.1.1.3.2.1.cmml" xref="S4.E5.m1.5.5.1.1.3.2.1"></log><apply id="S4.E5.m1.4.4.cmml" xref="S4.E5.m1.4.4"><divide id="S4.E5.m1.4.4.5.cmml" xref="S4.E5.m1.4.4"></divide><apply id="S4.E5.m1.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.2"><exp id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1"></exp><apply id="S4.E5.m1.2.2.2.2.1.1.cmml" xref="S4.E5.m1.2.2.2.2.1.1"><divide id="S4.E5.m1.2.2.2.2.1.1.3.cmml" xref="S4.E5.m1.2.2.2.2.1.1.3"></divide><apply id="S4.E5.m1.2.2.2.2.1.1.2.cmml" xref="S4.E5.m1.2.2.2.2.1.1.2"><times id="S4.E5.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E5.m1.2.2.2.2.1.1.2.3"></times><ci id="S4.E5.m1.2.2.2.2.1.1.2.4a.cmml" xref="S4.E5.m1.2.2.2.2.1.1.2.4"><mtext id="S4.E5.m1.2.2.2.2.1.1.2.4.cmml" mathsize="90%" xref="S4.E5.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E5.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2"><apply id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.2.2.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.2.3">2</cn></apply><ci id="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E5.m1.2.2.2.2.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply><ci id="S4.E5.m1.2.2.2.2.1.1.4.cmml" xref="S4.E5.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S4.E5.m1.4.4.4.cmml" xref="S4.E5.m1.4.4.4"><apply id="S4.E5.m1.4.4.4.3.cmml" xref="S4.E5.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.4.3.1.cmml" xref="S4.E5.m1.4.4.4.3">subscript</csymbol><sum id="S4.E5.m1.4.4.4.3.2.cmml" xref="S4.E5.m1.4.4.4.3.2"></sum><apply id="S4.E5.m1.4.4.4.3.3.cmml" xref="S4.E5.m1.4.4.4.3.3"><in id="S4.E5.m1.4.4.4.3.3.1.cmml" xref="S4.E5.m1.4.4.4.3.3.1"></in><ci id="S4.E5.m1.4.4.4.3.3.2.cmml" xref="S4.E5.m1.4.4.4.3.3.2">𝑣</ci><ci id="S4.E5.m1.4.4.4.3.3.3.cmml" xref="S4.E5.m1.4.4.4.3.3.3">𝒰</ci></apply></apply><apply id="S4.E5.m1.4.4.4.2.2.cmml" xref="S4.E5.m1.4.4.4.2.1"><exp id="S4.E5.m1.3.3.3.1.cmml" xref="S4.E5.m1.3.3.3.1"></exp><apply id="S4.E5.m1.4.4.4.2.1.1.1.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1"><divide id="S4.E5.m1.4.4.4.2.1.1.1.3.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.3"></divide><apply id="S4.E5.m1.4.4.4.2.1.1.1.2.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.2"><times id="S4.E5.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.2.3"></times><ci id="S4.E5.m1.4.4.4.2.1.1.1.2.4a.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.2.4"><mtext id="S4.E5.m1.4.4.4.2.1.1.1.2.4.cmml" mathsize="90%" xref="S4.E5.m1.4.4.4.2.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E5.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2"><apply id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.1.1.1.1.3">𝑣</ci></apply><apply id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.1.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.2.3">2</cn></apply><ci id="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply><ci id="S4.E5.m1.4.4.4.2.1.1.1.4.cmml" xref="S4.E5.m1.4.4.4.2.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.5c">\small\mathcal{L}^{u}_{1}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{0}_{u},E^{%
2}_{u}\Big{)}/\tau\Big{)}}{\sum_{v\in\mathcal{U}}\exp\Big{(}\text{sim}\Big{(}E%
^{0}_{v},E^{2}_{u}\Big{)}/\tau\Big{)}},</annotation><annotation encoding="application/x-llamapun" id="S4.E5.m1.5d">caligraphic_L start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_v ∈ caligraphic_U end_POSTSUBSCRIPT roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) / italic_τ ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.p6">
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathcal{L}^{i}_{1}=-\log\frac{\exp\left(\text{sim}\left(E^{0}_{i},E^{2}%
_{i}\right)/\tau\right)}{\sum_{j\in\mathcal{I}}\exp\left(\text{sim}\left(E^{0}%
_{j},E^{2}_{i}\right)/\tau\right)}," class="ltx_Math" display="block" id="S4.E6.m1.5"><semantics id="S4.E6.m1.5a"><mrow id="S4.E6.m1.5.5.1" xref="S4.E6.m1.5.5.1.1.cmml"><mrow id="S4.E6.m1.5.5.1.1" xref="S4.E6.m1.5.5.1.1.cmml"><msubsup id="S4.E6.m1.5.5.1.1.2" xref="S4.E6.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.5.5.1.1.2.2.2" mathsize="90%" xref="S4.E6.m1.5.5.1.1.2.2.2.cmml">ℒ</mi><mn id="S4.E6.m1.5.5.1.1.2.3" mathsize="90%" xref="S4.E6.m1.5.5.1.1.2.3.cmml">1</mn><mi id="S4.E6.m1.5.5.1.1.2.2.3" mathsize="90%" xref="S4.E6.m1.5.5.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S4.E6.m1.5.5.1.1.1" mathsize="90%" xref="S4.E6.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E6.m1.5.5.1.1.3" xref="S4.E6.m1.5.5.1.1.3.cmml"><mo id="S4.E6.m1.5.5.1.1.3a" mathsize="90%" rspace="0.167em" xref="S4.E6.m1.5.5.1.1.3.cmml">−</mo><mrow id="S4.E6.m1.5.5.1.1.3.2" xref="S4.E6.m1.5.5.1.1.3.2.cmml"><mi id="S4.E6.m1.5.5.1.1.3.2.1" mathsize="90%" xref="S4.E6.m1.5.5.1.1.3.2.1.cmml">log</mi><mo id="S4.E6.m1.5.5.1.1.3.2a" lspace="0.167em" xref="S4.E6.m1.5.5.1.1.3.2.cmml">⁡</mo><mfrac id="S4.E6.m1.4.4" xref="S4.E6.m1.4.4.cmml"><mrow id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1" mathsize="90%" xref="S4.E6.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E6.m1.2.2.2.2a" xref="S4.E6.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E6.m1.2.2.2.2.1" xref="S4.E6.m1.2.2.2.3.cmml"><mo id="S4.E6.m1.2.2.2.2.1.2" xref="S4.E6.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E6.m1.2.2.2.2.1.1" xref="S4.E6.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E6.m1.2.2.2.2.1.1.2" xref="S4.E6.m1.2.2.2.2.1.1.2.cmml"><mtext id="S4.E6.m1.2.2.2.2.1.1.2.4" mathsize="90%" xref="S4.E6.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo id="S4.E6.m1.2.2.2.2.1.1.2.3" xref="S4.E6.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E6.m1.2.2.2.2.1.1.2.2.2" xref="S4.E6.m1.2.2.2.2.1.1.2.2.3.cmml"><mo id="S4.E6.m1.2.2.2.2.1.1.2.2.2.3" xref="S4.E6.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">i</mi><mn id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.E6.m1.2.2.2.2.1.1.2.2.2.4" mathsize="90%" xref="S4.E6.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">i</mi><mn id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S4.E6.m1.2.2.2.2.1.1.2.2.2.5" xref="S4.E6.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.2.2.2.2.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E6.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S4.E6.m1.2.2.2.2.1.1.4" mathsize="90%" xref="S4.E6.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo id="S4.E6.m1.2.2.2.2.1.3" xref="S4.E6.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E6.m1.4.4.4" xref="S4.E6.m1.4.4.4.cmml"><msub id="S4.E6.m1.4.4.4.3" xref="S4.E6.m1.4.4.4.3.cmml"><mo id="S4.E6.m1.4.4.4.3.2" maxsize="90%" minsize="90%" stretchy="true" xref="S4.E6.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S4.E6.m1.4.4.4.3.3" xref="S4.E6.m1.4.4.4.3.3.cmml"><mi id="S4.E6.m1.4.4.4.3.3.2" mathsize="90%" xref="S4.E6.m1.4.4.4.3.3.2.cmml">j</mi><mo id="S4.E6.m1.4.4.4.3.3.1" mathsize="90%" xref="S4.E6.m1.4.4.4.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.4.4.4.3.3.3" mathsize="90%" xref="S4.E6.m1.4.4.4.3.3.3.cmml">ℐ</mi></mrow></msub><mrow id="S4.E6.m1.4.4.4.2.1" xref="S4.E6.m1.4.4.4.2.2.cmml"><mi id="S4.E6.m1.3.3.3.1" mathsize="90%" xref="S4.E6.m1.3.3.3.1.cmml">exp</mi><mo id="S4.E6.m1.4.4.4.2.1a" xref="S4.E6.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.E6.m1.4.4.4.2.1.1" xref="S4.E6.m1.4.4.4.2.2.cmml"><mo id="S4.E6.m1.4.4.4.2.1.1.2" xref="S4.E6.m1.4.4.4.2.2.cmml">(</mo><mrow id="S4.E6.m1.4.4.4.2.1.1.1" xref="S4.E6.m1.4.4.4.2.1.1.1.cmml"><mrow id="S4.E6.m1.4.4.4.2.1.1.1.2" xref="S4.E6.m1.4.4.4.2.1.1.1.2.cmml"><mtext id="S4.E6.m1.4.4.4.2.1.1.1.2.4" mathsize="90%" xref="S4.E6.m1.4.4.4.2.1.1.1.2.4a.cmml">sim</mtext><mo id="S4.E6.m1.4.4.4.2.1.1.1.2.3" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.3.cmml"><mo id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.3" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml">j</mi><mn id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.4" mathsize="90%" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mi id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml">i</mi><mn id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.5" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.4.4.4.2.1.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E6.m1.4.4.4.2.1.1.1.3.cmml">/</mo><mi id="S4.E6.m1.4.4.4.2.1.1.1.4" mathsize="90%" xref="S4.E6.m1.4.4.4.2.1.1.1.4.cmml">τ</mi></mrow><mo id="S4.E6.m1.4.4.4.2.1.1.3" xref="S4.E6.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E6.m1.5.5.1.2" mathsize="90%" xref="S4.E6.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.5b"><apply id="S4.E6.m1.5.5.1.1.cmml" xref="S4.E6.m1.5.5.1"><eq id="S4.E6.m1.5.5.1.1.1.cmml" xref="S4.E6.m1.5.5.1.1.1"></eq><apply id="S4.E6.m1.5.5.1.1.2.cmml" xref="S4.E6.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E6.m1.5.5.1.1.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.1.1.2.2.1.cmml" xref="S4.E6.m1.5.5.1.1.2">superscript</csymbol><ci id="S4.E6.m1.5.5.1.1.2.2.2.cmml" xref="S4.E6.m1.5.5.1.1.2.2.2">ℒ</ci><ci id="S4.E6.m1.5.5.1.1.2.2.3.cmml" xref="S4.E6.m1.5.5.1.1.2.2.3">𝑖</ci></apply><cn id="S4.E6.m1.5.5.1.1.2.3.cmml" type="integer" xref="S4.E6.m1.5.5.1.1.2.3">1</cn></apply><apply id="S4.E6.m1.5.5.1.1.3.cmml" xref="S4.E6.m1.5.5.1.1.3"><minus id="S4.E6.m1.5.5.1.1.3.1.cmml" xref="S4.E6.m1.5.5.1.1.3"></minus><apply id="S4.E6.m1.5.5.1.1.3.2.cmml" xref="S4.E6.m1.5.5.1.1.3.2"><log id="S4.E6.m1.5.5.1.1.3.2.1.cmml" xref="S4.E6.m1.5.5.1.1.3.2.1"></log><apply id="S4.E6.m1.4.4.cmml" xref="S4.E6.m1.4.4"><divide id="S4.E6.m1.4.4.5.cmml" xref="S4.E6.m1.4.4"></divide><apply id="S4.E6.m1.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2"><exp id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1"></exp><apply id="S4.E6.m1.2.2.2.2.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1"><divide id="S4.E6.m1.2.2.2.2.1.1.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.3"></divide><apply id="S4.E6.m1.2.2.2.2.1.1.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2"><times id="S4.E6.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.3"></times><ci id="S4.E6.m1.2.2.2.2.1.1.2.4a.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.4"><mtext id="S4.E6.m1.2.2.2.2.1.1.2.4.cmml" mathsize="90%" xref="S4.E6.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E6.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2"><apply id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.2.3">2</cn></apply><ci id="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.2.2.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><ci id="S4.E6.m1.2.2.2.2.1.1.4.cmml" xref="S4.E6.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S4.E6.m1.4.4.4.cmml" xref="S4.E6.m1.4.4.4"><apply id="S4.E6.m1.4.4.4.3.cmml" xref="S4.E6.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.3.1.cmml" xref="S4.E6.m1.4.4.4.3">subscript</csymbol><sum id="S4.E6.m1.4.4.4.3.2.cmml" xref="S4.E6.m1.4.4.4.3.2"></sum><apply id="S4.E6.m1.4.4.4.3.3.cmml" xref="S4.E6.m1.4.4.4.3.3"><in id="S4.E6.m1.4.4.4.3.3.1.cmml" xref="S4.E6.m1.4.4.4.3.3.1"></in><ci id="S4.E6.m1.4.4.4.3.3.2.cmml" xref="S4.E6.m1.4.4.4.3.3.2">𝑗</ci><ci id="S4.E6.m1.4.4.4.3.3.3.cmml" xref="S4.E6.m1.4.4.4.3.3.3">ℐ</ci></apply></apply><apply id="S4.E6.m1.4.4.4.2.2.cmml" xref="S4.E6.m1.4.4.4.2.1"><exp id="S4.E6.m1.3.3.3.1.cmml" xref="S4.E6.m1.3.3.3.1"></exp><apply id="S4.E6.m1.4.4.4.2.1.1.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1"><divide id="S4.E6.m1.4.4.4.2.1.1.1.3.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.3"></divide><apply id="S4.E6.m1.4.4.4.2.1.1.1.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2"><times id="S4.E6.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.3"></times><ci id="S4.E6.m1.4.4.4.2.1.1.1.2.4a.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.4"><mtext id="S4.E6.m1.4.4.4.2.1.1.1.2.4.cmml" mathsize="90%" xref="S4.E6.m1.4.4.4.2.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E6.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2"><apply id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.2.3">2</cn></apply><ci id="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><ci id="S4.E6.m1.4.4.4.2.1.1.1.4.cmml" xref="S4.E6.m1.4.4.4.2.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.5c">\small\mathcal{L}^{i}_{1}=-\log\frac{\exp\left(\text{sim}\left(E^{0}_{i},E^{2}%
_{i}\right)/\tau\right)}{\sum_{j\in\mathcal{I}}\exp\left(\text{sim}\left(E^{0}%
_{j},E^{2}_{i}\right)/\tau\right)},</annotation><annotation encoding="application/x-llamapun" id="S4.E6.m1.5d">caligraphic_L start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_I end_POSTSUBSCRIPT roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) / italic_τ ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.p7">
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathcal{L}_{1}=\mathcal{L}^{u}_{1}+\mathcal{L}^{i}_{1}," class="ltx_Math" display="block" id="S4.E7.m1.1"><semantics id="S4.E7.m1.1a"><mrow id="S4.E7.m1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml"><mrow id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml"><msub id="S4.E7.m1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.1.1.1.2.2" mathsize="90%" xref="S4.E7.m1.1.1.1.1.2.2.cmml">ℒ</mi><mn id="S4.E7.m1.1.1.1.1.2.3" mathsize="90%" xref="S4.E7.m1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.E7.m1.1.1.1.1.1" mathsize="90%" xref="S4.E7.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E7.m1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.3.cmml"><msubsup id="S4.E7.m1.1.1.1.1.3.2" xref="S4.E7.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.1.1.1.3.2.2.2" mathsize="90%" xref="S4.E7.m1.1.1.1.1.3.2.2.2.cmml">ℒ</mi><mn id="S4.E7.m1.1.1.1.1.3.2.3" mathsize="90%" xref="S4.E7.m1.1.1.1.1.3.2.3.cmml">1</mn><mi id="S4.E7.m1.1.1.1.1.3.2.2.3" mathsize="90%" xref="S4.E7.m1.1.1.1.1.3.2.2.3.cmml">u</mi></msubsup><mo id="S4.E7.m1.1.1.1.1.3.1" mathsize="90%" xref="S4.E7.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S4.E7.m1.1.1.1.1.3.3" xref="S4.E7.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.1.1.1.3.3.2.2" mathsize="90%" xref="S4.E7.m1.1.1.1.1.3.3.2.2.cmml">ℒ</mi><mn id="S4.E7.m1.1.1.1.1.3.3.3" mathsize="90%" xref="S4.E7.m1.1.1.1.1.3.3.3.cmml">1</mn><mi id="S4.E7.m1.1.1.1.1.3.3.2.3" mathsize="90%" xref="S4.E7.m1.1.1.1.1.3.3.2.3.cmml">i</mi></msubsup></mrow></mrow><mo id="S4.E7.m1.1.1.1.2" mathsize="90%" xref="S4.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.1b"><apply id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1"><eq id="S4.E7.m1.1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1.1"></eq><apply id="S4.E7.m1.1.1.1.1.2.cmml" xref="S4.E7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.2.1.cmml" xref="S4.E7.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E7.m1.1.1.1.1.2.2.cmml" xref="S4.E7.m1.1.1.1.1.2.2">ℒ</ci><cn id="S4.E7.m1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E7.m1.1.1.1.1.2.3">1</cn></apply><apply id="S4.E7.m1.1.1.1.1.3.cmml" xref="S4.E7.m1.1.1.1.1.3"><plus id="S4.E7.m1.1.1.1.1.3.1.cmml" xref="S4.E7.m1.1.1.1.1.3.1"></plus><apply id="S4.E7.m1.1.1.1.1.3.2.cmml" xref="S4.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.2.1.cmml" xref="S4.E7.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S4.E7.m1.1.1.1.1.3.2.2.cmml" xref="S4.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E7.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.E7.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E7.m1.1.1.1.1.3.2.2.2">ℒ</ci><ci id="S4.E7.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E7.m1.1.1.1.1.3.2.2.3">𝑢</ci></apply><cn id="S4.E7.m1.1.1.1.1.3.2.3.cmml" type="integer" xref="S4.E7.m1.1.1.1.1.3.2.3">1</cn></apply><apply id="S4.E7.m1.1.1.1.1.3.3.cmml" xref="S4.E7.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.3.1.cmml" xref="S4.E7.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S4.E7.m1.1.1.1.1.3.3.2.cmml" xref="S4.E7.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E7.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.E7.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E7.m1.1.1.1.1.3.3.2.2">ℒ</ci><ci id="S4.E7.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E7.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply><cn id="S4.E7.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E7.m1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.1c">\small\mathcal{L}_{1}=\mathcal{L}^{u}_{1}+\mathcal{L}^{i}_{1},</annotation><annotation encoding="application/x-llamapun" id="S4.E7.m1.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = caligraphic_L start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + caligraphic_L start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p7.6">wherein <math alttext="E^{0}_{u}" class="ltx_Math" display="inline" id="S4.SS3.p7.1.m1.1"><semantics id="S4.SS3.p7.1.m1.1a"><msubsup id="S4.SS3.p7.1.m1.1.1" xref="S4.SS3.p7.1.m1.1.1.cmml"><mi id="S4.SS3.p7.1.m1.1.1.2.2" xref="S4.SS3.p7.1.m1.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p7.1.m1.1.1.3" xref="S4.SS3.p7.1.m1.1.1.3.cmml">u</mi><mn id="S4.SS3.p7.1.m1.1.1.2.3" xref="S4.SS3.p7.1.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.1.m1.1b"><apply id="S4.SS3.p7.1.m1.1.1.cmml" xref="S4.SS3.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.1.m1.1.1.1.cmml" xref="S4.SS3.p7.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.p7.1.m1.1.1.2.cmml" xref="S4.SS3.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.1.m1.1.1.2.1.cmml" xref="S4.SS3.p7.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p7.1.m1.1.1.2.2.cmml" xref="S4.SS3.p7.1.m1.1.1.2.2">𝐸</ci><cn id="S4.SS3.p7.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS3.p7.1.m1.1.1.2.3">0</cn></apply><ci id="S4.SS3.p7.1.m1.1.1.3.cmml" xref="S4.SS3.p7.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.1.m1.1c">E^{0}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.1.m1.1d">italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the embedding of the user’s zero-order aggregated data processed by the LLM-encoder, <math alttext="E^{2}_{u}" class="ltx_Math" display="inline" id="S4.SS3.p7.2.m2.1"><semantics id="S4.SS3.p7.2.m2.1a"><msubsup id="S4.SS3.p7.2.m2.1.1" xref="S4.SS3.p7.2.m2.1.1.cmml"><mi id="S4.SS3.p7.2.m2.1.1.2.2" xref="S4.SS3.p7.2.m2.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p7.2.m2.1.1.3" xref="S4.SS3.p7.2.m2.1.1.3.cmml">u</mi><mn id="S4.SS3.p7.2.m2.1.1.2.3" xref="S4.SS3.p7.2.m2.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.2.m2.1b"><apply id="S4.SS3.p7.2.m2.1.1.cmml" xref="S4.SS3.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.2.m2.1.1.1.cmml" xref="S4.SS3.p7.2.m2.1.1">subscript</csymbol><apply id="S4.SS3.p7.2.m2.1.1.2.cmml" xref="S4.SS3.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.2.m2.1.1.2.1.cmml" xref="S4.SS3.p7.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p7.2.m2.1.1.2.2.cmml" xref="S4.SS3.p7.2.m2.1.1.2.2">𝐸</ci><cn id="S4.SS3.p7.2.m2.1.1.2.3.cmml" type="integer" xref="S4.SS3.p7.2.m2.1.1.2.3">2</cn></apply><ci id="S4.SS3.p7.2.m2.1.1.3.cmml" xref="S4.SS3.p7.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.2.m2.1c">E^{2}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.2.m2.1d">italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the embedding of the user’s second-order aggregated data processed by the LLM-encoder, <math alttext="E^{0}_{v}" class="ltx_Math" display="inline" id="S4.SS3.p7.3.m3.1"><semantics id="S4.SS3.p7.3.m3.1a"><msubsup id="S4.SS3.p7.3.m3.1.1" xref="S4.SS3.p7.3.m3.1.1.cmml"><mi id="S4.SS3.p7.3.m3.1.1.2.2" xref="S4.SS3.p7.3.m3.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p7.3.m3.1.1.3" xref="S4.SS3.p7.3.m3.1.1.3.cmml">v</mi><mn id="S4.SS3.p7.3.m3.1.1.2.3" xref="S4.SS3.p7.3.m3.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.3.m3.1b"><apply id="S4.SS3.p7.3.m3.1.1.cmml" xref="S4.SS3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.3.m3.1.1.1.cmml" xref="S4.SS3.p7.3.m3.1.1">subscript</csymbol><apply id="S4.SS3.p7.3.m3.1.1.2.cmml" xref="S4.SS3.p7.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.3.m3.1.1.2.1.cmml" xref="S4.SS3.p7.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.p7.3.m3.1.1.2.2.cmml" xref="S4.SS3.p7.3.m3.1.1.2.2">𝐸</ci><cn id="S4.SS3.p7.3.m3.1.1.2.3.cmml" type="integer" xref="S4.SS3.p7.3.m3.1.1.2.3">0</cn></apply><ci id="S4.SS3.p7.3.m3.1.1.3.cmml" xref="S4.SS3.p7.3.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.3.m3.1c">E^{0}_{v}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.3.m3.1d">italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> is the embedding of the other user’s zero-order aggregated data processed by the LLM-encoder ,<math alttext="\tau" class="ltx_Math" display="inline" id="S4.SS3.p7.4.m4.1"><semantics id="S4.SS3.p7.4.m4.1a"><mi id="S4.SS3.p7.4.m4.1.1" xref="S4.SS3.p7.4.m4.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.4.m4.1b"><ci id="S4.SS3.p7.4.m4.1.1.cmml" xref="S4.SS3.p7.4.m4.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.4.m4.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.4.m4.1d">italic_τ</annotation></semantics></math> is the temperature hyperparameter of softmax. For item i, <math alttext="E^{0}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p7.5.m5.1"><semantics id="S4.SS3.p7.5.m5.1a"><msubsup id="S4.SS3.p7.5.m5.1.1" xref="S4.SS3.p7.5.m5.1.1.cmml"><mi id="S4.SS3.p7.5.m5.1.1.2.2" xref="S4.SS3.p7.5.m5.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p7.5.m5.1.1.3" xref="S4.SS3.p7.5.m5.1.1.3.cmml">i</mi><mn id="S4.SS3.p7.5.m5.1.1.2.3" xref="S4.SS3.p7.5.m5.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.5.m5.1b"><apply id="S4.SS3.p7.5.m5.1.1.cmml" xref="S4.SS3.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.5.m5.1.1.1.cmml" xref="S4.SS3.p7.5.m5.1.1">subscript</csymbol><apply id="S4.SS3.p7.5.m5.1.1.2.cmml" xref="S4.SS3.p7.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.5.m5.1.1.2.1.cmml" xref="S4.SS3.p7.5.m5.1.1">superscript</csymbol><ci id="S4.SS3.p7.5.m5.1.1.2.2.cmml" xref="S4.SS3.p7.5.m5.1.1.2.2">𝐸</ci><cn id="S4.SS3.p7.5.m5.1.1.2.3.cmml" type="integer" xref="S4.SS3.p7.5.m5.1.1.2.3">0</cn></apply><ci id="S4.SS3.p7.5.m5.1.1.3.cmml" xref="S4.SS3.p7.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.5.m5.1c">E^{0}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.5.m5.1d">italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>/<math alttext="E^{2}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p7.6.m6.1"><semantics id="S4.SS3.p7.6.m6.1a"><msubsup id="S4.SS3.p7.6.m6.1.1" xref="S4.SS3.p7.6.m6.1.1.cmml"><mi id="S4.SS3.p7.6.m6.1.1.2.2" xref="S4.SS3.p7.6.m6.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p7.6.m6.1.1.3" xref="S4.SS3.p7.6.m6.1.1.3.cmml">i</mi><mn id="S4.SS3.p7.6.m6.1.1.2.3" xref="S4.SS3.p7.6.m6.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p7.6.m6.1b"><apply id="S4.SS3.p7.6.m6.1.1.cmml" xref="S4.SS3.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.6.m6.1.1.1.cmml" xref="S4.SS3.p7.6.m6.1.1">subscript</csymbol><apply id="S4.SS3.p7.6.m6.1.1.2.cmml" xref="S4.SS3.p7.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p7.6.m6.1.1.2.1.cmml" xref="S4.SS3.p7.6.m6.1.1">superscript</csymbol><ci id="S4.SS3.p7.6.m6.1.1.2.2.cmml" xref="S4.SS3.p7.6.m6.1.1.2.2">𝐸</ci><cn id="S4.SS3.p7.6.m6.1.1.2.3.cmml" type="integer" xref="S4.SS3.p7.6.m6.1.1.2.3">2</cn></apply><ci id="S4.SS3.p7.6.m6.1.1.3.cmml" xref="S4.SS3.p7.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p7.6.m6.1c">E^{2}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p7.6.m6.1d">italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are similar.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> Algorithm of Graph-aware learning</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>user set <math alttext="U" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">U</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑈</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">U</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">italic_U</annotation></semantics></math>, item set <math alttext="I" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">I</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">italic_I</annotation></semantics></math>, interactions set <math alttext="R" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">R</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">italic_R</annotation></semantics></math>,prompt <math alttext="P" class="ltx_Math" display="inline" id="alg1.l1.m4.1"><semantics id="alg1.l1.m4.1a"><mi id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><ci id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m4.1d">italic_P</annotation></semantics></math>,external embedding <math alttext="h_{u}" class="ltx_Math" display="inline" id="alg1.l1.m5.1"><semantics id="alg1.l1.m5.1a"><msub id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">h</mi><mi id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">subscript</csymbol><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">ℎ</ci><ci id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">h_{u}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m5.1d">italic_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="h_{i}" class="ltx_Math" display="inline" id="alg1.l1.m6.1"><semantics id="alg1.l1.m6.1a"><msub id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml"><mi id="alg1.l1.m6.1.1.2" xref="alg1.l1.m6.1.1.2.cmml">h</mi><mi id="alg1.l1.m6.1.1.3" xref="alg1.l1.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><apply id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1"><csymbol cd="ambiguous" id="alg1.l1.m6.1.1.1.cmml" xref="alg1.l1.m6.1.1">subscript</csymbol><ci id="alg1.l1.m6.1.1.2.cmml" xref="alg1.l1.m6.1.1.2">ℎ</ci><ci id="alg1.l1.m6.1.1.3.cmml" xref="alg1.l1.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">h_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m6.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>LLM parameters <math alttext="\theta_{llm}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">θ</mi><mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">l</mi><mo id="alg1.l2.m1.1.1.3.1" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">l</mi><mo id="alg1.l2.m1.1.1.3.1a" xref="alg1.l2.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l2.m1.1.1.3.4" xref="alg1.l2.m1.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝜃</ci><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><times id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1"></times><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">𝑙</ci><ci id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">𝑙</ci><ci id="alg1.l2.m1.1.1.3.4.cmml" xref="alg1.l2.m1.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\theta_{llm}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_θ start_POSTSUBSCRIPT italic_l italic_l italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, mapping layer parameters <math alttext="\theta_{g}" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">θ</mi><mi id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝜃</ci><ci id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\theta_{g}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_θ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>Extend user/item tokens for LLM

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>Initialize mapping layer <math alttext="\theta_{g}" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><msub id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">θ</mi><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1">subscript</csymbol><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝜃</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\theta_{g}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_θ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\theta_{llm}" class="ltx_Math" display="inline" id="alg1.l4.m2.1"><semantics id="alg1.l4.m2.1a"><msub id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><mi id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml">θ</mi><mrow id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml"><mi id="alg1.l4.m2.1.1.3.2" xref="alg1.l4.m2.1.1.3.2.cmml">l</mi><mo id="alg1.l4.m2.1.1.3.1" xref="alg1.l4.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l4.m2.1.1.3.3" xref="alg1.l4.m2.1.1.3.3.cmml">l</mi><mo id="alg1.l4.m2.1.1.3.1a" xref="alg1.l4.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l4.m2.1.1.3.4" xref="alg1.l4.m2.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1">subscript</csymbol><ci id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2">𝜃</ci><apply id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3"><times id="alg1.l4.m2.1.1.3.1.cmml" xref="alg1.l4.m2.1.1.3.1"></times><ci id="alg1.l4.m2.1.1.3.2.cmml" xref="alg1.l4.m2.1.1.3.2">𝑙</ci><ci id="alg1.l4.m2.1.1.3.3.cmml" xref="alg1.l4.m2.1.1.3.3">𝑙</ci><ci id="alg1.l4.m2.1.1.3.4.cmml" xref="alg1.l4.m2.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">\theta_{llm}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m2.1d">italic_θ start_POSTSUBSCRIPT italic_l italic_l italic_m end_POSTSUBSCRIPT</annotation></semantics></math> is initialized with pretrained LLM parameters

</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l5.2">while</span>  not converge <span class="ltx_text ltx_font_bold" id="alg1.l5.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>     Sample(<math alttext="u_{0}" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">u</mi><mn id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑢</ci><cn id="alg1.l6.m1.1.1.3.cmml" type="integer" xref="alg1.l6.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">u_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">italic_u start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>,<math alttext="i_{0}" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><msub id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><mi id="alg1.l6.m2.1.1.2" xref="alg1.l6.m2.1.1.2.cmml">i</mi><mn id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1">subscript</csymbol><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">𝑖</ci><cn id="alg1.l6.m2.1.1.3.cmml" type="integer" xref="alg1.l6.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">i_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">italic_i start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math>) <math alttext="\in" class="ltx_Math" display="inline" id="alg1.l6.m3.1"><semantics id="alg1.l6.m3.1a"><mo id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><in id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">\in</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m3.1d">∈</annotation></semantics></math> R, prompt P, external embedding <math alttext="h_{u}" class="ltx_Math" display="inline" id="alg1.l6.m4.1"><semantics id="alg1.l6.m4.1a"><msub id="alg1.l6.m4.1.1" xref="alg1.l6.m4.1.1.cmml"><mi id="alg1.l6.m4.1.1.2" xref="alg1.l6.m4.1.1.2.cmml">h</mi><mi id="alg1.l6.m4.1.1.3" xref="alg1.l6.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m4.1b"><apply id="alg1.l6.m4.1.1.cmml" xref="alg1.l6.m4.1.1"><csymbol cd="ambiguous" id="alg1.l6.m4.1.1.1.cmml" xref="alg1.l6.m4.1.1">subscript</csymbol><ci id="alg1.l6.m4.1.1.2.cmml" xref="alg1.l6.m4.1.1.2">ℎ</ci><ci id="alg1.l6.m4.1.1.3.cmml" xref="alg1.l6.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m4.1c">h_{u}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m4.1d">italic_h start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="h_{i}" class="ltx_Math" display="inline" id="alg1.l6.m5.1"><semantics id="alg1.l6.m5.1a"><msub id="alg1.l6.m5.1.1" xref="alg1.l6.m5.1.1.cmml"><mi id="alg1.l6.m5.1.1.2" xref="alg1.l6.m5.1.1.2.cmml">h</mi><mi id="alg1.l6.m5.1.1.3" xref="alg1.l6.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m5.1b"><apply id="alg1.l6.m5.1.1.cmml" xref="alg1.l6.m5.1.1"><csymbol cd="ambiguous" id="alg1.l6.m5.1.1.1.cmml" xref="alg1.l6.m5.1.1">subscript</csymbol><ci id="alg1.l6.m5.1.1.2.cmml" xref="alg1.l6.m5.1.1.2">ℎ</ci><ci id="alg1.l6.m5.1.1.3.cmml" xref="alg1.l6.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m5.1c">h_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m5.1d">italic_h start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>     Sample multi-hop information <math alttext="u_{1}" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><msub id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">u</mi><mn id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑢</ci><cn id="alg1.l7.m1.1.1.3.cmml" type="integer" xref="alg1.l7.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">u_{1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_u start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>,<math alttext="u_{2}" class="ltx_Math" display="inline" id="alg1.l7.m2.1"><semantics id="alg1.l7.m2.1a"><msub id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml"><mi id="alg1.l7.m2.1.1.2" xref="alg1.l7.m2.1.1.2.cmml">u</mi><mn id="alg1.l7.m2.1.1.3" xref="alg1.l7.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><apply id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1"><csymbol cd="ambiguous" id="alg1.l7.m2.1.1.1.cmml" xref="alg1.l7.m2.1.1">subscript</csymbol><ci id="alg1.l7.m2.1.1.2.cmml" xref="alg1.l7.m2.1.1.2">𝑢</ci><cn id="alg1.l7.m2.1.1.3.cmml" type="integer" xref="alg1.l7.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">u_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m2.1d">italic_u start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>,<math alttext="i_{1}" class="ltx_Math" display="inline" id="alg1.l7.m3.1"><semantics id="alg1.l7.m3.1a"><msub id="alg1.l7.m3.1.1" xref="alg1.l7.m3.1.1.cmml"><mi id="alg1.l7.m3.1.1.2" xref="alg1.l7.m3.1.1.2.cmml">i</mi><mn id="alg1.l7.m3.1.1.3" xref="alg1.l7.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.1b"><apply id="alg1.l7.m3.1.1.cmml" xref="alg1.l7.m3.1.1"><csymbol cd="ambiguous" id="alg1.l7.m3.1.1.1.cmml" xref="alg1.l7.m3.1.1">subscript</csymbol><ci id="alg1.l7.m3.1.1.2.cmml" xref="alg1.l7.m3.1.1.2">𝑖</ci><cn id="alg1.l7.m3.1.1.3.cmml" type="integer" xref="alg1.l7.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.1c">i_{1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m3.1d">italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>,<math alttext="i_{2}" class="ltx_Math" display="inline" id="alg1.l7.m4.1"><semantics id="alg1.l7.m4.1a"><msub id="alg1.l7.m4.1.1" xref="alg1.l7.m4.1.1.cmml"><mi id="alg1.l7.m4.1.1.2" xref="alg1.l7.m4.1.1.2.cmml">i</mi><mn id="alg1.l7.m4.1.1.3" xref="alg1.l7.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l7.m4.1b"><apply id="alg1.l7.m4.1.1.cmml" xref="alg1.l7.m4.1.1"><csymbol cd="ambiguous" id="alg1.l7.m4.1.1.1.cmml" xref="alg1.l7.m4.1.1">subscript</csymbol><ci id="alg1.l7.m4.1.1.2.cmml" xref="alg1.l7.m4.1.1.2">𝑖</ci><cn id="alg1.l7.m4.1.1.3.cmml" type="integer" xref="alg1.l7.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m4.1c">i_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m4.1d">italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> from R

</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>     // Forward propagation

</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>     Obtain <math alttext="e_{u}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><msub id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">e</mi><mi id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑒</ci><ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">e_{u}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">italic_e start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="e_{i}" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><msub id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><mi id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml">e</mi><mi id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2">𝑒</ci><ci id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">e_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_e start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> via Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E3" title="In 2nd item ‣ IV-A External Embeddings ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">3</span></a>)

</div>
<div class="ltx_listingline" id="alg1.l10">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l10.1.1.1" style="font-size:80%;">10:</span></span>     Obtain Embedding <math alttext="E^{0}_{u}" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><msubsup id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">E</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">u</mi><mn id="alg1.l10.m1.1.1.2.3" xref="alg1.l10.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1">superscript</csymbol><ci id="alg1.l10.m1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.2.2">𝐸</ci><cn id="alg1.l10.m1.1.1.2.3.cmml" type="integer" xref="alg1.l10.m1.1.1.2.3">0</cn></apply><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">E^{0}_{u}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="E^{1}_{u}" class="ltx_Math" display="inline" id="alg1.l10.m2.1"><semantics id="alg1.l10.m2.1a"><msubsup id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><mi id="alg1.l10.m2.1.1.2.2" xref="alg1.l10.m2.1.1.2.2.cmml">E</mi><mi id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml">u</mi><mn id="alg1.l10.m2.1.1.2.3" xref="alg1.l10.m2.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1">subscript</csymbol><apply id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.2.1.cmml" xref="alg1.l10.m2.1.1">superscript</csymbol><ci id="alg1.l10.m2.1.1.2.2.cmml" xref="alg1.l10.m2.1.1.2.2">𝐸</ci><cn id="alg1.l10.m2.1.1.2.3.cmml" type="integer" xref="alg1.l10.m2.1.1.2.3">1</cn></apply><ci id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">E^{1}_{u}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.1d">italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="E^{2}_{u}" class="ltx_Math" display="inline" id="alg1.l10.m3.1"><semantics id="alg1.l10.m3.1a"><msubsup id="alg1.l10.m3.1.1" xref="alg1.l10.m3.1.1.cmml"><mi id="alg1.l10.m3.1.1.2.2" xref="alg1.l10.m3.1.1.2.2.cmml">E</mi><mi id="alg1.l10.m3.1.1.3" xref="alg1.l10.m3.1.1.3.cmml">u</mi><mn id="alg1.l10.m3.1.1.2.3" xref="alg1.l10.m3.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m3.1b"><apply id="alg1.l10.m3.1.1.cmml" xref="alg1.l10.m3.1.1"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.1.cmml" xref="alg1.l10.m3.1.1">subscript</csymbol><apply id="alg1.l10.m3.1.1.2.cmml" xref="alg1.l10.m3.1.1"><csymbol cd="ambiguous" id="alg1.l10.m3.1.1.2.1.cmml" xref="alg1.l10.m3.1.1">superscript</csymbol><ci id="alg1.l10.m3.1.1.2.2.cmml" xref="alg1.l10.m3.1.1.2.2">𝐸</ci><cn id="alg1.l10.m3.1.1.2.3.cmml" type="integer" xref="alg1.l10.m3.1.1.2.3">2</cn></apply><ci id="alg1.l10.m3.1.1.3.cmml" xref="alg1.l10.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m3.1c">E^{2}_{u}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m3.1d">italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="E^{0}_{i}" class="ltx_Math" display="inline" id="alg1.l10.m4.1"><semantics id="alg1.l10.m4.1a"><msubsup id="alg1.l10.m4.1.1" xref="alg1.l10.m4.1.1.cmml"><mi id="alg1.l10.m4.1.1.2.2" xref="alg1.l10.m4.1.1.2.2.cmml">E</mi><mi id="alg1.l10.m4.1.1.3" xref="alg1.l10.m4.1.1.3.cmml">i</mi><mn id="alg1.l10.m4.1.1.2.3" xref="alg1.l10.m4.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m4.1b"><apply id="alg1.l10.m4.1.1.cmml" xref="alg1.l10.m4.1.1"><csymbol cd="ambiguous" id="alg1.l10.m4.1.1.1.cmml" xref="alg1.l10.m4.1.1">subscript</csymbol><apply id="alg1.l10.m4.1.1.2.cmml" xref="alg1.l10.m4.1.1"><csymbol cd="ambiguous" id="alg1.l10.m4.1.1.2.1.cmml" xref="alg1.l10.m4.1.1">superscript</csymbol><ci id="alg1.l10.m4.1.1.2.2.cmml" xref="alg1.l10.m4.1.1.2.2">𝐸</ci><cn id="alg1.l10.m4.1.1.2.3.cmml" type="integer" xref="alg1.l10.m4.1.1.2.3">0</cn></apply><ci id="alg1.l10.m4.1.1.3.cmml" xref="alg1.l10.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m4.1c">E^{0}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m4.1d">italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="E^{1}_{i}" class="ltx_Math" display="inline" id="alg1.l10.m5.1"><semantics id="alg1.l10.m5.1a"><msubsup id="alg1.l10.m5.1.1" xref="alg1.l10.m5.1.1.cmml"><mi id="alg1.l10.m5.1.1.2.2" xref="alg1.l10.m5.1.1.2.2.cmml">E</mi><mi id="alg1.l10.m5.1.1.3" xref="alg1.l10.m5.1.1.3.cmml">i</mi><mn id="alg1.l10.m5.1.1.2.3" xref="alg1.l10.m5.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m5.1b"><apply id="alg1.l10.m5.1.1.cmml" xref="alg1.l10.m5.1.1"><csymbol cd="ambiguous" id="alg1.l10.m5.1.1.1.cmml" xref="alg1.l10.m5.1.1">subscript</csymbol><apply id="alg1.l10.m5.1.1.2.cmml" xref="alg1.l10.m5.1.1"><csymbol cd="ambiguous" id="alg1.l10.m5.1.1.2.1.cmml" xref="alg1.l10.m5.1.1">superscript</csymbol><ci id="alg1.l10.m5.1.1.2.2.cmml" xref="alg1.l10.m5.1.1.2.2">𝐸</ci><cn id="alg1.l10.m5.1.1.2.3.cmml" type="integer" xref="alg1.l10.m5.1.1.2.3">1</cn></apply><ci id="alg1.l10.m5.1.1.3.cmml" xref="alg1.l10.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m5.1c">E^{1}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m5.1d">italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="E^{2}_{i}" class="ltx_Math" display="inline" id="alg1.l10.m6.1"><semantics id="alg1.l10.m6.1a"><msubsup id="alg1.l10.m6.1.1" xref="alg1.l10.m6.1.1.cmml"><mi id="alg1.l10.m6.1.1.2.2" xref="alg1.l10.m6.1.1.2.2.cmml">E</mi><mi id="alg1.l10.m6.1.1.3" xref="alg1.l10.m6.1.1.3.cmml">i</mi><mn id="alg1.l10.m6.1.1.2.3" xref="alg1.l10.m6.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10.m6.1b"><apply id="alg1.l10.m6.1.1.cmml" xref="alg1.l10.m6.1.1"><csymbol cd="ambiguous" id="alg1.l10.m6.1.1.1.cmml" xref="alg1.l10.m6.1.1">subscript</csymbol><apply id="alg1.l10.m6.1.1.2.cmml" xref="alg1.l10.m6.1.1"><csymbol cd="ambiguous" id="alg1.l10.m6.1.1.2.1.cmml" xref="alg1.l10.m6.1.1">superscript</csymbol><ci id="alg1.l10.m6.1.1.2.2.cmml" xref="alg1.l10.m6.1.1.2.2">𝐸</ci><cn id="alg1.l10.m6.1.1.2.3.cmml" type="integer" xref="alg1.l10.m6.1.1.2.3">2</cn></apply><ci id="alg1.l10.m6.1.1.3.cmml" xref="alg1.l10.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m6.1c">E^{2}_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m6.1d">italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> using LLM-Encoder

</div>
<div class="ltx_listingline" id="alg1.l11">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l11.1.1.1" style="font-size:80%;">11:</span></span>     // Calculate Loss

</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l12.1.1.1" style="font-size:80%;">12:</span></span>     Calculate <math alttext="\mathcal{L}_{1}" class="ltx_Math" display="inline" id="alg1.l12.m1.1"><semantics id="alg1.l12.m1.1a"><msub id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">ℒ</mi><mn id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">ℒ</ci><cn id="alg1.l12.m1.1.1.3.cmml" type="integer" xref="alg1.l12.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">\mathcal{L}_{1}</annotation><annotation encoding="application/x-llamapun" id="alg1.l12.m1.1d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> via Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E5" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">5</span></a>) (<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E6" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">6</span></a>)
(<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E7" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">7</span></a>)

</div>
<div class="ltx_listingline" id="alg1.l13">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l13.1.1.1" style="font-size:80%;">13:</span></span>     Calculate <math alttext="\mathcal{L}_{2}" class="ltx_Math" display="inline" id="alg1.l13.m1.1"><semantics id="alg1.l13.m1.1a"><msub id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml">ℒ</mi><mn id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1">subscript</csymbol><ci id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2">ℒ</ci><cn id="alg1.l13.m1.1.1.3.cmml" type="integer" xref="alg1.l13.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\mathcal{L}_{2}</annotation><annotation encoding="application/x-llamapun" id="alg1.l13.m1.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> via Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E8" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">8</span></a>) (<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E9" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">9</span></a>)
(<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E10" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">10</span></a>)

</div>
<div class="ltx_listingline" id="alg1.l14">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l14.1.1.1" style="font-size:80%;">14:</span></span>     Calculate <math alttext="\mathcal{L}_{3}" class="ltx_Math" display="inline" id="alg1.l14.m1.1"><semantics id="alg1.l14.m1.1a"><msub id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">ℒ</mi><mn id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1">subscript</csymbol><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">ℒ</ci><cn id="alg1.l14.m1.1.1.3.cmml" type="integer" xref="alg1.l14.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">\mathcal{L}_{3}</annotation><annotation encoding="application/x-llamapun" id="alg1.l14.m1.1d">caligraphic_L start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> via Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E11" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">11</span></a>) (<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E12" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">12</span></a>) (<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E13" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">13</span></a>)

</div>
<div class="ltx_listingline" id="alg1.l15">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l15.1.1.1" style="font-size:80%;">15:</span></span>     Calculate Cross Entropy loss <math alttext="\mathcal{L}_{0}" class="ltx_Math" display="inline" id="alg1.l15.m1.1"><semantics id="alg1.l15.m1.1a"><msub id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">ℒ</mi><mn id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">ℒ</ci><cn id="alg1.l15.m1.1.1.3.cmml" type="integer" xref="alg1.l15.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\mathcal{L}_{0}</annotation><annotation encoding="application/x-llamapun" id="alg1.l15.m1.1d">caligraphic_L start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> via Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S3.E1" title="In III-B Instruction Tuning ‣ III PRELIMINARY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">1</span></a>)

</div>
<div class="ltx_listingline" id="alg1.l16">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l16.1.1.1" style="font-size:80%;">16:</span></span>     Calculate finial loss <math alttext="\mathcal{L}_{GAL}" class="ltx_Math" display="inline" id="alg1.l16.m1.1"><semantics id="alg1.l16.m1.1a"><msub id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">ℒ</mi><mrow id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mi id="alg1.l16.m1.1.1.3.2" xref="alg1.l16.m1.1.1.3.2.cmml">G</mi><mo id="alg1.l16.m1.1.1.3.1" xref="alg1.l16.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml">A</mi><mo id="alg1.l16.m1.1.1.3.1a" xref="alg1.l16.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l16.m1.1.1.3.4" xref="alg1.l16.m1.1.1.3.4.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">ℒ</ci><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><times id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3.1"></times><ci id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3.2">𝐺</ci><ci id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3">𝐴</ci><ci id="alg1.l16.m1.1.1.3.4.cmml" xref="alg1.l16.m1.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">\mathcal{L}_{GAL}</annotation><annotation encoding="application/x-llamapun" id="alg1.l16.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_G italic_A italic_L end_POSTSUBSCRIPT</annotation></semantics></math> via Eq.(<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E13" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">13</span></a>)

</div>
<div class="ltx_listingline" id="alg1.l17">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l17.1.1.1" style="font-size:80%;">17:</span></span>     // Back propagation

</div>
<div class="ltx_listingline" id="alg1.l18">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l18.1.1.1" style="font-size:80%;">18:</span></span>     Update <math alttext="\Theta_{llm}\leftarrow\Theta_{llm}-\alpha\cdot\frac{\partial L_{GAL}}{\partial%
\Theta_{llm}}" class="ltx_Math" display="inline" id="alg1.l18.m1.1"><semantics id="alg1.l18.m1.1a"><mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><msub id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml"><mi id="alg1.l18.m1.1.1.2.2" mathvariant="normal" xref="alg1.l18.m1.1.1.2.2.cmml">Θ</mi><mrow id="alg1.l18.m1.1.1.2.3" xref="alg1.l18.m1.1.1.2.3.cmml"><mi id="alg1.l18.m1.1.1.2.3.2" xref="alg1.l18.m1.1.1.2.3.2.cmml">l</mi><mo id="alg1.l18.m1.1.1.2.3.1" xref="alg1.l18.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.2.3.3" xref="alg1.l18.m1.1.1.2.3.3.cmml">l</mi><mo id="alg1.l18.m1.1.1.2.3.1a" xref="alg1.l18.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.2.3.4" xref="alg1.l18.m1.1.1.2.3.4.cmml">m</mi></mrow></msub><mo id="alg1.l18.m1.1.1.1" stretchy="false" xref="alg1.l18.m1.1.1.1.cmml">←</mo><mrow id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml"><msub id="alg1.l18.m1.1.1.3.2" xref="alg1.l18.m1.1.1.3.2.cmml"><mi id="alg1.l18.m1.1.1.3.2.2" mathvariant="normal" xref="alg1.l18.m1.1.1.3.2.2.cmml">Θ</mi><mrow id="alg1.l18.m1.1.1.3.2.3" xref="alg1.l18.m1.1.1.3.2.3.cmml"><mi id="alg1.l18.m1.1.1.3.2.3.2" xref="alg1.l18.m1.1.1.3.2.3.2.cmml">l</mi><mo id="alg1.l18.m1.1.1.3.2.3.1" xref="alg1.l18.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.2.3.3" xref="alg1.l18.m1.1.1.3.2.3.3.cmml">l</mi><mo id="alg1.l18.m1.1.1.3.2.3.1a" xref="alg1.l18.m1.1.1.3.2.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.2.3.4" xref="alg1.l18.m1.1.1.3.2.3.4.cmml">m</mi></mrow></msub><mo id="alg1.l18.m1.1.1.3.1" xref="alg1.l18.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l18.m1.1.1.3.3" xref="alg1.l18.m1.1.1.3.3.cmml"><mi id="alg1.l18.m1.1.1.3.3.2" xref="alg1.l18.m1.1.1.3.3.2.cmml">α</mi><mo id="alg1.l18.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg1.l18.m1.1.1.3.3.1.cmml">⋅</mo><mfrac id="alg1.l18.m1.1.1.3.3.3" xref="alg1.l18.m1.1.1.3.3.3.cmml"><mrow id="alg1.l18.m1.1.1.3.3.3.2" xref="alg1.l18.m1.1.1.3.3.3.2.cmml"><mo id="alg1.l18.m1.1.1.3.3.3.2.1" rspace="0em" xref="alg1.l18.m1.1.1.3.3.3.2.1.cmml">∂</mo><msub id="alg1.l18.m1.1.1.3.3.3.2.2" xref="alg1.l18.m1.1.1.3.3.3.2.2.cmml"><mi id="alg1.l18.m1.1.1.3.3.3.2.2.2" xref="alg1.l18.m1.1.1.3.3.3.2.2.2.cmml">L</mi><mrow id="alg1.l18.m1.1.1.3.3.3.2.2.3" xref="alg1.l18.m1.1.1.3.3.3.2.2.3.cmml"><mi id="alg1.l18.m1.1.1.3.3.3.2.2.3.2" xref="alg1.l18.m1.1.1.3.3.3.2.2.3.2.cmml">G</mi><mo id="alg1.l18.m1.1.1.3.3.3.2.2.3.1" xref="alg1.l18.m1.1.1.3.3.3.2.2.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.3.3.2.2.3.3" xref="alg1.l18.m1.1.1.3.3.3.2.2.3.3.cmml">A</mi><mo id="alg1.l18.m1.1.1.3.3.3.2.2.3.1a" xref="alg1.l18.m1.1.1.3.3.3.2.2.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.3.3.2.2.3.4" xref="alg1.l18.m1.1.1.3.3.3.2.2.3.4.cmml">L</mi></mrow></msub></mrow><mrow id="alg1.l18.m1.1.1.3.3.3.3" xref="alg1.l18.m1.1.1.3.3.3.3.cmml"><mo id="alg1.l18.m1.1.1.3.3.3.3.1" rspace="0em" xref="alg1.l18.m1.1.1.3.3.3.3.1.cmml">∂</mo><msub id="alg1.l18.m1.1.1.3.3.3.3.2" xref="alg1.l18.m1.1.1.3.3.3.3.2.cmml"><mi id="alg1.l18.m1.1.1.3.3.3.3.2.2" mathvariant="normal" xref="alg1.l18.m1.1.1.3.3.3.3.2.2.cmml">Θ</mi><mrow id="alg1.l18.m1.1.1.3.3.3.3.2.3" xref="alg1.l18.m1.1.1.3.3.3.3.2.3.cmml"><mi id="alg1.l18.m1.1.1.3.3.3.3.2.3.2" xref="alg1.l18.m1.1.1.3.3.3.3.2.3.2.cmml">l</mi><mo id="alg1.l18.m1.1.1.3.3.3.3.2.3.1" xref="alg1.l18.m1.1.1.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.3.3.3.2.3.3" xref="alg1.l18.m1.1.1.3.3.3.3.2.3.3.cmml">l</mi><mo id="alg1.l18.m1.1.1.3.3.3.3.2.3.1a" xref="alg1.l18.m1.1.1.3.3.3.3.2.3.1.cmml">⁢</mo><mi id="alg1.l18.m1.1.1.3.3.3.3.2.3.4" xref="alg1.l18.m1.1.1.3.3.3.3.2.3.4.cmml">m</mi></mrow></msub></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><ci id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1">←</ci><apply id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.2.2">Θ</ci><apply id="alg1.l18.m1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.2.3"><times id="alg1.l18.m1.1.1.2.3.1.cmml" xref="alg1.l18.m1.1.1.2.3.1"></times><ci id="alg1.l18.m1.1.1.2.3.2.cmml" xref="alg1.l18.m1.1.1.2.3.2">𝑙</ci><ci id="alg1.l18.m1.1.1.2.3.3.cmml" xref="alg1.l18.m1.1.1.2.3.3">𝑙</ci><ci id="alg1.l18.m1.1.1.2.3.4.cmml" xref="alg1.l18.m1.1.1.2.3.4">𝑚</ci></apply></apply><apply id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3"><minus id="alg1.l18.m1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.3.1"></minus><apply id="alg1.l18.m1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.3.2.1.cmml" xref="alg1.l18.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.3.2.2.cmml" xref="alg1.l18.m1.1.1.3.2.2">Θ</ci><apply id="alg1.l18.m1.1.1.3.2.3.cmml" xref="alg1.l18.m1.1.1.3.2.3"><times id="alg1.l18.m1.1.1.3.2.3.1.cmml" xref="alg1.l18.m1.1.1.3.2.3.1"></times><ci id="alg1.l18.m1.1.1.3.2.3.2.cmml" xref="alg1.l18.m1.1.1.3.2.3.2">𝑙</ci><ci id="alg1.l18.m1.1.1.3.2.3.3.cmml" xref="alg1.l18.m1.1.1.3.2.3.3">𝑙</ci><ci id="alg1.l18.m1.1.1.3.2.3.4.cmml" xref="alg1.l18.m1.1.1.3.2.3.4">𝑚</ci></apply></apply><apply id="alg1.l18.m1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.3.3"><ci id="alg1.l18.m1.1.1.3.3.1.cmml" xref="alg1.l18.m1.1.1.3.3.1">⋅</ci><ci id="alg1.l18.m1.1.1.3.3.2.cmml" xref="alg1.l18.m1.1.1.3.3.2">𝛼</ci><apply id="alg1.l18.m1.1.1.3.3.3.cmml" xref="alg1.l18.m1.1.1.3.3.3"><divide id="alg1.l18.m1.1.1.3.3.3.1.cmml" xref="alg1.l18.m1.1.1.3.3.3"></divide><apply id="alg1.l18.m1.1.1.3.3.3.2.cmml" xref="alg1.l18.m1.1.1.3.3.3.2"><partialdiff id="alg1.l18.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l18.m1.1.1.3.3.3.2.1"></partialdiff><apply id="alg1.l18.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l18.m1.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.3.3.3.2.2.1.cmml" xref="alg1.l18.m1.1.1.3.3.3.2.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.3.3.3.2.2.2.cmml" xref="alg1.l18.m1.1.1.3.3.3.2.2.2">𝐿</ci><apply id="alg1.l18.m1.1.1.3.3.3.2.2.3.cmml" xref="alg1.l18.m1.1.1.3.3.3.2.2.3"><times id="alg1.l18.m1.1.1.3.3.3.2.2.3.1.cmml" xref="alg1.l18.m1.1.1.3.3.3.2.2.3.1"></times><ci id="alg1.l18.m1.1.1.3.3.3.2.2.3.2.cmml" xref="alg1.l18.m1.1.1.3.3.3.2.2.3.2">𝐺</ci><ci id="alg1.l18.m1.1.1.3.3.3.2.2.3.3.cmml" xref="alg1.l18.m1.1.1.3.3.3.2.2.3.3">𝐴</ci><ci id="alg1.l18.m1.1.1.3.3.3.2.2.3.4.cmml" xref="alg1.l18.m1.1.1.3.3.3.2.2.3.4">𝐿</ci></apply></apply></apply><apply id="alg1.l18.m1.1.1.3.3.3.3.cmml" xref="alg1.l18.m1.1.1.3.3.3.3"><partialdiff id="alg1.l18.m1.1.1.3.3.3.3.1.cmml" xref="alg1.l18.m1.1.1.3.3.3.3.1"></partialdiff><apply id="alg1.l18.m1.1.1.3.3.3.3.2.cmml" xref="alg1.l18.m1.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.3.3.3.3.2.1.cmml" xref="alg1.l18.m1.1.1.3.3.3.3.2">subscript</csymbol><ci id="alg1.l18.m1.1.1.3.3.3.3.2.2.cmml" xref="alg1.l18.m1.1.1.3.3.3.3.2.2">Θ</ci><apply id="alg1.l18.m1.1.1.3.3.3.3.2.3.cmml" xref="alg1.l18.m1.1.1.3.3.3.3.2.3"><times id="alg1.l18.m1.1.1.3.3.3.3.2.3.1.cmml" xref="alg1.l18.m1.1.1.3.3.3.3.2.3.1"></times><ci id="alg1.l18.m1.1.1.3.3.3.3.2.3.2.cmml" xref="alg1.l18.m1.1.1.3.3.3.3.2.3.2">𝑙</ci><ci id="alg1.l18.m1.1.1.3.3.3.3.2.3.3.cmml" xref="alg1.l18.m1.1.1.3.3.3.3.2.3.3">𝑙</ci><ci id="alg1.l18.m1.1.1.3.3.3.3.2.3.4.cmml" xref="alg1.l18.m1.1.1.3.3.3.3.2.3.4">𝑚</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">\Theta_{llm}\leftarrow\Theta_{llm}-\alpha\cdot\frac{\partial L_{GAL}}{\partial%
\Theta_{llm}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l18.m1.1d">roman_Θ start_POSTSUBSCRIPT italic_l italic_l italic_m end_POSTSUBSCRIPT ← roman_Θ start_POSTSUBSCRIPT italic_l italic_l italic_m end_POSTSUBSCRIPT - italic_α ⋅ divide start_ARG ∂ italic_L start_POSTSUBSCRIPT italic_G italic_A italic_L end_POSTSUBSCRIPT end_ARG start_ARG ∂ roman_Θ start_POSTSUBSCRIPT italic_l italic_l italic_m end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l19">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l19.1.1.1" style="font-size:80%;">19:</span></span>     Update <math alttext="\Theta_{g}\leftarrow\Theta_{g}-\alpha\cdot\frac{\partial L_{GAL}}{\partial%
\Theta_{g}}" class="ltx_Math" display="inline" id="alg1.l19.m1.1"><semantics id="alg1.l19.m1.1a"><mrow id="alg1.l19.m1.1.1" xref="alg1.l19.m1.1.1.cmml"><msub id="alg1.l19.m1.1.1.2" xref="alg1.l19.m1.1.1.2.cmml"><mi id="alg1.l19.m1.1.1.2.2" mathvariant="normal" xref="alg1.l19.m1.1.1.2.2.cmml">Θ</mi><mi id="alg1.l19.m1.1.1.2.3" xref="alg1.l19.m1.1.1.2.3.cmml">g</mi></msub><mo id="alg1.l19.m1.1.1.1" stretchy="false" xref="alg1.l19.m1.1.1.1.cmml">←</mo><mrow id="alg1.l19.m1.1.1.3" xref="alg1.l19.m1.1.1.3.cmml"><msub id="alg1.l19.m1.1.1.3.2" xref="alg1.l19.m1.1.1.3.2.cmml"><mi id="alg1.l19.m1.1.1.3.2.2" mathvariant="normal" xref="alg1.l19.m1.1.1.3.2.2.cmml">Θ</mi><mi id="alg1.l19.m1.1.1.3.2.3" xref="alg1.l19.m1.1.1.3.2.3.cmml">g</mi></msub><mo id="alg1.l19.m1.1.1.3.1" xref="alg1.l19.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l19.m1.1.1.3.3" xref="alg1.l19.m1.1.1.3.3.cmml"><mi id="alg1.l19.m1.1.1.3.3.2" xref="alg1.l19.m1.1.1.3.3.2.cmml">α</mi><mo id="alg1.l19.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="alg1.l19.m1.1.1.3.3.1.cmml">⋅</mo><mfrac id="alg1.l19.m1.1.1.3.3.3" xref="alg1.l19.m1.1.1.3.3.3.cmml"><mrow id="alg1.l19.m1.1.1.3.3.3.2" xref="alg1.l19.m1.1.1.3.3.3.2.cmml"><mo id="alg1.l19.m1.1.1.3.3.3.2.1" rspace="0em" xref="alg1.l19.m1.1.1.3.3.3.2.1.cmml">∂</mo><msub id="alg1.l19.m1.1.1.3.3.3.2.2" xref="alg1.l19.m1.1.1.3.3.3.2.2.cmml"><mi id="alg1.l19.m1.1.1.3.3.3.2.2.2" xref="alg1.l19.m1.1.1.3.3.3.2.2.2.cmml">L</mi><mrow id="alg1.l19.m1.1.1.3.3.3.2.2.3" xref="alg1.l19.m1.1.1.3.3.3.2.2.3.cmml"><mi id="alg1.l19.m1.1.1.3.3.3.2.2.3.2" xref="alg1.l19.m1.1.1.3.3.3.2.2.3.2.cmml">G</mi><mo id="alg1.l19.m1.1.1.3.3.3.2.2.3.1" xref="alg1.l19.m1.1.1.3.3.3.2.2.3.1.cmml">⁢</mo><mi id="alg1.l19.m1.1.1.3.3.3.2.2.3.3" xref="alg1.l19.m1.1.1.3.3.3.2.2.3.3.cmml">A</mi><mo id="alg1.l19.m1.1.1.3.3.3.2.2.3.1a" xref="alg1.l19.m1.1.1.3.3.3.2.2.3.1.cmml">⁢</mo><mi id="alg1.l19.m1.1.1.3.3.3.2.2.3.4" xref="alg1.l19.m1.1.1.3.3.3.2.2.3.4.cmml">L</mi></mrow></msub></mrow><mrow id="alg1.l19.m1.1.1.3.3.3.3" xref="alg1.l19.m1.1.1.3.3.3.3.cmml"><mo id="alg1.l19.m1.1.1.3.3.3.3.1" rspace="0em" xref="alg1.l19.m1.1.1.3.3.3.3.1.cmml">∂</mo><msub id="alg1.l19.m1.1.1.3.3.3.3.2" xref="alg1.l19.m1.1.1.3.3.3.3.2.cmml"><mi id="alg1.l19.m1.1.1.3.3.3.3.2.2" mathvariant="normal" xref="alg1.l19.m1.1.1.3.3.3.3.2.2.cmml">Θ</mi><mi id="alg1.l19.m1.1.1.3.3.3.3.2.3" xref="alg1.l19.m1.1.1.3.3.3.3.2.3.cmml">g</mi></msub></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.1b"><apply id="alg1.l19.m1.1.1.cmml" xref="alg1.l19.m1.1.1"><ci id="alg1.l19.m1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1">←</ci><apply id="alg1.l19.m1.1.1.2.cmml" xref="alg1.l19.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.2.1.cmml" xref="alg1.l19.m1.1.1.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.2.2.cmml" xref="alg1.l19.m1.1.1.2.2">Θ</ci><ci id="alg1.l19.m1.1.1.2.3.cmml" xref="alg1.l19.m1.1.1.2.3">𝑔</ci></apply><apply id="alg1.l19.m1.1.1.3.cmml" xref="alg1.l19.m1.1.1.3"><minus id="alg1.l19.m1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.3.1"></minus><apply id="alg1.l19.m1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.3.2.1.cmml" xref="alg1.l19.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.3.2.2.cmml" xref="alg1.l19.m1.1.1.3.2.2">Θ</ci><ci id="alg1.l19.m1.1.1.3.2.3.cmml" xref="alg1.l19.m1.1.1.3.2.3">𝑔</ci></apply><apply id="alg1.l19.m1.1.1.3.3.cmml" xref="alg1.l19.m1.1.1.3.3"><ci id="alg1.l19.m1.1.1.3.3.1.cmml" xref="alg1.l19.m1.1.1.3.3.1">⋅</ci><ci id="alg1.l19.m1.1.1.3.3.2.cmml" xref="alg1.l19.m1.1.1.3.3.2">𝛼</ci><apply id="alg1.l19.m1.1.1.3.3.3.cmml" xref="alg1.l19.m1.1.1.3.3.3"><divide id="alg1.l19.m1.1.1.3.3.3.1.cmml" xref="alg1.l19.m1.1.1.3.3.3"></divide><apply id="alg1.l19.m1.1.1.3.3.3.2.cmml" xref="alg1.l19.m1.1.1.3.3.3.2"><partialdiff id="alg1.l19.m1.1.1.3.3.3.2.1.cmml" xref="alg1.l19.m1.1.1.3.3.3.2.1"></partialdiff><apply id="alg1.l19.m1.1.1.3.3.3.2.2.cmml" xref="alg1.l19.m1.1.1.3.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.3.3.3.2.2.1.cmml" xref="alg1.l19.m1.1.1.3.3.3.2.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.3.3.3.2.2.2.cmml" xref="alg1.l19.m1.1.1.3.3.3.2.2.2">𝐿</ci><apply id="alg1.l19.m1.1.1.3.3.3.2.2.3.cmml" xref="alg1.l19.m1.1.1.3.3.3.2.2.3"><times id="alg1.l19.m1.1.1.3.3.3.2.2.3.1.cmml" xref="alg1.l19.m1.1.1.3.3.3.2.2.3.1"></times><ci id="alg1.l19.m1.1.1.3.3.3.2.2.3.2.cmml" xref="alg1.l19.m1.1.1.3.3.3.2.2.3.2">𝐺</ci><ci id="alg1.l19.m1.1.1.3.3.3.2.2.3.3.cmml" xref="alg1.l19.m1.1.1.3.3.3.2.2.3.3">𝐴</ci><ci id="alg1.l19.m1.1.1.3.3.3.2.2.3.4.cmml" xref="alg1.l19.m1.1.1.3.3.3.2.2.3.4">𝐿</ci></apply></apply></apply><apply id="alg1.l19.m1.1.1.3.3.3.3.cmml" xref="alg1.l19.m1.1.1.3.3.3.3"><partialdiff id="alg1.l19.m1.1.1.3.3.3.3.1.cmml" xref="alg1.l19.m1.1.1.3.3.3.3.1"></partialdiff><apply id="alg1.l19.m1.1.1.3.3.3.3.2.cmml" xref="alg1.l19.m1.1.1.3.3.3.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.3.3.3.3.2.1.cmml" xref="alg1.l19.m1.1.1.3.3.3.3.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.3.3.3.3.2.2.cmml" xref="alg1.l19.m1.1.1.3.3.3.3.2.2">Θ</ci><ci id="alg1.l19.m1.1.1.3.3.3.3.2.3.cmml" xref="alg1.l19.m1.1.1.3.3.3.3.2.3">𝑔</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.1c">\Theta_{g}\leftarrow\Theta_{g}-\alpha\cdot\frac{\partial L_{GAL}}{\partial%
\Theta_{g}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l19.m1.1d">roman_Θ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ← roman_Θ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT - italic_α ⋅ divide start_ARG ∂ italic_L start_POSTSUBSCRIPT italic_G italic_A italic_L end_POSTSUBSCRIPT end_ARG start_ARG ∂ roman_Θ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT end_ARG</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l20">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l20.1.1.1" style="font-size:80%;">20:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l20.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l20.3">while</span>
</div>
<div class="ltx_listingline" id="alg1.l21">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l21.1.1.1" style="font-size:80%;">21:</span></span><span class="ltx_text ltx_font_bold" id="alg1.l21.2">return</span> <math alttext="\theta_{g}" class="ltx_Math" display="inline" id="alg1.l21.m1.1"><semantics id="alg1.l21.m1.1a"><msub id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><mi id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml">θ</mi><mi id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1">subscript</csymbol><ci id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2">𝜃</ci><ci id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">\theta_{g}</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m1.1d">italic_θ start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT</annotation></semantics></math> ,<math alttext="\theta_{llm}" class="ltx_Math" display="inline" id="alg1.l21.m2.1"><semantics id="alg1.l21.m2.1a"><msub id="alg1.l21.m2.1.1" xref="alg1.l21.m2.1.1.cmml"><mi id="alg1.l21.m2.1.1.2" xref="alg1.l21.m2.1.1.2.cmml">θ</mi><mrow id="alg1.l21.m2.1.1.3" xref="alg1.l21.m2.1.1.3.cmml"><mi id="alg1.l21.m2.1.1.3.2" xref="alg1.l21.m2.1.1.3.2.cmml">l</mi><mo id="alg1.l21.m2.1.1.3.1" xref="alg1.l21.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l21.m2.1.1.3.3" xref="alg1.l21.m2.1.1.3.3.cmml">l</mi><mo id="alg1.l21.m2.1.1.3.1a" xref="alg1.l21.m2.1.1.3.1.cmml">⁢</mo><mi id="alg1.l21.m2.1.1.3.4" xref="alg1.l21.m2.1.1.3.4.cmml">m</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l21.m2.1b"><apply id="alg1.l21.m2.1.1.cmml" xref="alg1.l21.m2.1.1"><csymbol cd="ambiguous" id="alg1.l21.m2.1.1.1.cmml" xref="alg1.l21.m2.1.1">subscript</csymbol><ci id="alg1.l21.m2.1.1.2.cmml" xref="alg1.l21.m2.1.1.2">𝜃</ci><apply id="alg1.l21.m2.1.1.3.cmml" xref="alg1.l21.m2.1.1.3"><times id="alg1.l21.m2.1.1.3.1.cmml" xref="alg1.l21.m2.1.1.3.1"></times><ci id="alg1.l21.m2.1.1.3.2.cmml" xref="alg1.l21.m2.1.1.3.2">𝑙</ci><ci id="alg1.l21.m2.1.1.3.3.cmml" xref="alg1.l21.m2.1.1.3.3">𝑙</ci><ci id="alg1.l21.m2.1.1.3.4.cmml" xref="alg1.l21.m2.1.1.3.4">𝑚</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m2.1c">\theta_{llm}</annotation><annotation encoding="application/x-llamapun" id="alg1.l21.m2.1d">italic_θ start_POSTSUBSCRIPT italic_l italic_l italic_m end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
</div>
</figure>
<div class="ltx_para ltx_noindent" id="S4.SS3.p8">
<p class="ltx_p" id="S4.SS3.p8.1"><span class="ltx_text ltx_font_italic" id="S4.SS3.p8.1.1">2). Aligning user-2-hop with item-1-hop. </span> In this scenario, both the second-order neighbors of a user and the first-order neighbors of adjacent items are categorized as homogeneous nodes, implying they share similar attributes or categories. During the aggregation process in GNN, these nodes are interconnected during aggregation, forming a dependency structure that spans over greater distances. Specifically, the second-order aggregated information for a user summarizes the features of these similar users, while the first-order aggregation of the neighboring items indirectly mirrors the preferences of like-minded users. Hence, at the semantic level of a recommendation system, these aggregated representations should exhibit high similarity and consistency. Specifically, within the encoder module of a LLM, this is manifested as:</p>
</div>
<div class="ltx_para" id="S4.SS3.p9">
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathcal{L}^{u}_{2}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{2}_{u},E^{%
1}_{i}\Big{)}/\tau\Big{)}}{\sum_{v\in\mathcal{U}}\exp\Big{(}\text{sim}\Big{(}E%
^{2}_{v},E^{1}_{i}\Big{)}/\tau\Big{)}}," class="ltx_Math" display="block" id="S4.E8.m1.5"><semantics id="S4.E8.m1.5a"><mrow id="S4.E8.m1.5.5.1" xref="S4.E8.m1.5.5.1.1.cmml"><mrow id="S4.E8.m1.5.5.1.1" xref="S4.E8.m1.5.5.1.1.cmml"><msubsup id="S4.E8.m1.5.5.1.1.2" xref="S4.E8.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.5.5.1.1.2.2.2" mathsize="90%" xref="S4.E8.m1.5.5.1.1.2.2.2.cmml">ℒ</mi><mn id="S4.E8.m1.5.5.1.1.2.3" mathsize="90%" xref="S4.E8.m1.5.5.1.1.2.3.cmml">2</mn><mi id="S4.E8.m1.5.5.1.1.2.2.3" mathsize="90%" xref="S4.E8.m1.5.5.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S4.E8.m1.5.5.1.1.1" mathsize="90%" xref="S4.E8.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E8.m1.5.5.1.1.3" xref="S4.E8.m1.5.5.1.1.3.cmml"><mo id="S4.E8.m1.5.5.1.1.3a" mathsize="90%" rspace="0.167em" xref="S4.E8.m1.5.5.1.1.3.cmml">−</mo><mrow id="S4.E8.m1.5.5.1.1.3.2" xref="S4.E8.m1.5.5.1.1.3.2.cmml"><mi id="S4.E8.m1.5.5.1.1.3.2.1" mathsize="90%" xref="S4.E8.m1.5.5.1.1.3.2.1.cmml">log</mi><mo id="S4.E8.m1.5.5.1.1.3.2a" lspace="0.167em" xref="S4.E8.m1.5.5.1.1.3.2.cmml">⁡</mo><mfrac id="S4.E8.m1.4.4" xref="S4.E8.m1.4.4.cmml"><mrow id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.3.cmml"><mi id="S4.E8.m1.1.1.1.1" mathsize="90%" xref="S4.E8.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E8.m1.2.2.2.2a" xref="S4.E8.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E8.m1.2.2.2.2.1" xref="S4.E8.m1.2.2.2.3.cmml"><mo id="S4.E8.m1.2.2.2.2.1.2" maxsize="160%" minsize="160%" xref="S4.E8.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E8.m1.2.2.2.2.1.1" xref="S4.E8.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E8.m1.2.2.2.2.1.1.2" xref="S4.E8.m1.2.2.2.2.1.1.2.cmml"><mtext id="S4.E8.m1.2.2.2.2.1.1.2.4" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo id="S4.E8.m1.2.2.2.2.1.1.2.3" xref="S4.E8.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E8.m1.2.2.2.2.1.1.2.2.2" xref="S4.E8.m1.2.2.2.2.1.1.2.2.3.cmml"><mo id="S4.E8.m1.2.2.2.2.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E8.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">u</mi><mn id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">2</mn></msubsup><mo id="S4.E8.m1.2.2.2.2.1.1.2.2.2.4" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">i</mi><mn id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S4.E8.m1.2.2.2.2.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E8.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.2.2.2.2.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E8.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S4.E8.m1.2.2.2.2.1.1.4" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo id="S4.E8.m1.2.2.2.2.1.3" maxsize="160%" minsize="160%" xref="S4.E8.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E8.m1.4.4.4" xref="S4.E8.m1.4.4.4.cmml"><msub id="S4.E8.m1.4.4.4.3" xref="S4.E8.m1.4.4.4.3.cmml"><mo id="S4.E8.m1.4.4.4.3.2" maxsize="90%" minsize="90%" stretchy="true" xref="S4.E8.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S4.E8.m1.4.4.4.3.3" xref="S4.E8.m1.4.4.4.3.3.cmml"><mi id="S4.E8.m1.4.4.4.3.3.2" mathsize="90%" xref="S4.E8.m1.4.4.4.3.3.2.cmml">v</mi><mo id="S4.E8.m1.4.4.4.3.3.1" mathsize="90%" xref="S4.E8.m1.4.4.4.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.4.4.4.3.3.3" mathsize="90%" xref="S4.E8.m1.4.4.4.3.3.3.cmml">𝒰</mi></mrow></msub><mrow id="S4.E8.m1.4.4.4.2.1" xref="S4.E8.m1.4.4.4.2.2.cmml"><mi id="S4.E8.m1.3.3.3.1" mathsize="90%" xref="S4.E8.m1.3.3.3.1.cmml">exp</mi><mo id="S4.E8.m1.4.4.4.2.1a" xref="S4.E8.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.E8.m1.4.4.4.2.1.1" xref="S4.E8.m1.4.4.4.2.2.cmml"><mo id="S4.E8.m1.4.4.4.2.1.1.2" maxsize="160%" minsize="160%" xref="S4.E8.m1.4.4.4.2.2.cmml">(</mo><mrow id="S4.E8.m1.4.4.4.2.1.1.1" xref="S4.E8.m1.4.4.4.2.1.1.1.cmml"><mrow id="S4.E8.m1.4.4.4.2.1.1.1.2" xref="S4.E8.m1.4.4.4.2.1.1.1.2.cmml"><mtext id="S4.E8.m1.4.4.4.2.1.1.1.2.4" mathsize="90%" xref="S4.E8.m1.4.4.4.2.1.1.1.2.4a.cmml">sim</mtext><mo id="S4.E8.m1.4.4.4.2.1.1.1.2.3" xref="S4.E8.m1.4.4.4.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.3.cmml"><mo id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml">v</mi><mn id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml">2</mn></msubsup><mo id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.4" mathsize="90%" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mi id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml">i</mi><mn id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.4.4.4.2.1.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E8.m1.4.4.4.2.1.1.1.3.cmml">/</mo><mi id="S4.E8.m1.4.4.4.2.1.1.1.4" mathsize="90%" xref="S4.E8.m1.4.4.4.2.1.1.1.4.cmml">τ</mi></mrow><mo id="S4.E8.m1.4.4.4.2.1.1.3" maxsize="160%" minsize="160%" xref="S4.E8.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E8.m1.5.5.1.2" mathsize="90%" xref="S4.E8.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.5b"><apply id="S4.E8.m1.5.5.1.1.cmml" xref="S4.E8.m1.5.5.1"><eq id="S4.E8.m1.5.5.1.1.1.cmml" xref="S4.E8.m1.5.5.1.1.1"></eq><apply id="S4.E8.m1.5.5.1.1.2.cmml" xref="S4.E8.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.1.cmml" xref="S4.E8.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E8.m1.5.5.1.1.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E8.m1.5.5.1.1.2.2.1.cmml" xref="S4.E8.m1.5.5.1.1.2">superscript</csymbol><ci id="S4.E8.m1.5.5.1.1.2.2.2.cmml" xref="S4.E8.m1.5.5.1.1.2.2.2">ℒ</ci><ci id="S4.E8.m1.5.5.1.1.2.2.3.cmml" xref="S4.E8.m1.5.5.1.1.2.2.3">𝑢</ci></apply><cn id="S4.E8.m1.5.5.1.1.2.3.cmml" type="integer" xref="S4.E8.m1.5.5.1.1.2.3">2</cn></apply><apply id="S4.E8.m1.5.5.1.1.3.cmml" xref="S4.E8.m1.5.5.1.1.3"><minus id="S4.E8.m1.5.5.1.1.3.1.cmml" xref="S4.E8.m1.5.5.1.1.3"></minus><apply id="S4.E8.m1.5.5.1.1.3.2.cmml" xref="S4.E8.m1.5.5.1.1.3.2"><log id="S4.E8.m1.5.5.1.1.3.2.1.cmml" xref="S4.E8.m1.5.5.1.1.3.2.1"></log><apply id="S4.E8.m1.4.4.cmml" xref="S4.E8.m1.4.4"><divide id="S4.E8.m1.4.4.5.cmml" xref="S4.E8.m1.4.4"></divide><apply id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.2"><exp id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1"></exp><apply id="S4.E8.m1.2.2.2.2.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1"><divide id="S4.E8.m1.2.2.2.2.1.1.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.3"></divide><apply id="S4.E8.m1.2.2.2.2.1.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2"><times id="S4.E8.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.3"></times><ci id="S4.E8.m1.2.2.2.2.1.1.2.4a.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.4"><mtext id="S4.E8.m1.2.2.2.2.1.1.2.4.cmml" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E8.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2"><apply id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.2.3">1</cn></apply><ci id="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><ci id="S4.E8.m1.2.2.2.2.1.1.4.cmml" xref="S4.E8.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S4.E8.m1.4.4.4.cmml" xref="S4.E8.m1.4.4.4"><apply id="S4.E8.m1.4.4.4.3.cmml" xref="S4.E8.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.4.3.1.cmml" xref="S4.E8.m1.4.4.4.3">subscript</csymbol><sum id="S4.E8.m1.4.4.4.3.2.cmml" xref="S4.E8.m1.4.4.4.3.2"></sum><apply id="S4.E8.m1.4.4.4.3.3.cmml" xref="S4.E8.m1.4.4.4.3.3"><in id="S4.E8.m1.4.4.4.3.3.1.cmml" xref="S4.E8.m1.4.4.4.3.3.1"></in><ci id="S4.E8.m1.4.4.4.3.3.2.cmml" xref="S4.E8.m1.4.4.4.3.3.2">𝑣</ci><ci id="S4.E8.m1.4.4.4.3.3.3.cmml" xref="S4.E8.m1.4.4.4.3.3.3">𝒰</ci></apply></apply><apply id="S4.E8.m1.4.4.4.2.2.cmml" xref="S4.E8.m1.4.4.4.2.1"><exp id="S4.E8.m1.3.3.3.1.cmml" xref="S4.E8.m1.3.3.3.1"></exp><apply id="S4.E8.m1.4.4.4.2.1.1.1.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1"><divide id="S4.E8.m1.4.4.4.2.1.1.1.3.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.3"></divide><apply id="S4.E8.m1.4.4.4.2.1.1.1.2.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.2"><times id="S4.E8.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.2.3"></times><ci id="S4.E8.m1.4.4.4.2.1.1.1.2.4a.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.2.4"><mtext id="S4.E8.m1.4.4.4.2.1.1.1.2.4.cmml" mathsize="90%" xref="S4.E8.m1.4.4.4.2.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E8.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2"><apply id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.1.1.1.1.3">𝑣</ci></apply><apply id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.2.3">1</cn></apply><ci id="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><ci id="S4.E8.m1.4.4.4.2.1.1.1.4.cmml" xref="S4.E8.m1.4.4.4.2.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.5c">\small\mathcal{L}^{u}_{2}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{2}_{u},E^{%
1}_{i}\Big{)}/\tau\Big{)}}{\sum_{v\in\mathcal{U}}\exp\Big{(}\text{sim}\Big{(}E%
^{2}_{v},E^{1}_{i}\Big{)}/\tau\Big{)}},</annotation><annotation encoding="application/x-llamapun" id="S4.E8.m1.5d">caligraphic_L start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_v ∈ caligraphic_U end_POSTSUBSCRIPT roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) / italic_τ ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathcal{L}^{i}_{2}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{2}_{i},E^{%
1}_{u}\Big{)}/\tau\Big{)}}{\sum_{j\in\mathcal{I}}\exp\left(\text{sim}\left(E^{%
2}_{j},E^{1}_{u}\right)/\tau\right)}," class="ltx_Math" display="block" id="S4.E9.m1.5"><semantics id="S4.E9.m1.5a"><mrow id="S4.E9.m1.5.5.1" xref="S4.E9.m1.5.5.1.1.cmml"><mrow id="S4.E9.m1.5.5.1.1" xref="S4.E9.m1.5.5.1.1.cmml"><msubsup id="S4.E9.m1.5.5.1.1.2" xref="S4.E9.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.5.5.1.1.2.2.2" mathsize="90%" xref="S4.E9.m1.5.5.1.1.2.2.2.cmml">ℒ</mi><mn id="S4.E9.m1.5.5.1.1.2.3" mathsize="90%" xref="S4.E9.m1.5.5.1.1.2.3.cmml">2</mn><mi id="S4.E9.m1.5.5.1.1.2.2.3" mathsize="90%" xref="S4.E9.m1.5.5.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S4.E9.m1.5.5.1.1.1" mathsize="90%" xref="S4.E9.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E9.m1.5.5.1.1.3" xref="S4.E9.m1.5.5.1.1.3.cmml"><mo id="S4.E9.m1.5.5.1.1.3a" mathsize="90%" rspace="0.167em" xref="S4.E9.m1.5.5.1.1.3.cmml">−</mo><mrow id="S4.E9.m1.5.5.1.1.3.2" xref="S4.E9.m1.5.5.1.1.3.2.cmml"><mi id="S4.E9.m1.5.5.1.1.3.2.1" mathsize="90%" xref="S4.E9.m1.5.5.1.1.3.2.1.cmml">log</mi><mo id="S4.E9.m1.5.5.1.1.3.2a" lspace="0.167em" xref="S4.E9.m1.5.5.1.1.3.2.cmml">⁡</mo><mfrac id="S4.E9.m1.4.4" xref="S4.E9.m1.4.4.cmml"><mrow id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1" mathsize="90%" xref="S4.E9.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E9.m1.2.2.2.2a" xref="S4.E9.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E9.m1.2.2.2.2.1" xref="S4.E9.m1.2.2.2.3.cmml"><mo id="S4.E9.m1.2.2.2.2.1.2" maxsize="160%" minsize="160%" xref="S4.E9.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E9.m1.2.2.2.2.1.1" xref="S4.E9.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E9.m1.2.2.2.2.1.1.2" xref="S4.E9.m1.2.2.2.2.1.1.2.cmml"><mtext id="S4.E9.m1.2.2.2.2.1.1.2.4" mathsize="90%" xref="S4.E9.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo id="S4.E9.m1.2.2.2.2.1.1.2.3" xref="S4.E9.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E9.m1.2.2.2.2.1.1.2.2.2" xref="S4.E9.m1.2.2.2.2.1.1.2.2.3.cmml"><mo id="S4.E9.m1.2.2.2.2.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E9.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">i</mi><mn id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">2</mn></msubsup><mo id="S4.E9.m1.2.2.2.2.1.1.2.2.2.4" mathsize="90%" xref="S4.E9.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">u</mi><mn id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S4.E9.m1.2.2.2.2.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E9.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.2.2.2.2.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E9.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S4.E9.m1.2.2.2.2.1.1.4" mathsize="90%" xref="S4.E9.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo id="S4.E9.m1.2.2.2.2.1.3" maxsize="160%" minsize="160%" xref="S4.E9.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E9.m1.4.4.4" xref="S4.E9.m1.4.4.4.cmml"><msub id="S4.E9.m1.4.4.4.3" xref="S4.E9.m1.4.4.4.3.cmml"><mo id="S4.E9.m1.4.4.4.3.2" maxsize="90%" minsize="90%" stretchy="true" xref="S4.E9.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S4.E9.m1.4.4.4.3.3" xref="S4.E9.m1.4.4.4.3.3.cmml"><mi id="S4.E9.m1.4.4.4.3.3.2" mathsize="90%" xref="S4.E9.m1.4.4.4.3.3.2.cmml">j</mi><mo id="S4.E9.m1.4.4.4.3.3.1" mathsize="90%" xref="S4.E9.m1.4.4.4.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.4.4.4.3.3.3" mathsize="90%" xref="S4.E9.m1.4.4.4.3.3.3.cmml">ℐ</mi></mrow></msub><mrow id="S4.E9.m1.4.4.4.2.1" xref="S4.E9.m1.4.4.4.2.2.cmml"><mi id="S4.E9.m1.3.3.3.1" mathsize="90%" xref="S4.E9.m1.3.3.3.1.cmml">exp</mi><mo id="S4.E9.m1.4.4.4.2.1a" xref="S4.E9.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.E9.m1.4.4.4.2.1.1" xref="S4.E9.m1.4.4.4.2.2.cmml"><mo id="S4.E9.m1.4.4.4.2.1.1.2" xref="S4.E9.m1.4.4.4.2.2.cmml">(</mo><mrow id="S4.E9.m1.4.4.4.2.1.1.1" xref="S4.E9.m1.4.4.4.2.1.1.1.cmml"><mrow id="S4.E9.m1.4.4.4.2.1.1.1.2" xref="S4.E9.m1.4.4.4.2.1.1.1.2.cmml"><mtext id="S4.E9.m1.4.4.4.2.1.1.1.2.4" mathsize="90%" xref="S4.E9.m1.4.4.4.2.1.1.1.2.4a.cmml">sim</mtext><mo id="S4.E9.m1.4.4.4.2.1.1.1.2.3" xref="S4.E9.m1.4.4.4.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.3.cmml"><mo id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.3" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml">j</mi><mn id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml">2</mn></msubsup><mo id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.4" mathsize="90%" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mi id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml">u</mi><mn id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.5" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E9.m1.4.4.4.2.1.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E9.m1.4.4.4.2.1.1.1.3.cmml">/</mo><mi id="S4.E9.m1.4.4.4.2.1.1.1.4" mathsize="90%" xref="S4.E9.m1.4.4.4.2.1.1.1.4.cmml">τ</mi></mrow><mo id="S4.E9.m1.4.4.4.2.1.1.3" xref="S4.E9.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E9.m1.5.5.1.2" mathsize="90%" xref="S4.E9.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.5b"><apply id="S4.E9.m1.5.5.1.1.cmml" xref="S4.E9.m1.5.5.1"><eq id="S4.E9.m1.5.5.1.1.1.cmml" xref="S4.E9.m1.5.5.1.1.1"></eq><apply id="S4.E9.m1.5.5.1.1.2.cmml" xref="S4.E9.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.2.1.cmml" xref="S4.E9.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E9.m1.5.5.1.1.2.2.cmml" xref="S4.E9.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.5.5.1.1.2.2.1.cmml" xref="S4.E9.m1.5.5.1.1.2">superscript</csymbol><ci id="S4.E9.m1.5.5.1.1.2.2.2.cmml" xref="S4.E9.m1.5.5.1.1.2.2.2">ℒ</ci><ci id="S4.E9.m1.5.5.1.1.2.2.3.cmml" xref="S4.E9.m1.5.5.1.1.2.2.3">𝑖</ci></apply><cn id="S4.E9.m1.5.5.1.1.2.3.cmml" type="integer" xref="S4.E9.m1.5.5.1.1.2.3">2</cn></apply><apply id="S4.E9.m1.5.5.1.1.3.cmml" xref="S4.E9.m1.5.5.1.1.3"><minus id="S4.E9.m1.5.5.1.1.3.1.cmml" xref="S4.E9.m1.5.5.1.1.3"></minus><apply id="S4.E9.m1.5.5.1.1.3.2.cmml" xref="S4.E9.m1.5.5.1.1.3.2"><log id="S4.E9.m1.5.5.1.1.3.2.1.cmml" xref="S4.E9.m1.5.5.1.1.3.2.1"></log><apply id="S4.E9.m1.4.4.cmml" xref="S4.E9.m1.4.4"><divide id="S4.E9.m1.4.4.5.cmml" xref="S4.E9.m1.4.4"></divide><apply id="S4.E9.m1.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2"><exp id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1"></exp><apply id="S4.E9.m1.2.2.2.2.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1"><divide id="S4.E9.m1.2.2.2.2.1.1.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.3"></divide><apply id="S4.E9.m1.2.2.2.2.1.1.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2"><times id="S4.E9.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.3"></times><ci id="S4.E9.m1.2.2.2.2.1.1.2.4a.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.4"><mtext id="S4.E9.m1.2.2.2.2.1.1.2.4.cmml" mathsize="90%" xref="S4.E9.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E9.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2"><apply id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2.3">1</cn></apply><ci id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply><ci id="S4.E9.m1.2.2.2.2.1.1.4.cmml" xref="S4.E9.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S4.E9.m1.4.4.4.cmml" xref="S4.E9.m1.4.4.4"><apply id="S4.E9.m1.4.4.4.3.cmml" xref="S4.E9.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.3.1.cmml" xref="S4.E9.m1.4.4.4.3">subscript</csymbol><sum id="S4.E9.m1.4.4.4.3.2.cmml" xref="S4.E9.m1.4.4.4.3.2"></sum><apply id="S4.E9.m1.4.4.4.3.3.cmml" xref="S4.E9.m1.4.4.4.3.3"><in id="S4.E9.m1.4.4.4.3.3.1.cmml" xref="S4.E9.m1.4.4.4.3.3.1"></in><ci id="S4.E9.m1.4.4.4.3.3.2.cmml" xref="S4.E9.m1.4.4.4.3.3.2">𝑗</ci><ci id="S4.E9.m1.4.4.4.3.3.3.cmml" xref="S4.E9.m1.4.4.4.3.3.3">ℐ</ci></apply></apply><apply id="S4.E9.m1.4.4.4.2.2.cmml" xref="S4.E9.m1.4.4.4.2.1"><exp id="S4.E9.m1.3.3.3.1.cmml" xref="S4.E9.m1.3.3.3.1"></exp><apply id="S4.E9.m1.4.4.4.2.1.1.1.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1"><divide id="S4.E9.m1.4.4.4.2.1.1.1.3.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.3"></divide><apply id="S4.E9.m1.4.4.4.2.1.1.1.2.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.2"><times id="S4.E9.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.2.3"></times><ci id="S4.E9.m1.4.4.4.2.1.1.1.2.4a.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.2.4"><mtext id="S4.E9.m1.4.4.4.2.1.1.1.2.4.cmml" mathsize="90%" xref="S4.E9.m1.4.4.4.2.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E9.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2"><apply id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.1.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.2.3">1</cn></apply><ci id="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply><ci id="S4.E9.m1.4.4.4.2.1.1.1.4.cmml" xref="S4.E9.m1.4.4.4.2.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.5c">\small\mathcal{L}^{i}_{2}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{2}_{i},E^{%
1}_{u}\Big{)}/\tau\Big{)}}{\sum_{j\in\mathcal{I}}\exp\left(\text{sim}\left(E^{%
2}_{j},E^{1}_{u}\right)/\tau\right)},</annotation><annotation encoding="application/x-llamapun" id="S4.E9.m1.5d">caligraphic_L start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_I end_POSTSUBSCRIPT roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) / italic_τ ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathcal{L}_{2}=\mathcal{L}^{u}_{2}+\mathcal{L}^{i}_{2}," class="ltx_Math" display="block" id="S4.E10.m1.1"><semantics id="S4.E10.m1.1a"><mrow id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml"><msub id="S4.E10.m1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1.1.1.2.2" mathsize="90%" xref="S4.E10.m1.1.1.1.1.2.2.cmml">ℒ</mi><mn id="S4.E10.m1.1.1.1.1.2.3" mathsize="90%" xref="S4.E10.m1.1.1.1.1.2.3.cmml">2</mn></msub><mo id="S4.E10.m1.1.1.1.1.1" mathsize="90%" xref="S4.E10.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E10.m1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.3.cmml"><msubsup id="S4.E10.m1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1.1.1.3.2.2.2" mathsize="90%" xref="S4.E10.m1.1.1.1.1.3.2.2.2.cmml">ℒ</mi><mn id="S4.E10.m1.1.1.1.1.3.2.3" mathsize="90%" xref="S4.E10.m1.1.1.1.1.3.2.3.cmml">2</mn><mi id="S4.E10.m1.1.1.1.1.3.2.2.3" mathsize="90%" xref="S4.E10.m1.1.1.1.1.3.2.2.3.cmml">u</mi></msubsup><mo id="S4.E10.m1.1.1.1.1.3.1" mathsize="90%" xref="S4.E10.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S4.E10.m1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.1.1.1.1.3.3.2.2" mathsize="90%" xref="S4.E10.m1.1.1.1.1.3.3.2.2.cmml">ℒ</mi><mn id="S4.E10.m1.1.1.1.1.3.3.3" mathsize="90%" xref="S4.E10.m1.1.1.1.1.3.3.3.cmml">2</mn><mi id="S4.E10.m1.1.1.1.1.3.3.2.3" mathsize="90%" xref="S4.E10.m1.1.1.1.1.3.3.2.3.cmml">i</mi></msubsup></mrow></mrow><mo id="S4.E10.m1.1.1.1.2" mathsize="90%" xref="S4.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b"><apply id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1"><eq id="S4.E10.m1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1"></eq><apply id="S4.E10.m1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.2.2.cmml" xref="S4.E10.m1.1.1.1.1.2.2">ℒ</ci><cn id="S4.E10.m1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E10.m1.1.1.1.1.2.3">2</cn></apply><apply id="S4.E10.m1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.3"><plus id="S4.E10.m1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.1"></plus><apply id="S4.E10.m1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S4.E10.m1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.E10.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2.2">ℒ</ci><ci id="S4.E10.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2.3">𝑢</ci></apply><cn id="S4.E10.m1.1.1.1.1.3.2.3.cmml" type="integer" xref="S4.E10.m1.1.1.1.1.3.2.3">2</cn></apply><apply id="S4.E10.m1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S4.E10.m1.1.1.1.1.3.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.E10.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2.2">ℒ</ci><ci id="S4.E10.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply><cn id="S4.E10.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E10.m1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.1c">\small\mathcal{L}_{2}=\mathcal{L}^{u}_{2}+\mathcal{L}^{i}_{2},</annotation><annotation encoding="application/x-llamapun" id="S4.E10.m1.1d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = caligraphic_L start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + caligraphic_L start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p9.6">wherein <math alttext="E^{2}_{u}" class="ltx_Math" display="inline" id="S4.SS3.p9.1.m1.1"><semantics id="S4.SS3.p9.1.m1.1a"><msubsup id="S4.SS3.p9.1.m1.1.1" xref="S4.SS3.p9.1.m1.1.1.cmml"><mi id="S4.SS3.p9.1.m1.1.1.2.2" xref="S4.SS3.p9.1.m1.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p9.1.m1.1.1.3" xref="S4.SS3.p9.1.m1.1.1.3.cmml">u</mi><mn id="S4.SS3.p9.1.m1.1.1.2.3" xref="S4.SS3.p9.1.m1.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.1.m1.1b"><apply id="S4.SS3.p9.1.m1.1.1.cmml" xref="S4.SS3.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.1.m1.1.1.1.cmml" xref="S4.SS3.p9.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.p9.1.m1.1.1.2.cmml" xref="S4.SS3.p9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.1.m1.1.1.2.1.cmml" xref="S4.SS3.p9.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p9.1.m1.1.1.2.2.cmml" xref="S4.SS3.p9.1.m1.1.1.2.2">𝐸</ci><cn id="S4.SS3.p9.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS3.p9.1.m1.1.1.2.3">2</cn></apply><ci id="S4.SS3.p9.1.m1.1.1.3.cmml" xref="S4.SS3.p9.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.1.m1.1c">E^{2}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.1.m1.1d">italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the embedding of the user’s second-order aggregated data processed by the LLM-encoder, <math alttext="E^{1}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p9.2.m2.1"><semantics id="S4.SS3.p9.2.m2.1a"><msubsup id="S4.SS3.p9.2.m2.1.1" xref="S4.SS3.p9.2.m2.1.1.cmml"><mi id="S4.SS3.p9.2.m2.1.1.2.2" xref="S4.SS3.p9.2.m2.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p9.2.m2.1.1.3" xref="S4.SS3.p9.2.m2.1.1.3.cmml">i</mi><mn id="S4.SS3.p9.2.m2.1.1.2.3" xref="S4.SS3.p9.2.m2.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.2.m2.1b"><apply id="S4.SS3.p9.2.m2.1.1.cmml" xref="S4.SS3.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.2.m2.1.1.1.cmml" xref="S4.SS3.p9.2.m2.1.1">subscript</csymbol><apply id="S4.SS3.p9.2.m2.1.1.2.cmml" xref="S4.SS3.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.2.m2.1.1.2.1.cmml" xref="S4.SS3.p9.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p9.2.m2.1.1.2.2.cmml" xref="S4.SS3.p9.2.m2.1.1.2.2">𝐸</ci><cn id="S4.SS3.p9.2.m2.1.1.2.3.cmml" type="integer" xref="S4.SS3.p9.2.m2.1.1.2.3">1</cn></apply><ci id="S4.SS3.p9.2.m2.1.1.3.cmml" xref="S4.SS3.p9.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.2.m2.1c">E^{1}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.2.m2.1d">italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the embedding of the item’s first-order aggregated data processed by the LLM-encoder, <math alttext="E^{2}_{v}" class="ltx_Math" display="inline" id="S4.SS3.p9.3.m3.1"><semantics id="S4.SS3.p9.3.m3.1a"><msubsup id="S4.SS3.p9.3.m3.1.1" xref="S4.SS3.p9.3.m3.1.1.cmml"><mi id="S4.SS3.p9.3.m3.1.1.2.2" xref="S4.SS3.p9.3.m3.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p9.3.m3.1.1.3" xref="S4.SS3.p9.3.m3.1.1.3.cmml">v</mi><mn id="S4.SS3.p9.3.m3.1.1.2.3" xref="S4.SS3.p9.3.m3.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.3.m3.1b"><apply id="S4.SS3.p9.3.m3.1.1.cmml" xref="S4.SS3.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.3.m3.1.1.1.cmml" xref="S4.SS3.p9.3.m3.1.1">subscript</csymbol><apply id="S4.SS3.p9.3.m3.1.1.2.cmml" xref="S4.SS3.p9.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.3.m3.1.1.2.1.cmml" xref="S4.SS3.p9.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.p9.3.m3.1.1.2.2.cmml" xref="S4.SS3.p9.3.m3.1.1.2.2">𝐸</ci><cn id="S4.SS3.p9.3.m3.1.1.2.3.cmml" type="integer" xref="S4.SS3.p9.3.m3.1.1.2.3">2</cn></apply><ci id="S4.SS3.p9.3.m3.1.1.3.cmml" xref="S4.SS3.p9.3.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.3.m3.1c">E^{2}_{v}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.3.m3.1d">italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> is the embedding of the other item’s first-order aggregated data processed by the LLM-encoder, <math alttext="E^{2}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p9.4.m4.1"><semantics id="S4.SS3.p9.4.m4.1a"><msubsup id="S4.SS3.p9.4.m4.1.1" xref="S4.SS3.p9.4.m4.1.1.cmml"><mi id="S4.SS3.p9.4.m4.1.1.2.2" xref="S4.SS3.p9.4.m4.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p9.4.m4.1.1.3" xref="S4.SS3.p9.4.m4.1.1.3.cmml">i</mi><mn id="S4.SS3.p9.4.m4.1.1.2.3" xref="S4.SS3.p9.4.m4.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.4.m4.1b"><apply id="S4.SS3.p9.4.m4.1.1.cmml" xref="S4.SS3.p9.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.4.m4.1.1.1.cmml" xref="S4.SS3.p9.4.m4.1.1">subscript</csymbol><apply id="S4.SS3.p9.4.m4.1.1.2.cmml" xref="S4.SS3.p9.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.4.m4.1.1.2.1.cmml" xref="S4.SS3.p9.4.m4.1.1">superscript</csymbol><ci id="S4.SS3.p9.4.m4.1.1.2.2.cmml" xref="S4.SS3.p9.4.m4.1.1.2.2">𝐸</ci><cn id="S4.SS3.p9.4.m4.1.1.2.3.cmml" type="integer" xref="S4.SS3.p9.4.m4.1.1.2.3">2</cn></apply><ci id="S4.SS3.p9.4.m4.1.1.3.cmml" xref="S4.SS3.p9.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.4.m4.1c">E^{2}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.4.m4.1d">italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>/<math alttext="E^{1}_{u}" class="ltx_Math" display="inline" id="S4.SS3.p9.5.m5.1"><semantics id="S4.SS3.p9.5.m5.1a"><msubsup id="S4.SS3.p9.5.m5.1.1" xref="S4.SS3.p9.5.m5.1.1.cmml"><mi id="S4.SS3.p9.5.m5.1.1.2.2" xref="S4.SS3.p9.5.m5.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p9.5.m5.1.1.3" xref="S4.SS3.p9.5.m5.1.1.3.cmml">u</mi><mn id="S4.SS3.p9.5.m5.1.1.2.3" xref="S4.SS3.p9.5.m5.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.5.m5.1b"><apply id="S4.SS3.p9.5.m5.1.1.cmml" xref="S4.SS3.p9.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.5.m5.1.1.1.cmml" xref="S4.SS3.p9.5.m5.1.1">subscript</csymbol><apply id="S4.SS3.p9.5.m5.1.1.2.cmml" xref="S4.SS3.p9.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.5.m5.1.1.2.1.cmml" xref="S4.SS3.p9.5.m5.1.1">superscript</csymbol><ci id="S4.SS3.p9.5.m5.1.1.2.2.cmml" xref="S4.SS3.p9.5.m5.1.1.2.2">𝐸</ci><cn id="S4.SS3.p9.5.m5.1.1.2.3.cmml" type="integer" xref="S4.SS3.p9.5.m5.1.1.2.3">1</cn></apply><ci id="S4.SS3.p9.5.m5.1.1.3.cmml" xref="S4.SS3.p9.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.5.m5.1c">E^{1}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.5.m5.1d">italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>/<math alttext="E^{2}_{j}" class="ltx_Math" display="inline" id="S4.SS3.p9.6.m6.1"><semantics id="S4.SS3.p9.6.m6.1a"><msubsup id="S4.SS3.p9.6.m6.1.1" xref="S4.SS3.p9.6.m6.1.1.cmml"><mi id="S4.SS3.p9.6.m6.1.1.2.2" xref="S4.SS3.p9.6.m6.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p9.6.m6.1.1.3" xref="S4.SS3.p9.6.m6.1.1.3.cmml">j</mi><mn id="S4.SS3.p9.6.m6.1.1.2.3" xref="S4.SS3.p9.6.m6.1.1.2.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p9.6.m6.1b"><apply id="S4.SS3.p9.6.m6.1.1.cmml" xref="S4.SS3.p9.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.6.m6.1.1.1.cmml" xref="S4.SS3.p9.6.m6.1.1">subscript</csymbol><apply id="S4.SS3.p9.6.m6.1.1.2.cmml" xref="S4.SS3.p9.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p9.6.m6.1.1.2.1.cmml" xref="S4.SS3.p9.6.m6.1.1">superscript</csymbol><ci id="S4.SS3.p9.6.m6.1.1.2.2.cmml" xref="S4.SS3.p9.6.m6.1.1.2.2">𝐸</ci><cn id="S4.SS3.p9.6.m6.1.1.2.3.cmml" type="integer" xref="S4.SS3.p9.6.m6.1.1.2.3">2</cn></apply><ci id="S4.SS3.p9.6.m6.1.1.3.cmml" xref="S4.SS3.p9.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p9.6.m6.1c">E^{2}_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p9.6.m6.1d">italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are similar.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS3.p10">
<p class="ltx_p" id="S4.SS3.p10.7"><span class="ltx_text ltx_font_italic" id="S4.SS3.p10.7.1">3). Aligning user-1-hop with item-0-hop. </span> Reflecting the foundational hypothesis of recommendation systems, items sharing similarities are more inclined to engage with the same user groups. Thus, a particular neighboring item of a user is likely to exhibit a general similarity with the user’s historically interacted items. Accordingly, the first-order aggregate information of a user should bear a resemblance to the intrinsic data of a specific neighboring item. In formal terms, this concept is articulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathcal{L}^{u}_{3}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{0}_{u},E^{%
1}_{i}\Big{)}/\tau\Big{)}}{\sum_{v\in\mathcal{U}}\exp\Big{(}\text{sim}\Big{(}E%
^{0}_{v},E^{1}_{i}\Big{)}/\tau\Big{)}}," class="ltx_Math" display="block" id="S4.E11.m1.5"><semantics id="S4.E11.m1.5a"><mrow id="S4.E11.m1.5.5.1" xref="S4.E11.m1.5.5.1.1.cmml"><mrow id="S4.E11.m1.5.5.1.1" xref="S4.E11.m1.5.5.1.1.cmml"><msubsup id="S4.E11.m1.5.5.1.1.2" xref="S4.E11.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.5.5.1.1.2.2.2" mathsize="90%" xref="S4.E11.m1.5.5.1.1.2.2.2.cmml">ℒ</mi><mn id="S4.E11.m1.5.5.1.1.2.3" mathsize="90%" xref="S4.E11.m1.5.5.1.1.2.3.cmml">3</mn><mi id="S4.E11.m1.5.5.1.1.2.2.3" mathsize="90%" xref="S4.E11.m1.5.5.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S4.E11.m1.5.5.1.1.1" mathsize="90%" xref="S4.E11.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E11.m1.5.5.1.1.3" xref="S4.E11.m1.5.5.1.1.3.cmml"><mo id="S4.E11.m1.5.5.1.1.3a" mathsize="90%" rspace="0.167em" xref="S4.E11.m1.5.5.1.1.3.cmml">−</mo><mrow id="S4.E11.m1.5.5.1.1.3.2" xref="S4.E11.m1.5.5.1.1.3.2.cmml"><mi id="S4.E11.m1.5.5.1.1.3.2.1" mathsize="90%" xref="S4.E11.m1.5.5.1.1.3.2.1.cmml">log</mi><mo id="S4.E11.m1.5.5.1.1.3.2a" lspace="0.167em" xref="S4.E11.m1.5.5.1.1.3.2.cmml">⁡</mo><mfrac id="S4.E11.m1.4.4" xref="S4.E11.m1.4.4.cmml"><mrow id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.3.cmml"><mi id="S4.E11.m1.1.1.1.1" mathsize="90%" xref="S4.E11.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E11.m1.2.2.2.2a" xref="S4.E11.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E11.m1.2.2.2.2.1" xref="S4.E11.m1.2.2.2.3.cmml"><mo id="S4.E11.m1.2.2.2.2.1.2" maxsize="160%" minsize="160%" xref="S4.E11.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E11.m1.2.2.2.2.1.1" xref="S4.E11.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E11.m1.2.2.2.2.1.1.2" xref="S4.E11.m1.2.2.2.2.1.1.2.cmml"><mtext id="S4.E11.m1.2.2.2.2.1.1.2.4" mathsize="90%" xref="S4.E11.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo id="S4.E11.m1.2.2.2.2.1.1.2.3" xref="S4.E11.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E11.m1.2.2.2.2.1.1.2.2.2" xref="S4.E11.m1.2.2.2.2.1.1.2.2.3.cmml"><mo id="S4.E11.m1.2.2.2.2.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E11.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">u</mi><mn id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.E11.m1.2.2.2.2.1.1.2.2.2.4" mathsize="90%" xref="S4.E11.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">i</mi><mn id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S4.E11.m1.2.2.2.2.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E11.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.2.2.2.2.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E11.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S4.E11.m1.2.2.2.2.1.1.4" mathsize="90%" xref="S4.E11.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo id="S4.E11.m1.2.2.2.2.1.3" maxsize="160%" minsize="160%" xref="S4.E11.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E11.m1.4.4.4" xref="S4.E11.m1.4.4.4.cmml"><msub id="S4.E11.m1.4.4.4.3" xref="S4.E11.m1.4.4.4.3.cmml"><mo id="S4.E11.m1.4.4.4.3.2" maxsize="90%" minsize="90%" stretchy="true" xref="S4.E11.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S4.E11.m1.4.4.4.3.3" xref="S4.E11.m1.4.4.4.3.3.cmml"><mi id="S4.E11.m1.4.4.4.3.3.2" mathsize="90%" xref="S4.E11.m1.4.4.4.3.3.2.cmml">v</mi><mo id="S4.E11.m1.4.4.4.3.3.1" mathsize="90%" xref="S4.E11.m1.4.4.4.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.4.4.4.3.3.3" mathsize="90%" xref="S4.E11.m1.4.4.4.3.3.3.cmml">𝒰</mi></mrow></msub><mrow id="S4.E11.m1.4.4.4.2.1" xref="S4.E11.m1.4.4.4.2.2.cmml"><mi id="S4.E11.m1.3.3.3.1" mathsize="90%" xref="S4.E11.m1.3.3.3.1.cmml">exp</mi><mo id="S4.E11.m1.4.4.4.2.1a" xref="S4.E11.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.E11.m1.4.4.4.2.1.1" xref="S4.E11.m1.4.4.4.2.2.cmml"><mo id="S4.E11.m1.4.4.4.2.1.1.2" maxsize="160%" minsize="160%" xref="S4.E11.m1.4.4.4.2.2.cmml">(</mo><mrow id="S4.E11.m1.4.4.4.2.1.1.1" xref="S4.E11.m1.4.4.4.2.1.1.1.cmml"><mrow id="S4.E11.m1.4.4.4.2.1.1.1.2" xref="S4.E11.m1.4.4.4.2.1.1.1.2.cmml"><mtext id="S4.E11.m1.4.4.4.2.1.1.1.2.4" mathsize="90%" xref="S4.E11.m1.4.4.4.2.1.1.1.2.4a.cmml">sim</mtext><mo id="S4.E11.m1.4.4.4.2.1.1.1.2.3" xref="S4.E11.m1.4.4.4.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.3.cmml"><mo id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml">v</mi><mn id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.4" mathsize="90%" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mi id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml">i</mi><mn id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.4.4.4.2.1.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E11.m1.4.4.4.2.1.1.1.3.cmml">/</mo><mi id="S4.E11.m1.4.4.4.2.1.1.1.4" mathsize="90%" xref="S4.E11.m1.4.4.4.2.1.1.1.4.cmml">τ</mi></mrow><mo id="S4.E11.m1.4.4.4.2.1.1.3" maxsize="160%" minsize="160%" xref="S4.E11.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E11.m1.5.5.1.2" mathsize="90%" xref="S4.E11.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.5b"><apply id="S4.E11.m1.5.5.1.1.cmml" xref="S4.E11.m1.5.5.1"><eq id="S4.E11.m1.5.5.1.1.1.cmml" xref="S4.E11.m1.5.5.1.1.1"></eq><apply id="S4.E11.m1.5.5.1.1.2.cmml" xref="S4.E11.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E11.m1.5.5.1.1.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.5.5.1.1.2.2.1.cmml" xref="S4.E11.m1.5.5.1.1.2">superscript</csymbol><ci id="S4.E11.m1.5.5.1.1.2.2.2.cmml" xref="S4.E11.m1.5.5.1.1.2.2.2">ℒ</ci><ci id="S4.E11.m1.5.5.1.1.2.2.3.cmml" xref="S4.E11.m1.5.5.1.1.2.2.3">𝑢</ci></apply><cn id="S4.E11.m1.5.5.1.1.2.3.cmml" type="integer" xref="S4.E11.m1.5.5.1.1.2.3">3</cn></apply><apply id="S4.E11.m1.5.5.1.1.3.cmml" xref="S4.E11.m1.5.5.1.1.3"><minus id="S4.E11.m1.5.5.1.1.3.1.cmml" xref="S4.E11.m1.5.5.1.1.3"></minus><apply id="S4.E11.m1.5.5.1.1.3.2.cmml" xref="S4.E11.m1.5.5.1.1.3.2"><log id="S4.E11.m1.5.5.1.1.3.2.1.cmml" xref="S4.E11.m1.5.5.1.1.3.2.1"></log><apply id="S4.E11.m1.4.4.cmml" xref="S4.E11.m1.4.4"><divide id="S4.E11.m1.4.4.5.cmml" xref="S4.E11.m1.4.4"></divide><apply id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2"><exp id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1"></exp><apply id="S4.E11.m1.2.2.2.2.1.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1"><divide id="S4.E11.m1.2.2.2.2.1.1.3.cmml" xref="S4.E11.m1.2.2.2.2.1.1.3"></divide><apply id="S4.E11.m1.2.2.2.2.1.1.2.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2"><times id="S4.E11.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2.3"></times><ci id="S4.E11.m1.2.2.2.2.1.1.2.4a.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2.4"><mtext id="S4.E11.m1.2.2.2.2.1.1.2.4.cmml" mathsize="90%" xref="S4.E11.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E11.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2"><apply id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.2.2.2.2.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.2.3">1</cn></apply><ci id="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><ci id="S4.E11.m1.2.2.2.2.1.1.4.cmml" xref="S4.E11.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S4.E11.m1.4.4.4.cmml" xref="S4.E11.m1.4.4.4"><apply id="S4.E11.m1.4.4.4.3.cmml" xref="S4.E11.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.4.3.1.cmml" xref="S4.E11.m1.4.4.4.3">subscript</csymbol><sum id="S4.E11.m1.4.4.4.3.2.cmml" xref="S4.E11.m1.4.4.4.3.2"></sum><apply id="S4.E11.m1.4.4.4.3.3.cmml" xref="S4.E11.m1.4.4.4.3.3"><in id="S4.E11.m1.4.4.4.3.3.1.cmml" xref="S4.E11.m1.4.4.4.3.3.1"></in><ci id="S4.E11.m1.4.4.4.3.3.2.cmml" xref="S4.E11.m1.4.4.4.3.3.2">𝑣</ci><ci id="S4.E11.m1.4.4.4.3.3.3.cmml" xref="S4.E11.m1.4.4.4.3.3.3">𝒰</ci></apply></apply><apply id="S4.E11.m1.4.4.4.2.2.cmml" xref="S4.E11.m1.4.4.4.2.1"><exp id="S4.E11.m1.3.3.3.1.cmml" xref="S4.E11.m1.3.3.3.1"></exp><apply id="S4.E11.m1.4.4.4.2.1.1.1.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1"><divide id="S4.E11.m1.4.4.4.2.1.1.1.3.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.3"></divide><apply id="S4.E11.m1.4.4.4.2.1.1.1.2.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.2"><times id="S4.E11.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.2.3"></times><ci id="S4.E11.m1.4.4.4.2.1.1.1.2.4a.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.2.4"><mtext id="S4.E11.m1.4.4.4.2.1.1.1.2.4.cmml" mathsize="90%" xref="S4.E11.m1.4.4.4.2.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E11.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2"><apply id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.1.1.1.1.3">𝑣</ci></apply><apply id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.1.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.2.3">1</cn></apply><ci id="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply><ci id="S4.E11.m1.4.4.4.2.1.1.1.4.cmml" xref="S4.E11.m1.4.4.4.2.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.5c">\small\mathcal{L}^{u}_{3}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{0}_{u},E^{%
1}_{i}\Big{)}/\tau\Big{)}}{\sum_{v\in\mathcal{U}}\exp\Big{(}\text{sim}\Big{(}E%
^{0}_{v},E^{1}_{i}\Big{)}/\tau\Big{)}},</annotation><annotation encoding="application/x-llamapun" id="S4.E11.m1.5d">caligraphic_L start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_v ∈ caligraphic_U end_POSTSUBSCRIPT roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) / italic_τ ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathcal{L}^{i}_{3}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{0}_{i},E^{%
1}_{u}\Big{)}/\tau\Big{)}}{\sum_{j\in\mathcal{I}}\exp\Big{(}\text{sim}\Big{(}E%
^{0}_{j},E^{1}_{u}\Big{)}/\tau\Big{)}}," class="ltx_Math" display="block" id="S4.E12.m1.5"><semantics id="S4.E12.m1.5a"><mrow id="S4.E12.m1.5.5.1" xref="S4.E12.m1.5.5.1.1.cmml"><mrow id="S4.E12.m1.5.5.1.1" xref="S4.E12.m1.5.5.1.1.cmml"><msubsup id="S4.E12.m1.5.5.1.1.2" xref="S4.E12.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.5.5.1.1.2.2.2" mathsize="90%" xref="S4.E12.m1.5.5.1.1.2.2.2.cmml">ℒ</mi><mn id="S4.E12.m1.5.5.1.1.2.3" mathsize="90%" xref="S4.E12.m1.5.5.1.1.2.3.cmml">3</mn><mi id="S4.E12.m1.5.5.1.1.2.2.3" mathsize="90%" xref="S4.E12.m1.5.5.1.1.2.2.3.cmml">i</mi></msubsup><mo id="S4.E12.m1.5.5.1.1.1" mathsize="90%" xref="S4.E12.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E12.m1.5.5.1.1.3" xref="S4.E12.m1.5.5.1.1.3.cmml"><mo id="S4.E12.m1.5.5.1.1.3a" mathsize="90%" rspace="0.167em" xref="S4.E12.m1.5.5.1.1.3.cmml">−</mo><mrow id="S4.E12.m1.5.5.1.1.3.2" xref="S4.E12.m1.5.5.1.1.3.2.cmml"><mi id="S4.E12.m1.5.5.1.1.3.2.1" mathsize="90%" xref="S4.E12.m1.5.5.1.1.3.2.1.cmml">log</mi><mo id="S4.E12.m1.5.5.1.1.3.2a" lspace="0.167em" xref="S4.E12.m1.5.5.1.1.3.2.cmml">⁡</mo><mfrac id="S4.E12.m1.4.4" xref="S4.E12.m1.4.4.cmml"><mrow id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.3.cmml"><mi id="S4.E12.m1.1.1.1.1" mathsize="90%" xref="S4.E12.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E12.m1.2.2.2.2a" xref="S4.E12.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E12.m1.2.2.2.2.1" xref="S4.E12.m1.2.2.2.3.cmml"><mo id="S4.E12.m1.2.2.2.2.1.2" maxsize="160%" minsize="160%" xref="S4.E12.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E12.m1.2.2.2.2.1.1" xref="S4.E12.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E12.m1.2.2.2.2.1.1.2" xref="S4.E12.m1.2.2.2.2.1.1.2.cmml"><mtext id="S4.E12.m1.2.2.2.2.1.1.2.4" mathsize="90%" xref="S4.E12.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo id="S4.E12.m1.2.2.2.2.1.1.2.3" xref="S4.E12.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E12.m1.2.2.2.2.1.1.2.2.2" xref="S4.E12.m1.2.2.2.2.1.1.2.2.3.cmml"><mo id="S4.E12.m1.2.2.2.2.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E12.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">i</mi><mn id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.E12.m1.2.2.2.2.1.1.2.2.2.4" mathsize="90%" xref="S4.E12.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">u</mi><mn id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S4.E12.m1.2.2.2.2.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E12.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.2.2.2.2.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E12.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S4.E12.m1.2.2.2.2.1.1.4" mathsize="90%" xref="S4.E12.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo id="S4.E12.m1.2.2.2.2.1.3" maxsize="160%" minsize="160%" xref="S4.E12.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E12.m1.4.4.4" xref="S4.E12.m1.4.4.4.cmml"><msub id="S4.E12.m1.4.4.4.3" xref="S4.E12.m1.4.4.4.3.cmml"><mo id="S4.E12.m1.4.4.4.3.2" maxsize="90%" minsize="90%" stretchy="true" xref="S4.E12.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S4.E12.m1.4.4.4.3.3" xref="S4.E12.m1.4.4.4.3.3.cmml"><mi id="S4.E12.m1.4.4.4.3.3.2" mathsize="90%" xref="S4.E12.m1.4.4.4.3.3.2.cmml">j</mi><mo id="S4.E12.m1.4.4.4.3.3.1" mathsize="90%" xref="S4.E12.m1.4.4.4.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.4.4.4.3.3.3" mathsize="90%" xref="S4.E12.m1.4.4.4.3.3.3.cmml">ℐ</mi></mrow></msub><mrow id="S4.E12.m1.4.4.4.2.1" xref="S4.E12.m1.4.4.4.2.2.cmml"><mi id="S4.E12.m1.3.3.3.1" mathsize="90%" xref="S4.E12.m1.3.3.3.1.cmml">exp</mi><mo id="S4.E12.m1.4.4.4.2.1a" xref="S4.E12.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.E12.m1.4.4.4.2.1.1" xref="S4.E12.m1.4.4.4.2.2.cmml"><mo id="S4.E12.m1.4.4.4.2.1.1.2" maxsize="160%" minsize="160%" xref="S4.E12.m1.4.4.4.2.2.cmml">(</mo><mrow id="S4.E12.m1.4.4.4.2.1.1.1" xref="S4.E12.m1.4.4.4.2.1.1.1.cmml"><mrow id="S4.E12.m1.4.4.4.2.1.1.1.2" xref="S4.E12.m1.4.4.4.2.1.1.1.2.cmml"><mtext id="S4.E12.m1.4.4.4.2.1.1.1.2.4" mathsize="90%" xref="S4.E12.m1.4.4.4.2.1.1.1.2.4a.cmml">sim</mtext><mo id="S4.E12.m1.4.4.4.2.1.1.1.2.3" xref="S4.E12.m1.4.4.4.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.3.cmml"><mo id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.2.2" mathsize="90%" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml">j</mi><mn id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.2.3" mathsize="90%" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.4" mathsize="90%" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mi id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml">u</mi><mn id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.2.3" mathsize="90%" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.4.4.4.2.1.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E12.m1.4.4.4.2.1.1.1.3.cmml">/</mo><mi id="S4.E12.m1.4.4.4.2.1.1.1.4" mathsize="90%" xref="S4.E12.m1.4.4.4.2.1.1.1.4.cmml">τ</mi></mrow><mo id="S4.E12.m1.4.4.4.2.1.1.3" maxsize="160%" minsize="160%" xref="S4.E12.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E12.m1.5.5.1.2" mathsize="90%" xref="S4.E12.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.5b"><apply id="S4.E12.m1.5.5.1.1.cmml" xref="S4.E12.m1.5.5.1"><eq id="S4.E12.m1.5.5.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1"></eq><apply id="S4.E12.m1.5.5.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.2.1.cmml" xref="S4.E12.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E12.m1.5.5.1.1.2.2.cmml" xref="S4.E12.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.2.2.1.cmml" xref="S4.E12.m1.5.5.1.1.2">superscript</csymbol><ci id="S4.E12.m1.5.5.1.1.2.2.2.cmml" xref="S4.E12.m1.5.5.1.1.2.2.2">ℒ</ci><ci id="S4.E12.m1.5.5.1.1.2.2.3.cmml" xref="S4.E12.m1.5.5.1.1.2.2.3">𝑖</ci></apply><cn id="S4.E12.m1.5.5.1.1.2.3.cmml" type="integer" xref="S4.E12.m1.5.5.1.1.2.3">3</cn></apply><apply id="S4.E12.m1.5.5.1.1.3.cmml" xref="S4.E12.m1.5.5.1.1.3"><minus id="S4.E12.m1.5.5.1.1.3.1.cmml" xref="S4.E12.m1.5.5.1.1.3"></minus><apply id="S4.E12.m1.5.5.1.1.3.2.cmml" xref="S4.E12.m1.5.5.1.1.3.2"><log id="S4.E12.m1.5.5.1.1.3.2.1.cmml" xref="S4.E12.m1.5.5.1.1.3.2.1"></log><apply id="S4.E12.m1.4.4.cmml" xref="S4.E12.m1.4.4"><divide id="S4.E12.m1.4.4.5.cmml" xref="S4.E12.m1.4.4"></divide><apply id="S4.E12.m1.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2"><exp id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1"></exp><apply id="S4.E12.m1.2.2.2.2.1.1.cmml" xref="S4.E12.m1.2.2.2.2.1.1"><divide id="S4.E12.m1.2.2.2.2.1.1.3.cmml" xref="S4.E12.m1.2.2.2.2.1.1.3"></divide><apply id="S4.E12.m1.2.2.2.2.1.1.2.cmml" xref="S4.E12.m1.2.2.2.2.1.1.2"><times id="S4.E12.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E12.m1.2.2.2.2.1.1.2.3"></times><ci id="S4.E12.m1.2.2.2.2.1.1.2.4a.cmml" xref="S4.E12.m1.2.2.2.2.1.1.2.4"><mtext id="S4.E12.m1.2.2.2.2.1.1.2.4.cmml" mathsize="90%" xref="S4.E12.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E12.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2"><apply id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.2.2.2.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.2.3">1</cn></apply><ci id="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.2.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply><ci id="S4.E12.m1.2.2.2.2.1.1.4.cmml" xref="S4.E12.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S4.E12.m1.4.4.4.cmml" xref="S4.E12.m1.4.4.4"><apply id="S4.E12.m1.4.4.4.3.cmml" xref="S4.E12.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.3.1.cmml" xref="S4.E12.m1.4.4.4.3">subscript</csymbol><sum id="S4.E12.m1.4.4.4.3.2.cmml" xref="S4.E12.m1.4.4.4.3.2"></sum><apply id="S4.E12.m1.4.4.4.3.3.cmml" xref="S4.E12.m1.4.4.4.3.3"><in id="S4.E12.m1.4.4.4.3.3.1.cmml" xref="S4.E12.m1.4.4.4.3.3.1"></in><ci id="S4.E12.m1.4.4.4.3.3.2.cmml" xref="S4.E12.m1.4.4.4.3.3.2">𝑗</ci><ci id="S4.E12.m1.4.4.4.3.3.3.cmml" xref="S4.E12.m1.4.4.4.3.3.3">ℐ</ci></apply></apply><apply id="S4.E12.m1.4.4.4.2.2.cmml" xref="S4.E12.m1.4.4.4.2.1"><exp id="S4.E12.m1.3.3.3.1.cmml" xref="S4.E12.m1.3.3.3.1"></exp><apply id="S4.E12.m1.4.4.4.2.1.1.1.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1"><divide id="S4.E12.m1.4.4.4.2.1.1.1.3.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.3"></divide><apply id="S4.E12.m1.4.4.4.2.1.1.1.2.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.2"><times id="S4.E12.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.2.3"></times><ci id="S4.E12.m1.4.4.4.2.1.1.1.2.4a.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.2.4"><mtext id="S4.E12.m1.4.4.4.2.1.1.1.2.4.cmml" mathsize="90%" xref="S4.E12.m1.4.4.4.2.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E12.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2"><apply id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.1.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.2.3">1</cn></apply><ci id="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply><ci id="S4.E12.m1.4.4.4.2.1.1.1.4.cmml" xref="S4.E12.m1.4.4.4.2.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.5c">\small\mathcal{L}^{i}_{3}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{0}_{i},E^{%
1}_{u}\Big{)}/\tau\Big{)}}{\sum_{j\in\mathcal{I}}\exp\Big{(}\text{sim}\Big{(}E%
^{0}_{j},E^{1}_{u}\Big{)}/\tau\Big{)}},</annotation><annotation encoding="application/x-llamapun" id="S4.E12.m1.5d">caligraphic_L start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j ∈ caligraphic_I end_POSTSUBSCRIPT roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) / italic_τ ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\small\mathcal{L}_{3}=\mathcal{L}^{u}_{3}+\mathcal{L}^{i}_{3}," class="ltx_Math" display="block" id="S4.E13.m1.1"><semantics id="S4.E13.m1.1a"><mrow id="S4.E13.m1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><mrow id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml"><msub id="S4.E13.m1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.2.2" mathsize="90%" xref="S4.E13.m1.1.1.1.1.2.2.cmml">ℒ</mi><mn id="S4.E13.m1.1.1.1.1.2.3" mathsize="90%" xref="S4.E13.m1.1.1.1.1.2.3.cmml">3</mn></msub><mo id="S4.E13.m1.1.1.1.1.1" mathsize="90%" xref="S4.E13.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E13.m1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.3.cmml"><msubsup id="S4.E13.m1.1.1.1.1.3.2" xref="S4.E13.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.3.2.2.2" mathsize="90%" xref="S4.E13.m1.1.1.1.1.3.2.2.2.cmml">ℒ</mi><mn id="S4.E13.m1.1.1.1.1.3.2.3" mathsize="90%" xref="S4.E13.m1.1.1.1.1.3.2.3.cmml">3</mn><mi id="S4.E13.m1.1.1.1.1.3.2.2.3" mathsize="90%" xref="S4.E13.m1.1.1.1.1.3.2.2.3.cmml">u</mi></msubsup><mo id="S4.E13.m1.1.1.1.1.3.1" mathsize="90%" xref="S4.E13.m1.1.1.1.1.3.1.cmml">+</mo><msubsup id="S4.E13.m1.1.1.1.1.3.3" xref="S4.E13.m1.1.1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.1.1.1.1.3.3.2.2" mathsize="90%" xref="S4.E13.m1.1.1.1.1.3.3.2.2.cmml">ℒ</mi><mn id="S4.E13.m1.1.1.1.1.3.3.3" mathsize="90%" xref="S4.E13.m1.1.1.1.1.3.3.3.cmml">3</mn><mi id="S4.E13.m1.1.1.1.1.3.3.2.3" mathsize="90%" xref="S4.E13.m1.1.1.1.1.3.3.2.3.cmml">i</mi></msubsup></mrow></mrow><mo id="S4.E13.m1.1.1.1.2" mathsize="90%" xref="S4.E13.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.1b"><apply id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1"><eq id="S4.E13.m1.1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1.1"></eq><apply id="S4.E13.m1.1.1.1.1.2.cmml" xref="S4.E13.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.2.1.cmml" xref="S4.E13.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.E13.m1.1.1.1.1.2.2.cmml" xref="S4.E13.m1.1.1.1.1.2.2">ℒ</ci><cn id="S4.E13.m1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.2.3">3</cn></apply><apply id="S4.E13.m1.1.1.1.1.3.cmml" xref="S4.E13.m1.1.1.1.1.3"><plus id="S4.E13.m1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.1.1.1.1.3.1"></plus><apply id="S4.E13.m1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.3.2.1.cmml" xref="S4.E13.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S4.E13.m1.1.1.1.1.3.2.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E13.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.E13.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2.2">ℒ</ci><ci id="S4.E13.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E13.m1.1.1.1.1.3.2.2.3">𝑢</ci></apply><cn id="S4.E13.m1.1.1.1.1.3.2.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.3.2.3">3</cn></apply><apply id="S4.E13.m1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.3.3.1.cmml" xref="S4.E13.m1.1.1.1.1.3.3">subscript</csymbol><apply id="S4.E13.m1.1.1.1.1.3.3.2.cmml" xref="S4.E13.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E13.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E13.m1.1.1.1.1.3.3">superscript</csymbol><ci id="S4.E13.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E13.m1.1.1.1.1.3.3.2.2">ℒ</ci><ci id="S4.E13.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E13.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply><cn id="S4.E13.m1.1.1.1.1.3.3.3.cmml" type="integer" xref="S4.E13.m1.1.1.1.1.3.3.3">3</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.1c">\small\mathcal{L}_{3}=\mathcal{L}^{u}_{3}+\mathcal{L}^{i}_{3},</annotation><annotation encoding="application/x-llamapun" id="S4.E13.m1.1d">caligraphic_L start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT = caligraphic_L start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT + caligraphic_L start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS3.p10.6">wherein <math alttext="E^{0}_{u}" class="ltx_Math" display="inline" id="S4.SS3.p10.1.m1.1"><semantics id="S4.SS3.p10.1.m1.1a"><msubsup id="S4.SS3.p10.1.m1.1.1" xref="S4.SS3.p10.1.m1.1.1.cmml"><mi id="S4.SS3.p10.1.m1.1.1.2.2" xref="S4.SS3.p10.1.m1.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p10.1.m1.1.1.3" xref="S4.SS3.p10.1.m1.1.1.3.cmml">u</mi><mn id="S4.SS3.p10.1.m1.1.1.2.3" xref="S4.SS3.p10.1.m1.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p10.1.m1.1b"><apply id="S4.SS3.p10.1.m1.1.1.cmml" xref="S4.SS3.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.1.m1.1.1.1.cmml" xref="S4.SS3.p10.1.m1.1.1">subscript</csymbol><apply id="S4.SS3.p10.1.m1.1.1.2.cmml" xref="S4.SS3.p10.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.1.m1.1.1.2.1.cmml" xref="S4.SS3.p10.1.m1.1.1">superscript</csymbol><ci id="S4.SS3.p10.1.m1.1.1.2.2.cmml" xref="S4.SS3.p10.1.m1.1.1.2.2">𝐸</ci><cn id="S4.SS3.p10.1.m1.1.1.2.3.cmml" type="integer" xref="S4.SS3.p10.1.m1.1.1.2.3">0</cn></apply><ci id="S4.SS3.p10.1.m1.1.1.3.cmml" xref="S4.SS3.p10.1.m1.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p10.1.m1.1c">E^{0}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p10.1.m1.1d">italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math> is the embedding of the user’s second-order aggregated data processed by the LLM-encoder, <math alttext="E^{1}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p10.2.m2.1"><semantics id="S4.SS3.p10.2.m2.1a"><msubsup id="S4.SS3.p10.2.m2.1.1" xref="S4.SS3.p10.2.m2.1.1.cmml"><mi id="S4.SS3.p10.2.m2.1.1.2.2" xref="S4.SS3.p10.2.m2.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p10.2.m2.1.1.3" xref="S4.SS3.p10.2.m2.1.1.3.cmml">i</mi><mn id="S4.SS3.p10.2.m2.1.1.2.3" xref="S4.SS3.p10.2.m2.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p10.2.m2.1b"><apply id="S4.SS3.p10.2.m2.1.1.cmml" xref="S4.SS3.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.2.m2.1.1.1.cmml" xref="S4.SS3.p10.2.m2.1.1">subscript</csymbol><apply id="S4.SS3.p10.2.m2.1.1.2.cmml" xref="S4.SS3.p10.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.2.m2.1.1.2.1.cmml" xref="S4.SS3.p10.2.m2.1.1">superscript</csymbol><ci id="S4.SS3.p10.2.m2.1.1.2.2.cmml" xref="S4.SS3.p10.2.m2.1.1.2.2">𝐸</ci><cn id="S4.SS3.p10.2.m2.1.1.2.3.cmml" type="integer" xref="S4.SS3.p10.2.m2.1.1.2.3">1</cn></apply><ci id="S4.SS3.p10.2.m2.1.1.3.cmml" xref="S4.SS3.p10.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p10.2.m2.1c">E^{1}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p10.2.m2.1d">italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the embedding of the item’s first-order aggregated data processed by the LLM-encoder, <math alttext="E^{0}_{v}" class="ltx_Math" display="inline" id="S4.SS3.p10.3.m3.1"><semantics id="S4.SS3.p10.3.m3.1a"><msubsup id="S4.SS3.p10.3.m3.1.1" xref="S4.SS3.p10.3.m3.1.1.cmml"><mi id="S4.SS3.p10.3.m3.1.1.2.2" xref="S4.SS3.p10.3.m3.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p10.3.m3.1.1.3" xref="S4.SS3.p10.3.m3.1.1.3.cmml">v</mi><mn id="S4.SS3.p10.3.m3.1.1.2.3" xref="S4.SS3.p10.3.m3.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p10.3.m3.1b"><apply id="S4.SS3.p10.3.m3.1.1.cmml" xref="S4.SS3.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.3.m3.1.1.1.cmml" xref="S4.SS3.p10.3.m3.1.1">subscript</csymbol><apply id="S4.SS3.p10.3.m3.1.1.2.cmml" xref="S4.SS3.p10.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.3.m3.1.1.2.1.cmml" xref="S4.SS3.p10.3.m3.1.1">superscript</csymbol><ci id="S4.SS3.p10.3.m3.1.1.2.2.cmml" xref="S4.SS3.p10.3.m3.1.1.2.2">𝐸</ci><cn id="S4.SS3.p10.3.m3.1.1.2.3.cmml" type="integer" xref="S4.SS3.p10.3.m3.1.1.2.3">0</cn></apply><ci id="S4.SS3.p10.3.m3.1.1.3.cmml" xref="S4.SS3.p10.3.m3.1.1.3">𝑣</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p10.3.m3.1c">E^{0}_{v}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p10.3.m3.1d">italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT</annotation></semantics></math> is the embedding of the other user’s first-order aggregated data processed by the LLM-encoder, <math alttext="E^{0}_{i}" class="ltx_Math" display="inline" id="S4.SS3.p10.4.m4.1"><semantics id="S4.SS3.p10.4.m4.1a"><msubsup id="S4.SS3.p10.4.m4.1.1" xref="S4.SS3.p10.4.m4.1.1.cmml"><mi id="S4.SS3.p10.4.m4.1.1.2.2" xref="S4.SS3.p10.4.m4.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p10.4.m4.1.1.3" xref="S4.SS3.p10.4.m4.1.1.3.cmml">i</mi><mn id="S4.SS3.p10.4.m4.1.1.2.3" xref="S4.SS3.p10.4.m4.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p10.4.m4.1b"><apply id="S4.SS3.p10.4.m4.1.1.cmml" xref="S4.SS3.p10.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.4.m4.1.1.1.cmml" xref="S4.SS3.p10.4.m4.1.1">subscript</csymbol><apply id="S4.SS3.p10.4.m4.1.1.2.cmml" xref="S4.SS3.p10.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.4.m4.1.1.2.1.cmml" xref="S4.SS3.p10.4.m4.1.1">superscript</csymbol><ci id="S4.SS3.p10.4.m4.1.1.2.2.cmml" xref="S4.SS3.p10.4.m4.1.1.2.2">𝐸</ci><cn id="S4.SS3.p10.4.m4.1.1.2.3.cmml" type="integer" xref="S4.SS3.p10.4.m4.1.1.2.3">0</cn></apply><ci id="S4.SS3.p10.4.m4.1.1.3.cmml" xref="S4.SS3.p10.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p10.4.m4.1c">E^{0}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p10.4.m4.1d">italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>/<math alttext="E^{1}_{u}" class="ltx_Math" display="inline" id="S4.SS3.p10.5.m5.1"><semantics id="S4.SS3.p10.5.m5.1a"><msubsup id="S4.SS3.p10.5.m5.1.1" xref="S4.SS3.p10.5.m5.1.1.cmml"><mi id="S4.SS3.p10.5.m5.1.1.2.2" xref="S4.SS3.p10.5.m5.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p10.5.m5.1.1.3" xref="S4.SS3.p10.5.m5.1.1.3.cmml">u</mi><mn id="S4.SS3.p10.5.m5.1.1.2.3" xref="S4.SS3.p10.5.m5.1.1.2.3.cmml">1</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p10.5.m5.1b"><apply id="S4.SS3.p10.5.m5.1.1.cmml" xref="S4.SS3.p10.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.5.m5.1.1.1.cmml" xref="S4.SS3.p10.5.m5.1.1">subscript</csymbol><apply id="S4.SS3.p10.5.m5.1.1.2.cmml" xref="S4.SS3.p10.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.5.m5.1.1.2.1.cmml" xref="S4.SS3.p10.5.m5.1.1">superscript</csymbol><ci id="S4.SS3.p10.5.m5.1.1.2.2.cmml" xref="S4.SS3.p10.5.m5.1.1.2.2">𝐸</ci><cn id="S4.SS3.p10.5.m5.1.1.2.3.cmml" type="integer" xref="S4.SS3.p10.5.m5.1.1.2.3">1</cn></apply><ci id="S4.SS3.p10.5.m5.1.1.3.cmml" xref="S4.SS3.p10.5.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p10.5.m5.1c">E^{1}_{u}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p10.5.m5.1d">italic_E start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT</annotation></semantics></math>/<math alttext="E^{0}_{j}" class="ltx_Math" display="inline" id="S4.SS3.p10.6.m6.1"><semantics id="S4.SS3.p10.6.m6.1a"><msubsup id="S4.SS3.p10.6.m6.1.1" xref="S4.SS3.p10.6.m6.1.1.cmml"><mi id="S4.SS3.p10.6.m6.1.1.2.2" xref="S4.SS3.p10.6.m6.1.1.2.2.cmml">E</mi><mi id="S4.SS3.p10.6.m6.1.1.3" xref="S4.SS3.p10.6.m6.1.1.3.cmml">j</mi><mn id="S4.SS3.p10.6.m6.1.1.2.3" xref="S4.SS3.p10.6.m6.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p10.6.m6.1b"><apply id="S4.SS3.p10.6.m6.1.1.cmml" xref="S4.SS3.p10.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.6.m6.1.1.1.cmml" xref="S4.SS3.p10.6.m6.1.1">subscript</csymbol><apply id="S4.SS3.p10.6.m6.1.1.2.cmml" xref="S4.SS3.p10.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS3.p10.6.m6.1.1.2.1.cmml" xref="S4.SS3.p10.6.m6.1.1">superscript</csymbol><ci id="S4.SS3.p10.6.m6.1.1.2.2.cmml" xref="S4.SS3.p10.6.m6.1.1.2.2">𝐸</ci><cn id="S4.SS3.p10.6.m6.1.1.2.3.cmml" type="integer" xref="S4.SS3.p10.6.m6.1.1.2.3">0</cn></apply><ci id="S4.SS3.p10.6.m6.1.1.3.cmml" xref="S4.SS3.p10.6.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p10.6.m6.1c">E^{0}_{j}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p10.6.m6.1d">italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> are similar.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS4.5.1.1">IV-D</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS4.6.2">MoCo-based Dynamic Queue Storage</span>
</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">In graph-aware learning, we adopt contrastive learning to empower LLM to capture the relationships among multi-hop information in complex graph structures. However, the efficacy of contrastive learning is highly contingent upon the quantity of negative samples, posing a unique challenge for LLM applications. The standard tactic of inflating batch sizes to augment the negative sample count encounters limitations when confronted with the colossal parameter dimensions and substantial GPU memory demands characteristic of LLMs. To address this issue, we employ a dynamically queued storage mechanism inspired by MoCo.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.10">This ingeniously bypasses the limitations imposed by batch size, operating through two pivotal mechanisms: first, the establishment and maintenance of a dynamic memory queue (memory bank) for accumulating and updating the collection of negative examples; secondly, ensuring consistency in negative sample aggregation through momentum updating of the encoder. Specifically, a queue <math alttext="Q" class="ltx_Math" display="inline" id="S4.SS4.p2.1.m1.1"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.1.m1.1d">italic_Q</annotation></semantics></math> of length <math alttext="L" class="ltx_Math" display="inline" id="S4.SS4.p2.2.m2.1"><semantics id="S4.SS4.p2.2.m2.1a"><mi id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><ci id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">L</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.2.m2.1d">italic_L</annotation></semantics></math>, a momentum encoder <math alttext="f_{m}" class="ltx_Math" display="inline" id="S4.SS4.p2.3.m3.1"><semantics id="S4.SS4.p2.3.m3.1a"><msub id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml"><mi id="S4.SS4.p2.3.m3.1.1.2" xref="S4.SS4.p2.3.m3.1.1.2.cmml">f</mi><mi id="S4.SS4.p2.3.m3.1.1.3" xref="S4.SS4.p2.3.m3.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><apply id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m3.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p2.3.m3.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1.2">𝑓</ci><ci id="S4.SS4.p2.3.m3.1.1.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">f_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, and a query encoder <math alttext="f_{q}" class="ltx_Math" display="inline" id="S4.SS4.p2.4.m4.1"><semantics id="S4.SS4.p2.4.m4.1a"><msub id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml"><mi id="S4.SS4.p2.4.m4.1.1.2" xref="S4.SS4.p2.4.m4.1.1.2.cmml">f</mi><mi id="S4.SS4.p2.4.m4.1.1.3" xref="S4.SS4.p2.4.m4.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><apply id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.4.m4.1.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p2.4.m4.1.1.2.cmml" xref="S4.SS4.p2.4.m4.1.1.2">𝑓</ci><ci id="S4.SS4.p2.4.m4.1.1.3.cmml" xref="S4.SS4.p2.4.m4.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">f_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.4.m4.1d">italic_f start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> are constructed, where <math alttext="f_{q}" class="ltx_Math" display="inline" id="S4.SS4.p2.5.m5.1"><semantics id="S4.SS4.p2.5.m5.1a"><msub id="S4.SS4.p2.5.m5.1.1" xref="S4.SS4.p2.5.m5.1.1.cmml"><mi id="S4.SS4.p2.5.m5.1.1.2" xref="S4.SS4.p2.5.m5.1.1.2.cmml">f</mi><mi id="S4.SS4.p2.5.m5.1.1.3" xref="S4.SS4.p2.5.m5.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.5.m5.1b"><apply id="S4.SS4.p2.5.m5.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.5.m5.1.1.1.cmml" xref="S4.SS4.p2.5.m5.1.1">subscript</csymbol><ci id="S4.SS4.p2.5.m5.1.1.2.cmml" xref="S4.SS4.p2.5.m5.1.1.2">𝑓</ci><ci id="S4.SS4.p2.5.m5.1.1.3.cmml" xref="S4.SS4.p2.5.m5.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.5.m5.1c">f_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.5.m5.1d">italic_f start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> serves as the encoder component of the LLM dedicated to the primary recommendation task. Within graph-aware learning, embeddings extracted by <math alttext="f_{q}" class="ltx_Math" display="inline" id="S4.SS4.p2.6.m6.1"><semantics id="S4.SS4.p2.6.m6.1a"><msub id="S4.SS4.p2.6.m6.1.1" xref="S4.SS4.p2.6.m6.1.1.cmml"><mi id="S4.SS4.p2.6.m6.1.1.2" xref="S4.SS4.p2.6.m6.1.1.2.cmml">f</mi><mi id="S4.SS4.p2.6.m6.1.1.3" xref="S4.SS4.p2.6.m6.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.6.m6.1b"><apply id="S4.SS4.p2.6.m6.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.6.m6.1.1.1.cmml" xref="S4.SS4.p2.6.m6.1.1">subscript</csymbol><ci id="S4.SS4.p2.6.m6.1.1.2.cmml" xref="S4.SS4.p2.6.m6.1.1.2">𝑓</ci><ci id="S4.SS4.p2.6.m6.1.1.3.cmml" xref="S4.SS4.p2.6.m6.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.6.m6.1c">f_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.6.m6.1d">italic_f start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> are utilized as positive samples and contrasted against negative samples from queue <math alttext="Q_{m}" class="ltx_Math" display="inline" id="S4.SS4.p2.7.m7.1"><semantics id="S4.SS4.p2.7.m7.1a"><msub id="S4.SS4.p2.7.m7.1.1" xref="S4.SS4.p2.7.m7.1.1.cmml"><mi id="S4.SS4.p2.7.m7.1.1.2" xref="S4.SS4.p2.7.m7.1.1.2.cmml">Q</mi><mi id="S4.SS4.p2.7.m7.1.1.3" xref="S4.SS4.p2.7.m7.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.7.m7.1b"><apply id="S4.SS4.p2.7.m7.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.7.m7.1.1.1.cmml" xref="S4.SS4.p2.7.m7.1.1">subscript</csymbol><ci id="S4.SS4.p2.7.m7.1.1.2.cmml" xref="S4.SS4.p2.7.m7.1.1.2">𝑄</ci><ci id="S4.SS4.p2.7.m7.1.1.3.cmml" xref="S4.SS4.p2.7.m7.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.7.m7.1c">Q_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.7.m7.1d">italic_Q start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>. Concurrently, embeddings extracted using <math alttext="f_{m}" class="ltx_Math" display="inline" id="S4.SS4.p2.8.m8.1"><semantics id="S4.SS4.p2.8.m8.1a"><msub id="S4.SS4.p2.8.m8.1.1" xref="S4.SS4.p2.8.m8.1.1.cmml"><mi id="S4.SS4.p2.8.m8.1.1.2" xref="S4.SS4.p2.8.m8.1.1.2.cmml">f</mi><mi id="S4.SS4.p2.8.m8.1.1.3" xref="S4.SS4.p2.8.m8.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.8.m8.1b"><apply id="S4.SS4.p2.8.m8.1.1.cmml" xref="S4.SS4.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.8.m8.1.1.1.cmml" xref="S4.SS4.p2.8.m8.1.1">subscript</csymbol><ci id="S4.SS4.p2.8.m8.1.1.2.cmml" xref="S4.SS4.p2.8.m8.1.1.2">𝑓</ci><ci id="S4.SS4.p2.8.m8.1.1.3.cmml" xref="S4.SS4.p2.8.m8.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.8.m8.1c">f_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.8.m8.1d">italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> are stored into <math alttext="f_{m}" class="ltx_Math" display="inline" id="S4.SS4.p2.9.m9.1"><semantics id="S4.SS4.p2.9.m9.1a"><msub id="S4.SS4.p2.9.m9.1.1" xref="S4.SS4.p2.9.m9.1.1.cmml"><mi id="S4.SS4.p2.9.m9.1.1.2" xref="S4.SS4.p2.9.m9.1.1.2.cmml">f</mi><mi id="S4.SS4.p2.9.m9.1.1.3" xref="S4.SS4.p2.9.m9.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.9.m9.1b"><apply id="S4.SS4.p2.9.m9.1.1.cmml" xref="S4.SS4.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.9.m9.1.1.1.cmml" xref="S4.SS4.p2.9.m9.1.1">subscript</csymbol><ci id="S4.SS4.p2.9.m9.1.1.2.cmml" xref="S4.SS4.p2.9.m9.1.1.2">𝑓</ci><ci id="S4.SS4.p2.9.m9.1.1.3.cmml" xref="S4.SS4.p2.9.m9.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.9.m9.1c">f_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.9.m9.1d">italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math>, with the parameters of <math alttext="f_{m}" class="ltx_Math" display="inline" id="S4.SS4.p2.10.m10.1"><semantics id="S4.SS4.p2.10.m10.1a"><msub id="S4.SS4.p2.10.m10.1.1" xref="S4.SS4.p2.10.m10.1.1.cmml"><mi id="S4.SS4.p2.10.m10.1.1.2" xref="S4.SS4.p2.10.m10.1.1.2.cmml">f</mi><mi id="S4.SS4.p2.10.m10.1.1.3" xref="S4.SS4.p2.10.m10.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.10.m10.1b"><apply id="S4.SS4.p2.10.m10.1.1.cmml" xref="S4.SS4.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.10.m10.1.1.1.cmml" xref="S4.SS4.p2.10.m10.1.1">subscript</csymbol><ci id="S4.SS4.p2.10.m10.1.1.2.cmml" xref="S4.SS4.p2.10.m10.1.1.2">𝑓</ci><ci id="S4.SS4.p2.10.m10.1.1.3.cmml" xref="S4.SS4.p2.10.m10.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.10.m10.1c">f_{m}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p2.10.m10.1d">italic_f start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> being updated via momentum.</p>
</div>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.7">Taking Eq(<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E5" title="In IV-C Graph-Aware Learning ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">5</span></a>) as an example, it is formally expressed as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="E_{u}^{0}=f_{q}(x_{u}^{0}),E_{u}^{2}=f_{q}(x_{u}^{2}),E_{v}^{2}=Sample(Q_{u}^{%
2})," class="ltx_Math" display="block" id="S4.E14.m1.1"><semantics id="S4.E14.m1.1a"><mrow id="S4.E14.m1.1.1.1"><mrow id="S4.E14.m1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.3.cmml"><mrow id="S4.E14.m1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.E14.m1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.3.2.2" xref="S4.E14.m1.1.1.1.1.1.1.3.2.2.cmml">E</mi><mi id="S4.E14.m1.1.1.1.1.1.1.3.2.3" xref="S4.E14.m1.1.1.1.1.1.1.3.2.3.cmml">u</mi><mn id="S4.E14.m1.1.1.1.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.1.1.3.3.cmml">0</mn></msubsup><mo id="S4.E14.m1.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.cmml"><msub id="S4.E14.m1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.3.2" xref="S4.E14.m1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S4.E14.m1.1.1.1.1.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.1.1.1.3.3.cmml">q</mi></msub><mo id="S4.E14.m1.1.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi><mn id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msubsup><mo id="S4.E14.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E14.m1.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S4.E14.m1.1.1.1.1.2.2.2" xref="S4.E14.m1.1.1.1.1.2.2.3.cmml"><mrow id="S4.E14.m1.1.1.1.1.2.2.1.1" xref="S4.E14.m1.1.1.1.1.2.2.1.1.cmml"><msubsup id="S4.E14.m1.1.1.1.1.2.2.1.1.3" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.2.2.1.1.3.2.2" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3.2.2.cmml">E</mi><mi id="S4.E14.m1.1.1.1.1.2.2.1.1.3.2.3" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3.2.3.cmml">u</mi><mn id="S4.E14.m1.1.1.1.1.2.2.1.1.3.3" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3.3.cmml">2</mn></msubsup><mo id="S4.E14.m1.1.1.1.1.2.2.1.1.2" xref="S4.E14.m1.1.1.1.1.2.2.1.1.2.cmml">=</mo><mrow id="S4.E14.m1.1.1.1.1.2.2.1.1.1" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.cmml"><msub id="S4.E14.m1.1.1.1.1.2.2.1.1.1.3" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.2" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.2.cmml">f</mi><mi id="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.3.cmml">q</mi></msub><mo id="S4.E14.m1.1.1.1.1.2.2.1.1.1.2" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.2" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3.cmml">u</mi><mn id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E14.m1.1.1.1.1.2.2.2.3" xref="S4.E14.m1.1.1.1.1.2.2.3a.cmml">,</mo><mrow id="S4.E14.m1.1.1.1.1.2.2.2.2" xref="S4.E14.m1.1.1.1.1.2.2.2.2.cmml"><msubsup id="S4.E14.m1.1.1.1.1.2.2.2.2.3" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E14.m1.1.1.1.1.2.2.2.2.3.2.2" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3.2.2.cmml">E</mi><mi id="S4.E14.m1.1.1.1.1.2.2.2.2.3.2.3" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3.2.3.cmml">v</mi><mn id="S4.E14.m1.1.1.1.1.2.2.2.2.3.3" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3.3.cmml">2</mn></msubsup><mo id="S4.E14.m1.1.1.1.1.2.2.2.2.2" xref="S4.E14.m1.1.1.1.1.2.2.2.2.2.cmml">=</mo><mrow id="S4.E14.m1.1.1.1.1.2.2.2.2.1" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.cmml"><mi id="S4.E14.m1.1.1.1.1.2.2.2.2.1.3" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.3.cmml">S</mi><mo id="S4.E14.m1.1.1.1.1.2.2.2.2.1.2" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.2.2.2.2.1.4" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.4.cmml">a</mi><mo id="S4.E14.m1.1.1.1.1.2.2.2.2.1.2a" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.2.2.2.2.1.5" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.5.cmml">m</mi><mo id="S4.E14.m1.1.1.1.1.2.2.2.2.1.2b" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.2.2.2.2.1.6" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.6.cmml">p</mi><mo id="S4.E14.m1.1.1.1.1.2.2.2.2.1.2c" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.2.2.2.2.1.7" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.7.cmml">l</mi><mo id="S4.E14.m1.1.1.1.1.2.2.2.2.1.2d" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.2.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.2.2.2.2.1.8" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.8.cmml">e</mi><mo id="S4.E14.m1.1.1.1.1.2.2.2.2.1.2e" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml">(</mo><msubsup id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.2" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.2.cmml">Q</mi><mi id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.3.cmml">u</mi><mn id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E14.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.1b"><apply id="S4.E14.m1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.3a.cmml" xref="S4.E14.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S4.E14.m1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1"><eq id="S4.E14.m1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.2"></eq><apply id="S4.E14.m1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3.2.2">𝐸</ci><ci id="S4.E14.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3.2.3">𝑢</ci></apply><cn id="S4.E14.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.1.1.3.3">0</cn></apply><apply id="S4.E14.m1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1"><times id="S4.E14.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.2"></times><apply id="S4.E14.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S4.E14.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.3.3">𝑞</ci></apply><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><cn id="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply><apply id="S4.E14.m1.1.1.1.1.2.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.3a.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.3">formulae-sequence</csymbol><apply id="S4.E14.m1.1.1.1.1.2.2.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1"><eq id="S4.E14.m1.1.1.1.1.2.2.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.2"></eq><apply id="S4.E14.m1.1.1.1.1.2.2.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.2.2.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.1.1.3.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.2.2.1.1.3.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3.2.2">𝐸</ci><ci id="S4.E14.m1.1.1.1.1.2.2.1.1.3.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3.2.3">𝑢</ci></apply><cn id="S4.E14.m1.1.1.1.1.2.2.1.1.3.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.2.2.1.1.3.3">2</cn></apply><apply id="S4.E14.m1.1.1.1.1.2.2.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1"><times id="S4.E14.m1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.2"></times><apply id="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.2">𝑓</ci><ci id="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.3.3">𝑞</ci></apply><apply id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.2.3">𝑢</ci></apply><cn id="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.2.2.1.1.1.1.1.1.3">2</cn></apply></apply></apply><apply id="S4.E14.m1.1.1.1.1.2.2.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2"><eq id="S4.E14.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.2"></eq><apply id="S4.E14.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.2.2.3.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.2.2.2.2.3.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3.2.2">𝐸</ci><ci id="S4.E14.m1.1.1.1.1.2.2.2.2.3.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3.2.3">𝑣</ci></apply><cn id="S4.E14.m1.1.1.1.1.2.2.2.2.3.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.2.2.2.2.3.3">2</cn></apply><apply id="S4.E14.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1"><times id="S4.E14.m1.1.1.1.1.2.2.2.2.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.2"></times><ci id="S4.E14.m1.1.1.1.1.2.2.2.2.1.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.3">𝑆</ci><ci id="S4.E14.m1.1.1.1.1.2.2.2.2.1.4.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.4">𝑎</ci><ci id="S4.E14.m1.1.1.1.1.2.2.2.2.1.5.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.5">𝑚</ci><ci id="S4.E14.m1.1.1.1.1.2.2.2.2.1.6.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.6">𝑝</ci><ci id="S4.E14.m1.1.1.1.1.2.2.2.2.1.7.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.7">𝑙</ci><ci id="S4.E14.m1.1.1.1.1.2.2.2.2.1.8.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.8">𝑒</ci><apply id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1">superscript</csymbol><apply id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.2">𝑄</ci><ci id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.2.3">𝑢</ci></apply><cn id="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.3.cmml" type="integer" xref="S4.E14.m1.1.1.1.1.2.2.2.2.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.1c">E_{u}^{0}=f_{q}(x_{u}^{0}),E_{u}^{2}=f_{q}(x_{u}^{2}),E_{v}^{2}=Sample(Q_{u}^{%
2}),</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.1d">italic_E start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT ) , italic_E start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = italic_f start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) , italic_E start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = italic_S italic_a italic_m italic_p italic_l italic_e ( italic_Q start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}^{u}_{1}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{0}_{u},E^{2}_{u}%
\Big{)}/\tau\Big{)}}{\sum_{v\in\mathcal{U}}\exp\Big{(}\text{sim}\Big{(}E^{0}_{%
v},E^{2}_{u}\Big{)}/\tau\Big{)}}," class="ltx_Math" display="block" id="S4.E15.m1.5"><semantics id="S4.E15.m1.5a"><mrow id="S4.E15.m1.5.5.1" xref="S4.E15.m1.5.5.1.1.cmml"><mrow id="S4.E15.m1.5.5.1.1" xref="S4.E15.m1.5.5.1.1.cmml"><msubsup id="S4.E15.m1.5.5.1.1.2" xref="S4.E15.m1.5.5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E15.m1.5.5.1.1.2.2.2" xref="S4.E15.m1.5.5.1.1.2.2.2.cmml">ℒ</mi><mn id="S4.E15.m1.5.5.1.1.2.3" xref="S4.E15.m1.5.5.1.1.2.3.cmml">1</mn><mi id="S4.E15.m1.5.5.1.1.2.2.3" xref="S4.E15.m1.5.5.1.1.2.2.3.cmml">u</mi></msubsup><mo id="S4.E15.m1.5.5.1.1.1" xref="S4.E15.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E15.m1.5.5.1.1.3" xref="S4.E15.m1.5.5.1.1.3.cmml"><mo id="S4.E15.m1.5.5.1.1.3a" rspace="0.167em" xref="S4.E15.m1.5.5.1.1.3.cmml">−</mo><mrow id="S4.E15.m1.5.5.1.1.3.2" xref="S4.E15.m1.5.5.1.1.3.2.cmml"><mi id="S4.E15.m1.5.5.1.1.3.2.1" xref="S4.E15.m1.5.5.1.1.3.2.1.cmml">log</mi><mo id="S4.E15.m1.5.5.1.1.3.2a" lspace="0.167em" xref="S4.E15.m1.5.5.1.1.3.2.cmml">⁡</mo><mfrac id="S4.E15.m1.4.4" xref="S4.E15.m1.4.4.cmml"><mrow id="S4.E15.m1.2.2.2.2" xref="S4.E15.m1.2.2.2.3.cmml"><mi id="S4.E15.m1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.cmml">exp</mi><mo id="S4.E15.m1.2.2.2.2a" xref="S4.E15.m1.2.2.2.3.cmml">⁡</mo><mrow id="S4.E15.m1.2.2.2.2.1" xref="S4.E15.m1.2.2.2.3.cmml"><mo id="S4.E15.m1.2.2.2.2.1.2" maxsize="160%" minsize="160%" xref="S4.E15.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E15.m1.2.2.2.2.1.1" xref="S4.E15.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E15.m1.2.2.2.2.1.1.2" xref="S4.E15.m1.2.2.2.2.1.1.2.cmml"><mtext id="S4.E15.m1.2.2.2.2.1.1.2.4" xref="S4.E15.m1.2.2.2.2.1.1.2.4a.cmml">sim</mtext><mo id="S4.E15.m1.2.2.2.2.1.1.2.3" xref="S4.E15.m1.2.2.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S4.E15.m1.2.2.2.2.1.1.2.2.2" xref="S4.E15.m1.2.2.2.2.1.1.2.2.3.cmml"><mo id="S4.E15.m1.2.2.2.2.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E15.m1.2.2.2.2.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.2.2" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">u</mi><mn id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.2.3" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.E15.m1.2.2.2.2.1.1.2.2.2.4" xref="S4.E15.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.2.2" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.3" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.3.cmml">u</mi><mn id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.2.3" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S4.E15.m1.2.2.2.2.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E15.m1.2.2.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E15.m1.2.2.2.2.1.1.3" xref="S4.E15.m1.2.2.2.2.1.1.3.cmml">/</mo><mi id="S4.E15.m1.2.2.2.2.1.1.4" xref="S4.E15.m1.2.2.2.2.1.1.4.cmml">τ</mi></mrow><mo id="S4.E15.m1.2.2.2.2.1.3" maxsize="160%" minsize="160%" xref="S4.E15.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S4.E15.m1.4.4.4" xref="S4.E15.m1.4.4.4.cmml"><msub id="S4.E15.m1.4.4.4.3" xref="S4.E15.m1.4.4.4.3.cmml"><mo id="S4.E15.m1.4.4.4.3.2" xref="S4.E15.m1.4.4.4.3.2.cmml">∑</mo><mrow id="S4.E15.m1.4.4.4.3.3" xref="S4.E15.m1.4.4.4.3.3.cmml"><mi id="S4.E15.m1.4.4.4.3.3.2" xref="S4.E15.m1.4.4.4.3.3.2.cmml">v</mi><mo id="S4.E15.m1.4.4.4.3.3.1" xref="S4.E15.m1.4.4.4.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E15.m1.4.4.4.3.3.3" xref="S4.E15.m1.4.4.4.3.3.3.cmml">𝒰</mi></mrow></msub><mrow id="S4.E15.m1.4.4.4.2.1" xref="S4.E15.m1.4.4.4.2.2.cmml"><mi id="S4.E15.m1.3.3.3.1" xref="S4.E15.m1.3.3.3.1.cmml">exp</mi><mo id="S4.E15.m1.4.4.4.2.1a" xref="S4.E15.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S4.E15.m1.4.4.4.2.1.1" xref="S4.E15.m1.4.4.4.2.2.cmml"><mo id="S4.E15.m1.4.4.4.2.1.1.2" maxsize="160%" minsize="160%" xref="S4.E15.m1.4.4.4.2.2.cmml">(</mo><mrow id="S4.E15.m1.4.4.4.2.1.1.1" xref="S4.E15.m1.4.4.4.2.1.1.1.cmml"><mrow id="S4.E15.m1.4.4.4.2.1.1.1.2" xref="S4.E15.m1.4.4.4.2.1.1.1.2.cmml"><mtext id="S4.E15.m1.4.4.4.2.1.1.1.2.4" xref="S4.E15.m1.4.4.4.2.1.1.1.2.4a.cmml">sim</mtext><mo id="S4.E15.m1.4.4.4.2.1.1.1.2.3" xref="S4.E15.m1.4.4.4.2.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.3.cmml"><mo id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.3" maxsize="160%" minsize="160%" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.2.2" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml">E</mi><mi id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.3" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml">v</mi><mn id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.2.3" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml">0</mn></msubsup><mo id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.4" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mi id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.2.2" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml">E</mi><mi id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.3" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml">u</mi><mn id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.2.3" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.5" maxsize="160%" minsize="160%" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E15.m1.4.4.4.2.1.1.1.3" xref="S4.E15.m1.4.4.4.2.1.1.1.3.cmml">/</mo><mi id="S4.E15.m1.4.4.4.2.1.1.1.4" xref="S4.E15.m1.4.4.4.2.1.1.1.4.cmml">τ</mi></mrow><mo id="S4.E15.m1.4.4.4.2.1.1.3" maxsize="160%" minsize="160%" xref="S4.E15.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S4.E15.m1.5.5.1.2" xref="S4.E15.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.5b"><apply id="S4.E15.m1.5.5.1.1.cmml" xref="S4.E15.m1.5.5.1"><eq id="S4.E15.m1.5.5.1.1.1.cmml" xref="S4.E15.m1.5.5.1.1.1"></eq><apply id="S4.E15.m1.5.5.1.1.2.cmml" xref="S4.E15.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.5.5.1.1.2.1.cmml" xref="S4.E15.m1.5.5.1.1.2">subscript</csymbol><apply id="S4.E15.m1.5.5.1.1.2.2.cmml" xref="S4.E15.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.5.5.1.1.2.2.1.cmml" xref="S4.E15.m1.5.5.1.1.2">superscript</csymbol><ci id="S4.E15.m1.5.5.1.1.2.2.2.cmml" xref="S4.E15.m1.5.5.1.1.2.2.2">ℒ</ci><ci id="S4.E15.m1.5.5.1.1.2.2.3.cmml" xref="S4.E15.m1.5.5.1.1.2.2.3">𝑢</ci></apply><cn id="S4.E15.m1.5.5.1.1.2.3.cmml" type="integer" xref="S4.E15.m1.5.5.1.1.2.3">1</cn></apply><apply id="S4.E15.m1.5.5.1.1.3.cmml" xref="S4.E15.m1.5.5.1.1.3"><minus id="S4.E15.m1.5.5.1.1.3.1.cmml" xref="S4.E15.m1.5.5.1.1.3"></minus><apply id="S4.E15.m1.5.5.1.1.3.2.cmml" xref="S4.E15.m1.5.5.1.1.3.2"><log id="S4.E15.m1.5.5.1.1.3.2.1.cmml" xref="S4.E15.m1.5.5.1.1.3.2.1"></log><apply id="S4.E15.m1.4.4.cmml" xref="S4.E15.m1.4.4"><divide id="S4.E15.m1.4.4.5.cmml" xref="S4.E15.m1.4.4"></divide><apply id="S4.E15.m1.2.2.2.3.cmml" xref="S4.E15.m1.2.2.2.2"><exp id="S4.E15.m1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1"></exp><apply id="S4.E15.m1.2.2.2.2.1.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1"><divide id="S4.E15.m1.2.2.2.2.1.1.3.cmml" xref="S4.E15.m1.2.2.2.2.1.1.3"></divide><apply id="S4.E15.m1.2.2.2.2.1.1.2.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2"><times id="S4.E15.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.3"></times><ci id="S4.E15.m1.2.2.2.2.1.1.2.4a.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.4"><mtext id="S4.E15.m1.2.2.2.2.1.1.2.4.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E15.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2"><apply id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.2.2.2.2.1.1.1.1.1.1.3">𝑢</ci></apply><apply id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.2.3">2</cn></apply><ci id="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="S4.E15.m1.2.2.2.2.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply><ci id="S4.E15.m1.2.2.2.2.1.1.4.cmml" xref="S4.E15.m1.2.2.2.2.1.1.4">𝜏</ci></apply></apply><apply id="S4.E15.m1.4.4.4.cmml" xref="S4.E15.m1.4.4.4"><apply id="S4.E15.m1.4.4.4.3.cmml" xref="S4.E15.m1.4.4.4.3"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.3.1.cmml" xref="S4.E15.m1.4.4.4.3">subscript</csymbol><sum id="S4.E15.m1.4.4.4.3.2.cmml" xref="S4.E15.m1.4.4.4.3.2"></sum><apply id="S4.E15.m1.4.4.4.3.3.cmml" xref="S4.E15.m1.4.4.4.3.3"><in id="S4.E15.m1.4.4.4.3.3.1.cmml" xref="S4.E15.m1.4.4.4.3.3.1"></in><ci id="S4.E15.m1.4.4.4.3.3.2.cmml" xref="S4.E15.m1.4.4.4.3.3.2">𝑣</ci><ci id="S4.E15.m1.4.4.4.3.3.3.cmml" xref="S4.E15.m1.4.4.4.3.3.3">𝒰</ci></apply></apply><apply id="S4.E15.m1.4.4.4.2.2.cmml" xref="S4.E15.m1.4.4.4.2.1"><exp id="S4.E15.m1.3.3.3.1.cmml" xref="S4.E15.m1.3.3.3.1"></exp><apply id="S4.E15.m1.4.4.4.2.1.1.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1"><divide id="S4.E15.m1.4.4.4.2.1.1.1.3.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.3"></divide><apply id="S4.E15.m1.4.4.4.2.1.1.1.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2"><times id="S4.E15.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2.3"></times><ci id="S4.E15.m1.4.4.4.2.1.1.1.2.4a.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2.4"><mtext id="S4.E15.m1.4.4.4.2.1.1.1.2.4.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2.4">sim</mtext></ci><interval closure="open" id="S4.E15.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2"><apply id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.2.2">𝐸</ci><cn id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.2.3">0</cn></apply><ci id="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.1.1.1.1.3">𝑣</ci></apply><apply id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.2.2">𝐸</ci><cn id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.2.3">2</cn></apply><ci id="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.2.2.2.2.3">𝑢</ci></apply></interval></apply><ci id="S4.E15.m1.4.4.4.2.1.1.1.4.cmml" xref="S4.E15.m1.4.4.4.2.1.1.1.4">𝜏</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.5c">\mathcal{L}^{u}_{1}=-\log\frac{\exp\Big{(}\text{sim}\Big{(}E^{0}_{u},E^{2}_{u}%
\Big{)}/\tau\Big{)}}{\sum_{v\in\mathcal{U}}\exp\Big{(}\text{sim}\Big{(}E^{0}_{%
v},E^{2}_{u}\Big{)}/\tau\Big{)}},</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.5d">caligraphic_L start_POSTSUPERSCRIPT italic_u end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = - roman_log divide start_ARG roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) / italic_τ ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_v ∈ caligraphic_U end_POSTSUBSCRIPT roman_exp ( sim ( italic_E start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT , italic_E start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT ) / italic_τ ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Q_{u}^{2}=Update(Q_{u}^{2},f_{k}(x_{u}^{2}))" class="ltx_Math" display="block" id="S4.E16.m1.2"><semantics id="S4.E16.m1.2a"><mrow id="S4.E16.m1.2.2" xref="S4.E16.m1.2.2.cmml"><msubsup id="S4.E16.m1.2.2.4" xref="S4.E16.m1.2.2.4.cmml"><mi id="S4.E16.m1.2.2.4.2.2" xref="S4.E16.m1.2.2.4.2.2.cmml">Q</mi><mi id="S4.E16.m1.2.2.4.2.3" xref="S4.E16.m1.2.2.4.2.3.cmml">u</mi><mn id="S4.E16.m1.2.2.4.3" xref="S4.E16.m1.2.2.4.3.cmml">2</mn></msubsup><mo id="S4.E16.m1.2.2.3" xref="S4.E16.m1.2.2.3.cmml">=</mo><mrow id="S4.E16.m1.2.2.2" xref="S4.E16.m1.2.2.2.cmml"><mi id="S4.E16.m1.2.2.2.4" xref="S4.E16.m1.2.2.2.4.cmml">U</mi><mo id="S4.E16.m1.2.2.2.3" xref="S4.E16.m1.2.2.2.3.cmml">⁢</mo><mi id="S4.E16.m1.2.2.2.5" xref="S4.E16.m1.2.2.2.5.cmml">p</mi><mo id="S4.E16.m1.2.2.2.3a" xref="S4.E16.m1.2.2.2.3.cmml">⁢</mo><mi id="S4.E16.m1.2.2.2.6" xref="S4.E16.m1.2.2.2.6.cmml">d</mi><mo id="S4.E16.m1.2.2.2.3b" xref="S4.E16.m1.2.2.2.3.cmml">⁢</mo><mi id="S4.E16.m1.2.2.2.7" xref="S4.E16.m1.2.2.2.7.cmml">a</mi><mo id="S4.E16.m1.2.2.2.3c" xref="S4.E16.m1.2.2.2.3.cmml">⁢</mo><mi id="S4.E16.m1.2.2.2.8" xref="S4.E16.m1.2.2.2.8.cmml">t</mi><mo id="S4.E16.m1.2.2.2.3d" xref="S4.E16.m1.2.2.2.3.cmml">⁢</mo><mi id="S4.E16.m1.2.2.2.9" xref="S4.E16.m1.2.2.2.9.cmml">e</mi><mo id="S4.E16.m1.2.2.2.3e" xref="S4.E16.m1.2.2.2.3.cmml">⁢</mo><mrow id="S4.E16.m1.2.2.2.2.2" xref="S4.E16.m1.2.2.2.2.3.cmml"><mo id="S4.E16.m1.2.2.2.2.2.3" stretchy="false" xref="S4.E16.m1.2.2.2.2.3.cmml">(</mo><msubsup id="S4.E16.m1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.cmml"><mi id="S4.E16.m1.1.1.1.1.1.1.2.2" xref="S4.E16.m1.1.1.1.1.1.1.2.2.cmml">Q</mi><mi id="S4.E16.m1.1.1.1.1.1.1.2.3" xref="S4.E16.m1.1.1.1.1.1.1.2.3.cmml">u</mi><mn id="S4.E16.m1.1.1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.1.1.3.cmml">2</mn></msubsup><mo id="S4.E16.m1.2.2.2.2.2.4" xref="S4.E16.m1.2.2.2.2.3.cmml">,</mo><mrow id="S4.E16.m1.2.2.2.2.2.2" xref="S4.E16.m1.2.2.2.2.2.2.cmml"><msub id="S4.E16.m1.2.2.2.2.2.2.3" xref="S4.E16.m1.2.2.2.2.2.2.3.cmml"><mi id="S4.E16.m1.2.2.2.2.2.2.3.2" xref="S4.E16.m1.2.2.2.2.2.2.3.2.cmml">f</mi><mi id="S4.E16.m1.2.2.2.2.2.2.3.3" xref="S4.E16.m1.2.2.2.2.2.2.3.3.cmml">k</mi></msub><mo id="S4.E16.m1.2.2.2.2.2.2.2" xref="S4.E16.m1.2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.E16.m1.2.2.2.2.2.2.1.1" xref="S4.E16.m1.2.2.2.2.2.2.1.1.1.cmml"><mo id="S4.E16.m1.2.2.2.2.2.2.1.1.2" stretchy="false" xref="S4.E16.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S4.E16.m1.2.2.2.2.2.2.1.1.1" xref="S4.E16.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E16.m1.2.2.2.2.2.2.1.1.1.2.2" xref="S4.E16.m1.2.2.2.2.2.2.1.1.1.2.2.cmml">x</mi><mi id="S4.E16.m1.2.2.2.2.2.2.1.1.1.2.3" xref="S4.E16.m1.2.2.2.2.2.2.1.1.1.2.3.cmml">u</mi><mn id="S4.E16.m1.2.2.2.2.2.2.1.1.1.3" xref="S4.E16.m1.2.2.2.2.2.2.1.1.1.3.cmml">2</mn></msubsup><mo id="S4.E16.m1.2.2.2.2.2.2.1.1.3" stretchy="false" xref="S4.E16.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E16.m1.2.2.2.2.2.5" stretchy="false" xref="S4.E16.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.2b"><apply id="S4.E16.m1.2.2.cmml" xref="S4.E16.m1.2.2"><eq id="S4.E16.m1.2.2.3.cmml" xref="S4.E16.m1.2.2.3"></eq><apply id="S4.E16.m1.2.2.4.cmml" xref="S4.E16.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E16.m1.2.2.4.1.cmml" xref="S4.E16.m1.2.2.4">superscript</csymbol><apply id="S4.E16.m1.2.2.4.2.cmml" xref="S4.E16.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E16.m1.2.2.4.2.1.cmml" xref="S4.E16.m1.2.2.4">subscript</csymbol><ci id="S4.E16.m1.2.2.4.2.2.cmml" xref="S4.E16.m1.2.2.4.2.2">𝑄</ci><ci id="S4.E16.m1.2.2.4.2.3.cmml" xref="S4.E16.m1.2.2.4.2.3">𝑢</ci></apply><cn id="S4.E16.m1.2.2.4.3.cmml" type="integer" xref="S4.E16.m1.2.2.4.3">2</cn></apply><apply id="S4.E16.m1.2.2.2.cmml" xref="S4.E16.m1.2.2.2"><times id="S4.E16.m1.2.2.2.3.cmml" xref="S4.E16.m1.2.2.2.3"></times><ci id="S4.E16.m1.2.2.2.4.cmml" xref="S4.E16.m1.2.2.2.4">𝑈</ci><ci id="S4.E16.m1.2.2.2.5.cmml" xref="S4.E16.m1.2.2.2.5">𝑝</ci><ci id="S4.E16.m1.2.2.2.6.cmml" xref="S4.E16.m1.2.2.2.6">𝑑</ci><ci id="S4.E16.m1.2.2.2.7.cmml" xref="S4.E16.m1.2.2.2.7">𝑎</ci><ci id="S4.E16.m1.2.2.2.8.cmml" xref="S4.E16.m1.2.2.2.8">𝑡</ci><ci id="S4.E16.m1.2.2.2.9.cmml" xref="S4.E16.m1.2.2.2.9">𝑒</ci><interval closure="open" id="S4.E16.m1.2.2.2.2.3.cmml" xref="S4.E16.m1.2.2.2.2.2"><apply id="S4.E16.m1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E16.m1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E16.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.2.2">𝑄</ci><ci id="S4.E16.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.2.3">𝑢</ci></apply><cn id="S4.E16.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E16.m1.1.1.1.1.1.1.3">2</cn></apply><apply id="S4.E16.m1.2.2.2.2.2.2.cmml" xref="S4.E16.m1.2.2.2.2.2.2"><times id="S4.E16.m1.2.2.2.2.2.2.2.cmml" xref="S4.E16.m1.2.2.2.2.2.2.2"></times><apply id="S4.E16.m1.2.2.2.2.2.2.3.cmml" xref="S4.E16.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E16.m1.2.2.2.2.2.2.3.1.cmml" xref="S4.E16.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E16.m1.2.2.2.2.2.2.3.2.cmml" xref="S4.E16.m1.2.2.2.2.2.2.3.2">𝑓</ci><ci id="S4.E16.m1.2.2.2.2.2.2.3.3.cmml" xref="S4.E16.m1.2.2.2.2.2.2.3.3">𝑘</ci></apply><apply id="S4.E16.m1.2.2.2.2.2.2.1.1.1.cmml" xref="S4.E16.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E16.m1.2.2.2.2.2.2.1.1">superscript</csymbol><apply id="S4.E16.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E16.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E16.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.E16.m1.2.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E16.m1.2.2.2.2.2.2.1.1.1.2.2">𝑥</ci><ci id="S4.E16.m1.2.2.2.2.2.2.1.1.1.2.3.cmml" xref="S4.E16.m1.2.2.2.2.2.2.1.1.1.2.3">𝑢</ci></apply><cn id="S4.E16.m1.2.2.2.2.2.2.1.1.1.3.cmml" type="integer" xref="S4.E16.m1.2.2.2.2.2.2.1.1.1.3">2</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.2c">Q_{u}^{2}=Update(Q_{u}^{2},f_{k}(x_{u}^{2}))</annotation><annotation encoding="application/x-llamapun" id="S4.E16.m1.2d">italic_Q start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT = italic_U italic_p italic_d italic_a italic_t italic_e ( italic_Q start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , italic_f start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S4.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\theta_{k}=m\theta_{k}+(1-m)\theta_{q}" class="ltx_Math" display="block" id="S4.E17.m1.1"><semantics id="S4.E17.m1.1a"><mrow id="S4.E17.m1.1.1" xref="S4.E17.m1.1.1.cmml"><msub id="S4.E17.m1.1.1.3" xref="S4.E17.m1.1.1.3.cmml"><mi id="S4.E17.m1.1.1.3.2" xref="S4.E17.m1.1.1.3.2.cmml">θ</mi><mi id="S4.E17.m1.1.1.3.3" xref="S4.E17.m1.1.1.3.3.cmml">k</mi></msub><mo id="S4.E17.m1.1.1.2" xref="S4.E17.m1.1.1.2.cmml">=</mo><mrow id="S4.E17.m1.1.1.1" xref="S4.E17.m1.1.1.1.cmml"><mrow id="S4.E17.m1.1.1.1.3" xref="S4.E17.m1.1.1.1.3.cmml"><mi id="S4.E17.m1.1.1.1.3.2" xref="S4.E17.m1.1.1.1.3.2.cmml">m</mi><mo id="S4.E17.m1.1.1.1.3.1" xref="S4.E17.m1.1.1.1.3.1.cmml">⁢</mo><msub id="S4.E17.m1.1.1.1.3.3" xref="S4.E17.m1.1.1.1.3.3.cmml"><mi id="S4.E17.m1.1.1.1.3.3.2" xref="S4.E17.m1.1.1.1.3.3.2.cmml">θ</mi><mi id="S4.E17.m1.1.1.1.3.3.3" xref="S4.E17.m1.1.1.1.3.3.3.cmml">k</mi></msub></mrow><mo id="S4.E17.m1.1.1.1.2" xref="S4.E17.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E17.m1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.cmml"><mrow id="S4.E17.m1.1.1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E17.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E17.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E17.m1.1.1.1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.1.1.1.cmml"><mn id="S4.E17.m1.1.1.1.1.1.1.1.2" xref="S4.E17.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E17.m1.1.1.1.1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E17.m1.1.1.1.1.1.1.1.3" xref="S4.E17.m1.1.1.1.1.1.1.1.3.cmml">m</mi></mrow><mo id="S4.E17.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E17.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E17.m1.1.1.1.1.2" xref="S4.E17.m1.1.1.1.1.2.cmml">⁢</mo><msub id="S4.E17.m1.1.1.1.1.3" xref="S4.E17.m1.1.1.1.1.3.cmml"><mi id="S4.E17.m1.1.1.1.1.3.2" xref="S4.E17.m1.1.1.1.1.3.2.cmml">θ</mi><mi id="S4.E17.m1.1.1.1.1.3.3" xref="S4.E17.m1.1.1.1.1.3.3.cmml">q</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E17.m1.1b"><apply id="S4.E17.m1.1.1.cmml" xref="S4.E17.m1.1.1"><eq id="S4.E17.m1.1.1.2.cmml" xref="S4.E17.m1.1.1.2"></eq><apply id="S4.E17.m1.1.1.3.cmml" xref="S4.E17.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E17.m1.1.1.3.1.cmml" xref="S4.E17.m1.1.1.3">subscript</csymbol><ci id="S4.E17.m1.1.1.3.2.cmml" xref="S4.E17.m1.1.1.3.2">𝜃</ci><ci id="S4.E17.m1.1.1.3.3.cmml" xref="S4.E17.m1.1.1.3.3">𝑘</ci></apply><apply id="S4.E17.m1.1.1.1.cmml" xref="S4.E17.m1.1.1.1"><plus id="S4.E17.m1.1.1.1.2.cmml" xref="S4.E17.m1.1.1.1.2"></plus><apply id="S4.E17.m1.1.1.1.3.cmml" xref="S4.E17.m1.1.1.1.3"><times id="S4.E17.m1.1.1.1.3.1.cmml" xref="S4.E17.m1.1.1.1.3.1"></times><ci id="S4.E17.m1.1.1.1.3.2.cmml" xref="S4.E17.m1.1.1.1.3.2">𝑚</ci><apply id="S4.E17.m1.1.1.1.3.3.cmml" xref="S4.E17.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E17.m1.1.1.1.3.3.1.cmml" xref="S4.E17.m1.1.1.1.3.3">subscript</csymbol><ci id="S4.E17.m1.1.1.1.3.3.2.cmml" xref="S4.E17.m1.1.1.1.3.3.2">𝜃</ci><ci id="S4.E17.m1.1.1.1.3.3.3.cmml" xref="S4.E17.m1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S4.E17.m1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1.1"><times id="S4.E17.m1.1.1.1.1.2.cmml" xref="S4.E17.m1.1.1.1.1.2"></times><apply id="S4.E17.m1.1.1.1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1.1.1.1"><minus id="S4.E17.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.1"></minus><cn id="S4.E17.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.E17.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S4.E17.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.3">𝑚</ci></apply><apply id="S4.E17.m1.1.1.1.1.3.cmml" xref="S4.E17.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E17.m1.1.1.1.1.3.1.cmml" xref="S4.E17.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E17.m1.1.1.1.1.3.2.cmml" xref="S4.E17.m1.1.1.1.1.3.2">𝜃</ci><ci id="S4.E17.m1.1.1.1.1.3.3.cmml" xref="S4.E17.m1.1.1.1.1.3.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E17.m1.1c">\theta_{k}=m\theta_{k}+(1-m)\theta_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.E17.m1.1d">italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = italic_m italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + ( 1 - italic_m ) italic_θ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS4.p3.6">Wherein, <math alttext="\theta_{k}" class="ltx_Math" display="inline" id="S4.SS4.p3.1.m1.1"><semantics id="S4.SS4.p3.1.m1.1a"><msub id="S4.SS4.p3.1.m1.1.1" xref="S4.SS4.p3.1.m1.1.1.cmml"><mi id="S4.SS4.p3.1.m1.1.1.2" xref="S4.SS4.p3.1.m1.1.1.2.cmml">θ</mi><mi id="S4.SS4.p3.1.m1.1.1.3" xref="S4.SS4.p3.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.1b"><apply id="S4.SS4.p3.1.m1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p3.1.m1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.1.1.2">𝜃</ci><ci id="S4.SS4.p3.1.m1.1.1.3.cmml" xref="S4.SS4.p3.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.1c">\theta_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.1.m1.1d">italic_θ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> updates its parameters solely based on Eq(<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.E17" title="In IV-D MoCo-based Dynamic Queue Storage ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">17</span></a>), whereas <math alttext="\theta_{q}" class="ltx_Math" display="inline" id="S4.SS4.p3.2.m2.1"><semantics id="S4.SS4.p3.2.m2.1a"><msub id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml"><mi id="S4.SS4.p3.2.m2.1.1.2" xref="S4.SS4.p3.2.m2.1.1.2.cmml">θ</mi><mi id="S4.SS4.p3.2.m2.1.1.3" xref="S4.SS4.p3.2.m2.1.1.3.cmml">q</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><apply id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.2.m2.1.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p3.2.m2.1.1.2.cmml" xref="S4.SS4.p3.2.m2.1.1.2">𝜃</ci><ci id="S4.SS4.p3.2.m2.1.1.3.cmml" xref="S4.SS4.p3.2.m2.1.1.3">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">\theta_{q}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.2.m2.1d">italic_θ start_POSTSUBSCRIPT italic_q end_POSTSUBSCRIPT</annotation></semantics></math> employs gradient backpropagation for parameter updates, with <math alttext="m" class="ltx_Math" display="inline" id="S4.SS4.p3.3.m3.1"><semantics id="S4.SS4.p3.3.m3.1a"><mi id="S4.SS4.p3.3.m3.1.1" xref="S4.SS4.p3.3.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.1b"><ci id="S4.SS4.p3.3.m3.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.1c">m</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.3.m3.1d">italic_m</annotation></semantics></math> representing the momentum coefficient. <math alttext="E_{u}^{0}" class="ltx_Math" display="inline" id="S4.SS4.p3.4.m4.1"><semantics id="S4.SS4.p3.4.m4.1a"><msubsup id="S4.SS4.p3.4.m4.1.1" xref="S4.SS4.p3.4.m4.1.1.cmml"><mi id="S4.SS4.p3.4.m4.1.1.2.2" xref="S4.SS4.p3.4.m4.1.1.2.2.cmml">E</mi><mi id="S4.SS4.p3.4.m4.1.1.2.3" xref="S4.SS4.p3.4.m4.1.1.2.3.cmml">u</mi><mn id="S4.SS4.p3.4.m4.1.1.3" xref="S4.SS4.p3.4.m4.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.4.m4.1b"><apply id="S4.SS4.p3.4.m4.1.1.cmml" xref="S4.SS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.4.m4.1.1.1.cmml" xref="S4.SS4.p3.4.m4.1.1">superscript</csymbol><apply id="S4.SS4.p3.4.m4.1.1.2.cmml" xref="S4.SS4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.4.m4.1.1.2.1.cmml" xref="S4.SS4.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p3.4.m4.1.1.2.2.cmml" xref="S4.SS4.p3.4.m4.1.1.2.2">𝐸</ci><ci id="S4.SS4.p3.4.m4.1.1.2.3.cmml" xref="S4.SS4.p3.4.m4.1.1.2.3">𝑢</ci></apply><cn id="S4.SS4.p3.4.m4.1.1.3.cmml" type="integer" xref="S4.SS4.p3.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.4.m4.1c">E_{u}^{0}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.4.m4.1d">italic_E start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 0 end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="E_{u}^{2}" class="ltx_Math" display="inline" id="S4.SS4.p3.5.m5.1"><semantics id="S4.SS4.p3.5.m5.1a"><msubsup id="S4.SS4.p3.5.m5.1.1" xref="S4.SS4.p3.5.m5.1.1.cmml"><mi id="S4.SS4.p3.5.m5.1.1.2.2" xref="S4.SS4.p3.5.m5.1.1.2.2.cmml">E</mi><mi id="S4.SS4.p3.5.m5.1.1.2.3" xref="S4.SS4.p3.5.m5.1.1.2.3.cmml">u</mi><mn id="S4.SS4.p3.5.m5.1.1.3" xref="S4.SS4.p3.5.m5.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.5.m5.1b"><apply id="S4.SS4.p3.5.m5.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.5.m5.1.1.1.cmml" xref="S4.SS4.p3.5.m5.1.1">superscript</csymbol><apply id="S4.SS4.p3.5.m5.1.1.2.cmml" xref="S4.SS4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.5.m5.1.1.2.1.cmml" xref="S4.SS4.p3.5.m5.1.1">subscript</csymbol><ci id="S4.SS4.p3.5.m5.1.1.2.2.cmml" xref="S4.SS4.p3.5.m5.1.1.2.2">𝐸</ci><ci id="S4.SS4.p3.5.m5.1.1.2.3.cmml" xref="S4.SS4.p3.5.m5.1.1.2.3">𝑢</ci></apply><cn id="S4.SS4.p3.5.m5.1.1.3.cmml" type="integer" xref="S4.SS4.p3.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.5.m5.1c">E_{u}^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.5.m5.1d">italic_E start_POSTSUBSCRIPT italic_u end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> are positive sample pairs, <math alttext="E_{v}^{2}" class="ltx_Math" display="inline" id="S4.SS4.p3.6.m6.1"><semantics id="S4.SS4.p3.6.m6.1a"><msubsup id="S4.SS4.p3.6.m6.1.1" xref="S4.SS4.p3.6.m6.1.1.cmml"><mi id="S4.SS4.p3.6.m6.1.1.2.2" xref="S4.SS4.p3.6.m6.1.1.2.2.cmml">E</mi><mi id="S4.SS4.p3.6.m6.1.1.2.3" xref="S4.SS4.p3.6.m6.1.1.2.3.cmml">v</mi><mn id="S4.SS4.p3.6.m6.1.1.3" xref="S4.SS4.p3.6.m6.1.1.3.cmml">2</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.6.m6.1b"><apply id="S4.SS4.p3.6.m6.1.1.cmml" xref="S4.SS4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.6.m6.1.1.1.cmml" xref="S4.SS4.p3.6.m6.1.1">superscript</csymbol><apply id="S4.SS4.p3.6.m6.1.1.2.cmml" xref="S4.SS4.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.6.m6.1.1.2.1.cmml" xref="S4.SS4.p3.6.m6.1.1">subscript</csymbol><ci id="S4.SS4.p3.6.m6.1.1.2.2.cmml" xref="S4.SS4.p3.6.m6.1.1.2.2">𝐸</ci><ci id="S4.SS4.p3.6.m6.1.1.2.3.cmml" xref="S4.SS4.p3.6.m6.1.1.2.3">𝑣</ci></apply><cn id="S4.SS4.p3.6.m6.1.1.3.cmml" type="integer" xref="S4.SS4.p3.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.6.m6.1c">E_{v}^{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p3.6.m6.1d">italic_E start_POSTSUBSCRIPT italic_v end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math> is negative samples.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S4.SS5.5.1.1">IV-E</span> </span><span class="ltx_text ltx_font_italic" id="S4.SS5.6.2">Optimization</span>
</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.6">In our approach, the three contrastive learning losses are treated as auxiliary losses. These are integrated with CE loss for joint optimization. the comprehensive loss function is formulated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{GAL}=\mathcal{L}_{0}+\lambda_{1}\mathcal{L}_{1}+\lambda_{2}%
\mathcal{L}_{2}+\lambda_{3}\mathcal{L}_{3}+\lambda_{4}||\Theta||^{2}_{2}" class="ltx_Math" display="block" id="S4.E18.m1.1"><semantics id="S4.E18.m1.1a"><mrow id="S4.E18.m1.1.2" xref="S4.E18.m1.1.2.cmml"><msub id="S4.E18.m1.1.2.2" xref="S4.E18.m1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E18.m1.1.2.2.2" xref="S4.E18.m1.1.2.2.2.cmml">ℒ</mi><mrow id="S4.E18.m1.1.2.2.3" xref="S4.E18.m1.1.2.2.3.cmml"><mi id="S4.E18.m1.1.2.2.3.2" xref="S4.E18.m1.1.2.2.3.2.cmml">G</mi><mo id="S4.E18.m1.1.2.2.3.1" xref="S4.E18.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.1.2.2.3.3" xref="S4.E18.m1.1.2.2.3.3.cmml">A</mi><mo id="S4.E18.m1.1.2.2.3.1a" xref="S4.E18.m1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.1.2.2.3.4" xref="S4.E18.m1.1.2.2.3.4.cmml">L</mi></mrow></msub><mo id="S4.E18.m1.1.2.1" xref="S4.E18.m1.1.2.1.cmml">=</mo><mrow id="S4.E18.m1.1.2.3" xref="S4.E18.m1.1.2.3.cmml"><msub id="S4.E18.m1.1.2.3.2" xref="S4.E18.m1.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E18.m1.1.2.3.2.2" xref="S4.E18.m1.1.2.3.2.2.cmml">ℒ</mi><mn id="S4.E18.m1.1.2.3.2.3" xref="S4.E18.m1.1.2.3.2.3.cmml">0</mn></msub><mo id="S4.E18.m1.1.2.3.1" xref="S4.E18.m1.1.2.3.1.cmml">+</mo><mrow id="S4.E18.m1.1.2.3.3" xref="S4.E18.m1.1.2.3.3.cmml"><msub id="S4.E18.m1.1.2.3.3.2" xref="S4.E18.m1.1.2.3.3.2.cmml"><mi id="S4.E18.m1.1.2.3.3.2.2" xref="S4.E18.m1.1.2.3.3.2.2.cmml">λ</mi><mn id="S4.E18.m1.1.2.3.3.2.3" xref="S4.E18.m1.1.2.3.3.2.3.cmml">1</mn></msub><mo id="S4.E18.m1.1.2.3.3.1" xref="S4.E18.m1.1.2.3.3.1.cmml">⁢</mo><msub id="S4.E18.m1.1.2.3.3.3" xref="S4.E18.m1.1.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E18.m1.1.2.3.3.3.2" xref="S4.E18.m1.1.2.3.3.3.2.cmml">ℒ</mi><mn id="S4.E18.m1.1.2.3.3.3.3" xref="S4.E18.m1.1.2.3.3.3.3.cmml">1</mn></msub></mrow><mo id="S4.E18.m1.1.2.3.1a" xref="S4.E18.m1.1.2.3.1.cmml">+</mo><mrow id="S4.E18.m1.1.2.3.4" xref="S4.E18.m1.1.2.3.4.cmml"><msub id="S4.E18.m1.1.2.3.4.2" xref="S4.E18.m1.1.2.3.4.2.cmml"><mi id="S4.E18.m1.1.2.3.4.2.2" xref="S4.E18.m1.1.2.3.4.2.2.cmml">λ</mi><mn id="S4.E18.m1.1.2.3.4.2.3" xref="S4.E18.m1.1.2.3.4.2.3.cmml">2</mn></msub><mo id="S4.E18.m1.1.2.3.4.1" xref="S4.E18.m1.1.2.3.4.1.cmml">⁢</mo><msub id="S4.E18.m1.1.2.3.4.3" xref="S4.E18.m1.1.2.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E18.m1.1.2.3.4.3.2" xref="S4.E18.m1.1.2.3.4.3.2.cmml">ℒ</mi><mn id="S4.E18.m1.1.2.3.4.3.3" xref="S4.E18.m1.1.2.3.4.3.3.cmml">2</mn></msub></mrow><mo id="S4.E18.m1.1.2.3.1b" xref="S4.E18.m1.1.2.3.1.cmml">+</mo><mrow id="S4.E18.m1.1.2.3.5" xref="S4.E18.m1.1.2.3.5.cmml"><msub id="S4.E18.m1.1.2.3.5.2" xref="S4.E18.m1.1.2.3.5.2.cmml"><mi id="S4.E18.m1.1.2.3.5.2.2" xref="S4.E18.m1.1.2.3.5.2.2.cmml">λ</mi><mn id="S4.E18.m1.1.2.3.5.2.3" xref="S4.E18.m1.1.2.3.5.2.3.cmml">3</mn></msub><mo id="S4.E18.m1.1.2.3.5.1" xref="S4.E18.m1.1.2.3.5.1.cmml">⁢</mo><msub id="S4.E18.m1.1.2.3.5.3" xref="S4.E18.m1.1.2.3.5.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E18.m1.1.2.3.5.3.2" xref="S4.E18.m1.1.2.3.5.3.2.cmml">ℒ</mi><mn id="S4.E18.m1.1.2.3.5.3.3" xref="S4.E18.m1.1.2.3.5.3.3.cmml">3</mn></msub></mrow><mo id="S4.E18.m1.1.2.3.1c" xref="S4.E18.m1.1.2.3.1.cmml">+</mo><mrow id="S4.E18.m1.1.2.3.6" xref="S4.E18.m1.1.2.3.6.cmml"><msub id="S4.E18.m1.1.2.3.6.2" xref="S4.E18.m1.1.2.3.6.2.cmml"><mi id="S4.E18.m1.1.2.3.6.2.2" xref="S4.E18.m1.1.2.3.6.2.2.cmml">λ</mi><mn id="S4.E18.m1.1.2.3.6.2.3" xref="S4.E18.m1.1.2.3.6.2.3.cmml">4</mn></msub><mo id="S4.E18.m1.1.2.3.6.1" xref="S4.E18.m1.1.2.3.6.1.cmml">⁢</mo><msubsup id="S4.E18.m1.1.2.3.6.3" xref="S4.E18.m1.1.2.3.6.3.cmml"><mrow id="S4.E18.m1.1.2.3.6.3.2.2.2" xref="S4.E18.m1.1.2.3.6.3.2.2.1.cmml"><mo id="S4.E18.m1.1.2.3.6.3.2.2.2.1" stretchy="false" xref="S4.E18.m1.1.2.3.6.3.2.2.1.1.cmml">‖</mo><mi id="S4.E18.m1.1.1" mathvariant="normal" xref="S4.E18.m1.1.1.cmml">Θ</mi><mo id="S4.E18.m1.1.2.3.6.3.2.2.2.2" stretchy="false" xref="S4.E18.m1.1.2.3.6.3.2.2.1.1.cmml">‖</mo></mrow><mn id="S4.E18.m1.1.2.3.6.3.3" xref="S4.E18.m1.1.2.3.6.3.3.cmml">2</mn><mn id="S4.E18.m1.1.2.3.6.3.2.3" xref="S4.E18.m1.1.2.3.6.3.2.3.cmml">2</mn></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m1.1b"><apply id="S4.E18.m1.1.2.cmml" xref="S4.E18.m1.1.2"><eq id="S4.E18.m1.1.2.1.cmml" xref="S4.E18.m1.1.2.1"></eq><apply id="S4.E18.m1.1.2.2.cmml" xref="S4.E18.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.2.1.cmml" xref="S4.E18.m1.1.2.2">subscript</csymbol><ci id="S4.E18.m1.1.2.2.2.cmml" xref="S4.E18.m1.1.2.2.2">ℒ</ci><apply id="S4.E18.m1.1.2.2.3.cmml" xref="S4.E18.m1.1.2.2.3"><times id="S4.E18.m1.1.2.2.3.1.cmml" xref="S4.E18.m1.1.2.2.3.1"></times><ci id="S4.E18.m1.1.2.2.3.2.cmml" xref="S4.E18.m1.1.2.2.3.2">𝐺</ci><ci id="S4.E18.m1.1.2.2.3.3.cmml" xref="S4.E18.m1.1.2.2.3.3">𝐴</ci><ci id="S4.E18.m1.1.2.2.3.4.cmml" xref="S4.E18.m1.1.2.2.3.4">𝐿</ci></apply></apply><apply id="S4.E18.m1.1.2.3.cmml" xref="S4.E18.m1.1.2.3"><plus id="S4.E18.m1.1.2.3.1.cmml" xref="S4.E18.m1.1.2.3.1"></plus><apply id="S4.E18.m1.1.2.3.2.cmml" xref="S4.E18.m1.1.2.3.2"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.3.2.1.cmml" xref="S4.E18.m1.1.2.3.2">subscript</csymbol><ci id="S4.E18.m1.1.2.3.2.2.cmml" xref="S4.E18.m1.1.2.3.2.2">ℒ</ci><cn id="S4.E18.m1.1.2.3.2.3.cmml" type="integer" xref="S4.E18.m1.1.2.3.2.3">0</cn></apply><apply id="S4.E18.m1.1.2.3.3.cmml" xref="S4.E18.m1.1.2.3.3"><times id="S4.E18.m1.1.2.3.3.1.cmml" xref="S4.E18.m1.1.2.3.3.1"></times><apply id="S4.E18.m1.1.2.3.3.2.cmml" xref="S4.E18.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.3.3.2.1.cmml" xref="S4.E18.m1.1.2.3.3.2">subscript</csymbol><ci id="S4.E18.m1.1.2.3.3.2.2.cmml" xref="S4.E18.m1.1.2.3.3.2.2">𝜆</ci><cn id="S4.E18.m1.1.2.3.3.2.3.cmml" type="integer" xref="S4.E18.m1.1.2.3.3.2.3">1</cn></apply><apply id="S4.E18.m1.1.2.3.3.3.cmml" xref="S4.E18.m1.1.2.3.3.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.3.3.3.1.cmml" xref="S4.E18.m1.1.2.3.3.3">subscript</csymbol><ci id="S4.E18.m1.1.2.3.3.3.2.cmml" xref="S4.E18.m1.1.2.3.3.3.2">ℒ</ci><cn id="S4.E18.m1.1.2.3.3.3.3.cmml" type="integer" xref="S4.E18.m1.1.2.3.3.3.3">1</cn></apply></apply><apply id="S4.E18.m1.1.2.3.4.cmml" xref="S4.E18.m1.1.2.3.4"><times id="S4.E18.m1.1.2.3.4.1.cmml" xref="S4.E18.m1.1.2.3.4.1"></times><apply id="S4.E18.m1.1.2.3.4.2.cmml" xref="S4.E18.m1.1.2.3.4.2"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.3.4.2.1.cmml" xref="S4.E18.m1.1.2.3.4.2">subscript</csymbol><ci id="S4.E18.m1.1.2.3.4.2.2.cmml" xref="S4.E18.m1.1.2.3.4.2.2">𝜆</ci><cn id="S4.E18.m1.1.2.3.4.2.3.cmml" type="integer" xref="S4.E18.m1.1.2.3.4.2.3">2</cn></apply><apply id="S4.E18.m1.1.2.3.4.3.cmml" xref="S4.E18.m1.1.2.3.4.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.3.4.3.1.cmml" xref="S4.E18.m1.1.2.3.4.3">subscript</csymbol><ci id="S4.E18.m1.1.2.3.4.3.2.cmml" xref="S4.E18.m1.1.2.3.4.3.2">ℒ</ci><cn id="S4.E18.m1.1.2.3.4.3.3.cmml" type="integer" xref="S4.E18.m1.1.2.3.4.3.3">2</cn></apply></apply><apply id="S4.E18.m1.1.2.3.5.cmml" xref="S4.E18.m1.1.2.3.5"><times id="S4.E18.m1.1.2.3.5.1.cmml" xref="S4.E18.m1.1.2.3.5.1"></times><apply id="S4.E18.m1.1.2.3.5.2.cmml" xref="S4.E18.m1.1.2.3.5.2"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.3.5.2.1.cmml" xref="S4.E18.m1.1.2.3.5.2">subscript</csymbol><ci id="S4.E18.m1.1.2.3.5.2.2.cmml" xref="S4.E18.m1.1.2.3.5.2.2">𝜆</ci><cn id="S4.E18.m1.1.2.3.5.2.3.cmml" type="integer" xref="S4.E18.m1.1.2.3.5.2.3">3</cn></apply><apply id="S4.E18.m1.1.2.3.5.3.cmml" xref="S4.E18.m1.1.2.3.5.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.3.5.3.1.cmml" xref="S4.E18.m1.1.2.3.5.3">subscript</csymbol><ci id="S4.E18.m1.1.2.3.5.3.2.cmml" xref="S4.E18.m1.1.2.3.5.3.2">ℒ</ci><cn id="S4.E18.m1.1.2.3.5.3.3.cmml" type="integer" xref="S4.E18.m1.1.2.3.5.3.3">3</cn></apply></apply><apply id="S4.E18.m1.1.2.3.6.cmml" xref="S4.E18.m1.1.2.3.6"><times id="S4.E18.m1.1.2.3.6.1.cmml" xref="S4.E18.m1.1.2.3.6.1"></times><apply id="S4.E18.m1.1.2.3.6.2.cmml" xref="S4.E18.m1.1.2.3.6.2"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.3.6.2.1.cmml" xref="S4.E18.m1.1.2.3.6.2">subscript</csymbol><ci id="S4.E18.m1.1.2.3.6.2.2.cmml" xref="S4.E18.m1.1.2.3.6.2.2">𝜆</ci><cn id="S4.E18.m1.1.2.3.6.2.3.cmml" type="integer" xref="S4.E18.m1.1.2.3.6.2.3">4</cn></apply><apply id="S4.E18.m1.1.2.3.6.3.cmml" xref="S4.E18.m1.1.2.3.6.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.3.6.3.1.cmml" xref="S4.E18.m1.1.2.3.6.3">subscript</csymbol><apply id="S4.E18.m1.1.2.3.6.3.2.cmml" xref="S4.E18.m1.1.2.3.6.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.2.3.6.3.2.1.cmml" xref="S4.E18.m1.1.2.3.6.3">superscript</csymbol><apply id="S4.E18.m1.1.2.3.6.3.2.2.1.cmml" xref="S4.E18.m1.1.2.3.6.3.2.2.2"><csymbol cd="latexml" id="S4.E18.m1.1.2.3.6.3.2.2.1.1.cmml" xref="S4.E18.m1.1.2.3.6.3.2.2.2.1">norm</csymbol><ci id="S4.E18.m1.1.1.cmml" xref="S4.E18.m1.1.1">Θ</ci></apply><cn id="S4.E18.m1.1.2.3.6.3.2.3.cmml" type="integer" xref="S4.E18.m1.1.2.3.6.3.2.3">2</cn></apply><cn id="S4.E18.m1.1.2.3.6.3.3.cmml" type="integer" xref="S4.E18.m1.1.2.3.6.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E18.m1.1c">\mathcal{L}_{GAL}=\mathcal{L}_{0}+\lambda_{1}\mathcal{L}_{1}+\lambda_{2}%
\mathcal{L}_{2}+\lambda_{3}\mathcal{L}_{3}+\lambda_{4}||\Theta||^{2}_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.E18.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_G italic_A italic_L end_POSTSUBSCRIPT = caligraphic_L start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT + italic_λ start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT | | roman_Θ | | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS5.p1.5">where <math alttext="\lambda_{1}" class="ltx_Math" display="inline" id="S4.SS5.p1.1.m1.1"><semantics id="S4.SS5.p1.1.m1.1a"><msub id="S4.SS5.p1.1.m1.1.1" xref="S4.SS5.p1.1.m1.1.1.cmml"><mi id="S4.SS5.p1.1.m1.1.1.2" xref="S4.SS5.p1.1.m1.1.1.2.cmml">λ</mi><mn id="S4.SS5.p1.1.m1.1.1.3" xref="S4.SS5.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.1.m1.1b"><apply id="S4.SS5.p1.1.m1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.1.m1.1.1.1.cmml" xref="S4.SS5.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS5.p1.1.m1.1.1.2.cmml" xref="S4.SS5.p1.1.m1.1.1.2">𝜆</ci><cn id="S4.SS5.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS5.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.1.m1.1c">\lambda_{1}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>,<math alttext="\lambda_{2}" class="ltx_Math" display="inline" id="S4.SS5.p1.2.m2.1"><semantics id="S4.SS5.p1.2.m2.1a"><msub id="S4.SS5.p1.2.m2.1.1" xref="S4.SS5.p1.2.m2.1.1.cmml"><mi id="S4.SS5.p1.2.m2.1.1.2" xref="S4.SS5.p1.2.m2.1.1.2.cmml">λ</mi><mn id="S4.SS5.p1.2.m2.1.1.3" xref="S4.SS5.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.2.m2.1b"><apply id="S4.SS5.p1.2.m2.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.2.m2.1.1.1.cmml" xref="S4.SS5.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS5.p1.2.m2.1.1.2.cmml" xref="S4.SS5.p1.2.m2.1.1.2">𝜆</ci><cn id="S4.SS5.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS5.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.2.m2.1c">\lambda_{2}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.2.m2.1d">italic_λ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\lambda_{3}" class="ltx_Math" display="inline" id="S4.SS5.p1.3.m3.1"><semantics id="S4.SS5.p1.3.m3.1a"><msub id="S4.SS5.p1.3.m3.1.1" xref="S4.SS5.p1.3.m3.1.1.cmml"><mi id="S4.SS5.p1.3.m3.1.1.2" xref="S4.SS5.p1.3.m3.1.1.2.cmml">λ</mi><mn id="S4.SS5.p1.3.m3.1.1.3" xref="S4.SS5.p1.3.m3.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.3.m3.1b"><apply id="S4.SS5.p1.3.m3.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.3.m3.1.1.1.cmml" xref="S4.SS5.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS5.p1.3.m3.1.1.2.cmml" xref="S4.SS5.p1.3.m3.1.1.2">𝜆</ci><cn id="S4.SS5.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS5.p1.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.3.m3.1c">\lambda_{3}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.3.m3.1d">italic_λ start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT</annotation></semantics></math> are hyperparameters to control the weights of three contrastive learning losses, respectively. Besides, <math alttext="\lambda_{4}" class="ltx_Math" display="inline" id="S4.SS5.p1.4.m4.1"><semantics id="S4.SS5.p1.4.m4.1a"><msub id="S4.SS5.p1.4.m4.1.1" xref="S4.SS5.p1.4.m4.1.1.cmml"><mi id="S4.SS5.p1.4.m4.1.1.2" xref="S4.SS5.p1.4.m4.1.1.2.cmml">λ</mi><mn id="S4.SS5.p1.4.m4.1.1.3" xref="S4.SS5.p1.4.m4.1.1.3.cmml">4</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.4.m4.1b"><apply id="S4.SS5.p1.4.m4.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS5.p1.4.m4.1.1.1.cmml" xref="S4.SS5.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS5.p1.4.m4.1.1.2.cmml" xref="S4.SS5.p1.4.m4.1.1.2">𝜆</ci><cn id="S4.SS5.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS5.p1.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.4.m4.1c">\lambda_{4}</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.4.m4.1d">italic_λ start_POSTSUBSCRIPT 4 end_POSTSUBSCRIPT</annotation></semantics></math> is the regularization coefficient, and <math alttext="\Theta" class="ltx_Math" display="inline" id="S4.SS5.p1.5.m5.1"><semantics id="S4.SS5.p1.5.m5.1a"><mi id="S4.SS5.p1.5.m5.1.1" mathvariant="normal" xref="S4.SS5.p1.5.m5.1.1.cmml">Θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS5.p1.5.m5.1b"><ci id="S4.SS5.p1.5.m5.1.1.cmml" xref="S4.SS5.p1.5.m5.1.1">Θ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS5.p1.5.m5.1c">\Theta</annotation><annotation encoding="application/x-llamapun" id="S4.SS5.p1.5.m5.1d">roman_Θ</annotation></semantics></math> indicates the trainable parameters.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Performance comparison on sequential recommendation.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T1.1.1.1.1" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.1.1.1.1.1">Methods</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S4.T1.1.1.1.2" style="padding-left:3.0pt;padding-right:3.0pt;">Yelp</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S4.T1.1.1.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Beauty</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="4" id="S4.T1.1.1.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">Toys</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;">HR@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">HR@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">HR@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.7" style="padding-left:3.0pt;padding-right:3.0pt;">HR@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.8" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.9" style="padding-left:3.0pt;padding-right:3.0pt;">HR@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.10" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.11" style="padding-left:3.0pt;padding-right:3.0pt;">HR@10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.2.12" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@10</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.3.3.1" style="padding-left:3.0pt;padding-right:3.0pt;">Caser</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0151</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0096</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0253</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0129</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0205</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0131</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0347</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0176</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0166</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0107</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0270</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.3.3.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0141</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.4.4.1" style="padding-left:3.0pt;padding-right:3.0pt;">BERT4Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0051</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0033</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0090</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0045</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0203</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0124</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0347</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0170</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0116</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0071</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0203</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.4.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0099</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.5.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.5.5.1" style="padding-left:3.0pt;padding-right:3.0pt;">LightGCN</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0255</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0163</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0427</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0218</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0305</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0194</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0511</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0260</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0270</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0189</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.440</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.5.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0234</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.6.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.6.6.1" style="padding-left:3.0pt;padding-right:3.0pt;">SASRec</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0162</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0100</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0274</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0136</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0387</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0249</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0605</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0318</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0463</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0306</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0675</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.6.6.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0374</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.7.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.7.7.1" style="padding-left:3.0pt;padding-right:3.0pt;">S3-Rec</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0201</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0123</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0341</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0168</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0387</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0244</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0647</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0327</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0443</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0294</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0700</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.7.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0376</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.8.8">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.8.8.1" style="padding-left:3.0pt;padding-right:3.0pt;">P5</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0051</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0041</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0095</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0053</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0379</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.025</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0582</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0298</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0198</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.013</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0267</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.8.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.015</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.9.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.9.9.1" style="padding-left:3.0pt;padding-right:3.0pt;">CID</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0261</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0171</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0428</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0225</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0489</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0318</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0680</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0357</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0143</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0113</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0256</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.9.9.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0141</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.10.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.10.10.1" style="padding-left:3.0pt;padding-right:3.0pt;">IID</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0232</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0146</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0393</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0197</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0394</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0268</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0615</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0341</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.131</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.105</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.222</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.10.10.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.128</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.11.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.11.11.1" style="padding-left:3.0pt;padding-right:3.0pt;">SID</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0346</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0242</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0486</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0287</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0430</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0288</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0602</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0368</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0164</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0120</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0218</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.11.11.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0139</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.12.12">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.12.12.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.1.12.12.1.1" style="font-size:80%;">GAL(SASRec)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0216</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0154</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0329</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0198</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0486</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0311</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0759</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0399</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.10" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.12.12.10.1">0.0491</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.11" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.12.12.11.1">0.0322</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.12" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.12.12.12.1">0.0712</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.12.12.13" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.12.12.13.1">0.0393</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.13.13">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.13.13.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.1.13.13.1.1" style="font-size:80%;">GAL(LightGCN)</span></th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.2" style="padding-left:3.0pt;padding-right:3.0pt;">0.0323</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0213</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0457</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0256</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0334</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0214</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0537</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0279</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0289</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0190</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0448</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.13.13.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0241</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.14.14">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.1.14.14.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S4.T1.1.14.14.1.1" style="font-size:80%;">GAL(Text)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.14.14.2.1">0.0361</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.14.14.3.1">0.0258</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.14.14.4.1">0.0491</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.14.14.5.1">0.0298</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.14.14.6.1">0.0492</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.14.14.7.1">0.0320</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.14.14.8.1">0.0768</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S4.T1.1.14.14.9.1">0.0406</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0388</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0260</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0587</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.14.14.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0325</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">EXPERIMENTS</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this section, we aim to address several key research questions (RQs) through comprehensive experimentation:</p>
</div>
<div class="ltx_para" id="S5.p2">
<ul class="ltx_itemize" id="S5.I1">
<li class="ltx_item" id="S5.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i1.p1">
<p class="ltx_p" id="S5.I1.i1.p1.1">RQ1: Does our GAL-Rec model outperform current state-of-the-art traditional recommendation models?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i2.p1">
<p class="ltx_p" id="S5.I1.i2.p1.1">RQ2: Is our framework capable of significantly improving the utilization of collaborative information by LLMs?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i3.p1">
<p class="ltx_p" id="S5.I1.i3.p1.1">RQ3: Can GAL-Rec improve LLM’s distribution of user (item) multi-hop information representation?</p>
</div>
</li>
<li class="ltx_item" id="S5.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I1.i4.p1">
<p class="ltx_p" id="S5.I1.i4.p1.1">RQ4: How do different parameter settings affect the performance of GAL?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS1.5.1.1">V-A</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS1.6.2">Experimental Setup</span>
</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S5.SS1.p1.1.1">Datasets. </em> In line with the experimental approach used in P5, we will experiment on three popular benchmark datasets. These include (1). the Amazon Beauty dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib42" title="">42</a>]</cite>, comprising data from Amazon’s beauty products, and (2). the Toys dataset, also derived from Amazon reviews, featuring a range of toys, and (3). the Yelp datasets. For these datasets, we will follow the methodology outlined in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib15" title="">15</a>]</cite>, employing the leave-one-out approach for dividing the data into training, validation, and test sets. Additionally, we filter out users and items with less than five interactions. The specifics of these processed datasets are presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.T2" title="TABLE II ‣ V-A Experimental Setup ‣ V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">II</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p2">
<p class="ltx_p" id="S5.SS1.p2.4"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S5.SS1.p2.4.1">Evaluation Metrics.</em> We will use two widely utilized metrics, NDCG@<math alttext="K" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.1.m1.1d">italic_K</annotation></semantics></math> and HR@<math alttext="K" class="ltx_Math" display="inline" id="S5.SS1.p2.2.m2.1"><semantics id="S5.SS1.p2.2.m2.1a"><mi id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><ci id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.2.m2.1d">italic_K</annotation></semantics></math>, to measure the model’s capability, where <math alttext="K" class="ltx_Math" display="inline" id="S5.SS1.p2.3.m3.1"><semantics id="S5.SS1.p2.3.m3.1a"><mi id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><ci id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.3.m3.1d">italic_K</annotation></semantics></math> is chosen as 5 and 10. For Top-<math alttext="K" class="ltx_Math" display="inline" id="S5.SS1.p2.4.m4.1"><semantics id="S5.SS1.p2.4.m4.1a"><mi id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><ci id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">K</annotation><annotation encoding="application/x-llamapun" id="S5.SS1.p2.4.m4.1d">italic_K</annotation></semantics></math> recommendation tasks, we adopt a full-ranking evaluation strategy.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.SS1.p3">
<p class="ltx_p" id="S5.SS1.p3.1"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S5.SS1.p3.1.1">Baseline.</em> We select several advanced and related algorithms with different model structures as our baseline models. In traditional models, we use Caser <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib42" title="">42</a>]</cite>, BERT4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib43" title="">43</a>]</cite>, SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib44" title="">44</a>]</cite>, S3-Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib45" title="">45</a>]</cite>, LightGCN <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib46" title="">46</a>]</cite>. For large model recommendation methods, taking into account both the size of baseline models and their language modeling capacities, we choose P5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib15" title="">15</a>]</cite>, CID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib25" title="">25</a>]</cite>, IID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib25" title="">25</a>]</cite>, SID <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib25" title="">25</a>]</cite> as our comparison model. Notably, there was a data leakage issue in the data preprocessing part of P5 that led to inflated metrics <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib16" title="">16</a>]</cite>. Following the adjustments shown in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib16" title="">16</a>]</cite>, we modified the data preprocessing and conducted comparisons.</p>
<ul class="ltx_itemize" id="S5.I2">
<li class="ltx_item" id="S5.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i1.p1">
<p class="ltx_p" id="S5.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i1.p1.1.1">Caser</span>: A CNN-based method, which captures high-order Markov chains for sequential recommendation by applying horizontal and vertical convolution operations.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i2.p1">
<p class="ltx_p" id="S5.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i2.p1.1.1">LightGCN</span>: This is a representative graph-based collaborative method that utilizes a simplified graph convolutional neural network to enhance user interest modeling.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i3.p1">
<p class="ltx_p" id="S5.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i3.p1.1.1">BERT4Rec</span>: A method based on a bidirectional self-attention model, with a cloze test target for the sequential recommendation.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i4.p1">
<p class="ltx_p" id="S5.I2.i4.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i4.p1.1.1">SASRec</span>: This is a representative sequential recommendation method that uses a self-attention network to encode sequential patterns for modeling user interests. It can be considered a collaborative method that takes sequence information into account.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i5.p1">
<p class="ltx_p" id="S5.I2.i5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i5.p1.1.1">S3-Rec</span>: This method utilizes the intrinsic data correlation to derive self-supervised signals and pre-training to enhance the data representation of sequential recommendation.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i6.p1">
<p class="ltx_p" id="S5.I2.i6.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i6.p1.1.1">P5</span>: P5 utilizes the pre-training of LLM and transforms the recommendation task into custom natural language sentences using personalized prompts.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i7.p1">
<p class="ltx_p" id="S5.I2.i7.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i7.p1.1.1">CID</span>: CID premised on the assumption that items co-occurring more frequently are more similar, advocates for sharing a greater overlap of tokens during index construction. IDs are generated accordingly.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i8.p1">
<p class="ltx_p" id="S5.I2.i8.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i8.p1.1.1">IID</span>: IID entails creating an independent, additional tag for each item that requires learning, serving as the item’s ID.</p>
</div>
</li>
<li class="ltx_item" id="S5.I2.i9" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I2.i9.p1">
<p class="ltx_p" id="S5.I2.i9.p1.1"><span class="ltx_text ltx_font_bold" id="S5.I2.i9.p1.1.1">SID</span>: SID leverages collaborative information via sequential indexing, assigning consecutive numeric IDs to items interacted with by users in sequence.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S5.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Statistics of the evaluation datasets.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T2.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.2.1">Beauty</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.3.1">Toys</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T2.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T2.1.1.1.4.1">Yelp</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T2.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.1">#Users</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.2">22,363</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.3">19,412</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.1.2.1.4">30,431</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.1">#Items</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.2">12,101</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.3">11,924</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.3.2.4">20,033</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.4.3">
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.1">#Reviews</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.2">198,502</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.3">167,597</td>
<td class="ltx_td ltx_align_center" id="S5.T2.1.4.3.4">316,354</td>
</tr>
<tr class="ltx_tr" id="S5.T2.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.5.4.1">#Sparsity(%)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.5.4.2">0.0734</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.5.4.3">0.0724</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T2.1.5.4.4">0.0519</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para ltx_noindent" id="S5.SS1.p4">
<p class="ltx_p" id="S5.SS1.p4.1"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S5.SS1.p4.1.1">Implementation Details.</em> We use the AdamW optimizer and adopt a warmup of 0.05, with a linear decay strategy for the learning rate. In terms of hyperparameter tuning, the learning rate is explored within the range of [1e-4, 1e-5], the temperature selection range is [0.05, 0.2], and the weight decay is set to 1e-3. For the embedding dimensions of all other recommendation methods, we choose 64. In the negative samples of contrastive learning, we refer to the Moco v1 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib21" title="">21</a>]</cite> paradigm, choosing a queue method for storing negative samples with a queue length of 512. For the LLM component, we select Flan-t5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib47" title="">47</a>]</cite> because its excellent encoder can perform representation learning, and we also considered this factor when comparing other methods. We use the Nvidia A6000 GPU for training, with a batch size of 8, and adopt a gradient accumulation strategy, with an accumulation step of 8. Additionally, in the process of sampling second-order neighbor nodes, we ensure that the sampling of second-order neighbors for each first-order neighbor node is at a minimum of 8.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS2.5.1.1">V-B</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS2.6.2">Performance Comparison (RQ1)</span>
</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">The experimental results of sequential recommendation are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S4.T1" title="TABLE I ‣ IV-E Optimization ‣ IV METHODOLOGY ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">I</span></a>. The best results across all methods are denoted by bold numbers, and the second-best results by underlined numbers. For GAL-Rec’s external embedding, we utilized LightGCN and SASRec as conventional recommendation models to capture collaborative information for one type of embedding, while also incorporating the item’s textual information as another embedding type.
From the experimental results in the table, we can draw the following conclusions:</p>
<ul class="ltx_itemize" id="S5.I3">
<li class="ltx_item" id="S5.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i1.p1">
<p class="ltx_p" id="S5.I3.i1.p1.1">In comparison with conventional recommendation models, the GAL models utilizing their embeddings, such as LGCN and SASRec, have achieved substantial improvements across all datasets. As Zhao<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib48" title="">48</a>]</cite> highlighted, two fundamental aspects contribute to the effectiveness of recommendation models. Firstly, the embedding of items is pivotal; the caliber of item embeddings essentially determines the upper limit of the model’s performance. Secondly, the modeling of users grounded in their historical interactions is critical(SASRec achieves this through attention mechanisms, whereas LightGCN leverages graph convolution operations.) The remarkable advancements credited to GAL can be primarily ascribed to its heightened capacity to model the intricate relationships within the user-item graph, thereby enhancing overall recommendation performance.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i2.p1">
<p class="ltx_p" id="S5.I3.i2.p1.1">A significant positive correlation was observed between the performance of GAL-Rec, integrating diverse collaborative information, and the outcomes of various traditional models. This suggests that GAL-Rec’s enhanced understanding of collaborative information is an extension of the intrinsic qualities of the collaborative information itself.</p>
</div>
</li>
<li class="ltx_item" id="S5.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I3.i3.p1">
<p class="ltx_p" id="S5.I3.i3.p1.1">Notably on a specific dataset (Beauty), GAL-Rec featuring item text embedding (GAL-Rec (Text)) achieved the most superior performance. This implies that, in certain contexts, textual information can offer more effective insights.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS3.5.1.1">V-C</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS3.6.2">Ablation Study (RQ2)</span>
</h3>
<figure class="ltx_table" id="S5.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Results of the ablation studies over LLM with respect to GAL-Rec.</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T3.1.1.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S5.T3.1.1.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S5.T3.1.1.1.2" rowspan="2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.1.1.2.1">Methods</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S5.T3.1.1.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">Yelp</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S5.T3.1.1.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">Beauty</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S5.T3.1.1.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">Toys</th>
</tr>
<tr class="ltx_tr" id="S5.T3.1.2.2">
<th class="ltx_td ltx_th ltx_th_row" id="S5.T3.1.2.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.2" style="padding-left:3.0pt;padding-right:3.0pt;">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.7" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.8" style="padding-left:3.0pt;padding-right:3.0pt;">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.9" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.10" style="padding-left:3.0pt;padding-right:3.0pt;">HR@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.11" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@5</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.12" style="padding-left:3.0pt;padding-right:3.0pt;">HR@10</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S5.T3.1.2.2.13" style="padding-left:3.0pt;padding-right:3.0pt;">NDCG@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T3.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.3.1.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.3.1.1.1" style="font-size:80%;">w/o</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S5.T3.1.3.1.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.3.1.2.1" style="font-size:80%;">GAL(SASRec)</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0155</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0078</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0267</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0113</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0453</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0290</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0705</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0371</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0453</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0303</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0661</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T3.1.3.1.14" style="padding-left:3.0pt;padding-right:3.0pt;">0.0367</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.1.4.2.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.4.2.1.1" style="font-size:80%;">w/o</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.4.2.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.4.2.2.1" style="font-size:80%;">GAL(LGCN)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0223</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0152</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0369</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0.184</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0292</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0189</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0490</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0252</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0257</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0169</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0393</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.4.2.14" style="padding-left:3.0pt;padding-right:3.0pt;">0.0211</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.1.5.3.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.5.3.1.1" style="font-size:80%;">w/o</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.5.3.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.5.3.2.1" style="font-size:80%;">GAL(Text)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0309</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0194</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0425</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0266</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0456</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0293</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0705</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0375</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0354</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0231</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0554</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.5.3.14" style="padding-left:3.0pt;padding-right:3.0pt;">0.0298</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.1.6.4.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.6.4.1.1" style="font-size:80%;">w/</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.6.4.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.6.4.2.1" style="font-size:80%;">GAL(SASRec)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0216</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0154</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0329</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0198</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0486</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0311</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0759</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0399</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.11" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.4.11.1">0.0491</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.12" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.4.12.1">0.0322</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.13" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.4.13.1">0.0712</span></td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.6.4.14" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.6.4.14.1">0.0393</span></td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S5.T3.1.7.5.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.7.5.1.1" style="font-size:80%;">w/</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S5.T3.1.7.5.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.7.5.2.1" style="font-size:80%;">GAL(LGCN)</span></th>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.3" style="padding-left:3.0pt;padding-right:3.0pt;">0.0323</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.4" style="padding-left:3.0pt;padding-right:3.0pt;">0.0213</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.5" style="padding-left:3.0pt;padding-right:3.0pt;">0.0457</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.6" style="padding-left:3.0pt;padding-right:3.0pt;">0.0256</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.7" style="padding-left:3.0pt;padding-right:3.0pt;">0.0334</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.8" style="padding-left:3.0pt;padding-right:3.0pt;">0.0214</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.9" style="padding-left:3.0pt;padding-right:3.0pt;">0.0537</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.10" style="padding-left:3.0pt;padding-right:3.0pt;">0.0279</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0289</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0190</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0448</td>
<td class="ltx_td ltx_align_center" id="S5.T3.1.7.5.14" style="padding-left:3.0pt;padding-right:3.0pt;">0.0241</td>
</tr>
<tr class="ltx_tr" id="S5.T3.1.8.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S5.T3.1.8.6.1" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.8.6.1.1" style="font-size:80%;">w/</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S5.T3.1.8.6.2" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text" id="S5.T3.1.8.6.2.1" style="font-size:80%;">GAL(Text)</span></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.3" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.6.3.1">0.0361</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.4" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.6.4.1">0.0258</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.5" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.6.5.1">0.0491</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.6" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.6.6.1">0.0298</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.7" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.6.7.1">0.0492</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.8" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.6.8.1">0.0320</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.9" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.6.9.1">0.0768</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.10" style="padding-left:3.0pt;padding-right:3.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T3.1.8.6.10.1">0.0406</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.11" style="padding-left:3.0pt;padding-right:3.0pt;">0.0388</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.12" style="padding-left:3.0pt;padding-right:3.0pt;">0.0260</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.13" style="padding-left:3.0pt;padding-right:3.0pt;">0.0587</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T3.1.8.6.14" style="padding-left:3.0pt;padding-right:3.0pt;">0.0325</td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">In this section, to verify the contribution of graph-aware contrastive learning in the GAL-Rec framework, ablation studies were conducted, with the outcomes detailed in Table.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">To substantiate the efficacy of the GAL framework, we conducted evaluations on all datasets and with various embeddings, comparing model performance under conditions with and without GAL integration. The latter scenario, representing the absence of graph-aware learning, entailed solely fine-tuning leveraging large language models. The outcomes presented in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.T3" title="TABLE III ‣ V-C Ablation Study (RQ2) ‣ V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">III</span></a> illustrate a 7% to 15% improvement across various metrics when employing GAL, affirming its significant impact on the effective fusion of LLMs and graph learning.</p>
</div>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1">Delving further into the analysis of the GAL framework, Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.T4" title="TABLE IV ‣ V-C Ablation Study (RQ2) ‣ V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">IV</span></a> underscores the vital role each loss function plays. Moreover, insights from Table <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.T5" title="TABLE V ‣ V-C Ablation Study (RQ2) ‣ V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">V</span></a> indicate that an overly extensive receptive field could lead to less than optimal performance, emphasizing that a judicious choice of hop numbers for information aggregation is pivotal to achieving the best results. These findings collectively reinforce the notion that the careful calibration of the GAL framework, particularly regarding loss functions and graph traversal depth, is central to unlocking its full potential in enhancing recommendation system performance.</p>
</div>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span>GAL (LGCN) ablation experiment under different loss(Toys).</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T4.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T4.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.1">Hop</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.2.1">H@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.3.1">N@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.4.1">H@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T4.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T4.1.1.1.5.1">N@10</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T4.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.1"> w/o L1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.2">2.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.3">4.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.4">1.81</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T4.1.2.1.5">2.19</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.1"> w/o L2</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.2">2.77</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.3">4.25</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.4">1.80</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.3.2.5">2.26</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.4.3">
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.1"> w/o L3</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.2">2.83</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.3">4.29</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.4">1.84</td>
<td class="ltx_td ltx_align_center" id="S5.T4.1.4.3.5">2.39</td>
</tr>
<tr class="ltx_tr" id="S5.T4.1.5.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.5.4.1"> ALL</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.5.4.2"><span class="ltx_text ltx_font_bold" id="S5.T4.1.5.4.2.1">2.89</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.5.4.3"><span class="ltx_text ltx_font_bold" id="S5.T4.1.5.4.3.1">4.48</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.5.4.4"><span class="ltx_text ltx_font_bold" id="S5.T4.1.5.4.4.1">1.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T4.1.5.4.5"><span class="ltx_text ltx_font_bold" id="S5.T4.1.5.4.5.1">2.41</span></td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S5.T5">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span>GAL (LGCN) ablation experiment under different hop(Toys).</figcaption>
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S5.T5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.1">Hop</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.2.1">H@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.3.1">N@5</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.4.1">H@10</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S5.T5.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S5.T5.1.1.1.5.1">N@10</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S5.T5.1.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.1"> 1-hop</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.2">2.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.3">4.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.4">1.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S5.T5.1.2.1.5">2.24</td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.3.2">
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.1"> 2-hop</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.2">2.89</td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S5.T5.1.3.2.3.1">4.48</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.4"><span class="ltx_text ltx_font_bold" id="S5.T5.1.3.2.4.1">1.90</span></td>
<td class="ltx_td ltx_align_center" id="S5.T5.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S5.T5.1.3.2.5.1">2.41</span></td>
</tr>
<tr class="ltx_tr" id="S5.T5.1.4.3">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.4.3.1"> 3-hop</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.4.3.2"><span class="ltx_text ltx_font_bold" id="S5.T5.1.4.3.2.1">2.90</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.4.3.3">4.43</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.4.3.4">1.84</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T5.1.4.3.5">2.33</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS4.5.1.1">V-D</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS4.6.2">Distribution Uniformity Analysis (RQ3)</span>
</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">One of the principal contributions of GAL-Rec is to enhance the understanding ability of LLM towards collaborative information. To better grasp how GAL-Rec enhances the encoding component’s ability to represent user (item) data, we use KDE<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib49" title="">49</a>]</cite> to visualize the embedding distribution of multi-hop information of users (items) in two-dimensional space. This visualization, demonstrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.F4" title="Figure 4 ‣ V-D Distribution Uniformity Analysis (RQ3) ‣ V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">4</span></a>, highlights GAL-Rec’s effectiveness in refining the embedding distribution. Furthermore, we also visualized the density of the representation of each multi-hop information on the unit hypersphere in terms of angles. Through this analysis, we observe:</p>
</div>
<figure class="ltx_figure" id="S5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="292" id="S5.F4.g1" src="extracted/5677515/user_item.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Visualization: Feature distribution of multi-hop information representations of users(items) learn from Toys in two-dimensional space (The darker the color, the more users fall within that area).</figcaption>
</figure>
<div class="ltx_para" id="S5.SS4.p2">
<ul class="ltx_itemize" id="S5.I4">
<li class="ltx_item" id="S5.I4.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i1.p1">
<p class="ltx_p" id="S5.I4.i1.p1.1">In the absence of the GAL-Rec framework, multi-hop information exhibits uneven distribution. Simultaneously, with the expansion of the aggregation range, there is a notable collapse in distribution at the 2-hop aggregation information, where more user (item) representations tend to be similar. This phenomenon is akin to the over-smoothing issue observed in GNN, suggesting that LLM, when aggregating multi-hop collaborative signals, might face similar challenges. This insight provides a strategic direction for employing LLM in recommendation systems.</p>
</div>
</li>
<li class="ltx_item" id="S5.I4.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S5.I4.i2.p1">
<p class="ltx_p" id="S5.I4.i2.p1.1">With GAL-Rec, the distribution of multi-hop information for users (item) is markedly more uniform. Particularly, GAL-Rec effectively addresses the collapse in representation at the 2-hop aggregation, underscoring the uniformity in signal representation after GAL-Rec processing. This indicates that GAL-Rec, by leveraging contrastive learning, can effectively model the interrelations among multi-hop collaborative signals of users (item), significantly boosting LLM’s capacity for processing collaborative information and enhancing its recommendation efficacy.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S5.SS5.5.1.1">V-E</span> </span><span class="ltx_text ltx_font_italic" id="S5.SS5.6.2">Parameter Analyses (RQ4)</span>
</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.3">In the GAL-Rec framework, we incorporate the concepts of contrastive learning temperature <math alttext="\tau" class="ltx_Math" display="inline" id="S5.SS5.p1.1.m1.1"><semantics id="S5.SS5.p1.1.m1.1a"><mi id="S5.SS5.p1.1.m1.1.1" xref="S5.SS5.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.1.m1.1b"><ci id="S5.SS5.p1.1.m1.1.1.cmml" xref="S5.SS5.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.1.m1.1c">\tau</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.1.m1.1d">italic_τ</annotation></semantics></math>, queue length <math alttext="l" class="ltx_Math" display="inline" id="S5.SS5.p1.2.m2.1"><semantics id="S5.SS5.p1.2.m2.1a"><mi id="S5.SS5.p1.2.m2.1.1" xref="S5.SS5.p1.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.2.m2.1b"><ci id="S5.SS5.p1.2.m2.1.1.cmml" xref="S5.SS5.p1.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.2.m2.1c">l</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.2.m2.1d">italic_l</annotation></semantics></math>, and second-order neighbor count <math alttext="n" class="ltx_Math" display="inline" id="S5.SS5.p1.3.m3.1"><semantics id="S5.SS5.p1.3.m3.1a"><mi id="S5.SS5.p1.3.m3.1.1" xref="S5.SS5.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S5.SS5.p1.3.m3.1b"><ci id="S5.SS5.p1.3.m3.1.1.cmml" xref="S5.SS5.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS5.p1.3.m3.1c">n</annotation><annotation encoding="application/x-llamapun" id="S5.SS5.p1.3.m3.1d">italic_n</annotation></semantics></math>. These hyperparameters’ sensitivity will be evaluated through experimental investigation to enhance the applicability and development of GAL-Rec.</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.1"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S5.SS5.p2.1.1">5.4.1 Temperature.</em> To examine the impact of the temperature parameter on GAL-Rec’s performance, we adjusted its range. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.F5" title="Figure 5 ‣ V-E Parameter Analyses (RQ4) ‣ V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">5</span></a>(a) illustrates that the temperature parameter is pivotal for GAL’s efficacy, with GAL-Rec’s performance exhibiting significant fluctuations in response to variations in this parameter. The temperature parameter dictates the extent of focus on challenging negative samples by the contrastive loss mechanism. Choosing the GAL temperature parameter requires a balance: a higher parameter lessens emphasis on hard negatives, while a lower parameter focuses on similar negatives, aiming for a more uniform representation space.</p>
</div>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="296" id="S5.F5.g1" src="extracted/5677515/hyper.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Effect of <math alttext="\tau" class="ltx_Math" display="inline" id="S5.F5.4.m1.1"><semantics id="S5.F5.4.m1.1b"><mi id="S5.F5.4.m1.1.1" xref="S5.F5.4.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S5.F5.4.m1.1c"><ci id="S5.F5.4.m1.1.1.cmml" xref="S5.F5.4.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.4.m1.1d">\tau</annotation><annotation encoding="application/x-llamapun" id="S5.F5.4.m1.1e">italic_τ</annotation></semantics></math> and <math alttext="length" class="ltx_Math" display="inline" id="S5.F5.5.m2.1"><semantics id="S5.F5.5.m2.1b"><mrow id="S5.F5.5.m2.1.1" xref="S5.F5.5.m2.1.1.cmml"><mi id="S5.F5.5.m2.1.1.2" xref="S5.F5.5.m2.1.1.2.cmml">l</mi><mo id="S5.F5.5.m2.1.1.1" xref="S5.F5.5.m2.1.1.1.cmml">⁢</mo><mi id="S5.F5.5.m2.1.1.3" xref="S5.F5.5.m2.1.1.3.cmml">e</mi><mo id="S5.F5.5.m2.1.1.1b" xref="S5.F5.5.m2.1.1.1.cmml">⁢</mo><mi id="S5.F5.5.m2.1.1.4" xref="S5.F5.5.m2.1.1.4.cmml">n</mi><mo id="S5.F5.5.m2.1.1.1c" xref="S5.F5.5.m2.1.1.1.cmml">⁢</mo><mi id="S5.F5.5.m2.1.1.5" xref="S5.F5.5.m2.1.1.5.cmml">g</mi><mo id="S5.F5.5.m2.1.1.1d" xref="S5.F5.5.m2.1.1.1.cmml">⁢</mo><mi id="S5.F5.5.m2.1.1.6" xref="S5.F5.5.m2.1.1.6.cmml">t</mi><mo id="S5.F5.5.m2.1.1.1e" xref="S5.F5.5.m2.1.1.1.cmml">⁢</mo><mi id="S5.F5.5.m2.1.1.7" xref="S5.F5.5.m2.1.1.7.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.F5.5.m2.1c"><apply id="S5.F5.5.m2.1.1.cmml" xref="S5.F5.5.m2.1.1"><times id="S5.F5.5.m2.1.1.1.cmml" xref="S5.F5.5.m2.1.1.1"></times><ci id="S5.F5.5.m2.1.1.2.cmml" xref="S5.F5.5.m2.1.1.2">𝑙</ci><ci id="S5.F5.5.m2.1.1.3.cmml" xref="S5.F5.5.m2.1.1.3">𝑒</ci><ci id="S5.F5.5.m2.1.1.4.cmml" xref="S5.F5.5.m2.1.1.4">𝑛</ci><ci id="S5.F5.5.m2.1.1.5.cmml" xref="S5.F5.5.m2.1.1.5">𝑔</ci><ci id="S5.F5.5.m2.1.1.6.cmml" xref="S5.F5.5.m2.1.1.6">𝑡</ci><ci id="S5.F5.5.m2.1.1.7.cmml" xref="S5.F5.5.m2.1.1.7">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.5.m2.1d">length</annotation><annotation encoding="application/x-llamapun" id="S5.F5.5.m2.1e">italic_l italic_e italic_n italic_g italic_t italic_h</annotation></semantics></math> , <math alttext="neighbors\ counts" class="ltx_Math" display="inline" id="S5.F5.6.m3.1"><semantics id="S5.F5.6.m3.1b"><mrow id="S5.F5.6.m3.1.1" xref="S5.F5.6.m3.1.1.cmml"><mi id="S5.F5.6.m3.1.1.2" xref="S5.F5.6.m3.1.1.2.cmml">n</mi><mo id="S5.F5.6.m3.1.1.1" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.3" xref="S5.F5.6.m3.1.1.3.cmml">e</mi><mo id="S5.F5.6.m3.1.1.1b" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.4" xref="S5.F5.6.m3.1.1.4.cmml">i</mi><mo id="S5.F5.6.m3.1.1.1c" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.5" xref="S5.F5.6.m3.1.1.5.cmml">g</mi><mo id="S5.F5.6.m3.1.1.1d" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.6" xref="S5.F5.6.m3.1.1.6.cmml">h</mi><mo id="S5.F5.6.m3.1.1.1e" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.7" xref="S5.F5.6.m3.1.1.7.cmml">b</mi><mo id="S5.F5.6.m3.1.1.1f" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.8" xref="S5.F5.6.m3.1.1.8.cmml">o</mi><mo id="S5.F5.6.m3.1.1.1g" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.9" xref="S5.F5.6.m3.1.1.9.cmml">r</mi><mo id="S5.F5.6.m3.1.1.1h" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.10" xref="S5.F5.6.m3.1.1.10.cmml">s</mi><mo id="S5.F5.6.m3.1.1.1i" lspace="0.500em" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.11" xref="S5.F5.6.m3.1.1.11.cmml">c</mi><mo id="S5.F5.6.m3.1.1.1j" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.12" xref="S5.F5.6.m3.1.1.12.cmml">o</mi><mo id="S5.F5.6.m3.1.1.1k" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.13" xref="S5.F5.6.m3.1.1.13.cmml">u</mi><mo id="S5.F5.6.m3.1.1.1l" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.14" xref="S5.F5.6.m3.1.1.14.cmml">n</mi><mo id="S5.F5.6.m3.1.1.1m" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.15" xref="S5.F5.6.m3.1.1.15.cmml">t</mi><mo id="S5.F5.6.m3.1.1.1n" xref="S5.F5.6.m3.1.1.1.cmml">⁢</mo><mi id="S5.F5.6.m3.1.1.16" xref="S5.F5.6.m3.1.1.16.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.F5.6.m3.1c"><apply id="S5.F5.6.m3.1.1.cmml" xref="S5.F5.6.m3.1.1"><times id="S5.F5.6.m3.1.1.1.cmml" xref="S5.F5.6.m3.1.1.1"></times><ci id="S5.F5.6.m3.1.1.2.cmml" xref="S5.F5.6.m3.1.1.2">𝑛</ci><ci id="S5.F5.6.m3.1.1.3.cmml" xref="S5.F5.6.m3.1.1.3">𝑒</ci><ci id="S5.F5.6.m3.1.1.4.cmml" xref="S5.F5.6.m3.1.1.4">𝑖</ci><ci id="S5.F5.6.m3.1.1.5.cmml" xref="S5.F5.6.m3.1.1.5">𝑔</ci><ci id="S5.F5.6.m3.1.1.6.cmml" xref="S5.F5.6.m3.1.1.6">ℎ</ci><ci id="S5.F5.6.m3.1.1.7.cmml" xref="S5.F5.6.m3.1.1.7">𝑏</ci><ci id="S5.F5.6.m3.1.1.8.cmml" xref="S5.F5.6.m3.1.1.8">𝑜</ci><ci id="S5.F5.6.m3.1.1.9.cmml" xref="S5.F5.6.m3.1.1.9">𝑟</ci><ci id="S5.F5.6.m3.1.1.10.cmml" xref="S5.F5.6.m3.1.1.10">𝑠</ci><ci id="S5.F5.6.m3.1.1.11.cmml" xref="S5.F5.6.m3.1.1.11">𝑐</ci><ci id="S5.F5.6.m3.1.1.12.cmml" xref="S5.F5.6.m3.1.1.12">𝑜</ci><ci id="S5.F5.6.m3.1.1.13.cmml" xref="S5.F5.6.m3.1.1.13">𝑢</ci><ci id="S5.F5.6.m3.1.1.14.cmml" xref="S5.F5.6.m3.1.1.14">𝑛</ci><ci id="S5.F5.6.m3.1.1.15.cmml" xref="S5.F5.6.m3.1.1.15">𝑡</ci><ci id="S5.F5.6.m3.1.1.16.cmml" xref="S5.F5.6.m3.1.1.16">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F5.6.m3.1d">neighbors\ counts</annotation><annotation encoding="application/x-llamapun" id="S5.F5.6.m3.1e">italic_n italic_e italic_i italic_g italic_h italic_b italic_o italic_r italic_s italic_c italic_o italic_u italic_n italic_t italic_s</annotation></semantics></math> in GAL-Rec.</figcaption>
</figure>
<div class="ltx_para" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.1"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S5.SS5.p3.1.1">5.4.2 Queue Length.</em> A series of experiments were conducted to assess the queue length’s impact on GAL. Initial results, as depicted in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.F5" title="Figure 5 ‣ V-E Parameter Analyses (RQ4) ‣ V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">5</span></a>(b), indicated that increasing the queue length enhances GAL’s performance; however, it does not significantly improve the model’s performance. Moreover, increasing the queue length beyond a certain point did not yield additional performance gains and actually diminished the model’s efficacy, which contrasts with the findings associated with Moco v1. However, considering the cancellation of the memory bank module in contrastive learning based on transformers in Moco v3 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#bib.bib50" title="">50</a>]</cite>, we believe that the queue length has lost its previously significant effect on model performance in transformer structures.</p>
</div>
<div class="ltx_para" id="S5.SS5.p4">
<p class="ltx_p" id="S5.SS5.p4.1"><em class="ltx_emph ltx_font_bold ltx_font_italic" id="S5.SS5.p4.1.1">5.4.3 Second-Order Neighbors Count.</em> To investigate the impact of the number of second-order neighbors on the performance of GAL, we varied the range of second-order neighbor counts. As illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.13235v1#S5.F5" title="Figure 5 ‣ V-E Parameter Analyses (RQ4) ‣ V EXPERIMENTS ‣ Enhancing Collaborative Semantics of Language Model-Driven Recommendations via Graph-Aware Learning"><span class="ltx_text ltx_ref_tag">5</span></a>(c), the performance of GAL exhibits a steady upward trend with the increase in the number of second-order neighbors. This trend indicates that GAL benefits from the continuously expanding receptive field, underscoring the significant role of aggregating information across multiple hops within the GAL architecture and demonstrating the efficacy of our contrastive learning approach.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span class="ltx_text ltx_font_smallcaps" id="S6.1.1">CONCLUSIONS</span>
</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we introduced GAL-Rec, a framework designed to enhance the recommendation capabilities of Large Language Models (LLMs). GAL-Rec leverages the principles of Graph Neural Networks (GNNs) to aggregate multi-hop information and employs contrastive learning to connect multi-hop user information with multi-hop item information. This approach enriches the understanding of collaborative semantics between users and items. Our experimental results demonstrated that GAL-Rec significantly improves performance. Additionally, to address the issue of inadequate negative samples in contrastive learning for LLMs, we propose a dynamic queue storage methodology based on Moco.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">Looking ahead, we will explore the application of our method to Decoder-only structured LLMs. We also aim to extend our approach to a wider range of recommendation tasks, such as multimodal recommendation, click-through rate (CTR) prediction, and rating prediction tasks.</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">Overall, we have contributed a self-supervised learning paradigm for LLMs in recommendation systems. We believe that this research opens new avenues for the application of LLMs within recommendation systems.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal, A. Neelakantan, P. Shyam, G. Sastry, A. Askell <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">et al.</em>, “Language models are few-shot learners,” <em class="ltx_emph ltx_font_italic" id="bib.bib1.2.2">Advances in neural information processing systems</em>, vol. 33, pp. 1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
L. Ouyang, J. Wu, X. Jiang, D. Almeida, C. Wainwright, P. Mishkin, C. Zhang, S. Agarwal, K. Slama, A. Ray <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">et al.</em>, “Training language models to follow instructions with human feedback,” <em class="ltx_emph ltx_font_italic" id="bib.bib2.2.2">Advances in Neural Information Processing Systems</em>, vol. 35, pp. 27 730–27 744, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
H. Touvron, T. Lavril, G. Izacard, X. Martinet, M.-A. Lachaux, T. Lacroix, B. Rozière, N. Goyal, E. Hambro, F. Azhar <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">et al.</em>, “Llama: Open and efficient foundation language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib3.2.2">arXiv preprint arXiv:2302.13971</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
I. Singh, V. Blukis, A. Mousavian, A. Goyal, D. Xu, J. Tremblay, D. Fox, J. Thomason, and A. Garg, “Progprompt: Generating situated robot task plans using large language models,” in <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">2023 IEEE International Conference on Robotics and Automation (ICRA)</em>.   IEEE, 2023, pp. 11 523–11 530.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
D. Driess, F. Xia, M. S. Sajjadi, C. Lynch, A. Chowdhery, B. Ichter, A. Wahid, J. Tompson, Q. Vuong, T. Yu <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">et al.</em>, “Palm-e: An embodied multimodal language model,” <em class="ltx_emph ltx_font_italic" id="bib.bib5.2.2">arXiv preprint arXiv:2303.03378</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
C. Li, B. Pang, Y. Liu, H. Sun, Z. Liu, X. Xie, T. Yang, Y. Cui, L. Zhang, and Q. Zhang, “Adsgnn: Behavior-graph augmented relevance modeling in sponsored search,” in <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 2021, pp. 223–232.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
J. Zhao, M. Qu, C. Li, H. Yan, Q. Liu, R. Li, X. Xie, and J. Tang, “Learning on large-scale text-attributed graphs via variational inference,” <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">arXiv preprint arXiv:2210.14709</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
L. Hu, Z. Liu, Z. Zhao, L. Hou, L. Nie, and J. Li, “A survey of knowledge enhanced pre-trained language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
L. Yang, H. Chen, Z. Li, X. Ding, and X. Wu, “Give us the facts: Enhancing large language models with knowledge graphs for fact-aware language modeling,” <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S. Pan, L. Luo, Y. Wang, C. Chen, J. Wang, and X. Wu, “Unifying large language models and knowledge graphs: A roadmap,” <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Y. Gao, T. Sheng, Y. Xiang, Y. Xiong, H. Wang, and J. Zhang, “Chat-rec: Towards interactive and explainable llms-augmented recommender system,” <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">arXiv preprint arXiv:2303.14524</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
W.-C. Kang, J. Ni, N. Mehta, M. Sathiamoorthy, L. Hong, E. Chi, and D. Z. Cheng, “Do llms understand user preferences? evaluating llms on user rating prediction,” <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2305.06474</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Y. Song, P. Sun, H. Liu, Z. Li, W. Song, Y. Xiao, and X. Zhou, “Scene-driven multimodal knowledge graph construction for embodied ai,” <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">IEEE Transactions on Knowledge and Data Engineering</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
J. Lin, R. Shan, C. Zhu, K. Du, B. Chen, S. Quan, R. Tang, Y. Yu, and W. Zhang, “Rella: Retrieval-enhanced large language models for lifelong sequential behavior comprehension in recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">arXiv preprint arXiv:2308.11131</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
S. Geng, S. Liu, Z. Fu, Y. Ge, and Y. Zhang, “Recommendation as language processing (rlp): A unified pretrain, personalized prompt &amp; predict paradigm (p5),” in <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>, 2022, pp. 299–315.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
S. Rajput, N. Mehta, A. Singh, R. H. Keshavan, T. Vu, L. Heldt, L. Hong, Y. Tay, V. Q. Tran, J. Samost <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">et al.</em>, “Recommender systems with generative retrieval,” <em class="ltx_emph ltx_font_italic" id="bib.bib16.2.2">arXiv preprint arXiv:2305.05065</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Y. Zhang, F. Feng, J. Zhang, K. Bao, Q. Wang, and X. He, “Collm: Integrating collaborative embeddings into large language models for recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">arXiv preprint arXiv:2310.19488</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
J. Qiu, H. Wang, Z. Hong, Y. Yang, Q. Liu, and X. Wang, “Controlrec: Bridging the semantic gap between language model and personalized recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2311.16441</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
X. Li, B. Chen, L. Hou, and R. Tang, “Ctrl: Connect tabular and language model for ctr prediction,” <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">arXiv preprint arXiv:2306.02841</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
H. Wang, S. Feng, T. He, Z. Tan, X. Han, and Y. Tsvetkov, “Can language models solve graph problems in natural language?” <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2305.10037</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
K. He, H. Fan, Y. Wu, S. Xie, and R. Girshick, “Momentum contrast for unsupervised visual representation learning,” in <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</em>, 2020, pp. 9729–9738.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
W. He, G. Sun, J. Lu, and X. S. Fang, “Candidate-aware graph contrastive learning for recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 46th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>, 2023, pp. 1670–1679.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
L. Wu, Z. Zheng, Z. Qiu, H. Wang, H. Gu, T. Shen, C. Qin, C. Zhu, H. Zhu, Q. Liu <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">et al.</em>, “A survey on large language models for recommendation,” <em class="ltx_emph ltx_font_italic" id="bib.bib23.2.2">arXiv preprint arXiv:2305.19860</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Z. Cui, J. Ma, C. Zhou, J. Zhou, and H. Yang, “M6-rec: Generative pretrained language models are open-ended recommender systems,” <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">arXiv preprint arXiv:2205.08084</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
W. Hua, S. Xu, Y. Ge, and Y. Zhang, “How to index item ids for recommendation foundation models,” in <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">Proceedings of the Annual International ACM SIGIR Conference on Research and Development in Information Retrieval in the Asia Pacific Region</em>, ser. SIGIR-AP ’23.   ACM, Nov. 2023. [Online]. Available: <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://dx.doi.org/10.1145/3624918.3625339" title="">http://dx.doi.org/10.1145/3624918.3625339</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
S. Gururangan, A. Marasović, S. Swayamdipta, K. Lo, I. Beltagy, D. Downey, and N. A. Smith, “Don’t stop pretraining: Adapt language models to domains and tasks,” <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">arXiv preprint arXiv:2004.10964</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
E. Chien, W.-C. Chang, C.-J. Hsieh, H.-F. Yu, J. Zhang, O. Milenkovic, and I. S. Dhillon, “Node feature extraction by self-supervised multi-scale neighborhood prediction,” <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:2111.00064</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
M. Yasunaga, J. Leskovec, and P. Liang, “Linkbert: Pretraining language models with document links,” <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">arXiv preprint arXiv:2203.15827</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
J. Zhu, Y. Cui, Y. Liu, H. Sun, X. Li, M. Pelger, T. Yang, L. Zhang, R. Zhang, and H. Zhao, “Textgnn: Improving text encoder via graph neural network in sponsored search,” in <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">Proceedings of the Web Conference 2021</em>, 2021, pp. 2848–2857.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
J. Yang, Z. Liu, S. Xiao, C. Li, D. Lian, S. Agrawal, A. Singh, G. Sun, and X. Xie, “Graphformers: Gnn-nested transformers for representation learning on textual graph,” <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Advances in Neural Information Processing Systems</em>, vol. 34, pp. 28 798–28 810, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
H. Liu, J. Feng, L. Kong, N. Liang, D. Tao, Y. Chen, and M. Zhang, “One for all: Towards training one graph model for all classification tasks,” <em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2310.00149</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
X. He, X. Bresson, T. Laurent, A. Perold, Y. LeCun, and B. Hooi, “Harnessing explanations: Llm-to-lm interpreter for enhanced text-attributed graph representation learning,” in <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">The Twelfth International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Y. Wang, Z. Chu, X. Ouyang, S. Wang, H. Hao, Y. Shen, J. Gu, S. Xue, J. Y. Zhang, Q. Cui <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">et al.</em>, “Enhancing recommender systems with large language model reasoning graphs,” <em class="ltx_emph ltx_font_italic" id="bib.bib33.2.2">arXiv preprint arXiv:2308.10835</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
J. Guo, L. Du, and H. Liu, “Gpt4graph: Can large language models understand graph structured data? an empirical evaluation and benchmarking,” <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">arXiv preprint arXiv:2305.15066</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
B. Jin, Y. Zhang, Q. Zhu, and J. Han, “Heterformer: Transformer-based deep node representation learning on heterogeneous text-rich networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">arXiv preprint arXiv:2205.10282</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
H. Xie, D. Zheng, J. Ma, H. Zhang, V. N. Ioannidis, X. Song, Q. Ping, S. Wang, C. Yang, Y. Xu <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">et al.</em>, “Graph-aware language model pre-training on a large graph corpus can help multiple graph applications,” <em class="ltx_emph ltx_font_italic" id="bib.bib36.2.2">arXiv preprint arXiv:2306.02592</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
L. Wu, H. Zhao, Z. Li, Z. Huang, Q. Liu, and E. Chen, “Learning the explainable semantic relations via unified graph topic-disentangled neural networks,” <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">ACM Transactions on Knowledge Discovery from Data</em>, vol. 17, no. 8, pp. 1–23, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
J. Zhao, L. Zhuo, Y. Shen, M. Qu, K. Liu, M. Bronstein, Z. Zhu, and J. Tang, “Graphtext: Graph reasoning in text space,” <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2310.01089</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
L. Wu, Z. Qiu, Z. Zheng, H. Zhu, and E. Chen, “Exploring large language model for graph data understanding in online job recommendations,” <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2307.05722</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
R. Chen, T. Zhao, A. Jaiswal, N. Shah, and Z. Wang, “Llaga: Large language and graph assistant,” <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">arXiv preprint arXiv:2402.08170</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
J. Yu, R. He, and R. Ying, “Thought propagation: An analogical approach to complex reasoning with large language models,” <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2310.03965</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
J. Tang and K. Wang, “Personalized top-n sequential recommendation via convolutional sequence embedding,” in <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">Proceedings of the eleventh ACM international conference on web search and data mining</em>, 2018, pp. 565–573.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
F. Sun, J. Liu, J. Wu, C. Pei, X. Lin, W. Ou, and P. Jiang, “Bert4rec: Sequential recommendation with bidirectional encoder representations from transformer,” in <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>, 2019, pp. 1441–1450.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
W.-C. Kang and J. McAuley, “Self-attentive sequential recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">2018 IEEE international conference on data mining (ICDM)</em>.   IEEE, 2018, pp. 197–206.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
K. Zhou, H. Wang, W. X. Zhao, Y. Zhu, S. Wang, F. Zhang, Z. Wang, and J.-R. Wen, “S3-rec: Self-supervised learning for sequential recommendation with mutual information maximization,” in <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Proceedings of the 29th ACM international conference on information &amp; knowledge management</em>, 2020, pp. 1893–1902.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
X. He, K. Deng, X. Wang, Y. Li, Y. Zhang, and M. Wang, “Lightgcn: Simplifying and powering graph convolution network for recommendation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval</em>, 2020, pp. 639–648.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
C. Raffel, N. Shazeer, A. Roberts, K. Lee, S. Narang, M. Matena, Y. Zhou, W. Li, and P. J. Liu, “Exploring the limits of transfer learning with a unified text-to-text transformer,” <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">The Journal of Machine Learning Research</em>, vol. 21, no. 1, pp. 5485–5551, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
X. Zhao, M. Wang, X. Zhao, J. Li, S. Zhou, D. Yin, Q. Li, J. Tang, and R. Guo, “Embedding in recommender systems: A survey,” 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Z. I. Botev, J. F. Grotowski, and D. P. Kroese, “Kernel density estimation via diffusion,” 2010.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
X. Chen, S. Xie, and K. He, “An empirical study of training self-supervised vision transformers. in 2021 ieee,” in <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">CVF International Conference on Computer Vision (ICCV)</em>, pp. 9620–9629.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div about="" class="ltx_rdf" content="How to do this" property="dcterms:title"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Jun 19 05:43:32 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
