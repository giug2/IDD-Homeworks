<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2109.07258] Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting</title><meta property="og:description" content="Chemistry research has both high material and computational costs to conduct experiments. Intuitions are interested in differing classes of molecules, creating heterogeneous data that cannot be easily joined by convent…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2109.07258">

<!--Generated on Fri Mar  1 19:27:00 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_fleqn">
<h1 class="ltx_title ltx_title_document">Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Wei Zhu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:wzhu15@ur.rochester.edu">wzhu15@ur.rochester.edu</a>
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiebo Luo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:jluo@cs.rochester.edu">jluo@cs.rochester.edu</a>
</span>
<span class="ltx_contact ltx_role_address">Department of Computer Science, University of Rochester
</span>
<span class="ltx_contact ltx_role_address">Department of Chemical Engineering, University of Rochester
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Andrew D. White<sup id="id2.2.id1" class="ltx_sup">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:andrew.white@rochester.edu">andrew.white@rochester.edu</a>
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id3.id1" class="ltx_p">Chemistry research has both high material and computational costs to conduct experiments. Intuitions are interested in differing classes of molecules, creating heterogeneous data that cannot be easily joined by conventional methods. This work introduces federated heterogeneous molecular learning. Federated learning allows end-users to build a global model collaboratively while keeping their training data isolated. We first simulate a heterogeneous federated learning benchmark (FedChem) by jointly performing scaffold splitting and latent Dirichlet allocation on existing datasets. Our results on FedChem show that significant learning challenges arise when working with heterogeneous molecules across clients. We then propose a method to alleviate the problem: Federated Learning by Instance reweighTing (FLIT(+)). FLIT(+) can align the local training across clients. Experiments conducted on FedChem validate the advantages of this method. This work should enable a new type of collaboration for improving AI in chemistry that mitigates concerns about sharing valuable chemical data.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
federated learning , molecular property prediction , graph neural network

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">There is an increasing trend to apply machine learning for molecule property prediction to avoid the expense of experiments or reduce the tremendous computational costs required for accurate quantum-chemical calculations.
A large focus has been on applying graph neural networks to predicting molecular properties <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib62" title="" class="ltx_ref">62</a>]</cite>. These works assume a central server that has access to all data.
However, such a centralized learning scenario may not represent how institutions share chemical data. Due to intellectual property concerns and the intrinsic value of chemical data, it can be difficult for academic labs, national labs, and private institutions to share their molecule datasets.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2109.07258/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="233" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>We illustrate heterogeneous federated molecular learning where three institutions focus on different types of molecules. The server has no access to training data.</figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">We propose federated learning to obtain a generalized global model without access to the private molecular data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. For federated learning, local models are trained with their data on the client-side and then are aggregated for a global one on the server-side without seeing the data. One of the main concerns for federated molecular property prediction is the heterogeneously distributed client data since institutions focus on specific categories of molecules for their research interests. For example, institutions may wish to collaborate to construct an accurate model of pharmacokinetic clearance time of small molecules. Each institution studies specific drug-like molecules and their variants for their therapeutic targets. Each institution cannot share molecules, but it is beneficial to have a model for clearance time. Trained local models will heavily deviate from each other in this example, and it is thus sub-optimal to directly apply vanilla federated learning methods, e.g., Federated Average (FedAvg), to aggregate the heterogeneous local models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. Although several works are proposed to handle the heterogeneity problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite>, a broader problem is the lack of heterogeneous federated molecular learning benchmarks to judge these methods for chemical data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">This paper first proposes a federated heterogeneous molecular learning benchmark (FedChem). FedChem simulates the heterogeneous settings based on scaffold splitting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and Latent Dirichlet Allocation (LDA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. We first adopt scaffold splitting to split the molecules based on their two-dimensional structure, and molecules with similar structures are grouped accordingly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>. Then, a heterogeneous setting is obtained by applying LDA on the scaffold subgroups, where LDA is a commonly used technique to simulate heterogeneous settings in conventional federated classification tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>. We benchmark existing federated learning methods on the proposed heterogeneous suites FedChem and observer a remarkable performance degradation for the commonly used method FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. We then propose Federated Learning with Instance reweighTing (FLIT) to alleviate the heterogeneity problem by adapting focal loss for federated learning. The motivation of FLIT is that local models will be trained to overfit their data, which, however, do not share the same distribution as the global one. That is, the prediction of local models would be over-confident for certain types of molecules while with high uncertainty for others. FLIT can align the client training by adding weights to the uncertain cases by utilizing the local and received global models. As a result, the locally trained model will be more consistent with each other, and the federated learning performance can be eventually improved. We measure the uncertainty for training samples by the loss values and the prediction consistency among neighbored samples and develop two methods as FLIT and FLIT+ (FLIT(+) being the abbreviation for both). Our experiments on the proposed benchmark FedChem validate the advantages of FLIT(+) over existing federated learning methods.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Our main contributions are summarized as follows:</p>
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a federated heterogeneous molecular learning benchmark based on MoleculeNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>, termed as FedChem. FedChem employs scaffold splitting and LDA to simulate the heterogeneous settings;</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose FLIT(+) algorithms to alleviate the heterogeneity problem. FLIT(+) can align the client training by putting more weights on uncertain samples;</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We conduct experiments to benchmark the proposed and existing federated learning methods on FedChem. Comprehensive experiments validate the effectiveness of the proposed methods.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Federated learning was proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> and has been applied in a wide range of fields including healthcare <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, biometrics <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, natural images and videos <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib61" title="" class="ltx_ref">61</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. As a popular method, Federated averaging (FedAvg) element-wisely aggregates the parameters of local models to obtain a global one  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. However, recent studies indicate that FedAvg may not handle the heterogeneity problem properly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. There are two categories of methods developed to alleviate the problem: improvements for server-side aggregation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib67" title="" class="ltx_ref">67</a>, <a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib64" title="" class="ltx_ref">64</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> and client-side regularization methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">Client-side methods can use the local training data and attract increasing attention. Our method also follows this line of research. Federated Proximal (FedProx) regularizes the local learning with a proximal term to encourage the updated local model not to deviate significantly from the global model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>. A similar idea is adopted in personalized federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. SCAFFOLD adopts additional control variates to alleviate the gradient dissimilarity across different communication round <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. Federated Model Distillation transfers the soft predictions of a shared dataset to reduce the communication cost and regularizes the local training with distillation loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. Federated meta-learning incorporates MAML for local training to improve the generalization ability of local models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. Robust federated learning has been studied by several works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>, <a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. FLRA adversarially conducts training on clients to make the model robust to affine distribution shifts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. Most of the client-side federated learning methods add a regularization term to restrict the local training process so that the optimized local model would not deviate from the global one significantly <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite>. Consequently, the local models will be more consistent with each other, and the consistency could benefit the server-side aggregation. However, the regularization may also hinder the local optimization and lead to sub-optimal results for local training. Our method does not impose constraints on the local training and alternatively, we instance-wisely reweight the local training samples to align the local data distribution to the global one inspired by recent work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p">Heterogeneous federated learning is related to federated domain adaptation (FDA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib63" title="" class="ltx_ref">63</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>. FDA aims to improve the performance for specific target training domains, while general heterogeneous federated learning aims to improve the performance for all training data.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p">There are several works focusing on Federated Graph Neural Networks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>, <a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib52" title="" class="ltx_ref">52</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> and federated molecular property prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. GraphFL applies MAML to improve the robustness of training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>]</cite>. The method in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib58" title="" class="ltx_ref">58</a>]</cite> alleviates the heterogeneity problem by group-wisely aggregating clients’ models. However, existing work does not study federated molecular learning in heterogeneous settings where the clients’ datasets are non-IID distributed in molecular structure and properties.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Deep Molecular Property Prediction</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Graph neural network is commonly adopted for molecular learning  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. MPNN iteratively propagates the vertex features through message passing layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. SchNet adopts continuous-filter convolution to achieve E(3)-invariant molecular learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. DimeNet and DimeNet++ include directional information when training graph neural network for better performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. Other works apply SO(3) equivariance message passing layer to predict the properties of molecular data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. A new structure is proposed by EQNN to efficiently achieve E(n) equivalent <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>. We employ MPNN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and SchNetThe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> for client-side training in the proposed federated molecular learning framework FedChem, and our framework can seamlessly integrate other models for client-side training, <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_italic">e.g.</span>, other graph network network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> , sequence model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, etc.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Federated Heterogeneous Molecule Learning</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Notations and Settings</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">We first briefly describe Federated Heterogeneous Molecular Learning (FedChem). We assume that there are <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">L</annotation></semantics></math> institutions that work on the same tasks with roughly different groups of molecules. That is, the data are distributed heterogeneously across institutions. Each institution develop a neural network for molecular property prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib48" title="" class="ltx_ref">48</a>, <a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>. The neural network trained on their data may suffer from poor generalization ability, and they thus intend to collaborate for a global model without sharing their data with the central server and other participants.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.13" class="ltx_p">We propose to apply federated learning to obtain a global model for all participants without access to clients’ data. Formally, we denote the overall dataset as <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="X=\{X^{l}\}_{l=1}^{L}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml">X</mi><mo id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">=</mo><msubsup id="S3.SS1.p2.1.m1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.cmml"><mrow id="S3.SS1.p2.1.m1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml">{</mo><msup id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2.cmml">X</mi><mi id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.1.m1.1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.1.1.3.2.cmml">l</mi><mo id="S3.SS1.p2.1.m1.1.1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p2.1.m1.1.1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.1.m1.1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.1.3.cmml">L</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><eq id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2"></eq><ci id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3">𝑋</ci><apply id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.1.m1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1">subscript</csymbol><set id="S3.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1"><apply id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="S3.SS1.p2.1.m1.1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3"><eq id="S3.SS1.p2.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3.1"></eq><ci id="S3.SS1.p2.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.1.m1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.1.m1.1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.1.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">X=\{X^{l}\}_{l=1}^{L}</annotation></semantics></math>, where <math id="S3.SS1.p2.2.m2.3" class="ltx_Math" alttext="X^{l}=(G^{l},y^{l})=\{(g^{l}_{i},y^{l}_{i})\}_{i=1}^{N_{l}}" display="inline"><semantics id="S3.SS1.p2.2.m2.3a"><mrow id="S3.SS1.p2.2.m2.3.3" xref="S3.SS1.p2.2.m2.3.3.cmml"><msup id="S3.SS1.p2.2.m2.3.3.5" xref="S3.SS1.p2.2.m2.3.3.5.cmml"><mi id="S3.SS1.p2.2.m2.3.3.5.2" xref="S3.SS1.p2.2.m2.3.3.5.2.cmml">X</mi><mi id="S3.SS1.p2.2.m2.3.3.5.3" xref="S3.SS1.p2.2.m2.3.3.5.3.cmml">l</mi></msup><mo id="S3.SS1.p2.2.m2.3.3.6" xref="S3.SS1.p2.2.m2.3.3.6.cmml">=</mo><mrow id="S3.SS1.p2.2.m2.2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.2.2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.2.3.cmml">(</mo><msup id="S3.SS1.p2.2.m2.1.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.2" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml">G</mi><mi id="S3.SS1.p2.2.m2.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S3.SS1.p2.2.m2.2.2.2.2.4" xref="S3.SS1.p2.2.m2.2.2.2.3.cmml">,</mo><msup id="S3.SS1.p2.2.m2.2.2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.2.m2.2.2.2.2.2.2" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p2.2.m2.2.2.2.2.2.3" xref="S3.SS1.p2.2.m2.2.2.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="S3.SS1.p2.2.m2.2.2.2.2.5" xref="S3.SS1.p2.2.m2.2.2.2.3.cmml">)</mo></mrow><mo id="S3.SS1.p2.2.m2.3.3.7" xref="S3.SS1.p2.2.m2.3.3.7.cmml">=</mo><msubsup id="S3.SS1.p2.2.m2.3.3.3" xref="S3.SS1.p2.2.m2.3.3.3.cmml"><mrow id="S3.SS1.p2.2.m2.3.3.3.1.1.1" xref="S3.SS1.p2.2.m2.3.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.3.3.3.1.1.1.2" xref="S3.SS1.p2.2.m2.3.3.3.1.1.2.cmml">{</mo><mrow id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.3" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.3.cmml">(</mo><msubsup id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.2.2" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.3" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.3.cmml">i</mi><mi id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.2.3" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.4" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.3.cmml">,</mo><msubsup id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.cmml"><mi id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.2.2" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.3" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.3.cmml">i</mi><mi id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.2.3" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.5" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p2.2.m2.3.3.3.1.1.1.3" xref="S3.SS1.p2.2.m2.3.3.3.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.2.m2.3.3.3.1.3" xref="S3.SS1.p2.2.m2.3.3.3.1.3.cmml"><mi id="S3.SS1.p2.2.m2.3.3.3.1.3.2" xref="S3.SS1.p2.2.m2.3.3.3.1.3.2.cmml">i</mi><mo id="S3.SS1.p2.2.m2.3.3.3.1.3.1" xref="S3.SS1.p2.2.m2.3.3.3.1.3.1.cmml">=</mo><mn id="S3.SS1.p2.2.m2.3.3.3.1.3.3" xref="S3.SS1.p2.2.m2.3.3.3.1.3.3.cmml">1</mn></mrow><msub id="S3.SS1.p2.2.m2.3.3.3.3" xref="S3.SS1.p2.2.m2.3.3.3.3.cmml"><mi id="S3.SS1.p2.2.m2.3.3.3.3.2" xref="S3.SS1.p2.2.m2.3.3.3.3.2.cmml">N</mi><mi id="S3.SS1.p2.2.m2.3.3.3.3.3" xref="S3.SS1.p2.2.m2.3.3.3.3.3.cmml">l</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.3b"><apply id="S3.SS1.p2.2.m2.3.3.cmml" xref="S3.SS1.p2.2.m2.3.3"><and id="S3.SS1.p2.2.m2.3.3a.cmml" xref="S3.SS1.p2.2.m2.3.3"></and><apply id="S3.SS1.p2.2.m2.3.3b.cmml" xref="S3.SS1.p2.2.m2.3.3"><eq id="S3.SS1.p2.2.m2.3.3.6.cmml" xref="S3.SS1.p2.2.m2.3.3.6"></eq><apply id="S3.SS1.p2.2.m2.3.3.5.cmml" xref="S3.SS1.p2.2.m2.3.3.5"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.5.1.cmml" xref="S3.SS1.p2.2.m2.3.3.5">superscript</csymbol><ci id="S3.SS1.p2.2.m2.3.3.5.2.cmml" xref="S3.SS1.p2.2.m2.3.3.5.2">𝑋</ci><ci id="S3.SS1.p2.2.m2.3.3.5.3.cmml" xref="S3.SS1.p2.2.m2.3.3.5.3">𝑙</ci></apply><interval closure="open" id="S3.SS1.p2.2.m2.2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2"><apply id="S3.SS1.p2.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.2">𝐺</ci><ci id="S3.SS1.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1.1.3">𝑙</ci></apply><apply id="S3.SS1.p2.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p2.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p2.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.2.2.2.2.2.3">𝑙</ci></apply></interval></apply><apply id="S3.SS1.p2.2.m2.3.3c.cmml" xref="S3.SS1.p2.2.m2.3.3"><eq id="S3.SS1.p2.2.m2.3.3.7.cmml" xref="S3.SS1.p2.2.m2.3.3.7"></eq><share href="#S3.SS1.p2.2.m2.2.2.2.cmml" id="S3.SS1.p2.2.m2.3.3d.cmml" xref="S3.SS1.p2.2.m2.3.3"></share><apply id="S3.SS1.p2.2.m2.3.3.3.cmml" xref="S3.SS1.p2.2.m2.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.3.2.cmml" xref="S3.SS1.p2.2.m2.3.3.3">superscript</csymbol><apply id="S3.SS1.p2.2.m2.3.3.3.1.cmml" xref="S3.SS1.p2.2.m2.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.3.1.2.cmml" xref="S3.SS1.p2.2.m2.3.3.3">subscript</csymbol><set id="S3.SS1.p2.2.m2.3.3.3.1.1.2.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1"><interval closure="open" id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2"><apply id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.2.2">𝑔</ci><ci id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.1.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2">subscript</csymbol><apply id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.2.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2">superscript</csymbol><ci id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.2.2">𝑦</ci><ci id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.2.3">𝑙</ci></apply><ci id="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.3.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="S3.SS1.p2.2.m2.3.3.3.1.3.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.3"><eq id="S3.SS1.p2.2.m2.3.3.3.1.3.1.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.3.1"></eq><ci id="S3.SS1.p2.2.m2.3.3.3.1.3.2.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.3.2">𝑖</ci><cn type="integer" id="S3.SS1.p2.2.m2.3.3.3.1.3.3.cmml" xref="S3.SS1.p2.2.m2.3.3.3.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p2.2.m2.3.3.3.3.cmml" xref="S3.SS1.p2.2.m2.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.3.3.1.cmml" xref="S3.SS1.p2.2.m2.3.3.3.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.3.3.3.3.2.cmml" xref="S3.SS1.p2.2.m2.3.3.3.3.2">𝑁</ci><ci id="S3.SS1.p2.2.m2.3.3.3.3.3.cmml" xref="S3.SS1.p2.2.m2.3.3.3.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.3c">X^{l}=(G^{l},y^{l})=\{(g^{l}_{i},y^{l}_{i})\}_{i=1}^{N_{l}}</annotation></semantics></math> is the local dataset owned by the <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">l</annotation></semantics></math>-th institution/client which may not share the same distribution as the overall data. <math id="S3.SS1.p2.4.m4.2" class="ltx_Math" alttext="g^{l}_{i}=(v^{l}_{i},e^{l}_{i})" display="inline"><semantics id="S3.SS1.p2.4.m4.2a"><mrow id="S3.SS1.p2.4.m4.2.2" xref="S3.SS1.p2.4.m4.2.2.cmml"><msubsup id="S3.SS1.p2.4.m4.2.2.4" xref="S3.SS1.p2.4.m4.2.2.4.cmml"><mi id="S3.SS1.p2.4.m4.2.2.4.2.2" xref="S3.SS1.p2.4.m4.2.2.4.2.2.cmml">g</mi><mi id="S3.SS1.p2.4.m4.2.2.4.3" xref="S3.SS1.p2.4.m4.2.2.4.3.cmml">i</mi><mi id="S3.SS1.p2.4.m4.2.2.4.2.3" xref="S3.SS1.p2.4.m4.2.2.4.2.3.cmml">l</mi></msubsup><mo id="S3.SS1.p2.4.m4.2.2.3" xref="S3.SS1.p2.4.m4.2.2.3.cmml">=</mo><mrow id="S3.SS1.p2.4.m4.2.2.2.2" xref="S3.SS1.p2.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p2.4.m4.2.2.2.2.3" xref="S3.SS1.p2.4.m4.2.2.2.3.cmml">(</mo><msubsup id="S3.SS1.p2.4.m4.1.1.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.2.2" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.2.cmml">v</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml">i</mi><mi id="S3.SS1.p2.4.m4.1.1.1.1.1.2.3" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.SS1.p2.4.m4.2.2.2.2.4" xref="S3.SS1.p2.4.m4.2.2.2.3.cmml">,</mo><msubsup id="S3.SS1.p2.4.m4.2.2.2.2.2" xref="S3.SS1.p2.4.m4.2.2.2.2.2.cmml"><mi id="S3.SS1.p2.4.m4.2.2.2.2.2.2.2" xref="S3.SS1.p2.4.m4.2.2.2.2.2.2.2.cmml">e</mi><mi id="S3.SS1.p2.4.m4.2.2.2.2.2.3" xref="S3.SS1.p2.4.m4.2.2.2.2.2.3.cmml">i</mi><mi id="S3.SS1.p2.4.m4.2.2.2.2.2.2.3" xref="S3.SS1.p2.4.m4.2.2.2.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.SS1.p2.4.m4.2.2.2.2.5" xref="S3.SS1.p2.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.2b"><apply id="S3.SS1.p2.4.m4.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2"><eq id="S3.SS1.p2.4.m4.2.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.3"></eq><apply id="S3.SS1.p2.4.m4.2.2.4.cmml" xref="S3.SS1.p2.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.2.2.4.1.cmml" xref="S3.SS1.p2.4.m4.2.2.4">subscript</csymbol><apply id="S3.SS1.p2.4.m4.2.2.4.2.cmml" xref="S3.SS1.p2.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.2.2.4.2.1.cmml" xref="S3.SS1.p2.4.m4.2.2.4">superscript</csymbol><ci id="S3.SS1.p2.4.m4.2.2.4.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2.4.2.2">𝑔</ci><ci id="S3.SS1.p2.4.m4.2.2.4.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.4.2.3">𝑙</ci></apply><ci id="S3.SS1.p2.4.m4.2.2.4.3.cmml" xref="S3.SS1.p2.4.m4.2.2.4.3">𝑖</ci></apply><interval closure="open" id="S3.SS1.p2.4.m4.2.2.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2"><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1">subscript</csymbol><apply id="S3.SS1.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S3.SS1.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p2.4.m4.2.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.p2.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.2.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p2.4.m4.2.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2.2.2">𝑒</ci><ci id="S3.SS1.p2.4.m4.2.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2.2.3">𝑙</ci></apply><ci id="S3.SS1.p2.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.4.m4.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.2c">g^{l}_{i}=(v^{l}_{i},e^{l}_{i})</annotation></semantics></math> is the <math id="S3.SS1.p2.5.m5.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.5.m5.1a"><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">i</annotation></semantics></math>-th molecule in graph representation with vertex as <math id="S3.SS1.p2.6.m6.1" class="ltx_Math" alttext="v^{l}_{i}" display="inline"><semantics id="S3.SS1.p2.6.m6.1a"><msubsup id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2.2" xref="S3.SS1.p2.6.m6.1.1.2.2.cmml">v</mi><mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">i</mi><mi id="S3.SS1.p2.6.m6.1.1.2.3" xref="S3.SS1.p2.6.m6.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">subscript</csymbol><apply id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.2.1.cmml" xref="S3.SS1.p2.6.m6.1.1">superscript</csymbol><ci id="S3.SS1.p2.6.m6.1.1.2.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2.2">𝑣</ci><ci id="S3.SS1.p2.6.m6.1.1.2.3.cmml" xref="S3.SS1.p2.6.m6.1.1.2.3">𝑙</ci></apply><ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">v^{l}_{i}</annotation></semantics></math>, edge as <math id="S3.SS1.p2.7.m7.1" class="ltx_Math" alttext="e^{l}_{i}" display="inline"><semantics id="S3.SS1.p2.7.m7.1a"><msubsup id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml"><mi id="S3.SS1.p2.7.m7.1.1.2.2" xref="S3.SS1.p2.7.m7.1.1.2.2.cmml">e</mi><mi id="S3.SS1.p2.7.m7.1.1.3" xref="S3.SS1.p2.7.m7.1.1.3.cmml">i</mi><mi id="S3.SS1.p2.7.m7.1.1.2.3" xref="S3.SS1.p2.7.m7.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><apply id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">subscript</csymbol><apply id="S3.SS1.p2.7.m7.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.1">superscript</csymbol><ci id="S3.SS1.p2.7.m7.1.1.2.2.cmml" xref="S3.SS1.p2.7.m7.1.1.2.2">𝑒</ci><ci id="S3.SS1.p2.7.m7.1.1.2.3.cmml" xref="S3.SS1.p2.7.m7.1.1.2.3">𝑙</ci></apply><ci id="S3.SS1.p2.7.m7.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">e^{l}_{i}</annotation></semantics></math>, groundtruth label as <math id="S3.SS1.p2.8.m8.1" class="ltx_Math" alttext="y^{l}_{i}" display="inline"><semantics id="S3.SS1.p2.8.m8.1a"><msubsup id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml"><mi id="S3.SS1.p2.8.m8.1.1.2.2" xref="S3.SS1.p2.8.m8.1.1.2.2.cmml">y</mi><mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">i</mi><mi id="S3.SS1.p2.8.m8.1.1.2.3" xref="S3.SS1.p2.8.m8.1.1.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">subscript</csymbol><apply id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.2.1.cmml" xref="S3.SS1.p2.8.m8.1.1">superscript</csymbol><ci id="S3.SS1.p2.8.m8.1.1.2.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2.2">𝑦</ci><ci id="S3.SS1.p2.8.m8.1.1.2.3.cmml" xref="S3.SS1.p2.8.m8.1.1.2.3">𝑙</ci></apply><ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">y^{l}_{i}</annotation></semantics></math>. Ground truth could be either concrete values for regression tasks or categorical values for classification tasks. We utilize a local graph neural network <math id="S3.SS1.p2.9.m9.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S3.SS1.p2.9.m9.1a"><msup id="S3.SS1.p2.9.m9.1.1" xref="S3.SS1.p2.9.m9.1.1.cmml"><mi id="S3.SS1.p2.9.m9.1.1.2" xref="S3.SS1.p2.9.m9.1.1.2.cmml">F</mi><mi id="S3.SS1.p2.9.m9.1.1.3" xref="S3.SS1.p2.9.m9.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.1b"><apply id="S3.SS1.p2.9.m9.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1">superscript</csymbol><ci id="S3.SS1.p2.9.m9.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.2">𝐹</ci><ci id="S3.SS1.p2.9.m9.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.1c">F^{l}</annotation></semantics></math> to handle the data for the <math id="S3.SS1.p2.10.m10.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS1.p2.10.m10.1a"><mi id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b"><ci id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">l</annotation></semantics></math>-th client, and is implemented with Message Passing Neural Network (MPNN) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> or SchNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. To enable the clients to collaborate with each other, we have a central sever that receive and aggregate the uploaded local networks for a global one <math id="S3.SS1.p2.11.m11.1" class="ltx_Math" alttext="F^{g}=FedAgg(\{F^{l}\}_{l=1}^{L})" display="inline"><semantics id="S3.SS1.p2.11.m11.1a"><mrow id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml"><msup id="S3.SS1.p2.11.m11.1.1.3" xref="S3.SS1.p2.11.m11.1.1.3.cmml"><mi id="S3.SS1.p2.11.m11.1.1.3.2" xref="S3.SS1.p2.11.m11.1.1.3.2.cmml">F</mi><mi id="S3.SS1.p2.11.m11.1.1.3.3" xref="S3.SS1.p2.11.m11.1.1.3.3.cmml">g</mi></msup><mo id="S3.SS1.p2.11.m11.1.1.2" xref="S3.SS1.p2.11.m11.1.1.2.cmml">=</mo><mrow id="S3.SS1.p2.11.m11.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.1.3" xref="S3.SS1.p2.11.m11.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m11.1.1.1.2" xref="S3.SS1.p2.11.m11.1.1.1.2.cmml">​</mo><mi id="S3.SS1.p2.11.m11.1.1.1.4" xref="S3.SS1.p2.11.m11.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m11.1.1.1.2a" xref="S3.SS1.p2.11.m11.1.1.1.2.cmml">​</mo><mi id="S3.SS1.p2.11.m11.1.1.1.5" xref="S3.SS1.p2.11.m11.1.1.1.5.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m11.1.1.1.2b" xref="S3.SS1.p2.11.m11.1.1.1.2.cmml">​</mo><mi id="S3.SS1.p2.11.m11.1.1.1.6" xref="S3.SS1.p2.11.m11.1.1.1.6.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m11.1.1.1.2c" xref="S3.SS1.p2.11.m11.1.1.1.2.cmml">​</mo><mi id="S3.SS1.p2.11.m11.1.1.1.7" xref="S3.SS1.p2.11.m11.1.1.1.7.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m11.1.1.1.2d" xref="S3.SS1.p2.11.m11.1.1.1.2.cmml">​</mo><mi id="S3.SS1.p2.11.m11.1.1.1.8" xref="S3.SS1.p2.11.m11.1.1.1.8.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.11.m11.1.1.1.2e" xref="S3.SS1.p2.11.m11.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p2.11.m11.1.1.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p2.11.m11.1.1.1.1.1.2" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS1.p2.11.m11.1.1.1.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.cmml"><mrow id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.cmml">{</mo><msup id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.2.cmml">F</mi><mi id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.2" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.1" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.p2.11.m11.1.1.1.1.1.1.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.3.cmml">L</mi></msubsup><mo stretchy="false" id="S3.SS1.p2.11.m11.1.1.1.1.1.3" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b"><apply id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1"><eq id="S3.SS1.p2.11.m11.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.2"></eq><apply id="S3.SS1.p2.11.m11.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.3.1.cmml" xref="S3.SS1.p2.11.m11.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.3.2.cmml" xref="S3.SS1.p2.11.m11.1.1.3.2">𝐹</ci><ci id="S3.SS1.p2.11.m11.1.1.3.3.cmml" xref="S3.SS1.p2.11.m11.1.1.3.3">𝑔</ci></apply><apply id="S3.SS1.p2.11.m11.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1"><times id="S3.SS1.p2.11.m11.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.2"></times><ci id="S3.SS1.p2.11.m11.1.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.1.3">𝐹</ci><ci id="S3.SS1.p2.11.m11.1.1.1.4.cmml" xref="S3.SS1.p2.11.m11.1.1.1.4">𝑒</ci><ci id="S3.SS1.p2.11.m11.1.1.1.5.cmml" xref="S3.SS1.p2.11.m11.1.1.1.5">𝑑</ci><ci id="S3.SS1.p2.11.m11.1.1.1.6.cmml" xref="S3.SS1.p2.11.m11.1.1.1.6">𝐴</ci><ci id="S3.SS1.p2.11.m11.1.1.1.7.cmml" xref="S3.SS1.p2.11.m11.1.1.1.7">𝑔</ci><ci id="S3.SS1.p2.11.m11.1.1.1.8.cmml" xref="S3.SS1.p2.11.m11.1.1.1.8">𝑔</ci><apply id="S3.SS1.p2.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1">superscript</csymbol><apply id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1">subscript</csymbol><set id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1"><apply id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.2">𝐹</ci><ci id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></set><apply id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3"><eq id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.1"></eq><ci id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.p2.11.m11.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.11.m11.1.1.1.1.1.1.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">F^{g}=FedAgg(\{F^{l}\}_{l=1}^{L})</annotation></semantics></math>, where <math id="S3.SS1.p2.12.m12.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="S3.SS1.p2.12.m12.1a"><msup id="S3.SS1.p2.12.m12.1.1" xref="S3.SS1.p2.12.m12.1.1.cmml"><mi id="S3.SS1.p2.12.m12.1.1.2" xref="S3.SS1.p2.12.m12.1.1.2.cmml">F</mi><mi id="S3.SS1.p2.12.m12.1.1.3" xref="S3.SS1.p2.12.m12.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.12.m12.1b"><apply id="S3.SS1.p2.12.m12.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.12.m12.1.1.1.cmml" xref="S3.SS1.p2.12.m12.1.1">superscript</csymbol><ci id="S3.SS1.p2.12.m12.1.1.2.cmml" xref="S3.SS1.p2.12.m12.1.1.2">𝐹</ci><ci id="S3.SS1.p2.12.m12.1.1.3.cmml" xref="S3.SS1.p2.12.m12.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.12.m12.1c">F^{g}</annotation></semantics></math> is the global model, and <math id="S3.SS1.p2.13.m13.1" class="ltx_Math" alttext="FedAgg(\cdot)" display="inline"><semantics id="S3.SS1.p2.13.m13.1a"><mrow id="S3.SS1.p2.13.m13.1.2" xref="S3.SS1.p2.13.m13.1.2.cmml"><mi id="S3.SS1.p2.13.m13.1.2.2" xref="S3.SS1.p2.13.m13.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.13.m13.1.2.1" xref="S3.SS1.p2.13.m13.1.2.1.cmml">​</mo><mi id="S3.SS1.p2.13.m13.1.2.3" xref="S3.SS1.p2.13.m13.1.2.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.13.m13.1.2.1a" xref="S3.SS1.p2.13.m13.1.2.1.cmml">​</mo><mi id="S3.SS1.p2.13.m13.1.2.4" xref="S3.SS1.p2.13.m13.1.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.13.m13.1.2.1b" xref="S3.SS1.p2.13.m13.1.2.1.cmml">​</mo><mi id="S3.SS1.p2.13.m13.1.2.5" xref="S3.SS1.p2.13.m13.1.2.5.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.13.m13.1.2.1c" xref="S3.SS1.p2.13.m13.1.2.1.cmml">​</mo><mi id="S3.SS1.p2.13.m13.1.2.6" xref="S3.SS1.p2.13.m13.1.2.6.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.13.m13.1.2.1d" xref="S3.SS1.p2.13.m13.1.2.1.cmml">​</mo><mi id="S3.SS1.p2.13.m13.1.2.7" xref="S3.SS1.p2.13.m13.1.2.7.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.13.m13.1.2.1e" xref="S3.SS1.p2.13.m13.1.2.1.cmml">​</mo><mrow id="S3.SS1.p2.13.m13.1.2.8.2" xref="S3.SS1.p2.13.m13.1.2.cmml"><mo stretchy="false" id="S3.SS1.p2.13.m13.1.2.8.2.1" xref="S3.SS1.p2.13.m13.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS1.p2.13.m13.1.1" xref="S3.SS1.p2.13.m13.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS1.p2.13.m13.1.2.8.2.2" xref="S3.SS1.p2.13.m13.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.13.m13.1b"><apply id="S3.SS1.p2.13.m13.1.2.cmml" xref="S3.SS1.p2.13.m13.1.2"><times id="S3.SS1.p2.13.m13.1.2.1.cmml" xref="S3.SS1.p2.13.m13.1.2.1"></times><ci id="S3.SS1.p2.13.m13.1.2.2.cmml" xref="S3.SS1.p2.13.m13.1.2.2">𝐹</ci><ci id="S3.SS1.p2.13.m13.1.2.3.cmml" xref="S3.SS1.p2.13.m13.1.2.3">𝑒</ci><ci id="S3.SS1.p2.13.m13.1.2.4.cmml" xref="S3.SS1.p2.13.m13.1.2.4">𝑑</ci><ci id="S3.SS1.p2.13.m13.1.2.5.cmml" xref="S3.SS1.p2.13.m13.1.2.5">𝐴</ci><ci id="S3.SS1.p2.13.m13.1.2.6.cmml" xref="S3.SS1.p2.13.m13.1.2.6">𝑔</ci><ci id="S3.SS1.p2.13.m13.1.2.7.cmml" xref="S3.SS1.p2.13.m13.1.2.7">𝑔</ci><ci id="S3.SS1.p2.13.m13.1.1.cmml" xref="S3.SS1.p2.13.m13.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.13.m13.1c">FedAgg(\cdot)</annotation></semantics></math> is the aggregation function, <span id="S3.SS1.p2.13.1" class="ltx_text ltx_font_italic">e.g.</span>, Federated Averaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, Federated Optimzation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>, Federated Distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite>, FedDF <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, Federated Matched Averaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>, etc. Note that the central server contains no training data, and also cannot access any local data.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p">FedChem simulates heterogeneous federated molecular learning with existing datasets, <span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_italic">e.g.</span>, MoleculeNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>. Our method relies on scaffold splitting to group molecules based on their structure (graph). Molecules with similar structures are grouped into a scaffold subset. Scaffold splitting first groups the molecules into scaffold groups and then assign samples from each group to clients according to the unbalanced partition method Latent Dirichlet Allocation (LDA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. We detail the approach to generating heterogeneous settings in the experimental section.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p">Our method of generating a heterogeneous dataset is different from typical existing methods, which simulates label distribution shift <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. For example, <cite class="ltx_cite ltx_citemacro_citet">Karimireddy et al. [<a href="#bib.bib20" title="" class="ltx_ref">20</a>], Wang et al. [<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> split samples based on class to each client, which makes the label distributions of local datasets on clients inconsistent with the global label distribution. In reality, institutions focus on molecules with similar structures via processes like lead optimization or hit finding<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Thus we typically see structurally heterogeneous molecules on the client-side (domain shift), while the label distributions among local clients can be similar. To simulate the structural heterogeneity with existing centralized datasets, we adopt scaffold splitting and do not rely on the ground-truth label. Intuitively, samples from different scaffold subsets are analogous to the samples from different domains for general machine learning tasks, and molecules (images) within a scaffold subset (domain) share similar structures (style) but show different chemical properties (ground-truth label). We illustrate the scaffold splitting to help readers better understand our heterogeneity simulation method. Moreover, it is non-trivial to generalize existing heterogeneous federated dataset simulation methods to regression and multi-label tasks, while our method can be easily adapted to any problems. We benchmark several existing federated learning methods on FedChem and observe that the heterogeneity problem brings significant challenges to federated molecular learning.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> Federated Heterogeneous Molecule Learning (FedChem with FedAvg)</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg1.l1.2" class="ltx_text ltx_font_bold">Input:</span> # clients <math id="alg1.l1.m1.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">L</annotation></semantics></math>, # local updates <math id="alg1.l1.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">T</annotation></semantics></math>, # Comms round <math id="alg1.l1.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">C</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg1.l2.2" class="ltx_text ltx_font_bold">Output:</span> Global Model <math id="alg1.l2.m1.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">F</mi><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝐹</ci><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">F^{g}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.2.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>Server initialize a global model <math id="alg1.l3.m1.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="alg1.l3.m1.1a"><msup id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">F</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">superscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝐹</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">F^{g}</annotation></semantics></math> <span id="alg1.l3.1" class="ltx_text" style="float:right;"><math id="alg1.l3.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l3.1.m1.1a"><mo id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\triangleright</annotation></semantics></math> Server init.
</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><span id="alg1.l4.2" class="ltx_text ltx_font_bold">while</span> Communication Round <math id="alg1.l4.m1.1" class="ltx_Math" alttext="&lt;C" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"></mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">&lt;</mo><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><lt id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></lt><csymbol cd="latexml" id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">absent</csymbol><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">&lt;C</annotation></semantics></math> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     Server broadcasts <math id="alg1.l5.m1.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="alg1.l5.m1.1a"><msup id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">F</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝐹</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">F^{g}</annotation></semantics></math> to clients

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.2.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     <math id="alg1.l6.m1.1" class="ltx_Math" alttext="F^{l}\leftarrow F^{g}" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><msup id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">F</mi><mi id="alg1.l6.m1.1.1.2.3" xref="alg1.l6.m1.1.1.2.3.cmml">l</mi></msup><mo stretchy="false" id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">←</mo><msup id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.3.2" xref="alg1.l6.m1.1.1.3.2.cmml">F</mi><mi id="alg1.l6.m1.1.1.3.3" xref="alg1.l6.m1.1.1.3.3.cmml">g</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><ci id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2">superscript</csymbol><ci id="alg1.l6.m1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.2.2">𝐹</ci><ci id="alg1.l6.m1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.2.3">𝑙</ci></apply><apply id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.3">superscript</csymbol><ci id="alg1.l6.m1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.3.2">𝐹</ci><ci id="alg1.l6.m1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">F^{l}\leftarrow F^{g}</annotation></semantics></math><span id="alg1.l6.1" class="ltx_text" style="float:right;"><math id="alg1.l6.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l6.1.m1.1a"><mo id="alg1.l6.1.m1.1.1" xref="alg1.l6.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.1.m1.1b"><ci id="alg1.l6.1.m1.1.1.cmml" xref="alg1.l6.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.1.m1.1c">\triangleright</annotation></semantics></math> Client init.
</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.2.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     <span id="alg1.l7.3" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l7.m1.1" class="ltx_Math" alttext="l:1" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">l</mi><mo lspace="0.278em" rspace="0.278em" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">:</mo><mn id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">:</ci><ci id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">𝑙</ci><cn type="integer" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">l:1</annotation></semantics></math> to <math id="alg1.l7.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">L</annotation></semantics></math> in parallel <span id="alg1.l7.4" class="ltx_text ltx_font_bold">do</span> <span id="alg1.l7.1" class="ltx_text" style="float:right;"><math id="alg1.l7.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l7.1.m1.1a"><mo id="alg1.l7.1.m1.1.1" xref="alg1.l7.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l7.1.m1.1b"><ci id="alg1.l7.1.m1.1.1.cmml" xref="alg1.l7.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.1.m1.1c">\triangleright</annotation></semantics></math> Client Update
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.4.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>         <span id="alg1.l8.5" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l8.m1.1" class="ltx_Math" alttext="t:1" display="inline"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">t</mi><mo lspace="0.278em" rspace="0.278em" id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">:</mo><mn id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">:</ci><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">t:1</annotation></semantics></math> to <math id="alg1.l8.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l8.m2.1a"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.1b"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.1c">K</annotation></semantics></math> <span id="alg1.l8.6" class="ltx_text ltx_font_bold">do</span> <span id="alg1.l8.3" class="ltx_text" style="float:right;"><math id="alg1.l8.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l8.1.m1.1a"><mo id="alg1.l8.1.m1.1.1" xref="alg1.l8.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l8.1.m1.1b"><ci id="alg1.l8.1.m1.1.1.cmml" xref="alg1.l8.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.1.m1.1c">\triangleright</annotation></semantics></math> Update <math id="alg1.l8.2.m2.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="alg1.l8.2.m2.1a"><msup id="alg1.l8.2.m2.1.1" xref="alg1.l8.2.m2.1.1.cmml"><mi id="alg1.l8.2.m2.1.1.2" xref="alg1.l8.2.m2.1.1.2.cmml">F</mi><mi id="alg1.l8.2.m2.1.1.3" xref="alg1.l8.2.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l8.2.m2.1b"><apply id="alg1.l8.2.m2.1.1.cmml" xref="alg1.l8.2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l8.2.m2.1.1.1.cmml" xref="alg1.l8.2.m2.1.1">superscript</csymbol><ci id="alg1.l8.2.m2.1.1.2.cmml" xref="alg1.l8.2.m2.1.1.2">𝐹</ci><ci id="alg1.l8.2.m2.1.1.3.cmml" xref="alg1.l8.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.2.m2.1c">F^{l}</annotation></semantics></math> for <math id="alg1.l8.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l8.3.m3.1a"><mi id="alg1.l8.3.m3.1.1" xref="alg1.l8.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l8.3.m3.1b"><ci id="alg1.l8.3.m3.1.1.cmml" xref="alg1.l8.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.3.m3.1c">K</annotation></semantics></math> steps
</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>              Sample a minibatch <math id="alg1.l9.m1.2" class="ltx_Math" alttext="\{g^{l}_{i},y^{l}_{i}\}_{i=1}^{B}\sim X^{l}" display="inline"><semantics id="alg1.l9.m1.2a"><mrow id="alg1.l9.m1.2.2" xref="alg1.l9.m1.2.2.cmml"><msubsup id="alg1.l9.m1.2.2.2" xref="alg1.l9.m1.2.2.2.cmml"><mrow id="alg1.l9.m1.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l9.m1.2.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.3.cmml">{</mo><msubsup id="alg1.l9.m1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg1.l9.m1.2.2.2.2.2.2.4" xref="alg1.l9.m1.2.2.2.2.2.3.cmml">,</mo><msubsup id="alg1.l9.m1.2.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.2.cmml"><mi id="alg1.l9.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l9.m1.2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg1.l9.m1.2.2.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="alg1.l9.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l9.m1.2.2.2.2.2.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="alg1.l9.m1.2.2.2.2.2.2.5" xref="alg1.l9.m1.2.2.2.2.2.3.cmml">}</mo></mrow><mrow id="alg1.l9.m1.2.2.2.2.4" xref="alg1.l9.m1.2.2.2.2.4.cmml"><mi id="alg1.l9.m1.2.2.2.2.4.2" xref="alg1.l9.m1.2.2.2.2.4.2.cmml">i</mi><mo id="alg1.l9.m1.2.2.2.2.4.1" xref="alg1.l9.m1.2.2.2.2.4.1.cmml">=</mo><mn id="alg1.l9.m1.2.2.2.2.4.3" xref="alg1.l9.m1.2.2.2.2.4.3.cmml">1</mn></mrow><mi id="alg1.l9.m1.2.2.2.4" xref="alg1.l9.m1.2.2.2.4.cmml">B</mi></msubsup><mo id="alg1.l9.m1.2.2.3" xref="alg1.l9.m1.2.2.3.cmml">∼</mo><msup id="alg1.l9.m1.2.2.4" xref="alg1.l9.m1.2.2.4.cmml"><mi id="alg1.l9.m1.2.2.4.2" xref="alg1.l9.m1.2.2.4.2.cmml">X</mi><mi id="alg1.l9.m1.2.2.4.3" xref="alg1.l9.m1.2.2.4.3.cmml">l</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.2b"><apply id="alg1.l9.m1.2.2.cmml" xref="alg1.l9.m1.2.2"><csymbol cd="latexml" id="alg1.l9.m1.2.2.3.cmml" xref="alg1.l9.m1.2.2.3">similar-to</csymbol><apply id="alg1.l9.m1.2.2.2.cmml" xref="alg1.l9.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2">superscript</csymbol><apply id="alg1.l9.m1.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2">subscript</csymbol><set id="alg1.l9.m1.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.2"><apply id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l9.m1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.2">𝑔</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg1.l9.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2">subscript</csymbol><apply id="alg1.l9.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2">superscript</csymbol><ci id="alg1.l9.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="alg1.l9.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2.2.3">𝑙</ci></apply><ci id="alg1.l9.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l9.m1.2.2.2.2.2.2.2.3">𝑖</ci></apply></set><apply id="alg1.l9.m1.2.2.2.2.4.cmml" xref="alg1.l9.m1.2.2.2.2.4"><eq id="alg1.l9.m1.2.2.2.2.4.1.cmml" xref="alg1.l9.m1.2.2.2.2.4.1"></eq><ci id="alg1.l9.m1.2.2.2.2.4.2.cmml" xref="alg1.l9.m1.2.2.2.2.4.2">𝑖</ci><cn type="integer" id="alg1.l9.m1.2.2.2.2.4.3.cmml" xref="alg1.l9.m1.2.2.2.2.4.3">1</cn></apply></apply><ci id="alg1.l9.m1.2.2.2.4.cmml" xref="alg1.l9.m1.2.2.2.4">𝐵</ci></apply><apply id="alg1.l9.m1.2.2.4.cmml" xref="alg1.l9.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l9.m1.2.2.4.1.cmml" xref="alg1.l9.m1.2.2.4">superscript</csymbol><ci id="alg1.l9.m1.2.2.4.2.cmml" xref="alg1.l9.m1.2.2.4.2">𝑋</ci><ci id="alg1.l9.m1.2.2.4.3.cmml" xref="alg1.l9.m1.2.2.4.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.2c">\{g^{l}_{i},y^{l}_{i}\}_{i=1}^{B}\sim X^{l}</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>              Update local model <math id="alg1.l10.m1.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="alg1.l10.m1.1a"><msup id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">F</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">superscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝐹</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">F^{l}</annotation></semantics></math> by gradient descent

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>         <span id="alg1.l11.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>         Client sends updated model <math id="alg1.l12.m1.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="alg1.l12.m1.1a"><msup id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">F</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">superscript</csymbol><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝐹</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">F^{l}</annotation></semantics></math> to Server

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>     <span id="alg1.l13.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.2.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>     Server gets <math id="alg1.l14.m1.2" class="ltx_Math" alttext="F^{g}\leftarrow\sum_{l=1}^{L}\frac{|X^{l}|}{|X|}F^{l}" display="inline"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.3" xref="alg1.l14.m1.2.3.cmml"><msup id="alg1.l14.m1.2.3.2" xref="alg1.l14.m1.2.3.2.cmml"><mi id="alg1.l14.m1.2.3.2.2" xref="alg1.l14.m1.2.3.2.2.cmml">F</mi><mi id="alg1.l14.m1.2.3.2.3" xref="alg1.l14.m1.2.3.2.3.cmml">g</mi></msup><mo rspace="0.111em" stretchy="false" id="alg1.l14.m1.2.3.1" xref="alg1.l14.m1.2.3.1.cmml">←</mo><mrow id="alg1.l14.m1.2.3.3" xref="alg1.l14.m1.2.3.3.cmml"><msubsup id="alg1.l14.m1.2.3.3.1" xref="alg1.l14.m1.2.3.3.1.cmml"><mo id="alg1.l14.m1.2.3.3.1.2.2" xref="alg1.l14.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l14.m1.2.3.3.1.2.3" xref="alg1.l14.m1.2.3.3.1.2.3.cmml"><mi id="alg1.l14.m1.2.3.3.1.2.3.2" xref="alg1.l14.m1.2.3.3.1.2.3.2.cmml">l</mi><mo id="alg1.l14.m1.2.3.3.1.2.3.1" xref="alg1.l14.m1.2.3.3.1.2.3.1.cmml">=</mo><mn id="alg1.l14.m1.2.3.3.1.2.3.3" xref="alg1.l14.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l14.m1.2.3.3.1.3" xref="alg1.l14.m1.2.3.3.1.3.cmml">L</mi></msubsup><mrow id="alg1.l14.m1.2.3.3.2" xref="alg1.l14.m1.2.3.3.2.cmml"><mfrac id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml"><mrow id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.2.1.cmml">|</mo><msup id="alg1.l14.m1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.2.cmml">X</mi><mi id="alg1.l14.m1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l14.m1.2.2.2.3" xref="alg1.l14.m1.2.2.2.2.cmml"><mo stretchy="false" id="alg1.l14.m1.2.2.2.3.1" xref="alg1.l14.m1.2.2.2.2.1.cmml">|</mo><mi id="alg1.l14.m1.2.2.2.1" xref="alg1.l14.m1.2.2.2.1.cmml">X</mi><mo stretchy="false" id="alg1.l14.m1.2.2.2.3.2" xref="alg1.l14.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.3.3.2.1" xref="alg1.l14.m1.2.3.3.2.1.cmml">​</mo><msup id="alg1.l14.m1.2.3.3.2.2" xref="alg1.l14.m1.2.3.3.2.2.cmml"><mi id="alg1.l14.m1.2.3.3.2.2.2" xref="alg1.l14.m1.2.3.3.2.2.2.cmml">F</mi><mi id="alg1.l14.m1.2.3.3.2.2.3" xref="alg1.l14.m1.2.3.3.2.2.3.cmml">l</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><apply id="alg1.l14.m1.2.3.cmml" xref="alg1.l14.m1.2.3"><ci id="alg1.l14.m1.2.3.1.cmml" xref="alg1.l14.m1.2.3.1">←</ci><apply id="alg1.l14.m1.2.3.2.cmml" xref="alg1.l14.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.2.1.cmml" xref="alg1.l14.m1.2.3.2">superscript</csymbol><ci id="alg1.l14.m1.2.3.2.2.cmml" xref="alg1.l14.m1.2.3.2.2">𝐹</ci><ci id="alg1.l14.m1.2.3.2.3.cmml" xref="alg1.l14.m1.2.3.2.3">𝑔</ci></apply><apply id="alg1.l14.m1.2.3.3.cmml" xref="alg1.l14.m1.2.3.3"><apply id="alg1.l14.m1.2.3.3.1.cmml" xref="alg1.l14.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.3.1.1.cmml" xref="alg1.l14.m1.2.3.3.1">superscript</csymbol><apply id="alg1.l14.m1.2.3.3.1.2.cmml" xref="alg1.l14.m1.2.3.3.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.3.1.2.1.cmml" xref="alg1.l14.m1.2.3.3.1">subscript</csymbol><sum id="alg1.l14.m1.2.3.3.1.2.2.cmml" xref="alg1.l14.m1.2.3.3.1.2.2"></sum><apply id="alg1.l14.m1.2.3.3.1.2.3.cmml" xref="alg1.l14.m1.2.3.3.1.2.3"><eq id="alg1.l14.m1.2.3.3.1.2.3.1.cmml" xref="alg1.l14.m1.2.3.3.1.2.3.1"></eq><ci id="alg1.l14.m1.2.3.3.1.2.3.2.cmml" xref="alg1.l14.m1.2.3.3.1.2.3.2">𝑙</ci><cn type="integer" id="alg1.l14.m1.2.3.3.1.2.3.3.cmml" xref="alg1.l14.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l14.m1.2.3.3.1.3.cmml" xref="alg1.l14.m1.2.3.3.1.3">𝐿</ci></apply><apply id="alg1.l14.m1.2.3.3.2.cmml" xref="alg1.l14.m1.2.3.3.2"><times id="alg1.l14.m1.2.3.3.2.1.cmml" xref="alg1.l14.m1.2.3.3.2.1"></times><apply id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2"><divide id="alg1.l14.m1.2.2.3.cmml" xref="alg1.l14.m1.2.2"></divide><apply id="alg1.l14.m1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1"><abs id="alg1.l14.m1.1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.2"></abs><apply id="alg1.l14.m1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.2">𝑋</ci><ci id="alg1.l14.m1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="alg1.l14.m1.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.3"><abs id="alg1.l14.m1.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.3.1"></abs><ci id="alg1.l14.m1.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.1">𝑋</ci></apply></apply><apply id="alg1.l14.m1.2.3.3.2.2.cmml" xref="alg1.l14.m1.2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.3.2.2.1.cmml" xref="alg1.l14.m1.2.3.3.2.2">superscript</csymbol><ci id="alg1.l14.m1.2.3.3.2.2.2.cmml" xref="alg1.l14.m1.2.3.3.2.2.2">𝐹</ci><ci id="alg1.l14.m1.2.3.3.2.2.3.cmml" xref="alg1.l14.m1.2.3.3.2.2.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">F^{g}\leftarrow\sum_{l=1}^{L}\frac{|X^{l}|}{|X|}F^{l}</annotation></semantics></math><span id="alg1.l14.1" class="ltx_text" style="float:right;"><math id="alg1.l14.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l14.1.m1.1a"><mo id="alg1.l14.1.m1.1.1" xref="alg1.l14.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l14.1.m1.1b"><ci id="alg1.l14.1.m1.1.1.cmml" xref="alg1.l14.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.1.m1.1c">\triangleright</annotation></semantics></math> Server Update
</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span><span id="alg1.l15.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">while</span>
</div>
</div>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Federated Learning with FedChem</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.7" class="ltx_p">The basic training pipeline for FedChem is briefly introduced as follows: we first initialize a global model <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msup id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">F</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝐹</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">F^{g}</annotation></semantics></math> at server-side, and then for each federated learning communication round: 1). the server broadcasts global model <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msup id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">F</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝐹</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">F^{g}</annotation></semantics></math> to clients; 2). clients conduct training in parallel, and specifically, the <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">l</annotation></semantics></math>-th client is trained with its own data <math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="X^{l}" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><msup id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">X</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑋</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">X^{l}</annotation></semantics></math> for an updated model as <math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><msup id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">F</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝐹</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">F^{l}</annotation></semantics></math>; 3) the server collects updated local models from clients and then aggregate these models into a global one as <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="F^{g}=FedAgg(\{F^{i}\}_{i=1}^{L})" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mrow id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><msup id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.3.2.cmml">F</mi><mi id="S3.SS2.p1.6.m6.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.3.3.cmml">g</mi></msup><mo id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">=</mo><mrow id="S3.SS2.p1.6.m6.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.3" xref="S3.SS2.p1.6.m6.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.1.2" xref="S3.SS2.p1.6.m6.1.1.1.2.cmml">​</mo><mi id="S3.SS2.p1.6.m6.1.1.1.4" xref="S3.SS2.p1.6.m6.1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.1.2a" xref="S3.SS2.p1.6.m6.1.1.1.2.cmml">​</mo><mi id="S3.SS2.p1.6.m6.1.1.1.5" xref="S3.SS2.p1.6.m6.1.1.1.5.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.1.2b" xref="S3.SS2.p1.6.m6.1.1.1.2.cmml">​</mo><mi id="S3.SS2.p1.6.m6.1.1.1.6" xref="S3.SS2.p1.6.m6.1.1.1.6.cmml">A</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.1.2c" xref="S3.SS2.p1.6.m6.1.1.1.2.cmml">​</mo><mi id="S3.SS2.p1.6.m6.1.1.1.7" xref="S3.SS2.p1.6.m6.1.1.1.7.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.1.2d" xref="S3.SS2.p1.6.m6.1.1.1.2.cmml">​</mo><mi id="S3.SS2.p1.6.m6.1.1.1.8" xref="S3.SS2.p1.6.m6.1.1.1.8.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.6.m6.1.1.1.2e" xref="S3.SS2.p1.6.m6.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.p1.6.m6.1.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m6.1.1.1.1.1.2" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS2.p1.6.m6.1.1.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.cmml"><mrow id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.2.cmml">{</mo><msup id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.2.cmml">F</mi><mi id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p1.6.m6.1.1.1.1.1.1.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.3.cmml">L</mi></msubsup><mo stretchy="false" id="S3.SS2.p1.6.m6.1.1.1.1.1.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><eq id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2"></eq><apply id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.3.2">𝐹</ci><ci id="S3.SS2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3">𝑔</ci></apply><apply id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1"><times id="S3.SS2.p1.6.m6.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.2"></times><ci id="S3.SS2.p1.6.m6.1.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.3">𝐹</ci><ci id="S3.SS2.p1.6.m6.1.1.1.4.cmml" xref="S3.SS2.p1.6.m6.1.1.1.4">𝑒</ci><ci id="S3.SS2.p1.6.m6.1.1.1.5.cmml" xref="S3.SS2.p1.6.m6.1.1.1.5">𝑑</ci><ci id="S3.SS2.p1.6.m6.1.1.1.6.cmml" xref="S3.SS2.p1.6.m6.1.1.1.6">𝐴</ci><ci id="S3.SS2.p1.6.m6.1.1.1.7.cmml" xref="S3.SS2.p1.6.m6.1.1.1.7">𝑔</ci><ci id="S3.SS2.p1.6.m6.1.1.1.8.cmml" xref="S3.SS2.p1.6.m6.1.1.1.8">𝑔</ci><apply id="S3.SS2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1">subscript</csymbol><set id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1"><apply id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.2">𝐹</ci><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3"><eq id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.1"></eq><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">F^{g}=FedAgg(\{F^{i}\}_{i=1}^{L})</annotation></semantics></math>. We iteratively perform steps 1-3 for <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mi id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><ci id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">C</annotation></semantics></math> communication rounds to obtain the final global model. We adopt FedAvg for server-side aggregation throughout the paper, but FedChem can be easily extended to involve other aggregation methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. We summarize the training procedure for federated learning with FedChem in Alg. <a href="#alg1" title="Algorithm 1 ‣ 3.1 Notations and Settings ‣ 3 Federated Heterogeneous Molecule Learning ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> by taking FedAvg as the aggregation method. Note that the server may select a subset of clients during each communication round for scalability.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Client-side Updates</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">For completeness, we describe typical training steps to update the GNN model for client side training. We adopt MPNNs2s (MPNN set-to-set) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and SchNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> for molecule-level property prediction in our experiments, and other popular models (such as DimeNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, GIN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib60" title="" class="ltx_ref">60</a>]</cite>, GCN <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, etc.) can also be unified in FedChem.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.7" class="ltx_p">Molecule-level GNN usually contains two phases: a message-passing phase and a readout phase <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. Message-passing phase allows the vertex to propagate and collect information from their neighbors through the graph, and is usually composed of two steps as message generation and vertex update. Formally, given the <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">l</annotation></semantics></math>-th client model <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><msup id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">F</mi><mi id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝐹</ci><ci id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">F^{l}</annotation></semantics></math> with <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">T</annotation></semantics></math> message passing layers and a sampled graph <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="G^{l}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msup id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">G</mi><mi id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">superscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝐺</ci><ci id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">G^{l}</annotation></semantics></math> (we omit the subscript for the sample, <span id="S3.SS3.p2.7.1" class="ltx_text ltx_font_italic">i.e.,</span> <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="G^{l}=G^{l}_{i}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mrow id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><msup id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2.2" xref="S3.SS3.p2.5.m5.1.1.2.2.cmml">G</mi><mi id="S3.SS3.p2.5.m5.1.1.2.3" xref="S3.SS3.p2.5.m5.1.1.2.3.cmml">l</mi></msup><mo id="S3.SS3.p2.5.m5.1.1.1" xref="S3.SS3.p2.5.m5.1.1.1.cmml">=</mo><msubsup id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml"><mi id="S3.SS3.p2.5.m5.1.1.3.2.2" xref="S3.SS3.p2.5.m5.1.1.3.2.2.cmml">G</mi><mi id="S3.SS3.p2.5.m5.1.1.3.3" xref="S3.SS3.p2.5.m5.1.1.3.3.cmml">i</mi><mi id="S3.SS3.p2.5.m5.1.1.3.2.3" xref="S3.SS3.p2.5.m5.1.1.3.2.3.cmml">l</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><eq id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1"></eq><apply id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.2.1.cmml" xref="S3.SS3.p2.5.m5.1.1.2">superscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2.2">𝐺</ci><ci id="S3.SS3.p2.5.m5.1.1.2.3.cmml" xref="S3.SS3.p2.5.m5.1.1.2.3">𝑙</ci></apply><apply id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.3.1.cmml" xref="S3.SS3.p2.5.m5.1.1.3">subscript</csymbol><apply id="S3.SS3.p2.5.m5.1.1.3.2.cmml" xref="S3.SS3.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.3.2.1.cmml" xref="S3.SS3.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.3.2.2.cmml" xref="S3.SS3.p2.5.m5.1.1.3.2.2">𝐺</ci><ci id="S3.SS3.p2.5.m5.1.1.3.2.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3.2.3">𝑙</ci></apply><ci id="S3.SS3.p2.5.m5.1.1.3.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">G^{l}=G^{l}_{i}</annotation></semantics></math>), we define the message-passing function <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="M_{t}^{l}" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><msubsup id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2.2" xref="S3.SS3.p2.6.m6.1.1.2.2.cmml">M</mi><mi id="S3.SS3.p2.6.m6.1.1.2.3" xref="S3.SS3.p2.6.m6.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">superscript</csymbol><apply id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.2.1.cmml" xref="S3.SS3.p2.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.2.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2.2">𝑀</ci><ci id="S3.SS3.p2.6.m6.1.1.2.3.cmml" xref="S3.SS3.p2.6.m6.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">M_{t}^{l}</annotation></semantics></math> on the <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">i</annotation></semantics></math>-th vertex as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite></p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E1.m1.10" class="ltx_math_unparsed" alttext="m^{l}_{t+1,i}=M_{t}^{l}(v^{l}_{t,i},\{v^{l}_{t,w},e^{l}_{t,iw}\}_{w\in N(i))})," display="block"><semantics id="S3.E1.m1.10a"><mrow id="S3.E1.m1.10.10.1"><mrow id="S3.E1.m1.10.10.1.1"><msubsup id="S3.E1.m1.10.10.1.1.4"><mi id="S3.E1.m1.10.10.1.1.4.2.2">m</mi><mrow id="S3.E1.m1.2.2.2.2"><mrow id="S3.E1.m1.2.2.2.2.1"><mi id="S3.E1.m1.2.2.2.2.1.2">t</mi><mo id="S3.E1.m1.2.2.2.2.1.1">+</mo><mn id="S3.E1.m1.2.2.2.2.1.3">1</mn></mrow><mo id="S3.E1.m1.2.2.2.2.2">,</mo><mi id="S3.E1.m1.1.1.1.1">i</mi></mrow><mi id="S3.E1.m1.10.10.1.1.4.2.3">l</mi></msubsup><mo id="S3.E1.m1.10.10.1.1.3">=</mo><mrow id="S3.E1.m1.10.10.1.1.2"><msubsup id="S3.E1.m1.10.10.1.1.2.4"><mi id="S3.E1.m1.10.10.1.1.2.4.2.2">M</mi><mi id="S3.E1.m1.10.10.1.1.2.4.2.3">t</mi><mi id="S3.E1.m1.10.10.1.1.2.4.3">l</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.10.10.1.1.2.3">​</mo><mrow id="S3.E1.m1.10.10.1.1.2.2.2"><mo stretchy="false" id="S3.E1.m1.10.10.1.1.2.2.2.3">(</mo><msubsup id="S3.E1.m1.10.10.1.1.1.1.1.1"><mi id="S3.E1.m1.10.10.1.1.1.1.1.1.2.2">v</mi><mrow id="S3.E1.m1.4.4.2.4"><mi id="S3.E1.m1.3.3.1.1">t</mi><mo id="S3.E1.m1.4.4.2.4.1">,</mo><mi id="S3.E1.m1.4.4.2.2">i</mi></mrow><mi id="S3.E1.m1.10.10.1.1.1.1.1.1.2.3">l</mi></msubsup><mo id="S3.E1.m1.10.10.1.1.2.2.2.4">,</mo><msub id="S3.E1.m1.10.10.1.1.2.2.2.2"><mrow id="S3.E1.m1.10.10.1.1.2.2.2.2.2.2"><mo stretchy="false" id="S3.E1.m1.10.10.1.1.2.2.2.2.2.2.3">{</mo><msubsup id="S3.E1.m1.10.10.1.1.2.2.2.2.1.1.1"><mi id="S3.E1.m1.10.10.1.1.2.2.2.2.1.1.1.2.2">v</mi><mrow id="S3.E1.m1.6.6.2.4"><mi id="S3.E1.m1.5.5.1.1">t</mi><mo id="S3.E1.m1.6.6.2.4.1">,</mo><mi id="S3.E1.m1.6.6.2.2">w</mi></mrow><mi id="S3.E1.m1.10.10.1.1.2.2.2.2.1.1.1.2.3">l</mi></msubsup><mo id="S3.E1.m1.10.10.1.1.2.2.2.2.2.2.4">,</mo><msubsup id="S3.E1.m1.10.10.1.1.2.2.2.2.2.2.2"><mi id="S3.E1.m1.10.10.1.1.2.2.2.2.2.2.2.2.2">e</mi><mrow id="S3.E1.m1.8.8.2.2"><mi id="S3.E1.m1.7.7.1.1">t</mi><mo id="S3.E1.m1.8.8.2.2.2">,</mo><mrow id="S3.E1.m1.8.8.2.2.1"><mi id="S3.E1.m1.8.8.2.2.1.2">i</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.8.8.2.2.1.1">​</mo><mi id="S3.E1.m1.8.8.2.2.1.3">w</mi></mrow></mrow><mi id="S3.E1.m1.10.10.1.1.2.2.2.2.2.2.2.2.3">l</mi></msubsup><mo stretchy="false" id="S3.E1.m1.10.10.1.1.2.2.2.2.2.2.5">}</mo></mrow><mrow id="S3.E1.m1.9.9.1"><mi id="S3.E1.m1.9.9.1.2">w</mi><mo id="S3.E1.m1.9.9.1.3">∈</mo><mi id="S3.E1.m1.9.9.1.4">N</mi><mrow id="S3.E1.m1.9.9.1.5"><mo stretchy="false" id="S3.E1.m1.9.9.1.5.1">(</mo><mi id="S3.E1.m1.9.9.1.1">i</mi><mo stretchy="false" id="S3.E1.m1.9.9.1.5.2">)</mo></mrow><mo stretchy="false" id="S3.E1.m1.9.9.1.6">)</mo></mrow></msub><mo stretchy="false" id="S3.E1.m1.10.10.1.1.2.2.2.5">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.10.10.1.2">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E1.m1.10b">m^{l}_{t+1,i}=M_{t}^{l}(v^{l}_{t,i},\{v^{l}_{t,w},e^{l}_{t,iw}\}_{w\in N(i))}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.8" class="ltx_p">and the vertex update function <math id="S3.SS3.p2.8.m1.1" class="ltx_Math" alttext="U_{t}^{l}" display="inline"><semantics id="S3.SS3.p2.8.m1.1a"><msubsup id="S3.SS3.p2.8.m1.1.1" xref="S3.SS3.p2.8.m1.1.1.cmml"><mi id="S3.SS3.p2.8.m1.1.1.2.2" xref="S3.SS3.p2.8.m1.1.1.2.2.cmml">U</mi><mi id="S3.SS3.p2.8.m1.1.1.2.3" xref="S3.SS3.p2.8.m1.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p2.8.m1.1.1.3" xref="S3.SS3.p2.8.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.8.m1.1b"><apply id="S3.SS3.p2.8.m1.1.1.cmml" xref="S3.SS3.p2.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m1.1.1.1.cmml" xref="S3.SS3.p2.8.m1.1.1">superscript</csymbol><apply id="S3.SS3.p2.8.m1.1.1.2.cmml" xref="S3.SS3.p2.8.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.8.m1.1.1.2.1.cmml" xref="S3.SS3.p2.8.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.8.m1.1.1.2.2.cmml" xref="S3.SS3.p2.8.m1.1.1.2.2">𝑈</ci><ci id="S3.SS3.p2.8.m1.1.1.2.3.cmml" xref="S3.SS3.p2.8.m1.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.8.m1.1.1.3.cmml" xref="S3.SS3.p2.8.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.8.m1.1c">U_{t}^{l}</annotation></semantics></math> as</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E2.m1.7" class="ltx_Math" alttext="v^{l}_{t+1,i}=U_{t}^{l}(v^{l}_{t,i},m^{l}_{t+1,i})," display="block"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1" xref="S3.E2.m1.7.7.1.1.cmml"><msubsup id="S3.E2.m1.7.7.1.1.4" xref="S3.E2.m1.7.7.1.1.4.cmml"><mi id="S3.E2.m1.7.7.1.1.4.2.2" xref="S3.E2.m1.7.7.1.1.4.2.2.cmml">v</mi><mrow id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.3.cmml"><mrow id="S3.E2.m1.2.2.2.2.1" xref="S3.E2.m1.2.2.2.2.1.cmml"><mi id="S3.E2.m1.2.2.2.2.1.2" xref="S3.E2.m1.2.2.2.2.1.2.cmml">t</mi><mo id="S3.E2.m1.2.2.2.2.1.1" xref="S3.E2.m1.2.2.2.2.1.1.cmml">+</mo><mn id="S3.E2.m1.2.2.2.2.1.3" xref="S3.E2.m1.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E2.m1.2.2.2.2.2" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">i</mi></mrow><mi id="S3.E2.m1.7.7.1.1.4.2.3" xref="S3.E2.m1.7.7.1.1.4.2.3.cmml">l</mi></msubsup><mo id="S3.E2.m1.7.7.1.1.3" xref="S3.E2.m1.7.7.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.7.7.1.1.2" xref="S3.E2.m1.7.7.1.1.2.cmml"><msubsup id="S3.E2.m1.7.7.1.1.2.4" xref="S3.E2.m1.7.7.1.1.2.4.cmml"><mi id="S3.E2.m1.7.7.1.1.2.4.2.2" xref="S3.E2.m1.7.7.1.1.2.4.2.2.cmml">U</mi><mi id="S3.E2.m1.7.7.1.1.2.4.2.3" xref="S3.E2.m1.7.7.1.1.2.4.2.3.cmml">t</mi><mi id="S3.E2.m1.7.7.1.1.2.4.3" xref="S3.E2.m1.7.7.1.1.2.4.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.2.3" xref="S3.E2.m1.7.7.1.1.2.3.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.2.2.2" xref="S3.E2.m1.7.7.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.2.2.2.3" xref="S3.E2.m1.7.7.1.1.2.2.3.cmml">(</mo><msubsup id="S3.E2.m1.7.7.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.2.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml">v</mi><mrow id="S3.E2.m1.4.4.2.4" xref="S3.E2.m1.4.4.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">t</mi><mo id="S3.E2.m1.4.4.2.4.1" xref="S3.E2.m1.4.4.2.3.cmml">,</mo><mi id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml">i</mi></mrow><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.2.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="S3.E2.m1.7.7.1.1.2.2.2.4" xref="S3.E2.m1.7.7.1.1.2.2.3.cmml">,</mo><msubsup id="S3.E2.m1.7.7.1.1.2.2.2.2" xref="S3.E2.m1.7.7.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.7.7.1.1.2.2.2.2.2.2" xref="S3.E2.m1.7.7.1.1.2.2.2.2.2.2.cmml">m</mi><mrow id="S3.E2.m1.6.6.2.2" xref="S3.E2.m1.6.6.2.3.cmml"><mrow id="S3.E2.m1.6.6.2.2.1" xref="S3.E2.m1.6.6.2.2.1.cmml"><mi id="S3.E2.m1.6.6.2.2.1.2" xref="S3.E2.m1.6.6.2.2.1.2.cmml">t</mi><mo id="S3.E2.m1.6.6.2.2.1.1" xref="S3.E2.m1.6.6.2.2.1.1.cmml">+</mo><mn id="S3.E2.m1.6.6.2.2.1.3" xref="S3.E2.m1.6.6.2.2.1.3.cmml">1</mn></mrow><mo id="S3.E2.m1.6.6.2.2.2" xref="S3.E2.m1.6.6.2.3.cmml">,</mo><mi id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml">i</mi></mrow><mi id="S3.E2.m1.7.7.1.1.2.2.2.2.2.3" xref="S3.E2.m1.7.7.1.1.2.2.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.E2.m1.7.7.1.1.2.2.2.5" xref="S3.E2.m1.7.7.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E2.m1.7.7.1.2" xref="S3.E2.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.1.1.cmml" xref="S3.E2.m1.7.7.1"><eq id="S3.E2.m1.7.7.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.3"></eq><apply id="S3.E2.m1.7.7.1.1.4.cmml" xref="S3.E2.m1.7.7.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.4.1.cmml" xref="S3.E2.m1.7.7.1.1.4">subscript</csymbol><apply id="S3.E2.m1.7.7.1.1.4.2.cmml" xref="S3.E2.m1.7.7.1.1.4"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.4.2.1.cmml" xref="S3.E2.m1.7.7.1.1.4">superscript</csymbol><ci id="S3.E2.m1.7.7.1.1.4.2.2.cmml" xref="S3.E2.m1.7.7.1.1.4.2.2">𝑣</ci><ci id="S3.E2.m1.7.7.1.1.4.2.3.cmml" xref="S3.E2.m1.7.7.1.1.4.2.3">𝑙</ci></apply><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.2"><apply id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.2.1"><plus id="S3.E2.m1.2.2.2.2.1.1.cmml" xref="S3.E2.m1.2.2.2.2.1.1"></plus><ci id="S3.E2.m1.2.2.2.2.1.2.cmml" xref="S3.E2.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S3.E2.m1.2.2.2.2.1.3.cmml" xref="S3.E2.m1.2.2.2.2.1.3">1</cn></apply><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑖</ci></list></apply><apply id="S3.E2.m1.7.7.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.2"><times id="S3.E2.m1.7.7.1.1.2.3.cmml" xref="S3.E2.m1.7.7.1.1.2.3"></times><apply id="S3.E2.m1.7.7.1.1.2.4.cmml" xref="S3.E2.m1.7.7.1.1.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.2.4.1.cmml" xref="S3.E2.m1.7.7.1.1.2.4">superscript</csymbol><apply id="S3.E2.m1.7.7.1.1.2.4.2.cmml" xref="S3.E2.m1.7.7.1.1.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.2.4.2.1.cmml" xref="S3.E2.m1.7.7.1.1.2.4">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.2.4.2.2.cmml" xref="S3.E2.m1.7.7.1.1.2.4.2.2">𝑈</ci><ci id="S3.E2.m1.7.7.1.1.2.4.2.3.cmml" xref="S3.E2.m1.7.7.1.1.2.4.2.3">𝑡</ci></apply><ci id="S3.E2.m1.7.7.1.1.2.4.3.cmml" xref="S3.E2.m1.7.7.1.1.2.4.3">𝑙</ci></apply><interval closure="open" id="S3.E2.m1.7.7.1.1.2.2.3.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2"><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1">subscript</csymbol><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.2.3">𝑙</ci></apply><list id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.4"><ci id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">𝑡</ci><ci id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2">𝑖</ci></list></apply><apply id="S3.E2.m1.7.7.1.1.2.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2.2">subscript</csymbol><apply id="S3.E2.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2.2">superscript</csymbol><ci id="S3.E2.m1.7.7.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2.2.2.2">𝑚</ci><ci id="S3.E2.m1.7.7.1.1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.7.7.1.1.2.2.2.2.2.3">𝑙</ci></apply><list id="S3.E2.m1.6.6.2.3.cmml" xref="S3.E2.m1.6.6.2.2"><apply id="S3.E2.m1.6.6.2.2.1.cmml" xref="S3.E2.m1.6.6.2.2.1"><plus id="S3.E2.m1.6.6.2.2.1.1.cmml" xref="S3.E2.m1.6.6.2.2.1.1"></plus><ci id="S3.E2.m1.6.6.2.2.1.2.cmml" xref="S3.E2.m1.6.6.2.2.1.2">𝑡</ci><cn type="integer" id="S3.E2.m1.6.6.2.2.1.3.cmml" xref="S3.E2.m1.6.6.2.2.1.3">1</cn></apply><ci id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1.1">𝑖</ci></list></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">v^{l}_{t+1,i}=U_{t}^{l}(v^{l}_{t,i},m^{l}_{t+1,i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p2.32" class="ltx_p">where <math id="S3.SS3.p2.9.m1.2" class="ltx_Math" alttext="v^{l}_{t,i}" display="inline"><semantics id="S3.SS3.p2.9.m1.2a"><msubsup id="S3.SS3.p2.9.m1.2.3" xref="S3.SS3.p2.9.m1.2.3.cmml"><mi id="S3.SS3.p2.9.m1.2.3.2.2" xref="S3.SS3.p2.9.m1.2.3.2.2.cmml">v</mi><mrow id="S3.SS3.p2.9.m1.2.2.2.4" xref="S3.SS3.p2.9.m1.2.2.2.3.cmml"><mi id="S3.SS3.p2.9.m1.1.1.1.1" xref="S3.SS3.p2.9.m1.1.1.1.1.cmml">t</mi><mo id="S3.SS3.p2.9.m1.2.2.2.4.1" xref="S3.SS3.p2.9.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.9.m1.2.2.2.2" xref="S3.SS3.p2.9.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS3.p2.9.m1.2.3.2.3" xref="S3.SS3.p2.9.m1.2.3.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.9.m1.2b"><apply id="S3.SS3.p2.9.m1.2.3.cmml" xref="S3.SS3.p2.9.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m1.2.3.1.cmml" xref="S3.SS3.p2.9.m1.2.3">subscript</csymbol><apply id="S3.SS3.p2.9.m1.2.3.2.cmml" xref="S3.SS3.p2.9.m1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.9.m1.2.3.2.1.cmml" xref="S3.SS3.p2.9.m1.2.3">superscript</csymbol><ci id="S3.SS3.p2.9.m1.2.3.2.2.cmml" xref="S3.SS3.p2.9.m1.2.3.2.2">𝑣</ci><ci id="S3.SS3.p2.9.m1.2.3.2.3.cmml" xref="S3.SS3.p2.9.m1.2.3.2.3">𝑙</ci></apply><list id="S3.SS3.p2.9.m1.2.2.2.3.cmml" xref="S3.SS3.p2.9.m1.2.2.2.4"><ci id="S3.SS3.p2.9.m1.1.1.1.1.cmml" xref="S3.SS3.p2.9.m1.1.1.1.1">𝑡</ci><ci id="S3.SS3.p2.9.m1.2.2.2.2.cmml" xref="S3.SS3.p2.9.m1.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.9.m1.2c">v^{l}_{t,i}</annotation></semantics></math> denotes the the representation of the <math id="S3.SS3.p2.10.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.10.m2.1a"><mi id="S3.SS3.p2.10.m2.1.1" xref="S3.SS3.p2.10.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.10.m2.1b"><ci id="S3.SS3.p2.10.m2.1.1.cmml" xref="S3.SS3.p2.10.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.10.m2.1c">i</annotation></semantics></math>-th vertex in the <math id="S3.SS3.p2.11.m3.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p2.11.m3.1a"><mi id="S3.SS3.p2.11.m3.1.1" xref="S3.SS3.p2.11.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.11.m3.1b"><ci id="S3.SS3.p2.11.m3.1.1.cmml" xref="S3.SS3.p2.11.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.11.m3.1c">t</annotation></semantics></math>-th layer of <math id="S3.SS3.p2.12.m4.1" class="ltx_Math" alttext="G^{l}" display="inline"><semantics id="S3.SS3.p2.12.m4.1a"><msup id="S3.SS3.p2.12.m4.1.1" xref="S3.SS3.p2.12.m4.1.1.cmml"><mi id="S3.SS3.p2.12.m4.1.1.2" xref="S3.SS3.p2.12.m4.1.1.2.cmml">G</mi><mi id="S3.SS3.p2.12.m4.1.1.3" xref="S3.SS3.p2.12.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.12.m4.1b"><apply id="S3.SS3.p2.12.m4.1.1.cmml" xref="S3.SS3.p2.12.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.12.m4.1.1.1.cmml" xref="S3.SS3.p2.12.m4.1.1">superscript</csymbol><ci id="S3.SS3.p2.12.m4.1.1.2.cmml" xref="S3.SS3.p2.12.m4.1.1.2">𝐺</ci><ci id="S3.SS3.p2.12.m4.1.1.3.cmml" xref="S3.SS3.p2.12.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.12.m4.1c">G^{l}</annotation></semantics></math>, <math id="S3.SS3.p2.13.m5.2" class="ltx_Math" alttext="e^{l}_{t,iw}" display="inline"><semantics id="S3.SS3.p2.13.m5.2a"><msubsup id="S3.SS3.p2.13.m5.2.3" xref="S3.SS3.p2.13.m5.2.3.cmml"><mi id="S3.SS3.p2.13.m5.2.3.2.2" xref="S3.SS3.p2.13.m5.2.3.2.2.cmml">e</mi><mrow id="S3.SS3.p2.13.m5.2.2.2.2" xref="S3.SS3.p2.13.m5.2.2.2.3.cmml"><mi id="S3.SS3.p2.13.m5.1.1.1.1" xref="S3.SS3.p2.13.m5.1.1.1.1.cmml">t</mi><mo id="S3.SS3.p2.13.m5.2.2.2.2.2" xref="S3.SS3.p2.13.m5.2.2.2.3.cmml">,</mo><mrow id="S3.SS3.p2.13.m5.2.2.2.2.1" xref="S3.SS3.p2.13.m5.2.2.2.2.1.cmml"><mi id="S3.SS3.p2.13.m5.2.2.2.2.1.2" xref="S3.SS3.p2.13.m5.2.2.2.2.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.13.m5.2.2.2.2.1.1" xref="S3.SS3.p2.13.m5.2.2.2.2.1.1.cmml">​</mo><mi id="S3.SS3.p2.13.m5.2.2.2.2.1.3" xref="S3.SS3.p2.13.m5.2.2.2.2.1.3.cmml">w</mi></mrow></mrow><mi id="S3.SS3.p2.13.m5.2.3.2.3" xref="S3.SS3.p2.13.m5.2.3.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.13.m5.2b"><apply id="S3.SS3.p2.13.m5.2.3.cmml" xref="S3.SS3.p2.13.m5.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.13.m5.2.3.1.cmml" xref="S3.SS3.p2.13.m5.2.3">subscript</csymbol><apply id="S3.SS3.p2.13.m5.2.3.2.cmml" xref="S3.SS3.p2.13.m5.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.13.m5.2.3.2.1.cmml" xref="S3.SS3.p2.13.m5.2.3">superscript</csymbol><ci id="S3.SS3.p2.13.m5.2.3.2.2.cmml" xref="S3.SS3.p2.13.m5.2.3.2.2">𝑒</ci><ci id="S3.SS3.p2.13.m5.2.3.2.3.cmml" xref="S3.SS3.p2.13.m5.2.3.2.3">𝑙</ci></apply><list id="S3.SS3.p2.13.m5.2.2.2.3.cmml" xref="S3.SS3.p2.13.m5.2.2.2.2"><ci id="S3.SS3.p2.13.m5.1.1.1.1.cmml" xref="S3.SS3.p2.13.m5.1.1.1.1">𝑡</ci><apply id="S3.SS3.p2.13.m5.2.2.2.2.1.cmml" xref="S3.SS3.p2.13.m5.2.2.2.2.1"><times id="S3.SS3.p2.13.m5.2.2.2.2.1.1.cmml" xref="S3.SS3.p2.13.m5.2.2.2.2.1.1"></times><ci id="S3.SS3.p2.13.m5.2.2.2.2.1.2.cmml" xref="S3.SS3.p2.13.m5.2.2.2.2.1.2">𝑖</ci><ci id="S3.SS3.p2.13.m5.2.2.2.2.1.3.cmml" xref="S3.SS3.p2.13.m5.2.2.2.2.1.3">𝑤</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.13.m5.2c">e^{l}_{t,iw}</annotation></semantics></math> denotes the edge between the <math id="S3.SS3.p2.14.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.14.m6.1a"><mi id="S3.SS3.p2.14.m6.1.1" xref="S3.SS3.p2.14.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.14.m6.1b"><ci id="S3.SS3.p2.14.m6.1.1.cmml" xref="S3.SS3.p2.14.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.14.m6.1c">i</annotation></semantics></math>-th and <math id="S3.SS3.p2.15.m7.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS3.p2.15.m7.1a"><mi id="S3.SS3.p2.15.m7.1.1" xref="S3.SS3.p2.15.m7.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.15.m7.1b"><ci id="S3.SS3.p2.15.m7.1.1.cmml" xref="S3.SS3.p2.15.m7.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.15.m7.1c">w</annotation></semantics></math>-th vertex, <math id="S3.SS3.p2.16.m8.1" class="ltx_Math" alttext="N(i)" display="inline"><semantics id="S3.SS3.p2.16.m8.1a"><mrow id="S3.SS3.p2.16.m8.1.2" xref="S3.SS3.p2.16.m8.1.2.cmml"><mi id="S3.SS3.p2.16.m8.1.2.2" xref="S3.SS3.p2.16.m8.1.2.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.16.m8.1.2.1" xref="S3.SS3.p2.16.m8.1.2.1.cmml">​</mo><mrow id="S3.SS3.p2.16.m8.1.2.3.2" xref="S3.SS3.p2.16.m8.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.16.m8.1.2.3.2.1" xref="S3.SS3.p2.16.m8.1.2.cmml">(</mo><mi id="S3.SS3.p2.16.m8.1.1" xref="S3.SS3.p2.16.m8.1.1.cmml">i</mi><mo stretchy="false" id="S3.SS3.p2.16.m8.1.2.3.2.2" xref="S3.SS3.p2.16.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.16.m8.1b"><apply id="S3.SS3.p2.16.m8.1.2.cmml" xref="S3.SS3.p2.16.m8.1.2"><times id="S3.SS3.p2.16.m8.1.2.1.cmml" xref="S3.SS3.p2.16.m8.1.2.1"></times><ci id="S3.SS3.p2.16.m8.1.2.2.cmml" xref="S3.SS3.p2.16.m8.1.2.2">𝑁</ci><ci id="S3.SS3.p2.16.m8.1.1.cmml" xref="S3.SS3.p2.16.m8.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.16.m8.1c">N(i)</annotation></semantics></math> denotes the set of neighbors for vertex <math id="S3.SS3.p2.17.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.17.m9.1a"><mi id="S3.SS3.p2.17.m9.1.1" xref="S3.SS3.p2.17.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.17.m9.1b"><ci id="S3.SS3.p2.17.m9.1.1.cmml" xref="S3.SS3.p2.17.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.17.m9.1c">i</annotation></semantics></math> in graph <math id="S3.SS3.p2.18.m10.1" class="ltx_Math" alttext="G^{l}" display="inline"><semantics id="S3.SS3.p2.18.m10.1a"><msup id="S3.SS3.p2.18.m10.1.1" xref="S3.SS3.p2.18.m10.1.1.cmml"><mi id="S3.SS3.p2.18.m10.1.1.2" xref="S3.SS3.p2.18.m10.1.1.2.cmml">G</mi><mi id="S3.SS3.p2.18.m10.1.1.3" xref="S3.SS3.p2.18.m10.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.18.m10.1b"><apply id="S3.SS3.p2.18.m10.1.1.cmml" xref="S3.SS3.p2.18.m10.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.18.m10.1.1.1.cmml" xref="S3.SS3.p2.18.m10.1.1">superscript</csymbol><ci id="S3.SS3.p2.18.m10.1.1.2.cmml" xref="S3.SS3.p2.18.m10.1.1.2">𝐺</ci><ci id="S3.SS3.p2.18.m10.1.1.3.cmml" xref="S3.SS3.p2.18.m10.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.18.m10.1c">G^{l}</annotation></semantics></math>. <math id="S3.SS3.p2.19.m11.1" class="ltx_Math" alttext="M_{t}^{l}(\cdot)" display="inline"><semantics id="S3.SS3.p2.19.m11.1a"><mrow id="S3.SS3.p2.19.m11.1.2" xref="S3.SS3.p2.19.m11.1.2.cmml"><msubsup id="S3.SS3.p2.19.m11.1.2.2" xref="S3.SS3.p2.19.m11.1.2.2.cmml"><mi id="S3.SS3.p2.19.m11.1.2.2.2.2" xref="S3.SS3.p2.19.m11.1.2.2.2.2.cmml">M</mi><mi id="S3.SS3.p2.19.m11.1.2.2.2.3" xref="S3.SS3.p2.19.m11.1.2.2.2.3.cmml">t</mi><mi id="S3.SS3.p2.19.m11.1.2.2.3" xref="S3.SS3.p2.19.m11.1.2.2.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.p2.19.m11.1.2.1" xref="S3.SS3.p2.19.m11.1.2.1.cmml">​</mo><mrow id="S3.SS3.p2.19.m11.1.2.3.2" xref="S3.SS3.p2.19.m11.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.19.m11.1.2.3.2.1" xref="S3.SS3.p2.19.m11.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.p2.19.m11.1.1" xref="S3.SS3.p2.19.m11.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.p2.19.m11.1.2.3.2.2" xref="S3.SS3.p2.19.m11.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.19.m11.1b"><apply id="S3.SS3.p2.19.m11.1.2.cmml" xref="S3.SS3.p2.19.m11.1.2"><times id="S3.SS3.p2.19.m11.1.2.1.cmml" xref="S3.SS3.p2.19.m11.1.2.1"></times><apply id="S3.SS3.p2.19.m11.1.2.2.cmml" xref="S3.SS3.p2.19.m11.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m11.1.2.2.1.cmml" xref="S3.SS3.p2.19.m11.1.2.2">superscript</csymbol><apply id="S3.SS3.p2.19.m11.1.2.2.2.cmml" xref="S3.SS3.p2.19.m11.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.19.m11.1.2.2.2.1.cmml" xref="S3.SS3.p2.19.m11.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.19.m11.1.2.2.2.2.cmml" xref="S3.SS3.p2.19.m11.1.2.2.2.2">𝑀</ci><ci id="S3.SS3.p2.19.m11.1.2.2.2.3.cmml" xref="S3.SS3.p2.19.m11.1.2.2.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.19.m11.1.2.2.3.cmml" xref="S3.SS3.p2.19.m11.1.2.2.3">𝑙</ci></apply><ci id="S3.SS3.p2.19.m11.1.1.cmml" xref="S3.SS3.p2.19.m11.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.19.m11.1c">M_{t}^{l}(\cdot)</annotation></semantics></math> generates the message <math id="S3.SS3.p2.20.m12.2" class="ltx_Math" alttext="m^{l}_{t+1,i}" display="inline"><semantics id="S3.SS3.p2.20.m12.2a"><msubsup id="S3.SS3.p2.20.m12.2.3" xref="S3.SS3.p2.20.m12.2.3.cmml"><mi id="S3.SS3.p2.20.m12.2.3.2.2" xref="S3.SS3.p2.20.m12.2.3.2.2.cmml">m</mi><mrow id="S3.SS3.p2.20.m12.2.2.2.2" xref="S3.SS3.p2.20.m12.2.2.2.3.cmml"><mrow id="S3.SS3.p2.20.m12.2.2.2.2.1" xref="S3.SS3.p2.20.m12.2.2.2.2.1.cmml"><mi id="S3.SS3.p2.20.m12.2.2.2.2.1.2" xref="S3.SS3.p2.20.m12.2.2.2.2.1.2.cmml">t</mi><mo id="S3.SS3.p2.20.m12.2.2.2.2.1.1" xref="S3.SS3.p2.20.m12.2.2.2.2.1.1.cmml">+</mo><mn id="S3.SS3.p2.20.m12.2.2.2.2.1.3" xref="S3.SS3.p2.20.m12.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS3.p2.20.m12.2.2.2.2.2" xref="S3.SS3.p2.20.m12.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.20.m12.1.1.1.1" xref="S3.SS3.p2.20.m12.1.1.1.1.cmml">i</mi></mrow><mi id="S3.SS3.p2.20.m12.2.3.2.3" xref="S3.SS3.p2.20.m12.2.3.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.20.m12.2b"><apply id="S3.SS3.p2.20.m12.2.3.cmml" xref="S3.SS3.p2.20.m12.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.20.m12.2.3.1.cmml" xref="S3.SS3.p2.20.m12.2.3">subscript</csymbol><apply id="S3.SS3.p2.20.m12.2.3.2.cmml" xref="S3.SS3.p2.20.m12.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.20.m12.2.3.2.1.cmml" xref="S3.SS3.p2.20.m12.2.3">superscript</csymbol><ci id="S3.SS3.p2.20.m12.2.3.2.2.cmml" xref="S3.SS3.p2.20.m12.2.3.2.2">𝑚</ci><ci id="S3.SS3.p2.20.m12.2.3.2.3.cmml" xref="S3.SS3.p2.20.m12.2.3.2.3">𝑙</ci></apply><list id="S3.SS3.p2.20.m12.2.2.2.3.cmml" xref="S3.SS3.p2.20.m12.2.2.2.2"><apply id="S3.SS3.p2.20.m12.2.2.2.2.1.cmml" xref="S3.SS3.p2.20.m12.2.2.2.2.1"><plus id="S3.SS3.p2.20.m12.2.2.2.2.1.1.cmml" xref="S3.SS3.p2.20.m12.2.2.2.2.1.1"></plus><ci id="S3.SS3.p2.20.m12.2.2.2.2.1.2.cmml" xref="S3.SS3.p2.20.m12.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.20.m12.2.2.2.2.1.3.cmml" xref="S3.SS3.p2.20.m12.2.2.2.2.1.3">1</cn></apply><ci id="S3.SS3.p2.20.m12.1.1.1.1.cmml" xref="S3.SS3.p2.20.m12.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.20.m12.2c">m^{l}_{t+1,i}</annotation></semantics></math> by aggregating the feature of <math id="S3.SS3.p2.21.m13.2" class="ltx_Math" alttext="v^{l}_{t,i}" display="inline"><semantics id="S3.SS3.p2.21.m13.2a"><msubsup id="S3.SS3.p2.21.m13.2.3" xref="S3.SS3.p2.21.m13.2.3.cmml"><mi id="S3.SS3.p2.21.m13.2.3.2.2" xref="S3.SS3.p2.21.m13.2.3.2.2.cmml">v</mi><mrow id="S3.SS3.p2.21.m13.2.2.2.4" xref="S3.SS3.p2.21.m13.2.2.2.3.cmml"><mi id="S3.SS3.p2.21.m13.1.1.1.1" xref="S3.SS3.p2.21.m13.1.1.1.1.cmml">t</mi><mo id="S3.SS3.p2.21.m13.2.2.2.4.1" xref="S3.SS3.p2.21.m13.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.21.m13.2.2.2.2" xref="S3.SS3.p2.21.m13.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS3.p2.21.m13.2.3.2.3" xref="S3.SS3.p2.21.m13.2.3.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.21.m13.2b"><apply id="S3.SS3.p2.21.m13.2.3.cmml" xref="S3.SS3.p2.21.m13.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.21.m13.2.3.1.cmml" xref="S3.SS3.p2.21.m13.2.3">subscript</csymbol><apply id="S3.SS3.p2.21.m13.2.3.2.cmml" xref="S3.SS3.p2.21.m13.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.21.m13.2.3.2.1.cmml" xref="S3.SS3.p2.21.m13.2.3">superscript</csymbol><ci id="S3.SS3.p2.21.m13.2.3.2.2.cmml" xref="S3.SS3.p2.21.m13.2.3.2.2">𝑣</ci><ci id="S3.SS3.p2.21.m13.2.3.2.3.cmml" xref="S3.SS3.p2.21.m13.2.3.2.3">𝑙</ci></apply><list id="S3.SS3.p2.21.m13.2.2.2.3.cmml" xref="S3.SS3.p2.21.m13.2.2.2.4"><ci id="S3.SS3.p2.21.m13.1.1.1.1.cmml" xref="S3.SS3.p2.21.m13.1.1.1.1">𝑡</ci><ci id="S3.SS3.p2.21.m13.2.2.2.2.cmml" xref="S3.SS3.p2.21.m13.2.2.2.2">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.21.m13.2c">v^{l}_{t,i}</annotation></semantics></math> and its neighbors, and also the edges between them. <math id="S3.SS3.p2.22.m14.1" class="ltx_Math" alttext="U_{t}^{l}(\cdot)" display="inline"><semantics id="S3.SS3.p2.22.m14.1a"><mrow id="S3.SS3.p2.22.m14.1.2" xref="S3.SS3.p2.22.m14.1.2.cmml"><msubsup id="S3.SS3.p2.22.m14.1.2.2" xref="S3.SS3.p2.22.m14.1.2.2.cmml"><mi id="S3.SS3.p2.22.m14.1.2.2.2.2" xref="S3.SS3.p2.22.m14.1.2.2.2.2.cmml">U</mi><mi id="S3.SS3.p2.22.m14.1.2.2.2.3" xref="S3.SS3.p2.22.m14.1.2.2.2.3.cmml">t</mi><mi id="S3.SS3.p2.22.m14.1.2.2.3" xref="S3.SS3.p2.22.m14.1.2.2.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.p2.22.m14.1.2.1" xref="S3.SS3.p2.22.m14.1.2.1.cmml">​</mo><mrow id="S3.SS3.p2.22.m14.1.2.3.2" xref="S3.SS3.p2.22.m14.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.22.m14.1.2.3.2.1" xref="S3.SS3.p2.22.m14.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS3.p2.22.m14.1.1" xref="S3.SS3.p2.22.m14.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS3.p2.22.m14.1.2.3.2.2" xref="S3.SS3.p2.22.m14.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.22.m14.1b"><apply id="S3.SS3.p2.22.m14.1.2.cmml" xref="S3.SS3.p2.22.m14.1.2"><times id="S3.SS3.p2.22.m14.1.2.1.cmml" xref="S3.SS3.p2.22.m14.1.2.1"></times><apply id="S3.SS3.p2.22.m14.1.2.2.cmml" xref="S3.SS3.p2.22.m14.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.22.m14.1.2.2.1.cmml" xref="S3.SS3.p2.22.m14.1.2.2">superscript</csymbol><apply id="S3.SS3.p2.22.m14.1.2.2.2.cmml" xref="S3.SS3.p2.22.m14.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.22.m14.1.2.2.2.1.cmml" xref="S3.SS3.p2.22.m14.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.22.m14.1.2.2.2.2.cmml" xref="S3.SS3.p2.22.m14.1.2.2.2.2">𝑈</ci><ci id="S3.SS3.p2.22.m14.1.2.2.2.3.cmml" xref="S3.SS3.p2.22.m14.1.2.2.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.22.m14.1.2.2.3.cmml" xref="S3.SS3.p2.22.m14.1.2.2.3">𝑙</ci></apply><ci id="S3.SS3.p2.22.m14.1.1.cmml" xref="S3.SS3.p2.22.m14.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.22.m14.1c">U_{t}^{l}(\cdot)</annotation></semantics></math> updates the <math id="S3.SS3.p2.23.m15.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p2.23.m15.1a"><mi id="S3.SS3.p2.23.m15.1.1" xref="S3.SS3.p2.23.m15.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.23.m15.1b"><ci id="S3.SS3.p2.23.m15.1.1.cmml" xref="S3.SS3.p2.23.m15.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.23.m15.1c">i</annotation></semantics></math>-th vertex by transforming the original features and the received message <math id="S3.SS3.p2.24.m16.2" class="ltx_Math" alttext="m^{l}_{t+1,i}" display="inline"><semantics id="S3.SS3.p2.24.m16.2a"><msubsup id="S3.SS3.p2.24.m16.2.3" xref="S3.SS3.p2.24.m16.2.3.cmml"><mi id="S3.SS3.p2.24.m16.2.3.2.2" xref="S3.SS3.p2.24.m16.2.3.2.2.cmml">m</mi><mrow id="S3.SS3.p2.24.m16.2.2.2.2" xref="S3.SS3.p2.24.m16.2.2.2.3.cmml"><mrow id="S3.SS3.p2.24.m16.2.2.2.2.1" xref="S3.SS3.p2.24.m16.2.2.2.2.1.cmml"><mi id="S3.SS3.p2.24.m16.2.2.2.2.1.2" xref="S3.SS3.p2.24.m16.2.2.2.2.1.2.cmml">t</mi><mo id="S3.SS3.p2.24.m16.2.2.2.2.1.1" xref="S3.SS3.p2.24.m16.2.2.2.2.1.1.cmml">+</mo><mn id="S3.SS3.p2.24.m16.2.2.2.2.1.3" xref="S3.SS3.p2.24.m16.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS3.p2.24.m16.2.2.2.2.2" xref="S3.SS3.p2.24.m16.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.24.m16.1.1.1.1" xref="S3.SS3.p2.24.m16.1.1.1.1.cmml">i</mi></mrow><mi id="S3.SS3.p2.24.m16.2.3.2.3" xref="S3.SS3.p2.24.m16.2.3.2.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.24.m16.2b"><apply id="S3.SS3.p2.24.m16.2.3.cmml" xref="S3.SS3.p2.24.m16.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.24.m16.2.3.1.cmml" xref="S3.SS3.p2.24.m16.2.3">subscript</csymbol><apply id="S3.SS3.p2.24.m16.2.3.2.cmml" xref="S3.SS3.p2.24.m16.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.24.m16.2.3.2.1.cmml" xref="S3.SS3.p2.24.m16.2.3">superscript</csymbol><ci id="S3.SS3.p2.24.m16.2.3.2.2.cmml" xref="S3.SS3.p2.24.m16.2.3.2.2">𝑚</ci><ci id="S3.SS3.p2.24.m16.2.3.2.3.cmml" xref="S3.SS3.p2.24.m16.2.3.2.3">𝑙</ci></apply><list id="S3.SS3.p2.24.m16.2.2.2.3.cmml" xref="S3.SS3.p2.24.m16.2.2.2.2"><apply id="S3.SS3.p2.24.m16.2.2.2.2.1.cmml" xref="S3.SS3.p2.24.m16.2.2.2.2.1"><plus id="S3.SS3.p2.24.m16.2.2.2.2.1.1.cmml" xref="S3.SS3.p2.24.m16.2.2.2.2.1.1"></plus><ci id="S3.SS3.p2.24.m16.2.2.2.2.1.2.cmml" xref="S3.SS3.p2.24.m16.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.24.m16.2.2.2.2.1.3.cmml" xref="S3.SS3.p2.24.m16.2.2.2.2.1.3">1</cn></apply><ci id="S3.SS3.p2.24.m16.1.1.1.1.cmml" xref="S3.SS3.p2.24.m16.1.1.1.1">𝑖</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.24.m16.2c">m^{l}_{t+1,i}</annotation></semantics></math>. Different GNN models are implemented with different <math id="S3.SS3.p2.25.m17.1" class="ltx_Math" alttext="M_{t}^{l}" display="inline"><semantics id="S3.SS3.p2.25.m17.1a"><msubsup id="S3.SS3.p2.25.m17.1.1" xref="S3.SS3.p2.25.m17.1.1.cmml"><mi id="S3.SS3.p2.25.m17.1.1.2.2" xref="S3.SS3.p2.25.m17.1.1.2.2.cmml">M</mi><mi id="S3.SS3.p2.25.m17.1.1.2.3" xref="S3.SS3.p2.25.m17.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p2.25.m17.1.1.3" xref="S3.SS3.p2.25.m17.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.25.m17.1b"><apply id="S3.SS3.p2.25.m17.1.1.cmml" xref="S3.SS3.p2.25.m17.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.25.m17.1.1.1.cmml" xref="S3.SS3.p2.25.m17.1.1">superscript</csymbol><apply id="S3.SS3.p2.25.m17.1.1.2.cmml" xref="S3.SS3.p2.25.m17.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.25.m17.1.1.2.1.cmml" xref="S3.SS3.p2.25.m17.1.1">subscript</csymbol><ci id="S3.SS3.p2.25.m17.1.1.2.2.cmml" xref="S3.SS3.p2.25.m17.1.1.2.2">𝑀</ci><ci id="S3.SS3.p2.25.m17.1.1.2.3.cmml" xref="S3.SS3.p2.25.m17.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.25.m17.1.1.3.cmml" xref="S3.SS3.p2.25.m17.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.25.m17.1c">M_{t}^{l}</annotation></semantics></math> and <math id="S3.SS3.p2.26.m18.1" class="ltx_Math" alttext="U_{t}^{l}" display="inline"><semantics id="S3.SS3.p2.26.m18.1a"><msubsup id="S3.SS3.p2.26.m18.1.1" xref="S3.SS3.p2.26.m18.1.1.cmml"><mi id="S3.SS3.p2.26.m18.1.1.2.2" xref="S3.SS3.p2.26.m18.1.1.2.2.cmml">U</mi><mi id="S3.SS3.p2.26.m18.1.1.2.3" xref="S3.SS3.p2.26.m18.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p2.26.m18.1.1.3" xref="S3.SS3.p2.26.m18.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.26.m18.1b"><apply id="S3.SS3.p2.26.m18.1.1.cmml" xref="S3.SS3.p2.26.m18.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.26.m18.1.1.1.cmml" xref="S3.SS3.p2.26.m18.1.1">superscript</csymbol><apply id="S3.SS3.p2.26.m18.1.1.2.cmml" xref="S3.SS3.p2.26.m18.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.26.m18.1.1.2.1.cmml" xref="S3.SS3.p2.26.m18.1.1">subscript</csymbol><ci id="S3.SS3.p2.26.m18.1.1.2.2.cmml" xref="S3.SS3.p2.26.m18.1.1.2.2">𝑈</ci><ci id="S3.SS3.p2.26.m18.1.1.2.3.cmml" xref="S3.SS3.p2.26.m18.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.26.m18.1.1.3.cmml" xref="S3.SS3.p2.26.m18.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.26.m18.1c">U_{t}^{l}</annotation></semantics></math>. For example, the message function of GCN is defined as <math id="S3.SS3.p2.27.m19.7" class="ltx_Math" alttext="m^{l}_{t+1,i}=\sum_{w}{\hat{e}^{l}_{t,iw}FC(v^{l}_{t,w})}" display="inline"><semantics id="S3.SS3.p2.27.m19.7a"><mrow id="S3.SS3.p2.27.m19.7.7" xref="S3.SS3.p2.27.m19.7.7.cmml"><msubsup id="S3.SS3.p2.27.m19.7.7.3" xref="S3.SS3.p2.27.m19.7.7.3.cmml"><mi id="S3.SS3.p2.27.m19.7.7.3.2.2" xref="S3.SS3.p2.27.m19.7.7.3.2.2.cmml">m</mi><mrow id="S3.SS3.p2.27.m19.2.2.2.2" xref="S3.SS3.p2.27.m19.2.2.2.3.cmml"><mrow id="S3.SS3.p2.27.m19.2.2.2.2.1" xref="S3.SS3.p2.27.m19.2.2.2.2.1.cmml"><mi id="S3.SS3.p2.27.m19.2.2.2.2.1.2" xref="S3.SS3.p2.27.m19.2.2.2.2.1.2.cmml">t</mi><mo id="S3.SS3.p2.27.m19.2.2.2.2.1.1" xref="S3.SS3.p2.27.m19.2.2.2.2.1.1.cmml">+</mo><mn id="S3.SS3.p2.27.m19.2.2.2.2.1.3" xref="S3.SS3.p2.27.m19.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S3.SS3.p2.27.m19.2.2.2.2.2" xref="S3.SS3.p2.27.m19.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.27.m19.1.1.1.1" xref="S3.SS3.p2.27.m19.1.1.1.1.cmml">i</mi></mrow><mi id="S3.SS3.p2.27.m19.7.7.3.2.3" xref="S3.SS3.p2.27.m19.7.7.3.2.3.cmml">l</mi></msubsup><mo rspace="0.111em" id="S3.SS3.p2.27.m19.7.7.2" xref="S3.SS3.p2.27.m19.7.7.2.cmml">=</mo><mrow id="S3.SS3.p2.27.m19.7.7.1" xref="S3.SS3.p2.27.m19.7.7.1.cmml"><msub id="S3.SS3.p2.27.m19.7.7.1.2" xref="S3.SS3.p2.27.m19.7.7.1.2.cmml"><mo id="S3.SS3.p2.27.m19.7.7.1.2.2" xref="S3.SS3.p2.27.m19.7.7.1.2.2.cmml">∑</mo><mi id="S3.SS3.p2.27.m19.7.7.1.2.3" xref="S3.SS3.p2.27.m19.7.7.1.2.3.cmml">w</mi></msub><mrow id="S3.SS3.p2.27.m19.7.7.1.1" xref="S3.SS3.p2.27.m19.7.7.1.1.cmml"><msubsup id="S3.SS3.p2.27.m19.7.7.1.1.3" xref="S3.SS3.p2.27.m19.7.7.1.1.3.cmml"><mover accent="true" id="S3.SS3.p2.27.m19.7.7.1.1.3.2.2" xref="S3.SS3.p2.27.m19.7.7.1.1.3.2.2.cmml"><mi id="S3.SS3.p2.27.m19.7.7.1.1.3.2.2.2" xref="S3.SS3.p2.27.m19.7.7.1.1.3.2.2.2.cmml">e</mi><mo id="S3.SS3.p2.27.m19.7.7.1.1.3.2.2.1" xref="S3.SS3.p2.27.m19.7.7.1.1.3.2.2.1.cmml">^</mo></mover><mrow id="S3.SS3.p2.27.m19.4.4.2.2" xref="S3.SS3.p2.27.m19.4.4.2.3.cmml"><mi id="S3.SS3.p2.27.m19.3.3.1.1" xref="S3.SS3.p2.27.m19.3.3.1.1.cmml">t</mi><mo id="S3.SS3.p2.27.m19.4.4.2.2.2" xref="S3.SS3.p2.27.m19.4.4.2.3.cmml">,</mo><mrow id="S3.SS3.p2.27.m19.4.4.2.2.1" xref="S3.SS3.p2.27.m19.4.4.2.2.1.cmml"><mi id="S3.SS3.p2.27.m19.4.4.2.2.1.2" xref="S3.SS3.p2.27.m19.4.4.2.2.1.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.27.m19.4.4.2.2.1.1" xref="S3.SS3.p2.27.m19.4.4.2.2.1.1.cmml">​</mo><mi id="S3.SS3.p2.27.m19.4.4.2.2.1.3" xref="S3.SS3.p2.27.m19.4.4.2.2.1.3.cmml">w</mi></mrow></mrow><mi id="S3.SS3.p2.27.m19.7.7.1.1.3.2.3" xref="S3.SS3.p2.27.m19.7.7.1.1.3.2.3.cmml">l</mi></msubsup><mo lspace="0em" rspace="0em" id="S3.SS3.p2.27.m19.7.7.1.1.2" xref="S3.SS3.p2.27.m19.7.7.1.1.2.cmml">​</mo><mi id="S3.SS3.p2.27.m19.7.7.1.1.4" xref="S3.SS3.p2.27.m19.7.7.1.1.4.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.27.m19.7.7.1.1.2a" xref="S3.SS3.p2.27.m19.7.7.1.1.2.cmml">​</mo><mi id="S3.SS3.p2.27.m19.7.7.1.1.5" xref="S3.SS3.p2.27.m19.7.7.1.1.5.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.27.m19.7.7.1.1.2b" xref="S3.SS3.p2.27.m19.7.7.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.27.m19.7.7.1.1.1.1" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.27.m19.7.7.1.1.1.1.2" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS3.p2.27.m19.7.7.1.1.1.1.1" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.2.2" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.2.2.cmml">v</mi><mrow id="S3.SS3.p2.27.m19.6.6.2.4" xref="S3.SS3.p2.27.m19.6.6.2.3.cmml"><mi id="S3.SS3.p2.27.m19.5.5.1.1" xref="S3.SS3.p2.27.m19.5.5.1.1.cmml">t</mi><mo id="S3.SS3.p2.27.m19.6.6.2.4.1" xref="S3.SS3.p2.27.m19.6.6.2.3.cmml">,</mo><mi id="S3.SS3.p2.27.m19.6.6.2.2" xref="S3.SS3.p2.27.m19.6.6.2.2.cmml">w</mi></mrow><mi id="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.2.3" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.SS3.p2.27.m19.7.7.1.1.1.1.3" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.27.m19.7b"><apply id="S3.SS3.p2.27.m19.7.7.cmml" xref="S3.SS3.p2.27.m19.7.7"><eq id="S3.SS3.p2.27.m19.7.7.2.cmml" xref="S3.SS3.p2.27.m19.7.7.2"></eq><apply id="S3.SS3.p2.27.m19.7.7.3.cmml" xref="S3.SS3.p2.27.m19.7.7.3"><csymbol cd="ambiguous" id="S3.SS3.p2.27.m19.7.7.3.1.cmml" xref="S3.SS3.p2.27.m19.7.7.3">subscript</csymbol><apply id="S3.SS3.p2.27.m19.7.7.3.2.cmml" xref="S3.SS3.p2.27.m19.7.7.3"><csymbol cd="ambiguous" id="S3.SS3.p2.27.m19.7.7.3.2.1.cmml" xref="S3.SS3.p2.27.m19.7.7.3">superscript</csymbol><ci id="S3.SS3.p2.27.m19.7.7.3.2.2.cmml" xref="S3.SS3.p2.27.m19.7.7.3.2.2">𝑚</ci><ci id="S3.SS3.p2.27.m19.7.7.3.2.3.cmml" xref="S3.SS3.p2.27.m19.7.7.3.2.3">𝑙</ci></apply><list id="S3.SS3.p2.27.m19.2.2.2.3.cmml" xref="S3.SS3.p2.27.m19.2.2.2.2"><apply id="S3.SS3.p2.27.m19.2.2.2.2.1.cmml" xref="S3.SS3.p2.27.m19.2.2.2.2.1"><plus id="S3.SS3.p2.27.m19.2.2.2.2.1.1.cmml" xref="S3.SS3.p2.27.m19.2.2.2.2.1.1"></plus><ci id="S3.SS3.p2.27.m19.2.2.2.2.1.2.cmml" xref="S3.SS3.p2.27.m19.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.27.m19.2.2.2.2.1.3.cmml" xref="S3.SS3.p2.27.m19.2.2.2.2.1.3">1</cn></apply><ci id="S3.SS3.p2.27.m19.1.1.1.1.cmml" xref="S3.SS3.p2.27.m19.1.1.1.1">𝑖</ci></list></apply><apply id="S3.SS3.p2.27.m19.7.7.1.cmml" xref="S3.SS3.p2.27.m19.7.7.1"><apply id="S3.SS3.p2.27.m19.7.7.1.2.cmml" xref="S3.SS3.p2.27.m19.7.7.1.2"><csymbol cd="ambiguous" id="S3.SS3.p2.27.m19.7.7.1.2.1.cmml" xref="S3.SS3.p2.27.m19.7.7.1.2">subscript</csymbol><sum id="S3.SS3.p2.27.m19.7.7.1.2.2.cmml" xref="S3.SS3.p2.27.m19.7.7.1.2.2"></sum><ci id="S3.SS3.p2.27.m19.7.7.1.2.3.cmml" xref="S3.SS3.p2.27.m19.7.7.1.2.3">𝑤</ci></apply><apply id="S3.SS3.p2.27.m19.7.7.1.1.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1"><times id="S3.SS3.p2.27.m19.7.7.1.1.2.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.2"></times><apply id="S3.SS3.p2.27.m19.7.7.1.1.3.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.27.m19.7.7.1.1.3.1.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.3">subscript</csymbol><apply id="S3.SS3.p2.27.m19.7.7.1.1.3.2.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.27.m19.7.7.1.1.3.2.1.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.3">superscript</csymbol><apply id="S3.SS3.p2.27.m19.7.7.1.1.3.2.2.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.3.2.2"><ci id="S3.SS3.p2.27.m19.7.7.1.1.3.2.2.1.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.3.2.2.1">^</ci><ci id="S3.SS3.p2.27.m19.7.7.1.1.3.2.2.2.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.3.2.2.2">𝑒</ci></apply><ci id="S3.SS3.p2.27.m19.7.7.1.1.3.2.3.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.3.2.3">𝑙</ci></apply><list id="S3.SS3.p2.27.m19.4.4.2.3.cmml" xref="S3.SS3.p2.27.m19.4.4.2.2"><ci id="S3.SS3.p2.27.m19.3.3.1.1.cmml" xref="S3.SS3.p2.27.m19.3.3.1.1">𝑡</ci><apply id="S3.SS3.p2.27.m19.4.4.2.2.1.cmml" xref="S3.SS3.p2.27.m19.4.4.2.2.1"><times id="S3.SS3.p2.27.m19.4.4.2.2.1.1.cmml" xref="S3.SS3.p2.27.m19.4.4.2.2.1.1"></times><ci id="S3.SS3.p2.27.m19.4.4.2.2.1.2.cmml" xref="S3.SS3.p2.27.m19.4.4.2.2.1.2">𝑖</ci><ci id="S3.SS3.p2.27.m19.4.4.2.2.1.3.cmml" xref="S3.SS3.p2.27.m19.4.4.2.2.1.3">𝑤</ci></apply></list></apply><ci id="S3.SS3.p2.27.m19.7.7.1.1.4.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.4">𝐹</ci><ci id="S3.SS3.p2.27.m19.7.7.1.1.5.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.5">𝐶</ci><apply id="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.2.2">𝑣</ci><ci id="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.27.m19.7.7.1.1.1.1.1.2.3">𝑙</ci></apply><list id="S3.SS3.p2.27.m19.6.6.2.3.cmml" xref="S3.SS3.p2.27.m19.6.6.2.4"><ci id="S3.SS3.p2.27.m19.5.5.1.1.cmml" xref="S3.SS3.p2.27.m19.5.5.1.1">𝑡</ci><ci id="S3.SS3.p2.27.m19.6.6.2.2.cmml" xref="S3.SS3.p2.27.m19.6.6.2.2">𝑤</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.27.m19.7c">m^{l}_{t+1,i}=\sum_{w}{\hat{e}^{l}_{t,iw}FC(v^{l}_{t,w})}</annotation></semantics></math> and <math id="S3.SS3.p2.28.m20.3" class="ltx_Math" alttext="U_{t}^{l}=FC(m^{l}_{t,i})" display="inline"><semantics id="S3.SS3.p2.28.m20.3a"><mrow id="S3.SS3.p2.28.m20.3.3" xref="S3.SS3.p2.28.m20.3.3.cmml"><msubsup id="S3.SS3.p2.28.m20.3.3.3" xref="S3.SS3.p2.28.m20.3.3.3.cmml"><mi id="S3.SS3.p2.28.m20.3.3.3.2.2" xref="S3.SS3.p2.28.m20.3.3.3.2.2.cmml">U</mi><mi id="S3.SS3.p2.28.m20.3.3.3.2.3" xref="S3.SS3.p2.28.m20.3.3.3.2.3.cmml">t</mi><mi id="S3.SS3.p2.28.m20.3.3.3.3" xref="S3.SS3.p2.28.m20.3.3.3.3.cmml">l</mi></msubsup><mo id="S3.SS3.p2.28.m20.3.3.2" xref="S3.SS3.p2.28.m20.3.3.2.cmml">=</mo><mrow id="S3.SS3.p2.28.m20.3.3.1" xref="S3.SS3.p2.28.m20.3.3.1.cmml"><mi id="S3.SS3.p2.28.m20.3.3.1.3" xref="S3.SS3.p2.28.m20.3.3.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.28.m20.3.3.1.2" xref="S3.SS3.p2.28.m20.3.3.1.2.cmml">​</mo><mi id="S3.SS3.p2.28.m20.3.3.1.4" xref="S3.SS3.p2.28.m20.3.3.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.28.m20.3.3.1.2a" xref="S3.SS3.p2.28.m20.3.3.1.2.cmml">​</mo><mrow id="S3.SS3.p2.28.m20.3.3.1.1.1" xref="S3.SS3.p2.28.m20.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.28.m20.3.3.1.1.1.2" xref="S3.SS3.p2.28.m20.3.3.1.1.1.1.cmml">(</mo><msubsup id="S3.SS3.p2.28.m20.3.3.1.1.1.1" xref="S3.SS3.p2.28.m20.3.3.1.1.1.1.cmml"><mi id="S3.SS3.p2.28.m20.3.3.1.1.1.1.2.2" xref="S3.SS3.p2.28.m20.3.3.1.1.1.1.2.2.cmml">m</mi><mrow id="S3.SS3.p2.28.m20.2.2.2.4" xref="S3.SS3.p2.28.m20.2.2.2.3.cmml"><mi id="S3.SS3.p2.28.m20.1.1.1.1" xref="S3.SS3.p2.28.m20.1.1.1.1.cmml">t</mi><mo id="S3.SS3.p2.28.m20.2.2.2.4.1" xref="S3.SS3.p2.28.m20.2.2.2.3.cmml">,</mo><mi id="S3.SS3.p2.28.m20.2.2.2.2" xref="S3.SS3.p2.28.m20.2.2.2.2.cmml">i</mi></mrow><mi id="S3.SS3.p2.28.m20.3.3.1.1.1.1.2.3" xref="S3.SS3.p2.28.m20.3.3.1.1.1.1.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="S3.SS3.p2.28.m20.3.3.1.1.1.3" xref="S3.SS3.p2.28.m20.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.28.m20.3b"><apply id="S3.SS3.p2.28.m20.3.3.cmml" xref="S3.SS3.p2.28.m20.3.3"><eq id="S3.SS3.p2.28.m20.3.3.2.cmml" xref="S3.SS3.p2.28.m20.3.3.2"></eq><apply id="S3.SS3.p2.28.m20.3.3.3.cmml" xref="S3.SS3.p2.28.m20.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.28.m20.3.3.3.1.cmml" xref="S3.SS3.p2.28.m20.3.3.3">superscript</csymbol><apply id="S3.SS3.p2.28.m20.3.3.3.2.cmml" xref="S3.SS3.p2.28.m20.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.p2.28.m20.3.3.3.2.1.cmml" xref="S3.SS3.p2.28.m20.3.3.3">subscript</csymbol><ci id="S3.SS3.p2.28.m20.3.3.3.2.2.cmml" xref="S3.SS3.p2.28.m20.3.3.3.2.2">𝑈</ci><ci id="S3.SS3.p2.28.m20.3.3.3.2.3.cmml" xref="S3.SS3.p2.28.m20.3.3.3.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.28.m20.3.3.3.3.cmml" xref="S3.SS3.p2.28.m20.3.3.3.3">𝑙</ci></apply><apply id="S3.SS3.p2.28.m20.3.3.1.cmml" xref="S3.SS3.p2.28.m20.3.3.1"><times id="S3.SS3.p2.28.m20.3.3.1.2.cmml" xref="S3.SS3.p2.28.m20.3.3.1.2"></times><ci id="S3.SS3.p2.28.m20.3.3.1.3.cmml" xref="S3.SS3.p2.28.m20.3.3.1.3">𝐹</ci><ci id="S3.SS3.p2.28.m20.3.3.1.4.cmml" xref="S3.SS3.p2.28.m20.3.3.1.4">𝐶</ci><apply id="S3.SS3.p2.28.m20.3.3.1.1.1.1.cmml" xref="S3.SS3.p2.28.m20.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.28.m20.3.3.1.1.1.1.1.cmml" xref="S3.SS3.p2.28.m20.3.3.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.28.m20.3.3.1.1.1.1.2.cmml" xref="S3.SS3.p2.28.m20.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.28.m20.3.3.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.28.m20.3.3.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.28.m20.3.3.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.28.m20.3.3.1.1.1.1.2.2">𝑚</ci><ci id="S3.SS3.p2.28.m20.3.3.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.28.m20.3.3.1.1.1.1.2.3">𝑙</ci></apply><list id="S3.SS3.p2.28.m20.2.2.2.3.cmml" xref="S3.SS3.p2.28.m20.2.2.2.4"><ci id="S3.SS3.p2.28.m20.1.1.1.1.cmml" xref="S3.SS3.p2.28.m20.1.1.1.1">𝑡</ci><ci id="S3.SS3.p2.28.m20.2.2.2.2.cmml" xref="S3.SS3.p2.28.m20.2.2.2.2">𝑖</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.28.m20.3c">U_{t}^{l}=FC(m^{l}_{t,i})</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, where <math id="S3.SS3.p2.29.m21.1" class="ltx_Math" alttext="FC" display="inline"><semantics id="S3.SS3.p2.29.m21.1a"><mrow id="S3.SS3.p2.29.m21.1.1" xref="S3.SS3.p2.29.m21.1.1.cmml"><mi id="S3.SS3.p2.29.m21.1.1.2" xref="S3.SS3.p2.29.m21.1.1.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.29.m21.1.1.1" xref="S3.SS3.p2.29.m21.1.1.1.cmml">​</mo><mi id="S3.SS3.p2.29.m21.1.1.3" xref="S3.SS3.p2.29.m21.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.29.m21.1b"><apply id="S3.SS3.p2.29.m21.1.1.cmml" xref="S3.SS3.p2.29.m21.1.1"><times id="S3.SS3.p2.29.m21.1.1.1.cmml" xref="S3.SS3.p2.29.m21.1.1.1"></times><ci id="S3.SS3.p2.29.m21.1.1.2.cmml" xref="S3.SS3.p2.29.m21.1.1.2">𝐹</ci><ci id="S3.SS3.p2.29.m21.1.1.3.cmml" xref="S3.SS3.p2.29.m21.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.29.m21.1c">FC</annotation></semantics></math> is a linear layer and <math id="S3.SS3.p2.30.m22.1" class="ltx_Math" alttext="\hat{e}" display="inline"><semantics id="S3.SS3.p2.30.m22.1a"><mover accent="true" id="S3.SS3.p2.30.m22.1.1" xref="S3.SS3.p2.30.m22.1.1.cmml"><mi id="S3.SS3.p2.30.m22.1.1.2" xref="S3.SS3.p2.30.m22.1.1.2.cmml">e</mi><mo id="S3.SS3.p2.30.m22.1.1.1" xref="S3.SS3.p2.30.m22.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.30.m22.1b"><apply id="S3.SS3.p2.30.m22.1.1.cmml" xref="S3.SS3.p2.30.m22.1.1"><ci id="S3.SS3.p2.30.m22.1.1.1.cmml" xref="S3.SS3.p2.30.m22.1.1.1">^</ci><ci id="S3.SS3.p2.30.m22.1.1.2.cmml" xref="S3.SS3.p2.30.m22.1.1.2">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.30.m22.1c">\hat{e}</annotation></semantics></math> is the Laplacian-regularized adjacency matrix. SchNet implements the message function <math id="S3.SS3.p2.31.m23.1" class="ltx_Math" alttext="M_{t}^{l}" display="inline"><semantics id="S3.SS3.p2.31.m23.1a"><msubsup id="S3.SS3.p2.31.m23.1.1" xref="S3.SS3.p2.31.m23.1.1.cmml"><mi id="S3.SS3.p2.31.m23.1.1.2.2" xref="S3.SS3.p2.31.m23.1.1.2.2.cmml">M</mi><mi id="S3.SS3.p2.31.m23.1.1.2.3" xref="S3.SS3.p2.31.m23.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p2.31.m23.1.1.3" xref="S3.SS3.p2.31.m23.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.31.m23.1b"><apply id="S3.SS3.p2.31.m23.1.1.cmml" xref="S3.SS3.p2.31.m23.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.31.m23.1.1.1.cmml" xref="S3.SS3.p2.31.m23.1.1">superscript</csymbol><apply id="S3.SS3.p2.31.m23.1.1.2.cmml" xref="S3.SS3.p2.31.m23.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.31.m23.1.1.2.1.cmml" xref="S3.SS3.p2.31.m23.1.1">subscript</csymbol><ci id="S3.SS3.p2.31.m23.1.1.2.2.cmml" xref="S3.SS3.p2.31.m23.1.1.2.2">𝑀</ci><ci id="S3.SS3.p2.31.m23.1.1.2.3.cmml" xref="S3.SS3.p2.31.m23.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.31.m23.1.1.3.cmml" xref="S3.SS3.p2.31.m23.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.31.m23.1c">M_{t}^{l}</annotation></semantics></math> with a continuous filter layer and <math id="S3.SS3.p2.32.m24.1" class="ltx_Math" alttext="U_{t}^{l}" display="inline"><semantics id="S3.SS3.p2.32.m24.1a"><msubsup id="S3.SS3.p2.32.m24.1.1" xref="S3.SS3.p2.32.m24.1.1.cmml"><mi id="S3.SS3.p2.32.m24.1.1.2.2" xref="S3.SS3.p2.32.m24.1.1.2.2.cmml">U</mi><mi id="S3.SS3.p2.32.m24.1.1.2.3" xref="S3.SS3.p2.32.m24.1.1.2.3.cmml">t</mi><mi id="S3.SS3.p2.32.m24.1.1.3" xref="S3.SS3.p2.32.m24.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.32.m24.1b"><apply id="S3.SS3.p2.32.m24.1.1.cmml" xref="S3.SS3.p2.32.m24.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.32.m24.1.1.1.cmml" xref="S3.SS3.p2.32.m24.1.1">superscript</csymbol><apply id="S3.SS3.p2.32.m24.1.1.2.cmml" xref="S3.SS3.p2.32.m24.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.32.m24.1.1.2.1.cmml" xref="S3.SS3.p2.32.m24.1.1">subscript</csymbol><ci id="S3.SS3.p2.32.m24.1.1.2.2.cmml" xref="S3.SS3.p2.32.m24.1.1.2.2">𝑈</ci><ci id="S3.SS3.p2.32.m24.1.1.2.3.cmml" xref="S3.SS3.p2.32.m24.1.1.2.3">𝑡</ci></apply><ci id="S3.SS3.p2.32.m24.1.1.3.cmml" xref="S3.SS3.p2.32.m24.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.32.m24.1c">U_{t}^{l}</annotation></semantics></math> with a vertex(atom)-wise convolutional module <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. The message passing phase could aggregate and transform the vertex features for high level representations.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.2" class="ltx_p">After <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">T</annotation></semantics></math> message passing layers, we adopt a readout function <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="R^{l}" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><msup id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml"><mi id="S3.SS3.p3.2.m2.1.1.2" xref="S3.SS3.p3.2.m2.1.1.2.cmml">R</mi><mi id="S3.SS3.p3.2.m2.1.1.3" xref="S3.SS3.p3.2.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><apply id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p3.2.m2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.1.1.2">𝑅</ci><ci id="S3.SS3.p3.2.m2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">R^{l}</annotation></semantics></math> to aggregate the vertex representations for graph level representation as</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S3.E3.m1.3" class="ltx_Math" alttext="{h}^{l}=R^{l}({v_{T,i}^{l}|i\in G^{l}})." display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><msup id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.3.2" xref="S3.E3.m1.3.3.1.1.3.2.cmml">h</mi><mi id="S3.E3.m1.3.3.1.1.3.3" xref="S3.E3.m1.3.3.1.1.3.3.cmml">l</mi></msup><mo id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.cmml"><msup id="S3.E3.m1.3.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.3.2.cmml">R</mi><mi id="S3.E3.m1.3.3.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.3.3.cmml">l</mi></msup><mo lspace="0em" rspace="0em" id="S3.E3.m1.3.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml"><msubsup id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml">v</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">T</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">i</mi></mrow><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.3.cmml">l</mi></msubsup><mo fence="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.1.cmml">|</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml">i</mi></mrow><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml">∈</mo><msup id="S3.E3.m1.3.3.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.3.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml">G</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.cmml">l</mi></msup></mrow><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.3b"><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1"><eq id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"></eq><apply id="S3.E3.m1.3.3.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.3">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.3.2">ℎ</ci><ci id="S3.E3.m1.3.3.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.3.3">𝑙</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1"><times id="S3.E3.m1.3.3.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.2"></times><apply id="S3.E3.m1.3.3.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.3">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.3.2">𝑅</ci><ci id="S3.E3.m1.3.3.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.3.3">𝑙</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1"><in id="S3.E3.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1"></in><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.1">conditional</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.2.2">𝑣</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑇</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑖</ci></list></apply><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.2.3">𝑙</ci></apply><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S3.E3.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.2">𝐺</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.1.3.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.3c">{h}^{l}=R^{l}({v_{T,i}^{l}|i\in G^{l}}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.6" class="ltx_p"><math id="S3.SS3.p3.3.m1.1" class="ltx_Math" alttext="R^{l}" display="inline"><semantics id="S3.SS3.p3.3.m1.1a"><msup id="S3.SS3.p3.3.m1.1.1" xref="S3.SS3.p3.3.m1.1.1.cmml"><mi id="S3.SS3.p3.3.m1.1.1.2" xref="S3.SS3.p3.3.m1.1.1.2.cmml">R</mi><mi id="S3.SS3.p3.3.m1.1.1.3" xref="S3.SS3.p3.3.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m1.1b"><apply id="S3.SS3.p3.3.m1.1.1.cmml" xref="S3.SS3.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m1.1.1.1.cmml" xref="S3.SS3.p3.3.m1.1.1">superscript</csymbol><ci id="S3.SS3.p3.3.m1.1.1.2.cmml" xref="S3.SS3.p3.3.m1.1.1.2">𝑅</ci><ci id="S3.SS3.p3.3.m1.1.1.3.cmml" xref="S3.SS3.p3.3.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m1.1c">R^{l}</annotation></semantics></math> should be permutation invariant and can be implemented with either a simple sum pooling or a learnable neural network. The graph-level representation <math id="S3.SS3.p3.4.m2.1" class="ltx_Math" alttext="h^{l}" display="inline"><semantics id="S3.SS3.p3.4.m2.1a"><msup id="S3.SS3.p3.4.m2.1.1" xref="S3.SS3.p3.4.m2.1.1.cmml"><mi id="S3.SS3.p3.4.m2.1.1.2" xref="S3.SS3.p3.4.m2.1.1.2.cmml">h</mi><mi id="S3.SS3.p3.4.m2.1.1.3" xref="S3.SS3.p3.4.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m2.1b"><apply id="S3.SS3.p3.4.m2.1.1.cmml" xref="S3.SS3.p3.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m2.1.1.1.cmml" xref="S3.SS3.p3.4.m2.1.1">superscript</csymbol><ci id="S3.SS3.p3.4.m2.1.1.2.cmml" xref="S3.SS3.p3.4.m2.1.1.2">ℎ</ci><ci id="S3.SS3.p3.4.m2.1.1.3.cmml" xref="S3.SS3.p3.4.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m2.1c">h^{l}</annotation></semantics></math> is further used to obtain an estimation <math id="S3.SS3.p3.5.m3.1" class="ltx_Math" alttext="\hat{y}^{l}=F^{l}(G^{l})" display="inline"><semantics id="S3.SS3.p3.5.m3.1a"><mrow id="S3.SS3.p3.5.m3.1.1" xref="S3.SS3.p3.5.m3.1.1.cmml"><msup id="S3.SS3.p3.5.m3.1.1.3" xref="S3.SS3.p3.5.m3.1.1.3.cmml"><mover accent="true" id="S3.SS3.p3.5.m3.1.1.3.2" xref="S3.SS3.p3.5.m3.1.1.3.2.cmml"><mi id="S3.SS3.p3.5.m3.1.1.3.2.2" xref="S3.SS3.p3.5.m3.1.1.3.2.2.cmml">y</mi><mo id="S3.SS3.p3.5.m3.1.1.3.2.1" xref="S3.SS3.p3.5.m3.1.1.3.2.1.cmml">^</mo></mover><mi id="S3.SS3.p3.5.m3.1.1.3.3" xref="S3.SS3.p3.5.m3.1.1.3.3.cmml">l</mi></msup><mo id="S3.SS3.p3.5.m3.1.1.2" xref="S3.SS3.p3.5.m3.1.1.2.cmml">=</mo><mrow id="S3.SS3.p3.5.m3.1.1.1" xref="S3.SS3.p3.5.m3.1.1.1.cmml"><msup id="S3.SS3.p3.5.m3.1.1.1.3" xref="S3.SS3.p3.5.m3.1.1.1.3.cmml"><mi id="S3.SS3.p3.5.m3.1.1.1.3.2" xref="S3.SS3.p3.5.m3.1.1.1.3.2.cmml">F</mi><mi id="S3.SS3.p3.5.m3.1.1.1.3.3" xref="S3.SS3.p3.5.m3.1.1.1.3.3.cmml">l</mi></msup><mo lspace="0em" rspace="0em" id="S3.SS3.p3.5.m3.1.1.1.2" xref="S3.SS3.p3.5.m3.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p3.5.m3.1.1.1.1.1" xref="S3.SS3.p3.5.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p3.5.m3.1.1.1.1.1.2" xref="S3.SS3.p3.5.m3.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.p3.5.m3.1.1.1.1.1.1" xref="S3.SS3.p3.5.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.5.m3.1.1.1.1.1.1.2" xref="S3.SS3.p3.5.m3.1.1.1.1.1.1.2.cmml">G</mi><mi id="S3.SS3.p3.5.m3.1.1.1.1.1.1.3" xref="S3.SS3.p3.5.m3.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S3.SS3.p3.5.m3.1.1.1.1.1.3" xref="S3.SS3.p3.5.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m3.1b"><apply id="S3.SS3.p3.5.m3.1.1.cmml" xref="S3.SS3.p3.5.m3.1.1"><eq id="S3.SS3.p3.5.m3.1.1.2.cmml" xref="S3.SS3.p3.5.m3.1.1.2"></eq><apply id="S3.SS3.p3.5.m3.1.1.3.cmml" xref="S3.SS3.p3.5.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m3.1.1.3.1.cmml" xref="S3.SS3.p3.5.m3.1.1.3">superscript</csymbol><apply id="S3.SS3.p3.5.m3.1.1.3.2.cmml" xref="S3.SS3.p3.5.m3.1.1.3.2"><ci id="S3.SS3.p3.5.m3.1.1.3.2.1.cmml" xref="S3.SS3.p3.5.m3.1.1.3.2.1">^</ci><ci id="S3.SS3.p3.5.m3.1.1.3.2.2.cmml" xref="S3.SS3.p3.5.m3.1.1.3.2.2">𝑦</ci></apply><ci id="S3.SS3.p3.5.m3.1.1.3.3.cmml" xref="S3.SS3.p3.5.m3.1.1.3.3">𝑙</ci></apply><apply id="S3.SS3.p3.5.m3.1.1.1.cmml" xref="S3.SS3.p3.5.m3.1.1.1"><times id="S3.SS3.p3.5.m3.1.1.1.2.cmml" xref="S3.SS3.p3.5.m3.1.1.1.2"></times><apply id="S3.SS3.p3.5.m3.1.1.1.3.cmml" xref="S3.SS3.p3.5.m3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m3.1.1.1.3.1.cmml" xref="S3.SS3.p3.5.m3.1.1.1.3">superscript</csymbol><ci id="S3.SS3.p3.5.m3.1.1.1.3.2.cmml" xref="S3.SS3.p3.5.m3.1.1.1.3.2">𝐹</ci><ci id="S3.SS3.p3.5.m3.1.1.1.3.3.cmml" xref="S3.SS3.p3.5.m3.1.1.1.3.3">𝑙</ci></apply><apply id="S3.SS3.p3.5.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.5.m3.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p3.5.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.5.m3.1.1.1.1.1.1.2">𝐺</ci><ci id="S3.SS3.p3.5.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.5.m3.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m3.1c">\hat{y}^{l}=F^{l}(G^{l})</annotation></semantics></math> for the ground-truth molecular property <math id="S3.SS3.p3.6.m4.1" class="ltx_Math" alttext="y^{l}" display="inline"><semantics id="S3.SS3.p3.6.m4.1a"><msup id="S3.SS3.p3.6.m4.1.1" xref="S3.SS3.p3.6.m4.1.1.cmml"><mi id="S3.SS3.p3.6.m4.1.1.2" xref="S3.SS3.p3.6.m4.1.1.2.cmml">y</mi><mi id="S3.SS3.p3.6.m4.1.1.3" xref="S3.SS3.p3.6.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m4.1b"><apply id="S3.SS3.p3.6.m4.1.1.cmml" xref="S3.SS3.p3.6.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m4.1.1.1.cmml" xref="S3.SS3.p3.6.m4.1.1">superscript</csymbol><ci id="S3.SS3.p3.6.m4.1.1.2.cmml" xref="S3.SS3.p3.6.m4.1.1.2">𝑦</ci><ci id="S3.SS3.p3.6.m4.1.1.3.cmml" xref="S3.SS3.p3.6.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m4.1c">y^{l}</annotation></semantics></math>.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2109.07258/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="207" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Illustration for the motivation of FLIT. We assume two clients as <math id="S3.F2.3.m1.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S3.F2.3.m1.1b"><mi id="S3.F2.3.m1.1.1" xref="S3.F2.3.m1.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S3.F2.3.m1.1c"><ci id="S3.F2.3.m1.1.1.cmml" xref="S3.F2.3.m1.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.3.m1.1d">A</annotation></semantics></math> and <math id="S3.F2.4.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.F2.4.m2.1b"><mi id="S3.F2.4.m2.1.1" xref="S3.F2.4.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.F2.4.m2.1c"><ci id="S3.F2.4.m2.1.1.cmml" xref="S3.F2.4.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.m2.1d">B</annotation></semantics></math>, and the local data on these clients do not share the same distribution as the global one. Local models trained on biased local data will overfit the majority groups of data and underfit others. FLIT measures each sample’s prediction confidence and puts more weight on the uncertain data. As a result, the local data distribution will be better aligned to the global one, and the trained local models will also be more consistent with each other.</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Federated Learning by Instance Reweighting FLIT(+)</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">According to our experiments on the proposed heterogeneous federated learning benchmark FedChem, heterogeneity brings significant difficulties to federated molecular learning. This section proposes a method to alleviate the heterogeneity problem, namely Federated Learning by Instance reweighTing (FLIT). FLIT adapts the formulation of focal loss for federated learning by involving a global model in local training objectives and can align the local training across clients by focusing on uncertain samples <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. We illustrate the motivation of FLIT in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3.3 Client-side Updates ‣ 3 Federated Heterogeneous Molecule Learning ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Learning to reweight training samples is widely used in curriculum learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib66" title="" class="ltx_ref">66</a>]</cite>, hard-sample Mining <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, domain generalization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, debiasing <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>, model calibration <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, adversarial defense <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib65" title="" class="ltx_ref">65</a>]</cite>, etc. Our method is closely related to Focal Loss <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> and worst case optimization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>. Mukhoti <span id="S4.p2.1.1" class="ltx_text ltx_font_italic">et al.</span> point out that focal loss could make the objective value aligned with the prediction confidence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>. GroupDRO improves the model generalization ability by assigning more weights for groups with the worst performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">FLIT relies on an instance reweighting framework to improve the federated molecular property prediction in a heterogeneous setting. The basic observation of FLIT is that, under the heterogeneous settings, the local model will be trained to overfit the small-scaled data at hand. Therefore, the local model will be over-confident for the majority groups of local training samples and may perform poorly and even worse than the received global model on the rare molecules at the client-side. As a result, the local models trained on different clients will significantly deviate from each other, and the inconsistency remarkably degrades the performance of the global model <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="S4.p3.1.m1.1a"><msup id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">F</mi><mi id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1">superscript</csymbol><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">𝐹</ci><ci id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">F^{g}</annotation></semantics></math>, which is aggregated from the local models in a data-free manner <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. The suboptimal performance of FedAvg is wildly admitted by existing studies <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>. FLIT puts more weight on samples with low prediction confidence by utilizing the local and global models to alleviate the problem. FLIT explores two different ways to define the prediction confidence, <span id="S4.p3.1.1" class="ltx_text ltx_font_italic">i.e.</span> the loss value (FLIT) and also augmented with prediction consistency among the neighbors (FLIT+). By focusing on the identified uncertain samples, FLIT(+) makes the local training more consistent across clients and eventually leads to better-federated learning performance.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.4.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> FLIT(+) for <math id="alg2.2.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="alg2.2.m1.1b"><mi id="alg2.2.m1.1.1" xref="alg2.2.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg2.2.m1.1c"><ci id="alg2.2.m1.1.1.cmml" xref="alg2.2.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.2.m1.1d">l</annotation></semantics></math>-th Client Updates</figcaption>
<div id="alg2.5" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span><span id="alg2.l1.2" class="ltx_text ltx_font_bold">Input:</span> <math id="alg2.l1.m1.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="alg2.l1.m1.1a"><msup id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi id="alg2.l1.m1.1.1.2" xref="alg2.l1.m1.1.1.2.cmml">F</mi><mi id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1">superscript</csymbol><ci id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1.2">𝐹</ci><ci id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">F^{g}</annotation></semantics></math>, <math id="alg2.l1.m2.1" class="ltx_Math" alttext="X^{l}=\{(g^{l}_{i},y^{l}_{i})\}_{i=1}^{N_{l}}" display="inline"><semantics id="alg2.l1.m2.1a"><mrow id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><msup id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3.cmml"><mi id="alg2.l1.m2.1.1.3.2" xref="alg2.l1.m2.1.1.3.2.cmml">X</mi><mi id="alg2.l1.m2.1.1.3.3" xref="alg2.l1.m2.1.1.3.3.cmml">l</mi></msup><mo id="alg2.l1.m2.1.1.2" xref="alg2.l1.m2.1.1.2.cmml">=</mo><msubsup id="alg2.l1.m2.1.1.1" xref="alg2.l1.m2.1.1.1.cmml"><mrow id="alg2.l1.m2.1.1.1.1.1.1" xref="alg2.l1.m2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l1.m2.1.1.1.1.1.1.2" xref="alg2.l1.m2.1.1.1.1.1.2.cmml">{</mo><mrow id="alg2.l1.m2.1.1.1.1.1.1.1.2" xref="alg2.l1.m2.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="alg2.l1.m2.1.1.1.1.1.1.1.2.3" xref="alg2.l1.m2.1.1.1.1.1.1.1.3.cmml">(</mo><msubsup id="alg2.l1.m2.1.1.1.1.1.1.1.1.1" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l1.m2.1.1.1.1.1.1.1.1.1.2.2" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="alg2.l1.m2.1.1.1.1.1.1.1.1.1.3" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="alg2.l1.m2.1.1.1.1.1.1.1.1.1.2.3" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg2.l1.m2.1.1.1.1.1.1.1.2.4" xref="alg2.l1.m2.1.1.1.1.1.1.1.3.cmml">,</mo><msubsup id="alg2.l1.m2.1.1.1.1.1.1.1.2.2" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2.cmml"><mi id="alg2.l1.m2.1.1.1.1.1.1.1.2.2.2.2" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2.2.2.cmml">y</mi><mi id="alg2.l1.m2.1.1.1.1.1.1.1.2.2.3" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2.3.cmml">i</mi><mi id="alg2.l1.m2.1.1.1.1.1.1.1.2.2.2.3" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="alg2.l1.m2.1.1.1.1.1.1.1.2.5" xref="alg2.l1.m2.1.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="alg2.l1.m2.1.1.1.1.1.1.3" xref="alg2.l1.m2.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l1.m2.1.1.1.1.3" xref="alg2.l1.m2.1.1.1.1.3.cmml"><mi id="alg2.l1.m2.1.1.1.1.3.2" xref="alg2.l1.m2.1.1.1.1.3.2.cmml">i</mi><mo id="alg2.l1.m2.1.1.1.1.3.1" xref="alg2.l1.m2.1.1.1.1.3.1.cmml">=</mo><mn id="alg2.l1.m2.1.1.1.1.3.3" xref="alg2.l1.m2.1.1.1.1.3.3.cmml">1</mn></mrow><msub id="alg2.l1.m2.1.1.1.3" xref="alg2.l1.m2.1.1.1.3.cmml"><mi id="alg2.l1.m2.1.1.1.3.2" xref="alg2.l1.m2.1.1.1.3.2.cmml">N</mi><mi id="alg2.l1.m2.1.1.1.3.3" xref="alg2.l1.m2.1.1.1.3.3.cmml">l</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><eq id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1.2"></eq><apply id="alg2.l1.m2.1.1.3.cmml" xref="alg2.l1.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.3.1.cmml" xref="alg2.l1.m2.1.1.3">superscript</csymbol><ci id="alg2.l1.m2.1.1.3.2.cmml" xref="alg2.l1.m2.1.1.3.2">𝑋</ci><ci id="alg2.l1.m2.1.1.3.3.cmml" xref="alg2.l1.m2.1.1.3.3">𝑙</ci></apply><apply id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.2.cmml" xref="alg2.l1.m2.1.1.1">superscript</csymbol><apply id="alg2.l1.m2.1.1.1.1.cmml" xref="alg2.l1.m2.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.1.2.cmml" xref="alg2.l1.m2.1.1.1">subscript</csymbol><set id="alg2.l1.m2.1.1.1.1.1.2.cmml" xref="alg2.l1.m2.1.1.1.1.1.1"><interval closure="open" id="alg2.l1.m2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.2"><apply id="alg2.l1.m2.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l1.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l1.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1.2.2">𝑔</ci><ci id="alg2.l1.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg2.l1.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l1.m2.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.1.1.1.1.2.2.1.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2">subscript</csymbol><apply id="alg2.l1.m2.1.1.1.1.1.1.1.2.2.2.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="alg2.l1.m2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2.2.2">𝑦</ci><ci id="alg2.l1.m2.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2.2.3">𝑙</ci></apply><ci id="alg2.l1.m2.1.1.1.1.1.1.1.2.2.3.cmml" xref="alg2.l1.m2.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply></interval></set><apply id="alg2.l1.m2.1.1.1.1.3.cmml" xref="alg2.l1.m2.1.1.1.1.3"><eq id="alg2.l1.m2.1.1.1.1.3.1.cmml" xref="alg2.l1.m2.1.1.1.1.3.1"></eq><ci id="alg2.l1.m2.1.1.1.1.3.2.cmml" xref="alg2.l1.m2.1.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg2.l1.m2.1.1.1.1.3.3.cmml" xref="alg2.l1.m2.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg2.l1.m2.1.1.1.3.cmml" xref="alg2.l1.m2.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.3.1.cmml" xref="alg2.l1.m2.1.1.1.3">subscript</csymbol><ci id="alg2.l1.m2.1.1.1.3.2.cmml" xref="alg2.l1.m2.1.1.1.3.2">𝑁</ci><ci id="alg2.l1.m2.1.1.1.3.3.cmml" xref="alg2.l1.m2.1.1.1.3.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">X^{l}=\{(g^{l}_{i},y^{l}_{i})\}_{i=1}^{N_{l}}</annotation></semantics></math>, <math id="alg2.l1.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="alg2.l1.m3.1a"><mi id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><ci id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">\gamma</annotation></semantics></math>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span><span id="alg2.l2.2" class="ltx_text ltx_font_bold">Output:</span> <math id="alg2.l2.m1.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="alg2.l2.m1.1a"><msup id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">F</mi><mi id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1">superscript</csymbol><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝐹</ci><ci id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">F^{l}</annotation></semantics></math>

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>Save <math id="alg2.l3.m1.2" class="ltx_Math" alttext="\phi(g^{l}_{i},F^{g})" display="inline"><semantics id="alg2.l3.m1.2a"><mrow id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml"><mi id="alg2.l3.m1.2.2.4" xref="alg2.l3.m1.2.2.4.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m1.2.2.3" xref="alg2.l3.m1.2.2.3.cmml">​</mo><mrow id="alg2.l3.m1.2.2.2.2" xref="alg2.l3.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l3.m1.2.2.2.2.3" xref="alg2.l3.m1.2.2.2.3.cmml">(</mo><msubsup id="alg2.l3.m1.1.1.1.1.1" xref="alg2.l3.m1.1.1.1.1.1.cmml"><mi id="alg2.l3.m1.1.1.1.1.1.2.2" xref="alg2.l3.m1.1.1.1.1.1.2.2.cmml">g</mi><mi id="alg2.l3.m1.1.1.1.1.1.3" xref="alg2.l3.m1.1.1.1.1.1.3.cmml">i</mi><mi id="alg2.l3.m1.1.1.1.1.1.2.3" xref="alg2.l3.m1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg2.l3.m1.2.2.2.2.4" xref="alg2.l3.m1.2.2.2.3.cmml">,</mo><msup id="alg2.l3.m1.2.2.2.2.2" xref="alg2.l3.m1.2.2.2.2.2.cmml"><mi id="alg2.l3.m1.2.2.2.2.2.2" xref="alg2.l3.m1.2.2.2.2.2.2.cmml">F</mi><mi id="alg2.l3.m1.2.2.2.2.2.3" xref="alg2.l3.m1.2.2.2.2.2.3.cmml">g</mi></msup><mo stretchy="false" id="alg2.l3.m1.2.2.2.2.5" xref="alg2.l3.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.2b"><apply id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2"><times id="alg2.l3.m1.2.2.3.cmml" xref="alg2.l3.m1.2.2.3"></times><ci id="alg2.l3.m1.2.2.4.cmml" xref="alg2.l3.m1.2.2.4">italic-ϕ</ci><interval closure="open" id="alg2.l3.m1.2.2.2.3.cmml" xref="alg2.l3.m1.2.2.2.2"><apply id="alg2.l3.m1.1.1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l3.m1.1.1.1.1.1.2.cmml" xref="alg2.l3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l3.m1.1.1.1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.1.1.1.2.2">𝑔</ci><ci id="alg2.l3.m1.1.1.1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg2.l3.m1.1.1.1.1.1.3.cmml" xref="alg2.l3.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l3.m1.2.2.2.2.2.cmml" xref="alg2.l3.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l3.m1.2.2.2.2.2.1.cmml" xref="alg2.l3.m1.2.2.2.2.2">superscript</csymbol><ci id="alg2.l3.m1.2.2.2.2.2.2.cmml" xref="alg2.l3.m1.2.2.2.2.2.2">𝐹</ci><ci id="alg2.l3.m1.2.2.2.2.2.3.cmml" xref="alg2.l3.m1.2.2.2.2.2.3">𝑔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.2c">\phi(g^{l}_{i},F^{g})</annotation></semantics></math> Eq. (<a href="#S4.E8" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) or <math id="alg2.l3.m2.2" class="ltx_Math" alttext="\phi_{+}(g^{l}_{i},F^{g})" display="inline"><semantics id="alg2.l3.m2.2a"><mrow id="alg2.l3.m2.2.2" xref="alg2.l3.m2.2.2.cmml"><msub id="alg2.l3.m2.2.2.4" xref="alg2.l3.m2.2.2.4.cmml"><mi id="alg2.l3.m2.2.2.4.2" xref="alg2.l3.m2.2.2.4.2.cmml">ϕ</mi><mo id="alg2.l3.m2.2.2.4.3" xref="alg2.l3.m2.2.2.4.3.cmml">+</mo></msub><mo lspace="0em" rspace="0em" id="alg2.l3.m2.2.2.3" xref="alg2.l3.m2.2.2.3.cmml">​</mo><mrow id="alg2.l3.m2.2.2.2.2" xref="alg2.l3.m2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l3.m2.2.2.2.2.3" xref="alg2.l3.m2.2.2.2.3.cmml">(</mo><msubsup id="alg2.l3.m2.1.1.1.1.1" xref="alg2.l3.m2.1.1.1.1.1.cmml"><mi id="alg2.l3.m2.1.1.1.1.1.2.2" xref="alg2.l3.m2.1.1.1.1.1.2.2.cmml">g</mi><mi id="alg2.l3.m2.1.1.1.1.1.3" xref="alg2.l3.m2.1.1.1.1.1.3.cmml">i</mi><mi id="alg2.l3.m2.1.1.1.1.1.2.3" xref="alg2.l3.m2.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg2.l3.m2.2.2.2.2.4" xref="alg2.l3.m2.2.2.2.3.cmml">,</mo><msup id="alg2.l3.m2.2.2.2.2.2" xref="alg2.l3.m2.2.2.2.2.2.cmml"><mi id="alg2.l3.m2.2.2.2.2.2.2" xref="alg2.l3.m2.2.2.2.2.2.2.cmml">F</mi><mi id="alg2.l3.m2.2.2.2.2.2.3" xref="alg2.l3.m2.2.2.2.2.2.3.cmml">g</mi></msup><mo stretchy="false" id="alg2.l3.m2.2.2.2.2.5" xref="alg2.l3.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.2b"><apply id="alg2.l3.m2.2.2.cmml" xref="alg2.l3.m2.2.2"><times id="alg2.l3.m2.2.2.3.cmml" xref="alg2.l3.m2.2.2.3"></times><apply id="alg2.l3.m2.2.2.4.cmml" xref="alg2.l3.m2.2.2.4"><csymbol cd="ambiguous" id="alg2.l3.m2.2.2.4.1.cmml" xref="alg2.l3.m2.2.2.4">subscript</csymbol><ci id="alg2.l3.m2.2.2.4.2.cmml" xref="alg2.l3.m2.2.2.4.2">italic-ϕ</ci><plus id="alg2.l3.m2.2.2.4.3.cmml" xref="alg2.l3.m2.2.2.4.3"></plus></apply><interval closure="open" id="alg2.l3.m2.2.2.2.3.cmml" xref="alg2.l3.m2.2.2.2.2"><apply id="alg2.l3.m2.1.1.1.1.1.cmml" xref="alg2.l3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.1.1.1.1.cmml" xref="alg2.l3.m2.1.1.1.1.1">subscript</csymbol><apply id="alg2.l3.m2.1.1.1.1.1.2.cmml" xref="alg2.l3.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.1.1.1.2.1.cmml" xref="alg2.l3.m2.1.1.1.1.1">superscript</csymbol><ci id="alg2.l3.m2.1.1.1.1.1.2.2.cmml" xref="alg2.l3.m2.1.1.1.1.1.2.2">𝑔</ci><ci id="alg2.l3.m2.1.1.1.1.1.2.3.cmml" xref="alg2.l3.m2.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg2.l3.m2.1.1.1.1.1.3.cmml" xref="alg2.l3.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l3.m2.2.2.2.2.2.cmml" xref="alg2.l3.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l3.m2.2.2.2.2.2.1.cmml" xref="alg2.l3.m2.2.2.2.2.2">superscript</csymbol><ci id="alg2.l3.m2.2.2.2.2.2.2.cmml" xref="alg2.l3.m2.2.2.2.2.2.2">𝐹</ci><ci id="alg2.l3.m2.2.2.2.2.2.3.cmml" xref="alg2.l3.m2.2.2.2.2.2.3">𝑔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.2c">\phi_{+}(g^{l}_{i},F^{g})</annotation></semantics></math> Eq. (<a href="#S4.E10" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>)

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.3.1.1" class="ltx_text" style="font-size:80%;">4:</span></span><math id="alg2.l4.m1.1" class="ltx_Math" alttext="F^{l}\leftarrow F^{g}" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><msup id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml"><mi id="alg2.l4.m1.1.1.2.2" xref="alg2.l4.m1.1.1.2.2.cmml">F</mi><mi id="alg2.l4.m1.1.1.2.3" xref="alg2.l4.m1.1.1.2.3.cmml">l</mi></msup><mo stretchy="false" id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">←</mo><msup id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml"><mi id="alg2.l4.m1.1.1.3.2" xref="alg2.l4.m1.1.1.3.2.cmml">F</mi><mi id="alg2.l4.m1.1.1.3.3" xref="alg2.l4.m1.1.1.3.3.cmml">g</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><ci id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1">←</ci><apply id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.2.1.cmml" xref="alg2.l4.m1.1.1.2">superscript</csymbol><ci id="alg2.l4.m1.1.1.2.2.cmml" xref="alg2.l4.m1.1.1.2.2">𝐹</ci><ci id="alg2.l4.m1.1.1.2.3.cmml" xref="alg2.l4.m1.1.1.2.3">𝑙</ci></apply><apply id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.3">superscript</csymbol><ci id="alg2.l4.m1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.3.2">𝐹</ci><ci id="alg2.l4.m1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.3.3">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">F^{l}\leftarrow F^{g}</annotation></semantics></math> <span id="alg2.l4.2" class="ltx_text" style="float:right;"><math id="alg2.l4.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l4.1.m1.1a"><mo id="alg2.l4.1.m1.1.1" xref="alg2.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l4.1.m1.1b"><ci id="alg2.l4.1.m1.1.1.cmml" xref="alg2.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.1.m1.1c">\triangleright</annotation></semantics></math> Init. <math id="alg2.l4.2.m2.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="alg2.l4.2.m2.1a"><msup id="alg2.l4.2.m2.1.1" xref="alg2.l4.2.m2.1.1.cmml"><mi id="alg2.l4.2.m2.1.1.2" xref="alg2.l4.2.m2.1.1.2.cmml">F</mi><mi id="alg2.l4.2.m2.1.1.3" xref="alg2.l4.2.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l4.2.m2.1b"><apply id="alg2.l4.2.m2.1.1.cmml" xref="alg2.l4.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l4.2.m2.1.1.1.cmml" xref="alg2.l4.2.m2.1.1">superscript</csymbol><ci id="alg2.l4.2.m2.1.1.2.cmml" xref="alg2.l4.2.m2.1.1.2">𝐹</ci><ci id="alg2.l4.2.m2.1.1.3.cmml" xref="alg2.l4.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.2.m2.1c">F^{l}</annotation></semantics></math>
</span>
</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.3.1.1" class="ltx_text" style="font-size:80%;">5:</span></span><span id="alg2.l5.4" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l5.m1.1" class="ltx_Math" alttext="t:1" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mi id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">t</mi><mo lspace="0.278em" rspace="0.278em" id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">:</mo><mn id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><ci id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1">:</ci><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">𝑡</ci><cn type="integer" id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">t:1</annotation></semantics></math> to <math id="alg2.l5.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg2.l5.m2.1a"><mi id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><ci id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">K</annotation></semantics></math> <span id="alg2.l5.5" class="ltx_text ltx_font_bold">do</span> <span id="alg2.l5.2" class="ltx_text" style="float:right;"><math id="alg2.l5.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l5.1.m1.1a"><mo id="alg2.l5.1.m1.1.1" xref="alg2.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l5.1.m1.1b"><ci id="alg2.l5.1.m1.1.1.cmml" xref="alg2.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.1.m1.1c">\triangleright</annotation></semantics></math> Train on the <math id="alg2.l5.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="alg2.l5.2.m2.1a"><mi id="alg2.l5.2.m2.1.1" xref="alg2.l5.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.2.m2.1b"><ci id="alg2.l5.2.m2.1.1.cmml" xref="alg2.l5.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.2.m2.1c">l</annotation></semantics></math>-th Client
</span>
</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     Sample a minibatch <math id="alg2.l6.m1.2" class="ltx_Math" alttext="\{g^{l}_{i},y^{l}_{i}\}_{i=1}^{B}" display="inline"><semantics id="alg2.l6.m1.2a"><msubsup id="alg2.l6.m1.2.2" xref="alg2.l6.m1.2.2.cmml"><mrow id="alg2.l6.m1.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l6.m1.2.2.2.2.2.3" xref="alg2.l6.m1.2.2.2.2.3.cmml">{</mo><msubsup id="alg2.l6.m1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l6.m1.1.1.1.1.1.1.2.2" xref="alg2.l6.m1.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="alg2.l6.m1.1.1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.1.1.3.cmml">i</mi><mi id="alg2.l6.m1.1.1.1.1.1.1.2.3" xref="alg2.l6.m1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg2.l6.m1.2.2.2.2.2.4" xref="alg2.l6.m1.2.2.2.2.3.cmml">,</mo><msubsup id="alg2.l6.m1.2.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.2.cmml"><mi id="alg2.l6.m1.2.2.2.2.2.2.2.2" xref="alg2.l6.m1.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="alg2.l6.m1.2.2.2.2.2.2.3" xref="alg2.l6.m1.2.2.2.2.2.2.3.cmml">i</mi><mi id="alg2.l6.m1.2.2.2.2.2.2.2.3" xref="alg2.l6.m1.2.2.2.2.2.2.2.3.cmml">l</mi></msubsup><mo stretchy="false" id="alg2.l6.m1.2.2.2.2.2.5" xref="alg2.l6.m1.2.2.2.2.3.cmml">}</mo></mrow><mrow id="alg2.l6.m1.2.2.2.4" xref="alg2.l6.m1.2.2.2.4.cmml"><mi id="alg2.l6.m1.2.2.2.4.2" xref="alg2.l6.m1.2.2.2.4.2.cmml">i</mi><mo id="alg2.l6.m1.2.2.2.4.1" xref="alg2.l6.m1.2.2.2.4.1.cmml">=</mo><mn id="alg2.l6.m1.2.2.2.4.3" xref="alg2.l6.m1.2.2.2.4.3.cmml">1</mn></mrow><mi id="alg2.l6.m1.2.2.4" xref="alg2.l6.m1.2.2.4.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.2b"><apply id="alg2.l6.m1.2.2.cmml" xref="alg2.l6.m1.2.2"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.3.cmml" xref="alg2.l6.m1.2.2">superscript</csymbol><apply id="alg2.l6.m1.2.2.2.cmml" xref="alg2.l6.m1.2.2"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.2.3.cmml" xref="alg2.l6.m1.2.2">subscript</csymbol><set id="alg2.l6.m1.2.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.2.2"><apply id="alg2.l6.m1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l6.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.2.2">𝑔</ci><ci id="alg2.l6.m1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg2.l6.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l6.m1.2.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l6.m1.2.2.2.2.2.2">subscript</csymbol><apply id="alg2.l6.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.2.2.2.2.2.1.cmml" xref="alg2.l6.m1.2.2.2.2.2.2">superscript</csymbol><ci id="alg2.l6.m1.2.2.2.2.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.2.2">𝑦</ci><ci id="alg2.l6.m1.2.2.2.2.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.2.3">𝑙</ci></apply><ci id="alg2.l6.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.2.2.2.3">𝑖</ci></apply></set><apply id="alg2.l6.m1.2.2.2.4.cmml" xref="alg2.l6.m1.2.2.2.4"><eq id="alg2.l6.m1.2.2.2.4.1.cmml" xref="alg2.l6.m1.2.2.2.4.1"></eq><ci id="alg2.l6.m1.2.2.2.4.2.cmml" xref="alg2.l6.m1.2.2.2.4.2">𝑖</ci><cn type="integer" id="alg2.l6.m1.2.2.2.4.3.cmml" xref="alg2.l6.m1.2.2.2.4.3">1</cn></apply></apply><ci id="alg2.l6.m1.2.2.4.cmml" xref="alg2.l6.m1.2.2.4">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.2c">\{g^{l}_{i},y^{l}_{i}\}_{i=1}^{B}</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     calculate <math id="alg2.l7.m1.2" class="ltx_Math" alttext="\phi(g^{l}_{i},F^{l})" display="inline"><semantics id="alg2.l7.m1.2a"><mrow id="alg2.l7.m1.2.2" xref="alg2.l7.m1.2.2.cmml"><mi id="alg2.l7.m1.2.2.4" xref="alg2.l7.m1.2.2.4.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.2.2.3" xref="alg2.l7.m1.2.2.3.cmml">​</mo><mrow id="alg2.l7.m1.2.2.2.2" xref="alg2.l7.m1.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l7.m1.2.2.2.2.3" xref="alg2.l7.m1.2.2.2.3.cmml">(</mo><msubsup id="alg2.l7.m1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.2.2" xref="alg2.l7.m1.1.1.1.1.1.2.2.cmml">g</mi><mi id="alg2.l7.m1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.3.cmml">i</mi><mi id="alg2.l7.m1.1.1.1.1.1.2.3" xref="alg2.l7.m1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg2.l7.m1.2.2.2.2.4" xref="alg2.l7.m1.2.2.2.3.cmml">,</mo><msup id="alg2.l7.m1.2.2.2.2.2" xref="alg2.l7.m1.2.2.2.2.2.cmml"><mi id="alg2.l7.m1.2.2.2.2.2.2" xref="alg2.l7.m1.2.2.2.2.2.2.cmml">F</mi><mi id="alg2.l7.m1.2.2.2.2.2.3" xref="alg2.l7.m1.2.2.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="alg2.l7.m1.2.2.2.2.5" xref="alg2.l7.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.2b"><apply id="alg2.l7.m1.2.2.cmml" xref="alg2.l7.m1.2.2"><times id="alg2.l7.m1.2.2.3.cmml" xref="alg2.l7.m1.2.2.3"></times><ci id="alg2.l7.m1.2.2.4.cmml" xref="alg2.l7.m1.2.2.4">italic-ϕ</ci><interval closure="open" id="alg2.l7.m1.2.2.2.3.cmml" xref="alg2.l7.m1.2.2.2.2"><apply id="alg2.l7.m1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l7.m1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.2.1.cmml" xref="alg2.l7.m1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.2.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.2.2">𝑔</ci><ci id="alg2.l7.m1.1.1.1.1.1.2.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg2.l7.m1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l7.m1.2.2.2.2.2.cmml" xref="alg2.l7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l7.m1.2.2.2.2.2.1.cmml" xref="alg2.l7.m1.2.2.2.2.2">superscript</csymbol><ci id="alg2.l7.m1.2.2.2.2.2.2.cmml" xref="alg2.l7.m1.2.2.2.2.2.2">𝐹</ci><ci id="alg2.l7.m1.2.2.2.2.2.3.cmml" xref="alg2.l7.m1.2.2.2.2.2.3">𝑙</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.2c">\phi(g^{l}_{i},F^{l})</annotation></semantics></math> by Eq. (<a href="#S4.E8" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) (or <math id="alg2.l7.m2.2" class="ltx_Math" alttext="\phi_{+}(g^{l}_{i},F^{l})" display="inline"><semantics id="alg2.l7.m2.2a"><mrow id="alg2.l7.m2.2.2" xref="alg2.l7.m2.2.2.cmml"><msub id="alg2.l7.m2.2.2.4" xref="alg2.l7.m2.2.2.4.cmml"><mi id="alg2.l7.m2.2.2.4.2" xref="alg2.l7.m2.2.2.4.2.cmml">ϕ</mi><mo id="alg2.l7.m2.2.2.4.3" xref="alg2.l7.m2.2.2.4.3.cmml">+</mo></msub><mo lspace="0em" rspace="0em" id="alg2.l7.m2.2.2.3" xref="alg2.l7.m2.2.2.3.cmml">​</mo><mrow id="alg2.l7.m2.2.2.2.2" xref="alg2.l7.m2.2.2.2.3.cmml"><mo stretchy="false" id="alg2.l7.m2.2.2.2.2.3" xref="alg2.l7.m2.2.2.2.3.cmml">(</mo><msubsup id="alg2.l7.m2.1.1.1.1.1" xref="alg2.l7.m2.1.1.1.1.1.cmml"><mi id="alg2.l7.m2.1.1.1.1.1.2.2" xref="alg2.l7.m2.1.1.1.1.1.2.2.cmml">g</mi><mi id="alg2.l7.m2.1.1.1.1.1.3" xref="alg2.l7.m2.1.1.1.1.1.3.cmml">i</mi><mi id="alg2.l7.m2.1.1.1.1.1.2.3" xref="alg2.l7.m2.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg2.l7.m2.2.2.2.2.4" xref="alg2.l7.m2.2.2.2.3.cmml">,</mo><msup id="alg2.l7.m2.2.2.2.2.2" xref="alg2.l7.m2.2.2.2.2.2.cmml"><mi id="alg2.l7.m2.2.2.2.2.2.2" xref="alg2.l7.m2.2.2.2.2.2.2.cmml">F</mi><mi id="alg2.l7.m2.2.2.2.2.2.3" xref="alg2.l7.m2.2.2.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="alg2.l7.m2.2.2.2.2.5" xref="alg2.l7.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m2.2b"><apply id="alg2.l7.m2.2.2.cmml" xref="alg2.l7.m2.2.2"><times id="alg2.l7.m2.2.2.3.cmml" xref="alg2.l7.m2.2.2.3"></times><apply id="alg2.l7.m2.2.2.4.cmml" xref="alg2.l7.m2.2.2.4"><csymbol cd="ambiguous" id="alg2.l7.m2.2.2.4.1.cmml" xref="alg2.l7.m2.2.2.4">subscript</csymbol><ci id="alg2.l7.m2.2.2.4.2.cmml" xref="alg2.l7.m2.2.2.4.2">italic-ϕ</ci><plus id="alg2.l7.m2.2.2.4.3.cmml" xref="alg2.l7.m2.2.2.4.3"></plus></apply><interval closure="open" id="alg2.l7.m2.2.2.2.3.cmml" xref="alg2.l7.m2.2.2.2.2"><apply id="alg2.l7.m2.1.1.1.1.1.cmml" xref="alg2.l7.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m2.1.1.1.1.1.1.cmml" xref="alg2.l7.m2.1.1.1.1.1">subscript</csymbol><apply id="alg2.l7.m2.1.1.1.1.1.2.cmml" xref="alg2.l7.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m2.1.1.1.1.1.2.1.cmml" xref="alg2.l7.m2.1.1.1.1.1">superscript</csymbol><ci id="alg2.l7.m2.1.1.1.1.1.2.2.cmml" xref="alg2.l7.m2.1.1.1.1.1.2.2">𝑔</ci><ci id="alg2.l7.m2.1.1.1.1.1.2.3.cmml" xref="alg2.l7.m2.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg2.l7.m2.1.1.1.1.1.3.cmml" xref="alg2.l7.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l7.m2.2.2.2.2.2.cmml" xref="alg2.l7.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l7.m2.2.2.2.2.2.1.cmml" xref="alg2.l7.m2.2.2.2.2.2">superscript</csymbol><ci id="alg2.l7.m2.2.2.2.2.2.2.cmml" xref="alg2.l7.m2.2.2.2.2.2.2">𝐹</ci><ci id="alg2.l7.m2.2.2.2.2.2.3.cmml" xref="alg2.l7.m2.2.2.2.2.2.3">𝑙</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m2.2c">\phi_{+}(g^{l}_{i},F^{l})</annotation></semantics></math> by Eq. (<a href="#S4.E10" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>))

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     Obtain <math id="alg2.l8.m1.4" class="ltx_Math" alttext="\omega_{(+)}(x^{l},F^{l},F^{g})" display="inline"><semantics id="alg2.l8.m1.4a"><mrow id="alg2.l8.m1.4.4" xref="alg2.l8.m1.4.4.cmml"><msub id="alg2.l8.m1.4.4.5" xref="alg2.l8.m1.4.4.5.cmml"><mi id="alg2.l8.m1.4.4.5.2" xref="alg2.l8.m1.4.4.5.2.cmml">ω</mi><mrow id="alg2.l8.m1.1.1.1.3" xref="alg2.l8.m1.4.4.5.cmml"><mo stretchy="false" id="alg2.l8.m1.1.1.1.3.1" xref="alg2.l8.m1.4.4.5.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg2.l8.m1.1.1.1.1" xref="alg2.l8.m1.1.1.1.1.cmml">+</mo><mo stretchy="false" id="alg2.l8.m1.1.1.1.3.2" xref="alg2.l8.m1.4.4.5.cmml">)</mo></mrow></msub><mo lspace="0em" rspace="0em" id="alg2.l8.m1.4.4.4" xref="alg2.l8.m1.4.4.4.cmml">​</mo><mrow id="alg2.l8.m1.4.4.3.3" xref="alg2.l8.m1.4.4.3.4.cmml"><mo stretchy="false" id="alg2.l8.m1.4.4.3.3.4" xref="alg2.l8.m1.4.4.3.4.cmml">(</mo><msup id="alg2.l8.m1.2.2.1.1.1" xref="alg2.l8.m1.2.2.1.1.1.cmml"><mi id="alg2.l8.m1.2.2.1.1.1.2" xref="alg2.l8.m1.2.2.1.1.1.2.cmml">x</mi><mi id="alg2.l8.m1.2.2.1.1.1.3" xref="alg2.l8.m1.2.2.1.1.1.3.cmml">l</mi></msup><mo id="alg2.l8.m1.4.4.3.3.5" xref="alg2.l8.m1.4.4.3.4.cmml">,</mo><msup id="alg2.l8.m1.3.3.2.2.2" xref="alg2.l8.m1.3.3.2.2.2.cmml"><mi id="alg2.l8.m1.3.3.2.2.2.2" xref="alg2.l8.m1.3.3.2.2.2.2.cmml">F</mi><mi id="alg2.l8.m1.3.3.2.2.2.3" xref="alg2.l8.m1.3.3.2.2.2.3.cmml">l</mi></msup><mo id="alg2.l8.m1.4.4.3.3.6" xref="alg2.l8.m1.4.4.3.4.cmml">,</mo><msup id="alg2.l8.m1.4.4.3.3.3" xref="alg2.l8.m1.4.4.3.3.3.cmml"><mi id="alg2.l8.m1.4.4.3.3.3.2" xref="alg2.l8.m1.4.4.3.3.3.2.cmml">F</mi><mi id="alg2.l8.m1.4.4.3.3.3.3" xref="alg2.l8.m1.4.4.3.3.3.3.cmml">g</mi></msup><mo stretchy="false" id="alg2.l8.m1.4.4.3.3.7" xref="alg2.l8.m1.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.4b"><apply id="alg2.l8.m1.4.4.cmml" xref="alg2.l8.m1.4.4"><times id="alg2.l8.m1.4.4.4.cmml" xref="alg2.l8.m1.4.4.4"></times><apply id="alg2.l8.m1.4.4.5.cmml" xref="alg2.l8.m1.4.4.5"><csymbol cd="ambiguous" id="alg2.l8.m1.4.4.5.1.cmml" xref="alg2.l8.m1.4.4.5">subscript</csymbol><ci id="alg2.l8.m1.4.4.5.2.cmml" xref="alg2.l8.m1.4.4.5.2">𝜔</ci><plus id="alg2.l8.m1.1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1.1"></plus></apply><vector id="alg2.l8.m1.4.4.3.4.cmml" xref="alg2.l8.m1.4.4.3.3"><apply id="alg2.l8.m1.2.2.1.1.1.cmml" xref="alg2.l8.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.2.2.1.1.1.1.cmml" xref="alg2.l8.m1.2.2.1.1.1">superscript</csymbol><ci id="alg2.l8.m1.2.2.1.1.1.2.cmml" xref="alg2.l8.m1.2.2.1.1.1.2">𝑥</ci><ci id="alg2.l8.m1.2.2.1.1.1.3.cmml" xref="alg2.l8.m1.2.2.1.1.1.3">𝑙</ci></apply><apply id="alg2.l8.m1.3.3.2.2.2.cmml" xref="alg2.l8.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.3.3.2.2.2.1.cmml" xref="alg2.l8.m1.3.3.2.2.2">superscript</csymbol><ci id="alg2.l8.m1.3.3.2.2.2.2.cmml" xref="alg2.l8.m1.3.3.2.2.2.2">𝐹</ci><ci id="alg2.l8.m1.3.3.2.2.2.3.cmml" xref="alg2.l8.m1.3.3.2.2.2.3">𝑙</ci></apply><apply id="alg2.l8.m1.4.4.3.3.3.cmml" xref="alg2.l8.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.4.4.3.3.3.1.cmml" xref="alg2.l8.m1.4.4.3.3.3">superscript</csymbol><ci id="alg2.l8.m1.4.4.3.3.3.2.cmml" xref="alg2.l8.m1.4.4.3.3.3.2">𝐹</ci><ci id="alg2.l8.m1.4.4.3.3.3.3.cmml" xref="alg2.l8.m1.4.4.3.3.3.3">𝑔</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.4c">\omega_{(+)}(x^{l},F^{l},F^{g})</annotation></semantics></math> by Eq. (<a href="#S4.E7" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>)

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.3.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <math id="alg2.l9.m1.9" class="ltx_Math" alttext="\omega(G^{l}_{i},F^{l},F^{g})\leftarrow\frac{\omega(G^{l}_{i},F^{l},F^{g})}{\bar{\omega}(G^{l}_{i},F^{l},F^{g})}" display="inline"><semantics id="alg2.l9.m1.9a"><mrow id="alg2.l9.m1.9.9" xref="alg2.l9.m1.9.9.cmml"><mrow id="alg2.l9.m1.9.9.3" xref="alg2.l9.m1.9.9.3.cmml"><mi id="alg2.l9.m1.9.9.3.5" xref="alg2.l9.m1.9.9.3.5.cmml">ω</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.9.9.3.4" xref="alg2.l9.m1.9.9.3.4.cmml">​</mo><mrow id="alg2.l9.m1.9.9.3.3.3" xref="alg2.l9.m1.9.9.3.3.4.cmml"><mo stretchy="false" id="alg2.l9.m1.9.9.3.3.3.4" xref="alg2.l9.m1.9.9.3.3.4.cmml">(</mo><msubsup id="alg2.l9.m1.7.7.1.1.1.1" xref="alg2.l9.m1.7.7.1.1.1.1.cmml"><mi id="alg2.l9.m1.7.7.1.1.1.1.2.2" xref="alg2.l9.m1.7.7.1.1.1.1.2.2.cmml">G</mi><mi id="alg2.l9.m1.7.7.1.1.1.1.3" xref="alg2.l9.m1.7.7.1.1.1.1.3.cmml">i</mi><mi id="alg2.l9.m1.7.7.1.1.1.1.2.3" xref="alg2.l9.m1.7.7.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg2.l9.m1.9.9.3.3.3.5" xref="alg2.l9.m1.9.9.3.3.4.cmml">,</mo><msup id="alg2.l9.m1.8.8.2.2.2.2" xref="alg2.l9.m1.8.8.2.2.2.2.cmml"><mi id="alg2.l9.m1.8.8.2.2.2.2.2" xref="alg2.l9.m1.8.8.2.2.2.2.2.cmml">F</mi><mi id="alg2.l9.m1.8.8.2.2.2.2.3" xref="alg2.l9.m1.8.8.2.2.2.2.3.cmml">l</mi></msup><mo id="alg2.l9.m1.9.9.3.3.3.6" xref="alg2.l9.m1.9.9.3.3.4.cmml">,</mo><msup id="alg2.l9.m1.9.9.3.3.3.3" xref="alg2.l9.m1.9.9.3.3.3.3.cmml"><mi id="alg2.l9.m1.9.9.3.3.3.3.2" xref="alg2.l9.m1.9.9.3.3.3.3.2.cmml">F</mi><mi id="alg2.l9.m1.9.9.3.3.3.3.3" xref="alg2.l9.m1.9.9.3.3.3.3.3.cmml">g</mi></msup><mo stretchy="false" id="alg2.l9.m1.9.9.3.3.3.7" xref="alg2.l9.m1.9.9.3.3.4.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l9.m1.9.9.4" xref="alg2.l9.m1.9.9.4.cmml">←</mo><mfrac id="alg2.l9.m1.6.6" xref="alg2.l9.m1.6.6.cmml"><mrow id="alg2.l9.m1.3.3.3" xref="alg2.l9.m1.3.3.3.cmml"><mi id="alg2.l9.m1.3.3.3.5" xref="alg2.l9.m1.3.3.3.5.cmml">ω</mi><mo lspace="0em" rspace="0em" id="alg2.l9.m1.3.3.3.4" xref="alg2.l9.m1.3.3.3.4.cmml">​</mo><mrow id="alg2.l9.m1.3.3.3.3.3" xref="alg2.l9.m1.3.3.3.3.4.cmml"><mo stretchy="false" id="alg2.l9.m1.3.3.3.3.3.4" xref="alg2.l9.m1.3.3.3.3.4.cmml">(</mo><msubsup id="alg2.l9.m1.1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l9.m1.1.1.1.1.1.1.2.2" xref="alg2.l9.m1.1.1.1.1.1.1.2.2.cmml">G</mi><mi id="alg2.l9.m1.1.1.1.1.1.1.3" xref="alg2.l9.m1.1.1.1.1.1.1.3.cmml">i</mi><mi id="alg2.l9.m1.1.1.1.1.1.1.2.3" xref="alg2.l9.m1.1.1.1.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg2.l9.m1.3.3.3.3.3.5" xref="alg2.l9.m1.3.3.3.3.4.cmml">,</mo><msup id="alg2.l9.m1.2.2.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.2.2.cmml"><mi id="alg2.l9.m1.2.2.2.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.2.2.2.cmml">F</mi><mi id="alg2.l9.m1.2.2.2.2.2.2.3" xref="alg2.l9.m1.2.2.2.2.2.2.3.cmml">l</mi></msup><mo id="alg2.l9.m1.3.3.3.3.3.6" xref="alg2.l9.m1.3.3.3.3.4.cmml">,</mo><msup id="alg2.l9.m1.3.3.3.3.3.3" xref="alg2.l9.m1.3.3.3.3.3.3.cmml"><mi id="alg2.l9.m1.3.3.3.3.3.3.2" xref="alg2.l9.m1.3.3.3.3.3.3.2.cmml">F</mi><mi id="alg2.l9.m1.3.3.3.3.3.3.3" xref="alg2.l9.m1.3.3.3.3.3.3.3.cmml">g</mi></msup><mo stretchy="false" id="alg2.l9.m1.3.3.3.3.3.7" xref="alg2.l9.m1.3.3.3.3.4.cmml">)</mo></mrow></mrow><mrow id="alg2.l9.m1.6.6.6" xref="alg2.l9.m1.6.6.6.cmml"><mover accent="true" id="alg2.l9.m1.6.6.6.5" xref="alg2.l9.m1.6.6.6.5.cmml"><mi id="alg2.l9.m1.6.6.6.5.2" xref="alg2.l9.m1.6.6.6.5.2.cmml">ω</mi><mo id="alg2.l9.m1.6.6.6.5.1" xref="alg2.l9.m1.6.6.6.5.1.cmml">¯</mo></mover><mo lspace="0em" rspace="0em" id="alg2.l9.m1.6.6.6.4" xref="alg2.l9.m1.6.6.6.4.cmml">​</mo><mrow id="alg2.l9.m1.6.6.6.3.3" xref="alg2.l9.m1.6.6.6.3.4.cmml"><mo stretchy="false" id="alg2.l9.m1.6.6.6.3.3.4" xref="alg2.l9.m1.6.6.6.3.4.cmml">(</mo><msubsup id="alg2.l9.m1.4.4.4.1.1.1" xref="alg2.l9.m1.4.4.4.1.1.1.cmml"><mi id="alg2.l9.m1.4.4.4.1.1.1.2.2" xref="alg2.l9.m1.4.4.4.1.1.1.2.2.cmml">G</mi><mi id="alg2.l9.m1.4.4.4.1.1.1.3" xref="alg2.l9.m1.4.4.4.1.1.1.3.cmml">i</mi><mi id="alg2.l9.m1.4.4.4.1.1.1.2.3" xref="alg2.l9.m1.4.4.4.1.1.1.2.3.cmml">l</mi></msubsup><mo id="alg2.l9.m1.6.6.6.3.3.5" xref="alg2.l9.m1.6.6.6.3.4.cmml">,</mo><msup id="alg2.l9.m1.5.5.5.2.2.2" xref="alg2.l9.m1.5.5.5.2.2.2.cmml"><mi id="alg2.l9.m1.5.5.5.2.2.2.2" xref="alg2.l9.m1.5.5.5.2.2.2.2.cmml">F</mi><mi id="alg2.l9.m1.5.5.5.2.2.2.3" xref="alg2.l9.m1.5.5.5.2.2.2.3.cmml">l</mi></msup><mo id="alg2.l9.m1.6.6.6.3.3.6" xref="alg2.l9.m1.6.6.6.3.4.cmml">,</mo><msup id="alg2.l9.m1.6.6.6.3.3.3" xref="alg2.l9.m1.6.6.6.3.3.3.cmml"><mi id="alg2.l9.m1.6.6.6.3.3.3.2" xref="alg2.l9.m1.6.6.6.3.3.3.2.cmml">F</mi><mi id="alg2.l9.m1.6.6.6.3.3.3.3" xref="alg2.l9.m1.6.6.6.3.3.3.3.cmml">g</mi></msup><mo stretchy="false" id="alg2.l9.m1.6.6.6.3.3.7" xref="alg2.l9.m1.6.6.6.3.4.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.9b"><apply id="alg2.l9.m1.9.9.cmml" xref="alg2.l9.m1.9.9"><ci id="alg2.l9.m1.9.9.4.cmml" xref="alg2.l9.m1.9.9.4">←</ci><apply id="alg2.l9.m1.9.9.3.cmml" xref="alg2.l9.m1.9.9.3"><times id="alg2.l9.m1.9.9.3.4.cmml" xref="alg2.l9.m1.9.9.3.4"></times><ci id="alg2.l9.m1.9.9.3.5.cmml" xref="alg2.l9.m1.9.9.3.5">𝜔</ci><vector id="alg2.l9.m1.9.9.3.3.4.cmml" xref="alg2.l9.m1.9.9.3.3.3"><apply id="alg2.l9.m1.7.7.1.1.1.1.cmml" xref="alg2.l9.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.7.7.1.1.1.1.1.cmml" xref="alg2.l9.m1.7.7.1.1.1.1">subscript</csymbol><apply id="alg2.l9.m1.7.7.1.1.1.1.2.cmml" xref="alg2.l9.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.7.7.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.7.7.1.1.1.1">superscript</csymbol><ci id="alg2.l9.m1.7.7.1.1.1.1.2.2.cmml" xref="alg2.l9.m1.7.7.1.1.1.1.2.2">𝐺</ci><ci id="alg2.l9.m1.7.7.1.1.1.1.2.3.cmml" xref="alg2.l9.m1.7.7.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg2.l9.m1.7.7.1.1.1.1.3.cmml" xref="alg2.l9.m1.7.7.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l9.m1.8.8.2.2.2.2.cmml" xref="alg2.l9.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l9.m1.8.8.2.2.2.2.1.cmml" xref="alg2.l9.m1.8.8.2.2.2.2">superscript</csymbol><ci id="alg2.l9.m1.8.8.2.2.2.2.2.cmml" xref="alg2.l9.m1.8.8.2.2.2.2.2">𝐹</ci><ci id="alg2.l9.m1.8.8.2.2.2.2.3.cmml" xref="alg2.l9.m1.8.8.2.2.2.2.3">𝑙</ci></apply><apply id="alg2.l9.m1.9.9.3.3.3.3.cmml" xref="alg2.l9.m1.9.9.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l9.m1.9.9.3.3.3.3.1.cmml" xref="alg2.l9.m1.9.9.3.3.3.3">superscript</csymbol><ci id="alg2.l9.m1.9.9.3.3.3.3.2.cmml" xref="alg2.l9.m1.9.9.3.3.3.3.2">𝐹</ci><ci id="alg2.l9.m1.9.9.3.3.3.3.3.cmml" xref="alg2.l9.m1.9.9.3.3.3.3.3">𝑔</ci></apply></vector></apply><apply id="alg2.l9.m1.6.6.cmml" xref="alg2.l9.m1.6.6"><divide id="alg2.l9.m1.6.6.7.cmml" xref="alg2.l9.m1.6.6"></divide><apply id="alg2.l9.m1.3.3.3.cmml" xref="alg2.l9.m1.3.3.3"><times id="alg2.l9.m1.3.3.3.4.cmml" xref="alg2.l9.m1.3.3.3.4"></times><ci id="alg2.l9.m1.3.3.3.5.cmml" xref="alg2.l9.m1.3.3.3.5">𝜔</ci><vector id="alg2.l9.m1.3.3.3.3.4.cmml" xref="alg2.l9.m1.3.3.3.3.3"><apply id="alg2.l9.m1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1">subscript</csymbol><apply id="alg2.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.1.1.1.1">superscript</csymbol><ci id="alg2.l9.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.2.2">𝐺</ci><ci id="alg2.l9.m1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="alg2.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l9.m1.2.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.2.2">superscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2">𝐹</ci><ci id="alg2.l9.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.3">𝑙</ci></apply><apply id="alg2.l9.m1.3.3.3.3.3.3.cmml" xref="alg2.l9.m1.3.3.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l9.m1.3.3.3.3.3.3.1.cmml" xref="alg2.l9.m1.3.3.3.3.3.3">superscript</csymbol><ci id="alg2.l9.m1.3.3.3.3.3.3.2.cmml" xref="alg2.l9.m1.3.3.3.3.3.3.2">𝐹</ci><ci id="alg2.l9.m1.3.3.3.3.3.3.3.cmml" xref="alg2.l9.m1.3.3.3.3.3.3.3">𝑔</ci></apply></vector></apply><apply id="alg2.l9.m1.6.6.6.cmml" xref="alg2.l9.m1.6.6.6"><times id="alg2.l9.m1.6.6.6.4.cmml" xref="alg2.l9.m1.6.6.6.4"></times><apply id="alg2.l9.m1.6.6.6.5.cmml" xref="alg2.l9.m1.6.6.6.5"><ci id="alg2.l9.m1.6.6.6.5.1.cmml" xref="alg2.l9.m1.6.6.6.5.1">¯</ci><ci id="alg2.l9.m1.6.6.6.5.2.cmml" xref="alg2.l9.m1.6.6.6.5.2">𝜔</ci></apply><vector id="alg2.l9.m1.6.6.6.3.4.cmml" xref="alg2.l9.m1.6.6.6.3.3"><apply id="alg2.l9.m1.4.4.4.1.1.1.cmml" xref="alg2.l9.m1.4.4.4.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.4.4.4.1.1.1.1.cmml" xref="alg2.l9.m1.4.4.4.1.1.1">subscript</csymbol><apply id="alg2.l9.m1.4.4.4.1.1.1.2.cmml" xref="alg2.l9.m1.4.4.4.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.4.4.4.1.1.1.2.1.cmml" xref="alg2.l9.m1.4.4.4.1.1.1">superscript</csymbol><ci id="alg2.l9.m1.4.4.4.1.1.1.2.2.cmml" xref="alg2.l9.m1.4.4.4.1.1.1.2.2">𝐺</ci><ci id="alg2.l9.m1.4.4.4.1.1.1.2.3.cmml" xref="alg2.l9.m1.4.4.4.1.1.1.2.3">𝑙</ci></apply><ci id="alg2.l9.m1.4.4.4.1.1.1.3.cmml" xref="alg2.l9.m1.4.4.4.1.1.1.3">𝑖</ci></apply><apply id="alg2.l9.m1.5.5.5.2.2.2.cmml" xref="alg2.l9.m1.5.5.5.2.2.2"><csymbol cd="ambiguous" id="alg2.l9.m1.5.5.5.2.2.2.1.cmml" xref="alg2.l9.m1.5.5.5.2.2.2">superscript</csymbol><ci id="alg2.l9.m1.5.5.5.2.2.2.2.cmml" xref="alg2.l9.m1.5.5.5.2.2.2.2">𝐹</ci><ci id="alg2.l9.m1.5.5.5.2.2.2.3.cmml" xref="alg2.l9.m1.5.5.5.2.2.2.3">𝑙</ci></apply><apply id="alg2.l9.m1.6.6.6.3.3.3.cmml" xref="alg2.l9.m1.6.6.6.3.3.3"><csymbol cd="ambiguous" id="alg2.l9.m1.6.6.6.3.3.3.1.cmml" xref="alg2.l9.m1.6.6.6.3.3.3">superscript</csymbol><ci id="alg2.l9.m1.6.6.6.3.3.3.2.cmml" xref="alg2.l9.m1.6.6.6.3.3.3.2">𝐹</ci><ci id="alg2.l9.m1.6.6.6.3.3.3.3.cmml" xref="alg2.l9.m1.6.6.6.3.3.3.3">𝑔</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.9c">\omega(G^{l}_{i},F^{l},F^{g})\leftarrow\frac{\omega(G^{l}_{i},F^{l},F^{g})}{\bar{\omega}(G^{l}_{i},F^{l},F^{g})}</annotation></semantics></math> <span id="alg2.l9.2" class="ltx_text" style="float:right;"><math id="alg2.l9.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l9.1.m1.1a"><mo id="alg2.l9.1.m1.1.1" xref="alg2.l9.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l9.1.m1.1b"><ci id="alg2.l9.1.m1.1.1.cmml" xref="alg2.l9.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.1.m1.1c">\triangleright</annotation></semantics></math> Normalize <math id="alg2.l9.2.m2.1" class="ltx_Math" alttext="\omega_{(+)}" display="inline"><semantics id="alg2.l9.2.m2.1a"><msub id="alg2.l9.2.m2.1.2" xref="alg2.l9.2.m2.1.2.cmml"><mi id="alg2.l9.2.m2.1.2.2" xref="alg2.l9.2.m2.1.2.2.cmml">ω</mi><mrow id="alg2.l9.2.m2.1.1.1.3" xref="alg2.l9.2.m2.1.2.cmml"><mo stretchy="false" id="alg2.l9.2.m2.1.1.1.3.1" xref="alg2.l9.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg2.l9.2.m2.1.1.1.1" xref="alg2.l9.2.m2.1.1.1.1.cmml">+</mo><mo stretchy="false" id="alg2.l9.2.m2.1.1.1.3.2" xref="alg2.l9.2.m2.1.2.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l9.2.m2.1b"><apply id="alg2.l9.2.m2.1.2.cmml" xref="alg2.l9.2.m2.1.2"><csymbol cd="ambiguous" id="alg2.l9.2.m2.1.2.1.cmml" xref="alg2.l9.2.m2.1.2">subscript</csymbol><ci id="alg2.l9.2.m2.1.2.2.cmml" xref="alg2.l9.2.m2.1.2.2">𝜔</ci><plus id="alg2.l9.2.m2.1.1.1.1.cmml" xref="alg2.l9.2.m2.1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.2.m2.1c">\omega_{(+)}</annotation></semantics></math>
</span>
</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     Update <math id="alg2.l10.m1.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="alg2.l10.m1.1a"><msup id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><mi id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml">F</mi><mi id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1">superscript</csymbol><ci id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2">𝐹</ci><ci id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">F^{l}</annotation></semantics></math> by optimizing Eq. (<a href="#S4.E6" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) (or Eq.(<a href="#S4.E11" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>))

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.3.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <math id="alg2.l11.m1.4" class="ltx_Math" alttext="\bar{\omega}_{(+)}\leftarrow\beta\bar{\omega}_{(+)}+(1-\beta)\frac{1}{B}\sum_{i}{\omega_{(+)}}" display="inline"><semantics id="alg2.l11.m1.4a"><mrow id="alg2.l11.m1.4.4" xref="alg2.l11.m1.4.4.cmml"><msub id="alg2.l11.m1.4.4.3" xref="alg2.l11.m1.4.4.3.cmml"><mover accent="true" id="alg2.l11.m1.4.4.3.2" xref="alg2.l11.m1.4.4.3.2.cmml"><mi id="alg2.l11.m1.4.4.3.2.2" xref="alg2.l11.m1.4.4.3.2.2.cmml">ω</mi><mo id="alg2.l11.m1.4.4.3.2.1" xref="alg2.l11.m1.4.4.3.2.1.cmml">¯</mo></mover><mrow id="alg2.l11.m1.1.1.1.3" xref="alg2.l11.m1.4.4.3.cmml"><mo stretchy="false" id="alg2.l11.m1.1.1.1.3.1" xref="alg2.l11.m1.4.4.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg2.l11.m1.1.1.1.1" xref="alg2.l11.m1.1.1.1.1.cmml">+</mo><mo stretchy="false" id="alg2.l11.m1.1.1.1.3.2" xref="alg2.l11.m1.4.4.3.cmml">)</mo></mrow></msub><mo stretchy="false" id="alg2.l11.m1.4.4.2" xref="alg2.l11.m1.4.4.2.cmml">←</mo><mrow id="alg2.l11.m1.4.4.1" xref="alg2.l11.m1.4.4.1.cmml"><mrow id="alg2.l11.m1.4.4.1.3" xref="alg2.l11.m1.4.4.1.3.cmml"><mi id="alg2.l11.m1.4.4.1.3.2" xref="alg2.l11.m1.4.4.1.3.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m1.4.4.1.3.1" xref="alg2.l11.m1.4.4.1.3.1.cmml">​</mo><msub id="alg2.l11.m1.4.4.1.3.3" xref="alg2.l11.m1.4.4.1.3.3.cmml"><mover accent="true" id="alg2.l11.m1.4.4.1.3.3.2" xref="alg2.l11.m1.4.4.1.3.3.2.cmml"><mi id="alg2.l11.m1.4.4.1.3.3.2.2" xref="alg2.l11.m1.4.4.1.3.3.2.2.cmml">ω</mi><mo id="alg2.l11.m1.4.4.1.3.3.2.1" xref="alg2.l11.m1.4.4.1.3.3.2.1.cmml">¯</mo></mover><mrow id="alg2.l11.m1.2.2.1.3" xref="alg2.l11.m1.4.4.1.3.3.cmml"><mo stretchy="false" id="alg2.l11.m1.2.2.1.3.1" xref="alg2.l11.m1.4.4.1.3.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg2.l11.m1.2.2.1.1" xref="alg2.l11.m1.2.2.1.1.cmml">+</mo><mo stretchy="false" id="alg2.l11.m1.2.2.1.3.2" xref="alg2.l11.m1.4.4.1.3.3.cmml">)</mo></mrow></msub></mrow><mo id="alg2.l11.m1.4.4.1.2" xref="alg2.l11.m1.4.4.1.2.cmml">+</mo><mrow id="alg2.l11.m1.4.4.1.1" xref="alg2.l11.m1.4.4.1.1.cmml"><mrow id="alg2.l11.m1.4.4.1.1.1.1" xref="alg2.l11.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l11.m1.4.4.1.1.1.1.2" xref="alg2.l11.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l11.m1.4.4.1.1.1.1.1" xref="alg2.l11.m1.4.4.1.1.1.1.1.cmml"><mn id="alg2.l11.m1.4.4.1.1.1.1.1.2" xref="alg2.l11.m1.4.4.1.1.1.1.1.2.cmml">1</mn><mo id="alg2.l11.m1.4.4.1.1.1.1.1.1" xref="alg2.l11.m1.4.4.1.1.1.1.1.1.cmml">−</mo><mi id="alg2.l11.m1.4.4.1.1.1.1.1.3" xref="alg2.l11.m1.4.4.1.1.1.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="alg2.l11.m1.4.4.1.1.1.1.3" xref="alg2.l11.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg2.l11.m1.4.4.1.1.2" xref="alg2.l11.m1.4.4.1.1.2.cmml">​</mo><mfrac id="alg2.l11.m1.4.4.1.1.3" xref="alg2.l11.m1.4.4.1.1.3.cmml"><mn id="alg2.l11.m1.4.4.1.1.3.2" xref="alg2.l11.m1.4.4.1.1.3.2.cmml">1</mn><mi id="alg2.l11.m1.4.4.1.1.3.3" xref="alg2.l11.m1.4.4.1.1.3.3.cmml">B</mi></mfrac><mo lspace="0em" rspace="0em" id="alg2.l11.m1.4.4.1.1.2a" xref="alg2.l11.m1.4.4.1.1.2.cmml">​</mo><mrow id="alg2.l11.m1.4.4.1.1.4" xref="alg2.l11.m1.4.4.1.1.4.cmml"><msub id="alg2.l11.m1.4.4.1.1.4.1" xref="alg2.l11.m1.4.4.1.1.4.1.cmml"><mo id="alg2.l11.m1.4.4.1.1.4.1.2" xref="alg2.l11.m1.4.4.1.1.4.1.2.cmml">∑</mo><mi id="alg2.l11.m1.4.4.1.1.4.1.3" xref="alg2.l11.m1.4.4.1.1.4.1.3.cmml">i</mi></msub><msub id="alg2.l11.m1.4.4.1.1.4.2" xref="alg2.l11.m1.4.4.1.1.4.2.cmml"><mi id="alg2.l11.m1.4.4.1.1.4.2.2" xref="alg2.l11.m1.4.4.1.1.4.2.2.cmml">ω</mi><mrow id="alg2.l11.m1.3.3.1.3" xref="alg2.l11.m1.4.4.1.1.4.2.cmml"><mo stretchy="false" id="alg2.l11.m1.3.3.1.3.1" xref="alg2.l11.m1.4.4.1.1.4.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg2.l11.m1.3.3.1.1" xref="alg2.l11.m1.3.3.1.1.cmml">+</mo><mo stretchy="false" id="alg2.l11.m1.3.3.1.3.2" xref="alg2.l11.m1.4.4.1.1.4.2.cmml">)</mo></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.4b"><apply id="alg2.l11.m1.4.4.cmml" xref="alg2.l11.m1.4.4"><ci id="alg2.l11.m1.4.4.2.cmml" xref="alg2.l11.m1.4.4.2">←</ci><apply id="alg2.l11.m1.4.4.3.cmml" xref="alg2.l11.m1.4.4.3"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.3.1.cmml" xref="alg2.l11.m1.4.4.3">subscript</csymbol><apply id="alg2.l11.m1.4.4.3.2.cmml" xref="alg2.l11.m1.4.4.3.2"><ci id="alg2.l11.m1.4.4.3.2.1.cmml" xref="alg2.l11.m1.4.4.3.2.1">¯</ci><ci id="alg2.l11.m1.4.4.3.2.2.cmml" xref="alg2.l11.m1.4.4.3.2.2">𝜔</ci></apply><plus id="alg2.l11.m1.1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1.1"></plus></apply><apply id="alg2.l11.m1.4.4.1.cmml" xref="alg2.l11.m1.4.4.1"><plus id="alg2.l11.m1.4.4.1.2.cmml" xref="alg2.l11.m1.4.4.1.2"></plus><apply id="alg2.l11.m1.4.4.1.3.cmml" xref="alg2.l11.m1.4.4.1.3"><times id="alg2.l11.m1.4.4.1.3.1.cmml" xref="alg2.l11.m1.4.4.1.3.1"></times><ci id="alg2.l11.m1.4.4.1.3.2.cmml" xref="alg2.l11.m1.4.4.1.3.2">𝛽</ci><apply id="alg2.l11.m1.4.4.1.3.3.cmml" xref="alg2.l11.m1.4.4.1.3.3"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.1.3.3.1.cmml" xref="alg2.l11.m1.4.4.1.3.3">subscript</csymbol><apply id="alg2.l11.m1.4.4.1.3.3.2.cmml" xref="alg2.l11.m1.4.4.1.3.3.2"><ci id="alg2.l11.m1.4.4.1.3.3.2.1.cmml" xref="alg2.l11.m1.4.4.1.3.3.2.1">¯</ci><ci id="alg2.l11.m1.4.4.1.3.3.2.2.cmml" xref="alg2.l11.m1.4.4.1.3.3.2.2">𝜔</ci></apply><plus id="alg2.l11.m1.2.2.1.1.cmml" xref="alg2.l11.m1.2.2.1.1"></plus></apply></apply><apply id="alg2.l11.m1.4.4.1.1.cmml" xref="alg2.l11.m1.4.4.1.1"><times id="alg2.l11.m1.4.4.1.1.2.cmml" xref="alg2.l11.m1.4.4.1.1.2"></times><apply id="alg2.l11.m1.4.4.1.1.1.1.1.cmml" xref="alg2.l11.m1.4.4.1.1.1.1"><minus id="alg2.l11.m1.4.4.1.1.1.1.1.1.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.1.1"></minus><cn type="integer" id="alg2.l11.m1.4.4.1.1.1.1.1.2.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.1.2">1</cn><ci id="alg2.l11.m1.4.4.1.1.1.1.1.3.cmml" xref="alg2.l11.m1.4.4.1.1.1.1.1.3">𝛽</ci></apply><apply id="alg2.l11.m1.4.4.1.1.3.cmml" xref="alg2.l11.m1.4.4.1.1.3"><divide id="alg2.l11.m1.4.4.1.1.3.1.cmml" xref="alg2.l11.m1.4.4.1.1.3"></divide><cn type="integer" id="alg2.l11.m1.4.4.1.1.3.2.cmml" xref="alg2.l11.m1.4.4.1.1.3.2">1</cn><ci id="alg2.l11.m1.4.4.1.1.3.3.cmml" xref="alg2.l11.m1.4.4.1.1.3.3">𝐵</ci></apply><apply id="alg2.l11.m1.4.4.1.1.4.cmml" xref="alg2.l11.m1.4.4.1.1.4"><apply id="alg2.l11.m1.4.4.1.1.4.1.cmml" xref="alg2.l11.m1.4.4.1.1.4.1"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.1.1.4.1.1.cmml" xref="alg2.l11.m1.4.4.1.1.4.1">subscript</csymbol><sum id="alg2.l11.m1.4.4.1.1.4.1.2.cmml" xref="alg2.l11.m1.4.4.1.1.4.1.2"></sum><ci id="alg2.l11.m1.4.4.1.1.4.1.3.cmml" xref="alg2.l11.m1.4.4.1.1.4.1.3">𝑖</ci></apply><apply id="alg2.l11.m1.4.4.1.1.4.2.cmml" xref="alg2.l11.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="alg2.l11.m1.4.4.1.1.4.2.1.cmml" xref="alg2.l11.m1.4.4.1.1.4.2">subscript</csymbol><ci id="alg2.l11.m1.4.4.1.1.4.2.2.cmml" xref="alg2.l11.m1.4.4.1.1.4.2.2">𝜔</ci><plus id="alg2.l11.m1.3.3.1.1.cmml" xref="alg2.l11.m1.3.3.1.1"></plus></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.4c">\bar{\omega}_{(+)}\leftarrow\beta\bar{\omega}_{(+)}+(1-\beta)\frac{1}{B}\sum_{i}{\omega_{(+)}}</annotation></semantics></math> <span id="alg2.l11.2" class="ltx_text" style="float:right;"><math id="alg2.l11.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg2.l11.1.m1.1a"><mo id="alg2.l11.1.m1.1.1" xref="alg2.l11.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg2.l11.1.m1.1b"><ci id="alg2.l11.1.m1.1.1.cmml" xref="alg2.l11.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.1.m1.1c">\triangleright</annotation></semantics></math> Update moving average <math id="alg2.l11.2.m2.1" class="ltx_Math" alttext="\bar{\omega}_{(+)}" display="inline"><semantics id="alg2.l11.2.m2.1a"><msub id="alg2.l11.2.m2.1.2" xref="alg2.l11.2.m2.1.2.cmml"><mover accent="true" id="alg2.l11.2.m2.1.2.2" xref="alg2.l11.2.m2.1.2.2.cmml"><mi id="alg2.l11.2.m2.1.2.2.2" xref="alg2.l11.2.m2.1.2.2.2.cmml">ω</mi><mo id="alg2.l11.2.m2.1.2.2.1" xref="alg2.l11.2.m2.1.2.2.1.cmml">¯</mo></mover><mrow id="alg2.l11.2.m2.1.1.1.3" xref="alg2.l11.2.m2.1.2.cmml"><mo stretchy="false" id="alg2.l11.2.m2.1.1.1.3.1" xref="alg2.l11.2.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg2.l11.2.m2.1.1.1.1" xref="alg2.l11.2.m2.1.1.1.1.cmml">+</mo><mo stretchy="false" id="alg2.l11.2.m2.1.1.1.3.2" xref="alg2.l11.2.m2.1.2.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="alg2.l11.2.m2.1b"><apply id="alg2.l11.2.m2.1.2.cmml" xref="alg2.l11.2.m2.1.2"><csymbol cd="ambiguous" id="alg2.l11.2.m2.1.2.1.cmml" xref="alg2.l11.2.m2.1.2">subscript</csymbol><apply id="alg2.l11.2.m2.1.2.2.cmml" xref="alg2.l11.2.m2.1.2.2"><ci id="alg2.l11.2.m2.1.2.2.1.cmml" xref="alg2.l11.2.m2.1.2.2.1">¯</ci><ci id="alg2.l11.2.m2.1.2.2.2.cmml" xref="alg2.l11.2.m2.1.2.2.2">𝜔</ci></apply><plus id="alg2.l11.2.m2.1.1.1.1.cmml" xref="alg2.l11.2.m2.1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.2.m2.1c">\bar{\omega}_{(+)}</annotation></semantics></math>
</span>
</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span><span id="alg2.l12.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l12.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>Client sends updated model <math id="alg2.l13.m1.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="alg2.l13.m1.1a"><msup id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><mi id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml">F</mi><mi id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1">superscript</csymbol><ci id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2">𝐹</ci><ci id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">F^{l}</annotation></semantics></math> to Server

</div>
</div>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Federated Learning by Instance Reweighting</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.2" class="ltx_p">By jointly using the local model <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><msup id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml"><mi id="S4.SS1.p1.1.m1.1.1.2" xref="S4.SS1.p1.1.m1.1.1.2.cmml">F</mi><mi id="S4.SS1.p1.1.m1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><apply id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">superscript</csymbol><ci id="S4.SS1.p1.1.m1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.2">𝐹</ci><ci id="S4.SS1.p1.1.m1.1.1.3.cmml" xref="S4.SS1.p1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">F^{l}</annotation></semantics></math> and global model <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msup id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">F</mi><mi id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">𝐹</ci><ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">F^{g}</annotation></semantics></math>, FLIT reweights training samples to align the biased local data distribution to the global one. Eventually, the local models across clients will be well-aligned for better performance.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.3" class="ltx_p">Given a molecule <math id="S4.SS1.p2.1.m1.2" class="ltx_Math" alttext="x^{l}=(g^{l},y^{l})" display="inline"><semantics id="S4.SS1.p2.1.m1.2a"><mrow id="S4.SS1.p2.1.m1.2.2" xref="S4.SS1.p2.1.m1.2.2.cmml"><msup id="S4.SS1.p2.1.m1.2.2.4" xref="S4.SS1.p2.1.m1.2.2.4.cmml"><mi id="S4.SS1.p2.1.m1.2.2.4.2" xref="S4.SS1.p2.1.m1.2.2.4.2.cmml">x</mi><mi id="S4.SS1.p2.1.m1.2.2.4.3" xref="S4.SS1.p2.1.m1.2.2.4.3.cmml">l</mi></msup><mo id="S4.SS1.p2.1.m1.2.2.3" xref="S4.SS1.p2.1.m1.2.2.3.cmml">=</mo><mrow id="S4.SS1.p2.1.m1.2.2.2.2" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.2.2.2.2.3" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml">(</mo><msup id="S4.SS1.p2.1.m1.1.1.1.1.1" xref="S4.SS1.p2.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.1.m1.1.1.1.1.1.2" xref="S4.SS1.p2.1.m1.1.1.1.1.1.2.cmml">g</mi><mi id="S4.SS1.p2.1.m1.1.1.1.1.1.3" xref="S4.SS1.p2.1.m1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.SS1.p2.1.m1.2.2.2.2.4" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml">,</mo><msup id="S4.SS1.p2.1.m1.2.2.2.2.2" xref="S4.SS1.p2.1.m1.2.2.2.2.2.cmml"><mi id="S4.SS1.p2.1.m1.2.2.2.2.2.2" xref="S4.SS1.p2.1.m1.2.2.2.2.2.2.cmml">y</mi><mi id="S4.SS1.p2.1.m1.2.2.2.2.2.3" xref="S4.SS1.p2.1.m1.2.2.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="S4.SS1.p2.1.m1.2.2.2.2.5" xref="S4.SS1.p2.1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.2b"><apply id="S4.SS1.p2.1.m1.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2"><eq id="S4.SS1.p2.1.m1.2.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.3"></eq><apply id="S4.SS1.p2.1.m1.2.2.4.cmml" xref="S4.SS1.p2.1.m1.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.2.4.1.cmml" xref="S4.SS1.p2.1.m1.2.2.4">superscript</csymbol><ci id="S4.SS1.p2.1.m1.2.2.4.2.cmml" xref="S4.SS1.p2.1.m1.2.2.4.2">𝑥</ci><ci id="S4.SS1.p2.1.m1.2.2.4.3.cmml" xref="S4.SS1.p2.1.m1.2.2.4.3">𝑙</ci></apply><interval closure="open" id="S4.SS1.p2.1.m1.2.2.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2"><apply id="S4.SS1.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.2">𝑔</ci><ci id="S4.SS1.p2.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.1.m1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S4.SS1.p2.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.1.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2.2">superscript</csymbol><ci id="S4.SS1.p2.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2.2.2">𝑦</ci><ci id="S4.SS1.p2.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.p2.1.m1.2.2.2.2.2.3">𝑙</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.2c">x^{l}=(g^{l},y^{l})</annotation></semantics></math> sampled from the dataset of the <math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m2.1b"><ci id="S4.SS1.p2.2.m2.1.1.cmml" xref="S4.SS1.p2.2.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m2.1c">l</annotation></semantics></math>-th client <math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="X^{l}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><msup id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.2" xref="S4.SS1.p2.3.m3.1.1.2.cmml">X</mi><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m3.1b"><apply id="S4.SS1.p2.3.m3.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.3.m3.1.1.1.cmml" xref="S4.SS1.p2.3.m3.1.1">superscript</csymbol><ci id="S4.SS1.p2.3.m3.1.1.2.cmml" xref="S4.SS1.p2.3.m3.1.1.2">𝑋</ci><ci id="S4.SS1.p2.3.m3.1.1.3.cmml" xref="S4.SS1.p2.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m3.1c">X^{l}</annotation></semantics></math>, the original focal loss for binary classification tasks is defined as <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite></p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E4.m1.2" class="ltx_Math" alttext="\mathcal{L}_{focal}{(x^{l})}=-(1-{\hat{y}}_{t}^{l})^{\gamma}\log({\hat{y}}_{t}^{l})," display="block"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.2.1" xref="S4.E4.m1.2.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1" xref="S4.E4.m1.2.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1.1" xref="S4.E4.m1.2.2.1.1.1.cmml"><msub id="S4.E4.m1.2.2.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.2.2.1.1.1.3.2" xref="S4.E4.m1.2.2.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E4.m1.2.2.1.1.1.3.3" xref="S4.E4.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.E4.m1.2.2.1.1.1.3.3.2" xref="S4.E4.m1.2.2.1.1.1.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.1.1.1.3.3.1" xref="S4.E4.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.2.2.1.1.1.3.3.3" xref="S4.E4.m1.2.2.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.1.1.1.3.3.1a" xref="S4.E4.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.2.2.1.1.1.3.3.4" xref="S4.E4.m1.2.2.1.1.1.3.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.1.1.1.3.3.1b" xref="S4.E4.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.2.2.1.1.1.3.3.5" xref="S4.E4.m1.2.2.1.1.1.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.1.1.1.3.3.1c" xref="S4.E4.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E4.m1.2.2.1.1.1.3.3.6" xref="S4.E4.m1.2.2.1.1.1.3.3.6.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.2.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m1.2.2.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E4.m1.2.2.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E4.m1.2.2.1.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E4.m1.2.2.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.2.2.1.1.4" xref="S4.E4.m1.2.2.1.1.4.cmml">=</mo><mrow id="S4.E4.m1.2.2.1.1.3" xref="S4.E4.m1.2.2.1.1.3.cmml"><mo id="S4.E4.m1.2.2.1.1.3a" xref="S4.E4.m1.2.2.1.1.3.cmml">−</mo><mrow id="S4.E4.m1.2.2.1.1.3.2" xref="S4.E4.m1.2.2.1.1.3.2.cmml"><msup id="S4.E4.m1.2.2.1.1.2.1.1" xref="S4.E4.m1.2.2.1.1.2.1.1.cmml"><mrow id="S4.E4.m1.2.2.1.1.2.1.1.1.1" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.cmml"><mn id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.2" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.cmml">−</mo><msubsup id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.cmml"><mi id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.2" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.2.cmml">y</mi><mo id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.1" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.3" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.3.cmml">t</mi><mi id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.3" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.3.cmml">l</mi></msubsup></mrow><mo stretchy="false" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.3" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.cmml">)</mo></mrow><mi id="S4.E4.m1.2.2.1.1.2.1.1.3" xref="S4.E4.m1.2.2.1.1.2.1.1.3.cmml">γ</mi></msup><mo lspace="0.167em" rspace="0em" id="S4.E4.m1.2.2.1.1.3.2.3" xref="S4.E4.m1.2.2.1.1.3.2.3.cmml">​</mo><mrow id="S4.E4.m1.2.2.1.1.3.2.2.1" xref="S4.E4.m1.2.2.1.1.3.2.2.2.cmml"><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">log</mi><mo id="S4.E4.m1.2.2.1.1.3.2.2.1a" xref="S4.E4.m1.2.2.1.1.3.2.2.2.cmml">⁡</mo><mrow id="S4.E4.m1.2.2.1.1.3.2.2.1.1" xref="S4.E4.m1.2.2.1.1.3.2.2.2.cmml"><mo stretchy="false" id="S4.E4.m1.2.2.1.1.3.2.2.1.1.2" xref="S4.E4.m1.2.2.1.1.3.2.2.2.cmml">(</mo><msubsup id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.cmml"><mover accent="true" id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2.cmml"><mi id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2.2" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2.2.cmml">y</mi><mo id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2.1" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.3" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.3.cmml">t</mi><mi id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.3" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.3.cmml">l</mi></msubsup><mo stretchy="false" id="S4.E4.m1.2.2.1.1.3.2.2.1.1.3" xref="S4.E4.m1.2.2.1.1.3.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E4.m1.2.2.1.2" xref="S4.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.2.1.1.cmml" xref="S4.E4.m1.2.2.1"><eq id="S4.E4.m1.2.2.1.1.4.cmml" xref="S4.E4.m1.2.2.1.1.4"></eq><apply id="S4.E4.m1.2.2.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1"><times id="S4.E4.m1.2.2.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.2"></times><apply id="S4.E4.m1.2.2.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.2.2.1.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.1.3.2">ℒ</ci><apply id="S4.E4.m1.2.2.1.1.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.1.3.3"><times id="S4.E4.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.E4.m1.2.2.1.1.1.3.3.1"></times><ci id="S4.E4.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.E4.m1.2.2.1.1.1.3.3.2">𝑓</ci><ci id="S4.E4.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.E4.m1.2.2.1.1.1.3.3.3">𝑜</ci><ci id="S4.E4.m1.2.2.1.1.1.3.3.4.cmml" xref="S4.E4.m1.2.2.1.1.1.3.3.4">𝑐</ci><ci id="S4.E4.m1.2.2.1.1.1.3.3.5.cmml" xref="S4.E4.m1.2.2.1.1.1.3.3.5">𝑎</ci><ci id="S4.E4.m1.2.2.1.1.1.3.3.6.cmml" xref="S4.E4.m1.2.2.1.1.1.3.3.6">𝑙</ci></apply></apply><apply id="S4.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.E4.m1.2.2.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.3"><minus id="S4.E4.m1.2.2.1.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.3"></minus><apply id="S4.E4.m1.2.2.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.3.2"><times id="S4.E4.m1.2.2.1.1.3.2.3.cmml" xref="S4.E4.m1.2.2.1.1.3.2.3"></times><apply id="S4.E4.m1.2.2.1.1.2.1.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.2.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1">superscript</csymbol><apply id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1"><minus id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.2">1</cn><apply id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2"><ci id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.1">^</ci><ci id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.2.2">𝑦</ci></apply><ci id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.1.1.1.3.3">𝑙</ci></apply></apply><ci id="S4.E4.m1.2.2.1.1.2.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.2.1.1.3">𝛾</ci></apply><apply id="S4.E4.m1.2.2.1.1.3.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2.1"><log id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"></log><apply id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.1.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1">superscript</csymbol><apply id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.1.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1">subscript</csymbol><apply id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2"><ci id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2.1.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2.1">^</ci><ci id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2.2.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.2.2">𝑦</ci></apply><ci id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.3.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.2.3">𝑡</ci></apply><ci id="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.3.cmml" xref="S4.E4.m1.2.2.1.1.3.2.2.1.1.1.3">𝑙</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">\mathcal{L}_{focal}{(x^{l})}=-(1-{\hat{y}}_{t}^{l})^{\gamma}\log({\hat{y}}_{t}^{l}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.5" class="ltx_p">where <math id="S4.SS1.p2.4.m1.1" class="ltx_Math" alttext="\hat{y}_{t}^{l}" display="inline"><semantics id="S4.SS1.p2.4.m1.1a"><msubsup id="S4.SS1.p2.4.m1.1.1" xref="S4.SS1.p2.4.m1.1.1.cmml"><mover accent="true" id="S4.SS1.p2.4.m1.1.1.2.2" xref="S4.SS1.p2.4.m1.1.1.2.2.cmml"><mi id="S4.SS1.p2.4.m1.1.1.2.2.2" xref="S4.SS1.p2.4.m1.1.1.2.2.2.cmml">y</mi><mo id="S4.SS1.p2.4.m1.1.1.2.2.1" xref="S4.SS1.p2.4.m1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS1.p2.4.m1.1.1.2.3" xref="S4.SS1.p2.4.m1.1.1.2.3.cmml">t</mi><mi id="S4.SS1.p2.4.m1.1.1.3" xref="S4.SS1.p2.4.m1.1.1.3.cmml">l</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m1.1b"><apply id="S4.SS1.p2.4.m1.1.1.cmml" xref="S4.SS1.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m1.1.1.1.cmml" xref="S4.SS1.p2.4.m1.1.1">superscript</csymbol><apply id="S4.SS1.p2.4.m1.1.1.2.cmml" xref="S4.SS1.p2.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.4.m1.1.1.2.1.cmml" xref="S4.SS1.p2.4.m1.1.1">subscript</csymbol><apply id="S4.SS1.p2.4.m1.1.1.2.2.cmml" xref="S4.SS1.p2.4.m1.1.1.2.2"><ci id="S4.SS1.p2.4.m1.1.1.2.2.1.cmml" xref="S4.SS1.p2.4.m1.1.1.2.2.1">^</ci><ci id="S4.SS1.p2.4.m1.1.1.2.2.2.cmml" xref="S4.SS1.p2.4.m1.1.1.2.2.2">𝑦</ci></apply><ci id="S4.SS1.p2.4.m1.1.1.2.3.cmml" xref="S4.SS1.p2.4.m1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS1.p2.4.m1.1.1.3.cmml" xref="S4.SS1.p2.4.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m1.1c">\hat{y}_{t}^{l}</annotation></semantics></math> is defined based on the prediction of molecule <math id="S4.SS1.p2.5.m2.1" class="ltx_Math" alttext="\hat{y}^{l}=F^{l}(g^{l})" display="inline"><semantics id="S4.SS1.p2.5.m2.1a"><mrow id="S4.SS1.p2.5.m2.1.1" xref="S4.SS1.p2.5.m2.1.1.cmml"><msup id="S4.SS1.p2.5.m2.1.1.3" xref="S4.SS1.p2.5.m2.1.1.3.cmml"><mover accent="true" id="S4.SS1.p2.5.m2.1.1.3.2" xref="S4.SS1.p2.5.m2.1.1.3.2.cmml"><mi id="S4.SS1.p2.5.m2.1.1.3.2.2" xref="S4.SS1.p2.5.m2.1.1.3.2.2.cmml">y</mi><mo id="S4.SS1.p2.5.m2.1.1.3.2.1" xref="S4.SS1.p2.5.m2.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.SS1.p2.5.m2.1.1.3.3" xref="S4.SS1.p2.5.m2.1.1.3.3.cmml">l</mi></msup><mo id="S4.SS1.p2.5.m2.1.1.2" xref="S4.SS1.p2.5.m2.1.1.2.cmml">=</mo><mrow id="S4.SS1.p2.5.m2.1.1.1" xref="S4.SS1.p2.5.m2.1.1.1.cmml"><msup id="S4.SS1.p2.5.m2.1.1.1.3" xref="S4.SS1.p2.5.m2.1.1.1.3.cmml"><mi id="S4.SS1.p2.5.m2.1.1.1.3.2" xref="S4.SS1.p2.5.m2.1.1.1.3.2.cmml">F</mi><mi id="S4.SS1.p2.5.m2.1.1.1.3.3" xref="S4.SS1.p2.5.m2.1.1.1.3.3.cmml">l</mi></msup><mo lspace="0em" rspace="0em" id="S4.SS1.p2.5.m2.1.1.1.2" xref="S4.SS1.p2.5.m2.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.p2.5.m2.1.1.1.1.1" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.5.m2.1.1.1.1.1.2" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS1.p2.5.m2.1.1.1.1.1.1" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.5.m2.1.1.1.1.1.1.2" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.2.cmml">g</mi><mi id="S4.SS1.p2.5.m2.1.1.1.1.1.1.3" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S4.SS1.p2.5.m2.1.1.1.1.1.3" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m2.1b"><apply id="S4.SS1.p2.5.m2.1.1.cmml" xref="S4.SS1.p2.5.m2.1.1"><eq id="S4.SS1.p2.5.m2.1.1.2.cmml" xref="S4.SS1.p2.5.m2.1.1.2"></eq><apply id="S4.SS1.p2.5.m2.1.1.3.cmml" xref="S4.SS1.p2.5.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m2.1.1.3.1.cmml" xref="S4.SS1.p2.5.m2.1.1.3">superscript</csymbol><apply id="S4.SS1.p2.5.m2.1.1.3.2.cmml" xref="S4.SS1.p2.5.m2.1.1.3.2"><ci id="S4.SS1.p2.5.m2.1.1.3.2.1.cmml" xref="S4.SS1.p2.5.m2.1.1.3.2.1">^</ci><ci id="S4.SS1.p2.5.m2.1.1.3.2.2.cmml" xref="S4.SS1.p2.5.m2.1.1.3.2.2">𝑦</ci></apply><ci id="S4.SS1.p2.5.m2.1.1.3.3.cmml" xref="S4.SS1.p2.5.m2.1.1.3.3">𝑙</ci></apply><apply id="S4.SS1.p2.5.m2.1.1.1.cmml" xref="S4.SS1.p2.5.m2.1.1.1"><times id="S4.SS1.p2.5.m2.1.1.1.2.cmml" xref="S4.SS1.p2.5.m2.1.1.1.2"></times><apply id="S4.SS1.p2.5.m2.1.1.1.3.cmml" xref="S4.SS1.p2.5.m2.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m2.1.1.1.3.1.cmml" xref="S4.SS1.p2.5.m2.1.1.1.3">superscript</csymbol><ci id="S4.SS1.p2.5.m2.1.1.1.3.2.cmml" xref="S4.SS1.p2.5.m2.1.1.1.3.2">𝐹</ci><ci id="S4.SS1.p2.5.m2.1.1.1.3.3.cmml" xref="S4.SS1.p2.5.m2.1.1.1.3.3">𝑙</ci></apply><apply id="S4.SS1.p2.5.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.5.m2.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p2.5.m2.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.2">𝑔</ci><ci id="S4.SS1.p2.5.m2.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.5.m2.1.1.1.1.1.1.3">𝑙</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m2.1c">\hat{y}^{l}=F^{l}(g^{l})</annotation></semantics></math> as</p>
<table id="S4.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.Ex1.m1.4" class="ltx_Math" alttext="\hat{y}_{t}^{l}=\begin{cases}\hat{y}^{l}&amp;\text{if $y^{l}=1$}\\
1-\hat{y}^{l}&amp;\text{otherwise}.\end{cases}" display="block"><semantics id="S4.Ex1.m1.4a"><mrow id="S4.Ex1.m1.4.5" xref="S4.Ex1.m1.4.5.cmml"><msubsup id="S4.Ex1.m1.4.5.2" xref="S4.Ex1.m1.4.5.2.cmml"><mover accent="true" id="S4.Ex1.m1.4.5.2.2.2" xref="S4.Ex1.m1.4.5.2.2.2.cmml"><mi id="S4.Ex1.m1.4.5.2.2.2.2" xref="S4.Ex1.m1.4.5.2.2.2.2.cmml">y</mi><mo id="S4.Ex1.m1.4.5.2.2.2.1" xref="S4.Ex1.m1.4.5.2.2.2.1.cmml">^</mo></mover><mi id="S4.Ex1.m1.4.5.2.2.3" xref="S4.Ex1.m1.4.5.2.2.3.cmml">t</mi><mi id="S4.Ex1.m1.4.5.2.3" xref="S4.Ex1.m1.4.5.2.3.cmml">l</mi></msubsup><mo id="S4.Ex1.m1.4.5.1" xref="S4.Ex1.m1.4.5.1.cmml">=</mo><mrow id="S4.Ex1.m1.4.4" xref="S4.Ex1.m1.4.5.3.1.cmml"><mo id="S4.Ex1.m1.4.4.5" xref="S4.Ex1.m1.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.Ex1.m1.4.4.4" xref="S4.Ex1.m1.4.5.3.1.cmml"><mtr id="S4.Ex1.m1.4.4.4a" xref="S4.Ex1.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.Ex1.m1.4.4.4b" xref="S4.Ex1.m1.4.5.3.1.cmml"><msup id="S4.Ex1.m1.2.2.2.2.2.1" xref="S4.Ex1.m1.2.2.2.2.2.1.cmml"><mover accent="true" id="S4.Ex1.m1.2.2.2.2.2.1.2" xref="S4.Ex1.m1.2.2.2.2.2.1.2.cmml"><mi id="S4.Ex1.m1.2.2.2.2.2.1.2.2" xref="S4.Ex1.m1.2.2.2.2.2.1.2.2.cmml">y</mi><mo id="S4.Ex1.m1.2.2.2.2.2.1.2.1" xref="S4.Ex1.m1.2.2.2.2.2.1.2.1.cmml">^</mo></mover><mi id="S4.Ex1.m1.2.2.2.2.2.1.3" xref="S4.Ex1.m1.2.2.2.2.2.1.3.cmml">l</mi></msup></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.Ex1.m1.4.4.4c" xref="S4.Ex1.m1.4.5.3.1.cmml"><mrow id="S4.Ex1.m1.1.1.1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1b.cmml"><mtext id="S4.Ex1.m1.1.1.1.1.1.1a" xref="S4.Ex1.m1.1.1.1.1.1.1b.cmml">if </mtext><mrow id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><msup id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml"><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.2" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml">y</mi><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.3" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml">l</mi></msup><mo id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.1" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">1</mn></mrow></mrow></mtd></mtr><mtr id="S4.Ex1.m1.4.4.4d" xref="S4.Ex1.m1.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.Ex1.m1.4.4.4e" xref="S4.Ex1.m1.4.5.3.1.cmml"><mrow id="S4.Ex1.m1.3.3.3.3.1.1" xref="S4.Ex1.m1.3.3.3.3.1.1.cmml"><mn id="S4.Ex1.m1.3.3.3.3.1.1.2" xref="S4.Ex1.m1.3.3.3.3.1.1.2.cmml">1</mn><mo id="S4.Ex1.m1.3.3.3.3.1.1.1" xref="S4.Ex1.m1.3.3.3.3.1.1.1.cmml">−</mo><msup id="S4.Ex1.m1.3.3.3.3.1.1.3" xref="S4.Ex1.m1.3.3.3.3.1.1.3.cmml"><mover accent="true" id="S4.Ex1.m1.3.3.3.3.1.1.3.2" xref="S4.Ex1.m1.3.3.3.3.1.1.3.2.cmml"><mi id="S4.Ex1.m1.3.3.3.3.1.1.3.2.2" xref="S4.Ex1.m1.3.3.3.3.1.1.3.2.2.cmml">y</mi><mo id="S4.Ex1.m1.3.3.3.3.1.1.3.2.1" xref="S4.Ex1.m1.3.3.3.3.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.Ex1.m1.3.3.3.3.1.1.3.3" xref="S4.Ex1.m1.3.3.3.3.1.1.3.3.cmml">l</mi></msup></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.Ex1.m1.4.4.4f" xref="S4.Ex1.m1.4.5.3.1.cmml"><mrow id="S4.Ex1.m1.4.4.4.4.2.1.3" xref="S4.Ex1.m1.4.4.4.4.2.1.1a.cmml"><mtext id="S4.Ex1.m1.4.4.4.4.2.1.1" xref="S4.Ex1.m1.4.4.4.4.2.1.1.cmml">otherwise</mtext><mo lspace="0em" id="S4.Ex1.m1.4.4.4.4.2.1.3.1" xref="S4.Ex1.m1.4.4.4.4.2.1.1a.cmml">.</mo></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.Ex1.m1.4b"><apply id="S4.Ex1.m1.4.5.cmml" xref="S4.Ex1.m1.4.5"><eq id="S4.Ex1.m1.4.5.1.cmml" xref="S4.Ex1.m1.4.5.1"></eq><apply id="S4.Ex1.m1.4.5.2.cmml" xref="S4.Ex1.m1.4.5.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.5.2.1.cmml" xref="S4.Ex1.m1.4.5.2">superscript</csymbol><apply id="S4.Ex1.m1.4.5.2.2.cmml" xref="S4.Ex1.m1.4.5.2"><csymbol cd="ambiguous" id="S4.Ex1.m1.4.5.2.2.1.cmml" xref="S4.Ex1.m1.4.5.2">subscript</csymbol><apply id="S4.Ex1.m1.4.5.2.2.2.cmml" xref="S4.Ex1.m1.4.5.2.2.2"><ci id="S4.Ex1.m1.4.5.2.2.2.1.cmml" xref="S4.Ex1.m1.4.5.2.2.2.1">^</ci><ci id="S4.Ex1.m1.4.5.2.2.2.2.cmml" xref="S4.Ex1.m1.4.5.2.2.2.2">𝑦</ci></apply><ci id="S4.Ex1.m1.4.5.2.2.3.cmml" xref="S4.Ex1.m1.4.5.2.2.3">𝑡</ci></apply><ci id="S4.Ex1.m1.4.5.2.3.cmml" xref="S4.Ex1.m1.4.5.2.3">𝑙</ci></apply><apply id="S4.Ex1.m1.4.5.3.1.cmml" xref="S4.Ex1.m1.4.4"><csymbol cd="latexml" id="S4.Ex1.m1.4.5.3.1.1.cmml" xref="S4.Ex1.m1.4.4.5">cases</csymbol><apply id="S4.Ex1.m1.2.2.2.2.2.1.cmml" xref="S4.Ex1.m1.2.2.2.2.2.1"><csymbol cd="ambiguous" id="S4.Ex1.m1.2.2.2.2.2.1.1.cmml" xref="S4.Ex1.m1.2.2.2.2.2.1">superscript</csymbol><apply id="S4.Ex1.m1.2.2.2.2.2.1.2.cmml" xref="S4.Ex1.m1.2.2.2.2.2.1.2"><ci id="S4.Ex1.m1.2.2.2.2.2.1.2.1.cmml" xref="S4.Ex1.m1.2.2.2.2.2.1.2.1">^</ci><ci id="S4.Ex1.m1.2.2.2.2.2.1.2.2.cmml" xref="S4.Ex1.m1.2.2.2.2.2.1.2.2">𝑦</ci></apply><ci id="S4.Ex1.m1.2.2.2.2.2.1.3.cmml" xref="S4.Ex1.m1.2.2.2.2.2.1.3">𝑙</ci></apply><ci id="S4.Ex1.m1.1.1.1.1.1.1b.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1"><mrow id="S4.Ex1.m1.1.1.1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1"><mtext id="S4.Ex1.m1.1.1.1.1.1.1a.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1">if </mtext><mrow id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1"><msup id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2"><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.2">y</mi><mi id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.2.3">l</mi></msup><mo id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.1">=</mo><mn id="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S4.Ex1.m1.1.1.1.1.1.1.1.1.m1.1.1.3">1</mn></mrow></mrow></ci><apply id="S4.Ex1.m1.3.3.3.3.1.1.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1"><minus id="S4.Ex1.m1.3.3.3.3.1.1.1.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1.1"></minus><cn type="integer" id="S4.Ex1.m1.3.3.3.3.1.1.2.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1.2">1</cn><apply id="S4.Ex1.m1.3.3.3.3.1.1.3.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.Ex1.m1.3.3.3.3.1.1.3.1.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1.3">superscript</csymbol><apply id="S4.Ex1.m1.3.3.3.3.1.1.3.2.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1.3.2"><ci id="S4.Ex1.m1.3.3.3.3.1.1.3.2.1.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1.3.2.1">^</ci><ci id="S4.Ex1.m1.3.3.3.3.1.1.3.2.2.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1.3.2.2">𝑦</ci></apply><ci id="S4.Ex1.m1.3.3.3.3.1.1.3.3.cmml" xref="S4.Ex1.m1.3.3.3.3.1.1.3.3">𝑙</ci></apply></apply><ci id="S4.Ex1.m1.4.4.4.4.2.1.1a.cmml" xref="S4.Ex1.m1.4.4.4.4.2.1.3"><mtext id="S4.Ex1.m1.4.4.4.4.2.1.1.cmml" xref="S4.Ex1.m1.4.4.4.4.2.1.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.Ex1.m1.4c">\hat{y}_{t}^{l}=\begin{cases}\hat{y}^{l}&amp;\text{if $y^{l}=1$}\\
1-\hat{y}^{l}&amp;\text{otherwise}.\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.6" class="ltx_p">By substituting the binary cross entropy loss <math id="S4.SS1.p2.6.m1.4" class="ltx_Math" alttext="\mathcal{L}(\hat{y}^{l},y^{l})=-\log(\hat{y}_{t}^{l})" display="inline"><semantics id="S4.SS1.p2.6.m1.4a"><mrow id="S4.SS1.p2.6.m1.4.4" xref="S4.SS1.p2.6.m1.4.4.cmml"><mrow id="S4.SS1.p2.6.m1.3.3.2" xref="S4.SS1.p2.6.m1.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.6.m1.3.3.2.4" xref="S4.SS1.p2.6.m1.3.3.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.6.m1.3.3.2.3" xref="S4.SS1.p2.6.m1.3.3.2.3.cmml">​</mo><mrow id="S4.SS1.p2.6.m1.3.3.2.2.2" xref="S4.SS1.p2.6.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p2.6.m1.3.3.2.2.2.3" xref="S4.SS1.p2.6.m1.3.3.2.2.3.cmml">(</mo><msup id="S4.SS1.p2.6.m1.2.2.1.1.1.1" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.cmml"><mover accent="true" id="S4.SS1.p2.6.m1.2.2.1.1.1.1.2" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.2.cmml"><mi id="S4.SS1.p2.6.m1.2.2.1.1.1.1.2.2" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.2.2.cmml">y</mi><mo id="S4.SS1.p2.6.m1.2.2.1.1.1.1.2.1" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p2.6.m1.2.2.1.1.1.1.3" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.SS1.p2.6.m1.3.3.2.2.2.4" xref="S4.SS1.p2.6.m1.3.3.2.2.3.cmml">,</mo><msup id="S4.SS1.p2.6.m1.3.3.2.2.2.2" xref="S4.SS1.p2.6.m1.3.3.2.2.2.2.cmml"><mi id="S4.SS1.p2.6.m1.3.3.2.2.2.2.2" xref="S4.SS1.p2.6.m1.3.3.2.2.2.2.2.cmml">y</mi><mi id="S4.SS1.p2.6.m1.3.3.2.2.2.2.3" xref="S4.SS1.p2.6.m1.3.3.2.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="S4.SS1.p2.6.m1.3.3.2.2.2.5" xref="S4.SS1.p2.6.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p2.6.m1.4.4.4" xref="S4.SS1.p2.6.m1.4.4.4.cmml">=</mo><mrow id="S4.SS1.p2.6.m1.4.4.3" xref="S4.SS1.p2.6.m1.4.4.3.cmml"><mo rspace="0.167em" id="S4.SS1.p2.6.m1.4.4.3a" xref="S4.SS1.p2.6.m1.4.4.3.cmml">−</mo><mrow id="S4.SS1.p2.6.m1.4.4.3.1.1" xref="S4.SS1.p2.6.m1.4.4.3.1.2.cmml"><mi id="S4.SS1.p2.6.m1.1.1" xref="S4.SS1.p2.6.m1.1.1.cmml">log</mi><mo id="S4.SS1.p2.6.m1.4.4.3.1.1a" xref="S4.SS1.p2.6.m1.4.4.3.1.2.cmml">⁡</mo><mrow id="S4.SS1.p2.6.m1.4.4.3.1.1.1" xref="S4.SS1.p2.6.m1.4.4.3.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.6.m1.4.4.3.1.1.1.2" xref="S4.SS1.p2.6.m1.4.4.3.1.2.cmml">(</mo><msubsup id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.cmml"><mover accent="true" id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2.cmml"><mi id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2.2" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2.2.cmml">y</mi><mo id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2.1" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.3" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.3.cmml">t</mi><mi id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.3" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.3.cmml">l</mi></msubsup><mo stretchy="false" id="S4.SS1.p2.6.m1.4.4.3.1.1.1.3" xref="S4.SS1.p2.6.m1.4.4.3.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m1.4b"><apply id="S4.SS1.p2.6.m1.4.4.cmml" xref="S4.SS1.p2.6.m1.4.4"><eq id="S4.SS1.p2.6.m1.4.4.4.cmml" xref="S4.SS1.p2.6.m1.4.4.4"></eq><apply id="S4.SS1.p2.6.m1.3.3.2.cmml" xref="S4.SS1.p2.6.m1.3.3.2"><times id="S4.SS1.p2.6.m1.3.3.2.3.cmml" xref="S4.SS1.p2.6.m1.3.3.2.3"></times><ci id="S4.SS1.p2.6.m1.3.3.2.4.cmml" xref="S4.SS1.p2.6.m1.3.3.2.4">ℒ</ci><interval closure="open" id="S4.SS1.p2.6.m1.3.3.2.2.3.cmml" xref="S4.SS1.p2.6.m1.3.3.2.2.2"><apply id="S4.SS1.p2.6.m1.2.2.1.1.1.1.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p2.6.m1.2.2.1.1.1.1.2.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.2"><ci id="S4.SS1.p2.6.m1.2.2.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.2.1">^</ci><ci id="S4.SS1.p2.6.m1.2.2.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.2.2">𝑦</ci></apply><ci id="S4.SS1.p2.6.m1.2.2.1.1.1.1.3.cmml" xref="S4.SS1.p2.6.m1.2.2.1.1.1.1.3">𝑙</ci></apply><apply id="S4.SS1.p2.6.m1.3.3.2.2.2.2.cmml" xref="S4.SS1.p2.6.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m1.3.3.2.2.2.2.1.cmml" xref="S4.SS1.p2.6.m1.3.3.2.2.2.2">superscript</csymbol><ci id="S4.SS1.p2.6.m1.3.3.2.2.2.2.2.cmml" xref="S4.SS1.p2.6.m1.3.3.2.2.2.2.2">𝑦</ci><ci id="S4.SS1.p2.6.m1.3.3.2.2.2.2.3.cmml" xref="S4.SS1.p2.6.m1.3.3.2.2.2.2.3">𝑙</ci></apply></interval></apply><apply id="S4.SS1.p2.6.m1.4.4.3.cmml" xref="S4.SS1.p2.6.m1.4.4.3"><minus id="S4.SS1.p2.6.m1.4.4.3.2.cmml" xref="S4.SS1.p2.6.m1.4.4.3"></minus><apply id="S4.SS1.p2.6.m1.4.4.3.1.2.cmml" xref="S4.SS1.p2.6.m1.4.4.3.1.1"><log id="S4.SS1.p2.6.m1.1.1.cmml" xref="S4.SS1.p2.6.m1.1.1"></log><apply id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.cmml" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.1.cmml" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.cmml" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.1.cmml" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1">subscript</csymbol><apply id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2.cmml" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2"><ci id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2.1.cmml" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2.1">^</ci><ci id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.2.2">𝑦</ci></apply><ci id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.3.cmml" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.2.3">𝑡</ci></apply><ci id="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.3.cmml" xref="S4.SS1.p2.6.m1.4.4.3.1.1.1.1.3">𝑙</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m1.4c">\mathcal{L}(\hat{y}^{l},y^{l})=-\log(\hat{y}_{t}^{l})</annotation></semantics></math> into Eq. (<a href="#S4.E4" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), we have</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E5.m1.2" class="ltx_Math" alttext="\mathcal{L}_{focal}{(x^{l})}=(1-\exp(-\mathcal{L}(\hat{y}^{l},y^{l})))^{\gamma}\mathcal{L}(\hat{y}^{l},y^{l})." display="block"><semantics id="S4.E5.m1.2a"><mrow id="S4.E5.m1.2.2.1" xref="S4.E5.m1.2.2.1.1.cmml"><mrow id="S4.E5.m1.2.2.1.1" xref="S4.E5.m1.2.2.1.1.cmml"><mrow id="S4.E5.m1.2.2.1.1.1" xref="S4.E5.m1.2.2.1.1.1.cmml"><msub id="S4.E5.m1.2.2.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.2.2.1.1.1.3.2" xref="S4.E5.m1.2.2.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E5.m1.2.2.1.1.1.3.3" xref="S4.E5.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.E5.m1.2.2.1.1.1.3.3.2" xref="S4.E5.m1.2.2.1.1.1.3.3.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.1.3.3.1" xref="S4.E5.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E5.m1.2.2.1.1.1.3.3.3" xref="S4.E5.m1.2.2.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.1.3.3.1a" xref="S4.E5.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E5.m1.2.2.1.1.1.3.3.4" xref="S4.E5.m1.2.2.1.1.1.3.3.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.1.3.3.1b" xref="S4.E5.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E5.m1.2.2.1.1.1.3.3.5" xref="S4.E5.m1.2.2.1.1.1.3.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.1.3.3.1c" xref="S4.E5.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E5.m1.2.2.1.1.1.3.3.6" xref="S4.E5.m1.2.2.1.1.1.3.3.6.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E5.m1.2.2.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E5.m1.2.2.1.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E5.m1.2.2.1.1.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E5.m1.2.2.1.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.2.2.1.1.5" xref="S4.E5.m1.2.2.1.1.5.cmml">=</mo><mrow id="S4.E5.m1.2.2.1.1.4" xref="S4.E5.m1.2.2.1.1.4.cmml"><msup id="S4.E5.m1.2.2.1.1.2.1" xref="S4.E5.m1.2.2.1.1.2.1.cmml"><mrow id="S4.E5.m1.2.2.1.1.2.1.1.1" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.2.1.1.1.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E5.m1.2.2.1.1.2.1.1.1.1" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.cmml"><mn id="S4.E5.m1.2.2.1.1.2.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.3.cmml">1</mn><mo id="S4.E5.m1.2.2.1.1.2.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.2.cmml">−</mo><mrow id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">exp</mi><mo id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1a" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">(</mo><mrow id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1a" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.4" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><msup id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mover accent="true" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mo id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msup id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">y</mi><mi id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.5" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E5.m1.2.2.1.1.2.1.1.1.3" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow><mi id="S4.E5.m1.2.2.1.1.2.1.3" xref="S4.E5.m1.2.2.1.1.2.1.3.cmml">γ</mi></msup><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.4.4" xref="S4.E5.m1.2.2.1.1.4.4.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.2.2.1.1.4.5" xref="S4.E5.m1.2.2.1.1.4.5.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.2.2.1.1.4.4a" xref="S4.E5.m1.2.2.1.1.4.4.cmml">​</mo><mrow id="S4.E5.m1.2.2.1.1.4.3.2" xref="S4.E5.m1.2.2.1.1.4.3.3.cmml"><mo stretchy="false" id="S4.E5.m1.2.2.1.1.4.3.2.3" xref="S4.E5.m1.2.2.1.1.4.3.3.cmml">(</mo><msup id="S4.E5.m1.2.2.1.1.3.2.1.1" xref="S4.E5.m1.2.2.1.1.3.2.1.1.cmml"><mover accent="true" id="S4.E5.m1.2.2.1.1.3.2.1.1.2" xref="S4.E5.m1.2.2.1.1.3.2.1.1.2.cmml"><mi id="S4.E5.m1.2.2.1.1.3.2.1.1.2.2" xref="S4.E5.m1.2.2.1.1.3.2.1.1.2.2.cmml">y</mi><mo id="S4.E5.m1.2.2.1.1.3.2.1.1.2.1" xref="S4.E5.m1.2.2.1.1.3.2.1.1.2.1.cmml">^</mo></mover><mi id="S4.E5.m1.2.2.1.1.3.2.1.1.3" xref="S4.E5.m1.2.2.1.1.3.2.1.1.3.cmml">l</mi></msup><mo id="S4.E5.m1.2.2.1.1.4.3.2.4" xref="S4.E5.m1.2.2.1.1.4.3.3.cmml">,</mo><msup id="S4.E5.m1.2.2.1.1.4.3.2.2" xref="S4.E5.m1.2.2.1.1.4.3.2.2.cmml"><mi id="S4.E5.m1.2.2.1.1.4.3.2.2.2" xref="S4.E5.m1.2.2.1.1.4.3.2.2.2.cmml">y</mi><mi id="S4.E5.m1.2.2.1.1.4.3.2.2.3" xref="S4.E5.m1.2.2.1.1.4.3.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E5.m1.2.2.1.1.4.3.2.5" xref="S4.E5.m1.2.2.1.1.4.3.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E5.m1.2.2.1.2" xref="S4.E5.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.2b"><apply id="S4.E5.m1.2.2.1.1.cmml" xref="S4.E5.m1.2.2.1"><eq id="S4.E5.m1.2.2.1.1.5.cmml" xref="S4.E5.m1.2.2.1.1.5"></eq><apply id="S4.E5.m1.2.2.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1"><times id="S4.E5.m1.2.2.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.2"></times><apply id="S4.E5.m1.2.2.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.3.1.cmml" xref="S4.E5.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.3.2.cmml" xref="S4.E5.m1.2.2.1.1.1.3.2">ℒ</ci><apply id="S4.E5.m1.2.2.1.1.1.3.3.cmml" xref="S4.E5.m1.2.2.1.1.1.3.3"><times id="S4.E5.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.E5.m1.2.2.1.1.1.3.3.1"></times><ci id="S4.E5.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.E5.m1.2.2.1.1.1.3.3.2">𝑓</ci><ci id="S4.E5.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.E5.m1.2.2.1.1.1.3.3.3">𝑜</ci><ci id="S4.E5.m1.2.2.1.1.1.3.3.4.cmml" xref="S4.E5.m1.2.2.1.1.1.3.3.4">𝑐</ci><ci id="S4.E5.m1.2.2.1.1.1.3.3.5.cmml" xref="S4.E5.m1.2.2.1.1.1.3.3.5">𝑎</ci><ci id="S4.E5.m1.2.2.1.1.1.3.3.6.cmml" xref="S4.E5.m1.2.2.1.1.1.3.3.6">𝑙</ci></apply></apply><apply id="S4.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.E5.m1.2.2.1.1.4.cmml" xref="S4.E5.m1.2.2.1.1.4"><times id="S4.E5.m1.2.2.1.1.4.4.cmml" xref="S4.E5.m1.2.2.1.1.4.4"></times><apply id="S4.E5.m1.2.2.1.1.2.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.1.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1">superscript</csymbol><apply id="S4.E5.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1"><minus id="S4.E5.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.2"></minus><cn type="integer" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.3">1</cn><apply id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1"><exp id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1"></exp><apply id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1"><minus id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1"></minus><apply id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2"><times id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.3"></times><ci id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.4.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.4">ℒ</ci><interval closure="open" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2"><apply id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2"><ci id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1">^</ci><ci id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑦</ci></apply><ci id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2">𝑦</ci><ci id="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑙</ci></apply></interval></apply></apply></apply></apply><ci id="S4.E5.m1.2.2.1.1.2.1.3.cmml" xref="S4.E5.m1.2.2.1.1.2.1.3">𝛾</ci></apply><ci id="S4.E5.m1.2.2.1.1.4.5.cmml" xref="S4.E5.m1.2.2.1.1.4.5">ℒ</ci><interval closure="open" id="S4.E5.m1.2.2.1.1.4.3.3.cmml" xref="S4.E5.m1.2.2.1.1.4.3.2"><apply id="S4.E5.m1.2.2.1.1.3.2.1.1.cmml" xref="S4.E5.m1.2.2.1.1.3.2.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.3.2.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.3.2.1.1">superscript</csymbol><apply id="S4.E5.m1.2.2.1.1.3.2.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.3.2.1.1.2"><ci id="S4.E5.m1.2.2.1.1.3.2.1.1.2.1.cmml" xref="S4.E5.m1.2.2.1.1.3.2.1.1.2.1">^</ci><ci id="S4.E5.m1.2.2.1.1.3.2.1.1.2.2.cmml" xref="S4.E5.m1.2.2.1.1.3.2.1.1.2.2">𝑦</ci></apply><ci id="S4.E5.m1.2.2.1.1.3.2.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.3.2.1.1.3">𝑙</ci></apply><apply id="S4.E5.m1.2.2.1.1.4.3.2.2.cmml" xref="S4.E5.m1.2.2.1.1.4.3.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.4.3.2.2.1.cmml" xref="S4.E5.m1.2.2.1.1.4.3.2.2">superscript</csymbol><ci id="S4.E5.m1.2.2.1.1.4.3.2.2.2.cmml" xref="S4.E5.m1.2.2.1.1.4.3.2.2.2">𝑦</ci><ci id="S4.E5.m1.2.2.1.1.4.3.2.2.3.cmml" xref="S4.E5.m1.2.2.1.1.4.3.2.2.3">𝑙</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.2c">\mathcal{L}_{focal}{(x^{l})}=(1-\exp(-\mathcal{L}(\hat{y}^{l},y^{l})))^{\gamma}\mathcal{L}(\hat{y}^{l},y^{l}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.16" class="ltx_p">A generalized formulation for instance-reweighting can then be obtained as</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E6.m1.2" class="ltx_Math" alttext="\mathcal{L}_{FLIT}{(x^{l})}=(1-\exp(-\omega(x^{l},F^{l},F^{g})))^{\gamma}\mathcal{L}(\hat{y}^{l},y^{l})," display="block"><semantics id="S4.E6.m1.2a"><mrow id="S4.E6.m1.2.2.1" xref="S4.E6.m1.2.2.1.1.cmml"><mrow id="S4.E6.m1.2.2.1.1" xref="S4.E6.m1.2.2.1.1.cmml"><mrow id="S4.E6.m1.2.2.1.1.1" xref="S4.E6.m1.2.2.1.1.1.cmml"><msub id="S4.E6.m1.2.2.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.2.2.1.1.1.3.2" xref="S4.E6.m1.2.2.1.1.1.3.2.cmml">ℒ</mi><mrow id="S4.E6.m1.2.2.1.1.1.3.3" xref="S4.E6.m1.2.2.1.1.1.3.3.cmml"><mi id="S4.E6.m1.2.2.1.1.1.3.3.2" xref="S4.E6.m1.2.2.1.1.1.3.3.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.1.3.3.1" xref="S4.E6.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.2.2.1.1.1.3.3.3" xref="S4.E6.m1.2.2.1.1.1.3.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.1.3.3.1a" xref="S4.E6.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.2.2.1.1.1.3.3.4" xref="S4.E6.m1.2.2.1.1.1.3.3.4.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.1.3.3.1b" xref="S4.E6.m1.2.2.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E6.m1.2.2.1.1.1.3.3.5" xref="S4.E6.m1.2.2.1.1.1.3.3.5.cmml">T</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E6.m1.2.2.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.2.2.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E6.m1.2.2.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E6.m1.2.2.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E6.m1.2.2.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.2.2.1.1.5" xref="S4.E6.m1.2.2.1.1.5.cmml">=</mo><mrow id="S4.E6.m1.2.2.1.1.4" xref="S4.E6.m1.2.2.1.1.4.cmml"><msup id="S4.E6.m1.2.2.1.1.2.1" xref="S4.E6.m1.2.2.1.1.2.1.cmml"><mrow id="S4.E6.m1.2.2.1.1.2.1.1.1" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.2.2.1.1.2.1.1.1.2" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S4.E6.m1.2.2.1.1.2.1.1.1.1" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.cmml"><mn id="S4.E6.m1.2.2.1.1.2.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.3.cmml">1</mn><mo id="S4.E6.m1.2.2.1.1.2.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.2.cmml">−</mo><mrow id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">exp</mi><mo id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1a" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">(</mo><mrow id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1a" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.5" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.5.cmml">ω</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.4" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.4.cmml">​</mo><mrow id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.4.cmml"><mo stretchy="false" id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.4" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.4.cmml">(</mo><msup id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.5" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msup id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">F</mi><mi id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">l</mi></msup><mo id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.6" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.4.cmml">,</mo><msup id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml">F</mi><mi id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml">g</mi></msup><mo stretchy="false" id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.7" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.4.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E6.m1.2.2.1.1.2.1.1.1.3" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow><mi id="S4.E6.m1.2.2.1.1.2.1.3" xref="S4.E6.m1.2.2.1.1.2.1.3.cmml">γ</mi></msup><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.4.4" xref="S4.E6.m1.2.2.1.1.4.4.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.2.2.1.1.4.5" xref="S4.E6.m1.2.2.1.1.4.5.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.2.2.1.1.4.4a" xref="S4.E6.m1.2.2.1.1.4.4.cmml">​</mo><mrow id="S4.E6.m1.2.2.1.1.4.3.2" xref="S4.E6.m1.2.2.1.1.4.3.3.cmml"><mo stretchy="false" id="S4.E6.m1.2.2.1.1.4.3.2.3" xref="S4.E6.m1.2.2.1.1.4.3.3.cmml">(</mo><msup id="S4.E6.m1.2.2.1.1.3.2.1.1" xref="S4.E6.m1.2.2.1.1.3.2.1.1.cmml"><mover accent="true" id="S4.E6.m1.2.2.1.1.3.2.1.1.2" xref="S4.E6.m1.2.2.1.1.3.2.1.1.2.cmml"><mi id="S4.E6.m1.2.2.1.1.3.2.1.1.2.2" xref="S4.E6.m1.2.2.1.1.3.2.1.1.2.2.cmml">y</mi><mo id="S4.E6.m1.2.2.1.1.3.2.1.1.2.1" xref="S4.E6.m1.2.2.1.1.3.2.1.1.2.1.cmml">^</mo></mover><mi id="S4.E6.m1.2.2.1.1.3.2.1.1.3" xref="S4.E6.m1.2.2.1.1.3.2.1.1.3.cmml">l</mi></msup><mo id="S4.E6.m1.2.2.1.1.4.3.2.4" xref="S4.E6.m1.2.2.1.1.4.3.3.cmml">,</mo><msup id="S4.E6.m1.2.2.1.1.4.3.2.2" xref="S4.E6.m1.2.2.1.1.4.3.2.2.cmml"><mi id="S4.E6.m1.2.2.1.1.4.3.2.2.2" xref="S4.E6.m1.2.2.1.1.4.3.2.2.2.cmml">y</mi><mi id="S4.E6.m1.2.2.1.1.4.3.2.2.3" xref="S4.E6.m1.2.2.1.1.4.3.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E6.m1.2.2.1.1.4.3.2.5" xref="S4.E6.m1.2.2.1.1.4.3.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E6.m1.2.2.1.2" xref="S4.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.2b"><apply id="S4.E6.m1.2.2.1.1.cmml" xref="S4.E6.m1.2.2.1"><eq id="S4.E6.m1.2.2.1.1.5.cmml" xref="S4.E6.m1.2.2.1.1.5"></eq><apply id="S4.E6.m1.2.2.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1"><times id="S4.E6.m1.2.2.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.2"></times><apply id="S4.E6.m1.2.2.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.3.1.cmml" xref="S4.E6.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.3.2.cmml" xref="S4.E6.m1.2.2.1.1.1.3.2">ℒ</ci><apply id="S4.E6.m1.2.2.1.1.1.3.3.cmml" xref="S4.E6.m1.2.2.1.1.1.3.3"><times id="S4.E6.m1.2.2.1.1.1.3.3.1.cmml" xref="S4.E6.m1.2.2.1.1.1.3.3.1"></times><ci id="S4.E6.m1.2.2.1.1.1.3.3.2.cmml" xref="S4.E6.m1.2.2.1.1.1.3.3.2">𝐹</ci><ci id="S4.E6.m1.2.2.1.1.1.3.3.3.cmml" xref="S4.E6.m1.2.2.1.1.1.3.3.3">𝐿</ci><ci id="S4.E6.m1.2.2.1.1.1.3.3.4.cmml" xref="S4.E6.m1.2.2.1.1.1.3.3.4">𝐼</ci><ci id="S4.E6.m1.2.2.1.1.1.3.3.5.cmml" xref="S4.E6.m1.2.2.1.1.1.3.3.5">𝑇</ci></apply></apply><apply id="S4.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.E6.m1.2.2.1.1.4.cmml" xref="S4.E6.m1.2.2.1.1.4"><times id="S4.E6.m1.2.2.1.1.4.4.cmml" xref="S4.E6.m1.2.2.1.1.4.4"></times><apply id="S4.E6.m1.2.2.1.1.2.1.cmml" xref="S4.E6.m1.2.2.1.1.2.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.2.1.2.cmml" xref="S4.E6.m1.2.2.1.1.2.1">superscript</csymbol><apply id="S4.E6.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1"><minus id="S4.E6.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.2"></minus><cn type="integer" id="S4.E6.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.3">1</cn><apply id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1"><exp id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1"></exp><apply id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1"><minus id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1"></minus><apply id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3"><times id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.4"></times><ci id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.5.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.5">𝜔</ci><vector id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3"><apply id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐹</ci><ci id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑙</ci></apply><apply id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3">superscript</csymbol><ci id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.2">𝐹</ci><ci id="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.E6.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.3">𝑔</ci></apply></vector></apply></apply></apply></apply><ci id="S4.E6.m1.2.2.1.1.2.1.3.cmml" xref="S4.E6.m1.2.2.1.1.2.1.3">𝛾</ci></apply><ci id="S4.E6.m1.2.2.1.1.4.5.cmml" xref="S4.E6.m1.2.2.1.1.4.5">ℒ</ci><interval closure="open" id="S4.E6.m1.2.2.1.1.4.3.3.cmml" xref="S4.E6.m1.2.2.1.1.4.3.2"><apply id="S4.E6.m1.2.2.1.1.3.2.1.1.cmml" xref="S4.E6.m1.2.2.1.1.3.2.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.3.2.1.1.1.cmml" xref="S4.E6.m1.2.2.1.1.3.2.1.1">superscript</csymbol><apply id="S4.E6.m1.2.2.1.1.3.2.1.1.2.cmml" xref="S4.E6.m1.2.2.1.1.3.2.1.1.2"><ci id="S4.E6.m1.2.2.1.1.3.2.1.1.2.1.cmml" xref="S4.E6.m1.2.2.1.1.3.2.1.1.2.1">^</ci><ci id="S4.E6.m1.2.2.1.1.3.2.1.1.2.2.cmml" xref="S4.E6.m1.2.2.1.1.3.2.1.1.2.2">𝑦</ci></apply><ci id="S4.E6.m1.2.2.1.1.3.2.1.1.3.cmml" xref="S4.E6.m1.2.2.1.1.3.2.1.1.3">𝑙</ci></apply><apply id="S4.E6.m1.2.2.1.1.4.3.2.2.cmml" xref="S4.E6.m1.2.2.1.1.4.3.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.2.2.1.1.4.3.2.2.1.cmml" xref="S4.E6.m1.2.2.1.1.4.3.2.2">superscript</csymbol><ci id="S4.E6.m1.2.2.1.1.4.3.2.2.2.cmml" xref="S4.E6.m1.2.2.1.1.4.3.2.2.2">𝑦</ci><ci id="S4.E6.m1.2.2.1.1.4.3.2.2.3.cmml" xref="S4.E6.m1.2.2.1.1.4.3.2.2.3">𝑙</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.2c">\mathcal{L}_{FLIT}{(x^{l})}=(1-\exp(-\omega(x^{l},F^{l},F^{g})))^{\gamma}\mathcal{L}(\hat{y}^{l},y^{l}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.9" class="ltx_p">where <math id="S4.SS1.p2.7.m1.3" class="ltx_Math" alttext="\omega(x^{l},F^{l},F^{g})" display="inline"><semantics id="S4.SS1.p2.7.m1.3a"><mrow id="S4.SS1.p2.7.m1.3.3" xref="S4.SS1.p2.7.m1.3.3.cmml"><mi id="S4.SS1.p2.7.m1.3.3.5" xref="S4.SS1.p2.7.m1.3.3.5.cmml">ω</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.7.m1.3.3.4" xref="S4.SS1.p2.7.m1.3.3.4.cmml">​</mo><mrow id="S4.SS1.p2.7.m1.3.3.3.3" xref="S4.SS1.p2.7.m1.3.3.3.4.cmml"><mo stretchy="false" id="S4.SS1.p2.7.m1.3.3.3.3.4" xref="S4.SS1.p2.7.m1.3.3.3.4.cmml">(</mo><msup id="S4.SS1.p2.7.m1.1.1.1.1.1" xref="S4.SS1.p2.7.m1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.7.m1.1.1.1.1.1.2" xref="S4.SS1.p2.7.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS1.p2.7.m1.1.1.1.1.1.3" xref="S4.SS1.p2.7.m1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.SS1.p2.7.m1.3.3.3.3.5" xref="S4.SS1.p2.7.m1.3.3.3.4.cmml">,</mo><msup id="S4.SS1.p2.7.m1.2.2.2.2.2" xref="S4.SS1.p2.7.m1.2.2.2.2.2.cmml"><mi id="S4.SS1.p2.7.m1.2.2.2.2.2.2" xref="S4.SS1.p2.7.m1.2.2.2.2.2.2.cmml">F</mi><mi id="S4.SS1.p2.7.m1.2.2.2.2.2.3" xref="S4.SS1.p2.7.m1.2.2.2.2.2.3.cmml">l</mi></msup><mo id="S4.SS1.p2.7.m1.3.3.3.3.6" xref="S4.SS1.p2.7.m1.3.3.3.4.cmml">,</mo><msup id="S4.SS1.p2.7.m1.3.3.3.3.3" xref="S4.SS1.p2.7.m1.3.3.3.3.3.cmml"><mi id="S4.SS1.p2.7.m1.3.3.3.3.3.2" xref="S4.SS1.p2.7.m1.3.3.3.3.3.2.cmml">F</mi><mi id="S4.SS1.p2.7.m1.3.3.3.3.3.3" xref="S4.SS1.p2.7.m1.3.3.3.3.3.3.cmml">g</mi></msup><mo stretchy="false" id="S4.SS1.p2.7.m1.3.3.3.3.7" xref="S4.SS1.p2.7.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m1.3b"><apply id="S4.SS1.p2.7.m1.3.3.cmml" xref="S4.SS1.p2.7.m1.3.3"><times id="S4.SS1.p2.7.m1.3.3.4.cmml" xref="S4.SS1.p2.7.m1.3.3.4"></times><ci id="S4.SS1.p2.7.m1.3.3.5.cmml" xref="S4.SS1.p2.7.m1.3.3.5">𝜔</ci><vector id="S4.SS1.p2.7.m1.3.3.3.4.cmml" xref="S4.SS1.p2.7.m1.3.3.3.3"><apply id="S4.SS1.p2.7.m1.1.1.1.1.1.cmml" xref="S4.SS1.p2.7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.7.m1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p2.7.m1.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.7.m1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS1.p2.7.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.7.m1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S4.SS1.p2.7.m1.2.2.2.2.2.cmml" xref="S4.SS1.p2.7.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m1.2.2.2.2.2.1.cmml" xref="S4.SS1.p2.7.m1.2.2.2.2.2">superscript</csymbol><ci id="S4.SS1.p2.7.m1.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.7.m1.2.2.2.2.2.2">𝐹</ci><ci id="S4.SS1.p2.7.m1.2.2.2.2.2.3.cmml" xref="S4.SS1.p2.7.m1.2.2.2.2.2.3">𝑙</ci></apply><apply id="S4.SS1.p2.7.m1.3.3.3.3.3.cmml" xref="S4.SS1.p2.7.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m1.3.3.3.3.3.1.cmml" xref="S4.SS1.p2.7.m1.3.3.3.3.3">superscript</csymbol><ci id="S4.SS1.p2.7.m1.3.3.3.3.3.2.cmml" xref="S4.SS1.p2.7.m1.3.3.3.3.3.2">𝐹</ci><ci id="S4.SS1.p2.7.m1.3.3.3.3.3.3.cmml" xref="S4.SS1.p2.7.m1.3.3.3.3.3.3">𝑔</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m1.3c">\omega(x^{l},F^{l},F^{g})</annotation></semantics></math> is a non-negative function that indicates the uncertainty of training samples and is defined by jointly utilizing the local model <math id="S4.SS1.p2.8.m2.1" class="ltx_Math" alttext="F^{l}" display="inline"><semantics id="S4.SS1.p2.8.m2.1a"><msup id="S4.SS1.p2.8.m2.1.1" xref="S4.SS1.p2.8.m2.1.1.cmml"><mi id="S4.SS1.p2.8.m2.1.1.2" xref="S4.SS1.p2.8.m2.1.1.2.cmml">F</mi><mi id="S4.SS1.p2.8.m2.1.1.3" xref="S4.SS1.p2.8.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m2.1b"><apply id="S4.SS1.p2.8.m2.1.1.cmml" xref="S4.SS1.p2.8.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.8.m2.1.1.1.cmml" xref="S4.SS1.p2.8.m2.1.1">superscript</csymbol><ci id="S4.SS1.p2.8.m2.1.1.2.cmml" xref="S4.SS1.p2.8.m2.1.1.2">𝐹</ci><ci id="S4.SS1.p2.8.m2.1.1.3.cmml" xref="S4.SS1.p2.8.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m2.1c">F^{l}</annotation></semantics></math> and global model <math id="S4.SS1.p2.9.m3.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="S4.SS1.p2.9.m3.1a"><msup id="S4.SS1.p2.9.m3.1.1" xref="S4.SS1.p2.9.m3.1.1.cmml"><mi id="S4.SS1.p2.9.m3.1.1.2" xref="S4.SS1.p2.9.m3.1.1.2.cmml">F</mi><mi id="S4.SS1.p2.9.m3.1.1.3" xref="S4.SS1.p2.9.m3.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m3.1b"><apply id="S4.SS1.p2.9.m3.1.1.cmml" xref="S4.SS1.p2.9.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.9.m3.1.1.1.cmml" xref="S4.SS1.p2.9.m3.1.1">superscript</csymbol><ci id="S4.SS1.p2.9.m3.1.1.2.cmml" xref="S4.SS1.p2.9.m3.1.1.2">𝐹</ci><ci id="S4.SS1.p2.9.m3.1.1.3.cmml" xref="S4.SS1.p2.9.m3.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m3.1c">F^{g}</annotation></semantics></math> as</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E7.m1.3" class="ltx_Math" alttext="\omega(x^{l},F^{l},F^{g})=\phi(x^{l},F^{l})+\max(\phi(x^{l},F^{l})-\phi(x^{l},F^{g}),0)," display="block"><semantics id="S4.E7.m1.3a"><mrow id="S4.E7.m1.3.3.1" xref="S4.E7.m1.3.3.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1.3" xref="S4.E7.m1.3.3.1.1.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.5" xref="S4.E7.m1.3.3.1.1.3.5.cmml">ω</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.3.3.1.1.3.4" xref="S4.E7.m1.3.3.1.1.3.4.cmml">​</mo><mrow id="S4.E7.m1.3.3.1.1.3.3.3" xref="S4.E7.m1.3.3.1.1.3.3.4.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.1.3.3.3.4" xref="S4.E7.m1.3.3.1.1.3.3.4.cmml">(</mo><msup id="S4.E7.m1.3.3.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E7.m1.3.3.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.E7.m1.3.3.1.1.3.3.3.5" xref="S4.E7.m1.3.3.1.1.3.3.4.cmml">,</mo><msup id="S4.E7.m1.3.3.1.1.2.2.2.2" xref="S4.E7.m1.3.3.1.1.2.2.2.2.cmml"><mi id="S4.E7.m1.3.3.1.1.2.2.2.2.2" xref="S4.E7.m1.3.3.1.1.2.2.2.2.2.cmml">F</mi><mi id="S4.E7.m1.3.3.1.1.2.2.2.2.3" xref="S4.E7.m1.3.3.1.1.2.2.2.2.3.cmml">l</mi></msup><mo id="S4.E7.m1.3.3.1.1.3.3.3.6" xref="S4.E7.m1.3.3.1.1.3.3.4.cmml">,</mo><msup id="S4.E7.m1.3.3.1.1.3.3.3.3" xref="S4.E7.m1.3.3.1.1.3.3.3.3.cmml"><mi id="S4.E7.m1.3.3.1.1.3.3.3.3.2" xref="S4.E7.m1.3.3.1.1.3.3.3.3.2.cmml">F</mi><mi id="S4.E7.m1.3.3.1.1.3.3.3.3.3" xref="S4.E7.m1.3.3.1.1.3.3.3.3.3.cmml">g</mi></msup><mo stretchy="false" id="S4.E7.m1.3.3.1.1.3.3.3.7" xref="S4.E7.m1.3.3.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.3.3.1.1.7" xref="S4.E7.m1.3.3.1.1.7.cmml">=</mo><mrow id="S4.E7.m1.3.3.1.1.6" xref="S4.E7.m1.3.3.1.1.6.cmml"><mrow id="S4.E7.m1.3.3.1.1.5.2" xref="S4.E7.m1.3.3.1.1.5.2.cmml"><mi id="S4.E7.m1.3.3.1.1.5.2.4" xref="S4.E7.m1.3.3.1.1.5.2.4.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.3.3.1.1.5.2.3" xref="S4.E7.m1.3.3.1.1.5.2.3.cmml">​</mo><mrow id="S4.E7.m1.3.3.1.1.5.2.2.2" xref="S4.E7.m1.3.3.1.1.5.2.2.3.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.1.5.2.2.2.3" xref="S4.E7.m1.3.3.1.1.5.2.2.3.cmml">(</mo><msup id="S4.E7.m1.3.3.1.1.4.1.1.1.1" xref="S4.E7.m1.3.3.1.1.4.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.4.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.4.1.1.1.1.2.cmml">x</mi><mi id="S4.E7.m1.3.3.1.1.4.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.4.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.E7.m1.3.3.1.1.5.2.2.2.4" xref="S4.E7.m1.3.3.1.1.5.2.2.3.cmml">,</mo><msup id="S4.E7.m1.3.3.1.1.5.2.2.2.2" xref="S4.E7.m1.3.3.1.1.5.2.2.2.2.cmml"><mi id="S4.E7.m1.3.3.1.1.5.2.2.2.2.2" xref="S4.E7.m1.3.3.1.1.5.2.2.2.2.2.cmml">F</mi><mi id="S4.E7.m1.3.3.1.1.5.2.2.2.2.3" xref="S4.E7.m1.3.3.1.1.5.2.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E7.m1.3.3.1.1.5.2.2.2.5" xref="S4.E7.m1.3.3.1.1.5.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.3.3.1.1.6.4" xref="S4.E7.m1.3.3.1.1.6.4.cmml">+</mo><mrow id="S4.E7.m1.3.3.1.1.6.3.1" xref="S4.E7.m1.3.3.1.1.6.3.2.cmml"><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">max</mi><mo id="S4.E7.m1.3.3.1.1.6.3.1a" xref="S4.E7.m1.3.3.1.1.6.3.2.cmml">⁡</mo><mrow id="S4.E7.m1.3.3.1.1.6.3.1.1" xref="S4.E7.m1.3.3.1.1.6.3.2.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.1.6.3.1.1.2" xref="S4.E7.m1.3.3.1.1.6.3.2.cmml">(</mo><mrow id="S4.E7.m1.3.3.1.1.6.3.1.1.1" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.cmml"><mrow id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.cmml"><mi id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.4" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.4.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.3" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.3.cmml">​</mo><mrow id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.3" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.3.cmml">(</mo><msup id="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.2" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.3" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.4" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.3.cmml">,</mo><msup id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.cmml"><mi id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.2" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.2.cmml">F</mi><mi id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.3" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.5" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E7.m1.3.3.1.1.6.3.1.1.1.5" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.5.cmml">−</mo><mrow id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.cmml"><mi id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.4" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.4.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.3" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.3.cmml">​</mo><mrow id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.3.cmml"><mo stretchy="false" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.3" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.3.cmml">(</mo><msup id="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.cmml"><mi id="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.2" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.2.cmml">x</mi><mi id="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.3" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.3.cmml">l</mi></msup><mo id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.4" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.3.cmml">,</mo><msup id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.cmml"><mi id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.2" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.2.cmml">F</mi><mi id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.3" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.3.cmml">g</mi></msup><mo stretchy="false" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.5" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E7.m1.3.3.1.1.6.3.1.1.3" xref="S4.E7.m1.3.3.1.1.6.3.2.cmml">,</mo><mn id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">0</mn><mo stretchy="false" id="S4.E7.m1.3.3.1.1.6.3.1.1.4" xref="S4.E7.m1.3.3.1.1.6.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E7.m1.3.3.1.2" xref="S4.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.3b"><apply id="S4.E7.m1.3.3.1.1.cmml" xref="S4.E7.m1.3.3.1"><eq id="S4.E7.m1.3.3.1.1.7.cmml" xref="S4.E7.m1.3.3.1.1.7"></eq><apply id="S4.E7.m1.3.3.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.3"><times id="S4.E7.m1.3.3.1.1.3.4.cmml" xref="S4.E7.m1.3.3.1.1.3.4"></times><ci id="S4.E7.m1.3.3.1.1.3.5.cmml" xref="S4.E7.m1.3.3.1.1.3.5">𝜔</ci><vector id="S4.E7.m1.3.3.1.1.3.3.4.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3"><apply id="S4.E7.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E7.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S4.E7.m1.3.3.1.1.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.2.2.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.2.2.2.2.2">𝐹</ci><ci id="S4.E7.m1.3.3.1.1.2.2.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.2.2.2.2.3">𝑙</ci></apply><apply id="S4.E7.m1.3.3.1.1.3.3.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.3.3.3.3.1.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.3">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.3.3.3.3.2.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.3.2">𝐹</ci><ci id="S4.E7.m1.3.3.1.1.3.3.3.3.3.cmml" xref="S4.E7.m1.3.3.1.1.3.3.3.3.3">𝑔</ci></apply></vector></apply><apply id="S4.E7.m1.3.3.1.1.6.cmml" xref="S4.E7.m1.3.3.1.1.6"><plus id="S4.E7.m1.3.3.1.1.6.4.cmml" xref="S4.E7.m1.3.3.1.1.6.4"></plus><apply id="S4.E7.m1.3.3.1.1.5.2.cmml" xref="S4.E7.m1.3.3.1.1.5.2"><times id="S4.E7.m1.3.3.1.1.5.2.3.cmml" xref="S4.E7.m1.3.3.1.1.5.2.3"></times><ci id="S4.E7.m1.3.3.1.1.5.2.4.cmml" xref="S4.E7.m1.3.3.1.1.5.2.4">italic-ϕ</ci><interval closure="open" id="S4.E7.m1.3.3.1.1.5.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.5.2.2.2"><apply id="S4.E7.m1.3.3.1.1.4.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.4.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.4.1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.4.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.4.1.1.1.1.2">𝑥</ci><ci id="S4.E7.m1.3.3.1.1.4.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.4.1.1.1.1.3">𝑙</ci></apply><apply id="S4.E7.m1.3.3.1.1.5.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.5.2.2.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.5.2.2.2.2">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.5.2.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.5.2.2.2.2.2">𝐹</ci><ci id="S4.E7.m1.3.3.1.1.5.2.2.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.5.2.2.2.2.3">𝑙</ci></apply></interval></apply><apply id="S4.E7.m1.3.3.1.1.6.3.2.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1"><max id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1"></max><apply id="S4.E7.m1.3.3.1.1.6.3.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1"><minus id="S4.E7.m1.3.3.1.1.6.3.1.1.1.5.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.5"></minus><apply id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2"><times id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.3.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.3"></times><ci id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.4.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.4">italic-ϕ</ci><interval closure="open" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2"><apply id="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.2">𝐹</ci><ci id="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.2.2.2.2.3">𝑙</ci></apply></interval></apply><apply id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4"><times id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.3.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.3"></times><ci id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.4.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.4">italic-ϕ</ci><interval closure="open" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.3.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2"><apply id="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.1.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.2.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.2">𝑥</ci><ci id="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.3.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.3.1.1.1.3">𝑙</ci></apply><apply id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.1.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2">superscript</csymbol><ci id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.2.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.2">𝐹</ci><ci id="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.3.cmml" xref="S4.E7.m1.3.3.1.1.6.3.1.1.1.4.2.2.2.3">𝑔</ci></apply></interval></apply></apply><cn type="integer" id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.3c">\omega(x^{l},F^{l},F^{g})=\phi(x^{l},F^{l})+\max(\phi(x^{l},F^{l})-\phi(x^{l},F^{g}),0),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.14" class="ltx_p">where <math id="S4.SS1.p2.10.m1.2" class="ltx_Math" alttext="\phi(x,F)" display="inline"><semantics id="S4.SS1.p2.10.m1.2a"><mrow id="S4.SS1.p2.10.m1.2.3" xref="S4.SS1.p2.10.m1.2.3.cmml"><mi id="S4.SS1.p2.10.m1.2.3.2" xref="S4.SS1.p2.10.m1.2.3.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.10.m1.2.3.1" xref="S4.SS1.p2.10.m1.2.3.1.cmml">​</mo><mrow id="S4.SS1.p2.10.m1.2.3.3.2" xref="S4.SS1.p2.10.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS1.p2.10.m1.2.3.3.2.1" xref="S4.SS1.p2.10.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS1.p2.10.m1.1.1" xref="S4.SS1.p2.10.m1.1.1.cmml">x</mi><mo id="S4.SS1.p2.10.m1.2.3.3.2.2" xref="S4.SS1.p2.10.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS1.p2.10.m1.2.2" xref="S4.SS1.p2.10.m1.2.2.cmml">F</mi><mo stretchy="false" id="S4.SS1.p2.10.m1.2.3.3.2.3" xref="S4.SS1.p2.10.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m1.2b"><apply id="S4.SS1.p2.10.m1.2.3.cmml" xref="S4.SS1.p2.10.m1.2.3"><times id="S4.SS1.p2.10.m1.2.3.1.cmml" xref="S4.SS1.p2.10.m1.2.3.1"></times><ci id="S4.SS1.p2.10.m1.2.3.2.cmml" xref="S4.SS1.p2.10.m1.2.3.2">italic-ϕ</ci><interval closure="open" id="S4.SS1.p2.10.m1.2.3.3.1.cmml" xref="S4.SS1.p2.10.m1.2.3.3.2"><ci id="S4.SS1.p2.10.m1.1.1.cmml" xref="S4.SS1.p2.10.m1.1.1">𝑥</ci><ci id="S4.SS1.p2.10.m1.2.2.cmml" xref="S4.SS1.p2.10.m1.2.2">𝐹</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m1.2c">\phi(x,F)</annotation></semantics></math> indicates the prediction uncertainty of <math id="S4.SS1.p2.11.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p2.11.m2.1a"><mi id="S4.SS1.p2.11.m2.1.1" xref="S4.SS1.p2.11.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m2.1b"><ci id="S4.SS1.p2.11.m2.1.1.cmml" xref="S4.SS1.p2.11.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m2.1c">x</annotation></semantics></math> with the model <math id="S4.SS1.p2.12.m3.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S4.SS1.p2.12.m3.1a"><mi id="S4.SS1.p2.12.m3.1.1" xref="S4.SS1.p2.12.m3.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.12.m3.1b"><ci id="S4.SS1.p2.12.m3.1.1.cmml" xref="S4.SS1.p2.12.m3.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.12.m3.1c">F</annotation></semantics></math>. Eq. (<a href="#S4.E7" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) puts more weights on samples if the updated local model is less confident than the global model. We note <math id="S4.SS1.p2.13.m4.3" class="ltx_Math" alttext="\omega(x^{l},F^{l},F^{g})" display="inline"><semantics id="S4.SS1.p2.13.m4.3a"><mrow id="S4.SS1.p2.13.m4.3.3" xref="S4.SS1.p2.13.m4.3.3.cmml"><mi id="S4.SS1.p2.13.m4.3.3.5" xref="S4.SS1.p2.13.m4.3.3.5.cmml">ω</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.13.m4.3.3.4" xref="S4.SS1.p2.13.m4.3.3.4.cmml">​</mo><mrow id="S4.SS1.p2.13.m4.3.3.3.3" xref="S4.SS1.p2.13.m4.3.3.3.4.cmml"><mo stretchy="false" id="S4.SS1.p2.13.m4.3.3.3.3.4" xref="S4.SS1.p2.13.m4.3.3.3.4.cmml">(</mo><msup id="S4.SS1.p2.13.m4.1.1.1.1.1" xref="S4.SS1.p2.13.m4.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.13.m4.1.1.1.1.1.2" xref="S4.SS1.p2.13.m4.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS1.p2.13.m4.1.1.1.1.1.3" xref="S4.SS1.p2.13.m4.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.SS1.p2.13.m4.3.3.3.3.5" xref="S4.SS1.p2.13.m4.3.3.3.4.cmml">,</mo><msup id="S4.SS1.p2.13.m4.2.2.2.2.2" xref="S4.SS1.p2.13.m4.2.2.2.2.2.cmml"><mi id="S4.SS1.p2.13.m4.2.2.2.2.2.2" xref="S4.SS1.p2.13.m4.2.2.2.2.2.2.cmml">F</mi><mi id="S4.SS1.p2.13.m4.2.2.2.2.2.3" xref="S4.SS1.p2.13.m4.2.2.2.2.2.3.cmml">l</mi></msup><mo id="S4.SS1.p2.13.m4.3.3.3.3.6" xref="S4.SS1.p2.13.m4.3.3.3.4.cmml">,</mo><msup id="S4.SS1.p2.13.m4.3.3.3.3.3" xref="S4.SS1.p2.13.m4.3.3.3.3.3.cmml"><mi id="S4.SS1.p2.13.m4.3.3.3.3.3.2" xref="S4.SS1.p2.13.m4.3.3.3.3.3.2.cmml">F</mi><mi id="S4.SS1.p2.13.m4.3.3.3.3.3.3" xref="S4.SS1.p2.13.m4.3.3.3.3.3.3.cmml">g</mi></msup><mo stretchy="false" id="S4.SS1.p2.13.m4.3.3.3.3.7" xref="S4.SS1.p2.13.m4.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.13.m4.3b"><apply id="S4.SS1.p2.13.m4.3.3.cmml" xref="S4.SS1.p2.13.m4.3.3"><times id="S4.SS1.p2.13.m4.3.3.4.cmml" xref="S4.SS1.p2.13.m4.3.3.4"></times><ci id="S4.SS1.p2.13.m4.3.3.5.cmml" xref="S4.SS1.p2.13.m4.3.3.5">𝜔</ci><vector id="S4.SS1.p2.13.m4.3.3.3.4.cmml" xref="S4.SS1.p2.13.m4.3.3.3.3"><apply id="S4.SS1.p2.13.m4.1.1.1.1.1.cmml" xref="S4.SS1.p2.13.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.13.m4.1.1.1.1.1.1.cmml" xref="S4.SS1.p2.13.m4.1.1.1.1.1">superscript</csymbol><ci id="S4.SS1.p2.13.m4.1.1.1.1.1.2.cmml" xref="S4.SS1.p2.13.m4.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS1.p2.13.m4.1.1.1.1.1.3.cmml" xref="S4.SS1.p2.13.m4.1.1.1.1.1.3">𝑙</ci></apply><apply id="S4.SS1.p2.13.m4.2.2.2.2.2.cmml" xref="S4.SS1.p2.13.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.p2.13.m4.2.2.2.2.2.1.cmml" xref="S4.SS1.p2.13.m4.2.2.2.2.2">superscript</csymbol><ci id="S4.SS1.p2.13.m4.2.2.2.2.2.2.cmml" xref="S4.SS1.p2.13.m4.2.2.2.2.2.2">𝐹</ci><ci id="S4.SS1.p2.13.m4.2.2.2.2.2.3.cmml" xref="S4.SS1.p2.13.m4.2.2.2.2.2.3">𝑙</ci></apply><apply id="S4.SS1.p2.13.m4.3.3.3.3.3.cmml" xref="S4.SS1.p2.13.m4.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.p2.13.m4.3.3.3.3.3.1.cmml" xref="S4.SS1.p2.13.m4.3.3.3.3.3">superscript</csymbol><ci id="S4.SS1.p2.13.m4.3.3.3.3.3.2.cmml" xref="S4.SS1.p2.13.m4.3.3.3.3.3.2">𝐹</ci><ci id="S4.SS1.p2.13.m4.3.3.3.3.3.3.cmml" xref="S4.SS1.p2.13.m4.3.3.3.3.3.3">𝑔</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.13.m4.3c">\omega(x^{l},F^{l},F^{g})</annotation></semantics></math> can take other types of formulation and we implement it with Eq. (<a href="#S4.E7" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) for simplicity. Moreover, for FLIT, we follow the focal loss and define <math id="S4.SS1.p2.14.m5.1" class="ltx_Math" alttext="\phi(\cdot)" display="inline"><semantics id="S4.SS1.p2.14.m5.1a"><mrow id="S4.SS1.p2.14.m5.1.2" xref="S4.SS1.p2.14.m5.1.2.cmml"><mi id="S4.SS1.p2.14.m5.1.2.2" xref="S4.SS1.p2.14.m5.1.2.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.14.m5.1.2.1" xref="S4.SS1.p2.14.m5.1.2.1.cmml">​</mo><mrow id="S4.SS1.p2.14.m5.1.2.3.2" xref="S4.SS1.p2.14.m5.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.14.m5.1.2.3.2.1" xref="S4.SS1.p2.14.m5.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS1.p2.14.m5.1.1" xref="S4.SS1.p2.14.m5.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS1.p2.14.m5.1.2.3.2.2" xref="S4.SS1.p2.14.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.14.m5.1b"><apply id="S4.SS1.p2.14.m5.1.2.cmml" xref="S4.SS1.p2.14.m5.1.2"><times id="S4.SS1.p2.14.m5.1.2.1.cmml" xref="S4.SS1.p2.14.m5.1.2.1"></times><ci id="S4.SS1.p2.14.m5.1.2.2.cmml" xref="S4.SS1.p2.14.m5.1.2.2">italic-ϕ</ci><ci id="S4.SS1.p2.14.m5.1.1.cmml" xref="S4.SS1.p2.14.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.14.m5.1c">\phi(\cdot)</annotation></semantics></math> as the loss value <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>, <span id="S4.SS1.p2.14.1" class="ltx_text ltx_font_italic">i.e.</span>,</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E8.m1.2" class="ltx_Math" alttext="\phi(x^{l},F)=\mathcal{L}(\hat{y}^{l},y^{l})." display="block"><semantics id="S4.E8.m1.2a"><mrow id="S4.E8.m1.2.2.1" xref="S4.E8.m1.2.2.1.1.cmml"><mrow id="S4.E8.m1.2.2.1.1" xref="S4.E8.m1.2.2.1.1.cmml"><mrow id="S4.E8.m1.2.2.1.1.1" xref="S4.E8.m1.2.2.1.1.1.cmml"><mi id="S4.E8.m1.2.2.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.1.1.1.2" xref="S4.E8.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.2.2.1.1.1.1.1" xref="S4.E8.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.2.2.1.1.1.1.1.2" xref="S4.E8.m1.2.2.1.1.1.1.2.cmml">(</mo><msup id="S4.E8.m1.2.2.1.1.1.1.1.1" xref="S4.E8.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.2.2.1.1.1.1.1.1.2" xref="S4.E8.m1.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.E8.m1.2.2.1.1.1.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.E8.m1.2.2.1.1.1.1.1.3" xref="S4.E8.m1.2.2.1.1.1.1.2.cmml">,</mo><mi id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml">F</mi><mo stretchy="false" id="S4.E8.m1.2.2.1.1.1.1.1.4" xref="S4.E8.m1.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.2.2.1.1.4" xref="S4.E8.m1.2.2.1.1.4.cmml">=</mo><mrow id="S4.E8.m1.2.2.1.1.3" xref="S4.E8.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.2.2.1.1.3.4" xref="S4.E8.m1.2.2.1.1.3.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.1.1.3.3" xref="S4.E8.m1.2.2.1.1.3.3.cmml">​</mo><mrow id="S4.E8.m1.2.2.1.1.3.2.2" xref="S4.E8.m1.2.2.1.1.3.2.3.cmml"><mo stretchy="false" id="S4.E8.m1.2.2.1.1.3.2.2.3" xref="S4.E8.m1.2.2.1.1.3.2.3.cmml">(</mo><msup id="S4.E8.m1.2.2.1.1.2.1.1.1" xref="S4.E8.m1.2.2.1.1.2.1.1.1.cmml"><mover accent="true" id="S4.E8.m1.2.2.1.1.2.1.1.1.2" xref="S4.E8.m1.2.2.1.1.2.1.1.1.2.cmml"><mi id="S4.E8.m1.2.2.1.1.2.1.1.1.2.2" xref="S4.E8.m1.2.2.1.1.2.1.1.1.2.2.cmml">y</mi><mo id="S4.E8.m1.2.2.1.1.2.1.1.1.2.1" xref="S4.E8.m1.2.2.1.1.2.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.E8.m1.2.2.1.1.2.1.1.1.3" xref="S4.E8.m1.2.2.1.1.2.1.1.1.3.cmml">l</mi></msup><mo id="S4.E8.m1.2.2.1.1.3.2.2.4" xref="S4.E8.m1.2.2.1.1.3.2.3.cmml">,</mo><msup id="S4.E8.m1.2.2.1.1.3.2.2.2" xref="S4.E8.m1.2.2.1.1.3.2.2.2.cmml"><mi id="S4.E8.m1.2.2.1.1.3.2.2.2.2" xref="S4.E8.m1.2.2.1.1.3.2.2.2.2.cmml">y</mi><mi id="S4.E8.m1.2.2.1.1.3.2.2.2.3" xref="S4.E8.m1.2.2.1.1.3.2.2.2.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E8.m1.2.2.1.1.3.2.2.5" xref="S4.E8.m1.2.2.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E8.m1.2.2.1.2" xref="S4.E8.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.2b"><apply id="S4.E8.m1.2.2.1.1.cmml" xref="S4.E8.m1.2.2.1"><eq id="S4.E8.m1.2.2.1.1.4.cmml" xref="S4.E8.m1.2.2.1.1.4"></eq><apply id="S4.E8.m1.2.2.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1"><times id="S4.E8.m1.2.2.1.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.1.2"></times><ci id="S4.E8.m1.2.2.1.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.1.3">italic-ϕ</ci><interval closure="open" id="S4.E8.m1.2.2.1.1.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1"><apply id="S4.E8.m1.2.2.1.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E8.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.E8.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.1.1.1.1.3">𝑙</ci></apply><ci id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1">𝐹</ci></interval></apply><apply id="S4.E8.m1.2.2.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.3"><times id="S4.E8.m1.2.2.1.1.3.3.cmml" xref="S4.E8.m1.2.2.1.1.3.3"></times><ci id="S4.E8.m1.2.2.1.1.3.4.cmml" xref="S4.E8.m1.2.2.1.1.3.4">ℒ</ci><interval closure="open" id="S4.E8.m1.2.2.1.1.3.2.3.cmml" xref="S4.E8.m1.2.2.1.1.3.2.2"><apply id="S4.E8.m1.2.2.1.1.2.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S4.E8.m1.2.2.1.1.2.1.1.1">superscript</csymbol><apply id="S4.E8.m1.2.2.1.1.2.1.1.1.2.cmml" xref="S4.E8.m1.2.2.1.1.2.1.1.1.2"><ci id="S4.E8.m1.2.2.1.1.2.1.1.1.2.1.cmml" xref="S4.E8.m1.2.2.1.1.2.1.1.1.2.1">^</ci><ci id="S4.E8.m1.2.2.1.1.2.1.1.1.2.2.cmml" xref="S4.E8.m1.2.2.1.1.2.1.1.1.2.2">𝑦</ci></apply><ci id="S4.E8.m1.2.2.1.1.2.1.1.1.3.cmml" xref="S4.E8.m1.2.2.1.1.2.1.1.1.3">𝑙</ci></apply><apply id="S4.E8.m1.2.2.1.1.3.2.2.2.cmml" xref="S4.E8.m1.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.1.1.3.2.2.2.1.cmml" xref="S4.E8.m1.2.2.1.1.3.2.2.2">superscript</csymbol><ci id="S4.E8.m1.2.2.1.1.3.2.2.2.2.cmml" xref="S4.E8.m1.2.2.1.1.3.2.2.2.2">𝑦</ci><ci id="S4.E8.m1.2.2.1.1.3.2.2.2.3.cmml" xref="S4.E8.m1.2.2.1.1.3.2.2.2.3">𝑙</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.2c">\phi(x^{l},F)=\mathcal{L}(\hat{y}^{l},y^{l}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.15" class="ltx_p">We substitute Eq. (<a href="#S4.E8" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) into Eq. (<a href="#S4.E7" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) and Eq. (<a href="#S4.E6" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>), and the resulted method is termed as FLIT. Compared with the vanilla Focal loss, FLIT integrates the global model <math id="S4.SS1.p2.15.m1.1" class="ltx_Math" alttext="F^{g}" display="inline"><semantics id="S4.SS1.p2.15.m1.1a"><msup id="S4.SS1.p2.15.m1.1.1" xref="S4.SS1.p2.15.m1.1.1.cmml"><mi id="S4.SS1.p2.15.m1.1.1.2" xref="S4.SS1.p2.15.m1.1.1.2.cmml">F</mi><mi id="S4.SS1.p2.15.m1.1.1.3" xref="S4.SS1.p2.15.m1.1.1.3.cmml">g</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.15.m1.1b"><apply id="S4.SS1.p2.15.m1.1.1.cmml" xref="S4.SS1.p2.15.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p2.15.m1.1.1.1.cmml" xref="S4.SS1.p2.15.m1.1.1">superscript</csymbol><ci id="S4.SS1.p2.15.m1.1.1.2.cmml" xref="S4.SS1.p2.15.m1.1.1.2">𝐹</ci><ci id="S4.SS1.p2.15.m1.1.1.3.cmml" xref="S4.SS1.p2.15.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.15.m1.1c">F^{g}</annotation></semantics></math> into the local training, which turns out to benefit the federated learning according to our experiments.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>FLIT+</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.6" class="ltx_p">An alternative way to define <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\phi(\cdot)" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><mi id="S4.SS2.p1.1.m1.1.2.2" xref="S4.SS2.p1.1.m1.1.2.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.2.1" xref="S4.SS2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.1.m1.1.2.3.2" xref="S4.SS2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.3.2.1" xref="S4.SS2.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p1.1.m1.1.2.3.2.2" xref="S4.SS2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.2"><times id="S4.SS2.p1.1.m1.1.2.1.cmml" xref="S4.SS2.p1.1.m1.1.2.1"></times><ci id="S4.SS2.p1.1.m1.1.2.2.cmml" xref="S4.SS2.p1.1.m1.1.2.2">italic-ϕ</ci><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\phi(\cdot)</annotation></semantics></math> for sample <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="x^{l}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><msup id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">x</mi><mi id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">𝑥</ci><ci id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">x^{l}</annotation></semantics></math> is the prediction discrepancy between the sample and its neighbors <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>. Intuitively, the larger the discrepancy is, the less confident the model is for predicting the sample. To measure the prediction discrepancy for the neighborhoods, we aim to search for the data pairs with largest prediction discrepancy in the neighborhoods. Since directly searching for the exact neighbor is computationally expensive and is implausible with the local biased dataset, we alternatively adopts adversarial neighbor inspired by VAT (Virtual Adversarial Training) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. Adversarial neighbors are similar to <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="x^{l}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><msup id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">x</mi><mi id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1">superscript</csymbol><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝑥</ci><ci id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">x^{l}</annotation></semantics></math> in terms of the input <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="g^{l}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><msup id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">g</mi><mi id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝑔</ci><ci id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">g^{l}</annotation></semantics></math> but has the most different prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib56" title="" class="ltx_ref">56</a>]</cite>. Concretely, we measure the discrepancy by adversarial learning with a given model <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><ci id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">F</annotation></semantics></math> for <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="x^{l}" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><msup id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mi id="S4.SS2.p1.6.m6.1.1.2" xref="S4.SS2.p1.6.m6.1.1.2.cmml">x</mi><mi id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2">𝑥</ci><ci id="S4.SS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">x^{l}</annotation></semantics></math> as  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite></p>
<table id="S4.E9" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S4.E9X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E9X.2.1.1.m1.2" class="ltx_Math" alttext="\displaystyle\Delta(x^{l},F)=" display="inline"><semantics id="S4.E9X.2.1.1.m1.2a"><mrow id="S4.E9X.2.1.1.m1.2.2" xref="S4.E9X.2.1.1.m1.2.2.cmml"><mrow id="S4.E9X.2.1.1.m1.2.2.1" xref="S4.E9X.2.1.1.m1.2.2.1.cmml"><mi mathvariant="normal" id="S4.E9X.2.1.1.m1.2.2.1.3" xref="S4.E9X.2.1.1.m1.2.2.1.3.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E9X.2.1.1.m1.2.2.1.2" xref="S4.E9X.2.1.1.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E9X.2.1.1.m1.2.2.1.1.1" xref="S4.E9X.2.1.1.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E9X.2.1.1.m1.2.2.1.1.1.2" xref="S4.E9X.2.1.1.m1.2.2.1.1.2.cmml">(</mo><msup id="S4.E9X.2.1.1.m1.2.2.1.1.1.1" xref="S4.E9X.2.1.1.m1.2.2.1.1.1.1.cmml"><mi id="S4.E9X.2.1.1.m1.2.2.1.1.1.1.2" xref="S4.E9X.2.1.1.m1.2.2.1.1.1.1.2.cmml">x</mi><mi id="S4.E9X.2.1.1.m1.2.2.1.1.1.1.3" xref="S4.E9X.2.1.1.m1.2.2.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.E9X.2.1.1.m1.2.2.1.1.1.3" xref="S4.E9X.2.1.1.m1.2.2.1.1.2.cmml">,</mo><mi id="S4.E9X.2.1.1.m1.1.1" xref="S4.E9X.2.1.1.m1.1.1.cmml">F</mi><mo stretchy="false" id="S4.E9X.2.1.1.m1.2.2.1.1.1.4" xref="S4.E9X.2.1.1.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E9X.2.1.1.m1.2.2.2" xref="S4.E9X.2.1.1.m1.2.2.2.cmml">=</mo><mi id="S4.E9X.2.1.1.m1.2.2.3" xref="S4.E9X.2.1.1.m1.2.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.E9X.2.1.1.m1.2b"><apply id="S4.E9X.2.1.1.m1.2.2.cmml" xref="S4.E9X.2.1.1.m1.2.2"><eq id="S4.E9X.2.1.1.m1.2.2.2.cmml" xref="S4.E9X.2.1.1.m1.2.2.2"></eq><apply id="S4.E9X.2.1.1.m1.2.2.1.cmml" xref="S4.E9X.2.1.1.m1.2.2.1"><times id="S4.E9X.2.1.1.m1.2.2.1.2.cmml" xref="S4.E9X.2.1.1.m1.2.2.1.2"></times><ci id="S4.E9X.2.1.1.m1.2.2.1.3.cmml" xref="S4.E9X.2.1.1.m1.2.2.1.3">Δ</ci><interval closure="open" id="S4.E9X.2.1.1.m1.2.2.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.2.2.1.1.1"><apply id="S4.E9X.2.1.1.m1.2.2.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9X.2.1.1.m1.2.2.1.1.1.1.1.cmml" xref="S4.E9X.2.1.1.m1.2.2.1.1.1.1">superscript</csymbol><ci id="S4.E9X.2.1.1.m1.2.2.1.1.1.1.2.cmml" xref="S4.E9X.2.1.1.m1.2.2.1.1.1.1.2">𝑥</ci><ci id="S4.E9X.2.1.1.m1.2.2.1.1.1.1.3.cmml" xref="S4.E9X.2.1.1.m1.2.2.1.1.1.1.3">𝑙</ci></apply><ci id="S4.E9X.2.1.1.m1.1.1.cmml" xref="S4.E9X.2.1.1.m1.1.1">𝐹</ci></interval></apply><csymbol cd="latexml" id="S4.E9X.2.1.1.m1.2.2.3.cmml" xref="S4.E9X.2.1.1.m1.2.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9X.2.1.1.m1.2c">\displaystyle\Delta(x^{l},F)=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E9X.3.2.2.m1.2" class="ltx_Math" alttext="\displaystyle D(F(g^{l}),F(g^{l}+\xi r_{adv}))" display="inline"><semantics id="S4.E9X.3.2.2.m1.2a"><mrow id="S4.E9X.3.2.2.m1.2.2" xref="S4.E9X.3.2.2.m1.2.2.cmml"><mi id="S4.E9X.3.2.2.m1.2.2.4" xref="S4.E9X.3.2.2.m1.2.2.4.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.E9X.3.2.2.m1.2.2.3" xref="S4.E9X.3.2.2.m1.2.2.3.cmml">​</mo><mrow id="S4.E9X.3.2.2.m1.2.2.2.2" xref="S4.E9X.3.2.2.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.E9X.3.2.2.m1.2.2.2.2.3" xref="S4.E9X.3.2.2.m1.2.2.2.3.cmml">(</mo><mrow id="S4.E9X.3.2.2.m1.1.1.1.1.1" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.cmml"><mi id="S4.E9X.3.2.2.m1.1.1.1.1.1.3" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.E9X.3.2.2.m1.1.1.1.1.1.2" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.2" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.2" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml">g</mi><mi id="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.3" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.3" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9X.3.2.2.m1.2.2.2.2.4" xref="S4.E9X.3.2.2.m1.2.2.2.3.cmml">,</mo><mrow id="S4.E9X.3.2.2.m1.2.2.2.2.2" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.cmml"><mi id="S4.E9X.3.2.2.m1.2.2.2.2.2.3" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.E9X.3.2.2.m1.2.2.2.2.2.2" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.2.cmml">​</mo><mrow id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.2" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.cmml"><msup id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.cmml"><mi id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.2" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.2.cmml">g</mi><mi id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.3" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.3.cmml">l</mi></msup><mo id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.1" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.1.cmml">+</mo><mrow id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.2" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.2.cmml">ξ</mi><mo lspace="0em" rspace="0em" id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.1" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.1.cmml">​</mo><msub id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.cmml"><mi id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.2" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.2.cmml">r</mi><mrow id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.cmml"><mi id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.2" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.1" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.3" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.1a" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.1.cmml">​</mo><mi id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.4" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.4.cmml">v</mi></mrow></msub></mrow></mrow><mo stretchy="false" id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.3" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E9X.3.2.2.m1.2.2.2.2.5" xref="S4.E9X.3.2.2.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9X.3.2.2.m1.2b"><apply id="S4.E9X.3.2.2.m1.2.2.cmml" xref="S4.E9X.3.2.2.m1.2.2"><times id="S4.E9X.3.2.2.m1.2.2.3.cmml" xref="S4.E9X.3.2.2.m1.2.2.3"></times><ci id="S4.E9X.3.2.2.m1.2.2.4.cmml" xref="S4.E9X.3.2.2.m1.2.2.4">𝐷</ci><interval closure="open" id="S4.E9X.3.2.2.m1.2.2.2.3.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2"><apply id="S4.E9X.3.2.2.m1.1.1.1.1.1.cmml" xref="S4.E9X.3.2.2.m1.1.1.1.1.1"><times id="S4.E9X.3.2.2.m1.1.1.1.1.1.2.cmml" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.2"></times><ci id="S4.E9X.3.2.2.m1.1.1.1.1.1.3.cmml" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.3">𝐹</ci><apply id="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.2">𝑔</ci><ci id="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9X.3.2.2.m1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.E9X.3.2.2.m1.2.2.2.2.2.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2"><times id="S4.E9X.3.2.2.m1.2.2.2.2.2.2.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.2"></times><ci id="S4.E9X.3.2.2.m1.2.2.2.2.2.3.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.3">𝐹</ci><apply id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1"><plus id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.1"></plus><apply id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.2">𝑔</ci><ci id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.3.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.2.3">𝑙</ci></apply><apply id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3"><times id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.1.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.1"></times><ci id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.2.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.2">𝜉</ci><apply id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.1.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3">subscript</csymbol><ci id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.2.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.2">𝑟</ci><apply id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3"><times id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.1.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.1"></times><ci id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.2.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.2">𝑎</ci><ci id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.3.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.3">𝑑</ci><ci id="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.4.cmml" xref="S4.E9X.3.2.2.m1.2.2.2.2.2.1.1.1.3.3.3.4">𝑣</ci></apply></apply></apply></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9X.3.2.2.m1.2c">\displaystyle D(F(g^{l}),F(g^{l}+\xi r_{adv}))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(9)</span></td>
</tr>
<tr id="S4.E9Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E9Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle where\;r_{adv}" display="inline"><semantics id="S4.E9Xa.2.1.1.m1.1a"><mrow id="S4.E9Xa.2.1.1.m1.1.1" xref="S4.E9Xa.2.1.1.m1.1.1.cmml"><mi id="S4.E9Xa.2.1.1.m1.1.1.2" xref="S4.E9Xa.2.1.1.m1.1.1.2.cmml">w</mi><mo lspace="0em" rspace="0em" id="S4.E9Xa.2.1.1.m1.1.1.1" xref="S4.E9Xa.2.1.1.m1.1.1.1.cmml">​</mo><mi id="S4.E9Xa.2.1.1.m1.1.1.3" xref="S4.E9Xa.2.1.1.m1.1.1.3.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.E9Xa.2.1.1.m1.1.1.1a" xref="S4.E9Xa.2.1.1.m1.1.1.1.cmml">​</mo><mi id="S4.E9Xa.2.1.1.m1.1.1.4" xref="S4.E9Xa.2.1.1.m1.1.1.4.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E9Xa.2.1.1.m1.1.1.1b" xref="S4.E9Xa.2.1.1.m1.1.1.1.cmml">​</mo><mi id="S4.E9Xa.2.1.1.m1.1.1.5" xref="S4.E9Xa.2.1.1.m1.1.1.5.cmml">r</mi><mo lspace="0em" rspace="0em" id="S4.E9Xa.2.1.1.m1.1.1.1c" xref="S4.E9Xa.2.1.1.m1.1.1.1.cmml">​</mo><mi id="S4.E9Xa.2.1.1.m1.1.1.6" xref="S4.E9Xa.2.1.1.m1.1.1.6.cmml">e</mi><mo lspace="0.280em" rspace="0em" id="S4.E9Xa.2.1.1.m1.1.1.1d" xref="S4.E9Xa.2.1.1.m1.1.1.1.cmml">​</mo><msub id="S4.E9Xa.2.1.1.m1.1.1.7" xref="S4.E9Xa.2.1.1.m1.1.1.7.cmml"><mi id="S4.E9Xa.2.1.1.m1.1.1.7.2" xref="S4.E9Xa.2.1.1.m1.1.1.7.2.cmml">r</mi><mrow id="S4.E9Xa.2.1.1.m1.1.1.7.3" xref="S4.E9Xa.2.1.1.m1.1.1.7.3.cmml"><mi id="S4.E9Xa.2.1.1.m1.1.1.7.3.2" xref="S4.E9Xa.2.1.1.m1.1.1.7.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E9Xa.2.1.1.m1.1.1.7.3.1" xref="S4.E9Xa.2.1.1.m1.1.1.7.3.1.cmml">​</mo><mi id="S4.E9Xa.2.1.1.m1.1.1.7.3.3" xref="S4.E9Xa.2.1.1.m1.1.1.7.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E9Xa.2.1.1.m1.1.1.7.3.1a" xref="S4.E9Xa.2.1.1.m1.1.1.7.3.1.cmml">​</mo><mi id="S4.E9Xa.2.1.1.m1.1.1.7.3.4" xref="S4.E9Xa.2.1.1.m1.1.1.7.3.4.cmml">v</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.E9Xa.2.1.1.m1.1b"><apply id="S4.E9Xa.2.1.1.m1.1.1.cmml" xref="S4.E9Xa.2.1.1.m1.1.1"><times id="S4.E9Xa.2.1.1.m1.1.1.1.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.1"></times><ci id="S4.E9Xa.2.1.1.m1.1.1.2.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.2">𝑤</ci><ci id="S4.E9Xa.2.1.1.m1.1.1.3.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.3">ℎ</ci><ci id="S4.E9Xa.2.1.1.m1.1.1.4.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.4">𝑒</ci><ci id="S4.E9Xa.2.1.1.m1.1.1.5.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.5">𝑟</ci><ci id="S4.E9Xa.2.1.1.m1.1.1.6.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.6">𝑒</ci><apply id="S4.E9Xa.2.1.1.m1.1.1.7.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.7"><csymbol cd="ambiguous" id="S4.E9Xa.2.1.1.m1.1.1.7.1.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.7">subscript</csymbol><ci id="S4.E9Xa.2.1.1.m1.1.1.7.2.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.7.2">𝑟</ci><apply id="S4.E9Xa.2.1.1.m1.1.1.7.3.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.7.3"><times id="S4.E9Xa.2.1.1.m1.1.1.7.3.1.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.7.3.1"></times><ci id="S4.E9Xa.2.1.1.m1.1.1.7.3.2.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.7.3.2">𝑎</ci><ci id="S4.E9Xa.2.1.1.m1.1.1.7.3.3.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.7.3.3">𝑑</ci><ci id="S4.E9Xa.2.1.1.m1.1.1.7.3.4.cmml" xref="S4.E9Xa.2.1.1.m1.1.1.7.3.4">𝑣</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9Xa.2.1.1.m1.1c">\displaystyle where\;r_{adv}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E9Xa.3.2.2.m1.4" class="ltx_Math" alttext="\displaystyle=\operatorname*{arg\,max}_{r;\|r\|\leq\epsilon}D(F(g^{l}),F(g^{l}+r))," display="inline"><semantics id="S4.E9Xa.3.2.2.m1.4a"><mrow id="S4.E9Xa.3.2.2.m1.4.4.1" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.cmml"><mrow id="S4.E9Xa.3.2.2.m1.4.4.1.1" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.cmml"><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.4" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.4.cmml"></mi><mo id="S4.E9Xa.3.2.2.m1.4.4.1.1.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.3.cmml">=</mo><mrow id="S4.E9Xa.3.2.2.m1.4.4.1.1.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.cmml"><mrow id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.cmml"><munder id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.cmml"><mrow id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.cmml"><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.1" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.1.cmml">​</mo><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.3.cmml">max</mi></mrow><mrow id="S4.E9Xa.3.2.2.m1.3.3.3" xref="S4.E9Xa.3.2.2.m1.3.3.3.cmml"><mrow id="S4.E9Xa.3.2.2.m1.3.3.3.3.1" xref="S4.E9Xa.3.2.2.m1.3.3.3.3.2.cmml"><mi id="S4.E9Xa.3.2.2.m1.2.2.2.2" xref="S4.E9Xa.3.2.2.m1.2.2.2.2.cmml">r</mi><mo id="S4.E9Xa.3.2.2.m1.3.3.3.3.1.2" xref="S4.E9Xa.3.2.2.m1.3.3.3.3.2.cmml">;</mo><mrow id="S4.E9Xa.3.2.2.m1.3.3.3.3.1.1.2" xref="S4.E9Xa.3.2.2.m1.3.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.E9Xa.3.2.2.m1.3.3.3.3.1.1.2.1" xref="S4.E9Xa.3.2.2.m1.3.3.3.3.1.1.1.1.cmml">‖</mo><mi id="S4.E9Xa.3.2.2.m1.1.1.1.1" xref="S4.E9Xa.3.2.2.m1.1.1.1.1.cmml">r</mi><mo stretchy="false" id="S4.E9Xa.3.2.2.m1.3.3.3.3.1.1.2.2" xref="S4.E9Xa.3.2.2.m1.3.3.3.3.1.1.1.1.cmml">‖</mo></mrow></mrow><mo id="S4.E9Xa.3.2.2.m1.3.3.3.4" xref="S4.E9Xa.3.2.2.m1.3.3.3.4.cmml">≤</mo><mi id="S4.E9Xa.3.2.2.m1.3.3.3.5" xref="S4.E9Xa.3.2.2.m1.3.3.3.5.cmml">ϵ</mi></mrow></munder><mo id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4a" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.cmml">⁡</mo><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.2.cmml">D</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.3.cmml">​</mo><mrow id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.3.cmml">(</mo><mrow id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">g</mi><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.4" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.3.cmml">,</mo><mrow id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.3.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.2.cmml">​</mo><mrow id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.cmml"><msup id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.cmml"><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.2.cmml">g</mi><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.3.cmml">l</mi></msup><mo id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.1" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.1.cmml">+</mo><mi id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.3.cmml">r</mi></mrow><mo stretchy="false" id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.3" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.5" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E9Xa.3.2.2.m1.4.4.1.2" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9Xa.3.2.2.m1.4b"><apply id="S4.E9Xa.3.2.2.m1.4.4.1.1.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1"><eq id="S4.E9Xa.3.2.2.m1.4.4.1.1.3.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.3"></eq><csymbol cd="latexml" id="S4.E9Xa.3.2.2.m1.4.4.1.1.4.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.4">absent</csymbol><apply id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2"><times id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.3.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.3"></times><apply id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4"><apply id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1"><csymbol cd="ambiguous" id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.1.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1">subscript</csymbol><apply id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2"><times id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.1.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.1"></times><ci id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.2.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.2">arg</ci><ci id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.3.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.1.2.3">max</ci></apply><apply id="S4.E9Xa.3.2.2.m1.3.3.3.cmml" xref="S4.E9Xa.3.2.2.m1.3.3.3"><leq id="S4.E9Xa.3.2.2.m1.3.3.3.4.cmml" xref="S4.E9Xa.3.2.2.m1.3.3.3.4"></leq><list id="S4.E9Xa.3.2.2.m1.3.3.3.3.2.cmml" xref="S4.E9Xa.3.2.2.m1.3.3.3.3.1"><ci id="S4.E9Xa.3.2.2.m1.2.2.2.2.cmml" xref="S4.E9Xa.3.2.2.m1.2.2.2.2">𝑟</ci><apply id="S4.E9Xa.3.2.2.m1.3.3.3.3.1.1.1.cmml" xref="S4.E9Xa.3.2.2.m1.3.3.3.3.1.1.2"><csymbol cd="latexml" id="S4.E9Xa.3.2.2.m1.3.3.3.3.1.1.1.1.cmml" xref="S4.E9Xa.3.2.2.m1.3.3.3.3.1.1.2.1">norm</csymbol><ci id="S4.E9Xa.3.2.2.m1.1.1.1.1.cmml" xref="S4.E9Xa.3.2.2.m1.1.1.1.1">𝑟</ci></apply></list><ci id="S4.E9Xa.3.2.2.m1.3.3.3.5.cmml" xref="S4.E9Xa.3.2.2.m1.3.3.3.5">italic-ϵ</ci></apply></apply><ci id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.2.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.4.2">𝐷</ci></apply><interval closure="open" id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.3.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2"><apply id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1"><times id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.2"></times><ci id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.3">𝐹</ci><apply id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝑔</ci><ci id="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝑙</ci></apply></apply><apply id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2"><times id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.2"></times><ci id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.3.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.3">𝐹</ci><apply id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1"><plus id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.1.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.1"></plus><apply id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2">superscript</csymbol><ci id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.2.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.2">𝑔</ci><ci id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.3.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.2.3">𝑙</ci></apply><ci id="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.3.cmml" xref="S4.E9Xa.3.2.2.m1.4.4.1.1.2.2.2.2.1.1.1.3">𝑟</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9Xa.3.2.2.m1.4c">\displaystyle=\operatorname*{arg\,max}_{r;\|r\|\leq\epsilon}D(F(g^{l}),F(g^{l}+r)),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
</tr>
</tbody>
</table>
<p id="S4.SS2.p1.15" class="ltx_p">where <math id="S4.SS2.p1.7.m1.1" class="ltx_Math" alttext="\epsilon=0.0001" display="inline"><semantics id="S4.SS2.p1.7.m1.1a"><mrow id="S4.SS2.p1.7.m1.1.1" xref="S4.SS2.p1.7.m1.1.1.cmml"><mi id="S4.SS2.p1.7.m1.1.1.2" xref="S4.SS2.p1.7.m1.1.1.2.cmml">ϵ</mi><mo id="S4.SS2.p1.7.m1.1.1.1" xref="S4.SS2.p1.7.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.7.m1.1.1.3" xref="S4.SS2.p1.7.m1.1.1.3.cmml">0.0001</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.7.m1.1b"><apply id="S4.SS2.p1.7.m1.1.1.cmml" xref="S4.SS2.p1.7.m1.1.1"><eq id="S4.SS2.p1.7.m1.1.1.1.cmml" xref="S4.SS2.p1.7.m1.1.1.1"></eq><ci id="S4.SS2.p1.7.m1.1.1.2.cmml" xref="S4.SS2.p1.7.m1.1.1.2">italic-ϵ</ci><cn type="float" id="S4.SS2.p1.7.m1.1.1.3.cmml" xref="S4.SS2.p1.7.m1.1.1.3">0.0001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.7.m1.1c">\epsilon=0.0001</annotation></semantics></math> is a small positive value, <math id="S4.SS2.p1.8.m2.1" class="ltx_Math" alttext="\xi=2.5" display="inline"><semantics id="S4.SS2.p1.8.m2.1a"><mrow id="S4.SS2.p1.8.m2.1.1" xref="S4.SS2.p1.8.m2.1.1.cmml"><mi id="S4.SS2.p1.8.m2.1.1.2" xref="S4.SS2.p1.8.m2.1.1.2.cmml">ξ</mi><mo id="S4.SS2.p1.8.m2.1.1.1" xref="S4.SS2.p1.8.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.8.m2.1.1.3" xref="S4.SS2.p1.8.m2.1.1.3.cmml">2.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.8.m2.1b"><apply id="S4.SS2.p1.8.m2.1.1.cmml" xref="S4.SS2.p1.8.m2.1.1"><eq id="S4.SS2.p1.8.m2.1.1.1.cmml" xref="S4.SS2.p1.8.m2.1.1.1"></eq><ci id="S4.SS2.p1.8.m2.1.1.2.cmml" xref="S4.SS2.p1.8.m2.1.1.2">𝜉</ci><cn type="float" id="S4.SS2.p1.8.m2.1.1.3.cmml" xref="S4.SS2.p1.8.m2.1.1.3">2.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.8.m2.1c">\xi=2.5</annotation></semantics></math> is the step size, <math id="S4.SS2.p1.9.m3.1" class="ltx_Math" alttext="D(\cdot)" display="inline"><semantics id="S4.SS2.p1.9.m3.1a"><mrow id="S4.SS2.p1.9.m3.1.2" xref="S4.SS2.p1.9.m3.1.2.cmml"><mi id="S4.SS2.p1.9.m3.1.2.2" xref="S4.SS2.p1.9.m3.1.2.2.cmml">D</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m3.1.2.1" xref="S4.SS2.p1.9.m3.1.2.1.cmml">​</mo><mrow id="S4.SS2.p1.9.m3.1.2.3.2" xref="S4.SS2.p1.9.m3.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.9.m3.1.2.3.2.1" xref="S4.SS2.p1.9.m3.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS2.p1.9.m3.1.1" xref="S4.SS2.p1.9.m3.1.1.cmml">⋅</mo><mo stretchy="false" id="S4.SS2.p1.9.m3.1.2.3.2.2" xref="S4.SS2.p1.9.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.9.m3.1b"><apply id="S4.SS2.p1.9.m3.1.2.cmml" xref="S4.SS2.p1.9.m3.1.2"><times id="S4.SS2.p1.9.m3.1.2.1.cmml" xref="S4.SS2.p1.9.m3.1.2.1"></times><ci id="S4.SS2.p1.9.m3.1.2.2.cmml" xref="S4.SS2.p1.9.m3.1.2.2">𝐷</ci><ci id="S4.SS2.p1.9.m3.1.1.cmml" xref="S4.SS2.p1.9.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.9.m3.1c">D(\cdot)</annotation></semantics></math> can be KL divergence for classification or Euclidean distance for regression <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite>. Eq. (<a href="#S4.E9" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) measures the discrepancy between predictions of the molecule with graph <math id="S4.SS2.p1.10.m4.1" class="ltx_Math" alttext="g^{l}" display="inline"><semantics id="S4.SS2.p1.10.m4.1a"><msup id="S4.SS2.p1.10.m4.1.1" xref="S4.SS2.p1.10.m4.1.1.cmml"><mi id="S4.SS2.p1.10.m4.1.1.2" xref="S4.SS2.p1.10.m4.1.1.2.cmml">g</mi><mi id="S4.SS2.p1.10.m4.1.1.3" xref="S4.SS2.p1.10.m4.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.10.m4.1b"><apply id="S4.SS2.p1.10.m4.1.1.cmml" xref="S4.SS2.p1.10.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.10.m4.1.1.1.cmml" xref="S4.SS2.p1.10.m4.1.1">superscript</csymbol><ci id="S4.SS2.p1.10.m4.1.1.2.cmml" xref="S4.SS2.p1.10.m4.1.1.2">𝑔</ci><ci id="S4.SS2.p1.10.m4.1.1.3.cmml" xref="S4.SS2.p1.10.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.10.m4.1c">g^{l}</annotation></semantics></math> and its virtual adversarial neighbor <math id="S4.SS2.p1.11.m5.1" class="ltx_Math" alttext="g^{l}+\xi r_{adv}" display="inline"><semantics id="S4.SS2.p1.11.m5.1a"><mrow id="S4.SS2.p1.11.m5.1.1" xref="S4.SS2.p1.11.m5.1.1.cmml"><msup id="S4.SS2.p1.11.m5.1.1.2" xref="S4.SS2.p1.11.m5.1.1.2.cmml"><mi id="S4.SS2.p1.11.m5.1.1.2.2" xref="S4.SS2.p1.11.m5.1.1.2.2.cmml">g</mi><mi id="S4.SS2.p1.11.m5.1.1.2.3" xref="S4.SS2.p1.11.m5.1.1.2.3.cmml">l</mi></msup><mo id="S4.SS2.p1.11.m5.1.1.1" xref="S4.SS2.p1.11.m5.1.1.1.cmml">+</mo><mrow id="S4.SS2.p1.11.m5.1.1.3" xref="S4.SS2.p1.11.m5.1.1.3.cmml"><mi id="S4.SS2.p1.11.m5.1.1.3.2" xref="S4.SS2.p1.11.m5.1.1.3.2.cmml">ξ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.11.m5.1.1.3.1" xref="S4.SS2.p1.11.m5.1.1.3.1.cmml">​</mo><msub id="S4.SS2.p1.11.m5.1.1.3.3" xref="S4.SS2.p1.11.m5.1.1.3.3.cmml"><mi id="S4.SS2.p1.11.m5.1.1.3.3.2" xref="S4.SS2.p1.11.m5.1.1.3.3.2.cmml">r</mi><mrow id="S4.SS2.p1.11.m5.1.1.3.3.3" xref="S4.SS2.p1.11.m5.1.1.3.3.3.cmml"><mi id="S4.SS2.p1.11.m5.1.1.3.3.3.2" xref="S4.SS2.p1.11.m5.1.1.3.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.11.m5.1.1.3.3.3.1" xref="S4.SS2.p1.11.m5.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.11.m5.1.1.3.3.3.3" xref="S4.SS2.p1.11.m5.1.1.3.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.11.m5.1.1.3.3.3.1a" xref="S4.SS2.p1.11.m5.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.11.m5.1.1.3.3.3.4" xref="S4.SS2.p1.11.m5.1.1.3.3.3.4.cmml">v</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.11.m5.1b"><apply id="S4.SS2.p1.11.m5.1.1.cmml" xref="S4.SS2.p1.11.m5.1.1"><plus id="S4.SS2.p1.11.m5.1.1.1.cmml" xref="S4.SS2.p1.11.m5.1.1.1"></plus><apply id="S4.SS2.p1.11.m5.1.1.2.cmml" xref="S4.SS2.p1.11.m5.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m5.1.1.2.1.cmml" xref="S4.SS2.p1.11.m5.1.1.2">superscript</csymbol><ci id="S4.SS2.p1.11.m5.1.1.2.2.cmml" xref="S4.SS2.p1.11.m5.1.1.2.2">𝑔</ci><ci id="S4.SS2.p1.11.m5.1.1.2.3.cmml" xref="S4.SS2.p1.11.m5.1.1.2.3">𝑙</ci></apply><apply id="S4.SS2.p1.11.m5.1.1.3.cmml" xref="S4.SS2.p1.11.m5.1.1.3"><times id="S4.SS2.p1.11.m5.1.1.3.1.cmml" xref="S4.SS2.p1.11.m5.1.1.3.1"></times><ci id="S4.SS2.p1.11.m5.1.1.3.2.cmml" xref="S4.SS2.p1.11.m5.1.1.3.2">𝜉</ci><apply id="S4.SS2.p1.11.m5.1.1.3.3.cmml" xref="S4.SS2.p1.11.m5.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.11.m5.1.1.3.3.1.cmml" xref="S4.SS2.p1.11.m5.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p1.11.m5.1.1.3.3.2.cmml" xref="S4.SS2.p1.11.m5.1.1.3.3.2">𝑟</ci><apply id="S4.SS2.p1.11.m5.1.1.3.3.3.cmml" xref="S4.SS2.p1.11.m5.1.1.3.3.3"><times id="S4.SS2.p1.11.m5.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.11.m5.1.1.3.3.3.1"></times><ci id="S4.SS2.p1.11.m5.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.11.m5.1.1.3.3.3.2">𝑎</ci><ci id="S4.SS2.p1.11.m5.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.11.m5.1.1.3.3.3.3">𝑑</ci><ci id="S4.SS2.p1.11.m5.1.1.3.3.3.4.cmml" xref="S4.SS2.p1.11.m5.1.1.3.3.3.4">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.11.m5.1c">g^{l}+\xi r_{adv}</annotation></semantics></math>. Eq. (<a href="#S4.E9" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) generates a virtual adversarial neighbor <math id="S4.SS2.p1.12.m6.1" class="ltx_Math" alttext="g^{l}+\xi r_{adv}" display="inline"><semantics id="S4.SS2.p1.12.m6.1a"><mrow id="S4.SS2.p1.12.m6.1.1" xref="S4.SS2.p1.12.m6.1.1.cmml"><msup id="S4.SS2.p1.12.m6.1.1.2" xref="S4.SS2.p1.12.m6.1.1.2.cmml"><mi id="S4.SS2.p1.12.m6.1.1.2.2" xref="S4.SS2.p1.12.m6.1.1.2.2.cmml">g</mi><mi id="S4.SS2.p1.12.m6.1.1.2.3" xref="S4.SS2.p1.12.m6.1.1.2.3.cmml">l</mi></msup><mo id="S4.SS2.p1.12.m6.1.1.1" xref="S4.SS2.p1.12.m6.1.1.1.cmml">+</mo><mrow id="S4.SS2.p1.12.m6.1.1.3" xref="S4.SS2.p1.12.m6.1.1.3.cmml"><mi id="S4.SS2.p1.12.m6.1.1.3.2" xref="S4.SS2.p1.12.m6.1.1.3.2.cmml">ξ</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.12.m6.1.1.3.1" xref="S4.SS2.p1.12.m6.1.1.3.1.cmml">​</mo><msub id="S4.SS2.p1.12.m6.1.1.3.3" xref="S4.SS2.p1.12.m6.1.1.3.3.cmml"><mi id="S4.SS2.p1.12.m6.1.1.3.3.2" xref="S4.SS2.p1.12.m6.1.1.3.3.2.cmml">r</mi><mrow id="S4.SS2.p1.12.m6.1.1.3.3.3" xref="S4.SS2.p1.12.m6.1.1.3.3.3.cmml"><mi id="S4.SS2.p1.12.m6.1.1.3.3.3.2" xref="S4.SS2.p1.12.m6.1.1.3.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.12.m6.1.1.3.3.3.1" xref="S4.SS2.p1.12.m6.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.12.m6.1.1.3.3.3.3" xref="S4.SS2.p1.12.m6.1.1.3.3.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.12.m6.1.1.3.3.3.1a" xref="S4.SS2.p1.12.m6.1.1.3.3.3.1.cmml">​</mo><mi id="S4.SS2.p1.12.m6.1.1.3.3.3.4" xref="S4.SS2.p1.12.m6.1.1.3.3.3.4.cmml">v</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.12.m6.1b"><apply id="S4.SS2.p1.12.m6.1.1.cmml" xref="S4.SS2.p1.12.m6.1.1"><plus id="S4.SS2.p1.12.m6.1.1.1.cmml" xref="S4.SS2.p1.12.m6.1.1.1"></plus><apply id="S4.SS2.p1.12.m6.1.1.2.cmml" xref="S4.SS2.p1.12.m6.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m6.1.1.2.1.cmml" xref="S4.SS2.p1.12.m6.1.1.2">superscript</csymbol><ci id="S4.SS2.p1.12.m6.1.1.2.2.cmml" xref="S4.SS2.p1.12.m6.1.1.2.2">𝑔</ci><ci id="S4.SS2.p1.12.m6.1.1.2.3.cmml" xref="S4.SS2.p1.12.m6.1.1.2.3">𝑙</ci></apply><apply id="S4.SS2.p1.12.m6.1.1.3.cmml" xref="S4.SS2.p1.12.m6.1.1.3"><times id="S4.SS2.p1.12.m6.1.1.3.1.cmml" xref="S4.SS2.p1.12.m6.1.1.3.1"></times><ci id="S4.SS2.p1.12.m6.1.1.3.2.cmml" xref="S4.SS2.p1.12.m6.1.1.3.2">𝜉</ci><apply id="S4.SS2.p1.12.m6.1.1.3.3.cmml" xref="S4.SS2.p1.12.m6.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.12.m6.1.1.3.3.1.cmml" xref="S4.SS2.p1.12.m6.1.1.3.3">subscript</csymbol><ci id="S4.SS2.p1.12.m6.1.1.3.3.2.cmml" xref="S4.SS2.p1.12.m6.1.1.3.3.2">𝑟</ci><apply id="S4.SS2.p1.12.m6.1.1.3.3.3.cmml" xref="S4.SS2.p1.12.m6.1.1.3.3.3"><times id="S4.SS2.p1.12.m6.1.1.3.3.3.1.cmml" xref="S4.SS2.p1.12.m6.1.1.3.3.3.1"></times><ci id="S4.SS2.p1.12.m6.1.1.3.3.3.2.cmml" xref="S4.SS2.p1.12.m6.1.1.3.3.3.2">𝑎</ci><ci id="S4.SS2.p1.12.m6.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.12.m6.1.1.3.3.3.3">𝑑</ci><ci id="S4.SS2.p1.12.m6.1.1.3.3.3.4.cmml" xref="S4.SS2.p1.12.m6.1.1.3.3.3.4">𝑣</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.12.m6.1c">g^{l}+\xi r_{adv}</annotation></semantics></math> that is similar to <math id="S4.SS2.p1.13.m7.1" class="ltx_Math" alttext="g^{l}" display="inline"><semantics id="S4.SS2.p1.13.m7.1a"><msup id="S4.SS2.p1.13.m7.1.1" xref="S4.SS2.p1.13.m7.1.1.cmml"><mi id="S4.SS2.p1.13.m7.1.1.2" xref="S4.SS2.p1.13.m7.1.1.2.cmml">g</mi><mi id="S4.SS2.p1.13.m7.1.1.3" xref="S4.SS2.p1.13.m7.1.1.3.cmml">l</mi></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.13.m7.1b"><apply id="S4.SS2.p1.13.m7.1.1.cmml" xref="S4.SS2.p1.13.m7.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.13.m7.1.1.1.cmml" xref="S4.SS2.p1.13.m7.1.1">superscript</csymbol><ci id="S4.SS2.p1.13.m7.1.1.2.cmml" xref="S4.SS2.p1.13.m7.1.1.2">𝑔</ci><ci id="S4.SS2.p1.13.m7.1.1.3.cmml" xref="S4.SS2.p1.13.m7.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.13.m7.1c">g^{l}</annotation></semantics></math> (since <math id="S4.SS2.p1.14.m8.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS2.p1.14.m8.1a"><mi id="S4.SS2.p1.14.m8.1.1" xref="S4.SS2.p1.14.m8.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.14.m8.1b"><ci id="S4.SS2.p1.14.m8.1.1.cmml" xref="S4.SS2.p1.14.m8.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.14.m8.1c">\epsilon</annotation></semantics></math> is small) but with most different prediction. We optimize <math id="S4.SS2.p1.15.m9.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS2.p1.15.m9.1a"><mi id="S4.SS2.p1.15.m9.1.1" xref="S4.SS2.p1.15.m9.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.15.m9.1b"><ci id="S4.SS2.p1.15.m9.1.1.cmml" xref="S4.SS2.p1.15.m9.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.15.m9.1c">r</annotation></semantics></math> on the positions for QM9 and vertex features for other datasets. We omit detail steps for optimizing Eq. (<a href="#S4.E9" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>), and please refer to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> for detail. We jointly use the loss value and the discrepancy defined in Eq. (<a href="#S4.E9" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>), and obtain</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E10.m1.2" class="ltx_math_unparsed" alttext="\phi_{+}(x^{l},F)=\mathcal{L}(\hat{y}^{l},y^{l})+\lambda\Delta(x^{l},F))," display="block"><semantics id="S4.E10.m1.2a"><mrow id="S4.E10.m1.2b"><msub id="S4.E10.m1.2.3"><mi id="S4.E10.m1.2.3.2">ϕ</mi><mo id="S4.E10.m1.2.3.3">+</mo></msub><mrow id="S4.E10.m1.2.4"><mo stretchy="false" id="S4.E10.m1.2.4.1">(</mo><msup id="S4.E10.m1.2.4.2"><mi id="S4.E10.m1.2.4.2.2">x</mi><mi id="S4.E10.m1.2.4.2.3">l</mi></msup><mo id="S4.E10.m1.2.4.3">,</mo><mi id="S4.E10.m1.1.1">F</mi><mo stretchy="false" id="S4.E10.m1.2.4.4">)</mo></mrow><mo id="S4.E10.m1.2.5">=</mo><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.2.6">ℒ</mi><mrow id="S4.E10.m1.2.7"><mo stretchy="false" id="S4.E10.m1.2.7.1">(</mo><msup id="S4.E10.m1.2.7.2"><mover accent="true" id="S4.E10.m1.2.7.2.2"><mi id="S4.E10.m1.2.7.2.2.2">y</mi><mo id="S4.E10.m1.2.7.2.2.1">^</mo></mover><mi id="S4.E10.m1.2.7.2.3">l</mi></msup><mo id="S4.E10.m1.2.7.3">,</mo><msup id="S4.E10.m1.2.7.4"><mi id="S4.E10.m1.2.7.4.2">y</mi><mi id="S4.E10.m1.2.7.4.3">l</mi></msup><mo stretchy="false" id="S4.E10.m1.2.7.5">)</mo></mrow><mo id="S4.E10.m1.2.8">+</mo><mi id="S4.E10.m1.2.9">λ</mi><mi mathvariant="normal" id="S4.E10.m1.2.10">Δ</mi><mrow id="S4.E10.m1.2.11"><mo stretchy="false" id="S4.E10.m1.2.11.1">(</mo><msup id="S4.E10.m1.2.11.2"><mi id="S4.E10.m1.2.11.2.2">x</mi><mi id="S4.E10.m1.2.11.2.3">l</mi></msup><mo id="S4.E10.m1.2.11.3">,</mo><mi id="S4.E10.m1.2.2">F</mi><mo stretchy="false" id="S4.E10.m1.2.11.4">)</mo></mrow><mo stretchy="false" id="S4.E10.m1.2.12">)</mo><mo id="S4.E10.m1.2.13">,</mo></mrow><annotation encoding="application/x-tex" id="S4.E10.m1.2c">\phi_{+}(x^{l},F)=\mathcal{L}(\hat{y}^{l},y^{l})+\lambda\Delta(x^{l},F)),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.18" class="ltx_p">where <math id="S4.SS2.p1.16.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S4.SS2.p1.16.m1.1a"><mi id="S4.SS2.p1.16.m1.1.1" xref="S4.SS2.p1.16.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.16.m1.1b"><ci id="S4.SS2.p1.16.m1.1.1.cmml" xref="S4.SS2.p1.16.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.16.m1.1c">\lambda</annotation></semantics></math> is a hyperparameter. By substituting the formulation <math id="S4.SS2.p1.17.m2.1" class="ltx_Math" alttext="\phi_{+}" display="inline"><semantics id="S4.SS2.p1.17.m2.1a"><msub id="S4.SS2.p1.17.m2.1.1" xref="S4.SS2.p1.17.m2.1.1.cmml"><mi id="S4.SS2.p1.17.m2.1.1.2" xref="S4.SS2.p1.17.m2.1.1.2.cmml">ϕ</mi><mo id="S4.SS2.p1.17.m2.1.1.3" xref="S4.SS2.p1.17.m2.1.1.3.cmml">+</mo></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.17.m2.1b"><apply id="S4.SS2.p1.17.m2.1.1.cmml" xref="S4.SS2.p1.17.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.17.m2.1.1.1.cmml" xref="S4.SS2.p1.17.m2.1.1">subscript</csymbol><ci id="S4.SS2.p1.17.m2.1.1.2.cmml" xref="S4.SS2.p1.17.m2.1.1.2">italic-ϕ</ci><plus id="S4.SS2.p1.17.m2.1.1.3.cmml" xref="S4.SS2.p1.17.m2.1.1.3"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.17.m2.1c">\phi_{+}</annotation></semantics></math> into Eq. (<a href="#S4.E7" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>), we obtain <math id="S4.SS2.p1.18.m3.3" class="ltx_Math" alttext="\omega_{+}(x^{l},F^{l},F^{g})" display="inline"><semantics id="S4.SS2.p1.18.m3.3a"><mrow id="S4.SS2.p1.18.m3.3.3" xref="S4.SS2.p1.18.m3.3.3.cmml"><msub id="S4.SS2.p1.18.m3.3.3.5" xref="S4.SS2.p1.18.m3.3.3.5.cmml"><mi id="S4.SS2.p1.18.m3.3.3.5.2" xref="S4.SS2.p1.18.m3.3.3.5.2.cmml">ω</mi><mo id="S4.SS2.p1.18.m3.3.3.5.3" xref="S4.SS2.p1.18.m3.3.3.5.3.cmml">+</mo></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.18.m3.3.3.4" xref="S4.SS2.p1.18.m3.3.3.4.cmml">​</mo><mrow id="S4.SS2.p1.18.m3.3.3.3.3" xref="S4.SS2.p1.18.m3.3.3.3.4.cmml"><mo stretchy="false" id="S4.SS2.p1.18.m3.3.3.3.3.4" xref="S4.SS2.p1.18.m3.3.3.3.4.cmml">(</mo><msup id="S4.SS2.p1.18.m3.1.1.1.1.1" xref="S4.SS2.p1.18.m3.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.18.m3.1.1.1.1.1.2" xref="S4.SS2.p1.18.m3.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS2.p1.18.m3.1.1.1.1.1.3" xref="S4.SS2.p1.18.m3.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.SS2.p1.18.m3.3.3.3.3.5" xref="S4.SS2.p1.18.m3.3.3.3.4.cmml">,</mo><msup id="S4.SS2.p1.18.m3.2.2.2.2.2" xref="S4.SS2.p1.18.m3.2.2.2.2.2.cmml"><mi id="S4.SS2.p1.18.m3.2.2.2.2.2.2" xref="S4.SS2.p1.18.m3.2.2.2.2.2.2.cmml">F</mi><mi id="S4.SS2.p1.18.m3.2.2.2.2.2.3" xref="S4.SS2.p1.18.m3.2.2.2.2.2.3.cmml">l</mi></msup><mo id="S4.SS2.p1.18.m3.3.3.3.3.6" xref="S4.SS2.p1.18.m3.3.3.3.4.cmml">,</mo><msup id="S4.SS2.p1.18.m3.3.3.3.3.3" xref="S4.SS2.p1.18.m3.3.3.3.3.3.cmml"><mi id="S4.SS2.p1.18.m3.3.3.3.3.3.2" xref="S4.SS2.p1.18.m3.3.3.3.3.3.2.cmml">F</mi><mi id="S4.SS2.p1.18.m3.3.3.3.3.3.3" xref="S4.SS2.p1.18.m3.3.3.3.3.3.3.cmml">g</mi></msup><mo stretchy="false" id="S4.SS2.p1.18.m3.3.3.3.3.7" xref="S4.SS2.p1.18.m3.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.18.m3.3b"><apply id="S4.SS2.p1.18.m3.3.3.cmml" xref="S4.SS2.p1.18.m3.3.3"><times id="S4.SS2.p1.18.m3.3.3.4.cmml" xref="S4.SS2.p1.18.m3.3.3.4"></times><apply id="S4.SS2.p1.18.m3.3.3.5.cmml" xref="S4.SS2.p1.18.m3.3.3.5"><csymbol cd="ambiguous" id="S4.SS2.p1.18.m3.3.3.5.1.cmml" xref="S4.SS2.p1.18.m3.3.3.5">subscript</csymbol><ci id="S4.SS2.p1.18.m3.3.3.5.2.cmml" xref="S4.SS2.p1.18.m3.3.3.5.2">𝜔</ci><plus id="S4.SS2.p1.18.m3.3.3.5.3.cmml" xref="S4.SS2.p1.18.m3.3.3.5.3"></plus></apply><vector id="S4.SS2.p1.18.m3.3.3.3.4.cmml" xref="S4.SS2.p1.18.m3.3.3.3.3"><apply id="S4.SS2.p1.18.m3.1.1.1.1.1.cmml" xref="S4.SS2.p1.18.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.18.m3.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.18.m3.1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p1.18.m3.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.18.m3.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS2.p1.18.m3.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.18.m3.1.1.1.1.1.3">𝑙</ci></apply><apply id="S4.SS2.p1.18.m3.2.2.2.2.2.cmml" xref="S4.SS2.p1.18.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS2.p1.18.m3.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.18.m3.2.2.2.2.2">superscript</csymbol><ci id="S4.SS2.p1.18.m3.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.18.m3.2.2.2.2.2.2">𝐹</ci><ci id="S4.SS2.p1.18.m3.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.18.m3.2.2.2.2.2.3">𝑙</ci></apply><apply id="S4.SS2.p1.18.m3.3.3.3.3.3.cmml" xref="S4.SS2.p1.18.m3.3.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS2.p1.18.m3.3.3.3.3.3.1.cmml" xref="S4.SS2.p1.18.m3.3.3.3.3.3">superscript</csymbol><ci id="S4.SS2.p1.18.m3.3.3.3.3.3.2.cmml" xref="S4.SS2.p1.18.m3.3.3.3.3.3.2">𝐹</ci><ci id="S4.SS2.p1.18.m3.3.3.3.3.3.3.cmml" xref="S4.SS2.p1.18.m3.3.3.3.3.3.3">𝑔</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.18.m3.3c">\omega_{+}(x^{l},F^{l},F^{g})</annotation></semantics></math> to measure the uncertainty of the training samples, and accordingly, we obtain FLIT+ by optimizing the objective as</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E11.m1.50" class="ltx_Math" alttext="\begin{split}\mathcal{L}_{FLIT+}{(x^{l})}=(1-\exp(-\omega_{+}(x^{l},F^{l},F^{g})))^{\gamma}(\mathcal{L}(\hat{y}^{l},y^{l})+\Delta(x^{l},F^{l})).\end{split}" display="block"><semantics id="S4.E11.m1.50a"><mtable displaystyle="true" id="S4.E11.m1.50.50.2"><mtr id="S4.E11.m1.50.50.2a"><mtd class="ltx_align_right" columnalign="right" id="S4.E11.m1.50.50.2b"><mrow id="S4.E11.m1.50.50.2.49.49.49.49"><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1"><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.1"><msub id="S4.E11.m1.50.50.2.49.49.49.49.1.1.3"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.cmml">ℒ</mi><mrow id="S4.E11.m1.2.2.2.2.2.2.1" xref="S4.E11.m1.2.2.2.2.2.2.1.cmml"><mrow id="S4.E11.m1.2.2.2.2.2.2.1.2" xref="S4.E11.m1.2.2.2.2.2.2.1.2.cmml"><mi id="S4.E11.m1.2.2.2.2.2.2.1.2.2" xref="S4.E11.m1.2.2.2.2.2.2.1.2.2.cmml">F</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.2.2.1.2.1" xref="S4.E11.m1.2.2.2.2.2.2.1.2.1.cmml">​</mo><mi id="S4.E11.m1.2.2.2.2.2.2.1.2.3" xref="S4.E11.m1.2.2.2.2.2.2.1.2.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.2.2.1.2.1a" xref="S4.E11.m1.2.2.2.2.2.2.1.2.1.cmml">​</mo><mi id="S4.E11.m1.2.2.2.2.2.2.1.2.4" xref="S4.E11.m1.2.2.2.2.2.2.1.2.4.cmml">I</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.2.2.1.2.1b" xref="S4.E11.m1.2.2.2.2.2.2.1.2.1.cmml">​</mo><mi id="S4.E11.m1.2.2.2.2.2.2.1.2.5" xref="S4.E11.m1.2.2.2.2.2.2.1.2.5.cmml">T</mi></mrow><mo id="S4.E11.m1.2.2.2.2.2.2.1.3" xref="S4.E11.m1.2.2.2.2.2.2.1.3.cmml">+</mo></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.50.50.2.49.49.49.49.1.1.2" xref="S4.E11.m1.49.49.1.1.1.cmml">​</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.1.1.1"><mo stretchy="false" id="S4.E11.m1.3.3.3.3.3.3" xref="S4.E11.m1.49.49.1.1.1.cmml">(</mo><msup id="S4.E11.m1.50.50.2.49.49.49.49.1.1.1.1.1"><mi id="S4.E11.m1.4.4.4.4.4.4" xref="S4.E11.m1.4.4.4.4.4.4.cmml">x</mi><mi id="S4.E11.m1.5.5.5.5.5.5.1" xref="S4.E11.m1.5.5.5.5.5.5.1.cmml">l</mi></msup><mo stretchy="false" id="S4.E11.m1.6.6.6.6.6.6" xref="S4.E11.m1.49.49.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.7.7.7.7.7.7" xref="S4.E11.m1.7.7.7.7.7.7.cmml">=</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.3"><msup id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1"><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1"><mo stretchy="false" id="S4.E11.m1.8.8.8.8.8.8" xref="S4.E11.m1.49.49.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1"><mn id="S4.E11.m1.9.9.9.9.9.9" xref="S4.E11.m1.9.9.9.9.9.9.cmml">1</mn><mo id="S4.E11.m1.10.10.10.10.10.10" xref="S4.E11.m1.10.10.10.10.10.10.cmml">−</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1"><mi id="S4.E11.m1.11.11.11.11.11.11" xref="S4.E11.m1.11.11.11.11.11.11.cmml">exp</mi><mo id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1a" xref="S4.E11.m1.49.49.1.1.1.cmml">⁡</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1.1"><mo stretchy="false" id="S4.E11.m1.12.12.12.12.12.12" xref="S4.E11.m1.49.49.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1.1.1"><mo id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1.1.1a" xref="S4.E11.m1.49.49.1.1.1.cmml">−</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1.1.1.3"><msub id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1.1.1.3.5"><mi id="S4.E11.m1.14.14.14.14.14.14" xref="S4.E11.m1.14.14.14.14.14.14.cmml">ω</mi><mo id="S4.E11.m1.15.15.15.15.15.15.1" xref="S4.E11.m1.15.15.15.15.15.15.1.cmml">+</mo></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1.1.1.3.4" xref="S4.E11.m1.49.49.1.1.1.cmml">​</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1.1.1.3.3.3"><mo stretchy="false" id="S4.E11.m1.16.16.16.16.16.16" xref="S4.E11.m1.49.49.1.1.1.cmml">(</mo><msup id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1.1.1.1.1.1.1"><mi id="S4.E11.m1.17.17.17.17.17.17" xref="S4.E11.m1.17.17.17.17.17.17.cmml">x</mi><mi id="S4.E11.m1.18.18.18.18.18.18.1" xref="S4.E11.m1.18.18.18.18.18.18.1.cmml">l</mi></msup><mo id="S4.E11.m1.19.19.19.19.19.19" xref="S4.E11.m1.49.49.1.1.1.cmml">,</mo><msup id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1.1.1.2.2.2.2"><mi id="S4.E11.m1.20.20.20.20.20.20" xref="S4.E11.m1.20.20.20.20.20.20.cmml">F</mi><mi id="S4.E11.m1.21.21.21.21.21.21.1" xref="S4.E11.m1.21.21.21.21.21.21.1.cmml">l</mi></msup><mo id="S4.E11.m1.22.22.22.22.22.22" xref="S4.E11.m1.49.49.1.1.1.cmml">,</mo><msup id="S4.E11.m1.50.50.2.49.49.49.49.1.2.1.1.1.1.1.1.1.1.3.3.3.3"><mi id="S4.E11.m1.23.23.23.23.23.23" xref="S4.E11.m1.23.23.23.23.23.23.cmml">F</mi><mi id="S4.E11.m1.24.24.24.24.24.24.1" xref="S4.E11.m1.24.24.24.24.24.24.1.cmml">g</mi></msup><mo stretchy="false" id="S4.E11.m1.25.25.25.25.25.25" xref="S4.E11.m1.49.49.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E11.m1.26.26.26.26.26.26" xref="S4.E11.m1.49.49.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E11.m1.27.27.27.27.27.27" xref="S4.E11.m1.49.49.1.1.1.cmml">)</mo></mrow><mi id="S4.E11.m1.28.28.28.28.28.28.1" xref="S4.E11.m1.28.28.28.28.28.28.1.cmml">γ</mi></msup><mo lspace="0em" rspace="0em" id="S4.E11.m1.50.50.2.49.49.49.49.1.3.3" xref="S4.E11.m1.49.49.1.1.1.cmml">​</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1"><mo stretchy="false" id="S4.E11.m1.29.29.29.29.29.29" xref="S4.E11.m1.49.49.1.1.1.cmml">(</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1"><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1.2"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.30.30.30.30.30.30" xref="S4.E11.m1.30.30.30.30.30.30.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1.2.3" xref="S4.E11.m1.49.49.1.1.1.cmml">​</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1.2.2.2"><mo stretchy="false" id="S4.E11.m1.31.31.31.31.31.31" xref="S4.E11.m1.49.49.1.1.1.cmml">(</mo><msup id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1.1.1.1.1"><mover accent="true" id="S4.E11.m1.32.32.32.32.32.32" xref="S4.E11.m1.32.32.32.32.32.32.cmml"><mi id="S4.E11.m1.32.32.32.32.32.32.2" xref="S4.E11.m1.32.32.32.32.32.32.2.cmml">y</mi><mo id="S4.E11.m1.32.32.32.32.32.32.1" xref="S4.E11.m1.32.32.32.32.32.32.1.cmml">^</mo></mover><mi id="S4.E11.m1.33.33.33.33.33.33.1" xref="S4.E11.m1.33.33.33.33.33.33.1.cmml">l</mi></msup><mo id="S4.E11.m1.34.34.34.34.34.34" xref="S4.E11.m1.49.49.1.1.1.cmml">,</mo><msup id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1.2.2.2.2"><mi id="S4.E11.m1.35.35.35.35.35.35" xref="S4.E11.m1.35.35.35.35.35.35.cmml">y</mi><mi id="S4.E11.m1.36.36.36.36.36.36.1" xref="S4.E11.m1.36.36.36.36.36.36.1.cmml">l</mi></msup><mo stretchy="false" id="S4.E11.m1.37.37.37.37.37.37" xref="S4.E11.m1.49.49.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.38.38.38.38.38.38" xref="S4.E11.m1.38.38.38.38.38.38.cmml">+</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1.4"><mi mathvariant="normal" id="S4.E11.m1.39.39.39.39.39.39" xref="S4.E11.m1.39.39.39.39.39.39.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1.4.3" xref="S4.E11.m1.49.49.1.1.1.cmml">​</mo><mrow id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1.4.2.2"><mo stretchy="false" id="S4.E11.m1.40.40.40.40.40.40" xref="S4.E11.m1.49.49.1.1.1.cmml">(</mo><msup id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1.3.1.1.1"><mi id="S4.E11.m1.41.41.41.41.41.41" xref="S4.E11.m1.41.41.41.41.41.41.cmml">x</mi><mi id="S4.E11.m1.42.42.42.42.42.42.1" xref="S4.E11.m1.42.42.42.42.42.42.1.cmml">l</mi></msup><mo id="S4.E11.m1.43.43.43.43.43.43" xref="S4.E11.m1.49.49.1.1.1.cmml">,</mo><msup id="S4.E11.m1.50.50.2.49.49.49.49.1.3.2.1.1.4.2.2.2"><mi id="S4.E11.m1.44.44.44.44.44.44" xref="S4.E11.m1.44.44.44.44.44.44.cmml">F</mi><mi id="S4.E11.m1.45.45.45.45.45.45.1" xref="S4.E11.m1.45.45.45.45.45.45.1.cmml">l</mi></msup><mo stretchy="false" id="S4.E11.m1.46.46.46.46.46.46" xref="S4.E11.m1.49.49.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E11.m1.47.47.47.47.47.47" xref="S4.E11.m1.49.49.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S4.E11.m1.48.48.48.48.48.48" xref="S4.E11.m1.49.49.1.1.1.cmml">.</mo></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S4.E11.m1.50b"><apply id="S4.E11.m1.49.49.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><eq id="S4.E11.m1.7.7.7.7.7.7.cmml" xref="S4.E11.m1.7.7.7.7.7.7"></eq><apply id="S4.E11.m1.49.49.1.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><times id="S4.E11.m1.49.49.1.1.1.1.2.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"></times><apply id="S4.E11.m1.49.49.1.1.1.1.3.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.1.3.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1">ℒ</ci><apply id="S4.E11.m1.2.2.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1"><csymbol cd="latexml" id="S4.E11.m1.2.2.2.2.2.2.1.1.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1">limit-from</csymbol><apply id="S4.E11.m1.2.2.2.2.2.2.1.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.2"><times id="S4.E11.m1.2.2.2.2.2.2.1.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.2.1"></times><ci id="S4.E11.m1.2.2.2.2.2.2.1.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.2.2">𝐹</ci><ci id="S4.E11.m1.2.2.2.2.2.2.1.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.2.3">𝐿</ci><ci id="S4.E11.m1.2.2.2.2.2.2.1.2.4.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.2.4">𝐼</ci><ci id="S4.E11.m1.2.2.2.2.2.2.1.2.5.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.2.5">𝑇</ci></apply><plus id="S4.E11.m1.2.2.2.2.2.2.1.3.cmml" xref="S4.E11.m1.2.2.2.2.2.2.1.3"></plus></apply></apply><apply id="S4.E11.m1.49.49.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">superscript</csymbol><ci id="S4.E11.m1.4.4.4.4.4.4.cmml" xref="S4.E11.m1.4.4.4.4.4.4">𝑥</ci><ci id="S4.E11.m1.5.5.5.5.5.5.1.cmml" xref="S4.E11.m1.5.5.5.5.5.5.1">𝑙</ci></apply></apply><apply id="S4.E11.m1.49.49.1.1.1.3.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><times id="S4.E11.m1.49.49.1.1.1.3.3.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"></times><apply id="S4.E11.m1.49.49.1.1.1.2.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.2.1.2.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">superscript</csymbol><apply id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><minus id="S4.E11.m1.10.10.10.10.10.10.cmml" xref="S4.E11.m1.10.10.10.10.10.10"></minus><cn type="integer" id="S4.E11.m1.9.9.9.9.9.9.cmml" xref="S4.E11.m1.9.9.9.9.9.9">1</cn><apply id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.2.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><exp id="S4.E11.m1.11.11.11.11.11.11.cmml" xref="S4.E11.m1.11.11.11.11.11.11"></exp><apply id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><minus id="S4.E11.m1.13.13.13.13.13.13.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"></minus><apply id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><times id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.3.4.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"></times><apply id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.3.5.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.3.5.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">subscript</csymbol><ci id="S4.E11.m1.14.14.14.14.14.14.cmml" xref="S4.E11.m1.14.14.14.14.14.14">𝜔</ci><plus id="S4.E11.m1.15.15.15.15.15.15.1.cmml" xref="S4.E11.m1.15.15.15.15.15.15.1"></plus></apply><vector id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><apply id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">superscript</csymbol><ci id="S4.E11.m1.17.17.17.17.17.17.cmml" xref="S4.E11.m1.17.17.17.17.17.17">𝑥</ci><ci id="S4.E11.m1.18.18.18.18.18.18.1.cmml" xref="S4.E11.m1.18.18.18.18.18.18.1">𝑙</ci></apply><apply id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">superscript</csymbol><ci id="S4.E11.m1.20.20.20.20.20.20.cmml" xref="S4.E11.m1.20.20.20.20.20.20">𝐹</ci><ci id="S4.E11.m1.21.21.21.21.21.21.1.cmml" xref="S4.E11.m1.21.21.21.21.21.21.1">𝑙</ci></apply><apply id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.2.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">superscript</csymbol><ci id="S4.E11.m1.23.23.23.23.23.23.cmml" xref="S4.E11.m1.23.23.23.23.23.23">𝐹</ci><ci id="S4.E11.m1.24.24.24.24.24.24.1.cmml" xref="S4.E11.m1.24.24.24.24.24.24.1">𝑔</ci></apply></vector></apply></apply></apply></apply><ci id="S4.E11.m1.28.28.28.28.28.28.1.cmml" xref="S4.E11.m1.28.28.28.28.28.28.1">𝛾</ci></apply><apply id="S4.E11.m1.49.49.1.1.1.3.2.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><plus id="S4.E11.m1.38.38.38.38.38.38.cmml" xref="S4.E11.m1.38.38.38.38.38.38"></plus><apply id="S4.E11.m1.49.49.1.1.1.3.2.1.1.2.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><times id="S4.E11.m1.49.49.1.1.1.3.2.1.1.2.3.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"></times><ci id="S4.E11.m1.30.30.30.30.30.30.cmml" xref="S4.E11.m1.30.30.30.30.30.30">ℒ</ci><interval closure="open" id="S4.E11.m1.49.49.1.1.1.3.2.1.1.2.2.3.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><apply id="S4.E11.m1.49.49.1.1.1.3.2.1.1.1.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.3.2.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">superscript</csymbol><apply id="S4.E11.m1.32.32.32.32.32.32.cmml" xref="S4.E11.m1.32.32.32.32.32.32"><ci id="S4.E11.m1.32.32.32.32.32.32.1.cmml" xref="S4.E11.m1.32.32.32.32.32.32.1">^</ci><ci id="S4.E11.m1.32.32.32.32.32.32.2.cmml" xref="S4.E11.m1.32.32.32.32.32.32.2">𝑦</ci></apply><ci id="S4.E11.m1.33.33.33.33.33.33.1.cmml" xref="S4.E11.m1.33.33.33.33.33.33.1">𝑙</ci></apply><apply id="S4.E11.m1.49.49.1.1.1.3.2.1.1.2.2.2.2.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.3.2.1.1.2.2.2.2.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">superscript</csymbol><ci id="S4.E11.m1.35.35.35.35.35.35.cmml" xref="S4.E11.m1.35.35.35.35.35.35">𝑦</ci><ci id="S4.E11.m1.36.36.36.36.36.36.1.cmml" xref="S4.E11.m1.36.36.36.36.36.36.1">𝑙</ci></apply></interval></apply><apply id="S4.E11.m1.49.49.1.1.1.3.2.1.1.4.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><times id="S4.E11.m1.49.49.1.1.1.3.2.1.1.4.3.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"></times><ci id="S4.E11.m1.39.39.39.39.39.39.cmml" xref="S4.E11.m1.39.39.39.39.39.39">Δ</ci><interval closure="open" id="S4.E11.m1.49.49.1.1.1.3.2.1.1.4.2.3.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><apply id="S4.E11.m1.49.49.1.1.1.3.2.1.1.3.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.3.2.1.1.3.1.1.1.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">superscript</csymbol><ci id="S4.E11.m1.41.41.41.41.41.41.cmml" xref="S4.E11.m1.41.41.41.41.41.41">𝑥</ci><ci id="S4.E11.m1.42.42.42.42.42.42.1.cmml" xref="S4.E11.m1.42.42.42.42.42.42.1">𝑙</ci></apply><apply id="S4.E11.m1.49.49.1.1.1.3.2.1.1.4.2.2.2.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2"><csymbol cd="ambiguous" id="S4.E11.m1.49.49.1.1.1.3.2.1.1.4.2.2.2.1.cmml" xref="S4.E11.m1.50.50.2.49.49.49.49.1.1.2">superscript</csymbol><ci id="S4.E11.m1.44.44.44.44.44.44.cmml" xref="S4.E11.m1.44.44.44.44.44.44">𝐹</ci><ci id="S4.E11.m1.45.45.45.45.45.45.1.cmml" xref="S4.E11.m1.45.45.45.45.45.45.1">𝑙</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.50c">\begin{split}\mathcal{L}_{FLIT+}{(x^{l})}=(1-\exp(-\omega_{+}(x^{l},F^{l},F^{g})))^{\gamma}(\mathcal{L}(\hat{y}^{l},y^{l})+\Delta(x^{l},F^{l})).\end{split}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS2.p1.20" class="ltx_p">Including <math id="S4.SS2.p1.19.m1.1" class="ltx_math_unparsed" alttext="\Delta(x^{l},F^{l}))" display="inline"><semantics id="S4.SS2.p1.19.m1.1a"><mrow id="S4.SS2.p1.19.m1.1b"><mi mathvariant="normal" id="S4.SS2.p1.19.m1.1.1">Δ</mi><mrow id="S4.SS2.p1.19.m1.1.2"><mo stretchy="false" id="S4.SS2.p1.19.m1.1.2.1">(</mo><msup id="S4.SS2.p1.19.m1.1.2.2"><mi id="S4.SS2.p1.19.m1.1.2.2.2">x</mi><mi id="S4.SS2.p1.19.m1.1.2.2.3">l</mi></msup><mo id="S4.SS2.p1.19.m1.1.2.3">,</mo><msup id="S4.SS2.p1.19.m1.1.2.4"><mi id="S4.SS2.p1.19.m1.1.2.4.2">F</mi><mi id="S4.SS2.p1.19.m1.1.2.4.3">l</mi></msup><mo stretchy="false" id="S4.SS2.p1.19.m1.1.2.5">)</mo></mrow><mo stretchy="false" id="S4.SS2.p1.19.m1.1.3">)</mo></mrow><annotation encoding="application/x-tex" id="S4.SS2.p1.19.m1.1c">\Delta(x^{l},F^{l}))</annotation></semantics></math> in the training objective is essential to make the neighborhood prediction consistency a valid uncertainty measurement. Moreover, in experiments, we notice that federated learning can benefit from the virtual adversarial training alone <span id="S4.SS2.p1.20.1" class="ltx_text ltx_font_italic">i.e.</span> setting <math id="S4.SS2.p1.20.m2.1" class="ltx_Math" alttext="\gamma=0" display="inline"><semantics id="S4.SS2.p1.20.m2.1a"><mrow id="S4.SS2.p1.20.m2.1.1" xref="S4.SS2.p1.20.m2.1.1.cmml"><mi id="S4.SS2.p1.20.m2.1.1.2" xref="S4.SS2.p1.20.m2.1.1.2.cmml">γ</mi><mo id="S4.SS2.p1.20.m2.1.1.1" xref="S4.SS2.p1.20.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.20.m2.1.1.3" xref="S4.SS2.p1.20.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.20.m2.1b"><apply id="S4.SS2.p1.20.m2.1.1.cmml" xref="S4.SS2.p1.20.m2.1.1"><eq id="S4.SS2.p1.20.m2.1.1.1.cmml" xref="S4.SS2.p1.20.m2.1.1.1"></eq><ci id="S4.SS2.p1.20.m2.1.1.2.cmml" xref="S4.SS2.p1.20.m2.1.1.2">𝛾</ci><cn type="integer" id="S4.SS2.p1.20.m2.1.1.3.cmml" xref="S4.SS2.p1.20.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.20.m2.1c">\gamma=0</annotation></semantics></math>. This should be attributed to the fact that virtual adversarial training could improve the generalization ability of the local model and can be regarded as another way to align the local training implicitly. Detailed results and analysis can be found in the experimental section.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">We use FLIT(+) to denote both FLIT and FLIT+. We summarize FLIT(+) for client update in Alg. <a href="#alg2" title="Algorithm 2 ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Implementation Details</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.3" class="ltx_p">Since the scale of <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\omega_{(+)}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.2" xref="S4.SS3.p1.1.m1.1.2.cmml"><mi id="S4.SS3.p1.1.m1.1.2.2" xref="S4.SS3.p1.1.m1.1.2.2.cmml">ω</mi><mrow id="S4.SS3.p1.1.m1.1.1.1.3" xref="S4.SS3.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.1.1.1.3.1" xref="S4.SS3.p1.1.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.1.m1.1.1.1.1" xref="S4.SS3.p1.1.m1.1.1.1.1.cmml">+</mo><mo stretchy="false" id="S4.SS3.p1.1.m1.1.1.1.3.2" xref="S4.SS3.p1.1.m1.1.2.cmml">)</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.2.cmml" xref="S4.SS3.p1.1.m1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.2.1.cmml" xref="S4.SS3.p1.1.m1.1.2">subscript</csymbol><ci id="S4.SS3.p1.1.m1.1.2.2.cmml" xref="S4.SS3.p1.1.m1.1.2.2">𝜔</ci><plus id="S4.SS3.p1.1.m1.1.1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1.1.1"></plus></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\omega_{(+)}</annotation></semantics></math> may vary significantly especially for regression tasks, it is not proper to directly applying Eq. (<a href="#S4.E6" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) and Eq. (<a href="#S4.E11" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>) for general tasks. We propose to normalize the <math id="S4.SS3.p1.2.m2.2" class="ltx_Math" alttext="\omega_{(+)}(\cdot)" display="inline"><semantics id="S4.SS3.p1.2.m2.2a"><mrow id="S4.SS3.p1.2.m2.2.3" xref="S4.SS3.p1.2.m2.2.3.cmml"><msub id="S4.SS3.p1.2.m2.2.3.2" xref="S4.SS3.p1.2.m2.2.3.2.cmml"><mi id="S4.SS3.p1.2.m2.2.3.2.2" xref="S4.SS3.p1.2.m2.2.3.2.2.cmml">ω</mi><mrow id="S4.SS3.p1.2.m2.1.1.1.3" xref="S4.SS3.p1.2.m2.2.3.2.cmml"><mo stretchy="false" id="S4.SS3.p1.2.m2.1.1.1.3.1" xref="S4.SS3.p1.2.m2.2.3.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.1.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.1.cmml">+</mo><mo stretchy="false" id="S4.SS3.p1.2.m2.1.1.1.3.2" xref="S4.SS3.p1.2.m2.2.3.2.cmml">)</mo></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.2.3.1" xref="S4.SS3.p1.2.m2.2.3.1.cmml">​</mo><mrow id="S4.SS3.p1.2.m2.2.3.3.2" xref="S4.SS3.p1.2.m2.2.3.cmml"><mo stretchy="false" id="S4.SS3.p1.2.m2.2.3.3.2.1" xref="S4.SS3.p1.2.m2.2.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.2.m2.2.2" xref="S4.SS3.p1.2.m2.2.2.cmml">⋅</mo><mo stretchy="false" id="S4.SS3.p1.2.m2.2.3.3.2.2" xref="S4.SS3.p1.2.m2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.2b"><apply id="S4.SS3.p1.2.m2.2.3.cmml" xref="S4.SS3.p1.2.m2.2.3"><times id="S4.SS3.p1.2.m2.2.3.1.cmml" xref="S4.SS3.p1.2.m2.2.3.1"></times><apply id="S4.SS3.p1.2.m2.2.3.2.cmml" xref="S4.SS3.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.2.3.2.1.cmml" xref="S4.SS3.p1.2.m2.2.3.2">subscript</csymbol><ci id="S4.SS3.p1.2.m2.2.3.2.2.cmml" xref="S4.SS3.p1.2.m2.2.3.2.2">𝜔</ci><plus id="S4.SS3.p1.2.m2.1.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1.1"></plus></apply><ci id="S4.SS3.p1.2.m2.2.2.cmml" xref="S4.SS3.p1.2.m2.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.2c">\omega_{(+)}(\cdot)</annotation></semantics></math> by its moving average as <math id="S4.SS3.p1.3.m3.3" class="ltx_Math" alttext="\omega_{(+)}\leftarrow\frac{\omega_{(+)}}{\bar{\omega}_{(+)}}" display="inline"><semantics id="S4.SS3.p1.3.m3.3a"><mrow id="S4.SS3.p1.3.m3.3.4" xref="S4.SS3.p1.3.m3.3.4.cmml"><msub id="S4.SS3.p1.3.m3.3.4.2" xref="S4.SS3.p1.3.m3.3.4.2.cmml"><mi id="S4.SS3.p1.3.m3.3.4.2.2" xref="S4.SS3.p1.3.m3.3.4.2.2.cmml">ω</mi><mrow id="S4.SS3.p1.3.m3.1.1.1.3" xref="S4.SS3.p1.3.m3.3.4.2.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m3.1.1.1.3.1" xref="S4.SS3.p1.3.m3.3.4.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.1.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.1.cmml">+</mo><mo stretchy="false" id="S4.SS3.p1.3.m3.1.1.1.3.2" xref="S4.SS3.p1.3.m3.3.4.2.cmml">)</mo></mrow></msub><mo stretchy="false" id="S4.SS3.p1.3.m3.3.4.1" xref="S4.SS3.p1.3.m3.3.4.1.cmml">←</mo><mfrac id="S4.SS3.p1.3.m3.3.3" xref="S4.SS3.p1.3.m3.3.3.cmml"><msub id="S4.SS3.p1.3.m3.2.2.1" xref="S4.SS3.p1.3.m3.2.2.1.cmml"><mi id="S4.SS3.p1.3.m3.2.2.1.3" xref="S4.SS3.p1.3.m3.2.2.1.3.cmml">ω</mi><mrow id="S4.SS3.p1.3.m3.2.2.1.1.1.3" xref="S4.SS3.p1.3.m3.2.2.1.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m3.2.2.1.1.1.3.1" xref="S4.SS3.p1.3.m3.2.2.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.2.2.1.1.1.1" xref="S4.SS3.p1.3.m3.2.2.1.1.1.1.cmml">+</mo><mo stretchy="false" id="S4.SS3.p1.3.m3.2.2.1.1.1.3.2" xref="S4.SS3.p1.3.m3.2.2.1.cmml">)</mo></mrow></msub><msub id="S4.SS3.p1.3.m3.3.3.2" xref="S4.SS3.p1.3.m3.3.3.2.cmml"><mover accent="true" id="S4.SS3.p1.3.m3.3.3.2.3" xref="S4.SS3.p1.3.m3.3.3.2.3.cmml"><mi id="S4.SS3.p1.3.m3.3.3.2.3.2" xref="S4.SS3.p1.3.m3.3.3.2.3.2.cmml">ω</mi><mo id="S4.SS3.p1.3.m3.3.3.2.3.1" xref="S4.SS3.p1.3.m3.3.3.2.3.1.cmml">¯</mo></mover><mrow id="S4.SS3.p1.3.m3.3.3.2.1.1.3" xref="S4.SS3.p1.3.m3.3.3.2.cmml"><mo stretchy="false" id="S4.SS3.p1.3.m3.3.3.2.1.1.3.1" xref="S4.SS3.p1.3.m3.3.3.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.SS3.p1.3.m3.3.3.2.1.1.1" xref="S4.SS3.p1.3.m3.3.3.2.1.1.1.cmml">+</mo><mo stretchy="false" id="S4.SS3.p1.3.m3.3.3.2.1.1.3.2" xref="S4.SS3.p1.3.m3.3.3.2.cmml">)</mo></mrow></msub></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.3b"><apply id="S4.SS3.p1.3.m3.3.4.cmml" xref="S4.SS3.p1.3.m3.3.4"><ci id="S4.SS3.p1.3.m3.3.4.1.cmml" xref="S4.SS3.p1.3.m3.3.4.1">←</ci><apply id="S4.SS3.p1.3.m3.3.4.2.cmml" xref="S4.SS3.p1.3.m3.3.4.2"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.3.4.2.1.cmml" xref="S4.SS3.p1.3.m3.3.4.2">subscript</csymbol><ci id="S4.SS3.p1.3.m3.3.4.2.2.cmml" xref="S4.SS3.p1.3.m3.3.4.2.2">𝜔</ci><plus id="S4.SS3.p1.3.m3.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1.1.1"></plus></apply><apply id="S4.SS3.p1.3.m3.3.3.cmml" xref="S4.SS3.p1.3.m3.3.3"><divide id="S4.SS3.p1.3.m3.3.3.3.cmml" xref="S4.SS3.p1.3.m3.3.3"></divide><apply id="S4.SS3.p1.3.m3.2.2.1.cmml" xref="S4.SS3.p1.3.m3.2.2.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.2.2.1.2.cmml" xref="S4.SS3.p1.3.m3.2.2.1">subscript</csymbol><ci id="S4.SS3.p1.3.m3.2.2.1.3.cmml" xref="S4.SS3.p1.3.m3.2.2.1.3">𝜔</ci><plus id="S4.SS3.p1.3.m3.2.2.1.1.1.1.cmml" xref="S4.SS3.p1.3.m3.2.2.1.1.1.1"></plus></apply><apply id="S4.SS3.p1.3.m3.3.3.2.cmml" xref="S4.SS3.p1.3.m3.3.3.2"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.3.3.2.2.cmml" xref="S4.SS3.p1.3.m3.3.3.2">subscript</csymbol><apply id="S4.SS3.p1.3.m3.3.3.2.3.cmml" xref="S4.SS3.p1.3.m3.3.3.2.3"><ci id="S4.SS3.p1.3.m3.3.3.2.3.1.cmml" xref="S4.SS3.p1.3.m3.3.3.2.3.1">¯</ci><ci id="S4.SS3.p1.3.m3.3.3.2.3.2.cmml" xref="S4.SS3.p1.3.m3.3.3.2.3.2">𝜔</ci></apply><plus id="S4.SS3.p1.3.m3.3.3.2.1.1.1.cmml" xref="S4.SS3.p1.3.m3.3.3.2.1.1.1"></plus></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.3c">\omega_{(+)}\leftarrow\frac{\omega_{(+)}}{\bar{\omega}_{(+)}}</annotation></semantics></math>, where</p>
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math id="S4.E12.m1.4" class="ltx_Math" alttext="\bar{\omega}_{(+)}\leftarrow\beta\bar{\omega}_{(+)}+(1-\beta)\frac{1}{B}\sum_{i}{\omega}_{(+)}" display="block"><semantics id="S4.E12.m1.4a"><mrow id="S4.E12.m1.4.4" xref="S4.E12.m1.4.4.cmml"><msub id="S4.E12.m1.4.4.3" xref="S4.E12.m1.4.4.3.cmml"><mover accent="true" id="S4.E12.m1.4.4.3.2" xref="S4.E12.m1.4.4.3.2.cmml"><mi id="S4.E12.m1.4.4.3.2.2" xref="S4.E12.m1.4.4.3.2.2.cmml">ω</mi><mo id="S4.E12.m1.4.4.3.2.1" xref="S4.E12.m1.4.4.3.2.1.cmml">¯</mo></mover><mrow id="S4.E12.m1.1.1.1.3" xref="S4.E12.m1.4.4.3.cmml"><mo stretchy="false" id="S4.E12.m1.1.1.1.3.1" xref="S4.E12.m1.4.4.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml">+</mo><mo stretchy="false" id="S4.E12.m1.1.1.1.3.2" xref="S4.E12.m1.4.4.3.cmml">)</mo></mrow></msub><mo stretchy="false" id="S4.E12.m1.4.4.2" xref="S4.E12.m1.4.4.2.cmml">←</mo><mrow id="S4.E12.m1.4.4.1" xref="S4.E12.m1.4.4.1.cmml"><mrow id="S4.E12.m1.4.4.1.3" xref="S4.E12.m1.4.4.1.3.cmml"><mi id="S4.E12.m1.4.4.1.3.2" xref="S4.E12.m1.4.4.1.3.2.cmml">β</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.4.4.1.3.1" xref="S4.E12.m1.4.4.1.3.1.cmml">​</mo><msub id="S4.E12.m1.4.4.1.3.3" xref="S4.E12.m1.4.4.1.3.3.cmml"><mover accent="true" id="S4.E12.m1.4.4.1.3.3.2" xref="S4.E12.m1.4.4.1.3.3.2.cmml"><mi id="S4.E12.m1.4.4.1.3.3.2.2" xref="S4.E12.m1.4.4.1.3.3.2.2.cmml">ω</mi><mo id="S4.E12.m1.4.4.1.3.3.2.1" xref="S4.E12.m1.4.4.1.3.3.2.1.cmml">¯</mo></mover><mrow id="S4.E12.m1.2.2.1.3" xref="S4.E12.m1.4.4.1.3.3.cmml"><mo stretchy="false" id="S4.E12.m1.2.2.1.3.1" xref="S4.E12.m1.4.4.1.3.3.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.E12.m1.2.2.1.1" xref="S4.E12.m1.2.2.1.1.cmml">+</mo><mo stretchy="false" id="S4.E12.m1.2.2.1.3.2" xref="S4.E12.m1.4.4.1.3.3.cmml">)</mo></mrow></msub></mrow><mo id="S4.E12.m1.4.4.1.2" xref="S4.E12.m1.4.4.1.2.cmml">+</mo><mrow id="S4.E12.m1.4.4.1.1" xref="S4.E12.m1.4.4.1.1.cmml"><mrow id="S4.E12.m1.4.4.1.1.1.1" xref="S4.E12.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E12.m1.4.4.1.1.1.1.2" xref="S4.E12.m1.4.4.1.1.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.4.4.1.1.1.1.1" xref="S4.E12.m1.4.4.1.1.1.1.1.cmml"><mn id="S4.E12.m1.4.4.1.1.1.1.1.2" xref="S4.E12.m1.4.4.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E12.m1.4.4.1.1.1.1.1.1" xref="S4.E12.m1.4.4.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E12.m1.4.4.1.1.1.1.1.3" xref="S4.E12.m1.4.4.1.1.1.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="S4.E12.m1.4.4.1.1.1.1.3" xref="S4.E12.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E12.m1.4.4.1.1.2" xref="S4.E12.m1.4.4.1.1.2.cmml">​</mo><mfrac id="S4.E12.m1.4.4.1.1.3" xref="S4.E12.m1.4.4.1.1.3.cmml"><mn id="S4.E12.m1.4.4.1.1.3.2" xref="S4.E12.m1.4.4.1.1.3.2.cmml">1</mn><mi id="S4.E12.m1.4.4.1.1.3.3" xref="S4.E12.m1.4.4.1.1.3.3.cmml">B</mi></mfrac><mo lspace="0em" rspace="0em" id="S4.E12.m1.4.4.1.1.2a" xref="S4.E12.m1.4.4.1.1.2.cmml">​</mo><mrow id="S4.E12.m1.4.4.1.1.4" xref="S4.E12.m1.4.4.1.1.4.cmml"><munder id="S4.E12.m1.4.4.1.1.4.1" xref="S4.E12.m1.4.4.1.1.4.1.cmml"><mo movablelimits="false" id="S4.E12.m1.4.4.1.1.4.1.2" xref="S4.E12.m1.4.4.1.1.4.1.2.cmml">∑</mo><mi id="S4.E12.m1.4.4.1.1.4.1.3" xref="S4.E12.m1.4.4.1.1.4.1.3.cmml">i</mi></munder><msub id="S4.E12.m1.4.4.1.1.4.2" xref="S4.E12.m1.4.4.1.1.4.2.cmml"><mi id="S4.E12.m1.4.4.1.1.4.2.2" xref="S4.E12.m1.4.4.1.1.4.2.2.cmml">ω</mi><mrow id="S4.E12.m1.3.3.1.3" xref="S4.E12.m1.4.4.1.1.4.2.cmml"><mo stretchy="false" id="S4.E12.m1.3.3.1.3.1" xref="S4.E12.m1.4.4.1.1.4.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S4.E12.m1.3.3.1.1" xref="S4.E12.m1.3.3.1.1.cmml">+</mo><mo stretchy="false" id="S4.E12.m1.3.3.1.3.2" xref="S4.E12.m1.4.4.1.1.4.2.cmml">)</mo></mrow></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.4b"><apply id="S4.E12.m1.4.4.cmml" xref="S4.E12.m1.4.4"><ci id="S4.E12.m1.4.4.2.cmml" xref="S4.E12.m1.4.4.2">←</ci><apply id="S4.E12.m1.4.4.3.cmml" xref="S4.E12.m1.4.4.3"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.3.1.cmml" xref="S4.E12.m1.4.4.3">subscript</csymbol><apply id="S4.E12.m1.4.4.3.2.cmml" xref="S4.E12.m1.4.4.3.2"><ci id="S4.E12.m1.4.4.3.2.1.cmml" xref="S4.E12.m1.4.4.3.2.1">¯</ci><ci id="S4.E12.m1.4.4.3.2.2.cmml" xref="S4.E12.m1.4.4.3.2.2">𝜔</ci></apply><plus id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1"></plus></apply><apply id="S4.E12.m1.4.4.1.cmml" xref="S4.E12.m1.4.4.1"><plus id="S4.E12.m1.4.4.1.2.cmml" xref="S4.E12.m1.4.4.1.2"></plus><apply id="S4.E12.m1.4.4.1.3.cmml" xref="S4.E12.m1.4.4.1.3"><times id="S4.E12.m1.4.4.1.3.1.cmml" xref="S4.E12.m1.4.4.1.3.1"></times><ci id="S4.E12.m1.4.4.1.3.2.cmml" xref="S4.E12.m1.4.4.1.3.2">𝛽</ci><apply id="S4.E12.m1.4.4.1.3.3.cmml" xref="S4.E12.m1.4.4.1.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.1.3.3.1.cmml" xref="S4.E12.m1.4.4.1.3.3">subscript</csymbol><apply id="S4.E12.m1.4.4.1.3.3.2.cmml" xref="S4.E12.m1.4.4.1.3.3.2"><ci id="S4.E12.m1.4.4.1.3.3.2.1.cmml" xref="S4.E12.m1.4.4.1.3.3.2.1">¯</ci><ci id="S4.E12.m1.4.4.1.3.3.2.2.cmml" xref="S4.E12.m1.4.4.1.3.3.2.2">𝜔</ci></apply><plus id="S4.E12.m1.2.2.1.1.cmml" xref="S4.E12.m1.2.2.1.1"></plus></apply></apply><apply id="S4.E12.m1.4.4.1.1.cmml" xref="S4.E12.m1.4.4.1.1"><times id="S4.E12.m1.4.4.1.1.2.cmml" xref="S4.E12.m1.4.4.1.1.2"></times><apply id="S4.E12.m1.4.4.1.1.1.1.1.cmml" xref="S4.E12.m1.4.4.1.1.1.1"><minus id="S4.E12.m1.4.4.1.1.1.1.1.1.cmml" xref="S4.E12.m1.4.4.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E12.m1.4.4.1.1.1.1.1.2.cmml" xref="S4.E12.m1.4.4.1.1.1.1.1.2">1</cn><ci id="S4.E12.m1.4.4.1.1.1.1.1.3.cmml" xref="S4.E12.m1.4.4.1.1.1.1.1.3">𝛽</ci></apply><apply id="S4.E12.m1.4.4.1.1.3.cmml" xref="S4.E12.m1.4.4.1.1.3"><divide id="S4.E12.m1.4.4.1.1.3.1.cmml" xref="S4.E12.m1.4.4.1.1.3"></divide><cn type="integer" id="S4.E12.m1.4.4.1.1.3.2.cmml" xref="S4.E12.m1.4.4.1.1.3.2">1</cn><ci id="S4.E12.m1.4.4.1.1.3.3.cmml" xref="S4.E12.m1.4.4.1.1.3.3">𝐵</ci></apply><apply id="S4.E12.m1.4.4.1.1.4.cmml" xref="S4.E12.m1.4.4.1.1.4"><apply id="S4.E12.m1.4.4.1.1.4.1.cmml" xref="S4.E12.m1.4.4.1.1.4.1"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.1.1.4.1.1.cmml" xref="S4.E12.m1.4.4.1.1.4.1">subscript</csymbol><sum id="S4.E12.m1.4.4.1.1.4.1.2.cmml" xref="S4.E12.m1.4.4.1.1.4.1.2"></sum><ci id="S4.E12.m1.4.4.1.1.4.1.3.cmml" xref="S4.E12.m1.4.4.1.1.4.1.3">𝑖</ci></apply><apply id="S4.E12.m1.4.4.1.1.4.2.cmml" xref="S4.E12.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S4.E12.m1.4.4.1.1.4.2.1.cmml" xref="S4.E12.m1.4.4.1.1.4.2">subscript</csymbol><ci id="S4.E12.m1.4.4.1.1.4.2.2.cmml" xref="S4.E12.m1.4.4.1.1.4.2.2">𝜔</ci><plus id="S4.E12.m1.3.3.1.1.cmml" xref="S4.E12.m1.3.3.1.1"></plus></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.4c">\bar{\omega}_{(+)}\leftarrow\beta\bar{\omega}_{(+)}+(1-\beta)\frac{1}{B}\sum_{i}{\omega}_{(+)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.5" class="ltx_p">is the moving average and <math id="S4.SS3.p1.4.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S4.SS3.p1.4.m1.1a"><mi id="S4.SS3.p1.4.m1.1.1" xref="S4.SS3.p1.4.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m1.1b"><ci id="S4.SS3.p1.4.m1.1.1.cmml" xref="S4.SS3.p1.4.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m1.1c">B</annotation></semantics></math> is the size of minibatch, <math id="S4.SS3.p1.5.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.p1.5.m2.1a"><mi id="S4.SS3.p1.5.m2.1.1" xref="S4.SS3.p1.5.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m2.1b"><ci id="S4.SS3.p1.5.m2.1.1.cmml" xref="S4.SS3.p1.5.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m2.1c">\beta</annotation></semantics></math> is set as 0.8 in this paper.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.2" class="ltx_p">Moreover, we note that the prediction <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="F^{g}(g^{l})" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><msup id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1.3.2" xref="S4.SS3.p2.1.m1.1.1.3.2.cmml">F</mi><mi id="S4.SS3.p2.1.m1.1.1.3.3" xref="S4.SS3.p2.1.m1.1.1.3.3.cmml">g</mi></msup><mo lspace="0em" rspace="0em" id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml">​</mo><mrow id="S4.SS3.p2.1.m1.1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.p2.1.m1.1.1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS3.p2.1.m1.1.1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS3.p2.1.m1.1.1.1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.1.1.1.2.cmml">g</mi><mi id="S4.SS3.p2.1.m1.1.1.1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.1.1.1.3.cmml">l</mi></msup><mo stretchy="false" id="S4.SS3.p2.1.m1.1.1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1"><times id="S4.SS3.p2.1.m1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.2"></times><apply id="S4.SS3.p2.1.m1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.1.3">superscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.3.2.cmml" xref="S4.SS3.p2.1.m1.1.1.3.2">𝐹</ci><ci id="S4.SS3.p2.1.m1.1.1.3.3.cmml" xref="S4.SS3.p2.1.m1.1.1.3.3">𝑔</ci></apply><apply id="S4.SS3.p2.1.m1.1.1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1.1.1">superscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.1.m1.1.1.1.1.1.2">𝑔</ci><ci id="S4.SS3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.1.1.1.1.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">F^{g}(g^{l})</annotation></semantics></math> and the discrepancy <math id="S4.SS3.p2.2.m2.2" class="ltx_Math" alttext="\Delta(x^{l},F^{g})" display="inline"><semantics id="S4.SS3.p2.2.m2.2a"><mrow id="S4.SS3.p2.2.m2.2.2" xref="S4.SS3.p2.2.m2.2.2.cmml"><mi mathvariant="normal" id="S4.SS3.p2.2.m2.2.2.4" xref="S4.SS3.p2.2.m2.2.2.4.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p2.2.m2.2.2.3" xref="S4.SS3.p2.2.m2.2.2.3.cmml">​</mo><mrow id="S4.SS3.p2.2.m2.2.2.2.2" xref="S4.SS3.p2.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS3.p2.2.m2.2.2.2.2.3" xref="S4.SS3.p2.2.m2.2.2.2.3.cmml">(</mo><msup id="S4.SS3.p2.2.m2.1.1.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS3.p2.2.m2.1.1.1.1.1.2" xref="S4.SS3.p2.2.m2.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS3.p2.2.m2.1.1.1.1.1.3" xref="S4.SS3.p2.2.m2.1.1.1.1.1.3.cmml">l</mi></msup><mo id="S4.SS3.p2.2.m2.2.2.2.2.4" xref="S4.SS3.p2.2.m2.2.2.2.3.cmml">,</mo><msup id="S4.SS3.p2.2.m2.2.2.2.2.2" xref="S4.SS3.p2.2.m2.2.2.2.2.2.cmml"><mi id="S4.SS3.p2.2.m2.2.2.2.2.2.2" xref="S4.SS3.p2.2.m2.2.2.2.2.2.2.cmml">F</mi><mi id="S4.SS3.p2.2.m2.2.2.2.2.2.3" xref="S4.SS3.p2.2.m2.2.2.2.2.2.3.cmml">g</mi></msup><mo stretchy="false" id="S4.SS3.p2.2.m2.2.2.2.2.5" xref="S4.SS3.p2.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.2b"><apply id="S4.SS3.p2.2.m2.2.2.cmml" xref="S4.SS3.p2.2.m2.2.2"><times id="S4.SS3.p2.2.m2.2.2.3.cmml" xref="S4.SS3.p2.2.m2.2.2.3"></times><ci id="S4.SS3.p2.2.m2.2.2.4.cmml" xref="S4.SS3.p2.2.m2.2.2.4">Δ</ci><interval closure="open" id="S4.SS3.p2.2.m2.2.2.2.3.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2"><apply id="S4.SS3.p2.2.m2.1.1.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1.1.1.1">superscript</csymbol><ci id="S4.SS3.p2.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS3.p2.2.m2.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS3.p2.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS3.p2.2.m2.1.1.1.1.1.3">𝑙</ci></apply><apply id="S4.SS3.p2.2.m2.2.2.2.2.2.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS3.p2.2.m2.2.2.2.2.2.1.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2.2">superscript</csymbol><ci id="S4.SS3.p2.2.m2.2.2.2.2.2.2.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2.2.2">𝐹</ci><ci id="S4.SS3.p2.2.m2.2.2.2.2.2.3.cmml" xref="S4.SS3.p2.2.m2.2.2.2.2.2.3">𝑔</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.2c">\Delta(x^{l},F^{g})</annotation></semantics></math> for the received global model only need to be calculated once per communication round and thus will not bring much computational cost.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experimental Procedures</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Datasets</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We conducted experiments on a total of nine datasets retrieved from MoleculeNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> for molecular property prediction, including four regression datasets (FreeSolv, Lipophilicity, ESOL, and QM9) and five classification datasets (Tox21, SIDER, ClinTox, BBBP, and BACE). We follow the prediction tasks in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite> and summarize the statistics for all datasets in Table <a href="#S5.T1" title="Table 1 ‣ 5.1 Datasets ‣ 5 Experimental Procedures ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<td id="S5.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_border_tt">Dataset</td>
<td id="S5.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">#Compounds</td>
<td id="S5.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_tt">#tasks</td>
<td id="S5.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">task type</td>
<td id="S5.T1.1.1.1.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_tt">Metric</td>
</tr>
<tr id="S5.T1.1.2.2" class="ltx_tr">
<td id="S5.T1.1.2.2.1" class="ltx_td ltx_align_left ltx_border_t">FreeSolv</td>
<td id="S5.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_t">642</td>
<td id="S5.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_t">1</td>
<td id="S5.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_t">Reg.</td>
<td id="S5.T1.1.2.2.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">RMSE</td>
</tr>
<tr id="S5.T1.1.3.3" class="ltx_tr">
<td id="S5.T1.1.3.3.1" class="ltx_td ltx_align_left">Lipophilicity</td>
<td id="S5.T1.1.3.3.2" class="ltx_td ltx_align_center">4200</td>
<td id="S5.T1.1.3.3.3" class="ltx_td ltx_align_center">1</td>
<td id="S5.T1.1.3.3.4" class="ltx_td ltx_align_center">Reg.</td>
<td id="S5.T1.1.3.3.5" class="ltx_td ltx_nopad_r ltx_align_center">RMSE</td>
</tr>
<tr id="S5.T1.1.4.4" class="ltx_tr">
<td id="S5.T1.1.4.4.1" class="ltx_td ltx_align_left">ESOL</td>
<td id="S5.T1.1.4.4.2" class="ltx_td ltx_align_center">1128</td>
<td id="S5.T1.1.4.4.3" class="ltx_td ltx_align_center">1</td>
<td id="S5.T1.1.4.4.4" class="ltx_td ltx_align_center">Reg.</td>
<td id="S5.T1.1.4.4.5" class="ltx_td ltx_nopad_r ltx_align_center">RMSE</td>
</tr>
<tr id="S5.T1.1.5.5" class="ltx_tr">
<td id="S5.T1.1.5.5.1" class="ltx_td ltx_align_left">QM9</td>
<td id="S5.T1.1.5.5.2" class="ltx_td ltx_align_center">133885</td>
<td id="S5.T1.1.5.5.3" class="ltx_td ltx_align_center">12</td>
<td id="S5.T1.1.5.5.4" class="ltx_td ltx_align_center">Reg.</td>
<td id="S5.T1.1.5.5.5" class="ltx_td ltx_nopad_r ltx_align_center">MAE</td>
</tr>
<tr id="S5.T1.1.6.6" class="ltx_tr">
<td id="S5.T1.1.6.6.1" class="ltx_td ltx_align_left ltx_border_t">Tox21</td>
<td id="S5.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_t">7831</td>
<td id="S5.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_t">12</td>
<td id="S5.T1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_t">Cls.</td>
<td id="S5.T1.1.6.6.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">ROC-AUC</td>
</tr>
<tr id="S5.T1.1.7.7" class="ltx_tr">
<td id="S5.T1.1.7.7.1" class="ltx_td ltx_align_left">SIDER</td>
<td id="S5.T1.1.7.7.2" class="ltx_td ltx_align_center">1427</td>
<td id="S5.T1.1.7.7.3" class="ltx_td ltx_align_center">27</td>
<td id="S5.T1.1.7.7.4" class="ltx_td ltx_align_center">Cls.</td>
<td id="S5.T1.1.7.7.5" class="ltx_td ltx_nopad_r ltx_align_center">ROC-AUC</td>
</tr>
<tr id="S5.T1.1.8.8" class="ltx_tr">
<td id="S5.T1.1.8.8.1" class="ltx_td ltx_align_left">ClinTox</td>
<td id="S5.T1.1.8.8.2" class="ltx_td ltx_align_center">1478</td>
<td id="S5.T1.1.8.8.3" class="ltx_td ltx_align_center">2</td>
<td id="S5.T1.1.8.8.4" class="ltx_td ltx_align_center">Cls.</td>
<td id="S5.T1.1.8.8.5" class="ltx_td ltx_nopad_r ltx_align_center">ROC-AUC</td>
</tr>
<tr id="S5.T1.1.9.9" class="ltx_tr">
<td id="S5.T1.1.9.9.1" class="ltx_td ltx_align_left">BBBP</td>
<td id="S5.T1.1.9.9.2" class="ltx_td ltx_align_center">2039</td>
<td id="S5.T1.1.9.9.3" class="ltx_td ltx_align_center">1</td>
<td id="S5.T1.1.9.9.4" class="ltx_td ltx_align_center">Cls.</td>
<td id="S5.T1.1.9.9.5" class="ltx_td ltx_nopad_r ltx_align_center">ROC-AUC</td>
</tr>
<tr id="S5.T1.1.10.10" class="ltx_tr">
<td id="S5.T1.1.10.10.1" class="ltx_td ltx_align_left ltx_border_bb">BACE</td>
<td id="S5.T1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_bb">1213</td>
<td id="S5.T1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_bb">1</td>
<td id="S5.T1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_bb">Cls.</td>
<td id="S5.T1.1.10.10.5" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">ROC-AUC</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Statistics of datasets. Reg. and Cls. stand for regression and classification, respectively.</figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<div id="S5.T2.12" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:190.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-69.6pt,30.6pt) scale(0.756921439287859,0.756921439287859) ;">
<table id="S5.T2.12.12" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.12.12.13.1" class="ltx_tr">
<th id="S5.T2.12.12.13.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="S5.T2.12.12.13.1.1.1" class="ltx_text">Dataset</span></th>
<th id="S5.T2.12.12.13.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_tt"></th>
<th id="S5.T2.12.12.13.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">Centeralized Training</th>
<th id="S5.T2.12.12.13.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="6">Federated Learning</th>
<th id="S5.T2.12.12.13.1.5" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
</tr>
<tr id="S5.T2.6.6.6" class="ltx_tr">
<th id="S5.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><math id="S5.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T2.1.1.1.1.m1.1a"><mi id="S5.T2.1.1.1.1.m1.1.1" xref="S5.T2.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.m1.1c">\alpha</annotation></semantics></math></th>
<th id="S5.T2.6.6.6.7" class="ltx_td ltx_align_center ltx_th ltx_th_column">MolNet*</th>
<th id="S5.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">FedChem*<math id="S5.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="{}_{\textrm{ours}}" display="inline"><semantics id="S5.T2.2.2.2.2.m1.1a"><msub id="S5.T2.2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.2.m1.1.1.cmml"><mi id="S5.T2.2.2.2.2.m1.1.1a" xref="S5.T2.2.2.2.2.m1.1.1.cmml"></mi><mtext id="S5.T2.2.2.2.2.m1.1.1.1" xref="S5.T2.2.2.2.2.m1.1.1.1a.cmml">ours</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.2.m1.1b"><apply id="S5.T2.2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.2.m1.1.1"><ci id="S5.T2.2.2.2.2.m1.1.1.1a.cmml" xref="S5.T2.2.2.2.2.m1.1.1.1"><mtext mathsize="70%" id="S5.T2.2.2.2.2.m1.1.1.1.cmml" xref="S5.T2.2.2.2.2.m1.1.1.1">ours</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.2.m1.1c">{}_{\textrm{ours}}</annotation></semantics></math>
</th>
<th id="S5.T2.6.6.6.8" class="ltx_td ltx_align_center ltx_th ltx_th_column">FedAvg</th>
<th id="S5.T2.6.6.6.9" class="ltx_td ltx_align_center ltx_th ltx_th_column">FedProx</th>
<th id="S5.T2.6.6.6.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">MOON</th>
<th id="S5.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">FedFocal<math id="S5.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="{}_{\textrm{ours}}" display="inline"><semantics id="S5.T2.3.3.3.3.m1.1a"><msub id="S5.T2.3.3.3.3.m1.1.1" xref="S5.T2.3.3.3.3.m1.1.1.cmml"><mi id="S5.T2.3.3.3.3.m1.1.1a" xref="S5.T2.3.3.3.3.m1.1.1.cmml"></mi><mtext id="S5.T2.3.3.3.3.m1.1.1.1" xref="S5.T2.3.3.3.3.m1.1.1.1a.cmml">ours</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.3.m1.1b"><apply id="S5.T2.3.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.3.m1.1.1"><ci id="S5.T2.3.3.3.3.m1.1.1.1a.cmml" xref="S5.T2.3.3.3.3.m1.1.1.1"><mtext mathsize="70%" id="S5.T2.3.3.3.3.m1.1.1.1.cmml" xref="S5.T2.3.3.3.3.m1.1.1.1">ours</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.3.m1.1c">{}_{\textrm{ours}}</annotation></semantics></math>
</th>
<th id="S5.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">FedVAT<math id="S5.T2.4.4.4.4.m1.1" class="ltx_Math" alttext="{}_{\textrm{ours}}" display="inline"><semantics id="S5.T2.4.4.4.4.m1.1a"><msub id="S5.T2.4.4.4.4.m1.1.1" xref="S5.T2.4.4.4.4.m1.1.1.cmml"><mi id="S5.T2.4.4.4.4.m1.1.1a" xref="S5.T2.4.4.4.4.m1.1.1.cmml"></mi><mtext id="S5.T2.4.4.4.4.m1.1.1.1" xref="S5.T2.4.4.4.4.m1.1.1.1a.cmml">ours</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.4.m1.1b"><apply id="S5.T2.4.4.4.4.m1.1.1.cmml" xref="S5.T2.4.4.4.4.m1.1.1"><ci id="S5.T2.4.4.4.4.m1.1.1.1a.cmml" xref="S5.T2.4.4.4.4.m1.1.1.1"><mtext mathsize="70%" id="S5.T2.4.4.4.4.m1.1.1.1.cmml" xref="S5.T2.4.4.4.4.m1.1.1.1">ours</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.4.m1.1c">{}_{\textrm{ours}}</annotation></semantics></math>
</th>
<th id="S5.T2.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">FLIT<math id="S5.T2.5.5.5.5.m1.1" class="ltx_Math" alttext="{}_{\textrm{ours}}" display="inline"><semantics id="S5.T2.5.5.5.5.m1.1a"><msub id="S5.T2.5.5.5.5.m1.1.1" xref="S5.T2.5.5.5.5.m1.1.1.cmml"><mi id="S5.T2.5.5.5.5.m1.1.1a" xref="S5.T2.5.5.5.5.m1.1.1.cmml"></mi><mtext id="S5.T2.5.5.5.5.m1.1.1.1" xref="S5.T2.5.5.5.5.m1.1.1.1a.cmml">ours</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.5.5.m1.1b"><apply id="S5.T2.5.5.5.5.m1.1.1.cmml" xref="S5.T2.5.5.5.5.m1.1.1"><ci id="S5.T2.5.5.5.5.m1.1.1.1a.cmml" xref="S5.T2.5.5.5.5.m1.1.1.1"><mtext mathsize="70%" id="S5.T2.5.5.5.5.m1.1.1.1.cmml" xref="S5.T2.5.5.5.5.m1.1.1.1">ours</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.5.5.m1.1c">{}_{\textrm{ours}}</annotation></semantics></math>
</th>
<th id="S5.T2.6.6.6.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column">FLIT+<math id="S5.T2.6.6.6.6.m1.1" class="ltx_Math" alttext="{}_{\textrm{ours}}" display="inline"><semantics id="S5.T2.6.6.6.6.m1.1a"><msub id="S5.T2.6.6.6.6.m1.1.1" xref="S5.T2.6.6.6.6.m1.1.1.cmml"><mi id="S5.T2.6.6.6.6.m1.1.1a" xref="S5.T2.6.6.6.6.m1.1.1.cmml"></mi><mtext id="S5.T2.6.6.6.6.m1.1.1.1" xref="S5.T2.6.6.6.6.m1.1.1.1a.cmml">ours</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.6.6.m1.1b"><apply id="S5.T2.6.6.6.6.m1.1.1.cmml" xref="S5.T2.6.6.6.6.m1.1.1"><ci id="S5.T2.6.6.6.6.m1.1.1.1a.cmml" xref="S5.T2.6.6.6.6.m1.1.1.1"><mtext mathsize="70%" id="S5.T2.6.6.6.6.m1.1.1.1.cmml" xref="S5.T2.6.6.6.6.m1.1.1.1">ours</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.6.6.m1.1c">{}_{\textrm{ours}}</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.7.7.7" class="ltx_tr">
<td id="S5.T2.7.7.7.1" class="ltx_td ltx_align_left ltx_border_t" rowspan="3"><span id="S5.T2.7.7.7.1.1" class="ltx_text">FreeSolv<math id="S5.T2.7.7.7.1.1.m1.1" class="ltx_Math" alttext="\Downarrow" display="inline"><semantics id="S5.T2.7.7.7.1.1.m1.1a"><mo stretchy="false" id="S5.T2.7.7.7.1.1.m1.1.1" xref="S5.T2.7.7.7.1.1.m1.1.1.cmml">⇓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.7.1.1.m1.1b"><ci id="S5.T2.7.7.7.1.1.m1.1.1.cmml" xref="S5.T2.7.7.7.1.1.m1.1.1">⇓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.7.1.1.m1.1c">\Downarrow</annotation></semantics></math></span></td>
<td id="S5.T2.7.7.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.1</td>
<td id="S5.T2.7.7.7.3" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="S5.T2.7.7.7.3.1" class="ltx_text">1.40</span></td>
<td id="S5.T2.7.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T2.7.7.7.4.1" class="ltx_text">1.430</span></td>
<td id="S5.T2.7.7.7.5" class="ltx_td ltx_align_center ltx_border_t">1.771</td>
<td id="S5.T2.7.7.7.6" class="ltx_td ltx_align_center ltx_border_t">1.693</td>
<td id="S5.T2.7.7.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.376</td>
<td id="S5.T2.7.7.7.8" class="ltx_td ltx_align_center ltx_border_t">1.686</td>
<td id="S5.T2.7.7.7.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.371</td>
<td id="S5.T2.7.7.7.10" class="ltx_td ltx_align_center ltx_border_t">1.634</td>
<td id="S5.T2.7.7.7.11" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S5.T2.7.7.7.11.1" class="ltx_text ltx_font_bold">1.228</span></td>
</tr>
<tr id="S5.T2.12.12.14.1" class="ltx_tr">
<td id="S5.T2.12.12.14.1.1" class="ltx_td ltx_align_center ltx_border_r">0.5</td>
<td id="S5.T2.12.12.14.1.2" class="ltx_td ltx_align_center">1.445</td>
<td id="S5.T2.12.12.14.1.3" class="ltx_td ltx_align_center">1.376</td>
<td id="S5.T2.12.12.14.1.4" class="ltx_td ltx_align_center ltx_border_r">1.423</td>
<td id="S5.T2.12.12.14.1.5" class="ltx_td ltx_align_center">1.322</td>
<td id="S5.T2.12.12.14.1.6" class="ltx_td ltx_align_center ltx_border_r">1.299</td>
<td id="S5.T2.12.12.14.1.7" class="ltx_td ltx_align_center">1.366</td>
<td id="S5.T2.12.12.14.1.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T2.12.12.14.1.8.1" class="ltx_text ltx_font_bold">1.127</span></td>
</tr>
<tr id="S5.T2.12.12.15.2" class="ltx_tr">
<td id="S5.T2.12.12.15.2.1" class="ltx_td ltx_align_center ltx_border_r">1</td>
<td id="S5.T2.12.12.15.2.2" class="ltx_td ltx_align_center">1.223</td>
<td id="S5.T2.12.12.15.2.3" class="ltx_td ltx_align_center">1.216</td>
<td id="S5.T2.12.12.15.2.4" class="ltx_td ltx_align_center ltx_border_r">1.469</td>
<td id="S5.T2.12.12.15.2.5" class="ltx_td ltx_align_center">1.294</td>
<td id="S5.T2.12.12.15.2.6" class="ltx_td ltx_align_center ltx_border_r">1.150</td>
<td id="S5.T2.12.12.15.2.7" class="ltx_td ltx_align_center">1.277</td>
<td id="S5.T2.12.12.15.2.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T2.12.12.15.2.8.1" class="ltx_text ltx_font_bold">1.061</span></td>
</tr>
<tr id="S5.T2.8.8.8" class="ltx_tr">
<td id="S5.T2.8.8.8.1" class="ltx_td ltx_align_left ltx_border_t" rowspan="3"><span id="S5.T2.8.8.8.1.1" class="ltx_text">Lipophilicity<math id="S5.T2.8.8.8.1.1.m1.1" class="ltx_Math" alttext="\Downarrow" display="inline"><semantics id="S5.T2.8.8.8.1.1.m1.1a"><mo stretchy="false" id="S5.T2.8.8.8.1.1.m1.1.1" xref="S5.T2.8.8.8.1.1.m1.1.1.cmml">⇓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.8.1.1.m1.1b"><ci id="S5.T2.8.8.8.1.1.m1.1.1.cmml" xref="S5.T2.8.8.8.1.1.m1.1.1">⇓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.8.1.1.m1.1c">\Downarrow</annotation></semantics></math></span></td>
<td id="S5.T2.8.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.1</td>
<td id="S5.T2.8.8.8.3" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="S5.T2.8.8.8.3.1" class="ltx_text">0.655</span></td>
<td id="S5.T2.8.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T2.8.8.8.4.1" class="ltx_text">0.6290</span></td>
<td id="S5.T2.8.8.8.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.8.8.8.5.1" class="ltx_text ltx_font_bold">0.6361</span></td>
<td id="S5.T2.8.8.8.6" class="ltx_td ltx_align_center ltx_border_t">0.6403</td>
<td id="S5.T2.8.8.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.6426</td>
<td id="S5.T2.8.8.8.8" class="ltx_td ltx_align_center ltx_border_t">0.6403</td>
<td id="S5.T2.8.8.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.6556</td>
<td id="S5.T2.8.8.8.10" class="ltx_td ltx_align_center ltx_border_t">0.6563</td>
<td id="S5.T2.8.8.8.11" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">0.6392</td>
</tr>
<tr id="S5.T2.12.12.16.3" class="ltx_tr">
<td id="S5.T2.12.12.16.3.1" class="ltx_td ltx_align_center ltx_border_r">0.5</td>
<td id="S5.T2.12.12.16.3.2" class="ltx_td ltx_align_center">0.6306</td>
<td id="S5.T2.12.12.16.3.3" class="ltx_td ltx_align_center">0.6365</td>
<td id="S5.T2.12.12.16.3.4" class="ltx_td ltx_align_center ltx_border_r">0.6339</td>
<td id="S5.T2.12.12.16.3.5" class="ltx_td ltx_align_center">0.6351</td>
<td id="S5.T2.12.12.16.3.6" class="ltx_td ltx_align_center ltx_border_r">0.6333</td>
<td id="S5.T2.12.12.16.3.7" class="ltx_td ltx_align_center">0.6368</td>
<td id="S5.T2.12.12.16.3.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T2.12.12.16.3.8.1" class="ltx_text ltx_font_bold">0.6270</span></td>
</tr>
<tr id="S5.T2.12.12.17.4" class="ltx_tr">
<td id="S5.T2.12.12.17.4.1" class="ltx_td ltx_align_center ltx_border_r">1</td>
<td id="S5.T2.12.12.17.4.2" class="ltx_td ltx_align_center">0.6505</td>
<td id="S5.T2.12.12.17.4.3" class="ltx_td ltx_align_center">0.6474</td>
<td id="S5.T2.12.12.17.4.4" class="ltx_td ltx_align_center ltx_border_r">0.6442</td>
<td id="S5.T2.12.12.17.4.5" class="ltx_td ltx_align_center">0.6461</td>
<td id="S5.T2.12.12.17.4.6" class="ltx_td ltx_align_center ltx_border_r">0.6488</td>
<td id="S5.T2.12.12.17.4.7" class="ltx_td ltx_align_center">0.6443</td>
<td id="S5.T2.12.12.17.4.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T2.12.12.17.4.8.1" class="ltx_text ltx_font_bold">0.6403</span></td>
</tr>
<tr id="S5.T2.9.9.9" class="ltx_tr">
<td id="S5.T2.9.9.9.1" class="ltx_td ltx_align_left ltx_border_t" rowspan="3"><span id="S5.T2.9.9.9.1.1" class="ltx_text">ESOL<math id="S5.T2.9.9.9.1.1.m1.1" class="ltx_Math" alttext="\Downarrow" display="inline"><semantics id="S5.T2.9.9.9.1.1.m1.1a"><mo stretchy="false" id="S5.T2.9.9.9.1.1.m1.1.1" xref="S5.T2.9.9.9.1.1.m1.1.1.cmml">⇓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.9.1.1.m1.1b"><ci id="S5.T2.9.9.9.1.1.m1.1.1.cmml" xref="S5.T2.9.9.9.1.1.m1.1.1">⇓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.9.1.1.m1.1c">\Downarrow</annotation></semantics></math></span></td>
<td id="S5.T2.9.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.1</td>
<td id="S5.T2.9.9.9.3" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="S5.T2.9.9.9.3.1" class="ltx_text">0.97</span></td>
<td id="S5.T2.9.9.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T2.9.9.9.4.1" class="ltx_text">0.6570</span></td>
<td id="S5.T2.9.9.9.5" class="ltx_td ltx_align_center ltx_border_t">0.8016</td>
<td id="S5.T2.9.9.9.6" class="ltx_td ltx_align_center ltx_border_t">0.7702</td>
<td id="S5.T2.9.9.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T2.9.9.9.7.1" class="ltx_text ltx_font_bold">0.7537</span></td>
<td id="S5.T2.9.9.9.8" class="ltx_td ltx_align_center ltx_border_t">0.8022</td>
<td id="S5.T2.9.9.9.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.7776</td>
<td id="S5.T2.9.9.9.10" class="ltx_td ltx_align_center ltx_border_t">0.7788</td>
<td id="S5.T2.9.9.9.11" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">0.7642</td>
</tr>
<tr id="S5.T2.12.12.18.5" class="ltx_tr">
<td id="S5.T2.12.12.18.5.1" class="ltx_td ltx_align_center ltx_border_r">0.5</td>
<td id="S5.T2.12.12.18.5.2" class="ltx_td ltx_align_center">0.7524</td>
<td id="S5.T2.12.12.18.5.3" class="ltx_td ltx_align_center">0.7382</td>
<td id="S5.T2.12.12.18.5.4" class="ltx_td ltx_align_center ltx_border_r">0.7258</td>
<td id="S5.T2.12.12.18.5.5" class="ltx_td ltx_align_center">0.7708</td>
<td id="S5.T2.12.12.18.5.6" class="ltx_td ltx_align_center ltx_border_r">0.7243</td>
<td id="S5.T2.12.12.18.5.7" class="ltx_td ltx_align_center">0.7426</td>
<td id="S5.T2.12.12.18.5.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T2.12.12.18.5.8.1" class="ltx_text ltx_font_bold">0.7119</span></td>
</tr>
<tr id="S5.T2.12.12.19.6" class="ltx_tr">
<td id="S5.T2.12.12.19.6.1" class="ltx_td ltx_align_center ltx_border_r">1</td>
<td id="S5.T2.12.12.19.6.2" class="ltx_td ltx_align_center">0.7056</td>
<td id="S5.T2.12.12.19.6.3" class="ltx_td ltx_align_center">0.6828</td>
<td id="S5.T2.12.12.19.6.4" class="ltx_td ltx_align_center ltx_border_r">0.6751</td>
<td id="S5.T2.12.12.19.6.5" class="ltx_td ltx_align_center">0.6822</td>
<td id="S5.T2.12.12.19.6.6" class="ltx_td ltx_align_center ltx_border_r">0.7253</td>
<td id="S5.T2.12.12.19.6.7" class="ltx_td ltx_align_center"><span id="S5.T2.12.12.19.6.7.1" class="ltx_text ltx_font_bold">0.6705</span></td>
<td id="S5.T2.12.12.19.6.8" class="ltx_td ltx_nopad_r ltx_align_center">0.6998</td>
</tr>
<tr id="S5.T2.12.12.12" class="ltx_tr">
<td id="S5.T2.10.10.10.1" class="ltx_td ltx_align_left ltx_border_b ltx_border_t" rowspan="3"><span id="S5.T2.10.10.10.1.1" class="ltx_text">QM9<math id="S5.T2.10.10.10.1.1.m1.1" class="ltx_Math" alttext="\Downarrow" display="inline"><semantics id="S5.T2.10.10.10.1.1.m1.1a"><mo stretchy="false" id="S5.T2.10.10.10.1.1.m1.1.1" xref="S5.T2.10.10.10.1.1.m1.1.1.cmml">⇓</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.10.1.1.m1.1b"><ci id="S5.T2.10.10.10.1.1.m1.1.1.cmml" xref="S5.T2.10.10.10.1.1.m1.1.1">⇓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.10.1.1.m1.1c">\Downarrow</annotation></semantics></math></span></td>
<td id="S5.T2.12.12.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.1</td>
<td id="S5.T2.11.11.11.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" rowspan="3"><span id="S5.T2.11.11.11.2.1" class="ltx_text">0.0479<sup id="S5.T2.11.11.11.2.1.1" class="ltx_sup">♠</sup></span></td>
<td id="S5.T2.12.12.12.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T2.12.12.12.3.1" class="ltx_text">0.0890<sup id="S5.T2.12.12.12.3.1.1" class="ltx_sup">♣</sup></span></td>
<td id="S5.T2.12.12.12.5" class="ltx_td ltx_align_center ltx_border_t">0.5889</td>
<td id="S5.T2.12.12.12.6" class="ltx_td ltx_align_center ltx_border_t">0.6036</td>
<td id="S5.T2.12.12.12.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.5817</td>
<td id="S5.T2.12.12.12.8" class="ltx_td ltx_align_center ltx_border_t">0.6164</td>
<td id="S5.T2.12.12.12.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.5606</td>
<td id="S5.T2.12.12.12.10" class="ltx_td ltx_align_center ltx_border_t">0.5713</td>
<td id="S5.T2.12.12.12.11" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S5.T2.12.12.12.11.1" class="ltx_text ltx_font_bold">0.5356</span></td>
</tr>
<tr id="S5.T2.12.12.20.7" class="ltx_tr">
<td id="S5.T2.12.12.20.7.1" class="ltx_td ltx_align_center ltx_border_r">0.5</td>
<td id="S5.T2.12.12.20.7.2" class="ltx_td ltx_align_center">0.5906</td>
<td id="S5.T2.12.12.20.7.3" class="ltx_td ltx_align_center">0.5751</td>
<td id="S5.T2.12.12.20.7.4" class="ltx_td ltx_align_center ltx_border_r">0.5707</td>
<td id="S5.T2.12.12.20.7.5" class="ltx_td ltx_align_center">0.6059</td>
<td id="S5.T2.12.12.20.7.6" class="ltx_td ltx_align_center ltx_border_r">0.5656</td>
<td id="S5.T2.12.12.20.7.7" class="ltx_td ltx_align_center">0.5658</td>
<td id="S5.T2.12.12.20.7.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T2.12.12.20.7.8.1" class="ltx_text ltx_font_bold">0.5222</span></td>
</tr>
<tr id="S5.T2.12.12.21.8" class="ltx_tr">
<td id="S5.T2.12.12.21.8.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">1</td>
<td id="S5.T2.12.12.21.8.2" class="ltx_td ltx_align_center ltx_border_b">0.5786</td>
<td id="S5.T2.12.12.21.8.3" class="ltx_td ltx_align_center ltx_border_b">0.5691</td>
<td id="S5.T2.12.12.21.8.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.5808</td>
<td id="S5.T2.12.12.21.8.5" class="ltx_td ltx_align_center ltx_border_b">0.5822</td>
<td id="S5.T2.12.12.21.8.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">0.5602</td>
<td id="S5.T2.12.12.21.8.7" class="ltx_td ltx_align_center ltx_border_b">0.5621</td>
<td id="S5.T2.12.12.21.8.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_b"><span id="S5.T2.12.12.21.8.8.1" class="ltx_text ltx_font_bold">0.5282</span></td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance for federated molecular regression. <math id="S5.T2.18.m1.2" class="ltx_Math" alttext="\Downarrow,\Uparrow" display="inline"><semantics id="S5.T2.18.m1.2b"><mrow id="S5.T2.18.m1.2.3.2" xref="S5.T2.18.m1.2.3.1.cmml"><mo rspace="0em" stretchy="false" id="S5.T2.18.m1.1.1" xref="S5.T2.18.m1.1.1.cmml">⇓</mo><mo id="S5.T2.18.m1.2.3.2.1" xref="S5.T2.18.m1.2.3.1.cmml">,</mo><mo lspace="0em" stretchy="false" id="S5.T2.18.m1.2.2" xref="S5.T2.18.m1.2.2.cmml">⇑</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.18.m1.2c"><list id="S5.T2.18.m1.2.3.1.cmml" xref="S5.T2.18.m1.2.3.2"><ci id="S5.T2.18.m1.1.1.cmml" xref="S5.T2.18.m1.1.1">⇓</ci><ci id="S5.T2.18.m1.2.2.cmml" xref="S5.T2.18.m1.2.2">⇑</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.m1.2d">\Downarrow,\Uparrow</annotation></semantics></math> indicate if lower or higher numbers are better. <math id="S5.T2.19.m2.1" class="ltx_Math" alttext="*" display="inline"><semantics id="S5.T2.19.m2.1b"><mo id="S5.T2.19.m2.1.1" xref="S5.T2.19.m2.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S5.T2.19.m2.1c"><times id="S5.T2.19.m2.1.1.cmml" xref="S5.T2.19.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.19.m2.1d">*</annotation></semantics></math> denotes the results are obtained with centralized training. <sup id="S5.T2.25.1" class="ltx_sup">♠</sup> denotes the results are retrieved from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> with seperate SchNet for each task. <sup id="S5.T2.26.2" class="ltx_sup">♣</sup> denotes the results are obtained by a single multitask network. Smaller <math id="S5.T2.22.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T2.22.m5.1b"><mi id="S5.T2.22.m5.1.1" xref="S5.T2.22.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T2.22.m5.1c"><ci id="S5.T2.22.m5.1.1.cmml" xref="S5.T2.22.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.22.m5.1d">\alpha</annotation></semantics></math> of LDA generates more extreme heterogeneous scenario. FedFocal and FedVAT are proposed in this paper as the variants of FLIT(+). Best federated learning results are highlighted in bold.</figcaption>
</figure>
<figure id="S5.T3" class="ltx_table">
<div id="S5.T3.11" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:240.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-59.3pt,32.9pt) scale(0.785289317495119,0.785289317495119) ;">
<table id="S5.T3.11.11" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T3.11.11.12.1" class="ltx_tr">
<th id="S5.T3.11.11.12.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" rowspan="2"><span id="S5.T3.11.11.12.1.1.1" class="ltx_text">Dataset</span></th>
<th id="S5.T3.11.11.12.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_r ltx_border_tt"></th>
<th id="S5.T3.11.11.12.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2">Centeralized Training</th>
<th id="S5.T3.11.11.12.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="6">Federated Learning</th>
<th id="S5.T3.11.11.12.1.5" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
</tr>
<tr id="S5.T3.6.6.6" class="ltx_tr">
<th id="S5.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><math id="S5.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T3.1.1.1.1.m1.1a"><mi id="S5.T3.1.1.1.1.m1.1.1" xref="S5.T3.1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.1.m1.1b"><ci id="S5.T3.1.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.1.m1.1c">\alpha</annotation></semantics></math></th>
<th id="S5.T3.6.6.6.7" class="ltx_td ltx_align_center ltx_th ltx_th_column">MolNet*</th>
<th id="S5.T3.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">FedChem*<math id="S5.T3.2.2.2.2.m1.1" class="ltx_Math" alttext="{}_{\textrm{ours}}" display="inline"><semantics id="S5.T3.2.2.2.2.m1.1a"><msub id="S5.T3.2.2.2.2.m1.1.1" xref="S5.T3.2.2.2.2.m1.1.1.cmml"><mi id="S5.T3.2.2.2.2.m1.1.1a" xref="S5.T3.2.2.2.2.m1.1.1.cmml"></mi><mtext id="S5.T3.2.2.2.2.m1.1.1.1" xref="S5.T3.2.2.2.2.m1.1.1.1a.cmml">ours</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.2.m1.1b"><apply id="S5.T3.2.2.2.2.m1.1.1.cmml" xref="S5.T3.2.2.2.2.m1.1.1"><ci id="S5.T3.2.2.2.2.m1.1.1.1a.cmml" xref="S5.T3.2.2.2.2.m1.1.1.1"><mtext mathsize="70%" id="S5.T3.2.2.2.2.m1.1.1.1.cmml" xref="S5.T3.2.2.2.2.m1.1.1.1">ours</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.2.m1.1c">{}_{\textrm{ours}}</annotation></semantics></math>
</th>
<th id="S5.T3.6.6.6.8" class="ltx_td ltx_align_center ltx_th ltx_th_column">FedAvg</th>
<th id="S5.T3.6.6.6.9" class="ltx_td ltx_align_center ltx_th ltx_th_column">FedProx</th>
<th id="S5.T3.6.6.6.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">MOON</th>
<th id="S5.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column">FedFocal<math id="S5.T3.3.3.3.3.m1.1" class="ltx_Math" alttext="{}_{\textrm{ours}}" display="inline"><semantics id="S5.T3.3.3.3.3.m1.1a"><msub id="S5.T3.3.3.3.3.m1.1.1" xref="S5.T3.3.3.3.3.m1.1.1.cmml"><mi id="S5.T3.3.3.3.3.m1.1.1a" xref="S5.T3.3.3.3.3.m1.1.1.cmml"></mi><mtext id="S5.T3.3.3.3.3.m1.1.1.1" xref="S5.T3.3.3.3.3.m1.1.1.1a.cmml">ours</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.3.m1.1b"><apply id="S5.T3.3.3.3.3.m1.1.1.cmml" xref="S5.T3.3.3.3.3.m1.1.1"><ci id="S5.T3.3.3.3.3.m1.1.1.1a.cmml" xref="S5.T3.3.3.3.3.m1.1.1.1"><mtext mathsize="70%" id="S5.T3.3.3.3.3.m1.1.1.1.cmml" xref="S5.T3.3.3.3.3.m1.1.1.1">ours</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.3.m1.1c">{}_{\textrm{ours}}</annotation></semantics></math>
</th>
<th id="S5.T3.4.4.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r">FedVAT<math id="S5.T3.4.4.4.4.m1.1" class="ltx_Math" alttext="{}_{\textrm{ours}}" display="inline"><semantics id="S5.T3.4.4.4.4.m1.1a"><msub id="S5.T3.4.4.4.4.m1.1.1" xref="S5.T3.4.4.4.4.m1.1.1.cmml"><mi id="S5.T3.4.4.4.4.m1.1.1a" xref="S5.T3.4.4.4.4.m1.1.1.cmml"></mi><mtext id="S5.T3.4.4.4.4.m1.1.1.1" xref="S5.T3.4.4.4.4.m1.1.1.1a.cmml">ours</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.4.4.m1.1b"><apply id="S5.T3.4.4.4.4.m1.1.1.cmml" xref="S5.T3.4.4.4.4.m1.1.1"><ci id="S5.T3.4.4.4.4.m1.1.1.1a.cmml" xref="S5.T3.4.4.4.4.m1.1.1.1"><mtext mathsize="70%" id="S5.T3.4.4.4.4.m1.1.1.1.cmml" xref="S5.T3.4.4.4.4.m1.1.1.1">ours</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.4.4.m1.1c">{}_{\textrm{ours}}</annotation></semantics></math>
</th>
<th id="S5.T3.5.5.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_column">FLIT<math id="S5.T3.5.5.5.5.m1.1" class="ltx_Math" alttext="{}_{\textrm{ours}}" display="inline"><semantics id="S5.T3.5.5.5.5.m1.1a"><msub id="S5.T3.5.5.5.5.m1.1.1" xref="S5.T3.5.5.5.5.m1.1.1.cmml"><mi id="S5.T3.5.5.5.5.m1.1.1a" xref="S5.T3.5.5.5.5.m1.1.1.cmml"></mi><mtext id="S5.T3.5.5.5.5.m1.1.1.1" xref="S5.T3.5.5.5.5.m1.1.1.1a.cmml">ours</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.5.5.m1.1b"><apply id="S5.T3.5.5.5.5.m1.1.1.cmml" xref="S5.T3.5.5.5.5.m1.1.1"><ci id="S5.T3.5.5.5.5.m1.1.1.1a.cmml" xref="S5.T3.5.5.5.5.m1.1.1.1"><mtext mathsize="70%" id="S5.T3.5.5.5.5.m1.1.1.1.cmml" xref="S5.T3.5.5.5.5.m1.1.1.1">ours</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.5.5.m1.1c">{}_{\textrm{ours}}</annotation></semantics></math>
</th>
<th id="S5.T3.6.6.6.6" class="ltx_td ltx_nopad_r ltx_align_center ltx_th ltx_th_column">FLIT+<math id="S5.T3.6.6.6.6.m1.1" class="ltx_Math" alttext="{}_{\textrm{ours}}" display="inline"><semantics id="S5.T3.6.6.6.6.m1.1a"><msub id="S5.T3.6.6.6.6.m1.1.1" xref="S5.T3.6.6.6.6.m1.1.1.cmml"><mi id="S5.T3.6.6.6.6.m1.1.1a" xref="S5.T3.6.6.6.6.m1.1.1.cmml"></mi><mtext id="S5.T3.6.6.6.6.m1.1.1.1" xref="S5.T3.6.6.6.6.m1.1.1.1a.cmml">ours</mtext></msub><annotation-xml encoding="MathML-Content" id="S5.T3.6.6.6.6.m1.1b"><apply id="S5.T3.6.6.6.6.m1.1.1.cmml" xref="S5.T3.6.6.6.6.m1.1.1"><ci id="S5.T3.6.6.6.6.m1.1.1.1a.cmml" xref="S5.T3.6.6.6.6.m1.1.1.1"><mtext mathsize="70%" id="S5.T3.6.6.6.6.m1.1.1.1.cmml" xref="S5.T3.6.6.6.6.m1.1.1.1">ours</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.6.6.6.m1.1c">{}_{\textrm{ours}}</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T3.7.7.7" class="ltx_tr">
<td id="S5.T3.7.7.7.1" class="ltx_td ltx_align_left ltx_border_t" rowspan="3"><span id="S5.T3.7.7.7.1.1" class="ltx_text">Tox21<math id="S5.T3.7.7.7.1.1.m1.1" class="ltx_Math" alttext="\Uparrow" display="inline"><semantics id="S5.T3.7.7.7.1.1.m1.1a"><mo stretchy="false" id="S5.T3.7.7.7.1.1.m1.1.1" xref="S5.T3.7.7.7.1.1.m1.1.1.cmml">⇑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.7.7.7.1.1.m1.1b"><ci id="S5.T3.7.7.7.1.1.m1.1.1.cmml" xref="S5.T3.7.7.7.1.1.m1.1.1">⇑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.7.7.1.1.m1.1c">\Uparrow</annotation></semantics></math></span></td>
<td id="S5.T3.7.7.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.1</td>
<td id="S5.T3.7.7.7.3" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="S5.T3.7.7.7.3.1" class="ltx_text">0.829</span></td>
<td id="S5.T3.7.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T3.7.7.7.4.1" class="ltx_text">0.8182</span></td>
<td id="S5.T3.7.7.7.5" class="ltx_td ltx_align_center ltx_border_t">0.7705</td>
<td id="S5.T3.7.7.7.6" class="ltx_td ltx_align_center ltx_border_t">0.7732</td>
<td id="S5.T3.7.7.7.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.7331</td>
<td id="S5.T3.7.7.7.8" class="ltx_td ltx_align_center ltx_border_t">0.7696</td>
<td id="S5.T3.7.7.7.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.7733</td>
<td id="S5.T3.7.7.7.10" class="ltx_td ltx_align_center ltx_border_t">0.7711</td>
<td id="S5.T3.7.7.7.11" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S5.T3.7.7.7.11.1" class="ltx_text ltx_font_bold">0.7802</span></td>
</tr>
<tr id="S5.T3.11.11.13.1" class="ltx_tr">
<td id="S5.T3.11.11.13.1.1" class="ltx_td ltx_align_center ltx_border_r">0.5</td>
<td id="S5.T3.11.11.13.1.2" class="ltx_td ltx_align_center">0.7811</td>
<td id="S5.T3.11.11.13.1.3" class="ltx_td ltx_align_center">0.7774</td>
<td id="S5.T3.11.11.13.1.4" class="ltx_td ltx_align_center ltx_border_r">0.7461</td>
<td id="S5.T3.11.11.13.1.5" class="ltx_td ltx_align_center">0.7812</td>
<td id="S5.T3.11.11.13.1.6" class="ltx_td ltx_align_center ltx_border_r">0.7787</td>
<td id="S5.T3.11.11.13.1.7" class="ltx_td ltx_align_center">0.7825</td>
<td id="S5.T3.11.11.13.1.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T3.11.11.13.1.8.1" class="ltx_text ltx_font_bold">0.7870</span></td>
</tr>
<tr id="S5.T3.11.11.14.2" class="ltx_tr">
<td id="S5.T3.11.11.14.2.1" class="ltx_td ltx_align_center ltx_border_r">1</td>
<td id="S5.T3.11.11.14.2.2" class="ltx_td ltx_align_center">0.7770</td>
<td id="S5.T3.11.11.14.2.3" class="ltx_td ltx_align_center">0.7775</td>
<td id="S5.T3.11.11.14.2.4" class="ltx_td ltx_align_center ltx_border_r">0.7457</td>
<td id="S5.T3.11.11.14.2.5" class="ltx_td ltx_align_center"><span id="S5.T3.11.11.14.2.5.1" class="ltx_text ltx_font_bold">0.7881</span></td>
<td id="S5.T3.11.11.14.2.6" class="ltx_td ltx_align_center ltx_border_r">0.7706</td>
<td id="S5.T3.11.11.14.2.7" class="ltx_td ltx_align_center">0.7748</td>
<td id="S5.T3.11.11.14.2.8" class="ltx_td ltx_nopad_r ltx_align_center">0.7806</td>
</tr>
<tr id="S5.T3.8.8.8" class="ltx_tr">
<td id="S5.T3.8.8.8.1" class="ltx_td ltx_align_left ltx_border_t" rowspan="3"><span id="S5.T3.8.8.8.1.1" class="ltx_text">SIDER<math id="S5.T3.8.8.8.1.1.m1.1" class="ltx_Math" alttext="\Uparrow" display="inline"><semantics id="S5.T3.8.8.8.1.1.m1.1a"><mo stretchy="false" id="S5.T3.8.8.8.1.1.m1.1.1" xref="S5.T3.8.8.8.1.1.m1.1.1.cmml">⇑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.8.8.8.1.1.m1.1b"><ci id="S5.T3.8.8.8.1.1.m1.1.1.cmml" xref="S5.T3.8.8.8.1.1.m1.1.1">⇑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.8.8.1.1.m1.1c">\Uparrow</annotation></semantics></math></span></td>
<td id="S5.T3.8.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.1</td>
<td id="S5.T3.8.8.8.3" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="S5.T3.8.8.8.3.1" class="ltx_text">0.638</span></td>
<td id="S5.T3.8.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T3.8.8.8.4.1" class="ltx_text">0.6260</span></td>
<td id="S5.T3.8.8.8.5" class="ltx_td ltx_align_center ltx_border_t">0.6029</td>
<td id="S5.T3.8.8.8.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.8.8.8.6.1" class="ltx_text ltx_font_bold">0.6056</span></td>
<td id="S5.T3.8.8.8.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.5885</td>
<td id="S5.T3.8.8.8.8" class="ltx_td ltx_align_center ltx_border_t">0.6016</td>
<td id="S5.T3.8.8.8.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.6027</td>
<td id="S5.T3.8.8.8.10" class="ltx_td ltx_align_center ltx_border_t">0.6035</td>
<td id="S5.T3.8.8.8.11" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">0.6038</td>
</tr>
<tr id="S5.T3.11.11.15.3" class="ltx_tr">
<td id="S5.T3.11.11.15.3.1" class="ltx_td ltx_align_center ltx_border_r">0.5</td>
<td id="S5.T3.11.11.15.3.2" class="ltx_td ltx_align_center">0.6011</td>
<td id="S5.T3.11.11.15.3.3" class="ltx_td ltx_align_center">0.5931</td>
<td id="S5.T3.11.11.15.3.4" class="ltx_td ltx_align_center ltx_border_r">0.5966</td>
<td id="S5.T3.11.11.15.3.5" class="ltx_td ltx_align_center">0.6086</td>
<td id="S5.T3.11.11.15.3.6" class="ltx_td ltx_align_center ltx_border_r">0.5981</td>
<td id="S5.T3.11.11.15.3.7" class="ltx_td ltx_align_center">0.6096</td>
<td id="S5.T3.11.11.15.3.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T3.11.11.15.3.8.1" class="ltx_text ltx_font_bold">0.6146</span></td>
</tr>
<tr id="S5.T3.11.11.16.4" class="ltx_tr">
<td id="S5.T3.11.11.16.4.1" class="ltx_td ltx_align_center ltx_border_r">1</td>
<td id="S5.T3.11.11.16.4.2" class="ltx_td ltx_align_center">0.6011</td>
<td id="S5.T3.11.11.16.4.3" class="ltx_td ltx_align_center">0.6023</td>
<td id="S5.T3.11.11.16.4.4" class="ltx_td ltx_align_center ltx_border_r">0.5901</td>
<td id="S5.T3.11.11.16.4.5" class="ltx_td ltx_align_center">0.6003</td>
<td id="S5.T3.11.11.16.4.6" class="ltx_td ltx_align_center ltx_border_r">0.6053</td>
<td id="S5.T3.11.11.16.4.7" class="ltx_td ltx_align_center">0.6072</td>
<td id="S5.T3.11.11.16.4.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T3.11.11.16.4.8.1" class="ltx_text ltx_font_bold">0.6174</span></td>
</tr>
<tr id="S5.T3.9.9.9" class="ltx_tr">
<td id="S5.T3.9.9.9.1" class="ltx_td ltx_align_left ltx_border_t" rowspan="3"><span id="S5.T3.9.9.9.1.1" class="ltx_text">ClinTox<math id="S5.T3.9.9.9.1.1.m1.1" class="ltx_Math" alttext="\Uparrow" display="inline"><semantics id="S5.T3.9.9.9.1.1.m1.1a"><mo stretchy="false" id="S5.T3.9.9.9.1.1.m1.1.1" xref="S5.T3.9.9.9.1.1.m1.1.1.cmml">⇑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.9.9.9.1.1.m1.1b"><ci id="S5.T3.9.9.9.1.1.m1.1.1.cmml" xref="S5.T3.9.9.9.1.1.m1.1.1">⇑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.9.9.9.1.1.m1.1c">\Uparrow</annotation></semantics></math></span></td>
<td id="S5.T3.9.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.1</td>
<td id="S5.T3.9.9.9.3" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="S5.T3.9.9.9.3.1" class="ltx_text">0.832</span></td>
<td id="S5.T3.9.9.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T3.9.9.9.4.1" class="ltx_text">0.8903</span></td>
<td id="S5.T3.9.9.9.5" class="ltx_td ltx_align_center ltx_border_t">0.7491</td>
<td id="S5.T3.9.9.9.6" class="ltx_td ltx_align_center ltx_border_t">0.7540</td>
<td id="S5.T3.9.9.9.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.9.9.9.7.1" class="ltx_text ltx_font_bold">0.7892</span></td>
<td id="S5.T3.9.9.9.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.9.9.9.8.1" class="ltx_text ltx_font_bold">0.7789</span></td>
<td id="S5.T3.9.9.9.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.7581</td>
<td id="S5.T3.9.9.9.10" class="ltx_td ltx_align_center ltx_border_t">0.7761</td>
<td id="S5.T3.9.9.9.11" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">0.7775</td>
</tr>
<tr id="S5.T3.11.11.17.5" class="ltx_tr">
<td id="S5.T3.11.11.17.5.1" class="ltx_td ltx_align_center ltx_border_r">0.5</td>
<td id="S5.T3.11.11.17.5.2" class="ltx_td ltx_align_center">0.7521</td>
<td id="S5.T3.11.11.17.5.3" class="ltx_td ltx_align_center">0.7423</td>
<td id="S5.T3.11.11.17.5.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S5.T3.11.11.17.5.4.1" class="ltx_text ltx_font_bold">0.7917</span></td>
<td id="S5.T3.11.11.17.5.5" class="ltx_td ltx_align_center">0.7770</td>
<td id="S5.T3.11.11.17.5.6" class="ltx_td ltx_align_center ltx_border_r">0.7614</td>
<td id="S5.T3.11.11.17.5.7" class="ltx_td ltx_align_center"><span id="S5.T3.11.11.17.5.7.1" class="ltx_text ltx_font_bold">0.7888</span></td>
<td id="S5.T3.11.11.17.5.8" class="ltx_td ltx_nopad_r ltx_align_center">0.7852</td>
</tr>
<tr id="S5.T3.11.11.18.6" class="ltx_tr">
<td id="S5.T3.11.11.18.6.1" class="ltx_td ltx_align_center ltx_border_r">1</td>
<td id="S5.T3.11.11.18.6.2" class="ltx_td ltx_align_center">0.7784</td>
<td id="S5.T3.11.11.18.6.3" class="ltx_td ltx_align_center">0.7791</td>
<td id="S5.T3.11.11.18.6.4" class="ltx_td ltx_align_center ltx_border_r">0.8001</td>
<td id="S5.T3.11.11.18.6.5" class="ltx_td ltx_align_center"><span id="S5.T3.11.11.18.6.5.1" class="ltx_text ltx_font_bold">0.8036</span></td>
<td id="S5.T3.11.11.18.6.6" class="ltx_td ltx_align_center ltx_border_r">0.7743</td>
<td id="S5.T3.11.11.18.6.7" class="ltx_td ltx_align_center">0.7849</td>
<td id="S5.T3.11.11.18.6.8" class="ltx_td ltx_nopad_r ltx_align_center">0.7993</td>
</tr>
<tr id="S5.T3.10.10.10" class="ltx_tr">
<td id="S5.T3.10.10.10.1" class="ltx_td ltx_align_left ltx_border_t" rowspan="3"><span id="S5.T3.10.10.10.1.1" class="ltx_text">BBBP<math id="S5.T3.10.10.10.1.1.m1.1" class="ltx_Math" alttext="\Uparrow" display="inline"><semantics id="S5.T3.10.10.10.1.1.m1.1a"><mo stretchy="false" id="S5.T3.10.10.10.1.1.m1.1.1" xref="S5.T3.10.10.10.1.1.m1.1.1.cmml">⇑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.10.10.10.1.1.m1.1b"><ci id="S5.T3.10.10.10.1.1.m1.1.1.cmml" xref="S5.T3.10.10.10.1.1.m1.1.1">⇑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.10.10.10.1.1.m1.1c">\Uparrow</annotation></semantics></math></span></td>
<td id="S5.T3.10.10.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.1</td>
<td id="S5.T3.10.10.10.3" class="ltx_td ltx_align_center ltx_border_t" rowspan="3"><span id="S5.T3.10.10.10.3.1" class="ltx_text">0.690</span></td>
<td id="S5.T3.10.10.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T3.10.10.10.4.1" class="ltx_text">0.8674</span></td>
<td id="S5.T3.10.10.10.5" class="ltx_td ltx_align_center ltx_border_t">0.8361</td>
<td id="S5.T3.10.10.10.6" class="ltx_td ltx_align_center ltx_border_t">0.8610</td>
<td id="S5.T3.10.10.10.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.10.10.10.7.1" class="ltx_text ltx_font_bold">0.8737</span></td>
<td id="S5.T3.10.10.10.8" class="ltx_td ltx_align_center ltx_border_t">0.8550</td>
<td id="S5.T3.10.10.10.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T3.10.10.10.9.1" class="ltx_text ltx_font_bold">0.8673</span></td>
<td id="S5.T3.10.10.10.10" class="ltx_td ltx_align_center ltx_border_t">0.8666</td>
<td id="S5.T3.10.10.10.11" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t">0.8663</td>
</tr>
<tr id="S5.T3.11.11.19.7" class="ltx_tr">
<td id="S5.T3.11.11.19.7.1" class="ltx_td ltx_align_center ltx_border_r">0.5</td>
<td id="S5.T3.11.11.19.7.2" class="ltx_td ltx_align_center">0.8594</td>
<td id="S5.T3.11.11.19.7.3" class="ltx_td ltx_align_center"><span id="S5.T3.11.11.19.7.3.1" class="ltx_text ltx_font_bold">0.8879</span></td>
<td id="S5.T3.11.11.19.7.4" class="ltx_td ltx_align_center ltx_border_r">0.8865</td>
<td id="S5.T3.11.11.19.7.5" class="ltx_td ltx_align_center">0.8726</td>
<td id="S5.T3.11.11.19.7.6" class="ltx_td ltx_align_center ltx_border_r">0.8641</td>
<td id="S5.T3.11.11.19.7.7" class="ltx_td ltx_align_center">0.8671</td>
<td id="S5.T3.11.11.19.7.8" class="ltx_td ltx_nopad_r ltx_align_center">0.8774</td>
</tr>
<tr id="S5.T3.11.11.20.8" class="ltx_tr">
<td id="S5.T3.11.11.20.8.1" class="ltx_td ltx_align_center ltx_border_r">1</td>
<td id="S5.T3.11.11.20.8.2" class="ltx_td ltx_align_center">0.8453</td>
<td id="S5.T3.11.11.20.8.3" class="ltx_td ltx_align_center"><span id="S5.T3.11.11.20.8.3.1" class="ltx_text ltx_font_bold">0.8557</span></td>
<td id="S5.T3.11.11.20.8.4" class="ltx_td ltx_align_center ltx_border_r">0.8487</td>
<td id="S5.T3.11.11.20.8.5" class="ltx_td ltx_align_center">0.8378</td>
<td id="S5.T3.11.11.20.8.6" class="ltx_td ltx_align_center ltx_border_r">0.8386</td>
<td id="S5.T3.11.11.20.8.7" class="ltx_td ltx_align_center">0.8515</td>
<td id="S5.T3.11.11.20.8.8" class="ltx_td ltx_nopad_r ltx_align_center">0.8515</td>
</tr>
<tr id="S5.T3.11.11.11" class="ltx_tr">
<td id="S5.T3.11.11.11.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" rowspan="3"><span id="S5.T3.11.11.11.1.1" class="ltx_text">BACE<math id="S5.T3.11.11.11.1.1.m1.1" class="ltx_Math" alttext="\Uparrow" display="inline"><semantics id="S5.T3.11.11.11.1.1.m1.1a"><mo stretchy="false" id="S5.T3.11.11.11.1.1.m1.1.1" xref="S5.T3.11.11.11.1.1.m1.1.1.cmml">⇑</mo><annotation-xml encoding="MathML-Content" id="S5.T3.11.11.11.1.1.m1.1b"><ci id="S5.T3.11.11.11.1.1.m1.1.1.cmml" xref="S5.T3.11.11.11.1.1.m1.1.1">⇑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.11.11.11.1.1.m1.1c">\Uparrow</annotation></semantics></math></span></td>
<td id="S5.T3.11.11.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.1</td>
<td id="S5.T3.11.11.11.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="3"><span id="S5.T3.11.11.11.3.1" class="ltx_text">0.806</span></td>
<td id="S5.T3.11.11.11.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" rowspan="3"><span id="S5.T3.11.11.11.4.1" class="ltx_text">0.8834</span></td>
<td id="S5.T3.11.11.11.5" class="ltx_td ltx_align_center ltx_border_t">0.8203</td>
<td id="S5.T3.11.11.11.6" class="ltx_td ltx_align_center ltx_border_t">0.8328</td>
<td id="S5.T3.11.11.11.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.8373</td>
<td id="S5.T3.11.11.11.8" class="ltx_td ltx_align_center ltx_border_t">0.8253</td>
<td id="S5.T3.11.11.11.9" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.8166</td>
<td id="S5.T3.11.11.11.10" class="ltx_td ltx_align_center ltx_border_t">0.8242</td>
<td id="S5.T3.11.11.11.11" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_t"><span id="S5.T3.11.11.11.11.1" class="ltx_text ltx_font_bold">0.8467</span></td>
</tr>
<tr id="S5.T3.11.11.21.9" class="ltx_tr">
<td id="S5.T3.11.11.21.9.1" class="ltx_td ltx_align_center ltx_border_r">0.5</td>
<td id="S5.T3.11.11.21.9.2" class="ltx_td ltx_align_center">0.8212</td>
<td id="S5.T3.11.11.21.9.3" class="ltx_td ltx_align_center">0.8398</td>
<td id="S5.T3.11.11.21.9.4" class="ltx_td ltx_align_center ltx_border_r">0.8285</td>
<td id="S5.T3.11.11.21.9.5" class="ltx_td ltx_align_center">0.8332</td>
<td id="S5.T3.11.11.21.9.6" class="ltx_td ltx_align_center ltx_border_r">0.8417</td>
<td id="S5.T3.11.11.21.9.7" class="ltx_td ltx_align_center">0.8516</td>
<td id="S5.T3.11.11.21.9.8" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.T3.11.11.21.9.8.1" class="ltx_text ltx_font_bold">0.8667</span></td>
</tr>
<tr id="S5.T3.11.11.22.10" class="ltx_tr">
<td id="S5.T3.11.11.22.10.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">1</td>
<td id="S5.T3.11.11.22.10.2" class="ltx_td ltx_align_center ltx_border_bb">0.8486</td>
<td id="S5.T3.11.11.22.10.3" class="ltx_td ltx_align_center ltx_border_bb">0.8408</td>
<td id="S5.T3.11.11.22.10.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">0.8561</td>
<td id="S5.T3.11.11.22.10.5" class="ltx_td ltx_align_center ltx_border_bb">0.8497</td>
<td id="S5.T3.11.11.22.10.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S5.T3.11.11.22.10.6.1" class="ltx_text ltx_font_bold">0.8578</span></td>
<td id="S5.T3.11.11.22.10.7" class="ltx_td ltx_align_center ltx_border_bb">0.8497</td>
<td id="S5.T3.11.11.22.10.8" class="ltx_td ltx_nopad_r ltx_align_center ltx_border_bb">0.8561</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Performance for federated molecular classification. <math id="S5.T3.14.m1.2" class="ltx_Math" alttext="\Downarrow,\Uparrow" display="inline"><semantics id="S5.T3.14.m1.2b"><mrow id="S5.T3.14.m1.2.3.2" xref="S5.T3.14.m1.2.3.1.cmml"><mo rspace="0em" stretchy="false" id="S5.T3.14.m1.1.1" xref="S5.T3.14.m1.1.1.cmml">⇓</mo><mo id="S5.T3.14.m1.2.3.2.1" xref="S5.T3.14.m1.2.3.1.cmml">,</mo><mo lspace="0em" stretchy="false" id="S5.T3.14.m1.2.2" xref="S5.T3.14.m1.2.2.cmml">⇑</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.T3.14.m1.2c"><list id="S5.T3.14.m1.2.3.1.cmml" xref="S5.T3.14.m1.2.3.2"><ci id="S5.T3.14.m1.1.1.cmml" xref="S5.T3.14.m1.1.1">⇓</ci><ci id="S5.T3.14.m1.2.2.cmml" xref="S5.T3.14.m1.2.2">⇑</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.14.m1.2d">\Downarrow,\Uparrow</annotation></semantics></math> indicate if lower or higher numbers are better. <math id="S5.T3.15.m2.1" class="ltx_Math" alttext="*" display="inline"><semantics id="S5.T3.15.m2.1b"><mo id="S5.T3.15.m2.1.1" xref="S5.T3.15.m2.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S5.T3.15.m2.1c"><times id="S5.T3.15.m2.1.1.cmml" xref="S5.T3.15.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.15.m2.1d">*</annotation></semantics></math> denotes the results are obtained with centralized training. Best federated learning results are highlighted in bold.</figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Compared Methods</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">To justify the proposed benchmark FedChem, we compare our results with MoleculeNet (MolNet) for centralized training <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>. To validate the effectiveness of FLIT(+), we compare FLIT(+) with Federated Averaging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, Federated Proximal (FedProx) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> and MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. Moreover, we also implement two variants of FLIT(+) as Federated Averaging with Focal loss for client training (FedFocal) and Federated Averaging with VAT for client training (FedVAT). We describe the compared methods as follows:</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<ol id="S5.I1" class="ltx_enumerate">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p">Federated Averaging (FedAvg) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> simply element-wisely aggregates the local models to a global one;</p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.1" class="ltx_p">Federated Proximal (FedProx) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> regularizes the local training to alleviate the heterogeneity problem;</p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.1" class="ltx_p">MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> applies contrastive learning for federated learning to correct the local training;</p>
</div>
</li>
<li id="S5.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S5.I1.i4.p1" class="ltx_para">
<p id="S5.I1.i4.p1.1" class="ltx_p">Federated Focal (FedFocal) is proposed in this paper and is a variant of FLIT. FedFocal applies focal loss Eq.(<a href="#S4.E4" title="In 4.1 Federated Learning by Instance Reweighting ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) to local training and adopts FedAvg for server update. FedFocal is proposed to validate the effectiveness of involving the global model into local training as FLIT;</p>
</div>
</li>
<li id="S5.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">5.</span> 
<div id="S5.I1.i5.p1" class="ltx_para">
<p id="S5.I1.i5.p1.1" class="ltx_p">Federated VAT (FedVAT) is also proposed in this paper and is a variant of FLIT+. FedVAT jointly optimizes Eq. (<a href="#S4.E9" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) and original training loss for client training and adopts FedAvg for server update. Compared with FLIT+, FedVAT does not use instance reweighting training strategy;</p>
</div>
</li>
<li id="S5.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">6.</span> 
<div id="S5.I1.i6.p1" class="ltx_para">
<p id="S5.I1.i6.p1.1" class="ltx_p">Federated Learning by Instance reweighTing (FLIT) is proposed in this paper and is described in Algorithm <a href="#alg2" title="Algorithm 2 ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
</li>
<li id="S5.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">7.</span> 
<div id="S5.I1.i7.p1" class="ltx_para">
<p id="S5.I1.i7.p1.1" class="ltx_p">FLIT+ is proposed in this paper. Compared with FLIT, FLIT+ jointly uses loss values and the discrepancy between nearby samples to measure the uncertainty of samples as described in Eq. <a href="#S4.E10" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, and adopts Eq. <a href="#S4.E11" title="In 4.2 FLIT+ ‣ 4 Federated Learning by Instance Reweighting FLIT(+) ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> as the learning objective.</p>
</div>
</li>
</ol>
<p id="S5.SS2.p2.8" class="ltx_p">We perform grid search on the excluded validation set for hyperparameter tuning and model selection. For FedProx, we search the hyperparameter <math id="S5.SS2.p2.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S5.SS2.p2.1.m1.1a"><mi id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b"><ci id="S5.SS2.p2.1.m1.1.1.cmml" xref="S5.SS2.p2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">\mu</annotation></semantics></math> from <math id="S5.SS2.p2.2.m2.5" class="ltx_Math" alttext="[0.001,0.01,0.1,1,10]" display="inline"><semantics id="S5.SS2.p2.2.m2.5a"><mrow id="S5.SS2.p2.2.m2.5.6.2" xref="S5.SS2.p2.2.m2.5.6.1.cmml"><mo stretchy="false" id="S5.SS2.p2.2.m2.5.6.2.1" xref="S5.SS2.p2.2.m2.5.6.1.cmml">[</mo><mn id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">0.001</mn><mo id="S5.SS2.p2.2.m2.5.6.2.2" xref="S5.SS2.p2.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS2.p2.2.m2.2.2" xref="S5.SS2.p2.2.m2.2.2.cmml">0.01</mn><mo id="S5.SS2.p2.2.m2.5.6.2.3" xref="S5.SS2.p2.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS2.p2.2.m2.3.3" xref="S5.SS2.p2.2.m2.3.3.cmml">0.1</mn><mo id="S5.SS2.p2.2.m2.5.6.2.4" xref="S5.SS2.p2.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS2.p2.2.m2.4.4" xref="S5.SS2.p2.2.m2.4.4.cmml">1</mn><mo id="S5.SS2.p2.2.m2.5.6.2.5" xref="S5.SS2.p2.2.m2.5.6.1.cmml">,</mo><mn id="S5.SS2.p2.2.m2.5.5" xref="S5.SS2.p2.2.m2.5.5.cmml">10</mn><mo stretchy="false" id="S5.SS2.p2.2.m2.5.6.2.6" xref="S5.SS2.p2.2.m2.5.6.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.5b"><list id="S5.SS2.p2.2.m2.5.6.1.cmml" xref="S5.SS2.p2.2.m2.5.6.2"><cn type="float" id="S5.SS2.p2.2.m2.1.1.cmml" xref="S5.SS2.p2.2.m2.1.1">0.001</cn><cn type="float" id="S5.SS2.p2.2.m2.2.2.cmml" xref="S5.SS2.p2.2.m2.2.2">0.01</cn><cn type="float" id="S5.SS2.p2.2.m2.3.3.cmml" xref="S5.SS2.p2.2.m2.3.3">0.1</cn><cn type="integer" id="S5.SS2.p2.2.m2.4.4.cmml" xref="S5.SS2.p2.2.m2.4.4">1</cn><cn type="integer" id="S5.SS2.p2.2.m2.5.5.cmml" xref="S5.SS2.p2.2.m2.5.5">10</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.5c">[0.001,0.01,0.1,1,10]</annotation></semantics></math>. For MOON, we search the hyperparameter from <math id="S5.SS2.p2.3.m3.4" class="ltx_Math" alttext="[0.1,1,5,10]" display="inline"><semantics id="S5.SS2.p2.3.m3.4a"><mrow id="S5.SS2.p2.3.m3.4.5.2" xref="S5.SS2.p2.3.m3.4.5.1.cmml"><mo stretchy="false" id="S5.SS2.p2.3.m3.4.5.2.1" xref="S5.SS2.p2.3.m3.4.5.1.cmml">[</mo><mn id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml">0.1</mn><mo id="S5.SS2.p2.3.m3.4.5.2.2" xref="S5.SS2.p2.3.m3.4.5.1.cmml">,</mo><mn id="S5.SS2.p2.3.m3.2.2" xref="S5.SS2.p2.3.m3.2.2.cmml">1</mn><mo id="S5.SS2.p2.3.m3.4.5.2.3" xref="S5.SS2.p2.3.m3.4.5.1.cmml">,</mo><mn id="S5.SS2.p2.3.m3.3.3" xref="S5.SS2.p2.3.m3.3.3.cmml">5</mn><mo id="S5.SS2.p2.3.m3.4.5.2.4" xref="S5.SS2.p2.3.m3.4.5.1.cmml">,</mo><mn id="S5.SS2.p2.3.m3.4.4" xref="S5.SS2.p2.3.m3.4.4.cmml">10</mn><mo stretchy="false" id="S5.SS2.p2.3.m3.4.5.2.5" xref="S5.SS2.p2.3.m3.4.5.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.4b"><list id="S5.SS2.p2.3.m3.4.5.1.cmml" xref="S5.SS2.p2.3.m3.4.5.2"><cn type="float" id="S5.SS2.p2.3.m3.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1">0.1</cn><cn type="integer" id="S5.SS2.p2.3.m3.2.2.cmml" xref="S5.SS2.p2.3.m3.2.2">1</cn><cn type="integer" id="S5.SS2.p2.3.m3.3.3.cmml" xref="S5.SS2.p2.3.m3.3.3">5</cn><cn type="integer" id="S5.SS2.p2.3.m3.4.4.cmml" xref="S5.SS2.p2.3.m3.4.4">10</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.4c">[0.1,1,5,10]</annotation></semantics></math>. We search <math id="S5.SS2.p2.4.m4.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S5.SS2.p2.4.m4.1a"><mi id="S5.SS2.p2.4.m4.1.1" xref="S5.SS2.p2.4.m4.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.4.m4.1b"><ci id="S5.SS2.p2.4.m4.1.1.cmml" xref="S5.SS2.p2.4.m4.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.4.m4.1c">\gamma</annotation></semantics></math> used for instance reweighting for FLIT(+) and FedFocal from <math id="S5.SS2.p2.5.m5.3" class="ltx_Math" alttext="[0.5,1,2]" display="inline"><semantics id="S5.SS2.p2.5.m5.3a"><mrow id="S5.SS2.p2.5.m5.3.4.2" xref="S5.SS2.p2.5.m5.3.4.1.cmml"><mo stretchy="false" id="S5.SS2.p2.5.m5.3.4.2.1" xref="S5.SS2.p2.5.m5.3.4.1.cmml">[</mo><mn id="S5.SS2.p2.5.m5.1.1" xref="S5.SS2.p2.5.m5.1.1.cmml">0.5</mn><mo id="S5.SS2.p2.5.m5.3.4.2.2" xref="S5.SS2.p2.5.m5.3.4.1.cmml">,</mo><mn id="S5.SS2.p2.5.m5.2.2" xref="S5.SS2.p2.5.m5.2.2.cmml">1</mn><mo id="S5.SS2.p2.5.m5.3.4.2.3" xref="S5.SS2.p2.5.m5.3.4.1.cmml">,</mo><mn id="S5.SS2.p2.5.m5.3.3" xref="S5.SS2.p2.5.m5.3.3.cmml">2</mn><mo stretchy="false" id="S5.SS2.p2.5.m5.3.4.2.4" xref="S5.SS2.p2.5.m5.3.4.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.5.m5.3b"><list id="S5.SS2.p2.5.m5.3.4.1.cmml" xref="S5.SS2.p2.5.m5.3.4.2"><cn type="float" id="S5.SS2.p2.5.m5.1.1.cmml" xref="S5.SS2.p2.5.m5.1.1">0.5</cn><cn type="integer" id="S5.SS2.p2.5.m5.2.2.cmml" xref="S5.SS2.p2.5.m5.2.2">1</cn><cn type="integer" id="S5.SS2.p2.5.m5.3.3.cmml" xref="S5.SS2.p2.5.m5.3.3">2</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.5.m5.3c">[0.5,1,2]</annotation></semantics></math>, and search <math id="S5.SS2.p2.6.m6.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S5.SS2.p2.6.m6.1a"><mi id="S5.SS2.p2.6.m6.1.1" xref="S5.SS2.p2.6.m6.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.6.m6.1b"><ci id="S5.SS2.p2.6.m6.1.1.cmml" xref="S5.SS2.p2.6.m6.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.6.m6.1c">\lambda</annotation></semantics></math> from <math id="S5.SS2.p2.7.m7.3" class="ltx_Math" alttext="[0.01,0.1,1]" display="inline"><semantics id="S5.SS2.p2.7.m7.3a"><mrow id="S5.SS2.p2.7.m7.3.4.2" xref="S5.SS2.p2.7.m7.3.4.1.cmml"><mo stretchy="false" id="S5.SS2.p2.7.m7.3.4.2.1" xref="S5.SS2.p2.7.m7.3.4.1.cmml">[</mo><mn id="S5.SS2.p2.7.m7.1.1" xref="S5.SS2.p2.7.m7.1.1.cmml">0.01</mn><mo id="S5.SS2.p2.7.m7.3.4.2.2" xref="S5.SS2.p2.7.m7.3.4.1.cmml">,</mo><mn id="S5.SS2.p2.7.m7.2.2" xref="S5.SS2.p2.7.m7.2.2.cmml">0.1</mn><mo id="S5.SS2.p2.7.m7.3.4.2.3" xref="S5.SS2.p2.7.m7.3.4.1.cmml">,</mo><mn id="S5.SS2.p2.7.m7.3.3" xref="S5.SS2.p2.7.m7.3.3.cmml">1</mn><mo stretchy="false" id="S5.SS2.p2.7.m7.3.4.2.4" xref="S5.SS2.p2.7.m7.3.4.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.7.m7.3b"><list id="S5.SS2.p2.7.m7.3.4.1.cmml" xref="S5.SS2.p2.7.m7.3.4.2"><cn type="float" id="S5.SS2.p2.7.m7.1.1.cmml" xref="S5.SS2.p2.7.m7.1.1">0.01</cn><cn type="float" id="S5.SS2.p2.7.m7.2.2.cmml" xref="S5.SS2.p2.7.m7.2.2">0.1</cn><cn type="integer" id="S5.SS2.p2.7.m7.3.3.cmml" xref="S5.SS2.p2.7.m7.3.3">1</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.7.m7.3c">[0.01,0.1,1]</annotation></semantics></math> for FLIT+. FedVAT adopts a hyperparameter to balance VAT loss and primary loss which is searched from <math id="S5.SS2.p2.8.m8.3" class="ltx_Math" alttext="[0.01,0.1,1]" display="inline"><semantics id="S5.SS2.p2.8.m8.3a"><mrow id="S5.SS2.p2.8.m8.3.4.2" xref="S5.SS2.p2.8.m8.3.4.1.cmml"><mo stretchy="false" id="S5.SS2.p2.8.m8.3.4.2.1" xref="S5.SS2.p2.8.m8.3.4.1.cmml">[</mo><mn id="S5.SS2.p2.8.m8.1.1" xref="S5.SS2.p2.8.m8.1.1.cmml">0.01</mn><mo id="S5.SS2.p2.8.m8.3.4.2.2" xref="S5.SS2.p2.8.m8.3.4.1.cmml">,</mo><mn id="S5.SS2.p2.8.m8.2.2" xref="S5.SS2.p2.8.m8.2.2.cmml">0.1</mn><mo id="S5.SS2.p2.8.m8.3.4.2.3" xref="S5.SS2.p2.8.m8.3.4.1.cmml">,</mo><mn id="S5.SS2.p2.8.m8.3.3" xref="S5.SS2.p2.8.m8.3.3.cmml">1</mn><mo stretchy="false" id="S5.SS2.p2.8.m8.3.4.2.4" xref="S5.SS2.p2.8.m8.3.4.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p2.8.m8.3b"><list id="S5.SS2.p2.8.m8.3.4.1.cmml" xref="S5.SS2.p2.8.m8.3.4.2"><cn type="float" id="S5.SS2.p2.8.m8.1.1.cmml" xref="S5.SS2.p2.8.m8.1.1">0.01</cn><cn type="float" id="S5.SS2.p2.8.m8.2.2.cmml" xref="S5.SS2.p2.8.m8.2.2">0.1</cn><cn type="integer" id="S5.SS2.p2.8.m8.3.3.cmml" xref="S5.SS2.p2.8.m8.3.3">1</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p2.8.m8.3c">[0.01,0.1,1]</annotation></semantics></math>. We report results on the testing set by the model with the best performance on the validation set.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Main Results</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.3" class="ltx_p">The experimental results on regression and classification datasets are shown in Table <a href="#S5.T2" title="Table 2 ‣ 5.1 Datasets ‣ 5 Experimental Procedures ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and Table <a href="#S5.T3" title="Table 3 ‣ 5.1 Datasets ‣ 5 Experimental Procedures ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> respectively. We draw several points according to the results. First, comparing our centralized training results (denoted as FedChem) with MolNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>, we obtain competitive results by using MPNNs2s <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> and SchNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. Specifically, we obtain a significant performance gain by adopting SchNet for QM9 dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. Second, comparing the performance of FedAvg with different <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mi id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><ci id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\alpha</annotation></semantics></math> for each dataset, we can conclude that the heterogeneity settings introduced by FedChem indeed lead to performance degradation for 7 out of 9 datasets (i.e., FreeSolv, ESOL, QM9, Tox21, ClinTox, BBBP, and BACE). FedAvg shows stable performance for Lipophilicity and SIDER. The reason may be that we do not consider the relation between scaffold subgroups in our current settings, and the resulted clients’ datasets are rather homogeneous. Third, we observe a significant performance gain for most datasets by comparing heterogeneous federated learning methods with FedAvg. For example, the proposed FLIP+ achieves a 0.543 improvement with <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">α</mi><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><eq id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1"></eq><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝛼</ci><cn type="float" id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">\alpha=0.1</annotation></semantics></math> and 0.162 improvement with <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mrow id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml"><mi id="S5.SS3.p1.3.m3.1.1.2" xref="S5.SS3.p1.3.m3.1.1.2.cmml">α</mi><mo id="S5.SS3.p1.3.m3.1.1.1" xref="S5.SS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.3.m3.1.1.3" xref="S5.SS3.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><apply id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1"><eq id="S5.SS3.p1.3.m3.1.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1.1"></eq><ci id="S5.SS3.p1.3.m3.1.1.2.cmml" xref="S5.SS3.p1.3.m3.1.1.2">𝛼</ci><cn type="integer" id="S5.SS3.p1.3.m3.1.1.3.cmml" xref="S5.SS3.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">\alpha=1</annotation></semantics></math> for FreeSolv. The results suggest the necessity to mitigate the heterogeneity when conducting federated learning and validate the effectiveness of the proposed FLIT(+). However, we also observe that the performance improvements of our methods are rather marginal for several datasets. The reasons may be attributed to the fact that our current scaffold splitting may not lead to heterogeneous datasets. We will continue our work for a better method to simulate the heterogeneity problem for federated molecular property prediction.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.3" class="ltx_p">Moreover, the proposed instance-reweighting methods (FedFocal, FLIT, and FLIT+) outperform the regularization-based methods FedProx and MOON. The proposed FLIT additionally utilizes the global model and performs better than its counterpart FedFocal. For example, FLIT improves FedFocal from 0.8022 to 0.7788 with <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="\alpha=0.1" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml"><mi id="S5.SS3.p2.1.m1.1.1.2" xref="S5.SS3.p2.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS3.p2.1.m1.1.1.1" xref="S5.SS3.p2.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.1.m1.1.1.3" xref="S5.SS3.p2.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><apply id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1"><eq id="S5.SS3.p2.1.m1.1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1.1"></eq><ci id="S5.SS3.p2.1.m1.1.1.2.cmml" xref="S5.SS3.p2.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.SS3.p2.1.m1.1.1.3.cmml" xref="S5.SS3.p2.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">\alpha=0.1</annotation></semantics></math> and from 0.7708 to 0.7426 with <math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml"><mi id="S5.SS3.p2.2.m2.1.1.2" xref="S5.SS3.p2.2.m2.1.1.2.cmml">α</mi><mo id="S5.SS3.p2.2.m2.1.1.1" xref="S5.SS3.p2.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS3.p2.2.m2.1.1.3" xref="S5.SS3.p2.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.2.m2.1b"><apply id="S5.SS3.p2.2.m2.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1"><eq id="S5.SS3.p2.2.m2.1.1.1.cmml" xref="S5.SS3.p2.2.m2.1.1.1"></eq><ci id="S5.SS3.p2.2.m2.1.1.2.cmml" xref="S5.SS3.p2.2.m2.1.1.2">𝛼</ci><cn type="float" id="S5.SS3.p2.2.m2.1.1.3.cmml" xref="S5.SS3.p2.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.2.m2.1c">\alpha=0.5</annotation></semantics></math> for ESOL. Lastly, FLIT+ further improves the performance of FLIT by measuring the uncertainty with loss values and discrepancy between neighbors. We also observe that FedVAT can benefit federated learning by encouraging locality smoothness for better generalization performance. By incorporating VAT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> into the FLIT framework, FLIT+ achieves the best overall performance. FLIT(+) has more consistent results across different settings of <math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><mi id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.3.m3.1b"><ci id="S5.SS3.p2.3.m3.1.1.cmml" xref="S5.SS3.p2.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.3.m3.1c">\alpha</annotation></semantics></math> compared with its counterparts, indicating the effectiveness of FLIT+ for dealing with heterogeneity problems.</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.07258/assets/x3.png" id="S5.F3.sf1.g1" class="ltx_graphics ltx_img_landscape" width="138" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf1.4.2.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S5.F3.sf1.2.1" class="ltx_text" style="font-size:80%;">ESOL<math id="S5.F3.sf1.2.1.m1.1" class="ltx_Math" alttext="\Downarrow" display="inline"><semantics id="S5.F3.sf1.2.1.m1.1b"><mo stretchy="false" id="S5.F3.sf1.2.1.m1.1.1" xref="S5.F3.sf1.2.1.m1.1.1.cmml">⇓</mo><annotation-xml encoding="MathML-Content" id="S5.F3.sf1.2.1.m1.1c"><ci id="S5.F3.sf1.2.1.m1.1.1.cmml" xref="S5.F3.sf1.2.1.m1.1.1">⇓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.sf1.2.1.m1.1d">\Downarrow</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.07258/assets/x4.png" id="S5.F3.sf2.g1" class="ltx_graphics ltx_img_landscape" width="138" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf2.4.2.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S5.F3.sf2.2.1" class="ltx_text" style="font-size:80%;">ClinTox<math id="S5.F3.sf2.2.1.m1.1" class="ltx_Math" alttext="\Uparrow" display="inline"><semantics id="S5.F3.sf2.2.1.m1.1b"><mo stretchy="false" id="S5.F3.sf2.2.1.m1.1.1" xref="S5.F3.sf2.2.1.m1.1.1.cmml">⇑</mo><annotation-xml encoding="MathML-Content" id="S5.F3.sf2.2.1.m1.1c"><ci id="S5.F3.sf2.2.1.m1.1.1.cmml" xref="S5.F3.sf2.2.1.m1.1.1">⇑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.sf2.2.1.m1.1d">\Uparrow</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.07258/assets/x5.png" id="S5.F3.sf3.g1" class="ltx_graphics ltx_img_landscape" width="138" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf3.4.2.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S5.F3.sf3.2.1" class="ltx_text" style="font-size:80%;">BACE<math id="S5.F3.sf3.2.1.m1.1" class="ltx_Math" alttext="\Uparrow" display="inline"><semantics id="S5.F3.sf3.2.1.m1.1b"><mo stretchy="false" id="S5.F3.sf3.2.1.m1.1.1" xref="S5.F3.sf3.2.1.m1.1.1.cmml">⇑</mo><annotation-xml encoding="MathML-Content" id="S5.F3.sf3.2.1.m1.1c"><ci id="S5.F3.sf3.2.1.m1.1.1.cmml" xref="S5.F3.sf3.2.1.m1.1.1">⇑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.sf3.2.1.m1.1d">\Uparrow</annotation></semantics></math></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Performance of baseline and our methods with varying communication rounds. <math id="S5.F3.2.m1.1" class="ltx_Math" alttext="*" display="inline"><semantics id="S5.F3.2.m1.1b"><mo id="S5.F3.2.m1.1.1" xref="S5.F3.2.m1.1.1.cmml">∗</mo><annotation-xml encoding="MathML-Content" id="S5.F3.2.m1.1c"><times id="S5.F3.2.m1.1.1.cmml" xref="S5.F3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.2.m1.1d">*</annotation></semantics></math> denotes that the results are obtained with centralized training. We find our method has a strong advantage with a few communication rounds.</figcaption>
</figure>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Sensitivity Analysis for Federated Learning</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.2" class="ltx_p">This section studies the influence of the number of clients and communication rounds on the federated learning performance. For simplicity, we conduct experiments on ESOL, ClinTox, and BACE. The results of the different number of maximum communication rounds are shown in Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.4 Sensitivity Analysis for Federated Learning ‣ 5 Experimental Procedures ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We vary the maximum communication round from <math id="S5.SS4.p1.1.m1.3" class="ltx_Math" alttext="\{15,30,50\}" display="inline"><semantics id="S5.SS4.p1.1.m1.3a"><mrow id="S5.SS4.p1.1.m1.3.4.2" xref="S5.SS4.p1.1.m1.3.4.1.cmml"><mo stretchy="false" id="S5.SS4.p1.1.m1.3.4.2.1" xref="S5.SS4.p1.1.m1.3.4.1.cmml">{</mo><mn id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml">15</mn><mo id="S5.SS4.p1.1.m1.3.4.2.2" xref="S5.SS4.p1.1.m1.3.4.1.cmml">,</mo><mn id="S5.SS4.p1.1.m1.2.2" xref="S5.SS4.p1.1.m1.2.2.cmml">30</mn><mo id="S5.SS4.p1.1.m1.3.4.2.3" xref="S5.SS4.p1.1.m1.3.4.1.cmml">,</mo><mn id="S5.SS4.p1.1.m1.3.3" xref="S5.SS4.p1.1.m1.3.3.cmml">50</mn><mo stretchy="false" id="S5.SS4.p1.1.m1.3.4.2.4" xref="S5.SS4.p1.1.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.3b"><set id="S5.SS4.p1.1.m1.3.4.1.cmml" xref="S5.SS4.p1.1.m1.3.4.2"><cn type="integer" id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">15</cn><cn type="integer" id="S5.SS4.p1.1.m1.2.2.cmml" xref="S5.SS4.p1.1.m1.2.2">30</cn><cn type="integer" id="S5.SS4.p1.1.m1.3.3.cmml" xref="S5.SS4.p1.1.m1.3.3">50</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.3c">\{15,30,50\}</annotation></semantics></math> while fixing the total local steps. We find that increasing the frequency of communication can benefit federated learning, although it also leads to increased transfer costs. The performance with different numbers of clients is shown in Fig. <a href="#S5.F4" title="Figure 4 ‣ 5.4 Sensitivity Analysis for Federated Learning ‣ 5 Experimental Procedures ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. We vary the number of clients within <math id="S5.SS4.p1.2.m2.3" class="ltx_Math" alttext="\{4,5,6\}" display="inline"><semantics id="S5.SS4.p1.2.m2.3a"><mrow id="S5.SS4.p1.2.m2.3.4.2" xref="S5.SS4.p1.2.m2.3.4.1.cmml"><mo stretchy="false" id="S5.SS4.p1.2.m2.3.4.2.1" xref="S5.SS4.p1.2.m2.3.4.1.cmml">{</mo><mn id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml">4</mn><mo id="S5.SS4.p1.2.m2.3.4.2.2" xref="S5.SS4.p1.2.m2.3.4.1.cmml">,</mo><mn id="S5.SS4.p1.2.m2.2.2" xref="S5.SS4.p1.2.m2.2.2.cmml">5</mn><mo id="S5.SS4.p1.2.m2.3.4.2.3" xref="S5.SS4.p1.2.m2.3.4.1.cmml">,</mo><mn id="S5.SS4.p1.2.m2.3.3" xref="S5.SS4.p1.2.m2.3.3.cmml">6</mn><mo stretchy="false" id="S5.SS4.p1.2.m2.3.4.2.4" xref="S5.SS4.p1.2.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.3b"><set id="S5.SS4.p1.2.m2.3.4.1.cmml" xref="S5.SS4.p1.2.m2.3.4.2"><cn type="integer" id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">4</cn><cn type="integer" id="S5.SS4.p1.2.m2.2.2.cmml" xref="S5.SS4.p1.2.m2.2.2">5</cn><cn type="integer" id="S5.SS4.p1.2.m2.3.3.cmml" xref="S5.SS4.p1.2.m2.3.3">6</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.3c">\{4,5,6\}</annotation></semantics></math> since a large number of clients would lead to over small local datasets, which is not plausible for valid training. We find that the performance of federated learning usually decreases (ESOL and BACE) or is stable (ClinTox) as the client number increases. This indicates that small-scale local training data degrade the federated learning performance.</p>
</div>
<figure id="S5.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F4.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.07258/assets/x6.png" id="S5.F4.sf1.g1" class="ltx_graphics ltx_img_landscape" width="138" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf1.4.2.1" class="ltx_text" style="font-size:80%;">(a)</span> </span><span id="S5.F4.sf1.2.1" class="ltx_text" style="font-size:80%;">ESOL<math id="S5.F4.sf1.2.1.m1.1" class="ltx_Math" alttext="\Downarrow" display="inline"><semantics id="S5.F4.sf1.2.1.m1.1b"><mo stretchy="false" id="S5.F4.sf1.2.1.m1.1.1" xref="S5.F4.sf1.2.1.m1.1.1.cmml">⇓</mo><annotation-xml encoding="MathML-Content" id="S5.F4.sf1.2.1.m1.1c"><ci id="S5.F4.sf1.2.1.m1.1.1.cmml" xref="S5.F4.sf1.2.1.m1.1.1">⇓</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.sf1.2.1.m1.1d">\Downarrow</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F4.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.07258/assets/x7.png" id="S5.F4.sf2.g1" class="ltx_graphics ltx_img_landscape" width="138" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf2.4.2.1" class="ltx_text" style="font-size:80%;">(b)</span> </span><span id="S5.F4.sf2.2.1" class="ltx_text" style="font-size:80%;">ClinTox<math id="S5.F4.sf2.2.1.m1.1" class="ltx_Math" alttext="\Uparrow" display="inline"><semantics id="S5.F4.sf2.2.1.m1.1b"><mo stretchy="false" id="S5.F4.sf2.2.1.m1.1.1" xref="S5.F4.sf2.2.1.m1.1.1.cmml">⇑</mo><annotation-xml encoding="MathML-Content" id="S5.F4.sf2.2.1.m1.1c"><ci id="S5.F4.sf2.2.1.m1.1.1.cmml" xref="S5.F4.sf2.2.1.m1.1.1">⇑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.sf2.2.1.m1.1d">\Uparrow</annotation></semantics></math></span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F4.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2109.07258/assets/x8.png" id="S5.F4.sf3.g1" class="ltx_graphics ltx_img_landscape" width="138" height="103" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.F4.sf3.4.2.1" class="ltx_text" style="font-size:80%;">(c)</span> </span><span id="S5.F4.sf3.2.1" class="ltx_text" style="font-size:80%;">BACE<math id="S5.F4.sf3.2.1.m1.1" class="ltx_Math" alttext="\Uparrow" display="inline"><semantics id="S5.F4.sf3.2.1.m1.1b"><mo stretchy="false" id="S5.F4.sf3.2.1.m1.1.1" xref="S5.F4.sf3.2.1.m1.1.1.cmml">⇑</mo><annotation-xml encoding="MathML-Content" id="S5.F4.sf3.2.1.m1.1c"><ci id="S5.F4.sf3.2.1.m1.1.1.cmml" xref="S5.F4.sf3.2.1.m1.1.1">⇑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F4.sf3.2.1.m1.1d">\Uparrow</annotation></semantics></math></span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance of baseline and our methods with different number of clients. See Figure <a href="#S5.F3" title="Figure 3 ‣ 5.3 Main Results ‣ 5 Experimental Procedures ‣ Federated Learning of Molecular Properties with Graph Neural Networks in a Heterogeneous Setting" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> for color legend. The small scale local training data reduce federated learning performance for all methods. </figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Settings for Heterogeneous FedChem</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.7" class="ltx_p">For all datasets except QM9, we first randomly split the dataset into 80<math id="S6.p1.1.m1.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S6.p1.1.m1.1a"><mo id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><csymbol cd="latexml" id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">\%</annotation></semantics></math> for training, 10<math id="S6.p1.2.m2.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S6.p1.2.m2.1a"><mo id="S6.p1.2.m2.1.1" xref="S6.p1.2.m2.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S6.p1.2.m2.1b"><csymbol cd="latexml" id="S6.p1.2.m2.1.1.cmml" xref="S6.p1.2.m2.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">\%</annotation></semantics></math> for validation, and 10<math id="S6.p1.3.m3.1" class="ltx_Math" alttext="\%" display="inline"><semantics id="S6.p1.3.m3.1a"><mo id="S6.p1.3.m3.1.1" xref="S6.p1.3.m3.1.1.cmml">%</mo><annotation-xml encoding="MathML-Content" id="S6.p1.3.m3.1b"><csymbol cd="latexml" id="S6.p1.3.m3.1.1.cmml" xref="S6.p1.3.m3.1.1">percent</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.3.m3.1c">\%</annotation></semantics></math> for testing following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib57" title="" class="ltx_ref">57</a>]</cite>. QM9 is partitioned into 110,000 samples for training, 10,000 samples for validation, and the remaining for testing following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>. To simulate the heterogeneous settings for federated learning, we first perform scaffold splitting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> to partition the training data into subgroups. Then, we assign the molecules of each subgroup to clients by Latent Dirichlet Allocation (LDA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. We control the degree of heterogeneity by tuning <math id="S6.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.p1.4.m4.1a"><mi id="S6.p1.4.m4.1.1" xref="S6.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.p1.4.m4.1b"><ci id="S6.p1.4.m4.1.1.cmml" xref="S6.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.4.m4.1c">\alpha</annotation></semantics></math> for LDA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>. Smaller <math id="S6.p1.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.p1.5.m5.1a"><mi id="S6.p1.5.m5.1.1" xref="S6.p1.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.p1.5.m5.1b"><ci id="S6.p1.5.m5.1.1.cmml" xref="S6.p1.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.5.m5.1c">\alpha</annotation></semantics></math> leads to more severe heterogeneity and we vary <math id="S6.p1.6.m6.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.p1.6.m6.1a"><mi id="S6.p1.6.m6.1.1" xref="S6.p1.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.p1.6.m6.1b"><ci id="S6.p1.6.m6.1.1.cmml" xref="S6.p1.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.6.m6.1c">\alpha</annotation></semantics></math> from <math id="S6.p1.7.m7.3" class="ltx_Math" alttext="\{0.1,0.5,1\}" display="inline"><semantics id="S6.p1.7.m7.3a"><mrow id="S6.p1.7.m7.3.4.2" xref="S6.p1.7.m7.3.4.1.cmml"><mo stretchy="false" id="S6.p1.7.m7.3.4.2.1" xref="S6.p1.7.m7.3.4.1.cmml">{</mo><mn id="S6.p1.7.m7.1.1" xref="S6.p1.7.m7.1.1.cmml">0.1</mn><mo id="S6.p1.7.m7.3.4.2.2" xref="S6.p1.7.m7.3.4.1.cmml">,</mo><mn id="S6.p1.7.m7.2.2" xref="S6.p1.7.m7.2.2.cmml">0.5</mn><mo id="S6.p1.7.m7.3.4.2.3" xref="S6.p1.7.m7.3.4.1.cmml">,</mo><mn id="S6.p1.7.m7.3.3" xref="S6.p1.7.m7.3.3.cmml">1</mn><mo stretchy="false" id="S6.p1.7.m7.3.4.2.4" xref="S6.p1.7.m7.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.7.m7.3b"><set id="S6.p1.7.m7.3.4.1.cmml" xref="S6.p1.7.m7.3.4.2"><cn type="float" id="S6.p1.7.m7.1.1.cmml" xref="S6.p1.7.m7.1.1">0.1</cn><cn type="float" id="S6.p1.7.m7.2.2.cmml" xref="S6.p1.7.m7.2.2">0.5</cn><cn type="integer" id="S6.p1.7.m7.3.3.cmml" xref="S6.p1.7.m7.3.3">1</cn></set></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.7.m7.3c">\{0.1,0.5,1\}</annotation></semantics></math>. Moreover, we deliberately balance the number of molecules for each client following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> to control for the effect of the example number on performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">As for federated learning settings, we set the default communication rounds <math id="S6.p2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S6.p2.1.m1.1a"><mi id="S6.p2.1.m1.1.1" xref="S6.p2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S6.p2.1.m1.1b"><ci id="S6.p2.1.m1.1.1.cmml" xref="S6.p2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p2.1.m1.1c">C</annotation></semantics></math> to 30 and the default number of clients to four for all datasets except for QM9, which is set to eight.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.2" class="ltx_p">For client training, we set the batch size to 64 and use Adam <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> with a learning rate of <math id="S6.p3.1.m1.1" class="ltx_Math" alttext="1\times 10^{-4}" display="inline"><semantics id="S6.p3.1.m1.1a"><mrow id="S6.p3.1.m1.1.1" xref="S6.p3.1.m1.1.1.cmml"><mn id="S6.p3.1.m1.1.1.2" xref="S6.p3.1.m1.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S6.p3.1.m1.1.1.1" xref="S6.p3.1.m1.1.1.1.cmml">×</mo><msup id="S6.p3.1.m1.1.1.3" xref="S6.p3.1.m1.1.1.3.cmml"><mn id="S6.p3.1.m1.1.1.3.2" xref="S6.p3.1.m1.1.1.3.2.cmml">10</mn><mrow id="S6.p3.1.m1.1.1.3.3" xref="S6.p3.1.m1.1.1.3.3.cmml"><mo id="S6.p3.1.m1.1.1.3.3a" xref="S6.p3.1.m1.1.1.3.3.cmml">−</mo><mn id="S6.p3.1.m1.1.1.3.3.2" xref="S6.p3.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.1.m1.1b"><apply id="S6.p3.1.m1.1.1.cmml" xref="S6.p3.1.m1.1.1"><times id="S6.p3.1.m1.1.1.1.cmml" xref="S6.p3.1.m1.1.1.1"></times><cn type="integer" id="S6.p3.1.m1.1.1.2.cmml" xref="S6.p3.1.m1.1.1.2">1</cn><apply id="S6.p3.1.m1.1.1.3.cmml" xref="S6.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="S6.p3.1.m1.1.1.3.1.cmml" xref="S6.p3.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S6.p3.1.m1.1.1.3.2.cmml" xref="S6.p3.1.m1.1.1.3.2">10</cn><apply id="S6.p3.1.m1.1.1.3.3.cmml" xref="S6.p3.1.m1.1.1.3.3"><minus id="S6.p3.1.m1.1.1.3.3.1.cmml" xref="S6.p3.1.m1.1.1.3.3"></minus><cn type="integer" id="S6.p3.1.m1.1.1.3.3.2.cmml" xref="S6.p3.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.1.m1.1c">1\times 10^{-4}</annotation></semantics></math> and a weight decay of <math id="S6.p3.2.m2.1" class="ltx_Math" alttext="1\times 10^{-5}" display="inline"><semantics id="S6.p3.2.m2.1a"><mrow id="S6.p3.2.m2.1.1" xref="S6.p3.2.m2.1.1.cmml"><mn id="S6.p3.2.m2.1.1.2" xref="S6.p3.2.m2.1.1.2.cmml">1</mn><mo lspace="0.222em" rspace="0.222em" id="S6.p3.2.m2.1.1.1" xref="S6.p3.2.m2.1.1.1.cmml">×</mo><msup id="S6.p3.2.m2.1.1.3" xref="S6.p3.2.m2.1.1.3.cmml"><mn id="S6.p3.2.m2.1.1.3.2" xref="S6.p3.2.m2.1.1.3.2.cmml">10</mn><mrow id="S6.p3.2.m2.1.1.3.3" xref="S6.p3.2.m2.1.1.3.3.cmml"><mo id="S6.p3.2.m2.1.1.3.3a" xref="S6.p3.2.m2.1.1.3.3.cmml">−</mo><mn id="S6.p3.2.m2.1.1.3.3.2" xref="S6.p3.2.m2.1.1.3.3.2.cmml">5</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S6.p3.2.m2.1b"><apply id="S6.p3.2.m2.1.1.cmml" xref="S6.p3.2.m2.1.1"><times id="S6.p3.2.m2.1.1.1.cmml" xref="S6.p3.2.m2.1.1.1"></times><cn type="integer" id="S6.p3.2.m2.1.1.2.cmml" xref="S6.p3.2.m2.1.1.2">1</cn><apply id="S6.p3.2.m2.1.1.3.cmml" xref="S6.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S6.p3.2.m2.1.1.3.1.cmml" xref="S6.p3.2.m2.1.1.3">superscript</csymbol><cn type="integer" id="S6.p3.2.m2.1.1.3.2.cmml" xref="S6.p3.2.m2.1.1.3.2">10</cn><apply id="S6.p3.2.m2.1.1.3.3.cmml" xref="S6.p3.2.m2.1.1.3.3"><minus id="S6.p3.2.m2.1.1.3.3.1.cmml" xref="S6.p3.2.m2.1.1.3.3"></minus><cn type="integer" id="S6.p3.2.m2.1.1.3.3.2.cmml" xref="S6.p3.2.m2.1.1.3.3.2">5</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p3.2.m2.1c">1\times 10^{-5}</annotation></semantics></math>.
For all datasets except QM9, we simulate four clients and train the local model for 10,000 local steps. QM9 has eight clients, and we train the model for 100,000 local steps. We conduct federated learning with the FedML framework <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.</p>
</div>
<div id="S6.p4" class="ltx_para">
<p id="S6.p4.1" class="ltx_p">For all datasets except QM9, we use MPNNs2s implemented by Deep Graph Library <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib55" title="" class="ltx_ref">55</a>]</cite>. MPNNs2s has 3 message passing layers and 3 set2sets layers. The hidden features of the edge is 16, and the output feature of the vertex is 64. We perform three set2set steps. For QM9, we adopt SchNet with six interaction layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> and implement SchNet by PyTorch-Geometric <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. The number of hidden channels and filters of SchNet is 128, and the number of Gaussian is set as 50 for continuous filter layers. We implement a multitask network for datasets with multi-objectives. We run experiments on a server with 8 NVIDIA RTX 2080 Ti Graphics Cards.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusions</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">Chemistry can be a challenging domain for deep learning because of the computational and material cost per training example. For example, each row in the Tox21 dataset costs about $50–$300 million USD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Therefore, contributing data to a public dataset may be impossible for institutions due to the intrinsic value of the data. Federated learning is a way to build global models while preventing the dissemination of chemical data. We propose a benchmark called FedChem for heterogeneous chemical data, which mimics how chemical data distributes among institutions. FedChem is composed of regression and classification learning scenarios from the existing MoleculeNet dataset and utilizes scaffold splitting and LDA (Latent Dirichlet Allocation) to assign molecules with different structures to different clients. FedChem can be tuned to generate scenarios with different degrees of heterogeneity. Given that existing federated learning methods perform poorly on FedChem, we propose an instance re-weighting framework called Federated Learning with Instance reweighTing (FLIT(+)), inspired by focal loss to align the training process across clients. We show that FLIT(+) is robust to different tasks and datasets with extensive experiments. One possible future direction is to develop personalized federated learning for FedChem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib59" title="" class="ltx_ref">59</a>]</cite>. Moreover, since our current heterogeneous simulation method may not lead to severe structural heterogeneity problems in some cases, we will explore other approaches for more heterogeneous settings.</p>
</div>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Acknowledgements</h2>

<div id="S8.p1" class="ltx_para">
<p id="S8.p1.1" class="ltx_p">Research reported in this work was supported by
the National Institute of General Medical Sciences of
the National Institutes of Health under award number
R35GM137966.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aggarwal et al. [2021]</span>
<span class="ltx_bibblock">
Aggarwal, D., Zhou, J., and
Jain, A. K. (2021).

</span>
<span class="ltx_bibblock">Fedface: Collaborative learning of face recognition
model.

</span>
<span class="ltx_bibblock">In <span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">International IEEE Joint Conference on
Biometrics</span> (pp. 1–8).

</span>
<span class="ltx_bibblock">IEEE.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anderson et al. [2019]</span>
<span class="ltx_bibblock">
Anderson, B. M., Hy, T., and
Kondor, R. (2019).

</span>
<span class="ltx_bibblock">Cormorant: Covariant molecular neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing
Systems</span> (pp. 14510–14519).

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arjovsky et al. [2019]</span>
<span class="ltx_bibblock">
Arjovsky, M., Bottou, L.,
Gulrajani, I., and Lopez-Paz, D.
(2019).

</span>
<span class="ltx_bibblock">Invariant risk minimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib3.2.2" class="ltx_text ltx_font_italic">abs/1907.02893</span>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bemis and Murcko [1996]</span>
<span class="ltx_bibblock">
Bemis, G. W., and Murcko, M. A.
(1996).

</span>
<span class="ltx_bibblock">The properties of known drugs. 1. molecular
frameworks.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Journal of medicinal chemistry</span>, <span id="bib.bib4.2.2" class="ltx_text ltx_font_italic">39</span>, 2887–2893.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2018]</span>
<span class="ltx_bibblock">
Chen, F., Luo, M., Dong,
Z., Li, Z., and He, X.
(2018).

</span>
<span class="ltx_bibblock">Federated meta-learning with fast convergence and
efficient communication.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1802.07876</span>, .

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen and Chao [2021]</span>
<span class="ltx_bibblock">
Chen, H., and Chao, W.
(2021).

</span>
<span class="ltx_bibblock">Fedbe: Making bayesian model ensemble applicable to
federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">9th International Conference on Learning
Representations</span>.

</span>
<span class="ltx_bibblock">OpenReview.net.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2021]</span>
<span class="ltx_bibblock">
Chen, M., Zhang, W., Yuan,
Z., Jia, Y., and Chen, H.
(2021).

</span>
<span class="ltx_bibblock">Fede: Embedding knowledge graphs in federated
setting.

</span>
<span class="ltx_bibblock">In <span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">IJCKG’21: The 10th International Joint
Conference on Knowledge Graphs</span> (pp. 80–88).

</span>
<span class="ltx_bibblock">ACM.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2020]</span>
<span class="ltx_bibblock">
Chen, Y., Qin, X., Wang,
J., Yu, C., and Gao, W.
(2020).

</span>
<span class="ltx_bibblock">Fedhealth: A federated transfer learning framework
for wearable healthcare.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">IEEE Intelligent Systems</span>, <span id="bib.bib8.2.2" class="ltx_text ltx_font_italic">35</span>, 83–93.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. [2020]</span>
<span class="ltx_bibblock">
Deng, Y., Han, T., and
Ansari, N. (2020).

</span>
<span class="ltx_bibblock">Fedvision: Federated video analytics with edge
computing.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">IEEE Open Journal of the Computer Society</span>,
<span id="bib.bib9.2.2" class="ltx_text ltx_font_italic">1</span>, 62–72.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">DiMasi et al. [2016]</span>
<span class="ltx_bibblock">
DiMasi, J. A., Grabowski, H. G., and
Hansen, R. W. (2016).

</span>
<span class="ltx_bibblock">Innovation in the pharmaceutical industry: new
estimates of r&amp;d costs.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">Journal of health economics</span>, <span id="bib.bib10.2.2" class="ltx_text ltx_font_italic">47</span>, 20–33.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dinh et al. [2020]</span>
<span class="ltx_bibblock">
Dinh, C. T., Tran, N. H., and
Nguyen, T. D. (2020).

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau
envelopes.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing
Systems</span>.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fallah et al. [2020]</span>
<span class="ltx_bibblock">
Fallah, A., Mokhtari, A., and
Ozdaglar, A. E. (2020).

</span>
<span class="ltx_bibblock">Personalized federated learning with theoretical
guarantees: A model-agnostic meta-learning approach.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing
Systems</span>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fey and Lenssen [2019]</span>
<span class="ltx_bibblock">
Fey, M., and Lenssen, J. E.
(2019).

</span>
<span class="ltx_bibblock">Fast graph representation learning with PyTorch
Geometric.

</span>
<span class="ltx_bibblock">In <span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">ICLR Workshop on Representation Learning
on Graphs and Manifolds</span>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gilmer et al. [2017]</span>
<span class="ltx_bibblock">
Gilmer, J., Schoenholz, S. S.,
Riley, P. F., Vinyals, O., and
Dahl, G. E. (2017).

</span>
<span class="ltx_bibblock">Neural message passing for quantum chemistry.

</span>
<span class="ltx_bibblock">In <span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">International conference on machine
learning</span> (pp. 1263–1272).

</span>
<span class="ltx_bibblock">PMLR.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hao et al. [2020]</span>
<span class="ltx_bibblock">
Hao, Z., Lu, C., Huang,
Z., Wang, H., Hu, Z.,
Liu, Q., Chen, E., and
Lee, C. (2020).

</span>
<span class="ltx_bibblock">Asgn: An active semi-supervised graph neural network
for molecular property prediction.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">Proceedings of the 26th ACM SIGKDD
International Conference on Knowledge Discovery &amp; Data Mining</span> (pp.
731–752).

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. [2021]</span>
<span class="ltx_bibblock">
He, C., Balasubramanian, K.,
Ceyani, E., Rong, Y.,
Zhao, P., Huang, J.,
Annavaram, M., and Avestimehr, S.
(2021).

</span>
<span class="ltx_bibblock">Fedgraphnn: A federated learning system and
benchmark for graph neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib16.2.2" class="ltx_text ltx_font_italic">abs/2104.07145</span>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. [2020]</span>
<span class="ltx_bibblock">
He, C., Li, S., So, J.,
Zhang, M., Wang, H.,
Wang, X., Vepakomma, P.,
Singh, A., Qiu, H.,
Shen, L., Zhao, P.,
Kang, Y., Liu, Y.,
Raskar, R., Yang, Q.,
Annavaram, M., and Avestimehr, S.
(2020).

</span>
<span class="ltx_bibblock">Fedml: A research library and benchmark for
federated machine learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib17.2.2" class="ltx_text ltx_font_italic">abs/2007.13518</span>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Honda et al. [2019]</span>
<span class="ltx_bibblock">
Honda, S., Shi, S., and
Ueda, H. R. (2019).

</span>
<span class="ltx_bibblock">SMILES transformer: Pre-trained molecular
fingerprint for low data drug discovery.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib18.2.2" class="ltx_text ltx_font_italic">abs/1911.04738</span>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jorgensen [2009]</span>
<span class="ltx_bibblock">
Jorgensen, W. L. (2009).

</span>
<span class="ltx_bibblock">Efficient drug lead discovery and optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">Accounts of chemical research</span>, <span id="bib.bib19.2.2" class="ltx_text ltx_font_italic">42</span>, 724–733.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. [2020]</span>
<span class="ltx_bibblock">
Karimireddy, S. P., Kale, S.,
Mohri, M., Reddi, S.,
Stich, S., and Suresh, A. T.
(2020).

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for
federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">International Conference on Machine
Learning</span> (pp. 5132–5143).

</span>
<span class="ltx_bibblock">PMLR.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma and Ba [2015]</span>
<span class="ltx_bibblock">
Kingma, D. P., and Ba, J.
(2015).

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In Y. Bengio, and Y. LeCun
(Eds.), <span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">3rd International Conference on Learning
Representations, ICLR 2015, San Diego, CA, USA, May 7-9, 2015, Conference
Track Proceedings</span>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kipf and Welling [2017]</span>
<span class="ltx_bibblock">
Kipf, T. N., and Welling, M.
(2017).

</span>
<span class="ltx_bibblock">Semi-supervised classification with graph
convolutional networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">5th International Conference on Learning
Representations</span>.

</span>
<span class="ltx_bibblock">OpenReview.net.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klicpera et al. [2020a]</span>
<span class="ltx_bibblock">
Klicpera, J., Giri, S.,
Margraf, J. T., and Günnemann, S.
(2020a).

</span>
<span class="ltx_bibblock">Fast and uncertainty-aware directional message
passing for non-equilibrium molecules.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib23.2.2" class="ltx_text ltx_font_italic">abs/2011.14115</span>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Klicpera et al. [2020b]</span>
<span class="ltx_bibblock">
Klicpera, J., Groß, J., and
Günnemann, S. (2020b).

</span>
<span class="ltx_bibblock">Directional message passing for molecular graphs.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">International Conference on Learning
Representations</span>.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krueger et al. [2021]</span>
<span class="ltx_bibblock">
Krueger, D., Caballero, E.,
Jacobsen, J., Zhang, A.,
Binas, J., Zhang, D.,
Priol, R. L., and Courville, A. C.
(2021).

</span>
<span class="ltx_bibblock">Out-of-distribution generalization via risk
extrapolation (rex).

</span>
<span class="ltx_bibblock">In <span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">Proceedings of the 38th International
Conference on Machine Learning</span> (pp. 5815–5826).

</span>
<span class="ltx_bibblock">PMLR volume 139.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lalitha et al. [2019]</span>
<span class="ltx_bibblock">
Lalitha, A., Kilinc, O. C.,
Javidi, T., and Koushanfar, F.
(2019).

</span>
<span class="ltx_bibblock">Peer-to-peer federated learning on graphs.

</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib26.2.2" class="ltx_text ltx_font_italic">abs/1901.11173</span>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Wang [2019]</span>
<span class="ltx_bibblock">
Li, D., and Wang, J.
(2019).

</span>
<span class="ltx_bibblock">Fedmd: Heterogenous federated learning via model
distillation.

</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib27.2.2" class="ltx_text ltx_font_italic">abs/1910.03581</span>.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2021]</span>
<span class="ltx_bibblock">
Li, Q., He, B., and Song,
D. (2021).

</span>
<span class="ltx_bibblock">Model-contrastive federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Conference on
Computer Vision and Pattern Recognition</span> (pp.
10713–10722).

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2020]</span>
<span class="ltx_bibblock">
Li, X., Huang, K., Yang,
W., Wang, S., and Zhang, Z.
(2020).

</span>
<span class="ltx_bibblock">On the convergence of fedavg on non-iid data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">8th International Conference on Learning
Representations</span>.

</span>
<span class="ltx_bibblock">OpenReview.net.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2020]</span>
<span class="ltx_bibblock">
Lin, T., Kong, L., Stich,
S. U., and Jaggi, M. (2020).

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in
federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing
Systems</span>.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2017]</span>
<span class="ltx_bibblock">
Lin, T.-Y., Goyal, P.,
Girshick, R., He, K., and
Dollár, P. (2017).

</span>
<span class="ltx_bibblock">Focal loss for dense object detection.

</span>
<span class="ltx_bibblock">In <span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE international
conference on computer vision</span> (pp. 2980–2988).

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. [2020]</span>
<span class="ltx_bibblock">
Ma, R., Li, Y., Li, C.,
Wan, F., Hu, H., Xu,
W., and Zeng, J. (2020).

</span>
<span class="ltx_bibblock">Secure multiparty computation for privacy-preserving
drug discovery.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">Bioinform.</span>, <span id="bib.bib32.2.2" class="ltx_text ltx_font_italic">36</span>,
2872–2880.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mayr et al. [2018]</span>
<span class="ltx_bibblock">
Mayr, A., Klambauer, G.,
Unterthiner, T., Steijaert, M.,
Wegner, J. K., Ceulemans, H.,
Clevert, D.-A., and Hochreiter, S.
(2018).

</span>
<span class="ltx_bibblock">Large-scale comparison of machine learning methods
for drug target prediction on chembl.

</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Chemical science</span>, <span id="bib.bib33.2.2" class="ltx_text ltx_font_italic">9</span>, 5441–5451.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. [2017]</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E.,
Ramage, D., Hampson, S., and
y Arcas, B. A. (2017).

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks
from decentralized data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">Artificial intelligence and
statistics</span> (pp. 1273–1282).

</span>
<span class="ltx_bibblock">PMLR.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miller et al. [2020]</span>
<span class="ltx_bibblock">
Miller, B. K., Geiger, M.,
Smidt, T. E., and Noé, F.
(2020).

</span>
<span class="ltx_bibblock">Relevance of rotationally equivariant convolutions
for predicting molecular properties.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib35.2.2" class="ltx_text ltx_font_italic">abs/2008.08461</span>.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miyato et al. [2018]</span>
<span class="ltx_bibblock">
Miyato, T., Maeda, S.-i.,
Koyama, M., and Ishii, S.
(2018).

</span>
<span class="ltx_bibblock">Virtual adversarial training: a regularization method
for supervised and semi-supervised learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">IEEE transactions on pattern analysis and
machine intelligence</span>, <span id="bib.bib36.2.2" class="ltx_text ltx_font_italic">41</span>,
1979–1993.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mohri et al. [2019]</span>
<span class="ltx_bibblock">
Mohri, M., Sivek, G., and
Suresh, A. T. (2019).

</span>
<span class="ltx_bibblock">Agnostic federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib37.1.1" class="ltx_text ltx_font_italic">International Conference on Machine
Learning</span> (pp. 4615–4625).

</span>
<span class="ltx_bibblock">PMLR.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mukhoti et al. [2020]</span>
<span class="ltx_bibblock">
Mukhoti, J., Kulharia, V.,
Sanyal, A., Golodetz, S.,
Torr, P. H. S., and Dokania, P. K.
(2020).

</span>
<span class="ltx_bibblock">Calibrating deep neural networks using focal loss.

</span>
<span class="ltx_bibblock">In <span id="bib.bib38.1.1" class="ltx_text ltx_font_italic">Annual Conference on Neural Information
Processing Systems</span>.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nam et al. [2020]</span>
<span class="ltx_bibblock">
Nam, J. H., Cha, H., Ahn,
S., Lee, J., and Shin, J.
(2020).

</span>
<span class="ltx_bibblock">Learning from failure: Training debiased classifier
from biased classifier.

</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib39.2.2" class="ltx_text ltx_font_italic">abs/2007.02561</span>.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pei et al. [2021]</span>
<span class="ltx_bibblock">
Pei, Y., Mao, R., Liu,
Y., Chen, C., Xu, S.,
Qiang, F., and Tech, B. E.
(2021).

</span>
<span class="ltx_bibblock">Decentralized federated graph neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib40.1.1" class="ltx_text ltx_font_italic">International Workshop on Federated and
Transfer Learning for Data Sparsity and Confidentiality in Conjunction with
IJCAI</span>.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. [2020]</span>
<span class="ltx_bibblock">
Peng, X., Huang, Z., Zhu,
Y., and Saenko, K. (2020).

</span>
<span class="ltx_bibblock">Federated adversarial domain adaptation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib41.1.1" class="ltx_text ltx_font_italic">8th International Conference on Learning
Representations</span>.

</span>
<span class="ltx_bibblock">OpenReview.net.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. [2020]</span>
<span class="ltx_bibblock">
Reddi, S., Charles, Z.,
Zaheer, M., Garrett, Z.,
Rush, K., Konečnỳ, J.,
Kumar, S., and McMahan, H. B.
(2020).

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2003.00295</span>, .

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reisizadeh et al. [2020]</span>
<span class="ltx_bibblock">
Reisizadeh, A., Farnia, F.,
Pedarsani, R., and Jadbabaie, A.
(2020).

</span>
<span class="ltx_bibblock">Robust federated learning: The case of affine
distribution shifts.

</span>
<span class="ltx_bibblock">In <span id="bib.bib43.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing
Systems</span>.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sagawa et al. [2019]</span>
<span class="ltx_bibblock">
Sagawa, S., Koh, P. W.,
Hashimoto, T. B., and Liang, P.
(2019).

</span>
<span class="ltx_bibblock">Distributionally robust neural networks for group
shifts: On the importance of regularization for worst-case generalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib44.2.2" class="ltx_text ltx_font_italic">abs/1911.08731</span>.

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sahu et al. [2018]</span>
<span class="ltx_bibblock">
Sahu, A. K., Li, T.,
Sanjabi, M., Zaheer, M.,
Talwalkar, A., and Smith, V.
(2018).

</span>
<span class="ltx_bibblock">On the convergence of federated optimization in
heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib45.2.2" class="ltx_text ltx_font_italic">abs/1812.06127</span>.

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sarkar et al. [2020]</span>
<span class="ltx_bibblock">
Sarkar, D., Narang, A., and
Rai, S. (2020).

</span>
<span class="ltx_bibblock">Fed-focal loss for imbalanced data classification in
federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib46.2.2" class="ltx_text ltx_font_italic">abs/2011.06283</span>.

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Satorras et al. [2021]</span>
<span class="ltx_bibblock">
Satorras, V. G., Hoogeboom, E., and
Welling, M. (2021).

</span>
<span class="ltx_bibblock">E(n) equivariant graph neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib47.1.1" class="ltx_text ltx_font_italic">Proceedings of the 38th International
Conference on Machine Learning</span> (pp. 9323–9332).

</span>
<span class="ltx_bibblock">PMLR volume 139.

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schütt et al. [2018]</span>
<span class="ltx_bibblock">
Schütt, K. T., Sauceda, H. E.,
Kindermans, P.-J., Tkatchenko, A., and
Müller, K.-R. (2018).

</span>
<span class="ltx_bibblock">Schnet–a deep learning architecture for molecules
and materials.

</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text ltx_font_italic">The Journal of Chemical Physics</span>, <span id="bib.bib48.2.2" class="ltx_text ltx_font_italic">148</span>, 241722.

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seo et al. [2020]</span>
<span class="ltx_bibblock">
Seo, H., Park, J., Oh,
S., Bennis, M., and Kim, S.
(2020).

</span>
<span class="ltx_bibblock">Federated knowledge distillation.

</span>
<span class="ltx_bibblock"><span id="bib.bib49.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib49.2.2" class="ltx_text ltx_font_italic">abs/2011.02367</span>.

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Song et al. [2020]</span>
<span class="ltx_bibblock">
Song, L., Ma, C., Zhang,
G., and Zhang, Y. (2020).

</span>
<span class="ltx_bibblock">Privacy-preserving unsupervised domain adaptation in
federated setting.

</span>
<span class="ltx_bibblock"><span id="bib.bib50.1.1" class="ltx_text ltx_font_italic">IEEE Access</span>, <span id="bib.bib50.2.2" class="ltx_text ltx_font_italic">8</span>,
143233–143240.

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2020a]</span>
<span class="ltx_bibblock">
Wang, B., Li, A., Li, H.,
and Chen, Y. (2020a).

</span>
<span class="ltx_bibblock">Graphfl: A federated learning framework for
semi-supervised node classification on graphs.

</span>
<span class="ltx_bibblock"><span id="bib.bib51.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib51.2.2" class="ltx_text ltx_font_italic">abs/2012.04187</span>.

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2021]</span>
<span class="ltx_bibblock">
Wang, C., Chen, B., Li,
G., and Wang, H. (2021).

</span>
<span class="ltx_bibblock">FL-AGCNS: federated learning framework for
automatic graph convolutional network search.

</span>
<span class="ltx_bibblock"><span id="bib.bib52.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib52.2.2" class="ltx_text ltx_font_italic">abs/2104.04141</span>.

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2020b]</span>
<span class="ltx_bibblock">
Wang, H., Yurochkin, M.,
Sun, Y., Papailiopoulos, D. S., and
Khazaeni, Y. (2020b).

</span>
<span class="ltx_bibblock">Federated learning with matched averaging.

</span>
<span class="ltx_bibblock">In <span id="bib.bib53.1.1" class="ltx_text ltx_font_italic">8th International Conference on Learning
Representations</span>.

</span>
<span class="ltx_bibblock">OpenReview.net.

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2020c]</span>
<span class="ltx_bibblock">
Wang, J., Liu, Q., Liang,
H., Joshi, G., and Poor, H. V.
(2020c).

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in
heterogeneous federated optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib54.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing
Systems</span>.

</span>
</li>
<li id="bib.bib55" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2019]</span>
<span class="ltx_bibblock">
Wang, M., Yu, L., Zheng,
D., Gan, Q., Gai, Y.,
Ye, Z., Li, M., Zhou,
J., Huang, Q., Ma, C.,
Huang, Z., Guo, Q.,
Zhang, H., Lin, H.,
Zhao, J., Li, J., Smola,
A. J., and Zhang, Z. (2019).

</span>
<span class="ltx_bibblock">Deep graph library: Towards efficient and scalable
deep learning on graphs.

</span>
<span class="ltx_bibblock"><span id="bib.bib55.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib55.2.2" class="ltx_text ltx_font_italic">abs/1909.01315</span>.

</span>
</li>
<li id="bib.bib56" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. [2021]</span>
<span class="ltx_bibblock">
Wei, C., Shen, K., Chen,
Y., and Ma, T. (2021).

</span>
<span class="ltx_bibblock">Theoretical analysis of self-training with deep
networks on unlabeled data.

</span>
<span class="ltx_bibblock">In <span id="bib.bib56.1.1" class="ltx_text ltx_font_italic">9th International Conference on Learning
Representations</span>.

</span>
<span class="ltx_bibblock">OpenReview.net.

</span>
</li>
<li id="bib.bib57" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. [2018]</span>
<span class="ltx_bibblock">
Wu, Z., Ramsundar, B.,
Feinberg, E. N., Gomes, J.,
Geniesse, C., Pappu, A. S.,
Leswing, K., and Pande, V.
(2018).

</span>
<span class="ltx_bibblock">Moleculenet: a benchmark for molecular machine
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib57.1.1" class="ltx_text ltx_font_italic">Chemical science</span>, <span id="bib.bib57.2.2" class="ltx_text ltx_font_italic">9</span>, 513–530.

</span>
</li>
<li id="bib.bib58" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. [2021]</span>
<span class="ltx_bibblock">
Xie, H., Ma, J., Xiong,
L., and Yang, C. (2021).

</span>
<span class="ltx_bibblock">Federated graph classification over non-iid graphs.

</span>
<span class="ltx_bibblock"><span id="bib.bib58.1.1" class="ltx_text ltx_font_italic">CoRR</span>, <span id="bib.bib58.2.2" class="ltx_text ltx_font_italic">abs/2106.13423</span>.

</span>
</li>
<li id="bib.bib59" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiong et al. [2020]</span>
<span class="ltx_bibblock">
Xiong, Z., Cheng, Z., Xu,
C., Lin, X., Liu, X.,
Wang, D., Luo, X.,
Zhang, Y., Qiao, N.,
Zheng, M. et al. (2020).

</span>
<span class="ltx_bibblock">Facing small and biased data dilemma in drug
discovery with federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib59.1.1" class="ltx_text ltx_font_italic">BioRxiv</span>, .

</span>
</li>
<li id="bib.bib60" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2018]</span>
<span class="ltx_bibblock">
Xu, K., Hu, W., Leskovec,
J., and Jegelka, S. (2018).

</span>
<span class="ltx_bibblock">How powerful are graph neural networks?

</span>
<span class="ltx_bibblock">In <span id="bib.bib60.1.1" class="ltx_text ltx_font_italic">International Conference on Learning
Representations</span>.

</span>
</li>
<li id="bib.bib61" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2019]</span>
<span class="ltx_bibblock">
Yang, Q., Liu, Y., Chen,
T., and Tong, Y. (2019).

</span>
<span class="ltx_bibblock">Federated machine learning: Concept and
applications.

</span>
<span class="ltx_bibblock"><span id="bib.bib61.1.1" class="ltx_text ltx_font_italic">ACM Transactions on Intelligent Systems and
Technology (TIST)</span>, <span id="bib.bib61.2.2" class="ltx_text ltx_font_italic">10</span>, 1–19.

</span>
</li>
<li id="bib.bib62" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2021]</span>
<span class="ltx_bibblock">
Yang, Z., Chakraborty, M., and
White, A. D. (2021).

</span>
<span class="ltx_bibblock">Predicting chemical shifts with graph neural
networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib62.1.1" class="ltx_text ltx_font_italic">Chemical science</span>, .

</span>
</li>
<li id="bib.bib63" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. [2022]</span>
<span class="ltx_bibblock">
Yao, C.-H., Gong, B., Qi,
H., Cui, Y., Zhu, Y., and
Yang, M.-H. (2022).

</span>
<span class="ltx_bibblock">Federated multi-target domain adaptation.

</span>
<span class="ltx_bibblock">In <span id="bib.bib63.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF Winter
Conference on Applications of Computer Vision</span> (pp.
1424–1433).

</span>
</li>
<li id="bib.bib64" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yurochkin et al. [2019]</span>
<span class="ltx_bibblock">
Yurochkin, M., Agarwal, M.,
Ghosh, S., Greenewald, K.,
Hoang, N., and Khazaeni, Y.
(2019).

</span>
<span class="ltx_bibblock">Bayesian nonparametric federated learning of neural
networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib64.1.1" class="ltx_text ltx_font_italic">International Conference on Machine
Learning</span> (pp. 7252–7261).

</span>
<span class="ltx_bibblock">PMLR.

</span>
</li>
<li id="bib.bib65" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2020]</span>
<span class="ltx_bibblock">
Zhang, J., Zhu, J., Niu,
G., Han, B., Sugiyama, M., and
Kankanhalli, M. (2020).

</span>
<span class="ltx_bibblock">Geometry-aware instance-reweighted adversarial
training.

</span>
<span class="ltx_bibblock">In <span id="bib.bib65.1.1" class="ltx_text ltx_font_italic">International Conference on Learning
Representations</span>.

</span>
</li>
<li id="bib.bib66" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al. [2020]</span>
<span class="ltx_bibblock">
Zhou, T., Wang, S., and
Bilmes, J. A. (2020).

</span>
<span class="ltx_bibblock">Curriculum learning by dynamic instance hardness.

</span>
<span class="ltx_bibblock"><span id="bib.bib66.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing
Systems</span>, <span id="bib.bib66.2.2" class="ltx_text ltx_font_italic">33</span>.

</span>
</li>
<li id="bib.bib67" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. [2021]</span>
<span class="ltx_bibblock">
Zhu, Z., Hong, J., and
Zhou, J. (2021).

</span>
<span class="ltx_bibblock">Data-free knowledge distillation for heterogeneous
federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib67.1.1" class="ltx_text ltx_font_italic">Proceedings of the 38th International
Conference on Machine Learning</span> (pp. 12878–12889).

</span>
<span class="ltx_bibblock">PMLR volume 139.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2109.07257" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2109.07258" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2109.07258">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2109.07258" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2109.07259" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 19:27:00 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
