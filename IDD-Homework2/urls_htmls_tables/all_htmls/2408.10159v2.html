<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Customizing Language Models with Instance-wise LoRA for Sequential Recommendation</title>
<!--Generated on Sun Oct  6 06:27:53 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2408.10159v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S1" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S2" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminary</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S3" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S3.SS1" title="In 3 Methodology ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Instance-wise Generation for Sequential Recommendation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S3.SS2" title="In 3 Methodology ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Instance-wise LoRA with the Mixture of Experts Concept</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S3.SS2.SSS1" title="In 3.2 Instance-wise LoRA with the Mixture of Experts Concept ‣ 3 Methodology ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Splitting Low-Rank Matrices into Experts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S3.SS2.SSS2" title="In 3.2 Instance-wise LoRA with the Mixture of Experts Concept ‣ 3 Methodology ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Generating Instance-wise Attentions over Experts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S3.SS2.SSS3" title="In 3.2 Instance-wise LoRA with the Mixture of Experts Concept ‣ 3 Methodology ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Aggregating Mixture of Experts as Instance-wise LoRA</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.SS1" title="In 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Investing Rationale of Instance-wise LoRA (RQ1)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.SS1.SSS1" title="In 4.1 Investing Rationale of Instance-wise LoRA (RQ1) ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Negative Transfer in Uniform LoRA &amp; Instance-wise LoRA</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.SS1.SSS2" title="In 4.1 Investing Rationale of Instance-wise LoRA (RQ1) ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Expert Showcase in Instance-wise LoRA</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.SS2" title="In 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Performance Comparison (RQ2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.SS3" title="In 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Ablation Study (RQ3)</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.SS3.SSS1" title="In 4.3 Ablation Study (RQ3) ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Effects of Gating Network</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.SS3.SSS2" title="In 4.3 Ablation Study (RQ3) ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Effect of Expert Numbers</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S5" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S6" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Limitation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S7" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Broader Impact</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#A1" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Description of Figure <span class="ltx_text ltx_ref_tag">1</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#A2" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Experimental Design and Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#A3" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Experimental Setup of RQ1</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#A4" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#A5" title="In Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Statistics</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Customizing Language Models with 
<br class="ltx_break"/>Instance-wise LoRA for Sequential Recommendation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
<span class="ltx_text ltx_font_bold" id="1.1">Xiaoyu Kong<sup class="ltx_sup" id="1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="1.1.1.1">1</span></sup></span>  <span class="ltx_text ltx_font_bold" id="id2.2.2">Jiancan Wu<sup class="ltx_sup" id="id2.2.2.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id2.2.2.1.1">1</span></sup></span>  <span class="ltx_text ltx_font_bold" id="id4.4.4">An Zhang<sup class="ltx_sup" id="id4.4.4.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id4.4.4.1.1">2</span></sup>
<br class="ltx_break"/>Leheng Sheng<sup class="ltx_sup" id="id4.4.4.2"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id4.4.4.2.1">2</span></sup></span>  <span class="ltx_text ltx_font_bold" id="id5.5.5">Hui Lin<sup class="ltx_sup" id="id5.5.5.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id5.5.5.1.1">3</span></sup></span>  <span class="ltx_text ltx_font_bold" id="id6.6.6">Xiang Wang<sup class="ltx_sup" id="id6.6.6.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id6.6.6.1.1">1</span></sup></span>  <span class="ltx_text ltx_font_bold" id="id8.8.8">Xiangnan He<sup class="ltx_sup" id="id8.8.8.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="id8.8.8.1.1">1</span></sup>
<br class="ltx_break"/><sup class="ltx_sup" id="id8.8.8.2"><span class="ltx_text ltx_font_medium" id="id8.8.8.2.1">1</span></sup></span>University of Science and Technology of China
<br class="ltx_break"/><sup class="ltx_sup" id="11.11.9">2</sup>National University of Singapore
<br class="ltx_break"/><sup class="ltx_sup" id="12.12.10">3</sup>Electronic Science Research Institute of China Electronics Technology Group Corporation
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="13.13.11">kongxy@mail.ustc.edu.cn</span>,  <span class="ltx_text ltx_font_typewriter" id="14.14.12">wujcan@gmail.com</span>,  <span class="ltx_text ltx_font_typewriter" id="15.15.13">anzhang@u.nus.edu
<br class="ltx_break"/>chenglh22@mails.tsinghua.edu.cn</span>,  <span class="ltx_text ltx_font_typewriter" id="16.16.14">linhui@whu.edu.cn
<br class="ltx_break"/>xiangwang1223@gmail.com</span>,  <span class="ltx_text ltx_font_typewriter" id="17.17.15">xiangnanhe@gmail.com</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="18.1">Sequential recommendation systems predict a user’s next item of interest by analyzing past interactions, aligning recommendations with individual preferences. Leveraging the strengths of Large Language Models (LLMs) in knowledge comprehension and reasoning, recent approaches have applied LLMs to sequential recommendation through language generation paradigms. These methods convert user behavior sequences into prompts for LLM fine-tuning, utilizing Low-Rank Adaptation (LoRA) modules to refine recommendations. However, the uniform application of LoRA across diverse user behaviors sometimes fails to capture individual variability, leading to suboptimal performance and negative transfer between disparate sequences.
To address these challenges, we propose Instance-wise LoRA (iLoRA), integrating LoRA with the Mixture of Experts (MoE) framework. iLoRA creates a diverse array of experts, each capturing specific aspects of user preferences, and introduces a sequence representation guided gate function. This gate function processes historical interaction sequences to generate enriched representations, guiding the gating network to output customized expert participation weights. This tailored approach mitigates negative transfer and dynamically adjusts to diverse behavior patterns.
Extensive experiments on three benchmark datasets demonstrate the effectiveness of iLoRA, highlighting its superior performance compared to existing methods in capturing user-specific preferences and improving recommendation accuracy.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Sequential recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib1" title="">1</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib2" title="">2</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib3" title="">3</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib5" title="">5</a>]</cite> suggests a user’s next item of interest by analyzing his/her past interactions, tailoring recommendations to individual preferences.
As Large Language Models (LLMs) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib12" title="">12</a>]</cite> exhibit impressive proficiency in global knowledge comprehension and reasoning, their potential for application in sequential recommendation is garnering increasing interest <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib13" title="">13</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib19" title="">19</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib20" title="">20</a>]</cite>.
Recent efforts <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib22" title="">22</a>]</cite> approach the sequential recommendation task under a language generation paradigm, wherein user behavior sequences are converted into input prompts by either purely textual prompting (ID numbers or descriptions) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib17" title="">17</a>]</cite> or hybrid prompting with additional behavioral tokens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib17" title="">17</a>]</cite>, achieving remarkable success.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Upon scrutinizing prior studies on LLM-based sequential recommenders, we can summarize a common fine-tuning pipeline comprising three sequential components:
(1) convert a sequence of historical behaviors into a prompt; (2) pair these prompts with the subsequent items of interest, to create instruction-tuning datasets; (3) incorporate a trainable Low-Rank Adaptation (LoRA) module <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>]</cite> into LLMs and fine-tune it on such prompts.
Existing studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib14" title="">14</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib24" title="">24</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib25" title="">25</a>]</cite> primarily focus on refining high-quality prompts to more effectively incorporate recommendation information, while leaving the improvements to LoRA largely under-explored.
Instead, they employ a single, standard LoRA module for fine-tuning, which freezes the LLM weights and updates the model through two additional trainable low-rank matrices.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">However, as user behaviors often exhibit substantial individual variability (<em class="ltx_emph ltx_font_italic" id="S1.p3.1.1">e.g., </em>distinct interests, behavior patterns, feedback mechanisms), we argue that employing a single, standard LoRA module across such diverse behaviors may not effectively capture these variabilities.
Specifically, the inherent variability in user behaviors naturally inspires us to view item sequences with different behavior variables as different tasks. Simply applying a singular LoRA module leaves this multitask nature of sequential recommendation untouched, thus potentially overestimating the relationships between sequences. It easily causes the negative transfer between significantly discrepant sequences <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib27" title="">27</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib28" title="">28</a>]</cite>. Take LLaRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>]</cite> as an example, which fine-tunes a LoRA module on top of LLaMA-2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib9" title="">9</a>]</cite> across all sequences. Following prior studies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib27" title="">27</a>]</cite>, we analyze the gradients of LLaRA associated with disparate sequences and reveal significant misalignment, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.
Specifically, we observe strong clustering by membership closeness in the collaborative space, along the diagonal of the gradient similarity matrix.
Clearly, such gradients are misaligned, which can result in suboptimal performance. To mitigate this issue, one straightforward solution is to deploy multiple LoRA modules, each fine-tuned for a specific sequence, enabling each module to act as a lightweight expert tailored to its respective sequence.
However, it is impractical in terms of resources and time complexity, as the number of sequences often scales to millions.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="286" id="S1.F1.g1" src="extracted/5904678/figures/motivation1.png" width="509"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">Gradient similarity of LoRA modules across training steps, with sequence data partitioned into 8 clusters. Euclidean distance is employed to evaluate the proximity between clusters, whereas gradient similarity is measured to assess geometric loss. Darker cells indicate higher gradient similarity. A case study shows user sequences: those with 0.86 cosine similarity share a strong interest in thriller movies, while those with -0.75 cosine similarity lack noticeable preference similarities. Similar items are connected with dashed lines, while identical items are connected with solid lines.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address these challenges, we propose a new fine-tuning framework, Instance-wise LoRA (iLoRA), which adapts the mixture of experts (MoE) concept <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib30" title="">30</a>]</cite> to tailor the LLM for individual variability in sequential recommendation.
The key idea is to integrate a diverse array of experts within the basic LoRA module, each encouraged to capture a specific aspect of user behaviors.
Specifically, for each instance of item sequence a user adopted before, we feed it into a conventional recommender model (<em class="ltx_emph ltx_font_italic" id="S1.p4.1.1">e.g., </em>SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib3" title="">3</a>]</cite>) to get a holistic sequence representation.
Consequently, this representation, reflecting personal behavior variability, is used by a gating network to customize instance-wise attention scores for the experts, where each score dictates the participation of each expert.
With the attention scores, the experts are further assembled as instance-wise LoRA for this item sequence.
Hereafter, we follow LLaRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>]</cite> and fine-tune the LLM (<em class="ltx_emph ltx_font_italic" id="S1.p4.1.2">i.e., </em>LLaMA-2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib9" title="">9</a>]</cite>) on a hybrid prompt, but instead with the personally-activated LoRA to mitigate the negative transfer between discrepant sequences.
Importantly, iLoRA maintains the same total number of parameters as the standard LoRA, thereby avoiding overfitting while dynamically adapting to diverse user behaviors.
We assess the effectiveness of iLoRA through extensive experiments on three benchmark sequential-recommendation datasets (<em class="ltx_emph ltx_font_italic" id="S1.p4.1.3">i.e., </em>LastFM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib31" title="">31</a>]</cite>, MovieLens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib32" title="">32</a>]</cite>, Steam <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib33" title="">33</a>]</cite>), showcasing its superiority over leading methods (<em class="ltx_emph ltx_font_italic" id="S1.p4.1.4">e.g., </em>GRU4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib1" title="">1</a>]</cite>, Caser <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib2" title="">2</a>]</cite>, SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib3" title="">3</a>]</cite>, MoRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib34" title="">34</a>]</cite>, TallRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib16" title="">16</a>]</cite>, LLaRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>]</cite>).</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Preliminary</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.5"><span class="ltx_text ltx_font_bold" id="S2.p1.5.1">LLM-based Sequential Recommendation.</span>
The primary task of sequential recommendation is to predict the next item that aligns with user preference <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib4" title="">4</a>]</cite>.
Formally, consider a user with a historical interaction sequence represented as <math alttext="\mathbf{i}_{&lt;n}=[i_{1},i_{2},...,i_{n-1}]" class="ltx_Math" display="inline" id="S2.p1.1.m1.4"><semantics id="S2.p1.1.m1.4a"><mrow id="S2.p1.1.m1.4.4" xref="S2.p1.1.m1.4.4.cmml"><msub id="S2.p1.1.m1.4.4.5" xref="S2.p1.1.m1.4.4.5.cmml"><mi id="S2.p1.1.m1.4.4.5.2" xref="S2.p1.1.m1.4.4.5.2.cmml">𝐢</mi><mrow id="S2.p1.1.m1.4.4.5.3" xref="S2.p1.1.m1.4.4.5.3.cmml"><mi id="S2.p1.1.m1.4.4.5.3.2" xref="S2.p1.1.m1.4.4.5.3.2.cmml"></mi><mo id="S2.p1.1.m1.4.4.5.3.1" xref="S2.p1.1.m1.4.4.5.3.1.cmml">&lt;</mo><mi id="S2.p1.1.m1.4.4.5.3.3" xref="S2.p1.1.m1.4.4.5.3.3.cmml">n</mi></mrow></msub><mo id="S2.p1.1.m1.4.4.4" xref="S2.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S2.p1.1.m1.4.4.3.3" xref="S2.p1.1.m1.4.4.3.4.cmml"><mo id="S2.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S2.p1.1.m1.4.4.3.4.cmml">[</mo><msub id="S2.p1.1.m1.2.2.1.1.1" xref="S2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S2.p1.1.m1.2.2.1.1.1.2" xref="S2.p1.1.m1.2.2.1.1.1.2.cmml">i</mi><mn id="S2.p1.1.m1.2.2.1.1.1.3" xref="S2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.p1.1.m1.4.4.3.3.5" xref="S2.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.p1.1.m1.3.3.2.2.2" xref="S2.p1.1.m1.3.3.2.2.2.cmml"><mi id="S2.p1.1.m1.3.3.2.2.2.2" xref="S2.p1.1.m1.3.3.2.2.2.2.cmml">i</mi><mn id="S2.p1.1.m1.3.3.2.2.2.3" xref="S2.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S2.p1.1.m1.4.4.3.3.6" xref="S2.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S2.p1.1.m1.1.1" mathvariant="normal" xref="S2.p1.1.m1.1.1.cmml">…</mi><mo id="S2.p1.1.m1.4.4.3.3.7" xref="S2.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S2.p1.1.m1.4.4.3.3.3" xref="S2.p1.1.m1.4.4.3.3.3.cmml"><mi id="S2.p1.1.m1.4.4.3.3.3.2" xref="S2.p1.1.m1.4.4.3.3.3.2.cmml">i</mi><mrow id="S2.p1.1.m1.4.4.3.3.3.3" xref="S2.p1.1.m1.4.4.3.3.3.3.cmml"><mi id="S2.p1.1.m1.4.4.3.3.3.3.2" xref="S2.p1.1.m1.4.4.3.3.3.3.2.cmml">n</mi><mo id="S2.p1.1.m1.4.4.3.3.3.3.1" xref="S2.p1.1.m1.4.4.3.3.3.3.1.cmml">−</mo><mn id="S2.p1.1.m1.4.4.3.3.3.3.3" xref="S2.p1.1.m1.4.4.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S2.p1.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.4b"><apply id="S2.p1.1.m1.4.4.cmml" xref="S2.p1.1.m1.4.4"><eq id="S2.p1.1.m1.4.4.4.cmml" xref="S2.p1.1.m1.4.4.4"></eq><apply id="S2.p1.1.m1.4.4.5.cmml" xref="S2.p1.1.m1.4.4.5"><csymbol cd="ambiguous" id="S2.p1.1.m1.4.4.5.1.cmml" xref="S2.p1.1.m1.4.4.5">subscript</csymbol><ci id="S2.p1.1.m1.4.4.5.2.cmml" xref="S2.p1.1.m1.4.4.5.2">𝐢</ci><apply id="S2.p1.1.m1.4.4.5.3.cmml" xref="S2.p1.1.m1.4.4.5.3"><lt id="S2.p1.1.m1.4.4.5.3.1.cmml" xref="S2.p1.1.m1.4.4.5.3.1"></lt><csymbol cd="latexml" id="S2.p1.1.m1.4.4.5.3.2.cmml" xref="S2.p1.1.m1.4.4.5.3.2">absent</csymbol><ci id="S2.p1.1.m1.4.4.5.3.3.cmml" xref="S2.p1.1.m1.4.4.5.3.3">𝑛</ci></apply></apply><list id="S2.p1.1.m1.4.4.3.4.cmml" xref="S2.p1.1.m1.4.4.3.3"><apply id="S2.p1.1.m1.2.2.1.1.1.cmml" xref="S2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S2.p1.1.m1.2.2.1.1.1.2">𝑖</ci><cn id="S2.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S2.p1.1.m1.3.3.2.2.2.cmml" xref="S2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S2.p1.1.m1.3.3.2.2.2.2">𝑖</ci><cn id="S2.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S2.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">…</ci><apply id="S2.p1.1.m1.4.4.3.3.3.cmml" xref="S2.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S2.p1.1.m1.4.4.3.3.3.1.cmml" xref="S2.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S2.p1.1.m1.4.4.3.3.3.2.cmml" xref="S2.p1.1.m1.4.4.3.3.3.2">𝑖</ci><apply id="S2.p1.1.m1.4.4.3.3.3.3.cmml" xref="S2.p1.1.m1.4.4.3.3.3.3"><minus id="S2.p1.1.m1.4.4.3.3.3.3.1.cmml" xref="S2.p1.1.m1.4.4.3.3.3.3.1"></minus><ci id="S2.p1.1.m1.4.4.3.3.3.3.2.cmml" xref="S2.p1.1.m1.4.4.3.3.3.3.2">𝑛</ci><cn id="S2.p1.1.m1.4.4.3.3.3.3.3.cmml" type="integer" xref="S2.p1.1.m1.4.4.3.3.3.3.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.4c">\mathbf{i}_{&lt;n}=[i_{1},i_{2},...,i_{n-1}]</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.4d">bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT = [ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_i start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>, where each <math alttext="i_{j}" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><msub id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><mi id="S2.p1.2.m2.1.1.2" xref="S2.p1.2.m2.1.1.2.cmml">i</mi><mi id="S2.p1.2.m2.1.1.3" xref="S2.p1.2.m2.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.1.cmml" xref="S2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1.2">𝑖</ci><ci id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">i_{j}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_i start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT</annotation></semantics></math> is an item interacted with at the <math alttext="j" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">j</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_j</annotation></semantics></math>-th step.
A sequential recommender, parameterized by <math alttext="\bm{\theta}" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><mi id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\bm{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">bold_italic_θ</annotation></semantics></math>, inputs this sequence and outputs a probability distribution over potential next items in the candidate set. This model is trained to maximize the likelihood of the true next item <math alttext="i_{n}" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><msub id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml"><mi id="S2.p1.5.m5.1.1.2" xref="S2.p1.5.m5.1.1.2.cmml">i</mi><mi id="S2.p1.5.m5.1.1.3" xref="S2.p1.5.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.cmml" xref="S2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.p1.5.m5.1.1.2.cmml" xref="S2.p1.5.m5.1.1.2">𝑖</ci><ci id="S2.p1.5.m5.1.1.3.cmml" xref="S2.p1.5.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">i_{n}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\bm{\theta}}\sum_{\mathcal{D}}\log P_{\bm{\theta}}(i_{n}|\mathbf{i}_{&lt;n})." class="ltx_Math" display="block" id="S2.E1.m1.1"><semantics id="S2.E1.m1.1a"><mrow id="S2.E1.m1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml"><munder id="S2.E1.m1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.3.2.cmml">max</mi><mi id="S2.E1.m1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.3.3.cmml">𝜽</mi></munder><mo id="S2.E1.m1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.cmml"><munder id="S2.E1.m1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.1.1.1.1.1.2.2" movablelimits="false" xref="S2.E1.m1.1.1.1.1.1.2.2.cmml">∑</mo><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.2.3.cmml">𝒟</mi></munder><mrow id="S2.E1.m1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E1.m1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.1" xref="S2.E1.m1.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E1.m1.1.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E1.m1.1.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E1.m1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.3.2.2" xref="S2.E1.m1.1.1.1.1.1.1.3.2.2.cmml">P</mi><mi id="S2.E1.m1.1.1.1.1.1.1.3.2.3" xref="S2.E1.m1.1.1.1.1.1.1.3.2.3.cmml">𝜽</mi></msub></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">i</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">n</mi></msub><mo fence="false" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐢</mi><mrow id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml"></mi><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">&lt;</mo><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">n</mi></mrow></msub></mrow><mo id="S2.E1.m1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E1.m1.1.1.1.2" lspace="0em" xref="S2.E1.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.1b"><apply id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1"><times id="S2.E1.m1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.2"></times><apply id="S2.E1.m1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.3">subscript</csymbol><max id="S2.E1.m1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.3.2"></max><ci id="S2.E1.m1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.3.3">𝜽</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1"><apply id="S2.E1.m1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.2.2"></sum><ci id="S2.E1.m1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.2.3">𝒟</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1"><times id="S2.E1.m1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.2"></times><apply id="S2.E1.m1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3"><log id="S2.E1.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.1"></log><apply id="S2.E1.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2.2">𝑃</ci><ci id="S2.E1.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.3.2.3">𝜽</ci></apply></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.2">𝑖</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.2.3">𝑛</ci></apply><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.2">𝐢</ci><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3"><lt id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.1"></lt><csymbol cd="latexml" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.2">absent</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.1.3.3.3">𝑛</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.1c">\max_{\bm{\theta}}\sum_{\mathcal{D}}\log P_{\bm{\theta}}(i_{n}|\mathbf{i}_{&lt;n}).</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.1d">roman_max start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT roman_log italic_P start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT | bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.10">In the context of LLM-based sequential recommendation, we employ instruction tuning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib35" title="">35</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib36" title="">36</a>]</cite>, which fine-tunes LLMs using training data structured into explicit instructional pairs <math alttext="(\mathbf{x},\mathbf{y})" class="ltx_Math" display="inline" id="S2.p1.6.m1.2"><semantics id="S2.p1.6.m1.2a"><mrow id="S2.p1.6.m1.2.3.2" xref="S2.p1.6.m1.2.3.1.cmml"><mo id="S2.p1.6.m1.2.3.2.1" stretchy="false" xref="S2.p1.6.m1.2.3.1.cmml">(</mo><mi id="S2.p1.6.m1.1.1" xref="S2.p1.6.m1.1.1.cmml">𝐱</mi><mo id="S2.p1.6.m1.2.3.2.2" xref="S2.p1.6.m1.2.3.1.cmml">,</mo><mi id="S2.p1.6.m1.2.2" xref="S2.p1.6.m1.2.2.cmml">𝐲</mi><mo id="S2.p1.6.m1.2.3.2.3" stretchy="false" xref="S2.p1.6.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.6.m1.2b"><interval closure="open" id="S2.p1.6.m1.2.3.1.cmml" xref="S2.p1.6.m1.2.3.2"><ci id="S2.p1.6.m1.1.1.cmml" xref="S2.p1.6.m1.1.1">𝐱</ci><ci id="S2.p1.6.m1.2.2.cmml" xref="S2.p1.6.m1.2.2">𝐲</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m1.2c">(\mathbf{x},\mathbf{y})</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m1.2d">( bold_x , bold_y )</annotation></semantics></math>. Here, <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S2.p1.7.m2.1"><semantics id="S2.p1.7.m2.1a"><mi id="S2.p1.7.m2.1.1" xref="S2.p1.7.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.p1.7.m2.1b"><ci id="S2.p1.7.m2.1.1.cmml" xref="S2.p1.7.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m2.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m2.1d">bold_x</annotation></semantics></math> comprises a detailed textual instruction describing the interaction sequences <math alttext="\mathbf{i}_{&lt;n}" class="ltx_Math" display="inline" id="S2.p1.8.m3.1"><semantics id="S2.p1.8.m3.1a"><msub id="S2.p1.8.m3.1.1" xref="S2.p1.8.m3.1.1.cmml"><mi id="S2.p1.8.m3.1.1.2" xref="S2.p1.8.m3.1.1.2.cmml">𝐢</mi><mrow id="S2.p1.8.m3.1.1.3" xref="S2.p1.8.m3.1.1.3.cmml"><mi id="S2.p1.8.m3.1.1.3.2" xref="S2.p1.8.m3.1.1.3.2.cmml"></mi><mo id="S2.p1.8.m3.1.1.3.1" xref="S2.p1.8.m3.1.1.3.1.cmml">&lt;</mo><mi id="S2.p1.8.m3.1.1.3.3" xref="S2.p1.8.m3.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p1.8.m3.1b"><apply id="S2.p1.8.m3.1.1.cmml" xref="S2.p1.8.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m3.1.1.1.cmml" xref="S2.p1.8.m3.1.1">subscript</csymbol><ci id="S2.p1.8.m3.1.1.2.cmml" xref="S2.p1.8.m3.1.1.2">𝐢</ci><apply id="S2.p1.8.m3.1.1.3.cmml" xref="S2.p1.8.m3.1.1.3"><lt id="S2.p1.8.m3.1.1.3.1.cmml" xref="S2.p1.8.m3.1.1.3.1"></lt><csymbol cd="latexml" id="S2.p1.8.m3.1.1.3.2.cmml" xref="S2.p1.8.m3.1.1.3.2">absent</csymbol><ci id="S2.p1.8.m3.1.1.3.3.cmml" xref="S2.p1.8.m3.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m3.1c">\mathbf{i}_{&lt;n}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m3.1d">bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT</annotation></semantics></math> and recommendation task <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib26" title="">26</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib23" title="">23</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib22" title="">22</a>]</cite>, and <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S2.p1.9.m4.1"><semantics id="S2.p1.9.m4.1a"><mi id="S2.p1.9.m4.1.1" xref="S2.p1.9.m4.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m4.1b"><ci id="S2.p1.9.m4.1.1.cmml" xref="S2.p1.9.m4.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m4.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.9.m4.1d">bold_y</annotation></semantics></math> is the textual description of the predictive item <math alttext="i_{n}" class="ltx_Math" display="inline" id="S2.p1.10.m5.1"><semantics id="S2.p1.10.m5.1a"><msub id="S2.p1.10.m5.1.1" xref="S2.p1.10.m5.1.1.cmml"><mi id="S2.p1.10.m5.1.1.2" xref="S2.p1.10.m5.1.1.2.cmml">i</mi><mi id="S2.p1.10.m5.1.1.3" xref="S2.p1.10.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.10.m5.1b"><apply id="S2.p1.10.m5.1.1.cmml" xref="S2.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.10.m5.1.1.1.cmml" xref="S2.p1.10.m5.1.1">subscript</csymbol><ci id="S2.p1.10.m5.1.1.2.cmml" xref="S2.p1.10.m5.1.1.2">𝑖</ci><ci id="S2.p1.10.m5.1.1.3.cmml" xref="S2.p1.10.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m5.1c">i_{n}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.10.m5.1d">italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> in the user’s sequence <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib7" title="">7</a>]</cite>.
The training objective is formulated as an autoregressive model optimization problem:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\bm{\phi}}\sum_{(\mathbf{x},\mathbf{y})}\sum_{t=1}^{|\mathbf{y}|}\log P_%
{\bm{\phi}}(y_{t}|\mathbf{x},\mathbf{y}_{&lt;t})," class="ltx_Math" display="block" id="S2.E2.m1.5"><semantics id="S2.E2.m1.5a"><mrow id="S2.E2.m1.5.5.1" xref="S2.E2.m1.5.5.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1" xref="S2.E2.m1.5.5.1.1.cmml"><munder id="S2.E2.m1.5.5.1.1.3" xref="S2.E2.m1.5.5.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.3.2" xref="S2.E2.m1.5.5.1.1.3.2.cmml">max</mi><mi class="ltx_mathvariant_bold-italic" id="S2.E2.m1.5.5.1.1.3.3" mathvariant="bold-italic" xref="S2.E2.m1.5.5.1.1.3.3.cmml">ϕ</mi></munder><mo id="S2.E2.m1.5.5.1.1.2" xref="S2.E2.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.1" xref="S2.E2.m1.5.5.1.1.1.cmml"><munder id="S2.E2.m1.5.5.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.2.cmml"><mo id="S2.E2.m1.5.5.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S2.E2.m1.5.5.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E2.m1.2.2.2.4" xref="S2.E2.m1.2.2.2.3.cmml"><mo id="S2.E2.m1.2.2.2.4.1" stretchy="false" xref="S2.E2.m1.2.2.2.3.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">𝐱</mi><mo id="S2.E2.m1.2.2.2.4.2" xref="S2.E2.m1.2.2.2.3.cmml">,</mo><mi id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.2.cmml">𝐲</mi><mo id="S2.E2.m1.2.2.2.4.3" stretchy="false" xref="S2.E2.m1.2.2.2.3.cmml">)</mo></mrow></munder><mrow id="S2.E2.m1.5.5.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.cmml"><munderover id="S2.E2.m1.5.5.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.2.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.2.2.3" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.2.2.3.2" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S2.E2.m1.5.5.1.1.1.1.2.2.3.1" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.5.5.1.1.1.1.2.2.3.3" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S2.E2.m1.3.3.1.3" xref="S2.E2.m1.3.3.1.2.cmml"><mo id="S2.E2.m1.3.3.1.3.1" stretchy="false" xref="S2.E2.m1.3.3.1.2.1.cmml">|</mo><mi id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml">𝐲</mi><mo id="S2.E2.m1.3.3.1.3.2" stretchy="false" xref="S2.E2.m1.3.3.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S2.E2.m1.5.5.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.3.1" xref="S2.E2.m1.5.5.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E2.m1.5.5.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E2.m1.5.5.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E2.m1.5.5.1.1.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.3.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.3.2.2.cmml">P</mi><mi class="ltx_mathvariant_bold-italic" id="S2.E2.m1.5.5.1.1.1.1.1.3.2.3" mathvariant="bold-italic" xref="S2.E2.m1.5.5.1.1.1.1.1.3.2.3.cmml">ϕ</mi></msub></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">𝐱</mi><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐲</mi><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.5.5.1.2" xref="S2.E2.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.5b"><apply id="S2.E2.m1.5.5.1.1.cmml" xref="S2.E2.m1.5.5.1"><times id="S2.E2.m1.5.5.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.2"></times><apply id="S2.E2.m1.5.5.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.3">subscript</csymbol><max id="S2.E2.m1.5.5.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.3.2"></max><ci id="S2.E2.m1.5.5.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.3.3">bold-italic-ϕ</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1"><apply id="S2.E2.m1.5.5.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.5.5.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.2.2"></sum><interval closure="open" id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.4"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝐱</ci><ci id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2.2">𝐲</ci></interval></apply><apply id="S2.E2.m1.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1"><apply id="S2.E2.m1.5.5.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3"><eq id="S2.E2.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S2.E2.m1.5.5.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E2.m1.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.3.3.1.2.cmml" xref="S2.E2.m1.3.3.1.3"><abs id="S2.E2.m1.3.3.1.2.1.cmml" xref="S2.E2.m1.3.3.1.3.1"></abs><ci id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1.1">𝐲</ci></apply></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1"><times id="S2.E2.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.2"></times><apply id="S2.E2.m1.5.5.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3"><log id="S2.E2.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.1"></log><apply id="S2.E2.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.2.2">𝑃</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.2.3">bold-italic-ϕ</ci></apply></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><list id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">𝐱</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">𝐲</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3"><lt id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.5c">\max_{\bm{\phi}}\sum_{(\mathbf{x},\mathbf{y})}\sum_{t=1}^{|\mathbf{y}|}\log P_%
{\bm{\phi}}(y_{t}|\mathbf{x},\mathbf{y}_{&lt;t}),</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.5d">roman_max start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT ( bold_x , bold_y ) end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | bold_y | end_POSTSUPERSCRIPT roman_log italic_P start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x , bold_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.14">where <math alttext="\bm{\phi}" class="ltx_Math" display="inline" id="S2.p1.11.m1.1"><semantics id="S2.p1.11.m1.1a"><mi class="ltx_mathvariant_bold-italic" id="S2.p1.11.m1.1.1" mathvariant="bold-italic" xref="S2.p1.11.m1.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.11.m1.1b"><ci id="S2.p1.11.m1.1.1.cmml" xref="S2.p1.11.m1.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m1.1c">\bm{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.11.m1.1d">bold_italic_ϕ</annotation></semantics></math> denotes the LLM’s model parameters, <math alttext="y_{t}" class="ltx_Math" display="inline" id="S2.p1.12.m2.1"><semantics id="S2.p1.12.m2.1a"><msub id="S2.p1.12.m2.1.1" xref="S2.p1.12.m2.1.1.cmml"><mi id="S2.p1.12.m2.1.1.2" xref="S2.p1.12.m2.1.1.2.cmml">y</mi><mi id="S2.p1.12.m2.1.1.3" xref="S2.p1.12.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.12.m2.1b"><apply id="S2.p1.12.m2.1.1.cmml" xref="S2.p1.12.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.12.m2.1.1.1.cmml" xref="S2.p1.12.m2.1.1">subscript</csymbol><ci id="S2.p1.12.m2.1.1.2.cmml" xref="S2.p1.12.m2.1.1.2">𝑦</ci><ci id="S2.p1.12.m2.1.1.3.cmml" xref="S2.p1.12.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.12.m2.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.12.m2.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> represents the <math alttext="t" class="ltx_Math" display="inline" id="S2.p1.13.m3.1"><semantics id="S2.p1.13.m3.1a"><mi id="S2.p1.13.m3.1.1" xref="S2.p1.13.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p1.13.m3.1b"><ci id="S2.p1.13.m3.1.1.cmml" xref="S2.p1.13.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.13.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.p1.13.m3.1d">italic_t</annotation></semantics></math>-th token in the output sequence, and <math alttext="\mathbf{y}_{&lt;t}" class="ltx_Math" display="inline" id="S2.p1.14.m4.1"><semantics id="S2.p1.14.m4.1a"><msub id="S2.p1.14.m4.1.1" xref="S2.p1.14.m4.1.1.cmml"><mi id="S2.p1.14.m4.1.1.2" xref="S2.p1.14.m4.1.1.2.cmml">𝐲</mi><mrow id="S2.p1.14.m4.1.1.3" xref="S2.p1.14.m4.1.1.3.cmml"><mi id="S2.p1.14.m4.1.1.3.2" xref="S2.p1.14.m4.1.1.3.2.cmml"></mi><mo id="S2.p1.14.m4.1.1.3.1" xref="S2.p1.14.m4.1.1.3.1.cmml">&lt;</mo><mi id="S2.p1.14.m4.1.1.3.3" xref="S2.p1.14.m4.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p1.14.m4.1b"><apply id="S2.p1.14.m4.1.1.cmml" xref="S2.p1.14.m4.1.1"><csymbol cd="ambiguous" id="S2.p1.14.m4.1.1.1.cmml" xref="S2.p1.14.m4.1.1">subscript</csymbol><ci id="S2.p1.14.m4.1.1.2.cmml" xref="S2.p1.14.m4.1.1.2">𝐲</ci><apply id="S2.p1.14.m4.1.1.3.cmml" xref="S2.p1.14.m4.1.1.3"><lt id="S2.p1.14.m4.1.1.3.1.cmml" xref="S2.p1.14.m4.1.1.3.1"></lt><csymbol cd="latexml" id="S2.p1.14.m4.1.1.3.2.cmml" xref="S2.p1.14.m4.1.1.3.2">absent</csymbol><ci id="S2.p1.14.m4.1.1.3.3.cmml" xref="S2.p1.14.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.14.m4.1c">\mathbf{y}_{&lt;t}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.14.m4.1d">bold_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT</annotation></semantics></math> includes all preceding tokens in the sequence. This objective ensures that each prediction is informed by both the prior items in the sequence and the detailed instructions describing the sequential recommendation task <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib4" title="">4</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib5" title="">5</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib22" title="">22</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.8"><span class="ltx_text ltx_font_bold" id="S2.p2.8.1">Fine-tuning with Low-rank Adaption (LoRA).</span>
Fully fine-tuning LLMs (<em class="ltx_emph ltx_font_italic" id="S2.p2.8.2">cf. </em>Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S2.E2" title="In 2 Preliminary ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>)) entails substantial computational resources <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib6" title="">6</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib10" title="">10</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib11" title="">11</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib12" title="">12</a>]</cite>. LoRA emerges as an efficient alternative <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib37" title="">37</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib38" title="">38</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib39" title="">39</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib40" title="">40</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib41" title="">41</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib42" title="">42</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib43" title="">43</a>]</cite>, which injects trainable low-rank matrices into transformer layers to approximate the updates of pre-trained weights <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib42" title="">42</a>]</cite>.
At the core, LoRA employs a low-rank decomposition where the update <math alttext="\Delta\mathbf{W}" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.2" mathvariant="normal" xref="S2.p2.1.m1.1.1.2.cmml">Δ</mi><mo id="S2.p2.1.m1.1.1.1" xref="S2.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">𝐖</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><times id="S2.p2.1.m1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1"></times><ci id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2">Δ</ci><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">𝐖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\Delta\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">roman_Δ bold_W</annotation></semantics></math> to the pre-trained matrix <math alttext="\mathbf{W}\in\mathbb{R}^{d_{\text{out}}\times d_{\text{in}}}" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mrow id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml"><mi id="S2.p2.2.m2.1.1.2" xref="S2.p2.2.m2.1.1.2.cmml">𝐖</mi><mo id="S2.p2.2.m2.1.1.1" xref="S2.p2.2.m2.1.1.1.cmml">∈</mo><msup id="S2.p2.2.m2.1.1.3" xref="S2.p2.2.m2.1.1.3.cmml"><mi id="S2.p2.2.m2.1.1.3.2" xref="S2.p2.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p2.2.m2.1.1.3.3" xref="S2.p2.2.m2.1.1.3.3.cmml"><msub id="S2.p2.2.m2.1.1.3.3.2" xref="S2.p2.2.m2.1.1.3.3.2.cmml"><mi id="S2.p2.2.m2.1.1.3.3.2.2" xref="S2.p2.2.m2.1.1.3.3.2.2.cmml">d</mi><mtext id="S2.p2.2.m2.1.1.3.3.2.3" xref="S2.p2.2.m2.1.1.3.3.2.3a.cmml">out</mtext></msub><mo id="S2.p2.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.p2.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S2.p2.2.m2.1.1.3.3.3" xref="S2.p2.2.m2.1.1.3.3.3.cmml"><mi id="S2.p2.2.m2.1.1.3.3.3.2" xref="S2.p2.2.m2.1.1.3.3.3.2.cmml">d</mi><mtext id="S2.p2.2.m2.1.1.3.3.3.3" xref="S2.p2.2.m2.1.1.3.3.3.3a.cmml">in</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><apply id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1"><in id="S2.p2.2.m2.1.1.1.cmml" xref="S2.p2.2.m2.1.1.1"></in><ci id="S2.p2.2.m2.1.1.2.cmml" xref="S2.p2.2.m2.1.1.2">𝐖</ci><apply id="S2.p2.2.m2.1.1.3.cmml" xref="S2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.3.1.cmml" xref="S2.p2.2.m2.1.1.3">superscript</csymbol><ci id="S2.p2.2.m2.1.1.3.2.cmml" xref="S2.p2.2.m2.1.1.3.2">ℝ</ci><apply id="S2.p2.2.m2.1.1.3.3.cmml" xref="S2.p2.2.m2.1.1.3.3"><times id="S2.p2.2.m2.1.1.3.3.1.cmml" xref="S2.p2.2.m2.1.1.3.3.1"></times><apply id="S2.p2.2.m2.1.1.3.3.2.cmml" xref="S2.p2.2.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.3.3.2.1.cmml" xref="S2.p2.2.m2.1.1.3.3.2">subscript</csymbol><ci id="S2.p2.2.m2.1.1.3.3.2.2.cmml" xref="S2.p2.2.m2.1.1.3.3.2.2">𝑑</ci><ci id="S2.p2.2.m2.1.1.3.3.2.3a.cmml" xref="S2.p2.2.m2.1.1.3.3.2.3"><mtext id="S2.p2.2.m2.1.1.3.3.2.3.cmml" mathsize="50%" xref="S2.p2.2.m2.1.1.3.3.2.3">out</mtext></ci></apply><apply id="S2.p2.2.m2.1.1.3.3.3.cmml" xref="S2.p2.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.p2.2.m2.1.1.3.3.3.1.cmml" xref="S2.p2.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S2.p2.2.m2.1.1.3.3.3.2.cmml" xref="S2.p2.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S2.p2.2.m2.1.1.3.3.3.3a.cmml" xref="S2.p2.2.m2.1.1.3.3.3.3"><mtext id="S2.p2.2.m2.1.1.3.3.3.3.cmml" mathsize="50%" xref="S2.p2.2.m2.1.1.3.3.3.3">in</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathbf{W}\in\mathbb{R}^{d_{\text{out}}\times d_{\text{in}}}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">bold_W ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT out end_POSTSUBSCRIPT × italic_d start_POSTSUBSCRIPT in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> is represented as <math alttext="\Delta\mathbf{W}=\mathbf{BA}" class="ltx_Math" display="inline" id="S2.p2.3.m3.1"><semantics id="S2.p2.3.m3.1a"><mrow id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mrow id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml"><mi id="S2.p2.3.m3.1.1.2.2" mathvariant="normal" xref="S2.p2.3.m3.1.1.2.2.cmml">Δ</mi><mo id="S2.p2.3.m3.1.1.2.1" xref="S2.p2.3.m3.1.1.2.1.cmml">⁢</mo><mi id="S2.p2.3.m3.1.1.2.3" xref="S2.p2.3.m3.1.1.2.3.cmml">𝐖</mi></mrow><mo id="S2.p2.3.m3.1.1.1" xref="S2.p2.3.m3.1.1.1.cmml">=</mo><mi id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">𝐁𝐀</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><eq id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1.1"></eq><apply id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2"><times id="S2.p2.3.m3.1.1.2.1.cmml" xref="S2.p2.3.m3.1.1.2.1"></times><ci id="S2.p2.3.m3.1.1.2.2.cmml" xref="S2.p2.3.m3.1.1.2.2">Δ</ci><ci id="S2.p2.3.m3.1.1.2.3.cmml" xref="S2.p2.3.m3.1.1.2.3">𝐖</ci></apply><ci id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">𝐁𝐀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">\Delta\mathbf{W}=\mathbf{BA}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.1d">roman_Δ bold_W = bold_BA</annotation></semantics></math>, where <math alttext="\mathbf{B}\in\mathbb{R}^{d_{\text{out}}\times r}" class="ltx_Math" display="inline" id="S2.p2.4.m4.1"><semantics id="S2.p2.4.m4.1a"><mrow id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><mi id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml">𝐁</mi><mo id="S2.p2.4.m4.1.1.1" xref="S2.p2.4.m4.1.1.1.cmml">∈</mo><msup id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml"><mi id="S2.p2.4.m4.1.1.3.2" xref="S2.p2.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p2.4.m4.1.1.3.3" xref="S2.p2.4.m4.1.1.3.3.cmml"><msub id="S2.p2.4.m4.1.1.3.3.2" xref="S2.p2.4.m4.1.1.3.3.2.cmml"><mi id="S2.p2.4.m4.1.1.3.3.2.2" xref="S2.p2.4.m4.1.1.3.3.2.2.cmml">d</mi><mtext id="S2.p2.4.m4.1.1.3.3.2.3" xref="S2.p2.4.m4.1.1.3.3.2.3a.cmml">out</mtext></msub><mo id="S2.p2.4.m4.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.p2.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S2.p2.4.m4.1.1.3.3.3" xref="S2.p2.4.m4.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><in id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1.1"></in><ci id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2">𝐁</ci><apply id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.3.1.cmml" xref="S2.p2.4.m4.1.1.3">superscript</csymbol><ci id="S2.p2.4.m4.1.1.3.2.cmml" xref="S2.p2.4.m4.1.1.3.2">ℝ</ci><apply id="S2.p2.4.m4.1.1.3.3.cmml" xref="S2.p2.4.m4.1.1.3.3"><times id="S2.p2.4.m4.1.1.3.3.1.cmml" xref="S2.p2.4.m4.1.1.3.3.1"></times><apply id="S2.p2.4.m4.1.1.3.3.2.cmml" xref="S2.p2.4.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.3.3.2.1.cmml" xref="S2.p2.4.m4.1.1.3.3.2">subscript</csymbol><ci id="S2.p2.4.m4.1.1.3.3.2.2.cmml" xref="S2.p2.4.m4.1.1.3.3.2.2">𝑑</ci><ci id="S2.p2.4.m4.1.1.3.3.2.3a.cmml" xref="S2.p2.4.m4.1.1.3.3.2.3"><mtext id="S2.p2.4.m4.1.1.3.3.2.3.cmml" mathsize="50%" xref="S2.p2.4.m4.1.1.3.3.2.3">out</mtext></ci></apply><ci id="S2.p2.4.m4.1.1.3.3.3.cmml" xref="S2.p2.4.m4.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">\mathbf{B}\in\mathbb{R}^{d_{\text{out}}\times r}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.1d">bold_B ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT out end_POSTSUBSCRIPT × italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{A}\in\mathbb{R}^{r\times d_{\text{in}}}" class="ltx_Math" display="inline" id="S2.p2.5.m5.1"><semantics id="S2.p2.5.m5.1a"><mrow id="S2.p2.5.m5.1.1" xref="S2.p2.5.m5.1.1.cmml"><mi id="S2.p2.5.m5.1.1.2" xref="S2.p2.5.m5.1.1.2.cmml">𝐀</mi><mo id="S2.p2.5.m5.1.1.1" xref="S2.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S2.p2.5.m5.1.1.3" xref="S2.p2.5.m5.1.1.3.cmml"><mi id="S2.p2.5.m5.1.1.3.2" xref="S2.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p2.5.m5.1.1.3.3" xref="S2.p2.5.m5.1.1.3.3.cmml"><mi id="S2.p2.5.m5.1.1.3.3.2" xref="S2.p2.5.m5.1.1.3.3.2.cmml">r</mi><mo id="S2.p2.5.m5.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S2.p2.5.m5.1.1.3.3.1.cmml">×</mo><msub id="S2.p2.5.m5.1.1.3.3.3" xref="S2.p2.5.m5.1.1.3.3.3.cmml"><mi id="S2.p2.5.m5.1.1.3.3.3.2" xref="S2.p2.5.m5.1.1.3.3.3.2.cmml">d</mi><mtext id="S2.p2.5.m5.1.1.3.3.3.3" xref="S2.p2.5.m5.1.1.3.3.3.3a.cmml">in</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.1b"><apply id="S2.p2.5.m5.1.1.cmml" xref="S2.p2.5.m5.1.1"><in id="S2.p2.5.m5.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1"></in><ci id="S2.p2.5.m5.1.1.2.cmml" xref="S2.p2.5.m5.1.1.2">𝐀</ci><apply id="S2.p2.5.m5.1.1.3.cmml" xref="S2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.3.1.cmml" xref="S2.p2.5.m5.1.1.3">superscript</csymbol><ci id="S2.p2.5.m5.1.1.3.2.cmml" xref="S2.p2.5.m5.1.1.3.2">ℝ</ci><apply id="S2.p2.5.m5.1.1.3.3.cmml" xref="S2.p2.5.m5.1.1.3.3"><times id="S2.p2.5.m5.1.1.3.3.1.cmml" xref="S2.p2.5.m5.1.1.3.3.1"></times><ci id="S2.p2.5.m5.1.1.3.3.2.cmml" xref="S2.p2.5.m5.1.1.3.3.2">𝑟</ci><apply id="S2.p2.5.m5.1.1.3.3.3.cmml" xref="S2.p2.5.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.3.3.3.1.cmml" xref="S2.p2.5.m5.1.1.3.3.3">subscript</csymbol><ci id="S2.p2.5.m5.1.1.3.3.3.2.cmml" xref="S2.p2.5.m5.1.1.3.3.3.2">𝑑</ci><ci id="S2.p2.5.m5.1.1.3.3.3.3a.cmml" xref="S2.p2.5.m5.1.1.3.3.3.3"><mtext id="S2.p2.5.m5.1.1.3.3.3.3.cmml" mathsize="50%" xref="S2.p2.5.m5.1.1.3.3.3.3">in</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.1c">\mathbf{A}\in\mathbb{R}^{r\times d_{\text{in}}}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.5.m5.1d">bold_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_r × italic_d start_POSTSUBSCRIPT in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and are tunrable up- and down-projection matrices, respectively.
The rank <math alttext="r" class="ltx_Math" display="inline" id="S2.p2.6.m6.1"><semantics id="S2.p2.6.m6.1a"><mi id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><ci id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">r</annotation><annotation encoding="application/x-llamapun" id="S2.p2.6.m6.1d">italic_r</annotation></semantics></math> is significantly smaller than both <math alttext="d_{\text{in}}" class="ltx_Math" display="inline" id="S2.p2.7.m7.1"><semantics id="S2.p2.7.m7.1a"><msub id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml"><mi id="S2.p2.7.m7.1.1.2" xref="S2.p2.7.m7.1.1.2.cmml">d</mi><mtext id="S2.p2.7.m7.1.1.3" xref="S2.p2.7.m7.1.1.3a.cmml">in</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><apply id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p2.7.m7.1.1.1.cmml" xref="S2.p2.7.m7.1.1">subscript</csymbol><ci id="S2.p2.7.m7.1.1.2.cmml" xref="S2.p2.7.m7.1.1.2">𝑑</ci><ci id="S2.p2.7.m7.1.1.3a.cmml" xref="S2.p2.7.m7.1.1.3"><mtext id="S2.p2.7.m7.1.1.3.cmml" mathsize="70%" xref="S2.p2.7.m7.1.1.3">in</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">d_{\text{in}}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.7.m7.1d">italic_d start_POSTSUBSCRIPT in end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="d_{\text{out}}" class="ltx_Math" display="inline" id="S2.p2.8.m8.1"><semantics id="S2.p2.8.m8.1a"><msub id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml"><mi id="S2.p2.8.m8.1.1.2" xref="S2.p2.8.m8.1.1.2.cmml">d</mi><mtext id="S2.p2.8.m8.1.1.3" xref="S2.p2.8.m8.1.1.3a.cmml">out</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b"><apply id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.p2.8.m8.1.1.1.cmml" xref="S2.p2.8.m8.1.1">subscript</csymbol><ci id="S2.p2.8.m8.1.1.2.cmml" xref="S2.p2.8.m8.1.1.2">𝑑</ci><ci id="S2.p2.8.m8.1.1.3a.cmml" xref="S2.p2.8.m8.1.1.3"><mtext id="S2.p2.8.m8.1.1.3.cmml" mathsize="70%" xref="S2.p2.8.m8.1.1.3">out</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">d_{\text{out}}</annotation><annotation encoding="application/x-llamapun" id="S2.p2.8.m8.1d">italic_d start_POSTSUBSCRIPT out end_POSTSUBSCRIPT</annotation></semantics></math>, enhancing adaptation efficiency.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.2">Typically, LoRA applies such updates to the query and value projection matrices in the multi-head attention sub-layers within transformer layers <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib37" title="">37</a>]</cite>.
Specifically, for an input <math alttext="\mathbf{h}" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">\mathbf{h}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">bold_h</annotation></semantics></math> to the linear projection in the multi-head attention, LoRA results in the output <math alttext="\mathbf{h}^{\prime}" class="ltx_Math" display="inline" id="S2.p3.2.m2.1"><semantics id="S2.p3.2.m2.1a"><msup id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml"><mi id="S2.p3.2.m2.1.1.2" xref="S2.p3.2.m2.1.1.2.cmml">𝐡</mi><mo id="S2.p3.2.m2.1.1.3" xref="S2.p3.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.1b"><apply id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p3.2.m2.1.1.1.cmml" xref="S2.p3.2.m2.1.1">superscript</csymbol><ci id="S2.p3.2.m2.1.1.2.cmml" xref="S2.p3.2.m2.1.1.2">𝐡</ci><ci id="S2.p3.2.m2.1.1.3.cmml" xref="S2.p3.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.1c">\mathbf{h}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.1d">bold_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> as:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="A5.EGx1">
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{h}^{\prime}=(\mathbf{W}+\frac{\alpha}{r}\Delta\mathbf{W})%
\mathbf{h}=\mathbf{Wh}+\frac{\alpha}{r}\mathbf{BAh}," class="ltx_Math" display="block" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><msup id="S2.E3.m1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.3.2.cmml">𝐡</mi><mo id="S2.E3.m1.1.1.1.1.3.3" xref="S2.E3.m1.1.1.1.1.3.3.cmml">′</mo></msup><mo id="S2.E3.m1.1.1.1.1.4" xref="S2.E3.m1.1.1.1.1.4.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E3.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml">𝐖</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S2.E3.m1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">α</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.3.cmml">r</mi></mfrac><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.3.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3" mathvariant="normal" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml">Δ</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1.3.1a" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.3.4" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.4.cmml">𝐖</mi></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S2.E3.m1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.3.cmml">𝐡</mi></mrow><mo id="S2.E3.m1.1.1.1.1.5" xref="S2.E3.m1.1.1.1.1.5.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.6" xref="S2.E3.m1.1.1.1.1.6.cmml"><mi id="S2.E3.m1.1.1.1.1.6.2" xref="S2.E3.m1.1.1.1.1.6.2.cmml">𝐖𝐡</mi><mo id="S2.E3.m1.1.1.1.1.6.1" xref="S2.E3.m1.1.1.1.1.6.1.cmml">+</mo><mrow id="S2.E3.m1.1.1.1.1.6.3" xref="S2.E3.m1.1.1.1.1.6.3.cmml"><mfrac id="S2.E3.m1.1.1.1.1.6.3.2" xref="S2.E3.m1.1.1.1.1.6.3.2.cmml"><mi id="S2.E3.m1.1.1.1.1.6.3.2.2" xref="S2.E3.m1.1.1.1.1.6.3.2.2.cmml">α</mi><mi id="S2.E3.m1.1.1.1.1.6.3.2.3" xref="S2.E3.m1.1.1.1.1.6.3.2.3.cmml">r</mi></mfrac><mo id="S2.E3.m1.1.1.1.1.6.3.1" xref="S2.E3.m1.1.1.1.1.6.3.1.cmml">⁢</mo><mi id="S2.E3.m1.1.1.1.1.6.3.3" xref="S2.E3.m1.1.1.1.1.6.3.3.cmml">𝐁𝐀𝐡</mi></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><and id="S2.E3.m1.1.1.1.1a.cmml" xref="S2.E3.m1.1.1.1"></and><apply id="S2.E3.m1.1.1.1.1b.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.4.cmml" xref="S2.E3.m1.1.1.1.1.4"></eq><apply id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.3">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.3.2">𝐡</ci><ci id="S2.E3.m1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.3.3">′</ci></apply><apply id="S2.E3.m1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1"><times id="S2.E3.m1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.2"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1"><plus id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1"></plus><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.2">𝐖</ci><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3"><times id="S2.E3.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.1"></times><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2"><divide id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2"></divide><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.2">𝛼</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.2.3">𝑟</ci></apply><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.3">Δ</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.3.4">𝐖</ci></apply></apply><ci id="S2.E3.m1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.3">𝐡</ci></apply></apply><apply id="S2.E3.m1.1.1.1.1c.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.5.cmml" xref="S2.E3.m1.1.1.1.1.5"></eq><share href="https://arxiv.org/html/2408.10159v2#S2.E3.m1.1.1.1.1.1.cmml" id="S2.E3.m1.1.1.1.1d.cmml" xref="S2.E3.m1.1.1.1"></share><apply id="S2.E3.m1.1.1.1.1.6.cmml" xref="S2.E3.m1.1.1.1.1.6"><plus id="S2.E3.m1.1.1.1.1.6.1.cmml" xref="S2.E3.m1.1.1.1.1.6.1"></plus><ci id="S2.E3.m1.1.1.1.1.6.2.cmml" xref="S2.E3.m1.1.1.1.1.6.2">𝐖𝐡</ci><apply id="S2.E3.m1.1.1.1.1.6.3.cmml" xref="S2.E3.m1.1.1.1.1.6.3"><times id="S2.E3.m1.1.1.1.1.6.3.1.cmml" xref="S2.E3.m1.1.1.1.1.6.3.1"></times><apply id="S2.E3.m1.1.1.1.1.6.3.2.cmml" xref="S2.E3.m1.1.1.1.1.6.3.2"><divide id="S2.E3.m1.1.1.1.1.6.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.6.3.2"></divide><ci id="S2.E3.m1.1.1.1.1.6.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.6.3.2.2">𝛼</ci><ci id="S2.E3.m1.1.1.1.1.6.3.2.3.cmml" xref="S2.E3.m1.1.1.1.1.6.3.2.3">𝑟</ci></apply><ci id="S2.E3.m1.1.1.1.1.6.3.3.cmml" xref="S2.E3.m1.1.1.1.1.6.3.3">𝐁𝐀𝐡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\mathbf{h}^{\prime}=(\mathbf{W}+\frac{\alpha}{r}\Delta\mathbf{W})%
\mathbf{h}=\mathbf{Wh}+\frac{\alpha}{r}\mathbf{BAh},</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">bold_h start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = ( bold_W + divide start_ARG italic_α end_ARG start_ARG italic_r end_ARG roman_Δ bold_W ) bold_h = bold_Wh + divide start_ARG italic_α end_ARG start_ARG italic_r end_ARG bold_BAh ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p3.5">where <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S2.p3.3.m1.1"><semantics id="S2.p3.3.m1.1a"><mi id="S2.p3.3.m1.1.1" xref="S2.p3.3.m1.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S2.p3.3.m1.1b"><ci id="S2.p3.3.m1.1.1.cmml" xref="S2.p3.3.m1.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m1.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m1.1d">bold_W</annotation></semantics></math> remains frozen, and <math alttext="\alpha" class="ltx_Math" display="inline" id="S2.p3.4.m2.1"><semantics id="S2.p3.4.m2.1a"><mi id="S2.p3.4.m2.1.1" xref="S2.p3.4.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.p3.4.m2.1b"><ci id="S2.p3.4.m2.1.1.cmml" xref="S2.p3.4.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m2.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m2.1d">italic_α</annotation></semantics></math> is introduced as a scaling factor that adjusts the influence of the updates <em class="ltx_emph ltx_font_italic" id="S2.p3.5.1">w.r.t.</em> the original <math alttext="\mathbf{W}" class="ltx_Math" display="inline" id="S2.p3.5.m3.1"><semantics id="S2.p3.5.m3.1a"><mi id="S2.p3.5.m3.1.1" xref="S2.p3.5.m3.1.1.cmml">𝐖</mi><annotation-xml encoding="MathML-Content" id="S2.p3.5.m3.1b"><ci id="S2.p3.5.m3.1.1.cmml" xref="S2.p3.5.m3.1.1">𝐖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m3.1c">\mathbf{W}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.5.m3.1d">bold_W</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">This methodology introduces a flexible and efficient means to customize these models to new tasks, circumventing the need for extensive retraining of all model parameters.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.4"><span class="ltx_text ltx_font_bold" id="S2.p5.4.1">Fine-tuning with Hybrid Prompting.</span>
In the field of LLM-based sequential recommendation, a critical challenge is the divergence between the natural language space and the “user behavior” space.
To bridge this gap, previous research <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib22" title="">22</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib25" title="">25</a>]</cite> introduces a hybrid prompt approach, which incorporates behavioral insights captured by recommendation models into the prompts.
This approach combines the textual token representation derived from the LLM’s word embedding layer, with a behavior token representation learned from the recommender model with a cross-modal projector.
Formally, for an item <math alttext="i" class="ltx_Math" display="inline" id="S2.p5.1.m1.1"><semantics id="S2.p5.1.m1.1a"><mi id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p5.1.m1.1b"><ci id="S2.p5.1.m1.1.1.cmml" xref="S2.p5.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.1.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p5.1.m1.1d">italic_i</annotation></semantics></math> with associated metadata <math alttext="txt" class="ltx_Math" display="inline" id="S2.p5.2.m2.1"><semantics id="S2.p5.2.m2.1a"><mrow id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml"><mi id="S2.p5.2.m2.1.1.2" xref="S2.p5.2.m2.1.1.2.cmml">t</mi><mo id="S2.p5.2.m2.1.1.1" xref="S2.p5.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.p5.2.m2.1.1.3" xref="S2.p5.2.m2.1.1.3.cmml">x</mi><mo id="S2.p5.2.m2.1.1.1a" xref="S2.p5.2.m2.1.1.1.cmml">⁢</mo><mi id="S2.p5.2.m2.1.1.4" xref="S2.p5.2.m2.1.1.4.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.2.m2.1b"><apply id="S2.p5.2.m2.1.1.cmml" xref="S2.p5.2.m2.1.1"><times id="S2.p5.2.m2.1.1.1.cmml" xref="S2.p5.2.m2.1.1.1"></times><ci id="S2.p5.2.m2.1.1.2.cmml" xref="S2.p5.2.m2.1.1.2">𝑡</ci><ci id="S2.p5.2.m2.1.1.3.cmml" xref="S2.p5.2.m2.1.1.3">𝑥</ci><ci id="S2.p5.2.m2.1.1.4.cmml" xref="S2.p5.2.m2.1.1.4">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.2.m2.1c">txt</annotation><annotation encoding="application/x-llamapun" id="S2.p5.2.m2.1d">italic_t italic_x italic_t</annotation></semantics></math>, the LLM tokenizer and word embedding layer <math alttext="\text{LLM-TKZ}(\cdot)" class="ltx_Math" display="inline" id="S2.p5.3.m3.1"><semantics id="S2.p5.3.m3.1a"><mrow id="S2.p5.3.m3.1.2" xref="S2.p5.3.m3.1.2.cmml"><mtext id="S2.p5.3.m3.1.2.2" xref="S2.p5.3.m3.1.2.2a.cmml">LLM-TKZ</mtext><mo id="S2.p5.3.m3.1.2.1" xref="S2.p5.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.p5.3.m3.1.2.3.2" xref="S2.p5.3.m3.1.2.cmml"><mo id="S2.p5.3.m3.1.2.3.2.1" stretchy="false" xref="S2.p5.3.m3.1.2.cmml">(</mo><mo id="S2.p5.3.m3.1.1" lspace="0em" rspace="0em" xref="S2.p5.3.m3.1.1.cmml">⋅</mo><mo id="S2.p5.3.m3.1.2.3.2.2" stretchy="false" xref="S2.p5.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.3.m3.1b"><apply id="S2.p5.3.m3.1.2.cmml" xref="S2.p5.3.m3.1.2"><times id="S2.p5.3.m3.1.2.1.cmml" xref="S2.p5.3.m3.1.2.1"></times><ci id="S2.p5.3.m3.1.2.2a.cmml" xref="S2.p5.3.m3.1.2.2"><mtext id="S2.p5.3.m3.1.2.2.cmml" xref="S2.p5.3.m3.1.2.2">LLM-TKZ</mtext></ci><ci id="S2.p5.3.m3.1.1.cmml" xref="S2.p5.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.3.m3.1c">\text{LLM-TKZ}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p5.3.m3.1d">LLM-TKZ ( ⋅ )</annotation></semantics></math> convert it into token representations <math alttext="\mathbf{s}" class="ltx_Math" display="inline" id="S2.p5.4.m4.1"><semantics id="S2.p5.4.m4.1a"><mi id="S2.p5.4.m4.1.1" xref="S2.p5.4.m4.1.1.cmml">𝐬</mi><annotation-xml encoding="MathML-Content" id="S2.p5.4.m4.1b"><ci id="S2.p5.4.m4.1.1.cmml" xref="S2.p5.4.m4.1.1">𝐬</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.4.m4.1c">\mathbf{s}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.4.m4.1d">bold_s</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{s}=\text{LLM-TKZ}_{\bm{\phi}}(txt)." class="ltx_Math" display="block" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.3.cmml">𝐬</mi><mo id="S2.E4.m1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.2.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.cmml"><msub id="S2.E4.m1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.3.cmml"><mtext id="S2.E4.m1.1.1.1.1.1.3.2" xref="S2.E4.m1.1.1.1.1.1.3.2a.cmml">LLM-TKZ</mtext><mi class="ltx_mathvariant_bold-italic" id="S2.E4.m1.1.1.1.1.1.3.3" mathvariant="bold-italic" xref="S2.E4.m1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S2.E4.m1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml">t</mi><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml">x</mi><mo id="S2.E4.m1.1.1.1.1.1.1.1.1.1a" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.4" xref="S2.E4.m1.1.1.1.1.1.1.1.1.4.cmml">t</mi></mrow><mo id="S2.E4.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E4.m1.1.1.1.2" lspace="0em" xref="S2.E4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.2"></eq><ci id="S2.E4.m1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.3">𝐬</ci><apply id="S2.E4.m1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.2"></times><apply id="S2.E4.m1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.3.2a.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2"><mtext id="S2.E4.m1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.1.1.1.1.1.3.2">LLM-TKZ</mtext></ci><ci id="S2.E4.m1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.1.1.1.1.1.3.3">bold-italic-ϕ</ci></apply><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1"><times id="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1"></times><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.2">𝑡</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.3">𝑥</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.4">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\mathbf{s}=\text{LLM-TKZ}_{\bm{\phi}}(txt).</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">bold_s = LLM-TKZ start_POSTSUBSCRIPT bold_italic_ϕ end_POSTSUBSCRIPT ( italic_t italic_x italic_t ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p5.7">Concurrently, item <math alttext="i" class="ltx_Math" display="inline" id="S2.p5.5.m1.1"><semantics id="S2.p5.5.m1.1a"><mi id="S2.p5.5.m1.1.1" xref="S2.p5.5.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p5.5.m1.1b"><ci id="S2.p5.5.m1.1.1.cmml" xref="S2.p5.5.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.5.m1.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p5.5.m1.1d">italic_i</annotation></semantics></math>’s ID embedding <math alttext="\mathbf{z}" class="ltx_Math" display="inline" id="S2.p5.6.m2.1"><semantics id="S2.p5.6.m2.1a"><mi id="S2.p5.6.m2.1.1" xref="S2.p5.6.m2.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S2.p5.6.m2.1b"><ci id="S2.p5.6.m2.1.1.cmml" xref="S2.p5.6.m2.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.6.m2.1c">\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.6.m2.1d">bold_z</annotation></semantics></math>, pretrained using the encoder <math alttext="\text{SR-EMB}(\cdot)" class="ltx_Math" display="inline" id="S2.p5.7.m3.1"><semantics id="S2.p5.7.m3.1a"><mrow id="S2.p5.7.m3.1.2" xref="S2.p5.7.m3.1.2.cmml"><mtext id="S2.p5.7.m3.1.2.2" xref="S2.p5.7.m3.1.2.2a.cmml">SR-EMB</mtext><mo id="S2.p5.7.m3.1.2.1" xref="S2.p5.7.m3.1.2.1.cmml">⁢</mo><mrow id="S2.p5.7.m3.1.2.3.2" xref="S2.p5.7.m3.1.2.cmml"><mo id="S2.p5.7.m3.1.2.3.2.1" stretchy="false" xref="S2.p5.7.m3.1.2.cmml">(</mo><mo id="S2.p5.7.m3.1.1" lspace="0em" rspace="0em" xref="S2.p5.7.m3.1.1.cmml">⋅</mo><mo id="S2.p5.7.m3.1.2.3.2.2" stretchy="false" xref="S2.p5.7.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.7.m3.1b"><apply id="S2.p5.7.m3.1.2.cmml" xref="S2.p5.7.m3.1.2"><times id="S2.p5.7.m3.1.2.1.cmml" xref="S2.p5.7.m3.1.2.1"></times><ci id="S2.p5.7.m3.1.2.2a.cmml" xref="S2.p5.7.m3.1.2.2"><mtext id="S2.p5.7.m3.1.2.2.cmml" xref="S2.p5.7.m3.1.2.2">SR-EMB</mtext></ci><ci id="S2.p5.7.m3.1.1.cmml" xref="S2.p5.7.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.7.m3.1c">\text{SR-EMB}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p5.7.m3.1d">SR-EMB ( ⋅ )</annotation></semantics></math> of sequential recommender (<em class="ltx_emph ltx_font_italic" id="S2.p5.7.1">e.g., </em>SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib3" title="">3</a>]</cite>, GRU4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib1" title="">1</a>]</cite>), is represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}=\text{SR-EMB}_{\bm{\theta}}(i)." class="ltx_Math" display="block" id="S2.E5.m1.2"><semantics id="S2.E5.m1.2a"><mrow id="S2.E5.m1.2.2.1" xref="S2.E5.m1.2.2.1.1.cmml"><mrow id="S2.E5.m1.2.2.1.1" xref="S2.E5.m1.2.2.1.1.cmml"><mi id="S2.E5.m1.2.2.1.1.2" xref="S2.E5.m1.2.2.1.1.2.cmml">𝐳</mi><mo id="S2.E5.m1.2.2.1.1.1" xref="S2.E5.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E5.m1.2.2.1.1.3" xref="S2.E5.m1.2.2.1.1.3.cmml"><msub id="S2.E5.m1.2.2.1.1.3.2" xref="S2.E5.m1.2.2.1.1.3.2.cmml"><mtext id="S2.E5.m1.2.2.1.1.3.2.2" xref="S2.E5.m1.2.2.1.1.3.2.2a.cmml">SR-EMB</mtext><mi id="S2.E5.m1.2.2.1.1.3.2.3" xref="S2.E5.m1.2.2.1.1.3.2.3.cmml">𝜽</mi></msub><mo id="S2.E5.m1.2.2.1.1.3.1" xref="S2.E5.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E5.m1.2.2.1.1.3.3.2" xref="S2.E5.m1.2.2.1.1.3.cmml"><mo id="S2.E5.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.E5.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">i</mi><mo id="S2.E5.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S2.E5.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m1.2.2.1.2" lspace="0em" xref="S2.E5.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.2b"><apply id="S2.E5.m1.2.2.1.1.cmml" xref="S2.E5.m1.2.2.1"><eq id="S2.E5.m1.2.2.1.1.1.cmml" xref="S2.E5.m1.2.2.1.1.1"></eq><ci id="S2.E5.m1.2.2.1.1.2.cmml" xref="S2.E5.m1.2.2.1.1.2">𝐳</ci><apply id="S2.E5.m1.2.2.1.1.3.cmml" xref="S2.E5.m1.2.2.1.1.3"><times id="S2.E5.m1.2.2.1.1.3.1.cmml" xref="S2.E5.m1.2.2.1.1.3.1"></times><apply id="S2.E5.m1.2.2.1.1.3.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.1.1.3.2.1.cmml" xref="S2.E5.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S2.E5.m1.2.2.1.1.3.2.2a.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2"><mtext id="S2.E5.m1.2.2.1.1.3.2.2.cmml" xref="S2.E5.m1.2.2.1.1.3.2.2">SR-EMB</mtext></ci><ci id="S2.E5.m1.2.2.1.1.3.2.3.cmml" xref="S2.E5.m1.2.2.1.1.3.2.3">𝜽</ci></apply><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.2c">\mathbf{z}=\text{SR-EMB}_{\bm{\theta}}(i).</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.2d">bold_z = SR-EMB start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( italic_i ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p5.10">Then the ID embedding is transferred into a behavior token representation through a trainable projector <math alttext="\text{Proj}(\cdot)" class="ltx_Math" display="inline" id="S2.p5.8.m1.1"><semantics id="S2.p5.8.m1.1a"><mrow id="S2.p5.8.m1.1.2" xref="S2.p5.8.m1.1.2.cmml"><mtext id="S2.p5.8.m1.1.2.2" xref="S2.p5.8.m1.1.2.2a.cmml">Proj</mtext><mo id="S2.p5.8.m1.1.2.1" xref="S2.p5.8.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p5.8.m1.1.2.3.2" xref="S2.p5.8.m1.1.2.cmml"><mo id="S2.p5.8.m1.1.2.3.2.1" stretchy="false" xref="S2.p5.8.m1.1.2.cmml">(</mo><mo id="S2.p5.8.m1.1.1" lspace="0em" rspace="0em" xref="S2.p5.8.m1.1.1.cmml">⋅</mo><mo id="S2.p5.8.m1.1.2.3.2.2" stretchy="false" xref="S2.p5.8.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p5.8.m1.1b"><apply id="S2.p5.8.m1.1.2.cmml" xref="S2.p5.8.m1.1.2"><times id="S2.p5.8.m1.1.2.1.cmml" xref="S2.p5.8.m1.1.2.1"></times><ci id="S2.p5.8.m1.1.2.2a.cmml" xref="S2.p5.8.m1.1.2.2"><mtext id="S2.p5.8.m1.1.2.2.cmml" xref="S2.p5.8.m1.1.2.2">Proj</mtext></ci><ci id="S2.p5.8.m1.1.1.cmml" xref="S2.p5.8.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.8.m1.1c">\text{Proj}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p5.8.m1.1d">Proj ( ⋅ )</annotation></semantics></math> parameterized by <math alttext="\bm{\tau}_{1}" class="ltx_Math" display="inline" id="S2.p5.9.m2.1"><semantics id="S2.p5.9.m2.1a"><msub id="S2.p5.9.m2.1.1" xref="S2.p5.9.m2.1.1.cmml"><mi id="S2.p5.9.m2.1.1.2" xref="S2.p5.9.m2.1.1.2.cmml">𝝉</mi><mn id="S2.p5.9.m2.1.1.3" xref="S2.p5.9.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S2.p5.9.m2.1b"><apply id="S2.p5.9.m2.1.1.cmml" xref="S2.p5.9.m2.1.1"><csymbol cd="ambiguous" id="S2.p5.9.m2.1.1.1.cmml" xref="S2.p5.9.m2.1.1">subscript</csymbol><ci id="S2.p5.9.m2.1.1.2.cmml" xref="S2.p5.9.m2.1.1.2">𝝉</ci><cn id="S2.p5.9.m2.1.1.3.cmml" type="integer" xref="S2.p5.9.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.9.m2.1c">\bm{\tau}_{1}</annotation><annotation encoding="application/x-llamapun" id="S2.p5.9.m2.1d">bold_italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> to facilitate the alignment between the two modalities.
This alignment strategy enables LLMs to interpret and leverage the behavioral knowledge distilled by conventional recommenders <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib25" title="">25</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib22" title="">22</a>]</cite>.
Subsequently, the textual and behavioral token representations are then concatenated to form a comprehensive description of item <math alttext="i" class="ltx_Math" display="inline" id="S2.p5.10.m3.1"><semantics id="S2.p5.10.m3.1a"><mi id="S2.p5.10.m3.1.1" xref="S2.p5.10.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.p5.10.m3.1b"><ci id="S2.p5.10.m3.1.1.cmml" xref="S2.p5.10.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p5.10.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S2.p5.10.m3.1d">italic_i</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{e}=\text{Concat}(\mathbf{s},\text{Proj}_{\bm{\tau}_{1}}(\mathbf{z}))." class="ltx_Math" display="block" id="S2.E6.m1.3"><semantics id="S2.E6.m1.3a"><mrow id="S2.E6.m1.3.3.1" xref="S2.E6.m1.3.3.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1" xref="S2.E6.m1.3.3.1.1.cmml"><mi id="S2.E6.m1.3.3.1.1.3" xref="S2.E6.m1.3.3.1.1.3.cmml">𝐞</mi><mo id="S2.E6.m1.3.3.1.1.2" xref="S2.E6.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E6.m1.3.3.1.1.1" xref="S2.E6.m1.3.3.1.1.1.cmml"><mtext id="S2.E6.m1.3.3.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.3a.cmml">Concat</mtext><mo id="S2.E6.m1.3.3.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.2.cmml"><mo id="S2.E6.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.2.cmml">(</mo><mi id="S2.E6.m1.2.2" xref="S2.E6.m1.2.2.cmml">𝐬</mi><mo id="S2.E6.m1.3.3.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.2.cmml">,</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.cmml"><msub id="S2.E6.m1.3.3.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.cmml"><mtext id="S2.E6.m1.3.3.1.1.1.1.1.1.2.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.2a.cmml">Proj</mtext><msub id="S2.E6.m1.3.3.1.1.1.1.1.1.2.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">𝝉</mi><mn id="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.3.cmml">1</mn></msub></msub><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">𝐳</mi><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E6.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S2.E6.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.3.3.1.2" lspace="0em" xref="S2.E6.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.3b"><apply id="S2.E6.m1.3.3.1.1.cmml" xref="S2.E6.m1.3.3.1"><eq id="S2.E6.m1.3.3.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.2"></eq><ci id="S2.E6.m1.3.3.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.3">𝐞</ci><apply id="S2.E6.m1.3.3.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1"><times id="S2.E6.m1.3.3.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.2"></times><ci id="S2.E6.m1.3.3.1.1.1.3a.cmml" xref="S2.E6.m1.3.3.1.1.1.3"><mtext id="S2.E6.m1.3.3.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3">Concat</mtext></ci><interval closure="open" id="S2.E6.m1.3.3.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1"><ci id="S2.E6.m1.2.2.cmml" xref="S2.E6.m1.2.2">𝐬</ci><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1"><times id="S2.E6.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1"></times><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.2.2a.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.2"><mtext id="S2.E6.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.2">Proj</mtext></ci><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.2">𝝉</ci><cn id="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.3.3">1</cn></apply></apply><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝐳</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.3c">\mathbf{e}=\text{Concat}(\mathbf{s},\text{Proj}_{\bm{\tau}_{1}}(\mathbf{z})).</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.3d">bold_e = Concat ( bold_s , Proj start_POSTSUBSCRIPT bold_italic_τ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_z ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.p6">
<p class="ltx_p" id="S2.p6.4">By converting each item into a hybrid token representation (<em class="ltx_emph ltx_font_italic" id="S2.p6.4.1">cf. </em>Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S2.E6" title="In 2 Preliminary ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">6</span></a>)), we can rewrite the input prompt <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S2.p6.1.m1.1"><semantics id="S2.p6.1.m1.1a"><mi id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><ci id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.1.m1.1d">bold_x</annotation></semantics></math> describing the sequence <math alttext="\mathbf{i}_{&lt;n}" class="ltx_Math" display="inline" id="S2.p6.2.m2.1"><semantics id="S2.p6.2.m2.1a"><msub id="S2.p6.2.m2.1.1" xref="S2.p6.2.m2.1.1.cmml"><mi id="S2.p6.2.m2.1.1.2" xref="S2.p6.2.m2.1.1.2.cmml">𝐢</mi><mrow id="S2.p6.2.m2.1.1.3" xref="S2.p6.2.m2.1.1.3.cmml"><mi id="S2.p6.2.m2.1.1.3.2" xref="S2.p6.2.m2.1.1.3.2.cmml"></mi><mo id="S2.p6.2.m2.1.1.3.1" xref="S2.p6.2.m2.1.1.3.1.cmml">&lt;</mo><mi id="S2.p6.2.m2.1.1.3.3" xref="S2.p6.2.m2.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p6.2.m2.1b"><apply id="S2.p6.2.m2.1.1.cmml" xref="S2.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p6.2.m2.1.1.1.cmml" xref="S2.p6.2.m2.1.1">subscript</csymbol><ci id="S2.p6.2.m2.1.1.2.cmml" xref="S2.p6.2.m2.1.1.2">𝐢</ci><apply id="S2.p6.2.m2.1.1.3.cmml" xref="S2.p6.2.m2.1.1.3"><lt id="S2.p6.2.m2.1.1.3.1.cmml" xref="S2.p6.2.m2.1.1.3.1"></lt><csymbol cd="latexml" id="S2.p6.2.m2.1.1.3.2.cmml" xref="S2.p6.2.m2.1.1.3.2">absent</csymbol><ci id="S2.p6.2.m2.1.1.3.3.cmml" xref="S2.p6.2.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m2.1c">\mathbf{i}_{&lt;n}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.2.m2.1d">bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT</annotation></semantics></math> and target response <math alttext="\mathbf{y}" class="ltx_Math" display="inline" id="S2.p6.3.m3.1"><semantics id="S2.p6.3.m3.1a"><mi id="S2.p6.3.m3.1.1" xref="S2.p6.3.m3.1.1.cmml">𝐲</mi><annotation-xml encoding="MathML-Content" id="S2.p6.3.m3.1b"><ci id="S2.p6.3.m3.1.1.cmml" xref="S2.p6.3.m3.1.1">𝐲</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.3.m3.1c">\mathbf{y}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.3.m3.1d">bold_y</annotation></semantics></math> decipting the item of interest <math alttext="i_{n}" class="ltx_Math" display="inline" id="S2.p6.4.m4.1"><semantics id="S2.p6.4.m4.1a"><msub id="S2.p6.4.m4.1.1" xref="S2.p6.4.m4.1.1.cmml"><mi id="S2.p6.4.m4.1.1.2" xref="S2.p6.4.m4.1.1.2.cmml">i</mi><mi id="S2.p6.4.m4.1.1.3" xref="S2.p6.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.4.m4.1b"><apply id="S2.p6.4.m4.1.1.cmml" xref="S2.p6.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p6.4.m4.1.1.1.cmml" xref="S2.p6.4.m4.1.1">subscript</csymbol><ci id="S2.p6.4.m4.1.1.2.cmml" xref="S2.p6.4.m4.1.1.2">𝑖</ci><ci id="S2.p6.4.m4.1.1.3.cmml" xref="S2.p6.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.4.m4.1c">i_{n}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.4.m4.1d">italic_i start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>.
Upon such prompts and responses, the objective of applying a uniform LoRA module is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\max_{\Delta\bm{\phi}}\sum_{(\mathbf{x},\mathbf{y})}\sum_{t=1}^{|\mathbf{y}|}%
\log P_{\bm{\phi}+\Delta\bm{\phi}}(y_{t}|\mathbf{x},\mathbf{y}_{&lt;t})." class="ltx_Math" display="block" id="S2.E7.m1.5"><semantics id="S2.E7.m1.5a"><mrow id="S2.E7.m1.5.5.1" xref="S2.E7.m1.5.5.1.1.cmml"><mrow id="S2.E7.m1.5.5.1.1" xref="S2.E7.m1.5.5.1.1.cmml"><munder id="S2.E7.m1.5.5.1.1.3" xref="S2.E7.m1.5.5.1.1.3.cmml"><mi id="S2.E7.m1.5.5.1.1.3.2" xref="S2.E7.m1.5.5.1.1.3.2.cmml">max</mi><mrow id="S2.E7.m1.5.5.1.1.3.3" xref="S2.E7.m1.5.5.1.1.3.3.cmml"><mi id="S2.E7.m1.5.5.1.1.3.3.2" mathvariant="normal" xref="S2.E7.m1.5.5.1.1.3.3.2.cmml">Δ</mi><mo id="S2.E7.m1.5.5.1.1.3.3.1" xref="S2.E7.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mi class="ltx_mathvariant_bold-italic" id="S2.E7.m1.5.5.1.1.3.3.3" mathvariant="bold-italic" xref="S2.E7.m1.5.5.1.1.3.3.3.cmml">ϕ</mi></mrow></munder><mo id="S2.E7.m1.5.5.1.1.2" xref="S2.E7.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="S2.E7.m1.5.5.1.1.1" xref="S2.E7.m1.5.5.1.1.1.cmml"><munder id="S2.E7.m1.5.5.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.2.cmml"><mo id="S2.E7.m1.5.5.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S2.E7.m1.5.5.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E7.m1.2.2.2.4" xref="S2.E7.m1.2.2.2.3.cmml"><mo id="S2.E7.m1.2.2.2.4.1" stretchy="false" xref="S2.E7.m1.2.2.2.3.cmml">(</mo><mi id="S2.E7.m1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.cmml">𝐱</mi><mo id="S2.E7.m1.2.2.2.4.2" xref="S2.E7.m1.2.2.2.3.cmml">,</mo><mi id="S2.E7.m1.2.2.2.2" xref="S2.E7.m1.2.2.2.2.cmml">𝐲</mi><mo id="S2.E7.m1.2.2.2.4.3" stretchy="false" xref="S2.E7.m1.2.2.2.3.cmml">)</mo></mrow></munder><mrow id="S2.E7.m1.5.5.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.1.cmml"><munderover id="S2.E7.m1.5.5.1.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.1.2.cmml"><mo id="S2.E7.m1.5.5.1.1.1.1.2.2.2" movablelimits="false" xref="S2.E7.m1.5.5.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.2.2.3" xref="S2.E7.m1.5.5.1.1.1.1.2.2.3.cmml"><mi id="S2.E7.m1.5.5.1.1.1.1.2.2.3.2" xref="S2.E7.m1.5.5.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S2.E7.m1.5.5.1.1.1.1.2.2.3.1" xref="S2.E7.m1.5.5.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E7.m1.5.5.1.1.1.1.2.2.3.3" xref="S2.E7.m1.5.5.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S2.E7.m1.3.3.1.3" xref="S2.E7.m1.3.3.1.2.cmml"><mo id="S2.E7.m1.3.3.1.3.1" stretchy="false" xref="S2.E7.m1.3.3.1.2.1.cmml">|</mo><mi id="S2.E7.m1.3.3.1.1" xref="S2.E7.m1.3.3.1.1.cmml">𝐲</mi><mo id="S2.E7.m1.3.3.1.3.2" stretchy="false" xref="S2.E7.m1.3.3.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S2.E7.m1.5.5.1.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.1.1.cmml"><mrow id="S2.E7.m1.5.5.1.1.1.1.1.3" xref="S2.E7.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S2.E7.m1.5.5.1.1.1.1.1.3.1" xref="S2.E7.m1.5.5.1.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E7.m1.5.5.1.1.1.1.1.3a" lspace="0.167em" xref="S2.E7.m1.5.5.1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E7.m1.5.5.1.1.1.1.1.3.2" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.cmml"><mi id="S2.E7.m1.5.5.1.1.1.1.1.3.2.2" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.2.cmml">P</mi><mrow id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.cmml"><mi class="ltx_mathvariant_bold-italic" id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.2" mathvariant="bold-italic" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.2.cmml">ϕ</mi><mo id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.1" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.1.cmml">+</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.cmml"><mi id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.2" mathvariant="normal" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.2.cmml">Δ</mi><mo id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.1" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.1.cmml">⁢</mo><mi class="ltx_mathvariant_bold-italic" id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.3" mathvariant="bold-italic" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.3.cmml">ϕ</mi></mrow></mrow></msub></mrow><mo id="S2.E7.m1.5.5.1.1.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E7.m1.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.3" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S2.E7.m1.4.4" xref="S2.E7.m1.4.4.cmml">𝐱</mi><mo id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐲</mi><mrow id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo id="S2.E7.m1.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E7.m1.5.5.1.2" lspace="0em" xref="S2.E7.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.5b"><apply id="S2.E7.m1.5.5.1.1.cmml" xref="S2.E7.m1.5.5.1"><times id="S2.E7.m1.5.5.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.2"></times><apply id="S2.E7.m1.5.5.1.1.3.cmml" xref="S2.E7.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.3.1.cmml" xref="S2.E7.m1.5.5.1.1.3">subscript</csymbol><max id="S2.E7.m1.5.5.1.1.3.2.cmml" xref="S2.E7.m1.5.5.1.1.3.2"></max><apply id="S2.E7.m1.5.5.1.1.3.3.cmml" xref="S2.E7.m1.5.5.1.1.3.3"><times id="S2.E7.m1.5.5.1.1.3.3.1.cmml" xref="S2.E7.m1.5.5.1.1.3.3.1"></times><ci id="S2.E7.m1.5.5.1.1.3.3.2.cmml" xref="S2.E7.m1.5.5.1.1.3.3.2">Δ</ci><ci id="S2.E7.m1.5.5.1.1.3.3.3.cmml" xref="S2.E7.m1.5.5.1.1.3.3.3">bold-italic-ϕ</ci></apply></apply><apply id="S2.E7.m1.5.5.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1"><apply id="S2.E7.m1.5.5.1.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.1.2.1.cmml" xref="S2.E7.m1.5.5.1.1.1.2">subscript</csymbol><sum id="S2.E7.m1.5.5.1.1.1.2.2.cmml" xref="S2.E7.m1.5.5.1.1.1.2.2"></sum><interval closure="open" id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.4"><ci id="S2.E7.m1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1">𝐱</ci><ci id="S2.E7.m1.2.2.2.2.cmml" xref="S2.E7.m1.2.2.2.2">𝐲</ci></interval></apply><apply id="S2.E7.m1.5.5.1.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1"><apply id="S2.E7.m1.5.5.1.1.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.1.1.2.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.2">superscript</csymbol><apply id="S2.E7.m1.5.5.1.1.1.1.2.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.1.1.2.2.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="S2.E7.m1.5.5.1.1.1.1.2.2.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.2.2.2"></sum><apply id="S2.E7.m1.5.5.1.1.1.1.2.2.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.2.2.3"><eq id="S2.E7.m1.5.5.1.1.1.1.2.2.3.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.2.2.3.1"></eq><ci id="S2.E7.m1.5.5.1.1.1.1.2.2.3.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S2.E7.m1.5.5.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S2.E7.m1.5.5.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E7.m1.3.3.1.2.cmml" xref="S2.E7.m1.3.3.1.3"><abs id="S2.E7.m1.3.3.1.2.1.cmml" xref="S2.E7.m1.3.3.1.3.1"></abs><ci id="S2.E7.m1.3.3.1.1.cmml" xref="S2.E7.m1.3.3.1.1">𝐲</ci></apply></apply><apply id="S2.E7.m1.5.5.1.1.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1"><times id="S2.E7.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.2"></times><apply id="S2.E7.m1.5.5.1.1.1.1.1.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3"><log id="S2.E7.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.1"></log><apply id="S2.E7.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.1.1.1.3.2.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E7.m1.5.5.1.1.1.1.1.3.2.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.2">𝑃</ci><apply id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3"><plus id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.1"></plus><ci id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.2">bold-italic-ϕ</ci><apply id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3"><times id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.1"></times><ci id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.2">Δ</ci><ci id="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.3.2.3.3.3">bold-italic-ϕ</ci></apply></apply></apply></apply><apply id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><list id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E7.m1.4.4.cmml" xref="S2.E7.m1.4.4">𝐱</ci><apply id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">𝐲</ci><apply id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3"><lt id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.5c">\max_{\Delta\bm{\phi}}\sum_{(\mathbf{x},\mathbf{y})}\sum_{t=1}^{|\mathbf{y}|}%
\log P_{\bm{\phi}+\Delta\bm{\phi}}(y_{t}|\mathbf{x},\mathbf{y}_{&lt;t}).</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.5d">roman_max start_POSTSUBSCRIPT roman_Δ bold_italic_ϕ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT ( bold_x , bold_y ) end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | bold_y | end_POSTSUPERSCRIPT roman_log italic_P start_POSTSUBSCRIPT bold_italic_ϕ + roman_Δ bold_italic_ϕ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x , bold_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<figure class="ltx_figure" id="S2.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="320" id="S2.F2.g1" src="extracted/5904678/figures/framework.png" width="568"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S2.F2.2.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text" id="S2.F2.3.2" style="font-size:90%;">The iLoRA framework, which integrates the idea of MoE with LoRA, to implement sequence-customized activation patterns for various sequences.</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.2">To address the issue of negative transfer associated with conventional LoRA fine-tuning, we introduce the Instance-wise LoRA (iLoRA) fine-tuning framework. This innovative approach adapts the Mixture of Experts (MoE) concept <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib30" title="">30</a>]</cite> to tailor Large Language Models (LLMs) to individual characteristics in sequential recommendation, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S2.F2" title="Figure 2 ‣ 2 Preliminary ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.
At the core is the integration of multiple experts, each encouraged to capture a specific aspect of user behaviors.
Different instances of user behavior (<em class="ltx_emph ltx_font_italic" id="S3.p1.2.1">i.e., </em>item sequences) use a gating network to create instance-wise attention scores over experts.
Such attentive experts instantiate the trainable matrices <math alttext="\mathbf{B}" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">𝐁</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\mathbf{B}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">bold_B</annotation></semantics></math> and <math alttext="\mathbf{A}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">𝐀</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝐀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\mathbf{A}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">bold_A</annotation></semantics></math>, thus personalizing a LoRA.
Upon this instance with its individually activated LoRA, We fine-tune the LLM to minimize the negative transfer among disparate sequences.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Instance-wise Generation for Sequential Recommendation</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Applying a uniform LoRA across the population of sequence instances risks overlooking individual variability and easily causes negative transfer, where distinct sequences might adversely affect each other.
This inspires us to view the modeling of each individual instance as a separate task instead, and customize instance-wise LoRA module.
By doing so, the LLM-based recommender is expected to align more closely with the behavioral and preference variability of individual users.
Formally, for any sequence instance <math alttext="\mathbf{i}_{&lt;n}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">𝐢</mi><mrow id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml"></mi><mo id="S3.SS1.p1.1.m1.1.1.3.1" xref="S3.SS1.p1.1.m1.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐢</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><lt id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">absent</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{i}_{&lt;n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, the autoregressive objective with instance-wise LoRA modules is as:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="A5.EGx2">
<tbody id="S3.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\max_{\Delta\bm{\phi}}\sum_{(\mathbf{x},\mathbf{y})}\sum_{t=1}^{|%
\mathbf{y}|}\log P_{\bm{\phi}+\Delta\bm{\phi}(\mathbf{i}_{&lt;n})}(y_{t}|\mathbf{%
x},\mathbf{y}_{&lt;t})," class="ltx_Math" display="block" id="S3.E8.m1.6"><semantics id="S3.E8.m1.6a"><mrow id="S3.E8.m1.6.6.1" xref="S3.E8.m1.6.6.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1" xref="S3.E8.m1.6.6.1.1.cmml"><munder id="S3.E8.m1.6.6.1.1.3" xref="S3.E8.m1.6.6.1.1.3.cmml"><mi id="S3.E8.m1.6.6.1.1.3.2" xref="S3.E8.m1.6.6.1.1.3.2.cmml">max</mi><mrow id="S3.E8.m1.6.6.1.1.3.3" xref="S3.E8.m1.6.6.1.1.3.3.cmml"><mi id="S3.E8.m1.6.6.1.1.3.3.2" mathvariant="normal" xref="S3.E8.m1.6.6.1.1.3.3.2.cmml">Δ</mi><mo id="S3.E8.m1.6.6.1.1.3.3.1" xref="S3.E8.m1.6.6.1.1.3.3.1.cmml">⁢</mo><mi class="ltx_mathvariant_bold-italic" id="S3.E8.m1.6.6.1.1.3.3.3" mathvariant="bold-italic" xref="S3.E8.m1.6.6.1.1.3.3.3.cmml">ϕ</mi></mrow></munder><mo id="S3.E8.m1.6.6.1.1.2" xref="S3.E8.m1.6.6.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.6.6.1.1.1" xref="S3.E8.m1.6.6.1.1.1.cmml"><munder id="S3.E8.m1.6.6.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.2.cmml"><mo id="S3.E8.m1.6.6.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.E8.m1.6.6.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.3.cmml"><mo id="S3.E8.m1.2.2.2.4.1" stretchy="false" xref="S3.E8.m1.2.2.2.3.cmml">(</mo><mi id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml">𝐱</mi><mo id="S3.E8.m1.2.2.2.4.2" xref="S3.E8.m1.2.2.2.3.cmml">,</mo><mi id="S3.E8.m1.2.2.2.2" xref="S3.E8.m1.2.2.2.2.cmml">𝐲</mi><mo id="S3.E8.m1.2.2.2.4.3" stretchy="false" xref="S3.E8.m1.2.2.2.3.cmml">)</mo></mrow></munder><mrow id="S3.E8.m1.6.6.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.cmml"><munderover id="S3.E8.m1.6.6.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.2.cmml"><mo id="S3.E8.m1.6.6.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E8.m1.6.6.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.2.2.3" xref="S3.E8.m1.6.6.1.1.1.1.2.2.3.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.2.2.3.2" xref="S3.E8.m1.6.6.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S3.E8.m1.6.6.1.1.1.1.2.2.3.1" xref="S3.E8.m1.6.6.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E8.m1.6.6.1.1.1.1.2.2.3.3" xref="S3.E8.m1.6.6.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S3.E8.m1.3.3.1.3" xref="S3.E8.m1.3.3.1.2.cmml"><mo id="S3.E8.m1.3.3.1.3.1" stretchy="false" xref="S3.E8.m1.3.3.1.2.1.cmml">|</mo><mi id="S3.E8.m1.3.3.1.1" xref="S3.E8.m1.3.3.1.1.cmml">𝐲</mi><mo id="S3.E8.m1.3.3.1.3.2" stretchy="false" xref="S3.E8.m1.3.3.1.2.1.cmml">|</mo></mrow></munderover><mrow id="S3.E8.m1.6.6.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.cmml"><mrow id="S3.E8.m1.6.6.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.3.1" xref="S3.E8.m1.6.6.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E8.m1.6.6.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E8.m1.6.6.1.1.1.1.1.3.cmml">⁡</mo><msub id="S3.E8.m1.6.6.1.1.1.1.1.3.2" xref="S3.E8.m1.6.6.1.1.1.1.1.3.2.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.3.2.2" xref="S3.E8.m1.6.6.1.1.1.1.1.3.2.2.cmml">P</mi><mrow id="S3.E8.m1.4.4.1" xref="S3.E8.m1.4.4.1.cmml"><mi class="ltx_mathvariant_bold-italic" id="S3.E8.m1.4.4.1.3" mathvariant="bold-italic" xref="S3.E8.m1.4.4.1.3.cmml">ϕ</mi><mo id="S3.E8.m1.4.4.1.2" xref="S3.E8.m1.4.4.1.2.cmml">+</mo><mrow id="S3.E8.m1.4.4.1.1" xref="S3.E8.m1.4.4.1.1.cmml"><mi id="S3.E8.m1.4.4.1.1.3" mathvariant="normal" xref="S3.E8.m1.4.4.1.1.3.cmml">Δ</mi><mo id="S3.E8.m1.4.4.1.1.2" xref="S3.E8.m1.4.4.1.1.2.cmml">⁢</mo><mi class="ltx_mathvariant_bold-italic" id="S3.E8.m1.4.4.1.1.4" mathvariant="bold-italic" xref="S3.E8.m1.4.4.1.1.4.cmml">ϕ</mi><mo id="S3.E8.m1.4.4.1.1.2a" xref="S3.E8.m1.4.4.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.4.4.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.1.cmml"><mo id="S3.E8.m1.4.4.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.4.4.1.1.1.1.1.cmml">(</mo><msub id="S3.E8.m1.4.4.1.1.1.1.1" xref="S3.E8.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.E8.m1.4.4.1.1.1.1.1.2" xref="S3.E8.m1.4.4.1.1.1.1.1.2.cmml">𝐢</mi><mrow id="S3.E8.m1.4.4.1.1.1.1.1.3" xref="S3.E8.m1.4.4.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.4.4.1.1.1.1.1.3.2" xref="S3.E8.m1.4.4.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E8.m1.4.4.1.1.1.1.1.3.1" xref="S3.E8.m1.4.4.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E8.m1.4.4.1.1.1.1.1.3.3" xref="S3.E8.m1.4.4.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.E8.m1.4.4.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></msub></mrow><mo id="S3.E8.m1.6.6.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E8.m1.5.5" xref="S3.E8.m1.5.5.cmml">𝐱</mi><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐲</mi><mrow id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub></mrow></mrow><mo id="S3.E8.m1.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.6.6.1.2" xref="S3.E8.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.6b"><apply id="S3.E8.m1.6.6.1.1.cmml" xref="S3.E8.m1.6.6.1"><times id="S3.E8.m1.6.6.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.2"></times><apply id="S3.E8.m1.6.6.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.3.1.cmml" xref="S3.E8.m1.6.6.1.1.3">subscript</csymbol><max id="S3.E8.m1.6.6.1.1.3.2.cmml" xref="S3.E8.m1.6.6.1.1.3.2"></max><apply id="S3.E8.m1.6.6.1.1.3.3.cmml" xref="S3.E8.m1.6.6.1.1.3.3"><times id="S3.E8.m1.6.6.1.1.3.3.1.cmml" xref="S3.E8.m1.6.6.1.1.3.3.1"></times><ci id="S3.E8.m1.6.6.1.1.3.3.2.cmml" xref="S3.E8.m1.6.6.1.1.3.3.2">Δ</ci><ci id="S3.E8.m1.6.6.1.1.3.3.3.cmml" xref="S3.E8.m1.6.6.1.1.3.3.3">bold-italic-ϕ</ci></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1"><apply id="S3.E8.m1.6.6.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.2">subscript</csymbol><sum id="S3.E8.m1.6.6.1.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.2.2"></sum><interval closure="open" id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.4"><ci id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1">𝐱</ci><ci id="S3.E8.m1.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2">𝐲</ci></interval></apply><apply id="S3.E8.m1.6.6.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1"><apply id="S3.E8.m1.6.6.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2">superscript</csymbol><apply id="S3.E8.m1.6.6.1.1.1.1.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.2.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2">subscript</csymbol><sum id="S3.E8.m1.6.6.1.1.1.1.2.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.2.2"></sum><apply id="S3.E8.m1.6.6.1.1.1.1.2.2.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.2.3"><eq id="S3.E8.m1.6.6.1.1.1.1.2.2.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.2.3.1"></eq><ci id="S3.E8.m1.6.6.1.1.1.1.2.2.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S3.E8.m1.6.6.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E8.m1.6.6.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E8.m1.3.3.1.2.cmml" xref="S3.E8.m1.3.3.1.3"><abs id="S3.E8.m1.3.3.1.2.1.cmml" xref="S3.E8.m1.3.3.1.3.1"></abs><ci id="S3.E8.m1.3.3.1.1.cmml" xref="S3.E8.m1.3.3.1.1">𝐲</ci></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1"><times id="S3.E8.m1.6.6.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.2"></times><apply id="S3.E8.m1.6.6.1.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.3"><log id="S3.E8.m1.6.6.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.3.1"></log><apply id="S3.E8.m1.6.6.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.3.2.2">𝑃</ci><apply id="S3.E8.m1.4.4.1.cmml" xref="S3.E8.m1.4.4.1"><plus id="S3.E8.m1.4.4.1.2.cmml" xref="S3.E8.m1.4.4.1.2"></plus><ci id="S3.E8.m1.4.4.1.3.cmml" xref="S3.E8.m1.4.4.1.3">bold-italic-ϕ</ci><apply id="S3.E8.m1.4.4.1.1.cmml" xref="S3.E8.m1.4.4.1.1"><times id="S3.E8.m1.4.4.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.2"></times><ci id="S3.E8.m1.4.4.1.1.3.cmml" xref="S3.E8.m1.4.4.1.1.3">Δ</ci><ci id="S3.E8.m1.4.4.1.1.4.cmml" xref="S3.E8.m1.4.4.1.1.4">bold-italic-ϕ</ci><apply id="S3.E8.m1.4.4.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.2">𝐢</ci><apply id="S3.E8.m1.4.4.1.1.1.1.1.3.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.3"><lt id="S3.E8.m1.4.4.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E8.m1.4.4.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E8.m1.4.4.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.4.4.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.2">conditional</csymbol><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply><list id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1"><ci id="S3.E8.m1.5.5.cmml" xref="S3.E8.m1.5.5">𝐱</ci><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2">𝐲</ci><apply id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3"><lt id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.6c">\displaystyle\max_{\Delta\bm{\phi}}\sum_{(\mathbf{x},\mathbf{y})}\sum_{t=1}^{|%
\mathbf{y}|}\log P_{\bm{\phi}+\Delta\bm{\phi}(\mathbf{i}_{&lt;n})}(y_{t}|\mathbf{%
x},\mathbf{y}_{&lt;t}),</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.6d">roman_max start_POSTSUBSCRIPT roman_Δ bold_italic_ϕ end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT ( bold_x , bold_y ) end_POSTSUBSCRIPT ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | bold_y | end_POSTSUPERSCRIPT roman_log italic_P start_POSTSUBSCRIPT bold_italic_ϕ + roman_Δ bold_italic_ϕ ( bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | bold_x , bold_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS1.p1.4">where <math alttext="\Delta\bm{\phi}(\mathbf{i}_{&lt;n})" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m1.1"><semantics id="S3.SS1.p1.2.m1.1a"><mrow id="S3.SS1.p1.2.m1.1.1" xref="S3.SS1.p1.2.m1.1.1.cmml"><mi id="S3.SS1.p1.2.m1.1.1.3" mathvariant="normal" xref="S3.SS1.p1.2.m1.1.1.3.cmml">Δ</mi><mo id="S3.SS1.p1.2.m1.1.1.2" xref="S3.SS1.p1.2.m1.1.1.2.cmml">⁢</mo><mi class="ltx_mathvariant_bold-italic" id="S3.SS1.p1.2.m1.1.1.4" mathvariant="bold-italic" xref="S3.SS1.p1.2.m1.1.1.4.cmml">ϕ</mi><mo id="S3.SS1.p1.2.m1.1.1.2a" xref="S3.SS1.p1.2.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.2.m1.1.1.1.1" xref="S3.SS1.p1.2.m1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.2.m1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.2.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.p1.2.m1.1.1.1.1.1" xref="S3.SS1.p1.2.m1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m1.1.1.1.1.1.2" xref="S3.SS1.p1.2.m1.1.1.1.1.1.2.cmml">𝐢</mi><mrow id="S3.SS1.p1.2.m1.1.1.1.1.1.3" xref="S3.SS1.p1.2.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.2.m1.1.1.1.1.1.3.2" xref="S3.SS1.p1.2.m1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.SS1.p1.2.m1.1.1.1.1.1.3.1" xref="S3.SS1.p1.2.m1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS1.p1.2.m1.1.1.1.1.1.3.3" xref="S3.SS1.p1.2.m1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS1.p1.2.m1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m1.1b"><apply id="S3.SS1.p1.2.m1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1"><times id="S3.SS1.p1.2.m1.1.1.2.cmml" xref="S3.SS1.p1.2.m1.1.1.2"></times><ci id="S3.SS1.p1.2.m1.1.1.3.cmml" xref="S3.SS1.p1.2.m1.1.1.3">Δ</ci><ci id="S3.SS1.p1.2.m1.1.1.4.cmml" xref="S3.SS1.p1.2.m1.1.1.4">bold-italic-ϕ</ci><apply id="S3.SS1.p1.2.m1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m1.1.1.1.1.1.2">𝐢</ci><apply id="S3.SS1.p1.2.m1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m1.1.1.1.1.1.3"><lt id="S3.SS1.p1.2.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.2.m1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS1.p1.2.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.2.m1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.SS1.p1.2.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.2.m1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m1.1c">\Delta\bm{\phi}(\mathbf{i}_{&lt;n})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m1.1d">roman_Δ bold_italic_ϕ ( bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT )</annotation></semantics></math> yields <math alttext="\mathbf{i}_{&lt;n}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m2.1"><semantics id="S3.SS1.p1.3.m2.1a"><msub id="S3.SS1.p1.3.m2.1.1" xref="S3.SS1.p1.3.m2.1.1.cmml"><mi id="S3.SS1.p1.3.m2.1.1.2" xref="S3.SS1.p1.3.m2.1.1.2.cmml">𝐢</mi><mrow id="S3.SS1.p1.3.m2.1.1.3" xref="S3.SS1.p1.3.m2.1.1.3.cmml"><mi id="S3.SS1.p1.3.m2.1.1.3.2" xref="S3.SS1.p1.3.m2.1.1.3.2.cmml"></mi><mo id="S3.SS1.p1.3.m2.1.1.3.1" xref="S3.SS1.p1.3.m2.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS1.p1.3.m2.1.1.3.3" xref="S3.SS1.p1.3.m2.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m2.1b"><apply id="S3.SS1.p1.3.m2.1.1.cmml" xref="S3.SS1.p1.3.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m2.1.1.1.cmml" xref="S3.SS1.p1.3.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m2.1.1.2.cmml" xref="S3.SS1.p1.3.m2.1.1.2">𝐢</ci><apply id="S3.SS1.p1.3.m2.1.1.3.cmml" xref="S3.SS1.p1.3.m2.1.1.3"><lt id="S3.SS1.p1.3.m2.1.1.3.1.cmml" xref="S3.SS1.p1.3.m2.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS1.p1.3.m2.1.1.3.2.cmml" xref="S3.SS1.p1.3.m2.1.1.3.2">absent</csymbol><ci id="S3.SS1.p1.3.m2.1.1.3.3.cmml" xref="S3.SS1.p1.3.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m2.1c">\mathbf{i}_{&lt;n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m2.1d">bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT</annotation></semantics></math>-exclusive parameters of instance-wise LoRA, as compared to the shared parameters of uniform LoRA (<em class="ltx_emph ltx_font_italic" id="S3.SS1.p1.4.1">i.e., </em><math alttext="\bm{\phi}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m3.1"><semantics id="S3.SS1.p1.4.m3.1a"><mi class="ltx_mathvariant_bold-italic" id="S3.SS1.p1.4.m3.1.1" mathvariant="bold-italic" xref="S3.SS1.p1.4.m3.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m3.1b"><ci id="S3.SS1.p1.4.m3.1.1.cmml" xref="S3.SS1.p1.4.m3.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m3.1c">\bm{\phi}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m3.1d">bold_italic_ϕ</annotation></semantics></math> in Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S2.E7" title="In 2 Preliminary ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">7</span></a>))</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">To this end, one straightforward solution is to set up different LoRA modules for individual sequences, enabling each module to act as the expert tailored to its respective sequence.
However, it is impractical in terms of resource and time requirements, particularly as the number of sequences often reaches the millions. This highlights the need for a more scalable solution to address the challenge of sequence-specific customization without excessive computational overhead.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Instance-wise LoRA with the Mixture of Experts Concept</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Instead of establishing various LoRA modules, we implement the mixture-of-experts (MoE) concept <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib30" title="">30</a>]</cite> to devise our instance-wise LoRA (iLoRA) framework.
This framework includes three components:
(1) Diverging from the standard LoRA module with up- and down-projection matrices, we divide each matrix into an array of experts, each encouraged to capture a distinct, hidden aspect of user behavior;
(2) For a given sequence instance, we use a gating network to obtain attention scores across the arrays of up- and down-projection experts, such that distinct sequences are likely to activate different experts;
(3) Such an attentive combination of up- and down-projection experts instantiates the weights of LoRA, which are individually customized for the instance of interest.
We will elaborate on these components one by one.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Splitting Low-Rank Matrices into Experts</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.2">Typically, the architectural foundation of LoRA is built upon two low-rank matrices: down-projection <math alttext="\mathbf{B}\in\mathbb{R}^{d_{\text{out}}\times r}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.1.m1.1"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mrow id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml">𝐁</mi><mo id="S3.SS2.SSS1.p1.1.m1.1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p1.1.m1.1.1.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS1.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.cmml"><msub id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.2" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.2.cmml">d</mi><mtext id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.3a.cmml">out</mtext></msub><mo id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.cmml">r</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><apply id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1"><in id="S3.SS2.SSS1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.1"></in><ci id="S3.SS2.SSS1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.2">𝐁</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3"><times id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.1"></times><apply id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.3a.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.3"><mtext id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.3.cmml" mathsize="50%" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.2.3">out</mtext></ci></apply><ci id="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1.3.3.3">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">\mathbf{B}\in\mathbb{R}^{d_{\text{out}}\times r}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.1.m1.1d">bold_B ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT out end_POSTSUBSCRIPT × italic_r end_POSTSUPERSCRIPT</annotation></semantics></math> and up-projection <math alttext="\mathbf{A}\in\mathbb{R}^{r\times d_{\text{in}}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.2.m2.1"><semantics id="S3.SS2.SSS1.p1.2.m2.1a"><mrow id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml">𝐀</mi><mo id="S3.SS2.SSS1.p1.2.m2.1.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p1.2.m2.1.1.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS1.p1.2.m2.1.1.3.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.2.cmml">r</mi><mo id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.2" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.2.cmml">d</mi><mtext id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.3" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.3a.cmml">in</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.1b"><apply id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1"><in id="S3.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.1"></in><ci id="S3.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.2">𝐀</ci><apply id="S3.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3"><times id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.1"></times><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.2">𝑟</ci><apply id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.3a.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.3"><mtext id="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.3.cmml" mathsize="50%" xref="S3.SS2.SSS1.p1.2.m2.1.1.3.3.3.3">in</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.1c">\mathbf{A}\in\mathbb{R}^{r\times d_{\text{in}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.2.m2.1d">bold_A ∈ blackboard_R start_POSTSUPERSCRIPT italic_r × italic_d start_POSTSUBSCRIPT in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math>.
Here we meticulously divide each projection matrix into an array of experts, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S2.F2" title="Figure 2 ‣ 2 Preliminary ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">2</span></a>.
Each expert is intended to focus on capturing one specific, hidden aspect of user preference.
Formally, splitting the low-rank matrices is as follows:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="A5.EGx3">
<tbody id="S3.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\mathbf{B}=[\mathbf{B}_{1},\mathbf{B}_{2},\cdots,\mathbf{B}_{K}],%
\quad\quad\mathbf{A}=[\mathbf{A}_{1},\mathbf{A}_{2},\cdots,\mathbf{A}_{K}]," class="ltx_Math" display="block" id="S3.E9.m1.3"><semantics id="S3.E9.m1.3a"><mrow id="S3.E9.m1.3.3.1"><mrow id="S3.E9.m1.3.3.1.1.2" xref="S3.E9.m1.3.3.1.1.3.cmml"><mrow id="S3.E9.m1.3.3.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.5" xref="S3.E9.m1.3.3.1.1.1.1.5.cmml">𝐁</mi><mo id="S3.E9.m1.3.3.1.1.1.1.4" xref="S3.E9.m1.3.3.1.1.1.1.4.cmml">=</mo><mrow id="S3.E9.m1.3.3.1.1.1.1.3.3" xref="S3.E9.m1.3.3.1.1.1.1.3.4.cmml"><mo id="S3.E9.m1.3.3.1.1.1.1.3.3.4" stretchy="false" xref="S3.E9.m1.3.3.1.1.1.1.3.4.cmml">[</mo><msub id="S3.E9.m1.3.3.1.1.1.1.1.1.1" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml">𝐁</mi><mn id="S3.E9.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E9.m1.3.3.1.1.1.1.3.3.5" xref="S3.E9.m1.3.3.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E9.m1.3.3.1.1.1.1.2.2.2" xref="S3.E9.m1.3.3.1.1.1.1.2.2.2.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.2.2.2.2" xref="S3.E9.m1.3.3.1.1.1.1.2.2.2.2.cmml">𝐁</mi><mn id="S3.E9.m1.3.3.1.1.1.1.2.2.2.3" xref="S3.E9.m1.3.3.1.1.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.E9.m1.3.3.1.1.1.1.3.3.6" xref="S3.E9.m1.3.3.1.1.1.1.3.4.cmml">,</mo><mi id="S3.E9.m1.1.1" mathvariant="normal" xref="S3.E9.m1.1.1.cmml">⋯</mi><mo id="S3.E9.m1.3.3.1.1.1.1.3.3.7" xref="S3.E9.m1.3.3.1.1.1.1.3.4.cmml">,</mo><msub id="S3.E9.m1.3.3.1.1.1.1.3.3.3" xref="S3.E9.m1.3.3.1.1.1.1.3.3.3.cmml"><mi id="S3.E9.m1.3.3.1.1.1.1.3.3.3.2" xref="S3.E9.m1.3.3.1.1.1.1.3.3.3.2.cmml">𝐁</mi><mi id="S3.E9.m1.3.3.1.1.1.1.3.3.3.3" xref="S3.E9.m1.3.3.1.1.1.1.3.3.3.3.cmml">K</mi></msub><mo id="S3.E9.m1.3.3.1.1.1.1.3.3.8" stretchy="false" xref="S3.E9.m1.3.3.1.1.1.1.3.4.cmml">]</mo></mrow></mrow><mo id="S3.E9.m1.3.3.1.1.2.3" rspace="2.167em" xref="S3.E9.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E9.m1.3.3.1.1.2.2" xref="S3.E9.m1.3.3.1.1.2.2.cmml"><mi id="S3.E9.m1.3.3.1.1.2.2.5" xref="S3.E9.m1.3.3.1.1.2.2.5.cmml">𝐀</mi><mo id="S3.E9.m1.3.3.1.1.2.2.4" xref="S3.E9.m1.3.3.1.1.2.2.4.cmml">=</mo><mrow id="S3.E9.m1.3.3.1.1.2.2.3.3" xref="S3.E9.m1.3.3.1.1.2.2.3.4.cmml"><mo id="S3.E9.m1.3.3.1.1.2.2.3.3.4" stretchy="false" xref="S3.E9.m1.3.3.1.1.2.2.3.4.cmml">[</mo><msub id="S3.E9.m1.3.3.1.1.2.2.1.1.1" xref="S3.E9.m1.3.3.1.1.2.2.1.1.1.cmml"><mi id="S3.E9.m1.3.3.1.1.2.2.1.1.1.2" xref="S3.E9.m1.3.3.1.1.2.2.1.1.1.2.cmml">𝐀</mi><mn id="S3.E9.m1.3.3.1.1.2.2.1.1.1.3" xref="S3.E9.m1.3.3.1.1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.E9.m1.3.3.1.1.2.2.3.3.5" xref="S3.E9.m1.3.3.1.1.2.2.3.4.cmml">,</mo><msub id="S3.E9.m1.3.3.1.1.2.2.2.2.2" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.cmml">𝐀</mi><mn id="S3.E9.m1.3.3.1.1.2.2.2.2.2.3" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E9.m1.3.3.1.1.2.2.3.3.6" xref="S3.E9.m1.3.3.1.1.2.2.3.4.cmml">,</mo><mi id="S3.E9.m1.2.2" mathvariant="normal" xref="S3.E9.m1.2.2.cmml">⋯</mi><mo id="S3.E9.m1.3.3.1.1.2.2.3.3.7" xref="S3.E9.m1.3.3.1.1.2.2.3.4.cmml">,</mo><msub id="S3.E9.m1.3.3.1.1.2.2.3.3.3" xref="S3.E9.m1.3.3.1.1.2.2.3.3.3.cmml"><mi id="S3.E9.m1.3.3.1.1.2.2.3.3.3.2" xref="S3.E9.m1.3.3.1.1.2.2.3.3.3.2.cmml">𝐀</mi><mi id="S3.E9.m1.3.3.1.1.2.2.3.3.3.3" xref="S3.E9.m1.3.3.1.1.2.2.3.3.3.3.cmml">K</mi></msub><mo id="S3.E9.m1.3.3.1.1.2.2.3.3.8" stretchy="false" xref="S3.E9.m1.3.3.1.1.2.2.3.4.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E9.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.3b"><apply id="S3.E9.m1.3.3.1.1.3.cmml" xref="S3.E9.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.3a.cmml" xref="S3.E9.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E9.m1.3.3.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1"><eq id="S3.E9.m1.3.3.1.1.1.1.4.cmml" xref="S3.E9.m1.3.3.1.1.1.1.4"></eq><ci id="S3.E9.m1.3.3.1.1.1.1.5.cmml" xref="S3.E9.m1.3.3.1.1.1.1.5">𝐁</ci><list id="S3.E9.m1.3.3.1.1.1.1.3.4.cmml" xref="S3.E9.m1.3.3.1.1.1.1.3.3"><apply id="S3.E9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.2">𝐁</ci><cn id="S3.E9.m1.3.3.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E9.m1.3.3.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E9.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.2.2.2.2">𝐁</ci><cn id="S3.E9.m1.3.3.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E9.m1.3.3.1.1.1.1.2.2.2.3">2</cn></apply><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">⋯</ci><apply id="S3.E9.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.1.1.3.3.3.1.cmml" xref="S3.E9.m1.3.3.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.1.1.3.3.3.2.cmml" xref="S3.E9.m1.3.3.1.1.1.1.3.3.3.2">𝐁</ci><ci id="S3.E9.m1.3.3.1.1.1.1.3.3.3.3.cmml" xref="S3.E9.m1.3.3.1.1.1.1.3.3.3.3">𝐾</ci></apply></list></apply><apply id="S3.E9.m1.3.3.1.1.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2"><eq id="S3.E9.m1.3.3.1.1.2.2.4.cmml" xref="S3.E9.m1.3.3.1.1.2.2.4"></eq><ci id="S3.E9.m1.3.3.1.1.2.2.5.cmml" xref="S3.E9.m1.3.3.1.1.2.2.5">𝐀</ci><list id="S3.E9.m1.3.3.1.1.2.2.3.4.cmml" xref="S3.E9.m1.3.3.1.1.2.2.3.3"><apply id="S3.E9.m1.3.3.1.1.2.2.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.2.2.1.1.1.1.cmml" xref="S3.E9.m1.3.3.1.1.2.2.1.1.1">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.2.2.1.1.1.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2.1.1.1.2">𝐀</ci><cn id="S3.E9.m1.3.3.1.1.2.2.1.1.1.3.cmml" type="integer" xref="S3.E9.m1.3.3.1.1.2.2.1.1.1.3">1</cn></apply><apply id="S3.E9.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.2">𝐀</ci><cn id="S3.E9.m1.3.3.1.1.2.2.2.2.2.3.cmml" type="integer" xref="S3.E9.m1.3.3.1.1.2.2.2.2.2.3">2</cn></apply><ci id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">⋯</ci><apply id="S3.E9.m1.3.3.1.1.2.2.3.3.3.cmml" xref="S3.E9.m1.3.3.1.1.2.2.3.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.1.1.2.2.3.3.3.1.cmml" xref="S3.E9.m1.3.3.1.1.2.2.3.3.3">subscript</csymbol><ci id="S3.E9.m1.3.3.1.1.2.2.3.3.3.2.cmml" xref="S3.E9.m1.3.3.1.1.2.2.3.3.3.2">𝐀</ci><ci id="S3.E9.m1.3.3.1.1.2.2.3.3.3.3.cmml" xref="S3.E9.m1.3.3.1.1.2.2.3.3.3.3">𝐾</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.3c">\displaystyle\mathbf{B}=[\mathbf{B}_{1},\mathbf{B}_{2},\cdots,\mathbf{B}_{K}],%
\quad\quad\mathbf{A}=[\mathbf{A}_{1},\mathbf{A}_{2},\cdots,\mathbf{A}_{K}],</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.3d">bold_B = [ bold_B start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_B start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , bold_B start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ] , bold_A = [ bold_A start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_A start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , bold_A start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p1.8">where <math alttext="\mathbf{B}_{k}\in\mathbb{R}^{d_{\text{out}}\times r^{*}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.3.m1.1"><semantics id="S3.SS2.SSS1.p1.3.m1.1a"><mrow id="S3.SS2.SSS1.p1.3.m1.1.1" xref="S3.SS2.SSS1.p1.3.m1.1.1.cmml"><msub id="S3.SS2.SSS1.p1.3.m1.1.1.2" xref="S3.SS2.SSS1.p1.3.m1.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.3.m1.1.1.2.2" xref="S3.SS2.SSS1.p1.3.m1.1.1.2.2.cmml">𝐁</mi><mi id="S3.SS2.SSS1.p1.3.m1.1.1.2.3" xref="S3.SS2.SSS1.p1.3.m1.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS2.SSS1.p1.3.m1.1.1.1" xref="S3.SS2.SSS1.p1.3.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p1.3.m1.1.1.3" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.3.m1.1.1.3.2" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS1.p1.3.m1.1.1.3.3" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.cmml"><msub id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.2" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.2.cmml">d</mi><mtext id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.3" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.3a.cmml">out</mtext></msub><mo id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.1.cmml">×</mo><msup id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.2" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.2.cmml">r</mi><mo id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.3" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.3.cmml">∗</mo></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m1.1b"><apply id="S3.SS2.SSS1.p1.3.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1"><in id="S3.SS2.SSS1.p1.3.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.1"></in><apply id="S3.SS2.SSS1.p1.3.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.2.2">𝐁</ci><ci id="S3.SS2.SSS1.p1.3.m1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.SSS1.p1.3.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3"><times id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.1"></times><apply id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.2">𝑑</ci><ci id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.3a.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.3"><mtext id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.3.cmml" mathsize="50%" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.2.3">out</mtext></ci></apply><apply id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.2">𝑟</ci><times id="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.3.cmml" xref="S3.SS2.SSS1.p1.3.m1.1.1.3.3.3.3"></times></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m1.1c">\mathbf{B}_{k}\in\mathbb{R}^{d_{\text{out}}\times r^{*}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.3.m1.1d">bold_B start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d start_POSTSUBSCRIPT out end_POSTSUBSCRIPT × italic_r start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{A}_{k}\in\mathbb{R}^{r^{*}\times d_{\text{in}}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.4.m2.1"><semantics id="S3.SS2.SSS1.p1.4.m2.1a"><mrow id="S3.SS2.SSS1.p1.4.m2.1.1" xref="S3.SS2.SSS1.p1.4.m2.1.1.cmml"><msub id="S3.SS2.SSS1.p1.4.m2.1.1.2" xref="S3.SS2.SSS1.p1.4.m2.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.4.m2.1.1.2.2" xref="S3.SS2.SSS1.p1.4.m2.1.1.2.2.cmml">𝐀</mi><mi id="S3.SS2.SSS1.p1.4.m2.1.1.2.3" xref="S3.SS2.SSS1.p1.4.m2.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS2.SSS1.p1.4.m2.1.1.1" xref="S3.SS2.SSS1.p1.4.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS1.p1.4.m2.1.1.3" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.4.m2.1.1.3.2" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS1.p1.4.m2.1.1.3.3" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.cmml"><msup id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.cmml"><mi id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.2" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.2.cmml">r</mi><mo id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.3" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.3.cmml">∗</mo></msup><mo id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.1.cmml">×</mo><msub id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.2" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.2.cmml">d</mi><mtext id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.3" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.3a.cmml">in</mtext></msub></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m2.1b"><apply id="S3.SS2.SSS1.p1.4.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1"><in id="S3.SS2.SSS1.p1.4.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.1"></in><apply id="S3.SS2.SSS1.p1.4.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.4.m2.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.4.m2.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.2.2">𝐀</ci><ci id="S3.SS2.SSS1.p1.4.m2.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.SSS1.p1.4.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.4.m2.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS1.p1.4.m2.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3"><times id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.1"></times><apply id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.1.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2">superscript</csymbol><ci id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.2.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.2">𝑟</ci><times id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.3.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.2.3"></times></apply><apply id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.2">𝑑</ci><ci id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.3a.cmml" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.3"><mtext id="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.3.cmml" mathsize="50%" xref="S3.SS2.SSS1.p1.4.m2.1.1.3.3.3.3">in</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m2.1c">\mathbf{A}_{k}\in\mathbb{R}^{r^{*}\times d_{\text{in}}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.4.m2.1d">bold_A start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_r start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT × italic_d start_POSTSUBSCRIPT in end_POSTSUBSCRIPT end_POSTSUPERSCRIPT</annotation></semantics></math> are the up- and down-projection pairs for the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.5.m3.1"><semantics id="S3.SS2.SSS1.p1.5.m3.1a"><mi id="S3.SS2.SSS1.p1.5.m3.1.1" xref="S3.SS2.SSS1.p1.5.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m3.1b"><ci id="S3.SS2.SSS1.p1.5.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.5.m3.1d">italic_k</annotation></semantics></math>-th expert, respectively; <math alttext="r^{*}=\frac{r}{K}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.6.m4.1"><semantics id="S3.SS2.SSS1.p1.6.m4.1a"><mrow id="S3.SS2.SSS1.p1.6.m4.1.1" xref="S3.SS2.SSS1.p1.6.m4.1.1.cmml"><msup id="S3.SS2.SSS1.p1.6.m4.1.1.2" xref="S3.SS2.SSS1.p1.6.m4.1.1.2.cmml"><mi id="S3.SS2.SSS1.p1.6.m4.1.1.2.2" xref="S3.SS2.SSS1.p1.6.m4.1.1.2.2.cmml">r</mi><mo id="S3.SS2.SSS1.p1.6.m4.1.1.2.3" xref="S3.SS2.SSS1.p1.6.m4.1.1.2.3.cmml">∗</mo></msup><mo id="S3.SS2.SSS1.p1.6.m4.1.1.1" xref="S3.SS2.SSS1.p1.6.m4.1.1.1.cmml">=</mo><mfrac id="S3.SS2.SSS1.p1.6.m4.1.1.3" xref="S3.SS2.SSS1.p1.6.m4.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.6.m4.1.1.3.2" xref="S3.SS2.SSS1.p1.6.m4.1.1.3.2.cmml">r</mi><mi id="S3.SS2.SSS1.p1.6.m4.1.1.3.3" xref="S3.SS2.SSS1.p1.6.m4.1.1.3.3.cmml">K</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m4.1b"><apply id="S3.SS2.SSS1.p1.6.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m4.1.1"><eq id="S3.SS2.SSS1.p1.6.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m4.1.1.1"></eq><apply id="S3.SS2.SSS1.p1.6.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p1.6.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.6.m4.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.6.m4.1.1.2">superscript</csymbol><ci id="S3.SS2.SSS1.p1.6.m4.1.1.2.2.cmml" xref="S3.SS2.SSS1.p1.6.m4.1.1.2.2">𝑟</ci><times id="S3.SS2.SSS1.p1.6.m4.1.1.2.3.cmml" xref="S3.SS2.SSS1.p1.6.m4.1.1.2.3"></times></apply><apply id="S3.SS2.SSS1.p1.6.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p1.6.m4.1.1.3"><divide id="S3.SS2.SSS1.p1.6.m4.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.6.m4.1.1.3"></divide><ci id="S3.SS2.SSS1.p1.6.m4.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.6.m4.1.1.3.2">𝑟</ci><ci id="S3.SS2.SSS1.p1.6.m4.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.6.m4.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m4.1c">r^{*}=\frac{r}{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.6.m4.1d">italic_r start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = divide start_ARG italic_r end_ARG start_ARG italic_K end_ARG</annotation></semantics></math> is the partial rank determined by the total rank <math alttext="r" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.7.m5.1"><semantics id="S3.SS2.SSS1.p1.7.m5.1a"><mi id="S3.SS2.SSS1.p1.7.m5.1.1" xref="S3.SS2.SSS1.p1.7.m5.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.7.m5.1b"><ci id="S3.SS2.SSS1.p1.7.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m5.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.7.m5.1c">r</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.7.m5.1d">italic_r</annotation></semantics></math> of LoRA and a predefined number of experts <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p1.8.m6.1"><semantics id="S3.SS2.SSS1.p1.8.m6.1a"><mi id="S3.SS2.SSS1.p1.8.m6.1.1" xref="S3.SS2.SSS1.p1.8.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.8.m6.1b"><ci id="S3.SS2.SSS1.p1.8.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.8.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p1.8.m6.1d">italic_K</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">By dividing individual LoRA modules into specialized experts, we ensure a more granular and precise adaptation to user preferences. This segmentation approach allows each expert to focus on specific aspects of user interaction patterns, thereby mitigating the risk of negative transfer that arises from generalized adaptations.
We should emphasize that such a segmentation scheme preserves the overall number of parameters equivalent to that of the standard LoRA, therefore preventing the potential overfitting issue.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Generating Instance-wise Attentions over Experts</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.3">Having obtained the experts (<em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.p1.3.1">i.e., </em>up-projection submatrices <math alttext="\{\mathbf{B}_{k}\}_{k=1}^{K}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><msubsup id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mrow id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.2.cmml">𝐁</mi><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS2.p1.1.m1.1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.3.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.3.2.cmml">k</mi><mo id="S3.SS2.SSS2.p1.1.m1.1.1.1.3.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS2.p1.1.m1.1.1.1.3.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><set id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.2">𝐁</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS2.SSS2.p1.1.m1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.3"><eq id="S3.SS2.SSS2.p1.1.m1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.3.1"></eq><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.3.2">𝑘</ci><cn id="S3.SS2.SSS2.p1.1.m1.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">\{\mathbf{B}_{k}\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">{ bold_B start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>, down-projection submatrices <math alttext="\{\mathbf{A}_{k}\}_{k=1}^{K}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><msubsup id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml"><mrow id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.cmml">𝐀</mi><mi id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS2.p1.2.m2.1.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.1.3.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.3.2.cmml">k</mi><mo id="S3.SS2.SSS2.p1.2.m2.1.1.1.3.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS2.p1.2.m2.1.1.1.3.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml">K</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><set id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1"><apply id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.2">𝐀</ci><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S3.SS2.SSS2.p1.2.m2.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.3"><eq id="S3.SS2.SSS2.p1.2.m2.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.3.1"></eq><ci id="S3.SS2.SSS2.p1.2.m2.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.3.2">𝑘</ci><cn id="S3.SS2.SSS2.p1.2.m2.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">\{\mathbf{A}_{k}\}_{k=1}^{K}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">{ bold_A start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT</annotation></semantics></math>), we construct an instance-guided gating function to yield the contribution of each expert tailored to a specific sequence.
Specifically, for a sequence of historical items <math alttext="\mathbf{i}_{&lt;n}=[i_{1},i_{2},\cdots,i_{n-1}]" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.4"><semantics id="S3.SS2.SSS2.p1.3.m3.4a"><mrow id="S3.SS2.SSS2.p1.3.m3.4.4" xref="S3.SS2.SSS2.p1.3.m3.4.4.cmml"><msub id="S3.SS2.SSS2.p1.3.m3.4.4.5" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.4.4.5.2" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.2.cmml">𝐢</mi><mrow id="S3.SS2.SSS2.p1.3.m3.4.4.5.3" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.3.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.4.4.5.3.2" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.3.2.cmml"></mi><mo id="S3.SS2.SSS2.p1.3.m3.4.4.5.3.1" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.3.1.cmml">&lt;</mo><mi id="S3.SS2.SSS2.p1.3.m3.4.4.5.3.3" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS2.SSS2.p1.3.m3.4.4.4" xref="S3.SS2.SSS2.p1.3.m3.4.4.4.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.3.m3.4.4.3.3" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.4.cmml"><mo id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.4" stretchy="false" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.4.cmml">[</mo><msub id="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.2.cmml">i</mi><mn id="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.5" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2" xref="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.2" xref="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.2.cmml">i</mi><mn id="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.3" xref="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.6" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.4.cmml">,</mo><mi id="S3.SS2.SSS2.p1.3.m3.1.1" mathvariant="normal" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml">⋯</mi><mo id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.7" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.4.cmml">,</mo><msub id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.2" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.2.cmml">i</mi><mrow id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.2" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.2.cmml">n</mi><mo id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.1" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.1.cmml">−</mo><mn id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.3" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.8" stretchy="false" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.4b"><apply id="S3.SS2.SSS2.p1.3.m3.4.4.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4"><eq id="S3.SS2.SSS2.p1.3.m3.4.4.4.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.4"></eq><apply id="S3.SS2.SSS2.p1.3.m3.4.4.5.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.4.4.5.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.5">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.4.4.5.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.2">𝐢</ci><apply id="S3.SS2.SSS2.p1.3.m3.4.4.5.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.3"><lt id="S3.SS2.SSS2.p1.3.m3.4.4.5.3.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.p1.3.m3.4.4.5.3.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.3.2">absent</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.4.4.5.3.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.5.3.3">𝑛</ci></apply></apply><list id="S3.SS2.SSS2.p1.3.m3.4.4.3.4.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3"><apply id="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.2">𝑖</ci><cn id="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.3.m3.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.2">𝑖</ci><cn id="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.3.m3.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1">⋯</ci><apply id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.2">𝑖</ci><apply id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3"><minus id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.1"></minus><ci id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.2">𝑛</ci><cn id="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.3.m3.4.4.3.3.3.3.3">1</cn></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.4c">\mathbf{i}_{&lt;n}=[i_{1},i_{2},\cdots,i_{n-1}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.4d">bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT = [ italic_i start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_i start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , ⋯ , italic_i start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT ]</annotation></semantics></math>, we utilize a sequential recommender (<em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS2.p1.3.2">e.g., </em>SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib3" title="">3</a>]</cite>) to extract its representation as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{z}=\text{SR-EMB}_{\bm{\theta}}(\mathbf{i}_{&lt;n})." class="ltx_Math" display="block" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml">𝐳</mi><mo id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml"><msub id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.3.cmml"><mtext id="S3.E10.m1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.3.2a.cmml">SR-EMB</mtext><mi id="S3.E10.m1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.3.3.cmml">𝜽</mi></msub><mo id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml">𝐢</mi><mrow id="S3.E10.m1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E10.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.E10.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m1.1.1.1.2" lspace="0em" xref="S3.E10.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"></eq><ci id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3">𝐳</ci><apply id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.2"></times><apply id="S3.E10.m1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.3.2a.cmml" xref="S3.E10.m1.1.1.1.1.1.3.2"><mtext id="S3.E10.m1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.3.2">SR-EMB</mtext></ci><ci id="S3.E10.m1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3.3">𝜽</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2">𝐢</ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3"><lt id="S3.E10.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E10.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\mathbf{z}=\text{SR-EMB}_{\bm{\theta}}(\mathbf{i}_{&lt;n}).</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">bold_z = SR-EMB start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ( bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p1.4">Here <math alttext="\mathbf{z}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.4.m1.1"><semantics id="S3.SS2.SSS2.p1.4.m1.1a"><mrow id="S3.SS2.SSS2.p1.4.m1.1.1" xref="S3.SS2.SSS2.p1.4.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.4.m1.1.1.2" xref="S3.SS2.SSS2.p1.4.m1.1.1.2.cmml">𝐳</mi><mo id="S3.SS2.SSS2.p1.4.m1.1.1.1" xref="S3.SS2.SSS2.p1.4.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS2.p1.4.m1.1.1.3" xref="S3.SS2.SSS2.p1.4.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.4.m1.1.1.3.2" xref="S3.SS2.SSS2.p1.4.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.SSS2.p1.4.m1.1.1.3.3" xref="S3.SS2.SSS2.p1.4.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m1.1b"><apply id="S3.SS2.SSS2.p1.4.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m1.1.1"><in id="S3.SS2.SSS2.p1.4.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m1.1.1.1"></in><ci id="S3.SS2.SSS2.p1.4.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.4.m1.1.1.2">𝐳</ci><apply id="S3.SS2.SSS2.p1.4.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.4.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.4.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p1.4.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.4.m1.1.1.3.2">ℝ</ci><ci id="S3.SS2.SSS2.p1.4.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p1.4.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m1.1c">\mathbf{z}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m1.1d">bold_z ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> provides a holistic view of the user’s behavioral patterns and preferences.
Subsequently, to ascertain the influence of each expert on distilling behavior patterns from this sequence, we get the contribution scores via a linear transformation with a softmax function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{\omega}=\text{Softmax}(\text{Proj}_{\bm{\tau}_{2}}(\mathbf{z}))," class="ltx_Math" display="block" id="S3.E11.m1.2"><semantics id="S3.E11.m1.2a"><mrow id="S3.E11.m1.2.2.1" xref="S3.E11.m1.2.2.1.1.cmml"><mrow id="S3.E11.m1.2.2.1.1" xref="S3.E11.m1.2.2.1.1.cmml"><mi id="S3.E11.m1.2.2.1.1.3" xref="S3.E11.m1.2.2.1.1.3.cmml">ω</mi><mo id="S3.E11.m1.2.2.1.1.2" xref="S3.E11.m1.2.2.1.1.2.cmml">=</mo><mrow id="S3.E11.m1.2.2.1.1.1" xref="S3.E11.m1.2.2.1.1.1.cmml"><mtext id="S3.E11.m1.2.2.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.3a.cmml">Softmax</mtext><mo id="S3.E11.m1.2.2.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E11.m1.2.2.1.1.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.cmml"><mtext id="S3.E11.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.2a.cmml">Proj</mtext><msub id="S3.E11.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">𝝉</mi><mn id="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.3" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">2</mn></msub></msub><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.E11.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">𝐳</mi><mo id="S3.E11.m1.2.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E11.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E11.m1.2.2.1.2" xref="S3.E11.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.2.1.1.cmml" xref="S3.E11.m1.2.2.1"><eq id="S3.E11.m1.2.2.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.2"></eq><ci id="S3.E11.m1.2.2.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.3">𝜔</ci><apply id="S3.E11.m1.2.2.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1"><times id="S3.E11.m1.2.2.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.2"></times><ci id="S3.E11.m1.2.2.1.1.1.3a.cmml" xref="S3.E11.m1.2.2.1.1.1.3"><mtext id="S3.E11.m1.2.2.1.1.1.3.cmml" xref="S3.E11.m1.2.2.1.1.1.3">Softmax</mtext></ci><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1"><times id="S3.E11.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.1"></times><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.2.2a.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.2"><mtext id="S3.E11.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.2">Proj</mtext></ci><apply id="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.2">𝝉</ci><cn id="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="S3.E11.m1.2.2.1.1.1.1.1.1.2.3.3">2</cn></apply></apply><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝐳</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\mathbf{\omega}=\text{Softmax}(\text{Proj}_{\bm{\tau}_{2}}(\mathbf{z})),</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.2d">italic_ω = Softmax ( Proj start_POSTSUBSCRIPT bold_italic_τ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_z ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p1.9">where <math alttext="\text{Proj}_{\bm{\tau}_{2}}(\mathbf{z})=\mathbf{W}_{g}\mathbf{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.5.m1.1"><semantics id="S3.SS2.SSS2.p1.5.m1.1a"><mrow id="S3.SS2.SSS2.p1.5.m1.1.2" xref="S3.SS2.SSS2.p1.5.m1.1.2.cmml"><mrow id="S3.SS2.SSS2.p1.5.m1.1.2.2" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.cmml"><msub id="S3.SS2.SSS2.p1.5.m1.1.2.2.2" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.cmml"><mtext id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.2" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.2a.cmml">Proj</mtext><msub id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.2" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.2.cmml">𝝉</mi><mn id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.3" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.3.cmml">2</mn></msub></msub><mo id="S3.SS2.SSS2.p1.5.m1.1.2.2.1" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.5.m1.1.2.2.3.2" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.cmml"><mo id="S3.SS2.SSS2.p1.5.m1.1.2.2.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.cmml">(</mo><mi id="S3.SS2.SSS2.p1.5.m1.1.1" xref="S3.SS2.SSS2.p1.5.m1.1.1.cmml">𝐳</mi><mo id="S3.SS2.SSS2.p1.5.m1.1.2.2.3.2.2" stretchy="false" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p1.5.m1.1.2.1" xref="S3.SS2.SSS2.p1.5.m1.1.2.1.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.5.m1.1.2.3" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.cmml"><msub id="S3.SS2.SSS2.p1.5.m1.1.2.3.2" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.2.cmml"><mi id="S3.SS2.SSS2.p1.5.m1.1.2.3.2.2" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS2.p1.5.m1.1.2.3.2.3" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.2.3.cmml">g</mi></msub><mo id="S3.SS2.SSS2.p1.5.m1.1.2.3.1" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS2.p1.5.m1.1.2.3.3" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.3.cmml">𝐳</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.5.m1.1b"><apply id="S3.SS2.SSS2.p1.5.m1.1.2.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2"><eq id="S3.SS2.SSS2.p1.5.m1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.1"></eq><apply id="S3.SS2.SSS2.p1.5.m1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.2"><times id="S3.SS2.SSS2.p1.5.m1.1.2.2.1.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.1"></times><apply id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.2a.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.2"><mtext id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.2">Proj</mtext></ci><apply id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.1.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.2.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.2">𝝉</ci><cn id="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.5.m1.1.2.2.2.3.3">2</cn></apply></apply><ci id="S3.SS2.SSS2.p1.5.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.1">𝐳</ci></apply><apply id="S3.SS2.SSS2.p1.5.m1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.3"><times id="S3.SS2.SSS2.p1.5.m1.1.2.3.1.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.1"></times><apply id="S3.SS2.SSS2.p1.5.m1.1.2.3.2.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.5.m1.1.2.3.2.1.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.5.m1.1.2.3.2.2.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.2.2">𝐖</ci><ci id="S3.SS2.SSS2.p1.5.m1.1.2.3.2.3.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.2.3">𝑔</ci></apply><ci id="S3.SS2.SSS2.p1.5.m1.1.2.3.3.cmml" xref="S3.SS2.SSS2.p1.5.m1.1.2.3.3">𝐳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.5.m1.1c">\text{Proj}_{\bm{\tau}_{2}}(\mathbf{z})=\mathbf{W}_{g}\mathbf{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.5.m1.1d">Proj start_POSTSUBSCRIPT bold_italic_τ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( bold_z ) = bold_W start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT bold_z</annotation></semantics></math> with the trainable transformation matrix <math alttext="\mathbf{W}_{g}\in\mathbb{R}^{K\times d}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.6.m2.1"><semantics id="S3.SS2.SSS2.p1.6.m2.1a"><mrow id="S3.SS2.SSS2.p1.6.m2.1.1" xref="S3.SS2.SSS2.p1.6.m2.1.1.cmml"><msub id="S3.SS2.SSS2.p1.6.m2.1.1.2" xref="S3.SS2.SSS2.p1.6.m2.1.1.2.cmml"><mi id="S3.SS2.SSS2.p1.6.m2.1.1.2.2" xref="S3.SS2.SSS2.p1.6.m2.1.1.2.2.cmml">𝐖</mi><mi id="S3.SS2.SSS2.p1.6.m2.1.1.2.3" xref="S3.SS2.SSS2.p1.6.m2.1.1.2.3.cmml">g</mi></msub><mo id="S3.SS2.SSS2.p1.6.m2.1.1.1" xref="S3.SS2.SSS2.p1.6.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.SSS2.p1.6.m2.1.1.3" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.6.m2.1.1.3.2" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.SSS2.p1.6.m2.1.1.3.3" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.3.cmml"><mi id="S3.SS2.SSS2.p1.6.m2.1.1.3.3.2" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.3.2.cmml">K</mi><mo id="S3.SS2.SSS2.p1.6.m2.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.SSS2.p1.6.m2.1.1.3.3.3" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.6.m2.1b"><apply id="S3.SS2.SSS2.p1.6.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1"><in id="S3.SS2.SSS2.p1.6.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.1"></in><apply id="S3.SS2.SSS2.p1.6.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.6.m2.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.6.m2.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.2.2">𝐖</ci><ci id="S3.SS2.SSS2.p1.6.m2.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.2.3">𝑔</ci></apply><apply id="S3.SS2.SSS2.p1.6.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.6.m2.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p1.6.m2.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.2">ℝ</ci><apply id="S3.SS2.SSS2.p1.6.m2.1.1.3.3.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.3"><times id="S3.SS2.SSS2.p1.6.m2.1.1.3.3.1.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.3.1"></times><ci id="S3.SS2.SSS2.p1.6.m2.1.1.3.3.2.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.3.2">𝐾</ci><ci id="S3.SS2.SSS2.p1.6.m2.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.p1.6.m2.1.1.3.3.3">𝑑</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.6.m2.1c">\mathbf{W}_{g}\in\mathbb{R}^{K\times d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.6.m2.1d">bold_W start_POSTSUBSCRIPT italic_g end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_K × italic_d end_POSTSUPERSCRIPT</annotation></semantics></math>, and the softmax function ensures these contributions normalized as the attention scores, thereby preventing any single expert from disproportionately influencing the recommendation; <math alttext="\mathbf{\omega}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.7.m3.1"><semantics id="S3.SS2.SSS2.p1.7.m3.1a"><mi id="S3.SS2.SSS2.p1.7.m3.1.1" xref="S3.SS2.SSS2.p1.7.m3.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.7.m3.1b"><ci id="S3.SS2.SSS2.p1.7.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.7.m3.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.7.m3.1c">\mathbf{\omega}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.7.m3.1d">italic_ω</annotation></semantics></math> represents the attention scores over all the experts, with the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.8.m4.1"><semantics id="S3.SS2.SSS2.p1.8.m4.1a"><mi id="S3.SS2.SSS2.p1.8.m4.1.1" xref="S3.SS2.SSS2.p1.8.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.8.m4.1b"><ci id="S3.SS2.SSS2.p1.8.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.8.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.8.m4.1d">italic_k</annotation></semantics></math>-th element indicating the contribution of expert <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.9.m5.1"><semantics id="S3.SS2.SSS2.p1.9.m5.1a"><mi id="S3.SS2.SSS2.p1.9.m5.1.1" xref="S3.SS2.SSS2.p1.9.m5.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.9.m5.1b"><ci id="S3.SS2.SSS2.p1.9.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.9.m5.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.9.m5.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.9.m5.1d">italic_K</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.1">By using the sequence representation as the guidance signal, we can get the instance-wise attention scores over experts and encourage each expert’s contribution closely aligned with the individual variability inherent in the sequence.
Moreover, distinct sequences tend to yield different attention scores and activate different experts, while similar sequences incline toward analogous attention scores.
By dynamically adapting to a wide range of user behaviors and preferences, these experts could specialize in diverse aspects of user behaviors and be more adept at handling diverse user needs.
</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3 </span>Aggregating Mixture of Experts as Instance-wise LoRA</h4>
<div class="ltx_para" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.2">For the instance <math alttext="\mathbf{i}_{&lt;n}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.1.m1.1"><semantics id="S3.SS2.SSS3.p1.1.m1.1a"><msub id="S3.SS2.SSS3.p1.1.m1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.1.1.2" xref="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml">𝐢</mi><mrow id="S3.SS2.SSS3.p1.1.m1.1.1.3" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.1.1.3.2" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.2.cmml"></mi><mo id="S3.SS2.SSS3.p1.1.m1.1.1.3.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS2.SSS3.p1.1.m1.1.1.3.3" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.3.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.1b"><apply id="S3.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.2">𝐢</ci><apply id="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3"><lt id="S3.SS2.SSS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.2">absent</csymbol><ci id="S3.SS2.SSS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.1c">\mathbf{i}_{&lt;n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.1.m1.1d">bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT</annotation></semantics></math> associated with the instance-wise attentions <math alttext="\mathbf{\omega}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.2.m2.1"><semantics id="S3.SS2.SSS3.p1.2.m2.1a"><mi id="S3.SS2.SSS3.p1.2.m2.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.2.m2.1b"><ci id="S3.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.2.m2.1c">\mathbf{\omega}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.2.m2.1d">italic_ω</annotation></semantics></math>, we use the mixture-of-experts concept to aggregate the up- and down-projection submatrices from different experts, so as to establish the instance-wise LoRA parameters:</p>
<table class="ltx_equationgroup ltx_eqn_gather ltx_eqn_table" id="A5.EGx4">
<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\displaystyle\Delta\mathbf{W}(\mathbf{i}_{&lt;n})=\sum_{k=1}^{K}\omega_{k}\mathbf%
{B}_{k}\mathbf{A}_{k}," class="ltx_Math" display="block" id="S3.E12.m1.1"><semantics id="S3.E12.m1.1a"><mrow id="S3.E12.m1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml"><mrow id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml"><mrow id="S3.E12.m1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.1.3" mathvariant="normal" xref="S3.E12.m1.1.1.1.1.1.3.cmml">Δ</mi><mo id="S3.E12.m1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.2.cmml">⁢</mo><mi id="S3.E12.m1.1.1.1.1.1.4" xref="S3.E12.m1.1.1.1.1.1.4.cmml">𝐖</mi><mo id="S3.E12.m1.1.1.1.1.1.2a" xref="S3.E12.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E12.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E12.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E12.m1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.2.cmml">𝐢</mi><mrow id="S3.E12.m1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.E12.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.E12.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E12.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.1.1.1.1.2" rspace="0.111em" xref="S3.E12.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.3.cmml"><munderover id="S3.E12.m1.1.1.1.1.3.1" xref="S3.E12.m1.1.1.1.1.3.1.cmml"><mo id="S3.E12.m1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.E12.m1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E12.m1.1.1.1.1.3.1.2.3" xref="S3.E12.m1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.3.1.2.3.2" xref="S3.E12.m1.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E12.m1.1.1.1.1.3.1.2.3.1" xref="S3.E12.m1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E12.m1.1.1.1.1.3.1.2.3.3" xref="S3.E12.m1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E12.m1.1.1.1.1.3.1.3" xref="S3.E12.m1.1.1.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S3.E12.m1.1.1.1.1.3.2" xref="S3.E12.m1.1.1.1.1.3.2.cmml"><msub id="S3.E12.m1.1.1.1.1.3.2.2" xref="S3.E12.m1.1.1.1.1.3.2.2.cmml"><mi id="S3.E12.m1.1.1.1.1.3.2.2.2" xref="S3.E12.m1.1.1.1.1.3.2.2.2.cmml">ω</mi><mi id="S3.E12.m1.1.1.1.1.3.2.2.3" xref="S3.E12.m1.1.1.1.1.3.2.2.3.cmml">k</mi></msub><mo id="S3.E12.m1.1.1.1.1.3.2.1" xref="S3.E12.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E12.m1.1.1.1.1.3.2.3" xref="S3.E12.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E12.m1.1.1.1.1.3.2.3.2" xref="S3.E12.m1.1.1.1.1.3.2.3.2.cmml">𝐁</mi><mi id="S3.E12.m1.1.1.1.1.3.2.3.3" xref="S3.E12.m1.1.1.1.1.3.2.3.3.cmml">k</mi></msub><mo id="S3.E12.m1.1.1.1.1.3.2.1a" xref="S3.E12.m1.1.1.1.1.3.2.1.cmml">⁢</mo><msub id="S3.E12.m1.1.1.1.1.3.2.4" xref="S3.E12.m1.1.1.1.1.3.2.4.cmml"><mi id="S3.E12.m1.1.1.1.1.3.2.4.2" xref="S3.E12.m1.1.1.1.1.3.2.4.2.cmml">𝐀</mi><mi id="S3.E12.m1.1.1.1.1.3.2.4.3" xref="S3.E12.m1.1.1.1.1.3.2.4.3.cmml">k</mi></msub></mrow></mrow></mrow><mo id="S3.E12.m1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1"><eq id="S3.E12.m1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.2"></eq><apply id="S3.E12.m1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1"><times id="S3.E12.m1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.2"></times><ci id="S3.E12.m1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.3">Δ</ci><ci id="S3.E12.m1.1.1.1.1.1.4.cmml" xref="S3.E12.m1.1.1.1.1.1.4">𝐖</ci><apply id="S3.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.2">𝐢</ci><apply id="S3.E12.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.3"><lt id="S3.E12.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.E12.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply><apply id="S3.E12.m1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.3"><apply id="S3.E12.m1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.3.1.1.cmml" xref="S3.E12.m1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.3.1.2.cmml" xref="S3.E12.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.3.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E12.m1.1.1.1.1.3.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E12.m1.1.1.1.1.3.1.2.3.cmml" xref="S3.E12.m1.1.1.1.1.3.1.2.3"><eq id="S3.E12.m1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E12.m1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.3.1.2.3.2">𝑘</ci><cn id="S3.E12.m1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E12.m1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.1.1.1.1.3.1.3.cmml" xref="S3.E12.m1.1.1.1.1.3.1.3">𝐾</ci></apply><apply id="S3.E12.m1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.1.1.1.1.3.2"><times id="S3.E12.m1.1.1.1.1.3.2.1.cmml" xref="S3.E12.m1.1.1.1.1.3.2.1"></times><apply id="S3.E12.m1.1.1.1.1.3.2.2.cmml" xref="S3.E12.m1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E12.m1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E12.m1.1.1.1.1.3.2.2.2">𝜔</ci><ci id="S3.E12.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E12.m1.1.1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S3.E12.m1.1.1.1.1.3.2.3.cmml" xref="S3.E12.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E12.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E12.m1.1.1.1.1.3.2.3.2">𝐁</ci><ci id="S3.E12.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E12.m1.1.1.1.1.3.2.3.3">𝑘</ci></apply><apply id="S3.E12.m1.1.1.1.1.3.2.4.cmml" xref="S3.E12.m1.1.1.1.1.3.2.4"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.3.2.4.1.cmml" xref="S3.E12.m1.1.1.1.1.3.2.4">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.3.2.4.2.cmml" xref="S3.E12.m1.1.1.1.1.3.2.4.2">𝐀</ci><ci id="S3.E12.m1.1.1.1.1.3.2.4.3.cmml" xref="S3.E12.m1.1.1.1.1.3.2.4.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\displaystyle\Delta\mathbf{W}(\mathbf{i}_{&lt;n})=\sum_{k=1}^{K}\omega_{k}\mathbf%
{B}_{k}\mathbf{A}_{k},</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.1d">roman_Δ bold_W ( bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_B start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT bold_A start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS3.p1.5">where <math alttext="\Delta\mathbf{W}(\mathbf{i}_{&lt;n})" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.3.m1.1"><semantics id="S3.SS2.SSS3.p1.3.m1.1a"><mrow id="S3.SS2.SSS3.p1.3.m1.1.1" xref="S3.SS2.SSS3.p1.3.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.3.m1.1.1.3" mathvariant="normal" xref="S3.SS2.SSS3.p1.3.m1.1.1.3.cmml">Δ</mi><mo id="S3.SS2.SSS3.p1.3.m1.1.1.2" xref="S3.SS2.SSS3.p1.3.m1.1.1.2.cmml">⁢</mo><mi id="S3.SS2.SSS3.p1.3.m1.1.1.4" xref="S3.SS2.SSS3.p1.3.m1.1.1.4.cmml">𝐖</mi><mo id="S3.SS2.SSS3.p1.3.m1.1.1.2a" xref="S3.SS2.SSS3.p1.3.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p1.3.m1.1.1.1.1" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.2.cmml">𝐢</mi><mrow id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.2" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.1" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.3" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.3.m1.1b"><apply id="S3.SS2.SSS3.p1.3.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1"><times id="S3.SS2.SSS3.p1.3.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1.2"></times><ci id="S3.SS2.SSS3.p1.3.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1.3">Δ</ci><ci id="S3.SS2.SSS3.p1.3.m1.1.1.4.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1.4">𝐖</ci><apply id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.2">𝐢</ci><apply id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3"><lt id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p1.3.m1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.3.m1.1c">\Delta\mathbf{W}(\mathbf{i}_{&lt;n})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.3.m1.1d">roman_Δ bold_W ( bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT )</annotation></semantics></math> encapsulates the adjustments enabled by our iLoRA. The attention score <math alttext="\omega_{k}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.4.m2.1"><semantics id="S3.SS2.SSS3.p1.4.m2.1a"><msub id="S3.SS2.SSS3.p1.4.m2.1.1" xref="S3.SS2.SSS3.p1.4.m2.1.1.cmml"><mi id="S3.SS2.SSS3.p1.4.m2.1.1.2" xref="S3.SS2.SSS3.p1.4.m2.1.1.2.cmml">ω</mi><mi id="S3.SS2.SSS3.p1.4.m2.1.1.3" xref="S3.SS2.SSS3.p1.4.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.4.m2.1b"><apply id="S3.SS2.SSS3.p1.4.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.4.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p1.4.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.4.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p1.4.m2.1.1.2">𝜔</ci><ci id="S3.SS2.SSS3.p1.4.m2.1.1.3.cmml" xref="S3.SS2.SSS3.p1.4.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.4.m2.1c">\omega_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.4.m2.1d">italic_ω start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, assigned by the gating network (<em class="ltx_emph ltx_font_italic" id="S3.SS2.SSS3.p1.5.1">cf. </em>Equation (<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S3.E11" title="In 3.2.2 Generating Instance-wise Attentions over Experts ‣ 3.2 Instance-wise LoRA with the Mixture of Experts Concept ‣ 3 Methodology ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">11</span></a>)), reflects the relevance of expert <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.5.m3.1"><semantics id="S3.SS2.SSS3.p1.5.m3.1a"><mi id="S3.SS2.SSS3.p1.5.m3.1.1" xref="S3.SS2.SSS3.p1.5.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.5.m3.1b"><ci id="S3.SS2.SSS3.p1.5.m3.1.1.cmml" xref="S3.SS2.SSS3.p1.5.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.5.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.5.m3.1d">italic_k</annotation></semantics></math>’s contribution to the particular sequence.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS3.p2">
<p class="ltx_p" id="S3.SS2.SSS3.p2.1">We apply such instance-wise LoRA updates on the transformer layers of the base LLM, which collectively construct the tunable parameters <math alttext="\Delta\bm{\phi}(\mathbf{i}_{&lt;n})" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p2.1.m1.1"><semantics id="S3.SS2.SSS3.p2.1.m1.1a"><mrow id="S3.SS2.SSS3.p2.1.m1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.1.1.3" mathvariant="normal" xref="S3.SS2.SSS3.p2.1.m1.1.1.3.cmml">Δ</mi><mo id="S3.SS2.SSS3.p2.1.m1.1.1.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.2.cmml">⁢</mo><mi class="ltx_mathvariant_bold-italic" id="S3.SS2.SSS3.p2.1.m1.1.1.4" mathvariant="bold-italic" xref="S3.SS2.SSS3.p2.1.m1.1.1.4.cmml">ϕ</mi><mo id="S3.SS2.SSS3.p2.1.m1.1.1.2a" xref="S3.SS2.SSS3.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS3.p2.1.m1.1.1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.2.cmml">𝐢</mi><mrow id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.2" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.2.cmml"></mi><mo id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.1" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.3" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.3.cmml">n</mi></mrow></msub><mo id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p2.1.m1.1b"><apply id="S3.SS2.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1"><times id="S3.SS2.SSS3.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.2"></times><ci id="S3.SS2.SSS3.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.3">Δ</ci><ci id="S3.SS2.SSS3.p2.1.m1.1.1.4.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.4">bold-italic-ϕ</ci><apply id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.2">𝐢</ci><apply id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3"><lt id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.2">absent</csymbol><ci id="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS3.p2.1.m1.1.1.1.1.1.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p2.1.m1.1c">\Delta\bm{\phi}(\mathbf{i}_{&lt;n})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p2.1.m1.1d">roman_Δ bold_italic_ϕ ( bold_i start_POSTSUBSCRIPT &lt; italic_n end_POSTSUBSCRIPT )</annotation></semantics></math>.
Clearly, iLoRA maintains the same total number of parameters as the standard LoRA, but dynamically customizes varying LoRA modules for different instances.
This dynamic adaptation of parameters ensures that our model remains flexible and responsive to the varied preferences and behaviors exhibited by users, effectively managing the complexity inherent in sequential recommendation systems. This approach not only enhances personalization but also improves the predictive accuracy of the recommendation system.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we first justify the need to reshape the fine-tuning task with a uniform LoRA module as a multi-task learning framework for sequential recommendation.
Here we conduct extensive experiments on various real-world datasets, including LastFM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib31" title="">31</a>]</cite>, MovieLens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib32" title="">32</a>]</cite>, and Steam <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib33" title="">33</a>]</cite>, to evaluate the effectiveness of our iLoRA framework.
Our analysis includes detailed comparisons of iLoRA against established baseline models, which encompass both traditional sequential recommender models (<em class="ltx_emph ltx_font_italic" id="S4.p1.1.1">e.g., </em>GRU4Rec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib1" title="">1</a>]</cite>, Caser <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib2" title="">2</a>]</cite>, SASRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib3" title="">3</a>]</cite>) and LLM-based recommender models (<em class="ltx_emph ltx_font_italic" id="S4.p1.1.2">e.g., </em>Llama2-7B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib9" title="">9</a>]</cite>, GPT-4 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib44" title="">44</a>]</cite>, MoRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib34" title="">34</a>]</cite>, TALLRec <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib16" title="">16</a>]</cite>, LLaRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>]</cite>).
ValidRatio <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>]</cite> and HitRatio@1 are used as evaluation metrics, to separately quantify the ratios of valid responses over all sequences and relevant items over all candidate items, reflecting the model capability of instruction following and recommendation accuracy.
See Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#A1" title="Appendix A Description of Figure 1 ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">A</span></a> for more details of these baselines, datasets, and metrics.
Moreover, we perform a thorough ablation study to identify the key components that enhance iLoRA’s performance, focusing particularly on the role of the gating network and expert settings.
In a nutshell, we would like to answer the following research questions:
</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">RQ1:</span> What is the rationale behind instance-wise LoRA compared to the uniform LoRA module?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">RQ2:</span> How does iLoRA perform in comparison to traditional sequential recommender systems and LLM-based recommender models?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">RQ3:</span> What is the impact of the designed components (e.g., the gating network, expert settings) on the recommendation performance of iLoRA?</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.2.1.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text" id="S4.T1.3.2" style="font-size:90%;">The Results of iLoRA compared with traditional sequential recommender models and LLMs-based methods.</span></figcaption>
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T1.4" style="width:433.6pt;height:186.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-76.7pt,32.9pt) scale(0.738686397397078,0.738686397397078) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.4.1">
<tr class="ltx_tr" id="S4.T1.4.1.1">
<td class="ltx_td ltx_border_r ltx_border_tt" id="S4.T1.4.1.1.1"></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3" id="S4.T1.4.1.1.2">LastFM</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" colspan="3" id="S4.T1.4.1.1.3">MovieLens</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="3" id="S4.T1.4.1.1.4">Steam</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.2">
<td class="ltx_td ltx_border_r ltx_border_t" id="S4.T1.4.1.2.1"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.2">ValidRatio</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.3">HitRatio@1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.1.2.4">Imp.%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.5">ValidRatio</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.6">HitRatio@1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.1.2.7">Imp.%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.8">ValidRatio</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.9">HitRatio@1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.2.10">Imp.%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.3">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="10" id="S4.T1.4.1.3.1"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.3.1.1">Traditional</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.4.1.4.1">GRU4Rec</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.4.2">1.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.4.3">0.2616</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.4.1.4.4">91.13%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.4.5">1.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.4.6">0.3750</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.4.1.4.7">40.67%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.4.8">1.0000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.4.9">0.4168</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.4.1.4.10">26.30%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.4.1.5.1">Caser</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.2">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.3">0.2233</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.5.4">123.91%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.5">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.6">0.3861</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.5.7">36.62%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.8">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.5.9">0.4368</td>
<td class="ltx_td ltx_align_right" id="S4.T1.4.1.5.10">20.51%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.4.1.6.1">SASRec</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.2">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.3">0.2233</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.6.4">123.91%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.5">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.6">0.3444</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.6.7">53.16%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.8">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.6.9">0.4010</td>
<td class="ltx_td ltx_align_right" id="S4.T1.4.1.6.10">31.27%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.7">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="10" id="S4.T1.4.1.7.1"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.7.1.1">LLM-based</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.8">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S4.T1.4.1.8.1">Llama2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.8.2">0.3443</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.8.3">0.0246</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.4.1.8.4">1932.52%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.8.5">0.4421</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.8.6">0.0421</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T1.4.1.8.7">1152.97%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.8.8">0.1653</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.1.8.9">0.0135</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T1.4.1.8.10">3799.26%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.4.1.9.1">ChatRec</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.9.2">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.9.3">0.3770</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.9.4">32.63%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.9.5">0.9895</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.9.6">0.2000</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.9.7">163.75%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.9.8">0.9798</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.9.9">0.3626</td>
<td class="ltx_td ltx_align_right" id="S4.T1.4.1.9.10">45.17%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.4.1.10.1">MoRec</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.2">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.3">0.1652</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.10.4">202.66%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.5">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.6">0.2822</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.10.7">86.92%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.8">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.10.9">0.3911</td>
<td class="ltx_td ltx_align_right" id="S4.T1.4.1.10.10">34.59%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.11">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.4.1.11.1">TALLRec</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.2">0.9836</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.3">0.4180</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.11.4">19.62%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.5">0.9263</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.6">0.3895</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.11.7">35.43%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.8">0.9840</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.11.9">0.4637</td>
<td class="ltx_td ltx_align_right" id="S4.T1.4.1.11.10">13.52%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="S4.T1.4.1.12.1">LLaRA</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.2">1.0000</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.3">0.4508</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.12.4">8.51%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.5">0.9684</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.6">0.4421</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T1.4.1.12.7">19.32%</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.8">0.9975</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.1.12.9">0.4949</td>
<td class="ltx_td ltx_align_right" id="S4.T1.4.1.12.10">6.36%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.13">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="10" id="S4.T1.4.1.13.1"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.13.1.1">Ours</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.1.14">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.4.1.14.1">iLoRA</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.4.1.14.2">1.0000</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.4.1.14.3"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.3.1">0.5000</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.4.1.14.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.4.1.14.5">0.9891</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.4.1.14.6"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.6.1">0.5275</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.4.1.14.7">-</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.4.1.14.8">0.9981</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.4.1.14.9"><span class="ltx_text ltx_font_bold" id="S4.T1.4.1.14.9.1">0.5264</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_t" id="S4.T1.4.1.14.10">-</td>
</tr>
</table>
</span></div>
</figure>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="495" id="S4.F3.sf1.g1" src="extracted/5904678/figures/motivation22.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F3.sf1.3.2" style="font-size:90%;">Basic LoRA</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="517" id="S4.F3.sf2.g1" src="extracted/5904678/figures/motivation33.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F3.sf2.3.2" style="font-size:90%;">iLoRA</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="478" id="S4.F3.sf3.g1" src="extracted/5904678/figures/seq-emb2.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S4.F3.sf3.3.2" style="font-size:90%;">Attention Scores</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.2.1.1" style="font-size:90%;">Figure 3</span>: </span><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.F3.sf1" style="font-size:90%;" title="In Figure 3 ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3(a)</span></a><span class="ltx_text" id="S4.F3.3.2" style="font-size:90%;"> and <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.F3.sf2" title="In Figure 3 ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3(b)</span></a> separately show gradient similarities of LLaRA and iLoRA, with sequences partitioned into 8 clusters; <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.F3.sf3" title="In Figure 3 ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3(c)</span></a> exhibits the attention scores over four experts, for ten sequences.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Investing Rationale of Instance-wise LoRA (RQ1)</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We begin by experimenting with LLaRA <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>]</cite>, an LLM-based recommender using a uniform LoRA module, to identify a key limitation: negative transfer between significantly different sequences. Next, we examine the experts within iLoRA, which employs an instance-wise LoRA module, to demonstrate the varying attributions of experts when handling different sequences. For more details, see Appendix <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#A2" title="Appendix B Experimental Design and Evaluation ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Negative Transfer in Uniform LoRA &amp; Instance-wise LoRA</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">Gradient similarity reflects the proximity of recommendation sequences <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib28" title="">28</a>]</cite>. Here we explore whether using LLaRA to perform recommendations conditioned on different sequences exhibits similar loss geometries and vice versa.
To achieve this, we use Euclidean distance to control task similarity and gradient similarity to measure loss geometry. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>, a symmetric heatmap visually displays the average gradient similarity across all LLaRA checkpoints at different training steps.
We demonstrate this test in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.F3" title="Figure 3 ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3</span></a>.
Specifically, we observe strong clustering along the diagonal of the gradient similarity matrix for sets of recommendation sequences that are closely related in the Euclidean space. Conversely, recommendation sequences that are distant in Euclidean space exhibit correspondingly lower gradient similarity, leading to negative transfer.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS1.p2">
<p class="ltx_p" id="S4.SS1.SSS1.p2.1">In contrast, we visualize iLoRA’s gradient similarity among the identical clusters.
The similarities between some clusters tend to achieve zero scores, indicating iLoRA’s capability to mitigate the negative transfer between significantly different sequences.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Expert Showcase in Instance-wise LoRA</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">In this section, we visualize the attention scores of iLoRA’s four experts for ten distinct sequences in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.F3.sf3" title="In Figure 3 ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">3(c)</span></a>.
Each horizontal bar represents a sequence, and the length of the segments within each bar indicates the percentage of attention scores assigned to each expert.
We have several findings:</p>
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i1.p1.1.1">Sequence Variability:</span> There is significant variability in expert activation across different sequences. For example, Sequence 4 heavily relies on Expert 1 with a 42.5% activation weight, while Expert 4 only contributes 18.8%, demonstrating distinct preferences for different experts among sequences.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i2.p1.1.1">Expert Contribution:</span> Certain experts have notably high contributions for specific sequences. For instance, in Sequence 2, Expert 4 has a dominant activation weight of 46.7%, indicating that this expert captures the personalized preferences of the user group represented by Sequence 2.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I2.i3.p1.1.1">Collaborative Contribution:</span> Some sequences exhibit a more balanced distribution of activation weights among multiple experts, suggesting collaborative contributions. For example, in Sequence 9, Experts 2 and 3 have similar activation weights of 31.1% and 31.5%, respectively, indicating their joint influence on the recommendations.</p>
</div>
</li>
</ul>
<p class="ltx_p" id="S4.SS1.SSS2.p1.2">These observations demonstrate that iLoRA effectively adjusts expert activation based on the characteristics of each sequence.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Performance Comparison (RQ2)</h3>
<figure class="ltx_figure" id="S4.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="337" id="S4.F4.sf1.g1" src="extracted/5904678/figures/e_num.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S4.F4.sf1.3.2" style="font-size:90%;">Ablation study on the number of experts.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F4.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="337" id="S4.F4.sf2.g1" src="extracted/5904678/figures/5epoch.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S4.F4.sf2.3.2" style="font-size:90%;">Comparison of performance over various epochs</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.3.1.1" style="font-size:90%;">Figure 4</span>: </span><a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.F4.sf1" style="font-size:90%;" title="In Figure 4 ‣ 4.2 Performance Comparison (RQ2) ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4(a)</span></a><span class="ltx_text" id="S4.F4.4.2" style="font-size:90%;"> illustrates the performance of iLoRA <em class="ltx_emph ltx_font_italic" id="S4.F4.4.2.1">w.r.t.</em> HitRatio@1 across different datasets with varying numbers of experts. <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.F4.sf2" title="In Figure 4 ‣ 4.2 Performance Comparison (RQ2) ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4(b)</span></a> further demonstrates the HitRatio@1 performance of the model across different epochs during training on the Steam dataset with varying numbers of experts.</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">This section comprehensively compares iLoRA against some traditional and LLM-based recommenders. We conduct a holistic evaluation, considering metrics of both HitRatio@1 and ValidRatio across LastFM, MovieLens, and Steam datasets to demonstrate the effectiveness of iLoRA.
The results of this comparison are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.T1" title="Table 1 ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Our findings indicate that iLoRA consistently outperforms these baseline models across the three datasets. Specifically, iLoRA achieves the highest HitRatio@1 metrics of 0.5000, 0.5275, and 0.5264 on the LastFM, MovieLens, and Steam datasets, respectively. These results demonstrate the efficacy of leveraging sequence representations as guidance signals to fine-tune LoRA parameters, enabling personalized recommendations at the parameter level.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Ablation Study (RQ3)</h3>
<figure class="ltx_figure ltx_align_floatright" id="S4.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="152" id="S4.F5.g1" src="extracted/5904678/figures/ablation.png" width="269"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F5.2.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S4.F5.3.2" style="font-size:90%;">Effects of iLoRA’s components</span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In this section, we analyze the effectiveness of the main components of iLoRA in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.SS3.SSS1" title="4.3.1 Effects of Gating Network ‣ 4.3 Ablation Study (RQ3) ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4.3.1</span></a>. Subsequently, in Section <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.SS3.SSS2" title="4.3.2 Effect of Expert Numbers ‣ 4.3 Ablation Study (RQ3) ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4.3.2</span></a>, we conduct an in-depth investigation and analysis of how varying the number of experts affects the performance of iLoRA.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Effects of Gating Network</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">Here we explore the influence of sequence representation on the gating network and MoE. Going beyond the sequence-tailored representation, we test two variants: using random-initialized and token-collapsed embeddings as the guidance.
As Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.F5" title="Figure 5 ‣ 4.3 Ablation Study (RQ3) ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">5</span></a> shows, using sequence representation as the guidance consistently outperforms the other variants across three datasets, illustrating the rationale of our gating network and the benefits for the MoE combination.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Effect of Expert Numbers</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">In this section, we investigate how iLoRA would react to the number of experts.
As depicted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S4.F4.sf1" title="In Figure 4 ‣ 4.2 Performance Comparison (RQ2) ‣ 4 Experiments ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">4(a)</span></a>, our model achieves optimal performance when the number of experts is set to 4. Increasing the number of task experts does not necessarily correlate with enhanced performance. Specifically, employing only 2 experts does not significantly improve the HitRatio@1 metrics on Steam and MovieLens datasets, while showing a slight decrease on LastFM. However, with the increase to 4 experts, the model exhibits its best performance across all three datasets, notably surpassing the 2-expert variant. To elaborate, on LastFM, MovieLens, and Steam datasets, the performance of the 4-expert variant exceeds that of the 2-expert variant by 5.2%, 6.4% and 2.2%, respectively. When the number of experts is further increased to 8, the performance resembles that of the 4-expert scenario or even shows a slight decrease. This suggests that the benefits of increased capacity gradually converge as we utilize more experts. Consequently, we adapt 4 experts as the default setting.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p2">
<p class="ltx_p" id="S4.SS3.SSS2.p2.1">Furthermore, we analyzed the performance across different numbers of experts at various epochs, on the Steam dataset.
It is evident that as the number of experts is set to 1, 2, and 4, the overall recommendation performance of the model steadily improves with training progress. Under this configuration, the HitRatio@1 values exhibit a positive correlation with the number of experts. However, when the number of experts reaches 8, the data indicate that the model rapidly achieves a decent performance, but subsequent HitRatio@1 values do not show significant improvements with increasing epochs. We speculate that as the number of experts increases to 8, the model may overly focus on personalized user behaviors, leading to a decrease in generalization ability and premature overfitting.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this paper, we introduced instance-wise LoRA (iLoRA), a novel fine-tuning framework designed to address the challenges posed by the substantial individual variability in user behaviors within sequential recommendation systems. By integrating the mixture of experts (MoE) concept into the basic LoRA module, iLoRA dynamically adjusts to diverse user behaviors, thereby mitigating the negative transfer issues observed with standard single-module LoRA approaches.
iLoRA represents a significant advancement in the application of large language models to sequential recommendation tasks. By incorporating a mixture of expert frameworks within the LoRA module, iLoRA provides a more nuanced and effective means of tailoring recommendations to individual user preferences, paving the way for more personalized and accurate recommendation systems.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Limitation</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">While iLoRA demonstrates promising results, there are several limitations to consider. First, our experiments are constrained by computational resources, limiting the exploration of a larger number of expert combinations and their potential impact on recommendation performance. Second, we do not extensively investigate the effects of using hard routing for recommendations with a large number of experts. Finally, our study focused on sequential recommendation tasks, and the applicability of iLoRA to other types of recommendation systems or domains remains to be explored. These limitations suggest that further research is needed to fully understand the scalability and effectiveness of iLoRA with more complex expert configurations.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Broader Impact</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">Our proposed method, Instance-wise LoRA (iLoRA), advances sequential recommendation systems by sequence-tailored recommendations. By leveraging the Mixture of Experts (MoE) framework, iLoRA streamlines the user experience, reduces decision fatigue, and promotes inclusivity in online spaces. Its instance-wise adaptation mechanism ensures diverse content exposure, fostering a more enriched online discourse. Beyond recommendations, iLoRA’s principles extend to education, healthcare, and e-commerce, offering customized solutions in various domains. Overall, iLoRA represents a step forward in enhancing user experience and promoting inclusivity in the digital landscape.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">However, despite the advancements offered by iLoRA, it is essential to acknowledge potential drawbacks. Algorithmic biases present in the training data may persist, potentially amplifying existing biases in recommendations. Moreover, over-reliance on customization could lead to filter bubbles, limiting exposure to diverse viewpoints and serendipitous discovery. Additionally, concerns regarding privacy arise due to the collection and analysis of user data for personalized recommendations, necessitating careful consideration of ethical implications in its deployment.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al. [2016]</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural networks.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">ICLR</em>, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang [2018]</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke Wang.

</span>
<span class="ltx_bibblock">Personalized top-n sequential recommendation via convolutional sequence embedding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">WSDM</em>, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley [2018a]</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian J. McAuley.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">ICDM</em>, 2018a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2019]</span>
<span class="ltx_bibblock">
Shoujin Wang, Liang Hu, Yan Wang, Longbing Cao, Quan Z. Sheng, and Mehmet A. Orgun.

</span>
<span class="ltx_bibblock">Sequential recommender systems: Challenges, progress and prospects.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">IJCAI</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fang et al. [2020]</span>
<span class="ltx_bibblock">
Hui Fang, Danning Zhang, Yiheng Shu, and Guibing Guo.

</span>
<span class="ltx_bibblock">Deep learning for sequential recommendation: Algorithms, influential factors, and evaluations.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">ACM Trans. Inf. Syst.</em>, 39, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. [2019]</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">BERT: pre-training of deep bidirectional transformers for language understanding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">ACL</em>, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. [2020]</span>
<span class="ltx_bibblock">
Tom B. Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, Sandhini Agarwal, Ariel Herbert-Voss, Gretchen Krueger, Tom Henighan, Rewon Child, Aditya Ramesh, Daniel M. Ziegler, Jeffrey Wu, Clemens Winter, Christopher Hesse, Mark Chen, Eric Sigler, Mateusz Litwin, Scott Gray, Benjamin Chess, Jack Clark, Christopher Berner, Sam McCandlish, Alec Radford, Ilya Sutskever, and Dario Amodei.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">NeurIPS</em>, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. [2023a]</span>
<span class="ltx_bibblock">
Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne Lachaux, Timothée Lacroix, Baptiste Rozière, Naman Goyal, Eric Hambro, Faisal Azhar, Aurélien Rodriguez, Armand Joulin, Edouard Grave, and Guillaume Lample.

</span>
<span class="ltx_bibblock">Llama: Open and efficient foundation language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">CoRR</em>, abs/2302.13971, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. [2023b]</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, Cristian Canton-Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa, Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang, Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurélien Rodriguez, Robert Stojnic, Sergey Edunov,
and Thomas Scialom.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">CoRR</em>, abs/2307.09288, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. [2023]</span>
<span class="ltx_bibblock">
Albert Q. Jiang, Alexandre Sablayrolles, Arthur Mensch, Chris Bamford, Devendra Singh Chaplot, Diego de Las Casas, Florian Bressand, Gianna Lengyel, Guillaume Lample, Lucile Saulnier, Lélio Renard Lavaud, Marie-Anne Lachaux, Pierre Stock, Teven Le Scao, Thibaut Lavril, Thomas Wang, Timothée Lacroix, and William El Sayed.

</span>
<span class="ltx_bibblock">Mistral 7b.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">CoRR</em>, abs/2310.06825, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Taori et al. [2023]</span>
<span class="ltx_bibblock">
Rohan Taori, Ishaan Gulrajani, Tianyi Zhang, Yann Dubois, Xuechen Li, Carlos Guestrin, Percy Liang, and Tatsunori B Hashimoto.

</span>
<span class="ltx_bibblock">Stanford alpaca: An instruction-following llama model.

</span>
<span class="ltx_bibblock">2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chiang et al. [2023]</span>
<span class="ltx_bibblock">
Wei-Lin Chiang, Zhuohan Li, Zi Lin, Ying Sheng, Zhanghao Wu, Hao Zhang, Lianmin Zheng, Siyuan Zhuang, Yonghao Zhuang, Joseph E Gonzalez, et al.

</span>
<span class="ltx_bibblock">Vicuna: An open-source chatbot impressing gpt-4 with 90%* chatgpt quality.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">See https://vicuna. lmsys. org (accessed 14 April 2023)</em>, 2, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al. [2022]</span>
<span class="ltx_bibblock">
Zeyu Cui, Jianxin Ma, Chang Zhou, Jingren Zhou, and Hongxia Yang.

</span>
<span class="ltx_bibblock">M6-rec: Generative pretrained language models are open-ended recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">CoRR</em>, abs/2205.08084, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al. [2022a]</span>
<span class="ltx_bibblock">
Shijie Geng, Shuchang Liu, Zuohui Fu, Yingqiang Ge, and Yongfeng Zhang.

</span>
<span class="ltx_bibblock">Recommendation as language processing (RLP): A unified pretrain, personalized prompt &amp; predict paradigm (P5).

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">RecSys</em>, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2023a]</span>
<span class="ltx_bibblock">
Jiacheng Li, Ming Wang, Jin Li, Jinmiao Fu, Xin Shen, Jingbo Shang, and Julian J. McAuley.

</span>
<span class="ltx_bibblock">Text is all you need: Learning language representations for sequential recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">KDD</em>, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bao et al. [2023]</span>
<span class="ltx_bibblock">
Keqin Bao, Jizhi Zhang, Yang Zhang, Wenjie Wang, Fuli Feng, and Xiangnan He.

</span>
<span class="ltx_bibblock">Tallrec: An effective and efficient tuning framework to align large language model with recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">RecSys</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et al. [2024]</span>
<span class="ltx_bibblock">
Jianchao Ji, Zelong Li, Shuyuan Xu, Wenyue Hua, Yingqiang Ge, Juntao Tan, and Yongfeng Zhang.

</span>
<span class="ltx_bibblock">Genrec: Large language model for generative recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">ECIR (3)</em>, volume 14610 of <em class="ltx_emph ltx_font_italic" id="bib.bib17.2.2">Lecture Notes in Computer Science</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al. [2023]</span>
<span class="ltx_bibblock">
Sunhao Dai, Ninglu Shao, Haiyuan Zhao, Weijie Yu, Zihua Si, Chen Xu, Zhongxiang Sun, Xiao Zhang, and Jun Xu.

</span>
<span class="ltx_bibblock">Uncovering chatgpt’s capabilities in recommender systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">RecSys</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2023a]</span>
<span class="ltx_bibblock">
Junling Liu, Chao Liu, Renjie Lv, Kang Zhou, and Yan Zhang.

</span>
<span class="ltx_bibblock">Is chatgpt a good recommender? A preliminary study.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">CoRR</em>, abs/2304.10149, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hou et al. [2024]</span>
<span class="ltx_bibblock">
Yupeng Hou, Junjie Zhang, Zihan Lin, Hongyu Lu, Ruobing Xie, Julian J. McAuley, and Wayne Xin Zhao.

</span>
<span class="ltx_bibblock">Large language models are zero-shot rankers for recommender systems.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">ECIR (2)</em>, volume 14609 of <em class="ltx_emph ltx_font_italic" id="bib.bib20.2.2">Lecture Notes in Computer Science</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liao et al. [2023]</span>
<span class="ltx_bibblock">
Jiayi Liao, Sihang Li, Zhengyi Yang, Jiancan Wu, Yancheng Yuan, and Xiang Wang.

</span>
<span class="ltx_bibblock">Llara: Aligning large language models with sequential recommenders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">CoRR</em>, abs/2312.02445, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2023b]</span>
<span class="ltx_bibblock">
Xinhang Li, Chong Chen, Xiangyu Zhao, Yong Zhang, and Chunxiao Xing.

</span>
<span class="ltx_bibblock">E4srec: An elegant effective efficient extensible solution of large language models for sequential recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">CoRR</em>, abs/2312.02443, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yue et al. [2023]</span>
<span class="ltx_bibblock">
Zhenrui Yue, Sara Rabhi, Gabriel de Souza Pereira Moreira, Dong Wang, and Even Oldridge.

</span>
<span class="ltx_bibblock">Llamarec: Two-stage recommendation using large language models for ranking.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">CoRR</em>, abs/2311.02089, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2023a]</span>
<span class="ltx_bibblock">
Junjie Zhang, Ruobing Xie, Yupeng Hou, Wayne Xin Zhao, Leyu Lin, and Ji-Rong Wen.

</span>
<span class="ltx_bibblock">Recommendation as instruction following: A large language model empowered recommendation approach.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">CoRR</em>, abs/2305.07001, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2023b]</span>
<span class="ltx_bibblock">
Yang Zhang, Fuli Feng, Jizhi Zhang, Keqin Bao, Qifan Wang, and Xiangnan He.

</span>
<span class="ltx_bibblock">Collm: Integrating collaborative embeddings into large language models for recommendation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">CoRR</em>, abs/2310.19488, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geng et al. [2022b]</span>
<span class="ltx_bibblock">
Shijie Geng, Shuchang Liu, Zuohui Fu, Yingqiang Ge, and Yongfeng Zhang.

</span>
<span class="ltx_bibblock">Recommendation as language processing (RLP): A unified pretrain, personalized prompt &amp; predict paradigm (P5).

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">RecSys</em>, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2023]</span>
<span class="ltx_bibblock">
Haowen Wang, Tao Sun, Congyun Jin, Yingbo Wang, Yibo Fan, Yunqi Xu, Yuliang Du, and Cong Fan.

</span>
<span class="ltx_bibblock">Customizable combination of parameter-efficient modules for multi-task learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">The Twelfth International Conference on Learning Representations</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2021]</span>
<span class="ltx_bibblock">
Zirui Wang, Yulia Tsvetkov, Orhan Firat, and Yuan Cao.

</span>
<span class="ltx_bibblock">Gradient vaccine: Investigating and improving multi-task optimization in massively multilingual models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">ICLR</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer et al. [2017]</span>
<span class="ltx_bibblock">
Noam Shazeer, Azalia Mirhoseini, Krzysztof Maziarz, Andy Davis, Quoc V. Le, Geoffrey E. Hinton, and Jeff Dean.

</span>
<span class="ltx_bibblock">Outrageously large neural networks: The sparsely-gated mixture-of-experts layer.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">ICLR (Poster)</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fedus et al. [2022a]</span>
<span class="ltx_bibblock">
William Fedus, Barret Zoph, and Noam Shazeer.

</span>
<span class="ltx_bibblock">Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">J. Mach. Learn. Res.</em>, 23, 2022a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cantador et al. [2011]</span>
<span class="ltx_bibblock">
Iván Cantador, Peter Brusilovsky, and Tsvi Kuflik, editors.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">Proceedings of the 2nd International Workshop on Information Heterogeneity and Fusion in Recommender Systems, HetRec ’11, Chicago, Illinois, USA, October 27, 2011</em>, 2011. ACM.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harper and Konstan [2016]</span>
<span class="ltx_bibblock">
F. Maxwell Harper and Joseph A. Konstan.

</span>
<span class="ltx_bibblock">The movielens datasets: History and context.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">ACM Trans. Interact. Intell. Syst.</em>, 5, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley [2018b]</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian J. McAuley.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">ICDM</em>, pages 197–206. IEEE Computer Society, 2018b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al. [2023]</span>
<span class="ltx_bibblock">
Zheng Yuan, Fajie Yuan, Yu Song, Youhua Li, Junchen Fu, Fei Yang, Yunzhu Pan, and Yongxin Ni.

</span>
<span class="ltx_bibblock">Where to go next for recommender systems? ID- vs. modality-based recommender models revisited.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">SIGIR</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. [2022]</span>
<span class="ltx_bibblock">
Jason Wei, Maarten Bosma, Vincent Y. Zhao, Kelvin Guu, Adams Wei Yu, Brian Lester, Nan Du, Andrew M. Dai, and Quoc V. Le.

</span>
<span class="ltx_bibblock">Finetuned language models are zero-shot learners.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">ICLR</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sanh et al. [2022]</span>
<span class="ltx_bibblock">
Victor Sanh, Albert Webson, Colin Raffel, Stephen H. Bach, Lintang Sutawika, Zaid Alyafeai, Antoine Chaffin, Arnaud Stiegler, Arun Raja, Manan Dey, M Saiful Bari, Canwen Xu, Urmish Thakker, Shanya Sharma Sharma, Eliza Szczechla, Taewoon Kim, Gunjan Chhablani, Nihal V. Nayak, Debajyoti Datta, Jonathan Chang, Mike Tian-Jian Jiang, Han Wang, Matteo Manica, Sheng Shen, Zheng Xin Yong, Harshit Pandey, Rachel Bawden, Thomas Wang, Trishala Neeraj, Jos Rozen, Abheesht Sharma, Andrea Santilli, Thibault Févry, Jason Alan Fries, Ryan Teehan, Teven Le Scao, Stella Biderman, Leo Gao, Thomas Wolf, and Alexander M. Rush.

</span>
<span class="ltx_bibblock">Multitask prompted training enables zero-shot task generalization.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">ICLR</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. [2022]</span>
<span class="ltx_bibblock">
Junxian He, Chunting Zhou, Xuezhe Ma, Taylor Berg-Kirkpatrick, and Graham Neubig.

</span>
<span class="ltx_bibblock">Towards a unified view of parameter-efficient transfer learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">ICLR</em>. OpenReview.net, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2021]</span>
<span class="ltx_bibblock">
Xiao Liu, Yanan Zheng, Zhengxiao Du, Ming Ding, Yujie Qian, Zhilin Yang, and Jie Tang.

</span>
<span class="ltx_bibblock">GPT understands, too.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">CoRR</em>, abs/2103.10385, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Liang [2021]</span>
<span class="ltx_bibblock">
Xiang Lisa Li and Percy Liang.

</span>
<span class="ltx_bibblock">Prefix-tuning: Optimizing continuous prompts for generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">ACL/IJCNLP (1)</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hyeon-Woo et al. [2022]</span>
<span class="ltx_bibblock">
Nam Hyeon-Woo, Moon Ye-Bin, and Tae-Hyun Oh.

</span>
<span class="ltx_bibblock">Fedpara: Low-rank hadamard product for communication-efficient federated learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">ICLR</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yeh et al. [2023]</span>
<span class="ltx_bibblock">
Shin-Ying Yeh, Yu-Guan Hsieh, Zhidong Gao, Bernard B. W. Yang, Giyeong Oh, and Yanmin Gong.

</span>
<span class="ltx_bibblock">Navigating text-to-image customization: From lycoris fine-tuning to model evaluation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">CoRR</em>, abs/2309.14859, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. [2022]</span>
<span class="ltx_bibblock">
Edward J. Hu, Yelong Shen, Phillip Wallis, Zeyuan Allen-Zhu, Yuanzhi Li, Shean Wang, Lu Wang, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Lora: Low-rank adaptation of large language models.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">ICLR</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2022]</span>
<span class="ltx_bibblock">
Haokun Liu, Derek Tam, Mohammed Muqeeth, Jay Mohta, Tenghao Huang, Mohit Bansal, and Colin Raffel.

</span>
<span class="ltx_bibblock">Few-shot parameter-efficient fine-tuning is better and cheaper than in-context learning.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">NeurIPS</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al. [2023]</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:2303.08774</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. [2019]</span>
<span class="ltx_bibblock">
Naveen Arivazhagan, Ankur Bapna, Orhan Firat, Dmitry Lepikhin, Melvin Johnson, Maxim Krikun, Mia Xu Chen, Yuan Cao, George F. Foster, Colin Cherry, Wolfgang Macherey, Zhifeng Chen, and Yonghui Wu.

</span>
<span class="ltx_bibblock">Massively multilingual neural machine translation in the wild: Findings and challenges.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">CoRR</em>, abs/1907.05019, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2023]</span>
<span class="ltx_bibblock">
Lianmin Zheng, Wei-Lin Chiang, Ying Sheng, Siyuan Zhuang, Zhanghao Wu, Yonghao Zhuang, Zi Lin, Zhuohan Li, Dacheng Li, Eric P. Xing, Hao Zhang, Joseph E. Gonzalez, and Ion Stoica.

</span>
<span class="ltx_bibblock">Judging llm-as-a-judge with mt-bench and chatbot arena.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">NeurIPS</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. [2023]</span>
<span class="ltx_bibblock">
Shijie Wu, Ozan Irsoy, Steven Lu, Vadim Dabravolski, Mark Dredze, Sebastian Gehrmann, Prabhanjan Kambadur, David S. Rosenberg, and Gideon Mann.

</span>
<span class="ltx_bibblock">Bloomberggpt: A large language model for finance.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">CoRR</em>, abs/2303.17564, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singhal et al. [2022]</span>
<span class="ltx_bibblock">
Karan Singhal, Shekoofeh Azizi, Tao Tu, S. Sara Mahdavi, Jason Wei, Hyung Won Chung, Nathan Scales, Ajay Kumar Tanwani, Heather Cole-Lewis, Stephen Pfohl, Perry Payne, Martin Seneviratne, Paul Gamble, Chris Kelly, Nathaneal Schärli, Aakanksha Chowdhery, Philip Andrew Mansfield, Blaise Agüera y Arcas, Dale R. Webster, Gregory S. Corrado, Yossi Matias, Katherine Chou, Juraj Gottweis, Nenad Tomasev, Yun Liu, Alvin Rajkomar, Joelle K. Barral, Christopher Semturs, Alan Karthikesalingam, and Vivek Natarajan.

</span>
<span class="ltx_bibblock">Large language models encode clinical knowledge.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">CoRR</em>, abs/2212.13138, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cui et al. [2023]</span>
<span class="ltx_bibblock">
Jiaxi Cui, Zongjian Li, Yang Yan, Bohua Chen, and Li Yuan.

</span>
<span class="ltx_bibblock">Chatlaw: Open-source legal large language model with integrated external knowledge bases.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">CoRR</em>, abs/2306.16092, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jacobs et al. [1991]</span>
<span class="ltx_bibblock">
Robert A. Jacobs, Michael I. Jordan, Steven J. Nowlan, and Geoffrey E. Hinton.

</span>
<span class="ltx_bibblock">Adaptive mixtures of local experts.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">Neural Comput.</em>, 3(1):79–87, 1991.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Riquelme et al. [2021]</span>
<span class="ltx_bibblock">
Carlos Riquelme, Joan Puigcerver, Basil Mustafa, Maxim Neumann, Rodolphe Jenatton, André Susano Pinto, Daniel Keysers, and Neil Houlsby.

</span>
<span class="ltx_bibblock">Scaling vision with sparse mixture of experts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">NeurIPS</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2023b]</span>
<span class="ltx_bibblock">
Zhili Liu, Kai Chen, Jianhua Han, Lanqing Hong, Hang Xu, Zhenguo Li, and James T. Kwok.

</span>
<span class="ltx_bibblock">Task-customized masked autoencoder via mixture of cluster-conditional experts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib52.1.1">ICLR</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fedus et al. [2022b]</span>
<span class="ltx_bibblock">
William Fedus, Barret Zoph, and Noam Shazeer.

</span>
<span class="ltx_bibblock">Switch transformers: Scaling to trillion parameter models with simple and efficient sparsity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib53.1.1">J. Mach. Learn. Res.</em>, 23, 2022b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lepikhin et al. [2021]</span>
<span class="ltx_bibblock">
Dmitry Lepikhin, HyoukJoong Lee, Yuanzhong Xu, Dehao Chen, Orhan Firat, Yanping Huang, Maxim Krikun, Noam Shazeer, and Zhifeng Chen.

</span>
<span class="ltx_bibblock">Gshard: Scaling giant models with conditional computation and automatic sharding.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib54.1.1">ICLR</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mustafa et al. [2022]</span>
<span class="ltx_bibblock">
Basil Mustafa, Carlos Riquelme, Joan Puigcerver, Rodolphe Jenatton, and Neil Houlsby.

</span>
<span class="ltx_bibblock">Multimodal contrastive learning with limoe: the language-image mixture of experts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib55.1.1">NeurIPS</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. [2023]</span>
<span class="ltx_bibblock">
Sheng Shen, Zhewei Yao, Chunyuan Li, Trevor Darrell, Kurt Keutzer, and Yuxiong He.

</span>
<span class="ltx_bibblock">Scaling vision-language models with sparse mixture of experts.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib56.1.1">EMNLP (Findings)</em>, 2023.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Description of Figure <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Customizing Language Models with Instance-wise LoRA for Sequential Recommendation"><span class="ltx_text ltx_ref_tag">1</span></a>
</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">This figure illustrates the gradient similarity of LoRA modules across all training steps. We utilize signals from the collaborative space to partition the sequence dataset into 8 clusters. Euclidean distance is employed to evaluate the proximity between clusters, whereas gradient similarity is measured to assess geometric loss. Clusters that are closer in the collaborative space are depicted as closer together in the left side of the figure, with darker-colored cells indicating higher gradient similarity. On the right side of the figure, we conducted a case study on three sets of data with pairwise cosine similarities of 0.86 and -0.75. For sequences containing more than three movies of the same genre, we performed a cross-matching analysis. It was observed that the two user sequences from the cluster with a cosine similarity of 0.86 both exhibited a strong interest in thriller movies, sharing two identical items in their interaction histories at the same time. In contrast, the two user sequences from the cluster with a cosine similarity of -0.75 did not demonstrate any noticeable preference similarities.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Experimental Design and Evaluation</h2>
<div class="ltx_para" id="A2.p1">
<p class="ltx_p" id="A2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.p1.1.1">Datasets.</span>
To validate the generalization ability of iLoRA, we conducted extensive experiments on four datasets derived from real-world recommendation scenarios: LastFM, GoodReads, Amazon-book, and Steam:</p>
</div>
<div class="ltx_para" id="A2.p2">
<ul class="ltx_itemize" id="A2.I1">
<li class="ltx_item" id="A2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i1.p1">
<p class="ltx_p" id="A2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i1.p1.1.1">LastFM</span>
Collected from the Last.fm online music platform, including user-artist listening relationships and the names of artists.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i2.p1">
<p class="ltx_p" id="A2.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i2.p1.1.1">MovieLens</span>
A commonly used movie recommendation dataset that contains user ratings and movie titles.</p>
</div>
</li>
<li class="ltx_item" id="A2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="A2.I1.i3.p1">
<p class="ltx_p" id="A2.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="A2.I1.i3.p1.1.1">Steam</span>
Encompasses user reviews for video games on the Steam Store, in addition to game titles.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="A2.p3">
<p class="ltx_p" id="A2.p3.1"><span class="ltx_text ltx_font_bold" id="A2.p3.1.1">Baselines.</span>
We compared iLoRA with several models, including traditional sequential recommendation models and those based on Large Language Models (LLMs), such as GRU4Rec<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib1" title="">1</a>]</cite>, Caser, SASRec<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib3" title="">3</a>]</cite>, Llama2<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib9" title="">9</a>]</cite>, GPT-4, MoRec, TallRec<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib16" title="">16</a>]</cite>, and LlaRA<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>]</cite>. GRU4Rec, Caser, and SASRec utilize recurrent neural networks, convolutional neural networks, and Transformer encoders, respectively, to capture sequential patterns in user behavior. Llama2, a well-known open-source LLM, is released by Meta, and in our experiments, we utilized the 7B version. GPT-4, the latest version of the GPT series, is a milestone in the performance of LLMs across diverse tasks, from natural language processing to other domains. We conducted our research using the API provided by OpenAI. MoRec enhances traditional sequential recommendation models, such as text-based features, by leveraging pretrained modal encoders to strengthen the modal characteristics of encoded items. TallRec guides LLMs through fine-tuning recommendation corpora. LlaRA further improves the recommendation effectiveness of LLMs by aligning collaborative signals to the text space through a hybrid prompt method.</p>
</div>
<div class="ltx_para" id="A2.p4">
<p class="ltx_p" id="A2.p4.1"><span class="ltx_text ltx_font_bold" id="A2.p4.1.1">Training Protocol.</span>
For our study, we opt for Llama2-7B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib9" title="">9</a>]</cite> as the LLM backbone. Given the disparity in computational resources between traditional sequential recommendation models and LLM-based methods, we execute baseline models on a single Nvidia A40, while LLaRA is implemented on a single Nvidia-smi a100. This ensures optimal utilization of available computational resources. All implementations are carried out using Python 3.8 and PytorchLightning 1.8.6.</p>
</div>
<div class="ltx_para" id="A2.p5">
<p class="ltx_p" id="A2.p5.1"><span class="ltx_text ltx_font_bold" id="A2.p5.1.1">Evaluation Protocol.</span></p>
</div>
<div class="ltx_para" id="A2.p6">
<p class="ltx_p" id="A2.p6.1">To assess the performance of iLoRA and baseline models, we construct candidate sets for each sequence by randomly selecting 20 non-interacted items while ensuring the inclusion of the correct next item. Performance is evaluated using the HitRatio@1 metric, wherein models attempt to identify the correct item from the candidate set. LLM-based recommenders, when provided with appropriate prompts, generate a single candidate item. Conversely, traditional models are adapted to select the item with the highest probability. Additionally, we introduce the ValidRatio metric to quantify the proportion of valid responses (i.e., items within the candidate set) across all sequences. This metric serves to evaluate the models’ adherence to instructions accurately.</p>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Experimental Setup of RQ1</h2>
<div class="ltx_para" id="A3.p1">
<p class="ltx_p" id="A3.p1.1">We extend the previous research setup to train models on multi-task scenarios<cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib45" title="">45</a>]</cite>. Specifically, we jointly train recommendation sequences in a basic LoRA training framework. We use an effective batch sizes of 128 sequences. The recommendation sequences are divided into multiple tasks using representations derived from the sequential recommendation model SASRec, with a dimension of 64.</p>
</div>
<div class="ltx_para" id="A3.p2">
<p class="ltx_p" id="A3.p2.1">To investigate large-scale multi-tasking in sequential recommendation tasks, we sample 40k sequences from the Steam dataset. We clustered these sequences into 8 sub-datasets using Euclidean distance. At checkpoints across 1k training steps, we measured the pairwise cosine similarity of model gradients for all sequences. We averaged the LoRA gradients that were bound to the same modules, such as <math alttext="gateproj" class="ltx_Math" display="inline" id="A3.p2.1.m1.1"><semantics id="A3.p2.1.m1.1a"><mrow id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml"><mi id="A3.p2.1.m1.1.1.2" xref="A3.p2.1.m1.1.1.2.cmml">g</mi><mo id="A3.p2.1.m1.1.1.1" xref="A3.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="A3.p2.1.m1.1.1.3" xref="A3.p2.1.m1.1.1.3.cmml">a</mi><mo id="A3.p2.1.m1.1.1.1a" xref="A3.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="A3.p2.1.m1.1.1.4" xref="A3.p2.1.m1.1.1.4.cmml">t</mi><mo id="A3.p2.1.m1.1.1.1b" xref="A3.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="A3.p2.1.m1.1.1.5" xref="A3.p2.1.m1.1.1.5.cmml">e</mi><mo id="A3.p2.1.m1.1.1.1c" xref="A3.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="A3.p2.1.m1.1.1.6" xref="A3.p2.1.m1.1.1.6.cmml">p</mi><mo id="A3.p2.1.m1.1.1.1d" xref="A3.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="A3.p2.1.m1.1.1.7" xref="A3.p2.1.m1.1.1.7.cmml">r</mi><mo id="A3.p2.1.m1.1.1.1e" xref="A3.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="A3.p2.1.m1.1.1.8" xref="A3.p2.1.m1.1.1.8.cmml">o</mi><mo id="A3.p2.1.m1.1.1.1f" xref="A3.p2.1.m1.1.1.1.cmml">⁢</mo><mi id="A3.p2.1.m1.1.1.9" xref="A3.p2.1.m1.1.1.9.cmml">j</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><apply id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1"><times id="A3.p2.1.m1.1.1.1.cmml" xref="A3.p2.1.m1.1.1.1"></times><ci id="A3.p2.1.m1.1.1.2.cmml" xref="A3.p2.1.m1.1.1.2">𝑔</ci><ci id="A3.p2.1.m1.1.1.3.cmml" xref="A3.p2.1.m1.1.1.3">𝑎</ci><ci id="A3.p2.1.m1.1.1.4.cmml" xref="A3.p2.1.m1.1.1.4">𝑡</ci><ci id="A3.p2.1.m1.1.1.5.cmml" xref="A3.p2.1.m1.1.1.5">𝑒</ci><ci id="A3.p2.1.m1.1.1.6.cmml" xref="A3.p2.1.m1.1.1.6">𝑝</ci><ci id="A3.p2.1.m1.1.1.7.cmml" xref="A3.p2.1.m1.1.1.7">𝑟</ci><ci id="A3.p2.1.m1.1.1.8.cmml" xref="A3.p2.1.m1.1.1.8">𝑜</ci><ci id="A3.p2.1.m1.1.1.9.cmml" xref="A3.p2.1.m1.1.1.9">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">gateproj</annotation><annotation encoding="application/x-llamapun" id="A3.p2.1.m1.1d">italic_g italic_a italic_t italic_e italic_p italic_r italic_o italic_j</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Related Work</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1"><span class="ltx_text ltx_font_bold" id="A4.p1.1.1">Large Language Models</span>
Recent years have witnessed a surge of activity in language modeling research, establishing it as a cornerstone for both understanding and generating language. This momentum has given rise to a new breed of language models (LMs), including notable works such as BERT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib6" title="">6</a>]</cite>, GPT-3 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib7" title="">7</a>]</cite>, LLama <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib8" title="">8</a>]</cite>, LLama2 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib9" title="">9</a>]</cite>, Mistral-7B <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib10" title="">10</a>]</cite>, Alpaca <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib11" title="">11</a>]</cite>, and Vicuna <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib12" title="">12</a>]</cite>. These LMs, predominantly based on the Transformer architecture, have demonstrated remarkable versatility, exemplified by models like BERT <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib6" title="">6</a>]</cite> and T5 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib36" title="">36</a>]</cite>, owing to their extensive training corpus.
A significant stride in this domain has been the exploration of scaling effects, with researchers pushing the boundaries by augmenting both the parameter and training corpus scales to unprecedented magnitudes, encompassing billions of parameters and trillions of training tokens <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib8" title="">8</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib12" title="">12</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib7" title="">7</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib46" title="">46</a>]</cite>. These Large Language Models (LLMs) exhibit substantial performance enhancements and showcase unique capabilities, including but not limited to common sense reasoning and instruction following.
Moreover, the development of domain-specific LLMs further enriches this landscape. Models tailored to specific domains, such as finance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib47" title="">47</a>]</cite>, medicine <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib48" title="">48</a>]</cite>, and law <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib49" title="">49</a>]</cite>, amalgamate domain expertise with the inherent commonsense knowledge of general LLMs. These advancements not only broaden the scope of LLM applications but also inspire exploration into their potential utility in recommendation systems.</p>
</div>
<div class="ltx_para" id="A4.p2">
<p class="ltx_p" id="A4.p2.1"><span class="ltx_text ltx_font_bold" id="A4.p2.1.1">Mixture of Experts</span>
Mixture of Experts. MoE models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib50" title="">50</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib29" title="">29</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib30" title="">30</a>]</cite> are considered as an effective way to increasing the model capacity in terms of parameter size. In MoE, certain parts of the model are activated while the computation is kept the same or close to its dense counterpart. Recently, it has been thoroughly investigated in the field of computer vision <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib51" title="">51</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib52" title="">52</a>]</cite>, natural language processing <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib53" title="">53</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib54" title="">54</a>]</cite> and multi-modal learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib55" title="">55</a>, <a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib56" title="">56</a>]</cite>.</p>
</div>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Statistics</h2>
<div class="ltx_para" id="A5.p1">
<p class="ltx_p" id="A5.p1.1">In our experimental settings, we closely follow the setup of prior works <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2408.10159v2#bib.bib21" title="">21</a>]</cite> to ensure a fair and meaningful comparison. Specifically, for all conventional sequential recommendation baselines, we employ the Adam optimization algorithm, establishing a learning rate of 0.001, an embedding dimension of 64, and a batch size of 256, respectively. Furthermore, we incorporate L2 regularization, and the regularization coefficient is fine-tuned through a grid search over a specified set of possible values.We report the average results from five different random seeds, specifically selected from the set, To reduce the effect of randomness.</p>
</div>
<div class="ltx_para" id="A5.p2">
<p class="ltx_p" id="A5.p2.2">For experiments involving methods based on large language models (LLMs), we incorporate a warm-up strategy for the learning rate, which begins the training process with an initial rate set at a fraction of the maximum learning rate. Specifically, the maximum learning rates are set to <math alttext="2e^{-4}" class="ltx_Math" display="inline" id="A5.p2.1.m1.1"><semantics id="A5.p2.1.m1.1a"><mrow id="A5.p2.1.m1.1.1" xref="A5.p2.1.m1.1.1.cmml"><mn id="A5.p2.1.m1.1.1.2" xref="A5.p2.1.m1.1.1.2.cmml">2</mn><mo id="A5.p2.1.m1.1.1.1" xref="A5.p2.1.m1.1.1.1.cmml">⁢</mo><msup id="A5.p2.1.m1.1.1.3" xref="A5.p2.1.m1.1.1.3.cmml"><mi id="A5.p2.1.m1.1.1.3.2" xref="A5.p2.1.m1.1.1.3.2.cmml">e</mi><mrow id="A5.p2.1.m1.1.1.3.3" xref="A5.p2.1.m1.1.1.3.3.cmml"><mo id="A5.p2.1.m1.1.1.3.3a" xref="A5.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="A5.p2.1.m1.1.1.3.3.2" xref="A5.p2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.p2.1.m1.1b"><apply id="A5.p2.1.m1.1.1.cmml" xref="A5.p2.1.m1.1.1"><times id="A5.p2.1.m1.1.1.1.cmml" xref="A5.p2.1.m1.1.1.1"></times><cn id="A5.p2.1.m1.1.1.2.cmml" type="integer" xref="A5.p2.1.m1.1.1.2">2</cn><apply id="A5.p2.1.m1.1.1.3.cmml" xref="A5.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A5.p2.1.m1.1.1.3.1.cmml" xref="A5.p2.1.m1.1.1.3">superscript</csymbol><ci id="A5.p2.1.m1.1.1.3.2.cmml" xref="A5.p2.1.m1.1.1.3.2">𝑒</ci><apply id="A5.p2.1.m1.1.1.3.3.cmml" xref="A5.p2.1.m1.1.1.3.3"><minus id="A5.p2.1.m1.1.1.3.3.1.cmml" xref="A5.p2.1.m1.1.1.3.3"></minus><cn id="A5.p2.1.m1.1.1.3.3.2.cmml" type="integer" xref="A5.p2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.1.m1.1c">2e^{-4}</annotation><annotation encoding="application/x-llamapun" id="A5.p2.1.m1.1d">2 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> for the LastFM dataset and <math alttext="1e^{-4}" class="ltx_Math" display="inline" id="A5.p2.2.m2.1"><semantics id="A5.p2.2.m2.1a"><mrow id="A5.p2.2.m2.1.1" xref="A5.p2.2.m2.1.1.cmml"><mn id="A5.p2.2.m2.1.1.2" xref="A5.p2.2.m2.1.1.2.cmml">1</mn><mo id="A5.p2.2.m2.1.1.1" xref="A5.p2.2.m2.1.1.1.cmml">⁢</mo><msup id="A5.p2.2.m2.1.1.3" xref="A5.p2.2.m2.1.1.3.cmml"><mi id="A5.p2.2.m2.1.1.3.2" xref="A5.p2.2.m2.1.1.3.2.cmml">e</mi><mrow id="A5.p2.2.m2.1.1.3.3" xref="A5.p2.2.m2.1.1.3.3.cmml"><mo id="A5.p2.2.m2.1.1.3.3a" xref="A5.p2.2.m2.1.1.3.3.cmml">−</mo><mn id="A5.p2.2.m2.1.1.3.3.2" xref="A5.p2.2.m2.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A5.p2.2.m2.1b"><apply id="A5.p2.2.m2.1.1.cmml" xref="A5.p2.2.m2.1.1"><times id="A5.p2.2.m2.1.1.1.cmml" xref="A5.p2.2.m2.1.1.1"></times><cn id="A5.p2.2.m2.1.1.2.cmml" type="integer" xref="A5.p2.2.m2.1.1.2">1</cn><apply id="A5.p2.2.m2.1.1.3.cmml" xref="A5.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="A5.p2.2.m2.1.1.3.1.cmml" xref="A5.p2.2.m2.1.1.3">superscript</csymbol><ci id="A5.p2.2.m2.1.1.3.2.cmml" xref="A5.p2.2.m2.1.1.3.2">𝑒</ci><apply id="A5.p2.2.m2.1.1.3.3.cmml" xref="A5.p2.2.m2.1.1.3.3"><minus id="A5.p2.2.m2.1.1.3.3.1.cmml" xref="A5.p2.2.m2.1.1.3.3"></minus><cn id="A5.p2.2.m2.1.1.3.3.2.cmml" type="integer" xref="A5.p2.2.m2.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A5.p2.2.m2.1c">1e^{-4}</annotation><annotation encoding="application/x-llamapun" id="A5.p2.2.m2.1d">1 italic_e start_POSTSUPERSCRIPT - 4 end_POSTSUPERSCRIPT</annotation></semantics></math> for the MovieLens and Steam datasets. Notably, the projector parameters are updated using the same learning rate curve integrated with iLoRA during training.</p>
</div>
<div class="ltx_para" id="A5.p3">
<p class="ltx_p" id="A5.p3.1">We adopt a cosine annealing scheduler to adjust the learning rate across training steps, which facilitates a smooth decrease in the learning rate, thereby improving stability during training. Additionally, half-precision computation (mixed-precision training) is used to enhance memory efficiency and accelerate the training process.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Sun Oct  6 06:27:53 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
