<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2202.09848] Personalized Federated Learning with Exact Stochastic Gradient Descent</title><meta property="og:description" content="In Federated Learning (FL), datasets across clients tend to be heterogeneous or personalized, and this poses challenges to the convergence of standard FL schemes that do not account for personalization. To address this…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Personalized Federated Learning with Exact Stochastic Gradient Descent">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Personalized Federated Learning with Exact Stochastic Gradient Descent">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2202.09848">

<!--Generated on Thu Mar  7 18:22:52 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Machine Learning,  ICML">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Personalized Federated Learning with Exact Stochastic Gradient Descent</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sotirios Nikoloutsopoulos
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Iordanis Koutsopoulos
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Michalis K. Titsias
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">In Federated Learning (FL), datasets across clients tend to be heterogeneous or <em id="id1.id1.1" class="ltx_emph ltx_font_italic">personalized</em>, and this poses challenges to the convergence of standard FL schemes that do not account for personalization. To address this, we present a new approach for personalized FL that achieves exact stochastic gradient descent (SGD) minimization.
We start from the FedPer <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite> neural network (NN) architecture for personalization, whereby the NN has two types of layers: the first ones are the common layers across clients, while the few final ones are client-specific and are needed for personalization. We propose a novel SGD-type scheme where, at each optimization round, randomly selected clients perform gradient-descent updates over their client-specific weights towards optimizing the loss function on their own datasets, without updating the common weights. At the final update, each client computes the joint gradient over both client-specific and common weights and returns the gradient of common parameters to the server. This allows to perform an exact and unbiased SGD step over the full set of parameters in a distributed manner, i.e. the updates of the personalized parameters are performed by the clients and those of the common ones by the server.
Our method is superior to FedAvg and FedPer baselines in
multi-class classification benchmarks such as Omniglot, CIFAR-10, MNIST, Fashion-MNIST, and EMNIST and has much lower computational complexity per round.
</p>
</div>
<div class="ltx_keywords">Machine Learning, ICML
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.2" class="ltx_p">Federated learning (FL) aims at training global Machine Learning (ML) models out of distributed datasets in different clients <cite class="ltx_cite ltx_citemacro_citep">(Shen et al., <a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite> so as to overcome privacy concerns.
Chronologically, the first FL algorithm is FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite>. In FedAvg, at each round, the server selects a subset of clients and sends them the current model parameters. The clients update model parameters locally by performing a number <math id="S1.p1.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S1.p1.1.m1.1a"><mi id="S1.p1.1.m1.1.1" xref="S1.p1.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S1.p1.1.m1.1b"><ci id="S1.p1.1.m1.1.1.cmml" xref="S1.p1.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.1.m1.1c">E</annotation></semantics></math> of local gradient update steps towards optimizing their loss function and return the locally optimized parameters to the server, which averages them and sends them back to the clients. For <math id="S1.p1.2.m2.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="S1.p1.2.m2.1a"><mrow id="S1.p1.2.m2.1.1" xref="S1.p1.2.m2.1.1.cmml"><mi id="S1.p1.2.m2.1.1.2" xref="S1.p1.2.m2.1.1.2.cmml">E</mi><mo id="S1.p1.2.m2.1.1.1" xref="S1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S1.p1.2.m2.1.1.3" xref="S1.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S1.p1.2.m2.1b"><apply id="S1.p1.2.m2.1.1.cmml" xref="S1.p1.2.m2.1.1"><eq id="S1.p1.2.m2.1.1.1.cmml" xref="S1.p1.2.m2.1.1.1"></eq><ci id="S1.p1.2.m2.1.1.2.cmml" xref="S1.p1.2.m2.1.1.2">𝐸</ci><cn type="integer" id="S1.p1.2.m2.1.1.3.cmml" xref="S1.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p1.2.m2.1c">E=1</annotation></semantics></math>, FedAvg is called Federated Stochastic Gradient Descent <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al., <a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite>.
FedAvg notoriously suffers from data heterogeneity that arises when each client
has to solve its own
<em id="S1.p1.2.1" class="ltx_emph ltx_font_italic">personalized</em> task, i.e. when the clients’ datasets are drawn from different distributions.
In such cases, a shared global model and
an naive aggregation of its parameters could lead to convergence to a stationary point which is far from optimal <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib19" title="" class="ltx_ref">2020d</a>)</cite>. Several extensions of FedAvg have been proposed, see e.g. <cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a href="#bib.bib18" title="" class="ltx_ref">2020c</a>, <a href="#bib.bib17" title="" class="ltx_ref">b</a>); Wang et al. (<a href="#bib.bib30" title="" class="ltx_ref">2020</a>); Reddi et al. (<a href="#bib.bib23" title="" class="ltx_ref">2021</a>); Liu et al. (<a href="#bib.bib20" title="" class="ltx_ref">2019</a>); Yu et al. (<a href="#bib.bib35" title="" class="ltx_ref">2019</a>)</cite>, that try to improve the behaviour of the algorithm in heterogeneity settings. While such methods can improve convergence still try to learn a fully shared/global ML model across heterogeneous clients. From modelling perspective, this might not be the best choice since it ignores <em id="S1.p1.2.2" class="ltx_emph ltx_font_italic">client personalization</em>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Personalized Federated Learning arises often in real-life applications, such as next word prediction <cite class="ltx_cite ltx_citemacro_citep">(Hard et al., <a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite>, emoji prediction <cite class="ltx_cite ltx_citemacro_citep">(Ramaswamy et al., <a href="#bib.bib22" title="" class="ltx_ref">2019</a>; Lee et al., <a href="#bib.bib15" title="" class="ltx_ref">2021</a>)</cite>, health monitoring <cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a href="#bib.bib32" title="" class="ltx_ref">2020</a>)</cite> and personalized healthcare via wearable devices <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib5" title="" class="ltx_ref">2021</a>)</cite>. Data heterogeneity is a common challenge in (personalized) FL algorithms <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib18" title="" class="ltx_ref">2020c</a>, <a href="#bib.bib16" title="" class="ltx_ref">a</a>)</cite>. If the local datasets among clients are drawn from different data distributions <cite class="ltx_cite ltx_citemacro_citep">(Konečný et al., <a href="#bib.bib12" title="" class="ltx_ref">2016</a>)</cite>, then the prevalent way in which FL is done is not suited to produce a global model that will perform well at the specific ML task of each client. As a result, the training process can be slow or even diverge. Although data heterogeneity exists among clients, we allow clients to share common weights because each client cannot produce a good and robust model on their own, due to insufficient amount of data <cite class="ltx_cite ltx_citemacro_citep">(Konečný et al., <a href="#bib.bib12" title="" class="ltx_ref">2016</a>; Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In this work, in order to address data heterogeneity in personalized FL, we consider the classic feature transfer or multi-task learning model that uses parameter sharing in deep forward neural networks <cite class="ltx_cite ltx_citemacro_citep">(Caruana, <a href="#bib.bib3" title="" class="ltx_ref">1997</a>; Ruder, <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite>. This assumes that along with the global or shared model parameters, obtained by a set of backbone neural network layers, for each client there exists an additional set of client-specific output layers with client-specific parameters. Each such parameter set is exclusive to the client, and its purpose is to allow for more flexible modelling of the client-specific data distribution or task. Such a multi-task setting was also used by
<cite class="ltx_cite ltx_citemacro_citet">Arivazhagan et al. (<a href="#bib.bib1" title="" class="ltx_ref">2019</a>); Singhal et al. (<a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>, from which our work differs significantly in the way we train the FL system;
see related work in Section <a href="#S2" title="2 Related Work ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">We propose a new approach for personalized FL, which we call Personalized Federated Learning with Exact Gradient-based Optimization (PFLEGO); see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Its main asset is that it achieves exact stochastic gradient descent (SGD) <cite class="ltx_cite ltx_citemacro_citep">(Robbins &amp; Monro, <a href="#bib.bib25" title="" class="ltx_ref">1951</a>; Bottou, <a href="#bib.bib2" title="" class="ltx_ref">2010</a>)</cite> minimization of the training loss function, which is the <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">exact equivalent</span> of training with all data concentrated in one place. Our starting point is the FedPer neural network (NN) architecture for personalization <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite> (see also <cite class="ltx_cite ltx_citemacro_citet">Singhal et al. (<a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>), whereby the NN has two types of layers: the first ones are common layers, while the few last ones are the client-specific ones used for personalization.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">At each optimization round, our algorithm performs the following steps: (a) The server sends to a randomly selected subset of clients the updated weights corresponding to common layers; (b) Given the common weights, each client performs a number of local gradient descent updates of its client-specific weights on its own dataset towards optimizing the loss function, without updating the common weights; (c) Contrary to other methods that we compare against i.e. FedPer, FedAvg, in our approach each client at their final optimization step computes the joint gradient over both the client-specific and the common weights and sends to the server the gradient of the common weights, rather than the raw weights themselves; (d) Finally the server aggregates the gradients of common weights. The sequence of the last two (c)-(d) steps turns out to be the precise equivalent of an SGD update over the full set of parameters that is performed by the clients and the server in a distributed manner.
The process continues until convergence.
</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">We validate the superiority of our method over FedAvg and FedPer on benchmarks in multi-class classification such as MNIST, CIFAR-10, Fashion-MNIST, EMNIST and Omniglot. The experimental study shows that our algorithm leads to lower training loss and thus much more effective learning especially in cases where personalized models need to be trained for each client. Our algorithm has much lower, O(1) computational complexity per round compared to O(<math id="S1.p6.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S1.p6.1.m1.1a"><mi id="S1.p6.1.m1.1.1" xref="S1.p6.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S1.p6.1.m1.1b"><ci id="S1.p6.1.m1.1.1.cmml" xref="S1.p6.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p6.1.m1.1c">\tau</annotation></semantics></math>) of baselines, thus leading to less energy consumption.</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">The paper is organized as follows. In section 2, we present the related work and compare our proposed approach against prior work; in section 3 we present our approach and present formal evidence to back up the claims about convergence; in section 4 we present experimental evaluation results, and in section 5 we conclude the paper.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<br class="ltx_break"><img src="/html/2202.09848/assets/x1.png" id="S1.F1.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="178" height="97" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Depiction of the training process of the PFLEGO algorithm with <math id="S1.F1.3.2.m1.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S1.F1.3.2.m1.1b"><mi id="S1.F1.3.2.m1.1.1" xref="S1.F1.3.2.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S1.F1.3.2.m1.1c"><ci id="S1.F1.3.2.m1.1.1.cmml" xref="S1.F1.3.2.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.3.2.m1.1d">I</annotation></semantics></math> clients and a single server for one communication round. The numbers in the arcs display the sequence of the execution steps. </figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Personalized FL by fine tuning a global model.</h5>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">One approach to deal with personalization in FL is to allow clients to fine tune the shared global model using local adaptation <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib31" title="" class="ltx_ref">2019</a>; Yu et al., <a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite>, or techniques inspired by meta-learning
<cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib4" title="" class="ltx_ref">2019</a>; Dinh et al., <a href="#bib.bib6" title="" class="ltx_ref">2022</a>; Fallah et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Jiang et al., <a href="#bib.bib10" title="" class="ltx_ref">2019</a>)</cite>.
These methods differ significantly from ours since they require communicating
the full set of parameters of a shared global model (i.e. there is no client-specific model part) between the server and the clients. Note also that fine tuning can be expensive since it requires the individual clients to adapt the full parameter vector of a deep NN.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Personalized FL by feature transfer.</h5>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">Our approach mostly relates to methods that achieve personalization in FL by using a multi-task of feature transfer model, similarly to traditional non-distributed multi-task architectures <cite class="ltx_cite ltx_citemacro_citep">(Caruana, <a href="#bib.bib3" title="" class="ltx_ref">1997</a>; Ruder, <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite>.
This aims to learn a NN whose parameters consist of a common part (also called global or shared) for all clients, and a client-specific part (also called personalized).
This approach was followed by <cite class="ltx_cite ltx_citemacro_citet">Arivazhagan et al. (<a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite>. However, the optimization algorithm in <cite class="ltx_cite ltx_citemacro_citet">Arivazhagan et al. (<a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite> differs from our method, as it is based on the standard FedAvg scheme. Specifically, the clients update both the global and the personalized parameters by executing joint gradient descent steps. Then, each client sends back to the server the locally updated global parameters and the server updates the global parameters through averaging. Their method reduces to standard FedAvg when there are no client-specific parameters. In contrast, in our method the clients return gradients over the global parameters, in a way that our FL algorithm performs exact SGD steps.
In another related work FedRecon <cite class="ltx_cite ltx_citemacro_citep">(Singhal et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>, similarly to FedPer <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite>, a set of global and client-specific parameters are learned, but at each round their optimization algorithm does not update simultaneously the global and personalized parameters, and therefore their method can be considered as performing block coordinate optimization.
In contrast, our distributed optimization algorithm incorporates <span id="S2.SS0.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_italic">exact</span> SGD steps where the full set of model parameters are simultaneously updated. This latter
property means that our method enjoys theoretical convergence guarantees similar to SGD schemes <cite class="ltx_cite ltx_citemacro_citep">(Robbins &amp; Monro, <a href="#bib.bib25" title="" class="ltx_ref">1951</a>; Bottou, <a href="#bib.bib2" title="" class="ltx_ref">2010</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">FL with gradient return.</h5>

<div id="S2.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px3.p1.1" class="ltx_p">Finally, there exist non-personalized FL algorithms optimizing a set of global parameters, where gradients are returned to the server <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a href="#bib.bib34" title="" class="ltx_ref">2020</a>; Ren et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>. In <cite class="ltx_cite ltx_citemacro_citet">Yao et al. (<a href="#bib.bib34" title="" class="ltx_ref">2020</a>)</cite>, each client performs many training steps over local copies of the global parameters and returns to the server the final gradient (after the final iteration) of these parameters, which then aggregates them by performing a gradient step.
However, convergence is guaranteed only in the special case that the client performs a single iteration so that their algorithm reduces to SGD optimization. The work by <cite class="ltx_cite ltx_citemacro_citet">Ren et al. (<a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite> tries to accelerate training by optimizing batch size. Specifically, clients sample a batch over their private datasets and perform a single gradient step to update their local copies of global parameters, and then they return the gradient to the server. This work differs from our method, since it does not deal with personalized settings. In our scheme, the clients may perform multiple gradient steps over the client-specific parameters before returning the gradient of global parameters to the server.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Proposed Framework</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Personalized FL Setting</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.11" class="ltx_p">We consider a supervised FL setting in which there is a server and <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">I</annotation></semantics></math> clients. Each client has a locally stored dataset <math id="S3.SS1.p1.2.m2.2" class="ltx_Math" alttext="\mathcal{D}_{i}=(X_{i},Y_{i})" display="inline"><semantics id="S3.SS1.p1.2.m2.2a"><mrow id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml"><msub id="S3.SS1.p1.2.m2.2.2.4" xref="S3.SS1.p1.2.m2.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.2.2.4.2" xref="S3.SS1.p1.2.m2.2.2.4.2.cmml">𝒟</mi><mi id="S3.SS1.p1.2.m2.2.2.4.3" xref="S3.SS1.p1.2.m2.2.2.4.3.cmml">i</mi></msub><mo id="S3.SS1.p1.2.m2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.3.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">(</mo><msub id="S3.SS1.p1.2.m2.1.1.1.1.1" xref="S3.SS1.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2.cmml">X</mi><mi id="S3.SS1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.p1.2.m2.2.2.2.2.4" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.2.m2.2.2.2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.2.2.2.cmml">Y</mi><mi id="S3.SS1.p1.2.m2.2.2.2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.p1.2.m2.2.2.2.2.5" xref="S3.SS1.p1.2.m2.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><apply id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2"><eq id="S3.SS1.p1.2.m2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.3"></eq><apply id="S3.SS1.p1.2.m2.2.2.4.cmml" xref="S3.SS1.p1.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.4.1.cmml" xref="S3.SS1.p1.2.m2.2.2.4">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.4.2.cmml" xref="S3.SS1.p1.2.m2.2.2.4.2">𝒟</ci><ci id="S3.SS1.p1.2.m2.2.2.4.3.cmml" xref="S3.SS1.p1.2.m2.2.2.4.3">𝑖</ci></apply><interval closure="open" id="S3.SS1.p1.2.m2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2"><apply id="S3.SS1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.2">𝑋</ci><ci id="S3.SS1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.SS1.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.2">𝑌</ci><ci id="S3.SS1.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">\mathcal{D}_{i}=(X_{i},Y_{i})</annotation></semantics></math>, where <math id="S3.SS1.p1.3.m3.3" class="ltx_Math" alttext="X_{i}=\{x_{i,j}\}_{j=1}^{N_{i}}" display="inline"><semantics id="S3.SS1.p1.3.m3.3a"><mrow id="S3.SS1.p1.3.m3.3.3" xref="S3.SS1.p1.3.m3.3.3.cmml"><msub id="S3.SS1.p1.3.m3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.3.cmml"><mi id="S3.SS1.p1.3.m3.3.3.3.2" xref="S3.SS1.p1.3.m3.3.3.3.2.cmml">X</mi><mi id="S3.SS1.p1.3.m3.3.3.3.3" xref="S3.SS1.p1.3.m3.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS1.p1.3.m3.3.3.2" xref="S3.SS1.p1.3.m3.3.3.2.cmml">=</mo><msubsup id="S3.SS1.p1.3.m3.3.3.1" xref="S3.SS1.p1.3.m3.3.3.1.cmml"><mrow id="S3.SS1.p1.3.m3.3.3.1.1.1.1" xref="S3.SS1.p1.3.m3.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.3.m3.3.3.1.1.1.1.2" xref="S3.SS1.p1.3.m3.3.3.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.3.m3.3.3.1.1.1.1.1" xref="S3.SS1.p1.3.m3.3.3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.3.m3.3.3.1.1.1.1.1.2" xref="S3.SS1.p1.3.m3.3.3.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS1.p1.3.m3.2.2.2.4" xref="S3.SS1.p1.3.m3.2.2.2.3.cmml"><mi id="S3.SS1.p1.3.m3.1.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.3.m3.2.2.2.4.1" xref="S3.SS1.p1.3.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.3.m3.2.2.2.2" xref="S3.SS1.p1.3.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p1.3.m3.3.3.1.1.1.1.3" xref="S3.SS1.p1.3.m3.3.3.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.3.m3.3.3.1.1.3" xref="S3.SS1.p1.3.m3.3.3.1.1.3.cmml"><mi id="S3.SS1.p1.3.m3.3.3.1.1.3.2" xref="S3.SS1.p1.3.m3.3.3.1.1.3.2.cmml">j</mi><mo id="S3.SS1.p1.3.m3.3.3.1.1.3.1" xref="S3.SS1.p1.3.m3.3.3.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.3.m3.3.3.1.1.3.3" xref="S3.SS1.p1.3.m3.3.3.1.1.3.3.cmml">1</mn></mrow><msub id="S3.SS1.p1.3.m3.3.3.1.3" xref="S3.SS1.p1.3.m3.3.3.1.3.cmml"><mi id="S3.SS1.p1.3.m3.3.3.1.3.2" xref="S3.SS1.p1.3.m3.3.3.1.3.2.cmml">N</mi><mi id="S3.SS1.p1.3.m3.3.3.1.3.3" xref="S3.SS1.p1.3.m3.3.3.1.3.3.cmml">i</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.3b"><apply id="S3.SS1.p1.3.m3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3"><eq id="S3.SS1.p1.3.m3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.3.3.2"></eq><apply id="S3.SS1.p1.3.m3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.3.2.cmml" xref="S3.SS1.p1.3.m3.3.3.3.2">𝑋</ci><ci id="S3.SS1.p1.3.m3.3.3.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.3.3">𝑖</ci></apply><apply id="S3.SS1.p1.3.m3.3.3.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.1.2.cmml" xref="S3.SS1.p1.3.m3.3.3.1">superscript</csymbol><apply id="S3.SS1.p1.3.m3.3.3.1.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.3.3.1">subscript</csymbol><set id="S3.SS1.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.1"><apply id="S3.SS1.p1.3.m3.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.1.1.1.2">𝑥</ci><list id="S3.SS1.p1.3.m3.2.2.2.3.cmml" xref="S3.SS1.p1.3.m3.2.2.2.4"><ci id="S3.SS1.p1.3.m3.1.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.3.m3.2.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.2.2">𝑗</ci></list></apply></set><apply id="S3.SS1.p1.3.m3.3.3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.3"><eq id="S3.SS1.p1.3.m3.3.3.1.1.3.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.3.1"></eq><ci id="S3.SS1.p1.3.m3.3.3.1.1.3.2.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS1.p1.3.m3.3.3.1.1.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.3.m3.3.3.1.3.cmml" xref="S3.SS1.p1.3.m3.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.3.3.1.3.1.cmml" xref="S3.SS1.p1.3.m3.3.3.1.3">subscript</csymbol><ci id="S3.SS1.p1.3.m3.3.3.1.3.2.cmml" xref="S3.SS1.p1.3.m3.3.3.1.3.2">𝑁</ci><ci id="S3.SS1.p1.3.m3.3.3.1.3.3.cmml" xref="S3.SS1.p1.3.m3.3.3.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.3c">X_{i}=\{x_{i,j}\}_{j=1}^{N_{i}}</annotation></semantics></math> are the input data samples (e.g. images) and <math id="S3.SS1.p1.4.m4.3" class="ltx_Math" alttext="Y_{i}=\{y_{i,j}\}_{j=1}^{N_{i}}" display="inline"><semantics id="S3.SS1.p1.4.m4.3a"><mrow id="S3.SS1.p1.4.m4.3.3" xref="S3.SS1.p1.4.m4.3.3.cmml"><msub id="S3.SS1.p1.4.m4.3.3.3" xref="S3.SS1.p1.4.m4.3.3.3.cmml"><mi id="S3.SS1.p1.4.m4.3.3.3.2" xref="S3.SS1.p1.4.m4.3.3.3.2.cmml">Y</mi><mi id="S3.SS1.p1.4.m4.3.3.3.3" xref="S3.SS1.p1.4.m4.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS1.p1.4.m4.3.3.2" xref="S3.SS1.p1.4.m4.3.3.2.cmml">=</mo><msubsup id="S3.SS1.p1.4.m4.3.3.1" xref="S3.SS1.p1.4.m4.3.3.1.cmml"><mrow id="S3.SS1.p1.4.m4.3.3.1.1.1.1" xref="S3.SS1.p1.4.m4.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.4.m4.3.3.1.1.1.1.2" xref="S3.SS1.p1.4.m4.3.3.1.1.1.2.cmml">{</mo><msub id="S3.SS1.p1.4.m4.3.3.1.1.1.1.1" xref="S3.SS1.p1.4.m4.3.3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.4.m4.3.3.1.1.1.1.1.2" xref="S3.SS1.p1.4.m4.3.3.1.1.1.1.1.2.cmml">y</mi><mrow id="S3.SS1.p1.4.m4.2.2.2.4" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml"><mi id="S3.SS1.p1.4.m4.1.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.4.m4.2.2.2.4.1" xref="S3.SS1.p1.4.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.p1.4.m4.2.2.2.2" xref="S3.SS1.p1.4.m4.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S3.SS1.p1.4.m4.3.3.1.1.1.1.3" xref="S3.SS1.p1.4.m4.3.3.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.p1.4.m4.3.3.1.1.3" xref="S3.SS1.p1.4.m4.3.3.1.1.3.cmml"><mi id="S3.SS1.p1.4.m4.3.3.1.1.3.2" xref="S3.SS1.p1.4.m4.3.3.1.1.3.2.cmml">j</mi><mo id="S3.SS1.p1.4.m4.3.3.1.1.3.1" xref="S3.SS1.p1.4.m4.3.3.1.1.3.1.cmml">=</mo><mn id="S3.SS1.p1.4.m4.3.3.1.1.3.3" xref="S3.SS1.p1.4.m4.3.3.1.1.3.3.cmml">1</mn></mrow><msub id="S3.SS1.p1.4.m4.3.3.1.3" xref="S3.SS1.p1.4.m4.3.3.1.3.cmml"><mi id="S3.SS1.p1.4.m4.3.3.1.3.2" xref="S3.SS1.p1.4.m4.3.3.1.3.2.cmml">N</mi><mi id="S3.SS1.p1.4.m4.3.3.1.3.3" xref="S3.SS1.p1.4.m4.3.3.1.3.3.cmml">i</mi></msub></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.3b"><apply id="S3.SS1.p1.4.m4.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3"><eq id="S3.SS1.p1.4.m4.3.3.2.cmml" xref="S3.SS1.p1.4.m4.3.3.2"></eq><apply id="S3.SS1.p1.4.m4.3.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.3.1.cmml" xref="S3.SS1.p1.4.m4.3.3.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.3.2.cmml" xref="S3.SS1.p1.4.m4.3.3.3.2">𝑌</ci><ci id="S3.SS1.p1.4.m4.3.3.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3.3.3">𝑖</ci></apply><apply id="S3.SS1.p1.4.m4.3.3.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.1.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1">superscript</csymbol><apply id="S3.SS1.p1.4.m4.3.3.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.1.1.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1">subscript</csymbol><set id="S3.SS1.p1.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.1.1"><apply id="S3.SS1.p1.4.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.1.1.1.2">𝑦</ci><list id="S3.SS1.p1.4.m4.2.2.2.3.cmml" xref="S3.SS1.p1.4.m4.2.2.2.4"><ci id="S3.SS1.p1.4.m4.1.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1.1">𝑖</ci><ci id="S3.SS1.p1.4.m4.2.2.2.2.cmml" xref="S3.SS1.p1.4.m4.2.2.2.2">𝑗</ci></list></apply></set><apply id="S3.SS1.p1.4.m4.3.3.1.1.3.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.3"><eq id="S3.SS1.p1.4.m4.3.3.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.3.1"></eq><ci id="S3.SS1.p1.4.m4.3.3.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.3.2">𝑗</ci><cn type="integer" id="S3.SS1.p1.4.m4.3.3.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3.1.1.3.3">1</cn></apply></apply><apply id="S3.SS1.p1.4.m4.3.3.1.3.cmml" xref="S3.SS1.p1.4.m4.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.3.3.1.3.1.cmml" xref="S3.SS1.p1.4.m4.3.3.1.3">subscript</csymbol><ci id="S3.SS1.p1.4.m4.3.3.1.3.2.cmml" xref="S3.SS1.p1.4.m4.3.3.1.3.2">𝑁</ci><ci id="S3.SS1.p1.4.m4.3.3.1.3.3.cmml" xref="S3.SS1.p1.4.m4.3.3.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.3c">Y_{i}=\{y_{i,j}\}_{j=1}^{N_{i}}</annotation></semantics></math> are the corresponding target outputs (e.g. class labels).
The objective of FL is to optimize a shared or global model, together with personalized or client-specific parameters, by utilising all datasets locally stored at clients. As a shared backbone model we assume a deep neural network that consists of a number of common layers with overall parameters <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\theta</annotation></semantics></math>. The number of outputs of the common layers, i.e. the size of the <em id="S3.SS1.p1.11.1" class="ltx_emph ltx_font_italic">feature vector</em>, is <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">M</annotation></semantics></math>. More precisely, the shared model receives an input <math id="S3.SS1.p1.7.m7.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">x</annotation></semantics></math> and constructs in its final output a representation or feature vector <math id="S3.SS1.p1.8.m8.2" class="ltx_Math" alttext="\phi(x;\theta)\in\mathbb{R}^{M}" display="inline"><semantics id="S3.SS1.p1.8.m8.2a"><mrow id="S3.SS1.p1.8.m8.2.3" xref="S3.SS1.p1.8.m8.2.3.cmml"><mrow id="S3.SS1.p1.8.m8.2.3.2" xref="S3.SS1.p1.8.m8.2.3.2.cmml"><mi id="S3.SS1.p1.8.m8.2.3.2.2" xref="S3.SS1.p1.8.m8.2.3.2.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.8.m8.2.3.2.1" xref="S3.SS1.p1.8.m8.2.3.2.1.cmml">​</mo><mrow id="S3.SS1.p1.8.m8.2.3.2.3.2" xref="S3.SS1.p1.8.m8.2.3.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.8.m8.2.3.2.3.2.1" xref="S3.SS1.p1.8.m8.2.3.2.3.1.cmml">(</mo><mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">x</mi><mo id="S3.SS1.p1.8.m8.2.3.2.3.2.2" xref="S3.SS1.p1.8.m8.2.3.2.3.1.cmml">;</mo><mi id="S3.SS1.p1.8.m8.2.2" xref="S3.SS1.p1.8.m8.2.2.cmml">θ</mi><mo stretchy="false" id="S3.SS1.p1.8.m8.2.3.2.3.2.3" xref="S3.SS1.p1.8.m8.2.3.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.8.m8.2.3.1" xref="S3.SS1.p1.8.m8.2.3.1.cmml">∈</mo><msup id="S3.SS1.p1.8.m8.2.3.3" xref="S3.SS1.p1.8.m8.2.3.3.cmml"><mi id="S3.SS1.p1.8.m8.2.3.3.2" xref="S3.SS1.p1.8.m8.2.3.3.2.cmml">ℝ</mi><mi id="S3.SS1.p1.8.m8.2.3.3.3" xref="S3.SS1.p1.8.m8.2.3.3.3.cmml">M</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.2b"><apply id="S3.SS1.p1.8.m8.2.3.cmml" xref="S3.SS1.p1.8.m8.2.3"><in id="S3.SS1.p1.8.m8.2.3.1.cmml" xref="S3.SS1.p1.8.m8.2.3.1"></in><apply id="S3.SS1.p1.8.m8.2.3.2.cmml" xref="S3.SS1.p1.8.m8.2.3.2"><times id="S3.SS1.p1.8.m8.2.3.2.1.cmml" xref="S3.SS1.p1.8.m8.2.3.2.1"></times><ci id="S3.SS1.p1.8.m8.2.3.2.2.cmml" xref="S3.SS1.p1.8.m8.2.3.2.2">italic-ϕ</ci><list id="S3.SS1.p1.8.m8.2.3.2.3.1.cmml" xref="S3.SS1.p1.8.m8.2.3.2.3.2"><ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">𝑥</ci><ci id="S3.SS1.p1.8.m8.2.2.cmml" xref="S3.SS1.p1.8.m8.2.2">𝜃</ci></list></apply><apply id="S3.SS1.p1.8.m8.2.3.3.cmml" xref="S3.SS1.p1.8.m8.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.2.3.3.1.cmml" xref="S3.SS1.p1.8.m8.2.3.3">superscript</csymbol><ci id="S3.SS1.p1.8.m8.2.3.3.2.cmml" xref="S3.SS1.p1.8.m8.2.3.3.2">ℝ</ci><ci id="S3.SS1.p1.8.m8.2.3.3.3.cmml" xref="S3.SS1.p1.8.m8.2.3.3.3">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.2c">\phi(x;\theta)\in\mathbb{R}^{M}</annotation></semantics></math>. Each client has a copy of the same network architecture corresponding to this shared representation. Each client <math id="S3.SS1.p1.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">i</annotation></semantics></math> has an additional set of personalized layers attached as a head to <math id="S3.SS1.p1.10.m10.2" class="ltx_Math" alttext="\phi(x;\theta)" display="inline"><semantics id="S3.SS1.p1.10.m10.2a"><mrow id="S3.SS1.p1.10.m10.2.3" xref="S3.SS1.p1.10.m10.2.3.cmml"><mi id="S3.SS1.p1.10.m10.2.3.2" xref="S3.SS1.p1.10.m10.2.3.2.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p1.10.m10.2.3.1" xref="S3.SS1.p1.10.m10.2.3.1.cmml">​</mo><mrow id="S3.SS1.p1.10.m10.2.3.3.2" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS1.p1.10.m10.2.3.3.2.1" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">(</mo><mi id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml">x</mi><mo id="S3.SS1.p1.10.m10.2.3.3.2.2" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">;</mo><mi id="S3.SS1.p1.10.m10.2.2" xref="S3.SS1.p1.10.m10.2.2.cmml">θ</mi><mo stretchy="false" id="S3.SS1.p1.10.m10.2.3.3.2.3" xref="S3.SS1.p1.10.m10.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.2b"><apply id="S3.SS1.p1.10.m10.2.3.cmml" xref="S3.SS1.p1.10.m10.2.3"><times id="S3.SS1.p1.10.m10.2.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.1"></times><ci id="S3.SS1.p1.10.m10.2.3.2.cmml" xref="S3.SS1.p1.10.m10.2.3.2">italic-ϕ</ci><list id="S3.SS1.p1.10.m10.2.3.3.1.cmml" xref="S3.SS1.p1.10.m10.2.3.3.2"><ci id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1">𝑥</ci><ci id="S3.SS1.p1.10.m10.2.2.cmml" xref="S3.SS1.p1.10.m10.2.2">𝜃</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.2c">\phi(x;\theta)</annotation></semantics></math>. For simplicity, we assume that the personalized layers consist of a single linear output layer with weights <math id="S3.SS1.p1.11.m11.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS1.p1.11.m11.1a"><msub id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">W</mi><mi id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝑊</ci><ci id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">W_{i}</annotation></semantics></math>; see Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section id="S3.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1 </span>Training Objective for Classification</h4>

<div id="S3.SS1.SSS1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.p1.3" class="ltx_p">The learning objective is to train the neural network model by adapting the global parameters <math id="S3.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.SSS1.p1.1.m1.1a"><mi id="S3.SS1.SSS1.p1.1.m1.1.1" xref="S3.SS1.SSS1.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.1.m1.1b"><ci id="S3.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.1.m1.1c">\theta</annotation></semantics></math> and the personalized parameters <math id="S3.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\{W_{i}\}_{i=1}^{I}" display="inline"><semantics id="S3.SS1.SSS1.p1.2.m2.1a"><msubsup id="S3.SS1.SSS1.p1.2.m2.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.cmml"><mrow id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.2" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS1.SSS1.p1.2.m2.1.1.1.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.3.cmml"><mi id="S3.SS1.SSS1.p1.2.m2.1.1.1.3.2" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.3.2.cmml">i</mi><mo id="S3.SS1.SSS1.p1.2.m2.1.1.1.3.1" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.3.1.cmml">=</mo><mn id="S3.SS1.SSS1.p1.2.m2.1.1.1.3.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS1.SSS1.p1.2.m2.1.1.3" xref="S3.SS1.SSS1.p1.2.m2.1.1.3.cmml">I</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.2.m2.1b"><apply id="S3.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">superscript</csymbol><apply id="S3.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.2.m2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1">subscript</csymbol><set id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1"><apply id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS1.SSS1.p1.2.m2.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.3"><eq id="S3.SS1.SSS1.p1.2.m2.1.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.3.1"></eq><ci id="S3.SS1.SSS1.p1.2.m2.1.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.3.2">𝑖</ci><cn type="integer" id="S3.SS1.SSS1.p1.2.m2.1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS1.p1.2.m2.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.2.m2.1c">\{W_{i}\}_{i=1}^{I}</annotation></semantics></math>. The full set of parameters is denoted by <math id="S3.SS1.SSS1.p1.3.m3.4" class="ltx_Math" alttext="\psi=\{\theta,W_{1},\ldots,W_{I}\}" display="inline"><semantics id="S3.SS1.SSS1.p1.3.m3.4a"><mrow id="S3.SS1.SSS1.p1.3.m3.4.4" xref="S3.SS1.SSS1.p1.3.m3.4.4.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.4.4.4" xref="S3.SS1.SSS1.p1.3.m3.4.4.4.cmml">ψ</mi><mo id="S3.SS1.SSS1.p1.3.m3.4.4.3" xref="S3.SS1.SSS1.p1.3.m3.4.4.3.cmml">=</mo><mrow id="S3.SS1.SSS1.p1.3.m3.4.4.2.2" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.3" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.3.cmml">{</mo><mi id="S3.SS1.SSS1.p1.3.m3.1.1" xref="S3.SS1.SSS1.p1.3.m3.1.1.cmml">θ</mi><mo id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.4" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.3.cmml">,</mo><msub id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.2" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.2.cmml">W</mi><mn id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.3" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.5" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS1.p1.3.m3.2.2" xref="S3.SS1.SSS1.p1.3.m3.2.2.cmml">…</mi><mo id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.6" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.3.cmml">,</mo><msub id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.2" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.2.cmml">W</mi><mi id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.3" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.3.cmml">I</mi></msub><mo stretchy="false" id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.7" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.3.m3.4b"><apply id="S3.SS1.SSS1.p1.3.m3.4.4.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4"><eq id="S3.SS1.SSS1.p1.3.m3.4.4.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4.3"></eq><ci id="S3.SS1.SSS1.p1.3.m3.4.4.4.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4.4">𝜓</ci><set id="S3.SS1.SSS1.p1.3.m3.4.4.2.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2"><ci id="S3.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.1.1">𝜃</ci><apply id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.2">𝑊</ci><cn type="integer" id="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS1.SSS1.p1.3.m3.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.2.2">…</ci><apply id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.2">𝑊</ci><ci id="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.3.m3.4.4.2.2.2.3">𝐼</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.3.m3.4c">\psi=\{\theta,W_{1},\ldots,W_{I}\}</annotation></semantics></math>. Learning requires the minimization of the following training loss function that aggregates all client datasets:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\mathcal{L}(\psi)=\sum_{i=1}^{I}\alpha_{i}\ell_{i}(W_{i},\theta)," display="block"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.3.1" xref="S3.E1.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.3.2.1" xref="S3.E1.m1.3.3.1.1.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">ψ</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.3.2.2" xref="S3.E1.m1.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml"><munderover id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.3.3.1.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.2.2.3.2" xref="S3.E1.m1.3.3.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.1.2.2.3.1" xref="S3.E1.m1.3.3.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.3.3.1.1.1.2.2.3.3" xref="S3.E1.m1.3.3.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.3.3.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.2.3.cmml">I</mi></munderover><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.cmml">α</mi><mi id="S3.E1.m1.3.3.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">​</mo><msub id="S3.E1.m1.3.3.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.4.cmml"><mi mathvariant="normal" id="S3.E1.m1.3.3.1.1.1.1.4.2" xref="S3.E1.m1.3.3.1.1.1.1.4.2.cmml">ℓ</mi><mi id="S3.E1.m1.3.3.1.1.1.1.4.3" xref="S3.E1.m1.3.3.1.1.1.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.2a" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><eq id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><times id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1"></times><ci id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2">ℒ</ci><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝜓</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.3.3.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.2.2.3"><eq id="S3.E1.m1.3.3.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.3.3.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.3.3.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.3.3.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.2.3">𝐼</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"></times><apply id="S3.E1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2">𝛼</ci><ci id="S3.E1.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.4.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.4">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.4.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.4.2">ℓ</ci><ci id="S3.E1.m1.3.3.1.1.1.1.4.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.4.3">𝑖</ci></apply><interval closure="open" id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1"><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝜃</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\mathcal{L}(\psi)=\sum_{i=1}^{I}\alpha_{i}\ell_{i}(W_{i},\theta),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.5" class="ltx_p">where each scalar <math id="S3.SS1.SSS1.p1.4.m1.1" class="ltx_Math" alttext="\alpha_{i}=\frac{N_{i}}{\sum_{j=1}N_{j}}" display="inline"><semantics id="S3.SS1.SSS1.p1.4.m1.1a"><mrow id="S3.SS1.SSS1.p1.4.m1.1.1" xref="S3.SS1.SSS1.p1.4.m1.1.1.cmml"><msub id="S3.SS1.SSS1.p1.4.m1.1.1.2" xref="S3.SS1.SSS1.p1.4.m1.1.1.2.cmml"><mi id="S3.SS1.SSS1.p1.4.m1.1.1.2.2" xref="S3.SS1.SSS1.p1.4.m1.1.1.2.2.cmml">α</mi><mi id="S3.SS1.SSS1.p1.4.m1.1.1.2.3" xref="S3.SS1.SSS1.p1.4.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.p1.4.m1.1.1.1" xref="S3.SS1.SSS1.p1.4.m1.1.1.1.cmml">=</mo><mfrac id="S3.SS1.SSS1.p1.4.m1.1.1.3" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.cmml"><msub id="S3.SS1.SSS1.p1.4.m1.1.1.3.2" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.2.cmml"><mi id="S3.SS1.SSS1.p1.4.m1.1.1.3.2.2" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.2.2.cmml">N</mi><mi id="S3.SS1.SSS1.p1.4.m1.1.1.3.2.3" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.2.3.cmml">i</mi></msub><mrow id="S3.SS1.SSS1.p1.4.m1.1.1.3.3" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.cmml"><mstyle displaystyle="false" id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.cmml"><msub id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1a" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.cmml"><mo id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.2" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.2.cmml">∑</mo><mrow id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.cmml"><mi id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.2" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.2.cmml">j</mi><mo id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.1" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.1.cmml">=</mo><mn id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.3" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.3.cmml">1</mn></mrow></msub></mstyle><msub id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.cmml"><mi id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.2" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.2.cmml">N</mi><mi id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.3" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.3.cmml">j</mi></msub></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.4.m1.1b"><apply id="S3.SS1.SSS1.p1.4.m1.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1"><eq id="S3.SS1.SSS1.p1.4.m1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.1"></eq><apply id="S3.SS1.SSS1.p1.4.m1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.4.m1.1.1.2.1.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.4.m1.1.1.2.2.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.2.2">𝛼</ci><ci id="S3.SS1.SSS1.p1.4.m1.1.1.2.3.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p1.4.m1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3"><divide id="S3.SS1.SSS1.p1.4.m1.1.1.3.1.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3"></divide><apply id="S3.SS1.SSS1.p1.4.m1.1.1.3.2.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.4.m1.1.1.3.2.1.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.4.m1.1.1.3.2.2.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.2.2">𝑁</ci><ci id="S3.SS1.SSS1.p1.4.m1.1.1.3.2.3.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3"><apply id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.1.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1">subscript</csymbol><sum id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.2.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.2"></sum><apply id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3"><eq id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.1.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.1"></eq><ci id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.2.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.2">𝑗</ci><cn type="integer" id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.3.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.1.3.3">1</cn></apply></apply><apply id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.1.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.2.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.2">𝑁</ci><ci id="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.3.cmml" xref="S3.SS1.SSS1.p1.4.m1.1.1.3.3.2.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.4.m1.1c">\alpha_{i}=\frac{N_{i}}{\sum_{j=1}N_{j}}</annotation></semantics></math> quantifies the data proportionality of the different clients, and <math id="S3.SS1.SSS1.p1.5.m2.2" class="ltx_Math" alttext="\ell_{i}(W_{i},\theta)" display="inline"><semantics id="S3.SS1.SSS1.p1.5.m2.2a"><mrow id="S3.SS1.SSS1.p1.5.m2.2.2" xref="S3.SS1.SSS1.p1.5.m2.2.2.cmml"><msub id="S3.SS1.SSS1.p1.5.m2.2.2.3" xref="S3.SS1.SSS1.p1.5.m2.2.2.3.cmml"><mi mathvariant="normal" id="S3.SS1.SSS1.p1.5.m2.2.2.3.2" xref="S3.SS1.SSS1.p1.5.m2.2.2.3.2.cmml">ℓ</mi><mi id="S3.SS1.SSS1.p1.5.m2.2.2.3.3" xref="S3.SS1.SSS1.p1.5.m2.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.5.m2.2.2.2" xref="S3.SS1.SSS1.p1.5.m2.2.2.2.cmml">​</mo><mrow id="S3.SS1.SSS1.p1.5.m2.2.2.1.1" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.5.m2.2.2.1.1.2" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.2.cmml">(</mo><msub id="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.2" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.3" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.p1.5.m2.2.2.1.1.3" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.2.cmml">,</mo><mi id="S3.SS1.SSS1.p1.5.m2.1.1" xref="S3.SS1.SSS1.p1.5.m2.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS1.SSS1.p1.5.m2.2.2.1.1.4" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.5.m2.2b"><apply id="S3.SS1.SSS1.p1.5.m2.2.2.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2"><times id="S3.SS1.SSS1.p1.5.m2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2.2"></times><apply id="S3.SS1.SSS1.p1.5.m2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.5.m2.2.2.3.1.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.5.m2.2.2.3.2.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2.3.2">ℓ</ci><ci id="S3.SS1.SSS1.p1.5.m2.2.2.3.3.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2.3.3">𝑖</ci></apply><interval closure="open" id="S3.SS1.SSS1.p1.5.m2.2.2.1.2.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.1"><apply id="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.2">𝑊</ci><ci id="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS1.p1.5.m2.2.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS1.SSS1.p1.5.m2.1.1.cmml" xref="S3.SS1.SSS1.p1.5.m2.1.1">𝜃</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.5.m2.2c">\ell_{i}(W_{i},\theta)</annotation></semantics></math> is the client-specific loss,</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.7" class="ltx_Math" alttext="\ell_{i}(W_{i},\theta)=\frac{1}{N_{i}}\sum_{j=1}^{N_{i}}\ell(y_{i,j},x_{i,j};W_{i},\theta)." display="block"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1" xref="S3.E2.m1.7.7.1.1.cmml"><mrow id="S3.E2.m1.7.7.1.1.1" xref="S3.E2.m1.7.7.1.1.1.cmml"><msub id="S3.E2.m1.7.7.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.7.7.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.1.3.2.cmml">ℓ</mi><mi id="S3.E2.m1.7.7.1.1.1.3.3" xref="S3.E2.m1.7.7.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.2.cmml">(</mo><msub id="S3.E2.m1.7.7.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E2.m1.7.7.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.2.cmml">,</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.4" xref="S3.E2.m1.7.7.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.7.7.1.1.5" xref="S3.E2.m1.7.7.1.1.5.cmml">=</mo><mrow id="S3.E2.m1.7.7.1.1.4" xref="S3.E2.m1.7.7.1.1.4.cmml"><mfrac id="S3.E2.m1.7.7.1.1.4.5" xref="S3.E2.m1.7.7.1.1.4.5.cmml"><mn id="S3.E2.m1.7.7.1.1.4.5.2" xref="S3.E2.m1.7.7.1.1.4.5.2.cmml">1</mn><msub id="S3.E2.m1.7.7.1.1.4.5.3" xref="S3.E2.m1.7.7.1.1.4.5.3.cmml"><mi id="S3.E2.m1.7.7.1.1.4.5.3.2" xref="S3.E2.m1.7.7.1.1.4.5.3.2.cmml">N</mi><mi id="S3.E2.m1.7.7.1.1.4.5.3.3" xref="S3.E2.m1.7.7.1.1.4.5.3.3.cmml">i</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.4.4" xref="S3.E2.m1.7.7.1.1.4.4.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.4.3" xref="S3.E2.m1.7.7.1.1.4.3.cmml"><munderover id="S3.E2.m1.7.7.1.1.4.3.4" xref="S3.E2.m1.7.7.1.1.4.3.4.cmml"><mo movablelimits="false" id="S3.E2.m1.7.7.1.1.4.3.4.2.2" xref="S3.E2.m1.7.7.1.1.4.3.4.2.2.cmml">∑</mo><mrow id="S3.E2.m1.7.7.1.1.4.3.4.2.3" xref="S3.E2.m1.7.7.1.1.4.3.4.2.3.cmml"><mi id="S3.E2.m1.7.7.1.1.4.3.4.2.3.2" xref="S3.E2.m1.7.7.1.1.4.3.4.2.3.2.cmml">j</mi><mo id="S3.E2.m1.7.7.1.1.4.3.4.2.3.1" xref="S3.E2.m1.7.7.1.1.4.3.4.2.3.1.cmml">=</mo><mn id="S3.E2.m1.7.7.1.1.4.3.4.2.3.3" xref="S3.E2.m1.7.7.1.1.4.3.4.2.3.3.cmml">1</mn></mrow><msub id="S3.E2.m1.7.7.1.1.4.3.4.3" xref="S3.E2.m1.7.7.1.1.4.3.4.3.cmml"><mi id="S3.E2.m1.7.7.1.1.4.3.4.3.2" xref="S3.E2.m1.7.7.1.1.4.3.4.3.2.cmml">N</mi><mi id="S3.E2.m1.7.7.1.1.4.3.4.3.3" xref="S3.E2.m1.7.7.1.1.4.3.4.3.3.cmml">i</mi></msub></munderover><mrow id="S3.E2.m1.7.7.1.1.4.3.3" xref="S3.E2.m1.7.7.1.1.4.3.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.7.7.1.1.4.3.3.5" xref="S3.E2.m1.7.7.1.1.4.3.3.5.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.4.3.3.4" xref="S3.E2.m1.7.7.1.1.4.3.3.4.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.4.3.3.3.3" xref="S3.E2.m1.7.7.1.1.4.3.3.3.4.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.4.3.3.3.3.4" xref="S3.E2.m1.7.7.1.1.4.3.3.3.4.cmml">(</mo><msub id="S3.E2.m1.7.7.1.1.2.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.2.1.1.1.1.1.cmml"><mi id="S3.E2.m1.7.7.1.1.2.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.2.1.1.1.1.1.2.cmml">y</mi><mrow id="S3.E2.m1.2.2.2.4" xref="S3.E2.m1.2.2.2.3.cmml"><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">i</mi><mo id="S3.E2.m1.2.2.2.4.1" xref="S3.E2.m1.2.2.2.3.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.7.7.1.1.4.3.3.3.3.5" xref="S3.E2.m1.7.7.1.1.4.3.3.3.4.cmml">,</mo><msub id="S3.E2.m1.7.7.1.1.3.2.2.2.2.2" xref="S3.E2.m1.7.7.1.1.3.2.2.2.2.2.cmml"><mi id="S3.E2.m1.7.7.1.1.3.2.2.2.2.2.2" xref="S3.E2.m1.7.7.1.1.3.2.2.2.2.2.2.cmml">x</mi><mrow id="S3.E2.m1.4.4.2.4" xref="S3.E2.m1.4.4.2.3.cmml"><mi id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml">i</mi><mo id="S3.E2.m1.4.4.2.4.1" xref="S3.E2.m1.4.4.2.3.cmml">,</mo><mi id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S3.E2.m1.7.7.1.1.4.3.3.3.3.6" xref="S3.E2.m1.7.7.1.1.4.3.3.3.4.cmml">;</mo><msub id="S3.E2.m1.7.7.1.1.4.3.3.3.3.3" xref="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.cmml"><mi id="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.2" xref="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.2.cmml">W</mi><mi id="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.3" xref="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.3.cmml">i</mi></msub><mo id="S3.E2.m1.7.7.1.1.4.3.3.3.3.7" xref="S3.E2.m1.7.7.1.1.4.3.3.3.4.cmml">,</mo><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.7.7.1.1.4.3.3.3.3.8" xref="S3.E2.m1.7.7.1.1.4.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.7.7.1.2" xref="S3.E2.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.1.1.cmml" xref="S3.E2.m1.7.7.1"><eq id="S3.E2.m1.7.7.1.1.5.cmml" xref="S3.E2.m1.7.7.1.1.5"></eq><apply id="S3.E2.m1.7.7.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1"><times id="S3.E2.m1.7.7.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.2"></times><apply id="S3.E2.m1.7.7.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.3.2">ℓ</ci><ci id="S3.E2.m1.7.7.1.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.3.3">𝑖</ci></apply><interval closure="open" id="S3.E2.m1.7.7.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1"><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝜃</ci></interval></apply><apply id="S3.E2.m1.7.7.1.1.4.cmml" xref="S3.E2.m1.7.7.1.1.4"><times id="S3.E2.m1.7.7.1.1.4.4.cmml" xref="S3.E2.m1.7.7.1.1.4.4"></times><apply id="S3.E2.m1.7.7.1.1.4.5.cmml" xref="S3.E2.m1.7.7.1.1.4.5"><divide id="S3.E2.m1.7.7.1.1.4.5.1.cmml" xref="S3.E2.m1.7.7.1.1.4.5"></divide><cn type="integer" id="S3.E2.m1.7.7.1.1.4.5.2.cmml" xref="S3.E2.m1.7.7.1.1.4.5.2">1</cn><apply id="S3.E2.m1.7.7.1.1.4.5.3.cmml" xref="S3.E2.m1.7.7.1.1.4.5.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.4.5.3.1.cmml" xref="S3.E2.m1.7.7.1.1.4.5.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.4.5.3.2.cmml" xref="S3.E2.m1.7.7.1.1.4.5.3.2">𝑁</ci><ci id="S3.E2.m1.7.7.1.1.4.5.3.3.cmml" xref="S3.E2.m1.7.7.1.1.4.5.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.7.7.1.1.4.3.cmml" xref="S3.E2.m1.7.7.1.1.4.3"><apply id="S3.E2.m1.7.7.1.1.4.3.4.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.4.3.4.1.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4">superscript</csymbol><apply id="S3.E2.m1.7.7.1.1.4.3.4.2.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.4.3.4.2.1.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4">subscript</csymbol><sum id="S3.E2.m1.7.7.1.1.4.3.4.2.2.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4.2.2"></sum><apply id="S3.E2.m1.7.7.1.1.4.3.4.2.3.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4.2.3"><eq id="S3.E2.m1.7.7.1.1.4.3.4.2.3.1.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4.2.3.1"></eq><ci id="S3.E2.m1.7.7.1.1.4.3.4.2.3.2.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4.2.3.2">𝑗</ci><cn type="integer" id="S3.E2.m1.7.7.1.1.4.3.4.2.3.3.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4.2.3.3">1</cn></apply></apply><apply id="S3.E2.m1.7.7.1.1.4.3.4.3.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.4.3.4.3.1.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.4.3.4.3.2.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4.3.2">𝑁</ci><ci id="S3.E2.m1.7.7.1.1.4.3.4.3.3.cmml" xref="S3.E2.m1.7.7.1.1.4.3.4.3.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.7.7.1.1.4.3.3.cmml" xref="S3.E2.m1.7.7.1.1.4.3.3"><times id="S3.E2.m1.7.7.1.1.4.3.3.4.cmml" xref="S3.E2.m1.7.7.1.1.4.3.3.4"></times><ci id="S3.E2.m1.7.7.1.1.4.3.3.5.cmml" xref="S3.E2.m1.7.7.1.1.4.3.3.5">ℓ</ci><vector id="S3.E2.m1.7.7.1.1.4.3.3.3.4.cmml" xref="S3.E2.m1.7.7.1.1.4.3.3.3.3"><apply id="S3.E2.m1.7.7.1.1.2.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.2.1.1.1.1.1.2">𝑦</ci><list id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.4"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑖</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E2.m1.7.7.1.1.3.2.2.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.3.2.2.2.2.2.1.cmml" xref="S3.E2.m1.7.7.1.1.3.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.3.2.2.2.2.2.2.cmml" xref="S3.E2.m1.7.7.1.1.3.2.2.2.2.2.2">𝑥</ci><list id="S3.E2.m1.4.4.2.3.cmml" xref="S3.E2.m1.4.4.2.4"><ci id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1">𝑖</ci><ci id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2">𝑗</ci></list></apply><apply id="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.cmml" xref="S3.E2.m1.7.7.1.1.4.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.1.cmml" xref="S3.E2.m1.7.7.1.1.4.3.3.3.3.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.2.cmml" xref="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.2">𝑊</ci><ci id="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.3.cmml" xref="S3.E2.m1.7.7.1.1.4.3.3.3.3.3.3">𝑖</ci></apply><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">𝜃</ci></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">\ell_{i}(W_{i},\theta)=\frac{1}{N_{i}}\sum_{j=1}^{N_{i}}\ell(y_{i,j},x_{i,j};W_{i},\theta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.p1.6" class="ltx_p">The form of each data-individual loss <math id="S3.SS1.SSS1.p1.6.m1.8" class="ltx_Math" alttext="\ell(y_{i,j},x_{i,j};W_{i},\theta)" display="inline"><semantics id="S3.SS1.SSS1.p1.6.m1.8a"><mrow id="S3.SS1.SSS1.p1.6.m1.8.8" xref="S3.SS1.SSS1.p1.6.m1.8.8.cmml"><mi mathvariant="normal" id="S3.SS1.SSS1.p1.6.m1.8.8.5" xref="S3.SS1.SSS1.p1.6.m1.8.8.5.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.p1.6.m1.8.8.4" xref="S3.SS1.SSS1.p1.6.m1.8.8.4.cmml">​</mo><mrow id="S3.SS1.SSS1.p1.6.m1.8.8.3.3" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.4.cmml"><mo stretchy="false" id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.4" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.4.cmml">(</mo><msub id="S3.SS1.SSS1.p1.6.m1.6.6.1.1.1" xref="S3.SS1.SSS1.p1.6.m1.6.6.1.1.1.cmml"><mi id="S3.SS1.SSS1.p1.6.m1.6.6.1.1.1.2" xref="S3.SS1.SSS1.p1.6.m1.6.6.1.1.1.2.cmml">y</mi><mrow id="S3.SS1.SSS1.p1.6.m1.2.2.2.4" xref="S3.SS1.SSS1.p1.6.m1.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.p1.6.m1.1.1.1.1" xref="S3.SS1.SSS1.p1.6.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.6.m1.2.2.2.4.1" xref="S3.SS1.SSS1.p1.6.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.6.m1.2.2.2.2" xref="S3.SS1.SSS1.p1.6.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.5" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.4.cmml">,</mo><msub id="S3.SS1.SSS1.p1.6.m1.7.7.2.2.2" xref="S3.SS1.SSS1.p1.6.m1.7.7.2.2.2.cmml"><mi id="S3.SS1.SSS1.p1.6.m1.7.7.2.2.2.2" xref="S3.SS1.SSS1.p1.6.m1.7.7.2.2.2.2.cmml">x</mi><mrow id="S3.SS1.SSS1.p1.6.m1.4.4.2.4" xref="S3.SS1.SSS1.p1.6.m1.4.4.2.3.cmml"><mi id="S3.SS1.SSS1.p1.6.m1.3.3.1.1" xref="S3.SS1.SSS1.p1.6.m1.3.3.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.p1.6.m1.4.4.2.4.1" xref="S3.SS1.SSS1.p1.6.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.p1.6.m1.4.4.2.2" xref="S3.SS1.SSS1.p1.6.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.6" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.4.cmml">;</mo><msub id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.cmml"><mi id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.2" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.2.cmml">W</mi><mi id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.3" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.7" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.4.cmml">,</mo><mi id="S3.SS1.SSS1.p1.6.m1.5.5" xref="S3.SS1.SSS1.p1.6.m1.5.5.cmml">θ</mi><mo stretchy="false" id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.8" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.p1.6.m1.8b"><apply id="S3.SS1.SSS1.p1.6.m1.8.8.cmml" xref="S3.SS1.SSS1.p1.6.m1.8.8"><times id="S3.SS1.SSS1.p1.6.m1.8.8.4.cmml" xref="S3.SS1.SSS1.p1.6.m1.8.8.4"></times><ci id="S3.SS1.SSS1.p1.6.m1.8.8.5.cmml" xref="S3.SS1.SSS1.p1.6.m1.8.8.5">ℓ</ci><vector id="S3.SS1.SSS1.p1.6.m1.8.8.3.4.cmml" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.3"><apply id="S3.SS1.SSS1.p1.6.m1.6.6.1.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m1.6.6.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m1.6.6.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.p1.6.m1.6.6.1.1.1.2.cmml" xref="S3.SS1.SSS1.p1.6.m1.6.6.1.1.1.2">𝑦</ci><list id="S3.SS1.SSS1.p1.6.m1.2.2.2.3.cmml" xref="S3.SS1.SSS1.p1.6.m1.2.2.2.4"><ci id="S3.SS1.SSS1.p1.6.m1.1.1.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m1.1.1.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.6.m1.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.SS1.SSS1.p1.6.m1.7.7.2.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m1.7.7.2.2.2.1.cmml" xref="S3.SS1.SSS1.p1.6.m1.7.7.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.p1.6.m1.7.7.2.2.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m1.7.7.2.2.2.2">𝑥</ci><list id="S3.SS1.SSS1.p1.6.m1.4.4.2.3.cmml" xref="S3.SS1.SSS1.p1.6.m1.4.4.2.4"><ci id="S3.SS1.SSS1.p1.6.m1.3.3.1.1.cmml" xref="S3.SS1.SSS1.p1.6.m1.3.3.1.1">𝑖</ci><ci id="S3.SS1.SSS1.p1.6.m1.4.4.2.2.cmml" xref="S3.SS1.SSS1.p1.6.m1.4.4.2.2">𝑗</ci></list></apply><apply id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.cmml" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.1.cmml" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3">subscript</csymbol><ci id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.2.cmml" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.2">𝑊</ci><ci id="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.3.cmml" xref="S3.SS1.SSS1.p1.6.m1.8.8.3.3.3.3">𝑖</ci></apply><ci id="S3.SS1.SSS1.p1.6.m1.5.5.cmml" xref="S3.SS1.SSS1.p1.6.m1.5.5">𝜃</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.p1.6.m1.8c">\ell(y_{i,j},x_{i,j};W_{i},\theta)</annotation></semantics></math> will depend on the application, e.g. on whether the task is a regression or a classification one. The case of multi-class classification, that we consider in our experiments, is detailed below while other cases can be dealt with similarly.</p>
</div>
<section id="S3.SS1.SSS1.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Multi-class classification.</h5>

<div id="S3.SS1.SSS1.Px1.p1" class="ltx_para">
<p id="S3.SS1.SSS1.Px1.p1.6" class="ltx_p">A standard task that each client needs to solve is multi-class classification, where the input <math id="S3.SS1.SSS1.Px1.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.1.m1.1a"><mi id="S3.SS1.SSS1.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS1.Px1.p1.1.m1.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.1.m1.1b"><ci id="S3.SS1.SSS1.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.1.m1.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.1.m1.1c">x</annotation></semantics></math> is assigned a class label <math id="S3.SS1.SSS1.Px1.p1.2.m2.3" class="ltx_Math" alttext="y\in\{1,\ldots,K_{i}\}" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.2.m2.3a"><mrow id="S3.SS1.SSS1.Px1.p1.2.m2.3.3" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.cmml"><mi id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.3" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.3.cmml">y</mi><mo id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.2" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.2.cmml">∈</mo><mrow id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.2" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.2.cmml">{</mo><mn id="S3.SS1.SSS1.Px1.p1.2.m2.1.1" xref="S3.SS1.SSS1.Px1.p1.2.m2.1.1.cmml">1</mn><mo id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.3" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.2.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.SSS1.Px1.p1.2.m2.2.2" xref="S3.SS1.SSS1.Px1.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.4" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.2.cmml">,</mo><msub id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.2" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.2.cmml">K</mi><mi id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.3" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.5" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.2.m2.3b"><apply id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.cmml" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3"><in id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.2.cmml" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.2"></in><ci id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.3.cmml" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.3">𝑦</ci><set id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1"><cn type="integer" id="S3.SS1.SSS1.Px1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.2.m2.1.1">1</cn><ci id="S3.SS1.SSS1.Px1.p1.2.m2.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.2.m2.2.2">…</ci><apply id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.2">𝐾</ci><ci id="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.3.cmml" xref="S3.SS1.SSS1.Px1.p1.2.m2.3.3.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.2.m2.3c">y\in\{1,\ldots,K_{i}\}</annotation></semantics></math>. In our personalized setting, each client <math id="S3.SS1.SSS1.Px1.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.3.m3.1a"><mi id="S3.SS1.SSS1.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS1.Px1.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.3.m3.1b"><ci id="S3.SS1.SSS1.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.3.m3.1c">i</annotation></semantics></math> can tackle a separate classification problem with <math id="S3.SS1.SSS1.Px1.p1.4.m4.1" class="ltx_Math" alttext="K_{i}" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.4.m4.1a"><msub id="S3.SS1.SSS1.Px1.p1.4.m4.1.1" xref="S3.SS1.SSS1.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.SSS1.Px1.p1.4.m4.1.1.2" xref="S3.SS1.SSS1.Px1.p1.4.m4.1.1.2.cmml">K</mi><mi id="S3.SS1.SSS1.Px1.p1.4.m4.1.1.3" xref="S3.SS1.SSS1.Px1.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.4.m4.1b"><apply id="S3.SS1.SSS1.Px1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.4.m4.1.1.2">𝐾</ci><ci id="S3.SS1.SSS1.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.SSS1.Px1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.4.m4.1c">K_{i}</annotation></semantics></math> classes, where classes across clients can be mutually exclusive or partially overlap. The set of personalized weights <math id="S3.SS1.SSS1.Px1.p1.5.m5.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.5.m5.1a"><msub id="S3.SS1.SSS1.Px1.p1.5.m5.1.1" xref="S3.SS1.SSS1.Px1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.SSS1.Px1.p1.5.m5.1.1.2" xref="S3.SS1.SSS1.Px1.p1.5.m5.1.1.2.cmml">W</mi><mi id="S3.SS1.SSS1.Px1.p1.5.m5.1.1.3" xref="S3.SS1.SSS1.Px1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.5.m5.1b"><apply id="S3.SS1.SSS1.Px1.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.5.m5.1.1.2">𝑊</ci><ci id="S3.SS1.SSS1.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.SSS1.Px1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.5.m5.1c">W_{i}</annotation></semantics></math> becomes a <math id="S3.SS1.SSS1.Px1.p1.6.m6.1" class="ltx_Math" alttext="K_{i}\times M" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.6.m6.1a"><mrow id="S3.SS1.SSS1.Px1.p1.6.m6.1.1" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.cmml"><msub id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.cmml"><mi id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.2" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.2.cmml">K</mi><mi id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.3" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.1" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.1.cmml">×</mo><mi id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.3" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.6.m6.1b"><apply id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1"><times id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.1"></times><apply id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.1.cmml" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.2">𝐾</ci><ci id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS1.Px1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.SSS1.Px1.p1.6.m6.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.6.m6.1c">K_{i}\times M</annotation></semantics></math> matrix that allows to compute the logits in the standard cross entropy loss,</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.12" class="ltx_Math" alttext="\ell(y_{i,j},x_{i,j};W_{i},\theta)\!=\!-\log\left\{\text{Pr}(y_{i,j}|x_{i,j};W_{i},\theta)\right\}." display="block"><semantics id="S3.E3.m1.12a"><mrow id="S3.E3.m1.12.12.1" xref="S3.E3.m1.12.12.1.1.cmml"><mrow id="S3.E3.m1.12.12.1.1" xref="S3.E3.m1.12.12.1.1.cmml"><mrow id="S3.E3.m1.12.12.1.1.3" xref="S3.E3.m1.12.12.1.1.3.cmml"><mi mathvariant="normal" id="S3.E3.m1.12.12.1.1.3.5" xref="S3.E3.m1.12.12.1.1.3.5.cmml">ℓ</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.12.12.1.1.3.4" xref="S3.E3.m1.12.12.1.1.3.4.cmml">​</mo><mrow id="S3.E3.m1.12.12.1.1.3.3.3" xref="S3.E3.m1.12.12.1.1.3.3.4.cmml"><mo stretchy="false" id="S3.E3.m1.12.12.1.1.3.3.3.4" xref="S3.E3.m1.12.12.1.1.3.3.4.cmml">(</mo><msub id="S3.E3.m1.12.12.1.1.1.1.1.1" xref="S3.E3.m1.12.12.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.12.12.1.1.1.1.1.1.2" xref="S3.E3.m1.12.12.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">i</mi><mo id="S3.E3.m1.2.2.2.4.1" xref="S3.E3.m1.2.2.2.3.cmml">,</mo><mi id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.E3.m1.12.12.1.1.3.3.3.5" xref="S3.E3.m1.12.12.1.1.3.3.4.cmml">,</mo><msub id="S3.E3.m1.12.12.1.1.2.2.2.2" xref="S3.E3.m1.12.12.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.12.12.1.1.2.2.2.2.2" xref="S3.E3.m1.12.12.1.1.2.2.2.2.2.cmml">x</mi><mrow id="S3.E3.m1.4.4.2.4" xref="S3.E3.m1.4.4.2.3.cmml"><mi id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml">i</mi><mo id="S3.E3.m1.4.4.2.4.1" xref="S3.E3.m1.4.4.2.3.cmml">,</mo><mi id="S3.E3.m1.4.4.2.2" xref="S3.E3.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S3.E3.m1.12.12.1.1.3.3.3.6" xref="S3.E3.m1.12.12.1.1.3.3.4.cmml">;</mo><msub id="S3.E3.m1.12.12.1.1.3.3.3.3" xref="S3.E3.m1.12.12.1.1.3.3.3.3.cmml"><mi id="S3.E3.m1.12.12.1.1.3.3.3.3.2" xref="S3.E3.m1.12.12.1.1.3.3.3.3.2.cmml">W</mi><mi id="S3.E3.m1.12.12.1.1.3.3.3.3.3" xref="S3.E3.m1.12.12.1.1.3.3.3.3.3.cmml">i</mi></msub><mo id="S3.E3.m1.12.12.1.1.3.3.3.7" xref="S3.E3.m1.12.12.1.1.3.3.4.cmml">,</mo><mi id="S3.E3.m1.9.9" xref="S3.E3.m1.9.9.cmml">θ</mi><mo stretchy="false" id="S3.E3.m1.12.12.1.1.3.3.3.8" xref="S3.E3.m1.12.12.1.1.3.3.4.cmml">)</mo></mrow></mrow><mo lspace="0.108em" rspace="0.108em" id="S3.E3.m1.12.12.1.1.5" xref="S3.E3.m1.12.12.1.1.5.cmml">=</mo><mrow id="S3.E3.m1.12.12.1.1.4" xref="S3.E3.m1.12.12.1.1.4.cmml"><mo rspace="0.167em" id="S3.E3.m1.12.12.1.1.4a" xref="S3.E3.m1.12.12.1.1.4.cmml">−</mo><mrow id="S3.E3.m1.12.12.1.1.4.1.1" xref="S3.E3.m1.12.12.1.1.4.1.2.cmml"><mi id="S3.E3.m1.11.11" xref="S3.E3.m1.11.11.cmml">log</mi><mo id="S3.E3.m1.12.12.1.1.4.1.1a" xref="S3.E3.m1.12.12.1.1.4.1.2.cmml">⁡</mo><mrow id="S3.E3.m1.12.12.1.1.4.1.1.1" xref="S3.E3.m1.12.12.1.1.4.1.2.cmml"><mo id="S3.E3.m1.12.12.1.1.4.1.1.1.2" xref="S3.E3.m1.12.12.1.1.4.1.2.cmml">{</mo><mrow id="S3.E3.m1.12.12.1.1.4.1.1.1.1" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.cmml"><mtext id="S3.E3.m1.12.12.1.1.4.1.1.1.1.3" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.3a.cmml">Pr</mtext><mo lspace="0em" rspace="0em" id="S3.E3.m1.12.12.1.1.4.1.1.1.1.2" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.2" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.cmml"><msub id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.4" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.4.2" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.4.2.cmml">y</mi><mrow id="S3.E3.m1.6.6.2.4" xref="S3.E3.m1.6.6.2.3.cmml"><mi id="S3.E3.m1.5.5.1.1" xref="S3.E3.m1.5.5.1.1.cmml">i</mi><mo id="S3.E3.m1.6.6.2.4.1" xref="S3.E3.m1.6.6.2.3.cmml">,</mo><mi id="S3.E3.m1.6.6.2.2" xref="S3.E3.m1.6.6.2.2.cmml">j</mi></mrow></msub><mo fence="false" id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.3" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.E3.m1.8.8.2.4" xref="S3.E3.m1.8.8.2.3.cmml"><mi id="S3.E3.m1.7.7.1.1" xref="S3.E3.m1.7.7.1.1.cmml">i</mi><mo id="S3.E3.m1.8.8.2.4.1" xref="S3.E3.m1.8.8.2.3.cmml">,</mo><mi id="S3.E3.m1.8.8.2.2" xref="S3.E3.m1.8.8.2.2.cmml">j</mi></mrow></msub><mo id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.3" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.3.cmml">;</mo><msub id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.2.cmml">W</mi><mi id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.4" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S3.E3.m1.10.10" xref="S3.E3.m1.10.10.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.3" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.12.12.1.1.4.1.1.1.3" xref="S3.E3.m1.12.12.1.1.4.1.2.cmml">}</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E3.m1.12.12.1.2" xref="S3.E3.m1.12.12.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.12b"><apply id="S3.E3.m1.12.12.1.1.cmml" xref="S3.E3.m1.12.12.1"><eq id="S3.E3.m1.12.12.1.1.5.cmml" xref="S3.E3.m1.12.12.1.1.5"></eq><apply id="S3.E3.m1.12.12.1.1.3.cmml" xref="S3.E3.m1.12.12.1.1.3"><times id="S3.E3.m1.12.12.1.1.3.4.cmml" xref="S3.E3.m1.12.12.1.1.3.4"></times><ci id="S3.E3.m1.12.12.1.1.3.5.cmml" xref="S3.E3.m1.12.12.1.1.3.5">ℓ</ci><vector id="S3.E3.m1.12.12.1.1.3.3.4.cmml" xref="S3.E3.m1.12.12.1.1.3.3.3"><apply id="S3.E3.m1.12.12.1.1.1.1.1.1.cmml" xref="S3.E3.m1.12.12.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.12.12.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.12.12.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.12.12.1.1.1.1.1.1.2">𝑦</ci><list id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.4"><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑖</ci><ci id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2">𝑗</ci></list></apply><apply id="S3.E3.m1.12.12.1.1.2.2.2.2.cmml" xref="S3.E3.m1.12.12.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.12.12.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.12.12.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.12.12.1.1.2.2.2.2.2">𝑥</ci><list id="S3.E3.m1.4.4.2.3.cmml" xref="S3.E3.m1.4.4.2.4"><ci id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1">𝑖</ci><ci id="S3.E3.m1.4.4.2.2.cmml" xref="S3.E3.m1.4.4.2.2">𝑗</ci></list></apply><apply id="S3.E3.m1.12.12.1.1.3.3.3.3.cmml" xref="S3.E3.m1.12.12.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.1.1.3.3.3.3.1.cmml" xref="S3.E3.m1.12.12.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E3.m1.12.12.1.1.3.3.3.3.2.cmml" xref="S3.E3.m1.12.12.1.1.3.3.3.3.2">𝑊</ci><ci id="S3.E3.m1.12.12.1.1.3.3.3.3.3.cmml" xref="S3.E3.m1.12.12.1.1.3.3.3.3.3">𝑖</ci></apply><ci id="S3.E3.m1.9.9.cmml" xref="S3.E3.m1.9.9">𝜃</ci></vector></apply><apply id="S3.E3.m1.12.12.1.1.4.cmml" xref="S3.E3.m1.12.12.1.1.4"><minus id="S3.E3.m1.12.12.1.1.4.2.cmml" xref="S3.E3.m1.12.12.1.1.4"></minus><apply id="S3.E3.m1.12.12.1.1.4.1.2.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1"><log id="S3.E3.m1.11.11.cmml" xref="S3.E3.m1.11.11"></log><apply id="S3.E3.m1.12.12.1.1.4.1.1.1.1.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1"><times id="S3.E3.m1.12.12.1.1.4.1.1.1.1.2.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.2"></times><ci id="S3.E3.m1.12.12.1.1.4.1.1.1.1.3a.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.3"><mtext id="S3.E3.m1.12.12.1.1.4.1.1.1.1.3.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.3">Pr</mtext></ci><apply id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.4.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.4.2">𝑦</ci><list id="S3.E3.m1.6.6.2.3.cmml" xref="S3.E3.m1.6.6.2.4"><ci id="S3.E3.m1.5.5.1.1.cmml" xref="S3.E3.m1.5.5.1.1">𝑖</ci><ci id="S3.E3.m1.6.6.2.2.cmml" xref="S3.E3.m1.6.6.2.2">𝑗</ci></list></apply><list id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2"><apply id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><list id="S3.E3.m1.8.8.2.3.cmml" xref="S3.E3.m1.8.8.2.4"><ci id="S3.E3.m1.7.7.1.1.cmml" xref="S3.E3.m1.7.7.1.1">𝑖</ci><ci id="S3.E3.m1.8.8.2.2.cmml" xref="S3.E3.m1.8.8.2.2">𝑗</ci></list></apply><apply id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.2">𝑊</ci><ci id="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.12.12.1.1.4.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.10.10.cmml" xref="S3.E3.m1.10.10">𝜃</ci></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.12c">\ell(y_{i,j},x_{i,j};W_{i},\theta)\!=\!-\log\left\{\text{Pr}(y_{i,j}|x_{i,j};W_{i},\theta)\right\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS1.Px1.p1.11" class="ltx_p">The class probability is modeled by the Softmax function, i.e. <math id="S3.SS1.SSS1.Px1.p1.7.m1.8" class="ltx_Math" alttext="\text{Pr}(y_{i,j}|x_{i,j};W_{i},\theta)=\frac{e^{\alpha_{y_{i,j}}}}{\sum_{k=1}^{K_{i}}e^{\alpha_{k}}}" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.7.m1.8a"><mrow id="S3.SS1.SSS1.Px1.p1.7.m1.8.8" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.cmml"><mrow id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.cmml"><mtext id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.3a.cmml">Pr</mtext><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.2.cmml">​</mo><mrow id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.cmml"><msub id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.4" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.4.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.4.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.4.2.cmml">y</mi><mrow id="S3.SS1.SSS1.Px1.p1.7.m1.2.2.2.4" xref="S3.SS1.SSS1.Px1.p1.7.m1.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.1.1.1.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.Px1.p1.7.m1.2.2.2.4.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.Px1.p1.7.m1.2.2.2.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo fence="false" id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.3.cmml">|</mo><mrow id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.3.cmml"><msub id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.1.1.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.1.1.1.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS1.SSS1.Px1.p1.7.m1.4.4.2.4" xref="S3.SS1.SSS1.Px1.p1.7.m1.4.4.2.3.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.3.3.1.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.3.3.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.Px1.p1.7.m1.4.4.2.4.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.4.4.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.Px1.p1.7.m1.4.4.2.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.3.cmml">;</mo><msub id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.2.cmml">W</mi><mi id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.4" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.Px1.p1.7.m1.7.7" xref="S3.SS1.SSS1.Px1.p1.7.m1.7.7.cmml">θ</mi></mrow></mrow><mo stretchy="false" id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.2.cmml">=</mo><mfrac id="S3.SS1.SSS1.Px1.p1.7.m1.6.6" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.cmml"><msup id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.4" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.4.cmml">e</mi><msub id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.4" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.4.cmml">α</mi><msub id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.4" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.4.cmml">y</mi><mrow id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.2.2.4" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.5.5.1.1.1.1.1.1.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.2.2.4.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.2.2.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.2.2.2.cmml">j</mi></mrow></msub></msub></msup><mrow id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.cmml"><mstyle displaystyle="false" id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.cmml"><msubsup id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1a" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.cmml"><mo id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.2.cmml">∑</mo><mrow id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.2.cmml">k</mi><mo id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.1" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.1.cmml">=</mo><mn id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.3.cmml">1</mn></mrow><msub id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.2.cmml">K</mi><mi id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.3.cmml">i</mi></msub></msubsup></mstyle><msup id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.2.cmml">e</mi><msub id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.cmml"><mi id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.2" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.2.cmml">α</mi><mi id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.3" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.3.cmml">k</mi></msub></msup></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.7.m1.8b"><apply id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8"><eq id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.2"></eq><apply id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1"><times id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.2"></times><ci id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.3a.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.3"><mtext id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.3">Pr</mtext></ci><apply id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.3">conditional</csymbol><apply id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.4.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.4.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.4">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.4.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.4.2">𝑦</ci><list id="S3.SS1.SSS1.Px1.p1.7.m1.2.2.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.2.2.2.4"><ci id="S3.SS1.SSS1.Px1.p1.7.m1.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.1.1.1.1">𝑖</ci><ci id="S3.SS1.SSS1.Px1.p1.7.m1.2.2.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.2.2.2.2">𝑗</ci></list></apply><list id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2"><apply id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.1.1.1.2">𝑥</ci><list id="S3.SS1.SSS1.Px1.p1.7.m1.4.4.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.4.4.2.4"><ci id="S3.SS1.SSS1.Px1.p1.7.m1.3.3.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.3.3.1.1">𝑖</ci><ci id="S3.SS1.SSS1.Px1.p1.7.m1.4.4.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.4.4.2.2">𝑗</ci></list></apply><apply id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.2">𝑊</ci><ci id="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.8.8.1.1.1.1.2.2.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS1.Px1.p1.7.m1.7.7.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.7.7">𝜃</ci></list></apply></apply><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6"><divide id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6"></divide><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2">superscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.4.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.4">𝑒</ci><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.4.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.4">𝛼</ci><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.4.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.4">𝑦</ci><list id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.2.2.4"><ci id="S3.SS1.SSS1.Px1.p1.7.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.5.5.1.1.1.1.1.1.1.1">𝑖</ci><ci id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.2.2.2.2.2.2.2.2">𝑗</ci></list></apply></apply></apply><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4"><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1">superscript</csymbol><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1">subscript</csymbol><sum id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.2"></sum><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3"><eq id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.1"></eq><ci id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.2.3.3">1</cn></apply></apply><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.2">𝐾</ci><ci id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2">superscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.2">𝑒</ci><apply id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.1.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.2.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.2">𝛼</ci><ci id="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.3.cmml" xref="S3.SS1.SSS1.Px1.p1.7.m1.6.6.4.2.3.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.7.m1.8c">\text{Pr}(y_{i,j}|x_{i,j};W_{i},\theta)=\frac{e^{\alpha_{y_{i,j}}}}{\sum_{k=1}^{K_{i}}e^{\alpha_{k}}}</annotation></semantics></math>
where the <math id="S3.SS1.SSS1.Px1.p1.8.m2.1" class="ltx_Math" alttext="K_{i}" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.8.m2.1a"><msub id="S3.SS1.SSS1.Px1.p1.8.m2.1.1" xref="S3.SS1.SSS1.Px1.p1.8.m2.1.1.cmml"><mi id="S3.SS1.SSS1.Px1.p1.8.m2.1.1.2" xref="S3.SS1.SSS1.Px1.p1.8.m2.1.1.2.cmml">K</mi><mi id="S3.SS1.SSS1.Px1.p1.8.m2.1.1.3" xref="S3.SS1.SSS1.Px1.p1.8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.8.m2.1b"><apply id="S3.SS1.SSS1.Px1.p1.8.m2.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.8.m2.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.8.m2.1.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.8.m2.1.1.2">𝐾</ci><ci id="S3.SS1.SSS1.Px1.p1.8.m2.1.1.3.cmml" xref="S3.SS1.SSS1.Px1.p1.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.8.m2.1c">K_{i}</annotation></semantics></math>-dimensional vector of logits is
<math id="S3.SS1.SSS1.Px1.p1.9.m3.4" class="ltx_Math" alttext="\alpha=W_{i}\times\phi(x_{i,j};\theta)" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.9.m3.4a"><mrow id="S3.SS1.SSS1.Px1.p1.9.m3.4.4" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.cmml"><mi id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.3" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.3.cmml">α</mi><mo id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.2" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.2.cmml">=</mo><mrow id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.cmml"><mrow id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.cmml"><msub id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.cmml"><mi id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.2" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.2.cmml">W</mi><mi id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.3" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.3.cmml">i</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.1" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.1.cmml">×</mo><mi id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.3" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.3.cmml">ϕ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.2" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.2.cmml">​</mo><mrow id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.2" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.2.cmml">(</mo><msub id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.1" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.1.cmml"><mi id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.1.2" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS1.SSS1.Px1.p1.9.m3.2.2.2.4" xref="S3.SS1.SSS1.Px1.p1.9.m3.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.Px1.p1.9.m3.1.1.1.1" xref="S3.SS1.SSS1.Px1.p1.9.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.Px1.p1.9.m3.2.2.2.4.1" xref="S3.SS1.SSS1.Px1.p1.9.m3.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.Px1.p1.9.m3.2.2.2.2" xref="S3.SS1.SSS1.Px1.p1.9.m3.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.3" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.2.cmml">;</mo><mi id="S3.SS1.SSS1.Px1.p1.9.m3.3.3" xref="S3.SS1.SSS1.Px1.p1.9.m3.3.3.cmml">θ</mi><mo stretchy="false" id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.4" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.9.m3.4b"><apply id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4"><eq id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.2.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.2"></eq><ci id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.3.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.3">𝛼</ci><apply id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1"><times id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.2"></times><apply id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3"><times id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.1.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.1"></times><apply id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.1.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.2">𝑊</ci><ci id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.2.3">𝑖</ci></apply><ci id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.3.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.3.3">italic-ϕ</ci></apply><list id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1"><apply id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.4.4.1.1.1.1.2">𝑥</ci><list id="S3.SS1.SSS1.Px1.p1.9.m3.2.2.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.2.2.2.4"><ci id="S3.SS1.SSS1.Px1.p1.9.m3.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.1.1.1.1">𝑖</ci><ci id="S3.SS1.SSS1.Px1.p1.9.m3.2.2.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.2.2.2.2">𝑗</ci></list></apply><ci id="S3.SS1.SSS1.Px1.p1.9.m3.3.3.cmml" xref="S3.SS1.SSS1.Px1.p1.9.m3.3.3">𝜃</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.9.m3.4c">\alpha=W_{i}\times\phi(x_{i,j};\theta)</annotation></semantics></math> and <math id="S3.SS1.SSS1.Px1.p1.10.m4.4" class="ltx_Math" alttext="\phi(x_{i,j};\theta)" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.10.m4.4a"><mrow id="S3.SS1.SSS1.Px1.p1.10.m4.4.4" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.cmml"><mi id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.3" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.2" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.2.cmml">​</mo><mrow id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.2.cmml"><mo stretchy="false" id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.2" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.2.cmml">(</mo><msub id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.1" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.1.cmml"><mi id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.1.2" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.1.2.cmml">x</mi><mrow id="S3.SS1.SSS1.Px1.p1.10.m4.2.2.2.4" xref="S3.SS1.SSS1.Px1.p1.10.m4.2.2.2.3.cmml"><mi id="S3.SS1.SSS1.Px1.p1.10.m4.1.1.1.1" xref="S3.SS1.SSS1.Px1.p1.10.m4.1.1.1.1.cmml">i</mi><mo id="S3.SS1.SSS1.Px1.p1.10.m4.2.2.2.4.1" xref="S3.SS1.SSS1.Px1.p1.10.m4.2.2.2.3.cmml">,</mo><mi id="S3.SS1.SSS1.Px1.p1.10.m4.2.2.2.2" xref="S3.SS1.SSS1.Px1.p1.10.m4.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.3" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.2.cmml">;</mo><mi id="S3.SS1.SSS1.Px1.p1.10.m4.3.3" xref="S3.SS1.SSS1.Px1.p1.10.m4.3.3.cmml">θ</mi><mo stretchy="false" id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.4" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.10.m4.4b"><apply id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4"><times id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.2.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.2"></times><ci id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.3.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.3">italic-ϕ</ci><list id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1"><apply id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.4.4.1.1.1.2">𝑥</ci><list id="S3.SS1.SSS1.Px1.p1.10.m4.2.2.2.3.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.2.2.2.4"><ci id="S3.SS1.SSS1.Px1.p1.10.m4.1.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.1.1.1.1">𝑖</ci><ci id="S3.SS1.SSS1.Px1.p1.10.m4.2.2.2.2.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.2.2.2.2">𝑗</ci></list></apply><ci id="S3.SS1.SSS1.Px1.p1.10.m4.3.3.cmml" xref="S3.SS1.SSS1.Px1.p1.10.m4.3.3">𝜃</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.10.m4.4c">\phi(x_{i,j};\theta)</annotation></semantics></math> is a <math id="S3.SS1.SSS1.Px1.p1.11.m5.1" class="ltx_Math" alttext="M\times 1" display="inline"><semantics id="S3.SS1.SSS1.Px1.p1.11.m5.1a"><mrow id="S3.SS1.SSS1.Px1.p1.11.m5.1.1" xref="S3.SS1.SSS1.Px1.p1.11.m5.1.1.cmml"><mi id="S3.SS1.SSS1.Px1.p1.11.m5.1.1.2" xref="S3.SS1.SSS1.Px1.p1.11.m5.1.1.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS1.Px1.p1.11.m5.1.1.1" xref="S3.SS1.SSS1.Px1.p1.11.m5.1.1.1.cmml">×</mo><mn id="S3.SS1.SSS1.Px1.p1.11.m5.1.1.3" xref="S3.SS1.SSS1.Px1.p1.11.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS1.Px1.p1.11.m5.1b"><apply id="S3.SS1.SSS1.Px1.p1.11.m5.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.11.m5.1.1"><times id="S3.SS1.SSS1.Px1.p1.11.m5.1.1.1.cmml" xref="S3.SS1.SSS1.Px1.p1.11.m5.1.1.1"></times><ci id="S3.SS1.SSS1.Px1.p1.11.m5.1.1.2.cmml" xref="S3.SS1.SSS1.Px1.p1.11.m5.1.1.2">𝑀</ci><cn type="integer" id="S3.SS1.SSS1.Px1.p1.11.m5.1.1.3.cmml" xref="S3.SS1.SSS1.Px1.p1.11.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS1.Px1.p1.11.m5.1c">M\times 1</annotation></semantics></math> vector.</p>
</div>
</section>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>The Proposed Algorithm</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">The objective of the personalized FL setting above is to minimize the global training loss in (<a href="#S3.E1" title="Equation 1 ‣ 3.1.1 Training Objective for Classification ‣ 3.1 Personalized FL Setting ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) over the full set of parameters <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\psi</annotation></semantics></math>. To this end, we propose a distributed optimization algorithm that incorporates exact Stochastic Gradient Descent (SGD) steps over <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\psi</annotation></semantics></math>. The stochasticity arises due to a random <em id="S3.SS2.p1.2.1" class="ltx_emph ltx_font_italic">client-participation</em> or selection process defined in the sequel, in Section <a href="#S3.SS2.SSS1" title="3.2.1 Client Participation Process ‣ 3.2 The Proposed Algorithm ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>. Without stochasticity, i.e. if all clients participate at every round, these previous steps become exact gradient descent (GD) steps. This means that the proposed algorithm defined in Section <a href="#S3.SS2.SSS2" title="3.2.2 Client and Server Updates ‣ 3.2 The Proposed Algorithm ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2.2</span></a> converges similarly to standard GD or SGD methods; see Section <a href="#S3.SS3" title="3.3 Exact Stochastic Gradient Descent Optimization ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
<section id="S3.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Client Participation Process

</h4>

<div id="S3.SS2.SSS1.p1" class="ltx_para">
<p id="S3.SS2.SSS1.p1.9" class="ltx_p">We assume that the optimization of the global loss in (<a href="#S3.E1" title="Equation 1 ‣ 3.1.1 Training Objective for Classification ‣ 3.1 Personalized FL Setting ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) is performed in different <em id="S3.SS2.SSS1.p1.9.1" class="ltx_emph ltx_font_italic">rounds</em>, where each round involves a communication of the server with some of the clients. More precisely, we assume that at the beginning of each optimization round <math id="S3.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.SSS1.p1.1.m1.1a"><mi id="S3.SS2.SSS1.p1.1.m1.1.1" xref="S3.SS2.SSS1.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.1.m1.1b"><ci id="S3.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.1.m1.1c">t</annotation></semantics></math>, a subset of clients <math id="S3.SS2.SSS1.p1.2.m2.3" class="ltx_Math" alttext="\mathcal{I}_{t}\subset\{1,\ldots,I\}" display="inline"><semantics id="S3.SS2.SSS1.p1.2.m2.3a"><mrow id="S3.SS2.SSS1.p1.2.m2.3.4" xref="S3.SS2.SSS1.p1.2.m2.3.4.cmml"><msub id="S3.SS2.SSS1.p1.2.m2.3.4.2" xref="S3.SS2.SSS1.p1.2.m2.3.4.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.2.m2.3.4.2.2" xref="S3.SS2.SSS1.p1.2.m2.3.4.2.2.cmml">ℐ</mi><mi id="S3.SS2.SSS1.p1.2.m2.3.4.2.3" xref="S3.SS2.SSS1.p1.2.m2.3.4.2.3.cmml">t</mi></msub><mo id="S3.SS2.SSS1.p1.2.m2.3.4.1" xref="S3.SS2.SSS1.p1.2.m2.3.4.1.cmml">⊂</mo><mrow id="S3.SS2.SSS1.p1.2.m2.3.4.3.2" xref="S3.SS2.SSS1.p1.2.m2.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.2.m2.3.4.3.2.1" xref="S3.SS2.SSS1.p1.2.m2.3.4.3.1.cmml">{</mo><mn id="S3.SS2.SSS1.p1.2.m2.1.1" xref="S3.SS2.SSS1.p1.2.m2.1.1.cmml">1</mn><mo id="S3.SS2.SSS1.p1.2.m2.3.4.3.2.2" xref="S3.SS2.SSS1.p1.2.m2.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p1.2.m2.2.2" xref="S3.SS2.SSS1.p1.2.m2.2.2.cmml">…</mi><mo id="S3.SS2.SSS1.p1.2.m2.3.4.3.2.3" xref="S3.SS2.SSS1.p1.2.m2.3.4.3.1.cmml">,</mo><mi id="S3.SS2.SSS1.p1.2.m2.3.3" xref="S3.SS2.SSS1.p1.2.m2.3.3.cmml">I</mi><mo stretchy="false" id="S3.SS2.SSS1.p1.2.m2.3.4.3.2.4" xref="S3.SS2.SSS1.p1.2.m2.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.2.m2.3b"><apply id="S3.SS2.SSS1.p1.2.m2.3.4.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.4"><subset id="S3.SS2.SSS1.p1.2.m2.3.4.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.4.1"></subset><apply id="S3.SS2.SSS1.p1.2.m2.3.4.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.4.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.2.m2.3.4.2.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.4.2">subscript</csymbol><ci id="S3.SS2.SSS1.p1.2.m2.3.4.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.4.2.2">ℐ</ci><ci id="S3.SS2.SSS1.p1.2.m2.3.4.2.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.4.2.3">𝑡</ci></apply><set id="S3.SS2.SSS1.p1.2.m2.3.4.3.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.4.3.2"><cn type="integer" id="S3.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.2.m2.1.1">1</cn><ci id="S3.SS2.SSS1.p1.2.m2.2.2.cmml" xref="S3.SS2.SSS1.p1.2.m2.2.2">…</ci><ci id="S3.SS2.SSS1.p1.2.m2.3.3.cmml" xref="S3.SS2.SSS1.p1.2.m2.3.3">𝐼</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.2.m2.3c">\mathcal{I}_{t}\subset\{1,\ldots,I\}</annotation></semantics></math> is selected uniformly at random to participate. For instance, two sensible options are: (i) the number of clients <math id="S3.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="r_{t}:=|\mathcal{I}_{t}|" display="inline"><semantics id="S3.SS2.SSS1.p1.3.m3.1a"><mrow id="S3.SS2.SSS1.p1.3.m3.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.cmml"><msub id="S3.SS2.SSS1.p1.3.m3.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.3.m3.1.1.3.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.2.cmml">r</mi><mi id="S3.SS2.SSS1.p1.3.m3.1.1.3.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.3.cmml">t</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.SSS1.p1.3.m3.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml">:=</mo><mrow id="S3.SS2.SSS1.p1.3.m3.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.2.1.cmml">|</mo><msub id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2.cmml">ℐ</mi><mi id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.3" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.3.m3.1b"><apply id="S3.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1"><csymbol cd="latexml" id="S3.SS2.SSS1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.2">assign</csymbol><apply id="S3.SS2.SSS1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.2">𝑟</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.3.3">𝑡</ci></apply><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1"><abs id="S3.SS2.SSS1.p1.3.m3.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.2"></abs><apply id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.2">ℐ</ci><ci id="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.3.m3.1.1.1.1.1.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.3.m3.1c">r_{t}:=|\mathcal{I}_{t}|</annotation></semantics></math> follows a Binomial distribution <math id="S3.SS2.SSS1.p1.4.m4.2" class="ltx_Math" alttext="\text{B}(I,\rho)" display="inline"><semantics id="S3.SS2.SSS1.p1.4.m4.2a"><mrow id="S3.SS2.SSS1.p1.4.m4.2.3" xref="S3.SS2.SSS1.p1.4.m4.2.3.cmml"><mtext id="S3.SS2.SSS1.p1.4.m4.2.3.2" xref="S3.SS2.SSS1.p1.4.m4.2.3.2a.cmml">B</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.4.m4.2.3.1" xref="S3.SS2.SSS1.p1.4.m4.2.3.1.cmml">​</mo><mrow id="S3.SS2.SSS1.p1.4.m4.2.3.3.2" xref="S3.SS2.SSS1.p1.4.m4.2.3.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.4.m4.2.3.3.2.1" xref="S3.SS2.SSS1.p1.4.m4.2.3.3.1.cmml">(</mo><mi id="S3.SS2.SSS1.p1.4.m4.1.1" xref="S3.SS2.SSS1.p1.4.m4.1.1.cmml">I</mi><mo id="S3.SS2.SSS1.p1.4.m4.2.3.3.2.2" xref="S3.SS2.SSS1.p1.4.m4.2.3.3.1.cmml">,</mo><mi id="S3.SS2.SSS1.p1.4.m4.2.2" xref="S3.SS2.SSS1.p1.4.m4.2.2.cmml">ρ</mi><mo stretchy="false" id="S3.SS2.SSS1.p1.4.m4.2.3.3.2.3" xref="S3.SS2.SSS1.p1.4.m4.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.4.m4.2b"><apply id="S3.SS2.SSS1.p1.4.m4.2.3.cmml" xref="S3.SS2.SSS1.p1.4.m4.2.3"><times id="S3.SS2.SSS1.p1.4.m4.2.3.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.2.3.1"></times><ci id="S3.SS2.SSS1.p1.4.m4.2.3.2a.cmml" xref="S3.SS2.SSS1.p1.4.m4.2.3.2"><mtext id="S3.SS2.SSS1.p1.4.m4.2.3.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.2.3.2">B</mtext></ci><interval closure="open" id="S3.SS2.SSS1.p1.4.m4.2.3.3.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.2.3.3.2"><ci id="S3.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p1.4.m4.1.1">𝐼</ci><ci id="S3.SS2.SSS1.p1.4.m4.2.2.cmml" xref="S3.SS2.SSS1.p1.4.m4.2.2">𝜌</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.4.m4.2c">\text{B}(I,\rho)</annotation></semantics></math>, i.e. each client participates independently with probability <math id="S3.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S3.SS2.SSS1.p1.5.m5.1a"><mi id="S3.SS2.SSS1.p1.5.m5.1.1" xref="S3.SS2.SSS1.p1.5.m5.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.5.m5.1b"><ci id="S3.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p1.5.m5.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.5.m5.1c">\rho</annotation></semantics></math>, or (ii) always a fixed number <math id="S3.SS2.SSS1.p1.6.m6.1" class="ltx_Math" alttext="0&lt;r\leq I" display="inline"><semantics id="S3.SS2.SSS1.p1.6.m6.1a"><mrow id="S3.SS2.SSS1.p1.6.m6.1.1" xref="S3.SS2.SSS1.p1.6.m6.1.1.cmml"><mn id="S3.SS2.SSS1.p1.6.m6.1.1.2" xref="S3.SS2.SSS1.p1.6.m6.1.1.2.cmml">0</mn><mo id="S3.SS2.SSS1.p1.6.m6.1.1.3" xref="S3.SS2.SSS1.p1.6.m6.1.1.3.cmml">&lt;</mo><mi id="S3.SS2.SSS1.p1.6.m6.1.1.4" xref="S3.SS2.SSS1.p1.6.m6.1.1.4.cmml">r</mi><mo id="S3.SS2.SSS1.p1.6.m6.1.1.5" xref="S3.SS2.SSS1.p1.6.m6.1.1.5.cmml">≤</mo><mi id="S3.SS2.SSS1.p1.6.m6.1.1.6" xref="S3.SS2.SSS1.p1.6.m6.1.1.6.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.6.m6.1b"><apply id="S3.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1"><and id="S3.SS2.SSS1.p1.6.m6.1.1a.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1"></and><apply id="S3.SS2.SSS1.p1.6.m6.1.1b.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1"><lt id="S3.SS2.SSS1.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.3"></lt><cn type="integer" id="S3.SS2.SSS1.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.2">0</cn><ci id="S3.SS2.SSS1.p1.6.m6.1.1.4.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.4">𝑟</ci></apply><apply id="S3.SS2.SSS1.p1.6.m6.1.1c.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1"><leq id="S3.SS2.SSS1.p1.6.m6.1.1.5.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.5"></leq><share href="#S3.SS2.SSS1.p1.6.m6.1.1.4.cmml" id="S3.SS2.SSS1.p1.6.m6.1.1d.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1"></share><ci id="S3.SS2.SSS1.p1.6.m6.1.1.6.cmml" xref="S3.SS2.SSS1.p1.6.m6.1.1.6">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.6.m6.1c">0&lt;r\leq I</annotation></semantics></math> of clients is uniformly selected, i.e. <math id="S3.SS2.SSS1.p1.7.m7.1" class="ltx_Math" alttext="|\mathcal{I}_{t}|=r" display="inline"><semantics id="S3.SS2.SSS1.p1.7.m7.1a"><mrow id="S3.SS2.SSS1.p1.7.m7.1.1" xref="S3.SS2.SSS1.p1.7.m7.1.1.cmml"><mrow id="S3.SS2.SSS1.p1.7.m7.1.1.1.1" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.2" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.2.1.cmml">|</mo><msub id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.2" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.cmml">ℐ</mi><mi id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.3" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.3.cmml">t</mi></msub><mo stretchy="false" id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.3" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.SS2.SSS1.p1.7.m7.1.1.2" xref="S3.SS2.SSS1.p1.7.m7.1.1.2.cmml">=</mo><mi id="S3.SS2.SSS1.p1.7.m7.1.1.3" xref="S3.SS2.SSS1.p1.7.m7.1.1.3.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.7.m7.1b"><apply id="S3.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1"><eq id="S3.SS2.SSS1.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.2"></eq><apply id="S3.SS2.SSS1.p1.7.m7.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1"><abs id="S3.SS2.SSS1.p1.7.m7.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.2"></abs><apply id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.2">ℐ</ci><ci id="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.1.1.1.3">𝑡</ci></apply></apply><ci id="S3.SS2.SSS1.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS1.p1.7.m7.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.7.m7.1c">|\mathcal{I}_{t}|=r</annotation></semantics></math> for any <math id="S3.SS2.SSS1.p1.8.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.SSS1.p1.8.m8.1a"><mi id="S3.SS2.SSS1.p1.8.m8.1.1" xref="S3.SS2.SSS1.p1.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.8.m8.1b"><ci id="S3.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p1.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.8.m8.1c">t</annotation></semantics></math>. For both cases an arbitrary client <math id="S3.SS2.SSS1.p1.9.m9.3" class="ltx_Math" alttext="i\in\{1,\ldots,I\}" display="inline"><semantics id="S3.SS2.SSS1.p1.9.m9.3a"><mrow id="S3.SS2.SSS1.p1.9.m9.3.4" xref="S3.SS2.SSS1.p1.9.m9.3.4.cmml"><mi id="S3.SS2.SSS1.p1.9.m9.3.4.2" xref="S3.SS2.SSS1.p1.9.m9.3.4.2.cmml">i</mi><mo id="S3.SS2.SSS1.p1.9.m9.3.4.1" xref="S3.SS2.SSS1.p1.9.m9.3.4.1.cmml">∈</mo><mrow id="S3.SS2.SSS1.p1.9.m9.3.4.3.2" xref="S3.SS2.SSS1.p1.9.m9.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS1.p1.9.m9.3.4.3.2.1" xref="S3.SS2.SSS1.p1.9.m9.3.4.3.1.cmml">{</mo><mn id="S3.SS2.SSS1.p1.9.m9.1.1" xref="S3.SS2.SSS1.p1.9.m9.1.1.cmml">1</mn><mo id="S3.SS2.SSS1.p1.9.m9.3.4.3.2.2" xref="S3.SS2.SSS1.p1.9.m9.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS2.SSS1.p1.9.m9.2.2" xref="S3.SS2.SSS1.p1.9.m9.2.2.cmml">…</mi><mo id="S3.SS2.SSS1.p1.9.m9.3.4.3.2.3" xref="S3.SS2.SSS1.p1.9.m9.3.4.3.1.cmml">,</mo><mi id="S3.SS2.SSS1.p1.9.m9.3.3" xref="S3.SS2.SSS1.p1.9.m9.3.3.cmml">I</mi><mo stretchy="false" id="S3.SS2.SSS1.p1.9.m9.3.4.3.2.4" xref="S3.SS2.SSS1.p1.9.m9.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.9.m9.3b"><apply id="S3.SS2.SSS1.p1.9.m9.3.4.cmml" xref="S3.SS2.SSS1.p1.9.m9.3.4"><in id="S3.SS2.SSS1.p1.9.m9.3.4.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.3.4.1"></in><ci id="S3.SS2.SSS1.p1.9.m9.3.4.2.cmml" xref="S3.SS2.SSS1.p1.9.m9.3.4.2">𝑖</ci><set id="S3.SS2.SSS1.p1.9.m9.3.4.3.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.3.4.3.2"><cn type="integer" id="S3.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p1.9.m9.1.1">1</cn><ci id="S3.SS2.SSS1.p1.9.m9.2.2.cmml" xref="S3.SS2.SSS1.p1.9.m9.2.2">…</ci><ci id="S3.SS2.SSS1.p1.9.m9.3.3.cmml" xref="S3.SS2.SSS1.p1.9.m9.3.3">𝐼</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.9.m9.3c">i\in\{1,\ldots,I\}</annotation></semantics></math> participates in each round with probability</p>
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="\text{Pr}(i\in\mathcal{I}_{t})=\frac{r}{I}," display="block"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml"><mtext id="S3.Ex1.m1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.3a.cmml">Pr</mtext><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml">∈</mo><msub id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.2.cmml">ℐ</mi><mi id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex1.m1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.2.cmml">=</mo><mfrac id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m1.1.1.1.1.3.2" xref="S3.Ex1.m1.1.1.1.1.3.2.cmml">r</mi><mi id="S3.Ex1.m1.1.1.1.1.3.3" xref="S3.Ex1.m1.1.1.1.1.3.3.cmml">I</mi></mfrac></mrow><mo id="S3.Ex1.m1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.1b"><apply id="S3.Ex1.m1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1"><eq id="S3.Ex1.m1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.2"></eq><apply id="S3.Ex1.m1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1"><times id="S3.Ex1.m1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.2"></times><ci id="S3.Ex1.m1.1.1.1.1.1.3a.cmml" xref="S3.Ex1.m1.1.1.1.1.1.3"><mtext id="S3.Ex1.m1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.3">Pr</mtext></ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1"><in id="S3.Ex1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.1"></in><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.2">ℐ</ci><ci id="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.Ex1.m1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3"><divide id="S3.Ex1.m1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m1.1.1.1.1.3"></divide><ci id="S3.Ex1.m1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m1.1.1.1.1.3.2">𝑟</ci><ci id="S3.Ex1.m1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m1.1.1.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.1c">\text{Pr}(i\in\mathcal{I}_{t})=\frac{r}{I},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS1.p1.11" class="ltx_p">where for case (i) <math id="S3.SS2.SSS1.p1.10.m1.1" class="ltx_Math" alttext="r=I\rho" display="inline"><semantics id="S3.SS2.SSS1.p1.10.m1.1a"><mrow id="S3.SS2.SSS1.p1.10.m1.1.1" xref="S3.SS2.SSS1.p1.10.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p1.10.m1.1.1.2" xref="S3.SS2.SSS1.p1.10.m1.1.1.2.cmml">r</mi><mo id="S3.SS2.SSS1.p1.10.m1.1.1.1" xref="S3.SS2.SSS1.p1.10.m1.1.1.1.cmml">=</mo><mrow id="S3.SS2.SSS1.p1.10.m1.1.1.3" xref="S3.SS2.SSS1.p1.10.m1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p1.10.m1.1.1.3.2" xref="S3.SS2.SSS1.p1.10.m1.1.1.3.2.cmml">I</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS1.p1.10.m1.1.1.3.1" xref="S3.SS2.SSS1.p1.10.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.SSS1.p1.10.m1.1.1.3.3" xref="S3.SS2.SSS1.p1.10.m1.1.1.3.3.cmml">ρ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.10.m1.1b"><apply id="S3.SS2.SSS1.p1.10.m1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1"><eq id="S3.SS2.SSS1.p1.10.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1.1"></eq><ci id="S3.SS2.SSS1.p1.10.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1.2">𝑟</ci><apply id="S3.SS2.SSS1.p1.10.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1.3"><times id="S3.SS2.SSS1.p1.10.m1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1.3.1"></times><ci id="S3.SS2.SSS1.p1.10.m1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1.3.2">𝐼</ci><ci id="S3.SS2.SSS1.p1.10.m1.1.1.3.3.cmml" xref="S3.SS2.SSS1.p1.10.m1.1.1.3.3">𝜌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.10.m1.1c">r=I\rho</annotation></semantics></math> can be a float number while for case (ii), <math id="S3.SS2.SSS1.p1.11.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S3.SS2.SSS1.p1.11.m2.1a"><mi id="S3.SS2.SSS1.p1.11.m2.1.1" xref="S3.SS2.SSS1.p1.11.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p1.11.m2.1b"><ci id="S3.SS2.SSS1.p1.11.m2.1.1.cmml" xref="S3.SS2.SSS1.p1.11.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p1.11.m2.1c">r</annotation></semantics></math> is strictly an integer.</p>
</div>
</section>
<section id="S3.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Client and Server Updates

</h4>

<section id="S3.SS2.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Client side.</h5>

<div id="S3.SS2.SSS2.Px1.p1" class="ltx_para">
<p id="S3.SS2.SSS2.Px1.p1.11" class="ltx_p">Having first selected the subset of clients <math id="S3.SS2.SSS2.Px1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{I}_{t}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.1.m1.1a"><msub id="S3.SS2.SSS2.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2.cmml">ℐ</mi><mi id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.1.m1.1b"><apply id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.2">ℐ</ci><ci id="S3.SS2.SSS2.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.1.m1.1c">\mathcal{I}_{t}</annotation></semantics></math> to participate in round <math id="S3.SS2.SSS2.Px1.p1.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.2.m2.1a"><mi id="S3.SS2.SSS2.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.2.m2.1b"><ci id="S3.SS2.SSS2.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.2.m2.1c">t</annotation></semantics></math>, the server sends the global model parameters <math id="S3.SS2.SSS2.Px1.p1.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.3.m3.1a"><mi id="S3.SS2.SSS2.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.3.m3.1b"><ci id="S3.SS2.SSS2.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.3.m3.1c">\theta</annotation></semantics></math> to these clients. Then, each client <math id="S3.SS2.SSS2.Px1.p1.4.m4.1" class="ltx_Math" alttext="i\in\mathcal{I}_{t}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.4.m4.1a"><mrow id="S3.SS2.SSS2.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.1" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.1.cmml">∈</mo><msub id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.2.cmml">ℐ</mi><mi id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.4.m4.1b"><apply id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1"><in id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.1"></in><ci id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.2">𝑖</ci><apply id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.2">ℐ</ci><ci id="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.4.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.4.m4.1c">i\in\mathcal{I}_{t}</annotation></semantics></math> trains locally the task specific parameters <math id="S3.SS2.SSS2.Px1.p1.5.m5.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.5.m5.1a"><msub id="S3.SS2.SSS2.Px1.p1.5.m5.1.1" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.2" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.3" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.5.m5.1b"><apply id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1.2">𝑊</ci><ci id="S3.SS2.SSS2.Px1.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.5.m5.1c">W_{i}</annotation></semantics></math> by performing a total number of <math id="S3.SS2.SSS2.Px1.p1.6.m6.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.6.m6.1a"><mi id="S3.SS2.SSS2.Px1.p1.6.m6.1.1" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.6.m6.1b"><ci id="S3.SS2.SSS2.Px1.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.6.m6.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.6.m6.1c">\tau</annotation></semantics></math> gradient descent steps. For the first <math id="S3.SS2.SSS2.Px1.p1.7.m7.1" class="ltx_Math" alttext="\tau-1" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.7.m7.1a"><mrow id="S3.SS2.SSS2.Px1.p1.7.m7.1.1" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.2" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.2.cmml">τ</mi><mo id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.1" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.1.cmml">−</mo><mn id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.3" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.7.m7.1b"><apply id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1"><minus id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.1"></minus><ci id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.2">𝜏</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.7.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.7.m7.1c">\tau-1</annotation></semantics></math> steps, the global parameter <math id="S3.SS2.SSS2.Px1.p1.8.m8.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.8.m8.1a"><mi id="S3.SS2.SSS2.Px1.p1.8.m8.1.1" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.8.m8.1b"><ci id="S3.SS2.SSS2.Px1.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.8.m8.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.8.m8.1c">\theta</annotation></semantics></math> is ”ignored” (it remains fixed to the value sent by the server), and only the gradient <math id="S3.SS2.SSS2.Px1.p1.9.m9.2" class="ltx_Math" alttext="\nabla_{W_{i}}\ell_{i}(W_{i},\theta)" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.9.m9.2a"><mrow id="S3.SS2.SSS2.Px1.p1.9.m9.2.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.cmml"><mrow id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.cmml"><msub id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.cmml"><mo id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.2.cmml">∇</mo><msub id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.2.cmml">W</mi><mi id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.3.cmml">i</mi></msub></msub><msub id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.2.cmml">ℓ</mi><mi id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.2.cmml">(</mo><msub id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.3" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.2.cmml">,</mo><mi id="S3.SS2.SSS2.Px1.p1.9.m9.1.1" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.4" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.9.m9.2b"><apply id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2"><times id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.2"></times><apply id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3"><apply id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.2">∇</ci><apply id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.2">𝑊</ci><ci id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.2">ℓ</ci><ci id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.3.2.3">𝑖</ci></apply></apply><interval closure="open" id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1"><apply id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.2">𝑊</ci><ci id="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.2.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.Px1.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.9.m9.1.1">𝜃</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.9.m9.2c">\nabla_{W_{i}}\ell_{i}(W_{i},\theta)</annotation></semantics></math> over the task parameters <math id="S3.SS2.SSS2.Px1.p1.10.m10.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.10.m10.1a"><msub id="S3.SS2.SSS2.Px1.p1.10.m10.1.1" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.10.m10.1b"><apply id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.2">𝑊</ci><ci id="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.10.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.10.m10.1c">W_{i}</annotation></semantics></math> is computed. The gradient steps of these <math id="S3.SS2.SSS2.Px1.p1.11.m11.1" class="ltx_Math" alttext="\tau-1" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.11.m11.1a"><mrow id="S3.SS2.SSS2.Px1.p1.11.m11.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.cmml">τ</mi><mo id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.1" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.1.cmml">−</mo><mn id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.11.m11.1b"><apply id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1"><minus id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.1"></minus><ci id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.2">𝜏</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.11.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.11.m11.1c">\tau-1</annotation></semantics></math> steps can have the form</p>
<table id="S3.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex2.m1.2" class="ltx_Math" alttext="W_{i}\leftarrow W_{i}-\beta\nabla_{W_{i}}\ell_{i}(W_{i},\theta)," display="block"><semantics id="S3.Ex2.m1.2a"><mrow id="S3.Ex2.m1.2.2.1" xref="S3.Ex2.m1.2.2.1.1.cmml"><mrow id="S3.Ex2.m1.2.2.1.1" xref="S3.Ex2.m1.2.2.1.1.cmml"><msub id="S3.Ex2.m1.2.2.1.1.3" xref="S3.Ex2.m1.2.2.1.1.3.cmml"><mi id="S3.Ex2.m1.2.2.1.1.3.2" xref="S3.Ex2.m1.2.2.1.1.3.2.cmml">W</mi><mi id="S3.Ex2.m1.2.2.1.1.3.3" xref="S3.Ex2.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo stretchy="false" id="S3.Ex2.m1.2.2.1.1.2" xref="S3.Ex2.m1.2.2.1.1.2.cmml">←</mo><mrow id="S3.Ex2.m1.2.2.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.cmml"><msub id="S3.Ex2.m1.2.2.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.3.cmml"><mi id="S3.Ex2.m1.2.2.1.1.1.3.2" xref="S3.Ex2.m1.2.2.1.1.1.3.2.cmml">W</mi><mi id="S3.Ex2.m1.2.2.1.1.1.3.3" xref="S3.Ex2.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.Ex2.m1.2.2.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.2.cmml">−</mo><mrow id="S3.Ex2.m1.2.2.1.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.1.cmml"><mi id="S3.Ex2.m1.2.2.1.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.1.3.cmml">β</mi><mo lspace="0.167em" rspace="0em" id="S3.Ex2.m1.2.2.1.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex2.m1.2.2.1.1.1.1.4" xref="S3.Ex2.m1.2.2.1.1.1.1.4.cmml"><msub id="S3.Ex2.m1.2.2.1.1.1.1.4.1" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S3.Ex2.m1.2.2.1.1.1.1.4.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1.2.cmml">∇</mo><msub id="S3.Ex2.m1.2.2.1.1.1.1.4.1.3" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.cmml"><mi id="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.2" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.2.cmml">W</mi><mi id="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.3" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.3.cmml">i</mi></msub></msub><msub id="S3.Ex2.m1.2.2.1.1.1.1.4.2" xref="S3.Ex2.m1.2.2.1.1.1.1.4.2.cmml"><mi mathvariant="normal" id="S3.Ex2.m1.2.2.1.1.1.1.4.2.2" xref="S3.Ex2.m1.2.2.1.1.1.1.4.2.2.cmml">ℓ</mi><mi id="S3.Ex2.m1.2.2.1.1.1.1.4.2.3" xref="S3.Ex2.m1.2.2.1.1.1.1.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.Ex2.m1.2.2.1.1.1.1.2a" xref="S3.Ex2.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.Ex2.m1.2.2.1.1.1.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Ex2.m1.2.2.1.1.1.1.1.1.3" xref="S3.Ex2.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.4" xref="S3.Ex2.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex2.m1.2.2.1.2" xref="S3.Ex2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.2b"><apply id="S3.Ex2.m1.2.2.1.1.cmml" xref="S3.Ex2.m1.2.2.1"><ci id="S3.Ex2.m1.2.2.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.2">←</ci><apply id="S3.Ex2.m1.2.2.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.3.2">𝑊</ci><ci id="S3.Ex2.m1.2.2.1.1.3.3.cmml" xref="S3.Ex2.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex2.m1.2.2.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1"><minus id="S3.Ex2.m1.2.2.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.2"></minus><apply id="S3.Ex2.m1.2.2.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.1.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3.2">𝑊</ci><ci id="S3.Ex2.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.Ex2.m1.2.2.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1"><times id="S3.Ex2.m1.2.2.1.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.2"></times><ci id="S3.Ex2.m1.2.2.1.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.3">𝛽</ci><apply id="S3.Ex2.m1.2.2.1.1.1.1.4.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4"><apply id="S3.Ex2.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.1.4.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1">subscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.1.1.4.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1.2">∇</ci><apply id="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1.3">subscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.2">𝑊</ci><ci id="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.1.3.3">𝑖</ci></apply></apply><apply id="S3.Ex2.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.1.4.2.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.2">subscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.1.1.4.2.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.2.2">ℓ</ci><ci id="S3.Ex2.m1.2.2.1.1.1.1.4.2.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.4.2.3">𝑖</ci></apply></apply><interval closure="open" id="S3.Ex2.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1"><apply id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">𝜃</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.2c">W_{i}\leftarrow W_{i}-\beta\nabla_{W_{i}}\ell_{i}(W_{i},\theta),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.Px1.p1.21" class="ltx_p">where <math id="S3.SS2.SSS2.Px1.p1.12.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.12.m1.1a"><mi id="S3.SS2.SSS2.Px1.p1.12.m1.1.1" xref="S3.SS2.SSS2.Px1.p1.12.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.12.m1.1b"><ci id="S3.SS2.SSS2.Px1.p1.12.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.12.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.12.m1.1c">\beta</annotation></semantics></math> is some learning rate value. In fact, these <math id="S3.SS2.SSS2.Px1.p1.13.m2.1" class="ltx_Math" alttext="\tau-1" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.13.m2.1a"><mrow id="S3.SS2.SSS2.Px1.p1.13.m2.1.1" xref="S3.SS2.SSS2.Px1.p1.13.m2.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.13.m2.1.1.2" xref="S3.SS2.SSS2.Px1.p1.13.m2.1.1.2.cmml">τ</mi><mo id="S3.SS2.SSS2.Px1.p1.13.m2.1.1.1" xref="S3.SS2.SSS2.Px1.p1.13.m2.1.1.1.cmml">−</mo><mn id="S3.SS2.SSS2.Px1.p1.13.m2.1.1.3" xref="S3.SS2.SSS2.Px1.p1.13.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.13.m2.1b"><apply id="S3.SS2.SSS2.Px1.p1.13.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m2.1.1"><minus id="S3.SS2.SSS2.Px1.p1.13.m2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m2.1.1.1"></minus><ci id="S3.SS2.SSS2.Px1.p1.13.m2.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m2.1.1.2">𝜏</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.13.m2.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.13.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.13.m2.1c">\tau-1</annotation></semantics></math> updates could be replaced by any other optimization procedure, as long as the final loss value <math id="S3.SS2.SSS2.Px1.p1.14.m3.2" class="ltx_Math" alttext="\ell_{i}(W_{i},\theta)" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.14.m3.2a"><mrow id="S3.SS2.SSS2.Px1.p1.14.m3.2.2" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.cmml"><msub id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.2" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.2.cmml">ℓ</mi><mi id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.3" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.2" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.2" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.2.cmml">(</mo><msub id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.3" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.2.cmml">,</mo><mi id="S3.SS2.SSS2.Px1.p1.14.m3.1.1" xref="S3.SS2.SSS2.Px1.p1.14.m3.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.4" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.14.m3.2b"><apply id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2"><times id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.2"></times><apply id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.2">ℓ</ci><ci id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.3.3">𝑖</ci></apply><interval closure="open" id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1"><apply id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.2">𝑊</ci><ci id="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.2.2.1.1.1.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.Px1.p1.14.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.14.m3.1.1">𝜃</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.14.m3.2c">\ell_{i}(W_{i},\theta)</annotation></semantics></math>, i.e. after these <math id="S3.SS2.SSS2.Px1.p1.15.m4.1" class="ltx_Math" alttext="\tau-1" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.15.m4.1a"><mrow id="S3.SS2.SSS2.Px1.p1.15.m4.1.1" xref="S3.SS2.SSS2.Px1.p1.15.m4.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.15.m4.1.1.2" xref="S3.SS2.SSS2.Px1.p1.15.m4.1.1.2.cmml">τ</mi><mo id="S3.SS2.SSS2.Px1.p1.15.m4.1.1.1" xref="S3.SS2.SSS2.Px1.p1.15.m4.1.1.1.cmml">−</mo><mn id="S3.SS2.SSS2.Px1.p1.15.m4.1.1.3" xref="S3.SS2.SSS2.Px1.p1.15.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.15.m4.1b"><apply id="S3.SS2.SSS2.Px1.p1.15.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m4.1.1"><minus id="S3.SS2.SSS2.Px1.p1.15.m4.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m4.1.1.1"></minus><ci id="S3.SS2.SSS2.Px1.p1.15.m4.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m4.1.1.2">𝜏</ci><cn type="integer" id="S3.SS2.SSS2.Px1.p1.15.m4.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.15.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.15.m4.1c">\tau-1</annotation></semantics></math> steps, is smaller or equal to the corresponding initial value.
In contrast, for the final iteration <math id="S3.SS2.SSS2.Px1.p1.16.m5.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.16.m5.1a"><mi id="S3.SS2.SSS2.Px1.p1.16.m5.1.1" xref="S3.SS2.SSS2.Px1.p1.16.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.16.m5.1b"><ci id="S3.SS2.SSS2.Px1.p1.16.m5.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.16.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.16.m5.1c">\tau</annotation></semantics></math>, the client simultaneously computes the joint gradient <math id="S3.SS2.SSS2.Px1.p1.17.m6.2" class="ltx_Math" alttext="(\nabla_{W_{i}}\ell_{i},\nabla_{\theta}\ell_{i})" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.17.m6.2a"><mrow id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.3.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.3.cmml">(</mo><mrow id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.cmml"><msub id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.2.cmml">∇</mo><msub id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.2.cmml">W</mi><mi id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.3.cmml">i</mi></msub></msub><msub id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.2" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.2.cmml">ℓ</mi><mi id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.3" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.3.cmml">i</mi></msub></mrow><mo id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.4" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.3.cmml">,</mo><mrow id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.cmml"><msub id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.cmml"><mo rspace="0.167em" id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.2" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.2.cmml">∇</mo><mi id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.3" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.3.cmml">θ</mi></msub><msub id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.2" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.2.cmml">ℓ</mi><mi id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.3" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.5" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.17.m6.2b"><interval closure="open" id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2"><apply id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1"><apply id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.2">∇</ci><apply id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.2">𝑊</ci><ci id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.2">ℓ</ci><ci id="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.1.1.1.1.2.3">𝑖</ci></apply></apply><apply id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2"><apply id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.2">∇</ci><ci id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.1.3">𝜃</ci></apply><apply id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.2">ℓ</ci><ci id="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.17.m6.2.2.2.2.2.3">𝑖</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.17.m6.2c">(\nabla_{W_{i}}\ell_{i},\nabla_{\theta}\ell_{i})</annotation></semantics></math> of both <math id="S3.SS2.SSS2.Px1.p1.18.m7.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.18.m7.1a"><msub id="S3.SS2.SSS2.Px1.p1.18.m7.1.1" xref="S3.SS2.SSS2.Px1.p1.18.m7.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.18.m7.1.1.2" xref="S3.SS2.SSS2.Px1.p1.18.m7.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS2.Px1.p1.18.m7.1.1.3" xref="S3.SS2.SSS2.Px1.p1.18.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.18.m7.1b"><apply id="S3.SS2.SSS2.Px1.p1.18.m7.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.18.m7.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.18.m7.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m7.1.1.2">𝑊</ci><ci id="S3.SS2.SSS2.Px1.p1.18.m7.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.18.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.18.m7.1c">W_{i}</annotation></semantics></math> and the shared parameters <math id="S3.SS2.SSS2.Px1.p1.19.m8.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.19.m8.1a"><mi id="S3.SS2.SSS2.Px1.p1.19.m8.1.1" xref="S3.SS2.SSS2.Px1.p1.19.m8.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.19.m8.1b"><ci id="S3.SS2.SSS2.Px1.p1.19.m8.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.19.m8.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.19.m8.1c">\theta</annotation></semantics></math>, and it performs the final (<math id="S3.SS2.SSS2.Px1.p1.20.m9.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.20.m9.1a"><mi id="S3.SS2.SSS2.Px1.p1.20.m9.1.1" xref="S3.SS2.SSS2.Px1.p1.20.m9.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.20.m9.1b"><ci id="S3.SS2.SSS2.Px1.p1.20.m9.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.20.m9.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.20.m9.1c">\tau</annotation></semantics></math>-th) gradient step for <math id="S3.SS2.SSS2.Px1.p1.21.m10.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.21.m10.1a"><msub id="S3.SS2.SSS2.Px1.p1.21.m10.1.1" xref="S3.SS2.SSS2.Px1.p1.21.m10.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.21.m10.1.1.2" xref="S3.SS2.SSS2.Px1.p1.21.m10.1.1.2.cmml">W</mi><mi id="S3.SS2.SSS2.Px1.p1.21.m10.1.1.3" xref="S3.SS2.SSS2.Px1.p1.21.m10.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.21.m10.1b"><apply id="S3.SS2.SSS2.Px1.p1.21.m10.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.21.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.21.m10.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.21.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.21.m10.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.21.m10.1.1.2">𝑊</ci><ci id="S3.SS2.SSS2.Px1.p1.21.m10.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.21.m10.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.21.m10.1c">W_{i}</annotation></semantics></math> using the rule</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.2" class="ltx_Math" alttext="W_{i}\leftarrow W_{i}-\rho_{t}\frac{I}{r}\nabla_{W_{i}}\ell_{i}(W_{i},\theta)," display="block"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml"><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.3.2" xref="S3.E4.m1.2.2.1.1.3.2.cmml">W</mi><mi id="S3.E4.m1.2.2.1.1.3.3" xref="S3.E4.m1.2.2.1.1.3.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml">←</mo><mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.3.2.cmml">W</mi><mi id="S3.E4.m1.2.2.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.2.cmml">−</mo><mrow id="S3.E4.m1.2.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.3.2" xref="S3.E4.m1.2.2.1.1.1.1.3.2.cmml">ρ</mi><mi id="S3.E4.m1.2.2.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.1.1.3.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml">​</mo><mfrac id="S3.E4.m1.2.2.1.1.1.1.4" xref="S3.E4.m1.2.2.1.1.1.1.4.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.4.2" xref="S3.E4.m1.2.2.1.1.1.1.4.2.cmml">I</mi><mi id="S3.E4.m1.2.2.1.1.1.1.4.3" xref="S3.E4.m1.2.2.1.1.1.1.4.3.cmml">r</mi></mfrac><mo lspace="0.167em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.2a" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.5" xref="S3.E4.m1.2.2.1.1.1.1.5.cmml"><msub id="S3.E4.m1.2.2.1.1.1.1.5.1" xref="S3.E4.m1.2.2.1.1.1.1.5.1.cmml"><mo rspace="0.167em" id="S3.E4.m1.2.2.1.1.1.1.5.1.2" xref="S3.E4.m1.2.2.1.1.1.1.5.1.2.cmml">∇</mo><msub id="S3.E4.m1.2.2.1.1.1.1.5.1.3" xref="S3.E4.m1.2.2.1.1.1.1.5.1.3.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.5.1.3.2" xref="S3.E4.m1.2.2.1.1.1.1.5.1.3.2.cmml">W</mi><mi id="S3.E4.m1.2.2.1.1.1.1.5.1.3.3" xref="S3.E4.m1.2.2.1.1.1.1.5.1.3.3.cmml">i</mi></msub></msub><msub id="S3.E4.m1.2.2.1.1.1.1.5.2" xref="S3.E4.m1.2.2.1.1.1.1.5.2.cmml"><mi mathvariant="normal" id="S3.E4.m1.2.2.1.1.1.1.5.2.2" xref="S3.E4.m1.2.2.1.1.1.1.5.2.2.cmml">ℓ</mi><mi id="S3.E4.m1.2.2.1.1.1.1.5.2.3" xref="S3.E4.m1.2.2.1.1.1.1.5.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.2.2.1.1.1.1.2b" xref="S3.E4.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E4.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E4.m1.2.2.1.1.1.1.1.1.4" xref="S3.E4.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.2.2.1.2" xref="S3.E4.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b"><apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1"><ci id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2">←</ci><apply id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.3.2">𝑊</ci><ci id="S3.E4.m1.2.2.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.3.3">𝑖</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><minus id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2"></minus><apply id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.3.2">𝑊</ci><ci id="S3.E4.m1.2.2.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1"><times id="S3.E4.m1.2.2.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.2"></times><apply id="S3.E4.m1.2.2.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.2">𝜌</ci><ci id="S3.E4.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4"><divide id="S3.E4.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4"></divide><ci id="S3.E4.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.2">𝐼</ci><ci id="S3.E4.m1.2.2.1.1.1.1.4.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.4.3">𝑟</ci></apply><apply id="S3.E4.m1.2.2.1.1.1.1.5.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5"><apply id="S3.E4.m1.2.2.1.1.1.1.5.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.5.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.5.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.1.2">∇</ci><apply id="S3.E4.m1.2.2.1.1.1.1.5.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.5.1.3.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.1.3">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.5.1.3.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.1.3.2">𝑊</ci><ci id="S3.E4.m1.2.2.1.1.1.1.5.1.3.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.1.3.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.2.2.1.1.1.1.5.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.5.2.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.2">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.5.2.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.2.2">ℓ</ci><ci id="S3.E4.m1.2.2.1.1.1.1.5.2.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.5.2.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E4.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1"><apply id="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.E4.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝜃</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.2c">W_{i}\leftarrow W_{i}-\rho_{t}\frac{I}{r}\nabla_{W_{i}}\ell_{i}(W_{i},\theta),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.Px1.p1.25" class="ltx_p">where <math id="S3.SS2.SSS2.Px1.p1.22.m1.1" class="ltx_Math" alttext="\rho_{t}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.22.m1.1a"><msub id="S3.SS2.SSS2.Px1.p1.22.m1.1.1" xref="S3.SS2.SSS2.Px1.p1.22.m1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.22.m1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.22.m1.1.1.2.cmml">ρ</mi><mi id="S3.SS2.SSS2.Px1.p1.22.m1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.22.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.22.m1.1b"><apply id="S3.SS2.SSS2.Px1.p1.22.m1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.22.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.22.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.22.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.22.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.22.m1.1.1.2">𝜌</ci><ci id="S3.SS2.SSS2.Px1.p1.22.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.22.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.22.m1.1c">\rho_{t}</annotation></semantics></math> is the learning rate at round <math id="S3.SS2.SSS2.Px1.p1.23.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.23.m2.1a"><mi id="S3.SS2.SSS2.Px1.p1.23.m2.1.1" xref="S3.SS2.SSS2.Px1.p1.23.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.23.m2.1b"><ci id="S3.SS2.SSS2.Px1.p1.23.m2.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.23.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.23.m2.1c">t</annotation></semantics></math>, and the multiplicative scalar <math id="S3.SS2.SSS2.Px1.p1.24.m3.1" class="ltx_Math" alttext="\frac{1}{\text{Pr}(i\in\mathcal{I}_{t})}=\frac{I}{r}" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.24.m3.1a"><mrow id="S3.SS2.SSS2.Px1.p1.24.m3.1.2" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2.cmml"><mfrac id="S3.SS2.SSS2.Px1.p1.24.m3.1.1" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.cmml"><mn id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.3" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.3.cmml">1</mn><mrow id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.cmml"><mtext id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.3a.cmml">Pr</mtext><mo lspace="0em" rspace="0em" id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.2.cmml">​</mo><mrow id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.2" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.1" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.1.cmml">∈</mo><msub id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.2.cmml">ℐ</mi><mi id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.3" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.SS2.SSS2.Px1.p1.24.m3.1.2.1" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2.1.cmml">=</mo><mfrac id="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.cmml"><mi id="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.2" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.2.cmml">I</mi><mi id="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.3" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.3.cmml">r</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.24.m3.1b"><apply id="S3.SS2.SSS2.Px1.p1.24.m3.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2"><eq id="S3.SS2.SSS2.Px1.p1.24.m3.1.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2.1"></eq><apply id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1"><divide id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1"></divide><cn type="integer" id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.3">1</cn><apply id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1"><times id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.2"></times><ci id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.3a.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.3"><mtext mathsize="70%" id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.3">Pr</mtext></ci><apply id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1"><in id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.1"></in><ci id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.2">ℐ</ci><ci id="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></apply><apply id="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2"><divide id="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.1.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2"></divide><ci id="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.2.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.2">𝐼</ci><ci id="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.3.cmml" xref="S3.SS2.SSS2.Px1.p1.24.m3.1.2.2.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.24.m3.1c">\frac{1}{\text{Pr}(i\in\mathcal{I}_{t})}=\frac{I}{r}</annotation></semantics></math> ensures unbiasedness of the full gradient update over all parameters <math id="S3.SS2.SSS2.Px1.p1.25.m4.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S3.SS2.SSS2.Px1.p1.25.m4.1a"><mi id="S3.SS2.SSS2.Px1.p1.25.m4.1.1" xref="S3.SS2.SSS2.Px1.p1.25.m4.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px1.p1.25.m4.1b"><ci id="S3.SS2.SSS2.Px1.p1.25.m4.1.1.cmml" xref="S3.SS2.SSS2.Px1.p1.25.m4.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px1.p1.25.m4.1c">\psi</annotation></semantics></math>; see Section <a href="#S3.SS3" title="3.3 Exact Stochastic Gradient Descent Optimization ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>.</p>
</div>
</section>
<section id="S3.SS2.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Server side.</h5>

<div id="S3.SS2.SSS2.Px2.p1" class="ltx_para">
<p id="S3.SS2.SSS2.Px2.p1.1" class="ltx_p">The server gathers all gradients from the participating clients, and then it performs a gradient update to the parameters <math id="S3.SS2.SSS2.Px2.p1.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.1.m1.1a"><mi id="S3.SS2.SSS2.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.1.m1.1b"><ci id="S3.SS2.SSS2.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.1.m1.1c">\theta</annotation></semantics></math> by taking into account also the data proportionality weight of each client. Specifically, the update it performs takes the form</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\theta\leftarrow\theta-\rho_{t}\frac{I}{r}\sum_{i\in\mathcal{I}_{t}}\alpha_{i}\nabla_{\theta}\ell_{i}(W_{i},\theta)," display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.3" xref="S3.E5.m1.2.2.1.1.3.cmml">θ</mi><mo stretchy="false" id="S3.E5.m1.2.2.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml">←</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.3.cmml">θ</mi><mo id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.2.cmml">−</mo><mrow id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.2.cmml">ρ</mi><mi id="S3.E5.m1.2.2.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.3.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">​</mo><mfrac id="S3.E5.m1.2.2.1.1.1.1.4" xref="S3.E5.m1.2.2.1.1.1.1.4.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.4.2" xref="S3.E5.m1.2.2.1.1.1.1.4.2.cmml">I</mi><mi id="S3.E5.m1.2.2.1.1.1.1.4.3" xref="S3.E5.m1.2.2.1.1.1.1.4.3.cmml">r</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.2a" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml"><munder id="S3.E5.m1.2.2.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E5.m1.2.2.1.1.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.2.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.2.cmml">i</mi><mo id="S3.E5.m1.2.2.1.1.1.1.1.2.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.2.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.2.cmml">ℐ</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.3.cmml">t</mi></msub></mrow></munder><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.cmml">α</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.4.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.2.cmml">∇</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.3.cmml">θ</mi></msub><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.cmml"><mi mathvariant="normal" id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.2.cmml">ℓ</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.2a" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1"><ci id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.2">←</ci><ci id="S3.E5.m1.2.2.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.3">𝜃</ci><apply id="S3.E5.m1.2.2.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1"><minus id="S3.E5.m1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.2"></minus><ci id="S3.E5.m1.2.2.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.3">𝜃</ci><apply id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.2">𝜌</ci><ci id="S3.E5.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3">𝑡</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.4"><divide id="S3.E5.m1.2.2.1.1.1.1.4.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.4"></divide><ci id="S3.E5.m1.2.2.1.1.1.1.4.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.4.2">𝐼</ci><ci id="S3.E5.m1.2.2.1.1.1.1.4.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.4.3">𝑟</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"><apply id="S3.E5.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E5.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.2"></sum><apply id="S3.E5.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3"><in id="S3.E5.m1.2.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.1"></in><ci id="S3.E5.m1.2.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.2">𝑖</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.2">ℐ</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.2">𝛼</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4"><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.2">∇</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.1.3">𝜃</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.2">ℓ</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.4.2.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1"><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝜃</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\theta\leftarrow\theta-\rho_{t}\frac{I}{r}\sum_{i\in\mathcal{I}_{t}}\alpha_{i}\nabla_{\theta}\ell_{i}(W_{i},\theta),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS2.Px2.p1.2" class="ltx_p">where again the term <math id="S3.SS2.SSS2.Px2.p1.2.m1.1" class="ltx_Math" alttext="\frac{I}{r}" display="inline"><semantics id="S3.SS2.SSS2.Px2.p1.2.m1.1a"><mfrac id="S3.SS2.SSS2.Px2.p1.2.m1.1.1" xref="S3.SS2.SSS2.Px2.p1.2.m1.1.1.cmml"><mi id="S3.SS2.SSS2.Px2.p1.2.m1.1.1.2" xref="S3.SS2.SSS2.Px2.p1.2.m1.1.1.2.cmml">I</mi><mi id="S3.SS2.SSS2.Px2.p1.2.m1.1.1.3" xref="S3.SS2.SSS2.Px2.p1.2.m1.1.1.3.cmml">r</mi></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.Px2.p1.2.m1.1b"><apply id="S3.SS2.SSS2.Px2.p1.2.m1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m1.1.1"><divide id="S3.SS2.SSS2.Px2.p1.2.m1.1.1.1.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m1.1.1"></divide><ci id="S3.SS2.SSS2.Px2.p1.2.m1.1.1.2.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m1.1.1.2">𝐼</ci><ci id="S3.SS2.SSS2.Px2.p1.2.m1.1.1.3.cmml" xref="S3.SS2.SSS2.Px2.p1.2.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.Px2.p1.2.m1.1c">\frac{I}{r}</annotation></semantics></math> is included to ensure unbiasedness as detailed next. The whole optimization procedure across rounds is described by Algorithm <a href="#alg1" title="Algorithm 1 ‣ Server side. ‣ 3.2.2 Client and Server Updates ‣ 3.2 The Proposed Algorithm ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> PFLEGO</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> <math id="alg1.l1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">T</annotation></semantics></math> rounds, <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\tau</annotation></semantics></math> local gradient updates, <math id="alg1.l1.m3.1" class="ltx_Math" alttext="I" display="inline"><semantics id="alg1.l1.m3.1a"><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">I</annotation></semantics></math> clients, <math id="alg1.l1.m4.1" class="ltx_Math" alttext="r\ll I" display="inline"><semantics id="alg1.l1.m4.1a"><mrow id="alg1.l1.m4.1.1" xref="alg1.l1.m4.1.1.cmml"><mi id="alg1.l1.m4.1.1.2" xref="alg1.l1.m4.1.1.2.cmml">r</mi><mo id="alg1.l1.m4.1.1.1" xref="alg1.l1.m4.1.1.1.cmml">≪</mo><mi id="alg1.l1.m4.1.1.3" xref="alg1.l1.m4.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m4.1b"><apply id="alg1.l1.m4.1.1.cmml" xref="alg1.l1.m4.1.1"><csymbol cd="latexml" id="alg1.l1.m4.1.1.1.cmml" xref="alg1.l1.m4.1.1.1">much-less-than</csymbol><ci id="alg1.l1.m4.1.1.2.cmml" xref="alg1.l1.m4.1.1.2">𝑟</ci><ci id="alg1.l1.m4.1.1.3.cmml" xref="alg1.l1.m4.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m4.1c">r\ll I</annotation></semantics></math> (average) sampled clients per round, <math id="alg1.l1.m5.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="alg1.l1.m5.1a"><msub id="alg1.l1.m5.1.1" xref="alg1.l1.m5.1.1.cmml"><mi id="alg1.l1.m5.1.1.2" xref="alg1.l1.m5.1.1.2.cmml">N</mi><mi id="alg1.l1.m5.1.1.3" xref="alg1.l1.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.m5.1b"><apply id="alg1.l1.m5.1.1.cmml" xref="alg1.l1.m5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m5.1.1.1.cmml" xref="alg1.l1.m5.1.1">subscript</csymbol><ci id="alg1.l1.m5.1.1.2.cmml" xref="alg1.l1.m5.1.1.2">𝑁</ci><ci id="alg1.l1.m5.1.1.3.cmml" xref="alg1.l1.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m5.1c">N_{i}</annotation></semantics></math> data samples at the <math id="alg1.l1.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l1.m6.1a"><mi id="alg1.l1.m6.1.1" xref="alg1.l1.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m6.1b"><ci id="alg1.l1.m6.1.1.cmml" xref="alg1.l1.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m6.1c">i</annotation></semantics></math>-th client
</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">Server:</span>




</div>
<div id="alg1.l3" class="ltx_listingline">     <span id="alg1.l3.1" class="ltx_text ltx_font_sansserif">Initialize</span> global parameters <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\theta_{1}" display="inline"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">θ</mi><mn id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝜃</ci><cn type="integer" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\theta_{1}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">     <span id="alg1.l4.1" class="ltx_text ltx_font_bold">for</span>  round <math id="alg1.l4.m1.4" class="ltx_Math" alttext="t\,=1,2,...,T" display="inline"><semantics id="alg1.l4.m1.4a"><mrow id="alg1.l4.m1.4.5" xref="alg1.l4.m1.4.5.cmml"><mi id="alg1.l4.m1.4.5.2" xref="alg1.l4.m1.4.5.2.cmml">t</mi><mo lspace="0.448em" id="alg1.l4.m1.4.5.1" xref="alg1.l4.m1.4.5.1.cmml">=</mo><mrow id="alg1.l4.m1.4.5.3.2" xref="alg1.l4.m1.4.5.3.1.cmml"><mn id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">1</mn><mo id="alg1.l4.m1.4.5.3.2.1" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mn id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">2</mn><mo id="alg1.l4.m1.4.5.3.2.2" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml">…</mi><mo id="alg1.l4.m1.4.5.3.2.3" xref="alg1.l4.m1.4.5.3.1.cmml">,</mo><mi id="alg1.l4.m1.4.4" xref="alg1.l4.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.4b"><apply id="alg1.l4.m1.4.5.cmml" xref="alg1.l4.m1.4.5"><eq id="alg1.l4.m1.4.5.1.cmml" xref="alg1.l4.m1.4.5.1"></eq><ci id="alg1.l4.m1.4.5.2.cmml" xref="alg1.l4.m1.4.5.2">𝑡</ci><list id="alg1.l4.m1.4.5.3.1.cmml" xref="alg1.l4.m1.4.5.3.2"><cn type="integer" id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">1</cn><cn type="integer" id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">2</cn><ci id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3">…</ci><ci id="alg1.l4.m1.4.4.cmml" xref="alg1.l4.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.4c">t\,=1,2,...,T</annotation></semantics></math> <span id="alg1.l4.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">        <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\mathcal{I}_{t}\leftarrow" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">ℐ</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">ℐ</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathcal{I}_{t}\leftarrow</annotation></semantics></math> (Select a random subset of clients)

</div>
<div id="alg1.l6" class="ltx_listingline">        <span id="alg1.l6.1" class="ltx_text ltx_font_sansserif">Receive</span>
<math id="alg1.l6.m1.1" class="ltx_Math" alttext="\mathbf{g}_{i}" display="inline"><semantics id="alg1.l6.m1.1a"><msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">𝐠</mi><mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">subscript</csymbol><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝐠</ci><ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\mathbf{g}_{i}</annotation></semantics></math> from each <span id="alg1.l6.2" class="ltx_text ltx_font_typewriter">client i</span> <math id="alg1.l6.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg1.l6.m2.1a"><mo id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><in id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">\in</annotation></semantics></math> <math id="alg1.l6.m3.1" class="ltx_Math" alttext="I_{t}" display="inline"><semantics id="alg1.l6.m3.1a"><msub id="alg1.l6.m3.1.1" xref="alg1.l6.m3.1.1.cmml"><mi id="alg1.l6.m3.1.1.2" xref="alg1.l6.m3.1.1.2.cmml">I</mi><mi id="alg1.l6.m3.1.1.3" xref="alg1.l6.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l6.m3.1b"><apply id="alg1.l6.m3.1.1.cmml" xref="alg1.l6.m3.1.1"><csymbol cd="ambiguous" id="alg1.l6.m3.1.1.1.cmml" xref="alg1.l6.m3.1.1">subscript</csymbol><ci id="alg1.l6.m3.1.1.2.cmml" xref="alg1.l6.m3.1.1.2">𝐼</ci><ci id="alg1.l6.m3.1.1.3.cmml" xref="alg1.l6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m3.1c">I_{t}</annotation></semantics></math>
<span id="alg1.l6.3" class="ltx_ERROR undefined">{fleqn}</span>[]
<span id="alg1.l6.4" class="ltx_text ltx_font_sansserif">Aggregate: </span>
<math id="alg1.l6.m4.1" class="ltx_Math" alttext="\theta_{t+1}\leftarrow\theta_{t}-\rho_{t}\frac{I}{r}\sum_{i\in I_{t}}a_{i}\mathbf{g}_{i}" display="inline"><semantics id="alg1.l6.m4.1a"><mrow id="alg1.l6.m4.1.1" xref="alg1.l6.m4.1.1.cmml"><msub id="alg1.l6.m4.1.1.2" xref="alg1.l6.m4.1.1.2.cmml"><mi id="alg1.l6.m4.1.1.2.2" xref="alg1.l6.m4.1.1.2.2.cmml">θ</mi><mrow id="alg1.l6.m4.1.1.2.3" xref="alg1.l6.m4.1.1.2.3.cmml"><mi id="alg1.l6.m4.1.1.2.3.2" xref="alg1.l6.m4.1.1.2.3.2.cmml">t</mi><mo id="alg1.l6.m4.1.1.2.3.1" xref="alg1.l6.m4.1.1.2.3.1.cmml">+</mo><mn id="alg1.l6.m4.1.1.2.3.3" xref="alg1.l6.m4.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg1.l6.m4.1.1.1" xref="alg1.l6.m4.1.1.1.cmml">←</mo><mrow id="alg1.l6.m4.1.1.3" xref="alg1.l6.m4.1.1.3.cmml"><msub id="alg1.l6.m4.1.1.3.2" xref="alg1.l6.m4.1.1.3.2.cmml"><mi id="alg1.l6.m4.1.1.3.2.2" xref="alg1.l6.m4.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l6.m4.1.1.3.2.3" xref="alg1.l6.m4.1.1.3.2.3.cmml">t</mi></msub><mo id="alg1.l6.m4.1.1.3.1" xref="alg1.l6.m4.1.1.3.1.cmml">−</mo><mrow id="alg1.l6.m4.1.1.3.3" xref="alg1.l6.m4.1.1.3.3.cmml"><msub id="alg1.l6.m4.1.1.3.3.2" xref="alg1.l6.m4.1.1.3.3.2.cmml"><mi id="alg1.l6.m4.1.1.3.3.2.2" xref="alg1.l6.m4.1.1.3.3.2.2.cmml">ρ</mi><mi id="alg1.l6.m4.1.1.3.3.2.3" xref="alg1.l6.m4.1.1.3.3.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l6.m4.1.1.3.3.1" xref="alg1.l6.m4.1.1.3.3.1.cmml">​</mo><mfrac id="alg1.l6.m4.1.1.3.3.3" xref="alg1.l6.m4.1.1.3.3.3.cmml"><mi id="alg1.l6.m4.1.1.3.3.3.2" xref="alg1.l6.m4.1.1.3.3.3.2.cmml">I</mi><mi id="alg1.l6.m4.1.1.3.3.3.3" xref="alg1.l6.m4.1.1.3.3.3.3.cmml">r</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l6.m4.1.1.3.3.1a" xref="alg1.l6.m4.1.1.3.3.1.cmml">​</mo><mrow id="alg1.l6.m4.1.1.3.3.4" xref="alg1.l6.m4.1.1.3.3.4.cmml"><msub id="alg1.l6.m4.1.1.3.3.4.1" xref="alg1.l6.m4.1.1.3.3.4.1.cmml"><mo id="alg1.l6.m4.1.1.3.3.4.1.2" xref="alg1.l6.m4.1.1.3.3.4.1.2.cmml">∑</mo><mrow id="alg1.l6.m4.1.1.3.3.4.1.3" xref="alg1.l6.m4.1.1.3.3.4.1.3.cmml"><mi id="alg1.l6.m4.1.1.3.3.4.1.3.2" xref="alg1.l6.m4.1.1.3.3.4.1.3.2.cmml">i</mi><mo id="alg1.l6.m4.1.1.3.3.4.1.3.1" xref="alg1.l6.m4.1.1.3.3.4.1.3.1.cmml">∈</mo><msub id="alg1.l6.m4.1.1.3.3.4.1.3.3" xref="alg1.l6.m4.1.1.3.3.4.1.3.3.cmml"><mi id="alg1.l6.m4.1.1.3.3.4.1.3.3.2" xref="alg1.l6.m4.1.1.3.3.4.1.3.3.2.cmml">I</mi><mi id="alg1.l6.m4.1.1.3.3.4.1.3.3.3" xref="alg1.l6.m4.1.1.3.3.4.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="alg1.l6.m4.1.1.3.3.4.2" xref="alg1.l6.m4.1.1.3.3.4.2.cmml"><msub id="alg1.l6.m4.1.1.3.3.4.2.2" xref="alg1.l6.m4.1.1.3.3.4.2.2.cmml"><mi id="alg1.l6.m4.1.1.3.3.4.2.2.2" xref="alg1.l6.m4.1.1.3.3.4.2.2.2.cmml">a</mi><mi id="alg1.l6.m4.1.1.3.3.4.2.2.3" xref="alg1.l6.m4.1.1.3.3.4.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l6.m4.1.1.3.3.4.2.1" xref="alg1.l6.m4.1.1.3.3.4.2.1.cmml">​</mo><msub id="alg1.l6.m4.1.1.3.3.4.2.3" xref="alg1.l6.m4.1.1.3.3.4.2.3.cmml"><mi id="alg1.l6.m4.1.1.3.3.4.2.3.2" xref="alg1.l6.m4.1.1.3.3.4.2.3.2.cmml">𝐠</mi><mi id="alg1.l6.m4.1.1.3.3.4.2.3.3" xref="alg1.l6.m4.1.1.3.3.4.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m4.1b"><apply id="alg1.l6.m4.1.1.cmml" xref="alg1.l6.m4.1.1"><ci id="alg1.l6.m4.1.1.1.cmml" xref="alg1.l6.m4.1.1.1">←</ci><apply id="alg1.l6.m4.1.1.2.cmml" xref="alg1.l6.m4.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m4.1.1.2.1.cmml" xref="alg1.l6.m4.1.1.2">subscript</csymbol><ci id="alg1.l6.m4.1.1.2.2.cmml" xref="alg1.l6.m4.1.1.2.2">𝜃</ci><apply id="alg1.l6.m4.1.1.2.3.cmml" xref="alg1.l6.m4.1.1.2.3"><plus id="alg1.l6.m4.1.1.2.3.1.cmml" xref="alg1.l6.m4.1.1.2.3.1"></plus><ci id="alg1.l6.m4.1.1.2.3.2.cmml" xref="alg1.l6.m4.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l6.m4.1.1.2.3.3.cmml" xref="alg1.l6.m4.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l6.m4.1.1.3.cmml" xref="alg1.l6.m4.1.1.3"><minus id="alg1.l6.m4.1.1.3.1.cmml" xref="alg1.l6.m4.1.1.3.1"></minus><apply id="alg1.l6.m4.1.1.3.2.cmml" xref="alg1.l6.m4.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l6.m4.1.1.3.2.1.cmml" xref="alg1.l6.m4.1.1.3.2">subscript</csymbol><ci id="alg1.l6.m4.1.1.3.2.2.cmml" xref="alg1.l6.m4.1.1.3.2.2">𝜃</ci><ci id="alg1.l6.m4.1.1.3.2.3.cmml" xref="alg1.l6.m4.1.1.3.2.3">𝑡</ci></apply><apply id="alg1.l6.m4.1.1.3.3.cmml" xref="alg1.l6.m4.1.1.3.3"><times id="alg1.l6.m4.1.1.3.3.1.cmml" xref="alg1.l6.m4.1.1.3.3.1"></times><apply id="alg1.l6.m4.1.1.3.3.2.cmml" xref="alg1.l6.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l6.m4.1.1.3.3.2.1.cmml" xref="alg1.l6.m4.1.1.3.3.2">subscript</csymbol><ci id="alg1.l6.m4.1.1.3.3.2.2.cmml" xref="alg1.l6.m4.1.1.3.3.2.2">𝜌</ci><ci id="alg1.l6.m4.1.1.3.3.2.3.cmml" xref="alg1.l6.m4.1.1.3.3.2.3">𝑡</ci></apply><apply id="alg1.l6.m4.1.1.3.3.3.cmml" xref="alg1.l6.m4.1.1.3.3.3"><divide id="alg1.l6.m4.1.1.3.3.3.1.cmml" xref="alg1.l6.m4.1.1.3.3.3"></divide><ci id="alg1.l6.m4.1.1.3.3.3.2.cmml" xref="alg1.l6.m4.1.1.3.3.3.2">𝐼</ci><ci id="alg1.l6.m4.1.1.3.3.3.3.cmml" xref="alg1.l6.m4.1.1.3.3.3.3">𝑟</ci></apply><apply id="alg1.l6.m4.1.1.3.3.4.cmml" xref="alg1.l6.m4.1.1.3.3.4"><apply id="alg1.l6.m4.1.1.3.3.4.1.cmml" xref="alg1.l6.m4.1.1.3.3.4.1"><csymbol cd="ambiguous" id="alg1.l6.m4.1.1.3.3.4.1.1.cmml" xref="alg1.l6.m4.1.1.3.3.4.1">subscript</csymbol><sum id="alg1.l6.m4.1.1.3.3.4.1.2.cmml" xref="alg1.l6.m4.1.1.3.3.4.1.2"></sum><apply id="alg1.l6.m4.1.1.3.3.4.1.3.cmml" xref="alg1.l6.m4.1.1.3.3.4.1.3"><in id="alg1.l6.m4.1.1.3.3.4.1.3.1.cmml" xref="alg1.l6.m4.1.1.3.3.4.1.3.1"></in><ci id="alg1.l6.m4.1.1.3.3.4.1.3.2.cmml" xref="alg1.l6.m4.1.1.3.3.4.1.3.2">𝑖</ci><apply id="alg1.l6.m4.1.1.3.3.4.1.3.3.cmml" xref="alg1.l6.m4.1.1.3.3.4.1.3.3"><csymbol cd="ambiguous" id="alg1.l6.m4.1.1.3.3.4.1.3.3.1.cmml" xref="alg1.l6.m4.1.1.3.3.4.1.3.3">subscript</csymbol><ci id="alg1.l6.m4.1.1.3.3.4.1.3.3.2.cmml" xref="alg1.l6.m4.1.1.3.3.4.1.3.3.2">𝐼</ci><ci id="alg1.l6.m4.1.1.3.3.4.1.3.3.3.cmml" xref="alg1.l6.m4.1.1.3.3.4.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l6.m4.1.1.3.3.4.2.cmml" xref="alg1.l6.m4.1.1.3.3.4.2"><times id="alg1.l6.m4.1.1.3.3.4.2.1.cmml" xref="alg1.l6.m4.1.1.3.3.4.2.1"></times><apply id="alg1.l6.m4.1.1.3.3.4.2.2.cmml" xref="alg1.l6.m4.1.1.3.3.4.2.2"><csymbol cd="ambiguous" id="alg1.l6.m4.1.1.3.3.4.2.2.1.cmml" xref="alg1.l6.m4.1.1.3.3.4.2.2">subscript</csymbol><ci id="alg1.l6.m4.1.1.3.3.4.2.2.2.cmml" xref="alg1.l6.m4.1.1.3.3.4.2.2.2">𝑎</ci><ci id="alg1.l6.m4.1.1.3.3.4.2.2.3.cmml" xref="alg1.l6.m4.1.1.3.3.4.2.2.3">𝑖</ci></apply><apply id="alg1.l6.m4.1.1.3.3.4.2.3.cmml" xref="alg1.l6.m4.1.1.3.3.4.2.3"><csymbol cd="ambiguous" id="alg1.l6.m4.1.1.3.3.4.2.3.1.cmml" xref="alg1.l6.m4.1.1.3.3.4.2.3">subscript</csymbol><ci id="alg1.l6.m4.1.1.3.3.4.2.3.2.cmml" xref="alg1.l6.m4.1.1.3.3.4.2.3.2">𝐠</ci><ci id="alg1.l6.m4.1.1.3.3.4.2.3.3.cmml" xref="alg1.l6.m4.1.1.3.3.4.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m4.1c">\theta_{t+1}\leftarrow\theta_{t}-\rho_{t}\frac{I}{r}\sum_{i\in I_{t}}a_{i}\mathbf{g}_{i}</annotation></semantics></math>


</div>
<div id="alg1.l7" class="ltx_listingline">     <span id="alg1.l7.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l7.2" class="ltx_text ltx_font_bold">for</span>

</div>
<div id="alg1.l8" class="ltx_listingline">  
</div>
<div id="alg1.l9" class="ltx_listingline">  <span id="alg1.l9.1" class="ltx_text ltx_font_bold">ClientI_Update(<math id="alg1.l9.1.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="alg1.l9.1.m1.1a"><msub id="alg1.l9.1.m1.1.1" xref="alg1.l9.1.m1.1.1.cmml"><mi id="alg1.l9.1.m1.1.1.2" xref="alg1.l9.1.m1.1.1.2.cmml">θ</mi><mi id="alg1.l9.1.m1.1.1.3" xref="alg1.l9.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l9.1.m1.1b"><apply id="alg1.l9.1.m1.1.1.cmml" xref="alg1.l9.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l9.1.m1.1.1.1.cmml" xref="alg1.l9.1.m1.1.1">subscript</csymbol><ci id="alg1.l9.1.m1.1.1.2.cmml" xref="alg1.l9.1.m1.1.1.2">𝜃</ci><ci id="alg1.l9.1.m1.1.1.3.cmml" xref="alg1.l9.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.1.m1.1c">\theta_{t}</annotation></semantics></math>):</span>#runs on client <math id="alg1.l9.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l9.m1.1a"><mi id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><ci id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">i</annotation></semantics></math>




</div>
<div id="alg1.l10" class="ltx_listingline">     <span id="alg1.l10.1" class="ltx_text ltx_font_sansserif">Initialize</span> <math id="alg1.l10.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="alg1.l10.m1.1a"><msub id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">W</mi><mi id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑊</ci><ci id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">W_{i}</annotation></semantics></math>, the first time client <math id="alg1.l10.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg1.l10.m2.1a"><mi id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><ci id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">i</annotation></semantics></math> is visited

</div>
<div id="alg1.l11" class="ltx_listingline">     <span id="alg1.l11.1" class="ltx_text ltx_font_bold">for</span> local gradient
update <math id="alg1.l11.m1.4" class="ltx_Math" alttext="=1,2,...,\tau-1" display="inline"><semantics id="alg1.l11.m1.4a"><mrow id="alg1.l11.m1.4.4" xref="alg1.l11.m1.4.4.cmml"><mi id="alg1.l11.m1.4.4.3" xref="alg1.l11.m1.4.4.3.cmml"></mi><mo id="alg1.l11.m1.4.4.2" xref="alg1.l11.m1.4.4.2.cmml">=</mo><mrow id="alg1.l11.m1.4.4.1.1" xref="alg1.l11.m1.4.4.1.2.cmml"><mn id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">1</mn><mo id="alg1.l11.m1.4.4.1.1.2" xref="alg1.l11.m1.4.4.1.2.cmml">,</mo><mn id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml">2</mn><mo id="alg1.l11.m1.4.4.1.1.3" xref="alg1.l11.m1.4.4.1.2.cmml">,</mo><mi mathvariant="normal" id="alg1.l11.m1.3.3" xref="alg1.l11.m1.3.3.cmml">…</mi><mo id="alg1.l11.m1.4.4.1.1.4" xref="alg1.l11.m1.4.4.1.2.cmml">,</mo><mrow id="alg1.l11.m1.4.4.1.1.1" xref="alg1.l11.m1.4.4.1.1.1.cmml"><mi id="alg1.l11.m1.4.4.1.1.1.2" xref="alg1.l11.m1.4.4.1.1.1.2.cmml">τ</mi><mo id="alg1.l11.m1.4.4.1.1.1.1" xref="alg1.l11.m1.4.4.1.1.1.1.cmml">−</mo><mn id="alg1.l11.m1.4.4.1.1.1.3" xref="alg1.l11.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.4b"><apply id="alg1.l11.m1.4.4.cmml" xref="alg1.l11.m1.4.4"><eq id="alg1.l11.m1.4.4.2.cmml" xref="alg1.l11.m1.4.4.2"></eq><csymbol cd="latexml" id="alg1.l11.m1.4.4.3.cmml" xref="alg1.l11.m1.4.4.3">absent</csymbol><list id="alg1.l11.m1.4.4.1.2.cmml" xref="alg1.l11.m1.4.4.1.1"><cn type="integer" id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">1</cn><cn type="integer" id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2">2</cn><ci id="alg1.l11.m1.3.3.cmml" xref="alg1.l11.m1.3.3">…</ci><apply id="alg1.l11.m1.4.4.1.1.1.cmml" xref="alg1.l11.m1.4.4.1.1.1"><minus id="alg1.l11.m1.4.4.1.1.1.1.cmml" xref="alg1.l11.m1.4.4.1.1.1.1"></minus><ci id="alg1.l11.m1.4.4.1.1.1.2.cmml" xref="alg1.l11.m1.4.4.1.1.1.2">𝜏</ci><cn type="integer" id="alg1.l11.m1.4.4.1.1.1.3.cmml" xref="alg1.l11.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.4c">=1,2,...,\tau-1</annotation></semantics></math> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l12" class="ltx_listingline">        <math id="alg1.l12.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="alg1.l12.m1.1a"><msub id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi id="alg1.l12.m1.1.1.2" xref="alg1.l12.m1.1.1.2.cmml">W</mi><mi id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1.2">𝑊</ci><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">W_{i}</annotation></semantics></math> <math id="alg1.l12.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg1.l12.m2.1a"><mo stretchy="false" id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><ci id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg1.l12.m3.1" class="ltx_Math" alttext="W_{i}-\beta" display="inline"><semantics id="alg1.l12.m3.1a"><mrow id="alg1.l12.m3.1.1" xref="alg1.l12.m3.1.1.cmml"><msub id="alg1.l12.m3.1.1.2" xref="alg1.l12.m3.1.1.2.cmml"><mi id="alg1.l12.m3.1.1.2.2" xref="alg1.l12.m3.1.1.2.2.cmml">W</mi><mi id="alg1.l12.m3.1.1.2.3" xref="alg1.l12.m3.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l12.m3.1.1.1" xref="alg1.l12.m3.1.1.1.cmml">−</mo><mi id="alg1.l12.m3.1.1.3" xref="alg1.l12.m3.1.1.3.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m3.1b"><apply id="alg1.l12.m3.1.1.cmml" xref="alg1.l12.m3.1.1"><minus id="alg1.l12.m3.1.1.1.cmml" xref="alg1.l12.m3.1.1.1"></minus><apply id="alg1.l12.m3.1.1.2.cmml" xref="alg1.l12.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l12.m3.1.1.2.1.cmml" xref="alg1.l12.m3.1.1.2">subscript</csymbol><ci id="alg1.l12.m3.1.1.2.2.cmml" xref="alg1.l12.m3.1.1.2.2">𝑊</ci><ci id="alg1.l12.m3.1.1.2.3.cmml" xref="alg1.l12.m3.1.1.2.3">𝑖</ci></apply><ci id="alg1.l12.m3.1.1.3.cmml" xref="alg1.l12.m3.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m3.1c">W_{i}-\beta</annotation></semantics></math> <math id="alg1.l12.m4.1" class="ltx_Math" alttext="\nabla_{W_{i}}" display="inline"><semantics id="alg1.l12.m4.1a"><msub id="alg1.l12.m4.1.1" xref="alg1.l12.m4.1.1.cmml"><mo id="alg1.l12.m4.1.1.2" xref="alg1.l12.m4.1.1.2.cmml">∇</mo><msub id="alg1.l12.m4.1.1.3" xref="alg1.l12.m4.1.1.3.cmml"><mi id="alg1.l12.m4.1.1.3.2" xref="alg1.l12.m4.1.1.3.2.cmml">W</mi><mi id="alg1.l12.m4.1.1.3.3" xref="alg1.l12.m4.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg1.l12.m4.1b"><apply id="alg1.l12.m4.1.1.cmml" xref="alg1.l12.m4.1.1"><csymbol cd="ambiguous" id="alg1.l12.m4.1.1.1.cmml" xref="alg1.l12.m4.1.1">subscript</csymbol><ci id="alg1.l12.m4.1.1.2.cmml" xref="alg1.l12.m4.1.1.2">∇</ci><apply id="alg1.l12.m4.1.1.3.cmml" xref="alg1.l12.m4.1.1.3"><csymbol cd="ambiguous" id="alg1.l12.m4.1.1.3.1.cmml" xref="alg1.l12.m4.1.1.3">subscript</csymbol><ci id="alg1.l12.m4.1.1.3.2.cmml" xref="alg1.l12.m4.1.1.3.2">𝑊</ci><ci id="alg1.l12.m4.1.1.3.3.cmml" xref="alg1.l12.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m4.1c">\nabla_{W_{i}}</annotation></semantics></math><math id="alg1.l12.m5.2" class="ltx_Math" alttext="\ell_{i}(W_{i},\theta_{t})" display="inline"><semantics id="alg1.l12.m5.2a"><mrow id="alg1.l12.m5.2.2" xref="alg1.l12.m5.2.2.cmml"><msub id="alg1.l12.m5.2.2.4" xref="alg1.l12.m5.2.2.4.cmml"><mi mathvariant="normal" id="alg1.l12.m5.2.2.4.2" xref="alg1.l12.m5.2.2.4.2.cmml">ℓ</mi><mi id="alg1.l12.m5.2.2.4.3" xref="alg1.l12.m5.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l12.m5.2.2.3" xref="alg1.l12.m5.2.2.3.cmml">​</mo><mrow id="alg1.l12.m5.2.2.2.2" xref="alg1.l12.m5.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l12.m5.2.2.2.2.3" xref="alg1.l12.m5.2.2.2.3.cmml">(</mo><msub id="alg1.l12.m5.1.1.1.1.1" xref="alg1.l12.m5.1.1.1.1.1.cmml"><mi id="alg1.l12.m5.1.1.1.1.1.2" xref="alg1.l12.m5.1.1.1.1.1.2.cmml">W</mi><mi id="alg1.l12.m5.1.1.1.1.1.3" xref="alg1.l12.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l12.m5.2.2.2.2.4" xref="alg1.l12.m5.2.2.2.3.cmml">,</mo><msub id="alg1.l12.m5.2.2.2.2.2" xref="alg1.l12.m5.2.2.2.2.2.cmml"><mi id="alg1.l12.m5.2.2.2.2.2.2" xref="alg1.l12.m5.2.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l12.m5.2.2.2.2.2.3" xref="alg1.l12.m5.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l12.m5.2.2.2.2.5" xref="alg1.l12.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m5.2b"><apply id="alg1.l12.m5.2.2.cmml" xref="alg1.l12.m5.2.2"><times id="alg1.l12.m5.2.2.3.cmml" xref="alg1.l12.m5.2.2.3"></times><apply id="alg1.l12.m5.2.2.4.cmml" xref="alg1.l12.m5.2.2.4"><csymbol cd="ambiguous" id="alg1.l12.m5.2.2.4.1.cmml" xref="alg1.l12.m5.2.2.4">subscript</csymbol><ci id="alg1.l12.m5.2.2.4.2.cmml" xref="alg1.l12.m5.2.2.4.2">ℓ</ci><ci id="alg1.l12.m5.2.2.4.3.cmml" xref="alg1.l12.m5.2.2.4.3">𝑖</ci></apply><interval closure="open" id="alg1.l12.m5.2.2.2.3.cmml" xref="alg1.l12.m5.2.2.2.2"><apply id="alg1.l12.m5.1.1.1.1.1.cmml" xref="alg1.l12.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m5.1.1.1.1.1.1.cmml" xref="alg1.l12.m5.1.1.1.1.1">subscript</csymbol><ci id="alg1.l12.m5.1.1.1.1.1.2.cmml" xref="alg1.l12.m5.1.1.1.1.1.2">𝑊</ci><ci id="alg1.l12.m5.1.1.1.1.1.3.cmml" xref="alg1.l12.m5.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l12.m5.2.2.2.2.2.cmml" xref="alg1.l12.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m5.2.2.2.2.2.1.cmml" xref="alg1.l12.m5.2.2.2.2.2">subscript</csymbol><ci id="alg1.l12.m5.2.2.2.2.2.2.cmml" xref="alg1.l12.m5.2.2.2.2.2.2">𝜃</ci><ci id="alg1.l12.m5.2.2.2.2.2.3.cmml" xref="alg1.l12.m5.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m5.2c">\ell_{i}(W_{i},\theta_{t})</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">     <span id="alg1.l13.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l14" class="ltx_listingline">     <span id="alg1.l14.1" class="ltx_text ltx_font_sansserif">Compute joint grad</span> <math id="alg1.l14.m1.2" class="ltx_Math" alttext="(\nabla_{W_{i}}\ell_{i}(W_{i},\theta_{t}),\nabla_{\theta_{t}}\ell_{i}(W_{i},\theta_{t}))" display="inline"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.2.2" xref="alg1.l14.m1.2.2.3.cmml"><mo stretchy="false" id="alg1.l14.m1.2.2.2.3" xref="alg1.l14.m1.2.2.3.cmml">(</mo><mrow id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.cmml"><mrow id="alg1.l14.m1.1.1.1.1.4" xref="alg1.l14.m1.1.1.1.1.4.cmml"><msub id="alg1.l14.m1.1.1.1.1.4.1" xref="alg1.l14.m1.1.1.1.1.4.1.cmml"><mo rspace="0.167em" id="alg1.l14.m1.1.1.1.1.4.1.2" xref="alg1.l14.m1.1.1.1.1.4.1.2.cmml">∇</mo><msub id="alg1.l14.m1.1.1.1.1.4.1.3" xref="alg1.l14.m1.1.1.1.1.4.1.3.cmml"><mi id="alg1.l14.m1.1.1.1.1.4.1.3.2" xref="alg1.l14.m1.1.1.1.1.4.1.3.2.cmml">W</mi><mi id="alg1.l14.m1.1.1.1.1.4.1.3.3" xref="alg1.l14.m1.1.1.1.1.4.1.3.3.cmml">i</mi></msub></msub><msub id="alg1.l14.m1.1.1.1.1.4.2" xref="alg1.l14.m1.1.1.1.1.4.2.cmml"><mi mathvariant="normal" id="alg1.l14.m1.1.1.1.1.4.2.2" xref="alg1.l14.m1.1.1.1.1.4.2.2.cmml">ℓ</mi><mi id="alg1.l14.m1.1.1.1.1.4.2.3" xref="alg1.l14.m1.1.1.1.1.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l14.m1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.3.cmml">​</mo><mrow id="alg1.l14.m1.1.1.1.1.2.2" xref="alg1.l14.m1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.2.2.3" xref="alg1.l14.m1.1.1.1.1.2.3.cmml">(</mo><msub id="alg1.l14.m1.1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l14.m1.1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="alg1.l14.m1.1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l14.m1.1.1.1.1.2.2.4" xref="alg1.l14.m1.1.1.1.1.2.3.cmml">,</mo><msub id="alg1.l14.m1.1.1.1.1.2.2.2" xref="alg1.l14.m1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l14.m1.1.1.1.1.2.2.2.2" xref="alg1.l14.m1.1.1.1.1.2.2.2.2.cmml">θ</mi><mi id="alg1.l14.m1.1.1.1.1.2.2.2.3" xref="alg1.l14.m1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l14.m1.1.1.1.1.2.2.5" xref="alg1.l14.m1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="alg1.l14.m1.2.2.2.4" xref="alg1.l14.m1.2.2.3.cmml">,</mo><mrow id="alg1.l14.m1.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.cmml"><mrow id="alg1.l14.m1.2.2.2.2.4" xref="alg1.l14.m1.2.2.2.2.4.cmml"><msub id="alg1.l14.m1.2.2.2.2.4.1" xref="alg1.l14.m1.2.2.2.2.4.1.cmml"><mo rspace="0.167em" id="alg1.l14.m1.2.2.2.2.4.1.2" xref="alg1.l14.m1.2.2.2.2.4.1.2.cmml">∇</mo><msub id="alg1.l14.m1.2.2.2.2.4.1.3" xref="alg1.l14.m1.2.2.2.2.4.1.3.cmml"><mi id="alg1.l14.m1.2.2.2.2.4.1.3.2" xref="alg1.l14.m1.2.2.2.2.4.1.3.2.cmml">θ</mi><mi id="alg1.l14.m1.2.2.2.2.4.1.3.3" xref="alg1.l14.m1.2.2.2.2.4.1.3.3.cmml">t</mi></msub></msub><msub id="alg1.l14.m1.2.2.2.2.4.2" xref="alg1.l14.m1.2.2.2.2.4.2.cmml"><mi mathvariant="normal" id="alg1.l14.m1.2.2.2.2.4.2.2" xref="alg1.l14.m1.2.2.2.2.4.2.2.cmml">ℓ</mi><mi id="alg1.l14.m1.2.2.2.2.4.2.3" xref="alg1.l14.m1.2.2.2.2.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.2.2.2.3" xref="alg1.l14.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l14.m1.2.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l14.m1.2.2.2.2.2.2.3" xref="alg1.l14.m1.2.2.2.2.2.3.cmml">(</mo><msub id="alg1.l14.m1.2.2.2.2.1.1.1" xref="alg1.l14.m1.2.2.2.2.1.1.1.cmml"><mi id="alg1.l14.m1.2.2.2.2.1.1.1.2" xref="alg1.l14.m1.2.2.2.2.1.1.1.2.cmml">W</mi><mi id="alg1.l14.m1.2.2.2.2.1.1.1.3" xref="alg1.l14.m1.2.2.2.2.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l14.m1.2.2.2.2.2.2.4" xref="alg1.l14.m1.2.2.2.2.2.3.cmml">,</mo><msub id="alg1.l14.m1.2.2.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.2.2.cmml"><mi id="alg1.l14.m1.2.2.2.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l14.m1.2.2.2.2.2.2.2.3" xref="alg1.l14.m1.2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l14.m1.2.2.2.2.2.2.5" xref="alg1.l14.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l14.m1.2.2.2.5" xref="alg1.l14.m1.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><interval closure="open" id="alg1.l14.m1.2.2.3.cmml" xref="alg1.l14.m1.2.2.2"><apply id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1"><times id="alg1.l14.m1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.3"></times><apply id="alg1.l14.m1.1.1.1.1.4.cmml" xref="alg1.l14.m1.1.1.1.1.4"><apply id="alg1.l14.m1.1.1.1.1.4.1.cmml" xref="alg1.l14.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.4.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.4.1">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.4.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.4.1.2">∇</ci><apply id="alg1.l14.m1.1.1.1.1.4.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.4.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.4.1.3.1.cmml" xref="alg1.l14.m1.1.1.1.1.4.1.3">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.4.1.3.2.cmml" xref="alg1.l14.m1.1.1.1.1.4.1.3.2">𝑊</ci><ci id="alg1.l14.m1.1.1.1.1.4.1.3.3.cmml" xref="alg1.l14.m1.1.1.1.1.4.1.3.3">𝑖</ci></apply></apply><apply id="alg1.l14.m1.1.1.1.1.4.2.cmml" xref="alg1.l14.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.4.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.4.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.4.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.4.2.2">ℓ</ci><ci id="alg1.l14.m1.1.1.1.1.4.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.4.2.3">𝑖</ci></apply></apply><interval closure="open" id="alg1.l14.m1.1.1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.2.2"><apply id="alg1.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="alg1.l14.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l14.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l14.m1.1.1.1.1.2.2.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l14.m1.1.1.1.1.2.2.2.2">𝜃</ci><ci id="alg1.l14.m1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l14.m1.1.1.1.1.2.2.2.3">𝑡</ci></apply></interval></apply><apply id="alg1.l14.m1.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2"><times id="alg1.l14.m1.2.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.3"></times><apply id="alg1.l14.m1.2.2.2.2.4.cmml" xref="alg1.l14.m1.2.2.2.2.4"><apply id="alg1.l14.m1.2.2.2.2.4.1.cmml" xref="alg1.l14.m1.2.2.2.2.4.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.4.1.1.cmml" xref="alg1.l14.m1.2.2.2.2.4.1">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.2.4.1.2.cmml" xref="alg1.l14.m1.2.2.2.2.4.1.2">∇</ci><apply id="alg1.l14.m1.2.2.2.2.4.1.3.cmml" xref="alg1.l14.m1.2.2.2.2.4.1.3"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.4.1.3.1.cmml" xref="alg1.l14.m1.2.2.2.2.4.1.3">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.2.4.1.3.2.cmml" xref="alg1.l14.m1.2.2.2.2.4.1.3.2">𝜃</ci><ci id="alg1.l14.m1.2.2.2.2.4.1.3.3.cmml" xref="alg1.l14.m1.2.2.2.2.4.1.3.3">𝑡</ci></apply></apply><apply id="alg1.l14.m1.2.2.2.2.4.2.cmml" xref="alg1.l14.m1.2.2.2.2.4.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.4.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.4.2">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.2.4.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.4.2.2">ℓ</ci><ci id="alg1.l14.m1.2.2.2.2.4.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.4.2.3">𝑖</ci></apply></apply><interval closure="open" id="alg1.l14.m1.2.2.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.2"><apply id="alg1.l14.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l14.m1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.1.1.1.1.cmml" xref="alg1.l14.m1.2.2.2.2.1.1.1">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.2.1.1.1.2.cmml" xref="alg1.l14.m1.2.2.2.2.1.1.1.2">𝑊</ci><ci id="alg1.l14.m1.2.2.2.2.1.1.1.3.cmml" xref="alg1.l14.m1.2.2.2.2.1.1.1.3">𝑖</ci></apply><apply id="alg1.l14.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l14.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.2.2">𝜃</ci><ci id="alg1.l14.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">(\nabla_{W_{i}}\ell_{i}(W_{i},\theta_{t}),\nabla_{\theta_{t}}\ell_{i}(W_{i},\theta_{t}))</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">     <math id="alg1.l15.m1.2" class="ltx_Math" alttext="W_{i}\leftarrow W_{i}-\rho_{t}\frac{I}{r}\nabla_{W_{i}}\ell_{i}(W_{i},\theta_{t})" display="inline"><semantics id="alg1.l15.m1.2a"><mrow id="alg1.l15.m1.2.2" xref="alg1.l15.m1.2.2.cmml"><msub id="alg1.l15.m1.2.2.4" xref="alg1.l15.m1.2.2.4.cmml"><mi id="alg1.l15.m1.2.2.4.2" xref="alg1.l15.m1.2.2.4.2.cmml">W</mi><mi id="alg1.l15.m1.2.2.4.3" xref="alg1.l15.m1.2.2.4.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l15.m1.2.2.3" xref="alg1.l15.m1.2.2.3.cmml">←</mo><mrow id="alg1.l15.m1.2.2.2" xref="alg1.l15.m1.2.2.2.cmml"><msub id="alg1.l15.m1.2.2.2.4" xref="alg1.l15.m1.2.2.2.4.cmml"><mi id="alg1.l15.m1.2.2.2.4.2" xref="alg1.l15.m1.2.2.2.4.2.cmml">W</mi><mi id="alg1.l15.m1.2.2.2.4.3" xref="alg1.l15.m1.2.2.2.4.3.cmml">i</mi></msub><mo id="alg1.l15.m1.2.2.2.3" xref="alg1.l15.m1.2.2.2.3.cmml">−</mo><mrow id="alg1.l15.m1.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.cmml"><msub id="alg1.l15.m1.2.2.2.2.4" xref="alg1.l15.m1.2.2.2.2.4.cmml"><mi id="alg1.l15.m1.2.2.2.2.4.2" xref="alg1.l15.m1.2.2.2.2.4.2.cmml">ρ</mi><mi id="alg1.l15.m1.2.2.2.2.4.3" xref="alg1.l15.m1.2.2.2.2.4.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l15.m1.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.2.3.cmml">​</mo><mfrac id="alg1.l15.m1.2.2.2.2.5" xref="alg1.l15.m1.2.2.2.2.5.cmml"><mi id="alg1.l15.m1.2.2.2.2.5.2" xref="alg1.l15.m1.2.2.2.2.5.2.cmml">I</mi><mi id="alg1.l15.m1.2.2.2.2.5.3" xref="alg1.l15.m1.2.2.2.2.5.3.cmml">r</mi></mfrac><mo lspace="0.167em" rspace="0em" id="alg1.l15.m1.2.2.2.2.3a" xref="alg1.l15.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l15.m1.2.2.2.2.6" xref="alg1.l15.m1.2.2.2.2.6.cmml"><msub id="alg1.l15.m1.2.2.2.2.6.1" xref="alg1.l15.m1.2.2.2.2.6.1.cmml"><mo rspace="0.167em" id="alg1.l15.m1.2.2.2.2.6.1.2" xref="alg1.l15.m1.2.2.2.2.6.1.2.cmml">∇</mo><msub id="alg1.l15.m1.2.2.2.2.6.1.3" xref="alg1.l15.m1.2.2.2.2.6.1.3.cmml"><mi id="alg1.l15.m1.2.2.2.2.6.1.3.2" xref="alg1.l15.m1.2.2.2.2.6.1.3.2.cmml">W</mi><mi id="alg1.l15.m1.2.2.2.2.6.1.3.3" xref="alg1.l15.m1.2.2.2.2.6.1.3.3.cmml">i</mi></msub></msub><msub id="alg1.l15.m1.2.2.2.2.6.2" xref="alg1.l15.m1.2.2.2.2.6.2.cmml"><mi mathvariant="normal" id="alg1.l15.m1.2.2.2.2.6.2.2" xref="alg1.l15.m1.2.2.2.2.6.2.2.cmml">ℓ</mi><mi id="alg1.l15.m1.2.2.2.2.6.2.3" xref="alg1.l15.m1.2.2.2.2.6.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l15.m1.2.2.2.2.3b" xref="alg1.l15.m1.2.2.2.2.3.cmml">​</mo><mrow id="alg1.l15.m1.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l15.m1.2.2.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.2.2.3.cmml">(</mo><msub id="alg1.l15.m1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml"><mi id="alg1.l15.m1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml">W</mi><mi id="alg1.l15.m1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l15.m1.2.2.2.2.2.2.4" xref="alg1.l15.m1.2.2.2.2.2.3.cmml">,</mo><msub id="alg1.l15.m1.2.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.2.2.cmml"><mi id="alg1.l15.m1.2.2.2.2.2.2.2.2" xref="alg1.l15.m1.2.2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l15.m1.2.2.2.2.2.2.2.3" xref="alg1.l15.m1.2.2.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l15.m1.2.2.2.2.2.2.5" xref="alg1.l15.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.2b"><apply id="alg1.l15.m1.2.2.cmml" xref="alg1.l15.m1.2.2"><ci id="alg1.l15.m1.2.2.3.cmml" xref="alg1.l15.m1.2.2.3">←</ci><apply id="alg1.l15.m1.2.2.4.cmml" xref="alg1.l15.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.4.1.cmml" xref="alg1.l15.m1.2.2.4">subscript</csymbol><ci id="alg1.l15.m1.2.2.4.2.cmml" xref="alg1.l15.m1.2.2.4.2">𝑊</ci><ci id="alg1.l15.m1.2.2.4.3.cmml" xref="alg1.l15.m1.2.2.4.3">𝑖</ci></apply><apply id="alg1.l15.m1.2.2.2.cmml" xref="alg1.l15.m1.2.2.2"><minus id="alg1.l15.m1.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.3"></minus><apply id="alg1.l15.m1.2.2.2.4.cmml" xref="alg1.l15.m1.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.4.1.cmml" xref="alg1.l15.m1.2.2.2.4">subscript</csymbol><ci id="alg1.l15.m1.2.2.2.4.2.cmml" xref="alg1.l15.m1.2.2.2.4.2">𝑊</ci><ci id="alg1.l15.m1.2.2.2.4.3.cmml" xref="alg1.l15.m1.2.2.2.4.3">𝑖</ci></apply><apply id="alg1.l15.m1.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2"><times id="alg1.l15.m1.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.3"></times><apply id="alg1.l15.m1.2.2.2.2.4.cmml" xref="alg1.l15.m1.2.2.2.2.4"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.4.1.cmml" xref="alg1.l15.m1.2.2.2.2.4">subscript</csymbol><ci id="alg1.l15.m1.2.2.2.2.4.2.cmml" xref="alg1.l15.m1.2.2.2.2.4.2">𝜌</ci><ci id="alg1.l15.m1.2.2.2.2.4.3.cmml" xref="alg1.l15.m1.2.2.2.2.4.3">𝑡</ci></apply><apply id="alg1.l15.m1.2.2.2.2.5.cmml" xref="alg1.l15.m1.2.2.2.2.5"><divide id="alg1.l15.m1.2.2.2.2.5.1.cmml" xref="alg1.l15.m1.2.2.2.2.5"></divide><ci id="alg1.l15.m1.2.2.2.2.5.2.cmml" xref="alg1.l15.m1.2.2.2.2.5.2">𝐼</ci><ci id="alg1.l15.m1.2.2.2.2.5.3.cmml" xref="alg1.l15.m1.2.2.2.2.5.3">𝑟</ci></apply><apply id="alg1.l15.m1.2.2.2.2.6.cmml" xref="alg1.l15.m1.2.2.2.2.6"><apply id="alg1.l15.m1.2.2.2.2.6.1.cmml" xref="alg1.l15.m1.2.2.2.2.6.1"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.6.1.1.cmml" xref="alg1.l15.m1.2.2.2.2.6.1">subscript</csymbol><ci id="alg1.l15.m1.2.2.2.2.6.1.2.cmml" xref="alg1.l15.m1.2.2.2.2.6.1.2">∇</ci><apply id="alg1.l15.m1.2.2.2.2.6.1.3.cmml" xref="alg1.l15.m1.2.2.2.2.6.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.6.1.3.1.cmml" xref="alg1.l15.m1.2.2.2.2.6.1.3">subscript</csymbol><ci id="alg1.l15.m1.2.2.2.2.6.1.3.2.cmml" xref="alg1.l15.m1.2.2.2.2.6.1.3.2">𝑊</ci><ci id="alg1.l15.m1.2.2.2.2.6.1.3.3.cmml" xref="alg1.l15.m1.2.2.2.2.6.1.3.3">𝑖</ci></apply></apply><apply id="alg1.l15.m1.2.2.2.2.6.2.cmml" xref="alg1.l15.m1.2.2.2.2.6.2"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.6.2.1.cmml" xref="alg1.l15.m1.2.2.2.2.6.2">subscript</csymbol><ci id="alg1.l15.m1.2.2.2.2.6.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.6.2.2">ℓ</ci><ci id="alg1.l15.m1.2.2.2.2.6.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.6.2.3">𝑖</ci></apply></apply><interval closure="open" id="alg1.l15.m1.2.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.2"><apply id="alg1.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2">𝑊</ci><ci id="alg1.l15.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l15.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l15.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l15.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.2.2">𝜃</ci><ci id="alg1.l15.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l15.m1.2.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.2c">W_{i}\leftarrow W_{i}-\rho_{t}\frac{I}{r}\nabla_{W_{i}}\ell_{i}(W_{i},\theta_{t})</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">     <span id="alg1.l16.1" class="ltx_text ltx_font_sansserif">Return</span> <math id="alg1.l16.m1.2" class="ltx_Math" alttext="\mathbf{g}_{i}:=\nabla_{\theta_{t}}\ell_{i}(W_{i},\theta_{t})" display="inline"><semantics id="alg1.l16.m1.2a"><mrow id="alg1.l16.m1.2.2" xref="alg1.l16.m1.2.2.cmml"><msub id="alg1.l16.m1.2.2.4" xref="alg1.l16.m1.2.2.4.cmml"><mi id="alg1.l16.m1.2.2.4.2" xref="alg1.l16.m1.2.2.4.2.cmml">𝐠</mi><mi id="alg1.l16.m1.2.2.4.3" xref="alg1.l16.m1.2.2.4.3.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="alg1.l16.m1.2.2.3" xref="alg1.l16.m1.2.2.3.cmml">:=</mo><mrow id="alg1.l16.m1.2.2.2" xref="alg1.l16.m1.2.2.2.cmml"><mrow id="alg1.l16.m1.2.2.2.4" xref="alg1.l16.m1.2.2.2.4.cmml"><msub id="alg1.l16.m1.2.2.2.4.1" xref="alg1.l16.m1.2.2.2.4.1.cmml"><mo rspace="0.167em" id="alg1.l16.m1.2.2.2.4.1.2" xref="alg1.l16.m1.2.2.2.4.1.2.cmml">∇</mo><msub id="alg1.l16.m1.2.2.2.4.1.3" xref="alg1.l16.m1.2.2.2.4.1.3.cmml"><mi id="alg1.l16.m1.2.2.2.4.1.3.2" xref="alg1.l16.m1.2.2.2.4.1.3.2.cmml">θ</mi><mi id="alg1.l16.m1.2.2.2.4.1.3.3" xref="alg1.l16.m1.2.2.2.4.1.3.3.cmml">t</mi></msub></msub><msub id="alg1.l16.m1.2.2.2.4.2" xref="alg1.l16.m1.2.2.2.4.2.cmml"><mi mathvariant="normal" id="alg1.l16.m1.2.2.2.4.2.2" xref="alg1.l16.m1.2.2.2.4.2.2.cmml">ℓ</mi><mi id="alg1.l16.m1.2.2.2.4.2.3" xref="alg1.l16.m1.2.2.2.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l16.m1.2.2.2.3" xref="alg1.l16.m1.2.2.2.3.cmml">​</mo><mrow id="alg1.l16.m1.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg1.l16.m1.2.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.2.3.cmml">(</mo><msub id="alg1.l16.m1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l16.m1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.2.cmml">W</mi><mi id="alg1.l16.m1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l16.m1.2.2.2.2.2.4" xref="alg1.l16.m1.2.2.2.2.3.cmml">,</mo><msub id="alg1.l16.m1.2.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.2.cmml"><mi id="alg1.l16.m1.2.2.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l16.m1.2.2.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l16.m1.2.2.2.2.2.5" xref="alg1.l16.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.2b"><apply id="alg1.l16.m1.2.2.cmml" xref="alg1.l16.m1.2.2"><csymbol cd="latexml" id="alg1.l16.m1.2.2.3.cmml" xref="alg1.l16.m1.2.2.3">assign</csymbol><apply id="alg1.l16.m1.2.2.4.cmml" xref="alg1.l16.m1.2.2.4"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.4.1.cmml" xref="alg1.l16.m1.2.2.4">subscript</csymbol><ci id="alg1.l16.m1.2.2.4.2.cmml" xref="alg1.l16.m1.2.2.4.2">𝐠</ci><ci id="alg1.l16.m1.2.2.4.3.cmml" xref="alg1.l16.m1.2.2.4.3">𝑖</ci></apply><apply id="alg1.l16.m1.2.2.2.cmml" xref="alg1.l16.m1.2.2.2"><times id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.3"></times><apply id="alg1.l16.m1.2.2.2.4.cmml" xref="alg1.l16.m1.2.2.2.4"><apply id="alg1.l16.m1.2.2.2.4.1.cmml" xref="alg1.l16.m1.2.2.2.4.1"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.4.1.1.cmml" xref="alg1.l16.m1.2.2.2.4.1">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.4.1.2.cmml" xref="alg1.l16.m1.2.2.2.4.1.2">∇</ci><apply id="alg1.l16.m1.2.2.2.4.1.3.cmml" xref="alg1.l16.m1.2.2.2.4.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.4.1.3.1.cmml" xref="alg1.l16.m1.2.2.2.4.1.3">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.4.1.3.2.cmml" xref="alg1.l16.m1.2.2.2.4.1.3.2">𝜃</ci><ci id="alg1.l16.m1.2.2.2.4.1.3.3.cmml" xref="alg1.l16.m1.2.2.2.4.1.3.3">𝑡</ci></apply></apply><apply id="alg1.l16.m1.2.2.2.4.2.cmml" xref="alg1.l16.m1.2.2.2.4.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.4.2.1.cmml" xref="alg1.l16.m1.2.2.2.4.2">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.4.2.2.cmml" xref="alg1.l16.m1.2.2.2.4.2.2">ℓ</ci><ci id="alg1.l16.m1.2.2.2.4.2.3.cmml" xref="alg1.l16.m1.2.2.2.4.2.3">𝑖</ci></apply></apply><interval closure="open" id="alg1.l16.m1.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2.2"><apply id="alg1.l16.m1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.2">𝑊</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg1.l16.m1.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg1.l16.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="alg1.l16.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.2c">\mathbf{g}_{i}:=\nabla_{\theta_{t}}\ell_{i}(W_{i},\theta_{t})</annotation></semantics></math> to server


</div>
</div>
</figure>
</section>
</section>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Exact Stochastic Gradient Descent Optimization

</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.10" class="ltx_p">An important property of the proposed algorithm is that the final iteration <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\tau</annotation></semantics></math> over <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">W</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑊</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">W_{i}</annotation></semantics></math>’s at the selected set of clients <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{I}_{t}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">ℐ</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">ℐ</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\mathcal{I}_{t}</annotation></semantics></math>, combined with the update over the global parameter <math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mi id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><ci id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\theta</annotation></semantics></math> at the server results in an unbiased SGD step over all parameters <math id="S3.SS3.p1.5.m5.4" class="ltx_Math" alttext="\psi=\{\theta,W_{1},\ldots,W_{I}\}" display="inline"><semantics id="S3.SS3.p1.5.m5.4a"><mrow id="S3.SS3.p1.5.m5.4.4" xref="S3.SS3.p1.5.m5.4.4.cmml"><mi id="S3.SS3.p1.5.m5.4.4.4" xref="S3.SS3.p1.5.m5.4.4.4.cmml">ψ</mi><mo id="S3.SS3.p1.5.m5.4.4.3" xref="S3.SS3.p1.5.m5.4.4.3.cmml">=</mo><mrow id="S3.SS3.p1.5.m5.4.4.2.2" xref="S3.SS3.p1.5.m5.4.4.2.3.cmml"><mo stretchy="false" id="S3.SS3.p1.5.m5.4.4.2.2.3" xref="S3.SS3.p1.5.m5.4.4.2.3.cmml">{</mo><mi id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">θ</mi><mo id="S3.SS3.p1.5.m5.4.4.2.2.4" xref="S3.SS3.p1.5.m5.4.4.2.3.cmml">,</mo><msub id="S3.SS3.p1.5.m5.3.3.1.1.1" xref="S3.SS3.p1.5.m5.3.3.1.1.1.cmml"><mi id="S3.SS3.p1.5.m5.3.3.1.1.1.2" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2.cmml">W</mi><mn id="S3.SS3.p1.5.m5.3.3.1.1.1.3" xref="S3.SS3.p1.5.m5.3.3.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p1.5.m5.4.4.2.2.5" xref="S3.SS3.p1.5.m5.4.4.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.5.m5.2.2" xref="S3.SS3.p1.5.m5.2.2.cmml">…</mi><mo id="S3.SS3.p1.5.m5.4.4.2.2.6" xref="S3.SS3.p1.5.m5.4.4.2.3.cmml">,</mo><msub id="S3.SS3.p1.5.m5.4.4.2.2.2" xref="S3.SS3.p1.5.m5.4.4.2.2.2.cmml"><mi id="S3.SS3.p1.5.m5.4.4.2.2.2.2" xref="S3.SS3.p1.5.m5.4.4.2.2.2.2.cmml">W</mi><mi id="S3.SS3.p1.5.m5.4.4.2.2.2.3" xref="S3.SS3.p1.5.m5.4.4.2.2.2.3.cmml">I</mi></msub><mo stretchy="false" id="S3.SS3.p1.5.m5.4.4.2.2.7" xref="S3.SS3.p1.5.m5.4.4.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.4b"><apply id="S3.SS3.p1.5.m5.4.4.cmml" xref="S3.SS3.p1.5.m5.4.4"><eq id="S3.SS3.p1.5.m5.4.4.3.cmml" xref="S3.SS3.p1.5.m5.4.4.3"></eq><ci id="S3.SS3.p1.5.m5.4.4.4.cmml" xref="S3.SS3.p1.5.m5.4.4.4">𝜓</ci><set id="S3.SS3.p1.5.m5.4.4.2.3.cmml" xref="S3.SS3.p1.5.m5.4.4.2.2"><ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">𝜃</ci><apply id="S3.SS3.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.2">𝑊</ci><cn type="integer" id="S3.SS3.p1.5.m5.3.3.1.1.1.3.cmml" xref="S3.SS3.p1.5.m5.3.3.1.1.1.3">1</cn></apply><ci id="S3.SS3.p1.5.m5.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2">…</ci><apply id="S3.SS3.p1.5.m5.4.4.2.2.2.cmml" xref="S3.SS3.p1.5.m5.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.4.4.2.2.2.1.cmml" xref="S3.SS3.p1.5.m5.4.4.2.2.2">subscript</csymbol><ci id="S3.SS3.p1.5.m5.4.4.2.2.2.2.cmml" xref="S3.SS3.p1.5.m5.4.4.2.2.2.2">𝑊</ci><ci id="S3.SS3.p1.5.m5.4.4.2.2.2.3.cmml" xref="S3.SS3.p1.5.m5.4.4.2.2.2.3">𝐼</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.4c">\psi=\{\theta,W_{1},\ldots,W_{I}\}</annotation></semantics></math>. To prove this rigorously, we introduce the stochastic
gradient vector <math id="S3.SS3.p1.6.m6.4" class="ltx_Math" alttext="\nabla^{s}_{\psi}\mathcal{L}=\{\nabla_{\theta}^{s}\mathcal{L},\nabla_{W_{1}}^{s}\mathcal{L},\ldots,\nabla_{W_{I}}^{s}\mathcal{L}\}" display="inline"><semantics id="S3.SS3.p1.6.m6.4a"><mrow id="S3.SS3.p1.6.m6.4.4" xref="S3.SS3.p1.6.m6.4.4.cmml"><mrow id="S3.SS3.p1.6.m6.4.4.5" xref="S3.SS3.p1.6.m6.4.4.5.cmml"><msubsup id="S3.SS3.p1.6.m6.4.4.5.1" xref="S3.SS3.p1.6.m6.4.4.5.1.cmml"><mo id="S3.SS3.p1.6.m6.4.4.5.1.2.2" xref="S3.SS3.p1.6.m6.4.4.5.1.2.2.cmml">∇</mo><mi id="S3.SS3.p1.6.m6.4.4.5.1.3" xref="S3.SS3.p1.6.m6.4.4.5.1.3.cmml">ψ</mi><mi id="S3.SS3.p1.6.m6.4.4.5.1.2.3" xref="S3.SS3.p1.6.m6.4.4.5.1.2.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m6.4.4.5.2" xref="S3.SS3.p1.6.m6.4.4.5.2.cmml">ℒ</mi></mrow><mo id="S3.SS3.p1.6.m6.4.4.4" xref="S3.SS3.p1.6.m6.4.4.4.cmml">=</mo><mrow id="S3.SS3.p1.6.m6.4.4.3.3" xref="S3.SS3.p1.6.m6.4.4.3.4.cmml"><mo stretchy="false" id="S3.SS3.p1.6.m6.4.4.3.3.4" xref="S3.SS3.p1.6.m6.4.4.3.4.cmml">{</mo><mrow id="S3.SS3.p1.6.m6.2.2.1.1.1" xref="S3.SS3.p1.6.m6.2.2.1.1.1.cmml"><msubsup id="S3.SS3.p1.6.m6.2.2.1.1.1.1" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.2" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.3" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.3.cmml">θ</mi><mi id="S3.SS3.p1.6.m6.2.2.1.1.1.1.3" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m6.2.2.1.1.1.2" xref="S3.SS3.p1.6.m6.2.2.1.1.1.2.cmml">ℒ</mi></mrow><mo id="S3.SS3.p1.6.m6.4.4.3.3.5" xref="S3.SS3.p1.6.m6.4.4.3.4.cmml">,</mo><mrow id="S3.SS3.p1.6.m6.3.3.2.2.2" xref="S3.SS3.p1.6.m6.3.3.2.2.2.cmml"><msubsup id="S3.SS3.p1.6.m6.3.3.2.2.2.1" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.cmml"><mo rspace="0.167em" id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.2" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.2.cmml">∇</mo><msub id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.cmml"><mi id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.2" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.2.cmml">W</mi><mn id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.3" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.3.cmml">1</mn></msub><mi id="S3.SS3.p1.6.m6.3.3.2.2.2.1.3" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m6.3.3.2.2.2.2" xref="S3.SS3.p1.6.m6.3.3.2.2.2.2.cmml">ℒ</mi></mrow><mo id="S3.SS3.p1.6.m6.4.4.3.3.6" xref="S3.SS3.p1.6.m6.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">…</mi><mo id="S3.SS3.p1.6.m6.4.4.3.3.7" xref="S3.SS3.p1.6.m6.4.4.3.4.cmml">,</mo><mrow id="S3.SS3.p1.6.m6.4.4.3.3.3" xref="S3.SS3.p1.6.m6.4.4.3.3.3.cmml"><msubsup id="S3.SS3.p1.6.m6.4.4.3.3.3.1" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.cmml"><mo rspace="0.167em" id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.2" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.2.cmml">∇</mo><msub id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.cmml"><mi id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.2" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.2.cmml">W</mi><mi id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.3" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.3.cmml">I</mi></msub><mi id="S3.SS3.p1.6.m6.4.4.3.3.3.1.3" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m6.4.4.3.3.3.2" xref="S3.SS3.p1.6.m6.4.4.3.3.3.2.cmml">ℒ</mi></mrow><mo stretchy="false" id="S3.SS3.p1.6.m6.4.4.3.3.8" xref="S3.SS3.p1.6.m6.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.4b"><apply id="S3.SS3.p1.6.m6.4.4.cmml" xref="S3.SS3.p1.6.m6.4.4"><eq id="S3.SS3.p1.6.m6.4.4.4.cmml" xref="S3.SS3.p1.6.m6.4.4.4"></eq><apply id="S3.SS3.p1.6.m6.4.4.5.cmml" xref="S3.SS3.p1.6.m6.4.4.5"><apply id="S3.SS3.p1.6.m6.4.4.5.1.cmml" xref="S3.SS3.p1.6.m6.4.4.5.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.4.4.5.1.1.cmml" xref="S3.SS3.p1.6.m6.4.4.5.1">subscript</csymbol><apply id="S3.SS3.p1.6.m6.4.4.5.1.2.cmml" xref="S3.SS3.p1.6.m6.4.4.5.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.4.4.5.1.2.1.cmml" xref="S3.SS3.p1.6.m6.4.4.5.1">superscript</csymbol><ci id="S3.SS3.p1.6.m6.4.4.5.1.2.2.cmml" xref="S3.SS3.p1.6.m6.4.4.5.1.2.2">∇</ci><ci id="S3.SS3.p1.6.m6.4.4.5.1.2.3.cmml" xref="S3.SS3.p1.6.m6.4.4.5.1.2.3">𝑠</ci></apply><ci id="S3.SS3.p1.6.m6.4.4.5.1.3.cmml" xref="S3.SS3.p1.6.m6.4.4.5.1.3">𝜓</ci></apply><ci id="S3.SS3.p1.6.m6.4.4.5.2.cmml" xref="S3.SS3.p1.6.m6.4.4.5.2">ℒ</ci></apply><set id="S3.SS3.p1.6.m6.4.4.3.4.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3"><apply id="S3.SS3.p1.6.m6.2.2.1.1.1.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1"><apply id="S3.SS3.p1.6.m6.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1">superscript</csymbol><apply id="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.2.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.2">∇</ci><ci id="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.3.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.2.3">𝜃</ci></apply><ci id="S3.SS3.p1.6.m6.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.1.3">𝑠</ci></apply><ci id="S3.SS3.p1.6.m6.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.6.m6.2.2.1.1.1.2">ℒ</ci></apply><apply id="S3.SS3.p1.6.m6.3.3.2.2.2.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2"><apply id="S3.SS3.p1.6.m6.3.3.2.2.2.1.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.3.3.2.2.2.1.1.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1">superscript</csymbol><apply id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.1.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.2.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.2">∇</ci><apply id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.1.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3">subscript</csymbol><ci id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.2.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.2">𝑊</ci><cn type="integer" id="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.3.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p1.6.m6.3.3.2.2.2.1.3.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.1.3">𝑠</ci></apply><ci id="S3.SS3.p1.6.m6.3.3.2.2.2.2.cmml" xref="S3.SS3.p1.6.m6.3.3.2.2.2.2">ℒ</ci></apply><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">…</ci><apply id="S3.SS3.p1.6.m6.4.4.3.3.3.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3"><apply id="S3.SS3.p1.6.m6.4.4.3.3.3.1.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.4.4.3.3.3.1.1.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1">superscript</csymbol><apply id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.1.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1">subscript</csymbol><ci id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.2.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.2">∇</ci><apply id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.1.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3">subscript</csymbol><ci id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.2.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.2">𝑊</ci><ci id="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.3.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.2.3.3">𝐼</ci></apply></apply><ci id="S3.SS3.p1.6.m6.4.4.3.3.3.1.3.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.1.3">𝑠</ci></apply><ci id="S3.SS3.p1.6.m6.4.4.3.3.3.2.cmml" xref="S3.SS3.p1.6.m6.4.4.3.3.3.2">ℒ</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.4c">\nabla^{s}_{\psi}\mathcal{L}=\{\nabla_{\theta}^{s}\mathcal{L},\nabla_{W_{1}}^{s}\mathcal{L},\ldots,\nabla_{W_{I}}^{s}\mathcal{L}\}</annotation></semantics></math> where we used the symbol <math id="S3.SS3.p1.7.m7.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S3.SS3.p1.7.m7.1a"><mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b"><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">s</annotation></semantics></math> in <math id="S3.SS3.p1.8.m8.1" class="ltx_Math" alttext="\nabla^{s}" display="inline"><semantics id="S3.SS3.p1.8.m8.1a"><msup id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml"><mo id="S3.SS3.p1.8.m8.1.1.2" xref="S3.SS3.p1.8.m8.1.1.2.cmml">∇</mo><mi id="S3.SS3.p1.8.m8.1.1.3" xref="S3.SS3.p1.8.m8.1.1.3.cmml">s</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b"><apply id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.1.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">superscript</csymbol><ci id="S3.SS3.p1.8.m8.1.1.2.cmml" xref="S3.SS3.p1.8.m8.1.1.2">∇</ci><ci id="S3.SS3.p1.8.m8.1.1.3.cmml" xref="S3.SS3.p1.8.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">\nabla^{s}</annotation></semantics></math> to indicate that these gradient vectors are stochastic. For any client <math id="S3.SS3.p1.9.m9.3" class="ltx_Math" alttext="i=1,\ldots,I" display="inline"><semantics id="S3.SS3.p1.9.m9.3a"><mrow id="S3.SS3.p1.9.m9.3.4" xref="S3.SS3.p1.9.m9.3.4.cmml"><mi id="S3.SS3.p1.9.m9.3.4.2" xref="S3.SS3.p1.9.m9.3.4.2.cmml">i</mi><mo id="S3.SS3.p1.9.m9.3.4.1" xref="S3.SS3.p1.9.m9.3.4.1.cmml">=</mo><mrow id="S3.SS3.p1.9.m9.3.4.3.2" xref="S3.SS3.p1.9.m9.3.4.3.1.cmml"><mn id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml">1</mn><mo id="S3.SS3.p1.9.m9.3.4.3.2.1" xref="S3.SS3.p1.9.m9.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p1.9.m9.2.2" xref="S3.SS3.p1.9.m9.2.2.cmml">…</mi><mo id="S3.SS3.p1.9.m9.3.4.3.2.2" xref="S3.SS3.p1.9.m9.3.4.3.1.cmml">,</mo><mi id="S3.SS3.p1.9.m9.3.3" xref="S3.SS3.p1.9.m9.3.3.cmml">I</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.3b"><apply id="S3.SS3.p1.9.m9.3.4.cmml" xref="S3.SS3.p1.9.m9.3.4"><eq id="S3.SS3.p1.9.m9.3.4.1.cmml" xref="S3.SS3.p1.9.m9.3.4.1"></eq><ci id="S3.SS3.p1.9.m9.3.4.2.cmml" xref="S3.SS3.p1.9.m9.3.4.2">𝑖</ci><list id="S3.SS3.p1.9.m9.3.4.3.1.cmml" xref="S3.SS3.p1.9.m9.3.4.3.2"><cn type="integer" id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">1</cn><ci id="S3.SS3.p1.9.m9.2.2.cmml" xref="S3.SS3.p1.9.m9.2.2">…</ci><ci id="S3.SS3.p1.9.m9.3.3.cmml" xref="S3.SS3.p1.9.m9.3.3">𝐼</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.3c">i=1,\ldots,I</annotation></semantics></math> the vector <math id="S3.SS3.p1.10.m10.1" class="ltx_Math" alttext="\nabla_{W_{i}}^{s}\mathcal{L}" display="inline"><semantics id="S3.SS3.p1.10.m10.1a"><mrow id="S3.SS3.p1.10.m10.1.1" xref="S3.SS3.p1.10.m10.1.1.cmml"><msubsup id="S3.SS3.p1.10.m10.1.1.1" xref="S3.SS3.p1.10.m10.1.1.1.cmml"><mo id="S3.SS3.p1.10.m10.1.1.1.2.2" xref="S3.SS3.p1.10.m10.1.1.1.2.2.cmml">∇</mo><msub id="S3.SS3.p1.10.m10.1.1.1.2.3" xref="S3.SS3.p1.10.m10.1.1.1.2.3.cmml"><mi id="S3.SS3.p1.10.m10.1.1.1.2.3.2" xref="S3.SS3.p1.10.m10.1.1.1.2.3.2.cmml">W</mi><mi id="S3.SS3.p1.10.m10.1.1.1.2.3.3" xref="S3.SS3.p1.10.m10.1.1.1.2.3.3.cmml">i</mi></msub><mi id="S3.SS3.p1.10.m10.1.1.1.3" xref="S3.SS3.p1.10.m10.1.1.1.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.10.m10.1.1.2" xref="S3.SS3.p1.10.m10.1.1.2.cmml">ℒ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.1b"><apply id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1"><apply id="S3.SS3.p1.10.m10.1.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1.1">superscript</csymbol><apply id="S3.SS3.p1.10.m10.1.1.1.2.cmml" xref="S3.SS3.p1.10.m10.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.1.2.1.cmml" xref="S3.SS3.p1.10.m10.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.10.m10.1.1.1.2.2.cmml" xref="S3.SS3.p1.10.m10.1.1.1.2.2">∇</ci><apply id="S3.SS3.p1.10.m10.1.1.1.2.3.cmml" xref="S3.SS3.p1.10.m10.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.1.1.1.2.3.1.cmml" xref="S3.SS3.p1.10.m10.1.1.1.2.3">subscript</csymbol><ci id="S3.SS3.p1.10.m10.1.1.1.2.3.2.cmml" xref="S3.SS3.p1.10.m10.1.1.1.2.3.2">𝑊</ci><ci id="S3.SS3.p1.10.m10.1.1.1.2.3.3.cmml" xref="S3.SS3.p1.10.m10.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.p1.10.m10.1.1.1.3.cmml" xref="S3.SS3.p1.10.m10.1.1.1.3">𝑠</ci></apply><ci id="S3.SS3.p1.10.m10.1.1.2.cmml" xref="S3.SS3.p1.10.m10.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.1c">\nabla_{W_{i}}^{s}\mathcal{L}</annotation></semantics></math> is defined as</p>
<table id="A3.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex3.m1.1" class="ltx_Math" alttext="\displaystyle\nabla_{W_{i}}^{s}\!\mathcal{L}" display="inline"><semantics id="S3.Ex3.m1.1a"><mrow id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><msubsup id="S3.Ex3.m1.1.1.1" xref="S3.Ex3.m1.1.1.1.cmml"><mo id="S3.Ex3.m1.1.1.1.2.2" xref="S3.Ex3.m1.1.1.1.2.2.cmml">∇</mo><msub id="S3.Ex3.m1.1.1.1.2.3" xref="S3.Ex3.m1.1.1.1.2.3.cmml"><mi id="S3.Ex3.m1.1.1.1.2.3.2" xref="S3.Ex3.m1.1.1.1.2.3.2.cmml">W</mi><mi id="S3.Ex3.m1.1.1.1.2.3.3" xref="S3.Ex3.m1.1.1.1.2.3.3.cmml">i</mi></msub><mi id="S3.Ex3.m1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.1.1.2" xref="S3.Ex3.m1.1.1.2.cmml">ℒ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.1b"><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><apply id="S3.Ex3.m1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1">superscript</csymbol><apply id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1.1">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.1.1.1.2.2">∇</ci><apply id="S3.Ex3.m1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex3.m1.1.1.1.2.3.1.cmml" xref="S3.Ex3.m1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex3.m1.1.1.1.2.3.2.cmml" xref="S3.Ex3.m1.1.1.1.2.3.2">𝑊</ci><ci id="S3.Ex3.m1.1.1.1.2.3.3.cmml" xref="S3.Ex3.m1.1.1.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.Ex3.m1.1.1.1.3.cmml" xref="S3.Ex3.m1.1.1.1.3">𝑠</ci></apply><ci id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.1c">\displaystyle\nabla_{W_{i}}^{s}\!\mathcal{L}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex3.m2.2" class="ltx_Math" alttext="\displaystyle={\bf 1}(i\in\mathcal{I}_{t})\frac{I}{r}\nabla_{W_{i}}\mathcal{L}(\psi)" display="inline"><semantics id="S3.Ex3.m2.2a"><mrow id="S3.Ex3.m2.2.2" xref="S3.Ex3.m2.2.2.cmml"><mi id="S3.Ex3.m2.2.2.3" xref="S3.Ex3.m2.2.2.3.cmml"></mi><mo id="S3.Ex3.m2.2.2.2" xref="S3.Ex3.m2.2.2.2.cmml">=</mo><mrow id="S3.Ex3.m2.2.2.1" xref="S3.Ex3.m2.2.2.1.cmml"><mn id="S3.Ex3.m2.2.2.1.3" xref="S3.Ex3.m2.2.2.1.3.cmml">𝟏</mn><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.2.2.1.2" xref="S3.Ex3.m2.2.2.1.2.cmml">​</mo><mrow id="S3.Ex3.m2.2.2.1.1.1" xref="S3.Ex3.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex3.m2.2.2.1.1.1.2" xref="S3.Ex3.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m2.2.2.1.1.1.1" xref="S3.Ex3.m2.2.2.1.1.1.1.cmml"><mi id="S3.Ex3.m2.2.2.1.1.1.1.2" xref="S3.Ex3.m2.2.2.1.1.1.1.2.cmml">i</mi><mo id="S3.Ex3.m2.2.2.1.1.1.1.1" xref="S3.Ex3.m2.2.2.1.1.1.1.1.cmml">∈</mo><msub id="S3.Ex3.m2.2.2.1.1.1.1.3" xref="S3.Ex3.m2.2.2.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m2.2.2.1.1.1.1.3.2" xref="S3.Ex3.m2.2.2.1.1.1.1.3.2.cmml">ℐ</mi><mi id="S3.Ex3.m2.2.2.1.1.1.1.3.3" xref="S3.Ex3.m2.2.2.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.Ex3.m2.2.2.1.1.1.3" xref="S3.Ex3.m2.2.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.2.2.1.2a" xref="S3.Ex3.m2.2.2.1.2.cmml">​</mo><mstyle displaystyle="true" id="S3.Ex3.m2.2.2.1.4" xref="S3.Ex3.m2.2.2.1.4.cmml"><mfrac id="S3.Ex3.m2.2.2.1.4a" xref="S3.Ex3.m2.2.2.1.4.cmml"><mi id="S3.Ex3.m2.2.2.1.4.2" xref="S3.Ex3.m2.2.2.1.4.2.cmml">I</mi><mi id="S3.Ex3.m2.2.2.1.4.3" xref="S3.Ex3.m2.2.2.1.4.3.cmml">r</mi></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="S3.Ex3.m2.2.2.1.2b" xref="S3.Ex3.m2.2.2.1.2.cmml">​</mo><mrow id="S3.Ex3.m2.2.2.1.5" xref="S3.Ex3.m2.2.2.1.5.cmml"><msub id="S3.Ex3.m2.2.2.1.5.1" xref="S3.Ex3.m2.2.2.1.5.1.cmml"><mo rspace="0.167em" id="S3.Ex3.m2.2.2.1.5.1.2" xref="S3.Ex3.m2.2.2.1.5.1.2.cmml">∇</mo><msub id="S3.Ex3.m2.2.2.1.5.1.3" xref="S3.Ex3.m2.2.2.1.5.1.3.cmml"><mi id="S3.Ex3.m2.2.2.1.5.1.3.2" xref="S3.Ex3.m2.2.2.1.5.1.3.2.cmml">W</mi><mi id="S3.Ex3.m2.2.2.1.5.1.3.3" xref="S3.Ex3.m2.2.2.1.5.1.3.3.cmml">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m2.2.2.1.5.2" xref="S3.Ex3.m2.2.2.1.5.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.Ex3.m2.2.2.1.2c" xref="S3.Ex3.m2.2.2.1.2.cmml">​</mo><mrow id="S3.Ex3.m2.2.2.1.6.2" xref="S3.Ex3.m2.2.2.1.cmml"><mo stretchy="false" id="S3.Ex3.m2.2.2.1.6.2.1" xref="S3.Ex3.m2.2.2.1.cmml">(</mo><mi id="S3.Ex3.m2.1.1" xref="S3.Ex3.m2.1.1.cmml">ψ</mi><mo stretchy="false" id="S3.Ex3.m2.2.2.1.6.2.2" xref="S3.Ex3.m2.2.2.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m2.2b"><apply id="S3.Ex3.m2.2.2.cmml" xref="S3.Ex3.m2.2.2"><eq id="S3.Ex3.m2.2.2.2.cmml" xref="S3.Ex3.m2.2.2.2"></eq><csymbol cd="latexml" id="S3.Ex3.m2.2.2.3.cmml" xref="S3.Ex3.m2.2.2.3">absent</csymbol><apply id="S3.Ex3.m2.2.2.1.cmml" xref="S3.Ex3.m2.2.2.1"><times id="S3.Ex3.m2.2.2.1.2.cmml" xref="S3.Ex3.m2.2.2.1.2"></times><cn type="integer" id="S3.Ex3.m2.2.2.1.3.cmml" xref="S3.Ex3.m2.2.2.1.3">1</cn><apply id="S3.Ex3.m2.2.2.1.1.1.1.cmml" xref="S3.Ex3.m2.2.2.1.1.1"><in id="S3.Ex3.m2.2.2.1.1.1.1.1.cmml" xref="S3.Ex3.m2.2.2.1.1.1.1.1"></in><ci id="S3.Ex3.m2.2.2.1.1.1.1.2.cmml" xref="S3.Ex3.m2.2.2.1.1.1.1.2">𝑖</ci><apply id="S3.Ex3.m2.2.2.1.1.1.1.3.cmml" xref="S3.Ex3.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m2.2.2.1.1.1.1.3.1.cmml" xref="S3.Ex3.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex3.m2.2.2.1.1.1.1.3.2.cmml" xref="S3.Ex3.m2.2.2.1.1.1.1.3.2">ℐ</ci><ci id="S3.Ex3.m2.2.2.1.1.1.1.3.3.cmml" xref="S3.Ex3.m2.2.2.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.Ex3.m2.2.2.1.4.cmml" xref="S3.Ex3.m2.2.2.1.4"><divide id="S3.Ex3.m2.2.2.1.4.1.cmml" xref="S3.Ex3.m2.2.2.1.4"></divide><ci id="S3.Ex3.m2.2.2.1.4.2.cmml" xref="S3.Ex3.m2.2.2.1.4.2">𝐼</ci><ci id="S3.Ex3.m2.2.2.1.4.3.cmml" xref="S3.Ex3.m2.2.2.1.4.3">𝑟</ci></apply><apply id="S3.Ex3.m2.2.2.1.5.cmml" xref="S3.Ex3.m2.2.2.1.5"><apply id="S3.Ex3.m2.2.2.1.5.1.cmml" xref="S3.Ex3.m2.2.2.1.5.1"><csymbol cd="ambiguous" id="S3.Ex3.m2.2.2.1.5.1.1.cmml" xref="S3.Ex3.m2.2.2.1.5.1">subscript</csymbol><ci id="S3.Ex3.m2.2.2.1.5.1.2.cmml" xref="S3.Ex3.m2.2.2.1.5.1.2">∇</ci><apply id="S3.Ex3.m2.2.2.1.5.1.3.cmml" xref="S3.Ex3.m2.2.2.1.5.1.3"><csymbol cd="ambiguous" id="S3.Ex3.m2.2.2.1.5.1.3.1.cmml" xref="S3.Ex3.m2.2.2.1.5.1.3">subscript</csymbol><ci id="S3.Ex3.m2.2.2.1.5.1.3.2.cmml" xref="S3.Ex3.m2.2.2.1.5.1.3.2">𝑊</ci><ci id="S3.Ex3.m2.2.2.1.5.1.3.3.cmml" xref="S3.Ex3.m2.2.2.1.5.1.3.3">𝑖</ci></apply></apply><ci id="S3.Ex3.m2.2.2.1.5.2.cmml" xref="S3.Ex3.m2.2.2.1.5.2">ℒ</ci></apply><ci id="S3.Ex3.m2.1.1.cmml" xref="S3.Ex3.m2.1.1">𝜓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m2.2c">\displaystyle={\bf 1}(i\in\mathcal{I}_{t})\frac{I}{r}\nabla_{W_{i}}\mathcal{L}(\psi)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E6.m1.2" class="ltx_Math" alttext="\displaystyle={\bf 1}(i\in\mathcal{I}_{t})\frac{I}{r}\alpha_{i}\nabla_{W_{i}}\ell_{i}(W_{i},\theta)." display="inline"><semantics id="S3.E6.m1.2a"><mrow id="S3.E6.m1.2.2.1" xref="S3.E6.m1.2.2.1.1.cmml"><mrow id="S3.E6.m1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.4" xref="S3.E6.m1.2.2.1.1.4.cmml"></mi><mo id="S3.E6.m1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.1.2.cmml"><mn id="S3.E6.m1.2.2.1.1.2.4" xref="S3.E6.m1.2.2.1.1.2.4.cmml">𝟏</mn><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.3" xref="S3.E6.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.2.2.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.E6.m1.2.2.1.1.1.1.1.1.1" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml">∈</mo><msub id="S3.E6.m1.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.1.1.1.1.1.1.3.2" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.2.cmml">ℐ</mi><mi id="S3.E6.m1.2.2.1.1.1.1.1.1.3.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E6.m1.2.2.1.1.1.1.1.3" xref="S3.E6.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.3a" xref="S3.E6.m1.2.2.1.1.2.3.cmml">​</mo><mstyle displaystyle="true" id="S3.E6.m1.2.2.1.1.2.5" xref="S3.E6.m1.2.2.1.1.2.5.cmml"><mfrac id="S3.E6.m1.2.2.1.1.2.5a" xref="S3.E6.m1.2.2.1.1.2.5.cmml"><mi id="S3.E6.m1.2.2.1.1.2.5.2" xref="S3.E6.m1.2.2.1.1.2.5.2.cmml">I</mi><mi id="S3.E6.m1.2.2.1.1.2.5.3" xref="S3.E6.m1.2.2.1.1.2.5.3.cmml">r</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.3b" xref="S3.E6.m1.2.2.1.1.2.3.cmml">​</mo><msub id="S3.E6.m1.2.2.1.1.2.6" xref="S3.E6.m1.2.2.1.1.2.6.cmml"><mi id="S3.E6.m1.2.2.1.1.2.6.2" xref="S3.E6.m1.2.2.1.1.2.6.2.cmml">α</mi><mi id="S3.E6.m1.2.2.1.1.2.6.3" xref="S3.E6.m1.2.2.1.1.2.6.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.3c" xref="S3.E6.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.2.7" xref="S3.E6.m1.2.2.1.1.2.7.cmml"><msub id="S3.E6.m1.2.2.1.1.2.7.1" xref="S3.E6.m1.2.2.1.1.2.7.1.cmml"><mo rspace="0.167em" id="S3.E6.m1.2.2.1.1.2.7.1.2" xref="S3.E6.m1.2.2.1.1.2.7.1.2.cmml">∇</mo><msub id="S3.E6.m1.2.2.1.1.2.7.1.3" xref="S3.E6.m1.2.2.1.1.2.7.1.3.cmml"><mi id="S3.E6.m1.2.2.1.1.2.7.1.3.2" xref="S3.E6.m1.2.2.1.1.2.7.1.3.2.cmml">W</mi><mi id="S3.E6.m1.2.2.1.1.2.7.1.3.3" xref="S3.E6.m1.2.2.1.1.2.7.1.3.3.cmml">i</mi></msub></msub><msub id="S3.E6.m1.2.2.1.1.2.7.2" xref="S3.E6.m1.2.2.1.1.2.7.2.cmml"><mi mathvariant="normal" id="S3.E6.m1.2.2.1.1.2.7.2.2" xref="S3.E6.m1.2.2.1.1.2.7.2.2.cmml">ℓ</mi><mi id="S3.E6.m1.2.2.1.1.2.7.2.3" xref="S3.E6.m1.2.2.1.1.2.7.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.2.2.1.1.2.3d" xref="S3.E6.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E6.m1.2.2.1.1.2.2.1" xref="S3.E6.m1.2.2.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.1.1.2.2.1.2" xref="S3.E6.m1.2.2.1.1.2.2.2.cmml">(</mo><msub id="S3.E6.m1.2.2.1.1.2.2.1.1" xref="S3.E6.m1.2.2.1.1.2.2.1.1.cmml"><mi id="S3.E6.m1.2.2.1.1.2.2.1.1.2" xref="S3.E6.m1.2.2.1.1.2.2.1.1.2.cmml">W</mi><mi id="S3.E6.m1.2.2.1.1.2.2.1.1.3" xref="S3.E6.m1.2.2.1.1.2.2.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.2.2.1.1.2.2.1.3" xref="S3.E6.m1.2.2.1.1.2.2.2.cmml">,</mo><mi id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E6.m1.2.2.1.1.2.2.1.4" xref="S3.E6.m1.2.2.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.2.2.1.2" xref="S3.E6.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.2b"><apply id="S3.E6.m1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1"><eq id="S3.E6.m1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.3"></eq><csymbol cd="latexml" id="S3.E6.m1.2.2.1.1.4.cmml" xref="S3.E6.m1.2.2.1.1.4">absent</csymbol><apply id="S3.E6.m1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2"><times id="S3.E6.m1.2.2.1.1.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.3"></times><cn type="integer" id="S3.E6.m1.2.2.1.1.2.4.cmml" xref="S3.E6.m1.2.2.1.1.2.4">1</cn><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1"><in id="S3.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.1"></in><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.E6.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.2">ℐ</ci><ci id="S3.E6.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.5.cmml" xref="S3.E6.m1.2.2.1.1.2.5"><divide id="S3.E6.m1.2.2.1.1.2.5.1.cmml" xref="S3.E6.m1.2.2.1.1.2.5"></divide><ci id="S3.E6.m1.2.2.1.1.2.5.2.cmml" xref="S3.E6.m1.2.2.1.1.2.5.2">𝐼</ci><ci id="S3.E6.m1.2.2.1.1.2.5.3.cmml" xref="S3.E6.m1.2.2.1.1.2.5.3">𝑟</ci></apply><apply id="S3.E6.m1.2.2.1.1.2.6.cmml" xref="S3.E6.m1.2.2.1.1.2.6"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.6.1.cmml" xref="S3.E6.m1.2.2.1.1.2.6">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.6.2.cmml" xref="S3.E6.m1.2.2.1.1.2.6.2">𝛼</ci><ci id="S3.E6.m1.2.2.1.1.2.6.3.cmml" xref="S3.E6.m1.2.2.1.1.2.6.3">𝑖</ci></apply><apply id="S3.E6.m1.2.2.1.1.2.7.cmml" xref="S3.E6.m1.2.2.1.1.2.7"><apply id="S3.E6.m1.2.2.1.1.2.7.1.cmml" xref="S3.E6.m1.2.2.1.1.2.7.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.7.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.7.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.7.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.7.1.2">∇</ci><apply id="S3.E6.m1.2.2.1.1.2.7.1.3.cmml" xref="S3.E6.m1.2.2.1.1.2.7.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.7.1.3.1.cmml" xref="S3.E6.m1.2.2.1.1.2.7.1.3">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.7.1.3.2.cmml" xref="S3.E6.m1.2.2.1.1.2.7.1.3.2">𝑊</ci><ci id="S3.E6.m1.2.2.1.1.2.7.1.3.3.cmml" xref="S3.E6.m1.2.2.1.1.2.7.1.3.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.2.2.1.1.2.7.2.cmml" xref="S3.E6.m1.2.2.1.1.2.7.2"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.7.2.1.cmml" xref="S3.E6.m1.2.2.1.1.2.7.2">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.7.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.7.2.2">ℓ</ci><ci id="S3.E6.m1.2.2.1.1.2.7.2.3.cmml" xref="S3.E6.m1.2.2.1.1.2.7.2.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E6.m1.2.2.1.1.2.2.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2.1"><apply id="S3.E6.m1.2.2.1.1.2.2.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.1.1.2.2.1.1.1.cmml" xref="S3.E6.m1.2.2.1.1.2.2.1.1">subscript</csymbol><ci id="S3.E6.m1.2.2.1.1.2.2.1.1.2.cmml" xref="S3.E6.m1.2.2.1.1.2.2.1.1.2">𝑊</ci><ci id="S3.E6.m1.2.2.1.1.2.2.1.1.3.cmml" xref="S3.E6.m1.2.2.1.1.2.2.1.1.3">𝑖</ci></apply><ci id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1">𝜃</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.2c">\displaystyle={\bf 1}(i\in\mathcal{I}_{t})\frac{I}{r}\alpha_{i}\nabla_{W_{i}}\ell_{i}(W_{i},\theta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.20" class="ltx_p">Here, <math id="S3.SS3.p1.11.m1.1" class="ltx_Math" alttext="{\bf 1}(i\in\mathcal{I}_{t})" display="inline"><semantics id="S3.SS3.p1.11.m1.1a"><mrow id="S3.SS3.p1.11.m1.1.1" xref="S3.SS3.p1.11.m1.1.1.cmml"><mn id="S3.SS3.p1.11.m1.1.1.3" xref="S3.SS3.p1.11.m1.1.1.3.cmml">𝟏</mn><mo lspace="0em" rspace="0em" id="S3.SS3.p1.11.m1.1.1.2" xref="S3.SS3.p1.11.m1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.11.m1.1.1.1.1" xref="S3.SS3.p1.11.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p1.11.m1.1.1.1.1.2" xref="S3.SS3.p1.11.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.p1.11.m1.1.1.1.1.1" xref="S3.SS3.p1.11.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.11.m1.1.1.1.1.1.2" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.SS3.p1.11.m1.1.1.1.1.1.1" xref="S3.SS3.p1.11.m1.1.1.1.1.1.1.cmml">∈</mo><msub id="S3.SS3.p1.11.m1.1.1.1.1.1.3" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.11.m1.1.1.1.1.1.3.2" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3.2.cmml">ℐ</mi><mi id="S3.SS3.p1.11.m1.1.1.1.1.1.3.3" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS3.p1.11.m1.1.1.1.1.3" xref="S3.SS3.p1.11.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.11.m1.1b"><apply id="S3.SS3.p1.11.m1.1.1.cmml" xref="S3.SS3.p1.11.m1.1.1"><times id="S3.SS3.p1.11.m1.1.1.2.cmml" xref="S3.SS3.p1.11.m1.1.1.2"></times><cn type="integer" id="S3.SS3.p1.11.m1.1.1.3.cmml" xref="S3.SS3.p1.11.m1.1.1.3">1</cn><apply id="S3.SS3.p1.11.m1.1.1.1.1.1.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1"><in id="S3.SS3.p1.11.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.1"></in><ci id="S3.SS3.p1.11.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.2">𝑖</ci><apply id="S3.SS3.p1.11.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.11.m1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.11.m1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3.2">ℐ</ci><ci id="S3.SS3.p1.11.m1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.11.m1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.11.m1.1c">{\bf 1}(i\in\mathcal{I}_{t})</annotation></semantics></math> is an indicator function that equals one if <math id="S3.SS3.p1.12.m2.1" class="ltx_Math" alttext="i\in\mathcal{I}_{t}" display="inline"><semantics id="S3.SS3.p1.12.m2.1a"><mrow id="S3.SS3.p1.12.m2.1.1" xref="S3.SS3.p1.12.m2.1.1.cmml"><mi id="S3.SS3.p1.12.m2.1.1.2" xref="S3.SS3.p1.12.m2.1.1.2.cmml">i</mi><mo id="S3.SS3.p1.12.m2.1.1.1" xref="S3.SS3.p1.12.m2.1.1.1.cmml">∈</mo><msub id="S3.SS3.p1.12.m2.1.1.3" xref="S3.SS3.p1.12.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.12.m2.1.1.3.2" xref="S3.SS3.p1.12.m2.1.1.3.2.cmml">ℐ</mi><mi id="S3.SS3.p1.12.m2.1.1.3.3" xref="S3.SS3.p1.12.m2.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.12.m2.1b"><apply id="S3.SS3.p1.12.m2.1.1.cmml" xref="S3.SS3.p1.12.m2.1.1"><in id="S3.SS3.p1.12.m2.1.1.1.cmml" xref="S3.SS3.p1.12.m2.1.1.1"></in><ci id="S3.SS3.p1.12.m2.1.1.2.cmml" xref="S3.SS3.p1.12.m2.1.1.2">𝑖</ci><apply id="S3.SS3.p1.12.m2.1.1.3.cmml" xref="S3.SS3.p1.12.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.12.m2.1.1.3.1.cmml" xref="S3.SS3.p1.12.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.12.m2.1.1.3.2.cmml" xref="S3.SS3.p1.12.m2.1.1.3.2">ℐ</ci><ci id="S3.SS3.p1.12.m2.1.1.3.3.cmml" xref="S3.SS3.p1.12.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.12.m2.1c">i\in\mathcal{I}_{t}</annotation></semantics></math>, i.e. if client <math id="S3.SS3.p1.13.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p1.13.m3.1a"><mi id="S3.SS3.p1.13.m3.1.1" xref="S3.SS3.p1.13.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.13.m3.1b"><ci id="S3.SS3.p1.13.m3.1.1.cmml" xref="S3.SS3.p1.13.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.13.m3.1c">i</annotation></semantics></math> was selected in round <math id="S3.SS3.p1.14.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p1.14.m4.1a"><mi id="S3.SS3.p1.14.m4.1.1" xref="S3.SS3.p1.14.m4.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.14.m4.1b"><ci id="S3.SS3.p1.14.m4.1.1.cmml" xref="S3.SS3.p1.14.m4.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.14.m4.1c">t</annotation></semantics></math>, and zero otherwise. We also used the fact that <math id="S3.SS3.p1.15.m5.3" class="ltx_Math" alttext="\nabla_{W_{i}}\mathcal{L}(\psi)=\alpha_{i}\nabla_{W_{i}}\ell_{i}(W_{i},\theta)." display="inline"><semantics id="S3.SS3.p1.15.m5.3a"><mrow id="S3.SS3.p1.15.m5.3.3.1" xref="S3.SS3.p1.15.m5.3.3.1.1.cmml"><mrow id="S3.SS3.p1.15.m5.3.3.1.1" xref="S3.SS3.p1.15.m5.3.3.1.1.cmml"><mrow id="S3.SS3.p1.15.m5.3.3.1.1.3" xref="S3.SS3.p1.15.m5.3.3.1.1.3.cmml"><mrow id="S3.SS3.p1.15.m5.3.3.1.1.3.2" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.cmml"><msub id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.cmml"><mo id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.2" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.2.cmml">∇</mo><msub id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.cmml"><mi id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.2" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.2.cmml">W</mi><mi id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.3" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.3.cmml">i</mi></msub></msub><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.15.m5.3.3.1.1.3.2.2" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p1.15.m5.3.3.1.1.3.1" xref="S3.SS3.p1.15.m5.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.SS3.p1.15.m5.3.3.1.1.3.3.2" xref="S3.SS3.p1.15.m5.3.3.1.1.3.cmml"><mo stretchy="false" id="S3.SS3.p1.15.m5.3.3.1.1.3.3.2.1" xref="S3.SS3.p1.15.m5.3.3.1.1.3.cmml">(</mo><mi id="S3.SS3.p1.15.m5.1.1" xref="S3.SS3.p1.15.m5.1.1.cmml">ψ</mi><mo stretchy="false" id="S3.SS3.p1.15.m5.3.3.1.1.3.3.2.2" xref="S3.SS3.p1.15.m5.3.3.1.1.3.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.15.m5.3.3.1.1.2" xref="S3.SS3.p1.15.m5.3.3.1.1.2.cmml">=</mo><mrow id="S3.SS3.p1.15.m5.3.3.1.1.1" xref="S3.SS3.p1.15.m5.3.3.1.1.1.cmml"><msub id="S3.SS3.p1.15.m5.3.3.1.1.1.3" xref="S3.SS3.p1.15.m5.3.3.1.1.1.3.cmml"><mi id="S3.SS3.p1.15.m5.3.3.1.1.1.3.2" xref="S3.SS3.p1.15.m5.3.3.1.1.1.3.2.cmml">α</mi><mi id="S3.SS3.p1.15.m5.3.3.1.1.1.3.3" xref="S3.SS3.p1.15.m5.3.3.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.SS3.p1.15.m5.3.3.1.1.1.2" xref="S3.SS3.p1.15.m5.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.15.m5.3.3.1.1.1.4" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.cmml"><msub id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.cmml"><mo rspace="0.167em" id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.2" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.2.cmml">∇</mo><msub id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.cmml"><mi id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.2" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.2.cmml">W</mi><mi id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.3" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.3.cmml">i</mi></msub></msub><msub id="S3.SS3.p1.15.m5.3.3.1.1.1.4.2" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.cmml"><mi mathvariant="normal" id="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.2" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.2.cmml">ℓ</mi><mi id="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.3" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p1.15.m5.3.3.1.1.1.2a" xref="S3.SS3.p1.15.m5.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.2" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.2.cmml">(</mo><msub id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.2" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.3" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.3" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.2.cmml">,</mo><mi id="S3.SS3.p1.15.m5.2.2" xref="S3.SS3.p1.15.m5.2.2.cmml">θ</mi><mo stretchy="false" id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.4" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.SS3.p1.15.m5.3.3.1.2" xref="S3.SS3.p1.15.m5.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.15.m5.3b"><apply id="S3.SS3.p1.15.m5.3.3.1.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1"><eq id="S3.SS3.p1.15.m5.3.3.1.1.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.2"></eq><apply id="S3.SS3.p1.15.m5.3.3.1.1.3.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3"><times id="S3.SS3.p1.15.m5.3.3.1.1.3.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3.1"></times><apply id="S3.SS3.p1.15.m5.3.3.1.1.3.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2"><apply id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1">subscript</csymbol><ci id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.2">∇</ci><apply id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3">subscript</csymbol><ci id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.2">𝑊</ci><ci id="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.3.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.1.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.p1.15.m5.3.3.1.1.3.2.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.3.2.2">ℒ</ci></apply><ci id="S3.SS3.p1.15.m5.1.1.cmml" xref="S3.SS3.p1.15.m5.1.1">𝜓</ci></apply><apply id="S3.SS3.p1.15.m5.3.3.1.1.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1"><times id="S3.SS3.p1.15.m5.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.2"></times><apply id="S3.SS3.p1.15.m5.3.3.1.1.1.3.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m5.3.3.1.1.1.3.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.15.m5.3.3.1.1.1.3.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.3.2">𝛼</ci><ci id="S3.SS3.p1.15.m5.3.3.1.1.1.3.3.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.p1.15.m5.3.3.1.1.1.4.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4"><apply id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1">subscript</csymbol><ci id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.2">∇</ci><apply id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3">subscript</csymbol><ci id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.2">𝑊</ci><ci id="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.3.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.2">subscript</csymbol><ci id="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.2">ℓ</ci><ci id="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.3.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.4.2.3">𝑖</ci></apply></apply><interval closure="open" id="S3.SS3.p1.15.m5.3.3.1.1.1.1.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.1"><apply id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.2">𝑊</ci><ci id="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.15.m5.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS3.p1.15.m5.2.2.cmml" xref="S3.SS3.p1.15.m5.2.2">𝜃</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.15.m5.3c">\nabla_{W_{i}}\mathcal{L}(\psi)=\alpha_{i}\nabla_{W_{i}}\ell_{i}(W_{i},\theta).</annotation></semantics></math>Note that for selected clients in set <math id="S3.SS3.p1.16.m6.1" class="ltx_Math" alttext="\mathcal{I}_{t}" display="inline"><semantics id="S3.SS3.p1.16.m6.1a"><msub id="S3.SS3.p1.16.m6.1.1" xref="S3.SS3.p1.16.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.16.m6.1.1.2" xref="S3.SS3.p1.16.m6.1.1.2.cmml">ℐ</mi><mi id="S3.SS3.p1.16.m6.1.1.3" xref="S3.SS3.p1.16.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.16.m6.1b"><apply id="S3.SS3.p1.16.m6.1.1.cmml" xref="S3.SS3.p1.16.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.16.m6.1.1.1.cmml" xref="S3.SS3.p1.16.m6.1.1">subscript</csymbol><ci id="S3.SS3.p1.16.m6.1.1.2.cmml" xref="S3.SS3.p1.16.m6.1.1.2">ℐ</ci><ci id="S3.SS3.p1.16.m6.1.1.3.cmml" xref="S3.SS3.p1.16.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.16.m6.1c">\mathcal{I}_{t}</annotation></semantics></math>, the corresponding vector, <math id="S3.SS3.p1.17.m7.2" class="ltx_Math" alttext="\nabla_{W_{i}}^{s}\!\mathcal{L}=\frac{I}{r}\alpha_{i}\nabla_{W_{i}}\ell_{i}(W_{i},\theta)" display="inline"><semantics id="S3.SS3.p1.17.m7.2a"><mrow id="S3.SS3.p1.17.m7.2.2" xref="S3.SS3.p1.17.m7.2.2.cmml"><mrow id="S3.SS3.p1.17.m7.2.2.3" xref="S3.SS3.p1.17.m7.2.2.3.cmml"><msubsup id="S3.SS3.p1.17.m7.2.2.3.1" xref="S3.SS3.p1.17.m7.2.2.3.1.cmml"><mo id="S3.SS3.p1.17.m7.2.2.3.1.2.2" xref="S3.SS3.p1.17.m7.2.2.3.1.2.2.cmml">∇</mo><msub id="S3.SS3.p1.17.m7.2.2.3.1.2.3" xref="S3.SS3.p1.17.m7.2.2.3.1.2.3.cmml"><mi id="S3.SS3.p1.17.m7.2.2.3.1.2.3.2" xref="S3.SS3.p1.17.m7.2.2.3.1.2.3.2.cmml">W</mi><mi id="S3.SS3.p1.17.m7.2.2.3.1.2.3.3" xref="S3.SS3.p1.17.m7.2.2.3.1.2.3.3.cmml">i</mi></msub><mi id="S3.SS3.p1.17.m7.2.2.3.1.3" xref="S3.SS3.p1.17.m7.2.2.3.1.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.17.m7.2.2.3.2" xref="S3.SS3.p1.17.m7.2.2.3.2.cmml">ℒ</mi></mrow><mo id="S3.SS3.p1.17.m7.2.2.2" xref="S3.SS3.p1.17.m7.2.2.2.cmml">=</mo><mrow id="S3.SS3.p1.17.m7.2.2.1" xref="S3.SS3.p1.17.m7.2.2.1.cmml"><mfrac id="S3.SS3.p1.17.m7.2.2.1.3" xref="S3.SS3.p1.17.m7.2.2.1.3.cmml"><mi id="S3.SS3.p1.17.m7.2.2.1.3.2" xref="S3.SS3.p1.17.m7.2.2.1.3.2.cmml">I</mi><mi id="S3.SS3.p1.17.m7.2.2.1.3.3" xref="S3.SS3.p1.17.m7.2.2.1.3.3.cmml">r</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.SS3.p1.17.m7.2.2.1.2" xref="S3.SS3.p1.17.m7.2.2.1.2.cmml">​</mo><msub id="S3.SS3.p1.17.m7.2.2.1.4" xref="S3.SS3.p1.17.m7.2.2.1.4.cmml"><mi id="S3.SS3.p1.17.m7.2.2.1.4.2" xref="S3.SS3.p1.17.m7.2.2.1.4.2.cmml">α</mi><mi id="S3.SS3.p1.17.m7.2.2.1.4.3" xref="S3.SS3.p1.17.m7.2.2.1.4.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.SS3.p1.17.m7.2.2.1.2a" xref="S3.SS3.p1.17.m7.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.p1.17.m7.2.2.1.5" xref="S3.SS3.p1.17.m7.2.2.1.5.cmml"><msub id="S3.SS3.p1.17.m7.2.2.1.5.1" xref="S3.SS3.p1.17.m7.2.2.1.5.1.cmml"><mo rspace="0.167em" id="S3.SS3.p1.17.m7.2.2.1.5.1.2" xref="S3.SS3.p1.17.m7.2.2.1.5.1.2.cmml">∇</mo><msub id="S3.SS3.p1.17.m7.2.2.1.5.1.3" xref="S3.SS3.p1.17.m7.2.2.1.5.1.3.cmml"><mi id="S3.SS3.p1.17.m7.2.2.1.5.1.3.2" xref="S3.SS3.p1.17.m7.2.2.1.5.1.3.2.cmml">W</mi><mi id="S3.SS3.p1.17.m7.2.2.1.5.1.3.3" xref="S3.SS3.p1.17.m7.2.2.1.5.1.3.3.cmml">i</mi></msub></msub><msub id="S3.SS3.p1.17.m7.2.2.1.5.2" xref="S3.SS3.p1.17.m7.2.2.1.5.2.cmml"><mi mathvariant="normal" id="S3.SS3.p1.17.m7.2.2.1.5.2.2" xref="S3.SS3.p1.17.m7.2.2.1.5.2.2.cmml">ℓ</mi><mi id="S3.SS3.p1.17.m7.2.2.1.5.2.3" xref="S3.SS3.p1.17.m7.2.2.1.5.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p1.17.m7.2.2.1.2b" xref="S3.SS3.p1.17.m7.2.2.1.2.cmml">​</mo><mrow id="S3.SS3.p1.17.m7.2.2.1.1.1" xref="S3.SS3.p1.17.m7.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.17.m7.2.2.1.1.1.2" xref="S3.SS3.p1.17.m7.2.2.1.1.2.cmml">(</mo><msub id="S3.SS3.p1.17.m7.2.2.1.1.1.1" xref="S3.SS3.p1.17.m7.2.2.1.1.1.1.cmml"><mi id="S3.SS3.p1.17.m7.2.2.1.1.1.1.2" xref="S3.SS3.p1.17.m7.2.2.1.1.1.1.2.cmml">W</mi><mi id="S3.SS3.p1.17.m7.2.2.1.1.1.1.3" xref="S3.SS3.p1.17.m7.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p1.17.m7.2.2.1.1.1.3" xref="S3.SS3.p1.17.m7.2.2.1.1.2.cmml">,</mo><mi id="S3.SS3.p1.17.m7.1.1" xref="S3.SS3.p1.17.m7.1.1.cmml">θ</mi><mo stretchy="false" id="S3.SS3.p1.17.m7.2.2.1.1.1.4" xref="S3.SS3.p1.17.m7.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.17.m7.2b"><apply id="S3.SS3.p1.17.m7.2.2.cmml" xref="S3.SS3.p1.17.m7.2.2"><eq id="S3.SS3.p1.17.m7.2.2.2.cmml" xref="S3.SS3.p1.17.m7.2.2.2"></eq><apply id="S3.SS3.p1.17.m7.2.2.3.cmml" xref="S3.SS3.p1.17.m7.2.2.3"><apply id="S3.SS3.p1.17.m7.2.2.3.1.cmml" xref="S3.SS3.p1.17.m7.2.2.3.1"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m7.2.2.3.1.1.cmml" xref="S3.SS3.p1.17.m7.2.2.3.1">superscript</csymbol><apply id="S3.SS3.p1.17.m7.2.2.3.1.2.cmml" xref="S3.SS3.p1.17.m7.2.2.3.1"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m7.2.2.3.1.2.1.cmml" xref="S3.SS3.p1.17.m7.2.2.3.1">subscript</csymbol><ci id="S3.SS3.p1.17.m7.2.2.3.1.2.2.cmml" xref="S3.SS3.p1.17.m7.2.2.3.1.2.2">∇</ci><apply id="S3.SS3.p1.17.m7.2.2.3.1.2.3.cmml" xref="S3.SS3.p1.17.m7.2.2.3.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m7.2.2.3.1.2.3.1.cmml" xref="S3.SS3.p1.17.m7.2.2.3.1.2.3">subscript</csymbol><ci id="S3.SS3.p1.17.m7.2.2.3.1.2.3.2.cmml" xref="S3.SS3.p1.17.m7.2.2.3.1.2.3.2">𝑊</ci><ci id="S3.SS3.p1.17.m7.2.2.3.1.2.3.3.cmml" xref="S3.SS3.p1.17.m7.2.2.3.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.p1.17.m7.2.2.3.1.3.cmml" xref="S3.SS3.p1.17.m7.2.2.3.1.3">𝑠</ci></apply><ci id="S3.SS3.p1.17.m7.2.2.3.2.cmml" xref="S3.SS3.p1.17.m7.2.2.3.2">ℒ</ci></apply><apply id="S3.SS3.p1.17.m7.2.2.1.cmml" xref="S3.SS3.p1.17.m7.2.2.1"><times id="S3.SS3.p1.17.m7.2.2.1.2.cmml" xref="S3.SS3.p1.17.m7.2.2.1.2"></times><apply id="S3.SS3.p1.17.m7.2.2.1.3.cmml" xref="S3.SS3.p1.17.m7.2.2.1.3"><divide id="S3.SS3.p1.17.m7.2.2.1.3.1.cmml" xref="S3.SS3.p1.17.m7.2.2.1.3"></divide><ci id="S3.SS3.p1.17.m7.2.2.1.3.2.cmml" xref="S3.SS3.p1.17.m7.2.2.1.3.2">𝐼</ci><ci id="S3.SS3.p1.17.m7.2.2.1.3.3.cmml" xref="S3.SS3.p1.17.m7.2.2.1.3.3">𝑟</ci></apply><apply id="S3.SS3.p1.17.m7.2.2.1.4.cmml" xref="S3.SS3.p1.17.m7.2.2.1.4"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m7.2.2.1.4.1.cmml" xref="S3.SS3.p1.17.m7.2.2.1.4">subscript</csymbol><ci id="S3.SS3.p1.17.m7.2.2.1.4.2.cmml" xref="S3.SS3.p1.17.m7.2.2.1.4.2">𝛼</ci><ci id="S3.SS3.p1.17.m7.2.2.1.4.3.cmml" xref="S3.SS3.p1.17.m7.2.2.1.4.3">𝑖</ci></apply><apply id="S3.SS3.p1.17.m7.2.2.1.5.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5"><apply id="S3.SS3.p1.17.m7.2.2.1.5.1.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.1"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m7.2.2.1.5.1.1.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.1">subscript</csymbol><ci id="S3.SS3.p1.17.m7.2.2.1.5.1.2.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.1.2">∇</ci><apply id="S3.SS3.p1.17.m7.2.2.1.5.1.3.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m7.2.2.1.5.1.3.1.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.1.3">subscript</csymbol><ci id="S3.SS3.p1.17.m7.2.2.1.5.1.3.2.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.1.3.2">𝑊</ci><ci id="S3.SS3.p1.17.m7.2.2.1.5.1.3.3.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.1.3.3">𝑖</ci></apply></apply><apply id="S3.SS3.p1.17.m7.2.2.1.5.2.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.2"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m7.2.2.1.5.2.1.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.2">subscript</csymbol><ci id="S3.SS3.p1.17.m7.2.2.1.5.2.2.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.2.2">ℓ</ci><ci id="S3.SS3.p1.17.m7.2.2.1.5.2.3.cmml" xref="S3.SS3.p1.17.m7.2.2.1.5.2.3">𝑖</ci></apply></apply><interval closure="open" id="S3.SS3.p1.17.m7.2.2.1.1.2.cmml" xref="S3.SS3.p1.17.m7.2.2.1.1.1"><apply id="S3.SS3.p1.17.m7.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.17.m7.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.17.m7.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.17.m7.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.17.m7.2.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.17.m7.2.2.1.1.1.1.2">𝑊</ci><ci id="S3.SS3.p1.17.m7.2.2.1.1.1.1.3.cmml" xref="S3.SS3.p1.17.m7.2.2.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS3.p1.17.m7.1.1.cmml" xref="S3.SS3.p1.17.m7.1.1">𝜃</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.17.m7.2c">\nabla_{W_{i}}^{s}\!\mathcal{L}=\frac{I}{r}\alpha_{i}\nabla_{W_{i}}\ell_{i}(W_{i},\theta)</annotation></semantics></math> is precisely the gradient used in the client update in (<a href="#S3.E4" title="Equation 4 ‣ Client side. ‣ 3.2.2 Client and Server Updates ‣ 3.2 The Proposed Algorithm ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), while for the remaining clients <math id="S3.SS3.p1.18.m8.1" class="ltx_Math" alttext="i\notin\mathcal{I}_{t}" display="inline"><semantics id="S3.SS3.p1.18.m8.1a"><mrow id="S3.SS3.p1.18.m8.1.1" xref="S3.SS3.p1.18.m8.1.1.cmml"><mi id="S3.SS3.p1.18.m8.1.1.2" xref="S3.SS3.p1.18.m8.1.1.2.cmml">i</mi><mo id="S3.SS3.p1.18.m8.1.1.1" xref="S3.SS3.p1.18.m8.1.1.1.cmml">∉</mo><msub id="S3.SS3.p1.18.m8.1.1.3" xref="S3.SS3.p1.18.m8.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.18.m8.1.1.3.2" xref="S3.SS3.p1.18.m8.1.1.3.2.cmml">ℐ</mi><mi id="S3.SS3.p1.18.m8.1.1.3.3" xref="S3.SS3.p1.18.m8.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.18.m8.1b"><apply id="S3.SS3.p1.18.m8.1.1.cmml" xref="S3.SS3.p1.18.m8.1.1"><notin id="S3.SS3.p1.18.m8.1.1.1.cmml" xref="S3.SS3.p1.18.m8.1.1.1"></notin><ci id="S3.SS3.p1.18.m8.1.1.2.cmml" xref="S3.SS3.p1.18.m8.1.1.2">𝑖</ci><apply id="S3.SS3.p1.18.m8.1.1.3.cmml" xref="S3.SS3.p1.18.m8.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.18.m8.1.1.3.1.cmml" xref="S3.SS3.p1.18.m8.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.18.m8.1.1.3.2.cmml" xref="S3.SS3.p1.18.m8.1.1.3.2">ℐ</ci><ci id="S3.SS3.p1.18.m8.1.1.3.3.cmml" xref="S3.SS3.p1.18.m8.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.18.m8.1c">i\notin\mathcal{I}_{t}</annotation></semantics></math>, <math id="S3.SS3.p1.19.m9.1" class="ltx_Math" alttext="\nabla_{W_{i}}^{s}\mathcal{L}=0" display="inline"><semantics id="S3.SS3.p1.19.m9.1a"><mrow id="S3.SS3.p1.19.m9.1.1" xref="S3.SS3.p1.19.m9.1.1.cmml"><mrow id="S3.SS3.p1.19.m9.1.1.2" xref="S3.SS3.p1.19.m9.1.1.2.cmml"><msubsup id="S3.SS3.p1.19.m9.1.1.2.1" xref="S3.SS3.p1.19.m9.1.1.2.1.cmml"><mo id="S3.SS3.p1.19.m9.1.1.2.1.2.2" xref="S3.SS3.p1.19.m9.1.1.2.1.2.2.cmml">∇</mo><msub id="S3.SS3.p1.19.m9.1.1.2.1.2.3" xref="S3.SS3.p1.19.m9.1.1.2.1.2.3.cmml"><mi id="S3.SS3.p1.19.m9.1.1.2.1.2.3.2" xref="S3.SS3.p1.19.m9.1.1.2.1.2.3.2.cmml">W</mi><mi id="S3.SS3.p1.19.m9.1.1.2.1.2.3.3" xref="S3.SS3.p1.19.m9.1.1.2.1.2.3.3.cmml">i</mi></msub><mi id="S3.SS3.p1.19.m9.1.1.2.1.3" xref="S3.SS3.p1.19.m9.1.1.2.1.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.19.m9.1.1.2.2" xref="S3.SS3.p1.19.m9.1.1.2.2.cmml">ℒ</mi></mrow><mo id="S3.SS3.p1.19.m9.1.1.1" xref="S3.SS3.p1.19.m9.1.1.1.cmml">=</mo><mn id="S3.SS3.p1.19.m9.1.1.3" xref="S3.SS3.p1.19.m9.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.19.m9.1b"><apply id="S3.SS3.p1.19.m9.1.1.cmml" xref="S3.SS3.p1.19.m9.1.1"><eq id="S3.SS3.p1.19.m9.1.1.1.cmml" xref="S3.SS3.p1.19.m9.1.1.1"></eq><apply id="S3.SS3.p1.19.m9.1.1.2.cmml" xref="S3.SS3.p1.19.m9.1.1.2"><apply id="S3.SS3.p1.19.m9.1.1.2.1.cmml" xref="S3.SS3.p1.19.m9.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS3.p1.19.m9.1.1.2.1.1.cmml" xref="S3.SS3.p1.19.m9.1.1.2.1">superscript</csymbol><apply id="S3.SS3.p1.19.m9.1.1.2.1.2.cmml" xref="S3.SS3.p1.19.m9.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS3.p1.19.m9.1.1.2.1.2.1.cmml" xref="S3.SS3.p1.19.m9.1.1.2.1">subscript</csymbol><ci id="S3.SS3.p1.19.m9.1.1.2.1.2.2.cmml" xref="S3.SS3.p1.19.m9.1.1.2.1.2.2">∇</ci><apply id="S3.SS3.p1.19.m9.1.1.2.1.2.3.cmml" xref="S3.SS3.p1.19.m9.1.1.2.1.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.19.m9.1.1.2.1.2.3.1.cmml" xref="S3.SS3.p1.19.m9.1.1.2.1.2.3">subscript</csymbol><ci id="S3.SS3.p1.19.m9.1.1.2.1.2.3.2.cmml" xref="S3.SS3.p1.19.m9.1.1.2.1.2.3.2">𝑊</ci><ci id="S3.SS3.p1.19.m9.1.1.2.1.2.3.3.cmml" xref="S3.SS3.p1.19.m9.1.1.2.1.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.p1.19.m9.1.1.2.1.3.cmml" xref="S3.SS3.p1.19.m9.1.1.2.1.3">𝑠</ci></apply><ci id="S3.SS3.p1.19.m9.1.1.2.2.cmml" xref="S3.SS3.p1.19.m9.1.1.2.2">ℒ</ci></apply><cn type="integer" id="S3.SS3.p1.19.m9.1.1.3.cmml" xref="S3.SS3.p1.19.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.19.m9.1c">\nabla_{W_{i}}^{s}\mathcal{L}=0</annotation></semantics></math>. The stochastic gradient <math id="S3.SS3.p1.20.m10.1" class="ltx_Math" alttext="\nabla_{\theta}^{s}\mathcal{L}" display="inline"><semantics id="S3.SS3.p1.20.m10.1a"><mrow id="S3.SS3.p1.20.m10.1.1" xref="S3.SS3.p1.20.m10.1.1.cmml"><msubsup id="S3.SS3.p1.20.m10.1.1.1" xref="S3.SS3.p1.20.m10.1.1.1.cmml"><mo id="S3.SS3.p1.20.m10.1.1.1.2.2" xref="S3.SS3.p1.20.m10.1.1.1.2.2.cmml">∇</mo><mi id="S3.SS3.p1.20.m10.1.1.1.2.3" xref="S3.SS3.p1.20.m10.1.1.1.2.3.cmml">θ</mi><mi id="S3.SS3.p1.20.m10.1.1.1.3" xref="S3.SS3.p1.20.m10.1.1.1.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.20.m10.1.1.2" xref="S3.SS3.p1.20.m10.1.1.2.cmml">ℒ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.20.m10.1b"><apply id="S3.SS3.p1.20.m10.1.1.cmml" xref="S3.SS3.p1.20.m10.1.1"><apply id="S3.SS3.p1.20.m10.1.1.1.cmml" xref="S3.SS3.p1.20.m10.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m10.1.1.1.1.cmml" xref="S3.SS3.p1.20.m10.1.1.1">superscript</csymbol><apply id="S3.SS3.p1.20.m10.1.1.1.2.cmml" xref="S3.SS3.p1.20.m10.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.20.m10.1.1.1.2.1.cmml" xref="S3.SS3.p1.20.m10.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.20.m10.1.1.1.2.2.cmml" xref="S3.SS3.p1.20.m10.1.1.1.2.2">∇</ci><ci id="S3.SS3.p1.20.m10.1.1.1.2.3.cmml" xref="S3.SS3.p1.20.m10.1.1.1.2.3">𝜃</ci></apply><ci id="S3.SS3.p1.20.m10.1.1.1.3.cmml" xref="S3.SS3.p1.20.m10.1.1.1.3">𝑠</ci></apply><ci id="S3.SS3.p1.20.m10.1.1.2.cmml" xref="S3.SS3.p1.20.m10.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.20.m10.1c">\nabla_{\theta}^{s}\mathcal{L}</annotation></semantics></math> is defined as</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.2" class="ltx_Math" alttext="\nabla_{\theta}^{s}\mathcal{L}=\frac{I}{r}\sum_{i=1}^{I}{\bf 1}(i\in\mathcal{I}_{t})\alpha_{i}\nabla_{\theta}\ell_{i}(W_{i},\theta)." display="block"><semantics id="S3.E7.m1.2a"><mrow id="S3.E7.m1.2.2.1" xref="S3.E7.m1.2.2.1.1.cmml"><mrow id="S3.E7.m1.2.2.1.1" xref="S3.E7.m1.2.2.1.1.cmml"><mrow id="S3.E7.m1.2.2.1.1.4" xref="S3.E7.m1.2.2.1.1.4.cmml"><msubsup id="S3.E7.m1.2.2.1.1.4.1" xref="S3.E7.m1.2.2.1.1.4.1.cmml"><mo id="S3.E7.m1.2.2.1.1.4.1.2.2" xref="S3.E7.m1.2.2.1.1.4.1.2.2.cmml">∇</mo><mi id="S3.E7.m1.2.2.1.1.4.1.2.3" xref="S3.E7.m1.2.2.1.1.4.1.2.3.cmml">θ</mi><mi id="S3.E7.m1.2.2.1.1.4.1.3" xref="S3.E7.m1.2.2.1.1.4.1.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.1.1.4.2" xref="S3.E7.m1.2.2.1.1.4.2.cmml">ℒ</mi></mrow><mo id="S3.E7.m1.2.2.1.1.3" xref="S3.E7.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E7.m1.2.2.1.1.2" xref="S3.E7.m1.2.2.1.1.2.cmml"><mfrac id="S3.E7.m1.2.2.1.1.2.4" xref="S3.E7.m1.2.2.1.1.2.4.cmml"><mi id="S3.E7.m1.2.2.1.1.2.4.2" xref="S3.E7.m1.2.2.1.1.2.4.2.cmml">I</mi><mi id="S3.E7.m1.2.2.1.1.2.4.3" xref="S3.E7.m1.2.2.1.1.2.4.3.cmml">r</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.2.3" xref="S3.E7.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E7.m1.2.2.1.1.2.2" xref="S3.E7.m1.2.2.1.1.2.2.cmml"><munderover id="S3.E7.m1.2.2.1.1.2.2.3" xref="S3.E7.m1.2.2.1.1.2.2.3.cmml"><mo movablelimits="false" id="S3.E7.m1.2.2.1.1.2.2.3.2.2" xref="S3.E7.m1.2.2.1.1.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E7.m1.2.2.1.1.2.2.3.2.3" xref="S3.E7.m1.2.2.1.1.2.2.3.2.3.cmml"><mi id="S3.E7.m1.2.2.1.1.2.2.3.2.3.2" xref="S3.E7.m1.2.2.1.1.2.2.3.2.3.2.cmml">i</mi><mo id="S3.E7.m1.2.2.1.1.2.2.3.2.3.1" xref="S3.E7.m1.2.2.1.1.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E7.m1.2.2.1.1.2.2.3.2.3.3" xref="S3.E7.m1.2.2.1.1.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.2.2.1.1.2.2.3.3" xref="S3.E7.m1.2.2.1.1.2.2.3.3.cmml">I</mi></munderover><mrow id="S3.E7.m1.2.2.1.1.2.2.2" xref="S3.E7.m1.2.2.1.1.2.2.2.cmml"><mn id="S3.E7.m1.2.2.1.1.2.2.2.4" xref="S3.E7.m1.2.2.1.1.2.2.2.4.cmml">𝟏</mn><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.2.2.2.3" xref="S3.E7.m1.2.2.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">∈</mo><msub id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">ℐ</mi><mi id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.2.2.2.3a" xref="S3.E7.m1.2.2.1.1.2.2.2.3.cmml">​</mo><msub id="S3.E7.m1.2.2.1.1.2.2.2.5" xref="S3.E7.m1.2.2.1.1.2.2.2.5.cmml"><mi id="S3.E7.m1.2.2.1.1.2.2.2.5.2" xref="S3.E7.m1.2.2.1.1.2.2.2.5.2.cmml">α</mi><mi id="S3.E7.m1.2.2.1.1.2.2.2.5.3" xref="S3.E7.m1.2.2.1.1.2.2.2.5.3.cmml">i</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.E7.m1.2.2.1.1.2.2.2.3b" xref="S3.E7.m1.2.2.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E7.m1.2.2.1.1.2.2.2.6" xref="S3.E7.m1.2.2.1.1.2.2.2.6.cmml"><msub id="S3.E7.m1.2.2.1.1.2.2.2.6.1" xref="S3.E7.m1.2.2.1.1.2.2.2.6.1.cmml"><mo rspace="0.167em" id="S3.E7.m1.2.2.1.1.2.2.2.6.1.2" xref="S3.E7.m1.2.2.1.1.2.2.2.6.1.2.cmml">∇</mo><mi id="S3.E7.m1.2.2.1.1.2.2.2.6.1.3" xref="S3.E7.m1.2.2.1.1.2.2.2.6.1.3.cmml">θ</mi></msub><msub id="S3.E7.m1.2.2.1.1.2.2.2.6.2" xref="S3.E7.m1.2.2.1.1.2.2.2.6.2.cmml"><mi mathvariant="normal" id="S3.E7.m1.2.2.1.1.2.2.2.6.2.2" xref="S3.E7.m1.2.2.1.1.2.2.2.6.2.2.cmml">ℓ</mi><mi id="S3.E7.m1.2.2.1.1.2.2.2.6.2.3" xref="S3.E7.m1.2.2.1.1.2.2.2.6.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E7.m1.2.2.1.1.2.2.2.3c" xref="S3.E7.m1.2.2.1.1.2.2.2.3.cmml">​</mo><mrow id="S3.E7.m1.2.2.1.1.2.2.2.2.1" xref="S3.E7.m1.2.2.1.1.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.1.1.2.2.2.2.1.2" xref="S3.E7.m1.2.2.1.1.2.2.2.2.2.cmml">(</mo><msub id="S3.E7.m1.2.2.1.1.2.2.2.2.1.1" xref="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.cmml"><mi id="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.2" xref="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.2.cmml">W</mi><mi id="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.3" xref="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m1.2.2.1.1.2.2.2.2.1.3" xref="S3.E7.m1.2.2.1.1.2.2.2.2.2.cmml">,</mo><mi id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E7.m1.2.2.1.1.2.2.2.2.1.4" xref="S3.E7.m1.2.2.1.1.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E7.m1.2.2.1.2" xref="S3.E7.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.2b"><apply id="S3.E7.m1.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1"><eq id="S3.E7.m1.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.3"></eq><apply id="S3.E7.m1.2.2.1.1.4.cmml" xref="S3.E7.m1.2.2.1.1.4"><apply id="S3.E7.m1.2.2.1.1.4.1.cmml" xref="S3.E7.m1.2.2.1.1.4.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.4.1.1.cmml" xref="S3.E7.m1.2.2.1.1.4.1">superscript</csymbol><apply id="S3.E7.m1.2.2.1.1.4.1.2.cmml" xref="S3.E7.m1.2.2.1.1.4.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.4.1.2.1.cmml" xref="S3.E7.m1.2.2.1.1.4.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.4.1.2.2.cmml" xref="S3.E7.m1.2.2.1.1.4.1.2.2">∇</ci><ci id="S3.E7.m1.2.2.1.1.4.1.2.3.cmml" xref="S3.E7.m1.2.2.1.1.4.1.2.3">𝜃</ci></apply><ci id="S3.E7.m1.2.2.1.1.4.1.3.cmml" xref="S3.E7.m1.2.2.1.1.4.1.3">𝑠</ci></apply><ci id="S3.E7.m1.2.2.1.1.4.2.cmml" xref="S3.E7.m1.2.2.1.1.4.2">ℒ</ci></apply><apply id="S3.E7.m1.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.2"><times id="S3.E7.m1.2.2.1.1.2.3.cmml" xref="S3.E7.m1.2.2.1.1.2.3"></times><apply id="S3.E7.m1.2.2.1.1.2.4.cmml" xref="S3.E7.m1.2.2.1.1.2.4"><divide id="S3.E7.m1.2.2.1.1.2.4.1.cmml" xref="S3.E7.m1.2.2.1.1.2.4"></divide><ci id="S3.E7.m1.2.2.1.1.2.4.2.cmml" xref="S3.E7.m1.2.2.1.1.2.4.2">𝐼</ci><ci id="S3.E7.m1.2.2.1.1.2.4.3.cmml" xref="S3.E7.m1.2.2.1.1.2.4.3">𝑟</ci></apply><apply id="S3.E7.m1.2.2.1.1.2.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2"><apply id="S3.E7.m1.2.2.1.1.2.2.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.2.2.3.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.3">superscript</csymbol><apply id="S3.E7.m1.2.2.1.1.2.2.3.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.2.2.3.2.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.3">subscript</csymbol><sum id="S3.E7.m1.2.2.1.1.2.2.3.2.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.3.2.2"></sum><apply id="S3.E7.m1.2.2.1.1.2.2.3.2.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.3.2.3"><eq id="S3.E7.m1.2.2.1.1.2.2.3.2.3.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.3.2.3.1"></eq><ci id="S3.E7.m1.2.2.1.1.2.2.3.2.3.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S3.E7.m1.2.2.1.1.2.2.3.2.3.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.2.2.1.1.2.2.3.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.3.3">𝐼</ci></apply><apply id="S3.E7.m1.2.2.1.1.2.2.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2"><times id="S3.E7.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.3"></times><cn type="integer" id="S3.E7.m1.2.2.1.1.2.2.2.4.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.4">1</cn><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1"><in id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.1"></in><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.2">ℐ</ci><ci id="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="S3.E7.m1.2.2.1.1.2.2.2.5.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.2.2.2.5.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.5">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.2.2.2.5.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.5.2">𝛼</ci><ci id="S3.E7.m1.2.2.1.1.2.2.2.5.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.5.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.1.1.2.2.2.6.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.6"><apply id="S3.E7.m1.2.2.1.1.2.2.2.6.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.6.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.2.2.2.6.1.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.6.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.2.2.2.6.1.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.6.1.2">∇</ci><ci id="S3.E7.m1.2.2.1.1.2.2.2.6.1.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.6.1.3">𝜃</ci></apply><apply id="S3.E7.m1.2.2.1.1.2.2.2.6.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.6.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.2.2.2.6.2.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.6.2">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.2.2.2.6.2.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.6.2.2">ℓ</ci><ci id="S3.E7.m1.2.2.1.1.2.2.2.6.2.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.6.2.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E7.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.2.1"><apply id="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.2">𝑊</ci><ci id="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.1.1.2.2.2.2.1.1.3">𝑖</ci></apply><ci id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1">𝜃</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.2c">\nabla_{\theta}^{s}\mathcal{L}=\frac{I}{r}\sum_{i=1}^{I}{\bf 1}(i\in\mathcal{I}_{t})\alpha_{i}\nabla_{\theta}\ell_{i}(W_{i},\theta).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.21" class="ltx_p">We can see that in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Server side. ‣ 3.2.2 Client and Server Updates ‣ 3.2 The Proposed Algorithm ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the final client update together with the server update can be compactly written as the following gradient update over all parameters <math id="S3.SS3.p1.21.m1.1" class="ltx_Math" alttext="\psi" display="inline"><semantics id="S3.SS3.p1.21.m1.1a"><mi id="S3.SS3.p1.21.m1.1.1" xref="S3.SS3.p1.21.m1.1.1.cmml">ψ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.21.m1.1b"><ci id="S3.SS3.p1.21.m1.1.1.cmml" xref="S3.SS3.p1.21.m1.1.1">𝜓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.21.m1.1c">\psi</annotation></semantics></math>:</p>
<table id="S3.Ex4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex4.m1.1" class="ltx_Math" alttext="\psi\leftarrow\psi-\rho_{t}\nabla^{s}_{\psi}\mathcal{L}." display="block"><semantics id="S3.Ex4.m1.1a"><mrow id="S3.Ex4.m1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.cmml"><mrow id="S3.Ex4.m1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.2.cmml">ψ</mi><mo stretchy="false" id="S3.Ex4.m1.1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.1.cmml">←</mo><mrow id="S3.Ex4.m1.1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.1.3.cmml"><mi id="S3.Ex4.m1.1.1.1.1.3.2" xref="S3.Ex4.m1.1.1.1.1.3.2.cmml">ψ</mi><mo id="S3.Ex4.m1.1.1.1.1.3.1" xref="S3.Ex4.m1.1.1.1.1.3.1.cmml">−</mo><mrow id="S3.Ex4.m1.1.1.1.1.3.3" xref="S3.Ex4.m1.1.1.1.1.3.3.cmml"><msub id="S3.Ex4.m1.1.1.1.1.3.3.2" xref="S3.Ex4.m1.1.1.1.1.3.3.2.cmml"><mi id="S3.Ex4.m1.1.1.1.1.3.3.2.2" xref="S3.Ex4.m1.1.1.1.1.3.3.2.2.cmml">ρ</mi><mi id="S3.Ex4.m1.1.1.1.1.3.3.2.3" xref="S3.Ex4.m1.1.1.1.1.3.3.2.3.cmml">t</mi></msub><mo lspace="0.167em" rspace="0em" id="S3.Ex4.m1.1.1.1.1.3.3.1" xref="S3.Ex4.m1.1.1.1.1.3.3.1.cmml">​</mo><mrow id="S3.Ex4.m1.1.1.1.1.3.3.3" xref="S3.Ex4.m1.1.1.1.1.3.3.3.cmml"><msubsup id="S3.Ex4.m1.1.1.1.1.3.3.3.1" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1.cmml"><mo rspace="0.167em" id="S3.Ex4.m1.1.1.1.1.3.3.3.1.2.2" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1.2.2.cmml">∇</mo><mi id="S3.Ex4.m1.1.1.1.1.3.3.3.1.3" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1.3.cmml">ψ</mi><mi id="S3.Ex4.m1.1.1.1.1.3.3.3.1.2.3" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1.2.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.Ex4.m1.1.1.1.1.3.3.3.2" xref="S3.Ex4.m1.1.1.1.1.3.3.3.2.cmml">ℒ</mi></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.Ex4.m1.1.1.1.2" xref="S3.Ex4.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.1b"><apply id="S3.Ex4.m1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1"><ci id="S3.Ex4.m1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.1">←</ci><ci id="S3.Ex4.m1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.2">𝜓</ci><apply id="S3.Ex4.m1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.3"><minus id="S3.Ex4.m1.1.1.1.1.3.1.cmml" xref="S3.Ex4.m1.1.1.1.1.3.1"></minus><ci id="S3.Ex4.m1.1.1.1.1.3.2.cmml" xref="S3.Ex4.m1.1.1.1.1.3.2">𝜓</ci><apply id="S3.Ex4.m1.1.1.1.1.3.3.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3"><times id="S3.Ex4.m1.1.1.1.1.3.3.1.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.1"></times><apply id="S3.Ex4.m1.1.1.1.1.3.3.2.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.2.2">𝜌</ci><ci id="S3.Ex4.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.2.3">𝑡</ci></apply><apply id="S3.Ex4.m1.1.1.1.1.3.3.3.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.3"><apply id="S3.Ex4.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.3.3.3.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1">subscript</csymbol><apply id="S3.Ex4.m1.1.1.1.1.3.3.3.1.2.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1"><csymbol cd="ambiguous" id="S3.Ex4.m1.1.1.1.1.3.3.3.1.2.1.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1">superscript</csymbol><ci id="S3.Ex4.m1.1.1.1.1.3.3.3.1.2.2.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1.2.2">∇</ci><ci id="S3.Ex4.m1.1.1.1.1.3.3.3.1.2.3.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1.2.3">𝑠</ci></apply><ci id="S3.Ex4.m1.1.1.1.1.3.3.3.1.3.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.3.1.3">𝜓</ci></apply><ci id="S3.Ex4.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.Ex4.m1.1.1.1.1.3.3.3.2">ℒ</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.1c">\psi\leftarrow\psi-\rho_{t}\nabla^{s}_{\psi}\mathcal{L}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.22" class="ltx_p">This now is a proper SGD step as long as the stochastic gradient <math id="S3.SS3.p1.22.m1.1" class="ltx_Math" alttext="\nabla^{s}_{\psi}\mathcal{L}" display="inline"><semantics id="S3.SS3.p1.22.m1.1a"><mrow id="S3.SS3.p1.22.m1.1.1" xref="S3.SS3.p1.22.m1.1.1.cmml"><msubsup id="S3.SS3.p1.22.m1.1.1.1" xref="S3.SS3.p1.22.m1.1.1.1.cmml"><mo id="S3.SS3.p1.22.m1.1.1.1.2.2" xref="S3.SS3.p1.22.m1.1.1.1.2.2.cmml">∇</mo><mi id="S3.SS3.p1.22.m1.1.1.1.3" xref="S3.SS3.p1.22.m1.1.1.1.3.cmml">ψ</mi><mi id="S3.SS3.p1.22.m1.1.1.1.2.3" xref="S3.SS3.p1.22.m1.1.1.1.2.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.22.m1.1.1.2" xref="S3.SS3.p1.22.m1.1.1.2.cmml">ℒ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.22.m1.1b"><apply id="S3.SS3.p1.22.m1.1.1.cmml" xref="S3.SS3.p1.22.m1.1.1"><apply id="S3.SS3.p1.22.m1.1.1.1.cmml" xref="S3.SS3.p1.22.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.22.m1.1.1.1.1.cmml" xref="S3.SS3.p1.22.m1.1.1.1">subscript</csymbol><apply id="S3.SS3.p1.22.m1.1.1.1.2.cmml" xref="S3.SS3.p1.22.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.22.m1.1.1.1.2.1.cmml" xref="S3.SS3.p1.22.m1.1.1.1">superscript</csymbol><ci id="S3.SS3.p1.22.m1.1.1.1.2.2.cmml" xref="S3.SS3.p1.22.m1.1.1.1.2.2">∇</ci><ci id="S3.SS3.p1.22.m1.1.1.1.2.3.cmml" xref="S3.SS3.p1.22.m1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.SS3.p1.22.m1.1.1.1.3.cmml" xref="S3.SS3.p1.22.m1.1.1.1.3">𝜓</ci></apply><ci id="S3.SS3.p1.22.m1.1.1.2.cmml" xref="S3.SS3.p1.22.m1.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.22.m1.1c">\nabla^{s}_{\psi}\mathcal{L}</annotation></semantics></math> is unbiased, as we state next.</p>
</div>
<div id="Thmprop1" class="ltx_theorem ltx_theorem_prop">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span id="Thmprop1.1.1.1" class="ltx_text ltx_font_bold">Proposition 1</span></span><span id="Thmprop1.2.2" class="ltx_text ltx_font_bold">.</span>
</h6>
<div id="Thmprop1.p1" class="ltx_para">
<p id="Thmprop1.p1.3" class="ltx_p"><span id="Thmprop1.p1.3.3" class="ltx_text ltx_font_italic">The stochastic gradient <math id="Thmprop1.p1.1.1.m1.1" class="ltx_Math" alttext="\nabla^{s}_{\psi}\mathcal{L}" display="inline"><semantics id="Thmprop1.p1.1.1.m1.1a"><mrow id="Thmprop1.p1.1.1.m1.1.1" xref="Thmprop1.p1.1.1.m1.1.1.cmml"><msubsup id="Thmprop1.p1.1.1.m1.1.1.1" xref="Thmprop1.p1.1.1.m1.1.1.1.cmml"><mo id="Thmprop1.p1.1.1.m1.1.1.1.2.2" xref="Thmprop1.p1.1.1.m1.1.1.1.2.2.cmml">∇</mo><mi id="Thmprop1.p1.1.1.m1.1.1.1.3" xref="Thmprop1.p1.1.1.m1.1.1.1.3.cmml">ψ</mi><mi id="Thmprop1.p1.1.1.m1.1.1.1.2.3" xref="Thmprop1.p1.1.1.m1.1.1.1.2.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.1.1.m1.1.1.2" xref="Thmprop1.p1.1.1.m1.1.1.2.cmml">ℒ</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmprop1.p1.1.1.m1.1b"><apply id="Thmprop1.p1.1.1.m1.1.1.cmml" xref="Thmprop1.p1.1.1.m1.1.1"><apply id="Thmprop1.p1.1.1.m1.1.1.1.cmml" xref="Thmprop1.p1.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="Thmprop1.p1.1.1.m1.1.1.1.1.cmml" xref="Thmprop1.p1.1.1.m1.1.1.1">subscript</csymbol><apply id="Thmprop1.p1.1.1.m1.1.1.1.2.cmml" xref="Thmprop1.p1.1.1.m1.1.1.1"><csymbol cd="ambiguous" id="Thmprop1.p1.1.1.m1.1.1.1.2.1.cmml" xref="Thmprop1.p1.1.1.m1.1.1.1">superscript</csymbol><ci id="Thmprop1.p1.1.1.m1.1.1.1.2.2.cmml" xref="Thmprop1.p1.1.1.m1.1.1.1.2.2">∇</ci><ci id="Thmprop1.p1.1.1.m1.1.1.1.2.3.cmml" xref="Thmprop1.p1.1.1.m1.1.1.1.2.3">𝑠</ci></apply><ci id="Thmprop1.p1.1.1.m1.1.1.1.3.cmml" xref="Thmprop1.p1.1.1.m1.1.1.1.3">𝜓</ci></apply><ci id="Thmprop1.p1.1.1.m1.1.1.2.cmml" xref="Thmprop1.p1.1.1.m1.1.1.2">ℒ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmprop1.p1.1.1.m1.1c">\nabla^{s}_{\psi}\mathcal{L}</annotation></semantics></math> is unbiased, i.e. it holds
<math id="Thmprop1.p1.2.2.m2.2" class="ltx_Math" alttext="\mathbb{E}[\nabla^{s}_{\psi}\mathcal{L}]=\nabla_{\psi}\mathcal{L}(\psi)" display="inline"><semantics id="Thmprop1.p1.2.2.m2.2a"><mrow id="Thmprop1.p1.2.2.m2.2.2" xref="Thmprop1.p1.2.2.m2.2.2.cmml"><mrow id="Thmprop1.p1.2.2.m2.2.2.1" xref="Thmprop1.p1.2.2.m2.2.2.1.cmml"><mi id="Thmprop1.p1.2.2.m2.2.2.1.3" xref="Thmprop1.p1.2.2.m2.2.2.1.3.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="Thmprop1.p1.2.2.m2.2.2.1.2" xref="Thmprop1.p1.2.2.m2.2.2.1.2.cmml">​</mo><mrow id="Thmprop1.p1.2.2.m2.2.2.1.1.1" xref="Thmprop1.p1.2.2.m2.2.2.1.1.2.cmml"><mo stretchy="false" id="Thmprop1.p1.2.2.m2.2.2.1.1.1.2" xref="Thmprop1.p1.2.2.m2.2.2.1.1.2.1.cmml">[</mo><mrow id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.cmml"><msubsup id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.cmml"><mo rspace="0.167em" id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.2.2" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.2.2.cmml">∇</mo><mi id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.3" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.3.cmml">ψ</mi><mi id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.2.3" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.2.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.2" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.2.cmml">ℒ</mi></mrow><mo stretchy="false" id="Thmprop1.p1.2.2.m2.2.2.1.1.1.3" xref="Thmprop1.p1.2.2.m2.2.2.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="Thmprop1.p1.2.2.m2.2.2.2" xref="Thmprop1.p1.2.2.m2.2.2.2.cmml">=</mo><mrow id="Thmprop1.p1.2.2.m2.2.2.3" xref="Thmprop1.p1.2.2.m2.2.2.3.cmml"><mrow id="Thmprop1.p1.2.2.m2.2.2.3.2" xref="Thmprop1.p1.2.2.m2.2.2.3.2.cmml"><msub id="Thmprop1.p1.2.2.m2.2.2.3.2.1" xref="Thmprop1.p1.2.2.m2.2.2.3.2.1.cmml"><mo rspace="0.167em" id="Thmprop1.p1.2.2.m2.2.2.3.2.1.2" xref="Thmprop1.p1.2.2.m2.2.2.3.2.1.2.cmml">∇</mo><mi id="Thmprop1.p1.2.2.m2.2.2.3.2.1.3" xref="Thmprop1.p1.2.2.m2.2.2.3.2.1.3.cmml">ψ</mi></msub><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.2.2.m2.2.2.3.2.2" xref="Thmprop1.p1.2.2.m2.2.2.3.2.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="Thmprop1.p1.2.2.m2.2.2.3.1" xref="Thmprop1.p1.2.2.m2.2.2.3.1.cmml">​</mo><mrow id="Thmprop1.p1.2.2.m2.2.2.3.3.2" xref="Thmprop1.p1.2.2.m2.2.2.3.cmml"><mo stretchy="false" id="Thmprop1.p1.2.2.m2.2.2.3.3.2.1" xref="Thmprop1.p1.2.2.m2.2.2.3.cmml">(</mo><mi id="Thmprop1.p1.2.2.m2.1.1" xref="Thmprop1.p1.2.2.m2.1.1.cmml">ψ</mi><mo stretchy="false" id="Thmprop1.p1.2.2.m2.2.2.3.3.2.2" xref="Thmprop1.p1.2.2.m2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmprop1.p1.2.2.m2.2b"><apply id="Thmprop1.p1.2.2.m2.2.2.cmml" xref="Thmprop1.p1.2.2.m2.2.2"><eq id="Thmprop1.p1.2.2.m2.2.2.2.cmml" xref="Thmprop1.p1.2.2.m2.2.2.2"></eq><apply id="Thmprop1.p1.2.2.m2.2.2.1.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1"><times id="Thmprop1.p1.2.2.m2.2.2.1.2.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.2"></times><ci id="Thmprop1.p1.2.2.m2.2.2.1.3.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.3">𝔼</ci><apply id="Thmprop1.p1.2.2.m2.2.2.1.1.2.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1"><csymbol cd="latexml" id="Thmprop1.p1.2.2.m2.2.2.1.1.2.1.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.2">delimited-[]</csymbol><apply id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1"><apply id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.1.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1">subscript</csymbol><apply id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.2.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.2.1.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1">superscript</csymbol><ci id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.2.2.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.2.2">∇</ci><ci id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.2.3.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.3.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.1.3">𝜓</ci></apply><ci id="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.2.cmml" xref="Thmprop1.p1.2.2.m2.2.2.1.1.1.1.2">ℒ</ci></apply></apply></apply><apply id="Thmprop1.p1.2.2.m2.2.2.3.cmml" xref="Thmprop1.p1.2.2.m2.2.2.3"><times id="Thmprop1.p1.2.2.m2.2.2.3.1.cmml" xref="Thmprop1.p1.2.2.m2.2.2.3.1"></times><apply id="Thmprop1.p1.2.2.m2.2.2.3.2.cmml" xref="Thmprop1.p1.2.2.m2.2.2.3.2"><apply id="Thmprop1.p1.2.2.m2.2.2.3.2.1.cmml" xref="Thmprop1.p1.2.2.m2.2.2.3.2.1"><csymbol cd="ambiguous" id="Thmprop1.p1.2.2.m2.2.2.3.2.1.1.cmml" xref="Thmprop1.p1.2.2.m2.2.2.3.2.1">subscript</csymbol><ci id="Thmprop1.p1.2.2.m2.2.2.3.2.1.2.cmml" xref="Thmprop1.p1.2.2.m2.2.2.3.2.1.2">∇</ci><ci id="Thmprop1.p1.2.2.m2.2.2.3.2.1.3.cmml" xref="Thmprop1.p1.2.2.m2.2.2.3.2.1.3">𝜓</ci></apply><ci id="Thmprop1.p1.2.2.m2.2.2.3.2.2.cmml" xref="Thmprop1.p1.2.2.m2.2.2.3.2.2">ℒ</ci></apply><ci id="Thmprop1.p1.2.2.m2.1.1.cmml" xref="Thmprop1.p1.2.2.m2.1.1">𝜓</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmprop1.p1.2.2.m2.2c">\mathbb{E}[\nabla^{s}_{\psi}\mathcal{L}]=\nabla_{\psi}\mathcal{L}(\psi)</annotation></semantics></math> where
<math id="Thmprop1.p1.3.3.m3.1" class="ltx_Math" alttext="\nabla_{\psi}\mathcal{L}(\psi)" display="inline"><semantics id="Thmprop1.p1.3.3.m3.1a"><mrow id="Thmprop1.p1.3.3.m3.1.2" xref="Thmprop1.p1.3.3.m3.1.2.cmml"><mrow id="Thmprop1.p1.3.3.m3.1.2.2" xref="Thmprop1.p1.3.3.m3.1.2.2.cmml"><msub id="Thmprop1.p1.3.3.m3.1.2.2.1" xref="Thmprop1.p1.3.3.m3.1.2.2.1.cmml"><mo id="Thmprop1.p1.3.3.m3.1.2.2.1.2" xref="Thmprop1.p1.3.3.m3.1.2.2.1.2.cmml">∇</mo><mi id="Thmprop1.p1.3.3.m3.1.2.2.1.3" xref="Thmprop1.p1.3.3.m3.1.2.2.1.3.cmml">ψ</mi></msub><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.3.3.m3.1.2.2.2" xref="Thmprop1.p1.3.3.m3.1.2.2.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="Thmprop1.p1.3.3.m3.1.2.1" xref="Thmprop1.p1.3.3.m3.1.2.1.cmml">​</mo><mrow id="Thmprop1.p1.3.3.m3.1.2.3.2" xref="Thmprop1.p1.3.3.m3.1.2.cmml"><mo stretchy="false" id="Thmprop1.p1.3.3.m3.1.2.3.2.1" xref="Thmprop1.p1.3.3.m3.1.2.cmml">(</mo><mi id="Thmprop1.p1.3.3.m3.1.1" xref="Thmprop1.p1.3.3.m3.1.1.cmml">ψ</mi><mo stretchy="false" id="Thmprop1.p1.3.3.m3.1.2.3.2.2" xref="Thmprop1.p1.3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmprop1.p1.3.3.m3.1b"><apply id="Thmprop1.p1.3.3.m3.1.2.cmml" xref="Thmprop1.p1.3.3.m3.1.2"><times id="Thmprop1.p1.3.3.m3.1.2.1.cmml" xref="Thmprop1.p1.3.3.m3.1.2.1"></times><apply id="Thmprop1.p1.3.3.m3.1.2.2.cmml" xref="Thmprop1.p1.3.3.m3.1.2.2"><apply id="Thmprop1.p1.3.3.m3.1.2.2.1.cmml" xref="Thmprop1.p1.3.3.m3.1.2.2.1"><csymbol cd="ambiguous" id="Thmprop1.p1.3.3.m3.1.2.2.1.1.cmml" xref="Thmprop1.p1.3.3.m3.1.2.2.1">subscript</csymbol><ci id="Thmprop1.p1.3.3.m3.1.2.2.1.2.cmml" xref="Thmprop1.p1.3.3.m3.1.2.2.1.2">∇</ci><ci id="Thmprop1.p1.3.3.m3.1.2.2.1.3.cmml" xref="Thmprop1.p1.3.3.m3.1.2.2.1.3">𝜓</ci></apply><ci id="Thmprop1.p1.3.3.m3.1.2.2.2.cmml" xref="Thmprop1.p1.3.3.m3.1.2.2.2">ℒ</ci></apply><ci id="Thmprop1.p1.3.3.m3.1.1.cmml" xref="Thmprop1.p1.3.3.m3.1.1">𝜓</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmprop1.p1.3.3.m3.1c">\nabla_{\psi}\mathcal{L}(\psi)</annotation></semantics></math> denotes the exact gradient and the expectation is taken under the client participation process (either case i or ii) defined in Section <a href="#S3.SS2.SSS1" title="3.2.1 Client Participation Process ‣ 3.2 The Proposed Algorithm ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>.</span></p>
</div>
</div>
<div id="S3.SS3.1" class="ltx_proof">
<h6 class="ltx_title ltx_runin ltx_font_italic ltx_title_proof">Proof.</h6>
<div id="S3.SS3.1.p1" class="ltx_para">
<p id="S3.SS3.1.p1.5" class="ltx_p">By taking the expectation
<math id="S3.SS3.1.p1.1.m1.1" class="ltx_Math" alttext="\mathbb{E}[\nabla^{s}_{W_{i}}\mathcal{L}]" display="inline"><semantics id="S3.SS3.1.p1.1.m1.1a"><mrow id="S3.SS3.1.p1.1.m1.1.1" xref="S3.SS3.1.p1.1.m1.1.1.cmml"><mi id="S3.SS3.1.p1.1.m1.1.1.3" xref="S3.SS3.1.p1.1.m1.1.1.3.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="S3.SS3.1.p1.1.m1.1.1.2" xref="S3.SS3.1.p1.1.m1.1.1.2.cmml">​</mo><mrow id="S3.SS3.1.p1.1.m1.1.1.1.1" xref="S3.SS3.1.p1.1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.1.p1.1.m1.1.1.1.1.2" xref="S3.SS3.1.p1.1.m1.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS3.1.p1.1.m1.1.1.1.1.1" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.cmml"><msubsup id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.2.2" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.2.2.cmml">∇</mo><msub id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.2" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.2.cmml">W</mi><mi id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.3" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mi id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.2.3" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.2.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.1.p1.1.m1.1.1.1.1.1.2" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.2.cmml">ℒ</mi></mrow><mo stretchy="false" id="S3.SS3.1.p1.1.m1.1.1.1.1.3" xref="S3.SS3.1.p1.1.m1.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.1.m1.1b"><apply id="S3.SS3.1.p1.1.m1.1.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1"><times id="S3.SS3.1.p1.1.m1.1.1.2.cmml" xref="S3.SS3.1.p1.1.m1.1.1.2"></times><ci id="S3.SS3.1.p1.1.m1.1.1.3.cmml" xref="S3.SS3.1.p1.1.m1.1.1.3">𝔼</ci><apply id="S3.SS3.1.p1.1.m1.1.1.1.2.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.1.p1.1.m1.1.1.1.2.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.1.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1"><apply id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.2.2">∇</ci><ci id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.2">𝑊</ci><ci id="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.1.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.1.p1.1.m1.1.1.1.1.1.2">ℒ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.1.m1.1c">\mathbb{E}[\nabla^{s}_{W_{i}}\mathcal{L}]</annotation></semantics></math> for any <math id="S3.SS3.1.p1.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.1.p1.2.m2.1a"><mi id="S3.SS3.1.p1.2.m2.1.1" xref="S3.SS3.1.p1.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.2.m2.1b"><ci id="S3.SS3.1.p1.2.m2.1.1.cmml" xref="S3.SS3.1.p1.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.2.m2.1c">i</annotation></semantics></math>, and the expectation <math id="S3.SS3.1.p1.3.m3.1" class="ltx_Math" alttext="\mathbb{E}[\nabla^{s}_{\theta}\mathcal{L}]" display="inline"><semantics id="S3.SS3.1.p1.3.m3.1a"><mrow id="S3.SS3.1.p1.3.m3.1.1" xref="S3.SS3.1.p1.3.m3.1.1.cmml"><mi id="S3.SS3.1.p1.3.m3.1.1.3" xref="S3.SS3.1.p1.3.m3.1.1.3.cmml">𝔼</mi><mo lspace="0em" rspace="0em" id="S3.SS3.1.p1.3.m3.1.1.2" xref="S3.SS3.1.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S3.SS3.1.p1.3.m3.1.1.1.1" xref="S3.SS3.1.p1.3.m3.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.1.p1.3.m3.1.1.1.1.2" xref="S3.SS3.1.p1.3.m3.1.1.1.2.1.cmml">[</mo><mrow id="S3.SS3.1.p1.3.m3.1.1.1.1.1" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.cmml"><msubsup id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.cmml"><mo rspace="0.167em" id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.2.2" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.2.2.cmml">∇</mo><mi id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.3" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.3.cmml">θ</mi><mi id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.2.3" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.2.3.cmml">s</mi></msubsup><mi class="ltx_font_mathcaligraphic" id="S3.SS3.1.p1.3.m3.1.1.1.1.1.2" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.2.cmml">ℒ</mi></mrow><mo stretchy="false" id="S3.SS3.1.p1.3.m3.1.1.1.1.3" xref="S3.SS3.1.p1.3.m3.1.1.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.3.m3.1b"><apply id="S3.SS3.1.p1.3.m3.1.1.cmml" xref="S3.SS3.1.p1.3.m3.1.1"><times id="S3.SS3.1.p1.3.m3.1.1.2.cmml" xref="S3.SS3.1.p1.3.m3.1.1.2"></times><ci id="S3.SS3.1.p1.3.m3.1.1.3.cmml" xref="S3.SS3.1.p1.3.m3.1.1.3">𝔼</ci><apply id="S3.SS3.1.p1.3.m3.1.1.1.2.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.1.p1.3.m3.1.1.1.2.1.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.1.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1"><apply id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.2.2">∇</ci><ci id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.1.3">𝜃</ci></apply><ci id="S3.SS3.1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS3.1.p1.3.m3.1.1.1.1.1.2">ℒ</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.3.m3.1c">\mathbb{E}[\nabla^{s}_{\theta}\mathcal{L}]</annotation></semantics></math>, the indicator function <math id="S3.SS3.1.p1.4.m4.1" class="ltx_Math" alttext="{\bf 1}(i\in\mathcal{I}_{t})" display="inline"><semantics id="S3.SS3.1.p1.4.m4.1a"><mrow id="S3.SS3.1.p1.4.m4.1.1" xref="S3.SS3.1.p1.4.m4.1.1.cmml"><mn id="S3.SS3.1.p1.4.m4.1.1.3" xref="S3.SS3.1.p1.4.m4.1.1.3.cmml">𝟏</mn><mo lspace="0em" rspace="0em" id="S3.SS3.1.p1.4.m4.1.1.2" xref="S3.SS3.1.p1.4.m4.1.1.2.cmml">​</mo><mrow id="S3.SS3.1.p1.4.m4.1.1.1.1" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.1.p1.4.m4.1.1.1.1.2" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.1.p1.4.m4.1.1.1.1.1" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS3.1.p1.4.m4.1.1.1.1.1.2" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.2.cmml">i</mi><mo id="S3.SS3.1.p1.4.m4.1.1.1.1.1.1" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.1.cmml">∈</mo><msub id="S3.SS3.1.p1.4.m4.1.1.1.1.1.3" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.2" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.2.cmml">ℐ</mi><mi id="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.3" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS3.1.p1.4.m4.1.1.1.1.3" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.4.m4.1b"><apply id="S3.SS3.1.p1.4.m4.1.1.cmml" xref="S3.SS3.1.p1.4.m4.1.1"><times id="S3.SS3.1.p1.4.m4.1.1.2.cmml" xref="S3.SS3.1.p1.4.m4.1.1.2"></times><cn type="integer" id="S3.SS3.1.p1.4.m4.1.1.3.cmml" xref="S3.SS3.1.p1.4.m4.1.1.3">1</cn><apply id="S3.SS3.1.p1.4.m4.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.4.m4.1.1.1.1"><in id="S3.SS3.1.p1.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.1"></in><ci id="S3.SS3.1.p1.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.2">𝑖</ci><apply id="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.2">ℐ</ci><ci id="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS3.1.p1.4.m4.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.4.m4.1c">{\bf 1}(i\in\mathcal{I}_{t})</annotation></semantics></math> is replaced by its expected value <math id="S3.SS3.1.p1.5.m5.1" class="ltx_Math" alttext="\text{Pr}(i\in\mathcal{I}_{t})=\frac{r}{I}" display="inline"><semantics id="S3.SS3.1.p1.5.m5.1a"><mrow id="S3.SS3.1.p1.5.m5.1.1" xref="S3.SS3.1.p1.5.m5.1.1.cmml"><mrow id="S3.SS3.1.p1.5.m5.1.1.1" xref="S3.SS3.1.p1.5.m5.1.1.1.cmml"><mtext id="S3.SS3.1.p1.5.m5.1.1.1.3" xref="S3.SS3.1.p1.5.m5.1.1.1.3a.cmml">Pr</mtext><mo lspace="0em" rspace="0em" id="S3.SS3.1.p1.5.m5.1.1.1.2" xref="S3.SS3.1.p1.5.m5.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.1.p1.5.m5.1.1.1.1.1" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.1.p1.5.m5.1.1.1.1.1.2" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.2" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.2.cmml">i</mi><mo id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.1" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.1.cmml">∈</mo><msub id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.2" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.2.cmml">ℐ</mi><mi id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.3" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS3.1.p1.5.m5.1.1.1.1.1.3" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.1.p1.5.m5.1.1.2" xref="S3.SS3.1.p1.5.m5.1.1.2.cmml">=</mo><mfrac id="S3.SS3.1.p1.5.m5.1.1.3" xref="S3.SS3.1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS3.1.p1.5.m5.1.1.3.2" xref="S3.SS3.1.p1.5.m5.1.1.3.2.cmml">r</mi><mi id="S3.SS3.1.p1.5.m5.1.1.3.3" xref="S3.SS3.1.p1.5.m5.1.1.3.3.cmml">I</mi></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.1.p1.5.m5.1b"><apply id="S3.SS3.1.p1.5.m5.1.1.cmml" xref="S3.SS3.1.p1.5.m5.1.1"><eq id="S3.SS3.1.p1.5.m5.1.1.2.cmml" xref="S3.SS3.1.p1.5.m5.1.1.2"></eq><apply id="S3.SS3.1.p1.5.m5.1.1.1.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1"><times id="S3.SS3.1.p1.5.m5.1.1.1.2.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1.2"></times><ci id="S3.SS3.1.p1.5.m5.1.1.1.3a.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1.3"><mtext id="S3.SS3.1.p1.5.m5.1.1.1.3.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1.3">Pr</mtext></ci><apply id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1"><in id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.1"></in><ci id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.2">𝑖</ci><apply id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.2">ℐ</ci><ci id="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.1.p1.5.m5.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></apply><apply id="S3.SS3.1.p1.5.m5.1.1.3.cmml" xref="S3.SS3.1.p1.5.m5.1.1.3"><divide id="S3.SS3.1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS3.1.p1.5.m5.1.1.3"></divide><ci id="S3.SS3.1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS3.1.p1.5.m5.1.1.3.2">𝑟</ci><ci id="S3.SS3.1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS3.1.p1.5.m5.1.1.3.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.1.p1.5.m5.1c">\text{Pr}(i\in\mathcal{I}_{t})=\frac{r}{I}</annotation></semantics></math> (this value is the same for cases i and ii), which gives the exact gradient.
∎</p>
</div>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.7" class="ltx_p">As a consequence of Proposition <a href="#Thmprop1" title="Proposition 1. ‣ 3.3 Exact Stochastic Gradient Descent Optimization ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, when the number of client updates is <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="\tau=1" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">τ</mi><mo id="S3.SS3.p2.1.m1.1.1.1" xref="S3.SS3.p2.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><eq id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1.1"></eq><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝜏</ci><cn type="integer" id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\tau=1</annotation></semantics></math>, Algorithm <a href="#alg1" title="Algorithm 1 ‣ Server side. ‣ 3.2.2 Client and Server Updates ‣ 3.2 The Proposed Algorithm ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> is precisely an SGD algorithm with the standard convergence guarantees, as long as <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\sum_{t=1}^{\infty}\rho_{t}=\infty" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mrow id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml"><msubsup id="S3.SS3.p2.2.m2.1.1.2.1" xref="S3.SS3.p2.2.m2.1.1.2.1.cmml"><mo id="S3.SS3.p2.2.m2.1.1.2.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.SS3.p2.2.m2.1.1.2.1.2.3" xref="S3.SS3.p2.2.m2.1.1.2.1.2.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.1.2.3.2" xref="S3.SS3.p2.2.m2.1.1.2.1.2.3.2.cmml">t</mi><mo id="S3.SS3.p2.2.m2.1.1.2.1.2.3.1" xref="S3.SS3.p2.2.m2.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.SS3.p2.2.m2.1.1.2.1.2.3.3" xref="S3.SS3.p2.2.m2.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi mathvariant="normal" id="S3.SS3.p2.2.m2.1.1.2.1.3" xref="S3.SS3.p2.2.m2.1.1.2.1.3.cmml">∞</mi></msubsup><msub id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml"><mi id="S3.SS3.p2.2.m2.1.1.2.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.2.cmml">ρ</mi><mi id="S3.SS3.p2.2.m2.1.1.2.2.3" xref="S3.SS3.p2.2.m2.1.1.2.2.3.cmml">t</mi></msub></mrow><mo id="S3.SS3.p2.2.m2.1.1.1" xref="S3.SS3.p2.2.m2.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><eq id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.1"></eq><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2"><apply id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1">superscript</csymbol><apply id="S3.SS3.p2.2.m2.1.1.2.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1">subscript</csymbol><sum id="S3.SS3.p2.2.m2.1.1.2.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1.2.2"></sum><apply id="S3.SS3.p2.2.m2.1.1.2.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1.2.3"><eq id="S3.SS3.p2.2.m2.1.1.2.1.2.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1.2.3.1"></eq><ci id="S3.SS3.p2.2.m2.1.1.2.1.2.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.2.m2.1.1.2.1.2.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1.2.3.3">1</cn></apply></apply><infinity id="S3.SS3.p2.2.m2.1.1.2.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1.3"></infinity></apply><apply id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.2.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2.2">𝜌</ci><ci id="S3.SS3.p2.2.m2.1.1.2.2.3.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2.3">𝑡</ci></apply></apply><infinity id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\sum_{t=1}^{\infty}\rho_{t}=\infty</annotation></semantics></math> and <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="\sum_{t=1}^{\infty}\rho_{t}^{2}&lt;\infty" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><mrow id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mrow id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml"><msubsup id="S3.SS3.p2.3.m3.1.1.2.1" xref="S3.SS3.p2.3.m3.1.1.2.1.cmml"><mo id="S3.SS3.p2.3.m3.1.1.2.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.1.2.2.cmml">∑</mo><mrow id="S3.SS3.p2.3.m3.1.1.2.1.2.3" xref="S3.SS3.p2.3.m3.1.1.2.1.2.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.1.2.3.2" xref="S3.SS3.p2.3.m3.1.1.2.1.2.3.2.cmml">t</mi><mo id="S3.SS3.p2.3.m3.1.1.2.1.2.3.1" xref="S3.SS3.p2.3.m3.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.SS3.p2.3.m3.1.1.2.1.2.3.3" xref="S3.SS3.p2.3.m3.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi mathvariant="normal" id="S3.SS3.p2.3.m3.1.1.2.1.3" xref="S3.SS3.p2.3.m3.1.1.2.1.3.cmml">∞</mi></msubsup><msubsup id="S3.SS3.p2.3.m3.1.1.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2.2.2.2" xref="S3.SS3.p2.3.m3.1.1.2.2.2.2.cmml">ρ</mi><mi id="S3.SS3.p2.3.m3.1.1.2.2.2.3" xref="S3.SS3.p2.3.m3.1.1.2.2.2.3.cmml">t</mi><mn id="S3.SS3.p2.3.m3.1.1.2.2.3" xref="S3.SS3.p2.3.m3.1.1.2.2.3.cmml">2</mn></msubsup></mrow><mo id="S3.SS3.p2.3.m3.1.1.1" xref="S3.SS3.p2.3.m3.1.1.1.cmml">&lt;</mo><mi mathvariant="normal" id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><lt id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.1"></lt><apply id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2"><apply id="S3.SS3.p2.3.m3.1.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1">superscript</csymbol><apply id="S3.SS3.p2.3.m3.1.1.2.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.1.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1">subscript</csymbol><sum id="S3.SS3.p2.3.m3.1.1.2.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1.2.2"></sum><apply id="S3.SS3.p2.3.m3.1.1.2.1.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1.2.3"><eq id="S3.SS3.p2.3.m3.1.1.2.1.2.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1.2.3.1"></eq><ci id="S3.SS3.p2.3.m3.1.1.2.1.2.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1.2.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.3.m3.1.1.2.1.2.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1.2.3.3">1</cn></apply></apply><infinity id="S3.SS3.p2.3.m3.1.1.2.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.1.3"></infinity></apply><apply id="S3.SS3.p2.3.m3.1.1.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">superscript</csymbol><apply id="S3.SS3.p2.3.m3.1.1.2.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.2.2.2.1.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.2.2.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2.2.2">𝜌</ci><ci id="S3.SS3.p2.3.m3.1.1.2.2.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2.2.3">𝑡</ci></apply><cn type="integer" id="S3.SS3.p2.3.m3.1.1.2.2.3.cmml" xref="S3.SS3.p2.3.m3.1.1.2.2.3">2</cn></apply></apply><infinity id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">\sum_{t=1}^{\infty}\rho_{t}^{2}&lt;\infty</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(Robbins &amp; Monro, <a href="#bib.bib25" title="" class="ltx_ref">1951</a>; Bottou, <a href="#bib.bib2" title="" class="ltx_ref">2010</a>)</cite>. When the selected clients at each round perform more than one gradient steps, i.e. <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="\tau&gt;1" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mrow id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">τ</mi><mo id="S3.SS3.p2.4.m4.1.1.1" xref="S3.SS3.p2.4.m4.1.1.1.cmml">&gt;</mo><mn id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><gt id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1.1"></gt><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝜏</ci><cn type="integer" id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">\tau&gt;1</annotation></semantics></math>, convergence can speed up since the first <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="\tau-1" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mrow id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">τ</mi><mo id="S3.SS3.p2.5.m5.1.1.1" xref="S3.SS3.p2.5.m5.1.1.1.cmml">−</mo><mn id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><minus id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1.1"></minus><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝜏</ci><cn type="integer" id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">\tau-1</annotation></semantics></math> GD steps in these clients can result in a systematic/deterministic improvement of the global loss in (<a href="#S3.E1" title="Equation 1 ‣ 3.1.1 Training Objective for Classification ‣ 3.1 Personalized FL Setting ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), i.e. <math id="S3.SS3.p2.6.m6.2" class="ltx_Math" alttext="\mathcal{L}(\psi^{\text{after}\ \tau-1\ \text{steps}})\leq\mathcal{L}(\psi^{\text{init}})" display="inline"><semantics id="S3.SS3.p2.6.m6.2a"><mrow id="S3.SS3.p2.6.m6.2.2" xref="S3.SS3.p2.6.m6.2.2.cmml"><mrow id="S3.SS3.p2.6.m6.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.6.m6.1.1.1.3" xref="S3.SS3.p2.6.m6.1.1.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.1.1.1.2" xref="S3.SS3.p2.6.m6.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.1.1.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.1.1.1.1.1.2" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.cmml">(</mo><msup id="S3.SS3.p2.6.m6.1.1.1.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.1.1.1.1.2" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.2.cmml">ψ</mi><mrow id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.cmml"><mrow id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.cmml"><mtext id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.2" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.2a.cmml">after</mtext><mo lspace="0.350em" rspace="0em" id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.1" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.3" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.3.cmml">τ</mi></mrow><mo id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.1" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.1.cmml">−</mo><mrow id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.cmml"><mn id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.2" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.350em" rspace="0em" id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.1" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.1.cmml">​</mo><mtext id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.3" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.3a.cmml">steps</mtext></mrow></mrow></msup><mo stretchy="false" id="S3.SS3.p2.6.m6.1.1.1.1.1.3" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p2.6.m6.2.2.3" xref="S3.SS3.p2.6.m6.2.2.3.cmml">≤</mo><mrow id="S3.SS3.p2.6.m6.2.2.2" xref="S3.SS3.p2.6.m6.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.6.m6.2.2.2.3" xref="S3.SS3.p2.6.m6.2.2.2.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.6.m6.2.2.2.2" xref="S3.SS3.p2.6.m6.2.2.2.2.cmml">​</mo><mrow id="S3.SS3.p2.6.m6.2.2.2.1.1" xref="S3.SS3.p2.6.m6.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p2.6.m6.2.2.2.1.1.2" xref="S3.SS3.p2.6.m6.2.2.2.1.1.1.cmml">(</mo><msup id="S3.SS3.p2.6.m6.2.2.2.1.1.1" xref="S3.SS3.p2.6.m6.2.2.2.1.1.1.cmml"><mi id="S3.SS3.p2.6.m6.2.2.2.1.1.1.2" xref="S3.SS3.p2.6.m6.2.2.2.1.1.1.2.cmml">ψ</mi><mtext id="S3.SS3.p2.6.m6.2.2.2.1.1.1.3" xref="S3.SS3.p2.6.m6.2.2.2.1.1.1.3a.cmml">init</mtext></msup><mo stretchy="false" id="S3.SS3.p2.6.m6.2.2.2.1.1.3" xref="S3.SS3.p2.6.m6.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.2b"><apply id="S3.SS3.p2.6.m6.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2"><leq id="S3.SS3.p2.6.m6.2.2.3.cmml" xref="S3.SS3.p2.6.m6.2.2.3"></leq><apply id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1"><times id="S3.SS3.p2.6.m6.1.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.1.2"></times><ci id="S3.SS3.p2.6.m6.1.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.1.3">ℒ</ci><apply id="S3.SS3.p2.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.6.m6.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.2">𝜓</ci><apply id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3"><minus id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.1"></minus><apply id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2"><times id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.1"></times><ci id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.2a.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.2"><mtext mathsize="70%" id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.2.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.2">after</mtext></ci><ci id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.3.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.2.3">𝜏</ci></apply><apply id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3"><times id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.1"></times><cn type="integer" id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.2">1</cn><ci id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.3a.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.3"><mtext mathsize="70%" id="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS3.p2.6.m6.1.1.1.1.1.1.3.3.3">steps</mtext></ci></apply></apply></apply></apply><apply id="S3.SS3.p2.6.m6.2.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2.2"><times id="S3.SS3.p2.6.m6.2.2.2.2.cmml" xref="S3.SS3.p2.6.m6.2.2.2.2"></times><ci id="S3.SS3.p2.6.m6.2.2.2.3.cmml" xref="S3.SS3.p2.6.m6.2.2.2.3">ℒ</ci><apply id="S3.SS3.p2.6.m6.2.2.2.1.1.1.cmml" xref="S3.SS3.p2.6.m6.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.6.m6.2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.6.m6.2.2.2.1.1">superscript</csymbol><ci id="S3.SS3.p2.6.m6.2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.6.m6.2.2.2.1.1.1.2">𝜓</ci><ci id="S3.SS3.p2.6.m6.2.2.2.1.1.1.3a.cmml" xref="S3.SS3.p2.6.m6.2.2.2.1.1.1.3"><mtext mathsize="70%" id="S3.SS3.p2.6.m6.2.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.6.m6.2.2.2.1.1.1.3">init</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.2c">\mathcal{L}(\psi^{\text{after}\ \tau-1\ \text{steps}})\leq\mathcal{L}(\psi^{\text{init}})</annotation></semantics></math>. Indeed, in practice we observe that convergence gets faster as <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><mi id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><ci id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">\tau</annotation></semantics></math> increases.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Computational Complexity</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.8" class="ltx_p">Since during the first <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="\tau-1" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mrow id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">τ</mi><mo id="S3.SS4.p1.1.m1.1.1.1" xref="S3.SS4.p1.1.m1.1.1.1.cmml">−</mo><mn id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><minus id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1.1"></minus><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">𝜏</ci><cn type="integer" id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\tau-1</annotation></semantics></math> client updates the global parameters <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mi id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">\theta</annotation></semantics></math> are fixed we can pass the data from the NN only twice for any value of <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><mi id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><ci id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\tau</annotation></semantics></math>. At the beginning of each round we pass once the data from the NN, store all feature vectors and then carry out <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="\tau-1" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><mrow id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">τ</mi><mo id="S3.SS4.p1.4.m4.1.1.1" xref="S3.SS4.p1.4.m4.1.1.1.cmml">−</mo><mn id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><minus id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1.1"></minus><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">𝜏</ci><cn type="integer" id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\tau-1</annotation></semantics></math> GD steps to update only the client-specific parameters. For the final <math id="S3.SS4.p1.5.m5.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S3.SS4.p1.5.m5.1a"><mi id="S3.SS4.p1.5.m5.1.1" xref="S3.SS4.p1.5.m5.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.1b"><ci id="S3.SS4.p1.5.m5.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.1c">\tau</annotation></semantics></math> iteration we need to pass the data a second time from the NN to compute the joint gradient. This is a great computatiotal advantage of PFLEGO versus FedAvg and FedPer, since PFLEGO roughly runs <math id="S3.SS4.p1.6.m6.1" class="ltx_Math" alttext="\frac{\tau}{2}" display="inline"><semantics id="S3.SS4.p1.6.m6.1a"><mfrac id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml"><mi id="S3.SS4.p1.6.m6.1.1.2" xref="S3.SS4.p1.6.m6.1.1.2.cmml">τ</mi><mn id="S3.SS4.p1.6.m6.1.1.3" xref="S3.SS4.p1.6.m6.1.1.3.cmml">2</mn></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><apply id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1"><divide id="S3.SS4.p1.6.m6.1.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1"></divide><ci id="S3.SS4.p1.6.m6.1.1.2.cmml" xref="S3.SS4.p1.6.m6.1.1.2">𝜏</ci><cn type="integer" id="S3.SS4.p1.6.m6.1.1.3.cmml" xref="S3.SS4.p1.6.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">\frac{\tau}{2}</annotation></semantics></math> times faster. Concretely, given that the complexity per round is dominated by the NN evaluations, then PFLEGO is <math id="S3.SS4.p1.7.m7.1" class="ltx_Math" alttext="O(1)" display="inline"><semantics id="S3.SS4.p1.7.m7.1a"><mrow id="S3.SS4.p1.7.m7.1.2" xref="S3.SS4.p1.7.m7.1.2.cmml"><mi id="S3.SS4.p1.7.m7.1.2.2" xref="S3.SS4.p1.7.m7.1.2.2.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.7.m7.1.2.1" xref="S3.SS4.p1.7.m7.1.2.1.cmml">​</mo><mrow id="S3.SS4.p1.7.m7.1.2.3.2" xref="S3.SS4.p1.7.m7.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.7.m7.1.2.3.2.1" xref="S3.SS4.p1.7.m7.1.2.cmml">(</mo><mn id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml">1</mn><mo stretchy="false" id="S3.SS4.p1.7.m7.1.2.3.2.2" xref="S3.SS4.p1.7.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.2.cmml" xref="S3.SS4.p1.7.m7.1.2"><times id="S3.SS4.p1.7.m7.1.2.1.cmml" xref="S3.SS4.p1.7.m7.1.2.1"></times><ci id="S3.SS4.p1.7.m7.1.2.2.cmml" xref="S3.SS4.p1.7.m7.1.2.2">𝑂</ci><cn type="integer" id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">O(1)</annotation></semantics></math> while others are <math id="S3.SS4.p1.8.m8.1" class="ltx_Math" alttext="O(\tau)" display="inline"><semantics id="S3.SS4.p1.8.m8.1a"><mrow id="S3.SS4.p1.8.m8.1.2" xref="S3.SS4.p1.8.m8.1.2.cmml"><mi id="S3.SS4.p1.8.m8.1.2.2" xref="S3.SS4.p1.8.m8.1.2.2.cmml">O</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m8.1.2.1" xref="S3.SS4.p1.8.m8.1.2.1.cmml">​</mo><mrow id="S3.SS4.p1.8.m8.1.2.3.2" xref="S3.SS4.p1.8.m8.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.8.m8.1.2.3.2.1" xref="S3.SS4.p1.8.m8.1.2.cmml">(</mo><mi id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml">τ</mi><mo stretchy="false" id="S3.SS4.p1.8.m8.1.2.3.2.2" xref="S3.SS4.p1.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.1b"><apply id="S3.SS4.p1.8.m8.1.2.cmml" xref="S3.SS4.p1.8.m8.1.2"><times id="S3.SS4.p1.8.m8.1.2.1.cmml" xref="S3.SS4.p1.8.m8.1.2.1"></times><ci id="S3.SS4.p1.8.m8.1.2.2.cmml" xref="S3.SS4.p1.8.m8.1.2.2">𝑂</ci><ci id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">𝜏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.1c">O(\tau)</annotation></semantics></math>, consequently the clients consume much less energy per round.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">To validate the performance benefits of our proposed PFLEGO algorithm, we compare it against FedPer <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite> and FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib21" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Datasets and Model Architectures</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">We experiment with the Omniglot, CIFAR-10, MNIST, Fashion-MNIST and EMNIST datasets and corresponding model architectures, detailed below.</p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Datasets description</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p"><span id="S4.SS1.SSS1.p1.1.1" class="ltx_text ltx_font_bold">Omniglot.</span> This dataset was introduced by
<cite class="ltx_cite ltx_citemacro_citep">(Lake et al., <a href="#bib.bib14" title="" class="ltx_ref">2015</a>)</cite> and consists of 1623 105x105 handwritten characters from 50 different alphabets and 20 samples per handwritten character. Omniglot can be a natural choice for personalized learning due to its small number of samples per character and large number of different handwritten characters per alphabet.
Each alphabet can be considered as a classification problem with a certain number of classes, e.g. the English alphabet has <math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="24" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mn id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml">24</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><cn type="integer" id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1">24</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">24</annotation></semantics></math> classes. We use 4 convolutional layers, each layer is followed by one max pooling layer, the architecture we use is the same as the one from <cite class="ltx_cite ltx_citemacro_citep">(Finn et al., <a href="#bib.bib8" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.1" class="ltx_p"><span id="S4.SS1.SSS1.p2.1.1" class="ltx_text ltx_font_bold">CIFAR-10.</span> It consists of <math id="S4.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="32x32" display="inline"><semantics id="S4.SS1.SSS1.p2.1.m1.1a"><mrow id="S4.SS1.SSS1.p2.1.m1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.cmml"><mn id="S4.SS1.SSS1.p2.1.m1.1.1.2" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.cmml">32</mn><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.3" xref="S4.SS1.SSS1.p2.1.m1.1.1.3.cmml">x</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.1a" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.cmml">​</mo><mn id="S4.SS1.SSS1.p2.1.m1.1.1.4" xref="S4.SS1.SSS1.p2.1.m1.1.1.4.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.1.m1.1b"><apply id="S4.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1"><times id="S4.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.1"></times><cn type="integer" id="S4.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2">32</cn><ci id="S4.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.3">𝑥</ci><cn type="integer" id="S4.SS1.SSS1.p2.1.m1.1.1.4.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.4">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.1.m1.1c">32x32</annotation></semantics></math> RGB images of 10 different classes of visual categories <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky, <a href="#bib.bib13" title="" class="ltx_ref">2009</a>)</cite>.
We use the same architecture as in <cite class="ltx_cite ltx_citemacro_citep">(Yao et al., <a href="#bib.bib34" title="" class="ltx_ref">2020</a>)</cite>.
It includes two convolutional layers of 64 filters each, and a kernel of size 5. Each layer is followed by a max pooling layer of size 3x3 with stride 2. The output of convolutional layers passes through two additional fully connected layers of size 384 and 192. The activation function for the convolutional and fully connected layers is ReLU.</p>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para">
<p id="S4.SS1.SSS1.p3.1" class="ltx_p"><span id="S4.SS1.SSS1.p3.1.1" class="ltx_text ltx_font_bold">MNIST.</span> It consists of <math id="S4.SS1.SSS1.p3.1.m1.1" class="ltx_Math" alttext="28\times 28" display="inline"><semantics id="S4.SS1.SSS1.p3.1.m1.1a"><mrow id="S4.SS1.SSS1.p3.1.m1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.cmml"><mn id="S4.SS1.SSS1.p3.1.m1.1.1.2" xref="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p3.1.m1.1.1.1" xref="S4.SS1.SSS1.p3.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.SSS1.p3.1.m1.1.1.3" xref="S4.SS1.SSS1.p3.1.m1.1.1.3.cmml">28</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p3.1.m1.1b"><apply id="S4.SS1.SSS1.p3.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1"><times id="S4.SS1.SSS1.p3.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.1"></times><cn type="integer" id="S4.SS1.SSS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.2">28</cn><cn type="integer" id="S4.SS1.SSS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p3.1.m1.1.1.3">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p3.1.m1.1c">28\times 28</annotation></semantics></math> handwritten grayscale images of single digits from classes 0 to 9. For MNIST, we use an MLP architecture that consists of one fully connected layer of 200 units with a ReLU activation function.</p>
</div>
<div id="S4.SS1.SSS1.p4" class="ltx_para">
<p id="S4.SS1.SSS1.p4.1" class="ltx_p"><span id="S4.SS1.SSS1.p4.1.1" class="ltx_text ltx_font_bold">Fashion-MNIST.</span> It is similar to MNIST but more challenging and consists of <math id="S4.SS1.SSS1.p4.1.m1.1" class="ltx_Math" alttext="28\times 28" display="inline"><semantics id="S4.SS1.SSS1.p4.1.m1.1a"><mrow id="S4.SS1.SSS1.p4.1.m1.1.1" xref="S4.SS1.SSS1.p4.1.m1.1.1.cmml"><mn id="S4.SS1.SSS1.p4.1.m1.1.1.2" xref="S4.SS1.SSS1.p4.1.m1.1.1.2.cmml">28</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS1.SSS1.p4.1.m1.1.1.1" xref="S4.SS1.SSS1.p4.1.m1.1.1.1.cmml">×</mo><mn id="S4.SS1.SSS1.p4.1.m1.1.1.3" xref="S4.SS1.SSS1.p4.1.m1.1.1.3.cmml">28</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p4.1.m1.1b"><apply id="S4.SS1.SSS1.p4.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p4.1.m1.1.1"><times id="S4.SS1.SSS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p4.1.m1.1.1.1"></times><cn type="integer" id="S4.SS1.SSS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p4.1.m1.1.1.2">28</cn><cn type="integer" id="S4.SS1.SSS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p4.1.m1.1.1.3">28</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p4.1.m1.1c">28\times 28</annotation></semantics></math> grayscale images of 10 different classes of clothing. We use the same MLP architecture as the one in MNIST.</p>
</div>
<div id="S4.SS1.SSS1.p5" class="ltx_para">
<p id="S4.SS1.SSS1.p5.1" class="ltx_p"><span id="S4.SS1.SSS1.p5.1.1" class="ltx_text ltx_font_bold">EMNIST.</span> It extends the MNIST dataset with grayscale handwritten digits. In total there are <math id="S4.SS1.SSS1.p5.1.m1.1" class="ltx_Math" alttext="62" display="inline"><semantics id="S4.SS1.SSS1.p5.1.m1.1a"><mn id="S4.SS1.SSS1.p5.1.m1.1.1" xref="S4.SS1.SSS1.p5.1.m1.1.1.cmml">62</mn><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p5.1.m1.1b"><cn type="integer" id="S4.SS1.SSS1.p5.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p5.1.m1.1.1">62</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p5.1.m1.1c">62</annotation></semantics></math> different classes of handwritten letters and digits. We use the same MLP architecture as the one in MNIST.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Test accuracy for MNIST, CIFAR-10, EMNIST and Fashion-MNIST datasets on different degrees of personalization.</figcaption>
<br class="ltx_break">
<table id="S4.T1.36.36" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.36.36.37.1" class="ltx_tr">
<td id="S4.T1.36.36.37.1.1" class="ltx_td ltx_border_tt"></td>
<th id="S4.T1.36.36.37.1.2" class="ltx_td ltx_th ltx_th_column ltx_border_tt"></th>
<th id="S4.T1.36.36.37.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3"><span id="S4.T1.36.36.37.1.3.1" class="ltx_text" style="font-size:90%;">MNIST</span></th>
<th id="S4.T1.36.36.37.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3"><span id="S4.T1.36.36.37.1.4.1" class="ltx_text" style="font-size:90%;">CIFAR-10</span></th>
</tr>
<tr id="S4.T1.36.36.38.2" class="ltx_tr">
<th id="S4.T1.36.36.38.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.38.2.1.1" class="ltx_text" style="font-size:90%;">Method / Deg of Pers.</span></th>
<th id="S4.T1.36.36.38.2.2" class="ltx_td ltx_th ltx_th_column ltx_border_t"></th>
<th id="S4.T1.36.36.38.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.38.2.3.1" class="ltx_text" style="font-size:90%;">High-Pers</span></th>
<th id="S4.T1.36.36.38.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.38.2.4.1" class="ltx_text" style="font-size:90%;">Medium-Pers</span></th>
<th id="S4.T1.36.36.38.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.38.2.5.1" class="ltx_text" style="font-size:90%;">No-Pers</span></th>
<th id="S4.T1.36.36.38.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.38.2.6.1" class="ltx_text" style="font-size:90%;">High-Pers</span></th>
<th id="S4.T1.36.36.38.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.38.2.7.1" class="ltx_text" style="font-size:90%;">Medium-Pers</span></th>
<th id="S4.T1.36.36.38.2.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.38.2.8.1" class="ltx_text" style="font-size:90%;">No-Pers</span></th>
</tr>
<tr id="S4.T1.6.6.6" class="ltx_tr">
<td id="S4.T1.6.6.6.7" class="ltx_td ltx_align_left"><span id="S4.T1.6.6.6.7.1" class="ltx_text" style="font-size:90%;">FedPer</span></td>
<td id="S4.T1.6.6.6.8" class="ltx_td"></td>
<td id="S4.T1.1.1.1.1" class="ltx_td ltx_align_left">
<span id="S4.T1.1.1.1.1.1" class="ltx_text" style="font-size:90%;">97.88 </span><math id="S4.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.1.1.1.1.m1.1a"><mo mathsize="90%" id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.1.1.1.1.2" class="ltx_text" style="font-size:90%;"> 0.25</span>
</td>
<td id="S4.T1.2.2.2.2" class="ltx_td ltx_align_left">
<span id="S4.T1.2.2.2.2.1" class="ltx_text" style="font-size:90%;">92.83 </span><math id="S4.T1.2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.2.2.2.2.m1.1a"><mo mathsize="90%" id="S4.T1.2.2.2.2.m1.1.1" xref="S4.T1.2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m1.1b"><csymbol cd="latexml" id="S4.T1.2.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.2.2.2.2.2" class="ltx_text" style="font-size:90%;"> 0.46</span>
</td>
<td id="S4.T1.3.3.3.3" class="ltx_td ltx_align_left">
<span id="S4.T1.3.3.3.3.1" class="ltx_text" style="font-size:90%;">87.23 </span><math id="S4.T1.3.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.3.3.3.3.m1.1a"><mo mathsize="90%" id="S4.T1.3.3.3.3.m1.1.1" xref="S4.T1.3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.m1.1b"><csymbol cd="latexml" id="S4.T1.3.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.3.3.3.3.2" class="ltx_text" style="font-size:90%;"> 0.33</span>
</td>
<td id="S4.T1.4.4.4.4" class="ltx_td ltx_align_left">
<span id="S4.T1.4.4.4.4.1" class="ltx_text" style="font-size:90%;">85.15 </span><math id="S4.T1.4.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.4.4.4.4.m1.1a"><mo mathsize="90%" id="S4.T1.4.4.4.4.m1.1.1" xref="S4.T1.4.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.4.m1.1b"><csymbol cd="latexml" id="S4.T1.4.4.4.4.m1.1.1.cmml" xref="S4.T1.4.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.4.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.4.4.4.4.2" class="ltx_text" style="font-size:90%;"> 1.08</span>
</td>
<td id="S4.T1.5.5.5.5" class="ltx_td ltx_align_left">
<span id="S4.T1.5.5.5.5.1" class="ltx_text" style="font-size:90%;">61.01 </span><math id="S4.T1.5.5.5.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.5.5.5.5.m1.1a"><mo mathsize="90%" id="S4.T1.5.5.5.5.m1.1.1" xref="S4.T1.5.5.5.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.5.m1.1b"><csymbol cd="latexml" id="S4.T1.5.5.5.5.m1.1.1.cmml" xref="S4.T1.5.5.5.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.5.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.5.5.5.5.2" class="ltx_text" style="font-size:90%;"> 0.84</span>
</td>
<td id="S4.T1.6.6.6.6" class="ltx_td ltx_align_left">
<span id="S4.T1.6.6.6.6.1" class="ltx_text" style="font-size:90%;">37.88 </span><math id="S4.T1.6.6.6.6.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.6.6.6.6.m1.1a"><mo mathsize="90%" id="S4.T1.6.6.6.6.m1.1.1" xref="S4.T1.6.6.6.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.6.m1.1b"><csymbol cd="latexml" id="S4.T1.6.6.6.6.m1.1.1.cmml" xref="S4.T1.6.6.6.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.6.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.6.6.6.6.2" class="ltx_text" style="font-size:90%;"> 0.59</span>
</td>
</tr>
<tr id="S4.T1.12.12.12" class="ltx_tr">
<td id="S4.T1.12.12.12.7" class="ltx_td ltx_align_left"><span id="S4.T1.12.12.12.7.1" class="ltx_text" style="font-size:90%;">FedAvg</span></td>
<td id="S4.T1.12.12.12.8" class="ltx_td"></td>
<td id="S4.T1.7.7.7.1" class="ltx_td ltx_align_left">
<span id="S4.T1.7.7.7.1.1" class="ltx_text" style="font-size:90%;">97.54 </span><math id="S4.T1.7.7.7.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.7.7.7.1.m1.1a"><mo mathsize="90%" id="S4.T1.7.7.7.1.m1.1.1" xref="S4.T1.7.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.1.m1.1b"><csymbol cd="latexml" id="S4.T1.7.7.7.1.m1.1.1.cmml" xref="S4.T1.7.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.1.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.7.7.7.1.2" class="ltx_text" style="font-size:90%;"> 0.25</span>
</td>
<td id="S4.T1.8.8.8.2" class="ltx_td ltx_align_left">
<span id="S4.T1.8.8.8.2.1" class="ltx_text" style="font-size:90%;">92.83 </span><math id="S4.T1.8.8.8.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.8.8.8.2.m1.1a"><mo mathsize="90%" id="S4.T1.8.8.8.2.m1.1.1" xref="S4.T1.8.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.2.m1.1b"><csymbol cd="latexml" id="S4.T1.8.8.8.2.m1.1.1.cmml" xref="S4.T1.8.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.2.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.8.8.8.2.2" class="ltx_text" style="font-size:90%;"> 0.52</span>
</td>
<td id="S4.T1.9.9.9.3" class="ltx_td ltx_align_left"><span id="S4.T1.9.9.9.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">93.12 <math id="S4.T1.9.9.9.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.9.9.9.3.1.m1.1a"><mo id="S4.T1.9.9.9.3.1.m1.1.1" xref="S4.T1.9.9.9.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.9.3.1.m1.1b"><csymbol cd="latexml" id="S4.T1.9.9.9.3.1.m1.1.1.cmml" xref="S4.T1.9.9.9.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.9.3.1.m1.1c">\pm</annotation></semantics></math> 0.24</span></td>
<td id="S4.T1.10.10.10.4" class="ltx_td ltx_align_left">
<span id="S4.T1.10.10.10.4.1" class="ltx_text" style="font-size:90%;">85.18 </span><math id="S4.T1.10.10.10.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.10.10.10.4.m1.1a"><mo mathsize="90%" id="S4.T1.10.10.10.4.m1.1.1" xref="S4.T1.10.10.10.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.10.10.10.4.m1.1b"><csymbol cd="latexml" id="S4.T1.10.10.10.4.m1.1.1.cmml" xref="S4.T1.10.10.10.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.10.10.10.4.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.10.10.10.4.2" class="ltx_text" style="font-size:90%;"> 0.96</span>
</td>
<td id="S4.T1.11.11.11.5" class="ltx_td ltx_align_left">
<span id="S4.T1.11.11.11.5.1" class="ltx_text" style="font-size:90%;">64.53 </span><math id="S4.T1.11.11.11.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.11.11.11.5.m1.1a"><mo mathsize="90%" id="S4.T1.11.11.11.5.m1.1.1" xref="S4.T1.11.11.11.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.11.11.11.5.m1.1b"><csymbol cd="latexml" id="S4.T1.11.11.11.5.m1.1.1.cmml" xref="S4.T1.11.11.11.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.11.11.5.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.11.11.11.5.2" class="ltx_text" style="font-size:90%;"> 0.75</span>
</td>
<td id="S4.T1.12.12.12.6" class="ltx_td ltx_align_left"><span id="S4.T1.12.12.12.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">61.33 <math id="S4.T1.12.12.12.6.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.12.12.12.6.1.m1.1a"><mo id="S4.T1.12.12.12.6.1.m1.1.1" xref="S4.T1.12.12.12.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.12.12.12.6.1.m1.1b"><csymbol cd="latexml" id="S4.T1.12.12.12.6.1.m1.1.1.cmml" xref="S4.T1.12.12.12.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.12.12.6.1.m1.1c">\pm</annotation></semantics></math> 0.52</span></td>
</tr>
<tr id="S4.T1.18.18.18" class="ltx_tr">
<td id="S4.T1.18.18.18.7" class="ltx_td ltx_align_left"><span id="S4.T1.18.18.18.7.1" class="ltx_text" style="font-size:90%;">PFLEGO</span></td>
<td id="S4.T1.18.18.18.8" class="ltx_td"></td>
<td id="S4.T1.13.13.13.1" class="ltx_td ltx_align_left"><span id="S4.T1.13.13.13.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">98.43 <math id="S4.T1.13.13.13.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.13.13.13.1.1.m1.1a"><mo id="S4.T1.13.13.13.1.1.m1.1.1" xref="S4.T1.13.13.13.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.13.13.13.1.1.m1.1b"><csymbol cd="latexml" id="S4.T1.13.13.13.1.1.m1.1.1.cmml" xref="S4.T1.13.13.13.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.13.13.1.1.m1.1c">\pm</annotation></semantics></math> 0.21</span></td>
<td id="S4.T1.14.14.14.2" class="ltx_td ltx_align_left"><span id="S4.T1.14.14.14.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">94.22 <math id="S4.T1.14.14.14.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.14.14.14.2.1.m1.1a"><mo id="S4.T1.14.14.14.2.1.m1.1.1" xref="S4.T1.14.14.14.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.14.14.14.2.1.m1.1b"><csymbol cd="latexml" id="S4.T1.14.14.14.2.1.m1.1.1.cmml" xref="S4.T1.14.14.14.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.14.14.2.1.m1.1c">\pm</annotation></semantics></math> 0.43</span></td>
<td id="S4.T1.15.15.15.3" class="ltx_td ltx_align_left">
<span id="S4.T1.15.15.15.3.1" class="ltx_text" style="font-size:90%;">90.50 </span><math id="S4.T1.15.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.15.15.15.3.m1.1a"><mo mathsize="90%" id="S4.T1.15.15.15.3.m1.1.1" xref="S4.T1.15.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.15.15.15.3.m1.1b"><csymbol cd="latexml" id="S4.T1.15.15.15.3.m1.1.1.cmml" xref="S4.T1.15.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.15.15.15.3.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.15.15.15.3.2" class="ltx_text" style="font-size:90%;"> 0.34</span>
</td>
<td id="S4.T1.16.16.16.4" class="ltx_td ltx_align_left"><span id="S4.T1.16.16.16.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">87.81 <math id="S4.T1.16.16.16.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.16.16.16.4.1.m1.1a"><mo id="S4.T1.16.16.16.4.1.m1.1.1" xref="S4.T1.16.16.16.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.16.16.16.4.1.m1.1b"><csymbol cd="latexml" id="S4.T1.16.16.16.4.1.m1.1.1.cmml" xref="S4.T1.16.16.16.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.16.16.16.4.1.m1.1c">\pm</annotation></semantics></math> 0.94</span></td>
<td id="S4.T1.17.17.17.5" class="ltx_td ltx_align_left"><span id="S4.T1.17.17.17.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">73.23 <math id="S4.T1.17.17.17.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.17.17.17.5.1.m1.1a"><mo id="S4.T1.17.17.17.5.1.m1.1.1" xref="S4.T1.17.17.17.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.17.17.17.5.1.m1.1b"><csymbol cd="latexml" id="S4.T1.17.17.17.5.1.m1.1.1.cmml" xref="S4.T1.17.17.17.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.17.17.17.5.1.m1.1c">\pm</annotation></semantics></math> 0.62</span></td>
<td id="S4.T1.18.18.18.6" class="ltx_td ltx_align_left">
<span id="S4.T1.18.18.18.6.1" class="ltx_text" style="font-size:90%;">50.27 </span><math id="S4.T1.18.18.18.6.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.18.18.18.6.m1.1a"><mo mathsize="90%" id="S4.T1.18.18.18.6.m1.1.1" xref="S4.T1.18.18.18.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.18.18.18.6.m1.1b"><csymbol cd="latexml" id="S4.T1.18.18.18.6.m1.1.1.cmml" xref="S4.T1.18.18.18.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.18.18.18.6.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.18.18.18.6.2" class="ltx_text" style="font-size:90%;"> 0.4</span>
</td>
</tr>
<tr id="S4.T1.36.36.39.3" class="ltx_tr">
<td id="S4.T1.36.36.39.3.1" class="ltx_td ltx_border_t"></td>
<th id="S4.T1.36.36.39.3.2" class="ltx_td ltx_th ltx_th_column ltx_border_t"></th>
<th id="S4.T1.36.36.39.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3"><span id="S4.T1.36.36.39.3.3.1" class="ltx_text" style="font-size:90%;">EMNIST</span></th>
<th id="S4.T1.36.36.39.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" colspan="3"><span id="S4.T1.36.36.39.3.4.1" class="ltx_text" style="font-size:90%;">Fashion-MNIST</span></th>
</tr>
<tr id="S4.T1.36.36.40.4" class="ltx_tr">
<th id="S4.T1.36.36.40.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.40.4.1.1" class="ltx_text" style="font-size:90%;">Method / Deg of Pers.</span></th>
<th id="S4.T1.36.36.40.4.2" class="ltx_td ltx_th ltx_th_column ltx_border_t"></th>
<th id="S4.T1.36.36.40.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.40.4.3.1" class="ltx_text" style="font-size:90%;">High-Pers</span></th>
<th id="S4.T1.36.36.40.4.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.40.4.4.1" class="ltx_text" style="font-size:90%;">Medium-Pers</span></th>
<th id="S4.T1.36.36.40.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.40.4.5.1" class="ltx_text" style="font-size:90%;">No-Pers</span></th>
<th id="S4.T1.36.36.40.4.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.40.4.6.1" class="ltx_text" style="font-size:90%;">High-Pers</span></th>
<th id="S4.T1.36.36.40.4.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.40.4.7.1" class="ltx_text" style="font-size:90%;">Medium-Pers</span></th>
<th id="S4.T1.36.36.40.4.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.36.36.40.4.8.1" class="ltx_text" style="font-size:90%;">No-Pers</span></th>
</tr>
<tr id="S4.T1.24.24.24" class="ltx_tr">
<td id="S4.T1.24.24.24.7" class="ltx_td ltx_align_left"><span id="S4.T1.24.24.24.7.1" class="ltx_text" style="font-size:90%;">FedPer</span></td>
<td id="S4.T1.24.24.24.8" class="ltx_td"></td>
<td id="S4.T1.19.19.19.1" class="ltx_td ltx_align_left">
<span id="S4.T1.19.19.19.1.1" class="ltx_text" style="font-size:90%;">97.78 </span><math id="S4.T1.19.19.19.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.19.19.19.1.m1.1a"><mo mathsize="90%" id="S4.T1.19.19.19.1.m1.1.1" xref="S4.T1.19.19.19.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.19.19.19.1.m1.1b"><csymbol cd="latexml" id="S4.T1.19.19.19.1.m1.1.1.cmml" xref="S4.T1.19.19.19.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.19.19.19.1.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.19.19.19.1.2" class="ltx_text" style="font-size:90%;"> 0.51</span>
</td>
<td id="S4.T1.20.20.20.2" class="ltx_td ltx_align_left"><span id="S4.T1.20.20.20.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">64.75 <math id="S4.T1.20.20.20.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.20.20.20.2.1.m1.1a"><mo id="S4.T1.20.20.20.2.1.m1.1.1" xref="S4.T1.20.20.20.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.20.20.20.2.1.m1.1b"><csymbol cd="latexml" id="S4.T1.20.20.20.2.1.m1.1.1.cmml" xref="S4.T1.20.20.20.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.20.20.20.2.1.m1.1c">\pm</annotation></semantics></math> 0.39</span></td>
<td id="S4.T1.21.21.21.3" class="ltx_td ltx_align_left">
<span id="S4.T1.21.21.21.3.1" class="ltx_text" style="font-size:90%;">48.12 </span><math id="S4.T1.21.21.21.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.21.21.21.3.m1.1a"><mo mathsize="90%" id="S4.T1.21.21.21.3.m1.1.1" xref="S4.T1.21.21.21.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.21.21.21.3.m1.1b"><csymbol cd="latexml" id="S4.T1.21.21.21.3.m1.1.1.cmml" xref="S4.T1.21.21.21.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.21.21.21.3.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.21.21.21.3.2" class="ltx_text" style="font-size:90%;"> 0.23</span>
</td>
<td id="S4.T1.22.22.22.4" class="ltx_td ltx_align_left">
<span id="S4.T1.22.22.22.4.1" class="ltx_text" style="font-size:90%;">96.14 </span><math id="S4.T1.22.22.22.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.22.22.22.4.m1.1a"><mo mathsize="90%" id="S4.T1.22.22.22.4.m1.1.1" xref="S4.T1.22.22.22.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.22.22.22.4.m1.1b"><csymbol cd="latexml" id="S4.T1.22.22.22.4.m1.1.1.cmml" xref="S4.T1.22.22.22.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.22.22.22.4.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.22.22.22.4.2" class="ltx_text" style="font-size:90%;"> 0.35</span>
</td>
<td id="S4.T1.23.23.23.5" class="ltx_td ltx_align_left">
<span id="S4.T1.23.23.23.5.1" class="ltx_text" style="font-size:90%;">88.22 </span><math id="S4.T1.23.23.23.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.23.23.23.5.m1.1a"><mo mathsize="90%" id="S4.T1.23.23.23.5.m1.1.1" xref="S4.T1.23.23.23.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.23.23.23.5.m1.1b"><csymbol cd="latexml" id="S4.T1.23.23.23.5.m1.1.1.cmml" xref="S4.T1.23.23.23.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.23.23.23.5.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.23.23.23.5.2" class="ltx_text" style="font-size:90%;"> 0.64</span>
</td>
<td id="S4.T1.24.24.24.6" class="ltx_td ltx_align_left">
<span id="S4.T1.24.24.24.6.1" class="ltx_text" style="font-size:90%;">77.44 </span><math id="S4.T1.24.24.24.6.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.24.24.24.6.m1.1a"><mo mathsize="90%" id="S4.T1.24.24.24.6.m1.1.1" xref="S4.T1.24.24.24.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.24.24.24.6.m1.1b"><csymbol cd="latexml" id="S4.T1.24.24.24.6.m1.1.1.cmml" xref="S4.T1.24.24.24.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.24.24.24.6.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.24.24.24.6.2" class="ltx_text" style="font-size:90%;"> 0.59</span>
</td>
</tr>
<tr id="S4.T1.30.30.30" class="ltx_tr">
<td id="S4.T1.30.30.30.7" class="ltx_td ltx_align_left"><span id="S4.T1.30.30.30.7.1" class="ltx_text" style="font-size:90%;">FedAvg</span></td>
<td id="S4.T1.30.30.30.8" class="ltx_td"></td>
<td id="S4.T1.25.25.25.1" class="ltx_td ltx_align_left">
<span id="S4.T1.25.25.25.1.1" class="ltx_text" style="font-size:90%;">97.29 </span><math id="S4.T1.25.25.25.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.25.25.25.1.m1.1a"><mo mathsize="90%" id="S4.T1.25.25.25.1.m1.1.1" xref="S4.T1.25.25.25.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.25.25.25.1.m1.1b"><csymbol cd="latexml" id="S4.T1.25.25.25.1.m1.1.1.cmml" xref="S4.T1.25.25.25.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.25.25.25.1.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.25.25.25.1.2" class="ltx_text" style="font-size:90%;"> 0.54</span>
</td>
<td id="S4.T1.26.26.26.2" class="ltx_td ltx_align_left">
<span id="S4.T1.26.26.26.2.1" class="ltx_text" style="font-size:90%;">54.91 </span><math id="S4.T1.26.26.26.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.26.26.26.2.m1.1a"><mo mathsize="90%" id="S4.T1.26.26.26.2.m1.1.1" xref="S4.T1.26.26.26.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.26.26.26.2.m1.1b"><csymbol cd="latexml" id="S4.T1.26.26.26.2.m1.1.1.cmml" xref="S4.T1.26.26.26.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.26.26.26.2.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.26.26.26.2.2" class="ltx_text" style="font-size:90%;"> 0.57</span>
</td>
<td id="S4.T1.27.27.27.3" class="ltx_td ltx_align_left"><span id="S4.T1.27.27.27.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">69.4 <math id="S4.T1.27.27.27.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.27.27.27.3.1.m1.1a"><mo id="S4.T1.27.27.27.3.1.m1.1.1" xref="S4.T1.27.27.27.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.27.27.27.3.1.m1.1b"><csymbol cd="latexml" id="S4.T1.27.27.27.3.1.m1.1.1.cmml" xref="S4.T1.27.27.27.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.27.27.27.3.1.m1.1c">\pm</annotation></semantics></math> 0.10</span></td>
<td id="S4.T1.28.28.28.4" class="ltx_td ltx_align_left">
<span id="S4.T1.28.28.28.4.1" class="ltx_text" style="font-size:90%;">96.35 </span><math id="S4.T1.28.28.28.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.28.28.28.4.m1.1a"><mo mathsize="90%" id="S4.T1.28.28.28.4.m1.1.1" xref="S4.T1.28.28.28.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.28.28.28.4.m1.1b"><csymbol cd="latexml" id="S4.T1.28.28.28.4.m1.1.1.cmml" xref="S4.T1.28.28.28.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.28.28.28.4.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.28.28.28.4.2" class="ltx_text" style="font-size:90%;"> 0.47</span>
</td>
<td id="S4.T1.29.29.29.5" class="ltx_td ltx_align_left">
<span id="S4.T1.29.29.29.5.1" class="ltx_text" style="font-size:90%;">87.51 </span><math id="S4.T1.29.29.29.5.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.29.29.29.5.m1.1a"><mo mathsize="90%" id="S4.T1.29.29.29.5.m1.1.1" xref="S4.T1.29.29.29.5.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.29.29.29.5.m1.1b"><csymbol cd="latexml" id="S4.T1.29.29.29.5.m1.1.1.cmml" xref="S4.T1.29.29.29.5.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.29.29.29.5.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.29.29.29.5.2" class="ltx_text" style="font-size:90%;"> 0.73</span>
</td>
<td id="S4.T1.30.30.30.6" class="ltx_td ltx_align_left"><span id="S4.T1.30.30.30.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">83.59 <math id="S4.T1.30.30.30.6.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.30.30.30.6.1.m1.1a"><mo id="S4.T1.30.30.30.6.1.m1.1.1" xref="S4.T1.30.30.30.6.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.30.30.30.6.1.m1.1b"><csymbol cd="latexml" id="S4.T1.30.30.30.6.1.m1.1.1.cmml" xref="S4.T1.30.30.30.6.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.30.30.30.6.1.m1.1c">\pm</annotation></semantics></math> 0.35</span></td>
</tr>
<tr id="S4.T1.36.36.36" class="ltx_tr">
<td id="S4.T1.36.36.36.7" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.36.36.36.7.1" class="ltx_text" style="font-size:90%;">PFLEGO</span></td>
<td id="S4.T1.36.36.36.8" class="ltx_td ltx_border_bb"></td>
<td id="S4.T1.31.31.31.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.31.31.31.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">98.49 <math id="S4.T1.31.31.31.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.31.31.31.1.1.m1.1a"><mo id="S4.T1.31.31.31.1.1.m1.1.1" xref="S4.T1.31.31.31.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.31.31.31.1.1.m1.1b"><csymbol cd="latexml" id="S4.T1.31.31.31.1.1.m1.1.1.cmml" xref="S4.T1.31.31.31.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.31.31.31.1.1.m1.1c">\pm</annotation></semantics></math> 0.43</span></td>
<td id="S4.T1.32.32.32.2" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.T1.32.32.32.2.1" class="ltx_text" style="font-size:90%;">62.74 </span><math id="S4.T1.32.32.32.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.32.32.32.2.m1.1a"><mo mathsize="90%" id="S4.T1.32.32.32.2.m1.1.1" xref="S4.T1.32.32.32.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.32.32.32.2.m1.1b"><csymbol cd="latexml" id="S4.T1.32.32.32.2.m1.1.1.cmml" xref="S4.T1.32.32.32.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.32.32.32.2.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.32.32.32.2.2" class="ltx_text" style="font-size:90%;"> 0.51</span>
</td>
<td id="S4.T1.33.33.33.3" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.T1.33.33.33.3.1" class="ltx_text" style="font-size:90%;">41.41 </span><math id="S4.T1.33.33.33.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.33.33.33.3.m1.1a"><mo mathsize="90%" id="S4.T1.33.33.33.3.m1.1.1" xref="S4.T1.33.33.33.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.33.33.33.3.m1.1b"><csymbol cd="latexml" id="S4.T1.33.33.33.3.m1.1.1.cmml" xref="S4.T1.33.33.33.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.33.33.33.3.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.33.33.33.3.2" class="ltx_text" style="font-size:90%;"> 0.32</span>
</td>
<td id="S4.T1.34.34.34.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.34.34.34.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">96.34 <math id="S4.T1.34.34.34.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.34.34.34.4.1.m1.1a"><mo id="S4.T1.34.34.34.4.1.m1.1.1" xref="S4.T1.34.34.34.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.34.34.34.4.1.m1.1b"><csymbol cd="latexml" id="S4.T1.34.34.34.4.1.m1.1.1.cmml" xref="S4.T1.34.34.34.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.34.34.34.4.1.m1.1c">\pm</annotation></semantics></math> 0.43</span></td>
<td id="S4.T1.35.35.35.5" class="ltx_td ltx_align_left ltx_border_bb"><span id="S4.T1.35.35.35.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">89.84 <math id="S4.T1.35.35.35.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.35.35.35.5.1.m1.1a"><mo id="S4.T1.35.35.35.5.1.m1.1.1" xref="S4.T1.35.35.35.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.35.35.35.5.1.m1.1b"><csymbol cd="latexml" id="S4.T1.35.35.35.5.1.m1.1.1.cmml" xref="S4.T1.35.35.35.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.35.35.35.5.1.m1.1c">\pm</annotation></semantics></math> 0.52</span></td>
<td id="S4.T1.36.36.36.6" class="ltx_td ltx_align_left ltx_border_bb">
<span id="S4.T1.36.36.36.6.1" class="ltx_text" style="font-size:90%;">81.49 </span><math id="S4.T1.36.36.36.6.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T1.36.36.36.6.m1.1a"><mo mathsize="90%" id="S4.T1.36.36.36.6.m1.1.1" xref="S4.T1.36.36.36.6.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T1.36.36.36.6.m1.1b"><csymbol cd="latexml" id="S4.T1.36.36.36.6.m1.1.1.cmml" xref="S4.T1.36.36.36.6.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.36.36.36.6.m1.1c">\pm</annotation></semantics></math><span id="S4.T1.36.36.36.6.2" class="ltx_text" style="font-size:90%;"> 0.51</span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.F2" class="ltx_figure">
<br class="ltx_break">
<table id="S4.F2.3.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F2.3.3.3" class="ltx_tr">
<td id="S4.F2.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x2.png" id="S4.F2.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="111" height="66" alt="Refer to caption"></td>
<td id="S4.F2.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x3.png" id="S4.F2.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="111" height="66" alt="Refer to caption"></td>
<td id="S4.F2.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x4.png" id="S4.F2.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="111" height="66" alt="Refer to caption"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Training loss (left), training accuracy (middle) and test accuracy (right) for the Omniglot dataset. All FL methods were run for <math id="S4.F2.7.7.m1.2" class="ltx_Math" alttext="5,000" display="inline"><semantics id="S4.F2.7.7.m1.2b"><mrow id="S4.F2.7.7.m1.2.3.2" xref="S4.F2.7.7.m1.2.3.1.cmml"><mn id="S4.F2.7.7.m1.1.1" xref="S4.F2.7.7.m1.1.1.cmml">5</mn><mo id="S4.F2.7.7.m1.2.3.2.1" xref="S4.F2.7.7.m1.2.3.1.cmml">,</mo><mn id="S4.F2.7.7.m1.2.2" xref="S4.F2.7.7.m1.2.2.cmml">000</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.7.7.m1.2c"><list id="S4.F2.7.7.m1.2.3.1.cmml" xref="S4.F2.7.7.m1.2.3.2"><cn type="integer" id="S4.F2.7.7.m1.1.1.cmml" xref="S4.F2.7.7.m1.1.1">5</cn><cn type="integer" id="S4.F2.7.7.m1.2.2.cmml" xref="S4.F2.7.7.m1.2.2">000</cn></list></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.7.7.m1.2d">5,000</annotation></semantics></math> rounds, with <math id="S4.F2.8.8.m2.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S4.F2.8.8.m2.1b"><mn id="S4.F2.8.8.m2.1.1" xref="S4.F2.8.8.m2.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S4.F2.8.8.m2.1c"><cn type="integer" id="S4.F2.8.8.m2.1.1.cmml" xref="S4.F2.8.8.m2.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.8.8.m2.1d">50</annotation></semantics></math> inner client steps per round and <math id="S4.F2.9.9.m3.1" class="ltx_Math" alttext="r=20\%" display="inline"><semantics id="S4.F2.9.9.m3.1b"><mrow id="S4.F2.9.9.m3.1.1" xref="S4.F2.9.9.m3.1.1.cmml"><mi id="S4.F2.9.9.m3.1.1.2" xref="S4.F2.9.9.m3.1.1.2.cmml">r</mi><mo id="S4.F2.9.9.m3.1.1.1" xref="S4.F2.9.9.m3.1.1.1.cmml">=</mo><mrow id="S4.F2.9.9.m3.1.1.3" xref="S4.F2.9.9.m3.1.1.3.cmml"><mn id="S4.F2.9.9.m3.1.1.3.2" xref="S4.F2.9.9.m3.1.1.3.2.cmml">20</mn><mo id="S4.F2.9.9.m3.1.1.3.1" xref="S4.F2.9.9.m3.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.9.9.m3.1c"><apply id="S4.F2.9.9.m3.1.1.cmml" xref="S4.F2.9.9.m3.1.1"><eq id="S4.F2.9.9.m3.1.1.1.cmml" xref="S4.F2.9.9.m3.1.1.1"></eq><ci id="S4.F2.9.9.m3.1.1.2.cmml" xref="S4.F2.9.9.m3.1.1.2">𝑟</ci><apply id="S4.F2.9.9.m3.1.1.3.cmml" xref="S4.F2.9.9.m3.1.1.3"><csymbol cd="latexml" id="S4.F2.9.9.m3.1.1.3.1.cmml" xref="S4.F2.9.9.m3.1.1.3.1">percent</csymbol><cn type="integer" id="S4.F2.9.9.m3.1.1.3.2.cmml" xref="S4.F2.9.9.m3.1.1.3.2">20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.9.9.m3.1d">r=20\%</annotation></semantics></math> client participation per round.
</figcaption>
</figure>
<figure id="S4.F3" class="ltx_figure">
<br class="ltx_break">
<table id="S4.F3.6.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F3.3.3.3" class="ltx_tr">
<td id="S4.F3.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x5.png" id="S4.F3.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="106" height="68" alt="Refer to caption"></td>
<td id="S4.F3.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x6.png" id="S4.F3.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="106" height="68" alt="Refer to caption"></td>
<td id="S4.F3.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x7.png" id="S4.F3.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="106" height="68" alt="Refer to caption"></td>
</tr>
<tr id="S4.F3.6.6.6" class="ltx_tr">
<td id="S4.F3.4.4.4.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x8.png" id="S4.F3.4.4.4.1.g1" class="ltx_graphics ltx_img_landscape" width="106" height="68" alt="Refer to caption"></td>
<td id="S4.F3.5.5.5.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x9.png" id="S4.F3.5.5.5.2.g1" class="ltx_graphics ltx_img_landscape" width="106" height="68" alt="Refer to caption"></td>
<td id="S4.F3.6.6.6.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x10.png" id="S4.F3.6.6.6.3.g1" class="ltx_graphics ltx_img_landscape" width="106" height="68" alt="Refer to caption"></td>
</tr>
<tr id="S4.F3.6.6.7.1" class="ltx_tr">
<td id="S4.F3.6.6.7.1.1" class="ltx_td ltx_align_center">High-pers</td>
<td id="S4.F3.6.6.7.1.2" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="S4.F3.6.6.7.1.3" class="ltx_td ltx_align_center">No-pers</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Training loss (top row) and test accuracy (bottom row) for MNIST dataset for PFLEGO, FedAvg and FedPer over <math id="S4.F3.10.10.m1.1" class="ltx_Math" alttext="T=200" display="inline"><semantics id="S4.F3.10.10.m1.1b"><mrow id="S4.F3.10.10.m1.1.1" xref="S4.F3.10.10.m1.1.1.cmml"><mi id="S4.F3.10.10.m1.1.1.2" xref="S4.F3.10.10.m1.1.1.2.cmml">T</mi><mo id="S4.F3.10.10.m1.1.1.1" xref="S4.F3.10.10.m1.1.1.1.cmml">=</mo><mn id="S4.F3.10.10.m1.1.1.3" xref="S4.F3.10.10.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.10.10.m1.1c"><apply id="S4.F3.10.10.m1.1.1.cmml" xref="S4.F3.10.10.m1.1.1"><eq id="S4.F3.10.10.m1.1.1.1.cmml" xref="S4.F3.10.10.m1.1.1.1"></eq><ci id="S4.F3.10.10.m1.1.1.2.cmml" xref="S4.F3.10.10.m1.1.1.2">𝑇</ci><cn type="integer" id="S4.F3.10.10.m1.1.1.3.cmml" xref="S4.F3.10.10.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.10.10.m1.1d">T=200</annotation></semantics></math> rounds, <math id="S4.F3.11.11.m2.1" class="ltx_Math" alttext="I=100" display="inline"><semantics id="S4.F3.11.11.m2.1b"><mrow id="S4.F3.11.11.m2.1.1" xref="S4.F3.11.11.m2.1.1.cmml"><mi id="S4.F3.11.11.m2.1.1.2" xref="S4.F3.11.11.m2.1.1.2.cmml">I</mi><mo id="S4.F3.11.11.m2.1.1.1" xref="S4.F3.11.11.m2.1.1.1.cmml">=</mo><mn id="S4.F3.11.11.m2.1.1.3" xref="S4.F3.11.11.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.11.11.m2.1c"><apply id="S4.F3.11.11.m2.1.1.cmml" xref="S4.F3.11.11.m2.1.1"><eq id="S4.F3.11.11.m2.1.1.1.cmml" xref="S4.F3.11.11.m2.1.1.1"></eq><ci id="S4.F3.11.11.m2.1.1.2.cmml" xref="S4.F3.11.11.m2.1.1.2">𝐼</ci><cn type="integer" id="S4.F3.11.11.m2.1.1.3.cmml" xref="S4.F3.11.11.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.11.11.m2.1d">I=100</annotation></semantics></math> clients, <math id="S4.F3.12.12.m3.1" class="ltx_Math" alttext="r=20\%" display="inline"><semantics id="S4.F3.12.12.m3.1b"><mrow id="S4.F3.12.12.m3.1.1" xref="S4.F3.12.12.m3.1.1.cmml"><mi id="S4.F3.12.12.m3.1.1.2" xref="S4.F3.12.12.m3.1.1.2.cmml">r</mi><mo id="S4.F3.12.12.m3.1.1.1" xref="S4.F3.12.12.m3.1.1.1.cmml">=</mo><mrow id="S4.F3.12.12.m3.1.1.3" xref="S4.F3.12.12.m3.1.1.3.cmml"><mn id="S4.F3.12.12.m3.1.1.3.2" xref="S4.F3.12.12.m3.1.1.3.2.cmml">20</mn><mo id="S4.F3.12.12.m3.1.1.3.1" xref="S4.F3.12.12.m3.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.12.12.m3.1c"><apply id="S4.F3.12.12.m3.1.1.cmml" xref="S4.F3.12.12.m3.1.1"><eq id="S4.F3.12.12.m3.1.1.1.cmml" xref="S4.F3.12.12.m3.1.1.1"></eq><ci id="S4.F3.12.12.m3.1.1.2.cmml" xref="S4.F3.12.12.m3.1.1.2">𝑟</ci><apply id="S4.F3.12.12.m3.1.1.3.cmml" xref="S4.F3.12.12.m3.1.1.3"><csymbol cd="latexml" id="S4.F3.12.12.m3.1.1.3.1.cmml" xref="S4.F3.12.12.m3.1.1.3.1">percent</csymbol><cn type="integer" id="S4.F3.12.12.m3.1.1.3.2.cmml" xref="S4.F3.12.12.m3.1.1.3.2">20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.12.12.m3.1d">r=20\%</annotation></semantics></math> client participation per round. Each column corresponds to a degree of personalization (high, medium, no personalization).
</figcaption>
</figure>
<figure id="S4.F4" class="ltx_figure">
<br class="ltx_break">
<table id="S4.F4.6.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F4.3.3.3" class="ltx_tr">
<td id="S4.F4.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x11.png" id="S4.F4.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="115" height="63" alt="Refer to caption"></td>
<td id="S4.F4.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x12.png" id="S4.F4.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="111" height="63" alt="Refer to caption"></td>
<td id="S4.F4.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x13.png" id="S4.F4.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="111" height="63" alt="Refer to caption"></td>
</tr>
<tr id="S4.F4.6.6.6" class="ltx_tr">
<td id="S4.F4.4.4.4.1" class="ltx_td ltx_align_center"><math id="S4.F4.4.4.4.1.m1.1" class="ltx_Math" alttext="\rho=0.001" display="inline"><semantics id="S4.F4.4.4.4.1.m1.1a"><mrow id="S4.F4.4.4.4.1.m1.1.1" xref="S4.F4.4.4.4.1.m1.1.1.cmml"><mi id="S4.F4.4.4.4.1.m1.1.1.2" xref="S4.F4.4.4.4.1.m1.1.1.2.cmml">ρ</mi><mo id="S4.F4.4.4.4.1.m1.1.1.1" xref="S4.F4.4.4.4.1.m1.1.1.1.cmml">=</mo><mn id="S4.F4.4.4.4.1.m1.1.1.3" xref="S4.F4.4.4.4.1.m1.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.4.4.4.1.m1.1b"><apply id="S4.F4.4.4.4.1.m1.1.1.cmml" xref="S4.F4.4.4.4.1.m1.1.1"><eq id="S4.F4.4.4.4.1.m1.1.1.1.cmml" xref="S4.F4.4.4.4.1.m1.1.1.1"></eq><ci id="S4.F4.4.4.4.1.m1.1.1.2.cmml" xref="S4.F4.4.4.4.1.m1.1.1.2">𝜌</ci><cn type="float" id="S4.F4.4.4.4.1.m1.1.1.3.cmml" xref="S4.F4.4.4.4.1.m1.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.4.4.1.m1.1c">\rho=0.001</annotation></semantics></math></td>
<td id="S4.F4.5.5.5.2" class="ltx_td ltx_align_center"><math id="S4.F4.5.5.5.2.m1.1" class="ltx_Math" alttext="\rho=0.002" display="inline"><semantics id="S4.F4.5.5.5.2.m1.1a"><mrow id="S4.F4.5.5.5.2.m1.1.1" xref="S4.F4.5.5.5.2.m1.1.1.cmml"><mi id="S4.F4.5.5.5.2.m1.1.1.2" xref="S4.F4.5.5.5.2.m1.1.1.2.cmml">ρ</mi><mo id="S4.F4.5.5.5.2.m1.1.1.1" xref="S4.F4.5.5.5.2.m1.1.1.1.cmml">=</mo><mn id="S4.F4.5.5.5.2.m1.1.1.3" xref="S4.F4.5.5.5.2.m1.1.1.3.cmml">0.002</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.5.5.5.2.m1.1b"><apply id="S4.F4.5.5.5.2.m1.1.1.cmml" xref="S4.F4.5.5.5.2.m1.1.1"><eq id="S4.F4.5.5.5.2.m1.1.1.1.cmml" xref="S4.F4.5.5.5.2.m1.1.1.1"></eq><ci id="S4.F4.5.5.5.2.m1.1.1.2.cmml" xref="S4.F4.5.5.5.2.m1.1.1.2">𝜌</ci><cn type="float" id="S4.F4.5.5.5.2.m1.1.1.3.cmml" xref="S4.F4.5.5.5.2.m1.1.1.3">0.002</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.5.5.5.2.m1.1c">\rho=0.002</annotation></semantics></math></td>
<td id="S4.F4.6.6.6.3" class="ltx_td ltx_align_center"><math id="S4.F4.6.6.6.3.m1.1" class="ltx_Math" alttext="\rho=0.003" display="inline"><semantics id="S4.F4.6.6.6.3.m1.1a"><mrow id="S4.F4.6.6.6.3.m1.1.1" xref="S4.F4.6.6.6.3.m1.1.1.cmml"><mi id="S4.F4.6.6.6.3.m1.1.1.2" xref="S4.F4.6.6.6.3.m1.1.1.2.cmml">ρ</mi><mo id="S4.F4.6.6.6.3.m1.1.1.1" xref="S4.F4.6.6.6.3.m1.1.1.1.cmml">=</mo><mn id="S4.F4.6.6.6.3.m1.1.1.3" xref="S4.F4.6.6.6.3.m1.1.1.3.cmml">0.003</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.6.6.6.3.m1.1b"><apply id="S4.F4.6.6.6.3.m1.1.1.cmml" xref="S4.F4.6.6.6.3.m1.1.1"><eq id="S4.F4.6.6.6.3.m1.1.1.1.cmml" xref="S4.F4.6.6.6.3.m1.1.1.1"></eq><ci id="S4.F4.6.6.6.3.m1.1.1.2.cmml" xref="S4.F4.6.6.6.3.m1.1.1.2">𝜌</ci><cn type="float" id="S4.F4.6.6.6.3.m1.1.1.3.cmml" xref="S4.F4.6.6.6.3.m1.1.1.3">0.003</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.6.6.6.3.m1.1c">\rho=0.003</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Training loss for different value of learning rate <math id="S4.F4.14.14.m1.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S4.F4.14.14.m1.1b"><mi id="S4.F4.14.14.m1.1.1" xref="S4.F4.14.14.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.14.14.m1.1c"><ci id="S4.F4.14.14.m1.1.1.cmml" xref="S4.F4.14.14.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.14.14.m1.1d">\rho</annotation></semantics></math>. For each value of <math id="S4.F4.15.15.m2.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S4.F4.15.15.m2.1b"><mi id="S4.F4.15.15.m2.1.1" xref="S4.F4.15.15.m2.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.F4.15.15.m2.1c"><ci id="S4.F4.15.15.m2.1.1.cmml" xref="S4.F4.15.15.m2.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.15.15.m2.1d">\rho</annotation></semantics></math> we increase the client learning rate value <math id="S4.F4.16.16.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.F4.16.16.m3.1b"><mi id="S4.F4.16.16.m3.1.1" xref="S4.F4.16.16.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.F4.16.16.m3.1c"><ci id="S4.F4.16.16.m3.1.1.cmml" xref="S4.F4.16.16.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.16.16.m3.1d">\beta</annotation></semantics></math>. All experiments are on the Omniglot dataset using PFLEGO with settings: <math id="S4.F4.17.17.m4.1" class="ltx_Math" alttext="I=50" display="inline"><semantics id="S4.F4.17.17.m4.1b"><mrow id="S4.F4.17.17.m4.1.1" xref="S4.F4.17.17.m4.1.1.cmml"><mi id="S4.F4.17.17.m4.1.1.2" xref="S4.F4.17.17.m4.1.1.2.cmml">I</mi><mo id="S4.F4.17.17.m4.1.1.1" xref="S4.F4.17.17.m4.1.1.1.cmml">=</mo><mn id="S4.F4.17.17.m4.1.1.3" xref="S4.F4.17.17.m4.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.17.17.m4.1c"><apply id="S4.F4.17.17.m4.1.1.cmml" xref="S4.F4.17.17.m4.1.1"><eq id="S4.F4.17.17.m4.1.1.1.cmml" xref="S4.F4.17.17.m4.1.1.1"></eq><ci id="S4.F4.17.17.m4.1.1.2.cmml" xref="S4.F4.17.17.m4.1.1.2">𝐼</ci><cn type="integer" id="S4.F4.17.17.m4.1.1.3.cmml" xref="S4.F4.17.17.m4.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.17.17.m4.1d">I=50</annotation></semantics></math> clients, <math id="S4.F4.18.18.m5.1" class="ltx_Math" alttext="\tau=50" display="inline"><semantics id="S4.F4.18.18.m5.1b"><mrow id="S4.F4.18.18.m5.1.1" xref="S4.F4.18.18.m5.1.1.cmml"><mi id="S4.F4.18.18.m5.1.1.2" xref="S4.F4.18.18.m5.1.1.2.cmml">τ</mi><mo id="S4.F4.18.18.m5.1.1.1" xref="S4.F4.18.18.m5.1.1.1.cmml">=</mo><mn id="S4.F4.18.18.m5.1.1.3" xref="S4.F4.18.18.m5.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.18.18.m5.1c"><apply id="S4.F4.18.18.m5.1.1.cmml" xref="S4.F4.18.18.m5.1.1"><eq id="S4.F4.18.18.m5.1.1.1.cmml" xref="S4.F4.18.18.m5.1.1.1"></eq><ci id="S4.F4.18.18.m5.1.1.2.cmml" xref="S4.F4.18.18.m5.1.1.2">𝜏</ci><cn type="integer" id="S4.F4.18.18.m5.1.1.3.cmml" xref="S4.F4.18.18.m5.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.18.18.m5.1d">\tau=50</annotation></semantics></math> inner steps, <math id="S4.F4.19.19.m6.2" class="ltx_Math" alttext="T=5,000" display="inline"><semantics id="S4.F4.19.19.m6.2b"><mrow id="S4.F4.19.19.m6.2.3" xref="S4.F4.19.19.m6.2.3.cmml"><mi id="S4.F4.19.19.m6.2.3.2" xref="S4.F4.19.19.m6.2.3.2.cmml">T</mi><mo id="S4.F4.19.19.m6.2.3.1" xref="S4.F4.19.19.m6.2.3.1.cmml">=</mo><mrow id="S4.F4.19.19.m6.2.3.3.2" xref="S4.F4.19.19.m6.2.3.3.1.cmml"><mn id="S4.F4.19.19.m6.1.1" xref="S4.F4.19.19.m6.1.1.cmml">5</mn><mo id="S4.F4.19.19.m6.2.3.3.2.1" xref="S4.F4.19.19.m6.2.3.3.1.cmml">,</mo><mn id="S4.F4.19.19.m6.2.2" xref="S4.F4.19.19.m6.2.2.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.19.19.m6.2c"><apply id="S4.F4.19.19.m6.2.3.cmml" xref="S4.F4.19.19.m6.2.3"><eq id="S4.F4.19.19.m6.2.3.1.cmml" xref="S4.F4.19.19.m6.2.3.1"></eq><ci id="S4.F4.19.19.m6.2.3.2.cmml" xref="S4.F4.19.19.m6.2.3.2">𝑇</ci><list id="S4.F4.19.19.m6.2.3.3.1.cmml" xref="S4.F4.19.19.m6.2.3.3.2"><cn type="integer" id="S4.F4.19.19.m6.1.1.cmml" xref="S4.F4.19.19.m6.1.1">5</cn><cn type="integer" id="S4.F4.19.19.m6.2.2.cmml" xref="S4.F4.19.19.m6.2.2">000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.19.19.m6.2d">T=5,000</annotation></semantics></math> rounds, and <math id="S4.F4.20.20.m7.1" class="ltx_Math" alttext="r=20\%" display="inline"><semantics id="S4.F4.20.20.m7.1b"><mrow id="S4.F4.20.20.m7.1.1" xref="S4.F4.20.20.m7.1.1.cmml"><mi id="S4.F4.20.20.m7.1.1.2" xref="S4.F4.20.20.m7.1.1.2.cmml">r</mi><mo id="S4.F4.20.20.m7.1.1.1" xref="S4.F4.20.20.m7.1.1.1.cmml">=</mo><mrow id="S4.F4.20.20.m7.1.1.3" xref="S4.F4.20.20.m7.1.1.3.cmml"><mn id="S4.F4.20.20.m7.1.1.3.2" xref="S4.F4.20.20.m7.1.1.3.2.cmml">20</mn><mo id="S4.F4.20.20.m7.1.1.3.1" xref="S4.F4.20.20.m7.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F4.20.20.m7.1c"><apply id="S4.F4.20.20.m7.1.1.cmml" xref="S4.F4.20.20.m7.1.1"><eq id="S4.F4.20.20.m7.1.1.1.cmml" xref="S4.F4.20.20.m7.1.1.1"></eq><ci id="S4.F4.20.20.m7.1.1.2.cmml" xref="S4.F4.20.20.m7.1.1.2">𝑟</ci><apply id="S4.F4.20.20.m7.1.1.3.cmml" xref="S4.F4.20.20.m7.1.1.3"><csymbol cd="latexml" id="S4.F4.20.20.m7.1.1.3.1.cmml" xref="S4.F4.20.20.m7.1.1.3.1">percent</csymbol><cn type="integer" id="S4.F4.20.20.m7.1.1.3.2.cmml" xref="S4.F4.20.20.m7.1.1.3.2">20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.20.20.m7.1d">r=20\%</annotation></semantics></math> participating clients per round.</figcaption>
</figure>
<figure id="S4.F5" class="ltx_figure">
<br class="ltx_break">
<table id="S4.F5.8.8" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.F5.4.4.4" class="ltx_tr">
<td id="S4.F5.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x14.png" id="S4.F5.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="85" height="54" alt="Refer to caption"></td>
<td id="S4.F5.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x15.png" id="S4.F5.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="85" height="54" alt="Refer to caption"></td>
<td id="S4.F5.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x16.png" id="S4.F5.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="85" height="54" alt="Refer to caption"></td>
<td id="S4.F5.4.4.4.4" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x17.png" id="S4.F5.4.4.4.4.g1" class="ltx_graphics ltx_img_landscape" width="85" height="54" alt="Refer to caption"></td>
</tr>
<tr id="S4.F5.8.8.8" class="ltx_tr">
<td id="S4.F5.5.5.5.1" class="ltx_td ltx_align_center"><math id="S4.F5.5.5.5.1.m1.1" class="ltx_Math" alttext="r=20\%" display="inline"><semantics id="S4.F5.5.5.5.1.m1.1a"><mrow id="S4.F5.5.5.5.1.m1.1.1" xref="S4.F5.5.5.5.1.m1.1.1.cmml"><mi id="S4.F5.5.5.5.1.m1.1.1.2" xref="S4.F5.5.5.5.1.m1.1.1.2.cmml">r</mi><mo id="S4.F5.5.5.5.1.m1.1.1.1" xref="S4.F5.5.5.5.1.m1.1.1.1.cmml">=</mo><mrow id="S4.F5.5.5.5.1.m1.1.1.3" xref="S4.F5.5.5.5.1.m1.1.1.3.cmml"><mn id="S4.F5.5.5.5.1.m1.1.1.3.2" xref="S4.F5.5.5.5.1.m1.1.1.3.2.cmml">20</mn><mo id="S4.F5.5.5.5.1.m1.1.1.3.1" xref="S4.F5.5.5.5.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.5.5.5.1.m1.1b"><apply id="S4.F5.5.5.5.1.m1.1.1.cmml" xref="S4.F5.5.5.5.1.m1.1.1"><eq id="S4.F5.5.5.5.1.m1.1.1.1.cmml" xref="S4.F5.5.5.5.1.m1.1.1.1"></eq><ci id="S4.F5.5.5.5.1.m1.1.1.2.cmml" xref="S4.F5.5.5.5.1.m1.1.1.2">𝑟</ci><apply id="S4.F5.5.5.5.1.m1.1.1.3.cmml" xref="S4.F5.5.5.5.1.m1.1.1.3"><csymbol cd="latexml" id="S4.F5.5.5.5.1.m1.1.1.3.1.cmml" xref="S4.F5.5.5.5.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.F5.5.5.5.1.m1.1.1.3.2.cmml" xref="S4.F5.5.5.5.1.m1.1.1.3.2">20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.5.5.5.1.m1.1c">r=20\%</annotation></semantics></math></td>
<td id="S4.F5.6.6.6.2" class="ltx_td ltx_align_center"><math id="S4.F5.6.6.6.2.m1.1" class="ltx_Math" alttext="r=40\%" display="inline"><semantics id="S4.F5.6.6.6.2.m1.1a"><mrow id="S4.F5.6.6.6.2.m1.1.1" xref="S4.F5.6.6.6.2.m1.1.1.cmml"><mi id="S4.F5.6.6.6.2.m1.1.1.2" xref="S4.F5.6.6.6.2.m1.1.1.2.cmml">r</mi><mo id="S4.F5.6.6.6.2.m1.1.1.1" xref="S4.F5.6.6.6.2.m1.1.1.1.cmml">=</mo><mrow id="S4.F5.6.6.6.2.m1.1.1.3" xref="S4.F5.6.6.6.2.m1.1.1.3.cmml"><mn id="S4.F5.6.6.6.2.m1.1.1.3.2" xref="S4.F5.6.6.6.2.m1.1.1.3.2.cmml">40</mn><mo id="S4.F5.6.6.6.2.m1.1.1.3.1" xref="S4.F5.6.6.6.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.6.6.6.2.m1.1b"><apply id="S4.F5.6.6.6.2.m1.1.1.cmml" xref="S4.F5.6.6.6.2.m1.1.1"><eq id="S4.F5.6.6.6.2.m1.1.1.1.cmml" xref="S4.F5.6.6.6.2.m1.1.1.1"></eq><ci id="S4.F5.6.6.6.2.m1.1.1.2.cmml" xref="S4.F5.6.6.6.2.m1.1.1.2">𝑟</ci><apply id="S4.F5.6.6.6.2.m1.1.1.3.cmml" xref="S4.F5.6.6.6.2.m1.1.1.3"><csymbol cd="latexml" id="S4.F5.6.6.6.2.m1.1.1.3.1.cmml" xref="S4.F5.6.6.6.2.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.F5.6.6.6.2.m1.1.1.3.2.cmml" xref="S4.F5.6.6.6.2.m1.1.1.3.2">40</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.6.6.2.m1.1c">r=40\%</annotation></semantics></math></td>
<td id="S4.F5.7.7.7.3" class="ltx_td ltx_align_center"><math id="S4.F5.7.7.7.3.m1.1" class="ltx_Math" alttext="r=60\%" display="inline"><semantics id="S4.F5.7.7.7.3.m1.1a"><mrow id="S4.F5.7.7.7.3.m1.1.1" xref="S4.F5.7.7.7.3.m1.1.1.cmml"><mi id="S4.F5.7.7.7.3.m1.1.1.2" xref="S4.F5.7.7.7.3.m1.1.1.2.cmml">r</mi><mo id="S4.F5.7.7.7.3.m1.1.1.1" xref="S4.F5.7.7.7.3.m1.1.1.1.cmml">=</mo><mrow id="S4.F5.7.7.7.3.m1.1.1.3" xref="S4.F5.7.7.7.3.m1.1.1.3.cmml"><mn id="S4.F5.7.7.7.3.m1.1.1.3.2" xref="S4.F5.7.7.7.3.m1.1.1.3.2.cmml">60</mn><mo id="S4.F5.7.7.7.3.m1.1.1.3.1" xref="S4.F5.7.7.7.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.7.7.7.3.m1.1b"><apply id="S4.F5.7.7.7.3.m1.1.1.cmml" xref="S4.F5.7.7.7.3.m1.1.1"><eq id="S4.F5.7.7.7.3.m1.1.1.1.cmml" xref="S4.F5.7.7.7.3.m1.1.1.1"></eq><ci id="S4.F5.7.7.7.3.m1.1.1.2.cmml" xref="S4.F5.7.7.7.3.m1.1.1.2">𝑟</ci><apply id="S4.F5.7.7.7.3.m1.1.1.3.cmml" xref="S4.F5.7.7.7.3.m1.1.1.3"><csymbol cd="latexml" id="S4.F5.7.7.7.3.m1.1.1.3.1.cmml" xref="S4.F5.7.7.7.3.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.F5.7.7.7.3.m1.1.1.3.2.cmml" xref="S4.F5.7.7.7.3.m1.1.1.3.2">60</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.7.7.7.3.m1.1c">r=60\%</annotation></semantics></math></td>
<td id="S4.F5.8.8.8.4" class="ltx_td ltx_align_center"><math id="S4.F5.8.8.8.4.m1.1" class="ltx_Math" alttext="r=100\%" display="inline"><semantics id="S4.F5.8.8.8.4.m1.1a"><mrow id="S4.F5.8.8.8.4.m1.1.1" xref="S4.F5.8.8.8.4.m1.1.1.cmml"><mi id="S4.F5.8.8.8.4.m1.1.1.2" xref="S4.F5.8.8.8.4.m1.1.1.2.cmml">r</mi><mo id="S4.F5.8.8.8.4.m1.1.1.1" xref="S4.F5.8.8.8.4.m1.1.1.1.cmml">=</mo><mrow id="S4.F5.8.8.8.4.m1.1.1.3" xref="S4.F5.8.8.8.4.m1.1.1.3.cmml"><mn id="S4.F5.8.8.8.4.m1.1.1.3.2" xref="S4.F5.8.8.8.4.m1.1.1.3.2.cmml">100</mn><mo id="S4.F5.8.8.8.4.m1.1.1.3.1" xref="S4.F5.8.8.8.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F5.8.8.8.4.m1.1b"><apply id="S4.F5.8.8.8.4.m1.1.1.cmml" xref="S4.F5.8.8.8.4.m1.1.1"><eq id="S4.F5.8.8.8.4.m1.1.1.1.cmml" xref="S4.F5.8.8.8.4.m1.1.1.1"></eq><ci id="S4.F5.8.8.8.4.m1.1.1.2.cmml" xref="S4.F5.8.8.8.4.m1.1.1.2">𝑟</ci><apply id="S4.F5.8.8.8.4.m1.1.1.3.cmml" xref="S4.F5.8.8.8.4.m1.1.1.3"><csymbol cd="latexml" id="S4.F5.8.8.8.4.m1.1.1.3.1.cmml" xref="S4.F5.8.8.8.4.m1.1.1.3.1">percent</csymbol><cn type="integer" id="S4.F5.8.8.8.4.m1.1.1.3.2.cmml" xref="S4.F5.8.8.8.4.m1.1.1.3.2">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.8.8.8.4.m1.1c">r=100\%</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Ablation study of client participation using the CIFAR-10 for the High-pers case. PFLEGO is compared against FedAvg and FedPer in terms of the ability to minimize the train loss across rounds. The panel in each column corresponds to a different
participation percentage <math id="S4.F5.10.10.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.F5.10.10.m1.1b"><mi id="S4.F5.10.10.m1.1.1" xref="S4.F5.10.10.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.F5.10.10.m1.1c"><ci id="S4.F5.10.10.m1.1.1.cmml" xref="S4.F5.10.10.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.10.10.m1.1d">r</annotation></semantics></math>.</figcaption>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experimental Setup

</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.6" class="ltx_p">For Omniglot, we assume that a single alphabet is stored in a different client. Due to the fact that each handwritten system of each alphabet is unique, there is no class label set overlap among the clients, which makes Omniglot the hardest and highly personalized FL problem in our experiments. At each alphabet, data of each class are split into <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="75\%" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mn id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">75</mn><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">75\%</annotation></semantics></math> for training and <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="25\%" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mn id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">25</mn><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">25\%</annotation></semantics></math> for testing. Also standard data augmentation is used by including
rotated image samples of multiples of 90° <cite class="ltx_cite ltx_citemacro_citep">(Finn et al., <a href="#bib.bib8" title="" class="ltx_ref">2017</a>)</cite>. The setup we follow is based on <cite class="ltx_cite ltx_citemacro_citep">(Shamsian et al., <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite> that uses <math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="I=50" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">I</mi><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><eq id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></eq><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝐼</ci><cn type="integer" id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">I=50</annotation></semantics></math> clients, <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\tau=50" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">τ</mi><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><eq id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝜏</ci><cn type="integer" id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\tau=50</annotation></semantics></math> inner steps per client, and <math id="S4.SS2.p1.5.m5.2" class="ltx_Math" alttext="T=5,000" display="inline"><semantics id="S4.SS2.p1.5.m5.2a"><mrow id="S4.SS2.p1.5.m5.2.3" xref="S4.SS2.p1.5.m5.2.3.cmml"><mi id="S4.SS2.p1.5.m5.2.3.2" xref="S4.SS2.p1.5.m5.2.3.2.cmml">T</mi><mo id="S4.SS2.p1.5.m5.2.3.1" xref="S4.SS2.p1.5.m5.2.3.1.cmml">=</mo><mrow id="S4.SS2.p1.5.m5.2.3.3.2" xref="S4.SS2.p1.5.m5.2.3.3.1.cmml"><mn id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">5</mn><mo id="S4.SS2.p1.5.m5.2.3.3.2.1" xref="S4.SS2.p1.5.m5.2.3.3.1.cmml">,</mo><mn id="S4.SS2.p1.5.m5.2.2" xref="S4.SS2.p1.5.m5.2.2.cmml">000</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.2b"><apply id="S4.SS2.p1.5.m5.2.3.cmml" xref="S4.SS2.p1.5.m5.2.3"><eq id="S4.SS2.p1.5.m5.2.3.1.cmml" xref="S4.SS2.p1.5.m5.2.3.1"></eq><ci id="S4.SS2.p1.5.m5.2.3.2.cmml" xref="S4.SS2.p1.5.m5.2.3.2">𝑇</ci><list id="S4.SS2.p1.5.m5.2.3.3.1.cmml" xref="S4.SS2.p1.5.m5.2.3.3.2"><cn type="integer" id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1">5</cn><cn type="integer" id="S4.SS2.p1.5.m5.2.2.cmml" xref="S4.SS2.p1.5.m5.2.2">000</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.2c">T=5,000</annotation></semantics></math> communication rounds, and each client has an unique alphabet. For the FedAvg algorithm, the final layer of the common weights is set to 55 outputs, which is equal to the maximum number of classes among all <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="50" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mn id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><cn type="integer" id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">50</annotation></semantics></math> alphabets.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.3" class="ltx_p">For MNIST, Fashion-MNIST, EMNIST and CIFAR-10, we use <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="I=100" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml">I</mi><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><ci id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2">𝐼</ci><cn type="integer" id="S4.SS2.p2.1.m1.1.1.3.cmml" xref="S4.SS2.p2.1.m1.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">I=100</annotation></semantics></math> clients, <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\tau=50" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">τ</mi><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><eq id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></eq><ci id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2">𝜏</ci><cn type="integer" id="S4.SS2.p2.2.m2.1.1.3.cmml" xref="S4.SS2.p2.2.m2.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\tau=50</annotation></semantics></math> inner steps per client, and <math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="T=200" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">T</mi><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><eq id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></eq><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">𝑇</ci><cn type="integer" id="S4.SS2.p2.3.m3.1.1.3.cmml" xref="S4.SS2.p2.3.m3.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">T=200</annotation></semantics></math> communication rounds. MNIST, Fashion-MNIST and CIFAR-10 are well-balanced datasets and contain 10 classes. EMNIST is more challenging since it has 62 classes and varying number of examples per class. We simulate several FL scenarios by varying the amount of task-personalization among clients. This involves varying the degree of class label set overlap among clients, so that different clients can have different classes in their private datasets.</p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Degree of personalization</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.9" class="ltx_p">For all datasets except Omniglot which is personalized by design, i.e. for MNIST, CIFAR-10, Fashion-Mnist and EMNIST, we artificially simulate personalized FL problems by varying the <em id="S4.SS2.SSS1.p1.9.1" class="ltx_emph ltx_font_italic">degree of personalization</em>.
This is quantified by the size <math id="S4.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mi id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><ci id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">K</annotation></semantics></math> of classes randomly assigned to each client from the total set of classes, so that
the smaller the <math id="S4.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><mi id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><ci id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">K</annotation></semantics></math> is, the higher the personalization is, since the probability of class overlap among clients reduces with smaller <math id="S4.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.SS2.SSS1.p1.3.m3.1a"><mi id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.1b"><ci id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.1c">K</annotation></semantics></math> values.
We consider three degrees
of personalization.
(i) “high-pers” where each client has <math id="S4.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="K=2" display="inline"><semantics id="S4.SS2.SSS1.p1.4.m4.1a"><mrow id="S4.SS2.SSS1.p1.4.m4.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.cmml"><mi id="S4.SS2.SSS1.p1.4.m4.1.1.2" xref="S4.SS2.SSS1.p1.4.m4.1.1.2.cmml">K</mi><mo id="S4.SS2.SSS1.p1.4.m4.1.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.4.m4.1.1.3" xref="S4.SS2.SSS1.p1.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.4.m4.1b"><apply id="S4.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1"><eq id="S4.SS2.SSS1.p1.4.m4.1.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.1"></eq><ci id="S4.SS2.SSS1.p1.4.m4.1.1.2.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.2">𝐾</ci><cn type="integer" id="S4.SS2.SSS1.p1.4.m4.1.1.3.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.4.m4.1c">K=2</annotation></semantics></math> randomly chosen classes from the total set of <math id="S4.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.SSS1.p1.5.m5.1a"><mi id="S4.SS2.SSS1.p1.5.m5.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.5.m5.1b"><ci id="S4.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.5.m5.1c">C</annotation></semantics></math> classes (<math id="S4.SS2.SSS1.p1.6.m6.1" class="ltx_Math" alttext="C=10" display="inline"><semantics id="S4.SS2.SSS1.p1.6.m6.1a"><mrow id="S4.SS2.SSS1.p1.6.m6.1.1" xref="S4.SS2.SSS1.p1.6.m6.1.1.cmml"><mi id="S4.SS2.SSS1.p1.6.m6.1.1.2" xref="S4.SS2.SSS1.p1.6.m6.1.1.2.cmml">C</mi><mo id="S4.SS2.SSS1.p1.6.m6.1.1.1" xref="S4.SS2.SSS1.p1.6.m6.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.6.m6.1.1.3" xref="S4.SS2.SSS1.p1.6.m6.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.6.m6.1b"><apply id="S4.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1"><eq id="S4.SS2.SSS1.p1.6.m6.1.1.1.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1.1"></eq><ci id="S4.SS2.SSS1.p1.6.m6.1.1.2.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1.2">𝐶</ci><cn type="integer" id="S4.SS2.SSS1.p1.6.m6.1.1.3.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.6.m6.1c">C=10</annotation></semantics></math> for MNIST, CIFAR-10, Fashion-MNIST and <math id="S4.SS2.SSS1.p1.7.m7.1" class="ltx_Math" alttext="C=62" display="inline"><semantics id="S4.SS2.SSS1.p1.7.m7.1a"><mrow id="S4.SS2.SSS1.p1.7.m7.1.1" xref="S4.SS2.SSS1.p1.7.m7.1.1.cmml"><mi id="S4.SS2.SSS1.p1.7.m7.1.1.2" xref="S4.SS2.SSS1.p1.7.m7.1.1.2.cmml">C</mi><mo id="S4.SS2.SSS1.p1.7.m7.1.1.1" xref="S4.SS2.SSS1.p1.7.m7.1.1.1.cmml">=</mo><mn id="S4.SS2.SSS1.p1.7.m7.1.1.3" xref="S4.SS2.SSS1.p1.7.m7.1.1.3.cmml">62</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.7.m7.1b"><apply id="S4.SS2.SSS1.p1.7.m7.1.1.cmml" xref="S4.SS2.SSS1.p1.7.m7.1.1"><eq id="S4.SS2.SSS1.p1.7.m7.1.1.1.cmml" xref="S4.SS2.SSS1.p1.7.m7.1.1.1"></eq><ci id="S4.SS2.SSS1.p1.7.m7.1.1.2.cmml" xref="S4.SS2.SSS1.p1.7.m7.1.1.2">𝐶</ci><cn type="integer" id="S4.SS2.SSS1.p1.7.m7.1.1.3.cmml" xref="S4.SS2.SSS1.p1.7.m7.1.1.3">62</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.7.m7.1c">C=62</annotation></semantics></math> for EMNIST), (ii) “medium-pers” where <math id="S4.SS2.SSS1.p1.8.m8.1" class="ltx_Math" alttext="C/2" display="inline"><semantics id="S4.SS2.SSS1.p1.8.m8.1a"><mrow id="S4.SS2.SSS1.p1.8.m8.1.1" xref="S4.SS2.SSS1.p1.8.m8.1.1.cmml"><mi id="S4.SS2.SSS1.p1.8.m8.1.1.2" xref="S4.SS2.SSS1.p1.8.m8.1.1.2.cmml">C</mi><mo id="S4.SS2.SSS1.p1.8.m8.1.1.1" xref="S4.SS2.SSS1.p1.8.m8.1.1.1.cmml">/</mo><mn id="S4.SS2.SSS1.p1.8.m8.1.1.3" xref="S4.SS2.SSS1.p1.8.m8.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.8.m8.1b"><apply id="S4.SS2.SSS1.p1.8.m8.1.1.cmml" xref="S4.SS2.SSS1.p1.8.m8.1.1"><divide id="S4.SS2.SSS1.p1.8.m8.1.1.1.cmml" xref="S4.SS2.SSS1.p1.8.m8.1.1.1"></divide><ci id="S4.SS2.SSS1.p1.8.m8.1.1.2.cmml" xref="S4.SS2.SSS1.p1.8.m8.1.1.2">𝐶</ci><cn type="integer" id="S4.SS2.SSS1.p1.8.m8.1.1.3.cmml" xref="S4.SS2.SSS1.p1.8.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.8.m8.1c">C/2</annotation></semantics></math> classes are randomly assigned to each client, and (iii) “no-pers” where all clients have data points from all <math id="S4.SS2.SSS1.p1.9.m9.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.SS2.SSS1.p1.9.m9.1a"><mi id="S4.SS2.SSS1.p1.9.m9.1.1" xref="S4.SS2.SSS1.p1.9.m9.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.9.m9.1b"><ci id="S4.SS2.SSS1.p1.9.m9.1.1.cmml" xref="S4.SS2.SSS1.p1.9.m9.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.9.m9.1c">C</annotation></semantics></math> classes, i.e. all clients solve the same task.</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.p2.1" class="ltx_p">Having specified the subset of classes per client, we distribute the data to the clients through the Round Robin (RR) algorithm <cite class="ltx_cite ltx_citemacro_citep">(Yang et al., <a href="#bib.bib33" title="" class="ltx_ref">2019</a>)</cite>, which distributes approximately equal-sized partitions of the data per class to each client; see Appendix <a href="#A1.SS2" title="A.2 Dataset splitting across clients ‣ Appendix A Experimental settings ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.2</span></a> for more details.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Test accuracy for Omniglot dataset on high degree of personalization. The average is measured by averaging the last 10 global rounds of the first 1000 global rounds.</figcaption>
<br class="ltx_break">
<table id="S4.T2.4.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T2.4.4.5.1" class="ltx_tr">
<th id="S4.T2.4.4.5.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.4.4.5.1.1.1" class="ltx_text" style="font-size:90%;">FedPer</span></th>
<th id="S4.T2.4.4.5.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.4.4.5.1.2.1" class="ltx_text" style="font-size:90%;">FedAvg</span></th>
<th id="S4.T2.4.4.5.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.4.4.5.1.3.1" class="ltx_text" style="font-size:90%;">FedRecon</span></th>
<th id="S4.T2.4.4.5.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="S4.T2.4.4.5.1.4.1" class="ltx_text" style="font-size:90%;">PFLEGO</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T2.4.4.4" class="ltx_tr">
<td id="S4.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S4.T2.1.1.1.1.1" class="ltx_text" style="font-size:90%;">68.02 </span><math id="S4.T2.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.1.1.1.1.m1.1a"><mo mathsize="90%" id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\pm</annotation></semantics></math><span id="S4.T2.1.1.1.1.2" class="ltx_text" style="font-size:90%;"> 1.74</span>
</td>
<td id="S4.T2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S4.T2.2.2.2.2.1" class="ltx_text" style="font-size:90%;">49.65 </span><math id="S4.T2.2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.2.2.2.2.m1.1a"><mo mathsize="90%" id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><csymbol cd="latexml" id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">\pm</annotation></semantics></math><span id="S4.T2.2.2.2.2.2" class="ltx_text" style="font-size:90%;"> 1.74</span>
</td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_bb">
<span id="S4.T2.3.3.3.3.1" class="ltx_text" style="font-size:90%;">74.06 </span><math id="S4.T2.3.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.3.3.3.3.m1.1a"><mo mathsize="90%" id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><csymbol cd="latexml" id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">\pm</annotation></semantics></math><span id="S4.T2.3.3.3.3.2" class="ltx_text" style="font-size:90%;"> 1.19</span>
</td>
<td id="S4.T2.4.4.4.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S4.T2.4.4.4.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">74.56 <math id="S4.T2.4.4.4.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S4.T2.4.4.4.4.1.m1.1a"><mo id="S4.T2.4.4.4.4.1.m1.1.1" xref="S4.T2.4.4.4.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.1.m1.1b"><csymbol cd="latexml" id="S4.T2.4.4.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.4.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.1.m1.1c">\pm</annotation></semantics></math> 1.23</span></td>
</tr>
</tbody>
</table>
</figure>
<section id="S4.SS2.SSS1.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Optimizers and hyperparameter search.</h5>

<div id="S4.SS2.SSS1.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.Px1.p1.2" class="ltx_p">Despite the theoretical advantages of plain SGD, in practice when running our PFLEGO algorithm we found out that it is more effective for the server update over <math id="S4.SS2.SSS1.Px1.p1.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.SS2.SSS1.Px1.p1.1.m1.1a"><mi id="S4.SS2.SSS1.Px1.p1.1.m1.1.1" xref="S4.SS2.SSS1.Px1.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px1.p1.1.m1.1b"><ci id="S4.SS2.SSS1.Px1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.Px1.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px1.p1.1.m1.1c">\theta</annotation></semantics></math> to apply the popular Adam optimizer <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib11" title="" class="ltx_ref">2014</a>)</cite>,
which (unlike simple SGD) uses parameter-wise learning rates and in practice accelerates convergence. Adam is appropriate to use for global parameter <math id="S4.SS2.SSS1.Px1.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.SS2.SSS1.Px1.p1.2.m2.1a"><mi id="S4.SS2.SSS1.Px1.p1.2.m2.1.1" xref="S4.SS2.SSS1.Px1.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px1.p1.2.m2.1b"><ci id="S4.SS2.SSS1.Px1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.Px1.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px1.p1.2.m2.1c">\theta</annotation></semantics></math> as it is straightforward for the server to store moving averages for the first and second moments of the gradients, as required by Adam <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib11" title="" class="ltx_ref">2014</a>)</cite>.</p>
</div>
<div id="S4.SS2.SSS1.Px1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.Px1.p2.1" class="ltx_p">In contrast, for the client specific parameters,
we use SGD. Also, for simplicity the clients apply gradient steps over their entire datasets, instead of sub-sampling subsets or minibatches, so that SGD reduces to gradient descent (GD).</p>
</div>
<div id="S4.SS2.SSS1.Px1.p3" class="ltx_para">
<p id="S4.SS2.SSS1.Px1.p3.2" class="ltx_p">Regarding hyperparameter values, we performed hyperparameter search for the base learning rate <math id="S4.SS2.SSS1.Px1.p3.1.m1.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S4.SS2.SSS1.Px1.p3.1.m1.1a"><mi id="S4.SS2.SSS1.Px1.p3.1.m1.1.1" xref="S4.SS2.SSS1.Px1.p3.1.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px1.p3.1.m1.1b"><ci id="S4.SS2.SSS1.Px1.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS1.Px1.p3.1.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px1.p3.1.m1.1c">\rho</annotation></semantics></math> of Adam needed in server updates, and the learning rate <math id="S4.SS2.SSS1.Px1.p3.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS2.SSS1.Px1.p3.2.m2.1a"><mi id="S4.SS2.SSS1.Px1.p3.2.m2.1.1" xref="S4.SS2.SSS1.Px1.p3.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.Px1.p3.2.m2.1b"><ci id="S4.SS2.SSS1.Px1.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS1.Px1.p3.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.Px1.p3.2.m2.1c">\beta</annotation></semantics></math> of simple GD in client updates; see details in the Appendix <a href="#A1.SS3" title="A.3 Hyperparameter selection ‣ Appendix A Experimental settings ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A.3</span></a>.</p>
</div>
</section>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Results

</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">We report <em id="S4.SS3.p1.1.1" class="ltx_emph ltx_font_italic">training loss</em> (given by (<a href="#S3.E1" title="Equation 1 ‣ 3.1.1 Training Objective for Classification ‣ 3.1 Personalized FL Setting ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>)) and <em id="S4.SS3.p1.1.2" class="ltx_emph ltx_font_italic">test accuracy</em> for the compared methods. Training loss allows to visualize how fast each FL algorithm optimizes the model, i.e. how many rounds are required, while test accuracy quantifies predictive classification performance. Results are averages over all clients.</p>
</div>
<section id="S4.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Discussion on the main results</h4>

<div id="S4.SS3.SSS1.p1" class="ltx_para">
<p id="S4.SS3.SSS1.p1.1" class="ltx_p">Table <a href="#S4.T1" title="Table 1 ‣ 4.1.1 Datasets description ‣ 4.1 Datasets and Model Architectures ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>
reports test accuracy scores for FedPer, FedAvg and our approach PFLEGO
for all datasets, except Omniglot, and degrees of personalization (high/medium/no personalization).
Table <a href="#S4.T2" title="Table 2 ‣ 4.2.1 Degree of personalization ‣ 4.2 Experimental Setup ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> reports the test accuracy for Omniglot. Each reported accuracy value and confidence interval is the mean of the corresponding values at the final 10 global rounds. We observe that our algorithm <span id="S4.SS3.SSS1.p1.1.1" class="ltx_text ltx_font_italic">has significantly higher accuracy from the other baselines for high degree of personalization</span>; see High-Pers columns in Table <a href="#S4.T1" title="Table 1 ‣ 4.1.1 Datasets description ‣ 4.1 Datasets and Model Architectures ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Omniglot results in Table <a href="#S4.T2" title="Table 2 ‣ 4.2.1 Degree of personalization ‣ 4.2 Experimental Setup ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. In the case of Medium-Pers, our algorithm has better performance than the baselines in all datasets except EMNIST.
Finally, as expected, in the case of low personalization,
FedAvg outperforms all methods. </p>
</div>
<div id="S4.SS3.SSS1.p2" class="ltx_para">
<p id="S4.SS3.SSS1.p2.1" class="ltx_p">To visualize optimization and learning speed,
Figure <a href="#S4.F3" title="Figure 3 ‣ 4.1.1 Datasets description ‣ 4.1 Datasets and Model Architectures ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows training loss and test accuracy
with respect to the number of rounds for MNIST and for different degrees of personalization. The corresponding plots for Fashion-MNIST, EMNIST and CIFAR-10 are included in the Supplementary Material.
Figure <a href="#S4.F2" title="Figure 2 ‣ 4.1.1 Datasets description ‣ 4.1 Datasets and Model Architectures ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>
plots the same quantities for the Omniglot dataset. These plots clearly
indicate that PFLEGO can require fewer communication rounds to minimize the overall training loss, and it faster achieves high classification accuracy in the high-personalized regime; see e.g. Figure <a href="#S4.F2" title="Figure 2 ‣ 4.1.1 Datasets description ‣ 4.1 Datasets and Model Architectures ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> for the Omniglot.</p>
</div>
<div id="S4.SS3.SSS1.p3" class="ltx_para">
<p id="S4.SS3.SSS1.p3.1" class="ltx_p">Further, for the most challenging Omniglot benchmark we also compare our approach with FedRecon <cite class="ltx_cite ltx_citemacro_citep">(Singhal et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite> which follows a stochastic block coordinate descent scheme, as opposed to our SGD approach. In Table <a href="#S4.T2" title="Table 2 ‣ 4.2.1 Degree of personalization ‣ 4.2 Experimental Setup ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> we include the test accuracy of FedRecon, from which we observe that our approach outperforms this baseline as well. See Appendix <a href="#A2.SS3" title="B.3 Experiments for FedRecon ‣ Appendix B Additional Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B.3</span></a> for more details.</p>
</div>
</section>
<section id="S4.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Effect of client learning rate and participation rate <math id="S4.SS3.SSS2.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS3.SSS2.1.m1.1b"><mi id="S4.SS3.SSS2.1.m1.1.1" xref="S4.SS3.SSS2.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.1.m1.1c"><ci id="S4.SS3.SSS2.1.m1.1.1.cmml" xref="S4.SS3.SSS2.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.1.m1.1d">r</annotation></semantics></math> </h4>

<section id="S4.SS3.SSS2.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Effect of learning rate.</h5>

<div id="S4.SS3.SSS2.Px1.p1" class="ltx_para">
<p id="S4.SS3.SSS2.Px1.p1.8" class="ltx_p">In Figure <a href="#S4.F4" title="Figure 4 ‣ 4.1.1 Datasets description ‣ 4.1 Datasets and Model Architectures ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>
we conduct an ablation to study the effect of the client learning rate <math id="S4.SS3.SSS2.Px1.p1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.SSS2.Px1.p1.1.m1.1a"><mi id="S4.SS3.SSS2.Px1.p1.1.m1.1.1" xref="S4.SS3.SSS2.Px1.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p1.1.m1.1b"><ci id="S4.SS3.SSS2.Px1.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p1.1.m1.1c">\beta</annotation></semantics></math> for PFLEGO, and for various values of the server learning rate value <math id="S4.SS3.SSS2.Px1.p1.2.m2.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S4.SS3.SSS2.Px1.p1.2.m2.1a"><mi id="S4.SS3.SSS2.Px1.p1.2.m2.1.1" xref="S4.SS3.SSS2.Px1.p1.2.m2.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p1.2.m2.1b"><ci id="S4.SS3.SSS2.Px1.p1.2.m2.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.2.m2.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p1.2.m2.1c">\rho</annotation></semantics></math> (i.e. the base rate in Adam). We observe that as <math id="S4.SS3.SSS2.Px1.p1.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.SSS2.Px1.p1.3.m3.1a"><mi id="S4.SS3.SSS2.Px1.p1.3.m3.1.1" xref="S4.SS3.SSS2.Px1.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p1.3.m3.1b"><ci id="S4.SS3.SSS2.Px1.p1.3.m3.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p1.3.m3.1c">\beta</annotation></semantics></math> increases we systematically obtain faster convergence. This well aligns with the observations in section 3.3 where we note that overall convergence can improve as long as the first <math id="S4.SS3.SSS2.Px1.p1.4.m4.1" class="ltx_Math" alttext="\tau-1" display="inline"><semantics id="S4.SS3.SSS2.Px1.p1.4.m4.1a"><mrow id="S4.SS3.SSS2.Px1.p1.4.m4.1.1" xref="S4.SS3.SSS2.Px1.p1.4.m4.1.1.cmml"><mi id="S4.SS3.SSS2.Px1.p1.4.m4.1.1.2" xref="S4.SS3.SSS2.Px1.p1.4.m4.1.1.2.cmml">τ</mi><mo id="S4.SS3.SSS2.Px1.p1.4.m4.1.1.1" xref="S4.SS3.SSS2.Px1.p1.4.m4.1.1.1.cmml">−</mo><mn id="S4.SS3.SSS2.Px1.p1.4.m4.1.1.3" xref="S4.SS3.SSS2.Px1.p1.4.m4.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p1.4.m4.1b"><apply id="S4.SS3.SSS2.Px1.p1.4.m4.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.4.m4.1.1"><minus id="S4.SS3.SSS2.Px1.p1.4.m4.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.4.m4.1.1.1"></minus><ci id="S4.SS3.SSS2.Px1.p1.4.m4.1.1.2.cmml" xref="S4.SS3.SSS2.Px1.p1.4.m4.1.1.2">𝜏</ci><cn type="integer" id="S4.SS3.SSS2.Px1.p1.4.m4.1.1.3.cmml" xref="S4.SS3.SSS2.Px1.p1.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p1.4.m4.1c">\tau-1</annotation></semantics></math> GD steps in the clients result in a deterministic improvement of the global loss in (<a href="#S3.E1" title="Equation 1 ‣ 3.1.1 Training Objective for Classification ‣ 3.1 Personalized FL Setting ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>), i.e. <math id="S4.SS3.SSS2.Px1.p1.5.m5.2" class="ltx_Math" alttext="\Delta\mathcal{L}=\mathcal{L}(\psi^{\text{after}\ \tau-1\ \text{steps}})-\mathcal{L}(\psi^{\text{init}})\leq 0" display="inline"><semantics id="S4.SS3.SSS2.Px1.p1.5.m5.2a"><mrow id="S4.SS3.SSS2.Px1.p1.5.m5.2.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.cmml"><mrow id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.cmml"><mi mathvariant="normal" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.1" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.3.cmml">ℒ</mi></mrow><mo id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.5" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.5.cmml">=</mo><mrow id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.cmml"><mrow id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.cmml"><mi id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.2.cmml">ψ</mi><mrow id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.cmml"><mrow id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.cmml"><mtext id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.2a.cmml">after</mtext><mo lspace="0.350em" rspace="0em" id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.1" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.1.cmml">​</mo><mi id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.3.cmml">τ</mi></mrow><mo id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.1" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.1.cmml">−</mo><mrow id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.cmml"><mn id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.350em" rspace="0em" id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.1" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mtext id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.3a.cmml">steps</mtext></mrow></mrow></msup><mo stretchy="false" id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.3.cmml">−</mo><mrow id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.2.cmml">​</mo><mrow id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.cmml">(</mo><msup id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.cmml"><mi id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.2" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.2.cmml">ψ</mi><mtext id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.3a.cmml">init</mtext></msup><mo stretchy="false" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.3" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.6" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.6.cmml">≤</mo><mn id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.7" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.7.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p1.5.m5.2b"><apply id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2"><and id="S4.SS3.SSS2.Px1.p1.5.m5.2.2a.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2"></and><apply id="S4.SS3.SSS2.Px1.p1.5.m5.2.2b.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2"><eq id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.5.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.5"></eq><apply id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4"><times id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.1.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.1"></times><ci id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.2">Δ</ci><ci id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.3.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.4.3">ℒ</ci></apply><apply id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2"><minus id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.3.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.3"></minus><apply id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1"><times id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.2"></times><ci id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.3.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.3">ℒ</ci><apply id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.2">𝜓</ci><apply id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3"><minus id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.1"></minus><apply id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2"><times id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.1"></times><ci id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.2a.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.2"><mtext mathsize="70%" id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.2">after</mtext></ci><ci id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.2.3">𝜏</ci></apply><apply id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3"><times id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.1"></times><cn type="integer" id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.3a.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.3"><mtext mathsize="70%" id="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.1.1.1.1.1.1.1.3.3.3">steps</mtext></ci></apply></apply></apply></apply><apply id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2"><times id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.2"></times><ci id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.3.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.3">ℒ</ci><apply id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1">superscript</csymbol><ci id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.2.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.2">𝜓</ci><ci id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.3a.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.3"><mtext mathsize="70%" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.3.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.2.1.1.1.3">init</mtext></ci></apply></apply></apply></apply><apply id="S4.SS3.SSS2.Px1.p1.5.m5.2.2c.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2"><leq id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.6.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.6"></leq><share href="#S4.SS3.SSS2.Px1.p1.5.m5.2.2.2.cmml" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2d.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2"></share><cn type="integer" id="S4.SS3.SSS2.Px1.p1.5.m5.2.2.7.cmml" xref="S4.SS3.SSS2.Px1.p1.5.m5.2.2.7">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p1.5.m5.2c">\Delta\mathcal{L}=\mathcal{L}(\psi^{\text{after}\ \tau-1\ \text{steps}})-\mathcal{L}(\psi^{\text{init}})\leq 0</annotation></semantics></math>. In fact, the more <math id="S4.SS3.SSS2.Px1.p1.6.m6.1" class="ltx_Math" alttext="\Delta\mathcal{L}\ll 0" display="inline"><semantics id="S4.SS3.SSS2.Px1.p1.6.m6.1a"><mrow id="S4.SS3.SSS2.Px1.p1.6.m6.1.1" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.cmml"><mrow id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.cmml"><mi mathvariant="normal" id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.2" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.1" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.1.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.3" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.3.cmml">ℒ</mi></mrow><mo id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.1" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.1.cmml">≪</mo><mn id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.3" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p1.6.m6.1b"><apply id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1"><csymbol cd="latexml" id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.1">much-less-than</csymbol><apply id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.cmml" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2"><times id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.1"></times><ci id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.2">Δ</ci><ci id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.3.cmml" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.2.3">ℒ</ci></apply><cn type="integer" id="S4.SS3.SSS2.Px1.p1.6.m6.1.1.3.cmml" xref="S4.SS3.SSS2.Px1.p1.6.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p1.6.m6.1c">\Delta\mathcal{L}\ll 0</annotation></semantics></math> the faster the convergence, and essentially this is what we evidence in Figure <a href="#S4.F4" title="Figure 4 ‣ 4.1.1 Datasets description ‣ 4.1 Datasets and Model Architectures ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. In practice, we could remove the need to specify <math id="S4.SS3.SSS2.Px1.p1.7.m7.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS3.SSS2.Px1.p1.7.m7.1a"><mi id="S4.SS3.SSS2.Px1.p1.7.m7.1.1" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p1.7.m7.1b"><ci id="S4.SS3.SSS2.Px1.p1.7.m7.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.7.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p1.7.m7.1c">\beta</annotation></semantics></math> in the GD update in (<a href="#S3.E4" title="Equation 4 ‣ Client side. ‣ 3.2.2 Client and Server Updates ‣ 3.2 The Proposed Algorithm ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) since the number of client parameters <math id="S4.SS3.SSS2.Px1.p1.8.m8.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="S4.SS3.SSS2.Px1.p1.8.m8.1a"><msub id="S4.SS3.SSS2.Px1.p1.8.m8.1.1" xref="S4.SS3.SSS2.Px1.p1.8.m8.1.1.cmml"><mi id="S4.SS3.SSS2.Px1.p1.8.m8.1.1.2" xref="S4.SS3.SSS2.Px1.p1.8.m8.1.1.2.cmml">W</mi><mi id="S4.SS3.SSS2.Px1.p1.8.m8.1.1.3" xref="S4.SS3.SSS2.Px1.p1.8.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px1.p1.8.m8.1b"><apply id="S4.SS3.SSS2.Px1.p1.8.m8.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.SS3.SSS2.Px1.p1.8.m8.1.1.1.cmml" xref="S4.SS3.SSS2.Px1.p1.8.m8.1.1">subscript</csymbol><ci id="S4.SS3.SSS2.Px1.p1.8.m8.1.1.2.cmml" xref="S4.SS3.SSS2.Px1.p1.8.m8.1.1.2">𝑊</ci><ci id="S4.SS3.SSS2.Px1.p1.8.m8.1.1.3.cmml" xref="S4.SS3.SSS2.Px1.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px1.p1.8.m8.1c">W_{i}</annotation></semantics></math> is rather small (e.g. the final weights in the NN), and therefore we could use an inexpensive second order Newton update. We leave the investigation for such more elaborate updates for future work.</p>
</div>
</section>
<section id="S4.SS3.SSS2.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Effect of participation rate <math id="S4.SS3.SSS2.Px2.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS3.SSS2.Px2.1.m1.1b"><mi id="S4.SS3.SSS2.Px2.1.m1.1.1" xref="S4.SS3.SSS2.Px2.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.1.m1.1c"><ci id="S4.SS3.SSS2.Px2.1.m1.1.1.cmml" xref="S4.SS3.SSS2.Px2.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.1.m1.1d">r</annotation></semantics></math>.</h5>

<div id="S4.SS3.SSS2.Px2.p1" class="ltx_para">
<p id="S4.SS3.SSS2.Px2.p1.10" class="ltx_p">Finally, we examine the effect of <em id="S4.SS3.SSS2.Px2.p1.1.1" class="ltx_emph ltx_font_italic">clients participation rate <math id="S4.SS3.SSS2.Px2.p1.1.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS3.SSS2.Px2.p1.1.1.m1.1a"><mi id="S4.SS3.SSS2.Px2.p1.1.1.m1.1.1" xref="S4.SS3.SSS2.Px2.p1.1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.p1.1.1.m1.1b"><ci id="S4.SS3.SSS2.Px2.p1.1.1.m1.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.p1.1.1.m1.1c">r</annotation></semantics></math></em>
in each optimization round, i.e. the average percentage
<math id="S4.SS3.SSS2.Px2.p1.2.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS3.SSS2.Px2.p1.2.m1.1a"><mi id="S4.SS3.SSS2.Px2.p1.2.m1.1.1" xref="S4.SS3.SSS2.Px2.p1.2.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.p1.2.m1.1b"><ci id="S4.SS3.SSS2.Px2.p1.2.m1.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.2.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.p1.2.m1.1c">r</annotation></semantics></math> of clients participating in each round where a single server update
is performed over
<math id="S4.SS3.SSS2.Px2.p1.3.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.SS3.SSS2.Px2.p1.3.m2.1a"><mi id="S4.SS3.SSS2.Px2.p1.3.m2.1.1" xref="S4.SS3.SSS2.Px2.p1.3.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.p1.3.m2.1b"><ci id="S4.SS3.SSS2.Px2.p1.3.m2.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.3.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.p1.3.m2.1c">\theta</annotation></semantics></math>. We consider <math id="S4.SS3.SSS2.Px2.p1.4.m3.4" class="ltx_Math" alttext="r\in\{20,40,60,100\}\%" display="inline"><semantics id="S4.SS3.SSS2.Px2.p1.4.m3.4a"><mrow id="S4.SS3.SSS2.Px2.p1.4.m3.4.5" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.cmml"><mi id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.2" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.2.cmml">r</mi><mo id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.1" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.1.cmml">∈</mo><mrow id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.cmml"><mrow id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.2" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.1.cmml"><mo stretchy="false" id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.2.1" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.1.cmml">{</mo><mn id="S4.SS3.SSS2.Px2.p1.4.m3.1.1" xref="S4.SS3.SSS2.Px2.p1.4.m3.1.1.cmml">20</mn><mo id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.2.2" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.1.cmml">,</mo><mn id="S4.SS3.SSS2.Px2.p1.4.m3.2.2" xref="S4.SS3.SSS2.Px2.p1.4.m3.2.2.cmml">40</mn><mo id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.2.3" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.1.cmml">,</mo><mn id="S4.SS3.SSS2.Px2.p1.4.m3.3.3" xref="S4.SS3.SSS2.Px2.p1.4.m3.3.3.cmml">60</mn><mo id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.2.4" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.1.cmml">,</mo><mn id="S4.SS3.SSS2.Px2.p1.4.m3.4.4" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.4.cmml">100</mn><mo stretchy="false" id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.2.5" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.1.cmml">}</mo></mrow><mo id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.1" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.p1.4.m3.4b"><apply id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.cmml" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5"><in id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.1.cmml" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.1"></in><ci id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.2.cmml" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.2">𝑟</ci><apply id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.cmml" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3"><csymbol cd="latexml" id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.1.cmml" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.1">percent</csymbol><set id="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.1.cmml" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.5.3.2.2"><cn type="integer" id="S4.SS3.SSS2.Px2.p1.4.m3.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.4.m3.1.1">20</cn><cn type="integer" id="S4.SS3.SSS2.Px2.p1.4.m3.2.2.cmml" xref="S4.SS3.SSS2.Px2.p1.4.m3.2.2">40</cn><cn type="integer" id="S4.SS3.SSS2.Px2.p1.4.m3.3.3.cmml" xref="S4.SS3.SSS2.Px2.p1.4.m3.3.3">60</cn><cn type="integer" id="S4.SS3.SSS2.Px2.p1.4.m3.4.4.cmml" xref="S4.SS3.SSS2.Px2.p1.4.m3.4.4">100</cn></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.p1.4.m3.4c">r\in\{20,40,60,100\}\%</annotation></semantics></math>.
We consider the CIFAR-10 dataset, with
<math id="S4.SS3.SSS2.Px2.p1.5.m4.1" class="ltx_Math" alttext="T=200" display="inline"><semantics id="S4.SS3.SSS2.Px2.p1.5.m4.1a"><mrow id="S4.SS3.SSS2.Px2.p1.5.m4.1.1" xref="S4.SS3.SSS2.Px2.p1.5.m4.1.1.cmml"><mi id="S4.SS3.SSS2.Px2.p1.5.m4.1.1.2" xref="S4.SS3.SSS2.Px2.p1.5.m4.1.1.2.cmml">T</mi><mo id="S4.SS3.SSS2.Px2.p1.5.m4.1.1.1" xref="S4.SS3.SSS2.Px2.p1.5.m4.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS2.Px2.p1.5.m4.1.1.3" xref="S4.SS3.SSS2.Px2.p1.5.m4.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.p1.5.m4.1b"><apply id="S4.SS3.SSS2.Px2.p1.5.m4.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.5.m4.1.1"><eq id="S4.SS3.SSS2.Px2.p1.5.m4.1.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.5.m4.1.1.1"></eq><ci id="S4.SS3.SSS2.Px2.p1.5.m4.1.1.2.cmml" xref="S4.SS3.SSS2.Px2.p1.5.m4.1.1.2">𝑇</ci><cn type="integer" id="S4.SS3.SSS2.Px2.p1.5.m4.1.1.3.cmml" xref="S4.SS3.SSS2.Px2.p1.5.m4.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.p1.5.m4.1c">T=200</annotation></semantics></math> rounds and
<math id="S4.SS3.SSS2.Px2.p1.6.m5.1" class="ltx_Math" alttext="\tau=50" display="inline"><semantics id="S4.SS3.SSS2.Px2.p1.6.m5.1a"><mrow id="S4.SS3.SSS2.Px2.p1.6.m5.1.1" xref="S4.SS3.SSS2.Px2.p1.6.m5.1.1.cmml"><mi id="S4.SS3.SSS2.Px2.p1.6.m5.1.1.2" xref="S4.SS3.SSS2.Px2.p1.6.m5.1.1.2.cmml">τ</mi><mo id="S4.SS3.SSS2.Px2.p1.6.m5.1.1.1" xref="S4.SS3.SSS2.Px2.p1.6.m5.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS2.Px2.p1.6.m5.1.1.3" xref="S4.SS3.SSS2.Px2.p1.6.m5.1.1.3.cmml">50</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.p1.6.m5.1b"><apply id="S4.SS3.SSS2.Px2.p1.6.m5.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.6.m5.1.1"><eq id="S4.SS3.SSS2.Px2.p1.6.m5.1.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.6.m5.1.1.1"></eq><ci id="S4.SS3.SSS2.Px2.p1.6.m5.1.1.2.cmml" xref="S4.SS3.SSS2.Px2.p1.6.m5.1.1.2">𝜏</ci><cn type="integer" id="S4.SS3.SSS2.Px2.p1.6.m5.1.1.3.cmml" xref="S4.SS3.SSS2.Px2.p1.6.m5.1.1.3">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.p1.6.m5.1c">\tau=50</annotation></semantics></math> inner client GD steps per round. The client learning rate for all algorithms is <math id="S4.SS3.SSS2.Px2.p1.7.m6.1" class="ltx_Math" alttext="\beta=0.001" display="inline"><semantics id="S4.SS3.SSS2.Px2.p1.7.m6.1a"><mrow id="S4.SS3.SSS2.Px2.p1.7.m6.1.1" xref="S4.SS3.SSS2.Px2.p1.7.m6.1.1.cmml"><mi id="S4.SS3.SSS2.Px2.p1.7.m6.1.1.2" xref="S4.SS3.SSS2.Px2.p1.7.m6.1.1.2.cmml">β</mi><mo id="S4.SS3.SSS2.Px2.p1.7.m6.1.1.1" xref="S4.SS3.SSS2.Px2.p1.7.m6.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS2.Px2.p1.7.m6.1.1.3" xref="S4.SS3.SSS2.Px2.p1.7.m6.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.p1.7.m6.1b"><apply id="S4.SS3.SSS2.Px2.p1.7.m6.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.7.m6.1.1"><eq id="S4.SS3.SSS2.Px2.p1.7.m6.1.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.7.m6.1.1.1"></eq><ci id="S4.SS3.SSS2.Px2.p1.7.m6.1.1.2.cmml" xref="S4.SS3.SSS2.Px2.p1.7.m6.1.1.2">𝛽</ci><cn type="float" id="S4.SS3.SSS2.Px2.p1.7.m6.1.1.3.cmml" xref="S4.SS3.SSS2.Px2.p1.7.m6.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.p1.7.m6.1c">\beta=0.001</annotation></semantics></math> while for PFLEGO the learning rate of the server is <math id="S4.SS3.SSS2.Px2.p1.8.m7.1" class="ltx_Math" alttext="\rho=0.001" display="inline"><semantics id="S4.SS3.SSS2.Px2.p1.8.m7.1a"><mrow id="S4.SS3.SSS2.Px2.p1.8.m7.1.1" xref="S4.SS3.SSS2.Px2.p1.8.m7.1.1.cmml"><mi id="S4.SS3.SSS2.Px2.p1.8.m7.1.1.2" xref="S4.SS3.SSS2.Px2.p1.8.m7.1.1.2.cmml">ρ</mi><mo id="S4.SS3.SSS2.Px2.p1.8.m7.1.1.1" xref="S4.SS3.SSS2.Px2.p1.8.m7.1.1.1.cmml">=</mo><mn id="S4.SS3.SSS2.Px2.p1.8.m7.1.1.3" xref="S4.SS3.SSS2.Px2.p1.8.m7.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.p1.8.m7.1b"><apply id="S4.SS3.SSS2.Px2.p1.8.m7.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.8.m7.1.1"><eq id="S4.SS3.SSS2.Px2.p1.8.m7.1.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.8.m7.1.1.1"></eq><ci id="S4.SS3.SSS2.Px2.p1.8.m7.1.1.2.cmml" xref="S4.SS3.SSS2.Px2.p1.8.m7.1.1.2">𝜌</ci><cn type="float" id="S4.SS3.SSS2.Px2.p1.8.m7.1.1.3.cmml" xref="S4.SS3.SSS2.Px2.p1.8.m7.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.p1.8.m7.1c">\rho=0.001</annotation></semantics></math>.
From Figure <a href="#S4.F5" title="Figure 5 ‣ 4.1.1 Datasets description ‣ 4.1 Datasets and Model Architectures ‣ 4 Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>
we observe that for FedAvg and FedPer, the convergence speed does not vary with <math id="S4.SS3.SSS2.Px2.p1.9.m8.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS3.SSS2.Px2.p1.9.m8.1a"><mi id="S4.SS3.SSS2.Px2.p1.9.m8.1.1" xref="S4.SS3.SSS2.Px2.p1.9.m8.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.p1.9.m8.1b"><ci id="S4.SS3.SSS2.Px2.p1.9.m8.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.9.m8.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.p1.9.m8.1c">r</annotation></semantics></math>, while for PFLEGO the optimization algorithm converges faster as <math id="S4.SS3.SSS2.Px2.p1.10.m9.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS3.SSS2.Px2.p1.10.m9.1a"><mi id="S4.SS3.SSS2.Px2.p1.10.m9.1.1" xref="S4.SS3.SSS2.Px2.p1.10.m9.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS2.Px2.p1.10.m9.1b"><ci id="S4.SS3.SSS2.Px2.p1.10.m9.1.1.cmml" xref="S4.SS3.SSS2.Px2.p1.10.m9.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS2.Px2.p1.10.m9.1c">r</annotation></semantics></math> increases.</p>
</div>
</section>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We propose PFLEGO, an algorithm for personalized FL with the unique, and novel to the best of our knowledge, property that it achieves exact SGD minimization of the total training loss. We rely on a NN architecture that includes shared and client-specific layers. We show rigorously that PFLEGO performs exact SGD-based optimization, where the stochasticity arises due to randomness in client participation, and therefore it achieves faster convergence and lower training loss than state-of-the-art alternatives such as FedAvg and FedPer. Importantly, PFLEGO’s advantage arises in regimes where a high degree of personalization is needed.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">In this work, the degree of personalization i.e. the overlap between the subsets of classes available to each client was assumed to be known a priori. If this were not known, a learning algorithm would need to be devised, which gradually learns the degree of personalization needed e.g through estimating similarity of tasks of different clients, so as to decide whether a personalization algorithm (e.g. PFLEGO) would be needed or not. In this work, we aimed at optimizing total training loss over clients. Another issue would be to elaborate on fairness aspects by ensuring similar loss across clients through a carefully selected objective function and subsequent decentralized FL process.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. (2019)</span>
<span class="ltx_bibblock">
Arivazhagan, M. G., Aggarwal, V., Singh, A. K., and Choudhary, S.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bottou (2010)</span>
<span class="ltx_bibblock">
Bottou, L.

</span>
<span class="ltx_bibblock">Large-scale machine learning with stochastic gradient descent.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of COMPSTAT’2010</em>, pp.  177–186. Springer,
2010.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caruana (1997)</span>
<span class="ltx_bibblock">
Caruana, R.

</span>
<span class="ltx_bibblock">Multitask learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Mach. Learn.</em>, 28(1):41–75, July 1997.

</span>
<span class="ltx_bibblock">ISSN 0885-6125.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2019)</span>
<span class="ltx_bibblock">
Chen, F., Luo, M., Dong, Z., Li, Z., and He, X.

</span>
<span class="ltx_bibblock">Federated meta-learning with fast convergence and efficient
communication, 2019.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2021)</span>
<span class="ltx_bibblock">
Chen, Y., Wang, J., Yu, C., Gao, W., and Qin, X.

</span>
<span class="ltx_bibblock">Fedhealth: A federated transfer learning framework for wearable
healthcare, 2021.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dinh et al. (2022)</span>
<span class="ltx_bibblock">
Dinh, C. T., Tran, N. H., and Nguyen, T. D.

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau envelopes, 2022.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fallah et al. (2020)</span>
<span class="ltx_bibblock">
Fallah, A., Mokhtari, A., and Ozdaglar, A.

</span>
<span class="ltx_bibblock">Personalized federated learning: A meta-learning approach, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finn et al. (2017)</span>
<span class="ltx_bibblock">
Finn, C., Abbeel, P., and Levine, S.

</span>
<span class="ltx_bibblock">Model-agnostic meta-learning for fast adaptation of deep networks,
2017.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hard et al. (2019)</span>
<span class="ltx_bibblock">
Hard, A., Rao, K., Mathews, R., Ramaswamy, S., Beaufays, F., Augenstein, S.,
Eichner, H., Kiddon, C., and Ramage, D.

</span>
<span class="ltx_bibblock">Federated learning for mobile keyboard prediction, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. (2019)</span>
<span class="ltx_bibblock">
Jiang, Y., Konečný, J., Rush, K., and Kannan, S.

</span>
<span class="ltx_bibblock">Improving federated learning personalization via model agnostic meta
learning, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2014)</span>
<span class="ltx_bibblock">
Kingma, D. P. and Ba, J.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization, 2014.

</span>
<span class="ltx_bibblock">cite arxiv:1412.6980.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečný et al. (2016)</span>
<span class="ltx_bibblock">
Konečný, J., McMahan, H. B., Ramage, D., and Richtárik, P.

</span>
<span class="ltx_bibblock">Federated optimization: Distributed machine learning for on-device
intelligence, 2016.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images, technical
report.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lake et al. (2015)</span>
<span class="ltx_bibblock">
Lake, B. M., Salakhutdinov, R., and Tenenbaum, J. B.

</span>
<span class="ltx_bibblock">Human-level concept learning through probabilistic program induction.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Science</em>, 350:1332 – 1338, 2015.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2021)</span>
<span class="ltx_bibblock">
Lee, S., Zheng, X., Hua, J., Vikalo, H., and Julien, C.

</span>
<span class="ltx_bibblock">Opportunistic federated learning: An exploration of egocentric
collaboration for pervasive computing applications, 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020a)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated learning: Challenges, methods, and future directions.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing Magazine</em>, 37(3):50–60, May 2020a.

</span>
<span class="ltx_bibblock">ISSN 1558-0792.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020b)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Feddane: A federated newton-type method, 2020b.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020c)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks, 2020c.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020d)</span>
<span class="ltx_bibblock">
Li, X., Huang, K., Yang, W., Wang, S., and Zhang, Z.

</span>
<span class="ltx_bibblock">On the convergence of fedavg on non-iid data, 2020d.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2019)</span>
<span class="ltx_bibblock">
Liu, W., Chen, L., Chen, Y., and Zhang, W.

</span>
<span class="ltx_bibblock">Accelerating federated learning via momentum gradient descent, 2019.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, H. B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ramaswamy et al. (2019)</span>
<span class="ltx_bibblock">
Ramaswamy, S., Mathews, R., Rao, K., and Beaufays, F.

</span>
<span class="ltx_bibblock">Federated learning for emoji prediction in a mobile keyboard, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2021)</span>
<span class="ltx_bibblock">
Reddi, S., Charles, Z., Zaheer, M., Garrett, Z., Rush, K., Konečný, J.,
Kumar, S., and McMahan, H. B.

</span>
<span class="ltx_bibblock">Adaptive federated optimization, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2020)</span>
<span class="ltx_bibblock">
Ren, J., Yu, G., and Ding, G.

</span>
<span class="ltx_bibblock">Accelerating dnn training in wireless federated edge learning
systems, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robbins &amp; Monro (1951)</span>
<span class="ltx_bibblock">
Robbins, H. and Monro, S.

</span>
<span class="ltx_bibblock">A Stochastic Approximation Method.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">The Annals of Mathematical Statistics</em>, 22(3):400–407, 1951.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ruder (2017)</span>
<span class="ltx_bibblock">
Ruder, S.

</span>
<span class="ltx_bibblock">An overview of multi-task learning in deep neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/1706.05098, 2017.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shamsian et al. (2021)</span>
<span class="ltx_bibblock">
Shamsian, A., Navon, A., Fetaya, E., and Chechik, G.

</span>
<span class="ltx_bibblock">Personalized federated learning using hypernetworks.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2103.04628</em>, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2020)</span>
<span class="ltx_bibblock">
Shen, S., Zhu, T., Wu, D., Wang, W., and Zhou, W.

</span>
<span class="ltx_bibblock">From distributed machine learning to federated learning: In the view
of data privacy and security.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Concurrency and Computation: Practice and Experience</em>, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singhal et al. (2021)</span>
<span class="ltx_bibblock">
Singhal, K., Sidahmed, H., Garrett, Z., Wu, S., Rush, K., and Prakash, S.

</span>
<span class="ltx_bibblock">Federated reconstruction: Partially local federated learning, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Wang, J., Liu, Q., Liang, H., Joshi, G., and Poor, H. V.

</span>
<span class="ltx_bibblock">Tackling the objective inconsistency problem in heterogeneous
federated optimization, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2019)</span>
<span class="ltx_bibblock">
Wang, K., Mathews, R., Kiddon, C., Eichner, H., Beaufays, F., and Ramage, D.

</span>
<span class="ltx_bibblock">Federated evaluation of on-device personalization, 2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2020)</span>
<span class="ltx_bibblock">
Wu, Q., Chen, X., Zhou, Z., and Zhang, J.

</span>
<span class="ltx_bibblock">Fedhome: Cloud-edge based personalized federated learning for in-home
health monitoring, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2019)</span>
<span class="ltx_bibblock">
Yang, H. H., Liu, Z., Quek, T. Q. S., and Poor, H. V.

</span>
<span class="ltx_bibblock">Scheduling policies for federated learning in wireless networks,
2019.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yao et al. (2020)</span>
<span class="ltx_bibblock">
Yao, X., Huang, T., Zhang, R.-X., Li, R., and Sun, L.

</span>
<span class="ltx_bibblock">Federated learning with unbiased gradient aggregation and
controllable meta updating, 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2019)</span>
<span class="ltx_bibblock">
Yu, H., Jin, R., and Yang, S.

</span>
<span class="ltx_bibblock">On the linear speedup analysis of communication efficient momentum
sgd for distributed non-convex optimization, 2019.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2021)</span>
<span class="ltx_bibblock">
Yu, T., Bagdasaryan, E., and Shmatikov, V.

</span>
<span class="ltx_bibblock">Salvaging federated learning by local adaptation, 2021.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experimental settings</h2>

<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Neural network architectures</h3>

<div id="A1.SS1.p1" class="ltx_para">
<p id="A1.SS1.p1.1" class="ltx_p">In Table <a href="#A1.T3" title="Table 3 ‣ A.1 Neural network architectures ‣ Appendix A Experimental settings ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> we present the architectures for MNIST, Fashion-MNIST, EMNIST, CIFAR-10 and Omniglot. We also provide an equivalent pictorial visualization of the used NN architectures; see Figure <a href="#A1.F6" title="Figure 6 ‣ A.1 Neural network architectures ‣ Appendix A Experimental settings ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
<figure id="A1.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Architecture details for all datasets. <math id="A1.T3.3.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="A1.T3.3.m1.1b"><mi id="A1.T3.3.m1.1.1" xref="A1.T3.3.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A1.T3.3.m1.1c"><ci id="A1.T3.3.m1.1.1.cmml" xref="A1.T3.3.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.3.m1.1d">B</annotation></semantics></math> denotes the number of data inputs to the neural network, <math id="A1.T3.4.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A1.T3.4.m2.1b"><mi id="A1.T3.4.m2.1.1" xref="A1.T3.4.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="A1.T3.4.m2.1c"><ci id="A1.T3.4.m2.1.1.cmml" xref="A1.T3.4.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.4.m2.1d">A</annotation></semantics></math> denotes the activation function</figcaption>
<br class="ltx_break">
<table id="A1.T3.64.60" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.T3.64.60.61.1" class="ltx_tr">
<th id="A1.T3.64.60.61.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="A1.T3.64.60.61.1.2" class="ltx_td ltx_align_center ltx_border_tt" colspan="3">MNIST, Fashion-MNIST and EMNIST</td>
</tr>
<tr id="A1.T3.64.60.62.2" class="ltx_tr">
<th id="A1.T3.64.60.62.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><em id="A1.T3.64.60.62.2.1.1" class="ltx_emph ltx_font_italic">Layer</em></th>
<td id="A1.T3.64.60.62.2.2" class="ltx_td ltx_align_center ltx_border_t"><em id="A1.T3.64.60.62.2.2.1" class="ltx_emph ltx_font_italic">Kernel details</em></td>
<td id="A1.T3.64.60.62.2.3" class="ltx_td ltx_align_center ltx_border_t"><em id="A1.T3.64.60.62.2.3.1" class="ltx_emph ltx_font_italic">Stride</em></td>
<td id="A1.T3.64.60.62.2.4" class="ltx_td ltx_align_center ltx_border_t">
<em id="A1.T3.64.60.62.2.4.1" class="ltx_emph ltx_font_italic">Output</em> shape</td>
</tr>
<tr id="A1.T3.7.3.3" class="ltx_tr">
<th id="A1.T3.7.3.3.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Input</th>
<td id="A1.T3.7.3.3.5" class="ltx_td ltx_align_center ltx_border_t">None</td>
<td id="A1.T3.7.3.3.6" class="ltx_td ltx_align_center ltx_border_t">None</td>
<td id="A1.T3.7.3.3.3" class="ltx_td ltx_align_center ltx_border_t">B<math id="A1.T3.5.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.5.1.1.1.m1.1a"><mo id="A1.T3.5.1.1.1.m1.1.1" xref="A1.T3.5.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.5.1.1.1.m1.1b"><times id="A1.T3.5.1.1.1.m1.1.1.cmml" xref="A1.T3.5.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.5.1.1.1.m1.1c">\times</annotation></semantics></math>28<math id="A1.T3.6.2.2.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.6.2.2.2.m2.1a"><mo id="A1.T3.6.2.2.2.m2.1.1" xref="A1.T3.6.2.2.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.6.2.2.2.m2.1b"><times id="A1.T3.6.2.2.2.m2.1.1.cmml" xref="A1.T3.6.2.2.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.6.2.2.2.m2.1c">\times</annotation></semantics></math>28<math id="A1.T3.7.3.3.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.7.3.3.3.m3.1a"><mo id="A1.T3.7.3.3.3.m3.1.1" xref="A1.T3.7.3.3.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.7.3.3.3.m3.1b"><times id="A1.T3.7.3.3.3.m3.1.1.cmml" xref="A1.T3.7.3.3.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.7.3.3.3.m3.1c">\times</annotation></semantics></math>1</td>
</tr>
<tr id="A1.T3.8.4.4" class="ltx_tr">
<th id="A1.T3.8.4.4.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">Flatten</th>
<td id="A1.T3.8.4.4.3" class="ltx_td ltx_align_center">784</td>
<td id="A1.T3.8.4.4.4" class="ltx_td ltx_align_center">None</td>
<td id="A1.T3.8.4.4.1" class="ltx_td ltx_align_center">B<math id="A1.T3.8.4.4.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.8.4.4.1.m1.1a"><mo id="A1.T3.8.4.4.1.m1.1.1" xref="A1.T3.8.4.4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.8.4.4.1.m1.1b"><times id="A1.T3.8.4.4.1.m1.1.1.cmml" xref="A1.T3.8.4.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.8.4.4.1.m1.1c">\times</annotation></semantics></math>784</td>
</tr>
<tr id="A1.T3.9.5.5" class="ltx_tr">
<th id="A1.T3.9.5.5.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">Dense</th>
<td id="A1.T3.9.5.5.3" class="ltx_td ltx_align_center">200, A=ReLU</td>
<td id="A1.T3.9.5.5.4" class="ltx_td ltx_align_center">None</td>
<td id="A1.T3.9.5.5.1" class="ltx_td ltx_align_center">B<math id="A1.T3.9.5.5.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.9.5.5.1.m1.1a"><mo id="A1.T3.9.5.5.1.m1.1.1" xref="A1.T3.9.5.5.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.9.5.5.1.m1.1b"><times id="A1.T3.9.5.5.1.m1.1.1.cmml" xref="A1.T3.9.5.5.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.9.5.5.1.m1.1c">\times</annotation></semantics></math>200</td>
</tr>
<tr id="A1.T3.10.6.6" class="ltx_tr">
<th id="A1.T3.10.6.6.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">Dense(classifier)</th>
<td id="A1.T3.10.6.6.3" class="ltx_td ltx_align_center">10</td>
<td id="A1.T3.10.6.6.4" class="ltx_td ltx_align_center">None</td>
<td id="A1.T3.10.6.6.1" class="ltx_td ltx_align_center">B<math id="A1.T3.10.6.6.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.10.6.6.1.m1.1a"><mo id="A1.T3.10.6.6.1.m1.1.1" xref="A1.T3.10.6.6.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.10.6.6.1.m1.1b"><times id="A1.T3.10.6.6.1.m1.1.1.cmml" xref="A1.T3.10.6.6.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.10.6.6.1.m1.1c">\times</annotation></semantics></math>10</td>
</tr>
<tr id="A1.T3.64.60.63.3" class="ltx_tr">
<th id="A1.T3.64.60.63.3.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<td id="A1.T3.64.60.63.3.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">CIFAR-10</td>
</tr>
<tr id="A1.T3.13.9.9" class="ltx_tr">
<th id="A1.T3.13.9.9.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Input</th>
<td id="A1.T3.13.9.9.5" class="ltx_td ltx_align_center ltx_border_t">None</td>
<td id="A1.T3.13.9.9.6" class="ltx_td ltx_align_center ltx_border_t">None</td>
<td id="A1.T3.13.9.9.3" class="ltx_td ltx_align_center ltx_border_t">B<math id="A1.T3.11.7.7.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.11.7.7.1.m1.1a"><mo id="A1.T3.11.7.7.1.m1.1.1" xref="A1.T3.11.7.7.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.11.7.7.1.m1.1b"><times id="A1.T3.11.7.7.1.m1.1.1.cmml" xref="A1.T3.11.7.7.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.11.7.7.1.m1.1c">\times</annotation></semantics></math>32<math id="A1.T3.12.8.8.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.12.8.8.2.m2.1a"><mo id="A1.T3.12.8.8.2.m2.1.1" xref="A1.T3.12.8.8.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.12.8.8.2.m2.1b"><times id="A1.T3.12.8.8.2.m2.1.1.cmml" xref="A1.T3.12.8.8.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.12.8.8.2.m2.1c">\times</annotation></semantics></math>32<math id="A1.T3.13.9.9.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.13.9.9.3.m3.1a"><mo id="A1.T3.13.9.9.3.m3.1.1" xref="A1.T3.13.9.9.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.13.9.9.3.m3.1b"><times id="A1.T3.13.9.9.3.m3.1.1.cmml" xref="A1.T3.13.9.9.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.13.9.9.3.m3.1c">\times</annotation></semantics></math>3</td>
</tr>
<tr id="A1.T3.17.13.13" class="ltx_tr">
<th id="A1.T3.17.13.13.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Conv1</th>
<td id="A1.T3.14.10.10.1" class="ltx_td ltx_align_center">F=64,K=5<math id="A1.T3.14.10.10.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.14.10.10.1.m1.1a"><mo id="A1.T3.14.10.10.1.m1.1.1" xref="A1.T3.14.10.10.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.14.10.10.1.m1.1b"><times id="A1.T3.14.10.10.1.m1.1.1.cmml" xref="A1.T3.14.10.10.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.14.10.10.1.m1.1c">\times</annotation></semantics></math>5,A=ReLU</td>
<td id="A1.T3.17.13.13.6" class="ltx_td ltx_align_center">1</td>
<td id="A1.T3.17.13.13.4" class="ltx_td ltx_align_center">B<math id="A1.T3.15.11.11.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.15.11.11.2.m1.1a"><mo id="A1.T3.15.11.11.2.m1.1.1" xref="A1.T3.15.11.11.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.15.11.11.2.m1.1b"><times id="A1.T3.15.11.11.2.m1.1.1.cmml" xref="A1.T3.15.11.11.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.15.11.11.2.m1.1c">\times</annotation></semantics></math>32<math id="A1.T3.16.12.12.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.16.12.12.3.m2.1a"><mo id="A1.T3.16.12.12.3.m2.1.1" xref="A1.T3.16.12.12.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.16.12.12.3.m2.1b"><times id="A1.T3.16.12.12.3.m2.1.1.cmml" xref="A1.T3.16.12.12.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.16.12.12.3.m2.1c">\times</annotation></semantics></math>32<math id="A1.T3.17.13.13.4.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.17.13.13.4.m3.1a"><mo id="A1.T3.17.13.13.4.m3.1.1" xref="A1.T3.17.13.13.4.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.17.13.13.4.m3.1b"><times id="A1.T3.17.13.13.4.m3.1.1.cmml" xref="A1.T3.17.13.13.4.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.17.13.13.4.m3.1c">\times</annotation></semantics></math>20</td>
</tr>
<tr id="A1.T3.20.16.16" class="ltx_tr">
<th id="A1.T3.20.16.16.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">Max Pool 1</th>
<td id="A1.T3.18.14.14.1" class="ltx_td ltx_align_center">K=3<math id="A1.T3.18.14.14.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.18.14.14.1.m1.1a"><mo id="A1.T3.18.14.14.1.m1.1.1" xref="A1.T3.18.14.14.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.18.14.14.1.m1.1b"><times id="A1.T3.18.14.14.1.m1.1.1.cmml" xref="A1.T3.18.14.14.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.18.14.14.1.m1.1c">\times</annotation></semantics></math>3</td>
<td id="A1.T3.20.16.16.5" class="ltx_td ltx_align_center">2</td>
<td id="A1.T3.20.16.16.3" class="ltx_td ltx_align_center">B<math id="A1.T3.19.15.15.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.19.15.15.2.m1.1a"><mo id="A1.T3.19.15.15.2.m1.1.1" xref="A1.T3.19.15.15.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.19.15.15.2.m1.1b"><times id="A1.T3.19.15.15.2.m1.1.1.cmml" xref="A1.T3.19.15.15.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.19.15.15.2.m1.1c">\times</annotation></semantics></math>16x16<math id="A1.T3.20.16.16.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.20.16.16.3.m2.1a"><mo id="A1.T3.20.16.16.3.m2.1.1" xref="A1.T3.20.16.16.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.20.16.16.3.m2.1b"><times id="A1.T3.20.16.16.3.m2.1.1.cmml" xref="A1.T3.20.16.16.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.20.16.16.3.m2.1c">\times</annotation></semantics></math>20</td>
</tr>
<tr id="A1.T3.23.19.19" class="ltx_tr">
<th id="A1.T3.23.19.19.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">Conv2</th>
<td id="A1.T3.21.17.17.1" class="ltx_td ltx_align_center">F=64,K=5<math id="A1.T3.21.17.17.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.21.17.17.1.m1.1a"><mo id="A1.T3.21.17.17.1.m1.1.1" xref="A1.T3.21.17.17.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.21.17.17.1.m1.1b"><times id="A1.T3.21.17.17.1.m1.1.1.cmml" xref="A1.T3.21.17.17.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.21.17.17.1.m1.1c">\times</annotation></semantics></math>5,A=ReLU</td>
<td id="A1.T3.23.19.19.5" class="ltx_td ltx_align_center">1</td>
<td id="A1.T3.23.19.19.3" class="ltx_td ltx_align_center">B<math id="A1.T3.22.18.18.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.22.18.18.2.m1.1a"><mo id="A1.T3.22.18.18.2.m1.1.1" xref="A1.T3.22.18.18.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.22.18.18.2.m1.1b"><times id="A1.T3.22.18.18.2.m1.1.1.cmml" xref="A1.T3.22.18.18.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.22.18.18.2.m1.1c">\times</annotation></semantics></math>16x16<math id="A1.T3.23.19.19.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.23.19.19.3.m2.1a"><mo id="A1.T3.23.19.19.3.m2.1.1" xref="A1.T3.23.19.19.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.23.19.19.3.m2.1b"><times id="A1.T3.23.19.19.3.m2.1.1.cmml" xref="A1.T3.23.19.19.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.23.19.19.3.m2.1c">\times</annotation></semantics></math>20</td>
</tr>
<tr id="A1.T3.27.23.23" class="ltx_tr">
<th id="A1.T3.27.23.23.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Max Pool 2</th>
<td id="A1.T3.24.20.20.1" class="ltx_td ltx_align_center">K=3<math id="A1.T3.24.20.20.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.24.20.20.1.m1.1a"><mo id="A1.T3.24.20.20.1.m1.1.1" xref="A1.T3.24.20.20.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.24.20.20.1.m1.1b"><times id="A1.T3.24.20.20.1.m1.1.1.cmml" xref="A1.T3.24.20.20.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.24.20.20.1.m1.1c">\times</annotation></semantics></math>3</td>
<td id="A1.T3.27.23.23.6" class="ltx_td ltx_align_center">2</td>
<td id="A1.T3.27.23.23.4" class="ltx_td ltx_align_center">B<math id="A1.T3.25.21.21.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.25.21.21.2.m1.1a"><mo id="A1.T3.25.21.21.2.m1.1.1" xref="A1.T3.25.21.21.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.25.21.21.2.m1.1b"><times id="A1.T3.25.21.21.2.m1.1.1.cmml" xref="A1.T3.25.21.21.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.25.21.21.2.m1.1c">\times</annotation></semantics></math>8<math id="A1.T3.26.22.22.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.26.22.22.3.m2.1a"><mo id="A1.T3.26.22.22.3.m2.1.1" xref="A1.T3.26.22.22.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.26.22.22.3.m2.1b"><times id="A1.T3.26.22.22.3.m2.1.1.cmml" xref="A1.T3.26.22.22.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.26.22.22.3.m2.1c">\times</annotation></semantics></math>8<math id="A1.T3.27.23.23.4.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.27.23.23.4.m3.1a"><mo id="A1.T3.27.23.23.4.m3.1.1" xref="A1.T3.27.23.23.4.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.27.23.23.4.m3.1b"><times id="A1.T3.27.23.23.4.m3.1.1.cmml" xref="A1.T3.27.23.23.4.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.27.23.23.4.m3.1c">\times</annotation></semantics></math>20</td>
</tr>
<tr id="A1.T3.28.24.24" class="ltx_tr">
<th id="A1.T3.28.24.24.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">Flatten</th>
<td id="A1.T3.28.24.24.3" class="ltx_td ltx_align_center">4096</td>
<td id="A1.T3.28.24.24.4" class="ltx_td ltx_align_center">None</td>
<td id="A1.T3.28.24.24.1" class="ltx_td ltx_align_center">B<math id="A1.T3.28.24.24.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.28.24.24.1.m1.1a"><mo id="A1.T3.28.24.24.1.m1.1.1" xref="A1.T3.28.24.24.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.28.24.24.1.m1.1b"><times id="A1.T3.28.24.24.1.m1.1.1.cmml" xref="A1.T3.28.24.24.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.28.24.24.1.m1.1c">\times</annotation></semantics></math>1280</td>
</tr>
<tr id="A1.T3.29.25.25" class="ltx_tr">
<th id="A1.T3.29.25.25.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">Dense</th>
<td id="A1.T3.29.25.25.3" class="ltx_td ltx_align_center">384,A=ReLU</td>
<td id="A1.T3.29.25.25.4" class="ltx_td ltx_align_center">None</td>
<td id="A1.T3.29.25.25.1" class="ltx_td ltx_align_center">B<math id="A1.T3.29.25.25.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.29.25.25.1.m1.1a"><mo id="A1.T3.29.25.25.1.m1.1.1" xref="A1.T3.29.25.25.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.29.25.25.1.m1.1b"><times id="A1.T3.29.25.25.1.m1.1.1.cmml" xref="A1.T3.29.25.25.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.29.25.25.1.m1.1c">\times</annotation></semantics></math>800</td>
</tr>
<tr id="A1.T3.30.26.26" class="ltx_tr">
<th id="A1.T3.30.26.26.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">Dense</th>
<td id="A1.T3.30.26.26.3" class="ltx_td ltx_align_center">192,A=ReLU</td>
<td id="A1.T3.30.26.26.4" class="ltx_td ltx_align_center">None</td>
<td id="A1.T3.30.26.26.1" class="ltx_td ltx_align_center">B<math id="A1.T3.30.26.26.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.30.26.26.1.m1.1a"><mo id="A1.T3.30.26.26.1.m1.1.1" xref="A1.T3.30.26.26.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.30.26.26.1.m1.1b"><times id="A1.T3.30.26.26.1.m1.1.1.cmml" xref="A1.T3.30.26.26.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.30.26.26.1.m1.1c">\times</annotation></semantics></math>500</td>
</tr>
<tr id="A1.T3.31.27.27" class="ltx_tr">
<th id="A1.T3.31.27.27.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">Dense(classifier)</th>
<td id="A1.T3.31.27.27.3" class="ltx_td ltx_align_center">10</td>
<td id="A1.T3.31.27.27.4" class="ltx_td ltx_align_center">None</td>
<td id="A1.T3.31.27.27.1" class="ltx_td ltx_align_center">B<math id="A1.T3.31.27.27.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.31.27.27.1.m1.1a"><mo id="A1.T3.31.27.27.1.m1.1.1" xref="A1.T3.31.27.27.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.31.27.27.1.m1.1b"><times id="A1.T3.31.27.27.1.m1.1.1.cmml" xref="A1.T3.31.27.27.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.31.27.27.1.m1.1c">\times</annotation></semantics></math>10</td>
</tr>
<tr id="A1.T3.64.60.64.4" class="ltx_tr">
<th id="A1.T3.64.60.64.4.1" class="ltx_td ltx_th ltx_th_row ltx_border_t"></th>
<td id="A1.T3.64.60.64.4.2" class="ltx_td ltx_align_center ltx_border_t" colspan="3">Omniglot</td>
</tr>
<tr id="A1.T3.34.30.30" class="ltx_tr">
<th id="A1.T3.34.30.30.4" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Input</th>
<td id="A1.T3.34.30.30.5" class="ltx_td ltx_align_center ltx_border_t">None</td>
<td id="A1.T3.34.30.30.6" class="ltx_td ltx_align_center ltx_border_t">None</td>
<td id="A1.T3.34.30.30.3" class="ltx_td ltx_align_center ltx_border_t">B<math id="A1.T3.32.28.28.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.32.28.28.1.m1.1a"><mo id="A1.T3.32.28.28.1.m1.1.1" xref="A1.T3.32.28.28.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.32.28.28.1.m1.1b"><times id="A1.T3.32.28.28.1.m1.1.1.cmml" xref="A1.T3.32.28.28.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.32.28.28.1.m1.1c">\times</annotation></semantics></math>28<math id="A1.T3.33.29.29.2.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.33.29.29.2.m2.1a"><mo id="A1.T3.33.29.29.2.m2.1.1" xref="A1.T3.33.29.29.2.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.33.29.29.2.m2.1b"><times id="A1.T3.33.29.29.2.m2.1.1.cmml" xref="A1.T3.33.29.29.2.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.33.29.29.2.m2.1c">\times</annotation></semantics></math>28<math id="A1.T3.34.30.30.3.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.34.30.30.3.m3.1a"><mo id="A1.T3.34.30.30.3.m3.1.1" xref="A1.T3.34.30.30.3.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.34.30.30.3.m3.1b"><times id="A1.T3.34.30.30.3.m3.1.1.cmml" xref="A1.T3.34.30.30.3.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.34.30.30.3.m3.1c">\times</annotation></semantics></math>1</td>
</tr>
<tr id="A1.T3.38.34.34" class="ltx_tr">
<th id="A1.T3.38.34.34.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Conv1</th>
<td id="A1.T3.35.31.31.1" class="ltx_td ltx_align_center">F=64,K=3<math id="A1.T3.35.31.31.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.35.31.31.1.m1.1a"><mo id="A1.T3.35.31.31.1.m1.1.1" xref="A1.T3.35.31.31.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.35.31.31.1.m1.1b"><times id="A1.T3.35.31.31.1.m1.1.1.cmml" xref="A1.T3.35.31.31.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.35.31.31.1.m1.1c">\times</annotation></semantics></math>3,A=ReLU</td>
<td id="A1.T3.38.34.34.6" class="ltx_td ltx_align_center">1</td>
<td id="A1.T3.38.34.34.4" class="ltx_td ltx_align_center">B<math id="A1.T3.36.32.32.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.36.32.32.2.m1.1a"><mo id="A1.T3.36.32.32.2.m1.1.1" xref="A1.T3.36.32.32.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.36.32.32.2.m1.1b"><times id="A1.T3.36.32.32.2.m1.1.1.cmml" xref="A1.T3.36.32.32.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.36.32.32.2.m1.1c">\times</annotation></semantics></math>28<math id="A1.T3.37.33.33.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.37.33.33.3.m2.1a"><mo id="A1.T3.37.33.33.3.m2.1.1" xref="A1.T3.37.33.33.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.37.33.33.3.m2.1b"><times id="A1.T3.37.33.33.3.m2.1.1.cmml" xref="A1.T3.37.33.33.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.37.33.33.3.m2.1c">\times</annotation></semantics></math>28<math id="A1.T3.38.34.34.4.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.38.34.34.4.m3.1a"><mo id="A1.T3.38.34.34.4.m3.1.1" xref="A1.T3.38.34.34.4.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.38.34.34.4.m3.1b"><times id="A1.T3.38.34.34.4.m3.1.1.cmml" xref="A1.T3.38.34.34.4.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.38.34.34.4.m3.1c">\times</annotation></semantics></math>64</td>
</tr>
<tr id="A1.T3.41.37.37" class="ltx_tr">
<th id="A1.T3.41.37.37.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">MaxPool1</th>
<td id="A1.T3.39.35.35.1" class="ltx_td ltx_align_center">K=2<math id="A1.T3.39.35.35.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.39.35.35.1.m1.1a"><mo id="A1.T3.39.35.35.1.m1.1.1" xref="A1.T3.39.35.35.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.39.35.35.1.m1.1b"><times id="A1.T3.39.35.35.1.m1.1.1.cmml" xref="A1.T3.39.35.35.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.39.35.35.1.m1.1c">\times</annotation></semantics></math>2</td>
<td id="A1.T3.41.37.37.5" class="ltx_td ltx_align_center">2</td>
<td id="A1.T3.41.37.37.3" class="ltx_td ltx_align_center">B<math id="A1.T3.40.36.36.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.40.36.36.2.m1.1a"><mo id="A1.T3.40.36.36.2.m1.1.1" xref="A1.T3.40.36.36.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.40.36.36.2.m1.1b"><times id="A1.T3.40.36.36.2.m1.1.1.cmml" xref="A1.T3.40.36.36.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.40.36.36.2.m1.1c">\times</annotation></semantics></math>14x14<math id="A1.T3.41.37.37.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.41.37.37.3.m2.1a"><mo id="A1.T3.41.37.37.3.m2.1.1" xref="A1.T3.41.37.37.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.41.37.37.3.m2.1b"><times id="A1.T3.41.37.37.3.m2.1.1.cmml" xref="A1.T3.41.37.37.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.41.37.37.3.m2.1c">\times</annotation></semantics></math>64</td>
</tr>
<tr id="A1.T3.45.41.41" class="ltx_tr">
<th id="A1.T3.45.41.41.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Conv2</th>
<td id="A1.T3.42.38.38.1" class="ltx_td ltx_align_center">F=64,K=3<math id="A1.T3.42.38.38.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.42.38.38.1.m1.1a"><mo id="A1.T3.42.38.38.1.m1.1.1" xref="A1.T3.42.38.38.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.42.38.38.1.m1.1b"><times id="A1.T3.42.38.38.1.m1.1.1.cmml" xref="A1.T3.42.38.38.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.42.38.38.1.m1.1c">\times</annotation></semantics></math>3,A=ReLU</td>
<td id="A1.T3.45.41.41.6" class="ltx_td ltx_align_center">1</td>
<td id="A1.T3.45.41.41.4" class="ltx_td ltx_align_center">B<math id="A1.T3.43.39.39.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.43.39.39.2.m1.1a"><mo id="A1.T3.43.39.39.2.m1.1.1" xref="A1.T3.43.39.39.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.43.39.39.2.m1.1b"><times id="A1.T3.43.39.39.2.m1.1.1.cmml" xref="A1.T3.43.39.39.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.43.39.39.2.m1.1c">\times</annotation></semantics></math>14<math id="A1.T3.44.40.40.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.44.40.40.3.m2.1a"><mo id="A1.T3.44.40.40.3.m2.1.1" xref="A1.T3.44.40.40.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.44.40.40.3.m2.1b"><times id="A1.T3.44.40.40.3.m2.1.1.cmml" xref="A1.T3.44.40.40.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.44.40.40.3.m2.1c">\times</annotation></semantics></math>14<math id="A1.T3.45.41.41.4.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.45.41.41.4.m3.1a"><mo id="A1.T3.45.41.41.4.m3.1.1" xref="A1.T3.45.41.41.4.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.45.41.41.4.m3.1b"><times id="A1.T3.45.41.41.4.m3.1.1.cmml" xref="A1.T3.45.41.41.4.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.45.41.41.4.m3.1c">\times</annotation></semantics></math>64</td>
</tr>
<tr id="A1.T3.48.44.44" class="ltx_tr">
<th id="A1.T3.48.44.44.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">MaxPool2</th>
<td id="A1.T3.46.42.42.1" class="ltx_td ltx_align_center">K=2<math id="A1.T3.46.42.42.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.46.42.42.1.m1.1a"><mo id="A1.T3.46.42.42.1.m1.1.1" xref="A1.T3.46.42.42.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.46.42.42.1.m1.1b"><times id="A1.T3.46.42.42.1.m1.1.1.cmml" xref="A1.T3.46.42.42.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.46.42.42.1.m1.1c">\times</annotation></semantics></math>2</td>
<td id="A1.T3.48.44.44.5" class="ltx_td ltx_align_center">2</td>
<td id="A1.T3.48.44.44.3" class="ltx_td ltx_align_center">B<math id="A1.T3.47.43.43.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.47.43.43.2.m1.1a"><mo id="A1.T3.47.43.43.2.m1.1.1" xref="A1.T3.47.43.43.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.47.43.43.2.m1.1b"><times id="A1.T3.47.43.43.2.m1.1.1.cmml" xref="A1.T3.47.43.43.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.47.43.43.2.m1.1c">\times</annotation></semantics></math>7x7<math id="A1.T3.48.44.44.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.48.44.44.3.m2.1a"><mo id="A1.T3.48.44.44.3.m2.1.1" xref="A1.T3.48.44.44.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.48.44.44.3.m2.1b"><times id="A1.T3.48.44.44.3.m2.1.1.cmml" xref="A1.T3.48.44.44.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.48.44.44.3.m2.1c">\times</annotation></semantics></math>64</td>
</tr>
<tr id="A1.T3.52.48.48" class="ltx_tr">
<th id="A1.T3.52.48.48.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Conv3</th>
<td id="A1.T3.49.45.45.1" class="ltx_td ltx_align_center">F=64,K=3<math id="A1.T3.49.45.45.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.49.45.45.1.m1.1a"><mo id="A1.T3.49.45.45.1.m1.1.1" xref="A1.T3.49.45.45.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.49.45.45.1.m1.1b"><times id="A1.T3.49.45.45.1.m1.1.1.cmml" xref="A1.T3.49.45.45.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.49.45.45.1.m1.1c">\times</annotation></semantics></math>3,A=ReLU</td>
<td id="A1.T3.52.48.48.6" class="ltx_td ltx_align_center">1</td>
<td id="A1.T3.52.48.48.4" class="ltx_td ltx_align_center">B<math id="A1.T3.50.46.46.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.50.46.46.2.m1.1a"><mo id="A1.T3.50.46.46.2.m1.1.1" xref="A1.T3.50.46.46.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.50.46.46.2.m1.1b"><times id="A1.T3.50.46.46.2.m1.1.1.cmml" xref="A1.T3.50.46.46.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.50.46.46.2.m1.1c">\times</annotation></semantics></math>7<math id="A1.T3.51.47.47.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.51.47.47.3.m2.1a"><mo id="A1.T3.51.47.47.3.m2.1.1" xref="A1.T3.51.47.47.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.51.47.47.3.m2.1b"><times id="A1.T3.51.47.47.3.m2.1.1.cmml" xref="A1.T3.51.47.47.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.51.47.47.3.m2.1c">\times</annotation></semantics></math>7<math id="A1.T3.52.48.48.4.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.52.48.48.4.m3.1a"><mo id="A1.T3.52.48.48.4.m3.1.1" xref="A1.T3.52.48.48.4.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.52.48.48.4.m3.1b"><times id="A1.T3.52.48.48.4.m3.1.1.cmml" xref="A1.T3.52.48.48.4.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.52.48.48.4.m3.1c">\times</annotation></semantics></math>64</td>
</tr>
<tr id="A1.T3.55.51.51" class="ltx_tr">
<th id="A1.T3.55.51.51.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">MaxPool3</th>
<td id="A1.T3.53.49.49.1" class="ltx_td ltx_align_center">K=2<math id="A1.T3.53.49.49.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.53.49.49.1.m1.1a"><mo id="A1.T3.53.49.49.1.m1.1.1" xref="A1.T3.53.49.49.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.53.49.49.1.m1.1b"><times id="A1.T3.53.49.49.1.m1.1.1.cmml" xref="A1.T3.53.49.49.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.53.49.49.1.m1.1c">\times</annotation></semantics></math>2</td>
<td id="A1.T3.55.51.51.5" class="ltx_td ltx_align_center">2</td>
<td id="A1.T3.55.51.51.3" class="ltx_td ltx_align_center">B<math id="A1.T3.54.50.50.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.54.50.50.2.m1.1a"><mo id="A1.T3.54.50.50.2.m1.1.1" xref="A1.T3.54.50.50.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.54.50.50.2.m1.1b"><times id="A1.T3.54.50.50.2.m1.1.1.cmml" xref="A1.T3.54.50.50.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.54.50.50.2.m1.1c">\times</annotation></semantics></math>3x3<math id="A1.T3.55.51.51.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.55.51.51.3.m2.1a"><mo id="A1.T3.55.51.51.3.m2.1.1" xref="A1.T3.55.51.51.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.55.51.51.3.m2.1b"><times id="A1.T3.55.51.51.3.m2.1.1.cmml" xref="A1.T3.55.51.51.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.55.51.51.3.m2.1c">\times</annotation></semantics></math>64</td>
</tr>
<tr id="A1.T3.59.55.55" class="ltx_tr">
<th id="A1.T3.59.55.55.5" class="ltx_td ltx_align_left ltx_th ltx_th_row">Conv4</th>
<td id="A1.T3.56.52.52.1" class="ltx_td ltx_align_center">F=64,K=3<math id="A1.T3.56.52.52.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.56.52.52.1.m1.1a"><mo id="A1.T3.56.52.52.1.m1.1.1" xref="A1.T3.56.52.52.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.56.52.52.1.m1.1b"><times id="A1.T3.56.52.52.1.m1.1.1.cmml" xref="A1.T3.56.52.52.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.56.52.52.1.m1.1c">\times</annotation></semantics></math>3,A=ReLU</td>
<td id="A1.T3.59.55.55.6" class="ltx_td ltx_align_center">1</td>
<td id="A1.T3.59.55.55.4" class="ltx_td ltx_align_center">B<math id="A1.T3.57.53.53.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.57.53.53.2.m1.1a"><mo id="A1.T3.57.53.53.2.m1.1.1" xref="A1.T3.57.53.53.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.57.53.53.2.m1.1b"><times id="A1.T3.57.53.53.2.m1.1.1.cmml" xref="A1.T3.57.53.53.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.57.53.53.2.m1.1c">\times</annotation></semantics></math>3<math id="A1.T3.58.54.54.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.58.54.54.3.m2.1a"><mo id="A1.T3.58.54.54.3.m2.1.1" xref="A1.T3.58.54.54.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.58.54.54.3.m2.1b"><times id="A1.T3.58.54.54.3.m2.1.1.cmml" xref="A1.T3.58.54.54.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.58.54.54.3.m2.1c">\times</annotation></semantics></math>3<math id="A1.T3.59.55.55.4.m3.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.59.55.55.4.m3.1a"><mo id="A1.T3.59.55.55.4.m3.1.1" xref="A1.T3.59.55.55.4.m3.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.59.55.55.4.m3.1b"><times id="A1.T3.59.55.55.4.m3.1.1.cmml" xref="A1.T3.59.55.55.4.m3.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.59.55.55.4.m3.1c">\times</annotation></semantics></math>64,A=ReLU</td>
</tr>
<tr id="A1.T3.62.58.58" class="ltx_tr">
<th id="A1.T3.62.58.58.4" class="ltx_td ltx_align_left ltx_th ltx_th_row">MaxPool4</th>
<td id="A1.T3.60.56.56.1" class="ltx_td ltx_align_center">K=2<math id="A1.T3.60.56.56.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.60.56.56.1.m1.1a"><mo id="A1.T3.60.56.56.1.m1.1.1" xref="A1.T3.60.56.56.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.60.56.56.1.m1.1b"><times id="A1.T3.60.56.56.1.m1.1.1.cmml" xref="A1.T3.60.56.56.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.60.56.56.1.m1.1c">\times</annotation></semantics></math>2</td>
<td id="A1.T3.62.58.58.5" class="ltx_td ltx_align_center">2</td>
<td id="A1.T3.62.58.58.3" class="ltx_td ltx_align_center">B<math id="A1.T3.61.57.57.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.61.57.57.2.m1.1a"><mo id="A1.T3.61.57.57.2.m1.1.1" xref="A1.T3.61.57.57.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.61.57.57.2.m1.1b"><times id="A1.T3.61.57.57.2.m1.1.1.cmml" xref="A1.T3.61.57.57.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.61.57.57.2.m1.1c">\times</annotation></semantics></math>1x1<math id="A1.T3.62.58.58.3.m2.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.62.58.58.3.m2.1a"><mo id="A1.T3.62.58.58.3.m2.1.1" xref="A1.T3.62.58.58.3.m2.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.62.58.58.3.m2.1b"><times id="A1.T3.62.58.58.3.m2.1.1.cmml" xref="A1.T3.62.58.58.3.m2.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.62.58.58.3.m2.1c">\times</annotation></semantics></math>64</td>
</tr>
<tr id="A1.T3.63.59.59" class="ltx_tr">
<th id="A1.T3.63.59.59.2" class="ltx_td ltx_align_left ltx_th ltx_th_row">Flatten</th>
<td id="A1.T3.63.59.59.3" class="ltx_td ltx_align_center">64</td>
<td id="A1.T3.63.59.59.4" class="ltx_td ltx_align_center">None</td>
<td id="A1.T3.63.59.59.1" class="ltx_td ltx_align_center">B<math id="A1.T3.63.59.59.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.63.59.59.1.m1.1a"><mo id="A1.T3.63.59.59.1.m1.1.1" xref="A1.T3.63.59.59.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.63.59.59.1.m1.1b"><times id="A1.T3.63.59.59.1.m1.1.1.cmml" xref="A1.T3.63.59.59.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.63.59.59.1.m1.1c">\times</annotation></semantics></math>64</td>
</tr>
<tr id="A1.T3.64.60.60" class="ltx_tr">
<th id="A1.T3.64.60.60.2" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb">Dense(classifier)</th>
<td id="A1.T3.64.60.60.3" class="ltx_td ltx_align_center ltx_border_bb">55</td>
<td id="A1.T3.64.60.60.4" class="ltx_td ltx_align_center ltx_border_bb">None</td>
<td id="A1.T3.64.60.60.1" class="ltx_td ltx_align_center ltx_border_bb">B<math id="A1.T3.64.60.60.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="A1.T3.64.60.60.1.m1.1a"><mo id="A1.T3.64.60.60.1.m1.1.1" xref="A1.T3.64.60.60.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="A1.T3.64.60.60.1.m1.1b"><times id="A1.T3.64.60.60.1.m1.1.1.cmml" xref="A1.T3.64.60.60.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.64.60.60.1.m1.1c">\times</annotation></semantics></math>55</td>
</tr>
</tbody>
</table>
</figure>
<div id="A1.SS1.p2" class="ltx_para">
<p id="A1.SS1.p2.1" class="ltx_p">In Table <a href="#A1.T4" title="Table 4 ‣ A.1 Neural network architectures ‣ Appendix A Experimental settings ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> we summarize the details of the different datasets.</p>
</div>
<figure id="A1.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Summary of dataset characteristics</figcaption>
<br class="ltx_break">
<table id="A1.T4.1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T4.1.1.1" class="ltx_tr">
<th id="A1.T4.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Dataset</th>
<th id="A1.T4.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Input Dimension</th>
<th id="A1.T4.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Labels</th>
<th id="A1.T4.1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Train set</th>
<th id="A1.T4.1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Test set</th>
<th id="A1.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Feat. vector units <math id="A1.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="A1.T4.1.1.1.1.m1.1a"><mi id="A1.T4.1.1.1.1.m1.1.1" xref="A1.T4.1.1.1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="A1.T4.1.1.1.1.m1.1b"><ci id="A1.T4.1.1.1.1.m1.1.1.cmml" xref="A1.T4.1.1.1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.T4.1.1.1.1.m1.1c">M</annotation></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T4.1.1.2.1" class="ltx_tr">
<td id="A1.T4.1.1.2.1.1" class="ltx_td ltx_align_center ltx_border_t">MNIST</td>
<td id="A1.T4.1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t">28x28x1</td>
<td id="A1.T4.1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">10</td>
<td id="A1.T4.1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">60,000</td>
<td id="A1.T4.1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">10,000</td>
<td id="A1.T4.1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">200</td>
</tr>
<tr id="A1.T4.1.1.3.2" class="ltx_tr">
<td id="A1.T4.1.1.3.2.1" class="ltx_td ltx_align_center">CIFAR-10</td>
<td id="A1.T4.1.1.3.2.2" class="ltx_td ltx_align_center">32x32x3</td>
<td id="A1.T4.1.1.3.2.3" class="ltx_td ltx_align_center">10</td>
<td id="A1.T4.1.1.3.2.4" class="ltx_td ltx_align_center">50,000</td>
<td id="A1.T4.1.1.3.2.5" class="ltx_td ltx_align_center">10,000</td>
<td id="A1.T4.1.1.3.2.6" class="ltx_td ltx_align_center">192</td>
</tr>
<tr id="A1.T4.1.1.4.3" class="ltx_tr">
<td id="A1.T4.1.1.4.3.1" class="ltx_td ltx_align_center">Fashion-MNIST</td>
<td id="A1.T4.1.1.4.3.2" class="ltx_td ltx_align_center">28x28x1</td>
<td id="A1.T4.1.1.4.3.3" class="ltx_td ltx_align_center">10</td>
<td id="A1.T4.1.1.4.3.4" class="ltx_td ltx_align_center">60,000</td>
<td id="A1.T4.1.1.4.3.5" class="ltx_td ltx_align_center">10,000</td>
<td id="A1.T4.1.1.4.3.6" class="ltx_td ltx_align_center">200</td>
</tr>
<tr id="A1.T4.1.1.5.4" class="ltx_tr">
<td id="A1.T4.1.1.5.4.1" class="ltx_td ltx_align_center">EMNIST</td>
<td id="A1.T4.1.1.5.4.2" class="ltx_td ltx_align_center">28x28x1</td>
<td id="A1.T4.1.1.5.4.3" class="ltx_td ltx_align_center">62</td>
<td id="A1.T4.1.1.5.4.4" class="ltx_td ltx_align_center">697,932</td>
<td id="A1.T4.1.1.5.4.5" class="ltx_td ltx_align_center">116,323</td>
<td id="A1.T4.1.1.5.4.6" class="ltx_td ltx_align_center">200</td>
</tr>
<tr id="A1.T4.1.1.6.5" class="ltx_tr">
<td id="A1.T4.1.1.6.5.1" class="ltx_td ltx_align_center ltx_border_bb">Omniglot</td>
<td id="A1.T4.1.1.6.5.2" class="ltx_td ltx_align_center ltx_border_bb">105x10x1</td>
<td id="A1.T4.1.1.6.5.3" class="ltx_td ltx_align_center ltx_border_bb">1623</td>
<td id="A1.T4.1.1.6.5.4" class="ltx_td ltx_align_center ltx_border_bb">19,280</td>
<td id="A1.T4.1.1.6.5.5" class="ltx_td ltx_align_center ltx_border_bb">13,180</td>
<td id="A1.T4.1.1.6.5.6" class="ltx_td ltx_align_center ltx_border_bb">64</td>
</tr>
</tbody>
</table>
</figure>
<figure id="A1.F6" class="ltx_figure">
<br class="ltx_break">
<table id="A1.F6.3.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.F6.3.3.3" class="ltx_tr">
<td id="A1.F6.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x18.png" id="A1.F6.1.1.1.1.g1" class="ltx_graphics ltx_img_square" width="62" height="62" alt="Refer to caption"></td>
<td id="A1.F6.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x19.png" id="A1.F6.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="184" height="113" alt="Refer to caption"></td>
<td id="A1.F6.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x20.png" id="A1.F6.3.3.3.3.g1" class="ltx_graphics ltx_img_portrait" width="85" height="184" alt="Refer to caption"></td>
</tr>
<tr id="A1.F6.3.3.4.1" class="ltx_tr">
<td id="A1.F6.3.3.4.1.1" class="ltx_td ltx_align_center">MNIST, Fashion-MNIST and EMNIST</td>
<td id="A1.F6.3.3.4.1.2" class="ltx_td ltx_align_center">Omniglot</td>
<td id="A1.F6.3.3.4.1.3" class="ltx_td ltx_align_center">CIFAR-10</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Model architectures. <span id="A1.F6.7.1" class="ltx_text ltx_font_bold">Left:</span> MLP architecture for MNIST, Fashion-MNIST and EMNIST; <span id="A1.F6.8.2" class="ltx_text ltx_font_bold">Middle:</span> 4-convolutional layer architecture for Omniglot; <span id="A1.F6.9.3" class="ltx_text ltx_font_bold">Right:</span> 2-convolutional layer architecture for CIFAR-10. </figcaption>
</figure>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Dataset splitting across clients</h3>

<div id="A1.SS2.p1" class="ltx_para">
<p id="A1.SS2.p1.1" class="ltx_p">In Figure <a href="#A1.F7" title="Figure 7 ‣ A.2 Dataset splitting across clients ‣ Appendix A Experimental settings ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>, we see an example assignment of 7 data points to 3 clients. We demonstrate a split in which all data points belong to the same class. In our work, each class is processed and distributed in the same manner. For instance, if we were to distribute the data points belonging in one class e.g. class with labels of 0, we would follow the procedure below: (a) shuffle all the data points of class 0, (b) filter all clients that were predetermined to contain the labels of class 0, (c) iterate through all filtered clients from step (b) and assign 1 data point to them. Step (c) is repeated in a cyclic manner until all data points are exhausted.</p>
</div>
<div id="A1.SS2.p2" class="ltx_para">
<p id="A1.SS2.p2.1" class="ltx_p">In our example, first, the 7 data points are randomly permuted; then we traverse the permuted sequence from left to right and assign one data point to each client in a cyclic manner until all examples are exhausted.
In contrast with random partition, RR does not require to shuffle the data samples first, however we do not omit the shuffling step of the data samples at the RR partition during our experiments.</p>
</div>
<figure id="A1.F7" class="ltx_figure">
<br class="ltx_break"><img src="/html/2202.09848/assets/x21.png" id="A1.F7.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="159" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Assignment of 7 data points to 3 clients with Round Robin partition</figcaption>
</figure>
</section>
<section id="A1.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.3 </span>Hyperparameter selection</h3>

<div id="A1.SS3.p1" class="ltx_para">
<p id="A1.SS3.p1.7" class="ltx_p">For MNIST, CIFAR-10, EMNIST, and Fashion-MNIST we perform an hyperparameter search for <math id="A1.SS3.p1.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.SS3.p1.1.m1.1a"><mi id="A1.SS3.p1.1.m1.1.1" xref="A1.SS3.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.1.m1.1b"><ci id="A1.SS3.p1.1.m1.1.1.cmml" xref="A1.SS3.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.1.m1.1c">\beta</annotation></semantics></math> in the set of values <math id="A1.SS3.p1.2.m2.4" class="ltx_Math" alttext="\{0.001,0.002,\ldots,0.007\}" display="inline"><semantics id="A1.SS3.p1.2.m2.4a"><mrow id="A1.SS3.p1.2.m2.4.5.2" xref="A1.SS3.p1.2.m2.4.5.1.cmml"><mo stretchy="false" id="A1.SS3.p1.2.m2.4.5.2.1" xref="A1.SS3.p1.2.m2.4.5.1.cmml">{</mo><mn id="A1.SS3.p1.2.m2.1.1" xref="A1.SS3.p1.2.m2.1.1.cmml">0.001</mn><mo id="A1.SS3.p1.2.m2.4.5.2.2" xref="A1.SS3.p1.2.m2.4.5.1.cmml">,</mo><mn id="A1.SS3.p1.2.m2.2.2" xref="A1.SS3.p1.2.m2.2.2.cmml">0.002</mn><mo id="A1.SS3.p1.2.m2.4.5.2.3" xref="A1.SS3.p1.2.m2.4.5.1.cmml">,</mo><mi mathvariant="normal" id="A1.SS3.p1.2.m2.3.3" xref="A1.SS3.p1.2.m2.3.3.cmml">…</mi><mo id="A1.SS3.p1.2.m2.4.5.2.4" xref="A1.SS3.p1.2.m2.4.5.1.cmml">,</mo><mn id="A1.SS3.p1.2.m2.4.4" xref="A1.SS3.p1.2.m2.4.4.cmml">0.007</mn><mo stretchy="false" id="A1.SS3.p1.2.m2.4.5.2.5" xref="A1.SS3.p1.2.m2.4.5.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.2.m2.4b"><set id="A1.SS3.p1.2.m2.4.5.1.cmml" xref="A1.SS3.p1.2.m2.4.5.2"><cn type="float" id="A1.SS3.p1.2.m2.1.1.cmml" xref="A1.SS3.p1.2.m2.1.1">0.001</cn><cn type="float" id="A1.SS3.p1.2.m2.2.2.cmml" xref="A1.SS3.p1.2.m2.2.2">0.002</cn><ci id="A1.SS3.p1.2.m2.3.3.cmml" xref="A1.SS3.p1.2.m2.3.3">…</ci><cn type="float" id="A1.SS3.p1.2.m2.4.4.cmml" xref="A1.SS3.p1.2.m2.4.4">0.007</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.2.m2.4c">\{0.001,0.002,\ldots,0.007\}</annotation></semantics></math>, and for <math id="A1.SS3.p1.3.m3.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="A1.SS3.p1.3.m3.1a"><mi id="A1.SS3.p1.3.m3.1.1" xref="A1.SS3.p1.3.m3.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.3.m3.1b"><ci id="A1.SS3.p1.3.m3.1.1.cmml" xref="A1.SS3.p1.3.m3.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.3.m3.1c">\rho</annotation></semantics></math> is in the set <math id="A1.SS3.p1.4.m4.3" class="ltx_Math" alttext="\{0.001,0.002,0.003\}" display="inline"><semantics id="A1.SS3.p1.4.m4.3a"><mrow id="A1.SS3.p1.4.m4.3.4.2" xref="A1.SS3.p1.4.m4.3.4.1.cmml"><mo stretchy="false" id="A1.SS3.p1.4.m4.3.4.2.1" xref="A1.SS3.p1.4.m4.3.4.1.cmml">{</mo><mn id="A1.SS3.p1.4.m4.1.1" xref="A1.SS3.p1.4.m4.1.1.cmml">0.001</mn><mo id="A1.SS3.p1.4.m4.3.4.2.2" xref="A1.SS3.p1.4.m4.3.4.1.cmml">,</mo><mn id="A1.SS3.p1.4.m4.2.2" xref="A1.SS3.p1.4.m4.2.2.cmml">0.002</mn><mo id="A1.SS3.p1.4.m4.3.4.2.3" xref="A1.SS3.p1.4.m4.3.4.1.cmml">,</mo><mn id="A1.SS3.p1.4.m4.3.3" xref="A1.SS3.p1.4.m4.3.3.cmml">0.003</mn><mo stretchy="false" id="A1.SS3.p1.4.m4.3.4.2.4" xref="A1.SS3.p1.4.m4.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.4.m4.3b"><set id="A1.SS3.p1.4.m4.3.4.1.cmml" xref="A1.SS3.p1.4.m4.3.4.2"><cn type="float" id="A1.SS3.p1.4.m4.1.1.cmml" xref="A1.SS3.p1.4.m4.1.1">0.001</cn><cn type="float" id="A1.SS3.p1.4.m4.2.2.cmml" xref="A1.SS3.p1.4.m4.2.2">0.002</cn><cn type="float" id="A1.SS3.p1.4.m4.3.3.cmml" xref="A1.SS3.p1.4.m4.3.3">0.003</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.4.m4.3c">\{0.001,0.002,0.003\}</annotation></semantics></math>. For Omniglot we further examine two additional values for <math id="A1.SS3.p1.5.m5.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A1.SS3.p1.5.m5.1a"><mi id="A1.SS3.p1.5.m5.1.1" xref="A1.SS3.p1.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.5.m5.1b"><ci id="A1.SS3.p1.5.m5.1.1.cmml" xref="A1.SS3.p1.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.5.m5.1c">\beta</annotation></semantics></math> of <math id="A1.SS3.p1.6.m6.2" class="ltx_Math" alttext="\{0.008,0.009\}" display="inline"><semantics id="A1.SS3.p1.6.m6.2a"><mrow id="A1.SS3.p1.6.m6.2.3.2" xref="A1.SS3.p1.6.m6.2.3.1.cmml"><mo stretchy="false" id="A1.SS3.p1.6.m6.2.3.2.1" xref="A1.SS3.p1.6.m6.2.3.1.cmml">{</mo><mn id="A1.SS3.p1.6.m6.1.1" xref="A1.SS3.p1.6.m6.1.1.cmml">0.008</mn><mo id="A1.SS3.p1.6.m6.2.3.2.2" xref="A1.SS3.p1.6.m6.2.3.1.cmml">,</mo><mn id="A1.SS3.p1.6.m6.2.2" xref="A1.SS3.p1.6.m6.2.2.cmml">0.009</mn><mo stretchy="false" id="A1.SS3.p1.6.m6.2.3.2.3" xref="A1.SS3.p1.6.m6.2.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.6.m6.2b"><set id="A1.SS3.p1.6.m6.2.3.1.cmml" xref="A1.SS3.p1.6.m6.2.3.2"><cn type="float" id="A1.SS3.p1.6.m6.1.1.cmml" xref="A1.SS3.p1.6.m6.1.1">0.008</cn><cn type="float" id="A1.SS3.p1.6.m6.2.2.cmml" xref="A1.SS3.p1.6.m6.2.2">0.009</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.6.m6.2c">\{0.008,0.009\}</annotation></semantics></math>. In Table <a href="#A1.T5" title="Table 5 ‣ A.3 Hyperparameter selection ‣ Appendix A Experimental settings ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> we give the values of the best hyperparameters for various degrees of personalization. In all experiments, the server samples <math id="A1.SS3.p1.7.m7.1" class="ltx_Math" alttext="20\%" display="inline"><semantics id="A1.SS3.p1.7.m7.1a"><mrow id="A1.SS3.p1.7.m7.1.1" xref="A1.SS3.p1.7.m7.1.1.cmml"><mn id="A1.SS3.p1.7.m7.1.1.2" xref="A1.SS3.p1.7.m7.1.1.2.cmml">20</mn><mo id="A1.SS3.p1.7.m7.1.1.1" xref="A1.SS3.p1.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS3.p1.7.m7.1b"><apply id="A1.SS3.p1.7.m7.1.1.cmml" xref="A1.SS3.p1.7.m7.1.1"><csymbol cd="latexml" id="A1.SS3.p1.7.m7.1.1.1.cmml" xref="A1.SS3.p1.7.m7.1.1.1">percent</csymbol><cn type="integer" id="A1.SS3.p1.7.m7.1.1.2.cmml" xref="A1.SS3.p1.7.m7.1.1.2">20</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS3.p1.7.m7.1c">20\%</annotation></semantics></math> of the clients in each round.</p>
</div>
<figure id="A1.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Best hyperparameters on various personalized settings.</figcaption>
<br class="ltx_break">
<div id="A1.T5.52.52" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:178.2pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-113.1pt,46.3pt) scale(0.657255182983931,0.657255182983931) ;">
<table id="A1.T5.52.52.52" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.T5.52.52.52.53.1" class="ltx_tr">
<th id="A1.T5.52.52.52.53.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="A1.T5.52.52.52.53.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="2">PFLEGO</th>
<td id="A1.T5.52.52.52.53.1.3" class="ltx_td ltx_border_tt"></td>
<td id="A1.T5.52.52.52.53.1.4" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">FedPer</td>
<td id="A1.T5.52.52.52.53.1.5" class="ltx_td ltx_border_tt"></td>
<td id="A1.T5.52.52.52.53.1.6" class="ltx_td ltx_align_center ltx_border_tt" colspan="2">FedAvg</td>
<td id="A1.T5.52.52.52.53.1.7" class="ltx_td ltx_border_tt"></td>
</tr>
<tr id="A1.T5.52.52.52.54.2" class="ltx_tr">
<th id="A1.T5.52.52.52.54.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row">Dataset</th>
<th id="A1.T5.52.52.52.54.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">Hyperparameters</th>
<td id="A1.T5.52.52.52.54.2.3" class="ltx_td ltx_align_center ltx_border_t">Personalization</td>
<td id="A1.T5.52.52.52.54.2.4" class="ltx_td"></td>
<td id="A1.T5.52.52.52.54.2.5" class="ltx_td ltx_align_center ltx_border_t">Hyperparameters</td>
<td id="A1.T5.52.52.52.54.2.6" class="ltx_td ltx_align_center ltx_border_t">Personalization</td>
<td id="A1.T5.52.52.52.54.2.7" class="ltx_td"></td>
<td id="A1.T5.52.52.52.54.2.8" class="ltx_td ltx_align_center ltx_border_t">Hyperparameters</td>
<td id="A1.T5.52.52.52.54.2.9" class="ltx_td ltx_align_center ltx_border_t">Personalization</td>
<td id="A1.T5.52.52.52.54.2.10" class="ltx_td"></td>
</tr>
<tr id="A1.T5.4.4.4.4" class="ltx_tr">
<th id="A1.T5.4.4.4.4.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">MNIST</th>
<th id="A1.T5.2.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">
<math id="A1.T5.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\beta=0.006" display="inline"><semantics id="A1.T5.1.1.1.1.1.m1.1a"><mrow id="A1.T5.1.1.1.1.1.m1.1.1" xref="A1.T5.1.1.1.1.1.m1.1.1.cmml"><mi id="A1.T5.1.1.1.1.1.m1.1.1.2" xref="A1.T5.1.1.1.1.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.1.1.1.1.1.m1.1.1.1" xref="A1.T5.1.1.1.1.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.1.1.1.1.1.m1.1.1.3" xref="A1.T5.1.1.1.1.1.m1.1.1.3.cmml">0.006</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.1.1.1.1.1.m1.1b"><apply id="A1.T5.1.1.1.1.1.m1.1.1.cmml" xref="A1.T5.1.1.1.1.1.m1.1.1"><eq id="A1.T5.1.1.1.1.1.m1.1.1.1.cmml" xref="A1.T5.1.1.1.1.1.m1.1.1.1"></eq><ci id="A1.T5.1.1.1.1.1.m1.1.1.2.cmml" xref="A1.T5.1.1.1.1.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.1.1.1.1.1.m1.1.1.3.cmml" xref="A1.T5.1.1.1.1.1.m1.1.1.3">0.006</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.1.1.1.1.1.m1.1c">\beta=0.006</annotation></semantics></math>,<math id="A1.T5.2.2.2.2.2.m2.1" class="ltx_Math" alttext="\rho=0.002" display="inline"><semantics id="A1.T5.2.2.2.2.2.m2.1a"><mrow id="A1.T5.2.2.2.2.2.m2.1.1" xref="A1.T5.2.2.2.2.2.m2.1.1.cmml"><mi id="A1.T5.2.2.2.2.2.m2.1.1.2" xref="A1.T5.2.2.2.2.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.2.2.2.2.2.m2.1.1.1" xref="A1.T5.2.2.2.2.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.2.2.2.2.2.m2.1.1.3" xref="A1.T5.2.2.2.2.2.m2.1.1.3.cmml">0.002</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.2.2.2.2.2.m2.1b"><apply id="A1.T5.2.2.2.2.2.m2.1.1.cmml" xref="A1.T5.2.2.2.2.2.m2.1.1"><eq id="A1.T5.2.2.2.2.2.m2.1.1.1.cmml" xref="A1.T5.2.2.2.2.2.m2.1.1.1"></eq><ci id="A1.T5.2.2.2.2.2.m2.1.1.2.cmml" xref="A1.T5.2.2.2.2.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.2.2.2.2.2.m2.1.1.3.cmml" xref="A1.T5.2.2.2.2.2.m2.1.1.3">0.002</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.2.2.2.2.2.m2.1c">\rho=0.002</annotation></semantics></math>
</th>
<td id="A1.T5.4.4.4.4.6" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.4.4.4.4.7" class="ltx_td ltx_border_t"></td>
<td id="A1.T5.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T5.3.3.3.3.3.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.3.3.3.3.3.m1.1a"><mrow id="A1.T5.3.3.3.3.3.m1.1.1" xref="A1.T5.3.3.3.3.3.m1.1.1.cmml"><mi id="A1.T5.3.3.3.3.3.m1.1.1.2" xref="A1.T5.3.3.3.3.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.3.3.3.3.3.m1.1.1.1" xref="A1.T5.3.3.3.3.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.3.3.3.3.3.m1.1.1.3" xref="A1.T5.3.3.3.3.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.3.3.3.3.3.m1.1b"><apply id="A1.T5.3.3.3.3.3.m1.1.1.cmml" xref="A1.T5.3.3.3.3.3.m1.1.1"><eq id="A1.T5.3.3.3.3.3.m1.1.1.1.cmml" xref="A1.T5.3.3.3.3.3.m1.1.1.1"></eq><ci id="A1.T5.3.3.3.3.3.m1.1.1.2.cmml" xref="A1.T5.3.3.3.3.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.3.3.3.3.3.m1.1.1.3.cmml" xref="A1.T5.3.3.3.3.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.3.3.3.3.3.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.4.4.4.4.8" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.4.4.4.4.9" class="ltx_td ltx_border_t"></td>
<td id="A1.T5.4.4.4.4.4" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T5.4.4.4.4.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.4.4.4.4.4.m1.1a"><mrow id="A1.T5.4.4.4.4.4.m1.1.1" xref="A1.T5.4.4.4.4.4.m1.1.1.cmml"><mi id="A1.T5.4.4.4.4.4.m1.1.1.2" xref="A1.T5.4.4.4.4.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.4.4.4.4.4.m1.1.1.1" xref="A1.T5.4.4.4.4.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.4.4.4.4.4.m1.1.1.3" xref="A1.T5.4.4.4.4.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.4.4.4.4.4.m1.1b"><apply id="A1.T5.4.4.4.4.4.m1.1.1.cmml" xref="A1.T5.4.4.4.4.4.m1.1.1"><eq id="A1.T5.4.4.4.4.4.m1.1.1.1.cmml" xref="A1.T5.4.4.4.4.4.m1.1.1.1"></eq><ci id="A1.T5.4.4.4.4.4.m1.1.1.2.cmml" xref="A1.T5.4.4.4.4.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.4.4.4.4.4.m1.1.1.3.cmml" xref="A1.T5.4.4.4.4.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.4.4.4.4.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.4.4.4.4.10" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.4.4.4.4.11" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="A1.T5.8.8.8.8" class="ltx_tr">
<th id="A1.T5.8.8.8.8.5" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A1.T5.6.6.6.6.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<math id="A1.T5.5.5.5.5.1.m1.1" class="ltx_Math" alttext="\beta=0.006" display="inline"><semantics id="A1.T5.5.5.5.5.1.m1.1a"><mrow id="A1.T5.5.5.5.5.1.m1.1.1" xref="A1.T5.5.5.5.5.1.m1.1.1.cmml"><mi id="A1.T5.5.5.5.5.1.m1.1.1.2" xref="A1.T5.5.5.5.5.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.5.5.5.5.1.m1.1.1.1" xref="A1.T5.5.5.5.5.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.5.5.5.5.1.m1.1.1.3" xref="A1.T5.5.5.5.5.1.m1.1.1.3.cmml">0.006</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.5.5.5.5.1.m1.1b"><apply id="A1.T5.5.5.5.5.1.m1.1.1.cmml" xref="A1.T5.5.5.5.5.1.m1.1.1"><eq id="A1.T5.5.5.5.5.1.m1.1.1.1.cmml" xref="A1.T5.5.5.5.5.1.m1.1.1.1"></eq><ci id="A1.T5.5.5.5.5.1.m1.1.1.2.cmml" xref="A1.T5.5.5.5.5.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.5.5.5.5.1.m1.1.1.3.cmml" xref="A1.T5.5.5.5.5.1.m1.1.1.3">0.006</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.5.5.5.5.1.m1.1c">\beta=0.006</annotation></semantics></math>,<math id="A1.T5.6.6.6.6.2.m2.1" class="ltx_Math" alttext="\rho=0.003" display="inline"><semantics id="A1.T5.6.6.6.6.2.m2.1a"><mrow id="A1.T5.6.6.6.6.2.m2.1.1" xref="A1.T5.6.6.6.6.2.m2.1.1.cmml"><mi id="A1.T5.6.6.6.6.2.m2.1.1.2" xref="A1.T5.6.6.6.6.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.6.6.6.6.2.m2.1.1.1" xref="A1.T5.6.6.6.6.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.6.6.6.6.2.m2.1.1.3" xref="A1.T5.6.6.6.6.2.m2.1.1.3.cmml">0.003</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.6.6.6.6.2.m2.1b"><apply id="A1.T5.6.6.6.6.2.m2.1.1.cmml" xref="A1.T5.6.6.6.6.2.m2.1.1"><eq id="A1.T5.6.6.6.6.2.m2.1.1.1.cmml" xref="A1.T5.6.6.6.6.2.m2.1.1.1"></eq><ci id="A1.T5.6.6.6.6.2.m2.1.1.2.cmml" xref="A1.T5.6.6.6.6.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.6.6.6.6.2.m2.1.1.3.cmml" xref="A1.T5.6.6.6.6.2.m2.1.1.3">0.003</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.6.6.6.6.2.m2.1c">\rho=0.003</annotation></semantics></math>
</th>
<td id="A1.T5.8.8.8.8.6" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.8.8.8.8.7" class="ltx_td"></td>
<td id="A1.T5.7.7.7.7.3" class="ltx_td ltx_align_center"><math id="A1.T5.7.7.7.7.3.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.7.7.7.7.3.m1.1a"><mrow id="A1.T5.7.7.7.7.3.m1.1.1" xref="A1.T5.7.7.7.7.3.m1.1.1.cmml"><mi id="A1.T5.7.7.7.7.3.m1.1.1.2" xref="A1.T5.7.7.7.7.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.7.7.7.7.3.m1.1.1.1" xref="A1.T5.7.7.7.7.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.7.7.7.7.3.m1.1.1.3" xref="A1.T5.7.7.7.7.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.7.7.7.7.3.m1.1b"><apply id="A1.T5.7.7.7.7.3.m1.1.1.cmml" xref="A1.T5.7.7.7.7.3.m1.1.1"><eq id="A1.T5.7.7.7.7.3.m1.1.1.1.cmml" xref="A1.T5.7.7.7.7.3.m1.1.1.1"></eq><ci id="A1.T5.7.7.7.7.3.m1.1.1.2.cmml" xref="A1.T5.7.7.7.7.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.7.7.7.7.3.m1.1.1.3.cmml" xref="A1.T5.7.7.7.7.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.7.7.7.7.3.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.8.8.8.8.8" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.8.8.8.8.9" class="ltx_td"></td>
<td id="A1.T5.8.8.8.8.4" class="ltx_td ltx_align_center"><math id="A1.T5.8.8.8.8.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.8.8.8.8.4.m1.1a"><mrow id="A1.T5.8.8.8.8.4.m1.1.1" xref="A1.T5.8.8.8.8.4.m1.1.1.cmml"><mi id="A1.T5.8.8.8.8.4.m1.1.1.2" xref="A1.T5.8.8.8.8.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.8.8.8.8.4.m1.1.1.1" xref="A1.T5.8.8.8.8.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.8.8.8.8.4.m1.1.1.3" xref="A1.T5.8.8.8.8.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.8.8.8.8.4.m1.1b"><apply id="A1.T5.8.8.8.8.4.m1.1.1.cmml" xref="A1.T5.8.8.8.8.4.m1.1.1"><eq id="A1.T5.8.8.8.8.4.m1.1.1.1.cmml" xref="A1.T5.8.8.8.8.4.m1.1.1.1"></eq><ci id="A1.T5.8.8.8.8.4.m1.1.1.2.cmml" xref="A1.T5.8.8.8.8.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.8.8.8.8.4.m1.1.1.3.cmml" xref="A1.T5.8.8.8.8.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.8.8.8.8.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.8.8.8.8.10" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.8.8.8.8.11" class="ltx_td"></td>
</tr>
<tr id="A1.T5.12.12.12.12" class="ltx_tr">
<th id="A1.T5.12.12.12.12.5" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A1.T5.10.10.10.10.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<math id="A1.T5.9.9.9.9.1.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.9.9.9.9.1.m1.1a"><mrow id="A1.T5.9.9.9.9.1.m1.1.1" xref="A1.T5.9.9.9.9.1.m1.1.1.cmml"><mi id="A1.T5.9.9.9.9.1.m1.1.1.2" xref="A1.T5.9.9.9.9.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.9.9.9.9.1.m1.1.1.1" xref="A1.T5.9.9.9.9.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.9.9.9.9.1.m1.1.1.3" xref="A1.T5.9.9.9.9.1.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.9.9.9.9.1.m1.1b"><apply id="A1.T5.9.9.9.9.1.m1.1.1.cmml" xref="A1.T5.9.9.9.9.1.m1.1.1"><eq id="A1.T5.9.9.9.9.1.m1.1.1.1.cmml" xref="A1.T5.9.9.9.9.1.m1.1.1.1"></eq><ci id="A1.T5.9.9.9.9.1.m1.1.1.2.cmml" xref="A1.T5.9.9.9.9.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.9.9.9.9.1.m1.1.1.3.cmml" xref="A1.T5.9.9.9.9.1.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.9.9.9.9.1.m1.1c">\beta=0.007</annotation></semantics></math>,<math id="A1.T5.10.10.10.10.2.m2.1" class="ltx_Math" alttext="\rho=0.003" display="inline"><semantics id="A1.T5.10.10.10.10.2.m2.1a"><mrow id="A1.T5.10.10.10.10.2.m2.1.1" xref="A1.T5.10.10.10.10.2.m2.1.1.cmml"><mi id="A1.T5.10.10.10.10.2.m2.1.1.2" xref="A1.T5.10.10.10.10.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.10.10.10.10.2.m2.1.1.1" xref="A1.T5.10.10.10.10.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.10.10.10.10.2.m2.1.1.3" xref="A1.T5.10.10.10.10.2.m2.1.1.3.cmml">0.003</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.10.10.10.10.2.m2.1b"><apply id="A1.T5.10.10.10.10.2.m2.1.1.cmml" xref="A1.T5.10.10.10.10.2.m2.1.1"><eq id="A1.T5.10.10.10.10.2.m2.1.1.1.cmml" xref="A1.T5.10.10.10.10.2.m2.1.1.1"></eq><ci id="A1.T5.10.10.10.10.2.m2.1.1.2.cmml" xref="A1.T5.10.10.10.10.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.10.10.10.10.2.m2.1.1.3.cmml" xref="A1.T5.10.10.10.10.2.m2.1.1.3">0.003</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.10.10.10.10.2.m2.1c">\rho=0.003</annotation></semantics></math>
</th>
<td id="A1.T5.12.12.12.12.6" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.12.12.12.12.7" class="ltx_td"></td>
<td id="A1.T5.11.11.11.11.3" class="ltx_td ltx_align_center"><math id="A1.T5.11.11.11.11.3.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.11.11.11.11.3.m1.1a"><mrow id="A1.T5.11.11.11.11.3.m1.1.1" xref="A1.T5.11.11.11.11.3.m1.1.1.cmml"><mi id="A1.T5.11.11.11.11.3.m1.1.1.2" xref="A1.T5.11.11.11.11.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.11.11.11.11.3.m1.1.1.1" xref="A1.T5.11.11.11.11.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.11.11.11.11.3.m1.1.1.3" xref="A1.T5.11.11.11.11.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.11.11.11.11.3.m1.1b"><apply id="A1.T5.11.11.11.11.3.m1.1.1.cmml" xref="A1.T5.11.11.11.11.3.m1.1.1"><eq id="A1.T5.11.11.11.11.3.m1.1.1.1.cmml" xref="A1.T5.11.11.11.11.3.m1.1.1.1"></eq><ci id="A1.T5.11.11.11.11.3.m1.1.1.2.cmml" xref="A1.T5.11.11.11.11.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.11.11.11.11.3.m1.1.1.3.cmml" xref="A1.T5.11.11.11.11.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.11.11.11.11.3.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.12.12.12.12.8" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.12.12.12.12.9" class="ltx_td"></td>
<td id="A1.T5.12.12.12.12.4" class="ltx_td ltx_align_center"><math id="A1.T5.12.12.12.12.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.12.12.12.12.4.m1.1a"><mrow id="A1.T5.12.12.12.12.4.m1.1.1" xref="A1.T5.12.12.12.12.4.m1.1.1.cmml"><mi id="A1.T5.12.12.12.12.4.m1.1.1.2" xref="A1.T5.12.12.12.12.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.12.12.12.12.4.m1.1.1.1" xref="A1.T5.12.12.12.12.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.12.12.12.12.4.m1.1.1.3" xref="A1.T5.12.12.12.12.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.12.12.12.12.4.m1.1b"><apply id="A1.T5.12.12.12.12.4.m1.1.1.cmml" xref="A1.T5.12.12.12.12.4.m1.1.1"><eq id="A1.T5.12.12.12.12.4.m1.1.1.1.cmml" xref="A1.T5.12.12.12.12.4.m1.1.1.1"></eq><ci id="A1.T5.12.12.12.12.4.m1.1.1.2.cmml" xref="A1.T5.12.12.12.12.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.12.12.12.12.4.m1.1.1.3.cmml" xref="A1.T5.12.12.12.12.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.12.12.12.12.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.12.12.12.12.10" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.12.12.12.12.11" class="ltx_td"></td>
</tr>
<tr id="A1.T5.16.16.16.16" class="ltx_tr">
<th id="A1.T5.16.16.16.16.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">CIFAR-10</th>
<th id="A1.T5.14.14.14.14.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">
<math id="A1.T5.13.13.13.13.1.m1.1" class="ltx_Math" alttext="\beta=0.002" display="inline"><semantics id="A1.T5.13.13.13.13.1.m1.1a"><mrow id="A1.T5.13.13.13.13.1.m1.1.1" xref="A1.T5.13.13.13.13.1.m1.1.1.cmml"><mi id="A1.T5.13.13.13.13.1.m1.1.1.2" xref="A1.T5.13.13.13.13.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.13.13.13.13.1.m1.1.1.1" xref="A1.T5.13.13.13.13.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.13.13.13.13.1.m1.1.1.3" xref="A1.T5.13.13.13.13.1.m1.1.1.3.cmml">0.002</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.13.13.13.13.1.m1.1b"><apply id="A1.T5.13.13.13.13.1.m1.1.1.cmml" xref="A1.T5.13.13.13.13.1.m1.1.1"><eq id="A1.T5.13.13.13.13.1.m1.1.1.1.cmml" xref="A1.T5.13.13.13.13.1.m1.1.1.1"></eq><ci id="A1.T5.13.13.13.13.1.m1.1.1.2.cmml" xref="A1.T5.13.13.13.13.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.13.13.13.13.1.m1.1.1.3.cmml" xref="A1.T5.13.13.13.13.1.m1.1.1.3">0.002</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.13.13.13.13.1.m1.1c">\beta=0.002</annotation></semantics></math>,<math id="A1.T5.14.14.14.14.2.m2.1" class="ltx_Math" alttext="\rho=0.001" display="inline"><semantics id="A1.T5.14.14.14.14.2.m2.1a"><mrow id="A1.T5.14.14.14.14.2.m2.1.1" xref="A1.T5.14.14.14.14.2.m2.1.1.cmml"><mi id="A1.T5.14.14.14.14.2.m2.1.1.2" xref="A1.T5.14.14.14.14.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.14.14.14.14.2.m2.1.1.1" xref="A1.T5.14.14.14.14.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.14.14.14.14.2.m2.1.1.3" xref="A1.T5.14.14.14.14.2.m2.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.14.14.14.14.2.m2.1b"><apply id="A1.T5.14.14.14.14.2.m2.1.1.cmml" xref="A1.T5.14.14.14.14.2.m2.1.1"><eq id="A1.T5.14.14.14.14.2.m2.1.1.1.cmml" xref="A1.T5.14.14.14.14.2.m2.1.1.1"></eq><ci id="A1.T5.14.14.14.14.2.m2.1.1.2.cmml" xref="A1.T5.14.14.14.14.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.14.14.14.14.2.m2.1.1.3.cmml" xref="A1.T5.14.14.14.14.2.m2.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.14.14.14.14.2.m2.1c">\rho=0.001</annotation></semantics></math>
</th>
<td id="A1.T5.16.16.16.16.6" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.16.16.16.16.7" class="ltx_td ltx_border_t"></td>
<td id="A1.T5.15.15.15.15.3" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T5.15.15.15.15.3.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.15.15.15.15.3.m1.1a"><mrow id="A1.T5.15.15.15.15.3.m1.1.1" xref="A1.T5.15.15.15.15.3.m1.1.1.cmml"><mi id="A1.T5.15.15.15.15.3.m1.1.1.2" xref="A1.T5.15.15.15.15.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.15.15.15.15.3.m1.1.1.1" xref="A1.T5.15.15.15.15.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.15.15.15.15.3.m1.1.1.3" xref="A1.T5.15.15.15.15.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.15.15.15.15.3.m1.1b"><apply id="A1.T5.15.15.15.15.3.m1.1.1.cmml" xref="A1.T5.15.15.15.15.3.m1.1.1"><eq id="A1.T5.15.15.15.15.3.m1.1.1.1.cmml" xref="A1.T5.15.15.15.15.3.m1.1.1.1"></eq><ci id="A1.T5.15.15.15.15.3.m1.1.1.2.cmml" xref="A1.T5.15.15.15.15.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.15.15.15.15.3.m1.1.1.3.cmml" xref="A1.T5.15.15.15.15.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.15.15.15.15.3.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.16.16.16.16.8" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.16.16.16.16.9" class="ltx_td ltx_border_t"></td>
<td id="A1.T5.16.16.16.16.4" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T5.16.16.16.16.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.16.16.16.16.4.m1.1a"><mrow id="A1.T5.16.16.16.16.4.m1.1.1" xref="A1.T5.16.16.16.16.4.m1.1.1.cmml"><mi id="A1.T5.16.16.16.16.4.m1.1.1.2" xref="A1.T5.16.16.16.16.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.16.16.16.16.4.m1.1.1.1" xref="A1.T5.16.16.16.16.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.16.16.16.16.4.m1.1.1.3" xref="A1.T5.16.16.16.16.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.16.16.16.16.4.m1.1b"><apply id="A1.T5.16.16.16.16.4.m1.1.1.cmml" xref="A1.T5.16.16.16.16.4.m1.1.1"><eq id="A1.T5.16.16.16.16.4.m1.1.1.1.cmml" xref="A1.T5.16.16.16.16.4.m1.1.1.1"></eq><ci id="A1.T5.16.16.16.16.4.m1.1.1.2.cmml" xref="A1.T5.16.16.16.16.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.16.16.16.16.4.m1.1.1.3.cmml" xref="A1.T5.16.16.16.16.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.16.16.16.16.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.16.16.16.16.10" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.16.16.16.16.11" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="A1.T5.20.20.20.20" class="ltx_tr">
<th id="A1.T5.20.20.20.20.5" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A1.T5.18.18.18.18.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<math id="A1.T5.17.17.17.17.1.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.17.17.17.17.1.m1.1a"><mrow id="A1.T5.17.17.17.17.1.m1.1.1" xref="A1.T5.17.17.17.17.1.m1.1.1.cmml"><mi id="A1.T5.17.17.17.17.1.m1.1.1.2" xref="A1.T5.17.17.17.17.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.17.17.17.17.1.m1.1.1.1" xref="A1.T5.17.17.17.17.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.17.17.17.17.1.m1.1.1.3" xref="A1.T5.17.17.17.17.1.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.17.17.17.17.1.m1.1b"><apply id="A1.T5.17.17.17.17.1.m1.1.1.cmml" xref="A1.T5.17.17.17.17.1.m1.1.1"><eq id="A1.T5.17.17.17.17.1.m1.1.1.1.cmml" xref="A1.T5.17.17.17.17.1.m1.1.1.1"></eq><ci id="A1.T5.17.17.17.17.1.m1.1.1.2.cmml" xref="A1.T5.17.17.17.17.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.17.17.17.17.1.m1.1.1.3.cmml" xref="A1.T5.17.17.17.17.1.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.17.17.17.17.1.m1.1c">\beta=0.007</annotation></semantics></math>,<math id="A1.T5.18.18.18.18.2.m2.1" class="ltx_Math" alttext="\rho=0.001" display="inline"><semantics id="A1.T5.18.18.18.18.2.m2.1a"><mrow id="A1.T5.18.18.18.18.2.m2.1.1" xref="A1.T5.18.18.18.18.2.m2.1.1.cmml"><mi id="A1.T5.18.18.18.18.2.m2.1.1.2" xref="A1.T5.18.18.18.18.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.18.18.18.18.2.m2.1.1.1" xref="A1.T5.18.18.18.18.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.18.18.18.18.2.m2.1.1.3" xref="A1.T5.18.18.18.18.2.m2.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.18.18.18.18.2.m2.1b"><apply id="A1.T5.18.18.18.18.2.m2.1.1.cmml" xref="A1.T5.18.18.18.18.2.m2.1.1"><eq id="A1.T5.18.18.18.18.2.m2.1.1.1.cmml" xref="A1.T5.18.18.18.18.2.m2.1.1.1"></eq><ci id="A1.T5.18.18.18.18.2.m2.1.1.2.cmml" xref="A1.T5.18.18.18.18.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.18.18.18.18.2.m2.1.1.3.cmml" xref="A1.T5.18.18.18.18.2.m2.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.18.18.18.18.2.m2.1c">\rho=0.001</annotation></semantics></math>
</th>
<td id="A1.T5.20.20.20.20.6" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.20.20.20.20.7" class="ltx_td"></td>
<td id="A1.T5.19.19.19.19.3" class="ltx_td ltx_align_center"><math id="A1.T5.19.19.19.19.3.m1.1" class="ltx_Math" alttext="\beta=0.005" display="inline"><semantics id="A1.T5.19.19.19.19.3.m1.1a"><mrow id="A1.T5.19.19.19.19.3.m1.1.1" xref="A1.T5.19.19.19.19.3.m1.1.1.cmml"><mi id="A1.T5.19.19.19.19.3.m1.1.1.2" xref="A1.T5.19.19.19.19.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.19.19.19.19.3.m1.1.1.1" xref="A1.T5.19.19.19.19.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.19.19.19.19.3.m1.1.1.3" xref="A1.T5.19.19.19.19.3.m1.1.1.3.cmml">0.005</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.19.19.19.19.3.m1.1b"><apply id="A1.T5.19.19.19.19.3.m1.1.1.cmml" xref="A1.T5.19.19.19.19.3.m1.1.1"><eq id="A1.T5.19.19.19.19.3.m1.1.1.1.cmml" xref="A1.T5.19.19.19.19.3.m1.1.1.1"></eq><ci id="A1.T5.19.19.19.19.3.m1.1.1.2.cmml" xref="A1.T5.19.19.19.19.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.19.19.19.19.3.m1.1.1.3.cmml" xref="A1.T5.19.19.19.19.3.m1.1.1.3">0.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.19.19.19.19.3.m1.1c">\beta=0.005</annotation></semantics></math></td>
<td id="A1.T5.20.20.20.20.8" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.20.20.20.20.9" class="ltx_td"></td>
<td id="A1.T5.20.20.20.20.4" class="ltx_td ltx_align_center"><math id="A1.T5.20.20.20.20.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.20.20.20.20.4.m1.1a"><mrow id="A1.T5.20.20.20.20.4.m1.1.1" xref="A1.T5.20.20.20.20.4.m1.1.1.cmml"><mi id="A1.T5.20.20.20.20.4.m1.1.1.2" xref="A1.T5.20.20.20.20.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.20.20.20.20.4.m1.1.1.1" xref="A1.T5.20.20.20.20.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.20.20.20.20.4.m1.1.1.3" xref="A1.T5.20.20.20.20.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.20.20.20.20.4.m1.1b"><apply id="A1.T5.20.20.20.20.4.m1.1.1.cmml" xref="A1.T5.20.20.20.20.4.m1.1.1"><eq id="A1.T5.20.20.20.20.4.m1.1.1.1.cmml" xref="A1.T5.20.20.20.20.4.m1.1.1.1"></eq><ci id="A1.T5.20.20.20.20.4.m1.1.1.2.cmml" xref="A1.T5.20.20.20.20.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.20.20.20.20.4.m1.1.1.3.cmml" xref="A1.T5.20.20.20.20.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.20.20.20.20.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.20.20.20.20.10" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.20.20.20.20.11" class="ltx_td"></td>
</tr>
<tr id="A1.T5.24.24.24.24" class="ltx_tr">
<th id="A1.T5.24.24.24.24.5" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A1.T5.22.22.22.22.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<math id="A1.T5.21.21.21.21.1.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.21.21.21.21.1.m1.1a"><mrow id="A1.T5.21.21.21.21.1.m1.1.1" xref="A1.T5.21.21.21.21.1.m1.1.1.cmml"><mi id="A1.T5.21.21.21.21.1.m1.1.1.2" xref="A1.T5.21.21.21.21.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.21.21.21.21.1.m1.1.1.1" xref="A1.T5.21.21.21.21.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.21.21.21.21.1.m1.1.1.3" xref="A1.T5.21.21.21.21.1.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.21.21.21.21.1.m1.1b"><apply id="A1.T5.21.21.21.21.1.m1.1.1.cmml" xref="A1.T5.21.21.21.21.1.m1.1.1"><eq id="A1.T5.21.21.21.21.1.m1.1.1.1.cmml" xref="A1.T5.21.21.21.21.1.m1.1.1.1"></eq><ci id="A1.T5.21.21.21.21.1.m1.1.1.2.cmml" xref="A1.T5.21.21.21.21.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.21.21.21.21.1.m1.1.1.3.cmml" xref="A1.T5.21.21.21.21.1.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.21.21.21.21.1.m1.1c">\beta=0.007</annotation></semantics></math>,<math id="A1.T5.22.22.22.22.2.m2.1" class="ltx_Math" alttext="\rho=0.001" display="inline"><semantics id="A1.T5.22.22.22.22.2.m2.1a"><mrow id="A1.T5.22.22.22.22.2.m2.1.1" xref="A1.T5.22.22.22.22.2.m2.1.1.cmml"><mi id="A1.T5.22.22.22.22.2.m2.1.1.2" xref="A1.T5.22.22.22.22.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.22.22.22.22.2.m2.1.1.1" xref="A1.T5.22.22.22.22.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.22.22.22.22.2.m2.1.1.3" xref="A1.T5.22.22.22.22.2.m2.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.22.22.22.22.2.m2.1b"><apply id="A1.T5.22.22.22.22.2.m2.1.1.cmml" xref="A1.T5.22.22.22.22.2.m2.1.1"><eq id="A1.T5.22.22.22.22.2.m2.1.1.1.cmml" xref="A1.T5.22.22.22.22.2.m2.1.1.1"></eq><ci id="A1.T5.22.22.22.22.2.m2.1.1.2.cmml" xref="A1.T5.22.22.22.22.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.22.22.22.22.2.m2.1.1.3.cmml" xref="A1.T5.22.22.22.22.2.m2.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.22.22.22.22.2.m2.1c">\rho=0.001</annotation></semantics></math>
</th>
<td id="A1.T5.24.24.24.24.6" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.24.24.24.24.7" class="ltx_td"></td>
<td id="A1.T5.23.23.23.23.3" class="ltx_td ltx_align_center"><math id="A1.T5.23.23.23.23.3.m1.1" class="ltx_Math" alttext="\beta=0.005" display="inline"><semantics id="A1.T5.23.23.23.23.3.m1.1a"><mrow id="A1.T5.23.23.23.23.3.m1.1.1" xref="A1.T5.23.23.23.23.3.m1.1.1.cmml"><mi id="A1.T5.23.23.23.23.3.m1.1.1.2" xref="A1.T5.23.23.23.23.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.23.23.23.23.3.m1.1.1.1" xref="A1.T5.23.23.23.23.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.23.23.23.23.3.m1.1.1.3" xref="A1.T5.23.23.23.23.3.m1.1.1.3.cmml">0.005</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.23.23.23.23.3.m1.1b"><apply id="A1.T5.23.23.23.23.3.m1.1.1.cmml" xref="A1.T5.23.23.23.23.3.m1.1.1"><eq id="A1.T5.23.23.23.23.3.m1.1.1.1.cmml" xref="A1.T5.23.23.23.23.3.m1.1.1.1"></eq><ci id="A1.T5.23.23.23.23.3.m1.1.1.2.cmml" xref="A1.T5.23.23.23.23.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.23.23.23.23.3.m1.1.1.3.cmml" xref="A1.T5.23.23.23.23.3.m1.1.1.3">0.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.23.23.23.23.3.m1.1c">\beta=0.005</annotation></semantics></math></td>
<td id="A1.T5.24.24.24.24.8" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.24.24.24.24.9" class="ltx_td"></td>
<td id="A1.T5.24.24.24.24.4" class="ltx_td ltx_align_center"><math id="A1.T5.24.24.24.24.4.m1.1" class="ltx_Math" alttext="\beta=0.006" display="inline"><semantics id="A1.T5.24.24.24.24.4.m1.1a"><mrow id="A1.T5.24.24.24.24.4.m1.1.1" xref="A1.T5.24.24.24.24.4.m1.1.1.cmml"><mi id="A1.T5.24.24.24.24.4.m1.1.1.2" xref="A1.T5.24.24.24.24.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.24.24.24.24.4.m1.1.1.1" xref="A1.T5.24.24.24.24.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.24.24.24.24.4.m1.1.1.3" xref="A1.T5.24.24.24.24.4.m1.1.1.3.cmml">0.006</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.24.24.24.24.4.m1.1b"><apply id="A1.T5.24.24.24.24.4.m1.1.1.cmml" xref="A1.T5.24.24.24.24.4.m1.1.1"><eq id="A1.T5.24.24.24.24.4.m1.1.1.1.cmml" xref="A1.T5.24.24.24.24.4.m1.1.1.1"></eq><ci id="A1.T5.24.24.24.24.4.m1.1.1.2.cmml" xref="A1.T5.24.24.24.24.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.24.24.24.24.4.m1.1.1.3.cmml" xref="A1.T5.24.24.24.24.4.m1.1.1.3">0.006</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.24.24.24.24.4.m1.1c">\beta=0.006</annotation></semantics></math></td>
<td id="A1.T5.24.24.24.24.10" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.24.24.24.24.11" class="ltx_td"></td>
</tr>
<tr id="A1.T5.28.28.28.28" class="ltx_tr">
<th id="A1.T5.28.28.28.28.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">Fashion-MNIST</th>
<th id="A1.T5.26.26.26.26.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">
<math id="A1.T5.25.25.25.25.1.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.25.25.25.25.1.m1.1a"><mrow id="A1.T5.25.25.25.25.1.m1.1.1" xref="A1.T5.25.25.25.25.1.m1.1.1.cmml"><mi id="A1.T5.25.25.25.25.1.m1.1.1.2" xref="A1.T5.25.25.25.25.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.25.25.25.25.1.m1.1.1.1" xref="A1.T5.25.25.25.25.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.25.25.25.25.1.m1.1.1.3" xref="A1.T5.25.25.25.25.1.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.25.25.25.25.1.m1.1b"><apply id="A1.T5.25.25.25.25.1.m1.1.1.cmml" xref="A1.T5.25.25.25.25.1.m1.1.1"><eq id="A1.T5.25.25.25.25.1.m1.1.1.1.cmml" xref="A1.T5.25.25.25.25.1.m1.1.1.1"></eq><ci id="A1.T5.25.25.25.25.1.m1.1.1.2.cmml" xref="A1.T5.25.25.25.25.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.25.25.25.25.1.m1.1.1.3.cmml" xref="A1.T5.25.25.25.25.1.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.25.25.25.25.1.m1.1c">\beta=0.007</annotation></semantics></math>,<math id="A1.T5.26.26.26.26.2.m2.1" class="ltx_Math" alttext="\rho=0.001" display="inline"><semantics id="A1.T5.26.26.26.26.2.m2.1a"><mrow id="A1.T5.26.26.26.26.2.m2.1.1" xref="A1.T5.26.26.26.26.2.m2.1.1.cmml"><mi id="A1.T5.26.26.26.26.2.m2.1.1.2" xref="A1.T5.26.26.26.26.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.26.26.26.26.2.m2.1.1.1" xref="A1.T5.26.26.26.26.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.26.26.26.26.2.m2.1.1.3" xref="A1.T5.26.26.26.26.2.m2.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.26.26.26.26.2.m2.1b"><apply id="A1.T5.26.26.26.26.2.m2.1.1.cmml" xref="A1.T5.26.26.26.26.2.m2.1.1"><eq id="A1.T5.26.26.26.26.2.m2.1.1.1.cmml" xref="A1.T5.26.26.26.26.2.m2.1.1.1"></eq><ci id="A1.T5.26.26.26.26.2.m2.1.1.2.cmml" xref="A1.T5.26.26.26.26.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.26.26.26.26.2.m2.1.1.3.cmml" xref="A1.T5.26.26.26.26.2.m2.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.26.26.26.26.2.m2.1c">\rho=0.001</annotation></semantics></math>
</th>
<td id="A1.T5.28.28.28.28.6" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.28.28.28.28.7" class="ltx_td ltx_border_t"></td>
<td id="A1.T5.27.27.27.27.3" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T5.27.27.27.27.3.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.27.27.27.27.3.m1.1a"><mrow id="A1.T5.27.27.27.27.3.m1.1.1" xref="A1.T5.27.27.27.27.3.m1.1.1.cmml"><mi id="A1.T5.27.27.27.27.3.m1.1.1.2" xref="A1.T5.27.27.27.27.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.27.27.27.27.3.m1.1.1.1" xref="A1.T5.27.27.27.27.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.27.27.27.27.3.m1.1.1.3" xref="A1.T5.27.27.27.27.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.27.27.27.27.3.m1.1b"><apply id="A1.T5.27.27.27.27.3.m1.1.1.cmml" xref="A1.T5.27.27.27.27.3.m1.1.1"><eq id="A1.T5.27.27.27.27.3.m1.1.1.1.cmml" xref="A1.T5.27.27.27.27.3.m1.1.1.1"></eq><ci id="A1.T5.27.27.27.27.3.m1.1.1.2.cmml" xref="A1.T5.27.27.27.27.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.27.27.27.27.3.m1.1.1.3.cmml" xref="A1.T5.27.27.27.27.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.27.27.27.27.3.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.28.28.28.28.8" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.28.28.28.28.9" class="ltx_td ltx_border_t"></td>
<td id="A1.T5.28.28.28.28.4" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T5.28.28.28.28.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.28.28.28.28.4.m1.1a"><mrow id="A1.T5.28.28.28.28.4.m1.1.1" xref="A1.T5.28.28.28.28.4.m1.1.1.cmml"><mi id="A1.T5.28.28.28.28.4.m1.1.1.2" xref="A1.T5.28.28.28.28.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.28.28.28.28.4.m1.1.1.1" xref="A1.T5.28.28.28.28.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.28.28.28.28.4.m1.1.1.3" xref="A1.T5.28.28.28.28.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.28.28.28.28.4.m1.1b"><apply id="A1.T5.28.28.28.28.4.m1.1.1.cmml" xref="A1.T5.28.28.28.28.4.m1.1.1"><eq id="A1.T5.28.28.28.28.4.m1.1.1.1.cmml" xref="A1.T5.28.28.28.28.4.m1.1.1.1"></eq><ci id="A1.T5.28.28.28.28.4.m1.1.1.2.cmml" xref="A1.T5.28.28.28.28.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.28.28.28.28.4.m1.1.1.3.cmml" xref="A1.T5.28.28.28.28.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.28.28.28.28.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.28.28.28.28.10" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.28.28.28.28.11" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="A1.T5.32.32.32.32" class="ltx_tr">
<th id="A1.T5.32.32.32.32.5" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A1.T5.30.30.30.30.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<math id="A1.T5.29.29.29.29.1.m1.1" class="ltx_Math" alttext="\beta=0.006" display="inline"><semantics id="A1.T5.29.29.29.29.1.m1.1a"><mrow id="A1.T5.29.29.29.29.1.m1.1.1" xref="A1.T5.29.29.29.29.1.m1.1.1.cmml"><mi id="A1.T5.29.29.29.29.1.m1.1.1.2" xref="A1.T5.29.29.29.29.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.29.29.29.29.1.m1.1.1.1" xref="A1.T5.29.29.29.29.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.29.29.29.29.1.m1.1.1.3" xref="A1.T5.29.29.29.29.1.m1.1.1.3.cmml">0.006</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.29.29.29.29.1.m1.1b"><apply id="A1.T5.29.29.29.29.1.m1.1.1.cmml" xref="A1.T5.29.29.29.29.1.m1.1.1"><eq id="A1.T5.29.29.29.29.1.m1.1.1.1.cmml" xref="A1.T5.29.29.29.29.1.m1.1.1.1"></eq><ci id="A1.T5.29.29.29.29.1.m1.1.1.2.cmml" xref="A1.T5.29.29.29.29.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.29.29.29.29.1.m1.1.1.3.cmml" xref="A1.T5.29.29.29.29.1.m1.1.1.3">0.006</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.29.29.29.29.1.m1.1c">\beta=0.006</annotation></semantics></math>,<math id="A1.T5.30.30.30.30.2.m2.1" class="ltx_Math" alttext="\rho=0.002" display="inline"><semantics id="A1.T5.30.30.30.30.2.m2.1a"><mrow id="A1.T5.30.30.30.30.2.m2.1.1" xref="A1.T5.30.30.30.30.2.m2.1.1.cmml"><mi id="A1.T5.30.30.30.30.2.m2.1.1.2" xref="A1.T5.30.30.30.30.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.30.30.30.30.2.m2.1.1.1" xref="A1.T5.30.30.30.30.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.30.30.30.30.2.m2.1.1.3" xref="A1.T5.30.30.30.30.2.m2.1.1.3.cmml">0.002</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.30.30.30.30.2.m2.1b"><apply id="A1.T5.30.30.30.30.2.m2.1.1.cmml" xref="A1.T5.30.30.30.30.2.m2.1.1"><eq id="A1.T5.30.30.30.30.2.m2.1.1.1.cmml" xref="A1.T5.30.30.30.30.2.m2.1.1.1"></eq><ci id="A1.T5.30.30.30.30.2.m2.1.1.2.cmml" xref="A1.T5.30.30.30.30.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.30.30.30.30.2.m2.1.1.3.cmml" xref="A1.T5.30.30.30.30.2.m2.1.1.3">0.002</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.30.30.30.30.2.m2.1c">\rho=0.002</annotation></semantics></math>
</th>
<td id="A1.T5.32.32.32.32.6" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.32.32.32.32.7" class="ltx_td"></td>
<td id="A1.T5.31.31.31.31.3" class="ltx_td ltx_align_center"><math id="A1.T5.31.31.31.31.3.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.31.31.31.31.3.m1.1a"><mrow id="A1.T5.31.31.31.31.3.m1.1.1" xref="A1.T5.31.31.31.31.3.m1.1.1.cmml"><mi id="A1.T5.31.31.31.31.3.m1.1.1.2" xref="A1.T5.31.31.31.31.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.31.31.31.31.3.m1.1.1.1" xref="A1.T5.31.31.31.31.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.31.31.31.31.3.m1.1.1.3" xref="A1.T5.31.31.31.31.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.31.31.31.31.3.m1.1b"><apply id="A1.T5.31.31.31.31.3.m1.1.1.cmml" xref="A1.T5.31.31.31.31.3.m1.1.1"><eq id="A1.T5.31.31.31.31.3.m1.1.1.1.cmml" xref="A1.T5.31.31.31.31.3.m1.1.1.1"></eq><ci id="A1.T5.31.31.31.31.3.m1.1.1.2.cmml" xref="A1.T5.31.31.31.31.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.31.31.31.31.3.m1.1.1.3.cmml" xref="A1.T5.31.31.31.31.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.31.31.31.31.3.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.32.32.32.32.8" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.32.32.32.32.9" class="ltx_td"></td>
<td id="A1.T5.32.32.32.32.4" class="ltx_td ltx_align_center"><math id="A1.T5.32.32.32.32.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.32.32.32.32.4.m1.1a"><mrow id="A1.T5.32.32.32.32.4.m1.1.1" xref="A1.T5.32.32.32.32.4.m1.1.1.cmml"><mi id="A1.T5.32.32.32.32.4.m1.1.1.2" xref="A1.T5.32.32.32.32.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.32.32.32.32.4.m1.1.1.1" xref="A1.T5.32.32.32.32.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.32.32.32.32.4.m1.1.1.3" xref="A1.T5.32.32.32.32.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.32.32.32.32.4.m1.1b"><apply id="A1.T5.32.32.32.32.4.m1.1.1.cmml" xref="A1.T5.32.32.32.32.4.m1.1.1"><eq id="A1.T5.32.32.32.32.4.m1.1.1.1.cmml" xref="A1.T5.32.32.32.32.4.m1.1.1.1"></eq><ci id="A1.T5.32.32.32.32.4.m1.1.1.2.cmml" xref="A1.T5.32.32.32.32.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.32.32.32.32.4.m1.1.1.3.cmml" xref="A1.T5.32.32.32.32.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.32.32.32.32.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.32.32.32.32.10" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.32.32.32.32.11" class="ltx_td"></td>
</tr>
<tr id="A1.T5.36.36.36.36" class="ltx_tr">
<th id="A1.T5.36.36.36.36.5" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A1.T5.34.34.34.34.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<math id="A1.T5.33.33.33.33.1.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.33.33.33.33.1.m1.1a"><mrow id="A1.T5.33.33.33.33.1.m1.1.1" xref="A1.T5.33.33.33.33.1.m1.1.1.cmml"><mi id="A1.T5.33.33.33.33.1.m1.1.1.2" xref="A1.T5.33.33.33.33.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.33.33.33.33.1.m1.1.1.1" xref="A1.T5.33.33.33.33.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.33.33.33.33.1.m1.1.1.3" xref="A1.T5.33.33.33.33.1.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.33.33.33.33.1.m1.1b"><apply id="A1.T5.33.33.33.33.1.m1.1.1.cmml" xref="A1.T5.33.33.33.33.1.m1.1.1"><eq id="A1.T5.33.33.33.33.1.m1.1.1.1.cmml" xref="A1.T5.33.33.33.33.1.m1.1.1.1"></eq><ci id="A1.T5.33.33.33.33.1.m1.1.1.2.cmml" xref="A1.T5.33.33.33.33.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.33.33.33.33.1.m1.1.1.3.cmml" xref="A1.T5.33.33.33.33.1.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.33.33.33.33.1.m1.1c">\beta=0.007</annotation></semantics></math>,<math id="A1.T5.34.34.34.34.2.m2.1" class="ltx_Math" alttext="\rho=0.003" display="inline"><semantics id="A1.T5.34.34.34.34.2.m2.1a"><mrow id="A1.T5.34.34.34.34.2.m2.1.1" xref="A1.T5.34.34.34.34.2.m2.1.1.cmml"><mi id="A1.T5.34.34.34.34.2.m2.1.1.2" xref="A1.T5.34.34.34.34.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.34.34.34.34.2.m2.1.1.1" xref="A1.T5.34.34.34.34.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.34.34.34.34.2.m2.1.1.3" xref="A1.T5.34.34.34.34.2.m2.1.1.3.cmml">0.003</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.34.34.34.34.2.m2.1b"><apply id="A1.T5.34.34.34.34.2.m2.1.1.cmml" xref="A1.T5.34.34.34.34.2.m2.1.1"><eq id="A1.T5.34.34.34.34.2.m2.1.1.1.cmml" xref="A1.T5.34.34.34.34.2.m2.1.1.1"></eq><ci id="A1.T5.34.34.34.34.2.m2.1.1.2.cmml" xref="A1.T5.34.34.34.34.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.34.34.34.34.2.m2.1.1.3.cmml" xref="A1.T5.34.34.34.34.2.m2.1.1.3">0.003</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.34.34.34.34.2.m2.1c">\rho=0.003</annotation></semantics></math>
</th>
<td id="A1.T5.36.36.36.36.6" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.36.36.36.36.7" class="ltx_td"></td>
<td id="A1.T5.35.35.35.35.3" class="ltx_td ltx_align_center"><math id="A1.T5.35.35.35.35.3.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.35.35.35.35.3.m1.1a"><mrow id="A1.T5.35.35.35.35.3.m1.1.1" xref="A1.T5.35.35.35.35.3.m1.1.1.cmml"><mi id="A1.T5.35.35.35.35.3.m1.1.1.2" xref="A1.T5.35.35.35.35.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.35.35.35.35.3.m1.1.1.1" xref="A1.T5.35.35.35.35.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.35.35.35.35.3.m1.1.1.3" xref="A1.T5.35.35.35.35.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.35.35.35.35.3.m1.1b"><apply id="A1.T5.35.35.35.35.3.m1.1.1.cmml" xref="A1.T5.35.35.35.35.3.m1.1.1"><eq id="A1.T5.35.35.35.35.3.m1.1.1.1.cmml" xref="A1.T5.35.35.35.35.3.m1.1.1.1"></eq><ci id="A1.T5.35.35.35.35.3.m1.1.1.2.cmml" xref="A1.T5.35.35.35.35.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.35.35.35.35.3.m1.1.1.3.cmml" xref="A1.T5.35.35.35.35.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.35.35.35.35.3.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.36.36.36.36.8" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.36.36.36.36.9" class="ltx_td"></td>
<td id="A1.T5.36.36.36.36.4" class="ltx_td ltx_align_center"><math id="A1.T5.36.36.36.36.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.36.36.36.36.4.m1.1a"><mrow id="A1.T5.36.36.36.36.4.m1.1.1" xref="A1.T5.36.36.36.36.4.m1.1.1.cmml"><mi id="A1.T5.36.36.36.36.4.m1.1.1.2" xref="A1.T5.36.36.36.36.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.36.36.36.36.4.m1.1.1.1" xref="A1.T5.36.36.36.36.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.36.36.36.36.4.m1.1.1.3" xref="A1.T5.36.36.36.36.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.36.36.36.36.4.m1.1b"><apply id="A1.T5.36.36.36.36.4.m1.1.1.cmml" xref="A1.T5.36.36.36.36.4.m1.1.1"><eq id="A1.T5.36.36.36.36.4.m1.1.1.1.cmml" xref="A1.T5.36.36.36.36.4.m1.1.1.1"></eq><ci id="A1.T5.36.36.36.36.4.m1.1.1.2.cmml" xref="A1.T5.36.36.36.36.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.36.36.36.36.4.m1.1.1.3.cmml" xref="A1.T5.36.36.36.36.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.36.36.36.36.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.36.36.36.36.10" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.36.36.36.36.11" class="ltx_td"></td>
</tr>
<tr id="A1.T5.40.40.40.40" class="ltx_tr">
<th id="A1.T5.40.40.40.40.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t">EMNIST</th>
<th id="A1.T5.38.38.38.38.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">
<math id="A1.T5.37.37.37.37.1.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.37.37.37.37.1.m1.1a"><mrow id="A1.T5.37.37.37.37.1.m1.1.1" xref="A1.T5.37.37.37.37.1.m1.1.1.cmml"><mi id="A1.T5.37.37.37.37.1.m1.1.1.2" xref="A1.T5.37.37.37.37.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.37.37.37.37.1.m1.1.1.1" xref="A1.T5.37.37.37.37.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.37.37.37.37.1.m1.1.1.3" xref="A1.T5.37.37.37.37.1.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.37.37.37.37.1.m1.1b"><apply id="A1.T5.37.37.37.37.1.m1.1.1.cmml" xref="A1.T5.37.37.37.37.1.m1.1.1"><eq id="A1.T5.37.37.37.37.1.m1.1.1.1.cmml" xref="A1.T5.37.37.37.37.1.m1.1.1.1"></eq><ci id="A1.T5.37.37.37.37.1.m1.1.1.2.cmml" xref="A1.T5.37.37.37.37.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.37.37.37.37.1.m1.1.1.3.cmml" xref="A1.T5.37.37.37.37.1.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.37.37.37.37.1.m1.1c">\beta=0.007</annotation></semantics></math>,<math id="A1.T5.38.38.38.38.2.m2.1" class="ltx_Math" alttext="\rho=0.001" display="inline"><semantics id="A1.T5.38.38.38.38.2.m2.1a"><mrow id="A1.T5.38.38.38.38.2.m2.1.1" xref="A1.T5.38.38.38.38.2.m2.1.1.cmml"><mi id="A1.T5.38.38.38.38.2.m2.1.1.2" xref="A1.T5.38.38.38.38.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.38.38.38.38.2.m2.1.1.1" xref="A1.T5.38.38.38.38.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.38.38.38.38.2.m2.1.1.3" xref="A1.T5.38.38.38.38.2.m2.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.38.38.38.38.2.m2.1b"><apply id="A1.T5.38.38.38.38.2.m2.1.1.cmml" xref="A1.T5.38.38.38.38.2.m2.1.1"><eq id="A1.T5.38.38.38.38.2.m2.1.1.1.cmml" xref="A1.T5.38.38.38.38.2.m2.1.1.1"></eq><ci id="A1.T5.38.38.38.38.2.m2.1.1.2.cmml" xref="A1.T5.38.38.38.38.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.38.38.38.38.2.m2.1.1.3.cmml" xref="A1.T5.38.38.38.38.2.m2.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.38.38.38.38.2.m2.1c">\rho=0.001</annotation></semantics></math>
</th>
<td id="A1.T5.40.40.40.40.6" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.40.40.40.40.7" class="ltx_td ltx_border_t"></td>
<td id="A1.T5.39.39.39.39.3" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T5.39.39.39.39.3.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.39.39.39.39.3.m1.1a"><mrow id="A1.T5.39.39.39.39.3.m1.1.1" xref="A1.T5.39.39.39.39.3.m1.1.1.cmml"><mi id="A1.T5.39.39.39.39.3.m1.1.1.2" xref="A1.T5.39.39.39.39.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.39.39.39.39.3.m1.1.1.1" xref="A1.T5.39.39.39.39.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.39.39.39.39.3.m1.1.1.3" xref="A1.T5.39.39.39.39.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.39.39.39.39.3.m1.1b"><apply id="A1.T5.39.39.39.39.3.m1.1.1.cmml" xref="A1.T5.39.39.39.39.3.m1.1.1"><eq id="A1.T5.39.39.39.39.3.m1.1.1.1.cmml" xref="A1.T5.39.39.39.39.3.m1.1.1.1"></eq><ci id="A1.T5.39.39.39.39.3.m1.1.1.2.cmml" xref="A1.T5.39.39.39.39.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.39.39.39.39.3.m1.1.1.3.cmml" xref="A1.T5.39.39.39.39.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.39.39.39.39.3.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.40.40.40.40.8" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.40.40.40.40.9" class="ltx_td ltx_border_t"></td>
<td id="A1.T5.40.40.40.40.4" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T5.40.40.40.40.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.40.40.40.40.4.m1.1a"><mrow id="A1.T5.40.40.40.40.4.m1.1.1" xref="A1.T5.40.40.40.40.4.m1.1.1.cmml"><mi id="A1.T5.40.40.40.40.4.m1.1.1.2" xref="A1.T5.40.40.40.40.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.40.40.40.40.4.m1.1.1.1" xref="A1.T5.40.40.40.40.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.40.40.40.40.4.m1.1.1.3" xref="A1.T5.40.40.40.40.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.40.40.40.40.4.m1.1b"><apply id="A1.T5.40.40.40.40.4.m1.1.1.cmml" xref="A1.T5.40.40.40.40.4.m1.1.1"><eq id="A1.T5.40.40.40.40.4.m1.1.1.1.cmml" xref="A1.T5.40.40.40.40.4.m1.1.1.1"></eq><ci id="A1.T5.40.40.40.40.4.m1.1.1.2.cmml" xref="A1.T5.40.40.40.40.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.40.40.40.40.4.m1.1.1.3.cmml" xref="A1.T5.40.40.40.40.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.40.40.40.40.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.40.40.40.40.10" class="ltx_td ltx_align_center ltx_border_t">High-pers</td>
<td id="A1.T5.40.40.40.40.11" class="ltx_td ltx_border_t"></td>
</tr>
<tr id="A1.T5.44.44.44.44" class="ltx_tr">
<th id="A1.T5.44.44.44.44.5" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A1.T5.42.42.42.42.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<math id="A1.T5.41.41.41.41.1.m1.1" class="ltx_Math" alttext="\beta=0.006" display="inline"><semantics id="A1.T5.41.41.41.41.1.m1.1a"><mrow id="A1.T5.41.41.41.41.1.m1.1.1" xref="A1.T5.41.41.41.41.1.m1.1.1.cmml"><mi id="A1.T5.41.41.41.41.1.m1.1.1.2" xref="A1.T5.41.41.41.41.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.41.41.41.41.1.m1.1.1.1" xref="A1.T5.41.41.41.41.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.41.41.41.41.1.m1.1.1.3" xref="A1.T5.41.41.41.41.1.m1.1.1.3.cmml">0.006</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.41.41.41.41.1.m1.1b"><apply id="A1.T5.41.41.41.41.1.m1.1.1.cmml" xref="A1.T5.41.41.41.41.1.m1.1.1"><eq id="A1.T5.41.41.41.41.1.m1.1.1.1.cmml" xref="A1.T5.41.41.41.41.1.m1.1.1.1"></eq><ci id="A1.T5.41.41.41.41.1.m1.1.1.2.cmml" xref="A1.T5.41.41.41.41.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.41.41.41.41.1.m1.1.1.3.cmml" xref="A1.T5.41.41.41.41.1.m1.1.1.3">0.006</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.41.41.41.41.1.m1.1c">\beta=0.006</annotation></semantics></math>,<math id="A1.T5.42.42.42.42.2.m2.1" class="ltx_Math" alttext="\rho=0.002" display="inline"><semantics id="A1.T5.42.42.42.42.2.m2.1a"><mrow id="A1.T5.42.42.42.42.2.m2.1.1" xref="A1.T5.42.42.42.42.2.m2.1.1.cmml"><mi id="A1.T5.42.42.42.42.2.m2.1.1.2" xref="A1.T5.42.42.42.42.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.42.42.42.42.2.m2.1.1.1" xref="A1.T5.42.42.42.42.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.42.42.42.42.2.m2.1.1.3" xref="A1.T5.42.42.42.42.2.m2.1.1.3.cmml">0.002</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.42.42.42.42.2.m2.1b"><apply id="A1.T5.42.42.42.42.2.m2.1.1.cmml" xref="A1.T5.42.42.42.42.2.m2.1.1"><eq id="A1.T5.42.42.42.42.2.m2.1.1.1.cmml" xref="A1.T5.42.42.42.42.2.m2.1.1.1"></eq><ci id="A1.T5.42.42.42.42.2.m2.1.1.2.cmml" xref="A1.T5.42.42.42.42.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.42.42.42.42.2.m2.1.1.3.cmml" xref="A1.T5.42.42.42.42.2.m2.1.1.3">0.002</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.42.42.42.42.2.m2.1c">\rho=0.002</annotation></semantics></math>
</th>
<td id="A1.T5.44.44.44.44.6" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.44.44.44.44.7" class="ltx_td"></td>
<td id="A1.T5.43.43.43.43.3" class="ltx_td ltx_align_center"><math id="A1.T5.43.43.43.43.3.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.43.43.43.43.3.m1.1a"><mrow id="A1.T5.43.43.43.43.3.m1.1.1" xref="A1.T5.43.43.43.43.3.m1.1.1.cmml"><mi id="A1.T5.43.43.43.43.3.m1.1.1.2" xref="A1.T5.43.43.43.43.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.43.43.43.43.3.m1.1.1.1" xref="A1.T5.43.43.43.43.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.43.43.43.43.3.m1.1.1.3" xref="A1.T5.43.43.43.43.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.43.43.43.43.3.m1.1b"><apply id="A1.T5.43.43.43.43.3.m1.1.1.cmml" xref="A1.T5.43.43.43.43.3.m1.1.1"><eq id="A1.T5.43.43.43.43.3.m1.1.1.1.cmml" xref="A1.T5.43.43.43.43.3.m1.1.1.1"></eq><ci id="A1.T5.43.43.43.43.3.m1.1.1.2.cmml" xref="A1.T5.43.43.43.43.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.43.43.43.43.3.m1.1.1.3.cmml" xref="A1.T5.43.43.43.43.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.43.43.43.43.3.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.44.44.44.44.8" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.44.44.44.44.9" class="ltx_td"></td>
<td id="A1.T5.44.44.44.44.4" class="ltx_td ltx_align_center"><math id="A1.T5.44.44.44.44.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.44.44.44.44.4.m1.1a"><mrow id="A1.T5.44.44.44.44.4.m1.1.1" xref="A1.T5.44.44.44.44.4.m1.1.1.cmml"><mi id="A1.T5.44.44.44.44.4.m1.1.1.2" xref="A1.T5.44.44.44.44.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.44.44.44.44.4.m1.1.1.1" xref="A1.T5.44.44.44.44.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.44.44.44.44.4.m1.1.1.3" xref="A1.T5.44.44.44.44.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.44.44.44.44.4.m1.1b"><apply id="A1.T5.44.44.44.44.4.m1.1.1.cmml" xref="A1.T5.44.44.44.44.4.m1.1.1"><eq id="A1.T5.44.44.44.44.4.m1.1.1.1.cmml" xref="A1.T5.44.44.44.44.4.m1.1.1.1"></eq><ci id="A1.T5.44.44.44.44.4.m1.1.1.2.cmml" xref="A1.T5.44.44.44.44.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.44.44.44.44.4.m1.1.1.3.cmml" xref="A1.T5.44.44.44.44.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.44.44.44.44.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.44.44.44.44.10" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A1.T5.44.44.44.44.11" class="ltx_td"></td>
</tr>
<tr id="A1.T5.48.48.48.48" class="ltx_tr">
<th id="A1.T5.48.48.48.48.5" class="ltx_td ltx_th ltx_th_row"></th>
<th id="A1.T5.46.46.46.46.2" class="ltx_td ltx_align_center ltx_th ltx_th_row">
<math id="A1.T5.45.45.45.45.1.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.45.45.45.45.1.m1.1a"><mrow id="A1.T5.45.45.45.45.1.m1.1.1" xref="A1.T5.45.45.45.45.1.m1.1.1.cmml"><mi id="A1.T5.45.45.45.45.1.m1.1.1.2" xref="A1.T5.45.45.45.45.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.45.45.45.45.1.m1.1.1.1" xref="A1.T5.45.45.45.45.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.45.45.45.45.1.m1.1.1.3" xref="A1.T5.45.45.45.45.1.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.45.45.45.45.1.m1.1b"><apply id="A1.T5.45.45.45.45.1.m1.1.1.cmml" xref="A1.T5.45.45.45.45.1.m1.1.1"><eq id="A1.T5.45.45.45.45.1.m1.1.1.1.cmml" xref="A1.T5.45.45.45.45.1.m1.1.1.1"></eq><ci id="A1.T5.45.45.45.45.1.m1.1.1.2.cmml" xref="A1.T5.45.45.45.45.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.45.45.45.45.1.m1.1.1.3.cmml" xref="A1.T5.45.45.45.45.1.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.45.45.45.45.1.m1.1c">\beta=0.007</annotation></semantics></math>,<math id="A1.T5.46.46.46.46.2.m2.1" class="ltx_Math" alttext="\rho=0.003" display="inline"><semantics id="A1.T5.46.46.46.46.2.m2.1a"><mrow id="A1.T5.46.46.46.46.2.m2.1.1" xref="A1.T5.46.46.46.46.2.m2.1.1.cmml"><mi id="A1.T5.46.46.46.46.2.m2.1.1.2" xref="A1.T5.46.46.46.46.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.46.46.46.46.2.m2.1.1.1" xref="A1.T5.46.46.46.46.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.46.46.46.46.2.m2.1.1.3" xref="A1.T5.46.46.46.46.2.m2.1.1.3.cmml">0.003</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.46.46.46.46.2.m2.1b"><apply id="A1.T5.46.46.46.46.2.m2.1.1.cmml" xref="A1.T5.46.46.46.46.2.m2.1.1"><eq id="A1.T5.46.46.46.46.2.m2.1.1.1.cmml" xref="A1.T5.46.46.46.46.2.m2.1.1.1"></eq><ci id="A1.T5.46.46.46.46.2.m2.1.1.2.cmml" xref="A1.T5.46.46.46.46.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.46.46.46.46.2.m2.1.1.3.cmml" xref="A1.T5.46.46.46.46.2.m2.1.1.3">0.003</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.46.46.46.46.2.m2.1c">\rho=0.003</annotation></semantics></math>
</th>
<td id="A1.T5.48.48.48.48.6" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.48.48.48.48.7" class="ltx_td"></td>
<td id="A1.T5.47.47.47.47.3" class="ltx_td ltx_align_center"><math id="A1.T5.47.47.47.47.3.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.47.47.47.47.3.m1.1a"><mrow id="A1.T5.47.47.47.47.3.m1.1.1" xref="A1.T5.47.47.47.47.3.m1.1.1.cmml"><mi id="A1.T5.47.47.47.47.3.m1.1.1.2" xref="A1.T5.47.47.47.47.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.47.47.47.47.3.m1.1.1.1" xref="A1.T5.47.47.47.47.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.47.47.47.47.3.m1.1.1.3" xref="A1.T5.47.47.47.47.3.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.47.47.47.47.3.m1.1b"><apply id="A1.T5.47.47.47.47.3.m1.1.1.cmml" xref="A1.T5.47.47.47.47.3.m1.1.1"><eq id="A1.T5.47.47.47.47.3.m1.1.1.1.cmml" xref="A1.T5.47.47.47.47.3.m1.1.1.1"></eq><ci id="A1.T5.47.47.47.47.3.m1.1.1.2.cmml" xref="A1.T5.47.47.47.47.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.47.47.47.47.3.m1.1.1.3.cmml" xref="A1.T5.47.47.47.47.3.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.47.47.47.47.3.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.48.48.48.48.8" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.48.48.48.48.9" class="ltx_td"></td>
<td id="A1.T5.48.48.48.48.4" class="ltx_td ltx_align_center"><math id="A1.T5.48.48.48.48.4.m1.1" class="ltx_Math" alttext="\beta=0.007" display="inline"><semantics id="A1.T5.48.48.48.48.4.m1.1a"><mrow id="A1.T5.48.48.48.48.4.m1.1.1" xref="A1.T5.48.48.48.48.4.m1.1.1.cmml"><mi id="A1.T5.48.48.48.48.4.m1.1.1.2" xref="A1.T5.48.48.48.48.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.48.48.48.48.4.m1.1.1.1" xref="A1.T5.48.48.48.48.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.48.48.48.48.4.m1.1.1.3" xref="A1.T5.48.48.48.48.4.m1.1.1.3.cmml">0.007</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.48.48.48.48.4.m1.1b"><apply id="A1.T5.48.48.48.48.4.m1.1.1.cmml" xref="A1.T5.48.48.48.48.4.m1.1.1"><eq id="A1.T5.48.48.48.48.4.m1.1.1.1.cmml" xref="A1.T5.48.48.48.48.4.m1.1.1.1"></eq><ci id="A1.T5.48.48.48.48.4.m1.1.1.2.cmml" xref="A1.T5.48.48.48.48.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.48.48.48.48.4.m1.1.1.3.cmml" xref="A1.T5.48.48.48.48.4.m1.1.1.3">0.007</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.48.48.48.48.4.m1.1c">\beta=0.007</annotation></semantics></math></td>
<td id="A1.T5.48.48.48.48.10" class="ltx_td ltx_align_center">No-pers</td>
<td id="A1.T5.48.48.48.48.11" class="ltx_td"></td>
</tr>
<tr id="A1.T5.52.52.52.52" class="ltx_tr">
<th id="A1.T5.52.52.52.52.5" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_t">Omniglot</th>
<th id="A1.T5.50.50.50.50.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t">
<math id="A1.T5.49.49.49.49.1.m1.1" class="ltx_Math" alttext="\beta=0.009" display="inline"><semantics id="A1.T5.49.49.49.49.1.m1.1a"><mrow id="A1.T5.49.49.49.49.1.m1.1.1" xref="A1.T5.49.49.49.49.1.m1.1.1.cmml"><mi id="A1.T5.49.49.49.49.1.m1.1.1.2" xref="A1.T5.49.49.49.49.1.m1.1.1.2.cmml">β</mi><mo id="A1.T5.49.49.49.49.1.m1.1.1.1" xref="A1.T5.49.49.49.49.1.m1.1.1.1.cmml">=</mo><mn id="A1.T5.49.49.49.49.1.m1.1.1.3" xref="A1.T5.49.49.49.49.1.m1.1.1.3.cmml">0.009</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.49.49.49.49.1.m1.1b"><apply id="A1.T5.49.49.49.49.1.m1.1.1.cmml" xref="A1.T5.49.49.49.49.1.m1.1.1"><eq id="A1.T5.49.49.49.49.1.m1.1.1.1.cmml" xref="A1.T5.49.49.49.49.1.m1.1.1.1"></eq><ci id="A1.T5.49.49.49.49.1.m1.1.1.2.cmml" xref="A1.T5.49.49.49.49.1.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.49.49.49.49.1.m1.1.1.3.cmml" xref="A1.T5.49.49.49.49.1.m1.1.1.3">0.009</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.49.49.49.49.1.m1.1c">\beta=0.009</annotation></semantics></math>,<math id="A1.T5.50.50.50.50.2.m2.1" class="ltx_Math" alttext="\rho=0.001" display="inline"><semantics id="A1.T5.50.50.50.50.2.m2.1a"><mrow id="A1.T5.50.50.50.50.2.m2.1.1" xref="A1.T5.50.50.50.50.2.m2.1.1.cmml"><mi id="A1.T5.50.50.50.50.2.m2.1.1.2" xref="A1.T5.50.50.50.50.2.m2.1.1.2.cmml">ρ</mi><mo id="A1.T5.50.50.50.50.2.m2.1.1.1" xref="A1.T5.50.50.50.50.2.m2.1.1.1.cmml">=</mo><mn id="A1.T5.50.50.50.50.2.m2.1.1.3" xref="A1.T5.50.50.50.50.2.m2.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.50.50.50.50.2.m2.1b"><apply id="A1.T5.50.50.50.50.2.m2.1.1.cmml" xref="A1.T5.50.50.50.50.2.m2.1.1"><eq id="A1.T5.50.50.50.50.2.m2.1.1.1.cmml" xref="A1.T5.50.50.50.50.2.m2.1.1.1"></eq><ci id="A1.T5.50.50.50.50.2.m2.1.1.2.cmml" xref="A1.T5.50.50.50.50.2.m2.1.1.2">𝜌</ci><cn type="float" id="A1.T5.50.50.50.50.2.m2.1.1.3.cmml" xref="A1.T5.50.50.50.50.2.m2.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.50.50.50.50.2.m2.1c">\rho=0.001</annotation></semantics></math>
</th>
<td id="A1.T5.52.52.52.52.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">High-pers</td>
<td id="A1.T5.52.52.52.52.7" class="ltx_td ltx_border_bb ltx_border_t"></td>
<td id="A1.T5.51.51.51.51.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="A1.T5.51.51.51.51.3.m1.1" class="ltx_Math" alttext="\beta=0.009" display="inline"><semantics id="A1.T5.51.51.51.51.3.m1.1a"><mrow id="A1.T5.51.51.51.51.3.m1.1.1" xref="A1.T5.51.51.51.51.3.m1.1.1.cmml"><mi id="A1.T5.51.51.51.51.3.m1.1.1.2" xref="A1.T5.51.51.51.51.3.m1.1.1.2.cmml">β</mi><mo id="A1.T5.51.51.51.51.3.m1.1.1.1" xref="A1.T5.51.51.51.51.3.m1.1.1.1.cmml">=</mo><mn id="A1.T5.51.51.51.51.3.m1.1.1.3" xref="A1.T5.51.51.51.51.3.m1.1.1.3.cmml">0.009</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.51.51.51.51.3.m1.1b"><apply id="A1.T5.51.51.51.51.3.m1.1.1.cmml" xref="A1.T5.51.51.51.51.3.m1.1.1"><eq id="A1.T5.51.51.51.51.3.m1.1.1.1.cmml" xref="A1.T5.51.51.51.51.3.m1.1.1.1"></eq><ci id="A1.T5.51.51.51.51.3.m1.1.1.2.cmml" xref="A1.T5.51.51.51.51.3.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.51.51.51.51.3.m1.1.1.3.cmml" xref="A1.T5.51.51.51.51.3.m1.1.1.3">0.009</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.51.51.51.51.3.m1.1c">\beta=0.009</annotation></semantics></math></td>
<td id="A1.T5.52.52.52.52.8" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">High-pers</td>
<td id="A1.T5.52.52.52.52.9" class="ltx_td ltx_border_bb ltx_border_t"></td>
<td id="A1.T5.52.52.52.52.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t"><math id="A1.T5.52.52.52.52.4.m1.1" class="ltx_Math" alttext="\beta=0.009" display="inline"><semantics id="A1.T5.52.52.52.52.4.m1.1a"><mrow id="A1.T5.52.52.52.52.4.m1.1.1" xref="A1.T5.52.52.52.52.4.m1.1.1.cmml"><mi id="A1.T5.52.52.52.52.4.m1.1.1.2" xref="A1.T5.52.52.52.52.4.m1.1.1.2.cmml">β</mi><mo id="A1.T5.52.52.52.52.4.m1.1.1.1" xref="A1.T5.52.52.52.52.4.m1.1.1.1.cmml">=</mo><mn id="A1.T5.52.52.52.52.4.m1.1.1.3" xref="A1.T5.52.52.52.52.4.m1.1.1.3.cmml">0.009</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T5.52.52.52.52.4.m1.1b"><apply id="A1.T5.52.52.52.52.4.m1.1.1.cmml" xref="A1.T5.52.52.52.52.4.m1.1.1"><eq id="A1.T5.52.52.52.52.4.m1.1.1.1.cmml" xref="A1.T5.52.52.52.52.4.m1.1.1.1"></eq><ci id="A1.T5.52.52.52.52.4.m1.1.1.2.cmml" xref="A1.T5.52.52.52.52.4.m1.1.1.2">𝛽</ci><cn type="float" id="A1.T5.52.52.52.52.4.m1.1.1.3.cmml" xref="A1.T5.52.52.52.52.4.m1.1.1.3">0.009</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T5.52.52.52.52.4.m1.1c">\beta=0.009</annotation></semantics></math></td>
<td id="A1.T5.52.52.52.52.10" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t">High-pers</td>
<td id="A1.T5.52.52.52.52.11" class="ltx_td ltx_border_bb ltx_border_t"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Additional Experiments</h2>

<section id="A2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>Personalization study for MNIST, Fashion-MNIST and CIFAR-10 datasets</h3>

<div id="A2.SS1.p1" class="ltx_para">
<p id="A2.SS1.p1.1" class="ltx_p">We provide the experiments of MNIST, Fashion-MNIST, EMNIST and CIFAR-10 on all three degrees of personalization. Our algorithm outperforms the other baselines in the high personalization cases, and FedAvg outperforms the other algorithms when personalization is not needed.</p>
</div>
<figure id="A2.F8" class="ltx_figure">
<br class="ltx_break">
<table id="A2.F8.6.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.F8.3.3.3" class="ltx_tr">
<td id="A2.F8.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x22.png" id="A2.F8.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="101" height="64" alt="Refer to caption"></td>
<td id="A2.F8.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x23.png" id="A2.F8.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="100" height="64" alt="Refer to caption"></td>
<td id="A2.F8.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x24.png" id="A2.F8.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="97" height="64" alt="Refer to caption"></td>
</tr>
<tr id="A2.F8.6.6.6" class="ltx_tr">
<td id="A2.F8.4.4.4.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x25.png" id="A2.F8.4.4.4.1.g1" class="ltx_graphics ltx_img_landscape" width="101" height="64" alt="Refer to caption"></td>
<td id="A2.F8.5.5.5.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x26.png" id="A2.F8.5.5.5.2.g1" class="ltx_graphics ltx_img_landscape" width="106" height="64" alt="Refer to caption"></td>
<td id="A2.F8.6.6.6.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x27.png" id="A2.F8.6.6.6.3.g1" class="ltx_graphics ltx_img_landscape" width="100" height="64" alt="Refer to caption"></td>
</tr>
<tr id="A2.F8.6.6.7.1" class="ltx_tr">
<td id="A2.F8.6.6.7.1.1" class="ltx_td ltx_align_center">High-pers</td>
<td id="A2.F8.6.6.7.1.2" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A2.F8.6.6.7.1.3" class="ltx_td ltx_align_center">No-pers</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Train loss (top row) and test accuracy (bottom row) over 200 rounds of PFLEGO, FedAvg and FedPer on Fashion-MNIST. Each of the three columns corresponds to a certain degree of personalization. Settings: 100 clients, 200 rounds 50 inner steps, r=20.
</figcaption>
</figure>
<figure id="A2.F9" class="ltx_figure">
<br class="ltx_break">
<table id="A2.F9.6.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.F9.3.3.3" class="ltx_tr">
<td id="A2.F9.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x28.png" id="A2.F9.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="101" height="64" alt="Refer to caption"></td>
<td id="A2.F9.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x29.png" id="A2.F9.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="100" height="64" alt="Refer to caption"></td>
<td id="A2.F9.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x30.png" id="A2.F9.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="100" height="64" alt="Refer to caption"></td>
</tr>
<tr id="A2.F9.6.6.6" class="ltx_tr">
<td id="A2.F9.4.4.4.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x31.png" id="A2.F9.4.4.4.1.g1" class="ltx_graphics ltx_img_landscape" width="101" height="63" alt="Refer to caption"></td>
<td id="A2.F9.5.5.5.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x32.png" id="A2.F9.5.5.5.2.g1" class="ltx_graphics ltx_img_landscape" width="100" height="64" alt="Refer to caption"></td>
<td id="A2.F9.6.6.6.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x33.png" id="A2.F9.6.6.6.3.g1" class="ltx_graphics ltx_img_landscape" width="100" height="64" alt="Refer to caption"></td>
</tr>
<tr id="A2.F9.6.6.7.1" class="ltx_tr">
<td id="A2.F9.6.6.7.1.1" class="ltx_td ltx_align_center">High-pers</td>
<td id="A2.F9.6.6.7.1.2" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A2.F9.6.6.7.1.3" class="ltx_td ltx_align_center">No-pers</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Train loss (top row) and test accuracy (bottom row) over 200 rounds of PFLEGO, FedAvg and FedPer with CNN model on CIFAR-10 dataset. Each of the three columns corresponds to a certain degree of personalization. Settings: 100 clients, 200 rounds 50 inner steps, r=20.
</figcaption>
</figure>
<figure id="A2.F10" class="ltx_figure">
<br class="ltx_break">
<table id="A2.F10.6.6" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.F10.3.3.3" class="ltx_tr">
<td id="A2.F10.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x34.png" id="A2.F10.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="110" height="68" alt="Refer to caption"></td>
<td id="A2.F10.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x35.png" id="A2.F10.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="106" height="68" alt="Refer to caption"></td>
<td id="A2.F10.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x36.png" id="A2.F10.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="106" height="68" alt="Refer to caption"></td>
</tr>
<tr id="A2.F10.6.6.6" class="ltx_tr">
<td id="A2.F10.4.4.4.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x37.png" id="A2.F10.4.4.4.1.g1" class="ltx_graphics ltx_img_landscape" width="110" height="68" alt="Refer to caption"></td>
<td id="A2.F10.5.5.5.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x38.png" id="A2.F10.5.5.5.2.g1" class="ltx_graphics ltx_img_landscape" width="106" height="68" alt="Refer to caption"></td>
<td id="A2.F10.6.6.6.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x39.png" id="A2.F10.6.6.6.3.g1" class="ltx_graphics ltx_img_landscape" width="106" height="68" alt="Refer to caption"></td>
</tr>
<tr id="A2.F10.6.6.7.1" class="ltx_tr">
<td id="A2.F10.6.6.7.1.1" class="ltx_td ltx_align_center">High-pers</td>
<td id="A2.F10.6.6.7.1.2" class="ltx_td ltx_align_center">Medium-pers</td>
<td id="A2.F10.6.6.7.1.3" class="ltx_td ltx_align_center">No-pers</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>Train loss (top row) and test accuracy (bottom row) over 200 rounds of PFLEGO, FedAvg and FedPer with MLP model on Emnist dataset. Each of the three columns corresponds to a certain degree of personalization. Settings: 100 clients, 200 rounds 50 inner steps, r=20.
</figcaption>
</figure>
</section>
<section id="A2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Accuracy on effect of participation</h3>

<div id="A2.SS2.p1" class="ltx_para">
<p id="A2.SS2.p1.1" class="ltx_p">We provide the test accuracy on the study conducted for the effect of participation, see Figure <a href="#A2.F11" title="Figure 11 ‣ B.2 Accuracy on effect of participation ‣ Appendix B Additional Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>. The more we increase the number of participation, the more gradients will be sent back to the server for aggregation. Then the server can perform an SGD step to the common weights that minimizes the total loss. (<a href="#S3.E1" title="Equation 1 ‣ 3.1.1 Training Objective for Classification ‣ 3.1 Personalized FL Setting ‣ 3 Proposed Framework ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<figure id="A2.F11" class="ltx_figure">
<br class="ltx_break">
<table id="A2.F11.8.8" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.F11.4.4.4" class="ltx_tr">
<td id="A2.F11.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x40.png" id="A2.F11.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="85" height="54" alt="Refer to caption"></td>
<td id="A2.F11.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x41.png" id="A2.F11.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="85" height="54" alt="Refer to caption"></td>
<td id="A2.F11.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x42.png" id="A2.F11.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="85" height="54" alt="Refer to caption"></td>
<td id="A2.F11.4.4.4.4" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x43.png" id="A2.F11.4.4.4.4.g1" class="ltx_graphics ltx_img_landscape" width="85" height="54" alt="Refer to caption"></td>
</tr>
<tr id="A2.F11.8.8.8" class="ltx_tr">
<td id="A2.F11.5.5.5.1" class="ltx_td ltx_align_center"><math id="A2.F11.5.5.5.1.m1.1" class="ltx_Math" alttext="r=20\%" display="inline"><semantics id="A2.F11.5.5.5.1.m1.1a"><mrow id="A2.F11.5.5.5.1.m1.1.1" xref="A2.F11.5.5.5.1.m1.1.1.cmml"><mi id="A2.F11.5.5.5.1.m1.1.1.2" xref="A2.F11.5.5.5.1.m1.1.1.2.cmml">r</mi><mo id="A2.F11.5.5.5.1.m1.1.1.1" xref="A2.F11.5.5.5.1.m1.1.1.1.cmml">=</mo><mrow id="A2.F11.5.5.5.1.m1.1.1.3" xref="A2.F11.5.5.5.1.m1.1.1.3.cmml"><mn id="A2.F11.5.5.5.1.m1.1.1.3.2" xref="A2.F11.5.5.5.1.m1.1.1.3.2.cmml">20</mn><mo id="A2.F11.5.5.5.1.m1.1.1.3.1" xref="A2.F11.5.5.5.1.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F11.5.5.5.1.m1.1b"><apply id="A2.F11.5.5.5.1.m1.1.1.cmml" xref="A2.F11.5.5.5.1.m1.1.1"><eq id="A2.F11.5.5.5.1.m1.1.1.1.cmml" xref="A2.F11.5.5.5.1.m1.1.1.1"></eq><ci id="A2.F11.5.5.5.1.m1.1.1.2.cmml" xref="A2.F11.5.5.5.1.m1.1.1.2">𝑟</ci><apply id="A2.F11.5.5.5.1.m1.1.1.3.cmml" xref="A2.F11.5.5.5.1.m1.1.1.3"><csymbol cd="latexml" id="A2.F11.5.5.5.1.m1.1.1.3.1.cmml" xref="A2.F11.5.5.5.1.m1.1.1.3.1">percent</csymbol><cn type="integer" id="A2.F11.5.5.5.1.m1.1.1.3.2.cmml" xref="A2.F11.5.5.5.1.m1.1.1.3.2">20</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.5.5.5.1.m1.1c">r=20\%</annotation></semantics></math></td>
<td id="A2.F11.6.6.6.2" class="ltx_td ltx_align_center"><math id="A2.F11.6.6.6.2.m1.1" class="ltx_Math" alttext="r=40\%" display="inline"><semantics id="A2.F11.6.6.6.2.m1.1a"><mrow id="A2.F11.6.6.6.2.m1.1.1" xref="A2.F11.6.6.6.2.m1.1.1.cmml"><mi id="A2.F11.6.6.6.2.m1.1.1.2" xref="A2.F11.6.6.6.2.m1.1.1.2.cmml">r</mi><mo id="A2.F11.6.6.6.2.m1.1.1.1" xref="A2.F11.6.6.6.2.m1.1.1.1.cmml">=</mo><mrow id="A2.F11.6.6.6.2.m1.1.1.3" xref="A2.F11.6.6.6.2.m1.1.1.3.cmml"><mn id="A2.F11.6.6.6.2.m1.1.1.3.2" xref="A2.F11.6.6.6.2.m1.1.1.3.2.cmml">40</mn><mo id="A2.F11.6.6.6.2.m1.1.1.3.1" xref="A2.F11.6.6.6.2.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F11.6.6.6.2.m1.1b"><apply id="A2.F11.6.6.6.2.m1.1.1.cmml" xref="A2.F11.6.6.6.2.m1.1.1"><eq id="A2.F11.6.6.6.2.m1.1.1.1.cmml" xref="A2.F11.6.6.6.2.m1.1.1.1"></eq><ci id="A2.F11.6.6.6.2.m1.1.1.2.cmml" xref="A2.F11.6.6.6.2.m1.1.1.2">𝑟</ci><apply id="A2.F11.6.6.6.2.m1.1.1.3.cmml" xref="A2.F11.6.6.6.2.m1.1.1.3"><csymbol cd="latexml" id="A2.F11.6.6.6.2.m1.1.1.3.1.cmml" xref="A2.F11.6.6.6.2.m1.1.1.3.1">percent</csymbol><cn type="integer" id="A2.F11.6.6.6.2.m1.1.1.3.2.cmml" xref="A2.F11.6.6.6.2.m1.1.1.3.2">40</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.6.6.6.2.m1.1c">r=40\%</annotation></semantics></math></td>
<td id="A2.F11.7.7.7.3" class="ltx_td ltx_align_center"><math id="A2.F11.7.7.7.3.m1.1" class="ltx_Math" alttext="r=60\%" display="inline"><semantics id="A2.F11.7.7.7.3.m1.1a"><mrow id="A2.F11.7.7.7.3.m1.1.1" xref="A2.F11.7.7.7.3.m1.1.1.cmml"><mi id="A2.F11.7.7.7.3.m1.1.1.2" xref="A2.F11.7.7.7.3.m1.1.1.2.cmml">r</mi><mo id="A2.F11.7.7.7.3.m1.1.1.1" xref="A2.F11.7.7.7.3.m1.1.1.1.cmml">=</mo><mrow id="A2.F11.7.7.7.3.m1.1.1.3" xref="A2.F11.7.7.7.3.m1.1.1.3.cmml"><mn id="A2.F11.7.7.7.3.m1.1.1.3.2" xref="A2.F11.7.7.7.3.m1.1.1.3.2.cmml">60</mn><mo id="A2.F11.7.7.7.3.m1.1.1.3.1" xref="A2.F11.7.7.7.3.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F11.7.7.7.3.m1.1b"><apply id="A2.F11.7.7.7.3.m1.1.1.cmml" xref="A2.F11.7.7.7.3.m1.1.1"><eq id="A2.F11.7.7.7.3.m1.1.1.1.cmml" xref="A2.F11.7.7.7.3.m1.1.1.1"></eq><ci id="A2.F11.7.7.7.3.m1.1.1.2.cmml" xref="A2.F11.7.7.7.3.m1.1.1.2">𝑟</ci><apply id="A2.F11.7.7.7.3.m1.1.1.3.cmml" xref="A2.F11.7.7.7.3.m1.1.1.3"><csymbol cd="latexml" id="A2.F11.7.7.7.3.m1.1.1.3.1.cmml" xref="A2.F11.7.7.7.3.m1.1.1.3.1">percent</csymbol><cn type="integer" id="A2.F11.7.7.7.3.m1.1.1.3.2.cmml" xref="A2.F11.7.7.7.3.m1.1.1.3.2">60</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.7.7.7.3.m1.1c">r=60\%</annotation></semantics></math></td>
<td id="A2.F11.8.8.8.4" class="ltx_td ltx_align_center"><math id="A2.F11.8.8.8.4.m1.1" class="ltx_Math" alttext="r=100\%" display="inline"><semantics id="A2.F11.8.8.8.4.m1.1a"><mrow id="A2.F11.8.8.8.4.m1.1.1" xref="A2.F11.8.8.8.4.m1.1.1.cmml"><mi id="A2.F11.8.8.8.4.m1.1.1.2" xref="A2.F11.8.8.8.4.m1.1.1.2.cmml">r</mi><mo id="A2.F11.8.8.8.4.m1.1.1.1" xref="A2.F11.8.8.8.4.m1.1.1.1.cmml">=</mo><mrow id="A2.F11.8.8.8.4.m1.1.1.3" xref="A2.F11.8.8.8.4.m1.1.1.3.cmml"><mn id="A2.F11.8.8.8.4.m1.1.1.3.2" xref="A2.F11.8.8.8.4.m1.1.1.3.2.cmml">100</mn><mo id="A2.F11.8.8.8.4.m1.1.1.3.1" xref="A2.F11.8.8.8.4.m1.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F11.8.8.8.4.m1.1b"><apply id="A2.F11.8.8.8.4.m1.1.1.cmml" xref="A2.F11.8.8.8.4.m1.1.1"><eq id="A2.F11.8.8.8.4.m1.1.1.1.cmml" xref="A2.F11.8.8.8.4.m1.1.1.1"></eq><ci id="A2.F11.8.8.8.4.m1.1.1.2.cmml" xref="A2.F11.8.8.8.4.m1.1.1.2">𝑟</ci><apply id="A2.F11.8.8.8.4.m1.1.1.3.cmml" xref="A2.F11.8.8.8.4.m1.1.1.3"><csymbol cd="latexml" id="A2.F11.8.8.8.4.m1.1.1.3.1.cmml" xref="A2.F11.8.8.8.4.m1.1.1.3.1">percent</csymbol><cn type="integer" id="A2.F11.8.8.8.4.m1.1.1.3.2.cmml" xref="A2.F11.8.8.8.4.m1.1.1.3.2">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.8.8.8.4.m1.1c">r=100\%</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Test accuracy of the ablation study of client participation using the CIFAR-10 for the High-pers case. PFLEGO is compared against FedAvg and FedPer in terms of the ability to minimize the train loss across rounds. The panel in each column corresponds to a different
participation percentage <math id="A2.F11.10.10.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="A2.F11.10.10.m1.1b"><mi id="A2.F11.10.10.m1.1.1" xref="A2.F11.10.10.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="A2.F11.10.10.m1.1c"><ci id="A2.F11.10.10.m1.1.1.cmml" xref="A2.F11.10.10.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="A2.F11.10.10.m1.1d">r</annotation></semantics></math>.</figcaption>
</figure>
</section>
<section id="A2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.3 </span>Experiments for FedRecon</h3>

<div id="A2.SS3.p1" class="ltx_para">
<p id="A2.SS3.p1.2" class="ltx_p">We provide an additional experiment for the Omniglot dataset, and we compare the stohastic block coordinate FedRecon algorithm with our approach PFLEGO that uses a SGD scheme. In Figure <a href="#A2.F12" title="Figure 12 ‣ B.3 Experiments for FedRecon ‣ Appendix B Additional Experiments ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a> we include the visual comparison between FedRecon and PFLEGO, in which we can see the performance gains of PFLEGO regarding convergence speed, e.g. PFLEGO has lower training loss. The best hyperparameters for PFLEGO and FedRecon are <math id="A2.SS3.p1.1.m1.1" class="ltx_Math" alttext="\rho=0.001" display="inline"><semantics id="A2.SS3.p1.1.m1.1a"><mrow id="A2.SS3.p1.1.m1.1.1" xref="A2.SS3.p1.1.m1.1.1.cmml"><mi id="A2.SS3.p1.1.m1.1.1.2" xref="A2.SS3.p1.1.m1.1.1.2.cmml">ρ</mi><mo id="A2.SS3.p1.1.m1.1.1.1" xref="A2.SS3.p1.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS3.p1.1.m1.1.1.3" xref="A2.SS3.p1.1.m1.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.1.m1.1b"><apply id="A2.SS3.p1.1.m1.1.1.cmml" xref="A2.SS3.p1.1.m1.1.1"><eq id="A2.SS3.p1.1.m1.1.1.1.cmml" xref="A2.SS3.p1.1.m1.1.1.1"></eq><ci id="A2.SS3.p1.1.m1.1.1.2.cmml" xref="A2.SS3.p1.1.m1.1.1.2">𝜌</ci><cn type="float" id="A2.SS3.p1.1.m1.1.1.3.cmml" xref="A2.SS3.p1.1.m1.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.1.m1.1c">\rho=0.001</annotation></semantics></math> and <math id="A2.SS3.p1.2.m2.1" class="ltx_Math" alttext="\beta=0.009" display="inline"><semantics id="A2.SS3.p1.2.m2.1a"><mrow id="A2.SS3.p1.2.m2.1.1" xref="A2.SS3.p1.2.m2.1.1.cmml"><mi id="A2.SS3.p1.2.m2.1.1.2" xref="A2.SS3.p1.2.m2.1.1.2.cmml">β</mi><mo id="A2.SS3.p1.2.m2.1.1.1" xref="A2.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="A2.SS3.p1.2.m2.1.1.3" xref="A2.SS3.p1.2.m2.1.1.3.cmml">0.009</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.SS3.p1.2.m2.1b"><apply id="A2.SS3.p1.2.m2.1.1.cmml" xref="A2.SS3.p1.2.m2.1.1"><eq id="A2.SS3.p1.2.m2.1.1.1.cmml" xref="A2.SS3.p1.2.m2.1.1.1"></eq><ci id="A2.SS3.p1.2.m2.1.1.2.cmml" xref="A2.SS3.p1.2.m2.1.1.2">𝛽</ci><cn type="float" id="A2.SS3.p1.2.m2.1.1.3.cmml" xref="A2.SS3.p1.2.m2.1.1.3">0.009</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS3.p1.2.m2.1c">\beta=0.009</annotation></semantics></math></p>
</div>
<figure id="A2.F12" class="ltx_figure">
<br class="ltx_break">
<table id="A2.F12.3.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.F12.3.3.3" class="ltx_tr">
<td id="A2.F12.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x44.png" id="A2.F12.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="111" height="66" alt="Refer to caption"></td>
<td id="A2.F12.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x45.png" id="A2.F12.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="111" height="66" alt="Refer to caption"></td>
<td id="A2.F12.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2202.09848/assets/x46.png" id="A2.F12.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="111" height="66" alt="Refer to caption"></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Training loss (left), training accuracy (middle) and test accuracy (right) for the Omniglot dataset for PFLEGO and FedRecon. Settings: <math id="A2.F12.9.9.m1.1" class="ltx_Math" alttext="50" display="inline"><semantics id="A2.F12.9.9.m1.1b"><mn id="A2.F12.9.9.m1.1.1" xref="A2.F12.9.9.m1.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="A2.F12.9.9.m1.1c"><cn type="integer" id="A2.F12.9.9.m1.1.1.cmml" xref="A2.F12.9.9.m1.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.F12.9.9.m1.1d">50</annotation></semantics></math> clients, <math id="A2.F12.10.10.m2.1" class="ltx_Math" alttext="5000" display="inline"><semantics id="A2.F12.10.10.m2.1b"><mn id="A2.F12.10.10.m2.1.1" xref="A2.F12.10.10.m2.1.1.cmml">5000</mn><annotation-xml encoding="MathML-Content" id="A2.F12.10.10.m2.1c"><cn type="integer" id="A2.F12.10.10.m2.1.1.cmml" xref="A2.F12.10.10.m2.1.1">5000</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.F12.10.10.m2.1d">5000</annotation></semantics></math> rounds <math id="A2.F12.11.11.m3.1" class="ltx_Math" alttext="50" display="inline"><semantics id="A2.F12.11.11.m3.1b"><mn id="A2.F12.11.11.m3.1.1" xref="A2.F12.11.11.m3.1.1.cmml">50</mn><annotation-xml encoding="MathML-Content" id="A2.F12.11.11.m3.1c"><cn type="integer" id="A2.F12.11.11.m3.1.1.cmml" xref="A2.F12.11.11.m3.1.1">50</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.F12.11.11.m3.1d">50</annotation></semantics></math> inner
steps, <math id="A2.F12.12.12.m4.2" class="ltx_Math" alttext="r=20,\rho=0.001" display="inline"><semantics id="A2.F12.12.12.m4.2b"><mrow id="A2.F12.12.12.m4.2.2.2" xref="A2.F12.12.12.m4.2.2.3.cmml"><mrow id="A2.F12.12.12.m4.1.1.1.1" xref="A2.F12.12.12.m4.1.1.1.1.cmml"><mi id="A2.F12.12.12.m4.1.1.1.1.2" xref="A2.F12.12.12.m4.1.1.1.1.2.cmml">r</mi><mo id="A2.F12.12.12.m4.1.1.1.1.1" xref="A2.F12.12.12.m4.1.1.1.1.1.cmml">=</mo><mn id="A2.F12.12.12.m4.1.1.1.1.3" xref="A2.F12.12.12.m4.1.1.1.1.3.cmml">20</mn></mrow><mo id="A2.F12.12.12.m4.2.2.2.3" xref="A2.F12.12.12.m4.2.2.3a.cmml">,</mo><mrow id="A2.F12.12.12.m4.2.2.2.2" xref="A2.F12.12.12.m4.2.2.2.2.cmml"><mi id="A2.F12.12.12.m4.2.2.2.2.2" xref="A2.F12.12.12.m4.2.2.2.2.2.cmml">ρ</mi><mo id="A2.F12.12.12.m4.2.2.2.2.1" xref="A2.F12.12.12.m4.2.2.2.2.1.cmml">=</mo><mn id="A2.F12.12.12.m4.2.2.2.2.3" xref="A2.F12.12.12.m4.2.2.2.2.3.cmml">0.001</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.F12.12.12.m4.2c"><apply id="A2.F12.12.12.m4.2.2.3.cmml" xref="A2.F12.12.12.m4.2.2.2"><csymbol cd="ambiguous" id="A2.F12.12.12.m4.2.2.3a.cmml" xref="A2.F12.12.12.m4.2.2.2.3">formulae-sequence</csymbol><apply id="A2.F12.12.12.m4.1.1.1.1.cmml" xref="A2.F12.12.12.m4.1.1.1.1"><eq id="A2.F12.12.12.m4.1.1.1.1.1.cmml" xref="A2.F12.12.12.m4.1.1.1.1.1"></eq><ci id="A2.F12.12.12.m4.1.1.1.1.2.cmml" xref="A2.F12.12.12.m4.1.1.1.1.2">𝑟</ci><cn type="integer" id="A2.F12.12.12.m4.1.1.1.1.3.cmml" xref="A2.F12.12.12.m4.1.1.1.1.3">20</cn></apply><apply id="A2.F12.12.12.m4.2.2.2.2.cmml" xref="A2.F12.12.12.m4.2.2.2.2"><eq id="A2.F12.12.12.m4.2.2.2.2.1.cmml" xref="A2.F12.12.12.m4.2.2.2.2.1"></eq><ci id="A2.F12.12.12.m4.2.2.2.2.2.cmml" xref="A2.F12.12.12.m4.2.2.2.2.2">𝜌</ci><cn type="float" id="A2.F12.12.12.m4.2.2.2.2.3.cmml" xref="A2.F12.12.12.m4.2.2.2.2.3">0.001</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F12.12.12.m4.2d">r=20,\rho=0.001</annotation></semantics></math>, <math id="A2.F12.13.13.m5.1" class="ltx_Math" alttext="\beta=0.009" display="inline"><semantics id="A2.F12.13.13.m5.1b"><mrow id="A2.F12.13.13.m5.1.1" xref="A2.F12.13.13.m5.1.1.cmml"><mi id="A2.F12.13.13.m5.1.1.2" xref="A2.F12.13.13.m5.1.1.2.cmml">β</mi><mo id="A2.F12.13.13.m5.1.1.1" xref="A2.F12.13.13.m5.1.1.1.cmml">=</mo><mn id="A2.F12.13.13.m5.1.1.3" xref="A2.F12.13.13.m5.1.1.3.cmml">0.009</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F12.13.13.m5.1c"><apply id="A2.F12.13.13.m5.1.1.cmml" xref="A2.F12.13.13.m5.1.1"><eq id="A2.F12.13.13.m5.1.1.1.cmml" xref="A2.F12.13.13.m5.1.1.1"></eq><ci id="A2.F12.13.13.m5.1.1.2.cmml" xref="A2.F12.13.13.m5.1.1.2">𝛽</ci><cn type="float" id="A2.F12.13.13.m5.1.1.3.cmml" xref="A2.F12.13.13.m5.1.1.3">0.009</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F12.13.13.m5.1d">\beta=0.009</annotation></semantics></math>
</figcaption>
</figure>
<figure id="A2.T6" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span>Test accuracy for Omniglot dataset on high degree of
personalization for PFLEGO and FedRecon. The average is measured by averaging the last 10
global rounds of the first 1000 global round
</figcaption>
<br class="ltx_break">
<table id="A2.T6.2.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A2.T6.2.2.3.1" class="ltx_tr">
<td id="A2.T6.2.2.3.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="A2.T6.2.2.3.1.1.1" class="ltx_text" style="font-size:90%;">FedRecon</span></td>
<td id="A2.T6.2.2.3.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="A2.T6.2.2.3.1.2.1" class="ltx_text" style="font-size:90%;">PFLEGO</span></td>
</tr>
<tr id="A2.T6.2.2.2" class="ltx_tr">
<td id="A2.T6.1.1.1.1" class="ltx_td ltx_align_center ltx_border_bb">
<span id="A2.T6.1.1.1.1.1" class="ltx_text" style="font-size:90%;">74.06 </span><math id="A2.T6.1.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A2.T6.1.1.1.1.m1.1a"><mo mathsize="90%" id="A2.T6.1.1.1.1.m1.1.1" xref="A2.T6.1.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A2.T6.1.1.1.1.m1.1b"><csymbol cd="latexml" id="A2.T6.1.1.1.1.m1.1.1.cmml" xref="A2.T6.1.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.1.1.1.1.m1.1c">\pm</annotation></semantics></math><span id="A2.T6.1.1.1.1.2" class="ltx_text" style="font-size:90%;"> 1.19</span>
</td>
<td id="A2.T6.2.2.2.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="A2.T6.2.2.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">74.56 <math id="A2.T6.2.2.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="A2.T6.2.2.2.2.1.m1.1a"><mo id="A2.T6.2.2.2.2.1.m1.1.1" xref="A2.T6.2.2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="A2.T6.2.2.2.2.1.m1.1b"><csymbol cd="latexml" id="A2.T6.2.2.2.2.1.m1.1.1.cmml" xref="A2.T6.2.2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A2.T6.2.2.2.2.1.m1.1c">\pm</annotation></semantics></math> 1.23</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>FedPer, FedAvg and FedRecon algorithms</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">In this section we provide the pseudocodes for the Federated Averaging (FedAvg) and Federated Personalized (FedPer) algorithms that we used in our experiments for comparison against our algorithm PFLEGO.</p>
</div>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.8" class="ltx_p">In Algorithm <a href="#alg2" title="Algorithm 2 ‣ Appendix C FedPer, FedAvg and FedRecon algorithms ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> we provide the FedPer pseudocode. In this version the algorithm uses one personalized layer. At each round, the server selects a subset of clients and distributes the global parameters. Given the global parameters, these clients copy the global parameters to their global weights. Then, each client performs a number of gradient updates to its client-specific weights <math id="A3.p2.1.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="A3.p2.1.m1.1a"><msub id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml"><mi id="A3.p2.1.m1.1.1.2" xref="A3.p2.1.m1.1.1.2.cmml">W</mi><mi id="A3.p2.1.m1.1.1.3" xref="A3.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><apply id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p2.1.m1.1.1.1.cmml" xref="A3.p2.1.m1.1.1">subscript</csymbol><ci id="A3.p2.1.m1.1.1.2.cmml" xref="A3.p2.1.m1.1.1.2">𝑊</ci><ci id="A3.p2.1.m1.1.1.3.cmml" xref="A3.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">W_{i}</annotation></semantics></math> and to its global weights <math id="A3.p2.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A3.p2.2.m2.1a"><mi id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><ci id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">\theta</annotation></semantics></math>. Each client uses the same learning rate <math id="A3.p2.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="A3.p2.3.m3.1a"><mi id="A3.p2.3.m3.1.1" xref="A3.p2.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="A3.p2.3.m3.1b"><ci id="A3.p2.3.m3.1.1.cmml" xref="A3.p2.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m3.1c">\beta</annotation></semantics></math> on the gradient updates of <math id="A3.p2.4.m4.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="A3.p2.4.m4.1a"><msub id="A3.p2.4.m4.1.1" xref="A3.p2.4.m4.1.1.cmml"><mi id="A3.p2.4.m4.1.1.2" xref="A3.p2.4.m4.1.1.2.cmml">W</mi><mi id="A3.p2.4.m4.1.1.3" xref="A3.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p2.4.m4.1b"><apply id="A3.p2.4.m4.1.1.cmml" xref="A3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A3.p2.4.m4.1.1.1.cmml" xref="A3.p2.4.m4.1.1">subscript</csymbol><ci id="A3.p2.4.m4.1.1.2.cmml" xref="A3.p2.4.m4.1.1.2">𝑊</ci><ci id="A3.p2.4.m4.1.1.3.cmml" xref="A3.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.4.m4.1c">W_{i}</annotation></semantics></math> and of <math id="A3.p2.5.m5.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A3.p2.5.m5.1a"><mi id="A3.p2.5.m5.1.1" xref="A3.p2.5.m5.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A3.p2.5.m5.1b"><ci id="A3.p2.5.m5.1.1.cmml" xref="A3.p2.5.m5.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.5.m5.1c">\theta</annotation></semantics></math>. After the last gradient update step, each client returns its updated common weights <math id="A3.p2.6.m6.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A3.p2.6.m6.1a"><mi id="A3.p2.6.m6.1.1" xref="A3.p2.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A3.p2.6.m6.1b"><ci id="A3.p2.6.m6.1.1.cmml" xref="A3.p2.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.6.m6.1c">\theta</annotation></semantics></math> to the server.
The server collects the common weights from clients and averages them. Then the server sets the global model parameters to the average value, and proceeds to the next round. The personalized weights <math id="A3.p2.7.m7.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="A3.p2.7.m7.1a"><msub id="A3.p2.7.m7.1.1" xref="A3.p2.7.m7.1.1.cmml"><mi id="A3.p2.7.m7.1.1.2" xref="A3.p2.7.m7.1.1.2.cmml">W</mi><mi id="A3.p2.7.m7.1.1.3" xref="A3.p2.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p2.7.m7.1b"><apply id="A3.p2.7.m7.1.1.cmml" xref="A3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="A3.p2.7.m7.1.1.1.cmml" xref="A3.p2.7.m7.1.1">subscript</csymbol><ci id="A3.p2.7.m7.1.1.2.cmml" xref="A3.p2.7.m7.1.1.2">𝑊</ci><ci id="A3.p2.7.m7.1.1.3.cmml" xref="A3.p2.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.7.m7.1c">W_{i}</annotation></semantics></math> for FedPer and PFLEGO algorithm are initialized with uniform values in <math id="A3.p2.8.m8.2" class="ltx_Math" alttext="[0,1)" display="inline"><semantics id="A3.p2.8.m8.2a"><mrow id="A3.p2.8.m8.2.3.2" xref="A3.p2.8.m8.2.3.1.cmml"><mo stretchy="false" id="A3.p2.8.m8.2.3.2.1" xref="A3.p2.8.m8.2.3.1.cmml">[</mo><mn id="A3.p2.8.m8.1.1" xref="A3.p2.8.m8.1.1.cmml">0</mn><mo id="A3.p2.8.m8.2.3.2.2" xref="A3.p2.8.m8.2.3.1.cmml">,</mo><mn id="A3.p2.8.m8.2.2" xref="A3.p2.8.m8.2.2.cmml">1</mn><mo stretchy="false" id="A3.p2.8.m8.2.3.2.3" xref="A3.p2.8.m8.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.8.m8.2b"><interval closure="closed-open" id="A3.p2.8.m8.2.3.1.cmml" xref="A3.p2.8.m8.2.3.2"><cn type="integer" id="A3.p2.8.m8.1.1.cmml" xref="A3.p2.8.m8.1.1">0</cn><cn type="integer" id="A3.p2.8.m8.2.2.cmml" xref="A3.p2.8.m8.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.8.m8.2c">[0,1)</annotation></semantics></math>.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> FedPer</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">  <span id="alg2.l1.1" class="ltx_text ltx_font_bold">Input:</span> <math id="alg2.l1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">T</annotation></semantics></math> number of rounds, <math id="alg2.l1.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg2.l1.m2.1a"><mi id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><ci id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">\tau</annotation></semantics></math> local gradient updates, <math id="alg2.l1.m3.1" class="ltx_Math" alttext="I" display="inline"><semantics id="alg2.l1.m3.1a"><mi id="alg2.l1.m3.1.1" xref="alg2.l1.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m3.1b"><ci id="alg2.l1.m3.1.1.cmml" xref="alg2.l1.m3.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m3.1c">I</annotation></semantics></math> clients, <math id="alg2.l1.m4.1" class="ltx_Math" alttext="r\ll I" display="inline"><semantics id="alg2.l1.m4.1a"><mrow id="alg2.l1.m4.1.1" xref="alg2.l1.m4.1.1.cmml"><mi id="alg2.l1.m4.1.1.2" xref="alg2.l1.m4.1.1.2.cmml">r</mi><mo id="alg2.l1.m4.1.1.1" xref="alg2.l1.m4.1.1.1.cmml">≪</mo><mi id="alg2.l1.m4.1.1.3" xref="alg2.l1.m4.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m4.1b"><apply id="alg2.l1.m4.1.1.cmml" xref="alg2.l1.m4.1.1"><csymbol cd="latexml" id="alg2.l1.m4.1.1.1.cmml" xref="alg2.l1.m4.1.1.1">much-less-than</csymbol><ci id="alg2.l1.m4.1.1.2.cmml" xref="alg2.l1.m4.1.1.2">𝑟</ci><ci id="alg2.l1.m4.1.1.3.cmml" xref="alg2.l1.m4.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m4.1c">r\ll I</annotation></semantics></math> sampled clients per round,<math id="alg2.l1.m5.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="alg2.l1.m5.1a"><msub id="alg2.l1.m5.1.1" xref="alg2.l1.m5.1.1.cmml"><mi id="alg2.l1.m5.1.1.2" xref="alg2.l1.m5.1.1.2.cmml">N</mi><mi id="alg2.l1.m5.1.1.3" xref="alg2.l1.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.m5.1b"><apply id="alg2.l1.m5.1.1.cmml" xref="alg2.l1.m5.1.1"><csymbol cd="ambiguous" id="alg2.l1.m5.1.1.1.cmml" xref="alg2.l1.m5.1.1">subscript</csymbol><ci id="alg2.l1.m5.1.1.2.cmml" xref="alg2.l1.m5.1.1.2">𝑁</ci><ci id="alg2.l1.m5.1.1.3.cmml" xref="alg2.l1.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m5.1c">N_{i}</annotation></semantics></math> number of data samples at the <math id="alg2.l1.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l1.m6.1a"><mi id="alg2.l1.m6.1.1" xref="alg2.l1.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m6.1b"><ci id="alg2.l1.m6.1.1.cmml" xref="alg2.l1.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m6.1c">i</annotation></semantics></math>-th client
</div>
<div id="alg2.l2" class="ltx_listingline">  <span id="alg2.l2.1" class="ltx_text ltx_font_bold">Server:</span>




</div>
<div id="alg2.l3" class="ltx_listingline">     <span id="alg2.l3.1" class="ltx_text ltx_font_sansserif">Initialize</span> global parameters <math id="alg2.l3.m1.1" class="ltx_Math" alttext="\theta_{1}" display="inline"><semantics id="alg2.l3.m1.1a"><msub id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">θ</mi><mn id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1">subscript</csymbol><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝜃</ci><cn type="integer" id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">\theta_{1}</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">     <span id="alg2.l4.1" class="ltx_text ltx_font_bold">for</span>  round t<math id="alg2.l4.m1.4" class="ltx_Math" alttext="\,=1,2,...,T" display="inline"><semantics id="alg2.l4.m1.4a"><mrow id="alg2.l4.m1.4.5" xref="alg2.l4.m1.4.5.cmml"><mi id="alg2.l4.m1.4.5.2" xref="alg2.l4.m1.4.5.2.cmml"></mi><mo lspace="0.448em" id="alg2.l4.m1.4.5.1" xref="alg2.l4.m1.4.5.1.cmml">=</mo><mrow id="alg2.l4.m1.4.5.3.2" xref="alg2.l4.m1.4.5.3.1.cmml"><mn id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">1</mn><mo id="alg2.l4.m1.4.5.3.2.1" xref="alg2.l4.m1.4.5.3.1.cmml">,</mo><mn id="alg2.l4.m1.2.2" xref="alg2.l4.m1.2.2.cmml">2</mn><mo id="alg2.l4.m1.4.5.3.2.2" xref="alg2.l4.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l4.m1.3.3" xref="alg2.l4.m1.3.3.cmml">…</mi><mo id="alg2.l4.m1.4.5.3.2.3" xref="alg2.l4.m1.4.5.3.1.cmml">,</mo><mi id="alg2.l4.m1.4.4" xref="alg2.l4.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.4b"><apply id="alg2.l4.m1.4.5.cmml" xref="alg2.l4.m1.4.5"><eq id="alg2.l4.m1.4.5.1.cmml" xref="alg2.l4.m1.4.5.1"></eq><csymbol cd="latexml" id="alg2.l4.m1.4.5.2.cmml" xref="alg2.l4.m1.4.5.2">absent</csymbol><list id="alg2.l4.m1.4.5.3.1.cmml" xref="alg2.l4.m1.4.5.3.2"><cn type="integer" id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">1</cn><cn type="integer" id="alg2.l4.m1.2.2.cmml" xref="alg2.l4.m1.2.2">2</cn><ci id="alg2.l4.m1.3.3.cmml" xref="alg2.l4.m1.3.3">…</ci><ci id="alg2.l4.m1.4.4.cmml" xref="alg2.l4.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.4c">\,=1,2,...,T</annotation></semantics></math> <span id="alg2.l4.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l5" class="ltx_listingline">        <math id="alg2.l5.m1.1" class="ltx_Math" alttext="I_{t}\leftarrow" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><msub id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml"><mi id="alg2.l5.m1.1.1.2.2" xref="alg2.l5.m1.1.1.2.2.cmml">I</mi><mi id="alg2.l5.m1.1.1.2.3" xref="alg2.l5.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">←</mo><mi id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><ci id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1">←</ci><apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2.2">𝐼</ci><ci id="alg2.l5.m1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">I_{t}\leftarrow</annotation></semantics></math> (Select a random subset of r clients)

</div>
<div id="alg2.l6" class="ltx_listingline">        <span id="alg2.l6.1" class="ltx_text ltx_font_sansserif">Receive</span> <math id="alg2.l6.m1.1" class="ltx_Math" alttext="\theta_{i}^{\prime}" display="inline"><semantics id="alg2.l6.m1.1a"><msubsup id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mi id="alg2.l6.m1.1.1.2.2" xref="alg2.l6.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.l6.m1.1.1.2.3" xref="alg2.l6.m1.1.1.2.3.cmml">i</mi><mo id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1">superscript</csymbol><apply id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1">subscript</csymbol><ci id="alg2.l6.m1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.2.2">𝜃</ci><ci id="alg2.l6.m1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.2.3">𝑖</ci></apply><ci id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\theta_{i}^{\prime}</annotation></semantics></math> from each <span id="alg2.l6.2" class="ltx_text ltx_font_typewriter">client i</span> <math id="alg2.l6.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg2.l6.m2.1a"><mo id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><in id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">\in</annotation></semantics></math> <math id="alg2.l6.m3.1" class="ltx_Math" alttext="I_{t}" display="inline"><semantics id="alg2.l6.m3.1a"><msub id="alg2.l6.m3.1.1" xref="alg2.l6.m3.1.1.cmml"><mi id="alg2.l6.m3.1.1.2" xref="alg2.l6.m3.1.1.2.cmml">I</mi><mi id="alg2.l6.m3.1.1.3" xref="alg2.l6.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l6.m3.1b"><apply id="alg2.l6.m3.1.1.cmml" xref="alg2.l6.m3.1.1"><csymbol cd="ambiguous" id="alg2.l6.m3.1.1.1.cmml" xref="alg2.l6.m3.1.1">subscript</csymbol><ci id="alg2.l6.m3.1.1.2.cmml" xref="alg2.l6.m3.1.1.2">𝐼</ci><ci id="alg2.l6.m3.1.1.3.cmml" xref="alg2.l6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m3.1c">I_{t}</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">        <span id="alg2.l7.1" class="ltx_text ltx_font_sansserif">Aggregate: <math id="alg2.l7.1.m1.1" class="ltx_Math" alttext="\theta_{t+1}\leftarrow\sum_{i\in I_{t}}a_{i}\theta_{i}^{\prime}" display="inline"><semantics id="alg2.l7.1.m1.1a"><mrow id="alg2.l7.1.m1.1.1" xref="alg2.l7.1.m1.1.1.cmml"><msub id="alg2.l7.1.m1.1.1.2" xref="alg2.l7.1.m1.1.1.2.cmml"><mi id="alg2.l7.1.m1.1.1.2.2" xref="alg2.l7.1.m1.1.1.2.2.cmml">θ</mi><mrow id="alg2.l7.1.m1.1.1.2.3" xref="alg2.l7.1.m1.1.1.2.3.cmml"><mi id="alg2.l7.1.m1.1.1.2.3.2" xref="alg2.l7.1.m1.1.1.2.3.2.cmml">t</mi><mo id="alg2.l7.1.m1.1.1.2.3.1" xref="alg2.l7.1.m1.1.1.2.3.1.cmml">+</mo><mn id="alg2.l7.1.m1.1.1.2.3.3" xref="alg2.l7.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="alg2.l7.1.m1.1.1.1" xref="alg2.l7.1.m1.1.1.1.cmml">←</mo><mrow id="alg2.l7.1.m1.1.1.3" xref="alg2.l7.1.m1.1.1.3.cmml"><msub id="alg2.l7.1.m1.1.1.3.1" xref="alg2.l7.1.m1.1.1.3.1.cmml"><mo id="alg2.l7.1.m1.1.1.3.1.2" xref="alg2.l7.1.m1.1.1.3.1.2.cmml">∑</mo><mrow id="alg2.l7.1.m1.1.1.3.1.3" xref="alg2.l7.1.m1.1.1.3.1.3.cmml"><mi id="alg2.l7.1.m1.1.1.3.1.3.2" xref="alg2.l7.1.m1.1.1.3.1.3.2.cmml">i</mi><mo id="alg2.l7.1.m1.1.1.3.1.3.1" xref="alg2.l7.1.m1.1.1.3.1.3.1.cmml">∈</mo><msub id="alg2.l7.1.m1.1.1.3.1.3.3" xref="alg2.l7.1.m1.1.1.3.1.3.3.cmml"><mi id="alg2.l7.1.m1.1.1.3.1.3.3.2" xref="alg2.l7.1.m1.1.1.3.1.3.3.2.cmml">I</mi><mi id="alg2.l7.1.m1.1.1.3.1.3.3.3" xref="alg2.l7.1.m1.1.1.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="alg2.l7.1.m1.1.1.3.2" xref="alg2.l7.1.m1.1.1.3.2.cmml"><msub id="alg2.l7.1.m1.1.1.3.2.2" xref="alg2.l7.1.m1.1.1.3.2.2.cmml"><mi id="alg2.l7.1.m1.1.1.3.2.2.2" xref="alg2.l7.1.m1.1.1.3.2.2.2.cmml">a</mi><mi id="alg2.l7.1.m1.1.1.3.2.2.3" xref="alg2.l7.1.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l7.1.m1.1.1.3.2.1" xref="alg2.l7.1.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg2.l7.1.m1.1.1.3.2.3" xref="alg2.l7.1.m1.1.1.3.2.3.cmml"><mi id="alg2.l7.1.m1.1.1.3.2.3.2.2" xref="alg2.l7.1.m1.1.1.3.2.3.2.2.cmml">θ</mi><mi id="alg2.l7.1.m1.1.1.3.2.3.2.3" xref="alg2.l7.1.m1.1.1.3.2.3.2.3.cmml">i</mi><mo id="alg2.l7.1.m1.1.1.3.2.3.3" xref="alg2.l7.1.m1.1.1.3.2.3.3.cmml">′</mo></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.1.m1.1b"><apply id="alg2.l7.1.m1.1.1.cmml" xref="alg2.l7.1.m1.1.1"><ci id="alg2.l7.1.m1.1.1.1.cmml" xref="alg2.l7.1.m1.1.1.1">←</ci><apply id="alg2.l7.1.m1.1.1.2.cmml" xref="alg2.l7.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l7.1.m1.1.1.2.1.cmml" xref="alg2.l7.1.m1.1.1.2">subscript</csymbol><ci id="alg2.l7.1.m1.1.1.2.2.cmml" xref="alg2.l7.1.m1.1.1.2.2">𝜃</ci><apply id="alg2.l7.1.m1.1.1.2.3.cmml" xref="alg2.l7.1.m1.1.1.2.3"><plus id="alg2.l7.1.m1.1.1.2.3.1.cmml" xref="alg2.l7.1.m1.1.1.2.3.1"></plus><ci id="alg2.l7.1.m1.1.1.2.3.2.cmml" xref="alg2.l7.1.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg2.l7.1.m1.1.1.2.3.3.cmml" xref="alg2.l7.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg2.l7.1.m1.1.1.3.cmml" xref="alg2.l7.1.m1.1.1.3"><apply id="alg2.l7.1.m1.1.1.3.1.cmml" xref="alg2.l7.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg2.l7.1.m1.1.1.3.1.1.cmml" xref="alg2.l7.1.m1.1.1.3.1">subscript</csymbol><sum id="alg2.l7.1.m1.1.1.3.1.2.cmml" xref="alg2.l7.1.m1.1.1.3.1.2"></sum><apply id="alg2.l7.1.m1.1.1.3.1.3.cmml" xref="alg2.l7.1.m1.1.1.3.1.3"><in id="alg2.l7.1.m1.1.1.3.1.3.1.cmml" xref="alg2.l7.1.m1.1.1.3.1.3.1"></in><ci id="alg2.l7.1.m1.1.1.3.1.3.2.cmml" xref="alg2.l7.1.m1.1.1.3.1.3.2">𝑖</ci><apply id="alg2.l7.1.m1.1.1.3.1.3.3.cmml" xref="alg2.l7.1.m1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="alg2.l7.1.m1.1.1.3.1.3.3.1.cmml" xref="alg2.l7.1.m1.1.1.3.1.3.3">subscript</csymbol><ci id="alg2.l7.1.m1.1.1.3.1.3.3.2.cmml" xref="alg2.l7.1.m1.1.1.3.1.3.3.2">𝐼</ci><ci id="alg2.l7.1.m1.1.1.3.1.3.3.3.cmml" xref="alg2.l7.1.m1.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg2.l7.1.m1.1.1.3.2.cmml" xref="alg2.l7.1.m1.1.1.3.2"><times id="alg2.l7.1.m1.1.1.3.2.1.cmml" xref="alg2.l7.1.m1.1.1.3.2.1"></times><apply id="alg2.l7.1.m1.1.1.3.2.2.cmml" xref="alg2.l7.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg2.l7.1.m1.1.1.3.2.2.1.cmml" xref="alg2.l7.1.m1.1.1.3.2.2">subscript</csymbol><ci id="alg2.l7.1.m1.1.1.3.2.2.2.cmml" xref="alg2.l7.1.m1.1.1.3.2.2.2">𝑎</ci><ci id="alg2.l7.1.m1.1.1.3.2.2.3.cmml" xref="alg2.l7.1.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="alg2.l7.1.m1.1.1.3.2.3.cmml" xref="alg2.l7.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg2.l7.1.m1.1.1.3.2.3.1.cmml" xref="alg2.l7.1.m1.1.1.3.2.3">superscript</csymbol><apply id="alg2.l7.1.m1.1.1.3.2.3.2.cmml" xref="alg2.l7.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg2.l7.1.m1.1.1.3.2.3.2.1.cmml" xref="alg2.l7.1.m1.1.1.3.2.3">subscript</csymbol><ci id="alg2.l7.1.m1.1.1.3.2.3.2.2.cmml" xref="alg2.l7.1.m1.1.1.3.2.3.2.2">𝜃</ci><ci id="alg2.l7.1.m1.1.1.3.2.3.2.3.cmml" xref="alg2.l7.1.m1.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="alg2.l7.1.m1.1.1.3.2.3.3.cmml" xref="alg2.l7.1.m1.1.1.3.2.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.1.m1.1c">\theta_{t+1}\leftarrow\sum_{i\in I_{t}}a_{i}\theta_{i}^{\prime}</annotation></semantics></math></span>

</div>
<div id="alg2.l8" class="ltx_listingline">     <span id="alg2.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l8.2" class="ltx_text ltx_font_bold">for</span>

</div>
<div id="alg2.l9" class="ltx_listingline">  
</div>
<div id="alg2.l10" class="ltx_listingline">  <span id="alg2.l10.1" class="ltx_text ltx_font_bold">ClientI_Update(<math id="alg2.l10.1.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="alg2.l10.1.m1.1a"><msub id="alg2.l10.1.m1.1.1" xref="alg2.l10.1.m1.1.1.cmml"><mi id="alg2.l10.1.m1.1.1.2" xref="alg2.l10.1.m1.1.1.2.cmml">θ</mi><mi id="alg2.l10.1.m1.1.1.3" xref="alg2.l10.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l10.1.m1.1b"><apply id="alg2.l10.1.m1.1.1.cmml" xref="alg2.l10.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l10.1.m1.1.1.1.cmml" xref="alg2.l10.1.m1.1.1">subscript</csymbol><ci id="alg2.l10.1.m1.1.1.2.cmml" xref="alg2.l10.1.m1.1.1.2">𝜃</ci><ci id="alg2.l10.1.m1.1.1.3.cmml" xref="alg2.l10.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.1.m1.1c">\theta_{t}</annotation></semantics></math>):</span>#runs on client <math id="alg2.l10.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg2.l10.m1.1a"><mi id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><ci id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">i</annotation></semantics></math>




</div>
<div id="alg2.l11" class="ltx_listingline">     <span id="alg2.l11.1" class="ltx_text ltx_font_sansserif">Initialize</span> <math id="alg2.l11.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="alg2.l11.m1.1a"><msub id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><mi id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml">W</mi><mi id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1">subscript</csymbol><ci id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2">𝑊</ci><ci id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">W_{i}</annotation></semantics></math>, the first time the client is visited

</div>
<div id="alg2.l12" class="ltx_listingline">     <span id="alg2.l12.1" class="ltx_text ltx_font_sansserif">Copy</span> <math id="alg2.l12.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="alg2.l12.m1.1a"><msub id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mi id="alg2.l12.m1.1.1.2" xref="alg2.l12.m1.1.1.2.cmml">θ</mi><mi id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1">subscript</csymbol><ci id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1.2">𝜃</ci><ci id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">\theta_{t}</annotation></semantics></math> to <math id="alg2.l12.m2.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg2.l12.m2.1a"><msub id="alg2.l12.m2.1.1" xref="alg2.l12.m2.1.1.cmml"><mi id="alg2.l12.m2.1.1.2" xref="alg2.l12.m2.1.1.2.cmml">θ</mi><mi id="alg2.l12.m2.1.1.3" xref="alg2.l12.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l12.m2.1b"><apply id="alg2.l12.m2.1.1.cmml" xref="alg2.l12.m2.1.1"><csymbol cd="ambiguous" id="alg2.l12.m2.1.1.1.cmml" xref="alg2.l12.m2.1.1">subscript</csymbol><ci id="alg2.l12.m2.1.1.2.cmml" xref="alg2.l12.m2.1.1.2">𝜃</ci><ci id="alg2.l12.m2.1.1.3.cmml" xref="alg2.l12.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m2.1c">\theta_{i}</annotation></semantics></math>

</div>
<div id="alg2.l13" class="ltx_listingline">     <span id="alg2.l13.1" class="ltx_text ltx_font_bold">for</span>  local gradient
update <math id="alg2.l13.m1.4" class="ltx_Math" alttext="=1,2,...,\tau" display="inline"><semantics id="alg2.l13.m1.4a"><mrow id="alg2.l13.m1.4.5" xref="alg2.l13.m1.4.5.cmml"><mi id="alg2.l13.m1.4.5.2" xref="alg2.l13.m1.4.5.2.cmml"></mi><mo id="alg2.l13.m1.4.5.1" xref="alg2.l13.m1.4.5.1.cmml">=</mo><mrow id="alg2.l13.m1.4.5.3.2" xref="alg2.l13.m1.4.5.3.1.cmml"><mn id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml">1</mn><mo id="alg2.l13.m1.4.5.3.2.1" xref="alg2.l13.m1.4.5.3.1.cmml">,</mo><mn id="alg2.l13.m1.2.2" xref="alg2.l13.m1.2.2.cmml">2</mn><mo id="alg2.l13.m1.4.5.3.2.2" xref="alg2.l13.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l13.m1.3.3" xref="alg2.l13.m1.3.3.cmml">…</mi><mo id="alg2.l13.m1.4.5.3.2.3" xref="alg2.l13.m1.4.5.3.1.cmml">,</mo><mi id="alg2.l13.m1.4.4" xref="alg2.l13.m1.4.4.cmml">τ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.4b"><apply id="alg2.l13.m1.4.5.cmml" xref="alg2.l13.m1.4.5"><eq id="alg2.l13.m1.4.5.1.cmml" xref="alg2.l13.m1.4.5.1"></eq><csymbol cd="latexml" id="alg2.l13.m1.4.5.2.cmml" xref="alg2.l13.m1.4.5.2">absent</csymbol><list id="alg2.l13.m1.4.5.3.1.cmml" xref="alg2.l13.m1.4.5.3.2"><cn type="integer" id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">1</cn><cn type="integer" id="alg2.l13.m1.2.2.cmml" xref="alg2.l13.m1.2.2">2</cn><ci id="alg2.l13.m1.3.3.cmml" xref="alg2.l13.m1.3.3">…</ci><ci id="alg2.l13.m1.4.4.cmml" xref="alg2.l13.m1.4.4">𝜏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.4c">=1,2,...,\tau</annotation></semantics></math> <span id="alg2.l13.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l14" class="ltx_listingline">        <math id="alg2.l14.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="alg2.l14.m1.1a"><msub id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><mi id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml">W</mi><mi id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1">subscript</csymbol><ci id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2">𝑊</ci><ci id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">W_{i}</annotation></semantics></math> <math id="alg2.l14.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l14.m2.1a"><mo stretchy="false" id="alg2.l14.m2.1.1" xref="alg2.l14.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l14.m2.1b"><ci id="alg2.l14.m2.1.1.cmml" xref="alg2.l14.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg2.l14.m3.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="alg2.l14.m3.1a"><msub id="alg2.l14.m3.1.1" xref="alg2.l14.m3.1.1.cmml"><mi id="alg2.l14.m3.1.1.2" xref="alg2.l14.m3.1.1.2.cmml">W</mi><mi id="alg2.l14.m3.1.1.3" xref="alg2.l14.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l14.m3.1b"><apply id="alg2.l14.m3.1.1.cmml" xref="alg2.l14.m3.1.1"><csymbol cd="ambiguous" id="alg2.l14.m3.1.1.1.cmml" xref="alg2.l14.m3.1.1">subscript</csymbol><ci id="alg2.l14.m3.1.1.2.cmml" xref="alg2.l14.m3.1.1.2">𝑊</ci><ci id="alg2.l14.m3.1.1.3.cmml" xref="alg2.l14.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m3.1c">W_{i}</annotation></semantics></math> <math id="alg2.l14.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="alg2.l14.m4.1a"><mi id="alg2.l14.m4.1.1" xref="alg2.l14.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg2.l14.m4.1b"><ci id="alg2.l14.m4.1.1.cmml" xref="alg2.l14.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m4.1c">\beta</annotation></semantics></math> <math id="alg2.l14.m5.1" class="ltx_Math" alttext="\nabla_{W_{i}}" display="inline"><semantics id="alg2.l14.m5.1a"><msub id="alg2.l14.m5.1.1" xref="alg2.l14.m5.1.1.cmml"><mo id="alg2.l14.m5.1.1.2" xref="alg2.l14.m5.1.1.2.cmml">∇</mo><msub id="alg2.l14.m5.1.1.3" xref="alg2.l14.m5.1.1.3.cmml"><mi id="alg2.l14.m5.1.1.3.2" xref="alg2.l14.m5.1.1.3.2.cmml">W</mi><mi id="alg2.l14.m5.1.1.3.3" xref="alg2.l14.m5.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg2.l14.m5.1b"><apply id="alg2.l14.m5.1.1.cmml" xref="alg2.l14.m5.1.1"><csymbol cd="ambiguous" id="alg2.l14.m5.1.1.1.cmml" xref="alg2.l14.m5.1.1">subscript</csymbol><ci id="alg2.l14.m5.1.1.2.cmml" xref="alg2.l14.m5.1.1.2">∇</ci><apply id="alg2.l14.m5.1.1.3.cmml" xref="alg2.l14.m5.1.1.3"><csymbol cd="ambiguous" id="alg2.l14.m5.1.1.3.1.cmml" xref="alg2.l14.m5.1.1.3">subscript</csymbol><ci id="alg2.l14.m5.1.1.3.2.cmml" xref="alg2.l14.m5.1.1.3.2">𝑊</ci><ci id="alg2.l14.m5.1.1.3.3.cmml" xref="alg2.l14.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m5.1c">\nabla_{W_{i}}</annotation></semantics></math><math id="alg2.l14.m6.3" class="ltx_Math" alttext="\ell_{i}(\mathcal{D}_{i};W_{i},\theta_{i})" display="inline"><semantics id="alg2.l14.m6.3a"><mrow id="alg2.l14.m6.3.3" xref="alg2.l14.m6.3.3.cmml"><msub id="alg2.l14.m6.3.3.5" xref="alg2.l14.m6.3.3.5.cmml"><mi mathvariant="normal" id="alg2.l14.m6.3.3.5.2" xref="alg2.l14.m6.3.3.5.2.cmml">ℓ</mi><mi id="alg2.l14.m6.3.3.5.3" xref="alg2.l14.m6.3.3.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l14.m6.3.3.4" xref="alg2.l14.m6.3.3.4.cmml">​</mo><mrow id="alg2.l14.m6.3.3.3.3" xref="alg2.l14.m6.3.3.3.4.cmml"><mo stretchy="false" id="alg2.l14.m6.3.3.3.3.4" xref="alg2.l14.m6.3.3.3.4.cmml">(</mo><msub id="alg2.l14.m6.1.1.1.1.1" xref="alg2.l14.m6.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l14.m6.1.1.1.1.1.2" xref="alg2.l14.m6.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg2.l14.m6.1.1.1.1.1.3" xref="alg2.l14.m6.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.l14.m6.3.3.3.3.5" xref="alg2.l14.m6.3.3.3.4.cmml">;</mo><msub id="alg2.l14.m6.2.2.2.2.2" xref="alg2.l14.m6.2.2.2.2.2.cmml"><mi id="alg2.l14.m6.2.2.2.2.2.2" xref="alg2.l14.m6.2.2.2.2.2.2.cmml">W</mi><mi id="alg2.l14.m6.2.2.2.2.2.3" xref="alg2.l14.m6.2.2.2.2.2.3.cmml">i</mi></msub><mo id="alg2.l14.m6.3.3.3.3.6" xref="alg2.l14.m6.3.3.3.4.cmml">,</mo><msub id="alg2.l14.m6.3.3.3.3.3" xref="alg2.l14.m6.3.3.3.3.3.cmml"><mi id="alg2.l14.m6.3.3.3.3.3.2" xref="alg2.l14.m6.3.3.3.3.3.2.cmml">θ</mi><mi id="alg2.l14.m6.3.3.3.3.3.3" xref="alg2.l14.m6.3.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="alg2.l14.m6.3.3.3.3.7" xref="alg2.l14.m6.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m6.3b"><apply id="alg2.l14.m6.3.3.cmml" xref="alg2.l14.m6.3.3"><times id="alg2.l14.m6.3.3.4.cmml" xref="alg2.l14.m6.3.3.4"></times><apply id="alg2.l14.m6.3.3.5.cmml" xref="alg2.l14.m6.3.3.5"><csymbol cd="ambiguous" id="alg2.l14.m6.3.3.5.1.cmml" xref="alg2.l14.m6.3.3.5">subscript</csymbol><ci id="alg2.l14.m6.3.3.5.2.cmml" xref="alg2.l14.m6.3.3.5.2">ℓ</ci><ci id="alg2.l14.m6.3.3.5.3.cmml" xref="alg2.l14.m6.3.3.5.3">𝑖</ci></apply><list id="alg2.l14.m6.3.3.3.4.cmml" xref="alg2.l14.m6.3.3.3.3"><apply id="alg2.l14.m6.1.1.1.1.1.cmml" xref="alg2.l14.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m6.1.1.1.1.1.1.cmml" xref="alg2.l14.m6.1.1.1.1.1">subscript</csymbol><ci id="alg2.l14.m6.1.1.1.1.1.2.cmml" xref="alg2.l14.m6.1.1.1.1.1.2">𝒟</ci><ci id="alg2.l14.m6.1.1.1.1.1.3.cmml" xref="alg2.l14.m6.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l14.m6.2.2.2.2.2.cmml" xref="alg2.l14.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l14.m6.2.2.2.2.2.1.cmml" xref="alg2.l14.m6.2.2.2.2.2">subscript</csymbol><ci id="alg2.l14.m6.2.2.2.2.2.2.cmml" xref="alg2.l14.m6.2.2.2.2.2.2">𝑊</ci><ci id="alg2.l14.m6.2.2.2.2.2.3.cmml" xref="alg2.l14.m6.2.2.2.2.2.3">𝑖</ci></apply><apply id="alg2.l14.m6.3.3.3.3.3.cmml" xref="alg2.l14.m6.3.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l14.m6.3.3.3.3.3.1.cmml" xref="alg2.l14.m6.3.3.3.3.3">subscript</csymbol><ci id="alg2.l14.m6.3.3.3.3.3.2.cmml" xref="alg2.l14.m6.3.3.3.3.3.2">𝜃</ci><ci id="alg2.l14.m6.3.3.3.3.3.3.cmml" xref="alg2.l14.m6.3.3.3.3.3.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m6.3c">\ell_{i}(\mathcal{D}_{i};W_{i},\theta_{i})</annotation></semantics></math>

</div>
<div id="alg2.l15" class="ltx_listingline">        <math id="alg2.l15.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg2.l15.m1.1a"><msub id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">θ</mi><mi id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1">subscript</csymbol><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝜃</ci><ci id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">\theta_{i}</annotation></semantics></math> <math id="alg2.l15.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg2.l15.m2.1a"><mo stretchy="false" id="alg2.l15.m2.1.1" xref="alg2.l15.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg2.l15.m2.1b"><ci id="alg2.l15.m2.1.1.cmml" xref="alg2.l15.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg2.l15.m3.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg2.l15.m3.1a"><msub id="alg2.l15.m3.1.1" xref="alg2.l15.m3.1.1.cmml"><mi id="alg2.l15.m3.1.1.2" xref="alg2.l15.m3.1.1.2.cmml">θ</mi><mi id="alg2.l15.m3.1.1.3" xref="alg2.l15.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l15.m3.1b"><apply id="alg2.l15.m3.1.1.cmml" xref="alg2.l15.m3.1.1"><csymbol cd="ambiguous" id="alg2.l15.m3.1.1.1.cmml" xref="alg2.l15.m3.1.1">subscript</csymbol><ci id="alg2.l15.m3.1.1.2.cmml" xref="alg2.l15.m3.1.1.2">𝜃</ci><ci id="alg2.l15.m3.1.1.3.cmml" xref="alg2.l15.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m3.1c">\theta_{i}</annotation></semantics></math> - <math id="alg2.l15.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="alg2.l15.m4.1a"><mi id="alg2.l15.m4.1.1" xref="alg2.l15.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg2.l15.m4.1b"><ci id="alg2.l15.m4.1.1.cmml" xref="alg2.l15.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m4.1c">\beta</annotation></semantics></math> <math id="alg2.l15.m5.1" class="ltx_Math" alttext="\nabla_{\theta_{i}}" display="inline"><semantics id="alg2.l15.m5.1a"><msub id="alg2.l15.m5.1.1" xref="alg2.l15.m5.1.1.cmml"><mo id="alg2.l15.m5.1.1.2" xref="alg2.l15.m5.1.1.2.cmml">∇</mo><msub id="alg2.l15.m5.1.1.3" xref="alg2.l15.m5.1.1.3.cmml"><mi id="alg2.l15.m5.1.1.3.2" xref="alg2.l15.m5.1.1.3.2.cmml">θ</mi><mi id="alg2.l15.m5.1.1.3.3" xref="alg2.l15.m5.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg2.l15.m5.1b"><apply id="alg2.l15.m5.1.1.cmml" xref="alg2.l15.m5.1.1"><csymbol cd="ambiguous" id="alg2.l15.m5.1.1.1.cmml" xref="alg2.l15.m5.1.1">subscript</csymbol><ci id="alg2.l15.m5.1.1.2.cmml" xref="alg2.l15.m5.1.1.2">∇</ci><apply id="alg2.l15.m5.1.1.3.cmml" xref="alg2.l15.m5.1.1.3"><csymbol cd="ambiguous" id="alg2.l15.m5.1.1.3.1.cmml" xref="alg2.l15.m5.1.1.3">subscript</csymbol><ci id="alg2.l15.m5.1.1.3.2.cmml" xref="alg2.l15.m5.1.1.3.2">𝜃</ci><ci id="alg2.l15.m5.1.1.3.3.cmml" xref="alg2.l15.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m5.1c">\nabla_{\theta_{i}}</annotation></semantics></math><math id="alg2.l15.m6.3" class="ltx_Math" alttext="\ell_{i}(\mathcal{D}_{i};W_{i},\theta_{i})" display="inline"><semantics id="alg2.l15.m6.3a"><mrow id="alg2.l15.m6.3.3" xref="alg2.l15.m6.3.3.cmml"><msub id="alg2.l15.m6.3.3.5" xref="alg2.l15.m6.3.3.5.cmml"><mi mathvariant="normal" id="alg2.l15.m6.3.3.5.2" xref="alg2.l15.m6.3.3.5.2.cmml">ℓ</mi><mi id="alg2.l15.m6.3.3.5.3" xref="alg2.l15.m6.3.3.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l15.m6.3.3.4" xref="alg2.l15.m6.3.3.4.cmml">​</mo><mrow id="alg2.l15.m6.3.3.3.3" xref="alg2.l15.m6.3.3.3.4.cmml"><mo stretchy="false" id="alg2.l15.m6.3.3.3.3.4" xref="alg2.l15.m6.3.3.3.4.cmml">(</mo><msub id="alg2.l15.m6.1.1.1.1.1" xref="alg2.l15.m6.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l15.m6.1.1.1.1.1.2" xref="alg2.l15.m6.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg2.l15.m6.1.1.1.1.1.3" xref="alg2.l15.m6.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.l15.m6.3.3.3.3.5" xref="alg2.l15.m6.3.3.3.4.cmml">;</mo><msub id="alg2.l15.m6.2.2.2.2.2" xref="alg2.l15.m6.2.2.2.2.2.cmml"><mi id="alg2.l15.m6.2.2.2.2.2.2" xref="alg2.l15.m6.2.2.2.2.2.2.cmml">W</mi><mi id="alg2.l15.m6.2.2.2.2.2.3" xref="alg2.l15.m6.2.2.2.2.2.3.cmml">i</mi></msub><mo id="alg2.l15.m6.3.3.3.3.6" xref="alg2.l15.m6.3.3.3.4.cmml">,</mo><msub id="alg2.l15.m6.3.3.3.3.3" xref="alg2.l15.m6.3.3.3.3.3.cmml"><mi id="alg2.l15.m6.3.3.3.3.3.2" xref="alg2.l15.m6.3.3.3.3.3.2.cmml">θ</mi><mi id="alg2.l15.m6.3.3.3.3.3.3" xref="alg2.l15.m6.3.3.3.3.3.3.cmml">i</mi></msub><mo stretchy="false" id="alg2.l15.m6.3.3.3.3.7" xref="alg2.l15.m6.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m6.3b"><apply id="alg2.l15.m6.3.3.cmml" xref="alg2.l15.m6.3.3"><times id="alg2.l15.m6.3.3.4.cmml" xref="alg2.l15.m6.3.3.4"></times><apply id="alg2.l15.m6.3.3.5.cmml" xref="alg2.l15.m6.3.3.5"><csymbol cd="ambiguous" id="alg2.l15.m6.3.3.5.1.cmml" xref="alg2.l15.m6.3.3.5">subscript</csymbol><ci id="alg2.l15.m6.3.3.5.2.cmml" xref="alg2.l15.m6.3.3.5.2">ℓ</ci><ci id="alg2.l15.m6.3.3.5.3.cmml" xref="alg2.l15.m6.3.3.5.3">𝑖</ci></apply><list id="alg2.l15.m6.3.3.3.4.cmml" xref="alg2.l15.m6.3.3.3.3"><apply id="alg2.l15.m6.1.1.1.1.1.cmml" xref="alg2.l15.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l15.m6.1.1.1.1.1.1.cmml" xref="alg2.l15.m6.1.1.1.1.1">subscript</csymbol><ci id="alg2.l15.m6.1.1.1.1.1.2.cmml" xref="alg2.l15.m6.1.1.1.1.1.2">𝒟</ci><ci id="alg2.l15.m6.1.1.1.1.1.3.cmml" xref="alg2.l15.m6.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg2.l15.m6.2.2.2.2.2.cmml" xref="alg2.l15.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l15.m6.2.2.2.2.2.1.cmml" xref="alg2.l15.m6.2.2.2.2.2">subscript</csymbol><ci id="alg2.l15.m6.2.2.2.2.2.2.cmml" xref="alg2.l15.m6.2.2.2.2.2.2">𝑊</ci><ci id="alg2.l15.m6.2.2.2.2.2.3.cmml" xref="alg2.l15.m6.2.2.2.2.2.3">𝑖</ci></apply><apply id="alg2.l15.m6.3.3.3.3.3.cmml" xref="alg2.l15.m6.3.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l15.m6.3.3.3.3.3.1.cmml" xref="alg2.l15.m6.3.3.3.3.3">subscript</csymbol><ci id="alg2.l15.m6.3.3.3.3.3.2.cmml" xref="alg2.l15.m6.3.3.3.3.3.2">𝜃</ci><ci id="alg2.l15.m6.3.3.3.3.3.3.cmml" xref="alg2.l15.m6.3.3.3.3.3.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m6.3c">\ell_{i}(\mathcal{D}_{i};W_{i},\theta_{i})</annotation></semantics></math>

</div>
<div id="alg2.l16" class="ltx_listingline">     <span id="alg2.l16.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l16.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l17" class="ltx_listingline">     <span id="alg2.l17.1" class="ltx_text ltx_font_sansserif">Return</span> <math id="alg2.l17.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg2.l17.m1.1a"><msub id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml"><mi id="alg2.l17.m1.1.1.2" xref="alg2.l17.m1.1.1.2.cmml">θ</mi><mi id="alg2.l17.m1.1.1.3" xref="alg2.l17.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.1b"><apply id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.1.cmml" xref="alg2.l17.m1.1.1">subscript</csymbol><ci id="alg2.l17.m1.1.1.2.cmml" xref="alg2.l17.m1.1.1.2">𝜃</ci><ci id="alg2.l17.m1.1.1.3.cmml" xref="alg2.l17.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.1c">\theta_{i}</annotation></semantics></math> as <math id="alg2.l17.m2.1" class="ltx_Math" alttext="\theta_{i}^{\prime}" display="inline"><semantics id="alg2.l17.m2.1a"><msubsup id="alg2.l17.m2.1.1" xref="alg2.l17.m2.1.1.cmml"><mi id="alg2.l17.m2.1.1.2.2" xref="alg2.l17.m2.1.1.2.2.cmml">θ</mi><mi id="alg2.l17.m2.1.1.2.3" xref="alg2.l17.m2.1.1.2.3.cmml">i</mi><mo id="alg2.l17.m2.1.1.3" xref="alg2.l17.m2.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l17.m2.1b"><apply id="alg2.l17.m2.1.1.cmml" xref="alg2.l17.m2.1.1"><csymbol cd="ambiguous" id="alg2.l17.m2.1.1.1.cmml" xref="alg2.l17.m2.1.1">superscript</csymbol><apply id="alg2.l17.m2.1.1.2.cmml" xref="alg2.l17.m2.1.1"><csymbol cd="ambiguous" id="alg2.l17.m2.1.1.2.1.cmml" xref="alg2.l17.m2.1.1">subscript</csymbol><ci id="alg2.l17.m2.1.1.2.2.cmml" xref="alg2.l17.m2.1.1.2.2">𝜃</ci><ci id="alg2.l17.m2.1.1.2.3.cmml" xref="alg2.l17.m2.1.1.2.3">𝑖</ci></apply><ci id="alg2.l17.m2.1.1.3.cmml" xref="alg2.l17.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m2.1c">\theta_{i}^{\prime}</annotation></semantics></math> to server


</div>
</div>
</figure>
<div id="A3.p3" class="ltx_para">
<p id="A3.p3.2" class="ltx_p">In Algorithm <a href="#alg3" title="Algorithm 3 ‣ Appendix C FedPer, FedAvg and FedRecon algorithms ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> we provide the Federated Averaging algorithm pseudocode. At each round, a random subset of clients copy the model parameters of the server to their local weights. These clients perform a number of gradient updates to their local weights <math id="A3.p3.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A3.p3.1.m1.1a"><mi id="A3.p3.1.m1.1.1" xref="A3.p3.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A3.p3.1.m1.1b"><ci id="A3.p3.1.m1.1.1.cmml" xref="A3.p3.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.1.m1.1c">\theta</annotation></semantics></math>. After the last gradient step, each of these clients return their updated local parameters <math id="A3.p3.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A3.p3.2.m2.1a"><mi id="A3.p3.2.m2.1.1" xref="A3.p3.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A3.p3.2.m2.1b"><ci id="A3.p3.2.m2.1.1.cmml" xref="A3.p3.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p3.2.m2.1c">\theta</annotation></semantics></math> to the server. The server collects all updated parameters and averages them. Then, the server updates its model parameter to the average value, and proceeds to the next round.</p>
</div>
<div id="A3.p4" class="ltx_para">
<p id="A3.p4.5" class="ltx_p">In Algorithm <a href="#alg4" title="Algorithm 4 ‣ Appendix C FedPer, FedAvg and FedRecon algorithms ‣ Personalized Federated Learning with Exact Stochastic Gradient Descent" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> we provide the FedRecon algorithm pseudocode, in which the clients perform only 1 gradient update to their global parameters; therefore this is equivalent to sending the gradient back to the server. In this version, the algorithm uses one personalized layer for its client-specific parameters, and clients do not drop the client-speicic parameters at the end of each round. At each round, the server selects a subset of clients and distributes the global parameters. Given the global parameters, these clients copy the global parameters to their global weights. Then each client performs a number of gradient updates to its client-specific weights <math id="A3.p4.1.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="A3.p4.1.m1.1a"><msub id="A3.p4.1.m1.1.1" xref="A3.p4.1.m1.1.1.cmml"><mi id="A3.p4.1.m1.1.1.2" xref="A3.p4.1.m1.1.1.2.cmml">W</mi><mi id="A3.p4.1.m1.1.1.3" xref="A3.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p4.1.m1.1b"><apply id="A3.p4.1.m1.1.1.cmml" xref="A3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A3.p4.1.m1.1.1.1.cmml" xref="A3.p4.1.m1.1.1">subscript</csymbol><ci id="A3.p4.1.m1.1.1.2.cmml" xref="A3.p4.1.m1.1.1.2">𝑊</ci><ci id="A3.p4.1.m1.1.1.3.cmml" xref="A3.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.1.m1.1c">W_{i}</annotation></semantics></math>. After the last gradient update step on <math id="A3.p4.2.m2.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="A3.p4.2.m2.1a"><msub id="A3.p4.2.m2.1.1" xref="A3.p4.2.m2.1.1.cmml"><mi id="A3.p4.2.m2.1.1.2" xref="A3.p4.2.m2.1.1.2.cmml">W</mi><mi id="A3.p4.2.m2.1.1.3" xref="A3.p4.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p4.2.m2.1b"><apply id="A3.p4.2.m2.1.1.cmml" xref="A3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="A3.p4.2.m2.1.1.1.cmml" xref="A3.p4.2.m2.1.1">subscript</csymbol><ci id="A3.p4.2.m2.1.1.2.cmml" xref="A3.p4.2.m2.1.1.2">𝑊</ci><ci id="A3.p4.2.m2.1.1.3.cmml" xref="A3.p4.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.2.m2.1c">W_{i}</annotation></semantics></math>, each client computes the gradient w.r.t. the local copies of the global parameters to the server.
The server collects all gradients from the clients, and then the server aggregates them to the global parameters <math id="A3.p4.3.m3.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A3.p4.3.m3.1a"><mi id="A3.p4.3.m3.1.1" xref="A3.p4.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="A3.p4.3.m3.1b"><ci id="A3.p4.3.m3.1.1.cmml" xref="A3.p4.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.3.m3.1c">\theta</annotation></semantics></math>, and proceeds to the next round. The personalized weights <math id="A3.p4.4.m4.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="A3.p4.4.m4.1a"><msub id="A3.p4.4.m4.1.1" xref="A3.p4.4.m4.1.1.cmml"><mi id="A3.p4.4.m4.1.1.2" xref="A3.p4.4.m4.1.1.2.cmml">W</mi><mi id="A3.p4.4.m4.1.1.3" xref="A3.p4.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.p4.4.m4.1b"><apply id="A3.p4.4.m4.1.1.cmml" xref="A3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="A3.p4.4.m4.1.1.1.cmml" xref="A3.p4.4.m4.1.1">subscript</csymbol><ci id="A3.p4.4.m4.1.1.2.cmml" xref="A3.p4.4.m4.1.1.2">𝑊</ci><ci id="A3.p4.4.m4.1.1.3.cmml" xref="A3.p4.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.4.m4.1c">W_{i}</annotation></semantics></math> for FedPer and PFLEGO algorithm are initialized with uniform values in <math id="A3.p4.5.m5.2" class="ltx_Math" alttext="[0,1)" display="inline"><semantics id="A3.p4.5.m5.2a"><mrow id="A3.p4.5.m5.2.3.2" xref="A3.p4.5.m5.2.3.1.cmml"><mo stretchy="false" id="A3.p4.5.m5.2.3.2.1" xref="A3.p4.5.m5.2.3.1.cmml">[</mo><mn id="A3.p4.5.m5.1.1" xref="A3.p4.5.m5.1.1.cmml">0</mn><mo id="A3.p4.5.m5.2.3.2.2" xref="A3.p4.5.m5.2.3.1.cmml">,</mo><mn id="A3.p4.5.m5.2.2" xref="A3.p4.5.m5.2.2.cmml">1</mn><mo stretchy="false" id="A3.p4.5.m5.2.3.2.3" xref="A3.p4.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A3.p4.5.m5.2b"><interval closure="closed-open" id="A3.p4.5.m5.2.3.1.cmml" xref="A3.p4.5.m5.2.3.2"><cn type="integer" id="A3.p4.5.m5.1.1.cmml" xref="A3.p4.5.m5.1.1">0</cn><cn type="integer" id="A3.p4.5.m5.2.2.cmml" xref="A3.p4.5.m5.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A3.p4.5.m5.2c">[0,1)</annotation></semantics></math>.</p>
</div>
<figure id="alg3" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg3.2.1.1" class="ltx_text ltx_font_bold">Algorithm 3</span> </span> FedAvg</figcaption>
<div id="alg3.3" class="ltx_listing ltx_listing">
<div id="alg3.l1" class="ltx_listingline">  <span id="alg3.l1.1" class="ltx_text ltx_font_bold">Input:</span> <math id="alg3.l1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg3.l1.m1.1a"><mi id="alg3.l1.m1.1.1" xref="alg3.l1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m1.1b"><ci id="alg3.l1.m1.1.1.cmml" xref="alg3.l1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m1.1c">T</annotation></semantics></math> number of rounds, <math id="alg3.l1.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg3.l1.m2.1a"><mi id="alg3.l1.m2.1.1" xref="alg3.l1.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m2.1b"><ci id="alg3.l1.m2.1.1.cmml" xref="alg3.l1.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m2.1c">\tau</annotation></semantics></math> local gradient updates, <math id="alg3.l1.m3.1" class="ltx_Math" alttext="I" display="inline"><semantics id="alg3.l1.m3.1a"><mi id="alg3.l1.m3.1.1" xref="alg3.l1.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m3.1b"><ci id="alg3.l1.m3.1.1.cmml" xref="alg3.l1.m3.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m3.1c">I</annotation></semantics></math> clients, <math id="alg3.l1.m4.1" class="ltx_Math" alttext="r\ll I" display="inline"><semantics id="alg3.l1.m4.1a"><mrow id="alg3.l1.m4.1.1" xref="alg3.l1.m4.1.1.cmml"><mi id="alg3.l1.m4.1.1.2" xref="alg3.l1.m4.1.1.2.cmml">r</mi><mo id="alg3.l1.m4.1.1.1" xref="alg3.l1.m4.1.1.1.cmml">≪</mo><mi id="alg3.l1.m4.1.1.3" xref="alg3.l1.m4.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l1.m4.1b"><apply id="alg3.l1.m4.1.1.cmml" xref="alg3.l1.m4.1.1"><csymbol cd="latexml" id="alg3.l1.m4.1.1.1.cmml" xref="alg3.l1.m4.1.1.1">much-less-than</csymbol><ci id="alg3.l1.m4.1.1.2.cmml" xref="alg3.l1.m4.1.1.2">𝑟</ci><ci id="alg3.l1.m4.1.1.3.cmml" xref="alg3.l1.m4.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m4.1c">r\ll I</annotation></semantics></math> sampled clients per round,<math id="alg3.l1.m5.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="alg3.l1.m5.1a"><msub id="alg3.l1.m5.1.1" xref="alg3.l1.m5.1.1.cmml"><mi id="alg3.l1.m5.1.1.2" xref="alg3.l1.m5.1.1.2.cmml">N</mi><mi id="alg3.l1.m5.1.1.3" xref="alg3.l1.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l1.m5.1b"><apply id="alg3.l1.m5.1.1.cmml" xref="alg3.l1.m5.1.1"><csymbol cd="ambiguous" id="alg3.l1.m5.1.1.1.cmml" xref="alg3.l1.m5.1.1">subscript</csymbol><ci id="alg3.l1.m5.1.1.2.cmml" xref="alg3.l1.m5.1.1.2">𝑁</ci><ci id="alg3.l1.m5.1.1.3.cmml" xref="alg3.l1.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m5.1c">N_{i}</annotation></semantics></math> number of data samples at the <math id="alg3.l1.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg3.l1.m6.1a"><mi id="alg3.l1.m6.1.1" xref="alg3.l1.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.l1.m6.1b"><ci id="alg3.l1.m6.1.1.cmml" xref="alg3.l1.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l1.m6.1c">i</annotation></semantics></math>-th client
</div>
<div id="alg3.l2" class="ltx_listingline">  <span id="alg3.l2.1" class="ltx_text ltx_font_bold">Server:</span>




</div>
<div id="alg3.l3" class="ltx_listingline">     <span id="alg3.l3.1" class="ltx_text ltx_font_sansserif">Initialize</span> global parameters <math id="alg3.l3.m1.1" class="ltx_Math" alttext="\theta_{1}" display="inline"><semantics id="alg3.l3.m1.1a"><msub id="alg3.l3.m1.1.1" xref="alg3.l3.m1.1.1.cmml"><mi id="alg3.l3.m1.1.1.2" xref="alg3.l3.m1.1.1.2.cmml">θ</mi><mn id="alg3.l3.m1.1.1.3" xref="alg3.l3.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg3.l3.m1.1b"><apply id="alg3.l3.m1.1.1.cmml" xref="alg3.l3.m1.1.1"><csymbol cd="ambiguous" id="alg3.l3.m1.1.1.1.cmml" xref="alg3.l3.m1.1.1">subscript</csymbol><ci id="alg3.l3.m1.1.1.2.cmml" xref="alg3.l3.m1.1.1.2">𝜃</ci><cn type="integer" id="alg3.l3.m1.1.1.3.cmml" xref="alg3.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l3.m1.1c">\theta_{1}</annotation></semantics></math>

</div>
<div id="alg3.l4" class="ltx_listingline">     <span id="alg3.l4.1" class="ltx_text ltx_font_bold">for</span>  round t<math id="alg3.l4.m1.4" class="ltx_Math" alttext="\,=1,2,...,T" display="inline"><semantics id="alg3.l4.m1.4a"><mrow id="alg3.l4.m1.4.5" xref="alg3.l4.m1.4.5.cmml"><mi id="alg3.l4.m1.4.5.2" xref="alg3.l4.m1.4.5.2.cmml"></mi><mo lspace="0.448em" id="alg3.l4.m1.4.5.1" xref="alg3.l4.m1.4.5.1.cmml">=</mo><mrow id="alg3.l4.m1.4.5.3.2" xref="alg3.l4.m1.4.5.3.1.cmml"><mn id="alg3.l4.m1.1.1" xref="alg3.l4.m1.1.1.cmml">1</mn><mo id="alg3.l4.m1.4.5.3.2.1" xref="alg3.l4.m1.4.5.3.1.cmml">,</mo><mn id="alg3.l4.m1.2.2" xref="alg3.l4.m1.2.2.cmml">2</mn><mo id="alg3.l4.m1.4.5.3.2.2" xref="alg3.l4.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg3.l4.m1.3.3" xref="alg3.l4.m1.3.3.cmml">…</mi><mo id="alg3.l4.m1.4.5.3.2.3" xref="alg3.l4.m1.4.5.3.1.cmml">,</mo><mi id="alg3.l4.m1.4.4" xref="alg3.l4.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l4.m1.4b"><apply id="alg3.l4.m1.4.5.cmml" xref="alg3.l4.m1.4.5"><eq id="alg3.l4.m1.4.5.1.cmml" xref="alg3.l4.m1.4.5.1"></eq><csymbol cd="latexml" id="alg3.l4.m1.4.5.2.cmml" xref="alg3.l4.m1.4.5.2">absent</csymbol><list id="alg3.l4.m1.4.5.3.1.cmml" xref="alg3.l4.m1.4.5.3.2"><cn type="integer" id="alg3.l4.m1.1.1.cmml" xref="alg3.l4.m1.1.1">1</cn><cn type="integer" id="alg3.l4.m1.2.2.cmml" xref="alg3.l4.m1.2.2">2</cn><ci id="alg3.l4.m1.3.3.cmml" xref="alg3.l4.m1.3.3">…</ci><ci id="alg3.l4.m1.4.4.cmml" xref="alg3.l4.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l4.m1.4c">\,=1,2,...,T</annotation></semantics></math> <span id="alg3.l4.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg3.l5" class="ltx_listingline">        <math id="alg3.l5.m1.1" class="ltx_Math" alttext="I_{t}\leftarrow" display="inline"><semantics id="alg3.l5.m1.1a"><mrow id="alg3.l5.m1.1.1" xref="alg3.l5.m1.1.1.cmml"><msub id="alg3.l5.m1.1.1.2" xref="alg3.l5.m1.1.1.2.cmml"><mi id="alg3.l5.m1.1.1.2.2" xref="alg3.l5.m1.1.1.2.2.cmml">I</mi><mi id="alg3.l5.m1.1.1.2.3" xref="alg3.l5.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg3.l5.m1.1.1.1" xref="alg3.l5.m1.1.1.1.cmml">←</mo><mi id="alg3.l5.m1.1.1.3" xref="alg3.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg3.l5.m1.1b"><apply id="alg3.l5.m1.1.1.cmml" xref="alg3.l5.m1.1.1"><ci id="alg3.l5.m1.1.1.1.cmml" xref="alg3.l5.m1.1.1.1">←</ci><apply id="alg3.l5.m1.1.1.2.cmml" xref="alg3.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l5.m1.1.1.2.1.cmml" xref="alg3.l5.m1.1.1.2">subscript</csymbol><ci id="alg3.l5.m1.1.1.2.2.cmml" xref="alg3.l5.m1.1.1.2.2">𝐼</ci><ci id="alg3.l5.m1.1.1.2.3.cmml" xref="alg3.l5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg3.l5.m1.1.1.3.cmml" xref="alg3.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l5.m1.1c">I_{t}\leftarrow</annotation></semantics></math> (Select a random subset of r clients)

</div>
<div id="alg3.l6" class="ltx_listingline">        <span id="alg3.l6.1" class="ltx_text ltx_font_sansserif">Receive</span> <math id="alg3.l6.m1.1" class="ltx_Math" alttext="\theta_{i}^{\prime}" display="inline"><semantics id="alg3.l6.m1.1a"><msubsup id="alg3.l6.m1.1.1" xref="alg3.l6.m1.1.1.cmml"><mi id="alg3.l6.m1.1.1.2.2" xref="alg3.l6.m1.1.1.2.2.cmml">θ</mi><mi id="alg3.l6.m1.1.1.2.3" xref="alg3.l6.m1.1.1.2.3.cmml">i</mi><mo id="alg3.l6.m1.1.1.3" xref="alg3.l6.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg3.l6.m1.1b"><apply id="alg3.l6.m1.1.1.cmml" xref="alg3.l6.m1.1.1"><csymbol cd="ambiguous" id="alg3.l6.m1.1.1.1.cmml" xref="alg3.l6.m1.1.1">superscript</csymbol><apply id="alg3.l6.m1.1.1.2.cmml" xref="alg3.l6.m1.1.1"><csymbol cd="ambiguous" id="alg3.l6.m1.1.1.2.1.cmml" xref="alg3.l6.m1.1.1">subscript</csymbol><ci id="alg3.l6.m1.1.1.2.2.cmml" xref="alg3.l6.m1.1.1.2.2">𝜃</ci><ci id="alg3.l6.m1.1.1.2.3.cmml" xref="alg3.l6.m1.1.1.2.3">𝑖</ci></apply><ci id="alg3.l6.m1.1.1.3.cmml" xref="alg3.l6.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m1.1c">\theta_{i}^{\prime}</annotation></semantics></math> from each <span id="alg3.l6.2" class="ltx_text ltx_font_typewriter">client i</span> <math id="alg3.l6.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg3.l6.m2.1a"><mo id="alg3.l6.m2.1.1" xref="alg3.l6.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg3.l6.m2.1b"><in id="alg3.l6.m2.1.1.cmml" xref="alg3.l6.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m2.1c">\in</annotation></semantics></math> <math id="alg3.l6.m3.1" class="ltx_Math" alttext="I_{t}" display="inline"><semantics id="alg3.l6.m3.1a"><msub id="alg3.l6.m3.1.1" xref="alg3.l6.m3.1.1.cmml"><mi id="alg3.l6.m3.1.1.2" xref="alg3.l6.m3.1.1.2.cmml">I</mi><mi id="alg3.l6.m3.1.1.3" xref="alg3.l6.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l6.m3.1b"><apply id="alg3.l6.m3.1.1.cmml" xref="alg3.l6.m3.1.1"><csymbol cd="ambiguous" id="alg3.l6.m3.1.1.1.cmml" xref="alg3.l6.m3.1.1">subscript</csymbol><ci id="alg3.l6.m3.1.1.2.cmml" xref="alg3.l6.m3.1.1.2">𝐼</ci><ci id="alg3.l6.m3.1.1.3.cmml" xref="alg3.l6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l6.m3.1c">I_{t}</annotation></semantics></math>

</div>
<div id="alg3.l7" class="ltx_listingline">        <span id="alg3.l7.1" class="ltx_text ltx_font_sansserif">Aggregate: <math id="alg3.l7.1.m1.1" class="ltx_Math" alttext="\theta_{t+1}\leftarrow\sum_{i\in I_{t}}a_{i}\theta_{i}^{\prime}" display="inline"><semantics id="alg3.l7.1.m1.1a"><mrow id="alg3.l7.1.m1.1.1" xref="alg3.l7.1.m1.1.1.cmml"><msub id="alg3.l7.1.m1.1.1.2" xref="alg3.l7.1.m1.1.1.2.cmml"><mi id="alg3.l7.1.m1.1.1.2.2" xref="alg3.l7.1.m1.1.1.2.2.cmml">θ</mi><mrow id="alg3.l7.1.m1.1.1.2.3" xref="alg3.l7.1.m1.1.1.2.3.cmml"><mi id="alg3.l7.1.m1.1.1.2.3.2" xref="alg3.l7.1.m1.1.1.2.3.2.cmml">t</mi><mo id="alg3.l7.1.m1.1.1.2.3.1" xref="alg3.l7.1.m1.1.1.2.3.1.cmml">+</mo><mn id="alg3.l7.1.m1.1.1.2.3.3" xref="alg3.l7.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo rspace="0.111em" stretchy="false" id="alg3.l7.1.m1.1.1.1" xref="alg3.l7.1.m1.1.1.1.cmml">←</mo><mrow id="alg3.l7.1.m1.1.1.3" xref="alg3.l7.1.m1.1.1.3.cmml"><msub id="alg3.l7.1.m1.1.1.3.1" xref="alg3.l7.1.m1.1.1.3.1.cmml"><mo id="alg3.l7.1.m1.1.1.3.1.2" xref="alg3.l7.1.m1.1.1.3.1.2.cmml">∑</mo><mrow id="alg3.l7.1.m1.1.1.3.1.3" xref="alg3.l7.1.m1.1.1.3.1.3.cmml"><mi id="alg3.l7.1.m1.1.1.3.1.3.2" xref="alg3.l7.1.m1.1.1.3.1.3.2.cmml">i</mi><mo id="alg3.l7.1.m1.1.1.3.1.3.1" xref="alg3.l7.1.m1.1.1.3.1.3.1.cmml">∈</mo><msub id="alg3.l7.1.m1.1.1.3.1.3.3" xref="alg3.l7.1.m1.1.1.3.1.3.3.cmml"><mi id="alg3.l7.1.m1.1.1.3.1.3.3.2" xref="alg3.l7.1.m1.1.1.3.1.3.3.2.cmml">I</mi><mi id="alg3.l7.1.m1.1.1.3.1.3.3.3" xref="alg3.l7.1.m1.1.1.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="alg3.l7.1.m1.1.1.3.2" xref="alg3.l7.1.m1.1.1.3.2.cmml"><msub id="alg3.l7.1.m1.1.1.3.2.2" xref="alg3.l7.1.m1.1.1.3.2.2.cmml"><mi id="alg3.l7.1.m1.1.1.3.2.2.2" xref="alg3.l7.1.m1.1.1.3.2.2.2.cmml">a</mi><mi id="alg3.l7.1.m1.1.1.3.2.2.3" xref="alg3.l7.1.m1.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg3.l7.1.m1.1.1.3.2.1" xref="alg3.l7.1.m1.1.1.3.2.1.cmml">​</mo><msubsup id="alg3.l7.1.m1.1.1.3.2.3" xref="alg3.l7.1.m1.1.1.3.2.3.cmml"><mi id="alg3.l7.1.m1.1.1.3.2.3.2.2" xref="alg3.l7.1.m1.1.1.3.2.3.2.2.cmml">θ</mi><mi id="alg3.l7.1.m1.1.1.3.2.3.2.3" xref="alg3.l7.1.m1.1.1.3.2.3.2.3.cmml">i</mi><mo id="alg3.l7.1.m1.1.1.3.2.3.3" xref="alg3.l7.1.m1.1.1.3.2.3.3.cmml">′</mo></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l7.1.m1.1b"><apply id="alg3.l7.1.m1.1.1.cmml" xref="alg3.l7.1.m1.1.1"><ci id="alg3.l7.1.m1.1.1.1.cmml" xref="alg3.l7.1.m1.1.1.1">←</ci><apply id="alg3.l7.1.m1.1.1.2.cmml" xref="alg3.l7.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg3.l7.1.m1.1.1.2.1.cmml" xref="alg3.l7.1.m1.1.1.2">subscript</csymbol><ci id="alg3.l7.1.m1.1.1.2.2.cmml" xref="alg3.l7.1.m1.1.1.2.2">𝜃</ci><apply id="alg3.l7.1.m1.1.1.2.3.cmml" xref="alg3.l7.1.m1.1.1.2.3"><plus id="alg3.l7.1.m1.1.1.2.3.1.cmml" xref="alg3.l7.1.m1.1.1.2.3.1"></plus><ci id="alg3.l7.1.m1.1.1.2.3.2.cmml" xref="alg3.l7.1.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg3.l7.1.m1.1.1.2.3.3.cmml" xref="alg3.l7.1.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg3.l7.1.m1.1.1.3.cmml" xref="alg3.l7.1.m1.1.1.3"><apply id="alg3.l7.1.m1.1.1.3.1.cmml" xref="alg3.l7.1.m1.1.1.3.1"><csymbol cd="ambiguous" id="alg3.l7.1.m1.1.1.3.1.1.cmml" xref="alg3.l7.1.m1.1.1.3.1">subscript</csymbol><sum id="alg3.l7.1.m1.1.1.3.1.2.cmml" xref="alg3.l7.1.m1.1.1.3.1.2"></sum><apply id="alg3.l7.1.m1.1.1.3.1.3.cmml" xref="alg3.l7.1.m1.1.1.3.1.3"><in id="alg3.l7.1.m1.1.1.3.1.3.1.cmml" xref="alg3.l7.1.m1.1.1.3.1.3.1"></in><ci id="alg3.l7.1.m1.1.1.3.1.3.2.cmml" xref="alg3.l7.1.m1.1.1.3.1.3.2">𝑖</ci><apply id="alg3.l7.1.m1.1.1.3.1.3.3.cmml" xref="alg3.l7.1.m1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="alg3.l7.1.m1.1.1.3.1.3.3.1.cmml" xref="alg3.l7.1.m1.1.1.3.1.3.3">subscript</csymbol><ci id="alg3.l7.1.m1.1.1.3.1.3.3.2.cmml" xref="alg3.l7.1.m1.1.1.3.1.3.3.2">𝐼</ci><ci id="alg3.l7.1.m1.1.1.3.1.3.3.3.cmml" xref="alg3.l7.1.m1.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg3.l7.1.m1.1.1.3.2.cmml" xref="alg3.l7.1.m1.1.1.3.2"><times id="alg3.l7.1.m1.1.1.3.2.1.cmml" xref="alg3.l7.1.m1.1.1.3.2.1"></times><apply id="alg3.l7.1.m1.1.1.3.2.2.cmml" xref="alg3.l7.1.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg3.l7.1.m1.1.1.3.2.2.1.cmml" xref="alg3.l7.1.m1.1.1.3.2.2">subscript</csymbol><ci id="alg3.l7.1.m1.1.1.3.2.2.2.cmml" xref="alg3.l7.1.m1.1.1.3.2.2.2">𝑎</ci><ci id="alg3.l7.1.m1.1.1.3.2.2.3.cmml" xref="alg3.l7.1.m1.1.1.3.2.2.3">𝑖</ci></apply><apply id="alg3.l7.1.m1.1.1.3.2.3.cmml" xref="alg3.l7.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg3.l7.1.m1.1.1.3.2.3.1.cmml" xref="alg3.l7.1.m1.1.1.3.2.3">superscript</csymbol><apply id="alg3.l7.1.m1.1.1.3.2.3.2.cmml" xref="alg3.l7.1.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="alg3.l7.1.m1.1.1.3.2.3.2.1.cmml" xref="alg3.l7.1.m1.1.1.3.2.3">subscript</csymbol><ci id="alg3.l7.1.m1.1.1.3.2.3.2.2.cmml" xref="alg3.l7.1.m1.1.1.3.2.3.2.2">𝜃</ci><ci id="alg3.l7.1.m1.1.1.3.2.3.2.3.cmml" xref="alg3.l7.1.m1.1.1.3.2.3.2.3">𝑖</ci></apply><ci id="alg3.l7.1.m1.1.1.3.2.3.3.cmml" xref="alg3.l7.1.m1.1.1.3.2.3.3">′</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l7.1.m1.1c">\theta_{t+1}\leftarrow\sum_{i\in I_{t}}a_{i}\theta_{i}^{\prime}</annotation></semantics></math></span>

</div>
<div id="alg3.l8" class="ltx_listingline">     <span id="alg3.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l8.2" class="ltx_text ltx_font_bold">for</span>

</div>
<div id="alg3.l9" class="ltx_listingline">  
</div>
<div id="alg3.l10" class="ltx_listingline">  <span id="alg3.l10.1" class="ltx_text ltx_font_bold">ClientI_Update(<math id="alg3.l10.1.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="alg3.l10.1.m1.1a"><msub id="alg3.l10.1.m1.1.1" xref="alg3.l10.1.m1.1.1.cmml"><mi id="alg3.l10.1.m1.1.1.2" xref="alg3.l10.1.m1.1.1.2.cmml">θ</mi><mi id="alg3.l10.1.m1.1.1.3" xref="alg3.l10.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l10.1.m1.1b"><apply id="alg3.l10.1.m1.1.1.cmml" xref="alg3.l10.1.m1.1.1"><csymbol cd="ambiguous" id="alg3.l10.1.m1.1.1.1.cmml" xref="alg3.l10.1.m1.1.1">subscript</csymbol><ci id="alg3.l10.1.m1.1.1.2.cmml" xref="alg3.l10.1.m1.1.1.2">𝜃</ci><ci id="alg3.l10.1.m1.1.1.3.cmml" xref="alg3.l10.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.1.m1.1c">\theta_{t}</annotation></semantics></math>):</span>#runs on client <math id="alg3.l10.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg3.l10.m1.1a"><mi id="alg3.l10.m1.1.1" xref="alg3.l10.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg3.l10.m1.1b"><ci id="alg3.l10.m1.1.1.cmml" xref="alg3.l10.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l10.m1.1c">i</annotation></semantics></math>




</div>
<div id="alg3.l11" class="ltx_listingline">     <span id="alg3.l11.1" class="ltx_text ltx_font_sansserif">Copy</span> <math id="alg3.l11.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="alg3.l11.m1.1a"><msub id="alg3.l11.m1.1.1" xref="alg3.l11.m1.1.1.cmml"><mi id="alg3.l11.m1.1.1.2" xref="alg3.l11.m1.1.1.2.cmml">θ</mi><mi id="alg3.l11.m1.1.1.3" xref="alg3.l11.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l11.m1.1b"><apply id="alg3.l11.m1.1.1.cmml" xref="alg3.l11.m1.1.1"><csymbol cd="ambiguous" id="alg3.l11.m1.1.1.1.cmml" xref="alg3.l11.m1.1.1">subscript</csymbol><ci id="alg3.l11.m1.1.1.2.cmml" xref="alg3.l11.m1.1.1.2">𝜃</ci><ci id="alg3.l11.m1.1.1.3.cmml" xref="alg3.l11.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m1.1c">\theta_{t}</annotation></semantics></math> to <math id="alg3.l11.m2.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg3.l11.m2.1a"><msub id="alg3.l11.m2.1.1" xref="alg3.l11.m2.1.1.cmml"><mi id="alg3.l11.m2.1.1.2" xref="alg3.l11.m2.1.1.2.cmml">θ</mi><mi id="alg3.l11.m2.1.1.3" xref="alg3.l11.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l11.m2.1b"><apply id="alg3.l11.m2.1.1.cmml" xref="alg3.l11.m2.1.1"><csymbol cd="ambiguous" id="alg3.l11.m2.1.1.1.cmml" xref="alg3.l11.m2.1.1">subscript</csymbol><ci id="alg3.l11.m2.1.1.2.cmml" xref="alg3.l11.m2.1.1.2">𝜃</ci><ci id="alg3.l11.m2.1.1.3.cmml" xref="alg3.l11.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l11.m2.1c">\theta_{i}</annotation></semantics></math>

</div>
<div id="alg3.l12" class="ltx_listingline">     <span id="alg3.l12.1" class="ltx_text ltx_font_bold">for</span>  local gradient
update <math id="alg3.l12.m1.4" class="ltx_Math" alttext="=1,2,...,\tau" display="inline"><semantics id="alg3.l12.m1.4a"><mrow id="alg3.l12.m1.4.5" xref="alg3.l12.m1.4.5.cmml"><mi id="alg3.l12.m1.4.5.2" xref="alg3.l12.m1.4.5.2.cmml"></mi><mo id="alg3.l12.m1.4.5.1" xref="alg3.l12.m1.4.5.1.cmml">=</mo><mrow id="alg3.l12.m1.4.5.3.2" xref="alg3.l12.m1.4.5.3.1.cmml"><mn id="alg3.l12.m1.1.1" xref="alg3.l12.m1.1.1.cmml">1</mn><mo id="alg3.l12.m1.4.5.3.2.1" xref="alg3.l12.m1.4.5.3.1.cmml">,</mo><mn id="alg3.l12.m1.2.2" xref="alg3.l12.m1.2.2.cmml">2</mn><mo id="alg3.l12.m1.4.5.3.2.2" xref="alg3.l12.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg3.l12.m1.3.3" xref="alg3.l12.m1.3.3.cmml">…</mi><mo id="alg3.l12.m1.4.5.3.2.3" xref="alg3.l12.m1.4.5.3.1.cmml">,</mo><mi id="alg3.l12.m1.4.4" xref="alg3.l12.m1.4.4.cmml">τ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l12.m1.4b"><apply id="alg3.l12.m1.4.5.cmml" xref="alg3.l12.m1.4.5"><eq id="alg3.l12.m1.4.5.1.cmml" xref="alg3.l12.m1.4.5.1"></eq><csymbol cd="latexml" id="alg3.l12.m1.4.5.2.cmml" xref="alg3.l12.m1.4.5.2">absent</csymbol><list id="alg3.l12.m1.4.5.3.1.cmml" xref="alg3.l12.m1.4.5.3.2"><cn type="integer" id="alg3.l12.m1.1.1.cmml" xref="alg3.l12.m1.1.1">1</cn><cn type="integer" id="alg3.l12.m1.2.2.cmml" xref="alg3.l12.m1.2.2">2</cn><ci id="alg3.l12.m1.3.3.cmml" xref="alg3.l12.m1.3.3">…</ci><ci id="alg3.l12.m1.4.4.cmml" xref="alg3.l12.m1.4.4">𝜏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l12.m1.4c">=1,2,...,\tau</annotation></semantics></math> <span id="alg3.l12.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg3.l13" class="ltx_listingline">        <math id="alg3.l13.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg3.l13.m1.1a"><msub id="alg3.l13.m1.1.1" xref="alg3.l13.m1.1.1.cmml"><mi id="alg3.l13.m1.1.1.2" xref="alg3.l13.m1.1.1.2.cmml">θ</mi><mi id="alg3.l13.m1.1.1.3" xref="alg3.l13.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l13.m1.1b"><apply id="alg3.l13.m1.1.1.cmml" xref="alg3.l13.m1.1.1"><csymbol cd="ambiguous" id="alg3.l13.m1.1.1.1.cmml" xref="alg3.l13.m1.1.1">subscript</csymbol><ci id="alg3.l13.m1.1.1.2.cmml" xref="alg3.l13.m1.1.1.2">𝜃</ci><ci id="alg3.l13.m1.1.1.3.cmml" xref="alg3.l13.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.m1.1c">\theta_{i}</annotation></semantics></math> <math id="alg3.l13.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg3.l13.m2.1a"><mo stretchy="false" id="alg3.l13.m2.1.1" xref="alg3.l13.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg3.l13.m2.1b"><ci id="alg3.l13.m2.1.1.cmml" xref="alg3.l13.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg3.l13.m3.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg3.l13.m3.1a"><msub id="alg3.l13.m3.1.1" xref="alg3.l13.m3.1.1.cmml"><mi id="alg3.l13.m3.1.1.2" xref="alg3.l13.m3.1.1.2.cmml">θ</mi><mi id="alg3.l13.m3.1.1.3" xref="alg3.l13.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l13.m3.1b"><apply id="alg3.l13.m3.1.1.cmml" xref="alg3.l13.m3.1.1"><csymbol cd="ambiguous" id="alg3.l13.m3.1.1.1.cmml" xref="alg3.l13.m3.1.1">subscript</csymbol><ci id="alg3.l13.m3.1.1.2.cmml" xref="alg3.l13.m3.1.1.2">𝜃</ci><ci id="alg3.l13.m3.1.1.3.cmml" xref="alg3.l13.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.m3.1c">\theta_{i}</annotation></semantics></math> - <math id="alg3.l13.m4.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="alg3.l13.m4.1a"><mi id="alg3.l13.m4.1.1" xref="alg3.l13.m4.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg3.l13.m4.1b"><ci id="alg3.l13.m4.1.1.cmml" xref="alg3.l13.m4.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.m4.1c">\beta</annotation></semantics></math> <math id="alg3.l13.m5.1" class="ltx_Math" alttext="\nabla_{\theta_{i}}" display="inline"><semantics id="alg3.l13.m5.1a"><msub id="alg3.l13.m5.1.1" xref="alg3.l13.m5.1.1.cmml"><mo id="alg3.l13.m5.1.1.2" xref="alg3.l13.m5.1.1.2.cmml">∇</mo><msub id="alg3.l13.m5.1.1.3" xref="alg3.l13.m5.1.1.3.cmml"><mi id="alg3.l13.m5.1.1.3.2" xref="alg3.l13.m5.1.1.3.2.cmml">θ</mi><mi id="alg3.l13.m5.1.1.3.3" xref="alg3.l13.m5.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg3.l13.m5.1b"><apply id="alg3.l13.m5.1.1.cmml" xref="alg3.l13.m5.1.1"><csymbol cd="ambiguous" id="alg3.l13.m5.1.1.1.cmml" xref="alg3.l13.m5.1.1">subscript</csymbol><ci id="alg3.l13.m5.1.1.2.cmml" xref="alg3.l13.m5.1.1.2">∇</ci><apply id="alg3.l13.m5.1.1.3.cmml" xref="alg3.l13.m5.1.1.3"><csymbol cd="ambiguous" id="alg3.l13.m5.1.1.3.1.cmml" xref="alg3.l13.m5.1.1.3">subscript</csymbol><ci id="alg3.l13.m5.1.1.3.2.cmml" xref="alg3.l13.m5.1.1.3.2">𝜃</ci><ci id="alg3.l13.m5.1.1.3.3.cmml" xref="alg3.l13.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.m5.1c">\nabla_{\theta_{i}}</annotation></semantics></math><math id="alg3.l13.m6.2" class="ltx_Math" alttext="\ell_{i}(\mathcal{D}_{i};\theta_{i})" display="inline"><semantics id="alg3.l13.m6.2a"><mrow id="alg3.l13.m6.2.2" xref="alg3.l13.m6.2.2.cmml"><msub id="alg3.l13.m6.2.2.4" xref="alg3.l13.m6.2.2.4.cmml"><mi mathvariant="normal" id="alg3.l13.m6.2.2.4.2" xref="alg3.l13.m6.2.2.4.2.cmml">ℓ</mi><mi id="alg3.l13.m6.2.2.4.3" xref="alg3.l13.m6.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg3.l13.m6.2.2.3" xref="alg3.l13.m6.2.2.3.cmml">​</mo><mrow id="alg3.l13.m6.2.2.2.2" xref="alg3.l13.m6.2.2.2.3.cmml"><mo stretchy="false" id="alg3.l13.m6.2.2.2.2.3" xref="alg3.l13.m6.2.2.2.3.cmml">(</mo><msub id="alg3.l13.m6.1.1.1.1.1" xref="alg3.l13.m6.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg3.l13.m6.1.1.1.1.1.2" xref="alg3.l13.m6.1.1.1.1.1.2.cmml">𝒟</mi><mi id="alg3.l13.m6.1.1.1.1.1.3" xref="alg3.l13.m6.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg3.l13.m6.2.2.2.2.4" xref="alg3.l13.m6.2.2.2.3.cmml">;</mo><msub id="alg3.l13.m6.2.2.2.2.2" xref="alg3.l13.m6.2.2.2.2.2.cmml"><mi id="alg3.l13.m6.2.2.2.2.2.2" xref="alg3.l13.m6.2.2.2.2.2.2.cmml">θ</mi><mi id="alg3.l13.m6.2.2.2.2.2.3" xref="alg3.l13.m6.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg3.l13.m6.2.2.2.2.5" xref="alg3.l13.m6.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg3.l13.m6.2b"><apply id="alg3.l13.m6.2.2.cmml" xref="alg3.l13.m6.2.2"><times id="alg3.l13.m6.2.2.3.cmml" xref="alg3.l13.m6.2.2.3"></times><apply id="alg3.l13.m6.2.2.4.cmml" xref="alg3.l13.m6.2.2.4"><csymbol cd="ambiguous" id="alg3.l13.m6.2.2.4.1.cmml" xref="alg3.l13.m6.2.2.4">subscript</csymbol><ci id="alg3.l13.m6.2.2.4.2.cmml" xref="alg3.l13.m6.2.2.4.2">ℓ</ci><ci id="alg3.l13.m6.2.2.4.3.cmml" xref="alg3.l13.m6.2.2.4.3">𝑖</ci></apply><list id="alg3.l13.m6.2.2.2.3.cmml" xref="alg3.l13.m6.2.2.2.2"><apply id="alg3.l13.m6.1.1.1.1.1.cmml" xref="alg3.l13.m6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg3.l13.m6.1.1.1.1.1.1.cmml" xref="alg3.l13.m6.1.1.1.1.1">subscript</csymbol><ci id="alg3.l13.m6.1.1.1.1.1.2.cmml" xref="alg3.l13.m6.1.1.1.1.1.2">𝒟</ci><ci id="alg3.l13.m6.1.1.1.1.1.3.cmml" xref="alg3.l13.m6.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg3.l13.m6.2.2.2.2.2.cmml" xref="alg3.l13.m6.2.2.2.2.2"><csymbol cd="ambiguous" id="alg3.l13.m6.2.2.2.2.2.1.cmml" xref="alg3.l13.m6.2.2.2.2.2">subscript</csymbol><ci id="alg3.l13.m6.2.2.2.2.2.2.cmml" xref="alg3.l13.m6.2.2.2.2.2.2">𝜃</ci><ci id="alg3.l13.m6.2.2.2.2.2.3.cmml" xref="alg3.l13.m6.2.2.2.2.2.3">𝑖</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l13.m6.2c">\ell_{i}(\mathcal{D}_{i};\theta_{i})</annotation></semantics></math>

</div>
<div id="alg3.l14" class="ltx_listingline">     <span id="alg3.l14.1" class="ltx_text ltx_font_bold">end</span> <span id="alg3.l14.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg3.l15" class="ltx_listingline">     <span id="alg3.l15.1" class="ltx_text ltx_font_sansserif">Return</span> <math id="alg3.l15.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg3.l15.m1.1a"><msub id="alg3.l15.m1.1.1" xref="alg3.l15.m1.1.1.cmml"><mi id="alg3.l15.m1.1.1.2" xref="alg3.l15.m1.1.1.2.cmml">θ</mi><mi id="alg3.l15.m1.1.1.3" xref="alg3.l15.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg3.l15.m1.1b"><apply id="alg3.l15.m1.1.1.cmml" xref="alg3.l15.m1.1.1"><csymbol cd="ambiguous" id="alg3.l15.m1.1.1.1.cmml" xref="alg3.l15.m1.1.1">subscript</csymbol><ci id="alg3.l15.m1.1.1.2.cmml" xref="alg3.l15.m1.1.1.2">𝜃</ci><ci id="alg3.l15.m1.1.1.3.cmml" xref="alg3.l15.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l15.m1.1c">\theta_{i}</annotation></semantics></math> as <math id="alg3.l15.m2.1" class="ltx_Math" alttext="\theta_{i}^{\prime}" display="inline"><semantics id="alg3.l15.m2.1a"><msubsup id="alg3.l15.m2.1.1" xref="alg3.l15.m2.1.1.cmml"><mi id="alg3.l15.m2.1.1.2.2" xref="alg3.l15.m2.1.1.2.2.cmml">θ</mi><mi id="alg3.l15.m2.1.1.2.3" xref="alg3.l15.m2.1.1.2.3.cmml">i</mi><mo id="alg3.l15.m2.1.1.3" xref="alg3.l15.m2.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="alg3.l15.m2.1b"><apply id="alg3.l15.m2.1.1.cmml" xref="alg3.l15.m2.1.1"><csymbol cd="ambiguous" id="alg3.l15.m2.1.1.1.cmml" xref="alg3.l15.m2.1.1">superscript</csymbol><apply id="alg3.l15.m2.1.1.2.cmml" xref="alg3.l15.m2.1.1"><csymbol cd="ambiguous" id="alg3.l15.m2.1.1.2.1.cmml" xref="alg3.l15.m2.1.1">subscript</csymbol><ci id="alg3.l15.m2.1.1.2.2.cmml" xref="alg3.l15.m2.1.1.2.2">𝜃</ci><ci id="alg3.l15.m2.1.1.2.3.cmml" xref="alg3.l15.m2.1.1.2.3">𝑖</ci></apply><ci id="alg3.l15.m2.1.1.3.cmml" xref="alg3.l15.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg3.l15.m2.1c">\theta_{i}^{\prime}</annotation></semantics></math> to server


</div>
</div>
</figure>
<figure id="alg4" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg4.2.1.1" class="ltx_text ltx_font_bold">Algorithm 4</span> </span> FedRecon</figcaption>
<div id="alg4.3" class="ltx_listing ltx_listing">
<div id="alg4.l1" class="ltx_listingline">  <span id="alg4.l1.1" class="ltx_text ltx_font_bold">Input:</span> <math id="alg4.l1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg4.l1.m1.1a"><mi id="alg4.l1.m1.1.1" xref="alg4.l1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m1.1b"><ci id="alg4.l1.m1.1.1.cmml" xref="alg4.l1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m1.1c">T</annotation></semantics></math> rounds, <math id="alg4.l1.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="alg4.l1.m2.1a"><mi id="alg4.l1.m2.1.1" xref="alg4.l1.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m2.1b"><ci id="alg4.l1.m2.1.1.cmml" xref="alg4.l1.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m2.1c">\tau</annotation></semantics></math> local gradient updates, <math id="alg4.l1.m3.1" class="ltx_Math" alttext="I" display="inline"><semantics id="alg4.l1.m3.1a"><mi id="alg4.l1.m3.1.1" xref="alg4.l1.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m3.1b"><ci id="alg4.l1.m3.1.1.cmml" xref="alg4.l1.m3.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m3.1c">I</annotation></semantics></math> clients, <math id="alg4.l1.m4.1" class="ltx_Math" alttext="r\ll I" display="inline"><semantics id="alg4.l1.m4.1a"><mrow id="alg4.l1.m4.1.1" xref="alg4.l1.m4.1.1.cmml"><mi id="alg4.l1.m4.1.1.2" xref="alg4.l1.m4.1.1.2.cmml">r</mi><mo id="alg4.l1.m4.1.1.1" xref="alg4.l1.m4.1.1.1.cmml">≪</mo><mi id="alg4.l1.m4.1.1.3" xref="alg4.l1.m4.1.1.3.cmml">I</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l1.m4.1b"><apply id="alg4.l1.m4.1.1.cmml" xref="alg4.l1.m4.1.1"><csymbol cd="latexml" id="alg4.l1.m4.1.1.1.cmml" xref="alg4.l1.m4.1.1.1">much-less-than</csymbol><ci id="alg4.l1.m4.1.1.2.cmml" xref="alg4.l1.m4.1.1.2">𝑟</ci><ci id="alg4.l1.m4.1.1.3.cmml" xref="alg4.l1.m4.1.1.3">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m4.1c">r\ll I</annotation></semantics></math> (average) sampled clients per round, <math id="alg4.l1.m5.1" class="ltx_Math" alttext="N_{i}" display="inline"><semantics id="alg4.l1.m5.1a"><msub id="alg4.l1.m5.1.1" xref="alg4.l1.m5.1.1.cmml"><mi id="alg4.l1.m5.1.1.2" xref="alg4.l1.m5.1.1.2.cmml">N</mi><mi id="alg4.l1.m5.1.1.3" xref="alg4.l1.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l1.m5.1b"><apply id="alg4.l1.m5.1.1.cmml" xref="alg4.l1.m5.1.1"><csymbol cd="ambiguous" id="alg4.l1.m5.1.1.1.cmml" xref="alg4.l1.m5.1.1">subscript</csymbol><ci id="alg4.l1.m5.1.1.2.cmml" xref="alg4.l1.m5.1.1.2">𝑁</ci><ci id="alg4.l1.m5.1.1.3.cmml" xref="alg4.l1.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m5.1c">N_{i}</annotation></semantics></math> data samples at the <math id="alg4.l1.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg4.l1.m6.1a"><mi id="alg4.l1.m6.1.1" xref="alg4.l1.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg4.l1.m6.1b"><ci id="alg4.l1.m6.1.1.cmml" xref="alg4.l1.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l1.m6.1c">i</annotation></semantics></math>-th client
</div>
<div id="alg4.l2" class="ltx_listingline">  <span id="alg4.l2.1" class="ltx_text ltx_font_bold">Server:</span>




</div>
<div id="alg4.l3" class="ltx_listingline">     <span id="alg4.l3.1" class="ltx_text ltx_font_sansserif">Initialize</span> global parameters <math id="alg4.l3.m1.1" class="ltx_Math" alttext="\theta_{1}" display="inline"><semantics id="alg4.l3.m1.1a"><msub id="alg4.l3.m1.1.1" xref="alg4.l3.m1.1.1.cmml"><mi id="alg4.l3.m1.1.1.2" xref="alg4.l3.m1.1.1.2.cmml">θ</mi><mn id="alg4.l3.m1.1.1.3" xref="alg4.l3.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="alg4.l3.m1.1b"><apply id="alg4.l3.m1.1.1.cmml" xref="alg4.l3.m1.1.1"><csymbol cd="ambiguous" id="alg4.l3.m1.1.1.1.cmml" xref="alg4.l3.m1.1.1">subscript</csymbol><ci id="alg4.l3.m1.1.1.2.cmml" xref="alg4.l3.m1.1.1.2">𝜃</ci><cn type="integer" id="alg4.l3.m1.1.1.3.cmml" xref="alg4.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l3.m1.1c">\theta_{1}</annotation></semantics></math>

</div>
<div id="alg4.l4" class="ltx_listingline">     <span id="alg4.l4.1" class="ltx_text ltx_font_bold">for</span>  round <math id="alg4.l4.m1.4" class="ltx_Math" alttext="t\,=1,2,...,T" display="inline"><semantics id="alg4.l4.m1.4a"><mrow id="alg4.l4.m1.4.5" xref="alg4.l4.m1.4.5.cmml"><mi id="alg4.l4.m1.4.5.2" xref="alg4.l4.m1.4.5.2.cmml">t</mi><mo lspace="0.448em" id="alg4.l4.m1.4.5.1" xref="alg4.l4.m1.4.5.1.cmml">=</mo><mrow id="alg4.l4.m1.4.5.3.2" xref="alg4.l4.m1.4.5.3.1.cmml"><mn id="alg4.l4.m1.1.1" xref="alg4.l4.m1.1.1.cmml">1</mn><mo id="alg4.l4.m1.4.5.3.2.1" xref="alg4.l4.m1.4.5.3.1.cmml">,</mo><mn id="alg4.l4.m1.2.2" xref="alg4.l4.m1.2.2.cmml">2</mn><mo id="alg4.l4.m1.4.5.3.2.2" xref="alg4.l4.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg4.l4.m1.3.3" xref="alg4.l4.m1.3.3.cmml">…</mi><mo id="alg4.l4.m1.4.5.3.2.3" xref="alg4.l4.m1.4.5.3.1.cmml">,</mo><mi id="alg4.l4.m1.4.4" xref="alg4.l4.m1.4.4.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l4.m1.4b"><apply id="alg4.l4.m1.4.5.cmml" xref="alg4.l4.m1.4.5"><eq id="alg4.l4.m1.4.5.1.cmml" xref="alg4.l4.m1.4.5.1"></eq><ci id="alg4.l4.m1.4.5.2.cmml" xref="alg4.l4.m1.4.5.2">𝑡</ci><list id="alg4.l4.m1.4.5.3.1.cmml" xref="alg4.l4.m1.4.5.3.2"><cn type="integer" id="alg4.l4.m1.1.1.cmml" xref="alg4.l4.m1.1.1">1</cn><cn type="integer" id="alg4.l4.m1.2.2.cmml" xref="alg4.l4.m1.2.2">2</cn><ci id="alg4.l4.m1.3.3.cmml" xref="alg4.l4.m1.3.3">…</ci><ci id="alg4.l4.m1.4.4.cmml" xref="alg4.l4.m1.4.4">𝑇</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l4.m1.4c">t\,=1,2,...,T</annotation></semantics></math> <span id="alg4.l4.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg4.l5" class="ltx_listingline">        <math id="alg4.l5.m1.1" class="ltx_Math" alttext="\mathcal{I}_{t}\leftarrow" display="inline"><semantics id="alg4.l5.m1.1a"><mrow id="alg4.l5.m1.1.1" xref="alg4.l5.m1.1.1.cmml"><msub id="alg4.l5.m1.1.1.2" xref="alg4.l5.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg4.l5.m1.1.1.2.2" xref="alg4.l5.m1.1.1.2.2.cmml">ℐ</mi><mi id="alg4.l5.m1.1.1.2.3" xref="alg4.l5.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg4.l5.m1.1.1.1" xref="alg4.l5.m1.1.1.1.cmml">←</mo><mi id="alg4.l5.m1.1.1.3" xref="alg4.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l5.m1.1b"><apply id="alg4.l5.m1.1.1.cmml" xref="alg4.l5.m1.1.1"><ci id="alg4.l5.m1.1.1.1.cmml" xref="alg4.l5.m1.1.1.1">←</ci><apply id="alg4.l5.m1.1.1.2.cmml" xref="alg4.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg4.l5.m1.1.1.2.1.cmml" xref="alg4.l5.m1.1.1.2">subscript</csymbol><ci id="alg4.l5.m1.1.1.2.2.cmml" xref="alg4.l5.m1.1.1.2.2">ℐ</ci><ci id="alg4.l5.m1.1.1.2.3.cmml" xref="alg4.l5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg4.l5.m1.1.1.3.cmml" xref="alg4.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l5.m1.1c">\mathcal{I}_{t}\leftarrow</annotation></semantics></math> (Select a random subset of clients)

</div>
<div id="alg4.l6" class="ltx_listingline">        <span id="alg4.l6.1" class="ltx_text ltx_font_sansserif">Receive</span>
<math id="alg4.l6.m1.1" class="ltx_Math" alttext="\mathbf{g}_{i}" display="inline"><semantics id="alg4.l6.m1.1a"><msub id="alg4.l6.m1.1.1" xref="alg4.l6.m1.1.1.cmml"><mi id="alg4.l6.m1.1.1.2" xref="alg4.l6.m1.1.1.2.cmml">𝐠</mi><mi id="alg4.l6.m1.1.1.3" xref="alg4.l6.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l6.m1.1b"><apply id="alg4.l6.m1.1.1.cmml" xref="alg4.l6.m1.1.1"><csymbol cd="ambiguous" id="alg4.l6.m1.1.1.1.cmml" xref="alg4.l6.m1.1.1">subscript</csymbol><ci id="alg4.l6.m1.1.1.2.cmml" xref="alg4.l6.m1.1.1.2">𝐠</ci><ci id="alg4.l6.m1.1.1.3.cmml" xref="alg4.l6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.m1.1c">\mathbf{g}_{i}</annotation></semantics></math> from each <span id="alg4.l6.2" class="ltx_text ltx_font_typewriter">client i</span> <math id="alg4.l6.m2.1" class="ltx_Math" alttext="\in" display="inline"><semantics id="alg4.l6.m2.1a"><mo id="alg4.l6.m2.1.1" xref="alg4.l6.m2.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="alg4.l6.m2.1b"><in id="alg4.l6.m2.1.1.cmml" xref="alg4.l6.m2.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.m2.1c">\in</annotation></semantics></math> <math id="alg4.l6.m3.1" class="ltx_Math" alttext="I_{t}" display="inline"><semantics id="alg4.l6.m3.1a"><msub id="alg4.l6.m3.1.1" xref="alg4.l6.m3.1.1.cmml"><mi id="alg4.l6.m3.1.1.2" xref="alg4.l6.m3.1.1.2.cmml">I</mi><mi id="alg4.l6.m3.1.1.3" xref="alg4.l6.m3.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l6.m3.1b"><apply id="alg4.l6.m3.1.1.cmml" xref="alg4.l6.m3.1.1"><csymbol cd="ambiguous" id="alg4.l6.m3.1.1.1.cmml" xref="alg4.l6.m3.1.1">subscript</csymbol><ci id="alg4.l6.m3.1.1.2.cmml" xref="alg4.l6.m3.1.1.2">𝐼</ci><ci id="alg4.l6.m3.1.1.3.cmml" xref="alg4.l6.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.m3.1c">I_{t}</annotation></semantics></math>
<span id="alg4.l6.3" class="ltx_ERROR undefined">{fleqn}</span>[]
<span id="alg4.l6.4" class="ltx_text ltx_font_sansserif">Aggregate: </span>
<math id="alg4.l6.m4.1" class="ltx_Math" alttext="\theta_{t+1}\leftarrow\theta_{t}-\rho_{t}\frac{I}{r}\sum_{i\in I_{t}}a_{i}\mathbf{g}_{i}" display="inline"><semantics id="alg4.l6.m4.1a"><mrow id="alg4.l6.m4.1.1" xref="alg4.l6.m4.1.1.cmml"><msub id="alg4.l6.m4.1.1.2" xref="alg4.l6.m4.1.1.2.cmml"><mi id="alg4.l6.m4.1.1.2.2" xref="alg4.l6.m4.1.1.2.2.cmml">θ</mi><mrow id="alg4.l6.m4.1.1.2.3" xref="alg4.l6.m4.1.1.2.3.cmml"><mi id="alg4.l6.m4.1.1.2.3.2" xref="alg4.l6.m4.1.1.2.3.2.cmml">t</mi><mo id="alg4.l6.m4.1.1.2.3.1" xref="alg4.l6.m4.1.1.2.3.1.cmml">+</mo><mn id="alg4.l6.m4.1.1.2.3.3" xref="alg4.l6.m4.1.1.2.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="alg4.l6.m4.1.1.1" xref="alg4.l6.m4.1.1.1.cmml">←</mo><mrow id="alg4.l6.m4.1.1.3" xref="alg4.l6.m4.1.1.3.cmml"><msub id="alg4.l6.m4.1.1.3.2" xref="alg4.l6.m4.1.1.3.2.cmml"><mi id="alg4.l6.m4.1.1.3.2.2" xref="alg4.l6.m4.1.1.3.2.2.cmml">θ</mi><mi id="alg4.l6.m4.1.1.3.2.3" xref="alg4.l6.m4.1.1.3.2.3.cmml">t</mi></msub><mo id="alg4.l6.m4.1.1.3.1" xref="alg4.l6.m4.1.1.3.1.cmml">−</mo><mrow id="alg4.l6.m4.1.1.3.3" xref="alg4.l6.m4.1.1.3.3.cmml"><msub id="alg4.l6.m4.1.1.3.3.2" xref="alg4.l6.m4.1.1.3.3.2.cmml"><mi id="alg4.l6.m4.1.1.3.3.2.2" xref="alg4.l6.m4.1.1.3.3.2.2.cmml">ρ</mi><mi id="alg4.l6.m4.1.1.3.3.2.3" xref="alg4.l6.m4.1.1.3.3.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="alg4.l6.m4.1.1.3.3.1" xref="alg4.l6.m4.1.1.3.3.1.cmml">​</mo><mfrac id="alg4.l6.m4.1.1.3.3.3" xref="alg4.l6.m4.1.1.3.3.3.cmml"><mi id="alg4.l6.m4.1.1.3.3.3.2" xref="alg4.l6.m4.1.1.3.3.3.2.cmml">I</mi><mi id="alg4.l6.m4.1.1.3.3.3.3" xref="alg4.l6.m4.1.1.3.3.3.3.cmml">r</mi></mfrac><mo lspace="0em" rspace="0em" id="alg4.l6.m4.1.1.3.3.1a" xref="alg4.l6.m4.1.1.3.3.1.cmml">​</mo><mrow id="alg4.l6.m4.1.1.3.3.4" xref="alg4.l6.m4.1.1.3.3.4.cmml"><msub id="alg4.l6.m4.1.1.3.3.4.1" xref="alg4.l6.m4.1.1.3.3.4.1.cmml"><mo id="alg4.l6.m4.1.1.3.3.4.1.2" xref="alg4.l6.m4.1.1.3.3.4.1.2.cmml">∑</mo><mrow id="alg4.l6.m4.1.1.3.3.4.1.3" xref="alg4.l6.m4.1.1.3.3.4.1.3.cmml"><mi id="alg4.l6.m4.1.1.3.3.4.1.3.2" xref="alg4.l6.m4.1.1.3.3.4.1.3.2.cmml">i</mi><mo id="alg4.l6.m4.1.1.3.3.4.1.3.1" xref="alg4.l6.m4.1.1.3.3.4.1.3.1.cmml">∈</mo><msub id="alg4.l6.m4.1.1.3.3.4.1.3.3" xref="alg4.l6.m4.1.1.3.3.4.1.3.3.cmml"><mi id="alg4.l6.m4.1.1.3.3.4.1.3.3.2" xref="alg4.l6.m4.1.1.3.3.4.1.3.3.2.cmml">I</mi><mi id="alg4.l6.m4.1.1.3.3.4.1.3.3.3" xref="alg4.l6.m4.1.1.3.3.4.1.3.3.3.cmml">t</mi></msub></mrow></msub><mrow id="alg4.l6.m4.1.1.3.3.4.2" xref="alg4.l6.m4.1.1.3.3.4.2.cmml"><msub id="alg4.l6.m4.1.1.3.3.4.2.2" xref="alg4.l6.m4.1.1.3.3.4.2.2.cmml"><mi id="alg4.l6.m4.1.1.3.3.4.2.2.2" xref="alg4.l6.m4.1.1.3.3.4.2.2.2.cmml">a</mi><mi id="alg4.l6.m4.1.1.3.3.4.2.2.3" xref="alg4.l6.m4.1.1.3.3.4.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg4.l6.m4.1.1.3.3.4.2.1" xref="alg4.l6.m4.1.1.3.3.4.2.1.cmml">​</mo><msub id="alg4.l6.m4.1.1.3.3.4.2.3" xref="alg4.l6.m4.1.1.3.3.4.2.3.cmml"><mi id="alg4.l6.m4.1.1.3.3.4.2.3.2" xref="alg4.l6.m4.1.1.3.3.4.2.3.2.cmml">𝐠</mi><mi id="alg4.l6.m4.1.1.3.3.4.2.3.3" xref="alg4.l6.m4.1.1.3.3.4.2.3.3.cmml">i</mi></msub></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l6.m4.1b"><apply id="alg4.l6.m4.1.1.cmml" xref="alg4.l6.m4.1.1"><ci id="alg4.l6.m4.1.1.1.cmml" xref="alg4.l6.m4.1.1.1">←</ci><apply id="alg4.l6.m4.1.1.2.cmml" xref="alg4.l6.m4.1.1.2"><csymbol cd="ambiguous" id="alg4.l6.m4.1.1.2.1.cmml" xref="alg4.l6.m4.1.1.2">subscript</csymbol><ci id="alg4.l6.m4.1.1.2.2.cmml" xref="alg4.l6.m4.1.1.2.2">𝜃</ci><apply id="alg4.l6.m4.1.1.2.3.cmml" xref="alg4.l6.m4.1.1.2.3"><plus id="alg4.l6.m4.1.1.2.3.1.cmml" xref="alg4.l6.m4.1.1.2.3.1"></plus><ci id="alg4.l6.m4.1.1.2.3.2.cmml" xref="alg4.l6.m4.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg4.l6.m4.1.1.2.3.3.cmml" xref="alg4.l6.m4.1.1.2.3.3">1</cn></apply></apply><apply id="alg4.l6.m4.1.1.3.cmml" xref="alg4.l6.m4.1.1.3"><minus id="alg4.l6.m4.1.1.3.1.cmml" xref="alg4.l6.m4.1.1.3.1"></minus><apply id="alg4.l6.m4.1.1.3.2.cmml" xref="alg4.l6.m4.1.1.3.2"><csymbol cd="ambiguous" id="alg4.l6.m4.1.1.3.2.1.cmml" xref="alg4.l6.m4.1.1.3.2">subscript</csymbol><ci id="alg4.l6.m4.1.1.3.2.2.cmml" xref="alg4.l6.m4.1.1.3.2.2">𝜃</ci><ci id="alg4.l6.m4.1.1.3.2.3.cmml" xref="alg4.l6.m4.1.1.3.2.3">𝑡</ci></apply><apply id="alg4.l6.m4.1.1.3.3.cmml" xref="alg4.l6.m4.1.1.3.3"><times id="alg4.l6.m4.1.1.3.3.1.cmml" xref="alg4.l6.m4.1.1.3.3.1"></times><apply id="alg4.l6.m4.1.1.3.3.2.cmml" xref="alg4.l6.m4.1.1.3.3.2"><csymbol cd="ambiguous" id="alg4.l6.m4.1.1.3.3.2.1.cmml" xref="alg4.l6.m4.1.1.3.3.2">subscript</csymbol><ci id="alg4.l6.m4.1.1.3.3.2.2.cmml" xref="alg4.l6.m4.1.1.3.3.2.2">𝜌</ci><ci id="alg4.l6.m4.1.1.3.3.2.3.cmml" xref="alg4.l6.m4.1.1.3.3.2.3">𝑡</ci></apply><apply id="alg4.l6.m4.1.1.3.3.3.cmml" xref="alg4.l6.m4.1.1.3.3.3"><divide id="alg4.l6.m4.1.1.3.3.3.1.cmml" xref="alg4.l6.m4.1.1.3.3.3"></divide><ci id="alg4.l6.m4.1.1.3.3.3.2.cmml" xref="alg4.l6.m4.1.1.3.3.3.2">𝐼</ci><ci id="alg4.l6.m4.1.1.3.3.3.3.cmml" xref="alg4.l6.m4.1.1.3.3.3.3">𝑟</ci></apply><apply id="alg4.l6.m4.1.1.3.3.4.cmml" xref="alg4.l6.m4.1.1.3.3.4"><apply id="alg4.l6.m4.1.1.3.3.4.1.cmml" xref="alg4.l6.m4.1.1.3.3.4.1"><csymbol cd="ambiguous" id="alg4.l6.m4.1.1.3.3.4.1.1.cmml" xref="alg4.l6.m4.1.1.3.3.4.1">subscript</csymbol><sum id="alg4.l6.m4.1.1.3.3.4.1.2.cmml" xref="alg4.l6.m4.1.1.3.3.4.1.2"></sum><apply id="alg4.l6.m4.1.1.3.3.4.1.3.cmml" xref="alg4.l6.m4.1.1.3.3.4.1.3"><in id="alg4.l6.m4.1.1.3.3.4.1.3.1.cmml" xref="alg4.l6.m4.1.1.3.3.4.1.3.1"></in><ci id="alg4.l6.m4.1.1.3.3.4.1.3.2.cmml" xref="alg4.l6.m4.1.1.3.3.4.1.3.2">𝑖</ci><apply id="alg4.l6.m4.1.1.3.3.4.1.3.3.cmml" xref="alg4.l6.m4.1.1.3.3.4.1.3.3"><csymbol cd="ambiguous" id="alg4.l6.m4.1.1.3.3.4.1.3.3.1.cmml" xref="alg4.l6.m4.1.1.3.3.4.1.3.3">subscript</csymbol><ci id="alg4.l6.m4.1.1.3.3.4.1.3.3.2.cmml" xref="alg4.l6.m4.1.1.3.3.4.1.3.3.2">𝐼</ci><ci id="alg4.l6.m4.1.1.3.3.4.1.3.3.3.cmml" xref="alg4.l6.m4.1.1.3.3.4.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg4.l6.m4.1.1.3.3.4.2.cmml" xref="alg4.l6.m4.1.1.3.3.4.2"><times id="alg4.l6.m4.1.1.3.3.4.2.1.cmml" xref="alg4.l6.m4.1.1.3.3.4.2.1"></times><apply id="alg4.l6.m4.1.1.3.3.4.2.2.cmml" xref="alg4.l6.m4.1.1.3.3.4.2.2"><csymbol cd="ambiguous" id="alg4.l6.m4.1.1.3.3.4.2.2.1.cmml" xref="alg4.l6.m4.1.1.3.3.4.2.2">subscript</csymbol><ci id="alg4.l6.m4.1.1.3.3.4.2.2.2.cmml" xref="alg4.l6.m4.1.1.3.3.4.2.2.2">𝑎</ci><ci id="alg4.l6.m4.1.1.3.3.4.2.2.3.cmml" xref="alg4.l6.m4.1.1.3.3.4.2.2.3">𝑖</ci></apply><apply id="alg4.l6.m4.1.1.3.3.4.2.3.cmml" xref="alg4.l6.m4.1.1.3.3.4.2.3"><csymbol cd="ambiguous" id="alg4.l6.m4.1.1.3.3.4.2.3.1.cmml" xref="alg4.l6.m4.1.1.3.3.4.2.3">subscript</csymbol><ci id="alg4.l6.m4.1.1.3.3.4.2.3.2.cmml" xref="alg4.l6.m4.1.1.3.3.4.2.3.2">𝐠</ci><ci id="alg4.l6.m4.1.1.3.3.4.2.3.3.cmml" xref="alg4.l6.m4.1.1.3.3.4.2.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l6.m4.1c">\theta_{t+1}\leftarrow\theta_{t}-\rho_{t}\frac{I}{r}\sum_{i\in I_{t}}a_{i}\mathbf{g}_{i}</annotation></semantics></math>


</div>
<div id="alg4.l7" class="ltx_listingline">     <span id="alg4.l7.1" class="ltx_text ltx_font_bold">end</span> <span id="alg4.l7.2" class="ltx_text ltx_font_bold">for</span>

</div>
<div id="alg4.l8" class="ltx_listingline">  
</div>
<div id="alg4.l9" class="ltx_listingline">  <span id="alg4.l9.1" class="ltx_text ltx_font_bold">ClientI_Update(<math id="alg4.l9.1.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="alg4.l9.1.m1.1a"><msub id="alg4.l9.1.m1.1.1" xref="alg4.l9.1.m1.1.1.cmml"><mi id="alg4.l9.1.m1.1.1.2" xref="alg4.l9.1.m1.1.1.2.cmml">θ</mi><mi id="alg4.l9.1.m1.1.1.3" xref="alg4.l9.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l9.1.m1.1b"><apply id="alg4.l9.1.m1.1.1.cmml" xref="alg4.l9.1.m1.1.1"><csymbol cd="ambiguous" id="alg4.l9.1.m1.1.1.1.cmml" xref="alg4.l9.1.m1.1.1">subscript</csymbol><ci id="alg4.l9.1.m1.1.1.2.cmml" xref="alg4.l9.1.m1.1.1.2">𝜃</ci><ci id="alg4.l9.1.m1.1.1.3.cmml" xref="alg4.l9.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l9.1.m1.1c">\theta_{t}</annotation></semantics></math>):</span>#runs on client <math id="alg4.l9.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg4.l9.m1.1a"><mi id="alg4.l9.m1.1.1" xref="alg4.l9.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg4.l9.m1.1b"><ci id="alg4.l9.m1.1.1.cmml" xref="alg4.l9.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l9.m1.1c">i</annotation></semantics></math>




</div>
<div id="alg4.l10" class="ltx_listingline">     <span id="alg4.l10.1" class="ltx_text ltx_font_sansserif">Initialize</span> <math id="alg4.l10.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="alg4.l10.m1.1a"><msub id="alg4.l10.m1.1.1" xref="alg4.l10.m1.1.1.cmml"><mi id="alg4.l10.m1.1.1.2" xref="alg4.l10.m1.1.1.2.cmml">W</mi><mi id="alg4.l10.m1.1.1.3" xref="alg4.l10.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l10.m1.1b"><apply id="alg4.l10.m1.1.1.cmml" xref="alg4.l10.m1.1.1"><csymbol cd="ambiguous" id="alg4.l10.m1.1.1.1.cmml" xref="alg4.l10.m1.1.1">subscript</csymbol><ci id="alg4.l10.m1.1.1.2.cmml" xref="alg4.l10.m1.1.1.2">𝑊</ci><ci id="alg4.l10.m1.1.1.3.cmml" xref="alg4.l10.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l10.m1.1c">W_{i}</annotation></semantics></math>, the first time client <math id="alg4.l10.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="alg4.l10.m2.1a"><mi id="alg4.l10.m2.1.1" xref="alg4.l10.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="alg4.l10.m2.1b"><ci id="alg4.l10.m2.1.1.cmml" xref="alg4.l10.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l10.m2.1c">i</annotation></semantics></math> is visited

</div>
<div id="alg4.l11" class="ltx_listingline">     <span id="alg4.l11.1" class="ltx_text ltx_font_bold">for</span> local gradient
update <math id="alg4.l11.m1.4" class="ltx_Math" alttext="=1,2,...,\tau" display="inline"><semantics id="alg4.l11.m1.4a"><mrow id="alg4.l11.m1.4.5" xref="alg4.l11.m1.4.5.cmml"><mi id="alg4.l11.m1.4.5.2" xref="alg4.l11.m1.4.5.2.cmml"></mi><mo id="alg4.l11.m1.4.5.1" xref="alg4.l11.m1.4.5.1.cmml">=</mo><mrow id="alg4.l11.m1.4.5.3.2" xref="alg4.l11.m1.4.5.3.1.cmml"><mn id="alg4.l11.m1.1.1" xref="alg4.l11.m1.1.1.cmml">1</mn><mo id="alg4.l11.m1.4.5.3.2.1" xref="alg4.l11.m1.4.5.3.1.cmml">,</mo><mn id="alg4.l11.m1.2.2" xref="alg4.l11.m1.2.2.cmml">2</mn><mo id="alg4.l11.m1.4.5.3.2.2" xref="alg4.l11.m1.4.5.3.1.cmml">,</mo><mi mathvariant="normal" id="alg4.l11.m1.3.3" xref="alg4.l11.m1.3.3.cmml">…</mi><mo id="alg4.l11.m1.4.5.3.2.3" xref="alg4.l11.m1.4.5.3.1.cmml">,</mo><mi id="alg4.l11.m1.4.4" xref="alg4.l11.m1.4.4.cmml">τ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l11.m1.4b"><apply id="alg4.l11.m1.4.5.cmml" xref="alg4.l11.m1.4.5"><eq id="alg4.l11.m1.4.5.1.cmml" xref="alg4.l11.m1.4.5.1"></eq><csymbol cd="latexml" id="alg4.l11.m1.4.5.2.cmml" xref="alg4.l11.m1.4.5.2">absent</csymbol><list id="alg4.l11.m1.4.5.3.1.cmml" xref="alg4.l11.m1.4.5.3.2"><cn type="integer" id="alg4.l11.m1.1.1.cmml" xref="alg4.l11.m1.1.1">1</cn><cn type="integer" id="alg4.l11.m1.2.2.cmml" xref="alg4.l11.m1.2.2">2</cn><ci id="alg4.l11.m1.3.3.cmml" xref="alg4.l11.m1.3.3">…</ci><ci id="alg4.l11.m1.4.4.cmml" xref="alg4.l11.m1.4.4">𝜏</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l11.m1.4c">=1,2,...,\tau</annotation></semantics></math> <span id="alg4.l11.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg4.l12" class="ltx_listingline">        <math id="alg4.l12.m1.1" class="ltx_Math" alttext="W_{i}" display="inline"><semantics id="alg4.l12.m1.1a"><msub id="alg4.l12.m1.1.1" xref="alg4.l12.m1.1.1.cmml"><mi id="alg4.l12.m1.1.1.2" xref="alg4.l12.m1.1.1.2.cmml">W</mi><mi id="alg4.l12.m1.1.1.3" xref="alg4.l12.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg4.l12.m1.1b"><apply id="alg4.l12.m1.1.1.cmml" xref="alg4.l12.m1.1.1"><csymbol cd="ambiguous" id="alg4.l12.m1.1.1.1.cmml" xref="alg4.l12.m1.1.1">subscript</csymbol><ci id="alg4.l12.m1.1.1.2.cmml" xref="alg4.l12.m1.1.1.2">𝑊</ci><ci id="alg4.l12.m1.1.1.3.cmml" xref="alg4.l12.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m1.1c">W_{i}</annotation></semantics></math> <math id="alg4.l12.m2.1" class="ltx_Math" alttext="\leftarrow" display="inline"><semantics id="alg4.l12.m2.1a"><mo stretchy="false" id="alg4.l12.m2.1.1" xref="alg4.l12.m2.1.1.cmml">←</mo><annotation-xml encoding="MathML-Content" id="alg4.l12.m2.1b"><ci id="alg4.l12.m2.1.1.cmml" xref="alg4.l12.m2.1.1">←</ci></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m2.1c">\leftarrow</annotation></semantics></math> <math id="alg4.l12.m3.1" class="ltx_Math" alttext="W_{i}-\beta" display="inline"><semantics id="alg4.l12.m3.1a"><mrow id="alg4.l12.m3.1.1" xref="alg4.l12.m3.1.1.cmml"><msub id="alg4.l12.m3.1.1.2" xref="alg4.l12.m3.1.1.2.cmml"><mi id="alg4.l12.m3.1.1.2.2" xref="alg4.l12.m3.1.1.2.2.cmml">W</mi><mi id="alg4.l12.m3.1.1.2.3" xref="alg4.l12.m3.1.1.2.3.cmml">i</mi></msub><mo id="alg4.l12.m3.1.1.1" xref="alg4.l12.m3.1.1.1.cmml">−</mo><mi id="alg4.l12.m3.1.1.3" xref="alg4.l12.m3.1.1.3.cmml">β</mi></mrow><annotation-xml encoding="MathML-Content" id="alg4.l12.m3.1b"><apply id="alg4.l12.m3.1.1.cmml" xref="alg4.l12.m3.1.1"><minus id="alg4.l12.m3.1.1.1.cmml" xref="alg4.l12.m3.1.1.1"></minus><apply id="alg4.l12.m3.1.1.2.cmml" xref="alg4.l12.m3.1.1.2"><csymbol cd="ambiguous" id="alg4.l12.m3.1.1.2.1.cmml" xref="alg4.l12.m3.1.1.2">subscript</csymbol><ci id="alg4.l12.m3.1.1.2.2.cmml" xref="alg4.l12.m3.1.1.2.2">𝑊</ci><ci id="alg4.l12.m3.1.1.2.3.cmml" xref="alg4.l12.m3.1.1.2.3">𝑖</ci></apply><ci id="alg4.l12.m3.1.1.3.cmml" xref="alg4.l12.m3.1.1.3">𝛽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m3.1c">W_{i}-\beta</annotation></semantics></math> <math id="alg4.l12.m4.1" class="ltx_Math" alttext="\nabla_{W_{i}}" display="inline"><semantics id="alg4.l12.m4.1a"><msub id="alg4.l12.m4.1.1" xref="alg4.l12.m4.1.1.cmml"><mo id="alg4.l12.m4.1.1.2" xref="alg4.l12.m4.1.1.2.cmml">∇</mo><msub id="alg4.l12.m4.1.1.3" xref="alg4.l12.m4.1.1.3.cmml"><mi id="alg4.l12.m4.1.1.3.2" xref="alg4.l12.m4.1.1.3.2.cmml">W</mi><mi id="alg4.l12.m4.1.1.3.3" xref="alg4.l12.m4.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg4.l12.m4.1b"><apply id="alg4.l12.m4.1.1.cmml" xref="alg4.l12.m4.1.1"><csymbol cd="ambiguous" id="alg4.l12.m4.1.1.1.cmml" xref="alg4.l12.m4.1.1">subscript</csymbol><ci id="alg4.l12.m4.1.1.2.cmml" xref="alg4.l12.m4.1.1.2">∇</ci><apply id="alg4.l12.m4.1.1.3.cmml" xref="alg4.l12.m4.1.1.3"><csymbol cd="ambiguous" id="alg4.l12.m4.1.1.3.1.cmml" xref="alg4.l12.m4.1.1.3">subscript</csymbol><ci id="alg4.l12.m4.1.1.3.2.cmml" xref="alg4.l12.m4.1.1.3.2">𝑊</ci><ci id="alg4.l12.m4.1.1.3.3.cmml" xref="alg4.l12.m4.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m4.1c">\nabla_{W_{i}}</annotation></semantics></math><math id="alg4.l12.m5.2" class="ltx_Math" alttext="\ell_{i}(W_{i},\theta_{t})" display="inline"><semantics id="alg4.l12.m5.2a"><mrow id="alg4.l12.m5.2.2" xref="alg4.l12.m5.2.2.cmml"><msub id="alg4.l12.m5.2.2.4" xref="alg4.l12.m5.2.2.4.cmml"><mi mathvariant="normal" id="alg4.l12.m5.2.2.4.2" xref="alg4.l12.m5.2.2.4.2.cmml">ℓ</mi><mi id="alg4.l12.m5.2.2.4.3" xref="alg4.l12.m5.2.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="alg4.l12.m5.2.2.3" xref="alg4.l12.m5.2.2.3.cmml">​</mo><mrow id="alg4.l12.m5.2.2.2.2" xref="alg4.l12.m5.2.2.2.3.cmml"><mo stretchy="false" id="alg4.l12.m5.2.2.2.2.3" xref="alg4.l12.m5.2.2.2.3.cmml">(</mo><msub id="alg4.l12.m5.1.1.1.1.1" xref="alg4.l12.m5.1.1.1.1.1.cmml"><mi id="alg4.l12.m5.1.1.1.1.1.2" xref="alg4.l12.m5.1.1.1.1.1.2.cmml">W</mi><mi id="alg4.l12.m5.1.1.1.1.1.3" xref="alg4.l12.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg4.l12.m5.2.2.2.2.4" xref="alg4.l12.m5.2.2.2.3.cmml">,</mo><msub id="alg4.l12.m5.2.2.2.2.2" xref="alg4.l12.m5.2.2.2.2.2.cmml"><mi id="alg4.l12.m5.2.2.2.2.2.2" xref="alg4.l12.m5.2.2.2.2.2.2.cmml">θ</mi><mi id="alg4.l12.m5.2.2.2.2.2.3" xref="alg4.l12.m5.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg4.l12.m5.2.2.2.2.5" xref="alg4.l12.m5.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l12.m5.2b"><apply id="alg4.l12.m5.2.2.cmml" xref="alg4.l12.m5.2.2"><times id="alg4.l12.m5.2.2.3.cmml" xref="alg4.l12.m5.2.2.3"></times><apply id="alg4.l12.m5.2.2.4.cmml" xref="alg4.l12.m5.2.2.4"><csymbol cd="ambiguous" id="alg4.l12.m5.2.2.4.1.cmml" xref="alg4.l12.m5.2.2.4">subscript</csymbol><ci id="alg4.l12.m5.2.2.4.2.cmml" xref="alg4.l12.m5.2.2.4.2">ℓ</ci><ci id="alg4.l12.m5.2.2.4.3.cmml" xref="alg4.l12.m5.2.2.4.3">𝑖</ci></apply><interval closure="open" id="alg4.l12.m5.2.2.2.3.cmml" xref="alg4.l12.m5.2.2.2.2"><apply id="alg4.l12.m5.1.1.1.1.1.cmml" xref="alg4.l12.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l12.m5.1.1.1.1.1.1.cmml" xref="alg4.l12.m5.1.1.1.1.1">subscript</csymbol><ci id="alg4.l12.m5.1.1.1.1.1.2.cmml" xref="alg4.l12.m5.1.1.1.1.1.2">𝑊</ci><ci id="alg4.l12.m5.1.1.1.1.1.3.cmml" xref="alg4.l12.m5.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg4.l12.m5.2.2.2.2.2.cmml" xref="alg4.l12.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="alg4.l12.m5.2.2.2.2.2.1.cmml" xref="alg4.l12.m5.2.2.2.2.2">subscript</csymbol><ci id="alg4.l12.m5.2.2.2.2.2.2.cmml" xref="alg4.l12.m5.2.2.2.2.2.2">𝜃</ci><ci id="alg4.l12.m5.2.2.2.2.2.3.cmml" xref="alg4.l12.m5.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l12.m5.2c">\ell_{i}(W_{i},\theta_{t})</annotation></semantics></math>

</div>
<div id="alg4.l13" class="ltx_listingline">     <span id="alg4.l13.1" class="ltx_text ltx_font_bold">end</span> <span id="alg4.l13.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg4.l14" class="ltx_listingline">     <span id="alg4.l14.1" class="ltx_text ltx_font_sansserif">Return</span> <math id="alg4.l14.m1.2" class="ltx_Math" alttext="\mathbf{g}_{i}:=\nabla_{\theta_{t}}\ell_{i}(W_{i},\theta_{t})" display="inline"><semantics id="alg4.l14.m1.2a"><mrow id="alg4.l14.m1.2.2" xref="alg4.l14.m1.2.2.cmml"><msub id="alg4.l14.m1.2.2.4" xref="alg4.l14.m1.2.2.4.cmml"><mi id="alg4.l14.m1.2.2.4.2" xref="alg4.l14.m1.2.2.4.2.cmml">𝐠</mi><mi id="alg4.l14.m1.2.2.4.3" xref="alg4.l14.m1.2.2.4.3.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="alg4.l14.m1.2.2.3" xref="alg4.l14.m1.2.2.3.cmml">:=</mo><mrow id="alg4.l14.m1.2.2.2" xref="alg4.l14.m1.2.2.2.cmml"><mrow id="alg4.l14.m1.2.2.2.4" xref="alg4.l14.m1.2.2.2.4.cmml"><msub id="alg4.l14.m1.2.2.2.4.1" xref="alg4.l14.m1.2.2.2.4.1.cmml"><mo rspace="0.167em" id="alg4.l14.m1.2.2.2.4.1.2" xref="alg4.l14.m1.2.2.2.4.1.2.cmml">∇</mo><msub id="alg4.l14.m1.2.2.2.4.1.3" xref="alg4.l14.m1.2.2.2.4.1.3.cmml"><mi id="alg4.l14.m1.2.2.2.4.1.3.2" xref="alg4.l14.m1.2.2.2.4.1.3.2.cmml">θ</mi><mi id="alg4.l14.m1.2.2.2.4.1.3.3" xref="alg4.l14.m1.2.2.2.4.1.3.3.cmml">t</mi></msub></msub><msub id="alg4.l14.m1.2.2.2.4.2" xref="alg4.l14.m1.2.2.2.4.2.cmml"><mi mathvariant="normal" id="alg4.l14.m1.2.2.2.4.2.2" xref="alg4.l14.m1.2.2.2.4.2.2.cmml">ℓ</mi><mi id="alg4.l14.m1.2.2.2.4.2.3" xref="alg4.l14.m1.2.2.2.4.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg4.l14.m1.2.2.2.3" xref="alg4.l14.m1.2.2.2.3.cmml">​</mo><mrow id="alg4.l14.m1.2.2.2.2.2" xref="alg4.l14.m1.2.2.2.2.3.cmml"><mo stretchy="false" id="alg4.l14.m1.2.2.2.2.2.3" xref="alg4.l14.m1.2.2.2.2.3.cmml">(</mo><msub id="alg4.l14.m1.1.1.1.1.1.1" xref="alg4.l14.m1.1.1.1.1.1.1.cmml"><mi id="alg4.l14.m1.1.1.1.1.1.1.2" xref="alg4.l14.m1.1.1.1.1.1.1.2.cmml">W</mi><mi id="alg4.l14.m1.1.1.1.1.1.1.3" xref="alg4.l14.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg4.l14.m1.2.2.2.2.2.4" xref="alg4.l14.m1.2.2.2.2.3.cmml">,</mo><msub id="alg4.l14.m1.2.2.2.2.2.2" xref="alg4.l14.m1.2.2.2.2.2.2.cmml"><mi id="alg4.l14.m1.2.2.2.2.2.2.2" xref="alg4.l14.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg4.l14.m1.2.2.2.2.2.2.3" xref="alg4.l14.m1.2.2.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg4.l14.m1.2.2.2.2.2.5" xref="alg4.l14.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg4.l14.m1.2b"><apply id="alg4.l14.m1.2.2.cmml" xref="alg4.l14.m1.2.2"><csymbol cd="latexml" id="alg4.l14.m1.2.2.3.cmml" xref="alg4.l14.m1.2.2.3">assign</csymbol><apply id="alg4.l14.m1.2.2.4.cmml" xref="alg4.l14.m1.2.2.4"><csymbol cd="ambiguous" id="alg4.l14.m1.2.2.4.1.cmml" xref="alg4.l14.m1.2.2.4">subscript</csymbol><ci id="alg4.l14.m1.2.2.4.2.cmml" xref="alg4.l14.m1.2.2.4.2">𝐠</ci><ci id="alg4.l14.m1.2.2.4.3.cmml" xref="alg4.l14.m1.2.2.4.3">𝑖</ci></apply><apply id="alg4.l14.m1.2.2.2.cmml" xref="alg4.l14.m1.2.2.2"><times id="alg4.l14.m1.2.2.2.3.cmml" xref="alg4.l14.m1.2.2.2.3"></times><apply id="alg4.l14.m1.2.2.2.4.cmml" xref="alg4.l14.m1.2.2.2.4"><apply id="alg4.l14.m1.2.2.2.4.1.cmml" xref="alg4.l14.m1.2.2.2.4.1"><csymbol cd="ambiguous" id="alg4.l14.m1.2.2.2.4.1.1.cmml" xref="alg4.l14.m1.2.2.2.4.1">subscript</csymbol><ci id="alg4.l14.m1.2.2.2.4.1.2.cmml" xref="alg4.l14.m1.2.2.2.4.1.2">∇</ci><apply id="alg4.l14.m1.2.2.2.4.1.3.cmml" xref="alg4.l14.m1.2.2.2.4.1.3"><csymbol cd="ambiguous" id="alg4.l14.m1.2.2.2.4.1.3.1.cmml" xref="alg4.l14.m1.2.2.2.4.1.3">subscript</csymbol><ci id="alg4.l14.m1.2.2.2.4.1.3.2.cmml" xref="alg4.l14.m1.2.2.2.4.1.3.2">𝜃</ci><ci id="alg4.l14.m1.2.2.2.4.1.3.3.cmml" xref="alg4.l14.m1.2.2.2.4.1.3.3">𝑡</ci></apply></apply><apply id="alg4.l14.m1.2.2.2.4.2.cmml" xref="alg4.l14.m1.2.2.2.4.2"><csymbol cd="ambiguous" id="alg4.l14.m1.2.2.2.4.2.1.cmml" xref="alg4.l14.m1.2.2.2.4.2">subscript</csymbol><ci id="alg4.l14.m1.2.2.2.4.2.2.cmml" xref="alg4.l14.m1.2.2.2.4.2.2">ℓ</ci><ci id="alg4.l14.m1.2.2.2.4.2.3.cmml" xref="alg4.l14.m1.2.2.2.4.2.3">𝑖</ci></apply></apply><interval closure="open" id="alg4.l14.m1.2.2.2.2.3.cmml" xref="alg4.l14.m1.2.2.2.2.2"><apply id="alg4.l14.m1.1.1.1.1.1.1.cmml" xref="alg4.l14.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg4.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg4.l14.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg4.l14.m1.1.1.1.1.1.1.2.cmml" xref="alg4.l14.m1.1.1.1.1.1.1.2">𝑊</ci><ci id="alg4.l14.m1.1.1.1.1.1.1.3.cmml" xref="alg4.l14.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="alg4.l14.m1.2.2.2.2.2.2.cmml" xref="alg4.l14.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="alg4.l14.m1.2.2.2.2.2.2.1.cmml" xref="alg4.l14.m1.2.2.2.2.2.2">subscript</csymbol><ci id="alg4.l14.m1.2.2.2.2.2.2.2.cmml" xref="alg4.l14.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="alg4.l14.m1.2.2.2.2.2.2.3.cmml" xref="alg4.l14.m1.2.2.2.2.2.2.3">𝑡</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg4.l14.m1.2c">\mathbf{g}_{i}:=\nabla_{\theta_{t}}\ell_{i}(W_{i},\theta_{t})</annotation></semantics></math> to server


</div>
</div>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="A3.p5" class="ltx_para">
<p id="A3.p5.1" class="ltx_p"></p>
</div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2202.09846" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2202.09848" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2202.09848">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2202.09848" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2202.09849" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar  7 18:22:52 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
