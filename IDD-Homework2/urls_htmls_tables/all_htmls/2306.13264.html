<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2306.13264] FedSelect: Customized Selection of Parameters for Fine-Tuning during Personalized Federated Learning</title><meta property="og:description" content="Recent advancements in federated learning (FL) seek to increase client-level performance by fine-tuning client parameters on local data or personalizing architectures for the local task. Existing methods for such perso…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="FedSelect: Customized Selection of Parameters for Fine-Tuning during Personalized Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="FedSelect: Customized Selection of Parameters for Fine-Tuning during Personalized Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2306.13264">

<!--Generated on Wed Feb 28 23:56:25 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Machine Learning,  ICML">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">FedSelect: Customized Selection of Parameters for Fine-Tuning during Personalized Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rishub Tamirisa
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">John Won
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chengjun Lu
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ron Arel
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Andy Zhou
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Recent advancements in federated learning (FL) seek to increase client-level performance by fine-tuning client parameters on local data or personalizing architectures for the local task. Existing methods for such personalization either prune a global model or fine-tune a global model on a local client distribution. However, these existing methods either personalize at the expense of retaining important global knowledge, or predetermine network layers for fine-tuning, resulting in suboptimal storage of global knowledge within client models. Enlightened by the lottery ticket hypothesis, we first introduce a hypothesis for finding optimal client subnetworks to locally fine-tune while leaving the rest of the parameters frozen. We then propose a novel FL framework, FedSelect, using this procedure that directly personalizes <span id="id1.id1.1" class="ltx_text ltx_font_italic">both client subnetwork structure and parameters</span>, via the simultaneous discovery of optimal parameters for personalization and the rest of parameters for global aggregation <span id="id1.id1.2" class="ltx_text ltx_font_italic">during training</span>. We show that this method achieves promising results on CIFAR-10.</p>
</div>
<div class="ltx_keywords">Machine Learning, ICML
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite> is a machine learning paradigm which utilizes multiple clients that collaborate to train models under the supervision of a central aggregator, usually referred to as the server. Unlike traditional centralized methods which required the assemblage of data at the central server, FL methods require that only parameter updates are communicated in order to coordinate the FL training process, such that any number of clients can learn from the decentralized data without direct transfer of data. This allows for maintenance of local data privacy while also providing stronger model performances than what participants could have achieved locally. Accordingly, FL has been adapted to many privacy-sensitive tasks, such as medical data classification <cite class="ltx_cite ltx_citemacro_citep">(Sheller et al., <a href="#bib.bib22" title="" class="ltx_ref">2020</a>)</cite>. One of the main challenges in FL is the presence of data heterogeneity, where clients’ local data distributions vary significantly from one another.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">This problem of data heterogeneity is most commonly addressed by <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">personalized federated learning (pFL)</span>, which adapts clients models to local distributions. Most techniques use <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">full model personalization</span>, where clients train both a personalized and a global model. However, this requires twice the computational cost of standard FL <cite class="ltx_cite ltx_citemacro_citep">(Dinh et al., <a href="#bib.bib5" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib13" title="" class="ltx_ref">2021a</a>)</cite> and is impractical in some settings. <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">Partial model personalization</span> alleviates this by splitting clients into shared and personalized parameters <cite class="ltx_cite ltx_citemacro_citep">(Pillutla et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>, where only the shared parameters are updated globally, but typically results clients that overfit to local distributions and reduced performance. Additionally, the personalized architecture needs to be manually designed before training and cannot be adapted to specific settings.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">To address this, we propose <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">FedSelect</span>, where we adapt both both <span id="S1.p3.1.2" class="ltx_text ltx_font_italic">architecture and parameters</span> for each client to its local distribution during training. Our method is based on the intuition that individual client models should choose only a necessary subset of shared parameters to encode global information for their local task, since it may not be optimal to reuse all global information from any full layer(s).
We achieve this through the <span id="S1.p3.1.3" class="ltx_text ltx_font_italic">Lottery Ticket Hypothesis (LTH)</span>, originally proposed to prune models by finding optimal subnetworks, or lottery ticket networks (LTNs) <cite class="ltx_cite ltx_citemacro_citep">(Frankle &amp; Carbin, <a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite>. However, instead of pruning the remaining parameters to zero, we reuse them as personalized parameters. We observe improved performance on CIFAR-10 compared to pruning-based LTH-FL approaches <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib12" title="" class="ltx_ref">2020</a>; Mugunthan et al., <a href="#bib.bib19" title="" class="ltx_ref">2022</a>)</cite> and other personalized FL approaches <cite class="ltx_cite ltx_citemacro_citep">(Liang et al., <a href="#bib.bib15" title="" class="ltx_ref">2020</a>; Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>; Collins et al., <a href="#bib.bib3" title="" class="ltx_ref">2021</a>; Li et al., <a href="#bib.bib13" title="" class="ltx_ref">2021a</a>; Oh et al., <a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite> as well as reduced communication costs compared to partial model personalization.</p>
</div>
<section id="S1.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Related Works.</h5>

<div id="S1.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S1.SS0.SSS0.Px1.p1.2" class="ltx_p">Partial model personalization seeks to improve the performance of client models by altering a subset of their structure or weights to better suit their local tasks. It also addresses the issue of “catastrophic forgetting” <cite class="ltx_cite ltx_citemacro_citep">(McCloskey &amp; Cohen, <a href="#bib.bib17" title="" class="ltx_ref">1989</a>)</cite>, an issue in personalized FL where global information is lost when fine-tuning a client model on its local distribution from a global initialization <cite class="ltx_cite ltx_citemacro_citep">(Kirkpatrick et al., <a href="#bib.bib10" title="" class="ltx_ref">2017</a>; Pillutla et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>. It does this by forcefully preserving a subset of parameters, <math id="S1.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S1.SS0.SSS0.Px1.p1.1.m1.1a"><mi id="S1.SS0.SSS0.Px1.p1.1.m1.1.1" xref="S1.SS0.SSS0.Px1.p1.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S1.SS0.SSS0.Px1.p1.1.m1.1b"><ci id="S1.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S1.SS0.SSS0.Px1.p1.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS0.SSS0.Px1.p1.1.m1.1c">u</annotation></semantics></math>, to serve as a fixed global representation for all clients. However, existing methods introduced for partial model personalization <cite class="ltx_cite ltx_citemacro_citep">(Pillutla et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>; Collins et al., <a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite> require hand-selected partitioning of these shared and local parameters, and choose <math id="S1.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S1.SS0.SSS0.Px1.p1.2.m2.1a"><mi id="S1.SS0.SSS0.Px1.p1.2.m2.1.1" xref="S1.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S1.SS0.SSS0.Px1.p1.2.m2.1b"><ci id="S1.SS0.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S1.SS0.SSS0.Px1.p1.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.SS0.SSS0.Px1.p1.2.m2.1c">u</annotation></semantics></math> as only the input or output layers for their experiments.</p>
</div>
<div id="S1.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S1.SS0.SSS0.Px1.p2.1" class="ltx_p">LotteryFL <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite> learns a shared global model via FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite> and personalizes client models by pruning the global model via the vanilla LTH. Importantly, parameters are pruned to zero according to their magnitude after an iteration of batched stochastic gradient updates. However, due to a low final pruning percentage in LotteryFL, the lottery tickets found for each client share many of the same parameters, and lack sufficient personalization <cite class="ltx_cite ltx_citemacro_citep">(Mugunthan et al., <a href="#bib.bib19" title="" class="ltx_ref">2022</a>)</cite>.</p>
</div>
</section>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Problem Definition</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.13" class="ltx_p">We consider a standard FL setting with <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">N</annotation></semantics></math> clients and one server. The set <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><mi id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><ci id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">C</annotation></semantics></math> denotes the set of client devices, where <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="N=|C|" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.2" xref="S2.SS1.p1.3.m3.1.2.cmml"><mi id="S2.SS1.p1.3.m3.1.2.2" xref="S2.SS1.p1.3.m3.1.2.2.cmml">N</mi><mo id="S2.SS1.p1.3.m3.1.2.1" xref="S2.SS1.p1.3.m3.1.2.1.cmml">=</mo><mrow id="S2.SS1.p1.3.m3.1.2.3.2" xref="S2.SS1.p1.3.m3.1.2.3.1.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.1.2.3.2.1" xref="S2.SS1.p1.3.m3.1.2.3.1.1.cmml">|</mo><mi id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml">C</mi><mo stretchy="false" id="S2.SS1.p1.3.m3.1.2.3.2.2" xref="S2.SS1.p1.3.m3.1.2.3.1.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.2.cmml" xref="S2.SS1.p1.3.m3.1.2"><eq id="S2.SS1.p1.3.m3.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.2.1"></eq><ci id="S2.SS1.p1.3.m3.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.2.2">𝑁</ci><apply id="S2.SS1.p1.3.m3.1.2.3.1.cmml" xref="S2.SS1.p1.3.m3.1.2.3.2"><abs id="S2.SS1.p1.3.m3.1.2.3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.2.3.2.1"></abs><ci id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">N=|C|</annotation></semantics></math>. In particular, <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="c_{k}\in C" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><mrow id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><msub id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2.2" xref="S2.SS1.p1.4.m4.1.1.2.2.cmml">c</mi><mi id="S2.SS1.p1.4.m4.1.1.2.3" xref="S2.SS1.p1.4.m4.1.1.2.3.cmml">k</mi></msub><mo id="S2.SS1.p1.4.m4.1.1.1" xref="S2.SS1.p1.4.m4.1.1.1.cmml">∈</mo><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">C</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><in id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1.1"></in><apply id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.2.1.cmml" xref="S2.SS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2.2">𝑐</ci><ci id="S2.SS1.p1.4.m4.1.1.2.3.cmml" xref="S2.SS1.p1.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">c_{k}\in C</annotation></semantics></math> denotes the <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">k</annotation></semantics></math>th client whose data distribution is given by <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}_{c_{k}}=\{x_{i}^{k},y_{i}^{k}\}_{i=1}^{N_{k}}." display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><mrow id="S2.SS1.p1.6.m6.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.cmml"><mrow id="S2.SS1.p1.6.m6.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.cmml"><msub id="S2.SS1.p1.6.m6.1.1.1.1.4" xref="S2.SS1.p1.6.m6.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.6.m6.1.1.1.1.4.2" xref="S2.SS1.p1.6.m6.1.1.1.1.4.2.cmml">𝒟</mi><msub id="S2.SS1.p1.6.m6.1.1.1.1.4.3" xref="S2.SS1.p1.6.m6.1.1.1.1.4.3.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1.4.3.2" xref="S2.SS1.p1.6.m6.1.1.1.1.4.3.2.cmml">c</mi><mi id="S2.SS1.p1.6.m6.1.1.1.1.4.3.3" xref="S2.SS1.p1.6.m6.1.1.1.1.4.3.3.cmml">k</mi></msub></msub><mo id="S2.SS1.p1.6.m6.1.1.1.1.3" xref="S2.SS1.p1.6.m6.1.1.1.1.3.cmml">=</mo><msubsup id="S2.SS1.p1.6.m6.1.1.1.1.2" xref="S2.SS1.p1.6.m6.1.1.1.1.2.cmml"><mrow id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.3.cmml"><mo stretchy="false" id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.3" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.3.cmml">{</mo><msubsup id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.2" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.4" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.3.cmml">,</mo><msubsup id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.2.2" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.2.2.cmml">y</mi><mi id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.2.3" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.2.3.cmml">i</mi><mi id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.3" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.5" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.3.cmml">}</mo></mrow><mrow id="S2.SS1.p1.6.m6.1.1.1.1.2.2.4" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.2" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.2.cmml">i</mi><mo id="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.1" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.1.cmml">=</mo><mn id="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.3" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.3.cmml">1</mn></mrow><msub id="S2.SS1.p1.6.m6.1.1.1.1.2.4" xref="S2.SS1.p1.6.m6.1.1.1.1.2.4.cmml"><mi id="S2.SS1.p1.6.m6.1.1.1.1.2.4.2" xref="S2.SS1.p1.6.m6.1.1.1.1.2.4.2.cmml">N</mi><mi id="S2.SS1.p1.6.m6.1.1.1.1.2.4.3" xref="S2.SS1.p1.6.m6.1.1.1.1.2.4.3.cmml">k</mi></msub></msubsup></mrow><mo lspace="0em" id="S2.SS1.p1.6.m6.1.1.1.2" xref="S2.SS1.p1.6.m6.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><apply id="S2.SS1.p1.6.m6.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1"><eq id="S2.SS1.p1.6.m6.1.1.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.3"></eq><apply id="S2.SS1.p1.6.m6.1.1.1.1.4.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.4.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.4">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.1.1.4.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.4.2">𝒟</ci><apply id="S2.SS1.p1.6.m6.1.1.1.1.4.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.4.3"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.4.3.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.4.3">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.1.1.4.3.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.4.3.2">𝑐</ci><ci id="S2.SS1.p1.6.m6.1.1.1.1.4.3.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.4.3.3">𝑘</ci></apply></apply><apply id="S2.SS1.p1.6.m6.1.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2">superscript</csymbol><apply id="S2.SS1.p1.6.m6.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2">subscript</csymbol><set id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2"><apply id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.2.2">𝑦</ci><ci id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.2.2.2.3">𝑘</ci></apply></set><apply id="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.4"><eq id="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.1"></eq><ci id="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.2">𝑖</ci><cn type="integer" id="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.2.4.3">1</cn></apply></apply><apply id="S2.SS1.p1.6.m6.1.1.1.1.2.4.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.4"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m6.1.1.1.1.2.4.1.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.4">subscript</csymbol><ci id="S2.SS1.p1.6.m6.1.1.1.1.2.4.2.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.4.2">𝑁</ci><ci id="S2.SS1.p1.6.m6.1.1.1.1.2.4.3.cmml" xref="S2.SS1.p1.6.m6.1.1.1.1.2.4.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\mathcal{D}_{c_{k}}=\{x_{i}^{k},y_{i}^{k}\}_{i=1}^{N_{k}}.</annotation></semantics></math> Let <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mi id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><ci id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">s</annotation></semantics></math> be the number of classes assigned to the clients <math id="S2.SS1.p1.8.m8.3" class="ltx_Math" alttext="c_{1},\dots,c_{N}" display="inline"><semantics id="S2.SS1.p1.8.m8.3a"><mrow id="S2.SS1.p1.8.m8.3.3.2" xref="S2.SS1.p1.8.m8.3.3.3.cmml"><msub id="S2.SS1.p1.8.m8.2.2.1.1" xref="S2.SS1.p1.8.m8.2.2.1.1.cmml"><mi id="S2.SS1.p1.8.m8.2.2.1.1.2" xref="S2.SS1.p1.8.m8.2.2.1.1.2.cmml">c</mi><mn id="S2.SS1.p1.8.m8.2.2.1.1.3" xref="S2.SS1.p1.8.m8.2.2.1.1.3.cmml">1</mn></msub><mo id="S2.SS1.p1.8.m8.3.3.2.3" xref="S2.SS1.p1.8.m8.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">…</mi><mo id="S2.SS1.p1.8.m8.3.3.2.4" xref="S2.SS1.p1.8.m8.3.3.3.cmml">,</mo><msub id="S2.SS1.p1.8.m8.3.3.2.2" xref="S2.SS1.p1.8.m8.3.3.2.2.cmml"><mi id="S2.SS1.p1.8.m8.3.3.2.2.2" xref="S2.SS1.p1.8.m8.3.3.2.2.2.cmml">c</mi><mi id="S2.SS1.p1.8.m8.3.3.2.2.3" xref="S2.SS1.p1.8.m8.3.3.2.2.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.3b"><list id="S2.SS1.p1.8.m8.3.3.3.cmml" xref="S2.SS1.p1.8.m8.3.3.2"><apply id="S2.SS1.p1.8.m8.2.2.1.1.cmml" xref="S2.SS1.p1.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.2.2.1.1.1.cmml" xref="S2.SS1.p1.8.m8.2.2.1.1">subscript</csymbol><ci id="S2.SS1.p1.8.m8.2.2.1.1.2.cmml" xref="S2.SS1.p1.8.m8.2.2.1.1.2">𝑐</ci><cn type="integer" id="S2.SS1.p1.8.m8.2.2.1.1.3.cmml" xref="S2.SS1.p1.8.m8.2.2.1.1.3">1</cn></apply><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">…</ci><apply id="S2.SS1.p1.8.m8.3.3.2.2.cmml" xref="S2.SS1.p1.8.m8.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p1.8.m8.3.3.2.2.1.cmml" xref="S2.SS1.p1.8.m8.3.3.2.2">subscript</csymbol><ci id="S2.SS1.p1.8.m8.3.3.2.2.2.cmml" xref="S2.SS1.p1.8.m8.3.3.2.2.2">𝑐</ci><ci id="S2.SS1.p1.8.m8.3.3.2.2.3.cmml" xref="S2.SS1.p1.8.m8.3.3.2.2.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.3c">c_{1},\dots,c_{N}</annotation></semantics></math>. Next, let <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">\theta</annotation></semantics></math> denote the vector of parameters defined by the client model architecture. Then the loss of the <math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><mi id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><ci id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">k</annotation></semantics></math>th client model for each data point <math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><mi id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><ci id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">x</annotation></semantics></math> is <math id="S2.SS1.p1.12.m12.2" class="ltx_Math" alttext="f_{k}(\theta_{k},x)" display="inline"><semantics id="S2.SS1.p1.12.m12.2a"><mrow id="S2.SS1.p1.12.m12.2.2" xref="S2.SS1.p1.12.m12.2.2.cmml"><msub id="S2.SS1.p1.12.m12.2.2.3" xref="S2.SS1.p1.12.m12.2.2.3.cmml"><mi id="S2.SS1.p1.12.m12.2.2.3.2" xref="S2.SS1.p1.12.m12.2.2.3.2.cmml">f</mi><mi id="S2.SS1.p1.12.m12.2.2.3.3" xref="S2.SS1.p1.12.m12.2.2.3.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p1.12.m12.2.2.2" xref="S2.SS1.p1.12.m12.2.2.2.cmml">​</mo><mrow id="S2.SS1.p1.12.m12.2.2.1.1" xref="S2.SS1.p1.12.m12.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS1.p1.12.m12.2.2.1.1.2" xref="S2.SS1.p1.12.m12.2.2.1.2.cmml">(</mo><msub id="S2.SS1.p1.12.m12.2.2.1.1.1" xref="S2.SS1.p1.12.m12.2.2.1.1.1.cmml"><mi id="S2.SS1.p1.12.m12.2.2.1.1.1.2" xref="S2.SS1.p1.12.m12.2.2.1.1.1.2.cmml">θ</mi><mi id="S2.SS1.p1.12.m12.2.2.1.1.1.3" xref="S2.SS1.p1.12.m12.2.2.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS1.p1.12.m12.2.2.1.1.3" xref="S2.SS1.p1.12.m12.2.2.1.2.cmml">,</mo><mi id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml">x</mi><mo stretchy="false" id="S2.SS1.p1.12.m12.2.2.1.1.4" xref="S2.SS1.p1.12.m12.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.2b"><apply id="S2.SS1.p1.12.m12.2.2.cmml" xref="S2.SS1.p1.12.m12.2.2"><times id="S2.SS1.p1.12.m12.2.2.2.cmml" xref="S2.SS1.p1.12.m12.2.2.2"></times><apply id="S2.SS1.p1.12.m12.2.2.3.cmml" xref="S2.SS1.p1.12.m12.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.2.2.3.1.cmml" xref="S2.SS1.p1.12.m12.2.2.3">subscript</csymbol><ci id="S2.SS1.p1.12.m12.2.2.3.2.cmml" xref="S2.SS1.p1.12.m12.2.2.3.2">𝑓</ci><ci id="S2.SS1.p1.12.m12.2.2.3.3.cmml" xref="S2.SS1.p1.12.m12.2.2.3.3">𝑘</ci></apply><interval closure="open" id="S2.SS1.p1.12.m12.2.2.1.2.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1"><apply id="S2.SS1.p1.12.m12.2.2.1.1.1.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.12.m12.2.2.1.1.1.1.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p1.12.m12.2.2.1.1.1.2.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1.1.2">𝜃</ci><ci id="S2.SS1.p1.12.m12.2.2.1.1.1.3.cmml" xref="S2.SS1.p1.12.m12.2.2.1.1.1.3">𝑘</ci></apply><ci id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.2c">f_{k}(\theta_{k},x)</annotation></semantics></math>, where <math id="S2.SS1.p1.13.m13.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS1.p1.13.m13.1a"><mi id="S2.SS1.p1.13.m13.1.1" xref="S2.SS1.p1.13.m13.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.1b"><ci id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.1c">\theta</annotation></semantics></math> denotes the model parameters.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">While the classical FL objective shown in Equation <a href="#S2.E1" title="Equation 1 ‣ 2.1 Problem Definition ‣ 2 Methods ‣ FedSelect: Customized Selection of Parameters for Fine-Tuning during Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>  <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite> seeks to minimize loss across all clients with respect to a global parameter vector <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\theta_{G}" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><msub id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">θ</mi><mi id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">𝜃</ci><ci id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\theta_{G}</annotation></semantics></math>, we focus on partial model personalization.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.2" class="ltx_Math" alttext="\min_{\theta_{G}}\frac{1}{N}\sum_{k=1}^{N}\sum_{i=1}^{N_{k}}f_{k}(\theta_{G},x_{i}^{k})" display="block"><semantics id="S2.E1.m1.2a"><mrow id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mrow id="S2.E1.m1.2.2.4" xref="S2.E1.m1.2.2.4.cmml"><munder id="S2.E1.m1.2.2.4.1" xref="S2.E1.m1.2.2.4.1.cmml"><mi id="S2.E1.m1.2.2.4.1.2" xref="S2.E1.m1.2.2.4.1.2.cmml">min</mi><msub id="S2.E1.m1.2.2.4.1.3" xref="S2.E1.m1.2.2.4.1.3.cmml"><mi id="S2.E1.m1.2.2.4.1.3.2" xref="S2.E1.m1.2.2.4.1.3.2.cmml">θ</mi><mi id="S2.E1.m1.2.2.4.1.3.3" xref="S2.E1.m1.2.2.4.1.3.3.cmml">G</mi></msub></munder><mo lspace="0.167em" id="S2.E1.m1.2.2.4a" xref="S2.E1.m1.2.2.4.cmml">⁡</mo><mfrac id="S2.E1.m1.2.2.4.2" xref="S2.E1.m1.2.2.4.2.cmml"><mn id="S2.E1.m1.2.2.4.2.2" xref="S2.E1.m1.2.2.4.2.2.cmml">1</mn><mi id="S2.E1.m1.2.2.4.2.3" xref="S2.E1.m1.2.2.4.2.3.cmml">N</mi></mfrac></mrow><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.3" xref="S2.E1.m1.2.2.3.cmml">​</mo><mrow id="S2.E1.m1.2.2.2" xref="S2.E1.m1.2.2.2.cmml"><munderover id="S2.E1.m1.2.2.2.3" xref="S2.E1.m1.2.2.2.3.cmml"><mo movablelimits="false" rspace="0em" id="S2.E1.m1.2.2.2.3.2.2" xref="S2.E1.m1.2.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E1.m1.2.2.2.3.2.3" xref="S2.E1.m1.2.2.2.3.2.3.cmml"><mi id="S2.E1.m1.2.2.2.3.2.3.2" xref="S2.E1.m1.2.2.2.3.2.3.2.cmml">k</mi><mo id="S2.E1.m1.2.2.2.3.2.3.1" xref="S2.E1.m1.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E1.m1.2.2.2.3.2.3.3" xref="S2.E1.m1.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E1.m1.2.2.2.3.3" xref="S2.E1.m1.2.2.2.3.3.cmml">N</mi></munderover><mrow id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.2.cmml"><munderover id="S2.E1.m1.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.3.cmml"><mo movablelimits="false" id="S2.E1.m1.2.2.2.2.3.2.2" xref="S2.E1.m1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E1.m1.2.2.2.2.3.2.3" xref="S2.E1.m1.2.2.2.2.3.2.3.cmml"><mi id="S2.E1.m1.2.2.2.2.3.2.3.2" xref="S2.E1.m1.2.2.2.2.3.2.3.2.cmml">i</mi><mo id="S2.E1.m1.2.2.2.2.3.2.3.1" xref="S2.E1.m1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E1.m1.2.2.2.2.3.2.3.3" xref="S2.E1.m1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S2.E1.m1.2.2.2.2.3.3" xref="S2.E1.m1.2.2.2.2.3.3.cmml"><mi id="S2.E1.m1.2.2.2.2.3.3.2" xref="S2.E1.m1.2.2.2.2.3.3.2.cmml">N</mi><mi id="S2.E1.m1.2.2.2.2.3.3.3" xref="S2.E1.m1.2.2.2.2.3.3.3.cmml">k</mi></msub></munderover><mrow id="S2.E1.m1.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.cmml"><msub id="S2.E1.m1.2.2.2.2.2.4" xref="S2.E1.m1.2.2.2.2.2.4.cmml"><mi id="S2.E1.m1.2.2.2.2.2.4.2" xref="S2.E1.m1.2.2.2.2.2.4.2.cmml">f</mi><mi id="S2.E1.m1.2.2.2.2.2.4.3" xref="S2.E1.m1.2.2.2.2.2.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.3.cmml">​</mo><mrow id="S2.E1.m1.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.E1.m1.2.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.2.3.cmml">(</mo><msub id="S2.E1.m1.1.1.1.1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.2" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.E1.m1.1.1.1.1.1.1.1.1.3" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml">G</mi></msub><mo id="S2.E1.m1.2.2.2.2.2.2.2.4" xref="S2.E1.m1.2.2.2.2.2.2.3.cmml">,</mo><msubsup id="S2.E1.m1.2.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S2.E1.m1.2.2.2.2.2.2.2.2.2.2" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2.2.cmml">x</mi><mi id="S2.E1.m1.2.2.2.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="S2.E1.m1.2.2.2.2.2.2.2.2.3" xref="S2.E1.m1.2.2.2.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S2.E1.m1.2.2.2.2.2.2.2.5" xref="S2.E1.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.2b"><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><times id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2.3"></times><apply id="S2.E1.m1.2.2.4.cmml" xref="S2.E1.m1.2.2.4"><apply id="S2.E1.m1.2.2.4.1.cmml" xref="S2.E1.m1.2.2.4.1"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.4.1.1.cmml" xref="S2.E1.m1.2.2.4.1">subscript</csymbol><min id="S2.E1.m1.2.2.4.1.2.cmml" xref="S2.E1.m1.2.2.4.1.2"></min><apply id="S2.E1.m1.2.2.4.1.3.cmml" xref="S2.E1.m1.2.2.4.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.4.1.3.1.cmml" xref="S2.E1.m1.2.2.4.1.3">subscript</csymbol><ci id="S2.E1.m1.2.2.4.1.3.2.cmml" xref="S2.E1.m1.2.2.4.1.3.2">𝜃</ci><ci id="S2.E1.m1.2.2.4.1.3.3.cmml" xref="S2.E1.m1.2.2.4.1.3.3">𝐺</ci></apply></apply><apply id="S2.E1.m1.2.2.4.2.cmml" xref="S2.E1.m1.2.2.4.2"><divide id="S2.E1.m1.2.2.4.2.1.cmml" xref="S2.E1.m1.2.2.4.2"></divide><cn type="integer" id="S2.E1.m1.2.2.4.2.2.cmml" xref="S2.E1.m1.2.2.4.2.2">1</cn><ci id="S2.E1.m1.2.2.4.2.3.cmml" xref="S2.E1.m1.2.2.4.2.3">𝑁</ci></apply></apply><apply id="S2.E1.m1.2.2.2.cmml" xref="S2.E1.m1.2.2.2"><apply id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.3">superscript</csymbol><apply id="S2.E1.m1.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.3.2.1.cmml" xref="S2.E1.m1.2.2.2.3">subscript</csymbol><sum id="S2.E1.m1.2.2.2.3.2.2.cmml" xref="S2.E1.m1.2.2.2.3.2.2"></sum><apply id="S2.E1.m1.2.2.2.3.2.3.cmml" xref="S2.E1.m1.2.2.2.3.2.3"><eq id="S2.E1.m1.2.2.2.3.2.3.1.cmml" xref="S2.E1.m1.2.2.2.3.2.3.1"></eq><ci id="S2.E1.m1.2.2.2.3.2.3.2.cmml" xref="S2.E1.m1.2.2.2.3.2.3.2">𝑘</ci><cn type="integer" id="S2.E1.m1.2.2.2.3.2.3.3.cmml" xref="S2.E1.m1.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E1.m1.2.2.2.3.3.cmml" xref="S2.E1.m1.2.2.2.3.3">𝑁</ci></apply><apply id="S2.E1.m1.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2"><apply id="S2.E1.m1.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.2.3">superscript</csymbol><apply id="S2.E1.m1.2.2.2.2.3.2.cmml" xref="S2.E1.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.3.2.1.cmml" xref="S2.E1.m1.2.2.2.2.3">subscript</csymbol><sum id="S2.E1.m1.2.2.2.2.3.2.2.cmml" xref="S2.E1.m1.2.2.2.2.3.2.2"></sum><apply id="S2.E1.m1.2.2.2.2.3.2.3.cmml" xref="S2.E1.m1.2.2.2.2.3.2.3"><eq id="S2.E1.m1.2.2.2.2.3.2.3.1.cmml" xref="S2.E1.m1.2.2.2.2.3.2.3.1"></eq><ci id="S2.E1.m1.2.2.2.2.3.2.3.2.cmml" xref="S2.E1.m1.2.2.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.2.2.2.2.3.2.3.3.cmml" xref="S2.E1.m1.2.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S2.E1.m1.2.2.2.2.3.3.cmml" xref="S2.E1.m1.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.3.3.1.cmml" xref="S2.E1.m1.2.2.2.2.3.3">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.3.3.2.cmml" xref="S2.E1.m1.2.2.2.2.3.3.2">𝑁</ci><ci id="S2.E1.m1.2.2.2.2.3.3.3.cmml" xref="S2.E1.m1.2.2.2.2.3.3.3">𝑘</ci></apply></apply><apply id="S2.E1.m1.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2"><times id="S2.E1.m1.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.3"></times><apply id="S2.E1.m1.2.2.2.2.2.4.cmml" xref="S2.E1.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.4.1.cmml" xref="S2.E1.m1.2.2.2.2.2.4">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.4.2.cmml" xref="S2.E1.m1.2.2.2.2.2.4.2">𝑓</ci><ci id="S2.E1.m1.2.2.2.2.2.4.3.cmml" xref="S2.E1.m1.2.2.2.2.2.4.3">𝑘</ci></apply><interval closure="open" id="S2.E1.m1.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2"><apply id="S2.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S2.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.1.1.1.1.1.1.1.1.3">𝐺</ci></apply><apply id="S2.E1.m1.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E1.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E1.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2.2">𝑥</ci><ci id="S2.E1.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.E1.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.2c">\min_{\theta_{G}}\frac{1}{N}\sum_{k=1}^{N}\sum_{i=1}^{N_{k}}f_{k}(\theta_{G},x_{i}^{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.2" class="ltx_p">Partial model personalization refers to the procedure in which model parameters are partitioned into shared and local parameters, denoted <math id="S2.SS1.p4.1.m1.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S2.SS1.p4.1.m1.1a"><mi id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">u</annotation></semantics></math> and <math id="S2.SS1.p4.2.m2.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S2.SS1.p4.2.m2.1a"><mi id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><ci id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">v</annotation></semantics></math>, for averaging and local fine-tuning.</p>
</div>
<div id="S2.SS1.p5" class="ltx_para">
<p id="S2.SS1.p5.3" class="ltx_p">We consequently define <math id="S2.SS1.p5.1.m1.2" class="ltx_Math" alttext="\theta_{k}=(u,v_{k})" display="inline"><semantics id="S2.SS1.p5.1.m1.2a"><mrow id="S2.SS1.p5.1.m1.2.2" xref="S2.SS1.p5.1.m1.2.2.cmml"><msub id="S2.SS1.p5.1.m1.2.2.3" xref="S2.SS1.p5.1.m1.2.2.3.cmml"><mi id="S2.SS1.p5.1.m1.2.2.3.2" xref="S2.SS1.p5.1.m1.2.2.3.2.cmml">θ</mi><mi id="S2.SS1.p5.1.m1.2.2.3.3" xref="S2.SS1.p5.1.m1.2.2.3.3.cmml">k</mi></msub><mo id="S2.SS1.p5.1.m1.2.2.2" xref="S2.SS1.p5.1.m1.2.2.2.cmml">=</mo><mrow id="S2.SS1.p5.1.m1.2.2.1.1" xref="S2.SS1.p5.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S2.SS1.p5.1.m1.2.2.1.1.2" xref="S2.SS1.p5.1.m1.2.2.1.2.cmml">(</mo><mi id="S2.SS1.p5.1.m1.1.1" xref="S2.SS1.p5.1.m1.1.1.cmml">u</mi><mo id="S2.SS1.p5.1.m1.2.2.1.1.3" xref="S2.SS1.p5.1.m1.2.2.1.2.cmml">,</mo><msub id="S2.SS1.p5.1.m1.2.2.1.1.1" xref="S2.SS1.p5.1.m1.2.2.1.1.1.cmml"><mi id="S2.SS1.p5.1.m1.2.2.1.1.1.2" xref="S2.SS1.p5.1.m1.2.2.1.1.1.2.cmml">v</mi><mi id="S2.SS1.p5.1.m1.2.2.1.1.1.3" xref="S2.SS1.p5.1.m1.2.2.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.SS1.p5.1.m1.2.2.1.1.4" xref="S2.SS1.p5.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.1.m1.2b"><apply id="S2.SS1.p5.1.m1.2.2.cmml" xref="S2.SS1.p5.1.m1.2.2"><eq id="S2.SS1.p5.1.m1.2.2.2.cmml" xref="S2.SS1.p5.1.m1.2.2.2"></eq><apply id="S2.SS1.p5.1.m1.2.2.3.cmml" xref="S2.SS1.p5.1.m1.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p5.1.m1.2.2.3.1.cmml" xref="S2.SS1.p5.1.m1.2.2.3">subscript</csymbol><ci id="S2.SS1.p5.1.m1.2.2.3.2.cmml" xref="S2.SS1.p5.1.m1.2.2.3.2">𝜃</ci><ci id="S2.SS1.p5.1.m1.2.2.3.3.cmml" xref="S2.SS1.p5.1.m1.2.2.3.3">𝑘</ci></apply><interval closure="open" id="S2.SS1.p5.1.m1.2.2.1.2.cmml" xref="S2.SS1.p5.1.m1.2.2.1.1"><ci id="S2.SS1.p5.1.m1.1.1.cmml" xref="S2.SS1.p5.1.m1.1.1">𝑢</ci><apply id="S2.SS1.p5.1.m1.2.2.1.1.1.cmml" xref="S2.SS1.p5.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p5.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p5.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS1.p5.1.m1.2.2.1.1.1.2">𝑣</ci><ci id="S2.SS1.p5.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS1.p5.1.m1.2.2.1.1.1.3">𝑘</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.1.m1.2c">\theta_{k}=(u,v_{k})</annotation></semantics></math>, where <math id="S2.SS1.p5.2.m2.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S2.SS1.p5.2.m2.1a"><mi id="S2.SS1.p5.2.m2.1.1" xref="S2.SS1.p5.2.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.2.m2.1b"><ci id="S2.SS1.p5.2.m2.1.1.cmml" xref="S2.SS1.p5.2.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.2.m2.1c">u</annotation></semantics></math> denotes a set of shared global parameters, and <math id="S2.SS1.p5.3.m3.1" class="ltx_Math" alttext="v_{k}" display="inline"><semantics id="S2.SS1.p5.3.m3.1a"><msub id="S2.SS1.p5.3.m3.1.1" xref="S2.SS1.p5.3.m3.1.1.cmml"><mi id="S2.SS1.p5.3.m3.1.1.2" xref="S2.SS1.p5.3.m3.1.1.2.cmml">v</mi><mi id="S2.SS1.p5.3.m3.1.1.3" xref="S2.SS1.p5.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.3.m3.1b"><apply id="S2.SS1.p5.3.m3.1.1.cmml" xref="S2.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.3.m3.1.1.1.cmml" xref="S2.SS1.p5.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p5.3.m3.1.1.2.cmml" xref="S2.SS1.p5.3.m3.1.1.2">𝑣</ci><ci id="S2.SS1.p5.3.m3.1.1.3.cmml" xref="S2.SS1.p5.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.3.m3.1c">v_{k}</annotation></semantics></math> the personalized client parameters. The pFL objective following this formulation is given by:</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.5" class="ltx_Math" alttext="\min_{u,\{v_{k}\}_{k=1}^{N}}\sum_{k=1}^{N}\frac{\alpha_{k}}{N_{k}}\sum_{i=1}^{N_{k}}f_{k}((u,v_{k}),x_{i}^{k})" display="block"><semantics id="S2.E2.m1.5a"><mrow id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml"><munder id="S2.E2.m1.5.5.4" xref="S2.E2.m1.5.5.4.cmml"><mi id="S2.E2.m1.5.5.4.2" xref="S2.E2.m1.5.5.4.2.cmml">min</mi><mrow id="S2.E2.m1.2.2.2.2" xref="S2.E2.m1.2.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">u</mi><mo id="S2.E2.m1.2.2.2.2.2" xref="S2.E2.m1.2.2.2.3.cmml">,</mo><msubsup id="S2.E2.m1.2.2.2.2.1" xref="S2.E2.m1.2.2.2.2.1.cmml"><mrow id="S2.E2.m1.2.2.2.2.1.1.1.1" xref="S2.E2.m1.2.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.2.2.1.1.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.1.2.cmml">{</mo><msub id="S2.E2.m1.2.2.2.2.1.1.1.1.1" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.1.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.2.cmml">v</mi><mi id="S2.E2.m1.2.2.2.2.1.1.1.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E2.m1.2.2.2.2.1.1.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.E2.m1.2.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.3.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.3.2" xref="S2.E2.m1.2.2.2.2.1.1.3.2.cmml">k</mi><mo id="S2.E2.m1.2.2.2.2.1.1.3.1" xref="S2.E2.m1.2.2.2.2.1.1.3.1.cmml">=</mo><mn id="S2.E2.m1.2.2.2.2.1.1.3.3" xref="S2.E2.m1.2.2.2.2.1.1.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.2.2.2.2.1.3" xref="S2.E2.m1.2.2.2.2.1.3.cmml">N</mi></msubsup></mrow></munder><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.3" xref="S2.E2.m1.5.5.3.cmml">​</mo><mrow id="S2.E2.m1.5.5.2" xref="S2.E2.m1.5.5.2.cmml"><munderover id="S2.E2.m1.5.5.2.3" xref="S2.E2.m1.5.5.2.3.cmml"><mo movablelimits="false" id="S2.E2.m1.5.5.2.3.2.2" xref="S2.E2.m1.5.5.2.3.2.2.cmml">∑</mo><mrow id="S2.E2.m1.5.5.2.3.2.3" xref="S2.E2.m1.5.5.2.3.2.3.cmml"><mi id="S2.E2.m1.5.5.2.3.2.3.2" xref="S2.E2.m1.5.5.2.3.2.3.2.cmml">k</mi><mo id="S2.E2.m1.5.5.2.3.2.3.1" xref="S2.E2.m1.5.5.2.3.2.3.1.cmml">=</mo><mn id="S2.E2.m1.5.5.2.3.2.3.3" xref="S2.E2.m1.5.5.2.3.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.5.5.2.3.3" xref="S2.E2.m1.5.5.2.3.3.cmml">N</mi></munderover><mrow id="S2.E2.m1.5.5.2.2" xref="S2.E2.m1.5.5.2.2.cmml"><mfrac id="S2.E2.m1.5.5.2.2.4" xref="S2.E2.m1.5.5.2.2.4.cmml"><msub id="S2.E2.m1.5.5.2.2.4.2" xref="S2.E2.m1.5.5.2.2.4.2.cmml"><mi id="S2.E2.m1.5.5.2.2.4.2.2" xref="S2.E2.m1.5.5.2.2.4.2.2.cmml">α</mi><mi id="S2.E2.m1.5.5.2.2.4.2.3" xref="S2.E2.m1.5.5.2.2.4.2.3.cmml">k</mi></msub><msub id="S2.E2.m1.5.5.2.2.4.3" xref="S2.E2.m1.5.5.2.2.4.3.cmml"><mi id="S2.E2.m1.5.5.2.2.4.3.2" xref="S2.E2.m1.5.5.2.2.4.3.2.cmml">N</mi><mi id="S2.E2.m1.5.5.2.2.4.3.3" xref="S2.E2.m1.5.5.2.2.4.3.3.cmml">k</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.2.2.3" xref="S2.E2.m1.5.5.2.2.3.cmml">​</mo><mrow id="S2.E2.m1.5.5.2.2.2" xref="S2.E2.m1.5.5.2.2.2.cmml"><munderover id="S2.E2.m1.5.5.2.2.2.3" xref="S2.E2.m1.5.5.2.2.2.3.cmml"><mo movablelimits="false" id="S2.E2.m1.5.5.2.2.2.3.2.2" xref="S2.E2.m1.5.5.2.2.2.3.2.2.cmml">∑</mo><mrow id="S2.E2.m1.5.5.2.2.2.3.2.3" xref="S2.E2.m1.5.5.2.2.2.3.2.3.cmml"><mi id="S2.E2.m1.5.5.2.2.2.3.2.3.2" xref="S2.E2.m1.5.5.2.2.2.3.2.3.2.cmml">i</mi><mo id="S2.E2.m1.5.5.2.2.2.3.2.3.1" xref="S2.E2.m1.5.5.2.2.2.3.2.3.1.cmml">=</mo><mn id="S2.E2.m1.5.5.2.2.2.3.2.3.3" xref="S2.E2.m1.5.5.2.2.2.3.2.3.3.cmml">1</mn></mrow><msub id="S2.E2.m1.5.5.2.2.2.3.3" xref="S2.E2.m1.5.5.2.2.2.3.3.cmml"><mi id="S2.E2.m1.5.5.2.2.2.3.3.2" xref="S2.E2.m1.5.5.2.2.2.3.3.2.cmml">N</mi><mi id="S2.E2.m1.5.5.2.2.2.3.3.3" xref="S2.E2.m1.5.5.2.2.2.3.3.3.cmml">k</mi></msub></munderover><mrow id="S2.E2.m1.5.5.2.2.2.2" xref="S2.E2.m1.5.5.2.2.2.2.cmml"><msub id="S2.E2.m1.5.5.2.2.2.2.4" xref="S2.E2.m1.5.5.2.2.2.2.4.cmml"><mi id="S2.E2.m1.5.5.2.2.2.2.4.2" xref="S2.E2.m1.5.5.2.2.2.2.4.2.cmml">f</mi><mi id="S2.E2.m1.5.5.2.2.2.2.4.3" xref="S2.E2.m1.5.5.2.2.2.2.4.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.2.2.2.2.3" xref="S2.E2.m1.5.5.2.2.2.2.3.cmml">​</mo><mrow id="S2.E2.m1.5.5.2.2.2.2.2.2" xref="S2.E2.m1.5.5.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S2.E2.m1.5.5.2.2.2.2.2.2.3" xref="S2.E2.m1.5.5.2.2.2.2.2.3.cmml">(</mo><mrow id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">u</mi><mo id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">v</mi><mi id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.4" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml">)</mo></mrow><mo id="S2.E2.m1.5.5.2.2.2.2.2.2.4" xref="S2.E2.m1.5.5.2.2.2.2.2.3.cmml">,</mo><msubsup id="S2.E2.m1.5.5.2.2.2.2.2.2.2" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2.cmml"><mi id="S2.E2.m1.5.5.2.2.2.2.2.2.2.2.2" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2.2.2.cmml">x</mi><mi id="S2.E2.m1.5.5.2.2.2.2.2.2.2.2.3" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2.2.3.cmml">i</mi><mi id="S2.E2.m1.5.5.2.2.2.2.2.2.2.3" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S2.E2.m1.5.5.2.2.2.2.2.2.5" xref="S2.E2.m1.5.5.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.5b"><apply id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5"><times id="S2.E2.m1.5.5.3.cmml" xref="S2.E2.m1.5.5.3"></times><apply id="S2.E2.m1.5.5.4.cmml" xref="S2.E2.m1.5.5.4"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.4.1.cmml" xref="S2.E2.m1.5.5.4">subscript</csymbol><min id="S2.E2.m1.5.5.4.2.cmml" xref="S2.E2.m1.5.5.4.2"></min><list id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.2"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑢</ci><apply id="S2.E2.m1.2.2.2.2.1.cmml" xref="S2.E2.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1">superscript</csymbol><apply id="S2.E2.m1.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1">subscript</csymbol><set id="S2.E2.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1"><apply id="S2.E2.m1.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.2">𝑣</ci><ci id="S2.E2.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.1.1.1.3">𝑘</ci></apply></set><apply id="S2.E2.m1.2.2.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3"><eq id="S2.E2.m1.2.2.2.2.1.1.3.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.1"></eq><ci id="S2.E2.m1.2.2.2.2.1.1.3.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.2">𝑘</ci><cn type="integer" id="S2.E2.m1.2.2.2.2.1.1.3.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3.3">1</cn></apply></apply><ci id="S2.E2.m1.2.2.2.2.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.3">𝑁</ci></apply></list></apply><apply id="S2.E2.m1.5.5.2.cmml" xref="S2.E2.m1.5.5.2"><apply id="S2.E2.m1.5.5.2.3.cmml" xref="S2.E2.m1.5.5.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.3.1.cmml" xref="S2.E2.m1.5.5.2.3">superscript</csymbol><apply id="S2.E2.m1.5.5.2.3.2.cmml" xref="S2.E2.m1.5.5.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.3.2.1.cmml" xref="S2.E2.m1.5.5.2.3">subscript</csymbol><sum id="S2.E2.m1.5.5.2.3.2.2.cmml" xref="S2.E2.m1.5.5.2.3.2.2"></sum><apply id="S2.E2.m1.5.5.2.3.2.3.cmml" xref="S2.E2.m1.5.5.2.3.2.3"><eq id="S2.E2.m1.5.5.2.3.2.3.1.cmml" xref="S2.E2.m1.5.5.2.3.2.3.1"></eq><ci id="S2.E2.m1.5.5.2.3.2.3.2.cmml" xref="S2.E2.m1.5.5.2.3.2.3.2">𝑘</ci><cn type="integer" id="S2.E2.m1.5.5.2.3.2.3.3.cmml" xref="S2.E2.m1.5.5.2.3.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.5.5.2.3.3.cmml" xref="S2.E2.m1.5.5.2.3.3">𝑁</ci></apply><apply id="S2.E2.m1.5.5.2.2.cmml" xref="S2.E2.m1.5.5.2.2"><times id="S2.E2.m1.5.5.2.2.3.cmml" xref="S2.E2.m1.5.5.2.2.3"></times><apply id="S2.E2.m1.5.5.2.2.4.cmml" xref="S2.E2.m1.5.5.2.2.4"><divide id="S2.E2.m1.5.5.2.2.4.1.cmml" xref="S2.E2.m1.5.5.2.2.4"></divide><apply id="S2.E2.m1.5.5.2.2.4.2.cmml" xref="S2.E2.m1.5.5.2.2.4.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.2.4.2.1.cmml" xref="S2.E2.m1.5.5.2.2.4.2">subscript</csymbol><ci id="S2.E2.m1.5.5.2.2.4.2.2.cmml" xref="S2.E2.m1.5.5.2.2.4.2.2">𝛼</ci><ci id="S2.E2.m1.5.5.2.2.4.2.3.cmml" xref="S2.E2.m1.5.5.2.2.4.2.3">𝑘</ci></apply><apply id="S2.E2.m1.5.5.2.2.4.3.cmml" xref="S2.E2.m1.5.5.2.2.4.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.2.4.3.1.cmml" xref="S2.E2.m1.5.5.2.2.4.3">subscript</csymbol><ci id="S2.E2.m1.5.5.2.2.4.3.2.cmml" xref="S2.E2.m1.5.5.2.2.4.3.2">𝑁</ci><ci id="S2.E2.m1.5.5.2.2.4.3.3.cmml" xref="S2.E2.m1.5.5.2.2.4.3.3">𝑘</ci></apply></apply><apply id="S2.E2.m1.5.5.2.2.2.cmml" xref="S2.E2.m1.5.5.2.2.2"><apply id="S2.E2.m1.5.5.2.2.2.3.cmml" xref="S2.E2.m1.5.5.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.2.2.3.1.cmml" xref="S2.E2.m1.5.5.2.2.2.3">superscript</csymbol><apply id="S2.E2.m1.5.5.2.2.2.3.2.cmml" xref="S2.E2.m1.5.5.2.2.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.2.2.3.2.1.cmml" xref="S2.E2.m1.5.5.2.2.2.3">subscript</csymbol><sum id="S2.E2.m1.5.5.2.2.2.3.2.2.cmml" xref="S2.E2.m1.5.5.2.2.2.3.2.2"></sum><apply id="S2.E2.m1.5.5.2.2.2.3.2.3.cmml" xref="S2.E2.m1.5.5.2.2.2.3.2.3"><eq id="S2.E2.m1.5.5.2.2.2.3.2.3.1.cmml" xref="S2.E2.m1.5.5.2.2.2.3.2.3.1"></eq><ci id="S2.E2.m1.5.5.2.2.2.3.2.3.2.cmml" xref="S2.E2.m1.5.5.2.2.2.3.2.3.2">𝑖</ci><cn type="integer" id="S2.E2.m1.5.5.2.2.2.3.2.3.3.cmml" xref="S2.E2.m1.5.5.2.2.2.3.2.3.3">1</cn></apply></apply><apply id="S2.E2.m1.5.5.2.2.2.3.3.cmml" xref="S2.E2.m1.5.5.2.2.2.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.2.2.3.3.1.cmml" xref="S2.E2.m1.5.5.2.2.2.3.3">subscript</csymbol><ci id="S2.E2.m1.5.5.2.2.2.3.3.2.cmml" xref="S2.E2.m1.5.5.2.2.2.3.3.2">𝑁</ci><ci id="S2.E2.m1.5.5.2.2.2.3.3.3.cmml" xref="S2.E2.m1.5.5.2.2.2.3.3.3">𝑘</ci></apply></apply><apply id="S2.E2.m1.5.5.2.2.2.2.cmml" xref="S2.E2.m1.5.5.2.2.2.2"><times id="S2.E2.m1.5.5.2.2.2.2.3.cmml" xref="S2.E2.m1.5.5.2.2.2.2.3"></times><apply id="S2.E2.m1.5.5.2.2.2.2.4.cmml" xref="S2.E2.m1.5.5.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.2.2.2.4.1.cmml" xref="S2.E2.m1.5.5.2.2.2.2.4">subscript</csymbol><ci id="S2.E2.m1.5.5.2.2.2.2.4.2.cmml" xref="S2.E2.m1.5.5.2.2.2.2.4.2">𝑓</ci><ci id="S2.E2.m1.5.5.2.2.2.2.4.3.cmml" xref="S2.E2.m1.5.5.2.2.2.2.4.3">𝑘</ci></apply><interval closure="open" id="S2.E2.m1.5.5.2.2.2.2.2.3.cmml" xref="S2.E2.m1.5.5.2.2.2.2.2.2"><interval closure="open" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1"><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝑢</ci><apply id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.2">𝑣</ci><ci id="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.4.4.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply></interval><apply id="S2.E2.m1.5.5.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2">superscript</csymbol><apply id="S2.E2.m1.5.5.2.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.2.2.2.2.2.2.2.2.1.cmml" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2">subscript</csymbol><ci id="S2.E2.m1.5.5.2.2.2.2.2.2.2.2.2.cmml" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2.2.2">𝑥</ci><ci id="S2.E2.m1.5.5.2.2.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S2.E2.m1.5.5.2.2.2.2.2.2.2.3.cmml" xref="S2.E2.m1.5.5.2.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.5c">\min_{u,\{v_{k}\}_{k=1}^{N}}\sum_{k=1}^{N}\frac{\alpha_{k}}{N_{k}}\sum_{i=1}^{N_{k}}f_{k}((u,v_{k}),x_{i}^{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p5.4" class="ltx_p">where <math id="S2.SS1.p5.4.m1.1" class="ltx_Math" alttext="\alpha_{k}" display="inline"><semantics id="S2.SS1.p5.4.m1.1a"><msub id="S2.SS1.p5.4.m1.1.1" xref="S2.SS1.p5.4.m1.1.1.cmml"><mi id="S2.SS1.p5.4.m1.1.1.2" xref="S2.SS1.p5.4.m1.1.1.2.cmml">α</mi><mi id="S2.SS1.p5.4.m1.1.1.3" xref="S2.SS1.p5.4.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.4.m1.1b"><apply id="S2.SS1.p5.4.m1.1.1.cmml" xref="S2.SS1.p5.4.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m1.1.1.1.cmml" xref="S2.SS1.p5.4.m1.1.1">subscript</csymbol><ci id="S2.SS1.p5.4.m1.1.1.2.cmml" xref="S2.SS1.p5.4.m1.1.1.2">𝛼</ci><ci id="S2.SS1.p5.4.m1.1.1.3.cmml" xref="S2.SS1.p5.4.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.4.m1.1c">\alpha_{k}</annotation></semantics></math> represents a constant weighting factor for aggregation of client losses.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Motivation</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Prior works involving fine-tuning during both transfer learning and federated learning under distributional shift selectively fine-tune models layer-wise <cite class="ltx_cite ltx_citemacro_citep">(Lee et al., <a href="#bib.bib11" title="" class="ltx_ref">2023</a>; Pillutla et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>; Liang et al., <a href="#bib.bib15" title="" class="ltx_ref">2020</a>; Li et al., <a href="#bib.bib14" title="" class="ltx_ref">2021b</a>; Collins et al., <a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite>. In this work, we propose a novel hypothesis describing that only <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_italic">parameters</span> that change the most during training are necessary for fine-tuning the model; the rest can be frozen as initialized parameters.
Thus, drastic distributional changes in the fine-tuning task may be better accommodated by preserving pretrained knowledge <span id="S2.SS2.p1.1.2" class="ltx_text ltx_font_italic">parameter-wise</span> rather than <span id="S2.SS2.p1.1.3" class="ltx_text ltx_font_italic">layer-wise</span>. Following this we propose the following hypothesis:</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p"><span id="S2.SS2.p2.1.1" class="ltx_text ltx_font_bold">FL Gradient-based Lottery Ticket Hypothesis.</span> <span id="S2.SS2.p2.1.2" class="ltx_text ltx_font_italic">When training a client model on its local distribution during federated learning, parameters exhibiting minimal variation are considered suitable for freezing and encoding shared knowledge, while parameters demonstrating significant fluctuation are deemed optimal for fine-tuning on local distribution and encoding personalized knowledge.</span></p>
</div>
<div id="S2.SS2.p3" class="ltx_para">
<p id="S2.SS2.p3.1" class="ltx_p">The set of parameters selected for personalization will be trained on local data and kept locally, while the rest of the parameters that are identified as frozen will be initialized as the global parameters, then locally updated, and finally submitted to the server for federated averaging to encode shared knowledge across clients.
GradLTN (Algorithm <a href="#alg1" title="Algorithm 1 ‣ 2.3.1 GradLTN ‣ 2.3 Algorithms ‣ 2 Methods ‣ FedSelect: Customized Selection of Parameters for Fine-Tuning during Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>) describes the process by which these candidate parameters for local personalization and global updating are identified, respectively. Then, FedSelect(Algorithm <a href="#alg2" title="Algorithm 2 ‣ 2.3.2 FedSelect ‣ 2.3 Algorithms ‣ 2 Methods ‣ FedSelect: Customized Selection of Parameters for Fine-Tuning during Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) utilizes GradLTN’s output to perform federated averaging.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Algorithms</h3>

<section id="S2.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.1 </span>GradLTN</h4>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> GradLTN: Gradient-based Lottery Tickets</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">  <span id="alg1.l1.1" class="ltx_text ltx_font_bold">Input:</span> <math id="alg1.l1.m1.3" class="ltx_Math" alttext="\theta_{0},L,r" display="inline"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.3.1" xref="alg1.l1.m1.3.3.2.cmml"><msub id="alg1.l1.m1.3.3.1.1" xref="alg1.l1.m1.3.3.1.1.cmml"><mi id="alg1.l1.m1.3.3.1.1.2" xref="alg1.l1.m1.3.3.1.1.2.cmml">θ</mi><mn id="alg1.l1.m1.3.3.1.1.3" xref="alg1.l1.m1.3.3.1.1.3.cmml">0</mn></msub><mo id="alg1.l1.m1.3.3.1.2" xref="alg1.l1.m1.3.3.2.cmml">,</mo><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">L</mi><mo id="alg1.l1.m1.3.3.1.3" xref="alg1.l1.m1.3.3.2.cmml">,</mo><mi id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">r</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><list id="alg1.l1.m1.3.3.2.cmml" xref="alg1.l1.m1.3.3.1"><apply id="alg1.l1.m1.3.3.1.1.cmml" xref="alg1.l1.m1.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.3.3.1.1.1.cmml" xref="alg1.l1.m1.3.3.1.1">subscript</csymbol><ci id="alg1.l1.m1.3.3.1.1.2.cmml" xref="alg1.l1.m1.3.3.1.1.2">𝜃</ci><cn type="integer" id="alg1.l1.m1.3.3.1.1.3.cmml" xref="alg1.l1.m1.3.3.1.1.3">0</cn></apply><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐿</ci><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">𝑟</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">\theta_{0},L,r</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">  <span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.1" class="ltx_Math" alttext="i=0" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">i</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">=</mo><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><eq id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></eq><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">i=0</annotation></semantics></math> <span id="alg1.l2.2" class="ltx_text ltx_font_bold">to</span> <math id="alg1.l2.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">L</annotation></semantics></math> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">     <span id="alg1.l3.1" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l3.m1.1" class="ltx_Math" alttext="i&gt;0" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">i</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">&gt;</mo><mn id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><gt id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></gt><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑖</ci><cn type="integer" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">i&gt;0</annotation></semantics></math> <span id="alg1.l3.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l4" class="ltx_listingline">        <math id="alg1.l4.m1.1" class="ltx_Math" alttext="\gamma\leftarrow|\theta_{i}-\theta_{i-1}|\odot m_{i-1}" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">γ</mi><mo stretchy="false" id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">←</mo><mrow id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l4.m1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.2.1.cmml">|</mo><mrow id="alg1.l4.m1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.cmml"><msub id="alg1.l4.m1.1.1.1.1.1.1.2" xref="alg1.l4.m1.1.1.1.1.1.1.2.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.2.2" xref="alg1.l4.m1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="alg1.l4.m1.1.1.1.1.1.1.2.3" xref="alg1.l4.m1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l4.m1.1.1.1.1.1.1.1" xref="alg1.l4.m1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l4.m1.1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.3.2" xref="alg1.l4.m1.1.1.1.1.1.1.3.2.cmml">θ</mi><mrow id="alg1.l4.m1.1.1.1.1.1.1.3.3" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.cmml"><mi id="alg1.l4.m1.1.1.1.1.1.1.3.3.2" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.2.cmml">i</mi><mo id="alg1.l4.m1.1.1.1.1.1.1.3.3.1" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="alg1.l4.m1.1.1.1.1.1.1.3.3.3" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo rspace="0.055em" stretchy="false" id="alg1.l4.m1.1.1.1.1.1.3" xref="alg1.l4.m1.1.1.1.1.2.1.cmml">|</mo></mrow><mo rspace="0.222em" id="alg1.l4.m1.1.1.1.2" xref="alg1.l4.m1.1.1.1.2.cmml">⊙</mo><msub id="alg1.l4.m1.1.1.1.3" xref="alg1.l4.m1.1.1.1.3.cmml"><mi id="alg1.l4.m1.1.1.1.3.2" xref="alg1.l4.m1.1.1.1.3.2.cmml">m</mi><mrow id="alg1.l4.m1.1.1.1.3.3" xref="alg1.l4.m1.1.1.1.3.3.cmml"><mi id="alg1.l4.m1.1.1.1.3.3.2" xref="alg1.l4.m1.1.1.1.3.3.2.cmml">i</mi><mo id="alg1.l4.m1.1.1.1.3.3.1" xref="alg1.l4.m1.1.1.1.3.3.1.cmml">−</mo><mn id="alg1.l4.m1.1.1.1.3.3.3" xref="alg1.l4.m1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">←</ci><ci id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">𝛾</ci><apply id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"><csymbol cd="latexml" id="alg1.l4.m1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.2">direct-product</csymbol><apply id="alg1.l4.m1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1"><abs id="alg1.l4.m1.1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.2"></abs><apply id="alg1.l4.m1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1"><minus id="alg1.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.1"></minus><apply id="alg1.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="alg1.l4.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.2">𝜃</ci><apply id="alg1.l4.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.3"><minus id="alg1.l4.m1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.1"></minus><ci id="alg1.l4.m1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.2">𝑖</ci><cn type="integer" id="alg1.l4.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l4.m1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply><apply id="alg1.l4.m1.1.1.1.3.cmml" xref="alg1.l4.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l4.m1.1.1.1.3.1.cmml" xref="alg1.l4.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l4.m1.1.1.1.3.2.cmml" xref="alg1.l4.m1.1.1.1.3.2">𝑚</ci><apply id="alg1.l4.m1.1.1.1.3.3.cmml" xref="alg1.l4.m1.1.1.1.3.3"><minus id="alg1.l4.m1.1.1.1.3.3.1.cmml" xref="alg1.l4.m1.1.1.1.3.3.1"></minus><ci id="alg1.l4.m1.1.1.1.3.3.2.cmml" xref="alg1.l4.m1.1.1.1.3.3.2">𝑖</ci><cn type="integer" id="alg1.l4.m1.1.1.1.3.3.3.cmml" xref="alg1.l4.m1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\gamma\leftarrow|\theta_{i}-\theta_{i-1}|\odot m_{i-1}</annotation></semantics></math> <span id="alg1.l4.1" class="ltx_text" style="float:right;"><span id="alg1.l4.1.1" class="ltx_text ltx_font_italic" style="color:#008080;"># Find new param change</span>
</span>
</div>
<div id="alg1.l5" class="ltx_listingline">        <math id="alg1.l5.m1.1" class="ltx_Math" alttext="m_{i}\leftarrow" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">m</mi><mi id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝑚</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑖</ci></apply><csymbol cd="latexml" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">m_{i}\leftarrow</annotation></semantics></math> binary mask for largest <math id="alg1.l5.m2.1" class="ltx_Math" alttext="(1-r)\%" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mrow id="alg1.l5.m2.1.1.1.1" xref="alg1.l5.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l5.m2.1.1.1.1.2" xref="alg1.l5.m2.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l5.m2.1.1.1.1.1" xref="alg1.l5.m2.1.1.1.1.1.cmml"><mn id="alg1.l5.m2.1.1.1.1.1.2" xref="alg1.l5.m2.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l5.m2.1.1.1.1.1.1" xref="alg1.l5.m2.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l5.m2.1.1.1.1.1.3" xref="alg1.l5.m2.1.1.1.1.1.3.cmml">r</mi></mrow><mo stretchy="false" id="alg1.l5.m2.1.1.1.1.3" xref="alg1.l5.m2.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><csymbol cd="latexml" id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">percent</csymbol><apply id="alg1.l5.m2.1.1.1.1.1.cmml" xref="alg1.l5.m2.1.1.1.1"><minus id="alg1.l5.m2.1.1.1.1.1.1.cmml" xref="alg1.l5.m2.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.l5.m2.1.1.1.1.1.2.cmml" xref="alg1.l5.m2.1.1.1.1.1.2">1</cn><ci id="alg1.l5.m2.1.1.1.1.1.3.cmml" xref="alg1.l5.m2.1.1.1.1.1.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">(1-r)\%</annotation></semantics></math> values in <math id="alg1.l5.m3.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="alg1.l5.m3.1a"><mi id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><ci id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">\gamma</annotation></semantics></math>
<math id="alg1.l5.m4.1" class="ltx_Math" alttext="\theta_{i}\leftarrow\theta_{0}" display="inline"><semantics id="alg1.l5.m4.1a"><mrow id="alg1.l5.m4.1.1" xref="alg1.l5.m4.1.1.cmml"><msub id="alg1.l5.m4.1.1.2" xref="alg1.l5.m4.1.1.2.cmml"><mi id="alg1.l5.m4.1.1.2.2" xref="alg1.l5.m4.1.1.2.2.cmml">θ</mi><mi id="alg1.l5.m4.1.1.2.3" xref="alg1.l5.m4.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l5.m4.1.1.1" xref="alg1.l5.m4.1.1.1.cmml">←</mo><msub id="alg1.l5.m4.1.1.3" xref="alg1.l5.m4.1.1.3.cmml"><mi id="alg1.l5.m4.1.1.3.2" xref="alg1.l5.m4.1.1.3.2.cmml">θ</mi><mn id="alg1.l5.m4.1.1.3.3" xref="alg1.l5.m4.1.1.3.3.cmml">0</mn></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m4.1b"><apply id="alg1.l5.m4.1.1.cmml" xref="alg1.l5.m4.1.1"><ci id="alg1.l5.m4.1.1.1.cmml" xref="alg1.l5.m4.1.1.1">←</ci><apply id="alg1.l5.m4.1.1.2.cmml" xref="alg1.l5.m4.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m4.1.1.2.1.cmml" xref="alg1.l5.m4.1.1.2">subscript</csymbol><ci id="alg1.l5.m4.1.1.2.2.cmml" xref="alg1.l5.m4.1.1.2.2">𝜃</ci><ci id="alg1.l5.m4.1.1.2.3.cmml" xref="alg1.l5.m4.1.1.2.3">𝑖</ci></apply><apply id="alg1.l5.m4.1.1.3.cmml" xref="alg1.l5.m4.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m4.1.1.3.1.cmml" xref="alg1.l5.m4.1.1.3">subscript</csymbol><ci id="alg1.l5.m4.1.1.3.2.cmml" xref="alg1.l5.m4.1.1.3.2">𝜃</ci><cn type="integer" id="alg1.l5.m4.1.1.3.3.cmml" xref="alg1.l5.m4.1.1.3.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m4.1c">\theta_{i}\leftarrow\theta_{0}</annotation></semantics></math> <span id="alg1.l5.1" class="ltx_text" style="float:right;"><span id="alg1.l5.1.1" class="ltx_text ltx_font_italic" style="color:#008080;"># Reinitialize model</span>
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">     <span id="alg1.l6.1" class="ltx_text ltx_font_bold">else</span>


</div>
<div id="alg1.l7" class="ltx_listingline">        <math id="alg1.l7.m1.1" class="ltx_Math" alttext="m_{i}\leftarrow" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">m</mi><mi id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝑚</ci><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">𝑖</ci></apply><csymbol cd="latexml" id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">m_{i}\leftarrow</annotation></semantics></math> mask of all <math id="alg1.l7.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="alg1.l7.m2.1a"><mn id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><cn type="integer" id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">1</annotation></semantics></math>s

</div>
<div id="alg1.l8" class="ltx_listingline">     <span id="alg1.l8.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l8.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l9" class="ltx_listingline">     <span id="alg1.l9.1" class="ltx_text ltx_font_bold">for</span> epoch <math id="alg1.l9.m1.1" class="ltx_Math" alttext="j=1" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mi id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">j</mi><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">=</mo><mn id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></eq><ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">𝑗</ci><cn type="integer" id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">j=1</annotation></semantics></math> <span id="alg1.l9.2" class="ltx_text ltx_font_bold">to</span> <math id="alg1.l9.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l9.m2.1a"><mi id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><ci id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">E</annotation></semantics></math> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l10" class="ltx_listingline">        <math id="alg1.l10.m1.1" class="ltx_Math" alttext="t\leftarrow 0" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mi id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">t</mi><mo stretchy="false" id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml">←</mo><mn id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><ci id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1">←</ci><ci id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">t\leftarrow 0</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">        <span id="alg1.l11.1" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l11.m1.1" class="ltx_Math" alttext="b\in B" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">b</mi><mo id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">∈</mo><mi id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><in id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"></in><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑏</ci><ci id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">b\in B</annotation></semantics></math> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l12" class="ltx_listingline">           <span id="alg1.l12.1" class="ltx_text ltx_font_italic" style="color:#008080;"># Freeze params where mask is zero</span>

</div>
<div id="alg1.l13" class="ltx_listingline">           <math id="alg1.l13.m1.6" class="ltx_Math" alttext="g_{t}\leftarrow\nabla_{\theta_{i,t}}l(\theta_{i,t},b)\odot m_{i}" display="inline"><semantics id="alg1.l13.m1.6a"><mrow id="alg1.l13.m1.6.6" xref="alg1.l13.m1.6.6.cmml"><msub id="alg1.l13.m1.6.6.3" xref="alg1.l13.m1.6.6.3.cmml"><mi id="alg1.l13.m1.6.6.3.2" xref="alg1.l13.m1.6.6.3.2.cmml">g</mi><mi id="alg1.l13.m1.6.6.3.3" xref="alg1.l13.m1.6.6.3.3.cmml">t</mi></msub><mo stretchy="false" id="alg1.l13.m1.6.6.2" xref="alg1.l13.m1.6.6.2.cmml">←</mo><mrow id="alg1.l13.m1.6.6.1" xref="alg1.l13.m1.6.6.1.cmml"><mrow id="alg1.l13.m1.6.6.1.1" xref="alg1.l13.m1.6.6.1.1.cmml"><mrow id="alg1.l13.m1.6.6.1.1.3" xref="alg1.l13.m1.6.6.1.1.3.cmml"><msub id="alg1.l13.m1.6.6.1.1.3.1" xref="alg1.l13.m1.6.6.1.1.3.1.cmml"><mo rspace="0.167em" id="alg1.l13.m1.6.6.1.1.3.1.2" xref="alg1.l13.m1.6.6.1.1.3.1.2.cmml">∇</mo><msub id="alg1.l13.m1.2.2.2" xref="alg1.l13.m1.2.2.2.cmml"><mi id="alg1.l13.m1.2.2.2.4" xref="alg1.l13.m1.2.2.2.4.cmml">θ</mi><mrow id="alg1.l13.m1.2.2.2.2.2.4" xref="alg1.l13.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l13.m1.1.1.1.1.1.1" xref="alg1.l13.m1.1.1.1.1.1.1.cmml">i</mi><mo id="alg1.l13.m1.2.2.2.2.2.4.1" xref="alg1.l13.m1.2.2.2.2.2.3.cmml">,</mo><mi id="alg1.l13.m1.2.2.2.2.2.2" xref="alg1.l13.m1.2.2.2.2.2.2.cmml">t</mi></mrow></msub></msub><mi id="alg1.l13.m1.6.6.1.1.3.2" xref="alg1.l13.m1.6.6.1.1.3.2.cmml">l</mi></mrow><mo lspace="0em" rspace="0em" id="alg1.l13.m1.6.6.1.1.2" xref="alg1.l13.m1.6.6.1.1.2.cmml">​</mo><mrow id="alg1.l13.m1.6.6.1.1.1.1" xref="alg1.l13.m1.6.6.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l13.m1.6.6.1.1.1.1.2" xref="alg1.l13.m1.6.6.1.1.1.2.cmml">(</mo><msub id="alg1.l13.m1.6.6.1.1.1.1.1" xref="alg1.l13.m1.6.6.1.1.1.1.1.cmml"><mi id="alg1.l13.m1.6.6.1.1.1.1.1.2" xref="alg1.l13.m1.6.6.1.1.1.1.1.2.cmml">θ</mi><mrow id="alg1.l13.m1.4.4.2.4" xref="alg1.l13.m1.4.4.2.3.cmml"><mi id="alg1.l13.m1.3.3.1.1" xref="alg1.l13.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l13.m1.4.4.2.4.1" xref="alg1.l13.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l13.m1.4.4.2.2" xref="alg1.l13.m1.4.4.2.2.cmml">t</mi></mrow></msub><mo id="alg1.l13.m1.6.6.1.1.1.1.3" xref="alg1.l13.m1.6.6.1.1.1.2.cmml">,</mo><mi id="alg1.l13.m1.5.5" xref="alg1.l13.m1.5.5.cmml">b</mi><mo rspace="0.055em" stretchy="false" id="alg1.l13.m1.6.6.1.1.1.1.4" xref="alg1.l13.m1.6.6.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="alg1.l13.m1.6.6.1.2" xref="alg1.l13.m1.6.6.1.2.cmml">⊙</mo><msub id="alg1.l13.m1.6.6.1.3" xref="alg1.l13.m1.6.6.1.3.cmml"><mi id="alg1.l13.m1.6.6.1.3.2" xref="alg1.l13.m1.6.6.1.3.2.cmml">m</mi><mi id="alg1.l13.m1.6.6.1.3.3" xref="alg1.l13.m1.6.6.1.3.3.cmml">i</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.6b"><apply id="alg1.l13.m1.6.6.cmml" xref="alg1.l13.m1.6.6"><ci id="alg1.l13.m1.6.6.2.cmml" xref="alg1.l13.m1.6.6.2">←</ci><apply id="alg1.l13.m1.6.6.3.cmml" xref="alg1.l13.m1.6.6.3"><csymbol cd="ambiguous" id="alg1.l13.m1.6.6.3.1.cmml" xref="alg1.l13.m1.6.6.3">subscript</csymbol><ci id="alg1.l13.m1.6.6.3.2.cmml" xref="alg1.l13.m1.6.6.3.2">𝑔</ci><ci id="alg1.l13.m1.6.6.3.3.cmml" xref="alg1.l13.m1.6.6.3.3">𝑡</ci></apply><apply id="alg1.l13.m1.6.6.1.cmml" xref="alg1.l13.m1.6.6.1"><csymbol cd="latexml" id="alg1.l13.m1.6.6.1.2.cmml" xref="alg1.l13.m1.6.6.1.2">direct-product</csymbol><apply id="alg1.l13.m1.6.6.1.1.cmml" xref="alg1.l13.m1.6.6.1.1"><times id="alg1.l13.m1.6.6.1.1.2.cmml" xref="alg1.l13.m1.6.6.1.1.2"></times><apply id="alg1.l13.m1.6.6.1.1.3.cmml" xref="alg1.l13.m1.6.6.1.1.3"><apply id="alg1.l13.m1.6.6.1.1.3.1.cmml" xref="alg1.l13.m1.6.6.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l13.m1.6.6.1.1.3.1.1.cmml" xref="alg1.l13.m1.6.6.1.1.3.1">subscript</csymbol><ci id="alg1.l13.m1.6.6.1.1.3.1.2.cmml" xref="alg1.l13.m1.6.6.1.1.3.1.2">∇</ci><apply id="alg1.l13.m1.2.2.2.cmml" xref="alg1.l13.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l13.m1.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2">subscript</csymbol><ci id="alg1.l13.m1.2.2.2.4.cmml" xref="alg1.l13.m1.2.2.2.4">𝜃</ci><list id="alg1.l13.m1.2.2.2.2.2.3.cmml" xref="alg1.l13.m1.2.2.2.2.2.4"><ci id="alg1.l13.m1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1.1.1.1">𝑖</ci><ci id="alg1.l13.m1.2.2.2.2.2.2.cmml" xref="alg1.l13.m1.2.2.2.2.2.2">𝑡</ci></list></apply></apply><ci id="alg1.l13.m1.6.6.1.1.3.2.cmml" xref="alg1.l13.m1.6.6.1.1.3.2">𝑙</ci></apply><interval closure="open" id="alg1.l13.m1.6.6.1.1.1.2.cmml" xref="alg1.l13.m1.6.6.1.1.1.1"><apply id="alg1.l13.m1.6.6.1.1.1.1.1.cmml" xref="alg1.l13.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.6.6.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.6.6.1.1.1.1.1">subscript</csymbol><ci id="alg1.l13.m1.6.6.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.6.6.1.1.1.1.1.2">𝜃</ci><list id="alg1.l13.m1.4.4.2.3.cmml" xref="alg1.l13.m1.4.4.2.4"><ci id="alg1.l13.m1.3.3.1.1.cmml" xref="alg1.l13.m1.3.3.1.1">𝑖</ci><ci id="alg1.l13.m1.4.4.2.2.cmml" xref="alg1.l13.m1.4.4.2.2">𝑡</ci></list></apply><ci id="alg1.l13.m1.5.5.cmml" xref="alg1.l13.m1.5.5">𝑏</ci></interval></apply><apply id="alg1.l13.m1.6.6.1.3.cmml" xref="alg1.l13.m1.6.6.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.6.6.1.3.1.cmml" xref="alg1.l13.m1.6.6.1.3">subscript</csymbol><ci id="alg1.l13.m1.6.6.1.3.2.cmml" xref="alg1.l13.m1.6.6.1.3.2">𝑚</ci><ci id="alg1.l13.m1.6.6.1.3.3.cmml" xref="alg1.l13.m1.6.6.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.6c">g_{t}\leftarrow\nabla_{\theta_{i,t}}l(\theta_{i,t},b)\odot m_{i}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">           <math id="alg1.l14.m1.4" class="ltx_Math" alttext="\theta_{i,t+1}\odot m_{i}\leftarrow\theta_{i,t}\odot m_{i}-\eta g_{t}" display="inline"><semantics id="alg1.l14.m1.4a"><mrow id="alg1.l14.m1.4.5" xref="alg1.l14.m1.4.5.cmml"><mrow id="alg1.l14.m1.4.5.2" xref="alg1.l14.m1.4.5.2.cmml"><msub id="alg1.l14.m1.4.5.2.2" xref="alg1.l14.m1.4.5.2.2.cmml"><mi id="alg1.l14.m1.4.5.2.2.2" xref="alg1.l14.m1.4.5.2.2.2.cmml">θ</mi><mrow id="alg1.l14.m1.2.2.2.2" xref="alg1.l14.m1.2.2.2.3.cmml"><mi id="alg1.l14.m1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.cmml">i</mi><mo id="alg1.l14.m1.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.3.cmml">,</mo><mrow id="alg1.l14.m1.2.2.2.2.1" xref="alg1.l14.m1.2.2.2.2.1.cmml"><mi id="alg1.l14.m1.2.2.2.2.1.2" xref="alg1.l14.m1.2.2.2.2.1.2.cmml">t</mi><mo id="alg1.l14.m1.2.2.2.2.1.1" xref="alg1.l14.m1.2.2.2.2.1.1.cmml">+</mo><mn id="alg1.l14.m1.2.2.2.2.1.3" xref="alg1.l14.m1.2.2.2.2.1.3.cmml">1</mn></mrow></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l14.m1.4.5.2.1" xref="alg1.l14.m1.4.5.2.1.cmml">⊙</mo><msub id="alg1.l14.m1.4.5.2.3" xref="alg1.l14.m1.4.5.2.3.cmml"><mi id="alg1.l14.m1.4.5.2.3.2" xref="alg1.l14.m1.4.5.2.3.2.cmml">m</mi><mi id="alg1.l14.m1.4.5.2.3.3" xref="alg1.l14.m1.4.5.2.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="alg1.l14.m1.4.5.1" xref="alg1.l14.m1.4.5.1.cmml">←</mo><mrow id="alg1.l14.m1.4.5.3" xref="alg1.l14.m1.4.5.3.cmml"><mrow id="alg1.l14.m1.4.5.3.2" xref="alg1.l14.m1.4.5.3.2.cmml"><msub id="alg1.l14.m1.4.5.3.2.2" xref="alg1.l14.m1.4.5.3.2.2.cmml"><mi id="alg1.l14.m1.4.5.3.2.2.2" xref="alg1.l14.m1.4.5.3.2.2.2.cmml">θ</mi><mrow id="alg1.l14.m1.4.4.2.4" xref="alg1.l14.m1.4.4.2.3.cmml"><mi id="alg1.l14.m1.3.3.1.1" xref="alg1.l14.m1.3.3.1.1.cmml">i</mi><mo id="alg1.l14.m1.4.4.2.4.1" xref="alg1.l14.m1.4.4.2.3.cmml">,</mo><mi id="alg1.l14.m1.4.4.2.2" xref="alg1.l14.m1.4.4.2.2.cmml">t</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l14.m1.4.5.3.2.1" xref="alg1.l14.m1.4.5.3.2.1.cmml">⊙</mo><msub id="alg1.l14.m1.4.5.3.2.3" xref="alg1.l14.m1.4.5.3.2.3.cmml"><mi id="alg1.l14.m1.4.5.3.2.3.2" xref="alg1.l14.m1.4.5.3.2.3.2.cmml">m</mi><mi id="alg1.l14.m1.4.5.3.2.3.3" xref="alg1.l14.m1.4.5.3.2.3.3.cmml">i</mi></msub></mrow><mo id="alg1.l14.m1.4.5.3.1" xref="alg1.l14.m1.4.5.3.1.cmml">−</mo><mrow id="alg1.l14.m1.4.5.3.3" xref="alg1.l14.m1.4.5.3.3.cmml"><mi id="alg1.l14.m1.4.5.3.3.2" xref="alg1.l14.m1.4.5.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.4.5.3.3.1" xref="alg1.l14.m1.4.5.3.3.1.cmml">​</mo><msub id="alg1.l14.m1.4.5.3.3.3" xref="alg1.l14.m1.4.5.3.3.3.cmml"><mi id="alg1.l14.m1.4.5.3.3.3.2" xref="alg1.l14.m1.4.5.3.3.3.2.cmml">g</mi><mi id="alg1.l14.m1.4.5.3.3.3.3" xref="alg1.l14.m1.4.5.3.3.3.3.cmml">t</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.4b"><apply id="alg1.l14.m1.4.5.cmml" xref="alg1.l14.m1.4.5"><ci id="alg1.l14.m1.4.5.1.cmml" xref="alg1.l14.m1.4.5.1">←</ci><apply id="alg1.l14.m1.4.5.2.cmml" xref="alg1.l14.m1.4.5.2"><csymbol cd="latexml" id="alg1.l14.m1.4.5.2.1.cmml" xref="alg1.l14.m1.4.5.2.1">direct-product</csymbol><apply id="alg1.l14.m1.4.5.2.2.cmml" xref="alg1.l14.m1.4.5.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.2.2.1.cmml" xref="alg1.l14.m1.4.5.2.2">subscript</csymbol><ci id="alg1.l14.m1.4.5.2.2.2.cmml" xref="alg1.l14.m1.4.5.2.2.2">𝜃</ci><list id="alg1.l14.m1.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2"><ci id="alg1.l14.m1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1">𝑖</ci><apply id="alg1.l14.m1.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.1"><plus id="alg1.l14.m1.2.2.2.2.1.1.cmml" xref="alg1.l14.m1.2.2.2.2.1.1"></plus><ci id="alg1.l14.m1.2.2.2.2.1.2.cmml" xref="alg1.l14.m1.2.2.2.2.1.2">𝑡</ci><cn type="integer" id="alg1.l14.m1.2.2.2.2.1.3.cmml" xref="alg1.l14.m1.2.2.2.2.1.3">1</cn></apply></list></apply><apply id="alg1.l14.m1.4.5.2.3.cmml" xref="alg1.l14.m1.4.5.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.2.3.1.cmml" xref="alg1.l14.m1.4.5.2.3">subscript</csymbol><ci id="alg1.l14.m1.4.5.2.3.2.cmml" xref="alg1.l14.m1.4.5.2.3.2">𝑚</ci><ci id="alg1.l14.m1.4.5.2.3.3.cmml" xref="alg1.l14.m1.4.5.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l14.m1.4.5.3.cmml" xref="alg1.l14.m1.4.5.3"><minus id="alg1.l14.m1.4.5.3.1.cmml" xref="alg1.l14.m1.4.5.3.1"></minus><apply id="alg1.l14.m1.4.5.3.2.cmml" xref="alg1.l14.m1.4.5.3.2"><csymbol cd="latexml" id="alg1.l14.m1.4.5.3.2.1.cmml" xref="alg1.l14.m1.4.5.3.2.1">direct-product</csymbol><apply id="alg1.l14.m1.4.5.3.2.2.cmml" xref="alg1.l14.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.2.2.1.cmml" xref="alg1.l14.m1.4.5.3.2.2">subscript</csymbol><ci id="alg1.l14.m1.4.5.3.2.2.2.cmml" xref="alg1.l14.m1.4.5.3.2.2.2">𝜃</ci><list id="alg1.l14.m1.4.4.2.3.cmml" xref="alg1.l14.m1.4.4.2.4"><ci id="alg1.l14.m1.3.3.1.1.cmml" xref="alg1.l14.m1.3.3.1.1">𝑖</ci><ci id="alg1.l14.m1.4.4.2.2.cmml" xref="alg1.l14.m1.4.4.2.2">𝑡</ci></list></apply><apply id="alg1.l14.m1.4.5.3.2.3.cmml" xref="alg1.l14.m1.4.5.3.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.2.3.1.cmml" xref="alg1.l14.m1.4.5.3.2.3">subscript</csymbol><ci id="alg1.l14.m1.4.5.3.2.3.2.cmml" xref="alg1.l14.m1.4.5.3.2.3.2">𝑚</ci><ci id="alg1.l14.m1.4.5.3.2.3.3.cmml" xref="alg1.l14.m1.4.5.3.2.3.3">𝑖</ci></apply></apply><apply id="alg1.l14.m1.4.5.3.3.cmml" xref="alg1.l14.m1.4.5.3.3"><times id="alg1.l14.m1.4.5.3.3.1.cmml" xref="alg1.l14.m1.4.5.3.3.1"></times><ci id="alg1.l14.m1.4.5.3.3.2.cmml" xref="alg1.l14.m1.4.5.3.3.2">𝜂</ci><apply id="alg1.l14.m1.4.5.3.3.3.cmml" xref="alg1.l14.m1.4.5.3.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.4.5.3.3.3.1.cmml" xref="alg1.l14.m1.4.5.3.3.3">subscript</csymbol><ci id="alg1.l14.m1.4.5.3.3.3.2.cmml" xref="alg1.l14.m1.4.5.3.3.3.2">𝑔</ci><ci id="alg1.l14.m1.4.5.3.3.3.3.cmml" xref="alg1.l14.m1.4.5.3.3.3.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.4c">\theta_{i,t+1}\odot m_{i}\leftarrow\theta_{i,t}\odot m_{i}-\eta g_{t}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">        <span id="alg1.l15.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l15.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l16" class="ltx_listingline">     <span id="alg1.l16.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l17" class="ltx_listingline">  <span id="alg1.l17.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l17.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l18" class="ltx_listingline">  <span id="alg1.l18.3" class="ltx_text ltx_font_italic" style="color:#008080;"># Return <math id="alg1.l18.1.m1.1" class="ltx_Math" alttext="u" display="inline"><semantics id="alg1.l18.1.m1.1a"><mi mathcolor="#008080" id="alg1.l18.1.m1.1.1" xref="alg1.l18.1.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="alg1.l18.1.m1.1b"><ci id="alg1.l18.1.m1.1.1.cmml" xref="alg1.l18.1.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.1.m1.1c">u</annotation></semantics></math> and <math id="alg1.l18.2.m2.1" class="ltx_Math" alttext="v" display="inline"><semantics id="alg1.l18.2.m2.1a"><mi mathcolor="#008080" id="alg1.l18.2.m2.1.1" xref="alg1.l18.2.m2.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg1.l18.2.m2.1b"><ci id="alg1.l18.2.m2.1.1.cmml" xref="alg1.l18.2.m2.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.2.m2.1c">v</annotation></semantics></math> based on <math id="alg1.l18.3.m3.1" class="ltx_Math" alttext="m_{i}" display="inline"><semantics id="alg1.l18.3.m3.1a"><msub id="alg1.l18.3.m3.1.1" xref="alg1.l18.3.m3.1.1.cmml"><mi mathcolor="#008080" id="alg1.l18.3.m3.1.1.2" xref="alg1.l18.3.m3.1.1.2.cmml">m</mi><mi mathcolor="#008080" id="alg1.l18.3.m3.1.1.3" xref="alg1.l18.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l18.3.m3.1b"><apply id="alg1.l18.3.m3.1.1.cmml" xref="alg1.l18.3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l18.3.m3.1.1.1.cmml" xref="alg1.l18.3.m3.1.1">subscript</csymbol><ci id="alg1.l18.3.m3.1.1.2.cmml" xref="alg1.l18.3.m3.1.1.2">𝑚</ci><ci id="alg1.l18.3.m3.1.1.3.cmml" xref="alg1.l18.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.3.m3.1c">m_{i}</annotation></semantics></math></span>

</div>
<div id="alg1.l19" class="ltx_listingline">  return <math id="alg1.l19.m1.3" class="ltx_Math" alttext="\theta_{0}\odot\neg m_{L},\theta_{0}\odot m_{L},m_{L}" display="inline"><semantics id="alg1.l19.m1.3a"><mrow id="alg1.l19.m1.3.3.3" xref="alg1.l19.m1.3.3.4.cmml"><mrow id="alg1.l19.m1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.cmml"><msub id="alg1.l19.m1.1.1.1.1.2" xref="alg1.l19.m1.1.1.1.1.2.cmml"><mi id="alg1.l19.m1.1.1.1.1.2.2" xref="alg1.l19.m1.1.1.1.1.2.2.cmml">θ</mi><mn id="alg1.l19.m1.1.1.1.1.2.3" xref="alg1.l19.m1.1.1.1.1.2.3.cmml">0</mn></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l19.m1.1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.1.cmml">⊙</mo><mrow id="alg1.l19.m1.1.1.1.1.3" xref="alg1.l19.m1.1.1.1.1.3.cmml"><mo rspace="0.167em" id="alg1.l19.m1.1.1.1.1.3.1" xref="alg1.l19.m1.1.1.1.1.3.1.cmml">¬</mo><msub id="alg1.l19.m1.1.1.1.1.3.2" xref="alg1.l19.m1.1.1.1.1.3.2.cmml"><mi id="alg1.l19.m1.1.1.1.1.3.2.2" xref="alg1.l19.m1.1.1.1.1.3.2.2.cmml">m</mi><mi id="alg1.l19.m1.1.1.1.1.3.2.3" xref="alg1.l19.m1.1.1.1.1.3.2.3.cmml">L</mi></msub></mrow></mrow><mo id="alg1.l19.m1.3.3.3.4" xref="alg1.l19.m1.3.3.4.cmml">,</mo><mrow id="alg1.l19.m1.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.cmml"><msub id="alg1.l19.m1.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.2.cmml"><mi id="alg1.l19.m1.2.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.2.2.cmml">θ</mi><mn id="alg1.l19.m1.2.2.2.2.2.3" xref="alg1.l19.m1.2.2.2.2.2.3.cmml">0</mn></msub><mo lspace="0.222em" rspace="0.222em" id="alg1.l19.m1.2.2.2.2.1" xref="alg1.l19.m1.2.2.2.2.1.cmml">⊙</mo><msub id="alg1.l19.m1.2.2.2.2.3" xref="alg1.l19.m1.2.2.2.2.3.cmml"><mi id="alg1.l19.m1.2.2.2.2.3.2" xref="alg1.l19.m1.2.2.2.2.3.2.cmml">m</mi><mi id="alg1.l19.m1.2.2.2.2.3.3" xref="alg1.l19.m1.2.2.2.2.3.3.cmml">L</mi></msub></mrow><mo id="alg1.l19.m1.3.3.3.5" xref="alg1.l19.m1.3.3.4.cmml">,</mo><msub id="alg1.l19.m1.3.3.3.3" xref="alg1.l19.m1.3.3.3.3.cmml"><mi id="alg1.l19.m1.3.3.3.3.2" xref="alg1.l19.m1.3.3.3.3.2.cmml">m</mi><mi id="alg1.l19.m1.3.3.3.3.3" xref="alg1.l19.m1.3.3.3.3.3.cmml">L</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l19.m1.3b"><list id="alg1.l19.m1.3.3.4.cmml" xref="alg1.l19.m1.3.3.3"><apply id="alg1.l19.m1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1"><csymbol cd="latexml" id="alg1.l19.m1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1">direct-product</csymbol><apply id="alg1.l19.m1.1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.2.1.cmml" xref="alg1.l19.m1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.2.2.cmml" xref="alg1.l19.m1.1.1.1.1.2.2">𝜃</ci><cn type="integer" id="alg1.l19.m1.1.1.1.1.2.3.cmml" xref="alg1.l19.m1.1.1.1.1.2.3">0</cn></apply><apply id="alg1.l19.m1.1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.1.3"><not id="alg1.l19.m1.1.1.1.1.3.1.cmml" xref="alg1.l19.m1.1.1.1.1.3.1"></not><apply id="alg1.l19.m1.1.1.1.1.3.2.cmml" xref="alg1.l19.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.3.2.1.cmml" xref="alg1.l19.m1.1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l19.m1.1.1.1.1.3.2.2.cmml" xref="alg1.l19.m1.1.1.1.1.3.2.2">𝑚</ci><ci id="alg1.l19.m1.1.1.1.1.3.2.3.cmml" xref="alg1.l19.m1.1.1.1.1.3.2.3">𝐿</ci></apply></apply></apply><apply id="alg1.l19.m1.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2"><csymbol cd="latexml" id="alg1.l19.m1.2.2.2.2.1.cmml" xref="alg1.l19.m1.2.2.2.2.1">direct-product</csymbol><apply id="alg1.l19.m1.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.2.2.2.1.cmml" xref="alg1.l19.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l19.m1.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2">𝜃</ci><cn type="integer" id="alg1.l19.m1.2.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2.3">0</cn></apply><apply id="alg1.l19.m1.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l19.m1.2.2.2.2.3.1.cmml" xref="alg1.l19.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l19.m1.2.2.2.2.3.2.cmml" xref="alg1.l19.m1.2.2.2.2.3.2">𝑚</ci><ci id="alg1.l19.m1.2.2.2.2.3.3.cmml" xref="alg1.l19.m1.2.2.2.2.3.3">𝐿</ci></apply></apply><apply id="alg1.l19.m1.3.3.3.3.cmml" xref="alg1.l19.m1.3.3.3.3"><csymbol cd="ambiguous" id="alg1.l19.m1.3.3.3.3.1.cmml" xref="alg1.l19.m1.3.3.3.3">subscript</csymbol><ci id="alg1.l19.m1.3.3.3.3.2.cmml" xref="alg1.l19.m1.3.3.3.3.2">𝑚</ci><ci id="alg1.l19.m1.3.3.3.3.3.cmml" xref="alg1.l19.m1.3.3.3.3.3">𝐿</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l19.m1.3c">\theta_{0}\odot\neg m_{L},\theta_{0}\odot m_{L},m_{L}</annotation></semantics></math>

</div>
</div>
</figure>
<div id="S2.SS3.SSS1.p1" class="ltx_para">
<p id="S2.SS3.SSS1.p1.5" class="ltx_p">GradLTN takes as input an initialization for the network <math id="S2.SS3.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S2.SS3.SSS1.p1.1.m1.1a"><msub id="S2.SS3.SSS1.p1.1.m1.1.1" xref="S2.SS3.SSS1.p1.1.m1.1.1.cmml"><mi id="S2.SS3.SSS1.p1.1.m1.1.1.2" xref="S2.SS3.SSS1.p1.1.m1.1.1.2.cmml">θ</mi><mn id="S2.SS3.SSS1.p1.1.m1.1.1.3" xref="S2.SS3.SSS1.p1.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.1.m1.1b"><apply id="S2.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.1.m1.1.1.1.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS1.p1.1.m1.1.1.2.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.2">𝜃</ci><cn type="integer" id="S2.SS3.SSS1.p1.1.m1.1.1.3.cmml" xref="S2.SS3.SSS1.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.1.m1.1c">\theta_{0}</annotation></semantics></math>, the number of total mask-pruning iterations <math id="S2.SS3.SSS1.p1.2.m2.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S2.SS3.SSS1.p1.2.m2.1a"><mi id="S2.SS3.SSS1.p1.2.m2.1.1" xref="S2.SS3.SSS1.p1.2.m2.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.2.m2.1b"><ci id="S2.SS3.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p1.2.m2.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.2.m2.1c">L</annotation></semantics></math>, and a mask-pruning rate <math id="S2.SS3.SSS1.p1.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S2.SS3.SSS1.p1.3.m3.1a"><mi id="S2.SS3.SSS1.p1.3.m3.1.1" xref="S2.SS3.SSS1.p1.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.3.m3.1b"><ci id="S2.SS3.SSS1.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS1.p1.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.3.m3.1c">r</annotation></semantics></math>. Since statistical heterogeneity is typical across client data distributions in FL, it is a common goal to personalize client architectures or subnetworks to better adapt their local distributions. GradLTN implements this idea during the subnetwork search process, by freezing parameters that change the least, and continually fine-tuning the rest. By the end, two sets of parameters, <math id="S2.SS3.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\theta_{0}\odot\neg m_{L}" display="inline"><semantics id="S2.SS3.SSS1.p1.4.m4.1a"><mrow id="S2.SS3.SSS1.p1.4.m4.1.1" xref="S2.SS3.SSS1.p1.4.m4.1.1.cmml"><msub id="S2.SS3.SSS1.p1.4.m4.1.1.2" xref="S2.SS3.SSS1.p1.4.m4.1.1.2.cmml"><mi id="S2.SS3.SSS1.p1.4.m4.1.1.2.2" xref="S2.SS3.SSS1.p1.4.m4.1.1.2.2.cmml">θ</mi><mn id="S2.SS3.SSS1.p1.4.m4.1.1.2.3" xref="S2.SS3.SSS1.p1.4.m4.1.1.2.3.cmml">0</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.SSS1.p1.4.m4.1.1.1" xref="S2.SS3.SSS1.p1.4.m4.1.1.1.cmml">⊙</mo><mrow id="S2.SS3.SSS1.p1.4.m4.1.1.3" xref="S2.SS3.SSS1.p1.4.m4.1.1.3.cmml"><mo rspace="0.167em" id="S2.SS3.SSS1.p1.4.m4.1.1.3.1" xref="S2.SS3.SSS1.p1.4.m4.1.1.3.1.cmml">¬</mo><msub id="S2.SS3.SSS1.p1.4.m4.1.1.3.2" xref="S2.SS3.SSS1.p1.4.m4.1.1.3.2.cmml"><mi id="S2.SS3.SSS1.p1.4.m4.1.1.3.2.2" xref="S2.SS3.SSS1.p1.4.m4.1.1.3.2.2.cmml">m</mi><mi id="S2.SS3.SSS1.p1.4.m4.1.1.3.2.3" xref="S2.SS3.SSS1.p1.4.m4.1.1.3.2.3.cmml">L</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.4.m4.1b"><apply id="S2.SS3.SSS1.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1"><csymbol cd="latexml" id="S2.SS3.SSS1.p1.4.m4.1.1.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.1">direct-product</csymbol><apply id="S2.SS3.SSS1.p1.4.m4.1.1.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.4.m4.1.1.2.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS3.SSS1.p1.4.m4.1.1.2.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.2.2">𝜃</ci><cn type="integer" id="S2.SS3.SSS1.p1.4.m4.1.1.2.3.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.2.3">0</cn></apply><apply id="S2.SS3.SSS1.p1.4.m4.1.1.3.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.3"><not id="S2.SS3.SSS1.p1.4.m4.1.1.3.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.3.1"></not><apply id="S2.SS3.SSS1.p1.4.m4.1.1.3.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.4.m4.1.1.3.2.1.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.3.2">subscript</csymbol><ci id="S2.SS3.SSS1.p1.4.m4.1.1.3.2.2.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.3.2.2">𝑚</ci><ci id="S2.SS3.SSS1.p1.4.m4.1.1.3.2.3.cmml" xref="S2.SS3.SSS1.p1.4.m4.1.1.3.2.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.4.m4.1c">\theta_{0}\odot\neg m_{L}</annotation></semantics></math> and <math id="S2.SS3.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\theta_{0}\odot m_{L}" display="inline"><semantics id="S2.SS3.SSS1.p1.5.m5.1a"><mrow id="S2.SS3.SSS1.p1.5.m5.1.1" xref="S2.SS3.SSS1.p1.5.m5.1.1.cmml"><msub id="S2.SS3.SSS1.p1.5.m5.1.1.2" xref="S2.SS3.SSS1.p1.5.m5.1.1.2.cmml"><mi id="S2.SS3.SSS1.p1.5.m5.1.1.2.2" xref="S2.SS3.SSS1.p1.5.m5.1.1.2.2.cmml">θ</mi><mn id="S2.SS3.SSS1.p1.5.m5.1.1.2.3" xref="S2.SS3.SSS1.p1.5.m5.1.1.2.3.cmml">0</mn></msub><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.SSS1.p1.5.m5.1.1.1" xref="S2.SS3.SSS1.p1.5.m5.1.1.1.cmml">⊙</mo><msub id="S2.SS3.SSS1.p1.5.m5.1.1.3" xref="S2.SS3.SSS1.p1.5.m5.1.1.3.cmml"><mi id="S2.SS3.SSS1.p1.5.m5.1.1.3.2" xref="S2.SS3.SSS1.p1.5.m5.1.1.3.2.cmml">m</mi><mi id="S2.SS3.SSS1.p1.5.m5.1.1.3.3" xref="S2.SS3.SSS1.p1.5.m5.1.1.3.3.cmml">L</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p1.5.m5.1b"><apply id="S2.SS3.SSS1.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1"><csymbol cd="latexml" id="S2.SS3.SSS1.p1.5.m5.1.1.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1.1">direct-product</csymbol><apply id="S2.SS3.SSS1.p1.5.m5.1.1.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.5.m5.1.1.2.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1.2">subscript</csymbol><ci id="S2.SS3.SSS1.p1.5.m5.1.1.2.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1.2.2">𝜃</ci><cn type="integer" id="S2.SS3.SSS1.p1.5.m5.1.1.2.3.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1.2.3">0</cn></apply><apply id="S2.SS3.SSS1.p1.5.m5.1.1.3.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S2.SS3.SSS1.p1.5.m5.1.1.3.1.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1.3">subscript</csymbol><ci id="S2.SS3.SSS1.p1.5.m5.1.1.3.2.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1.3.2">𝑚</ci><ci id="S2.SS3.SSS1.p1.5.m5.1.1.3.3.cmml" xref="S2.SS3.SSS1.p1.5.m5.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p1.5.m5.1c">\theta_{0}\odot m_{L}</annotation></semantics></math>, are identified for averaging and fine-tuning, respectively. Although we run GradLTN for a fixed number of iterations, there are many alternative choices for the stopping condition, i.e. setting fixed target pruning-rates and target accuracy thresholds.</p>
</div>
<div id="S2.SS3.SSS1.p2" class="ltx_para">
<p id="S2.SS3.SSS1.p2.7" class="ltx_p">For convenience, we use the Hadamard operator <math id="S2.SS3.SSS1.p2.1.m1.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S2.SS3.SSS1.p2.1.m1.1a"><mo id="S2.SS3.SSS1.p2.1.m1.1.1" xref="S2.SS3.SSS1.p2.1.m1.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.1.m1.1b"><csymbol cd="latexml" id="S2.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS1.p2.1.m1.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.1.m1.1c">\odot</annotation></semantics></math> to be an indexing operator for a binary mask <math id="S2.SS3.SSS1.p2.2.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS3.SSS1.p2.2.m2.1a"><mi id="S2.SS3.SSS1.p2.2.m2.1.1" xref="S2.SS3.SSS1.p2.2.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.2.m2.1b"><ci id="S2.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS1.p2.2.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.2.m2.1c">m</annotation></semantics></math>, rather than an elementwise multiply operator. For example, <math id="S2.SS3.SSS1.p2.3.m3.1" class="ltx_Math" alttext="\theta\odot m" display="inline"><semantics id="S2.SS3.SSS1.p2.3.m3.1a"><mrow id="S2.SS3.SSS1.p2.3.m3.1.1" xref="S2.SS3.SSS1.p2.3.m3.1.1.cmml"><mi id="S2.SS3.SSS1.p2.3.m3.1.1.2" xref="S2.SS3.SSS1.p2.3.m3.1.1.2.cmml">θ</mi><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.SSS1.p2.3.m3.1.1.1" xref="S2.SS3.SSS1.p2.3.m3.1.1.1.cmml">⊙</mo><mi id="S2.SS3.SSS1.p2.3.m3.1.1.3" xref="S2.SS3.SSS1.p2.3.m3.1.1.3.cmml">m</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.3.m3.1b"><apply id="S2.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1"><csymbol cd="latexml" id="S2.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1.1">direct-product</csymbol><ci id="S2.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1.2">𝜃</ci><ci id="S2.SS3.SSS1.p2.3.m3.1.1.3.cmml" xref="S2.SS3.SSS1.p2.3.m3.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.3.m3.1c">\theta\odot m</annotation></semantics></math> assumes <math id="S2.SS3.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS3.SSS1.p2.4.m4.1a"><mi id="S2.SS3.SSS1.p2.4.m4.1.1" xref="S2.SS3.SSS1.p2.4.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.4.m4.1b"><ci id="S2.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS1.p2.4.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.4.m4.1c">\theta</annotation></semantics></math> and <math id="S2.SS3.SSS1.p2.5.m5.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS3.SSS1.p2.5.m5.1a"><mi id="S2.SS3.SSS1.p2.5.m5.1.1" xref="S2.SS3.SSS1.p2.5.m5.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.5.m5.1b"><ci id="S2.SS3.SSS1.p2.5.m5.1.1.cmml" xref="S2.SS3.SSS1.p2.5.m5.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.5.m5.1c">m</annotation></semantics></math> have the same dimensions and returns a reference to the set of parameters in <math id="S2.SS3.SSS1.p2.6.m6.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S2.SS3.SSS1.p2.6.m6.1a"><mi id="S2.SS3.SSS1.p2.6.m6.1.1" xref="S2.SS3.SSS1.p2.6.m6.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.6.m6.1b"><ci id="S2.SS3.SSS1.p2.6.m6.1.1.cmml" xref="S2.SS3.SSS1.p2.6.m6.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.6.m6.1c">\theta</annotation></semantics></math> where <math id="S2.SS3.SSS1.p2.7.m7.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S2.SS3.SSS1.p2.7.m7.1a"><mi id="S2.SS3.SSS1.p2.7.m7.1.1" xref="S2.SS3.SSS1.p2.7.m7.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS1.p2.7.m7.1b"><ci id="S2.SS3.SSS1.p2.7.m7.1.1.cmml" xref="S2.SS3.SSS1.p2.7.m7.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS1.p2.7.m7.1c">m</annotation></semantics></math> is not equal to zero.</p>
</div>
</section>
<section id="S2.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.2 </span>FedSelect</h4>

<div id="S2.SS3.SSS2.p1" class="ltx_para">
<p id="S2.SS3.SSS2.p1.5" class="ltx_p">In FedSelect, the input parameters <math id="S2.SS3.SSS2.p1.1.m1.6" class="ltx_Math" alttext="C,\theta_{G}^{0},K,R,L,\text{ and }p" display="inline"><semantics id="S2.SS3.SSS2.p1.1.m1.6a"><mrow id="S2.SS3.SSS2.p1.1.m1.6.6.2" xref="S2.SS3.SSS2.p1.1.m1.6.6.3.cmml"><mi id="S2.SS3.SSS2.p1.1.m1.1.1" xref="S2.SS3.SSS2.p1.1.m1.1.1.cmml">C</mi><mo id="S2.SS3.SSS2.p1.1.m1.6.6.2.3" xref="S2.SS3.SSS2.p1.1.m1.6.6.3.cmml">,</mo><msubsup id="S2.SS3.SSS2.p1.1.m1.5.5.1.1" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1.cmml"><mi id="S2.SS3.SSS2.p1.1.m1.5.5.1.1.2.2" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1.2.2.cmml">θ</mi><mi id="S2.SS3.SSS2.p1.1.m1.5.5.1.1.2.3" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1.2.3.cmml">G</mi><mn id="S2.SS3.SSS2.p1.1.m1.5.5.1.1.3" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1.3.cmml">0</mn></msubsup><mo id="S2.SS3.SSS2.p1.1.m1.6.6.2.4" xref="S2.SS3.SSS2.p1.1.m1.6.6.3.cmml">,</mo><mi id="S2.SS3.SSS2.p1.1.m1.2.2" xref="S2.SS3.SSS2.p1.1.m1.2.2.cmml">K</mi><mo id="S2.SS3.SSS2.p1.1.m1.6.6.2.5" xref="S2.SS3.SSS2.p1.1.m1.6.6.3.cmml">,</mo><mi id="S2.SS3.SSS2.p1.1.m1.3.3" xref="S2.SS3.SSS2.p1.1.m1.3.3.cmml">R</mi><mo id="S2.SS3.SSS2.p1.1.m1.6.6.2.6" xref="S2.SS3.SSS2.p1.1.m1.6.6.3.cmml">,</mo><mi id="S2.SS3.SSS2.p1.1.m1.4.4" xref="S2.SS3.SSS2.p1.1.m1.4.4.cmml">L</mi><mo id="S2.SS3.SSS2.p1.1.m1.6.6.2.7" xref="S2.SS3.SSS2.p1.1.m1.6.6.3.cmml">,</mo><mrow id="S2.SS3.SSS2.p1.1.m1.6.6.2.2" xref="S2.SS3.SSS2.p1.1.m1.6.6.2.2.cmml"><mtext id="S2.SS3.SSS2.p1.1.m1.6.6.2.2.2" xref="S2.SS3.SSS2.p1.1.m1.6.6.2.2.2a.cmml"> and </mtext><mo lspace="0em" rspace="0em" id="S2.SS3.SSS2.p1.1.m1.6.6.2.2.1" xref="S2.SS3.SSS2.p1.1.m1.6.6.2.2.1.cmml">​</mo><mi id="S2.SS3.SSS2.p1.1.m1.6.6.2.2.3" xref="S2.SS3.SSS2.p1.1.m1.6.6.2.2.3.cmml">p</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.1.m1.6b"><list id="S2.SS3.SSS2.p1.1.m1.6.6.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.6.6.2"><ci id="S2.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.1.1">𝐶</ci><apply id="S2.SS3.SSS2.p1.1.m1.5.5.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.1.m1.5.5.1.1.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1">superscript</csymbol><apply id="S2.SS3.SSS2.p1.1.m1.5.5.1.1.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.1.m1.5.5.1.1.2.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.1.m1.5.5.1.1.2.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1.2.2">𝜃</ci><ci id="S2.SS3.SSS2.p1.1.m1.5.5.1.1.2.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1.2.3">𝐺</ci></apply><cn type="integer" id="S2.SS3.SSS2.p1.1.m1.5.5.1.1.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.5.5.1.1.3">0</cn></apply><ci id="S2.SS3.SSS2.p1.1.m1.2.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.2.2">𝐾</ci><ci id="S2.SS3.SSS2.p1.1.m1.3.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.3.3">𝑅</ci><ci id="S2.SS3.SSS2.p1.1.m1.4.4.cmml" xref="S2.SS3.SSS2.p1.1.m1.4.4">𝐿</ci><apply id="S2.SS3.SSS2.p1.1.m1.6.6.2.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.6.6.2.2"><times id="S2.SS3.SSS2.p1.1.m1.6.6.2.2.1.cmml" xref="S2.SS3.SSS2.p1.1.m1.6.6.2.2.1"></times><ci id="S2.SS3.SSS2.p1.1.m1.6.6.2.2.2a.cmml" xref="S2.SS3.SSS2.p1.1.m1.6.6.2.2.2"><mtext id="S2.SS3.SSS2.p1.1.m1.6.6.2.2.2.cmml" xref="S2.SS3.SSS2.p1.1.m1.6.6.2.2.2"> and </mtext></ci><ci id="S2.SS3.SSS2.p1.1.m1.6.6.2.2.3.cmml" xref="S2.SS3.SSS2.p1.1.m1.6.6.2.2.3">𝑝</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.1.m1.6c">C,\theta_{G}^{0},K,R,L,\text{ and }p</annotation></semantics></math> represent clients, the first global initialization, participation rate, GradLTN iterations, and personalization rate, respectively. The key step in FedSelect is performing LocalAlt on the shared and local parameter partition identified by GradLTN. By the end of GradLTN, <math id="S2.SS3.SSS2.p1.2.m2.1" class="ltx_Math" alttext="v_{k}" display="inline"><semantics id="S2.SS3.SSS2.p1.2.m2.1a"><msub id="S2.SS3.SSS2.p1.2.m2.1.1" xref="S2.SS3.SSS2.p1.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p1.2.m2.1.1.2" xref="S2.SS3.SSS2.p1.2.m2.1.1.2.cmml">v</mi><mi id="S2.SS3.SSS2.p1.2.m2.1.1.3" xref="S2.SS3.SSS2.p1.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.2.m2.1b"><apply id="S2.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1.2">𝑣</ci><ci id="S2.SS3.SSS2.p1.2.m2.1.1.3.cmml" xref="S2.SS3.SSS2.p1.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.2.m2.1c">v_{k}</annotation></semantics></math> is identified as the set of appropriate parameters for dedicated local fine-tuning via LocalAlt; <math id="S2.SS3.SSS2.p1.3.m3.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S2.SS3.SSS2.p1.3.m3.1a"><mi id="S2.SS3.SSS2.p1.3.m3.1.1" xref="S2.SS3.SSS2.p1.3.m3.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.3.m3.1b"><ci id="S2.SS3.SSS2.p1.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p1.3.m3.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.3.m3.1c">u</annotation></semantics></math> is also updated in LocalAlt and then averaged for global knowledge acquisition and retention. LocalAlt was introduced to update a defined set of shared and local parameters, <math id="S2.SS3.SSS2.p1.4.m4.1" class="ltx_Math" alttext="u" display="inline"><semantics id="S2.SS3.SSS2.p1.4.m4.1a"><mi id="S2.SS3.SSS2.p1.4.m4.1.1" xref="S2.SS3.SSS2.p1.4.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.4.m4.1b"><ci id="S2.SS3.SSS2.p1.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p1.4.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.4.m4.1c">u</annotation></semantics></math> and <math id="S2.SS3.SSS2.p1.5.m5.1" class="ltx_Math" alttext="v_{k}" display="inline"><semantics id="S2.SS3.SSS2.p1.5.m5.1a"><msub id="S2.SS3.SSS2.p1.5.m5.1.1" xref="S2.SS3.SSS2.p1.5.m5.1.1.cmml"><mi id="S2.SS3.SSS2.p1.5.m5.1.1.2" xref="S2.SS3.SSS2.p1.5.m5.1.1.2.cmml">v</mi><mi id="S2.SS3.SSS2.p1.5.m5.1.1.3" xref="S2.SS3.SSS2.p1.5.m5.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p1.5.m5.1b"><apply id="S2.SS3.SSS2.p1.5.m5.1.1.cmml" xref="S2.SS3.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p1.5.m5.1.1.1.cmml" xref="S2.SS3.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p1.5.m5.1.1.2.cmml" xref="S2.SS3.SSS2.p1.5.m5.1.1.2">𝑣</ci><ci id="S2.SS3.SSS2.p1.5.m5.1.1.3.cmml" xref="S2.SS3.SSS2.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p1.5.m5.1c">v_{k}</annotation></semantics></math>, by alternating full passes of stochastic gradient descent between the two sets of parameters <cite class="ltx_cite ltx_citemacro_citep">(Pillutla et al., <a href="#bib.bib21" title="" class="ltx_ref">2022</a>)</cite>. To the best of our knowledge, this is the first method to choose parameters for alternating updates in federated learning during training time.</p>
</div>
<div id="S2.SS3.SSS2.p2" class="ltx_para">
<p id="S2.SS3.SSS2.p2.4" class="ltx_p">However, averaging among the shared parameters <math id="S2.SS3.SSS2.p2.1.m1.1" class="ltx_Math" alttext="u_{k}" display="inline"><semantics id="S2.SS3.SSS2.p2.1.m1.1a"><msub id="S2.SS3.SSS2.p2.1.m1.1.1" xref="S2.SS3.SSS2.p2.1.m1.1.1.cmml"><mi id="S2.SS3.SSS2.p2.1.m1.1.1.2" xref="S2.SS3.SSS2.p2.1.m1.1.1.2.cmml">u</mi><mi id="S2.SS3.SSS2.p2.1.m1.1.1.3" xref="S2.SS3.SSS2.p2.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.1.m1.1b"><apply id="S2.SS3.SSS2.p2.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.1.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p2.1.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1.2">𝑢</ci><ci id="S2.SS3.SSS2.p2.1.m1.1.1.3.cmml" xref="S2.SS3.SSS2.p2.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.1.m1.1c">u_{k}</annotation></semantics></math> only occurs across parameters for which the corresponding mask entry in <math id="S2.SS3.SSS2.p2.2.m2.1" class="ltx_Math" alttext="m_{k}" display="inline"><semantics id="S2.SS3.SSS2.p2.2.m2.1a"><msub id="S2.SS3.SSS2.p2.2.m2.1.1" xref="S2.SS3.SSS2.p2.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p2.2.m2.1.1.2" xref="S2.SS3.SSS2.p2.2.m2.1.1.2.cmml">m</mi><mi id="S2.SS3.SSS2.p2.2.m2.1.1.3" xref="S2.SS3.SSS2.p2.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.2.m2.1b"><apply id="S2.SS3.SSS2.p2.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p2.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.2">𝑚</ci><ci id="S2.SS3.SSS2.p2.2.m2.1.1.3.cmml" xref="S2.SS3.SSS2.p2.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.2.m2.1c">m_{k}</annotation></semantics></math> is 0. This ensures that only non-LTN parameters are averaged when client models have very different masks. We store a global mask <math id="S2.SS3.SSS2.p2.3.m3.1" class="ltx_Math" alttext="m_{G}" display="inline"><semantics id="S2.SS3.SSS2.p2.3.m3.1a"><msub id="S2.SS3.SSS2.p2.3.m3.1.1" xref="S2.SS3.SSS2.p2.3.m3.1.1.cmml"><mi id="S2.SS3.SSS2.p2.3.m3.1.1.2" xref="S2.SS3.SSS2.p2.3.m3.1.1.2.cmml">m</mi><mi id="S2.SS3.SSS2.p2.3.m3.1.1.3" xref="S2.SS3.SSS2.p2.3.m3.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.3.m3.1b"><apply id="S2.SS3.SSS2.p2.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.3.m3.1.1.1.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p2.3.m3.1.1.2.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1.2">𝑚</ci><ci id="S2.SS3.SSS2.p2.3.m3.1.1.3.cmml" xref="S2.SS3.SSS2.p2.3.m3.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.3.m3.1c">m_{G}</annotation></semantics></math> to facilitate updates for clients not sampled during FL. As communication rounds progress, we hypothesize that the global knowledge stored in <math id="S2.SS3.SSS2.p2.4.m4.1" class="ltx_Math" alttext="\theta_{G}^{t}\odot\neg m_{i}^{t}" display="inline"><semantics id="S2.SS3.SSS2.p2.4.m4.1a"><mrow id="S2.SS3.SSS2.p2.4.m4.1.1" xref="S2.SS3.SSS2.p2.4.m4.1.1.cmml"><msubsup id="S2.SS3.SSS2.p2.4.m4.1.1.2" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.cmml"><mi id="S2.SS3.SSS2.p2.4.m4.1.1.2.2.2" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.2.2.cmml">θ</mi><mi id="S2.SS3.SSS2.p2.4.m4.1.1.2.2.3" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.2.3.cmml">G</mi><mi id="S2.SS3.SSS2.p2.4.m4.1.1.2.3" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.3.cmml">t</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="S2.SS3.SSS2.p2.4.m4.1.1.1" xref="S2.SS3.SSS2.p2.4.m4.1.1.1.cmml">⊙</mo><mrow id="S2.SS3.SSS2.p2.4.m4.1.1.3" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.cmml"><mo rspace="0.167em" id="S2.SS3.SSS2.p2.4.m4.1.1.3.1" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.1.cmml">¬</mo><msubsup id="S2.SS3.SSS2.p2.4.m4.1.1.3.2" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2.cmml"><mi id="S2.SS3.SSS2.p2.4.m4.1.1.3.2.2.2" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2.2.2.cmml">m</mi><mi id="S2.SS3.SSS2.p2.4.m4.1.1.3.2.2.3" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2.2.3.cmml">i</mi><mi id="S2.SS3.SSS2.p2.4.m4.1.1.3.2.3" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2.3.cmml">t</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p2.4.m4.1b"><apply id="S2.SS3.SSS2.p2.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1"><csymbol cd="latexml" id="S2.SS3.SSS2.p2.4.m4.1.1.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.1">direct-product</csymbol><apply id="S2.SS3.SSS2.p2.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.4.m4.1.1.2.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2">superscript</csymbol><apply id="S2.SS3.SSS2.p2.4.m4.1.1.2.2.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.4.m4.1.1.2.2.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS3.SSS2.p2.4.m4.1.1.2.2.2.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.2.2">𝜃</ci><ci id="S2.SS3.SSS2.p2.4.m4.1.1.2.2.3.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.2.3">𝐺</ci></apply><ci id="S2.SS3.SSS2.p2.4.m4.1.1.2.3.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.2.3">𝑡</ci></apply><apply id="S2.SS3.SSS2.p2.4.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3"><not id="S2.SS3.SSS2.p2.4.m4.1.1.3.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.1"></not><apply id="S2.SS3.SSS2.p2.4.m4.1.1.3.2.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.4.m4.1.1.3.2.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2">superscript</csymbol><apply id="S2.SS3.SSS2.p2.4.m4.1.1.3.2.2.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p2.4.m4.1.1.3.2.2.1.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2">subscript</csymbol><ci id="S2.SS3.SSS2.p2.4.m4.1.1.3.2.2.2.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2.2.2">𝑚</ci><ci id="S2.SS3.SSS2.p2.4.m4.1.1.3.2.2.3.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2.2.3">𝑖</ci></apply><ci id="S2.SS3.SSS2.p2.4.m4.1.1.3.2.3.cmml" xref="S2.SS3.SSS2.p2.4.m4.1.1.3.2.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p2.4.m4.1c">\theta_{G}^{t}\odot\neg m_{i}^{t}</annotation></semantics></math> is refined, and that test accuracy due to personalization will converge.</p>
</div>
<div id="S2.SS3.SSS2.p3" class="ltx_para">
<p id="S2.SS3.SSS2.p3.7" class="ltx_p">An important hyperparameter of FedSelect is the personalization rate <math id="S2.SS3.SSS2.p3.1.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.SS3.SSS2.p3.1.m1.1a"><mi id="S2.SS3.SSS2.p3.1.m1.1.1" xref="S2.SS3.SSS2.p3.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.1.m1.1b"><ci id="S2.SS3.SSS2.p3.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p3.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.1.m1.1c">p</annotation></semantics></math>. For different client problem difficulties <cite class="ltx_cite ltx_citemacro_citep">(Hsieh et al., <a href="#bib.bib9" title="" class="ltx_ref">2020</a>)</cite>, the rate of personalization <math id="S2.SS3.SSS2.p3.2.m2.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.SS3.SSS2.p3.2.m2.1a"><mi id="S2.SS3.SSS2.p3.2.m2.1.1" xref="S2.SS3.SSS2.p3.2.m2.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.2.m2.1b"><ci id="S2.SS3.SSS2.p3.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p3.2.m2.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.2.m2.1c">p</annotation></semantics></math> may affect the level of test accuracy achieved. A nuance of our notation is that for a given <math id="S2.SS3.SSS2.p3.3.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.SS3.SSS2.p3.3.m3.1a"><mi id="S2.SS3.SSS2.p3.3.m3.1.1" xref="S2.SS3.SSS2.p3.3.m3.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.3.m3.1b"><ci id="S2.SS3.SSS2.p3.3.m3.1.1.cmml" xref="S2.SS3.SSS2.p3.3.m3.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.3.m3.1c">p</annotation></semantics></math>, <math id="S2.SS3.SSS2.p3.4.m4.1" class="ltx_Math" alttext="(1-p)\times 100\%" display="inline"><semantics id="S2.SS3.SSS2.p3.4.m4.1a"><mrow id="S2.SS3.SSS2.p3.4.m4.1.1" xref="S2.SS3.SSS2.p3.4.m4.1.1.cmml"><mrow id="S2.SS3.SSS2.p3.4.m4.1.1.1.1" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS3.SSS2.p3.4.m4.1.1.1.1.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.cmml"><mn id="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.cmml">1</mn><mo id="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.1" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.3.cmml">p</mi></mrow><mo rspace="0.055em" stretchy="false" id="S2.SS3.SSS2.p3.4.m4.1.1.1.1.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S2.SS3.SSS2.p3.4.m4.1.1.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.2.cmml">×</mo><mrow id="S2.SS3.SSS2.p3.4.m4.1.1.3" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.cmml"><mn id="S2.SS3.SSS2.p3.4.m4.1.1.3.2" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.2.cmml">100</mn><mo id="S2.SS3.SSS2.p3.4.m4.1.1.3.1" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.4.m4.1b"><apply id="S2.SS3.SSS2.p3.4.m4.1.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1"><times id="S2.SS3.SSS2.p3.4.m4.1.1.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.2"></times><apply id="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1"><minus id="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.1"></minus><cn type="integer" id="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.2">1</cn><ci id="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.3.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.1.1.1.3">𝑝</ci></apply><apply id="S2.SS3.SSS2.p3.4.m4.1.1.3.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3"><csymbol cd="latexml" id="S2.SS3.SSS2.p3.4.m4.1.1.3.1.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.1">percent</csymbol><cn type="integer" id="S2.SS3.SSS2.p3.4.m4.1.1.3.2.cmml" xref="S2.SS3.SSS2.p3.4.m4.1.1.3.2">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.4.m4.1c">(1-p)\times 100\%</annotation></semantics></math> parameters are frozen during each of GradLTN’s iterations. Therefore we let FedSelect (0.25) denote running FedSelect when 75% of parameters are frozen in each iteration of GradLTN. So, increasing <math id="S2.SS3.SSS2.p3.5.m5.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.SS3.SSS2.p3.5.m5.1a"><mi id="S2.SS3.SSS2.p3.5.m5.1.1" xref="S2.SS3.SSS2.p3.5.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.5.m5.1b"><ci id="S2.SS3.SSS2.p3.5.m5.1.1.cmml" xref="S2.SS3.SSS2.p3.5.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.5.m5.1c">p</annotation></semantics></math> corresponds to fewer frozen parameters and greater personalization. Additionally, since only <math id="S2.SS3.SSS2.p3.6.m6.1" class="ltx_Math" alttext="u_{k}" display="inline"><semantics id="S2.SS3.SSS2.p3.6.m6.1a"><msub id="S2.SS3.SSS2.p3.6.m6.1.1" xref="S2.SS3.SSS2.p3.6.m6.1.1.cmml"><mi id="S2.SS3.SSS2.p3.6.m6.1.1.2" xref="S2.SS3.SSS2.p3.6.m6.1.1.2.cmml">u</mi><mi id="S2.SS3.SSS2.p3.6.m6.1.1.3" xref="S2.SS3.SSS2.p3.6.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.6.m6.1b"><apply id="S2.SS3.SSS2.p3.6.m6.1.1.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p3.6.m6.1.1.1.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p3.6.m6.1.1.2.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.2">𝑢</ci><ci id="S2.SS3.SSS2.p3.6.m6.1.1.3.cmml" xref="S2.SS3.SSS2.p3.6.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.6.m6.1c">u_{k}</annotation></semantics></math> is communicated between the server and clients, a greater <math id="S2.SS3.SSS2.p3.7.m7.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.SS3.SSS2.p3.7.m7.1a"><mi id="S2.SS3.SSS2.p3.7.m7.1.1" xref="S2.SS3.SSS2.p3.7.m7.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p3.7.m7.1b"><ci id="S2.SS3.SSS2.p3.7.m7.1.1.cmml" xref="S2.SS3.SSS2.p3.7.m7.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p3.7.m7.1c">p</annotation></semantics></math> results in reduced communication costs.</p>
</div>
<div id="S2.SS3.SSS2.p4" class="ltx_para">
<p id="S2.SS3.SSS2.p4.2" class="ltx_p">A byproduct of GradLTN is that the subnetwork search process itself fine-tunes parameters in the final iterations of the algorithm, which could be valuable as an initialization for LocalAlt. Therefore, we aim to explore changing the returned values from GradLTN from <math id="S2.SS3.SSS2.p4.1.m1.1" class="ltx_Math" alttext="\theta_{0}" display="inline"><semantics id="S2.SS3.SSS2.p4.1.m1.1a"><msub id="S2.SS3.SSS2.p4.1.m1.1.1" xref="S2.SS3.SSS2.p4.1.m1.1.1.cmml"><mi id="S2.SS3.SSS2.p4.1.m1.1.1.2" xref="S2.SS3.SSS2.p4.1.m1.1.1.2.cmml">θ</mi><mn id="S2.SS3.SSS2.p4.1.m1.1.1.3" xref="S2.SS3.SSS2.p4.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.1.m1.1b"><apply id="S2.SS3.SSS2.p4.1.m1.1.1.cmml" xref="S2.SS3.SSS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.1.m1.1.1.1.cmml" xref="S2.SS3.SSS2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p4.1.m1.1.1.2.cmml" xref="S2.SS3.SSS2.p4.1.m1.1.1.2">𝜃</ci><cn type="integer" id="S2.SS3.SSS2.p4.1.m1.1.1.3.cmml" xref="S2.SS3.SSS2.p4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.1.m1.1c">\theta_{0}</annotation></semantics></math> to <math id="S2.SS3.SSS2.p4.2.m2.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.SS3.SSS2.p4.2.m2.1a"><msub id="S2.SS3.SSS2.p4.2.m2.1.1" xref="S2.SS3.SSS2.p4.2.m2.1.1.cmml"><mi id="S2.SS3.SSS2.p4.2.m2.1.1.2" xref="S2.SS3.SSS2.p4.2.m2.1.1.2.cmml">θ</mi><mi id="S2.SS3.SSS2.p4.2.m2.1.1.3" xref="S2.SS3.SSS2.p4.2.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS3.SSS2.p4.2.m2.1b"><apply id="S2.SS3.SSS2.p4.2.m2.1.1.cmml" xref="S2.SS3.SSS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS3.SSS2.p4.2.m2.1.1.1.cmml" xref="S2.SS3.SSS2.p4.2.m2.1.1">subscript</csymbol><ci id="S2.SS3.SSS2.p4.2.m2.1.1.2.cmml" xref="S2.SS3.SSS2.p4.2.m2.1.1.2">𝜃</ci><ci id="S2.SS3.SSS2.p4.2.m2.1.1.3.cmml" xref="S2.SS3.SSS2.p4.2.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS3.SSS2.p4.2.m2.1c">\theta_{L}</annotation></semantics></math> to incorporate this idea.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> FedSelect</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">  <span id="alg2.l1.1" class="ltx_text ltx_font_bold">Input:</span> <math id="alg2.l1.m1.7" class="ltx_Math" alttext="C=\{c_{1},\dots,c_{N}\},\theta_{G}^{0},K,R,L,p" display="inline"><semantics id="alg2.l1.m1.7a"><mrow id="alg2.l1.m1.7.7" xref="alg2.l1.m1.7.7.cmml"><mi id="alg2.l1.m1.7.7.4" xref="alg2.l1.m1.7.7.4.cmml">C</mi><mo id="alg2.l1.m1.7.7.3" xref="alg2.l1.m1.7.7.3.cmml">=</mo><mrow id="alg2.l1.m1.7.7.2.2" xref="alg2.l1.m1.7.7.2.3.cmml"><mrow id="alg2.l1.m1.6.6.1.1.1.2" xref="alg2.l1.m1.6.6.1.1.1.3.cmml"><mo stretchy="false" id="alg2.l1.m1.6.6.1.1.1.2.3" xref="alg2.l1.m1.6.6.1.1.1.3.cmml">{</mo><msub id="alg2.l1.m1.6.6.1.1.1.1.1" xref="alg2.l1.m1.6.6.1.1.1.1.1.cmml"><mi id="alg2.l1.m1.6.6.1.1.1.1.1.2" xref="alg2.l1.m1.6.6.1.1.1.1.1.2.cmml">c</mi><mn id="alg2.l1.m1.6.6.1.1.1.1.1.3" xref="alg2.l1.m1.6.6.1.1.1.1.1.3.cmml">1</mn></msub><mo id="alg2.l1.m1.6.6.1.1.1.2.4" xref="alg2.l1.m1.6.6.1.1.1.3.cmml">,</mo><mi mathvariant="normal" id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">…</mi><mo id="alg2.l1.m1.6.6.1.1.1.2.5" xref="alg2.l1.m1.6.6.1.1.1.3.cmml">,</mo><msub id="alg2.l1.m1.6.6.1.1.1.2.2" xref="alg2.l1.m1.6.6.1.1.1.2.2.cmml"><mi id="alg2.l1.m1.6.6.1.1.1.2.2.2" xref="alg2.l1.m1.6.6.1.1.1.2.2.2.cmml">c</mi><mi id="alg2.l1.m1.6.6.1.1.1.2.2.3" xref="alg2.l1.m1.6.6.1.1.1.2.2.3.cmml">N</mi></msub><mo stretchy="false" id="alg2.l1.m1.6.6.1.1.1.2.6" xref="alg2.l1.m1.6.6.1.1.1.3.cmml">}</mo></mrow><mo id="alg2.l1.m1.7.7.2.2.3" xref="alg2.l1.m1.7.7.2.3.cmml">,</mo><msubsup id="alg2.l1.m1.7.7.2.2.2" xref="alg2.l1.m1.7.7.2.2.2.cmml"><mi id="alg2.l1.m1.7.7.2.2.2.2.2" xref="alg2.l1.m1.7.7.2.2.2.2.2.cmml">θ</mi><mi id="alg2.l1.m1.7.7.2.2.2.2.3" xref="alg2.l1.m1.7.7.2.2.2.2.3.cmml">G</mi><mn id="alg2.l1.m1.7.7.2.2.2.3" xref="alg2.l1.m1.7.7.2.2.2.3.cmml">0</mn></msubsup><mo id="alg2.l1.m1.7.7.2.2.4" xref="alg2.l1.m1.7.7.2.3.cmml">,</mo><mi id="alg2.l1.m1.2.2" xref="alg2.l1.m1.2.2.cmml">K</mi><mo id="alg2.l1.m1.7.7.2.2.5" xref="alg2.l1.m1.7.7.2.3.cmml">,</mo><mi id="alg2.l1.m1.3.3" xref="alg2.l1.m1.3.3.cmml">R</mi><mo id="alg2.l1.m1.7.7.2.2.6" xref="alg2.l1.m1.7.7.2.3.cmml">,</mo><mi id="alg2.l1.m1.4.4" xref="alg2.l1.m1.4.4.cmml">L</mi><mo id="alg2.l1.m1.7.7.2.2.7" xref="alg2.l1.m1.7.7.2.3.cmml">,</mo><mi id="alg2.l1.m1.5.5" xref="alg2.l1.m1.5.5.cmml">p</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.7b"><apply id="alg2.l1.m1.7.7.cmml" xref="alg2.l1.m1.7.7"><eq id="alg2.l1.m1.7.7.3.cmml" xref="alg2.l1.m1.7.7.3"></eq><ci id="alg2.l1.m1.7.7.4.cmml" xref="alg2.l1.m1.7.7.4">𝐶</ci><list id="alg2.l1.m1.7.7.2.3.cmml" xref="alg2.l1.m1.7.7.2.2"><set id="alg2.l1.m1.6.6.1.1.1.3.cmml" xref="alg2.l1.m1.6.6.1.1.1.2"><apply id="alg2.l1.m1.6.6.1.1.1.1.1.cmml" xref="alg2.l1.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.6.6.1.1.1.1.1.1.cmml" xref="alg2.l1.m1.6.6.1.1.1.1.1">subscript</csymbol><ci id="alg2.l1.m1.6.6.1.1.1.1.1.2.cmml" xref="alg2.l1.m1.6.6.1.1.1.1.1.2">𝑐</ci><cn type="integer" id="alg2.l1.m1.6.6.1.1.1.1.1.3.cmml" xref="alg2.l1.m1.6.6.1.1.1.1.1.3">1</cn></apply><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">…</ci><apply id="alg2.l1.m1.6.6.1.1.1.2.2.cmml" xref="alg2.l1.m1.6.6.1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.6.6.1.1.1.2.2.1.cmml" xref="alg2.l1.m1.6.6.1.1.1.2.2">subscript</csymbol><ci id="alg2.l1.m1.6.6.1.1.1.2.2.2.cmml" xref="alg2.l1.m1.6.6.1.1.1.2.2.2">𝑐</ci><ci id="alg2.l1.m1.6.6.1.1.1.2.2.3.cmml" xref="alg2.l1.m1.6.6.1.1.1.2.2.3">𝑁</ci></apply></set><apply id="alg2.l1.m1.7.7.2.2.2.cmml" xref="alg2.l1.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.7.7.2.2.2.1.cmml" xref="alg2.l1.m1.7.7.2.2.2">superscript</csymbol><apply id="alg2.l1.m1.7.7.2.2.2.2.cmml" xref="alg2.l1.m1.7.7.2.2.2"><csymbol cd="ambiguous" id="alg2.l1.m1.7.7.2.2.2.2.1.cmml" xref="alg2.l1.m1.7.7.2.2.2">subscript</csymbol><ci id="alg2.l1.m1.7.7.2.2.2.2.2.cmml" xref="alg2.l1.m1.7.7.2.2.2.2.2">𝜃</ci><ci id="alg2.l1.m1.7.7.2.2.2.2.3.cmml" xref="alg2.l1.m1.7.7.2.2.2.2.3">𝐺</ci></apply><cn type="integer" id="alg2.l1.m1.7.7.2.2.2.3.cmml" xref="alg2.l1.m1.7.7.2.2.2.3">0</cn></apply><ci id="alg2.l1.m1.2.2.cmml" xref="alg2.l1.m1.2.2">𝐾</ci><ci id="alg2.l1.m1.3.3.cmml" xref="alg2.l1.m1.3.3">𝑅</ci><ci id="alg2.l1.m1.4.4.cmml" xref="alg2.l1.m1.4.4">𝐿</ci><ci id="alg2.l1.m1.5.5.cmml" xref="alg2.l1.m1.5.5">𝑝</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.7c">C=\{c_{1},\dots,c_{N}\},\theta_{G}^{0},K,R,L,p</annotation></semantics></math>

</div>
<div id="alg2.l2" class="ltx_listingline">  <span id="alg2.l2.1" class="ltx_text ltx_font_bold">Server Executes:</span>




</div>
<div id="alg2.l3" class="ltx_listingline">     <math id="alg2.l3.m1.3" class="ltx_Math" alttext="k\leftarrow\max\{{N\cdot K,1}\}" display="inline"><semantics id="alg2.l3.m1.3a"><mrow id="alg2.l3.m1.3.3" xref="alg2.l3.m1.3.3.cmml"><mi id="alg2.l3.m1.3.3.3" xref="alg2.l3.m1.3.3.3.cmml">k</mi><mo stretchy="false" id="alg2.l3.m1.3.3.2" xref="alg2.l3.m1.3.3.2.cmml">←</mo><mrow id="alg2.l3.m1.3.3.1.1" xref="alg2.l3.m1.3.3.1.2.cmml"><mi id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">max</mi><mo id="alg2.l3.m1.3.3.1.1a" xref="alg2.l3.m1.3.3.1.2.cmml">⁡</mo><mrow id="alg2.l3.m1.3.3.1.1.1" xref="alg2.l3.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg2.l3.m1.3.3.1.1.1.2" xref="alg2.l3.m1.3.3.1.2.cmml">{</mo><mrow id="alg2.l3.m1.3.3.1.1.1.1" xref="alg2.l3.m1.3.3.1.1.1.1.cmml"><mi id="alg2.l3.m1.3.3.1.1.1.1.2" xref="alg2.l3.m1.3.3.1.1.1.1.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l3.m1.3.3.1.1.1.1.1" xref="alg2.l3.m1.3.3.1.1.1.1.1.cmml">⋅</mo><mi id="alg2.l3.m1.3.3.1.1.1.1.3" xref="alg2.l3.m1.3.3.1.1.1.1.3.cmml">K</mi></mrow><mo id="alg2.l3.m1.3.3.1.1.1.3" xref="alg2.l3.m1.3.3.1.2.cmml">,</mo><mn id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml">1</mn><mo stretchy="false" id="alg2.l3.m1.3.3.1.1.1.4" xref="alg2.l3.m1.3.3.1.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.3b"><apply id="alg2.l3.m1.3.3.cmml" xref="alg2.l3.m1.3.3"><ci id="alg2.l3.m1.3.3.2.cmml" xref="alg2.l3.m1.3.3.2">←</ci><ci id="alg2.l3.m1.3.3.3.cmml" xref="alg2.l3.m1.3.3.3">𝑘</ci><apply id="alg2.l3.m1.3.3.1.2.cmml" xref="alg2.l3.m1.3.3.1.1"><max id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"></max><apply id="alg2.l3.m1.3.3.1.1.1.1.cmml" xref="alg2.l3.m1.3.3.1.1.1.1"><ci id="alg2.l3.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l3.m1.3.3.1.1.1.1.1">⋅</ci><ci id="alg2.l3.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l3.m1.3.3.1.1.1.1.2">𝑁</ci><ci id="alg2.l3.m1.3.3.1.1.1.1.3.cmml" xref="alg2.l3.m1.3.3.1.1.1.1.3">𝐾</ci></apply><cn type="integer" id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.3c">k\leftarrow\max\{{N\cdot K,1}\}</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">     Initialize all client models <math id="alg2.l4.m1.1" class="ltx_Math" alttext="\{\theta_{i}^{0}\}_{i=1}^{N}" display="inline"><semantics id="alg2.l4.m1.1a"><msubsup id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mrow id="alg2.l4.m1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l4.m1.1.1.1.1.1.2" xref="alg2.l4.m1.1.1.1.1.2.cmml">{</mo><msubsup id="alg2.l4.m1.1.1.1.1.1.1" xref="alg2.l4.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l4.m1.1.1.1.1.1.1.2.2" xref="alg2.l4.m1.1.1.1.1.1.1.2.2.cmml">θ</mi><mi id="alg2.l4.m1.1.1.1.1.1.1.2.3" xref="alg2.l4.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mn id="alg2.l4.m1.1.1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.1.1.3.cmml">0</mn></msubsup><mo stretchy="false" id="alg2.l4.m1.1.1.1.1.1.3" xref="alg2.l4.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l4.m1.1.1.1.3" xref="alg2.l4.m1.1.1.1.3.cmml"><mi id="alg2.l4.m1.1.1.1.3.2" xref="alg2.l4.m1.1.1.1.3.2.cmml">i</mi><mo id="alg2.l4.m1.1.1.1.3.1" xref="alg2.l4.m1.1.1.1.3.1.cmml">=</mo><mn id="alg2.l4.m1.1.1.1.3.3" xref="alg2.l4.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">N</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1">superscript</csymbol><apply id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1">subscript</csymbol><set id="alg2.l4.m1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.1"><apply id="alg2.l4.m1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l4.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l4.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l4.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l4.m1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.2.2">𝜃</ci><ci id="alg2.l4.m1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><cn type="integer" id="alg2.l4.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.1.1.1.3">0</cn></apply></set><apply id="alg2.l4.m1.1.1.1.3.cmml" xref="alg2.l4.m1.1.1.1.3"><eq id="alg2.l4.m1.1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.1.3.1"></eq><ci id="alg2.l4.m1.1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.1.3.2">𝑖</ci><cn type="integer" id="alg2.l4.m1.1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.1.3.3">1</cn></apply></apply><ci id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">𝑁</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\{\theta_{i}^{0}\}_{i=1}^{N}</annotation></semantics></math> with <math id="alg2.l4.m2.1" class="ltx_Math" alttext="\theta_{G}^{0}" display="inline"><semantics id="alg2.l4.m2.1a"><msubsup id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml"><mi id="alg2.l4.m2.1.1.2.2" xref="alg2.l4.m2.1.1.2.2.cmml">θ</mi><mi id="alg2.l4.m2.1.1.2.3" xref="alg2.l4.m2.1.1.2.3.cmml">G</mi><mn id="alg2.l4.m2.1.1.3" xref="alg2.l4.m2.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><apply id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.1.cmml" xref="alg2.l4.m2.1.1">superscript</csymbol><apply id="alg2.l4.m2.1.1.2.cmml" xref="alg2.l4.m2.1.1"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.2.1.cmml" xref="alg2.l4.m2.1.1">subscript</csymbol><ci id="alg2.l4.m2.1.1.2.2.cmml" xref="alg2.l4.m2.1.1.2.2">𝜃</ci><ci id="alg2.l4.m2.1.1.2.3.cmml" xref="alg2.l4.m2.1.1.2.3">𝐺</ci></apply><cn type="integer" id="alg2.l4.m2.1.1.3.cmml" xref="alg2.l4.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">\theta_{G}^{0}</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">     <span id="alg2.l5.1" class="ltx_text ltx_font_bold">for</span> each round <math id="alg2.l5.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg2.l5.m1.1a"><mi id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><ci id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">t</annotation></semantics></math> in <math id="alg2.l5.m2.4" class="ltx_Math" alttext="1,2,\dots,R" display="inline"><semantics id="alg2.l5.m2.4a"><mrow id="alg2.l5.m2.4.5.2" xref="alg2.l5.m2.4.5.1.cmml"><mn id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml">1</mn><mo id="alg2.l5.m2.4.5.2.1" xref="alg2.l5.m2.4.5.1.cmml">,</mo><mn id="alg2.l5.m2.2.2" xref="alg2.l5.m2.2.2.cmml">2</mn><mo id="alg2.l5.m2.4.5.2.2" xref="alg2.l5.m2.4.5.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l5.m2.3.3" xref="alg2.l5.m2.3.3.cmml">…</mi><mo id="alg2.l5.m2.4.5.2.3" xref="alg2.l5.m2.4.5.1.cmml">,</mo><mi id="alg2.l5.m2.4.4" xref="alg2.l5.m2.4.4.cmml">R</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.4b"><list id="alg2.l5.m2.4.5.1.cmml" xref="alg2.l5.m2.4.5.2"><cn type="integer" id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">1</cn><cn type="integer" id="alg2.l5.m2.2.2.cmml" xref="alg2.l5.m2.2.2">2</cn><ci id="alg2.l5.m2.3.3.cmml" xref="alg2.l5.m2.3.3">…</ci><ci id="alg2.l5.m2.4.4.cmml" xref="alg2.l5.m2.4.4">𝑅</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.4c">1,2,\dots,R</annotation></semantics></math> <span id="alg2.l5.2" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l6" class="ltx_listingline">        <math id="alg2.l6.m1.1" class="ltx_Math" alttext="S_{t}\leftarrow" display="inline"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><msub id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml"><mi id="alg2.l6.m1.1.1.2.2" xref="alg2.l6.m1.1.1.2.2.cmml">S</mi><mi id="alg2.l6.m1.1.1.2.3" xref="alg2.l6.m1.1.1.2.3.cmml">t</mi></msub><mo stretchy="false" id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml">←</mo><mi id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><ci id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1">←</ci><apply id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.2">subscript</csymbol><ci id="alg2.l6.m1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.2.2">𝑆</ci><ci id="alg2.l6.m1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">S_{t}\leftarrow</annotation></semantics></math> random sample of <math id="alg2.l6.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="alg2.l6.m2.1a"><mi id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><ci id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">k</annotation></semantics></math> clients from <math id="alg2.l6.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg2.l6.m3.1a"><mi id="alg2.l6.m3.1.1" xref="alg2.l6.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m3.1b"><ci id="alg2.l6.m3.1.1.cmml" xref="alg2.l6.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m3.1c">C</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">        <span id="alg2.l7.1" class="ltx_text ltx_font_bold">for</span> each client <math id="alg2.l7.m1.1" class="ltx_Math" alttext="c_{k}\in S_{t}" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><msub id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml"><mi id="alg2.l7.m1.1.1.2.2" xref="alg2.l7.m1.1.1.2.2.cmml">c</mi><mi id="alg2.l7.m1.1.1.2.3" xref="alg2.l7.m1.1.1.2.3.cmml">k</mi></msub><mo id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml">∈</mo><msub id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml"><mi id="alg2.l7.m1.1.1.3.2" xref="alg2.l7.m1.1.1.3.2.cmml">S</mi><mi id="alg2.l7.m1.1.1.3.3" xref="alg2.l7.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><in id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"></in><apply id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.2.1.cmml" xref="alg2.l7.m1.1.1.2">subscript</csymbol><ci id="alg2.l7.m1.1.1.2.2.cmml" xref="alg2.l7.m1.1.1.2.2">𝑐</ci><ci id="alg2.l7.m1.1.1.2.3.cmml" xref="alg2.l7.m1.1.1.2.3">𝑘</ci></apply><apply id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.3">subscript</csymbol><ci id="alg2.l7.m1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.3.2">𝑆</ci><ci id="alg2.l7.m1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">c_{k}\in S_{t}</annotation></semantics></math> <span id="alg2.l7.2" class="ltx_text ltx_font_bold">in parallel</span> <span id="alg2.l7.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l8" class="ltx_listingline">           <span id="alg2.l8.1" class="ltx_text ltx_font_italic" style="color:#008080;"># Executed locally on client <math id="alg2.l8.1.m1.1" class="ltx_Math" alttext="c_{k}" display="inline"><semantics id="alg2.l8.1.m1.1a"><msub id="alg2.l8.1.m1.1.1" xref="alg2.l8.1.m1.1.1.cmml"><mi mathcolor="#008080" id="alg2.l8.1.m1.1.1.2" xref="alg2.l8.1.m1.1.1.2.cmml">c</mi><mi mathcolor="#008080" id="alg2.l8.1.m1.1.1.3" xref="alg2.l8.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l8.1.m1.1b"><apply id="alg2.l8.1.m1.1.1.cmml" xref="alg2.l8.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l8.1.m1.1.1.1.cmml" xref="alg2.l8.1.m1.1.1">subscript</csymbol><ci id="alg2.l8.1.m1.1.1.2.cmml" xref="alg2.l8.1.m1.1.1.2">𝑐</ci><ci id="alg2.l8.1.m1.1.1.3.cmml" xref="alg2.l8.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.1.m1.1c">c_{k}</annotation></semantics></math></span>

</div>
<div id="alg2.l9" class="ltx_listingline">           <math id="alg2.l9.m1.3" class="ltx_Math" alttext="u_{k}^{t},v_{k}^{t},m_{k}^{t}\leftarrow" display="inline"><semantics id="alg2.l9.m1.3a"><mrow id="alg2.l9.m1.3.3" xref="alg2.l9.m1.3.3.cmml"><mrow id="alg2.l9.m1.3.3.3.3" xref="alg2.l9.m1.3.3.3.4.cmml"><msubsup id="alg2.l9.m1.1.1.1.1.1" xref="alg2.l9.m1.1.1.1.1.1.cmml"><mi id="alg2.l9.m1.1.1.1.1.1.2.2" xref="alg2.l9.m1.1.1.1.1.1.2.2.cmml">u</mi><mi id="alg2.l9.m1.1.1.1.1.1.2.3" xref="alg2.l9.m1.1.1.1.1.1.2.3.cmml">k</mi><mi id="alg2.l9.m1.1.1.1.1.1.3" xref="alg2.l9.m1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo id="alg2.l9.m1.3.3.3.3.4" xref="alg2.l9.m1.3.3.3.4.cmml">,</mo><msubsup id="alg2.l9.m1.2.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.2.cmml"><mi id="alg2.l9.m1.2.2.2.2.2.2.2" xref="alg2.l9.m1.2.2.2.2.2.2.2.cmml">v</mi><mi id="alg2.l9.m1.2.2.2.2.2.2.3" xref="alg2.l9.m1.2.2.2.2.2.2.3.cmml">k</mi><mi id="alg2.l9.m1.2.2.2.2.2.3" xref="alg2.l9.m1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="alg2.l9.m1.3.3.3.3.5" xref="alg2.l9.m1.3.3.3.4.cmml">,</mo><msubsup id="alg2.l9.m1.3.3.3.3.3" xref="alg2.l9.m1.3.3.3.3.3.cmml"><mi id="alg2.l9.m1.3.3.3.3.3.2.2" xref="alg2.l9.m1.3.3.3.3.3.2.2.cmml">m</mi><mi id="alg2.l9.m1.3.3.3.3.3.2.3" xref="alg2.l9.m1.3.3.3.3.3.2.3.cmml">k</mi><mi id="alg2.l9.m1.3.3.3.3.3.3" xref="alg2.l9.m1.3.3.3.3.3.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="alg2.l9.m1.3.3.4" xref="alg2.l9.m1.3.3.4.cmml">←</mo><mi id="alg2.l9.m1.3.3.5" xref="alg2.l9.m1.3.3.5.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.3b"><apply id="alg2.l9.m1.3.3.cmml" xref="alg2.l9.m1.3.3"><ci id="alg2.l9.m1.3.3.4.cmml" xref="alg2.l9.m1.3.3.4">←</ci><list id="alg2.l9.m1.3.3.3.4.cmml" xref="alg2.l9.m1.3.3.3.3"><apply id="alg2.l9.m1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l9.m1.1.1.1.1.1.2.cmml" xref="alg2.l9.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l9.m1.1.1.1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.1.1.1.2.2">𝑢</ci><ci id="alg2.l9.m1.1.1.1.1.1.2.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg2.l9.m1.1.1.1.1.1.3.cmml" xref="alg2.l9.m1.1.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.l9.m1.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.2">superscript</csymbol><apply id="alg2.l9.m1.2.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l9.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l9.m1.2.2.2.2.2">subscript</csymbol><ci id="alg2.l9.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.2">𝑣</ci><ci id="alg2.l9.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="alg2.l9.m1.2.2.2.2.2.3.cmml" xref="alg2.l9.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="alg2.l9.m1.3.3.3.3.3.cmml" xref="alg2.l9.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l9.m1.3.3.3.3.3.1.cmml" xref="alg2.l9.m1.3.3.3.3.3">superscript</csymbol><apply id="alg2.l9.m1.3.3.3.3.3.2.cmml" xref="alg2.l9.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="alg2.l9.m1.3.3.3.3.3.2.1.cmml" xref="alg2.l9.m1.3.3.3.3.3">subscript</csymbol><ci id="alg2.l9.m1.3.3.3.3.3.2.2.cmml" xref="alg2.l9.m1.3.3.3.3.3.2.2">𝑚</ci><ci id="alg2.l9.m1.3.3.3.3.3.2.3.cmml" xref="alg2.l9.m1.3.3.3.3.3.2.3">𝑘</ci></apply><ci id="alg2.l9.m1.3.3.3.3.3.3.cmml" xref="alg2.l9.m1.3.3.3.3.3.3">𝑡</ci></apply></list><csymbol cd="latexml" id="alg2.l9.m1.3.3.5.cmml" xref="alg2.l9.m1.3.3.5">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.3c">u_{k}^{t},v_{k}^{t},m_{k}^{t}\leftarrow</annotation></semantics></math> GradLTN(<math id="alg2.l9.m2.3" class="ltx_Math" alttext="\theta_{k}^{t-1},L,1-p" display="inline"><semantics id="alg2.l9.m2.3a"><mrow id="alg2.l9.m2.3.3.2" xref="alg2.l9.m2.3.3.3.cmml"><msubsup id="alg2.l9.m2.2.2.1.1" xref="alg2.l9.m2.2.2.1.1.cmml"><mi id="alg2.l9.m2.2.2.1.1.2.2" xref="alg2.l9.m2.2.2.1.1.2.2.cmml">θ</mi><mi id="alg2.l9.m2.2.2.1.1.2.3" xref="alg2.l9.m2.2.2.1.1.2.3.cmml">k</mi><mrow id="alg2.l9.m2.2.2.1.1.3" xref="alg2.l9.m2.2.2.1.1.3.cmml"><mi id="alg2.l9.m2.2.2.1.1.3.2" xref="alg2.l9.m2.2.2.1.1.3.2.cmml">t</mi><mo id="alg2.l9.m2.2.2.1.1.3.1" xref="alg2.l9.m2.2.2.1.1.3.1.cmml">−</mo><mn id="alg2.l9.m2.2.2.1.1.3.3" xref="alg2.l9.m2.2.2.1.1.3.3.cmml">1</mn></mrow></msubsup><mo id="alg2.l9.m2.3.3.2.3" xref="alg2.l9.m2.3.3.3.cmml">,</mo><mi id="alg2.l9.m2.1.1" xref="alg2.l9.m2.1.1.cmml">L</mi><mo id="alg2.l9.m2.3.3.2.4" xref="alg2.l9.m2.3.3.3.cmml">,</mo><mrow id="alg2.l9.m2.3.3.2.2" xref="alg2.l9.m2.3.3.2.2.cmml"><mn id="alg2.l9.m2.3.3.2.2.2" xref="alg2.l9.m2.3.3.2.2.2.cmml">1</mn><mo id="alg2.l9.m2.3.3.2.2.1" xref="alg2.l9.m2.3.3.2.2.1.cmml">−</mo><mi id="alg2.l9.m2.3.3.2.2.3" xref="alg2.l9.m2.3.3.2.2.3.cmml">p</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.3b"><list id="alg2.l9.m2.3.3.3.cmml" xref="alg2.l9.m2.3.3.2"><apply id="alg2.l9.m2.2.2.1.1.cmml" xref="alg2.l9.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l9.m2.2.2.1.1.1.cmml" xref="alg2.l9.m2.2.2.1.1">superscript</csymbol><apply id="alg2.l9.m2.2.2.1.1.2.cmml" xref="alg2.l9.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l9.m2.2.2.1.1.2.1.cmml" xref="alg2.l9.m2.2.2.1.1">subscript</csymbol><ci id="alg2.l9.m2.2.2.1.1.2.2.cmml" xref="alg2.l9.m2.2.2.1.1.2.2">𝜃</ci><ci id="alg2.l9.m2.2.2.1.1.2.3.cmml" xref="alg2.l9.m2.2.2.1.1.2.3">𝑘</ci></apply><apply id="alg2.l9.m2.2.2.1.1.3.cmml" xref="alg2.l9.m2.2.2.1.1.3"><minus id="alg2.l9.m2.2.2.1.1.3.1.cmml" xref="alg2.l9.m2.2.2.1.1.3.1"></minus><ci id="alg2.l9.m2.2.2.1.1.3.2.cmml" xref="alg2.l9.m2.2.2.1.1.3.2">𝑡</ci><cn type="integer" id="alg2.l9.m2.2.2.1.1.3.3.cmml" xref="alg2.l9.m2.2.2.1.1.3.3">1</cn></apply></apply><ci id="alg2.l9.m2.1.1.cmml" xref="alg2.l9.m2.1.1">𝐿</ci><apply id="alg2.l9.m2.3.3.2.2.cmml" xref="alg2.l9.m2.3.3.2.2"><minus id="alg2.l9.m2.3.3.2.2.1.cmml" xref="alg2.l9.m2.3.3.2.2.1"></minus><cn type="integer" id="alg2.l9.m2.3.3.2.2.2.cmml" xref="alg2.l9.m2.3.3.2.2.2">1</cn><ci id="alg2.l9.m2.3.3.2.2.3.cmml" xref="alg2.l9.m2.3.3.2.2.3">𝑝</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.3c">\theta_{k}^{t-1},L,1-p</annotation></semantics></math>)

</div>
<div id="alg2.l10" class="ltx_listingline">           <math id="alg2.l10.m1.2" class="ltx_Math" alttext="{u_{k}^{t}}^{+},{v_{k}^{t}}^{+}\leftarrow" display="inline"><semantics id="alg2.l10.m1.2a"><mrow id="alg2.l10.m1.2.2" xref="alg2.l10.m1.2.2.cmml"><mrow id="alg2.l10.m1.2.2.2.2" xref="alg2.l10.m1.2.2.2.3.cmml"><mmultiscripts id="alg2.l10.m1.1.1.1.1.1" xref="alg2.l10.m1.1.1.1.1.1.cmml"><mi id="alg2.l10.m1.1.1.1.1.1.2.2.2" xref="alg2.l10.m1.1.1.1.1.1.2.2.2.cmml">u</mi><mi id="alg2.l10.m1.1.1.1.1.1.2.2.3" xref="alg2.l10.m1.1.1.1.1.1.2.2.3.cmml">k</mi><mi id="alg2.l10.m1.1.1.1.1.1.2.3" xref="alg2.l10.m1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="alg2.l10.m1.1.1.1.1.1a" xref="alg2.l10.m1.1.1.1.1.1.cmml"></mrow><mo id="alg2.l10.m1.1.1.1.1.1.3" xref="alg2.l10.m1.1.1.1.1.1.3.cmml">+</mo></mmultiscripts><mo id="alg2.l10.m1.2.2.2.2.3" xref="alg2.l10.m1.2.2.2.3.cmml">,</mo><mmultiscripts id="alg2.l10.m1.2.2.2.2.2" xref="alg2.l10.m1.2.2.2.2.2.cmml"><mi id="alg2.l10.m1.2.2.2.2.2.2.2.2" xref="alg2.l10.m1.2.2.2.2.2.2.2.2.cmml">v</mi><mi id="alg2.l10.m1.2.2.2.2.2.2.2.3" xref="alg2.l10.m1.2.2.2.2.2.2.2.3.cmml">k</mi><mi id="alg2.l10.m1.2.2.2.2.2.2.3" xref="alg2.l10.m1.2.2.2.2.2.2.3.cmml">t</mi><mrow id="alg2.l10.m1.2.2.2.2.2a" xref="alg2.l10.m1.2.2.2.2.2.cmml"></mrow><mo id="alg2.l10.m1.2.2.2.2.2.3" xref="alg2.l10.m1.2.2.2.2.2.3.cmml">+</mo></mmultiscripts></mrow><mo stretchy="false" id="alg2.l10.m1.2.2.3" xref="alg2.l10.m1.2.2.3.cmml">←</mo><mi id="alg2.l10.m1.2.2.4" xref="alg2.l10.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.2b"><apply id="alg2.l10.m1.2.2.cmml" xref="alg2.l10.m1.2.2"><ci id="alg2.l10.m1.2.2.3.cmml" xref="alg2.l10.m1.2.2.3">←</ci><list id="alg2.l10.m1.2.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.2"><apply id="alg2.l10.m1.1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l10.m1.1.1.1.1.1.2.cmml" xref="alg2.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.1.1.2.1.cmml" xref="alg2.l10.m1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l10.m1.1.1.1.1.1.2.2.cmml" xref="alg2.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.1.1.1.2.2.1.cmml" xref="alg2.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l10.m1.1.1.1.1.1.2.2.2.cmml" xref="alg2.l10.m1.1.1.1.1.1.2.2.2">𝑢</ci><ci id="alg2.l10.m1.1.1.1.1.1.2.2.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.2.2.3">𝑘</ci></apply><ci id="alg2.l10.m1.1.1.1.1.1.2.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.2.3">𝑡</ci></apply><plus id="alg2.l10.m1.1.1.1.1.1.3.cmml" xref="alg2.l10.m1.1.1.1.1.1.3"></plus></apply><apply id="alg2.l10.m1.2.2.2.2.2.cmml" xref="alg2.l10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l10.m1.2.2.2.2.2.1.cmml" xref="alg2.l10.m1.2.2.2.2.2">superscript</csymbol><apply id="alg2.l10.m1.2.2.2.2.2.2.cmml" xref="alg2.l10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l10.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l10.m1.2.2.2.2.2">superscript</csymbol><apply id="alg2.l10.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l10.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l10.m1.2.2.2.2.2.2.2.1.cmml" xref="alg2.l10.m1.2.2.2.2.2">subscript</csymbol><ci id="alg2.l10.m1.2.2.2.2.2.2.2.2.cmml" xref="alg2.l10.m1.2.2.2.2.2.2.2.2">𝑣</ci><ci id="alg2.l10.m1.2.2.2.2.2.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.2.2.2.2.3">𝑘</ci></apply><ci id="alg2.l10.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.2.2.2.3">𝑡</ci></apply><plus id="alg2.l10.m1.2.2.2.2.2.3.cmml" xref="alg2.l10.m1.2.2.2.2.2.3"></plus></apply></list><csymbol cd="latexml" id="alg2.l10.m1.2.2.4.cmml" xref="alg2.l10.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.2c">{u_{k}^{t}}^{+},{v_{k}^{t}}^{+}\leftarrow</annotation></semantics></math> LocalAlt(<math id="alg2.l10.m2.2" class="ltx_Math" alttext="u_{k}^{t},v_{k}^{t}" display="inline"><semantics id="alg2.l10.m2.2a"><mrow id="alg2.l10.m2.2.2.2" xref="alg2.l10.m2.2.2.3.cmml"><msubsup id="alg2.l10.m2.1.1.1.1" xref="alg2.l10.m2.1.1.1.1.cmml"><mi id="alg2.l10.m2.1.1.1.1.2.2" xref="alg2.l10.m2.1.1.1.1.2.2.cmml">u</mi><mi id="alg2.l10.m2.1.1.1.1.2.3" xref="alg2.l10.m2.1.1.1.1.2.3.cmml">k</mi><mi id="alg2.l10.m2.1.1.1.1.3" xref="alg2.l10.m2.1.1.1.1.3.cmml">t</mi></msubsup><mo id="alg2.l10.m2.2.2.2.3" xref="alg2.l10.m2.2.2.3.cmml">,</mo><msubsup id="alg2.l10.m2.2.2.2.2" xref="alg2.l10.m2.2.2.2.2.cmml"><mi id="alg2.l10.m2.2.2.2.2.2.2" xref="alg2.l10.m2.2.2.2.2.2.2.cmml">v</mi><mi id="alg2.l10.m2.2.2.2.2.2.3" xref="alg2.l10.m2.2.2.2.2.2.3.cmml">k</mi><mi id="alg2.l10.m2.2.2.2.2.3" xref="alg2.l10.m2.2.2.2.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m2.2b"><list id="alg2.l10.m2.2.2.3.cmml" xref="alg2.l10.m2.2.2.2"><apply id="alg2.l10.m2.1.1.1.1.cmml" xref="alg2.l10.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m2.1.1.1.1.1.cmml" xref="alg2.l10.m2.1.1.1.1">superscript</csymbol><apply id="alg2.l10.m2.1.1.1.1.2.cmml" xref="alg2.l10.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m2.1.1.1.1.2.1.cmml" xref="alg2.l10.m2.1.1.1.1">subscript</csymbol><ci id="alg2.l10.m2.1.1.1.1.2.2.cmml" xref="alg2.l10.m2.1.1.1.1.2.2">𝑢</ci><ci id="alg2.l10.m2.1.1.1.1.2.3.cmml" xref="alg2.l10.m2.1.1.1.1.2.3">𝑘</ci></apply><ci id="alg2.l10.m2.1.1.1.1.3.cmml" xref="alg2.l10.m2.1.1.1.1.3">𝑡</ci></apply><apply id="alg2.l10.m2.2.2.2.2.cmml" xref="alg2.l10.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l10.m2.2.2.2.2.1.cmml" xref="alg2.l10.m2.2.2.2.2">superscript</csymbol><apply id="alg2.l10.m2.2.2.2.2.2.cmml" xref="alg2.l10.m2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l10.m2.2.2.2.2.2.1.cmml" xref="alg2.l10.m2.2.2.2.2">subscript</csymbol><ci id="alg2.l10.m2.2.2.2.2.2.2.cmml" xref="alg2.l10.m2.2.2.2.2.2.2">𝑣</ci><ci id="alg2.l10.m2.2.2.2.2.2.3.cmml" xref="alg2.l10.m2.2.2.2.2.2.3">𝑘</ci></apply><ci id="alg2.l10.m2.2.2.2.2.3.cmml" xref="alg2.l10.m2.2.2.2.2.3">𝑡</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m2.2c">u_{k}^{t},v_{k}^{t}</annotation></semantics></math>)

</div>
<div id="alg2.l11" class="ltx_listingline">        <span id="alg2.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l12" class="ltx_listingline">        <span id="alg2.l12.1" class="ltx_text ltx_font_italic" style="color:#008080;"># Averaging occurs only across clients where the mask is <math id="alg2.l12.1.m1.1" class="ltx_Math" alttext="1" display="inline"><semantics id="alg2.l12.1.m1.1a"><mn mathcolor="#008080" id="alg2.l12.1.m1.1.1" xref="alg2.l12.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="alg2.l12.1.m1.1b"><cn type="integer" id="alg2.l12.1.m1.1.1.cmml" xref="alg2.l12.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.1.m1.1c">1</annotation></semantics></math> for a given parameter’s position</span>

</div>
<div id="alg2.l13" class="ltx_listingline">        <math id="alg2.l13.m1.1" class="ltx_Math" alttext="\theta_{G}^{t}\leftarrow" display="inline"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><msubsup id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml"><mi id="alg2.l13.m1.1.1.2.2.2" xref="alg2.l13.m1.1.1.2.2.2.cmml">θ</mi><mi id="alg2.l13.m1.1.1.2.2.3" xref="alg2.l13.m1.1.1.2.2.3.cmml">G</mi><mi id="alg2.l13.m1.1.1.2.3" xref="alg2.l13.m1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg2.l13.m1.1.1.1" xref="alg2.l13.m1.1.1.1.cmml">←</mo><mi id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><ci id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1">←</ci><apply id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.2.1.cmml" xref="alg2.l13.m1.1.1.2">superscript</csymbol><apply id="alg2.l13.m1.1.1.2.2.cmml" xref="alg2.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.2.2.1.cmml" xref="alg2.l13.m1.1.1.2">subscript</csymbol><ci id="alg2.l13.m1.1.1.2.2.2.cmml" xref="alg2.l13.m1.1.1.2.2.2">𝜃</ci><ci id="alg2.l13.m1.1.1.2.2.3.cmml" xref="alg2.l13.m1.1.1.2.2.3">𝐺</ci></apply><ci id="alg2.l13.m1.1.1.2.3.cmml" xref="alg2.l13.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">\theta_{G}^{t}\leftarrow</annotation></semantics></math> Average non-LTN parameters <math id="alg2.l13.m2.1" class="ltx_Math" alttext="\{{u_{k}^{t}}^{+}\}_{c_{k}}^{S_{t}}" display="inline"><semantics id="alg2.l13.m2.1a"><msubsup id="alg2.l13.m2.1.1" xref="alg2.l13.m2.1.1.cmml"><mrow id="alg2.l13.m2.1.1.1.1.1" xref="alg2.l13.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l13.m2.1.1.1.1.1.2" xref="alg2.l13.m2.1.1.1.1.2.cmml">{</mo><mmultiscripts id="alg2.l13.m2.1.1.1.1.1.1" xref="alg2.l13.m2.1.1.1.1.1.1.cmml"><mi id="alg2.l13.m2.1.1.1.1.1.1.2.2.2" xref="alg2.l13.m2.1.1.1.1.1.1.2.2.2.cmml">u</mi><mi id="alg2.l13.m2.1.1.1.1.1.1.2.2.3" xref="alg2.l13.m2.1.1.1.1.1.1.2.2.3.cmml">k</mi><mi id="alg2.l13.m2.1.1.1.1.1.1.2.3" xref="alg2.l13.m2.1.1.1.1.1.1.2.3.cmml">t</mi><mrow id="alg2.l13.m2.1.1.1.1.1.1a" xref="alg2.l13.m2.1.1.1.1.1.1.cmml"></mrow><mo id="alg2.l13.m2.1.1.1.1.1.1.3" xref="alg2.l13.m2.1.1.1.1.1.1.3.cmml">+</mo></mmultiscripts><mo stretchy="false" id="alg2.l13.m2.1.1.1.1.1.3" xref="alg2.l13.m2.1.1.1.1.2.cmml">}</mo></mrow><msub id="alg2.l13.m2.1.1.1.3" xref="alg2.l13.m2.1.1.1.3.cmml"><mi id="alg2.l13.m2.1.1.1.3.2" xref="alg2.l13.m2.1.1.1.3.2.cmml">c</mi><mi id="alg2.l13.m2.1.1.1.3.3" xref="alg2.l13.m2.1.1.1.3.3.cmml">k</mi></msub><msub id="alg2.l13.m2.1.1.3" xref="alg2.l13.m2.1.1.3.cmml"><mi id="alg2.l13.m2.1.1.3.2" xref="alg2.l13.m2.1.1.3.2.cmml">S</mi><mi id="alg2.l13.m2.1.1.3.3" xref="alg2.l13.m2.1.1.3.3.cmml">t</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l13.m2.1b"><apply id="alg2.l13.m2.1.1.cmml" xref="alg2.l13.m2.1.1"><csymbol cd="ambiguous" id="alg2.l13.m2.1.1.2.cmml" xref="alg2.l13.m2.1.1">superscript</csymbol><apply id="alg2.l13.m2.1.1.1.cmml" xref="alg2.l13.m2.1.1"><csymbol cd="ambiguous" id="alg2.l13.m2.1.1.1.2.cmml" xref="alg2.l13.m2.1.1">subscript</csymbol><set id="alg2.l13.m2.1.1.1.1.2.cmml" xref="alg2.l13.m2.1.1.1.1.1"><apply id="alg2.l13.m2.1.1.1.1.1.1.cmml" xref="alg2.l13.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m2.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m2.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l13.m2.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m2.1.1.1.1.1.1.2.1.cmml" xref="alg2.l13.m2.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l13.m2.1.1.1.1.1.1.2.2.cmml" xref="alg2.l13.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m2.1.1.1.1.1.1.2.2.1.cmml" xref="alg2.l13.m2.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l13.m2.1.1.1.1.1.1.2.2.2.cmml" xref="alg2.l13.m2.1.1.1.1.1.1.2.2.2">𝑢</ci><ci id="alg2.l13.m2.1.1.1.1.1.1.2.2.3.cmml" xref="alg2.l13.m2.1.1.1.1.1.1.2.2.3">𝑘</ci></apply><ci id="alg2.l13.m2.1.1.1.1.1.1.2.3.cmml" xref="alg2.l13.m2.1.1.1.1.1.1.2.3">𝑡</ci></apply><plus id="alg2.l13.m2.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m2.1.1.1.1.1.1.3"></plus></apply></set><apply id="alg2.l13.m2.1.1.1.3.cmml" xref="alg2.l13.m2.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m2.1.1.1.3.1.cmml" xref="alg2.l13.m2.1.1.1.3">subscript</csymbol><ci id="alg2.l13.m2.1.1.1.3.2.cmml" xref="alg2.l13.m2.1.1.1.3.2">𝑐</ci><ci id="alg2.l13.m2.1.1.1.3.3.cmml" xref="alg2.l13.m2.1.1.1.3.3">𝑘</ci></apply></apply><apply id="alg2.l13.m2.1.1.3.cmml" xref="alg2.l13.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m2.1.1.3.1.cmml" xref="alg2.l13.m2.1.1.3">subscript</csymbol><ci id="alg2.l13.m2.1.1.3.2.cmml" xref="alg2.l13.m2.1.1.3.2">𝑆</ci><ci id="alg2.l13.m2.1.1.3.3.cmml" xref="alg2.l13.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m2.1c">\{{u_{k}^{t}}^{+}\}_{c_{k}}^{S_{t}}</annotation></semantics></math>

</div>
<div id="alg2.l14" class="ltx_listingline">        <math id="alg2.l14.m1.1" class="ltx_Math" alttext="m_{G}^{t}\leftarrow" display="inline"><semantics id="alg2.l14.m1.1a"><mrow id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><msubsup id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml"><mi id="alg2.l14.m1.1.1.2.2.2" xref="alg2.l14.m1.1.1.2.2.2.cmml">m</mi><mi id="alg2.l14.m1.1.1.2.2.3" xref="alg2.l14.m1.1.1.2.2.3.cmml">G</mi><mi id="alg2.l14.m1.1.1.2.3" xref="alg2.l14.m1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg2.l14.m1.1.1.1" xref="alg2.l14.m1.1.1.1.cmml">←</mo><mi id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><ci id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1">←</ci><apply id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.1.cmml" xref="alg2.l14.m1.1.1.2">superscript</csymbol><apply id="alg2.l14.m1.1.1.2.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.2.1.cmml" xref="alg2.l14.m1.1.1.2">subscript</csymbol><ci id="alg2.l14.m1.1.1.2.2.2.cmml" xref="alg2.l14.m1.1.1.2.2.2">𝑚</ci><ci id="alg2.l14.m1.1.1.2.2.3.cmml" xref="alg2.l14.m1.1.1.2.2.3">𝐺</ci></apply><ci id="alg2.l14.m1.1.1.2.3.cmml" xref="alg2.l14.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">m_{G}^{t}\leftarrow</annotation></semantics></math> Binary OR over client masks <math id="alg2.l14.m2.1" class="ltx_Math" alttext="\bigvee_{c_{k}}^{S_{t}}m_{k}^{t}" display="inline"><semantics id="alg2.l14.m2.1a"><mrow id="alg2.l14.m2.1.1" xref="alg2.l14.m2.1.1.cmml"><msubsup id="alg2.l14.m2.1.1.1" xref="alg2.l14.m2.1.1.1.cmml"><mo id="alg2.l14.m2.1.1.1.2.2" xref="alg2.l14.m2.1.1.1.2.2.cmml">⋁</mo><msub id="alg2.l14.m2.1.1.1.2.3" xref="alg2.l14.m2.1.1.1.2.3.cmml"><mi id="alg2.l14.m2.1.1.1.2.3.2" xref="alg2.l14.m2.1.1.1.2.3.2.cmml">c</mi><mi id="alg2.l14.m2.1.1.1.2.3.3" xref="alg2.l14.m2.1.1.1.2.3.3.cmml">k</mi></msub><msub id="alg2.l14.m2.1.1.1.3" xref="alg2.l14.m2.1.1.1.3.cmml"><mi id="alg2.l14.m2.1.1.1.3.2" xref="alg2.l14.m2.1.1.1.3.2.cmml">S</mi><mi id="alg2.l14.m2.1.1.1.3.3" xref="alg2.l14.m2.1.1.1.3.3.cmml">t</mi></msub></msubsup><msubsup id="alg2.l14.m2.1.1.2" xref="alg2.l14.m2.1.1.2.cmml"><mi id="alg2.l14.m2.1.1.2.2.2" xref="alg2.l14.m2.1.1.2.2.2.cmml">m</mi><mi id="alg2.l14.m2.1.1.2.2.3" xref="alg2.l14.m2.1.1.2.2.3.cmml">k</mi><mi id="alg2.l14.m2.1.1.2.3" xref="alg2.l14.m2.1.1.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m2.1b"><apply id="alg2.l14.m2.1.1.cmml" xref="alg2.l14.m2.1.1"><apply id="alg2.l14.m2.1.1.1.cmml" xref="alg2.l14.m2.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.1.1.cmml" xref="alg2.l14.m2.1.1.1">superscript</csymbol><apply id="alg2.l14.m2.1.1.1.2.cmml" xref="alg2.l14.m2.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.1.2.1.cmml" xref="alg2.l14.m2.1.1.1">subscript</csymbol><or id="alg2.l14.m2.1.1.1.2.2.cmml" xref="alg2.l14.m2.1.1.1.2.2"></or><apply id="alg2.l14.m2.1.1.1.2.3.cmml" xref="alg2.l14.m2.1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.1.2.3.1.cmml" xref="alg2.l14.m2.1.1.1.2.3">subscript</csymbol><ci id="alg2.l14.m2.1.1.1.2.3.2.cmml" xref="alg2.l14.m2.1.1.1.2.3.2">𝑐</ci><ci id="alg2.l14.m2.1.1.1.2.3.3.cmml" xref="alg2.l14.m2.1.1.1.2.3.3">𝑘</ci></apply></apply><apply id="alg2.l14.m2.1.1.1.3.cmml" xref="alg2.l14.m2.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.1.3.1.cmml" xref="alg2.l14.m2.1.1.1.3">subscript</csymbol><ci id="alg2.l14.m2.1.1.1.3.2.cmml" xref="alg2.l14.m2.1.1.1.3.2">𝑆</ci><ci id="alg2.l14.m2.1.1.1.3.3.cmml" xref="alg2.l14.m2.1.1.1.3.3">𝑡</ci></apply></apply><apply id="alg2.l14.m2.1.1.2.cmml" xref="alg2.l14.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.2.1.cmml" xref="alg2.l14.m2.1.1.2">superscript</csymbol><apply id="alg2.l14.m2.1.1.2.2.cmml" xref="alg2.l14.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.2.2.1.cmml" xref="alg2.l14.m2.1.1.2">subscript</csymbol><ci id="alg2.l14.m2.1.1.2.2.2.cmml" xref="alg2.l14.m2.1.1.2.2.2">𝑚</ci><ci id="alg2.l14.m2.1.1.2.2.3.cmml" xref="alg2.l14.m2.1.1.2.2.3">𝑘</ci></apply><ci id="alg2.l14.m2.1.1.2.3.cmml" xref="alg2.l14.m2.1.1.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m2.1c">\bigvee_{c_{k}}^{S_{t}}m_{k}^{t}</annotation></semantics></math>

</div>
<div id="alg2.l15" class="ltx_listingline">        <span id="alg2.l15.1" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l15.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">i</mi><mo id="alg2.l15.m1.1.1.1" xref="alg2.l15.m1.1.1.1.cmml">=</mo><mn id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><eq id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1"></eq><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝑖</ci><cn type="integer" id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">i=1</annotation></semantics></math> <span id="alg2.l15.2" class="ltx_text ltx_font_bold">to</span> <math id="alg2.l15.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="alg2.l15.m2.1a"><mi id="alg2.l15.m2.1.1" xref="alg2.l15.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="alg2.l15.m2.1b"><ci id="alg2.l15.m2.1.1.cmml" xref="alg2.l15.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m2.1c">N</annotation></semantics></math> <span id="alg2.l15.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l16" class="ltx_listingline">           <span id="alg2.l16.1" class="ltx_text ltx_font_bold">if</span> <math id="alg2.l16.m1.1" class="ltx_Math" alttext="m_{i}^{t}" display="inline"><semantics id="alg2.l16.m1.1a"><msubsup id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><mi id="alg2.l16.m1.1.1.2.2" xref="alg2.l16.m1.1.1.2.2.cmml">m</mi><mi id="alg2.l16.m1.1.1.2.3" xref="alg2.l16.m1.1.1.2.3.cmml">i</mi><mi id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1">superscript</csymbol><apply id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.2.1.cmml" xref="alg2.l16.m1.1.1">subscript</csymbol><ci id="alg2.l16.m1.1.1.2.2.cmml" xref="alg2.l16.m1.1.1.2.2">𝑚</ci><ci id="alg2.l16.m1.1.1.2.3.cmml" xref="alg2.l16.m1.1.1.2.3">𝑖</ci></apply><ci id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">m_{i}^{t}</annotation></semantics></math> exists <span id="alg2.l16.2" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg2.l17" class="ltx_listingline">              <span id="alg2.l17.1" class="ltx_text ltx_font_italic" style="color:#008080;"># Distribute global params to clients’ non-LTN params, located via <math id="alg2.l17.1.m1.1" class="ltx_Math" alttext="\neg m_{i}^{t}" display="inline"><semantics id="alg2.l17.1.m1.1a"><mrow id="alg2.l17.1.m1.1.1" xref="alg2.l17.1.m1.1.1.cmml"><mo mathcolor="#008080" rspace="0.167em" id="alg2.l17.1.m1.1.1.1" xref="alg2.l17.1.m1.1.1.1.cmml">¬</mo><msubsup id="alg2.l17.1.m1.1.1.2" xref="alg2.l17.1.m1.1.1.2.cmml"><mi mathcolor="#008080" id="alg2.l17.1.m1.1.1.2.2.2" xref="alg2.l17.1.m1.1.1.2.2.2.cmml">m</mi><mi mathcolor="#008080" id="alg2.l17.1.m1.1.1.2.2.3" xref="alg2.l17.1.m1.1.1.2.2.3.cmml">i</mi><mi mathcolor="#008080" id="alg2.l17.1.m1.1.1.2.3" xref="alg2.l17.1.m1.1.1.2.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.1.m1.1b"><apply id="alg2.l17.1.m1.1.1.cmml" xref="alg2.l17.1.m1.1.1"><not id="alg2.l17.1.m1.1.1.1.cmml" xref="alg2.l17.1.m1.1.1.1"></not><apply id="alg2.l17.1.m1.1.1.2.cmml" xref="alg2.l17.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l17.1.m1.1.1.2.1.cmml" xref="alg2.l17.1.m1.1.1.2">superscript</csymbol><apply id="alg2.l17.1.m1.1.1.2.2.cmml" xref="alg2.l17.1.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l17.1.m1.1.1.2.2.1.cmml" xref="alg2.l17.1.m1.1.1.2">subscript</csymbol><ci id="alg2.l17.1.m1.1.1.2.2.2.cmml" xref="alg2.l17.1.m1.1.1.2.2.2">𝑚</ci><ci id="alg2.l17.1.m1.1.1.2.2.3.cmml" xref="alg2.l17.1.m1.1.1.2.2.3">𝑖</ci></apply><ci id="alg2.l17.1.m1.1.1.2.3.cmml" xref="alg2.l17.1.m1.1.1.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.1.m1.1c">\neg m_{i}^{t}</annotation></semantics></math></span>

</div>
<div id="alg2.l18" class="ltx_listingline">              <math id="alg2.l18.m1.1" class="ltx_Math" alttext="\theta_{i}^{t}\odot\neg m_{i}^{t}\leftarrow\theta_{G}^{t}\odot\neg m_{i}^{t}" display="inline"><semantics id="alg2.l18.m1.1a"><mrow id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml"><mrow id="alg2.l18.m1.1.1.2" xref="alg2.l18.m1.1.1.2.cmml"><msubsup id="alg2.l18.m1.1.1.2.2" xref="alg2.l18.m1.1.1.2.2.cmml"><mi id="alg2.l18.m1.1.1.2.2.2.2" xref="alg2.l18.m1.1.1.2.2.2.2.cmml">θ</mi><mi id="alg2.l18.m1.1.1.2.2.2.3" xref="alg2.l18.m1.1.1.2.2.2.3.cmml">i</mi><mi id="alg2.l18.m1.1.1.2.2.3" xref="alg2.l18.m1.1.1.2.2.3.cmml">t</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="alg2.l18.m1.1.1.2.1" xref="alg2.l18.m1.1.1.2.1.cmml">⊙</mo><mrow id="alg2.l18.m1.1.1.2.3" xref="alg2.l18.m1.1.1.2.3.cmml"><mo rspace="0.167em" id="alg2.l18.m1.1.1.2.3.1" xref="alg2.l18.m1.1.1.2.3.1.cmml">¬</mo><msubsup id="alg2.l18.m1.1.1.2.3.2" xref="alg2.l18.m1.1.1.2.3.2.cmml"><mi id="alg2.l18.m1.1.1.2.3.2.2.2" xref="alg2.l18.m1.1.1.2.3.2.2.2.cmml">m</mi><mi id="alg2.l18.m1.1.1.2.3.2.2.3" xref="alg2.l18.m1.1.1.2.3.2.2.3.cmml">i</mi><mi id="alg2.l18.m1.1.1.2.3.2.3" xref="alg2.l18.m1.1.1.2.3.2.3.cmml">t</mi></msubsup></mrow></mrow><mo stretchy="false" id="alg2.l18.m1.1.1.1" xref="alg2.l18.m1.1.1.1.cmml">←</mo><mrow id="alg2.l18.m1.1.1.3" xref="alg2.l18.m1.1.1.3.cmml"><msubsup id="alg2.l18.m1.1.1.3.2" xref="alg2.l18.m1.1.1.3.2.cmml"><mi id="alg2.l18.m1.1.1.3.2.2.2" xref="alg2.l18.m1.1.1.3.2.2.2.cmml">θ</mi><mi id="alg2.l18.m1.1.1.3.2.2.3" xref="alg2.l18.m1.1.1.3.2.2.3.cmml">G</mi><mi id="alg2.l18.m1.1.1.3.2.3" xref="alg2.l18.m1.1.1.3.2.3.cmml">t</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="alg2.l18.m1.1.1.3.1" xref="alg2.l18.m1.1.1.3.1.cmml">⊙</mo><mrow id="alg2.l18.m1.1.1.3.3" xref="alg2.l18.m1.1.1.3.3.cmml"><mo rspace="0.167em" id="alg2.l18.m1.1.1.3.3.1" xref="alg2.l18.m1.1.1.3.3.1.cmml">¬</mo><msubsup id="alg2.l18.m1.1.1.3.3.2" xref="alg2.l18.m1.1.1.3.3.2.cmml"><mi id="alg2.l18.m1.1.1.3.3.2.2.2" xref="alg2.l18.m1.1.1.3.3.2.2.2.cmml">m</mi><mi id="alg2.l18.m1.1.1.3.3.2.2.3" xref="alg2.l18.m1.1.1.3.3.2.2.3.cmml">i</mi><mi id="alg2.l18.m1.1.1.3.3.2.3" xref="alg2.l18.m1.1.1.3.3.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><apply id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1"><ci id="alg2.l18.m1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1">←</ci><apply id="alg2.l18.m1.1.1.2.cmml" xref="alg2.l18.m1.1.1.2"><csymbol cd="latexml" id="alg2.l18.m1.1.1.2.1.cmml" xref="alg2.l18.m1.1.1.2.1">direct-product</csymbol><apply id="alg2.l18.m1.1.1.2.2.cmml" xref="alg2.l18.m1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.2.2.1.cmml" xref="alg2.l18.m1.1.1.2.2">superscript</csymbol><apply id="alg2.l18.m1.1.1.2.2.2.cmml" xref="alg2.l18.m1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.2.2.2.1.cmml" xref="alg2.l18.m1.1.1.2.2">subscript</csymbol><ci id="alg2.l18.m1.1.1.2.2.2.2.cmml" xref="alg2.l18.m1.1.1.2.2.2.2">𝜃</ci><ci id="alg2.l18.m1.1.1.2.2.2.3.cmml" xref="alg2.l18.m1.1.1.2.2.2.3">𝑖</ci></apply><ci id="alg2.l18.m1.1.1.2.2.3.cmml" xref="alg2.l18.m1.1.1.2.2.3">𝑡</ci></apply><apply id="alg2.l18.m1.1.1.2.3.cmml" xref="alg2.l18.m1.1.1.2.3"><not id="alg2.l18.m1.1.1.2.3.1.cmml" xref="alg2.l18.m1.1.1.2.3.1"></not><apply id="alg2.l18.m1.1.1.2.3.2.cmml" xref="alg2.l18.m1.1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.2.3.2.1.cmml" xref="alg2.l18.m1.1.1.2.3.2">superscript</csymbol><apply id="alg2.l18.m1.1.1.2.3.2.2.cmml" xref="alg2.l18.m1.1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.2.3.2.2.1.cmml" xref="alg2.l18.m1.1.1.2.3.2">subscript</csymbol><ci id="alg2.l18.m1.1.1.2.3.2.2.2.cmml" xref="alg2.l18.m1.1.1.2.3.2.2.2">𝑚</ci><ci id="alg2.l18.m1.1.1.2.3.2.2.3.cmml" xref="alg2.l18.m1.1.1.2.3.2.2.3">𝑖</ci></apply><ci id="alg2.l18.m1.1.1.2.3.2.3.cmml" xref="alg2.l18.m1.1.1.2.3.2.3">𝑡</ci></apply></apply></apply><apply id="alg2.l18.m1.1.1.3.cmml" xref="alg2.l18.m1.1.1.3"><csymbol cd="latexml" id="alg2.l18.m1.1.1.3.1.cmml" xref="alg2.l18.m1.1.1.3.1">direct-product</csymbol><apply id="alg2.l18.m1.1.1.3.2.cmml" xref="alg2.l18.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.2.1.cmml" xref="alg2.l18.m1.1.1.3.2">superscript</csymbol><apply id="alg2.l18.m1.1.1.3.2.2.cmml" xref="alg2.l18.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.2.2.1.cmml" xref="alg2.l18.m1.1.1.3.2">subscript</csymbol><ci id="alg2.l18.m1.1.1.3.2.2.2.cmml" xref="alg2.l18.m1.1.1.3.2.2.2">𝜃</ci><ci id="alg2.l18.m1.1.1.3.2.2.3.cmml" xref="alg2.l18.m1.1.1.3.2.2.3">𝐺</ci></apply><ci id="alg2.l18.m1.1.1.3.2.3.cmml" xref="alg2.l18.m1.1.1.3.2.3">𝑡</ci></apply><apply id="alg2.l18.m1.1.1.3.3.cmml" xref="alg2.l18.m1.1.1.3.3"><not id="alg2.l18.m1.1.1.3.3.1.cmml" xref="alg2.l18.m1.1.1.3.3.1"></not><apply id="alg2.l18.m1.1.1.3.3.2.cmml" xref="alg2.l18.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.3.2.1.cmml" xref="alg2.l18.m1.1.1.3.3.2">superscript</csymbol><apply id="alg2.l18.m1.1.1.3.3.2.2.cmml" xref="alg2.l18.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.3.2.2.1.cmml" xref="alg2.l18.m1.1.1.3.3.2">subscript</csymbol><ci id="alg2.l18.m1.1.1.3.3.2.2.2.cmml" xref="alg2.l18.m1.1.1.3.3.2.2.2">𝑚</ci><ci id="alg2.l18.m1.1.1.3.3.2.2.3.cmml" xref="alg2.l18.m1.1.1.3.3.2.2.3">𝑖</ci></apply><ci id="alg2.l18.m1.1.1.3.3.2.3.cmml" xref="alg2.l18.m1.1.1.3.3.2.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">\theta_{i}^{t}\odot\neg m_{i}^{t}\leftarrow\theta_{G}^{t}\odot\neg m_{i}^{t}</annotation></semantics></math>

</div>
<div id="alg2.l19" class="ltx_listingline">              <math id="alg2.l19.m1.1" class="ltx_Math" alttext="\theta_{i}^{t}\odot m_{i}^{t}\leftarrow{v_{i}^{t}}^{+}" display="inline"><semantics id="alg2.l19.m1.1a"><mrow id="alg2.l19.m1.1.1" xref="alg2.l19.m1.1.1.cmml"><mrow id="alg2.l19.m1.1.1.2" xref="alg2.l19.m1.1.1.2.cmml"><msubsup id="alg2.l19.m1.1.1.2.2" xref="alg2.l19.m1.1.1.2.2.cmml"><mi id="alg2.l19.m1.1.1.2.2.2.2" xref="alg2.l19.m1.1.1.2.2.2.2.cmml">θ</mi><mi id="alg2.l19.m1.1.1.2.2.2.3" xref="alg2.l19.m1.1.1.2.2.2.3.cmml">i</mi><mi id="alg2.l19.m1.1.1.2.2.3" xref="alg2.l19.m1.1.1.2.2.3.cmml">t</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="alg2.l19.m1.1.1.2.1" xref="alg2.l19.m1.1.1.2.1.cmml">⊙</mo><msubsup id="alg2.l19.m1.1.1.2.3" xref="alg2.l19.m1.1.1.2.3.cmml"><mi id="alg2.l19.m1.1.1.2.3.2.2" xref="alg2.l19.m1.1.1.2.3.2.2.cmml">m</mi><mi id="alg2.l19.m1.1.1.2.3.2.3" xref="alg2.l19.m1.1.1.2.3.2.3.cmml">i</mi><mi id="alg2.l19.m1.1.1.2.3.3" xref="alg2.l19.m1.1.1.2.3.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="alg2.l19.m1.1.1.1" xref="alg2.l19.m1.1.1.1.cmml">←</mo><mmultiscripts id="alg2.l19.m1.1.1.3" xref="alg2.l19.m1.1.1.3.cmml"><mi id="alg2.l19.m1.1.1.3.2.2.2" xref="alg2.l19.m1.1.1.3.2.2.2.cmml">v</mi><mi id="alg2.l19.m1.1.1.3.2.2.3" xref="alg2.l19.m1.1.1.3.2.2.3.cmml">i</mi><mi id="alg2.l19.m1.1.1.3.2.3" xref="alg2.l19.m1.1.1.3.2.3.cmml">t</mi><mrow id="alg2.l19.m1.1.1.3a" xref="alg2.l19.m1.1.1.3.cmml"></mrow><mo id="alg2.l19.m1.1.1.3.3" xref="alg2.l19.m1.1.1.3.3.cmml">+</mo></mmultiscripts></mrow><annotation-xml encoding="MathML-Content" id="alg2.l19.m1.1b"><apply id="alg2.l19.m1.1.1.cmml" xref="alg2.l19.m1.1.1"><ci id="alg2.l19.m1.1.1.1.cmml" xref="alg2.l19.m1.1.1.1">←</ci><apply id="alg2.l19.m1.1.1.2.cmml" xref="alg2.l19.m1.1.1.2"><csymbol cd="latexml" id="alg2.l19.m1.1.1.2.1.cmml" xref="alg2.l19.m1.1.1.2.1">direct-product</csymbol><apply id="alg2.l19.m1.1.1.2.2.cmml" xref="alg2.l19.m1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.2.2.1.cmml" xref="alg2.l19.m1.1.1.2.2">superscript</csymbol><apply id="alg2.l19.m1.1.1.2.2.2.cmml" xref="alg2.l19.m1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.2.2.2.1.cmml" xref="alg2.l19.m1.1.1.2.2">subscript</csymbol><ci id="alg2.l19.m1.1.1.2.2.2.2.cmml" xref="alg2.l19.m1.1.1.2.2.2.2">𝜃</ci><ci id="alg2.l19.m1.1.1.2.2.2.3.cmml" xref="alg2.l19.m1.1.1.2.2.2.3">𝑖</ci></apply><ci id="alg2.l19.m1.1.1.2.2.3.cmml" xref="alg2.l19.m1.1.1.2.2.3">𝑡</ci></apply><apply id="alg2.l19.m1.1.1.2.3.cmml" xref="alg2.l19.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.2.3.1.cmml" xref="alg2.l19.m1.1.1.2.3">superscript</csymbol><apply id="alg2.l19.m1.1.1.2.3.2.cmml" xref="alg2.l19.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.2.3.2.1.cmml" xref="alg2.l19.m1.1.1.2.3">subscript</csymbol><ci id="alg2.l19.m1.1.1.2.3.2.2.cmml" xref="alg2.l19.m1.1.1.2.3.2.2">𝑚</ci><ci id="alg2.l19.m1.1.1.2.3.2.3.cmml" xref="alg2.l19.m1.1.1.2.3.2.3">𝑖</ci></apply><ci id="alg2.l19.m1.1.1.2.3.3.cmml" xref="alg2.l19.m1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="alg2.l19.m1.1.1.3.cmml" xref="alg2.l19.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.3.1.cmml" xref="alg2.l19.m1.1.1.3">superscript</csymbol><apply id="alg2.l19.m1.1.1.3.2.cmml" xref="alg2.l19.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.3.2.1.cmml" xref="alg2.l19.m1.1.1.3">superscript</csymbol><apply id="alg2.l19.m1.1.1.3.2.2.cmml" xref="alg2.l19.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l19.m1.1.1.3.2.2.1.cmml" xref="alg2.l19.m1.1.1.3">subscript</csymbol><ci id="alg2.l19.m1.1.1.3.2.2.2.cmml" xref="alg2.l19.m1.1.1.3.2.2.2">𝑣</ci><ci id="alg2.l19.m1.1.1.3.2.2.3.cmml" xref="alg2.l19.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="alg2.l19.m1.1.1.3.2.3.cmml" xref="alg2.l19.m1.1.1.3.2.3">𝑡</ci></apply><plus id="alg2.l19.m1.1.1.3.3.cmml" xref="alg2.l19.m1.1.1.3.3"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l19.m1.1c">\theta_{i}^{t}\odot m_{i}^{t}\leftarrow{v_{i}^{t}}^{+}</annotation></semantics></math>

</div>
<div id="alg2.l20" class="ltx_listingline">           <span id="alg2.l20.1" class="ltx_text ltx_font_bold">else</span>


</div>
<div id="alg2.l21" class="ltx_listingline">              <math id="alg2.l21.m1.1" class="ltx_Math" alttext="\theta_{i}^{t}\odot m_{G}^{t}\leftarrow\theta_{G}^{t}" display="inline"><semantics id="alg2.l21.m1.1a"><mrow id="alg2.l21.m1.1.1" xref="alg2.l21.m1.1.1.cmml"><mrow id="alg2.l21.m1.1.1.2" xref="alg2.l21.m1.1.1.2.cmml"><msubsup id="alg2.l21.m1.1.1.2.2" xref="alg2.l21.m1.1.1.2.2.cmml"><mi id="alg2.l21.m1.1.1.2.2.2.2" xref="alg2.l21.m1.1.1.2.2.2.2.cmml">θ</mi><mi id="alg2.l21.m1.1.1.2.2.2.3" xref="alg2.l21.m1.1.1.2.2.2.3.cmml">i</mi><mi id="alg2.l21.m1.1.1.2.2.3" xref="alg2.l21.m1.1.1.2.2.3.cmml">t</mi></msubsup><mo lspace="0.222em" rspace="0.222em" id="alg2.l21.m1.1.1.2.1" xref="alg2.l21.m1.1.1.2.1.cmml">⊙</mo><msubsup id="alg2.l21.m1.1.1.2.3" xref="alg2.l21.m1.1.1.2.3.cmml"><mi id="alg2.l21.m1.1.1.2.3.2.2" xref="alg2.l21.m1.1.1.2.3.2.2.cmml">m</mi><mi id="alg2.l21.m1.1.1.2.3.2.3" xref="alg2.l21.m1.1.1.2.3.2.3.cmml">G</mi><mi id="alg2.l21.m1.1.1.2.3.3" xref="alg2.l21.m1.1.1.2.3.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="alg2.l21.m1.1.1.1" xref="alg2.l21.m1.1.1.1.cmml">←</mo><msubsup id="alg2.l21.m1.1.1.3" xref="alg2.l21.m1.1.1.3.cmml"><mi id="alg2.l21.m1.1.1.3.2.2" xref="alg2.l21.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg2.l21.m1.1.1.3.2.3" xref="alg2.l21.m1.1.1.3.2.3.cmml">G</mi><mi id="alg2.l21.m1.1.1.3.3" xref="alg2.l21.m1.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l21.m1.1b"><apply id="alg2.l21.m1.1.1.cmml" xref="alg2.l21.m1.1.1"><ci id="alg2.l21.m1.1.1.1.cmml" xref="alg2.l21.m1.1.1.1">←</ci><apply id="alg2.l21.m1.1.1.2.cmml" xref="alg2.l21.m1.1.1.2"><csymbol cd="latexml" id="alg2.l21.m1.1.1.2.1.cmml" xref="alg2.l21.m1.1.1.2.1">direct-product</csymbol><apply id="alg2.l21.m1.1.1.2.2.cmml" xref="alg2.l21.m1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.2.2.1.cmml" xref="alg2.l21.m1.1.1.2.2">superscript</csymbol><apply id="alg2.l21.m1.1.1.2.2.2.cmml" xref="alg2.l21.m1.1.1.2.2"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.2.2.2.1.cmml" xref="alg2.l21.m1.1.1.2.2">subscript</csymbol><ci id="alg2.l21.m1.1.1.2.2.2.2.cmml" xref="alg2.l21.m1.1.1.2.2.2.2">𝜃</ci><ci id="alg2.l21.m1.1.1.2.2.2.3.cmml" xref="alg2.l21.m1.1.1.2.2.2.3">𝑖</ci></apply><ci id="alg2.l21.m1.1.1.2.2.3.cmml" xref="alg2.l21.m1.1.1.2.2.3">𝑡</ci></apply><apply id="alg2.l21.m1.1.1.2.3.cmml" xref="alg2.l21.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.2.3.1.cmml" xref="alg2.l21.m1.1.1.2.3">superscript</csymbol><apply id="alg2.l21.m1.1.1.2.3.2.cmml" xref="alg2.l21.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.2.3.2.1.cmml" xref="alg2.l21.m1.1.1.2.3">subscript</csymbol><ci id="alg2.l21.m1.1.1.2.3.2.2.cmml" xref="alg2.l21.m1.1.1.2.3.2.2">𝑚</ci><ci id="alg2.l21.m1.1.1.2.3.2.3.cmml" xref="alg2.l21.m1.1.1.2.3.2.3">𝐺</ci></apply><ci id="alg2.l21.m1.1.1.2.3.3.cmml" xref="alg2.l21.m1.1.1.2.3.3">𝑡</ci></apply></apply><apply id="alg2.l21.m1.1.1.3.cmml" xref="alg2.l21.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.3.1.cmml" xref="alg2.l21.m1.1.1.3">superscript</csymbol><apply id="alg2.l21.m1.1.1.3.2.cmml" xref="alg2.l21.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l21.m1.1.1.3.2.1.cmml" xref="alg2.l21.m1.1.1.3">subscript</csymbol><ci id="alg2.l21.m1.1.1.3.2.2.cmml" xref="alg2.l21.m1.1.1.3.2.2">𝜃</ci><ci id="alg2.l21.m1.1.1.3.2.3.cmml" xref="alg2.l21.m1.1.1.3.2.3">𝐺</ci></apply><ci id="alg2.l21.m1.1.1.3.3.cmml" xref="alg2.l21.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.m1.1c">\theta_{i}^{t}\odot m_{G}^{t}\leftarrow\theta_{G}^{t}</annotation></semantics></math>

</div>
<div id="alg2.l22" class="ltx_listingline">           <span id="alg2.l22.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l22.2" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l23" class="ltx_listingline">        <span id="alg2.l23.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l23.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l24" class="ltx_listingline">     <span id="alg2.l24.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l24.2" class="ltx_text ltx_font_bold">for</span>

</div>
</div>
</figure>
</section>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<section id="S3.SS0.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Models &amp; Datasets.</h5>

<div id="S3.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px1.p1.1" class="ltx_p">In this work, we consider a cross-silo setting in which the number of clients is low, but participation is high <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib16" title="" class="ltx_ref">2022</a>)</cite>. We performed all experiments using a ResNet18 <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a href="#bib.bib8" title="" class="ltx_ref">2015</a>)</cite> backbone pretrained on ImageNet <cite class="ltx_cite ltx_citemacro_citep">(Deng et al., <a href="#bib.bib4" title="" class="ltx_ref">2009</a>)</cite>. We show results for our experimental setting on non-iid samples from CIFAR-10. Each client was allocated 20 training samples and 100 testing samples per class.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Hyperparameters.</h5>

<div id="S3.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px2.p1.5" class="ltx_p">We set the number of clients <math id="S3.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="|C|=N=10" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.1.m1.1a"><mrow id="S3.SS0.SSS0.Px2.p1.1.m1.1.2" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.cmml"><mrow id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.2.2" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.cmml"><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml">C</mi><mo stretchy="false" id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.2" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.3" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.3.cmml">=</mo><mi id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.4" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.4.cmml">N</mi><mo id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.5" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.5.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.6" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.6.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2"><and id="S3.SS0.SSS0.Px2.p1.1.m1.1.2a.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2"></and><apply id="S3.SS0.SSS0.Px2.p1.1.m1.1.2b.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2"><eq id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.3.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.3"></eq><apply id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.2.2"><abs id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.2.2.1"></abs><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.1">𝐶</ci></apply><ci id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.4.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.4">𝑁</ci></apply><apply id="S3.SS0.SSS0.Px2.p1.1.m1.1.2c.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2"><eq id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.5.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.5"></eq><share href="#S3.SS0.SSS0.Px2.p1.1.m1.1.2.4.cmml" id="S3.SS0.SSS0.Px2.p1.1.m1.1.2d.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2"></share><cn type="integer" id="S3.SS0.SSS0.Px2.p1.1.m1.1.2.6.cmml" xref="S3.SS0.SSS0.Px2.p1.1.m1.1.2.6">10</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.1.m1.1c">|C|=N=10</annotation></semantics></math> in all experiments. The participation rate <math id="S3.SS0.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.2.m2.1a"><mi id="S3.SS0.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS0.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.2.m2.1c">K</annotation></semantics></math> is set to 1.0, and the number of classes per client is varied from <math id="S3.SS0.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="s=2" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.3.m3.1a"><mrow id="S3.SS0.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml">s</mi><mo id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.3.m3.1b"><apply id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1"><eq id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.1"></eq><ci id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.2">𝑠</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.3.m3.1c">s=2</annotation></semantics></math> and <math id="S3.SS0.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="s=4" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.4.m4.1a"><mrow id="S3.SS0.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml">s</mi><mo id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1"><eq id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.1"></eq><ci id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.2">𝑠</ci><cn type="integer" id="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS0.SSS0.Px2.p1.4.m4.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.4.m4.1c">s=4</annotation></semantics></math>. In GradLTN, we perform 5 pruning iterations, each with 5 local epochs of training. However, the personalization rate <math id="S3.SS0.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS0.SSS0.Px2.p1.5.m5.1a"><mi id="S3.SS0.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS0.SSS0.Px2.p1.5.m5.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS0.SSS0.Px2.p1.5.m5.1b"><ci id="S3.SS0.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS0.SSS0.Px2.p1.5.m5.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS0.SSS0.Px2.p1.5.m5.1c">p</annotation></semantics></math> was varied from 0.25, 0.50, and 0.75. Finally, 5 epochs of personalized training via LocalAlt are performed.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Comparisons to Prior Work.</h5>

<div id="S3.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px3.p1.1" class="ltx_p">We compare our results to FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite>, LotteryFL <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib12" title="" class="ltx_ref">2020</a>)</cite>, FedBABU <cite class="ltx_cite ltx_citemacro_citep">(Oh et al., <a href="#bib.bib20" title="" class="ltx_ref">2022</a>)</cite>, FedRep <cite class="ltx_cite ltx_citemacro_citep">(Collins et al., <a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite>, FedPer <cite class="ltx_cite ltx_citemacro_citep">(Arivazhagan et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>)</cite>, Ditto <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib13" title="" class="ltx_ref">2021a</a>)</cite>, and LG-FedAvg <cite class="ltx_cite ltx_citemacro_citep">(Liang et al., <a href="#bib.bib15" title="" class="ltx_ref">2020</a>)</cite>. To fairly compare the performance of these methods, we fix the number of local epochs across all methods to 5. All other hyperparameters (learning rate, momentum, etc.) follow the recommended settings by the authors of the respective works.</p>
</div>
</section>
<section id="S3.SS0.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Evaluation Metric.</h5>

<div id="S3.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="S3.SS0.SSS0.Px4.p1.1" class="ltx_p">For all methods, the mean accuracy of the final model(s) across individual client data distributions calculated at the final communication round is reported. For FedAvg, accuracy is reported for a single global model. However, for other methods that learn personalized client models, the final average accuracy is reported by averaging individual client model accuracies.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Mean test accuracies (%) after 200 communication rounds in the full-participation, low-client setting, with 20 training samples and 100 testing samples per class for each client.</figcaption>
<table id="S3.T1.2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.2.2.2" class="ltx_tr">
<th id="S3.T1.2.2.2.3" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt"><span id="S3.T1.2.2.2.3.1" class="ltx_text" style="font-size:90%;">Method</span></th>
<th id="S3.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S3.T1.1.1.1.1.m1.1" class="ltx_Math" alttext="s=2" display="inline"><semantics id="S3.T1.1.1.1.1.m1.1a"><mrow id="S3.T1.1.1.1.1.m1.1.1" xref="S3.T1.1.1.1.1.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.1.1.1.1.m1.1.1.2" xref="S3.T1.1.1.1.1.m1.1.1.2.cmml">s</mi><mo mathsize="90%" id="S3.T1.1.1.1.1.m1.1.1.1" xref="S3.T1.1.1.1.1.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S3.T1.1.1.1.1.m1.1.1.3" xref="S3.T1.1.1.1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.1.1.1.1.m1.1b"><apply id="S3.T1.1.1.1.1.m1.1.1.cmml" xref="S3.T1.1.1.1.1.m1.1.1"><eq id="S3.T1.1.1.1.1.m1.1.1.1.cmml" xref="S3.T1.1.1.1.1.m1.1.1.1"></eq><ci id="S3.T1.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.1.1.1.1.m1.1.1.2">𝑠</ci><cn type="integer" id="S3.T1.1.1.1.1.m1.1.1.3.cmml" xref="S3.T1.1.1.1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.1.1.1.1.m1.1c">s=2</annotation></semantics></math></th>
<th id="S3.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><math id="S3.T1.2.2.2.2.m1.1" class="ltx_Math" alttext="s=4" display="inline"><semantics id="S3.T1.2.2.2.2.m1.1a"><mrow id="S3.T1.2.2.2.2.m1.1.1" xref="S3.T1.2.2.2.2.m1.1.1.cmml"><mi mathsize="90%" id="S3.T1.2.2.2.2.m1.1.1.2" xref="S3.T1.2.2.2.2.m1.1.1.2.cmml">s</mi><mo mathsize="90%" id="S3.T1.2.2.2.2.m1.1.1.1" xref="S3.T1.2.2.2.2.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="S3.T1.2.2.2.2.m1.1.1.3" xref="S3.T1.2.2.2.2.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.2.2.2.2.m1.1b"><apply id="S3.T1.2.2.2.2.m1.1.1.cmml" xref="S3.T1.2.2.2.2.m1.1.1"><eq id="S3.T1.2.2.2.2.m1.1.1.1.cmml" xref="S3.T1.2.2.2.2.m1.1.1.1"></eq><ci id="S3.T1.2.2.2.2.m1.1.1.2.cmml" xref="S3.T1.2.2.2.2.m1.1.1.2">𝑠</ci><cn type="integer" id="S3.T1.2.2.2.2.m1.1.1.3.cmml" xref="S3.T1.2.2.2.2.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.2.2.2.m1.1c">s=4</annotation></semantics></math></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.2.2.3.1" class="ltx_tr">
<th id="S3.T1.2.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.2.2.3.1.1.1" class="ltx_text" style="font-size:90%;">FedAvg</span></th>
<td id="S3.T1.2.2.3.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.2.2.3.1.2.1" class="ltx_text" style="font-size:90%;">33.54</span></td>
<td id="S3.T1.2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.2.2.3.1.3.1" class="ltx_text" style="font-size:90%;">52.57</span></td>
</tr>
<tr id="S3.T1.2.2.4.2" class="ltx_tr">
<th id="S3.T1.2.2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.2.2.4.2.1.1" class="ltx_text" style="font-size:90%;">LG-FedAvg</span></th>
<td id="S3.T1.2.2.4.2.2" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.4.2.2.1" class="ltx_text" style="font-size:90%;">59.95</span></td>
<td id="S3.T1.2.2.4.2.3" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.4.2.3.1" class="ltx_text" style="font-size:90%;">51.35</span></td>
</tr>
<tr id="S3.T1.2.2.5.3" class="ltx_tr">
<th id="S3.T1.2.2.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.2.2.5.3.1.1" class="ltx_text" style="font-size:90%;">LotteryFL</span></th>
<td id="S3.T1.2.2.5.3.2" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.5.3.2.1" class="ltx_text" style="font-size:90%;">73.37</span></td>
<td id="S3.T1.2.2.5.3.3" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.5.3.3.1" class="ltx_text" style="font-size:90%;">60.13</span></td>
</tr>
<tr id="S3.T1.2.2.6.4" class="ltx_tr">
<th id="S3.T1.2.2.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.2.2.6.4.1.1" class="ltx_text" style="font-size:90%;">Ditto</span></th>
<td id="S3.T1.2.2.6.4.2" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.6.4.2.1" class="ltx_text" style="font-size:90%;">74.50</span></td>
<td id="S3.T1.2.2.6.4.3" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.6.4.3.1" class="ltx_text" style="font-size:90%;">48.85</span></td>
</tr>
<tr id="S3.T1.2.2.7.5" class="ltx_tr">
<th id="S3.T1.2.2.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.2.2.7.5.1.1" class="ltx_text" style="font-size:90%;">FedBABU</span></th>
<td id="S3.T1.2.2.7.5.2" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.7.5.2.1" class="ltx_text" style="font-size:90%;">35.65</span></td>
<td id="S3.T1.2.2.7.5.3" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.7.5.3.1" class="ltx_text" style="font-size:90%;">53.03</span></td>
</tr>
<tr id="S3.T1.2.2.8.6" class="ltx_tr">
<th id="S3.T1.2.2.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.2.2.8.6.1.1" class="ltx_text" style="font-size:90%;">FedPer</span></th>
<td id="S3.T1.2.2.8.6.2" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.8.6.2.1" class="ltx_text" style="font-size:90%;">30.25</span></td>
<td id="S3.T1.2.2.8.6.3" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.8.6.3.1" class="ltx_text" style="font-size:90%;">51.73</span></td>
</tr>
<tr id="S3.T1.2.2.9.7" class="ltx_tr">
<th id="S3.T1.2.2.9.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.2.2.9.7.1.1" class="ltx_text" style="font-size:90%;">FedRep</span></th>
<td id="S3.T1.2.2.9.7.2" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.9.7.2.1" class="ltx_text" style="font-size:90%;">82.70</span></td>
<td id="S3.T1.2.2.9.7.3" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.9.7.3.1" class="ltx_text" style="font-size:90%;">65.33</span></td>
</tr>
<tr id="S3.T1.2.2.10.8" class="ltx_tr">
<th id="S3.T1.2.2.10.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.2.2.10.8.1.1" class="ltx_text" style="font-size:90%;">FedSelect (0.25)</span></th>
<td id="S3.T1.2.2.10.8.2" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.10.8.2.1" class="ltx_text" style="font-size:90%;">84.22</span></td>
<td id="S3.T1.2.2.10.8.3" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.10.8.3.1" class="ltx_text" style="font-size:90%;">65.23</span></td>
</tr>
<tr id="S3.T1.2.2.11.9" class="ltx_tr">
<th id="S3.T1.2.2.11.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row"><span id="S3.T1.2.2.11.9.1.1" class="ltx_text" style="font-size:90%;">FedSelect (0.50)</span></th>
<td id="S3.T1.2.2.11.9.2" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.11.9.2.1" class="ltx_text" style="font-size:90%;">85.64</span></td>
<td id="S3.T1.2.2.11.9.3" class="ltx_td ltx_align_center"><span id="S3.T1.2.2.11.9.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">65.88</span></td>
</tr>
<tr id="S3.T1.2.2.12.10" class="ltx_tr">
<th id="S3.T1.2.2.12.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb"><span id="S3.T1.2.2.12.10.1.1" class="ltx_text" style="font-size:90%;">FedSelect (0.75)</span></th>
<td id="S3.T1.2.2.12.10.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.2.2.12.10.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">85.91</span></td>
<td id="S3.T1.2.2.12.10.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.2.2.12.10.3.1" class="ltx_text" style="font-size:90%;">62.91</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Performance Comparison</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">We observe in Table <a href="#S3.T1" title="Table 1 ‣ Evaluation Metric. ‣ 3 Experiments ‣ FedSelect: Customized Selection of Parameters for Fine-Tuning during Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> that FedSelect outperforms all other baselines in the CIFAR-10 in a low-client, full-participation setting. FedAvg learns a global model for all clients, resulting in reduced accuracy when confronted with increased non-IIDness. Conversely, highly personalized FL algorithms exhibit resilience to non-IIDness due to the ease of a client’s local task. FedBABU and FedPer appear to suffer the same as FedAvg, despite personalizing a small set of parameters.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">Illustrated in Figure <a href="#S3.F1" title="Figure 1 ‣ 3.1 Performance Comparison ‣ 3 Experiments ‣ FedSelect: Customized Selection of Parameters for Fine-Tuning during Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, the set of masks found in ResNet18’s linear layer during GradLTN are significantly different from one another, indicating a high degree of personalization between clients. The resulting increased performance of FedSelect suggests that personalizing individual parameters as opposed to full layers is beneficial for FL.</p>
</div>
<figure id="S3.F1" class="ltx_figure">
<p id="S3.F1.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F1.1.1.1" class="ltx_text"><img src="/html/2306.13264/assets/Images/mask_overlap2.png" id="S3.F1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="238" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Intersection-over-union overlap between all pairs of client masks found by FedSelect for the final ResNet18 linear layer, for <math id="S3.F1.5.5.m1.1" class="ltx_Math" alttext="p=0.50" display="inline"><semantics id="S3.F1.5.5.m1.1b"><mrow id="S3.F1.5.5.m1.1.1" xref="S3.F1.5.5.m1.1.1.cmml"><mi id="S3.F1.5.5.m1.1.1.2" xref="S3.F1.5.5.m1.1.1.2.cmml">p</mi><mo id="S3.F1.5.5.m1.1.1.1" xref="S3.F1.5.5.m1.1.1.1.cmml">=</mo><mn id="S3.F1.5.5.m1.1.1.3" xref="S3.F1.5.5.m1.1.1.3.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.5.5.m1.1c"><apply id="S3.F1.5.5.m1.1.1.cmml" xref="S3.F1.5.5.m1.1.1"><eq id="S3.F1.5.5.m1.1.1.1.cmml" xref="S3.F1.5.5.m1.1.1.1"></eq><ci id="S3.F1.5.5.m1.1.1.2.cmml" xref="S3.F1.5.5.m1.1.1.2">𝑝</ci><cn type="float" id="S3.F1.5.5.m1.1.1.3.cmml" xref="S3.F1.5.5.m1.1.1.3">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.5.5.m1.1d">p=0.50</annotation></semantics></math>. Both the <math id="S3.F1.6.6.m2.1" class="ltx_Math" alttext="s=2" display="inline"><semantics id="S3.F1.6.6.m2.1b"><mrow id="S3.F1.6.6.m2.1.1" xref="S3.F1.6.6.m2.1.1.cmml"><mi id="S3.F1.6.6.m2.1.1.2" xref="S3.F1.6.6.m2.1.1.2.cmml">s</mi><mo id="S3.F1.6.6.m2.1.1.1" xref="S3.F1.6.6.m2.1.1.1.cmml">=</mo><mn id="S3.F1.6.6.m2.1.1.3" xref="S3.F1.6.6.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.6.6.m2.1c"><apply id="S3.F1.6.6.m2.1.1.cmml" xref="S3.F1.6.6.m2.1.1"><eq id="S3.F1.6.6.m2.1.1.1.cmml" xref="S3.F1.6.6.m2.1.1.1"></eq><ci id="S3.F1.6.6.m2.1.1.2.cmml" xref="S3.F1.6.6.m2.1.1.2">𝑠</ci><cn type="integer" id="S3.F1.6.6.m2.1.1.3.cmml" xref="S3.F1.6.6.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.6.6.m2.1d">s=2</annotation></semantics></math> masks (left) and <math id="S3.F1.7.7.m3.1" class="ltx_Math" alttext="s=4" display="inline"><semantics id="S3.F1.7.7.m3.1b"><mrow id="S3.F1.7.7.m3.1.1" xref="S3.F1.7.7.m3.1.1.cmml"><mi id="S3.F1.7.7.m3.1.1.2" xref="S3.F1.7.7.m3.1.1.2.cmml">s</mi><mo id="S3.F1.7.7.m3.1.1.1" xref="S3.F1.7.7.m3.1.1.1.cmml">=</mo><mn id="S3.F1.7.7.m3.1.1.3" xref="S3.F1.7.7.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F1.7.7.m3.1c"><apply id="S3.F1.7.7.m3.1.1.cmml" xref="S3.F1.7.7.m3.1.1"><eq id="S3.F1.7.7.m3.1.1.1.cmml" xref="S3.F1.7.7.m3.1.1.1"></eq><ci id="S3.F1.7.7.m3.1.1.2.cmml" xref="S3.F1.7.7.m3.1.1.2">𝑠</ci><cn type="integer" id="S3.F1.7.7.m3.1.1.3.cmml" xref="S3.F1.7.7.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.7.7.m3.1d">s=4</annotation></semantics></math> masks (right) exhibit significant diversity.</figcaption>
</figure>
<figure id="S3.F2" class="ltx_figure">
<p id="S3.F2.1.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S3.F2.1.1.1" class="ltx_text"><img src="/html/2306.13264/assets/Images/avg_test-2_4_20s.png" id="S3.F2.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="162" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Average test accuracies of FedSelect on non-iid client partitions of CIFAR-10 when varying the GradLTN personalization rate <math id="S3.F2.5.5.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.F2.5.5.m1.1b"><mi id="S3.F2.5.5.m1.1.1" xref="S3.F2.5.5.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.F2.5.5.m1.1c"><ci id="S3.F2.5.5.m1.1.1.cmml" xref="S3.F2.5.5.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.5.m1.1d">p</annotation></semantics></math> for <math id="S3.F2.6.6.m2.1" class="ltx_Math" alttext="s=2" display="inline"><semantics id="S3.F2.6.6.m2.1b"><mrow id="S3.F2.6.6.m2.1.1" xref="S3.F2.6.6.m2.1.1.cmml"><mi id="S3.F2.6.6.m2.1.1.2" xref="S3.F2.6.6.m2.1.1.2.cmml">s</mi><mo id="S3.F2.6.6.m2.1.1.1" xref="S3.F2.6.6.m2.1.1.1.cmml">=</mo><mn id="S3.F2.6.6.m2.1.1.3" xref="S3.F2.6.6.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.6.6.m2.1c"><apply id="S3.F2.6.6.m2.1.1.cmml" xref="S3.F2.6.6.m2.1.1"><eq id="S3.F2.6.6.m2.1.1.1.cmml" xref="S3.F2.6.6.m2.1.1.1"></eq><ci id="S3.F2.6.6.m2.1.1.2.cmml" xref="S3.F2.6.6.m2.1.1.2">𝑠</ci><cn type="integer" id="S3.F2.6.6.m2.1.1.3.cmml" xref="S3.F2.6.6.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.6.m2.1d">s=2</annotation></semantics></math> (left) and <math id="S3.F2.7.7.m3.1" class="ltx_Math" alttext="s=4" display="inline"><semantics id="S3.F2.7.7.m3.1b"><mrow id="S3.F2.7.7.m3.1.1" xref="S3.F2.7.7.m3.1.1.cmml"><mi id="S3.F2.7.7.m3.1.1.2" xref="S3.F2.7.7.m3.1.1.2.cmml">s</mi><mo id="S3.F2.7.7.m3.1.1.1" xref="S3.F2.7.7.m3.1.1.1.cmml">=</mo><mn id="S3.F2.7.7.m3.1.1.3" xref="S3.F2.7.7.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.7.7.m3.1c"><apply id="S3.F2.7.7.m3.1.1.cmml" xref="S3.F2.7.7.m3.1.1"><eq id="S3.F2.7.7.m3.1.1.1.cmml" xref="S3.F2.7.7.m3.1.1.1"></eq><ci id="S3.F2.7.7.m3.1.1.2.cmml" xref="S3.F2.7.7.m3.1.1.2">𝑠</ci><cn type="integer" id="S3.F2.7.7.m3.1.1.3.cmml" xref="S3.F2.7.7.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.7.7.m3.1d">s=4</annotation></semantics></math> (right). </figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Effect of Personalization Rate</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.7" class="ltx_p">In Figure <a href="#S3.F2" title="Figure 2 ‣ 3.1 Performance Comparison ‣ 3 Experiments ‣ FedSelect: Customized Selection of Parameters for Fine-Tuning during Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we find that in the <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="s=2" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">s</mi><mo id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><eq id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1"></eq><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑠</ci><cn type="integer" id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">s=2</annotation></semantics></math> task, there is minimal variation in test accuracy when changing the personalization rate during FedSelect. It is possible that the process by which personalizable parameters are identified via GradLTN and LocalAlt is performed may be strong enough to perform well in the <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="s=2" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">s</mi><mo id="S3.SS2.p1.2.m2.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><eq id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1"></eq><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑠</ci><cn type="integer" id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">s=2</annotation></semantics></math> task despite the low data regime. However, for <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="s=4" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">s</mi><mo id="S3.SS2.p1.3.m3.1.1.1" xref="S3.SS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><eq id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></eq><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑠</ci><cn type="integer" id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">s=4</annotation></semantics></math>, both high (<math id="S3.SS2.p1.4.m4.1" class="ltx_Math" alttext="p=0.75" display="inline"><semantics id="S3.SS2.p1.4.m4.1a"><mrow id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">p</mi><mo id="S3.SS2.p1.4.m4.1.1.1" xref="S3.SS2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">0.75</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><eq id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1.1"></eq><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑝</ci><cn type="float" id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">0.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">p=0.75</annotation></semantics></math>) and low (<math id="S3.SS2.p1.5.m5.1" class="ltx_Math" alttext="p=0.25" display="inline"><semantics id="S3.SS2.p1.5.m5.1a"><mrow id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">p</mi><mo id="S3.SS2.p1.5.m5.1.1.1" xref="S3.SS2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">0.25</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><eq id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1.1"></eq><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑝</ci><cn type="float" id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">0.25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">p=0.25</annotation></semantics></math>) personalization rates perform slightly worse than <math id="S3.SS2.p1.6.m6.1" class="ltx_Math" alttext="p=0.50" display="inline"><semantics id="S3.SS2.p1.6.m6.1a"><mrow id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">p</mi><mo id="S3.SS2.p1.6.m6.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">0.50</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><eq id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1"></eq><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝑝</ci><cn type="float" id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">0.50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">p=0.50</annotation></semantics></math>. Although the rate does not directly reflect the final percentage of
parameters frozen/personalized, <math id="S3.SS2.p1.7.m7.1" class="ltx_Math" alttext="p=0.5" display="inline"><semantics id="S3.SS2.p1.7.m7.1a"><mrow id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">p</mi><mo id="S3.SS2.p1.7.m7.1.1.1" xref="S3.SS2.p1.7.m7.1.1.1.cmml">=</mo><mn id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><eq id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1.1"></eq><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">𝑝</ci><cn type="float" id="S3.SS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.p1.7.m7.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">p=0.5</annotation></semantics></math> may represent a middle ground for which personalizing and averaging a similar number of parameters is optimal.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Conclusion &amp; Future Directions</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We propose FedSelect, a method for personalized federated learning that personalizes client architectures during training with the Gradient-Based Lottery Ticket Hypothesis. We demonstrate promising results on CIFAR-10, surpassing prior personalized FL and pruning-based LTH approaches in the full-participation, low-client setting. For future work, we aim to expand our method and perform extensive studies on varying the personalization rate under different settings, and apply this technique to additional datasets, such as EMNIST <cite class="ltx_cite ltx_citemacro_citep">(Cohen et al., <a href="#bib.bib2" title="" class="ltx_ref">2017</a>)</cite>, Fashion MNIST <cite class="ltx_cite ltx_citemacro_citep">(Xiao et al., <a href="#bib.bib23" title="" class="ltx_ref">2017</a>)</cite>, and CINIC10 <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Acknowledgements</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We would like to thank the anonymous reviewers for their valuable comments. We are thankful for the help of Chulin Xie and Wenxuan Bao for their valuable advising and support on this project. This research is part of the Delta research computing project, which is supported by the National Science Foundation (award OCI 2005572), and the State of Illinois. Delta is a joint effort of the University of Illinois at Urbana-Champaign and its National Center for Supercomputing Applications. We would also like to thank Amazon, Microsoft, and NCSA for providing conference travel funding, as well as ICML for providing registration funding.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Arivazhagan et al. (2019)</span>
<span class="ltx_bibblock">
Arivazhagan, M. G., Aggarwal, V., Singh, A. K., and Choudhary, S.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen et al. (2017)</span>
<span class="ltx_bibblock">
Cohen, G., Afshar, S., Tapson, J., and van Schaik, A.

</span>
<span class="ltx_bibblock">Emnist: extending mnist to handwritten letters.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">2017 International Joint Conference on Neural Networks
(IJCNN)</em>, 2017.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collins et al. (2021)</span>
<span class="ltx_bibblock">
Collins, L., Hassani, H., Mokhtari, A., and Shakkottai, S.

</span>
<span class="ltx_bibblock">Exploiting shared representations for personalized federated
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 2089–2099. PMLR, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2009)</span>
<span class="ltx_bibblock">
Deng, J., Dong, W., Socher, R., Li, L.-J., Li, K., and Fei-Fei, L.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">2009 IEEE Conference on Computer Vision and Pattern
Recognition</em>, pp.  248–255, 2009.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/CVPR.2009.5206848</span>.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dinh et al. (2020)</span>
<span class="ltx_bibblock">
Dinh, T. C., Tran, N., and Nguyen, J.

</span>
<span class="ltx_bibblock">Personalized federated learning with moreau envelopes.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume 33, pp.  21394–21405, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frankle &amp; Carbin (2019)</span>
<span class="ltx_bibblock">
Frankle, J. and Carbin, M.

</span>
<span class="ltx_bibblock">The lottery ticket hypothesis: Finding sparse, trainable neural
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2020)</span>
<span class="ltx_bibblock">
He, C., Li, S., So, J., Zhang, M., Wang, H., Wang, X., Vepakomma, P., Singh,
A., Qiu, H., Shen, L., Zhao, P., Kang, Y., Liu, Y., Raskar, R., Yang, Q.,
Annavaram, M., and Avestimehr, S.

</span>
<span class="ltx_bibblock">Fedml: A research library and benchmark for federated machine
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2015)</span>
<span class="ltx_bibblock">
He, K., Zhang, X., Ren, S., and Sun, J.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition, 2015.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsieh et al. (2020)</span>
<span class="ltx_bibblock">
Hsieh, K., Phanishayee, A., Mutlu, O., and Gibbons, P. B.

</span>
<span class="ltx_bibblock">The non-iid data quagmire of decentralized machine learning, 2020.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kirkpatrick et al. (2017)</span>
<span class="ltx_bibblock">
Kirkpatrick, J., Pascanu, R., Rabinowitz, N., Veness, J., Desjardins, G., Rusu,
A. A., Milan, K., Quan, J., Ramalho, T., Grabska-Barwinska, A., Hassabis, D.,
Clopath, C., Kumaran, D., and Hadsell, R.

</span>
<span class="ltx_bibblock">Overcoming catastrophic forgetting in neural networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the National Academy of Sciences</em>, 114(13):3521–3526, mar 2017.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1073/pnas.1611835114</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1073%2Fpnas.1611835114" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1073%2Fpnas.1611835114</a>.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. (2023)</span>
<span class="ltx_bibblock">
Lee, Y., Chen, A. S., Tajwar, F., Kumar, A., Yao, H., Liang, P., and Finn, C.

</span>
<span class="ltx_bibblock">Surgical fine-tuning improves adaptation to distribution shifts,
2023.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, A., Sun, J., Wang, B., Duan, L., Li, S., Chen, Y., and Li, H.

</span>
<span class="ltx_bibblock">Lotteryfl: Personalized and communication-efficient federated
learning with lottery ticket hypothesis on non-iid datasets, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021a)</span>
<span class="ltx_bibblock">
Li, T., Hu, S., Beirami, A., and Smith, V.

</span>
<span class="ltx_bibblock">Ditto: Fair and robust federated learning through personalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 6357–6368. PMLR, 2021a.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2021b)</span>
<span class="ltx_bibblock">
Li, X., JIANG, M., Zhang, X., Kamp, M., and Dou, Q.

</span>
<span class="ltx_bibblock">Fedbn: Federated learning on non-iid features via local batch
normalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>,
2021b.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liang et al. (2020)</span>
<span class="ltx_bibblock">
Liang, P. P., Liu, T., Ziyin, L., Allen, N. B., Auerbach, R. P., Brent, D.,
Salakhutdinov, R., and Morency, L.-P.

</span>
<span class="ltx_bibblock">Think locally, act globally: Federated learning with local and global
representations.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2001.01523</em>, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2022)</span>
<span class="ltx_bibblock">
Liu, Z., Hu, S., Wu, Z. S., and Smith, V.

</span>
<span class="ltx_bibblock">On privacy and personalization in cross-silo federated learning,
2022.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McCloskey &amp; Cohen (1989)</span>
<span class="ltx_bibblock">
McCloskey, M. and Cohen, N. J.

</span>
<span class="ltx_bibblock">Catastrophic interference in connectionist networks: The sequential
learning problem.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Psychology of Learning and Motivation</em>, 24:109–165,
1989.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proc. of Int’l Conf. Artificial Intelligence and
Statistics (AISTATS)</em>, Apr 2017.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mugunthan et al. (2022)</span>
<span class="ltx_bibblock">
Mugunthan, V., Lin, E., Gokul, V., Lau, C., Kagal, L., and Pieper, S.

</span>
<span class="ltx_bibblock">Fedltn: Federated learning for sparse and personalized lottery
ticket networks.

</span>
<span class="ltx_bibblock">In Avidan, S., Brostow, G., Cissé, M., Farinella, G. M., and
Hassner, T. (eds.), <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Computer Vision – ECCV 2022</em>, pp.  69–85, Cham,
2022. Springer Nature Switzerland.

</span>
<span class="ltx_bibblock">ISBN 978-3-031-19775-8.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al. (2022)</span>
<span class="ltx_bibblock">
Oh, J., Kim, S., and Yun, S.-Y.

</span>
<span class="ltx_bibblock">FedBABU: Toward enhanced representation for federated image
classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2022.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=HuaYQfggn5u" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=HuaYQfggn5u</a>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pillutla et al. (2022)</span>
<span class="ltx_bibblock">
Pillutla, K., Malik, K., Mohamed, A., Rabbat, M., Sanjabi, M., and Xiao, L.

</span>
<span class="ltx_bibblock">Federated learning with partial model personalization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, 2022.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sheller et al. (2020)</span>
<span class="ltx_bibblock">
Sheller, M. J., Edwards, B., Reina, G. A., Martin, J., and Bakas, S.

</span>
<span class="ltx_bibblock">Federated learning in medicine: facilitating multi-institutional
collaborations without sharing patient data.

</span>
<span class="ltx_bibblock"><em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Scientific Reports</em>, 10(12598), 2020.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1038/s41598-020-69250-1</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1038/s41598-020-69250-1" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1038/s41598-020-69250-1</a>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xiao et al. (2017)</span>
<span class="ltx_bibblock">
Xiao, H., Rasul, K., and Vollgraf, R.

</span>
<span class="ltx_bibblock">Fashion-mnist: a novel image dataset for benchmarking machine
learning algorithms.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, 2017.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2306.13263" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2306.13264" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2306.13264">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2306.13264" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2306.13266" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 23:56:25 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
